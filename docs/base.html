<!DOCTYPE html><html><head><title>Help for package base</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {base}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#base-package'>
<p>The R Base Package</p></a></li>
<li><a href='#.bincode'><p>Bin a Numeric Vector</p></a></li>
<li><a href='#.Device'>
<p>Lists of Open/Active Graphics Devices</p></a></li>
<li><a href='#.Machine'><p>Numerical Characteristics of the Machine</p></a></li>
<li><a href='#.Platform'><p>Platform Specific Variables</p></a></li>
<li><a href='#.Script'><p>Scripting Language Interface</p></a></li>
<li><a href='#abbreviate'><p>Abbreviate Strings</p></a></li>
<li><a href='#agrep'><p>Approximate String Matching (Fuzzy Matching)</p></a></li>
<li><a href='#all'><p>Are All Values True?</p></a></li>
<li><a href='#all.equal'><p>Test if Two Objects are (Nearly) Equal</p></a></li>
<li><a href='#all.names'><p>Find All Names in an Expression</p></a></li>
<li><a href='#any'><p>Are Some Values True?</p></a></li>
<li><a href='#aperm'><p>Array Transposition</p></a></li>
<li><a href='#append'><p>Vector Merging</p></a></li>
<li><a href='#apply'><p>Apply Functions Over Array Margins</p></a></li>
<li><a href='#args'><p>Argument List of a Function</p></a></li>
<li><a href='#Arithmetic'><p>Arithmetic Operators</p></a></li>
<li><a href='#array'><p>Multi-way Arrays</p></a></li>
<li><a href='#array2DF'><p>Convert array to data frame</p></a></li>
<li><a href='#as.data.frame'><p>Coerce to a Data Frame</p></a></li>
<li><a href='#as.Date'><p>Date Conversion Functions to and from Character</p></a></li>
<li><a href='#as.environment'><p> Coerce to an Environment Object</p></a></li>
<li><a href='#as.function'><p>Convert Object to Function</p></a></li>
<li><a href='#as.POSIX+2A'><p>Date-time Conversion Functions</p></a></li>
<li><a href='#AsIs'><p>Inhibit Interpretation/Conversion of Objects</p></a></li>
<li><a href='#asplit'><p>Split Array/Matrix By Its Margins</p></a></li>
<li><a href='#assign'><p>Assign a Value to a Name</p></a></li>
<li><a href='#assignOps'><p>Assignment Operators</p></a></li>
<li><a href='#attach'><p>Attach Set of R Objects to Search Path</p></a></li>
<li><a href='#attr'><p>Object Attributes</p></a></li>
<li><a href='#attributes'><p>Object Attribute Lists</p></a></li>
<li><a href='#autoload'><p>On-demand Loading of Packages</p></a></li>
<li><a href='#backsolve'><p>Solve an Upper or Lower Triangular System</p></a></li>
<li><a href='#balancePOSIXlt'><p>Balancing &ldquo;Ragged&rdquo; and Out-of-range POSIXlt Date-Times</p></a></li>
<li><a href='#base-defunct'><p>Defunct Functions in Package <span class="pkg">base</span></p></a></li>
<li><a href='#base-deprecated'><p>Deprecated Functions in Package <span class="pkg">base</span></p></a></li>
<li><a href='#base-internal'><p>Internal Objects in Package <span class="pkg">base</span></p></a></li>
<li><a href='#basename'><p>Manipulate File Paths</p></a></li>
<li><a href='#Bessel'><p>Bessel Functions</p></a></li>
<li><a href='#bindenv'><p>Binding and Environment Locking, Active Bindings</p></a></li>
<li><a href='#bitwise'><p>Bitwise Logical Operations</p></a></li>
<li><a href='#body'><p>Access to and Manipulation of the Body of a Function</p></a></li>
<li><a href='#bquote'><p>Partial substitution in expressions</p></a></li>
<li><a href='#browser'><p>Environment Browser</p></a></li>
<li><a href='#browserText'>
<p>Functions to Retrieve Values Supplied by Calls to the Browser</p></a></li>
<li><a href='#builtins'><p>Returns the Names of All Built-in Objects</p></a></li>
<li><a href='#by'><p>Apply a Function to a Data Frame Split by Factors</p></a></li>
<li><a href='#c'><p>Combine Values into a Vector or List</p></a></li>
<li><a href='#call'><p>Function Calls</p></a></li>
<li><a href='#callCC'><p>Call With Current Continuation</p></a></li>
<li><a href='#CallExternal'><p>Modern Interfaces to C/C++ code</p></a></li>
<li><a href='#capabilities'><p>Report Capabilities of this Build of R</p></a></li>
<li><a href='#cat'><p>Concatenate and Print</p></a></li>
<li><a href='#cbind'><p>Combine R Objects by Rows or Columns</p></a></li>
<li><a href='#char.expand'><p>Expand a String with Respect to a Target Table</p></a></li>
<li><a href='#character'><p>Character Vectors</p></a></li>
<li><a href='#charmatch'><p>Partial String Matching</p></a></li>
<li><a href='#chartr'><p>Character Translation and Case Folding</p></a></li>
<li><a href='#chkDots'><p>Warn About Extraneous Arguments in the &quot;...&quot; of Its Caller</p></a></li>
<li><a href='#chol'><p>The Cholesky Decomposition</p></a></li>
<li><a href='#chol2inv'><p>Inverse from Cholesky (or QR) Decomposition</p></a></li>
<li><a href='#chooseOpsMethod'><p>Choose the Appropriate Method for Ops</p></a></li>
<li><a href='#class'><p>Object Classes</p></a></li>
<li><a href='#col'><p>Column Indexes</p></a></li>
<li><a href='#Colon'><p>Colon Operator</p></a></li>
<li><a href='#colSums'><p>Form Row and Column Sums and Means</p></a></li>
<li><a href='#commandArgs'><p>Extract Command Line Arguments</p></a></li>
<li><a href='#comment'><p>Query or Set a <code>"comment"</code> Attribute</p></a></li>
<li><a href='#Comparison'><p>Relational Operators</p></a></li>
<li><a href='#complex'><p>Complex Numbers and Basic Functionality</p></a></li>
<li><a href='#conditions'><p>Condition Handling and Recovery</p></a></li>
<li><a href='#conflicts'><p>Search for Masked Objects on the Search Path</p></a></li>
<li><a href='#connections'><p>Functions to Manipulate Connections (Files, URLs, ...)</p></a></li>
<li><a href='#Constants'><p>Built-in Constants</p></a></li>
<li><a href='#contributors'><p>R Project Contributors</p></a></li>
<li><a href='#Control'><p>Control Flow</p></a></li>
<li><a href='#copyright'><p>Copyrights of Files Used to Build R</p></a></li>
<li><a href='#crossprod'><p>Matrix Cross-Product</p></a></li>
<li><a href='#Cstack_info'><p>Report Information on C Stack Size and Usage</p></a></li>
<li><a href='#cumsum'><p>Cumulative Sums, Products, and Extremes</p></a></li>
<li><a href='#curlGetHeaders'>
<p>Retrieve Headers from URLs</p></a></li>
<li><a href='#cut'><p>Convert Numeric to Factor</p></a></li>
<li><a href='#cut.POSIXt'><p>Convert a Date or Date-Time Object to a Factor</p></a></li>
<li><a href='#data.class'><p>Object Classes</p></a></li>
<li><a href='#data.frame'><p>Data Frames</p></a></li>
<li><a href='#data.matrix'><p>Convert a Data Frame to a Numeric Matrix</p></a></li>
<li><a href='#dataframeHelpers'><p>Data Frame Auxiliary Functions</p></a></li>
<li><a href='#date'><p>System Date and Time</p></a></li>
<li><a href='#Dates'><p>Date Class</p></a></li>
<li><a href='#DateTimeClasses'><p>Date-Time Classes</p></a></li>
<li><a href='#dcf'><p>Read and Write Data in DCF Format</p></a></li>
<li><a href='#debug'><p>Debug a Function</p></a></li>
<li><a href='#declare'>
<p>Declarations</p></a></li>
<li><a href='#Defunct'><p>Marking Objects as Defunct</p></a></li>
<li><a href='#delayedAssign'><p>Delay Evaluation and Promises</p></a></li>
<li><a href='#deparse'><p>Expression Deparsing</p></a></li>
<li><a href='#deparseOpts'><p>Options for Expression Deparsing</p></a></li>
<li><a href='#Deprecated'><p>Marking Objects as Deprecated</p></a></li>
<li><a href='#det'><p>Calculate the Determinant of a Matrix</p></a></li>
<li><a href='#detach'><p>Detach Objects from the Search Path</p></a></li>
<li><a href='#diag'><p>Matrix Diagonals</p></a></li>
<li><a href='#diff'><p>Lagged Differences</p></a></li>
<li><a href='#difftime'><p>Time Intervals / Differences</p></a></li>
<li><a href='#dim'><p>Dimensions of an Object</p></a></li>
<li><a href='#dimnames'><p>Dimnames of an Object</p></a></li>
<li><a href='#do.call'><p>Execute a Function Call</p></a></li>
<li><a href='#dontCheck'><p>Identity Function to Suppress Checking</p></a></li>
<li><a href='#dots'><p>..., <code>..1</code>, etc used in Functions</p></a></li>
<li><a href='#double'><p>Double-Precision Vectors</p></a></li>
<li><a href='#dput'><p>Write an Object to a File or Recreate it</p></a></li>
<li><a href='#drop'><p>Drop Redundant Extent Information</p></a></li>
<li><a href='#droplevels'><p>Drop Unused Levels from Factors</p></a></li>
<li><a href='#dump'><p>Text Representations of R Objects</p></a></li>
<li><a href='#duplicated'><p>Determine Duplicate Elements</p></a></li>
<li><a href='#dyn.load'><p>Foreign Function Interface</p></a></li>
<li><a href='#eapply'><p>Apply a Function Over Values in an Environment</p></a></li>
<li><a href='#eigen'><p>Spectral Decomposition of a Matrix</p></a></li>
<li><a href='#encodeString'>
<p>Encode Character Vector as for Printing</p></a></li>
<li><a href='#Encoding'><p>Read or Set the Declared Encodings for a Character Vector</p></a></li>
<li><a href='#environment'><p>Environment Access</p></a></li>
<li><a href='#EnvVar'><p>Environment Variables</p></a></li>
<li><a href='#eval'><p>Evaluate an (Unevaluated) Expression</p></a></li>
<li><a href='#exists'><p>Is an Object Defined?</p></a></li>
<li><a href='#expand.grid'><p>Create a Data Frame from All Combinations of Factor Variables</p></a></li>
<li><a href='#expression'><p>Unevaluated Expressions</p></a></li>
<li><a href='#Extract'><p>Extract or Replace Parts of an Object</p></a></li>
<li><a href='#Extract.data.frame'><p>Extract or Replace Parts of a Data Frame</p></a></li>
<li><a href='#Extract.factor'><p>Extract or Replace Parts of a Factor</p></a></li>
<li><a href='#Extremes'><p>Maxima and Minima</p></a></li>
<li><a href='#extSoftVersion'>
<p>Report Versions of Third-Party Software</p></a></li>
<li><a href='#factor'><p>Factors</p></a></li>
<li><a href='#file.access'><p>Ascertain File Accessibility</p></a></li>
<li><a href='#file.choose'><p>Choose a File Interactively</p></a></li>
<li><a href='#file.info'><p>Extract File Information</p></a></li>
<li><a href='#file.path'><p>Construct Path to File</p></a></li>
<li><a href='#file.show'><p>Display One or More Text Files</p></a></li>
<li><a href='#files'><p>File Manipulation</p></a></li>
<li><a href='#files2'><p>Manipulation of Directories and File Permissions</p></a></li>
<li><a href='#find.package'><p>Find Packages</p></a></li>
<li><a href='#findInterval'><p>Find Interval Numbers or Indices</p></a></li>
<li><a href='#force'><p>Force Evaluation of an Argument</p></a></li>
<li><a href='#forceAndCall'><p>Call a function with Some Arguments Forced</p></a></li>
<li><a href='#Foreign'><p>Foreign Function Interface</p></a></li>
<li><a href='#Foreign-internal'><p>Internal Versions of the Foreign Function Interface</p></a></li>
<li><a href='#formals'><p>Access to and Manipulation of the Formal Arguments</p></a></li>
<li><a href='#format'><p>Encode in a Common Format</p></a></li>
<li><a href='#format.info'><p>format(.) Information</p></a></li>
<li><a href='#format.pval'><p>Format P Values</p></a></li>
<li><a href='#formatC'><p>Formatting Using C-style Formats</p></a></li>
<li><a href='#formatDL'><p>Format Description Lists</p></a></li>
<li><a href='#function'><p>Function Definition</p></a></li>
<li><a href='#funprog'><p>Common Higher-Order Functions in Functional Programming Languages</p></a></li>
<li><a href='#gc'><p>Garbage Collection</p></a></li>
<li><a href='#gc.time'><p>Report Time Spent in Garbage Collection</p></a></li>
<li><a href='#gctorture'><p>Torture Garbage Collector</p></a></li>
<li><a href='#get'><p>Return the Value of a Named Object</p></a></li>
<li><a href='#getCallingDLL'><p>Compute DLL for Native Interface Call</p></a></li>
<li><a href='#getDLLRegisteredRoutines'><p>Reflectance Information for C/Fortran routines in a DLL</p></a></li>
<li><a href='#getLoadedDLLs'><p>Get DLLs Loaded in Current Session</p></a></li>
<li><a href='#getNativeSymbolInfo'>
<p>Obtain a Description of one or more Native (C/Fortran) Symbols</p></a></li>
<li><a href='#gettext'><p>Translate Text Messages</p></a></li>
<li><a href='#getwd'><p>Get or Set Working Directory</p></a></li>
<li><a href='#gl'><p>Generate Factor Levels</p></a></li>
<li><a href='#grep'><p>Pattern Matching and Replacement</p></a></li>
<li><a href='#grepRaw'><p>Pattern Matching for Raw Vectors</p></a></li>
<li><a href='#groupGeneric'><p>S3 Group Generic Functions</p></a></li>
<li><a href='#grouping'><p>Grouping Permutation</p></a></li>
<li><a href='#gzcon'>
<p>(De)compress I/O Through Connections</p></a></li>
<li><a href='#hexmode'><p>Integer Numbers Displayed in Hexadecimal</p></a></li>
<li><a href='#Hyperbolic'><p>Hyperbolic Functions</p></a></li>
<li><a href='#iconv'><p>Convert Character Vector between Encodings</p></a></li>
<li><a href='#icuSetCollate'><p> Setup Collation by ICU</p></a></li>
<li><a href='#identical'><p>Test Objects for Exact Equality</p></a></li>
<li><a href='#identity'><p>Identity Function</p></a></li>
<li><a href='#ifelse'><p>Conditional Element Selection</p></a></li>
<li><a href='#integer'><p>Integer Vectors</p></a></li>
<li><a href='#interaction'><p>Compute Factor Interactions</p></a></li>
<li><a href='#interactive'><p>Is R Running Interactively?</p></a></li>
<li><a href='#Internal'><p>Call an Internal Function</p></a></li>
<li><a href='#InternalMethods'><p>Internal Generic Functions</p></a></li>
<li><a href='#invisible'><p>Change the Print Mode to Invisible</p></a></li>
<li><a href='#is.finite'><p>Finite, Infinite and NaN Numbers</p></a></li>
<li><a href='#is.function'><p>Is an Object of Type (Primitive) Function?</p></a></li>
<li><a href='#is.language'><p>Is an Object a Language Object?</p></a></li>
<li><a href='#is.object'><p>Is an Object &lsquo;internally classed&rsquo;?</p></a></li>
<li><a href='#is.recursive'><p>Is an Object Atomic or Recursive?</p></a></li>
<li><a href='#is.single'><p>Is an Object of Single Precision Type?</p></a></li>
<li><a href='#is.unsorted'><p>Test if an Object is Not Sorted</p></a></li>
<li><a href='#ISOdatetime'><p>Date-time Conversion Functions from Numeric Representations</p></a></li>
<li><a href='#isS4'><p> Test for an S4 object</p></a></li>
<li><a href='#isSymmetric'><p>Test if a Matrix or other Object is Symmetric (Hermitian)</p></a></li>
<li><a href='#jitter'><p>&lsquo;Jitter&rsquo; (Add Noise) to Numbers</p></a></li>
<li><a href='#kappa'><p>Compute or Estimate the Condition Number of a Matrix</p></a></li>
<li><a href='#kronecker'><p>Kronecker Products on Arrays</p></a></li>
<li><a href='#l10n_info'><p>Localization Information</p></a></li>
<li><a href='#La_library'>
<p>LAPACK Library</p></a></li>
<li><a href='#La_version'>
<p>LAPACK Version</p></a></li>
<li><a href='#labels'><p>Find Labels from Object</p></a></li>
<li><a href='#lapply'><p>Apply a Function over a List or Vector</p></a></li>
<li><a href='#Last.value'><p>Value of Last Evaluated Expression</p></a></li>
<li><a href='#lazyLoad'><p>Lazy Load a Database of R Objects</p></a></li>
<li><a href='#length'><p>Length of an Object</p></a></li>
<li><a href='#lengths'><p>Lengths of List or Vector Elements</p></a></li>
<li><a href='#levels'><p>Levels Attributes</p></a></li>
<li><a href='#libcurlVersion'>
<p>Report Version of libcurl</p></a></li>
<li><a href='#libPaths'><p>Search Paths for Packages</p></a></li>
<li><a href='#library'><p>Loading/Attaching and Listing of Packages</p></a></li>
<li><a href='#library.dynam'><p>Loading DLLs from Packages</p></a></li>
<li><a href='#license'><p>The R License Terms</p></a></li>
<li><a href='#list'><p>Lists &ndash; Generic and Dotted Pairs</p></a></li>
<li><a href='#list.files'><p>List the Files in a Directory/Folder</p></a></li>
<li><a href='#list2DF'>
<p>Create Data Frame From List</p></a></li>
<li><a href='#list2env'><p>From A List, Build or Add To an Environment</p></a></li>
<li><a href='#load'><p>Reload Saved Datasets</p></a></li>
<li><a href='#locales'><p>Query or Set Aspects of the Locale</p></a></li>
<li><a href='#log'><p>Logarithms and Exponentials</p></a></li>
<li><a href='#Logic'><p>Logical Operators</p></a></li>
<li><a href='#logical'><p>Logical Vectors</p></a></li>
<li><a href='#LongVectors'><p>Long Vectors</p></a></li>
<li><a href='#lower.tri'><p>Lower and Upper Triangular Part of a Matrix</p></a></li>
<li><a href='#ls'><p>List Objects</p></a></li>
<li><a href='#make.names'><p>Make Syntactically Valid Names</p></a></li>
<li><a href='#make.unique'><p>Make Character Strings Unique</p></a></li>
<li><a href='#mapply'><p>Apply a Function to Multiple List or Vector Arguments</p></a></li>
<li><a href='#marginSums'><p>Compute Table Margins</p></a></li>
<li><a href='#mat.or.vec'><p>Create a Matrix or a Vector</p></a></li>
<li><a href='#match'><p>Value Matching</p></a></li>
<li><a href='#match.arg'><p>Argument Verification Using Partial Matching</p></a></li>
<li><a href='#match.call'><p>Argument Matching</p></a></li>
<li><a href='#match.fun'><p>Extract a Function Specified by Name</p></a></li>
<li><a href='#MathFun'><p>Miscellaneous Mathematical Functions</p></a></li>
<li><a href='#matmult'><p>Matrix Multiplication</p></a></li>
<li><a href='#matrix'><p>Matrices</p></a></li>
<li><a href='#maxCol'><p>Find Maximum Position in Matrix</p></a></li>
<li><a href='#mean'><p>Arithmetic Mean</p></a></li>
<li><a href='#memCompress'><p>In-memory Compression and Decompression</p></a></li>
<li><a href='#memlimits'><p>Query and Set Heap Size Limits</p></a></li>
<li><a href='#Memory'><p>Memory Available for Data Storage</p></a></li>
<li><a href='#Memory-limits'><p>Memory Limits in R</p></a></li>
<li><a href='#memory.profile'><p>Profile the Usage of Cons Cells</p></a></li>
<li><a href='#merge'><p>Merge Two Data Frames</p></a></li>
<li><a href='#message'><p>Diagnostic Messages</p></a></li>
<li><a href='#missing'><p>Does a Formal Argument have a Value?</p></a></li>
<li><a href='#mode'><p>The (Storage) Mode of an Object</p></a></li>
<li><a href='#mtfrm'><p>Auxiliary Function for Matching</p></a></li>
<li><a href='#NA'><p>&lsquo;Not Available&rsquo; / Missing Values</p></a></li>
<li><a href='#name'><p>Names and Symbols</p></a></li>
<li><a href='#names'><p>The Names of an Object</p></a></li>
<li><a href='#nargs'><p>The Number of Arguments to a Function</p></a></li>
<li><a href='#nchar'><p>Count the Number of Characters (or Bytes or Width)</p></a></li>
<li><a href='#nlevels'><p>The Number of Levels of a Factor</p></a></li>
<li><a href='#noquote'><p>Class for &lsquo;no quote&rsquo; Printing of Character Strings</p></a></li>
<li><a href='#norm'><p>Compute the Norm of a Matrix</p></a></li>
<li><a href='#normalizePath'><p>Express File Paths in Canonical Form</p></a></li>
<li><a href='#NotYet'><p>Not Yet Implemented Functions and Unused Arguments</p></a></li>
<li><a href='#nrow'><p>The Number of Rows/Columns of an Array</p></a></li>
<li><a href='#ns-dblcolon'><p>Double Colon and Triple Colon Operators</p></a></li>
<li><a href='#ns-hooks'><p>Hooks for Namespace Events</p></a></li>
<li><a href='#ns-internals'><p>Namespace Internals</p></a></li>
<li><a href='#ns-load'><p>Loading and Unloading Name Spaces</p></a></li>
<li><a href='#ns-reflect'><p>Namespace Reflection Support</p></a></li>
<li><a href='#ns-topenv'><p>Top Level Environment</p></a></li>
<li><a href='#NULL'><p>The Null Object</p></a></li>
<li><a href='#numeric'><p>Numeric Vectors</p></a></li>
<li><a href='#numeric_version'><p>Numeric Versions</p></a></li>
<li><a href='#NumericConstants'><p>Numeric Constants</p></a></li>
<li><a href='#octmode'><p>Integer Numbers Displayed in Octal</p></a></li>
<li><a href='#on.exit'><p>Function Exit Code</p></a></li>
<li><a href='#Ops.Date'><p>Operators on the Date Class</p></a></li>
<li><a href='#options'><p>Options Settings</p></a></li>
<li><a href='#order'><p>Ordering Permutation</p></a></li>
<li><a href='#outer'><p>Outer Product of Arrays</p></a></li>
<li><a href='#Paren'><p>Parentheses and Braces</p></a></li>
<li><a href='#parse'><p>Parse R Expressions</p></a></li>
<li><a href='#paste'><p>Concatenate Strings</p></a></li>
<li><a href='#path.expand'><p>Expand File Paths</p></a></li>
<li><a href='#pcre_config'>
<p>Report Configuration Options for PCRE</p></a></li>
<li><a href='#pipeOp'><p>Forward Pipe Operator</p></a></li>
<li><a href='#plot'><p>Generic X-Y Plotting</p></a></li>
<li><a href='#pmatch'><p>Partial String Matching</p></a></li>
<li><a href='#polyroot'><p>Find Zeros of a Real or Complex Polynomial</p></a></li>
<li><a href='#pos.to.env'><p>Convert Positions in the Search Path to Environments</p></a></li>
<li><a href='#pretty'><p>Pretty Breakpoints</p></a></li>
<li><a href='#Primitive'><p>Look Up a Primitive Function</p></a></li>
<li><a href='#print'><p>Print Values</p></a></li>
<li><a href='#print.data.frame'><p>Printing Data Frames</p></a></li>
<li><a href='#print.default'><p>Default Printing</p></a></li>
<li><a href='#prmatrix'><p>Print Matrices, Old-style</p></a></li>
<li><a href='#proc.time'><p>Running Time of R</p></a></li>
<li><a href='#prod'><p>Product of Vector Elements</p></a></li>
<li><a href='#proportions'><p>Express Table Entries as Fraction of Marginal Table</p></a></li>
<li><a href='#pushBack'><p>Push Text Back on to a Connection</p></a></li>
<li><a href='#qr'><p>The QR Decomposition of a Matrix</p></a></li>
<li><a href='#QR.Auxiliaries'><p>Reconstruct the Q, R, or X Matrices from a QR Object</p></a></li>
<li><a href='#quit'><p>Terminate an R Session</p></a></li>
<li><a href='#Quotes'><p>Quotes</p></a></li>
<li><a href='#R.Version'><p>Version Information</p></a></li>
<li><a href='#Random'><p>Random Number Generation</p></a></li>
<li><a href='#Random.user'><p>User-supplied Random Number Generation</p></a></li>
<li><a href='#range'><p>Range of Values</p></a></li>
<li><a href='#rank'><p>Sample Ranks</p></a></li>
<li><a href='#rapply'><p>Recursively Apply a Function to a List</p></a></li>
<li><a href='#raw'><p>Raw Vectors</p></a></li>
<li><a href='#rawConnection'><p>Raw Connections</p></a></li>
<li><a href='#rawConversion'><p>Convert to or from (Bit/Packed) Raw Vectors</p></a></li>
<li><a href='#RdUtils'><p>Utilities for Processing Rd Files</p></a></li>
<li><a href='#readBin'><p>Transfer Binary Data To and From Connections</p></a></li>
<li><a href='#readChar'><p>Transfer Character Strings To and From Connections</p></a></li>
<li><a href='#readline'><p>Read a Line from the Terminal</p></a></li>
<li><a href='#readLines'><p>Read Text Lines from a Connection</p></a></li>
<li><a href='#readRDS'><p>Serialization Interface for Single Objects</p></a></li>
<li><a href='#readRenviron'>
<p>Set Environment Variables from a File</p></a></li>
<li><a href='#Recall'><p>Recursive Calling</p></a></li>
<li><a href='#reg.finalizer'><p>Finalization of Objects</p></a></li>
<li><a href='#regex'><p>Regular Expressions as used in R</p></a></li>
<li><a href='#regmatches'><p>Extract or Replace Matched Substrings</p></a></li>
<li><a href='#remove'><p>Remove Objects from a Specified Environment</p></a></li>
<li><a href='#rep'><p>Replicate Elements of Vectors and Lists</p></a></li>
<li><a href='#replace'><p>Replace Values in a Vector</p></a></li>
<li><a href='#Reserved'><p>Reserved Words in R</p></a></li>
<li><a href='#rev'><p>Reverse Elements</p></a></li>
<li><a href='#Rhome'><p>Return the R Home Directory</p></a></li>
<li><a href='#rle'><p>Run Length Encoding</p></a></li>
<li><a href='#Round'><p>Rounding of Numbers</p></a></li>
<li><a href='#round.POSIXt'><p>Round / Truncate Date-Time Objects</p></a></li>
<li><a href='#row'><p>Row Indexes</p></a></li>
<li><a href='#row.names'><p>Get and Set Row Names for Data Frames</p></a></li>
<li><a href='#row+2Bcolnames'><p>Row and Column Names</p></a></li>
<li><a href='#rowsum'><p>Give Column Sums of a Matrix or Data Frame, Based on a Grouping Variable</p></a></li>
<li><a href='#S3method'>
<p>Register S3 Methods</p></a></li>
<li><a href='#sample'><p>Random Samples and Permutations</p></a></li>
<li><a href='#save'><p>Save R Objects</p></a></li>
<li><a href='#scale'><p>Scaling and Centering of Matrix-like Objects</p></a></li>
<li><a href='#scan'><p>Read Data Values</p></a></li>
<li><a href='#search'><p>Give Search Path for R Objects</p></a></li>
<li><a href='#seek'><p>Functions to Reposition Connections</p></a></li>
<li><a href='#seq'><p>Sequence Generation</p></a></li>
<li><a href='#seq.Date'><p>Generate Regular Sequences of Dates</p></a></li>
<li><a href='#seq.POSIXt'><p>Generate Regular Sequences of Times</p></a></li>
<li><a href='#sequence'><p>Create A Vector of Sequences</p></a></li>
<li><a href='#serialize'><p>Simple Serialization Interface</p></a></li>
<li><a href='#sets'><p>Set Operations</p></a></li>
<li><a href='#setTimeLimit'><p>Set CPU and/or Elapsed Time Limits</p></a></li>
<li><a href='#showConnections'><p>Display Connections</p></a></li>
<li><a href='#shQuote'><p>Quote Strings for Use in OS Shells</p></a></li>
<li><a href='#sign'><p>Sign Function</p></a></li>
<li><a href='#Signals'><p>Interrupting Execution of R</p></a></li>
<li><a href='#sink'><p>Send R Output to a File</p></a></li>
<li><a href='#slice.index'><p>Slice Indexes in an Array</p></a></li>
<li><a href='#slotOp'><p>Extract or Replace a Slot or Property</p></a></li>
<li><a href='#socketSelect'><p>Wait on Socket Connections</p></a></li>
<li><a href='#solve'><p>Solve a System of Equations</p></a></li>
<li><a href='#sort'><p>Sorting or Ordering Vectors</p></a></li>
<li><a href='#sort_by'><p>Sorting Vectors or Data Frames by Other Vectors</p></a></li>
<li><a href='#source'><p>Read R Code from a File, a Connection or Expressions</p></a></li>
<li><a href='#Special'><p>Special Functions of Mathematics</p></a></li>
<li><a href='#split'><p>Divide into Groups and Reassemble</p></a></li>
<li><a href='#sprintf'><p>Use C-style String Formatting Commands</p></a></li>
<li><a href='#sQuote'><p>Quote Text</p></a></li>
<li><a href='#srcfile'><p>References to Source Files and Code</p></a></li>
<li><a href='#StackOverflows'><p>Stack Overflow Errors</p></a></li>
<li><a href='#standardGeneric'><p>Formal Method System &ndash; Dispatching S4 Methods</p></a></li>
<li><a href='#startsWith'><p>Does String Start or End With Another String?</p></a></li>
<li><a href='#Startup'><p>Initialization at Start of an R Session</p></a></li>
<li><a href='#stop'><p>Stop Function Execution</p></a></li>
<li><a href='#stopifnot'><p>Ensure the Truth of R Expressions</p></a></li>
<li><a href='#strptime'><p>Date-time Conversion Functions to and from Character</p></a></li>
<li><a href='#strrep'><p>Repeat the Elements of a Character Vector</p></a></li>
<li><a href='#strsplit'><p>Split the Elements of a Character Vector</p></a></li>
<li><a href='#strtoi'><p>Convert Strings to Integers</p></a></li>
<li><a href='#strtrim'><p>Trim Character Strings to Specified Display Widths</p></a></li>
<li><a href='#structure'><p>Attribute Specification</p></a></li>
<li><a href='#strwrap'><p>Wrap Character Strings to Format Paragraphs</p></a></li>
<li><a href='#subset'><p>Subsetting Vectors, Matrices and Data Frames</p></a></li>
<li><a href='#substitute'><p>Substituting and Quoting Expressions</p></a></li>
<li><a href='#substr'><p>Substrings of a Character Vector</p></a></li>
<li><a href='#sum'><p>Sum of Vector Elements</p></a></li>
<li><a href='#summary'><p>Object Summaries</p></a></li>
<li><a href='#svd'><p>Singular Value Decomposition of a Matrix</p></a></li>
<li><a href='#sweep'><p>Sweep out Array Summaries</p></a></li>
<li><a href='#switch'><p>Select One of a List of Alternatives</p></a></li>
<li><a href='#Syntax'><p>Operator Syntax and Precedence</p></a></li>
<li><a href='#Sys.getenv'><p>Get Environment Variables</p></a></li>
<li><a href='#Sys.getpid'><p>Get the Process ID of the R Session</p></a></li>
<li><a href='#Sys.glob'><p>Wildcard Expansion on File Paths</p></a></li>
<li><a href='#Sys.info'><p>Extract System and User Information</p></a></li>
<li><a href='#Sys.localeconv'><p>Find Details of the Numerical and Monetary Representations</p>
in the Current Locale</a></li>
<li><a href='#sys.parent'><p>Functions to Access the Function Call Stack</p></a></li>
<li><a href='#Sys.readlink'>
<p>Read File Symbolic Links</p></a></li>
<li><a href='#Sys.setenv'><p>Set or Unset Environment Variables</p></a></li>
<li><a href='#Sys.setFileTime'>
<p>Set File Time</p></a></li>
<li><a href='#Sys.sleep'><p>Suspend Execution for a Time Interval</p></a></li>
<li><a href='#sys.source'><p>Parse and Evaluate Expressions from a File</p></a></li>
<li><a href='#Sys.time'><p>Get Current Date and Time</p></a></li>
<li><a href='#Sys.which'><p>Find Full Paths to Executables</p></a></li>
<li><a href='#system'><p>Invoke a System Command</p></a></li>
<li><a href='#system.file'><p>Find Names of R System Files</p></a></li>
<li><a href='#system.time'><p>CPU Time Used</p></a></li>
<li><a href='#system2'><p>Invoke a System Command</p></a></li>
<li><a href='#t'><p>Matrix Transpose</p></a></li>
<li><a href='#table'><p>Cross Tabulation and Table Creation</p></a></li>
<li><a href='#tabulate'><p>Tabulation for Vectors</p></a></li>
<li><a href='#Tailcall'><p><code>Tailcall</code> and <code>Exec</code></p></a></li>
<li><a href='#tapply'><p>Apply a Function Over a Ragged Array</p></a></li>
<li><a href='#taskCallback'><p>Add or Remove a Top-Level Task Callback</p></a></li>
<li><a href='#taskCallbackManager'><p>Create an R-level Task Callback Manager</p></a></li>
<li><a href='#taskCallbackNames'><p>Query the Names of the Current Internal Top-Level Task Callbacks</p></a></li>
<li><a href='#tempfile'><p>Create Names for Temporary Files</p></a></li>
<li><a href='#textConnection'><p>Text Connections</p></a></li>
<li><a href='#tilde'><p>Tilde Operator</p></a></li>
<li><a href='#timezones'><p>Time Zones</p></a></li>
<li><a href='#toString'><p>Convert an R Object to a Character String</p></a></li>
<li><a href='#trace'><p>Interactive Tracing and Debugging of Calls to a Function or Method</p></a></li>
<li><a href='#traceback'><p>Get and Print Call Stacks</p></a></li>
<li><a href='#tracemem'><p>Trace Copying of Objects</p></a></li>
<li><a href='#transform'><p>Transform an Object, for Example a Data Frame</p></a></li>
<li><a href='#Trig'><p>Trigonometric Functions</p></a></li>
<li><a href='#trimws'><p>Remove Leading/Trailing Whitespace</p></a></li>
<li><a href='#try'><p>Try an Expression Allowing Error Recovery</p></a></li>
<li><a href='#typeof'><p>The Type of an Object</p></a></li>
<li><a href='#unique'><p>Extract Unique Elements</p></a></li>
<li><a href='#units'><p>Units</p></a></li>
<li><a href='#unlink'><p>Delete Files and Directories</p></a></li>
<li><a href='#unlist'><p>Flatten Lists</p></a></li>
<li><a href='#unname'><p>Remove <code>names</code> or <code>dimnames</code></p></a></li>
<li><a href='#use'><p>Use Packages</p></a></li>
<li><a href='#UseMethod'><p>Class Methods</p></a></li>
<li><a href='#userhooks'><p>Functions to Get and Set Hooks for Load, Attach, Detach and Unload</p></a></li>
<li><a href='#utf8Conversion'><p>Convert Integer Vectors to or from UTF-8-encoded Character Vectors</p></a></li>
<li><a href='#UTF8filepaths'><p>File Paths not in the Native Encoding</p></a></li>
<li><a href='#validUTF8'><p>Check if a Character Vector is Validly Encoded</p></a></li>
<li><a href='#vector'><p>Vectors - Creation, Coercion, etc</p></a></li>
<li><a href='#Vectorize'><p>Vectorize a Scalar Function</p></a></li>
<li><a href='#warning'><p>Warning Messages</p></a></li>
<li><a href='#warnings'><p>Print Warning Messages</p></a></li>
<li><a href='#weekdays'><p>Extract Parts of a POSIXt or Date Object</p></a></li>
<li><a href='#which'><p>Which indices are TRUE?</p></a></li>
<li><a href='#which.min'><p>Where is the Min() or Max() or first TRUE or FALSE ?</p></a></li>
<li><a href='#with'><p>Evaluate an Expression in a Data Environment</p></a></li>
<li><a href='#withVisible'><p>Return both a Value and its Visibility</p></a></li>
<li><a href='#write'><p>Write Data to a File</p></a></li>
<li><a href='#writeLines'><p>Write Lines to a Connection</p></a></li>
<li><a href='#xtfrm'><p>Auxiliary Function for Sorting and Ranking</p></a></li>
<li><a href='#zapsmall'><p>Rounding of Numbers: Zapping Small Ones to Zero</p></a></li>
<li><a href='#zpackages'><p>Listing of Packages</p></a></li>
<li><a href='#zutils'><p>Miscellaneous Internal/Programming Utilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>4.5.0</td>
</tr>
<tr>
<td>Priority:</td>
<td>base</td>
</tr>
<tr>
<td>Title:</td>
<td>The R Base Package</td>
</tr>
<tr>
<td>Author:</td>
<td>R Core Team and contributors worldwide</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>R Core Team &lt;do-use-Contact-address@r-project.org&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>R-help mailing list &lt;r-help@r-project.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Base R functions.</td>
</tr>
<tr>
<td>License:</td>
<td>Part of R 4.5.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>methods</td>
</tr>
<tr>
<td>Enhances:</td>
<td>chron, date, round</td>
</tr>
<tr>
<td>Built:</td>
<td>R 4.5.0; ; 2024-04-16 07:37:04 UTC; unix</td>
</tr>
</table>
<hr>
<h2 id='base-package'>
The R Base Package
</h2><span id='topic+base-package'></span><span id='topic+base'></span>

<h3>Description</h3>

<p>Base R functions
</p>


<h3>Details</h3>

<p>This package contains the basic functions which let <span class="rlang"><b>R</b></span>
function as a language:  arithmetic, input/output, basic
programming support, etc.  Its contents are available through
inheritance from any environment.
</p>
<p>For a complete list of functions, use <code>library(help = "base")</code>.
</p>

<hr>
<h2 id='.bincode'>Bin a Numeric Vector</h2><span id='topic+.bincode'></span>

<h3>Description</h3>

<p>Bin a numeric vector and return integer codes for the binning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.bincode(x, breaks, right = TRUE, include.lowest = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".bincode_+3A_x">x</code></td>
<td>
<p>a numeric vector which is to be converted to integer codes by
binning.</p>
</td></tr>
<tr><td><code id=".bincode_+3A_breaks">breaks</code></td>
<td>
<p>a numeric vector of two or more cut points, sorted in
increasing order.</p>
</td></tr>
<tr><td><code id=".bincode_+3A_right">right</code></td>
<td>
<p>logical, indicating if the intervals should be closed on
the right (and open on the left) or vice versa.</p>
</td></tr>
<tr><td><code id=".bincode_+3A_include.lowest">include.lowest</code></td>
<td>
<p>logical, indicating if an &lsquo;x[i]&rsquo; equal to
the lowest (or highest, for <code>right = FALSE</code>) &lsquo;breaks&rsquo;
value should be included in the first (or last) bin.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a &lsquo;barebones&rsquo; version of <code>cut.default(labels =
    FALSE)</code> intended for use in other functions which have checked the
arguments passed.  (Note the different order of the arguments they have
in common.)
</p>
<p>Unlike <code><a href="#topic+cut">cut</a></code>, the <code>breaks</code> do not need to be unique.
An input can only fall into a zero-length interval if it is closed
at both ends, so only if <code>include.lowest = TRUE</code> and it is the
first (or last for <code>right = FALSE</code>) interval.
</p>


<h3>Value</h3>

<p>An integer vector of the same length as <code>x</code> indicating which bin
each element falls into (the leftmost bin being bin <code>1</code>).
<code>NaN</code> and <code>NA</code> elements of <code>x</code> are mapped to
<code>NA</code> codes, as are values outside range of <code>breaks</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cut">cut</a></code>, <code><a href="#topic+tabulate">tabulate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example with non-unique breaks:
x &lt;- c(0, 0.01, 0.5, 0.99, 1)
b &lt;- c(0, 0, 1, 1)
.bincode(x, b, TRUE)
.bincode(x, b, FALSE)
.bincode(x, b, TRUE, TRUE)
.bincode(x, b, FALSE, TRUE)
</code></pre>

<hr>
<h2 id='.Device'>
Lists of Open/Active Graphics Devices
</h2><span id='topic+.Device'></span><span id='topic+.Devices'></span>

<h3>Description</h3>

<p>A pairlist of the names of open graphics devices is stored in
<code>.Devices</code>. The name of the active device (see
<code><a href="grDevices.html#topic+dev.cur">dev.cur</a></code>) is stored in <code>.Device</code>.  Both are symbols
and so appear in the base namespace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Device
.Devices
</code></pre>


<h3>Details</h3>

<p><code>.Device</code> is a length-one character vector.
</p>
<p><code>.Devices</code> is a <a href="#topic+pairlist">pairlist</a> of length-one character vectors.
The first entry is always <code>"null device"</code>, and there are as many
entries as the maximal number of graphics devices which have been
simultaneously active.  If a device has been removed, its entry will be
<code>""</code> until the device number is reused.
</p>
<p>Devices may add attributes to the character vector: for example
devices which write to a file may record its path in attribute
<code>"filepath"</code>.
</p>

<hr>
<h2 id='.Machine'>Numerical Characteristics of the Machine</h2><span id='topic+.Machine'></span>

<h3>Description</h3>

<p><code>.Machine</code> is a variable holding information on the numerical
characteristics of the machine <span class="rlang"><b>R</b></span> is running on, such as the largest
double or integer and the machine's precision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Machine
</code></pre>


<h3>Details</h3>

<p>The algorithm is based on Cody's (1988) subroutine <code>MACHAR</code>.  As all
current implementations of <span class="rlang"><b>R</b></span> use 32-bit integers and use <abbr>IEC</abbr> 60559
floating-point (double precision) arithmetic, the <code>"integer"</code> and
<code>"double"</code> related values are the same for almost all <span class="rlang"><b>R</b></span> builds.

</p>
<p>Note that on most platforms smaller positive values than
<code>.Machine$double.xmin</code> can occur.  On a typical <span class="rlang"><b>R</b></span> platform the
smallest positive double is about <code>5e-324</code>.
</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>double.eps</code></td>
<td>
<p>the smallest positive floating-point number
<code>x</code> such that <code>1 + x != 1</code>.  It equals
<code>double.base ^ ulp.digits</code> if either <code>double.base</code> is 2 or
<code>double.rounding</code> is 0;  otherwise, it is
<code>(double.base ^ double.ulp.digits) / 2</code>.  Normally
<code>2.220446e-16</code>.</p>
</td></tr>
<tr><td><code>double.neg.eps</code></td>
<td>
<p>a small positive floating-point number <code>x</code>
such that <code>1 - x != 1</code>.  It equals
<code>double.base ^ double.neg.ulp.digits</code> if <code>double.base</code> is 2
or <code>double.rounding</code> is 0;  otherwise, it is
<code>(double.base ^ double.neg.ulp.digits) / 2</code>.  Normally
<code>1.110223e-16</code>. As <code>double.neg.ulp.digits</code> is bounded
below by <code>-(double.digits + 3)</code>, <code>double.neg.eps</code> may not
be the smallest number that can alter 1 by subtraction.</p>
</td></tr>
<tr><td><code>double.xmin</code></td>
<td>
<p>the smallest non-zero normalized
floating-point number, a power of the radix, i.e.,
<code>double.base ^ double.min.exp</code>. Normally <code>2.225074e-308</code>.</p>
</td></tr>
<tr><td><code>double.xmax</code></td>
<td>
<p>the largest normalized floating-point number.
Typically, it is equal to <code>(1 - double.neg.eps) *
      double.base ^ double.max.exp</code>, but
on some machines it is only the second or third largest such
number, being too small by 1 or 2 units in the last digit of the
significand.  Normally <code>1.797693e+308</code>.  Note that larger
unnormalized numbers can occur.</p>
</td></tr>
<tr><td><code>double.base</code></td>
<td>
<p>the radix for the floating-point representation:
normally <code>2</code>.</p>
</td></tr>
<tr><td><code>double.digits</code></td>
<td>
<p>the number of base digits in the floating-point
significand: normally <code>53</code>.</p>
</td></tr>
<tr><td><code>double.rounding</code></td>
<td>
<p>the rounding action, one of<br />
0 if floating-point addition chops; <br />
1 if floating-point addition rounds, but not in the IEEE style; <br />
2 if floating-point addition rounds in the IEEE style; <br />
3 if floating-point addition chops, and there is partial underflow; <br />
4 if floating-point addition rounds, but not in the IEEE style, and
there is partial underflow; <br />
5 if floating-point addition rounds in the IEEE style, and there is
partial underflow.<br />
Normally <code>5</code>.</p>
</td></tr>
<tr><td><code>double.guard</code></td>
<td>
<p>the number of guard digits for multiplication
with truncating arithmetic.  It is 1 if floating-point arithmetic
truncates and more than <code>double digits</code> base-<code>double.base</code> digits
participate in the post-normalization shift of the floating-point
significand in multiplication, and 0 otherwise.<br />
Normally <code>0</code>.</p>
</td></tr>
<tr><td><code>double.ulp.digits</code></td>
<td>
<p>the largest negative integer <code>i</code> such
that <code>1 + double.base ^ i != 1</code>, except that it is bounded below by
<code>-(double.digits + 3)</code>.  Normally <code>-52</code>.</p>
</td></tr>
<tr><td><code>double.neg.ulp.digits</code></td>
<td>
<p>the largest negative integer <code>i</code>
such that <code>1 - double.base ^ i != 1</code>, except that it is bounded
below by <code>-(double.digits + 3)</code>. Normally <code>-53</code>.</p>
</td></tr>
<tr><td><code>double.exponent</code></td>
<td>

<p>the number of bits (decimal places if <code>double.base</code> is 10) reserved
for the representation of the exponent (including the bias or sign)
of a floating-point number.  Normally <code>11</code>.</p>
</td></tr>
<tr><td><code>double.min.exp</code></td>
<td>

<p>the largest in magnitude negative integer <code>i</code> such that
<code>double.base ^ i</code> is positive and normalized.  Normally <code>-1022</code>.</p>
</td></tr>
<tr><td><code>double.max.exp</code></td>
<td>

<p>the smallest positive power of <code>double.base</code> that overflows.  Normally
<code>1024</code>.</p>
</td></tr>
<tr><td><code>integer.max</code></td>
<td>
<p>the largest integer which can be represented.
Always <code class="reqn">2^{31} - 1 = 2147483647</code>.</p>
</td></tr>
<tr><td><code>sizeof.long</code></td>
<td>
<p>the number of bytes in a C &lsquo;<span class="samp">&#8288;long&#8288;</span>&rsquo; type:
<code>4</code> or <code>8</code> (most 64-bit systems, but not Windows).</p>
</td></tr>
<tr><td><code>sizeof.longlong</code></td>
<td>
<p>the number of bytes in a C &lsquo;<span class="samp">&#8288;long long&#8288;</span>&rsquo;
type.  Will be zero if there is no such type, otherwise usually
<code>8</code>.</p>
</td></tr>
<tr><td><code>sizeof.longdouble</code></td>
<td>
<p>the number of bytes in a C &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo;
type.  Will be zero if there is no such type (or its use was
disabled when <span class="rlang"><b>R</b></span> was built), otherwise possibly
<code>12</code> (most 32-bit builds),  <code>16</code> (most 64-bit builds) or 8
(CPUs such as ARM where for most compilers &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo; is
identical to <code>double</code>).</p>
</td></tr>


<tr><td><code>sizeof.pointer</code></td>
<td>
<p>the number of bytes in the C <code>SEXP</code>
type.  Will be <code>4</code> on 32-bit builds and <code>8</code> on 64-bit
builds of <span class="rlang"><b>R</b></span>.</p>
</td></tr>
<tr><td><code>sizeof.time_t</code></td>
<td>
<p>the number of <em>bytes</em> in the C <code>time_t</code>
type: a  64-bit <code>time_t</code> (value <code>8</code>) is much preferred these
days.  Note that this is the type used by code in <span class="rlang"><b>R</b></span> itself, not
necessarily the <em>system</em> type if <span class="rlang"><b>R</b></span> was configured with
<span class="option">--with-internal-tzcode</span> as also used on Windows.</p>
</td></tr>
<tr><td><code>longdouble.eps</code>, <code>longdouble.neg.eps</code>, <code>longdouble.digits</code>, <code>...</code></td>
<td>

<p>introduced in <span class="rlang"><b>R</b></span> 4.0.0. When
<code><a href="#topic+capabilities">capabilities</a>("long.double")</code> is true, there are 10 such
<code>"longdouble.<var>kind</var>"</code> values, specifying the &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo;
property corresponding to its <code>"double.*"</code> counterpart.  See
also &lsquo;Note&rsquo;.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In the (typical) case where <code><a href="#topic+capabilities">capabilities</a>("long.double")</code> is
true, <span class="rlang"><b>R</b></span> uses the &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo; C type in quite a few places internally
for accumulators in e.g. <code><a href="#topic+sum">sum</a></code>, reading non-integer
numeric constants into (binary) double precision numbers, or arithmetic
such as <code>x %% y</code>; also, &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo; can be read by
<code><a href="#topic+readBin">readBin</a></code>.
<br />
For this reason, in that case, <code>.Machine</code> contains ten further components,
<code>longdouble.eps</code>, <code>*.neg.eps</code>, <code>*.digits</code>, <code>*.rounding</code>
<code>*.guard</code>, <code>*.ulp.digits</code>, <code>*.neg.ulp.digits</code>,
<code>*.exponent</code>, <code>*.min.exp</code>, and <code>*.max.exp</code>, computed
entirely analogously to their <code>double.*</code> counterparts, see there.
</p>
<p><code>sizeof.longdouble</code> only tells you the amount of storage
allocated for a long double.  Often what is stored is the 80-bit extended
double type of <abbr>IEC</abbr> 60559, padded to the double alignment used on the
platform &mdash; this seems to be the case for the common <span class="rlang"><b>R</b></span> platforms
using ix86 and x86_64 chips.  There are other implementation of long
double, usually in software for example on Sparc Solaris and AIX.
</p>
<p>Note that it is legal for a platform to have a &lsquo;<span class="samp">&#8288;long double&#8288;</span>&rsquo; C
type which is identical to the &lsquo;<span class="samp">&#8288;double&#8288;</span>&rsquo; type &mdash; this happens on
ARM CPUs.  In that case <code><a href="#topic+capabilities">capabilities</a>("long.double")</code> will
be false but on versions of <span class="rlang"><b>R</b></span> prior to 4.0.4, <code>.Machine</code> may contain
<code>"longdouble.<var>kind</var>"</code> elements.
</p>


<h3>Source</h3>

<p>Uses a C translation of Fortran code in the reference, modified by the
R Core Team to defeat over-optimization in modern compilers.
</p>


<h3>References</h3>

<p>Cody, W. J. (1988).
MACHAR: A subroutine to dynamically determine machine parameters.
<em>Transactions on Mathematical Software</em>, <b>14</b>(4), 303&ndash;311.
<a href="https://doi.org/10.1145/50063.51907">doi:10.1145/50063.51907</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.Platform">.Platform</a></code> for details of the platform.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>.Machine
## or for a neat printout
noquote(unlist(format(.Machine)))
</code></pre>

<hr>
<h2 id='.Platform'>Platform Specific Variables</h2><span id='topic+.Platform'></span>

<h3>Description</h3>

<p><code>.Platform</code> is a list with some details of the platform under
which <span class="rlang"><b>R</b></span> was built.  This provides means to write OS-portable <span class="rlang"><b>R</b></span>
code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Platform
</code></pre>


<h3>Value</h3>

<p>A list with at least the following components:
</p>
<table>
<tr><td><code>OS.type</code></td>
<td>

<p>character string, giving the <b>O</b>perating <b>S</b>ystem
(family) of the computer.  One of <code>"unix"</code> or <code>"windows"</code>.
</p>
</td></tr>
<tr><td><code>file.sep</code></td>
<td>

<p>character string, giving the <b>file</b> <b>sep</b>arator used on your
platform: <code>"/"</code> on both Unix-alikes <em>and</em> on Windows (but
not on the former port to Classic Mac OS).
</p>
</td></tr>
<tr><td><code>dynlib.ext</code></td>
<td>

<p>character string, giving the file name <b>ext</b>ension of
<b>dyn</b>amically loadable <b>lib</b>raries, e.g., <code>".dll"</code> on
Windows and <code>".so"</code> or <code>".sl"</code> on Unix-alikes.  (Note for
macOS users: these are shared objects as loaded by
<code><a href="#topic+dyn.load">dyn.load</a></code> and not dylibs: see <code><a href="#topic+dyn.load">dyn.load</a></code>.)
</p>
</td></tr>
<tr><td><code>GUI</code></td>
<td>

<p>character string, giving the type of GUI in use, or <code>"unknown"</code>
if no GUI can be assumed.  Possible values are for Unix-alikes the
values given via the <span class="option">-g</span> command-line flag (<code>"X11"</code>,
<code>"Tk"</code>), <code>"AQUA"</code> (running under <code>R.app</code> on macOS),
<code>"Rgui"</code> and <code>"RTerm"</code> (Windows) and perhaps others under
alternative front-ends or embedded <span class="rlang"><b>R</b></span>.
</p>
</td></tr>
<tr><td><code>endian</code></td>
<td>

<p>character string, <code>"big"</code> or <code>"little"</code>, giving the
&lsquo;endianness&rsquo; of the processor in use.  This is relevant when it is
necessary to know the order to read/write bytes of e.g. an
integer or double from/to a <a href="#topic+connection">connection</a>: see
<code><a href="#topic+readBin">readBin</a></code>.
</p>
</td></tr>
<tr><td><code>pkgType</code></td>
<td>

<p>character string, the preferred setting for
<code><a href="#topic+options">options</a>("pkgType")</code>.  Values <code>"source"</code>,
<code>"mac.binary"</code> and <code>"win.binary"</code> are currently in use.
</p>
<p>This should <strong>not</strong> be used to identify the OS.
</p>
</td></tr>
<tr><td><code>path.sep</code></td>
<td>

<p>character string, giving the <b>path</b> <b>sep</b>arator,
used on your platform, e.g., <code>":"</code> on Unix-alikes and
<code>";"</code> on Windows.  Used to separate paths in environment
variables such as <code>PATH</code> and <code>TEXINPUTS</code>.
</p>
</td></tr>
<tr><td><code>r_arch</code></td>
<td>

<p>character string, possibly <code>""</code>.  The name of an
architecture-specific directory used in this build of <span class="rlang"><b>R</b></span>.
</p>
</td></tr>
</table>


<h3>AQUA</h3>

<p><code>.Platform$GUI</code> is set to <code>"AQUA"</code> under the macOS GUI,
<code>R.app</code>. This has a number of consequences:
</p>

<ul>
<li> <p>&lsquo;<span class="file">/usr/local/bin</span>&rsquo; is <em>appended</em> to the <span class="env">PATH</span>
environment variable.
</p>
</li>
<li><p> the default graphics device is set to <code>quartz</code>.
</p>
</li>
<li><p> selects native (rather than Tk) widgets for the <code>graphics
      = TRUE</code> options of <code><a href="utils.html#topic+menu">menu</a></code> and <code><a href="utils.html#topic+select.list">select.list</a></code>.
</p>
</li>
<li><p> HTML help is displayed in the internal browser.
</p>
</li>
<li><p> the spreadsheet-like data editor/viewer uses a Quartz version
rather than the X11 one.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+R.version">R.version</a></code> and <code><a href="#topic+Sys.info">Sys.info</a></code> give more details
about the OS.  In particular, <code>R.version$platform</code> is the
canonical name of the platform under which <span class="rlang"><b>R</b></span> was compiled.
<code><a href="utils.html#topic+osVersion">osVersion</a></code> may give more details about the platform <span class="rlang"><b>R</b></span> is running on.
</p>
<p><code><a href="#topic+.Machine">.Machine</a></code> for details of the arithmetic used, and
<code><a href="#topic+system">system</a></code> for invoking platform-specific system commands.
</p>
<p><code><a href="#topic+capabilities">capabilities</a></code> and <code><a href="#topic+extSoftVersion">extSoftVersion</a></code> (and links
there) for availability of capabilities partly <em>external</em> to <span class="rlang"><b>R</b></span>
but used from <span class="rlang"><b>R</b></span> functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Note: this can be done in a system-independent way by dir.exists()
if(.Platform$OS.type == "unix") {
   system.test &lt;- function(...) system(paste("test", ...)) == 0L
   dir.exists2 &lt;- function(dir)
       sapply(dir, function(d) system.test("-d", d))
   dir.exists2(c(R.home(), "/tmp", "~", "/NO")) # &gt; T T T F
}
</code></pre>

<hr>
<h2 id='.Script'>Scripting Language Interface</h2><span id='topic+.Script'></span>

<h3>Description</h3>

<p>Internal interface to run a script through its interpreter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Script(interpreter, script, args, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".Script_+3A_interpreter">interpreter</code></td>
<td>
<p>a character string naming the interpreter for the
script.</p>
</td></tr>
<tr><td><code id=".Script_+3A_script">script</code></td>
<td>
<p>a character string with the base file name of the
script, which must be located in the &lsquo;<span class="file"><code>interpreter</code></span>&rsquo;
subdirectory of
&lsquo;<span class="file"><var>R_SHARE_DIR</var></span>&rsquo; (normally &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/share</span>&rsquo;).
</p>
</td></tr>
<tr><td><code id=".Script_+3A_args">args</code></td>
<td>
<p>a character string giving the arguments to pass to the
script.</p>
</td></tr>
<tr><td><code id=".Script_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="#topic+system">system</a></code>
when invoking the interpreter on the script.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is for R internal use only.</p>

<hr>
<h2 id='abbreviate'>Abbreviate Strings</h2><span id='topic+abbreviate'></span>

<h3>Description</h3>

<p>Abbreviate strings to at least <code>minlength</code> characters,
such that they remain <em>unique</em> (if they were),
unless <code>strict = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abbreviate(names.arg, minlength = 4, use.classes = TRUE,
           dot = FALSE, strict = FALSE,
           method = c("left.kept", "both.sides"), named = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abbreviate_+3A_names.arg">names.arg</code></td>
<td>
<p>a character vector of names to be abbreviated, or an
object to be coerced to a character vector by <code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_minlength">minlength</code></td>
<td>
<p>the minimum length of the abbreviations.</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_use.classes">use.classes</code></td>
<td>
<p>logical: should lowercase characters be removed first?</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_dot">dot</code></td>
<td>
<p>logical: should a dot (<code>"."</code>) be appended?</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_strict">strict</code></td>
<td>
<p>logical: should <code>minlength</code> be observed strictly?
Note that setting <code>strict = TRUE</code> may return <em>non</em>-unique
strings.</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_method">method</code></td>
<td>
<p>a character string specifying the method used with default
<code>"left.kept"</code>, see &lsquo;Details&rsquo; below.  Partial matches
allowed.</p>
</td></tr>
<tr><td><code id="abbreviate_+3A_named">named</code></td>
<td>
<p>logical: should <code>names</code> (with original vector) be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default algorithm (<code>method = "left.kept"</code>) used is similar
to that of S.  For a single string it works as follows.
First spaces at the ends of the string are stripped.
Then (if necessary) any other spaces are stripped.
Next, lower case vowels are removed followed by lower case consonants.
Finally if the abbreviation is still longer than <code>minlength</code>
upper case letters and symbols are stripped.
</p>
<p>Characters are always stripped from the end of the strings first.  If
an element of <code>names.arg</code> contains more than one word (words are
separated by spaces) then at least one letter from each word will be
retained.
</p>
<p>Missing (<code>NA</code>) values are unaltered.
</p>
<p>If <code>use.classes</code> is <code>FALSE</code> then the only distinction is to
be between letters and space.
</p>


<h3>Value</h3>

<p>A character vector containing abbreviations for the character strings
in its first argument.  Duplicates in the original <code>names.arg</code>
will be given identical abbreviations.  If any non-duplicated elements
have the same <code>minlength</code> abbreviations then, if <code>method =
  "both.sides"</code> the basic internal <code>abbreviate()</code> algorithm is
applied to the characterwise <em>reversed</em> strings; if there are
still duplicated abbreviations and if <code>strict = FALSE</code> as by
default, <code>minlength</code> is incremented by one and new abbreviations
are found for those elements only.  This process is repeated until all
unique elements of <code>names.arg</code> have unique abbreviations.
</p>
<p>If <code>names</code> is true, the character version of <code>names.arg</code> is
attached to the returned value as a <code><a href="#topic+names">names</a></code> attribute: no
other attributes are retained.
</p>
<p>If a input element contains non-ASCII characters, the corresponding
value will be in UTF-8 and marked as such (see <code><a href="#topic+Encoding">Encoding</a></code>).
</p>


<h3>Warning</h3>

<p>If <code>use.classes</code> is true (the default), this is really only
suitable for English, and prior to <span class="rlang"><b>R</b></span> 3.3.0 did not work correctly
with non-ASCII characters in multibyte locales.  It will warn if used
with non-ASCII characters (and required to reduce the length).  It is
unlikely to work well with inputs not in the Unicode Basic Multilingual
Plane nor on (rare) platforms where wide characters are not encoded in
Unicode.
</p>
<p>As from <span class="rlang"><b>R</b></span> 3.3.0 the concept of &lsquo;vowel&rsquo; is extended from
English vowels by including characters which are accented versions of
lower-case English vowels (including &lsquo;o with stroke&rsquo;).  Of
course, there are languages (even Western European languages such as
Welsh) with other vowels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+substr">substr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("abcd", "efgh", "abce")
abbreviate(x, 2)
abbreviate(x, 2, strict = TRUE) # &gt;&gt; 1st and 3rd are == "ab"

(st.abb &lt;- abbreviate(state.name, 2))
stopifnot(identical(unname(st.abb),
           abbreviate(state.name, 2, named=FALSE)))
table(nchar(st.abb)) # out of 50, 3 need 4 letters :
as &lt;- abbreviate(state.name, 3, strict = TRUE)
as[which(as == "Mss")]

## and without distinguishing vowels:
st.abb2 &lt;- abbreviate(state.name, 2, FALSE)
cbind(st.abb, st.abb2)[st.abb2 != st.abb, ]

## method = "both.sides" helps:  no 4-letters, and only 4 3-letters:
st.ab2 &lt;- abbreviate(state.name, 2, method = "both")
table(nchar(st.ab2))
## Compare the two methods:
cbind(st.abb, st.ab2)
</code></pre>

<hr>
<h2 id='agrep'>Approximate String Matching (Fuzzy Matching)</h2><span id='topic+agrep'></span><span id='topic+agrepl'></span><span id='topic+fuzzy+20matching'></span>

<h3>Description</h3>

<p>Searches for approximate matches to <code>pattern</code> (the first argument)
within each element of the string <code>x</code> (the second argument) using
the generalized Levenshtein edit distance (the minimal possibly
weighted number of insertions, deletions and substitutions needed to
transform one string into another).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agrep(pattern, x, max.distance = 0.1, costs = NULL,
      ignore.case = FALSE, value = FALSE, fixed = TRUE,
      useBytes = FALSE)

agrepl(pattern, x, max.distance = 0.1, costs = NULL,
       ignore.case = FALSE, fixed = TRUE, useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agrep_+3A_pattern">pattern</code></td>
<td>
<p>a non-empty character string to be matched.  For
<code>fixed = FALSE</code> this should contain an extended
<a href="#topic+regular+20expression">regular expression</a>. 
Coerced by <code><a href="#topic+as.character">as.character</a></code> to a string if possible.</p>
</td></tr>
<tr><td><code id="agrep_+3A_x">x</code></td>
<td>
<p>character vector where matches are sought.
Coerced by <code><a href="#topic+as.character">as.character</a></code> to a character vector if
possible.</p>
</td></tr>
<tr><td><code id="agrep_+3A_max.distance">max.distance</code></td>
<td>
<p>maximum distance allowed for a match.  Expressed
either as integer, or as a fraction of the <em>pattern</em> length
times the maximal transformation cost (will be replaced by the
smallest integer not less than the corresponding fraction), or a
list with possible components
</p>

<dl>
<dt><code>cost</code>:</dt><dd><p>maximum number/fraction of match cost
(generalized Levenshtein distance)</p>
</dd>
<dt><code>all</code>:</dt><dd><p>maximal number/fraction of <em>all</em>
transformations (insertions, deletions and substitutions)</p>
</dd>
<dt><code>insertions</code>:</dt><dd><p>maximum number/fraction of insertions</p>
</dd>
<dt><code>deletions</code>:</dt><dd><p>maximum number/fraction of deletions</p>
</dd>
<dt><code>substitutions</code>:</dt><dd><p>maximum number/fraction of
substitutions</p>
</dd>
</dl>

<p>If <code>cost</code> is not given, <code>all</code> defaults to 10%, and the
other transformation number bounds default to <code>all</code>.
The component names can be abbreviated.
</p>
</td></tr>
<tr><td><code id="agrep_+3A_costs">costs</code></td>
<td>
<p>a numeric vector or list with names partially matching
&lsquo;<span class="samp">&#8288;insertions&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;deletions&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;substitutions&#8288;</span>&rsquo; giving
the respective costs for computing the generalized Levenshtein
distance, or <code>NULL</code> (default) indicating using unit cost for
all three possible transformations.
Coerced to integer via <code><a href="#topic+as.integer">as.integer</a></code> if possible.</p>
</td></tr>
<tr><td><code id="agrep_+3A_ignore.case">ignore.case</code></td>
<td>
<p>if <code>FALSE</code>, the pattern matching is <em>case
sensitive</em> and if <code>TRUE</code>, case is ignored during matching.</p>
</td></tr>
<tr><td><code id="agrep_+3A_value">value</code></td>
<td>
<p>if <code>FALSE</code>, a vector containing the (integer)
indices of the matches determined is returned and if <code>TRUE</code>, a
vector containing the matching elements themselves is returned.</p>
</td></tr>
<tr><td><code id="agrep_+3A_fixed">fixed</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), the pattern is
matched literally (as is).  Otherwise, it is matched as a regular
expression.</p>
</td></tr>
<tr><td><code id="agrep_+3A_usebytes">useBytes</code></td>
<td>
<p>logical.  If <code>TRUE</code> the matching is done
byte-by-byte rather than character-by-character.  See
&lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Levenshtein edit distance is used as measure of approximateness:
it is the (possibly cost-weighted) total number of insertions,
deletions and substitutions required to transform one string into
another.
</p>
<p>This uses the <code>tre</code> code by Ville Laurikari
(<a href="https://github.com/laurikari/tre">https://github.com/laurikari/tre</a>), which supports <abbr>MBCS</abbr>
character matching.
</p>
<p>The main effect of <code>useBytes = TRUE</code> is to avoid errors/warnings
about invalid inputs and spurious matches in multibyte locales.
It inhibits the conversion of inputs with marked encodings, and is
forced if any input is found which is marked as <code>"bytes"</code> (see
<code><a href="#topic+Encoding">Encoding</a></code>).
</p>


<h3>Value</h3>

<p><code>agrep</code> returns a vector giving the indices of the elements that
yielded a match, or, if <code>value</code> is <code>TRUE</code>, the matched
elements (after coercion, preserving names but no other attributes).
</p>
<p><code>agrepl</code> returns a logical vector.
</p>


<h3>Note</h3>

<p>Since someone who read the description carelessly even filed a bug
report on it, do note that this matches substrings of each element of
<code>x</code> (just as <code><a href="#topic+grep">grep</a></code> does) and <b>not</b> whole
elements.  See also <code><a href="utils.html#topic+adist">adist</a></code> in package <span class="pkg">utils</span>, which
optionally returns the offsets of the matched substrings.
</p>


<h3>Author(s)</h3>

<p>Original version in <span class="rlang"><b>R</b></span> &lt; 2.10.0 by David Meyer.
Current version by Brian Ripley and Kurt Hornik.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grep">grep</a></code>, <code><a href="utils.html#topic+adist">adist</a></code>.
A different interface to approximate string matching is provided by
<code><a href="utils.html#topic+aregexec">aregexec</a>()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>agrep("lasy", "1 lazy 2")
agrep("lasy", c(" 1 lazy 2", "1 lasy 2"), max.distance = list(sub = 0))
agrep("laysy", c("1 lazy", "1", "1 LAZY"), max.distance = 2)
agrep("laysy", c("1 lazy", "1", "1 LAZY"), max.distance = 2, value = TRUE)
agrep("laysy", c("1 lazy", "1", "1 LAZY"), max.distance = 2, ignore.case = TRUE)
</code></pre>

<hr>
<h2 id='all'>Are All Values True?</h2><span id='topic+all'></span>

<h3>Description</h3>

<p>Given a set of logical vectors, are all of the values true?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all_+3A_...">...</code></td>
<td>
<p>zero or more logical vectors.  Other objects of zero
length are ignored, and the rest are coerced to logical ignoring
any class.</p>
</td></tr>
<tr><td><code id="all_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  If true <code>NA</code> values are removed before
the result is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function: methods can be defined for it
directly or via the <code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.
For this to work properly, the arguments <code>...</code> should be
unnamed, and dispatch is on the first argument.
</p>
<p>Coercion of types other than integer (raw, double, complex, character,
list) gives a warning as this is often unintentional.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>Value</h3>

<p>The value is a logical vector of length one.
</p>
<p>Let <code>x</code> denote the concatenation of all the logical vectors in
<code>...</code> (after coercion), after removing <code>NA</code>s if requested by
<code>na.rm = TRUE</code>.
</p>
<p>The value returned is <code>TRUE</code> if all of the values in <code>x</code> are
<code>TRUE</code> (including if there are no values), and <code>FALSE</code> if at
least one of the values in <code>x</code> is <code>FALSE</code>.  Otherwise the
value is <code>NA</code> (which can only occur if <code>na.rm = FALSE</code> and
<code>...</code> contains no <code>FALSE</code> values and at least one
<code>NA</code> value).
</p>


<h3>S4 methods</h3>

<p>This is part of the S4 <code><a href="methods.html#topic+S4groupGeneric">Summary</a></code>
group generic.  Methods for it must use the signature
<code>x, ..., na.rm</code>.
</p>


<h3>Note</h3>

<p>That <code>all(logical(0))</code> is true is a useful convention:
it ensures that
</p>
<pre>all(all(x), all(y)) == all(x, y)
</pre>
<p>even if <code>x</code> has length zero.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+any">any</a></code>, the &lsquo;complement&rsquo; of <code>all</code>, and
<code><a href="#topic+stopifnot">stopifnot</a>(*)</code> which is an <code>all(*)</code>
&lsquo;insurance&rsquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>range(x &lt;- sort(round(stats::rnorm(10) - 1.2, 1)))
if(all(x &lt; 0)) cat("all x values are negative\n")

all(logical(0))  # true, as all zero of the elements are true.
</code></pre>

<hr>
<h2 id='all.equal'>Test if Two Objects are (Nearly) Equal</h2><span id='topic+all.equal'></span><span id='topic+all.equal.default'></span><span id='topic+all.equal.numeric'></span><span id='topic+all.equal.character'></span><span id='topic+all.equal.environment'></span><span id='topic+all.equal.envRefClass'></span><span id='topic+all.equal.factor'></span><span id='topic+all.equal.formula'></span><span id='topic+all.equal.function'></span><span id='topic+all.equal.list'></span><span id='topic+all.equal.language'></span><span id='topic+all.equal.POSIXt'></span><span id='topic+all.equal.raw'></span><span id='topic+attr.all.equal'></span>

<h3>Description</h3>

<p><code>all.equal(x, y)</code> is a utility to compare <span class="rlang"><b>R</b></span> objects <code>x</code>
and <code>y</code> testing &lsquo;near equality&rsquo;.  If they are different,
comparison is still made to some extent, and a report of the
differences is returned.    Do not use <code>all.equal</code> directly in
<code>if</code> expressions&mdash;either use <code>isTRUE(all.equal(....))</code> or
<code><a href="#topic+identical">identical</a></code> if appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all.equal(target, current, ...)

## Default S3 method:
all.equal(target, current, ..., check.class = TRUE)

## S3 method for class 'numeric'
all.equal(target, current,
          tolerance = sqrt(.Machine$double.eps), scale = NULL,
          countEQ = FALSE,
          formatFUN = function(err, what) format(err),
          ..., check.attributes = TRUE, check.class = TRUE, giveErr = FALSE)

## S3 method for class 'list'
all.equal(target, current, ...,
          check.attributes = TRUE, use.names = TRUE)

## S3 method for class 'environment'
all.equal(target, current, all.names = TRUE,
          evaluate = TRUE, ...)

## S3 method for class 'function'
all.equal(target, current, check.environment=TRUE, ...)

## S3 method for class 'POSIXt'
all.equal(target, current, ..., tolerance = 1e-3, scale,
          check.tzone = TRUE)


attr.all.equal(target, current, ...,
               check.attributes = TRUE, check.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all.equal_+3A_target">target</code></td>
<td>
<p><span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_current">current</code></td>
<td>
<p>other <span class="rlang"><b>R</b></span> object, to be compared with <code>target</code>.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_...">...</code></td>
<td>
<p>further arguments for different methods, notably the
following two, for numerical comparison:</p>
</td></tr>
<tr><td><code id="all.equal_+3A_tolerance">tolerance</code></td>
<td>
<p>numeric <code class="reqn">\ge</code> 0.  Differences smaller than
<code>tolerance</code> are not reported.  The default value is close to
<code>1.5e-8</code>.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_scale">scale</code></td>
<td>
<p><code>NULL</code> or numeric &gt; 0, typically of length 1 or
<code>length(target)</code>.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_counteq">countEQ</code></td>
<td>
<p>logical indicating if the <code>target == current</code>
cases should be counted when computing the mean (absolute or
relative) differences.  The default, <code>FALSE</code> may seem
misleading in cases where <code>target</code> and <code>current</code> only
differ in a few places; see the extensive example.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_formatfun">formatFUN</code></td>
<td>
<p>a <code><a href="#topic+function">function</a></code> of two arguments,
<code>err</code>, the relative, absolute or scaled error, and
<code>what</code>, a character string indicating the <em>kind</em> of error;
may be used, e.g., to format relative and absolute errors differently.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_check.attributes">check.attributes</code></td>
<td>
<p>logical indicating if the
<code><a href="#topic+attributes">attributes</a></code> of <code>target</code> and <code>current</code>
(other than the names) should be compared.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_check.class">check.class</code></td>
<td>
<p>logical indicating if the <code><a href="#topic+data.class">data.class</a>()</code>
of <code>target</code> and <code>current</code> should be compared.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_giveerr">giveErr</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating if the result should
contain the numerical error as an <code>"err"</code> attribute.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_use.names">use.names</code></td>
<td>
<p>logical indicating if <code><a href="#topic+list">list</a></code> comparison
should report differing components by name (if matching) instead of
integer index.  Note that this comes after <code>...</code> and so must
be specified by its full name.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_all.names">all.names</code></td>
<td>
<p>logical passed to <code><a href="#topic+ls">ls</a></code> indicating if
&ldquo;hidden&rdquo; objects should also be considered in the environments.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_evaluate">evaluate</code></td>
<td>
<p>for the <code>environment</code> method: <code><a href="#topic+logical">logical</a></code> indicating if
&ldquo;promises should be forced&rdquo;, i.e., typically formal function arguments
be evaluated for comparison.  If false, only the <code><a href="#topic+names">names</a></code> of
the objects in the two environments are checked for equality.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_check.environment">check.environment</code></td>
<td>
<p>logical requiring that the
<code><a href="#topic+environment">environment</a>()</code>s of functions should be compared, too.
You may need to set <code>check.environment=FALSE</code> in unexpected
cases, such as when comparing two <code><a href="stats.html#topic+nls">nls</a>()</code> fits.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_check.tzone">check.tzone</code></td>
<td>
<p>logical indicating if the <code>"tzone"</code> attributes
of <code>target</code> and <code>current</code> should be compared.</p>
</td></tr>
<tr><td><code id="all.equal_+3A_check.names">check.names</code></td>
<td>
<p>logical indicating if the <code><a href="#topic+names">names</a>(.)</code>
of <code>target</code> and <code>current</code> should be compared.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>all.equal</code> is a generic function, dispatching methods on the
<code>target</code> argument.  To see the available methods, use
<code><a href="utils.html#topic+methods">methods</a>("all.equal")</code>, but note that the default method
also does some dispatching, e.g. using the raw method for logical
targets.
</p>
<p>Remember that arguments which follow <code>...</code> must be specified by
(unabbreviated) name.  It is inadvisable to pass unnamed arguments in
<code>...</code> as these will match different arguments in different
methods.
</p>
<p>Numerical comparisons for <code>scale = NULL</code> (the default) are
typically on a <em>relative difference</em> scale unless the
<code>target</code> values are close to zero or infinite. Specifically,
the scale is computed as the mean absolute value of <code>target</code>.
If this scale is finite and exceeds <code>tolerance</code>, differences
are expressed relative to it; otherwise, absolute differences are used.
Note that this scale and all further steps are computed only for those
vector elements
where <code>target</code> is not <code><a href="#topic+NA">NA</a></code> and differs from <code>current</code>.
If <code>countEQ</code> is true, the equal and <code>NA</code> cases are
<em>counted</em> in determining the &ldquo;sample&rdquo; size.
</p>
<p>If <code>scale</code> is numeric (and positive), absolute comparisons are
made after scaling (dividing) by <code>scale</code>.  Note that if all of
scale is close to 1 (specifically, within 1e-7), the difference is still
reported as being on an absolute scale.
</p>
<p>For complex <code>target</code>, the modulus (<code><a href="#topic+Mod">Mod</a></code>) of the
difference is used: <code>all.equal.numeric</code> is called so arguments
<code>tolerance</code> and <code>scale</code> are available.
</p>
<p>The <code><a href="#topic+list">list</a></code> method compares components of
<code>target</code> and <code>current</code> recursively, passing all other
arguments, as long as both are &ldquo;list-like&rdquo;, i.e., fulfill
either <code><a href="#topic+is.vector">is.vector</a></code> or <code><a href="#topic+is.list">is.list</a></code>.
</p>
<p>The <code><a href="#topic+environment">environment</a></code> method works via the <code>list</code> method,
and is also used for reference classes (unless a specific
<code>all.equal</code> method is defined).
</p>
<p>The method for date-time objects uses <code>all.equal.numeric</code> to
compare times (in <code>"<a href="#topic+POSIXct">POSIXct</a>"</code> representation) with a
default <code>tolerance</code> of 0.001 seconds, ignoring <code>scale</code>.
A time zone mismatch between <code>target</code> and <code>current</code> is
reported unless <code>check.tzone = FALSE</code>.
</p>
<p><code>attr.all.equal</code> is used for comparing
<code><a href="#topic+attributes">attributes</a></code>, returning <code>NULL</code> or a
<code>character</code> vector.
</p>


<h3>Value</h3>

<p>Either <code>TRUE</code> (<code>NULL</code> for <code>attr.all.equal</code>) or a vector
of <code><a href="#topic+mode">mode</a></code> <code>"character"</code> describing the differences
between <code>target</code> and <code>current</code>.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data. A Guide to the S Language</em>.
Springer (for <code>=</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+identical">identical</a></code>, <code><a href="#topic+isTRUE">isTRUE</a></code>, <code><a href="#topic++3D+3D">==</a></code>, and
<code><a href="#topic+all">all</a></code> for exact equality testing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>all.equal(pi, 355/113)
# not precise enough (default tol) &gt; relative error

quarts &lt;- 1/4 + 1:10 # exact
d45 &lt;- pi*quarts ; one &lt;- rep(1, 10)
tan(d45) == one  # mostly FALSE, as typically exact; embarrassingly,
tanpi(quarts) == one # (is always FALSE (Fedora 34; gcc 11.2.1))
stopifnot(all.equal(
          tan(d45), one)) # TRUE, but not if we are picky:
all.equal(tan(d45), one, tolerance = 0)  # to see difference
all.equal(tan(d45), one, tolerance = 0, scale = 1)# "absolute diff.."
all.equal(tan(d45), one, tolerance = 0, scale = 1+(-2:2)/1e9) # "absolute"
all.equal(tan(d45), one, tolerance = 0, scale = 1+(-2:2)/1e6) # "scaled"

## advanced: equality of environments
ae &lt;- all.equal(as.environment("package:stats"),
                asNamespace("stats"))
stopifnot(is.character(ae), length(ae) &gt; 10,
          ## were incorrectly "considered equal" in R &lt;= 3.1.1
          all.equal(asNamespace("stats"), asNamespace("stats")))

## A situation where  'countEQ = TRUE' makes sense:
x1 &lt;- x2 &lt;- (1:100)/10;  x2[2] &lt;- 1.1*x1[2]
## 99 out of 100 pairs (x1[i], x2[i]) are equal:
plot(x1,x2, main = "all.equal.numeric() -- not counting equal parts")
all.equal(x1,x2) ## "Mean relative difference: 0.1"
mtext(paste("all.equal(x1,x2) :", all.equal(x1,x2)), line= -2)
##' extract the 'Mean relative difference' as number:
all.eqNum &lt;- function(...) as.numeric(sub(".*:", '', all.equal(...)))
set.seed(17)
## When x2 is jittered, typically all pairs (x1[i],x2[i]) do differ:
summary(r &lt;- replicate(100, all.eqNum(x1, x2*(1+rnorm(x1)*1e-7))))
mtext(paste("mean(all.equal(x1, x2*(1 + eps_k))) {100 x} Mean rel.diff.=",
            signif(mean(r), 3)), line = -4, adj=0)
## With argument  countEQ=TRUE, get "the same" (w/o need for jittering):
mtext(paste("all.equal(x1,x2, countEQ=TRUE) :",
          signif(all.eqNum(x1,x2, countEQ=TRUE), 3)), line= -6, col=2)

## Using giveErr=TRUE :
x1. &lt;- x1 * (1+ 1e-9*rnorm(x1))
str(all.equal(x1, x1., giveErr=TRUE))
## logi TRUE
## - attr(*,  "err")= num 8.66e-10
## - attr(*, "what")= chr "relative"

## Used with stopifnot(), still *showing* diff:
all.equalShow &lt;- function (...) {
   r &lt;- all.equal(..., giveErr=TRUE)
   cat(attr(r,"what"), "err:", attr(r,"err"), "\n")
   c(r) # can drop attributes, as not used anymore
}
# checks, showing error in any case:
stopifnot(all.equalShow(x1, x1.)) # -&gt; relative err: 8.66002e-10
tryCatch(error=identity, stopifnot(all.equalShow(x1, 2*x1))) -&gt; eAe
stopifnot(inherits(eAe, "error"))
# stopifnot(all.equal....()) giving smart msg:
cat(conditionMessage(eAe), "\n")

two &lt;- structure(2, foo = 1, class = "bar")
all.equal(two^20, 2^20) # lots of diff
all.equal(two^20, 2^20, check.attributes = FALSE)# "target is bar, current is numeric"
all.equal(two^20, 2^20, check.attributes = FALSE, check.class = FALSE) # TRUE

## comparison of date-time objects
now &lt;- Sys.time()
stopifnot(
all.equal(now, now + 1e-4)  # TRUE (default tolerance = 0.001 seconds)
)
all.equal(now, now + 0.2)
all.equal(now, as.POSIXlt(now, "UTC"))
stopifnot(
all.equal(now, as.POSIXlt(now, "UTC"), check.tzone = FALSE)  # TRUE
)
</code></pre>

<hr>
<h2 id='all.names'>Find All Names in an Expression</h2><span id='topic+all.names'></span><span id='topic+all.vars'></span>

<h3>Description</h3>

<p>Return a character vector containing all the names which occur in an
expression or call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all.names(expr, functions = TRUE, max.names = -1L, unique = FALSE)

all.vars(expr, functions = FALSE, max.names = -1L, unique = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all.names_+3A_expr">expr</code></td>
<td>
<p>an <a href="#topic+expression">expression</a> or <a href="#topic+call">call</a> from which the names
are to be extracted.</p>
</td></tr>
<tr><td><code id="all.names_+3A_functions">functions</code></td>
<td>
<p>a logical value indicating whether function names
should be included in the result.</p>
</td></tr>
<tr><td><code id="all.names_+3A_max.names">max.names</code></td>
<td>
<p>the maximum number of names to be returned.  <code>-1</code>
indicates no limit (other than vector size limits).</p>
</td></tr>
<tr><td><code id="all.names_+3A_unique">unique</code></td>
<td>
<p>a logical value which indicates whether duplicate names
should be removed from the value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions differ only in the default values for their
arguments.
</p>


<h3>Value</h3>

<p>A character vector with the extracted names.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+substitute">substitute</a></code> to replace symbols with values in an expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>all.names(expression(sin(x+y)))
all.names(quote(sin(x+y))) # or a call
all.vars(expression(sin(x+y)))
</code></pre>

<hr>
<h2 id='any'>Are Some Values True?</h2><span id='topic+any'></span>

<h3>Description</h3>

<p>Given a set of logical vectors, is at least one of the values true?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="any_+3A_...">...</code></td>
<td>
<p>zero or more logical vectors.  Other objects of zero
length are ignored, and the rest are coerced to logical ignoring
any class.</p>
</td></tr>
<tr><td><code id="any_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  If true <code>NA</code> values are removed before
the result is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function: methods can be defined for it
directly or via the <code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.
For this to work properly, the arguments <code>...</code> should be
unnamed, and dispatch is on the first argument.
</p>
<p>Coercion of types other than integer (raw, double, complex, character,
list) gives a warning as this is often unintentional.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>Value</h3>

<p>The value is a logical vector of length one.
</p>
<p>Let <code>x</code> denote the concatenation of all the logical vectors in
<code>...</code> (after coercion), after removing <code>NA</code>s if requested by
<code>na.rm = TRUE</code>.
</p>
<p>The value returned is <code>TRUE</code> if at least one of the values in
<code>x</code> is <code>TRUE</code>, and <code>FALSE</code> if all of the values in
<code>x</code> are <code>FALSE</code> (including if there are no values).  Otherwise
the value is <code>NA</code> (which can only occur if <code>na.rm = FALSE</code>
and <code>...</code> contains no <code>TRUE</code> values and at least one
<code>NA</code> value).
</p>


<h3>S4 methods</h3>

<p>This is part of the S4 <code><a href="methods.html#topic+S4groupGeneric">Summary</a></code>
group generic.  Methods for it must use the signature
<code>x, ..., na.rm</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all">all</a></code>, the &lsquo;complement&rsquo; of <code>any</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>range(x &lt;- sort(round(stats::rnorm(10) - 1.2, 1)))
if(any(x &lt; 0)) cat("x contains negative values\n")
</code></pre>

<hr>
<h2 id='aperm'>Array Transposition</h2><span id='topic+aperm'></span><span id='topic+aperm.default'></span><span id='topic+aperm.table'></span>

<h3>Description</h3>

<p>Transpose an array by permuting its dimensions and optionally resizing
it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aperm(a, perm, ...)
## Default S3 method:
aperm(a, perm = NULL, resize = TRUE, ...)
## S3 method for class 'table'
aperm(a, perm = NULL, resize = TRUE, keep.class = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aperm_+3A_a">a</code></td>
<td>
<p>the array to be transposed.</p>
</td></tr>
<tr><td><code id="aperm_+3A_perm">perm</code></td>
<td>
<p>the subscript permutation vector, usually a permutation of
the integers <code>1:n</code>, where <code>n</code> is the number of dimensions
of <code>a</code>.  When <code>a</code> has named dimnames, it can be a
character vector of length <code>n</code> giving a permutation of those
names. The default (used whenever <code>perm</code> has zero length) is to
reverse the order of the dimensions.</p>
</td></tr>
<tr><td><code id="aperm_+3A_resize">resize</code></td>
<td>
<p>a flag indicating whether the vector should be
resized as well as having its elements reordered (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="aperm_+3A_keep.class">keep.class</code></td>
<td>
<p>logical indicating if the result should be of the
same class as <code>a</code>.</p>
</td></tr>
<tr><td><code id="aperm_+3A_...">...</code></td>
<td>
<p>potential further arguments of methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A transposed version of array <code>a</code>, with subscripts permuted as
indicated by the array <code>perm</code>.  If <code>resize</code> is <code>TRUE</code>,
the array is reshaped as well as having its elements permuted, the
<code>dimnames</code> are also permuted; if <code>resize = FALSE</code> then the
returned object has the same dimensions as <code>a</code>, and the dimnames
are dropped.  In each case other attributes are copied from <code>a</code>.
</p>
<p>The function <code>t</code> provides a faster and more convenient way of
transposing matrices.
</p>


<h3>Author(s)</h3>

<p>Jonathan Rougier, <a href="mailto:J.C.Rougier@durham.ac.uk">J.C.Rougier@durham.ac.uk</a> did the
faster C implementation.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+t">t</a></code>, to transpose matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># interchange the first two subscripts on a 3-way array x
x  &lt;- array(1:24, 2:4)
xt &lt;- aperm(x, c(2,1,3))
stopifnot(t(xt[,,2]) == x[,,2],
          t(xt[,,3]) == x[,,3],
          t(xt[,,4]) == x[,,4])

UCB &lt;- aperm(UCBAdmissions, c(2,1,3))
UCB[1,,]
summary(UCB) # UCB is still a contingency table

</code></pre>

<hr>
<h2 id='append'>Vector Merging</h2><span id='topic+append'></span>

<h3>Description</h3>

<p>Add elements to a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>append(x, values, after = length(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="append_+3A_x">x</code></td>
<td>
<p>the vector the values are to be appended to.</p>
</td></tr>
<tr><td><code id="append_+3A_values">values</code></td>
<td>
<p>to be included in the modified vector.</p>
</td></tr>
<tr><td><code id="append_+3A_after">after</code></td>
<td>
<p>a subscript, after which the values are to be appended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the values in <code>x</code> with the elements of
<code>values</code> appended after the specified element of <code>x</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>append(1:5, 0:1, after = 3)
</code></pre>

<hr>
<h2 id='apply'>Apply Functions Over Array Margins</h2><span id='topic+apply'></span>

<h3>Description</h3>

<p>Returns a vector or array or list of values obtained by applying a
function to margins of an array or matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply(X, MARGIN, FUN, ..., simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_+3A_x">X</code></td>
<td>
<p>an array, including a matrix.</p>
</td></tr>
<tr><td><code id="apply_+3A_margin">MARGIN</code></td>
<td>
<p>a vector giving the subscripts which the function will
be applied over.  E.g., for a matrix <code>1</code> indicates rows,
<code>2</code> indicates columns, <code>c(1, 2)</code> indicates rows and
columns. Where <code>X</code> has named dimnames, it can be a character
vector selecting dimension names.</p>
</td></tr>
<tr><td><code id="apply_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied: see &lsquo;Details&rsquo;.
In the case of functions like <code>+</code>, <code>%*%</code>, etc., the
function name must be backquoted or quoted.</p>
</td></tr>
<tr><td><code id="apply_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="apply_+3A_simplify">simplify</code></td>
<td>
<p>a logical indicating whether results should be
simplified if possible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>X</code> is not an array but an object of a class with a non-null
<code><a href="#topic+dim">dim</a></code> value (such as a data frame), <code>apply</code> attempts
to coerce it to an array via <code>as.matrix</code> if it is two-dimensional
(e.g., a data frame) or via <code>as.array</code>.
</p>
<p><code>FUN</code> is found by a call to <code><a href="#topic+match.fun">match.fun</a></code> and typically
is either a function or a symbol (e.g., a backquoted name) or a
character string specifying a function to be searched for from the
environment of the call to <code>apply</code>.
</p>
<p>Arguments in <code>...</code> cannot have the same name as any of the
other arguments, and care may be needed to avoid partial matching to
<code>MARGIN</code> or <code>FUN</code>.  In general-purpose code it is good
practice to name the first three arguments if <code>...</code> is passed
through: this both avoids partial matching to <code>MARGIN</code>
or <code>FUN</code> and ensures that a sensible error message is given if
arguments named <code>X</code>, <code>MARGIN</code> or <code>FUN</code> are passed
through <code>...</code>.
</p>


<h3>Value</h3>

<p>If each call to <code>FUN</code> returns a vector of length <code>n</code>,
and <code>simplify</code> is <code>TRUE</code>, 
then
<code>apply</code> returns an array of dimension <code>c(n, dim(X)[MARGIN])</code>
if <code>n &gt; 1</code>.  If <code>n</code> equals <code>1</code>, <code>apply</code> returns a
vector if <code>MARGIN</code> has length 1 and an array of dimension
<code>dim(X)[MARGIN]</code> otherwise.
If <code>n</code> is <code>0</code>, the result has length 0 but not necessarily
the &lsquo;correct&rsquo; dimension.
</p>
<p>If the calls to <code>FUN</code> return vectors of different lengths,
or if <code>simplify</code> is <code>FALSE</code>,
<code>apply</code> returns a list of length <code>prod(dim(X)[MARGIN])</code> with
<code>dim</code> set to <code>MARGIN</code> if this has length greater than one.
</p>
<p>In all cases the result is coerced by <code><a href="#topic+as.vector">as.vector</a></code> to one
of the basic vector types before the dimensions are set, so that (for
example) factor results will be coerced to a character array.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lapply">lapply</a></code> and there, <code><a href="#topic+simplify2array">simplify2array</a></code>;
<code><a href="#topic+tapply">tapply</a></code>, and convenience functions
<code><a href="#topic+sweep">sweep</a></code> and <code><a href="stats.html#topic+aggregate">aggregate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute row and column sums for a matrix:
x &lt;- cbind(x1 = 3, x2 = c(4:1, 2:5))
dimnames(x)[[1]] &lt;- letters[1:8]
apply(x, 2, mean, trim = .2)
col.sums &lt;- apply(x, 2, sum)
row.sums &lt;- apply(x, 1, sum)
rbind(cbind(x, Rtot = row.sums), Ctot = c(col.sums, sum(col.sums)))

stopifnot( apply(x, 2, is.vector))

## Sort the columns of a matrix
apply(x, 2, sort)

## keeping named dimnames
names(dimnames(x)) &lt;- c("row", "col")
x3 &lt;- array(x, dim = c(dim(x),3),
	    dimnames = c(dimnames(x), list(C = paste0("cop.",1:3))))
identical(x,  apply( x,  2,  identity))
identical(x3, apply(x3, 2:3, identity))

##- function with extra args:
cave &lt;- function(x, c1, c2) c(mean(x[c1]), mean(x[c2]))
apply(x, 1, cave,  c1 = "x1", c2 = c("x1","x2"))

ma &lt;- matrix(c(1:4, 1, 6:8), nrow = 2)
ma
apply(ma, 1, table)  #--&gt; a list of length 2
apply(ma, 1, stats::quantile) # 5 x n matrix with rownames

stopifnot(dim(ma) == dim(apply(ma, 1:2, sum)))

## Example with different lengths for each call
z &lt;- array(1:24, dim = 2:4)
zseq &lt;- apply(z, 1:2, function(x) seq_len(max(x)))
zseq         ## a 2 x 3 matrix
typeof(zseq) ## list
dim(zseq) ## 2 3
zseq[1,]
apply(z, 3, function(x) seq_len(max(x)))
# a list without a dim attribute
</code></pre>

<hr>
<h2 id='args'>Argument List of a Function</h2><span id='topic+args'></span>

<h3>Description</h3>

<p>Displays the argument names and corresponding default values of a
(non-primitive or primitive) function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>args(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="args_+3A_name">name</code></td>
<td>
<p>a function (a primitive or a closure, i.e.,
&ldquo;non-primitive&rdquo;).
If <code>name</code> is a character string then the function with that
name is found and used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is mainly used interactively to print the argument list
of a function.  For programming, consider using <code><a href="#topic+formals">formals</a></code>
instead.
</p>


<h3>Value</h3>

<p>For a closure, a closure with identical formal argument list but an
empty (<code>NULL</code>) body.
</p>
<p>For a primitive (function), a closure with the documented usage and <code>NULL</code>
body.  Note that some primitives do not make use of named arguments
and match by position rather than name.
</p>
<p><code>NULL</code> in case of a non-function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+formals">formals</a></code>, <code><a href="utils.html#topic+help">help</a></code>;
<code><a href="utils.html#topic+str">str</a></code> also prints the argument list of a function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## "regular" (non-primitive) functions "print their arguments"
## (by returning another function with NULL body which you also see):
args(ls)
args(graphics::plot.default)
utils::str(ls) # (just "prints": does not show a NULL)

## You can also pass a string naming a function.
args("scan")
## ...but :: package specification doesn't work in this case.
tryCatch(args("graphics::plot.default"), error = print)

## As explained above, args() gives a function with empty body:
list(is.f = is.function(args(scan)), body = body(args(scan)))

## Primitive functions mostly behave like non-primitive functions.
args(c)
args(`+`)
## primitive functions without well-defined argument list return NULL:
args(`if`)
</code></pre>

<hr>
<h2 id='Arithmetic'>Arithmetic Operators</h2><span id='topic++2B'></span><span id='topic+-'></span><span id='topic++2A'></span><span id='topic++2A+2A'></span><span id='topic++2F'></span><span id='topic++5E'></span><span id='topic++25+25'></span><span id='topic++25+2F+25'></span><span id='topic+Arithmetic'></span>

<h3>Description</h3>

<p>These unary and binary operators perform arithmetic on numeric or
complex vectors (or objects which can be coerced to them).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>+ x
- x
x + y
x - y
x * y
x / y
x ^ y
x %% y
x %/% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Arithmetic_+3A_x">x</code>, <code id="Arithmetic_+3A_y">y</code></td>
<td>
<p>numeric or complex vectors or objects which can be
coerced to such, or other objects for which methods have been written.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unary and binary arithmetic operators are generic functions:
methods can be written for them individually or via the
<code><a href="#topic+S3groupGeneric">Ops</a></code> group generic function.  (See
<code><a href="#topic+S3groupGeneric">Ops</a></code> for how dispatch is computed.)
</p>
<p>If applied to arrays the result will be an array if this is sensible
(for example it will not if the recycling rule has been invoked).
</p>
<p>Logical vectors will be coerced to integer or numeric vectors,
<code>FALSE</code> having value zero and <code>TRUE</code> having value one.
</p>
<p><code>1 ^ y</code> and <code>y ^ 0</code> are <code>1</code>, <em>always</em>.
<code>x ^ y</code> should also give the proper limit result when
either (numeric) argument is <a href="#topic+infinite">infinite</a> (one of <code>Inf</code> or
<code>-Inf</code>).
</p>
<p>Objects such as arrays or time-series can be operated on this
way provided they are conformable.
</p>
<p>For double arguments, <code>%%</code> can be subject to catastrophic loss of
accuracy if <code>x</code> is much larger than <code>y</code>, and a warning is
given if this is detected.
</p>
<p><code>%%</code> and <code>x %/% y</code> can be used for non-integer <code>y</code>,
e.g. <code>1 %/% 0.2</code>, but the results are subject to representation
error and so may be platform-dependent.  Mathematically, the answer to
<code>1 %/% 0.2</code> should be <code>5</code>, but because the <abbr>IEC</abbr> 60559
representation of <code>0.2</code> is a binary fraction slightly larger than
<code>0.2</code> most platforms give <code>4</code>.
</p>
<p>Users are sometimes surprised by the value returned, for example why
<code>(-8)^(1/3)</code> is <code>NaN</code>.  For <a href="#topic+double">double</a> inputs, <span class="rlang"><b>R</b></span> makes
use of <abbr>IEC</abbr> 60559 arithmetic on all platforms, together with the C
system function &lsquo;<span class="samp">&#8288;pow&#8288;</span>&rsquo; for the <code>^</code> operator.  The relevant
standards define the result in many corner cases.  In particular, the
result in the example above is mandated by the C99 standard.  On many
Unix-alike systems the command <code>man pow</code> gives details of the
values in a large number of corner cases.
</p>
<p>Arithmetic on type <a href="#topic+double">double</a> in <span class="rlang"><b>R</b></span> is supposed to be done in
&lsquo;round to nearest, ties to even&rsquo; mode, but this does depend on
the compiler and <abbr>FPU</abbr> being set up correctly.
</p>


<h3>Value</h3>

<p>Unary <code>+</code> and unary <code>-</code> return a numeric or complex vector.
All attributes (including class) are preserved if there is no
coercion: logical <code>x</code> is coerced to integer and names, dims and
dimnames are preserved.
</p>
<p>The binary operators return vectors containing the result of the element
by element operations.  If involving a zero-length vector the result
has length zero.  Otherwise, the elements of shorter vectors are recycled
as necessary (with a <code><a href="#topic+warning">warning</a></code> when they are recycled only
<em>fractionally</em>).  The operators are <code>+</code> for addition,
<code>-</code> for subtraction, <code>*</code> for multiplication, <code>/</code> for
division and <code>^</code> for exponentiation.
</p>
<p><code>%%</code> indicates <code>x mod y</code> (&ldquo;x modulo y&rdquo;), i.e.,
computes the &lsquo;remainder&rsquo; <code>r &lt;- x %% y</code>, and
<code>%/%</code> indicates integer division, where <span class="rlang"><b>R</b></span> uses &ldquo;floored&rdquo;
integer division, i.e., <code>q &lt;- x %/% y := floor(x/y)</code>, as promoted
by Donald Knuth, see the Wikipedia page on &lsquo;Modulo operation&rsquo;,
and hence <code>sign(r) == sign(y)</code>.  It is guaranteed that
</p>

<dl>
<dt><code> x == (x %% y) + y * (x %/% y) </code></dt><dd> <p> (up to rounding error)</p>
</dd>
</dl>

<p>unless <code>y == 0</code> where the result of <code>%%</code> is
<code><a href="#topic+NA_integer_">NA_integer_</a></code> or <code><a href="#topic+NaN">NaN</a></code> (depending on the
<code><a href="#topic+typeof">typeof</a></code> of the arguments) or for some non-<a href="#topic+finite">finite</a>
arguments, e.g., when the RHS of the identity above
amounts to <code>Inf - Inf</code>.
</p>
<p>If either argument is complex the result will be complex, otherwise if
one or both arguments are numeric, the result will be numeric.  If
both arguments are of type <a href="#topic+integer">integer</a>, the type of the result of
<code>/</code> and <code>^</code> is <a href="#topic+numeric">numeric</a> and for the other operators it
is integer (with overflow, which occurs at
<code class="reqn">\pm(2^{31} - 1)</code>,
returned as <code>NA_integer_</code> with a warning).
</p>
<p>The rules for determining the attributes of the result are rather
complicated.  Most attributes are taken from the longer argument.
Names will be copied from the first if it is the same length as the
answer, otherwise from the second if that is.  If the arguments are
the same length, attributes will be copied from both, with those of
the first argument taking precedence when the same attribute is
present in both arguments. For time series, these operations are
allowed only if the series are compatible, when the class and
<code><a href="stats.html#topic+tsp">tsp</a></code> attribute of whichever is a time series (the same,
if both are) are used.  For arrays (and an array result) the
dimensions and dimnames are taken from first argument if it is an
array, otherwise the second.
</p>


<h3>S4 methods</h3>

<p>These operators are members of the S4 <code><a href="methods.html#topic+Arith">Arith</a></code> group generic,
and so methods can be written for them individually as well as for the
group generic (or the <code>Ops</code> group generic), with arguments
<code>c(e1, e2)</code> (with <code>e2</code> missing for a unary operator).
</p>


<h3>Implementation limits</h3>

<p><span class="rlang"><b>R</b></span> is dependent on OS services (and they on <abbr>FPU</abbr>s) for floating-point
arithmetic.  On all current <span class="rlang"><b>R</b></span> platforms <abbr>IEC</abbr> 60559 (also known as IEEE
754) arithmetic is used, but some things in those standards are
optional.  In particular, the support for <em>denormal</em> aka
<em>subnormal</em> numbers
(those outside the range given by <code><a href="#topic+.Machine">.Machine</a></code>) may differ
between platforms and even between calculations on a single platform.
</p>
<p>Another potential issue is signed zeroes: on <abbr>IEC</abbr> 60559 platforms there
are two zeroes with internal representations differing by sign.  Where
possible <span class="rlang"><b>R</b></span> treats them as the same, but for example direct output
from C code often does not do so and may output &lsquo;<span class="samp">&#8288;-0.0&#8288;</span>&rsquo; (and on
Windows whether it does so or not depends on the version of Windows).
One place in <span class="rlang"><b>R</b></span> where the difference might be seen is in division by
zero: <code>1/x</code> is <code>Inf</code> or <code>-Inf</code> depending on the sign of
zero <code>x</code>.  Another place is
<code><a href="#topic+identical">identical</a>(0, -0, num.eq = FALSE)</code>.
</p>


<h3>Note</h3>

<p>All logical operations involving a zero-length vector have a
zero-length result.
</p>
<p>The binary operators are sometimes called as functions as
e.g. <code>`&amp;`(x, y)</code>: see the description of how
argument-matching is done in <code><a href="#topic+groupGeneric">Ops</a></code>.
</p>
<p><code>**</code> is translated in the parser to <code>^</code>, but this was
undocumented for many years.  It appears as an index entry in Becker
<abbr>et al.</abbr> (1988), pointing to the help for <code>Deprecated</code> but
is not actually mentioned on that page.  Even though it had been
deprecated in S for 20 years, it was still accepted in <span class="rlang"><b>R</b></span> in 2008.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>D. Goldberg (1991).
What Every Computer Scientist Should Know about Floating-Point
Arithmetic.
<em>ACM Computing Surveys</em>, <b>23</b>(1), 5&ndash;48.
<a href="https://doi.org/10.1145/103162.103163">doi:10.1145/103162.103163</a>.
<br />







Also available at
<a href="https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html">https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>.
</p>
<p>For the <abbr>IEC</abbr> 60559 (aka IEEE 754) standard:
<a href="https://www.iso.org/standard/57469.html">https://www.iso.org/standard/57469.html</a> and
<a href="https://en.wikipedia.org/wiki/IEEE_754">https://en.wikipedia.org/wiki/IEEE_754</a>.
</p>
<p>On the integer division and remainder (modulo) computations, <code>%%</code>
and <code>%/%</code>:  <a href="https://en.wikipedia.org/wiki/Modulo_operation">https://en.wikipedia.org/wiki/Modulo_operation</a>, and
Donald Knuth (1972)
<em>The Art of Computer Programming</em>, Vol.1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sqrt">sqrt</a></code> for miscellaneous and <code><a href="#topic+Special">Special</a></code> for special
mathematical functions.
</p>
<p><code><a href="#topic+Syntax">Syntax</a></code> for operator precedence.
</p>
<p><code><a href="#topic++25+2A+25">%*%</a></code> for matrix multiplication.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- -1:12
x + 1
2 * x + 3
x %%  3 # is periodic  2 0  1  2 0  1 ...
x %% -3 #  (ditto)    -1 0 -2 -1 0 -2 ...
x %/% 5
x %% Inf # now is defined by limit (gave NaN in earlier versions of R)

## Illustrating PR#18677, see above
1 %/% print(0.2, digits=19)

</code></pre>

<hr>
<h2 id='array'>Multi-way Arrays</h2><span id='topic+array'></span><span id='topic+as.array'></span><span id='topic+as.array.default'></span><span id='topic+is.array'></span>

<h3>Description</h3>

<p>Creates or tests for arrays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>array(data = NA, dim = length(data), dimnames = NULL)
as.array(x, ...)
is.array(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="array_+3A_data">data</code></td>
<td>
<p>a vector (including a list or <code><a href="#topic+expression">expression</a></code>
vector) giving data to fill the array.  Non-atomic classed objects
are coerced by <code><a href="#topic+as.vector">as.vector</a></code>.</p>
</td></tr>
<tr><td><code id="array_+3A_dim">dim</code></td>
<td>
<p>the dim attribute for the array to be created, that is an
integer vector of length one or more giving the maximal indices in
each dimension.</p>
</td></tr>
<tr><td><code id="array_+3A_dimnames">dimnames</code></td>
<td>
<p>either <code>NULL</code> or the names for the dimensions.
This must be a list (or it will be ignored) with one component for each
dimension, either <code>NULL</code> or a character vector of the length
given by <code>dim</code> for that dimension.  The list can be named, and
the list names will be used as names for the dimensions.  If the
list is shorter than the number of dimensions, it is extended by
<code>NULL</code>s to the length required.</p>
</td></tr>
<tr><td><code id="array_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="array_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An array in <span class="rlang"><b>R</b></span> can have one, two or more dimensions.  It is simply a
vector which is stored with additional <a href="#topic+attributes">attributes</a> giving the
dimensions (attribute <code>"dim"</code>) and optionally names for those
dimensions (attribute <code>"dimnames"</code>).
</p>
<p>A two-dimensional array is the same thing as a <code><a href="#topic+matrix">matrix</a></code>.
</p>
<p>One-dimensional arrays often look like vectors, but may be handled
differently by some functions: <code><a href="utils.html#topic+str">str</a></code> does distinguish
them in recent versions of <span class="rlang"><b>R</b></span>.
</p>
<p>The <code>"dim"</code> attribute is an integer vector of length one or more
containing non-negative values: the product of the values must match
the length of the array.
</p>
<p>The <code>"dimnames"</code> attribute is optional: if present it is a list
with one component for each dimension, either <code>NULL</code> or a
character vector of the length given by the element of the
<code>"dim"</code> attribute for that dimension.
</p>
<p><code>is.array</code> is a <a href="#topic+primitive">primitive</a> function.
</p>
<p>For a list array, the <code>print</code> methods prints entries of length
not one in the form &lsquo;<span class="samp">&#8288;integer,7&#8288;</span>&rsquo; indicating the type and length.
</p>


<h3>Value</h3>

<p><code>array</code> returns an array with the extents specified in <code>dim</code>
and naming information in <code>dimnames</code>.  The values in <code>data</code> are
taken to be those in the array with the leftmost subscript moving
fastest.  If there are too few elements in <code>data</code> to fill the array,
then the elements in <code>data</code> are recycled.  If <code>data</code> has
length zero, <code>NA</code> of an appropriate type is used for atomic
vectors (<code>0</code> for raw vectors) and <code>NULL</code> for lists.
</p>
<p>Unlike <code><a href="#topic+matrix">matrix</a></code>, <code>array</code> does not currently remove
any attributes left by <code>as.vector</code> from a classed list
<code>data</code>, so can return a list array with a class attribute.
</p>
<p><code>as.array</code> is a generic function for coercing to arrays.  The
default method does so by attaching a <code><a href="#topic+dim">dim</a></code> attribute to
it.  It also attaches <code><a href="#topic+dimnames">dimnames</a></code> if <code>x</code> has
<code><a href="#topic+names">names</a></code>.  The sole purpose of this is to make it possible
to access the <code>dim[names]</code> attribute at a later time.
</p>
<p><code>is.array</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is an array (i.e., has a <code>dim</code> attribute of
positive length) or not.  It is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Note</h3>

<p><code>is.array</code> is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aperm">aperm</a></code>, <code><a href="#topic+matrix">matrix</a></code>,
<code><a href="#topic+dim">dim</a></code>, <code><a href="#topic+dimnames">dimnames</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dim(as.array(letters))
array(1:3, c(2,4)) # recycle 1:3 "2 2/3 times"
#     [,1] [,2] [,3] [,4]
#[1,]    1    3    2    1
#[2,]    2    1    3    2
</code></pre>

<hr>
<h2 id='array2DF'>Convert array to data frame</h2><span id='topic+array2DF'></span>

<h3>Description</h3>

<p><code>array2DF</code> converts an array, including list arrays commonly
returned by <code>tapply</code>, into data frames for use in further
analysis or plotting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>array2DF(x, responseName = "Value",
         sep = "", base = list(LETTERS),
         simplify = TRUE, allowLong = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="array2DF_+3A_x">x</code></td>
<td>
<p>an array object.</p>
</td></tr>
<tr><td><code id="array2DF_+3A_responsename">responseName</code></td>
<td>
<p>character string, used for creating column name(s)
in the result, if required. </p>
</td></tr>
<tr><td><code id="array2DF_+3A_sep">sep</code></td>
<td>
<p>character string, used as separator when creating new
names, if required. </p>
</td></tr>
<tr><td><code id="array2DF_+3A_base">base</code></td>
<td>
<p>character vector, giving an initial set of names to create
dimnames of <code>x</code>, if missing. </p>
</td></tr>
<tr><td><code id="array2DF_+3A_simplify">simplify</code></td>
<td>
<p>logical, whether to attempt simplification of the
result. </p>
</td></tr>
<tr><td><code id="array2DF_+3A_allowlong">allowLong</code></td>
<td>
<p>logical, specifying whether a long format data frame
should be returned if <code>x</code> is a list array and all elements of
<code>x</code> are unnamed atomic vectors. Ignored unless <code>simplify =
    TRUE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main use of <code>array2DF</code> is to convert an array, as typically
returned by <code><a href="#topic+tapply">tapply</a></code>, into a data frame.
</p>
<p>When <code>simplify = FALSE</code>, this is similar to
<code><a href="#topic+as.data.frame.table">as.data.frame.table</a></code>, except that it works for list
arrays as well as atomic arrays. Specifically, the resulting data
frame has one row for each element of the array, with one column for
each dimension of the array giving the corresponding
<code><a href="#topic+dimnames">dimnames</a></code>. The contents of the array are placed in a
column whose name is given by the <code>responseName</code> argument. The
mode of this column is the same as that of <code>x</code>, usually an atomic
vector or a list.
</p>
<p>If <code>x</code> does not have <code><a href="#topic+dimnames">dimnames</a></code>, they are
automatically created using <code>base</code> and <code>sep</code>.
</p>
<p>In the default case, when <code>simplify = TRUE</code>, some common cases
are handled specially.
</p>
<p>If all components of <code>x</code> are data frames with identical column
names (with possibly different numbers of rows), they are
<code><a href="#topic+rbind">rbind</a></code>-ed to form the response. The additional columns
giving <code>dimnames</code> are repeated according to the number of
rows, and <code>responseName</code> is ignored in this case.
</p>
<p>If all components of <code>x</code> are <em>unnamed</em> atomic vectors
<em>and</em> <code>allowLong = TRUE</code>, each component is treated as a
single-column data frame with column name given by
<code>responseName</code>, and processed as above.
</p>
<p>In all other cases, an attempt to simplify is made by
<code><a href="#topic+simplify2array">simplify2array</a></code>. If this results in multiple unnamed
columns, names are constructed using <code>responseName</code> and
<code>sep</code>.
</p>


<h3>Value</h3>

<p>A data frame with at least <code>length(dim(x)) + 1</code> columns. The
first <code>length(dim(x))</code> columns each represent one dimension of
<code>x</code> and gives the corresponding values of <code>dimnames</code>, which
are implicitly created if necessary. The remaining columns contain the
contents of <code>x</code>, after attempted simplification if requested.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tapply">tapply</a></code>, <code><a href="#topic+as.data.frame.table">as.data.frame.table</a></code>,
<code><a href="#topic+split">split</a></code>, <code><a href="stats.html#topic+aggregate">aggregate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s1 &lt;- with(ToothGrowth,
           tapply(len, list(dose, supp), mean, simplify = TRUE))

s2 &lt;- with(ToothGrowth,
           tapply(len, list(dose, supp), mean, simplify = FALSE))

str(s1) # atomic array
str(s2) # list array

str(array2DF(s1, simplify = FALSE)) # Value column is vector
str(array2DF(s2, simplify = FALSE)) # Value column is list
str(array2DF(s2, simplify = TRUE))  # simplified to vector

### The remaining examples use the default 'simplify = TRUE' 

## List array with list components: columns are lists (no simplification)

with(ToothGrowth,
     tapply(len, list(dose, supp),
     function(x) t.test(x)[c("p.value", "alternative")])) |&gt;
  array2DF() |&gt; str()

## List array with data frame components: columns are atomic (simplified)

with(ToothGrowth,
     tapply(len, list(dose, supp),
     function(x) with(t.test(x), data.frame(p.value, alternative)))) |&gt;
  array2DF() |&gt; str()

## named vectors

with(ToothGrowth,
     tapply(len, list(dose, supp),
            quantile)) |&gt; array2DF()

## unnamed vectors: long format

with(ToothGrowth,
     tapply(len, list(dose, supp),
            sample, size = 5)) |&gt; array2DF()

## unnamed vectors: wide format

with(ToothGrowth,
     tapply(len, list(dose, supp),
            sample, size = 5)) |&gt; array2DF(allowLong = FALSE)

## unnamed vectors of unequal length

with(ToothGrowth[-1, ],
     tapply(len, list(dose, supp),
            sample, replace = TRUE)) |&gt;
  array2DF(allowLong = FALSE)

## unnamed vectors of unequal length with allowLong = TRUE
## (within-group bootstrap)

with(ToothGrowth[-1, ],
     tapply(len, list(dose, supp), sample, replace = TRUE)) |&gt;
  array2DF() |&gt; str()

## data frame input

tapply(ToothGrowth, ~ dose + supp, FUN = with,
       data.frame(n = length(len), mean = mean(len), sd = sd(len))) |&gt;
  array2DF()

</code></pre>

<hr>
<h2 id='as.data.frame'>Coerce to a Data Frame</h2><span id='topic+as.data.frame'></span><span id='topic+is.data.frame'></span><span id='topic+as.data.frame.AsIs'></span><span id='topic+as.data.frame.character'></span><span id='topic+as.data.frame.data.frame'></span><span id='topic+as.data.frame.default'></span><span id='topic+as.data.frame.list'></span><span id='topic+as.data.frame.matrix'></span><span id='topic+as.data.frame.model.matrix'></span><span id='topic+as.data.frame.ts'></span><span id='topic+as.data.frame.vector'></span><span id='topic+as.data.frame.array'></span>

<h3>Description</h3>

<p>Functions to check if an object is a data frame, or coerce it if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.data.frame(x, row.names = NULL, optional = FALSE, ...)

## S3 method for class 'character'
as.data.frame(x, ...,
              stringsAsFactors = FALSE)

## S3 method for class 'list'
as.data.frame(x, row.names = NULL, optional = FALSE, ...,
              cut.names = FALSE, col.names = names(x), fix.empty.names = TRUE,
              check.names = !optional,
              stringsAsFactors = FALSE)

## S3 method for class 'matrix'
as.data.frame(x, row.names = NULL, optional = FALSE,
              make.names = TRUE, ...,
              stringsAsFactors = FALSE)

as.data.frame.vector(x, row.names = NULL, optional = FALSE, ...,
                     nm = deparse1(substitute(x)))

is.data.frame(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_row.names">row.names</code></td>
<td>
<p><code>NULL</code> or a character vector giving the row
names for the data frame.  Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_optional">optional</code></td>
<td>
<p>logical. If <code>TRUE</code>, setting row names and
converting column names (to syntactic names: see
<code><a href="#topic+make.names">make.names</a></code>) is optional.  Note that all of <span class="rlang"><b>R</b></span>'s
<span class="pkg">base</span> package <code>as.data.frame()</code> methods use
<code>optional</code> only for column names treatment, basically with the
meaning of <code><a href="#topic+data.frame">data.frame</a>(*, check.names = !optional)</code>.
See also the <code>make.names</code> argument of the <code>matrix</code> method.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical: should the character vector be converted
to a factor?</p>
</td></tr>

<tr><td><code id="as.data.frame_+3A_cut.names">cut.names</code></td>
<td>
<p>logical or integer; indicating if column names with
more than 256 (or <code>cut.names</code> if that is numeric) characters
should be shortened (and the last 6 characters replaced by <code>" ..."</code>).</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_col.names">col.names</code></td>
<td>
<p>(optional) character vector of column names.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_fix.empty.names">fix.empty.names</code></td>
<td>
<p>logical indicating if empty column names, i.e.,
<code>""</code> should be fixed up (in <code><a href="#topic+data.frame">data.frame</a></code>) or not.</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_check.names">check.names</code></td>
<td>
<p>logical; passed to the <code><a href="#topic+data.frame">data.frame</a>()</code> call.</p>
</td></tr>

<tr><td><code id="as.data.frame_+3A_make.names">make.names</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code>, i.e., one of <code>FALSE, NA, TRUE</code>,
indicating what should happen if the row names (of the matrix
<code>x</code>) are invalid.  If they are invalid, the default,
<code>TRUE</code>, calls <code><a href="#topic+make.names">make.names</a>(*, unique=TRUE)</code>;
<code>make.names=NA</code> will use &ldquo;automatic&rdquo; row names and a
<code>FALSE</code> value will signal an error for invalid row names.</p>
</td></tr>

<tr><td><code id="as.data.frame_+3A_nm">nm</code></td>
<td>
<p>a <code><a href="#topic+character">character</a></code> string to be used as column name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.data.frame</code> is a generic function with many methods, and
users and packages can supply further methods.  For classes that act
as vectors, often a copy of <code>as.data.frame.vector</code> will work
as the method.
</p>
<p>Since <span class="rlang"><b>R</b></span> 4.3.0, the <em>default</em> method will call
<code>as.data.frame.vector</code> for atomic (as by <code><a href="#topic+is.atomic">is.atomic</a></code>) <code>x</code>.
</p>
<p>Direct calls of <code>as.data.frame.<var>class</var></code> are still possible (base package!),
for 12 atomic base classes, but are deprecated
where calling <code>as.data.frame.vector</code> instead is recommended.
</p>
<p>If a list is supplied, each element is converted to a column in the
data frame.  Similarly, each column of a matrix is converted separately.
This can be overridden if the object has a class which has
a method for <code>as.data.frame</code>: two examples are
matrices of class <code>"<a href="stats.html#topic+model.matrix">model.matrix</a>"</code> (which are
included as a single column) and list objects of class
<code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code> which are coerced to class
<code>"<a href="#topic+POSIXct">POSIXct</a>"</code>.
</p>
<p>Arrays can be converted to data frames.  One-dimensional arrays are
treated like vectors and two-dimensional arrays like matrices.  Arrays
with more than two dimensions are converted to matrices by
&lsquo;flattening&rsquo; all dimensions after the first and creating
suitable column labels.
</p>
<p>Character variables are converted to factor columns unless protected
by <code><a href="#topic+I">I</a></code>.
</p>
<p>If a data frame is supplied, all classes preceding <code>"data.frame"</code>
are stripped, and the row names are changed if that argument is supplied.
</p>
<p>If <code>row.names = NULL</code>, row names are constructed from the names
or dimnames of <code>x</code>, otherwise are the integer sequence
starting at one.  Few of the methods check for duplicated row names.
Names are removed from vector columns unless <code><a href="#topic+I">I</a></code>.
</p>


<h3>Value</h3>

<p><code>as.data.frame</code> returns a data frame, normally with all row names
<code>""</code> if <code>optional = TRUE</code>.
</p>
<p><code>is.data.frame</code> returns <code>TRUE</code> if its argument is a data
frame (that is, has <code>"data.frame"</code> amongst its classes)
and <code>FALSE</code> otherwise.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>, <code><a href="#topic+as.data.frame.table">as.data.frame.table</a></code> for the
<code>table</code> method (which has additional arguments if called directly).
</p>

<hr>
<h2 id='as.Date'>Date Conversion Functions to and from Character</h2><span id='topic+format.Date'></span><span id='topic+as.character.Date'></span><span id='topic+as.Date'></span><span id='topic+as.Date.character'></span><span id='topic+as.Date.default'></span><span id='topic+as.Date.factor'></span><span id='topic+as.Date.POSIXct'></span><span id='topic+as.Date.POSIXlt'></span><span id='topic+as.Date.date'></span><span id='topic+as.Date.dates'></span><span id='topic+as.Date.numeric'></span>

<h3>Description</h3>

<p>Functions to convert between character representations and objects of
class <code>"Date"</code> representing calendar dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.Date(x, ...)
## S3 method for class 'character'
as.Date(x, format, tryFormats = c("%Y-%m-%d", "%Y/%m/%d"),
        optional = FALSE, ...)
## S3 method for class 'numeric'
as.Date(x, origin, ...)
## S3 method for class 'POSIXct'
as.Date(x, tz = "UTC", ...)

## S3 method for class 'Date'
format(x, format = "%Y-%m-%d", ...)

## S3 method for class 'Date'
as.character(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.Date_+3A_x">x</code></td>
<td>
<p>an object to be converted.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_format">format</code></td>
<td>
<p>a <code><a href="#topic+character">character</a></code> string.  If not specified when
converting from a character representation, it will try
<code>tryFormats</code> one by one on the first non-<code>NA</code> element, and
give an error if none works.  Otherwise, the processing is via
<code><a href="#topic+strptime">strptime</a>()</code> whose help page describes available
conversion specifications.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_tryformats">tryFormats</code></td>
<td>
<p><code><a href="#topic+character">character</a></code> vector of <code>format</code>
strings to try if <code>format</code> is not specified.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_optional">optional</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating to return <code>NA</code>
(instead of signalling an error) if the format guessing does not succeed.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_origin">origin</code></td>
<td>
<p>a <code>Date</code> object, or something which can be coerced by
<code>as.Date(origin, ...)</code> to such an object or
<code><a href="#topic+missing">missing</a></code>.  In that case, <code>"1970-01-01"</code> is used.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_tz">tz</code></td>
<td>
<p>a time zone name.</p>
</td></tr>
<tr><td><code id="as.Date_+3A_...">...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usual vector re-cycling rules are applied to <code>x</code> and
<code>format</code> so the answer will be of length that of the longer of the
vectors.
</p>
<p>Locale-specific conversions to and from character strings are used
where appropriate and available.  This affects the names of the days
and months.
</p>
<p>The <code>as.Date</code> methods accept character strings, factors, logical
<code>NA</code> and objects of classes <code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code> and
<code>"<a href="#topic+POSIXct">POSIXct</a>"</code>.  (The last is converted to days by ignoring
the time after midnight in the representation of the time in specified
time zone, default UTC.)  Also objects of class <code>"date"</code> (from
package <span class="pkg"><a href="date.html#topic+as.date">date</a></span>) and <code>"dates"</code> (from
package <span class="pkg"><a href="chron.html#topic+chron">chron</a></span>).  Character strings are processed
as far as necessary for the format specified: any trailing characters
are ignored.
</p>
<p><code>as.Date</code> will accept numeric data (the number of days since an
epoch), since <span class="rlang"><b>R</b></span> 4.3.0 also when <code>origin</code> is not supplied.
</p>
<p>The <code>format</code> and <code>as.character</code> methods ignore any
fractional part of the date.
</p>


<h3>Value</h3>

<p>The <code>format</code> and <code>as.character</code> methods return a character vector
representing the date.  <code>NA</code> dates are returned as <code>NA_character_</code>.
</p>
<p>The <code>as.Date</code> methods return an object of class <code>"<a href="#topic+Date">Date</a>"</code>.
</p>


<h3>Conversion from other Systems</h3>

<p>Most systems record dates internally as the number of days since some
origin, but this is fraught with problems, including
</p>

<ul>
<li><p> Is the origin day 0 or day 1?  As the &lsquo;Examples&rsquo; show,
Excel manages to use both choices for its two date systems.
</p>
</li>
<li><p> If the origin is far enough back, the designers may show their
ignorance of calendar systems.  For example, Excel's designer
thought 1900 was a leap year (claiming to copy the error from
earlier DOS spreadsheets), and Matlab's designer chose the
non-existent date of &lsquo;January 0, 0000&rsquo; (there is no such day),
not specifying the calendar.  (There is such a year in the
&lsquo;Gregorian&rsquo; calendar as used in ISO 8601:2004, but that does say
that it is only to be used for years before 1582 with the agreement
of the parties in information exchange.)
</p>
</li></ul>

<p>The only safe procedure is to check the other systems values for known
dates: reports on the Internet (including R-help) are more often wrong
than right.
</p>


<h3>Note</h3>

<p>The default formats follow the rules of the ISO 8601 international
standard which expresses a day as <code>"2001-02-03"</code>.
</p>
<p>If the date string does not specify the date completely, the returned
answer may be system-specific.  The most common behaviour is to assume
that a missing year, month or day is the current one.  If it specifies
a date incorrectly, reliable implementations will give an error and
the date is reported as <code>NA</code>.  Unfortunately some common
implementations (such as &lsquo;<span class="samp">&#8288;glibc&#8288;</span>&rsquo;) are unreliable and guess at the
intended meaning.
</p>
<p>Years before 1CE (aka 1AD) will probably not be handled correctly.
</p>


<h3>References</h3>

<p>International Organization for Standardization (2004, 1988, 1997,
...)
<em>ISO 8601. Data elements and interchange formats &ndash;
Information interchange &ndash; Representation of dates and times.</em>
For links to versions available on-line see (at the time of writing)
<a href="https://www.qsl.net/g1smd/isopdf.htm">https://www.qsl.net/g1smd/isopdf.htm</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+Date">Date</a> for details of the date class;
<code><a href="#topic+locales">locales</a></code> to query or set a locale.
</p>
<p>Your system's help pages on <code>strftime</code> and <code>strptime</code> to see
how to specify their formats.  Windows users will find no help page
for <code>strptime</code>: code based on &lsquo;<span class="samp">&#8288;glibc&#8288;</span>&rsquo; is used (with
corrections), so all the format specifiers described here are
supported, but with no alternative number representation nor era
available in any locale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## locale-specific version of the date
format(Sys.Date(), "%a %b %d")

## read in date info in format 'ddmmmyyyy'
## This will give NA(s) in some locales; setting the C locale
## as in the commented lines will overcome this on most systems.
## lct &lt;- Sys.getlocale("LC_TIME"); Sys.setlocale("LC_TIME", "C")
x &lt;- c("1jan1960", "2jan1960", "31mar1960", "30jul1960")
z &lt;- as.Date(x, "%d%b%Y")
## Sys.setlocale("LC_TIME", lct)
z

## read in date/time info in format 'm/d/y'
dates &lt;- c("02/27/92", "02/27/92", "01/14/92", "02/28/92", "02/01/92")
as.Date(dates, "%m/%d/%y")

## date given as number of days since 1900-01-01 (a date in 1989)
as.Date(32768, origin = "1900-01-01")
## Excel is said to use 1900-01-01 as day 1 (Windows default) or
## 1904-01-01 as day 0 (Mac default), but this is complicated by Excel
## incorrectly treating 1900 as a leap year.
## So for dates (post-1901) from Windows Excel
as.Date(35981, origin = "1899-12-30") # 1998-07-05
## and Mac Excel
as.Date(34519, origin = "1904-01-01") # 1998-07-05
## (these values come from http://support.microsoft.com/kb/214330)

## Experiment shows that Matlab's origin is 719529 days before ours,
## (it takes the non-existent 0000-01-01 as day 1)
## so Matlab day 734373 can be imported as
as.Date(734373) - 719529 # 2010-08-23
## (value from
## http://www.mathworks.de/de/help/matlab/matlab_prog/represent-date-and-times-in-MATLAB.html)

## Time zone effect
z &lt;- ISOdate(2010, 04, 13, c(0,12)) # midnight and midday UTC
as.Date(z) # in UTC
## these time zone names are common
as.Date(z, tz = "NZ")
as.Date(z, tz = "HST") # Hawaii
</code></pre>

<hr>
<h2 id='as.environment'> Coerce to an Environment Object </h2><span id='topic+as.environment'></span>

<h3>Description</h3>

<p>A generic function coercing an <span class="rlang"><b>R</b></span> object to an
<code><a href="#topic+environment">environment</a></code>.  A number or a character string is
converted to the corresponding environment on the search path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.environment(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.environment_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object to convert.  If it is already an
environment, just return it.  If it is a positive number, return the
environment corresponding to that position on the search list. If it
is <code>-1</code>, the environment it is called from.  If
it is a character string, match the string to the names on the
search list.
</p>
<p>If it is a list, the equivalent of <code><a href="#topic+list2env">list2env</a>(x,
      parent = emptyenv())</code> is returned.
</p>
<p>If <code><a href="#topic+is.object">is.object</a>(x)</code> is true and it has a <code><a href="#topic+class">class</a></code>
for which an <code>as.environment</code> method is found, that is used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a <a href="#topic+primitive">primitive</a> generic function: you can write methods to
handle specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Value</h3>

<p>The corresponding environment object.
</p>


<h3>Author(s)</h3>

<p> John Chambers </p>


<h3>See Also</h3>

<p><code><a href="#topic+environment">environment</a></code> for creation and manipulation,
<code><a href="#topic+search">search</a></code>;
<code><a href="#topic+list2env">list2env</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.environment(1) ## the global environment
identical(globalenv(), as.environment(1)) ## is TRUE
try( ## &lt;&lt;- stats need not be attached
    as.environment("package:stats"))
ee &lt;- as.environment(list(a = "A", b = pi, ch = letters[1:8]))
ls(ee) # names of objects in ee
utils::ls.str(ee)
</code></pre>

<hr>
<h2 id='as.function'>Convert Object to Function</h2><span id='topic+as.function'></span><span id='topic+as.function.default'></span>

<h3>Description</h3>

<p><code>as.function</code> is a generic function which is used to convert
objects to functions.
</p>
<p><code>as.function.default</code> works on a list <code>x</code>, which should contain the
concatenation of a formal argument list and an expression or an
object of mode <code>"<a href="#topic+call">call</a>"</code> which will become the function body.
The function will be defined in a specified environment, by default
that of the caller.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.function(x, ...)

## Default S3 method:
as.function(x, envir = parent.frame(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.function_+3A_x">x</code></td>
<td>
<p>object to convert, a list for the default method.</p>
</td></tr>
<tr><td><code id="as.function_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="as.function_+3A_envir">envir</code></td>
<td>
<p>environment in which the function should be defined.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The desired function.
</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard</p>


<h3>See Also</h3>

<p><code><a href="#topic+function">function</a></code>;
<code><a href="#topic+alist">alist</a></code> which is handy for the construction of
argument lists, etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>as.function(alist(a = , b = 2, a+b))
as.function(alist(a = , b = 2, a+b))(3)
</code></pre>

<hr>
<h2 id='as.POSIX+2A'>Date-time Conversion Functions</h2><span id='topic+as.POSIXct'></span><span id='topic+as.POSIXct.default'></span><span id='topic+as.POSIXct.POSIXlt'></span><span id='topic+as.POSIXct.date'></span><span id='topic+as.POSIXct.dates'></span><span id='topic+as.POSIXct.Date'></span><span id='topic+as.POSIXct.numeric'></span><span id='topic+as.POSIXlt'></span><span id='topic+as.POSIXlt.Date'></span><span id='topic+as.POSIXlt.date'></span><span id='topic+as.POSIXlt.dates'></span><span id='topic+as.POSIXlt.POSIXct'></span><span id='topic+as.POSIXlt.factor'></span><span id='topic+as.POSIXlt.character'></span><span id='topic+as.POSIXlt.default'></span><span id='topic+as.POSIXlt.numeric'></span><span id='topic+as.double.POSIXlt'></span>

<h3>Description</h3>

<p>Functions to manipulate objects of classes <code>"POSIXlt"</code> and
<code>"POSIXct"</code> representing calendar dates and times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.POSIXct(x, tz = "", ...)
as.POSIXlt(x, tz = "", ...)

## S3 method for class 'character'
as.POSIXlt(x, tz = "", format,
           tryFormats = c("%Y-%m-%d %H:%M:%OS",
                          "%Y/%m/%d %H:%M:%OS",
                          "%Y-%m-%d %H:%M",
                          "%Y/%m/%d %H:%M",
                          "%Y-%m-%d",
                          "%Y/%m/%d"),
           optional = FALSE, ...)
## Default S3 method:
as.POSIXlt(x, tz = "",
           optional = FALSE, ...)
## S3 method for class 'numeric'
as.POSIXlt(x, tz = "", origin, ...)

## S3 method for class 'Date'
as.POSIXct(x, tz = "UTC", ...)
## S3 method for class 'Date'
as.POSIXlt(x, tz = "UTC", ...)
## S3 method for class 'numeric'
as.POSIXct(x, tz = "", origin, ...)

## S3 method for class 'POSIXlt'
as.double(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.POSIX+2B2A_+3A_x">x</code></td>
<td>
<p><span class="rlang"><b>R</b></span>  object to be converted.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_tz">tz</code></td>
<td>
<p>a character string.  The time zone specification to be used
for the conversion, <em>if one is required</em>.  System-specific (see
<a href="#topic+time+20zones">time zones</a>), but <code>""</code> is the current time zone, and
<code>"GMT"</code> is UTC (Universal Time, Coordinated).  Invalid values
are most commonly treated as UTC, on some platforms with a warning.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_format">format</code></td>
<td>
<p>character string giving a date-time format as used
by <code><a href="#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_tryformats">tryFormats</code></td>
<td>
<p><code><a href="#topic+character">character</a></code> vector of <code>format</code>
strings to try if <code>format</code> is not specified.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_optional">optional</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating to return <code>NA</code>
(instead of signalling an error) if the format guessing does not succeed.</p>
</td></tr>
<tr><td><code id="as.POSIX+2B2A_+3A_origin">origin</code></td>
<td>
<p>a date-time object, or something which can be coerced by
<code>as.POSIXct(tz = "GMT")</code> to such an object.  Optional since <span class="rlang"><b>R</b></span>
4.3.0, where the equivalent of <code>"1970-01-01"</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>as.POSIX*</code> functions convert an object to one of the two
classes used to represent date/times (calendar dates plus time to the
nearest second).  They can convert objects of the other class and of
class <code>"<a href="#topic+Date">Date</a>"</code> to these classes.  Dates without times are
treated as being at midnight UTC.
</p>
<p>They can also convert character strings of the formats
<code>"2001-02-03"</code> and <code>"2001/02/03"</code> optionally followed by
white space and a time in the format <code>"14:52"</code> or
<code>"14:52:03"</code>.  (Formats such as <code>"01/02/03"</code> are ambiguous
but can be converted via a format specification by
<code><a href="#topic+strptime">strptime</a></code>.)  Fractional seconds are allowed.
Alternatively, <code>format</code> can be specified for character vectors or
factors: if it is not specified and no standard format works for
all non-<code>NA</code> inputs an error is thrown.
</p>
<p>If <code>format</code> is specified, remember that some of the format
specifications are locale-specific, and you may need to set the
<code>LC_TIME</code> category appropriately <em>via</em>
<code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code>.  This most often affects the use of
<code>%a</code>, <code>%A</code> (weekday names),
<code>%b</code>, <code>%B</code> (month names) and <code>%p</code> (AM/PM).
</p>
<p>Logical <code>NA</code>s can be converted to either of the classes, but no
other logical vectors can be.
</p>
<p>If you are given a numeric time as the number of seconds since an
epoch, see the examples.
</p>
<p>Character input is first converted to class <code>"POSIXlt"</code> by
<code><a href="#topic+strptime">strptime</a></code>: numeric input is first converted to
<code>"POSIXct"</code>.  Any conversion that needs to go between the two
date-time classes requires a time zone: conversion from
<code>"POSIXlt"</code> to <code>"POSIXct"</code> will validate times in the
selected time zone.  One issue is what happens at transitions
to and from DST, for example in the UK
</p>
<pre>as.POSIXct(strptime("2011-03-27 01:30:00", "%Y-%m-%d %H:%M:%S"))
as.POSIXct(strptime("2010-10-31 01:30:00", "%Y-%m-%d %H:%M:%S"))
</pre>
<p>are respectively invalid (the clocks went forward at 1:00 GMT to 2:00
<abbr>BST</abbr>) and ambiguous (the clocks went back at 2:00 <abbr>BST</abbr> to 1:00 GMT).  What
happens in such cases is OS-specific: one should expect the first to
be <code>NA</code>, but the second could be interpreted as either <abbr>BST</abbr> or
GMT (and common OSes give both possible values).  Note too (see
<code><a href="#topic+strftime">strftime</a></code>) that OS facilities may not format invalid
times correctly.
</p>


<h3>Value</h3>

<p><code>as.POSIXct</code> and <code>as.POSIXlt</code> return an object of the
appropriate class.  If <code>tz</code> was specified, <code>as.POSIXlt</code>
will give an appropriate <code>"tzone"</code> attribute.  Date-times known
to be invalid will be returned as <code>NA</code>.
</p>


<h3>Note</h3>

<p>Some of the concepts used have to be extended backwards in time (the
usage is said to be &lsquo;proleptic&rsquo;).  For example, the origin of
time for the <code>"POSIXct"</code> class, &lsquo;1970-01-01 00:00.00 UTC&rsquo;,
is before UTC was defined.  More importantly, conversion is done
assuming the Gregorian calendar which was introduced in 1582 and not
used near-universally until the 20th century.  One of the
re-interpretations assumed by ISO 8601:2004 is that there was a year
zero, even though current year numbering (and zero) is a much later
concept (525 CE for year numbers from 1 CE).
</p>
<p>Conversions between <code>"POSIXlt"</code> and <code>"POSIXct"</code> of future
times are speculative except in UTC.  The main uncertainty is in the
use of and transitions to/from DST (most systems will assume the
continuation of current rules but these can be changed at short
notice).
</p>
<p>If you want to extract specific aspects of a time (such as the day of
the week) just convert it to class <code>"POSIXlt"</code> and extract the
relevant component(s) of the list, or if you want a character
representation (such as a named day of the week) use the
<code><a href="#topic+strptime">format</a></code> method.
</p>
<p>If a time zone is needed and that specified is invalid on your system,
what happens is system-specific but attempts to set it will probably
be ignored.
</p>
<p>Conversion from character needs to find a suitable format unless one
is supplied (by trying common formats in turn): this can be slow for
long inputs.
</p>


<h3>See Also</h3>

<p><a href="#topic+DateTimeClasses">DateTimeClasses</a> for details of the classes;
<code><a href="#topic+strptime">strptime</a></code> for conversion to and from character
representations.
</p>
<p><code><a href="#topic+Sys.timezone">Sys.timezone</a></code> for details of the (system-specific) naming
of time zones.
</p>
<p><a href="#topic+locales">locales</a> for locale-specific aspects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(z &lt;- Sys.time())             # the current datetime, as class "POSIXct"
unclass(z)                    # a large integer
floor(unclass(z)/86400)       # the number of days since 1970-01-01 (UTC)
(now &lt;- as.POSIXlt(Sys.time())) # the current datetime, as class "POSIXlt"
str(unclass(now))             # the internal list ; use now$hour, etc :
now$year + 1900               # see ?DateTimeClasses
months(now); weekdays(now)    # see ?months; using LC_TIME locale

## suppose we have a time in seconds since 1960-01-01 00:00:00 GMT
## (the origin used by SAS)
z &lt;- 1472562988
# ways to convert this
as.POSIXct(z, origin = "1960-01-01")                # local
as.POSIXct(z, origin = "1960-01-01", tz = "GMT")    # in UTC

## SPSS dates (R-help 2006-02-16)
z &lt;- c(10485849600, 10477641600, 10561104000, 10562745600)
as.Date(as.POSIXct(z, origin = "1582-10-14", tz = "GMT"))

## Stata date-times: milliseconds since 1960-01-01 00:00:00 GMT
## format %tc excludes leap-seconds, assumed here
## For format %tC including leap seconds, see foreign::read.dta()
z &lt;- 1579598122120
op &lt;- options(digits.secs = 3)
# avoid rounding down: milliseconds are not exactly representable
as.POSIXct((z+0.1)/1000, origin = "1960-01-01")
options(op)

## Matlab 'serial day number' (days and fractional days)
z &lt;- 7.343736909722223e5 # 2010-08-23 16:35:00
as.POSIXct((z - 719529)*86400, origin = "1970-01-01", tz = "UTC")

as.POSIXlt(Sys.time(), "GMT") # the current time in UTC

## These may not be correct names on your system
as.POSIXlt(Sys.time(), "America/New_York")  # in New York
as.POSIXlt(Sys.time(), "EST5EDT")           # alternative.
as.POSIXlt(Sys.time(), "EST" )   # somewhere in Eastern Canada
as.POSIXlt(Sys.time(), "HST")    # in Hawaii
as.POSIXlt(Sys.time(), "Australia/Darwin")


tab &lt;- file.path(R.home("share"), "zoneinfo", "zone1970.tab")
if(file.exists(tab)) { # typically on Windows; *not* on Linux
  cols &lt;- c("code", "coordinates", "TZ", "comments")
  tmp &lt;- read.delim(tab,
                    header = FALSE, comment.char = "#", col.names = cols)
  if(interactive()) View(tmp)
  head(tmp, 10)
}</code></pre>

<hr>
<h2 id='AsIs'>Inhibit Interpretation/Conversion of Objects</h2><span id='topic+I'></span><span id='topic+AsIs'></span><span id='topic+print.AsIs'></span><span id='topic++5B.AsIs'></span>

<h3>Description</h3>

<p>Change the class of an object to indicate that it should be treated
&lsquo;as is&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>I(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsIs_+3A_x">x</code></td>
<td>
<p>an object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>I</code> has two main uses.
</p>

<ul>
<li><p> In function <code><a href="#topic+data.frame">data.frame</a></code>.  Protecting an object by
enclosing it in <code>I()</code> in a call to <code>data.frame</code> inhibits the
conversion of character vectors to factors and the dropping of
names, and ensures that matrices are inserted as single columns.
<code>I</code> can also be used to protect objects which are to be
added to a data frame, or converted to a data frame <em>via</em>
<code><a href="#topic+as.data.frame">as.data.frame</a></code>.
</p>
<p>It achieves this by prepending the class <code>"AsIs"</code> to the object's
classes.  Class <code>"AsIs"</code> has a few of its own methods, including
for <code>[</code>, <code>as.data.frame</code>, <code>print</code> and <code>format</code>.
</p>
</li>
<li><p> In function <code><a href="stats.html#topic+formula">formula</a></code>.  There it is used to
inhibit the interpretation of  operators such as <code>"+"</code>,
<code>"-"</code>, <code>"*"</code> and <code>"^"</code> as formula operators, so they
are used as arithmetical operators.  This is interpreted as a symbol
by <code>terms.formula</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A copy of the object with class <code>"AsIs"</code> prepended to the class(es).
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Linear models</em>.
Chapter 4 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>, <code><a href="stats.html#topic+formula">formula</a></code>
</p>

<hr>
<h2 id='asplit'>Split Array/Matrix By Its Margins</h2><span id='topic+asplit'></span>

<h3>Description</h3>

<p>Split an array or matrix by its margins.</p>


<h3>Usage</h3>

<pre><code class='language-R'>asplit(x, MARGIN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asplit_+3A_x">x</code></td>
<td>
<p>an array, including a matrix.</p>
</td></tr>
<tr><td><code id="asplit_+3A_margin">MARGIN</code></td>
<td>
<p>a vector giving the margins to split by.
E.g., for a matrix <code>1</code> indicates rows, <code>2</code> indicates
columns, <code>c(1, 2)</code> indicates rows and columns.
Where <code>x</code> has named dimnames, it can be a character vector
selecting dimension names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since <span class="rlang"><b>R</b></span> 4.1.0, one can also obtain the splits (less efficiently)
using <code>apply(x, MARGIN, identity, simplify = FALSE)</code>.
The values of the splits can also be obtained (less efficiently) by
<code>split(x, slice.index(x, MARGIN))</code>.
</p>


<h3>Value</h3>

<p>A &ldquo;list array&rdquo; with dimension <code class="reqn">dv</code> and each element an
array of dimension <code class="reqn">de</code> and dimnames preserved as available, where
<code class="reqn">dv</code> and <code class="reqn">de</code> are, respectively, the dimensions of <code>x</code>
included and not included in <code>MARGIN</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A 3-dimensional array of dimension 2 x 3 x 4:
d &lt;- 2 : 4
x &lt;- array(seq_len(prod(d)), d)
x
## Splitting by margin 2 gives a 1-d list array of length 3
## consisting of 2 x 4 arrays:
asplit(x, 2)
## Splitting by margins 1 and 2 gives a 2 x 3 list array
## consisting of 1-d arrays of length 4:
asplit(x, c(1, 2))
## Compare to
split(x, slice.index(x, c(1, 2)))

## A 2 x 3 matrix:
(x &lt;- matrix(1 : 6, 2, 3))
## To split x by its rows, one can use
asplit(x, 1)
## or less efficiently
split(x, slice.index(x, 1))
split(x, row(x))
</code></pre>

<hr>
<h2 id='assign'>Assign a Value to a Name</h2><span id='topic+assign'></span>

<h3>Description</h3>

<p>Assign a value to a name in an environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign(x, value, pos = -1, envir = as.environment(pos),
       inherits = FALSE, immediate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assign_+3A_x">x</code></td>
<td>
<p>a variable name, given as a character string.  No coercion is
done, and the first element of a character vector of length greater
than one will be used, with a warning.</p>
</td></tr>
<tr><td><code id="assign_+3A_value">value</code></td>
<td>
<p>a value to be assigned to <code>x</code>.</p>
</td></tr>
<tr><td><code id="assign_+3A_pos">pos</code></td>
<td>
<p>where to do the assignment.  By default, assigns into the
current environment.  See &lsquo;Details&rsquo; for other possibilities.</p>
</td></tr>
<tr><td><code id="assign_+3A_envir">envir</code></td>
<td>
<p>the <code><a href="#topic+environment">environment</a></code> to use.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="assign_+3A_inherits">inherits</code></td>
<td>
<p>should the enclosing frames of the environment be
inspected?</p>
</td></tr>
<tr><td><code id="assign_+3A_immediate">immediate</code></td>
<td>
<p>an ignored compatibility feature.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are no restrictions on the name given as <code>x</code>: it can be a
non-syntactic name (see <code><a href="#topic+make.names">make.names</a></code>).
</p>
<p>The <code>pos</code> argument can specify the  environment in which to assign
the object in any of several ways: as <code>-1</code> (the default),
as a positive integer (the position in the <code><a href="#topic+search">search</a></code> list); as
the character string name of an element in the search list; or as an
<code><a href="#topic+environment">environment</a></code> (including using <code><a href="#topic+sys.frame">sys.frame</a></code> to
access the currently active function calls).
The <code>envir</code> argument is an alternative way to specify an
environment, but is primarily for back compatibility.
</p>
<p><code>assign</code> does not dispatch assignment methods, so it cannot be
used to set elements of vectors, names, attributes, etc.
</p>
<p>Note that assignment to an attached list or data frame changes the
attached copy and not the original object: see <code><a href="#topic+attach">attach</a></code>
and <code><a href="#topic+with">with</a></code>.
</p>


<h3>Value</h3>

<p>This function is invoked for its side effect, which is assigning
<code>value</code> to the variable <code>x</code>.  If no <code>envir</code> is
specified, then the assignment takes place in the currently active
environment.
</p>
<p>If <code>inherits</code> is <code>TRUE</code>, enclosing environments of the supplied
environment are searched until the variable <code>x</code> is encountered.
The value is then assigned in the environment in which the variable is
encountered (provided that the binding is not locked: see
<code><a href="#topic+lockBinding">lockBinding</a></code>: if it is, an error is signaled).  If the
symbol is not encountered then assignment takes place in the user's
workspace (the global environment).
</p>
<p>If <code>inherits</code> is <code>FALSE</code>, assignment takes place in the
initial frame of <code>envir</code>, unless an existing binding is locked or
there is no existing binding and the environment is locked (when an
error is signaled).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++3C-">&lt;-</a></code>,
<code><a href="#topic+get">get</a></code>, the inverse of <code>assign()</code>,
<code><a href="#topic+exists">exists</a></code>,
<code><a href="#topic+environment">environment</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for(i in 1:6) { #-- Create objects  'r.1', 'r.2', ... 'r.6' --
    nam &lt;- paste("r", i, sep = ".")
    assign(nam, 1:i)
}
ls(pattern = "^r..$")

##-- Global assignment within a function:
myf &lt;- function(x) {
    innerf &lt;- function(x) assign("Global.res", x^2, envir = .GlobalEnv)
    innerf(x+1)
}
myf(3)
Global.res # 16

a &lt;- 1:4
assign("a[1]", 2)
a[1] == 2          # FALSE
get("a[1]") == 2   # TRUE

</code></pre>

<hr>
<h2 id='assignOps'>Assignment Operators</h2><span id='topic++3C-'></span><span id='topic++3D'></span><span id='topic++3C+3C-'></span><span id='topic+-+3E'></span><span id='topic+-+3E+3E'></span><span id='topic+assignOps'></span>

<h3>Description</h3>

<p>Assign a value to a name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x &lt;- value
x &lt;&lt;- value
value -&gt; x
value -&gt;&gt; x

x = value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assignOps_+3A_x">x</code></td>
<td>
<p>a variable name (possibly quoted).</p>
</td></tr>
<tr><td><code id="assignOps_+3A_value">value</code></td>
<td>
<p>a value to be assigned to <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three different assignment operators: two of them
have leftwards and rightwards forms.
</p>
<p>The operators <code>&lt;-</code> and <code>=</code> assign into the environment in
which they are evaluated.  The  operator <code>&lt;-</code> can be used
anywhere, whereas the operator <code>=</code> is only allowed at the top
level (e.g., in the complete expression typed at the command prompt)
or as one of the subexpressions in a braced list of expressions.
</p>
<p>The operators <code>&lt;&lt;-</code> and <code>-&gt;&gt;</code> are normally only used in
functions, and cause a search to be made through parent environments
for an existing definition of the variable being assigned.  If such
a variable is found (and its binding is not locked) then its value
is redefined, otherwise assignment takes place in the global
environment.  Note that their semantics differ from that in the S
language, but are useful in conjunction with the scoping rules of
<span class="rlang"><b>R</b></span>.  See &lsquo;The R Language Definition&rsquo; manual for further
details and examples.
</p>
<p>In all the assignment operator expressions, <code>x</code> can be a name
or an expression defining a part of an object to be replaced (e.g.,
<code>z[[1]]</code>).  A syntactic name does not need to be quoted,
though it can be (preferably by <a href="#topic+backtick">backtick</a>s).
</p>
<p>The leftwards forms of assignment <code>&lt;- = &lt;&lt;-</code> group right to left,
the other from left to right.
</p>


<h3>Value</h3>

<p><code>value</code>.  Thus one can use <code>a &lt;- b &lt;- c &lt;- 6</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer (for <code>=</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+assign">assign</a></code> (and its inverse <code><a href="#topic+get">get</a></code>),
for &ldquo;subassignment&rdquo; such as <code>x[i] &lt;- v</code>,
see <code><a href="#topic++5B+3C-">[&lt;-</a></code>; 
further, <code><a href="#topic+environment">environment</a></code>.
</p>

<hr>
<h2 id='attach'>Attach Set of R Objects to Search Path</h2><span id='topic+attach'></span><span id='topic+.conflicts.OK'></span>

<h3>Description</h3>

<p>The database is attached to the <span class="rlang"><b>R</b></span> search path.  This means that the
database is searched by <span class="rlang"><b>R</b></span> when evaluating a variable, so objects in
the database can be accessed by simply giving their names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attach(what, pos = 2L, name = deparse1(substitute(what), backtick=FALSE),
       warn.conflicts = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attach_+3A_what">what</code></td>
<td>
<p>&lsquo;database&rsquo;.  This can be a
<code>data.frame</code> or a <code>list</code> or a <span class="rlang"><b>R</b></span> data file created with
<code><a href="#topic+save">save</a></code> or <code>NULL</code> or an environment.  See also
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="attach_+3A_pos">pos</code></td>
<td>
<p>integer specifying position in <code><a href="#topic+search">search</a>()</code> where
to attach.</p>
</td></tr>
<tr><td><code id="attach_+3A_name">name</code></td>
<td>
<p>name to use for the attached database. Names starting with
<code>package:</code> are reserved for <code><a href="#topic+library">library</a></code>.</p>
</td></tr>
<tr><td><code id="attach_+3A_warn.conflicts">warn.conflicts</code></td>
<td>
<p>logical.  If <code>TRUE</code>, <code><a href="#topic+message">message</a>()</code>s are
printed about <code><a href="#topic+conflicts">conflicts</a></code> from attaching the database,
unless that database contains an object <code>.conflicts.OK</code>.  A
conflict is a function masking a function, or a non-function masking
a non-function.
</p>
<p>NB: Even though the name is <code>warn.conflicts</code> for historical
reasons, the messages about conflicts are <em>not</em>
<code><a href="#topic+warning">warning</a>()</code>s but <code><a href="#topic+message">message</a>()</code>s.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When evaluating a variable or function name <span class="rlang"><b>R</b></span> searches for
that name in the databases listed by <code><a href="#topic+search">search</a></code>.  The first
name of the appropriate type is used.
</p>
<p>By attaching a data frame (or list) to the search path it is possible
to refer to the variables in the data frame by their names alone,
rather than as components of the data frame (e.g., in the example below,
<code>height</code> rather than <code>women$height</code>).
</p>
<p>By default the database is attached in position 2 in the search path,
immediately after the user's workspace and before all previously
attached packages and previously attached databases.  This can be
altered to attach later in the search path with the <code>pos</code> option,
but you cannot attach at <code>pos = 1</code>.
</p>
<p>The database is not actually attached.  Rather, a new environment is
created on the search path and the elements of a list (including
columns of a data frame) or objects in a save file or an environment
are <em>copied</em> into the new environment.  If you use
<code><a href="#topic++3C+3C-">&lt;&lt;-</a></code> or <code><a href="#topic+assign">assign</a></code> to assign to an attached
database, you only alter the attached copy, not the original object.
(Normal assignment will place a modified version in the user's
workspace: see the examples.)  For this reason <code>attach</code> can lead
to confusion.
</p>
<p>One useful &lsquo;trick&rsquo; is to use <code>what = NULL</code> (or equivalently a
length-zero list) to create a new environment on the search path into
which objects can be assigned by <code><a href="#topic+assign">assign</a></code> or
<code><a href="#topic+load">load</a></code> or <code><a href="#topic+sys.source">sys.source</a></code>.
</p>
<p>Names starting <code>"package:"</code> are reserved for
<code><a href="#topic+library">library</a></code> and should not be used by end users.  Attached
files are by default given the name <code>file:<var>what</var></code>.  The
<code>name</code> argument given for the attached environment will be used
by <code><a href="#topic+search">search</a></code> and can be used as the argument to
<code><a href="#topic+as.environment">as.environment</a></code>.
</p>





<h3>Value</h3>

<p>The <code><a href="#topic+environment">environment</a></code> is returned invisibly with a
<code>"name"</code> attribute.
</p>


<h3>Good practice</h3>

<p><code>attach</code> has the side effect of altering the search path and this
can easily lead to the wrong object of a particular name being found.
People do often forget to <code><a href="#topic+detach">detach</a></code> databases.
</p>
<p>In interactive use, <code><a href="#topic+with">with</a></code> is usually preferable to the
use of <code>attach</code>/<code>detach</code>, unless <code>what</code> is a
<code><a href="#topic+save">save</a>()</code>-produced file in which case
<code>attach()</code> is a (safety) wrapper for <code><a href="#topic+load">load</a>()</code>.
</p>
<p>In programming, functions should not change the search path unless
that is their purpose.  Often <code><a href="#topic+with">with</a></code> can be used within a
function. If not, good practice is to
</p>

<ul>
<li><p> Always use a distinctive <code>name</code> argument, and
</p>
</li>
<li><p> To immediately follow the <code>attach</code> call by an
<code><a href="#topic+on.exit">on.exit</a></code> call to <code>detach</code> using the distinctive name.
</p>
</li></ul>

<p>This ensures that the search path is left unchanged even if the
function is interrupted or if code after the <code>attach</code> call
changes the search path.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+library">library</a></code>, <code><a href="#topic+detach">detach</a></code>, <code><a href="#topic+search">search</a></code>,
<code><a href="#topic+objects">objects</a></code>, <code><a href="#topic+environment">environment</a></code>, <code><a href="#topic+with">with</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(utils)

summary(women$height)   # refers to variable 'height' in the data frame
attach(women)
summary(height)         # The same variable now available by name
height &lt;- height*2.54   # Don't do this. It creates a new variable
                        # in the user's workspace
find("height")
summary(height)         # The new variable in the workspace
rm(height)
summary(height)         # The original variable.
height &lt;&lt;- height*25.4  # Change the copy in the attached environment
find("height")
summary(height)         # The changed copy
detach("women")
summary(women$height)   # unchanged

## Not run: ## create an environment on the search path and populate it
sys.source("myfuns.R", envir = attach(NULL, name = "myfuns"))

## End(Not run)</code></pre>

<hr>
<h2 id='attr'>Object Attributes</h2><span id='topic+attr'></span><span id='topic+attr+3C-'></span>

<h3>Description</h3>

<p>Get or set specific attributes of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attr(x, which, exact = FALSE)
attr(x, which) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attr_+3A_x">x</code></td>
<td>
<p>an object whose attributes are to be accessed.</p>
</td></tr>
<tr><td><code id="attr_+3A_which">which</code></td>
<td>
<p>a non-empty character string specifying which attribute
is to be accessed.</p>
</td></tr>
<tr><td><code id="attr_+3A_exact">exact</code></td>
<td>
<p>logical: should <code>which</code> be matched exactly?</p>
</td></tr>
<tr><td><code id="attr_+3A_value">value</code></td>
<td>
<p>an object, the new value of the attribute, or <code>NULL</code>
to remove the attribute.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions provide access to a single attribute of an object.
The replacement form causes the named attribute to take the value
specified (or create a new attribute with the value given).
</p>
<p>The extraction function first looks for an exact match to <code>which</code>
amongst the attributes of <code>x</code>, then (unless <code>exact = TRUE</code>)
a unique partial match.
(Setting <code><a href="#topic+options">options</a>(warnPartialMatchAttr = TRUE)</code> causes
partial matches to give warnings.)
</p>
<p>The replacement function only uses exact matches.
</p>
<p>Note that some attributes (namely <code><a href="#topic+class">class</a></code>,
<code><a href="#topic+comment">comment</a></code>, <code><a href="#topic+dim">dim</a></code>, <code><a href="#topic+dimnames">dimnames</a></code>,
<code><a href="#topic+names">names</a></code>, <code><a href="#topic+row.names">row.names</a></code> and
<code><a href="stats.html#topic+tsp">tsp</a></code>) are treated specially and have restrictions on
the values which can be set.  (Note that this is not true of
<code><a href="#topic+levels">levels</a></code> which should be set for factors via the
<code>levels</code> replacement function.)
</p>
<p>The extractor function allows (and does not match) empty and missing
values of <code>which</code>: the replacement function does not.
</p>
<p><code><a href="#topic+NULL">NULL</a></code> objects cannot have attributes and attempting to
assign one by <code>attr</code> gives an error.
</p>
<p>Both are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p>For the extractor, the value of the attribute matched, or <code>NULL</code>
if no exact match is found and no or more than one partial match is found.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+attributes">attributes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a 2 by 5 matrix
x &lt;- 1:10
attr(x,"dim") &lt;- c(2, 5)
</code></pre>

<hr>
<h2 id='attributes'>Object Attribute Lists</h2><span id='topic+attributes'></span><span id='topic+attributes+3C-'></span><span id='topic+mostattributes+3C-'></span>

<h3>Description</h3>

<p>These functions access an object's attributes.
The first form below returns the object's attribute list.
The replacement forms uses the list on the right-hand
side of the assignment as the object's attributes (if appropriate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attributes(x)
attributes(x) &lt;- value
mostattributes(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attributes_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="attributes_+3A_value">value</code></td>
<td>
<p>an appropriate named <code><a href="#topic+list">list</a></code> of attributes, or
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike <code><a href="#topic+attr">attr</a></code> it is not an error to set attributes on a
<code>NULL</code> object: it will first be coerced to an empty list.
</p>
<p>Note that some attributes (namely <code><a href="#topic+class">class</a></code>,
<code><a href="#topic+comment">comment</a></code>, <code><a href="#topic+dim">dim</a></code>, <code><a href="#topic+dimnames">dimnames</a></code>,
<code><a href="#topic+names">names</a></code>, <code><a href="#topic+row.names">row.names</a></code> and
<code><a href="stats.html#topic+tsp">tsp</a></code>) are treated specially and have restrictions on
the values which can be set.  (Note that this is not true of
<code><a href="#topic+levels">levels</a></code> which should be set for factors via the
<code>levels</code> replacement function.)
</p>
<p>Attributes are not stored internally as a list and should be thought
of as a set and not a vector, i.e, the <em>order</em> of the elements of
<code>attributes()</code> does not matter.  This is also reflected by
<code><a href="#topic+identical">identical</a>()</code>'s behaviour with the default argument
<code>attrib.as.set = TRUE</code>.  Attributes must have unique names (and
<code>NA</code> is taken as <code>"NA"</code>, not a missing value).
</p>
<p>Assigning attributes first removes all attributes, then sets any
<code>dim</code> attribute and then the remaining attributes in the order
given: this ensures that setting a <code>dim</code> attribute always precedes
the <code>dimnames</code> attribute.
</p>
<p>The <code>mostattributes</code> assignment takes special care for the
<code><a href="#topic+dim">dim</a></code>, <code><a href="#topic+names">names</a></code> and <code><a href="#topic+dimnames">dimnames</a></code>
attributes, and assigns them only when known to be valid whereas an
<code>attributes</code> assignment would give an error if any are not.  It
is principally intended for arrays, and should be used with care on
classed objects.  For example, it does not check that
<code><a href="#topic+row.names">row.names</a></code> are assigned correctly for data frames.
</p>
<p>The names of a pairlist are not stored as attributes, but are reported
as if they were (and can be set by the replacement form of
<code>attributes</code>).
</p>
<p><code><a href="#topic+NULL">NULL</a></code> objects cannot have attributes and attempts to
assign them will promote the object to an empty list.
</p>
<p>Both assignment and replacement forms of <code>attributes</code> are
<a href="#topic+primitive">primitive</a> functions.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+attr">attr</a></code>,  <code><a href="#topic+structure">structure</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(a = 1:3, pi = pi) # simple matrix with dimnames
attributes(x)

## strip an object's attributes:
attributes(x) &lt;- NULL
x # now just a vector of length 6

mostattributes(x) &lt;- list(mycomment = "really special", dim = 3:2,
   dimnames = list(LETTERS[1:3], letters[1:5]), names = paste(1:6))
x # dim(), but not {dim}names
</code></pre>

<hr>
<h2 id='autoload'>On-demand Loading of Packages</h2><span id='topic+autoload'></span><span id='topic+autoloader'></span><span id='topic+.AutoloadEnv'></span><span id='topic+.Autoloaded'></span><span id='topic+Autoloads'></span>

<h3>Description</h3>

<p><code>autoload</code> creates a promise-to-evaluate <code>autoloader</code> and
stores it with name <code>name</code> in <code>.AutoloadEnv</code> environment.
When <span class="rlang"><b>R</b></span> attempts to evaluate <code>name</code>, <code>autoloader</code> is run,
the package is loaded and <code>name</code> is re-evaluated in the new
package's environment.  The result is that <span class="rlang"><b>R</b></span> behaves as if
<code>package</code> was loaded but it does not occupy memory.
</p>
<p><code>.Autoloaded</code> contains the names of the packages for
which autoloading has been promised.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoload(name, package, reset = FALSE, ...)
autoloader(name, package, ...)

.AutoloadEnv
.Autoloaded
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoload_+3A_name">name</code></td>
<td>
<p>string giving the name of an object.</p>
</td></tr>
<tr><td><code id="autoload_+3A_package">package</code></td>
<td>
<p>string giving the name of a package containing the object.</p>
</td></tr>
<tr><td><code id="autoload_+3A_reset">reset</code></td>
<td>
<p>logical: for internal use by <code>autoloader</code>.</p>
</td></tr>
<tr><td><code id="autoload_+3A_...">...</code></td>
<td>
<p>other arguments to <code><a href="#topic+library">library</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is invoked for its side-effect.  It has no return value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+delayedAssign">delayedAssign</a></code>, <code><a href="#topic+library">library</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
autoload("interpSpline", "splines")
search()
ls("Autoloads")
.Autoloaded

x &lt;- sort(stats::rnorm(12))
y &lt;- x^2
is &lt;- interpSpline(x, y)
search() ## now has splines
detach("package:splines")
search()
is2 &lt;- interpSpline(x, y+x)
search() ## and again
detach("package:splines")
</code></pre>

<hr>
<h2 id='backsolve'>Solve an Upper or Lower Triangular System</h2><span id='topic+backsolve'></span><span id='topic+forwardsolve'></span>

<h3>Description</h3>

<p>Solves a triangular system of linear equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   backsolve(r, x, k = ncol(r), upper.tri = TRUE,
             transpose = FALSE)
forwardsolve(l, x, k = ncol(l), upper.tri = FALSE,
             transpose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backsolve_+3A_r">r</code>, <code id="backsolve_+3A_l">l</code></td>
<td>
<p>an upper (or lower) triangular matrix giving the
coefficients for the system to be solved.  Values below (above)
the diagonal are ignored.</p>
</td></tr>
<tr><td><code id="backsolve_+3A_x">x</code></td>
<td>
<p>a matrix whose columns give the right-hand sides for
the equations.</p>
</td></tr>
<tr><td><code id="backsolve_+3A_k">k</code></td>
<td>
<p>the number of columns of <code>r</code> and rows of <code>x</code> to use.</p>
</td></tr>
<tr><td><code id="backsolve_+3A_upper.tri">upper.tri</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), the <em>upper</em>
<em>tri</em>angular part of <code>r</code> is used.  Otherwise, the lower one.</p>
</td></tr>
<tr><td><code id="backsolve_+3A_transpose">transpose</code></td>
<td>
<p>logical; if <code>TRUE</code>, solve <code class="reqn">r' * y = x</code> for
<code class="reqn">y</code>, i.e., <code>t(r) %*% y == x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Solves a system of linear equations where the coefficient matrix is
upper (or &lsquo;right&rsquo;, &lsquo;R&rsquo;) or lower (&lsquo;left&rsquo;,
&lsquo;L&rsquo;) triangular.
</p>
<p><code>x &lt;- backsolve   (R, b)</code> solves <code class="reqn">R x = b</code>, and<br />
<code>x &lt;- forwardsolve(L, b)</code> solves <code class="reqn">L x = b</code>, respectively.
</p>
<p>The <code>r</code>/<code>l</code> must have at least <code>k</code> rows and columns,
and <code>x</code> must have at least <code>k</code> rows.
</p>
<p>This is a wrapper for the level-3 BLAS routine <code>dtrsm</code>.
</p>


<h3>Value</h3>

<p>The solution of the triangular system.  The result will be a vector if
<code>x</code> is a vector and a matrix if <code>x</code> is a matrix.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Dongarra, J. J., Bunch, J. R.,  Moler, C. B. and  Stewart, G. W. (1978)
<em>LINPACK Users Guide</em>.  Philadelphia: SIAM Publications.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chol">chol</a></code>,
<code><a href="#topic+qr">qr</a></code>,
<code><a href="#topic+solve">solve</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## upper triangular matrix 'r':
r &lt;- rbind(c(1,2,3),
           c(0,1,1),
           c(0,0,2))
( y &lt;- backsolve(r, x &lt;- c(8,4,2)) ) # -1 3 1
r %*% y # == x = (8,4,2)
backsolve(r, x, transpose = TRUE) # 8 -12 -5
</code></pre>

<hr>
<h2 id='balancePOSIXlt'>Balancing &ldquo;Ragged&rdquo; and Out-of-range POSIXlt Date-Times</h2><span id='topic+balancePOSIXlt'></span><span id='topic+unCfillPOSIXlt'></span>

<h3>Description</h3>

<p>Utilities to &lsquo;balance&rsquo; objects of class <code>"POSIXlt"</code>.
</p>
<p><code>unCfillPOSIXlt(x)</code> is a fast <a href="#topic+primitive">primitive</a> version of
<code>balancePOSIXlt(x, fill.only=TRUE, classed=FALSE)</code> or equivalently,
<code>unclass(balancePOSIXlt(x, fill.only=TRUE))</code> from where it is named.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>balancePOSIXlt(x, fill.only = FALSE, classed = TRUE)
unCfillPOSIXlt(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="balancePOSIXlt_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object inheriting from <code>"POSIXlt"</code>, see
<code><a href="#topic+POSIXlt">POSIXlt</a></code>.</p>
</td></tr>
<tr><td><code id="balancePOSIXlt_+3A_fill.only">fill.only</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> specifying if
<code>balancePOSIXlt(x, ..)</code>  should only &ldquo;fill up&rdquo; by
recycling, but not re-check validity nor recompute, e.g.,
<code>x$wday</code> and <code>x$yday</code>.</p>
</td></tr>
<tr><td><code id="balancePOSIXlt_+3A_classed">classed</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> specifying if the result should be
classed, true by default.  Using <code>balancePOSIXlt(x, classed = FALSE)</code>
is equivalent to but faster than <code>unclass(balancePOSIXlt(x))</code>.</p>
</td></tr>
</table>


<h3>&ldquo;Ragged&rdquo; and Out-of-range <em>vs</em> &ldquo;Balanced&rdquo; POSIXlt</h3>

<p>Note that <code>"POSIXlt"</code> objects <code>x</code> may have their (9 to 11)
list components of different <code><a href="#topic+length">length</a></code>s, by simply
recycling them to full length.  Prior to <span class="rlang"><b>R</b></span> 4.3.0, this has worked in
printing, formatting, and conversion to <code>"POSIXct"</code>, but often
not for <code>length()</code>, conversion to <code>"Date"</code> or indexing,
i.e., subsetting, <code><a href="#topic++5B">[</a></code>, or subassigning, <code><a href="#topic++5B+3C-">[&lt;-</a></code>.
</p>
<p>Relatedly, components <code>sec</code>, <code>min</code>, <code>hour</code>, <code>mday</code>
and <code>mon</code> could have been out of their designated range (say, 0&ndash;23
for hours) and still work correctly, e.g. in conversions and printing.
This is supported as well, since <span class="rlang"><b>R</b></span> 4.3.0, at least when the values are
not extreme. 
</p>
<p>Function <code>balancePOSIXlt(x)</code> will now return a version of the
<code>"POSIXlt"</code> object <code>x</code> which by default is balanced in both ways:
All the internal list components are of full length, and their values are
inside their ranges as specified in <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code>'s
&lsquo;Details on POSIXlt&rsquo;.
Setting <code>fill.only = TRUE</code> will only recycle the list components
to full length, but not check them at all.  This is particularly faster
when all components of <code>x</code> are already of full length.
</p>
<p>Experimentally, <code>balancePOSIXlt()</code> and other functions returning
<code>POSIXlt</code> objects now set a <code><a href="#topic+logical">logical</a></code> attribute
<code>"balanced"</code> with <code>NA</code> meaning &ldquo;filled-in&rdquo;, i.e.,
not &ldquo;ragged&rdquo; and <code>TRUE</code> means (fully) balanced.
</p>


<h3>See Also</h3>

<p>For more details about many aspects of valid <code>POSIXlt</code> objects, notably
their internal list components, see &lsquo;<a href="#topic+DateTimeClasses">DateTimeClasses</a>&rsquo;, e.g.,
<code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code>, notably the section &lsquo;Details on POSIXlt&rsquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## FIXME: this should also work for regular (non-UTC) time zones.
TZ &lt;-"UTC"
# Could be
# d1 &lt;- as.POSIXlt("2000-01-02 3:45", tz = TZ)
# on systems (almost all) which have tm_zone.
oldTZ &lt;- Sys.getenv('TZ', unset = "unset")
Sys.setenv(TZ = "UTC")
d1 &lt;- as.POSIXlt("2000-01-02 3:45")
d1$min &lt;- d1$min + (0:16)*20L
(f1 &lt;- format(d1))
str(unclass(d1))      # only $min is of length &gt; 1
df &lt;- balancePOSIXlt(d1, fill.only = TRUE) # a "POSIXlt" object
str(unclass(df))      # all of length 17; 'min' unchanged
db &lt;- balancePOSIXlt(d1, classed = FALSE)  # a list
stopifnot(identical(
    unCfillPOSIXlt(d1),
    balancePOSIXlt(d1, fill.only = TRUE, classed = FALSE)))
str(db) # of length 17 *and* in range

if(oldTZ == "unset") Sys.unsetenv('TZ') else Sys.setenv(TZ = oldTZ)
</code></pre>

<hr>
<h2 id='base-defunct'>Defunct Functions in Package <span class="pkg">base</span></h2><span id='topic+base-defunct'></span><span id='topic+Version'></span><span id='topic+provide'></span><span id='topic+.Provided'></span><span id='topic+category'></span><span id='topic+print.anova.glm'></span><span id='topic+print.anova.lm'></span><span id='topic+print.tabular'></span><span id='topic+print.plot'></span><span id='topic+save.plot'></span><span id='topic+system.test'></span><span id='topic+getenv'></span><span id='topic+read.table.url'></span><span id='topic+scan.url'></span><span id='topic+source.url'></span><span id='topic+httpclient'></span><span id='topic+parse.dcf'></span><span id='topic+.Alias'></span><span id='topic+print.ordered'></span><span id='topic+.Dyn.libs'></span><span id='topic+.lib.loc'></span><span id='topic+machine'></span><span id='topic+Platform'></span><span id='topic+Machine'></span><span id='topic+restart'></span><span id='topic+printNoClass'></span><span id='topic+codes'></span><span id='topic+codes.factor'></span><span id='topic+codes.ordered'></span><span id='topic+codes+3C-'></span><span id='topic+print.atomic'></span><span id='topic+La.eigen'></span><span id='topic+tetragamma'></span><span id='topic+pentagamma'></span><span id='topic+package.description'></span><span id='topic+loadURL'></span><span id='topic+delay'></span><span id='topic+write.table0'></span><span id='topic+format.char'></span><span id='topic+La.chol'></span><span id='topic+La.chol2inv'></span><span id='topic+symbol.C'></span><span id='topic+symbol.For'></span><span id='topic+unix'></span><span id='topic+gammaCody'></span><span id='topic+manglePackageName'></span><span id='topic+.Import'></span><span id='topic+.ImportFrom'></span><span id='topic+.Export'></span><span id='topic+.First.lib'></span><span id='topic+mem.limits'></span><span id='topic+.readRDS'></span><span id='topic+.saveRDS'></span><span id='topic+Sys.putenv'></span><span id='topic+real'></span><span id='topic+as.real'></span><span id='topic+is.real'></span><span id='topic+.find.package'></span><span id='topic+.path.package'></span><span id='topic+unix.time'></span><span id='topic+default.stringsAsFactors'></span><span id='topic+.__H__.cbind'></span><span id='topic+.__H__.rbind'></span><span id='topic+is.R'></span>

<h3>Description</h3>

<p>The functions or variables listed here are no longer part of <span class="rlang"><b>R</b></span> as
they are no longer needed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'># Defunct in 1.x
Version()
provide(package)
.Provided
category(...)
print.anova.glm(.)
print.anova.lm(.)
print.tabular(.)
print.plot(.)
save.plot(.)
system.test(.)
getenv(...)
read.table.url(url, method, ...)
scan.url(url, file = tempfile(), method, ...)
source.url(url, file = tempfile(), method, ...)
httpclient(url, port = 80, error.is.fatal = TRUE,
           check.MIME.type = TRUE, file = tempfile(),
           drop.ctrl.z = TRUE)
parse.dcf(text = NULL, file = "", fields = NULL,
          versionfix = FALSE)
.Alias(expr)
print.ordered(.)
.Dyn.libs
.lib.loc
machine()
Machine()
Platform()
restart()
printNoClass(x, digits = NULL, quote = TRUE, na.print = NULL,
             print.gap = NULL, right = FALSE, ...)
codes(x, ...)
codes(x, ...) &lt;- value

# Defunct in 2.0.0
La.eigen(x, symmetric, only.values = FALSE,
         method = c("dsyevr", "dsyev"))
tetragamma(x)
pentagamma(x)
package.description(pkg, lib.loc = NULL, fields = NULL)

# Defunct in 2.2.0
loadURL(url, envir = parent.frame(), quiet = TRUE, ...)
delay(x, env = .GlobalEnv)

# Defunct in 2.3.0
format.char(x, width = NULL, flag = "-")

# Defunct in 2.4.0
La.chol(x)
La.chol2inv(x, size = ncol(x))

# Defunct in 2.4.0
symbol.C(name)
symbol.For(name)

# Defunct in 2.5.0
unix(call, intern = FALSE)

# Defunct in 2.8.0
gammaCody(x)

# Defunct in 2.9.0
manglePackageName(pkgName, pkgVersion)

# Defunct in 2.13.0
.Import(...)
.ImportFrom(name, ...)
.Export(...)

# Defunct in 2.14.0
.First.lib(lib, pkg)

# Defunct in 2.15.0, removed for 4.0.0
mem.limits(nsize = NA, vsize = NA)
.saveRDS(...)
.readRDS(...)
Sys.putenv(...) # (removed much earlier)

# Defunct in 3.0.0
real(length = 0)
as.real(x, ...)
is.real(x)

# Defunct in 3.1.0, removed for 4.1.0
.find.package(...)
.path.package(...)

# Defunct in 4.2.0
unix.time(...)  ### -- use  system.time(...)  instead

# Defunct in 4.3.0
default.stringsAsFactors() # use stringsAsFactors = FALSE instead.

# Defunct in 4.5.0
is.R()
</code></pre>


<h3>Details</h3>

<p>Some of these have stubs which report that they are defunct, but most
have been removed completely (apart from being documented here).
</p>
<p><code>category</code> has been an old-S function before there were factors;
should be replaced by <code><a href="#topic+factor">factor</a></code> throughout!
</p>
<p>The new function <code>dev.print()</code> should now be used for saving
plots to a file or printing them.
</p>
<p><code>provide</code> and its object <code>.Provided</code> have been removed.
Their intended purpose was to allow one package to subsume another,
but this was never used.
</p>
<p><code>getenv</code> has been replaced by <code><a href="#topic+Sys.getenv">Sys.getenv</a></code>.
</p>
<p><code>*.url</code> are replaced by calling <code>read.table</code>, <code>scan</code> or
<code>source</code> on a <code><a href="#topic+url">url</a></code> connection.
</p>
<p><code>httpclient</code> was used by the deprecated <code>"socket"</code> method
of <code><a href="utils.html#topic+download.file">download.file</a></code>.
</p>
<p><code>parse.dcf</code> has been replaced by <code>read.dcf</code>, which is much
faster, but has a slightly different interface.
</p>
<p><code>.Alias</code> provided an unreliable way to create duplicate
references to the same object.  There is no direct replacement.  Where
multiple references to a single object are required for semantic
reasons consider using environments or external pointers.  There are
some notes on <a href="https://developer.r-project.org">https://developer.r-project.org</a>.
</p>
<p><code>.Dyn.libs</code> and <code>.lib.loc</code> were internal variables used for
storing and manipulating the information about packages with DLLs, and
the known <span class="rlang"><b>R</b></span> library trees.  These are now dynamic variables which one
can get or set using <code><a href="#topic+.dynLibs">.dynLibs</a></code> and
<code><a href="#topic+.libPaths">.libPaths</a></code>, respectively.
</p>
<p><code>Machine()</code> and <code>Platform()</code> were functions returning the
variables <code><a href="#topic+.Machine">.Machine</a></code> and <code><a href="#topic+.Platform">.Platform</a></code>
respectively.
</p>
<p><code>restart()</code> should be replaced by <code>try()</code>, in preparation
for an exception-based implementation.  If you use <code>restart()</code> in
a way that cannot be replaced with <code>try()</code> then ask for help
on <code>r-devel</code>.
</p>
<p><code>printNoClass</code> was in package <span class="pkg">methods</span> and called directly the
internal function <code>print.default</code>.
</p>
<p><code>codes</code> was almost always used inappropriately.  To get the
internal coding of a factor, use <code>unclass</code>, <code>as.vector</code> or
<code>as.integer</code>.  For <em>ordered</em> factors, <code>codes</code> was
equivalent to these, but for <em>unordered</em> factors it assumed an
alphabetical ordering of the levels in the locale in use.
</p>
<p><code>La.eigen</code> has become the default for <code><a href="#topic+eigen">eigen</a></code>.
</p>
<p><code>tetragamma</code> and <code>pentagamma</code> have been replaced by
<code><a href="#topic+psigamma">psigamma</a></code>.
</p>
<p><code>package.description</code> has been replaced by
<code><a href="utils.html#topic+packageDescription">packageDescription</a></code> in package <span class="pkg">utils</span>.
</p>
<p><code>loadURL</code> has been superseded by <code><a href="#topic+load">load</a>(url())</code>.
</p>
<p><code>delay</code> has been replaced by <code><a href="#topic+delayedAssign">delayedAssign</a></code>.
Unevaluated promises should never be visible.
</p>
<p><code>write.table0</code> was an <span class="rlang"><b>R</b></span>-level version of <code>write.table</code>
provided for temporary back-compatibility.
</p>
<p><code>format.char</code> was an auxiliary function for <code><a href="#topic+formatC">formatC</a></code>
whose functionality (and more) is provided by <code><a href="#topic+format.default">format.default</a></code>.
</p>
<p><code>La.chol</code> and <code>La.chol2inv</code> became the default methods for
<code><a href="#topic+chol">chol</a></code> and <code><a href="#topic+chol2inv">chol2inv</a></code>.
</p>
<p>Functions <code>symbol.C</code> and <code>symbol.For</code> were provided for
historical compatibility with S.  <code>symbol.C</code> just returns its
argument unchanged, whereas <code>symbol.For</code> will map to lower case
and append an underscore on those platforms (almost all) which do so
for Fortran symbols.  These are no longer of any use in <span class="rlang"><b>R</b></span>.
</p>
<p><code>unix</code> was a <em>deprecated</em> (since the 1990s) alternative to
<code><a href="#topic+system">system</a></code>, available for backwards compatibility with S.
</p>
<p><code>gammaCody</code> was the <code class="reqn">(\Gamma)</code> function from the Specfun
package used at C level in the Bessel code. The <span class="rlang"><b>R</b></span>-level interface was
here for experimental purposes.
</p>
<p><code>manglePackageName</code> was part of the defunct support for versioned
installs.
</p>
<p><code>.Import</code>, <code>.ImportFrom</code>, and <code>.Export</code> were part of an
experimental alternative way to specify namespaces.
</p>
<p><code>.First.lib</code> was the load/attach hook for packages without
namespaces: use <code><a href="#topic+.onLoad">.onLoad</a></code> or <code><a href="#topic+.onAttach">.onAttach</a></code> instead.
</p>
<p><code>mem.limits</code> reported on the old-style limits on the number of
cons cells and size of the vector heap.  These are no longer limited
except by overall memory limits.
</p>
<p><code>.readRDS</code> and <code>.saveRDS</code>, were internal-only versions (and
the only versions available prior to <span class="rlang"><b>R</b></span> 2.13.0) of
<code><a href="#topic+readRDS">readRDS</a></code> and <code><a href="#topic+saveRDS">saveRDS</a></code>.
</p>
<p><code>Sys.putenv</code> was a synonym for <code><a href="#topic+Sys.setenv">Sys.setenv</a></code>,
deprecated since <span class="rlang"><b>R</b></span> 2.5.0.
</p>
<p><code>real</code>, <code>as.real</code> and <code>is.real</code> were long-deprecated
synonyms for the <code>double</code> versions.
</p>
<p><code>.find.package</code> and <code>.path.package</code> were internal-only
versions prior to <span class="rlang"><b>R</b></span> 2.13.0, and since deprecated wrappers for
<code><a href="#topic+find.package">find.package</a></code> and <code><a href="#topic+path.package">path.package</a></code>.
</p>
<p><code>unix.time</code> has been an &ldquo;alias&rdquo; for
<code><a href="#topic+system.time">system.time</a></code>, for historical S compatibility.
</p>
<p><code>is.R</code> tested if it is not running under historical dialects of S
(including S-PLUS), but cannot exclude other (including future)
programs claiming compatibility with <span class="rlang"><b>R</b></span>.  Its historical definition
was
</p>
<pre>
  exists("version") &amp;&amp; !is.null(vl &lt;- version$language) &amp;&amp; vl == "R"
</pre>
<p>which always evaluates to <code>TRUE</code> in <span class="rlang"><b>R</b></span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Defunct">Defunct</a></code>, <code><a href="#topic+base-deprecated">base-deprecated</a></code>
</p>

<hr>
<h2 id='base-deprecated'>Deprecated Functions in Package <span class="pkg">base</span></h2><span id='topic+base-deprecated'></span><span id='topic+as.data.frame.raw'></span><span id='topic+as.data.frame.logical'></span><span id='topic+as.data.frame.integer'></span><span id='topic+as.data.frame.numeric'></span><span id='topic+as.data.frame.complex'></span><span id='topic+as.data.frame.factor'></span><span id='topic+as.data.frame.ordered'></span><span id='topic+as.data.frame.Date'></span><span id='topic+as.data.frame.difftime'></span><span id='topic+as.data.frame.POSIXct'></span><span id='topic+as.data.frame.noquote'></span><span id='topic+as.data.frame.numeric_version'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older versions of
<span class="rlang"><b>R</b></span> only, and may be defunct as soon as the next release.
</p>
<p>The 12 <code>as.data.frame.&lt;cls&gt;</code> methods have been informally deprecated
already for <span class="rlang"><b>R</b></span> 4.3.z (via environment variable <span class="env">R_CHECK_AS_DATA_FRAME_EXPLICIT_METHOD</span>,
but also in package checks) and formally from <span class="rlang"><b>R</b></span> 4.4.0.
They are replaced typically by <code><a href="#topic+as.data.frame">as.data.frame</a>()</code> or possibly <code>as.data.frame.vector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.R()

as.data.frame.raw     (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.logical (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.integer (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.numeric (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.complex (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.factor  (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.ordered (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.Date    (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.difftime(x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.POSIXct (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.noquote (x, row.names=NULL, optional=FALSE, ..., nm=deparse1(substitute(x)))
as.data.frame.numeric_version(x, row.names=NULL, optional=FALSE, ...,
                              nm=deparse1(substitute(x)))
</code></pre>


<h3>Details</h3>

<p>Deprecated
functions in standard packages other than the base package are listed in
<code>help("pkg-deprecated")</code>, where &lsquo;<span class="samp">&#8288;pkg&#8288;</span>&rsquo; is replaced by the
name of the package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Deprecated">Deprecated</a></code>
</p>

<hr>
<h2 id='base-internal'>Internal Objects in Package <span class="pkg">base</span></h2><span id='topic+.subset'></span><span id='topic+.subset2'></span><span id='topic+.getRequiredPackages'></span><span id='topic+.getRequiredPackages2'></span><span id='topic+.formula2varlist'></span><span id='topic+.isMethodsDispatchOn'></span><span id='topic+sys.save.image'></span><span id='topic+sys.load.image'></span><span id='topic+.row_names_info'></span><span id='topic+.set_row_names'></span><span id='topic+.ArgsEnv'></span><span id='topic+.GenericArgsEnv'></span><span id='topic+findPackageEnv'></span><span id='topic+lazyLoadDBfetch'></span><span id='topic+.TAOCP1997init'></span><span id='topic+.gt'></span><span id='topic+.gtn'></span><span id='topic+.primTrace'></span><span id='topic+.primUntrace'></span><span id='topic+.Date'></span><span id='topic+.POSIXct'></span><span id='topic+.POSIXlt'></span><span id='topic+.difftime'></span><span id='topic+.cache_class'></span><span id='topic+.popath'></span><span id='topic+.detach'></span><span id='topic+.maskedMsg'></span><span id='topic+.C_R_addTaskCallback'></span><span id='topic+.C_R_getTaskCallbackNames'></span><span id='topic+.C_R_removeTaskCallback'></span><span id='topic+.F_dchdc'></span><span id='topic+.F_dqrcf'></span><span id='topic+.F_dqrdc2'></span><span id='topic+.F_dqrqty'></span><span id='topic+.F_dqrqy'></span><span id='topic+.F_dqrrsd'></span><span id='topic+.F_dqrxb'></span><span id='topic+.F_dtrco'></span><span id='topic+.C_R_getbcprofcounts'></span><span id='topic+.C_R_startbcprof'></span><span id='topic+.C_R_stopbcprof'></span><span id='topic+.fixupGFortranStderr'></span><span id='topic+.fixupGFortranStdout'></span><span id='topic+.doWrap'></span><span id='topic+.doSortWrap'></span><span id='topic+.amatch_bounds'></span><span id='topic+.amatch_costs'></span><span id='topic+.check_tzones'></span><span id='topic+.encode_numeric_version'></span><span id='topic+.decode_numeric_version'></span><span id='topic+.make_numeric_version'></span><span id='topic+.expand_R_libs_env_var'></span><span id='topic+.kronecker'></span><span id='topic+.packageStartupMessage'></span><span id='topic+.rmpkg'></span>

<h3>Description</h3>


<p>Internal objects in the base package most of which are only user-visible
because of the special nature of the base namespace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.subset(x, ...)
.subset2(x, ...)

.getRequiredPackages(file = "DESCRIPTION", lib.loc = NULL,
                     quietly = FALSE, useImports = FALSE)
.getRequiredPackages2(pkgInfo, quietly = FALSE, lib.loc = NULL,
                      useImports = FALSE)

.isMethodsDispatchOn(onOff = NULL)

sys.load.image(name, quiet)
sys.save.image(name)

.row_names_info(x, type = 1L)
.set_row_names(n)

findPackageEnv(info)

lazyLoadDBfetch(key, file, compressed, hook)

.TAOCP1997init(seed)

.gt(x, i, j)
.gtn(x, strictly)

.primTrace(obj)
.primUntrace(obj)

.Date(xx, cl = "Date")
.POSIXct(xx, tz = NULL, cl = c("POSIXct", "POSIXt"))
.POSIXlt(xx, tz = NULL, cl = c("POSIXlt", "POSIXt"))
.difftime(xx, units, cl = "difftime")

.cache_class(class, extends)

.popath

.detach(pos)

.maskedMsg(same, pkg, by)

## Only on Windows:
.fixupGFortranStdout()
.fixupGFortranStderr()

.doWrap(vec, decr, nalast, noNA = NA) 
.doSortWrap(vec, decr, nalast, noNA = NA)

.amatch_bounds(x = 0.1) 
.amatch_costs(x = NULL)
.check_tzones(...)
.decode_numeric_version(x)
.encode_numeric_version(x) 
.make_numeric_version(x, strict = TRUE, regexp, classes = NULL) 
.expand_R_libs_env_var(x) 
.kronecker(X, Y, FUN = "*", make.dimnames = FALSE, ...) 
.packageStartupMessage(message, call = NULL) 
.rmpkg(pkg) 
.formula2varlist(formula, data, warnLHS = TRUE, ignoreLHS = warnLHS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base-internal_+3A_x">x</code></td>
<td>
<p>an object
</p>

<dl>
<dt>for <code>.subset*()</code>:</dt><dd><p>from which to extract elements.</p>
</dd>
<dt>for <code>.row_names_info()</code>:</dt><dd><p>with a <code>"row.names"</code> attribute, typically a
data frame.</p>
</dd>
<dt>for <code>.gt</code>, <code>.gtn</code>:</dt><dd><p>typically S3- or S4-classed.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="base-internal_+3A_file">file</code></td>
<td>

<dl>
<dt>for <code>.getRequiredPackages()</code>:</dt><dd><p>the full path to the
&lsquo;<span class="file">DESCRIPTION</span>&rsquo; file of a package.</p>
</dd>
<dt>for <code>lazyLoadDBfetch()</code>:</dt><dd><p>the filepath to a lazyload database.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="base-internal_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector describing the location of <span class="rlang"><b>R</b></span>
library trees to search through, or <code>NULL</code>.  The default value
of <code>NULL</code> corresponds to all libraries currently known to
<code><a href="#topic+.libPaths">.libPaths</a>()</code>.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_quiet">quiet</code></td>
<td>
<p>logical.  Should this not give warnings or an error
if the package(s) are not found?</p>
</td></tr>
<tr><td><code id="base-internal_+3A_useimports">useImports</code></td>
<td>
<p>logical.  Should  the <code>Imports</code> field be processed?</p>
</td></tr>
<tr><td><code id="base-internal_+3A_quietly">quietly</code></td>
<td>
<p>logical: should message(s) be printed.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_pkginfo">pkgInfo</code></td>
<td>
<p>a processed &lsquo;<span class="file">DESCRIPTION</span>&rsquo; file of class
<code>"packageDescription2"</code>.</p>
</td></tr>

<tr><td><code id="base-internal_+3A_name">name</code></td>
<td>
<p>name of image file to save or load.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_type">type</code></td>
<td>
<p>integer.  Currently <code>type = 0</code> returns the internal
<code>"row.names"</code> attribute (possibly <code>NULL</code>), <code>type = 2</code>
the number of rows implied by the attribute, and <code>type = 1</code> the
latter with a negative sign for &lsquo;automatic&rsquo; row names.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_n">n</code></td>
<td>
<p>integer.  The number of rows.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_info">info</code></td>
<td>
<p>character string such as <code>"package:MASS"</code>.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_key">key</code></td>
<td>
<p>the object name in a lazyload database.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_compressed">compressed</code></td>
<td>
<p>logical: are the values in the database compressed?</p>
</td></tr>
<tr><td><code id="base-internal_+3A_hook">hook</code></td>
<td>
<p>a load hook: see <code><a href="#topic+unserialize">unserialize</a></code>.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_seed">seed</code></td>
<td>
<p>a length-one integer vector.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_i">i</code>, <code id="base-internal_+3A_j">j</code></td>
<td>
<p>indices.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_strictly">strictly</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_obj">obj</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_xx">xx</code></td>
<td>
<p>a classless object to be placed into the class.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_tz">tz</code></td>
<td>
<p>an optional time zone.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_cl">cl</code></td>
<td>
<p>an optional character vector of classes <em>containing</em>
the default classes.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_units">units</code></td>
<td>
<p>see <code><a href="#topic+difftime">difftime</a></code>.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_...">...</code></td>
<td>
<p>arguments passed to non-dot name versions.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_pos">pos</code></td>
<td>
<p>an integer.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_same">same</code></td>
<td>
<p>character vector of <em>same</em> objects, masking others.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_pkg">pkg</code></td>
<td>
<p>character string naming the package which is masked from or by.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_by">by</code></td>
<td>
<p>logical indicating if the masking happens <em>by</em>
<code>pkg</code>, or (<code>by = FALSE</code>) from <code>pkg</code>.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_formula">formula</code></td>
<td>
<p>typically a one sided formula, with no LHS.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_data">data</code></td>
<td>
<p>a data frame where terms in the formula are to be evaluated.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_warnlhs">warnLHS</code></td>
<td>
<p>logical flag, indicating whether the presence of an LHS
should trigger a warning.</p>
</td></tr>
<tr><td><code id="base-internal_+3A_ignorelhs">ignoreLHS</code></td>
<td>
<p>logical flag, indicating whether variables in the LHS
should be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>.subset</code> and <code>.subset2</code> are essentially
equivalent to the <code><a href="#topic++5B">[</a></code> and <code><a href="#topic++5B+5B">[[</a></code> operators,
except that methods dispatch does not take place.  This is to avoid
expensive unclassing when applying the default method to an object.  They
should not normally be invoked by end users.  Note that unlike the
operators they are builtins and not specials (all arguments are
evaluated) and hence do not allow missing arguments.
</p>
<p><code>.getRequiredPackages2</code> attaches all the packages mentioned in the
<code>Depends</code> field: failure to find a package is an error.  It also
checks the versions of the packages found against the <code>Depends</code> field.
</p>
<p><code>.getRequiredPackages</code> is a wrapper to
<code>.getRequiredPackages2</code> using a &lsquo;<span class="file">DESCRIPTION</span>&rsquo; file.
</p>
<p>The function <code>.isMethodsDispatchOn()</code> returns <code>TRUE</code> if
the S4 method dispatch has been turned on in the evaluator (usually by
loading package <span class="pkg">methods</span>).  It is meant for <span class="rlang"><b>R</b></span> internal use only.
</p>
<p><code>sys.save.image</code> is a system function that is called by <code>q()</code>
and its GUI analogs; <code>sys.load.image</code> is called by the startup code.
These functions should not be called directly and are subject to change.
</p>
<p><code>sys.save.image</code> closes all connections first, to ensure that it
is able to open a connection to save the image.  This is appropriate
when called from <code>q()</code> and allies, but reinforces the warning
that it should not be called directly.
</p>
<p><code><a href="#topic+row.names">row.names</a></code> can be stored internally in compact form.
<code>.set_row_names(n)</code> generates that form for automatic row names
of length <code>n</code>, to be assigned to
<code>attr(&lt;a data frame&gt;, "row.names")</code>.  <code>.row_names_info</code>
gives information on the internal form of the row names for a data
frame: for details of what information see the argument <code>type</code>.
</p>
<p><code>.GenericArgsEnv</code> and <code>.ArgsEnv</code> are environments that
contain closures with the argument lists that the primitives would
have had had they been closures.  All the primitives that are internal
S3 generics have corresponding members of <code>.GenericArgsEnv</code> and
the remaining non-language-element primitives correspond to
<code>.ArgsEnv</code>.  See the &lsquo;R Internals&rsquo; manual for further
details.  They are used by <code><a href="#topic+args">args</a></code> and
<code><a href="#topic+print.default">print.default</a></code> and the QC functions <code><a href="tools.html#topic+codoc">codoc</a></code>
and <code><a href="tools.html#topic+checkS3methods">checkS3methods</a></code>.
</p>
<p><code>findPackageEnv</code> is invoked by the unserialize code to set a
saved environment if possible.
</p>
<p><code>.TAOCP1997init</code> is the initialization code for the
<code>"Knuth-TAOCP"</code> <a href="#topic+RNG">RNG</a>.
</p>
<p><code>.gt</code> and <code>.gtn</code> are callbacks from <code><a href="#topic+rank">rank</a></code> and
<code><a href="#topic+is.unsorted">is.unsorted</a></code> used for (S3 or S4) classed objects.
</p>
<p><code>.primTrace</code> and <code>.primUntrace</code> are the <a href="#topic+primitive">primitive</a>
functions underlying <code><a href="#topic+trace">trace</a></code> and <code><a href="#topic+untrace">untrace</a></code>
respectively.
</p>
<p><code>.Date</code>, <code>.POSIXct</code>, <code>.POSIXlt</code> and <code>.difftime</code>
are class generators.
</p>
<p><code>.cache_class</code> caches the inheritance of an S4 class for use in
S3 method dispatch.  With <code>NULL</code> second argument it returns the
cached inheritance, for diagnostic use.
</p>
<p><code>.popath</code> is a character string created at startup which records where
the <span class="pkg">translations</span> package in use is, possibly <code>NA_character_</code>.
</p>
<p><code>.detach</code> is a &lsquo;bare-bones&rsquo; version of <code><a href="#topic+detach">detach</a></code> for
use in other <span class="rlang"><b>R</b></span> packages.
</p>
<p><code>.maskedMsg</code> is a utility called both from <code><a href="#topic+attach">attach</a>()</code>
and <code><a href="#topic+library">library</a>()</code> for consistency to produce the warning message.
</p>
<p>Objects starting <code>.C_</code> and <code>.F_</code> are references to
registered C and Fortran entry points.
</p>
<p><b>Only on Windows</b>:<br />
<code>.fixupGFortranStdout</code> and <code>.fixupGFortranStderr</code> are helper functions
to enable standard output and standard error units in <code>gfortran</code> when
executing external code via <code>system</code> and <code>system2</code>. By default, these
units are disabled by the Windows profile when running inside RGui.
</p>


<h3>Value</h3>

<p><code>.getRequiredPackages</code> and <code>.getRequiredPackages2</code>
return <code>invisible()</code>.
</p>

<p><code>.formula2varlist</code> returns a list of variables found in
<code>formula</code>, evaluated in <code>data</code>, following standard
non-standard evaluation rules. Used in <code><a href="#topic+split">split</a></code> and
<code><a href="#topic+tapply">tapply</a></code> to interpret a formula as a list of categorical
variables to split on. </p>

<hr>
<h2 id='basename'>Manipulate File Paths</h2><span id='topic+basename'></span><span id='topic+dirname'></span>

<h3>Description</h3>

<p><code>basename</code> removes all of the path up to and including the last
path separator (if any).
</p>
<p><code>dirname</code> returns the part of the <code>path</code> up to but
excluding the last path separator, or <code>"."</code> if there is no path
separator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basename(path)
dirname(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="basename_+3A_path">path</code></td>
<td>
<p>character vector, containing path names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="#topic+tilde+20expansion">tilde expansion</a> of the path will be performed.
</p>
<p>Trailing path separators are removed before dissecting the path,
and for <code>dirname</code> any trailing file separators are removed
from the result.
</p>


<h3>Value</h3>

<p>A character vector of the same length as <code>path</code>.  A zero-length
input will give a zero-length output with no error.
</p>
<p>Paths not containing any separators are taken to be in the current
directory, so <code>dirname</code> returns <code>"."</code>.
</p>
<p>If an element of <code>path</code> is <code><a href="#topic+NA">NA</a></code>, so is the result.
</p>
<p><code>""</code> is not a valid pathname, but is returned unchanged.
</p>


<h3>Behaviour on Windows</h3>

<p>On Windows this will accept either <code>\</code> or <code>/</code> as the path
separator, but <code>dirname</code> will return a path using <code>/</code>
(except if on a network share, when the leading <code>\\</code> will be
preserved).  Expect these only to be able to handle complete
paths, and not for example just a network share or a drive.
</p>
<p>UTF-8-encoded path names not valid in the current locale can be used.
</p>


<h3>Note</h3>

<p>These are not wrappers for the POSIX system functions of the same
names: in particular they do <strong>not</strong> have the special handling of
the path <code>"/"</code> and of returning <code>"."</code> for empty strings.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.path">file.path</a></code>, <code><a href="#topic+path.expand">path.expand</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>basename(file.path("","p1","p2","p3", c("file1", "file2")))
dirname (file.path("","p1","p2","p3", "filename"))
</code></pre>

<hr>
<h2 id='Bessel'>Bessel Functions</h2><span id='topic+bessel'></span><span id='topic+Bessel'></span><span id='topic+besselI'></span><span id='topic+besselJ'></span><span id='topic+besselK'></span><span id='topic+besselY'></span>

<h3>Description</h3>

<p>Bessel Functions of integer and fractional order, of first
and second kind, <code class="reqn">J_{\nu}</code> and <code class="reqn">Y_{\nu}</code>, and
Modified Bessel functions (of first and third kind),
<code class="reqn">I_{\nu}</code> and <code class="reqn">K_{\nu}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>besselI(x, nu, expon.scaled = FALSE)
besselK(x, nu, expon.scaled = FALSE)
besselJ(x, nu)
besselY(x, nu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bessel_+3A_x">x</code></td>
<td>
<p>numeric, <code class="reqn">\ge 0</code>.</p>
</td></tr>
<tr><td><code id="Bessel_+3A_nu">nu</code></td>
<td>
<p>numeric; the <em>order</em> (maybe fractional and negative) of
the corresponding Bessel function.</p>
</td></tr>
<tr><td><code id="Bessel_+3A_expon.scaled">expon.scaled</code></td>
<td>
<p>logical; if <code>TRUE</code>, the results are
exponentially scaled in order to avoid overflow
(<code class="reqn">I_{\nu}</code>) or underflow (<code class="reqn">K_{\nu}</code>),
respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>expon.scaled = TRUE</code>, <code class="reqn">e^{-x} I_{\nu}(x)</code>,
or <code class="reqn">e^{x} K_{\nu}(x)</code> are returned.
</p>
<p>For <code class="reqn">\nu &lt; 0</code>, formulae 9.1.2 and 9.6.2 from
Abramowitz &amp; Stegun
are applied (which is probably suboptimal), except for
<code>besselK</code> which is symmetric in <code>nu</code>.
</p>
<p>The current algorithms will give warnings about accuracy loss for
large arguments.  In some cases, these warnings are exaggerated, and
the precision is perfect.  For large <code>nu</code>, say in the order of
millions, the current algorithms are rarely useful.
</p>


<h3>Value</h3>

<p>Numeric vector with the (scaled, if <code>expon.scaled = TRUE</code>)
values of the corresponding Bessel function.
</p>
<p>The length of the result is the maximum of the lengths of the
parameters.  All parameters are recycled to that length.
</p>


<h3>Author(s)</h3>

<p>Original Fortran code:
W. J. Cody, Argonne National Laboratory <br />
Translation to C and adaptation to <span class="rlang"><b>R</b></span>:
Martin Maechler <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>.
</p>


<h3>Source</h3>

<p>The C code is a translation of Fortran routines from
<a href="https://netlib.org/specfun/ribesl">https://netlib.org/specfun/ribesl</a>, &lsquo;<span class="samp">&#8288;../rjbesl&#8288;</span>&rsquo;, etc.
The four source code files for bessel[IJKY] each contain a paragraph
&ldquo;Acknowledgement&rdquo; and &ldquo;References&rdquo;, a short summary of
which is
</p>

<dl>
<dt>besselI</dt><dd><p>based on (code) by David J. Sookne, see Sookne (1973)...
Modifications... An earlier version was published in Cody (1983).</p>
</dd>
<dt>besselJ</dt><dd><p>as <code>besselI</code></p>
</dd>
<dt>besselK</dt><dd><p>based on (code) by J. B. Campbell (1980)... Modifications...</p>
</dd>
<dt>besselY</dt><dd><p>draws heavily on Temme's Algol program for
<code class="reqn">Y</code>... and on Campbell's programs for <code class="reqn">Y_\nu(x)</code>
.... ... heavily modified.</p>
</dd>
</dl>



<h3>References</h3>

<p>Abramowitz, M. and Stegun, I. A. (1972).
<em>Handbook of Mathematical Functions</em>.
Dover, New York;
Chapter 9: Bessel Functions of Integer Order.
</p>
<p>In order of &ldquo;Source&rdquo; citation above:
</p>
<p>Sookne, David J. (1973).
Bessel Functions of Real Argument and Integer Order.
<em>Journal of Research of the National Bureau of Standards</em>,
<b>77B</b>, 125&ndash;132.
<a href="https://doi.org/10.6028/jres.077B.012">doi:10.6028/jres.077B.012</a>.
</p>
<p>Cody, William J. (1983).
Algorithm 597: Sequence of modified Bessel functions of the first kind.
<em>ACM Transactions on Mathematical Software</em>, <b>9</b>(2), 242&ndash;245.
<a href="https://doi.org/10.1145/357456.357462">doi:10.1145/357456.357462</a>.
</p>
<p>Campbell, J.B. (1980).
On Temme's algorithm for the modified Bessel function of the third kind.
<em>ACM Transactions on Mathematical Software</em>, <b>6</b>(4), 581&ndash;586.
<a href="https://doi.org/10.1145/355921.355928">doi:10.1145/355921.355928</a>.
</p>
<p>Campbell, J.B. (1979).
Bessel functions J_nu(x) and Y_nu(x) of float order and float argument.
<em>Computer Physics Communications</em>, <b>18</b>, 133&ndash;142.
<a href="https://doi.org/10.1016/0010-4655%2879%2990030-4">doi:10.1016/0010-4655(79)90030-4</a>.
</p>
<p>Temme, Nico M. (1976).
On the numerical evaluation of the ordinary Bessel function of the
second kind.
<em>Journal of Computational Physics</em>, <b>21</b>, 343&ndash;350.
<a href="https://doi.org/10.1016/0021-9991%2876%2990032-2">doi:10.1016/0021-9991(76)90032-2</a>.
</p>


<h3>See Also</h3>

<p>Other special mathematical functions, such as
<code><a href="#topic+gamma">gamma</a></code>, <code class="reqn">\Gamma(x)</code>, and <code><a href="#topic+beta">beta</a></code>,
<code class="reqn">B(x)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

nus &lt;- c(0:5, 10, 20)

x &lt;- seq(0, 4, length.out = 501)
plot(x, x, ylim = c(0, 6), ylab = "", type = "n",
     main = "Bessel Functions  I_nu(x)")
for(nu in nus) lines(x, besselI(x, nu = nu), col = nu + 2)
legend(0, 6, legend = paste("nu=", nus), col = nus + 2, lwd = 1)

x &lt;- seq(0, 40, length.out = 801); yl &lt;- c(-.5, 1)
plot(x, x, ylim = yl, ylab = "", type = "n",
     main = "Bessel Functions  J_nu(x)")
abline(h=0, v=0, lty=3)
for(nu in nus) lines(x, besselJ(x, nu = nu), col = nu + 2)
legend("topright", legend = paste("nu=", nus), col = nus + 2, lwd = 1, bty="n")

## Negative nu's --------------------------------------------------
xx &lt;- 2:7
nu &lt;- seq(-10, 9, length.out = 2001)
## --- I() --- --- --- ---
matplot(nu, t(outer(xx, nu, besselI)), type = "l", ylim = c(-50, 200),
        main = expression(paste("Bessel ", I[nu](x), " for fixed ", x,
                                ",  as ", f(nu))),
        xlab = expression(nu))
abline(v = 0, col = "light gray", lty = 3)
legend(5, 200, legend = paste("x=", xx), col=seq(xx), lty=1:5)

## --- J() --- --- --- ---
bJ &lt;- t(outer(xx, nu, besselJ))
matplot(nu, bJ, type = "l", ylim = c(-500, 200),
        xlab = quote(nu), ylab = quote(J[nu](x)),
        main = expression(paste("Bessel ", J[nu](x), " for fixed ", x)))
abline(v = 0, col = "light gray", lty = 3)
legend("topright", legend = paste("x=", xx), col=seq(xx), lty=1:5)

## ZOOM into right part:
matplot(nu[nu &gt; -2], bJ[nu &gt; -2,], type = "l",
        xlab = quote(nu), ylab = quote(J[nu](x)),
        main = expression(paste("Bessel ", J[nu](x), " for fixed ", x)))
abline(h=0, v = 0, col = "gray60", lty = 3)
legend("topright", legend = paste("x=", xx), col=seq(xx), lty=1:5)


##---------------  x --&gt; 0  -----------------------------
x0 &lt;- 2^seq(-16, 5, length.out=256)
plot(range(x0), c(1e-40, 1), log = "xy", xlab = "x", ylab = "", type = "n",
     main = "Bessel Functions  J_nu(x)  near 0\n log - log  scale") ; axis(2, at=1)
for(nu in sort(c(nus, nus+0.5)))
    lines(x0, besselJ(x0, nu = nu), col = nu + 2, lty= 1+ (nu%%1 &gt; 0))
legend("right", legend = paste("nu=", paste(nus, nus+0.5, sep=", ")),
       col = nus + 2, lwd = 1, bty="n")

x0 &lt;- 2^seq(-10, 8, length.out=256)
plot(range(x0), 10^c(-100, 80), log = "xy", xlab = "x", ylab = "", type = "n",
     main = "Bessel Functions  K_nu(x)  near 0\n log - log  scale") ; axis(2, at=1)
for(nu in sort(c(nus, nus+0.5)))
    lines(x0, besselK(x0, nu = nu), col = nu + 2, lty= 1+ (nu%%1 &gt; 0))
legend("topright", legend = paste("nu=", paste(nus, nus + 0.5, sep = ", ")),
       col = nus + 2, lwd = 1, bty="n")

x &lt;- x[x &gt; 0]
plot(x, x, ylim = c(1e-18, 1e11), log = "y", ylab = "", type = "n",
     main = "Bessel Functions  K_nu(x)"); axis(2, at=1)
for(nu in nus) lines(x, besselK(x, nu = nu), col = nu + 2)
legend(0, 1e-5, legend=paste("nu=", nus), col = nus + 2, lwd = 1)

yl &lt;- c(-1.6, .6)
plot(x, x, ylim = yl, ylab = "", type = "n",
     main = "Bessel Functions  Y_nu(x)")
for(nu in nus){
    xx &lt;- x[x &gt; .6*nu]
    lines(xx, besselY(xx, nu=nu), col = nu+2)
}
legend(25, -.5, legend = paste("nu=", nus), col = nus+2, lwd = 1)

## negative nu in bessel_Y -- was bogus for a long time
curve(besselY(x, -0.1), 0, 10, ylim = c(-3,1), ylab = "")
for(nu in c(seq(-0.2, -2, by = -0.1)))
  curve(besselY(x, nu), add = TRUE)
title(expression(besselY(x, nu) * "   " *
                 {nu == list(-0.1, -0.2, ..., -2)}))
</code></pre>

<hr>
<h2 id='bindenv'>Binding and Environment Locking, Active Bindings</h2><span id='topic+bindenv'></span><span id='topic+lockEnvironment'></span><span id='topic+environmentIsLocked'></span><span id='topic+lockBinding'></span><span id='topic+unlockBinding'></span><span id='topic+makeActiveBinding'></span><span id='topic+bindingIsLocked'></span><span id='topic+bindingIsActive'></span><span id='topic+activeBindingFunction'></span>

<h3>Description</h3>

<p>These functions represent an interface for adjustments
to environments and bindings within environments.  They allow for
locking environments as well as individual bindings, and for linking
a variable to a function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lockEnvironment(env, bindings = FALSE)
environmentIsLocked(env)
lockBinding(sym, env)
unlockBinding(sym, env)
bindingIsLocked(sym, env)

makeActiveBinding(sym, fun, env)
bindingIsActive(sym, env)
activeBindingFunction(sym, env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bindenv_+3A_env">env</code></td>
<td>
<p>an environment.</p>
</td></tr>
<tr><td><code id="bindenv_+3A_bindings">bindings</code></td>
<td>
<p>logical specifying whether bindings should be locked.</p>
</td></tr>
<tr><td><code id="bindenv_+3A_sym">sym</code></td>
<td>
<p>a name object or character string.</p>
</td></tr>
<tr><td><code id="bindenv_+3A_fun">fun</code></td>
<td>
<p>a function taking zero or one arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>lockEnvironment</code> locks its environment argument.
Locking the
environment prevents adding or removing variable bindings from the
environment.  Changing the value of a variable is still possible unless
the binding has been locked.  The namespace environments of packages
with namespaces are locked when loaded.
</p>
<p><code>lockBinding</code> locks individual bindings in the specified
environment.  The value of a locked binding cannot be changed.  Locked
bindings may be removed from an environment unless the environment is
locked.
</p>
<p><code>makeActiveBinding</code> installs <code>fun</code> in environment <code>env</code>
so that getting the value of <code>sym</code> calls <code>fun</code> with no
arguments, and assigning to <code>sym</code> calls <code>fun</code> with one
argument, the value to be assigned.  This allows the implementation of
things like C variables linked to <span class="rlang"><b>R</b></span> variables and variables linked to
databases, and is used to implement <code><a href="methods.html#topic+setRefClass">setRefClass</a></code>.  It may
also be useful for making thread-safe versions of some system globals.
Currently active bindings are not preserved during package installation,
but they can be created in <code><a href="#topic+.onLoad">.onLoad</a></code>.
</p>


<h3>Value</h3>

<p>The <code>bindingIsLocked</code> and <code>environmentIsLocked</code> return a
length-one logical vector.  The remaining functions return
<code>NULL</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>Luke Tierney</p>


<h3>Examples</h3>

<pre><code class='language-R'># locking environments
e &lt;- new.env()
assign("x", 1, envir = e)
get("x", envir = e)
lockEnvironment(e)
get("x", envir = e)
assign("x", 2, envir = e)
try(assign("y", 2, envir = e)) # error

# locking bindings
e &lt;- new.env()
assign("x", 1, envir = e)
get("x", envir = e)
lockBinding("x", e)
try(assign("x", 2, envir = e)) # error
unlockBinding("x", e)
assign("x", 2, envir = e)
get("x", envir = e)

# active bindings
f &lt;- local( {
    x &lt;- 1
    function(v) {
       if (missing(v))
           cat("get\n")
       else {
           cat("set\n")
           x &lt;&lt;- v
       }
       x
    }
})
makeActiveBinding("fred", f, .GlobalEnv)
bindingIsActive("fred", .GlobalEnv)
fred
fred &lt;- 2
fred
</code></pre>

<hr>
<h2 id='bitwise'>Bitwise Logical Operations</h2><span id='topic+bitwNot'></span><span id='topic+bitwAnd'></span><span id='topic+bitwOr'></span><span id='topic+bitwXor'></span><span id='topic+bitwShiftL'></span><span id='topic+bitwShiftR'></span>

<h3>Description</h3>

<p>Logical operations on integer vectors with elements viewed as sets of bits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bitwNot(a)
bitwAnd(a, b)
bitwOr(a, b)
bitwXor(a, b)

bitwShiftL(a, n)
bitwShiftR(a, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bitwise_+3A_a">a</code>, <code id="bitwise_+3A_b">b</code></td>
<td>
<p>integer vectors; numeric vectors are coerced to integer vectors.</p>
</td></tr>
<tr><td><code id="bitwise_+3A_n">n</code></td>
<td>
<p>non-negative integer vector of values up to 31.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each element of an integer vector has 32 bits.
</p>
<p>Pairwise operations can result in integer <code>NA</code>.
</p>
<p>Shifting is done assuming the values represent unsigned integers.
</p>


<h3>Value</h3>

<p>An integer vector of length the longer of the arguments, or zero
length if one is zero-length.
</p>
<p>The output element is <code>NA</code> if an input is <code>NA</code> (after
coercion) or an invalid shift.
</p>


<h3>See Also</h3>

<p>The logical operators, <code><a href="#topic++21">!</a></code>,  <code><a href="#topic++26">&amp;</a></code>,
<code><a href="#topic++7C">|</a></code>, <code><a href="#topic+xor">xor</a></code>.
Notably these <em>do</em> work bitwise for <code><a href="#topic+raw">raw</a></code> arguments.
</p>
<p>The classes <code>"<a href="#topic+octmode">octmode</a>"</code> and <code>"<a href="#topic+hexmode">hexmode</a>"</code> whose
implementation of the standard logical operators is based on these
functions.
</p>
<p>Package <a href="https://CRAN.R-project.org/package=bitops"><span class="pkg">bitops</span></a> has similar functions for numeric vectors which
differ in the way they treat integers <code class="reqn">2^{31}</code> or larger.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bitwNot(0:12) # -1 -2  ... -13
bitwAnd(15L, 7L) #  7
bitwOr (15L, 7L) # 15
bitwXor(15L, 7L) #  8
bitwXor(-1L, 1L) # -2

## The "same" for 'raw' instead of integer :
rr12 &lt;- as.raw(0:12) ; rbind(rr12, !rr12)
c(r15 &lt;- as.raw(15), r7 &lt;- as.raw(7)) #  0f 07
r15 &amp; r7    # 07
r15 | r7    # 0f
xor(r15, r7)# 08

bitwShiftR(-1, 1:31) # shifts of 2^32-1 = 4294967295
</code></pre>

<hr>
<h2 id='body'>Access to and Manipulation of the Body of a Function</h2><span id='topic+body'></span><span id='topic+body+3C-'></span>

<h3>Description</h3>

<p>Get or set the <em>body</em> of a function which is basically all of
the function definition but its formal arguments (<code><a href="#topic+formals">formals</a></code>),
see the &lsquo;Details&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body(fun = sys.function(sys.parent()))
body(fun, envir = environment(fun)) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="body_+3A_fun">fun</code></td>
<td>
<p>a function object, or see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="body_+3A_envir">envir</code></td>
<td>
<p>environment in which the function should be defined.</p>
</td></tr>
<tr><td><code id="body_+3A_value">value</code></td>
<td>
<p>an object, usually a <a href="#topic+language+20object">language object</a>: see section
&lsquo;Value&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the first form, <code>fun</code> can be a character string
naming the function to be manipulated, which is searched for from the
parent frame.  If it is not specified, the function calling
<code>body</code> is used.
</p>
<p>The bodies of all but the simplest are braced expressions, that is
calls to <code>{</code>: see the &lsquo;Examples&rsquo; section for how to
create such a call.
</p>


<h3>Value</h3>

<p><code>body</code> returns the body of the function specified.  This is
normally a <a href="#topic+language+20object">language object</a>, most often a call to <code>{</code>, but
it can also be a <code><a href="#topic+symbol">symbol</a></code> such as <code>pi</code> or a constant
(e.g., <code>3</code> or <code>"R"</code>) to be the return value of the function.
</p>
<p>The replacement form sets the body of a function to the
object on the right hand side, and (potentially) resets the
<code><a href="#topic+environment">environment</a></code> of the function, and drops
<code><a href="#topic+attributes">attributes</a></code>.  If <code>value</code> is of class
<code>"<a href="#topic+expression">expression</a>"</code> the first element is used as the body:  any
additional elements are ignored, with a warning.
</p>


<h3>See Also</h3>

<p>The three parts of a (non-primitive) function are its
<code><a href="#topic+formals">formals</a></code>, <code>body</code>, and <code><a href="#topic+environment">environment</a></code>.
</p>
<p>Further, see
<code><a href="#topic+alist">alist</a></code>,
<code><a href="#topic+args">args</a></code>,
<code><a href="#topic+function">function</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>body(body)
f &lt;- function(x) x^5
body(f) &lt;- quote(5^x)
## or equivalently  body(f) &lt;- expression(5^x)
f(3) # = 125
body(f)

## creating a multi-expression body
e &lt;- expression(y &lt;- x^2, return(y)) # or a list
body(f) &lt;- as.call(c(as.name("{"), e))
f
f(8)
## Using substitute() may be simpler than 'as.call(c(as.name("{",..)))':
stopifnot(identical(body(f), substitute({ y &lt;- x^2; return(y) })))
</code></pre>

<hr>
<h2 id='bquote'>Partial substitution in expressions</h2><span id='topic+bquote'></span>

<h3>Description</h3>

<p>An analogue of the LISP backquote macro.  <code>bquote</code> quotes its
argument except that terms wrapped in <code>.()</code> are evaluated in the
specified <code>where</code> environment. If <code>splice = TRUE</code> then
terms wrapped in <code>..()</code> are evaluated and spliced into a call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bquote(expr, where = parent.frame(), splice = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bquote_+3A_expr">expr</code></td>
<td>
<p>A <a href="#topic+language+20object">language object</a>.</p>
</td></tr>
<tr><td><code id="bquote_+3A_where">where</code></td>
<td>
<p>An environment.</p>
</td></tr>
<tr><td><code id="bquote_+3A_splice">splice</code></td>
<td>
<p>Logical; if <code>TRUE</code> splicing is enabled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+language+20object">language object</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+quote">quote</a></code>, <code><a href="#topic+substitute">substitute</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

a &lt;- 2

bquote(a == a)
quote(a == a)

bquote(a == .(a))
substitute(a == A, list(A = a))

plot(1:10, a*(1:10), main = bquote(a == .(a)))

## to set a function default arg
default &lt;- 1
bquote( function(x, y = .(default)) x+y )

exprs &lt;- expression(x &lt;- 1, y &lt;- 2, x + y)
bquote(function() {..(exprs)}, splice = TRUE)
</code></pre>

<hr>
<h2 id='browser'>Environment Browser</h2><span id='topic+browser'></span>

<h3>Description</h3>

<p>Interrupt the execution of an expression and allow the inspection of
the environment where <code>browser</code> was called from.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>browser(text = "", condition = NULL, expr = TRUE, skipCalls = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="browser_+3A_text">text</code></td>
<td>
<p>a text string that can be retrieved once the browser is invoked.</p>
</td></tr>
<tr><td><code id="browser_+3A_condition">condition</code></td>
<td>
<p>a condition that can be retrieved once the browser is
invoked.</p>
</td></tr>
<tr><td><code id="browser_+3A_expr">expr</code></td>
<td>
<p>a &ldquo;condition&rdquo;.  By default, and whenever not false
after being coerced to <code><a href="#topic+logical">logical</a></code>, the
debugger will be invoked, otherwise control is returned directly.</p>
</td></tr>
<tr><td><code id="browser_+3A_skipcalls">skipCalls</code></td>
<td>
<p>how many previous calls to skip when reporting the
calling context.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A call to <code>browser</code> can be included in the body of a function.
When reached, this causes a pause in the execution of the
current expression and allows access to the <span class="rlang"><b>R</b></span> interpreter.
</p>
<p>The purpose of the <code>text</code> and <code>condition</code> arguments are to
allow helper programs (e.g., external debuggers) to insert specific
values here, so that the specific call to browser (perhaps its location
in a source file) can be identified and special processing can be
achieved.  The values can be retrieved by calling <code><a href="#topic+browserText">browserText</a></code>
and <code><a href="#topic+browserCondition">browserCondition</a></code>.
</p>
<p>The purpose of the <code>expr</code> argument is to allow for the illusion
of conditional debugging. It is an illusion, because execution is
always paused at the call to browser, but control is only passed
to the evaluator described below if <code>expr</code> is not <code>FALSE</code> after
coercion to logical.
In most cases it is going to be more efficient to use an <code>if</code>
statement in the calling program, but in some cases using this argument
will be simpler.
</p>
<p>The <code>skipCalls</code> argument should be used when the <code>browser()</code>
call is nested within another debugging function:  it will look further
up the call stack to report its location.
</p>
<p>At the browser prompt the user can enter commands or <span class="rlang"><b>R</b></span> expressions,
followed by a newline.  The commands are
</p>

<dl>
<dt><code>c</code></dt><dd><p>exit the browser
and continue execution at the next statement.</p>
</dd>
<dt><code>cont</code></dt><dd><p>synonym for <code>c</code>.</p>
</dd>
<dt><code>f</code></dt><dd><p>finish execution of the current loop or function.</p>
</dd> 
<dt><code>help</code></dt><dd><p>print this list of commands.</p>
</dd>
<dt><code>n</code></dt><dd><p>evaluate the next statement, stepping over 
function calls.  For byte compiled functions interrupted by
<code>browser</code> calls, <code>n</code> is equivalent to <code>c</code>.</p>
</dd>
<dt><code>s</code></dt><dd><p>evaluate the next statement, stepping into
function calls.  Again, byte compiled functions make
<code>s</code> equivalent to <code>c</code>.</p>
</dd>
<dt><code>where</code></dt><dd><p>print a stack trace of all active function calls.</p>
</dd>
<dt><code>r</code></dt><dd><p>invoke a <code>"resume"</code> restart if one is
available; interpreted as an <span class="rlang"><b>R</b></span> expression otherwise. Typically
<code>"resume"</code> restarts are established for continuing from user
interrupts.</p>
</dd>
<dt><code>Q</code></dt><dd><p>exit the browser and the current evaluation and
return to the top-level prompt.</p>
</dd>
</dl>

<p>Leading and trailing whitespace is ignored, except for an empty line.
Handling of empty lines depends on the <code>"browserNLdisabled"</code> 
<a href="#topic+options">option</a>; if it is <code>TRUE</code>, empty lines are ignored.  
If not, an empty line is the same as <code>n</code> (or <code>s</code>, if it was used 
most recently).
</p>
<p>Anything else entered at the browser prompt is interpreted as an
<span class="rlang"><b>R</b></span> expression to be evaluated in the calling environment: in
particular typing an object name will cause the object to be printed,
and <code>ls()</code> lists the objects in the calling frame.  (If you want
to look at an object with a name such as <code>n</code>, print it
explicitly, or use autoprint via <code>(n)</code>.
</p>
<p>The number of lines printed for the deparsed call can be limited by
setting <code><a href="#topic+options">options</a>(deparse.max.lines)</code>.
</p>
<p>The browser prompt is of the form <code>Browse[<var>n</var>]&gt;</code>: here
<code><var>n</var></code> indicates the &lsquo;browser level&rsquo;.  The browser can
be called when browsing (and often is when <code><a href="#topic+debug">debug</a></code> is in
use), and each recursive call increases the number.  (The actual
number is the number of &lsquo;contexts&rsquo; on the context stack: this
is usually <code>2</code> for the outer level of browsing and <code>1</code> when
examining dumps in <code><a href="utils.html#topic+debugger">debugger</a></code>.)
</p>
<p>This is a primitive function but does argument matching in the
standard way.
</p>


<h3>Interaction with Condition Handling</h3>

<p>Because the browser prompt is implemented using the
<a href="#topic+conditions">restart and condition handling mechanism</a>,
it prevents error handlers set up before the breakpoint from being
called or invoked. The implementation follows this model:
</p>
<pre>
repeat withRestarts(
    withCallingHandlers(
        readEvalPrint(),
        error = function(cnd) {
            cat("Error:", conditionMessage(cnd), "\n")
            invokeRestart("browser")
        }
    ),
    browser = function(...) NULL
)

readEvalPrint &lt;- function(env = parent.frame()) {
    print(eval(parse(prompt = "Browse[n]&gt; "), env))
}
</pre>
<p>The restart invocation interrupts the lookup for condition handlers
and transfers control to the next iteration of the debugger <abbr><span class="acronym">REPL</span></abbr>.
</p>
<p>Note that condition handlers for other classes (such as <code>"warning"</code>)
are still called and may cause a non-local transfer of control out of the
debugger.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data. A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+debug">debug</a></code>, and
<code><a href="#topic+traceback">traceback</a></code> for the stack on error.
<code><a href="#topic+browserText">browserText</a></code> for how to retrieve the text and condition.
</p>

<hr>
<h2 id='browserText'>
Functions to Retrieve Values Supplied by Calls to the Browser
</h2><span id='topic+browserText'></span><span id='topic+browserCondition'></span><span id='topic+browserSetDebug'></span>

<h3>Description</h3>

<p>A call to browser can provide context by supplying either a text
argument or a condition argument.  These functions can be used to
retrieve either of these arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>browserText(n = 1)
browserCondition(n = 1)
browserSetDebug(n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="browserText_+3A_n">n</code></td>
<td>
<p>The number of contexts to skip over, it must be non-negative.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each call to <code>browser</code> can supply either a text string or a condition.
The functions <code>browserText</code> and <code>browserCondition</code> provide ways
to retrieve those values.  Since there can be multiple browser contexts
active at any time we also support retrieving values from the different
contexts.  The innermost (most recently initiated) browser context is
numbered 1: other contexts are numbered sequentially.
</p>
<p><code>browserSetDebug</code> provides a mechanism for initiating the browser in
one of the calling functions.  See <code><a href="#topic+sys.frame">sys.frame</a></code> for a more
complete discussion of the calling stack. To use <code>browserSetDebug</code>
you select some calling function, determine how far back it is in the call
stack and call <code>browserSetDebug</code> with <code>n</code> set to that value.
Then, by typing <code>c</code> at the browser prompt you will cause evaluation
to continue, and provided there are no intervening calls to browser or
other interrupts, control will halt again once evaluation has returned to
the closure specified.  This is similar to the up functionality in GDB
or the &quot;step out&quot; functionality in other debuggers.
</p>


<h3>Value</h3>

<p><code>browserText</code> returns the text, while <code>browserCondition</code>
returns the condition from the specified browser context.
</p>
<p><code>browserSetDebug</code> returns NULL, invisibly.
</p>


<h3>Note</h3>

<p>It may be of interest to allow for querying further up the set of browser
contexts and this functionality may be added at a later date.
</p>


<h3>Author(s)</h3>

<p>R. Gentleman
</p>


<h3>See Also</h3>

<p><code><a href="#topic+browser">browser</a></code>
</p>

<hr>
<h2 id='builtins'>Returns the Names of All Built-in Objects</h2><span id='topic+builtins'></span>

<h3>Description</h3>

<p>Return the names of all the built-in objects.  These are fetched
directly from the symbol table of the <span class="rlang"><b>R</b></span> interpreter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>builtins(internal = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="builtins_+3A_internal">internal</code></td>
<td>
<p>a logical indicating whether only &lsquo;internal&rsquo;
functions (which can be called via <code><a href="#topic+.Internal">.Internal</a></code>) should
be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>builtins()</code> returns an unsorted list of the objects in the
symbol table, that is all the objects in the base environment.
These are the built-in objects plus any that have been added
subsequently when the base package was loaded.  It is less confusing
to use <code>ls(baseenv(), all.names = TRUE)</code>.
</p>
<p><code>builtins(TRUE)</code> returns an unsorted list of the names of internal
functions, that is those which can be accessed as
<code>.Internal(<var>foo</var>(args ...))</code> for <var>foo</var> in the list.
</p>


<h3>Value</h3>

<p>A character vector.
</p>

<hr>
<h2 id='by'>Apply a Function to a Data Frame Split by Factors</h2><span id='topic+by'></span><span id='topic+by.default'></span><span id='topic+by.data.frame'></span><span id='topic+print.by'></span>

<h3>Description</h3>

<p>Function <code>by</code> is an object-oriented wrapper for
<code><a href="#topic+tapply">tapply</a></code> applied to data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>by(data, INDICES, FUN, ..., simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="by_+3A_data">data</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, normally a data frame, possibly a matrix.</p>
</td></tr>
<tr><td><code id="by_+3A_indices">INDICES</code></td>
<td>
<p>a factor or a list of factors, each of length
<code>nrow(data)</code>. For the data frame method, <code>INDICES</code> can also
be a formula as in the <code>f</code> argument of the <code><a href="#topic+split">split</a></code>
method for data frames.</p>
</td></tr>
<tr><td><code id="by_+3A_fun">FUN</code></td>
<td>
<p>a function to be applied to (usually data-frame) subsets of
<code>data</code>.</p>
</td></tr>
<tr><td><code id="by_+3A_...">...</code></td>
<td>
<p>further arguments to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="by_+3A_simplify">simplify</code></td>
<td>
<p>logical: see <code><a href="#topic+tapply">tapply</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A data frame is split by row into data frames
subsetted by the values of one or more factors, and function
<code>FUN</code> is applied to each subset in turn.
</p>
<p>For the default method, an object with dimensions (e.g., a matrix) is
coerced to a data frame and the data frame method applied.  Other
objects are also coerced to a data frame, but <code>FUN</code> is applied
separately to (subsets of) each column of the data frame.
</p>


<h3>Value</h3>

<p>An object of class <code>"by"</code>, giving the results for each subset.
This is always a list if <code>simplify</code> is false, otherwise a list or
array (see <code><a href="#topic+tapply">tapply</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tapply">tapply</a></code>, <code><a href="#topic+simplify2array">simplify2array</a></code>.
<code><a href="#topic+array2DF">array2DF</a></code> to convert result to a data
frame. <code><a href="stats.html#topic+ave">ave</a></code> also applies a function block-wise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
by(warpbreaks[, 1:2], warpbreaks[,"tension"], summary)
by(warpbreaks[, 1],   warpbreaks[, -1],       summary)
by(warpbreaks, warpbreaks[,"tension"],
   function(x) lm(breaks ~ wool, data = x))

## now suppose we want to extract the coefficients by group
tmp1 &lt;- with(warpbreaks,
            by(warpbreaks, tension,
               function(x) lm(breaks ~ wool, data = x)))
sapply(tmp1, coef)

## another way
tmp2 &lt;- by(warpbreaks, ~ tension,
           with, coef(lm(breaks ~ wool)))
array2DF(tmp2, simplify = TRUE)
</code></pre>

<hr>
<h2 id='c'>Combine Values into a Vector or List</h2><span id='topic+c'></span><span id='topic+c.default'></span>

<h3>Description</h3>

<p>This is a generic function which combines its arguments.
</p>
<p>The default method combines its arguments to form a vector.
All arguments are coerced to a common type which is the type
of the returned value, and all attributes except names are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 Generic function
c(...)

## Default S3 method:
c(..., recursive = FALSE, use.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="c_+3A_...">...</code></td>
<td>
<p>objects to be concatenated.  All <code><a href="#topic+NULL">NULL</a></code> entries
are dropped before method dispatch unless at the very beginning of the
argument list.</p>
</td></tr>
<tr><td><code id="c_+3A_recursive">recursive</code></td>
<td>
<p>logical.  If <code>recursive = TRUE</code>, the function
recursively descends through lists (and pairlists) combining all
their elements into a vector.</p>
</td></tr>
<tr><td><code id="c_+3A_use.names">use.names</code></td>
<td>
<p>logical indicating if <code><a href="#topic+names">names</a></code> should be
preserved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output type is determined from the highest type of the components
in the hierarchy NULL &lt; raw &lt; logical &lt; integer &lt; double &lt; complex &lt; character
&lt; list &lt; expression.  Pairlists are treated as lists, whereas non-vector
components (such as <code><a href="#topic+name">name</a></code>s / <code>symbol</code>s and <code><a href="#topic+call">call</a></code>s)
are treated as one-element <code><a href="#topic+list">list</a></code>s
which cannot be unlisted even if <code>recursive = TRUE</code>.
</p>
<p>If the output type is <code><a href="#topic+complex">complex</a></code>, logical, integer, and double
<code>NA</code>s keep their imaginary parts zero when coerced, and hence will
<em>not</em> become <code>NA_complex_</code> (with imaginary part <code>NA</code>).
</p>
<p>There is a <code><a href="#topic+c.factor">c.factor</a></code> method which combines factors into
a factor.
</p>
<p><code>c</code> is sometimes used for its side effect of removing attributes
except names, for example to turn an <code><a href="#topic+array">array</a></code> into a vector.
<code>as.vector</code> is a more intuitive way to do this, but also drops
names.  Note that <code>c</code> methods other than the default are not required
to remove attributes (and they will almost certainly preserve a class attribute).
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>Value</h3>

<p><code>NULL</code> or an expression or a vector of an appropriate mode.
(With no arguments the value is <code>NULL</code>.)
</p>


<h3>S4 methods</h3>

<p>This function is S4 generic, but with argument list
<code>(x, ...)</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unlist">unlist</a></code> and <code><a href="#topic+as.vector">as.vector</a></code> to produce
attribute-free vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>c(1, 7:9)
c(1:5, 10.5, "next")

## uses with a single argument to drop attributes
x &lt;- 1:4
names(x) &lt;- letters[1:4]
x
c(x)          # has names
as.vector(x)  # no names
dim(x) &lt;- c(2,2)
x
c(x)
as.vector(x)

## append to a list:
ll &lt;- list(A = 1, c = "C")
## do *not* use
c(ll, d = 1:3) # which is == c(ll, as.list(c(d = 1:3)))
## but rather
c(ll, d = list(1:3))  # c() combining two lists

## descend through lists:
c(list(A = c(B = 1)), recursive = TRUE)
c(list(A = c(B = 1, C = 2), B = c(E = 7)), recursive = TRUE)
</code></pre>

<hr>
<h2 id='call'>Function Calls</h2><span id='topic+call'></span><span id='topic+is.call'></span><span id='topic+as.call'></span>

<h3>Description</h3>

<p>Create or test for objects of <code><a href="#topic+mode">mode</a></code> <code>"call"</code> (or
<code>"("</code>, see Details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call(name, ...)
is.call(x)
as.call(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_+3A_name">name</code></td>
<td>
<p>a non-empty character string naming the function to be called.</p>
</td></tr>
<tr><td><code id="call_+3A_...">...</code></td>
<td>
<p>arguments to be part of the call.</p>
</td></tr>
<tr><td><code id="call_+3A_x">x</code></td>
<td>
<p>an arbitrary <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>call</code> </dt><dd><p>returns an unevaluated function call, that is, an
unevaluated expression which consists of the named function applied to
the given arguments (<code>name</code> must be a string which gives
the name of a function to be called).  Note that although the call is
unevaluated, the arguments <code>...</code> are evaluated.
</p>
<p><code>call</code> is a primitive, so the first argument is
taken as <code>name</code> and the remaining arguments as arguments for the
constructed call: if the first argument is named the name must
partially match <code>name</code>.
</p>
</dd>
<dt><code>is.call</code> </dt><dd><p>is used to determine whether <code>x</code> is a call (i.e.,
of <code><a href="#topic+mode">mode</a></code> <code>"call"</code> or <code>"("</code>).  Note that
</p>

<ul>
<li> <p><code>is.call(x)</code> is strictly equivalent to
<code>typeof(x) == "language"</code>.
</p>
</li>
<li> <p><code><a href="#topic+is.language">is.language</a>()</code> is also true for calls (but also
for <code><a href="#topic+symbol">symbol</a></code>s and <code><a href="#topic+expression">expression</a></code>s where
<code>is.call()</code> is false).
</p>
</li>
<li><p> When <code>is.call(cl)</code> is true, <code><a href="#topic+class">class</a>(cl)</code>
typically returns <code>"call"</code>, except when <code>cl</code> is one of
<code>if</code>, <code>for</code>, <code>while</code>, <code>(</code>, <code>{</code>,  <code>&lt;-</code>, <code>=</code>,
which each has its own <code>class(cl)</code> (equal to the
&ldquo;function&rdquo; name), see the &lsquo;Special calls&rsquo; example.
</p>
</li></ul>

</dd>
<dt><code>as.call(x)</code>: </dt><dd><p>Objects of mode <code>"list"</code> can be coerced to mode <code>"call"</code>.
The first element of the list becomes the function part of the call,
so should be a function or the name of one (as a symbol; a character string will not do).
</p>
<p>If you think of using <code>as.call(<var>string</var>)</code>, consider using
<code><a href="#topic+str2lang">str2lang</a>(<var>string</var>)</code> which is an efficient version of
<code><a href="#topic+parse">parse</a>(text=<var>string</var>)</code>.
Note that <code><a href="#topic+call">call</a>()</code> and <code><a href="#topic+as.call">as.call</a>()</code>, when
applicable, are much preferable to these <code><a href="#topic+parse">parse</a>()</code> based
approaches.
</p>
</dd>
</dl>

<p>All three are <a href="#topic+primitive">primitive</a> functions.
</p>
<p><code>as.call</code> is generic: you can write methods to handle specific
classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Warning</h3>

<p><code>call</code> should not be used to attempt to evade restrictions on the
use of <code>.Internal</code> and other non-API calls.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+do.call">do.call</a></code> for calling a function by name and argument
list;
<code><a href="#topic+Recall">Recall</a></code> for recursive calling of functions;
further
<code><a href="#topic+is.language">is.language</a></code>,
<code><a href="#topic+expression">expression</a></code>,
<code><a href="#topic+function">function</a></code>.
</p>
<p>Producing <code><a href="#topic+call">call</a></code>s etc from character: <code><a href="#topic+str2lang">str2lang</a></code> and
<code><a href="#topic+parse">parse</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.call(call) #-&gt; FALSE: Functions are NOT calls

## set up a function call to round with argument 10.5
cl &lt;- call("round", 10.5)
is.call(cl) # TRUE
cl
identical(quote(round(10.5)), # &lt;- less functional, but the same
          cl) # TRUE
## such a call can also be evaluated.
eval(cl) # [1] 10

class(cl) # "call"
typeof(cl)# "language"
is.call(cl) &amp;&amp; is.language(cl) # always TRUE for "call"s

A &lt;- 10.5
call("round", A)        # round(10.5)
call("round", quote(A)) # round(A)
f &lt;- "round"
call(f, quote(A))       # round(A)
## if we want to supply a function we need to use as.call or similar
f &lt;- round
## Not run: call(f, quote(A))  # error: first arg must be character
(g &lt;- as.call(list(f, quote(A))))
eval(g)
## alternatively but less transparently
g &lt;- list(f, quote(A))
mode(g) &lt;- "call"
g
eval(g)

## Special calls (and some regular ones):
L &lt;- as.list(E &lt;- setNames( , c("if", "for", "while", "repeat", "function",
                                  "(", "{", "[",  "&lt;-", "&lt;&lt;-", "-&gt;", "=")))
for(i in seq_along(L)) L[[i]] &lt;- call(E[[i]]) # instead of lapply(E, call) ..
list_ &lt;- function (...) `names&lt;-`(list(...), vapply(sys.call()[-1L], as.character, ""))
(Tab &lt;- noquote(sapply(list_(is.call, typeof, class, mode), \(F) sapply(L, F))))
## The 7 exceptions:
Tab[ Tab[,"class"] != "call" , c(3:4, 1:2)]

## see also the examples in the help for do.call
</code></pre>

<hr>
<h2 id='callCC'>Call With Current Continuation</h2><span id='topic+callCC'></span>

<h3>Description</h3>

<p>A downward-only version of Scheme's call with current continuation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>callCC(fun)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="callCC_+3A_fun">fun</code></td>
<td>
<p>function of one argument, the exit procedure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>callCC</code> provides a non-local exit mechanism that can be useful
for early termination of a computation.  <code>callCC</code> calls
<code>fun</code> with one argument, an <em>exit function</em>.  The exit
function takes a single argument, the intended return value.  If the
body of <code>fun</code> calls the exit function then the call to
<code>callCC</code> immediately returns, with the value supplied to the exit
function as the value returned by <code>callCC</code>.
</p>


<h3>Author(s)</h3>

<p>Luke Tierney</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following all return the value 1
callCC(function(k) 1)
callCC(function(k) k(1))
callCC(function(k) {k(1); 2})
callCC(function(k) repeat k(1))
</code></pre>

<hr>
<h2 id='CallExternal'>Modern Interfaces to C/C++ code</h2><span id='topic+.Call'></span><span id='topic+.External'></span>

<h3>Description</h3>

<p>Functions to pass <span class="rlang"><b>R</b></span> objects to compiled C/C++ code that has been
loaded into <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    .Call(.NAME, ..., PACKAGE)
.External(.NAME, ..., PACKAGE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CallExternal_+3A_.name">.NAME</code></td>
<td>
<p>a character string giving the name of a C function,
or an object of class <code>"<a href="#topic+NativeSymbolInfo">NativeSymbolInfo</a>"</code>,
<code>"<a href="#topic+RegisteredNativeSymbol">RegisteredNativeSymbol</a>"</code> or
<code>"<a href="#topic+NativeSymbol">NativeSymbol</a>"</code> referring to such a name.</p>
</td></tr>
<tr><td><code id="CallExternal_+3A_...">...</code></td>
<td>
<p>arguments to be passed to the compiled code. Up to 65 for
<code>.Call</code>.</p>
</td></tr>
<tr><td><code id="CallExternal_+3A_package">PACKAGE</code></td>
<td>
<p>if supplied, confine the search for a character string
<code>.NAME</code> to the DLL given by this argument (plus the
conventional extension, &lsquo;<span class="file">.so</span>&rsquo;, &lsquo;<span class="file">.dll</span>&rsquo;, ...).
</p>
<p>This argument follows <code>...</code> and so its name cannot be abbreviated.
</p>
<p>This is intended to add safety for packages, which can ensure by
using this argument that no other package can override their
external symbols, and also speeds up the search (see &lsquo;Note&rsquo;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions are used to call compiled code which makes use of
internal <span class="rlang"><b>R</b></span> objects, passing the arguments to the code as a sequence
of <span class="rlang"><b>R</b></span> objects.  They assume C calling conventions, so can usually
also be used for C++ code.
</p>
<p>For details about how to write code to use with these functions see
the chapter on &lsquo;System and foreign language interfaces&rsquo; in
the &lsquo;Writing R Extensions&rsquo; manual.  They differ in the way the
arguments are passed to the C code:  <code>.External</code> allows for a
variable or unlimited number of arguments.
</p>
<p>These functions are <a href="#topic+primitive">primitive</a>, and <code>.NAME</code> is always
matched to the first argument supplied (which should not be named).
For clarity, avoid using names in the arguments passed to <code>...</code>
that match or partially match <code>.NAME</code>.
</p>


<h3>Value</h3>

<p>An <span class="rlang"><b>R</b></span> object constructed in the compiled code.
</p>


<h3>Header files for external code</h3>

<p>Writing code for use with these functions will need to use internal <span class="rlang"><b>R</b></span>
structures defined in &lsquo;<span class="file">Rinternals.h</span>&rsquo; and/or the macros in
&lsquo;<span class="file">Rdefines.h</span>&rsquo;.
</p>


<h3>Note</h3>

<p>If one of these functions is to be used frequently, do specify
<code>PACKAGE</code> (to confine the search to a single DLL) or pass
<code>.NAME</code> as one of the native symbol objects.  Searching for
symbols can take a long time, especially when many namespaces are loaded.
</p>
<p>You may see <code>PACKAGE = "base"</code> for symbols linked into <span class="rlang"><b>R</b></span>.  Do
not use this in your own code: such symbols are not part of the API
and may be changed without warning.
</p>
<p><code>PACKAGE = ""</code> used to be accepted (but was undocumented): it is
now an error.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer. (<code>.Call</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dyn.load">dyn.load</a></code>, <code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Fortran">.Fortran</a></code>.
</p>
<p>The &lsquo;Writing R Extensions&rsquo; manual.
</p>

<hr>
<h2 id='capabilities'>Report Capabilities of this Build of R</h2><span id='topic+capabilities'></span>

<h3>Description</h3>

<p>Report on the optional features which have been compiled into this
build of <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capabilities(what = NULL,
             Xchk = any(nas %in% c("X11", "jpeg", "png", "tiff")))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="capabilities_+3A_what">what</code></td>
<td>
<p>character vector or <code>NULL</code>, specifying
required components.  <code>NULL</code> implies that all are required.</p>
</td></tr>
<tr><td><code id="capabilities_+3A_xchk">Xchk</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> with a smart default, indicating if
X11-related capabilities should be fully checked, notably on macOS.
If set to false, may avoid a warning &ldquo;No protocol specified&rdquo;
and e.g., the &quot;X11&quot; capability may be returned as <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named logical vector.  Current components are
</p>
<table>
<tr><td><code>jpeg</code></td>
<td>
<p>is the <code><a href="grDevices.html#topic+jpeg">jpeg</a></code> function operational?</p>
</td></tr>
<tr><td><code>png</code></td>
<td>
<p>is the <code><a href="grDevices.html#topic+png">png</a></code> function operational?</p>
</td></tr>
<tr><td><code>tiff</code></td>
<td>
<p>is the <code><a href="grDevices.html#topic+tiff">tiff</a></code> function operational?</p>
</td></tr>
<tr><td><code>tcltk</code></td>
<td>
<p>is the <span class="pkg">tcltk</span> package operational?
Note that to make use of Tk you will almost always need to check
that <code>"X11"</code> is also available.
</p>
</td></tr>
<tr><td><code>X11</code></td>
<td>
<p>are the <code><a href="grDevices.html#topic+X11">X11</a></code> graphics device and the
X11-based data editor available?  This loads the X11 module if not
already loaded, and checks that the default display can be
contacted unless a <code>X11</code> device has already been used.</p>
</td></tr>
<tr><td><code>aqua</code></td>
<td>
<p>is the <code><a href="grDevices.html#topic+quartz">quartz</a></code> function operational?
Only on some macOS builds, including <abbr>CRAN</abbr> binary
distributions of <span class="rlang"><b>R</b></span>.
</p>
<p>Note that this is distinct from <code>.Platform$GUI == "AQUA"</code>,
which is true only when using the Mac <code>R.app</code> GUI console.</p>
</td></tr>
<tr><td><code>http/ftp</code></td>
<td>
<p>does the default method for <code><a href="#topic+url">url</a></code> and
<code><a href="utils.html#topic+download.file">download.file</a></code> support &lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo;
URLs?  Always <code>TRUE</code> as from <span class="rlang"><b>R</b></span> 3.3.0.  However, in recent
versions the default method is <code>"libcurl"</code> which depends on an
external library and it is conceivable that library might not
support &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo; in future.</p>
</td></tr>
<tr><td><code>sockets</code></td>
<td>
<p>are <code><a href="utils.html#topic+make.socket">make.socket</a></code> and related functions
available?  Always <code>TRUE</code> as from <span class="rlang"><b>R</b></span> 3.3.0.</p>
</td></tr>
<tr><td><code>libxml</code></td>
<td>
<p>is there support for integrating <code>libxml</code> with
the <span class="rlang"><b>R</b></span> event loop?  <code>TRUE</code> as from <span class="rlang"><b>R</b></span> 3.3.0, <code>FALSE</code> as
from <span class="rlang"><b>R</b></span> 4.2.0.</p>
</td></tr>
<tr><td><code>fifo</code></td>
<td>
<p>are FIFO <a href="#topic+connections">connections</a> supported?</p>
</td></tr>
<tr><td><code>cledit</code></td>
<td>
<p>is command-line editing available in the current <span class="rlang"><b>R</b></span>
session?  This is false in non-interactive sessions.
It will be true for the command-line interface if <code>readline</code>
support has been compiled in and <span class="option">--no-readline</span> was
<em>not</em> used when <span class="rlang"><b>R</b></span> was invoked.  (If <span class="option">--interactive</span>
was used, command-line editing will not actually be available.)
</p>
</td></tr>
<tr><td><code>iconv</code></td>
<td>
<p>is internationalization conversion via
<code><a href="#topic+iconv">iconv</a></code> supported?  Always true in current <span class="rlang"><b>R</b></span>.</p>
</td></tr>
<tr><td><code>NLS</code></td>
<td>
<p>is there Natural Language Support (for message translations)?</p>
</td></tr>
<tr><td><code>Rprof</code></td>
<td>
<p>is there support for <code><a href="utils.html#topic+Rprof">Rprof</a>()</code> profiling?  This
is true if <span class="rlang"><b>R</b></span> was configured (before compilation) with default settings
which include <code>--enable-R-profiling</code>.</p>
</td></tr>
<tr><td><code>profmem</code></td>
<td>
<p>is there support for memory profiling?  See
<code><a href="#topic+tracemem">tracemem</a></code>.</p>
</td></tr>
<tr><td><code>cairo</code></td>
<td>
<p>is there support for the <code><a href="grDevices.html#topic+svg">svg</a></code>,
<code><a href="grDevices.html#topic+cairo_pdf">cairo_pdf</a></code> and <code><a href="grDevices.html#topic+cairo_ps">cairo_ps</a></code> devices, and
for <code>type = "cairo"</code> in the <code><a href="grDevices.html#topic+bmp">bmp</a></code>,
<code><a href="grDevices.html#topic+jpeg">jpeg</a></code>, <code><a href="grDevices.html#topic+png">png</a></code> and <code><a href="grDevices.html#topic+tiff">tiff</a></code>
devices?
Prior to <span class="rlang"><b>R</b></span> 4.1.0 this also indicated Cairo support in the
<code><a href="grDevices.html#topic+X11">X11</a></code> device, but it is now possible to build <span class="rlang"><b>R</b></span> with
Cairo support for the bitmap devices without support for the
<code>X11</code> device (usually when that is not supported at all).
</p>
</td></tr>
<tr><td><code>ICU</code></td>
<td>
<p>is ICU available for collation?  See the help on
<a href="#topic+Comparison">Comparison</a> and <code><a href="#topic+icuSetCollate">icuSetCollate</a></code>: it is never
used for a C locale.</p>
</td></tr>
<tr><td><code>long.double</code></td>
<td>
<p>does this build use a <code>C</code> <code>long double</code>
type which is longer than <code>double</code>?  Some platforms do not
have such a type, and on others its use can be suppressed by the
configure option <span class="option">--disable-long-double</span>.
</p>
<p>Although not guaranteed, it is a reasonable assumption that if
present long doubles will have at least as much range and accuracy
as the ISO/<abbr>IEC</abbr> 60559 80-bit &lsquo;extended precision&rsquo; format.  Since
<span class="rlang"><b>R</b></span> 4.0.0 <code><a href="#topic+.Machine">.Machine</a></code> gives information on the
long-double type (if present).
</p>
</td></tr>
<tr><td><code>libcurl</code></td>
<td>
<p>is <code>libcurl</code> available in this build?  Used by
function <code><a href="#topic+curlGetHeaders">curlGetHeaders</a></code> and optionally by
<code><a href="utils.html#topic+download.file">download.file</a></code> and <code><a href="#topic+url">url</a></code>.   As from <span class="rlang"><b>R</b></span>
3.3.0 always true for Unix-alikes, and as from <span class="rlang"><b>R</b></span> 4.2.0 true on Windows.</p>
</td></tr>
</table>


<h3>Note to macOS users</h3>

<p>Capabilities <code>"jpeg"</code>, <code>"png"</code> and <code>"tiff"</code> refer to
the X11-based versions of these devices.  If
<code>capabilities("aqua")</code> is true, then these devices with
<code>type = "quartz"</code> will be available, and out-of-the-box will be the
default type.  Thus for example the <code><a href="grDevices.html#topic+tiff">tiff</a></code> device will be
available if <code>capabilities("aqua") || capabilities("tiff")</code> if
the defaults are unchanged.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.Platform">.Platform</a></code>, <code><a href="#topic+extSoftVersion">extSoftVersion</a></code>, and
<code><a href="grDevices.html#topic+grSoftVersion">grSoftVersion</a></code> (and links there)
for availability of capabilities <em>external</em> to <span class="rlang"><b>R</b></span> but
used from <span class="rlang"><b>R</b></span> functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>capabilities()

if(!capabilities("ICU"))
   warning("ICU is not available")

## Does not call the internal X11-checking function:
capabilities(Xchk = FALSE)

## See also the examples for 'connections'.
</code></pre>

<hr>
<h2 id='cat'>Concatenate and Print</h2><span id='topic+cat'></span>

<h3>Description</h3>

<p>Outputs the objects, concatenating the representations.  <code>cat</code>
performs much less conversion than <code><a href="#topic+print">print</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cat(... , file = "", sep = " ", fill = FALSE, labels = NULL,
    append = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cat_+3A_...">...</code></td>
<td>
<p><span class="rlang"><b>R</b></span> objects (see &lsquo;Details&rsquo; for the types of objects
allowed).</p>
</td></tr>
<tr><td><code id="cat_+3A_file">file</code></td>
<td>
<p>a <a href="#topic+connection">connection</a>, or a character string naming the file
to print to.  If <code>""</code> (the default), <code>cat</code> prints to the
standard output connection, the console unless redirected by
<code><a href="#topic+sink">sink</a></code>.
If it is <code>"|cmd"</code>, the output is piped to the command given
by &lsquo;<span class="file">cmd</span>&rsquo;, by opening a pipe connection.
</p>
</td></tr>
<tr><td><code id="cat_+3A_sep">sep</code></td>
<td>
<p>a character vector of strings to append after each element.</p>
</td></tr>
<tr><td><code id="cat_+3A_fill">fill</code></td>
<td>
<p>a logical or (positive) numeric controlling how the output is
broken into successive lines.  If <code>FALSE</code> (default), only newlines
created explicitly by &lsquo;<span class="samp">&#8288;"\n"&#8288;</span>&rsquo; are printed.  Otherwise, the
output is broken into lines with print width equal to the option
<code>width</code> if <code>fill</code> is <code>TRUE</code>, or the value of
<code>fill</code> if this is numeric.  Linefeeds are only inserted
<em>between</em> elements, strings wider than <code>fill</code> are not
wrapped.  Non-positive <code>fill</code> values are
ignored, with a warning.</p>
</td></tr>
<tr><td><code id="cat_+3A_labels">labels</code></td>
<td>
<p>character vector of labels for the lines printed.
Ignored if <code>fill</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cat_+3A_append">append</code></td>
<td>
<p>logical. Only used if the argument <code>file</code> is the
name of file (and not a connection or <code>"|cmd"</code>).
If <code>TRUE</code> output will be appended to
<code>file</code>; otherwise, it will overwrite the contents of
<code>file</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cat</code> is useful for producing output in user-defined functions.
It converts its arguments to character vectors, concatenates
them to a single character vector, appends the given <code>sep = </code>
string(s) to each element and then outputs them.
</p>
<p>No line feeds (aka &ldquo;newline&rdquo;s) are output unless explicitly
requested by &lsquo;<span class="samp">&#8288;"\n"&#8288;</span>&rsquo;
or if generated by filling (if argument <code>fill</code> is <code>TRUE</code> or
numeric).
</p>
<p>If <code>file</code> is a connection and open for writing it is written from
its current position.  If it is not open, it is opened for the
duration of the call in <code>"wt"</code> mode and then closed again.
</p>
<p>Currently only <a href="#topic+atomic">atomic</a> vectors and <a href="#topic+name">name</a>s are handled,
together with <code>NULL</code> and other zero-length objects (which produce
no output).  Character strings are output &lsquo;as is&rsquo; (unlike
<code><a href="#topic+print.default">print.default</a></code> which escapes non-printable characters and
backslash &mdash; use <code><a href="#topic+encodeString">encodeString</a></code> if you want to output
encoded strings using <code>cat</code>).  Other types of <span class="rlang"><b>R</b></span> object should be
converted (e.g., by <code><a href="#topic+as.character">as.character</a></code> or <code><a href="#topic+format">format</a></code>)
before being passed to <code>cat</code>.  That includes factors, which are
output as integer vectors.
</p>
<p><code>cat</code> converts numeric/complex elements in the same way as
<code>print</code> (and not in the same way as <code><a href="#topic+as.character">as.character</a></code>
which is used by the S equivalent), so <code><a href="#topic+options">options</a></code>
<code>"digits"</code> and <code>"scipen"</code> are relevant.  However, it uses
the minimum field width necessary for each element, rather than the
same field width for all elements.
</p>


<h3>Value</h3>

<p>None (invisible <code>NULL</code>).
</p>


<h3>Note</h3>

<p>If any element of <code>sep</code> contains a newline character, it is
treated as a vector of terminators rather than separators, an element
being output after every vector element <em>and</em> a newline after the
last.  Entries are recycled as needed.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print">print</a></code>, <code><a href="#topic+format">format</a></code>, and <code><a href="#topic+paste">paste</a></code>
which concatenates into a string.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iter &lt;- stats::rpois(1, lambda = 10)
## print an informative message
cat("iteration = ", iter &lt;- iter + 1, "\n")

## 'fill' and label lines:
cat(paste(letters, 100* 1:26), fill = TRUE, labels = paste0("{", 1:10, "}:"))
</code></pre>

<hr>
<h2 id='cbind'>Combine R Objects by Rows or Columns</h2><span id='topic+cbind'></span><span id='topic+rbind'></span><span id='topic+cbind.data.frame'></span><span id='topic+rbind.data.frame'></span>

<h3>Description</h3>

<p>Take a sequence of vector, matrix or data-frame arguments and combine
by <em>c</em>olumns or <em>r</em>ows, respectively.  These are generic
functions with methods for other <span class="rlang"><b>R</b></span> classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbind(..., deparse.level = 1)
rbind(..., deparse.level = 1)
## S3 method for class 'data.frame'
rbind(..., deparse.level = 1, make.row.names = TRUE,
      stringsAsFactors = FALSE, factor.exclude = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cbind_+3A_...">...</code></td>
<td>
<p>(generalized) vectors or matrices.  These can be given as named
arguments.  Other <span class="rlang"><b>R</b></span> objects may be coerced as appropriate, or S4
methods may be used: see sections &lsquo;Details&rsquo; and
&lsquo;Value&rsquo;.  (For the <code>"data.frame"</code> method of <code>cbind</code>
these can be further arguments to <code><a href="#topic+data.frame">data.frame</a></code> such as
<code>stringsAsFactors</code>.)</p>
</td></tr>
<tr><td><code id="cbind_+3A_deparse.level">deparse.level</code></td>
<td>
<p>integer controlling the construction of labels in
the case of non-matrix-like arguments (for the default method):<br />
<code>deparse.level = 0</code> constructs no labels;<br />
the default <code>deparse.level = 1</code> typically and
<code>deparse.level = 2</code> always construct labels from the argument
names, see the &lsquo;Value&rsquo; section below.</p>
</td></tr>
<tr><td><code id="cbind_+3A_make.row.names">make.row.names</code></td>
<td>
<p>(only for data frame method:) logical
indicating if unique and valid <code><a href="#topic+row.names">row.names</a></code> should be
constructed from the arguments.</p>
</td></tr>
<tr><td><code id="cbind_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical, passed to <code><a href="#topic+as.data.frame">as.data.frame</a></code>;
only has an effect when the <code>...</code> arguments contain a
(non-<code>data.frame</code>) <code><a href="#topic+character">character</a></code>.</p>
</td></tr>
<tr><td><code id="cbind_+3A_factor.exclude">factor.exclude</code></td>
<td>
<p>if the data frames contain factors, the default
<code>TRUE</code> ensures that <code>NA</code> levels of factors are kept, see
<a href="https://bugs.R-project.org/show_bug.cgi?id=17562">PR#17562</a> and the &lsquo;Data frame methods&rsquo;.  In <span class="rlang"><b>R</b></span> versions up
to 3.6.x, <code>factor.exclude = NA</code> has been implicitly hardcoded
(<span class="rlang"><b>R</b></span> &lt;= 3.6.0) or the default (<span class="rlang"><b>R</b></span> = 3.6.x, x &gt;= 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>cbind</code> and <code>rbind</code> are S3 generic, with
methods for data frames.  The data frame method will be used if at
least one argument is a data frame and the rest are vectors or
matrices.  There can be other methods; in particular, there is one for
time series objects.  See the section on &lsquo;Dispatch&rsquo; for how
the method to be used is selected.  If some of the arguments are of an
S4 class, i.e., <code><a href="#topic+isS4">isS4</a>(.)</code> is true, S4 methods are sought
also, and the hidden <code>cbind</code> / <code>rbind</code> functions
from package <span class="pkg">methods</span> maybe called, which in turn build on
<code><a href="methods.html#topic+cbind2">cbind2</a></code> or <code><a href="methods.html#topic+rbind2">rbind2</a></code>, respectively.  In that
case, <code>deparse.level</code> is obeyed, similarly to the default method.
</p>
<p>In the default method, all the vectors/matrices must be atomic (see
<code><a href="#topic+vector">vector</a></code>) or lists.  Expressions are not allowed.
Language objects (such as formulae and calls) and pairlists will be
coerced to lists: other objects (such as names and external pointers)
will be included as elements in a list result.  Any classes the inputs
might have are discarded (in particular, factors are replaced by their
internal codes).
</p>
<p>If there are several matrix arguments, they must all have the same
number of columns (or rows) and this will be the number of columns (or
rows) of the result.  If all the arguments are vectors, the number of
columns (rows) in the result is equal to the length of the longest
vector.  Values in shorter arguments are recycled to achieve this
length (with a <code><a href="#topic+warning">warning</a></code> if they are recycled only
<em>fractionally</em>).
</p>
<p>When the arguments consist of a mix of matrices and vectors the number
of columns (rows) of the result is determined by the number of columns
(rows) of the matrix arguments.  Any vectors have their values
recycled or subsetted to achieve this length.
</p>
<p>For <code>cbind</code> (<code>rbind</code>), vectors of zero length (including
<code>NULL</code>) are ignored unless the result would have zero rows
(columns), for S compatibility.
(Zero-extent matrices do not occur in S3 and are not ignored in <span class="rlang"><b>R</b></span>.)
</p>
<p>Matrices are restricted to less than <code class="reqn">2^{31}</code> rows and
columns even on 64-bit systems.  So input vectors have the same length
restriction: as from <span class="rlang"><b>R</b></span> 3.2.0 input matrices with more elements (but
meeting the row and column restrictions) are allowed.
</p>


<h3>Value</h3>

<p>For the default method, a matrix combining the <code>...</code> arguments
column-wise or row-wise.  (Exception: if there are no inputs or all
the inputs are <code>NULL</code>, the value is <code>NULL</code>.)
</p>
<p>The type of a matrix result determined from the highest type of any of
the inputs in the hierarchy raw &lt; logical &lt; integer &lt; double &lt; complex &lt;
character &lt; list .
</p>
<p>For <code>cbind</code> (<code>rbind</code>) the column (row) names are taken from
the <code>colnames</code> (<code>rownames</code>) of the arguments if these are
matrix-like.  Otherwise from the names of the arguments or where those
are not supplied and <code>deparse.level &gt; 0</code>, by deparsing the
expressions given, for <code>deparse.level = 1</code> only if that gives a
sensible name (a &lsquo;symbol&rsquo;, see <code><a href="#topic+is.symbol">is.symbol</a></code>).
</p>
<p>For <code>cbind</code> row names are taken from the first argument with
appropriate names: rownames for a matrix, or names for a vector of
length the number of rows of the result.
</p>
<p>For <code>rbind</code> column names are taken from the first argument with
appropriate names: colnames for a matrix, or names for a vector of
length the number of columns of the result.
</p>


<h3>Data frame methods</h3>

<p>The <code>cbind</code> data frame method is just a wrapper for
<code><a href="#topic+data.frame">data.frame</a>(..., check.names = FALSE)</code>.  This means that
it will split matrix columns in data frame arguments, and convert
character columns to factors unless <code>stringsAsFactors = FALSE</code> is
specified.
</p>
<p>The <code>rbind</code> data frame method first drops all zero-column and
zero-row arguments.  (If that leaves none, it returns the first
argument with columns otherwise a zero-column zero-row data frame.)
It then takes the classes of the columns from the first data frame,
and matches columns by name (rather than by position).  Factors have
their levels expanded as necessary (in the order of the levels of the
level sets of the factors encountered) and the result is an ordered
factor if and only if all the components were ordered factors.
Old-style categories (integer vectors with levels) are promoted to
factors.
</p>
<p>Note that for result column <code>j</code>, <code><a href="#topic+factor">factor</a>(., exclude = X(j))</code>
is applied, where </p>
<pre>  X(j) := if(isTRUE(factor.exclude)) {
             if(!NA.lev[j]) NA # else NULL
          } else factor.exclude</pre>
<p>where <code>NA.lev[j]</code> is true iff any contributing data frame has had a
<code><a href="#topic+factor">factor</a></code> in column <code>j</code> with an explicit <code>NA</code> level.
</p>


<h3>Dispatch</h3>

<p>The method dispatching is <em>not</em> done via
<code><a href="#topic+UseMethod">UseMethod</a>()</code>, but by C-internal dispatching.
Therefore there is no need for, e.g., <code>rbind.default</code>.
</p>
<p>The dispatch algorithm is described in the source file
(&lsquo;<span class="file">.../src/main/bind.c</span>&rsquo;) as
</p>

<ol>
<li><p> For each argument we get the list of possible class
memberships from the class attribute.
</p>
</li>
<li><p> We inspect each class in turn to see if there is an
applicable method.
</p>
</li>
<li><p> If we find a method, we use it.  Otherwise, if there was an S4
object among the arguments, we try S4 dispatch; otherwise, we use
the default code.
</p>
</li></ol>

<p>If you want to combine other objects with data frames, it may be
necessary to coerce them to data frames first.  (Note that this
algorithm can result in calling the data frame method if all the
arguments are either data frames or vectors, and this will result in
the coercion of character vectors to factors.)
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+c">c</a></code> to combine vectors (and lists) as vectors,
<code><a href="#topic+data.frame">data.frame</a></code> to combine vectors and matrices as a data
frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m &lt;- cbind(1, 1:7) # the '1' (= shorter vector) is recycled
m
m &lt;- cbind(m, 8:14)[, c(1, 3, 2)] # insert a column
m
cbind(1:7, diag(3)) # vector is subset -&gt; warning

cbind(0, rbind(1, 1:3))
cbind(I = 0, X = rbind(a = 1, b = 1:3))  # use some names
xx &lt;- data.frame(I = rep(0,2))
cbind(xx, X = rbind(a = 1, b = 1:3))   # named differently

cbind(0, matrix(1, nrow = 0, ncol = 4)) #&gt; Warning (making sense)
dim(cbind(0, matrix(1, nrow = 2, ncol = 0))) #-&gt; 2 x 1

## deparse.level
dd &lt;- 10
rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 0) # middle 2 rownames
rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 1) # 3 rownames (default)
rbind(1:4, c = 2, "a++" = 10, dd, deparse.level = 2) # 4 rownames

## cheap row names:
b0 &lt;- gl(3,4, labels=letters[1:3])
bf &lt;- setNames(b0, paste0("o", seq_along(b0)))
df  &lt;- data.frame(a = 1, B = b0, f = gl(4,3))
df. &lt;- data.frame(a = 1, B = bf, f = gl(4,3))
new &lt;- data.frame(a = 8, B ="B", f = "1")
(df1  &lt;- rbind(df , new))
(df.1 &lt;- rbind(df., new))
stopifnot(identical(df1, rbind(df,  new, make.row.names=FALSE)),
          identical(df1, rbind(df., new, make.row.names=FALSE)))

</code></pre>

<hr>
<h2 id='char.expand'>Expand a String with Respect to a Target Table</h2><span id='topic+char.expand'></span>

<h3>Description</h3>

<p>Seeks a unique match of its first argument among the
elements of its second.  If successful, it returns this element;
otherwise, it performs an action specified by the third argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>char.expand(input, target, nomatch = stop("no match"))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="char.expand_+3A_input">input</code></td>
<td>
<p>a character string to be expanded.</p>
</td></tr>
<tr><td><code id="char.expand_+3A_target">target</code></td>
<td>
<p>a character vector with the values to be matched
against.</p>
</td></tr>
<tr><td><code id="char.expand_+3A_nomatch">nomatch</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> expression to be evaluated in case expansion was
not possible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is particularly useful when abbreviations are allowed in
function arguments, and need to be uniquely expanded with respect to a
target table of possible values.
</p>


<h3>Value</h3>

<p>A length-one character vector, one of the elements of <code>target</code>
(unless <code>nomatch</code> is changed to be a non-error, when it can be a
zero-length character string).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+charmatch">charmatch</a></code> and <code><a href="#topic+pmatch">pmatch</a></code> for performing
partial string matching.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>locPars &lt;- c("mean", "median", "mode")
char.expand("me", locPars, warning("Could not expand!"))
char.expand("mo", locPars)
</code></pre>

<hr>
<h2 id='character'>Character Vectors</h2><span id='topic+character'></span><span id='topic+as.character'></span><span id='topic+as.character.default'></span><span id='topic+as.character.factor'></span><span id='topic+is.character'></span>

<h3>Description</h3>

<p>Create or test for objects of type <code>"character"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>character(length = 0)
as.character(x, ...)
is.character(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="character_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.
Double values will be coerced to integer:
supplying an argument of length other than one is an error.</p>
</td></tr>
<tr><td><code id="character_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="character_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.character</code> and <code>is.character</code> are generic: you can
write methods to handle specific classes of objects,
see <a href="#topic+InternalMethods">InternalMethods</a>.  Further, for <code>as.character</code> the
default method calls <code><a href="#topic+as.vector">as.vector</a></code>, so, only
<code>if(is.object(x))</code> is true, dispatch is first on
methods for <code>as.character</code> and then for methods for <code>as.vector</code>.
</p>
<p><code>as.character</code> represents real and complex numbers to 15 significant
digits (technically the compiler's setting of the ISO C constant
<code>DBL_DIG</code>, which will be 15 on machines supporting <abbr>IEC</abbr> 60559
arithmetic according to the C99 standard).  This ensures that all the
digits in the result will be reliable (and not the result of
representation error), but does mean that conversion to character and
back to numeric may change the number.  If you want to convert numbers
to character with the maximum possible precision, use
<code><a href="#topic+format">format</a></code>.
</p>


<h3>Value</h3>

<p><code>character</code> creates a character vector of the specified length.
The elements of the vector are all equal to <code>""</code>.
</p>
<p><code>as.character</code> attempts to coerce its argument to character type;
like <code><a href="#topic+as.vector">as.vector</a></code> it strips attributes including names.
For lists and pairlists (including <a href="#topic+language+20objects">language objects</a> such as
calls) it deparses the elements individually, except that it extracts
the first element of length-one character vectors, see the <code>Abc</code>
example.
</p>
<p><code>is.character</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is of character type or not.
</p>


<h3>Note</h3>

<p><code>as.character</code> breaks lines in language objects at 500
characters, and inserts newlines.  Prior to 2.15.0 lines were
truncated.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+options">options</a></code>: options <code>scipen</code> and <code>OutDec</code> affect the
conversion of numbers.
</p>
<p><code><a href="#topic+paste">paste</a></code>, <code><a href="#topic+substr">substr</a></code> and <code><a href="#topic+strsplit">strsplit</a></code>
for character concatenation and splitting,
<code><a href="#topic+chartr">chartr</a></code> for character translation and case folding (e.g.,
upper to lower case) and <code><a href="#topic+sub">sub</a></code>, <code><a href="#topic+grep">grep</a></code> etc for
string matching and substitutions.  Note that
<code>help.search(keyword = "character")</code> gives even more links.
</p>
<p><code><a href="#topic+deparse">deparse</a></code>, which is normally preferable to
<code>as.character</code> for <a href="#topic+language+20objects">language objects</a>.
</p>
<p><code><a href="#topic+Quotes">Quotes</a></code> on how to specify <code>character</code> / string
constants, including <em>raw</em> ones.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>form &lt;- y ~ a + b + c
as.character(form)  ## length 3
deparse(form)       ## like the input

a0 &lt;- 11/999          # has a repeating decimal representation
(a1 &lt;- as.character(a0))
format(a0, digits = 16) # shows 1 to 2 more digit(s)
a2 &lt;- as.numeric(a1)
a2 - a0               # normally around -1e-17
as.character(a2)      # possibly different from a1
print(c(a0, a2), digits = 16)

as.character(list(A = "Abc", xy = c("x", "y"))) # "Abc"  "c(\"x\", \"y\")"
## i.e., "Abc" directly instead of deparsing to "\"Abc\""
</code></pre>

<hr>
<h2 id='charmatch'>Partial String Matching</h2><span id='topic+charmatch'></span>

<h3>Description</h3>

<p><code>charmatch</code> seeks matches for the elements of its first argument
among those of its second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>charmatch(x, table, nomatch = NA_integer_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="charmatch_+3A_x">x</code></td>
<td>
<p>the values to be matched: converted to a character vector by
<code><a href="#topic+as.character">as.character</a></code>.  <a href="#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="charmatch_+3A_table">table</code></td>
<td>
<p>the values to be matched against: converted to a character
vector.  <a href="#topic+Long+20vectors">Long vectors</a> are not supported.</p>
</td></tr>
<tr><td><code id="charmatch_+3A_nomatch">nomatch</code></td>
<td>
<p>the (integer) value to be returned at non-matching
positions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Exact matches are preferred to partial matches (those where the value
to be matched has an exact match to the initial part of the target,
but the target is longer).
</p>
<p>If there is a single exact match or no exact match and a unique
partial match then the index of the matching value is returned; if
multiple exact or multiple partial matches are found then <code>0</code> is
returned and if no match is found then <code>nomatch</code> is returned.
</p>
<p><code>NA</code> values are treated as the string constant <code>"NA"</code>.
</p>


<h3>Value</h3>

<p>An integer vector of the same length as <code>x</code>, giving the
indices of the elements in <code>table</code> which matched, or <code>nomatch</code>.
</p>


<h3>Author(s)</h3>

<p>This function is based on a C function written by Terry Therneau.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pmatch">pmatch</a></code>, <code><a href="#topic+match">match</a></code>.
</p>
<p><code><a href="#topic+startsWith">startsWith</a></code> for another matching of initial parts of strings;
<code><a href="#topic+grep">grep</a></code> or <code><a href="#topic+regexpr">regexpr</a></code> for more general (regexp)
matching of strings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>charmatch("", "")                             # returns 1
charmatch("m",   c("mean", "median", "mode")) # returns 0
charmatch("med", c("mean", "median", "mode")) # returns 2
</code></pre>

<hr>
<h2 id='chartr'>Character Translation and Case Folding</h2><span id='topic+chartr'></span><span id='topic+tolower'></span><span id='topic+toupper'></span><span id='topic+casefold'></span>

<h3>Description</h3>

<p>Translate characters in character vectors, in particular from upper to
lower case or vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chartr(old, new, x)
tolower(x)
toupper(x)
casefold(x, upper = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chartr_+3A_x">x</code></td>
<td>
<p>a character vector, or an object that can be coerced to
character by <code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="chartr_+3A_old">old</code></td>
<td>
<p>a character string specifying the characters to be
translated.  If a character vector of length 2 or more is supplied,
the first element is used with a warning.</p>
</td></tr>
<tr><td><code id="chartr_+3A_new">new</code></td>
<td>
<p>a character string specifying the translations. If a
character vector of length 2 or more is supplied, the first element
is used with a warning.</p>
</td></tr>
<tr><td><code id="chartr_+3A_upper">upper</code></td>
<td>
<p>logical: translate to upper or lower case?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>chartr</code> translates each character in <code>x</code> that is specified
in <code>old</code> to the corresponding character specified in <code>new</code>.
Ranges are supported in the specifications, but character classes and
repeated characters are not.  If <code>old</code> contains more characters
than new, an error is signaled; if it contains fewer characters, the
extra characters at the end of <code>new</code> are ignored.
</p>
<p><code>tolower</code> and <code>toupper</code> convert upper-case characters in a
character vector to lower-case, or vice versa.  Non-alphabetic
characters are left unchanged.  More than one character can be mapped
to a single upper-case character.
</p>
<p><code>casefold</code> is a wrapper for <code>tolower</code> and <code>toupper</code>
originally written for compatibility with S-PLUS.
</p>


<h3>Value</h3>

<p>A character vector of the same length and with the same attributes as
<code>x</code> (after possible coercion).
</p>
<p>Elements of the result will be have the encoding declared as that of
the current locale (see <code><a href="#topic+Encoding">Encoding</a></code>) if the corresponding
input had a declared encoding and the current locale is either Latin-1
or UTF-8.  The result will be in the current locale's encoding unless
the corresponding input was in UTF-8 or Latin-1, when it will be in UTF-8.
</p>


<h3>Note</h3>

<p>These functions are platform-dependent, usually using OS services.
The latter can be quite deficient, for example only covering ASCII
characters in 8-bit locales.  The definition of &lsquo;alphabetic&rsquo; is
platform-dependent and liable to change over time as most platforms
are based on the frequently-updated Unicode tables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sub">sub</a></code> and <code><a href="#topic+gsub">gsub</a></code> for other
substitutions in strings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- "MiXeD cAsE 123"
chartr("iXs", "why", x)
chartr("a-cX", "D-Fw", x)
tolower(x)
toupper(x)

## "Mixed Case" Capitalizing - toupper( every first letter of a word ) :

.simpleCap &lt;- function(x) {
    s &lt;- strsplit(x, " ")[[1]]
    paste(toupper(substring(s, 1, 1)), substring(s, 2),
          sep = "", collapse = " ")
}
.simpleCap("the quick red fox jumps over the lazy brown dog")
## -&gt;  [1] "The Quick Red Fox Jumps Over The Lazy Brown Dog"

## and the better, more sophisticated version:
capwords &lt;- function(s, strict = FALSE) {
    cap &lt;- function(s) paste(toupper(substring(s, 1, 1)),
                  {s &lt;- substring(s, 2); if(strict) tolower(s) else s},
                             sep = "", collapse = " " )
    sapply(strsplit(s, split = " "), cap, USE.NAMES = !is.null(names(s)))
}
capwords(c("using AIC for model selection"))
## -&gt;  [1] "Using AIC For Model Selection"
capwords(c("using AIC", "for MODEL selection"), strict = TRUE)
## -&gt;  [1] "Using Aic"  "For Model Selection"
##                ^^^        ^^^^^
##               'bad'       'good'

## -- Very simple insecure crypto --
rot &lt;- function(ch, k = 13) {
   p0 &lt;- function(...) paste(c(...), collapse = "")
   A &lt;- c(letters, LETTERS, " '")
   I &lt;- seq_len(k); chartr(p0(A), p0(c(A[-I], A[I])), ch)
}

pw &lt;- "my secret pass phrase"
(crypw &lt;- rot(pw, 13)) #-&gt; you can send this off

## now ``decrypt'' :
rot(crypw, 54 - 13) # -&gt; the original:
stopifnot(identical(pw, rot(crypw, 54 - 13)))
</code></pre>

<hr>
<h2 id='chkDots'>Warn About Extraneous Arguments in the &quot;...&quot; of Its Caller</h2><span id='topic+chkDots'></span>

<h3>Description</h3>

<p>Warn about extraneous arguments in the <code>...</code> of its caller.  A
utility to be used e.g., in S3 methods which need a formal <code>...</code>
argument but do not make any use of it.  This helps catching user
errors in calling the function in question (which is the caller of
<code>chkDots()</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chkDots(..., which.call = -1, allowed = character(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chkDots_+3A_...">...</code></td>
<td>
<p>&ldquo;the dots&rdquo;, as passed from the caller.</p>
</td></tr>
<tr><td><code id="chkDots_+3A_which.call">which.call</code></td>
<td>
<p>passed to <code><a href="#topic+sys.call">sys.call</a>()</code>.  A caller may
use -2 if the message should mention <em>its</em> caller.</p>
</td></tr>
<tr><td><code id="chkDots_+3A_allowed">allowed</code></td>
<td>
<p>not yet implemented: character vector of <em>named</em>
elements in <code>...</code> which are &ldquo;allowed&rdquo; and hence not
warned about.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Martin Maechler, first version outside base, June 2012.</p>


<h3>See Also</h3>

<p><code><a href="#topic+warning">warning</a></code>,  <code><a href="#topic+...">...</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seq.default ## &lt;- you will see  ' chkDots(...) '

seq(1,5, foo = "bar") # gives warning via chkDots()

## warning with more than one ...-entry:
density.f &lt;- function(x, ...) NextMethod("density")
x &lt;- density(structure(rnorm(10), class="f"), bar=TRUE, baz=TRUE)
</code></pre>

<hr>
<h2 id='chol'>The Cholesky Decomposition</h2><span id='topic+chol'></span><span id='topic+chol.default'></span>

<h3>Description</h3>

<p>Compute the Cholesky factorization of a real symmetric
positive-definite square matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chol(x, ...)

## Default S3 method:
chol(x, pivot = FALSE,  LINPACK = FALSE, tol = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chol_+3A_x">x</code></td>
<td>
<p>an object for which a method exists.  The default method
applies to numeric (or logical) symmetric, positive-definite matrices.</p>
</td></tr>
<tr><td><code id="chol_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="chol_+3A_pivot">pivot</code></td>
<td>
<p>logical: should pivoting be used?</p>
</td></tr>
<tr><td><code id="chol_+3A_linpack">LINPACK</code></td>
<td>
<p>logical.  Defunct and gives an error.</p>
</td></tr>
<tr><td><code id="chol_+3A_tol">tol</code></td>
<td>
<p>a numeric tolerance for use with <code>pivot = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>chol</code> is generic: the description here applies to the default
method.
</p>
<p>Note that only the upper triangular part of <code>x</code> is used, so
that <code class="reqn">R'R = x</code> when <code>x</code> is symmetric.
</p>
<p>If <code>pivot = FALSE</code> and <code>x</code> is not non-negative definite an
error occurs.  If <code>x</code> is positive semi-definite (i.e., some zero
eigenvalues) an error will also occur as a numerical tolerance is used.
</p>
<p>If <code>pivot = TRUE</code>, then the Cholesky decomposition of a positive
semi-definite <code>x</code> can be computed.  The rank of <code>x</code> is
returned as <code>attr(Q, "rank")</code>, subject to numerical errors.
The pivot is returned as <code>attr(Q, "pivot")</code>.  It is no longer
the case that <code>t(Q) %*% Q</code> equals <code>x</code>.  However, setting
<code>pivot &lt;- attr(Q, "pivot")</code> and <code>oo &lt;- order(pivot)</code>, it
is true that <code>t(Q[, oo]) %*% Q[, oo]</code> equals <code>x</code>,
or, alternatively, <code>t(Q) %*% Q</code> equals <code>x[pivot,
    pivot]</code>.  See the examples.
</p>
<p>The value of <code>tol</code> is passed to LAPACK, with negative values
selecting the default tolerance of (usually) <code>nrow(x) *
  .Machine$double.neg.eps * max(diag(x))</code>.  The algorithm terminates once
the pivot is less than <code>tol</code>.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>


<h3>Value</h3>

<p>The upper triangular factor of the Cholesky decomposition, i.e., the
matrix <code class="reqn">R</code> such that <code class="reqn">R'R = x</code> (see example).
</p>
<p>If pivoting is used, then two additional attributes
<code>"pivot"</code> and <code>"rank"</code> are also returned.
</p>


<h3>Warning</h3>

<p>The code does not check for symmetry.
</p>
<p>If <code>pivot = TRUE</code> and <code>x</code> is not non-negative definite then
there will be a warning message but a meaningless result will occur.
So only use <code>pivot = TRUE</code> when <code>x</code> is non-negative definite
by construction.
</p>


<h3>Source</h3>

<p>This is an interface to the LAPACK routines <code>DPOTRF</code> and
<code>DPSTRF</code>,
</p>
<p>LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and its guide is listed
in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition. SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chol2inv">chol2inv</a></code> for its <em>inverse</em> (without pivoting),
<code><a href="#topic+backsolve">backsolve</a></code> for solving linear systems with upper
triangular left sides.
</p>
<p><code><a href="#topic+qr">qr</a></code>, <code><a href="#topic+svd">svd</a></code> for related matrix factorizations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>( m &lt;- matrix(c(5,1,1,3),2,2) )
( cm &lt;- chol(m) )
t(cm) %*% cm  #-- = 'm'
crossprod(cm)  #-- = 'm'

# now for something positive semi-definite
x &lt;- matrix(c(1:5, (1:5)^2), 5, 2)
x &lt;- cbind(x, x[, 1] + 3*x[, 2])
colnames(x) &lt;- letters[20:22]
m &lt;- crossprod(x)
qr(m)$rank # is 2, as it should be

# chol() may fail, depending on numerical rounding:
# chol() unlike qr() does not use a tolerance.
try(chol(m))

(Q &lt;- chol(m, pivot = TRUE))
## we can use this by
pivot &lt;- attr(Q, "pivot")
crossprod(Q[, order(pivot)]) # recover m

## now for a non-positive-definite matrix
( m &lt;- matrix(c(5,-5,-5,3), 2, 2) )
try(chol(m))  # fails
(Q &lt;- chol(m, pivot = TRUE)) # warning
crossprod(Q)  # not equal to m
</code></pre>

<hr>
<h2 id='chol2inv'>Inverse from Cholesky (or QR) Decomposition</h2><span id='topic+chol2inv'></span>

<h3>Description</h3>

<p>Invert a symmetric, positive definite square matrix from its Cholesky
decomposition.  Equivalently, compute <code class="reqn">(X'X)^{-1}</code>
from the (<code class="reqn">R</code> part) of the QR decomposition of <code class="reqn">X</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chol2inv(x, size = NCOL(x), LINPACK = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chol2inv_+3A_x">x</code></td>
<td>
<p>a matrix.  The first <code>size</code> columns of the upper triangle
contain the Cholesky decomposition of the matrix to be inverted.</p>
</td></tr>
<tr><td><code id="chol2inv_+3A_size">size</code></td>
<td>
<p>the number of columns of <code>x</code> containing the
Cholesky decomposition.</p>
</td></tr>
<tr><td><code id="chol2inv_+3A_linpack">LINPACK</code></td>
<td>
<p>logical.  Defunct and gives an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The inverse of the matrix whose Cholesky decomposition was given.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>


<h3>Source</h3>

<p>This is an interface to the LAPACK routine <code>DPOTRI</code>.
LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and its guide is listed
in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition.
SIAM.
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Dongarra, J. J., Bunch, J. R., Moler, C. B. and Stewart, G. W. (1978)
<em>LINPACK Users Guide</em>.
Philadelphia: SIAM Publications.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chol">chol</a></code>, <code><a href="#topic+solve">solve</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cma &lt;- chol(ma  &lt;- cbind(1, 1:3, c(1,3,7)))
ma %*% chol2inv(cma)
</code></pre>

<hr>
<h2 id='chooseOpsMethod'>Choose the Appropriate Method for Ops</h2><span id='topic+chooseOpsMethod'></span><span id='topic+chooseOpsMethod.default'></span>

<h3>Description</h3>

<p><code>chooseOpsMethod</code> is a function called by the <code>Ops</code> Group Generic when two
suitable methods are found for a given call. It determines which method to
use for the operation based on the objects being dispatched.
</p>
<p>The function is first called with <code>reverse = FALSE</code>, where
<code>x</code> corresponds to the first argument and <code>y</code> to the second
argument of the group generic call. If <code>chooseOpsMethod()</code> returns
<code>FALSE</code> for <code>x</code>, then <code>chooseOpsMethod</code> is called again,
with <code>x</code> and <code>y</code> swapped, <code>mx</code> and <code>my</code> swapped,
and <code>reverse = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chooseOpsMethod(x, y, mx, my, cl, reverse)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chooseOpsMethod_+3A_x">x</code>, <code id="chooseOpsMethod_+3A_y">y</code></td>
<td>
<p>the objects being dispatched on by the group generic.</p>
</td></tr>
<tr><td><code id="chooseOpsMethod_+3A_mx">mx</code>, <code id="chooseOpsMethod_+3A_my">my</code></td>
<td>
<p>the methods found for objects <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="chooseOpsMethod_+3A_cl">cl</code></td>
<td>
<p>the call to the group generic.</p>
</td></tr>
<tr><td><code id="chooseOpsMethod_+3A_reverse">reverse</code></td>
<td>
<p>logical value indicating whether <code>x</code> and <code>y</code> are
reversed from the way they were supplied to the generic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function must return either <code>TRUE</code> or <code>FALSE</code>. A value of
<code>TRUE</code> indicates that method <code>mx</code> should be used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+S3groupGeneric">Ops</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create two objects with custom Ops methods
foo_obj &lt;- structure(1, class = "foo")
bar_obj &lt;- structure(1, class = "bar")

`+.foo` &lt;- function(e1, e2) "foo"
Ops.bar &lt;- function(e1, e2) "bar"

invisible(foo_obj + bar_obj) # Warning: Incompatible methods

chooseOpsMethod.bar &lt;- function(x, y, mx, my, cl, reverse) TRUE

stopifnot(exprs = {
  identical(foo_obj + bar_obj, "bar")
  identical(bar_obj + foo_obj, "bar")
})

# cleanup
rm(foo_obj, bar_obj, `+.foo`, Ops.bar, chooseOpsMethod.bar)
</code></pre>

<hr>
<h2 id='class'>Object Classes</h2><span id='topic+class'></span><span id='topic+.class2'></span><span id='topic+class+3C-'></span><span id='topic+oldClass'></span><span id='topic+oldClass+3C-'></span><span id='topic+unclass'></span><span id='topic+inherits'></span><span id='topic+isa'></span><span id='topic+nameOfClass'></span><span id='topic+nameOfClass.default'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> possesses a simple generic function mechanism which can be used for
an object-oriented style of programming.  Method dispatch takes place
based on the class of the first argument to the generic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>class(x)
class(x) &lt;- value
unclass(x)
inherits(x, what, which = FALSE)
nameOfClass(x)
isa(x, what)

oldClass(x)
oldClass(x) &lt;- value
.class2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="class_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="class_+3A_what">what</code>, <code id="class_+3A_value">value</code></td>
<td>
<p>a character vector naming classes. <code>value</code>
can also be <code>NULL</code>. <code>what</code> can also be a
non-character R object with a <code>nameOfClass()</code> method.</p>
</td></tr>
<tr><td><code id="class_+3A_which">which</code></td>
<td>
<p>logical affecting return value: see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, we describe the so called &ldquo;S3&rdquo; classes (and methods). For
&ldquo;S4&rdquo; classes (and methods), see &lsquo;Formal classes&rsquo; below.
</p>

<p>Many <span class="rlang"><b>R</b></span> objects have a <code>class</code> attribute, a character vector
giving the names of the classes from which the object <em>inherits</em>.
(Functions <code>oldClass</code> and <code>oldClass&lt;-</code> get and set the
attribute, which can also be done directly.)

</p>

<p>If the object does not have a class attribute, it has an implicit
class, notably <code>"matrix"</code>, <code>"array"</code>, <code>"function"</code> or
<code>"numeric"</code> or the result of
<code><a href="#topic+typeof">typeof</a>(x)</code> (which is similar to <code><a href="#topic+mode">mode</a>(x)</code>),
but for type <code>"language"</code> and <code><a href="#topic+mode">mode</a></code> <code>"call"</code>,
where the following extra classes exist for the corresponding function
<code><a href="#topic+call">call</a></code>s:
<code>if</code>, <code>for</code>, <code>while</code>, <code>(</code>, <code>{</code>, <code>&lt;-</code>, <code>=</code>.
</p>
<p>Note that for objects <code>x</code> of an implicit (or an S4) class, when a
(S3) generic function <code>foo(x)</code> is called, method dispatch may use
more classes than are returned by <code>class(x)</code>, e.g., for a numeric
matrix, the <code>foo.numeric()</code> method may apply.  The exact full
<code><a href="#topic+character">character</a></code> vector of the classes which
<code><a href="#topic+UseMethod">UseMethod</a>()</code> uses, is available as <code>.class2(x)</code> since
<span class="rlang"><b>R</b></span> version 4.0.0.  (This also applies to S4 objects when S3 dispatch is
considered, see below.)
</p>
<p>Beware that using <code>.class2()</code> for other reasons than didactical,
diagnostical or for debugging may rather be a misuse than smart.
</p>
<p><code><a href="#topic+NULL">NULL</a></code> objects (of implicit class <code>"NULL"</code>) cannot have
attributes (hence no <code>class</code> attribute) and attempting to assign a
class is an error.
</p>
<p>When a generic function <code>fun</code> is applied to an object with class
attribute <code>c("first", "second")</code>, the system searches for a
function called <code>fun.first</code> and, if it finds it, applies it to
the object.  If no such function is found, a function called
<code>fun.second</code> is tried.  If no class name produces a suitable
function, the function <code>fun.default</code> is used (if it exists).  If
there is no class attribute, the implicit class is tried, then the
default method.
</p>
<p>The function <code>class</code> prints the vector of names of classes an
object inherits from.  Correspondingly, <code>class&lt;-</code> sets the
classes an object inherits from.  Assigning an empty character vector or
<code>NULL</code> removes the class attribute, as for <code>oldClass&lt;-</code> or
direct attribute setting.  Whereas it is clearer to explicitly assign
<code>NULL</code> to remove the class, using an empty vector is more natural in
e.g., <code>class(x) &lt;- <a href="#topic+setdiff">setdiff</a>(class(x), "ts")</code>.
</p>
<p><code>unclass</code> returns (a copy of) its argument with its class
attribute removed.  (It is not allowed for objects which cannot be
copied, namely environments and external pointers.)
</p>
<p><code>inherits</code> indicates whether its first argument inherits from any
of the classes specified in the <code>what</code> argument.  If <code>which</code>
is <code>TRUE</code> then an integer vector of the same length as
<code>what</code> is returned.  Each element indicates the position in the
<code>class(x)</code> matched by the element of <code>what</code>; zero indicates
no match. If <code>which</code> is <code>FALSE</code> then <code>TRUE</code> is
returned by <code>inherits</code> if any of the names in <code>what</code> match
with any <code>class</code>.
</p>
<p><code>nameOfClass</code> is an S3 generic. It is called by <code>inherits</code> to 
get the class name for <code>what</code>, allowing for <code>what</code> to be 
values other than a character vector. <code>nameOfClass</code> methods are 
expected to return a character vector of length 1.
</p>
<p><code>isa</code> tests whether <code>x</code> is an object of class(es) as given
in <code>what</code> by using <code><a href="methods.html#topic+is">is</a></code> if <code>x</code> is an S4
object, and otherwise giving <code>TRUE</code> iff <em>all</em> elements of
<code>class(x)</code> are contained in <code>what</code>.
</p>
<p>All but <code>inherits</code> and <code>isa</code> are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Formal classes</h3>

<p>An additional mechanism of <em>formal</em> classes, nicknamed
&ldquo;S4&rdquo;, is available in package <span class="pkg">methods</span> which is attached
by default.  For objects which have a formal class, its name is
returned by <code>class</code> as a character vector of length one and
method dispatch can happen on <em>several</em> arguments, instead of
only the first.  However, S3 method selection attempts to treat objects
from an S4 class as if they had the appropriate S3 class attribute, as
does <code>inherits</code>.  Therefore, S3 methods can be defined for S4
classes.  See the &lsquo;<a href="methods.html#topic+Introduction">Introduction</a>&rsquo; and &lsquo;<a href="methods.html#topic+Methods_for_S3">Methods_for_S3</a>&rsquo;
help pages for basic information on S4 methods and for the relation
between these and S3 methods.
</p>
<p>The replacement version of the function sets the class to the value
provided.  For classes that have a formal definition, directly
replacing the class this way is strongly deprecated.  The expression
<code><a href="methods.html#topic+as">as</a>(object, value)</code> is the way to coerce an object to a
particular class.
</p>
<p>The analogue of <code>inherits</code> for formal classes is
<code><a href="methods.html#topic+is">is</a></code>.  The two functions behave consistently
with one exception:  S4 classes can have conditional
inheritance, with an explicit test.  In this case, <code>is</code> will
test the condition, but <code>inherits</code> ignores all conditional
superclasses.
</p>


<h3>Note</h3>

<p><code><a href="#topic+UseMethod">UseMethod</a></code> dispatches on the class as returned by
<code>class</code> (with some interpolated classes: see the link) rather
than <code>oldClass</code>.  <em>However</em>, <a href="#topic+group+20generic">group generic</a>s dispatch
on the <code>oldClass</code> for efficiency, and <a href="#topic+internal+20generic">internal generic</a>s
only dispatch on objects for which <code><a href="#topic+is.object">is.object</a></code> is true.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UseMethod">UseMethod</a></code>, <code><a href="#topic+NextMethod">NextMethod</a></code>,
&lsquo;<a href="#topic+group+20generic">group generic</a>&rsquo;, &lsquo;<a href="#topic+internal+20generic">internal generic</a>&rsquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 10
class(x) # "numeric"
oldClass(x) # NULL
inherits(x, "a") #FALSE
class(x) &lt;- c("a", "b")
inherits(x,"a") #TRUE
inherits(x, "a", TRUE) # 1
inherits(x, c("a", "b", "c"), TRUE) # 1 2 0

class( quote(pi) )           # "name"
## regular calls
class( quote(sin(pi*x)) )    # "call"
## special calls
class( quote(x &lt;- 1) )       # "&lt;-"
class( quote((1 &lt; 2)) )      # "("
class( quote( if(8&lt;3) pi ) ) # "if"

.class2(pi)               # "double" "numeric"
.class2(matrix(1:6, 2,3)) # "matrix" "array" "integer" "numeric"
</code></pre>

<hr>
<h2 id='col'>Column Indexes</h2><span id='topic+col'></span><span id='topic+.col'></span>

<h3>Description</h3>

<p>Returns a matrix of integers indicating their column number in a
matrix-like object, or a factor of column labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col(x, as.factor = FALSE)
.col(dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col_+3A_x">x</code></td>
<td>
<p>a matrix-like object, that is one with a two-dimensional
<code>dim</code>.</p>
</td></tr>
<tr><td><code id="col_+3A_dim">dim</code></td>
<td>
<p>a matrix dimension, i.e., an integer valued numeric vector of
length two (with non-negative entries).</p>
</td></tr>
<tr><td><code id="col_+3A_as.factor">as.factor</code></td>
<td>
<p>a logical value indicating whether the value should
be returned as a factor of column labels (created if necessary)
rather than as numbers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer (or factor) matrix with the same dimensions as <code>x</code> and whose
<code>ij</code>-th element is equal to <code>j</code> (or the <code>j</code>-th column label).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+row">row</a></code> to get rows;
<code><a href="#topic+slice.index">slice.index</a></code> for a general way to get slice indices
in an array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># extract an off-diagonal of a matrix
ma &lt;- matrix(1:12, 3, 4)
ma[row(ma) == col(ma) + 1]

# create an identity 5-by-5 matrix more slowly than diag(n = 5):
x &lt;- matrix(0, nrow = 5, ncol = 5)
x[row(x) == col(x)] &lt;- 1

(i34 &lt;- .col(3:4))
stopifnot(identical(i34, .col(c(3,4)))) # 'dim' maybe "double"
</code></pre>

<hr>
<h2 id='Colon'>Colon Operator</h2><span id='topic++3A'></span><span id='topic+colon'></span>

<h3>Description</h3>

<p>Generate regular sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>from:to
   a:b
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Colon_+3A_from">from</code></td>
<td>
<p>starting value of sequence.</p>
</td></tr>
<tr><td><code id="Colon_+3A_to">to</code></td>
<td>
<p>(maximal) end value of the sequence.</p>
</td></tr>
<tr><td><code id="Colon_+3A_a">a</code>, <code id="Colon_+3A_b">b</code></td>
<td>
<p><code><a href="#topic+factor">factor</a></code>s of the same length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The binary operator <code>:</code> has two meanings: for factors <code>a:b</code> is
equivalent to <code><a href="#topic+interaction">interaction</a>(a, b)</code> (but the levels are
ordered and labelled differently).
</p>
<p>For other arguments <code>from:to</code> is equivalent to <code>seq(from, to)</code>,
and generates a sequence from <code>from</code> to <code>to</code> in steps of <code>1</code>
or <code>-1</code>.  Value <code>to</code> will be included if it differs from
<code>from</code> by an integer up to a numeric fuzz of about <code>1e-7</code>.
Non-numeric arguments are coerced internally (hence without
dispatching methods) to numeric&mdash;complex values will have their
imaginary parts discarded with a warning.
</p>


<h3>Value</h3>

<p>For numeric arguments, a numeric vector.  This will be of type
<code><a href="#topic+integer">integer</a></code> if <code>from</code> is integer-valued and the result
is representable in the <span class="rlang"><b>R</b></span> integer type, otherwise of type
<code>"double"</code> (aka <code><a href="#topic+mode">mode</a></code> <code>"<a href="#topic+numeric">numeric</a>"</code>).
</p>
<p>For factors, an unordered factor with levels labelled as <code>la:lb</code>
and ordered lexicographically (that is, <code>lb</code> varies fastest).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.<br />
(for numeric arguments: S does not have <code>:</code> for factors.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seq">seq</a></code> (a <em>generalization</em> of <code>from:to</code>).
</p>
<p>As an alternative to using <code>:</code> for factors, <code><a href="#topic+interaction">interaction</a></code>.
</p>
<p>For <code>:</code> used in the formal representation of an interaction, see
<code><a href="stats.html#topic+formula">formula</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>1:4
pi:6 # real
6:pi # integer

f1 &lt;- gl(2, 3); f1
f2 &lt;- gl(3, 2); f2
f1:f2 # a factor, the "cross"  f1 x f2
</code></pre>

<hr>
<h2 id='colSums'>Form Row and Column Sums and Means</h2><span id='topic+colSums'></span><span id='topic+rowSums'></span><span id='topic+colMeans'></span><span id='topic+rowMeans'></span><span id='topic+.colSums'></span><span id='topic+.rowSums'></span><span id='topic+.colMeans'></span><span id='topic+.rowMeans'></span>

<h3>Description</h3>

<p>Form row and column sums and means for numeric arrays (or data frames).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colSums (x, na.rm = FALSE, dims = 1)
rowSums (x, na.rm = FALSE, dims = 1)
colMeans(x, na.rm = FALSE, dims = 1)
rowMeans(x, na.rm = FALSE, dims = 1)

.colSums(x, m, n, na.rm = FALSE)
.rowSums(x, m, n, na.rm = FALSE)
.colMeans(x, m, n, na.rm = FALSE)
.rowMeans(x, m, n, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colSums_+3A_x">x</code></td>
<td>
<p>an array of two or more dimensions, containing numeric,
complex, integer or logical values, or a numeric data frame.  For
<code>.colSums()</code> etc, a numeric, integer or logical matrix (or
vector of length <code>m * n</code>).</p>
</td></tr>
<tr><td><code id="colSums_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values (including <code>NaN</code>)
be omitted from the calculations?</p>
</td></tr>
<tr><td><code id="colSums_+3A_dims">dims</code></td>
<td>
<p>integer: Which dimensions are regarded as &lsquo;rows&rsquo; or
&lsquo;columns&rsquo; to sum over.  For <code>row*</code>, the sum or mean is
over dimensions <code>dims+1, ...</code>; for <code>col*</code> it is over
dimensions <code>1:dims</code>.</p>
</td></tr>
<tr><td><code id="colSums_+3A_m">m</code>, <code id="colSums_+3A_n">n</code></td>
<td>
<p>the dimensions of the matrix <code>x</code> for
<code>.colSums()</code> etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are equivalent to use of <code><a href="#topic+apply">apply</a></code> with
<code>FUN = mean</code> or <code>FUN = sum</code> with appropriate margins, but
are a lot faster.  As they are written for speed, they blur over some
of the subtleties of <code>NaN</code> and <code>NA</code>.  If <code>na.rm =
    FALSE</code> and either <code>NaN</code> or <code>NA</code> appears in a sum, the
result will be one of <code>NaN</code> or <code>NA</code>, but which might be
platform-dependent.
</p>
<p>Notice that omission of missing values is done on a per-column or
per-row basis, so column means may not be over the same set of rows,
and vice versa.  To use only complete rows or columns, first select
them with <code><a href="stats.html#topic+na.omit">na.omit</a></code> or <code><a href="stats.html#topic+complete.cases">complete.cases</a></code>
(possibly on the transpose of <code>x</code>).
</p>
<p>The versions with an initial dot in the name (<code>.colSums()</code> etc)
are &lsquo;bare-bones&rsquo; versions for use in programming: they apply
only to numeric (like) matrices and do not name the result.
</p>


<h3>Value</h3>

<p>A numeric or complex array of suitable size, or a vector if the result
is one-dimensional.  For the first four functions the <code>dimnames</code>
(or <code>names</code> for a vector result) are taken from the original
array.
</p>
<p>If there are no values in a range to be summed over (after removing
missing values with <code>na.rm = TRUE</code>), that
component of the output is set to <code>0</code> (<code>*Sums</code>) or <code>NaN</code>
(<code>*Means</code>), consistent with <code><a href="#topic+sum">sum</a></code> and
<code><a href="#topic+mean">mean</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apply">apply</a></code>, <code><a href="#topic+rowsum">rowsum</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute row and column sums for a matrix:
x &lt;- cbind(x1 = 3, x2 = c(4:1, 2:5))
rowSums(x); colSums(x)
dimnames(x)[[1]] &lt;- letters[1:8]
rowSums(x); colSums(x); rowMeans(x); colMeans(x)
x[] &lt;- as.integer(x)
rowSums(x); colSums(x)
x[] &lt;- x &lt; 3
rowSums(x); colSums(x)
x &lt;- cbind(x1 = 3, x2 = c(4:1, 2:5))
x[3, ] &lt;- NA; x[4, 2] &lt;- NA
rowSums(x); colSums(x); rowMeans(x); colMeans(x)
rowSums(x, na.rm = TRUE); colSums(x, na.rm = TRUE)
rowMeans(x, na.rm = TRUE); colMeans(x, na.rm = TRUE)

## an array
dim(UCBAdmissions)
rowSums(UCBAdmissions); rowSums(UCBAdmissions, dims = 2)
colSums(UCBAdmissions); colSums(UCBAdmissions, dims = 2)

## complex case
x &lt;- cbind(x1 = 3 + 2i, x2 = c(4:1, 2:5) - 5i)
x[3, ] &lt;- NA; x[4, 2] &lt;- NA
rowSums(x); colSums(x); rowMeans(x); colMeans(x)
rowSums(x, na.rm = TRUE); colSums(x, na.rm = TRUE)
rowMeans(x, na.rm = TRUE); colMeans(x, na.rm = TRUE)
</code></pre>

<hr>
<h2 id='commandArgs'>Extract Command Line Arguments</h2><span id='topic+commandArgs'></span>

<h3>Description</h3>

<p>Provides access to a copy of the command line arguments supplied when
this <span class="rlang"><b>R</b></span> session was invoked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>commandArgs(trailingOnly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="commandArgs_+3A_trailingonly">trailingOnly</code></td>
<td>
<p>logical.  Should only arguments after
<span class="option">--args</span> be returned?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These arguments are captured before the standard <span class="rlang"><b>R</b></span> command line
processing takes place.  This means that they are the unmodified
values.  This is especially useful with the <span class="option">--args</span>
command-line flag to <span class="rlang"><b>R</b></span>, as all of the command line after that flag
is skipped.
</p>


<h3>Value</h3>

<p>A character vector containing the name of the executable and the
user-supplied command line arguments.  The first element is the name
of the executable by which <span class="rlang"><b>R</b></span> was invoked.  The exact form of this
element is platform dependent: it may be the fully qualified name, or
simply the last component (or basename) of the application, or for an
embedded <span class="rlang"><b>R</b></span> it can be anything the programmer supplied.
</p>
<p>If <code>trailingOnly = TRUE</code>, a character vector of those arguments
(if any) supplied after <span class="option">--args</span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+R.home">R.home</a>()</code>, <code><a href="#topic+Startup">Startup</a></code>
and <code><a href="utils.html#topic+BATCH">BATCH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>commandArgs()
## Spawn a copy of this application as it was invoked,
## subject to shell quoting issues
## system(paste(commandArgs(), collapse = " "))
</code></pre>

<hr>
<h2 id='comment'>Query or Set a <code>"comment"</code> Attribute</h2><span id='topic+comment'></span><span id='topic+comment+3C-'></span>

<h3>Description</h3>

<p>These functions set and query a <em>comment</em>
attribute for any <span class="rlang"><b>R</b></span> objects.  This is typically useful for
<code><a href="#topic+data.frame">data.frame</a></code>s or model fits.
</p>
<p>Contrary to other <code><a href="#topic+attributes">attributes</a></code>, the <code>comment</code> is not
printed (by <code><a href="#topic+print">print</a></code> or <code><a href="#topic+print.default">print.default</a></code>).
</p>
<p>Assigning <code>NULL</code> or a zero-length character vector removes the
comment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comment(x)
comment(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comment_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="comment_+3A_value">value</code></td>
<td>
<p>a <code>character</code> vector, or <code>NULL</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+attributes">attributes</a></code> and <code><a href="#topic+attr">attr</a></code> for other attributes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:12, 3, 4)
comment(x) &lt;- c("This is my very important data from experiment #0234",
                "Jun 5, 1998")
x
comment(x)
</code></pre>

<hr>
<h2 id='Comparison'>Relational Operators</h2><span id='topic++3C'></span><span id='topic++3C+3D'></span><span id='topic++3D+3D'></span><span id='topic++21+3D'></span><span id='topic++3E+3D'></span><span id='topic++3E'></span><span id='topic+Comparison'></span><span id='topic+collation'></span>

<h3>Description</h3>

<p>Binary operators which allow the comparison of values in atomic vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x &lt; y
x &gt; y
x &lt;= y
x &gt;= y
x == y
x != y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Comparison_+3A_x">x</code>, <code id="Comparison_+3A_y">y</code></td>
<td>
<p>atomic vectors, symbols, calls, or other objects for which
methods have been written.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The binary comparison operators are generic functions: methods can be
written for them individually or via the
<code><a href="#topic+S3groupGeneric">Ops</a></code> group generic function.  (See
<code><a href="#topic+S3groupGeneric">Ops</a></code> for how dispatch is computed.)
</p>
<p>Comparison of strings in character vectors is lexicographic within the
strings using the collating sequence of the locale in use: see
<code><a href="#topic+locales">locales</a></code>.  The collating sequence of locales such as
&lsquo;<span class="samp">&#8288;en_US&#8288;</span>&rsquo; is normally different from &lsquo;<span class="samp">&#8288;C&#8288;</span>&rsquo; (which should use
ASCII) and can be surprising.  Beware of making <em>any</em> assumptions
about the collation order: e.g. in Estonian <code>Z</code> comes between
<code>S</code> and <code>T</code>, and collation is not necessarily
character-by-character &ndash; in Danish <code>aa</code> sorts as a single
letter, after <code>z</code>.  In Welsh <code>ng</code> may or may not be a single
sorting unit: if it is it follows <code>g</code>.  Some platforms may
not respect the locale and always sort in numerical order of the bytes
in an 8-bit locale, or in Unicode code-point order for a UTF-8 locale (and
may not sort in the same order for the same language in different
character sets).  Collation of non-letters (spaces, punctuation signs,
hyphens, fractions and so on) is even more problematic.
</p>
<p>Character strings can be compared  with different marked encodings
(see <code><a href="#topic+Encoding">Encoding</a></code>): they are translated to UTF-8 before
comparison.
</p>
<p>Raw vectors should not really be considered to have an order, but the
numeric order of the byte representation is used.
</p>
<p>At least one of <code>x</code> and <code>y</code> must be an atomic vector, but if
the other is a list <span class="rlang"><b>R</b></span> attempts to coerce it to the type of the atomic
vector: this will succeed if the list is made up of elements of length
one that can be coerced to the correct type.
</p>
<p>If the two arguments are atomic vectors of different types, one is
coerced to the type of the other, the (decreasing) order of precedence
being character, complex, numeric, integer, logical and raw.
</p>
<p>Missing values (<code><a href="#topic+NA">NA</a></code>) and <code><a href="#topic+NaN">NaN</a></code> values are
regarded as non-comparable even to themselves, so comparisons
involving them will always result in <code>NA</code>.  Missing values can
also result when character strings are compared and one is not valid
in the current collation locale.
</p>
<p>Language objects such as symbols and calls can only be used as
operands for <code>==</code> and <code>!=</code>; the other comparisons signal an
error when one of the operands is a language object.  Currently
language objects are deparsed to character strings before
comparison. This can be inefficient and may not be what is really
wanted. For equality comparisons <code><a href="#topic+identical">identical</a></code> is usually a
better choice.
</p>


<h3>Value</h3>

<p>A logical vector indicating the result of the element by element
comparison.  The elements of shorter vectors are recycled as
necessary.
</p>
<p>Objects such as arrays or time-series can be compared this way
provided they are conformable.
</p>


<h3>S4 methods</h3>

<p>These operators are members of the S4 <code><a href="methods.html#topic+Compare">Compare</a></code> group generic,
and so methods can be written for them individually as well as for the
group generic (or the <code>Ops</code> group generic), with arguments
<code>c(e1, e2)</code>.
</p>


<h3>Note</h3>

<p>Do not use <code>==</code> and <code>!=</code> for tests, such as in <code>if</code>
expressions, where you must get a single <code>TRUE</code> or
<code>FALSE</code>.  Unless you are absolutely sure that nothing unusual
can happen, you should use the <code><a href="#topic+identical">identical</a></code> function
instead.
</p>
<p>For numerical and complex values, remember <code>==</code> and <code>!=</code> do
not allow for the finite representation of fractions, nor for rounding
error.  Using <code><a href="#topic+all.equal">all.equal</a></code> with <code>identical</code> or
<code><a href="#topic+isTRUE">isTRUE</a></code> is almost always preferable; see the examples.
(This also applies to the other comparison operators.)
</p>
<p>These operators are sometimes called as functions as
e.g. <code>`&lt;`(x, y)</code>: see the description of how
argument-matching is done in <code><a href="#topic+groupGeneric">Ops</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Collation of character strings is a complex topic.  For an
introduction see
<a href="https://en.wikipedia.org/wiki/Collating_sequence">https://en.wikipedia.org/wiki/Collating_sequence</a>.  The
<em>Unicode Collation Algorithm</em>
(<a href="https://unicode.org/reports/tr10/">https://unicode.org/reports/tr10/</a>) is likely to be increasingly
influential.  Where available <span class="rlang"><b>R</b></span> by default makes use of ICU
(<a href="https://icu.unicode.org/">https://icu.unicode.org/</a>) for collation (except in a C
locale).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Logic">Logic</a></code> on how to <em>combine</em> results of comparisons,
i.e., logical vectors.
</p>
<p><code><a href="#topic+factor">factor</a></code> for the behaviour with factor arguments.
</p>
<p><code><a href="#topic+Syntax">Syntax</a></code> for operator precedence.
</p>
<p><code><a href="#topic+capabilities">capabilities</a></code> for whether ICU is available, and
<code><a href="#topic+icuSetCollate">icuSetCollate</a></code> to tune the string collation algorithm
when it is.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- stats::rnorm(20)
x &lt; 1
x[x &gt; 0]

x1 &lt;- 0.5 - 0.3
x2 &lt;- 0.3 - 0.1
x1 == x2                   # FALSE on most machines
isTRUE(all.equal(x1, x2))  # TRUE everywhere


# range of most 8-bit charsets, as well as of Latin-1 in Unicode
z &lt;- c(32:126, 160:255)
x &lt;- if(l10n_info()$MBCS) {
    intToUtf8(z, multiple = TRUE)
} else rawToChar(as.raw(z), multiple = TRUE)
## by number
writeLines(strwrap(paste(x, collapse=" "), width = 60))
## by locale collation
writeLines(strwrap(paste(sort(x), collapse=" "), width = 60))
</code></pre>

<hr>
<h2 id='complex'>Complex Numbers and Basic Functionality</h2><span id='topic+complex'></span><span id='topic+as.complex'></span><span id='topic+is.complex'></span><span id='topic+Re'></span><span id='topic+Im'></span><span id='topic+Mod'></span><span id='topic+Arg'></span><span id='topic+Conj'></span>

<h3>Description</h3>

<p>Basic functions which support complex arithmetic in <span class="rlang"><b>R</b></span>, in addition to
the arithmetic operators <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and <code>^</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complex(length.out = 0, real = numeric(), imaginary = numeric(),
        modulus = 1, argument = 0)
as.complex(x, ...)
is.complex(x)

Re(z)
Im(z)
Mod(z)
Arg(z)
Conj(z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complex_+3A_length.out">length.out</code></td>
<td>
<p>numeric.  Desired length of the output vector,
inputs being recycled as needed.</p>
</td></tr>
<tr><td><code id="complex_+3A_real">real</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="complex_+3A_imaginary">imaginary</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="complex_+3A_modulus">modulus</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="complex_+3A_argument">argument</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="complex_+3A_x">x</code></td>
<td>
<p>an object, probably of mode <code>complex</code>.</p>
</td></tr>
<tr><td><code id="complex_+3A_z">z</code></td>
<td>
<p>an object of mode <code>complex</code>, or one of a class for which
a methods has been defined.</p>
</td></tr>
<tr><td><code id="complex_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Complex vectors can be created with <code>complex</code>.  The vector can be
specified either by giving its length, its real and imaginary parts, or
modulus and argument.  (Giving just the length generates a vector of
complex zeroes.)
</p>
<p><code>as.complex</code> attempts to coerce its argument to be of complex
type: like <code><a href="#topic+as.vector">as.vector</a></code> it strips attributes including
names.
Since <span class="rlang"><b>R</b></span> version 4.4.0, <code>as.complex(x)</code> for &ldquo;number-like&rdquo;
<code>x</code>, i.e., types <code>"logical"</code>, <code>"integer"</code>, and
<code>"double"</code>, will always keep imaginary part zero, now also for
<code>NA</code>'s.
Up to <span class="rlang"><b>R</b></span> versions 3.2.x, all forms of <code>NA</code> and <code>NaN</code>
were coerced to a complex <code>NA</code>, i.e., the <code><a href="#topic+NA_complex_">NA_complex_</a></code>
constant, for which both the real and imaginary parts are <code>NA</code>.
Since <span class="rlang"><b>R</b></span> 3.3.0, typically only objects which are <code>NA</code> in parts
are coerced to complex <code>NA</code>, but others with <code>NaN</code> parts,
are <em>not</em>.  As a consequence, complex arithmetic where only
<code>NaN</code>'s (but no <code>NA</code>'s) are involved typically will
<em>not</em> give complex <code>NA</code> but complex numbers with real or
imaginary parts of <code>NaN</code>.
All of these many different complex numbers fulfill <code>is.na(.)</code> but
only one of them is identical to <code>NA_complex_</code>.
</p>
<p>Note that <code>is.complex</code> and <code>is.numeric</code> are never both
<code>TRUE</code>.
</p>
<p>The functions <code>Re</code>, <code>Im</code>, <code>Mod</code>, <code>Arg</code> and
<code>Conj</code> have their usual interpretation as returning the real
part, imaginary part, modulus, argument and complex conjugate for
complex values.  The modulus and argument are also called the <em>polar
coordinates</em>.  If <code class="reqn">z = x + i y</code> with real <code class="reqn">x</code> and <code class="reqn">y</code>, for
<code class="reqn">r = Mod(z) = \sqrt{x^2 + y^2}</code>,
and <code class="reqn">\phi = Arg(z)</code>, <code class="reqn">x = r \cos(\phi)</code> and
<code class="reqn">y = r \sin(\phi)</code>.  They are all
<a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a> functions: methods can be
defined for them
individually or <em>via</em> the <code><a href="#topic+S3groupGeneric">Complex</a></code>
group generic.
</p>
<p>In addition to the arithmetic operators (see <a href="#topic+Arithmetic">Arithmetic</a>)
<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, and <code>^</code>, the elementary
trigonometric, logarithmic, exponential, square root and hyperbolic
functions are implemented for complex values.
</p>
<p>Matrix multiplications (<code><a href="#topic++25+2A+25">%*%</a></code>, <code><a href="#topic+crossprod">crossprod</a></code>,
<code><a href="#topic+tcrossprod">tcrossprod</a></code>) are also defined for complex matrices
(<code><a href="#topic+matrix">matrix</a></code>), and so are <code><a href="#topic+solve">solve</a></code>,
<code><a href="#topic+eigen">eigen</a></code> or <code><a href="#topic+svd">svd</a></code>.
</p>
<p>Internally, complex numbers are stored as a pair of <a href="#topic+double">double</a>
precision numbers, either or both of which can be <code><a href="#topic+NaN">NaN</a></code>
(including <code>NA</code>, see <code><a href="#topic+NA_complex_">NA_complex_</a></code> and above) or
plus or minus infinity.
</p>


<h3>S4 methods</h3>

<p><code>as.complex</code> is primitive and can have S4 methods set.
</p>
<p><code>Re</code>, <code>Im</code>, <code>Mod</code>, <code>Arg</code> and <code>Conj</code>
constitute the S4 group generic
<code><a href="methods.html#topic+S4groupGeneric">Complex</a></code> and so S4 methods can be
set for them individually or via the group generic.
</p>


<h3>Note</h3>

<p>Operations and functions involving complex <code><a href="#topic+NaN">NaN</a></code> mostly
rely on the C library's handling of &lsquo;<span class="samp">&#8288;double complex&#8288;</span>&rsquo; arithmetic,
which typically returns <code>complex(re=NaN, im=NaN)</code> (but we have
not seen a guarantee for that).
For <code>+</code> and <code>-</code>, <span class="rlang"><b>R</b></span>'s own handling works strictly
&ldquo;coordinate wise&rdquo;.
</p>
<p>Operations involving complex <code>NA</code>, i.e., <code><a href="#topic+NA_complex_">NA_complex_</a></code>, return
<code><a href="#topic+NA_complex_">NA_complex_</a></code>.
</p>
<p>Only since <span class="rlang"><b>R</b></span> version 4.4.0, <code>as.complex("1i")</code> gives <code>1i</code>,
it returned <code>NA_complex_</code> with a warning, previously.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Arithmetic">Arithmetic</a></code>; <code><a href="#topic+polyroot">polyroot</a></code> finds all <code class="reqn">n</code>
complex roots of a polynomial of degree <code class="reqn">n</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

0i ^ (-3:3)

matrix(1i^ (-6:5), nrow = 4) #- all columns are the same
0 ^ 1i # a complex NaN

## create a complex normal vector
z &lt;- complex(real = stats::rnorm(100), imaginary = stats::rnorm(100))
## or also (less efficiently):
z2 &lt;- 1:2 + 1i*(8:9)

## The Arg(.) is an angle:
zz &lt;- (rep(1:4, length.out = 9) + 1i*(9:1))/10
zz.shift &lt;- complex(modulus = Mod(zz), argument = Arg(zz) + pi)
plot(zz, xlim = c(-1,1), ylim = c(-1,1), col = "red", asp = 1,
     main = expression(paste("Rotation by "," ", pi == 180^o)))
abline(h = 0, v = 0, col = "blue", lty = 3)
points(zz.shift, col = "orange")

## as.complex(&lt;some NA&gt;): numbers keep Im = 0:
stopifnot(identical(as.complex(NA_real_), NA_real_ + 0i)) # has always been true
NAs &lt;- vapply(list(NA, NA_integer_, NA_real_, NA_character_, NA_complex_),
              as.complex, 0+0i)
stopifnot(is.na(NAs), is.na(Re(NAs))) # has always been true
showC &lt;- function(z) noquote(paste0("(", Re(z), ",", Im(z), ")"))
showC(NAs)
Im(NAs) # [0 0 0 NA NA]  \ in R &lt;= 4.3.x was [NA NA 0 NA NA]
stopifnot(Im(NAs)[1:3] == 0)


## The exact result of this *depends* on the platform, compiler, math-library:
(NpNA &lt;- NaN + NA_complex_) ; str(NpNA) # *behaves* as 'cplx NA' ..
stopifnot(is.na(NpNA), is.na(NA_complex_), is.na(Re(NA_complex_)), is.na(Im(NA_complex_)))
showC(NpNA)# but does not always show '(NaN,NA)'
## and this is not TRUE everywhere:
identical(NpNA, NA_complex_)
showC(NA_complex_) # always == (NA,NA)
</code></pre>

<hr>
<h2 id='conditions'>Condition Handling and Recovery</h2><span id='topic+conditions'></span><span id='topic+condition'></span><span id='topic+computeRestarts'></span><span id='topic+conditionCall'></span><span id='topic+conditionMessage'></span><span id='topic+findRestart'></span><span id='topic+invokeRestart'></span><span id='topic+tryInvokeRestart'></span><span id='topic+invokeRestartInteractively'></span><span id='topic+isRestart'></span><span id='topic+restartDescription'></span><span id='topic+restartFormals'></span><span id='topic+signalCondition'></span><span id='topic+simpleCondition'></span><span id='topic+simpleError'></span><span id='topic+simpleWarning'></span><span id='topic+simpleMessage'></span><span id='topic+errorCondition'></span><span id='topic+warningCondition'></span><span id='topic+tryCatch'></span><span id='topic+withCallingHandlers'></span><span id='topic+withRestarts'></span><span id='topic+suspendInterrupts'></span><span id='topic+allowInterrupts'></span><span id='topic+globalCallingHandlers'></span><span id='topic+.signalSimpleWarning'></span><span id='topic+.handleSimpleError'></span><span id='topic+.tryResumeInterrupt'></span><span id='topic+as.character.condition'></span><span id='topic+as.character.error'></span><span id='topic+conditionCall.condition'></span><span id='topic+conditionMessage.condition'></span><span id='topic+print.condition'></span><span id='topic+print.restart'></span>

<h3>Description</h3>

<p>These functions provide a mechanism for handling unusual conditions,
including errors and warnings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tryCatch(expr, ..., finally)
withCallingHandlers(expr, ...)
globalCallingHandlers(...)

signalCondition(cond)

simpleCondition(message, call = NULL)
simpleError    (message, call = NULL)
simpleWarning  (message, call = NULL)
simpleMessage  (message, call = NULL)

errorCondition(message, ..., class = NULL, call = NULL)
warningCondition(message, ..., class = NULL, call = NULL)

## S3 method for class 'condition'
as.character(x, ...)
## S3 method for class 'error'
as.character(x, ...)
## S3 method for class 'condition'
print(x, ...)
## S3 method for class 'restart'
print(x, ...)

conditionCall(c)
## S3 method for class 'condition'
conditionCall(c)
conditionMessage(c)
## S3 method for class 'condition'
conditionMessage(c)

withRestarts(expr, ...)

computeRestarts(cond = NULL)
findRestart(name, cond = NULL)
invokeRestart(r, ...)
tryInvokeRestart(r, ...)
invokeRestartInteractively(r)

isRestart(x)
restartDescription(r)
restartFormals(r)

suspendInterrupts(expr)
allowInterrupts(expr)

.signalSimpleWarning(msg, call)
.handleSimpleError(h, msg, call)
.tryResumeInterrupt()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conditions_+3A_c">c</code></td>
<td>
<p>a condition object.</p>
</td></tr>
<tr><td><code id="conditions_+3A_call">call</code></td>
<td>
<p>call expression.</p>
</td></tr>
<tr><td><code id="conditions_+3A_cond">cond</code></td>
<td>
<p>a condition object.</p>
</td></tr>
<tr><td><code id="conditions_+3A_expr">expr</code></td>
<td>
<p>expression to be evaluated.</p>
</td></tr>
<tr><td><code id="conditions_+3A_finally">finally</code></td>
<td>
<p>expression to be evaluated before returning or exiting.</p>
</td></tr>
<tr><td><code id="conditions_+3A_h">h</code></td>
<td>
<p>function.</p>
</td></tr>
<tr><td><code id="conditions_+3A_message">message</code></td>
<td>
<p>character string.</p>
</td></tr>
<tr><td><code id="conditions_+3A_msg">msg</code></td>
<td>
<p>character string.</p>
</td></tr>
<tr><td><code id="conditions_+3A_name">name</code></td>
<td>
<p>character string naming a restart.</p>
</td></tr>
<tr><td><code id="conditions_+3A_r">r</code></td>
<td>
<p>restart object.</p>
</td></tr>
<tr><td><code id="conditions_+3A_x">x</code></td>
<td>
<p>object.</p>
</td></tr>
<tr><td><code id="conditions_+3A_class">class</code></td>
<td>
<p>character string naming a condition class.</p>
</td></tr>
<tr><td><code id="conditions_+3A_...">...</code></td>
<td>
<p>additional arguments; see details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The condition system provides a mechanism for signaling and
handling unusual conditions, including errors and warnings.
Conditions are represented as objects that contain information
about the condition that occurred, such as a message and the call in
which the condition occurred.  Currently conditions are S3-style
objects, though this may eventually change.
</p>
<p>Conditions are objects inheriting from the abstract class
<code>condition</code>.  Errors and warnings are objects inheriting
from the abstract subclasses <code>error</code> and <code>warning</code>.
The class <code>simpleError</code> is the class used by <code>stop</code>
and all internal error signals.  Similarly, <code>simpleWarning</code>
is used by <code>warning</code>, and <code>simpleMessage</code> is used by
<code>message</code>.  The constructors by the same names take a string
describing the condition as argument and an optional call.  The
functions <code>conditionMessage</code> and <code>conditionCall</code> are
generic functions that return the message and call of a condition.
</p>
<p>The function <code>errorCondition</code> can be
used to construct error conditions of a particular class with
additional fields specified as the <code>...</code> argument.
<code>warningCondition</code> is analogous for warnings.
</p>
<p>Conditions are signaled by <code>signalCondition</code>.  In addition,
the <code>stop</code> and <code>warning</code> functions have been modified to
also accept condition arguments.
</p>
<p>The function <code>tryCatch</code> evaluates its expression argument
in a context where the handlers provided in the <code>...</code>
argument are available.  The <code>finally</code> expression is then
evaluated in the context in which <code>tryCatch</code> was called; that
is, the handlers supplied to the current <code>tryCatch</code> call are
not active when the <code>finally</code> expression is evaluated.
</p>
<p>Handlers provided in the <code>...</code> argument to <code>tryCatch</code>
are established for the duration of the evaluation of <code>expr</code>.
If no condition is signaled when evaluating <code>expr</code> then
<code>tryCatch</code> returns the value of the expression.
</p>
<p>If a condition is signaled while evaluating <code>expr</code> then
established handlers are checked, starting with the most recently
established ones, for one matching the class of the condition.
When several handlers are supplied in a single <code>tryCatch</code> then
the first one is considered more recent than the second.  If a
handler is found then control is transferred to the
<code>tryCatch</code> call that established the handler, the handler
found and all more recent handlers are disestablished, the handler
is called with the condition as its argument, and the result
returned by the handler is returned as the value of the
<code>tryCatch</code> call.
</p>
<p>Calling handlers are established by <code>withCallingHandlers</code>.  If
a condition is signaled and the applicable handler is a calling
handler, then the handler is called by <code>signalCondition</code> in
the context where the condition was signaled but with the available
handlers restricted to those below the handler called in the
handler stack.  If the handler returns, then the next handler is
tried; once the last handler has been tried, <code>signalCondition</code>
returns <code>NULL</code>.
</p>
<p><code>globalCallingHandlers</code> establishes calling handlers globally.
These handlers are only called as a last resort, after the other
handlers dynamically registered with <code>withCallingHandlers</code> have
been invoked. They are called before the <code>error</code> global option
(which is the legacy interface for global handling of errors).
Registering the same handler multiple times moves that handler on
top of the stack, which ensures that it is called first. Global
handlers are a good place to define a general purpose logger (for
instance saving the last error object in the global workspace) or a
general recovery strategy (e.g. installing missing packages via the
<code>retry_loadNamespace</code> restart).
</p>
<p>Like <code>withCallingHandlers</code> and <code>tryCatch</code>,
<code>globalCallingHandlers</code> takes named handlers. Unlike these
functions, it also has an <code><a href="#topic+options">options</a></code>-like interface: you
can establish handlers by passing a single list of named handlers.
To unregister all global handlers, supply a single 'NULL'. The list
of deleted handlers is returned invisibly. Finally, calling
<code>globalCallingHandlers</code> without arguments returns the list of
currently established handlers, visibly.
</p>
<p>User interrupts signal a condition of class <code>interrupt</code> that
inherits directly from class <code>condition</code> before executing the
default interrupt action.
</p>
<p>Restarts are used for establishing recovery protocols.  They can be
established using <code>withRestarts</code>.  One pre-established restart is
an <code>abort</code> restart that represents a jump to top level.
</p>
<p><code>findRestart</code> and <code>computeRestarts</code> find the available
restarts.  <code>findRestart</code> returns the most recently established
restart of the specified name.  <code>computeRestarts</code> returns a
list of all restarts.  Both can be given a condition argument and
will then ignore restarts that do not apply to the condition.
</p>
<p><code>invokeRestart</code> transfers control to the point where the
specified restart was established and calls the restart's handler with the
arguments, if any, given as additional arguments to
<code>invokeRestart</code>.  The restart argument to <code>invokeRestart</code>
can be a character string, in which case <code>findRestart</code> is used
to find the restart. If no restart is found, an error is thrown.
</p>
<p><code>tryInvokeRestart</code> is a variant of <code>invokeRestart</code> that
returns silently when the restart cannot be found with
<code>findRestart</code>. Because a condition of a given class might be
signalled with arbitrary protocols (error, warning, etc), it is
recommended to use this permissive variant whenever you are handling
conditions signalled from a foreign context. For instance, invocation
of a <code>"muffleWarning"</code> restart should be optional because the
warning might have been signalled by the user or from a different
package with the <code>stop</code> or <code>message</code> protocols. Only use
<code>invokeRestart</code> when you have control of the signalling context,
or when it is a logical error if the restart is not available.
</p>
<p>New restarts for <code>withRestarts</code> can be specified in several ways.
The simplest is in <code>name = function</code> form where the function is
the handler to call when the restart is invoked.  Another simple
variant is as <code>name = string</code> where the string is stored in the
<code>description</code> field of the restart object returned by
<code>findRestart</code>; in this case the handler ignores its arguments
and returns <code>NULL</code>.  The most flexible form of a restart
specification is as a list that can include several fields, including
<code>handler</code>, <code>description</code>, and <code>test</code>.  The
<code>test</code> field should contain a function of one argument, a
condition, that returns <code>TRUE</code> if the restart applies to the
condition and <code>FALSE</code> if it does not; the default function
returns <code>TRUE</code> for all conditions.
</p>
<p>One additional field that can be specified for a restart is
<code>interactive</code>.  This should be a function of no arguments that
returns a list of arguments to pass to the restart handler.  The list
could be obtained by interacting with the user if necessary.  The
function <code>invokeRestartInteractively</code> calls this function to
obtain the arguments to use when invoking the restart.  The default
<code>interactive</code> method queries the user for values for the
formal arguments of the handler function.
</p>
<p>Interrupts can be suspended while evaluating an expression using
<code>suspendInterrupts</code>.  Subexpression can be evaluated with
interrupts enabled using <code>allowInterrupts</code>.  These functions
can be used to make sure cleanup handlers cannot be interrupted.
</p>
<p><code>.signalSimpleWarning</code>, <code>.handleSimpleError</code>, and
<code>.tryResumeInterrupt</code> are used internally and should not be
called directly.
</p>


<h3>References</h3>

<p>The <code>tryCatch</code> mechanism is similar to Java
error handling.  Calling handlers are based on Common Lisp and
Dylan.  Restarts are based on the Common Lisp restart mechanism.</p>


<h3>See Also</h3>

<p><code><a href="#topic+stop">stop</a></code> and <code><a href="#topic+warning">warning</a></code> signal conditions,
and <code><a href="#topic+try">try</a></code> is essentially a simplified version of
<code>tryCatch</code>.
<code><a href="tools.html#topic+assertCondition">assertCondition</a></code> in package <span class="pkg">tools</span> <em>tests</em>
that conditions are signalled and works with several of the above
handlers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tryCatch(1, finally = print("Hello"))
e &lt;- simpleError("test error")
## Not run: 
 stop(e)
 tryCatch(stop(e), finally = print("Hello"))
 tryCatch(stop("fred"), finally = print("Hello"))

## End(Not run)
tryCatch(stop(e), error = function(e) e, finally = print("Hello"))
tryCatch(stop("fred"),  error = function(e) e, finally = print("Hello"))
withCallingHandlers({ warning("A"); 1+2 }, warning = function(w) {})
## Not run: 
 { withRestarts(stop("A"), abort = function() {}); 1 }

## End(Not run)
withRestarts(invokeRestart("foo", 1, 2), foo = function(x, y) {x + y})

##--&gt; More examples are part of
##--&gt;   demo(error.catching)
</code></pre>

<hr>
<h2 id='conflicts'>Search for Masked Objects on the Search Path</h2><span id='topic+conflicts'></span>

<h3>Description</h3>

<p><code>conflicts</code> reports on objects that exist with the same name in
two or more places on the <code><a href="#topic+search">search</a></code> path, usually because
an object in the user's workspace or a package is masking a system
object of the same name.  This helps discover unintentional masking.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conflicts(where = search(), detail = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conflicts_+3A_where">where</code></td>
<td>
<p>A subset of the search path, by default the whole search path.</p>
</td></tr>
<tr><td><code id="conflicts_+3A_detail">detail</code></td>
<td>
<p>If <code>TRUE</code>, give the masked or masking functions for
all members of the search path.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>detail = FALSE</code>, a character vector of masked objects.
If <code>detail = TRUE</code>, a list of character vectors giving the masked or
masking objects in that member of the search path.  Empty vectors are
omitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lm &lt;- 1:3
conflicts(, TRUE)
## gives something like
# $.GlobalEnv
# [1] "lm"
#
# $package:base
# [1] "lm"

## Remove things from your "workspace" that mask others:
remove(list = conflicts(detail = TRUE)$.GlobalEnv)
</code></pre>

<hr>
<h2 id='connections'>Functions to Manipulate Connections (Files, URLs, ...)</h2><span id='topic+connections'></span><span id='topic+connection'></span><span id='topic+file'></span><span id='topic+clipboard'></span><span id='topic+pipe'></span><span id='topic+fifo'></span><span id='topic+gzfile'></span><span id='topic+unz'></span><span id='topic+bzfile'></span><span id='topic+xzfile'></span><span id='topic+url'></span><span id='topic+socketConnection'></span><span id='topic+socketAccept'></span><span id='topic+serverSocket'></span><span id='topic+socketTimeout'></span><span id='topic+open'></span><span id='topic+open.connection'></span><span id='topic+isOpen'></span><span id='topic+isIncomplete'></span><span id='topic+close'></span><span id='topic+close.connection'></span><span id='topic+flush'></span><span id='topic+flush.connection'></span><span id='topic+print.connection'></span><span id='topic+summary.connection'></span>

<h3>Description</h3>

<p>Functions to create, open and close connections, i.e.,
&ldquo;generalized files&rdquo;, such as possibly compressed files, URLs,
pipes, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file(description = "", open = "", blocking = TRUE,
     encoding = getOption("encoding"), raw = FALSE,
     method = getOption("url.method", "default"))

url(description, open = "", blocking = TRUE,
    encoding = getOption("encoding"),
    method = getOption("url.method", "default"),
    headers = NULL)

gzfile(description, open = "", encoding = getOption("encoding"),
       compression = 6)

bzfile(description, open = "", encoding = getOption("encoding"),
       compression = 9)

xzfile(description, open = "", encoding = getOption("encoding"),
       compression = 6)

unz(description, filename, open = "", encoding = getOption("encoding"))

pipe(description, open = "", encoding = getOption("encoding"))

fifo(description, open = "", blocking = FALSE,
     encoding = getOption("encoding"))

socketConnection(host = "localhost", port, server = FALSE,
                 blocking = FALSE, open = "a+",
                 encoding = getOption("encoding"),
                 timeout = getOption("timeout"),
                 options = getOption("socketOptions"))

serverSocket(port)

socketAccept(socket, blocking = FALSE, open = "a+",
             encoding = getOption("encoding"),
             timeout = getOption("timeout"),
             options = getOption("socketOptions"))

open(con, ...)
## S3 method for class 'connection'
open(con, open = "r", blocking = TRUE, ...)

close(con, ...)
## S3 method for class 'connection'
close(con, type = "rw", ...)

flush(con)

isOpen(con, rw = "")
isIncomplete(con)

socketTimeout(socket, timeout = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="connections_+3A_description">description</code></td>
<td>
<p>character string.  A description of the connection:
see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="connections_+3A_open">open</code></td>
<td>
<p>character string.  A description of how to open the connection
(if it should be opened initially).  See section &lsquo;Modes&rsquo; for
possible values.</p>
</td></tr>
<tr><td><code id="connections_+3A_blocking">blocking</code></td>
<td>
<p>logical.  See the &lsquo;Blocking&rsquo; section.</p>
</td></tr>
<tr><td><code id="connections_+3A_encoding">encoding</code></td>
<td>
<p>the name of the encoding to be assumed.  See the
&lsquo;Encoding&rsquo; section.</p>
</td></tr>
<tr><td><code id="connections_+3A_raw">raw</code></td>
<td>
<p>logical.  If true, a &lsquo;raw&rsquo; interface is used which
will be more suitable for arguments which are not regular files,
e.g. character devices.  This suppresses the check for a compressed
file when opening for text-mode reading, and asserts that the
&lsquo;file&rsquo; may not be seekable.</p>
</td></tr>
<tr><td><code id="connections_+3A_method">method</code></td>
<td>
<p>character string, partially matched to
<code>c("default", "internal", "wininet", "libcurl")</code>:
see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="connections_+3A_headers">headers</code></td>
<td>
<p>named character vector of HTTP headers to use in HTTP
requests.  It is ignored for non-HTTP URLs.  The <code>User-Agent</code>
header, coming from the <code>HTTPUserAgent</code> option (see
<code><a href="#topic+options">options</a></code>) is used as the first header, automatically.</p>
</td></tr>
<tr><td><code id="connections_+3A_compression">compression</code></td>
<td>
<p>integer in 0&ndash;9.  The amount of compression to be
applied when writing, from none to maximal available.  For
<code>xzfile</code> can also be negative: see the &lsquo;Compression&rsquo;
section.</p>
</td></tr>
<tr><td><code id="connections_+3A_timeout">timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this
connection.  Beware that some OSes may treat very large values as
zero: however the POSIX standard requires values up to 31 days to be
supported.</p>
</td></tr>
<tr><td><code id="connections_+3A_options">options</code></td>
<td>
<p>optional character vector with options. Currently only
<code>"no-delay"</code> is supported on TCP sockets.</p>
</td></tr>
<tr><td><code id="connections_+3A_filename">filename</code></td>
<td>
<p>a filename within a zip file.</p>
</td></tr>
<tr><td><code id="connections_+3A_host">host</code></td>
<td>
<p>character string.  Host name for the port.</p>
</td></tr>
<tr><td><code id="connections_+3A_port">port</code></td>
<td>
<p>integer.  The TCP port number.</p>
</td></tr>
<tr><td><code id="connections_+3A_server">server</code></td>
<td>
<p>logical.  Should the socket be a client or a server?</p>
</td></tr>
<tr><td><code id="connections_+3A_socket">socket</code></td>
<td>
<p>a server socket listening for connections.</p>
</td></tr>
<tr><td><code id="connections_+3A_con">con</code></td>
<td>
<p>a connection.</p>
</td></tr>
<tr><td><code id="connections_+3A_type">type</code></td>
<td>
<p>character string.  Currently ignored.</p>
</td></tr>
<tr><td><code id="connections_+3A_rw">rw</code></td>
<td>
<p>character string.  Empty or <code>"read"</code> or <code>"write"</code>,
partial matches allowed.</p>
</td></tr>
<tr><td><code id="connections_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first eleven functions create connections.  By default the
connection is not opened (except for a socket connection created by
<code>socketConnection</code> or <code>socketAccept</code> and for server socket
connection created by <code>serverSocket</code>), but may
be opened by setting a non-empty value of argument <code>open</code>.
</p>
<p>For <code>file</code> the description is a path to the file to be opened
(when <a href="#topic+tilde+20expansion">tilde expansion</a> is done) or a complete URL (when it is
the same as calling <code>url</code>), or <code>""</code> (the default) or
<code>"clipboard"</code> (see the &lsquo;Clipboard&rsquo; section).  Use
<code>"stdin"</code> to refer to the C-level &lsquo;standard input&rsquo; of the
process (which need not be connected to anything in a console or
embedded version of <span class="rlang"><b>R</b></span>, and is not in <code>RGui</code> on Windows).  See
also <code><a href="#topic+stdin">stdin</a>()</code> for the subtly different R-level concept of
<code>stdin</code>. See <code><a href="#topic+nullfile">nullfile</a>()</code> for a platform-independent
way to get filename of the null device.
</p>
<p>For <code>url</code> the description is a complete URL including scheme
(such as &lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo;).  Method <code>"internal"</code> is that available since
connections were introduced but now mainly defunct.  Method
<code>"wininet"</code> is only available on Windows (it uses the WinINet
functions of that OS) and method <code>"libcurl"</code> (using the library
of that name: <a href="https://curl.se/libcurl/">https://curl.se/libcurl/</a>) is nowadays required but
was optional on Windows before <span class="rlang"><b>R</b></span> 4.2.0.  Method <code>"default"</code>
currently uses method <code>"internal"</code> for &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo; URLs and
<code>"libcurl"</code> for all others.  Which methods support which schemes
has varied by <span class="rlang"><b>R</b></span> version &ndash; currently <code>"internal"</code> supports only
&lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo;; <code>"wininet"</code> supports &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo;.  Proxies can be specified: see
<code><a href="utils.html#topic+download.file">download.file</a></code>.
</p>
<p>For <code>gzfile</code> the description is the path to a file compressed by
<code>gzip</code>: it can also open for reading uncompressed files and
those compressed by <code>bzip2</code>, <code>xz</code> or <code>lzma</code>.
</p>
<p>For <code>bzfile</code> the description is the path to a file compressed by
<code>bzip2</code>.
</p>
<p>For <code>xzfile</code> the description is the path to a file compressed by
<code>xz</code> (<a href="https://en.wikipedia.org/wiki/Xz">https://en.wikipedia.org/wiki/Xz</a>) or (for reading
only) <code>lzma</code> (<a href="https://en.wikipedia.org/wiki/LZMA">https://en.wikipedia.org/wiki/LZMA</a>).
</p>
<p><code>unz</code> reads (only) single files within zip files, in binary mode.
The description is the full path to the zip file, with &lsquo;<span class="file">.zip</span>&rsquo;
extension if required.
</p>
<p>For <code>pipe</code> the description is the command line to be piped to or
from.  This is run in a shell, on Windows that specified by the
<span class="env">COMSPEC</span> environment variable.
</p>
<p>For <code>fifo</code> the description is the path of the fifo.  (Support for
<code>fifo</code> connections is optional but they are available on most
Unix platforms and on Windows.)
</p>
<p>The intention is that <code>file</code> and <code>gzfile</code> can be used
generally for text input (from files, &lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo; URLs) and binary input respectively.
</p>
<p><code>open</code>, <code>close</code> and <code>seek</code> are generic functions: the
following applies to the methods relevant to connections.
</p>
<p><code>open</code> opens a connection.  In general functions using
connections will open them if they are not open, but then close them
again, so to leave a connection open call <code>open</code> explicitly.
</p>
<p><code>close</code> closes and destroys a connection.  This will happen
automatically in due course (with a warning) if there is no longer an
<span class="rlang"><b>R</b></span> object referring to the connection.
</p>
<p><code>flush</code> flushes the output stream of a connection open for
write/append (where implemented, currently for file and clipboard
connections, <code><a href="#topic+stdout">stdout</a></code> and <code><a href="#topic+stderr">stderr</a></code>).
</p>
<p>If for a <code>file</code> or (on most platforms) a <code>fifo</code> connection
the description is <code>""</code>, the file/fifo is immediately opened (in
<code>"w+"</code> mode unless <code>open = "w+b"</code> is specified) and unlinked
from the file system.  This provides a temporary file/fifo to write to
and then read from.
</p>
<p><code>socketConnection(server=TRUE)</code> creates a new temporary server socket
listening on the given port.  As soon as a new socket connection is
accepted on that port, the server socket is automatically closed. 
<code>serverSocket</code> creates a listening server socket which can be used
for accepting multiple socket connections by <code>socketAccept</code>.  To stop
listening for new connections, a server socket needs to be closed
explicitly by <code>close</code>.
</p>
<p><code>socketConnection</code> and <code>socketAccept</code> support setting of
socket-specific options. Currently only <code>"no-delay"</code> is
implemented which enables the <code>TCP_NODELAY</code> socket option, causing
the socket to flush send buffers immediately (instead of waiting to
collect all output before sending). This option is useful for
protocols that need fast request/response turn-around times.
</p>
<p><code>socketTimeout</code> sets connection timeout of a socket connection.  A
negative <code>timeout</code> can be given to query the old value.
</p>


<h3>Value</h3>

<p><code>file</code>, <code>pipe</code>, <code>fifo</code>, <code>url</code>, <code>gzfile</code>,
<code>bzfile</code>, <code>xzfile</code>, <code>unz</code>, <code>socketConnection</code>,
<code>socketAccept</code> and <code>serverSocket</code>
return a connection object which inherits from class
<code>"connection"</code> and has a first more specific class.
</p>
<p><code>open</code> and <code>flush</code> return <code>NULL</code>, invisibly.
</p>
<p><code>close</code> returns either <code>NULL</code> or an integer status,
invisibly. The status is from when the connection was last closed and
is available only for some types of connections (e.g., pipes, files and
fifos): typically zero values indicate success.  Negative values will
result in a warning; if writing, these may indicate write failures and should
not be ignored. Connections should be closed explicitly when finished
with to avoid wasting resources and to reduce the risk that some buffered
data in output connections would be lost (see <code><a href="#topic+on.exit">on.exit</a>()</code> for
how to run code also in case of error).
</p>
<p><code>isOpen</code> returns a logical value, whether the connection is
currently open.
</p>
<p><code>isIncomplete</code> returns a logical value, whether the last read attempt
from a non-blocking connection provided no data (currently no data from a
socket or an unterminated line in <code><a href="#topic+readLines">readLines</a></code>), or for an
output text connection whether there is unflushed output. See example
below.
</p>
<p><code>socketTimeout</code> returns the old timeout value of a socket connection. 
</p>


<h3>URLs</h3>

<p><code>url</code> and <code>file</code> support URL schemes &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo;.
</p>
<p><code>method = "libcurl"</code> allows more schemes: exactly which schemes
is platform-dependent (see <code><a href="#topic+libcurlVersion">libcurlVersion</a></code>), but all
platforms will support &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo; and most platforms will support
&lsquo;<span class="samp">&#8288;ftps://&#8288;</span>&rsquo;.
</p>
<p>Support for the &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo; scheme by the <code>"internal"</code> method was
deprecated in <span class="rlang"><b>R</b></span> 4.1.1 and removed in <span class="rlang"><b>R</b></span> 4.2.0.
</p>
<p>Most methods do not percent-encode special characters such as spaces
in &lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo; URLs (see <code><a href="utils.html#topic+URLencode">URLencode</a></code>), but it seems the
<code>"wininet"</code> method does.
</p>
<p>A note on &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo; URLs (which are handled by the same internal
code irrespective of argument <code>method</code>).  The most general form
(from RFC1738) is &lsquo;<span class="samp">&#8288;file://host/path/to/file&#8288;</span>&rsquo;, but <span class="rlang"><b>R</b></span> only accepts
the form with an empty <code>host</code> field referring to the local
machine.
</p>
<p>On a Unix-alike, this is then &lsquo;<span class="samp">&#8288;file:///path/to/file&#8288;</span>&rsquo;, where
&lsquo;<span class="samp">&#8288;path/to/file&#8288;</span>&rsquo; is relative to &lsquo;<span class="file">/</span>&rsquo;.  So although the third
slash is strictly part of the specification not part of the path, this
can be regarded as a way to specify the file &lsquo;<span class="file">/path/to/file</span>&rsquo;.  It
is not possible to specify a relative path using a file URL.
</p>
<p>In this form the path is relative to the root of the filesystem, not a
Windows concept.  The standard form on Windows is
&lsquo;<span class="samp">&#8288;file:///d:/R/repos&#8288;</span>&rsquo;: for compatibility with earlier versions of
<span class="rlang"><b>R</b></span> and Unix versions, any other form is parsed as <span class="rlang"><b>R</b></span> as &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo;
plus <code>path_to_file</code>.  Also, backslashes are accepted within the
path even though RFC1738 does not allow them.
</p>
<p>No attempt is made to decode a percent-encoded &lsquo;<span class="samp">&#8288;file:&#8288;</span>&rsquo; URL: call
<code><a href="utils.html#topic+URLdecode">URLdecode</a></code> if necessary.
</p>
<p>All the methods attempt to follow redirected HTTP and <abbr>HTTPS</abbr> URLs.
</p>
<p>Server-side cached data is always accepted.
</p>
<p>Function <code><a href="utils.html#topic+download.file">download.file</a></code> and several contributed packages
provide more comprehensive facilities to download from URLs.
</p>


<h3>Modes</h3>

<p>Possible values for the argument <code>open</code> are
</p>

<dl>
<dt><code>"r"</code> or <code>"rt"</code></dt><dd><p>Open for reading in text mode.</p>
</dd>
<dt><code>"w"</code> or <code>"wt"</code></dt><dd><p>Open for writing in text mode.</p>
</dd>
<dt><code>"a"</code> or <code>"at"</code></dt><dd><p>Open for appending in text mode.</p>
</dd>
<dt><code>"rb"</code></dt><dd><p>Open for reading in binary mode.</p>
</dd>
<dt><code>"wb"</code></dt><dd><p>Open for writing in binary mode.</p>
</dd>
<dt><code>"ab"</code></dt><dd><p>Open for appending in binary mode.</p>
</dd>
<dt><code>"r+"</code>, <code>"r+b"</code></dt><dd><p>Open for reading and writing.</p>
</dd>
<dt><code>"w+"</code>, <code>"w+b"</code></dt><dd><p>Open for reading and writing,
truncating file initially.</p>
</dd>
<dt><code>"a+"</code>, <code>"a+b"</code></dt><dd><p>Open for reading and appending.</p>
</dd>
</dl>

<p>Not all modes are applicable to all connections: for example URLs can
only be opened for reading.  Only file and socket connections can be
opened for both reading and writing.  An unsupported mode is usually
silently substituted.
</p>
<p>If a file or fifo is created on a Unix-alike, its permissions will be
the maximal allowed by the current setting of <code>umask</code> (see
<code><a href="#topic+Sys.umask">Sys.umask</a></code>).
</p>
<p>For many connections there is little or no difference between text and
binary modes.  For file-like connections on Windows, translation of
line endings (between <abbr>LF</abbr> and  <abbr>CRLF</abbr>) is done in text mode only (but text
read operations on connections such as <code><a href="#topic+readLines">readLines</a></code>,
<code><a href="#topic+scan">scan</a></code> and <code><a href="#topic+source">source</a></code> work for any form of line
ending).  Various <span class="rlang"><b>R</b></span> operations are possible in only one of the modes:
for example <code><a href="#topic+pushBack">pushBack</a></code> is text-oriented and is only
allowed on connections open for reading in text mode, and binary
operations such as <code><a href="#topic+readBin">readBin</a></code>, <code><a href="#topic+load">load</a></code> and
<code><a href="#topic+save">save</a></code> can only be done on binary-mode connections.
</p>
<p>The mode of a connection is determined when actually opened, which is
deferred if <code>open = ""</code> is given (the default for all but socket
connections).  An explicit call to <code>open</code> can specify the mode,
but otherwise the mode will be <code>"r"</code>.  (<code>gzfile</code>,
<code>bzfile</code> and <code>xzfile</code> connections are exceptions, as the
compressed file always has to be opened in binary mode and no
conversion of line-endings is done even on Windows, so the default
mode is interpreted as <code>"rb"</code>.)  Most operations that need write
access or text-only or binary-only mode will override the default mode
of a non-yet-open connection.
</p>
<p>Append modes need to be considered carefully for compressed-file
connections.  They do <strong>not</strong> produce a single compressed stream
on the file, but rather append a new compressed stream to the file.
Readers may or may not read beyond end of the first stream: currently
<span class="rlang"><b>R</b></span> does so for <code>gzfile</code>, <code>bzfile</code> and <code>xzfile</code>
connections.
</p>


<h3>Compression</h3>

<p><span class="rlang"><b>R</b></span> supports <code>gzip</code>, <code>bzip2</code> and <code>xz</code>
compression (also read-only support for its precursor, <code>lzma</code>
compression).
</p>
<p>For reading, the type of compression (if any) can be determined from
the first few bytes of the file.  Thus for <code>file(raw = FALSE)</code>
connections, if <code>open</code> is <code>""</code>, <code>"r"</code> or <code>"rt"</code>
the connection can read any of the compressed file types as well as
uncompressed files.  (Using <code>"rb"</code> will allow compressed files to
be read byte-by-byte.)  Similarly, <code>gzfile</code> connections can read
any of the forms of compression and uncompressed files in any read
mode.
</p>
<p>(The type of compression is determined when the connection is created
if <code>open</code> is unspecified and a file of that name exists.  If the
intention is to open the connection to write a file with a
<em>different</em> form of compression under that name, specify
<code>open = "w"</code> when the connection is created or
<code><a href="#topic+unlink">unlink</a></code> the file before creating the connection.)
</p>
<p>For write-mode connections, <code>compress</code> specifies how hard the
compressor works to minimize the file size, and higher values need
more CPU time and more working memory (up to ca 800Mb for
<code>xzfile(compress = 9)</code>).  For <code>xzfile</code> negative values of
<code>compress</code> correspond to adding the <code>xz</code> argument
<span class="option">-e</span>: this takes more time (double?) to compress but may
achieve (slightly) better compression.  The default (<code>6</code>) has
good compression and modest (100Mb memory) usage: but if you are using
<code>xz</code> compression you are probably looking for high compression.
</p>
<p>Choosing the type of compression involves tradeoffs: <code>gzip</code>,
<code>bzip2</code> and <code>xz</code> are successively less widely supported,
need more resources for both compression and decompression, and
achieve more compression (although individual files may buck the
general trend).  Typical experience is that <code>bzip2</code> compression
is 15% better on text files than <code>gzip</code> compression, and
<code>xz</code> with maximal compression 30% better.  The experience with
<span class="rlang"><b>R</b></span> <code><a href="#topic+save">save</a></code> files is similar, but on some large &lsquo;<span class="file">.rda</span>&rsquo;
files <code>xz</code> compression is much better than the other two.  With
current computers decompression times even with <code>compress = 9</code>
are typically modest and reading compressed files is usually faster
than uncompressed ones because of the reduction in disc activity.
</p>


<h3>Encoding</h3>

<p>The encoding of the input/output stream of a connection can be
specified by name in the same way as it would be given to
<code><a href="#topic+iconv">iconv</a></code>: see that help page for how to find out what
encoding names are recognized on your platform.  Additionally,
<code>""</code> and <code>"native.enc"</code> both mean the &lsquo;native&rsquo;
encoding, that is the internal encoding of the current locale and
hence no translation is done.
</p>
<p>When writing to a text connection, the connections code always assumes its
input is in native encoding, so e.g.  <code><a href="#topic+writeLines">writeLines</a></code> has to
convert text to native encoding.  The native encoding is UTF-8 on most
systems (since R 4.2 also on recent Windows) and can represent all
characters.  <code><a href="#topic+writeLines">writeLines</a></code> does not do the conversion when
<code>useBytes=TRUE</code> (for expert use only, only useful on systems with native
encoding other than UTF-8), but the connections code still behaves as if
the text was in native encoding, so any attempt to convert encoding
(<code>encoding</code> argument other than <code>""</code> and <code>"native.enc"</code>) in
connections will produce incorrect results.
</p>
<p>When reading from a text connection, the connections code re-encodes the
input to native encoding (from the encoding given by the <code>encoding</code>
argument).  On systems where UTF-8 is not the native encoding, one can
read text not representable in the native encoding using
<code><a href="#topic+readLines">readLines</a></code> and <code><a href="#topic+scan">scan</a></code> by providing them with an
unopened connection that has been created with the <code>encoding</code>
argument specifying the input encoding.  <code><a href="#topic+readLines">readLines</a></code> and
<code><a href="#topic+scan">scan</a></code> would then instruct the connections code to convert the
text to UTF-8 (instead of native encoding) and they will return it marked
(aka declared, see <code><a href="#topic+Encoding">Encoding</a></code>)
as <code>"UTF-8"</code>.  Finally and for expert use only, one may disable
re-encoding of input by specifying <code>""</code> or <code>"native.enc"</code> as
<code>encoding</code> for the connection, but then mark the text as being
<code>"UTF-8"</code> or <code>"latin1"</code> via the <code>encoding</code> argument
of <code><a href="#topic+readLines">readLines</a></code> and <code><a href="#topic+scan">scan</a></code>.
</p>
<p>Re-encoding only works for connections in text mode: reading from a
connection with re-encoding specified in binary mode will read the
stream of bytes, but mixing text and binary mode reads (e.g., mixing
calls to <code><a href="#topic+readLines">readLines</a></code> and <code><a href="#topic+readChar">readChar</a></code>) is likely
to lead to incorrect results.
</p>
<p>The encodings <code>"UCS-2LE"</code> and <code>"UTF-16LE"</code> are treated
specially, as they are appropriate values for Windows &lsquo;Unicode&rsquo;
text files.  If the first two bytes are the Byte Order Mark
<code>0xFEFF</code> then these are removed as some implementations of
<code><a href="#topic+iconv">iconv</a></code> do not accept <abbr>BOM</abbr>s.  Note that whereas most
implementations will handle <abbr>BOM</abbr>s using encoding <code>"UCS-2"</code> and
choose the appropriate byte order, some (including earlier versions of
<code>glibc</code>) will not.  There is a subtle distinction between
<code>"UTF-16"</code> and <code>"UCS-2"</code> (see
<a href="https://en.wikipedia.org/wiki/UTF-16">https://en.wikipedia.org/wiki/UTF-16</a>): the use of characters in
the &lsquo;Supplementary Planes&rsquo; which need surrogate pairs is very
rare so <code>"UCS-2LE"</code> is an appropriate first choice (as it is more
widely implemented).
</p>
<p>The encoding <code>"UTF-8-BOM"</code> is accepted for reading and will
remove a Byte Order Mark if present (which it often is for files and
webpages generated by Microsoft applications).  If a <abbr>BOM</abbr> is required
(it is not recommended) when writing it should be written explicitly,
e.g. by <code>writeChar("\ufeff", con, eos = NULL)</code> or
<code>writeBin(as.raw(c(0xef, 0xbb, 0xbf)), binary_con)</code>
</p>
<p>Encoding names <code>"utf8"</code>, <code>"mac"</code> and <code>"macroman"</code> are
not portable, and not supported on all current <span class="rlang"><b>R</b></span> platforms.
<code>"UTF-8"</code> is portable and <code>"macintosh"</code> is the official (and
most widely supported) name for &lsquo;Mac Roman&rsquo;.  (<span class="rlang"><b>R</b></span> maps
<code>"utf8"</code> to <code>"UTF-8"</code> internally.)
</p>
<p>Requesting a conversion that is not supported is an error, reported
when the connection is opened.  Exactly what happens when the
requested translation cannot be done for invalid input is in general
undocumented.  On output the result is likely to be that up to the
error, with a warning.  On input, it will most likely be all or some
of the input up to the error.
</p>
<p>It may be possible to deduce the current native encoding from
<code><a href="#topic+Sys.getlocale">Sys.getlocale</a>("LC_CTYPE")</code>, but not all OSes record it.
</p>


<h3>Blocking</h3>

<p>Whether or not the connection blocks can be specified for file, url
(default yes), fifo and socket connections (default not).
</p>
<p>In blocking mode, functions using the connection do not return to the
<span class="rlang"><b>R</b></span> evaluator until the read/write is complete.  In non-blocking mode,
operations return as soon as possible, so on input they will return
with whatever input is available (possibly none) and for output they
will return whether or not the write succeeded.
</p>
<p>The function <code><a href="#topic+readLines">readLines</a></code> behaves differently in respect of
incomplete last lines in the two modes: see its help page.
</p>
<p>Even when a connection is in blocking mode, attempts are made to
ensure that it does not block the event loop and hence the operation
of GUI parts of <span class="rlang"><b>R</b></span>.  These do not always succeed, and the whole <span class="rlang"><b>R</b></span>
process will be blocked during a <abbr>DNS</abbr> lookup on Unix, for example.
</p>
<p>Most blocking operations on HTTP/FTP URLs and on sockets are subject to the
timeout set by <code>options("timeout")</code>.  Note that this is a timeout
for no response, not for the whole operation.  The timeout is set at
the time the connection is opened (more precisely, when the last
connection of that type &ndash; &lsquo;<span class="samp">&#8288;http:&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;ftp:&#8288;</span>&rsquo; or socket &ndash; was
opened).
</p>


<h3>Fifos</h3>

<p>Fifos default to non-blocking.  That follows S version 4 and is
probably most natural, but it does have some implications.  In
particular, opening a non-blocking fifo connection for writing (only)
will fail unless some other process is reading on the fifo.
</p>
<p>Opening a fifo for both reading and writing (in any mode: one can only
append to fifos) connects both sides of the fifo to the <span class="rlang"><b>R</b></span> process,
and provides an similar facility to <code>file()</code>.
</p>


<h3>Clipboard</h3>

<p><code>file</code> can be used with <code>description = "clipboard"</code>
in mode <code>"r"</code> only.  This reads the X11 primary selection (see
<a href="https://specifications.freedesktop.org/clipboards-spec/clipboards-latest.txt">https://specifications.freedesktop.org/clipboards-spec/clipboards-latest.txt</a>),
which can also be specified as <code>"X11_primary"</code> and the secondary
selection as <code>"X11_secondary"</code>.  On most systems the clipboard
selection (that used by &lsquo;Copy&rsquo; from an &lsquo;Edit&rsquo; menu) can
be specified as <code>"X11_clipboard"</code>.
</p>
<p>When a clipboard is opened for reading, the contents are immediately
copied to internal storage in the connection.
</p>
<p>Unix users wishing to <em>write</em> to one of the X11 selections may be
able to do so via <code>xclip</code>
(<a href="https://github.com/astrand/xclip">https://github.com/astrand/xclip</a>) or <code>xsel</code>
(<a href="https://www.vergenet.net/~conrad/software/xsel/">https://www.vergenet.net/~conrad/software/xsel/</a>), for example by
<code>pipe("xclip -i", "w")</code> for the primary selection.
</p>
<p>macOS users can use <code>pipe("pbpaste")</code> and
<code>pipe("pbcopy", "w")</code> to read from and write to that system's
clipboard.
</p>


<h3>File paths</h3>

<p>In most cases these are translated to the native encoding.
</p>
<p>The exceptions are <code>file</code> and <code>pipe</code> on Windows, where a
<code>description</code> which is marked as being in UTF-8 is passed to
Windows as a &lsquo;wide&rsquo; character string.  This allows files with
names not in the native encoding to be opened on file systems which
use Unicode file names (such as <abbr>NTFS</abbr> but not FAT32).
</p>


<h3>&lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo; URLs</h3>

<p>Most modern browsers do not support such URLs, and &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo;
ones are much preferred for use in <span class="rlang"><b>R</b></span>.
</p>
<p>It is intended that <span class="rlang"><b>R</b></span> will continue to allow such URLs for as long as
<code>libcurl</code> does, but as they become rarer this is increasingly
untested.   What &lsquo;protocols&rsquo; the version of <code>libcurl</code>
being used supports can be seen by calling <code><a href="#topic+libcurlVersion">libcurlVersion</a>()</code>.
</p>


<h3>Number of connections</h3>

<p>There is a limit on the number of connections which can be allocated
(not necessarily open) at any one time.  It is good practice to close
connections when finished with, but if necessary garbage-collection
will be invoked to close those connections without any <span class="rlang"><b>R</b></span> object
referring to them.
</p>
<p>The default limit is 128 (including the three terminal connections,
<code>stdin</code>, <code>stdout</code> and <code>stderr</code>).  This can be increased
when <span class="rlang"><b>R</b></span> is started using the option <span class="option">--max-connections=N</span>, where
the maximum allowed value is 4096.
</p>
<p>However, many types of connections use other resources which are
themselves limited.  Notably on Unix, &lsquo;file descriptors&rsquo; which
by default are per-process limited: this limits the number of
connections using files, pipes and fifos.  (The default limit is 256
on macOS (and Solaris) but 1024 on Linux.  The limit can be raised in the
shell used to launch <span class="rlang"><b>R</b></span>, for example by <code>ulimit -n</code>.)  File
descriptors are used for many other purposes including dynamically
loading <abbr>DSO</abbr>/DLLs (see <code><a href="#topic+dyn.load">dyn.load</a></code>) which may use up to 60%
of the limit.
</p>
<p>Windows has a default limit of 512 open C file streams: these are used
by at least <code>file</code>, <code>gzfile</code>, <code>bzfile</code>, <code>xzfile</code>,
<code>pipe</code>, <code>url</code> and <code>unz</code> connections applied to files
(rather than URLs).

</p>
<p>Package <span class="pkg">parallel</span>'s <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> uses socket
connections to communicate with the worker processes, one per worker.
</p>


<h3>Note</h3>

<p><span class="rlang"><b>R</b></span>'s connections are modelled on those in S version 4 (see Chambers,
1998).  However <span class="rlang"><b>R</b></span> goes well beyond the S model, for example in output
text connections and URL, compressed and socket connections.
The default open mode in <span class="rlang"><b>R</b></span> is <code>"r"</code> except for socket connections.
This differs from S, where it is the equivalent of <code>"r+"</code>,
known as <code>"*"</code>.
</p>
<p>On (historic) platforms where <code>vsnprintf</code> does not return the needed
length of output there is a 100,000 byte output limit on the length of
a line for text output on <code>fifo</code>, <code>gzfile</code>, <code>bzfile</code> and
<code>xzfile</code> connections: longer lines will be truncated with a
warning.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language.</em> Springer.
</p>
<p>Ripley, B. D. (2001).
&ldquo;Connections.&rdquo;
<em>R News</em>, <b>1</b>(1), 16&ndash;7.
<a href="https://www.r-project.org/doc/Rnews/Rnews_2001-1.pdf">https://www.r-project.org/doc/Rnews/Rnews_2001-1.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+textConnection">textConnection</a></code>, <code><a href="#topic+seek">seek</a></code>,
<code><a href="#topic+showConnections">showConnections</a></code>, <code><a href="#topic+pushBack">pushBack</a></code>.
</p>
<p>Functions making direct use of connections are (text-mode)
<code><a href="#topic+readLines">readLines</a></code>, <code><a href="#topic+writeLines">writeLines</a></code>, <code><a href="#topic+cat">cat</a></code>,
<code><a href="#topic+sink">sink</a></code>, <code><a href="#topic+scan">scan</a></code>, <code><a href="#topic+parse">parse</a></code>,
<code><a href="#topic+read.dcf">read.dcf</a></code>, <code><a href="#topic+dput">dput</a></code>, <code><a href="#topic+dump">dump</a></code> and
(binary-mode) <code><a href="#topic+readBin">readBin</a></code>, <code><a href="#topic+readChar">readChar</a></code>,
<code><a href="#topic+writeBin">writeBin</a></code>, <code><a href="#topic+writeChar">writeChar</a></code>, <code><a href="#topic+load">load</a></code>
and <code><a href="#topic+save">save</a></code>.
</p>
<p><code><a href="#topic+capabilities">capabilities</a></code> to see if <code>fifo</code> connections are
supported by this build of <span class="rlang"><b>R</b></span>.
</p>
<p><code><a href="#topic+gzcon">gzcon</a></code> to wrap <code>gzip</code> (de)compression around a
connection.
</p>
<p><code><a href="#topic+options">options</a></code> <code>HTTPUserAgent</code>, <code>internet.info</code> and
<code>timeout</code> are used by some of the methods for URL connections.
</p>
<p><code><a href="#topic+memCompress">memCompress</a></code> for more ways to (de)compress and references
on data compression.
</p>
<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for the versions of the <code>zlib</code> (for
<code>gzfile</code>), <code>bzip2</code> and <code>xz</code> libraries in use.
</p>
<p>To flush output to the Windows and macOS consoles, see
<code><a href="utils.html#topic+flush.console">flush.console</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zzfil &lt;- tempfile(fileext=".data")
zz &lt;- file(zzfil, "w")  # open an output file connection
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = zz, sep = "\n")
cat("One more line\n", file = zz)
close(zz)
readLines(zzfil)
unlink(zzfil)

zzfil &lt;- tempfile(fileext=".gz")
zz &lt;- gzfile(zzfil, "w")  # compressed file
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = zz, sep = "\n")
close(zz)
readLines(zz &lt;- gzfile(zzfil))
close(zz)
unlink(zzfil)
zz # an invalid connection

zzfil &lt;- tempfile(fileext=".bz2")
zz &lt;- bzfile(zzfil, "w")  # bzip2-ed file
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = zz, sep = "\n")
close(zz)
zz # print() method: invalid connection
print(readLines(zz &lt;- bzfile(zzfil)))
close(zz)
unlink(zzfil)

## An example of a file open for reading and writing
Tpath &lt;- tempfile("test")
Tfile &lt;- file(Tpath, "w+")
c(isOpen(Tfile, "r"), isOpen(Tfile, "w")) # both TRUE
cat("abc\ndef\n", file = Tfile)
readLines(Tfile)
seek(Tfile, 0, rw = "r") # reset to beginning
readLines(Tfile)
cat("ghi\n", file = Tfile)
readLines(Tfile)

Tfile # -&gt; print() :  "valid" connection
close(Tfile)
Tfile # -&gt; print() :  "invalid" connection
unlink(Tpath)

## We can do the same thing with an anonymous file.
Tfile &lt;- file()
cat("abc\ndef\n", file = Tfile)
readLines(Tfile)
close(Tfile)

## Not run: ## fifo example -- may hang even with OS support for fifos
if(capabilities("fifo")) {
  zzfil &lt;- tempfile(fileext="-fifo")
  zz &lt;- fifo(zzfil, "w+")
  writeLines("abc", zz)
  print(readLines(zz))
  close(zz)
  unlink(zzfil)
}
## End(Not run)

## Unix examples of use of pipes

# read listing of current directory
readLines(pipe("ls -1"))

# remove trailing commas.  Suppose

## Not run: % cat data2_
450, 390, 467, 654,  30, 542, 334, 432, 421,
357, 497, 493, 550, 549, 467, 575, 578, 342,
446, 547, 534, 495, 979, 479
## End(Not run)
# Then read this by
scan(pipe("sed -e s/,$// data2_"), sep = ",")


# convert decimal point to comma in output: see also write.table
# both R strings and (probably) the shell need \ doubled
zzfil &lt;- tempfile("outfile")
zz &lt;- pipe(paste("sed s/\\\\./,/ &gt;", zzfil), "w")
cat(format(round(stats::rnorm(48), 4)), fill = 70, file = zz)
close(zz)
file.show(zzfil, delete.file = TRUE)

## Not run: 
## example for a machine running a finger daemon

con &lt;- socketConnection(port = 79, blocking = TRUE)
writeLines(paste0(system("whoami", intern = TRUE), "\r"), con)
gsub(" *$", "", readLines(con))
close(con)

## End(Not run)

## Not run: 
## Two R processes communicating via non-blocking sockets
# R process 1
con1 &lt;- socketConnection(port = 6011, server = TRUE)
writeLines(LETTERS, con1)
close(con1)

# R process 2
con2 &lt;- socketConnection(Sys.info()["nodename"], port = 6011)
# as non-blocking, may need to loop for input
readLines(con2)
while(isIncomplete(con2)) {
   Sys.sleep(1)
   z &lt;- readLines(con2)
   if(length(z)) print(z)
}
close(con2)

## examples of use of encodings
# write a file in UTF-8
cat(x, file = (con &lt;- file("foo", "w", encoding = "UTF-8"))); close(con)
# read a 'Windows Unicode' file
A &lt;- read.table(con &lt;- file("students", encoding = "UCS-2LE")); close(con)

## End(Not run)</code></pre>

<hr>
<h2 id='Constants'>Built-in Constants</h2><span id='topic+Constants'></span><span id='topic+LETTERS'></span><span id='topic+letters'></span><span id='topic+month.abb'></span><span id='topic+month.name'></span><span id='topic+pi'></span>

<h3>Description</h3>

<p>Constants built into <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LETTERS
letters
month.abb
month.name
pi
</code></pre>


<h3>Details</h3>

<p><span class="rlang"><b>R</b></span> has a small number of built-in constants.
</p>
<p>The following constants are available:
</p>

<ul>
<li> <p><code>LETTERS</code>: the 26 upper-case letters of the Roman
alphabet;
</p>
</li>
<li> <p><code>letters</code>: the 26 lower-case letters of the Roman
alphabet;
</p>
</li>
<li> <p><code>month.abb</code>: the three-letter abbreviations for the
English month names;
</p>
</li>
<li> <p><code>month.name</code>: the English names for the months of the
year;
</p>
</li>
<li> <p><code>pi</code>: the ratio of the circumference of a circle to its
diameter.
</p>
</li></ul>

<p>These are implemented as variables in the base namespace taking
appropriate values.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+data">data</a></code>, <code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code>.
</p>
<p><code><a href="#topic+Quotes">Quotes</a></code> for the parsing of character constants,
<code><a href="#topic+NumericConstants">NumericConstants</a></code> for numeric constants.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## John Machin (ca 1706) computed pi to over 100 decimal places
## using the Taylor series expansion of the second term of
pi - 4*(4*atan(1/5) - atan(1/239))

## months in English
month.name
## months in your current locale
format(ISOdate(2000, 1:12, 1), "%B")
format(ISOdate(2000, 1:12, 1), "%b")
</code></pre>

<hr>
<h2 id='contributors'>R Project Contributors</h2><span id='topic+contributors'></span>

<h3>Description</h3>

<p>The <span class="rlang"><b>R</b></span> Who-is-who, describing who made significant contributions to
the development of <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contributors()
</code></pre>

<hr>
<h2 id='Control'>Control Flow</h2><span id='topic+Control'></span><span id='topic+if'></span><span id='topic+else'></span><span id='topic+for'></span><span id='topic+in'></span><span id='topic+while'></span><span id='topic+repeat'></span><span id='topic+break'></span><span id='topic+next'></span><span id='topic++25+7C+7C+25'></span>

<h3>Description</h3>

<p>These are the basic control-flow constructs of the <span class="rlang"><b>R</b></span> language.  They
function in much the same way as control statements in any Algol-like
language.  They are all <a href="#topic+reserved">reserved</a> words.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>if(cond) expr
if(cond) cons.expr  else  alt.expr

for(var in seq) expr
while(cond) expr
repeat expr
break
next

x %||% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Control_+3A_cond">cond</code></td>
<td>
<p>A length-one logical vector that is not <code>NA</code>.
Other types are coerced to logical if possible, ignoring any class.
(Conditions of length greater than one are an error.)
</p>
</td></tr>
<tr><td><code id="Control_+3A_var">var</code></td>
<td>
<p>A syntactical name for a variable.</p>
</td></tr>
<tr><td><code id="Control_+3A_seq">seq</code></td>
<td>
<p>An expression evaluating to a vector (including a list and
an <a href="#topic+expression">expression</a>) or to a <a href="#topic+pairlist">pairlist</a> or <code>NULL</code>.  A
factor value will be coerced to a character vector.  This can be a
long vector.</p>
</td></tr>
<tr><td><code id="Control_+3A_expr">expr</code>, <code id="Control_+3A_cons.expr">cons.expr</code>, <code id="Control_+3A_alt.expr">alt.expr</code>, <code id="Control_+3A_x">x</code>, <code id="Control_+3A_y">y</code></td>
<td>

<p>An <em>expression</em> in a formal sense.  This is either a
simple expression or a so-called <em>compound expression</em>, usually
of the form <code>{ expr1 ; expr2 }</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>break</code> breaks out of a <code>for</code>, <code>while</code> or <code>repeat</code>
loop; control is transferred to the first statement outside the
inner-most loop. <code>next</code> halts the processing of the current
iteration and advances the looping index.  Both <code>break</code> and
<code>next</code> apply only to the innermost of nested loops.
</p>
<p>Note that it is a common mistake to forget to put braces (<code>{ .. }</code>)
around your statements, e.g., after <code>if(..)</code> or <code>for(....)</code>.
In particular, you should not have a newline between <code>}</code> and
<code>else</code> to avoid a syntax error in entering a <code>if ... else</code>
construct at the keyboard or via <code>source</code>.
For that reason, one (somewhat extreme) attitude of defensive programming
is to always use braces, e.g., for <code>if</code> clauses.
</p>
<p>The <code>seq</code> in a <code>for</code> loop is evaluated at the start of
the loop; changing it subsequently does not affect the loop.  If
<code>seq</code> has length zero the body of the loop is skipped. Otherwise the
variable <code>var</code> is assigned in turn the value of each element of
<code>seq</code>. You can assign to <code>var</code> within the body of the loop,
but this will not affect the next iteration.  When the loop terminates,
<code>var</code> remains as a variable containing its latest value.
</p>
<p>The null coalescing operator <code>%||%</code> is a simple 1-line function:
<code>x %||% y</code> is an idiomatic way to call
</p>
<pre>
    if (is.null(x)) y else x
                             # or equivalently, of course,
    if(!is.null(x)) x else y </pre>
<p>Inspired by Ruby, it was first proposed by Hadley Wickham.
</p>


<h3>Value</h3>

<p><code>if</code> returns the value of the expression evaluated, or
<code>NULL</code> invisibly if none was (which may happen if there is no
<code>else</code>).
</p>
<p><code>for</code>, <code>while</code> and <code>repeat</code> return <code>NULL</code> invisibly.
<code>for</code> sets <code>var</code> to the last used element of <code>seq</code>,
or to <code>NULL</code> if it was of length zero.
</p>
<p><code>break</code> and <code>next</code> do not return a value as they transfer
control within the loop.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Syntax">Syntax</a></code> for the basic <span class="rlang"><b>R</b></span> syntax and operators,
<code><a href="#topic+Paren">Paren</a></code> for parentheses and braces.
</p>
<p><code><a href="#topic+ifelse">ifelse</a></code>, <code><a href="#topic+switch">switch</a></code> for other ways to control flow.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for(i in 1:5) print(1:i)
for(n in c(2,5,10,20,50)) {
   x &lt;- stats::rnorm(n)
   cat(n, ": ", sum(x^2), "\n", sep = "")
}
f &lt;- factor(sample(letters[1:5], 10, replace = TRUE))
for(i in unique(f)) print(i)

res &lt;- {}
res %||% "alternative result"
x &lt;- head(x) %||% stop("parsed, but *not* evaluated..")

res &lt;- if(sum(x) &gt; 7.5) mean(x) # may be NULL
res %||% "sum(x) &lt;= 7.5"
</code></pre>

<hr>
<h2 id='copyright'>Copyrights of Files Used to Build R</h2><span id='topic+copyright'></span><span id='topic+copyrights'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> is released under the &lsquo;GNU Public License&rsquo;: see
<code><a href="#topic+license">license</a></code> for details.  The license describes your right
to use <span class="rlang"><b>R</b></span>.  Copyright is concerned with ownership of intellectual
rights, and some of the software used has conditions that the
copyright must be explicitly stated: see the &lsquo;Details&rsquo; section.  We
are grateful to these people and other contributors (see
<code><a href="#topic+contributors">contributors</a></code>) for the ability to use their work.
</p>


<h3>Details</h3>

<p>The file &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/COPYRIGHTS</span>&rsquo; lists the copyrights in full
detail.
</p>

<hr>
<h2 id='crossprod'>Matrix Cross-Product</h2><span id='topic+crossprod'></span><span id='topic+tcrossprod'></span>

<h3>Description</h3>

<p>Given matrices <code>x</code> and <code>y</code> as arguments, return a matrix
cross-product.  This is formally equivalent to (but faster than) the call
<code>t(x) %*% y</code> (<code>crossprod</code>) or
<code>x %*% t(y)</code> (<code>tcrossprod</code>).
</p>
<p>These are generic functions since <span class="rlang"><b>R</b></span> 4.4.0: methods can be written
individually or via the <code><a href="#topic+S3groupGeneric">matOps</a></code> group
generic function; it dispatches to S3 and S4 methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> crossprod(x, y = NULL, ...)
tcrossprod(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossprod_+3A_x">x</code>, <code id="crossprod_+3A_y">y</code></td>
<td>
<p>numeric or complex matrices (or vectors): <code>y = NULL</code>
is taken to be the same matrix as <code>x</code>.  Vectors are promoted to
single-column or single-row matrices, depending on the context.</p>
</td></tr>
<tr><td><code id="crossprod_+3A_...">...</code></td>
<td>
<p>potential further arguments for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A double or complex matrix, with appropriate <code>dimnames</code> taken
from <code>x</code> and <code>y</code>.
</p>


<h3>Note</h3>

<p>When <code>x</code> or <code>y</code> are not matrices, they are treated as column or
row matrices, but their <code><a href="#topic+names">names</a></code> are usually <b>not</b>
promoted to <code><a href="#topic+dimnames">dimnames</a></code>.  Hence, currently, the last
example has empty dimnames.
</p>
<p>In the same situation, these matrix products (also <code><a href="#topic++25+2A+25">%*%</a></code>)
are more flexible in promotion of vectors to row or column matrices, such
that more cases are allowed, since <span class="rlang"><b>R</b></span> 3.2.0.
</p>
<p>The propagation of <code>NaN</code>/<code>Inf</code> values, precision, and performance of matrix
products can be controlled by <code><a href="#topic+options">options</a>("matprod")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++25+2A+25">%*%</a></code> and outer product <code><a href="#topic++25o+25">%o%</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(z &lt;- crossprod(1:4))    # = sum(1 + 2^2 + 3^2 + 4^2)
drop(z)                  # scalar
x &lt;- 1:4; names(x) &lt;- letters[1:4]; x
tcrossprod(as.matrix(x)) # is
identical(tcrossprod(as.matrix(x)),
          crossprod(t(x)))
tcrossprod(x)            # no dimnames

m &lt;- matrix(1:6, 2,3) ; v &lt;- 1:3; v2 &lt;- 2:1
stopifnot(identical(tcrossprod(v, m), v %*% t(m)),
          identical(tcrossprod(v, m), crossprod(v, t(m))),
          identical(crossprod(m, v2), t(m) %*% v2))
</code></pre>

<hr>
<h2 id='Cstack_info'>Report Information on C Stack Size and Usage</h2><span id='topic+Cstack_info'></span>

<h3>Description</h3>

<p>Report information on the C stack size and usage (if available).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cstack_info()
</code></pre>


<h3>Details</h3>

<p>On most platforms, C stack information is recorded when <span class="rlang"><b>R</b></span> is
initialized and used for stack-checking.  If this information is
unavailable, the <code>size</code> will be returned as <code>NA</code>, and
stack-checking is not performed.
</p>

<p>The information on the stack base address is thought to be accurate on
Windows, Linux (using <code>glibc</code>), macOS and FreeBSD but a heuristic
is used on other platforms.  Because this might be slightly
inaccurate, the current usage could be estimated as negative.  (The
heuristic is not used on embedded uses of <span class="rlang"><b>R</b></span> on platforms where the
stack base information is not thought to be accurate.)
</p>
<p>The &lsquo;evaluation depth&rsquo; is the number of nested <span class="rlang"><b>R</b></span> expressions
currently under evaluation: this has a limit controlled by
<code><a href="#topic+options">options</a>("expressions")</code>.
</p>


<h3>Value</h3>

<p>An integer vector.  This has named elements
</p>
<table>
<tr><td><code>size</code></td>
<td>
<p>The size of the stack (in bytes), or <code>NA</code> if unknown.</p>
</td></tr>
<tr><td><code>current</code></td>
<td>
<p>The estimated current usage (in bytes), possibly <code>NA</code>.</p>
</td></tr>
<tr><td><code>direction</code></td>
<td>
<p><code>1</code> (stack grows down, the usual case) or
<code>-1</code> (stack grows up).</p>
</td></tr>
<tr><td><code>eval_depth</code></td>
<td>
<p>The current evaluation depth (including two calls
for the call to <code>Cstack_info</code>).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
Cstack_info()
</code></pre>

<hr>
<h2 id='cumsum'>Cumulative Sums, Products, and Extremes</h2><span id='topic+cumsum'></span><span id='topic+cumprod'></span><span id='topic+cummin'></span><span id='topic+cummax'></span>

<h3>Description</h3>

<p>Returns a vector whose elements are the cumulative sums, products,
minima or maxima of the elements of the argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsum(x)
cumprod(x)
cummax(x)
cummin(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumsum_+3A_x">x</code></td>
<td>
<p>a numeric or complex (not <code>cummin</code> or <code>cummax</code>)
object, or an object that can be coerced to one of these.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are generic functions: methods can be defined for them
individually or via the <code><a href="#topic+S3groupGeneric">Math</a></code> group generic.
</p>


<h3>Value</h3>

<p>A vector of the same length and type as <code>x</code> (after coercion),
except that <code>cumprod</code> returns a numeric vector for integer input
(for consistency with <code>*</code>).  Names are preserved.
</p>
<p>An <code>NA</code> value in <code>x</code> causes the corresponding and following
elements of the return value to be <code>NA</code>, as does integer overflow
in <code>cumsum</code> (with a warning).
In the complex case with <code><a href="#topic+NA">NA</a></code>s, these <code>NA</code> elements may
have finite real or imaginary parts, notably for <code>cumsum()</code>,
fulfilling the identity <code>Im(cumsum(x))</code> <code class="reqn">\equiv</code> <code>cumsum(Im(x))</code>.
</p>


<h3>S4 methods</h3>

<p><code>cumsum</code> and <code>cumprod</code> are S4 generic functions:
methods can be defined for them individually or via the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.
<code>cummax</code> and <code>cummin</code> are individually S4 generic functions.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole. (<code>cumsum</code> only.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cumsum(1:10)
cumprod(1:10)
cummin(c(3:1, 2:0, 4:2))
cummax(c(3:1, 2:0, 4:2))
</code></pre>

<hr>
<h2 id='curlGetHeaders'>
Retrieve Headers from URLs
</h2><span id='topic+curlGetHeaders'></span>

<h3>Description</h3>

<p>Retrieve the headers for a URL for a supported protocol such as
&lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;ftps://&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curlGetHeaders(url, redirect = TRUE, verify = TRUE,
               timeout = 0L, TLS = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="curlGetHeaders_+3A_url">url</code></td>
<td>
<p>character string specifying the URL.</p>
</td></tr>
<tr><td><code id="curlGetHeaders_+3A_redirect">redirect</code></td>
<td>
<p>logical: should redirections be followed?</p>
</td></tr>
<tr><td><code id="curlGetHeaders_+3A_verify">verify</code></td>
<td>
<p>logical: should certificates be verified as valid
and applying to that host?</p>
</td></tr>
<tr><td><code id="curlGetHeaders_+3A_timeout">timeout</code></td>
<td>
<p>integer: the maximum time in seconds the request is
allowed to take.  Non-positive and invalid values are ignored
(including the default).  (Added in <span class="rlang"><b>R</b></span> 4.1.0.)</p>
</td></tr>
<tr><td><code id="curlGetHeaders_+3A_tls">TLS</code></td>
<td>
<p>character: the minimum version of the <abbr>TLS</abbr> protocol to be used
for &lsquo;<span class="samp">&#8288;https://&#8288;</span>&rsquo; URLs: the default (<code>""</code>) is no restriction
beyond that of the underlying <code>libcurl</code> (usually 1.0).  Other
valid values are <code>"1.1"</code>, <code>"1.2"</code> (both for <code>libcurl</code>
7.34.0 and later)  and <code>"1.3"</code> (7.52.0 and later), if supported
by the underlying version of <code>libcurl</code> and the <abbr>SSL</abbr> library it uses.</p>
</td></tr>


</table>


<h3>Details</h3>

<p>This reports what <code>curl -I -L</code> or <code>curl -I</code> would
report.  For a &lsquo;<span class="samp">&#8288;ftp://&#8288;</span>&rsquo; URL the &lsquo;headers&rsquo; are a record of
the conversation between client and server before data transfer.
</p>
<p>Only 500 header lines will be reported: there is a limit of 20
redirections so this should suffice (and even 20 would indicate
problems).
</p>
<p>If argument <code>timeout</code> is not set to a positive integer this uses
<code><a href="#topic+getOption">getOption</a>("timeout")</code> which defaults to 60 seconds.  As
the request cannot be interrupted you may want to consider a shorter
value.
</p>
<p>To see all the details of the interaction with the server(s) set
<code><a href="#topic+options">options</a>(internet.info = 1)</code>.
</p>
<p>HTTP[S] servers are allowed to refuse requests to read the headers and
some do: this will result in a <code>status</code> of <code>405</code>.
</p>
<p>For possible issues with secure URLs (especially on Windows) see
<code><a href="utils.html#topic+download.file">download.file</a></code>.
</p>
<p>There is a security risk in not verifying certificates, but as only
the headers are captured it is slight.  Usually looking at the URL in
a browser will reveal what the problem is (and it may well be
machine-specific).
</p>


<h3>Value</h3>

<p>A character vector with integer attribute <code>"status"</code> (the
last-received &lsquo;status&rsquo; code).  If redirection occurs this will include
the headers for all the URLs visited.
</p>
<p>For the interpretation of &lsquo;status&rsquo; codes see
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">https://en.wikipedia.org/wiki/List_of_HTTP_status_codes</a> and
<a href="https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes">https://en.wikipedia.org/wiki/List_of_FTP_server_return_codes</a>.
A successful FTP connection will usually have status 250, 257 or 350.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capabilities">capabilities</a>("libcurl")</code> to see if this is supported.
<code><a href="#topic+libcurlVersion">libcurlVersion</a></code> for the version of <code>libcurl</code> in use.
</p>
<p><code><a href="#topic+options">options</a></code> <code>HTTPUserAgent</code> and <code>timeout</code> are used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## needs Internet access, results vary
curlGetHeaders("http://bugs.r-project.org")   ## this redirects to https://
## 2023-04: replaces slow and unreliable https://httpbin.org/status/404
curlGetHeaders("https://developer.R-project.org/inet-tests/not-found")
## returns status
</code></pre>

<hr>
<h2 id='cut'>Convert Numeric to Factor</h2><span id='topic+cut'></span><span id='topic+cut.default'></span>

<h3>Description</h3>

<p><code>cut</code> divides the range of <code>x</code> into intervals
and codes the values in <code>x</code> according to which
interval they fall.  The leftmost interval corresponds to level one,
the next leftmost to level two and so on.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut(x, ...)

## Default S3 method:
cut(x, breaks, labels = NULL,
    include.lowest = FALSE, right = TRUE, dig.lab = 3,
    ordered_result = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cut_+3A_x">x</code></td>
<td>
<p>a numeric vector which is to be converted to a factor by cutting.</p>
</td></tr>
<tr><td><code id="cut_+3A_breaks">breaks</code></td>
<td>
<p>either a numeric vector of two or more unique cut points or a
single number (greater than or equal to 2) giving the number of
intervals into which <code>x</code> is to be cut.</p>
</td></tr>
<tr><td><code id="cut_+3A_labels">labels</code></td>
<td>
<p>labels for the levels of the resulting category.  By default,
labels are constructed using <code>"(a,b]"</code> interval notation.  If
<code>labels = FALSE</code>, simple integer codes are returned instead of
a factor.</p>
</td></tr>
<tr><td><code id="cut_+3A_include.lowest">include.lowest</code></td>
<td>
<p>logical, indicating if an &lsquo;x[i]&rsquo; equal to
the lowest (or highest, for <code>right = FALSE</code>) &lsquo;breaks&rsquo;
value should be included.</p>
</td></tr>
<tr><td><code id="cut_+3A_right">right</code></td>
<td>
<p>logical, indicating if the intervals should be closed on
the right (and open on the left) or vice versa.</p>
</td></tr>
<tr><td><code id="cut_+3A_dig.lab">dig.lab</code></td>
<td>
<p>integer which is used when labels are not given.  It
determines the number of digits used in formatting the break numbers.</p>
</td></tr>
<tr><td><code id="cut_+3A_ordered_result">ordered_result</code></td>
<td>
<p>logical: should the result be an ordered factor?</p>
</td></tr>
<tr><td><code id="cut_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>breaks</code> is specified as a single number, the range of the
data is divided into <code>breaks</code> pieces of equal length, and then
the outer limits are moved away by 0.1% of the range to ensure that
the extreme values both fall within the break intervals.  (If <code>x</code>
is a constant vector, equal-length intervals are created, one of
which includes the single value.)
</p>
<p>If a <code>labels</code> parameter is specified, its values are used to name
the factor levels.  If none is specified, the factor level labels are
constructed as <code>"(b1, b2]"</code>, <code>"(b2, b3]"</code> etc. for
<code>right = TRUE</code> and as <code>"[b1, b2)"</code>, ... if <code>right =
    FALSE</code>.
In this case, <code>dig.lab</code> indicates the minimum number of digits
should be used in formatting the numbers <code>b1</code>, <code>b2</code>, ....
A larger value (up to 12) will be used if needed to distinguish
between any pair of endpoints: if this fails labels such as
<code>"Range3"</code> will be used.  Formatting is done by
<code><a href="#topic+formatC">formatC</a></code>.
</p>
<p>The default method will sort a numeric vector of <code>breaks</code>, but
other methods are not required to and <code>labels</code> will correspond to
the intervals after sorting.
</p>
<p>As from <span class="rlang"><b>R</b></span> 3.2.0, <code>getOption("OutDec")</code> is consulted when labels
are constructed for <code>labels = NULL</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+factor">factor</a></code> is returned, unless <code>labels = FALSE</code> which
results in an integer vector of level codes.
</p>
<p>Values which fall outside the range of <code>breaks</code> are coded as
<code>NA</code>, as are <code>NaN</code> and <code>NA</code> values.
</p>


<h3>Note</h3>

<p>Instead of <code>table(cut(x, br))</code>, <code>hist(x, br, plot = FALSE)</code> is
more efficient and less memory hungry.  Instead of <code>cut(*,
    labels = FALSE)</code>, <code><a href="#topic+findInterval">findInterval</a>()</code> is more efficient.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+split">split</a></code> for splitting a variable according to a group factor;
<code><a href="#topic+factor">factor</a></code>, <code><a href="#topic+tabulate">tabulate</a></code>, <code><a href="#topic+table">table</a></code>,
<code><a href="#topic+findInterval">findInterval</a></code>.
</p>
<p><code><a href="stats.html#topic+quantile">quantile</a></code> for ways of choosing breaks of roughly equal
content (rather than length).
</p>
<p><code><a href="#topic+.bincode">.bincode</a></code> for a bare-bones version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z &lt;- stats::rnorm(10000)
table(cut(Z, breaks = -6:6))
sum(table(cut(Z, breaks = -6:6, labels = FALSE)))
sum(graphics::hist(Z, breaks = -6:6, plot = FALSE)$counts)

cut(rep(1,5), 4) #-- dummy
tx0 &lt;- c(9, 4, 6, 5, 3, 10, 5, 3, 5)
x &lt;- rep(0:8, tx0)
stopifnot(table(x) == tx0)

table( cut(x, breaks = 8))
table( cut(x, breaks = 3*(-2:5)))
table( cut(x, breaks = 3*(-2:5), right = FALSE))

##--- some values OUTSIDE the breaks :
table(cx  &lt;- cut(x, breaks = 2*(0:4)))
table(cxl &lt;- cut(x, breaks = 2*(0:4), right = FALSE))
which(is.na(cx));  x[is.na(cx)]  #-- the first 9  values  0
which(is.na(cxl)); x[is.na(cxl)] #-- the last  5  values  8


## Label construction:
y &lt;- stats::rnorm(100)
table(cut(y, breaks = pi/3*(-3:3)))
table(cut(y, breaks = pi/3*(-3:3), dig.lab = 4))

table(cut(y, breaks =  1*(-3:3), dig.lab = 4))
# extra digits don't "harm" here
table(cut(y, breaks =  1*(-3:3), right = FALSE))
#- the same, since no exact INT!

## sometimes the default dig.lab is not enough to be avoid confusion:
aaa &lt;- c(1,2,3,4,5,2,3,4,5,6,7)
cut(aaa, 3)
cut(aaa, 3, dig.lab = 4, ordered_result = TRUE)

## one way to extract the breakpoints
labs &lt;- levels(cut(aaa, 3))
cbind(lower = as.numeric( sub("\\((.+),.*", "\\1", labs) ),
      upper = as.numeric( sub("[^,]*,([^]]*)\\]", "\\1", labs) ))
</code></pre>

<hr>
<h2 id='cut.POSIXt'>Convert a Date or Date-Time Object to a Factor</h2><span id='topic+cut.POSIXt'></span><span id='topic+cut.Date'></span>

<h3>Description</h3>

<p>Method for <code><a href="#topic+cut">cut</a></code> applied to date-time objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXt'
cut(x, breaks, labels = NULL, start.on.monday = TRUE,
    right = FALSE, ...)

## S3 method for class 'Date'
cut(x, breaks, labels = NULL, start.on.monday = TRUE,
    right = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cut.POSIXt_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>"POSIXt"</code> or <code>"Date"</code>.</p>
</td></tr>
<tr><td><code id="cut.POSIXt_+3A_breaks">breaks</code></td>
<td>

<p>a vector of cut points <em>or</em> number giving the number of
intervals which <code>x</code> is to be cut into <em>or</em> an
interval specification, one of <code>"sec"</code>, <code>"min"</code>,
<code>"hour"</code>, <code>"day"</code>, <code>"DSTday"</code>, <code>"week"</code>,
<code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>, optionally
preceded by an integer and a space, or followed by <code>"s"</code>.
(For <code>"Date"</code> objects only interval specifications using
<code>"day"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> and
<code>"year"</code> are allowed.)
</p>
</td></tr>
<tr><td><code id="cut.POSIXt_+3A_labels">labels</code></td>
<td>

<p>labels for the levels of the resulting category.  By default,
labels are constructed from the left-hand end of the intervals
(which are included for the default value of <code>right</code>).  If
<code>labels = FALSE</code>, simple integer codes are returned instead
of a factor.
</p>
</td></tr>
<tr><td><code id="cut.POSIXt_+3A_start.on.monday">start.on.monday</code></td>
<td>
<p>logical.  If <code>breaks = "weeks"</code>, should the
week start on Mondays or Sundays?</p>
</td></tr>
<tr><td><code id="cut.POSIXt_+3A_right">right</code>, <code id="cut.POSIXt_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the default for <code>right</code> differs from the
<a href="#topic+cut.default">default method</a>.  Using <code>include.lowest =
    TRUE</code> will include both ends of the range of dates.
</p>
<p>Using <code>breaks = "quarter"</code> will create intervals of 3 calendar
months, with the intervals beginning on January 1, April 1,
July 1 or October 1 (based upon <code>min(x)</code>) as appropriate.
</p>
<p>A vector of <code>breaks</code> will be sorted before use: <code>labels</code> should
correspond to the sorted vector.
</p>


<h3>Value</h3>

<p>A factor is returned, unless <code>labels = FALSE</code> which returns
the integer level codes.
</p>
<p>Values which fall outside the range of <code>breaks</code> are coded as
<code>NA</code>, as are and <code>NA</code> values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seq.POSIXt">seq.POSIXt</a></code>, <code><a href="#topic+seq.Date">seq.Date</a></code>, <code><a href="#topic+cut">cut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## random dates in a 10-week period
cut(ISOdate(2001, 1, 1) + 70*86400*stats::runif(100), "weeks")
cut(as.Date("2001/1/1") + 70*stats::runif(100), "weeks")

# The standards all have midnight as the start of the day, but some
# people incorrectly interpret it at the end of the previous day ...
tm &lt;- seq(as.POSIXct("2012-06-01 06:00"), by = "6 hours", length.out = 24)
aggregate(1:24, list(day = cut(tm, "days")), mean)
# and a version with midnight included in the previous day:
aggregate(1:24, list(day = cut(tm, "days", right = TRUE)), mean)
</code></pre>

<hr>
<h2 id='data.class'>Object Classes</h2><span id='topic+data.class'></span>

<h3>Description</h3>

<p>Determine the class of an arbitrary <span class="rlang"><b>R</b></span> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.class(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.class_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character string giving the <em>class</em> of <code>x</code>.
</p>
<p>The class is the (first element) of the <code><a href="#topic+class">class</a></code>
attribute if this is non-<code>NULL</code>, or inferred from the object's
<code>dim</code> attribute if this is non-<code>NULL</code>, or <code>mode(x)</code>.
</p>
<p>Simply speaking, <code>data.class(x)</code> returns what is typically useful
for method dispatching.  (Or, what the basic creator functions already
and maybe eventually all will attach as a class attribute.)
</p>


<h3>Note</h3>

<p>For compatibility reasons, there is one exception to the rule above:
When <code>x</code> is <code><a href="#topic+integer">integer</a></code>, the result of
<code>data.class(x)</code> is <code>"numeric"</code> even when <code>x</code> is classed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+class">class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- LETTERS
data.class(factor(x))                 # has a class attribute
data.class(matrix(x, ncol = 13))      # has a dim attribute
data.class(list(x))                   # the same as mode(x)
data.class(x)                         # the same as mode(x)

stopifnot(data.class(1:2) == "numeric") # compatibility "rule"
</code></pre>

<hr>
<h2 id='data.frame'>Data Frames</h2><span id='topic+data.frame'></span>

<h3>Description</h3>

<p>The function <code>data.frame()</code> creates data frames, tightly coupled
collections of variables which share many of the properties of
matrices and of lists, used as the fundamental data structure by most
of <span class="rlang"><b>R</b></span>'s modeling software.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.frame(..., row.names = NULL, check.rows = FALSE,
           check.names = TRUE, fix.empty.names = TRUE,
           stringsAsFactors = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.frame_+3A_...">...</code></td>
<td>
<p>these arguments are of either the form <code>value</code> or
<code>tag = value</code>.  Component names are created based on the tag (if
present) or the deparsed argument itself.</p>
</td></tr>
<tr><td><code id="data.frame_+3A_row.names">row.names</code></td>
<td>
<p><code>NULL</code> or a single integer or character string
specifying a column to be used as row names, or a character or
integer vector giving the row names for the data frame.</p>
</td></tr>
<tr><td><code id="data.frame_+3A_check.rows">check.rows</code></td>
<td>
<p>if <code>TRUE</code> then the rows are checked for
consistency of length and names.</p>
</td></tr>
<tr><td><code id="data.frame_+3A_check.names">check.names</code></td>
<td>
<p>logical.  If <code>TRUE</code> then the names of the
variables in the data frame are checked to ensure that they are
syntactically valid variable names and are not duplicated.
If necessary they are adjusted (by <code><a href="#topic+make.names">make.names</a></code>)
so that they are.</p>
</td></tr>
<tr><td><code id="data.frame_+3A_fix.empty.names">fix.empty.names</code></td>
<td>
<p>logical indicating if arguments which are
&ldquo;unnamed&rdquo; (in the sense of not being formally called as
<code>someName = arg</code>) get an automatically constructed name or
rather name <code>""</code>.  Needs to be set to <code>FALSE</code> even when
<code>check.names</code> is false if <code>""</code> names should be kept.</p>
</td></tr>
<tr><td><code id="data.frame_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical: should character vectors be converted
to factors?  The &lsquo;factory-fresh&rsquo; default has been <code>TRUE</code>
previously but has been changed to <code>FALSE</code> for <span class="rlang"><b>R</b></span> 4.0.0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A data frame is a list of variables of the same number of rows with
unique row names, given class <code>"data.frame"</code>.  If no variables
are included, the row names determine the number of rows.
</p>
<p>The column names should be non-empty, and attempts to use empty names
will have unsupported results.  Duplicate column names are allowed,
but you need to use <code>check.names = FALSE</code> for <code>data.frame</code>
to generate such a data frame.  However, not all operations on data
frames will preserve duplicated column names: for example matrix-like
subsetting will force column names in the result to be unique.
</p>
<p><code>data.frame</code> converts each of its arguments to a data frame by
calling <code><a href="#topic+as.data.frame">as.data.frame</a>(optional = TRUE)</code>.  As that is a
generic function, methods can be written to change the behaviour of
arguments according to their classes: <span class="rlang"><b>R</b></span> comes with many such methods.
Character variables passed to <code>data.frame</code> are converted to
factor columns if not protected by <code><a href="#topic+I">I</a></code> and argument
<code>stringsAsFactors</code> is true.  If a list or data
frame or matrix is passed to <code>data.frame</code> it is as if each
component or column had been passed as a separate argument (except for
matrices protected by <code><a href="#topic+I">I</a></code>).
</p>
<p>Objects passed to <code>data.frame</code> should have the same number of
rows, but atomic vectors (see <code><a href="#topic+is.vector">is.vector</a></code>), factors and
character vectors protected by <code><a href="#topic+I">I</a></code> will be recycled a
whole number of times if necessary (including as elements of list
arguments).
</p>
<p>If row names are not supplied in the call to <code>data.frame</code>, the
row names are taken from the first component that has suitable names,
for example a named vector or a matrix with rownames or a data frame.
(If that component is subsequently recycled, the names are discarded
with a warning.)  If <code>row.names</code> was supplied as <code>NULL</code> or no
suitable component was found the row names are the integer sequence
starting at one (and such row names are considered to be
&lsquo;automatic&rsquo;, and not preserved by <code><a href="#topic+as.matrix">as.matrix</a></code>).
</p>
<p>If row names are supplied of length one and the data frame has a
single row, the <code>row.names</code> is taken to specify the row names and
not a column (by name or number).
</p>
<p>Names are removed from vector inputs not protected by <code><a href="#topic+I">I</a></code>.
</p>


<h3>Value</h3>

<p>A data frame, a matrix-like structure whose columns may be of
differing types (numeric, logical, factor and character and so on).
</p>
<p>How the names of the data frame are created is complex, and the rest
of this paragraph is only the basic story.  If the arguments are all
named and simple objects (not lists, matrices of data frames) then the
argument names give the column names.  For an unnamed simple argument,
a deparsed version of the argument is used as the name (with an
enclosing <code>I(...)</code> removed).  For a named matrix/list/data frame
argument with more than one named column, the names of the columns are
the name of the argument followed by a dot and the column name inside
the argument: if the argument is unnamed, the argument's column names
are used.  For a named or unnamed matrix/list/data frame argument that
contains a single column, the column name in the result is the column
name in the argument.  Finally, the names are adjusted to be unique
and syntactically valid unless <code>check.names = FALSE</code>.
</p>


<h3>Note</h3>

<p>In versions of <span class="rlang"><b>R</b></span> prior to 2.4.0 <code>row.names</code> had to be
character: to ensure compatibility with such versions of <span class="rlang"><b>R</b></span>, supply
a character vector as the <code>row.names</code> argument.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+I">I</a></code>,
<code><a href="graphics.html#topic+plot.data.frame">plot.data.frame</a></code>,
<code><a href="#topic+print.data.frame">print.data.frame</a></code>,
<code><a href="#topic+row.names">row.names</a></code>, <code><a href="#topic+names">names</a></code> (for the column names),
<code><a href="#topic++5B.data.frame">[.data.frame</a></code> for subsetting methods 
and <code>I(matrix(..))</code> examples;
<code><a href="#topic+Math.data.frame">Math.data.frame</a></code> etc, about
<em>Group</em> methods for <code>data.frame</code>s;
<code><a href="utils.html#topic+read.table">read.table</a></code>,
<code><a href="#topic+make.names">make.names</a></code>,
<code><a href="#topic+list2DF">list2DF</a></code> for creating data frames from lists of variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>L3 &lt;- LETTERS[1:3]
char &lt;- sample(L3, 10, replace = TRUE)
(d &lt;- data.frame(x = 1, y = 1:10, char = char))
## The "same" with automatic column names:
data.frame(1, 1:10, sample(L3, 10, replace = TRUE))

is.data.frame(d)

## enable automatic conversion of character arguments to factor columns:
(dd &lt;- data.frame(d, fac = letters[1:10], stringsAsFactors = TRUE))
rbind(class = sapply(dd, class), mode = sapply(dd, mode))

stopifnot(1:10 == row.names(d))  # {coercion}

(d0  &lt;- d[, FALSE])   # data frame with 0 columns and 10 rows
(d.0 &lt;- d[FALSE, ])   # &lt;0 rows&gt; data frame  (3 named cols)
(d00 &lt;- d0[FALSE, ])  # data frame with 0 columns and 0 rows
</code></pre>

<hr>
<h2 id='data.matrix'>Convert a Data Frame to a Numeric Matrix</h2><span id='topic+data.matrix'></span>

<h3>Description</h3>

<p>Return the matrix obtained by converting all the variables in a data
frame to numeric mode and then binding them together as the columns of
a matrix.  Factors and ordered factors are replaced by their internal
codes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.matrix(frame, rownames.force = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.matrix_+3A_frame">frame</code></td>
<td>
<p>a data frame whose components are logical vectors,
factors or numeric or character vectors.</p>
</td></tr>
<tr><td><code id="data.matrix_+3A_rownames.force">rownames.force</code></td>
<td>
<p>logical indicating if the resulting matrix
should have character (rather than <code>NULL</code>)
<code><a href="#topic+rownames">rownames</a></code>.  The default, <code>NA</code>, uses <code>NULL</code>
rownames if the data frame has &lsquo;automatic&rsquo; row.names or for a
zero-row data frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Logical and factor columns are converted to integers.  Character
columns are first converted to factors and then to integers. Any other
column which is not numeric (according to <code><a href="#topic+is.numeric">is.numeric</a></code>) is
converted by <code><a href="#topic+as.numeric">as.numeric</a></code> or, for S4 objects,
<code><a href="methods.html#topic+as">as</a>(, "numeric")</code>.  If all columns are integer (after
conversion) the result is an integer matrix, otherwise a numeric
(double) matrix.
</p>


<h3>Value</h3>

<p>If <code>frame</code> inherits from class <code>"data.frame"</code>, an integer or
numeric matrix of the same dimensions as <code>frame</code>, with dimnames
taken from the <code>row.names</code> (or <code>NULL</code>, depending on
<code>rownames.force</code>) and <code>names</code>.
</p>
<p>Otherwise, the result of <code><a href="#topic+as.matrix">as.matrix</a></code>.
</p>


<h3>Note</h3>

<p>The default behaviour for data frames differs from <span class="rlang"><b>R</b></span> &lt; 2.5.0 which
always gave the result character rownames.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.matrix">as.matrix</a></code>,
<code><a href="#topic+data.frame">data.frame</a></code>,
<code><a href="#topic+matrix">matrix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DF &lt;- data.frame(a = 1:3, b = letters[10:12],
                 c = seq(as.Date("2004-01-01"), by = "week", length.out = 3),
                 stringsAsFactors = TRUE)
data.matrix(DF[1:2])
data.matrix(DF)
</code></pre>

<hr>
<h2 id='dataframeHelpers'>Data Frame Auxiliary Functions</h2><span id='topic+xpdrows.data.frame'></span>

<h3>Description</h3>

<p>Internal auxiliary functions for use with data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xpdrows.data.frame(x, old.rows, new.rows)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataframeHelpers_+3A_x">x</code></td>
<td>
<p>object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="dataframeHelpers_+3A_old.rows">old.rows</code>, <code id="dataframeHelpers_+3A_new.rows">new.rows</code></td>
<td>
<p>row names for old and new rows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>xpdrows.data.frame</code> is an auxiliary function which expands the
rows of a data frame.  It is used by the data frame methods of
<code>[&lt;-</code> and <code>[[&lt;-</code> (which perform subscripted assignments on a
data frame), and not intended to be called directly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++5B.data.frame">[.data.frame</a></code>
</p>

<hr>
<h2 id='date'>System Date and Time</h2><span id='topic+date'></span>

<h3>Description</h3>

<p>Returns a character string of the current system date and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date()</code></pre>


<h3>Value</h3>

<p>The string has the form <code>"Fri Aug 20 11:11:00 1999"</code>, i.e.,
length 24, since it relies on POSIX's <code>ctime</code> ensuring the above
fixed format.  Timezone and Daylight Saving Time are taken account of,
but <em>not</em> indicated in the result.
</p>
<p>The day and month abbreviations are always in English, irrespective
of locale.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.Date">Sys.Date</a></code> and <code><a href="#topic+Sys.time">Sys.time</a></code>; <code><a href="#topic+Date">Date</a></code>
and
<code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code> for objects representing date and time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(d &lt;- date())
nchar(d) == 24

## something similar in the current locale
##   depending on ctime; e.g. %e could be %d:
format(Sys.time(), "%a %b %e %H:%M:%S %Y")
</code></pre>

<hr>
<h2 id='Dates'>Date Class</h2><span id='topic+Date'></span><span id='topic+Dates'></span><span id='topic+print.Date'></span><span id='topic+summary.Date'></span><span id='topic+Math.Date'></span><span id='topic+Summary.Date'></span><span id='topic++5B.Date'></span><span id='topic++5B+3C-.Date'></span><span id='topic+length+3C-.Date'></span><span id='topic++5B+5B.Date'></span><span id='topic+as.list.Date'></span><span id='topic+c.Date'></span><span id='topic+mean.Date'></span><span id='topic+split.Date'></span>

<h3>Description</h3>

<p>Description of the class <code>"Date"</code> representing calendar dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Date'
summary(object, digits = 12, ...)

## S3 method for class 'Date'
print(x, max = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dates_+3A_object">object</code>, <code id="Dates_+3A_x">x</code></td>
<td>
<p>a <code>Date</code> object to be summarized or printed.</p>
</td></tr>
<tr><td><code id="Dates_+3A_digits">digits</code></td>
<td>
<p>number of significant digits for the computations.</p>
</td></tr>
<tr><td><code id="Dates_+3A_max">max</code></td>
<td>
<p>numeric or <code>NULL</code>, specifying the maximal number of
entries to be printed.  By default, when <code>NULL</code>,
<code><a href="#topic+getOption">getOption</a>("max.print")</code> used.</p>
</td></tr>
<tr><td><code id="Dates_+3A_...">...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td></tr>


</table>


<h3>Details</h3>

<p>Dates are represented as the number of days since 1970-01-01, with
negative values for earlier dates.  They are always printed
following the rules of the current Gregorian calendar, even though
that calendar was not in use long ago (it was adopted in 1752 in
Great Britain and its colonies).  When printing there is assumed to
be a year zero.

</p>
<p>It is intended that the date should be an integer value, but this is
not enforced in the internal representation.  Fractional days will be
ignored when printing.  It is possible to produce fractional days via
the <code>mean</code> method or by adding or subtracting (see
<code><a href="#topic+Ops.Date">Ops.Date</a></code>).
</p>
<p>When a date is converted to a date-time (for example by
<code><a href="#topic+as.POSIXct">as.POSIXct</a></code> or <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> its time is taken
as midnight in UTC.
</p>
<p>Printing dates involves conversion to class <code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code>
which treats dates of more than about 780 million years from present
as <code>NA</code>.
</p>
<p>For the many methods see <code>methods(class = "Date")</code>.  Several are
documented separately, see below.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.Date">Sys.Date</a></code> for the current date.
</p>
<p><code><a href="#topic+weekdays">weekdays</a></code> for convenience extraction functions.
</p>
<p>Methods with extra arguments and documentation:
</p>

<dl>
<dt><code><a href="#topic+Ops.Date">Ops.Date</a></code></dt><dd><p>for operators on <code>"Date"</code> objects.</p>
</dd>
<dt><code><a href="#topic+format.Date">format.Date</a></code></dt><dd><p>for conversion to and from character strings.</p>
</dd>
<dt><code><a href="graphics.html#topic+axis.Date">axis.Date</a></code></dt><dd><p>and <code><a href="graphics.html#topic+hist.Date">hist.Date</a></code> for plotting.</p>
</dd>
<dt><code><a href="#topic+seq.Date">seq.Date</a></code></dt><dd><p>, <code><a href="#topic+cut.Date">cut.Date</a></code>, and
<code><a href="#topic+round.Date">round.Date</a></code> for utility operations.</p>
</dd>
</dl>

<p><code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code> for date-time classes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(today &lt;- Sys.Date())
format(today, "%d %b %Y")  # with month as a word
(tenweeks &lt;- seq(today, length.out=10, by="1 week")) # next ten weeks
weekdays(today)
months(tenweeks)

(Dls &lt;- as.Date(.leap.seconds))

## Show use of year zero:
(z &lt;- as.Date("01-01-01")) # how it is printed depends on the OS
z - 365 # so year zero was a leap year.
as.Date("00-02-29")
# if you want a different format, consider something like (if supported)
## Not run: format(z, "%04Y-%m-%d") # "0001-01-01"
format(z, "%_4Y-%m-%d") # "   1-01-01"
format(z, "%_Y-%m-%d")  # "1-01-01"

## End(Not run) 

##  length(&lt;Date&gt;) &lt;- n   now works
ls &lt;- Dls; length(ls) &lt;- 12
l2 &lt;- Dls; length(l2) &lt;- 5 + length(Dls)
stopifnot(exprs = {
  ## length(.) &lt;- * is compatible to subsetting/indexing:
  identical(ls, Dls[seq_along(ls)])
  identical(l2, Dls[seq_along(l2)])
  ## has filled with NA's
  is.na(l2[(length(Dls)+1):length(l2)])
})
</code></pre>

<hr>
<h2 id='DateTimeClasses'>Date-Time Classes</h2><span id='topic+DateTimeClasses'></span><span id='topic+POSIXct'></span><span id='topic+POSIXlt'></span><span id='topic+POSIXt'></span><span id='topic+print.POSIXct'></span><span id='topic+print.POSIXlt'></span><span id='topic+summary.POSIXct'></span><span id='topic+summary.POSIXlt'></span><span id='topic++2B.POSIXt'></span><span id='topic+-.POSIXt'></span><span id='topic+Ops.POSIXt'></span><span id='topic+Math.POSIXt'></span><span id='topic+Summary.POSIXct'></span><span id='topic+Math.POSIXlt'></span><span id='topic+Summary.POSIXlt'></span><span id='topic++24+3C-.POSIXlt'></span><span id='topic++5B.POSIXct'></span><span id='topic++5B+3C-.POSIXct'></span><span id='topic++5B+5B.POSIXct'></span><span id='topic++5B.POSIXlt'></span><span id='topic++5B+3C-.POSIXlt'></span><span id='topic++5B+5B.POSIXlt'></span><span id='topic++5B+5B+3C-.POSIXlt'></span><span id='topic+as.data.frame.POSIXlt'></span><span id='topic+as.list.POSIXct'></span><span id='topic+as.list.POSIXlt'></span><span id='topic+.leap.seconds'></span><span id='topic+anyNA.POSIXlt'></span><span id='topic+is.finite.POSIXlt'></span><span id='topic+is.infinite.POSIXlt'></span><span id='topic+is.na.POSIXlt'></span><span id='topic+is.nan.POSIXlt'></span><span id='topic+c.POSIXct'></span><span id='topic+c.POSIXlt'></span><span id='topic+as.matrix.POSIXlt'></span><span id='topic+length.POSIXlt'></span><span id='topic+length+3C-.POSIXct'></span><span id='topic+length+3C-.POSIXlt'></span><span id='topic+mean.POSIXct'></span><span id='topic+mean.POSIXlt'></span><span id='topic+str.POSIXt'></span><span id='topic+duplicated.POSIXlt'></span><span id='topic+unique.POSIXlt'></span><span id='topic+split.POSIXct'></span><span id='topic+names.POSIXlt'></span><span id='topic+names+3C-.POSIXlt'></span><span id='topic+date-time'></span>

<h3>Description</h3>

<p>Description of the classes <code>"POSIXlt"</code> and <code>"POSIXct"</code>
representing calendar dates and times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXct'
print(x, tz = "", usetz = TRUE, max = NULL, ...)

## S3 method for class 'POSIXct'
summary(object, digits = 15, ...)

time + z
z + time
time - z
time1 lop time2
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DateTimeClasses_+3A_x">x</code>, <code id="DateTimeClasses_+3A_object">object</code></td>
<td>
<p>an object to be printed or summarized from one of the
date-time classes.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_tz">tz</code>, <code id="DateTimeClasses_+3A_usetz">usetz</code></td>
<td>
<p>for timezone formatting, passed to <code><a href="#topic+format.POSIXct">format.POSIXct</a></code>.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_max">max</code></td>
<td>
<p>numeric or <code>NULL</code>, specifying the maximal number of
entries to be printed.  By default, when <code>NULL</code>,
<code><a href="#topic+getOption">getOption</a>("max.print")</code> used.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_digits">digits</code></td>
<td>
<p>number of significant digits for the computations:
should be high enough to represent the least important time unit
exactly.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_...">...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_time">time</code></td>
<td>
<p>date-time objects.</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_time1">time1</code>, <code id="DateTimeClasses_+3A_time2">time2</code></td>
<td>
<p>date-time objects or character vectors.  (Character
vectors are converted by <code><a href="#topic+as.POSIXct">as.POSIXct</a></code>.)</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_z">z</code></td>
<td>
<p>a numeric vector (in seconds).</p>
</td></tr>
<tr><td><code id="DateTimeClasses_+3A_lop">lop</code></td>
<td>
<p>one of <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>
or <code>&gt;=</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two basic classes of date/times.  Class <code>"POSIXct"</code>
represents the (signed) number of seconds since the beginning of 1970
(in the UTC time zone) as a numeric vector.  Class <code>"POSIXlt"</code> is
internally a <code><a href="#topic+list">list</a></code> of vectors with components named
<code>sec</code>, <code>min</code>, <code>hour</code> for the time,
<code>mday</code>, <code>mon</code>, and <code>year</code>, for the date,
<code>wday</code>, <code>yday</code> for the day of the week and day of the year,
<code>isdst</code>, a Daylight Saving Time flag,
and sometimes (both <em>optional</em>)
<code>zone</code>, a string for the time zone, and
<code>gmtoff</code>, offset in seconds from GMT,
see the section &lsquo;Details on POSIXlt&rsquo; below for more details.
</p>
<p>The classes correspond to the POSIX/C99 constructs of &lsquo;calendar
time&rsquo; (the <code>time_t</code> data type, &ldquo;ct&rdquo;), and &lsquo;local time&rsquo;
(or broken-down time, the &lsquo;<span class="samp">&#8288;struct tm&#8288;</span>&rsquo; data type, &ldquo;lt&rdquo;),
from which they also inherit their names.
</p>
<p><code>"POSIXct"</code> is more convenient for including in data frames, and
<code>"POSIXlt"</code> is closer to human-readable forms.  A virtual class
<code>"POSIXt"</code> exists from which both of the classes inherit: it is
used to allow operations such as subtraction to mix the two classes.
</p>
<p>Logical comparisons and some arithmetic operations are available for
both classes.  One can add or subtract a number of seconds from a
date-time object, but not add two date-time objects.  Subtraction of
two date-time objects is equivalent to using <code><a href="#topic+difftime">difftime</a></code>.
Be aware that <code>"POSIXlt"</code> objects will be interpreted as being in
the current time zone for these operations unless a time zone has been
specified.
</p>
<p>Both classes may have an attribute <code>"tzone"</code>, specifying the time
zone.  Note however that their meaning differ, see the section
&lsquo;Time Zones&rsquo; below for more details.
</p>


<p>Unfortunately, the conversion is complicated by the operation of time
zones and leap seconds (according to this version of <span class="rlang"><b>R</b></span>'s data,
27 days have been 86401 seconds long so
far, the last being on (actually, immediately before)
2017-01-01: the times of the
extra seconds are in the object <code>.leap.seconds</code>).  The details of
this are entrusted to the OS services where possible.  It seems that
some rare systems used to use leap seconds, but all known current
platforms ignore them (as required by POSIX).  This is detected and
corrected for at build time, so <code>"POSIXct"</code> times used by <span class="rlang"><b>R</b></span> do
not include leap seconds on any platform.
</p>
<p>Using <code><a href="#topic+c">c</a></code> on <code>"POSIXlt"</code> objects converts them to the
current time zone, and on <code>"POSIXct"</code> objects drops <code>"tzone"</code>
attributes if they are not all the same.
</p>
<p>A few times have specific issues.  First, the leap seconds are ignored,
and real times such as <code>"2005-12-31 23:59:60"</code> are (probably)
treated as the next second.  However, they will never be generated by
<span class="rlang"><b>R</b></span>, and are unlikely to arise as input.  Second, on some OSes there is
a problem in the POSIX/C99 standard with <code>"1969-12-31 23:59:59 UTC"</code>,
which is <code>-1</code> in calendar time and that value is on those OSes
also used as an error code.  Thus <code>as.POSIXct("1969-12-31
  23:59:59", format = "%Y-%m-%d %H:%M:%S", tz = "UTC")</code> may give
<code>NA</code>, and hence <code>as.POSIXct("1969-12-31 23:59:59",
  tz = "UTC")</code> will give <code>"1969-12-31 23:59:00"</code>.  Other OSes
(including the code used by <span class="rlang"><b>R</b></span> on Windows) report errors separately
and so are able to handle that time as valid.
</p>
<p>The print methods respect <code><a href="#topic+options">options</a>("max.print")</code>.
</p>


<h3>Time zones</h3>

<p><code>"POSIXlt"</code> objects will often have an attribute <code>"tzone"</code>,
a character vector of length 3 giving the time zone name (from the <span class="env">TZ</span>
environment variable or argument <code>tz</code> of functions creating
<code>"POSIXlt"</code> objects; <code>""</code> marks the current time zone)
and the names of the base time zone
and the alternate (daylight-saving) time zone.  Sometimes this may
just be of length one, giving the <a href="#topic+time+20zone">time zone</a> name.
</p>
<p><code>"POSIXct"</code> objects may also have an attribute <code>"tzone"</code>, a
character vector of length one.  If set to a non-empty value, it will
determine how the object is converted to class <code>"POSIXlt"</code> and in
particular how it is printed.  This is usually desirable, but if you
want to specify an object in a particular time zone but to be printed
in the current time zone you may want to remove the <code>"tzone"</code>
attribute. 
</p>


<h3>Details on POSIXlt</h3>

<p>Class <code>"POSIXlt"</code> is internally a named <code><a href="#topic+list">list</a></code> of
vectors representing date-times, with the following list components
</p>

<dl>
<dt><code>sec</code></dt><dd><p>0&ndash;61: seconds, allowing for leap seconds.</p>
</dd>
<dt><code>min</code></dt><dd><p>0&ndash;59: minutes.</p>
</dd>
<dt><code>hour</code></dt><dd><p>0&ndash;23: hours.</p>
</dd>
<dt><code>mday</code></dt><dd><p>1&ndash;31: day of the month.</p>
</dd>
<dt><code>mon</code></dt><dd><p>0&ndash;11: months after the first of the year.</p>
</dd>
<dt><code>year</code></dt><dd><p>years since 1900.</p>
</dd>
<dt><code>wday</code></dt><dd><p>0&ndash;6 day of the week, starting on Sunday.</p>
</dd>
<dt><code>yday</code></dt><dd><p>0&ndash;365: day of the year (365 only in leap years).</p>
</dd>
<dt><code>isdst</code></dt><dd><p>Daylight Saving Time flag.  Positive if in
force, zero if not, negative if unknown.</p>
</dd>
<dt><code>zone</code></dt><dd><p>(Optional.) The abbreviation for the time zone in
force at that time: <code>""</code> if unknown (but <code>""</code> might also
be used for UTC).</p>
</dd>
<dt><code>gmtoff</code></dt><dd><p>(Optional.) The offset in seconds from GMT:
positive values are East of the meridian.  Usually <code>NA</code> if
unknown, but <code>0</code> could mean unknown.</p>
</dd>
</dl>

<p>The components must be in this order: that was only minimally checked
prior to <span class="rlang"><b>R</b></span> 4.3.0.  All objects created in <span class="rlang"><b>R</b></span> 4.3.0 have the optional
components.  From earlier versions of <span class="rlang"><b>R</b></span>, he last two components will
not be present for times in UTC and are platform-dependent.  Currently
<code>gmtoff</code> is set on almost all current platforms: those based on
BSD or <code>glibc</code> (including Linux and macOS) and those using the
<code>tzcode</code> implementation shipped with <span class="rlang"><b>R</b></span> (including Windows and by
default macOS).
</p>
<p>Note that the internal list structure is somewhat hidden, as many
methods (including <code><a href="#topic+length">length</a>(x)</code>, <code><a href="#topic+print">print</a>()</code> and
<code><a href="utils.html#topic+str">str</a>()</code>) apply to the abstract date-time vector, as for
<code>"POSIXct"</code>.  One can extract and replace <em>single</em>
components via <code>[</code> indexing with <em>two</em> indices (see the
examples).
</p>
<p>The components of <code>"POSIXlt"</code> are <code><a href="#topic+integer">integer</a></code> vectors,
except <code>sec</code> (<code><a href="#topic+double">double</a></code>) and <code>zone</code>
(<code><a href="#topic+character">character</a></code>).  However most users will coerce numeric
values for the first to real and the rest bar <code>zone</code> to integer.
</p>
<p>Components <code>wday</code> and <code>yday</code> are for information, and are not
used in the conversion to calendar time nor for printing,
<code>format()</code>, or in <code>as.character()</code>.
</p>
<p>However, component <code>isdst</code> is needed to distinguish times at the
end of DST: typically 1am to 2am occurs twice, first in DST and then
in standard time.  At all other times <code>isdst</code> can be deduced from
the first six values, but the behaviour if it is set incorrectly is
platform-dependent.  For example Linux/glibc when checked fixed up
incorrect values in time zones which support DST but gave an error on
value <code>1</code> in those without DST.


</p>
<p>For &ldquo;ragged&rdquo; and out-of-range vs &ldquo;balanced&rdquo;
<code>"POSIXlt"</code> objects, see <code><a href="#topic+balancePOSIXlt">balancePOSIXlt</a>()</code>.
</p>


<h3>Sub-second Accuracy</h3>

<p>Classes <code>"POSIXct"</code> and  <code>"POSIXlt"</code> are able to express
fractions of a second where the latter allows for higher accuracy.
Consequently, conversion of fractions between the two forms
may not be exact, but will have better than microsecond accuracy.
</p>
<p>Fractional seconds are printed only if
<code><a href="#topic+options">options</a>("digits.secs")</code> is set: see <code><a href="#topic+strftime">strftime</a></code>.
</p>


<h3>Valid ranges for times</h3>

<p>The <code>"POSIXlt"</code> class can represent a very wide range of times (up
to billions of years), but such times can only be interpreted with
reference to a time zone.
</p>

<p>The concept of time zones was first adopted in the nineteenth century,
and the Gregorian calendar was introduced in 1582 but not universally
adopted until 1927.  OS services almost invariably assume the
Gregorian calendar and may assume that the time zone that was first
enacted for the location was in force before that date.  (The earliest
legislated time zone seems to have been London on 1847-12-01.)  Some
OSes assume the previous use of &lsquo;local time&rsquo; based on the
longitude of a location within the time zone.

</p>
<p>Most operating systems represent <code>POSIXct</code> times as C type
<code>long</code>. This means that on 32-bit OSes this covers the period
1902 to 2037.  On all known 64-bit platforms and for the code we use
on 32-bit Windows, the range of representable times is billions of
years: however, not all can convert correctly times before 1902 or
after 2037.  A few benighted OSes used a unsigned type and so cannot
represent times before 1970.

</p>
<p>Where possible the platform limits are detected, and outside
the limits we use our own C code.  This uses the offset from
GMT in use either for 1902 (when there was no DST) or that predicted
for one of 2030 to 2037 (chosen so that the likely DST transition days
are Sundays), and uses the alternate (daylight-saving) time zone only
if <code>isdst</code> is positive or (if <code>-1</code>) if DST was predicted to
be in operation in the 2030s on that day.
</p>
<p>Note that there are places (e.g., Rome) whose offset from UTC varied
in the years prior to 1902, and these will be handled correctly only
where there is OS support.
</p>
<p>There is no reason to assume that the DST rules will remain the same
in the future: the US legislated in 2005 to change its
rules as from 2007, with a possible future reversion.  So conversions
for times more than a year or two ahead are speculative.  Other
countries have changed their rules (and indeed, if DST is used at all)
at a few days' notice.  So representations and conversion of future
dates are tentative.  This also applies to dates after the in-use
version of the time-zone database &ndash; not all platforms keep it up to
date, which includes that shipped with older versions of <span class="rlang"><b>R</b></span> where used
(which it is by default on Windows and macOS).
</p>


<h3>Warnings</h3>

<p>Some Unix-like systems (especially Linux ones) do not have environment
variable <span class="env">TZ</span> set, yet have internal code that expects it (as does
POSIX).  We have tried to work around this, but if you get unexpected
results try setting <span class="env">TZ</span>.  See <code><a href="#topic+Sys.timezone">Sys.timezone</a></code> for
valid settings.
</p>
<p>Great care is needed when comparing objects of class <code>"POSIXlt"</code>.
Not only are components and attributes optional; several components
may have values meaning &lsquo;not yet determined&rsquo; and the same time
represented in different time zones will look quite different.
</p>
<p>The <em>order</em> of the list components of <code>"POSIXlt"</code> objects
must not be changed, as several C-based conversion methods rely on the
order for efficiency.
</p>


<h3>References</h3>

<p>Ripley, B. D. and Hornik, K. (2001).
&ldquo;Date-time classes.&rdquo;
<em>R News</em>, <b>1</b>(2), 8&ndash;11.
<a href="https://www.r-project.org/doc/Rnews/Rnews_2001-2.pdf">https://www.r-project.org/doc/Rnews/Rnews_2001-2.pdf</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+Dates">Dates</a> for dates without times.
</p>
<p><code><a href="#topic+as.POSIXct">as.POSIXct</a></code> and <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> for conversion
between the classes.
</p>
<p><code><a href="#topic+strptime">strptime</a></code> for conversion to and from character
representations.
</p>
<p><code><a href="#topic+Sys.time">Sys.time</a></code> for clock time as a <code>"POSIXct"</code> object.
</p>
<p><code><a href="#topic+difftime">difftime</a></code> for time intervals.
</p>
<p><code><a href="#topic+balancePOSIXlt">balancePOSIXlt</a>()</code> for balancing or filling &ldquo;ragged&rdquo;
POSIXlt objects.
</p>
<p><code><a href="#topic+cut.POSIXt">cut.POSIXt</a></code>, <code><a href="#topic+seq.POSIXt">seq.POSIXt</a></code>,
<code><a href="#topic+round.POSIXt">round.POSIXt</a></code> and <code><a href="#topic+trunc.POSIXt">trunc.POSIXt</a></code> for methods
for these classes.
</p>
<p><code><a href="#topic+weekdays">weekdays</a></code> for convenience extraction functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(z &lt;- Sys.time())             # the current date, as class "POSIXct"

Sys.time() - 3600             # an hour ago

as.POSIXlt(Sys.time(), "GMT") # the current time in GMT
format(.leap.seconds)         # the leap seconds in your time zone
print(.leap.seconds, tz = "America/Los_Angeles")  # and in Seattle's


## look at *internal* representation of "POSIXlt" :
leapS &lt;- as.POSIXlt(.leap.seconds)
names(unclass(leapS)) ; is.list(leapS)
## str() on inner structure needs unclass(.):
utils::str(unclass(leapS), vec.len = 7)
## show all (apart from "tzone" attr):
data.frame(unclass(leapS))

## Extracting *single* components of POSIXlt objects:
leapS[1 : 5, "year"]
leapS[17:22, "mon" ]

##  length(.) &lt;- n   now works for "POSIXct" and "POSIXlt" :
for(lpS in list(.leap.seconds, leapS)) {
    ls &lt;- lpS; length(ls) &lt;- 12
    l2 &lt;- lpS; length(l2) &lt;- 5 + length(lpS)
    stopifnot(exprs = {
      ## length(.) &lt;- * is compatible to subsetting/indexing:
      identical(ls, lpS[seq_along(ls)])
      identical(l2, lpS[seq_along(l2)])
      ## has filled with NA's
      is.na(l2[(length(lpS)+1):length(l2)])
    })
}
</code></pre>

<hr>
<h2 id='dcf'>Read and Write Data in DCF Format</h2><span id='topic+read.dcf'></span><span id='topic+write.dcf'></span>

<h3>Description</h3>

<p>Reads or writes an <span class="rlang"><b>R</b></span> object from/to a file in Debian Control File
format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.dcf(file, fields = NULL, all = FALSE, keep.white = NULL)

write.dcf(x, file = "", append = FALSE, useBytes = FALSE,
          indent = 0.1 * getOption("width"),
          width = 0.9 * getOption("width"),
          keep.white = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcf_+3A_file">file</code></td>
<td>
<p>either a character string naming a file or a <a href="#topic+connection">connection</a>.
<code>""</code> indicates output to the console.  For <code>read.dcf</code> this
can name a compressed file (see <code><a href="#topic+gzfile">gzfile</a></code>).</p>
</td></tr>
<tr><td><code id="dcf_+3A_fields">fields</code></td>
<td>
<p>a character vector with the names of the fields
to read from the DCF file.  Default is to read all fields.</p>
</td></tr>
<tr><td><code id="dcf_+3A_all">all</code></td>
<td>
<p>a logical indicating whether in case of multiple
occurrences of a field in a record, all these should be gathered.
If <code>all</code> is false (default), only the last such occurrence is
used.</p>
</td></tr>
<tr><td><code id="dcf_+3A_keep.white">keep.white</code></td>
<td>
<p>a character vector with the names of the fields for
which whitespace should be kept as is, or <code>NULL</code> (default)
indicating that there are no such fields.  Coerced to character if
possible.  For fields where whitespace is not to be kept as is,
<code>read.dcf</code> removes leading and trailing whitespace, and
<code>write.dcf</code> folds using <code><a href="#topic+strwrap">strwrap</a></code>.
</p>
</td></tr>
<tr><td><code id="dcf_+3A_x">x</code></td>
<td>
<p>the object to be written, typically a data frame.  If not, it
is attempted to coerce <code>x</code> to a data frame.</p>
</td></tr>
<tr><td><code id="dcf_+3A_append">append</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the output is appended to the
file.  If <code>FALSE</code>, any existing file of the name is destroyed.</p>
</td></tr>
<tr><td><code id="dcf_+3A_usebytes">useBytes</code></td>
<td>
<p>logical to be passed to <code><a href="#topic+writeLines">writeLines</a>()</code>,
see there: &ldquo;for expert use&rdquo;.</p>
</td></tr>
<tr><td><code id="dcf_+3A_indent">indent</code></td>
<td>
<p>a positive integer specifying the indentation for
continuation lines in output entries.</p>
</td></tr>
<tr><td><code id="dcf_+3A_width">width</code></td>
<td>
<p>a positive integer giving the target column for wrapping
lines in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DCF is a simple format for storing databases in plain text files that
can easily be directly read and written by humans.  DCF is used in
various places to store <span class="rlang"><b>R</b></span> system information, like descriptions and
contents of packages.
</p>
<p>The DCF rules as implemented in <span class="rlang"><b>R</b></span> are:
</p>

<ol>
<li><p> A database consists of one or more records, each with one or
more named fields.  Not every record must contain each field.
Fields may appear more than once in a record.
</p>
</li>
<li><p> Regular lines start with a non-whitespace character.
</p>
</li>
<li><p> Regular lines are of form <code>tag:value</code>, i.e., have a name
tag and a value for the field, separated by <code>:</code> (only the first
<code>:</code> counts).  The value can be empty (i.e., whitespace only).
</p>
</li>
<li><p> Lines starting with whitespace are continuation lines (to the
preceding field) if at least one character in the line is
non-whitespace.  Continuation lines where the only non-whitespace
character is a &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; are taken as blank lines (allowing for
multi-paragraph field values).
</p>
</li>
<li><p> Records are separated by one or more empty (i.e., whitespace
only) lines.
</p>
</li>
<li><p> Individual lines may not be arbitrarily long; prior to <span class="rlang"><b>R</b></span> 3.0.2 the
length limit was approximately 8191 bytes per line.
</p>
</li></ol>

<p>Note that <code>read.dcf(all = FALSE)</code> reads the file byte-by-byte.
This allows a &lsquo;<span class="file">DESCRIPTION</span>&rsquo; file to be read and only its ASCII
fields used, or its &lsquo;<span class="samp">&#8288;Encoding&#8288;</span>&rsquo; field used to re-encode the
remaining fields.
</p>
<p><code>write.dcf</code> does not write <code>NA</code> fields.
</p>


<h3>Value</h3>

<p>The default <code>read.dcf(all = FALSE)</code> returns a character matrix
with one row per record and one column per field.  Leading and
trailing whitespace of field values is ignored unless a field is
listed in <code>keep.white</code>.  If a tag name is specified in the file,
but the corresponding value is empty, then an empty string is
returned.  If the tag name of a field is specified in <code>fields</code>
but never used in a record, then the corresponding value is <code>NA</code>.
If fields are repeated within a record, the last one encountered is
returned.  Malformed lines lead to an error.
</p>
<p>For <code>read.dcf(all = TRUE)</code> a data frame is returned, again with
one row per record and one column per field.  The columns are lists of
character vectors for fields with multiple occurrences, and character
vectors otherwise.
</p>
<p>Note that an empty <code>file</code> is a valid DCF file, and
<code>read.dcf</code> will return a zero-row matrix or data frame.
</p>
<p>For <code>write.dcf</code>, invisible <code>NULL</code>.
</p>


<h3>Note</h3>

<p>As from <span class="rlang"><b>R</b></span> 3.4.0, &lsquo;whitespace&rsquo; in all cases includes newlines.
</p>


<h3>References</h3>

<p><a href="https://www.debian.org/doc/debian-policy/ch-controlfields.html">https://www.debian.org/doc/debian-policy/ch-controlfields.html</a>.
</p>
<p>Note that <span class="rlang"><b>R</b></span> does not require encoding in UTF-8, which is a recent
Debian requirement.  Nor does it use the Debian-specific sub-format
which allows comment lines starting with &lsquo;<span class="samp">&#8288;#&#8288;</span>&rsquo;.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+write.table">write.table</a></code>.
</p>
<p><code><a href="utils.html#topic+available.packages">available.packages</a></code>, which uses <code>read.dcf</code> to read
the indices of package repositories.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a reduced version of the DESCRIPTION file in package 'splines'
x &lt;- read.dcf(file = system.file("DESCRIPTION", package = "splines"),
              fields = c("Package", "Version", "Title"))
write.dcf(x)

## An online DCF file with multiple records
con &lt;- url("https://cran.r-project.org/src/contrib/PACKAGES")
y &lt;- read.dcf(con, all = TRUE)
close(con)
utils::str(y)
</code></pre>

<hr>
<h2 id='debug'>Debug a Function</h2><span id='topic+debug'></span><span id='topic+debugonce'></span><span id='topic+undebug'></span><span id='topic+isdebugged'></span><span id='topic+debuggingState'></span>

<h3>Description</h3>

<p>Set, unset or query the debugging flag on a function.
The <code>text</code> and <code>condition</code> arguments are the same as those
that can be supplied via a call to <code><a href="#topic+browser">browser</a></code>.  They can be retrieved
by the user once the browser has been entered, and provide a mechanism to
allow users to identify which breakpoint has been activated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>debug(fun, text = "", condition = NULL, signature = NULL)
debugonce(fun, text = "", condition = NULL, signature = NULL)
undebug(fun, signature = NULL)
isdebugged(fun, signature = NULL)
debuggingState(on = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="debug_+3A_fun">fun</code></td>
<td>
<p>any interpreted <span class="rlang"><b>R</b></span> function.</p>
</td></tr>
<tr><td><code id="debug_+3A_text">text</code></td>
<td>
<p>a text string that can be retrieved when the browser is entered.</p>
</td></tr>
<tr><td><code id="debug_+3A_condition">condition</code></td>
<td>
<p>a condition that can be retrieved when the browser is
entered.</p>
</td></tr>
<tr><td><code id="debug_+3A_signature">signature</code></td>
<td>
<p>an optional method signature. If specified, the
method is debugged, rather than its generic.</p>
</td></tr>
<tr><td><code id="debug_+3A_on">on</code></td>
<td>
<p>logical; a call to the support function
<code>debuggingState</code> returns <code>TRUE</code> if debugging is globally
turned on, <code>FALSE</code> otherwise.  An argument of one or the other
of those values sets the state.  If the debugging state is
<code>FALSE</code>, none of the debugging actions will occur (but explicit
<code><a href="#topic+browser">browser</a></code> calls in functions will continue to work).</p>
</td></tr>

</table>


<h3>Details</h3>

<p>When a function flagged for debugging is entered, normal execution
is suspended and the body of function is executed one statement at a
time.  A new <code><a href="#topic+browser">browser</a></code> context is initiated for each step
(and the previous one destroyed).
</p>
<p>At the debug prompt the user can enter commands or <span class="rlang"><b>R</b></span> expressions,
followed by a newline.  The commands are described in the
<code><a href="#topic+browser">browser</a></code> help topic.
</p>
<p>To debug a function which is defined inside another function,
single-step through to the end of its definition, and then call
<code>debug</code> on its name.
</p>
<p>If you want to debug a function not starting at the very beginning,
use <code><a href="#topic+trace">trace</a>(..., at = *)</code> or <code><a href="utils.html#topic+setBreakpoint">setBreakpoint</a></code>.
</p>
<p>Using <code>debug</code> is persistent, and unless debugging is turned off
the debugger will be entered on every invocation (note that if the
function is removed and replaced the debug state is not preserved).
Use <code>debugonce()</code> to enter the debugger only the next time the
function is invoked.
</p>
<p>To debug an S4 method by explicit signature, use
<code>signature</code>. When specified, signature indicates the method of
<code>fun</code> to be debugged. Note that debugging is implemented slightly
differently for this case, as it uses the trace machinery, rather than
the debugging bit. As such, <code>text</code> and <code>condition</code> cannot be
specified in combination with a non-null <code>signature</code>. For methods
which implement the <code>.local</code> rematching mechanism, the
<code>.local</code> closure itself is the one that will be ultimately
debugged (see <code><a href="methods.html#topic+RMethodUtils">isRematched</a></code>).
</p>
<p><code>isdebugged</code> returns <code>TRUE</code> if a) <code>signature</code> is <code>NULL</code>
and the closure <code>fun</code> has been debugged, or b) <code>signature</code> is not
<code>NULL</code>, <code>fun</code> is an S4 generic, and the method of <code>fun</code>
for that signature has been debugged. In all other cases, it returns
<code>FALSE</code>.
</p>
<p>The number of lines printed for the deparsed call when a function is
entered for debugging can be limited by setting
<code><a href="#topic+options">options</a>(deparse.max.lines)</code>.
</p>
<p>When debugging is enabled on a byte compiled function then the
interpreted version of the function will be used until debugging is
disabled.
</p>


<h3>Value</h3>

<p><code>debug</code> and <code>undebug</code> invisibly return <code>NULL</code>.
</p>
<p><code>isdebugged</code> returns <code>TRUE</code> if the function or method is
</p>
<p>marked for debugging, and <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+debugcall">debugcall</a></code> for conveniently debugging methods,
<code><a href="#topic+browser">browser</a></code> notably for its &lsquo;<em>commands</em>&rsquo;, <code><a href="#topic+trace">trace</a></code>;
<code><a href="#topic+traceback">traceback</a></code> to see the stack after an <code>Error: ...</code>
message; <code><a href="utils.html#topic+recover">recover</a></code> for another debugging approach.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
debug(library)
library(methods)

## End(Not run)
## Not run: 
debugonce(sample)
## only the first call will be debugged
sampe(10, 1)
sample(10, 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='declare'>
Declarations
</h2><span id='topic+declare'></span>

<h3>Description</h3>

<p>A framework for specifying information about R code for use by the
interpreter, compiler, and code analysis tools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>declare(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="declare_+3A_...">...</code></td>
<td>
<p>declaration expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A syntax for declaration expressions is still being developed.
</p>


<h3>Value</h3>

<p>Evaluating a <code>declare()</code> call ignores the arguments and returns
<code>NULL</code> invisibly.
</p>

<hr>
<h2 id='Defunct'>Marking Objects as Defunct</h2><span id='topic+Defunct'></span><span id='topic+.Defunct'></span><span id='topic+defunct'></span>

<h3>Description</h3>

<p>When a function is removed from <span class="rlang"><b>R</b></span> it should be replaced by a function
which calls <code>.Defunct</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Defunct(new, package = NULL, msg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Defunct_+3A_new">new</code></td>
<td>

<p>character string: A suggestion for a replacement function.
</p>
</td></tr>
<tr><td><code id="Defunct_+3A_package">package</code></td>
<td>

<p>character string: The package to be used when suggesting where the
defunct function might be listed.
</p>
</td></tr>
<tr><td><code id="Defunct_+3A_msg">msg</code></td>
<td>

<p>character string: A message to be printed, if missing a default
message is used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>.Defunct</code> is called from defunct functions.  Functions should be
listed in <code>help("pkg-defunct")</code> for an appropriate <code>pkg</code>,
including <code>base</code> (with the alias added to the respective Rd
file).
</p>
<p><code>.Defunct</code> signals an error of class <code>defunctError</code>
with fields <code>old</code>, <code>new</code>, and <code>package</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Deprecated">Deprecated</a></code>.
</p>
<p><code>base-defunct</code> and so on which list the defunct functions
in the packages.
</p>

<hr>
<h2 id='delayedAssign'>Delay Evaluation and Promises</h2><span id='topic+delayedAssign'></span><span id='topic+promise'></span><span id='topic+promises'></span>

<h3>Description</h3>

<p><code>delayedAssign</code> creates a <em>promise</em> to evaluate the given
expression if its value is requested.  This provides direct access
to the <em>lazy evaluation</em> mechanism used by <span class="rlang"><b>R</b></span> for the evaluation
of (interpreted) functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delayedAssign(x, value, eval.env = parent.frame(1),
              assign.env = parent.frame(1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delayedAssign_+3A_x">x</code></td>
<td>
<p>a variable name (given as a quoted string in the function call)</p>
</td></tr>
<tr><td><code id="delayedAssign_+3A_value">value</code></td>
<td>
<p>an expression to be assigned to <code>x</code></p>
</td></tr>
<tr><td><code id="delayedAssign_+3A_eval.env">eval.env</code></td>
<td>
<p>an environment in which to evaluate <code>value</code></p>
</td></tr>
<tr><td><code id="delayedAssign_+3A_assign.env">assign.env</code></td>
<td>
<p>an environment in which to assign <code>x</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code>eval.env</code> and <code>assign.env</code> default to the currently active
environment.
</p>
<p>The expression assigned to a promise by <code>delayedAssign</code> will
not be evaluated until it is eventually &lsquo;forced&rsquo;.  This happens when
the variable is first accessed.
</p>
<p>When the promise is eventually forced, it is evaluated within the
environment specified by <code>eval.env</code> (whose contents may have changed in
the meantime).  After that, the value is fixed and the expression will
not be evaluated again, where the promise still keeps its expression.
</p>


<h3>Value</h3>

<p>This function is invoked for its side effect, which is assigning
a promise to evaluate <code>value</code> to the variable <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+substitute">substitute</a></code>, to see the expression associated with a
promise, if <code>assign.env</code> is not the <code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>msg &lt;- "old"
delayedAssign("x", msg)
substitute(x) # shows only 'x', as it is in the global env.
msg &lt;- "new!"
x # new!

delayedAssign("x", {
    for(i in 1:3)
        cat("yippee!\n")
    10
})

x^2 #- yippee
x^2 #- simple number

ne &lt;- new.env()
delayedAssign("x", pi + 2, assign.env = ne)
## See the promise {without "forcing" (i.e. evaluating) it}:
substitute(x, ne) #  'pi + 2'


### Promises in an environment [for advanced users]:  ---------------------

e &lt;- (function(x, y = 1, z) environment())(cos, "y", {cat(" HO!\n"); pi+2})
## How can we look at all promises in an env (w/o forcing them)?
gete &lt;- function(e_) {
   ne &lt;- names(e_)
   names(ne) &lt;- ne
   lapply(lapply(ne, as.name),
          function(n) eval(substitute(substitute(X, e_), list(X=n))))
}
(exps &lt;- gete(e))
sapply(exps, typeof)

(le &lt;- as.list(e)) # evaluates ("force"s) the promises
stopifnot(identical(le, lapply(exps, eval))) # and another "Ho!"
</code></pre>

<hr>
<h2 id='deparse'>Expression Deparsing</h2><span id='topic+deparse'></span><span id='topic+deparse1'></span>

<h3>Description</h3>

<p>Turn unevaluated expressions into character strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deparse(expr, width.cutoff = 60L,
        backtick = mode(expr) %in% c("call", "expression", "(", "function"),
        control = c("keepNA", "keepInteger", "niceNames", "showAttributes"),
        nlines = -1L)

deparse1(expr, collapse = " ", width.cutoff = 500L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deparse_+3A_expr">expr</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> expression.</p>
</td></tr>
<tr><td><code id="deparse_+3A_width.cutoff">width.cutoff</code></td>
<td>
<p>integer in <code class="reqn">[20, 500]</code> determining the cutoff
(in bytes) at which line-breaking is tried.</p>
</td></tr>
<tr><td><code id="deparse_+3A_backtick">backtick</code></td>
<td>
<p>logical indicating whether symbolic names should be
enclosed in backticks if they do not follow the standard syntax.</p>
</td></tr>
<tr><td><code id="deparse_+3A_control">control</code></td>
<td>
<p>character vector (or <code>NULL</code>) of deparsing options.
<code>control = "all"</code> is thorough, see <code><a href="#topic+.deparseOpts">.deparseOpts</a></code>.</p>
</td></tr>
<tr><td><code id="deparse_+3A_nlines">nlines</code></td>
<td>
<p>integer: the maximum number of lines to produce.  Negative
values indicate no limit.</p>
</td></tr> 
<tr><td><code id="deparse_+3A_collapse">collapse</code></td>
<td>
<p>a string, passed to <code><a href="#topic+paste">paste</a>()</code>.</p>
</td></tr>
<tr><td><code id="deparse_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code>deparse()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions turn unevaluated expressions (where &lsquo;expression&rsquo;
is taken in a wider sense than the strict concept of a vector of
<code><a href="#topic+mode">mode</a></code> and type (<code><a href="#topic+typeof">typeof</a></code>)
<code>"expression"</code> used in <code><a href="#topic+expression">expression</a></code>) into character
strings (a kind of inverse to <code><a href="#topic+parse">parse</a></code>).
</p>
<p>A typical use of this is to create informative labels for data sets
and plots.  The example shows a simple use of this facility.  It uses
the functions <code>deparse</code> and <code>substitute</code> to create labels
for a plot which are character string versions of the actual arguments
to the function <code>myplot</code>.
</p>
<p>The default for the <code>backtick</code> option is not to quote single
symbols but only composite expressions.  This is a compromise to
avoid breaking existing code.
</p>
<p><code>width.cutoff</code> is a lower bound for the line lengths: deparsing a
line proceeds until at least <code>width.cutoff</code> <em>bytes</em> have
been output and e.g. <code>arg = value</code> expressions will not be split
across lines.
</p>
<p><code>deparse1()</code> is a simple utility added in <span class="rlang"><b>R</b></span> 4.0.0 to ensure a
string result (<code><a href="#topic+character">character</a></code> vector of length one),
typically used in name construction, as
<code>deparse1(<a href="#topic+substitute">substitute</a>(.))</code>.
</p>


<h3>Note</h3>

<p>To avoid the risk of a source attribute out of sync with the actual
function definition, the source attribute of a function will never
be deparsed as an attribute.
</p>
<p>Deparsing internal structures may not be accurate: for example the
graphics display list recorded by <code><a href="grDevices.html#topic+recordPlot">recordPlot</a></code> is not
intended to be deparsed and <code>.Internal</code> calls will be shown as
primitive calls.
</p>







<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.deparseOpts">.deparseOpts</a></code> for available <code>control</code> settings;
<code><a href="#topic+dput">dput</a>()</code> and <code><a href="#topic+dump">dump</a>()</code> for related functions using
identical internal deparsing functionality.
</p>
<p><code><a href="#topic+substitute">substitute</a></code>,
<code><a href="#topic+parse">parse</a></code>,
<code><a href="#topic+expression">expression</a></code>.
</p>
<p><code>Quotes</code> for quoting conventions, including backticks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)

deparse(args(lm))
deparse(args(lm), width.cutoff = 500)

myplot &lt;- function(x, y) {
    plot(x, y, xlab = deparse1(substitute(x)),
               ylab = deparse1(substitute(y)))
}

e &lt;- quote(`foo bar`)
deparse(e)
deparse(e, backtick = TRUE)
e &lt;- quote(`foo bar`+1)
deparse(e)
deparse(e, control = "all") # wraps it w/ quote( . )
</code></pre>

<hr>
<h2 id='deparseOpts'>Options for Expression Deparsing</h2><span id='topic+.deparseOpts'></span><span id='topic+..deparseOpts'></span>

<h3>Description</h3>

<p>Process the deparsing options for <code>deparse</code>, <code>dput</code> and
<code>dump</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.deparseOpts(control)

..deparseOpts
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deparseOpts_+3A_control">control</code></td>
<td>
<p>character vector of deparsing options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>..deparseOpts</code> is the <code><a href="#topic+character">character</a></code> vector of possible
deparsing options used by <code>.deparseOpts()</code>.
</p>
<p><code>.deparseOpts()</code> is called by <code><a href="#topic+deparse">deparse</a></code>, <code><a href="#topic+dput">dput</a></code> and
<code><a href="#topic+dump">dump</a></code> to process their <code>control</code> argument.
</p>
<p>The <code>control</code> argument is a vector containing zero or more of the
following strings (exactly those in <code>..deparseOpts</code>).  Partial
string matching is used.
</p>

<dl>
<dt><code>"keepInteger"</code>:</dt><dd>
<p>Either surround integer vectors by <code>as.integer()</code> or use
suffix <code>L</code>, so they are not converted to type double when
parsed.  This includes making sure that integer <code>NA</code>s are
preserved (via <code>NA_integer_</code> if there are no non-<code>NA</code>
values in the vector, unless <code>"S_compatible"</code> is set).
</p>
</dd>
<dt><code>"quoteExpressions"</code>:</dt><dd>
<p>Surround unevaluated expressions, but not <code><a href="stats.html#topic+formula">formula</a></code>s,
with <code>quote()</code>, so they are not evaluated when re-parsed.
</p>
</dd>
<dt><code>"showAttributes"</code>:</dt><dd>
<p>If the object has <code><a href="#topic+attributes">attributes</a></code> (other than a <code>source</code>
attribute, see <code><a href="#topic+srcref">srcref</a></code>), use <code><a href="#topic+structure">structure</a>()</code>
to display them as well as the object value unless the only such
attribute is <code>names</code> and the <code>"niceNames"</code> option is set.
This (<code>"showAttributes"</code>) is the default for
<code><a href="#topic+deparse">deparse</a></code> and <code><a href="#topic+dput">dput</a></code>.
</p>
</dd>
<dt><code>"useSource"</code>:</dt><dd>
<p>If the object has a <code>source</code> attribute (<code><a href="#topic+srcref">srcref</a></code>),
display that instead of deparsing the object.  Currently only
applies to function definitions.
</p>
</dd>
<dt><code>"warnIncomplete"</code>:</dt><dd>
<p>Some exotic objects such as <a href="#topic+environment">environment</a>s, external
pointers, etc. can not be deparsed properly.  This option causes a
warning to be issued if the deparser recognizes one of these
situations.
</p>
<p>Also, the parser in <span class="rlang"><b>R</b></span> &lt; 2.7.0 would only accept strings of up to
8192 bytes, and this option gives a warning for longer strings.
</p>
</dd>
<dt><code>"keepNA"</code>:</dt><dd>
<p>Integer, real and character <code>NA</code>s are surrounded by coercion
functions where necessary to ensure that they are parsed to the
same type.  Since e.g. <code>NA_real_</code> can be output in <span class="rlang"><b>R</b></span>, this is
mainly used in connection with <code>S_compatible</code>.
</p>
</dd>
<dt><code>"niceNames"</code>:</dt><dd>
<p>If true, <code><a href="#topic+list">list</a></code>s and atomic vectors with non-<code><a href="#topic+NA">NA</a></code>
names (see <code><a href="#topic+names">names</a></code>) are deparsed as e.g., <code>c(A = 1)</code>
instead of <code>structure(1, names = "A")</code>, independently of the
<code>"showAttributes"</code> setting.
</p>
</dd>
<dt><code>"all"</code>:</dt><dd>
<p>An abbreviated way to specify all of the options
listed above <em>plus</em> <code>"digits17"</code>.
This is the default for <code>dump</code>, and, without <code>"digits17"</code>, the options
used by <code><a href="utils.html#topic+edit">edit</a></code> (which are fixed).
</p>
</dd>
<dt><code>"delayPromises"</code>:</dt><dd>
<p>Deparse promises in the form &lt;promise: expression&gt; rather than
evaluating them.  The value and the environment of the promise
will not be shown and the deparsed code cannot be sourced.
</p>
</dd>
<dt><code>"S_compatible"</code>:</dt><dd>
<p>Make deparsing as far as possible compatible with S and <span class="rlang"><b>R</b></span> &lt; 2.5.0.
For compatibility with S, integer values of double vectors are
deparsed with a trailing decimal point.  Backticks are not used.
</p>
</dd>
<dt><code>"hexNumeric"</code>:</dt><dd>
<p>Real and finite complex numbers are output in &lsquo;<span class="samp">&#8288;"%a"&#8288;</span>&rsquo; format as
binary fractions (coded as hexadecimal: see <code><a href="#topic+sprintf">sprintf</a></code>)
with maximal opportunity to be recorded exactly to full precision.
Complex numbers with one or both non-finite components are
output as if this option were not set.
</p>
<p>(This relies on that format being correctly supported: known
problems on Windows are worked around as from <span class="rlang"><b>R</b></span> 3.1.2.)
</p>
</dd>
<dt><code>"digits17"</code>:</dt><dd>
<p>Real and finite complex numbers are output using format
&lsquo;<span class="samp">&#8288;"%.17g"&#8288;</span>&rsquo; which may give more precision than the default
(but the output will depend on the platform and there may be loss
of precision when read back).  Complex numbers with one or both
non-finite components are output as if this option were not set.
</p>
</dd>
<dt><code>"exact"</code>:</dt><dd>
<p>An abbreviated way to specify <code>control = c("all", "hexNumeric")</code>
which is guaranteed to be exact for numbers, see also below.
</p>
</dd>
</dl>

<p>For the most readable (but perhaps incomplete) display, use
<code>control = NULL</code>.  This displays the object's value, but not its
attributes.  The default in <code><a href="#topic+deparse">deparse</a></code> is to display the
attributes as well, but not to use any of the other options to make
the result parseable.  (<code><a href="#topic+dump">dump</a></code> uses more default options via
<code>control = "all"</code>, and printing of functions without sources
uses <code>c("keepInteger", "keepNA")</code> to which one may add
<code>"warnIncomplete"</code>.)
</p>
<p>Using <code>control = "exact"</code> (short for <code>control = c("all", "hexNumeric")</code>)
comes closest to making <code>deparse()</code> an inverse of <code>parse()</code>
(but we have not yet seen an example where <code>"all"</code>, now including
<code>"digits17"</code>, would not have been as good).  However, not all
objects are deparse-able even with these options, and a warning will be
issued if the function recognizes that it is being asked to do the
impossible.
</p>
<p>Only one of <code>"hexNumeric"</code> and <code>"digits17"</code> can be specified.
</p>


<h3>Value</h3>

<p>An integer value corresponding to the <code>control</code> options
selected.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stopifnot(.deparseOpts("exact") == .deparseOpts(c("all", "hexNumeric")))
(iOpt.all &lt;- .deparseOpts("all")) # a four digit integer

## one integer --&gt; vector binary bits
int2bits &lt;- function(x, base = 2L,
                     ndigits = 1 + floor(1e-9 + log(max(x,1), base))) {
    r &lt;- numeric(ndigits)
    for (i in ndigits:1) {
        r[i] &lt;- x%%base
        if (i &gt; 1L)
            x &lt;- x%/%base
    }
    rev(r) # smallest bit at left
}
int2bits(iOpt.all)
## What options does  "all" contain ? =========
(depO.indiv &lt;- setdiff(..deparseOpts, c("all", "exact")))
(oa &lt;- depO.indiv[int2bits(iOpt.all) == 1])# 8 strings
stopifnot(identical(iOpt.all, .deparseOpts(oa)))

## ditto for "exact" instead of "all":
(iOpt.X &lt;- .deparseOpts("exact"))
data.frame(opts = depO.indiv,
           all  = int2bits(iOpt.all),
           exact= int2bits(iOpt.X))
(oX &lt;- depO.indiv[int2bits(iOpt.X) == 1]) # 8 strings, too
diffXall &lt;- oa != oX
stopifnot(identical(iOpt.X, .deparseOpts(oX)),
          identical(oX[diffXall], "hexNumeric"),
          identical(oa[diffXall], "digits17"))
</code></pre>

<hr>
<h2 id='Deprecated'>Marking Objects as Deprecated</h2><span id='topic+Deprecated'></span><span id='topic+.Deprecated'></span><span id='topic+deprecated'></span>

<h3>Description</h3>

<p>When an object is about to be removed from <span class="rlang"><b>R</b></span> it is first deprecated and
should include a call to <code>.Deprecated</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Deprecated(new, package = NULL, msg,
            old = as.character(sys.call(sys.parent()))[1L])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Deprecated_+3A_new">new</code></td>
<td>

<p>character string: A suggestion for a replacement function.
</p>
</td></tr>
<tr><td><code id="Deprecated_+3A_package">package</code></td>
<td>

<p>character string: The package to be used when suggesting where the
deprecated function might be listed.
</p>
</td></tr>
<tr><td><code id="Deprecated_+3A_msg">msg</code></td>
<td>

<p>character string: A message to be printed, if missing a default
message is used.</p>
</td></tr>
<tr><td><code id="Deprecated_+3A_old">old</code></td>
<td>
<p>character string specifying the function (default) or usage
which is being deprecated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>.Deprecated("<var>new name</var>")</code> is called from deprecated
functions.  The original help page for these functions is often
available at <code>help("<var>old</var>-deprecated")</code> (note the quotes).

Deprecated functions should be listed in <code>help("<var>pkg</var>-deprecated")</code>
for an appropriate <var>pkg</var>, including <span class="pkg">base</span>.
</p>
<p><code>.Deprecated</code> signals a warning of class <code>"deprecatedWarning"</code>
with fields <code>old</code>, <code>new</code>, and <code>package</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Defunct">Defunct</a></code>
</p>
<p><code>help("<a href="#topic+base-deprecated">base-deprecated</a>")</code> and so on which list the
deprecated functions in the packages.
</p>

<hr>
<h2 id='det'>Calculate the Determinant of a Matrix</h2><span id='topic+det'></span><span id='topic+determinant'></span><span id='topic+determinant.matrix'></span>

<h3>Description</h3>

<p><code>det</code> calculates the determinant of a matrix.  <code>determinant</code>
is a generic function that returns separately the modulus of the determinant,
optionally on the logarithm scale, and the sign of the determinant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>det(x, ...)
determinant(x, logarithm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="det_+3A_x">x</code></td>
<td>
<p>numeric matrix: logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="det_+3A_logarithm">logarithm</code></td>
<td>
<p>logical; if <code>TRUE</code> (default) return the
logarithm of the modulus of the determinant.</p>
</td></tr>
<tr><td><code id="det_+3A_...">...</code></td>
<td>
<p>optional arguments, currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>determinant</code> function uses an LU decomposition and the
<code>det</code> function is simply a wrapper around a call to
<code>determinant</code>.
</p>
<p>Often, computing the determinant is <em>not</em> what you should be doing
to solve a given problem.
</p>


<h3>Value</h3>

<p>For <code>det</code>, the determinant of <code>x</code>.  For <code>determinant</code>, a
list with components
</p>
<table>
<tr><td><code>modulus</code></td>
<td>
<p>a numeric value.  The modulus (absolute value) of the
determinant if <code>logarithm</code> is <code>FALSE</code>; otherwise the
logarithm of the modulus.</p>
</td></tr>
<tr><td><code>sign</code></td>
<td>
<p>integer; either <code class="reqn">+1</code> or <code class="reqn">-1</code> according to whether
the determinant is positive or negative.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- matrix(1:4, ncol = 2))
unlist(determinant(x))
det(x)

det(print(cbind(1, 1:3, c(2,0,1))))
</code></pre>

<hr>
<h2 id='detach'>Detach Objects from the Search Path</h2><span id='topic+detach'></span>

<h3>Description</h3>

<p>Detach a database, i.e., remove it from the <code><a href="#topic+search">search</a>()</code>
path of available <span class="rlang"><b>R</b></span> objects.  Usually this is either a
<code><a href="#topic+data.frame">data.frame</a></code> which has been <code><a href="#topic+attach">attach</a></code>ed or a
package which was attached by <code><a href="#topic+library">library</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detach(name, pos = 2L, unload = FALSE, character.only = FALSE,
       force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detach_+3A_name">name</code></td>
<td>

<p>the object to detach.  Defaults to <code>search()[pos]</code>.
This can be an unquoted name or a character string but <em>not</em> a
character vector.  If a number is supplied this is taken as <code>pos</code>.
</p>
</td></tr>
<tr><td><code id="detach_+3A_pos">pos</code></td>
<td>

<p>index position in <code><a href="#topic+search">search</a>()</code> of the database to
detach.  When <code>name</code> is a number, <code>pos = name</code>
is used.
</p>
</td></tr>
<tr><td><code id="detach_+3A_unload">unload</code></td>
<td>
<p>a logical value indicating whether or not to attempt to
unload the namespace when a package is being detached.  If the
package has a namespace and <code>unload</code> is <code>TRUE</code>, then
<code>detach</code> will attempt to unload the namespace <em>via</em>
<code><a href="#topic+unloadNamespace">unloadNamespace</a></code>: if the namespace is imported by
another namespace or <code>unload</code> is <code>FALSE</code>, no unloading
will occur.
</p>
</td></tr>
<tr><td><code id="detach_+3A_character.only">character.only</code></td>
<td>
<p>a logical indicating whether <code>name</code>
can be assumed to be a character string.</p>
</td></tr>
<tr><td><code id="detach_+3A_force">force</code></td>
<td>
<p>logical: should a package be detached even though other
attached packages depend on it?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is most commonly used with a single number argument referring to a
position on the search list, and can also be used with a unquoted or
quoted name of an item on the search list such as <code>package:tools</code>.
</p>
<p>If a package has a namespace, detaching it does not by default unload
the namespace (and may not even with <code>unload = TRUE</code>), and
detaching will not in general unload any dynamically loaded compiled
code (DLLs); see <code><a href="#topic+getLoadedDLLs">getLoadedDLLs</a></code> and
<code><a href="#topic+library.dynam.unload">library.dynam.unload</a></code>.  Further, registered S3 methods
from the namespace will not be removed, and because S3 methods are
not tagged to their source on registration, it is in general not
possible to safely un-register the methods associated with a given
package. If you use <code><a href="#topic+library">library</a></code> on a package whose
namespace is loaded, it attaches the exports of the already loaded
namespace.  So detaching and re-attaching a package may not refresh
some or all components of the package, and is inadvisable. The most
reliable way to completely detach a package is to restart <span class="rlang"><b>R</b></span>.
</p>


<h3>Value</h3>

<p>The return value is <a href="#topic+invisible">invisible</a>.  It is <code>NULL</code> when a
package is detached, otherwise the environment which was returned by
<code><a href="#topic+attach">attach</a></code> when the object was attached (incorporating any
changes since it was attached).
</p>


<h3>Good practice</h3>

<p><code>detach()</code> without an argument removes the first item on the
search path after the workspace.  It is all too easy to call it too
many or too few times, or to not notice that the search path has
changed since an <code><a href="#topic+attach">attach</a></code> call.
</p>
<p>Use of <code>attach</code>/<code>detach</code> is best avoided in functions (see
the help for <code><a href="#topic+attach">attach</a></code>) and in interactive use and scripts
it is prudent to detach by name.
</p>


<h3>Note</h3>

<p>You cannot detach either the workspace (position 1) nor the <span class="pkg">base</span>
package (the last item in the search list), and attempting to do so
will throw an error.
</p>
<p>Unloading some namespaces has undesirable side effects:
e.g. unloading <span class="pkg">grid</span> closes all graphics devices, and on some
systems <span class="pkg">tcltk</span> cannot be reloaded once it has been unloaded and
may crash <span class="rlang"><b>R</b></span> if this is attempted.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+attach">attach</a></code>, <code><a href="#topic+library">library</a></code>, <code><a href="#topic+search">search</a></code>,
<code><a href="#topic+objects">objects</a></code>, <code><a href="#topic+unloadNamespace">unloadNamespace</a></code>,
<code><a href="#topic+library.dynam.unload">library.dynam.unload</a></code> .
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(splines) # package
detach(package:splines)
## or also
library(splines)
pkg &lt;- "package:splines"

detach(pkg, character.only = TRUE)

## careful: do not do this unless 'splines' is not already attached.
library(splines)
detach(2) # 'pos' used for 'name'

## an example of the name argument to attach
## and of detaching a database named by a character vector
attach_and_detach &lt;- function(db, pos = 2)
{
   name &lt;- deparse1(substitute(db))
   attach(db, pos = pos, name = name)
   print(search()[pos])
   detach(name, character.only = TRUE)
}
attach_and_detach(women, pos = 3)
</code></pre>

<hr>
<h2 id='diag'>Matrix Diagonals</h2><span id='topic+diag'></span><span id='topic+diag+3C-'></span>

<h3>Description</h3>

<p>Extract or replace the diagonal of a matrix,
or construct a diagonal matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag(x = 1, nrow, ncol, names = TRUE)
diag(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diag_+3A_x">x</code></td>
<td>
<p>a matrix, vector or 1D <code><a href="#topic+array">array</a></code>, or missing.</p>
</td></tr>
<tr><td><code id="diag_+3A_nrow">nrow</code>, <code id="diag_+3A_ncol">ncol</code></td>
<td>
<p>optional dimensions for the result when <code>x</code> is
not a matrix.</p>
</td></tr>
<tr><td><code id="diag_+3A_names">names</code></td>
<td>
<p>(when <code>x</code> is a matrix) logical indicating if the
resulting vector, the diagonal of <code>x</code>, should inherit
<code><a href="#topic+names">names</a></code> from <code>dimnames(x)</code> if available.</p>
</td></tr>
<tr><td><code id="diag_+3A_value">value</code></td>
<td>
<p>either a single value or a vector of length equal to that
of the current diagonal.  Should be of a mode which can be coerced
to that of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>diag</code> has four distinct usages:
</p>

<ol>
<li> <p><code>x</code> is a matrix, when it extracts the diagonal.
</p>
</li>
<li> <p><code>x</code> is missing and <code>nrow</code> is specified, it returns
an identity matrix.
</p>
</li>
<li> <p><code>x</code> is a scalar (length-one vector) and the only
argument, it returns a square identity matrix of size given by the scalar.
</p>
</li>
<li> <p><code>x</code> is a &lsquo;numeric&rsquo; (<code><a href="#topic+complex">complex</a></code>,
<code>numeric</code>, <code>integer</code>, <code><a href="#topic+logical">logical</a></code>, or
<code><a href="#topic+raw">raw</a></code>) vector, either of length at least 2 or there
were further arguments.  This returns a matrix with the given
diagonal and zero off-diagonal entries.
</p>
</li></ol>

<p>It is an error to specify <code>nrow</code> or <code>ncol</code> in the first case.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a matrix then <code>diag(x)</code> returns the diagonal of
<code>x</code>.  The resulting vector will have <code><a href="#topic+names">names</a></code> if
<code>names</code> is true and if the
matrix <code>x</code> has matching column and rownames.
</p>
<p>The replacement form sets the diagonal of the matrix <code>x</code> to the
given value(s).
</p>
<p>In all other cases the value is a diagonal matrix with <code>nrow</code>
rows and <code>ncol</code> columns (if <code>ncol</code> is not given the matrix
is square).  Here <code>nrow</code> is taken from the argument if specified,
otherwise inferred from <code>x</code>: if that is a vector (or 1D array) of
length two or more, then its length is the number of rows, but if it
is of length one and neither <code>nrow</code> nor <code>ncol</code> is specified,
<code>nrow = as.integer(x)</code>.
</p>
<p>When a diagonal matrix is returned, the diagonal elements are one
except in the fourth case, when <code>x</code> gives the diagonal elements:
it will be recycled or truncated as needed, but fractional recycling
and truncation will give a warning.
</p>


<h3>Note</h3>

<p>Using <code>diag(x)</code> can have unexpected effects if <code>x</code> is a
vector that could be of length one.  Use <code>diag(x, nrow =
    length(x))</code> for consistent behaviour.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+upper.tri">upper.tri</a></code>, <code><a href="#topic+lower.tri">lower.tri</a></code>, <code><a href="#topic+matrix">matrix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dim(diag(3))
diag(10, 3, 4) # guess what?
all(diag(1:3) == {m &lt;- matrix(0,3,3); diag(m) &lt;- 1:3; m})

## other "numeric"-like diagonal matrices :
diag(c(1i,2i))    # complex
diag(TRUE, 3)     # logical
diag(as.raw(1:3)) # raw
(D2 &lt;- diag(2:1, 4)); typeof(D2) # "integer"

require(stats)
## diag(&lt;var-cov-matrix&gt;) = variances
diag(var(M &lt;- cbind(X = 1:5, Y = rnorm(5))))
#-&gt; vector with names "X" and "Y"
rownames(M) &lt;- c(colnames(M), rep("", 3))
M; diag(M) #  named as well
diag(M, names = FALSE) # w/o names

</code></pre>

<hr>
<h2 id='diff'>Lagged Differences</h2><span id='topic+diff'></span><span id='topic+diff.default'></span><span id='topic+diff.POSIXt'></span><span id='topic+diff.Date'></span>

<h3>Description</h3>

<p>Returns suitably lagged and iterated differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff(x, ...)

## Default S3 method:
diff(x, lag = 1, differences = 1, ...)

## S3 method for class 'POSIXt'
diff(x, lag = 1, differences = 1, ...)

## S3 method for class 'Date'
diff(x, lag = 1, differences = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diff_+3A_x">x</code></td>
<td>
<p>a numeric vector or matrix containing the values to be
differenced.</p>
</td></tr>
<tr><td><code id="diff_+3A_lag">lag</code></td>
<td>
<p>an integer indicating which lag to use.</p>
</td></tr>
<tr><td><code id="diff_+3A_differences">differences</code></td>
<td>
<p>an integer indicating the order of the difference.</p>
</td></tr>
<tr><td><code id="diff_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>diff</code> is a generic function with a default method and ones for
classes <code>"<a href="stats.html#topic+ts">ts</a>"</code>, <code>"<a href="#topic+POSIXt">POSIXt</a>"</code> and
<code>"<a href="#topic+Date">Date</a>"</code>.
</p>
<p><code><a href="#topic+NA">NA</a></code>'s propagate.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a vector of length <code>n</code> and <code>differences = 1</code>,
then the computed result is equal to the successive differences
<code>x[(1+lag):n] - x[1:(n-lag)]</code>.
</p>
<p>If <code>difference</code> is larger than one this algorithm is applied
recursively to <code>x</code>.
Note that the returned value is a vector which is shorter than
<code>x</code>.
</p>
<p>If <code>x</code> is a matrix then the difference operations are carried out
on each column separately.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+diff.ts">diff.ts</a></code>, <code><a href="stats.html#topic+diffinv">diffinv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>diff(1:10, 2)
diff(1:10, 2, 2)
x &lt;- cumsum(cumsum(1:10))
diff(x, lag = 2)
diff(x, differences = 2)

diff(.leap.seconds)
## allows to pass units via ... to difftime()
diff(.leap.seconds, units = "weeks") 
diff(as.Date(.leap.seconds), units = "weeks")
</code></pre>

<hr>
<h2 id='difftime'>Time Intervals / Differences</h2><span id='topic+difftime'></span><span id='topic+as.difftime'></span><span id='topic++2A.difftime'></span><span id='topic++2F.difftime'></span><span id='topic+Math.difftime'></span><span id='topic+Ops.difftime'></span><span id='topic+Summary.difftime'></span><span id='topic++5B.difftime'></span><span id='topic++5B+3C-.difftime'></span><span id='topic+as.double.difftime'></span><span id='topic+as.list.difftime'></span><span id='topic+c.difftime'></span><span id='topic+diff.difftime'></span><span id='topic+format.difftime'></span><span id='topic+is.numeric.difftime'></span><span id='topic+length+3C-.difftime'></span><span id='topic+mean.difftime'></span><span id='topic+print.difftime'></span><span id='topic+rep.difftime'></span><span id='topic+units.difftime'></span><span id='topic+units+3C-.difftime'></span><span id='topic+time+20interval'></span>

<h3>Description</h3>

<p>Time intervals creation, printing, and some arithmetic.  The
<code><a href="#topic+print">print</a>()</code> method calls these &ldquo;time differences&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time1 - time2

difftime(time1, time2, tz,
         units = c("auto", "secs", "mins", "hours",
                   "days", "weeks"))

as.difftime(tim, format = "%X", units = "auto", tz = "UTC")

## S3 method for class 'difftime'
format(x, ...)
## S3 method for class 'difftime'
units(x)
## S3 replacement method for class 'difftime'
units(x) &lt;- value
## S3 method for class 'difftime'
as.double(x, units = "auto", ...)

## Group methods, notably for round(), signif(), floor(),
## ceiling(), trunc(), abs(); called directly, *not* as Math():
## S3 method for class 'difftime'
Math(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="difftime_+3A_time1">time1</code>, <code id="difftime_+3A_time2">time2</code></td>
<td>
<p><a href="#topic+date-time">date-time</a> or <a href="#topic+Dates">date</a> objects.</p>
</td></tr>
<tr><td><code id="difftime_+3A_tz">tz</code></td>
<td>
<p>an optional <a href="#topic+time+20zone">time zone</a> specification to be used for the
conversion, mainly for <code>"POSIXlt"</code> objects.</p>
</td></tr>
<tr><td><code id="difftime_+3A_units">units</code></td>
<td>
<p>character string.  Units in which the results are
desired.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="difftime_+3A_value">value</code></td>
<td>
<p>character string.  Like <code>units</code>, except that
abbreviations are not allowed.</p>
</td></tr>
<tr><td><code id="difftime_+3A_tim">tim</code></td>
<td>
<p>character string or numeric value specifying a time interval.</p>
</td></tr>
<tr><td><code id="difftime_+3A_format">format</code></td>
<td>
<p>character specifying the format of <code>tim</code>: see
<code><a href="#topic+strptime">strptime</a></code>.  The default is a locale-specific time format.</p>
</td></tr>
<tr><td><code id="difftime_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>"difftime"</code>.</p>
</td></tr>
<tr><td><code id="difftime_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>difftime</code> calculates a difference of two date/time
objects and returns an object of class <code>"difftime"</code> with an
attribute indicating the units.  The
<code><a href="#topic+S3groupGeneric">Math</a></code> group method provides
<code><a href="#topic+round">round</a></code>, <code><a href="#topic+signif">signif</a></code>, <code><a href="#topic+floor">floor</a></code>,
<code><a href="#topic+ceiling">ceiling</a></code>, <code><a href="#topic+trunc">trunc</a></code>, <code><a href="#topic+abs">abs</a></code>, and
<code><a href="#topic+sign">sign</a></code> methods for objects of this class, and there are
methods for the group-generic (see
<code><a href="#topic+S3groupGeneric">Ops</a></code>) logical and arithmetic
operations.
</p>
<p>If <code>units = "auto"</code>, a suitable set of units is chosen, the largest
possible (excluding <code>"weeks"</code>) in which all the absolute
differences are greater than one.
</p>
<p>Subtraction of date-time objects gives an object of this class,
by calling <code>difftime</code> with <code>units = "auto"</code>.  Alternatively,
<code>as.difftime()</code> works on character-coded or numeric time
intervals; in the latter case, units must be specified, and
<code>format</code> has no effect.
</p>
<p>Limited arithmetic is available on <code>"difftime"</code> objects: they can
be added or subtracted, and multiplied or divided by a numeric vector.
In addition, adding or subtracting a numeric vector by a
<code>"difftime"</code> object implicitly converts the numeric vector to a
<code>"difftime"</code> object with the same units as the <code>"difftime"</code>
object.  There are methods for <code><a href="#topic+mean">mean</a></code> and
<code><a href="#topic+sum">sum</a></code> (via the <code><a href="#topic+S3groupGeneric">Summary</a></code>
group generic), and <code><a href="#topic+diff">diff</a></code> via <code><a href="#topic+diff.default">diff.default</a></code>
building on the <code>"difftime"</code> method for arithmetic, notably
<code>-</code>.
</p>
<p>The units of a <code>"difftime"</code> object can be extracted by the
<code>units</code> function, which also has a replacement form.  If the
units are changed, the numerical value is scaled accordingly.  The
replacement version keeps attributes such as names and dimensions.
</p>
<p>Note that <code>units = "days"</code> means a period of 24 hours, hence
takes no account of Daylight Savings Time.  Differences in objects
of class <code>"<a href="#topic+Date">Date</a>"</code> are computed as if in the UTC time zone.
</p>
<p>The <code>as.double</code> method returns the numeric value expressed in
the specified units.  Using  <code>units = "auto"</code> means the units of the
object.
</p>
<p>The <code>format</code> method simply formats the numeric value and appends
the units as a text string.
</p>


<h3>Warning</h3>

<p>Because <span class="rlang"><b>R</b></span> follows POSIX (and almost all computer clocks) in ignoring
leap seconds, so do time differences.  So in a UTC time zone
</p>
<pre>
    z &lt;- as.POSIXct(c("2016-12-31 23:59:59", "2017-01-01 00:00:01"))
    z[2] - z[1]
</pre>
<p>reports &lsquo;<span class="samp">&#8288;Time difference of 2 secs&#8288;</span>&rsquo; but 3 seconds elapsed while
the computer clock advanced by 2 seconds.
</p>
<p>If you want the elapsed time interval, you need to add in any
leap seconds for yourself.
</p>


<h3>Note</h3>

<p>Units such as <code>"months"</code> are not possible as they are not of
constant length.  To create intervals of months, quarters or years
use <code><a href="#topic+seq.Date">seq.Date</a></code> or <code><a href="#topic+seq.POSIXt">seq.POSIXt</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(z &lt;- Sys.time() - 3600)
Sys.time() - z                # just over 3600 seconds.

## time interval between release days of R 1.2.2 and 1.2.3.
ISOdate(2001, 4, 26) - ISOdate(2001, 2, 26)

as.difftime(c("0:3:20", "11:23:15"))
as.difftime(c("3:20", "23:15", "2:"), format = "%H:%M") # 3rd gives NA
(z &lt;- as.difftime(c(0,30,60), units = "mins"))
as.numeric(z, units = "secs")
as.numeric(z, units = "hours")
format(z)
</code></pre>

<hr>
<h2 id='dim'>Dimensions of an Object</h2><span id='topic+dim'></span><span id='topic+dim.data.frame'></span><span id='topic+dim+3C-'></span>

<h3>Description</h3>

<p>Retrieve or set the dimension of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dim(x)
dim(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dim_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, for example a matrix, array or data frame.</p>
</td></tr>
<tr><td><code id="dim_+3A_value">value</code></td>
<td>
<p>for the default method, either <code>NULL</code> or
a numeric vector, which is coerced to integer (by truncation).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>dim</code> and <code>dim&lt;-</code> are <a href="#topic+internal+20generic">internal generic</a>
<a href="#topic+primitive">primitive</a> functions.
</p>
<p><code>dim</code> has a method for <code><a href="#topic+data.frame">data.frame</a></code>s, which returns
the lengths of the <code>row.names</code> attribute of <code>x</code> and
of <code>x</code> (as the numbers of rows and columns respectively).
</p>


<h3>Value</h3>

<p>For an array (and hence in particular, for a matrix) <code>dim</code> retrieves
the <code>dim</code> attribute of the object.  It is <code>NULL</code> or a vector
of mode <code><a href="#topic+integer">integer</a></code>.
</p>
<p>The replacement method changes the <code>"dim"</code> attribute (provided the
new value is compatible) and removes any <code>"dimnames"</code> <em>and</em>
<code>"names"</code> attributes.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ncol">ncol</a></code>, <code><a href="#topic+nrow">nrow</a></code> and <code><a href="#topic+dimnames">dimnames</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:12 ; dim(x) &lt;- c(3,4)
x

# simple versions of nrow and ncol could be defined as follows
nrow0 &lt;- function(x) dim(x)[1]
ncol0 &lt;- function(x) dim(x)[2]
</code></pre>

<hr>
<h2 id='dimnames'>Dimnames of an Object</h2><span id='topic+dimnames'></span><span id='topic+dimnames+3C-'></span><span id='topic+dimnames.data.frame'></span><span id='topic+dimnames+3C-.data.frame'></span><span id='topic+provideDimnames'></span>

<h3>Description</h3>

<p>Retrieve or set the dimnames of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimnames(x)
dimnames(x) &lt;- value

provideDimnames(x, sep = "", base = list(LETTERS), unique = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dimnames_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, for example a matrix, array or data frame.</p>
</td></tr>
<tr><td><code id="dimnames_+3A_value">value</code></td>
<td>
<p>a possible value for <code>dimnames(x)</code>: see the
&lsquo;Value&rsquo; section.</p>
</td></tr>
<tr><td><code id="dimnames_+3A_sep">sep</code></td>
<td>
<p>a character string, used to separate <code>base</code>
symbols and digits in the constructed dimnames.</p>
</td></tr>
<tr><td><code id="dimnames_+3A_base">base</code></td>
<td>
<p>a non-empty <code><a href="#topic+list">list</a></code> of character vectors.  The
list components are used in turn (and recycled when needed) to
construct replacements for empty dimnames components.  See also the
examples.</p>
</td></tr>
<tr><td><code id="dimnames_+3A_unique">unique</code></td>
<td>
<p>logical indicating that the dimnames constructed are
unique within each dimension in the sense of <code><a href="#topic+make.unique">make.unique</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>dimnames</code> and <code>dimnames&lt;-</code> are generic.
</p>
<p>For an <code><a href="#topic+array">array</a></code> (and hence in particular, for a
<code><a href="#topic+matrix">matrix</a></code>), they retrieve or set the <code>dimnames</code>
attribute (see <a href="#topic+attributes">attributes</a>) of the object.  A list
<code>value</code> can have names, and these will be used to label the
dimensions of the array where appropriate.
</p>
<p>The replacement method for arrays/matrices coerces vector and factor
elements of <code>value</code> to character, but does not dispatch methods
for <code>as.character</code>.  It coerces zero-length elements to
<code>NULL</code>, and a zero-length list to <code>NULL</code>.  If <code>value</code>
is a list shorter than the number of dimensions, it is extended with
<code>NULL</code>s to the needed length.
</p>
<p>Both have methods for data frames.  The dimnames of a data frame are
its <code><a href="#topic+row.names">row.names</a></code> and its <code><a href="#topic+names">names</a></code>.  For the
replacement method each component of <code>value</code> will be coerced by
<code><a href="#topic+as.character">as.character</a></code>.
</p>
<p>For a 1D matrix the <code><a href="#topic+names">names</a></code> are the same thing as the
(only) component of the <code>dimnames</code>.
</p>
<p>Both are <a href="#topic+primitive">primitive</a> functions.
</p>
<p><code>provideDimnames(x)</code> provides <code>dimnames</code> where
&ldquo;missing&rdquo;, such that its result has <code><a href="#topic+character">character</a></code>
dimnames for each component.  If <code>unique</code> is true as by default,
they are unique within each component via <code><a href="#topic+make.unique">make.unique</a>(*,
    sep=sep)</code>.
</p>


<h3>Value</h3>

<p>The dimnames of a matrix or array can be <code>NULL</code> (which is not
stored) or a list of the same length as <code>dim(x)</code>.  If a list, its
components are either <code>NULL</code> or a character vector with positive
length of the appropriate dimension of <code>x</code>.  The list can have
names.  It is possible that all components are <code>NULL</code>: such
dimnames may get converted to <code>NULL</code>.
</p>
<p>For the <code>"data.frame"</code> method both dimnames are character
vectors, and the rownames must contain no duplicates nor missing
values.
</p>
<p><code>provideDimnames(x)</code> returns <code>x</code>, with &ldquo;<code>NULL</code> -
free&rdquo; <code>dimnames</code>, i.e. each component a character vector of
correct length.
</p>


<h3>Note</h3>

<p>Setting components of the dimnames, e.g.,
<code>dimnames(A)[[1]] &lt;- value</code> is a common paradigm, but note that
it will not work if the value assigned is <code>NULL</code>.  Use
<code><a href="#topic+rownames">rownames</a></code> instead, or (as it does) manipulate the whole
dimnames list.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rownames">rownames</a></code>, <code><a href="#topic+colnames">colnames</a></code>;
<code><a href="#topic+array">array</a></code>, <code><a href="#topic+matrix">matrix</a></code>, <code><a href="#topic+data.frame">data.frame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simple versions of rownames and colnames
## could be defined as follows
rownames0 &lt;- function(x) dimnames(x)[[1]]
colnames0 &lt;- function(x) dimnames(x)[[2]]

(dn &lt;- dimnames(A &lt;- provideDimnames(N &lt;- array(1:24, dim = 2:4))))
A0 &lt;- A; dimnames(A)[2:3] &lt;- list(NULL)
stopifnot(identical(A0, provideDimnames(A)))
strd &lt;- function(x) utils::str(dimnames(x))
strd(provideDimnames(A, base= list(letters[-(1:9)], tail(LETTERS))))
strd(provideDimnames(N, base= list(letters[-(1:9)], tail(LETTERS)))) # recycling
strd(provideDimnames(A, base= list(c("AA","BB")))) # recycling on both levels
## set "empty dimnames":
provideDimnames(rbind(1, 2:3), base = list(""), unique=FALSE)
</code></pre>

<hr>
<h2 id='do.call'>Execute a Function Call</h2><span id='topic+do.call'></span>

<h3>Description</h3>

<p><code>do.call</code> constructs and executes a function call from a name or
a function and a list of arguments to be passed to it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do.call(what, args, quote = FALSE, envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do.call_+3A_what">what</code></td>
<td>
<p>either a function or a non-empty character string naming the
function to be called.</p>
</td></tr>
<tr><td><code id="do.call_+3A_args">args</code></td>
<td>
<p>a <em>list</em> of arguments to the function call.  The
<code>names</code> attribute of <code>args</code> gives the argument names.</p>
</td></tr>
<tr><td><code id="do.call_+3A_quote">quote</code></td>
<td>
<p>a logical value indicating whether to quote the
arguments.</p>
</td></tr>
<tr><td><code id="do.call_+3A_envir">envir</code></td>
<td>
<p>an environment within which to evaluate the call.  This
will be most useful if <code>what</code> is a character string and
the arguments are symbols or quoted expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>quote</code> is <code>FALSE</code>, the default, then the arguments are
evaluated (in the calling environment, not in <code>envir</code>).  If
<code>quote</code> is <code>TRUE</code> then each argument is quoted (see
<code><a href="#topic+quote">quote</a></code>) so that the effect of argument evaluation is to
remove the quotes &ndash; leaving the original arguments unevaluated when the
call is constructed.
</p>
<p>The behavior of some functions, such as <code><a href="#topic+substitute">substitute</a></code>,
will not be the same for functions evaluated using <code>do.call</code> as
if they were evaluated from the interpreter.  The precise semantics
are currently undefined and subject to change.
</p>


<h3>Value</h3>

<p>The result of the (evaluated) function call.
</p>


<h3>Warning</h3>

<p>This should not be used to attempt to evade restrictions on the use of
<code>.Internal</code> and other non-API calls.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+call">call</a></code> which creates an unevaluated call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>do.call("complex", list(imaginary = 1:3))

## if we already have a list (e.g., a data frame)
## we need c() to add further arguments
tmp &lt;- expand.grid(letters[1:2], 1:3, c("+", "-"))
do.call("paste", c(tmp, sep = ""))

do.call(paste, list(as.name("A"), as.name("B")), quote = TRUE)

## examples of where objects will be found.
A &lt;- 2
f &lt;- function(x) print(x^2)
env &lt;- new.env()
assign("A", 10, envir = env)
assign("f", f, envir = env)
f &lt;- function(x) print(x)
f(A)                                      # 2
do.call("f", list(A))                     # 2
do.call("f", list(A), envir = env)        # 4
do.call( f,  list(A), envir = env)        # 2
do.call("f", list(quote(A)), envir = env) # 100
do.call( f,  list(quote(A)), envir = env) # 10
do.call("f", list(as.name("A")), envir = env) # 100

eval(call("f", A))                      # 2
eval(call("f", quote(A)))               # 2
eval(call("f", A), envir = env)         # 4
eval(call("f", quote(A)), envir = env)  # 100
</code></pre>

<hr>
<h2 id='dontCheck'>Identity Function to Suppress Checking</h2><span id='topic+dontCheck'></span>

<h3>Description</h3>

<p>The <code>dontCheck</code> function is the same as <code><a href="#topic+identity">identity</a></code>, but 
is interpreted by <code>R CMD check</code> code analysis as a directive
to suppress checking of <code>x</code>.  Currently this is only used by
<code><a href="tools.html#topic+checkFF">checkFF</a>(registration = TRUE)</code>
when checking the <code>.NAME</code> argument of foreign function calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dontCheck(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dontCheck_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>suppressForeignCheck</code> which explains why that and
<code>dontCheck</code> are undesirable and should be avoided if at all
possible.
</p>

<hr>
<h2 id='dots'>..., <code>..1</code>, etc used in Functions</h2><span id='topic+dots'></span><span id='topic+...'></span><span id='topic+..1'></span><span id='topic+..2'></span><span id='topic+...elt'></span><span id='topic+...length'></span><span id='topic+...names'></span>

<h3>Description</h3>

<p><code>...</code> and <code>..1</code>, <code>..2</code> etc are used to refer to
arguments passed down from a calling function.  These (and the
following) can only be used <em>inside</em> a function which has
<code>...</code> among its formal arguments.
</p>
<p><code>...elt(n)</code> is a functional way to get <code>..<var>n</var></code> and
basically the same as <code>eval(paste0("..", n))</code>, just more elegant
and efficient.
Note that <code>switch(n, ...)</code> is very close, differing by returning
<code>NULL</code> invisibly instead of an error when <code>n</code> is zero or
too large.
</p>
<p><code>...length()</code> returns the number of expressions in <code>...</code>, and
<code>...names()</code> the <code><a href="#topic+names">names</a></code>.
These are the same as <code>length(list(...))</code> or <code>names(list(...))</code>
but without evaluating the expressions in <code>...</code> (which happens with
<code>list(...)</code>).
</p>
<p>Evaluating elements of <code>...</code> with <code>..1</code>, <code>..2</code>,
<code>...elt(n)</code>, etc. propagates <a href="#topic+invisible">visibility</a>. This
is consistent with the evaluation of named arguments which also
propagates visibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>...length()
...names()
...elt(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dots_+3A_n">n</code></td>
<td>
<p>a positive integer, not larger than the number of expressions
in ..., which is the same as <code>...length()</code> which is the same
as <code>length(list(...))</code>, but the latter evaluates all
expressions in <code>...</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>...</code> and <code>..1</code>, <code>..2</code> are <em>reserved</em> words in
<span class="rlang"><b>R</b></span>, see <code><a href="#topic+Reserved">Reserved</a></code>.
</p>
<p>For more, see the
<a href="/doc/manual/R-intro.html#The-three-dots-argument">Introduction to R</a>
manual for usage of these syntactic elements,
and <a href="methods.html#topic+dotsMethods">dotsMethods</a> for their use in formal (S4) methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tst &lt;- function(n, ...) ...elt(n)
tst(1, pi=pi*0:1, 2:4) ## [1] 0.000000 3.141593
tst(2, pi=pi*0:1, 2:4) ## [1] 2 3 4
try(tst(1)) # -&gt; Error about '...' not containing an element.

tst.dl  &lt;- function(x, ...) ...length()
tst.dns &lt;- function(x, ...) ...names()
tst.dl(1:10)    # 0  (because the first argument is 'x')
tst.dl(4, 5)    # 1
tst.dl(4, 5, 6) # 2  namely '5, 6'
tst.dl(4, 5, 6, 7, sin(1:10), "foo"/"bar") # 5.    Note: no evaluation!
tst.dns(4, foo=5, 6, bar=7, sini = sin(1:10), "foo"/"bar")
##        "foo"  "" "bar"  "sini"               ""

## From R 4.1.0 to 4.1.2, ...names() sometimes did not match names(list(...));
## check and show (these examples all would've failed):
chk.n2 &lt;- function(...) stopifnot(identical(print(...names()), names(list(...))))
chk.n2(4, foo=5, 6, bar=7, sini = sin(1:10), "bar")
chk.n2()
chk.n2(1,2)
</code></pre>

<hr>
<h2 id='double'>Double-Precision Vectors</h2><span id='topic+double'></span><span id='topic+as.double'></span><span id='topic+is.double'></span><span id='topic+single'></span><span id='topic+as.single'></span><span id='topic+as.single.default'></span>

<h3>Description</h3>

<p>Create, coerce to or test for a double-precision vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double(length = 0)
as.double(x, ...)
is.double(x)

single(length = 0)
as.single(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.
Double values will be coerced to integer:
supplying an argument of length other than one is an error.</p>
</td></tr>
<tr><td><code id="double_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="double_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>double</code> creates a double-precision vector of the specified
length.  The elements of the vector are all equal to <code>0</code>.
It is identical to <code><a href="#topic+numeric">numeric</a></code>.
</p>
<p><code>as.double</code> is a generic function.  It is identical to
<code>as.numeric</code>.  Methods should return an object of base type
<code>"double"</code>.
</p>
<p><code>is.double</code> is a test of double <a href="#topic+type">type</a>.
</p>
<p><em><span class="rlang"><b>R</b></span> has no single precision data type.  All real numbers are
stored in double precision format</em>.  The functions <code>as.single</code>
and <code>single</code> are identical to <code>as.double</code> and <code>double</code>
except they set the attribute <code>Csingle</code> that is used in the
<code><a href="#topic+.C">.C</a></code> and <code><a href="#topic+.Fortran">.Fortran</a></code> interface, and they are
intended only to be used in that context.
</p>


<h3>Value</h3>

<p><code>double</code> creates a double-precision vector of the specified
length.  The elements of the vector are all equal to <code>0</code>.
</p>
<p><code>as.double</code> attempts to coerce its argument to be of double type:
like <code><a href="#topic+as.vector">as.vector</a></code> it strips attributes including names.
(To ensure that an object is of double type without stripping
attributes, use <code><a href="#topic+storage.mode">storage.mode</a></code>.)  Character strings
containing optional whitespace followed by either a decimal
representation or a hexadecimal representation (starting with
<code>0x</code> or <code>0X</code>) can be converted, as can special values such
as <code>"NA"</code>, <code>"NaN"</code>, <code>"Inf"</code> and <code>"infinity"</code>,
irrespective of case.
</p>
<p><code>as.double</code> for factors yields the codes underlying the factor
levels, not the numeric representation of the labels, see also
<code><a href="#topic+factor">factor</a></code>.
</p>
<p><code>is.double</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is of double <a href="#topic+type">type</a> or not.
</p>


<h3>Double-precision values</h3>

<p>All <span class="rlang"><b>R</b></span> platforms are required to work with values conforming to the
<abbr>IEC</abbr> 60559 (also known as IEEE 754) standard.  This basically works
with a precision of 53 bits, and represents to that precision a range
of absolute values from about <code class="reqn">2 \times 10^{-308}</code> to
<code class="reqn">2 \times 10^{308}</code>.  It also has special values
<code><a href="#topic+NaN">NaN</a></code> (many of them), plus and minus infinity and plus and
minus zero (although <span class="rlang"><b>R</b></span> acts as if these are the same).  There are
also <em>denormal(ized)</em> (or <em>subnormal</em>) numbers with values
below the range given above but represented to less precision.
</p>
<p>See <code><a href="#topic+.Machine">.Machine</a></code> for precise information on these limits.
Note that ultimately how double precision numbers are handled is down
to the CPU/<abbr>FPU</abbr> and compiler.
</p>
<p>In IEEE 754-2008/<abbr>IEC</abbr>60559:2011 this is called &lsquo;binary64&rsquo; format.
</p>


<h3>Note on names</h3>

<p>It is a historical anomaly that <span class="rlang"><b>R</b></span> has two names for its
floating-point vectors, <code><a href="#topic+double">double</a></code> and <code><a href="#topic+numeric">numeric</a></code>
(and formerly had <code>real</code>).
</p>
<p><code>double</code> is the name of the <a href="#topic+type">type</a>.
<code>numeric</code> is the name of the <a href="#topic+mode">mode</a> and also of the implicit
<a href="#topic+class">class</a>.  As an S4 formal class, use <code>"numeric"</code>.
</p>
<p>The potential confusion is that <span class="rlang"><b>R</b></span> has used <em><a href="#topic+mode">mode</a></em>
<code>"numeric"</code> to mean &lsquo;double or integer&rsquo;, which conflicts
with the S4 usage.  Thus <code>is.numeric</code> tests the mode, not the
class, but <code>as.numeric</code> (which is identical to <code>as.double</code>)
coerces to the class.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p><a href="https://en.wikipedia.org/wiki/IEEE_754-1985">https://en.wikipedia.org/wiki/IEEE_754-1985</a>,
<a href="https://en.wikipedia.org/wiki/IEEE_754-2008">https://en.wikipedia.org/wiki/IEEE_754-2008</a>,
<a href="https://en.wikipedia.org/wiki/IEEE_754-2019">https://en.wikipedia.org/wiki/IEEE_754-2019</a>,
<a href="https://en.wikipedia.org/wiki/Double_precision">https://en.wikipedia.org/wiki/Double_precision</a>,
<a href="https://en.wikipedia.org/wiki/Denormal_number">https://en.wikipedia.org/wiki/Denormal_number</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+integer">integer</a></code>, <code><a href="#topic+numeric">numeric</a></code>, <code><a href="#topic+storage.mode">storage.mode</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.double(1)
all(double(3) == 0)
</code></pre>

<hr>
<h2 id='dput'>Write an Object to a File or Recreate it</h2><span id='topic+dput'></span><span id='topic+dget'></span>

<h3>Description</h3>

<p>Writes an ASCII text representation of an <span class="rlang"><b>R</b></span> object to a file, the <span class="rlang"><b>R</b></span>
console, or a connection, or uses one to recreate the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dput(x, file = "",
     control = c("keepNA", "keepInteger", "niceNames", "showAttributes"))

dget(file, keep.source = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dput_+3A_x">x</code></td>
<td>
<p>an object.</p>
</td></tr>
<tr><td><code id="dput_+3A_file">file</code></td>
<td>
<p>either a character string naming a file or a
<a href="#topic+connection">connection</a>. <code>""</code> indicates output to the console.</p>
</td></tr>
<tr><td><code id="dput_+3A_control">control</code></td>
<td>
<p>character vector (or <code>NULL</code>) of deparsing options.
<code>control = "all"</code> is thorough, see <code><a href="#topic+.deparseOpts">.deparseOpts</a></code>.</p>
</td></tr>
<tr><td><code id="dput_+3A_keep.source">keep.source</code></td>
<td>
<p>logical: should the source formatting be retained when
parsing functions, if possible?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dput</code> opens <code>file</code> and deparses the object <code>x</code> into
that file.  The object name is not written (unlike <code>dump</code>).
If <code>x</code> is a function the associated environment is stripped.
Hence scoping information can be lost.
</p>
<p>Deparsing an object is difficult, and not always possible.  With the
default <code>control</code>, <code>dput()</code> attempts to deparse in a way
that is readable, but for more complex or unusual objects (see
<code><a href="#topic+dump">dump</a></code>), not likely
to be parsed as identical to the original.  Use <code>control = "all"</code>
for the most complete deparsing; use <code>control = NULL</code> for the
simplest deparsing, not even including attributes.
</p>
<p><code>dput</code> will warn if fewer characters were written to a file than
expected, which may indicate a full or corrupt file system.
</p>
<p>To display saved source rather than deparsing the internal
representation include <code>"useSource"</code> in <code>control</code>.  <span class="rlang"><b>R</b></span>
currently saves source only for function definitions.  If you do not
care about source representation (e.g., for a data object), for speed
set <code>options(keep.source = FALSE</code>) when calling <code>source</code>.
</p>


<h3>Value</h3>

<p>For <code>dput</code>, the first argument invisibly.
</p>
<p>For <code>dget</code>, the object created.
</p>


<h3>Note</h3>

<p>This is <b>not</b> a good way to transfer objects between <span class="rlang"><b>R</b></span> sessions.
<code><a href="#topic+dump">dump</a></code> is better, but the functions <code><a href="#topic+save">save</a></code> and
<code><a href="#topic+saveRDS">saveRDS</a></code> are designed to be used for transporting <span class="rlang"><b>R</b></span> data,
and will work with <span class="rlang"><b>R</b></span> objects that <code>dput</code> does not handle correctly
as well as being much faster.
</p>
<p>To avoid the risk of a source attribute out of sync with the actual
function definition, the source attribute of a function will never
be written as an attribute.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+deparse">deparse</a></code>, <code><a href="#topic+.deparseOpts">.deparseOpts</a></code>,
<code><a href="#topic+dump">dump</a></code>, <code><a href="#topic+write">write</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fil &lt;- tempfile()
## Write an ASCII version of the 'base' function mean() to our temp file, ..
dput(base::mean, fil)
## ... read it back into 'bar' and confirm it is the same
bar &lt;- dget(fil)
stopifnot(all.equal(bar, base::mean, check.environment = FALSE))

## Create a function with comments
baz &lt;- function(x) {
  # Subtract from one
  1-x
}
## and display it
dput(baz)
## and now display the saved source
dput(baz, control = "useSource")

## Numeric values:
xx &lt;- pi^(1:3)
dput(xx)
dput(xx, control = "digits17")
dput(xx, control = "hexNumeric")
dput(xx, fil); dget(fil) - xx # slight rounding on all platforms
dput(xx, fil, control = "digits17")
dget(fil) - xx # slight rounding on some platforms
dput(xx, fil, control = "hexNumeric"); dget(fil) - xx
unlink(fil)

xn &lt;- setNames(xx, paste0("pi^",1:3))
dput(xn) # nicer, now "niceNames" being part of default 'control'
dput(xn, control = "S_compat") # no names
## explicitly asking for output as in R &lt; 3.5.0:
dput(xn, control = c("keepNA", "keepInteger", "showAttributes"))
</code></pre>

<hr>
<h2 id='drop'>Drop Redundant Extent Information</h2><span id='topic+drop'></span>

<h3>Description</h3>

<p>Delete the dimensions of an array which have only one level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_+3A_x">x</code></td>
<td>
<p>an array (including a matrix).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>x</code> is an object with a <code>dim</code> attribute (e.g., a matrix
or <code><a href="#topic+array">array</a></code>), then <code>drop</code> returns an object like
<code>x</code>, but with any extents of length one removed.  Any
accompanying <code>dimnames</code> attribute is adjusted and returned with
<code>x</code>: if the result is a vector the <code>names</code> are taken from
the <code>dimnames</code> (if any).  If the result is a length-one vector,
the names are taken from the first dimension with a dimname.
</p>
<p>Array subsetting (<code><a href="#topic++5B">[</a></code>) performs this reduction unless used
with <code>drop = FALSE</code>, but sometimes it is useful to invoke
<code>drop</code> directly.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+drop1">drop1</a></code> which is used for dropping terms in models, and
<code><a href="#topic+droplevels">droplevels</a></code> used for dropping unused levels from a <code><a href="#topic+factor">factor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dim(drop(array(1:12, dim = c(1,3,1,1,2,1,2)))) # = 3 2 2
drop(1:3 %*% 2:4)  # scalar product
</code></pre>

<hr>
<h2 id='droplevels'>Drop Unused Levels from Factors</h2><span id='topic+droplevels'></span><span id='topic+droplevels.factor'></span><span id='topic+droplevels.data.frame'></span>

<h3>Description</h3>

<p>The function <code>droplevels</code> is used to drop unused levels from a
<code><a href="#topic+factor">factor</a></code> or, more commonly, from factors in a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>droplevels(x, ...)
## S3 method for class 'factor'
droplevels(x, exclude = if(anyNA(levels(x))) NULL else NA, ...)
## S3 method for class 'data.frame'
droplevels(x, except, exclude, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="droplevels_+3A_x">x</code></td>
<td>
<p>an object from which to drop unused factor levels.</p>
</td></tr>
<tr><td><code id="droplevels_+3A_exclude">exclude</code></td>
<td>
<p>passed to <code><a href="#topic+factor">factor</a>()</code>; factor levels which
should be excluded from the result even if present.  Note that this
was <em>implicitly</em> <code>NA</code> in <span class="rlang"><b>R</b></span> &lt;= 3.3.1 which did drop
<code>NA</code> levels even when present in <code>x</code>, contrary to the
documentation.  The current default is compatible with <code>x[ , drop=TRUE]</code>.</p>
</td></tr>
<tr><td><code id="droplevels_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods.</p>
</td></tr>
<tr><td><code id="droplevels_+3A_except">except</code></td>
<td>
<p>indices of columns from which <em>not</em> to drop levels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method for class <code>"factor"</code> is currently equivalent to
<code>factor(x, exclude=exclude)</code>.  For the data frame method, you
should rarely specify <code>exclude</code> &ldquo;globally&rdquo; for all factor
columns; rather the default uses the same factor-specific
<code>exclude</code> as the factor method itself.
</p>
<p>The <code>except</code> argument follows the usual indexing rules.
</p>


<h3>Value</h3>

<p><code>droplevels</code> returns an object of the same class as <code>x</code></p>


<h3>Note</h3>

<p> This function was introduced in R 2.12.0.  It is primarily
intended for cases where one or more factors in a data frame
contains only elements from a reduced level set after
subsetting.  (Notice that subsetting does <em>not</em> in general drop
unused levels).  By default, levels are dropped from all factors in a
data frame, but the <code>except</code> argument allows you to specify
columns for which this is not wanted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subset">subset</a></code> for subsetting data frames.
<code><a href="#topic+factor">factor</a></code> for definition of factors.
<code><a href="#topic+drop">drop</a></code> for dropping array dimensions.
<code><a href="stats.html#topic+drop1">drop1</a></code> for dropping terms from a model.
<code><a href="#topic++5B.factor">[.factor</a></code> for subsetting of factors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>aq &lt;- transform(airquality, Month = factor(Month, labels = month.abb[5:9]))
aq &lt;- subset(aq, Month != "Jul")
table(           aq $Month)
table(droplevels(aq)$Month)
</code></pre>

<hr>
<h2 id='dump'>Text Representations of R Objects</h2><span id='topic+dump'></span>

<h3>Description</h3>

<p>This function takes a vector of names of <span class="rlang"><b>R</b></span> objects and produces
text representations of the objects on a file or connection.
A <code>dump</code> file can usually be <code><a href="#topic+source">source</a></code>d into another
<span class="rlang"><b>R</b></span> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dump(list, file = "dumpdata.R", append = FALSE,
     control = "all", envir = parent.frame(), evaluate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dump_+3A_list">list</code></td>
<td>
<p>character vector (or <code><a href="#topic+NULL">NULL</a></code>).  The names of <span class="rlang"><b>R</b></span> objects to be dumped.</p>
</td></tr>
<tr><td><code id="dump_+3A_file">file</code></td>
<td>
<p>either a character string naming a file or a
<a href="#topic+connection">connection</a>.  <code>""</code> indicates output to the console.</p>
</td></tr>
<tr><td><code id="dump_+3A_append">append</code></td>
<td>
<p>if <code>TRUE</code> and <code>file</code> is a character string,
output will be appended to <code>file</code>; otherwise, it will overwrite
the contents of <code>file</code>.</p>
</td></tr>
<tr><td><code id="dump_+3A_control">control</code></td>
<td>
<p>character vector (or <code>NULL</code>) indicating deparsing
options.  See <code><a href="#topic+.deparseOpts">.deparseOpts</a></code> for their description.</p>
</td></tr>
<tr><td><code id="dump_+3A_envir">envir</code></td>
<td>
<p>the environment to search for objects.</p>
</td></tr>
<tr><td><code id="dump_+3A_evaluate">evaluate</code></td>
<td>
<p>logical.  Should promises be evaluated?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If some of the objects named do not exist (in scope), they are
omitted, with a warning.  If <code>file</code> is a file and no objects
exist then no file is created.
</p>
<p><code><a href="#topic+source">source</a></code>ing may not produce an identical copy of
<code>dump</code>ed objects.  A warning is issued if it is likely that
problems will arise, for example when dumping exotic or complex
objects (see the Note).
</p>
<p><code>dump</code> will also warn if fewer characters were written to a file
than expected, which may indicate a full or corrupt file system.
</p>
<p>A <code>dump</code> file can be <code><a href="#topic+source">source</a></code>d into another <span class="rlang"><b>R</b></span> (or
perhaps S) session, but the functions <code><a href="#topic+save">save</a></code> and
<code><a href="#topic+saveRDS">saveRDS</a></code> are designed to
be used for transporting <span class="rlang"><b>R</b></span> data, and will work with <span class="rlang"><b>R</b></span> objects that
<code>dump</code> does not handle.  For maximal reproducibility use
<code>control = "exact"</code>.
</p>
<p>To produce a more readable representation of an object, use
<code>control = NULL</code>.  This will skip attributes, and will make other
simplifications that make <code>source</code> less likely to produce an
identical copy.  See <code><a href="#topic+.deparseOpts">.deparseOpts</a></code> for details.
</p>
<p>To deparse the internal representation of a function rather than
displaying the saved source, use <code>control = c("keepInteger",
    "warnIncomplete", "keepNA")</code>.  This will lose all formatting and
comments, but may be useful in those cases where the saved source is
no longer correct.
</p>
<p>Promises will normally only be encountered by users as a result of
lazy-loading (when the default <code>evaluate = TRUE</code> is essential)
and after the use of <code><a href="#topic+delayedAssign">delayedAssign</a></code>,
when <code>evaluate = FALSE</code> might be intended.
</p>


<h3>Value</h3>

<p>An invisible character vector containing the names of the objects
which were dumped.
</p>


<h3>Note</h3>

<p>As <code>dump</code> is defined in the base namespace, the <span class="pkg">base</span>
package will be searched <em>before</em> the global environment unless
<code>dump</code> is called from the top level prompt or the <code>envir</code>
argument is given explicitly.
</p>
<p>To avoid the risk of a source attribute becoming out of sync with the
actual function definition, the source attribute of a function will
never be dumped as an attribute.
</p>
<p>Currently environments, external pointers, weak references and objects
of type <code>S4</code> are not deparsed in a way that can be
<code>source</code>d.  In addition, <a href="#topic+language+20objects">language objects</a> are deparsed in a
simple way whatever the value of <code>control</code>, and this includes not
dumping their attributes (which will result in a warning).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.deparseOpts">.deparseOpts</a></code> for available <code>control</code> settings;
<code><a href="#topic+dput">dput</a>()</code>, <code><a href="#topic+dget">dget</a>()</code> and <code><a href="#topic+deparse">deparse</a>()</code>
for related functions using identical internal deparsing functionality.
</p>
<p><code><a href="#topic+write">write</a></code>, <code><a href="utils.html#topic+write.table">write.table</a></code>, etc for &ldquo;dumping&rdquo;
data to (text) files.
</p>
<p><code><a href="#topic+save">save</a></code> and <code><a href="#topic+saveRDS">saveRDS</a></code> for a more reliable way to
save <span class="rlang"><b>R</b></span> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1; y &lt;- 1:10
fil &lt;- tempfile(fileext=".Rdmped")
dump(ls(pattern = '^[xyz]'), fil)
print(.Last.value)
unlink(fil)
</code></pre>

<hr>
<h2 id='duplicated'>Determine Duplicate Elements</h2><span id='topic+duplicated'></span><span id='topic+duplicated.default'></span><span id='topic+duplicated.data.frame'></span><span id='topic+duplicated.matrix'></span><span id='topic+duplicated.array'></span><span id='topic+anyDuplicated'></span><span id='topic+anyDuplicated.default'></span><span id='topic+anyDuplicated.array'></span><span id='topic+anyDuplicated.matrix'></span><span id='topic+anyDuplicated.data.frame'></span>

<h3>Description</h3>

<p><code>duplicated()</code> determines which elements of a vector or data
frame are duplicates
of elements with smaller subscripts, and returns a logical vector
indicating which elements (rows) are duplicates.
</p>
<p><code>anyDuplicated(.)</code> is a &ldquo;generalized&rdquo; more efficient
version <code>any(duplicated(.))</code>, returning positive integer indices
instead of just <code>TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplicated(x, incomparables = FALSE, ...)

## Default S3 method:
duplicated(x, incomparables = FALSE,
           fromLast = FALSE, nmax = NA, ...)

## S3 method for class 'array'
duplicated(x, incomparables = FALSE, MARGIN = 1,
           fromLast = FALSE, ...)

anyDuplicated(x, incomparables = FALSE, ...)
## Default S3 method:
anyDuplicated(x, incomparables = FALSE,
           fromLast = FALSE, ...)
## S3 method for class 'array'
anyDuplicated(x, incomparables = FALSE,
           MARGIN = 1, fromLast = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duplicated_+3A_x">x</code></td>
<td>
<p>a vector or a data frame or an array or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="duplicated_+3A_incomparables">incomparables</code></td>
<td>
<p>a vector of values that cannot be compared.
<code>FALSE</code> is a special value, meaning that all values can be
compared, and may be the only value accepted for methods other than
the default.  It will be coerced internally to the same type as
<code>x</code>.</p>
</td></tr>
<tr><td><code id="duplicated_+3A_fromlast">fromLast</code></td>
<td>
<p>logical indicating if duplication should be considered
from the reverse side, i.e., the last (or rightmost) of identical
elements would correspond to <code>duplicated = FALSE</code>.</p>
</td></tr>
<tr><td><code id="duplicated_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of unique items expected (greater than one).</p>
</td></tr>
<tr><td><code id="duplicated_+3A_...">...</code></td>
<td>
<p>arguments for particular methods.</p>
</td></tr>
<tr><td><code id="duplicated_+3A_margin">MARGIN</code></td>
<td>
<p>the array margin to be held fixed: see
<code><a href="#topic+apply">apply</a></code>, and note that <code>MARGIN = 0</code> may be useful.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are generic functions with methods for vectors (including
lists), data frames and arrays (including matrices).
</p>
<p>For the default methods, and whenever there are equivalent method
definitions for <code>duplicated</code> and <code>anyDuplicated</code>,
<code>anyDuplicated(x, ...)</code> is a &ldquo;generalized&rdquo; shortcut for
<code>any(duplicated(x, ...))</code>, in the sense that it returns the
<em>index</em> <code>i</code> of the first duplicated entry <code>x[i]</code> if
there is one, and <code>0</code> otherwise.  Their behaviours may be
different when at least one of <code>duplicated</code> and
<code>anyDuplicated</code> has a relevant method.
</p>
<p><code>duplicated(x, fromLast = TRUE)</code> is equivalent to but faster than
<code>rev(duplicated(rev(x)))</code>.
</p>
<p>The array method calculates for each element of the sub-array
specified by <code>MARGIN</code> if the remaining dimensions are identical
to those for an earlier (or later, when <code>fromLast = TRUE</code>) element
(in row-major order).  This would most commonly be used to find
duplicated rows (the default) or columns (with <code>MARGIN = 2</code>).
Note that <code>MARGIN = 0</code> returns an array of the same
dimensionality attributes as <code>x</code>.
</p>
<p>Missing values (<code>"<a href="#topic+NA">NA</a>"</code>) are regarded as equal, numeric and
complex ones differing from <code>NaN</code>; character strings will be compared in a
&ldquo;common encoding&rdquo;; for details, see <code><a href="#topic+match">match</a></code> (and
<code><a href="#topic+unique">unique</a></code>) which use the same concept.
</p>
<p>Values in <code>incomparables</code> will never be marked as duplicated.
This is intended to be used for a fairly small set of values and will
not be efficient for a very large set.
</p>
<p>Except for factors, logical and raw vectors the default <code>nmax = NA</code> is
equivalent to <code>nmax = length(x)</code>.  Since a hash table of size
<code>8*nmax</code> bytes is allocated, setting <code>nmax</code> suitably can
save large amounts of memory.  For factors it is automatically set to
the smaller of <code>length(x)</code> and the number of levels plus one (for
<code>NA</code>).  If <code>nmax</code> is set too small there is liable to be an
error: <code>nmax = 1</code> is silently ignored.
</p>
<p><a href="#topic+Long+20vectors">Long vectors</a> are supported for the default method of
<code>duplicated</code>, but may only be usable if <code>nmax</code> is supplied.
</p>


<h3>Value</h3>

<p><code>duplicated()</code>:
For a vector input, a logical vector of the same length as
<code>x</code>.  For a data frame, a logical vector with one element for
each row.  For a matrix or array, and when <code>MARGIN = 0</code>, a
logical array with the same dimensions and dimnames.
</p>
<p><code>anyDuplicated()</code>: an integer or real vector of length one with
value the 1-based index of the first duplicate if any, otherwise
<code>0</code>.
</p>


<h3>Warning</h3>

<p>Using this for lists is potentially slow, especially if the elements
are not atomic vectors (see <code><a href="#topic+vector">vector</a></code>) or differ only
in their attributes.  In the worst case it is <code class="reqn">O(n^2)</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unique">unique</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(9:20, 1:5, 3:7, 0:8)
## extract unique elements
(xu &lt;- x[!duplicated(x)])
## similar, same elements but different order:
(xu2 &lt;- x[!duplicated(x, fromLast = TRUE)])

## xu == unique(x) but unique(x) is more efficient
stopifnot(identical(xu,  unique(x)),
          identical(xu2, unique(x, fromLast = TRUE)))

duplicated(iris)[140:143]

duplicated(iris3, MARGIN = c(1, 3))
anyDuplicated(iris) ## 143

anyDuplicated(x)
anyDuplicated(x, fromLast = TRUE)
</code></pre>

<hr>
<h2 id='dyn.load'>Foreign Function Interface</h2><span id='topic+dyn.load'></span><span id='topic+dyn.unload'></span><span id='topic+is.loaded'></span><span id='topic+R_MAX_NUM_DLLS'></span>

<h3>Description</h3>

<p>Load or unload DLLs (also known as shared objects), and test whether a
C function or Fortran subroutine is available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dyn.load(x, local = TRUE, now = TRUE, ...)
dyn.unload(x)

is.loaded(symbol, PACKAGE = "", type = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dyn.load_+3A_x">x</code></td>
<td>
<p>a character string giving the pathname to a DLL, also known
as a dynamic shared object.  (See &lsquo;Details&rsquo; for what these
terms mean.)</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_local">local</code></td>
<td>
<p>a logical value controlling whether the symbols in the
DLL are stored in their own local table and not shared
across DLLs, or added to the global symbol table.  Whether this has
any effect is system-dependent.
</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_now">now</code></td>
<td>
<p>a logical controlling whether all symbols are resolved (and
relocated) immediately when the library is loaded or deferred until they
are used.  This control is useful for developers testing whether a
library is complete and has all the necessary symbols, and for users
to ignore missing symbols.  Whether this has any effect is system-dependent.
</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_...">...</code></td>
<td>
<p>other arguments for future expansion.
</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_symbol">symbol</code></td>
<td>
<p>a character string giving a symbol name.</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_package">PACKAGE</code></td>
<td>
<p>if supplied, confine the search for the <code>name</code> to
the DLL given by this argument (plus the conventional extension,
&lsquo;<span class="file">.so</span>&rsquo;, &lsquo;<span class="file">.sl</span>&rsquo;, &lsquo;<span class="file">.dll</span>&rsquo;, ...).  This is intended to
add safety for packages, which can ensure by using this argument
that no other package can override their external symbols.  This is
used in the same way as in the <code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Call">.Call</a></code>,
<code><a href="#topic+.Fortran">.Fortran</a></code> and <code><a href="#topic+.External">.External</a></code> functions.</p>
</td></tr>
<tr><td><code id="dyn.load_+3A_type">type</code></td>
<td>
<p>the type of symbol to look for: can be any (<code>""</code>, the
default), <code>"Fortran"</code>, <code>"Call"</code> or <code>"External"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The objects <code>dyn.load</code> loads are called &lsquo;dynamically
loadable libraries&rsquo; (abbreviated to &lsquo;DLL&rsquo;) on all platforms
except macOS, which uses the term for a different sort
of object.  On Unix-alikes they are also called &lsquo;dynamic
shared objects&rsquo; (&lsquo;<abbr>DSO</abbr>&rsquo;), or &lsquo;shared objects&rsquo; for
short.  (The POSIX standards use &lsquo;executable object file&rsquo;,
but no one else does.)
</p>
<p>See &lsquo;See Also&rsquo; and the &lsquo;Writing R Extensions&rsquo; and
&lsquo;R Installation and Administration&rsquo; manuals for how to create
and install a suitable DLL.
</p>
<p>Unfortunately some rare platforms (e.g., Compaq Tru64) do not handle
the <code>PACKAGE</code> argument correctly, and may incorrectly find
symbols linked into <span class="rlang"><b>R</b></span>.
</p>
<p>The additional arguments to <code>dyn.load</code> mirror the different
aspects of the mode argument to the <code>dlopen()</code> routine on POSIX
systems.  They are available so that users can exercise greater control
over the loading process for an individual library.  In general, the
default values are appropriate and you should override them only if
there is good reason and you understand the implications.
</p>
<p>The <code>local</code> argument allows one to control whether the symbols in
the DLL being attached are visible to other DLLs.  While maintaining
the symbols in their own namespace is good practice, the ability to
share symbols across related &lsquo;chapters&rsquo; is useful in many
cases.  Additionally, on certain platforms and versions of an
operating system, certain libraries must have their symbols loaded
globally to successfully resolve all symbols.
</p>
<p>One should be careful of one potential side-effect of using lazy
loading via <code>now = FALSE</code>: if a routine is
called that has a missing symbol, the process will terminate
immediately.  The intended use is for library developers to call this with
value <code>TRUE</code> to check that all symbols are actually resolved and
for regular users to call it with <code>FALSE</code> so that missing symbols
can be ignored and the available ones can be called.
</p>
<p>The initial motivation for adding these was to avoid such termination
in the <code>_init()</code> routines of the Java virtual machine library.
However, symbols loaded locally may not be (read: probably) available
to other DLLs.  Those added to the global table are available to all
other elements of the application and so can be shared across two
different DLLs.
</p>
<p>Some (very old) systems do not provide (explicit) support for
local/global and lazy/eager symbol resolution.  This can be the source
of subtle bugs.  One can arrange to have warning messages emitted when
unsupported options are used.  This is done by setting either of the
options <code>verbose</code> or <code>warn</code> to be non-zero via the
<code><a href="#topic+options">options</a></code> function.
</p>
<p>There is a short discussion of these additional arguments with some
example code available at
<a href="https://www.stat.ucdavis.edu/~duncan/R/dynload/">https://www.stat.ucdavis.edu/~duncan/R/dynload/</a>.
</p>


<h3>Value</h3>

<p>The function <code>dyn.load</code> is used for its side effect which links
the specified DLL to the executing <span class="rlang"><b>R</b></span> image.  Calls to <code>.C</code>,
<code>.Call</code>, <code>.Fortran</code> and <code>.External</code> can then be used to
execute compiled C functions or Fortran subroutines contained in the
library.  The return value of <code>dyn.load</code> is an object of class
<code>DLLInfo</code>.  See <code><a href="#topic+getLoadedDLLs">getLoadedDLLs</a></code> for information about
this class.
</p>
<p>The function <code>dyn.unload</code> unlinks the DLL.  Note that unloading a
DLL and then re-loading a DLL of the same name may or may not work: on
Solaris it used the first version loaded. Note also that some DLLs cannot
be safely unloaded at all: unloading a DLL which implements C finalizers
but does not unregister them on unload causes R to crash.
</p>
<p><code>is.loaded</code> checks if the symbol name is loaded <em>and
searchable</em> and hence available for use as a character string value
for argument <code>.NAME</code> in <code>.C</code>, <code>.Fortran</code>,
<code>.Call</code>, or <code>.External</code>.  It will succeed if any one of the
four calling functions would succeed in using the entry point unless
<code>type</code> is specified.  (See <code><a href="#topic+.Fortran">.Fortran</a></code> for how Fortran
symbols are mapped.)  Note that symbols in base packages are not
searchable, and other packages can be so marked.
</p>


<h3>Warning</h3>

<p>Do not use <code>dyn.unload</code> on a DLL loaded by
<code><a href="#topic+library.dynam">library.dynam</a></code>: use <code><a href="#topic+library.dynam.unload">library.dynam.unload</a></code>.
This is needed for system housekeeping.
</p>


<h3>Note</h3>

<p><code>is.loaded</code> requires the name you would give to <code>.C</code> etc.
It must be a character string and so cannot be an <span class="rlang"><b>R</b></span> object as used
for registered native symbols (see &ldquo;Writing R Extensions&rdquo;
section 5.4.).  Some registered symbols are available by name but most are
not, including those in the examples below.
</p>
<p>By default, the maximum number of DLLs that can be loaded is now 614
when the OS limit on the number of open files allows or can be
increased, but less otherwise (but it will be at least 100).  A
specific maximum can be requested <em>via</em> the environment variable
<span class="env">R_MAX_NUM_DLLS</span>, which has to be set (to a value between 100 and
1000 inclusive) before starting an <span class="rlang"><b>R</b></span> session.  If the OS limit on
the number of open files does not allow using this maximum and cannot
be increased, <span class="rlang"><b>R</b></span> will fail to start with an error.  The maximum is not
allowed to be greater than 60% of the OS limit on the number of open
files (essentially unlimited on Windows, on Unix typically 1024, but
256 on macOS).  The limit can sometimes (including on macOS) be
modified using command <code>ulimit -n</code> (<code>sh</code>,
<code>bash</code>) or <code>limit descriptors</code> (<code>csh</code>) in the
shell used to launch <span class="rlang"><b>R</b></span>.  Increasing <span class="env">R_MAX_NUM_DLLS</span> comes with
some memory overhead, and be aware that many types of
<a href="#topic+connections">connections</a> also use file descriptors.
</p>
<p>If the OS limit on the number of open files cannot be determined, the
DLL limit is 100 and cannot be changed <em>via</em> <span class="env">R_MAX_NUM_DLLS</span>.
</p>
<p>The creation of DLLs and the runtime linking of them into executing
programs is very platform dependent.  In recent years there has been
some simplification in the process because the C subroutine call
<code>dlopen</code> has become the POSIX standard for doing this.  Under
Unix-alikes <code>dyn.load</code> uses the <code>dlopen</code> mechanism and
should work on all platforms which support it.  On Windows it uses the
standard mechanism (<code>LoadLibrary</code>) for loading DLLs.
</p>
<p>The original code for loading DLLs in Unix-alikes was provided by
Heiner Schwarte.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+library.dynam">library.dynam</a></code> to be used inside a package's
<code><a href="#topic+.onLoad">.onLoad</a></code> initialization.
</p>
<p><code><a href="utils.html#topic+SHLIB">SHLIB</a></code> for how to create suitable DLLs.
</p>
<p><code><a href="#topic+.C">.C</a></code>,
<code><a href="#topic+.Fortran">.Fortran</a></code>,
<code><a href="#topic+.External">.External</a></code>,
<code><a href="#topic+.Call">.Call</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## expect all of these to be false in R &gt;= 3.0.0 as these can only be
## used via registered symbols.
is.loaded("supsmu") # Fortran entry point in stats
is.loaded("supsmu", "stats", "Fortran")
is.loaded("PDF", type = "External") # pdf() device in grDevices
</code></pre>

<hr>
<h2 id='eapply'>Apply a Function Over Values in an Environment</h2><span id='topic+eapply'></span>

<h3>Description</h3>

<p><code>eapply</code> applies <code>FUN</code> to the named values from an
<code><a href="#topic+environment">environment</a></code> and returns the results as a list.  The user
can request that all named objects are used (normally names that begin
with a dot are not).  The output is not sorted and no enclosing
environments are searched.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eapply(env, FUN, ..., all.names = FALSE, USE.NAMES = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eapply_+3A_env">env</code></td>
<td>
<p>environment to be used.</p>
</td></tr>
<tr><td><code id="eapply_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied, found <em>via</em>
<code><a href="#topic+match.fun">match.fun</a></code>.
In the case of functions like <code>+</code>, <code>%*%</code>, etc., the
function name must be backquoted or quoted.</p>
</td></tr>
<tr><td><code id="eapply_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="eapply_+3A_all.names">all.names</code></td>
<td>
<p>a logical indicating whether to apply the function to
all values.</p>
</td></tr>
<tr><td><code id="eapply_+3A_use.names">USE.NAMES</code></td>
<td>
<p>logical indicating whether the resulting list should
have <code><a href="#topic+names">names</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named (unless <code>USE.NAMES = FALSE</code>) list.  Note that the order of
the components is arbitrary for hashed environments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+environment">environment</a></code>, <code><a href="#topic+lapply">lapply</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

env &lt;- new.env(hash = FALSE) # so the order is fixed
env$a &lt;- 1:10
env$beta &lt;- exp(-3:3)
env$logic &lt;- c(TRUE, FALSE, FALSE, TRUE)
# what have we there?
utils::ls.str(env)

# compute the mean for each list element
       eapply(env, mean)
unlist(eapply(env, mean, USE.NAMES = FALSE))

# median and quartiles for each element (making use of "..." passing):
eapply(env, quantile, probs = 1:3/4)
eapply(env, quantile)
</code></pre>

<hr>
<h2 id='eigen'>Spectral Decomposition of a Matrix</h2><span id='topic+eigen'></span><span id='topic+print.eigen'></span>

<h3>Description</h3>

<p>Computes eigenvalues and eigenvectors of numeric (double, integer,
logical) or complex matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigen(x, symmetric, only.values = FALSE, EISPACK = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigen_+3A_x">x</code></td>
<td>
<p>a numeric or complex matrix whose spectral decomposition is to
be computed.  Logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="eigen_+3A_symmetric">symmetric</code></td>
<td>
<p>if <code>TRUE</code>, the matrix is assumed to be symmetric
(or Hermitian if complex) and only its lower triangle (diagonal
included) is used.  If <code>symmetric</code> is not specified,
<code><a href="#topic+isSymmetric">isSymmetric</a>(x)</code> is used.</p>
</td></tr>
<tr><td><code id="eigen_+3A_only.values">only.values</code></td>
<td>
<p>if <code>TRUE</code>, only the eigenvalues are computed
and returned, otherwise both eigenvalues and eigenvectors are
returned.</p>
</td></tr>
<tr><td><code id="eigen_+3A_eispack">EISPACK</code></td>
<td>
<p>logical. Defunct and ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>symmetric</code> is unspecified, <code><a href="#topic+isSymmetric">isSymmetric</a>(x)</code>
determines if the matrix is symmetric up to plausible numerical
inaccuracies.  It is surer and typically much faster to set the value
yourself.
</p>
<p>Computing the eigenvectors is the slow part for large matrices.
</p>
<p>Computing the eigendecomposition of a matrix is subject to errors on a
real-world computer: the definitive analysis is Wilkinson (1965).  All
you can hope for is a solution to a problem suitably close to
<code>x</code>.  So even though a real asymmetric <code>x</code> may have an
algebraic solution with repeated real eigenvalues, the computed
solution may be of a similar matrix with complex conjugate pairs of
eigenvalues.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code (most often <code>1</code>): these can
only be interpreted by detailed study of the FORTRAN code.
</p>
<p>Missing, <code>NaN</code>  or infinite values in <code>x</code> will given
an error.
</p>


<h3>Value</h3>

<p>The spectral decomposition of <code>x</code> is returned as a list with components
</p>
<table>
<tr><td><code>values</code></td>
<td>
<p>a vector containing the <code class="reqn">p</code> eigenvalues of <code>x</code>,
sorted in <em>decreasing</em> order, according to <code>Mod(values)</code>
in the asymmetric case when they might be complex (even for real
matrices).  For real asymmetric matrices the vector will be
complex only if complex conjugate pairs of eigenvalues are detected.
</p>
</td></tr>
<tr><td><code>vectors</code></td>
<td>
<p>either a <code class="reqn">p\times p</code> matrix whose columns
contain the eigenvectors of <code>x</code>, or <code>NULL</code> if
<code>only.values</code> is <code>TRUE</code>.  The vectors are normalized to
unit length.
</p>
<p>Recall that the eigenvectors are only defined up to a constant: even
when the length is specified they are still only defined up to a
scalar of modulus one (the sign for real matrices).
</p>
</td></tr>
</table>
<p>When <code>only.values</code> is not true, as by default, the result is of
S3 class <code>"eigen"</code>.
</p>
<p>If <code>r &lt;- eigen(A)</code>, and <code>V &lt;- r$vectors; lam &lt;- r$values</code>,
then </p>
<p style="text-align: center;"><code class="reqn">A = V \Lambda V^{-1}</code>
</p>
<p> (up to numerical
fuzz), where <code class="reqn">\Lambda =</code><code>diag(lam)</code>.
</p>


<h3>Source</h3>

<p><code>eigen</code> uses the LAPACK routines <code>DSYEVR</code>, <code>DGEEV</code>,
<code>ZHEEV</code> and <code>ZGEEV</code>.
</p>
<p>LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and its guide is listed
in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>.  Third Edition.  SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Wilkinson, J. H. (1965) <em>The Algebraic Eigenvalue Problem.</em>
Clarendon Press, Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svd">svd</a></code>, a generalization of <code>eigen</code>; <code><a href="#topic+qr">qr</a></code>, and
<code><a href="#topic+chol">chol</a></code> for related decompositions.
</p>
<p>To compute the determinant of a matrix, the <code><a href="#topic+qr">qr</a></code>
decomposition is much more efficient: <code><a href="#topic+det">det</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eigen(cbind(c(1,-1), c(-1,1)))
eigen(cbind(c(1,-1), c(-1,1)), symmetric = FALSE)
# same (different algorithm).

eigen(cbind(1, c(1,-1)), only.values = TRUE)
eigen(cbind(-1, 2:1)) # complex values
eigen(print(cbind(c(0, 1i), c(-1i, 0)))) # Hermite ==&gt; real Eigenvalues
## 3 x 3:
eigen(cbind( 1, 3:1, 1:3))
eigen(cbind(-1, c(1:2,0), 0:2)) # complex values

</code></pre>

<hr>
<h2 id='encodeString'>
Encode Character Vector as for Printing
</h2><span id='topic+encodeString'></span>

<h3>Description</h3>

<p><code>encodeString</code> escapes the strings in a character vector in the
same way <code>print.default</code> does, and optionally fits the encoded
strings within a field width.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>encodeString(x, width = 0, quote = "", na.encode = TRUE,
             justify = c("left", "right", "centre", "none"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="encodeString_+3A_x">x</code></td>
<td>
<p>a character vector, or an object that can be coerced to one
by <code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="encodeString_+3A_width">width</code></td>
<td>
<p>integer: the minimum field width.  If <code>NULL</code> or
<code>NA</code>, this is taken to be the largest field width needed for
any element of <code>x</code>.</p>
</td></tr>
<tr><td><code id="encodeString_+3A_quote">quote</code></td>
<td>
<p>character: quoting character, if any.</p>
</td></tr>
<tr><td><code id="encodeString_+3A_na.encode">na.encode</code></td>
<td>
<p>logical: should <code>NA</code> strings be encoded?</p>
</td></tr>
<tr><td><code id="encodeString_+3A_justify">justify</code></td>
<td>
<p>character: partial matches are allowed.  If padding to
the minimum field width is needed, how should spaces be inserted?
<code>justify == "none"</code> is equivalent to <code>width = 0</code>, for
consistency with <code>format.default</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This escapes backslash and the control characters &lsquo;<span class="samp">&#8288;\a&#8288;</span>&rsquo; (bell),
&lsquo;<span class="samp">&#8288;\b&#8288;</span>&rsquo; (backspace), &lsquo;<span class="samp">&#8288;\f&#8288;</span>&rsquo; (form feed),
&lsquo;<span class="samp">&#8288;\n&#8288;</span>&rsquo; (line feed, aka &ldquo;newline&rdquo;),
&lsquo;<span class="samp">&#8288;\r&#8288;</span>&rsquo; (carriage return), &lsquo;<span class="samp">&#8288;\t&#8288;</span>&rsquo; (tab) and &lsquo;<span class="samp">&#8288;\v&#8288;</span>&rsquo;
(vertical tab) as well as any non-printable characters in a
single-byte locale, which are printed in octal notation (&lsquo;<span class="samp">&#8288;\xyz&#8288;</span>&rsquo;
with leading zeroes).
</p>
<p>Which characters are non-printable depends on the current locale.
Windows' reporting of printable characters is unreliable, so there all
other control characters are regarded as non-printable, and all
characters with codes 32&ndash;255 as printable in a single-byte locale.
See <code><a href="#topic+print.default">print.default</a></code> for how non-printable characters are
handled in multi-byte locales.
</p>
<p>If <code>quote</code> is a single or double quote any embedded quote of the
same type is escaped.  Note that justification is of the quoted
string, hence spaces are added outside the quotes.
</p>


<h3>Value</h3>

<p>A character vector of the same length as <code>x</code>, with the same
attributes (including names and dimensions) but with no class set.
</p>
<p>Marked UTF-8 encodings are preserved.
</p>


<h3>Note</h3>

<p>The default for <code>width</code> is different from <code>format.default</code>,
which does similar things for character vectors but without encoding
using escapes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.default">print.default</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- "ab\bc\ndef"
print(x)
cat(x) # interprets escapes
cat(encodeString(x), "\n", sep = "") # similar to print()

factor(x) # makes use of this to print the levels

x &lt;- c("a", "ab", "abcde")
encodeString(x) # width = 0: use as little as possible
encodeString(x, 2) # use two or more (left justified)
encodeString(x, width = NA) # left justification
encodeString(x, width = NA, justify = "c")
encodeString(x, width = NA, justify = "r")
encodeString(x, width = NA, quote = "'", justify = "r")
</code></pre>

<hr>
<h2 id='Encoding'>Read or Set the Declared Encodings for a Character Vector</h2><span id='topic+Encoding'></span><span id='topic+Encoding+3C-'></span><span id='topic+enc2native'></span><span id='topic+enc2utf8'></span>

<h3>Description</h3>

<p>Read or set the declared encodings for a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Encoding(x)

Encoding(x) &lt;- value

enc2native(x)
enc2utf8(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Encoding_+3A_x">x</code></td>
<td>
<p>A character vector.</p>
</td></tr>
<tr><td><code id="Encoding_+3A_value">value</code></td>
<td>
<p>A character vector of positive length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Character strings in <span class="rlang"><b>R</b></span> can be declared to be encoded in
<code>"latin1"</code> or <code>"UTF-8"</code> or as <code>"bytes"</code>.  These
declarations can be read by <code>Encoding</code>, which will return a
character vector of values <code>"latin1"</code>, <code>"UTF-8"</code>
<code>"bytes"</code> or <code>"unknown"</code>, or set, when <code>value</code> is
recycled as needed and other values are silently treated as
<code>"unknown"</code>.  ASCII strings will never be marked with a declared
encoding, since their representation is the same in all supported
encodings.  Strings marked as <code>"bytes"</code> are intended to be
non-ASCII strings which should be manipulated as bytes, and never
converted to a character encoding (so writing them to a text file is
supported only by <code>writeLines(useBytes = TRUE)</code>).

</p>
<p><code>enc2native</code> and <code>enc2utf8</code> convert elements of character
vectors to the native encoding or UTF-8 respectively, taking any
marked encoding into account.  They are <a href="#topic+primitive">primitive</a> functions,
designed to do minimal copying.
</p>
<p>There are other ways for character strings to acquire a declared
encoding apart from explicitly setting it (and these have changed as
<span class="rlang"><b>R</b></span> has evolved).  The parser marks strings containing &lsquo;<span class="samp">&#8288;\u&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;\U&#8288;</span>&rsquo; escapes.  Functions <code><a href="#topic+scan">scan</a></code>,
<code><a href="utils.html#topic+read.table">read.table</a></code>, <code><a href="#topic+readLines">readLines</a></code>, and
<code><a href="#topic+parse">parse</a></code> have an <code>encoding</code> argument that is used to
declare encodings, <code><a href="#topic+iconv">iconv</a></code> declares encodings from its
<code>to</code> argument, and console input in suitable locales is also
declared.  <code><a href="#topic+intToUtf8">intToUtf8</a></code> declares its output as
<code>"UTF-8"</code>, and output text connections (see
<code><a href="#topic+textConnection">textConnection</a></code>) are marked if running in a
suitable locale.  Under some circumstances (see its help page)
<code><a href="#topic+source">source</a>(encoding=)</code> will mark encodings of character
strings it outputs.
</p>
<p>Most character manipulation functions will set the encoding on output
strings if it was declared on the corresponding input.  These include
<code><a href="#topic+chartr">chartr</a></code>, <code><a href="#topic+strsplit">strsplit</a>(useBytes = FALSE)</code>,
<code><a href="#topic+tolower">tolower</a></code> and <code><a href="#topic+toupper">toupper</a></code> as well as
<code><a href="#topic+sub">sub</a>(useBytes = FALSE)</code> and <code><a href="#topic+gsub">gsub</a>(useBytes =
  FALSE)</code>.  Note that such functions do not <em>preserve</em> the
encoding, but if they know the input encoding and that the string has
been successfully re-encoded (to the current encoding or UTF-8), they
mark the output.
</p>
<p><code><a href="#topic+substr">substr</a></code> does preserve the encoding, and
<code><a href="#topic+chartr">chartr</a></code>, <code><a href="#topic+tolower">tolower</a></code> and <code><a href="#topic+toupper">toupper</a></code>
preserve UTF-8 encoding on systems with Unicode wide characters.  With
their <code>fixed</code> and <code>perl</code> options, <code><a href="#topic+strsplit">strsplit</a></code>,
<code><a href="#topic+sub">sub</a></code> and <code>gsub</code> will give a marked UTF-8 result if
any of the inputs are UTF-8.
</p>




<p><code><a href="#topic+paste">paste</a></code> and <code><a href="#topic+sprintf">sprintf</a></code> return elements marked
as bytes if any of the corresponding inputs is marked as bytes, and
otherwise marked as UTF-8 if any of the inputs is marked as UTF-8.
</p>
<p><code><a href="#topic+match">match</a></code>, <code><a href="#topic+pmatch">pmatch</a></code>, <code><a href="#topic+charmatch">charmatch</a></code>,
<code><a href="#topic+duplicated">duplicated</a></code> and <code><a href="#topic+unique">unique</a></code> all match in UTF-8
if any of the elements are marked as UTF-8.
</p>
<p>Changing the current encoding from a running R session may lead to
confusion (see <code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code>).
</p>
<p>There is some ambiguity as to what is meant by a &lsquo;Latin-1&rsquo;
locale, since some OSes (notably Windows) make use of character
positions undefined (or used for control characters) in the ISO 8859-1
character set.  How such characters are interpreted is
system-dependent but as from <span class="rlang"><b>R</b></span> 3.5.0 they are if possible interpreted
as per Windows codepage 1252 (which Microsoft calls &lsquo;Windows
Latin 1 (ANSI)&rsquo;) when converting to e.g. UTF-8.
</p>


<h3>Value</h3>

<p>A character vector.
</p>
<p>For <code>enc2utf8</code> encodings are always marked: they are for
<code>enc2native</code> in UTF-8 and Latin-1 locales.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## x is intended to be in latin1
x. &lt;- x &lt;- "fran\xE7ais"
Encoding(x.) # "unknown" (UTF-8 loc.) | "latin1" (8859-1/CP-1252 loc.) | ....
Encoding(x) &lt;- "latin1"
x
xx &lt;- iconv(x, "latin1", "UTF-8")
Encoding(c(x., x, xx))
c(x, xx)
xb &lt;- xx; Encoding(xb) &lt;- "bytes"
xb # will be encoded in hex
cat("x = ", x, ", xx = ", xx, ", xb = ", xb, "\n", sep = "")
(Ex &lt;- Encoding(c(x.,x,xx,xb)))
stopifnot(identical(Ex, c(Encoding(x.), Encoding(x),
                          Encoding(xx), Encoding(xb))))
</code></pre>

<hr>
<h2 id='environment'>Environment Access</h2><span id='topic+environment'></span><span id='topic+environment+3C-'></span><span id='topic+.GlobalEnv'></span><span id='topic+globalenv'></span><span id='topic+emptyenv'></span><span id='topic+baseenv'></span><span id='topic+is.environment'></span><span id='topic+new.env'></span><span id='topic+parent.env'></span><span id='topic+parent.env+3C-'></span><span id='topic+.BaseNamespaceEnv'></span><span id='topic+environmentName'></span><span id='topic+env.profile'></span><span id='topic+enclosure'></span>

<h3>Description</h3>

<p>Get, set, test for and create environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>environment(fun = NULL)
environment(fun) &lt;- value

is.environment(x)

.GlobalEnv
globalenv()
.BaseNamespaceEnv

emptyenv()
baseenv()

new.env(hash = TRUE, parent = parent.frame(), size = 29L)

parent.env(env)
parent.env(env) &lt;- value

environmentName(env)

env.profile(env)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="environment_+3A_fun">fun</code></td>
<td>
<p>a <code><a href="#topic+function">function</a></code>, a <code><a href="stats.html#topic+formula">formula</a></code>, or
<code>NULL</code>, which is the default.</p>
</td></tr>
<tr><td><code id="environment_+3A_value">value</code></td>
<td>
<p>an environment to associate with the function.</p>
</td></tr>
<tr><td><code id="environment_+3A_x">x</code></td>
<td>
<p>an arbitrary <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="environment_+3A_hash">hash</code></td>
<td>
<p>a logical, if <code>TRUE</code> the environment will use a hash table.</p>
</td></tr>
<tr><td><code id="environment_+3A_parent">parent</code></td>
<td>
<p>an environment to be used as the enclosure of the
environment created.</p>
</td></tr>
<tr><td><code id="environment_+3A_env">env</code></td>
<td>
<p>an environment.</p>
</td></tr>
<tr><td><code id="environment_+3A_size">size</code></td>
<td>
<p>an integer specifying the initial size for a hashed
environment.  An internal default value will be used if
<code>size</code> is <code>NA</code> or zero.  This argument is ignored if
<code>hash</code> is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Environments consist of a <em>frame</em>, or collection of named
objects, and a pointer to an <em>enclosing environment</em>.  The most
common example is the frame of variables local to a function call; its
<em>enclosure</em> is the environment where the function was defined
(unless changed subsequently).  The enclosing environment is
distinguished from the <em>parent frame</em>: the latter (returned by
<code><a href="#topic+parent.frame">parent.frame</a></code>) refers to the environment of the caller of
a function.  Since confusion is so easy, it is best never to use
&lsquo;parent&rsquo; in connection with an environment (despite the
presence of the function <code>parent.env</code>).
</p>
<p>When <code><a href="#topic+get">get</a></code> or <code><a href="#topic+exists">exists</a></code> search an environment
with the default <code>inherits = TRUE</code>, they look for the variable
in the frame, then in the enclosing frame, and so on.
</p>
<p>The global environment <code>.GlobalEnv</code>, more often known as the
user's workspace, is the first item on the search path.  It can also
be accessed by <code>globalenv()</code>.  On the search path, each item's
enclosure is the next item.
</p>
<p>The object <code>.BaseNamespaceEnv</code> is the namespace environment for
the base package.  The environment of the base package itself is
available as <code>baseenv()</code>.
</p>
<p>If one follows the chain of enclosures found by repeatedly calling
<code>parent.env</code> from any environment, eventually one reaches the
empty environment <code>emptyenv()</code>, into which nothing may
be assigned.
</p>
<p>The replacement function <code>parent.env&lt;-</code> is extremely dangerous as
it can be used to destructively change environments in ways that
violate assumptions made by the internal C code.  It may be removed
in the near future.
</p>
<p>The replacement form of <code>environment</code>, <code>is.environment</code>,
<code>baseenv</code>, <code>emptyenv</code> and <code>globalenv</code> are
<a href="#topic+primitive">primitive</a> functions.
</p>
<p>System environments, such as the base, global and empty environments,
have names as do the package and namespace environments and those
generated by <code>attach()</code>.  Other environments can be named by
giving a <code>"name"</code> attribute, but this needs to be done with care
as environments have unusual copying semantics.
</p>


<h3>Value</h3>

<p>If <code>fun</code> is a function or a formula then <code>environment(fun)</code>
returns the environment associated with that function or formula.
If <code>fun</code> is <code>NULL</code> then the current evaluation environment is
returned.
</p>
<p>The replacement form sets the environment of the function or formula
<code>fun</code> to the <code>value</code> given.
</p>
<p><code>is.environment(obj)</code> returns <code>TRUE</code> if and only if
<code>obj</code> is an <code>environment</code>.
</p>
<p><code>new.env</code> returns a new (empty) environment with (by default)
enclosure the parent frame.
</p>
<p><code>parent.env</code> returns the enclosing environment of its argument.
</p>
<p><code>parent.env&lt;-</code> sets the enclosing environment of its first
argument.
</p>
<p><code>environmentName</code> returns a character string, that given when
the environment is printed or <code>""</code> if it is not a named environment.
</p>
<p><code>env.profile</code> returns a list with the following components:
<code>size</code> the number of chains that can be stored in the hash table,
<code>nchains</code> the number of non-empty chains in the table (as
reported by <code>HASHPRI</code>), and <code>counts</code> an integer vector
giving the length of each chain (zero for empty chains).  This
function is intended to assess the performance of hashed environments.
When <code>env</code> is a non-hashed environment, <code>NULL</code> is returned.
</p>


<h3>See Also</h3>

<p>For the performance implications of hashing or not, see
<a href="https://en.wikipedia.org/wiki/Hash_table">https://en.wikipedia.org/wiki/Hash_table</a>.
</p>
<p>The <code>envir</code> argument of <code><a href="#topic+eval">eval</a></code>, <code><a href="#topic+get">get</a></code>,
and <code><a href="#topic+exists">exists</a></code>.
</p>
<p><code><a href="#topic+ls">ls</a></code> may be used to view the objects in an environment,
and hence <code><a href="utils.html#topic+ls.str">ls.str</a></code> may be useful for an overview.
</p>
<p><code><a href="#topic+sys.source">sys.source</a></code> can be used to populate an environment.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function() "top level function"

##-- all three give the same:
environment()
environment(f)
.GlobalEnv

ls(envir = environment(stats::approxfun(1:2, 1:2, method = "const")))

is.environment(.GlobalEnv) # TRUE

e1 &lt;- new.env(parent = baseenv())  # this one has enclosure package:base.
e2 &lt;- new.env(parent = e1)
assign("a", 3, envir = e1)
ls(e1)
ls(e2)
exists("a", envir = e2)   # this succeeds by inheritance
exists("a", envir = e2, inherits = FALSE)
exists("+", envir = e2)   # this succeeds by inheritance

eh &lt;- new.env(hash = TRUE, size = NA)
with(env.profile(eh), stopifnot(size == length(counts)))
</code></pre>

<hr>
<h2 id='EnvVar'>Environment Variables</h2><span id='topic+environment+20variables'></span><span id='topic+HOME'></span><span id='topic+LANGUAGE'></span><span id='topic+R_BATCH'></span><span id='topic+R_BROWSER'></span><span id='topic+R_COMPLETION'></span><span id='topic+R_DOC_DIR'></span><span id='topic+R_GSCMD'></span><span id='topic+R_HISTFILE'></span><span id='topic+R_HISTSIZE'></span><span id='topic+R_INCLUDE_DIR'></span><span id='topic+MAKEINDEX'></span><span id='topic+R_PAPERSIZE'></span><span id='topic+R_PCRE_JIT_STACK_MAXSIZE'></span><span id='topic+R_PDFVIEWER'></span><span id='topic+R_PLATFORM'></span><span id='topic+R_RD4PDF'></span><span id='topic+R_SHARE_DIR'></span><span id='topic+R_SUPPORT_OLD_TARS'></span><span id='topic+R_TEXI2DVICMD'></span><span id='topic+R_TIDYCMD'></span><span id='topic+R_UNZIPCMD'></span><span id='topic+R_ZIPCMD'></span><span id='topic+TMPDIR'></span><span id='topic+DISPLAY'></span><span id='topic+EDITOR'></span><span id='topic+PAGER'></span><span id='topic+R_PRINTCMD'></span><span id='topic+GSC'></span><span id='topic+R_USER'></span>

<h3>Description</h3>

<p>Details of some of the environment variables which affect an <span class="rlang"><b>R</b></span> session.
</p>


<h3>Details</h3>

<p>It is impossible to list all the environment variables which can
affect an <span class="rlang"><b>R</b></span> session: some affect the OS system functions which <span class="rlang"><b>R</b></span>
uses, and others will affect add-on packages.  But here are notes on
some of the more important ones.  Those that set the defaults for
options are consulted only at startup (as are some of the others).
</p>

<dl>
<dt><span class="env">HOME</span>:</dt><dd><p>The user's &lsquo;home&rsquo; directory.</p>
</dd>
<dt><span class="env">LANGUAGE</span>:</dt><dd><p>Optional.  The language(s) to be used for
message translations.  This is consulted when needed.</p>
</dd>
<dt><span class="env">LC_ALL</span>:</dt><dd><p>(etc) Optional.  Use to set various aspects of
the locale &ndash; see <code><a href="#topic+Sys.getlocale">Sys.getlocale</a></code>.  Consulted at startup.</p>
</dd>
<dt><span class="env">MAKEINDEX</span>:</dt><dd><p>The path to <code>makeindex</code>.
If unset to a value determined when <span class="rlang"><b>R</b></span> was built.
Used by the emulation mode of <code><a href="tools.html#topic+texi2dvi">texi2dvi</a></code> and
<code><a href="tools.html#topic+texi2pdf">texi2pdf</a></code>.</p>
</dd>
<dt><span class="env">R_BATCH</span>:</dt><dd><p>Optional &ndash; set in a batch session, that is
one started by <code>R CMD <a href="utils.html#topic+BATCH">BATCH</a></code>.  Most often set to
<code>""</code>, so test by something like
<code>!is.na(<a href="#topic+Sys.getenv">Sys.getenv</a>("R_BATCH", NA))</code>.</p>
</dd>
<dt><span class="env">R_BROWSER</span>:</dt><dd><p>The path to the default browser.  Used to
set the default value of <code><a href="#topic+options">options</a>("browser")</code>.</p>
</dd>
<dt><span class="env">R_COMPLETION</span>:</dt><dd><p>Optional.  If set to <code>FALSE</code>,
command-line completion is not used.  (Not used by the macOS GUI.)</p>
</dd>
<dt><span class="env">R_DEFAULT_PACKAGES</span>:</dt><dd><p>A comma-separated list of packages
which are to be attached in every session.  See <code><a href="#topic+options">options</a></code>.</p>
</dd>
<dt><span class="env">R_DOC_DIR</span>:</dt><dd><p>The location of the <span class="rlang"><b>R</b></span> &lsquo;<span class="file">doc</span>&rsquo;
directory.  Set by <span class="rlang"><b>R</b></span>.</p>
</dd>
<dt><span class="env">R_ENVIRON</span>:</dt><dd><p>Optional.  The path to the site environment
file: see <a href="#topic+Startup">Startup</a>.  Consulted at startup.</p>
</dd>
<dt><span class="env">R_GSCMD</span>:</dt><dd><p>Optional.  The path to Ghostscript, used by
<code><a href="grDevices.html#topic+dev2bitmap">dev2bitmap</a></code>, <code><a href="grDevices.html#topic+bitmap">bitmap</a></code> and
<code><a href="grDevices.html#topic+embedFonts">embedFonts</a></code>.  Consulted when those functions are
invoked.  Since it will be treated as if passed to
<code><a href="#topic+system">system</a></code>, spaces and shell metacharacters should be escaped.</p>
</dd>
<dt><span class="env">R_HISTFILE</span>:</dt><dd><p>Optional.  The path of the history file:
see <a href="#topic+Startup">Startup</a>.  Consulted at startup and when the history is
saved.</p>
</dd>
<dt><span class="env">R_HISTSIZE</span>:</dt><dd><p>Optional.  The maximum size of the history
file, in lines.  Exactly how this is used depends on the
interface.
</p>

<dl>
<dt>On Unix-alikes,</dt><dd><p>for the <code>readline</code> command-line interface it takes effect
when the history is saved (by <code><a href="utils.html#topic+savehistory">savehistory</a></code> or at the
end of a session).</p>
</dd>
<dt>On Windows,</dt><dd><p>for <code>Rgui</code> it controls the number of lines saved to the
history file: the size of the history used in the session is
controlled by the console customization: see <code><a href="utils.html#topic+Rconsole">Rconsole</a></code>.</p>
</dd>
</dl>

</dd>
<dt><span class="env">R_HOME</span>:</dt><dd><p>The top-level directory of the <span class="rlang"><b>R</b></span>
installation: see <code><a href="#topic+R.home">R.home</a></code>.  Set by <span class="rlang"><b>R</b></span>.</p>
</dd>
<dt><span class="env">R_INCLUDE_DIR</span>:</dt><dd><p>The location of the <span class="rlang"><b>R</b></span> &lsquo;<span class="file">include</span>&rsquo;
directory.  Set by <span class="rlang"><b>R</b></span>.</p>
</dd>
<dt><span class="env">R_LIBS</span>:</dt><dd><p>Optional.  Used for initial setting of
<code><a href="#topic+.libPaths">.libPaths</a></code>.</p>
</dd>
<dt><span class="env">R_LIBS_SITE</span>:</dt><dd><p>Optional.  Used for initial setting of
<code><a href="#topic+.libPaths">.libPaths</a></code>.</p>
</dd>
<dt><span class="env">R_LIBS_USER</span>:</dt><dd><p>Optional.  Used for initial setting of
<code><a href="#topic+.libPaths">.libPaths</a></code>.</p>
</dd>
<dt><span class="env">R_PAPERSIZE</span>:</dt><dd><p>Optional.  Used to set the default for
<code><a href="#topic+options">options</a>("papersize")</code>, e.g. used by
<code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+postscript">postscript</a></code>.</p>
</dd>
<dt><span class="env">R_PCRE_JIT_STACK_MAXSIZE</span>:</dt><dd><p>Optional.  Consulted when
PCRE's <abbr>JIT</abbr> pattern compiler is first used.  See <code><a href="#topic+grep">grep</a></code>.</p>
</dd>
<dt><span class="env">R_PDFVIEWER</span>:</dt><dd><p>The path to the default PDF viewer.  Used
by <code>R CMD Rd2pdf</code>.</p>
</dd>
<dt><span class="env">R_PLATFORM</span>:</dt><dd><p>The platform &ndash; a string of the form
<code>"<var>cpu</var>-<var>vendor</var>-<var>os</var>"</code>, see <code><a href="#topic+R.Version">R.Version</a></code>.</p>
</dd>
<dt><span class="env">R_PROFILE</span>:</dt><dd><p>Optional.  The path to the site profile
file: see <a href="#topic+Startup">Startup</a>.  Consulted at startup.</p>
</dd>
<dt><span class="env">R_RD4PDF</span>:</dt><dd><p>Options for <code>pdflatex</code> processing of
<code>Rd</code> files.  Used by <code>R CMD Rd2pdf</code>.</p>
</dd>
<dt><span class="env">R_SHARE_DIR</span>:</dt><dd><p>The location of the <span class="rlang"><b>R</b></span> &lsquo;<span class="file">share</span>&rsquo;
directory.  Set by <span class="rlang"><b>R</b></span>.</p>
</dd>
<dt><span class="env">R_TEXI2DVICMD</span>:</dt><dd><p>The path to <code>texi2dvi</code>.
Defaults to the value of <span class="env">TEXI2DVI</span>, and if that is unset to a
value determined when <span class="rlang"><b>R</b></span> was built.
</p>
<p>Only on Unix-alikes:<br />
Consulted at startup to set the default for
<code><a href="#topic+options">options</a>("texi2dvi")</code>, used by
<code><a href="tools.html#topic+texi2dvi">texi2dvi</a></code> and <code><a href="tools.html#topic+texi2pdf">texi2pdf</a></code> in package <span class="pkg">tools</span>.
</p>
</dd>
<dt><span class="env">R_TIDYCMD</span>:</dt><dd><p>The path to HTML <code>tidy</code>. Used by
<code>R CMD check</code> if <span class="env">_R_CHECK_RD_VALIDATE_RD2HTML_</span> is
set to a true value (as it is by <span class="option">--as-cran</span>.</p>
</dd>
<dt><span class="env">R_UNZIPCMD</span>:</dt><dd><p>The path to <code>unzip</code>.  Sets the
initial value for <code><a href="#topic+options">options</a>("unzip")</code> on a Unix-alike
when namespace <span class="pkg">utils</span> is loaded.</p>
</dd>
<dt><span class="env">R_ZIPCMD</span>:</dt><dd><p>The path to <code>zip</code>. Used by
<code><a href="utils.html#topic+zip">zip</a></code> and by <code>R CMD INSTALL --build</code> on Windows.</p>
</dd>
<dt><span class="env">TMPDIR</span>, <span class="env">TMP</span>, <span class="env">TEMP</span>:</dt><dd><p>Consulted (in that
order) when setting the temporary directory for the session: see
<code><a href="#topic+tempdir">tempdir</a></code>.  <span class="env">TMPDIR</span> is also used by some of the
utilities: see the help for <code><a href="utils.html#topic+build">build</a></code>.</p>
</dd>
<dt><span class="env">TZ</span>:</dt><dd><p>Optional.  The current time zone.  See
<code><a href="#topic+Sys.timezone">Sys.timezone</a></code> for the system-specific
formats.  Consulted as needed.</p>
</dd>
<dt><span class="env">TZDIR</span>:</dt><dd><p>Optional.  The top-level directory of the
time-zone database.  See <code><a href="#topic+Sys.timezone">Sys.timezone</a></code>.</p>
</dd>
<dt><span class="env">no_proxy</span>, <span class="env">http_proxy</span>, <span class="env">ftp_proxy</span>:</dt><dd>
<p>(and more).  Optional.  Settings for <code><a href="utils.html#topic+download.file">download.file</a></code>:
see its help for further details.</p>
</dd>
</dl>



<h3>Unix-specific</h3>

<p>Some variables set on Unix-alikes, and not (in general) on Windows.
</p>

<dl>
<dt><span class="env">DISPLAY</span>:</dt><dd><p>Optional: used by <code><a href="grDevices.html#topic+X11">X11</a></code>, Tk (in
package <span class="pkg">tcltk</span>), the data editor and various packages.</p>
</dd>
<dt><span class="env">EDITOR</span>:</dt><dd><p>The path to the default editor: sets the
default for <code><a href="#topic+options">options</a>("editor")</code> when namespace
<span class="pkg">utils</span> is loaded.</p>
</dd>
<dt><span class="env">PAGER</span>:</dt><dd><p>The path to the pager with the default setting of
<code><a href="#topic+options">options</a>("pager")</code>. The default value is chosen at
configuration, usually as the path to <code>less</code>.</p>
</dd>
<dt><span class="env">R_PRINTCMD</span>:</dt><dd><p>Sets the default for
<code><a href="#topic+options">options</a>("printcmd")</code>, which sets the default print
command to be used by <code><a href="grDevices.html#topic+postscript">postscript</a></code>.</p>
</dd>
<dt><span class="env">R_SUPPORT_OLD_TARS</span></dt><dd><p>logical. Sets the default for the
<code>support_old_tars</code> argument of <code><a href="utils.html#topic+untar">untar</a></code>.  Should
be set to <code>TRUE</code> if an old system <code>tar</code> command is
used which does not support either <code>xz</code> compression or
automagically detecting compression type.</p>
</dd>
</dl>



<h3>Windows-specific</h3>

<p>Some Windows-specific variables are
</p>

<dl>
<dt><span class="env">GSC</span>:</dt><dd><p>Optional: the path to Ghostscript, used if
<span class="env">R_GSCMD</span> is not set.</p>
</dd>
<dt><span class="env">R_USER</span>:</dt><dd><p>The user's &lsquo;home&rsquo; directory.  Set by
<span class="rlang"><b>R</b></span>.  (<span class="env">HOME</span> will be set to the same value if not already set.)</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+Sys.getenv">Sys.getenv</a></code> and <code><a href="#topic+Sys.setenv">Sys.setenv</a></code> to read and set
environmental variables in an <span class="rlang"><b>R</b></span> session.
</p>
<p><code><a href="#topic+gctorture">gctorture</a></code> for environment variables controlling garbage
collection.
</p>

<hr>
<h2 id='eval'>Evaluate an (Unevaluated) Expression</h2><span id='topic+eval'></span><span id='topic+evalq'></span><span id='topic+eval.parent'></span><span id='topic+local'></span>

<h3>Description</h3>

<p>Evaluate an <span class="rlang"><b>R</b></span> expression in a specified environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval(expr, envir = parent.frame(),
           enclos = if(is.list(envir) || is.pairlist(envir))
                       parent.frame() else baseenv())
evalq(expr, envir, enclos)
eval.parent(expr, n = 1)
local(expr, envir = new.env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_+3A_expr">expr</code></td>
<td>
<p>an object to be evaluated.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="eval_+3A_envir">envir</code></td>
<td>
<p>the <code><a href="#topic+environment">environment</a></code> in which <code>expr</code> is to
be evaluated.  May also be <code>NULL</code>, a list, a data frame,
a pairlist or an integer as specified to <code><a href="#topic+sys.call">sys.call</a></code>.</p>
</td></tr>
<tr><td><code id="eval_+3A_enclos">enclos</code></td>
<td>
<p>relevant when <code>envir</code> is a (pair)list or a data frame.
Specifies the enclosure, i.e., where <span class="rlang"><b>R</b></span> looks for objects not found
in <code>envir</code>.  This can be <code>NULL</code> (interpreted as the base
package environment, <code><a href="#topic+baseenv">baseenv</a>()</code>) or an environment.</p>
</td></tr>
<tr><td><code id="eval_+3A_n">n</code></td>
<td>
<p>number of parent generations to go back.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>eval</code> evaluates the <code>expr</code> argument in the
environment specified by <code>envir</code> and returns the computed value.
If <code>envir</code> is not specified, then the default is
<code><a href="#topic+parent.frame">parent.frame</a>()</code> (the environment where the call to
<code>eval</code> was made).
</p>
<p>Objects to be evaluated can be of types <code><a href="#topic+call">call</a></code> or
<code><a href="#topic+expression">expression</a></code> or <a href="#topic+name">name</a> (when the name is looked
up in the current scope and its binding is evaluated), a <a href="#topic+promise">promise</a>
or any of the basic types such as vectors, functions and environments
(which are returned unchanged).
</p>
<p>The <code>evalq</code> form is equivalent to <code>eval(quote(expr), ...)</code>.
<code>eval</code> evaluates its first argument in the current scope
before passing it to the evaluator: <code>evalq</code> avoids this.
</p>
<p><code>eval.parent(expr, n)</code> is a shorthand for
<code>eval(expr, parent.frame(n))</code>.
</p>
<p>If <code>envir</code> is a list (such as a data frame) or pairlist, it is
copied into a temporary environment (with enclosure <code>enclos</code>),
and the temporary environment is used for evaluation.  So if
<code>expr</code> changes any of the components named in the (pair)list, the
changes are lost.
</p>
<p>If <code>envir</code> is <code>NULL</code> it is interpreted as an empty list so
no values could be found in <code>envir</code> and look-up goes directly to
<code>enclos</code>.
</p>
<p><code>local</code> evaluates an expression in a local environment.  It is
equivalent to <code>evalq</code> except that its default argument creates a
new, empty environment.  This is useful to create anonymous recursive
functions and as a kind of limited namespace feature since variables
defined in the environment are not visible from the outside.
</p>


<h3>Value</h3>

<p>The result of evaluating the object: for an expression vector this is
the result of evaluating the last element.
</p>


<h3>Note</h3>

<p>Due to the difference in scoping rules, there are some differences
between <span class="rlang"><b>R</b></span> and S in this area.  In particular, the default enclosure
in S is the global environment.
</p>
<p>When evaluating expressions in a data frame that has been passed as an
argument to a function, the relevant enclosure is often the caller's
environment, i.e., one needs
<code>eval(x, data, parent.frame())</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.  (<code>eval</code> only.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expression">expression</a></code>, <code><a href="#topic+quote">quote</a></code>, <code><a href="#topic+sys.frame">sys.frame</a></code>,
<code><a href="#topic+parent.frame">parent.frame</a></code>, <code><a href="#topic+environment">environment</a></code>.
</p>
<p>Further, <code><a href="#topic+force">force</a></code> to <em>force</em> evaluation, typically of
function arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eval(2 ^ 2 ^ 3)
mEx &lt;- expression(2^2^3); mEx; 1 + eval(mEx)
eval({ xx &lt;- pi; xx^2}) ; xx

a &lt;- 3 ; aa &lt;- 4 ; evalq(evalq(a+b+aa, list(a = 1)), list(b = 5)) # == 10
a &lt;- 3 ; aa &lt;- 4 ; evalq(evalq(a+b+aa, -1), list(b = 5))        # == 12

ev &lt;- function() {
   e1 &lt;- parent.frame()
   ## Evaluate a in e1
   aa &lt;- eval(expression(a), e1)
   ## evaluate the expression bound to a in e1
   a &lt;- expression(x+y)
   list(aa = aa, eval = eval(a, e1))
}
tst.ev &lt;- function(a = 7) { x &lt;- pi; y &lt;- 1; ev() }
tst.ev()  #-&gt; aa : 7,  eval : 4.14

a &lt;- list(a = 3, b = 4)
with(a, a &lt;- 5) # alters the copy of a from the list, discarded.

##
## Example of evalq()
##

N &lt;- 3
env &lt;- new.env()
assign("N", 27, envir = env)
## this version changes the visible copy of N only, since the argument
## passed to eval is '4'.
eval(N &lt;- 4, env)
N
get("N", envir = env)
## this version does the assignment in env, and changes N only there.
evalq(N &lt;- 5, env)
N
get("N", envir = env)


##
## Uses of local()
##

# Mutually recursive.
# gg gets value of last assignment, an anonymous version of f.

gg &lt;- local({
    k &lt;- function(y)f(y)
    f &lt;- function(x) if(x) x*k(x-1) else 1
})
gg(10)
sapply(1:5, gg)

# Nesting locals: a is private storage accessible to k
gg &lt;- local({
    k &lt;- local({
        a &lt;- 1
        function(y){print(a &lt;&lt;- a+1);f(y)}
    })
    f &lt;- function(x) if(x) x*k(x-1) else 1
})
sapply(1:5, gg)

ls(envir = environment(gg))
ls(envir = environment(get("k", envir = environment(gg))))
</code></pre>

<hr>
<h2 id='exists'>Is an Object Defined?</h2><span id='topic+exists'></span><span id='topic+get0'></span>

<h3>Description</h3>

<p>Look for an <span class="rlang"><b>R</b></span> object of the given name and possibly return it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exists(x, where = -1, envir = , frame, mode = "any",
       inherits = TRUE)

get0(x, envir = pos.to.env(-1L), mode = "any", inherits = TRUE,
     ifnotfound = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exists_+3A_x">x</code></td>
<td>
<p>a variable name (given as a character string or a symbol).</p>
</td></tr>
<tr><td><code id="exists_+3A_where">where</code></td>
<td>
<p>where to look for the object (see the details section); if
omitted, the function will search as if the name of the object
appeared unquoted in an expression.</p>
</td></tr>
<tr><td><code id="exists_+3A_envir">envir</code></td>
<td>
<p>an alternative way to specify an environment to look in,
but it is usually simpler to just use the <code>where</code> argument.</p>
</td></tr>
<tr><td><code id="exists_+3A_frame">frame</code></td>
<td>
<p>a frame in the calling list.  Equivalent to giving
<code>where</code> as <code>sys.frame(frame)</code>.</p>
</td></tr>
<tr><td><code id="exists_+3A_mode">mode</code></td>
<td>
<p>the mode or type of object sought: see the
&lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="exists_+3A_inherits">inherits</code></td>
<td>
<p>should the enclosing frames of the environment be
searched?</p>
</td></tr>
<tr><td><code id="exists_+3A_ifnotfound">ifnotfound</code></td>
<td>
<p>the return value of <code>get0(x, *)</code> when
<code>x</code> does not exist.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>where</code> argument can specify the environment in which to look
for the object in any of several ways: as an integer (the position in
the <code><a href="#topic+search">search</a></code> list); as the character string name of an
element in the search list; or as an <code><a href="#topic+environment">environment</a></code>
(including using <code><a href="#topic+sys.frame">sys.frame</a></code> to access the currently active
function calls).  The <code>envir</code> argument is an alternative way to
specify an environment, but is primarily there for back compatibility.
</p>
<p>This function looks to see if the name <code>x</code> has a value bound to
it in the specified environment.  If <code>inherits</code> is <code>TRUE</code> and
a value is not found for <code>x</code> in the specified environment, the
enclosing frames of the environment are searched until the name <code>x</code>
is encountered.  See <code><a href="#topic+environment">environment</a></code> and the &lsquo;R
Language Definition&rsquo; manual for details about the structure of
environments and their enclosures.
</p>
<p><b>Warning:</b>
<code>inherits = TRUE</code> is the default behaviour for <span class="rlang"><b>R</b></span> but not for S.
</p>
<p>If <code>mode</code> is specified then only objects of that type are sought.
The <code>mode</code> may specify one of the collections <code>"numeric"</code> and
<code>"function"</code> (see <code><a href="#topic+mode">mode</a></code>): any member of the
collection will suffice.  (This is true even if a member of a
collection is specified, so for example <code>mode = "special"</code> will
seek any type of function.)
</p>


<h3>Value</h3>

<p><code>exists():</code> Logical, true if and only if an object of the correct
name and mode is found.
</p>
<p><code>get0():</code> The object&mdash;as from <code><a href="#topic+get">get</a>(x, *)</code>&mdash;
if <code>exists(x, *)</code> is true, otherwise <code>ifnotfound</code>.
</p>


<h3>Note</h3>

<p>With <code>get0()</code>, instead of the easy to read but somewhat
inefficient
</p>
<pre>
    if (exists(myVarName, envir = myEnvir)) {
      r &lt;- get(myVarName, envir = myEnvir)
      ## ... deal with r ...
    }
  </pre>
<p>you now can use the more efficient (and slightly harder to read)
</p>
<pre>
    if (!is.null(r &lt;- get0(myVarName, envir = myEnvir))) {
      ## ... deal with r ...
    }
  </pre>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get">get</a></code> and <code><a href="utils.html#topic+hasName">hasName</a></code>.  For quite a different 
kind of &ldquo;existence&rdquo;
checking, namely if function arguments were specified,
<code><a href="#topic+missing">missing</a></code>;
and for yet a different kind, namely if a file exists,
<code><a href="#topic+file.exists">file.exists</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##  Define a substitute function if necessary:
if(!exists("some.fun", mode = "function"))
  some.fun &lt;- function(x) { cat("some.fun(x)\n"); x }
search()
exists("ls", 2) # true even though ls is in pos = 3
exists("ls", 2, inherits = FALSE) # false

## These are true (in most circumstances):
identical(ls,   get0("ls"))
identical(NULL, get0(".foo.bar.")) # default ifnotfound = NULL (!)

</code></pre>

<hr>
<h2 id='expand.grid'>Create a Data Frame from All Combinations of Factor Variables</h2><span id='topic+expand.grid'></span>

<h3>Description</h3>

<p>Create a data frame from all combinations of the supplied vectors or
factors.  See the description of the return value for precise details of
the way this is done.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand.grid(..., KEEP.OUT.ATTRS = TRUE, stringsAsFactors = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.grid_+3A_...">...</code></td>
<td>
<p>vectors, factors or a list containing these.</p>
</td></tr>
<tr><td><code id="expand.grid_+3A_keep.out.attrs">KEEP.OUT.ATTRS</code></td>
<td>
<p>a logical indicating the <code>"out.attrs"</code>
attribute (see below) should be computed and returned.</p>
</td></tr>
<tr><td><code id="expand.grid_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical specifying if character vectors are
converted to factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing one row for each combination of the supplied
factors.  The first factors vary fastest.  The columns are labelled by
the factors if these are supplied as named arguments or named
components of a list.  The row names are &lsquo;automatic&rsquo;.
</p>
<p>Attribute <code>"out.attrs"</code> is a list which gives the dimension and
dimnames for use by <code><a href="stats.html#topic+predict">predict</a></code> methods.
</p>


<h3>Note</h3>

<p>Conversion to a factor is done with levels in the order
they occur in the character vectors (and not alphabetically, as is
most common when converting to factors).
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+combn">combn</a></code> (package <code>utils</code>) for the generation
of all combinations of n elements, taken m at a time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(utils)

expand.grid(height = seq(60, 80, 5), weight = seq(100, 300, 50),
            sex = c("Male","Female"))

x &lt;- seq(0, 10, length.out = 100)
y &lt;- seq(-1, 1, length.out = 20)
d1 &lt;- expand.grid(x = x, y = y)
d2 &lt;- expand.grid(x = x, y = y, KEEP.OUT.ATTRS = FALSE)
object.size(d1) - object.size(d2)
##-&gt; 5992 or 8832 (on 32- / 64-bit platform)

</code></pre>

<hr>
<h2 id='expression'>Unevaluated Expressions</h2><span id='topic+expression'></span><span id='topic+is.expression'></span><span id='topic+as.expression'></span><span id='topic+as.expression.default'></span>

<h3>Description</h3>

<p>Creates or tests for objects of mode and class <code>"expression"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expression(...)

is.expression(x)
as.expression(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expression_+3A_...">...</code></td>
<td>
<p><code>expression</code>: <span class="rlang"><b>R</b></span> objects, typically calls, symbols
or constants.<br />
<code>as.expression</code>: arguments to be passed to methods.</p>
</td></tr>
<tr><td><code id="expression_+3A_x">x</code></td>
<td>
<p>an arbitrary <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;Expression&rsquo; here is not being used in its colloquial sense,
that of mathematical expressions.  Those are calls (see
<code><a href="#topic+call">call</a></code>) in <span class="rlang"><b>R</b></span>, and an <span class="rlang"><b>R</b></span> expression vector is a list of
calls, symbols etc, for example as returned by <code><a href="#topic+parse">parse</a></code>.
</p>
<p>As an object of mode <code>"expression"</code> is a list, it can be
subsetted by <code>[</code>, <code>[[</code> or <code>$</code>, the latter two extracting
individual calls etc.  The replacement forms of these operators can be
used to replace or delete elements.
</p>
<p><code>expression</code> and <code>is.expression</code> are <a href="#topic+primitive">primitive</a> functions.
<code>expression</code> is &lsquo;special&rsquo;: it does not evaluate its arguments.
</p>


<h3>Value</h3>

<p><code>expression</code> returns a vector of type <code>"expression"</code>
containing its arguments (unevaluated).
</p>
<p><code>is.expression</code> returns <code>TRUE</code> if <code>expr</code> is an
expression object and <code>FALSE</code> otherwise.
</p>
<p><code>as.expression</code> attempts to coerce its argument into an
expression object.  It is generic, and only the default method is
described here.  (The default method calls
<code>as.vector(type = "expression")</code> and so may dispatch methods for
<code><a href="#topic+as.vector">as.vector</a></code>.)  <code>NULL</code>, calls, symbols (see
<code><a href="#topic+as.symbol">as.symbol</a></code>) and pairlists are returned as the element of
a length-one expression vector.  Atomic vectors are placed
element-by-element into an expression vector (without using any
names): <code><a href="#topic+list">list</a></code>s have their type (<code><a href="#topic+typeof">typeof</a></code>)
changed to an expression vector
(keeping all attributes).
Other types are not currently supported.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+call">call</a></code>,
<code><a href="#topic+eval">eval</a></code>,
<code><a href="#topic+function">function</a></code>.
Further,
<code><a href="graphics.html#topic+text">text</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, and <code><a href="grDevices.html#topic+plotmath">plotmath</a></code>
for plotting mathematical expressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>length(ex1 &lt;- expression(1 + 0:9)) # 1
ex1
eval(ex1) # 1:10

length(ex3 &lt;- expression(u, 2, u + 0:9)) # 3
mode(ex3 [3])   # expression
mode(ex3[[3]])  # call
## but not all components are 'call's :
sapply(ex3, mode  ) #  name  numeric  call
sapply(ex3, typeof) # symbol  double  language
rm(ex3)
</code></pre>

<hr>
<h2 id='Extract'>Extract or Replace Parts of an Object</h2><span id='topic+Extract'></span><span id='topic+Subscript'></span><span id='topic++5B'></span><span id='topic++5B.listof'></span><span id='topic++5B.simple.list'></span><span id='topic++5B.Dlist'></span><span id='topic++5B+5B'></span><span id='topic++24'></span><span id='topic+getElement'></span><span id='topic++5B+3C-'></span><span id='topic++5B+5B+3C-'></span><span id='topic++24+3C-'></span>

<h3>Description</h3>

<p>Operators acting on vectors, matrices, arrays and lists to extract or
replace parts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x[i]
x[i, j, ... , drop = TRUE]
x[[i, exact = TRUE]]
x[[i, j, ..., exact = TRUE]]
x$name
getElement(object, name)

x[i] &lt;- value
x[i, j, ...] &lt;- value
x[[i]] &lt;- value
x$name &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract_+3A_x">x</code>, <code id="Extract_+3A_object">object</code></td>
<td>

<p>object from which to extract element(s) or in which to replace element(s).
</p>
</td></tr>
<tr><td><code id="Extract_+3A_i">i</code>, <code id="Extract_+3A_j">j</code>, <code id="Extract_+3A_...">...</code></td>
<td>

<p>indices specifying elements to extract or replace.  Indices are
<code>numeric</code> or <code>character</code> vectors or empty (missing) or
<code>NULL</code>.  Numeric values are coerced to integer or whole numbers as
by <code><a href="#topic+as.integer">as.integer</a></code> or for large values by <code><a href="#topic+trunc">trunc</a></code>
(and hence truncated towards zero).
Character vectors will be matched to the <code><a href="#topic+names">names</a></code> of the
object (or for matrices/arrays, the <code><a href="#topic+dimnames">dimnames</a></code>):
see &lsquo;Character indices&rsquo; below for further details.
</p>
<p>For <code>[</code>-indexing only: <code>i</code>, <code>j</code>, <code>...</code> can be
logical vectors, indicating elements/slices to select.  Such vectors
are recycled if necessary to match the corresponding extent.
<code>i</code>, <code>j</code>, <code>...</code> can also be negative integers,
indicating elements/slices to leave out of the selection.
</p>
<p>When indexing arrays by <code>[</code> a single argument <code>i</code> can be a
matrix with as many columns as there are dimensions of <code>x</code>; the
result is then a vector with elements corresponding to the sets of
indices in each row of <code>i</code>.
</p>
<p>An index value of <code>NULL</code> is treated as if it were <code>integer(0)</code>.
</p>
</td></tr>
<tr><td><code id="Extract_+3A_name">name</code></td>
<td>

<p>a literal character string or a <a href="#topic+name">name</a> (possibly <a href="#topic+backtick">backtick</a>
quoted).  For extraction, this is normally (see under
&lsquo;Environments&rsquo;) partially matched to the <code><a href="#topic+names">names</a></code>
of the object.
</p>
</td></tr>
<tr><td><code id="Extract_+3A_drop">drop</code></td>
<td>
<p>relevant for matrices and arrays.  If <code>TRUE</code> the result is
coerced to the lowest possible dimension (see the examples).  This
only works for extracting elements, not for the replacement.  See
<code><a href="#topic+drop">drop</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="Extract_+3A_exact">exact</code></td>
<td>
<p>controls possible partial matching of <code>[[</code> when
extracting by a character vector (for most objects, but see under
&lsquo;Environments&rsquo;).  The default is no partial matching.  Value
<code>NA</code> allows partial matching but issues a warning when it
occurs.  Value <code>FALSE</code> allows partial matching without any
warning.</p>
</td></tr>
<tr><td><code id="Extract_+3A_value">value</code></td>
<td>
<p>typically an array-like <span class="rlang"><b>R</b></span> object of a similar class as
<code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These operators are generic.  You can write methods to handle indexing
of specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a> as well as
<code><a href="#topic++5B.data.frame">[.data.frame</a></code> and <code><a href="#topic++5B.factor">[.factor</a></code>.  The
descriptions here apply only to the default methods.  Note that
separate methods are required for the replacement functions
<code>[&lt;-</code>, <code>[[&lt;-</code> and <code>$&lt;-</code> for use when indexing occurs on
the assignment side of an expression.
</p>
<p>The most important distinction between <code>[</code>, <code>[[</code> and
<code>$</code> is that the <code>[</code> can select more than one element whereas
the other two select a single element.
</p>
<p>Note that <code>x[[]]</code> is always erroneous.

</p>
<p>The default methods work somewhat differently for atomic vectors,
matrices/arrays and for recursive (list-like, see
<code><a href="#topic+is.recursive">is.recursive</a></code>) objects.  <code>$</code> is only valid for
recursive objects (and <code><a href="#topic+NULL">NULL</a></code>), and is only discussed in the section below on
recursive objects.
</p>
<p>Subsetting (except by an empty index) will drop all attributes except
<code>names</code>, <code>dim</code> and <code>dimnames</code>.
</p>
<p>Indexing can occur on the right-hand-side of an expression for
extraction, or on the left-hand-side for replacement.  When an index
expression appears on the left side of an assignment (known as
<em>subassignment</em>) then that part of <code>x</code> is set to the value
of the right hand side of the assignment.  In this case no partial
matching of character indices is done, and the left-hand-side is
coerced as needed to accept the values.  For vectors, the answer will
be of the higher of the types of <code>x</code> and <code>value</code> in the
hierarchy raw &lt; logical &lt; integer &lt; double &lt; complex &lt; character &lt;
list &lt; expression.  Attributes are preserved (although <code>names</code>,
<code>dim</code> and <code>dimnames</code> will be adjusted suitably).
Subassignment is done sequentially, so if an index is specified more
than once the latest assigned value for an index will result.
</p>
<p>It is an error to apply any of these operators to an object which is
not subsettable (e.g., a function).
</p>


<h3>Atomic vectors</h3>

<p>The usual form of indexing is <code>[</code>.  <code>[[</code> can be used to
select a single element <em>dropping</em> <code><a href="#topic+names">names</a></code>, whereas
<code>[</code> keeps them, e.g., in <code>c(abc = 123)[1]</code>.
</p>
<p>The index object <code>i</code> can be numeric, logical, character or empty.
Indexing by factors is allowed and is equivalent to indexing by the
numeric codes (see <code><a href="#topic+factor">factor</a></code>) and not by the character
values which are printed (for which use <code>[as.character(i)]</code>).
</p>
<p>An empty index selects all values: this is most often used to replace
all the entries but keep the <code><a href="#topic+attributes">attributes</a></code>.
</p>


<h3>Matrices and arrays</h3>

<p>Matrices and arrays are vectors with a dimension attribute and so all
the vector forms of indexing can be used with a single index.  The
result will be an unnamed vector unless <code>x</code> is one-dimensional
when it will be a one-dimensional array.
</p>
<p>The most common form of indexing a <code class="reqn">k</code>-dimensional array is to
specify <code class="reqn">k</code> indices to <code>[</code>.  As for vector indexing, the
indices can be numeric, logical, character, empty or even factor.
And again, indexing by factors is equivalent to indexing by the
numeric codes, see &lsquo;Atomic vectors&rsquo; above.
</p>
<p>An empty index (a comma separated blank) indicates that all entries in
that dimension are selected.
The argument <code>drop</code> applies to this form of indexing.
</p>
<p>A third form of indexing is via a numeric matrix with the one column
for each dimension: each row of the index matrix then selects a single
element of the array, and the result is a vector.  Negative indices are
not allowed in the index matrix.  <code>NA</code> and zero values are allowed:
rows of an index matrix containing a zero are ignored, whereas rows
containing an <code>NA</code> produce an <code>NA</code> in the result.
</p>
<p>Indexing via a character matrix with one column per dimensions is also
supported if the array has dimension names.  As with numeric matrix
indexing, each row of the index matrix selects a single element of the
array.  Indices are matched against the appropriate dimension names.
<code>NA</code> is allowed and will produce an <code>NA</code> in the result.
Unmatched indices as well as the empty string (<code>""</code>) are not
allowed and will result in an error.
</p>
<p>A vector obtained by matrix indexing will be unnamed unless <code>x</code>
is one-dimensional when the row names (if any) will be indexed to
provide names for the result.
</p>


<h3>Recursive (list-like) objects</h3>

<p>Indexing by <code>[</code> is similar to atomic vectors and selects a list
of the specified element(s).
</p>
<p>Both <code>[[</code> and <code>$</code> select a single element of the list.  The
main difference is that <code>$</code> does not allow computed indices,
whereas <code>[[</code> does.  <code>x$name</code> is equivalent to
<code>x[["name", exact = FALSE]]</code>.  Also, the partial matching
behavior of <code>[[</code> can be controlled using the <code>exact</code> argument.
</p>
<p><code>getElement(x, name)</code> is a version of <code>x[[name, exact = TRUE]]</code>
which for formally classed (S4) objects returns <code><a href="methods.html#topic+slot">slot</a>(x, name)</code>,
hence providing access to even more general list-like objects.
</p>
<p><code>[</code> and <code>[[</code> are sometimes applied to other recursive
objects such as <a href="#topic+call">call</a>s and <a href="#topic+expression">expression</a>s.  Pairlists (such
as calls) are coerced to lists for extraction by <code>[</code>, but all
three operators can be used for replacement.
</p>
<p><code>[[</code> can be applied recursively to lists, so that if the single
index <code>i</code> is a vector of length <code>p</code>, <code>alist[[i]]</code> is
equivalent to <code>alist[[i1]]...[[ip]]</code> providing all but the
final indexing results in a list.
</p>
<p>Note that in all three kinds of replacement, a value of <code>NULL</code>
deletes the corresponding item of the list.  To set entries to
<code>NULL</code>, you need <code>x[i] &lt;- list(NULL)</code>.
</p>
<p>When <code>$&lt;-</code> is applied to a <code>NULL</code> <code>x</code>, it first coerces
<code>x</code> to <code>list()</code>.  This is what also happens with <code>[[&lt;-</code>
where in <span class="rlang"><b>R</b></span> versions less than 4.y.z, a length one value resulted in a
length one (atomic) <em>vector</em>.
</p>


<h3>Environments</h3>

<p>Both <code>$</code> and <code>[[</code> can be applied to environments.  Only
character indices are allowed and no partial matching is done.  The
semantics of these operations are those of <code>get(i, env = x,
    inherits = FALSE)</code>.  If no match is found then <code>NULL</code> is
returned.  The replacement versions, <code>$&lt;-</code> and <code>[[&lt;-</code>, can
also be used.  Again, only character arguments are allowed.  The
semantics in this case are those of <code>assign(i, value, env = x,
    inherits = FALSE)</code>.  Such an assignment will either create a new
binding or change the existing binding in <code>x</code>.
</p>


<h3>NAs in indexing</h3>

<p>When extracting, a numerical, logical or character <code>NA</code> index picks
an unknown element and so returns <code>NA</code> in the corresponding
element of a logical, integer, numeric, complex or character result,
and <code>NULL</code> for a list.  (It returns <code>00</code> for a raw result.)
</p>
<p>When replacing (that is using indexing on the lhs of an
assignment) <code>NA</code> does not select any element to be replaced.  As
there is ambiguity as to whether an element of the rhs should
be used or not, this is only allowed if the rhs value is of length one
(so the two interpretations would have the same outcome).
(The documented behaviour of S was that an <code>NA</code> replacement index
&lsquo;goes nowhere&rsquo; but uses up an element of <code>value</code>:
Becker <abbr>et al.</abbr> p. 359.  However, that has not been true of
other implementations.)
</p>


<h3>Argument matching</h3>

<p>Note that these operations do not match their index arguments in the
standard way: argument names are ignored and positional matching only is
used.  So <code>m[j = 2, i = 1]</code> is equivalent to <code>m[2, 1]</code> and
<strong>not</strong> to <code>m[1, 2]</code>.
</p>
<p>This may not be true for methods defined for them; for example it is
not true for the <code>data.frame</code> methods described in
<code><a href="#topic++5B.data.frame">[.data.frame</a></code> which warn if <code>i</code> or <code>j</code>
is named and have undocumented behaviour in that case.
</p>
<p>To avoid confusion, do not name index arguments (but <code>drop</code> and
<code>exact</code> must be named).
</p>


<h3>S4 methods</h3>

<p>These operators are also implicit S4 generics, but as primitives, S4
methods will be dispatched only on S4 objects <code>x</code>.
</p>
<p>The implicit generics for the <code>$</code> and <code>$&lt;-</code> operators do not
have <code>name</code> in their signature because the grammar only allows
symbols or string constants for the <code>name</code> argument.
</p>


<h3>Character indices</h3>

<p>Character indices can in some circumstances be partially matched (see
<code><a href="#topic+pmatch">pmatch</a></code>) to the names or dimnames of the object being
subsetted (but never for subassignment).
Unlike S (Becker <abbr>et al.</abbr> p. 358), <span class="rlang"><b>R</b></span> never uses partial
matching when extracting by 
<code>[</code>, and partial matching is not by default used by <code>[[</code>
(see argument <code>exact</code>).
</p>
<p>Thus the default behaviour is to use partial matching only when
extracting from recursive objects (except environments) by <code>$</code>.
Even in that case, warnings can be switched on by
<code><a href="#topic+options">options</a>(warnPartialMatchDollar = TRUE)</code>.
</p>
<p>Neither empty (<code>""</code>) nor <code>NA</code> indices match any names, not
even empty nor missing names.  If any object has no names or
appropriate dimnames, they are taken as all <code>""</code> and so match
nothing.
</p>


<h3>Error conditions</h3>

<p>Attempting to apply a subsetting operation to objects for which this is
not possible signals an error of class
<code>notSubsettableError</code>. The <code>object</code> component of the error
condition contains the non-subsettable object.
</p>
<p>Subscript out of bounds errors are signaled as errors of class
<code>subscriptOutOfBoundsError</code>. The <code>object</code> component of the
error condition contains the object being subsetted. The integer
<code>subscript</code> component is zero for vector subscripting, and for
multiple subscripts indicates which subscript was out of bounds. The
<code>index</code> component contains the erroneous index.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+names">names</a></code> for details of matching to names, and
<code><a href="#topic+pmatch">pmatch</a></code> for partial matching.
</p>
<p><code><a href="#topic+list">list</a></code>, <code><a href="#topic+array">array</a></code>, <code><a href="#topic+matrix">matrix</a></code>.
</p>
<p><code><a href="#topic++5B.data.frame">[.data.frame</a></code> and <code><a href="#topic++5B.factor">[.factor</a></code> for the
behaviour when applied to data.frame and factors.
</p>
<p><code><a href="#topic+Syntax">Syntax</a></code> for operator precedence, and the
&lsquo;R Language Definition&rsquo; manual about indexing details.
</p>
<p><code><a href="#topic+NULL">NULL</a></code> for details of indexing null objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:12
m &lt;- matrix(1:6, nrow = 2, dimnames = list(c("a", "b"), LETTERS[1:3]))
li &lt;- list(pi = pi, e = exp(1))
x[10]                 # the tenth element of x
x &lt;- x[-1]            # delete the 1st element of x
m[1,]                 # the first row of matrix m
m[1, , drop = FALSE]  # is a 1-row matrix
m[,c(TRUE,FALSE,TRUE)]# logical indexing
m[cbind(c(1,2,1),3:1)]# matrix numeric index
ci &lt;- cbind(c("a", "b", "a"), c("A", "C", "B"))
m[ci]                 # matrix character index
m &lt;- m[,-1]           # delete the first column of m
li[[1]]               # the first element of list li
y &lt;- list(1, 2, a = 4, 5)
y[c(3, 4)]            # a list containing elements 3 and 4 of y
y$a                   # the element of y named a

## non-integer indices are truncated:
(i &lt;- 3.999999999) # "4" is printed
(1:5)[i]  # 3

## named atomic vectors, compare "[" and "[[" :
nx &lt;- c(Abc = 123, pi = pi)
nx[1] ; nx["pi"] # keeps names, whereas "[[" does not:
nx[[1]] ; nx[["pi"]]

## recursive indexing into lists
z &lt;- list(a = list(b = 9, c = "hello"), d = 1:5)
unlist(z)
z[[c(1, 2)]]
z[[c(1, 2, 1)]]  # both "hello"
z[[c("a", "b")]] &lt;- "new"
unlist(z)

## check $ and [[ for environments
e1 &lt;- new.env()
e1$a &lt;- 10
e1[["a"]]
e1[["b"]] &lt;- 20
e1$b
ls(e1)

## partial matching - possibly with warning :
stopifnot(identical(li$p, pi))
op &lt;- options(warnPartialMatchDollar = TRUE)
stopifnot( identical(li$p, pi), #-- a warning
  inherits(tryCatch (li$p, warning = identity), "warning"))
## revert the warning option:
options(op)
</code></pre>

<hr>
<h2 id='Extract.data.frame'>Extract or Replace Parts of a Data Frame</h2><span id='topic++5B.data.frame'></span><span id='topic++5B+5B.data.frame'></span><span id='topic++5B+3C-.data.frame'></span><span id='topic++5B+5B+3C-.data.frame'></span><span id='topic++24+3C-.data.frame'></span>

<h3>Description</h3>

<p>Extract or replace subsets of data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
x[i, j, drop = ]
## S3 replacement method for class 'data.frame'
x[i, j] &lt;- value
## S3 method for class 'data.frame'
x[[..., exact = TRUE]]
## S3 replacement method for class 'data.frame'
x[[i, j]] &lt;- value
## S3 replacement method for class 'data.frame'
x$name &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract.data.frame_+3A_x">x</code></td>
<td>
<p>data frame.</p>
</td></tr>
<tr><td><code id="Extract.data.frame_+3A_i">i</code>, <code id="Extract.data.frame_+3A_j">j</code>, <code id="Extract.data.frame_+3A_...">...</code></td>
<td>
<p>elements to extract or replace.  For <code>[</code> and
<code>[[</code>, these are <code>numeric</code> or <code>character</code> or, for
<code>[</code> only, empty or <code>logical</code>.  Numeric values are coerced to integer as if
by <code><a href="#topic+as.integer">as.integer</a></code>.  For replacement by <code>[</code>, a logical
matrix is allowed.</p>
</td></tr>
<tr><td><code id="Extract.data.frame_+3A_name">name</code></td>
<td>

<p>a literal character string or a <a href="#topic+name">name</a> (possibly <a href="#topic+backtick">backtick</a>
quoted).</p>
</td></tr>
<tr><td><code id="Extract.data.frame_+3A_drop">drop</code></td>
<td>
<p>logical.  If <code>TRUE</code> the result is coerced to the
lowest possible dimension.  The default is to drop if only one
column is left, but <b>not</b> to drop if only one row is left.</p>
</td></tr>
<tr><td><code id="Extract.data.frame_+3A_value">value</code></td>
<td>
<p>a suitable replacement value: it will be repeated a whole
number of times if necessary and it may be coerced: see the
Coercion section.  If <code>NULL</code>, deletes the column if a single
column is selected.</p>
</td></tr>
<tr><td><code id="Extract.data.frame_+3A_exact">exact</code></td>
<td>
<p>logical: see <code><a href="#topic++5B">[</a></code>, and applies to column names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data frames can be indexed in several modes.  When <code>[</code> and
<code>[[</code> are used with a single vector index (<code>x[i]</code> or
<code>x[[i]]</code>), they index the data frame as if it were a list.  In
this usage a <code>drop</code> argument is ignored, with a warning.
</p>
<p>There is no <code>data.frame</code> method for <code>$</code>, so <code>x$name</code>
uses the default method which treats <code>x</code> as a list (with partial
matching of column names if the match is unique, see
<code><a href="#topic+Extract">Extract</a></code>).  The replacement method (for <code>$</code>) checks
<code>value</code> for the correct number of rows, and replicates it if necessary.
</p>
<p>When <code>[</code> and <code>[[</code> are used with two indices (<code>x[i, j]</code>
and <code>x[[i, j]]</code>) they act like indexing a matrix:  <code>[[</code> can
only be used to select one element.  Note that for each selected
column, <code>xj</code> say, typically (if it is not matrix-like), the
resulting column will be <code>xj[i]</code>, and hence rely on the
corresponding <code>[</code> method, see the examples section.
</p>
<p>If <code>[</code> returns a data frame it will have unique (and non-missing)
row names, if necessary transforming the row names using
<code><a href="#topic+make.unique">make.unique</a></code>.  Similarly, if columns are selected column
names will be transformed to be unique if necessary (e.g., if columns
are selected more than once, or if more than one column of a given
name is selected if the data frame has duplicate column names).
</p>
<p>When <code>drop = TRUE</code>, this is applied to the subsetting of any
matrices contained in the data frame as well as to the data frame itself.
</p>
<p>The replacement methods can be used to add whole column(s) by specifying
non-existent column(s), in which case the column(s) are added at the
right-hand edge of the data frame and numerical indices must be
contiguous to existing indices.  On the other hand, rows can be added
at any row after the current last row, and the columns will be
in-filled with missing values.  Missing values in the indices are not
allowed for replacement.
</p>
<p>For <code>[</code> the replacement value can be a list: each element of the
list is used to replace (part of) one column, recycling the list as
necessary.  If columns specified by number are created, the names
(if any) of the corresponding list elements are used to name the
columns.  If the replacement is not selecting rows, list values can
contain <code>NULL</code> elements which will cause the corresponding
columns to be deleted.  (See the Examples.)
</p>
<p>Matrix indexing (<code>x[i]</code> with a logical or a 2-column integer
matrix <code>i</code>) using <code>[</code> is not recommended.  For extraction,
<code>x</code> is first coerced to a matrix. For replacement, logical
matrix indices must be of the same dimension as <code>x</code>.
Replacements are done one column at a time, with multiple type
coercions possibly taking place.
</p>
<p>Both <code>[</code> and <code>[[</code> extraction methods partially match row
names.  By default neither partially match column names, but <code>[[</code>
will if <code>exact = FALSE</code> (and with a warning if <code>exact =
  NA</code>).  If you want to exact matching on row names use
<code><a href="#topic+match">match</a></code>, as in the examples.
</p>


<h3>Value</h3>

<p>For <code>[</code> a data frame, list or a single column (the latter two
only when dimensions have been dropped).  If matrix indexing is used for
extraction a vector results.  If the result would be a data frame an
error results if undefined columns are selected (as there is no general
concept of a 'missing' column in a data frame).  Otherwise if a single
column is selected and this is undefined the result is <code>NULL</code>.
</p>
<p>For <code>[[</code> a column of the data frame or <code>NULL</code>
(extraction with one index)
or a length-one vector (extraction with two indices).
</p>
<p>For <code>$</code>, a column of the data frame (or <code>NULL</code>).
</p>
<p>For <code>[&lt;-</code>, <code>[[&lt;-</code> and <code>$&lt;-</code>, a data frame.
</p>


<h3>Coercion</h3>

<p>The story over when replacement values are coerced is a complicated
one, and one that has changed during <span class="rlang"><b>R</b></span>'s development.  This section
is a guide only.
</p>
<p>When <code>[</code> and <code>[[</code> are used to add or replace a whole column,
no coercion takes place but <code>value</code> will be
replicated (by calling the generic function <code><a href="#topic+rep">rep</a></code>) to the
right length if an exact number of repeats can be used.
</p>
<p>When <code>[</code> is used with a logical matrix, each value is coerced to
the type of the column into which it is to be placed.
</p>
<p>When  <code>[</code> and <code>[[</code> are used with two indices, the
column will be coerced as necessary to accommodate the value.
</p>
<p>Note that when the replacement value is an array (including a matrix)
it is <em>not</em> treated as a series of columns (as
<code><a href="#topic+data.frame">data.frame</a></code> and <code><a href="#topic+as.data.frame">as.data.frame</a></code> do) but
inserted as a single column.
</p>


<h3>Warning</h3>

<p>The default behaviour when only one <em>row</em> is left is equivalent to
specifying <code>drop = FALSE</code>.  To drop from a data frame to a list,
<code>drop = TRUE</code> has to be specified explicitly.
</p>
<p>Arguments other than <code>drop</code> and <code>exact</code> should not be named:
there is a warning if they are and the behaviour differs from the
description here.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+subset">subset</a></code> which is often easier for extraction,
<code><a href="#topic+data.frame">data.frame</a></code>, <code><a href="#topic+Extract">Extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sw &lt;- swiss[1:5, 1:4]  # select a manageable subset

sw[1:3]      # select columns
sw[, 1:3]    # same
sw[4:5, 1:3] # select rows and columns
sw[1]        # a one-column data frame
sw[, 1, drop = FALSE]  # the same
sw[, 1]      # a (unnamed) vector
sw[[1]]      # the same
sw$Fert      # the same (possibly w/ warning, see ?Extract)

sw[1,]       # a one-row data frame
sw[1,, drop = TRUE]  # a list

sw["C", ] # partially matches
sw[match("C", row.names(sw)), ] # no exact match
try(sw[, "Ferti"]) # column names must match exactly


sw[sw$Fertility &gt; 90,] # logical indexing, see also ?subset
sw[c(1, 1:2), ]        # duplicate row, unique row names are created

sw[sw &lt;= 6] &lt;- 6  # logical matrix indexing
sw

## adding a column
sw["new1"] &lt;- LETTERS[1:5]   # adds a character column
sw[["new2"]] &lt;- letters[1:5] # ditto
sw[, "new3"] &lt;- LETTERS[1:5] # ditto
sw$new4 &lt;- 1:5
sapply(sw, class)
sw$new  # -&gt; NULL: no unique partial match
sw$new4 &lt;- NULL              # delete the column
sw
sw[6:8] &lt;- list(letters[10:14], NULL, aa = 1:5)
# update col. 6, delete 7, append
sw

## matrices in a data frame
A &lt;- data.frame(x = 1:3, y = I(matrix(4:9, 3, 2)),
                         z = I(matrix(letters[1:9], 3, 3)))
A[1:3, "y"] # a matrix
A[1:3, "z"] # a matrix
A[, "y"]    # a matrix
stopifnot(identical(colnames(A), c("x", "y", "z")), ncol(A) == 3L,
          identical(A[,"y"], A[1:3, "y"]),
          inherits (A[,"y"], "AsIs"))

## keeping special attributes: use a class with a
## "as.data.frame" and "[" method;
## "avector" := vector that keeps attributes.   Could provide a constructor
##  avector &lt;- function(x) { class(x) &lt;- c("avector", class(x)); x }
as.data.frame.avector &lt;- as.data.frame.vector

`[.avector` &lt;- function(x,i,...) {
  r &lt;- NextMethod("[")
  mostattributes(r) &lt;- attributes(x)
  r
}

d &lt;- data.frame(i = 0:7, f = gl(2,4),
                u = structure(11:18, unit = "kg", class = "avector"))
str(d[2:4, -1]) # 'u' keeps its "unit"

</code></pre>

<hr>
<h2 id='Extract.factor'>Extract or Replace Parts of a Factor</h2><span id='topic++5B.factor'></span><span id='topic++5B+3C-.factor'></span><span id='topic++5B+5B.factor'></span><span id='topic++5B+5B+3C-.factor'></span>

<h3>Description</h3>

<p>Extract or replace subsets of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'factor'
x[..., drop = FALSE]
## S3 method for class 'factor'
x[[...]]
## S3 replacement method for class 'factor'
x[...] &lt;- value
## S3 replacement method for class 'factor'
x[[...]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract.factor_+3A_x">x</code></td>
<td>
<p>a factor.</p>
</td></tr>
<tr><td><code id="Extract.factor_+3A_...">...</code></td>
<td>
<p>a specification of indices &ndash; see <code><a href="#topic+Extract">Extract</a></code>.</p>
</td></tr>
<tr><td><code id="Extract.factor_+3A_drop">drop</code></td>
<td>
<p>logical.  If true, unused levels are dropped.</p>
</td></tr>
<tr><td><code id="Extract.factor_+3A_value">value</code></td>
<td>
<p>character: a set of levels.  Factor values are coerced to
character.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When unused levels are dropped the ordering of the remaining levels is
preserved.
</p>
<p>If <code>value</code> is not in <code>levels(x)</code>, a missing value is
assigned with a warning.
</p>
<p>Any <code><a href="stats.html#topic+contrasts">contrasts</a></code> assigned to the factor are preserved
unless <code>drop = TRUE</code>.
</p>
<p>The <code>[[</code> method supports argument <code>exact</code>.
</p>


<h3>Value</h3>

<p>A factor with the same set of levels as <code>x</code> unless <code>drop = TRUE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+factor">factor</a></code>, <code><a href="#topic+Extract">Extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## following example(factor)
(ff &lt;- factor(substring("statistics", 1:10, 1:10), levels = letters))
ff[, drop = TRUE]
factor(letters[7:10])[2:3, drop = TRUE]
</code></pre>

<hr>
<h2 id='Extremes'>Maxima and Minima</h2><span id='topic+max'></span><span id='topic+min'></span><span id='topic+pmax'></span><span id='topic+pmin'></span><span id='topic+pmax.int'></span><span id='topic+pmin.int'></span>

<h3>Description</h3>

<p>Returns the (regular or <b>p</b>arallel) maxima and minima of the
input values.
</p>
<p><code>pmax*()</code> and <code>pmin*()</code> take one or more vectors as
arguments, recycle them to common length and return a single vector
giving the <em>&lsquo;parallel&rsquo;</em> maxima (or minima) of the argument
vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max(..., na.rm = FALSE)
min(..., na.rm = FALSE)

pmax(..., na.rm = FALSE)
pmin(..., na.rm = FALSE)

pmax.int(..., na.rm = FALSE)
pmin.int(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extremes_+3A_...">...</code></td>
<td>
<p>numeric or character arguments (see Note).</p>
</td></tr>
<tr><td><code id="Extremes_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be
removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>max</code> and <code>min</code> return the maximum or minimum of <em>all</em>
the  values present in their arguments, as <code><a href="#topic+integer">integer</a></code> if
all are <code>logical</code> or <code>integer</code>, as <code><a href="#topic+double">double</a></code> if
all are numeric, and character otherwise.
</p>
<p>If <code>na.rm</code> is <code>FALSE</code> an <code>NA</code> value in any of the
arguments will cause a value of <code>NA</code> to be returned, otherwise
<code>NA</code> values are ignored.
</p>
<p>The minimum and maximum of a numeric empty set are <code>+Inf</code> and
<code>-Inf</code> (in this order!) which ensures <em>transitivity</em>, e.g.,
<code>min(x1, min(x2)) == min(x1, x2)</code>.  For numeric <code>x</code>
<code>max(x) == -Inf</code> and <code>min(x) == +Inf</code>
whenever <code>length(x) == 0</code> (after removing missing values if
requested).  However, <code>pmax</code> and <code>pmin</code> return
<code>NA</code> if all the parallel elements are <code>NA</code> even for
<code>na.rm = TRUE</code>.
</p>
<p><code>pmax</code> and <code>pmin</code> take one or more vectors (or matrices) as
arguments and return a single vector giving the &lsquo;parallel&rsquo;
maxima (or minima) of the vectors.  The first element of the result is
the maximum (minimum) of the first elements of all the arguments, the
second element of the result is the maximum (minimum) of the second
elements of all the arguments and so on.  Shorter inputs (of non-zero
length) are recycled if necessary.  Attributes (see
<code><a href="#topic+attributes">attributes</a></code>: such as <code><a href="#topic+names">names</a></code> or
<code><a href="#topic+dim">dim</a></code>) are copied from the first argument (if applicable,
e.g., <em>not</em> for an <code>S4</code> object).
</p>
<p><code>pmax.int</code> and <code>pmin.int</code> are faster internal versions only
used when all arguments are atomic vectors and there are no classes:
they drop all attributes.  (Note that all versions fail for raw and
complex vectors since these have no ordering.)
</p>
<p><code>max</code> and <code>min</code> are generic functions: methods can be
defined for them individually or via the
<code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.  For this to
work properly, the arguments <code>...</code> should be unnamed, and
dispatch is on the first argument.
</p>
<p>By definition the min/max of a numeric vector containing an <code>NaN</code>
is <code>NaN</code>, except that the min/max of any vector containing an
<code>NA</code> is <code>NA</code> even if it also contains an <code>NaN</code>.
Note that <code>max(NA, Inf) == NA</code> even though the maximum would be
<code>Inf</code> whatever the missing value actually is.
</p>
<p>Character versions are sorted lexicographically, and this depends on
the collating sequence of the locale in use: the help for
&lsquo;<a href="#topic+Comparison">Comparison</a>&rsquo; gives details.  The max/min of an empty
character vector is defined to be character <code>NA</code>.  (One could
argue that as <code>""</code> is the smallest character element, the maximum
should be <code>""</code>, but there is no obvious candidate for the
minimum.)
</p>


<h3>Value</h3>

<p>For <code>min</code> or <code>max</code>, a length-one vector.  For <code>pmin</code> or
<code>pmax</code>, a vector of length the longest of the input vectors, or
length zero if one of the inputs had zero length.
</p>
<p>The type of the result will be that of the highest of the inputs in
the hierarchy integer &lt; double &lt; character.
</p>
<p>For <code>min</code> and <code>max</code> if there are only numeric inputs and all
are empty (after possible removal of <code>NA</code>s), the result is double
(<code>Inf</code> or <code>-Inf</code>).
</p>


<h3>S4 methods</h3>

<p><code>max</code> and <code>min</code> are part of the S4
<code><a href="methods.html#topic+S4groupGeneric">Summary</a></code> group generic.  Methods
for them must use the signature <code>x, ..., na.rm</code>.
</p>


<h3>Note</h3>

<p>&lsquo;Numeric&rsquo; arguments are vectors of type integer and numeric,
and logical (coerced to integer).  For historical reasons, <code>NULL</code>
is accepted as equivalent to <code>integer(0)</code>.
</p>
<p><code>pmax</code> and <code>pmin</code> will also work on classed S3 or S4 objects
with appropriate methods for comparison, <code>is.na</code> and <code>rep</code>
(if recycling of arguments is needed).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+range">range</a></code> (<em>both</em> min and max) and
<code><a href="#topic+which.min">which.min</a></code> (<code>which.max</code>) for the <em>arg min</em>,
i.e., the location where an extreme value occurs.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>min</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
 min(5:1, pi) #-&gt; one number
pmin(5:1, pi) #-&gt;  5  numbers

x &lt;- sort(rnorm(100));  cH &lt;- 1.35
pmin(cH, quantile(x)) # no names
pmin(quantile(x), cH) # has names
plot(x, pmin(cH, pmax(-cH, x)), type = "b", main =  "Huber's function")

cut01 &lt;- function(x) pmax(pmin(x, 1), 0)
curve(      x^2 - 1/4, -1.4, 1.5, col = 2)
curve(cut01(x^2 - 1/4), col = "blue", add = TRUE, n = 500)
## pmax(), pmin() preserve attributes of *first* argument
D &lt;- diag(x = (3:1)/4) ; n0 &lt;- numeric()
stopifnot(identical(D,  cut01(D) ),
          identical(n0, cut01(n0)),
          identical(n0, cut01(NULL)),
          identical(n0, pmax(3:1, n0, 2)),
          identical(n0, pmax(n0, 4)))
</code></pre>

<hr>
<h2 id='extSoftVersion'>
Report Versions of Third-Party Software
</h2><span id='topic+extSoftVersion'></span>

<h3>Description</h3>

<p>Report versions of (external) third-party software used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extSoftVersion()
</code></pre>


<h3>Details</h3>

<p>The reports the versions of third-party software libraries in use.
These are often external but might have been compiled into <span class="rlang"><b>R</b></span> when it
was installed.
</p>
<p>With dynamic linking, these are the versions of the libraries linked
to in this session: with static linking, of those compiled in.
</p>


<h3>Value</h3>

<p>A named character vector, currently with components
</p>
<table>
<tr><td><code>zlib</code></td>
<td>
<p>The version of <code>zlib</code> in use.</p>
</td></tr>
<tr><td><code>bzlib</code></td>
<td>
<p>The version of <code>bzlib</code> (from <code>bzip2</code>) in use.</p>
</td></tr>
<tr><td><code>xz</code></td>
<td>
<p>The version of <code>liblzma</code> (from <code>xz</code>) in use.</p>
</td></tr>
<tr><td><code>libdeflate</code></td>
<td>
<p>The version of <code>libdeflate</code> (if any otherwise
<code>""</code>) used when <span class="rlang"><b>R</b></span> was built.</p>
</td></tr>
<tr><td><code>PCRE</code></td>
<td>
<p>The version of <code>PCRE</code> in use. PCRE1 has versions &lt; 10.00,
PCRE2 has versions &gt;= 10.00.</p>
</td></tr>
<tr><td><code>ICU</code></td>
<td>
<p>The version of <code>ICU</code> in use (if any, otherwise <code>""</code>).</p>
</td></tr>
<tr><td><code>TRE</code></td>
<td>
<p>The version of <code>libtre</code> in use.</p>
</td></tr>
<tr><td><code>iconv</code></td>
<td>
<p>The implementation and version of the <code>iconv</code>
library in use (if known).</p>
</td></tr>
<tr><td><code>readline</code></td>
<td>
<p>The version of <code>readline</code> in use (if any,
otherwise <code>""</code>).  If using the emulation by <code>libedit</code> aka
<code>editline</code> this will be <code>"EditLine wrapper"</code> preceded by
the <code>readline</code> version it emulates: that is most likely to be
seen on macOS.
</p>
</td></tr>
<tr><td><code>BLAS</code></td>
<td>
<p>Name of the binary/executable file with the implementation of
<code>BLAS</code> in use (if known, otherwise <code>""</code>).</p>
</td></tr>
</table>
<p>Note that the values for <code>bzlib</code> and <code>pcre</code> normally contain
a date as well as the version number, and that for <code>tre</code> includes
several items separated by spaces, the version number being the
second.
</p>
<p>For <code>iconv</code> this will give the implementation as well as the
version, for example <code>"GNU libiconv 1.14"</code>, <code>"glibc
  2.18"</code> or <code>"win_iconv"</code> (which has no version number).
</p>
<p>The name of the binary/executable file for <code>BLAS</code> can be used as an
indication of which implementation is in use.  Typically, the R version of
BLAS will appear as <code>libR.so</code> (<code>libR.dylib</code>), <code>R</code> or
<code>libRblas.so</code> (<code>libRblas.dylib</code>), depending on how R was built.
Note that <code>libRblas.so</code> (<code>libRblas.dylib</code>) may also be shown for
an external BLAS implementation that had been copied, hard-linked or
renamed by the system administrator.  For an external BLAS, a shared
object file will be given and its path/name may indicate the
vendor/version. The detection does not work on Windows nor for some
uses of the Accelerate framework on macOS.


</p>


<h3>See Also</h3>

<p><code><a href="#topic+libcurlVersion">libcurlVersion</a></code> for the version of <code>libCurl</code>.
</p>
<p><code><a href="#topic+La_version">La_version</a></code> for the version of LAPACK in use.
</p>
<p><code><a href="#topic+La_library">La_library</a></code> for binary/executable file with LAPACK in use.
</p>
<p><code><a href="grDevices.html#topic+grSoftVersion">grSoftVersion</a></code> for third-party graphics software.
</p>
<p><code><a href="tcltk.html#topic+tclVersion">tclVersion</a></code> in package <span class="pkg">tcltk</span> for the version of Tcl/Tk.
</p>
<p><code><a href="#topic+pcre_config">pcre_config</a></code> for PCRE configuration options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extSoftVersion()
## the PCRE version
sub(" .*", "", extSoftVersion()["PCRE"])
</code></pre>

<hr>
<h2 id='factor'>Factors</h2><span id='topic+factor'></span><span id='topic+ordered'></span><span id='topic+is.factor'></span><span id='topic+is.ordered'></span><span id='topic+as.factor'></span><span id='topic+as.ordered'></span><span id='topic+is.na+3C-.factor'></span><span id='topic+Math.factor'></span><span id='topic+Ops.factor'></span><span id='topic+Summary.factor'></span><span id='topic+Ops.ordered'></span><span id='topic+Summary.ordered'></span><span id='topic+addNA'></span><span id='topic+.valid.factor'></span><span id='topic+c.factor'></span>

<h3>Description</h3>

<p>The function <code>factor</code> is used to encode a vector as a factor (the
terms &lsquo;category&rsquo; and &lsquo;enumerated type&rsquo; are also used for
factors).  If argument <code>ordered</code> is <code>TRUE</code>, the factor
levels are assumed to be ordered.  For compatibility with S there is
also a function <code>ordered</code>.
</p>
<p><code>is.factor</code>, <code>is.ordered</code>, <code>as.factor</code> and <code>as.ordered</code>
are the membership and coercion functions for these classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factor(x = character(), levels, labels = levels,
       exclude = NA, ordered = is.ordered(x), nmax = NA)

ordered(x = character(), ...)

is.factor(x)
is.ordered(x)

as.factor(x)
as.ordered(x)

addNA(x, ifany = FALSE)

.valid.factor(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factor_+3A_x">x</code></td>
<td>
<p>a vector of data, usually taking a small number of distinct
values.</p>
</td></tr>
<tr><td><code id="factor_+3A_levels">levels</code></td>
<td>
<p>an optional vector of the unique values (as character strings)
that <code>x</code> might have taken.  The default is the unique set of
values taken by <code><a href="#topic+as.character">as.character</a>(x)</code>, sorted into
increasing order <em>of <code>x</code></em>.  Note that this set can be
specified as smaller than <code>sort(unique(x))</code>.</p>
</td></tr>
<tr><td><code id="factor_+3A_labels">labels</code></td>
<td>
<p><em>either</em> an optional character vector of
labels for the levels (in the same order as <code>levels</code> after
removing those in <code>exclude</code>), <em>or</em> a character string of
length 1.  Duplicated values in <code>labels</code> can be used to map
different values of <code>x</code> to the same factor level.</p>
</td></tr>
<tr><td><code id="factor_+3A_exclude">exclude</code></td>
<td>
<p>a vector of values to be excluded when forming the
set of levels.  This may be factor with the same level set as <code>x</code>
or should be a <code>character</code>.</p>
</td></tr>
<tr><td><code id="factor_+3A_ordered">ordered</code></td>
<td>
<p>logical flag to determine if the levels should be regarded
as ordered (in the order given).</p>
</td></tr>
<tr><td><code id="factor_+3A_nmax">nmax</code></td>
<td>
<p>an upper bound on the number of levels; see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="factor_+3A_...">...</code></td>
<td>
<p>(in <code>ordered(.)</code>): any of the above, apart from
<code>ordered</code> itself.</p>
</td></tr>
<tr><td><code id="factor_+3A_ifany">ifany</code></td>
<td>
<p>only add an <code>NA</code> level if it is used, i.e.
if <code>any(is.na(x))</code>.</p>
</td></tr>
<tr><td><code id="factor_+3A_object">object</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of the vector <code>x</code> is not restricted; it only must have
an <code><a href="#topic+as.character">as.character</a></code> method and be sortable (by
<code><a href="#topic+order">order</a></code>).
</p>
<p>Ordered factors differ from factors only in their class, but methods
and model-fitting functions may treat the two classes quite differently,
see <code><a href="#topic+options">options</a>("contrasts")</code>.
</p>
<p>The encoding of the vector happens as follows.  First all the values
in <code>exclude</code> are removed from <code>levels</code>. If <code>x[i]</code>
equals <code>levels[j]</code>, then the <code>i</code>-th element of the result is
<code>j</code>.  If no match is found for <code>x[i]</code> in <code>levels</code>
(which will happen for excluded values) then the <code>i</code>-th element
of the result is set to <code><a href="#topic+NA">NA</a></code>.
</p>
<p>Normally the &lsquo;levels&rsquo; used as an attribute of the result are
the reduced set of levels after removing those in <code>exclude</code>, but
this can be altered by supplying <code>labels</code>.  This should either
be a set of new labels for the levels, or a character string, in
which case the levels are that character string with a sequence
number appended.
</p>
<p><code>factor(x, exclude = NULL)</code> applied to a factor without
<code><a href="#topic+NA">NA</a></code>s is a no-operation unless there are unused levels: in
that case, a factor with the reduced level set is returned.  If
<code>exclude</code> is used, since <span class="rlang"><b>R</b></span> version 3.4.0, excluding non-existing
character levels is equivalent to excluding nothing, and when
<code>exclude</code> is a <code><a href="#topic+character">character</a></code> vector, that <em>is</em>
applied to the levels of <code>x</code>.
Alternatively, <code>exclude</code> can be factor with the same level set as
<code>x</code> and will exclude the levels present in <code>exclude</code>.
</p>
<p>The codes of a factor may contain <code><a href="#topic+NA">NA</a></code>.  For a numeric
<code>x</code>, set <code>exclude = NULL</code> to make <code><a href="#topic+NA">NA</a></code> an extra
level (prints as &lsquo;<span class="samp">&#8288;&lt;NA&gt;&#8288;</span>&rsquo;); by default, this is the last level.
</p>
<p>If <code>NA</code> is a level, the way to set a code to be missing (as
opposed to the code of the missing level) is to
use <code><a href="#topic+is.na">is.na</a></code> on the left-hand-side of an assignment (as in
<code>is.na(f)[i] &lt;- TRUE</code>; indexing inside <code>is.na</code> does not work).
Under those circumstances missing values are currently printed as
&lsquo;<span class="samp">&#8288;&lt;NA&gt;&#8288;</span>&rsquo;, i.e., identical to entries of level <code>NA</code>.
</p>
<p><code>is.factor</code> is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>
<p>Where <code>levels</code> is not supplied, <code><a href="#topic+unique">unique</a></code> is called.
Since factors typically have quite a small number of levels, for large
vectors <code>x</code> it is helpful to supply <code>nmax</code> as an upper bound
on the number of unique values.
</p>
<p>When using <code><a href="#topic+c">c</a></code> to combine a (possibly
ordered) factor with other objects, if all objects are (possibly
ordered) factors, the result will be a factor with levels the union of
the level sets of the elements, in the order the levels occur in the
level sets of the elements (which means that if all the elements have
the same level set, that is the level set of the result), equivalent
to how <code><a href="#topic+unlist">unlist</a></code> operates on a list of factor objects.
</p>


<h3>Value</h3>

<p><code>factor</code> returns an object of class <code>"factor"</code> which has a
set of integer codes the length of <code>x</code> with a <code>"levels"</code>
attribute of mode <code><a href="#topic+character">character</a></code> and unique
(<code>!<a href="#topic+anyDuplicated">anyDuplicated</a>(.)</code>) entries.  If argument <code>ordered</code>
is true (or <code>ordered()</code> is used) the result has class
<code>c("ordered", "factor")</code>.
Undocumentedly for a long time, <code>factor(x)</code> loses all
<code><a href="#topic+attributes">attributes</a>(x)</code> but <code>"names"</code>, and resets
<code>"levels"</code> and <code>"class"</code>.
</p>
<p>Applying <code>factor</code> to an ordered or unordered factor returns a
factor (of the same type) with just the levels which occur: see also
<code><a href="#topic++5B.factor">[.factor</a></code> for a more transparent way to achieve this.
</p>
<p><code>is.factor</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is of type factor or not.  Correspondingly,
<code>is.ordered</code> returns <code>TRUE</code> when its argument is an ordered
factor and <code>FALSE</code> otherwise.
</p>
<p><code>as.factor</code> coerces its argument to a factor.
It is an abbreviated (sometimes faster) form of <code>factor</code>.
</p>
<p><code>as.ordered(x)</code> returns <code>x</code> if this is ordered, and
<code>ordered(x)</code> otherwise.
</p>
<p><code>addNA</code> modifies a factor by turning <code>NA</code> into an extra
level (so that <code>NA</code> values are counted in tables, for instance).
</p>
<p><code>.valid.factor(object)</code> checks the validity of a factor,
currently only <code>levels(object)</code>, and returns <code>TRUE</code> if it is
valid, otherwise a string describing the validity problem.  This
function is used for <code><a href="methods.html#topic+validObject">validObject</a>(&lt;factor&gt;)</code>.
</p>


<h3>Warning</h3>

<p>The interpretation of a factor depends on both the codes and the
<code>"levels"</code> attribute.  Be careful only to compare factors with
the same set of levels (in the same order).  In particular,
<code>as.numeric</code> applied to a factor is meaningless, and may
happen by implicit coercion.  To transform a factor <code>f</code> to
approximately its original numeric values,
<code>as.numeric(levels(f))[f]</code> is recommended and slightly more
efficient than <code>as.numeric(as.character(f))</code>.
</p>
<p>The levels of a factor are by default sorted, but the sort order
may well depend on the locale at the time of creation, and should
not be assumed to be ASCII.
</p>
<p>There are some anomalies associated with factors that have
<code>NA</code> as a level.  It is suggested to use them sparingly, e.g.,
only for tabulation purposes.
</p>


<h3>Comparison operators and group generic methods</h3>

<p>There are <code>"factor"</code> and <code>"ordered"</code> methods for the
<a href="#topic+group+20generic">group generic</a> <code><a href="#topic+S3groupGeneric">Ops</a></code> which
provide methods for the <a href="#topic+Comparison">Comparison</a> operators,
and for the <code><a href="#topic+min">min</a></code>, <code><a href="#topic+max">max</a></code>, and
<code><a href="#topic+range">range</a></code> generics in <code><a href="#topic+S3groupGeneric">Summary</a></code>
of <code>"ordered"</code>.  (The rest of the groups and the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generate an error as they
are not meaningful for factors.)
</p>
<p>Only <code>==</code> and <code>!=</code> can be used for factors: a factor can
only be compared to another factor with an identical set of levels
(not necessarily in the same ordering) or to a character vector.
Ordered factors are compared in the same way, but the general dispatch
mechanism precludes comparing ordered and unordered factors.
</p>
<p>All the comparison operators are available for ordered factors.
Collation is done by the levels of the operands: if both operands are
ordered factors they must have the same level set.
</p>


<h3>Note</h3>

<p>In earlier versions of <span class="rlang"><b>R</b></span>, storing character data as a factor was more
space efficient if there is even a small proportion of
repeats.  However, identical character strings now share storage, so
the difference is small in most cases.  (Integer values are stored
in 4 bytes whereas each reference to a character string needs a
pointer of 4 or 8 bytes.)
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++5B.factor">[.factor</a></code> for subsetting of factors.
</p>
<p><code><a href="#topic+gl">gl</a></code> for construction of balanced factors and
<code><a href="stats.html#topic+C">C</a></code> for factors with specified contrasts.
<code><a href="#topic+levels">levels</a></code> and <code><a href="#topic+nlevels">nlevels</a></code> for accessing the
levels, and <code><a href="#topic+unclass">unclass</a></code> to get integer codes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(ff &lt;- factor(substring("statistics", 1:10, 1:10), levels = letters))
as.integer(ff)      # the internal codes
(f. &lt;- factor(ff))  # drops the levels that do not occur
ff[, drop = TRUE]   # the same, more transparently

factor(letters[1:20], labels = "letter")

class(ordered(4:1)) # "ordered", inheriting from "factor"
z &lt;- factor(LETTERS[3:1], ordered = TRUE)
## and "relational" methods work:
stopifnot(sort(z)[c(1,3)] == range(z), min(z) &lt; max(z))


## suppose you want "NA" as a level, and to allow missing values.
(x &lt;- factor(c(1, 2, NA), exclude = NULL))
is.na(x)[2] &lt;- TRUE
x  # [1] 1    &lt;NA&gt; &lt;NA&gt;
is.na(x)
# [1] FALSE  TRUE FALSE

## More rational, since R 3.4.0 :
factor(c(1:2, NA), exclude =  "" ) # keeps &lt;NA&gt; , as
factor(c(1:2, NA), exclude = NULL) # always did
## exclude = &lt;character&gt;
z # ordered levels 'A &lt; B &lt; C'
factor(z, exclude = "C") # does exclude
factor(z, exclude = "B") # ditto

## Now, labels maybe duplicated:
## factor() with duplicated labels allowing to "merge levels"
x &lt;- c("Man", "Male", "Man", "Lady", "Female")
## Map from 4 different values to only two levels:
(xf &lt;- factor(x, levels = c("Male", "Man" , "Lady",   "Female"),
                 labels = c("Male", "Male", "Female", "Female")))
#&gt; [1] Male   Male   Male   Female Female
#&gt; Levels: Male Female

## Using addNA()
Month &lt;- airquality$Month
table(addNA(Month))
table(addNA(Month, ifany = TRUE))
</code></pre>

<hr>
<h2 id='file.access'>Ascertain File Accessibility</h2><span id='topic+file.access'></span>

<h3>Description</h3>

<p>Utility function to access information about files on the user's
file systems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.access(names, mode = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file.access_+3A_names">names</code></td>
<td>
<p>character vector containing file names.
Tilde-expansion will be done: see <code><a href="#topic+path.expand">path.expand</a></code>.</p>
</td></tr>
<tr><td><code id="file.access_+3A_mode">mode</code></td>
<td>
<p>integer specifying access mode required: see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>mode</code> value can be the exclusive or (<code>xor</code>), i.e., a
partial sum of the following values, and hence must be in <code>0:7</code>,
</p>

<dl>
<dt>0</dt><dd><p>test for existence.</p>
</dd>
<dt>1</dt><dd><p>test for execute permission.</p>
</dd>
<dt>2</dt><dd><p>test for write permission.</p>
</dd>
<dt>4</dt><dd><p>test for read permission.</p>
</dd>
</dl>

<p>Permission will be computed for real user ID and real group ID (rather
than the effective IDs).
</p>
<p>Please note that it is not a good idea to use this function to test
before trying to open a file.  On a multi-tasking system, it is
possible that the accessibility of a file will change between the time
you call <code>file.access()</code> and the time you try to open the file.
It is better to wrap file open attempts in <code><a href="#topic+try">try</a></code>.
</p>


<h3>Value</h3>

<p>An integer vector with values <code>0</code> for success and <code>-1</code> for failure.
</p>


<h3>Note</h3>

<p>This was written as a replacement for the S-PLUS function
<code>access</code>, a wrapper for the C function of the same name, which
explains the return value encoding.  Note that the return value is
<b>false</b> for <b>success</b>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.info">file.info</a></code> for more details on permissions,
<code><a href="#topic+Sys.chmod">Sys.chmod</a></code> to change permissions, and
<code><a href="#topic+try">try</a></code> for a &lsquo;test it and see&rsquo; approach.
</p>
<p><code><a href="utils.html#topic+file_test">file_test</a></code> for shell-style file tests.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fa &lt;- file.access(dir("."))

table(fa) # count successes &amp; failures


</code></pre>

<hr>
<h2 id='file.choose'>Choose a File Interactively</h2><span id='topic+file.choose'></span>

<h3>Description</h3>

<p>Choose a file interactively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.choose(new = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file.choose_+3A_new">new</code></td>
<td>
<p>Logical: choose the style of dialog box
presented to the user: at present only new = FALSE is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of length one giving the file path.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+list.files">list.files</a></code> for non-interactive selection.
</p>

<hr>
<h2 id='file.info'>Extract File Information</h2><span id='topic+file.info'></span><span id='topic+file.mode'></span><span id='topic+file.mtime'></span><span id='topic+file.size'></span>

<h3>Description</h3>

<p>Utility function to extract information about files on the user's
file systems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.info(..., extra_cols = TRUE)

file.mode(...)
file.mtime(...)
file.size(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file.info_+3A_...">...</code></td>
<td>
<p>character vectors containing file paths.  Tilde-expansion
is done: see <code><a href="#topic+path.expand">path.expand</a></code>.</p>
</td></tr>
<tr><td><code id="file.info_+3A_extra_cols">extra_cols</code></td>
<td>
<p>logical: return all cols rather than just the
first six.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>What constitutes a &lsquo;file&rsquo; is OS-dependent but includes
directories.  (However, directory names must not include a trailing
backslash or slash on Windows.)  See also the section in the help for
<code><a href="#topic+file.exists">file.exists</a></code> on case-insensitive file systems.
</p>
<p>The file &lsquo;mode&rsquo; follows POSIX conventions, giving three octal
digits summarizing the permissions for the file owner, the owner's
group and for anyone respectively.  Each digit is the logical
<em>or</em> of read (4), write (2) and execute/search (1) permissions.
</p>
<p>See <a href="#topic+files">files</a> for how file paths with marked encodings are interpreted.
</p>

<dl>
<dt>On unix alikes:</dt><dd>
<p>On most systems symbolic links are followed, so information is given
about the file to which the link points rather than about the link.</p>
</dd>
<dt>On Windows:</dt><dd>
<p>File modes are probably only useful on <abbr>NTFS</abbr> file systems, and it seems
all three digits refer to the file's owner.
The execute/search bits are set for directories, and for files based
on their extensions (e.g., &lsquo;<span class="file">.exe</span>&rsquo;, &lsquo;<span class="file">.com</span>&rsquo;, &lsquo;<span class="file">.cmd</span>&rsquo;
and &lsquo;<span class="file">.bat</span>&rsquo; files).  <code><a href="#topic+file.access">file.access</a></code> will give a more
reliable view of read/write access availability to the <span class="rlang"><b>R</b></span> process.
</p>
<p>UTF-8-encoded file names not valid in the current locale can be used.
</p>
<p>Junction points and symbolic links are followed, so information is
given about the file/directory to which the link points rather than
about the link.
</p>
</dd></dl>



<h3>Value</h3>

<p>For <code>file.info()</code>, data frame with row names the file names and columns
</p>
<table>
<tr><td><code>size</code></td>
<td>
<p>double: File size in bytes.</p>
</td></tr>
<tr><td><code>isdir</code></td>
<td>
<p>logical: Is the file a directory?</p>
</td></tr>
<tr><td><code>mode</code></td>
<td>
<p>integer of class <code>"octmode"</code>.  The file permissions,
printed in octal, for example <code>644</code>.</p>
</td></tr>
<tr><td><code>mtime</code>, <code>ctime</code>, <code>atime</code></td>
<td>
<p>object of class <code>"POSIXct"</code>:
file modification, &lsquo;last status change&rsquo; and last access times.</p>
</td></tr>
</table>

<dl>
<dt>On unix alikes:</dt><dd> 
<dl>
<dt>uid:</dt><dd><p>integer, the user ID of the file's owner.</p>
</dd>
<dt>gid:</dt><dd><p>integer, the group ID of the file's group.</p>
</dd>
<dt>uname:</dt><dd><p>character, <code>uid</code> interpreted as a user name.</p>
</dd>
<dt>grname:</dt><dd><p>character, <code>gid</code> interpreted as a group name.</p>
</dd>
</dl>
<p>Unknown user and group names will be <code>NA</code>.
</p>
</dd>
<dt>On Windows only:</dt><dd> 
<dl>
<dt>exe:</dt><dd><p>character indicating the sort of executable.  Possible
values are <code>"no"</code>, <code>"msdos"</code>, <code>"win16"</code>,
<code>"win32"</code>, <code>"win64"</code> and <code>"unknown"</code>.  Note that a
file (e.g., a script file) can be executable according to the mode
bits but not executable in this sense.</p>
</dd>
</dl>
</dd>
</dl>

<p>If <code>extra_cols</code> is false, only the first six columns are
returned: as these can all be found from a single C system call this
can be faster.  (However, properly configured systems will use a
&lsquo;name service cache daemon&rsquo; to speed up the name lookups.)
</p>
<p>Entries for non-existent or non-readable files will be <code>NA</code>.
</p>
<p>The <code>uid</code>, <code>gid</code>, <code>uname</code> and <code>grname</code> columns
may not be supplied on a non-POSIX Unix-alike system, and will not be
on Windows.
</p>
<p>What is meant by the three file times depends on the OS and file
system.  On Windows native file systems <code>ctime</code> is the file
creation time (something which is not recorded on most Unix-alike file
systems).  What is meant by &lsquo;file access&rsquo; and hence the
&lsquo;last access time&rsquo; is system-dependent.
</p>
<p>The resolution of the file times depends on both the OS and the type
of the file system.  Modern file systems typically record times to an
accuracy of a microsecond or better: notable exceptions are <abbr>HFS+</abbr> on
macOS (recorded in seconds) and modification time on older FAT systems
(recorded in increments of 2 seconds).  Note that <code>"POSIXct"</code>
times are by default printed in whole seconds: to change that see
<code><a href="#topic+strftime">strftime</a></code>.
</p>
<p><code>file.mode()</code>, <code>file.mtime()</code> and <code>file.size()</code> are fast
convenience wrappers returning just one of the columns.
</p>


<h3>Note</h3>

<p>Some (now old) unix alike systems allow files of more than 2<abbr>Gb</abbr> to be created but
not accessed by the <code>stat</code> system call.  Such files may show up
as non-readable (and very likely not be readable by any of <span class="rlang"><b>R</b></span>'s input
functions).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.readlink">Sys.readlink</a></code> to find out about symbolic links,
<code><a href="#topic+files">files</a></code>, <code><a href="#topic+file.access">file.access</a></code>,
<code><a href="#topic+list.files">list.files</a></code>,
and <code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code> for the date formats.
</p>
<p><code><a href="#topic+Sys.chmod">Sys.chmod</a></code> to change permissions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ncol(finf &lt;- file.info(dir()))  # at least six
finf # the whole list
## Those that are more than 100 days old :
finf &lt;- file.info(dir(), extra_cols = FALSE)
finf[difftime(Sys.time(), finf[,"mtime"], units = "days") &gt; 100 , 1:4]

file.info("no-such-file-exists")

## E.g., for R-core, in a R-devel version:
if(Sys.info()[["sysname"]] == "Linux") 
    sort(file.mtime(file.path(R.home("bin"),
                             c("",
                               file.path(c("", "exec"), "R")))
         ))
</code></pre>

<hr>
<h2 id='file.path'>Construct Path to File</h2><span id='topic+file.path'></span>

<h3>Description</h3>

<p>Construct the path to a file from components in a platform-independent
way.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.path(..., fsep = .Platform$file.sep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file.path_+3A_...">...</code></td>
<td>
<p>character vectors.  <a href="#topic+Long+20vectors">Long vectors</a> are not supported.</p>
</td></tr>
<tr><td><code id="file.path_+3A_fsep">fsep</code></td>
<td>
<p>the path separator to use (assumed to be ASCII).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implementation is designed to be fast (faster than
<code><a href="#topic+paste">paste</a></code>) as this function is used extensively in <span class="rlang"><b>R</b></span> itself.
</p>
<p>It can also be used for environment paths such as <span class="env">PATH</span> and
<span class="env">R_LIBS</span> with <code>fsep = .Platform$path.sep</code>.
</p>
<p>Trailing path separators are invalid for Windows file paths apart from
&lsquo;<span class="file">/</span>&rsquo; and &lsquo;<span class="file">d:/</span>&rsquo; (although some functions/utilities do accept
them), so a trailing <code>/</code> or <code>\</code> is removed there.
</p>


<h3>Value</h3>

<p>A character vector of the arguments concatenated term-by-term and
separated by <code>fsep</code> if all arguments have positive length;
otherwise, an empty character vector (unlike <code><a href="#topic+paste">paste</a></code>).
</p>
<p>An element of the result will be marked (see <code><a href="#topic+Encoding">Encoding</a></code>) as
UTF-8 if run in a UTF-8 locale (when marked inputs are converted to
UTF-8) or if a component of the result is marked as UTF-8, or as
Latin-1 in a non-Latin-1 locale.
</p>


<h3>Note</h3>

<p>The components are by default separated by <code>/</code>
(not <code>\</code>) on Windows.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+basename">basename</a></code>, <code><a href="#topic+normalizePath">normalizePath</a></code>, <code><a href="#topic+path.expand">path.expand</a></code>.
</p>

<hr>
<h2 id='file.show'>Display One or More Text Files</h2><span id='topic+file.show'></span>

<h3>Description</h3>

<p>Display one or more (plain) text files, in a platform
specific way, typically via a &lsquo;pager&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.show(..., header = rep("", nfiles),
          title = "R Information",
          delete.file = FALSE, pager = getOption("pager"),
          encoding = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="file.show_+3A_...">...</code></td>
<td>
<p>one or more character vectors containing the names of the
files to be displayed.  Paths with have <a href="#topic+tilde+20expansion">tilde expansion</a>.</p>
</td></tr>
<tr><td><code id="file.show_+3A_header">header</code></td>
<td>
<p>character vector (of the same length as the number of files
specified in <code>...</code>) giving a header for each file being
displayed.  Defaults to empty strings.</p>
</td></tr>
<tr><td><code id="file.show_+3A_title">title</code></td>
<td>
<p>an overall title for the display.  If a single separate
window is used for the display, <code>title</code> will be used as the window
title.  If multiple windows are used, their titles should combine the title
and the file-specific header.</p>
</td></tr>
<tr><td><code id="file.show_+3A_delete.file">delete.file</code></td>
<td>
<p>should the files be deleted after display?  Used
for temporary files.</p>
</td></tr>
<tr><td><code id="file.show_+3A_pager">pager</code></td>
<td>
<p>the pager to be used, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="file.show_+3A_encoding">encoding</code></td>
<td>
<p>character string giving the encoding to be assumed for
the file(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides the core of the R help system, but it can be
used for other purposes as well, such as <code><a href="utils.html#topic+page">page</a></code>.
</p>
<p>How the pager is implemented is highly system-dependent.
</p>
<p>The basic Unix version concatenates the files (using the headers) to a
temporary file, and displays it in the pager selected by the
<code>pager</code> argument, which is a character vector specifying a system
command (a full path or a command found on the <span class="env">PATH</span>) to run on
the set of files.  The &lsquo;factory-fresh&rsquo; default is to use
&lsquo;<span class="file">R_HOME/bin/pager</span>&rsquo;, which is a shell script running the command-line
specified by the environment variable <span class="env">PAGER</span> whose default is set
at configuration, usually to <code>less</code>.  On a Unix-alike
<code>more</code> is used if <code>pager</code> is empty.
</p>
<p>Most GUI systems will use a separate pager window for each file, and
let the user leave it up while <span class="rlang"><b>R</b></span> continues running.  The selection of
such pagers could either be done using special pager names being
intercepted by lower-level code (such as <code>"internal"</code> and
<code>"console"</code> on Windows), or by letting <code>pager</code> be an <span class="rlang"><b>R</b></span>
function which will be called with arguments <code>(files, header,
    title, delete.file)</code> corresponding to the first four arguments of
<code>file.show</code> and take care of interfacing to the GUI.
</p>
<p>The <code>R.app</code> GUI on macOS uses its internal pager irrespective
of the setting of <code>pager</code>.
</p>
<p>Not all implementations will honour <code>delete.file</code>.  In
particular, using an external pager on Windows does not, as there is
no way to know when the external application has finished with the
file.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka, Brian Ripley.</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.exists">file.exists</a></code>, <code><a href="#topic+list.files">list.files</a></code>.
</p>
<p>Text-type <code><a href="utils.html#topic+help">help</a></code> and
<code><a href="utils.html#topic+RShowDoc">RShowDoc</a></code> call <code>file.show</code>.
</p>
<p>Consider <code><a href="#topic+getOption">getOption</a>("pdfviewer")</code> and,
e.g., <code><a href="#topic+system">system</a></code> for displaying pdf files.
</p>
<p><code><a href="utils.html#topic+file.edit">file.edit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file.show(file.path(R.home("doc"), "COPYRIGHTS"))
</code></pre>

<hr>
<h2 id='files'>File Manipulation</h2><span id='topic+files'></span><span id='topic+file.append'></span><span id='topic+file.copy'></span><span id='topic+file.create'></span><span id='topic+file.exists'></span><span id='topic+file.remove'></span><span id='topic+file.rename'></span><span id='topic+file.symlink'></span><span id='topic+file.link'></span>

<h3>Description</h3>

<p>These functions provide a low-level interface to the computer's
file system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file.create(..., showWarnings = TRUE)
file.exists(...)
file.remove(...)
file.rename(from, to)
file.append(file1, file2)
file.copy(from, to, overwrite = recursive, recursive = FALSE,
          copy.mode = TRUE, copy.date = FALSE)
file.symlink(from, to)
file.link(from, to)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="files_+3A_...">...</code>, <code id="files_+3A_file1">file1</code>, <code id="files_+3A_file2">file2</code></td>
<td>
<p>character vectors, containing file names or paths.</p>
</td></tr>
<tr><td><code id="files_+3A_from">from</code>, <code id="files_+3A_to">to</code></td>
<td>
<p>character vectors, containing file names or paths.
For <code>file.copy</code> and <code>file.symlink</code>
<code>to</code> can alternatively be the path to a single existing directory.</p>
</td></tr>
<tr><td><code id="files_+3A_overwrite">overwrite</code></td>
<td>
<p>logical; should existing destination files be overwritten?</p>
</td></tr>
<tr><td><code id="files_+3A_showwarnings">showWarnings</code></td>
<td>
<p>logical; should the warnings on failure be shown?</p>
</td></tr>
<tr><td><code id="files_+3A_recursive">recursive</code></td>
<td>
<p>logical.  If <code>to</code> is a directory, should
directories in <code>from</code> be copied (and their contents)?  (Like
<code>cp -R</code> on POSIX OSes.)</p>
</td></tr>
<tr><td><code id="files_+3A_copy.mode">copy.mode</code></td>
<td>
<p>logical:  should file permission bits be copied where
possible?</p>
</td></tr>
<tr><td><code id="files_+3A_copy.date">copy.date</code></td>
<td>
<p>logical:  should file dates be preserved where
possible? See <code><a href="#topic+Sys.setFileTime">Sys.setFileTime</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> arguments are concatenated to form one character
string: you can specify the files separately or as one vector.  All of
these functions expand path names: see
<code><a href="#topic+path.expand">path.expand</a></code>.  (<code>file.exists</code> silently reports false
for paths that would be too long after expansion: the rest will give a
warning.)
</p>
<p><code>file.create</code> creates files with the given names if they do not
already exist and truncates them if they do.  They are created with
the maximal read/write permissions allowed by the
&lsquo;<a href="#topic+umask">umask</a>&rsquo; setting (where relevant).  By default a warning
is given (with the reason) if the operation fails.
</p>
<p><code>file.exists</code> returns a logical vector indicating whether the
files named by its argument exist.  (Here &lsquo;exists&rsquo; is in the
sense of the system's <code>stat</code> call: a file will be reported as
existing only if you have the permissions needed by <code>stat</code>.
Existence can also be checked by <code><a href="#topic+file.access">file.access</a></code>, which
might use different permissions and so obtain a different result.
Note that the existence of a file does not imply that it is readable:
for that use <code><a href="#topic+file.access">file.access</a></code>.)  What constitutes a
&lsquo;file&rsquo; is system-dependent, but should include directories.
(However, directory names must not include a trailing backslash or
slash on Windows.)  Note that if the file is a symbolic link on a
Unix-alike, the result indicates if the link points to an actual file,
not just if the link exists. On Windows, the result is unreliable for a
broken symbolic link (junction).
Lastly, note the <em>different</em> function <code><a href="#topic+exists">exists</a></code> which
checks for existence of <span class="rlang"><b>R</b></span> objects.
</p>
<p><code>file.remove</code> attempts to remove the files named in its argument.
On most Unix platforms &lsquo;file&rsquo; includes <em>empty</em>
directories, symbolic links, fifos and sockets.  On Windows,
&lsquo;file&rsquo; means a regular file and not, say, an empty directory.
</p>
<p><code>file.rename</code> attempts to rename files (and <code>from</code> and
<code>to</code> must be of the same length).  Where file permissions allow
this will overwrite an existing element of <code>to</code>.  This is subject
to the limitations of the OS's corresponding system call (see
something like <code>man 2 rename</code> on a Unix-alike): in particular
in the interpretation of &lsquo;file&rsquo;: most platforms will not rename
files from one file system to another.  <strong>NB:</strong> This means that
renaming a file from a temporary directory to the user's filespace or
during package installation will often fail.  (On Windows,
<code>file.rename</code> can rename files but not directories across
volumes.)  On platforms which allow directories to be renamed,
typically neither or both of <code>from</code> and <code>to</code> must a
directory, and if <code>to</code> exists it must be an empty directory.
</p>
<p><code>file.append</code> attempts to append the files named by its
second argument to those named by its first.  The <span class="rlang"><b>R</b></span> subscript
recycling rule is used to align names given in vectors
of different lengths.
</p>
<p><code>file.copy</code> works in a similar way to <code>file.append</code> but with
the arguments in the natural order for copying.  Copying to existing
destination files is skipped unless <code>overwrite = TRUE</code>.  The
<code>to</code> argument can specify a single existing directory.  If
<code>copy.mode = TRUE</code> file read/write/execute permissions are copied
where possible, restricted by &lsquo;<a href="#topic+umask">umask</a>&rsquo;.  (On Windows this
applies only to files.)  Other security attributes such as <abbr>ACL</abbr>s are not
copied.  On a POSIX filesystem the targets of symbolic links will be
copied rather than the links themselves, and hard links are copied
separately.  Using <code>copy.date = TRUE</code> may or may not copy the
timestamp exactly (for example, fractional seconds may be omitted),
but is more likely to do so as from <span class="rlang"><b>R</b></span> 3.4.0.
</p>
<p><code>file.symlink</code> and <code>file.link</code> make symbolic and hard links
on those file systems which support them.  For <code>file.symlink</code> the
<code>to</code> argument can specify a single existing directory.  (Unix and
macOS native filesystems support both.  Windows has hard links to
files on <abbr>NTFS</abbr> file systems and concepts related to symbolic links on
recent versions: see the section below on the Windows version of this
help page.  What happens on a FAT or <abbr>SMB</abbr>-mounted file system is OS-specific.)
</p>
<p>File arguments with a marked encoding (see <code><a href="#topic+Encoding">Encoding</a></code> are
if possible translated to the native encoding, except on Windows where
Unicode file operations are used (so marking as UTF-8 can be used to
access file paths not in the native encoding on suitable file
systems).
</p>


<h3>Value</h3>

<p>These functions return a logical vector indicating which
operation succeeded for each of the files attempted.  Using a missing
value for a file or path name will always be regarded as a failure.
</p>
<p>If <code>showWarnings = TRUE</code>, <code>file.create</code> will give a warning
for an unexpected failure.
</p>


<h3>Case-insensitive file systems</h3>

<p>Case-insensitive file systems are the norm on Windows and macOS,
but can be found on all OSes (for example a FAT-formatted USB drive is
probably case-insensitive).
</p>
<p>These functions will most likely match existing files regardless of case
on such file systems: however this is an OS function and it is
possible that file names might be mapped to upper or lower case.
</p>


<h3>Warning</h3>

<p>Always check the return value of these functions when used in package
code.  This is especially important for <code>file.rename</code>, which has
OS-specific restrictions (and note that the session temporary
directory is commonly on a different file system from the working
directory): it is only portable to use <code>file.rename</code> to change
file name(s) within a single directory.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka, Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.info">file.info</a></code>, <code><a href="#topic+file.access">file.access</a></code>, <code><a href="#topic+file.path">file.path</a></code>,
<code><a href="#topic+file.show">file.show</a></code>, <code><a href="#topic+list.files">list.files</a></code>,
<code><a href="#topic+unlink">unlink</a></code>, <code><a href="#topic+basename">basename</a></code>,
<code><a href="#topic+path.expand">path.expand</a></code>.
</p>
<p><code><a href="#topic+dir.create">dir.create</a></code>.
</p>
<p><code><a href="#topic+Sys.glob">Sys.glob</a></code> to expand wildcards in file specifications.
</p>
<p><code><a href="utils.html#topic+file_test">file_test</a></code>, <code><a href="#topic+Sys.readlink">Sys.readlink</a></code> (for &lsquo;symlink&rsquo;s).
</p>
<p><a href="https://en.wikipedia.org/wiki/Hard_link">https://en.wikipedia.org/wiki/Hard_link</a> and
<a href="https://en.wikipedia.org/wiki/Symbolic_link">https://en.wikipedia.org/wiki/Symbolic_link</a> for the concepts of
links and their limitations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cat("file A\n", file = "A")
cat("file B\n", file = "B")
file.append("A", "B")
file.create("A") # (trashing previous)
file.append("A", rep("B", 10))
if(interactive()) file.show("A") # -&gt; the 10 lines from 'B'
file.copy("A", "C")
dir.create("tmp")
file.copy(c("A", "B"), "tmp")
list.files("tmp") # -&gt; "A" and "B"
setwd("tmp")
file.remove("A") # the tmp/A file
file.symlink(file.path("..", c("A", "B")), ".")
                     # |--&gt; (TRUE,FALSE) : ok for A but not B as it exists already
setwd("..")
unlink("tmp", recursive = TRUE)
file.remove("A", "B", "C")

</code></pre>

<hr>
<h2 id='files2'>Manipulation of Directories and File Permissions</h2><span id='topic+dir.create'></span><span id='topic+dir.exists'></span><span id='topic+Sys.chmod'></span><span id='topic+Sys.umask'></span><span id='topic+umask'></span>

<h3>Description</h3>

<p>These functions provide a low-level interface to the computer's
file system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dir.exists(paths)
dir.create(path, showWarnings = TRUE, recursive = FALSE, mode = "0777")
Sys.chmod(paths, mode = "0777", use_umask = TRUE)
Sys.umask(mode = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="files2_+3A_path">path</code></td>
<td>
<p>a character vector containing a single path name.  Tilde
expansion (see <code><a href="#topic+path.expand">path.expand</a></code>) is done.</p>
</td></tr>
<tr><td><code id="files2_+3A_paths">paths</code></td>
<td>
<p>character vectors containing file or directory paths.  Tilde
expansion (see <code><a href="#topic+path.expand">path.expand</a></code>) is done.</p>
</td></tr>
<tr><td><code id="files2_+3A_showwarnings">showWarnings</code></td>
<td>
<p>logical; should the warnings on failure be shown?</p>
</td></tr>
<tr><td><code id="files2_+3A_recursive">recursive</code></td>
<td>
<p>logical. Should elements of the path other than the
last be created?  If true, like the Unix command <code>mkdir -p</code>.</p>
</td></tr>
<tr><td><code id="files2_+3A_mode">mode</code></td>
<td>
<p>the mode to be used on Unix-alikes: it will be
coerced by <code><a href="#topic+as.octmode">as.octmode</a></code>.  For <code>Sys.chmod</code> it is
recycled along <code>paths</code>.</p>
</td></tr>
<tr><td><code id="files2_+3A_use_umask">use_umask</code></td>
<td>
<p>logical: should the mode be restricted by the
<code>umask</code> setting?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dir.exists</code> checks that the paths exist (in the same sense as
<code><a href="#topic+file.exists">file.exists</a></code>) and are directories.
</p>
<p><code>dir.create</code> creates the last element of the path, unless
<code>recursive = TRUE</code>.  Trailing path separators are discarded.
The mode will be modified by the <code>umask</code> setting in the same way
as for the system function <code>mkdir</code>.  What modes can be set is
OS-dependent, and it is unsafe to assume that more than three octal
digits will be used.  For more details see your OS's documentation on the
system call <code>mkdir</code>, e.g. <code>man 2 mkdir</code> (and not that on
the command-line utility of that name).
</p>
<p>One of the idiosyncrasies of Windows is that directory creation may
report success but create a directory with a different name, for
example <code>dir.create("G.S.")</code> creates &lsquo;<span class="file">&quot;G.S&quot;</span>&rsquo;.  This is
undocumented, and what are the precise circumstances is unknown (and
might depend on the version of Windows).  Also avoid directory names
with a trailing space.


</p>
<p><code>Sys.chmod</code> sets the file permissions of one or more files.
It may not be supported on a system (when a warning is issued).
See the comments for <code>dir.create</code> for how modes are interpreted.
Changing mode on a symbolic link is unlikely to work (nor be
necessary).  For more details see your OS's documentation on the
system call <code>chmod</code>, e.g. <code>man 2 chmod</code> (and not that on
the command-line utility of that name).  Whether this changes the
permission of a symbolic link or its target is OS-dependent (although
to change the target is more common, and POSIX does not support modes
for symbolic links: BSD-based Unixes do, though).
</p>
<p><code>Sys.umask</code> sets the <code>umask</code> and returns the previous value:
as a special case <code>mode = NA</code> just returns the current value.
It may not be supported (when a warning is issued and <code>"0"</code>
is returned).  For more details see your OS's documentation on the
system call <code>umask</code>, e.g. <code>man 2 umask</code>.
</p>
<p>How modes are handled depends on the file system, even on Unix-alikes
(although their documentation is often written assuming a POSIX file
system).  So treat documentation cautiously if you are using, say, a
FAT/FAT32 or network-mounted file system.
</p>
<p>See <a href="#topic+files">files</a> for how file paths with marked encodings are interpreted.
</p>


<h3>Value</h3>

<p><code>dir.exists</code> returns a logical vector of <code>TRUE</code> or
<code>FALSE</code> values (without names).
</p>
<p><code>dir.create</code> and <code>Sys.chmod</code> return invisibly a logical vector
indicating if the operation succeeded for each of the files attempted.
Using a missing value for a path name will always be regarded as a
failure.  <code>dir.create</code> indicates failure if the directory already
exists.  If <code>showWarnings = TRUE</code>, <code>dir.create</code> will give a
warning for an unexpected failure (e.g., not for a missing value nor
for an already existing component for <code>recursive = TRUE</code>).
</p>
<p><code>Sys.umask</code> returns the previous value of the <code>umask</code>,
as a length-one object of class <code>"<a href="#topic+octmode">octmode</a>"</code>: the
visibility flag is off unless <code>mode</code> is <code>NA</code>.
</p>
<p>See also the section in the help for <code><a href="#topic+file.exists">file.exists</a></code> on
case-insensitive file systems for the interpretation of <code>path</code>
and <code>paths</code>.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka, Brian Ripley
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.info">file.info</a></code>, <code><a href="#topic+file.exists">file.exists</a></code>, <code><a href="#topic+file.path">file.path</a></code>,
<code><a href="#topic+list.files">list.files</a></code>, <code><a href="#topic+unlink">unlink</a></code>,
<code><a href="#topic+basename">basename</a></code>, <code><a href="#topic+path.expand">path.expand</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Fix up maximal allowed permissions in a file tree
Sys.chmod(list.dirs("."), "777")
f &lt;- list.files(".", all.files = TRUE, full.names = TRUE, recursive = TRUE)
Sys.chmod(f, (file.mode(f) | "664"))

## End(Not run)</code></pre>

<hr>
<h2 id='find.package'>Find Packages</h2><span id='topic+find.package'></span><span id='topic+path.package'></span><span id='topic+packageNotFoundError'></span>

<h3>Description</h3>

<p>Find the paths to one or more packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.package(package, lib.loc = NULL, quiet = FALSE,
             verbose = getOption("verbose"))

path.package(package, quiet = FALSE)

packageNotFoundError(package, lib.loc, call = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.package_+3A_package">package</code></td>
<td>
<p>character vector: the names of packages.</p>
</td></tr>
<tr><td><code id="find.package_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector describing the location of <span class="rlang"><b>R</b></span>
library trees to search through, or <code>NULL</code>.  The default value
of <code>NULL</code> corresponds to checking the loaded namespace, then
all libraries currently known in <code><a href="#topic+.libPaths">.libPaths</a>()</code>.</p>
</td></tr>
<tr><td><code id="find.package_+3A_quiet">quiet</code></td>
<td>
<p>logical.  Should this not give warnings or an error
if the package is not found?</p>
</td></tr>
<tr><td><code id="find.package_+3A_verbose">verbose</code></td>
<td>
<p>a logical.  If <code>TRUE</code>, additional diagnostics are
printed, notably when a package is found more than once.</p>
</td></tr>
<tr><td><code id="find.package_+3A_call">call</code></td>
<td>
<p>call expression.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>find.package</code> returns path to the locations where the
given packages are found.  If <code>lib.loc</code> is <code>NULL</code>, then
loaded namespaces are searched before the libraries.  If a package is
found more than once, the first match is used.  Unless <code>quiet =
  TRUE</code> a warning will be given about the named packages which are not
found, and an error if none are.  If <code>verbose</code> is true, warnings
about packages found more than once are given.  For a package to be
returned it must contain a either a &lsquo;<span class="file">Meta</span>&rsquo; subdirectory or a
&lsquo;<span class="file">DESCRIPTION</span>&rsquo; file containing a valid <code>version</code> field, but
it need not be installed (it could be a source package if
<code>lib.loc</code> was set suitably).
</p>
<p><code>find.package</code> is not usually the right tool to find out if a
package is available for use: the only way to do that is to use
<code><a href="#topic+require">require</a></code> to try to load it.  It need not be installed for
the correct platform, it might have a version requirement not met by
the running version of <span class="rlang"><b>R</b></span>, there might be dependencies which are not
available, ....
</p>
<p><code>path.package</code> returns the paths from which the named packages
were loaded, or if none were named, for all currently attached packages.
Unless <code>quiet = TRUE</code> it will warn if some of the packages named
are not attached, and given an error if none are.
</p>
<p><code>packageNotFoundError</code> creates an error condition object of class
<code>packageNotFoundError</code> for signaling errors. The condition object
contains the fields <code>package</code> and <code>lib.loc</code>.  
</p>


<h3>Value</h3>

<p>A character vector of paths of package directories.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+path.expand">path.expand</a></code> and <code><a href="#topic+normalizePath">normalizePath</a></code> for path
standardization.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>try(find.package("knitr"))
## will not give an error, maybe a warning about *all* locations it is found:
find.package("kitty", quiet=TRUE, verbose=TRUE)

## Find all .libPaths() entries a package is found:
findPkgAll &lt;- function(pkg)
  unlist(lapply(.libPaths(), function(lib)
           find.package(pkg, lib, quiet=TRUE, verbose=FALSE)))

findPkgAll("MASS")
findPkgAll("knitr")
</code></pre>

<hr>
<h2 id='findInterval'>Find Interval Numbers or Indices</h2><span id='topic+findInterval'></span>

<h3>Description</h3>

<p>Given a vector of non-decreasing breakpoints in <code>vec</code>, find the
interval containing each element of <code>x</code>; i.e., if
<code>i &lt;- findInterval(x,v)</code>, for each index <code>j</code> in <code>x</code>
<code class="reqn">v_{i_j} \le x_j &lt; v_{i_j + 1}</code>
where <code class="reqn">v_0 := -\infty</code>,
<code class="reqn">v_{N+1} := +\infty</code>, and <code>N &lt;- length(v)</code>.
At the two boundaries, the returned index may differ by 1, depending
on the optional arguments <code>rightmost.closed</code> and <code>all.inside</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findInterval(x, vec, rightmost.closed = FALSE, all.inside = FALSE,
             left.open = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findInterval_+3A_x">x</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="findInterval_+3A_vec">vec</code></td>
<td>
<p>numeric, sorted (weakly) increasingly, of length <code>N</code>,
say.</p>
</td></tr>
<tr><td><code id="findInterval_+3A_rightmost.closed">rightmost.closed</code></td>
<td>
<p>logical; if true, the rightmost interval,
<code>vec[N-1] .. vec[N]</code> is treated as <em>closed</em>, see below.</p>
</td></tr>
<tr><td><code id="findInterval_+3A_all.inside">all.inside</code></td>
<td>
<p>logical; if true, the returned indices are coerced
into <code>1,...,N-1</code>, i.e., <code>0</code> is mapped to <code>1</code>
and <code>N</code> to <code>N-1</code>.</p>
</td></tr>
<tr><td><code id="findInterval_+3A_left.open">left.open</code></td>
<td>
<p>logical; if true all the intervals are open at left
and closed at right; in the formulas below, <code class="reqn">\le</code> should be
swapped with <code class="reqn">&lt;</code> (and <code class="reqn">&gt;</code> with <code class="reqn">\ge</code>), and
<code>rightmost.closed</code> means &lsquo;leftmost is closed&rsquo;.  This may
be useful, e.g., in survival analysis computations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>findInterval</code> finds the index of one vector <code>x</code> in
another, <code>vec</code>, where the latter must be non-decreasing.  Where
this is trivial, equivalent to <code>apply( outer(x, vec, `&gt;=`), 1, sum)</code>,
as a matter of fact, the internal algorithm uses interval search
ensuring <code class="reqn">O(n \log N)</code> complexity where
<code>n &lt;- length(x)</code> (and <code>N &lt;- length(vec)</code>).  For (almost)
sorted <code>x</code>, it will be even faster, basically <code class="reqn">O(n)</code>.
</p>
<p>This is the same computation as for the empirical distribution
function, and indeed, <code>findInterval(t, sort(X))</code> is
<em>identical</em> to <code class="reqn">n F_n(t; X_1,\dots,X_n)</code> where <code class="reqn">F_n</code> is the empirical distribution
function of <code class="reqn">X_1,\dots,X_n</code>.
</p>
<p>When <code>rightmost.closed = TRUE</code>, the result for <code>x[j] = vec[N]</code>
(<code class="reqn"> = \max vec</code>), is <code>N - 1</code> as for all other
values in the last interval.
</p>
<p><code>left.open = TRUE</code> is occasionally useful, e.g., for survival data.
For (anti-)symmetry reasons, it is equivalent to using
&ldquo;mirrored&rdquo; data, i.e., the following is always true:
</p>
<pre>
    identical(
          findInterval( x,  v,      left.open= TRUE, ...) ,
      N - findInterval(-x, -v[N:1], left.open=FALSE, ...) )
  </pre>
<p>where <code>N &lt;- length(vec)</code> as above.
</p>


<h3>Value</h3>

<p>vector of length <code>length(x)</code> with values in <code>0:N</code> (and
<code>NA</code>) where <code>N &lt;- length(vec)</code>, or values coerced to
<code>1:(N-1)</code> if and only if <code>all.inside = TRUE</code> (equivalently coercing all
x values <em>inside</em> the intervals).  Note that <code><a href="#topic+NA">NA</a></code>s are
propagated from <code>x</code>, and <code><a href="#topic+Inf">Inf</a></code> values are allowed in
both <code>x</code> and <code>vec</code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+approx">approx</a>(*, method = "constant")</code> which is a
generalization of <code>findInterval()</code>, <code><a href="stats.html#topic+ecdf">ecdf</a></code> for
computing the empirical distribution function which is (up to a factor
of <code class="reqn">n</code>) also basically the same as <code>findInterval(.)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 2:18
v &lt;- c(5, 10, 15) # create two bins [5,10) and [10,15)
cbind(x, findInterval(x, v))

N &lt;- 100
X &lt;- sort(round(stats::rt(N, df = 2), 2))
tt &lt;- c(-100, seq(-2, 2, length.out = 201), +100)
it &lt;- findInterval(tt, X)
tt[it &lt; 1 | it &gt;= N] # only first and last are outside range(X)

##  'left.open = TRUE' means  "mirroring" :
N &lt;- length(v)
stopifnot(identical(
                  findInterval( x,  v,  left.open=TRUE) ,
              N - findInterval(-x, -v[N:1])))
</code></pre>

<hr>
<h2 id='force'>Force Evaluation of an Argument</h2><span id='topic+force'></span>

<h3>Description</h3>

<p>Forces the evaluation of a function argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>force(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="force_+3A_x">x</code></td>
<td>
<p>a formal argument of the enclosing function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>force</code> forces the evaluation of a formal argument.  This can
be useful if the argument will be captured in a closure by the lexical
scoping rules and will later be altered by an explicit assignment or
an implicit assignment in a loop or an apply function.
</p>


<h3>Note</h3>

<p>This is semantic sugar: just evaluating the symbol will do the
same thing (see the examples).
</p>
<p><code>force</code> does not force the evaluation of other
<a href="#topic+promises">promises</a>.  (It works by forcing the promise that
is created when the actual arguments of a call are matched to the
formal arguments of a closure, the mechanism which implements
<em>lazy evaluation</em>.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(y) function() y
lf &lt;- vector("list", 5)
for (i in seq_along(lf)) lf[[i]] &lt;- f(i)
lf[[1]]()  # returns 5

g &lt;- function(y) { force(y); function() y }
lg &lt;- vector("list", 5)
for (i in seq_along(lg)) lg[[i]] &lt;- g(i)
lg[[1]]()  # returns 1

## This is identical to
g &lt;- function(y) { y; function() y }
</code></pre>

<hr>
<h2 id='forceAndCall'>Call a function with Some Arguments Forced</h2><span id='topic+forceAndCall'></span>

<h3>Description</h3>

<p>Call a function with a specified number of leading arguments forced
before the call if the function is a closure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forceAndCall(n, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forceAndCall_+3A_n">n</code></td>
<td>
<p>number of leading arguments to force.</p>
</td></tr>
<tr><td><code id="forceAndCall_+3A_fun">FUN</code></td>
<td>
<p>function to call.</p>
</td></tr>
<tr><td><code id="forceAndCall_+3A_...">...</code></td>
<td>
<p>arguments to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>forceAndCall</code> calls the function <code>FUN</code> with arguments
specified in <code>...</code>.  If the value of <code>FUN</code> is a closure
then the first <code>n</code> arguments to the function are evaluated
(i.e. their delayed evaluation promises are forced) before executing
the function body.  If the value of <code>FUN</code> is a primitive then
the call <code>FUN(...)</code> is evaluated in the usual way.
</p>
<p><code>forceAndCall</code> is intended to help defining higher order
functions like <code><a href="#topic+apply">apply</a></code> to behave more reasonably when the
result returned by the function applied is a closure that captured its
arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+force">force</a></code>, <code><a href="#topic+promise">promise</a></code>, <code><a href="#topic+closure">closure</a></code>.
</p>

<hr>
<h2 id='Foreign'>Foreign Function Interface</h2><span id='topic+Foreign'></span><span id='topic+.C'></span><span id='topic+.Fortran'></span>

<h3>Description</h3>

<p>Functions to make calls to compiled code that has been loaded into <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>       .C(.NAME, ..., NAOK = FALSE, DUP = TRUE, PACKAGE, ENCODING)
 .Fortran(.NAME, ..., NAOK = FALSE, DUP = TRUE, PACKAGE, ENCODING)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Foreign_+3A_.name">.NAME</code></td>
<td>
<p>a character string giving the name of a C function or
Fortran subroutine, or an object of class
<code>"<a href="#topic+NativeSymbolInfo">NativeSymbolInfo</a>"</code>, <code>"<a href="#topic+RegisteredNativeSymbol">RegisteredNativeSymbol</a>"</code>
or <code>"<a href="#topic+NativeSymbol">NativeSymbol</a>"</code> referring to such a name.</p>
</td></tr>
<tr><td><code id="Foreign_+3A_...">...</code></td>
<td>
<p>arguments to be passed to the foreign function.  Up to 65.</p>
</td></tr>
<tr><td><code id="Foreign_+3A_naok">NAOK</code></td>
<td>
<p>if <code>TRUE</code> then any <code><a href="#topic+NA">NA</a></code> or
<code><a href="#topic+NaN">NaN</a></code> or <code><a href="#topic+Inf">Inf</a></code> values in the arguments are
passed on to the foreign function.  If <code>FALSE</code>, the presence of
<code>NA</code> or <code>NaN</code> or <code>Inf</code> values is regarded as an error.</p>
</td></tr>
<tr><td><code id="Foreign_+3A_package">PACKAGE</code></td>
<td>
<p>if supplied, confine the search for a character string
<code>.NAME</code> to the DLL given by this argument (plus the
conventional extension, &lsquo;<span class="file">.so</span>&rsquo;, &lsquo;<span class="file">.dll</span>&rsquo;, ...).
</p>
<p>This is intended to add safety for packages, which can ensure by
using this argument that no other package can override their external
symbols, and also speeds up the search (see &lsquo;Note&rsquo;).</p>
</td></tr>
<tr><td><code id="Foreign_+3A_dup">DUP</code>, <code id="Foreign_+3A_encoding">ENCODING</code></td>
<td>
<p>For back-compatibility, accepted but ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions can be used to make calls to compiled C and Fortran
code.  Later interfaces are <code><a href="#topic+.Call">.Call</a></code> and
<code><a href="#topic+.External">.External</a></code> which are more flexible and have better
performance.
</p>
<p>These functions are <a href="#topic+primitive">primitive</a>, and <code>.NAME</code> is always
matched to the first argument supplied (which should not be named).
The other named arguments follow <code>...</code> and so cannot be
abbreviated.  For clarity, should avoid using names in the arguments
passed to <code>...</code> that match or partially match <code>.NAME</code>.
</p>


<h3>Value</h3>

<p>A list similar to the <code>...</code> list of arguments passed in
(including any names given to the arguments), but reflecting any
changes made by the C or Fortran code.
</p>


<h3>Argument types</h3>

<p>The mapping of the types of <span class="rlang"><b>R</b></span> arguments to C or Fortran arguments is
</p>

<table>
<tr>
 <td style="text-align: left;">
    <span class="rlang"><b>R</b></span>              </td><td style="text-align: left;"> C                     </td><td style="text-align: left;"> Fortran</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>integer</code>  </td><td style="text-align: left;"> <code>int *</code>          </td><td style="text-align: left;"> <code>integer</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>numeric</code>  </td><td style="text-align: left;"> <code>double *</code>       </td><td style="text-align: left;"> <code>double precision</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    -- or --        </td><td style="text-align: left;"> <code>float *</code>        </td><td style="text-align: left;"> <code>real</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>complex</code>  </td><td style="text-align: left;"> <code>Rcomplex *</code>     </td><td style="text-align: left;"> <code>double complex</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>logical</code>  </td><td style="text-align: left;"> <code>int *</code>          </td><td style="text-align: left;"> <code>integer</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>character</code></td><td style="text-align: left;"> <code>char **</code>        </td><td style="text-align: left;"> [see below]</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>raw</code>      </td><td style="text-align: left;"> <code>unsigned char *</code></td><td style="text-align: left;"> not allowed</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>list</code>     </td><td style="text-align: left;"> <code>SEXP *</code>         </td><td style="text-align: left;"> not allowed</td>
</tr>
<tr>
 <td style="text-align: left;">
    other           </td><td style="text-align: left;"> <code>SEXP</code>           </td><td style="text-align: left;"> not allowed</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p><em>Note:</em> The C types corresponding to <code>integer</code> and
<code>logical</code> are <code>int</code>, not <code>long</code> as in S.  This
difference matters on most 64-bit platforms, where <code>int</code> is
32-bit and <code>long</code> is 64-bit (but not on 64-bit Windows).
</p>
<p><em>Note:</em> The Fortran type corresponding to <code>logical</code> is
<code>integer</code>, not <code>logical</code>: the difference matters on some
Fortran compilers.

</p>
<p>Numeric vectors in <span class="rlang"><b>R</b></span> will be passed as type <code>double *</code> to C
(and as <code>double precision</code> to Fortran) unless the argument has
attribute <code>Csingle</code> set to <code>TRUE</code> (use
<code><a href="#topic+as.single">as.single</a></code> or <code><a href="#topic+single">single</a></code>).  This mechanism is
only intended to be used to facilitate the interfacing of existing C
and Fortran code.
</p>
<p>The C type <code>Rcomplex</code> is defined in &lsquo;<span class="file">Complex.h</span>&rsquo; as a
<code>typedef struct {double r; double i;}</code>.  It may or may not be
equivalent to the C99 <code>double complex</code> type, depending on the
compiler used.
</p>
<p>Logical values are sent as <code>0</code> (<code>FALSE</code>), <code>1</code>
(<code>TRUE</code>) or <code>INT_MIN = -2147483648</code> (<code>NA</code>, but only if
<code>NAOK = TRUE</code>), and the compiled code should return one of these
three values: however non-zero values other than <code>INT_MIN</code> are
mapped to <code>TRUE</code>.
</p>
<p>Missing (<code>NA</code>) string values are passed to <code>.C</code> as the string
&quot;NA&quot;. As the C <code>char</code> type can represent all possible bit patterns
there appears to be no way to distinguish missing strings from the
string <code>"NA"</code>.  If this distinction is important use <code><a href="#topic+.Call">.Call</a></code>.
</p>
<p>Using a character string with <code>.Fortran</code> is deprecated and will
give a warning.  It passes the first (only) character string of a
character vector as a C character array to Fortran: that may be usable
as <code>character*255</code> if its true length is passed separately.  Only
up to 255 characters of the string are passed back.  (How well this
works, and even if it works at all, depends on the C and Fortran
compilers and the platform.)
</p>
<p>Lists, functions or other <span class="rlang"><b>R</b></span> objects can (for historical reasons) be
passed to <code>.C</code>, but the <code><a href="#topic+.Call">.Call</a></code> interface is much
preferred.  All inputs apart from atomic vectors should be regarded as
read-only, and all apart from vectors (including lists), functions and
environments are now deprecated.
</p>


<h3>Fortran symbol names</h3>

<p>All Fortran compilers known to be usable to compile <span class="rlang"><b>R</b></span> map symbol names
to lower case, and so does <code>.Fortran</code>.
</p>
<p>Symbol names containing underscores are not valid Fortran 77 (although
they are valid in Fortran 9x).  Many Fortran 77 compilers will allow
them but may translate them in a different way to names not containing
underscores.  Such names will often work with <code>.Fortran</code> (since
how they are translated is detected when <span class="rlang"><b>R</b></span> is built and the
information used by <code>.Fortran</code>), but portable code should not use
Fortran names containing underscores.
</p>
<p>Use <code>.Fortran</code> with care for compiled Fortran 9x code: it may not
work if the Fortran 9x compiler used differs from the Fortran compiler
used when configuring <span class="rlang"><b>R</b></span>, especially if the subroutine name is not
lower-case or includes an underscore.  The most portable way to call
Fortran 9x code from <span class="rlang"><b>R</b></span> is to use <code>.C</code> and the Fortran 2003
module <code>iso_c_binding</code> to provide a C interface to the Fortran
code.
</p>


<h3>Copying of arguments</h3>

<p>Character vectors are copied before calling the compiled code and to
collect the results.  For other atomic vectors the argument is copied
before calling the compiled code if it is otherwise used in the
calling code.
</p>
<p>Non-atomic-vector objects are read-only to the C code and are never
copied.
</p>
<p>This behaviour can be changed by setting
<code><a href="#topic+options">options</a>(CBoundsCheck = TRUE)</code>.  In that case raw,
logical, integer, double and complex vector arguments are copied both
before and after calling the compiled code.  The first copy made is
extended at each end by guard bytes, and on return it is checked that
these are unaltered.  For <code>.C</code>, each element of a character
vector uses guard bytes.
</p>


<h3>Note</h3>

<p>If one of these functions is to be used frequently, do specify
<code>PACKAGE</code> (to confine the search to a single DLL) or pass
<code>.NAME</code> as one of the native symbol objects.  Searching for
symbols can take a long time, especially when many namespaces are loaded.
</p>
<p>You may see <code>PACKAGE = "base"</code> for symbols linked into <span class="rlang"><b>R</b></span>.  Do
not use this in your own code: such symbols are not part of the API
and may be changed without warning.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dyn.load">dyn.load</a></code>, <code><a href="#topic+.Call">.Call</a></code>.
</p>
<p>The &lsquo;Writing R Extensions&rsquo; manual.
</p>

<hr>
<h2 id='Foreign-internal'>Internal Versions of the Foreign Function Interface</h2><span id='topic+.External.graphics'></span><span id='topic+.External2'></span><span id='topic+.Call.graphics'></span>

<h3>Description</h3>

<p>Internal versions of <code><a href="#topic+.Call">.Call</a></code> and <code><a href="#topic+.External">.External</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    .Call.graphics(.NAME, ..., PACKAGE)
.External.graphics(.NAME, ..., PACKAGE)
        .External2(.NAME, ..., PACKAGE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Foreign-internal_+3A_.name">.NAME</code></td>
<td>
<p>a character string giving the name of a C function or
Fortran subroutine, or an object of class
<code>"<a href="#topic+NativeSymbolInfo">NativeSymbolInfo</a>"</code>, <code>"<a href="#topic+RegisteredNativeSymbol">RegisteredNativeSymbol</a>"</code>
or <code>"<a href="#topic+NativeSymbol">NativeSymbol</a>"</code> referring to such a name.</p>
</td></tr>
<tr><td><code id="Foreign-internal_+3A_...">...</code></td>
<td>
<p>arguments to be passed to the foreign function.</p>
</td></tr>
<tr><td><code id="Foreign-internal_+3A_package">PACKAGE</code></td>
<td>
<p>see the corresponding argument of <code><a href="#topic+.Call">.Call</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>.graphics</code> versions of <code>.Call</code> and <code>.External</code>
are used when calling code which makes low-level graphics calls.
They take additional steps to ensure that the device driver display
lists are updated correctly.
</p>
<p><code>.External2</code> is an enhanced version of <code>.External</code> which
passes additional information in more arguments.
</p>
<p><code>.Call.graphics</code> is used in package <span class="pkg">grid</span> and
<code>.External.graphics</code> and <code>.External2</code> are used in package
<code>graphics</code>.
</p>
<p>These are primitive functions.
</p>


<h3>Value</h3>

<p>An <span class="rlang"><b>R</b></span> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.Call">.Call</a></code>.</p>

<hr>
<h2 id='formals'>Access to and Manipulation of the Formal Arguments</h2><span id='topic+formals'></span><span id='topic+formals+3C-'></span>

<h3>Description</h3>

<p>Get or set the formal arguments of a <code><a href="#topic+function">function</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formals(fun = sys.function(sys.parent()), envir = parent.frame())
formals(fun, envir = environment(fun)) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formals_+3A_fun">fun</code></td>
<td>
<p>a <code><a href="#topic+function">function</a></code>, or see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="formals_+3A_envir">envir</code></td>
<td>
<p><code><a href="#topic+environment">environment</a></code> in which the function should be
defined (or found via <code><a href="#topic+get">get</a>()</code> in the first case and when
<code>fun</code> a character string).</p>
</td></tr>
<tr><td><code id="formals_+3A_value">value</code></td>
<td>
<p>a <code><a href="#topic+list">list</a></code> (or <code><a href="#topic+pairlist">pairlist</a></code>, hence possibly
<code><a href="#topic+NULL">NULL</a></code>) of <span class="rlang"><b>R</b></span> expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the first form, <code>fun</code> can also be a character string naming
the function to be manipulated, which is searched for in <code>envir</code>,
by default from the parent
frame.  If it is not specified, the function calling <code>formals</code> is
used.
</p>
<p>Only <em>closures</em>, i.e., non-primitive functions, have formals, not
primitive functions.
<br />
Note that <code>formals(args(f))</code> gives a formal argument list for
all functions <code>f</code>, primitive or not.
</p>


<h3>Value</h3>

<p><code>formals</code> returns the formal argument list of the function
specified, as a <code><a href="#topic+pairlist">pairlist</a></code>, or <code>NULL</code> for a
non-function or primitive.
</p>
<p>The replacement form sets the formals of a function to the
list/pairlist on the right hand side, and (potentially) resets the
environment of the function, dropping <code><a href="#topic+attributes">attributes</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="methods.html#topic+formalArgs">formalArgs</a></code> (from <span class="pkg">methods</span>), a shortcut for <code>names(formals(.))</code>.
<code><a href="#topic+args">args</a></code> for a human-readable version, <em>and</em> as
intermediary to get formals of a primitive function.
<br />
<code><a href="#topic+alist">alist</a></code> to <em>construct</em> a typical formals <code>value</code>,
see the examples.
</p>
<p>The three parts of a (non-primitive) <code><a href="#topic+function">function</a></code> are its
<code>formals</code>, <code><a href="#topic+body">body</a></code>, and <code><a href="#topic+environment">environment</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
formals(lm)

## If you just want the names of the arguments, use formalArgs instead.
names(formals(lm))
methods:: formalArgs(lm)     # same

## formals returns a pairlist. Arguments with no default have type symbol (aka name).
str(formals(lm))

## formals returns NULL for primitive functions.  Use it in combination with
## args for this case.
is.primitive(`+`)
formals(`+`)
formals(args(`+`))

## You can overwrite the formal arguments of a function (though this is
## advanced, dangerous coding).
f &lt;- function(x) a + b
formals(f) &lt;- alist(a = , b = 3)
f    # function(a, b = 3) a + b
f(2) # result = 5
</code></pre>

<hr>
<h2 id='format'>Encode in a Common Format</h2><span id='topic+format'></span><span id='topic+format.AsIs'></span><span id='topic+format.data.frame'></span><span id='topic+format.default'></span><span id='topic+format.factor'></span>

<h3>Description</h3>

<p>Format an <span class="rlang"><b>R</b></span> object for pretty printing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format(x, ...)

## Default S3 method:
format(x, trim = FALSE, digits = NULL, nsmall = 0L,
       justify = c("left", "right", "centre", "none"),
       width = NULL, na.encode = TRUE, scientific = NA,
       big.mark   = "",   big.interval = 3L,
       small.mark = "", small.interval = 5L,
       decimal.mark = getOption("OutDec"),
       zero.print = NULL, drop0trailing = FALSE, ...)

## S3 method for class 'data.frame'
format(x, ..., justify = "none")

## S3 method for class 'factor'
format(x, ...)

## S3 method for class 'AsIs'
format(x, width = 12, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object (conceptually); typically numeric.</p>
</td></tr>
<tr><td><code id="format_+3A_trim">trim</code></td>
<td>
<p>logical; if <code>FALSE</code>, logical, numeric and complex
values are right-justified to a common width: if <code>TRUE</code> the
leading blanks for justification are suppressed.</p>
</td></tr>
<tr><td><code id="format_+3A_digits">digits</code></td>
<td>
<p>a positive integer indicating how many significant digits
are to be used for
numeric and complex <code>x</code>.  The default, <code>NULL</code>, uses
<code><a href="#topic+getOption">getOption</a>("digits")</code>.  This is a suggestion: enough decimal
places will be used so that the smallest (in magnitude) number has
this many significant digits, and also to satisfy <code>nsmall</code>.
(For more, notably the interpretation for complex numbers see
<code><a href="#topic+signif">signif</a></code>.)</p>
</td></tr>
<tr><td><code id="format_+3A_nsmall">nsmall</code></td>
<td>
<p>the minimum number of digits to the right of the decimal
point in formatting real/complex numbers in non-scientific formats.
Allowed values are <code>0 &lt;= nsmall &lt;= 20</code>.</p>
</td></tr>
<tr><td><code id="format_+3A_justify">justify</code></td>
<td>
<p>should a <em>character</em> vector be left-justified (the
default), right-justified, centred or left alone.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="format_+3A_width">width</code></td>
<td>
<p><code>default</code> method: the <em>minimum</em> field width or
<code>NULL</code> or <code>0</code> for no restriction.
</p>
<p><code>AsIs</code> method: the <em>maximum</em> field width for non-character
objects.  <code>NULL</code> corresponds to the default <code>12</code>.
</p>
</td></tr>
<tr><td><code id="format_+3A_na.encode">na.encode</code></td>
<td>
<p>logical: should <code>NA</code> strings be encoded?  Note
this only applies to elements of character vectors, not to numerical,
complex nor logical <code>NA</code>s, which are always encoded as <code>"NA"</code>.</p>
</td></tr>

<tr><td><code id="format_+3A_scientific">scientific</code></td>
<td>
<p>either a logical specifying whether
elements of a real or complex vector should be encoded in scientific
format, or an integer penalty (see <code><a href="#topic+options">options</a>("scipen")</code>).
Missing values correspond to the current default penalty.</p>
</td></tr>
<tr><td><code id="format_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="format_+3A_big.mark">big.mark</code>, <code id="format_+3A_big.interval">big.interval</code>, <code id="format_+3A_small.mark">small.mark</code>, <code id="format_+3A_small.interval">small.interval</code>, <code id="format_+3A_decimal.mark">decimal.mark</code>, <code id="format_+3A_zero.print">zero.print</code>, <code id="format_+3A_drop0trailing">drop0trailing</code></td>
<td>

<p>used for prettying (longish) numerical and complex sequences.
Passed to <code><a href="#topic+prettyNum">prettyNum</a></code>: that help page explains the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>format</code> is a generic function.  Apart from the methods described
here there are methods for dates (see <code><a href="#topic+format.Date">format.Date</a></code>),
date-times (see <code><a href="#topic+format.POSIXct">format.POSIXct</a></code>) and for other classes such
as <code>format.octmode</code> and <code>format.dist</code>.
</p>
<p><code>format.data.frame</code> formats the data frame column by column,
applying the appropriate method of <code>format</code> for each column.
Methods for columns are often similar to <code>as.character</code> but offer
more control.  Matrix and data-frame columns will be converted to
separate columns in the result, and character columns (normally all)
will be given class <code>"<a href="#topic+AsIs">AsIs</a>"</code>.
</p>
<p><code>format.factor</code> converts the factor to a character vector and
then calls the default method (and so <code>justify</code> applies).
</p>
<p><code>format.AsIs</code> deals with columns of complicated objects that
have been extracted from a data frame.  Character objects and (atomic)
matrices are passed to the default method (and so <code>width</code> does
not apply).
Otherwise it calls <code><a href="#topic+toString">toString</a></code> to convert the object
to character (if a vector or list, element by element) and then
right-justifies the result.
</p>
<p>Justification for character vectors (and objects converted to
character vectors by their methods) is done on display width (see
<code><a href="#topic+nchar">nchar</a></code>), taking double-width characters and the rendering
of special characters (as escape sequences, including escaping
backslash but not double quote: see <code><a href="#topic+print.default">print.default</a></code>) into
account.  Thus the width is as displayed by <code>print(quote =
  FALSE)</code> and not as displayed by <code><a href="#topic+cat">cat</a></code>.  Character strings
are padded with blanks to the display width of the widest.  (If
<code>na.encode = FALSE</code> missing character strings are not included in
the width computations and are not encoded.)
</p>
<p>Numeric vectors are encoded with the minimum number of decimal places
needed to display all the elements to at least the <code>digits</code>
significant digits.  However, if all the elements then have trailing
zeroes, the number of decimal places is reduced until at least one
element has a non-zero final digit; see also the argument
documentation for <code>big.*</code>, <code>small.*</code> etc, above.  See the
note in <code><a href="#topic+print.default">print.default</a></code> about <code>digits &gt;= 16</code>.
</p>
<p>Raw vectors are converted to their 2-digit hexadecimal representation
by <code><a href="#topic+as.character">as.character</a></code>.
</p>
<p><code>format.default(x)</code> now provides a &ldquo;minimal&rdquo; string when
<code><a href="#topic+isS4">isS4</a>(x)</code> is true.
</p>
<p>While the internal code respects the option
<code><a href="#topic+getOption">getOption</a>("OutDec")</code> for the &lsquo;decimal mark&rsquo; in general,
<code>decimal.mark</code> takes precedence over that option.  Similarly,
<code>scientific</code> takes precedence over <code><a href="#topic+getOption">getOption</a>("scipen")</code>.
</p>


<h3>Value</h3>

<p>An object of similar structure to <code>x</code> containing character
representations of the elements of the first argument <code>x</code>
in a common format, and in the current locale's encoding.
</p>
<p>For character, numeric, complex or factor <code>x</code>, dims and dimnames
are preserved on matrices/arrays and names on vectors: no other
attributes are copied.
</p>
<p>If <code>x</code> is a list, the result is a character vector obtained by
applying <code>format.default(x, ...)</code> to each element of the list
(after <code><a href="#topic+unlist">unlist</a></code>ing elements which are themselves lists),
and then collapsing the result for each element with
<code>paste(collapse = ", ")</code>.  The defaults in this case are
<code>trim = TRUE, justify = "none"</code> since one does not usually want
alignment in the collapsed strings.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+format.info">format.info</a></code> indicates how an atomic vector would be
formatted.
</p>
<p><code><a href="#topic+formatC">formatC</a></code>, <code><a href="#topic+paste">paste</a></code>, <code><a href="#topic+as.character">as.character</a></code>,
<code><a href="#topic+sprintf">sprintf</a></code>, <code><a href="#topic+print">print</a></code>, <code><a href="#topic+prettyNum">prettyNum</a></code>,
<code><a href="#topic+toString">toString</a></code>, <code><a href="#topic+encodeString">encodeString</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format(1:10)
format(1:10, trim = TRUE)

zz &lt;- data.frame("(row names)"= c("aaaaa", "b"), check.names = FALSE)
format(zz)
format(zz, justify = "left")

## use of nsmall
format(13.7)
format(13.7, nsmall = 3)
format(c(6.0, 13.1), digits = 2)
format(c(6.0, 13.1), digits = 2, nsmall = 1)

## use of scientific
format(2^31-1)
format(2^31-1, scientific = TRUE)
## scientific = numeric scipen (= {sci}entific notation {pen}alty) :
x &lt;- c(1e5, 1000, 10, 0.1, .001, .123)
t(sapply(setNames(,-4:1),
         \(sci) sapply(x, format, scientific=sci)))


## a list
z &lt;- list(a = letters[1:3], b = (-pi+0i)^((-2:2)/2), c = c(1,10,100,1000),
          d = c("a", "longer", "character", "string"),
          q = quote( a + b ), e = expression(1+x))
## can you find the "2" small differences?
(f1 &lt;- format(z, digits = 2))
(f2 &lt;- format(z, digits = 2, justify = "left", trim = FALSE))
f1 == f2 ## 2 FALSE, 4 TRUE

## A "minimal" format() for S4 objects without their own format() method:
cc &lt;- methods::getClassDef("standardGeneric")
format(cc) ## "&lt;S4 class ......&gt;"
</code></pre>

<hr>
<h2 id='format.info'>format(.) Information</h2><span id='topic+format.info'></span>

<h3>Description</h3>

<p>Information is returned on how <code><a href="#topic+format">format</a>(x, digits, nsmall)</code>
would be formatted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format.info(x, digits = NULL, nsmall = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format.info_+3A_x">x</code></td>
<td>
<p>an atomic vector; a potential argument of
<code><a href="#topic+format">format</a>(x, ...)</code>.</p>
</td></tr>
<tr><td><code id="format.info_+3A_digits">digits</code></td>
<td>
<p>how many significant digits are to be used for
numeric and complex <code>x</code>.  The default, <code>NULL</code>, uses
<code><a href="#topic+getOption">getOption</a>("digits")</code>.</p>
</td></tr>
<tr><td><code id="format.info_+3A_nsmall">nsmall</code></td>
<td>
<p> (see <code><a href="#topic+format">format</a>(..., nsmall)</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+integer">integer</a></code> <code><a href="#topic+vector">vector</a></code> of length 1, 3 or 6, say
<code>r</code>.
</p>
<p>For logical, integer and character vectors a single element,
the width which would be used by <code>format</code> if <code>width = NULL</code>.
</p>
<p>For numeric vectors:
</p>
<table>
<tr><td><code>r[1]</code></td>
<td>
<p>width (in characters) used by <code>format(x)</code></p>
</td></tr>
<tr><td><code>r[2]</code></td>
<td>
<p>number of digits after decimal point.</p>
</td></tr>
<tr><td><code>r[3]</code></td>
<td>
<p>in <code>0:2</code>; if <code class="reqn">\ge</code><code>1</code>, <em>exponential</em>
representation would be used, with exponent length of <code>r[3]+1</code>.</p>
</td></tr>
</table>
<p>For a complex vector the first three elements refer to the real parts,
and there are three further elements corresponding to the imaginary
parts.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+format">format</a></code> (notably about <code>digits &gt;= 16</code>),
<code><a href="#topic+formatC">formatC</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dd &lt;- options("digits") ; options(digits = 7) #-- for the following
format.info(123)   # 3 0 0
format.info(pi)    # 8 6 0
format.info(1e8)   # 5 0 1 - exponential "1e+08"
format.info(1e222) # 6 0 2 - exponential "1e+222"

x &lt;- pi*10^c(-10,-2,0:2,8,20)
names(x) &lt;- formatC(x, width = 1, digits = 3, format = "g")
cbind(sapply(x, format))
t(sapply(x, format.info))

## using at least 8 digits right of "."
t(sapply(x, format.info, nsmall = 8))

# Reset old options:
options(dd)
</code></pre>

<hr>
<h2 id='format.pval'>Format P Values</h2><span id='topic+format.pval'></span>

<h3>Description</h3>

<p><code>format.pval</code> is intended for formatting p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format.pval(pv, digits = max(1, getOption("digits") - 2),
            eps = .Machine$double.eps, na.form = "NA", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format.pval_+3A_pv">pv</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="format.pval_+3A_digits">digits</code></td>
<td>
<p>how many significant digits are to be used.</p>
</td></tr>
<tr><td><code id="format.pval_+3A_eps">eps</code></td>
<td>
<p>a numerical tolerance: see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="format.pval_+3A_na.form">na.form</code></td>
<td>
<p>character representation of <code>NA</code>s.</p>
</td></tr>
<tr><td><code id="format.pval_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="#topic+format">format</a></code>
such as <code>nsmall</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>format.pval</code> is mainly an auxiliary function for
<code><a href="stats.html#topic+print.summary.lm">print.summary.lm</a></code> etc., and does separate formatting for
fixed, floating point and very small values; those less than
<code>eps</code> are formatted as <code>"&lt; [eps]"</code> (where &lsquo;[eps]&rsquo;
stands for <code>format(eps, digits)</code>).
</p>


<h3>Value</h3>

<p>A character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format.pval(c(stats::runif(5), pi^-100, NA))
format.pval(c(0.1, 0.0001, 1e-27))
</code></pre>

<hr>
<h2 id='formatC'>Formatting Using C-style Formats</h2><span id='topic+formatC'></span><span id='topic+prettyNum'></span><span id='topic+.format.zeros'></span>

<h3>Description</h3>

<p><code>formatC()</code> formats numbers individually and flexibly using
<code>C</code> style format specifications.
</p>
<p><code>prettyNum()</code> is used for &ldquo;prettifying&rdquo; (possibly
formatted) numbers, also in <code><a href="#topic+format.default">format.default</a></code>.
</p>
<p><code>.format.zeros(x)</code>, an auxiliary function of <code>prettyNum()</code>,
re-formats the zeros in a vector <code>x</code> of formatted numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatC(x, digits = NULL, width = NULL,
        format = NULL, flag = "", mode = NULL,
        big.mark = "", big.interval = 3L,
        small.mark = "", small.interval = 5L,
        decimal.mark = getOption("OutDec"),
        preserve.width = "individual",
        zero.print = NULL, replace.zero = TRUE,
        drop0trailing = FALSE)

prettyNum(x, big.mark = "",   big.interval = 3L,
          small.mark  = "", small.interval = 5L,
          decimal.mark = getOption("OutDec"), input.d.mark = decimal.mark,
          preserve.width = c("common", "individual", "none"),
          zero.print = NULL, replace.zero = FALSE,
          drop0trailing = FALSE, is.cmplx = NA,
          ...)

.format.zeros(x, zero.print, nx = suppressWarnings(as.numeric(x)),
              replace = FALSE, warn.non.fitting = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatC_+3A_x">x</code></td>
<td>
<p>an atomic numerical or character object, possibly
<code><a href="#topic+complex">complex</a></code> only for <code>prettyNum()</code>, typically a
vector of real numbers.  Any class is discarded, with a warning.</p>
</td></tr>
<tr><td><code id="formatC_+3A_digits">digits</code></td>
<td>
<p>the desired number of digits after the decimal
point (<code>format = "f"</code>) or <em>significant</em> digits
(<code>format = "g"</code>, <code>= "e"</code> or <code>= "fg"</code>).
</p>
<p>Default: 2 for integer, 4 for real numbers.  If less than 0,
the C default of 6 digits is used.  If specified as more than 50, 50
will be used with a warning unless <code>format = "f"</code> where it is
limited to typically 324. (Not more than 15&ndash;21 digits need be
accurate, depending on the OS and compiler used.  This limit is
just a precaution against segfaults in the underlying C runtime.)
</p>
</td></tr>
<tr><td><code id="formatC_+3A_width">width</code></td>
<td>
<p>the total field width; if both <code>digits</code> and
<code>width</code> are unspecified, <code>width</code> defaults to 1,
otherwise to <code>digits + 1</code>.  <code>width = 0</code> will use
<code>width = digits</code>, <code>width &lt; 0</code> means left
justify the number in this field (equivalent to <code>flag = "-"</code>).
If necessary, the result will have more characters than
<code>width</code>.  For character data this is interpreted in characters
(not bytes nor display width).
</p>
</td></tr>
<tr><td><code id="formatC_+3A_format">format</code></td>
<td>
<p>equal to <code>"d"</code>  (for integers), <code>"f"</code>,
<code>"e"</code>, <code>"E"</code>, <code>"g"</code>, <code>"G"</code>, <code>"fg"</code> (for
reals), or <code>"s"</code> (for strings).  Default is <code>"d"</code> for
integers, <code>"g"</code> for reals.
</p>
<p><code>"f"</code> gives numbers in the usual
<code>xxx.xxx</code> format;  <code>"e"</code> and <code>"E"</code> give <code>n.ddde+nn</code> or
<code>n.dddE+nn</code> (scientific format); <code>"g"</code> and <code>"G"</code> put
<code>x[i]</code> into scientific format only if it saves space to do so
<em>and</em> drop trailing zeros and decimal point - unless <code>flag</code>
contains <code>"#"</code> which keeps trailing zeros for the <code>"g", "G"</code>
formats.
</p>
<p><code>"fg"</code> (our own hybrid format) uses fixed format as <code>"f"</code>,
but <code>digits</code> as the minimum number of <em>significant</em> digits.
This can lead to quite long result strings, see examples below.  Note
that unlike <code><a href="#topic+signif">signif</a></code> this prints large numbers with
more significant digits than <code>digits</code>.  Trailing zeros are
<em>dropped</em> in this format, unless <code>flag</code> contains
<code>"#"</code>.</p>
</td></tr>
<tr><td><code id="formatC_+3A_flag">flag</code></td>
<td>
<p>for <code>formatC</code>, a character string giving a
format modifier as in
Kernighan and Ritchie (1988, page 243) 
or the C+99 standard.</p>

<dl>
<dt><code>"0"</code></dt><dd><p>pads leading zeros;</p>
</dd>
<dt><code>"-"</code></dt><dd><p>does left adjustment,</p>
</dd>
<dt><code>"+"</code></dt><dd><p>ensures a sign in all cases, i.e., <code>"+"</code> for
positive numbers ,</p>
</dd>
<dt><code>" "</code></dt><dd><p>if the first character is not a sign, the space
character <code>" "</code> will be used instead.</p>
</dd>
<dt><code>"#"</code></dt><dd><p>specifies &ldquo;an alternative output form&rdquo;,
specifically depending on <code>format</code>.</p>
</dd>
<dt><code>"'"</code></dt><dd><p>on some platform&ndash;locale combination, activates
&ldquo;thousands' grouping&rdquo; for decimal conversion,</p>
</dd>
<dt><code>"I"</code></dt><dd><p>in some versions of &lsquo;<span class="file">glibc</span>&rsquo; allow for integer
conversion to use the locale's alternative output digits, if any.</p>
</dd>
</dl>

<p>There can be more than one of these flags, in any order.  Other characters
used to have no effect for <code>character</code> formatting, but signal
an error since <span class="rlang"><b>R</b></span> 3.4.0.
</p>
</td></tr>
<tr><td><code id="formatC_+3A_mode">mode</code></td>
<td>
<p><code>"double"</code> (or <code>"real"</code>), <code>"integer"</code> or
<code>"character"</code>.
Default: Determined from the storage mode of <code>x</code>.</p>
</td></tr>
<tr><td><code id="formatC_+3A_big.mark">big.mark</code></td>
<td>
<p>character; if not empty used as mark between every
<code>big.interval</code> decimals <em>before</em> (hence <code>big</code>) the
decimal point.</p>
</td></tr>
<tr><td><code id="formatC_+3A_big.interval">big.interval</code></td>
<td>
<p>see <code>big.mark</code> above; defaults to 3.</p>
</td></tr>
<tr><td><code id="formatC_+3A_small.mark">small.mark</code></td>
<td>
<p>character; if not empty used as mark between every
<code>small.interval</code> decimals <em>after</em> (hence <code>small</code>) the
decimal point.</p>
</td></tr>
<tr><td><code id="formatC_+3A_small.interval">small.interval</code></td>
<td>
<p>see <code>small.mark</code> above; defaults to 5.</p>
</td></tr>
<tr><td><code id="formatC_+3A_decimal.mark">decimal.mark</code></td>
<td>
<p>the character to be used to indicate the numeric
decimal point.</p>
</td></tr>
<tr><td><code id="formatC_+3A_input.d.mark">input.d.mark</code></td>
<td>
<p>if <code>x</code> is <code><a href="#topic+character">character</a></code>, the
character known to have been used as the numeric decimal point in
<code>x</code>.</p>
</td></tr>
<tr><td><code id="formatC_+3A_preserve.width">preserve.width</code></td>
<td>
<p>string specifying if the string widths should
be preserved where possible in those cases where marks
(<code>big.mark</code> or <code>small.mark</code>) are added.  <code>"common"</code>,
the default, corresponds to <code><a href="#topic+format">format</a></code>-like behavior
whereas <code>"individual"</code> is the default in
<code>formatC()</code>. Value can be abbreviated.</p>
</td></tr>
<tr><td><code id="formatC_+3A_zero.print">zero.print</code></td>
<td>
<p>logical, character string or <code>NULL</code> specifying
if and how <em>zeros</em> should be formatted specially.  Useful for
pretty printing &lsquo;sparse&rsquo; objects.</p>
</td></tr>
<tr><td><code id="formatC_+3A_replace.zero">replace.zero</code>, <code id="formatC_+3A_replace">replace</code></td>
<td>
<p>logical; if <code>zero.print</code> is a
character string, indicates if the exact zero entries in <code>x</code>
should be simply replaced by <code>zero.print</code>.  Otherwise,
depending on the widths of the respective strings, the (formatted)
zeroes are <em>partly</em> replaced by <code>zero.print</code> and then
padded with <code>" "</code> to the right were applicable.  In that case
(false <code>replace[.zero]</code>), if the <code>zero.print</code> string does
not fit, a warning is produced (if <code>warn.non.fitting</code> is true).
</p>
<p>This works via <code>prettyNum()</code>, which calls <code>.format.zeros(*,
    replace=replace.zero)</code> three times in this case, see the &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="formatC_+3A_warn.non.fitting">warn.non.fitting</code></td>
<td>
<p>logical; if it is true, <code>replace[.zero]</code> is
false and the <code>zero.print</code> string does not fit, a
<code><a href="#topic+warning">warning</a></code> is signalled.</p>
</td></tr>
<tr><td><code id="formatC_+3A_drop0trailing">drop0trailing</code></td>
<td>
<p>logical, indicating if trailing zeros,
i.e., <code>"0"</code> <em>after</em> the decimal mark, should be removed;
also drops <code>"e+00"</code> in exponential formats.  This is simply passed
to <code>prettyNum()</code>, see the &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="formatC_+3A_is.cmplx">is.cmplx</code></td>
<td>
<p>optional logical, to be used when <code>x</code> is
<code>"<a href="#topic+character">character</a>"</code> to indicate if it stems from
<code><a href="#topic+complex">complex</a></code> vector or not.  By default (<code>NA</code>),
<code>x</code> is checked to &lsquo;look like&rsquo; complex.</p>
</td></tr>
<tr><td><code id="formatC_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>format</code>.</p>
</td></tr>
<tr><td><code id="formatC_+3A_nx">nx</code></td>
<td>
<p>numeric vector of the same length as <code>x</code>, typically the
numbers of which the character vector <code>x</code> is the pre-format.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For numbers, <code>formatC()</code> calls <code>prettyNum()</code> when needed
which itself calls <code>.format.zeros(*, replace=replace.zero)</code>.
(<em>&ldquo;when needed&rdquo;</em>: when <code>zero.print</code> is not
<code>NULL</code>, <code>drop0trailing</code> is true, or one of <code>big.mark</code>,
<code>small.mark</code>, or <code>decimal.mark</code> is not at default.)
</p>
<p>If you set <code>format</code> it overrides the setting of <code>mode</code>, so
<code>formatC(123.45, mode = "double", format = "d")</code> gives <code>123</code>.
</p>
<p>The rendering of scientific format is platform-dependent: some systems
use <code>n.ddde+nnn</code> or <code>n.dddenn</code> rather than <code>n.ddde+nn</code>.
</p>
<p><code>formatC</code> does not necessarily align the numbers on the decimal
point, so <code>formatC(c(6.11, 13.1), digits = 2, format = "fg")</code> gives
<code>c("6.1", " 13")</code>.  If you want common formatting for several
numbers, use <code><a href="#topic+format">format</a></code>.
</p>
<p><code>prettyNum</code> is the utility function for prettifying <code>x</code>.
<code>x</code> can be complex (or <code><a href="#topic+format">format</a>(&lt;complex&gt;)</code>), here.  If
<code>x</code> is not a character, <code>format(x[i], ...)</code> is applied to
each element, and then it is left unchanged if all the other arguments
are at their defaults.  Use the <code>input.d.mark</code> argument for
<code>prettyNum(x)</code> when <code>x</code> is a <code>character</code> vector not
resulting from something like <code>format(&lt;number&gt;)</code> with a period as
decimal mark.
</p>
<p>Because <code><a href="#topic+gsub">gsub</a></code> is used to insert the <code>big.mark</code>
and <code>small.mark</code>, special characters need escaping.  In particular,
to insert a single backslash, use <code>"\\\\"</code>.
</p>
<p>The C doubles used for <span class="rlang"><b>R</b></span> numerical vectors have signed zeros, which
<code>formatC</code> may output as <code>-0</code>, <code>-0.000</code> ....
</p>
<p>There is a warning if <code>big.mark</code> and <code>decimal.mark</code> are the
same: that would be confusing to those reading the output.
</p>


<h3>Value</h3>

<p>A character object of same size and attributes as <code>x</code> (after
discarding any class), in the current locale's encoding.
</p>
<p>Unlike <code><a href="#topic+format">format</a></code>, each number is formatted individually.
Looping over each element of <code>x</code>, the C function
<code>sprintf(...)</code> is called for numeric inputs (inside the C
function <code>str_signif</code>).
</p>
<p><code>formatC</code>: for character <code>x</code>, do simple (left or right)
padding with white space.
</p>


<h3>Note</h3>

<p>The default for <code>decimal.mark</code> in <code>formatC()</code> was changed in
<span class="rlang"><b>R</b></span> 3.2.0: for use within <code><a href="#topic+print">print</a></code> methods in packages which might
be used with earlier versions: use <code>decimal.mark = getOption("OutDec")</code>
explicitly.
</p>


<h3>Author(s)</h3>

<p><code>formatC</code> was originally written by Bill Dunlap for S-PLUS, later
much improved by Martin Maechler.
</p>
<p>It was first adapted for <span class="rlang"><b>R</b></span> by Friedrich Leisch and since much
improved by the R Core team.
</p>




<h3>References</h3>

<p>Kernighan, B. W. and Ritchie, D. M. (1988)
<em>The C Programming Language.</em>  Second edition.  Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+format">format</a></code>.
</p>
<p><code><a href="#topic+sprintf">sprintf</a></code> for more general C-like formatting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx &lt;- pi * 10^(-5:4)
cbind(format(xx, digits = 4), formatC(xx))
cbind(formatC(xx, width = 9, flag = "-"))
cbind(formatC(xx, digits = 5, width = 8, format = "f", flag = "0"))
cbind(format(xx, digits = 4), formatC(xx, digits = 4, format = "fg"))

f &lt;- (-2:4); f &lt;- f*16^f
# Default ("g") format:
formatC(pi*f)
# Fixed ("f") format, more than one flag ('width' partly "enlarged"):
cbind(formatC(pi*f, digits = 3, width=9, format = "f", flag = "0+"))

formatC(    c("a", "Abc", "no way"), width = -7)  # &lt;=&gt; flag = "-"
formatC(c((-1:1)/0,c(1,100)*pi), width = 8, digits = 1)

## note that some of the results here depend on the implementation
## of long-double arithmetic, which is platform-specific.
xx &lt;- c(1e-12,-3.98765e-10,1.45645e-69,1e-70,pi*1e37,3.44e4)
##       1        2             3        4      5       6
formatC(xx)
formatC(xx, format = "fg")       # special "fixed" format.
formatC(xx[1:4], format = "f", digits = 75) #&gt;&gt; even longer strings

formatC(c(3.24, 2.3e-6), format = "f", digits = 11)
formatC(c(3.24, 2.3e-6), format = "f", digits = 11, drop0trailing = TRUE)

r &lt;- c("76491283764.97430", "29.12345678901", "-7.1234", "-100.1","1123")
## American:
prettyNum(r, big.mark = ",")
## Some Europeans:
prettyNum(r, big.mark = "'", decimal.mark = ",")

(dd &lt;- sapply(1:10, function(i) paste((9:0)[1:i], collapse = "")))
prettyNum(dd, big.mark = "'")

## examples of 'small.mark'
pN &lt;- stats::pnorm(1:7, lower.tail = FALSE)
cbind(format (pN, small.mark = " ", digits = 15))
cbind(formatC(pN, small.mark = " ", digits = 17, format = "f"))

cbind(ff &lt;- format(1.2345 + 10^(0:5), width = 11, big.mark = "'"))
## all with same width (one more than the specified minimum)

## individual formatting to common width:
fc &lt;- formatC(1.234 + 10^(0:8), format = "fg", width = 11, big.mark = "'")
cbind(fc)
## Powers of two, stored exactly, formatted individually:
pow.2 &lt;- formatC(2^-(1:32), digits = 24, width = 1, format = "fg")
## nicely printed (the last line showing 5^32 exactly):
noquote(cbind(pow.2))

## complex numbers:
r &lt;- 10.0000001; rv &lt;- (r/10)^(1:10)
(zv &lt;- (rv + 1i*rv))
op &lt;- options(digits = 7) ## (system default)
(pnv &lt;- prettyNum(zv))
stopifnot(pnv == "1+1i", pnv == format(zv),
          pnv == prettyNum(zv, drop0trailing = TRUE))
## more digits change the picture:
options(digits = 8)
head(fv &lt;- format(zv), 3)
prettyNum(fv)
prettyNum(fv, drop0trailing = TRUE) # a bit nicer
options(op)

## The  '  flag :
doLC &lt;- FALSE # &lt;= R warns, so change to TRUE manually if you want see the effect
if(doLC) {
  oldLC &lt;- Sys.getlocale("LC_NUMERIC")
           Sys.setlocale("LC_NUMERIC", "de_CH.UTF-8")
}
formatC(1.234 + 10^(0:4), format = "fg", width = 11, flag = "'")
## --&gt;  .....  "      1'001" "     10'001"   on supported platforms
if(doLC) ## revert, typically to  "C"  :
  Sys.setlocale("LC_NUMERIC", oldLC)
</code></pre>

<hr>
<h2 id='formatDL'>Format Description Lists</h2><span id='topic+formatDL'></span>

<h3>Description</h3>

<p>Format vectors of items and their descriptions as 2-column
tables or LaTeX-style description lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatDL(x, y, style = c("table", "list"),
         width = 0.9 * getOption("width"), indent = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatDL_+3A_x">x</code></td>
<td>
<p>a vector giving the items to be described, or a list of
length 2 or a matrix with 2 columns giving both items and
descriptions.</p>
</td></tr>
<tr><td><code id="formatDL_+3A_y">y</code></td>
<td>
<p>a vector of the same length as <code>x</code> with the
corresponding descriptions.  Only used if <code>x</code> does not already
give the descriptions.</p>
</td></tr>
<tr><td><code id="formatDL_+3A_style">style</code></td>
<td>
<p>a character string specifying the rendering style of the
description information.  Can be abbreviated.
If <code>"table"</code>, a two-column table with
items and descriptions as columns is produced (similar to Texinfo's
<code style="white-space: pre;">&#8288;@table&#8288;</code> environment).  If <code>"list"</code>, a LaTeX-style tagged
description list is obtained.</p>
</td></tr>
<tr><td><code id="formatDL_+3A_width">width</code></td>
<td>
<p>a positive integer giving the target column for wrapping
lines in the output.</p>
</td></tr>
<tr><td><code id="formatDL_+3A_indent">indent</code></td>
<td>
<p>a positive integer specifying the indentation of the
second column in table style, and the indentation of continuation
lines in list style.  Must not be greater than <code>width/2</code>, and
defaults to <code>width/3</code> for table style and <code>width/9</code> for
list style.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After extracting the vectors of items and corresponding descriptions
from the arguments, both are coerced to character vectors.
</p>
<p>In table style, items with more than <code>indent - 3</code> characters are
displayed on a line of their own.
</p>


<h3>Value</h3>

<p>a character vector with the formatted entries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Provide a nice summary of the numerical characteristics of the
## machine R is running on:
writeLines(formatDL(unlist(.Machine)))
## Inspect Sys.getenv() results in "list" style (by default, these are
## printed in "table" style):
writeLines(formatDL(Sys.getenv(), style = "list"))
</code></pre>

<hr>
<h2 id='function'>Function Definition</h2><span id='topic+function'></span><span id='topic+return'></span><span id='topic+closure'></span>

<h3>Description</h3>

<p>These functions provide the base mechanisms for defining
new functions in the <span class="rlang"><b>R</b></span> language.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>function( arglist ) expr
\( arglist ) expr
return(value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="function_+3A_arglist">arglist</code></td>
<td>
<p>empty or one or more (comma-separated) &lsquo;<span class="samp">&#8288;name&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;name = expression&#8288;</span>&rsquo; terms
and/or the special token <code><a href="#topic+...">...</a></code>.</p>
</td></tr>
<tr><td><code id="function_+3A_expr">expr</code></td>
<td>
<p>an expression.</p>
</td></tr>
<tr><td><code id="function_+3A_value">value</code></td>
<td>
<p>an expression.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names in an argument list can be back-quoted non-standard names
(see &lsquo;<a href="#topic+backquote">backquote</a>&rsquo;).
</p>
<p>If <code>value</code> is missing, <code>NULL</code> is returned.  If it is a
single expression, the value of the evaluated expression is returned.
(The expression is evaluated as soon as <code>return</code> is called, in
the evaluation frame of the function and before any
<code><a href="#topic+on.exit">on.exit</a></code> expression is evaluated.)
</p>
<p>If the end of a function is reached without calling <code>return</code>, the
value of the last evaluated expression is returned.
</p>
<p>The shorthand form <code>\(x) x + 1</code> is parsed as <code>function(x) x
    + 1</code>. It may be helpful in making code containing simple function
expressions more readable.
</p>


<h3>Technical details</h3>

<p>This type of function is not the only type in <span class="rlang"><b>R</b></span>: they are called
<em>closures</em> (a name with origins in LISP) to distinguish them from
<a href="#topic+primitive">primitive</a> functions.
</p>
<p>A closure has three components, its <code><a href="#topic+formals">formals</a></code> (its argument
list), its <code><a href="#topic+body">body</a></code> (<code>expr</code> in the &lsquo;Usage&rsquo;
section) and its <code><a href="#topic+environment">environment</a></code> which provides the
enclosure of the evaluation frame when the closure is used.
</p>
<p>There is an optional further component if the closure has been
byte-compiled.  This is not normally user-visible, but is indicated
when functions are printed.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+args">args</a></code>.
</p>
<p><code><a href="#topic+formals">formals</a></code>, <code><a href="#topic+body">body</a></code> and
<code><a href="#topic+environment">environment</a></code> for accessing the component parts of a
function.
</p>
<p><code><a href="#topic+debug">debug</a></code> for debugging; using <code><a href="#topic+invisible">invisible</a></code> inside
<code>return(.)</code> for returning <em>invisibly</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>norm &lt;- function(x) sqrt(x%*%x)
norm(1:4)

## An anonymous function:
(function(x, y){ z &lt;- x^2 + y^2; x+y+z })(0:7, 1)
</code></pre>

<hr>
<h2 id='funprog'>Common Higher-Order Functions in Functional Programming Languages</h2><span id='topic+Filter'></span><span id='topic+Find'></span><span id='topic+Map'></span><span id='topic+Negate'></span><span id='topic+Reduce'></span><span id='topic+Position'></span>

<h3>Description</h3>


<dl>
<dt><code>Reduce</code></dt><dd><p>uses a binary function to successively combine the
elements of a given vector and a possibly given initial value.</p>
</dd>
<dt><code>Filter</code></dt><dd><p>extracts the elements of a vector for which a predicate
(logical) function gives true.</p>
</dd>
<dt><code>Find</code> and <code>Position</code></dt><dd><p>give the first or last such
element and its position in the vector, respectively.</p>
</dd>
<dt><code>Map</code></dt><dd><p>applies a function to the corresponding elements of given vectors.</p>
</dd>
<dt><code>Negate</code></dt><dd><p>creates the negation of a given function.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>Reduce(f, x, init, right = FALSE, accumulate = FALSE, simplify = TRUE)
Filter(f, x)
Find(f, x, right = FALSE, nomatch = NULL)
Map(f, ...)
Negate(f)
Position(f, x, right = FALSE, nomatch = NA_integer_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funprog_+3A_f">f</code></td>
<td>
<p>a function of the appropriate arity (binary for
<code>Reduce</code>, unary for <code>Filter</code>, <code>Find</code> and
<code>Position</code>, <code class="reqn">k</code>-ary for <code>Map</code> if this is called with
<code class="reqn">k</code> arguments).  An arbitrary predicate function for
<code>Negate</code>.</p>
</td></tr>
<tr><td><code id="funprog_+3A_x">x</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="funprog_+3A_init">init</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object of the same kind as the elements of
<code>x</code>.</p>
</td></tr>
<tr><td><code id="funprog_+3A_right">right</code></td>
<td>
<p>a logical indicating whether to proceed from left to
right (default) or from right to left.</p>
</td></tr>
<tr><td><code id="funprog_+3A_accumulate">accumulate</code></td>
<td>
<p>a logical indicating whether the successive reduce
combinations should be accumulated.  By default, only the final
combination is used.</p>
</td></tr>
<tr><td><code id="funprog_+3A_simplify">simplify</code></td>
<td>
<p>a logical indicating whether accumulated results
should be simplified (by unlisting) in case they all are length
one.</p>
</td></tr>
<tr><td><code id="funprog_+3A_nomatch">nomatch</code></td>
<td>
<p>the value to be returned in the case when
&ldquo;no match&rdquo; (no element satisfying the predicate) is found.</p>
</td></tr>
<tr><td><code id="funprog_+3A_...">...</code></td>
<td>
<p>vectors to which the function is <code>Map()</code>ped, and other
arguments of <code><a href="#topic+mapply">mapply</a></code> passed to it, e.g., <code>MoreArgs</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>init</code> is given, <code>Reduce</code> logically adds it to the start
(when proceeding left to right) or the end of <code>x</code>, respectively.
If this possibly augmented vector <code class="reqn">v</code> has <code class="reqn">n &gt; 1</code> elements,
<code>Reduce</code> successively applies <code class="reqn">f</code> to the elements of <code class="reqn">v</code>
from left to right or right to left, respectively.  I.e., a left
reduce computes <code class="reqn">l_1 = f(v_1, v_2)</code>, <code class="reqn">l_2 = f(l_1, v_3)</code>, etc.,
and returns <code class="reqn">l_{n-1} = f(l_{n-2}, v_n)</code>, and a right reduce does
<code class="reqn">r_{n-1} = f(v_{n-1}, v_n)</code>, <code class="reqn">r_{n-2} = f(v_{n-2}, r_{n-1})</code>
and returns <code class="reqn">r_1 = f(v_1, r_2)</code>.  (E.g., if <code class="reqn">v</code> is the
sequence (2, 3, 4) and <code class="reqn">f</code> is division, left and right reduce give
<code class="reqn">(2 / 3) / 4 = 1/6</code> and <code class="reqn">2 / (3 / 4) = 8/3</code>, respectively.)
If <code class="reqn">v</code> has only a single element, this is returned; if there are
no elements, <code>NULL</code> is returned.  Thus, it is ensured that
<code>f</code> is always called with 2 arguments.
</p>
<p>The current implementation is non-recursive to ensure stability and
scalability.
</p>
<p><code>Reduce</code> is patterned after Common Lisp's <code>reduce</code>.  A
reduce is also known as a fold (e.g., in Haskell) or an accumulate
(e.g., in the C++ Standard Template Library).  The accumulative
version corresponds to Haskell's scan functions.
</p>
<p><code>Filter</code> applies the unary predicate function <code>f</code> to each
element of <code>x</code>, coercing to logical if necessary, and returns the
subset of <code>x</code> for which this gives true.  Note that possible
<code>NA</code> values are currently always taken as false; control over
<code>NA</code> handling may be added in the future.  <code>Filter</code>
corresponds to <code>filter</code> in Haskell or &lsquo;<span class="samp">&#8288;remove-if-not&#8288;</span>&rsquo; in
Common Lisp.
</p>
<p><code>Find</code> and <code>Position</code> are patterned after Common Lisp's
&lsquo;<span class="samp">&#8288;find-if&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;position-if&#8288;</span>&rsquo;, respectively.  If there is an
element for which the predicate function gives true, then the first or
last such element or its position is returned depending on whether
<code>right</code> is false (default) or true, respectively.  If there is no
such element, the value specified by <code>nomatch</code> is returned.  The
current implementation is not optimized for performance.
</p>
<p><code>Map</code> is a simple wrapper to <code><a href="#topic+mapply">mapply</a></code> which does not
attempt to simplify the result, similar to Common Lisp's <code>mapcar</code>
(with arguments being recycled, however).  Future versions may allow
some control of the result type.
</p>
<p><code>Negate</code> corresponds to Common Lisp's <code>complement</code>.  Given a
(predicate) function <code>f</code>, it creates a function which returns the
logical negation of what <code>f</code> returns.
</p>


<h3>See Also</h3>

<p>Function <code><a href="parallel.html#topic+clusterMap">clusterMap</a></code> and <code><a href="parallel.html#topic+mcmapply">mcmapply</a></code> (not
Windows) in package <span class="pkg">parallel</span> provide parallel versions of <code>Map</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A general-purpose adder:
add &lt;- function(x) Reduce(`+`, x)
add(list(1, 2, 3))
## Like sum(), but can also used for adding matrices etc., as it will
## use the appropriate '+' method in each reduction step.
## More generally, many generics meant to work on arbitrarily many
## arguments can be defined via reduction:
FOO &lt;- function(...) Reduce(FOO2, list(...))
FOO2 &lt;- function(x, y) UseMethod("FOO2")
## FOO() methods can then be provided via FOO2() methods.

## A general-purpose cumulative adder:
cadd &lt;- function(x) Reduce(`+`, x, accumulate = TRUE)
cadd(seq_len(7))

## A simple function to compute continued fractions:
cfrac &lt;- function(x) Reduce(function(u, v) u + 1 / v, x, right = TRUE)
## Continued fraction approximation for pi:
cfrac(c(3, 7, 15, 1, 292))
## Continued fraction approximation for Euler's number (e):
cfrac(c(2, 1, 2, 1, 1, 4, 1, 1, 6, 1, 1, 8))

## Map() now recycles similar to basic Ops:
Map(`+`, 1,         1 : 3) ;         1 + 1:3
Map(`+`, numeric(), 1 : 3) ; numeric() + 1:3

## Iterative function application:
Funcall &lt;- function(f, ...) f(...)
## Compute log(exp(acos(cos(0))))
Reduce(Funcall, list(log, exp, acos, cos), 0, right = TRUE)
## n-fold iterate of a function, functional style:
Iterate &lt;- function(f, n = 1)
    function(x) Reduce(Funcall, rep.int(list(f), n), x, right = TRUE)
## Continued fraction approximation to the golden ratio:
Iterate(function(x) 1 + 1 / x, 30)(1)
## which is the same as
cfrac(rep.int(1, 31))
## Computing square root approximations for x as fixed points of the
## function t |-&gt; (t + x / t) / 2, as a function of the initial value:
asqrt &lt;- function(x, n) Iterate(function(t) (t + x / t) / 2, n)
asqrt(2, 30)(10) # Starting from a positive value =&gt; +sqrt(2)
asqrt(2, 30)(-1) # Starting from a negative value =&gt; -sqrt(2)

## A list of all functions in the base environment:
funs &lt;- Filter(is.function, sapply(ls(baseenv()), get, baseenv()))
## Functions in base with more than 10 arguments:
names(Filter(function(f) length(formals(f)) &gt; 10, funs))
## Number of functions in base with a '...' argument:
length(Filter(function(f)
              any(names(formals(f)) %in% "..."),
              funs))

## Find all objects in the base environment which are *not* functions:
Filter(Negate(is.function),  sapply(ls(baseenv()), get, baseenv()))
</code></pre>

<hr>
<h2 id='gc'>Garbage Collection</h2><span id='topic+gc'></span><span id='topic+gcinfo'></span>

<h3>Description</h3>

<p>A call of <code>gc</code> causes a garbage collection to take place.
<code>gcinfo</code> sets a flag so that
automatic collection is either silent (<code>verbose = FALSE</code>) or
prints memory usage statistics (<code>verbose = TRUE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gc(verbose = getOption("verbose"), reset = FALSE, full = TRUE)
gcinfo(verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gc_+3A_verbose">verbose</code></td>
<td>
<p>logical; if <code>TRUE</code>, the garbage collection prints
statistics about cons cells and the space allocated for vectors.</p>
</td></tr>
<tr><td><code id="gc_+3A_reset">reset</code></td>
<td>
<p>logical; if <code>TRUE</code> the values for maximum space used
are reset to the current values.</p>
</td></tr>
<tr><td><code id="gc_+3A_full">full</code></td>
<td>
<p>logical; if <code>TRUE</code> a full collection is performed;
otherwise only more recently allocated objects may be collected.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A call of <code>gc</code> causes a garbage collection to take place.
This will also take place automatically without user intervention, and the
primary purpose of calling <code>gc</code> is for the report on memory
usage.  For an accurate report <code>full = TRUE</code> should be used.
</p>
<p>It can be useful to call <code>gc</code> after a large object
has been removed, as this may prompt <span class="rlang"><b>R</b></span> to return memory to the
operating system.
</p>
<p><span class="rlang"><b>R</b></span> allocates space for vectors in multiples of 8 bytes: hence the
report of <code>"Vcells"</code>, a relic of an earlier allocator (that used
a vector heap).
</p>
<p>When <code>gcinfo(TRUE)</code> is in force, messages are sent to the message
connection at each garbage collection of the form
</p>
<pre>    Garbage collection 12 = 10+0+2 (level 0) ...
    6.4 Mbytes of cons cells used (58%)
    2.0 Mbytes of vectors used (32%)
</pre>
<p>Here the last two lines give the current memory usage rounded up to
the next 0.1Mb and as a percentage of the current trigger value.
The first line gives a breakdown of the number of garbage collections
at various levels (for an explanation see the &lsquo;R Internals&rsquo; manual).
</p>


<h3>Value</h3>

<p><code>gc</code> returns a matrix with rows <code>"Ncells"</code> (<em>cons
cells</em>), usually 28 bytes each on 32-bit systems and 56 bytes on
64-bit systems, and <code>"Vcells"</code> (<em>vector cells</em>, 8 bytes
each), and columns <code>"used"</code> and <code>"gc trigger"</code>,
each also interpreted in megabytes (rounded up to the next 0.1Mb).
</p>
<p>If maxima have been set for either <code>"Ncells"</code> or <code>"Vcells"</code>,
a fifth column is printed giving the current limits in Mb (with
<code>NA</code> denoting no limit).
</p>
<p>The final two columns show the maximum space used since the last call
to <code>gc(reset = TRUE)</code> (or since <span class="rlang"><b>R</b></span> started).
</p>
<p><code>gcinfo</code> returns the previous value of the flag.
</p>


<h3>See Also</h3>

<p>The &lsquo;R Internals&rsquo; manual.
</p>
<p><code><a href="#topic+Memory">Memory</a></code> on <span class="rlang"><b>R</b></span>'s memory management,
and <code><a href="#topic+gctorture">gctorture</a></code> if you are an <span class="rlang"><b>R</b></span> developer.
</p>
<p><code><a href="#topic+gc.time">gc.time</a>()</code> reports <em>time</em> used for garbage collection.
</p>
<p><code><a href="#topic+reg.finalizer">reg.finalizer</a></code> for actions to happen at garbage
collection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
gc() #- do it now
gcinfo(TRUE) #-- in the future, show when R does it
##            vvvvv use larger to *show* something
x &lt;- integer(100000); for(i in 1:18) x &lt;- c(x, i)
gcinfo(verbose = FALSE) #-- don't show it anymore

gc(TRUE)

gc(reset = TRUE)
</code></pre>

<hr>
<h2 id='gc.time'>Report Time Spent in Garbage Collection</h2><span id='topic+gc.time'></span>

<h3>Description</h3>

<p>This function reports the time spent in garbage collection so far in
the <span class="rlang"><b>R</b></span> session while <abbr>GC</abbr> timing was enabled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gc.time(on = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gc.time_+3A_on">on</code></td>
<td>
<p>logical; if <code>TRUE</code>, <abbr>GC</abbr> timing is enabled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to timer resolution this may be under-estimate.
</p>
<p>This is a <a href="#topic+primitive">primitive</a>.
</p>


<h3>Value</h3>

<p>A numerical vector of length 5 giving the user CPU time, the system
CPU time, the elapsed time and children's user and system CPU times
(normally both zero), of time spent doing garbage collection whilst
<abbr>GC</abbr> timing was enabled.
</p>
<p>Times of child processes are not available on Windows and will always
be given as <code>NA</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gc">gc</a></code>,
<code><a href="#topic+proc.time">proc.time</a></code> for the timings for the session.</p>


<h3>Examples</h3>

<pre><code class='language-R'>gc.time()
</code></pre>

<hr>
<h2 id='gctorture'>Torture Garbage Collector</h2><span id='topic+gctorture'></span><span id='topic+gctorture2'></span><span id='topic+R_GCTORTURE'></span><span id='topic+R_GCTORTURE_WAIT'></span><span id='topic+R_GCTORTURE_INHIBIT_RELEASE'></span>

<h3>Description</h3>

<p>Provokes garbage collection on (nearly) every memory allocation.
Intended to ferret out memory protection bugs.  Also makes <span class="rlang"><b>R</b></span> run
<em>very</em> slowly, unfortunately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gctorture(on = TRUE)
gctorture2(step, wait = step, inhibit_release = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gctorture_+3A_on">on</code></td>
<td>
<p>logical; turning it on/off.</p>
</td></tr>
<tr><td><code id="gctorture_+3A_step">step</code></td>
<td>
<p>integer; run <abbr>GC</abbr> every <code>step</code> allocations; <code>step
      = 0</code> turns the <abbr>GC</abbr> torture off.</p>
</td></tr>
<tr><td><code id="gctorture_+3A_wait">wait</code></td>
<td>
<p>integer; number of allocations to wait before starting
<abbr>GC</abbr> torture.</p>
</td></tr>
<tr><td><code id="gctorture_+3A_inhibit_release">inhibit_release</code></td>
<td>
<p>logical; do not release free objects for
re-use: use with caution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling <code>gctorture(TRUE)</code> instructs the memory manager to force a
full <abbr>GC</abbr> on every allocation. <code>gctorture2</code> provides a more refined
interface that allows the start of the <abbr>GC</abbr> torture to be deferred and
also gives the option of running a <abbr>GC</abbr> only every <code>step</code>
allocations.
</p>
<p>The third argument to <code>gctorture2</code> is only used if R has been
configured with a strict write barrier enabled.  When this is the case
all garbage collections are full collections, and the memory manager
marks free nodes and enables checks in many situations that signal an
error when a free node is used.  This can help greatly in isolating
unprotected values in C code.  It does not detect the case where a
node becomes free and is reallocated.  The <code>inhibit_release</code>
argument can be used to prevent such reallocation.  This will cause
memory to grow and should be used with caution and in conjunction with
operating system facilities to monitor and limit process memory use.
</p>
<p><code>gctorture2</code> can also be invoked via environment variables at the
start of the <span class="rlang"><b>R</b></span> session.  <span class="env">R_GCTORTURE</span> corresponds to the
<code>step</code> argument, <span class="env">R_GCTORTURE_WAIT</span> to <code>wait</code>, and
<span class="env">R_GCTORTURE_INHIBIT_RELEASE</span> to <code>inhibit_release</code>.
</p>


<h3>Value</h3>

<p>Previous value of first argument.
</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard and Luke Tierney</p>

<hr>
<h2 id='get'>Return the Value of a Named Object</h2><span id='topic+get'></span><span id='topic+mget'></span><span id='topic+dynGet'></span>

<h3>Description</h3>

<p>Search by name for an object (<code>get</code>) or zero or more objects
(<code>mget</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get(x, pos = -1, envir = as.environment(pos), mode = "any",
    inherits = TRUE)

mget(x, envir = as.environment(-1), mode = "any", ifnotfound,
     inherits = FALSE)

dynGet(x, ifnotfound = , minframe = 1L, inherits = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_+3A_x">x</code></td>
<td>
<p>For <code>get</code>, an object name (given as a character
string or a symbol).<br />
For <code>mget</code>, a character vector of object names.
</p>
</td></tr>
<tr><td><code id="get_+3A_pos">pos</code>, <code id="get_+3A_envir">envir</code></td>
<td>
<p>where to look for the object (see &lsquo;Details&rsquo;); if
omitted search as if the name of the object appeared unquoted in an
expression.</p>
</td></tr>
<tr><td><code id="get_+3A_mode">mode</code></td>
<td>
<p>the mode or type of object sought: see the
&lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="get_+3A_inherits">inherits</code></td>
<td>
<p>should the enclosing frames of the environment be
searched?</p>
</td></tr>
<tr><td><code id="get_+3A_ifnotfound">ifnotfound</code></td>
<td>
<p>For <code>mget</code>, a <code><a href="#topic+list">list</a></code> of values to
be used if the item is not found: it will be coerced to a list if
necessary.<br />
For <code>dynGet</code> any <span class="rlang"><b>R</b></span> object, e.g., a call to
<code><a href="#topic+stop">stop</a>()</code>.</p>
</td></tr>
<tr><td><code id="get_+3A_minframe">minframe</code></td>
<td>
<p>integer specifying the minimal frame number to look
into.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pos</code> argument can specify the environment in which to look
for the object in any of several ways: as a positive integer (the
position in the <code><a href="#topic+search">search</a></code> list); as the character string
name of an element in the search list; or as an
<code><a href="#topic+environment">environment</a></code> (including using <code><a href="#topic+sys.frame">sys.frame</a></code>
to access the currently active function calls).  The default of
<code>-1</code> indicates the current environment of the call to
<code>get</code>. The <code>envir</code> argument is an alternative way to
specify an environment.
</p>
<p>These functions look to see if each of the name(s) <code>x</code> have a
value bound to it in the specified environment.  If <code>inherits</code> is
<code>TRUE</code> and a value is not found for <code>x</code> in the specified
environment, the enclosing frames of the environment are searched
until the name <code>x</code> is encountered.  See <code><a href="#topic+environment">environment</a></code>
and the &lsquo;R Language Definition&rsquo; manual for details about the
structure of environments and their enclosures.
</p>
<p>If <code>mode</code> is specified then only objects of that type are sought.
<code>mode</code> here is a mixture of the meanings of <code><a href="#topic+typeof">typeof</a></code>
and <code><a href="#topic+mode">mode</a></code>: <code>"function"</code> covers primitive functions
and operators, <code>"numeric"</code>, <code>"integer"</code> and <code>"double"</code>
all refer to any numeric type, <code>"symbol"</code> and <code>"name"</code> are
equivalent <em>but</em> <code>"language"</code> must be used (and not
<code>"call"</code> or <code>"("</code>).
Currently, <code>mode = "S4"</code> and <code>mode = "object"</code> are equivalent.
</p>
<p>For <code>mget</code>, the values of <code>mode</code> and <code>ifnotfound</code> can
be either the same length as <code>x</code> or of length 1.  The argument
<code>ifnotfound</code> must be a list containing either the value to use if
the requested item is not found or a function of one argument which
will be called if the item is not found, with argument the name of the
item being requested.
</p>
<p><code>dynGet()</code> is somewhat experimental and to be used <em>inside</em>
another function.  It looks for an object in the callers, i.e.,
the <code><a href="#topic+sys.frame">sys.frame</a>()</code>s of the function.  Use with caution.
</p>


<h3>Value</h3>

<p>For <code>get</code>, the object found.  If no object is found an error results.
</p>
<p>For <code>mget</code>, a named list of objects (found or specified <em>via</em>
<code>ifnotfound</code>).
</p>


<h3>Note</h3>

<p>The reverse (or &ldquo;inverse&rdquo;) of <code>a &lt;- get(nam)</code> is
<code><a href="#topic+assign">assign</a>(nam, a)</code>, assigning <code>a</code> to name <code>nam</code>.
</p>
<p><code>inherits = TRUE</code> is the default for <code>get</code> in <span class="rlang"><b>R</b></span>
but not for S where it had a different meaning.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exists">exists</a></code> for checking whether an object exists;
<code><a href="#topic+get0">get0</a></code> for an efficient way of both checking existence and
getting an object.
</p>
<p><code><a href="#topic+assign">assign</a></code>, the inverse of <code>get()</code>, see above.
</p>
<p>Use <code><a href="utils.html#topic+getAnywhere">getAnywhere</a></code> for searching for an object
anywhere, including in other namespaces, and
<code><a href="utils.html#topic+getFromNamespace">getFromNamespace</a></code> to find an object in a specific
namespace.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get("%o%")

## test mget
e1 &lt;- new.env()
mget(letters, e1, ifnotfound = as.list(LETTERS))
</code></pre>

<hr>
<h2 id='getCallingDLL'>Compute DLL for Native Interface Call</h2><span id='topic+getCallingDLL'></span><span id='topic+getCallingDLLe'></span>

<h3>Description</h3>

<p>This is an internal function that is called from <span class="rlang"><b>R</b></span>'s C code to
determine the enclosing namespace of a
<code>.C</code>/<code>.Call</code>/<code>.Fortran</code>/<code>.External</code> call which has
no <code>PACKAGE</code> argument. If the call has been made from a function
within a namespace, then we can find the DLL associated with that
namespace.  The purpose of this is to avoid having to use the
<code>PACKAGE</code> argument in these native calls and so better support
versions of packages.
</p>
<p>This is an internal function that may be migrated to internal C
code in the future and so should not be used by <span class="rlang"><b>R</b></span> programmers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCallingDLL(f = sys.function(-1), doStop = FALSE)
getCallingDLLe(e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCallingDLL_+3A_f">f</code></td>
<td>
<p>the function whose namespace and DLL are to be found.
By default, this is the current function being called which
is the one in which the native routine is being invoked.</p>
</td></tr>
<tr><td><code id="getCallingDLL_+3A_dostop">doStop</code></td>
<td>
<p>a logical value indicating whether failure to find
a namespace and/or DLL is an error (<code>TRUE</code>) or not
(<code>FALSE</code>).  The default is <code>FALSE</code> so that when this is
called because there is no <code>PACKAGE</code> argument in a
<code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Call">.Call</a></code>, <code><a href="#topic+.Fortran">.Fortran</a></code>,
<code><a href="#topic+.External">.External</a></code> call,  no error occurs and the regular lookup
is performed by searching all DLLs in order.</p>
</td></tr>
<tr><td><code id="getCallingDLL_+3A_e">e</code></td>
<td>
<p>an environment.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+.C">.C</a></code>,
<code><a href="#topic+.Call">.Call</a></code>,
<code><a href="#topic+.Fortran">.Fortran</a></code>,
<code><a href="#topic+.External">.External</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(exists("ansari.test"))
   getCallingDLL(ansari.test)
</code></pre>

<hr>
<h2 id='getDLLRegisteredRoutines'>Reflectance Information for C/Fortran routines in a DLL</h2><span id='topic+getDLLRegisteredRoutines'></span><span id='topic+getDLLRegisteredRoutines.character'></span><span id='topic+getDLLRegisteredRoutines.DLLInfo'></span><span id='topic+print.NativeRoutineList'></span><span id='topic+print.DLLRegisteredRoutines'></span>

<h3>Description</h3>

<p>This function allows us to query the set of routines
in a DLL that are registered with R to enhance
dynamic lookup, error handling when calling native routines,
and potentially security in the future.
This function provides a description of each of the
registered routines in the DLL for the different interfaces,
i.e. <code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Call">.Call</a></code>, <code><a href="#topic+.Fortran">.Fortran</a></code>
and <code><a href="#topic+.External">.External</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDLLRegisteredRoutines(dll, addNames = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDLLRegisteredRoutines_+3A_dll">dll</code></td>
<td>
<p>a character string or <code>DLLInfo</code> object.
The character string specifies the file name of the DLL
of interest, and is given without the file name extension (e.g., the
&lsquo;<span class="file">.dll</span>&rsquo; or &lsquo;<span class="file">.so</span>&rsquo;) and with no directory/path information.
So a file &lsquo;<span class="file">MyPackage/libs/MyPackage.so</span>&rsquo; would be specified as
&lsquo;<span class="samp">&#8288;MyPackage&#8288;</span>&rsquo;.
</p>
<p>The <code>DLLInfo</code> objects can be obtained directly
in calls to <code><a href="#topic+dyn.load">dyn.load</a></code> and  <code><a href="#topic+library.dynam">library.dynam</a></code>,
or can be found after the DLL has been loaded using
<code><a href="#topic+getLoadedDLLs">getLoadedDLLs</a></code>, which returns a list of
<code>DLLInfo</code> objects (index-able by DLL file name).
</p>
<p>The <code>DLLInfo</code> approach avoids any ambiguities related to two
DLLs having the same name but corresponding to files in different
directories.
</p>
</td></tr>
<tr><td><code id="getDLLRegisteredRoutines_+3A_addnames">addNames</code></td>
<td>
<p>a logical value.  If this is <code>TRUE</code>, the elements
of the returned lists are named using the names of the routines (as
seen by R via registration or raw name).  If <code>FALSE</code>,
these names are not computed and assigned to the lists.  As a
result, the call should be quicker.  The name information is also
available in the <code>NativeSymbolInfo</code> objects in the lists.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This takes the registration information after it has been registered
and processed by the R internals.  In other words, it uses the extended
information.
</p>
<p>There is a <code>print</code> method for the class, which prints only the
types which have registered routines.
</p>


<h3>Value</h3>

<p>A list of class <code>"DLLRegisteredRoutines"</code> with four elements
corresponding to the routines registered for the <code>.C</code>,
<code>.Call</code>, <code>.Fortran</code> and <code>.External</code> interfaces. Each is
a list (of class <code>"NativeRoutineList"</code>) with as many elements as
there were routines registered for that interface.
</p>
<p>Each element identifies a routine and is an object
of class <code>"NativeSymbolInfo"</code>.
An object of this class has the following fields:
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>the registered name of the routine (not necessarily the
name in the C code).</p>
</td></tr>
<tr><td><code>address</code></td>
<td>
<p>the memory address of the routine as resolved in the
loaded DLL. This may be <code>NULL</code> if the symbol has not yet been
resolved.</p>
</td></tr>
<tr><td><code>dll</code></td>
<td>
<p>an object of class <code>DLLInfo</code> describing the DLL.
This is same for all elements returned.</p>
</td></tr>
<tr><td><code>numParameters</code></td>
<td>
<p>the number of arguments the native routine is to
be called with.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Duncan Temple Lang <a href="mailto:duncan@wald.ucdavis.edu">duncan@wald.ucdavis.edu</a></p>


<h3>References</h3>

<p>&lsquo;Writing R Extensions&rsquo; manual for symbol registration.
</p>
<p>Duncan Temple Lang (2001).
&ldquo;In Search of C/C++ &amp; FORTRAN Routines&rdquo;.
<em>R News</em>, <b>1</b>(3), 20&ndash;23.
<a href="https://www.r-project.org/doc/Rnews/Rnews_2001-3.pdf">https://www.r-project.org/doc/Rnews/Rnews_2001-3.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getLoadedDLLs">getLoadedDLLs</a></code>,
<code><a href="#topic+getNativeSymbolInfo">getNativeSymbolInfo</a></code> for information on the entry points listed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dlls &lt;- getLoadedDLLs()
getDLLRegisteredRoutines(dlls[["base"]])

getDLLRegisteredRoutines("stats")
</code></pre>

<hr>
<h2 id='getLoadedDLLs'>Get DLLs Loaded in Current Session</h2><span id='topic+getLoadedDLLs'></span><span id='topic+print.DLLInfo'></span><span id='topic+print.DLLInfoList'></span><span id='topic++5B.DLLInfoList'></span><span id='topic++24.DLLInfo'></span><span id='topic+DLLInfo'></span><span id='topic+DLLInfoList'></span>

<h3>Description</h3>

<p>This function provides a way to get a list of all the DLLs (see
<code><a href="#topic+dyn.load">dyn.load</a></code>) that are currently loaded in the <span class="rlang"><b>R</b></span> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLoadedDLLs()
</code></pre>


<h3>Details</h3>

<p>This queries the internal table that manages the DLLs.
</p>


<h3>Value</h3>

<p>An object of class <code>"DLLInfoList"</code> which is a <code><a href="#topic+list">list</a></code>
with an element corresponding to each DLL that is currently loaded in the
session.  Each element is an object of class <code>"DLLInfo"</code> which
has the following entries.
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>the abbreviated name.</p>
</td></tr>
<tr><td><code>path</code></td>
<td>
<p>the fully qualified name of the loaded DLL.</p>
</td></tr>
<tr><td><code>dynamicLookup</code></td>
<td>
<p>a logical value indicating whether R uses only
the registration information to resolve symbols or whether it
searches the entire symbol table of the DLL.</p>
</td></tr>
<tr><td><code>handle</code></td>
<td>
<p>a reference to the C-level data structure that
provides access to the contents of the DLL.
This is an object of class <code>"DLLHandle"</code>.</p>
</td></tr>
</table>
<p>Note that the class <code>DLLInfo</code> has a method for
<code>$</code> which can be used to resolve native symbols within that
DLL.  Therefore, one must access the R-level elements described
above using <code>[[</code>, e.g. <code>x[["name"]]</code> or <code>x[["handle"]]</code>.
</p>


<h3>Note</h3>

<p>We are starting to use the <code>handle</code> elements in the DLL object to
resolve symbols more directly in <span class="rlang"><b>R</b></span>.
</p>


<h3>Author(s)</h3>

<p>Duncan Temple Lang <a href="mailto:duncan@wald.ucdavis.edu">duncan@wald.ucdavis.edu</a>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+getDLLRegisteredRoutines">getDLLRegisteredRoutines</a></code>,
<code><a href="#topic+getNativeSymbolInfo">getNativeSymbolInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getLoadedDLLs()

utils::tail(getLoadedDLLs(), 2) # the last 2 loaded ones, still a DLLInfoList
</code></pre>

<hr>
<h2 id='getNativeSymbolInfo'>
Obtain a Description of one or more Native (C/Fortran) Symbols
</h2><span id='topic+getNativeSymbolInfo'></span><span id='topic+NativeSymbolInfo'></span><span id='topic+NativeSymbol'></span><span id='topic+RegisteredNativeSymbol'></span>

<h3>Description</h3>

<p>This finds and returns a description of one or more dynamically loaded
or &lsquo;exported&rsquo; built-in native symbols.  For each name, it
returns information about the name of the symbol, the library in which
it is located and, if available, the number of arguments it expects
and by which interface it should be called (i.e <code><a href="#topic+.Call">.Call</a></code>,
<code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Fortran">.Fortran</a></code>, or
<code><a href="#topic+.External">.External</a></code>). Additionally, it returns the address of the
symbol and this can be passed to other C routines.  Specifically, this
provides a way to explicitly share symbols between different
dynamically loaded package libraries.  Also, it provides a way to
query where symbols were resolved, and aids diagnosing strange
behavior associated with dynamic resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNativeSymbolInfo(name, PACKAGE, unlist = TRUE,
                    withRegistrationInfo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNativeSymbolInfo_+3A_name">name</code></td>
<td>
<p>the name(s) of the native symbol(s).</p>
</td></tr>
<tr><td><code id="getNativeSymbolInfo_+3A_package">PACKAGE</code></td>
<td>
<p>an optional argument that specifies to which
DLL to restrict the search for this symbol.  If this is
<code>"base"</code>, we search in the <span class="rlang"><b>R</b></span> executable itself.</p>
</td></tr>
<tr><td><code id="getNativeSymbolInfo_+3A_unlist">unlist</code></td>
<td>
<p>a logical value which controls how the result is
returned if the function is called with the name of a single symbol.
If <code>unlist</code> is <code>TRUE</code> and the number of symbol names in
<code>name</code> is one, then the <code>NativeSymbolInfo</code> object
is returned.  If it is <code>FALSE</code>, then a list
of <code>NativeSymbolInfo</code> objects is returned.
This is ignored if the number of symbols passed in <code>name</code> is
more than one.
To be compatible with earlier versions of this function, this
defaults to <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="getNativeSymbolInfo_+3A_withregistrationinfo">withRegistrationInfo</code></td>
<td>
<p>a logical value indicating whether, if
<code>TRUE</code>, to return information that was registered with <span class="rlang"><b>R</b></span> about
the symbol and its parameter types if such information is available,
or if <code>FALSE</code> to return just the address of the symbol.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This uses the same mechanism for resolving symbols as is used
in all the native interfaces (<code><a href="#topic+.Call">.Call</a></code>, etc.).
If the symbol has been explicitly registered by the DLL
in which it is contained, information about the number of arguments
and the interface by which it should be called will be returned.
Otherwise, a generic native symbol object is returned.
</p>


<h3>Value</h3>

<p>Generally, a list of <code>NativeSymbolInfo</code> elements whose elements
can be indexed by the elements of <code>name</code>  in the call.  Each
<code>NativeSymbolInfo</code> object is a list containing the following
elements:
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>the name of the symbol, as given by the
<code>name</code> argument.</p>
</td></tr>
<tr><td><code>address</code></td>
<td>
<p>if <code>withRegistrationInfo</code> is <code>FALSE</code>,
this is the native memory address of the symbol which can
be used to invoke the routine, and also to
compare with other symbol addresses.  This is an external pointer
object and of class <code>NativeSymbol</code>.
If <code>withRegistrationInfo</code> is <code>TRUE</code> and registration
information is available for the symbol, then this is
an object of class <code>RegisteredNativeSymbol</code> and is a reference
to an internal data type that has access to the routine pointer and
registration information.  This too can be used in calls to
<code><a href="#topic+.Call">.Call</a></code>, <code><a href="#topic+.C">.C</a></code>, <code><a href="#topic+.Fortran">.Fortran</a></code> and
<code><a href="#topic+.External">.External</a></code>.
</p>
</td></tr>
<tr><td><code>dll</code></td>
<td>
<p>a list containing 3 elements:
</p>

<dl>
<dt>name</dt><dd><p>the short form of the library name which can be used
as the value of the <code>PACKAGE</code> argument in
the different native interface functions.</p>
</dd>
<dt>path</dt><dd><p>the fully qualified name of the DLL.</p>
</dd>
<dt>dynamicLookup</dt><dd><p>a logical value indicating whether dynamic
resolution is used when looking for symbols in this library,
or only registered routines can be located.</p>
</dd>
</dl>

</td></tr>
</table>
<p>If the routine was explicitly registered by the dynamically loaded
library, the list contains a fourth field
</p>
<table>
<tr><td><code>numParameters</code></td>
<td>
<p>the number of arguments that should be passed in
a call to this routine.</p>
</td></tr>
</table>
<p>Additionally, the list will have an additional class,
being <code>CRoutine</code>, <code>CallRoutine</code>, <code>FortranRoutine</code> or
<code>ExternalRoutine</code> corresponding to the R interface by which it
should be invoked.
</p>
<p>If any of the symbols is not found, an error is raised.
</p>
<p>If <code>name</code> contains only one symbol name and <code>unlist</code> is
<code>TRUE</code>, then the single <code>NativeSymbolInfo</code> is returned
rather than the list containing that one element.
</p>


<h3>Note</h3>

<p>The third element of the <code>NativeSymbolInfo</code> objects was renamed
from <code>package</code> to <code>dll</code> in <span class="rlang"><b>R</b></span> version 3.6.0, for consistency
with the names of the <code>NativeSymbolInfo</code> objects returned by
<code><a href="#topic+getDLLRegisteredRoutines">getDLLRegisteredRoutines</a>()</code>.
</p>


<h3>Note</h3>

<p>One motivation for accessing this reflectance information is to be
able to pass native routines to C routines as function pointers in C.
This allows us to treat native routines and <span class="rlang"><b>R</b></span> functions in a similar
manner, such as when passing an <span class="rlang"><b>R</b></span> function to C code that makes
callbacks to that function at different points in its computation
(e.g., <code><a href="stats.html#topic+nls">nls</a></code>).  Additionally, we can resolve the symbol
just once and avoid resolving it repeatedly or using the internal
cache.
</p>


<h3>Author(s)</h3>

<p>Duncan Temple Lang</p>


<h3>References</h3>

<p>For information about registering native routines,
see &ldquo;In Search of C/C++ &amp; FORTRAN Routines&rdquo;,
R-News, volume 1, number 3, 2001, p20&ndash;23
(<a href="https://www.r-project.org/doc/Rnews/Rnews_2001-3.pdf">https://www.r-project.org/doc/Rnews/Rnews_2001-3.pdf</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getDLLRegisteredRoutines">getDLLRegisteredRoutines</a></code>,
<code><a href="#topic+is.loaded">is.loaded</a></code>,
<code><a href="#topic+.C">.C</a></code>,
<code><a href="#topic+.Fortran">.Fortran</a></code>,
<code><a href="#topic+.External">.External</a></code>,
<code><a href="#topic+.Call">.Call</a></code>,
<code><a href="#topic+dyn.load">dyn.load</a></code>.
</p>

<hr>
<h2 id='gettext'>Translate Text Messages</h2><span id='topic+gettext'></span><span id='topic+ngettext'></span><span id='topic+bindtextdomain'></span><span id='topic+Sys.setLanguage'></span>

<h3>Description</h3>

<p>Translation of text messages typically from calls to
<code><a href="#topic+stop">stop</a>()</code>, <code><a href="#topic+warning">warning</a>()</code>, or <code><a href="#topic+message">message</a>()</code>
happens when Native Language Support (<abbr>NLS</abbr>) was enabled in this build of
<span class="rlang"><b>R</b></span> as it is almost always, see also the <code>bindtextdomain()</code> example.
</p>
<p>The functions documented here are the low level building blocks used
explicitly or implicitly in almost all such message producing calls and
they attempt to
translate character vectors or set where the translations are to be found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gettext(..., domain = NULL, trim = TRUE)

ngettext(n, msg1, msg2, domain = NULL)

bindtextdomain(domain, dirname = NULL)

Sys.setLanguage(lang, unset = "en")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gettext_+3A_...">...</code></td>
<td>
<p>one or more character vectors.</p>
</td></tr>
<tr><td><code id="gettext_+3A_trim">trim</code></td>
<td>
<p>logical indicating if the white space trimming in
<code>gettext()</code> should happen.  <code>trim = FALSE</code> may be needed for
compiled code (C / C++) messages which often end with <code>\n</code>.</p>
</td></tr>
<tr><td><code id="gettext_+3A_domain">domain</code></td>
<td>
<p>the &lsquo;domain&rsquo; for the translation, a <code>character</code>
string, or <code><a href="#topic+NULL">NULL</a></code>; see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="gettext_+3A_n">n</code></td>
<td>
<p>a non-negative integer.</p>
</td></tr>
<tr><td><code id="gettext_+3A_msg1">msg1</code></td>
<td>
<p>the message to be used in English for <code>n = 1</code>.</p>
</td></tr>
<tr><td><code id="gettext_+3A_msg2">msg2</code></td>
<td>
<p>the message to be used in English for <code>n = 0, 2, 3, ...</code>.</p>
</td></tr>
<tr><td><code id="gettext_+3A_dirname">dirname</code></td>
<td>
<p>the directory in which to find translated message
catalogs for the domain.</p>
</td></tr>
<tr><td><code id="gettext_+3A_lang">lang</code></td>
<td>
<p>a <code><a href="#topic+character">character</a></code> string specifying a language for
which translations should be sought.</p>
</td></tr>
<tr><td><code id="gettext_+3A_unset">unset</code></td>
<td>
<p>a string, specifying the default language assumed to be
current in the case <code><a href="#topic+Sys.getenv">Sys.getenv</a>("LANGUAGE")</code> is unset or
empty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>domain</code> is <code>NULL</code> (the default) in <code>gettext</code>
or <code>ngettext</code>, the domain is inferred.  If <code>gettext</code>
or <code>ngettext</code>  is called from a function in the namespace of
package <span class="pkg">pkg</span> including called via <code><a href="#topic+stop">stop</a>()</code>,
<code><a href="#topic+warning">warning</a>()</code>, or <code><a href="#topic+message">message</a>()</code> from the function,
or, say, evaluated as if called from that namespace, see the
<code>evalq()</code> example, 
the domain is set to <code>"R-pkg"</code>.  Otherwise there is no default
domain and messages are not translated.
</p>
<p>Setting <code>domain = NA</code> in <code>gettext</code> or <code>ngettext</code>
suppresses any translation.
</p>
<p><code>""</code> does not match any domain.  In <code>gettext</code> or <code>ngettext</code>,
<code>domain = ""</code> is effectively the same as <code>domain = NA</code>.
</p>
<p>If the domain is found, each character string is offered for
translation, and replaced by its translation into the current language
if one is found.
</p>
<p>The <em>language</em> to be used for message translation is determined by
your OS default and/or the locale setting at <span class="rlang"><b>R</b></span>'s startup, see
<code><a href="#topic+Sys.getlocale">Sys.getlocale</a>()</code>, and notably the <span class="env">LANGUAGE</span> environment 
variable, and also <code>Sys.setLanguage()</code> here.
</p>
<p>Conventionally the domain for <span class="rlang"><b>R</b></span> warning/error messages in package
<span class="pkg">pkg</span> is <code>"R-pkg"</code>, and that for C-level messages is <code>"pkg"</code>.
</p>
<p>For <code>gettext</code>, when <code>trim</code> is true as by default,
leading and trailing whitespace is ignored (&ldquo;trimmed&rdquo;) when
looking for the translation.
</p>
<p><code>ngettext</code> is used where the message needs to vary by a single
integer.  Translating such messages is subject to very specific rules
for different languages: see the GNU Gettext Manual.  The string
will often contain a single instance of <code>%d</code> to be used in
<code><a href="#topic+sprintf">sprintf</a></code>.  If English is used, <code>msg1</code> is returned if
<code>n == 1</code> and <code>msg2</code> in all other cases.
</p>
<p><code>bindtextdomain</code> is typically wrapper for the C function of the same
name: your system may have a <code>man</code> page for it.  With a
non-<code>NULL</code> <code>dirname</code> it specifies where to look for message
catalogues: with <code>dirname = NULL</code> it returns the current location.
If <abbr>NLS</abbr> is not enabled, <code>bindtextdomain(*,*)</code> returns <code>NULL</code>.

The special case <code>bindtextdomain(NULL)</code> calls C level
<code>textdomain(textdomain(NULL))</code> for the purpose of flushing (i.e.,
emptying) the cache of already translated strings; it returns <code>TRUE</code>
when <abbr>NLS</abbr> is enabled.
</p>
<p>The utility <code>Sys.setLanguage(lang)</code> combines setting the
<span class="env">LANGUAGE</span> environment variable with flushing the translation cache
by <code>bindtextdomain(NULL)</code>.
</p>


<h3>Value</h3>

<p>For <code>gettext</code>, a character vector, one element per string in
<code>...</code>.  If translation is not enabled or no domain is found or
no translation is found in that domain, the original strings are
returned.
</p>
<p>For <code>ngettext</code>, a character string.
</p>
<p>For <code>bindtextdomain</code>, a character string giving the current base
directory, or <code>NULL</code> if setting it failed.
</p>
<p>For <code>Sys.setLanguage()</code>, the previous <span class="env">LANGUAGE</span> setting with
attribute <code><a href="#topic+attr">attr</a>(*, "ok")</code>, a <code><a href="#topic+logical">logical</a></code>
indicating success.
Note that currently, using a non-existing language <code>lang</code> is still
set and no translation will happen, without any <code><a href="#topic+message">message</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stop">stop</a></code> and <code><a href="#topic+warning">warning</a></code> make use of <code>gettext</code> to
translate messages.
</p>
<p><code><a href="tools.html#topic+xgettext">xgettext</a></code> (package <span class="pkg">tools</span>) for extracting translatable
strings from <span class="rlang"><b>R</b></span> source files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bindtextdomain("R")  # non-null if and only if NLS is enabled

for(n in 0:3)
    print(sprintf(ngettext(n, "%d variable has missing values",
                              "%d variables have missing values"),
                  n))

## Not run: ## for translation, those strings should appear in R-pkg.pot as
msgid        "%d variable has missing values"
msgid_plural "%d variables have missing values"
msgstr[0] ""
msgstr[1] ""

## End(Not run)

miss &lt;- "One only" # this line, or the next for the ngettext() below
miss &lt;- c("one", "or", "another")
cat(ngettext(length(miss), "variable", "variables"),
    paste(sQuote(miss), collapse = ", "),
    ngettext(length(miss), "contains", "contain"), "missing values\n")

## better for translators would be to use
cat(sprintf(ngettext(length(miss),
                     "variable %s contains missing values\n",
                     "variables %s contain missing values\n"),
            paste(sQuote(miss), collapse = ", ")))

thisLang &lt;- Sys.getenv("LANGUAGE", unset = NA) # so we can reset it
if(is.na(thisLang) || !nzchar(thisLang)) thisLang &lt;- "en" # "factory" default
enT &lt;- "empty model supplied"
Sys.setenv(LANGUAGE = "de") # may not always 'work'
gettext(enT, domain="R-stats")# "leeres Modell angegeben" (if translation works)
tget &lt;- function() gettext(enT)
tget() # not translated as fn tget() is not from "stats" pkg/namespace
evalq(function() gettext(enT), asNamespace("stats"))() # *is* translated

## Sys.setLanguage()  -- typical usage --
Sys.setLanguage("en") -&gt; oldSet # does set LANGUAGE env.var
errMsg &lt;- function(expr) tryCatch(expr, error=conditionMessage)
(errMsg(1 + "2") -&gt; err)
Sys.setLanguage("fr")
errMsg(1 + "2")
Sys.setLanguage("de")
errMsg(1 + "2")
## Usually, you would reset the language to "previous" via
Sys.setLanguage(oldSet)

## A show off of translations -- platform (font etc) dependent:
## The translation languages available for "base" R in this version of R:
if(capabilities("NLS")) withAutoprint({
  langs &lt;- list.files(bindtextdomain("R"),
		      pattern = "^[a-z]{2}(_[A-Z]{2}|@quot)?$")
  langs
  txts &lt;- sapply(setNames(,langs),
		 function(lang) { Sys.setLanguage(lang)
				 gettext("incompatible dimensions", domain="R-stats") })
  cbind(txts)
  (nTrans &lt;- length(unique(txts)))
  (not_translated &lt;- names(txts[txts == txts[["en"]]]))
})

## Here, we reset to the *original* setting before the full example started:
if(nzchar(thisLang)) { ## reset to previous and check
  Sys.setLanguage(thisLang)
  stopifnot(identical(errMsg(1 + "2"), err))
} # else staying at 'de' ..
</code></pre>

<hr>
<h2 id='getwd'>Get or Set Working Directory</h2><span id='topic+getwd'></span><span id='topic+setwd'></span>

<h3>Description</h3>

<p><code>getwd</code> returns an absolute filepath representing the current
working directory of the <span class="rlang"><b>R</b></span> process; <code>setwd(dir)</code> is used to set
the working directory to <code>dir</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getwd()
setwd(dir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getwd_+3A_dir">dir</code></td>
<td>
<p>A character string: <a href="#topic+tilde+20expansion">tilde expansion</a> will be done.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="#topic+files">files</a> for how file paths with marked encodings are interpreted.
</p>


<h3>Value</h3>

<p><code>getwd</code> returns a character string or <code>NULL</code> if the working
directory is not available.
On Windows the path returned will use <code>/</code> as the path separator
and be encoded in UTF-8.  The path will not have a trailing <code>/</code>
unless it is the root directory (of a drive or share on Windows).
</p>
<p><code>setwd</code> returns the current directory before the change,
invisibly and with the same conventions as <code>getwd</code>.  It will give
an error if it does not succeed (including if it is not implemented).
</p>


<h3>Note</h3>

<p>Note that the return value is said to be <strong>an</strong> absolute
filepath: there can be more than one representation of the path to a
directory and on some OSes the value returned can differ after
changing directories and changing back to the same directory (for
example if symbolic links have been traversed).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+list.files">list.files</a></code> for the <em>contents</em> of a directory.
</p>
<p><code><a href="#topic+normalizePath">normalizePath</a></code> for a &lsquo;canonical&rsquo; path name.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(WD &lt;- getwd())
if (!is.null(WD)) setwd(WD)
</code></pre>

<hr>
<h2 id='gl'>Generate Factor Levels</h2><span id='topic+gl'></span>

<h3>Description</h3>

<p>Generate factors by specifying the pattern of their levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gl(n, k, length = n*k, labels = seq_len(n), ordered = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gl_+3A_n">n</code></td>
<td>
<p>an integer giving the number of levels.</p>
</td></tr>
<tr><td><code id="gl_+3A_k">k</code></td>
<td>
<p>an integer giving the number of replications.</p>
</td></tr>
<tr><td><code id="gl_+3A_length">length</code></td>
<td>
<p>an integer giving the length of the result.</p>
</td></tr>
<tr><td><code id="gl_+3A_labels">labels</code></td>
<td>
<p>an optional vector of labels for the resulting factor
levels.</p>
</td></tr>
<tr><td><code id="gl_+3A_ordered">ordered</code></td>
<td>
<p>a logical indicating whether the result should be
ordered or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result has levels from <code>1</code> to <code>n</code> with each value
replicated in groups of length <code>k</code> out to a total length of
<code>length</code>.
</p>
<p><code>gl</code> is modelled on the <em>GLIM</em> function of the same name.
</p>


<h3>See Also</h3>

<p>The underlying <code><a href="#topic+factor">factor</a>()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## First control, then treatment:
gl(2, 8, labels = c("Control", "Treat"))
## 20 alternating 1s and 2s
gl(2, 1, 20)
## alternating pairs of 1s and 2s
gl(2, 2, 20)
</code></pre>

<hr>
<h2 id='grep'>Pattern Matching and Replacement</h2><span id='topic+grep'></span><span id='topic+grepl'></span><span id='topic+sub'></span><span id='topic+gsub'></span><span id='topic+regexpr'></span><span id='topic+gregexpr'></span><span id='topic+regexec'></span><span id='topic+gregexec'></span>

<h3>Description</h3>

<p><code>grep</code>, <code>grepl</code>, <code>regexpr</code>, <code>gregexpr</code>, 
<code>regexec</code> and <code>gregexec</code> search for matches to argument
<code>pattern</code> within each element of a character vector: they differ in
the format of and amount of detail in the results.
</p>
<p><code>sub</code> and <code>gsub</code> perform replacement of the first and all
matches respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grep(pattern, x, ignore.case = FALSE, perl = FALSE, value = FALSE,
     fixed = FALSE, useBytes = FALSE, invert = FALSE)

grepl(pattern, x, ignore.case = FALSE, perl = FALSE,
      fixed = FALSE, useBytes = FALSE)

sub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,
    fixed = FALSE, useBytes = FALSE)

gsub(pattern, replacement, x, ignore.case = FALSE, perl = FALSE,
     fixed = FALSE, useBytes = FALSE)

regexpr(pattern, text, ignore.case = FALSE, perl = FALSE,
        fixed = FALSE, useBytes = FALSE)

gregexpr(pattern, text, ignore.case = FALSE, perl = FALSE,
         fixed = FALSE, useBytes = FALSE)

regexec(pattern, text, ignore.case = FALSE, perl = FALSE,
        fixed = FALSE, useBytes = FALSE)

gregexec(pattern, text, ignore.case = FALSE, perl = FALSE,
        fixed = FALSE, useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grep_+3A_pattern">pattern</code></td>
<td>
<p>character string containing a <a href="#topic+regular+20expression">regular expression</a>
(or character string for <code>fixed = TRUE</code>) to be matched
in the given character vector.  Coerced by
<code><a href="#topic+as.character">as.character</a></code> to a character string if possible.  If a
character vector of length 2 or more is supplied, the first element
is used with a warning.  Missing values are allowed except for
<code>regexpr</code>, <code>gregexpr</code> and <code>regexec</code>.</p>
</td></tr>
<tr><td><code id="grep_+3A_x">x</code>, <code id="grep_+3A_text">text</code></td>
<td>
<p>a character vector where matches are sought, or an
object which can be coerced by <code>as.character</code> to a character
vector.  <a href="#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="grep_+3A_ignore.case">ignore.case</code></td>
<td>
<p>if <code>FALSE</code>, the pattern matching is <em>case
sensitive</em> and if <code>TRUE</code>, case is ignored during matching.</p>
</td></tr>
<tr><td><code id="grep_+3A_perl">perl</code></td>
<td>
<p>logical.  Should Perl-compatible regexps be used?</p>
</td></tr>
<tr><td><code id="grep_+3A_value">value</code></td>
<td>
<p>if <code>FALSE</code>, a vector containing the (<code>integer</code>)
indices of the matches determined by <code>grep</code> is returned, and if
<code>TRUE</code>, a vector containing the matching elements themselves is
returned.</p>
</td></tr>
<tr><td><code id="grep_+3A_fixed">fixed</code></td>
<td>
<p>logical.  If <code>TRUE</code>, <code>pattern</code> is a string to be
matched as is.  Overrides all conflicting arguments.</p>
</td></tr>
<tr><td><code id="grep_+3A_usebytes">useBytes</code></td>
<td>
<p>logical.  If <code>TRUE</code> the matching is done
byte-by-byte rather than character-by-character.  See
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="grep_+3A_invert">invert</code></td>
<td>
<p>logical.  If <code>TRUE</code> return indices or values for
elements that do <em>not</em> match.</p>
</td></tr>
<tr><td><code id="grep_+3A_replacement">replacement</code></td>
<td>
<p>a replacement for matched pattern in <code>sub</code> and
<code>gsub</code>.  Coerced to character if possible.  For
<code>fixed = FALSE</code> this can include backreferences <code>"\1"</code> to
<code>"\9"</code> to parenthesized subexpressions of <code>pattern</code>.  For
<code>perl = TRUE</code> only, it can also contain <code>"\U"</code> or
<code>"\L"</code> to convert the rest of the replacement to upper or
lower case and <code>"\E"</code> to end case conversion.  If a
character vector of length 2 or more is supplied, the first element
is used with a warning.  If <code>NA</code>, all elements in the result
corresponding to matches will be set to <code>NA</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments which should be character strings or character vectors are
coerced to character if possible.
</p>
<p>Each of these functions operates in one of three modes:
</p>

<ol>
<li> <p><code>fixed = TRUE</code>: use exact matching.
</p>
</li>
<li> <p><code>perl = TRUE</code>: use Perl-style regular expressions.
</p>
</li>
<li> <p><code>fixed = FALSE, perl = FALSE</code>: use POSIX 1003.2
extended regular expressions (the default).
</p>
</li></ol>

<p>See the help pages on <a href="#topic+regular+20expression">regular expression</a> for details of the
different types of regular expressions.
</p>
<p>The two <code>*sub</code> functions differ only in that <code>sub</code> replaces
only the first occurrence of a <code>pattern</code> whereas <code>gsub</code>
replaces all occurrences.  If <code>replacement</code> contains
backreferences which are not defined in <code>pattern</code> the result is
undefined (but most often the backreference is taken to be <code>""</code>).
</p>
<p>For <code>regexpr</code>, <code>gregexpr</code>, <code>regexec</code> and <code>gregexec</code>
it is an error for <code>pattern</code> to be <code>NA</code>, otherwise <code>NA</code>
is permitted and gives an <code>NA</code> match.
</p>
<p>Both <code>grep</code> and <code>grepl</code> take missing values in <code>x</code> as
not matching a non-missing <code>pattern</code>.
</p>
<p>The main effect of <code>useBytes = TRUE</code> is to avoid errors/warnings
about invalid inputs and spurious matches in multibyte locales, but
for <code>regexpr</code> it changes the interpretation of the output.  It
inhibits the conversion of inputs with marked encodings, and is forced
if any input is found which is marked as <code>"bytes"</code> (see
<code><a href="#topic+Encoding">Encoding</a></code>).
</p>
<p>Caseless matching does not make much sense for bytes in a multibyte
locale, and you should expect it only to work for ASCII characters if
<code>useBytes = TRUE</code>.
</p>
<p><code>regexpr</code> and <code>gregexpr</code> with <code>perl = TRUE</code> allow
Python-style named captures, but not for <em>long vector</em> inputs.
</p>
<p>Invalid inputs in the current locale are warned about up to 5 times.
</p>
<p>Caseless matching with <code>perl = TRUE</code> for non-ASCII characters
depends on the PCRE library being compiled with &lsquo;Unicode
property support&rsquo;, which PCRE2 is by default.
</p>


<h3>Value</h3>

<p><code>grep(value = FALSE)</code> returns a vector of the indices
of the elements of <code>x</code> that yielded a match (or not, for
<code>invert = TRUE</code>).  This will be an integer vector unless the input
is a <em><a href="#topic+long+20vector">long vector</a></em>, when it will be a double vector.
</p>
<p><code>grep(value = TRUE)</code> returns a character vector containing the
selected elements of <code>x</code> (after coercion, preserving names but no
other attributes).
</p>
<p><code>grepl</code> returns a logical vector (match or not for each element of
<code>x</code>).
</p>
<p><code>sub</code> and <code>gsub</code> return a character vector of the same length
and with the same attributes as <code>x</code> (after possible coercion to
character).  Elements of character vectors <code>x</code> which are not
substituted will be returned unchanged (including any declared encoding if
<code>useBytes = FALSE</code>).  If <code>useBytes = FALSE</code> a non-ASCII
substituted result will often be in UTF-8 with a marked encoding (e.g., if
there is a UTF-8 input, and in a multibyte locale unless <code>fixed =
  TRUE</code>).  Such strings can be re-encoded by <code><a href="#topic+enc2native">enc2native</a></code>.  If
any of the inputs is marked as <code>"bytes"</code>, elements of character
vectors <code>x</code> which are substituted will be returned marked as
<code>"bytes"</code>, but the encoding flag on elements not substituted is
unspecified (it may be the original or &quot;bytes&quot;).  If none of the inputs is
marked as <code>"bytes"</code>, but <code>useBytes = TRUE</code> is given explicitly,
the encoding flag is unspecified even on the substituted elements (it may
be <code>"bytes"</code> or <code>"unknown"</code>, possibly invalid in the current
encoding).  Mixed use of <code>"bytes"</code> and other marked encodings is
discouraged, but if still desired one may use <code><a href="#topic+iconv">iconv</a></code> to
re-encode the result e.g.  to UTF-8 with suitably substituted invalid
bytes.
</p>
<p><code>regexpr</code> returns an integer vector of the same length as
<code>text</code> giving the starting position of the first match or
<code class="reqn">-1</code> if there is none, with attribute <code>"match.length"</code>, an
integer vector giving the length of the matched text (or <code class="reqn">-1</code> for
no match).  The match positions and lengths are in characters unless
<code>useBytes = TRUE</code> is used, when they are in bytes (as they are
for ASCII-only matching: in either case an attribute
<code>useBytes</code> with value <code>TRUE</code> is set on the result).  If
named capture is used there are further attributes
<code>"capture.start"</code>, <code>"capture.length"</code> and
<code>"capture.names"</code>.
</p>
<p><code>gregexpr</code> returns a list of the same length as <code>text</code> each
element of which is of the same form as the return value for
<code>regexpr</code>, except that the starting positions of every (disjoint)
match are given.
</p>
<p><code>regexec</code> returns a list of the same length as <code>text</code> each
element of which is either <code class="reqn">-1</code> if there is no match, or a
sequence of integers with the starting positions of the match and all
substrings corresponding to parenthesized subexpressions of
<code>pattern</code>, with attribute <code>"match.length"</code> a vector
giving the lengths of the matches (or <code class="reqn">-1</code> for no match).  The
interpretation of positions and length and the attributes follows
<code>regexpr</code>.
</p>
<p><code>gregexec</code> returns the same as <code>regexec</code>, except that to
accommodate multiple matches per element of <code>text</code>, the integer
sequences for each match are made into columns of a matrix, with one
matrix per element of <code>text</code> with matches.
</p>
<p>Where matching failed because of resource limits (especially for
<code>perl = TRUE</code>) this is regarded as a non-match, usually with a
warning.
</p>


<h3>Warning</h3>

<p>The POSIX 1003.2 mode of <code>gsub</code> and <code>gregexpr</code> does not
work correctly with repeated word-boundaries (e.g.,
<code>pattern = "\b"</code>).
Use <code>perl = TRUE</code> for such matches (but that may not
work as expected with non-ASCII inputs, as the meaning of
&lsquo;word&rsquo; is system-dependent).
</p>


<h3>Performance considerations</h3>

<p>If you are doing a lot of regular expression matching, including on
very long strings, you will want to consider the options used.
Generally <code>perl = TRUE</code> will be faster than the default regular
expression engine, and <code>fixed = TRUE</code> faster still (especially
when each pattern is matched only a few times).
</p>
<p>If you are working with texts with non-ASCII characters, which can be
easily turned into ASCII (e.g.  by substituting fancy quotes), doing so is
likely to improve performance.
</p>
<p>If you are working in a single-byte locale (though not common since <span class="rlang"><b>R</b></span> 4.2)
and have marked UTF-8 strings that are representable in that locale,
convert them first as just one UTF-8 string will force all the matching to
be done in Unicode, which attracts a penalty of around <code class="reqn">3\times{}</code>
for the default POSIX 1003.2 mode.
</p>
<p>While <code>useBytes = TRUE</code> will improve performance further, because the
strings will not be checked before matching and the actual matching will
be faster, it can produce unexpected results so is best avoided.  With
<code>fixed = TRUE</code> and <code>useBytes = FALSE</code>, optimizations are in
place that take advantage of byte-based matching working for such patterns
in UTF-8.  With <code>useBytes = TRUE</code>, character ranges, wildcards,
and other regular expression patterns may produce unexpected results.
</p>
<p>PCRE-based matching by default used to put additional effort into
&lsquo;studying&rsquo; the compiled pattern when <code>x</code>/<code>text</code> has
length 10 or more.  That study may use the PCRE <abbr>JIT</abbr> compiler on
platforms where it is available (see <code><a href="#topic+pcre_config">pcre_config</a></code>). As
from PCRE2 (PCRE version &gt;= 10.00 as reported by
<code><a href="#topic+extSoftVersion">extSoftVersion</a></code>), there is no study phase, but the
patterns are optimized automatically when possible, and PCRE <abbr>JIT</abbr> is
used when enabled.  The details are controlled by
<code><a href="#topic+options">options</a></code> <code>PCRE_study</code> and <code>PCRE_use_JIT</code>.
(Some timing comparisons can be seen by running file
&lsquo;<span class="file">tests/PCRE.R</span>&rsquo; in the <span class="rlang"><b>R</b></span> sources (and perhaps installed).)
People working with PCRE and very long strings can adjust the maximum
size of the <abbr>JIT</abbr> stack by setting environment variable
<span class="env">R_PCRE_JIT_STACK_MAXSIZE</span> before <abbr>JIT</abbr> is used to a value between
<code>1</code> and <code>1000</code> in MB: the default is <code>64</code>. When <abbr>JIT</abbr> is
not used with PCRE version &lt; 10.30 (that is with PCRE1 and old
versions of PCRE2), it might also be wise to set the option
<code>PCRE_limit_recursion</code>.
</p>


<h3>Note</h3>

<p>Aspects will be platform-dependent as well as locale-dependent: for
example the implementation of character classes (except
<code>[:digit:]</code> and <code>[:xdigit:]</code>).  One can expect results to be
consistent for ASCII inputs and when working in UTF-8 mode (when most
platforms will use Unicode character tables, although those are
updated frequently and subject to some degree of interpretation &ndash; is
a circled capital letter alphabetic or a symbol?).  However, results
in 8-bit encodings can differ considerably between platforms, modes
and from the UTF-8 versions.
</p>


<h3>Source</h3>

<p>The C code for POSIX-style regular expression matching has changed
over the years.  As from <span class="rlang"><b>R</b></span> 2.10.0 (Oct 2009) the TRE library of Ville
Laurikari (<a href="https://github.com/laurikari/tre">https://github.com/laurikari/tre</a>) is used.  The POSIX
standard does give some room for interpretation, especially in the
handling of invalid regular expressions and the collation of character
ranges, so the results will have changed slightly over the years.
</p>
<p>For Perl-style matching PCRE2 or PCRE (<a href="https://www.pcre.org">https://www.pcre.org</a>) is
used: again the results may depend (slightly) on the version of PCRE
in use.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole (<code>grep</code>)
</p>


<h3>See Also</h3>

<p><a href="#topic+regular+20expression">regular expression</a> (aka <code><a href="#topic+regexp">regexp</a></code>) for the details
of the pattern specification.
</p>
<p><code><a href="#topic+regmatches">regmatches</a></code> for extracting matched substrings based on
the results of <code>regexpr</code>, <code>gregexpr</code> and <code>regexec</code>.
</p>
<p><code><a href="utils.html#topic+glob2rx">glob2rx</a></code> to turn wildcard matches into regular expressions.
</p>
<p><code><a href="#topic+agrep">agrep</a></code> for approximate matching.
</p>
<p><code><a href="#topic+charmatch">charmatch</a></code>, <code><a href="#topic+pmatch">pmatch</a></code> for partial matching,
<code><a href="#topic+match">match</a></code> for matching to whole strings,
<code><a href="#topic+startsWith">startsWith</a></code> for matching of initial parts of strings.
</p>
<p><code><a href="#topic+tolower">tolower</a></code>, <code><a href="#topic+toupper">toupper</a></code> and <code><a href="#topic+chartr">chartr</a></code>
for character translations.
</p>
<p><code><a href="utils.html#topic+apropos">apropos</a></code> uses regexps and has more examples.
</p>
<p><code><a href="#topic+grepRaw">grepRaw</a></code> for matching raw vectors.
</p>
<p>Options <code>PCRE_limit_recursion</code>, <code>PCRE_study</code> and
<code>PCRE_use_JIT</code>.
</p>
<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for the versions of regex and PCRE
libraries in use, <code><a href="#topic+pcre_config">pcre_config</a></code> for more details for
PCRE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grep("[a-z]", letters)

txt &lt;- c("arm","foot","lefroo", "bafoobar")
if(length(i &lt;- grep("foo", txt)))
   cat("'foo' appears at least once in\n\t", txt, "\n")
i # 2 and 4
txt[i]

## Double all 'a' or 'b's;  "\" must be escaped, i.e., 'doubled'
gsub("([ab])", "\\1_\\1_", "abc and ABC")

txt &lt;- c("The", "licenses", "for", "most", "software", "are",
  "designed", "to", "take", "away", "your", "freedom",
  "to", "share", "and", "change", "it.",
  "", "By", "contrast,", "the", "GNU", "General", "Public", "License",
  "is", "intended", "to", "guarantee", "your", "freedom", "to",
  "share", "and", "change", "free", "software", "--",
  "to", "make", "sure", "the", "software", "is",
  "free", "for", "all", "its", "users")
( i &lt;- grep("[gu]", txt) ) # indices
stopifnot( txt[i] == grep("[gu]", txt, value = TRUE) )

## Note that for some implementations character ranges are
## locale-dependent (but not currently).  Then [b-e] in locales such as
## en_US may include B as the collation order is aAbBcCdDe ...
(ot &lt;- sub("[b-e]",".", txt))
txt[ot != gsub("[b-e]",".", txt)]#- gsub does "global" substitution
## In caseless matching, ranges include both cases:
a &lt;- grep("[b-e]", txt, value = TRUE)
b &lt;- grep("[b-e]", txt, ignore.case = TRUE, value = TRUE)
setdiff(b, a)

txt[gsub("g","#", txt) !=
    gsub("g","#", txt, ignore.case = TRUE)] # the "G" words

regexpr("en", txt)

gregexpr("e", txt)

## Using grepl() for filtering
## Find functions with argument names matching "warn":
findArgs &lt;- function(env, pattern) {
  nms &lt;- ls(envir = as.environment(env))
  nms &lt;- nms[is.na(match(nms, c("F","T")))] # &lt;-- work around "checking hack"
  aa &lt;- sapply(nms, function(.) { o &lt;- get(.)
               if(is.function(o)) names(formals(o)) })
  iw &lt;- sapply(aa, function(a) any(grepl(pattern, a, ignore.case=TRUE)))
  aa[iw]
}
findArgs("package:base", "warn")

## trim trailing white space
str &lt;- "Now is the time      "
sub(" +$", "", str)  ## spaces only
## what is considered 'white space' depends on the locale.
sub("[[:space:]]+$", "", str) ## white space, POSIX-style
## what PCRE considered white space changed in version 8.34: see ?regex
sub("\\s+$", "", str, perl = TRUE) ## PCRE-style white space

## capitalizing
txt &lt;- "a test of capitalizing"
gsub("(\\w)(\\w*)", "\\U\\1\\L\\2", txt, perl=TRUE)
gsub("\\b(\\w)",    "\\U\\1",       txt, perl=TRUE)

txt2 &lt;- "useRs may fly into JFK or laGuardia"
gsub("(\\w)(\\w*)(\\w)", "\\U\\1\\E\\2\\U\\3", txt2, perl=TRUE)
 sub("(\\w)(\\w*)(\\w)", "\\U\\1\\E\\2\\U\\3", txt2, perl=TRUE)

## named capture
notables &lt;- c("  Ben Franklin and Jefferson Davis",
              "\tMillard Fillmore")
# name groups 'first' and 'last'
name.rex &lt;- "(?&lt;first&gt;[[:upper:]][[:lower:]]+) (?&lt;last&gt;[[:upper:]][[:lower:]]+)"
(parsed &lt;- regexpr(name.rex, notables, perl = TRUE))
gregexpr(name.rex, notables, perl = TRUE)[[2]]
parse.one &lt;- function(res, result) {
  m &lt;- do.call(rbind, lapply(seq_along(res), function(i) {
    if(result[i] == -1) return("")
    st &lt;- attr(result, "capture.start")[i, ]
    substring(res[i], st, st + attr(result, "capture.length")[i, ] - 1)
  }))
  colnames(m) &lt;- attr(result, "capture.names")
  m
}
parse.one(notables, parsed)

## Decompose a URL into its components.
## Example by LT (http://www.cs.uiowa.edu/~luke/R/regexp.html).
x &lt;- "http://stat.umn.edu:80/xyz"
m &lt;- regexec("^(([^:]+)://)?([^:/]+)(:([0-9]+))?(/.*)", x)
m
regmatches(x, m)
## Element 3 is the protocol, 4 is the host, 6 is the port, and 7
## is the path.  We can use this to make a function for extracting the
## parts of a URL:
URL_parts &lt;- function(x) {
    m &lt;- regexec("^(([^:]+)://)?([^:/]+)(:([0-9]+))?(/.*)", x)
    parts &lt;- do.call(rbind,
                     lapply(regmatches(x, m), `[`, c(3L, 4L, 6L, 7L)))
    colnames(parts) &lt;- c("protocol","host","port","path")
    parts
}
URL_parts(x)

## gregexec() may match multiple times within a single string.
pattern &lt;- "([[:alpha:]]+)([[:digit:]]+)"
s &lt;- "Test: A1 BC23 DEF456"
m &lt;- gregexec(pattern, s)
m
regmatches(s, m)

## Before gregexec() was implemented, one could emulate it by running
## regexec() on the regmatches obtained via gregexpr().  E.g.:
lapply(regmatches(s, gregexpr(pattern, s)),
       function(e) regmatches(e, regexec(pattern, e)))
</code></pre>

<hr>
<h2 id='grepRaw'>Pattern Matching for Raw Vectors</h2><span id='topic+grepRaw'></span>

<h3>Description</h3>

<p><code>grepRaw</code> searches for substring <code>pattern</code> matches within a
raw vector <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grepRaw(pattern, x, offset = 1L, ignore.case = FALSE,
        value = FALSE, fixed = FALSE, all = FALSE, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grepRaw_+3A_pattern">pattern</code></td>
<td>
<p>raw vector containing a <a href="#topic+regular+20expression">regular expression</a>
(or fixed pattern for <code>fixed = TRUE</code>) to be matched in the
given raw vector.  Coerced by <code><a href="#topic+charToRaw">charToRaw</a></code> to a character
string if possible.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_x">x</code></td>
<td>
<p>a raw vector where matches are sought, or an object which can
be coerced by <code>charToRaw</code> to a raw vector.  <a href="#topic+Long+20vectors">Long vectors</a>
are not supported.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_ignore.case">ignore.case</code></td>
<td>
<p>if <code>FALSE</code>, the pattern matching is <em>case
sensitive</em> and if <code>TRUE</code>, case is ignored during matching.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_offset">offset</code></td>
<td>
<p>an integer specifying the offset from
which the search should start.  Must be positive.  The beginning of
line is defined to be at that offset so <code>"^"</code> will match there.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_value">value</code></td>
<td>
<p>logical.  Determines the return value: see &lsquo;Value&rsquo;.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_fixed">fixed</code></td>
<td>
<p>logical.  If <code>TRUE</code>, <code>pattern</code> is a pattern to be
matched as is.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_all">all</code></td>
<td>
<p>logical.  If <code>TRUE</code> all matches are returned,
otherwise just the first one.</p>
</td></tr>
<tr><td><code id="grepRaw_+3A_invert">invert</code></td>
<td>
<p>logical.  If <code>TRUE</code> return indices or values for
elements that do <em>not</em> match.  Ignored (with a warning) unless
<code>value = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike <code><a href="#topic+grep">grep</a></code>, seeks matching patterns within the raw
vector <code>x</code> . This has implications especially in the <code>all =
  TRUE</code> case, e.g., patterns matching empty strings are inherently
infinite and thus may lead to unexpected results.
</p>
<p>The argument <code>invert</code> is interpreted as asking to return the
complement of the match, which is only meaningful for <code>value =
  TRUE</code>.  Argument <code>offset</code> determines the start of the search, not
of the complement.  Note that <code>invert = TRUE</code> with <code>all =
  TRUE</code> will split <code>x</code> into pieces delimited by the pattern
including leading and trailing empty strings (consequently the use of
regular expressions with <code>"^"</code> or <code>"$"</code> in that case may
lead to less intuitive results).
</p>
<p>Some combinations of arguments such as <code>fixed = TRUE</code> with
<code>value = TRUE</code> are supported but are less meaningful.
</p>


<h3>Value</h3>

<p><code>grepRaw(value = FALSE)</code> returns an integer vector of the offsets
at which matches have occurred.  If <code>all = FALSE</code> then it will be
either of length zero (no match) or length one (first matching
position).
</p>
<p><code>grepRaw(value = TRUE, all = FALSE)</code> returns a raw vector which
is either empty (no match) or the matched part of <code>x</code>.
</p>
<p><code>grepRaw(value = TRUE, all = TRUE)</code> returns a (potentially
empty) list of raw vectors corresponding to the matched parts.
</p>


<h3>Source</h3>

<p>The TRE library of Ville Laurikari (<a href="https://github.com/laurikari/tre/">https://github.com/laurikari/tre/</a>)
is used except for <code>fixed = TRUE</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+regular+20expression">regular expression</a> (aka <code><a href="#topic+regexp">regexp</a></code>) for the details
of the pattern specification.
</p>
<p><code><a href="#topic+grep">grep</a></code> for matching character vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grepRaw("no match", "textText")  # integer(0): no match
grepRaw("adf", "adadfadfdfadadf") # 3 - the first match
grepRaw("adf", "adadfadfdfadadf", all=TRUE, fixed=TRUE)
## [1]  3  6 13 -- three matches
</code></pre>

<hr>
<h2 id='groupGeneric'>S3 Group Generic Functions</h2><span id='topic+S3groupGeneric'></span><span id='topic+groupGeneric'></span><span id='topic+.Group'></span><span id='topic+Math'></span><span id='topic+Math.data.frame'></span><span id='topic+matrixOps'></span><span id='topic+Ops'></span><span id='topic+Ops.data.frame'></span><span id='topic+Summary'></span><span id='topic+Summary.data.frame'></span><span id='topic+Complex'></span><span id='topic+group+20generic'></span>

<h3>Description</h3>

<p>Group generic methods can be defined for the following pre-specified groups of
functions, <code>Math</code>, <code>Ops</code>, <code>matrixOps</code>, <code>Summary</code> and <code>Complex</code>.
(There are no objects of these names in base <span class="rlang"><b>R</b></span>, but there are in the
<span class="pkg">methods</span> package, not yet for <code>matrixOps</code>.)
</p>
<p>A method defined for an individual member of the group takes
precedence over a method defined for the group as a whole.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 methods for group generics have prototypes:
Math(x, ...)
Ops(e1, e2)
Complex(z)
Summary(..., na.rm = FALSE)
matrixOps(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupGeneric_+3A_x">x</code>, <code id="groupGeneric_+3A_y">y</code>, <code id="groupGeneric_+3A_z">z</code>, <code id="groupGeneric_+3A_e1">e1</code>, <code id="groupGeneric_+3A_e2">e2</code></td>
<td>
<p>objects.</p>
</td></tr>
<tr><td><code id="groupGeneric_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods.</p>
</td></tr>
<tr><td><code id="groupGeneric_+3A_na.rm">na.rm</code></td>
<td>
<p>logical: should missing values be removed?</p>
</td></tr>
</table>


<h3>Details</h3>


<p>There are five <em>groups</em> for which S3 methods can be written,
namely the <code>"Math"</code>, <code>"Ops"</code>, <code>"Summary"</code>, <code>"matrixOps"</code>, and
<code>"Complex"</code> groups.  These are not <span class="rlang"><b>R</b></span> objects in base <span class="rlang"><b>R</b></span>, but
methods can be supplied for them and base <span class="rlang"><b>R</b></span> contains
<code><a href="#topic+factor">factor</a></code>, <code><a href="#topic+data.frame">data.frame</a></code> and
<code><a href="#topic+difftime">difftime</a></code> methods for the first three groups.  (There is
also a <code><a href="#topic+ordered">ordered</a></code> method for <code>Ops</code>,
<code><a href="#topic+POSIXt">POSIXt</a></code> and <code><a href="#topic+Date">Date</a></code> methods for <code>Math</code>
and <code>Ops</code>, <code><a href="#topic+package_version">package_version</a></code> methods for <code>Ops</code>
and <code>Summary</code>, as well as a <code><a href="stats.html#topic+ts">ts</a></code> method for
<code>Ops</code> in package <span class="pkg">stats</span>.)
</p>

<ol>
<li><p> Group <code>"Math"</code>:
</p>

<ul>
<li>
<p><code>abs</code>, <code>sign</code>, <code>sqrt</code>,<br />
<code>floor</code>, <code>ceiling</code>, <code>trunc</code>,<br />
<code>round</code>, <code>signif</code>
</p>
</li>
<li>
<p><code>exp</code>, <code>log</code>,  <code>expm1</code>, <code>log1p</code>,<br />
<code>cos</code>, <code>sin</code>, <code>tan</code>,<br />
<code>cospi</code>, <code>sinpi</code>, <code>tanpi</code>,<br />
<code>acos</code>, <code>asin</code>, <code>atan</code>
</p>
<p><code>cosh</code>, <code>sinh</code>, <code>tanh</code>,<br />
<code>acosh</code>, <code>asinh</code>, <code>atanh</code>
</p>
</li>
<li>
<p><code>lgamma</code>, <code>gamma</code>, <code>digamma</code>, <code>trigamma</code>








</p>
</li>
<li> <p><code>cumsum</code>, <code>cumprod</code>, <code>cummax</code>, <code>cummin</code>

</p>
</li></ul>

<p>Members of this group dispatch on <code>x</code>.  Most members accept
only one argument, but members <code>log</code>, <code>round</code> and
<code>signif</code> accept one or two arguments, and <code>trunc</code> accepts
one or more.
</p>
</li>
<li><p> Group <code>"Ops"</code>:
</p>

<ul>
<li>
<p><code>"+"</code>, <code>"-"</code>, <code>"*"</code>, <code>"/"</code>,
<code>"^"</code>, <code>"%%"</code>, <code>"%/%"</code>

</p>
</li>
<li> <p><code>"&amp;"</code>, <code>"|"</code>, <code>"!"</code>

</p>
</li>
<li> <p><code>"=="</code>, <code>"!="</code>,
<code>"&lt;"</code>, <code>"&lt;="</code>, <code>"&gt;="</code>, <code>"&gt;"</code>

</p>
</li></ul>

<p>This group contains both binary and unary operators (<code>+</code>,
<code>-</code> and <code>!</code>): when a unary operator is encountered the
<code>Ops</code> method is called with one argument and <code>e2</code> is
missing.
</p>
<p>The classes of both arguments are considered in dispatching any
member of this group.  For each argument its vector of classes is
examined to see if there is a matching specific (preferred) or
<code>Ops</code> method.  If a method is found for just one argument or
the same method is found for both, it is used.
If different methods are found, then the generic
<code>chooseOpsMethod()</code> is called to
pick the appropriate method. (See <code>?chooseOpsMethod</code> for
details).  If <code>chooseOpsMethod()</code> does not resolve the method,
then there is a warning about
&lsquo;incompatible methods&rsquo;: in that case or if no method is found
for either argument the internal method is used.
</p>
<p>Note that the <code><a href="#topic+data.frame">data.frame</a></code> methods for the comparison
(<code>"Compare"</code>: <code>==</code>, <code>&lt;</code>, ...) and logic
(<code>"Logic"</code>: <code>&amp;</code> <code>|</code> and <code>!</code>) operators return a
logical <code><a href="#topic+matrix">matrix</a></code> instead of a data frame, for
convenience and back compatibility.
</p>
<p>If the members of this group are called as functions, any argument
names are removed to ensure that positional matching is always used.
</p>
</li>
<li><p> Group <code>"matrixOps"</code>:
</p>

<ul>
<li> <p><code>"%*%"</code>

</p>
</li></ul>

<p>This group currently contains the matrix multiply <code>%*%</code> binary operator
only, where at least <code><a href="#topic+crossprod">crossprod</a>()</code> and <code>tcrossprod()</code>
are meant to follow.
Members of the group have the same dispatch semantics (using <em>both</em> arguments)
as the <code>Ops</code> group.
</p>
</li>
<li><p> Group <code>"Summary"</code>:
</p>

<ul>
<li> <p><code>all</code>, <code>any</code>

</p>
</li>
<li> <p><code>sum</code>, <code>prod</code>

</p>
</li>
<li> <p><code>min</code>, <code>max</code>

</p>
</li>
<li> <p><code>range</code>
</p>
</li></ul>

<p>Members of this group dispatch on the first argument supplied.
</p>
<p>Note that the <code><a href="#topic+data.frame">data.frame</a></code> methods for the
<code>"Summary"</code> and <code>"Math"</code> groups require &ldquo;numeric-alike&rdquo;
columns <code>x</code>, i.e., fulfilling </p>
<pre>
      is.numeric(x) || is.logical(x) || is.complex(x)</pre>
</li>
<li><p> Group <code>"Complex"</code>:
</p>

<ul>
<li> <p><code>Arg</code>, <code>Conj</code>, <code>Im</code>, <code>Mod</code>, <code>Re</code>

</p>
</li></ul>

<p>Members of this group dispatch on <code>z</code>.
</p>
</li></ol>

<p>Note that a method will be used for one of these groups or one of its
members <em>only</em> if it corresponds to a <code>"class"</code> attribute,
as the internal code dispatches on <code><a href="#topic+oldClass">oldClass</a></code> and not on
<code><a href="#topic+class">class</a></code>.  This is for efficiency: having to dispatch on,
say, <code>Ops.integer</code> would be too slow.
</p>
<p>The number of arguments supplied for primitive members of the
<code>"Math"</code> group generic methods is not checked prior to dispatch.
</p>
<p>There is no lazy evaluation of arguments for group-generic functions.
</p>


<h3>Technical Details</h3>

<p>These functions are all primitive and <a href="#topic+internal+20generic">internal generic</a>.
</p>
<p>The details of method dispatch and variables such as <code>.Generic</code>
are discussed in the help for <code><a href="#topic+UseMethod">UseMethod</a></code>.  There are a
few small differences:
</p>

<ul>
<li><p> For the operators of group <code>Ops</code>, the object
<code>.Method</code> is a length-two character vector with elements the
methods selected for the left and right arguments respectively.  (If
no method was selected, the corresponding element is <code>""</code>.)
</p>
</li>
<li><p> Object <code>.Group</code> records the group used for dispatch (if
a specific method is used this is <code>""</code>).
</p>
</li></ul>



<h3>Note</h3>

<p>Package <span class="pkg">methods</span> does contain objects with these names, which it
has re-used in confusing similar (but different) ways.  See the help
for that package.
</p>


<h3>References</h3>

<p>Appendix A, <em>Classes and Methods</em> of<br />
Chambers, J. M.  and Hastie, T. J. eds (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+methods">methods</a></code> for methods of non-internal generic functions.
</p>
<p><a href="methods.html#topic+S4groupGeneric">S4groupGeneric</a> for group generics for S4 methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(utils)

d.fr &lt;- data.frame(x = 1:9, y = stats::rnorm(9))
class(1 + d.fr) == "data.frame" ##-- add to d.f. ...

methods("Math")
methods("Ops")
methods("Summary")
methods("Complex")  # none in base R
</code></pre>

<hr>
<h2 id='grouping'>Grouping Permutation</h2><span id='topic+grouping'></span>

<h3>Description</h3>

<p><code>grouping</code> returns a permutation which rearranges its first
argument such that identical values are adjacent to each other.  Also
returned as attributes are the group-wise partitioning and the maximum
group size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grouping(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grouping_+3A_...">...</code></td>
<td>
<p>a sequence of numeric, character or logical
vectors, all of the same length, or a classed <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function partially sorts the elements so that identical values are
adjacent. <code>NA</code> values come last.  This is guaranteed to be
stable, so ties are preserved, and if the data are already
grouped/sorted, the grouping is unchanged.  This is useful for
aggregation and is particularly fast for character vectors.
</p>
<p>Under the covers, the <code>"radix"</code> method of <code><a href="#topic+order">order</a></code> is
used, and the same caveats apply, including restrictions on character
encodings and lack of support for <a href="#topic+long+20vectors">long vectors</a> (those with
<code class="reqn">2^{31}</code> or more elements). Real-valued numbers are slightly
rounded to account for numerical imprecision.
</p>
<p>Like <code>order</code>, for a classed <span class="rlang"><b>R</b></span> object the grouping is based on
the result of <code><a href="#topic+xtfrm">xtfrm</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"grouping"</code>, the representation of which
should be considered experimental and subject to change.  It is an
integer vector with two attributes:
</p>
<table>
<tr><td><code>ends</code></td>
<td>
<p>subscripts in the result corresponding to the last
member of each group</p>
</td></tr>
<tr><td><code>maxgrpn</code></td>
<td>
<p>the maximum group size</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+order">order</a></code>, <code><a href="#topic+xtfrm">xtfrm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(ii &lt;- grouping(x &lt;- c(1, 1, 3:1, 1:4, 3), y &lt;- c(9, 9:1), z &lt;- c(2, 1:9)))
## 6  5  2  1  7  4 10  8  3  9
rbind(x, y, z)[, ii]
</code></pre>

<hr>
<h2 id='gzcon'>
(De)compress I/O Through Connections
</h2><span id='topic+gzcon'></span>

<h3>Description</h3>

<p><code>gzcon</code> provides a modified connection that wraps an existing
connection, and decompresses reads or compresses writes through that
connection.  Standard <code>gzip</code> headers are assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gzcon(con, level = 6, allowNonCompressed = TRUE, text = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gzcon_+3A_con">con</code></td>
<td>
<p>a connection.</p>
</td></tr>
<tr><td><code id="gzcon_+3A_level">level</code></td>
<td>
<p>integer between 0 and 9, the compression level when writing.</p>
</td></tr>
<tr><td><code id="gzcon_+3A_allownoncompressed">allowNonCompressed</code></td>
<td>
<p>logical.  When reading, should
non-compressed input be allowed?</p>
</td></tr>
<tr><td><code id="gzcon_+3A_text">text</code></td>
<td>
<p>logical. Should the connection be text-oriented? This is
distinct from the mode of the connection (must always be binary).
If <code>TRUE</code>, <code><a href="#topic+pushBack">pushBack</a></code> works on the connection,
otherwise <code><a href="#topic+readBin">readBin</a></code> and friends apply.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>con</code> is open then the modified connection is opened.  Closing
the wrapper connection will also close the underlying connection.
</p>
<p>Reading from a connection which does not supply a <code>gzip</code> magic
header is equivalent to reading from the original connection if
<code>allowNonCompressed</code> is true, otherwise an error.
</p>
<p>Compressed output will contain embedded <abbr>NUL</abbr> bytes, and so <code>con</code>
is not permitted to be a <code><a href="#topic+textConnection">textConnection</a></code> opened with
<code>open = "w"</code>.  Use a writable <code><a href="#topic+rawConnection">rawConnection</a></code> to
compress data into a variable.
</p>
<p>The original connection becomes unusable: any object pointing to it will
now refer to the modified connection.  For this reason, the new
connection needs to be closed explicitly.
</p>


<h3>Value</h3>

<p>An object inheriting from class <code>"connection"</code>.  This is the same
connection <em>number</em> as supplied, but with a modified internal
structure.  It has binary mode.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gzfile">gzfile</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uncompress a data file from a URL
z &lt;- gzcon(url("https://www.stats.ox.ac.uk/pub/datasets/csb/ch12.dat.gz"))
# read.table can only read from a text-mode connection.
raw &lt;- textConnection(readLines(z))
close(z)
dat &lt;- read.table(raw)
close(raw)
dat[1:4, ]


## gzfile and gzcon can inter-work.
## Of course here one would use gzfile, but file() can be replaced by
## any other connection generator.
zzfil &lt;- tempfile(fileext = ".gz")
zz &lt;- gzfile(zzfil, "w")
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = zz, sep = "\n")
close(zz)
readLines(zz &lt;- gzcon(file(zzfil, "rb")))
close(zz)
unlink(zzfil)

zzfil2 &lt;- tempfile(fileext = ".gz")
zz &lt;- gzcon(file(zzfil2, "wb"))
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = zz, sep = "\n")
close(zz)
readLines(zz &lt;- gzfile(zzfil2))
close(zz)
unlink(zzfil2)
</code></pre>

<hr>
<h2 id='hexmode'>Integer Numbers Displayed in Hexadecimal</h2><span id='topic+as.hexmode'></span><span id='topic+format.hexmode'></span><span id='topic+print.hexmode'></span><span id='topic+as.character.hexmode'></span><span id='topic++5B.hexmode'></span><span id='topic++21.hexmode'></span><span id='topic++7C.hexmode'></span><span id='topic++26.hexmode'></span><span id='topic+hexmode'></span>

<h3>Description</h3>

<p>Integers which are displayed in hexadecimal (short &lsquo;hex&rsquo;) format,
with as many digits as are needed to display the largest, using leading
zeroes as necessary.
</p>
<p>Arithmetic works as for integers, and non-integer valued mathematical
functions typically work by truncating the result to integer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.hexmode(x)

## S3 method for class 'hexmode'
as.character(x, keepStr = FALSE, ...)

## S3 method for class 'hexmode'
format(x, width = NULL, upper.case = FALSE, ...)

## S3 method for class 'hexmode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hexmode_+3A_x">x</code></td>
<td>
<p>an object, for the methods inheriting from class <code>"hexmode"</code>.</p>
</td></tr>
<tr><td><code id="hexmode_+3A_keepstr">keepStr</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> indicating that names and
dimensions should be kept; set <code>TRUE</code> for back compatibility, if needed.</p>
</td></tr>
<tr><td><code id="hexmode_+3A_width">width</code></td>
<td>
<p><code>NULL</code> or a positive integer specifying the minimum
field width to be used, with padding by leading zeroes.</p>
</td></tr>
<tr><td><code id="hexmode_+3A_upper.case">upper.case</code></td>
<td>
<p>a logical indicating whether to use upper-case
letters or lower-case letters (default).</p>
</td></tr>
<tr><td><code id="hexmode_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Class <code>"hexmode"</code> consists of integer vectors with that class
attribute, used primarily to ensure that they are printed in hex.
Subsetting (<code><a href="#topic++5B">[</a></code>) works too, as do arithmetic or
other mathematical operations, albeit truncated to integer.
</p>
<p><code>as.character(x)</code> drops all <code><a href="#topic+attributes">attributes</a></code> (unless when
<code>keepStr=TRUE</code> where it keeps, <code>dim</code>, <code>dimnames</code> and
<code>names</code> for back compatibility) and converts each entry individually, hence with no
leading zeroes, whereas in <code>format()</code>, when <code>width = NULL</code> (the
default), the output is padded with leading zeroes to the smallest width
needed for all the non-missing elements.
</p>
<p><code>as.hexmode</code> can convert integers (of <a href="#topic+type">type</a> <code>"integer"</code> or
<code>"double"</code>) and character vectors whose elements contain only
<code>0-9</code>, <code>a-f</code>, <code>A-F</code> (or are <code>NA</code>) to class
<code>"hexmode"</code>.
</p>
<p>There is a <code><a href="#topic++21">!</a></code> method and methods for <code><a href="#topic++7C">|</a></code> and
<code><a href="#topic++26">&amp;</a></code>:


these recycle their arguments to the length of the longer and then
apply the operators bitwise to each element.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+octmode">octmode</a></code>, <code><a href="#topic+sprintf">sprintf</a></code> for other options in
converting integers to hex, <code><a href="#topic+strtoi">strtoi</a></code> to convert hex
strings to integers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>i &lt;- as.hexmode("7fffffff")
i; class(i)
identical(as.integer(i), .Machine$integer.max)

hm &lt;- as.hexmode(c(NA, 1)); hm
as.integer(hm)

Xm &lt;- as.hexmode(1:16)
Xm # print()s via format()
stopifnot(nchar(format(Xm)) == 2)
Xm[-16] # *no* leading zeroes!
stopifnot(format(Xm[-16]) == c(1:9, letters[1:6]))

## Integer arithmetic (remaining "hexmode"):
16*Xm
Xm^2
-Xm
(fac &lt;- factorial(Xm[1:12])) # !1, !2, !3, !4 .. in hexadecimals
as.integer(fac) # indeed the same as  factorial(1:12)
</code></pre>

<hr>
<h2 id='Hyperbolic'>Hyperbolic Functions</h2><span id='topic+cosh'></span><span id='topic+sinh'></span><span id='topic+tanh'></span><span id='topic+acosh'></span><span id='topic+asinh'></span><span id='topic+atanh'></span>

<h3>Description</h3>

<p>These functions give the obvious hyperbolic functions.  They
respectively compute the hyperbolic cosine, sine, tangent, and their
inverses, arc-cosine, arc-sine, arc-tangent (or &lsquo;<em>area cosine</em>&rsquo;,
etc).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosh(x)
sinh(x)
tanh(x)
acosh(x)
asinh(x)
atanh(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hyperbolic_+3A_x">x</code></td>
<td>
<p>a numeric or complex vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a> functions: methods
can be defined for them individually or via the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generic.
</p>
<p>Branch cuts are consistent with the inverse trigonometric functions
<code>asin</code> <em>et seq</em>, and agree with those defined in
Abramowitz &amp; Stegun, figure 4.7, page 86.
The behaviour actually on the cuts
follows the C99 standard which requires continuity coming round the
endpoint in a counter-clockwise direction.
</p>


<h3>S4 methods</h3>

<p>All are S4 generic functions: methods can be defined
for them individually or via the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.
</p>


<h3>References</h3>

<p>Abramowitz, M. and Stegun, I. A. (1972)
<em>Handbook of Mathematical Functions.</em> New York: Dover.<br />
Chapter 4. Elementary Transcendental Functions: Logarithmic,
Exponential, Circular and Hyperbolic Functions
</p>


<h3>See Also</h3>

<p>The trigonometric functions, <code><a href="#topic+cos">cos</a></code>, <code><a href="#topic+sin">sin</a></code>,
<code><a href="#topic+tan">tan</a></code>, and their inverses
<code><a href="#topic+acos">acos</a></code>, <code><a href="#topic+asin">asin</a></code>, <code><a href="#topic+atan">atan</a></code>.
</p>
<p>The logistic distribution function <code><a href="stats.html#topic+plogis">plogis</a></code> is a shifted
version of <code>tanh()</code> for numeric <code>x</code>.
</p>

<hr>
<h2 id='iconv'>Convert Character Vector between Encodings</h2><span id='topic+iconv'></span><span id='topic+iconvlist'></span>

<h3>Description</h3>

<p>This uses system facilities to convert a character vector between
encodings: the &lsquo;i&rsquo; stands for &lsquo;internationalization&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconv(x, from = "", to = "", sub = NA, mark = TRUE, toRaw = FALSE)

iconvlist()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iconv_+3A_x">x</code></td>
<td>
<p>a character vector, or an object to be converted to a character
vector by <code><a href="#topic+as.character">as.character</a></code>, or a list with <code>NULL</code> and
<code>raw</code> elements as returned by <code>iconv(toRaw = TRUE)</code>.</p>
</td></tr>
<tr><td><code id="iconv_+3A_from">from</code></td>
<td>
<p>a character string describing the current encoding.</p>
</td></tr>
<tr><td><code id="iconv_+3A_to">to</code></td>
<td>
<p>a character string describing the target encoding.</p>
</td></tr>
<tr><td><code id="iconv_+3A_sub">sub</code></td>
<td>
<p>character string.  If not <code>NA</code> it is used to replace
any non-convertible bytes in the input.  (This would normally be a
single character, but can be more.)  If <code>"byte"</code>, the indication is
<code>"&lt;xx&gt;"</code> with the hex code of the byte.

If <code>"Unicode"</code> and converting from UTF-8, the Unicode point in
the form <code>"&lt;U+xxxx&gt;"</code>, or if <code>c99</code>, a C99-style escape
<code>"\uxxxx"</code>. (For points in a &lsquo;supplementary plane&rsquo;,

<code>"\Uxxxxxxxx"</code> is used, with zero-padding)</p>
</td></tr>
<tr><td><code id="iconv_+3A_mark">mark</code></td>
<td>
<p>logical, for expert use.  Should encodings be marked?</p>
</td></tr>
<tr><td><code id="iconv_+3A_toraw">toRaw</code></td>
<td>
<p>logical.  Should a list of raw vectors be returned rather
than a character vector?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names of encodings and which ones are available are
platform-dependent.  All <span class="rlang"><b>R</b></span> platforms support <code>""</code> (for the
encoding of the current locale), <code>"latin1"</code> and <code>"UTF-8"</code>.
Generally case is ignored when specifying an encoding.
</p>
<p>On most platforms <code>iconvlist</code> provides an alphabetical list of
the supported encodings.  On others, the information is on the man
page for <code>iconv(5)</code> or elsewhere in the man pages (but beware
that the system command <code>iconv</code> may not support the same set of
encodings as the C functions <span class="rlang"><b>R</b></span> calls).  Unfortunately, the names are
rarely supported across all platforms.
</p>
<p>Elements of <code>x</code> which cannot be converted (perhaps because they
are invalid or because they cannot be represented in the target
encoding) will be returned as <code>NA</code> (or <code>NULL</code> for
<code>toRaw = TRUE</code>) unless <code>sub</code> is specified.
</p>
<p>Most versions of <code>iconv</code> will allow transliteration by appending
&lsquo;<span class="samp">&#8288;//TRANSLIT&#8288;</span>&rsquo; to the <code>to</code> encoding: see the examples.
</p>
<p>Encoding <code>"ASCII"</code> is accepted, and on most systems <code>"C"</code>
and <code>"POSIX"</code> are synonyms for ASCII.  Where
<code>"ASCII/TRANSLIT"</code> is unsupported by the OS, <code>"ASCII"</code> is
used with <code>sub = "c99"</code> if from UTF-8, else <code>sub =
  "?"</code>. (However, musl's version of <code>"ASCII"</code> substitutes
<code>*</code>.)
</p>
<p>Elements of <code>x</code> with a declared encoding (UTF-8 or latin1, see
<code><a href="#topic+Encoding">Encoding</a></code>) are converted from that encoding if <code>from
  = ""</code>, otherwise they are taken as being in the encoding specified by
<code>from</code>.
</p>
<p>Note that implementations of <code>iconv</code> typically do not do much
validity checking and will often mis-convert inputs which are invalid
in encoding <code>from</code>.
</p>
<p>If <code>sub = "Unicode"</code> or <code>sub = "c99"</code> is used for a
non-UTF-8 input it is the same as <code>sub = "byte"</code>.
</p>


<h3>Value</h3>

<p>If <code>toRaw = FALSE</code> (the default), the value is a character vector
of the same length and the same attributes as <code>x</code> (after
conversion to a character vector).  If conversion fails for an element
that element of the result is set to <code>NA_character_</code>.  (NB:
whether conversion fails is implementation-specific.)
<code>NA_character_</code> inputs give  <code>NA_character_</code> outputs.
</p>
<p>If <code>mark = TRUE</code> (the default) the elements of the result have a
declared encoding if <code>to</code> is <code>"latin1"</code> or <code>"UTF-8"</code>,
or if <code>to = ""</code> and the current locale's encoding is detected as
Latin-1 (or its superset CP1252 on Windows) or UTF-8.
</p>
<p>If <code>toRaw = TRUE</code>, the value is a list of the same length and
the same attributes as <code>x</code> whose elements are either <code>NULL</code>
(if conversion fails or the input was <code>NA_character_</code>) or a raw
vector.
</p>
<p>For <code>iconvlist()</code>, a character vector (typically of a few hundred
elements) of known encoding names.
</p>


<h3>Implementation Details</h3>

<p>There are three main implementations of <code>iconv</code> in use.  Linux's
most common C runtime, &lsquo;<span class="samp">&#8288;glibc&#8288;</span>&rsquo;, contains one.  Several platforms
supply versions or emulations of GNU &lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo;, including
previous versions of macOS and FreeBSD, in some cases with additional
encodings.  On Windows we use a version of Yukihiro Nakadaira's
&lsquo;<span class="samp">&#8288;win_iconv&#8288;</span>&rsquo;, which is based on Windows' codepages.  (We have
added many encoding names for compatibility with other systems.)  All
three have <code>iconvlist</code>, ignore case in encoding names and support
&lsquo;<span class="samp">&#8288;//TRANSLIT&#8288;</span>&rsquo; (but with different results, and for
&lsquo;<span class="samp">&#8288;win_iconv&#8288;</span>&rsquo; currently a &lsquo;best fit&rsquo; strategy is used except
for <code>to = "ASCII"</code>).
</p>
<p>The macOS 14 implementation is attributed to the &lsquo;Citrus
Project&rsquo;: the Apple headers declare it as &lsquo;compatible&rsquo; with GNU
&lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo; 1.11 from 2006.  However, it differs in significant
ways including using transliteration for conversions which cannot be
represented exactly in the target encoding.  (It seems this
implementation is also used in recent versions of FreeBSD.  Earlier
versions of macOS used GNU &lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo; 1.11 and some
<abbr><span class="acronym">CRAN</span></abbr> builds still do.)  For a failing
conversion macOS 14 generally translated character(s) to <code>?</code> but
14.1 gives an error (so an <code>NA</code> result in <span class="rlang"><b>R</b></span>).
</p>
<p>Most commercial Unixes contain an implementation of <code>iconv</code> but
none we have encountered have supported the encoding names we need:
the &lsquo;R Installation and Administration&rsquo; manual recommended
installing GNU &lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo; on Solaris and AIX.
</p>


<p>Some Linux distributions use &lsquo;<span class="samp">&#8288;musl&#8288;</span>&rsquo; as their C runtime.  This is
less comprehensive than &lsquo;<span class="samp">&#8288;glibc&#8288;</span>&rsquo;: it does not support
&lsquo;<span class="samp">&#8288;//TRANSLIT&#8288;</span>&rsquo; but does inexact conversions (currently using
&lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo;).
</p>
<p>There are other implementations, e.g. NetBSD has used one from the
Citrus project (which does not support &lsquo;<span class="samp">&#8288;//TRANSLIT&#8288;</span>&rsquo;) and there is
an older FreeBSD port.
</p>
<p>Note that you cannot rely on invalid inputs being detected, especially
for <code>to = "ASCII"</code> where some implementations allow 8-bit
characters and pass them through unchanged or with transliteration or
substitution.
</p>
<p>Some of the implementations have interesting extra encodings: for
example GNU &lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo; and macOS 14 allow <code>to = "C99"</code> to use
&lsquo;<span class="samp">&#8288;\uxxxx&#8288;</span>&rsquo; escapes (or if needed &lsquo;<span class="samp">&#8288;\Uuxxxxxxxx&#8288;</span>&rsquo;) for
non-ASCII characters.
</p>


<h3>Byte Order Marks</h3>

<p>most commonly known as &lsquo;<abbr>BOM</abbr>s&rsquo;.
</p>
<p>Encodings using character units which are more than one byte in size
can be written on a file in either big-endian or little-endian order:
this applies most commonly to UCS-2, UTF-16 and UTF-32/UCS-4
encodings.  Some systems will write the Unicode character
<code>U+FEFF</code> at the beginning of a file in these encodings and
perhaps also in UTF-8.  In that usage the character is known as a <abbr>BOM</abbr>,
and should be handled during input (see the &lsquo;Encodings&rsquo; section
under <code><a href="#topic+connection">connection</a></code>: re-encoded connections have some
special handling of <abbr>BOM</abbr>s).  The rest of this section applies when this
has not been done so <code>x</code> starts with a <abbr>BOM</abbr>.
</p>
<p>Implementations will generally interpret a <abbr>BOM</abbr> for <code>from</code> given
as one of <code>"UCS-2"</code>, <code>"UTF-16"</code> and
<code>"UTF-32"</code>.  Implementations differ in how they treat <abbr>BOM</abbr>s in
<code>x</code> in other <code>from</code> encodings: they may be discarded,
returned as character <code>U+FEFF</code> or regarded as invalid.
</p>


<h3>Note</h3>

<p>The most portable name for the ISO 8859-15 encoding, commonly known as
&lsquo;Latin 9&rsquo;, is <code>"iso885915"</code>: most platforms support both
<code>"latin-9"</code> and<code>"latin9"</code> but GNU &lsquo;<span class="samp">&#8288;libiconv&#8288;</span>&rsquo; does not
support the latter. &lsquo;<span class="samp">&#8288;musl&#8288;</span>&rsquo; (as used by Alpine Linux and other
lightweight Linux distributions) supports neither, but <span class="rlang"><b>R</b></span> remaps there
to <code>"iso885915"</code>.
</p>
<p>Encoding names <code>"utf8"</code>, <code>"mac"</code> and <code>"macroman"</code> are
not portable.  <code>"utf8"</code> is converted to <code>"UTF-8"</code> for
<code>from</code> and <code>to</code> by <code>iconv</code>, but not
for e.g. <code>fileEncoding</code> arguments.  <code>"macintosh"</code> is
the official (and most widely supported) name for &lsquo;Mac Roman&rsquo;
(<a href="https://en.wikipedia.org/wiki/Mac_OS_Roman">https://en.wikipedia.org/wiki/Mac_OS_Roman</a>).
</p>
<p>Using <code>sub</code> substitutes each non-convertible <em>byte</em> in the
input, so when converting from UTF-8 a non-convertible character may
be replaced by two or more bytes.  Using <code>sub = "c99"</code> or
<code>sub = "Unicode"</code> will be clearer.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+localeToCharset">localeToCharset</a></code>, <code><a href="#topic+file">file</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## In principle, as not all systems have iconvlist
try(utils::head(iconvlist(), n = 50))

## Not run: 
## convert from Latin-2 to UTF-8: two of the glibc iconv variants.
iconv(x, "ISO_8859-2", "UTF-8")
iconv(x, "LATIN2", "UTF-8")

## End(Not run)

## Both x below are in latin1 and will only display correctly in a
## locale that can represent and display latin1.
x &lt;- "fran\xE7ais"
Encoding(x) &lt;- "latin1"
x
charToRaw(xx &lt;- iconv(x, "latin1", "UTF-8"))
xx

## The results in the comments are those from glibc and GNU libiconv
iconv(x, "latin1", "ASCII")           #   NA
iconv(x, "latin1", "ASCII", "?")      # "fran?ais"
iconv(x, "latin1", "ASCII", "")       # "franais"
iconv(x, "latin1", "ASCII", "byte")   # "fran&lt;e7&gt;ais"
iconv(xx, "UTF-8", "ASCII", "Unicode")# "fran&lt;U+00E7&gt;ais"
iconv(xx, "UTF-8", "ASCII", "c99")    # "fran\\u00e7ais"

## Extracts from old R help files (they are nowadays in UTF-8)
x &lt;- c("Ekstr\xf8m", "J\xf6reskog", "bi\xdfchen Z\xfcrcher")
Encoding(x) &lt;- "latin1"
x
try(iconv(x, "latin1", "ASCII//TRANSLIT"))  # platform-dependent
## glibc gives "Ekstroem" "Joreskog" "bisschen Zurcher"
## macOS 14 gives "Ekstrom" "J\"oreskog" "bisschen Z\"urcher"
## musl gives "Ekstr*m" "J*reskog" "bi*chen Z*rcher"
iconv(x, "latin1", "ASCII", sub = "byte")

## and for Windows' 'Unicode'
str(xx &lt;- iconv(x, "latin1", "UTF-16LE", toRaw = TRUE))
iconv(xx, "UTF-16LE", "UTF-8")

emoji &lt;- "\U0001f604"
iconv(emoji,, "latin1", sub = "Unicode") # "&lt;U+1F604&gt;"
iconv(emoji,, "latin1", sub = "c99")
</code></pre>

<hr>
<h2 id='icuSetCollate'> Setup Collation by ICU </h2><span id='topic+icuSetCollate'></span><span id='topic+icuGetCollate'></span><span id='topic+R_ICU_LOCALE'></span>

<h3>Description</h3>

<p>Controls the way collation is done by ICU (an optional part of the <span class="rlang"><b>R</b></span>
build).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icuSetCollate(...)

icuGetCollate(type = c("actual", "valid"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icuSetCollate_+3A_...">...</code></td>
<td>
<p>named arguments, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="icuSetCollate_+3A_type">type</code></td>
<td>
<p>a character string: either the <code>"actual"</code> locale
in use for collation, or the most specific locale which would be
<code>"valid"</code>.  Can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optionally, <span class="rlang"><b>R</b></span> can be built to collate character strings by ICU
(<a href="https://icu.unicode.org/">https://icu.unicode.org/</a>).  For such systems,
<code>icuSetCollate</code> can be used to tune the way collation is done.
On other builds calling this function does nothing, with a warning.
</p>
<p>Possible arguments are
</p>

<dl>
<dt><code>locale</code>:</dt><dd><p>A character string such as <code>"da_DK"</code>
giving the language and country whose collation rules are to be
used.  If present, this should be the first argument.</p>
</dd>
<dt><code>case_first</code>:</dt><dd><p><code>"upper"</code>, <code>"lower"</code> or
<code>"default"</code>, asking for upper- or lower-case characters to be
sorted first.  The default is usually lower-case first, but not in
all languages (not under the default settings for Danish, for example).</p>
</dd>
<dt><code>alternate_handling</code>:</dt><dd><p>Controls the handling of
&lsquo;variable&rsquo; characters (mainly punctuation and symbols).
Possible values are <code>"non_ignorable"</code> (primary strength) and
<code>"shifted"</code> (quaternary strength).</p>
</dd>
<dt><code>strength</code>:</dt><dd><p>Which components should be used?  Possible
values <code>"primary"</code>, <code>"secondary"</code>, <code>"tertiary"</code>
(default), <code>"quaternary"</code> and <code>"identical"</code>. </p>
</dd>
<dt><code>french_collation</code>:</dt><dd><p>In a French locale the way accents
affect collation is from right to left, whereas in most other locales
it is from left to right.  Possible values <code>"on"</code>, <code>"off"</code>
and <code>"default"</code>.</p>
</dd>
<dt><code>normalization</code>:</dt><dd><p>Should strings be normalized?  Possible values
are <code>"on"</code> and <code>"off"</code> (default).  This affects the
collation of composite characters.</p>
</dd>
<dt><code>case_level</code>:</dt><dd><p>An additional level between secondary and
tertiary, used to distinguish large and small Japanese Kana
characters. Possible values <code>"on"</code> and <code>"off"</code> (default).</p>
</dd>
<dt><code>hiragana_quaternary</code>:</dt><dd><p>Possible values <code>"on"</code> (sort
Hiragana first at quaternary level) and <code>"off"</code>.</p>
</dd>
</dl>

<p>Only the first three are likely to be of interest except to those with a
detailed understanding of collation and specialized requirements.
</p>
<p>Some special values are accepted for <code>locale</code>:
</p>

<dl>
<dt><code>"none"</code>:</dt><dd><p>ICU is not used for collation: the OS's
collation services are used instead.</p>
</dd>
<dt><code>"ASCII"</code>:</dt><dd><p>ICU is not used for collation: the C function
<code>strcmp</code> is used instead, which should sort byte-by-byte in
(unsigned) numerical order.</p>
</dd>
<dt><code>"default"</code>:</dt><dd>
<p>obtains the locale from the OS as is done at the start of the
session (except on Windows).  If environment variable
<span class="env">R_ICU_LOCALE</span> is set to a non-empty value, its value is used
rather than consulting the OS, unless environment variable
<span class="env">LC_ALL</span> is set to 'C' (or unset but <span class="env">LC_COLLATE</span> is set to
'C'). 
</p>
</dd>
<dt><code>""</code>, <code>"root"</code>:</dt><dd>
<p>the &lsquo;root&rsquo; collation: see
<a href="https://www.unicode.org/reports/tr35/tr35-collation.html#Root_Collation">https://www.unicode.org/reports/tr35/tr35-collation.html#Root_Collation</a>.
</p>
</dd>
</dl>

<p>For the specifications of &lsquo;real&rsquo; ICU locales, see
<a href="https://unicode-org.github.io/icu/userguide/locale/">https://unicode-org.github.io/icu/userguide/locale/</a>.  Note that ICU does not
report that a locale is not supported, but falls back to its idea of
&lsquo;best fit&rsquo; (which could be rather different and is reported by
<code>icuGetCollate("actual")</code>, often <code>"root"</code>).  Most English
locales fall back to <code>"root"</code> as although e.g. <code>"en_GB"</code> is
a valid locale (at least on some platforms), it contains no special
rules for collation.  Note that <code>"C"</code> is not a supported ICU locale
and hence <span class="env">R_ICU_LOCALE</span> should never be set to <code>"C"</code>.
</p>
<p>Some examples are <code>case_level = "on", strength = "primary"</code> to ignore
accent differences and <code>alternate_handling = "shifted"</code> to ignore
space and punctuation characters.
</p>
<p>Initially ICU will not be used for collation if the OS is set to use the
<code>C</code> locale for collation and <span class="env">R_ICU_LOCALE</span> is not set.  Once
this function is called with a value for <code>locale</code>, ICU will be used
until it is called again with <code>locale = "none"</code>.  ICU will not be
used once <code>Sys.setlocale</code> is called with a <code>"C"</code> value for
<code>LC_ALL</code> or <code>LC_COLLATE</code>, even if <span class="env">R_ICU_LOCALE</span> is set. 
ICU will be used again honoring <span class="env">R_ICU_LOCALE</span> once
<code>Sys.setlocale</code> is called to set a different collation order. 
Environment variables <span class="env">LC_ALL</span> (or <span class="env">LC_COLLATE</span>) take precedence
over <span class="env">R_ICU_LOCALE</span> if and only if they are set to 'C'.  Due to the
interaction with other ways of setting the collation order,
<span class="env">R_ICU_LOCALE</span> should be used with care and only when needed.
</p>
<p>All customizations are reset to the default for the locale if
<code>locale</code> is specified: the collation engine is reset if the
OS collation locate category is changed by <code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code>.
</p>


<h3>Value</h3>

<p>For <code>icuGetCollate</code>, a character string describing the ICU locale
in use (which may be reported as <code>"ICU not in use"</code>).  The
&lsquo;actual&rsquo; locale may be simpler than the requested locale: for
example <code>"da"</code> rather than <code>"da_DK"</code>: English locales are
likely to report <code>"root"</code>.
</p>


<h3>Note</h3>

<p>Except on Windows, ICU is used by default wherever it is available.
As it works internally in UTF-8, it will be most efficient in UTF-8
locales.
</p>
<p>On Windows, <span class="rlang"><b>R</b></span> is normally built including ICU, but it will only be
used if environment variable <span class="env">R_ICU_LOCALE</span> had been set when <span class="rlang"><b>R</b></span>
is started or after <code>icuSetCollate</code> is called to select the
locale (as ICU and Windows differ in their idea of locale names).
Note that <code>icuSetCollate(locale = "default")</code> should work
reasonably well, but finds the system default ignoring environment
variables such as <span class="env">LC_COLLATE</span>.
</p>


<h3>See Also</h3>

<p><a href="#topic+Comparison">Comparison</a>, <code><a href="#topic+sort">sort</a></code>.
</p>
<p><code><a href="#topic+capabilities">capabilities</a></code> for whether ICU is available;
<code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for its version.
</p>
<p>The ICU user guide chapter on collation
(<a href="https://unicode-org.github.io/icu/userguide/collation/">https://unicode-org.github.io/icu/userguide/collation/</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## These examples depend on having ICU available, and on the locale.
## As we don't know the current settings, we can only reset to the default.
if(capabilities("ICU")) withAutoprint({
    icuGetCollate()
    icuGetCollate("valid")
    x &lt;- c("Aarhus", "aarhus", "safe", "test", "Zoo")
    sort(x)
    icuSetCollate(case_first = "upper"); sort(x)
    icuSetCollate(case_first = "lower"); sort(x)

    ## Danish collates upper-case-first and with 'aa' as a single letter
    icuSetCollate(locale = "da_DK", case_first = "default"); sort(x) 
    ## Estonian collates Z between S and T
    icuSetCollate(locale = "et_EE"); sort(x)
    icuSetCollate(locale = "default"); icuGetCollate("valid")
})
</code></pre>

<hr>
<h2 id='identical'>Test Objects for Exact Equality</h2><span id='topic+identical'></span>

<h3>Description</h3>

<p>The safe and reliable way to test two objects for being
<em>exactly</em> equal.  It returns <code>TRUE</code> in this case,
<code>FALSE</code> in every other case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identical(x, y, num.eq = TRUE, single.NA = TRUE, attrib.as.set = TRUE,
          ignore.bytecode = TRUE, ignore.environment = FALSE,
          ignore.srcref = TRUE, extptr.as.ref = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identical_+3A_x">x</code>, <code id="identical_+3A_y">y</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> objects.</p>
</td></tr>
<tr><td><code id="identical_+3A_num.eq">num.eq</code></td>
<td>
<p>logical indicating if (<code><a href="#topic+double">double</a></code> and
<code><a href="#topic+complex">complex</a></code> non-<code><a href="#topic+NA">NA</a></code>) numbers should be
compared using <code><a href="#topic++3D+3D">==</a></code> (&lsquo;equal&rsquo;), or by bitwise
comparison.  The latter (non-default) differentiates between
<code>-0</code> and <code>+0</code>.</p>
</td></tr>
<tr><td><code id="identical_+3A_single.na">single.NA</code></td>
<td>
<p>logical indicating if there is conceptually just one numeric
<code><a href="#topic+NA">NA</a></code> and one <code><a href="#topic+NaN">NaN</a></code>;  <code>single.NA = FALSE</code>
differentiates bit patterns.</p>
</td></tr>
<tr><td><code id="identical_+3A_attrib.as.set">attrib.as.set</code></td>
<td>
<p>logical indicating if <code><a href="#topic+attributes">attributes</a></code> of
<code>x</code> and <code>y</code> should be treated as <em>unordered</em> tagged
pairlists (&ldquo;sets&rdquo;); this currently also applies to
<code><a href="methods.html#topic+slot">slot</a></code>s of S4 objects.  It may well be too strict to set
<code>attrib.as.set = FALSE</code>.</p>
</td></tr>
<tr><td><code id="identical_+3A_ignore.bytecode">ignore.bytecode</code></td>
<td>
<p>logical indicating if byte code should be
ignored when comparing <a href="#topic+closure">closure</a>s.</p>
</td></tr>
<tr><td><code id="identical_+3A_ignore.environment">ignore.environment</code></td>
<td>
<p>logical indicating if their environments
should be ignored when comparing <a href="#topic+closure">closure</a>s.</p>
</td></tr>
<tr><td><code id="identical_+3A_ignore.srcref">ignore.srcref</code></td>
<td>
<p>logical indicating if their <code>"srcref"</code>
attributes should be ignored when comparing <a href="#topic+closure">closure</a>s.</p>
</td></tr>
<tr><td><code id="identical_+3A_extptr.as.ref">extptr.as.ref</code></td>
<td>
<p>logical indicating whether external pointer
objects should be compared as reference objects and considered
identical only if they are the same object in memory. By default,
external pointers are considered identical if the addresses they
contain are identical.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A call to <code>identical</code> is the way to test exact equality in
<code>if</code> and <code>while</code> statements, as well as in logical
expressions that use <code>&amp;&amp;</code> or <code>||</code>.  In all these
applications you need to be assured of getting a single logical
value.
</p>
<p>Users often use the comparison operators, such as <code>==</code> or
<code>!=</code>, in these situations.  It looks natural, but it is not what
these operators are designed to do in <span class="rlang"><b>R</b></span>.  They return an object like
the arguments.  If you expected <code>x</code> and <code>y</code> to be of length
1, but it happened that one of them was not, you will <em>not</em> get a
single <code>FALSE</code>.  Similarly, if one of the arguments is <code>NA</code>,
the result is also <code>NA</code>.  In either case, the expression
<code>if(x == y)....</code> won't work as expected.
</p>
<p>The function <code>all.equal</code> is also sometimes used to test equality
this way, but was intended for something different:  it allows for
small differences in numeric results.
</p>
<p>The computations in <code>identical</code> are also reliable and usually
fast.  There should never be an error.  The only known way to kill
<code>identical</code> is by having an invalid pointer at the C level,
generating a memory fault.  It will usually find inequality quickly.
Checking equality for two large, complicated objects can take longer
if the objects are identical or nearly so, but represent completely
independent copies.  For most applications, however, the computational cost
should be negligible.
</p>
<p>If <code>single.NA</code> is true, as by default, <code>identical</code> sees
<code><a href="#topic+NaN">NaN</a></code> as different from <code><a href="#topic+NA_real_">NA_real_</a></code>, but all
<code>NaN</code>s are equal (and all <code>NA</code> of the same type are equal).
</p>
<p>Character strings (except those in marked encoding <code>"bytes"</code>) are
regarded as identical even if they are in different marked encodings but
would agree when translated to UTF-8. A character string in marked encoding
<code>"bytes"</code> is only regarded as identical to a character string in the
same encoding and with the same content.
</p>
<p>If <code>attrib.as.set</code> is true, as by default, comparison of
attributes view them as a set (and not a vector, so order is not
tested).
</p>
<p>If <code>ignore.bytecode</code> is true (the default), the compiled
bytecode of a function (see <code><a href="compiler.html#topic+cmpfun">cmpfun</a></code>) will be ignored in
the comparison.  If it is false, functions will compare equal only if
they are copies of the same compiled object (or both are
uncompiled).  To check whether two different compiles are equal, you
should compare the results of <code><a href="compiler.html#topic+disassemble">disassemble</a>()</code>.
</p>
<p>You almost never want to use <code>identical</code> on datetimes of class
<code>"POSIXlt"</code>: not only can different times in the different
time zones represent the same time and time zones have multiple names,
but several of the components are optional.
</p>
<p>Note that the strictest test for equality is
</p>
<pre>
    identical(x, y,
              num.eq = FALSE, single.NA = FALSE, attrib.as.set = FALSE,
              ignore.bytecode = FALSE, ignore.environment = FALSE,
              ignore.srcref = FALSE, extptr.as.ref = TRUE)
</pre>


<h3>Value</h3>

<p>A single logical value, <code>TRUE</code> or <code>FALSE</code>, never <code>NA</code>
and never anything other than a single value.
</p>


<h3>Author(s)</h3>

<p>John Chambers and R Core</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all.equal">all.equal</a></code> for descriptions of how two objects differ;
<code><a href="#topic+Comparison">Comparison</a></code> and <code><a href="#topic+Logic">Logic</a></code> for elementwise comparisons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>identical(1, NULL) ## FALSE -- don't try this with ==
identical(1, 1.)   ## TRUE in R (both are stored as doubles)
identical(1, as.integer(1)) ## FALSE, stored as different types

x &lt;- 1.0; y &lt;- 0.99999999999
## how to test for object equality allowing for numeric fuzz :
(E &lt;- all.equal(x, y))
identical(TRUE, E)
isTRUE(E) # alternative test
## If all.equal thinks the objects are different, it returns a
## character string, and the above expression evaluates to FALSE

## even for unusual R objects :
identical(.GlobalEnv, environment())

### ------- Pickyness Flags : -----------------------------

## the infamous example:
identical(0., -0.) # TRUE, i.e. not differentiated
identical(0., -0., num.eq = FALSE)
## similar:
identical(NaN, -NaN) # TRUE
identical(NaN, -NaN, single.NA = FALSE) # differ on bit-level

### For functions ("closure"s): ----------------------------------------------
###     ~~~~~~~~~
f &lt;- function(x) x
f
g &lt;- compiler::cmpfun(f)
g
identical(f, g)                        # TRUE, as bytecode is ignored by default
identical(f, g, ignore.bytecode=FALSE) # FALSE: bytecode differs

## GLM families contain several functions, some of which share an environment:
p1 &lt;- poisson() ; p2 &lt;- poisson()
identical(p1, p2)                          # FALSE
identical(p1, p2, ignore.environment=TRUE) # TRUE

## in interactive use, the 'keep.source' option is typically true:
op &lt;- options(keep.source = TRUE) # and so, these have differing "srcref" :
f1 &lt;- function() {}
f2 &lt;- function() {}
identical(f1,f2)# ignore.srcref= TRUE : TRUE
identical(f1,f2,  ignore.srcref=FALSE)# FALSE
options(op) # revert to previous state


</code></pre>

<hr>
<h2 id='identity'>Identity Function</h2><span id='topic+identity'></span>

<h3>Description</h3>

<p>A trivial identity function returning its argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identity(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identity_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+diag">diag</a></code> creates diagonal matrices, including identity ones.
</p>

<hr>
<h2 id='ifelse'>Conditional Element Selection</h2><span id='topic+ifelse'></span>

<h3>Description</h3>

<p><code>ifelse</code> returns a value with the same shape as
<code>test</code> which is filled with elements selected
from either <code>yes</code> or <code>no</code>
depending on whether the element of <code>test</code>
is <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifelse(test, yes, no)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifelse_+3A_test">test</code></td>
<td>
<p>an object which can be coerced to logical mode.</p>
</td></tr>
<tr><td><code id="ifelse_+3A_yes">yes</code></td>
<td>
<p>return values for true elements of <code>test</code>.</p>
</td></tr>
<tr><td><code id="ifelse_+3A_no">no</code></td>
<td>
<p>return values for false elements of <code>test</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>yes</code> or <code>no</code> are too short, their elements are recycled.
<code>yes</code> will be evaluated if and only if any element of <code>test</code>
is true, and analogously for <code>no</code>.
</p>
<p>Missing values in <code>test</code> give missing values in the result.
</p>


<h3>Value</h3>

<p>A vector of the same length and attributes (including dimensions and
<code>"class"</code>) as <code>test</code> and data values from the values of
<code>yes</code> or <code>no</code>.  The mode of the answer will be coerced from
logical to accommodate first any values taken from <code>yes</code> and then
any values taken from <code>no</code>.
</p>


<h3>Warning</h3>

<p>The mode of the result may depend on the value of <code>test</code> (see the
examples), and the class attribute (see <code><a href="#topic+oldClass">oldClass</a></code>) of the
result is taken from <code>test</code> and may be inappropriate for the
values selected from <code>yes</code> and <code>no</code>.
</p>
<p>Sometimes it is better to use a construction such as
</p>
<pre>  (tmp &lt;- yes; tmp[!test] &lt;- no[!test]; tmp)
</pre><p>, possibly extended to handle missing values in <code>test</code>.
</p>
<p>Further note that <code>if(test) yes else no</code>  is much more efficient
and often much preferable to <code>ifelse(test, yes, no)</code> whenever
<code>test</code> is a simple true/false result, i.e., when
<code>length(test) == 1</code>.
</p>
<p>The <code>srcref</code> attribute of functions is handled specially: if
<code>test</code> is a simple true result and <code>yes</code> evaluates to a function
with <code>srcref</code> attribute, <code>ifelse</code> returns <code>yes</code> including
its attribute (the same applies to a false <code>test</code> and <code>no</code>
argument).  This functionality is only for backwards compatibility, the
form <code>if(test) yes else no</code> should be used whenever <code>yes</code> and
<code>no</code> are functions.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+if">if</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(6:-4)
sqrt(x)  #- gives warning
sqrt(ifelse(x &gt;= 0, x, NA))  # no warning

## Note: the following also gives the warning !
ifelse(x &gt;= 0, sqrt(x), NA)


## ifelse() strips attributes
## This is important when working with Dates and factors
x &lt;- seq(as.Date("2000-02-29"), as.Date("2004-10-04"), by = "1 month")
## has many "yyyy-mm-29", but a few "yyyy-03-01" in the non-leap years
y &lt;- ifelse(as.POSIXlt(x)$mday == 29, x, NA)
head(y) # not what you expected ... ==&gt; need restore the class attribute:
class(y) &lt;- class(x)
y
## This is a (not atypical) case where it is better *not* to use ifelse(),
## but rather the more efficient and still clear:
y2 &lt;- x
y2[as.POSIXlt(x)$mday != 29] &lt;- NA
## which gives the same as ifelse()+class() hack:
stopifnot(identical(y2, y))


## example of different return modes (and 'test' alone determining length):
yes &lt;- 1:3
no  &lt;- pi^(1:4)
utils::str( ifelse(NA,    yes, no) ) # logical, length 1
utils::str( ifelse(TRUE,  yes, no) ) # integer, length 1
utils::str( ifelse(FALSE, yes, no) ) # double,  length 1
</code></pre>

<hr>
<h2 id='integer'>Integer Vectors</h2><span id='topic+integer'></span><span id='topic+as.integer'></span><span id='topic+is.integer'></span>

<h3>Description</h3>

<p>Creates or tests for objects of type <code>"integer"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integer(length = 0)
as.integer(x, ...)
is.integer(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integer_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.
Double values will be coerced to integer:
supplying an argument of length other than one is an error.</p>
</td></tr>
<tr><td><code id="integer_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="integer_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Integer vectors exist so that data can be passed to C or Fortran code
which expects them, and so that (small) integer data can be represented
exactly and compactly.
</p>
<p>Note that current implementations of <span class="rlang"><b>R</b></span> use 32-bit integers for
integer vectors, so the range of representable integers is restricted
to about <code class="reqn">\pm 2 \times 10^9</code>: <code><a href="#topic+double">double</a></code>s can
hold much larger integers exactly.
</p>


<h3>Value</h3>

<p><code>integer</code> creates a integer vector of the specified length.
Each element of the vector is equal to <code>0</code>.
</p>
<p><code>as.integer</code> attempts to coerce its argument to be of integer
type.  The answer will be <code>NA</code> unless the coercion succeeds.  Real
values larger in modulus than the largest integer are coerced to
<code>NA</code> (unlike S which gives the most extreme integer of the same
sign).  Non-integral numeric values are truncated towards zero (i.e.,
<code>as.integer(x)</code> equals <code><a href="#topic+trunc">trunc</a>(x)</code> there), and
imaginary parts of complex numbers are discarded (with a warning).
Character strings containing optional whitespace followed by either a
decimal representation or a hexadecimal representation (starting with
<code>0x</code> or <code>0X</code>) can be converted, as well as any allowed by
the platform for real numbers.  Like <code><a href="#topic+as.vector">as.vector</a></code> it strips
attributes including names.  (To ensure that an object <code>x</code> is of
integer type without stripping attributes, use
<code><a href="#topic+storage.mode">storage.mode</a>(x) &lt;- "integer"</code>.)
</p>
<p><code>is.integer</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is of integer <a href="#topic+type">type</a> or not, unless it is a
factor when it returns <code>FALSE</code>.
</p>


<h3>Note</h3>

<p><code>is.integer(x)</code> does <b>not</b> test if <code>x</code> contains integer
numbers!  For that, use <code><a href="#topic+round">round</a></code>, as in the function
<code>is.wholenumber(x)</code> in the examples.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+numeric">numeric</a></code>, <code><a href="#topic+storage.mode">storage.mode</a></code>.
</p>
<p><code><a href="#topic+round">round</a></code> (and <code>ceiling</code> and <code>floor</code> on that help
page) to convert to integral values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## as.integer() truncates:
x &lt;- pi * c(-1:1, 10)
as.integer(x)

is.integer(1) # is FALSE !

is.wholenumber &lt;-
    function(x, tol = .Machine$double.eps^0.5)  abs(x - round(x)) &lt; tol
is.wholenumber(1) # is TRUE
(x &lt;- seq(1, 5, by = 0.5) )
is.wholenumber( x ) #--&gt;  TRUE FALSE TRUE ...
</code></pre>

<hr>
<h2 id='interaction'>Compute Factor Interactions</h2><span id='topic+interaction'></span>

<h3>Description</h3>

<p><code>interaction</code> computes a factor which represents the interaction
of the given factors.  The result of <code>interaction</code> is always unordered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interaction(..., drop = FALSE, sep = ".", lex.order = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interaction_+3A_...">...</code></td>
<td>
<p>the factors for which interaction is to be computed, or a
single list giving those factors.</p>
</td></tr>
<tr><td><code id="interaction_+3A_drop">drop</code></td>
<td>
<p>if <code>drop</code> is <code>TRUE</code>, unused factor levels
are dropped from the result.  The default is to retain all
factor levels.</p>
</td></tr>
<tr><td><code id="interaction_+3A_sep">sep</code></td>
<td>
<p>string to construct the new level labels by joining the
constituent ones.</p>
</td></tr>
<tr><td><code id="interaction_+3A_lex.order">lex.order</code></td>
<td>
<p>logical indicating if the order of factor concatenation
should be lexically ordered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A factor which represents the interaction of the given factors.
The levels are labelled as the levels of the individual factors joined
by <code>sep</code> which is <code>.</code> by default.
</p>
<p>By default, when <code>lex.order = FALSE</code>, the levels are ordered so
the level of the first factor varies fastest, then the second and so
on.  This is the reverse of lexicographic ordering (which you can get
by  <code>lex.order = TRUE</code>), and differs from
<code><a href="#topic++3A">:</a></code>.  (It is done this way for compatibility with S.)
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+factor">factor</a></code>;
<code><a href="#topic++3A">:</a></code> where <code>f:g</code> is similar to
<code>interaction(f, g, sep = ":")</code> when <code>f</code> and  <code>g</code> are factors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- gl(2, 4, 8)
b &lt;- gl(2, 2, 8, labels = c("ctrl", "treat"))
s &lt;- gl(2, 1, 8, labels = c("M", "F"))
interaction(a, b)
interaction(a, b, s, sep = ":")
stopifnot(identical(a:s,
                    interaction(a, s, sep = ":", lex.order = TRUE)),
          identical(a:s:b,
                    interaction(a, s, b, sep = ":", lex.order = TRUE)))
</code></pre>

<hr>
<h2 id='interactive'>Is R Running Interactively?</h2><span id='topic+interactive'></span>

<h3>Description</h3>

<p>Return <code>TRUE</code> when <span class="rlang"><b>R</b></span> is being used interactively and
<code>FALSE</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interactive()
</code></pre>


<h3>Details</h3>

<p>An interactive <span class="rlang"><b>R</b></span> session is one in which it is assumed that there is
a human operator to interact with, so for example <span class="rlang"><b>R</b></span> can prompt for
corrections to incorrect input or ask what to do next or if it is OK
to move to the next plot.
</p>
<p>GUI consoles will arrange to start <span class="rlang"><b>R</b></span> in an interactive session.  When
<span class="rlang"><b>R</b></span> is run in a terminal (via <code>Rterm.exe</code> on Windows), it
assumes that it is interactive if &lsquo;<span class="file">stdin</span>&rsquo; is connected to a
(pseudo-)terminal and not if &lsquo;<span class="file">stdin</span>&rsquo; is redirected to a file or
pipe.  Command-line options <span class="option">--interactive</span> (Unix) and
<span class="option">--ess</span> (Windows, <code>Rterm.exe</code>) override the default
assumption.
(On a Unix-alike, whether the <code>readline</code> command-line editor is
used is <strong>not</strong> overridden by <span class="option">--interactive</span>.)
</p>
<p>Embedded uses of <span class="rlang"><b>R</b></span> can set a session to be interactive or not.
</p>
<p>Internally, whether a session is interactive determines
</p>

<ul>
<li><p> how some errors are handled and reported, e.g. see
<code><a href="#topic+stop">stop</a></code> and <code><a href="#topic+options">options</a>("showWarnCalls")</code>.
</p>
</li>
<li><p>  whether one of <span class="option">--save</span>, <span class="option">--no-save</span> or
<span class="option">--vanilla</span> is required, and if <span class="rlang"><b>R</b></span> ever asks whether to save the
workspace.
</p>
</li>
<li><p> the choice of default graphics device launched when needed and
by <code><a href="grDevices.html#topic+dev.new">dev.new</a></code>: see <code><a href="#topic+options">options</a>("device")</code>
</p>
</li>
<li><p> whether graphics devices ever ask for confirmation of a new
page.
</p>
</li></ul>

<p>In addition, <span class="rlang"><b>R</b></span>'s own <span class="rlang"><b>R</b></span> code makes use of <code>interactive()</code>: for
example <code><a href="utils.html#topic+help">help</a></code>, <code><a href="utils.html#topic+debugger">debugger</a></code> and
<code><a href="utils.html#topic+install.packages">install.packages</a></code> do.
</p>


<h3>Note</h3>

<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+source">source</a></code>,
<code><a href="#topic+.First">.First</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> .First &lt;- function() if(interactive()) x11()
</code></pre>

<hr>
<h2 id='Internal'>Call an Internal Function</h2><span id='topic+.Internal'></span>

<h3>Description</h3>

<p><code>.Internal</code> performs a call to an internal code
which is built in to the <span class="rlang"><b>R</b></span> interpreter.
</p>
<p>Only true <span class="rlang"><b>R</b></span> wizards should even consider using this function, and only
<span class="rlang"><b>R</b></span> developers can add to the list of internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> .Internal(call)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Internal_+3A_call">call</code></td>
<td>
<p>a call expression</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+.Primitive">.Primitive</a></code>, <code><a href="#topic+.External">.External</a></code> (the nearest
equivalent available to  users).
</p>

<hr>
<h2 id='InternalMethods'>Internal Generic Functions</h2><span id='topic+InternalMethods'></span><span id='topic+InternalGenerics'></span><span id='topic+internal+20generic'></span><span id='topic+.S3PrimitiveGenerics'></span><span id='topic+.internalGenerics'></span>

<h3>Description</h3>

<p>Many <span class="rlang"><b>R</b></span>-internal functions are <em>generic</em> and allow
methods to be written for.
</p>


<h3>Details</h3>

<p>The following primitive and internal functions are <em>generic</em>,
i.e., you can write <code><a href="utils.html#topic+methods">methods</a></code> for them:
</p>

<p><code><a href="#topic++5B">[</a></code>,

<code><a href="#topic++5B+5B">[[</a></code>,

<code><a href="#topic++24">$</a></code>,

<code><a href="#topic++5B+3C-">[&lt;-</a></code>,

<code><a href="#topic++5B+5B+3C-">[[&lt;-</a></code>,

<code><a href="#topic++24+3C-">$&lt;-</a></code>,
</p>

<p><code><a href="#topic+length">length</a></code>,

<code><a href="#topic+length+3C-">length&lt;-</a></code>,

<code><a href="#topic+lengths">lengths</a></code>,

<code><a href="#topic+dimnames">dimnames</a></code>,

<code><a href="#topic+dimnames+3C-">dimnames&lt;-</a></code>,

<code><a href="#topic+dim">dim</a></code>,

<code><a href="#topic+dim+3C-">dim&lt;-</a></code>,

<code><a href="#topic+names">names</a></code>,

<code><a href="#topic+names+3C-">names&lt;-</a></code>,

<code><a href="#topic+levels+3C-">levels&lt;-</a></code>,

<code><a href="#topic++40">@</a></code>,

<code><a href="#topic++40+3C-">@&lt;-</a></code>,
</p>

<p><code><a href="#topic+c">c</a></code>,

<code><a href="#topic+unlist">unlist</a></code>,
<code><a href="#topic+cbind">cbind</a></code>,
<code><a href="#topic+rbind">rbind</a></code>,
</p>

<p><code><a href="#topic+as.character">as.character</a></code>,

<code><a href="#topic+as.complex">as.complex</a></code>,

<code><a href="#topic+as.double">as.double</a></code>,

<code><a href="#topic+as.integer">as.integer</a></code>,

<code><a href="#topic+as.logical">as.logical</a></code>,

<code><a href="#topic+as.raw">as.raw</a></code>,

<code><a href="#topic+as.vector">as.vector</a></code>,

<code><a href="#topic+as.call">as.call</a></code>,

<code><a href="#topic+as.environment">as.environment</a></code>

<code><a href="#topic+is.array">is.array</a></code>,

<code><a href="#topic+is.matrix">is.matrix</a></code>,

<code><a href="#topic+is.na">is.na</a></code>,

<code><a href="#topic+anyNA">anyNA</a></code>,

<code><a href="#topic+is.nan">is.nan</a></code>,

<code><a href="#topic+is.finite">is.finite</a></code>

<code><a href="#topic+is.infinite">is.infinite</a></code>

<code><a href="#topic+is.numeric">is.numeric</a></code>,

<code><a href="#topic+nchar">nchar</a></code>

<code><a href="#topic+rep">rep</a></code>,

<code><a href="#topic+rep.int">rep.int</a></code>

<code><a href="#topic+rep_len">rep_len</a></code>

<code><a href="#topic+seq.int">seq.int</a></code>
(which dispatches methods for <code>"seq"</code>),

<code><a href="#topic+is.unsorted">is.unsorted</a></code>
and

<code><a href="#topic+xtfrm">xtfrm</a></code>
</p>
<p>In addition, <code>is.name</code> is a synonym for <code><a href="#topic+is.symbol">is.symbol</a></code> and
dispatches methods for the latter.  Similarly, <code><a href="#topic+as.numeric">as.numeric</a></code>
is a synonym for <code>as.double</code> and dispatches methods for the
latter, i.e., S3 methods are for <code>as.double</code>, whereas S4 methods
are to be written for <code>as.numeric</code>.
</p>
<p>Note that all of the <a href="#topic+group+20generic">group generic</a> functions are also
internal/primitive and allow methods to be written for them.
</p>
<p><code>.S3PrimitiveGenerics</code> is a character vector listing the
primitives which are internal generic and not <a href="#topic+group+20generic">group generic</a>,
(not only for S3 but also S4).
Similarly, the <code>.internalGenerics</code> character vector contains the names
of the internal (via <code><a href="#topic+.Internal">.Internal</a>(..)</code>) non-primitive functions
which are internally generic.
</p>


<h3>Note</h3>

<p>For efficiency, internal dispatch only occurs on <em>objects</em>, that
is those for which <code><a href="#topic+is.object">is.object</a></code> returns true.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+methods">methods</a></code> for the methods which are available.
</p>

<hr>
<h2 id='invisible'>Change the Print Mode to Invisible</h2><span id='topic+invisible'></span>

<h3>Description</h3>

<p>Return a (temporarily) invisible copy of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invisible(x = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invisible_+3A_x">x</code></td>
<td>
<p>an arbitrary <span class="rlang"><b>R</b></span> object, by default <code><a href="#topic+NULL">NULL</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be useful when it is desired to have functions
return values which can be assigned, but which do not print when they
are not assigned.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+withVisible">withVisible</a></code>,
<code><a href="#topic+return">return</a></code>,
<code><a href="#topic+function">function</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># These functions both return their argument
f1 &lt;- function(x) x
f2 &lt;- function(x) invisible(x)
f1(1)  # prints
f2(1)  # does not
</code></pre>

<hr>
<h2 id='is.finite'>Finite, Infinite and NaN Numbers</h2><span id='topic+is.finite'></span><span id='topic+is.infinite'></span><span id='topic+Inf'></span><span id='topic+NaN'></span><span id='topic+is.nan'></span><span id='topic+finite'></span><span id='topic+infinite'></span>

<h3>Description</h3>

<p><code>is.finite</code> and <code>is.infinite</code> return a vector of the same
length as <code>x</code>, indicating which elements are finite (not infinite
and not missing) or infinite.
</p>
<p><code>Inf</code> and <code>-Inf</code> are positive and negative infinity
whereas <code>NaN</code> means &lsquo;Not a Number&rsquo;.  (These apply to numeric
values and real and imaginary parts of complex values but not to
values of integer vectors.)  <code>Inf</code> and <code>NaN</code> (as well as
<code><a href="#topic+NA">NA</a></code>) are
<a href="#topic+reserved">reserved</a> words in the <span class="rlang"><b>R</b></span> language.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.finite(x)
is.infinite(x)
is.nan(x)

Inf
NaN
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.finite_+3A_x">x</code></td>
<td>
<p><span class="rlang"><b>R</b></span> object to be tested: the default methods handle atomic
vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>is.finite</code> returns a vector of the same length as <code>x</code> the
j-th element of which is <code>TRUE</code> if <code>x[j]</code> is finite (i.e., it
is not one of the values <code>NA</code>, <code>NaN</code>, <code>Inf</code> or
<code>-Inf</code>) and <code>FALSE</code> otherwise.  Complex
numbers are finite if both the real and imaginary parts are.
</p>
<p><code>is.infinite</code> returns a vector of the same length as <code>x</code> the
j-th element of which is <code>TRUE</code> if <code>x[j]</code> is infinite (i.e.,
equal to one of <code>Inf</code> or <code>-Inf</code>) and <code>FALSE</code>
otherwise.  This will be false unless <code>x</code> is numeric or complex.
Complex numbers are infinite if either the real or the imaginary part is.
</p>
<p><code>is.nan</code> tests if a numeric value is <code>NaN</code>.  Do not test
equality to <code>NaN</code>, or even use <code><a href="#topic+identical">identical</a></code>, since
systems typically have many different NaN values.  One of these is
used for the numeric missing value <code>NA</code>, and <code>is.nan</code> is
false for that value.  A complex number is regarded as <code>NaN</code> if
either the real or imaginary part is <code>NaN</code> but not <code>NA</code>.
All elements of logical, integer and raw vectors are considered not to
be NaN.
</p>
<p>All three functions accept <code>NULL</code> as input and return a length
zero result. The default methods accept character and raw vectors, and
return <code>FALSE</code> for all entries. Prior to <span class="rlang"><b>R</b></span> version 2.14.0 they
accepted all input, returning <code>FALSE</code> for most non-numeric
values; cases which are not atomic vectors are now signalled as
errors.
</p>
<p>All three functions are generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Value</h3>

<p>A logical vector of the same length as <code>x</code>: <code>dim</code>,
<code>dimnames</code> and <code>names</code> attributes are preserved.
</p>


<h3>Note</h3>

<p>In <span class="rlang"><b>R</b></span>, basically all mathematical functions (including basic
<code><a href="#topic+Arithmetic">Arithmetic</a></code>), are supposed to work properly with
<code>+/- Inf</code> and <code>NaN</code> as input or output.
</p>
<p>The basic rule should be that calls and relations with <code>Inf</code>s
really are statements with a proper mathematical <em>limit</em>.
</p>
<p>Computations involving <code>NaN</code> will return <code>NaN</code> or perhaps
<code><a href="#topic+NA">NA</a></code>: which of those two is not guaranteed and may depend
on the <span class="rlang"><b>R</b></span> platform (since compilers may re-order computations).
</p>


<h3>References</h3>

<p>The IEC 60559 standard, also known as the
ANSI/IEEE 754 Floating-Point Standard.
</p>
<p><a href="https://en.wikipedia.org/wiki/NaN">https://en.wikipedia.org/wiki/NaN</a>.
</p>
<p>D. Goldberg (1991).
What Every Computer Scientist Should Know about Floating-Point
Arithmetic.
<em>ACM Computing Surveys</em>, <b>23</b>(1), 5&ndash;48.
<a href="https://doi.org/10.1145/103162.103163">doi:10.1145/103162.103163</a>.
<br />







Also available at
<a href="https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html">https://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html</a>.
</p>
<p>The C99 function <code>isfinite</code> is used for <code>is.finite</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NA">NA</a></code>, &lsquo;<em>Not Available</em>&rsquo; which is not a number
as well, however usually used for missing values and applies to many
modes, not just numeric and complex.
</p>
<p><code><a href="#topic+Arithmetic">Arithmetic</a></code>, <code><a href="#topic+double">double</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pi / 0 ## = Inf a non-zero number divided by zero creates infinity
0 / 0  ## =  NaN

1/0 + 1/0 # Inf
1/0 - 1/0 # NaN

stopifnot(
    1/0 == Inf,
    1/Inf == 0
)
sin(Inf)
cos(Inf)
tan(Inf)
</code></pre>

<hr>
<h2 id='is.function'>Is an Object of Type (Primitive) Function?</h2><span id='topic+is.function'></span><span id='topic+is.primitive'></span>

<h3>Description</h3>

<p>Checks whether its argument is a (primitive) function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.function(x)
is.primitive(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.function_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>is.primitive(x)</code> tests if <code>x</code> is a <a href="#topic+primitive">primitive</a> function,
i.e, if <code><a href="#topic+typeof">typeof</a>(x)</code> is either <code>"builtin"</code> or
<code>"special"</code>.
</p>


<h3>Value</h3>

<p><code>TRUE</code> if <code>x</code> is a (primitive) function, and <code>FALSE</code>
otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.function(1) # FALSE
is.function (is.primitive) # TRUE: it is a function, but ..
is.primitive(is.primitive) # FALSE: it's not a primitive one, whereas
is.primitive(is.function)  # TRUE: that one *is*
</code></pre>

<hr>
<h2 id='is.language'>Is an Object a Language Object?</h2><span id='topic+is.language'></span><span id='topic+language'></span><span id='topic+language+20object'></span><span id='topic+language+20objects'></span>

<h3>Description</h3>

<p><code>is.language</code> returns <code>TRUE</code> if <code>x</code> is a
variable <code><a href="#topic+name">name</a></code>, a <code><a href="#topic+call">call</a></code>, or an
<code><a href="#topic+expression">expression</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.language(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.language_+3A_x">x</code></td>
<td>
<p>object to be tested.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A <code>name</code> is also known as &lsquo;symbol&rsquo;, from its type
(<code><a href="#topic+typeof">typeof</a></code>), see <code><a href="#topic+is.symbol">is.symbol</a></code>.
</p>
<p>If <code><a href="#topic+typeof">typeof</a>(x) == "language"</code>, then <code>is.language(x)</code>
is always true, but the reverse does not hold as expressions or
names <code>y</code> also fulfill <code>is.language(y)</code>, see the examples.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ll &lt;- list(a = expression(x^2 - 2*x + 1), b = as.name("Jim"),
           c = as.expression(exp(1)), d = call("sin", pi))
sapply(ll, typeof)
sapply(ll, mode)
stopifnot(sapply(ll, is.language))
</code></pre>

<hr>
<h2 id='is.object'>Is an Object &lsquo;internally classed&rsquo;?</h2><span id='topic+is.object'></span>

<h3>Description</h3>

<p>A function mostly for internal use.  It returns <code>TRUE</code> if the
object <code>x</code> has the <span class="rlang"><b>R</b></span> internal <code>OBJECT</code> bit set, and
<code>FALSE</code> otherwise.  The <code>OBJECT</code> bit is set when a
<code>"class"</code> attribute is added and removed when that attribute is
removed, so this is a very efficient way to check if an object has a
class attribute.  (S4 objects always should.)
</p>
<p>Note that typical basic (&lsquo;atomic&rsquo;, see <code><a href="#topic+is.atomic">is.atomic</a></code>)
<span class="rlang"><b>R</b></span> vectors and arrays <code>x</code> are <em>not</em> objects in the above
sense as <code><a href="#topic+attributes">attributes</a>(x)</code> does <em>not</em> contain <code>"class"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.object(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.object_+3A_x">x</code></td>
<td>
<p>object to be tested.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+class">class</a></code>, and <code><a href="utils.html#topic+methods">methods</a></code>.
</p>
<p><code><a href="#topic+isS4">isS4</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.object(1) # FALSE
is.object(as.factor(1:3)) # TRUE
</code></pre>

<hr>
<h2 id='is.recursive'>Is an Object Atomic or Recursive?</h2><span id='topic+is.atomic'></span><span id='topic+is.recursive'></span>

<h3>Description</h3>

<p><code>is.atomic</code> returns <code>TRUE</code> if <code>x</code> is of an atomic type
and <code>FALSE</code> otherwise.
</p>
<p><code>is.recursive</code> returns <code>TRUE</code> if <code>x</code> has a recursive
(list-like) structure and <code>FALSE</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.atomic(x)
is.recursive(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.recursive_+3A_x">x</code></td>
<td>
<p>object to be tested.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>is.atomic</code> is true for the <a href="#topic+atomic">atomic</a> types
(<code>"logical"</code>, <code>"integer"</code>, <code>"numeric"</code>,
<code>"complex"</code>, <code>"character"</code> and <code>"raw"</code>).
</p>
<p>Most types of objects are regarded as recursive.  Exceptions are the atomic
types, <code>NULL</code>, symbols (as given by <code><a href="#topic+as.name">as.name</a></code>),
<code>S4</code> objects with slots, external pointers, and&mdash;rarely visible
from <span class="rlang"><b>R</b></span>&mdash;weak references and byte code, see <code><a href="#topic+typeof">typeof</a></code>.
</p>
<p>It is common to call the atomic types &lsquo;atomic vectors&rsquo;, but
note that <code><a href="#topic+is.vector">is.vector</a></code> imposes further restrictions: an
object can be atomic but not a vector (in that sense).
</p>
<p>These are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.list">is.list</a></code>,
<code><a href="#topic+is.language">is.language</a></code>, etc,
and the <code>demo("is.things")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

is.a.r &lt;- function(x) c(is.atomic(x), is.recursive(x))

is.a.r(c(a = 1, b = 3)) # TRUE FALSE
is.a.r(list())          # FALSE TRUE - a list is a list
is.a.r(list(2))         # FALSE TRUE
is.a.r(lm)              # FALSE TRUE
is.a.r(y ~ x)           # FALSE TRUE
is.a.r(expression(x+1)) # FALSE TRUE
is.a.r(quote(exp))      # FALSE FALSE
is.a.r(NULL)            # FALSE FALSE
</code></pre>

<hr>
<h2 id='is.single'>Is an Object of Single Precision Type?</h2><span id='topic+is.single'></span>

<h3>Description</h3>

<p><code>is.single</code> reports an error.  There are no single precision
values in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.single(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.single_+3A_x">x</code></td>
<td>
<p>object to be tested.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>

<hr>
<h2 id='is.unsorted'>Test if an Object is Not Sorted</h2><span id='topic+is.unsorted'></span>

<h3>Description</h3>

<p>Test if an object is not sorted (in increasing order), without the
cost of sorting it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.unsorted(x, na.rm = FALSE, strictly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.unsorted_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object with a class or a numeric, complex, character,
logical or raw vector.</p>
</td></tr>
<tr><td><code id="is.unsorted_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values be removed before checking?</p>
</td></tr>
<tr><td><code id="is.unsorted_+3A_strictly">strictly</code></td>
<td>
<p>logical indicating if the check should be for
<em>strictly</em> increasing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>is.unsorted</code> is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Value</h3>

<p>A length-one logical value.  All objects of length 0 or 1 are sorted.
Otherwise, the result will be <code>NA</code> except for atomic vectors and
objects with an S3 class (where the <code>&gt;=</code> or <code>&gt;</code> method is
used to compare <code>x[i]</code> with <code>x[i-1]</code> for <code>i</code> in
<code>2:length(x)</code>) or with an S4 class where you have to provide a
method for <code><a href="#topic+is.unsorted">is.unsorted</a>()</code>.
</p>


<h3>Note</h3>

<p>This function is designed for objects with one-dimensional indices, as
described above.  Data frames, matrices and other arrays may give
surprising results.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sort">sort</a></code>, <code><a href="#topic+order">order</a></code>.</p>

<hr>
<h2 id='ISOdatetime'>Date-time Conversion Functions from Numeric Representations</h2><span id='topic+ISOdatetime'></span><span id='topic+ISOdate'></span>

<h3>Description</h3>

<p>Convenience wrappers to create date-times from numeric representations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ISOdatetime(year, month, day, hour, min, sec, tz = "")
ISOdate(year, month, day, hour = 12, min = 0, sec = 0, tz = "GMT")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ISOdatetime_+3A_year">year</code>, <code id="ISOdatetime_+3A_month">month</code>, <code id="ISOdatetime_+3A_day">day</code></td>
<td>
<p>numerical values to specify a day.</p>
</td></tr>
<tr><td><code id="ISOdatetime_+3A_hour">hour</code>, <code id="ISOdatetime_+3A_min">min</code>, <code id="ISOdatetime_+3A_sec">sec</code></td>
<td>
<p>numerical values for a time within a day.
Fractional seconds are allowed.</p>
</td></tr>
<tr><td><code id="ISOdatetime_+3A_tz">tz</code></td>
<td>
<p>a <a href="#topic+time+20zone">time zone</a> specification to be used for the conversion.
<code>""</code> is the current time zone and <code>"GMT"</code> is UTC.  Invalid
values are most commonly treated as UTC, on some platforms with a warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ISOdatetime</code> and <code>ISOdate</code> are convenience wrappers for
<code>strptime</code> that differ only in their defaults and that
<code>ISOdate</code> sets UTC as the time zone.  For dates without times it
would normally be better to use the <code>"<a href="#topic+Date">Date</a>"</code> class.
</p>
<p>The main arguments will be recycled using the usual recycling rules.
</p>
<p>Because these make use of <code><a href="#topic+strptime">strptime</a></code>, only years in the
range <code>0:9999</code> are accepted.
</p>


<h3>Value</h3>

<p>An object of class <code>"<a href="#topic+POSIXct">POSIXct</a>"</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+DateTimeClasses">DateTimeClasses</a> for details of the date-time classes;
<code><a href="#topic+strptime">strptime</a></code> for conversions from character strings.
</p>

<hr>
<h2 id='isS4'> Test for an S4 object </h2><span id='topic+isS4'></span><span id='topic+asS4'></span><span id='topic+S4'></span><span id='topic+asS3'></span>

<h3>Description</h3>

<p>Tests whether the object is an instance of an S4 class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isS4(object)

asS4(object, flag = TRUE, complete = TRUE)
asS3(object, flag = TRUE, complete = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isS4_+3A_object">object</code></td>
<td>
<p>Any R object.</p>
</td></tr>
<tr><td><code id="isS4_+3A_flag">flag</code></td>
<td>
<p>Optional, logical: indicate direction of conversion.</p>
</td></tr>
<tr><td><code id="isS4_+3A_complete">complete</code></td>
<td>
<p>Optional, logical: whether conversion to S3 is
completed.  Not usually needed, but see the details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>isS4</code> does not rely on the <span class="pkg">methods</span>
package, so in particular it can be used to detect the need to
<code><a href="#topic+require">require</a></code> that package.
</p>
<p><code>asS3</code> uses the value of
<code>complete</code> to control whether an attempt is made to transform
<code>object</code> into a valid object of the implied S3 class.  If
<code>complete</code> is <code>TRUE</code>,
then an object from an S4 class extending an S3 class will be
transformed into an S3 object with the corresponding S3 class (see
<code><a href="methods.html#topic+S3Part">S3Part</a></code>).  This includes classes extending the
pseudo-classes <code>array</code> and <code>matrix</code>: such objects will have
their class attribute set to <code>NULL</code>.
</p>
<p><code>isS4</code> is <a href="#topic+primitive">primitive</a>.
</p>


<h3>Value</h3>

<p><code>isS4</code> always returns <code>TRUE</code> or <code>FALSE</code> according to
whether the internal flag marking an S4 object has been turned on for
this object.
</p>
<p><code>asS4</code> and <code>asS3</code> will turn this flag on or off,
and <code>asS3</code> will set the class from the objects <code>.S3Class</code>
slot if one exists.  Note that <code>asS3</code> will <em>not</em>  turn
the object into an S3 object
unless there is a valid conversion; that is, an object of type other
than <code>"S4"</code> for which the S4 object is an extension, unless
argument <code>complete</code> is <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.object">is.object</a></code> for a more general test; <a href="methods.html#topic+Introduction">Introduction</a>
for general information on S4; <a href="methods.html#topic+Classes_Details">Classes_Details</a> for more on S4
class definitions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
isS4(pi) # FALSE
isS4(getClass("MethodDefinition")) # TRUE

</code></pre>

<hr>
<h2 id='isSymmetric'>Test if a Matrix or other Object is Symmetric (Hermitian)</h2><span id='topic+isSymmetric'></span><span id='topic+isSymmetric.matrix'></span>

<h3>Description</h3>

<p>Generic function to test if <code>object</code> is symmetric or not.
Currently only a matrix method is implemented, where a
<code><a href="#topic+complex">complex</a></code> matrix <code>Z</code> must be &ldquo;Hermitian&rdquo; for
<code>isSymmetric(Z)</code> to be true.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isSymmetric(object, ...)
## S3 method for class 'matrix'
isSymmetric(object, tol = 100 * .Machine$double.eps,
            tol1 = 8 * tol, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isSymmetric_+3A_object">object</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object; a <code><a href="#topic+matrix">matrix</a></code> for the matrix method.</p>
</td></tr>
<tr><td><code id="isSymmetric_+3A_tol">tol</code></td>
<td>
<p>numeric scalar &gt;= 0.  Smaller differences are not
considered, see <code><a href="#topic+all.equal.numeric">all.equal.numeric</a></code>.</p>
</td></tr>
<tr><td><code id="isSymmetric_+3A_tol1">tol1</code></td>
<td>
<p>numeric scalar &gt;= 0.  <code>isSymmetric.matrix()</code>
&lsquo;pre-tests&rsquo; the first and last few rows for fast detection of
&lsquo;obviously&rsquo; asymmetric cases with this tolerance.  Setting it
to length zero will skip the pre-tests.</p>
</td></tr>
<tr><td><code id="isSymmetric_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods; the matrix method
passes these to <code><a href="#topic+all.equal">all.equal</a></code>.  If the row and column
names of <code>object</code> are allowed to differ for the symmetry check
do use <code>check.attributes = FALSE</code>!</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+matrix">matrix</a></code> method is used inside <code><a href="#topic+eigen">eigen</a></code> by
default to test symmetry of matrices <em>up to rounding error</em>, using
<code><a href="#topic+all.equal">all.equal</a></code>.  It might not be appropriate in all
situations.
</p>
<p>Note that a matrix <code>m</code> is only symmetric if its <code>rownames</code> and
<code>colnames</code> are identical.  Consider using <code><a href="#topic+unname">unname</a>(m)</code>.
</p>


<h3>Value</h3>

<p>logical indicating if <code>object</code> is symmetric or not.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eigen">eigen</a></code> which calls <code>isSymmetric</code> when its
<code>symmetric</code> argument is missing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>isSymmetric(D3 &lt;- diag(3)) # -&gt; TRUE

D3[2, 1] &lt;- 1e-100
D3
isSymmetric(D3) # TRUE
isSymmetric(D3, tol = 0) # FALSE for zero-tolerance

## Complex Matrices - Hermitian or not
Z &lt;- sqrt(matrix(-1:2 + 0i, 2)); Z &lt;- t(Conj(Z)) %*% Z
Z
isSymmetric(Z)      # TRUE
isSymmetric(Z + 1)  # TRUE
isSymmetric(Z + 1i) # FALSE -- a Hermitian matrix has a *real* diagonal

colnames(D3) &lt;- c("X", "Y", "Z")
isSymmetric(D3)                         # FALSE (as row and column names differ)
isSymmetric(D3, check.attributes=FALSE) # TRUE  (as names are not checked)
</code></pre>

<hr>
<h2 id='jitter'>&lsquo;Jitter&rsquo; (Add Noise) to Numbers</h2><span id='topic+jitter'></span>

<h3>Description</h3>

<p>Add a small amount of noise to a numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jitter(x, factor = 1, amount = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jitter_+3A_x">x</code></td>
<td>
<p>numeric vector to which <em>jitter</em> should be added.</p>
</td></tr>
<tr><td><code id="jitter_+3A_factor">factor</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="jitter_+3A_amount">amount</code></td>
<td>
<p>numeric; if positive, used as <em>amount</em> (see below),
otherwise, if <code>= 0</code> the default is <code>factor * z/50</code>.
</p>
<p>Default (<code>NULL</code>): <code>factor * d/5</code> where <code>d</code> is about
the smallest difference between <code>x</code> values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result, say <code>r</code>, is <code>r &lt;- x + runif(n, -a, a)</code>
where <code>n &lt;- length(x)</code> and <code>a</code> is the <code>amount</code>
argument (if specified).
</p>
<p>Let <code>z &lt;- max(x) - min(x)</code> (assuming the usual case).
The amount <code>a</code> to be added is either provided as <em>positive</em>
argument <code>amount</code> or otherwise computed from <code>z</code>, as
follows:
</p>
<p>If <code>amount == 0</code>, we set <code>a &lt;- factor * z/50</code> (same as S).
</p>
<p>If <code>amount</code> is <code>NULL</code> (<em>default</em>), we set
<code>a &lt;- factor * d/5</code> where <em>d</em> is the smallest
difference between adjacent unique (apart from fuzz) <code>x</code> values.
</p>


<h3>Value</h3>

<p><code>jitter(x, ...)</code> returns a numeric of the same length as
<code>x</code>, but with an <code>amount</code> of noise added in order to break
ties.
</p>


<h3>Author(s)</h3>

<p>Werner Stahel and Martin Maechler, ETH Zurich</p>


<h3>References</h3>

<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P.A. (1983)
<em>Graphical Methods for Data Analysis.</em> Wadsworth; figures 2.8,
4.22, 5.4.
</p>
<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+rug">rug</a></code> which you may want to combine with <code>jitter</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>round(jitter(c(rep(1, 3), rep(1.2, 4), rep(3, 3))), 3)
## These two 'fail' with S-plus 3.x:
jitter(rep(0, 7))
jitter(rep(10000, 5))
</code></pre>

<hr>
<h2 id='kappa'>Compute or Estimate the Condition Number of a Matrix</h2><span id='topic+rcond'></span><span id='topic+kappa'></span><span id='topic+kappa.default'></span><span id='topic+kappa.lm'></span><span id='topic+kappa.qr'></span><span id='topic+.kappa_tri'></span>

<h3>Description</h3>

<p>The condition number of a regular (square) matrix is the product of
the <em>norm</em> of the matrix and the norm of its inverse (or
pseudo-inverse), and hence depends on the kind of matrix-norm.
</p>
<p><code>kappa()</code> computes by default (an estimate of) the 2-norm
condition number of a matrix or of the <code class="reqn">R</code> matrix of a <code class="reqn">QR</code>
decomposition, perhaps of a linear fit.  The 2-norm condition number
can be shown to be the ratio of the largest to the smallest
<em>non-zero</em> singular value of the matrix.
</p>
<p><code>rcond()</code> computes an approximation of the <b>r</b>eciprocal
<b>cond</b>ition number, see the details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kappa(z, ...)
## Default S3 method:
kappa(z, exact = FALSE,
      norm = NULL, method = c("qr", "direct"),
      inv_z = solve(z),
      triangular = FALSE, uplo = "U", ...)

## S3 method for class 'lm'
kappa(z, ...)
## S3 method for class 'qr'
kappa(z, ...)

.kappa_tri(z, exact = FALSE, LINPACK = TRUE, norm = NULL, uplo = "U", ...)

rcond(x, norm = c("O","I","1"), triangular = FALSE, uplo = "U", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kappa_+3A_z">z</code>, <code id="kappa_+3A_x">x</code></td>
<td>
<p>a numeric or complex matrix or a result of
<code><a href="#topic+qr">qr</a></code> or a fit from a class inheriting from <code>"lm"</code>.</p>
</td></tr>
<tr><td><code id="kappa_+3A_exact">exact</code></td>
<td>
<p>logical.  Should the result be exact (up to small rounding
error) as opposed to fast (but quite inaccurate)?</p>
</td></tr>
<tr><td><code id="kappa_+3A_norm">norm</code></td>
<td>
<p>character string, specifying the matrix norm with respect
to which the condition number is to be computed, see the function
<code><a href="#topic+norm">norm</a>()</code>.  For <code>kappa()</code>, the default is <code>"2"</code>,
for <code>rcond()</code> it is <code>"O"</code>, and for <code>.kappa_tri()</code>), the
default depends on <code>exact</code>: if that is true, the default is
<code>"2"</code>, otherwise <code>"O"</code>,
meaning the <b>O</b>ne- or 1-norm.  For <code>exact=FALSE</code>, the
currently only other possible value is <code>"I"</code> for the infinity
norm.  For <code>exact=TRUE</code>, norm may be <code>"2"</code>, or any of the
possible <code>type</code> values in <code><a href="#topic+norm">norm</a>(., type = *)</code>.</p>
</td></tr>
<tr><td><code id="kappa_+3A_method">method</code></td>
<td>
<p>a partially matched character string specifying the method to be used;
<code>"qr"</code> is the default for back-compatibility, mainly.</p>
</td></tr>
<tr><td><code id="kappa_+3A_inv_z">inv_z</code></td>
<td>
<p>for <code>exact=TRUE, norm != "2"</code>, (an approximation of)
<code><a href="#topic+solve">solve</a>(z)</code>; could be the pseudo inverse or a fast
approximate inverse of the matrix <code>z</code>.  By default,
<code>solve(z)</code> is the most expensive part of the condition computation
when <code>exact</code> is true.</p>
</td></tr>
<tr><td><code id="kappa_+3A_triangular">triangular</code></td>
<td>
<p>logical.  If true, the matrix used is just the upper or
lower triangular part of <code>z</code> (or <code>x</code>), depending on</p>
</td></tr>
<tr><td><code id="kappa_+3A_uplo">uplo</code></td>
<td>
<p>character string, either <code>"U"</code> or <code>"L"</code>.  Used only
when <code>triangular = TRUE</code>, indicates if the upper or lower
triangular part of the matrix is to be used.</p>
</td></tr>
<tr><td><code id="kappa_+3A_linpack">LINPACK</code></td>
<td>
<p>logical.  If true and <code>z</code> is not complex, the
LINPACK routine <code>dtrco()</code> is called; otherwise the relevant
LAPACK routine is.</p>
</td></tr>
<tr><td><code id="kappa_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods;
for <code>kappa.*()</code>, notably <code>LINPACK</code> when <code>norm</code> is not
<code>"2"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>kappa()</code>, if <code>exact = FALSE</code> (the default) the
condition number is estimated by a cheap approximation to the 1-norm of
the triangular matrix <code class="reqn">R</code> of the <code><a href="#topic+qr">qr</a>(x)</code> decomposition
<code class="reqn">z = QR</code>.  However, the exact 2-norm calculation (via
<code><a href="#topic+svd">svd</a></code>) is also likely to be quick enough.

</p>
<p>Note that the approximate 1- and Inf-norm condition numbers via
<code>method = "direct"</code> are much faster to
calculate, and <code>rcond()</code> computes these <em><b>r</b>eciprocal</em>
condition numbers, also for complex matrices, using standard LAPACK
routines.
Currently, also the <code>kappa*()</code> functions compute these
approximations whenever <code>exact</code> is false, i.e., by default.
</p>
<p><code>kappa</code> and <code>rcond</code> are different interfaces to
<em>partly</em> identical functionality.
</p>
<p><code>.kappa_tri</code> is an internal function called by <code>kappa.qr</code> and
<code>kappa.default</code>; <code>tri</code> is for <em>tri</em>angular and its methods
only consider the upper or lower triangular part of the matrix, depending
on <code>uplo = "U"</code> or <code>"L"</code>, where <code>"U"</code> was internally hard
wired before <span class="rlang"><b>R</b></span> 4.4.0.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>


<h3>Value</h3>

<p>The condition number, <code class="reqn">kappa</code>, or an approximation if
<code>exact = FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>The design was inspired by (but differs considerably from)
the S function of the same name described in Chambers (1992).
</p>


<h3>Source</h3>

<p>The LAPACK routines <code>DTRCON</code> and <code>ZTRCON</code> and the LINPACK
routine <code>DTRCO</code>.
</p>
<p>LAPACK and LINPACK are from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and
<a href="https://netlib.org/linpack/">https://netlib.org/linpack/</a> and their guides are listed
in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition. SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Chambers, J. M. (1992)
<em>Linear models.</em>
Chapter 4 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Dongarra, J. J., Bunch, J. R., Moler, C. B. and Stewart, G. W. (1978)
<em>LINPACK Users Guide.</em>  Philadelphia: SIAM Publications.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+norm">norm</a></code>;
<code><a href="#topic+svd">svd</a></code> for the singular value decomposition and
<code><a href="#topic+qr">qr</a></code> for the <code class="reqn">QR</code> one.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kappa(x1 &lt;- cbind(1, 1:10)) # 15.71
kappa(x1, exact = TRUE)     # 13.68
kappa(x2 &lt;- cbind(x1, 2:11)) # high! [x2 is singular!]

hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, `+`) }
sv9 &lt;- svd(h9 &lt;- hilbert(9))$ d
kappa(h9)  # pretty high; by default {exact=FALSE, method="qr"} :
kappa(h9) == kappa(qr.R(qr(h9)), norm = "1")
all.equal(kappa(h9, exact = TRUE), # its definition:
          max(sv9) / min(sv9),
          tolerance = 1e-12) ## the same (typically down to 2.22e-16)
kappa(h9, exact = TRUE) / kappa(h9)  # 0.677 (i.e., rel.error = 32%)

## Exact kappa for rectangular matrix
## panmagic.6npm1(7) :
pm7 &lt;- rbind(c( 1, 13, 18, 23, 35, 40, 45),
             c(37, 49,  5, 10, 15, 27, 32),
             c(24, 29, 41, 46,  2, 14, 19),
             c(11, 16, 28, 33, 38, 43,  6),
             c(47,  3,  8, 20, 25, 30, 42),
             c(34, 39, 44,  7, 12, 17, 22),
             c(21, 26, 31, 36, 48,  4,  9))

kappa(pm7, exact=TRUE, norm="1") # no problem for square matrix

m76 &lt;- pm7[,1:6]
(m79 &lt;- cbind(pm7, 50:56, 63:57))

## Moore-Penrose inverse { ~= MASS::ginv(); differing tol (value &amp; meaning)}:
## pinv := p(seudo) inv(erse)
pinv &lt;- function(X, s = svd(X), tol = 64*.Machine$double.eps) {
    if (is.complex(X))
        s$u &lt;- Conj(s$u)
    dx &lt;- dim(X)
    ## X = U D V' ==&gt; Result =  V {1/D} U'
    pI &lt;- function(u,d,v) tcrossprod(v, u / rep(d, each = dx[1L]))
    pos &lt;- (d &lt;- s$d) &gt; max(tol * max(dx) * d[1L], 0)
    if (all(pos))
        pI(s$u, d, s$v)
    else if (!any(pos))
        array(0, dX[2L:1L])
    else { # some pos, some not:
        i &lt;- which(pos)
        pI(s$u[, i, drop = FALSE], d[i],
           s$v[, i, drop = FALSE])
    }
}

## rectangular
kappa(m76, norm="1")
try( kappa(m76, exact=TRUE, norm="1") )# error in  solve().. must be square

## ==&gt; use pseudo-inverse instead of solve() for rectangular {and norm != "2"}:
iZ &lt;- pinv(m76)
kappa(m76, exact=TRUE, norm="1", inv_z = iZ)
kappa(m76, exact=TRUE, norm="M", inv_z = iZ)
kappa(m76, exact=TRUE, norm="I", inv_z = iZ)

iX &lt;- pinv(m79)
kappa(m79, exact=TRUE, norm="1", inv_z = iX)
kappa(m79, exact=TRUE, norm="M", inv_z = iX)
kappa(m79, exact=TRUE, norm="I", inv_z = iX)
</code></pre>

<hr>
<h2 id='kronecker'>Kronecker Products on Arrays</h2><span id='topic+kronecker'></span><span id='topic++25x+25'></span>

<h3>Description</h3>

<p>Computes the generalised Kronecker product of two arrays,
<code>X</code> and <code>Y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kronecker(X, Y, FUN = "*", make.dimnames = FALSE, ...)
X %x% Y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kronecker_+3A_x">X</code></td>
<td>
<p>a vector or array.</p>
</td></tr>
<tr><td><code id="kronecker_+3A_y">Y</code></td>
<td>
<p>a vector or array.</p>
</td></tr>
<tr><td><code id="kronecker_+3A_fun">FUN</code></td>
<td>
<p>a function; it may be a quoted string.</p>
</td></tr>
<tr><td><code id="kronecker_+3A_make.dimnames">make.dimnames</code></td>
<td>
<p>logical: provide dimnames that are the product of the
dimnames of <code>X</code> and <code>Y</code>.</p>
</td></tr>
<tr><td><code id="kronecker_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>X</code> and <code>Y</code> do not have the same number of
dimensions, the smaller array is padded with dimensions of size
one.  The returned array comprises submatrices constructed by
taking <code>X</code> one term at a time and expanding that term as
<code>FUN(x, Y, ...)</code>.
</p>
<p><code>%x%</code> is an alias for <code>kronecker</code> (where
<code>FUN</code> is hardwired to <code>"*"</code>).
</p>


<h3>Value</h3>

<p>An array <code>A</code> with dimensions <code>dim(X) * dim(Y)</code>.
</p>


<h3>Author(s)</h3>

<p>Jonathan Rougier</p>


<h3>References</h3>

<p>Shayle R. Searle (1982)
<em>Matrix Algebra Useful for Statistics.</em> John Wiley and Sons.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+outer">outer</a></code>, on which <code>kronecker</code> is built
and <code><a href="#topic++25+2A+25">%*%</a></code> for usual matrix multiplication.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simple scalar multiplication
( M &lt;- matrix(1:6, ncol = 2) )
kronecker(4, M)
# Block diagonal matrix:
kronecker(diag(1, 3), M)

# ask for dimnames

fred &lt;- matrix(1:12, 3, 4, dimnames = list(LETTERS[1:3], LETTERS[4:7]))
bill &lt;- c("happy" = 100, "sad" = 1000)
kronecker(fred, bill, make.dimnames = TRUE)

bill &lt;- outer(bill, c("cat" = 3, "dog" = 4))
kronecker(fred, bill, make.dimnames = TRUE)
</code></pre>

<hr>
<h2 id='l10n_info'>Localization Information</h2><span id='topic+l10n_info'></span>

<h3>Description</h3>

<p>Report on localization information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l10n_info()
</code></pre>


<h3>Details</h3>




<p>&lsquo;A Latin-1 locale&rsquo; includes supersets (for printable
characters) such as Windows codepage 1252 but not Latin-9 (ISO 8859-15).
</p>
<p>On <b>Windows</b> (where the resulting list contains <code>codepage</code>
and <code>system.codepage</code> components additionally), common
codepages are 1252 (Western European), 1250 (Central European),
1251 (Cyrillic), 1253 (Greek), 1254 (Turkish), 1255 (Hebrew), 1256
(Arabic), 1257 (Baltic), 1258 (Vietnamese), 874 (Thai), 932
(Japanese), 936 (Simplified Chinese), 949 (Korean) and 950
(Traditional Chinese).  Codepage 28605 is Latin-9 and 65001 is UTF-8
(where supported).  <span class="rlang"><b>R</b></span> does not allow the C locale, and uses 1252 as
the default codepage.
</p>


<h3>Value</h3>

<p>A list with three logical elements and further OS-specific elements:
</p>
<table>
<tr><td><code>MBCS</code></td>
<td>
<p>If a multi-byte character set in use?</p>
</td></tr>
<tr><td><code>UTF-8</code></td>
<td>
<p>Is this known to be a UTF-8 locale?</p>
</td></tr>
<tr><td><code>Latin-1</code></td>
<td>
<p>Is this known to be a Latin-1 locale?</p>
</td></tr>
</table>
<p><em>Not</em> on Windows:
</p>
<table>
<tr><td><code>codeset</code></td>
<td>
<p>character.  The encoding name as reported by the OS,
possibly <code>""</code>. (Added in <span class="rlang"><b>R</b></span> 4.1.0.  Encoding names are
OS-specific.)</p>
</td></tr>
</table>
<p>Only on Windows:
</p>
<table>
<tr><td><code>codepage</code></td>
<td>
<p>integer: the Windows codepage corresponding to the
locale <span class="rlang"><b>R</b></span> is using (and not necessarily that Windows is using).</p>
</td></tr>
<tr><td><code>system.codepage</code></td>
<td>
<p>integer: the Windows system/ANSI codepage
(the codepage Windows is using).  Added in <span class="rlang"><b>R</b></span> 4.1.0.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.getlocale">Sys.getlocale</a></code>, <code><a href="#topic+localeconv">localeconv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l10n_info()
</code></pre>

<hr>
<h2 id='La_library'>
LAPACK Library
</h2><span id='topic+La_library'></span>

<h3>Description</h3>

<p>Report the name of the shared object file with <code>LAPACK</code> implementation
in use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>La_library()
</code></pre>


<h3>Value</h3>

<p>A character vector of length one (<code>""</code> when the name is not known).
The value can be used as an indication of which <code>LAPACK</code>
implementation is in use.  Typically, the <span class="rlang"><b>R</b></span> version of <code>LAPACK</code> will
appear as <code>libRlapack.so</code> (<code>libRlapack.dylib</code>), depending on how
R was built.  Note that <code>libRlapack.so</code> (<code>libRlapack.dylib</code>) may
also be shown for an external <code>LAPACK</code> implementation that had been
copied, hard-linked or renamed by the system administrator.  Otherwise,
the shared object file will be given and its path/name may indicate
the vendor/version.
</p>
<p>The detection does not work on Windows, nor for the Accelerate
framework on macOS, nor in the rare (and unsupported) case of a static
external library.
</p>
<p>It is possible to build <span class="rlang"><b>R</b></span> against an enhanced BLAS which contains
some but not all LAPACK routines, in which case this function reports
the library containing routine <code>ILAVER</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for versions of other third-party software
including <code>BLAS</code>.
</p>
<p><code><a href="#topic+La_version">La_version</a></code> for the version of LAPACK in use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>La_library()
</code></pre>

<hr>
<h2 id='La_version'>
LAPACK Version
</h2><span id='topic+La_version'></span>

<h3>Description</h3>

<p>Report the version of LAPACK in use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>La_version()
</code></pre>


<h3>Value</h3>

<p>A character vector of length one.
</p>
<p>Note that this is the version as reported by the library at runtime.
It may differ from the reference (&lsquo;netlib&rsquo;) implementation, for
example by having some optimized or patched routines.  For the version
included with <span class="rlang"><b>R</b></span>, the older (not Fortran 90) versions of
</p>
<pre>
    DLARTG DLASSQ ZLARTG ZLASSQ
  </pre>
<p>are used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for versions of other third-party software.
</p>
<p><code><a href="#topic+La_library">La_library</a></code> for binary/executable file with LAPACK in use.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>La_version()
</code></pre>

<hr>
<h2 id='labels'>Find Labels from Object</h2><span id='topic+labels'></span><span id='topic+labels.default'></span>

<h3>Description</h3>

<p>Find a suitable set of labels from an object for use in printing or
plotting, for example.  A generic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>labels(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labels_+3A_object">object</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object: the function is generic.</p>
</td></tr>
<tr><td><code id="labels_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector or list of such vectors.  For a vector the results
is the names or <code>seq_along(x)</code> and for a data frame or array it
is the dimnames (with <code>NULL</code> expanded to <code>seq_len(d[i])</code>).
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>

<hr>
<h2 id='lapply'>Apply a Function over a List or Vector</h2><span id='topic+lapply'></span><span id='topic+sapply'></span><span id='topic+vapply'></span><span id='topic+replicate'></span><span id='topic+simplify2array'></span>

<h3>Description</h3>

<p><code>lapply</code> returns a list of the same length as <code>X</code>, each
element of which is the result of applying <code>FUN</code> to the
corresponding element of <code>X</code>.
</p>
<p><code>sapply</code> is a user-friendly version and wrapper of <code>lapply</code>
by default returning a vector, matrix or, if <code>simplify = "array"</code>, an
array if appropriate, by applying <code>simplify2array()</code>.
<code>sapply(x, f, simplify = FALSE, USE.NAMES = FALSE)</code> is the same as
<code>lapply(x, f)</code>.
</p>
<p><code>vapply</code> is similar to <code>sapply</code>, but has a pre-specified
type of return value, so it can be safer (and sometimes faster) to
use.
</p>
<p><code>replicate</code> is a wrapper for the common use of <code>sapply</code> for
repeated evaluation of an expression (which will usually involve
random number generation).
</p>
<p><code>simplify2array()</code> is the utility called from <code>sapply()</code>
when <code>simplify</code> is not false and is similarly called from
<code><a href="#topic+mapply">mapply</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lapply(X, FUN, ...)

sapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE)

vapply(X, FUN, FUN.VALUE, ..., USE.NAMES = TRUE)

replicate(n, expr, simplify = "array")

simplify2array(x, higher = TRUE, except = c(0L, 1L))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lapply_+3A_x">X</code></td>
<td>
<p>a vector (atomic or list) or an <code><a href="#topic+expression">expression</a></code>
object.  Other objects (including classed objects) will be coerced
by <code>base::<a href="#topic+as.list">as.list</a></code>.</p>
</td></tr>
<tr><td><code id="lapply_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied to each element of <code>X</code>:
see &lsquo;Details&rsquo;.  In the case of functions like
<code>+</code>, <code>%*%</code>, the function name must be backquoted or quoted.</p>
</td></tr>
<tr><td><code id="lapply_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="lapply_+3A_simplify">simplify</code></td>
<td>
<p>logical or character string; should the result be
simplified to a vector, matrix or higher dimensional array if
possible?  For <code>sapply</code> it must be named and not abbreviated.
The default value, <code>TRUE</code>, returns a vector or matrix if appropriate,
whereas if <code>simplify = "array"</code> the result may be an
<code><a href="#topic+array">array</a></code> of &ldquo;rank&rdquo;
(<code class="reqn">=</code><code>length(dim(.))</code>) one higher than the result
of <code>FUN(X[[i]])</code>.</p>
</td></tr>
<tr><td><code id="lapply_+3A_use.names">USE.NAMES</code></td>
<td>
<p>logical; if <code>TRUE</code> and if <code>X</code> is character,
use <code>X</code> as <code><a href="#topic+names">names</a></code> for the result unless it had names
already.  Since this argument follows <code>...</code> its name cannot
be abbreviated.</p>
</td></tr>
<tr><td><code id="lapply_+3A_fun.value">FUN.VALUE</code></td>
<td>
<p>a (generalized) vector; a template for the return
value from FUN.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="lapply_+3A_n">n</code></td>
<td>
<p>integer: the number of replications.</p>
</td></tr>
<tr><td><code id="lapply_+3A_expr">expr</code></td>
<td>
<p>the expression (a <a href="#topic+language+20object">language object</a>, usually a call)
to evaluate repeatedly.</p>
</td></tr>
<tr><td><code id="lapply_+3A_x">x</code></td>
<td>
<p>a list, typically returned from <code>lapply()</code>.</p>
</td></tr>
<tr><td><code id="lapply_+3A_higher">higher</code></td>
<td>
<p>logical; if true, <code>simplify2array()</code> will produce a
(&ldquo;higher rank&rdquo;) array when appropriate, whereas
<code>higher = FALSE</code> would return a matrix (or vector) only.
These two cases correspond to <code>sapply(*, simplify = "array")</code> or
<code>simplify = TRUE</code>, respectively.</p>
</td></tr>
<tr><td><code id="lapply_+3A_except">except</code></td>
<td>
<p>integer vector or <code>NULL</code>; the default <code>c(0L,
      1L)</code> corresponds to the exceptions used by <code>sapply</code>: a list
with elements of common length 0 or 1 is not simplified to an array
but is returned, respectively, as is or unlisted.
These exceptions can be disabled by specifying only a subset of
<code>0:1</code>, or <code>NULL</code> to always simplify to an array (if
possible).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>FUN</code> is found by a call to <code><a href="#topic+match.fun">match.fun</a></code> and typically
is specified as a function or a symbol (e.g., a backquoted name) or a
character string specifying a function to be searched for from the
environment of the call to <code>lapply</code>.
</p>
<p>Function <code>FUN</code> must be able to accept as input any of the
elements of <code>X</code>.  If the latter is an atomic vector, <code>FUN</code>
will always be passed a length-one vector of the same type as <code>X</code>.
</p>
<p>Arguments in <code>...</code> cannot have the same name as any of the
other arguments, and care may be needed to avoid partial matching to
<code>FUN</code>.  In general-purpose code it is good practice to name the
first two arguments <code>X</code> and <code>FUN</code> if <code>...</code> is passed
through: this both avoids partial matching to <code>FUN</code> and ensures
that a sensible error message is given if arguments named <code>X</code> or
<code>FUN</code> are passed through <code>...</code>.
</p>
<p>Simplification in <code>sapply</code> is only attempted if <code>X</code> has
length greater than zero and if the return values from all elements
of <code>X</code> are all of the same (positive) length.  If the common
length is one the result is a vector, and if greater than one is a
matrix with a column corresponding to each element of <code>X</code>.
</p>
<p>Simplification is always done in <code>vapply</code>.  This function
checks that all values of <code>FUN</code> are compatible with the
<code>FUN.VALUE</code>, in that they must have the same length and type.
(Types may be promoted to a higher type within the ordering logical
&lt; integer &lt; double &lt; complex, but not demoted.)
</p>
<p>Users of S4 classes should pass a list to <code>lapply</code> and
<code>vapply</code>: the internal coercion is done by the <code>as.list</code> in
the base namespace and not one defined by a user (e.g., by setting S4
methods on the base function).

</p>


<h3>Value</h3>

<p>For <code>lapply</code>, <code>sapply(simplify = FALSE)</code> and
<code>replicate(simplify = FALSE)</code>, a list.
</p>
<p>For <code>sapply(simplify = TRUE)</code> and <code>replicate(simplify =
  TRUE)</code>: if <code>X</code> has length zero or <code>n = 0</code>, an empty list.
Otherwise an atomic vector or matrix or list of the same length as
<code>X</code> (of length <code>n</code> for <code>replicate</code>).  If simplification
occurs, the output type is determined from the highest type of the
return values in the hierarchy NULL &lt; raw &lt; logical &lt; integer &lt; double &lt;
complex &lt; character &lt; list &lt; expression, after coercion of pairlists
to lists.
</p>
<p><code>vapply</code> returns a vector or array of type matching the
<code>FUN.VALUE</code>.  If <code>length(FUN.VALUE) == 1</code> a
vector of the same length as <code>X</code> is returned, otherwise
an array.  If <code>FUN.VALUE</code> is not an <code><a href="#topic+array">array</a></code>, the
result is a matrix   with <code>length(FUN.VALUE)</code> rows and
<code>length(X)</code> columns, otherwise an array <code>a</code> with
<code><a href="#topic+dim">dim</a>(a) == c(dim(FUN.VALUE), length(X))</code>.
</p>
<p>The (Dim)names of the array value are taken from the <code>FUN.VALUE</code>
if it is named, otherwise from the result of the first function call.
Column names of the matrix or more generally the names of the last
dimension of the array value or names of the vector value are set from
<code>X</code> as in <code>sapply</code>.
</p>


<h3>Note</h3>

<p><code>sapply(*, simplify = FALSE, USE.NAMES = FALSE)</code> is
equivalent to <code>lapply(*)</code>.
</p>
<p>For historical reasons, the calls created by <code>lapply</code> are
unevaluated, and code has been written (e.g., <code>bquote</code>) that
relies on this.  This means that the recorded call is always of the
form <code>FUN(X[[i]], ...)</code>, with <code>i</code> replaced by the current
(integer or double) index.  This is not normally a problem, but it can
be if <code>FUN</code> uses <code><a href="#topic+sys.call">sys.call</a></code> or
<code><a href="#topic+match.call">match.call</a></code> or if it is a primitive function that makes
use of the call.  This means that it is often safer to call primitive
functions with a wrapper, so that e.g. <code>lapply(ll, function(x)
  is.numeric(x))</code> is required to ensure that method dispatch for
<code>is.numeric</code> occurs correctly.
</p>
<p>If <code>expr</code> is a function call, be aware of assumptions about where
it is evaluated, and in particular what <code>...</code> might refer to.
You can pass additional named arguments to a function call as
additional named arguments to <code>replicate</code>: see &lsquo;Examples&rsquo;.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apply">apply</a></code>, <code><a href="#topic+tapply">tapply</a></code>,
<code><a href="#topic+mapply">mapply</a></code> for applying a function to <b>m</b>ultiple
arguments, and <code><a href="#topic+rapply">rapply</a></code> for a <b>r</b>ecursive version of
<code>lapply()</code>, <code><a href="#topic+eapply">eapply</a></code> for applying a function to each
entry in an <code><a href="#topic+environment">environment</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)

x &lt;- list(a = 1:10, beta = exp(-3:3), logic = c(TRUE,FALSE,FALSE,TRUE))
# compute the list mean for each list element
lapply(x, mean)
# median and quartiles for each list element
lapply(x, quantile, probs = 1:3/4)
sapply(x, quantile)
i39 &lt;- sapply(3:9, seq) # list of vectors
sapply(i39, fivenum)
vapply(i39, fivenum,
       c(Min. = 0, "1st Qu." = 0, Median = 0, "3rd Qu." = 0, Max. = 0))

## sapply(*, "array") -- artificial example
(v &lt;- structure(10*(5:8), names = LETTERS[1:4]))
f2 &lt;- function(x, y) outer(rep(x, length.out = 3), y)
(a2 &lt;- sapply(v, f2, y = 2*(1:5), simplify = "array"))
a.2 &lt;- vapply(v, f2, outer(1:3, 1:5), y = 2*(1:5))
stopifnot(dim(a2) == c(3,5,4), all.equal(a2, a.2),
          identical(dimnames(a2), list(NULL,NULL,LETTERS[1:4])))

hist(replicate(100, mean(rexp(10))))

## use of replicate() with parameters:
foo &lt;- function(x = 1, y = 2) c(x, y)
# does not work: bar &lt;- function(n, ...) replicate(n, foo(...))
bar &lt;- function(n, x) replicate(n, foo(x = x))
bar(5, x = 3)
</code></pre>

<hr>
<h2 id='Last.value'>Value of Last Evaluated Expression</h2><span id='topic+.Last.value'></span>

<h3>Description</h3>

<p>The value of the internal evaluation of a top-level <span class="rlang"><b>R</b></span> expression
is always assigned to <code>.Last.value</code> (in <code>package:base</code>)
before further processing (e.g., printing).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Last.value
</code></pre>


<h3>Details</h3>

<p>The value of a top-level assignment <em>is</em> put in <code>.Last.value</code>,
unlike S.
</p>
<p>Do not assign to <code>.Last.value</code> in the workspace, because this
will always mask the object of the same name in <code>package:base</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eval">eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These will not work correctly from example(),
## but they will in make check or if pasted in,
## as example() does not run them at the top level
gamma(1:15)          # think of some intensive calculation...
fac14 &lt;- .Last.value # keep them

library("splines") # returns invisibly
.Last.value    # shows what library(.) above returned

</code></pre>

<hr>
<h2 id='lazyLoad'>Lazy Load a Database of R Objects</h2><span id='topic+lazyLoad'></span><span id='topic+lazyLoadDBexec'></span>

<h3>Description</h3>

<p>Internal functions to lazy load a database of <span class="rlang"><b>R</b></span> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lazyLoad(filebase, envir = parent.frame(), filter)
lazyLoadDBexec(filebase, fun, filter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lazyLoad_+3A_filebase">filebase</code></td>
<td>
<p>The file path to the database, with no extension.</p>
</td></tr>
<tr><td><code id="lazyLoad_+3A_envir">envir</code></td>
<td>
<p>The environment into which objects are loaded.</p>
</td></tr>
<tr><td><code id="lazyLoad_+3A_filter">filter</code></td>
<td>
<p>An optional function which when called on a a character
vector of object names returns a logical vector: only objects for
which this is true will be loaded.</p>
</td></tr>
<tr><td><code id="lazyLoad_+3A_fun">fun</code></td>
<td>
<p>Function of one argument, an environment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are internal functions for use only by <span class="rlang"><b>R</b></span> itself.
</p>
<p>The function <code>lazyLoad</code> is the workhorse function called by the
package loader to load the code for a package from a database.  The
database consists of two binary files, &lsquo;<span class="file"><var>filebase</var>.rdb</span>&rsquo; (the
objects) and &lsquo;<span class="file"><var>filebase</var>.rdx</span>&rsquo; (an index).
</p>
<p>The objects are not themselves loaded into <code>envir</code>: rather
promises are created that will load the object from the database on
first access.  (See <code><a href="#topic+delayedAssign">delayedAssign</a></code>.)
</p>
<p>The function <code>lazyLoadDBexec</code> contains the core implementation
and is also used by the mechanism for loading processed help file
data.
</p>


<h3>Author(s)</h3>

<p>Luke Tierney</p>

<hr>
<h2 id='length'>Length of an Object</h2><span id='topic+length'></span><span id='topic+length+3C-'></span><span id='topic+length+3C-.factor'></span>

<h3>Description</h3>

<p>Get or set the length of vectors (including lists) and factors, and of
any other <span class="rlang"><b>R</b></span> object for which a method has been defined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>length(x)
length(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="length_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.  For replacement, a vector or factor.</p>
</td></tr>
<tr><td><code id="length_+3A_value">value</code></td>
<td>
<p>a non-negative integer or double (which will be rounded down).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both functions are generic: you can write methods to handle specific
classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.  <code>length&lt;-</code> has a
<code>"factor"</code> method.
</p>
<p>The replacement form can be used to reset the length of a vector.  If
a vector is shortened, extra values are discarded and when a vector is
lengthened, it is padded out to its new length with <code><a href="#topic+NA">NA</a></code>s
(<code>nul</code> for raw vectors).
</p>
<p>Both are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p>The default method for <code>length</code> currently returns a non-negative
<code><a href="#topic+integer">integer</a></code> of length 1, except for vectors of more than
<code class="reqn">2^{31}-1</code> elements, when it returns a double.
</p>
<p>For vectors (including lists) and factors the length is the number of
elements.  For an environment it is the number of objects in the
environment, and <code>NULL</code> has length 0.  For expressions and
pairlists (including <a href="#topic+language+20objects">language objects</a> and dot-dot-dot lists) it is the
length of the pairlist chain.  All other objects (including functions)
have length one: note that for functions this differs from S.
</p>
<p>The replacement form removes all the attributes of <code>x</code> except its
names, which are adjusted (and if necessary extended by <code>""</code>).
</p>


<h3>Warning</h3>

<p>Package authors have written methods that return a result of length
other than one (<a href="https://CRAN.R-project.org/package=Formula"><span class="pkg">Formula</span></a>) and that return a vector of type
<code><a href="#topic+double">double</a></code> (<a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a>), even with non-integer values
(earlier versions of <a href="https://CRAN.R-project.org/package=sets"><span class="pkg">sets</span></a>).  Where a single double value is
returned that can be represented as an integer it is returned as a
length-one integer vector.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code>nchar</code> for counting the number of characters in character
vectors, <code><a href="#topic+lengths">lengths</a></code> for getting the length of every element
in a list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>length(diag(4))  # = 16 (4 x 4)
length(options())  # 12 or more
length(y ~ x1 + x2 + x3)  # 3
length(expression(x, {y &lt;- x^2; y+2}, x^y))  # 3

## from example(warpbreaks)
require(stats)

fm1 &lt;- lm(breaks ~ wool * tension, data = warpbreaks)
length(fm1$call)      # 3, lm() and two arguments.
length(formula(fm1))  # 3, ~ lhs rhs
</code></pre>

<hr>
<h2 id='lengths'>Lengths of List or Vector Elements</h2><span id='topic+lengths'></span>

<h3>Description</h3>

<p>Get the length of each element of a <code><a href="#topic+list">list</a></code> or atomic
vector (<code><a href="#topic+is.atomic">is.atomic</a></code>) as an integer or numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lengths(x, use.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lengths_+3A_x">x</code></td>
<td>
<p>a <code><a href="#topic+list">list</a></code>, list-like such as an
<code><a href="#topic+expression">expression</a></code>, <code>NULL</code> or an atomic vector (for which
the result is trivial).</p>
</td></tr>
<tr><td><code id="lengths_+3A_use.names">use.names</code></td>
<td>
<p>logical indicating if the result should inherit the
<code><a href="#topic+names">names</a></code> from <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function loops over <code>x</code> and returns a compatible vector
containing the length of each element in <code>x</code>.  Effectively,
<code>length(x[[i]])</code> is called for all <code>i</code>, so any methods on
<code>length</code> are considered.
</p>
<p><code>lengths</code> is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Value</h3>

<p>A non-negative <code><a href="#topic+integer">integer</a></code> of length <code>length(x)</code>,
except when any element has a length of more than
<code class="reqn">2^{31}-1</code> elements, when it returns a double vector.
When <code>use.names</code> is true, the names are taken from the names on
<code>x</code>, if any.
</p>


<h3>Note</h3>

<p>One raison d'être of <code>lengths(x)</code> is its use as a
more efficient version of <code>sapply(x, length)</code> and similar
<code>*apply</code> calls to <code><a href="#topic+length">length</a></code>.  This is the reason why
<code>x</code> may be an atomic vector, even though <code>lengths(x)</code> is
trivial in that case.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+length">length</a></code> for getting the length of any <span class="rlang"><b>R</b></span> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
## summarize by month
l &lt;- split(airquality$Ozone, airquality$Month)
avgOz &lt;- lapply(l, mean, na.rm=TRUE)
## merge result
airquality$avgOz &lt;- rep(unlist(avgOz, use.names=FALSE), lengths(l))
## but this is safer and cleaner, but can be slower
airquality$avgOz &lt;- unsplit(avgOz, airquality$Month)

## should always be true, except when a length does not fit in 32 bits
stopifnot(identical(lengths(l), vapply(l, length, integer(1L))))

## empty lists are not a problem
x &lt;- list()
stopifnot(identical(lengths(x), integer()))

## nor are "list-like" expressions:
lengths(expression(u, v, 1+ 0:9))

## and we should dispatch to length methods
f &lt;- c(rep(1, 3), rep(2, 6), 3)
dates &lt;- split(as.POSIXlt(Sys.time() + 1:10), f)
stopifnot(identical(lengths(dates), vapply(dates, length, integer(1L))))
</code></pre>

<hr>
<h2 id='levels'>Levels Attributes</h2><span id='topic+levels'></span><span id='topic+levels.default'></span><span id='topic+levels+3C-'></span><span id='topic+levels+3C-.factor'></span>

<h3>Description</h3>

<p><code>levels</code> provides access to the levels attribute of a variable.
The first form returns the value of the levels of its argument
and the second sets the attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>levels(x)
levels(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="levels_+3A_x">x</code></td>
<td>
<p>an object, for example a factor.</p>
</td></tr>
<tr><td><code id="levels_+3A_value">value</code></td>
<td>
<p>a valid value for <code>levels(x)</code>.
For the default method, <code>NULL</code> or a character vector.  For the
<code>factor</code> method, a vector of character strings with length at
least the number of levels of <code>x</code>, or a named list specifying how to
rename the levels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both the extractor and replacement forms are generic and new methods
can be written for them.  The most important method for the replacement
function is that for <code><a href="#topic+factor">factor</a></code>s.
</p>
<p>For the factor replacement method, a <code>NA</code> in <code>value</code>
causes that level to be removed from the levels and the elements
formerly with that level to be replaced by <code>NA</code>.
</p>
<p>Note that for a factor, replacing the levels via
<code>levels(x) &lt;- value</code> is not the same as (and is preferred to)
<code>attr(x, "levels") &lt;- value</code>.
</p>
<p>The replacement function is <a href="#topic+primitive">primitive</a>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlevels">nlevels</a></code>, <code><a href="stats.html#topic+relevel">relevel</a></code>, <code><a href="stats.html#topic+reorder">reorder</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## assign individual levels
x &lt;- gl(2, 4, 8)
levels(x)[1] &lt;- "low"
levels(x)[2] &lt;- "high"
x

## or as a group
y &lt;- gl(2, 4, 8)
levels(y) &lt;- c("low", "high")
y

## combine some levels
z &lt;- gl(3, 2, 12, labels = c("apple", "salad", "orange"))
z
levels(z) &lt;- c("fruit", "veg", "fruit")
z

## same, using a named list
z &lt;- gl(3, 2, 12, labels = c("apple", "salad", "orange"))
z
levels(z) &lt;- list("fruit" = c("apple","orange"),
                  "veg"   = "salad")
z

## we can add levels this way:
f &lt;- factor(c("a","b"))
levels(f) &lt;- c("c", "a", "b")
f

f &lt;- factor(c("a","b"))
levels(f) &lt;- list(C = "C", A = "a", B = "b")
f
</code></pre>

<hr>
<h2 id='libcurlVersion'>
Report Version of libcurl
</h2><span id='topic+libcurlVersion'></span>

<h3>Description</h3>

<p>Report version of <code>libcurl</code> in use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>libcurlVersion()
</code></pre>


<h3>Value</h3>

<p>A character string, with value the <code>libcurl</code> version in use or
<code>""</code> if none is.  If <code>libcurl</code> is available, has attributes
</p>
<table>
<tr><td><code>ssl_version</code></td>
<td>
<p>A character string naming the <abbr>SSL</abbr>/<abbr>TLS</abbr> implementation
and version, possibly <code>"none"</code>.  It is intended for the version
of OpenSSL used, but not all implementations of <code>libcurl</code> use
OpenSSL &mdash; for example macOS reports <code>"SecureTranspart"</code>, its
wrapper for <abbr>SSL</abbr>/<abbr>TLS</abbr>.</p>
</td></tr>
<tr><td><code>libssh_version</code></td>
<td>
<p>A character string naming the <code>libssh</code> version,
which may or may not be available (it is used for
e.g. <code>scp</code> and <code>sftp</code> protocols). Where present,
something like <code>"libssh2/1.5.0"</code>.</p>
</td></tr>
<tr><td><code>protocols</code></td>
<td>
<p>A character vector of the names of supported
protocols, also known as &lsquo;schemes&rsquo; when part of a URL.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>In late 2017 a <code>libcurl</code> installation was seen divided into two
libraries, <code>libcurl</code> and <code>libcurl-feature</code>, and the first
had been updated but not the second.  As the compiled function
recording the version was in the latter, the version reported by
<code>libcurlVersion</code> was misleading.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for versions of other third-party
software.
</p>
<p><code><a href="#topic+curlGetHeaders">curlGetHeaders</a></code>, <code><a href="utils.html#topic+download.file">download.file</a></code> and
<code><a href="#topic+url">url</a></code> for functions which (optionally) use <code>libcurl</code>.
</p>
<p><a href="https://curl.se/docs/sslcerts.html">https://curl.se/docs/sslcerts.html</a> and
<a href="https://curl.se/docs/ssl-compared.html">https://curl.se/docs/ssl-compared.html</a> for more details on
<abbr>SSL</abbr> versions (the current standard being known as <abbr>TLS</abbr>).  Normally
<code>libcurl</code> used with <span class="rlang"><b>R</b></span> uses SecureTransport on macOS, OpenSSL on
Windows and GnuTLS, NSS or OpenSSL on Unix-alikes.  (At the time of
writing Debian-based Linuxen use GnuTLS and RedHat-based ones use
OpenSSL, having previously used NSS.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>libcurlVersion()
</code></pre>

<hr>
<h2 id='libPaths'>Search Paths for Packages</h2><span id='topic+.Library'></span><span id='topic+.Library.site'></span><span id='topic+.libPaths'></span><span id='topic+R_LIBS'></span><span id='topic+R_LIBS_SITE'></span><span id='topic+R_LIBS_USER'></span>

<h3>Description</h3>

<p><code>.libPaths</code> gets/sets the library trees within which packages are
looked for.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.libPaths(new, include.site = TRUE)

.Library
.Library.site
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="libPaths_+3A_new">new</code></td>
<td>
<p>a character vector with the locations of <span class="rlang"><b>R</b></span> library
trees.  Tilde expansion (<code><a href="#topic+path.expand">path.expand</a></code>) is done, and if
any element contains one of <code>*?[</code>, globbing is done where
supported by the platform: see <code><a href="#topic+Sys.glob">Sys.glob</a></code>.</p>
</td></tr>
<tr><td><code id="libPaths_+3A_include.site">include.site</code></td>
<td>
<p>a logical value indicating whether the value of
<code>.Library.site</code> should be included in the new set of library
tree locations.  Defaulting to <code>TRUE</code>, it is ignored when
<code>.libPaths</code> is called without the <code>new</code> argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>.Library</code> is a character string giving the location of the
default library, the &lsquo;<span class="file">library</span>&rsquo; subdirectory of <span class="env">R_HOME</span>.
</p>
<p><code>.Library.site</code> is a (possibly empty) character vector giving the
locations of the site libraries.
</p>
<p><code>.libPaths</code> is used for getting or setting the library trees that <span class="rlang"><b>R</b></span>
knows about and hence uses when looking for packages (the library search
path).  If called with argument <code>new</code>, by default, the library search
path is set to the existing directories in <code>unique(c(new,
  .Library.site, .Library))</code> and this is returned.  If <code>include.site</code>
is <code>FALSE</code> when the <code>new</code> argument is set, <code>.Library.site</code>
is not added to the new library search path.  If called without the
<code>new</code> argument, a character vector with the currently active library
trees is returned.
</p>
<p>How paths in <code>new</code> with a trailing slash are treated is
OS-dependent.  On a POSIX filesystem existing directories can usually
be specified with a trailing slash. On Windows filepaths with a
trailing slash (or backslash) are invalid and existing directories
specified with a trailing slash may not be added to the library search path.
</p>
<p>At startup, the library search path is initialized from the
environment variables <span class="env">R_LIBS</span>, <span class="env">R_LIBS_USER</span> and
<span class="env">R_LIBS_SITE</span>, which if set should give lists of directories where
<span class="rlang"><b>R</b></span> library trees are rooted, colon-separated on Unix-alike systems and
semicolon-separated on Windows.  For the latter two, a value of
<code>NULL</code> indicates an empty list of directories. (Note that as from
<span class="rlang"><b>R</b></span> 4.2.0, both are set by <span class="rlang"><b>R</b></span> start-up code if not already set or empty
so can be interrogated from an <span class="rlang"><b>R</b></span> session to find their defaults:
in earlier versions this was true only for <span class="env">R_LIBS_USER</span>.)
</p>
<p>First, <code>.Library.site</code> is initialized from <span class="env">R_LIBS_SITE</span>.  If
this is unset or empty, the &lsquo;<span class="file">site-library</span>&rsquo; subdirectory of
<span class="env">R_HOME</span> is used.  Only directories which exist at the time of
initialization are retained.  Then, <code>.libPaths()</code> is called with
the combination of the directories given by <span class="env">R_LIBS</span> and
<span class="env">R_LIBS_USER</span>.  By default <span class="env">R_LIBS</span> is unset, and if
<span class="env">R_LIBS_USER</span> is unset or empty, it is set to directory
&lsquo;<span class="file">R/<var>R.version$platform</var>-library/<var>x.y</var></span>&rsquo; of the home
directory on Unix-alike systems (or
&lsquo;<span class="file">Library/R/<var>m</var>/<var>x.y</var>/library</span>&rsquo; for CRAN macOS builds, with
<var>m</var> <code><a href="#topic+Sys.info">Sys.info</a>()["machine"]</code>) and
&lsquo;<span class="file">R/win-library/<var>x.y</var></span>&rsquo; subdirectory of <span class="env">LOCALAPPDATA</span> on
Windows, for <span class="rlang"><b>R</b></span> <var>x.y.z</var>.
</p>
<p>Both <span class="env">R_LIBS_USER</span> and <span class="env">R_LIBS_SITE</span> feature possible
expansion of specifiers for <span class="rlang"><b>R</b></span>-version-specific information as part of
the startup process.  The possible conversion specifiers all start
with a &lsquo;<span class="samp">&#8288;%&#8288;</span>&rsquo; and are followed by a single letter (use &lsquo;<span class="samp">&#8288;%%&#8288;</span>&rsquo;
to obtain &lsquo;<span class="samp">&#8288;%&#8288;</span>&rsquo;), with currently available conversion
specifications as follows:
</p>

<dl>
<dt>&lsquo;<span class="samp">&#8288;%V&#8288;</span>&rsquo;</dt><dd><p><span class="rlang"><b>R</b></span> version number including the patch level (e.g.,
&lsquo;<span class="samp">&#8288;2.5.0&#8288;</span>&rsquo;).</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;%v&#8288;</span>&rsquo;</dt><dd><p><span class="rlang"><b>R</b></span> version number excluding the patch level (e.g.,
&lsquo;<span class="samp">&#8288;2.5&#8288;</span>&rsquo;).</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;%p&#8288;</span>&rsquo;</dt><dd><p>the platform for which <span class="rlang"><b>R</b></span> was built, the value of
<code><a href="#topic+R.version">R.version</a>$platform</code>.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;%o&#8288;</span>&rsquo;</dt><dd><p>the underlying operating system, the value of
<code><a href="#topic+R.version">R.version</a>$os</code>.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;%a&#8288;</span>&rsquo;</dt><dd><p>the architecture (CPU) <span class="rlang"><b>R</b></span> was built on/for, the
value of <code><a href="#topic+R.version">R.version</a>$arch</code>.</p>
</dd>
</dl>

<p>(See <code><a href="#topic+version">version</a></code> for details on R version information.)
In addition, &lsquo;<span class="samp">&#8288;%U&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;%S&#8288;</span>&rsquo; expand to the <span class="rlang"><b>R</b></span> defaults for,
respectively, <span class="env">R_LIBS_USER</span> and <span class="env">R_LIBS_SITE</span>.
</p>
<p>Function <code>.libPaths</code> always uses the values of <code>.Library</code>
and <code>.Library.site</code> in the base namespace.  <code>.Library.site</code>
can be set by the site in &lsquo;<span class="file">Rprofile.site</span>&rsquo;, which should be
followed by a call to <code>.libPaths(.libPaths())</code> to make use of the
updated value.
</p>
<p>For consistency, the paths are always normalized by
<code><a href="#topic+normalizePath">normalizePath</a>(winslash = "/")</code>.
</p>
<p><span class="env">LOCALAPPDATA</span> (usually <code>C:\Users\username\AppData\Local</code>) on
Windows is a hidden directory and may not be viewed by some software. It
may be opened by <code>shell.exec(Sys.getenv("LOCALAPPDATA"))</code>.
</p>


<h3>Value</h3>

<p>A character vector of file paths.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+library">library</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>.libPaths()                 # all library trees R knows about
</code></pre>

<hr>
<h2 id='library'>Loading/Attaching and Listing of Packages</h2><span id='topic+library'></span><span id='topic+require'></span><span id='topic+conflictRules'></span><span id='topic+.noGenerics'></span><span id='topic+format.libraryIQR'></span><span id='topic+print.libraryIQR'></span><span id='topic+format.packageInfo'></span><span id='topic+print.packageInfo'></span>

<h3>Description</h3>

<p><code>library</code> and <code>require</code> load and attach add-on packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>library(package, help, pos = 2, lib.loc = NULL,
        character.only = FALSE, logical.return = FALSE,
        warn.conflicts, quietly = FALSE,
        verbose = getOption("verbose"),
        mask.ok, exclude, include.only,
        attach.required = missing(include.only))

require(package, lib.loc = NULL, quietly = FALSE,
        warn.conflicts,
        character.only = FALSE,
        mask.ok, exclude, include.only,
        attach.required = missing(include.only))

conflictRules(pkg, mask.ok = NULL, exclude = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="library_+3A_package">package</code>, <code id="library_+3A_help">help</code></td>
<td>
<p>the name of a package, given as a <a href="#topic+name">name</a> or
literal character string, or a character string, depending on
whether <code>character.only</code> is <code>FALSE</code> (default) or
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="library_+3A_pos">pos</code></td>
<td>
<p>the position on the search list at which to attach the
loaded namespace.  Can also be the name of a position on the current
search list as given by <code><a href="#topic+search">search</a>()</code>.</p>
</td></tr>
<tr><td><code id="library_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector describing the location of <span class="rlang"><b>R</b></span>
library trees to search through, or <code>NULL</code>.  The default value
of <code>NULL</code> corresponds to all libraries currently known to
<code><a href="#topic+.libPaths">.libPaths</a>()</code>.
Non-existent library trees are silently ignored.</p>
</td></tr>
<tr><td><code id="library_+3A_character.only">character.only</code></td>
<td>
<p>a logical indicating whether <code>package</code> or
<code>help</code> can be assumed to be character strings.</p>
</td></tr>
<tr><td><code id="library_+3A_logical.return">logical.return</code></td>
<td>
<p>logical.  If it is <code>TRUE</code>,  <code>FALSE</code> or
<code>TRUE</code> is returned to indicate success.</p>
</td></tr>
<tr><td><code id="library_+3A_warn.conflicts">warn.conflicts</code></td>
<td>
<p>logical.  If <code>TRUE</code>, warnings are
printed about <code><a href="#topic+conflicts">conflicts</a></code> from attaching the new
package.  A conflict is a function masking a function,
or a non-function masking a non-function. The default is <code>TRUE</code>
unless specified as <code>FALSE</code> in the <code>conflicts.policy</code> option.
</p>
</td></tr>
<tr><td><code id="library_+3A_verbose">verbose</code></td>
<td>
<p>a logical.  If <code>TRUE</code>, additional diagnostics are
printed.</p>
</td></tr>
<tr><td><code id="library_+3A_quietly">quietly</code></td>
<td>
<p>a logical.  If <code>TRUE</code>, no message confirming
package attaching is printed, and most often, no errors/warnings are
printed if package attaching fails.</p>
</td></tr>
<tr><td><code id="library_+3A_pkg">pkg</code></td>
<td>
<p>character string naming a package.</p>
</td></tr>
<tr><td><code id="library_+3A_mask.ok">mask.ok</code></td>
<td>
<p>character vector of names of objects that can mask
objects on the search path without signaling an error when strict
conflict checking is enabled.</p>
</td></tr>
<tr><td><code id="library_+3A_exclude">exclude</code>, <code id="library_+3A_include.only">include.only</code></td>
<td>
<p>character vector of names of objects to
exclude or include in the attached frame. Only one of these arguments
may be used in a call to <code>library</code> or <code>require</code>.</p>
</td></tr>
<tr><td><code id="library_+3A_attach.required">attach.required</code></td>
<td>
<p>logical specifying whether required packages
listed in the <code>Depends</code> clause of the <code>DESCRIPTION</code> file
should be attached automatically.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>library(package)</code> and <code>require(package)</code> both load the
namespace of the package with name <code>package</code> and attach it on the
search list.  <code>require</code> is designed for use inside other
functions; it returns <code>FALSE</code> and gives a warning (rather than an
error as <code>library()</code> does by default) if the package does not
exist.  Both functions check and update the list of currently attached
packages and do not reload a namespace which is already loaded.  (If
you want to reload such a package, call <code><a href="#topic+detach">detach</a>(unload =
  TRUE)</code> or <code><a href="#topic+unloadNamespace">unloadNamespace</a></code> first.)  If you want to load a
package without attaching it on the search list, see
<code><a href="#topic+requireNamespace">requireNamespace</a></code>.
</p>
<p>To suppress messages during the loading of packages use
<code><a href="#topic+suppressPackageStartupMessages">suppressPackageStartupMessages</a></code>: this will suppress all
messages from <span class="rlang"><b>R</b></span> itself but not necessarily all those from package
authors.
</p>
<p>If <code>library</code> is called with no <code>package</code> or <code>help</code>
argument, it lists all available packages in the libraries specified
by <code>lib.loc</code>, and returns the corresponding information in an
object of class <code>"libraryIQR"</code>.  (The structure of this class may
change in future versions.)  Use <code>.packages(all = TRUE)</code> to
obtain just the names of all available packages, and
<code><a href="utils.html#topic+installed.packages">installed.packages</a>()</code> for even more information.
</p>
<p><code>library(help = somename)</code> computes basic information about the
package <span class="pkg">somename</span>, and returns this in an object of class
<code>"packageInfo"</code>.  (The structure of this class may change in
future versions.)  When used with the default value (<code>NULL</code>) for
<code>lib.loc</code>, the attached packages are searched before the libraries.
</p>


<h3>Value</h3>

<p>Normally <code>library</code> returns (invisibly) the list of attached
packages, but <code>TRUE</code> or <code>FALSE</code> if <code>logical.return</code> is
<code>TRUE</code>.  When called as <code>library()</code> it returns an object of
class <code>"libraryIQR"</code>, and for <code>library(help=)</code>, one of
class <code>"packageInfo"</code>.
</p>
<p><code>require</code> returns (invisibly) a logical indicating whether the required
package is available.
</p>


<h3>Conflicts</h3>

<p>Handling of conflicts depends on the setting of the
<code>conflicts.policy</code> option. If this option is not set, then
conflicts result in warning messages if the argument
<code>warn.conflicts</code> is <code>TRUE</code>. If the option is set to the
character string <code>"strict"</code>, then all unresolved conflicts signal
errors.  Conflicts can be resolved using the <code>mask.ok</code>,
<code>exclude</code>, and <code>include.only</code> arguments to <code>library</code> and
<code>require</code>. Defaults for <code>mask.ok</code> and <code>exclude</code> can be
specified using <code>conflictRules</code>.
</p>
<p>If the <code>conflicts.policy</code> option is set to the string
<code>"depends.ok"</code> then conflicts resulting from attaching declared
dependencies will not produce errors, but other conflicts will.
This is likely to be the best setting for most users wanting some
additional protection against unexpected conflicts.
</p>
<p>The policy can be tuned further by specifying the
<code>conflicts.policy</code> option as a named list with the following
fields:
</p>

<dl>
<dt><code>error</code>:</dt><dd><p>logical; if <code>TRUE</code> treat unresolved
conflicts as errors.</p>
</dd>
<dt><code>warn</code>:</dt><dd><p>logical; unless <code>FALSE</code> issue a warning
message when conflicts are found.</p>
</dd>
<dt><code>generics.ok</code>:</dt><dd><p>logical; if <code>TRUE</code> ignore conflicts
created by defining S4 generics for functions on the search path.</p>
</dd>
<dt><code>depends.ok</code>:</dt><dd><p>logical; if <code>TRUE</code> do not treat
conflicts with required packages as errors.</p>
</dd>
<dt><code>can.mask</code>:</dt><dd><p>character vector of names of packages that
are allowed to be masked. These would typically be base packages
attached by default.</p>
</dd>
</dl>



<h3>Licenses</h3>

<p>Some packages have restrictive licenses, and there is a mechanism to
allow users to be aware of such licenses.  If
<code><a href="#topic+getOption">getOption</a>("checkPackageLicense") == TRUE</code>, then at first
use of a namespace of a package with a not-known-to-be-<abbr>FOSS</abbr> (see
below) license the user is asked to view and accept the license: a
list of accepted licenses is stored in file &lsquo;<span class="file">~/.R/licensed</span>&rsquo;.  In
a non-interactive session it is an error to use such a package whose
license has not already been recorded as accepted.
</p>
<p>Free or Open Source Software (<abbr>FOSS</abbr>,
e.g. <a href="https://en.wikipedia.org/wiki/FOSS">https://en.wikipedia.org/wiki/FOSS</a>) packages are
determined by the same filters used by
<code><a href="utils.html#topic+available.packages">available.packages</a></code> but applied to just the current
package, not its dependencies.
</p>
<p>There can also be a site-wide file &lsquo;<span class="file">R_HOME/etc/licensed.site</span>&rsquo; of
packages (one per line).
</p>


<h3>Formal methods</h3>

<p><code>library</code> takes some further actions when package <span class="pkg">methods</span>
is attached (as it is by default).  Packages may define formal generic
functions as well as re-defining functions in other packages (notably
<span class="pkg">base</span>) to be generic, and this information is cached whenever
such a namespace is loaded after <span class="pkg">methods</span> and re-defined functions
(<a href="methods.html#topic+implicit+20generic">implicit generic</a>s) are excluded from the list of conflicts.
The caching and check for conflicts require looking for a pattern of
objects; the search may be avoided by defining an object
<code>.noGenerics</code> (with any value) in the namespace.  Naturally, if the
package <em>does</em> have any such methods, this will prevent them from
being used.
</p>


<h3>Note</h3>

<p><code>library</code> and <code>require</code> can only load/attach an
<em>installed</em> package, and this is detected by having a
&lsquo;<span class="file">DESCRIPTION</span>&rsquo; file containing a &lsquo;<span class="samp">&#8288;Built:&#8288;</span>&rsquo; field.
</p>
<p>Under Unix-alikes, the code checks that the package was installed
under a similar operating system as given by <code>R.version$platform</code>
(the canonical name of the platform under which R was compiled),
provided it contains compiled code.  Packages which do not contain
compiled code can be shared between Unix-alikes, but not to other OSes
because of potential problems with line endings and OS-specific help
files.  If sub-architectures are used, the OS similarity is not
checked since the OS used to build may differ
(e.g. <code>i386-pc-linux-gnu</code> code can be built on an
<code>x86_64-unknown-linux-gnu</code> OS).
</p>
<p>The package name given to <code>library</code> and <code>require</code> must match
the name given in the package's &lsquo;<span class="file">DESCRIPTION</span>&rsquo; file exactly, even
on case-insensitive file systems such as are common on Windows and
macOS.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.libPaths">.libPaths</a></code>, <code><a href="#topic+.packages">.packages</a></code>.
</p>
<p><code><a href="#topic+attach">attach</a></code>, <code><a href="#topic+detach">detach</a></code>, <code><a href="#topic+search">search</a></code>,
<code><a href="#topic+objects">objects</a></code>, <code><a href="#topic+autoload">autoload</a></code>,
<code><a href="#topic+requireNamespace">requireNamespace</a></code>,
<code><a href="#topic+library.dynam">library.dynam</a></code>, <code><a href="utils.html#topic+data">data</a></code>,
<code><a href="utils.html#topic+install.packages">install.packages</a></code> and
<code><a href="utils.html#topic+installed.packages">installed.packages</a></code>;
<code><a href="utils.html#topic+INSTALL">INSTALL</a></code>, <code><a href="utils.html#topic+REMOVE">REMOVE</a></code>.
</p>
<p>The initial set of packages attached is set by
<code><a href="#topic+options">options</a>(defaultPackages=)</code>: see also <code><a href="#topic+Startup">Startup</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library()                   # list all available packages
library(lib.loc = .Library) # list all packages in the default library
library(help = splines)     # documentation on package 'splines'
library(splines)            # attach package 'splines'
require(splines)            # the same
search()                    # "splines", too
detach("package:splines")

# if the package name is in a character vector, use
pkg &lt;- "splines"
library(pkg, character.only = TRUE)
detach(pos = match(paste("package", pkg, sep = ":"), search()))

require(pkg, character.only = TRUE)
detach(pos = match(paste("package", pkg, sep = ":"), search()))

require(nonexistent)        # FALSE
## Not run: 
## if you want to mask as little as possible, use
library(mypkg, pos = "package:base")

## End(Not run)</code></pre>

<hr>
<h2 id='library.dynam'>Loading DLLs from Packages</h2><span id='topic+library.dynam'></span><span id='topic+library.dynam.unload'></span><span id='topic+.dynLibs'></span>

<h3>Description</h3>

<p>Load the specified file of compiled code if it has not been loaded
already, or unloads it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>library.dynam(chname, package, lib.loc,
              verbose = getOption("verbose"),
              file.ext = .Platform$dynlib.ext, ...)

library.dynam.unload(chname, libpath,
                     verbose = getOption("verbose"),
                     file.ext = .Platform$dynlib.ext)

.dynLibs(new)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="library.dynam_+3A_chname">chname</code></td>
<td>
<p>a character string naming a DLL (also known as a dynamic
shared object or library) to load.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_package">package</code></td>
<td>
<p>a character vector with the name of package.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector describing the location of <span class="rlang"><b>R</b></span>
library trees to search through.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_libpath">libpath</code></td>
<td>
<p>the path to the loaded package whose DLL is to be unloaded.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_verbose">verbose</code></td>
<td>
<p>a logical value indicating whether an announcement
is printed on the console before loading the DLL.  The
default value is taken from the verbose entry in the system
<code><a href="#topic+options">options</a></code>.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_file.ext">file.ext</code></td>
<td>
<p>the extension (including &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; if used) to append
to the file name to specify the library to be loaded.  This defaults
to the appropriate value for the operating system.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_...">...</code></td>
<td>
<p>additional arguments needed by some libraries that
are passed to the call to <code><a href="#topic+dyn.load">dyn.load</a></code> to control
how the library and its dependencies are loaded.</p>
</td></tr>
<tr><td><code id="library.dynam_+3A_new">new</code></td>
<td>
<p>a list of <code>"DLLInfo"</code> objects corresponding to the
DLLs loaded by packages.  Can be missing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+dyn.load">dyn.load</a></code> for what sort of objects these functions handle.
</p>
<p><code>library.dynam</code> is designed to be used inside a package rather
than at the command line, and should really only be used inside
<code><a href="#topic+.onLoad">.onLoad</a></code>.  The system-specific extension for DLLs (e.g.,
&lsquo;<span class="file">.so</span>&rsquo; or &lsquo;<span class="file">.sl</span>&rsquo; on Unix-alike systems,
&lsquo;<span class="file">.dll</span>&rsquo; on Windows) should not be added.
</p>
<p><code>library.dynam.unload</code> is designed for use in
<code><a href="#topic+.onUnload">.onUnload</a></code>: it unloads the DLL and updates the value of
<code>.dynLibs()</code>
</p>
<p><code>.dynLibs</code> is used for getting (with no argument) or setting the
DLLs which are currently loaded by packages (using <code>library.dynam</code>).
</p>


<h3>Value</h3>

<p>If <code>chname</code> is not specified, <code>library.dynam</code> returns an
object of class <code>"<a href="#topic+DLLInfoList">DLLInfoList</a>"</code> corresponding to the DLLs
loaded by packages.
</p>
<p>If <code>chname</code> is specified, an object of class
<code>"<a href="#topic+DLLInfo">DLLInfo</a>"</code> that identifies the DLL and which can be used
in future calls is returned invisibly.  Note that the class
<code>"<a href="#topic+DLLInfo">DLLInfo</a>"</code> has a method for <code>$</code> which can be used to
resolve native symbols within that DLL.
</p>
<p><code>library.dynam.unload</code> invisibly returns an object of class
<code>"<a href="#topic+DLLInfo">DLLInfo</a>"</code> identifying the DLL successfully unloaded.
</p>
<p><code>.dynLibs</code> returns an object of class <code>"<a href="#topic+DLLInfoList">DLLInfoList</a>"</code>
corresponding to its current value.
</p>


<h3>Warning</h3>

<p>Do not use <code><a href="#topic+dyn.unload">dyn.unload</a></code> on a DLL loaded by
<code>library.dynam</code>: use <code>library.dynam.unload</code> to ensure
that <code>.dynLibs</code> gets updated.  Otherwise a subsequent call to
<code>library.dynam</code> will be told the object is already loaded.
</p>
<p>Note that whether or not it is possible to unload a DLL and then
reload a revised version of the same file is OS-dependent: see the
&lsquo;Value&rsquo; section of the help for  <code><a href="#topic+dyn.unload">dyn.unload</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getLoadedDLLs">getLoadedDLLs</a></code> for information on <code>"DLLInfo"</code> and
<code>"DLLInfoList"</code> objects.
</p>
<p><code><a href="#topic+.onLoad">.onLoad</a></code>, <code><a href="#topic+library">library</a></code>,
<code><a href="#topic+dyn.load">dyn.load</a></code>, <code><a href="#topic+.packages">.packages</a></code>,
<code><a href="#topic+.libPaths">.libPaths</a></code>
</p>
<p><code><a href="utils.html#topic+SHLIB">SHLIB</a></code> for how to create suitable DLLs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Which DLLs were dynamically loaded by packages?
library.dynam()

## More on library.dynam.unload() :
require(nlme)
nlme:::.onUnload # shows library.dynam.unload() call
detach("package:nlme")  # by default, unload=FALSE ,  so,
tail(library.dynam(), 2)# nlme still there

## How to unload the DLL ?
## Best is to unload the namespace,  unloadNamespace("nlme")
## If we need to do it separately which should be exceptional:
pd.file &lt;- attr(packageDescription("nlme"), "file")
library.dynam.unload("nlme", libpath = sub("/Meta.*", '', pd.file))
tail(library.dynam(), 2)# 'nlme' is gone now
unloadNamespace("nlme") # now gives warning

</code></pre>

<hr>
<h2 id='license'>The R License Terms</h2><span id='topic+license'></span><span id='topic+licence'></span>

<h3>Description</h3>

<p>The license terms under which <span class="rlang"><b>R</b></span> is distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>license()
licence()
</code></pre>


<h3>Details</h3>

<p><span class="rlang"><b>R</b></span> is distributed under the terms of the GNU GENERAL PUBLIC LICENSE,
either Version 2, June 1991 or Version 3, June 2007.  A copy of the
version 2 license is in file &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/doc/COPYING</span>&rsquo;
and can be viewed by <code>RShowDoc("COPYING")</code>.  Version 3 of the
license can be displayed by <code>RShowDoc("GPL-3")</code>.
</p>
<p>A small number of files (some of the API header files) are distributed
under the LESSER GNU GENERAL PUBLIC LICENSE, version 2.1 or later.  A
copy of this license is in file &lsquo;<span class="file"><var><a href="#topic+R_SHARE_DIR">R_SHARE_DIR</a></var>/licenses/LGPL-2.1</span>&rsquo;
and can be viewed by <code>RShowDoc("LGPL-2.1")</code>.  Version 3 of the
license can be displayed by <code>RShowDoc("LGPL-3")</code>.
</p>

<hr>
<h2 id='list'>Lists &ndash; Generic and Dotted Pairs</h2><span id='topic+list'></span><span id='topic+pairlist'></span><span id='topic+alist'></span><span id='topic+as.list'></span><span id='topic+as.list.default'></span><span id='topic+as.list.data.frame'></span><span id='topic+as.list.environment'></span><span id='topic+as.list.factor'></span><span id='topic+as.list.function'></span><span id='topic+as.pairlist'></span><span id='topic+is.list'></span><span id='topic+is.pairlist'></span>

<h3>Description</h3>

<p>Functions to construct, coerce and check for both kinds of <span class="rlang"><b>R</b></span> lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list(...)
pairlist(...)

as.list(x, ...)
## S3 method for class 'environment'
as.list(x, all.names = FALSE, sorted = FALSE, ...)
as.pairlist(x)

is.list(x)
is.pairlist(x)

alist(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_+3A_...">...</code></td>
<td>
<p>objects, possibly named.</p>
</td></tr>
<tr><td><code id="list_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="list_+3A_all.names">all.names</code></td>
<td>
<p>a logical indicating whether to copy all values or
(default) only those whose names do not begin with a dot.</p>
</td></tr>
<tr><td><code id="list_+3A_sorted">sorted</code></td>
<td>
<p>a logical indicating whether the <code><a href="#topic+names">names</a></code> of
the resulting list should be sorted (increasingly).  Note that this
is somewhat costly, but may be useful for comparison of environments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Almost all lists in <span class="rlang"><b>R</b></span> internally are <em>Generic Vectors</em>, whereas
traditional <em>dotted pair</em> lists (as in LISP) remain available but
rarely seen by users (except as <code><a href="#topic+formals">formals</a></code> of functions).
</p>
<p>The arguments to <code>list</code> or <code>pairlist</code> are of the form
<code>value</code> or <code>tag = value</code>.  The functions return a list or
dotted pair list composed of its arguments with each value either
tagged or untagged, depending on how the argument was specified.
</p>
<p><code>alist</code> handles its arguments as if they described function
arguments.  So the values are not evaluated, and tagged arguments with
no value are allowed whereas <code>list</code> simply ignores them.
<code>alist</code> is most often used in conjunction with <code><a href="#topic+formals">formals</a></code>.
</p>
<p><code>as.list</code> attempts to coerce its argument to a list.  For
functions, this returns the concatenation of the list of formal
arguments and the function body.  For expressions, the list of
constituent elements is returned.  <code>as.list</code> is generic, and as
the default method calls <code><a href="#topic+as.vector">as.vector</a>(mode = "list")</code> for a
non-list, methods for <code>as.vector</code> may be invoked.  <code>as.list</code>
turns a factor into a list of one-element factors, keeping
<code><a href="#topic+names">names</a></code>.  Other attributes may
be dropped unless the argument already is a list or expression.  (This
is inconsistent with functions such as <code><a href="#topic+as.character">as.character</a></code>
which always drop attributes, and is for efficiency since lists can be
expensive to copy.)
</p>
<p><code>is.list</code> returns <code>TRUE</code> if and only if its argument
is a <code>list</code> <em>or</em> a <code>pairlist</code> of <code>length</code> <code class="reqn">&gt; 0</code>.
<code>is.pairlist</code> returns <code>TRUE</code> if and only if the argument
is a pairlist or <code>NULL</code> (see below).
</p>
<p>The <code>"<a href="#topic+environment">environment</a>"</code> method for <code>as.list</code> copies the
name-value pairs (for names not beginning with a dot) from an
environment to a named list.  The user can request that all named
objects are copied.  Unless <code>sorted = TRUE</code>, the list is in no
particular order (the order
depends on the order of creation of objects and whether the
environment is hashed).  No enclosing environments are searched.
(Objects copied are duplicated so this can be an expensive operation.)
Note that there is an inverse operation, the
<code><a href="#topic+as.environment">as.environment</a>()</code> method for list objects.
</p>
<p>An empty pairlist, <code>pairlist()</code> is the same as
<code><a href="#topic+NULL">NULL</a></code>.  This is different from <code>list()</code>: some but
not all operations will promote an empty pairlist to an empty list.
</p>
<p><code>as.pairlist</code> is implemented as <code><a href="#topic+as.vector">as.vector</a>(x,
  "pairlist")</code>, and hence will dispatch methods for the generic function
<code>as.vector</code>.  Lists are copied element-by-element into a pairlist
and the names of the list used as tags for the pairlist: the return
value for other types of argument is undocumented.
</p>
<p><code>list</code>, <code>is.list</code> and <code>is.pairlist</code> are
<a href="#topic+primitive">primitive</a> functions.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vector">vector</a>("list", length)</code> for creation of a list with empty
components; <code><a href="#topic+c">c</a></code>, for concatenation; <code><a href="#topic+formals">formals</a></code>.
<code><a href="#topic+unlist">unlist</a></code> is an approximate inverse to <code>as.list()</code>.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>list</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

# create a plotting structure
pts &lt;- list(x = cars[,1], y = cars[,2])
plot(pts)

is.pairlist(.Options)  # a user-level pairlist

## "pre-allocate" an empty list of length 5
vector("list", 5)

# Argument lists
f &lt;- function() x
# Note the specification of a "..." argument:
formals(f) &lt;- al &lt;- alist(x = , y = 2+3, ... = )
f
al

## environment-&gt;list coercion

e1 &lt;- new.env()
e1$a &lt;- 10
e1$b &lt;- 20
as.list(e1)
</code></pre>

<hr>
<h2 id='list.files'>List the Files in a Directory/Folder</h2><span id='topic+list.files'></span><span id='topic+dir'></span><span id='topic+list.dirs'></span>

<h3>Description</h3>

<p>These functions produce a character vector of the names of files or
directories in the named directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list.files(path = ".", pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)

       dir(path = ".", pattern = NULL, all.files = FALSE,
           full.names = FALSE, recursive = FALSE,
           ignore.case = FALSE, include.dirs = FALSE, no.. = FALSE)

list.dirs(path = ".", full.names = TRUE, recursive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list.files_+3A_path">path</code></td>
<td>
<p>a character vector of full path names; the default
corresponds to the working directory, <code><a href="#topic+getwd">getwd</a>()</code>.  Tilde
expansion (see <code><a href="#topic+path.expand">path.expand</a></code>) is performed.  Missing
values will be ignored.  Elements with a marked encoding will
be converted to the native encoding (and if that fails, considered
non-existent).</p>
</td></tr>
<tr><td><code id="list.files_+3A_pattern">pattern</code></td>
<td>
<p>an optional <a href="#topic+regular+20expression">regular expression</a>.  Only file names
which match the regular expression will be returned.</p>
</td></tr>
<tr><td><code id="list.files_+3A_all.files">all.files</code></td>
<td>
<p>a logical value.  If <code>FALSE</code>, only the
names of visible files are returned (following Unix-style visibility,
that is files whose name does not start with a dot).  If <code>TRUE</code>,
all file names will be returned.</p>
</td></tr>
<tr><td><code id="list.files_+3A_full.names">full.names</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, the directory
path is prepended to the file names to give a relative file path.
If <code>FALSE</code>, the file names (rather than paths) are returned.</p>
</td></tr>
<tr><td><code id="list.files_+3A_recursive">recursive</code></td>
<td>
<p>logical.  Should the listing recurse into directories?</p>
</td></tr>
<tr><td><code id="list.files_+3A_ignore.case">ignore.case</code></td>
<td>
<p>logical.  Should pattern-matching be case-insensitive?</p>
</td></tr>
<tr><td><code id="list.files_+3A_include.dirs">include.dirs</code></td>
<td>
<p>logical.  Should subdirectory names be included in
recursive listings?  (They always are in non-recursive ones).</p>
</td></tr>
<tr><td><code id="list.files_+3A_no..">no..</code></td>
<td>
<p>logical.  Should both <code>"."</code> and <code>".."</code> be excluded
also from non-recursive listings?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector containing the names of the files in the
specified directories (empty if there were no files).  If a
path does not exist or is not a directory or is unreadable it
is skipped.
</p>
<p>The files are sorted in alphabetical order, on the full path
if <code>full.names = TRUE</code>.
</p>
<p><code>list.dirs</code> implicitly has <code>all.files = TRUE</code>, and if
<code>recursive = TRUE</code>, the answer includes <code>path</code> itself
(provided it is a readable directory).
</p>
<p><code>dir</code> is an alias for <code>list.files</code>.
</p>


<h3>Note</h3>

<p>File naming conventions are platform dependent.  The pattern matching
works with the case of file names as returned by the OS.
</p>
<p>On a POSIX filesystem recursive listings will follow symbolic links to
directories.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka, Brian Ripley</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.info">file.info</a></code>, <code><a href="#topic+file.access">file.access</a></code>
and <code><a href="#topic+files">files</a></code> for many more file handling functions and
<code><a href="#topic+file.choose">file.choose</a></code>
for interactive selection.
</p>
<p><code><a href="utils.html#topic+glob2rx">glob2rx</a></code> to convert wildcards (as used by system file
commands and shells) to regular expressions.
</p>
<p><code><a href="#topic+Sys.glob">Sys.glob</a></code> for wildcard expansion on file paths.
<code><a href="#topic+basename">basename</a></code> and <code>dirname</code>, useful for splitting paths
into non-directory (aka &lsquo;filename&rsquo;) and directory parts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>list.files(R.home())
## Only files starting with a-l or r
## Note that a-l is locale-dependent, but using case-insensitive
## matching makes it unambiguous in English locales
dir("../..", pattern = "^[a-lr]", full.names = TRUE, ignore.case = TRUE)

list.dirs(R.home("doc"))
list.dirs(R.home("doc"), full.names = FALSE)
</code></pre>

<hr>
<h2 id='list2DF'>
Create Data Frame From List
</h2><span id='topic+list2DF'></span>

<h3>Description</h3>

<p>Create a data frame from a list of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list2DF(x = list(), nrow = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list2DF_+3A_x">x</code></td>
<td>

<p>A list of same-length variables for the data frame.
</p>
</td></tr>
<tr><td><code id="list2DF_+3A_nrow">nrow</code></td>
<td>

<p>An integer giving the desired number of rows for the data frame in
case <code>x</code> gives no variables (i.e., has length zero).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that all list elements are taken &ldquo;as is&rdquo;.
</p>


<h3>Value</h3>

<p>A data frame with the given variables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a data frame holding a list of character vectors and the
## corresponding lengths:
x &lt;- list(character(), "A", c("B", "C"))
n &lt;- lengths(x)
list2DF(list(x = x, n = n))

## Create data frames with no variables and the desired number of rows:
list2DF()
list2DF(nrow = 3L)
</code></pre>

<hr>
<h2 id='list2env'>From A List, Build or Add To an Environment</h2><span id='topic+list2env'></span>

<h3>Description</h3>

<p>From a <em>named</em> <code><a href="#topic+list">list</a> x</code>, create an
<code><a href="#topic+environment">environment</a></code> containing all list components as objects, or
&ldquo;multi-assign&rdquo; from <code>x</code> into a pre-existing environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list2env(x, envir = NULL, parent = parent.frame(),
         hash = (length(x) &gt; 100), size = max(29L, length(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list2env_+3A_x">x</code></td>
<td>
<p>a <code><a href="#topic+list">list</a></code>, where <code><a href="#topic+names">names</a>(x)</code> must
not contain empty (<code>""</code>) elements.</p>
</td></tr>
<tr><td><code id="list2env_+3A_envir">envir</code></td>
<td>
<p>an <code><a href="#topic+environment">environment</a></code> or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="list2env_+3A_parent">parent</code></td>
<td>
<p>(for the case <code>envir = NULL</code>): a parent frame aka
enclosing environment, see <code><a href="#topic+new.env">new.env</a></code>.</p>
</td></tr>
<tr><td><code id="list2env_+3A_hash">hash</code></td>
<td>
<p>(for the case <code>envir = NULL</code>): logical indicating
if the created environment should use hashing, see <code><a href="#topic+new.env">new.env</a></code>.</p>
</td></tr>
<tr><td><code id="list2env_+3A_size">size</code></td>
<td>
<p>(in the case <code>envir = NULL, hash = TRUE</code>): hash size,
see <code><a href="#topic+new.env">new.env</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This will be very slow for large inputs unless hashing is used on the
environment.
</p>
<p>Environments must have uniquely named entries, but named lists need
not: where the list has duplicate names it is the <em>last</em> element
with the name that is used.  Empty names throw an error.
</p>


<h3>Value</h3>

<p>An <code><a href="#topic+environment">environment</a></code>, either newly created (as by
<code><a href="#topic+new.env">new.env</a></code>) if the <code>envir</code> argument was <code>NULL</code>,
otherwise the updated environment <code>envir</code>.  Since environments
are never duplicated, the argument <code>envir</code> is also changed.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+environment">environment</a></code>, <code><a href="#topic+new.env">new.env</a></code>,
<code><a href="#topic+as.environment">as.environment</a></code>; further, <code><a href="#topic+assign">assign</a></code>.
</p>
<p>The (semantical) &ldquo;inverse&rdquo;: <code><a href="#topic+as.list.environment">as.list.environment</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>L &lt;- list(a = 1, b = 2:4, p = pi, ff = gl(3, 4, labels = LETTERS[1:3]))
e &lt;- list2env(L)
ls(e)
stopifnot(ls(e) == sort(names(L)),
          identical(L$b, e$b)) # "$" working for environments as for lists

## consistency, when we do the inverse:
ll &lt;- as.list(e)  # -&gt; dispatching to the as.list.environment() method
rbind(names(L), names(ll)) # not in the same order, typically,
                           # but the same content:
stopifnot(identical(L [sort.list(names(L ))],
                    ll[sort.list(names(ll))]))

## now add to e -- can be seen as a fast "multi-assign":
list2env(list(abc = LETTERS, note = "just an example",
              df = data.frame(x = rnorm(20), y = rbinom(20, 1, prob = 0.2))),
         envir = e)
utils::ls.str(e)
</code></pre>

<hr>
<h2 id='load'>Reload Saved Datasets</h2><span id='topic+load'></span>

<h3>Description</h3>

<p>Reload datasets written with the function <code>save</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load(file, envir = parent.frame(), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_+3A_file">file</code></td>
<td>
<p>a (readable binary-mode) <a href="#topic+connection">connection</a> or a character string
giving the name of the file to load (when <a href="#topic+tilde+20expansion">tilde expansion</a>
is done).</p>
</td></tr>
<tr><td><code id="load_+3A_envir">envir</code></td>
<td>
<p>the environment where the data should be loaded.</p>
</td></tr>
<tr><td><code id="load_+3A_verbose">verbose</code></td>
<td>
<p>should item names be printed during loading?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>load</code> can load <span class="rlang"><b>R</b></span> objects saved in the current or any earlier
format.  It can read a compressed file (see <code><a href="#topic+save">save</a></code>)
directly from a file or from a suitable connection (including a call
to <code><a href="#topic+url">url</a></code>).
</p>
<p>A not-open connection will be opened in mode <code>"rb"</code> and closed
after use.  Any connection other than a <code><a href="#topic+gzfile">gzfile</a></code> or
<code><a href="#topic+gzcon">gzcon</a></code> connection will be wrapped in <code><a href="#topic+gzcon">gzcon</a></code>
to allow compressed saves to be handled: note that this leaves the
connection in an altered state (in particular, binary-only), and that
it needs to be closed explicitly (it will not be garbage-collected).
</p>
<p>Only <span class="rlang"><b>R</b></span> objects saved in the current format (used since <span class="rlang"><b>R</b></span> 1.4.0)
can be read from a connection.  If no input is available on a
connection a warning will be given, but any input not in the current
format will result in a error.
</p>
<p>Loading from an earlier version will give a warning about the
&lsquo;magic number&rsquo;: magic numbers <code>1971:1977</code> are from <span class="rlang"><b>R</b></span> &lt;
0.99.0, and <code>RD[ABX]1</code> from <span class="rlang"><b>R</b></span> 0.99.0 to <span class="rlang"><b>R</b></span> 1.3.1.  These are all
obsolete, and you are strongly recommended to re-save such files in a
current format.
</p>
<p>The <code>verbose</code> argument is mainly intended for debugging.  If it
is <code>TRUE</code>, then as objects from the file are loaded, their
names will be printed to the console.  If <code>verbose</code> is set to
an integer value greater than one, additional names corresponding to
attributes and other parts of individual objects will also be printed.
Larger values will print names to a greater depth.
</p>
<p>Objects can be saved with references to namespaces, usually as part of
the environment of a function or formula.  Such objects can be loaded
even if the namespace is not available: it is replaced by a reference
to the global environment with a warning.  The warning identifies the
first object with such a reference (but there may be more than one).
</p>


<h3>Value</h3>

<p>A character vector of the names of objects created, invisibly.
</p>


<h3>Warning</h3>

<p>Saved <span class="rlang"><b>R</b></span> objects are binary files, even those saved with
<code>ascii = TRUE</code>, so ensure that they are transferred without
conversion of end of line markers.  <code>load</code> tries to detect such a
conversion and gives an informative error message.
</p>
<p><code>load(<var>file</var>)</code> replaces all existing objects with the same names
in the current environment (typically your workspace,
<code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code>) and hence potentially overwrites important data.
It is considerably safer to use <code>envir = </code> to load into a
different environment, or to <code><a href="#topic+attach">attach</a>(<var>file</var>)</code> which
<code>load()</code>s into a new entry in the <code><a href="#topic+search">search</a></code> path.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+save">save</a></code>, <code><a href="utils.html#topic+download.file">download.file</a></code>; further
<code><a href="#topic+attach">attach</a></code> as wrapper for <code>load()</code>.
</p>
<p>For other interfaces to the underlying serialization format, see
<code><a href="#topic+unserialize">unserialize</a></code> and <code><a href="#topic+readRDS">readRDS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## save all data
xx &lt;- pi # to ensure there is some data
save(list = ls(all.names = TRUE), file= "all.rda")
rm(xx)

## restore the saved values to the current environment
local({
   load("all.rda")
   ls()
})

xx &lt;- exp(1:3)
## restore the saved values to the user's workspace
load("all.rda") ## which is here *equivalent* to
## load("all.rda", .GlobalEnv)
## This however annihilates all objects in .GlobalEnv with the same names !
xx # no longer exp(1:3)
rm(xx)
attach("all.rda") # safer and will warn about masked objects w/ same name in .GlobalEnv
ls(pos = 2)
##  also typically need to cleanup the search path:
detach("file:all.rda")

## clean up (the example):
unlink("all.rda")


## Not run: 
con &lt;- url("http://some.where.net/R/data/example.rda")
## print the value to see what objects were created.
print(load(con))
close(con) # url() always opens the connection

## End(Not run)</code></pre>

<hr>
<h2 id='locales'>Query or Set Aspects of the Locale</h2><span id='topic+locales'></span><span id='topic+Sys.getlocale'></span><span id='topic+Sys.setlocale'></span><span id='topic+.LC.categories'></span><span id='topic+LC_ALL'></span><span id='topic+LC_COLLATE'></span><span id='topic+LC_CTYPE'></span><span id='topic+LC_MONETARY'></span><span id='topic+LC_NUMERIC'></span><span id='topic+LC_TIME'></span><span id='topic+LC_MESSAGES'></span><span id='topic+LC_PAPER'></span><span id='topic+LC_MEASUREMENT'></span>

<h3>Description</h3>

<p>Get details of or set aspects of the locale for the <span class="rlang"><b>R</b></span> process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.getlocale (category = "LC_ALL")
Sys.setlocale (category = "LC_ALL", locale = "")
.LC.categories
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locales_+3A_category">category</code></td>
<td>
<p>character string.  The following categories should
always be supported: <code>"LC_ALL"</code>, <code>"LC_COLLATE"</code>,
<code>"LC_CTYPE"</code>, <code>"LC_MONETARY"</code>, <code>"LC_NUMERIC"</code> and
<code>"LC_TIME"</code>.  Some systems (not Windows) will also support
<code>"LC_MESSAGES"</code>, <code>"LC_PAPER"</code> and <code>"LC_MEASUREMENT"</code>.
These category names are available in <code>.LC.categories</code>; even when
not supported, <code>Sys.getlocale(.)</code> will return <code>""</code>, e.g., for
the <code>"LC_PAPER"</code> example on Windows.
</p>
</td></tr>
<tr><td><code id="locales_+3A_locale">locale</code></td>
<td>
<p>character string.  A valid locale name on the system in
use.  Normally <code>""</code> (the default) will pick up the default
locale for the system.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The locale describes aspects of the internationalization of a program.
Initially most aspects of the locale of <span class="rlang"><b>R</b></span> are set to <code>"C"</code>
(which is the default for the C language and reflects North-American
usage &ndash; also known as <code>"POSIX"</code>).  <span class="rlang"><b>R</b></span> sets <code>"LC_CTYPE"</code> and
<code>"LC_COLLATE"</code>, which allow the use of a different character set
and alphabetic comparisons in that character set (including the use of
<code><a href="#topic+sort">sort</a></code>), <code>"LC_MONETARY"</code> (for use by
<code><a href="#topic+Sys.localeconv">Sys.localeconv</a></code>) and <code>"LC_TIME"</code> may affect the
behaviour of <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> and <code><a href="#topic+strptime">strptime</a></code> and
functions which use them (but not <code><a href="#topic+date">date</a></code>).
</p>
<p>The first seven categories described here are those specified by
POSIX.  <code>"LC_MESSAGES"</code> will be <code>"C"</code> on systems that do not
support message translation, and is not supported on Windows, where
you <em>must</em> use the <span class="env">LANGUAGE</span> environment variable for
message translation, see below and the <code><a href="#topic+Sys.setLanguage">Sys.setLanguage</a>()</code>
utility.  Trying to use an unsupported category is an error for
<code>Sys.setlocale</code>.
</p>
<p>Note that setting category <code>"LC_ALL"</code> sets only categories
<code>"LC_COLLATE"</code>, <code>"LC_CTYPE"</code>, <code>"LC_MONETARY"</code> and
<code>"LC_TIME"</code>.
</p>
<p>Attempts to set an invalid locale are ignored.  There may or may not
be a warning, depending on the OS.
</p>
<p>Attempts to change the character set (by
<code>Sys.setlocale("LC_CTYPE", )</code>, if that implies a different
character set) during a session may not work and are likely to lead to
some confusion.
</p>
<p>Note that the <span class="env">LANGUAGE</span> environment variable has precedence over
<code>"LC_MESSAGES"</code> in selecting the language for message translation
on most <span class="rlang"><b>R</b></span> platforms.
</p>
<p>On platforms where ICU is used for collation the locale used for
collation can be reset by <code><a href="#topic+icuSetCollate">icuSetCollate</a></code>.  Except on
Windows, the initial setting is taken from the <code>"LC_COLLATE"</code>
category, and it is reset when this is changed by a call to
<code>Sys.setlocale</code>.
</p>


<h3>Value</h3>

<p>A character string of length one describing the locale in use (after
setting for <code>Sys.setlocale</code>), or an empty character string if the
current locale settings are invalid or <code>NULL</code> if locale
information is unavailable.
</p>
<p>For <code>category = "LC_ALL"</code> the details of the string are
system-specific: it might be a single locale name or a set of locale
names separated by <code>"/"</code> (macOS) or <code>";"</code>
(Windows, Linux).  For portability, it is best to query categories
individually: it is not necessarily the case that the result of
<code>foo &lt;- Sys.getlocale()</code> can be used in
<code>Sys.setlocale("LC_ALL", locale = foo)</code>.
</p>


<h3>Available locales</h3>

<p>On most Unix-alikes the POSIX shell command <code>locale -a</code> will
list the &lsquo;available public&rsquo; locales.  What that means is
platform-dependent.  On recent Linuxen this may mean &lsquo;available
to be installed&rsquo; as on some RPM-based systems the locale data is in
separate <abbr>RPM</abbr>s.  On Debian/Ubuntu the set of available locales is
managed by OS-specific facilities such as <code>locale-gen</code> and
<code>locale -a</code> lists those currently enabled.
</p>
<p>For Windows, Microsoft moves its documentation frequently so a Web
search is the best way to find current information.  From <span class="rlang"><b>R</b></span> 4.2, <abbr>UCRT</abbr>
locale names should be used.  The character set should match the
system/ANSI codepage (<code>l10n_info()$codepage</code> be the same as
<code>l10n_info()$system.codepage</code>).  Setting it to any other value
results in a warning and may cause encoding problems.  As from <span class="rlang"><b>R</b></span> 4.2
on recent Windows the system codepage is 65001 and one should always
use locale names ending with <code>".UTF-8"</code> (except for <code>"C"</code>
and <code>""</code>), otherwise Windows may add a different character set.
</p>


<h3>Warning</h3>

<p>Setting <code>"LC_NUMERIC"</code> to any value other than <code>"C"</code> may
cause <span class="rlang"><b>R</b></span> to function anomalously, so gives a warning.  Input
conversions in <span class="rlang"><b>R</b></span> itself are unaffected, but the reading and writing
of ASCII <code><a href="#topic+save">save</a></code> files will be, as may packages which do
their own input/output.
</p>
<p>Setting it temporarily on a Unix-alike to produce graphical or text
output may work well enough, but <code><a href="#topic+options">options</a>(OutDec)</code> is
often preferable.
</p>
<p>Almost all the output routines used by <span class="rlang"><b>R</b></span> itself under Windows ignore
the setting of <code>"LC_NUMERIC"</code> since they make use of the Trio
library which is not internationalized.
</p>


<h3>Note</h3>

<p>Changing the values of locale categories whilst <span class="rlang"><b>R</b></span> is running ought
to be noticed by the OS services, and usually is but exceptions have
been seen (usually in collation services).
</p>
<p>Do not use the value of <code>Sys.getlocale("LC_CTYPE")</code> to attempt to
find the character set &ndash; for example UTF-8 locales can have suffix
&lsquo;<span class="samp">&#8288;.UTF-8&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;.utf8&#8288;</span>&rsquo; (more common on Linux than &lsquo;<span class="samp">&#8288;UTF-8&#8288;</span>&rsquo;)
or none (as on macOS) and Latin-9 locales can have suffix
&lsquo;<span class="samp">&#8288;ISO8859-15&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;iso885915&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;iso885915@euro&#8288;</span>&rsquo; or
&lsquo;<span class="samp">&#8288;ISO8859-15@euro&#8288;</span>&rsquo;.  Use <code><a href="#topic+l10n_info">l10n_info</a></code> instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+strptime">strptime</a></code> for uses of <code>category = "LC_TIME"</code>.
<code><a href="#topic+Sys.localeconv">Sys.localeconv</a></code> for details of numerical and monetary
representations.
</p>
<p><code><a href="#topic+l10n_info">l10n_info</a></code> gives some summary facts about the locale and
its encoding (including if it is UTF-8).
</p>
<p>The &lsquo;R Installation and Administration&rsquo; manual for background
on locales and how to find out locale names on your system.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sys.getlocale()

## Date-time  related :
Sys.getlocale("LC_TIME") -&gt; olcT
then &lt;- as.POSIXlt("2001-01-01 01:01:01", tz = "UTC")
## Not run: 
c(m = months(then), wd = weekdays(then)) # locale specific
Sys.setlocale("LC_TIME", "de")     # Solaris: details are OS-dependent
Sys.setlocale("LC_TIME", "de_DE")  # Many Unix-alikes
Sys.setlocale("LC_TIME", "de_DE.UTF-8")  # Linux, macOS, other Unix-alikes
Sys.setlocale("LC_TIME", "de_DE.utf8")   # some Linux versions
Sys.setlocale("LC_TIME", "German.UTF-8") # Windows
Sys.getlocale("LC_TIME") # the last one successfully set above
c(m = months(then), wd = weekdays(then)) # in C_TIME locale 'cT' ; typically German

## End(Not run)
Sys.setlocale("LC_TIME", "C")
c(m = months(then), wd = weekdays(then)) # "standard" (still platform specific ?)
Sys.setlocale("LC_TIME", olcT)           # reset to previous

## Other locales
Sys.getlocale("LC_PAPER")          # may or may not be set
.LC.categories # of length 9 on all platforms

## Not run: Sys.setlocale("LC_COLLATE", "C")   # turn off locale-specific sorting,
                                   # usually (but not on all platforms)
Sys.setenv("LANGUAGE" = "es") # set the language for error/warning messages

## End(Not run)
## some nice formatting; should work on most platforms,
          ## macOS does not name the entries.
 sep &lt;- switch(Sys.info()[["sysname"]],
               "Darwin"=, "SunOS" = "/",
               "Linux" =, "Windows" = ";")
 ##' show a "full" Sys.getlocale() nicely:
 showL &lt;- function(loc) {
     sl &lt;- strsplit(strsplit(loc, sep)[[1L]], "=")
     if(all(sapply(sl, length) == 2L))
        setNames(sapply(sl, `[[`, 2L), sapply(sl, `[[`, 1L))
     else
       setNames(as.character(sl), .LC.categories[1+seq_along(sl)])
 }
 print.Dlist(lloc &lt;- showL(Sys.getlocale()))
 ## R-supported ones (but LC_ALL):
 lloc[.LC.categories[-1]]

</code></pre>

<hr>
<h2 id='log'>Logarithms and Exponentials</h2><span id='topic+log'></span><span id='topic+logb'></span><span id='topic+log10'></span><span id='topic+log2'></span><span id='topic+log1p'></span><span id='topic+exp'></span><span id='topic+expm1'></span>

<h3>Description</h3>

<p><code>log</code> computes logarithms, by default natural logarithms,
<code>log10</code> computes common (i.e., base 10) logarithms, and
<code>log2</code> computes binary (i.e., base 2) logarithms.
The general form <code>log(x, base)</code> computes logarithms with base
<code>base</code>.
</p>
<p><code>log1p(x)</code> computes <code class="reqn">\log(1+x)</code> accurately also for
<code class="reqn">|x| \ll 1</code>.
</p>
<p><code>exp</code> computes the exponential function.
</p>
<p><code>expm1(x)</code> computes <code class="reqn">\exp(x) - 1</code> accurately also for
<code class="reqn">|x| \ll 1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log(x, base = exp(1))
logb(x, base = exp(1))
log10(x)
log2(x)

log1p(x)

exp(x)
expm1(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_+3A_x">x</code></td>
<td>
<p>a numeric or complex vector.</p>
</td></tr>
<tr><td><code id="log_+3A_base">base</code></td>
<td>
<p>a positive or complex number: the base with respect to which
logarithms are computed.  Defaults to <code class="reqn">e</code>=<code>exp(1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All except <code>logb</code> are generic functions: methods can be defined
for them individually or via the <code><a href="#topic+S3groupGeneric">Math</a></code>
group generic.
</p>
<p><code>log10</code> and <code>log2</code> are only convenience wrappers, but logs
to bases 10 and 2 (whether computed <em>via</em> <code>log</code> or the wrappers)
will be computed more efficiently and accurately where supported by the OS.
Methods can be set for them individually (and otherwise methods for
<code>log</code> will be used).
</p>
<p><code>logb</code> is a wrapper for <code>log</code> for compatibility with S.  If
(S3 or S4) methods are set for <code>log</code> they will be dispatched.
Do not set S4 methods on <code>logb</code> itself.
</p>
<p>All except <code>log</code> are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> containing the transformed
values.  <code>log(0)</code> gives <code>-Inf</code>, and <code>log(x)</code> for
negative values of <code>x</code> is <code>NaN</code>.  <code>exp(-Inf)</code> is <code>0</code>.
</p>
<p>For complex inputs to the log functions, the value is a complex number
with imaginary part in the range <code class="reqn">[-\pi, \pi]</code>: which
end of the range is used might be platform-specific.
</p>


<h3>S4 methods</h3>

<p><code>exp</code>, <code>expm1</code>, <code>log</code>, <code>log10</code>, <code>log2</code> and
<code>log1p</code> are S4 generic and are members of the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.
</p>
<p>Note that this means that the S4 generic for <code>log</code> has a
signature with only one argument, <code>x</code>, but that <code>base</code> can
be passed to methods (but will not be used for method selection).  On
the other hand, if you only set a method for the <code>Math</code> group
generic then <code>base</code> argument of <code>log</code> will be ignored for
your class.
</p>


<h3>Source</h3>

<p><code>log1p</code> and <code>expm1</code> may be taken from the operating system,
but if not available there then they are based on the Fortran subroutine
<code>dlnrel</code> by W. Fullerton of Los Alamos Scientific Laboratory (see
<a href="https://netlib.org/slatec/fnlib/dlnrel.f">https://netlib.org/slatec/fnlib/dlnrel.f</a>) and (for small x) a
single Newton step for the solution of <code>log1p(y) = x</code>
respectively.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
(for <code>log</code>, <code>log10</code> and <code>exp</code>.)
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer. (for <code>logb</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Trig">Trig</a></code>,
<code><a href="#topic+sqrt">sqrt</a></code>,
<code><a href="#topic+Arithmetic">Arithmetic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>log(exp(3))
log10(1e7) # = 7

x &lt;- 10^-(1+2*1:9)
cbind(deparse.level=2, # to get nice column names
      x, log(1+x), log1p(x), exp(x)-1, expm1(x))
</code></pre>

<hr>
<h2 id='Logic'>Logical Operators</h2><span id='topic++21'></span><span id='topic++26'></span><span id='topic++26+26'></span><span id='topic++7C'></span><span id='topic++7C+7C'></span><span id='topic+xor'></span><span id='topic+Logic'></span><span id='topic+isTRUE'></span><span id='topic+isFALSE'></span>

<h3>Description</h3>

<p>These operators act on raw, logical and number-like vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>! x
x &amp; y
x &amp;&amp; y
x | y
x || y
xor(x, y)

isTRUE (x)
isFALSE(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Logic_+3A_x">x</code>, <code id="Logic_+3A_y">y</code></td>
<td>
<p><code><a href="#topic+raw">raw</a></code>, <code><a href="#topic+logical">logical</a></code> or &lsquo;number-like&rsquo; vectors (i.e., of
types <code><a href="#topic+double">double</a></code> (class <code><a href="#topic+numeric">numeric</a></code>),
<code><a href="#topic+integer">integer</a></code> and <code><a href="#topic+complex">complex</a></code>), or objects for
which methods have been written.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>!</code> indicates logical negation (NOT).
</p>
<p><code>&amp;</code> and <code>&amp;&amp;</code> indicate logical AND and <code>|</code> and <code>||</code>
indicate logical OR.  The shorter forms performs elementwise
comparisons in much the same way as arithmetic operators.  The longer
forms evaluates left to right, proceeding only until the result is
determined.  The longer form is appropriate for programming
control-flow and typically preferred in <code><a href="#topic+if">if</a></code> clauses.
</p>
<p>Using vectors of more than one element in <code>&amp;&amp;</code> or <code>||</code> will
give  an error.
</p>
<p><code>xor</code> indicates elementwise exclusive OR.
</p>
<p><code>isTRUE(x)</code> is the same as
<code>{ is.logical(x) &amp;&amp; length(x) == 1 &amp;&amp; !is.na(x) &amp;&amp; x }</code>;
<code>isFALSE()</code> is defined analogously.  Consequently,
<code>if(isTRUE(cond))</code> may be preferable to <code>if(cond)</code> because
of <code><a href="#topic+NA">NA</a></code>s.<br />
In earlier <span class="rlang"><b>R</b></span> versions, <code>isTRUE &lt;- function(x) identical(x, TRUE)</code>,
had the drawback to be false e.g., for <code>x &lt;- c(val = TRUE)</code>.
</p>
<p>Numeric and complex vectors will be coerced to logical values, with
zero being false and all non-zero values being true.  Raw vectors are
handled without any coercion for <code>!</code>, <code>&amp;</code>, <code>|</code> and
<code>xor</code>, with these operators being applied bitwise (so <code>!</code> is
the 1s-complement).
</p>
<p>The operators <code>!</code>, <code>&amp;</code> and <code>|</code> are generic functions:
methods can be written for them individually or via the
<code><a href="#topic+S3groupGeneric">Ops</a></code> (or S4 <code>Logic</code>, see below)
group generic function.  (See <code><a href="#topic+S3groupGeneric">Ops</a></code> for
how dispatch is computed.)
</p>
<p><code><a href="#topic+NA">NA</a></code> is a valid logical object.  Where a component of
<code>x</code> or <code>y</code> is <code>NA</code>, the result will be <code>NA</code> if the
outcome is ambiguous.  In other words <code>NA &amp; TRUE</code> evaluates to
<code>NA</code>, but <code>NA &amp; FALSE</code> evaluates to <code>FALSE</code>.  See the
examples below.
</p>
<p>See <a href="#topic+Syntax">Syntax</a> for the precedence of these operators: unlike many
other languages (including S) the AND and OR operators do not have the
same precedence (the AND operators have higher precedence than the OR
operators).
</p>


<h3>Value</h3>

<p>For <code>!</code>, a logical or raw vector(for raw <code>x</code>) of the same
length as <code>x</code>: names, dims and dimnames are copied from <code>x</code>,
and all other attributes (including class) if no coercion is done.
</p>
<p>For <code>|</code>, <code>&amp;</code> and <code>xor</code> a logical or raw vector.  If
involving a zero-length vector the result has length zero.  Otherwise,
the elements of shorter vectors are recycled as necessary (with a
<code><a href="#topic+warning">warning</a></code> when they are recycled only <em>fractionally</em>).
The rules for determining the attributes of the result are rather
complicated.  Most attributes are taken from the longer argument, the
first if they are of the same length.  Names will be copied from the
first if it is the same length as the answer, otherwise from the
second if that is.  For time series, these operations are allowed only
if the series are compatible, when the class and <code><a href="stats.html#topic+tsp">tsp</a></code>
attribute of whichever is a time series (the same, if both are) are
used.  For arrays (and an array result) the dimensions and dimnames
are taken from first argument if it is an array, otherwise the second.
</p>
<p>For <code>||</code>, <code>&amp;&amp;</code> and <code>isTRUE</code>, a length-one logical vector.
</p>


<h3>S4 methods</h3>

<p><code>!</code>, <code>&amp;</code> and <code>|</code> are S4 generics, the latter two part
of the <code><a href="methods.html#topic+S4groupGeneric">Logic</a></code> group generic (and
hence methods need argument names <code>e1, e2</code>).
</p>


<h3>Note</h3>

<p>The elementwise operators are sometimes called as functions as
e.g. <code>`&amp;`(x, y)</code>: see the description of how
argument-matching is done in <code><a href="#topic+groupGeneric">Ops</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TRUE">TRUE</a></code> or <code><a href="#topic+logical">logical</a></code>.
</p>
<p><code><a href="#topic+any">any</a></code> and <code><a href="#topic+all">all</a></code> for OR and AND on many scalar
arguments.
</p>
<p><code><a href="#topic+Syntax">Syntax</a></code> for operator precedence.
</p>
<p><code>L <a href="#topic++25+7C+7C+25">%||%</a> R </code> which takes <code>L</code> if it is not <code>NULL</code>,
and <code>R</code> otherwise.
</p>
<p><code><a href="#topic+bitwAnd">bitwAnd</a></code> for bitwise versions for integer vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- 1 + (x &lt;- stats::rpois(50, lambda = 1.5) / 4 - 1)
x[(x &gt; 0) &amp; (x &lt; 1)]    # all x values between 0 and 1
if (any(x == 0) || any(y == 0)) "zero encountered"

## construct truth tables :

x &lt;- c(NA, FALSE, TRUE)
names(x) &lt;- as.character(x)
outer(x, x, `&amp;`) ## AND table
outer(x, x, `|`) ## OR  table
</code></pre>

<hr>
<h2 id='logical'>Logical Vectors</h2><span id='topic+logical'></span><span id='topic+as.logical'></span><span id='topic+as.logical.factor'></span><span id='topic+is.logical'></span><span id='topic+TRUE'></span><span id='topic+FALSE'></span><span id='topic+T'></span><span id='topic+F'></span>

<h3>Description</h3>

<p>Create or test for objects of type <code>"logical"</code>, and the basic
logical constants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TRUE
FALSE
T; F

logical(length = 0)
as.logical(x, ...)
is.logical(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logical_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.
Double values will be coerced to integer:
supplying an argument of length other than one is an error.</p>
</td></tr>
<tr><td><code id="logical_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="logical_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>TRUE</code> and <code>FALSE</code> are <a href="#topic+reserved">reserved</a> words denoting logical
constants in the <span class="rlang"><b>R</b></span> language, whereas <code>T</code> and <code>F</code> are global
variables whose initial values set to these.  All four are
<code>logical(1)</code> vectors.
</p>
<p><code>as.logical</code> is a generic function.  Methods should return an object
of type <code>"logical"</code>.
</p>
<p>Logical vectors are coerced to integer vectors in contexts where a
numerical value is required, with <code>TRUE</code> being mapped to
<code>1L</code>, <code>FALSE</code> to <code>0L</code> and <code>NA</code> to <code>NA_integer_</code>.
</p>


<h3>Value</h3>

<p><code>logical</code> creates a logical vector of the specified length.
Each element of the vector is equal to <code>FALSE</code>.
</p>
<p><code>as.logical</code> attempts to coerce its argument to be of logical
type.  In numeric and complex vectors, zeros are <code>FALSE</code> and
non-zero values are <code>TRUE</code>.
For <code><a href="#topic+factor">factor</a></code>s, this uses the <code><a href="#topic+levels">levels</a></code>
(labels).  Like <code><a href="#topic+as.vector">as.vector</a></code> it strips attributes including
names.  Character strings <code>c("T", "TRUE", "True", "true")</code> are
regarded as true, <code>c("F", "FALSE", "False", "false")</code> as false,
and all others as <code>NA</code>.
</p>
<p><code>is.logical</code> returns <code>TRUE</code> or <code>FALSE</code> depending on
whether its argument is of logical type or not.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NA">NA</a></code>, the other logical constant.
Logical operators are documented in <code><a href="#topic+Logic">Logic</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## non-zero values are TRUE
as.logical(c(pi,0))
if (length(letters)) cat("26 is TRUE\n")

## logical interpretation of particular strings
charvec &lt;- c("FALSE", "F", "False", "false",    "fAlse", "0",
             "TRUE",  "T", "True",  "true",     "tRue",  "1")
as.logical(charvec)

## factors are converted via their levels, so string conversion is used
as.logical(factor(charvec))
as.logical(factor(c(0,1)))  # "0" and "1" give NA
</code></pre>

<hr>
<h2 id='LongVectors'>Long Vectors</h2><span id='topic+long+20vector'></span><span id='topic+long+20vectors'></span><span id='topic+Long+20vectors'></span>

<h3>Description</h3>

<p>Vectors of <code class="reqn">2^{31}</code> or more elements were added in <span class="rlang"><b>R</b></span> 3.0.0.
</p>


<h3>Details</h3>

<p>Prior to <span class="rlang"><b>R</b></span> 3.0.0, all vectors in <span class="rlang"><b>R</b></span> were restricted to at most
<code class="reqn">2^{31} - 1</code> elements and could be indexed by integer
vectors.
</p>
<p>Currently all <a href="#topic+atomic">atomic</a> (raw, logical, integer, numeric, complex,
character) vectors, <a href="#topic+list">list</a>s and <a href="#topic+expression">expression</a>s can be much
longer on 64-bit platforms: such vectors are referred to as
&lsquo;long vectors&rsquo; and have a slightly different internal
structure.  In theory they can contain up to <code class="reqn">2^{52}</code> elements, but
address space limits of current CPUs and OSes will be much smaller.
Such objects will have a <a href="#topic+length">length</a> that is expressed as a double,
and can be indexed by double vectors.
</p>
<p>Arrays (including matrices) can be based on long vectors provided each
of their dimensions is at most <code class="reqn">2^{31} - 1</code>: thus there
are no 1-dimensional long arrays.
</p>
<p><span class="rlang"><b>R</b></span> code typically only needs minor changes to work with long vectors,
maybe only checking that <code>as.integer</code> is not used unnecessarily
for e.g. lengths.  However, compiled code typically needs quite
extensive changes.  Note that the <code><a href="#topic+.C">.C</a></code> and
<code><a href="#topic+.Fortran">.Fortran</a></code> interfaces do not accept long vectors, so
<code><a href="#topic+.Call">.Call</a></code> (or similar) has to be used.
</p>
<p>Because of the storage requirements (a minimum of 64 bytes per
character string), character vectors are only going to be usable if
they have a small number of distinct elements, and even then factors
will be more efficient (4 bytes per element rather than 8).  So it is
expected that most of the usage of long vectors will be integer
vectors (including factors) and numeric vectors.
</p>


<h3>Matrix algebra</h3>

<p>It is now possible to use <code class="reqn">m \times n</code> matrices with more
than 2 billion elements.  Whether matrix algebra (including
<code><a href="#topic++25+2A+25">%*%</a></code>, <code><a href="#topic+crossprod">crossprod</a></code>, <code><a href="#topic+svd">svd</a></code>,
<code><a href="#topic+qr">qr</a></code>, <code><a href="#topic+solve">solve</a></code> and <code><a href="#topic+eigen">eigen</a></code>) will
actually work is somewhat implementation dependent, including the
Fortran compiler used and if an external BLAS or LAPACK is used.
</p>
<p>An efficient parallel BLAS implementation will often be important to
obtain usable performance.  For example on one particular platform
<code>chol</code> on a 47,000 square matrix took about 5 hours with the
internal BLAS, 21 minutes using an optimized BLAS on one core, and 2
minutes using an optimized BLAS on 16 cores.
</p>

<hr>
<h2 id='lower.tri'>Lower and Upper Triangular Part of a Matrix</h2><span id='topic+lower.tri'></span><span id='topic+upper.tri'></span>

<h3>Description</h3>

<p>Returns a matrix of logicals the same size of a given matrix with
entries <code>TRUE</code> in the lower or upper triangle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower.tri(x, diag = FALSE)
upper.tri(x, diag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lower.tri_+3A_x">x</code></td>
<td>
<p>a matrix or other <span class="rlang"><b>R</b></span> object with <code>length(dim(x)) == 2</code>.
For back compatibility reasons, when the above is not fulfilled,
<code><a href="#topic+as.matrix">as.matrix</a>(x)</code> is called first.</p>
</td></tr>
<tr><td><code id="lower.tri_+3A_diag">diag</code></td>
<td>
<p>logical.  Should the diagonal be included?</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+diag">diag</a></code>, <code><a href="#topic+matrix">matrix</a></code>; further <code><a href="#topic+row">row</a></code>
and <code><a href="#topic+col">col</a></code> on which <code>lower.tri()</code> and
<code>upper.tri()</code> are built.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(m2 &lt;- matrix(1:20, 4, 5))
lower.tri(m2)
m2[lower.tri(m2)] &lt;- NA
m2
</code></pre>

<hr>
<h2 id='ls'>List Objects</h2><span id='topic+ls'></span><span id='topic+objects'></span>

<h3>Description</h3>

<p><code>ls</code> and <code>objects</code> return a vector of character strings
giving the names of the objects in the specified environment.  When
invoked with no argument at the top level prompt, <code>ls</code> shows what
data sets and functions a user has defined.  When invoked with no
argument inside a function, <code>ls</code> returns the names of the
function's local variables: this is useful in conjunction with
<code>browser</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ls(name, pos = -1L, envir = as.environment(pos),
   all.names = FALSE, pattern, sorted = TRUE)
objects(name, pos= -1L, envir = as.environment(pos),
        all.names = FALSE, pattern, sorted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ls_+3A_name">name</code></td>
<td>
<p>which environment to use in listing the available objects.
Defaults to the <em>current</em> environment.  Although called
<code>name</code> for back compatibility, in fact this argument can
specify the environment in any form; see the &lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="ls_+3A_pos">pos</code></td>
<td>
<p>an alternative argument to <code>name</code> for specifying the
environment as a position in the search list.  Mostly there for
back compatibility.</p>
</td></tr>
<tr><td><code id="ls_+3A_envir">envir</code></td>
<td>
<p>an alternative argument to <code>name</code> for specifying the
environment.  Mostly there for back compatibility.</p>
</td></tr>
<tr><td><code id="ls_+3A_all.names">all.names</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, all
object names are returned.  If <code>FALSE</code>, names which begin with a
&lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; are omitted.</p>
</td></tr>
<tr><td><code id="ls_+3A_pattern">pattern</code></td>
<td>
<p>an optional <a href="#topic+regular+20expression">regular expression</a>.  Only names
matching <code>pattern</code> are returned.  <code><a href="utils.html#topic+glob2rx">glob2rx</a></code> can be
used to convert wildcard patterns to regular expressions.</p>
</td></tr>
<tr><td><code id="ls_+3A_sorted">sorted</code></td>
<td>
<p>logical indicating if the resulting
<code><a href="#topic+character">character</a></code> should be sorted alphabetically.  Note that
this is part of <code>ls()</code> may take most of the time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>name</code> argument can specify the  environment from which
object names are taken in one of several forms:
as an integer (the position in the <code><a href="#topic+search">search</a></code> list); as
the character string name of an element in the search list; or as an
explicit <code><a href="#topic+environment">environment</a></code> (including using
<code><a href="#topic+sys.frame">sys.frame</a></code> to access the currently active function calls).
By default, the environment of the call to <code>ls</code> or <code>objects</code>
is used. The <code>pos</code> and <code>envir</code> arguments are an alternative
way to specify an environment, but are primarily there for back
compatibility.
</p>
<p>Note that the <em>order</em> of strings for <code>sorted = TRUE</code> is
locale dependent, see <code><a href="#topic+Sys.getlocale">Sys.getlocale</a></code>.  If <code>sorted =
    FALSE</code> the order is arbitrary, depending if the environment is
hashed, the order of insertion of objects, ....
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+glob2rx">glob2rx</a></code> for converting wildcard patterns to regular
expressions.
</p>
<p><code><a href="utils.html#topic+ls.str">ls.str</a></code> for a long listing based on <code><a href="utils.html#topic+str">str</a></code>.
<code><a href="utils.html#topic+apropos">apropos</a></code> (or <code><a href="utils.html#topic+find">find</a></code>)
for finding objects in the whole search path;
<code><a href="#topic+grep">grep</a></code> for more details on &lsquo;regular expressions&rsquo;;
<code><a href="#topic+class">class</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>, etc., for
object-oriented programming.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>.Ob &lt;- 1
ls(pattern = "O")
ls(pattern= "O", all.names = TRUE)    # also shows ".[foo]"

# shows an empty list because inside myfunc no variables are defined
myfunc &lt;- function() {ls()}
myfunc()

# define a local variable inside myfunc
myfunc &lt;- function() {y &lt;- 1; ls()}
myfunc()                # shows "y"
</code></pre>

<hr>
<h2 id='make.names'>Make Syntactically Valid Names</h2><span id='topic+make.names'></span>

<h3>Description</h3>

<p>Make syntactically valid names out of character vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.names(names, unique = FALSE, allow_ = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.names_+3A_names">names</code></td>
<td>
<p>character vector to be coerced to syntactically valid
names.  This is coerced to character if necessary.</p>
</td></tr>
<tr><td><code id="make.names_+3A_unique">unique</code></td>
<td>
<p>logical; if <code>TRUE</code>, the resulting elements are
unique.  This may be desired for, e.g., column names.</p>
</td></tr>
<tr><td><code id="make.names_+3A_allow_">allow_</code></td>
<td>
<p>logical.  For compatibility with <span class="rlang"><b>R</b></span> prior to 1.9.0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A syntactically valid name consists of letters, numbers and the dot or
underline characters and starts with a letter or the dot not followed
by a number.  Names such as <code>".2way"</code> are not valid, and neither
are the <a href="#topic+reserved">reserved</a> words.
</p>
<p>The definition of a <em>letter</em> depends on the current locale, but
only ASCII digits are considered to be digits.
</p>
<p>The character <code>"X"</code> is prepended if necessary.
All invalid characters are translated to <code>"."</code>.  A missing value
is translated to <code>"NA"</code>.  Names which match <span class="rlang"><b>R</b></span> keywords have a dot
appended to them.  Duplicated values are altered by
<code><a href="#topic+make.unique">make.unique</a></code>.
</p>


<h3>Value</h3>

<p>A character vector of same length as <code>names</code> with each changed to
a syntactically valid name, in the current locale's encoding.
</p>


<h3>Warning</h3>

<p>Some OSes, notably FreeBSD, report extremely incorrect information about
which characters are alphabetic in some locales (typically, all
multi-byte locales including UTF-8 locales).  However, <span class="rlang"><b>R</b></span> provides
substitutes on Windows, macOS and AIX.
</p>


<h3>Note</h3>

<p>Prior to <span class="rlang"><b>R</b></span> version 1.9.0, underscores were not valid in variable names,
and code that relies on them being converted to dots will no longer
work. Use <code>allow_ = FALSE</code> for back-compatibility.
</p>
<p><code>allow_ = FALSE</code> is also useful when creating names for export to
applications which do not allow underline in names (such as some <abbr>DBMS</abbr>es).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.unique">make.unique</a></code>,
<code><a href="#topic+names">names</a></code>,
<code><a href="#topic+character">character</a></code>,
<code><a href="#topic+data.frame">data.frame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make.names(c("a and b", "a-and-b"), unique = TRUE)
# "a.and.b"  "a.and.b.1"
make.names(c("a and b", "a_and_b"), unique = TRUE)
# "a.and.b"  "a_and_b"
make.names(c("a and b", "a_and_b"), unique = TRUE, allow_ = FALSE)
# "a.and.b"  "a.and.b.1"
make.names(c("", "X"), unique = TRUE)
# "X.1" "X" currently; R up to 3.0.2 gave "X" "X.1"

state.name[make.names(state.name) != state.name] # those 10 with a space
</code></pre>

<hr>
<h2 id='make.unique'>Make Character Strings Unique</h2><span id='topic+make.unique'></span>

<h3>Description</h3>

<p>Makes the elements of a character vector unique by
appending sequence numbers to duplicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.unique(names, sep = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.unique_+3A_names">names</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="make.unique_+3A_sep">sep</code></td>
<td>
<p>a character string used to separate a duplicate name from
its sequence number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm used by <code>make.unique</code> has the property that
<code>make.unique(c(A, B)) == make.unique(c(make.unique(A), B))</code>.
</p>
<p>In other words, you can append one string at a time to a vector,
making it unique each time, and get the same result as applying
<code>make.unique</code> to all of the strings at once.
</p>
<p>If character vector <code>A</code> is already unique, then
<code>make.unique(c(A, B))</code> preserves <code>A</code>.
</p>


<h3>Value</h3>

<p>A character vector of same length as <code>names</code> with duplicates
changed, in the current locale's encoding.
</p>


<h3>Author(s)</h3>

<p>Thomas P. Minka</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.names">make.names</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>make.unique(c("a", "a", "a"))
make.unique(c(make.unique(c("a", "a")), "a"))

make.unique(c("a", "a", "a.2", "a"))
make.unique(c(make.unique(c("a", "a")), "a.2", "a"))

## Now show a bit where this is used :
trace(make.unique)
## Applied in data.frame() constructions:
(d1 &lt;- data.frame(x = 1, x = 2, x = 3)) # direct
 d2 &lt;- data.frame(data.frame(x = 1, x = 2), x = 3) # pairwise
stopifnot(identical(d1, d2),
          colnames(d1) == c("x", "x.1", "x.2"))
untrace(make.unique)
</code></pre>

<hr>
<h2 id='mapply'>Apply a Function to Multiple List or Vector Arguments</h2><span id='topic+mapply'></span><span id='topic+.mapply'></span>

<h3>Description</h3>

<p><code>mapply</code> is a multivariate version of <code><a href="#topic+sapply">sapply</a></code>.
<code>mapply</code> applies <code>FUN</code> to the first elements of each ...
argument, the second elements, the third elements, and so on.
Arguments are recycled if necessary.
</p>
<p><code>.mapply()</code> is a bare-bones version of <code>mapply()</code>, e.g., to be
used in other functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapply(FUN, ..., MoreArgs = NULL, SIMPLIFY = TRUE,
       USE.NAMES = TRUE)
.mapply(FUN, dots, MoreArgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapply_+3A_fun">FUN</code></td>
<td>
<p>function to apply, found via <code><a href="#topic+match.fun">match.fun</a></code>.</p>
</td></tr>
<tr><td><code id="mapply_+3A_...">...</code></td>
<td>
<p>arguments to vectorize over, will be recycled to common
length (zero if one of them is).  See also &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="mapply_+3A_dots">dots</code></td>
<td>
<p><code><a href="#topic+list">list</a></code> or <code><a href="#topic+pairlist">pairlist</a></code> of arguments to
vectorize over, see <code>...</code> above.</p>
</td></tr>
<tr><td><code id="mapply_+3A_moreargs">MoreArgs</code></td>
<td>
<p>a list of other arguments to <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="mapply_+3A_simplify">SIMPLIFY</code></td>
<td>
<p>logical or character string; attempt to reduce the
result to a vector, matrix or higher dimensional array; see
the <code>simplify</code> argument of <code><a href="#topic+sapply">sapply</a></code>.</p>
</td></tr>
<tr><td><code id="mapply_+3A_use.names">USE.NAMES</code></td>
<td>
<p>logical; use the names of the first ... argument, or
if that is an unnamed character vector, use that vector as the names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mapply</code> calls <code>FUN</code> for the values of <code>...</code>
(re-cycled to the length of the longest, unless any have length zero
where recycling to zero length will return <code>list()</code>),
followed by the arguments given in <code>MoreArgs</code>.  The arguments in
the call will be named if <code>...</code> or <code>MoreArgs</code> are named.
</p>
<p>For the arguments in <code>...</code> (or components in <code>dots</code>) class specific
subsetting (such as <code><a href="#topic++5B">[</a></code>) and <code>length</code> methods will be
used where applicable.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+list">list</a></code>, or for <code>SIMPLIFY = TRUE</code>, a vector, array or list.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sapply">sapply</a></code>, after which <code>mapply()</code> is modelled.
</p>
<p><code><a href="#topic+outer">outer</a></code>, which applies a vectorized function to all
combinations of two arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mapply(rep, 1:4, 4:1)

mapply(rep, times = 1:4, x = 4:1)

mapply(rep, times = 1:4, MoreArgs = list(x = 42))

mapply(function(x, y) seq_len(x) + y,
       c(a =  1, b = 2, c = 3),  # names from first
       c(A = 10, B = 0, C = -10))

word &lt;- function(C, k) paste(rep.int(C, k), collapse = "")
## names from the first, too:
utils::str(L &lt;- mapply(word, LETTERS[1:6], 6:1, SIMPLIFY = FALSE))

mapply(word, "A", integer()) # gave Error, now list()
</code></pre>

<hr>
<h2 id='marginSums'>Compute Table Margins</h2><span id='topic+marginSums'></span><span id='topic+margin.table'></span>

<h3>Description</h3>

<p>For a contingency table in array form, compute the sum of table
entries for a given margin or set of margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginSums(x, margin = NULL)
margin.table(x, margin = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginSums_+3A_x">x</code></td>
<td>
<p>an array, usually a <code><a href="#topic+table">table</a></code>.</p>
</td></tr>
<tr><td><code id="marginSums_+3A_margin">margin</code></td>
<td>
<p>a vector giving the margins to compute sums for.
E.g., for a matrix <code>1</code> indicates rows, <code>2</code> indicates
columns, <code>c(1, 2)</code> indicates rows and columns.
When <code>x</code> has named <code><a href="#topic+dimnames">dimnames</a></code>, it can be a character vector
selecting dimension names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The relevant marginal table, or just the sum of all entries if <code>margin</code> has length zero.  The class of <code>x</code> is copied to the
output table if <code>margin</code> is non-NULL.
</p>


<h3>Note</h3>

<p><code>margin.table</code> is an earlier name, retained for back-compatibility.</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard</p>


<h3>See Also</h3>

<p><code><a href="#topic+rowSums">rowSums</a></code> and <code><a href="#topic+colSums">colSums</a></code> for similar functionality.
</p>
<p><code><a href="#topic+proportions">proportions</a></code> and <code><a href="stats.html#topic+addmargins">addmargins</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m &lt;- matrix(1:4, 2)
marginSums(m, 1)  # = rowSums(m)
marginSums(m, 2)  # = colSums(m)

DF &lt;- as.data.frame(UCBAdmissions)
tbl &lt;- xtabs(Freq ~ Gender + Admit, DF)
tbl
marginSums(tbl, "Gender")  # a 1-dim "table"
rowSums(tbl)               # a numeric vector
</code></pre>

<hr>
<h2 id='mat.or.vec'>Create a Matrix or a Vector</h2><span id='topic+mat.or.vec'></span>

<h3>Description</h3>

<p><code>mat.or.vec</code> creates an <code>nr</code> by <code>nc</code> zero matrix if
<code>nc</code> is greater than 1, and a zero vector of length <code>nr</code> if
<code>nc</code> equals 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat.or.vec(nr, nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mat.or.vec_+3A_nr">nr</code>, <code id="mat.or.vec_+3A_nc">nc</code></td>
<td>
<p>numbers of rows and columns.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mat.or.vec(3, 1)
mat.or.vec(3, 2)
</code></pre>

<hr>
<h2 id='match'>Value Matching</h2><span id='topic+match'></span><span id='topic++25in+25'></span>

<h3>Description</h3>

<p><code>match</code> returns a vector of the positions of (first) matches of
its first argument in its second.
</p>
<p><code>%in%</code> is a more intuitive interface as a binary operator,
which returns a logical vector indicating if there is a match or not
for its left operand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match(x, table, nomatch = NA_integer_, incomparables = NULL)

x %in% table
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_+3A_x">x</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched.
<a href="#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="match_+3A_table">table</code></td>
<td>
<p>vector or <code>NULL</code>: the values to be matched against.
<a href="#topic+Long+20vectors">Long vectors</a> are not supported.</p>
</td></tr>
<tr><td><code id="match_+3A_nomatch">nomatch</code></td>
<td>
<p>the value to be returned in the case when no match is
found.  Note that it is coerced to <code>integer</code>.</p>
</td></tr>
<tr><td><code id="match_+3A_incomparables">incomparables</code></td>
<td>
<p>a vector of values that cannot be matched.  Any
value in <code>x</code> matching a value in this vector is assigned the
<code>nomatch</code> value.  For historical reasons, <code>FALSE</code> is
equivalent to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>%in%</code> is currently defined as <br />
<code>"%in%" &lt;- function(x, table) match(x, table, nomatch = 0) &gt; 0</code>
</p>
<p>Factors, raw vectors and lists are converted to character vectors,
internally classed objects are transformed via <code><a href="#topic+mtfrm">mtfrm</a></code>, and
then <code>x</code> and <code>table</code> are coerced to a common type (the later
of the two types in <span class="rlang"><b>R</b></span>'s ordering, logical &lt; integer &lt; numeric &lt;
complex &lt; character) before matching.  If <code>incomparables</code> has
positive length it is coerced to the common type.
</p>
<p>Matching for lists is potentially very slow and best avoided except in
simple cases.
</p>
<p>Exactly what matches what is to some extent a matter of definition.
For all types, <code>NA</code> matches <code>NA</code> and no other value.
For real and complex values, <code>NaN</code> values are regarded
as matching any other <code>NaN</code> value, but not matching <code>NA</code>,
where for complex <code>x</code>, real and imaginary parts must match both
(unless containing at least one <code>NA</code>).
</p>
<p>Character strings will be compared as byte sequences if any input is
marked as <code>"bytes"</code>, and otherwise are regarded as equal if they are
in different encodings but would agree when translated to UTF-8 (see
<code><a href="#topic+Encoding">Encoding</a></code>).
</p>
<p>That <code>%in%</code> never returns <code>NA</code> makes it particularly
useful in <code>if</code> conditions.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code>.
</p>
<p><code>match</code>: An integer vector giving the position in <code>table</code> of
the first match if there is a match, otherwise <code>nomatch</code>.
</p>
<p>If <code>x[i]</code> is found to equal <code>table[j]</code> then the value
returned in the <code>i</code>-th position of the return value is <code>j</code>,
for the smallest possible <code>j</code>.  If no match is found, the value
is <code>nomatch</code>.
</p>
<p><code>%in%</code>: A logical vector, indicating if a match was located for
each element of <code>x</code>: thus the values are <code>TRUE</code> or
<code>FALSE</code> and never <code>NA</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pmatch">pmatch</a></code> and <code><a href="#topic+charmatch">charmatch</a></code> for (<em>partial</em>)
string matching, <code><a href="#topic+match.arg">match.arg</a></code>, etc for function argument
matching.
<code><a href="#topic+findInterval">findInterval</a></code> similarly returns a vector of positions, but
finds numbers within intervals, rather than exact matches.
</p>
<p><code><a href="#topic+is.element">is.element</a></code> for an S-compatible equivalent of <code>%in%</code>.
</p>
<p><code><a href="#topic+unique">unique</a></code> (and <code><a href="#topic+duplicated">duplicated</a></code>) are using the same
definitions of &ldquo;match&rdquo; or &ldquo;equality&rdquo; as <code>match()</code>,
and these are less strict than <code><a href="#topic++3D+3D">==</a></code>, e.g., for
<code><a href="#topic+NA">NA</a></code> and <code><a href="#topic+NaN">NaN</a></code> in numeric or complex vectors,
or for strings with different encodings, see also above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The intersection of two sets can be defined via match():
## Simple version:
## intersect &lt;- function(x, y) y[match(x, y, nomatch = 0)]
intersect # the R function in base is slightly more careful
intersect(1:10, 7:20)

1:10 %in% c(1,3,5,9)
sstr &lt;- c("c","ab","B","bba","c",NA,"@","bla","a","Ba","%")
sstr[sstr %in% c(letters, LETTERS)]

"%w/o%" &lt;- function(x, y) x[!x %in% y] #--  x without y
(1:10) %w/o% c(3,7,12)
## Note that setdiff() is very similar and typically makes more sense:
        c(1:6,7:2) %w/o% c(3,7,12)  # -&gt; keeps duplicates
setdiff(c(1:6,7:2),      c(3,7,12)) # -&gt; unique values

## Illuminating example about NA matching
r &lt;- c(1, NA, NaN)
zN &lt;- c(complex(real = NA , imaginary =  r ), complex(real =  r , imaginary = NA ),
        complex(real =  r , imaginary = NaN), complex(real = NaN, imaginary =  r ))
zM &lt;- cbind(Re=Re(zN), Im=Im(zN), match = match(zN, zN))
rownames(zM) &lt;- format(zN)
zM ##--&gt; many "NA's" (= 1) and the four non-NA's (3 different ones, at 7,9,10)

length(zN) # 12
unique(zN) # the "NA" and the 3 different non-NA NaN's
stopifnot(identical(unique(zN), zN[c(1, 7,9,10)]))

## very strict equality would have 4 duplicates (of 12):
symnum(outer(zN, zN, Vectorize(identical,c("x","y")),
                     FALSE,FALSE,FALSE,FALSE))
## removing "(very strictly) duplicates",
i &lt;- c(5,8,11,12)  # we get 8 pairwise non-identicals :
Ixy &lt;- outer(zN[-i], zN[-i], Vectorize(identical,c("x","y")),
                     FALSE,FALSE,FALSE,FALSE)
stopifnot(identical(Ixy, diag(8) == 1))
</code></pre>

<hr>
<h2 id='match.arg'>Argument Verification Using Partial Matching</h2><span id='topic+match.arg'></span>

<h3>Description</h3>

<p><code>match.arg</code> matches a character <code>arg</code> against a table of
candidate values as specified by <code>choices</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match.arg(arg, choices, several.ok = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match.arg_+3A_arg">arg</code></td>
<td>
<p>a character vector (of length one unless <code>several.ok</code>
is <code>TRUE</code>) or <code>NULL</code> which means to take <code>choices[1]</code>.</p>
</td></tr>
<tr><td><code id="match.arg_+3A_choices">choices</code></td>
<td>
<p>a character vector of candidate values, often missing, see
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="match.arg_+3A_several.ok">several.ok</code></td>
<td>
<p>logical specifying if <code>arg</code> should be allowed
to have more than one element.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the one-argument form <code>match.arg(arg)</code>, the choices are
obtained from a default setting for the formal argument <code>arg</code> of
the function from which <code>match.arg</code> was called.  (Since default
argument matching will set <code>arg</code> to <code>choices</code>, this is
allowed as an exception to the &lsquo;length one unless
<code>several.ok</code> is <code>TRUE</code>&rsquo; rule, and returns the first
element.)
</p>
<p>Matching is done using <code><a href="#topic+pmatch">pmatch</a></code>, so <code>arg</code> may be
abbreviated and the empty string (<code>""</code>) never matches, not even
itself, see <code><a href="#topic+pmatch">pmatch</a></code>.
</p>


<h3>Value</h3>

<p>The unabbreviated version of the exact or unique partial match if
there is one; otherwise, an error is signalled if <code>several.ok</code> is
false, as per default.  When <code>several.ok</code> is true and (at least)
one element of <code>arg</code> has a match, all unabbreviated versions of
matches are returned.
</p>


<h3>Warning</h3>

<p>The error messages given are liable to change and did so in <span class="rlang"><b>R</b></span> 4.2.0.
Do not test them in packages.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pmatch">pmatch</a></code>,
<code><a href="#topic+match.fun">match.fun</a></code>,
<code><a href="#topic+match.call">match.call</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
## Extends the example for 'switch'
center &lt;- function(x, type = c("mean", "median", "trimmed")) {
  type &lt;- match.arg(type)
  switch(type,
         mean = mean(x),
         median = median(x),
         trimmed = mean(x, trim = .1))
}
x &lt;- rcauchy(10)
center(x, "t")       # Works
center(x, "med")     # Works
try(center(x, "m"))  # Error
stopifnot(identical(center(x),       center(x, "mean")),
          identical(center(x, NULL), center(x, "mean")) )

## Allowing more than one 'arg' and hence more than one match:
match.arg(c("gauss", "rect", "ep"),
          c("gaussian", "epanechnikov", "rectangular", "triangular"),
          several.ok = TRUE)
match.arg(c("a", ""),  c("", NA, "bb", "abc"), several.ok=TRUE) # |--&gt;  "abc"
</code></pre>

<hr>
<h2 id='match.call'>Argument Matching</h2><span id='topic+match.call'></span>

<h3>Description</h3>

<p><code>match.call</code> returns a call in which all of the specified arguments are
specified by their full names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match.call(definition = sys.function(sys.parent()),
           call = sys.call(sys.parent()),
           expand.dots = TRUE,
           envir = parent.frame(2L))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match.call_+3A_definition">definition</code></td>
<td>
<p>a function, by default the function from which
<code>match.call</code> is called.  See details.</p>
</td></tr>
<tr><td><code id="match.call_+3A_call">call</code></td>
<td>
<p>an unevaluated call to the function specified by
<code>definition</code>, as generated by <code><a href="#topic+call">call</a></code>.</p>
</td></tr>
<tr><td><code id="match.call_+3A_expand.dots">expand.dots</code></td>
<td>
<p>logical.  Should arguments matching <code>...</code>
in the call be included or left as a <code>...</code> argument?</p>
</td></tr>
<tr><td><code id="match.call_+3A_envir">envir</code></td>
<td>
<p>an environment, from which the <code>...</code> in <code>call</code>
are retrieved, if any.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;function&rsquo; on this help page means an interpreted function
(also known as a &lsquo;closure&rsquo;):  <code>match.call</code> does not support
primitive functions (where argument matching is normally
positional).
</p>
<p><code>match.call</code> is most commonly used in two circumstances:
</p>

<ul>
<li><p> To record the call for later re-use: for example most
model-fitting functions record the call as element <code>call</code> of
the list they return.  Here the default <code>expand.dots = TRUE</code>
is appropriate.
</p>
</li>
<li><p> To pass most of the call to another function, often
<code>model.frame</code>.  Here the common idiom is that
<code>expand.dots = FALSE</code> is used, and the <code>...</code> element
of the matched call is removed.  An alternative is to
explicitly select the arguments to be passed on, as is done in
<code>lm</code>.
</p>
</li></ul>

<p>Calling <code>match.call</code> outside a function without specifying
<code>definition</code> is an error.
</p>


<h3>Value</h3>

<p>An object of class <code>call</code>.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data. A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sys.call">sys.call</a>()</code> is similar, but does <em>not</em> expand the
argument names;
<code><a href="#topic+call">call</a></code>, <code><a href="#topic+pmatch">pmatch</a></code>, <code><a href="#topic+match.arg">match.arg</a></code>,
<code><a href="#topic+match.fun">match.fun</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>match.call(get, call("get", "abc", i = FALSE, p = 3))
## -&gt; get(x = "abc", pos = 3, inherits = FALSE)
fun &lt;- function(x, lower = 0, upper = 1) {
  structure((x - lower) / (upper - lower), CALL = match.call())
}
fun(4 * atan(1), u = pi)
</code></pre>

<hr>
<h2 id='match.fun'>Extract a Function Specified by Name</h2><span id='topic+match.fun'></span>

<h3>Description</h3>

<p>When called inside functions that take a function as argument, extract
the desired function object while avoiding undesired matching to
objects of other types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match.fun(FUN, descend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match.fun_+3A_fun">FUN</code></td>
<td>
<p>item to match as function: a function, symbol or
character string.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="match.fun_+3A_descend">descend</code></td>
<td>
<p>logical; control whether to search past non-function
objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>match.fun</code> is not intended to be used at the top level since it
will perform matching in the <em>parent</em> of the caller.
</p>
<p>If <code>FUN</code> is a function, it is returned.  If it is a symbol (for
example, enclosed in backquotes) or a
character vector of length one, it will be looked up using <code>get</code>
in the environment of the parent of the caller.  If it is of any other
mode, it is attempted first to get the argument to the caller as a
symbol (using <code>substitute</code> twice), and if that fails, an error is
declared.
</p>
<p>If <code>descend = TRUE</code>, <code>match.fun</code> will look past non-function
objects with the given name; otherwise if <code>FUN</code> points to a
non-function object then an error is generated.
</p>
<p>This is used in base functions such as <code><a href="#topic+apply">apply</a></code>,
<code><a href="#topic+lapply">lapply</a></code>, <code><a href="#topic+outer">outer</a></code>, and <code><a href="#topic+sweep">sweep</a></code>.
</p>


<h3>Value</h3>

<p>A function matching <code>FUN</code> or an error is generated.
</p>


<h3>Bugs</h3>

<p>The <code>descend</code> argument is a bit of misnomer and probably not
actually needed by anything.  It may go away in the future.
</p>
<p>It is impossible to fully foolproof this.  If one <code>attach</code>es a
list or data frame containing a length-one character vector with the
same name as a function, it may be used (although namespaces
will help).
</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard and Robert Gentleman, based on an earlier version
by Jonathan Rougier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+match.arg">match.arg</a></code>, <code><a href="#topic+get">get</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Same as get("*"):
match.fun("*")
# Overwrite outer with a vector
outer &lt;- 1:5
try(match.fun(outer, descend = FALSE)) #-&gt; Error:  not a function
match.fun(outer) # finds it anyway
is.function(match.fun("outer")) # as well
</code></pre>

<hr>
<h2 id='MathFun'>Miscellaneous Mathematical Functions</h2><span id='topic+abs'></span><span id='topic+sqrt'></span>

<h3>Description</h3>

<p><code>abs(x)</code> computes the absolute value of x, <code>sqrt(x)</code> computes the
(principal) square root of x, <code class="reqn">\sqrt{x}</code>.
</p>
<p>The naming follows the standard for computer languages such as C or Fortran.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abs(x)
sqrt(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MathFun_+3A_x">x</code></td>
<td>
<p>a numeric or <code><a href="#topic+complex">complex</a></code> vector or array.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a> functions: methods
can be defined for them individually or via the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generic.  For complex
arguments (and the default method), <code>z</code>, <code>abs(z) ==
  <a href="#topic+Mod">Mod</a>(z)</code> and <code>sqrt(z) == z^0.5</code>.
</p>
<p><code>abs(x)</code> returns an <code><a href="#topic+integer">integer</a></code> vector when <code>x</code> is
<code>integer</code> or <code><a href="#topic+logical">logical</a></code>.
</p>


<h3>S4 methods</h3>

<p>Both are S4 generic and members of the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Arithmetic">Arithmetic</a></code> for simple, <code><a href="#topic+log">log</a></code> for logarithmic,
<code><a href="#topic+sin">sin</a></code> for trigonometric, and <code><a href="#topic+Special">Special</a></code> for
special mathematical functions.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>sqrt</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for spline
require(graphics)
xx &lt;- -9:9
plot(xx, sqrt(abs(xx)),  col = "red")
lines(spline(xx, sqrt(abs(xx)), n=101), col = "pink")
</code></pre>

<hr>
<h2 id='matmult'>Matrix Multiplication</h2><span id='topic++25+2A+25'></span><span id='topic+matmult'></span>

<h3>Description</h3>

<p>Multiplies two matrices, if they are conformable.  If one argument is
a vector, it will be promoted to either a row or column matrix to make
the two arguments conformable.  If both are vectors of the same
length, it will return the inner product (as a matrix).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %*% y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matmult_+3A_x">x</code>, <code id="matmult_+3A_y">y</code></td>
<td>
<p>numeric or complex matrices or vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a vector is promoted to a matrix, its names are not
promoted to row or column names, unlike <code><a href="#topic+as.matrix">as.matrix</a></code>.
</p>
<p>Promotion of a vector to a 1-row or 1-column matrix happens when one
of the two choices allows <code>x</code> and <code>y</code> to get conformable
dimensions.
</p>
<p>This operator is a generic function: methods can be written for it
individually or via the <code><a href="#topic+S3groupGeneric">matOps</a></code> group
generic function; it dispatches to S3 and S4 methods.  Methods need to be
written for a function that takes two arguments named <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<p>A double or complex matrix product.  Use <code><a href="#topic+drop">drop</a></code> to remove
dimensions which have only one level.
</p>


<h3>Note</h3>

<p>The propagation of NaN/Inf values, precision, and performance of matrix
products can be controlled by <code><a href="#topic+options">options</a>("matprod")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>For matrix <em>cross</em> products, <code><a href="#topic+crossprod">crossprod</a>()</code> and
<code>tcrossprod()</code> are typically preferable.
<code><a href="#topic+matrix">matrix</a></code>, <code><a href="#topic+Arithmetic">Arithmetic</a></code>, <code><a href="#topic+diag">diag</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:4
(z &lt;- x %*% x)    # scalar ("inner") product (1 x 1 matrix)
drop(z)             # as scalar

y &lt;- diag(x)
z &lt;- matrix(1:12, ncol = 3, nrow = 4)
y %*% z
y %*% x
x %*% z
</code></pre>

<hr>
<h2 id='matrix'>Matrices</h2><span id='topic+matrix'></span><span id='topic+as.matrix'></span><span id='topic+as.matrix.default'></span><span id='topic+as.matrix.data.frame'></span><span id='topic+is.matrix'></span>

<h3>Description</h3>

<p><code>matrix</code> creates a matrix from the given set of values.
</p>
<p><code>as.matrix</code> attempts to turn its argument into a matrix.
</p>
<p><code>is.matrix</code> tests if its argument is a (strict) matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix(data = NA, nrow = 1, ncol = 1, byrow = FALSE,
       dimnames = NULL)

as.matrix(x, ...)
## S3 method for class 'data.frame'
as.matrix(x, rownames.force = NA, ...)

is.matrix(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix_+3A_data">data</code></td>
<td>
<p>an optional data vector (including a list or
<code><a href="#topic+expression">expression</a></code> vector).  Non-atomic classed <span class="rlang"><b>R</b></span> objects are
coerced by <code><a href="#topic+as.vector">as.vector</a></code> and all attributes discarded.</p>
</td></tr>
<tr><td><code id="matrix_+3A_nrow">nrow</code></td>
<td>
<p>the desired number of rows.</p>
</td></tr>
<tr><td><code id="matrix_+3A_ncol">ncol</code></td>
<td>
<p>the desired number of columns.</p>
</td></tr>
<tr><td><code id="matrix_+3A_byrow">byrow</code></td>
<td>
<p>logical. If <code>FALSE</code> (the default) the matrix is
filled by columns, otherwise the matrix is filled by rows.</p>
</td></tr>
<tr><td><code id="matrix_+3A_dimnames">dimnames</code></td>
<td>
<p>a <code><a href="#topic+dimnames">dimnames</a></code> attribute for the matrix:
<code>NULL</code> or a <code>list</code> of length 2 giving the row and column
names respectively.  An empty list is treated as <code>NULL</code>, and a
list of length one as row names.  The list can be named, and the
list names will be used as names for the dimensions.</p>
</td></tr>
<tr><td><code id="matrix_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="matrix_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="matrix_+3A_rownames.force">rownames.force</code></td>
<td>
<p>logical indicating if the resulting matrix
should have character (rather than <code>NULL</code>)
<code><a href="#topic+rownames">rownames</a></code>.  The default, <code>NA</code>, uses <code>NULL</code>
rownames if the data frame has &lsquo;automatic&rsquo; row.names or for a
zero-row data frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If one of <code>nrow</code> or <code>ncol</code> is not given, an attempt is
made to infer it from the length of <code>data</code> and the other
parameter.  If neither is given, a one-column matrix is returned.
</p>
<p>If there are too few elements in <code>data</code> to fill the matrix,
then the elements in <code>data</code> are recycled.  If <code>data</code> has
length zero, <code>NA</code> of an appropriate type is used for atomic
vectors (<code>0</code> for raw vectors) and <code>NULL</code> for lists.
</p>
<p><code>is.matrix</code> returns <code>TRUE</code> if <code>x</code> is a vector and has a
<code>"<a href="#topic+dim">dim</a>"</code> attribute of length 2 and <code>FALSE</code> otherwise.
Note that a <code><a href="#topic+data.frame">data.frame</a></code> is <strong>not</strong> a matrix by this
test.  The function is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>
<p><code>as.matrix</code> is a generic function.  The method for data frames
will return a character matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying <code><a href="#topic+as.vector">as.vector</a></code>
to factors and <code><a href="#topic+format">format</a></code> to other non-character columns.
Otherwise, the usual coercion hierarchy (logical &lt; integer &lt; double &lt;
complex) will be used, e.g., all-logical data frames will be coerced
to a logical matrix, mixed logical-integer will give a integer matrix,
etc.
</p>
<p>The default method for <code>as.matrix</code> calls <code>as.vector(x)</code>, and
hence e.g. coerces factors to character vectors.
</p>
<p>When coercing a vector, it produces a one-column matrix, and
promotes the names (if any) of the vector to the rownames of the matrix.
</p>
<p><code>is.matrix</code> is a <a href="#topic+primitive">primitive</a> function.
</p>
<p>The <code>print</code> method for a matrix gives a rectangular layout with
dimnames or indices.  For a list matrix, the entries of length not
one are printed in  the form &lsquo;<span class="samp">&#8288;integer,7&#8288;</span>&rsquo; indicating the type
and length.
</p>


<h3>Note</h3>

<p>If you just want to convert a vector to a matrix, something like
</p>
<pre>  dim(x) &lt;- c(nx, ny)
  dimnames(x) &lt;- list(row_names, col_names)
</pre>
<p>will avoid duplicating <code>x</code> <em>and</em> preserve
<code><a href="#topic+class">class</a>(x)</code> which may be useful, e.g.,
for <code><a href="#topic+Date">Date</a></code> objects.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.matrix">data.matrix</a></code>, which attempts to convert to a numeric
matrix.
</p>
<p>A matrix is the special case of a two-dimensional <code><a href="#topic+array">array</a></code>.
<code><a href="#topic+inherits">inherits</a>(m, "array")</code> is true for a <code>matrix</code> <code>m</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.matrix(as.matrix(1:10))
!is.matrix(warpbreaks)  # data.frame, NOT matrix!
warpbreaks[1:10,]
as.matrix(warpbreaks[1:10,])  # using as.matrix.data.frame(.) method

## Example of setting row and column names
mdat &lt;- matrix(c(1,2,3, 11,12,13), nrow = 2, ncol = 3, byrow = TRUE,
               dimnames = list(c("row1", "row2"),
                               c("C.1", "C.2", "C.3")))
mdat
</code></pre>

<hr>
<h2 id='maxCol'>Find Maximum Position in Matrix</h2><span id='topic+max.col'></span>

<h3>Description</h3>

<p>Find the maximum position for each row of a matrix, breaking ties at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max.col(m, ties.method = c("random", "first", "last"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxCol_+3A_m">m</code></td>
<td>
<p>a numerical matrix.</p>
</td></tr>
<tr><td><code id="maxCol_+3A_ties.method">ties.method</code></td>
<td>
<p>a character string specifying how ties are
handled, <code>"random"</code> by default; can be abbreviated; see
&lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>ties.method = "random"</code>, as per default, ties are broken at
random.  In this case, the determination of a tie assumes that
the entries are probabilities: there is a relative tolerance of
<code class="reqn">10^{-5}</code>, relative to the largest (in magnitude, omitting
infinity) entry in the row.
</p>
<p>If <code>ties.method = "first"</code>, <code>max.col</code> returns the
column number of the <em>first</em> of several maxima in every row, the
same   as <code><a href="#topic+unname">unname</a>(<a href="#topic+apply">apply</a>(m, 1, <a href="#topic+which.max">which.max</a>))</code>
if <code>m</code> has no missing values.<br />
Correspondingly, <code>ties.method = "last"</code> returns the <em>last</em>
of possibly several indices.
</p>


<h3>Value</h3>

<p>index of a maximal value for each row, an integer vector of
length <code>nrow(m)</code>.
</p>


<h3>References</h3>

<p>Venables, W. N. and Ripley, B. D. (2002)
<em>Modern Applied Statistics with S.</em>
New York: Springer (4th ed).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+which.max">which.max</a></code> for vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>table(mc &lt;- max.col(swiss))  # mostly "1" and "5", 5 x "2" and once "4"
swiss[unique(print(mr &lt;- max.col(t(swiss)))) , ]  # 3 33 45 45 33 6

set.seed(1)  # reproducible example:
(mm &lt;- rbind(x = round(2*stats::runif(12)),
             y = round(5*stats::runif(12)),
             z = round(8*stats::runif(12))))
## Not run: 
  [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12]
x    1    1    1    2    0    2    2    1    1     0     0     0
y    3    2    4    2    4    5    2    4    5     1     3     1
z    2    3    0    3    7    3    4    5    4     1     7     5

## End(Not run)
## column indices of all row maxima :
utils::str(lapply(1:3, function(i) which(mm[i,] == max(mm[i,]))))
max.col(mm) ; max.col(mm) # "random"
max.col(mm, "first") # -&gt; 4 6 5
max.col(mm, "last")  # -&gt; 7 9 11

</code></pre>

<hr>
<h2 id='mean'>Arithmetic Mean</h2><span id='topic+mean'></span><span id='topic+mean.default'></span>

<h3>Description</h3>

<p>Generic function for the (trimmed) arithmetic mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean(x, ...)

## Default S3 method:
mean(x, trim = 0, na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.  Currently there are methods for
numeric/logical vectors and <a href="#topic+Dates">date</a>,
<a href="#topic+date-time">date-time</a> and <a href="#topic+time+20interval">time interval</a> objects.  Complex vectors
are allowed for <code>trim = 0</code>, only.</p>
</td></tr>
<tr><td><code id="mean_+3A_trim">trim</code></td>
<td>
<p>the fraction (0 to 0.5) of observations to be
trimmed from each end of <code>x</code> before the mean is computed.
Values of trim outside that range are taken as the nearest endpoint.
</p>
</td></tr>
<tr><td><code id="mean_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical evaluating to <code>TRUE</code> or <code>FALSE</code>
indicating whether <code>NA</code> values should be stripped before the
computation proceeds.</p>
</td></tr> 
<tr><td><code id="mean_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>trim</code> is zero (the default), the arithmetic mean of the
values in <code>x</code> is computed, as a numeric or complex vector of
length one.  If <code>x</code> is not logical (coerced to numeric), numeric
(including integer) or complex, <code>NA_real_</code> is returned, with a warning.
</p>
<p>If <code>trim</code> is non-zero, a symmetrically trimmed mean is computed
with a fraction of <code>trim</code> observations deleted from each end
before the mean is computed.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+weighted.mean">weighted.mean</a></code>, <code><a href="#topic+mean.POSIXct">mean.POSIXct</a></code>,
<code><a href="#topic+colMeans">colMeans</a></code> for row and column means.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(0:10, 50)
xm &lt;- mean(x)
c(xm, mean(x, trim = 0.10))
</code></pre>

<hr>
<h2 id='memCompress'>In-memory Compression and Decompression</h2><span id='topic+memCompress'></span><span id='topic+memDecompress'></span>

<h3>Description</h3>

<p>In-memory compression or decompression for raw vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memCompress(from, type = c("gzip", "bzip2", "xz", "none"))

memDecompress(from,
              type = c("unknown", "gzip", "bzip2", "xz", "none"),
              asChar = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memCompress_+3A_from">from</code></td>
<td>
<p>raw vector.  For <code>memCompress</code>, a character vector
will be converted to a raw vector with character strings separated
by <code>"\n"</code>.  Types except <code>"bzip2"</code> support long
raw vectors.
</p>
</td></tr>
<tr><td><code id="memCompress_+3A_type">type</code></td>
<td>
<p>character string, the type of compression.  May be
abbreviated to a single letter, defaults to the first of the alternatives.</p>
</td></tr>
<tr><td><code id="memCompress_+3A_aschar">asChar</code></td>
<td>
<p>logical: should the result be converted to a character
string?  NB: character strings have a limit of
<code class="reqn">2^{31}-1</code> bytes, so raw vectors should be used for
large inputs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type = "none"</code> passes the input through unchanged, but may be
useful if <code>type</code> is a variable.
</p>
<p><code>type = "unknown"</code> attempts to detect the type of compression
applied (if any): this will always succeed for <code>bzip2</code>
compression, and will succeed for other forms if there is a suitable
header.  If no type of compression is detected this is the same as
<code>type = "none"</code> but a warning is given.
</p>
<p><code>gzip</code> compression uses whatever is the default compression
level of the underlying library (usually <code>6</code>). This supports the
RFC 1950 format, sometimes known as &lsquo;zlib&rsquo; format, for
compression and decompression and for decompression only RFC 1952, the
&lsquo;gzip&rsquo; format (which wraps the &lsquo;zlib&rsquo; format with a
header and footer).
</p>
<p><code>bzip2</code> compression always adds a header (<code>"BZh"</code>).  The
underlying library only supports in-memory (de)compression of up to
<code class="reqn">2^{31}-1</code> elements.  Compression is equivalent to
<code>bzip2 -9</code> (the default).
</p>
<p>Compressing with <code>type = "xz"</code> is equivalent to compressing a
file with <code>xz -9e</code> (including adding the &lsquo;magic&rsquo;
header): decompression should cope with the contents of any file
compressed by <code>xz</code> version 4.999 and later, as well as by some
versions of <code>lzma</code>.  There are other versions, in particular
&lsquo;raw&rsquo; streams, that are not currently handled.
</p>
<p>All the types of compression can expand the input: for <code>"gzip"</code>
and <code>"bzip2"</code> the maximum expansion is known and so
<code>memCompress</code> can always allocate sufficient space.  For
<code>"xz"</code> it is possible (but extremely unlikely) that compression
will fail if the output would have been too large.
</p>


<h3>Value</h3>

<p>A raw vector or a character string (if <code>asChar = TRUE</code>).
</p>


<h3><code>libdeflate</code></h3>

<p>Support for the <code>libdeflate</code> library was added for <span class="rlang"><b>R</b></span> 4.4.0.  It
uses different code for the RFC 1950 &lsquo;zlib&rsquo; format (and RFC
1952 for decompression), expected to be substantially faster than
using the reference (or system) zlib library.  It is used for
<code>type = "gzip"</code> if available.
</p>
<p>The headers and sources can be downloaded from
<a href="https://github.com/ebiggers/libdeflate">https://github.com/ebiggers/libdeflate</a> and pre-built versions
are available for most Linux distributions.  It is used for binary
Windows distributions.
</p>


<h3>See Also</h3>

<p><a href="#topic+connections">connections</a>.
</p>
<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for the versions of the <code>zlib</code> or
<code>libdeflate</code>, <code>bzip2</code> and <code>xz</code> libraries in use.
</p>
<p><a href="https://en.wikipedia.org/wiki/Data_compression">https://en.wikipedia.org/wiki/Data_compression</a> for background on
data compression, <a href="https://zlib.net/">https://zlib.net/</a>,
<a href="https://en.wikipedia.org/wiki/Gzip">https://en.wikipedia.org/wiki/Gzip</a>, <a href="http://www.bzip.org/">http://www.bzip.org/</a>,
<a href="https://en.wikipedia.org/wiki/Bzip2">https://en.wikipedia.org/wiki/Bzip2</a>,

and <a href="https://en.wikipedia.org/wiki/XZ_Utils">https://en.wikipedia.org/wiki/XZ_Utils</a> for references about the
particular schemes used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>txt &lt;- readLines(file.path(R.home("doc"), "COPYING"))
sum(nchar(txt))
txt.gz &lt;- memCompress(txt, "g") # "gzip", the default
length(txt.gz)
txt2 &lt;- strsplit(memDecompress(txt.gz, "g", asChar = TRUE), "\n")[[1]]
stopifnot(identical(txt, txt2))
## as from R 4.4.0 this is detected if not specified.
txt2b &lt;- strsplit(memDecompress(txt.gz, asChar = TRUE), "\n")[[1]]
stopifnot(identical(txt2b, txt2))

txt.bz2 &lt;- memCompress(txt, "b")
length(txt.bz2)
## can auto-detect bzip2:
txt3 &lt;- strsplit(memDecompress(txt.bz2, asChar = TRUE), "\n")[[1]]
stopifnot(identical(txt, txt3))

## xz compression is only worthwhile for large objects
txt.xz &lt;- memCompress(txt, "x")
length(txt.xz)
txt3 &lt;- strsplit(memDecompress(txt.xz, asChar = TRUE), "\n")[[1]]
stopifnot(identical(txt, txt3))

## test decompressing a gzip-ed file
tf &lt;- tempfile(fileext = ".gz")
con &lt;- gzfile(tf, "w")
writeLines(txt, con)
close(con)
(nf &lt;- file.size(tf))
# if (nzchar(Sys.which("file"))) system2("file", tf)
foo &lt;- readBin(tf, "raw", n = nf)
unlink(tf)
## will detect the gzip header and choose type = "gzip"
txt3 &lt;- strsplit(memDecompress(foo, asChar = TRUE), "\n")[[1]]
stopifnot(identical(txt, txt3))
</code></pre>

<hr>
<h2 id='memlimits'>Query and Set Heap Size Limits</h2><span id='topic+mem.maxVSize'></span><span id='topic+mem.maxNSize'></span>

<h3>Description</h3>

<p>Query and set the maximal size of the vector heap and the maximal
number of heap nodes for the current <span class="rlang"><b>R</b></span> process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mem.maxVSize(vsize = 0)
mem.maxNSize(nsize = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memlimits_+3A_vsize">vsize</code></td>
<td>
<p>numeric; new size limit in Mb.</p>
</td></tr>
<tr><td><code id="memlimits_+3A_nsize">nsize</code></td>
<td>
<p>numeric; new maximal node number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>New limits lower than current usage are ignored.
Specifying a size of <code>Inf</code> sets the limit to the maximal possible
value for the platform.
</p>
<p>The default maximal values are unlimited on most platforms, but can be
adjusted using environment variables as described in
<code><a href="#topic+Memory">Memory</a></code>. On macOS a lower default vector heap limit is
used to protect against the <span class="rlang"><b>R</b></span> process being killed when macOS
over-commits memory.
</p>
<p>Adjusting the maximal number of nodes is rarely necessary. Adjusting
the vector heap size limit can be useful on macOS in particular but
should be done with caution.
</p>


<h3>Value</h3>

<p>The current or new value, in Mb for <code>mem.maxVSize</code>. <code>Inf</code> is
returned if the current value is unlimited.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Memory">Memory</a></code>.
</p>

<hr>
<h2 id='Memory'>Memory Available for Data Storage</h2><span id='topic+Memory'></span>

<h3>Description</h3>

<p>How <span class="rlang"><b>R</b></span> manages its workspace.
</p>


<h3>Details</h3>

<p><span class="rlang"><b>R</b></span> has a variable-sized workspace.  There are (rarely-used)
command-line options to control its minimum size, but no longer any to
control the maximum size.
</p>
<p><span class="rlang"><b>R</b></span> maintains separate areas for fixed and variable sized objects.  The
first of these is allocated as an array of <em>cons cells</em> (Lisp
programmers will know what they are, others may think of them as the
building blocks of the language itself, parse trees, etc.), and the
second are thrown on a <em>heap</em> of &lsquo;Vcells&rsquo; of 8 bytes each.
Each cons cell occupies 28 bytes on a 32-bit build of <span class="rlang"><b>R</b></span>, (usually) 56
bytes on a 64-bit build.
</p>
<p>The default values are (currently) an initial setting of 350k cons
cells and 6Mb of vector heap.  Note that the areas are not actually
allocated initially: rather these values are the sizes for triggering
garbage collection.  These values can be set by the command line
options <span class="option">--min-nsize</span> and <span class="option">--min-vsize</span> (or if they are
not used, the environment variables <span class="env">R_NSIZE</span> and <span class="env">R_VSIZE</span>)
when <span class="rlang"><b>R</b></span> is started.  Thereafter <span class="rlang"><b>R</b></span> will grow or shrink the areas
depending on usage, never decreasing below the initial values.  The
maximal vector heap size can be set with the environment variable
<span class="env">R_MAX_VSIZE</span>. An attempt to set a lower maximum than the current
usage is ignored. Vector heap limits are given in bytes.
</p>
<p>How much time <span class="rlang"><b>R</b></span> spends in the garbage collector will depend on these
initial settings and on the trade-off the memory manager makes, when
memory fills up, between collecting garbage to free up unused memory
and growing these areas.  The strategy used for growth can be
specified by setting the environment variable <span class="env">R_GC_MEM_GROW</span> to
an integer value between 0 and 3. This variable is read at
start-up. Higher values grow the heap more aggressively, thus reducing
garbage collection time but using more memory.
</p>
<p>You can find out the current memory consumption (the heap and cons
cells used as numbers and megabytes) by typing <code><a href="#topic+gc">gc</a>()</code> at the
<span class="rlang"><b>R</b></span> prompt.  Note that following <code><a href="#topic+gcinfo">gcinfo</a>(TRUE)</code>, automatic
garbage collection always prints memory use statistics.
</p>
<p>The command-line option <span class="option">--max-ppsize</span> controls the maximum
size of the pointer protection stack.  This defaults to 50000, but can
be increased to allow deep recursion or large and complicated
calculations to be done.  <em>Note</em> that parts of the garbage
collection process goes through the full reserved pointer protection
stack and hence becomes slower when the size is increased.  Currently
the maximum value accepted is 500000.
</p>


<h3>See Also</h3>

<p><em>An Introduction to R</em> for more command-line options.
</p>
<p><code><a href="#topic+Memory-limits">Memory-limits</a></code> for the design limitations.
</p>
<p><code><a href="#topic+gc">gc</a></code> for information on the garbage collector and total
memory usage,  <code><a href="utils.html#topic+object.size">object.size</a>(a)</code> for the (approximate)
size of <span class="rlang"><b>R</b></span> object <code>a</code>.  <code><a href="#topic+memory.profile">memory.profile</a></code> for
profiling the usage of cons cells.
</p>

<hr>
<h2 id='Memory-limits'>Memory Limits in R</h2><span id='topic+Memory-limits'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> holds objects it is using in virtual memory.  This help file
documents the current design limitations on large objects: these
differ between 32-bit and 64-bit builds of <span class="rlang"><b>R</b></span>.
</p>


<h3>Details</h3>

<p>Currently <span class="rlang"><b>R</b></span> runs on 32- and 64-bit operating systems, and most 64-bit
OSes (including Linux, Solaris, Windows and macOS) can run either
32- or 64-bit builds of <span class="rlang"><b>R</b></span>.  The memory limits depends mainly on the
build, but for a 32-bit build of <span class="rlang"><b>R</b></span> on Windows they also depend on the
underlying OS version.
</p>
<p><span class="rlang"><b>R</b></span> holds all objects in virtual memory, and there are limits based on the
amount of memory that can be used by all objects:
</p>

<ul>
<li><p> There may be limits on the size of the heap and the number of
cons cells allowed &ndash; see <code><a href="#topic+Memory">Memory</a></code> &ndash; but these are
usually not imposed.
</p>
</li>
<li><p> There is a limit on the (user) address space of a single
process such as the <span class="rlang"><b>R</b></span> executable.  This is system-specific, and can
depend on the executable.
</p>
</li>
<li><p> The environment may impose limitations on the resources
available to a single process: Windows' versions of <span class="rlang"><b>R</b></span> do so directly.
</p>
</li></ul>

<p>Error messages beginning &lsquo;<span class="samp">&#8288;cannot allocate vector of size&#8288;</span>&rsquo;
indicate a failure to obtain memory, either because the size exceeded
the address-space limit for a process or, more likely, because the
system was unable to provide the memory.  Note that on a 32-bit build
there may well be enough free memory available, but not a large enough
contiguous block of address space into which to map it.
</p>
<p>There are also limits on individual objects. The storage space
cannot exceed the address limit, and if you try to exceed that limit,
the error message begins &lsquo;<span class="samp">&#8288;cannot allocate vector of length&#8288;</span>&rsquo;.
The number of bytes in a character string is limited to
<code class="reqn">2^{31} - 1 \approx 2\thinspace 10^9</code>,
which is also the limit on each dimension of an array.
</p>


<h3>Unix</h3>

<p>The address-space limit is system-specific: 32-bit OSes
imposes a limit of no more than 4<abbr>Gb</abbr>: it is often 3<abbr>Gb</abbr>.  Running
32-bit executables on a 64-bit OS will have similar limits: 64-bit
executables will have an essentially infinite system-specific limit
(e.g., 128Tb for Linux on x86_64 CPUs).
</p>
<p>See the OS/shell's help on commands such as <code>limit</code> or
<code>ulimit</code> for how to impose limitations on the resources available
to a single process.  For example a <code>bash</code> user could use
</p>
<pre>ulimit -t 600 -v 4000000
</pre>
<p>whereas a <code>csh</code> user might use
</p>
<pre>limit cputime 10m
limit vmemoryuse 4096m
</pre>
<p>to limit a process to 10 minutes of CPU time and (around) 4<abbr>Gb</abbr> of
virtual memory.  (There are other options to set the RAM in use, but they
are not generally honoured.)
</p>


<h3>Windows</h3>

<p>The address-space limit is 2<abbr>Gb</abbr> under 32-bit Windows unless the OS's
default has been changed to allow more (up to 3<abbr>Gb</abbr>).  See
<a href="https://docs.microsoft.com/en-gb/windows/desktop/Memory/physical-address-extension">https://docs.microsoft.com/en-gb/windows/desktop/Memory/physical-address-extension</a>
and
<a href="https://docs.microsoft.com/en-gb/windows/desktop/Memory/4-gigabyte-tuning">https://docs.microsoft.com/en-gb/windows/desktop/Memory/4-gigabyte-tuning</a>.
Under most 64-bit versions of Windows the limit for a 32-bit build
of <span class="rlang"><b>R</b></span> is 4<abbr>Gb</abbr>: for the oldest ones it is 2<abbr>Gb</abbr>.  The limit for a 64-bit
build of <span class="rlang"><b>R</b></span> (imposed by the OS) is 8Tb.
</p>
<p>It is not normally possible to allocate as much as 2<abbr>Gb</abbr> to a single
vector in a 32-bit build of <span class="rlang"><b>R</b></span> even on 64-bit Windows because of
preallocations by Windows in the middle of the address space.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+object.size">object.size</a>(a)</code> for the (approximate) size of <span class="rlang"><b>R</b></span> object
<code>a</code>.
</p>

<hr>
<h2 id='memory.profile'>Profile the Usage of Cons Cells</h2><span id='topic+memory.profile'></span>

<h3>Description</h3>

<p>Lists the usage of the cons cells by <code>SEXPREC</code> type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memory.profile()
</code></pre>


<h3>Details</h3>

<p>The current types and their uses are listed in the include file
&lsquo;<span class="file">Rinternals.h</span>&rsquo;.
</p>


<h3>Value</h3>

<p>A vector of counts, named by the types.  See <code><a href="#topic+typeof">typeof</a></code> for
an explanation of types.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gc">gc</a></code> for the overall usage of cons cells.
<code><a href="utils.html#topic+Rprofmem">Rprofmem</a></code> and <code><a href="#topic+tracemem">tracemem</a></code> allow memory profiling
of specific code or objects, but need to be enabled at compile time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
memory.profile()
</code></pre>

<hr>
<h2 id='merge'>Merge Two Data Frames</h2><span id='topic+merge'></span><span id='topic+merge.default'></span><span id='topic+merge.data.frame'></span>

<h3>Description</h3>

<p>Merge two data frames by common columns or row names, or do other
versions of database <em>join</em> operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge(x, y, ...)

## Default S3 method:
merge(x, y, ...)

## S3 method for class 'data.frame'
merge(x, y, by = intersect(names(x), names(y)),
      by.x = by, by.y = by, all = FALSE, all.x = all, all.y = all,
      sort = TRUE, suffixes = c(".x",".y"), no.dups = TRUE,
      incomparables = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_+3A_x">x</code>, <code id="merge_+3A_y">y</code></td>
<td>
<p>data frames, or objects to be coerced to one.</p>
</td></tr>
<tr><td><code id="merge_+3A_by">by</code>, <code id="merge_+3A_by.x">by.x</code>, <code id="merge_+3A_by.y">by.y</code></td>
<td>
<p>specifications of the columns used for merging.
See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="merge_+3A_all">all</code></td>
<td>
<p>logical; <code>all = L</code> is shorthand for <code>all.x = L</code> and
<code>all.y = L</code>, where <code>L</code> is either <code><a href="#topic+TRUE">TRUE</a></code> or
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="merge_+3A_all.x">all.x</code></td>
<td>
<p>logical; if <code>TRUE</code>, then extra rows will be added to
the output, one for each row in <code>x</code> that has no matching row in
<code>y</code>.  These rows will have <code>NA</code>s in those columns that are
usually filled with values from <code>y</code>.  The default is
<code>FALSE</code>, so that only rows with data from both <code>x</code> and
<code>y</code> are included in the output.</p>
</td></tr>
<tr><td><code id="merge_+3A_all.y">all.y</code></td>
<td>
<p>logical; analogous to <code>all.x</code>.</p>
</td></tr>
<tr><td><code id="merge_+3A_sort">sort</code></td>
<td>
<p>logical.  Should the result be sorted on the <code>by</code>
columns?</p>
</td></tr>
<tr><td><code id="merge_+3A_suffixes">suffixes</code></td>
<td>
<p>a character vector of length 2 specifying the suffixes
to be used for making unique the names of columns in the result
which are not used for merging (appearing in <code>by</code> etc).</p>
</td></tr>
<tr><td><code id="merge_+3A_no.dups">no.dups</code></td>
<td>
<p>logical indicating that <code>suffixes</code> are appended in
more cases to avoid duplicated column names in the result.  This
was implicitly false before <span class="rlang"><b>R</b></span> version 3.5.0.</p>
</td></tr>
<tr><td><code id="merge_+3A_incomparables">incomparables</code></td>
<td>
<p>values which cannot be matched.  See
<code><a href="#topic+match">match</a></code>.  This is intended to be used for merging on one
column, so these are incomparable values of that column.</p>
</td></tr>
<tr><td><code id="merge_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>merge</code> is a generic function whose principal method is for data
frames: the default method coerces its arguments to data frames and
calls the <code>"data.frame"</code> method.
</p>
<p>By default the data frames are merged on the columns with names they
both have, but separate specifications of the columns can be given by
<code>by.x</code> and <code>by.y</code>.  The rows in the two data frames that
match on the specified columns are extracted, and joined together.  If
there is more than one match, all possible matches contribute one row
each.  For the precise meaning of &lsquo;match&rsquo;, see
<code><a href="#topic+match">match</a></code>.
</p>
<p>Columns to merge on can be specified by name, number or by a logical
vector: the name <code>"row.names"</code> or the number <code>0</code> specifies
the row names.  If specified by name it must correspond uniquely to a
named column in the input.
</p>
<p>If <code>by</code> or both <code>by.x</code> and <code>by.y</code> are of length 0 (a
length zero vector or <code>NULL</code>), the result, <code>r</code>, is the
<em>Cartesian product</em> of <code>x</code> and <code>y</code>, i.e.,
<code>dim(r) = c(nrow(x)*nrow(y), ncol(x) + ncol(y))</code>.
</p>
<p>If <code>all.x</code> is true, all the non matching cases of <code>x</code> are
appended to the result as well, with <code>NA</code> filled in the
corresponding columns of <code>y</code>;  analogously for <code>all.y</code>.
</p>
<p>If the columns in the data frames not used in merging have any common
names, these have <code>suffixes</code> (<code>".x"</code> and <code>".y"</code> by
default) appended to try to make the names of the result unique.  If
this is not possible, an error is thrown.
</p>
<p>If a <code>by.x</code> column name matches one of <code>y</code>, and if
<code>no.dups</code> is true (as by default), the y version gets suffixed as
well, avoiding duplicate column names in the result.
</p>
<p>The complexity of the algorithm used is proportional to the length of
the answer.
</p>

<p>In SQL database terminology, the default value of <code>all = FALSE</code>
gives a <em>natural join</em>, a special case of an <em>inner
join</em>. Specifying <code>all.x = TRUE</code> gives a <em>left (outer)
join</em>, <code>all.y = TRUE</code> a <em>right (outer) join</em>, and both
(<code>all = TRUE</code>) a <em>(full) outer join</em>.  <abbr>DBMS</abbr>es do not match
<code>NULL</code> records, equivalent to <code>incomparables = NA</code> in <span class="rlang"><b>R</b></span>.
</p>


<h3>Value</h3>

<p>A data frame.  The rows are by default lexicographically sorted on the
common columns, but for <code>sort = FALSE</code> are in an unspecified order.
The columns are the common columns followed by the
remaining columns in <code>x</code> and then those in <code>y</code>.  If the
matching involved row names, an extra character column called
<code>Row.names</code> is added at the left, and in all cases the result has
&lsquo;automatic&rsquo; row names.
</p>


<h3>Note</h3>

<p>This is intended to work with data frames with vector-like columns:
some aspects work with data frames containing matrices, but not all.
</p>
<p>Currently long vectors are not accepted for inputs, which are thus
restricted to less than 2^31 rows. That restriction also applies to
the result for 32-bit platforms.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>,
<code><a href="#topic+by">by</a></code>,
<code><a href="#topic+cbind">cbind</a></code>.
</p>
<p><code><a href="stats.html#topic+dendrogram">dendrogram</a></code> for a class which has a <code>merge</code> method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>authors &lt;- data.frame(
    ## I(*) : use character columns of names to get sensible sort order
    surname = I(c("Tukey", "Venables", "Tierney", "Ripley", "McNeil")),
    nationality = c("US", "Australia", "US", "UK", "Australia"),
    deceased = c("yes", rep("no", 4)))
authorN &lt;- within(authors, { name &lt;- surname; rm(surname) })
books &lt;- data.frame(
    name = I(c("Tukey", "Venables", "Tierney",
             "Ripley", "Ripley", "McNeil", "R Core")),
    title = c("Exploratory Data Analysis",
              "Modern Applied Statistics ...",
              "LISP-STAT",
              "Spatial Statistics", "Stochastic Simulation",
              "Interactive Data Analysis",
              "An Introduction to R"),
    other.author = c(NA, "Ripley", NA, NA, NA, NA,
                     "Venables &amp; Smith"))

(m0 &lt;- merge(authorN, books))
(m1 &lt;- merge(authors, books, by.x = "surname", by.y = "name"))
 m2 &lt;- merge(books, authors, by.x = "name", by.y = "surname")
stopifnot(exprs = {
   identical(m0, m2[, names(m0)])
   as.character(m1[, 1]) == as.character(m2[, 1])
   all.equal(m1[, -1], m2[, -1][ names(m1)[-1] ])
   identical(dim(merge(m1, m2, by = NULL)),
             c(nrow(m1)*nrow(m2), ncol(m1)+ncol(m2)))
})

## "R core" is missing from authors and appears only here :
merge(authors, books, by.x = "surname", by.y = "name", all = TRUE)


## example of using 'incomparables'
x &lt;- data.frame(k1 = c(NA,NA,3,4,5), k2 = c(1,NA,NA,4,5), data = 1:5)
y &lt;- data.frame(k1 = c(NA,2,NA,4,5), k2 = c(NA,NA,3,4,5), data = 1:5)
merge(x, y, by = c("k1","k2")) # NA's match
merge(x, y, by = "k1") # NA's match, so 6 rows
merge(x, y, by = "k2", incomparables = NA) # 2 rows
</code></pre>

<hr>
<h2 id='message'>Diagnostic Messages</h2><span id='topic+message'></span><span id='topic+suppressMessages'></span><span id='topic+packageStartupMessage'></span><span id='topic+suppressPackageStartupMessages'></span><span id='topic+.makeMessage'></span>

<h3>Description</h3>

<p>Generate a diagnostic message from its arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>message(..., domain = NULL, appendLF = TRUE)
suppressMessages(expr, classes = "message")

packageStartupMessage(..., domain = NULL, appendLF = TRUE)
suppressPackageStartupMessages(expr)

.makeMessage(..., domain = NULL, appendLF = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="message_+3A_...">...</code></td>
<td>
<p>zero or more objects which can be coerced to character
(and which are pasted together with no separator) or (for
<code>message</code> only) a single condition object.</p>
</td></tr>
<tr><td><code id="message_+3A_domain">domain</code></td>
<td>
<p>see <code><a href="#topic+gettext">gettext</a></code>.  If <code>NA</code>, messages will
not be translated, see also the note in <code><a href="#topic+stop">stop</a></code>.</p>
</td></tr>
<tr><td><code id="message_+3A_appendlf">appendLF</code></td>
<td>
<p>logical: should messages given as a character string
have a newline appended?</p>
</td></tr>
<tr><td><code id="message_+3A_expr">expr</code></td>
<td>
<p>expression to evaluate.</p>
</td></tr>
<tr><td><code id="message_+3A_classes">classes</code></td>
<td>
<p>character, indicating which classes of messages should
be suppressed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>message</code> is used for generating &lsquo;simple&rsquo; diagnostic
messages which are neither warnings nor errors, but nevertheless
represented as conditions.  Unlike warnings and errors, a final
newline is regarded as part of the message, and is optional.
The default handler sends the message to the
<code><a href="#topic+stderr">stderr</a>()</code> <a href="#topic+connection">connection</a>.
</p>
<p>If a condition object is supplied  to <code>message</code> it should be
the only argument, and further arguments will be ignored, with a warning.
</p>
<p>While the message is being processed, a <code>muffleMessage</code> restart
is available.
</p>
<p><code>suppressMessages</code> evaluates its expression in a context that
ignores all &lsquo;simple&rsquo; diagnostic messages.
</p>
<p><code>packageStartupMessage</code> is a variant whose messages can be
suppressed separately by <code>suppressPackageStartupMessages</code>.  (They
are still messages, so can be suppressed by <code>suppressMessages</code>.)
</p>
<p><code>.makeMessage</code> is a utility used by <code>message</code>, <code>warning</code>
and <code>stop</code> to generate a text message from the <code>...</code>
arguments by possible translation (see <code><a href="#topic+gettext">gettext</a></code>) and
concatenation (with no separator).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+warning">warning</a></code> and <code><a href="#topic+stop">stop</a></code> for generating warnings
and errors; <code><a href="#topic+conditions">conditions</a></code> for condition handling and
recovery.
</p>
<p><code><a href="#topic+gettext">gettext</a></code> for the mechanisms for the automated translation
of text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>message("ABC", "DEF")
suppressMessages(message("ABC"))

testit &lt;- function() {
  message("testing package startup messages")
  packageStartupMessage("initializing ...", appendLF = FALSE)
  Sys.sleep(1)
  packageStartupMessage(" done")
}

testit()
suppressPackageStartupMessages(testit())
suppressMessages(testit())
</code></pre>

<hr>
<h2 id='missing'>Does a Formal Argument have a Value?</h2><span id='topic+missing'></span>

<h3>Description</h3>

<p><code>missing</code> can be used to test whether a value was specified
as an argument to a function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>missing(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="missing_+3A_x">x</code></td>
<td>
<p>a formal argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>missing(x)</code> is only reliable if <code>x</code> has not been altered
since entering the function: in particular it will <em>always</em>
be false after <code>x &lt;- match.arg(x)</code>.
</p>
<p>The example shows how a plotting function can be written to work with
either a pair of vectors giving x and y coordinates of points to be
plotted or a single vector giving y values to be plotted against their
indices.
</p>
<p>Currently <code>missing</code> can only be used in the immediate body of
the function that defines the argument, not in the body of a nested
function or a <code>local</code> call.  This may change in the future.
</p>
<p>This is a &lsquo;special&rsquo; <a href="#topic+primitive">primitive</a> function: it must not
evaluate its argument.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+substitute">substitute</a></code> for argument expression;
<code><a href="#topic+NA">NA</a></code> for missing values in data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myplot &lt;- function(x, y) {
                if(missing(y)) {
                        y &lt;- x
                        x &lt;- 1:length(y)
                }
                plot(x, y)
        }
</code></pre>

<hr>
<h2 id='mode'>The (Storage) Mode of an Object</h2><span id='topic+mode'></span><span id='topic+mode+3C-'></span><span id='topic+storage.mode'></span><span id='topic+storage.mode+3C-'></span>

<h3>Description</h3>

<p>Get or set the &lsquo;mode&rsquo; (a kind of &lsquo;type&rsquo;), or the storage
mode of an <span class="rlang"><b>R</b></span> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mode(x)
mode(x) &lt;- value
storage.mode(x)
storage.mode(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mode_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="mode_+3A_value">value</code></td>
<td>
<p>a character string giving the desired mode or
&lsquo;storage mode&rsquo; (type) of the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code>mode</code> and <code>storage.mode</code> return a character string
giving the (storage) mode of the object &mdash; often the same &mdash; both
relying on the output of <code><a href="#topic+typeof">typeof</a>(x)</code>, see the example
below.
</p>
<p><code>mode(x) &lt;- "newmode"</code> changes the <code>mode</code> of object <code>x</code> to
<code>newmode</code>.  This is only supported if there is an appropriate
<code>as.newmode</code> function, for example
<code>"logical"</code>, <code>"integer"</code>, <code>"double"</code>, <code>"complex"</code>,
<code>"raw"</code>, <code>"character"</code>, <code>"list"</code>, <code>"expression"</code>,
<code>"name"</code>, <code>"symbol"</code> and <code>"function"</code>.  Attributes are
preserved (but see below).
</p>
<p><code>storage.mode(x) &lt;- "newmode"</code> is a more efficient <a href="#topic+primitive">primitive</a>
version of <code>mode&lt;-</code>, which works for <code>"newmode"</code> which is
one of the internal types (see <code><a href="#topic+typeof">typeof</a></code>), but not for
<code>"single"</code>.  Attributes are preserved.
</p>
<p>As storage mode <code>"single"</code> is only a pseudo-mode in <span class="rlang"><b>R</b></span>, it will
not be reported by <code>mode</code> or <code>storage.mode</code>: use
<code>attr(object, "Csingle")</code> to examine this.  However,
<code>mode&lt;-</code> can be used to set the mode to <code>"single"</code>,
which sets the real mode to <code>"double"</code> and the <code>"Csingle"</code>
attribute to <code>TRUE</code>.  Setting any other mode will remove this
attribute.
</p>
<p>Note (in the examples below) that some <code><a href="#topic+call">call</a></code>s have mode
<code>"("</code> which is S compatible.
</p>


<h3>Mode names</h3>

<p>Modes have the same set of names as types (see <code><a href="#topic+typeof">typeof</a></code>)
except that
</p>

<ul>
<li><p> types <code>"integer"</code> and <code>"double"</code> are
returned as <code>"numeric"</code>.
</p>
</li>
<li><p> types <code>"special"</code>, <code>"builtin"</code> and <code>"closure"</code> are returned as
<code>"function"</code>.
</p>
</li>
<li><p> type <code>"symbol"</code> is called mode <code>"name"</code>.
</p>
</li>
<li><p> type <code>"language"</code> is returned as <code>"("</code> or <code>"call"</code>.
</p>
</li></ul>



<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+typeof">typeof</a></code> for the R-internal &lsquo;mode&rsquo; or &lsquo;type&rsquo;,
<code><a href="utils.html#topic+type.convert">type.convert</a></code>, <code><a href="#topic+attributes">attributes</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

sapply(options(), mode)

cex3 &lt;- c("NULL", "1", "1:1", "1i", "list(1)", "data.frame(x = 1)",
  "pairlist(pi)", "c", "lm", "formals(lm)[[1]]",  "formals(lm)[[2]]",
  "y ~ x","expression((1))[[1]]", "(y ~ x)[[1]]",
  "expression(x &lt;- pi)[[1]][[1]]")
lex3 &lt;- sapply(cex3, function(x) eval(str2lang(x)))
mex3 &lt;- t(sapply(lex3,
                 function(x) c(typeof(x), storage.mode(x), mode(x))))
dimnames(mex3) &lt;- list(cex3, c("typeof(.)","storage.mode(.)","mode(.)"))
mex3

## This also makes a local copy of 'pi':
storage.mode(pi) &lt;- "complex"
storage.mode(pi)
rm(pi)
</code></pre>

<hr>
<h2 id='mtfrm'>Auxiliary Function for Matching</h2><span id='topic+mtfrm'></span><span id='topic+mtfrm.default'></span><span id='topic+mtfrm.POSIXct'></span><span id='topic+mtfrm.POSIXlt'></span>

<h3>Description</h3>

<p>Transform objects for matching via <code><a href="#topic+match">match</a>()</code>, think
&ldquo;match form&rdquo; <code>-&gt; "mtfrm"</code>.
<span class="pkg">base</span> provides the S3 generic and a <code>default</code> plus
<code>"<a href="#topic+POSIXct">POSIXct</a>"</code> and <code>"POSIXlt"</code> methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtfrm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtfrm_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Matching via <code><a href="#topic+match">match</a></code> will use <code>mtfrm</code> to transform
internally classed objects (see <code><a href="#topic+is.object">is.object</a></code>) to a vector
representation appropriate for matching.  The default method performs
<code><a href="#topic+as.character">as.character</a></code> if this preserves the length.
</p>
<p>Ideally, methods for <code>mtfrm</code> should ensure that comparisons of
same-classed objects via <code><a href="#topic+match">match</a></code> are consistent with those
employed by methods for <code><a href="#topic+duplicated">duplicated</a></code>/<code><a href="#topic+unique">unique</a></code>
and <code><a href="#topic++3D+3D">==</a></code>/<code><a href="#topic++21+3D">!=</a></code> (where applicable).
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code>.
</p>

<hr>
<h2 id='NA'>&lsquo;Not Available&rsquo; / Missing Values</h2><span id='topic+NA'></span><span id='topic+NA_integer_'></span><span id='topic+NA_real_'></span><span id='topic+NA_complex_'></span><span id='topic+NA_character_'></span><span id='topic+is.na'></span><span id='topic+is.na.data.frame'></span><span id='topic+is.na+3C-'></span><span id='topic+is.na+3C-.default'></span><span id='topic+anyNA'></span><span id='topic+anyNA.data.frame'></span><span id='topic+anyMissing'></span>

<h3>Description</h3>

<p><code>NA</code> is a logical constant of length 1 which contains a missing
value indicator.  <code>NA</code> can be coerced to any other vector
type except raw.  There are also constants <code>NA_integer_</code>,
<code>NA_real_</code>, <code>NA_complex_</code> and <code>NA_character_</code> of the
other atomic vector types which support missing values: all of these
are <a href="#topic+reserved">reserved</a> words in the <span class="rlang"><b>R</b></span> language.
</p>
<p>The generic function <code>is.na</code> indicates which elements are missing.
</p>
<p>The generic function <code>is.na&lt;-</code> sets elements to <code>NA</code>.
</p>
<p>The generic function <code>anyNA</code> implements <code>any(is.na(x))</code> in a
possibly faster way (especially for atomic vectors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NA
is.na(x)
anyNA(x, recursive = FALSE)

## S3 method for class 'data.frame'
is.na(x)

is.na(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NA_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object to be tested: the default method for
<code>is.na</code> and <code>anyNA</code> handle atomic vectors, lists,
pairlists, and <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="NA_+3A_recursive">recursive</code></td>
<td>
<p>logical: should <code>anyNA</code> be applied recursively
to lists and pairlists?</p>
</td></tr>
<tr><td><code id="NA_+3A_value">value</code></td>
<td>
<p>a suitable index vector for use with <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>NA</code> of character type is distinct from the string
<code>"NA"</code>.  Programmers who need to specify an explicit missing
string should use <code>NA_character_</code> (rather than <code>"NA"</code>) or set
elements to <code>NA</code> using <code>is.na&lt;-</code>.
</p>
<p><code>is.na</code> and <code>anyNA</code> are generic: you can write
methods to handle specific classes of objects, see
<a href="#topic+InternalMethods">InternalMethods</a>.
</p>
<p>Function <code>is.na&lt;-</code> may provide a safer way to set missingness.
It behaves differently for factors, for example.
</p>
<p>Numerical computations using <code>NA</code> will normally result in
<code>NA</code>: a possible exception is where <code><a href="#topic+NaN">NaN</a></code> is also
involved, in which case either might result (which may depend on
the <span class="rlang"><b>R</b></span> platform).  However, this is not guaranteed and future CPUs
and/or compilers may behave differently. Dynamic binary translation may
also impact this behavior (with valgrind, computations using <code>NA</code>
may result in <code>NaN</code> even when no <code>NaN</code> is involved).
</p>
<p>Logical computations treat <code>NA</code> as a missing <code>TRUE/FALSE</code>
value, and so may return <code>TRUE</code> or <code>FALSE</code> if the expression
does not depend on the <code>NA</code> operand.
</p>
<p>The default method for <code>anyNA</code> handles atomic vectors without a
class and <code>NULL</code>.  It calls <code>any(is.na(x))</code> on objects with
classes and for <code>recursive = FALSE</code>, on lists and pairlists.
</p>


<h3>Value</h3>

<p>The default method for <code>is.na</code> applied to an atomic vector
returns a logical vector of the same length as its argument <code>x</code>,
containing <code>TRUE</code> for those elements marked <code>NA</code> or, for
numeric or complex vectors, <code><a href="#topic+NaN">NaN</a></code>, and <code>FALSE</code>
otherwise. (A complex value is regarded as <code>NA</code> if either its
real or imaginary part is <code>NA</code> or <code><a href="#topic+NaN">NaN</a></code>.)
<code>dim</code>, <code>dimnames</code> and <code>names</code> attributes are copied to
the result.
</p>
<p>The default methods also work for lists and pairlists:<br />
For <code>is.na</code>, elementwise the result is false unless that element
is a length-one atomic vector and the single element of that vector is
regarded as <code>NA</code> or <code>NaN</code> (note that any <code>is.na</code>
method for the class of the element is ignored).<br />
<code>anyNA(recursive = FALSE)</code> works the same way as <code>is.na</code>;
<code>anyNA(recursive = TRUE)</code> applies <code>anyNA</code> (with method
dispatch) to each element.
</p>
<p>The data frame method for <code>is.na</code> returns a logical matrix
with the same dimensions as the data frame, and with dimnames taken
from the row and column names of the data frame.
</p>
<p><code>anyNA(NULL)</code> is false; <code>is.na(NULL)</code> is <code>logical(0)</code>
(no longer warning since <span class="rlang"><b>R</b></span> version 3.5.0).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NaN">NaN</a></code>, <code><a href="#topic+is.nan">is.nan</a></code>, etc.,
and the utility function <code><a href="stats.html#topic+complete.cases">complete.cases</a></code>.
</p>
<p><code><a href="stats.html#topic+na.action">na.action</a></code>, <code><a href="stats.html#topic+na.omit">na.omit</a></code>, <code><a href="stats.html#topic+na.fail">na.fail</a></code>
on how methods can be tuned to deal with missing values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.na(c(1, NA))        #&gt; FALSE  TRUE
is.na(paste(c(1, NA))) #&gt; FALSE FALSE

(xx &lt;- c(0:4))
is.na(xx) &lt;- c(2, 4)
xx                     #&gt; 0 NA  2 NA  4
anyNA(xx) # TRUE

# Some logical operations do not return NA
c(TRUE, FALSE) &amp; NA
c(TRUE, FALSE) | NA


## Measure speed difference in a favourable case:
## the difference depends on the platform, on most ca 3x.
x &lt;- 1:10000; x[5000] &lt;- NaN  # coerces x to be double
if(require("microbenchmark")) { # does not work reliably on all platforms
  print(microbenchmark(any(is.na(x)), anyNA(x)))
} else {
  nSim &lt;- 2^13
  print(rbind(is.na = system.time(replicate(nSim, any(is.na(x)))),
              anyNA = system.time(replicate(nSim, anyNA(x)))))
}


## anyNA() can work recursively with list()s:
LL &lt;- list(1:5, c(NA, 5:8), c("A","NA"), c("a", NA_character_))
L2 &lt;- LL[c(1,3)]
sapply(LL, anyNA); c(anyNA(LL), anyNA(LL, TRUE))
sapply(L2, anyNA); c(anyNA(L2), anyNA(L2, TRUE))

## ... lists, and hence data frames, too:
dN &lt;- dd &lt;- USJudgeRatings; dN[3,6] &lt;- NA
anyNA(dd) # FALSE
anyNA(dN) # TRUE
</code></pre>

<hr>
<h2 id='name'>Names and Symbols</h2><span id='topic+name'></span><span id='topic+symbol'></span><span id='topic+is.symbol'></span><span id='topic+as.symbol'></span><span id='topic+as.name'></span><span id='topic+is.name'></span>

<h3>Description</h3>

<p>A &lsquo;name&rsquo; (also known as a &lsquo;symbol&rsquo;) is a way to refer to
<span class="rlang"><b>R</b></span> objects by name (rather than the value of the object, if any, bound
to that name).
</p>
<p><code>as.name</code> and <code>as.symbol</code> are identical: they attempt to
coerce the argument to a name.
</p>
<p><code>is.symbol</code> and the identical <code>is.name</code> return <code>TRUE</code>
or <code>FALSE</code> depending on whether the argument is a name or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.symbol(x)
is.symbol(x)

as.name(x)
is.name(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="name_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Names are limited to 10,000 bytes (and were to 256 bytes in versions
of <span class="rlang"><b>R</b></span> before 2.13.0).
</p>
<p><code>as.name</code> first coerces its argument internally to a character
vector (so methods for <code>as.character</code> are not used).  It then
takes the first element and provided it is not <code>""</code>, returns a
symbol of that name (and if the element is <code>NA_character_</code>, the
name is <code>`NA`</code>).
</p>
<p><code>as.name</code> is implemented as <code><a href="#topic+as.vector">as.vector</a>(x, "symbol")</code>,
and hence will dispatch methods for the generic function <code>as.vector</code>.
</p>
<p><code>is.name</code> and <code>is.symbol</code> are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p>For <code>as.name</code> and <code>as.symbol</code>, an <span class="rlang"><b>R</b></span> object of type
<code>"symbol"</code> (see <code><a href="#topic+typeof">typeof</a></code>).
</p>
<p>For <code>is.name</code> and <code>is.symbol</code>, a length-one logical vector
with value <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Note</h3>

<p>The term &lsquo;symbol&rsquo; is from the LISP background of <span class="rlang"><b>R</b></span>, whereas
&lsquo;name&rsquo; has been the standard S term for this.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+call">call</a></code>, <code><a href="#topic+is.language">is.language</a></code>.
For the internal object mode, <code><a href="#topic+typeof">typeof</a></code>.
</p>
<p><code><a href="grDevices.html#topic+plotmath">plotmath</a></code> for another use of &lsquo;symbol&rsquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>an &lt;- as.name("arrg")
is.name(an) # TRUE
mode(an)   # name
typeof(an) # symbol
</code></pre>

<hr>
<h2 id='names'>The Names of an Object</h2><span id='topic+names'></span><span id='topic+names.default'></span><span id='topic+names+3C-'></span><span id='topic+names+3C-.default'></span>

<h3>Description</h3>

<p>Functions to get or set the names of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>names(x)
names(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="names_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="names_+3A_value">value</code></td>
<td>
<p>a character vector of up to the same length as <code>x</code>, or
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>names</code> is a generic accessor function, and <code>names&lt;-</code> is a
generic replacement function.  The default methods get and set
the <code>"names"</code> attribute of a vector (including a list) or
pairlist.
</p>
<p>For an <code><a href="#topic+environment">environment</a></code> <code>env</code>, <code>names(env)</code> gives
the names of the corresponding list, i.e.,
<code>names(as.list(env, all.names = TRUE))</code> which are also given by
<code><a href="#topic+ls">ls</a>(env, all.names = TRUE, sorted = FALSE)</code>.  If the
environment is used as a hash table, <code>names(env)</code> are its
&ldquo;keys&rdquo;.
</p>
<p>If <code>value</code> is shorter than <code>x</code>, it is extended by character
<code>NA</code>s to the length of <code>x</code>.
</p>
<p>It is possible to update just part of the names attribute via the
general rules: see the examples.  This works because the expression
there is evaluated as <code>z &lt;- "names&lt;-"(z, "[&lt;-"(names(z), 3, "c2"))</code>.
</p>
<p>The name <code>""</code> is special: it is used to indicate that there is no
name associated with an element of a (atomic or generic) vector.
Subscripting by <code>""</code> will match nothing (not even elements which
have no name).
</p>
<p>A name can be character <code>NA</code>, but such a name will never be
matched and is likely to lead to confusion.
</p>
<p>Both are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p>For <code>names</code>, <code>NULL</code> or a character vector of the same length
as <code>x</code>.  (<code>NULL</code> is given if the object has no names,
including for objects of types which cannot have names.)  For an
environment, the length is the number of objects in the environment
but the order of the names is arbitrary.
</p>
<p>For <code>names&lt;-</code>, the updated object.  (Note that the value of
<code>names(x) &lt;- value</code> is that of the assignment, <code>value</code>, not
the return value from the left-hand side.)
</p>


<h3>Note</h3>

<p>For vectors, the names are one of the <a href="#topic+attributes">attributes</a> with
restrictions on the possible values.  For pairlists, the names are the
tags and converted to and from a character vector.
</p>
<p>For a one-dimensional array the <code>names</code> attribute really is
<code><a href="#topic+dimnames">dimnames</a>[[1]]</code>.
</p>
<p>Formally classed aka &ldquo;S4&rdquo; objects typically have
<code><a href="methods.html#topic+slotNames">slotNames</a>()</code> (and no <code>names()</code>).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="methods.html#topic+slotNames">slotNames</a></code>, <code><a href="#topic+dimnames">dimnames</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># print the names attribute of the islands data set
names(islands)

# remove the names attribute
names(islands) &lt;- NULL
islands
rm(islands) # remove the copy made

z &lt;- list(a = 1, b = "c", c = 1:3)
names(z)
# change just the name of the third element.
names(z)[3] &lt;- "c2"
z

z &lt;- 1:3
names(z)
## assign just one name
names(z)[2] &lt;- "b"
z


</code></pre>

<hr>
<h2 id='nargs'>The Number of Arguments to a Function</h2><span id='topic+nargs'></span>

<h3>Description</h3>

<p>When used inside a function body, <code>nargs</code> returns the number of
arguments supplied to that function, <em>including</em> positional
arguments left blank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nargs()</code></pre>


<h3>Details</h3>

<p>The count includes empty (missing) arguments, so that <code>foo(x,,z)</code>
will be considered to have three arguments (see &lsquo;Examples&rsquo;).
This can occur in rather indirect ways, so for example <code>x[]</code>
might dispatch a call to <code>`[.some_method`(x, )</code> which is
considered to have two arguments.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+args">args</a></code>, <code><a href="#topic+formals">formals</a></code> and <code><a href="#topic+sys.call">sys.call</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tst &lt;- function(a, b = 3, ...) {nargs()}
tst() # 0
tst(clicketyclack) # 1 (even non-existing)
tst(c1, a2, rr3) # 3

foo &lt;- function(x, y, z, w) {
   cat("call was ", deparse(match.call()), "\n", sep = "")
   nargs()
}
foo()      # 0
foo(, , 3) # 3
foo(z = 3) # 1, even though this is the same call

nargs()  # not really meaningful
</code></pre>

<hr>
<h2 id='nchar'>Count the Number of Characters (or Bytes or Width)</h2><span id='topic+nchar'></span><span id='topic+nzchar'></span>

<h3>Description</h3>

<p><code>nchar</code> takes a character vector as an argument and
returns a vector whose elements contain the sizes of
the corresponding elements of <code>x</code>. Internally, it is a generic,
for which methods can be defined (see <a href="#topic+InternalMethods">InternalMethods</a>).
</p>
<p><code>nzchar</code> is a fast way to find out if elements of a character
vector are non-empty strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nchar(x, type = "chars", allowNA = FALSE, keepNA = NA)

nzchar(x, keepNA = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nchar_+3A_x">x</code></td>
<td>
<p>character vector, or a vector to be coerced to a character
vector.  Giving a factor is an error.</p>
</td></tr>
<tr><td><code id="nchar_+3A_type">type</code></td>
<td>
<p>character string: partial matching to one of
<code>c("bytes", "chars", "width")</code>.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="nchar_+3A_allowna">allowNA</code></td>
<td>
<p>logical: should <code>NA</code> be returned for invalid
multibyte strings or <code>"bytes"</code>-encoded strings (rather than
throwing an error)?</p>
</td></tr>
<tr><td><code id="nchar_+3A_keepna">keepNA</code></td>
<td>
<p>logical: should <code>NA</code> be returned when
<code>x</code> is <code><a href="#topic+NA">NA</a></code>?  If false, <code>nchar()</code> returns
<code>2</code>, as that is the number of printing characters used when
strings are written to output, and <code>nzchar()</code> is <code>TRUE</code>.  The
default for <code>nchar()</code>, <code>NA</code>, means to use <code>keepNA = TRUE</code>
unless <code>type</code> is <code>"width"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &lsquo;size&rsquo; of a character string can be measured in one of
three ways (corresponding to the <code>type</code> argument):
</p>

<dl>
<dt><code>bytes</code></dt><dd><p>The number of bytes needed to store the string
(plus in C a final terminator which is not counted).</p>
</dd>
<dt><code>chars</code></dt><dd><p>The number of characters.</p>
</dd>
<dt><code>width</code></dt><dd><p>The number of columns <code><a href="#topic+cat">cat</a></code> will use to
print the string in a monospaced font.  The same as <code>chars</code>
if this cannot be calculated.</p>
</dd>
</dl>

<p>These will often be the same, and usually will be in single-byte
locales (but note how <code>type</code> determines the default for
<code>keepNA</code>).  There will be differences between the first two with
multibyte character sequences, e.g. in UTF-8 locales.
</p>
<p>The internal equivalent of the default method of
<code><a href="#topic+as.character">as.character</a></code> is performed on <code>x</code> (so there is no
method dispatch).  If you want to operate on non-vector objects
passing them through <code><a href="#topic+deparse">deparse</a></code> first will be required.
</p>


<h3>Value</h3>

<p>For <code>nchar</code>, an integer vector giving the sizes of each element.
For missing values (i.e., <code>NA</code>, i.e., <code><a href="#topic+NA_character_">NA_character_</a></code>),
<code>nchar()</code> returns <code><a href="#topic+NA_integer_">NA_integer_</a></code> if <code>keepNA</code> is
true, and <code>2</code>, the number of printing characters, if false.
</p>
<p><code>type = "width"</code> gives (an approximation to) the number of
columns used in printing each element in a terminal font, taking into
account double-width, zero-width and &lsquo;composing&rsquo; characters.
The approximation is likely to be poor when there are unassigned or
non-printing characters.
</p>
<p>If <code>allowNA = TRUE</code> and an element is detected as invalid in a
multi-byte character set such as UTF-8, its number of characters and
the width will be <code>NA</code>.  Otherwise the number of characters will
be non-negative, so <code>!is.na(nchar(x, "chars", TRUE))</code> is a test
of validity.
</p>
<p>A character string marked with <code>"bytes"</code> encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>) has a number of bytes, but neither a known
number of characters nor a width, so the latter two types are
<code>NA</code> if <code>allowNA = TRUE</code>, otherwise an error.
</p>
<p>Names, dims and dimnames are copied from the input.
</p>
<p>For <code>nzchar</code>, a logical vector of the same length as <code>x</code>,
true if and only if the element has non-zero size; if the element is
<code>NA</code>, <code>nzchar()</code> is true when <code>keepNA</code> is false (the
default) or <code>NA</code>, and <code>NA</code> otherwise.
</p>


<h3>Note</h3>

<p>This does <strong>not</strong> by default give the number of characters that
will be used to <code>print()</code> the string.  Use
<code><a href="#topic+encodeString">encodeString</a></code> to find that.
Where character strings have been marked as UTF-8, the number of
characters and widths will be computed in UTF-8, even though printing
may use escapes such as &lsquo;<span class="samp">&#8288;&lt;U+2642&gt;&#8288;</span>&rsquo; in a non-UTF-8 locale.
</p>
<p>The concept of &lsquo;width&rsquo; is a slippery one even in a monospaced
font. Some human languages have the concept of <em>combining</em>
characters, in which two or more characters are rendered together: an
example would be <code>"y\u306"</code>, which is two characters of width
one: combining characters are given width zero, and there are other
zero-width characters such as the zero-width space <code>"\u200b"</code>.
</p>
<p>Some East Asian languages have &lsquo;wide&rsquo; characters, ideographs
which are conventionally printed across two columns when mixed with
ASCII and other &lsquo;narrow&rsquo; characters in those languages.  The
problem is that whether a computer prints wide characters over two or
one columns depends on the font, with it not being uncommon to use two
columns in a font intended for East Asian users and a single column in
a &lsquo;Western&rsquo; font.  Unicode has encodings for &lsquo;fullwidth&rsquo;
versions of ASCII characters and &lsquo;halfwidth&rsquo; versions of
Katakana (Japanese) and Hangul (Korean) characters.  Then there is the
&lsquo;East Asian Ambiguous class&rsquo; (Greek, Cyrillic, signs, some
accented Latin chars, etc), for which the historical practice was to
use two columns in East Asia and one elsewhere.  The width quoted by
<code>nchar</code> for characters in that class (and some others) depends on
the locale, being one except in some East Asian locales on some OSes
(notably Windows).
</p>
<p>Control characters are usually given width zero: this includes <abbr>CR</abbr> and
<abbr>LF</abbr>.  Computing the width of a string containing control characters
should be avoided (and may depend on the OS and <span class="rlang"><b>R</b></span> version).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Unicode Standard Annex #11: <em>East Asian Width.</em>
<a href="https://www.unicode.org/reports/tr11/">https://www.unicode.org/reports/tr11/</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+strwidth">strwidth</a></code> giving width of strings for plotting;
<code><a href="#topic+paste">paste</a></code>, <code><a href="#topic+substr">substr</a></code>, <code><a href="#topic+strsplit">strsplit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("asfef", "qwerty", "yuiop[", "b", "stuff.blah.yech")
nchar(x)
# 5  6  6  1 15

nchar(deparse(mean))
# 18 17  &lt;-- unless mean differs from base::mean

## NA behaviour as function of keepNA=* :
logi &lt;- setNames(, c(FALSE, NA, TRUE))
sapply(logi, \(k) data.frame(nchar =  nchar (NA, keepNA=k),
                             nzchar = nzchar(NA, keepNA=k)))

x[3] &lt;- NA; x
nchar(x, keepNA= TRUE) #  5  6 NA  1 15
nchar(x, keepNA=FALSE) #  5  6  2  1 15
stopifnot(identical(nchar(x     ), nchar(x, keepNA= TRUE)),
          identical(nchar(x, "w"), nchar(x, keepNA=FALSE)),
          identical(is.na(x), is.na(nchar(x))))

##' nchar() for all three types :
nchars &lt;- function(x, ...)
   vapply(c("chars", "bytes", "width"),
          function(tp) nchar(x, tp, ...), integer(length(x)))

nchars("\u200b") # in R versions (&gt;= 2015-09-xx):
## chars bytes width
##     1     3     0

data.frame(x, nchars(x)) ## all three types : same unless for NA
## force the same by forcing 'keepNA':
(ncT &lt;- nchars(x, keepNA = TRUE)) ## .... NA NA NA ....
(ncF &lt;- nchars(x, keepNA = FALSE))## ....  2  2  2 ....
stopifnot(apply(ncT, 1, function(.) length(unique(.))) == 1,
          apply(ncF, 1, function(.) length(unique(.))) == 1)
</code></pre>

<hr>
<h2 id='nlevels'>The Number of Levels of a Factor</h2><span id='topic+nlevels'></span>

<h3>Description</h3>

<p>Return the number of levels which its argument has.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlevels(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlevels_+3A_x">x</code></td>
<td>
<p>an object, usually a factor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is usually applied to a factor, but other objects can have levels.
</p>
<p>The actual factor levels (if they exist) can be obtained
with the <code><a href="#topic+levels">levels</a></code> function.
</p>


<h3>Value</h3>

<p>The length of <code><a href="#topic+levels">levels</a>(x)</code>, which is zero if
<code>x</code> has no levels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+levels">levels</a></code>, <code><a href="#topic+factor">factor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlevels(gl(3, 7)) # = 3
</code></pre>

<hr>
<h2 id='noquote'>Class for &lsquo;no quote&rsquo; Printing of Character Strings</h2><span id='topic+noquote'></span><span id='topic+print.noquote'></span><span id='topic+as.matrix.noquote'></span><span id='topic+c.noquote'></span><span id='topic++5B.noquote'></span>

<h3>Description</h3>

<p>Print character strings without quotes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noquote(obj, right = FALSE)

## S3 method for class 'noquote'
print(x, quote = FALSE, right = FALSE, ...)

## S3 method for class 'noquote'
c(..., recursive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noquote_+3A_obj">obj</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object, typically a vector of
<code><a href="#topic+character">character</a></code> strings.</p>
</td></tr>
<tr><td><code id="noquote_+3A_right">right</code></td>
<td>
<p>optional <code><a href="#topic+logical">logical</a></code> eventually to be passed to
<code>print()</code>, used by <code><a href="#topic+print.default">print.default</a>()</code>, indicating
whether or not strings should be right aligned.</p>
</td></tr>
<tr><td><code id="noquote_+3A_x">x</code></td>
<td>
<p>an object of class <code>"noquote"</code>.</p>
</td></tr>
<tr><td><code id="noquote_+3A_quote">quote</code>, <code id="noquote_+3A_...">...</code></td>
<td>
<p>further options passed to next methods, such as <code><a href="#topic+print">print</a></code>.</p>
</td></tr>
<tr><td><code id="noquote_+3A_recursive">recursive</code></td>
<td>
<p>for compatibility with the generic <code><a href="#topic+c">c</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>noquote</code> returns its argument as an object of class
<code>"noquote"</code>.  There is a method for <code>c()</code> and subscript
method (<code>"[.noquote"</code>) which ensures that the class is not lost
by subsetting.  The print method (<code>print.noquote</code>) prints
character strings <em>without</em> quotes (<code>"...."</code> is printed as <code style="white-space: pre;">&#8288;....&#8288;</code>).
</p>
<p>If <code>right</code> is specified in a call <code>print(x, right=*)</code>, it
takes precedence over a possible <code>right</code> setting of <code>x</code>,
e.g., created by <code>x &lt;- noquote(*, right=TRUE)</code>.
</p>
<p>These functions exist both as utilities and as an example of using (S3)
<code><a href="#topic+class">class</a></code> and object orientation.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler <a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a></p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+methods">methods</a></code>, <code><a href="#topic+class">class</a></code>, <code><a href="#topic+print">print</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>letters
nql &lt;- noquote(letters)
nql
nql[1:4] &lt;- "oh"
nql[1:12]

cmp.logical &lt;- function(log.v)
{
  ## Purpose: compact printing of logicals
  log.v &lt;- as.logical(log.v)
  noquote(if(length(log.v) == 0)"()" else c(".","|")[1 + log.v])
}
cmp.logical(stats::runif(20) &gt; 0.8)

chmat &lt;- as.matrix(format(stackloss)) # a "typical" character matrix
## noquote(*, right=TRUE)  so it prints exactly like a data frame
chmat &lt;- noquote(chmat, right = TRUE)
chmat

</code></pre>

<hr>
<h2 id='norm'>Compute the Norm of a Matrix</h2><span id='topic+norm'></span>

<h3>Description</h3>

<p>Computes a matrix norm of <code>x</code> using LAPACK.  The norm can be
the one (<code>"O"</code>) norm, the infinity (<code>"I"</code>) norm, the
Frobenius (<code>"F"</code>) norm, the maximum modulus (<code>"M"</code>) among
elements of a matrix, or the &ldquo;spectral&rdquo; or <code>"2"</code>-norm, as
determined by the value of <code>type</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>norm(x, type = c("O", "I", "F", "M", "2"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="norm_+3A_x">x</code></td>
<td>
<p>numeric matrix; note that packages such as <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a>
define more <code>norm()</code> methods.</p>
</td></tr>
<tr><td><code id="norm_+3A_type">type</code></td>
<td>
<p>character string, specifying the <em>type</em> of matrix
norm to be computed.
A character indicating the type of norm desired.
</p>

<dl>
<dt><code>"O"</code>, <code>"o"</code> or <code>"1"</code></dt><dd><p>specifies the <b>o</b>ne norm,
(maximum absolute column sum);</p>
</dd>
<dt><code>"I"</code> or <code>"i"</code></dt><dd><p>specifies the <b>i</b>nfinity norm (maximum
absolute row sum);</p>
</dd>
<dt><code>"F"</code>, <code>"f"</code>, <code>"E"</code> or <code>"e"</code></dt><dd><p>specifies the
<b>F</b>robenius norm (the <b>E</b>uclidean norm of <code>x</code>
treated as if it were a vector);</p>
</dd>
<dt><code>"M"</code> or <code>"m"</code></dt><dd><p>specifies the <b>m</b>aximum modulus of
all the elements in <code>x</code>; and</p>
</dd>
<dt><code>"2"</code></dt><dd><p>specifies the &ldquo;spectral&rdquo; or 2-norm, which
is the largest singular value (<code><a href="#topic+svd">svd</a></code>) of <code>x</code>.</p>
</dd>
</dl>

<p>The default is <code>"O"</code>.  Only the first character of
<code>type[1]</code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="pkg">base</span> method of <code>norm()</code> calls the LAPACK function
<code>dlange</code>.
</p>
<p>Note that the 1-, Inf- and <code>"M"</code> norm is faster to calculate than
the Frobenius one.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>


<h3>Value</h3>

<p>The matrix norm, a non-negative number.  Zero for a 0-extent (empty) matrix.
</p>


<h3>Source</h3>

<p>Except for <code>norm = "2"</code>, the LAPACK routine <code>DLANGE</code>.
</p>
<p>LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a>.
</p>


<h3>References</h3>

<p>Anderson, E., <em>et al</em> (1994).
<em>LAPACK User's Guide</em>,
2nd edition, SIAM, Philadelphia.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rcond">rcond</a></code> for the (reciprocal) condition number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x1 &lt;- cbind(1, 1:10))
norm(x1)
norm(x1, "I")
norm(x1, "M")
stopifnot(all.equal(norm(x1, "F"),
                    sqrt(sum(x1^2))))

hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, `+`) }
h9 &lt;- hilbert(9)
## all 5 (4 different) types of norm:
(nTyp &lt;- eval(formals(base::norm)$type))
sapply(nTyp, norm, x = h9)
stopifnot(exprs = { # 0-extent matrices:
    sapply(nTyp, norm, x = matrix(, 1,0)) == 0
    sapply(nTyp, norm, x = matrix(, 0,0)) == 0
})
</code></pre>

<hr>
<h2 id='normalizePath'>Express File Paths in Canonical Form</h2><span id='topic+normalizePath'></span>

<h3>Description</h3>

<p>Convert file paths to canonical form for the platform, to display them
in a user-understandable form and so that relative and absolute paths can
be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizePath(path, winslash = "\\", mustWork = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalizePath_+3A_path">path</code></td>
<td>
<p>character vector of file paths.</p>
</td></tr>
<tr><td><code id="normalizePath_+3A_winslash">winslash</code></td>
<td>
<p>the separator to be used on Windows &ndash; ignored
elsewhere.  Must be one of <code>c("/", "\\")</code>.</p>
</td></tr>
<tr><td><code id="normalizePath_+3A_mustwork">mustWork</code></td>
<td>
<p>logical: if <code>TRUE</code> then an error is given if the result
cannot be determined; if <code>NA</code> then a warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tilde-expansion (see <code><a href="#topic+path.expand">path.expand</a></code>) is first done on
<code>paths</code>.
</p>
<p>Where the Unix-alike platform supports it attempts to turn paths into
absolute paths in their canonical form (no &lsquo;<span class="samp">&#8288;./&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;../&#8288;</span>&rsquo; nor
symbolic links).  It relies on the POSIX system function
<code>realpath</code>: if the platform does not have that (we know of no
current example) then the result will be an absolute path but might
not be canonical.  Even where <code>realpath</code> is used the canonical
path need not be unique, for example <em>via</em> hard links or
multiple mounts.
</p>
<p>On Windows it converts relative paths to absolute paths, resolves symbolic
links, converts short names for path elements to long names and ensures the
separator is that specified by <code>winslash</code>.  It will match each path
element case-insensitively or case-sensitively as during the usual name
lookup and return the canonical case. It relies on Windows API function
<code>GetFinalPathNameByHandle</code> and in case of an error (such as
insufficient permissions) it currently falls back to the <span class="rlang"><b>R</b></span> 3.6 (and
older) implementation, which relies on <code>GetFullPathName</code> and
<code>GetLongPathName</code> with limitations described in the Notes section.
An attempt is made not to introduce <abbr>UNC</abbr> paths in presence of mapped drives
or symbolic links: if <code>GetFinalPathNameByHandle</code> returns a <abbr>UNC</abbr> path,
but <code>GetLongPathName</code> returns a path starting with a drive letter, R
falls back to the <span class="rlang"><b>R</b></span> 3.6 (and older) implementation.
UTF-8-encoded paths not valid in the current locale can be used.
</p>
<p><code>mustWork = FALSE</code> is useful for expressing paths for use in
messages.
</p>


<h3>Value</h3>

<p>A character vector.
</p>
<p>If an input is not a real path the result is system-dependent (unless
<code>mustWork = TRUE</code>, when this should be an error).  It will be
either the corresponding input element or a transformation of it into
an absolute path.
</p>
<p>Converting to an absolute file path can fail for a large number of
reasons.  The most common are
</p>

<ul>
<li><p> One of more components of the file path does not exist.
</p>
</li>
<li><p> A component before the last is not a directory, or there is
insufficient permission to read the directory.
</p>
</li>
<li><p> For a relative path, the current directory cannot be
determined.
</p>
</li>
<li><p> A symbolic link points to a non-existent place or links form a
loop.
</p>
</li>
<li><p> The canonicalized path would be exceed the maximum supported
length of a file path.
</p>
</li></ul>



<h3>Note</h3>

<p>The canonical form of paths may not be what you expect.  For example,
on macOS absolute paths such as &lsquo;<span class="file">/tmp</span>&rsquo; and &lsquo;<span class="file">/var</span>&rsquo; are
symbolic links. On Linux, a path produced by bash process substitution is
a symbolic link (such as &lsquo;<span class="file">/proc/fd/63</span>&rsquo;) to a pipe and there is no
canonical form of such path. In <span class="rlang"><b>R</b></span> 3.6 and older on Windows, symlinks will
not be resolved and the long names for path elements will be returned with
the case in which they are in <code>path</code>, which may not be canonical in
case-insensitive folders.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cat(normalizePath(c(R.home(), tempdir())), sep = "\n")
</code></pre>

<hr>
<h2 id='NotYet'>Not Yet Implemented Functions and Unused Arguments</h2><span id='topic+NotYetImplemented'></span><span id='topic+.NotYetImplemented'></span><span id='topic+NotYetUsed'></span><span id='topic+.NotYetUsed'></span>

<h3>Description</h3>

<p>In order to pinpoint missing functionality, the <span class="rlang"><b>R</b></span> core team uses
these functions for missing <span class="rlang"><b>R</b></span> functions and not yet used arguments of
existing <span class="rlang"><b>R</b></span> functions (which are typically there for compatibility
purposes).
</p>
<p>You are very welcome to contribute your code ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.NotYetImplemented()
.NotYetUsed(arg, error = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NotYet_+3A_arg">arg</code></td>
<td>
<p>an argument of a function that is not yet used.</p>
</td></tr>
<tr><td><code id="NotYet_+3A_error">error</code></td>
<td>
<p>a logical.  If <code>TRUE</code>, an error is signalled; if
<code>FALSE</code>; only a warning is given.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>the contrary, <code><a href="#topic+Deprecated">Deprecated</a></code> and
<code><a href="#topic+Defunct">Defunct</a></code> for outdated code.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)
barplot(1:5, inside = TRUE) # 'inside' is not yet used
</code></pre>

<hr>
<h2 id='nrow'>The Number of Rows/Columns of an Array</h2><span id='topic+nrow'></span><span id='topic+NROW'></span><span id='topic+ncol'></span><span id='topic+NCOL'></span>

<h3>Description</h3>

<p><code>nrow</code> and <code>ncol</code> return the number of rows or columns
present in <code>x</code>.
<code>NCOL</code> and <code>NROW</code> do the same treating a vector as
1-column matrix, even a 0-length vector, compatibly with
<code><a href="#topic+as.matrix">as.matrix</a>()</code> or <code><a href="#topic+cbind">cbind</a>()</code>, see the example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nrow(x)
ncol(x)
NCOL(x)
NROW(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nrow_+3A_x">x</code></td>
<td>
<p>a vector, array, data frame, or <code><a href="#topic+NULL">NULL</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+integer">integer</a></code> of length 1 or <code><a href="#topic+NULL">NULL</a></code>, the
latter only for <code>ncol</code> and <code>nrow</code>.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole (<code>ncol</code> and <code>nrow</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dim">dim</a></code> which returns <em>all</em> dimensions, and
<code><a href="#topic+length">length</a></code> which gives a number (a &lsquo;count&rsquo;) also in cases where
<code>dim()</code> is <code>NULL</code>, and hence <code>nrow()</code> and <code>ncol()</code>
return <code>NULL</code>;
<code><a href="#topic+array">array</a></code>, <code><a href="#topic+matrix">matrix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ma &lt;- matrix(1:12, 3, 4)
nrow(ma)   # 3
ncol(ma)   # 4

ncol(array(1:24, dim = 2:4)) # 3, the second dimension
NCOL(1:12) # 1
NROW(1:12) # 12, the length() of the vector

## as.matrix() produces 1-column matrices from 0-length vectors,
## and so does cbind() :
dim(as.matrix(numeric())) # 0 1
dim(    cbind(numeric())) # ditto
NCOL(numeric()) # 1
## However, as.matrix(NULL) fails and cbind(NULL) gives NULL, hence for
## consistency: 
NCOL(NULL)      # 0
## (This gave 1 in R &lt; 4.4.0.)
</code></pre>

<hr>
<h2 id='ns-dblcolon'>Double Colon and Triple Colon Operators</h2><span id='topic++3A+3A'></span><span id='topic++3A+3A+3A'></span>

<h3>Description</h3>

<p>Accessing exported and internal variables, i.e. <span class="rlang"><b>R</b></span> objects
(including lazy loaded data sets) in a namespace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkg::name
pkg:::name
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-dblcolon_+3A_pkg">pkg</code></td>
<td>
<p>package name: symbol or literal character string.</p>
</td></tr>
<tr><td><code id="ns-dblcolon_+3A_name">name</code></td>
<td>
<p>variable name: symbol or literal character string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a package <span class="pkg">pkg</span>, <code>pkg::name</code> returns the value of the
exported variable <code>name</code> in namespace <code>pkg</code>, whereas
<code>pkg:::name</code> returns the value of the internal variable
<code>name</code>.  The package namespace will be loaded if it was not
loaded before the call, but the package will not be attached to the
search path.
</p>
<p>Specifying a variable or package that does not exist is an error.
</p>
<p>Note that <code>pkg::name</code> does <strong>not</strong> access the objects in the
environment <code>package:pkg</code> (which does not exist until the
package's namespace is attached): the latter may contain objects not
exported from the namespace.  It can access datasets made available by
lazy-loading.
</p>


<h3>Note</h3>

<p>It is typically a design mistake to use <code>:::</code>
in your code since the corresponding object has probably been kept
internal for a good reason.  Consider contacting the package
<code><a href="utils.html#topic+maintainer">maintainer</a></code> if you feel the need to access the object for
anything but mere inspection.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get">get</a></code> to access an object masked by another of the same name.
<code><a href="#topic+loadNamespace">loadNamespace</a></code>, <code><a href="#topic+asNamespace">asNamespace</a></code> for more about
namespaces.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>base::log
base::"+"

## Beware --  use ':::' at your own risk! (see "Details")
stats:::coef.default
</code></pre>

<hr>
<h2 id='ns-hooks'>Hooks for Namespace Events</h2><span id='topic+.onLoad'></span><span id='topic+.onUnload'></span><span id='topic+.onAttach'></span><span id='topic+.onDetach'></span><span id='topic+.Last.lib'></span>

<h3>Description</h3>

<p>Packages can supply functions to be called when
loaded, attached, detached or unloaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.onLoad(libname, pkgname)
.onAttach(libname, pkgname)
.onUnload(libpath)
.onDetach(libpath)
.Last.lib(libpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-hooks_+3A_libname">libname</code></td>
<td>
<p>a character string giving the library directory where
the package defining the namespace was found.</p>
</td></tr>
<tr><td><code id="ns-hooks_+3A_pkgname">pkgname</code></td>
<td>
<p>a character string giving the name of the package.</p>
</td></tr>
<tr><td><code id="ns-hooks_+3A_libpath">libpath</code></td>
<td>
<p>a character string giving the complete path to the package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After loading, <code><a href="#topic+loadNamespace">loadNamespace</a></code> looks for a hook function
named <code>.onLoad</code> and calls it (with two unnamed arguments) before
sealing the namespace and processing exports.
</p>
<p>When the package is attached (via <code><a href="#topic+library">library</a></code> or
<code><a href="#topic+attachNamespace">attachNamespace</a></code>), the hook function <code>.onAttach</code> is
looked for and if found is called (with two unnamed arguments) before
the package environment is sealed.
</p>
<p>If a function <code>.onDetach</code> is in the namespace or <code>.Last.lib</code>
is exported from the package, it will be called (with a single
argument) when the package is <code><a href="#topic+detach">detach</a></code>ed.  Beware that it
might be called if <code>.onAttach</code> has failed, so it should be
written defensively.  (It is called within <code><a href="#topic+tryCatch">tryCatch</a></code>, so
errors will not stop the package being detached.)
</p>
<p>If a namespace is unloaded (via <code><a href="#topic+unloadNamespace">unloadNamespace</a></code>), a hook
function <code>.onUnload</code> is run (with a single argument) before final
unloading.
</p>
<p>Note that the code in <code>.onLoad</code> and <code>.onUnload</code> should not
assume any package except the base package is on the search path.
Objects in the current package will be visible (unless this is
circumvented), but objects from other packages should be imported or
the double colon operator should be used.
</p>
<p><code>.onLoad</code>, <code>.onUnload</code>, <code>.onAttach</code> and
<code>.onDetach</code> are looked for as internal objects in the namespace
and should not be exported (whereas <code>.Last.lib</code> should be).
</p>
<p>Note that packages are not detached nor namespaces unloaded at the end
of an <span class="rlang"><b>R</b></span> session unless the user arranges to do so (e.g., <em>via</em>
<code><a href="#topic+.Last">.Last</a></code>).
</p>
<p>Anything needed for the functioning of the namespace should be
handled at load/unload times by the <code>.onLoad</code> and
<code>.onUnload</code> hooks.  For example, DLLs can be loaded (unless done
by a <code>useDynLib</code> directive in the &lsquo;<span class="file">NAMESPACE</span>&rsquo; file) and
initialized in <code>.onLoad</code> and unloaded in <code>.onUnload</code>.  Use
<code>.onAttach</code> only for actions that are needed only when the
package becomes visible to the user (for example a start-up message)
or need to be run after the package environment has been created.
</p>


<h3>Good practice</h3>

<p>Loading a namespace should where possible be silent, with startup
messages given by <code>.onAttach</code>.  These messages (and any essential
ones from <code>.onLoad</code>) should use <code><a href="#topic+packageStartupMessage">packageStartupMessage</a></code>
so they can be silenced where they would be a distraction.
</p>
<p>There should be no calls to <code>library</code> nor <code>require</code> in these
hooks.  The way for a package to load other packages is via the
&lsquo;<span class="samp">&#8288;Depends&#8288;</span>&rsquo; field in the &lsquo;<span class="file">DESCRIPTION</span>&rsquo; file: this ensures
that the dependence is documented and packages are loaded in the
correct order.  Loading a namespace should not change the search path,
so rather than attach a package, dependence of a namespace on another
package should be achieved by (selectively) importing from the other
package's namespace.
</p>
<p>Uses of <code>library</code> with argument <code>help</code> to display basic
information about the package should use <code>format</code> on the
computed package information object and pass this to
<code>packageStartupMessage</code>.
</p>
<p>There should be no calls to <code><a href="utils.html#topic+installed.packages">installed.packages</a></code> in startup
code: it is potentially very slow and may fail in versions of <span class="rlang"><b>R</b></span>
before 2.14.2 if package installation is going on in parallel.  See
its help page for alternatives.
</p>
<p>Compiled code should be loaded (e.g., <em>via</em>
<code><a href="#topic+library.dynam">library.dynam</a></code>) in <code>.onLoad</code> or a <code>useDynLib</code>
directive in the &lsquo;<span class="file">NAMESPACE</span>&rsquo; file, and not in <code>.onAttach</code>.
Similarly, compiled code should not be unloaded (e.g., <em>via</em>
<code><a href="#topic+library.dynam.unload">library.dynam.unload</a></code>) in <code>.Last.lib</code> nor
<code>.onDetach</code>, only in <code>.onUnload</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setHook">setHook</a></code> shows how users can set hooks on the same events, and
lists the sequence of events involving all of the hooks.
</p>
<p><code><a href="#topic+reg.finalizer">reg.finalizer</a></code> for hooks to be run at the end of a session.
</p>
<p><code><a href="#topic+loadNamespace">loadNamespace</a></code> for more about namespaces.
</p>

<hr>
<h2 id='ns-internals'>Namespace Internals</h2><span id='topic+asNamespace'></span><span id='topic+getNamespaceInfo'></span><span id='topic+.getNamespaceInfo'></span><span id='topic+importIntoEnv'></span><span id='topic+isBaseNamespace'></span><span id='topic+isNamespace'></span><span id='topic+namespaceExport'></span><span id='topic+namespaceImport'></span><span id='topic+namespaceImportClasses'></span><span id='topic+namespaceImportFrom'></span><span id='topic+namespaceImportMethods'></span><span id='topic+packageHasNamespace'></span><span id='topic+parseNamespaceFile'></span><span id='topic+registerS3method'></span><span id='topic+registerS3methods'></span><span id='topic+setNamespaceInfo'></span><span id='topic+.__S3MethodsTable__.'></span><span id='topic+.mergeExportMethods'></span><span id='topic+.mergeImportMethods'></span><span id='topic+.knownS3Generics'></span><span id='topic+loadingNamespaceInfo'></span><span id='topic+.getNamespace'></span><span id='topic+.getNamespaceInfo'></span><span id='topic+..getNamespace'></span><span id='topic+.S3_methods_table'></span>

<h3>Description</h3>

<p>Internal namespace support functions.  Not intended to be called
directly, and only visible because of the special nature of the
<span class="pkg">base</span> namespace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asNamespace(ns, base.OK = TRUE)
getNamespaceInfo (ns, which)
.getNamespaceInfo(ns, which)
importIntoEnv(impenv, impnames, expenv, expnames)
isBaseNamespace(ns)
isNamespace(ns)
namespaceExport(ns, vars)
namespaceImport(self, ..., from = NULL, except = character(0L))
namespaceImportFrom(self, ns, vars, generics, packages,
                    from = "non-package environment",
                    except = character(0L))
namespaceImportClasses(self, ns, vars, from = NULL)
namespaceImportMethods(self, ns, vars, from = NULL)
packageHasNamespace(package, package.lib)
parseNamespaceFile(package, package.lib, mustExist = TRUE)
registerS3method(genname, class, method, envir = parent.frame())
registerS3methods(info, package, env)
setNamespaceInfo(ns, which, val)
.mergeExportMethods(new, ns)
.mergeImportMethods(impenv, expenv, metaname)
.knownS3Generics
loadingNamespaceInfo()
.getNamespace(name)
..getNamespace(name, where)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-internals_+3A_ns">ns</code></td>
<td>
<p>string or namespace environment.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_base.ok">base.OK</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_impenv">impenv</code></td>
<td>
<p>environment.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_expenv">expenv</code></td>
<td>
<p>namespace environment.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_vars">vars</code></td>
<td>
<p>character vector.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_generics">generics</code></td>
<td>
<p>optional character vector.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_self">self</code></td>
<td>
<p>namespace environment.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_package">package</code></td>
<td>
<p>string naming the package/namespace to load.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_packages">packages</code></td>
<td>
<p>vector of package names parallel to <code>generics</code>.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_package.lib">package.lib</code></td>
<td>
<p>character vector specifying library.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_mustexist">mustExist</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_genname">genname</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_class">class</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_envir">envir</code>, <code id="ns-internals_+3A_env">env</code></td>
<td>
<p>environment.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_info">info</code></td>
<td>
<p>a 3-column character matrix.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_which">which</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_val">val</code></td>
<td>
<p>any object.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_...">...</code></td>
<td>
<p>character arguments.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_metaname">metaname</code></td>
<td>
<p>the methods table name.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_name">name</code></td>
<td>
<p>symbol: name of namespace.</p>
</td></tr>
<tr><td><code id="ns-internals_+3A_except">except</code></td>
<td>
<p>character vector naming symbols to exclude from the
import, particularly useful when <code>vars</code> is missing.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>packageHasNamespace</code> does not indicate if the package has a
namespace (all now do), rather if it has a &lsquo;<span class="file">NAMESPACE</span>&rsquo; file,
which <span class="pkg">base</span> and some legacy packages do not.  But then you are
not intended to be using it ....
</p>


<h3>Author(s)</h3>

<p>Luke Tierney and other members of the R Core Team.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loadNamespace">loadNamespace</a></code> or <code><a href="#topic+getNamespace">getNamespace</a></code> are somewhat
higher level namespace related functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nsName &lt;- "stats"
(ns &lt;- asNamespace(nsName)) # &lt;environment: namespace:stats&gt;

## Inverse function of asNamespace() :
environmentName(asNamespace("stats")) # "stats"
environmentName(asNamespace("base"))  # "base"
getNamespaceInfo(ns, "spec")[["name"]] ## -&gt; "stats"


## Only for the daring ones, getting into the bowels (non-API!):
.nsInfEnv &lt;- function(ns)   asNamespace(ns, base.OK = FALSE)[[".__NAMESPACE__."]]
lsNSInfo  &lt;- function(ns, ...) ls(..., envir = .nsInfEnv(ns))
allinfoNS &lt;- function(ns)      as.list(.nsInfEnv(ns), sorted=TRUE)

utils::str(allinfoNS("stats"))
utils::str(allinfoNS("stats4"))
</code></pre>

<hr>
<h2 id='ns-load'>Loading and Unloading Name Spaces</h2><span id='topic+attachNamespace'></span><span id='topic+loadNamespace'></span><span id='topic+requireNamespace'></span><span id='topic+loadedNamespaces'></span><span id='topic+unloadNamespace'></span><span id='topic+isNamespaceLoaded'></span>

<h3>Description</h3>

<p>Functions to load and unload name spaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attachNamespace(ns, pos = 2L, depends = NULL, exclude, include.only)
loadNamespace(package, lib.loc = NULL,
              keep.source = getOption("keep.source.pkgs"),
              partial = FALSE, versionCheck = NULL,
              keep.parse.data = getOption("keep.parse.data.pkgs"))
requireNamespace(package, ..., quietly = FALSE)
loadedNamespaces()
unloadNamespace(ns)
isNamespaceLoaded(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-load_+3A_ns">ns</code></td>
<td>
<p>string or name space object.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_pos">pos</code></td>
<td>
<p>integer specifying position to attach.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_depends">depends</code></td>
<td>
<p><code>NULL</code> or a character vector of dependencies to be
recorded in object <code>.Depends</code> in the package.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_package">package</code></td>
<td>
<p>string naming the package/name space to load.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_lib.loc">lib.loc</code></td>
<td>
<p>character vector specifying library search path (the location
of <span class="rlang"><b>R</b></span> library trees to search through.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_keep.source">keep.source</code></td>
<td>
<p>now ignored except during package installation.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_keep.parse.data">keep.parse.data</code></td>
<td>
<p>ignored except during package installation.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_partial">partial</code></td>
<td>
<p>logical; if true, stop just after loading code.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_versioncheck">versionCheck</code></td>
<td>
<p><code>NULL</code> or a version specification (a list
with components <code>op</code> and <code>version</code>).</p>
</td></tr>
<tr><td><code id="ns-load_+3A_quietly">quietly</code></td>
<td>
<p>logical: should progress and error messages be suppressed?</p>
</td></tr>
<tr><td><code id="ns-load_+3A_name">name</code></td>
<td>
<p>string or &lsquo;name&rsquo;, see <code><a href="#topic+as.symbol">as.symbol</a></code>,
of a package, e.g., <code>"stats"</code>.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_exclude">exclude</code>, <code id="ns-load_+3A_include.only">include.only</code></td>
<td>
<p>character vectors; see <code><a href="#topic+library">library</a></code>.</p>
</td></tr>
<tr><td><code id="ns-load_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>loadNamespace</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>loadNamespace</code> and <code>attachNamespace</code> are
usually called implicitly when <code><a href="#topic+library">library</a></code> is used to load a name
space and any imports needed.  However it may be useful at times to
call these functions directly.
</p>
<p><code>loadNamespace</code> loads the specified name space and registers it in
an internal data base.  A request to load a name space when one of that
name is already loaded has no effect.  The arguments have the same
meaning as the corresponding arguments to <code><a href="#topic+library">library</a></code>, whose
help page explains the details of how a particular installed package
comes to be chosen.  After loading, <code>loadNamespace</code> looks for a
hook function named <code><a href="#topic+.onLoad">.onLoad</a></code> as an internal variable in
the name space (it should not be exported).  Partial loading is used
to support installation with lazy-loading.
</p>
<p>Optionally the package licence is checked during loading: see section
&lsquo;Licenses&rsquo; in the help for <code><a href="#topic+library">library</a></code>.
</p>
<p><code>loadNamespace</code> does not attach the name space it loads to the
search path.  <code>attachNamespace</code> can be used to attach a frame
containing the exported values of a name space to the search path (but
this is almost always done <em>via</em> <code><a href="#topic+library">library</a></code>).  The
hook function <code><a href="#topic+.onAttach">.onAttach</a></code> is run after the name space
exports are attached.
</p>
<p><code>requireNamespace</code> is a wrapper for <code>loadNamespace</code>
analogous to <code><a href="#topic+require">require</a></code> that returns a logical value.
</p>
<p><code>loadedNamespaces</code> returns a character vector of the names of
the loaded name spaces.
</p>
<p><code>isNamespaceLoaded(pkg)</code> is equivalent to but more efficient than
<code>pkg %in% loadedNamespaces()</code>.
</p>
<p><code>unloadNamespace</code> can be used to attempt to force a name space to
be unloaded.  If the name space is attached, it is first
<code><a href="#topic+detach">detach</a></code>ed, thereby running a <code><a href="#topic+.onDetach">.onDetach</a></code> or
<code>.Last.lib</code> function in the name space if one is exported.  An
error is signaled and the name space is not unloaded if the name space
is imported by other loaded name spaces.  If defined, a hook function
<code><a href="#topic+.onUnload">.onUnload</a></code> is run before removing the name space from the
internal registry.
</p>
<p>See the comments in the help for <code><a href="#topic+detach">detach</a></code> about some
issues with unloading and reloading name spaces.
</p>


<h3>Value</h3>

<p><code>attachNamespace</code> returns invisibly the package environment it
adds to the search path.
</p>
<p><code>loadNamespace</code> returns the name space environment, either one
already loaded or the one the function causes to be loaded.
</p>
<p><code>requireNamespace</code> returns <code>TRUE</code> if it succeeds or
<code>FALSE</code>.
</p>
<p><code>loadedNamespaces</code> returns a <code><a href="#topic+character">character</a></code> vector.
</p>
<p><code>unloadNamespace</code> returns <code>NULL</code>, invisibly.
</p>


<h3>Tracing</h3>

<p>As from <span class="rlang"><b>R</b></span> 4.1.0 the operation of <code>loadNamespace</code> can be traced,
which can help track down the causes of unexpected messages (including
which package(s) they come from since <code>loadNamespace</code> is called in
many ways including from itself and by <code>::</code> and can be called by
<code>load</code>). Setting the environment variable
<span class="env">_R_TRACE_LOADNAMESPACE_</span> to a numerical value will generate
additional messages on progress.  Non-zero values,
e.g. <code>1</code>, report which namespace is being loaded and when
loading completes: values <code>2</code> to <code>4</code> report in increasing
detail.  Negative values are reserved for tracing specific features and
their current meanings are documented in source-code comments.
</p>
<p>Loading standard packages is never traced.
</p>


<h3>Author(s)</h3>

<p>Luke Tierney and R-core</p>


<h3>References</h3>

<p>The &lsquo;Writing R Extensions&rsquo; manual, section &ldquo;Package namespaces&rdquo;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNamespace">getNamespace</a></code>, <code><a href="#topic+asNamespace">asNamespace</a></code>,
<code><a href="#topic+topenv">topenv</a></code>, <code><a href="#topic+.onLoad">.onLoad</a></code> (etc);
further <code><a href="#topic+environment">environment</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> (lns &lt;- loadedNamespaces())
 statL &lt;- isNamespaceLoaded("stats")
 stopifnot( identical(statL, "stats" %in% lns) )

 ## The string "foo" and the symbol 'foo' can be used interchangably here:
 stopifnot( identical(isNamespaceLoaded(  "foo"   ), FALSE),
            identical(isNamespaceLoaded(quote(foo)), FALSE),
            identical(isNamespaceLoaded(quote(stats)), statL))

hasS &lt;- isNamespaceLoaded("splines") # (to restore if needed)
Sns &lt;- asNamespace("splines") # loads it if not already
stopifnot(   isNamespaceLoaded("splines"))
if (is.null(try(unloadNamespace(Sns)))) # try unloading the NS 'object'
stopifnot( ! isNamespaceLoaded("splines"))
if (hasS) loadNamespace("splines") # (restoring previous state)
</code></pre>

<hr>
<h2 id='ns-reflect'>Namespace Reflection Support</h2><span id='topic+getExportedValue'></span><span id='topic+getNamespace'></span><span id='topic+getNamespaceExports'></span><span id='topic+getNamespaceImports'></span><span id='topic+getNamespaceName'></span><span id='topic+getNamespaceUsers'></span><span id='topic+getNamespaceVersion'></span>

<h3>Description</h3>

<p>Internal functions to support reflection on namespace objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getExportedValue(ns, name)
getNamespace(name)
getNamespaceExports(ns)
getNamespaceImports(ns)
getNamespaceName(ns)
getNamespaceUsers(ns)
getNamespaceVersion(ns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-reflect_+3A_ns">ns</code></td>
<td>
<p>string or namespace object.</p>
</td></tr>
<tr><td><code id="ns-reflect_+3A_name">name</code></td>
<td>
<p>string or name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getExportedValue</code> returns the value of the exported variable
<code>name</code> in namespace <code>ns</code>.
</p>
<p><code>getNamespace</code> returns the environment representing the name
space <code>name</code>.  The namespace is loaded if necessary.
</p>
<p><code>getNamespaceExports</code> returns a character vector of the names
exported by <code>ns</code>.
</p>
<p><code>getNamespaceImports</code> returns a representation of the imports
used by namespace <code>ns</code>.  This representation is experimental
and subject to change.
</p>
<p><code>getNamespaceName</code> and <code>getNamespaceVersion</code> return the name
and version of the namespace <code>ns</code>.
</p>
<p><code>getNamespaceUsers</code> returns a character vector of the names of
the namespaces that import namespace <code>ns</code>.
</p>


<h3>Author(s)</h3>

<p>Luke Tierney</p>


<h3>See Also</h3>

<p><code><a href="#topic+loadNamespace">loadNamespace</a></code> for more about namespaces.
</p>

<hr>
<h2 id='ns-topenv'>Top Level Environment</h2><span id='topic+topenv'></span>

<h3>Description</h3>

<p>Finding the top level <code><a href="#topic+environment">environment</a></code> from an environment
<code>envir</code> and its enclosing environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>topenv(envir = parent.frame(),
       matchThisEnv = getOption("topLevelEnvironment"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ns-topenv_+3A_envir">envir</code></td>
<td>
<p>environment.</p>
</td></tr>
<tr><td><code id="ns-topenv_+3A_matchthisenv">matchThisEnv</code></td>
<td>
<p>return this environment, if it matches before
any other criterion is satisfied.  The default, the option
&lsquo;<span class="samp">&#8288;topLevelEnvironment&#8288;</span>&rsquo;, is set by <code><a href="#topic+sys.source">sys.source</a></code>,
which treats a specific environment as the top level environment.
Supplying the argument as <code>NULL</code> or <code>emptyenv()</code> means
it will never match.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>topenv</code> returns the first top level <code><a href="#topic+environment">environment</a></code>
found when searching <code>envir</code> and its enclosing environments. If no
top level environment is found, <code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code> is returned.  An
environment is considered top level if it is the internal environment
of a namespace, a package environment in the <code><a href="#topic+search">search</a></code>
path, or <code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code> .
</p>


<h3>See Also</h3>

<p><code><a href="#topic+environment">environment</a></code>, notably <code>parent.env()</code> on
&ldquo;enclosing environments&rdquo;;
<code><a href="#topic+loadNamespace">loadNamespace</a></code> for more on namespaces.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>topenv(.GlobalEnv)
topenv(new.env()) # also global env
topenv(environment(ls))# namespace:base
topenv(environment(lm))# namespace:stats

</code></pre>

<hr>
<h2 id='NULL'>The Null Object</h2><span id='topic+NULL'></span><span id='topic+as.null'></span><span id='topic+as.null.default'></span><span id='topic+is.null'></span>

<h3>Description</h3>

<p><code>NULL</code> represents the null object in <span class="rlang"><b>R</b></span>: it is a <a href="#topic+reserved">reserved</a>
word.  <code>NULL</code> is often returned by expressions and functions
whose value is undefined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NULL
as.null(x, ...)
is.null(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NULL_+3A_x">x</code></td>
<td>
<p>an object to be tested or coerced.</p>
</td></tr>
<tr><td><code id="NULL_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>NULL</code> can be indexed (see <a href="#topic+Extract">Extract</a>) in just about any
syntactically legal way: apart from <code>NULL[[]]</code> which is an error, the result is
always <code>NULL</code>.  Objects with value <code>NULL</code> can be changed by
replacement operators and will be coerced to the type of the
right-hand side.
</p>
<p><code>NULL</code> is also used as the empty <a href="#topic+pairlist">pairlist</a>: see the
examples. Because pairlists are often promoted to lists, you may
encounter <code>NULL</code> being promoted to an empty list.
</p>
<p>Objects with value <code>NULL</code> cannot have attributes as there is only
one null object: attempts to assign them are either an error
(<code><a href="#topic+attr">attr</a></code>) or promote the object to an empty list with
attribute(s) (<code><a href="#topic+attributes">attributes</a></code> and <code><a href="#topic+structure">structure</a></code>).
</p>


<h3>Value</h3>

<p><code>as.null</code> ignores its argument and returns <code>NULL</code>.
</p>
<p><code>is.null</code> returns <code>TRUE</code> if its argument's value
is <code>NULL</code> and <code>FALSE</code> otherwise.
</p>


<h3>Note</h3>

<p><code>is.null</code> is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++25+7C+7C+25">%||%</a></code>: <code>L %||% R</code> is equivalent to <code> if(!is.null(L)) L else R </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.null(list())     # FALSE (on purpose!)
is.null(pairlist()) # TRUE
is.null(integer(0)) # FALSE
is.null(logical(0)) # FALSE
as.null(list(a = 1, b = "c"))
</code></pre>

<hr>
<h2 id='numeric'>Numeric Vectors</h2><span id='topic+numeric'></span><span id='topic+as.numeric'></span><span id='topic+is.numeric'></span><span id='topic+is.numeric.Date'></span><span id='topic+is.numeric.POSIXt'></span>

<h3>Description</h3>

<p>Creates or coerces objects of type <code>"numeric"</code>.
<code>is.numeric</code> is a more general test of an object being
interpretable as numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numeric(length = 0)
as.numeric(x, ...)
is.numeric(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numeric_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.
Double values will be coerced to integer:
supplying an argument of length other than one is an error.</p>
</td></tr>
<tr><td><code id="numeric_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="numeric_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>numeric</code> is identical to <code><a href="#topic+double">double</a></code>.
It creates a double-precision vector of the specified length with each
element equal to <code>0</code>.
</p>
<p><code>as.numeric</code> is a generic function, but S3 methods must be
written for <code><a href="#topic+as.double">as.double</a></code>.  It is identical to <code>as.double</code>.
</p>
<p><code>is.numeric</code> is an <a href="#topic+internal+20generic">internal generic</a> <code>primitive</code>
function: you can write methods to handle specific classes of objects,
see <a href="#topic+InternalMethods">InternalMethods</a>.  It is <strong>not</strong> the same as
<code><a href="#topic+is.double">is.double</a></code>.  Factors are handled by the default method,
and there are methods for classes <code>"<a href="#topic+Date">Date</a>"</code>,
<code>"<a href="#topic+POSIXt">POSIXt</a>"</code> and <code>"<a href="#topic+difftime">difftime</a>"</code> (all of which
return false).  Methods for <code>is.numeric</code> should only return true
if the base type of the class is <code>double</code> or <code>integer</code>
<em>and</em> values can reasonably be regarded as numeric
(e.g., arithmetic on them makes sense, and comparison should be done
via the base type).
</p>


<h3>Value</h3>

<p>for <code>numeric</code> and <code>as.numeric</code> see <code><a href="#topic+double">double</a></code>.
</p>
<p>The default method for <code>is.numeric</code> returns <code>TRUE</code>
if its argument is of <a href="#topic+mode">mode</a> <code>"numeric"</code>
(<a href="#topic+type">type</a> <code>"double"</code> or type <code>"integer"</code>) and not a
factor, and <code>FALSE</code> otherwise.  That is,
<code>is.integer(x) || is.double(x)</code>, or
<code>(mode(x) == "numeric") &amp;&amp; !is.factor(x)</code>.
</p>


<h3>Warning</h3>

<p>If <code>x</code> is a <code><a href="#topic+factor">factor</a></code>, <code>as.numeric</code> will return
the underlying numeric (integer) representation, which is often
meaningless as it may not correspond to the <code>factor</code>
<code><a href="#topic+levels">levels</a></code>, see the &lsquo;Warning&rsquo; section in
<code><a href="#topic+factor">factor</a></code> (and the 2nd example below).
</p>


<h3>S4 methods</h3>

<p><code>as.numeric</code> and <code>is.numeric</code> are internally S4 generic and
so methods can be set for them <em>via</em> <code>setMethod</code>.
</p>
<p>To ensure that <code>as.numeric</code> and <code>as.double</code>
remain identical, S4 methods can only be set for <code>as.numeric</code>.
</p>


<h3>Note on names</h3>

<p>It is a historical anomaly that <span class="rlang"><b>R</b></span> has two names for its
floating-point vectors, <code><a href="#topic+double">double</a></code> and <code><a href="#topic+numeric">numeric</a></code>
(and formerly had <code>real</code>).
</p>
<p><code>double</code> is the name of the <a href="#topic+type">type</a>.
<code>numeric</code> is the name of the <a href="#topic+mode">mode</a> and also of the implicit
<a href="#topic+class">class</a>.  As an S4 formal class, use <code>"numeric"</code>.
</p>
<p>The potential confusion is that <span class="rlang"><b>R</b></span> has used <em><a href="#topic+mode">mode</a></em>
<code>"numeric"</code> to mean &lsquo;double or integer&rsquo;, which conflicts
with the S4 usage.  Thus <code>is.numeric</code> tests the mode, not the
class, but <code>as.numeric</code> (which is identical to <code>as.double</code>)
coerces to the class.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+double">double</a></code>, <code><a href="#topic+integer">integer</a></code>, <code><a href="#topic+storage.mode">storage.mode</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Conversion does trim whitespace; non-numeric strings give NA + warning
as.numeric(c("-.1"," 2.7 ","B"))

## Numeric values are sometimes accidentally converted to factors.
## Converting them back to numeric is trickier than you'd expect.
f &lt;- factor(5:10)
as.numeric(f) # not what you might expect, probably not what you want
## what you typically meant and want:
as.numeric(as.character(f))
## the same, considerably more efficient (for long vectors):
as.numeric(levels(f))[f]
</code></pre>

<hr>
<h2 id='numeric_version'>Numeric Versions</h2><span id='topic+numeric_version'></span><span id='topic+as.numeric_version'></span><span id='topic+is.numeric_version'></span><span id='topic+package_version'></span><span id='topic+is.package_version'></span><span id='topic+as.package_version'></span><span id='topic+R_system_version'></span><span id='topic+getRversion'></span><span id='topic++5B.numeric_version'></span><span id='topic++5B+3C-.numeric_version'></span><span id='topic++5B+5B.numeric_version'></span><span id='topic++5B+5B+3C-.numeric_version'></span><span id='topic+Ops.numeric_version'></span><span id='topic+Summary.numeric_version'></span><span id='topic+anyNA.numeric_version'></span><span id='topic+as.character.numeric_version'></span><span id='topic+as.list.numeric_version'></span><span id='topic+c.numeric_version'></span><span id='topic+duplicated.numeric_version'></span><span id='topic+format.numeric_version'></span><span id='topic+is.na.numeric_version'></span><span id='topic+is.na+3C-.numeric_version'></span><span id='topic+print.numeric_version'></span><span id='topic+rep.numeric_version'></span><span id='topic+unique.numeric_version'></span><span id='topic+xtfrm.numeric_version'></span><span id='topic++24.package_version'></span>

<h3>Description</h3>

<p>A simple S3 class for representing numeric versions
including package versions, and associated methods.</p>


<h3>Usage</h3>

<pre><code class='language-R'>numeric_version(x, strict = TRUE)
package_version(x, strict = TRUE)
R_system_version(x, strict = TRUE)
getRversion()
as.numeric_version(x)
as.package_version(x)
is.numeric_version(x)
is.package_version(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numeric_version_+3A_x">x</code></td>
<td>
<p>for the creators, a character vector with suitable numeric
version strings (see &lsquo;Details&rsquo;);
for <code>package_version</code>, alternatively an R
version object as obtained by <code><a href="#topic+R.version">R.version</a></code>.
For <code>as.numeric_version</code> and <code>as.package_version</code>,
suitable character vectors as above, or numeric version objects.
For <code>is.numeric_version</code> and <code>is.package_version</code>,
arbitrary R objects.
</p>
</td></tr>
<tr><td><code id="numeric_version_+3A_strict">strict</code></td>
<td>
<p>a logical indicating whether invalid numeric versions
should result in an error (default) or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numeric versions are sequences of one or more non-negative integers,
usually (e.g., in package &lsquo;<span class="file">DESCRIPTION</span>&rsquo; files) represented as
character strings with the elements of the sequence concatenated and
separated by single &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;-&#8288;</span>&rsquo; characters.  <span class="rlang"><b>R</b></span> package
versions consist of at least two such integers, an <span class="rlang"><b>R</b></span> system version
of exactly three (major, minor and patch level).
</p>
<p>Functions <code>numeric_version</code>, <code>package_version</code> and
<code>R_system_version</code> create a representation from such strings (if
suitable) which allows for coercion and testing, combination,
comparison, summaries (min/max), inclusion in data frames,
subscripting, and printing.  The classes can hold a vector of such
representations.
</p>
<p><code>getRversion</code> returns the version of the running <span class="rlang"><b>R</b></span> as an R
system version object.
</p>
<p>The <code>[[</code> operator extracts or replaces a single version.  To
access the integers of a version use two indices: see the examples.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+compareVersion">compareVersion</a></code>;
<code><a href="utils.html#topic+packageVersion">packageVersion</a></code> for the version of a specific <span class="rlang"><b>R</b></span> package.
<code><a href="#topic+R.version">R.version</a></code> etc for the version of <span class="rlang"><b>R</b></span> (and the information
underlying <code>getRversion()</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- package_version(c("1.2-4", "1.2-3", "2.1"))
x &lt; "1.4-2.3"
c(min(x), max(x))
x[2, 2]
x$major
x$minor

if(getRversion() &lt;= "2.5.0") { ## work around missing feature
  cat("Your version of R, ", as.character(getRversion()),
      ", is outdated.\n",
      "Now trying to work around that ...\n", sep = "")
}

x[[1]]
x[[c(1, 3)]]  # '4' as a numeric version
x[1, 3]       # same
x[[1, 3]]     # 4 as an integer

x[[2, 3]] &lt;- 0    # zero the patchlevel
x[[c(2, 3)]] &lt;- 0 # same
x

x[[3]] &lt;- "2.2.3"
x

x &lt;- c(x, package_version("0.0"))
is.na(x)[4] &lt;- TRUE
stopifnot(identical(is.na(x), c(rep(FALSE,3), TRUE)),
	  anyNA(x))
</code></pre>

<hr>
<h2 id='NumericConstants'>Numeric Constants</h2><span id='topic+NumericConstants'></span><span id='topic+1L'></span><span id='topic+0x1'></span><span id='topic+1i'></span>

<h3>Description</h3>

<p>How <span class="rlang"><b>R</b></span> parses numeric constants.
</p>


<h3>Details</h3>

<p><span class="rlang"><b>R</b></span> parses numeric constants in its input in a very similar way to C99
floating-point constants.
</p>
<p><code><a href="#topic+Inf">Inf</a></code> and <code><a href="#topic+NaN">NaN</a></code> are numeric constants (with
<code><a href="#topic+typeof">typeof</a>(.) "double"</code>).  In text input (e.g., in
<code><a href="#topic+scan">scan</a></code> and <code><a href="#topic+as.double">as.double</a></code>), these are recognized
ignoring case as is <code>infinity</code> as an alternative to <code>Inf</code>.
<code><a href="#topic+NA_real_">NA_real_</a></code> and <code><a href="#topic+NA_integer_">NA_integer_</a></code> are constants of
types <code>"double"</code> and <code>"integer"</code> representing missing
values.  All other numeric constants start with a digit or period and
are either a decimal or hexadecimal constant optionally followed by
<code>L</code>.
</p>
<p>Hexadecimal constants start with <code>0x</code> or <code>0X</code> followed by
a nonempty sequence from <code>0-9 a-f A-F .</code> which is interpreted as a
hexadecimal number, optionally followed by a binary exponent.  A binary
exponent consists of a <code>P</code> or <code>p</code> followed by an optional
plus or minus sign followed by a non-empty sequence of (decimal)
digits, and indicates multiplication by a power of two.  Thus
<code>0x123p456</code> is <code class="reqn">291 \times 2^{456}</code>.
</p>
<p>Decimal constants consist of a nonempty sequence of digits possibly
containing a period (the decimal point), optionally followed by a
decimal exponent.  A decimal exponent consists of an <code>E</code> or
<code>e</code> followed by an optional plus or minus sign followed by a
non-empty sequence of digits, and indicates multiplication by a power
of ten.
</p>
<p>Values which are too large or too small to be representable will
overflow to <code>Inf</code> or underflow to <code>0.0</code>.
</p>
<p>A numeric constant immediately followed by <code>i</code> is regarded as an
imaginary <a href="#topic+complex">complex</a> number.
</p>
<p>A numeric constant immediately followed by <code>L</code> is regarded as an
<code><a href="#topic+integer">integer</a></code> number when possible (and with a warning if it
contains a <code>"."</code>).
</p>
<p>Only the ASCII digits 0&ndash;9 are recognized as digits, even in languages
which have other representations of digits.  The &lsquo;decimal
separator&rsquo; is always a period and never a comma.
</p>
<p>Note that a leading plus or minus is not regarded by the parser as
part of a numeric constant but as a unary operator applied to the constant.
</p>


<h3>Note</h3>

<p>When a string is parsed to input a numeric constant, the number may or
may not be representable exactly in the C double type used.  If not
one of the nearest representable numbers will be returned.
</p>
<p><span class="rlang"><b>R</b></span>'s own C code is used to convert constants to binary numbers, so the
effect can be expected to be the same on all platforms implementing
full <abbr>IEC</abbr> 60559 arithmetic (the most likely area of difference being
the handling of numbers less than <code><a href="#topic+.Machine">.Machine</a>$double.xmin</code>).
The same code is used by <code><a href="#topic+scan">scan</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Syntax">Syntax</a></code>.
For complex numbers, see <code><a href="#topic+complex">complex</a></code>.
<code><a href="#topic+Quotes">Quotes</a></code> for the parsing of character constants,
<code><a href="#topic+Reserved">Reserved</a></code> for the &ldquo;reserved words&rdquo; in <span class="rlang"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## You can create numbers using fixed or scientific formatting.
2.1
2.1e10
-2.1E-10

## The resulting objects have class numeric and type double.
class(2.1)
typeof(2.1)

## This holds even if what you typed looked like an integer.
class(2)
typeof(2)

## If you actually wanted integers, use an "L" suffix.
class(2L)
typeof(2L)

## These are equal but not identical
2 == 2L
identical(2, 2L)

## You can write numbers between 0 and 1 without a leading "0"
## (but typically this makes code harder to read)
.1234

sqrt(1i) # remember elementary math?
utils::str(0xA0)
identical(1L, as.integer(1))

## You can combine the "0x" prefix with the "L" suffix :
identical(0xFL, as.integer(15))
</code></pre>

<hr>
<h2 id='octmode'>Integer Numbers Displayed in Octal</h2><span id='topic+as.octmode'></span><span id='topic+format.octmode'></span><span id='topic+print.octmode'></span><span id='topic+as.character.octmode'></span><span id='topic++5B.octmode'></span><span id='topic++21.octmode'></span><span id='topic++7C.octmode'></span><span id='topic++26.octmode'></span><span id='topic+octmode'></span>

<h3>Description</h3>

<p>Integers which are displayed in octal (base-8 number system) format, with as
many digits as are needed to display the largest, using leading zeroes as
necessary.
</p>
<p>Arithmetic works as for integers, and non-integer valued mathematical
functions typically work by truncating the result to integer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.octmode(x)

## S3 method for class 'octmode'
as.character(x, keepStr = FALSE, ...)

## S3 method for class 'octmode'
format(x, width = NULL, ...)

## S3 method for class 'octmode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="octmode_+3A_x">x</code></td>
<td>
<p>an object, for the methods inheriting from class <code>"octmode"</code>.</p>
</td></tr>
<tr><td><code id="octmode_+3A_keepstr">keepStr</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> indicating that names and
dimensions should be kept; set <code>TRUE</code> for back compatibility, if needed.</p>
</td></tr>
<tr><td><code id="octmode_+3A_width">width</code></td>
<td>
<p><code>NULL</code> or a positive integer specifying the minimum
field width to be used, with padding by leading zeroes.</p>
</td></tr>
<tr><td><code id="octmode_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>"octmode"</code> objects are integer vectors with that class
attribute, used primarily to ensure that they are printed in octal
notation, specifically for Unix-like file permissions such as
<code>755</code>.  Subsetting (<code><a href="#topic++5B">[</a></code>) works too, as do arithmetic or
other mathematical operations, albeit truncated to integer.
</p>
<p><code>as.character(x)</code> drops all <code><a href="#topic+attributes">attributes</a></code> (unless when
<code>keepStr=TRUE</code> where it keeps, <code>dim</code>, <code>dimnames</code> and
<code>names</code> for back compatibility) and converts each entry individually, hence with no
leading zeroes, whereas in <code>format()</code>, when <code>width = NULL</code> (the
default), the output is padded with leading zeroes to the smallest width
needed for all the non-missing elements.
</p>
<p><code>as.octmode</code> can convert integers (of <a href="#topic+type">type</a> <code>"integer"</code> or
<code>"double"</code>) and character vectors whose elements contain only
digits <code>0-7</code> (or are <code>NA</code>) to class <code>"octmode"</code>.
</p>
<p>There is a <code><a href="#topic++21">!</a></code> method and methods for <code><a href="#topic++7C">|</a></code> and
<code><a href="#topic++26">&amp;</a></code>:


these recycle their arguments to the length of the longer and then
apply the operators bitwise to each element.
</p>


<h3>See Also</h3>

<p>These are auxiliary functions for <code><a href="#topic+file.info">file.info</a></code>.
</p>
<p><code><a href="#topic+hexmode">hexmode</a></code>, <code><a href="#topic+sprintf">sprintf</a></code> for other options in
converting integers to octal, <code><a href="#topic+strtoi">strtoi</a></code> to convert octal
strings to integers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(on &lt;- as.octmode(c(16, 32, 127:129))) # "020" "040" "177" "200" "201"
unclass(on[3:4]) # subsetting

## manipulate file modes
fmode &lt;- as.octmode("170")
(fmode | "644") &amp; "755"

(umask &lt;- Sys.umask()) # depends on platform
c(fmode, "666", "755") &amp; !umask


om &lt;- as.octmode(1:12)
om # print()s via format()
stopifnot(nchar(format(om)) == 2)
om[1:7] # *no* leading zeroes!
stopifnot(format(om[1:7]) == as.character(1:7))
om2 &lt;- as.octmode(c(1:10, 60:70))
om2 # prints via format() -&gt; with 3 octals
stopifnot(nchar(format(om2)) == 3)
as.character(om2) # strings of length 1, 2, 3


## Integer arithmetic (remaining "octmode"):
om^2
om * 64
-om
(fac &lt;- factorial(om)) # !1, !2, !3, !4 .. in hexadecimals
as.integer(fac) # indeed the same as  factorial(1:12)
</code></pre>

<hr>
<h2 id='on.exit'>Function Exit Code</h2><span id='topic+on.exit'></span>

<h3>Description</h3>

<p><code>on.exit</code> records the expression given as its argument as needing
to be executed when the current function exits (either naturally or as
the result of an error).  This is useful for resetting graphical
parameters or performing other cleanup actions.
</p>
<p>If no expression is provided, i.e., the call is <code>on.exit()</code>, then
the current <code>on.exit</code> code is removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>on.exit(expr = NULL, add = FALSE, after = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="on.exit_+3A_expr">expr</code></td>
<td>
<p>an expression to be executed.</p>
</td></tr>
<tr><td><code id="on.exit_+3A_add">add</code></td>
<td>
<p>if TRUE, add <code>expr</code> to be executed after any previously
set expressions (or before if <code>after</code> is FALSE); otherwise (the
default) <code>expr</code> will overwrite any previously set expressions.</p>
</td></tr>
<tr><td><code id="on.exit_+3A_after">after</code></td>
<td>
<p>if <code>add</code> is TRUE and <code>after</code> is FALSE, then
<code>expr</code> will be added on top of the expressions that were already
registered. The resulting last in first out order is useful for freeing
or closing resources in reverse order.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>expr</code> argument passed to <code>on.exit</code> is recorded without
evaluation.  If it is not subsequently removed/replaced by another
<code>on.exit</code> call in the same function, it is evaluated in the
evaluation frame of the function when it exits (including during
standard error handling).  Thus any functions or variables in the
expression will be looked for in the function and its environment at
the time of exit: to capture the current value in <code>expr</code> use
<code><a href="#topic+substitute">substitute</a></code> or similar.
</p>
<p>If multiple <code>on.exit</code> expressions are set using <code>add = TRUE</code>
then all expressions will be run even if one signals an error.
</p>
<p>This is a &lsquo;special&rsquo; <a href="#topic+primitive">primitive</a> function: it only
evaluates the arguments <code>add</code> and <code>after</code>.
</p>


<h3>Value</h3>

<p>Invisible <code>NULL</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sys.on.exit">sys.on.exit</a></code> which returns the expression stored for use
by <code>on.exit()</code> in the function in which <code>sys.on.exit()</code> is
evaluated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

opar &lt;- par(mai = c(1,1,1,1))
on.exit(par(opar))

</code></pre>

<hr>
<h2 id='Ops.Date'>Operators on the Date Class</h2><span id='topic++2B.Date'></span><span id='topic+-.Date'></span><span id='topic+Ops.Date'></span>

<h3>Description</h3>

<p>Operators for the <code>"<a href="#topic+Date">Date</a>"</code> class.
</p>
<p>There is an <code><a href="#topic+S3groupGeneric">Ops</a></code> method and specific
methods for <code>+</code> and <code>-</code> for the <code><a href="#topic+Date">Date</a></code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date + x
x + date
date - x
date1 lop date2
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ops.Date_+3A_date">date</code></td>
<td>
<p>an object of class <code>"<a href="#topic+Date">Date</a>"</code>.</p>
</td></tr>
<tr><td><code id="Ops.Date_+3A_date1">date1</code>, <code id="Ops.Date_+3A_date2">date2</code></td>
<td>
<p>date objects or character vectors.  (Character
vectors are converted by <code><a href="#topic+as.Date">as.Date</a></code>.)</p>
</td></tr>
<tr><td><code id="Ops.Date_+3A_x">x</code></td>
<td>
<p>a numeric vector (in days) <em>or</em> an object of class
<code>"<a href="#topic+difftime">difftime</a>"</code>, rounded to the nearest whole day.</p>
</td></tr>
<tr><td><code id="Ops.Date_+3A_lop">lop</code></td>
<td>
<p>one of <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>
or <code>&gt;=</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x</code> does not need to be integer if specified as a numeric vector,
but see the comments about fractional days in the help for
<code><a href="#topic+Dates">Dates</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(z &lt;- Sys.Date())
z + 10
z &lt; c("2009-06-01", "2010-01-01", "2015-01-01")
</code></pre>

<hr>
<h2 id='options'>Options Settings</h2><span id='topic+options'></span><span id='topic+.Options'></span><span id='topic+getOption'></span><span id='topic+option'></span><span id='topic+MC_CORES'></span><span id='topic+R_C_BOUNDS_CHECK'></span><span id='topic+R_DEFAULT_DEVICE'></span><span id='topic+R_KEEP_PKG_SOURCE'></span><span id='topic+R_INTERACTIVE_DEVICE'></span>

<h3>Description</h3>

<p>Allow the user to set and examine a variety of global <em>options</em>
which affect the way in which <span class="rlang"><b>R</b></span> computes and displays its results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>options(...)

getOption(x, default = NULL)

.Options
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="options_+3A_...">...</code></td>
<td>
<p>any options can be defined, using <code>name = value</code>.
However, only the ones below are used in base <span class="rlang"><b>R</b></span>.
</p>
<p>Options can also be passed by giving a single unnamed argument which
is a named list.
</p>
</td></tr>
<tr><td><code id="options_+3A_x">x</code></td>
<td>
<p>a character string holding an option name.</p>
</td></tr>
<tr><td><code id="options_+3A_default">default</code></td>
<td>
<p>if the specified option is not set in the options list,
this value is returned.  This facilitates retrieving an option and
checking whether it is set and setting it separately if not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Invoking <code>options()</code> with no arguments returns a list with the
current values of the options.  Note that not all options listed below
are set initially.  To access the value of a single option, one should
use, e.g., <code>getOption("width")</code> rather than
<code>options("width")</code> which is a <em>list</em> of length one.
</p>


<h3>Value</h3>

<p>For <code>getOption</code>, the current value set for option <code>x</code>, or
<code>default</code> (which defaults to <code>NULL</code>) if the option is unset.
</p>
<p>For <code>options()</code>, a list of all set options sorted by name.  For
<code>options(name)</code>, a list of length one containing the set value,
or <code>NULL</code> if it is unset.  For uses setting one or more options,
a list with the previous values of the options changed (returned
invisibly).
</p>


<h3>Options used in base <span class="rlang"><b>R</b></span></h3>


<dl>
<dt><code>add.smooth</code>:</dt><dd><p>typically logical, defaulting to
<code>TRUE</code>.  Could also be set to an integer for specifying how
many (simulated) smooths should be added.  This is currently only
used by <code><a href="stats.html#topic+plot.lm">plot.lm</a></code>.</p>
</dd>
<dt><code>askYesNo</code>:</dt><dd><p>a function (typically set by a front-end)
to ask the user binary response functions in a consistent way,
or a vector of strings used by <code><a href="utils.html#topic+askYesNo">askYesNo</a></code> to use
as default responses for such questions.</p>
</dd>
<dt><code>browserNLdisabled</code>:</dt><dd><p>logical: whether newline is
disabled as a synonym for <code>"n"</code> in the browser.</p>
</dd>
<dt><code>catch.script.errors</code>:</dt><dd><p>logical, false by default.  If
true <em>and</em> <code><a href="#topic+interactive">interactive</a>()</code> is false, e.g., when an
<span class="rlang"><b>R</b></span> script is run by <code>R CMD <a href="utils.html#topic+BATCH">BATCH</a> &lt;script&gt;.R</code>, then
errors do <em>not</em> stop execution of the script.  Rather evaluation
continues after printing the error (and jumping to top level).
Also, <code><a href="#topic+traceback">traceback</a>()</code> would provide info about the error.
Do use with care!</p>
</dd>
<dt><code>checkPackageLicense</code>:</dt><dd><p>logical, not set by default.  If
true, <code><a href="#topic+loadNamespace">loadNamespace</a></code> asks a user to accept any
non-standard license at first load of the package.
</p>
</dd>
<dt><code>check.bounds</code>:</dt><dd><p>logical, defaulting to <code>FALSE</code>.  If
true, a <a href="#topic+warning">warning</a> is produced whenever a
vector (atomic or <code><a href="#topic+list">list</a></code>) is extended, by something
like <code>x &lt;- 1:3; x[5] &lt;- 6</code>.</p>
</dd>
<dt><code>CBoundsCheck</code>:</dt><dd><p>logical, controlling whether
<code><a href="#topic+.C">.C</a></code> and <code><a href="#topic+.Fortran">.Fortran</a></code> make copies to check for
array over-runs on the atomic vector arguments.
</p>
<p>Initially set from value of the environment variable
<span class="env">R_C_BOUNDS_CHECK</span> (set to <code>yes</code> to enable).</p>
</dd>
<dt><code>conflicts.policy</code>:</dt><dd><p>character string or list controlling
handling of conflicts found in calls to <code><a href="#topic+library">library</a></code> or
<code><a href="#topic+require">require</a></code>. See <code><a href="#topic+library">library</a></code> for details.</p>
</dd>
<dt><code>continue</code>:</dt><dd><p>a non-empty string setting the prompt used
for lines which continue over one line.</p>
</dd>

<dt><code>defaultPackages</code>:</dt><dd><p>the packages that are attached by
default when <span class="rlang"><b>R</b></span> starts up.  Initially set from the value of the
environment variable <span class="env">R_DEFAULT_PACKAGES</span>, or if that is unset
to <code>c("datasets", "utils", "grDevices", "graphics", "stats",
        "methods")</code>.  (Set <span class="env">R_DEFAULT_PACKAGES</span> to <code>NULL</code> or
a comma-separated list of package names.)
This option can be changed in a &lsquo;<span class="file">.Rprofile</span>&rsquo; file, but it will
not work to exclude the <span class="pkg">methods</span> package at this stage, as
the value is screened for <span class="pkg">methods</span> before that file is read.</p>
</dd>
<dt><code>deparse.cutoff</code>:</dt><dd><p>integer value controlling the
printing of language constructs which are <code><a href="#topic+deparse">deparse</a></code>d.
Default <code>60</code>.
</p>
</dd>
<dt><code>deparse.max.lines</code>:</dt><dd><p>controls the number of lines used
when deparsing in <code><a href="#topic+browser">browser</a></code>, upon entry to a function
whose debugging flag is set, and if option <code>traceback.max.lines</code>
is unset, of <code><a href="#topic+traceback">traceback</a>()</code>.  Initially unset, and only
used if set to a positive integer.</p>
</dd>
<dt><code>traceback.max.lines</code>:</dt><dd><p>controls the number of lines used
when deparsing in <code><a href="#topic+traceback">traceback</a></code>, if set.
Initially unset, and only used if set to a positive integer.</p>
</dd>
<dt><code>digits</code>:</dt><dd><p>controls the number of <em>significant</em> (see <code><a href="#topic+signif">signif</a></code>) digits to
print when printing numeric values.  It is a suggestion only.
Valid values are 1...22 with default 7.  See the note in
<code><a href="#topic+print.default">print.default</a></code> about values greater than 15.</p>
</dd>
<dt><code>digits.secs</code>:</dt><dd><p>controls the maximum number of digits to
print when formatting time values in seconds.  Valid values
are 0...6 with default 0 (equivalent to <code>NULL</code> which is used
when it is undefined as on vanilla startup).  See <code><a href="#topic+strftime">strftime</a></code>.</p>
</dd>
<dt><code>download.file.extra</code>:</dt><dd><p>Extra command-line argument(s) for
non-default methods: see <code><a href="utils.html#topic+download.file">download.file</a></code>.</p>
</dd>
<dt><code>download.file.method</code>:</dt><dd><p>Method to be used for
<code>download.file</code>.  Currently download methods
<code>"internal"</code>, <code>"wininet"</code> (Windows only),
<code>"libcurl"</code>, <code>"wget"</code> and <code>"curl"</code> are available.
If not set, <code>method = "auto"</code>
is chosen: see <code><a href="utils.html#topic+download.file">download.file</a></code>.</p>
</dd>
<dt><code>echo</code>:</dt><dd><p>logical.  Only used in non-interactive mode,
when it controls whether input is echoed.  Command-line option
<span class="option">--no-echo</span> sets this to <code>FALSE</code>, but otherwise
it starts the session as <code>TRUE</code>.</p>
</dd>
<dt><code>encoding</code>:</dt><dd><p>The name of an encoding, default
<code>"native.enc"</code>.  See <code><a href="#topic+connections">connections</a></code>.</p>
</dd>
<dt><code>error</code>:</dt><dd><p>either a function or an expression governing
the handling of non-catastrophic errors such as those generated by
<code><a href="#topic+stop">stop</a></code> as well as by signals and internally detected
errors.  If the option is a function, a call to that function,
with no arguments, is generated as the expression.  By default
the option is not set: see <code><a href="#topic+stop">stop</a></code> for the behaviour in
that case.  The functions <code><a href="utils.html#topic+dump.frames">dump.frames</a></code> and
<code><a href="utils.html#topic+recover">recover</a></code> provide alternatives that allow post-mortem
debugging.  Note that these need to specified as
e.g. <code>options(error = utils::recover)</code> in startup
files such as &lsquo;<span class="file"><a href="#topic+.Rprofile">.Rprofile</a></span>&rsquo;.</p>
</dd>
<dt><code>expressions</code>:</dt><dd><p>sets a limit on the number of nested
expressions that will be evaluated.  Valid values are
25...500000 with default 5000.  If you increase it, you may
also want to start <span class="rlang"><b>R</b></span> with a larger protection stack;
see <span class="option">--max-ppsize</span> in <code><a href="#topic+Memory">Memory</a></code>.  Note too that
you may cause a segfault from overflow of the C stack, and on OSes
where it is possible you may want to increase that.  Once the
limit is reached an error is thrown.  The current number under
evaluation can be found by calling <code><a href="#topic+Cstack_info">Cstack_info</a></code>.</p>
</dd>
<dt><code>interrupt</code>:</dt><dd><p>a function taking no arguments to be called
on a user interrupt if the interrupt condition is not otherwise
handled.</p>
</dd>
<dt><code>keep.parse.data</code>:</dt><dd><p>When internally storing source code
(<code>keep.source</code> is TRUE), also store parse data.  Parse data can
then be retrieved with <code><a href="utils.html#topic+getParseData">getParseData</a>()</code> and used e.g.  for
spell checking of string constants or syntax highlighting.  The value
has effect only when internally storing source code (see
<code>keep.source</code>).  The default is <code>TRUE</code>.</p>
</dd>
<dt><code>keep.parse.data.pkgs</code>:</dt><dd><p>As for <code>keep.parse.data</code>, used
only when packages are installed.  Defaults to <code>FALSE</code> unless the
environment variable <span class="env">R_KEEP_PKG_PARSE_DATA</span> is set to <code>yes</code>.
The space overhead of parse data can be substantial even after
compression and it causes performance overhead when loading packages.</p>
</dd>
<dt><code>keep.source</code>:</dt><dd><p>When <code>TRUE</code>, the source code for
functions (newly defined or loaded) is stored internally
allowing comments to be kept in the right places.  Retrieve the
source by printing or using <code>deparse(fn, control =
      "useSource")</code>.
</p>
<p>The default is <code><a href="#topic+interactive">interactive</a>()</code>, i.e., <code>TRUE</code> for
interactive use.</p>
</dd>

<dt><code>keep.source.pkgs</code>:</dt><dd><p>As for <code>keep.source</code>, used only
when packages are installed.  Defaults to <code>FALSE</code> unless the
environment variable <span class="env">R_KEEP_PKG_SOURCE</span> is set to <code>yes</code>.</p>
</dd>
<dt><code>matprod</code>:</dt><dd><p>a string selecting the implementation of
the matrix products <code><a href="#topic++25+2A+25">%*%</a></code>, <code><a href="#topic+crossprod">crossprod</a></code>, and
<code><a href="#topic+tcrossprod">tcrossprod</a></code> for double and complex vectors:
</p>

<dl>
<dt><code>"internal"</code></dt><dd><p>uses an unoptimized 3-loop algorithm
which correctly propagates <code><a href="#topic+NaN">NaN</a></code> and
<code><a href="#topic+Inf">Inf</a></code> values and is consistent in precision with
other summation algorithms inside <span class="rlang"><b>R</b></span> like <code><a href="#topic+sum">sum</a></code> or
<code><a href="#topic+colSums">colSums</a></code> (which now means that it uses a <code>long
	    double</code> accumulator for summation if available and enabled,
see <code><a href="#topic+capabilities">capabilities</a></code>).</p>
</dd>
<dt><code>"default"</code></dt><dd><p>uses BLAS to speed up computation, but
to ensure correct propagation of <code>NaN</code> and <code>Inf</code>
values it uses an unoptimized 3-loop algorithm for inputs that may
contain <code>NaN</code> or <code>Inf</code> values.  When deemed
beneficial for performance, <code>"default"</code> may call the
3-loop algorithm unconditionally, i.e., without checking the
input for <code>NaN</code>/<code>Inf</code> values.  The 3-loop algorithm uses
(only) a <code>double</code> accumulator for summation, which is
consistent with the reference BLAS implementation.</p>
</dd>
<dt><code>"blas"</code></dt><dd><p>uses BLAS unconditionally without any
checks and should be used with extreme caution.  BLAS
libraries do not propagate <code><a href="#topic+NaN">NaN</a></code> or
<code><a href="#topic+Inf">Inf</a></code> values correctly and for inputs with
<code>NaN</code>/<code>Inf</code> values the results may be undefined.</p>
</dd>
<dt><code>"default.simd"</code></dt><dd><p>is experimental and will likely be
removed in future versions of <span class="rlang"><b>R</b></span>.  It provides the same behavior
as <code>"default"</code>, but the check whether the input contains
<code>NaN</code>/<code>Inf</code> values is faster on some <abbr>SIMD</abbr> hardware.
On older systems it will run correctly, but may be much slower than
<code>"default"</code>.</p>
</dd>
</dl>

</dd>
<dt><code>max.print</code>:</dt><dd><p>integer, defaulting to <code>99999</code>.
<code><a href="#topic+print">print</a></code> or <code><a href="methods.html#topic+show">show</a></code> methods can make use of
this option, to limit the amount of information that is printed,
to something in the order of (and typically slightly less than)
<code>max.print</code> <em>entries</em>.</p>
</dd>
<dt><code>OutDec</code>:</dt><dd><p>character string containing a single
character.  The preferred character to be used as the decimal
point in output conversions, that is in printing, plotting,
<code><a href="#topic+format">format</a></code>, <code><a href="#topic+formatC">formatC</a></code> and
<code><a href="#topic+as.character">as.character</a></code> but not when
deparsing nor by <code><a href="#topic+sprintf">sprintf</a></code>
(which is sometimes used prior to printing).
</p>
</dd>
<dt><code>pager</code>:</dt><dd><p>the command used for displaying text files by
<code><a href="#topic+file.show">file.show</a></code>, details depending on the platform:
</p>

<dl>
<dt>On a unix-alike</dt><dd><p>defaults to &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/bin/pager</span>&rsquo;, which is a shell
script running the command-line specified by the environment
variable <span class="env">PAGER</span> whose default is set at configuration,
usually to <code>less</code>.</p>
</dd>
<dt>On Windows</dt><dd><p>defaults to <code>"internal"</code>, which uses a pager similar to the
GUI console.  Another possibility is <code>"console"</code> to use the
console itself.</p>
</dd>
</dl>

<p>Can be a character string or an <span class="rlang"><b>R</b></span> function, in which case it
needs to accept the arguments <code>(files, header,
	title, delete.file)</code> corresponding to the first four arguments of
<code><a href="#topic+file.show">file.show</a></code>.</p>
</dd>
<dt><code>papersize</code>:</dt><dd><p>the default paper format used by
<code><a href="grDevices.html#topic+postscript">postscript</a></code>;  set by environment variable
<span class="env">R_PAPERSIZE</span> when <span class="rlang"><b>R</b></span> is started: if that is unset or invalid
it defaults platform dependently
</p>

<dl>
<dt>on a unix-alike</dt><dd><p>to a value derived from the locale category
<code>LC_PAPER</code>, or if that is unavailable to a default set
when <span class="rlang"><b>R</b></span> was built.</p>
</dd>
<dt>on Windows</dt><dd><p>to <code>"a4"</code>, or <code>"letter"</code> in US and
Canadian locales.</p>
</dd>
</dl>
</dd>
<dt><code>PCRE_limit_recursion</code>:</dt><dd><p>Logical: should
<code><a href="#topic+grep">grep</a>(perl = TRUE)</code> and similar limit the maximal
recursion allowed when matching?  Only relevant for PCRE1 and
PCRE2 &lt;= 10.23.
</p>
<p>PCRE can be built not to use a recursion stack (see
<code><a href="#topic+pcre_config">pcre_config</a></code>), but it uses recursion by default with
a recursion limit of 10000000 which potentially needs a very large
C stack: see the discussion at
<a href="https://www.pcre.org/original/doc/html/pcrestack.html">https://www.pcre.org/original/doc/html/pcrestack.html</a>.  If
true, the limit is reduced using <span class="rlang"><b>R</b></span>'s estimate of the C stack size
available (if known), otherwise 10000.  If <code>NA</code>, the limit is
imposed only if any input string has 1000 or more bytes.  The
limit has no effect when PCRE's Just-in-Time compiler is used.</p>
</dd>
<dt><code>PCRE_study</code>:</dt><dd><p>Logical or integer: should
<code><a href="#topic+grep">grep</a>(perl = TRUE)</code> and similar &lsquo;study&rsquo; the
patterns?  Either logical or a numerical threshold for the minimum
number of strings to be matched for the pattern to be studied (the
default is <code>10</code>)).  Missing values and negative numbers are
treated as false.  This option is ignored with PCRE2 (PCRE version &gt;=
10.00) which does not have a separate study phase and patterns are
automatically optimized when possible.</p>
</dd>
<dt><code>PCRE_use_JIT</code>:</dt><dd><p>Logical: should <code><a href="#topic+grep">grep</a>(perl =
	TRUE)</code>, <code><a href="#topic+strsplit">strsplit</a>(perl = TRUE)</code> and similar make use
of PCRE's Just-In-Time compiler if available? (This applies only to
studied patterns with PCRE1.)  Default: true.  Missing values are
treated as false.</p>
</dd>
<dt><code>pdfviewer</code>:</dt><dd><p>default PDF viewer.
The default is set from the environment variable <span class="env">R_PDFVIEWER</span>,
the default value of which
</p>

<dl>
<dt>on a unix-alike</dt><dd><p>is set when <span class="rlang"><b>R</b></span> is configured, and</p>
</dd>
<dt>on Windows</dt><dd><p>is the full path to <code>open.exe</code>, a utility
supplied with <span class="rlang"><b>R</b></span>.</p>
</dd>
</dl>
</dd>
<dt><code>printcmd</code>:</dt><dd><p>the command used by <code><a href="grDevices.html#topic+postscript">postscript</a></code>
for printing; set by environment variable <span class="env">R_PRINTCMD</span> when
<span class="rlang"><b>R</b></span> is started.  This should be a command that expects either input
to be piped to &lsquo;<span class="file">stdin</span>&rsquo; or to be given a single filename
argument.  Usually set to <code>"lpr"</code> on a Unix-alike.</p>
</dd>
<dt><code>prompt</code>:</dt><dd><p>a non-empty string to be used for <span class="rlang"><b>R</b></span>'s prompt;
should usually end in a blank (<code>" "</code>).</p>
</dd>

<dt><code>rl_word_breaks</code>:</dt><dd><p>(Unix only:) Used for the readline-based terminal
interface.  Default value <code>" \t\n\"\\'`&gt;&lt;=%;,|&amp;{()}"</code>.
</p>
<p>This is the set of characters use to break the input line into
tokens for object- and file-name completion.  Those who do not use
spaces around operators may prefer<br />
<code>" \t\n\"\\'`&gt;&lt;=+-*%;,|&amp;{()}"</code>
</p>
</dd>
<dt><code>save.defaults</code>, <code>save.image.defaults</code>:</dt><dd>
<p>see <code><a href="#topic+save">save</a></code>.</p>
</dd>
<dt><code>scipen</code>:</dt><dd><p>integer.  A penalty to be applied
when deciding to print numeric values in fixed or exponential
notation.  Positive values bias towards fixed and negative towards
scientific notation: fixed notation will be preferred unless it is
more than <code>scipen</code> digits wider.</p>
</dd>
<dt><code>setWidthOnResize</code>:</dt><dd><p>a logical. If set and <code>TRUE</code>, <span class="rlang"><b>R</b></span>
run in a terminal using a recent <code>readline</code> library will set
the <code>width</code> option when the terminal is resized.</p>
</dd>
<dt><code>showWarnCalls</code>, <code>showErrorCalls</code>:</dt><dd><p>a logical.
Should warning and error messages produced by the default handlers
show a summary of the call stack?  By default error call stacks
are shown in non-interactive sessions. When <code><a href="#topic+warning">warning</a></code>
or <code><a href="#topic+stop">stop</a></code> are called on a condition object the call
stacks are only shown if the value returned by
<code><a href="#topic+conditionCall">conditionCall</a></code> for the condition object is not
<code>NULL</code>.</p>
</dd>
<dt><code>showNCalls</code>:</dt><dd><p>integer.  Controls how long the sequence
of calls must be (in bytes) before ellipses are used.  Defaults to
50 and should be at least 30 and no more than 500.</p>
</dd>
<dt><code>show.error.locations</code>:</dt><dd><p>Should source locations of
errors be printed?  If set to <code>TRUE</code> or <code>"top"</code>, the
source location that is highest on the stack (the most recent
call) will be printed.  <code>"bottom"</code> will print the location
of the earliest call found on the stack.
</p>
<p>Integer values can select other entries.  The value <code>0</code>
corresponds to <code>"top"</code> and positive values count down the
stack from there.  The value <code>-1</code> corresponds to
<code>"bottom"</code> and negative values count up from there.
</p>
</dd>
<dt><code>show.error.messages</code>:</dt><dd><p>a logical.  Should error messages
be printed?  Intended for use with <code><a href="#topic+try">try</a></code> or a
user-installed error handler.</p>
</dd>




<dt><code>texi2dvi</code>:</dt><dd><p>used by functions
<code><a href="tools.html#topic+texi2dvi">texi2dvi</a></code> and <code><a href="tools.html#topic+texi2pdf">texi2pdf</a></code> in package <span class="pkg">tools</span>.
</p>

<dl>
<dt>unix-alike only:</dt><dd>
<p>Set at startup from the environment variable <span class="env">R_TEXI2DVICMD</span>,
which defaults first to the value of environment variable
<span class="env">TEXI2DVI</span>, and then to a value set when <span class="rlang"><b>R</b></span> was installed (the
full path to a <code>texi2dvi</code> script if one was found).  If
necessary, that environment variable can be set to
<code>"emulation"</code>.
</p>
</dd> </dl>

</dd>
<dt><code>timeout</code>:</dt><dd><p>positive integer.  The timeout for some
Internet operations, in seconds.  Default 60 (seconds) but can be
set from environment variable
<span class="env">R_DEFAULT_INTERNET_TIMEOUT</span>. (Invalid values of the option or
the variable are silently ignored: non-integer numeric values will
be truncated.)  See <code><a href="utils.html#topic+download.file">download.file</a></code> and
<code><a href="#topic+connections">connections</a></code>.</p>
</dd>
<dt><code>topLevelEnvironment</code>:</dt><dd><p>see <code><a href="#topic+topenv">topenv</a></code> and
<code><a href="#topic+sys.source">sys.source</a></code>.</p>
</dd>
<dt><code>url.method</code>:</dt><dd><p>character string: the default method for
<code><a href="#topic+url">url</a></code>.  Normally unset, which is equivalent to
<code>"default"</code>, which is <code>"internal"</code> except on Windows.</p>
</dd>
<dt><code>useFancyQuotes</code>:</dt><dd><p>controls the use of
directional quotes in <code><a href="#topic+sQuote">sQuote</a></code>, <code>dQuote</code> and in
rendering text help (see <code><a href="tools.html#topic+Rd2txt">Rd2txt</a></code> in package
<span class="pkg">tools</span>).  Can be <code>TRUE</code>, <code>FALSE</code>, <code>"TeX"</code> or
<code>"UTF-8"</code>.</p>
</dd>
<dt><code>verbose</code>:</dt><dd><p>logical.  Should <span class="rlang"><b>R</b></span> report extra information
on progress?  Set to <code>TRUE</code> by the command-line option
<span class="option">--verbose</span>.</p>
</dd>
<dt><code>warn</code>:</dt><dd><p>integer value to set the handling of warning
messages by the default warning handler.  If
<code>warn</code> is negative all warnings are ignored.  If <code>warn</code>
is zero (the default) warnings are stored until the top&ndash;level
function returns.  If 10 or fewer warnings were signalled they
will be printed otherwise a message saying how many were
signalled.  An object called <code>last.warning</code> is
created and can be printed through the function
<code><a href="#topic+warnings">warnings</a></code>.  If <code>warn</code> is one, warnings are
printed as they occur.  If <code>warn</code> is two (or larger, coercible
to integer), all warnings are turned into errors. While sometimes
useful for debugging, turning warnings into errors may trigger
bugs and resource leaks that would not have been triggered otherwise.</p>
</dd>
<dt><code>warnPartialMatchArgs</code>:</dt><dd><p>logical.  If true, warns if
partial matching is used in argument matching.</p>
</dd>
<dt><code>warnPartialMatchAttr</code>:</dt><dd><p>logical.  If true, warns if
partial matching is used in extracting attributes via
<code><a href="#topic+attr">attr</a></code>.</p>
</dd>
<dt><code>warnPartialMatchDollar</code>:</dt><dd><p>logical.  If true, warns if
partial matching is used for extraction by <code>$</code>.</p>
</dd>
<dt><code>warning.expression</code>:</dt><dd><p>an <span class="rlang"><b>R</b></span> code expression to be called
if a warning is generated, replacing the standard message.  If
non-null it is called irrespective of the value of option
<code>warn</code>.</p>
</dd>
<dt><code>warning.length</code>:</dt><dd><p>sets the truncation limit in bytes for error
and warning messages.  A non-negative integer, with allowed values
100...8170, default 1000.</p>
</dd>
<dt><code>nwarnings</code>:</dt><dd><p>the limit for the number of warnings kept
when <code>warn = 0</code>, default 50.  This will discard messages if
called whilst they are being collected.  If you increase this
limit, be aware that the current implementation pre-allocates
the equivalent of a named list for them, i.e., do not increase it to
more than say a million.</p>
</dd>
<dt><code>width</code>:</dt><dd><p>controls the maximum number of columns on a
line used in printing vectors, matrices and arrays, and when
filling by <code><a href="#topic+cat">cat</a></code>.
</p>
<p>Columns are normally the same as characters except in East Asian
languages.
</p>
<p>You may want to change this if you re-size the window that <span class="rlang"><b>R</b></span> is
running in.  Valid values are 10...10000 with default normally
80.  (The limits on valid values are in file &lsquo;<span class="file">Print.h</span>&rsquo; and can be
changed by re-compiling <span class="rlang"><b>R</b></span>.)  Some <span class="rlang"><b>R</b></span> consoles automatically change
the value when they are resized.
</p>
<p>See the examples on <a href="#topic+Startup">Startup</a> for one way to set this
automatically from the terminal width when <span class="rlang"><b>R</b></span> is started.
</p>
</dd>
</dl>

<p>The &lsquo;factory-fresh&rsquo; default settings of some of these options are
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>add.smooth</code> </td><td style="text-align: left;"> <code>TRUE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>check.bounds</code> </td><td style="text-align: left;"> <code>FALSE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>continue</code> </td><td style="text-align: left;"> <code>"+ "</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>digits</code> </td><td style="text-align: left;"> <code>7</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>echo</code> </td><td style="text-align: left;"> <code>TRUE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>encoding</code> </td><td style="text-align: left;"> <code>"native.enc"</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>error</code> </td><td style="text-align: left;"> <code>NULL</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>expressions</code> </td><td style="text-align: left;"> <code>5000</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>keep.source</code> </td><td style="text-align: left;"> <code>interactive()</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>keep.source.pkgs</code> </td><td style="text-align: left;"> <code>FALSE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>max.print</code> </td><td style="text-align: left;"> <code>99999</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>OutDec</code> </td><td style="text-align: left;"> <code>"."</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>prompt</code> </td><td style="text-align: left;"> <code>"&gt; "</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>scipen</code> </td><td style="text-align: left;"> <code>0</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>show.error.messages</code> </td><td style="text-align: left;"> <code>TRUE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>timeout</code> </td><td style="text-align: left;"> <code>60</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>verbose</code> </td><td style="text-align: left;"> <code>FALSE</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>warn</code> </td><td style="text-align: left;"> <code>0</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>warning.length</code> </td><td style="text-align: left;"> <code>1000</code></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>width</code>  </td><td style="text-align: left;"> <code>80</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Others are set from environment variables or are platform-dependent.
</p>


<h3>Options set in package <span class="pkg">grDevices</span></h3>

<p>These will be set when package <span class="pkg">grDevices</span> (or its namespace)
is loaded if not already set.
</p>

<dl>
<dt><code>bitmapType</code>:</dt><dd><p>(Unix only, incl. macOS) character.  The
default type for the
bitmap devices such as <code><a href="grDevices.html#topic+png">png</a></code>.  Defaults to
<code>"cairo"</code> on systems where that is available, or to
<code>"quartz"</code> on macOS where that is available.</p>
</dd>
<dt><code>device</code>:</dt><dd><p>a character string giving
the name of a function, or the function object itself,
which when called creates a new graphics device of the default
type for that session.  The value of this option defaults to the
normal screen device (e.g., <code>X11</code>, <code>windows</code> or
<code>quartz</code>) for an interactive session, and <code>pdf</code>
in batch use or if a screen is not available.  If set to the name
of a device, the device is looked for first from the global
environment (that is down the usual search path) and then in the
<span class="pkg">grDevices</span> namespace.
</p>
<p>The default values in interactive and non-interactive sessions are
configurable via environment variables
<span class="env">R_INTERACTIVE_DEVICE</span> and <span class="env">R_DEFAULT_DEVICE</span>
respectively.
</p>
<p>The search logic for &lsquo;the normal screen device&rsquo; is that
this is <code>windows</code> on Windows, and <code>quartz</code> if available
on macOS (running at the console, and compiled into the build).
Otherwise <code>X11</code> is used if environment variable <span class="env">DISPLAY</span>
is set.
</p>
</dd>
<dt><code>device.ask.default</code>:</dt><dd><p>logical.  The default for
<code><a href="grDevices.html#topic+devAskNewPage">devAskNewPage</a>("ask")</code> when a device is opened.</p>
</dd>
<dt><code>locatorBell</code>:</dt><dd><p>logical.  Should selection in <code>locator</code>
and <code>identify</code> be confirmed by a bell?  Default <code>TRUE</code>.
Honoured at least on <code>X11</code> and <code>windows</code> devices.</p>
</dd>
<dt><code>windowsTimeout</code>:</dt><dd><p>(Windows-only) integer vector of length 2
representing two times in milliseconds.  These control the
double-buffering of <code><a href="grDevices.html#topic+windows">windows</a></code> devices when that is
enabled: the first is the delay after plotting finishes
(default 100) and the second is the update interval during
continuous plotting (default 500).  The values at the time the
device is opened are used.</p>
</dd>
</dl>



<h3>Other options used by package graphics</h3>


<dl>
<dt><code>max.contour.segments</code>:</dt><dd><p>positive integer, defaulting to
<code>25000</code> if not set.  A limit on the number of
segments in a single contour line in <code><a href="graphics.html#topic+contour">contour</a></code> or
<code><a href="grDevices.html#topic+contourLines">contourLines</a></code>.</p>
</dd>
</dl>



<h3>Options set in package stats</h3>

<p>These will be set when package <span class="pkg">stats</span> (or its namespace)
is loaded if not already set.
</p>

<dl>
<dt><code>contrasts</code>:</dt><dd><p>the default <code><a href="stats.html#topic+contrasts">contrasts</a></code> used in
model fitting such as with <code><a href="stats.html#topic+aov">aov</a></code> or <code><a href="stats.html#topic+lm">lm</a></code>.
A character vector of length two, the first giving the function to
be used with unordered factors and the second the function to be
used with ordered factors.  By default the elements are named
<code>c("unordered", "ordered")</code>, but the names are unused.</p>
</dd>
<dt><code>na.action</code>:</dt><dd><p>the name of a function for treating missing
values (<code><a href="#topic+NA">NA</a></code>'s) for certain situations, see
<code><a href="stats.html#topic+na.action">na.action</a></code> and <code><a href="stats.html#topic+na.pass">na.pass</a></code>.</p>
</dd>
<dt><code>show.coef.Pvalues</code>:</dt><dd><p>logical, affecting whether P
values are printed in summary tables of coefficients.  See
<code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code>.</p>
</dd>
<dt><code>show.nls.convergence</code>:</dt><dd><p>logical, should <code><a href="stats.html#topic+nls">nls</a></code>
convergence messages be printed for successful fits?</p>
</dd>
<dt><code>show.signif.stars</code>:</dt><dd><p>logical, should stars be printed on
summary tables of coefficients?  See <code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code>.</p>
</dd>
<dt><code>ts.eps</code>:</dt><dd><p>the relative tolerance for certain time series
(<code><a href="stats.html#topic+ts">ts</a></code>) computations.  Default <code>1e-05</code>.</p>
</dd>
<dt><code>ts.S.compat</code>:</dt><dd><p>logical.  Used to select S compatibility
for plotting time-series spectra.  See the description of argument
<code>log</code> in <code><a href="stats.html#topic+plot.spec">plot.spec</a></code>.</p>
</dd>
</dl>



<h3>Options set (or used) in package utils</h3>

<p>These will be set (apart from <code>Ncpus</code>) when package <span class="pkg">utils</span>
(or its namespace) is loaded if not already set.
</p>

<dl>
<dt><code>BioC_mirror</code>:</dt><dd><p>The URL of a Bioconductor mirror
for use by <code><a href="utils.html#topic+setRepositories">setRepositories</a></code>,
e.g. the default &lsquo;<span class="samp">&#8288;"https://bioconductor.org"&#8288;</span>&rsquo;
or the European mirror
&lsquo;<span class="samp">&#8288;"https://bioconductor.statistik.tu-dortmund.de"&#8288;</span>&rsquo;.  Can be set
by <code><a href="utils.html#topic+chooseBioCmirror">chooseBioCmirror</a></code>.</p>
</dd>
<dt><code>browser</code>:</dt><dd><p>The HTML browser to be used by
<code><a href="utils.html#topic+browseURL">browseURL</a></code>.  This sets the default browser on UNIX or
a non-default browser on Windows.  Alternatively, an <span class="rlang"><b>R</b></span> function
that is called with a URL as its argument.  See
<code><a href="utils.html#topic+browseURL">browseURL</a></code> for further details.</p>
</dd>
<dt><code>ccaddress</code>:</dt><dd><p>default Cc: address used by
<code><a href="utils.html#topic+create.post">create.post</a></code> (and hence <code><a href="utils.html#topic+bug.report">bug.report</a></code> and
<code><a href="utils.html#topic+help.request">help.request</a></code>).  Can be <code>FALSE</code> or <code>""</code>.</p>
</dd>
<dt><code>citation.bibtex.max</code>:</dt><dd><p>default 1; the maximal number of
bibentries (<code><a href="utils.html#topic+bibentry">bibentry</a></code>) in a <code><a href="utils.html#topic+citation">citation</a></code> for
which the BibTeX version is printed in addition to the text one.</p>
</dd>
<dt><code>de.cellwidth</code>:</dt><dd><p>integer: the cell widths (number of
characters) to be used in the data editor <code><a href="utils.html#topic+dataentry">dataentry</a></code>.
If this is unset (the default), 0, negative or <code>NA</code>, variable
cell widths are used.</p>
</dd>
<dt><code>demo.ask</code>:</dt><dd><p>default for the <code>ask</code> argument of
<code><a href="utils.html#topic+demo">demo</a></code>.</p>
</dd>
<dt><code>editor</code>:</dt><dd><p>a non-empty character string or an <span class="rlang"><b>R</b></span> function
that sets the default text editor, e.g., for <code><a href="utils.html#topic+edit">edit</a></code>
and <code><a href="utils.html#topic+file.edit">file.edit</a></code>.  Set from the environment variable
<span class="env">EDITOR</span> on UNIX, or if unset <span class="env">VISUAL</span> or <code>vi</code>.
As a string it should specify the name of or path to an external
command.</p>
</dd>
<dt><code>example.ask</code>:</dt><dd><p>default for the <code>ask</code> argument of
<code><a href="utils.html#topic+example">example</a></code>.</p>
</dd>
<dt><code>help.ports</code>:</dt><dd><p>optional integer vector for setting ports
of the internal HTTP server, see <code><a href="tools.html#topic+startDynamicHelp">startDynamicHelp</a></code>.</p>
</dd>
<dt><code>help.search.types</code>:</dt><dd><p>default types of documentation
to be searched by <code><a href="utils.html#topic+help.search">help.search</a></code> and <code><a href="utils.html#topic++3F+3F">??</a></code>.</p>
</dd>
<dt><code>help.try.all.packages</code>:</dt><dd><p>default for an argument of
<code><a href="utils.html#topic+help">help</a></code>.</p>
</dd>
<dt><code>help_type</code>:</dt><dd><p>default for an argument of
<code><a href="utils.html#topic+help">help</a></code>, used also as the help type by <code><a href="utils.html#topic++3F">?</a></code>.</p>
</dd>
<dt><code>help.htmlmath</code>:</dt><dd><p>default for the <code>texmath</code> argument
of <code><a href="tools.html#topic+Rd2HTML">Rd2HTML</a></code>, controlling how LaTeX-like mathematical
equations are displayed in R help pages (if enabled). Useful
values are <code>"katex"</code> (equivalent to <code>NULL</code>, the default)
and <code>"mathjax"</code>; for all other values basic substitutions are
used. </p>
</dd>
<dt><code>help.htmltoc</code>:</dt><dd><p>default for the <code>toc</code> argument
of <code><a href="tools.html#topic+Rd2HTML">Rd2HTML</a></code>, controlling whether a table of contents
should be included. </p>
</dd>
<dt><code>HTTPUserAgent</code>:</dt><dd><p>string used as the &lsquo;user agent&rsquo; in
HTTP(S) requests by <code><a href="utils.html#topic+download.file">download.file</a></code>, <code><a href="#topic+url">url</a></code>
and <code><a href="#topic+curlGetHeaders">curlGetHeaders</a></code>, or <code>NULL</code> when requests will
be made without a user agent header.  The default is
<code>"R (<var>version</var> <var>platform</var> <var>arch</var> <var>os</var>)"</code>
except when &lsquo;<span class="samp">&#8288;libcurl&#8288;</span>&rsquo; is used when it is
<code>"libcurl/<var>version</var>"</code> for the &lsquo;<span class="samp">&#8288;libcurl&#8288;</span>&rsquo; version in use.</p>
</dd>
<dt><code>install.lock</code>:</dt><dd><p>logical: should per-directory package
locking be used by <code><a href="utils.html#topic+install.packages">install.packages</a></code>?  Most useful
for binary installs on macOS and Windows, but can be used in a
startup file for source installs <em>via</em>
<code>R CMD <a href="utils.html#topic+INSTALL">INSTALL</a></code>.  For binary installs, can also be
the character string <code>"pkglock"</code>.</p>
</dd>
<dt><code>internet.info</code>:</dt><dd><p>The minimum level of information to be
printed on URL downloads etc, using the <code>"internal"</code> and
<code>"libcurl"</code> methods.
Default is 2, for failure causes.  Set to 1 or 0 to get more
detailed information (for the <code>"internal"</code> method 0 provides
more information than 1).
</p>
</dd>
<dt><code>install.packages.check.source</code>:</dt><dd><p>Used by
<code><a href="utils.html#topic+install.packages">install.packages</a></code> (and indirectly
<code><a href="utils.html#topic+update.packages">update.packages</a></code>) on platforms which support binary
packages.  Possible values <code>"yes"</code> and <code>"no"</code>, with
unset being equivalent to <code>"yes"</code>.</p>
</dd>
<dt><code>install.packages.compile.from.source</code>:</dt><dd><p>Used by
<code><a href="utils.html#topic+install.packages">install.packages</a>(type = "both")</code> (and indirectly
<code><a href="utils.html#topic+update.packages">update.packages</a></code>) on platforms which
support binary packages.  Possible values are <code>"never"</code>,
<code>"interactive"</code> (which means ask in interactive use and
<code>"never"</code> in batch use) and <code>"always"</code>.  The default is
taken from environment variable
<span class="env">R_COMPILE_AND_INSTALL_PACKAGES</span>, with default
<code>"interactive"</code> if unset.  However, <code>install.packages</code>
uses <code>"never"</code> unless a <code>make</code> program is found,
consulting the environment variable <span class="env">MAKE</span>.</p>
</dd>
<dt><code>mailer</code>:</dt><dd><p>default emailing method used by
<code><a href="utils.html#topic+create.post">create.post</a></code> and hence <code><a href="utils.html#topic+bug.report">bug.report</a></code> and
<code><a href="utils.html#topic+help.request">help.request</a></code>.</p>
</dd>
<dt><code>menu.graphics</code>:</dt><dd><p>Logical: should graphical menus be used
if available?  Defaults to <code>TRUE</code>.  Currently applies to
<code><a href="utils.html#topic+select.list">select.list</a></code>, <code><a href="utils.html#topic+chooseCRANmirror">chooseCRANmirror</a></code>,
<code><a href="utils.html#topic+setRepositories">setRepositories</a></code> and to select from multiple (text)
help files in <code><a href="utils.html#topic+help">help</a></code>.</p>
</dd>
<dt><code>Ncpus</code>:</dt><dd><p>an integer <code class="reqn">n \ge 1</code>, used in
<code><a href="utils.html#topic+install.packages">install.packages</a></code> as default for the number of CPUs
to use in a potentially parallel installation, as
<code>Ncpus = getOption("Ncpus", 1L)</code>, i.e., when unset is
equivalent to a setting of 1.</p>
</dd>
<dt><code>pkgType</code>:</dt><dd><p>The default type of packages to be downloaded
and installed &ndash; see <code><a href="utils.html#topic+install.packages">install.packages</a></code>.
Possible values are platform dependently
</p>

<dl>
<dt>on Windows</dt><dd>
<p><code>"win.binary"</code>, <code>"source"</code> and
<code>"both"</code> (the default).</p>
</dd>
<dt>on Unix-alikes</dt><dd><p><code>"source"</code> (the default except under a
CRAN macOS build), <code>"mac.binary"</code> and
<code>"both"</code> (the default for CRAN macOS builds).
(<code>"mac.binary.el-capitan"</code>,
<code>"mac.binary.mavericks"</code>, <code>"mac.binary.leopard"</code>
and <code>"mac.binary.universal"</code> are no longer in use.)</p>
</dd>
</dl>

<p>Value <code>"binary"</code> is a synonym for the native binary type (if
there is one); <code>"both"</code> is used by
<code><a href="utils.html#topic+install.packages">install.packages</a></code> to choose between source and binary
installs.
</p>
</dd>
<dt><code>repos</code>:</dt><dd><p>character vector of repository URLs for use by
<code><a href="utils.html#topic+available.packages">available.packages</a></code> and related functions.  Initially
set from entries marked as default in the
&lsquo;<span class="file"><a href="utils.html#topic+R_REPOSITORIES">repositories</a></span>&rsquo; file,
whose path is configurable via environment variable <span class="env">R_REPOSITORIES</span>
(set this to <code>NULL</code> to skip initialization at startup).
The &lsquo;factory-fresh&rsquo; setting from the file in <code>R.home("etc")</code> is
<code>c(CRAN="@CRAN@")</code>, a value that causes some utilities to
prompt for a CRAN mirror.  To avoid this do set the CRAN mirror,
by something like </p>
<pre>
local({
    r &lt;- getOption("repos")
    r["CRAN"] &lt;- "https://my.local.cran"
    options(repos = r)
})
</pre>
<p>in your &lsquo;<span class="file"><a href="#topic+.Rprofile">.Rprofile</a></span>&rsquo;,
or use a personal &lsquo;<span class="file">repositories</span>&rsquo; file.
</p>
<p>Note that you can add more repositories (Bioconductor,
R-Forge, RForge.net, ...) for the current session
using <code><a href="utils.html#topic+setRepositories">setRepositories</a></code>.
</p>
</dd>
<dt><code>str</code>:</dt><dd><p>a list of options controlling the default
<code><a href="utils.html#topic+str">str</a></code> display. Defaults to <code><a href="utils.html#topic+strOptions">strOptions</a>()</code>.</p>
</dd>
<dt><code>str.dendrogram.last</code>:</dt><dd><p>see <code><a href="stats.html#topic+str.dendrogram">str.dendrogram</a></code>.</p>
</dd>
<dt><code>SweaveHooks</code>, <code>SweaveSyntax</code>:</dt><dd>
<p>see <code><a href="utils.html#topic+Sweave">Sweave</a></code>.
</p>
</dd>
<dt><code>unzip</code>:</dt><dd><p>a character string used by <code><a href="utils.html#topic+unzip">unzip</a></code>:
the path of the external program <code>unzip</code> or <code>"internal"</code>.
Defaults (platform dependently)
</p>

<dl>
<dt>on unix-alikes</dt><dd><p>to the value of <span class="env">R_UNZIPCMD</span>, which is set in
&lsquo;<span class="file">etc/Renviron</span>&rsquo; to the path of the <code>unzip</code> command found
during configuration and otherwise to <code>""</code>.</p>
</dd>
<dt>on Windows</dt><dd><p>to <code>"internal"</code> when the internal unzip
code is used.</p>
</dd>
</dl>

</dd>
</dl>



<h3>Options set in package parallel</h3>

<p>These will be set when package <span class="pkg">parallel</span> (or its namespace)
is loaded if not already set.
</p>

<dl>
<dt><code>mc.cores</code>:</dt><dd><p>an integer giving the maximum allowed number
of <em>additional</em> <span class="rlang"><b>R</b></span> processes allowed to be run in parallel to
the current <span class="rlang"><b>R</b></span> process.  Defaults to the setting of the
environment variable <span class="env">MC_CORES</span> if set.  Most applications
which use this assume a limit of <code>2</code> if it is unset.
</p>
</dd>
</dl>



<h3>Options used on Unix only</h3>


<dl>
<dt><code>dvipscmd</code>:</dt><dd><p>character string giving a command to be used in
the (deprecated) off-line printing of help pages <em>via</em>
PostScript.  Defaults to <code>"dvips"</code>.</p>
</dd>
</dl>



<h3>Options used on Windows only</h3>


<dl>
<dt><code>warn.FPU</code>:</dt><dd><p>logical, by default undefined.  If true,
a <a href="#topic+warning">warning</a> is produced whenever <a href="#topic+dyn.load">dyn.load</a> repairs the
control word damaged by a buggy DLL.</p>
</dd>
</dl>



<h3>Note</h3>

<p>For compatibility with S there is a visible object <code>.Options</code> whose
value is a pairlist containing  the current <code>options()</code> (in no
particular order).  Assigning to it will make a local copy and not
change the original. (<em>Using</em> it however is faster than calling
<code>options()</code>).
</p>
<p>An option set to <code>NULL</code> is indistinguishable from a non existing
option.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- options(); utils::str(op) # op is a named list

getOption("width") == options()$width # the latter needs more memory
options(digits = 15)
pi

# set the editor, and save previous value
old.o &lt;- options(editor = "nedit")
old.o

options(check.bounds = TRUE, warn = 1)
x &lt;- NULL; x[4] &lt;- "yes" # gives a warning

options(digits = 5)
print(1e5)
options(scipen = 3); print(1e5)

options(op)     # reset (all) initial options
options("digits")

## Not run: ## set contrast handling to be like S
options(contrasts = c("contr.helmert", "contr.poly"))

## End(Not run)

## Not run: ## on error, terminate the R session with error status 66
options(error = quote(q("no", status = 66, runLast = FALSE)))
stop("test it")

## End(Not run)

## Not run: ## Set error actions for debugging:
## enter browser on error, see ?recover:
options(error = recover)
## allows to call debugger() afterwards, see ?debugger:
options(error = dump.frames)
## A possible setting for non-interactive sessions
options(error = quote({dump.frames(to.file = TRUE); q()}))

## End(Not run)

  # Compare the two ways to get an option and use it
  # acconting for the possibility it might not be set.
if(as.logical(getOption("performCleanp", TRUE)))
   cat("do cleanup\n")

## Not run: 
  # a clumsier way of expressing the above w/o the default.
tmp &lt;- getOption("performCleanup")
if(is.null(tmp))
  tmp &lt;- TRUE
if(tmp)
   cat("do cleanup\n")

## End(Not run)

</code></pre>

<hr>
<h2 id='order'>Ordering Permutation</h2><span id='topic+order'></span><span id='topic+sort.list'></span>

<h3>Description</h3>

<p><code>order</code> returns a permutation which rearranges its first
argument into ascending or descending order, breaking ties by further
arguments.  <code>sort.list</code> does the same, using only one argument.<br />
See the examples for how to use these functions to sort data frames,
etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>order(..., na.last = TRUE, decreasing = FALSE,
      method = c("auto", "shell", "radix"))

sort.list(x, partial = NULL, na.last = TRUE, decreasing = FALSE,
          method = c("auto", "shell", "quick", "radix"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="order_+3A_...">...</code></td>
<td>
<p>a sequence of numeric, complex, character or logical
vectors, all of the same length, or a classed <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="order_+3A_x">x</code></td>
<td>
<p>an atomic vector for <code>method</code>s <code>"shell"</code> and
<code>"quick"</code>.  When <code>x</code> is a non-atomic <span class="rlang"><b>R</b></span> object, the default
<code>"auto"</code> and <code>"radix"</code> methods may work if <code>order(x,..)</code>
does.</p>
</td></tr>
<tr><td><code id="order_+3A_partial">partial</code></td>
<td>
<p>vector of indices for partial sorting.
(Non-<code>NULL</code> values are not implemented.)</p>
</td></tr>
<tr><td><code id="order_+3A_decreasing">decreasing</code></td>
<td>
<p>logical.  Should the sort order be increasing or
decreasing? For the <code>"radix"</code> method, this can be a vector of
length equal to the number of arguments in <code>...</code> and the
elements are recycled as necessary.
For the other methods, it must be length one.</p>
</td></tr>
<tr><td><code id="order_+3A_na.last">na.last</code></td>
<td>
<p>for controlling the treatment of <code>NA</code>s.
If <code>TRUE</code>, missing values in the data are put last; if
<code>FALSE</code>, they are put first; if <code>NA</code>, they are removed
(see &lsquo;Note&rsquo;.)</p>
</td></tr>
<tr><td><code id="order_+3A_method">method</code></td>
<td>
<p>the method to be used: partial matches are allowed.  The
default (<code>"auto"</code>) implies <code>"radix"</code> for numeric vectors,
integer vectors, logical vectors and factors with fewer than
<code class="reqn">2^{31}</code> elements. Otherwise, it implies <code>"shell"</code>.
For details of methods <code>"shell"</code>, <code>"quick"</code>, and <code>"radix"</code>,
see the help for <code><a href="#topic+sort">sort</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the case of ties in the first vector, values in the second are used
to break the ties.  If the values are still tied, values in the later
arguments are used to break the tie (see the first example).
The sort used is <em>stable</em> (except for <code>method = "quick"</code>),
so any unresolved ties will be left in their original ordering.
</p>
<p>Complex values are sorted first by the real part, then the imaginary
part.
</p>
<p>Except for method <code>"radix"</code>, the sort order for character vectors
will depend on the collating sequence of the locale in use: see
<code><a href="#topic+Comparison">Comparison</a></code>.
</p>
<p>The <code>"shell"</code> method is generally the safest bet and is the
default method, except for short factors, numeric vectors, integer
vectors and logical vectors, where <code>"radix"</code> is assumed.  Method
<code>"radix"</code> stably sorts logical, numeric and character vectors in
linear time. It outperforms the other methods, although there are
drawbacks, especially for character vectors (see <code><a href="#topic+sort">sort</a></code>).
Method <code>"quick"</code> for <code>sort.list</code> is only supported for
numeric <code>x</code> with <code>na.last = NA</code>, is not stable, and is
slower than <code>"radix"</code>.
</p>
<p><code>partial = NULL</code> is supported for compatibility with other
implementations of S, but no other values are accepted and ordering is
always complete.
</p>
<p>For a classed <span class="rlang"><b>R</b></span> object, the sort order is taken from
<code><a href="#topic+xtfrm">xtfrm</a></code>: as its help page notes, this can be slow unless a
suitable method has been defined or <code><a href="#topic+is.numeric">is.numeric</a>(x)</code> is
true.  For factors, this sorts on the internal codes, which is
particularly appropriate for ordered factors.
</p>


<h3>Value</h3>

<p>An integer vector unless any of the inputs has <code class="reqn">2^{31}</code> or
more elements, when it is a double vector.
</p>


<h3>Warning</h3>

<p>In programmatic use it is unsafe to name the <code>...</code> arguments,
as the names could match current or future control
arguments such as <code>decreasing</code>.  A sometimes-encountered unsafe
practice is to call <code>do.call('order', df_obj)</code> where
<code>df_obj</code> might be a data frame: copy <code>df_obj</code> and
remove any names, for example using <code><a href="#topic+unname">unname</a></code>.
</p>


<h3>Note</h3>

<p><code>sort.list</code> can get called by mistake as a method for
<code><a href="#topic+sort">sort</a></code> with a list argument: it gives a suitable error
message for list <code>x</code>.
</p>
<p>There is a historical difference in behaviour for <code>na.last = NA</code>:
<code>sort.list</code> removes the <code>NA</code>s and then computes the order
amongst the remaining elements: <code>order</code> computes the order
amongst the non-<code>NA</code> elements of the original vector.  Thus
</p>
<pre>   x[order(x, na.last = NA)]
   zz &lt;- x[!is.na(x)]; zz[sort.list(x, na.last = NA)]
</pre>
<p>both sort the non-<code>NA</code> values of <code>x</code>.
</p>
<p>Prior to <span class="rlang"><b>R</b></span> 3.3.0 <code>method = "radix"</code> was only supported for
integers of range less than 100,000.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Knuth, D. E. (1998)
<em>The Art of Computer Programming, Volume 3: Sorting and
Searching.</em> 2nd ed. Addison-Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sort">sort</a></code>, <code><a href="#topic+rank">rank</a></code>, <code><a href="#topic+xtfrm">xtfrm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

(ii &lt;- order(x &lt;- c(1,1,3:1,1:4,3), y &lt;- c(9,9:1), z &lt;- c(2,1:9)))
## 6  5  2  1  7  4 10  8  3  9
rbind(x, y, z)[,ii] # shows the reordering (ties via 2nd &amp; 3rd arg)

## Suppose we wanted descending order on y.
## A simple solution for numeric 'y' is
rbind(x, y, z)[, order(x, -y, z)]
## More generally we can make use of xtfrm
cy &lt;- as.character(y)
rbind(x, y, z)[, order(x, -xtfrm(cy), z)]
## The radix sort supports multiple 'decreasing' values:
rbind(x, y, z)[, order(x, cy, z, decreasing = c(FALSE, TRUE, FALSE),
                       method="radix")]

## Sorting data frames:
dd &lt;- transform(data.frame(x, y, z),
                z = factor(z, labels = LETTERS[9:1]))
## Either as above {for factor 'z' : using internal coding}:
dd[ order(x, -y, z), ]
## or along 1st column, ties along 2nd, ... *arbitrary* no.{columns}:
dd[ do.call(order, dd), ]

set.seed(1)  # reproducible example:
d4 &lt;- data.frame(x = round(   rnorm(100)), y = round(10*runif(100)),
                 z = round( 8*rnorm(100)), u = round(50*runif(100)))
(d4s &lt;- d4[ do.call(order, d4), ])
(i &lt;- which(diff(d4s[, 3]) == 0))
#   in 2 places, needed 3 cols to break ties:
d4s[ rbind(i, i+1), ]

## rearrange matched vectors so that the first is in ascending order
x &lt;- c(5:1, 6:8, 12:9)
y &lt;- (x - 5)^2
o &lt;- order(x)
rbind(x[o], y[o])

## tests of na.last
a &lt;- c(4, 3, 2, NA, 1)
b &lt;- c(4, NA, 2, 7, 1)
z &lt;- cbind(a, b)
(o &lt;- order(a, b)); z[o, ]
(o &lt;- order(a, b, na.last = FALSE)); z[o, ]
(o &lt;- order(a, b, na.last = NA)); z[o, ]


##  speed examples on an average laptop for long vectors:
##  factor/small-valued integers:
x &lt;- factor(sample(letters, 1e7, replace = TRUE))
system.time(o &lt;- sort.list(x, method = "quick", na.last = NA)) # 0.1 sec
stopifnot(!is.unsorted(x[o]))
system.time(o &lt;- sort.list(x, method = "radix")) # 0.05 sec, 2X faster
stopifnot(!is.unsorted(x[o]))
##  large-valued integers:
xx &lt;- sample(1:200000, 1e7, replace = TRUE)
system.time(o &lt;- sort.list(xx, method = "quick", na.last = NA)) # 0.3 sec
system.time(o &lt;- sort.list(xx, method = "radix")) # 0.2 sec
##  character vectors:
xx &lt;- sample(state.name, 1e6, replace = TRUE)
system.time(o &lt;- sort.list(xx, method = "shell")) # 2 sec
system.time(o &lt;- sort.list(xx, method = "radix")) # 0.007 sec, 300X faster
##  double vectors:
xx &lt;- rnorm(1e6)
system.time(o &lt;- sort.list(xx, method = "shell")) # 0.4 sec
system.time(o &lt;- sort.list(xx, method = "quick", na.last = NA)) # 0.1 sec
system.time(o &lt;- sort.list(xx, method = "radix")) # 0.05 sec, 2X faster
</code></pre>

<hr>
<h2 id='outer'>Outer Product of Arrays</h2><span id='topic+outer'></span><span id='topic++25o+25'></span>

<h3>Description</h3>

<p>The outer product of the arrays <code>X</code> and <code>Y</code> is the array
<code>A</code> with dimension <code>c(dim(X), dim(Y))</code> where element
<code>A[c(arrayindex.x, arrayindex.y)]
    = FUN(X[arrayindex.x], Y[arrayindex.y], ...)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outer(X, Y, FUN = "*", ...)
X %o% Y
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outer_+3A_x">X</code>, <code id="outer_+3A_y">Y</code></td>
<td>
<p>first and second arguments for function <code>FUN</code>.
Typically a vector or array.</p>
</td></tr>
<tr><td><code id="outer_+3A_fun">FUN</code></td>
<td>
<p>a function to use on the outer products, found <em>via</em>
<code><a href="#topic+match.fun">match.fun</a></code> (except for the special case <code>"*"</code>).</p>
</td></tr>
<tr><td><code id="outer_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>X</code> and <code>Y</code> must be suitable arguments for <code>FUN</code>.  Each
will be extended by <code><a href="#topic+rep">rep</a></code> to length the products of the
lengths of <code>X</code> and <code>Y</code> before <code>FUN</code> is called.
</p>
<p><code>FUN</code> is called with these two extended vectors as arguments
(plus any arguments in <code>...</code>).  It must be a vectorized
function (or the name of one) expecting at least two arguments and
returning a value with the same length as the first (and the second).
</p>
<p>Where they exist, the [dim]names of <code>X</code> and <code>Y</code> will be
copied to the answer, and a dimension assigned which is the
concatenation of the dimensions of <code>X</code> and <code>Y</code> (or lengths
if dimensions do not exist).
</p>
<p><code>FUN = "*"</code> is handled as a special case <em>via</em>
<code>as.vector(X) %*% t(as.vector(Y))</code>, and is intended only for
numeric vectors and arrays.
</p>
<p><code>%o%</code> is binary operator providing a wrapper for
<code>outer(x, y, "*")</code>.
</p>


<h3>Author(s)</h3>

<p>Jonathan Rougier</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++25+2A+25">%*%</a></code> for usual (<em>inner</em>) matrix vector
multiplication;
<code><a href="#topic+kronecker">kronecker</a></code> which is based on <code>outer</code>;
<code><a href="#topic+Vectorize">Vectorize</a></code> for vectorizing a non-vectorized function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:9; names(x) &lt;- x
# Multiplication &amp; Power Tables
x %o% x
y &lt;- 2:8; names(y) &lt;- paste(y,":", sep = "")
outer(y, x, `^`)

outer(month.abb, 1999:2003, FUN = paste)

## three way multiplication table:
x %o% x %o% y[1:3]
</code></pre>

<hr>
<h2 id='Paren'>Parentheses and Braces</h2><span id='topic+Paren'></span><span id='topic++28'></span><span id='topic++7B'></span>

<h3>Description</h3>

<p>Open parenthesis, <code>(</code>, and open brace, <code>{</code>, are
<code><a href="#topic+.Primitive">.Primitive</a></code> functions in <span class="rlang"><b>R</b></span>.
</p>
<p>Effectively, <code>(</code> is semantically equivalent to the identity
<code>function(x) x</code>, whereas <code>{</code> is slightly more interesting,
see examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>( ... )

{ ... }
</code></pre>


<h3>Value</h3>

<p>For <code>(</code>, the result of evaluating the argument.  This has
visibility set, so will auto-print if used at top-level.
</p>
<p>For <code>{</code>, the result of the last expression evaluated.  This has
the visibility of the last evaluation.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+if">if</a></code>, <code><a href="#topic+return">return</a></code>, etc for other objects used in
the <span class="rlang"><b>R</b></span> language itself.
</p>
<p><code><a href="#topic+Syntax">Syntax</a></code> for operator precedence.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- get("(")
e &lt;- expression(3 + 2 * 4)
identical(f(e), e)

do &lt;- get("{")
do(x &lt;- 3, y &lt;- 2*x-3, 6-x-y); x; y

## note the differences
(2+3)
{2+3; 4+5}
(invisible(2+3))
{invisible(2+3)}
</code></pre>

<hr>
<h2 id='parse'>Parse R Expressions</h2><span id='topic+parse'></span><span id='topic+str2lang'></span><span id='topic+str2expression'></span>

<h3>Description</h3>

<p><code>parse()</code> returns the parsed but unevaluated expressions in an
<code><a href="#topic+expression">expression</a></code>, a &ldquo;list&rdquo; of <code><a href="#topic+call">call</a></code>s.
</p>
<p><code>str2expression(s)</code> and <code>str2lang(s)</code> return special versions
of <code>parse(text=s, keep.source=FALSE)</code> and can therefore be regarded as
transforming character strings <code>s</code> to expressions, calls, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse(file = "", n = NULL, text = NULL, prompt = "?",
      keep.source = getOption("keep.source"), srcfile,
      encoding = "unknown")

str2lang(s)
str2expression(text)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_+3A_file">file</code></td>
<td>
<p>a <a href="#topic+connection">connection</a>, or a character string giving the name of a
file or a URL to read the expressions from.
If <code>file</code> is <code>""</code> and <code>text</code> is missing or <code>NULL</code>
then input is taken from the console.</p>
</td></tr>
<tr><td><code id="parse_+3A_n">n</code></td>
<td>
<p>integer (or coerced to integer).  The maximum number of
expressions to parse.  If <code>n</code> is <code>NULL</code> or negative or
<code>NA</code> the input is parsed in its entirety.</p>
</td></tr>
<tr><td><code id="parse_+3A_text">text</code></td>
<td>
<p>character vector.  The text to parse.  Elements are treated
as if they were lines of a file.  Other <span class="rlang"><b>R</b></span> objects will be coerced
to character if possible.</p>
</td></tr>
<tr><td><code id="parse_+3A_prompt">prompt</code></td>
<td>
<p>the prompt to print when parsing from the keyboard.
<code>NULL</code> means to use <span class="rlang"><b>R</b></span>'s prompt, <code>getOption("prompt")</code>.</p>
</td></tr>
<tr><td><code id="parse_+3A_keep.source">keep.source</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, keep
source reference information.</p>
</td></tr>
<tr><td><code id="parse_+3A_srcfile">srcfile</code></td>
<td>
<p><code>NULL</code>, a character vector, or a
<code><a href="#topic+srcfile">srcfile</a></code> object.  See the &lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="parse_+3A_encoding">encoding</code></td>
<td>
<p>encoding to be assumed for input strings.  If the
value is <code>"latin1"</code> or <code>"UTF-8"</code> it is used to mark
character strings as known to be in Latin-1 or UTF-8: it is not used
to re-encode the input.  To do the latter, specify the encoding as
part of the connection <code>con</code> or <em>via</em>
<code><a href="#topic+options">options</a>(encoding=)</code>: see the example under
<code><a href="#topic+file">file</a></code>. Arguments <code>encoding = "latin1"</code> and 
<code>encoding = "UTF-8"</code> are ignored with a warning when running
in a <abbr>MBCS</abbr> locale.</p>
</td></tr>
<tr><td><code id="parse_+3A_s">s</code></td>
<td>
<p>a <code><a href="#topic+character">character</a></code> vector of length <code>1</code>, i.e., a
&ldquo;string&rdquo;.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>parse(....)</code>: </dt><dd>
<p>If <code>text</code> has length greater than zero (after coercion) it is used in
preference to <code>file</code>.
</p>
<p>All versions of <span class="rlang"><b>R</b></span> accept input from a connection with end of line
marked by <abbr>LF</abbr> (as used on Unix), <abbr>CRLF</abbr> (as used on DOS/Windows)
or <abbr>CR</abbr> (as used on classic Mac OS).  The final line can be incomplete,
that is missing the final <abbr>EOL</abbr> marker.
</p>
<p>When input is taken from the console, <code>n = NULL</code> is equivalent to
<code>n = 1</code>, and <code>n &lt; 0</code> will read until an <abbr>EOF</abbr> character is
read.  (The <abbr>EOF</abbr> character is <abbr>Ctrl</abbr>-Z for the Windows front-ends.)  The
line-length limit is 4095 bytes when reading from the console (which
may impose a lower limit: see &lsquo;An Introduction to R&rsquo;).
</p>
<p>The default for <code>srcfile</code> is set as follows.  If
<code>keep.source</code> is not <code>TRUE</code>, <code>srcfile</code>
defaults to a character string, either <code>"&lt;text&gt;"</code> or one
derived from <code>file</code>.  When <code>keep.source</code> is
<code>TRUE</code>, if <code>text</code> is used, <code>srcfile</code> will be set to a
<code><a href="#topic+srcfilecopy">srcfilecopy</a></code> containing the text.  If a character
string is used for <code>file</code>, a <code><a href="#topic+srcfile">srcfile</a></code> object
referring to that file will be used.
</p>
<p>When <code>srcfile</code> is a character string, error messages will
include the name, but source reference information will not be added
to the result.  When <code>srcfile</code> is a <code><a href="#topic+srcfile">srcfile</a></code>
object, source reference information will be retained.
</p>
</dd>
<dt><code>str2expression(s)</code>: </dt><dd><p>for a <code><a href="#topic+character">character</a></code> vector
<code>s</code>, <code>str2expression(s)</code> corresponds to
<code><a href="#topic+parse">parse</a>(text = s, keep.source=FALSE)</code>, which is always of
type (<code><a href="#topic+typeof">typeof</a></code>) and <code><a href="#topic+class">class</a></code> <code>expression</code>.
</p>
</dd>
<dt><code>str2lang(s)</code>: </dt><dd><p>for a <code><a href="#topic+character">character</a></code> string
<code>s</code>, <code>str2lang(s)</code> corresponds to
<code><a href="#topic+parse">parse</a>(text = s, keep.source=FALSE)[[1]]</code> (plus a check
that both <code>s</code> and the <code>parse(*)</code> result are of length one)
which is typically a <code>call</code> but may also be a <code>symbol</code> aka
<code><a href="#topic+name">name</a></code>, <code><a href="#topic+NULL">NULL</a></code> or an atomic constant such as
<code>2</code>, <code>1L</code>, or <code>TRUE</code>.  Put differently, the value of
<code>str2lang(.)</code> is a call or one of its parts, in short
&ldquo;a call or simpler&rdquo;.
</p>
</dd>
</dl>

<p>Currently, encoding is not handled in <code>str2lang()</code> and
<code>str2expression()</code>.
</p>


<h3>Value</h3>

<p><code>parse()</code> and <code>str2expression()</code> return an object of type
<code>"<a href="#topic+expression">expression</a>"</code>, for <code>parse()</code> with up to <code>n</code>
elements if specified as a non-negative integer.
</p>
<p><code>str2lang(s)</code>, <code>s</code> a string, returns &ldquo;a
<code><a href="#topic+call">call</a></code> or simpler&rdquo;, see the &lsquo;Details:&rsquo; section.
</p>
<p>When <code>srcfile</code> is non-<code>NULL</code>, a <code>"srcref"</code> attribute
will be attached to the result containing a list of
<code><a href="#topic+srcref">srcref</a></code> records corresponding to each element, a
<code>"srcfile"</code> attribute will be attached containing a copy of
<code>srcfile</code>, and a <code>"wholeSrcref"</code> attribute will be
attached containing a <code><a href="#topic+srcref">srcref</a></code> record corresponding to
all of the parsed text. Detailed parse information will be stored in
the <code>"srcfile"</code> attribute, to be retrieved by
<code><a href="utils.html#topic+getParseData">getParseData</a></code>.
</p>
<p>A syntax error (including an incomplete expression) will throw an error.
</p>
<p>Character strings in the result will have a declared encoding if
<code>encoding</code> is <code>"latin1"</code> or <code>"UTF-8"</code>, or if
<code>text</code> is supplied with every element of known encoding in a
Latin-1 or UTF-8 locale.
</p>


<h3>Partial parsing</h3>

<p>When a syntax error occurs during parsing, <code>parse</code>
signals an error.  The partial parse data will be stored in the
<code>srcfile</code> argument if it is a <code><a href="#topic+srcfile">srcfile</a></code> object
and the <code>text</code> argument was used to supply the text.  In other
cases it will be lost when the error is triggered.
</p>
<p>The partial parse data can be retrieved using
<code><a href="utils.html#topic+getParseData">getParseData</a></code> applied to the <code>srcfile</code> object.
Because parsing was incomplete, it will typically include references
to <code>"parent"</code> entries that are not present.
</p>


<h3>Note</h3>

<p>Using <code>parse(text = *, ..)</code> or its simplified and hence more
efficient versions <code>str2lang()</code> or <code>str2expression()</code> is at
least an order of magnitude less efficient than <code><a href="#topic+call">call</a>(..)</code> or
<code><a href="#topic+as.call">as.call</a>()</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murdoch, D. (2010).
&ldquo;Source References&rdquo;.

<em>The R Journal</em>, <b>2</b>(2), 16&ndash;19.
<a href="https://doi.org/10.32614/RJ-2010-010">doi:10.32614/RJ-2010-010</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scan">scan</a></code>, <code><a href="#topic+source">source</a></code>, <code><a href="#topic+eval">eval</a></code>,
<code><a href="#topic+deparse">deparse</a></code>.
</p>
<p>The source reference information can be used for debugging (see
e.g. <code><a href="utils.html#topic+setBreakpoint">setBreakpoint</a></code>) and profiling (see
<code><a href="utils.html#topic+Rprof">Rprof</a></code>).  It can be examined by <code><a href="utils.html#topic+getSrcref">getSrcref</a></code>
and related functions.  More detailed information is available through
<code><a href="utils.html#topic+getParseData">getParseData</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fil &lt;- tempfile(fileext = ".Rdmped")
cat("x &lt;- c(1, 4)\n  x ^ 3 -10 ; outer(1:7, 5:9)\n", file = fil)
# parse 3 statements from our temp file
parse(file = fil, n = 3)
unlink(fil)

## str2lang(&lt;string&gt;)  || str2expression(&lt;character&gt;) :
stopifnot(exprs = {
  identical( str2lang("x[3] &lt;- 1+4"), quote(x[3] &lt;- 1+4))
  identical( str2lang("log(y)"),      quote(log(y)) )
  identical( str2lang("abc"   ),      quote(abc) -&gt; qa)
  is.symbol(qa) &amp; !is.call(qa)           # a symbol/name, not a call
  identical( str2lang("1.375" ), 1.375)  # just a number, not a call
  identical( str2expression(c("# a comment", "", "42")), expression(42) )
})

# A partial parse with a syntax error
txt &lt;- "
x &lt;- 1
an error
"
sf &lt;- srcfile("txt")
tryCatch(parse(text = txt, srcfile = sf), error = function(e) "Syntax error.")
getParseData(sf)
</code></pre>

<hr>
<h2 id='paste'>Concatenate Strings</h2><span id='topic+paste'></span><span id='topic+paste0'></span>

<h3>Description</h3>

<p>Concatenate vectors after converting to character.
Concatenation happens in two basically different ways, determined by
<code>collapse</code> being a string or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paste (..., sep = " ", collapse = NULL, recycle0 = FALSE)
paste0(...,            collapse = NULL, recycle0 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paste_+3A_...">...</code></td>
<td>
<p>one or more <span class="rlang"><b>R</b></span> objects, to be converted to character vectors.</p>
</td></tr>
<tr><td><code id="paste_+3A_sep">sep</code></td>
<td>
<p>a character string to separate the terms.  Not
<code><a href="#topic+NA_character_">NA_character_</a></code>.</p>
</td></tr>
<tr><td><code id="paste_+3A_collapse">collapse</code></td>
<td>
<p>an optional character string to separate the results.  Not
<code><a href="#topic+NA_character_">NA_character_</a></code>.  When <code>collapse</code> is a string,
the result is always a string (<code><a href="#topic+character">character</a></code> of length 1).</p>
</td></tr>
<tr><td><code id="paste_+3A_recycle0">recycle0</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating if zero-length
character arguments should result in the zero-length
<code><a href="#topic+character">character</a>(0)</code>.  Note that when <code>collapse</code> is
a string, <code>recycle0</code> does <em>not</em> recycle to zero-length, but
to <code>""</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>paste</code> converts its arguments (<em>via</em>
<code><a href="#topic+as.character">as.character</a></code>) to character strings, and concatenates
them (separating them by the string given by <code>sep</code>).
</p>
<p>If the arguments are vectors, they are concatenated term-by-term to give a
character vector result.  Vector arguments are recycled as needed.
Zero-length arguments are recycled as <code>""</code> unless <code>recycle0</code>
is <code>TRUE</code> and <code>collapse</code> is <code>NULL</code>.
</p>
<p>Note that <code>paste()</code> coerces <code><a href="#topic+NA_character_">NA_character_</a></code>, the
character missing value, to <code>"NA"</code> which may seem
undesirable, e.g., when pasting two character vectors, or very
desirable, e.g. in <code>paste("the value of p is ", p)</code>.
</p>
<p><code>paste0(..., collapse)</code> is equivalent to
<code>paste(..., sep = "", collapse)</code>, slightly more efficiently.
</p>
<p>If a value is specified for <code>collapse</code>, the values in the result
are then concatenated into a single string, with the elements being
separated by the value of <code>collapse</code>.
</p>


<h3>Value</h3>

<p>A character vector of the concatenated values.  This will be of length
zero if all the objects are, unless <code>collapse</code> is non-NULL, in which
case it is <code>""</code> (a single empty string).
</p>
<p>If any input into an element of the result is in UTF-8 (and none are
declared with encoding <code>"bytes"</code>, see <code><a href="#topic+Encoding">Encoding</a></code>),
that element will be in UTF-8, otherwise in the current encoding in
which case the encoding of the element is declared if the current
locale is either Latin-1 or UTF-8, at least one of the corresponding
inputs (including separators) had a declared encoding and all inputs
were either ASCII or declared.
</p>
<p>If an input into an element is declared with encoding <code>"bytes"</code>,
no translation will be done of any of the elements and the resulting
element will have encoding <code>"bytes"</code>.  If <code>collapse</code> is
non-NULL, this applies also to the second, collapsing, phase, but some
translation may have been done in pasting object together in the first
phase.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+toString">toString</a></code> typically calls <code>paste(*, collapse=", ")</code>.
String manipulation with
<code><a href="#topic+as.character">as.character</a></code>, <code><a href="#topic+substr">substr</a></code>, <code><a href="#topic+nchar">nchar</a></code>,
<code><a href="#topic+strsplit">strsplit</a></code>; further, <code><a href="#topic+cat">cat</a></code> which concatenates and
writes to a file, and <code><a href="#topic+sprintf">sprintf</a></code> for C like string
construction.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>paste</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## When passing a single vector, paste0 and paste work like as.character.
paste0(1:12)
paste(1:12)        # same
as.character(1:12) # same

## If you pass several vectors to paste0, they are concatenated in a
## vectorized way.
(nth &lt;- paste0(1:12, c("st", "nd", "rd", rep("th", 9))))

## paste works the same, but separates each input with a space.
## Notice that the recycling rules make every input as long as the longest input.
paste(month.abb, "is the", nth, "month of the year.")
paste(month.abb, letters)

## You can change the separator by passing a sep argument
## which can be multiple characters.
paste(month.abb, "is the", nth, "month of the year.", sep = "_*_")

## To collapse the output into a single string, pass a collapse argument.
paste0(nth, collapse = ", ")

## For inputs of length 1, use the sep argument rather than collapse
paste("1st", "2nd", "3rd", collapse = ", ") # probably not what you wanted
paste("1st", "2nd", "3rd", sep = ", ")

## You can combine the sep and collapse arguments together.
paste(month.abb, nth, sep = ": ", collapse = "; ")

## Using paste() in combination with strwrap() can be useful
## for dealing with long strings.
(title &lt;- paste(strwrap(
    "Stopping distance of cars (ft) vs. speed (mph) from Ezekiel (1930)",
    width = 30), collapse = "\n"))
plot(dist ~ speed, cars, main = title)

## zero length arguments recycled as `""` -- NB: `{}` &lt;==&gt; character(0)  here
paste({}, 1:2)

## 'recycle0 = TRUE' allows standard vectorized behaviour, i.e., zero-length
##                   recycling resulting in zero-length result character(0):
valid &lt;- FALSE
val &lt;- pi
paste("The value is", val[valid], "-- not so good!") # -&gt;  ".. value is  -- not .."
paste("The value is", val[valid], "-- good: empty!", recycle0=TRUE) # -&gt; character(0)

## When 'collapse = &lt;string&gt;',  result is (length 1) string in all cases
paste("foo", {}, "bar", collapse = "|")                  # |--&gt;  "foo  bar"
paste("foo", {},        collapse = "|", recycle0 = TRUE) # |--&gt;  ""
## If all arguments are empty (and collapse a string),   ""  results always
paste(    collapse = "|")
paste(    collapse = "|", recycle0 = TRUE)
paste({}, collapse = "|")
paste({}, collapse = "|", recycle0 = TRUE)
</code></pre>

<hr>
<h2 id='path.expand'>Expand File Paths</h2><span id='topic+path.expand'></span><span id='topic+tilde+20expansion'></span>

<h3>Description</h3>

<p>Expand a path name, for example by replacing a leading tilde by the
user's home directory (if defined on that platform).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>path.expand(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="path.expand_+3A_path">path</code></td>
<td>
<p>character vector containing one or more path names.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>On Unix - alikes:</dt><dd>
<p>On most builds of <span class="rlang"><b>R</b></span> a leading <code>~user</code> will expand to the home
directory of <code>user</code>.
</p>
<p>There are possibly different concepts of &lsquo;home directory&rsquo;: that
usually used is the setting of the environment variable <span class="env">HOME</span>.
</p>
<p>The &lsquo;path names&rsquo; need not exist nor be valid path names but
they do need to be representable in the session encoding.
</p>
</dd>
<dt>On Windows:</dt><dd>
<p>The definition of the &lsquo;home&rsquo; directory is in the &lsquo;<span class="file">rw-FAQ</span>&rsquo;
Q2.14: it is taken from the <span class="env">R_USER</span> environment variable when
<code>path.expand</code> is first called in a session.
</p>
<p>The &lsquo;path names&rsquo; need not exist nor be valid path names.
</p>
</dd>
</dl>



<h3>Value</h3>

<p>A character vector of possibly expanded path names: where the home
directory is unknown or none is specified the path is returned unchanged.
</p>


<p>If the expansion would exceed the maximum path length the result may
be truncated or the path may be returned unchanged.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+basename">basename</a></code>, <code><a href="#topic+normalizePath">normalizePath</a></code>, <code><a href="#topic+file.path">file.path</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path.expand("~/foo")
</code></pre>

<hr>
<h2 id='pcre_config'>
Report Configuration Options for PCRE
</h2><span id='topic+pcre_config'></span>

<h3>Description</h3>

<p>Report some of the configuration options of the version of PCRE in use
in this <span class="rlang"><b>R</b></span> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcre_config()
</code></pre>


<h3>Value</h3>

<p>A named logical vector, currently with elements
</p>
<table>
<tr><td><code>UTF-8</code></td>
<td>
<p>Support for UTF-8 inputs.  Required.</p>
</td></tr>
<tr><td><code>Unicode properties</code></td>
<td>
<p>Support for &lsquo;<span class="samp">&#8288;\p{xx}&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\P{xx}&#8288;</span>&rsquo;
in regular expressions.  Desirable and used by some CRAN packages.
As of PCRE2, always present with support for UTF-8.</p>
</td></tr>
<tr><td><code>JIT</code></td>
<td>
<p>Support for just-in-time compilation.  Desirable for speed
(but only available as a compile-time option on certain
architectures, and may be unused as unreliable on some of those,
e.g. <code>arm64</code>).</p>
</td></tr>
<tr><td><code>stack</code></td>
<td>
<p>Does match recursion use a stack (<code>TRUE</code>, the default
for PCRE1 and PCRE2 older than 10.30) or a heap?  See the discussion at
<a href="https://www.pcre.org/original/doc/html/pcrestack.html">https://www.pcre.org/original/doc/html/pcrestack.html</a>  (Added
in <span class="rlang"><b>R</b></span> 3.4.0.). No longer relevant and always <code>FALSE</code> in PCRE2
since version 10.30 which no longer uses function recursion to remember
backtracking positions.</p>
</td></tr> 
</table>


<h3>See Also</h3>

<p><code><a href="#topic+extSoftVersion">extSoftVersion</a></code> for the PCRE version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pcre_config()
</code></pre>

<hr>
<h2 id='pipeOp'>Forward Pipe Operator</h2><span id='topic++7C+3E'></span><span id='topic+pipeOp'></span>

<h3>Description</h3>

<p>Pipe a value into a call expression or a function expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs |&gt; rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pipeOp_+3A_lhs">lhs</code></td>
<td>
<p>expression producing a value.</p>
</td></tr>
<tr><td><code id="pipeOp_+3A_rhs">rhs</code></td>
<td>
<p>a call expression.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pipe expression passes, or &lsquo;pipes&rsquo;, the result of the left-hand-side
expression <code>lhs</code> to the right-hand-side expression <code>rhs</code>.
</p>
<p>The <code>lhs</code> is
inserted as the first argument in the call. So <code>x |&gt; f(y)</code> is
interpreted as <code>f(x, y)</code>.
</p>
<p>To avoid ambiguities, functions in <code>rhs</code> calls may not be
syntactically special, such as <code>+</code> or <code>if</code>.
</p>
<p>It is also possible to use a named argument with the placeholder
<code>_</code> in the <code>rhs</code> call to specify where the <code>lhs</code> is to
be inserted.  The placeholder can only appear once on the <code>rhs</code>.
</p>
<p>The placeholder can also be used as the first argument in an
extraction call, such as <code>_$coef</code>. More generally, it can be used
as the head of a chain of extractions, such as <code>_$coef[[2]]</code>,
using a sequence of the extraction functions <code>$</code>, <code>[</code>,
<code>[[</code>, or <code>@</code>.
</p>
<p>Pipe notation allows a nested sequence of calls to be written in a way
that may make the sequence of processing steps easier to follow.
</p>
<p>Currently, pipe operations are implemented as syntax transformations.
So an expression written as <code>x |&gt; f(y)</code> is parsed as <code>f(x,
  y)</code>.  It is worth emphasizing that while the code in a pipeline is
written sequentially, regular R semantics for evaluation apply and
so piped expressions will be evaluated only when first used in the
<code>rhs</code> expression.
</p>


<h3>Value</h3>

<p>Returns the result of evaluating the transformed expression.
</p>


<h3>Background</h3>

<p>The forward pipe operator is motivated by the pipe introduced in the
<a href="https://CRAN.R-project.org/package=magrittr"><span class="pkg">magrittr</span></a> package, but is more streamlined.  It is similar to
the pipe or pipeline operators introduced in other languages, including
F#, Julia, and JavaScript.
</p>


<h3>Warning</h3>

<p>This was introduced in <span class="rlang"><b>R</b></span> 4.1.0.  Code using it will not be parsed
as intended (probably with an error) in earlier versions of <span class="rlang"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simple uses:
mtcars |&gt; head()                      # same as head(mtcars)
mtcars |&gt; head(2)                     # same as head(mtcars, 2)
mtcars |&gt; subset(cyl == 4) |&gt; nrow()  # same as nrow(subset(mtcars, cyl == 4))

# to pass the lhs into an argument other than the first, either
# use the _ placeholder with a named argument:
mtcars |&gt; subset(cyl == 4) |&gt; lm(mpg ~ disp, data = _)
# or use an anonymous function:
mtcars |&gt; subset(cyl == 4) |&gt; (function(d) lm(mpg ~ disp, data = d))()
mtcars |&gt; subset(cyl == 4) |&gt; (\(d) lm(mpg ~ disp, data = d))()
# or explicitly name the argument(s) before the "one":
mtcars |&gt; subset(cyl == 4) |&gt; lm(formula = mpg ~ disp)

# using the placeholder as the head of an extraction chain:
mtcars |&gt; subset(cyl == 4) |&gt; lm(formula = mpg ~ disp) |&gt; _$coef[[2]]

# the pipe operator is implemented as a syntax transformation:
quote(mtcars |&gt; subset(cyl == 4) |&gt; nrow())

# regular R evaluation semantics apply
stop() |&gt; (function(...) {})() # stop() is not used on RHS so is not evaluated
</code></pre>

<hr>
<h2 id='plot'>Generic X-Y Plotting</h2><span id='topic+plot'></span>

<h3>Description</h3>

<p>Generic function for plotting of <span class="rlang"><b>R</b></span> objects.
</p>
<p>For simple scatter plots, <code><a href="graphics.html#topic+plot.default">plot.default</a></code> will be used.
However, there are <code>plot</code> methods for many <span class="rlang"><b>R</b></span> objects,
including <code><a href="#topic+function">function</a></code>s, <code><a href="#topic+data.frame">data.frame</a></code>s,
<code><a href="stats.html#topic+density">density</a></code> objects, etc.  Use <code>methods(plot)</code> and
the documentation for these. Most of these methods are implemented
using traditional graphics (the <span class="pkg">graphics</span> package), but this is
not mandatory.
</p>
<p>For more details about graphical parameter arguments used by
traditional graphics, see <code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>the coordinates of points in the plot. Alternatively, a
single plotting structure, function or <em>any <span class="rlang"><b>R</b></span> object with a
<code>plot</code> method</em> can be provided.</p>
</td></tr>
<tr><td><code id="plot_+3A_y">y</code></td>
<td>
<p>the y coordinates of points in the plot, <em>optional</em>
if <code>x</code> is an appropriate structure.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as
<a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="graphics.html#topic+par">par</a></code>).
Many methods will accept the following arguments:
</p>

<dl>
<dt><code>type</code></dt><dd><p>what type of plot should be drawn.  Possible types are
</p>

<ul>
<li> <p><code>"p"</code> for <b>p</b>oints,
</p>
</li>
<li> <p><code>"l"</code> for <b>l</b>ines,
</p>
</li>
<li> <p><code>"b"</code> for <b>b</b>oth,
</p>
</li>
<li> <p><code>"c"</code> for the lines part alone of <code>"b"</code>,
</p>
</li>
<li> <p><code>"o"</code> for both &lsquo;<b>o</b>verplotted&rsquo;,
</p>
</li>
<li> <p><code>"h"</code> for &lsquo;<b>h</b>istogram&rsquo; like (or
&lsquo;high-density&rsquo;) vertical lines,
</p>
</li>
<li> <p><code>"s"</code> for stair <b>s</b>teps,
</p>
</li>
<li> <p><code>"S"</code> for other <b>s</b>teps, see &lsquo;Details&rsquo; below,
</p>
</li>
<li> <p><code>"n"</code> for no plotting.
</p>
</li></ul>

<p>All other <code>type</code>s give a warning or an error; using, e.g.,
<code>type = "punkte"</code> being equivalent to <code>type = "p"</code> for S
compatibility.  Note that some methods,
e.g. <code><a href="graphics.html#topic+plot.factor">plot.factor</a></code>, do not accept this.
</p>
</dd>
<dt><code>main</code></dt><dd><p>an overall title for the plot: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</dd>
<dt><code>sub</code></dt><dd><p>a subtitle for the plot: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</dd>
<dt><code>xlab</code></dt><dd><p>a title for the x axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</dd>
<dt><code>ylab</code></dt><dd><p>a title for the y axis: see <code><a href="graphics.html#topic+title">title</a></code>.</p>
</dd>
<dt><code>asp</code></dt><dd><p>the <code class="reqn">y/x</code> aspect ratio,
see <code><a href="graphics.html#topic+plot.window">plot.window</a></code>.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>The two step types differ in their x-y preference: Going from
<code class="reqn">(x1,y1)</code> to <code class="reqn">(x2,y2)</code> with <code class="reqn">x1 &lt; x2</code>, <code>type = "s"</code>
moves first horizontal, then vertical, whereas <code>type = "S"</code> moves
the other way around.
</p>


<h3>Note</h3>

<p>The <code>plot</code> generic was moved from the <span class="pkg">graphics</span> package to
the <span class="pkg">base</span> package in <span class="rlang"><b>R</b></span> 4.0.0. It is currently re-exported from
the <span class="pkg">graphics</span> namespace to allow packages importing it from there
to continue working, but this may change in future versions of <span class="rlang"><b>R</b></span>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="graphics.html#topic+plot.formula">plot.formula</a></code> and other
methods; <code><a href="graphics.html#topic+points">points</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code>, <code><a href="graphics.html#topic+par">par</a></code>.
For thousands of points, consider using <code><a href="graphics.html#topic+smoothScatter">smoothScatter</a>()</code>
instead of <code>plot()</code>.
</p>
<p>For X-Y-Z plotting see <code><a href="graphics.html#topic+contour">contour</a></code>, <code><a href="graphics.html#topic+persp">persp</a></code> and
<code><a href="graphics.html#topic+image">image</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for lowess, rpois, rnorm
require(graphics) # for plot methods
plot(cars)
lines(lowess(cars))

plot(sin, -pi, 2*pi) # see ?plot.function

## Discrete Distribution Plot:
plot(table(rpois(100, 5)), type = "h", col = "red", lwd = 10,
     main = "rpois(100, lambda = 5)")

## Simple quantiles/ECDF, see ecdf() {library(stats)} for a better one:
plot(x &lt;- sort(rnorm(47)), type = "s", main = "plot(x, type = \"s\")")
points(x, cex = .5, col = "dark red")
</code></pre>

<hr>
<h2 id='pmatch'>Partial String Matching</h2><span id='topic+pmatch'></span>

<h3>Description</h3>

<p><code>pmatch</code> seeks matches for the elements of its first argument
among those of its second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmatch(x, table, nomatch = NA_integer_, duplicates.ok = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmatch_+3A_x">x</code></td>
<td>
<p>the values to be matched: converted to a character vector by
<code><a href="#topic+as.character">as.character</a></code>.  <a href="#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="pmatch_+3A_table">table</code></td>
<td>
<p>the values to be matched against: converted to a character
vector.  <a href="#topic+Long+20vectors">Long vectors</a> are not supported.</p>
</td></tr>
<tr><td><code id="pmatch_+3A_nomatch">nomatch</code></td>
<td>
<p>the value to be returned at non-matching or multiply
partially matching positions.  Note that it is coerced to <code>integer</code>.</p>
</td></tr>
<tr><td><code id="pmatch_+3A_duplicates.ok">duplicates.ok</code></td>
<td>
<p>should elements in <code>table</code> be used more
than once?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The behaviour differs by the value of <code>duplicates.ok</code>. Consider
first the case if this is true.  First exact matches are considered,
and the positions of the first exact matches are recorded. Then unique
partial matches are considered, and if found recorded.  (A partial
match occurs if the whole of the element of <code>x</code> matches the
beginning of the element of <code>table</code>.)  Finally,
all remaining elements of <code>x</code> are regarded as unmatched.
In addition, an empty string can match nothing, not even an exact
match to an empty string.  This is the appropriate behaviour for
partial matching of character indices, for example.
</p>
<p>If <code>duplicates.ok</code> is <code>FALSE</code>, values of <code>table</code> once
matched are excluded from the search for subsequent matches.  This
behaviour is equivalent to the <span class="rlang"><b>R</b></span> algorithm for argument
matching, except for the consideration of empty strings (which in
argument matching are matched after exact and partial matching to any
remaining arguments).
</p>
<p><code><a href="#topic+charmatch">charmatch</a></code> is similar to <code>pmatch</code> with
<code>duplicates.ok</code> true, the differences being that it
differentiates between no match and an ambiguous partial match,  it
does match empty strings, and it does not allow multiple exact matches.
</p>
<p><code>NA</code> values are treated as if they were the string constant
<code>"NA"</code>.
</p>


<h3>Value</h3>

<p>An integer vector (possibly including <code>NA</code> if <code>nomatch =
    NA</code>) of the same length as <code>x</code>, giving the indices of the
elements in <code>table</code> which matched, or <code>nomatch</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data. A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+match">match</a></code>, <code><a href="#topic+charmatch">charmatch</a></code> and
<code><a href="#topic+match.arg">match.arg</a></code>, <code><a href="#topic+match.fun">match.fun</a></code>,
<code><a href="#topic+match.call">match.call</a></code>, for function argument matching etc.,
<code><a href="#topic+startsWith">startsWith</a></code> for particular checking of initial matches;
<code><a href="#topic+grep">grep</a></code> etc for more general (regexp) matching of strings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pmatch("", "")                             # returns NA
pmatch("m",   c("mean", "median", "mode")) # returns NA
pmatch("med", c("mean", "median", "mode")) # returns 2

pmatch(c("", "ab", "ab"), c("abc", "ab"), duplicates.ok = FALSE)
pmatch(c("", "ab", "ab"), c("abc", "ab"), duplicates.ok = TRUE)
## compare
charmatch(c("", "ab", "ab"), c("abc", "ab"))
</code></pre>

<hr>
<h2 id='polyroot'>Find Zeros of a Real or Complex Polynomial</h2><span id='topic+polyroot'></span>

<h3>Description</h3>

<p>Find zeros of a real or complex polynomial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polyroot(z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polyroot_+3A_z">z</code></td>
<td>
<p>the vector of polynomial coefficients in increasing order.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A polynomial of degree <code class="reqn">n - 1</code>,
</p>
<p style="text-align: center;"><code class="reqn">
    p(x) = z_1 + z_2 x + \cdots + z_n x^{n-1}</code>
</p>

<p>is given by its coefficient vector <code>z[1:n]</code>.
<code>polyroot</code> returns the <code class="reqn">n-1</code> complex zeros of <code class="reqn">p(x)</code>
using the Jenkins-Traub algorithm.
</p>
<p>If the coefficient vector <code>z</code> has zeroes for the highest powers,
these are discarded.
</p>
<p>There is no maximum degree, but numerical stability
may be an issue for all but low-degree polynomials.
</p>


<h3>Value</h3>

<p>A complex vector of length <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the position
of the largest non-zero element of <code>z</code>.
</p>


<h3>Source</h3>

<p>C translation by Ross Ihaka of Fortran code in the reference, with
modifications by the R Core Team.
</p>


<h3>References</h3>

<p>Jenkins, M. A. and Traub, J. F. (1972).
Algorithm 419: zeros of a complex polynomial.
<em>Communications of the ACM</em>, <b>15</b>(2), 97&ndash;99.
<a href="https://doi.org/10.1145/361254.361262">doi:10.1145/361254.361262</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+uniroot">uniroot</a></code> for numerical root finding of arbitrary
functions;
<code><a href="#topic+complex">complex</a></code> and the <code>zero</code> example in the demos
directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>polyroot(c(1, 2, 1))
round(polyroot(choose(8, 0:8)), 11) # guess what!
for (n1 in 1:4) print(polyroot(1:n1), digits = 4)
polyroot(c(1, 2, 1, 0, 0)) # same as the first
</code></pre>

<hr>
<h2 id='pos.to.env'>Convert Positions in the Search Path to Environments</h2><span id='topic+pos.to.env'></span>

<h3>Description</h3>

<p>Returns the environment at a specified position in the search path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pos.to.env(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pos.to.env_+3A_x">x</code></td>
<td>
<p>an integer between <code>1</code> and <code>length(search())</code>, the length
of the search path, or <code>-1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several <span class="rlang"><b>R</b></span> functions for manipulating objects in environments (such as
<code><a href="#topic+get">get</a></code> and <code><a href="#topic+ls">ls</a></code>) allow specifying environments
via corresponding positions in the search path.  <code>pos.to.env</code> is
a convenience function for programmers which converts these positions
to corresponding environments; users will typically have no need for
it.  It is <a href="#topic+primitive">primitive</a>.
</p>
<p><code>-1</code> is interpreted as the environment the function is called
from.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pos.to.env(1) # R_GlobalEnv
# the next returns the base environment
pos.to.env(length(search()))
</code></pre>

<hr>
<h2 id='pretty'>Pretty Breakpoints</h2><span id='topic+pretty'></span><span id='topic+.pretty'></span><span id='topic+pretty.default'></span>

<h3>Description</h3>

<p>Compute a  sequence of about <code>n+1</code> equally spaced &lsquo;round&rsquo;
values which cover the range of the values in <code>x</code>.
The values are chosen so that they are 1, 2 or 5 times a power of 10.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty(x, ...)

## Default S3 method:
pretty(x, n = 5, min.n = n %/% 3,  shrink.sml = 0.75,
       high.u.bias = 1.5, u5.bias = .5 + 1.5*high.u.bias,
       eps.correct = 0, f.min = 2^-20, ...)

.pretty(x, n = 5L, min.n = n %/% 3,  shrink.sml = 0.75,
       high.u.bias = 1.5, u5.bias = .5 + 1.5*high.u.bias,
       eps.correct = 0L, f.min = 2^-20, bounds = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pretty_+3A_x">x</code></td>
<td>
<p>an object coercible to numeric by <code><a href="#topic+as.numeric">as.numeric</a></code>.</p>
</td></tr>
<tr><td><code id="pretty_+3A_n">n</code></td>
<td>
<p>integer giving the <em>desired</em> number of
intervals.  Non-integer values are rounded down.</p>
</td></tr>
<tr><td><code id="pretty_+3A_min.n">min.n</code></td>
<td>
<p>nonnegative integer giving the <em>minimal</em> number of
intervals.  If <code>min.n == 0</code>, <code>pretty(.)</code> may return a
single value.</p>
</td></tr>
<tr><td><code id="pretty_+3A_shrink.sml">shrink.sml</code></td>
<td>
<p>positive number, a factor (smaller than one)
by which a default scale is shrunk in the case when
<code>range(x)</code> is very small (usually 0).</p>
</td></tr>
<tr><td><code id="pretty_+3A_high.u.bias">high.u.bias</code></td>
<td>
<p>non-negative numeric, typically <code class="reqn">&gt; 1</code>.
The interval unit is determined as {1,2,5,10} times <code>b</code>, a
power of 10.  Larger <code>high.u.bias</code> values favor larger units.</p>
</td></tr>
<tr><td><code id="pretty_+3A_u5.bias">u5.bias</code></td>
<td>
<p>non-negative numeric
multiplier favoring factor 5 over 2.  Default and &lsquo;optimal&rsquo;:
<code>u5.bias = .5 + 1.5*high.u.bias</code>.</p>
</td></tr>
<tr><td><code id="pretty_+3A_eps.correct">eps.correct</code></td>
<td>
<p>integer code, one of {0,1,2}. If non-0, an
<em>epsilon correction</em> is made at the boundaries such that
the result boundaries will be outside <code>range(x)</code>; in the
<em>small</em> case, the correction is only done if <code>eps.correct &gt;= 2</code>.</p>
</td></tr>
<tr><td><code id="pretty_+3A_f.min">f.min</code></td>
<td>
<p>positive factor multiplied by <code><a href="#topic+.Machine">.Machine</a>$double.xmin</code>
to get the smallest &ldquo;acceptable&rdquo; <code>cell</code> <code class="reqn">c_m</code> which
determines the <code>unit</code> of the algorithm.  Smaller <code>cell</code>
values are set to <code class="reqn">c_n</code> signalling a <code><a href="#topic+warning">warning</a></code> about
being &ldquo;corrected&rdquo;.
New from <span class="rlang"><b>R</b></span> 4.2.0,: previously <code>f.min = 20</code> was
hardcoded in the algorithm.</p>
</td></tr>
<tr><td><code id="pretty_+3A_bounds">bounds</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> indicating if the resulting vector
should <em>cover</em> the full <code>range(x)</code>, i.e., strictly include
the bounds of <code>x</code>.  New from <span class="rlang"><b>R</b></span> 4.2.0, allowing <code>bound=FALSE</code>
to reproduce how <span class="rlang"><b>R</b></span>'s graphics engine computes axis tick locations (in
<code>GEPretty()</code>).</p>
</td></tr>
<tr><td><code id="pretty_+3A_...">...</code></td>
<td>
<p>further arguments for methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pretty</code> ignores non-finite values in <code>x</code>.
</p>
<p>Let <code>d &lt;- max(x) - min(x)</code> <code class="reqn">\ge 0</code>.
If <code>d</code> is not (very close) to 0, we let <code>c &lt;- d/n</code>,
otherwise more or less <code>c &lt;- max(abs(range(x)))*shrink.sml / min.n</code>.
Then, the <em>10 base</em> <code>b</code> is
<code class="reqn">10^{\lfloor{\log_{10}(c)}\rfloor}</code> such
that <code class="reqn">b \le c &lt; 10b</code>.
</p>
<p>Now determine the basic <em>unit</em> <code class="reqn">u</code> as one of
<code class="reqn">\{1,2,5,10\} b</code>, depending on
<code class="reqn">c/b \in [1,10)</code>
and the two &lsquo;<em>bias</em>&rsquo; coefficients, <code class="reqn">h
  =</code><code>high.u.bias</code> and <code class="reqn">f =</code><code>u5.bias</code>.
</p>
<p>.........
</p>


<h3>Value</h3>

<p><code>pretty()</code> returns an numeric vector of <em>approximately</em>
<code>n</code> increasing numbers which are &ldquo;pretty&rdquo; in decimal notation.
(in extreme range cases, the numbers can no longer be &ldquo;pretty&rdquo;
given the other constraints; e.g., for <code>pretty(..)</code> 
</p>
<p>For ease of investigating the underlying C <code>R_pretty()</code>
function, <code>.pretty()</code> returns a named <code><a href="#topic+list">list</a></code>.  By
default, when <code>bounds=TRUE</code>, the entries are <code>l</code>, <code>u</code>,
and <code>n</code>, whereas for <code>bounds=FALSE</code>, they are
<code>ns</code>, <code>nu</code>, <code>n</code>, and (a &ldquo;pretty&rdquo;) <code>unit</code>
where the <code>n*</code>'s are integer valued (but only <code>n</code> is of class
<code><a href="#topic+integer">integer</a></code>).  Programmers may use this to create pretty
sequence (iterator) objects.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+axTicks">axTicks</a></code> for the computation of pretty axis tick
locations in plots, particularly on the log scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pretty(1:15)                    # 0  2  4  6  8 10 12 14 16
pretty(1:15, high.u.bias = 2)   # 0  5 10 15
pretty(1:15, n = 4)             # 0  5 10 15
pretty(1:15 * 2)                # 0  5 10 15 20 25 30
pretty(1:20)                    # 0  5 10 15 20
pretty(1:20, n = 2)             # 0 10 20
pretty(1:20, n = 10)            # 0  2  4 ... 20

for(k in 5:11) {
  cat("k=", k, ": "); print(diff(range(pretty(100 + c(0, pi*10^-k)))))}

##-- more bizarre, when  min(x) == max(x):
pretty(pi)

add.names &lt;- function(v) { names(v) &lt;- paste(v); v}
utils::str(lapply(add.names(-10:20), pretty))
## min.n = 0  returns a length-1 vector "if pretty":
utils::str(lapply(add.names(0:20),  pretty, min.n = 0))
sapply(    add.names(0:20),   pretty, min.n = 4)

pretty(1.234e100)
pretty(1001.1001)
pretty(1001.1001, shrink.sml = 0.2)
for(k in -7:3)
  cat("shrink=", formatC(2^k, width = 9),":",
      formatC(pretty(1001.1001, shrink.sml = 2^k), width = 6),"\n")
</code></pre>

<hr>
<h2 id='Primitive'>Look Up a Primitive Function</h2><span id='topic+.Primitive'></span><span id='topic+primitive'></span>

<h3>Description</h3>

<p><code>.Primitive</code> looks up by name a &lsquo;primitive&rsquo;
(internally implemented) function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Primitive(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Primitive_+3A_name">name</code></td>
<td>
<p>name of the <span class="rlang"><b>R</b></span> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The advantage of <code>.Primitive</code> over <code><a href="#topic+.Internal">.Internal</a></code>
functions is the potential efficiency of argument passing, and that
positional matching can be used where desirable, e.g. in
<code><a href="#topic+switch">switch</a></code>. For more details, see the &lsquo;R Internals&rsquo;
manual.
</p>
<p>All primitive functions are in the base namespace.
</p>
<p>This function is almost never used: <code>`name`</code> or, more carefully,
<code><a href="#topic+get">get</a>(name, envir = baseenv())</code> work equally well and do
not depend on knowing which functions are primitive (which does change
as <span class="rlang"><b>R</b></span> evolves).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.primitive">is.primitive</a></code> showing that primitive functions come in
two types (<code><a href="#topic+typeof">typeof</a></code>),
<code><a href="#topic+.Internal">.Internal</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mysqrt &lt;- .Primitive("sqrt")
c
.Internal # this one *must* be primitive!
`if` # need backticks
</code></pre>

<hr>
<h2 id='print'>Print Values</h2><span id='topic+print'></span><span id='topic+print.factor'></span><span id='topic+print.function'></span><span id='topic+print.listof'></span><span id='topic+print.simple.list'></span><span id='topic+print.Dlist'></span><span id='topic+print.table'></span>

<h3>Description</h3>

<p><code>print</code> prints its argument and returns it <em>invisibly</em> (via
<code><a href="#topic+invisible">invisible</a>(x)</code>).  It is a generic function which means that
new printing methods can be easily added for new <code><a href="#topic+class">class</a></code>es.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
print(x, ...)

## S3 method for class 'factor'
print(x, quote = FALSE, max.levels = NULL,
      width = getOption("width"), ...)

## S3 method for class 'table'
print(x, digits = getOption("digits"), quote = FALSE,
      na.print = "", zero.print = "0",
      right = is.numeric(x) || is.complex(x),
      justify = "none", ...)

## S3 method for class 'function'
print(x, useSource = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>an object used to select a method.</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="print_+3A_quote">quote</code></td>
<td>
<p>logical, indicating whether or not strings should be
printed with surrounding quotes.</p>
</td></tr>
<tr><td><code id="print_+3A_max.levels">max.levels</code></td>
<td>
<p>integer, indicating how many levels should be
printed for a factor; if <code>0</code>, no extra &quot;Levels&quot; line will be
printed.  The default, <code>NULL</code>, entails choosing <code>max.levels</code>
such that the levels print on one line of width <code>width</code>.</p>
</td></tr>
<tr><td><code id="print_+3A_width">width</code></td>
<td>
<p>only used when <code>max.levels</code> is NULL, see above.</p>
</td></tr>
<tr><td><code id="print_+3A_digits">digits</code></td>
<td>
<p>minimal number of <em>significant</em> digits, see
<code><a href="#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print_+3A_na.print">na.print</code></td>
<td>
<p>character string (or <code>NULL</code>) indicating
<code><a href="#topic+NA">NA</a></code> values in printed output, see
<code><a href="#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print_+3A_zero.print">zero.print</code></td>
<td>
<p>character specifying how zeros (<code>0</code>) should be
printed; for sparse tables, using <code>"."</code> can produce more
readable results, similar to printing sparse matrices in <a href="https://CRAN.R-project.org/package=Matrix"><span class="pkg">Matrix</span></a>.</p>
</td></tr>
<tr><td><code id="print_+3A_right">right</code></td>
<td>
<p>logical, indicating whether or not strings should be
right aligned.</p>
</td></tr>
<tr><td><code id="print_+3A_justify">justify</code></td>
<td>
<p>character indicating if strings should left- or
right-justified or left alone, passed to <code><a href="#topic+format">format</a></code>.</p>
</td></tr>
<tr><td><code id="print_+3A_usesource">useSource</code></td>
<td>
<p>logical indicating if internally stored source
should be used for printing when present, e.g., if
<code><a href="#topic+options">options</a>(keep.source = TRUE)</code> has been in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default method, <code><a href="#topic+print.default">print.default</a></code> has its own help page.
Use <code><a href="utils.html#topic+methods">methods</a>("print")</code> to get all the methods for the
<code>print</code> generic.
</p>
<p><code>print.factor</code> allows some customization and is used for printing
<code><a href="#topic+ordered">ordered</a></code> factors as well.
</p>
<p><code>print.table</code> for printing <code><a href="#topic+table">table</a></code>s allows other
customization.  As of R 3.0.0, it only prints a description in case of a table
with 0-extents (this can happen if a classifier has no valid data).
</p>
<p>See <code><a href="#topic+noquote">noquote</a></code> as an example of a class whose main
purpose is a specific <code>print</code> method.
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>The default method <code><a href="#topic+print.default">print.default</a></code>, and help for the
methods above; further <code><a href="#topic+options">options</a></code>, <code><a href="#topic+noquote">noquote</a></code>.
</p>
<p>For more customizable (but cumbersome) printing, see
<code><a href="#topic+cat">cat</a></code>, <code><a href="#topic+format">format</a></code> or also <code><a href="#topic+write">write</a></code>.
For a simple prototypical print method, see
<code><a href="tools.html#topic+print.via.format">.print.via.format</a></code> in package <span class="pkg">tools</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

ts(1:20)  #-- print is the "Default function" --&gt; print.ts(.) is called
for(i in 1:3) print(1:i)

## Printing of factors
attenu$station ## 117 levels -&gt; 'max.levels' depending on width

## ordered factors: levels  "l1 &lt; l2 &lt; .."
esoph$agegp[1:12]
esoph$alcgp[1:12]

## Printing of sparse (contingency) tables
set.seed(521)
t1 &lt;- round(abs(rt(200, df = 1.8)))
t2 &lt;- round(abs(rt(200, df = 1.4)))
table(t1, t2) # simple
print(table(t1, t2), zero.print = ".") # nicer to read

## same for non-integer "table":
T &lt;- table(t2,t1)
T &lt;- T * (1+round(rlnorm(length(T)))/4)
print(T, zero.print = ".") # quite nicer,
print.table(T[,2:8] * 1e9, digits=3, zero.print = ".")
## still slightly inferior to  Matrix::Matrix(T)  for larger T

## Corner cases with empty extents:
table(1, NA) # &lt; table of extent 1 x 0 &gt;
</code></pre>

<hr>
<h2 id='print.data.frame'>Printing Data Frames</h2><span id='topic+print.data.frame'></span>

<h3>Description</h3>

<p>Print a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
print(x, ..., digits = NULL,
      quote = FALSE, right = TRUE, row.names = TRUE, max = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.data.frame_+3A_x">x</code></td>
<td>
<p>object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>print</code> methods.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_digits">digits</code></td>
<td>
<p>the minimum number of significant digits to be used: see
<code><a href="#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_quote">quote</code></td>
<td>
<p>logical, indicating whether or not entries should be
printed with surrounding quotes.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_right">right</code></td>
<td>
<p>logical, indicating whether or not strings should be
right-aligned.  The default is right-alignment.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_row.names">row.names</code></td>
<td>
<p>logical (or character vector), indicating whether (or
what) row names should be printed.</p>
</td></tr>
<tr><td><code id="print.data.frame_+3A_max">max</code></td>
<td>
<p>numeric or <code>NULL</code>, specifying the maximal number of
entries to be printed.  By default, when <code>NULL</code>,
<code><a href="#topic+getOption">getOption</a>("max.print")</code> used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls <code><a href="#topic+format">format</a></code> which formats the data frame
column-by-column, then converts to a character matrix and dispatches
to the <code>print</code> method for matrices.
</p>
<p>When <code>quote = TRUE</code> only the entries are quoted not the row names
nor the column names.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(dd &lt;- data.frame(x = 1:8, f = gl(2,4), ch = I(letters[1:8])))
     # print() with defaults
print(dd, quote = TRUE, row.names = FALSE)
     # suppresses row.names and quotes all entries
</code></pre>

<hr>
<h2 id='print.default'>Default Printing</h2><span id='topic+print.default'></span>

<h3>Description</h3>

<p><code>print.default</code> is the <em>default</em> method of the generic
<code><a href="#topic+print">print</a></code> function which prints its argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
print(x, digits = NULL, quote = TRUE,
      na.print = NULL, print.gap = NULL, right = FALSE,
      max = NULL, width = NULL, useSource = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.default_+3A_x">x</code></td>
<td>
<p>the object to be printed.</p>
</td></tr>
<tr><td><code id="print.default_+3A_digits">digits</code></td>
<td>
<p>a non-null value for <code>digits</code> specifies the minimum
number of significant digits to be printed in values.  The default,
<code>NULL</code>, uses <code><a href="#topic+getOption">getOption</a>("digits")</code>.  (For the
interpretation for complex numbers see <code><a href="#topic+signif">signif</a></code>.)
Non-integer values will be rounded down, and only values
greater than or equal to 1 and no greater than 22 are accepted.
</p>
</td></tr>
<tr><td><code id="print.default_+3A_quote">quote</code></td>
<td>
<p>logical, indicating whether or not strings
(<code><a href="#topic+character">character</a></code>s) should be printed with surrounding quotes.</p>
</td></tr>
<tr><td><code id="print.default_+3A_na.print">na.print</code></td>
<td>
<p>a character string which is used to indicate
<code><a href="#topic+NA">NA</a></code> values in printed output, or <code>NULL</code>
(see &lsquo;Details&rsquo;).</p>
</td></tr>
<tr><td><code id="print.default_+3A_print.gap">print.gap</code></td>
<td>
<p>a non-negative integer <code class="reqn">\le 1024</code>,
or <code>NULL</code> (meaning 1), giving the spacing between adjacent
columns in printed vectors, matrices and arrays.</p>
</td></tr>
<tr><td><code id="print.default_+3A_right">right</code></td>
<td>
<p>logical, indicating whether or not strings should be
right aligned.  The default is left alignment.</p>
</td></tr>
<tr><td><code id="print.default_+3A_max">max</code></td>
<td>
<p>a non-null value for <code>max</code> specifies the approximate
maximum number of entries to be printed.  The default, <code>NULL</code>,
uses <code><a href="#topic+getOption">getOption</a>("max.print")</code>: see that help page for more
details.</p>
</td></tr>
<tr><td><code id="print.default_+3A_width">width</code></td>
<td>
<p>controls the maximum number of columns on a line used in
printing vectors, matrices, etc.  The default, <code>NULL</code>, uses
<code><a href="#topic+getOption">getOption</a>("width")</code>: see that help page for more
details including allowed values.</p>
</td></tr>
<tr><td><code id="print.default_+3A_usesource">useSource</code></td>
<td>
<p>logical, indicating whether to use source
references or copies rather than deparsing <a href="#topic+language+20objects">language objects</a>.
The default is to use the original source if it is available.</p>
</td></tr>
<tr><td><code id="print.default_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other
methods.  They are ignored in this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default for printing <code>NA</code>s is to print <code>NA</code> (without
quotes) unless this is a character <code>NA</code> <em>and</em> <code>quote =
    FALSE</code>, when &lsquo;<span class="samp">&#8288;&lt;NA&gt;&#8288;</span>&rsquo; is printed.
</p>
<p>The same number of decimal places is used throughout a vector.  This
means that <code>digits</code> specifies the minimum number of significant
digits to be used, and that at least one entry will be encoded with
that minimum number.  However, if all the encoded elements then have
trailing zeroes, the number of decimal places is reduced until at
least one element has a non-zero final digit.  Decimal points are only
included if at least one decimal place is selected.
</p>
<p>Attributes are printed respecting their class(es), using the values of
<code>digits</code> to <code>print.default</code>, but using the default values
(for the methods called) of the other arguments.
</p>
<p>Option <code>width</code> controls the printing of vectors, matrices and
arrays, and option <code>deparse.cutoff</code> controls the printing of
<a href="#topic+language+20objects">language objects</a> such as calls and formulae.
</p>
<p>When the <span class="pkg">methods</span> package is attached, <code>print</code> will call
<code><a href="methods.html#topic+show">show</a></code> for <span class="rlang"><b>R</b></span> objects with formal classes (&lsquo;S4&rsquo;)
if called with no optional arguments.
</p>


<h3>Large number of digits</h3>

<p>Note that for large values of <code>digits</code>, currently for
<code>digits &gt;= 16</code>, the calculation of the number of significant
digits will depend on the platform's internal (C library)
implementation of &lsquo;<span class="samp">&#8288;sprintf()&#8288;</span>&rsquo; functionality.
</p>


<h3>Single-byte locales</h3>

<p>If a non-printable character is encountered during output, it is
represented as one of the ANSI escape sequences (&lsquo;<span class="samp">&#8288;\a&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\b&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;\f&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\n&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\r&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\t&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\v&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\\&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;\0&#8288;</span>&rsquo;: see <a href="#topic+Quotes">Quotes</a>), or failing that as a 3-digit octal
code: for example the UK currency pound sign in the C locale (if
implemented correctly) is printed as &lsquo;<span class="samp">&#8288;\243&#8288;</span>&rsquo;.  Which characters
are non-printable depends on the locale.
(Because some versions of Windows get this wrong, all bytes with the
upper bit set are regarded as printable on Windows in a single-byte
locale.)
</p>


<h3>Unicode and other multi-byte locales</h3>

<p>In all locales, the characters in the ASCII range (&lsquo;<span class="samp">&#8288;0x00&#8288;</span>&rsquo; to
&lsquo;<span class="samp">&#8288;0x7f&#8288;</span>&rsquo;) are printed in the same way, as-is if printable, otherwise
via ANSI escape sequences or 3-digit octal escapes as described for
single-byte locales. Whether a character is printable depends on the
current locale and the operating system (C library).
</p>
<p>Multi-byte non-printing characters are printed as an escape sequence
of the form &lsquo;<span class="samp">&#8288;\uxxxx&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;\Uxxxxxxxx&#8288;</span>&rsquo; (in hexadecimal).
This is the internal code for the wide-character representation of the
character.  If this is not known to be Unicode code points, a warning is
issued.  The only known exceptions are certain Japanese ISO 2022
locales on commercial Unixes, which use a concatenation of the bytes:
it is unlikely that <span class="rlang"><b>R</b></span> compiles on such a system.
</p>
<p>It is possible to have a character string in a character vector that
is not valid in the current locale.  If a byte is encountered that is
not part of a valid character it is printed in hex in the form
&lsquo;<span class="samp">&#8288;\xab&#8288;</span>&rsquo; and this is repeated until the start of a valid character.
(This will rapidly recover from minor errors in UTF-8.)
</p>


<h3>See Also</h3>

<p>The generic <code><a href="#topic+print">print</a></code>, <code><a href="#topic+options">options</a></code>.
The <code>"<a href="#topic+noquote">noquote</a>"</code> class and print method.
</p>
<p><code><a href="#topic+encodeString">encodeString</a></code>, which encodes a character vector the way
it would be printed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pi
print(pi, digits = 16)
LETTERS[1:16]
print(LETTERS, quote = FALSE)

M &lt;- cbind(I = 1, matrix(1:10000, ncol = 10,
                         dimnames = list(NULL, LETTERS[1:10])))
utils::head(M)        # makes more sense than
print(M, max = 1000)  # prints 90 rows and a message about omitting 910
</code></pre>

<hr>
<h2 id='prmatrix'>Print Matrices, Old-style</h2><span id='topic+prmatrix'></span>

<h3>Description</h3>

<p>An earlier method for printing matrices, provided for S compatibility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prmatrix(x, rowlab =, collab =,
         quote = TRUE, right = FALSE, na.print = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prmatrix_+3A_x">x</code></td>
<td>
<p>numeric or character matrix.</p>
</td></tr>
<tr><td><code id="prmatrix_+3A_rowlab">rowlab</code>, <code id="prmatrix_+3A_collab">collab</code></td>
<td>
<p>(optional) character vectors giving row or column
names respectively.  By default, these are taken from
<code><a href="#topic+dimnames">dimnames</a>(x)</code>.</p>
</td></tr>
<tr><td><code id="prmatrix_+3A_quote">quote</code></td>
<td>
<p>logical; if <code>TRUE</code> and <code>x</code> is of mode
<code>"character"</code>, <em>quotes</em> (&lsquo;<span class="samp">&#8288;"&#8288;</span>&rsquo;) are used.</p>
</td></tr> 
<tr><td><code id="prmatrix_+3A_right">right</code></td>
<td>
<p> if <code>TRUE</code> and <code>x</code> is of mode
<code>"character"</code>, the output columns are <em>right</em>-justified.</p>
</td></tr>
<tr><td><code id="prmatrix_+3A_na.print">na.print</code></td>
<td>
<p>how <code>NA</code>s are printed.  If this is non-null, its
value is used to represent <code>NA</code>.</p>
</td></tr>
<tr><td><code id="prmatrix_+3A_...">...</code></td>
<td>
<p>arguments for <code>print</code> methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>prmatrix</code> is an earlier form of <code>print.matrix</code>, and
is very similar to the S function of the same name.
</p>


<h3>Value</h3>

<p>Invisibly returns its argument, <code>x</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.default">print.default</a></code>, and other <code><a href="#topic+print">print</a></code> methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prmatrix(m6 &lt;- diag(6), rowlab = rep("", 6), collab = rep("", 6))

chm &lt;- matrix(scan(system.file("help", "AnIndex", package = "splines"),
                   what = ""), , 2, byrow = TRUE)
chm  # uses print.matrix()
prmatrix(chm, collab = paste("Column", 1:3), right = TRUE, quote = FALSE)
</code></pre>

<hr>
<h2 id='proc.time'>Running Time of R</h2><span id='topic+proc.time'></span><span id='topic+print.proc_time'></span><span id='topic+summary.proc_time'></span>

<h3>Description</h3>

<p><code>proc.time</code> determines how much real and CPU time (in seconds)
the currently running <span class="rlang"><b>R</b></span> process has already taken.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proc.time()
</code></pre>


<h3>Details</h3>

<p><code>proc.time</code> returns five elements for backwards compatibility,
but its <code>print</code> method prints a named vector of
length 3.  The first two entries are the total user and system CPU
times of the current <span class="rlang"><b>R</b></span> process and any child processes on which it
has waited, and the third entry is the &lsquo;real&rsquo; elapsed time
since the process was started.
</p>


<h3>Value</h3>

<p>An object of class <code>"proc_time"</code> which is a numeric vector of
length 5, containing the user, system, and total elapsed times for the
currently running <span class="rlang"><b>R</b></span> process, and the cumulative sum of user and
system times of any child processes spawned by it on which it has
waited.  (The <code>print</code> method uses the <code>summary</code> method to
combine the child times with those of the main process.)
</p>
<p>The definition of &lsquo;user&rsquo; and &lsquo;system&rsquo; times is from your
OS.  Typically it is something like
</p>
<p><em>The &lsquo;user time&rsquo; is the CPU time charged for the execution
of user instructions of the calling process.  The &lsquo;system time&rsquo;
is the CPU time charged for execution by the system on behalf of the
calling process.</em>
</p>
<p>Times of child processes are not available on Windows and will always
be given as <code>NA</code>.
</p>
<p>The resolution of the times will be system-specific and on Unix-alikes
times are rounded down to milliseconds.  On modern systems they will
be that accurate, but on older systems they might be accurate to 1/100
or 1/60 sec.  They are typically available to 10ms on Windows.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+system.time">system.time</a></code> for timing an <span class="rlang"><b>R</b></span> expression,
<code><a href="#topic+gc.time">gc.time</a></code> for how much of the time was spent in garbage
collection.
</p>
<p><code><a href="#topic+setTimeLimit">setTimeLimit</a></code> to <em>limit</em> the CPU or elapsed time for
the session or an expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## a way to time an R expression: system.time is preferred
ptm &lt;- proc.time()
for (i in 1:50) mad(stats::runif(500))
proc.time() - ptm
</code></pre>

<hr>
<h2 id='prod'>Product of Vector Elements</h2><span id='topic+prod'></span>

<h3>Description</h3>

<p><code>prod</code> returns the product of all the values
present in its arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prod(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prod_+3A_...">...</code></td>
<td>
<p>numeric or complex or logical vectors.</p>
</td></tr>
<tr><td><code id="prod_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values be removed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>na.rm</code> is <code>FALSE</code> an <code>NA</code>
value in any of the arguments will cause
a value of <code>NA</code> to be returned, otherwise
<code>NA</code> values are ignored.
</p>
<p>This is a generic function: methods can be defined for it
directly or via the <code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.
For this to work properly, the arguments <code>...</code> should be
unnamed, and dispatch is on the first argument.
</p>
<p>Logical true values are regarded as one, false values as zero.
For historical reasons, <code>NULL</code> is accepted and treated as if it
were <code>numeric(0)</code>.
</p>


<h3>Value</h3>

<p>The product, a numeric (of type <code>"double"</code>) or complex vector of length one.
<strong>NB:</strong> the product of an empty set is one, by definition.
</p>


<h3>S4 methods</h3>

<p>This is part of the S4 <code><a href="methods.html#topic+S4groupGeneric">Summary</a></code>
group generic.  Methods for it must use the signature
<code>x, ..., na.rm</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sum">sum</a></code>,
<code><a href="#topic+cumprod">cumprod</a></code>, <code><a href="#topic+cumsum">cumsum</a></code>.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>prod</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(prod(1:7)) == print(gamma(8))
</code></pre>

<hr>
<h2 id='proportions'>Express Table Entries as Fraction of Marginal Table</h2><span id='topic+proportions'></span><span id='topic+prop.table'></span>

<h3>Description</h3>

<p>Returns conditional proportions given <code>margins</code>, i.e.,
entries of <code>x</code>, divided by the appropriate marginal sums.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportions(x, margin = NULL)
prop.table(x, margin = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proportions_+3A_x">x</code></td>
<td>
<p>an array, usually a <code><a href="#topic+table">table</a></code>.</p>
</td></tr>
<tr><td><code id="proportions_+3A_margin">margin</code></td>
<td>
<p>a vector giving the margins to split by.
E.g., for a matrix <code>1</code> indicates rows, <code>2</code> indicates
columns, <code>c(1, 2)</code> indicates rows and columns.
When <code>x</code> has named <code><a href="#topic+dimnames">dimnames</a></code>, it can be a character vector
selecting dimension names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table or array like <code>x</code>, expressed relative to <code>margin</code>.
</p>


<h3>Note</h3>

<p><code>prop.table</code> is an earlier name, retained for back-compatibility.</p>


<h3>Author(s)</h3>

<p> Peter Dalgaard </p>


<h3>See Also</h3>

<p><code><a href="#topic+marginSums">marginSums</a></code>.
</p>
<p><code><a href="#topic+apply">apply</a></code> and <code><a href="#topic+sweep">sweep</a></code> are more general
mechanisms for sweeping out marginal statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m &lt;- matrix(1:4, 2)
m
proportions(m, 1)

DF &lt;- as.data.frame(UCBAdmissions)
tbl &lt;- xtabs(Freq ~ Gender + Admit, DF)
tbl
proportions(tbl, "Gender")
</code></pre>

<hr>
<h2 id='pushBack'>Push Text Back on to a Connection</h2><span id='topic+pushBack'></span><span id='topic+pushBackLength'></span><span id='topic+clearPushBack'></span>

<h3>Description</h3>

<p>Functions to push back text lines onto a <a href="#topic+connection">connection</a>, and to enquire
how many lines are currently pushed back.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pushBack(data, connection, newLine = TRUE,
         encoding = c("", "bytes", "UTF-8"))
pushBackLength(connection)
clearPushBack(connection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pushBack_+3A_data">data</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="pushBack_+3A_connection">connection</code></td>
<td>
<p>a <a href="#topic+connection">connection</a>.</p>
</td></tr>
<tr><td><code id="pushBack_+3A_newline">newLine</code></td>
<td>
<p>logical.  If true, a newline is appended to each string
pushed back.</p>
</td></tr>
<tr><td><code id="pushBack_+3A_encoding">encoding</code></td>
<td>
<p>character string, partially matched.  See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several character strings can be pushed back on one or more occasions.
The occasions form a stack, so the first line to be retrieved will be
the first string from the last call to <code>pushBack</code>.  Lines which
are pushed back are read prior to the normal input from the
connection, by the normal text-reading functions such as
<code><a href="#topic+readLines">readLines</a></code> and <code><a href="#topic+scan">scan</a></code>.
</p>
<p>Pushback is only allowed for readable connections in text mode.
</p>
<p>Not all uses of connections respect pushbacks, in particular the input
connection is still wired directly, so for example parsing
commands from the console and <code><a href="#topic+scan">scan</a>("")</code> ignore pushbacks on
<code><a href="#topic+stdin">stdin</a></code>.
</p>
<p>When character strings with a marked encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>) are pushed back they are converted to the
current encoding if <code>encoding = ""</code>.  This may involve
representing characters as &lsquo;<span class="samp">&#8288;&lt;U+xxxx&gt;&#8288;</span>&rsquo; if they cannot be
converted.  They will be converted to UTF-8 if <code>encoding =
  "UTF-8"</code> or left as-is if <code>encoding = "bytes"</code>.
</p>


<h3>Value</h3>

<p><code>pushBack</code> and <code>clearPushBack()</code> return nothing, invisibly.
</p>
<p><code>pushBackLength</code> returns the number of lines currently pushed back.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+readLines">readLines</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>zz &lt;- textConnection(LETTERS)
readLines(zz, 2)
pushBack(c("aa", "bb"), zz)
pushBackLength(zz)
readLines(zz, 1)
pushBackLength(zz)
readLines(zz, 1)
readLines(zz, 1)
close(zz)
</code></pre>

<hr>
<h2 id='qr'>The QR Decomposition of a Matrix</h2><span id='topic+qr'></span><span id='topic+qr.default'></span><span id='topic+qr.coef'></span><span id='topic+qr.qy'></span><span id='topic+qr.qty'></span><span id='topic+qr.resid'></span><span id='topic+qr.fitted'></span><span id='topic+qr.solve'></span><span id='topic+is.qr'></span><span id='topic+as.qr'></span><span id='topic+solve.qr'></span>

<h3>Description</h3>

<p><code>qr</code> computes the QR decomposition of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qr(x, ...)
## Default S3 method:
qr(x, tol = 1e-07 , LAPACK = FALSE, ...)

qr.coef(qr, y)
qr.qy(qr, y)
qr.qty(qr, y)
qr.resid(qr, y)
qr.fitted(qr, y, k = qr$rank)
qr.solve(a, b, tol = 1e-7)
## S3 method for class 'qr'
solve(a, b, ...)

is.qr(x)
as.qr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qr_+3A_x">x</code></td>
<td>
<p>a numeric or complex matrix whose QR decomposition is to be
computed.  Logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="qr_+3A_tol">tol</code></td>
<td>
<p>the tolerance for detecting linear dependencies in the
columns of <code>x</code>. Only used if <code>LAPACK</code> is false and
<code>x</code> is real.</p>
</td></tr>
<tr><td><code id="qr_+3A_qr">qr</code></td>
<td>
<p>a QR decomposition of the type computed by <code>qr</code>.</p>
</td></tr>
<tr><td><code id="qr_+3A_y">y</code>, <code id="qr_+3A_b">b</code></td>
<td>
<p>a vector or matrix of right-hand sides of equations.</p>
</td></tr>
<tr><td><code id="qr_+3A_a">a</code></td>
<td>
<p>a QR decomposition or (<code>qr.solve</code> only) a rectangular matrix.</p>
</td></tr>
<tr><td><code id="qr_+3A_k">k</code></td>
<td>
<p>effective rank.</p>
</td></tr>
<tr><td><code id="qr_+3A_lapack">LAPACK</code></td>
<td>
<p>logical.  For real <code>x</code>, if true use LAPACK
otherwise use LINPACK (the default).</p>
</td></tr>
<tr><td><code id="qr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The QR decomposition plays an important role in many
statistical techniques.  In particular it can be used to solve the
equation <code class="reqn">\bold{Ax} = \bold{b}</code> for given matrix <code class="reqn">\bold{A}</code>,
and vector <code class="reqn">\bold{b}</code>.  It is useful for computing regression
coefficients and in applying the Newton-Raphson algorithm.
</p>
<p>The functions <code>qr.coef</code>, <code>qr.resid</code>, and <code>qr.fitted</code>
return the coefficients, residuals and fitted values obtained when
fitting <code>y</code> to the matrix with QR decomposition <code>qr</code>.
(If pivoting is used, some of the coefficients will be <code>NA</code>.)
<code>qr.qy</code> and <code>qr.qty</code> return <code>Q %*% y</code> and
<code>t(Q) %*% y</code>, where <code>Q</code> is the (complete) <code class="reqn">\bold{Q}</code> matrix.
</p>
<p>All the above functions keep <code>dimnames</code> (and <code>names</code>) of
<code>x</code> and <code>y</code> if there are any.
</p>
<p><code>solve.qr</code> is the method for <code><a href="#topic+solve">solve</a></code> for <code>qr</code> objects.
<code>qr.solve</code> solves systems of equations via the QR decomposition:
if <code>a</code> is a QR decomposition it is the same as <code>solve.qr</code>,
but if <code>a</code> is a rectangular matrix the QR decomposition is
computed first.  Either will handle over- and under-determined
systems, providing a least-squares fit if appropriate.
</p>
<p><code>is.qr</code> returns <code>TRUE</code> if <code>x</code> is a <code><a href="#topic+list">list</a></code>
and <code><a href="#topic+inherits">inherits</a></code> from <code>"qr"</code>.
</p>
<p>It is not possible to coerce objects to mode <code>"qr"</code>.  Objects
either are QR decompositions or they are not.
</p>
<p>The LINPACK interface is restricted to matrices <code>x</code> with less
than <code class="reqn">2^{31}</code> elements.
</p>
<p><code>qr.fitted</code> and <code>qr.resid</code> only support the LINPACK interface.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>


<h3>Value</h3>

<p>The QR decomposition of the matrix as computed by LINPACK(*) or LAPACK.
The components in the returned value correspond directly
to the values returned by DQRDC(2)/DGEQP3/ZGEQP3.
</p>
<table>
<tr><td><code>qr</code></td>
<td>
<p>a matrix with the same dimensions as <code>x</code>.
The upper triangle contains the <code class="reqn">\bold{R}</code> of the decomposition
and the lower triangle contains information on the <code class="reqn">\bold{Q}</code> of
the decomposition (stored in compact form).  Note that the storage
used by DQRDC and DGEQP3 differs.</p>
</td></tr>
<tr><td><code>qraux</code></td>
<td>
<p>a vector of length <code>ncol(x)</code> which contains
additional information on <code class="reqn">\bold{Q}</code>.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the rank of <code>x</code> as computed by the decomposition(*):
always full rank in the LAPACK case.</p>
</td></tr>
<tr><td><code>pivot</code></td>
<td>
<p>information on the pivoting strategy used during
the decomposition.</p>
</td></tr>
</table>
<p>Non-complex QR objects computed by LAPACK have the attribute
<code>"useLAPACK"</code> with value <code>TRUE</code>.
</p>


<h3><code>*)</code>  <code>dqrdc2</code> instead of LINPACK's DQRDC</h3>

<p>In the (default) LINPACK case (<code>LAPACK = FALSE</code>), <code>qr()</code>
uses a <em>modified</em> version of LINPACK's DQRDC, called
&lsquo;<code>dqrdc2</code>&rsquo;.  It differs by using the tolerance <code>tol</code>
for a pivoting strategy which moves columns with near-zero 2-norm to
the right-hand edge of the x matrix.  This strategy means that
sequential one degree-of-freedom effects can be computed in a natural
way.
</p>


<h3>Note</h3>

<p>To compute the determinant of a matrix (do you <em>really</em> need it?),
the QR decomposition is much more efficient than using eigenvalues
(<code><a href="#topic+eigen">eigen</a></code>).  See <code><a href="#topic+det">det</a></code>.
</p>
<p>Using LAPACK (including in the complex case) uses column pivoting and
does not attempt to detect rank-deficient matrices.
</p>


<h3>Source</h3>

<p>For <code>qr</code>, the LINPACK routine <code>DQRDC</code> (but modified to
<code>dqrdc2</code>(*)) and the LAPACK
routines <code>DGEQP3</code> and <code>ZGEQP3</code>.  Further LINPACK and LAPACK
routines are used for <code>qr.coef</code>, <code>qr.qy</code> and <code>qr.aty</code>.
</p>
<p>LAPACK and LINPACK are from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and
<a href="https://netlib.org/linpack/">https://netlib.org/linpack/</a> and their guides are listed
in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition. SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Dongarra, J. J., Bunch, J. R., Moler, C. B. and Stewart, G. W. (1978)
<em>LINPACK Users Guide.</em>  Philadelphia: SIAM Publications.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qr.Q">qr.Q</a></code>,  <code><a href="#topic+qr.R">qr.R</a></code>,  <code><a href="#topic+qr.X">qr.X</a></code> for
reconstruction of the matrices.
<code><a href="stats.html#topic+lm.fit">lm.fit</a></code>,  <code><a href="stats.html#topic+lsfit">lsfit</a></code>,
<code><a href="#topic+eigen">eigen</a></code>, <code><a href="#topic+svd">svd</a></code>.
</p>
<p><code><a href="#topic+det">det</a></code> (using <code>qr</code>) to compute the determinant of a matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, `+`) }
h9 &lt;- hilbert(9); h9
qr(h9)$rank           #--&gt; only 7
qrh9 &lt;- qr(h9, tol = 1e-10)
qrh9$rank             #--&gt; 9
##-- Solve linear equation system  H %*% x = y :
y &lt;- 1:9/10
x &lt;- qr.solve(h9, y, tol = 1e-10) # or equivalently :
x &lt;- qr.coef(qrh9, y) #-- is == but much better than
                      #-- solve(h9) %*% y
h9 %*% x              # = y


## overdetermined system
A &lt;- matrix(runif(12), 4)
b &lt;- 1:4
qr.solve(A, b) # or solve(qr(A), b)
solve(qr(A, LAPACK = TRUE), b)
# this is a least-squares solution, cf. lm(b ~ 0 + A)

## underdetermined system
A &lt;- matrix(runif(12), 3)
b &lt;- 1:3
qr.solve(A, b)
solve(qr(A, LAPACK = TRUE), b)
# solutions will have one zero, not necessarily the same one
</code></pre>

<hr>
<h2 id='QR.Auxiliaries'>Reconstruct the Q, R, or X Matrices from a QR Object</h2><span id='topic+qr.X'></span><span id='topic+qr.Q'></span><span id='topic+qr.R'></span>

<h3>Description</h3>

<p>Returns the original matrix from which the object was constructed or
the components of the decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qr.X(qr, complete = FALSE, ncol =)
qr.Q(qr, complete = FALSE, Dvec =)
qr.R(qr, complete = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QR.Auxiliaries_+3A_qr">qr</code></td>
<td>
<p>object representing a QR decomposition.  This will
typically have come from a previous call to <code><a href="#topic+qr">qr</a></code> or
<code><a href="stats.html#topic+lsfit">lsfit</a></code>.</p>
</td></tr>
<tr><td><code id="QR.Auxiliaries_+3A_complete">complete</code></td>
<td>
<p>logical expression of length 1.  Indicates whether an
arbitrary  orthogonal completion of the <code class="reqn">\bold{Q}</code> or
<code class="reqn">\bold{X}</code> matrices is to be made, or whether the <code class="reqn">\bold{R}</code>
matrix is to be completed  by binding zero-value rows beneath the
square upper triangle.</p>
</td></tr>
<tr><td><code id="QR.Auxiliaries_+3A_ncol">ncol</code></td>
<td>
<p>integer in the range <code>1:nrow(qr$qr)</code>.  The number
of columns to be in the reconstructed <code class="reqn">\bold{X}</code>.  The default
when <code>complete</code> is <code>FALSE</code> is the first
<code>min(ncol(X), nrow(X))</code> columns of the original <code class="reqn">\bold{X}</code>
from which the qr object was constructed.  The default when
<code>complete</code> is <code>TRUE</code> is a square matrix with the original
<code class="reqn">\bold{X}</code> in the first <code>ncol(X)</code> columns and an arbitrary
orthogonal completion (unitary completion in the complex case) in
the remaining columns.</p>
</td></tr>
<tr><td><code id="QR.Auxiliaries_+3A_dvec">Dvec</code></td>
<td>
<p>vector (not matrix) of diagonal values.  Each column of
the returned <code class="reqn">\bold{Q}</code> will be multiplied by the corresponding
diagonal value.  Defaults to all <code>1</code>s.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>qr.X</code> returns <code class="reqn">\bold{X}</code>, the original matrix from
which the qr object was constructed, provided <code>ncol(X) &lt;= nrow(X)</code>.
If <code>complete</code> is <code>TRUE</code> or the argument <code>ncol</code> is greater than
<code>ncol(X)</code>, additional columns from an arbitrary orthogonal
(unitary) completion of <code>X</code> are returned.
</p>
<p><code>qr.Q</code> returns part or all of <b>Q</b>, the orthogonal (unitary)
transformation of order <code>nrow(X)</code> represented by <code>qr</code>.  If 
<code>complete</code> is <code>TRUE</code>, <b>Q</b> has <code>nrow(X)</code> columns.
If <code>complete</code> is <code>FALSE</code>, <b>Q</b> has <code>ncol(X)</code>
columns.  When <code>Dvec</code> is specified, each column of <b>Q</b> is
multiplied by the corresponding value in <code>Dvec</code>.
</p>
<p>Note that <code>qr.Q(qr, *)</code> is a special case of
<code><a href="#topic+qr.qy">qr.qy</a>(qr, y)</code> (with a &ldquo;diagonal&rdquo; <code>y</code>), and
<code>qr.X(qr, *)</code> is basically <code><a href="#topic+qr.qy">qr.qy</a>(qr, R)</code> (apart from
pivoting and <code>dimnames</code> setting).
</p>
<p><code>qr.R</code> returns <b>R</b>.  This may be pivoted, e.g., if
<code>a &lt;- qr(x)</code> then <code>x[, a$pivot]</code> = <b>QR</b>.  The number of
rows of <b>R</b> is either <code>nrow(X)</code> or <code>ncol(X)</code> (and may
depend on whether <code>complete</code> is <code>TRUE</code> or <code>FALSE</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qr">qr</a></code>,
<code><a href="#topic+qr.qy">qr.qy</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- ncol(x &lt;- LifeCycleSavings[, -1]) # not the 'sr'
qrstr &lt;- qr(x)   # dim(x) == c(n,p)
qrstr $ rank # = 4 = p
Q &lt;- qr.Q(qrstr) # dim(Q) == dim(x)
R &lt;- qr.R(qrstr) # dim(R) == ncol(x)
X &lt;- qr.X(qrstr) # X == x
range(X - as.matrix(x))  # ~ &lt; 6e-12
## X == Q %*% R if there has been no pivoting, as here:
all.equal(unname(X),
          unname(Q %*% R))

# example of pivoting
x &lt;- cbind(int = 1,
           b1 = rep(1:0, each = 3), b2 = rep(0:1, each = 3),
           c1 = rep(c(1,0,0), 2), c2 = rep(c(0,1,0), 2), c3 = rep(c(0,0,1),2))
x # is singular, columns "b2" and "c3" are "extra"
a &lt;- qr(x)
zapsmall(qr.R(a)) # columns are int b1 c1 c2 b2 c3
a$pivot
pivI &lt;- sort.list(a$pivot) # the inverse permutation
all.equal (x,            qr.Q(a) %*% qr.R(a)) # no, no
stopifnot(
 all.equal(x[, a$pivot], qr.Q(a) %*% qr.R(a)),          # TRUE
 all.equal(x           , qr.Q(a) %*% qr.R(a)[, pivI]))  # TRUE too!
</code></pre>

<hr>
<h2 id='quit'>Terminate an R Session</h2><span id='topic+quit'></span><span id='topic+q'></span><span id='topic+.Last'></span><span id='topic+.Last.sys'></span>

<h3>Description</h3>

<p>The function <code>quit</code> or its alias <code>q</code> terminate the current
<span class="rlang"><b>R</b></span> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quit(save = "default", status = 0, runLast = TRUE)
   q(save = "default", status = 0, runLast = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quit_+3A_save">save</code></td>
<td>
<p>a character string indicating whether the environment
(workspace) should be saved, one of <code>"no"</code>, <code>"yes"</code>,
<code>"ask"</code> or <code>"default"</code>.</p>
</td></tr>
<tr><td><code id="quit_+3A_status">status</code></td>
<td>
<p>the (numerical) error status to be returned to the
operating system, where relevant.  Conventionally <code>0</code>
indicates successful completion.</p>
</td></tr>
<tr><td><code id="quit_+3A_runlast">runLast</code></td>
<td>
<p>should <code>.Last()</code> be executed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>save</code> must be one of <code>"no"</code>, <code>"yes"</code>,
<code>"ask"</code> or <code>"default"</code>.  In the first case the workspace
is not saved, in the second it is saved and in the third the user is
prompted and can also decide <em>not</em> to quit.  The default is to
ask in interactive use but may be overridden by command-line
arguments (which must be supplied in non-interactive use).
</p>
<p>Immediately <em>before</em> normal termination, <code>.Last()</code> is
executed if the function <code>.Last</code> exists and <code>runLast</code> is
true.  If in interactive use there are errors in the <code>.Last</code>
function, control will be returned to the command prompt, so do test
the function thoroughly.  There is a system analogue,
<code>.Last.sys()</code>, which is run after <code>.Last()</code> if
<code>runLast</code> is true.
</p>
<p>Exactly what happens at termination of an <span class="rlang"><b>R</b></span> session depends on the
platform and GUI interface in use.  A typical sequence is to run
<code>.Last()</code> and <code>.Last.sys()</code> (unless <code>runLast</code> is
false), to save the workspace if requested (and in most cases also
to save the session history: see <code><a href="utils.html#topic+savehistory">savehistory</a></code>), then
run any finalizers (see <code><a href="#topic+reg.finalizer">reg.finalizer</a></code>) that have been
set to be run on exit, close all open graphics devices, remove the
session temporary directory and print any remaining warnings
(e.g., from <code>.Last()</code> and device closure).
</p>
<p>Some error status values are used by <span class="rlang"><b>R</b></span> itself.  The default error
handler for non-interactive use effectively calls <code>q("no", 1,
    FALSE)</code> and returns error status 1.  Error status 2 is used for <span class="rlang"><b>R</b></span>
&lsquo;suicide&rsquo;, that is a catastrophic failure, and other small
numbers are used by specific ports for initialization failures.  It
is recommended that users choose statuses of 10 or more.
</p>
<p>Valid values of <code>status</code> are system-dependent, but <code>0:255</code>
are normally valid.  (Many OSes will report the last byte of the
value, that is report the value modulo 256.  But not all.)
</p>


<h3>Warning</h3>

<p>The value of <code>.Last</code> is for the end user to control: as
it can be replaced later in the session, it cannot safely be used
programmatically, e.g. by a package.  The other way to set code to be run
at the end of the session is to use a <em>finalizer</em>: see
<code><a href="#topic+reg.finalizer">reg.finalizer</a></code>.
</p>


<h3>Note</h3>

<p>The <code>R.app</code> GUI on macOS has its own version of these functions
with slightly different behaviour for the <code>save</code> argument (the
GUI's &lsquo;Startup&rsquo; preferences for this action are taken into account).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.First">.First</a></code> for setting things on startup.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: ## Unix-flavour example
.Last &lt;- function() {
  graphics.off() # close devices before printing
  cat("Now sending PDF graphics to the printer:\n")
  system("lpr Rplots.pdf")
  cat("bye bye...\n")
}
quit("yes")
## End(Not run)
</code></pre>

<hr>
<h2 id='Quotes'>Quotes</h2><span id='topic+Quotes'></span><span id='topic+backtick'></span><span id='topic+backquote'></span><span id='topic++27'></span><span id='topic++22'></span><span id='topic++60'></span>

<h3>Description</h3>

<p>Descriptions of the various uses of quoting in <span class="rlang"><b>R</b></span>.
</p>


<h3>Details</h3>

<p>Three types of quotes are part of the syntax of <span class="rlang"><b>R</b></span>: single and double
quotation marks and the backtick (or back quote, &lsquo;<span class="samp">&#8288;`&#8288;</span>&rsquo;).  In
addition, backslash is used to escape the following character
inside character constants.
</p>


<h3>Character constants</h3>

<p>Single and double quotes delimit character constants.  They can be used
interchangeably but double quotes are preferred (and character
constants are printed using double quotes), so single quotes are
normally only used to delimit character constants containing double
quotes.
</p>
<p>Backslash is used to start an escape sequence inside character
constants.  Escaping a character not in the following table is an
error.
</p>
<p>Single quotes need to be escaped by backslash in single-quoted
strings, and double quotes in double-quoted strings.
</p>

<table>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\n&#8288;</span>&rsquo;</td><td style="text-align: left;"> newline (aka &lsquo;line feed&rsquo;)</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\r&#8288;</span>&rsquo;</td><td style="text-align: left;"> carriage return</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\t&#8288;</span>&rsquo;</td><td style="text-align: left;"> tab</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\b&#8288;</span>&rsquo;</td><td style="text-align: left;"> backspace</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\a&#8288;</span>&rsquo;</td><td style="text-align: left;"> alert (bell)</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\f&#8288;</span>&rsquo;</td><td style="text-align: left;"> form feed</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\v&#8288;</span>&rsquo;</td><td style="text-align: left;"> vertical tab</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\\&#8288;</span>&rsquo;</td><td style="text-align: left;"> backslash &lsquo;<span class="samp">&#8288;\&#8288;</span>&rsquo;</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\'&#8288;</span>&rsquo;</td><td style="text-align: left;"> ASCII apostrophe &lsquo;<span class="samp">&#8288;'&#8288;</span>&rsquo;</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\"&#8288;</span>&rsquo;</td><td style="text-align: left;"> ASCII quotation mark &lsquo;<span class="samp">&#8288;"&#8288;</span>&rsquo;</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\`&#8288;</span>&rsquo;</td><td style="text-align: left;"> ASCII grave accent (backtick) &lsquo;<span class="samp">&#8288;`&#8288;</span>&rsquo;</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\nnn&#8288;</span>&rsquo;</td><td style="text-align: left;"> character with given octal code (1, 2 or 3 digits)</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\xnn&#8288;</span>&rsquo;</td><td style="text-align: left;"> character with given hex code (1 or 2 hex digits)</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\unnnn&#8288;</span>&rsquo;</td><td style="text-align: left;"> Unicode character with given code (1--4 hex digits)</td>
</tr>
<tr>
 <td style="text-align: left;">
    &lsquo;<span class="samp">&#8288;\Unnnnnnnn&#8288;</span>&rsquo;</td><td style="text-align: left;"> Unicode character with given code (1--8 hex digits)</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Alternative forms for the last two are &lsquo;<span class="samp">&#8288;\u{nnnn}&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;\U{nnnnnnnn}&#8288;</span>&rsquo;.  All except the Unicode escape sequences are
also supported when reading character strings by <code><a href="#topic+scan">scan</a></code>
and <code><a href="utils.html#topic+read.table">read.table</a></code> if <code>allowEscapes = TRUE</code>.  Unicode
escapes can be used to enter Unicode characters not in the current
locale's <abbr>charset</abbr> (when the string will be stored internally in UTF-8).
The maximum allowed value for &lsquo;<span class="samp">&#8288;\nnn&#8288;</span>&rsquo; is &lsquo;<span class="samp">&#8288;\377&#8288;</span>&rsquo; (the same
character as &lsquo;<span class="samp">&#8288;\xff&#8288;</span>&rsquo;).
</p>
<p>As from <span class="rlang"><b>R</b></span> 4.1.0 the largest allowed &lsquo;<span class="samp">&#8288;\U&#8288;</span>&rsquo; value is
&lsquo;<span class="samp">&#8288;\U10FFFF&#8288;</span>&rsquo;, the maximum Unicode point.
</p>
<p>The parser does not allow the use of both octal/hex and Unicode
escapes in a single string.
</p>
<p>These forms will also be used by <code><a href="#topic+print.default">print.default</a></code>
when outputting non-printable characters (including backslash).
</p>
<p>Embedded <abbr>NUL</abbr>s are not allowed in character strings, so using escapes
(such as &lsquo;<span class="samp">&#8288;\0&#8288;</span>&rsquo;) for a <abbr>NUL</abbr> will result in the string being
truncated at that point (usually with a warning).
</p>
<p>Raw character constants are also available using a syntax similar to
the one used in C++: <code>r"(...)"</code> with <code>...</code> any character
sequence, except that it must not contain the closing sequence
&lsquo;<span class="samp">&#8288;)"&#8288;</span>&rsquo;. 
The delimiter pairs <code>[]</code> and <code>{}</code> can also be
used, and <code>R</code> can be used in place of <code>r</code>.  For additional
flexibility, a number of dashes can be placed between the opening quote
and the opening delimiter, as long as the same number of dashes appear
between the closing delimiter and the closing quote.
</p>


<h3>Names and Identifiers</h3>

<p>Identifiers consist of a sequence of letters, digits, the period
(<code>.</code>) and the underscore.  They must not start with a digit nor
underscore, nor with a period followed by a digit.  <a href="#topic+Reserved">Reserved</a>
words are not valid identifiers.
</p>
<p>The definition of a <em>letter</em> depends on the current locale, but
only ASCII digits are considered to be digits.
</p>
<p>Such identifiers are also known as <em>syntactic names</em> and may be used
directly in <span class="rlang"><b>R</b></span> code.  Almost always, other names can be used
provided they are quoted.  The preferred quote is the backtick
(&lsquo;<span class="samp">&#8288;`&#8288;</span>&rsquo;), and <code><a href="#topic+deparse">deparse</a></code> will normally use it, but under
many circumstances single or double quotes can be used (as a character
constant will often be converted to a name).  One place where
backticks may be essential is to delimit variable names in formulae:
see <code><a href="stats.html#topic+formula">formula</a></code>.
</p>


<h3>Note</h3>

<p>UTF-16 surrogate pairs in &lsquo;<span class="samp">&#8288;\unnnn\uoooo&#8288;</span>&rsquo; form will be converted
to a single Unicode point, so for example &lsquo;<span class="samp">&#8288;\uD834\uDD1E&#8288;</span>&rsquo; gives
the single character &lsquo;<span class="samp">&#8288;\U1D11E&#8288;</span>&rsquo;.  However, unpaired values in
the surrogate range such as in the string <code>"abc\uD834de"</code> will be
converted to a non-standard-conformant UTF-8 string (as is done by most
other software): this may change in future.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Syntax">Syntax</a></code> for other aspects of the syntax.
</p>
<p><code><a href="#topic+sQuote">sQuote</a></code> for quoting English text.
</p>
<p><code><a href="#topic+shQuote">shQuote</a></code> for quoting OS commands.
</p>
<p>The  &lsquo;R Language Definition&rsquo; manual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
'single quotes can be used more-or-less interchangeably'
"with double quotes to create character vectors"

## Single quotes inside single-quoted strings need backslash-escaping.
## Ditto double quotes inside double-quoted strings.
##
identical('"It\'s alive!", he screamed.',
          "\"It's alive!\", he screamed.") # same

## Backslashes need doubling, or they have a special meaning.
x &lt;- "In ALGOL, you could do logical AND with /\\."
print(x)      # shows it as above ("input-like")
writeLines(x) # shows it as you like it ;-)

## Single backslashes followed by a letter are used to denote
## special characters like tab(ulator)s and newlines:
x &lt;- "long\tlines can be\nbroken with newlines"
writeLines(x) # see also ?strwrap

## Backticks are used for non-standard variable names.
## (See make.names and ?Reserved for what counts as
## non-standard.)
`x y` &lt;- 1:5
`x y`
d &lt;- data.frame(`1st column` = rchisq(5, 2), check.names = FALSE)
d$`1st column`

## Backslashes followed by up to three numbers are interpreted as
## octal notation for ASCII characters.
"\110\145\154\154\157\40\127\157\162\154\144\41"

## \x followed by up to two numbers is interpreted as
## hexadecimal notation for ASCII characters.
(hw1 &lt;- "\x48\x65\x6c\x6c\x6f\x20\x57\x6f\x72\x6c\x64\x21")

## Mixing octal and hexadecimal in the same string is OK
(hw2 &lt;- "\110\x65\154\x6c\157\x20\127\x6f\162\x6c\144\x21")

## \u is also hexadecimal, but supports up to 4 digits,
## using Unicode specification.  In the previous example,
## you can simply replace \x with \u.
(hw3 &lt;- "\u48\u65\u6c\u6c\u6f\u20\u57\u6f\u72\u6c\u64\u21")

## The last three are all identical to
hw &lt;- "Hello World!"
stopifnot(identical(hw, hw1), identical(hw1, hw2), identical(hw2, hw3))

## Using Unicode makes more sense for non-latin characters.
(nn &lt;- "\u0126\u0119\u1114\u022d\u2001\u03e2\u0954\u0f3f\u13d3\u147b\u203c")

## Mixing \x and \u throws a _parse_ error (which is not catchable!)
## Not run: 
  "\x48\u65\x6c\u6c\x6f\u20\x57\u6f\x72\u6c\x64\u21"

## End(Not run)
##   --&gt;   Error: mixing Unicode and octal/hex escapes .....

## \U works like \u, but supports up to six hex digits.
## So we can replace \u with \U in the previous example.
n2 &lt;- "\U0126\U0119\U1114\U022d\U2001\U03e2\U0954\U0f3f\U13d3\U147b\U203c"
stopifnot(identical(nn, n2))

## Under systems supporting multi-byte locales (and not Windows),
## \U also supports the rarer characters outside the usual 16^4 range.
## See the R language manual,
## https://cran.r-project.org/doc/manuals/r-release/R-lang.html#Literal-constants
## and bug 16098 https://bugs.r-project.org/show_bug.cgi?id=16098
## This character may or not be printable (the platform decides)
## and if it is, may not have a glyph in the font used.
"\U1d4d7" # On Windows this used to give the incorrect value of "\Ud4d7"

## nul characters (for terminating strings in C) are not allowed (parse errors)
## Not run: 
  "foo\0bar"     # Error: nul character not allowed (line 1)
  "foo\u0000bar" # same error

## End(Not run)

## A Windows path written as a raw string constant:
r"(c:\Program files\R)"

## More raw strings:
r"{(\1\2)}"
r"(use both "double" and 'single' quotes)"
r"---(\1--)-)---"
</code></pre>

<hr>
<h2 id='R.Version'>Version Information</h2><span id='topic+R.Version'></span><span id='topic+R.version'></span><span id='topic+version'></span><span id='topic+R.version.string'></span><span id='topic+R_compiled_by'></span>

<h3>Description</h3>

<p><code>R.Version()</code> provides detailed information about the version of
<span class="rlang"><b>R</b></span> running.
</p>
<p><code>R.version</code> is a variable (a <code><a href="#topic+list">list</a></code>) holding this
information (and <code>version</code> is a copy of it for S compatibility).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.Version()
R.version
R.version.string
version

R_compiled_by()
</code></pre>


<h3>Details</h3>

<p>This gives details of the OS under which <span class="rlang"><b>R</b></span> was built, not the one
under which it is currently running (for which see
<code><a href="#topic+Sys.info">Sys.info</a></code>).
</p>
<p>Note that OS names might not be what you expect: for example macOS
Mavericks 10.9.4 identifies itself as &lsquo;<span class="samp">&#8288;darwin13.3.0&#8288;</span>&rsquo;, Linux
usually as &lsquo;<span class="samp">&#8288;linux-gnu&#8288;</span>&rsquo;, Solaris 10 as &lsquo;<span class="samp">&#8288;solaris2.10&#8288;</span>&rsquo; and Windows
as &lsquo;<span class="samp">&#8288;mingw32&#8288;</span>&rsquo;.
</p>
<p><code>R.version$crt</code> is supported on Windows since <span class="rlang"><b>R</b></span> 4.2.0 and returns
<code>"ucrt"</code> to denote the Universal C Runtime.  It would return
<code>"msvcrt"</code> for the older Microsoft Visual C++ Runtime (but <span class="rlang"><b>R</b></span> does
not use that runtime since 4.2.0).
</p>


<h3>Value</h3>

<p><code>R.Version</code> returns a list with character-string components
</p>
<table>
<tr><td><code>platform</code></td>
<td>
<p>the platform for which <span class="rlang"><b>R</b></span> was built.  A triplet of the
form CPU-VENDOR-OS, as determined by the configure script.  E.g,
<code>"i686-unknown-linux-gnu"</code> or <code>"i386-pc-mingw32"</code>.
</p>
</td></tr>
<tr><td><code>arch</code></td>
<td>
<p>the architecture (CPU) <span class="rlang"><b>R</b></span> was built on/for.</p>
</td></tr>
<tr><td><code>os</code></td>
<td>
<p>the underlying operating system.</p>
</td></tr>
<tr><td><code>crt</code></td>
<td>
<p>the C runtime on Windows.</p>
</td></tr>
<tr><td><code>system</code></td>
<td>
<p>CPU and OS, separated by a comma.</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>the status of the version (e.g., <code>"alpha"</code>).</p>
</td></tr>
<tr><td><code>major</code></td>
<td>
<p>the major version number.</p>
</td></tr>
<tr><td><code>minor</code></td>
<td>
<p>the minor version number, including the patch level.</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>the year the version was released.</p>
</td></tr>
<tr><td><code>month</code></td>
<td>
<p>the month the version was released.</p>
</td></tr>
<tr><td><code>day</code></td>
<td>
<p>the day the version was released.</p>
</td></tr>
<tr><td><code>svn rev</code></td>
<td>
<p>the Subversion revision number, which should be either
<code>"unknown"</code> or a single number. (A range of numbers or a number
with &lsquo;<span class="samp">&#8288;M&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;S&#8288;</span>&rsquo; appended indicates inconsistencies in the
sources used to build this version of <span class="rlang"><b>R</b></span>.)
</p>
</td></tr>
<tr><td><code>language</code></td>
<td>
<p>always <code>"R"</code>.</p>
</td></tr>
<tr><td><code>version.string</code></td>
<td>
<p>a
<code><a href="#topic+character">character</a></code> string concatenating some of the info above,
useful for plotting, etc.</p>
</td></tr>
</table>
<p><code>R.version</code> and <code>version</code> are lists of class
<code>"simple.list"</code> which has a <code>print</code> method.
</p>
<p><code>R_compiled_by</code> returns a two-element character vector giving
details of the C and Fortran compilers used to build <span class="rlang"><b>R</b></span>.  (Empty
strings if no information is available.)
</p>


<h3>Note</h3>

<p>Do <em>not</em> use <code>R.version$os</code> to test the platform the
code is running on: use <code>.Platform$OS.type</code> instead.  Slightly
different versions of the OS may report different values of
<code>R.version$os</code>, as may different versions of <span class="rlang"><b>R</b></span>.
Alternatively, <code><a href="utils.html#topic+osVersion">osVersion</a></code> typically contains more
details about the platform <span class="rlang"><b>R</b></span> is running on.
</p>
<p><code>R.version.string</code> is a copy of <code>R.version$version.string</code>
for simplicity and backwards compatibility.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+sessionInfo">sessionInfo</a></code> which provides additional information;
<code><a href="#topic+getRversion">getRversion</a></code> typically used inside R code,
<code><a href="utils.html#topic+osVersion">osVersion</a></code>,
<code><a href="#topic+.Platform">.Platform</a></code>, <code><a href="#topic+Sys.info">Sys.info</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

R.version$os # to check how lucky you are ...
plot(0) # any plot
mtext(R.version.string, side = 1, line = 4, adj = 1) # a useful bottom-right note

## a good way to detect macOS:
if(grepl("^darwin", R.version$os)) message("running on macOS")

## Short R version string, ("space free", useful in file/directory names;
##                          also fine for unreleased versions of R):
shortRversion &lt;- function() {
   rvs &lt;- R.version.string
   if(grepl("devel", (st &lt;- R.version$status)))
       rvs &lt;- sub(paste0(" ",st," "), "-devel_", rvs, fixed=TRUE)
   gsub("[()]", "", gsub(" ", "_", sub(" version ", "-", rvs)))
}
shortRversion()

</code></pre>

<hr>
<h2 id='Random'>Random Number Generation</h2><span id='topic+Random'></span><span id='topic+RNG'></span><span id='topic+RNGkind'></span><span id='topic+RNGversion'></span><span id='topic+set.seed'></span><span id='topic+.Random.seed'></span>

<h3>Description</h3>

<p><code>.Random.seed</code> is an integer vector, containing the random number
generator (<abbr>RNG</abbr>) <b>state</b> for random number generation in <span class="rlang"><b>R</b></span>.  It
can be saved and restored, but should not be altered by the user.
</p>
<p><code>RNGkind</code> is a more friendly interface to query or set the kind
of RNG in use.
</p>
<p><code>RNGversion</code> can be used to set the random generators as they
were in an earlier <span class="rlang"><b>R</b></span> version (for reproducibility).
</p>
<p><code>set.seed</code> is the recommended way to specify seeds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.Random.seed &lt;- c(rng.kind, n1, n2, ...)

RNGkind(kind = NULL, normal.kind = NULL, sample.kind = NULL)
RNGversion(vstr)
set.seed(seed, kind = NULL, normal.kind = NULL, sample.kind = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Random_+3A_kind">kind</code></td>
<td>
<p>character or <code>NULL</code>.  If <code>kind</code> is a character
string, set <span class="rlang"><b>R</b></span>'s RNG to the kind desired.  Use <code>"default"</code> to
return to the <span class="rlang"><b>R</b></span> default.  See &lsquo;Details&rsquo; for the
interpretation of <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Random_+3A_normal.kind">normal.kind</code></td>
<td>
<p>character string or <code>NULL</code>.  If it is a character
string, set the method of Normal generation.  Use <code>"default"</code>
to return to the <span class="rlang"><b>R</b></span> default.  <code>NULL</code> makes no change.</p>
</td></tr>
<tr><td><code id="Random_+3A_sample.kind">sample.kind</code></td>
<td>
<p>character string or <code>NULL</code>.  If it is a character
string, set the method of discrete uniform generation (used in 
<code><a href="#topic+sample">sample</a></code>, for instance).  Use <code>"default"</code> to return to 
the <span class="rlang"><b>R</b></span> default.  <code>NULL</code> makes no change.</p>
</td></tr>
<tr><td><code id="Random_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as an integer, or <code>NULL</code>
(see &lsquo;Details&rsquo;).</p>
</td></tr>
<tr><td><code id="Random_+3A_vstr">vstr</code></td>
<td>
<p>a character string containing a version number,
e.g., <code>"1.6.2"</code>.  The default RNG configuration of the current
<span class="rlang"><b>R</b></span> version is used if <code>vstr</code> is greater than the current version.</p>
</td></tr> 
<tr><td><code id="Random_+3A_rng.kind">rng.kind</code></td>
<td>
<p>integer code in <code>0:k</code> for the above <code>kind</code>.</p>
</td></tr>
<tr><td><code id="Random_+3A_n1">n1</code>, <code id="Random_+3A_n2">n2</code>, <code id="Random_+3A_...">...</code></td>
<td>
<p>integers.  See the details for how many are required
(which depends on <code>rng.kind</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The currently available RNG kinds are given below.  <code>kind</code> is
partially matched to this list.  The default is
<code>"Mersenne-Twister"</code>.
</p>

<dl>
<dt><code>"Wichmann-Hill"</code></dt><dd>
<p>The seed, <code>.Random.seed[-1] == r[1:3]</code> is an integer vector of
length 3, where each <code>r[i]</code> is in <code>1:(p[i] - 1)</code>, where
<code>p</code> is the length 3 vector of primes, <code>p = (30269, 30307,
      30323)</code>.
The Wichmann&ndash;Hill generator has a cycle length of
<code class="reqn">6.9536 \times 10^{12}</code> (=
<code>prod(p-1)/4</code>, see <em>Applied Statistics</em> (1984)
<b>33</b>, 123 which corrects the original article).
It exhibits 12 clear failures in the TestU01 Crush suite and 22
in the BigCrush suite (L'Ecuyer, 2007).</p>
</dd>
<dt><code>"Marsaglia-Multicarry"</code>:</dt><dd>
<p>A <em>multiply-with-carry</em> RNG is used, as recommended by George
Marsaglia in his post to the mailing list &lsquo;<span class="file">sci.stat.math</span>&rsquo;.
It has a period of more than <code class="reqn">2^{60}</code>.
</p>
<p>It exhibits 40 clear failures in L'Ecuyer's TestU01 Crush suite.
Combined with Ahrens-Dieter or Kinderman-Ramage it exhibits
deviations from normality even for univariate distribution
generation.  See <a href="https://bugs.R-project.org/show_bug.cgi?id=18168">PR#18168</a> for a discussion.
</p>
<p>The seed is two integers (all values allowed).</p>
</dd>
<dt><code>"Super-Duper"</code>:</dt><dd>
<p>Marsaglia's famous Super-Duper from the 70's.  This is the original
version which does <em>not</em> pass the MTUPLE test of the Diehard
battery.  It has a period of <code class="reqn">\approx 4.6\times 10^{18}</code> for most initial seeds.  The seed is two integers (all
values allowed for the first seed: the second must be odd).
</p>
<p>We use the implementation by Reeds <abbr>et al.</abbr> (1982&ndash;84).
</p>
<p>The two seeds are the Tausworthe and congruence long integers,
respectively.
</p>
<p>It exhibits 25 clear failures in the TestU01 Crush suite
(L'Ecuyer, 2007). 
</p>
</dd>
<dt><code>"Mersenne-Twister"</code>:</dt><dd>
<p>From Matsumoto and Nishimura (1998); code updated in 2002.
A twisted <abbr>GFSR</abbr> with period
<code class="reqn">2^{19937} - 1</code> and equidistribution in 623
consecutive dimensions (over the whole period).  The &lsquo;seed&rsquo; is a
624-dimensional set of 32-bit integers plus a current position in
that set.
</p>
<p>R uses its own initialization method due to B. D. Ripley and is
not affected by the initialization issue in the 1998 code of
Matsumoto and Nishimura addressed in a 2002 update.
</p>
<p>It exhibits 2 clear failures in each of the TestU01 Crush and the
BigCrush suite (L'Ecuyer, 2007).
</p>
</dd>
<dt><code>"Knuth-TAOCP-2002"</code>:</dt><dd>
<p>A 32-bit integer <abbr>GFSR</abbr> using lagged Fibonacci sequences with
subtraction.  That is, the recurrence used is
</p>
<p style="text-align: center;"><code class="reqn">X_j = (X_{j-100} - X_{j-37}) \bmod 2^{30}%
      </code>
</p>

<p>and the &lsquo;seed&rsquo; is the set of the 100 last numbers (actually
recorded as 101 numbers, the last being a cyclic shift of the
buffer).  The period is around <code class="reqn">2^{129}</code>.
</p>
</dd>
<dt><code>"Knuth-TAOCP"</code>:</dt><dd>
<p>An earlier version from Knuth (1997).
</p>
<p>The 2002 version was not backwards compatible with the earlier
version: the initialization of the <abbr>GFSR</abbr> from the seed was altered.
<span class="rlang"><b>R</b></span> did not allow you to choose consecutive seeds, the reported
&lsquo;weakness&rsquo;, and already scrambled the seeds. Otherwise,
the algorithm is identical to Knuth-TAOCP-2002, with the same
lagged Fibonacci recurrence formula.
</p>
<p>Initialization of this generator is done in interpreted <span class="rlang"><b>R</b></span> code
and so takes a short but noticeable time.
</p>
<p>It exhibits 3 clear failure in the TestU01 Crush suite and
4 clear failures in the BigCrush suite
(<em>L'Ecuyer</em>, 2007).
</p>
</dd>
<dt><code>"L'Ecuyer-CMRG"</code>:</dt><dd>
<p>A &lsquo;combined multiple-recursive generator&rsquo; from L'Ecuyer
(1999), each element of which is a feedback multiplicative
generator with three integer elements: thus the seed is a (signed)
integer vector of length 6. The period is around
<code class="reqn">2^{191}</code>.
</p>
<p>The 6 elements of the seed are internally regarded as 32-bit
unsigned integers.  Neither the first three nor the last three
should be all zero, and they are limited to less than
<code>4294967087</code> and <code>4294944443</code> respectively.
</p>
<p>This is not particularly interesting of itself, but provides the
basis for the multiple streams used in package <span class="pkg">parallel</span>.

</p>
<p>It exhibits 6 clear failures in each of the TestU01 Crush and the
BigCrush suite (<em>L'Ecuyer</em>, 2007).
</p>
</dd>
<dt><code>"user-supplied"</code>:</dt><dd>
<p>Use a user-supplied generator.  See <code><a href="#topic+Random.user">Random.user</a></code> for
details.
</p>
</dd>
</dl>

<p><code>normal.kind</code> can be <code>"Kinderman-Ramage"</code>,
<code>"Buggy Kinderman-Ramage"</code> (not for <code>set.seed</code>),
<code>"Ahrens-Dieter"</code>, <code>"Box-Muller"</code>, <code>"Inversion"</code> (the
default), or <code>"user-supplied"</code>.  (For inversion, see the
reference in <code><a href="stats.html#topic+qnorm">qnorm</a></code>.)  The Kinderman-Ramage generator
used in versions prior to 1.7.0 (now called <code>"Buggy"</code>) had several
approximation errors and should only be used for reproduction of old
results.  The <code>"Box-Muller"</code> generator is stateful as pairs of
normals are generated and returned sequentially.  The state is reset
whenever it is selected (even if it is the current normal generator)
and when <code>kind</code> is changed.
</p>
<p><code>sample.kind</code> can be <code>"Rounding"</code> or <code>"Rejection"</code>,
or partial matches to these.  The former was the default in versions
prior to 3.6.0:  it made <code><a href="#topic+sample">sample</a></code> noticeably non-uniform
on large populations, and should only be used for reproduction of old
results.  See <a href="https://bugs.R-project.org/show_bug.cgi?id=17494">PR#17494</a> for a discussion. 
</p>
<p><code>set.seed</code> uses a single integer argument to set as many seeds
as are required.  It is intended as a simple way to get quite different
seeds by specifying small integer arguments, and also as a way to get
valid seed sets for the more complicated methods (especially
<code>"Mersenne-Twister"</code> and <code>"Knuth-TAOCP"</code>).  There is no
guarantee that different values of <code>seed</code> will seed the RNG
differently, although any exceptions would be extremely rare.  If
called with <code>seed = NULL</code> it re-initializes (see &lsquo;Note&rsquo;)
as if no seed had yet been set.
</p>
<p>The use of <code>kind = NULL</code>, <code>normal.kind = NULL</code> or 
<code>sample.kind = NULL</code> in
<code>RNGkind</code> or <code>set.seed</code> selects the currently-used
generator (including that used in the previous session if the
workspace has been restored): if no generator has been used it selects
<code>"default"</code>.
</p>


<h3>Value</h3>

<p><code>.Random.seed</code> is an <code><a href="#topic+integer">integer</a></code> vector whose first
element <em>codes</em> the kind of RNG and normal generator. The lowest
two decimal digits are in <code>0:(k-1)</code>
where <code>k</code> is the number of available <abbr>RNG</abbr>s.  The hundreds
represent the type of normal generator (starting at <code>0</code>), and
the ten thousands represent the type of discrete uniform sampler.
</p>
<p>In the underlying C, <code>.Random.seed[-1]</code> is <code>unsigned</code>;
therefore in <span class="rlang"><b>R</b></span> <code>.Random.seed[-1]</code> can be negative, due to
the representation of an unsigned integer by a signed integer.
</p>
<p><code>RNGkind</code> returns a three-element character vector of the RNG,
normal and sample kinds selected <em>before</em> the call, invisibly if 
either argument is not <code>NULL</code>.  A type starts a session as the 
default, and is selected either by a call to <code>RNGkind</code> or by setting
<code>.Random.seed</code> in the workspace. (NB: prior to <span class="rlang"><b>R</b></span> 3.6.0 the first
two kinds were returned in a two-element character vector.)
</p>
<p><code>RNGversion</code> returns the same information as <code>RNGkind</code> about
the defaults in a specific <span class="rlang"><b>R</b></span> version.
</p>
<p><code>set.seed</code> returns <code>NULL</code>, invisibly.
</p>


<h3>Note</h3>

<p>Initially, there is no seed; a new one is created from the current
time and the process ID when one is required.  Hence different
sessions will give different simulation results, by default.  However,
the seed might be restored from a previous session if a previously
saved workspace is restored.
</p>
<p><code>.Random.seed</code> saves the seed set for the uniform random-number
generator, at least for the system generators.  It does not
necessarily save the state of other generators, and in particular does
not save the state of the Box&ndash;Muller normal generator.  If you want
to reproduce work later, call <code>set.seed</code> (preferably with
explicit values for <code>kind</code> and <code>normal.kind</code>) rather than
set <code>.Random.seed</code>.
</p>
<p>The object <code>.Random.seed</code> is only looked for in the user's
workspace.
</p>
<p>Do not rely on randomness of low-order bits from <abbr>RNG</abbr>s.  Most of the
supplied uniform generators return 32-bit integer values that are
converted to doubles, so they take at most <code class="reqn">2^{32}</code> distinct
values and long runs will return duplicated values (Wichmann-Hill is
the exception, and all give at least 30 varying bits.)
</p>


<h3>Author(s)</h3>

<p>of RNGkind: Martin Maechler. Current implementation, B. D. Ripley
with modifications by Duncan Murdoch.</p>


<h3>References</h3>

<p>Ahrens, J. H. and Dieter, U. (1973).
Extensions of Forsythe's method for random sampling from the normal
distribution.
<em>Mathematics of Computation</em>, <b>27</b>, 927&ndash;937.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988).
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
(<code>set.seed</code>, storing in <code>.Random.seed</code>.)
</p>
<p>Box, G. E. P. and Muller, M. E. (1958).
A note on the generation of normal random deviates.
<em>Annals of Mathematical Statistics</em>, <b>29</b>, 610&ndash;611.
<a href="https://doi.org/10.1214/aoms/1177706645">doi:10.1214/aoms/1177706645</a>.
</p>
<p>De Matteis, A. and Pagnutti, S. (1993).
Long-range Correlation Analysis of the Wichmann-Hill Random Number
Generator.
<em>Statistics and Computing</em>, <b>3</b>, 67&ndash;70.
<a href="https://doi.org/10.1007/BF00153065">doi:10.1007/BF00153065</a>.
</p>
<p>Kinderman, A. J. and Ramage, J. G. (1976).
Computer generation of normal random variables.
<em>Journal of the American Statistical Association</em>, <b>71</b>,
893&ndash;896.
<a href="https://doi.org/10.2307/2286857">doi:10.2307/2286857</a>.
</p>
<p>Knuth, D. E. (1997).
<em>The Art of Computer Programming</em>.
Volume 2, third edition.<br />
Source code at <a href="https://www-cs-faculty.stanford.edu/~knuth/taocp.html">https://www-cs-faculty.stanford.edu/~knuth/taocp.html</a>.
</p>
<p>Knuth, D. E. (2002).
<em>The Art of Computer Programming</em>.
Volume 2, third edition, ninth printing.
</p>
<p>L'Ecuyer, P. (1999).
Good parameters and implementations for combined multiple recursive
random number generators.
<em>Operations Research</em>, <b>47</b>, 159&ndash;164.
<a href="https://doi.org/10.1287/opre.47.1.159">doi:10.1287/opre.47.1.159</a>.
</p>
<p>L'Ecuyer, P. and Simard, R. (2007).
TestU01: A C Library for Empirical Testing of Random Number Generators
<em>ACM Transactions on Mathematical Software</em>, <b>33</b>, Article 22.
<a href="https://doi.org/10.1145/1268776.1268777">doi:10.1145/1268776.1268777</a>.
<br /> The TestU01 C library is available from
<a href="http://simul.iro.umontreal.ca/testu01/tu01.html">http://simul.iro.umontreal.ca/testu01/tu01.html</a> or also
<a href="https://github.com/umontreal-simul/TestU01-2009">https://github.com/umontreal-simul/TestU01-2009</a>.
</p>
<p>Marsaglia, G. (1997).
<em>A random number generator for C</em>.
Discussion paper, posting on Usenet newsgroup <code>sci.stat.math</code> on
September 29, 1997.
</p>
<p>Marsaglia, G. and Zaman, A. (1994).
Some portable very-long-period random number generators.
<em>Computers in Physics</em>, <b>8</b>, 117&ndash;121.
<a href="https://doi.org/10.1063/1.168514">doi:10.1063/1.168514</a>.
</p>
<p>Matsumoto, M. and Nishimura, T. (1998).
Mersenne Twister: A 623-dimensionally equidistributed uniform
pseudo-random number generator,
<em>ACM Transactions on Modeling and Computer Simulation</em>,
<b>8</b>, 3&ndash;30.<br />
Source code formerly at <code>http://www.math.keio.ac.jp/~matumoto/emt.html</code>.<br />
Now see <a href="http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/C-LANG/c-lang.html">http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/VERSIONS/C-LANG/c-lang.html</a>.
</p>
<p>Reeds, J., Hubert, S. and Abrahams, M. (1982&ndash;4).
C implementation of SuperDuper, University of California at Berkeley.
(Personal communication from Jim Reeds to Ross Ihaka.)
</p>
<p>Wichmann, B. A.  and Hill, I. D. (1982).
Algorithm AS 183: An Efficient and Portable Pseudo-random Number
Generator.
<em>Applied Statistics</em>, <b>31</b>, 188&ndash;190; Remarks:
<b>34</b>, 198 and <b>35</b>, 89.
<a href="https://doi.org/10.2307/2347988">doi:10.2307/2347988</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sample">sample</a></code> for random sampling with and without replacement.
</p>
<p><a href="stats.html#topic+Distributions">Distributions</a> for functions for random-variate generation from
standard distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

## Seed the current RNG, i.e., set the RNG status
set.seed(42); u1 &lt;- runif(30)
set.seed(42); u2 &lt;- runif(30) # the same because of identical RNG status:
stopifnot(identical(u1, u2))

## the default random seed is 626 integers, so only print a few
 runif(1); .Random.seed[1:6]; runif(1); .Random.seed[1:6]
 ## If there is no seed, a "random" new one is created:
 rm(.Random.seed); runif(1); .Random.seed[1:6]

ok &lt;- RNGkind()
RNGkind("Wich")  # (partial string matching on 'kind')

## This shows how 'runif(.)' works for Wichmann-Hill,
## using only R functions:

p.WH &lt;- c(30269, 30307, 30323)
a.WH &lt;- c(  171,   172,   170)
next.WHseed &lt;- function(i.seed = .Random.seed[-1])
  { (a.WH * i.seed) %% p.WH }
my.runif1 &lt;- function(i.seed = .Random.seed)
  { ns &lt;- next.WHseed(i.seed[-1]); sum(ns / p.WH) %% 1 }
set.seed(1998-12-04)# (when the next lines were added to the souRce)
rs &lt;- .Random.seed
(WHs &lt;- next.WHseed(rs[-1]))
u &lt;- runif(1)
stopifnot(
 next.WHseed(rs[-1]) == .Random.seed[-1],
 all.equal(u, my.runif1(rs))
)

## ----
.Random.seed
RNGkind("Super") # matches  "Super-Duper"
RNGkind()
.Random.seed # new, corresponding to  Super-Duper

## Reset:
RNGkind(ok[1])

RNGversion(getRversion()) # the default version for this R version

## ----
sum(duplicated(runif(1e6))) # around 110 for default generator
## and we would expect about almost sure duplicates beyond about
qbirthday(1 - 1e-6, classes = 2e9) # 235,000
</code></pre>

<hr>
<h2 id='Random.user'>User-supplied Random Number Generation</h2><span id='topic+Random.user'></span>

<h3>Description</h3>

<p>Function <code><a href="#topic+RNGkind">RNGkind</a></code> allows user-coded uniform and
normal random number generators to be supplied.  The details are given
here.
</p>


<h3>Details</h3>

<p>A user-specified uniform RNG is called from entry points in
dynamically-loaded compiled code.  The user must supply the entry point
<code>user_unif_rand</code>, which takes no arguments and returns a
<em>pointer to</em> a double. The example below will show the general
pattern. The generator should have at least 25 bits of precision.
</p>
<p>Optionally, the user can supply the entry point <code>user_unif_init</code>,
which is called with an <code>unsigned int</code> argument when
<code><a href="#topic+RNGkind">RNGkind</a></code> (or <code>set.seed</code>) is called, and is intended
to be used to initialize the user's RNG code.  The argument is intended
to be used to set the &lsquo;seeds&rsquo;; it is the <code>seed</code> argument to
<code>set.seed</code> or an essentially random seed if <code><a href="#topic+RNGkind">RNGkind</a></code>
is called.
</p>
<p>If only these functions are supplied, no information about the
generator's state is recorded in <code>.Random.seed</code>.  Optionally,
functions <code>user_unif_nseed</code> and <code>user_unif_seedloc</code> can be
supplied which are called with no arguments and should return pointers
to the number of seeds and to an integer (specifically, &lsquo;<span class="samp">&#8288;Int32&#8288;</span>&rsquo;)
array of seeds.  Calls to <code>GetRNGstate</code> and <code>PutRNGstate</code>
will then copy this array to and from <code>.Random.seed</code>.
</p>
<p>A user-specified normal RNG is specified by a single entry point
<code>user_norm_rand</code>, which takes no arguments and returns a
<em>pointer to</em> a double.
</p>


<h3>Warning</h3>

<p>As with all compiled code, mis-specifying these
functions can crash <span class="rlang"><b>R</b></span>.  Do include the &lsquo;<span class="file">R_ext/Random.h</span>&rsquo;
header file for type checking.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##  Marsaglia's congruential PRNG
#include &lt;R_ext/Random.h&gt;

static Int32 seed;
static double res;
static int nseed = 1;

double * user_unif_rand(void)
{
    seed = 69069 * seed + 1;
    res = seed * 2.32830643653869e-10;
    return &amp;res;
}

void  user_unif_init(Int32 seed_in) { seed = seed_in; }
int * user_unif_nseed(void) { return &amp;nseed; }
int * user_unif_seedloc(void) { return (int *) &amp;seed; }

/*  ratio-of-uniforms for normal  */
#include &lt;math.h&gt;
static double x;

double * user_norm_rand(void)
{
    double u, v, z;
    do {
        u = unif_rand();
        v = 0.857764 * (2. * unif_rand() - 1);
        x = v/u; z = 0.25 * x * x;
        if (z &lt; 1. - u) break;
        if (z &gt; 0.259/u + 0.35) continue;
    } while (z &gt; -log(u));
    return &amp;x;
}

## Use under Unix:
R CMD SHLIB urand.c
R
&gt; dyn.load("urand.so")
&gt; RNGkind("user")
&gt; runif(10)
&gt; .Random.seed
&gt; RNGkind(, "user")
&gt; rnorm(10)
&gt; RNGkind()
[1] "user-supplied" "user-supplied"

## End(Not run)</code></pre>

<hr>
<h2 id='range'>Range of Values</h2><span id='topic+range'></span><span id='topic+range.default'></span><span id='topic+range.Date'></span><span id='topic+range.POSIXct'></span><span id='topic+.rangeNum'></span>

<h3>Description</h3>

<p><code>range</code> returns a vector containing the minimum and maximum of
all the given arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>range(..., na.rm = FALSE)
## Default S3 method:
range(..., na.rm = FALSE, finite = FALSE)
## same for classes 'Date' and 'POSIXct'

.rangeNum(..., na.rm, finite, isNumeric)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="range_+3A_...">...</code></td>
<td>
<p>any <code><a href="#topic+numeric">numeric</a></code> or character objects.</p>
</td></tr>
<tr><td><code id="range_+3A_na.rm">na.rm</code></td>
<td>
<p>logical, indicating if <code><a href="#topic+NA">NA</a></code>'s should be
omitted.</p>
</td></tr>
<tr><td><code id="range_+3A_finite">finite</code></td>
<td>
<p>logical, indicating if all non-finite elements should
be omitted.</p>
</td></tr>
<tr><td><code id="range_+3A_isnumeric">isNumeric</code></td>
<td>
<p>a <code><a href="#topic+function">function</a></code> returning <code>TRUE</code> or
<code>FALSE</code> when called on <code>c(..., recursive = TRUE)</code>,
<code><a href="#topic+is.numeric">is.numeric</a>()</code> for the default <code>range()</code> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>range</code> is a generic function: methods can be defined for it
directly or via the <code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.
For this to work properly, the arguments <code>...</code> should be
unnamed, and dispatch is on the first argument.
</p>
<p>If <code>na.rm</code> is <code>FALSE</code>, <code>NA</code>
and <code>NaN</code> values in any of the arguments will cause <code>NA</code> values
to be returned, otherwise <code>NA</code> values are ignored.
</p>
<p>If <code>finite</code> is <code>TRUE</code>, the minimum
and maximum of all finite values is computed, i.e.,
<code>finite = TRUE</code> <em>includes</em> <code>na.rm = TRUE</code>.
</p>
<p>A special situation occurs when there is no (after omission
of <code>NA</code>s) nonempty argument left, see <code><a href="#topic+min">min</a></code>.
</p>


<h3>S4 methods</h3>

<p>This is part of the S4 <code><a href="methods.html#topic+S4groupGeneric">Summary</a></code>
group generic.  Methods for it must use the signature
<code>x, ..., na.rm</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+min">min</a></code>, <code><a href="#topic+max">max</a></code>.
</p>
<p>The <code><a href="grDevices.html#topic+extendrange">extendrange</a>()</code> utility in package <span class="pkg">grDevices</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(r.x &lt;- range(stats::rnorm(100)))
diff(r.x) # the SAMPLE range

x &lt;- c(NA, 1:3, -1:1/0); x
range(x)
range(x, na.rm = TRUE)
range(x, finite = TRUE)
</code></pre>

<hr>
<h2 id='rank'>Sample Ranks</h2><span id='topic+rank'></span>

<h3>Description</h3>

<p>Returns the sample ranks of the values in a vector.  Ties (i.e., equal
values) and missing values can be handled in several ways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank(x, na.last = TRUE,
     ties.method = c("average", "first", "last", "random", "max", "min"))
</code></pre>


<h3>Arguments</h3>


<table>
<tr><td><code id="rank_+3A_x">x</code></td>
<td>
<p>a numeric, complex, character or logical vector.</p>
</td></tr>
<tr><td><code id="rank_+3A_na.last">na.last</code></td>
<td>
<p>a logical or character string controlling the treatment
of <code><a href="#topic+NA">NA</a></code>s. If <code>TRUE</code>, missing values in the data are
put last; if <code>FALSE</code>, they are put first; if <code>NA</code>, they
are removed; if <code>"keep"</code> they are kept with rank <code>NA</code>.</p>
</td></tr>
<tr><td><code id="rank_+3A_ties.method">ties.method</code></td>
<td>
<p>a character string specifying how ties are treated,
see &lsquo;Details&rsquo;; can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If all components are different (and no <code>NA</code>s), the ranks are
well defined, with values in <code>seq_along(x)</code>.  With some values equal
(called &lsquo;ties&rsquo;), the argument <code>ties.method</code> determines the
result at the corresponding indices.  The <code>"first"</code> method results
in a permutation with increasing values at each index set of ties, and
analogously <code>"last"</code> with decreasing values.  The
<code>"random"</code> method puts these in random order whereas the
default, <code>"average"</code>, replaces them by their mean, and
<code>"max"</code> and <code>"min"</code> replaces them by their maximum and
minimum respectively, the latter being the typical sports
ranking.
</p>
<p><code>NA</code> values are never considered to be equal: for <code>na.last =
    TRUE</code> and <code>na.last = FALSE</code> they are given distinct ranks in
the order in which they occur in <code>x</code>.
</p>
<p><strong>NB</strong>: <code>rank</code> is not itself generic but <code><a href="#topic+xtfrm">xtfrm</a></code>
is, and <code>rank(xtfrm(x), ....)</code> will have the desired result if
there is a <code>xtfrm</code> method.  Otherwise, <code>rank</code> will make use
of <code>==</code>, <code>&gt;</code>, <code>is.na</code> and extraction methods for
classed objects, possibly rather slowly.
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as <code>x</code> with names copied from
<code>x</code> (unless <code>na.last = NA</code>, when missing values are
removed).  The vector is of integer type unless <code>x</code> is a long
vector or <code>ties.method = "average"</code> when it is of double type
(whether or not there are any ties).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+order">order</a></code> and <code><a href="#topic+sort">sort</a></code>;
<code><a href="#topic+xtfrm">xtfrm</a></code>, see above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(r1 &lt;- rank(x1 &lt;- c(3, 1, 4, 15, 92)))
x2 &lt;- c(3, 1, 4, 1, 5, 9, 2, 6, 5, 3, 5)
names(x2) &lt;- letters[1:11]
(r2 &lt;- rank(x2)) # ties are averaged

## rank() is "idempotent": rank(rank(x)) == rank(x) :
stopifnot(rank(r1) == r1, rank(r2) == r2)

## ranks without averaging
rank(x2, ties.method= "first")  # first occurrence wins
rank(x2, ties.method= "last")   #  last occurrence wins
rank(x2, ties.method= "random") # ties broken at random
rank(x2, ties.method= "random") # and again

## keep ties ties, no average
(rma &lt;- rank(x2, ties.method= "max"))  # as used classically
(rmi &lt;- rank(x2, ties.method= "min"))  # as in Sports
stopifnot(rma + rmi == round(r2 + r2))

## Comparing all tie.methods:
tMeth &lt;- eval(formals(rank)$ties.method)
rx2 &lt;- sapply(tMeth, function(M) rank(x2, ties.method=M))
cbind(x2, rx2)
## ties.method's does not matter w/o ties:
x &lt;- sample(47)
rx &lt;- sapply(tMeth, function(MM) rank(x, ties.method=MM))
stopifnot(all(rx[,1] == rx))
</code></pre>

<hr>
<h2 id='rapply'>Recursively Apply a Function to a List</h2><span id='topic+rapply'></span>

<h3>Description</h3>

<p><code>rapply</code> is a recursive version of <code><a href="#topic+lapply">lapply</a></code> with
flexibility in <em>how</em> the result is structured (<code>how = ".."</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rapply(object, f, classes = "ANY", deflt = NULL,
       how = c("unlist", "replace", "list"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rapply_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+list">list</a></code> or <code><a href="#topic+expression">expression</a></code>, i.e., &ldquo;list-like&rdquo;.</p>
</td></tr>
<tr><td><code id="rapply_+3A_f">f</code></td>
<td>
<p>a <code><a href="#topic+function">function</a></code> of one &ldquo;principal&rdquo; argument,
passing further arguments via <code>...</code>.</p>
</td></tr>
<tr><td><code id="rapply_+3A_classes">classes</code></td>
<td>
<p>character vector of <code><a href="#topic+class">class</a></code> names, or
<code>"ANY"</code> to match any class.</p>
</td></tr>
<tr><td><code id="rapply_+3A_deflt">deflt</code></td>
<td>
<p>the default result (not used if <code>how = "replace"</code>).</p>
</td></tr>
<tr><td><code id="rapply_+3A_how">how</code></td>
<td>
<p>character string partially matching the three possibilities given:
see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="rapply_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the call to <code>f</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has two basic modes.  If <code>how = "replace"</code>, each
element of <code>object</code> which is not itself list-like and has a class
included in <code>classes</code> is replaced by the result of applying
<code>f</code> to the element.
</p>
<p>Otherwise, with mode <code>how = "list"</code> or <code>how = "unlist"</code>,
conceptually <code>object</code>
is copied, all non-list elements which have a class included in
<code>classes</code> are replaced by the result of applying <code>f</code> to the
element and all others are replaced by <code>deflt</code>.  Finally, if
<code>how = "unlist"</code>, <code>unlist(recursive = TRUE)</code> is called on
the result.
</p>
<p>The semantics differ in detail from <code><a href="#topic+lapply">lapply</a></code>: in
particular the arguments are evaluated before calling the C code.
</p>
<p>In <span class="rlang"><b>R</b></span> 3.5.x and earlier, <code>object</code> was required to be a list,
which was <em>not</em> the case for its list-like components.
</p>


<h3>Value</h3>

<p>If <code>how = "unlist"</code>, a vector, otherwise &ldquo;list-like&rdquo;
of similar structure as <code>object</code>.
</p>


<h3>References</h3>

<p>Chambers, J. A. (1998)
<em>Programming with Data</em>.
Springer.<br />
(<code>rapply</code> is only described briefly there.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lapply">lapply</a></code>, <code><a href="stats.html#topic+dendrapply">dendrapply</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- list(list(a = pi, b = list(c = 1L)), d = "a test")
# the "identity operation":
rapply(X, function(x) x, how = "replace") -&gt; X.; stopifnot(identical(X, X.))
rapply(X, sqrt, classes = "numeric", how = "replace")
rapply(X, deparse, control = "all") # passing extras. argument of deparse()
rapply(X, nchar, classes = "character", deflt = NA_integer_, how = "list")
rapply(X, nchar, classes = "character", deflt = NA_integer_, how = "unlist")
rapply(X, nchar, classes = "character",                      how = "unlist")
rapply(X, log, classes = "numeric", how = "replace", base = 2)

## with expression() / list():
E  &lt;- expression(list(a = pi, b = expression(c = C1 * C2)), d = "a test")
LE &lt;- list(expression(a = pi, b = expression(c = C1 * C2)), d = "a test")
rapply(E, nchar, how="replace") # "expression(c = C1 * C2)" are 23 chars
rapply(E, nchar, classes = "character", deflt = NA_integer_, how = "unlist")
rapply(LE, as.character) # a "pi" | b1 "expression" | b2 "C1 * C2" ..
rapply(LE, nchar)        # (see above)
stopifnot(exprs = {
  identical(E , rapply(E , identity, how = "replace"))
  identical(LE, rapply(LE, identity, how = "replace"))
})
</code></pre>

<hr>
<h2 id='raw'>Raw Vectors</h2><span id='topic+raw'></span><span id='topic+as.raw'></span><span id='topic+is.raw'></span>

<h3>Description</h3>

<p>Creates or tests for objects of type <code>"raw"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw(length = 0)
as.raw(x)
is.raw(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raw_+3A_length">length</code></td>
<td>
<p>desired length.</p>
</td></tr>
<tr><td><code id="raw_+3A_x">x</code></td>
<td>
<p>object to be coerced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The raw type is intended to hold raw bytes.  It is possible to extract
subsequences of bytes, and to replace elements (but only by elements
of a raw vector).  The relational operators (see <a href="#topic+Comparison">Comparison</a>,
using the numerical order of the byte representation) work, as do the
logical operators (see <a href="#topic+Logic">Logic</a>) with a bitwise interpretation.
</p>
<p>A raw vector is printed with each byte separately represented as a
pair of hex digits.  If you want to see a character representation
(with escape sequences for non-printing characters) use
<code><a href="#topic+rawToChar">rawToChar</a></code>.
</p>
<p>Coercion to raw treats the input values as representing small
(decimal) integers, so the input is first coerced to integer, and then
values which are outside the range <code>[0 ... 255]</code> or are
<code>NA</code> are set to <code>0</code> (the <code>nul</code> byte).
</p>
<p><code>as.raw</code> and <code>is.raw</code> are <a href="#topic+primitive">primitive</a> functions.
</p>


<h3>Value</h3>

<p><code>raw</code> creates a raw vector of the specified length.
Each element of the vector is equal to <code>0</code>.
Raw vectors are used to store fixed-length sequences of bytes.
</p>
<p><code>as.raw</code> attempts to coerce its argument to be of raw
type.  The (elementwise) answer will be <code>0</code> unless the
coercion succeeds (or if the original value successfully coerces to 0).
</p>
<p><code>is.raw</code> returns true if and only if <code>typeof(x) == "raw"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+charToRaw">charToRaw</a></code>, <code><a href="#topic+rawShift">rawShift</a></code>, etc.
</p>
<p><code><a href="#topic++26">&amp;</a></code> for bitwise operations on raw vectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xx &lt;- raw(2)
xx[1] &lt;- as.raw(40)     # NB, not just 40.
xx[2] &lt;- charToRaw("A")
xx       ## 28 41   -- raw prints hexadecimals
dput(xx) ## as.raw(c(0x28, 0x41))
as.integer(xx) ## 40 65

x &lt;- "A test string"
(y &lt;- charToRaw(x))
is.vector(y) # TRUE
rawToChar(y)
is.raw(x)
is.raw(y)
stopifnot( charToRaw("\xa3") == as.raw(0xa3) )

isASCII &lt;-  function(txt) all(charToRaw(txt) &lt;= as.raw(127))
isASCII(x)  # true
isASCII("\xa325.63") # false (in Latin-1, this is an amount in UK pounds)
</code></pre>

<hr>
<h2 id='rawConnection'>Raw Connections</h2><span id='topic+rawConnection'></span><span id='topic+rawConnectionValue'></span>

<h3>Description</h3>

<p>Input and output raw connections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rawConnection(object, open = "r")

rawConnectionValue(con)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rawConnection_+3A_object">object</code></td>
<td>
<p>character or raw vector.  A description of the connection.
For an input this is an <span class="rlang"><b>R</b></span> raw vector object, and for an output
connection the name for the connection.
</p>
</td></tr>
<tr><td><code id="rawConnection_+3A_open">open</code></td>
<td>
<p>character.  Any of the standard connection open modes.</p>
</td></tr>
<tr><td><code id="rawConnection_+3A_con">con</code></td>
<td>
<p>an output raw connection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An input raw connection is opened and the raw vector is copied
at the time the connection object is created, and <code>close</code>
destroys the copy.
</p>
<p>An output raw connection is opened and creates an <span class="rlang"><b>R</b></span> raw vector
internally.  The raw vector can be retrieved <em>via</em>
<code>rawConnectionValue</code>.
</p>
<p>If a connection is open for both input and output the initial raw
vector supplied is copied when the connections is open
</p>


<h3>Value</h3>

<p>For <code>rawConnection</code>, a connection object of class
<code>"rawConnection"</code> which inherits from class <code>"connection"</code>.
</p>
<p>For <code>rawConnectionValue</code>, a raw vector.
</p>


<h3>Note</h3>

<p>As output raw connections keep the internal raw vector up to date
call-by-call, they are relatively expensive to use (although
over-allocation is used), and it may be better to use an anonymous
<code><a href="#topic+file">file</a>()</code> connection to collect output.
</p>
<p>On (rare) platforms where <code>vsnprintf</code> does not return the needed length
of output there is a 100,000 character limit on the length of line for
output connections: longer lines will be truncated with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+showConnections">showConnections</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zz &lt;- rawConnection(raw(0), "r+") # start with empty raw vector
writeBin(LETTERS, zz)
seek(zz, 0)
readLines(zz) # raw vector has embedded nuls
seek(zz, 0)
writeBin(letters[1:3], zz)
rawConnectionValue(zz)
close(zz)
</code></pre>

<hr>
<h2 id='rawConversion'>Convert to or from (Bit/Packed) Raw Vectors</h2><span id='topic+charToRaw'></span><span id='topic+rawToChar'></span><span id='topic+rawShift'></span><span id='topic+rawToBits'></span><span id='topic+intToBits'></span><span id='topic+packBits'></span><span id='topic+numToInts'></span><span id='topic+numToBits'></span>

<h3>Description</h3>

<p>Conversion to and from and manipulation of objects of type <code>"raw"</code>,
both used as bits or &ldquo;packed&rdquo; 8 bits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>charToRaw(x)
rawToChar(x, multiple = FALSE)

rawShift(x, n)

rawToBits(x)
intToBits(x)
packBits(x, type = c("raw", "integer", "double"))

numToInts(x)
numToBits(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rawConversion_+3A_x">x</code></td>
<td>
<p>object to be converted or shifted.</p>
</td></tr>
<tr><td><code id="rawConversion_+3A_multiple">multiple</code></td>
<td>
<p>logical: should the conversion be to a single
character string or multiple individual characters?</p>
</td></tr>
<tr><td><code id="rawConversion_+3A_n">n</code></td>
<td>
<p>the number of bits to shift.  Positive numbers shift right
and negative numbers shift left: allowed values are <code>-8 ... 8</code>.</p>
</td></tr>
<tr><td><code id="rawConversion_+3A_type">type</code></td>
<td>
<p>the result type, partially matched.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>packBits</code> accepts raw, integer or logical inputs, the last two
without any NAs.
</p>
<p><code>numToBits(.)</code> and <code>packBits(., type="double")</code> are
<em>inverse</em> functions of each other, see also the examples.
</p>
<p>Note that &lsquo;bytes&rsquo; are not necessarily the same as characters,
e.g. in UTF-8 locales.
</p>


<h3>Value</h3>

<p><code>charToRaw</code> converts a length-one character string to raw bytes.
It does so without taking into account any declared encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>).
</p>
<p><code>rawToChar</code> converts raw bytes either to a single character
string or a character vector of single bytes (with <code>""</code> for
<code>0</code>).  (Note that a single character string could contain
embedded <abbr>NUL</abbr>s; only trailing nulls are allowed and will be removed.)
In either case it is possible to create a result which is invalid in a
multibyte locale, e.g. one using UTF-8. <a href="#topic+Long+20vectors">Long vectors</a> are
allowed if <code>multiple</code> is true.
</p>
<p><code>rawShift(x, n)</code> shift the bits in <code>x</code> by <code>n</code> positions
to the right, see the argument <code>n</code>, above.
</p>
<p><code>rawToBits</code> returns a raw vector of 8 times the length of a raw
vector with entries 0 or 1.  <code>intToBits</code> returns a raw vector
of 32 times the length of an integer vector with entries 0 or 1.
(Non-integral numeric values are truncated to integers.) In
both cases the unpacking is least-significant bit first.
</p>
<p><code>packBits</code> packs its input (using only the lowest bit for raw or
integer vectors) least-significant bit first to a raw, integer or double
(&ldquo;numeric&rdquo;) vector.
</p>
<p><code>numToInts()</code> and
<code>numToBits()</code> split <code><a href="#topic+double">double</a></code> precision numeric vectors
either into to two <code><a href="#topic+integer">integer</a></code>s each or into 64 bits each,
stored as <code>raw</code>.  In both cases the unpacking is least-significant
element first.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- "A test string"
(y &lt;- charToRaw(x))
is.vector(y) # TRUE

rawToChar(y)
rawToChar(y, multiple = TRUE)
(xx &lt;- c(y,  charToRaw("&amp;"), charToRaw(" more")))
rawToChar(xx)

rawShift(y, 1)
rawShift(y,-2)

rawToBits(y)

showBits &lt;- function(r) stats::symnum(as.logical(rawToBits(r)))

z &lt;- as.raw(5)
z ; showBits(z)
showBits(rawShift(z, 1)) # shift to right
showBits(rawShift(z, 2))
showBits(z)
showBits(rawShift(z, -1)) # shift to left
showBits(rawShift(z, -2)) # ..
showBits(rawShift(z, -3)) # shifted off entirely

packBits(as.raw(0:31))
i &lt;- -2:3
stopifnot(exprs = {
  identical(i, packBits(intToBits(i), "integer"))
  identical(packBits(       0:31) ,
            packBits(as.raw(0:31)))
})
str(pBi &lt;- packBits(intToBits(i)))
data.frame(B = matrix(pBi, nrow=6, byrow=TRUE),
           hex = format(as.hexmode(i)), i)


## Look at internal bit representation of ...

## ... of integers :
bitI &lt;- function(x) vapply(as.integer(x), function(x) {
            b &lt;- substr(as.character(rev(intToBits(x))), 2L, 2L)
            paste0(c(b[1L], " ", b[2:32]), collapse = "")
          }, "")
print(bitI(-8:8), width = 35, quote = FALSE)

## ... of double precision numbers in format  'sign exp | mantissa'
## where  1 bit sign  1 &lt;==&gt; "-";
##       11 bit exp   is the base-2 exponent biased by 2^10 - 1 (1023)
##       52 bit mantissa is without the implicit leading '1'
#
## Bit representation  [ sign | exponent | mantissa ] of double prec numbers :

bitC &lt;- function(x) noquote(vapply(as.double(x), function(x) { # split one double
    b &lt;- substr(as.character(rev(numToBits(x))), 2L, 2L)
    paste0(c(b[1L], " ", b[2:12], " | ", b[13:64]), collapse = "")
  }, ""))
bitC(17)
bitC(c(-1,0,1))
bitC(2^(-2:5))
bitC(1+2^-(1:53))# from 0.5 converge to 1

###  numToBits(.)  &lt;==&gt;   intToBits(numToInts(.)) :
d2bI &lt;- function(x) vapply(as.double(x), function(x) intToBits(numToInts(x)), raw(64L))
d2b  &lt;- function(x) vapply(as.double(x), function(x)           numToBits(x) , raw(64L))
set.seed(1)
x &lt;- c(sort(rt(2048, df=1.5)),  2^(-10:10), 1+2^-(1:53))
str(bx &lt;- d2b(x)) # a  64 x 2122  raw matrix
stopifnot( identical(bx, d2bI(x)) )

## Show that  packBits(*, "double")  is the inverse of numToBits() :
packBits(numToBits(pi), type="double")
bitC(2050)
b &lt;- numToBits(2050) 
identical(b, numToBits(packBits(b, type="double")))
pbx &lt;- apply(bx, 2, packBits, type="double")
stopifnot( identical(pbx, x))
</code></pre>

<hr>
<h2 id='RdUtils'>Utilities for Processing Rd Files</h2><span id='topic+Rdconv'></span><span id='topic+Rd2pdf'></span><span id='topic+RD2PDF_INPUTENC'></span>

<h3>Description</h3>

<p>Utilities for converting files in R documentation (Rd) format to other
formats or create indices from them, and for converting documentation
in other formats to Rd format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R CMD Rdconv [options] file
R CMD Rd2pdf [options] files
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RdUtils_+3A_file">file</code></td>
<td>
<p>the path to a file to be processed.</p>
</td></tr>
<tr><td><code id="RdUtils_+3A_files">files</code></td>
<td>
<p>a list of file names specifying the R documentation
sources to use, by either giving the paths to the files, or the path
to a directory with the sources of a package.</p>
</td></tr>
<tr><td><code id="RdUtils_+3A_options">options</code></td>
<td>
<p>further options to control the processing, or for
obtaining information about usage and version of the utility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>R CMD Rdconv</code> converts Rd format to plain text, HTML or LaTeX
formats: it can also extract the examples.
</p>
<p><code>R CMD Rd2pdf</code> is the user-level program for producing PDF output
from Rd sources.  It will make use of the environment variables
<span class="env">R_PAPERSIZE</span> (set by <code>R CMD</code>, with a default set when <span class="rlang"><b>R</b></span>
was installed: values for <span class="env">R_PAPERSIZE</span> are <code>a4</code>,
<code>letter</code>, <code>legal</code> and <code>executive</code>)
and <span class="env">R_PDFVIEWER</span> (the PDF previewer).  Also,
<span class="env">RD2PDF_INPUTENC</span> can be set to <code>inputenx</code> to make use of the
LaTeX package of that name rather than <code>inputenc</code>: this might be
needed for better support of the UTF-8 encoding.
</p>
<p><code>R CMD Rd2pdf</code> calls <code>tools::<a href="tools.html#topic+texi2pdf">texi2pdf</a></code> to produce
its PDF file: see its help for the possibilities for the
<code>texi2dvi</code> command which that function uses (and which can be
overridden by setting environment variable <span class="env">R_TEXI2DVICMD</span>).
</p>
<p>Use <code>R CMD <var>foo</var> --help</code> to obtain usage information on utility
<code><var>foo</var></code>.
</p>


<h3>See Also</h3>

<p>The section &lsquo;Processing documentation files&rsquo; in the
&lsquo;Writing R Extensions&rsquo; manual: <code><a href="utils.html#topic+RShowDoc">RShowDoc</a>("R-exts")</code>.
</p>

<hr>
<h2 id='readBin'>Transfer Binary Data To and From Connections</h2><span id='topic+readBin'></span><span id='topic+writeBin'></span>

<h3>Description</h3>

<p>Read binary data from or write binary data to a connection or raw vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readBin(con, what, n = 1L, size = NA_integer_, signed = TRUE,
        endian = .Platform$endian)

writeBin(object, con, size = NA_integer_,
         endian = .Platform$endian, useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readBin_+3A_con">con</code></td>
<td>
<p>A <a href="#topic+connection">connection</a> object or a character string naming a file or
a raw vector.</p>
</td></tr>
<tr><td><code id="readBin_+3A_what">what</code></td>
<td>
<p>Either an object whose mode will give the mode of the
vector to be read, or a character vector of length one describing
the mode: one of <code>"numeric"</code>, <code>"double"</code>,
<code>"integer"</code>, <code>"int"</code>, <code>"logical"</code>, <code>"complex"</code>,
<code>"character"</code>, <code>"raw"</code>.</p>
</td></tr>
<tr><td><code id="readBin_+3A_n">n</code></td>
<td>
<p>numeric.  The (maximal) number of records to be
read.  You can use an over-estimate here, but not too large as
storage is reserved for <code>n</code> items.</p>
</td></tr>
<tr><td><code id="readBin_+3A_size">size</code></td>
<td>
<p>integer.  The number of bytes per element in the byte
stream.  The default, <code>NA_integer_</code>, uses the natural size.
Size changing is not supported for raw and complex vectors.</p>
</td></tr>
<tr><td><code id="readBin_+3A_signed">signed</code></td>
<td>
<p>logical.  Only used for integers of sizes 1 and 2,
when it determines if the quantity on file
should be regarded as a signed or unsigned integer.</p>
</td></tr>
<tr><td><code id="readBin_+3A_endian">endian</code></td>
<td>
<p>The endianness (<code>"big"</code> or <code>"little"</code>) of the
target system for the file.  Using <code>"swap"</code> will force swapping
endianness.</p>
</td></tr>
<tr><td><code id="readBin_+3A_object">object</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object to be written to the connection.</p>
</td></tr>
<tr><td><code id="readBin_+3A_usebytes">useBytes</code></td>
<td>
<p>See <code><a href="#topic+writeLines">writeLines</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions can only be used with binary-mode connections.
If <code>con</code> is a character string, the functions call
<code><a href="#topic+file">file</a></code> to obtain a binary-mode file connection which is
opened for the duration of the function call.
</p>
<p>If the connection is open it is read/written from its current
position.  If it is not open, it is opened for the duration of the
call in an appropriate mode (binary read or write) and then closed
again.  An open connection must be in binary mode.
</p>
<p>If <code>readBin</code> is called with <code>con</code> a raw vector, the data in
the vector is used as input.  If <code>writeBin</code> is called with
<code>con</code> a raw vector, it is just an indication that a raw vector
should be returned.
</p>
<p>If <code>size</code> is specified and not the natural size of the object,
each element of the vector is coerced to an appropriate type before
being written or as it is read.  Possible sizes are 1, 2, 4 and
possibly 8 for integer or logical vectors, and 4, 8 and possibly 12/16
for numeric vectors.  (Note that coercion occurs as signed types
except if <code>signed = FALSE</code> when reading integers of sizes 1 and 2.)
Changing sizes is unlikely to preserve <code>NA</code>s, and the extended
precision sizes are unlikely to be portable across platforms.
</p>
<p><code>readBin</code> and <code>writeBin</code> read and write C-style
zero-terminated character strings.  Input strings are limited to 10000
characters.  <code><a href="#topic+readChar">readChar</a></code> and <code><a href="#topic+writeChar">writeChar</a></code> can
be used to read and write fixed-length strings.  No check is made that
the string is valid in the current locale's encoding.
</p>
<p>Handling <span class="rlang"><b>R</b></span>'s missing and special (<code>Inf</code>, <code>-Inf</code> and
<code>NaN</code>) values is discussed in the &lsquo;R Data Import/Export&rsquo; manual.
</p>
<p>Only <code class="reqn">2^{31}-1</code> bytes can be written in a single
call (and that is the maximum capacity of a raw vector on 32-bit
platforms).
</p>
<p>&lsquo;Endian-ness&rsquo; is relevant for <code>size &gt; 1</code>, and should
always be set for portable code (the default is only appropriate when
writing and then reading files on the same platform).
</p>


<h3>Value</h3>

<p>For <code>readBin</code>, a vector of appropriate mode and length the number of
items read (which might be less than <code>n</code>).
</p>
<p>For <code>writeBin</code>, a raw vector (if <code>con</code> is a raw vector) or
invisibly <code>NULL</code>.
</p>


<h3>Note</h3>

<p>Integer read/writes of size 8 will be available if either C type
<code>long</code> is of size 8 bytes or C type <code>long long</code> exists and
is of size 8 bytes.
</p>
<p>Real read/writes of size <code>sizeof(long double)</code> (usually 12 or 16
bytes) will be available only if that type is available and different
from <code>double</code>.
</p>
<p>If <code>readBin(what = character())</code> is used incorrectly on a file
which does not contain C-style character strings, warnings (usually
many) are given.  From a file or connection, the input will be broken
into pieces of length 10000 with any final part being discarded.
</p>


<h3>See Also</h3>

<p>The &lsquo;R Data Import/Export&rsquo; manual.
</p>
<p><code>readChar</code> to read/write fixed-length strings.
</p>
<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+readLines">readLines</a></code>,
<code><a href="#topic+writeLines">writeLines</a></code>.
</p>
<p><code><a href="#topic+.Machine">.Machine</a></code> for the sizes of <code>long</code>, <code>long long</code>
and <code>long double</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zzfil &lt;- tempfile("testbin")
zz &lt;- file(zzfil, "wb")
writeBin(1:10, zz)
writeBin(pi, zz, endian = "swap")
writeBin(pi, zz, size = 4)
writeBin(pi^2, zz, size = 4, endian = "swap")
writeBin(pi+3i, zz)
writeBin("A test of a connection", zz)
z &lt;- paste("A very long string", 1:100, collapse = " + ")
writeBin(z, zz)
if(.Machine$sizeof.long == 8 || .Machine$sizeof.longlong == 8)
    writeBin(as.integer(5^(1:10)), zz, size = 8)
if((s &lt;- .Machine$sizeof.longdouble) &gt; 8)
    writeBin((pi/3)^(1:10), zz, size = s)
close(zz)

zz &lt;- file(zzfil, "rb")
readBin(zz, integer(), 4)
readBin(zz, integer(), 6)
readBin(zz, numeric(), 1, endian = "swap")
readBin(zz, numeric(), size = 4)
readBin(zz, numeric(), size = 4, endian = "swap")
readBin(zz, complex(), 1)
readBin(zz, character(), 1)
z2 &lt;- readBin(zz, character(), 1)
if(.Machine$sizeof.long == 8 || .Machine$sizeof.longlong == 8)
    readBin(zz, integer(), 10,  size = 8)
if((s &lt;- .Machine$sizeof.longdouble) &gt; 8)
    readBin(zz, numeric(), 10, size = s)
close(zz)
unlink(zzfil)
stopifnot(z2 == z)

## signed vs unsigned ints
zzfil &lt;- tempfile("testbin")
zz &lt;- file(zzfil, "wb")
x &lt;- as.integer(seq(0, 255, 32))
writeBin(x, zz, size = 1)
writeBin(x, zz, size = 1)
x &lt;- as.integer(seq(0, 60000, 10000))
writeBin(x, zz, size = 2)
writeBin(x, zz, size = 2)
close(zz)
zz &lt;- file(zzfil, "rb")
readBin(zz, integer(), 8, size = 1)
readBin(zz, integer(), 8, size = 1, signed = FALSE)
readBin(zz, integer(), 7, size = 2)
readBin(zz, integer(), 7, size = 2, signed = FALSE)
close(zz)
unlink(zzfil)

## use of raw
z &lt;- writeBin(pi^{1:5}, raw(), size = 4)
readBin(z, numeric(), 5, size = 4)
z &lt;- writeBin(c("a", "test", "of", "character"), raw())
readBin(z, character(), 4)
</code></pre>

<hr>
<h2 id='readChar'>Transfer Character Strings To and From Connections</h2><span id='topic+readChar'></span><span id='topic+writeChar'></span>

<h3>Description</h3>

<p>Transfer character strings to and from connections, without assuming
they are null-terminated on the connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readChar(con, nchars, useBytes = FALSE)

writeChar(object, con, nchars = nchar(object, type = "chars"),
          eos = "", useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readChar_+3A_con">con</code></td>
<td>
<p>a <a href="#topic+connection">connection</a> object, or a character string naming a file,
or a raw vector.</p>
</td></tr>
<tr><td><code id="readChar_+3A_nchars">nchars</code></td>
<td>
<p>integer vector, giving the lengths in characters of
(unterminated) character strings to be read or written.  Elements
must be &gt;= 0 and not <code>NA</code>.</p>
</td></tr>
<tr><td><code id="readChar_+3A_usebytes">useBytes</code></td>
<td>
<p>logical: For <code>readChar</code>, should <code>nchars</code> be
regarded as a number of bytes not characters in a multi-byte
locale?  For <code>writeChar</code>, see <code><a href="#topic+writeLines">writeLines</a></code>.</p>
</td></tr>
<tr><td><code id="readChar_+3A_object">object</code></td>
<td>
<p>a character vector to be written to the connection, at
least as long as <code>nchars</code>.</p>
</td></tr>
<tr><td><code id="readChar_+3A_eos">eos</code></td>
<td>
<p>&lsquo;end of string&rsquo;: character string.  The terminator
to be written after each string, followed by an ASCII <code>nul</code>;
use <code>NULL</code> for no terminator at all.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions complement <code><a href="#topic+readBin">readBin</a></code> and
<code><a href="#topic+writeBin">writeBin</a></code> which read and write C-style zero-terminated
character strings.  They are for strings of known length, and
can optionally write an end-of-string mark.  They are intended only
for character strings valid in the current locale.
</p>
<p>These functions are intended to be used with binary-mode connections.
If <code>con</code> is a character string, the functions call
<code><a href="#topic+file">file</a></code> to obtain a binary-mode file connection which is
opened for the duration of the function call.
</p>
<p>If the connection is open it is read/written from its current
position.  If it is not open, it is opened for the duration of the
call in an appropriate mode (binary read or write) and then closed
again.  An open connection must be in binary mode.
</p>
<p>If <code>readChar</code> is called with <code>con</code> a raw vector, the data in
the vector is used as input.  If <code>writeChar</code> is called with
<code>con</code> a raw vector, it is just an indication that a raw vector
should be returned.
</p>
<p>Character strings containing ASCII <code>nul</code>(s) will be read
correctly by <code>readChar</code> but truncated at the first
<code>nul</code> with a warning.
</p>
<p>If the character length requested for <code>readChar</code> is longer than
the data available on the connection, what is available is
returned.  For <code>writeChar</code> if too many characters are requested
the output is zero-padded, with a warning.
</p>
<p>Missing strings are written as <code>NA</code>.
</p>


<h3>Value</h3>

<p>For <code>readChar</code>, a character vector of length the number of
items read (which might be less than <code>length(nchars)</code>).
</p>
<p>For <code>writeChar</code>, a raw vector (if <code>con</code> is a raw vector) or
invisibly <code>NULL</code>.
</p>


<h3>Note</h3>

<p>Earlier versions of <span class="rlang"><b>R</b></span> allowed embedded <abbr>NUL</abbr> bytes within character
strings, but not <span class="rlang"><b>R</b></span> &gt;= 2.8.0.  <code>readChar</code> was commonly used to
read fixed-size zero-padded byte fields for which <code>readBin</code> was
unsuitable.  <code>readChar</code> can still be used for such fields if
there are no embedded <abbr>NUL</abbr>s: otherwise <code>readBin(what = "raw")</code>
provides an alternative.
</p>
<p><code>nchars</code> will be interpreted in bytes not characters in a
non-UTF-8 multi-byte locale, with a warning.
</p>
<p>There is little validity checking of UTF-8 reads.
</p>
<p>Using these functions on a text-mode connection may work but should
not be mixed with text-mode access to the connection, especially if
the connection was opened with an <code>encoding</code> argument.
</p>


<h3>See Also</h3>

<p>The &lsquo;R Data Import/Export&rsquo; manual.
</p>
<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+readLines">readLines</a></code>,
<code><a href="#topic+writeLines">writeLines</a></code>, <code><a href="#topic+readBin">readBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## test fixed-length strings
zzfil &lt;- tempfile("testchar")
zz &lt;- file(zzfil, "wb")
x &lt;- c("a", "this will be truncated", "abc")
nc &lt;- c(3, 10, 3)
writeChar(x, zz, nc, eos = NULL)
writeChar(x, zz, eos = "\r\n")
close(zz)

zz &lt;- file(zzfil, "rb")
readChar(zz, nc)
readChar(zz, nchar(x)+3) # need to read the terminator explicitly
close(zz)
unlink(zzfil)
</code></pre>

<hr>
<h2 id='readline'>Read a Line from the Terminal</h2><span id='topic+readline'></span>

<h3>Description</h3>

<p><code>readline</code> reads a line from the terminal (in interactive use).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readline(prompt = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readline_+3A_prompt">prompt</code></td>
<td>
<p>the string printed when prompting the user for input.
Should usually end with a space <code>" "</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prompt string will be truncated to a maximum allowed length,
normally 256 chars (but can be changed in the source code).
</p>
<p>This can only be used in an <a href="#topic+interactive">interactive</a> session.
</p>


<h3>Value</h3>

<p>A character vector of length one.  Both leading and trailing
spaces and tabs are stripped from the result.
</p>
<p>In non-<a href="#topic+interactive">interactive</a> use the result is as if the response was
RETURN and the value is <code>""</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readLines">readLines</a></code> for reading text lines from connections,
including files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fun &lt;- function() {
  ANSWER &lt;- readline("Are you a satisfied R user? ")
  ## a better version would check the answer less cursorily, and
  ## perhaps re-prompt
  if (substr(ANSWER, 1, 1) == "n")
    cat("This is impossible.  YOU LIED!\n")
  else
    cat("I knew it.\n")
}
if(interactive()) fun()
</code></pre>

<hr>
<h2 id='readLines'>Read Text Lines from a Connection</h2><span id='topic+readLines'></span>

<h3>Description</h3>

<p>Read some or all text lines from a connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readLines(con = stdin(), n = -1L, ok = TRUE, warn = TRUE,
          encoding = "unknown", skipNul = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readLines_+3A_con">con</code></td>
<td>
<p>a <a href="#topic+connection">connection</a> object or a character string.</p>
</td></tr>
<tr><td><code id="readLines_+3A_n">n</code></td>
<td>
<p>integer.  The (maximal) number of lines to
read.  Negative values indicate that one should read up to the end of
input on the connection.</p>
</td></tr>
<tr><td><code id="readLines_+3A_ok">ok</code></td>
<td>
<p>logical.  Is it OK to reach the end of the connection before
<code>n &gt; 0</code> lines are read?  If not, an error will be generated.</p>
</td></tr>
<tr><td><code id="readLines_+3A_warn">warn</code></td>
<td>
<p>logical.  Warn if a text file is missing a final <abbr>EOL</abbr> or if
there are embedded <abbr>NUL</abbr>s in the file.</p>
</td></tr>
<tr><td><code id="readLines_+3A_encoding">encoding</code></td>
<td>
<p>encoding to be assumed for input strings.  It is
used to mark character strings as known to be in
Latin-1, UTF-8 or to be bytes: it is not used to re-encode the input.
To do the
latter, specify the encoding as part of the connection <code>con</code> or
via <code><a href="#topic+options">options</a>(encoding=)</code>: see the examples
and &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="readLines_+3A_skipnul">skipNul</code></td>
<td>
<p>logical: should <abbr>NUL</abbr>s be skipped?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>con</code> is a character string, the function calls
<code><a href="#topic+file">file</a></code> to obtain a file connection which is opened for
the duration of the function call.  This can be a compressed file.
(<a href="#topic+tilde+20expansion">tilde expansion</a> of the file path is done by <code>file</code>.)
</p>
<p>If the connection is open it is read from its current position.  If it
is not open, it is opened in <code>"rt"</code> mode for the duration of
the call and then closed (but not destroyed; one must call
<code><a href="#topic+close">close</a></code> to do that).
</p>
<p>If the final line is incomplete (no final <abbr>EOL</abbr> marker) the behaviour
depends on whether the connection is blocking or not.  For a
non-blocking text-mode connection the incomplete line is pushed back,
silently.  For all other connections the line will be accepted, with a
warning.
</p>
<p>Whatever mode the connection is opened in, any of <abbr>LF</abbr>,
<abbr>CRLF</abbr> or <abbr>CR</abbr> will be accepted as the <abbr>EOL</abbr> marker for
a line. 
</p>
<p>Embedded <abbr>NUL</abbr>s in the input stream will terminate the line currently
being read, with a warning (unless <code>skipNul = TRUE</code> or <code>warn
    = FALSE</code>).
</p>
<p>If <code>con</code> is a not-already-open <a href="#topic+connection">connection</a> with a non-default
<code>encoding</code> argument, the text is converted to UTF-8 and declared
as such (and the <code>encoding</code> argument to <code>readLines</code> is ignored).
See the examples.
</p>


<h3>Value</h3>

<p>A character vector of length the number of lines read.
</p>
<p>The elements of the result have a declared encoding if <code>encoding</code> is
<code>"latin1"</code> or <code>"UTF-8"</code>,
</p>


<h3>Note</h3>

<p>The default connection, <code><a href="#topic+stdin">stdin</a></code>, may be different from
<code>con = "stdin"</code>: see <code><a href="#topic+file">file</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+writeLines">writeLines</a></code>, <code><a href="#topic+readBin">readBin</a></code>,
<code><a href="#topic+scan">scan</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>fil &lt;- tempfile(fileext = ".data")
cat("TITLE extra line", "2 3 5 7", "", "11 13 17", file = fil,
    sep = "\n")
readLines(fil, n = -1)
unlink(fil) # tidy up

## difference in blocking
fil &lt;- tempfile("test")
cat("123\nabc", file = fil)
readLines(fil) # line with a warning

con &lt;- file(fil, "r", blocking = FALSE)
readLines(con) # "123"
cat(" def\n", file = fil, append = TRUE)
readLines(con) # gets both
close(con)

unlink(fil) # tidy up

## Not run: 
# read a 'Windows Unicode' file
A &lt;- readLines(con &lt;- file("Unicode.txt", encoding = "UCS-2LE"))
close(con)
unique(Encoding(A)) # will most likely be UTF-8

## End(Not run)</code></pre>

<hr>
<h2 id='readRDS'>Serialization Interface for Single Objects</h2><span id='topic+readRDS'></span><span id='topic+saveRDS'></span><span id='topic+infoRDS'></span>

<h3>Description</h3>

<p>Functions to write a single <span class="rlang"><b>R</b></span> object to a file, and to restore it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveRDS(object, file = "", ascii = FALSE, version = NULL,
        compress = TRUE, refhook = NULL)

readRDS(file, refhook = NULL)
infoRDS(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readRDS_+3A_object">object</code></td>
<td>
<p><span class="rlang"><b>R</b></span> object to serialize.</p>
</td></tr>
<tr><td><code id="readRDS_+3A_file">file</code></td>
<td>
<p>a <a href="#topic+connection">connection</a> or the name of the file where the <span class="rlang"><b>R</b></span> object
is saved to or read from.</p>
</td></tr>
<tr><td><code id="readRDS_+3A_ascii">ascii</code></td>
<td>
<p>a logical.  If <code>TRUE</code> or <code>NA</code>, an ASCII
representation is written; otherwise (default), a binary one is used.
See the comments in the help for <code><a href="#topic+save">save</a></code>.</p>
</td></tr>
<tr><td><code id="readRDS_+3A_version">version</code></td>
<td>
<p>the workspace format version to use.  <code>NULL</code>
specifies the current default version (3). The only other supported
value is 2, the default from <span class="rlang"><b>R</b></span> 1.4.0 to <span class="rlang"><b>R</b></span> 3.5.0.</p>
</td></tr>
<tr><td><code id="readRDS_+3A_compress">compress</code></td>
<td>
<p>a logical specifying whether saving to a named file is
to use <code>"gzip"</code> compression, or one of <code>"gzip"</code>,
<code>"bzip2"</code> or <code>"xz"</code> to indicate the type of compression to
be used.  Ignored if <code>file</code> is a connection.</p>
</td></tr>
<tr><td><code id="readRDS_+3A_refhook">refhook</code></td>
<td>
<p>a hook function for handling reference objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>saveRDS</code> and <code>readRDS</code> provide the means to save a single <span class="rlang"><b>R</b></span>
object to a connection (typically a file) and to restore the object, quite
possibly under a different name.  This differs from <code><a href="#topic+save">save</a></code> and
<code><a href="#topic+load">load</a></code>, which save and restore one or more named objects into
an environment.  They are widely used by <span class="rlang"><b>R</b></span> itself, for example to store
metadata for a package and to store the <code><a href="utils.html#topic+help.search">help.search</a></code>
databases: the <code>".rds"</code> file extension is most often used.
</p>
<p>Functions <code><a href="#topic+serialize">serialize</a></code> and <code><a href="#topic+unserialize">unserialize</a></code>
provide a slightly lower-level interface to serialization: objects
serialized to a connection by <code>serialize</code> can be read back by
<code>readRDS</code> and conversely.
</p>
<p>Function <code>infoRDS</code> retrieves meta-data about serialization produced
by <code>saveRDS</code> or <code>serialize</code>. <code>infoRDS</code> cannot be used to
detect whether a file is a serialization nor whether it is valid.
</p>
<p>All of these interfaces use the same serialization format, but <code>save</code>
writes a single line header (typically <code>"RDXs\n"</code>) before the
serialization of a single object (a pairlist of all the objects to be
saved).
</p>
<p>If <code>file</code> is a file name, it is opened by <code><a href="#topic+gzfile">gzfile</a></code>
except for <code>save(compress = FALSE)</code> which uses
<code><a href="#topic+file">file</a></code>.  Only for the exception are marked encodings of
<code>file</code> which cannot be translated to the native encoding handled
on Windows.
</p>
<p>Compression is handled by the connection opened when <code>file</code> is a
file name, so is only possible when <code>file</code> is a connection if
handled by the connection.  So e.g. <code><a href="#topic+url">url</a></code>
connections will need to be wrapped in a call to <code><a href="#topic+gzcon">gzcon</a></code>.
</p>
<p>If a connection is supplied it will be opened (in binary mode) for the
duration of the function if not already open: if it is already open it
must be in binary mode for <code>saveRDS(ascii = FALSE)</code> or to read
non-ASCII saves.
</p>


<h3>Value</h3>

<p>For <code>readRDS</code>, an <span class="rlang"><b>R</b></span> object.
</p>
<p>For <code>saveRDS</code>, <code>NULL</code> invisibly.
</p>
<p>For <code>infoRDS</code>, an <span class="rlang"><b>R</b></span> list with elements <code>version</code> (version
number, currently 2 or 3), <code>writer_version</code> (version of <span class="rlang"><b>R</b></span> that
produced the serialization), <code>min_reader_version</code> (minimum version of
<span class="rlang"><b>R</b></span> that can read the serialization), <code>format</code> (data representation)
and <code>native_encoding</code> (native encoding of the session that produced
the serialization, available since version 3).  The data representation is
given as <code>"xdr"</code> for big-endian binary representation, <code>"ascii"</code>
for ASCII representation (produced via <code>ascii = TRUE</code> or <code>ascii
  = NA</code>) or <code>"binary"</code> (binary representation with native
&lsquo;endianness&rsquo; which can be produced by <code><a href="#topic+serialize">serialize</a></code>).
</p>


<h3>Warning</h3>

<p>Files produced by <code>saveRDS</code> (or <code>serialize</code> to a file
connection) are not suitable as an interchange format between
machines, for example to download from a website. The
files produced by <code><a href="#topic+save">save</a></code> have a header identifying the
file type and so are better protected against erroneous use.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+serialize">serialize</a></code>, <code><a href="#topic+save">save</a></code> and <code><a href="#topic+load">load</a></code>.
</p>
<p>The &lsquo;R Internals&rsquo; manual for details of the format used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fil &lt;- tempfile("women", fileext = ".rds")
## save a single object to file
saveRDS(women, fil)
## restore it under a different name
women2 &lt;- readRDS(fil)
identical(women, women2)
## or examine the object via a connection, which will be opened as needed.
con &lt;- gzfile(fil)
readRDS(con)
close(con)

## Less convenient ways to restore the object
## which demonstrate compatibility with unserialize()
con &lt;- gzfile(fil, "rb")
identical(unserialize(con), women)
close(con)
con &lt;- gzfile(fil, "rb")
wm &lt;- readBin(con, "raw", n = 1e4) # size is a guess
close(con)
identical(unserialize(wm), women)

## Format compatibility with serialize():
fil2 &lt;- tempfile("women")
con &lt;- file(fil2, "w")
serialize(women, con) # ASCII, uncompressed
close(con)
identical(women, readRDS(fil2))
fil3 &lt;- tempfile("women")
con &lt;- bzfile(fil3, "w")
serialize(women, con) # binary, bzip2-compressed
close(con)
identical(women, readRDS(fil3))

unlink(c(fil, fil2, fil3))
</code></pre>

<hr>
<h2 id='readRenviron'>
Set Environment Variables from a File
</h2><span id='topic+readRenviron'></span>

<h3>Description</h3>

<p>Read as file such as &lsquo;<span class="file">.Renviron</span>&rsquo; or &lsquo;<span class="file">Renviron.site</span>&rsquo; in the
format described in the help for <a href="#topic+Startup">Startup</a>, and set environment
variables as defined in the file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readRenviron(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readRenviron_+3A_path">path</code></td>
<td>
<p>A length-one character vector giving the path to the
file.  Tilde-expansion is performed where supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar logical indicating if the file was read successfully.  Returned
invisibly.  If the file cannot be opened for reading, a warning is given.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Startup">Startup</a></code> for the file format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## re-read a startup file (or read it in a vanilla session)
readRenviron("~/.Renviron")

## End(Not run)</code></pre>

<hr>
<h2 id='Recall'>Recursive Calling</h2><span id='topic+Recall'></span>

<h3>Description</h3>

<p><code>Recall</code> is used as a placeholder for the name of the function
in which it is called.  It allows the definition of recursive
functions which still work after being renamed, see example below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Recall(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Recall_+3A_...">...</code></td>
<td>
<p>all the arguments to be passed.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code>Recall</code> will not work correctly when passed as a function
argument, e.g. to the <code>apply</code> family of functions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+do.call">do.call</a></code> and <code><a href="#topic+call">call</a></code>.
</p>
<p><code><a href="#topic+local">local</a></code> for another way to write anonymous recursive functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A trivial (but inefficient!) example:
fib &lt;- function(n)
   if(n&lt;=2) { if(n&gt;=0) 1 else 0 } else Recall(n-1) + Recall(n-2)
fibonacci &lt;- fib; rm(fib)
## renaming wouldn't work without Recall
fibonacci(10) # 55
</code></pre>

<hr>
<h2 id='reg.finalizer'>Finalization of Objects</h2><span id='topic+reg.finalizer'></span><span id='topic+finalizer'></span>

<h3>Description</h3>

<p>Registers an <span class="rlang"><b>R</b></span> function to be called upon garbage collection of
object or (optionally) at the end of an <span class="rlang"><b>R</b></span> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  reg.finalizer(e, f, onexit = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reg.finalizer_+3A_e">e</code></td>
<td>
<p>object to finalize.  Must be an environment or an external pointer.</p>
</td></tr>
<tr><td><code id="reg.finalizer_+3A_f">f</code></td>
<td>
<p>function to call on finalization. Must accept a single argument,
which will be the object to finalize.</p>
</td></tr>
<tr><td><code id="reg.finalizer_+3A_onexit">onexit</code></td>
<td>
<p>logical: should the finalizer be run if the object is
still uncollected at the end of the <span class="rlang"><b>R</b></span> session?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main purpose of this function is to allow objects that refer to
external items (a temporary file, say) to perform cleanup actions when
they are no longer referenced from within <span class="rlang"><b>R</b></span>.  This only makes sense
for objects that are never copied on assignment, hence the restriction
to environments and external pointers.
</p>
<p><em>Inter alia</em>, it provides a way to program code to be run at
the end of an <span class="rlang"><b>R</b></span> session without manipulating <code><a href="#topic+.Last">.Last</a></code>.
For use in a package, it is often a good idea to set a finalizer on an
object in the namespace: then it will be called at the end of the
session, or soon after the namespace is unloaded if that is done
during the session.
</p>


<h3>Value</h3>

<p><code>NULL</code>.
</p>


<h3>Note</h3>

<p><span class="rlang"><b>R</b></span>'s interpreter is not re-entrant and the finalizer could be run in
the middle of a computation.  So there are many functions which it is
potentially unsafe to call from <code>f</code>: one example which caused
trouble is <code><a href="#topic+options">options</a></code>.  Finalizers are
scheduled at garbage collection but only run at a relatively safe time
thereafter.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gc">gc</a></code> and <code><a href="#topic+Memory">Memory</a></code> for garbage collection and
memory management.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(e) print("cleaning....")
g &lt;- function(x){ e &lt;- environment(); reg.finalizer(e, f) }
g()
invisible(gc()) # trigger cleanup
</code></pre>

<hr>
<h2 id='regex'>Regular Expressions as used in R</h2><span id='topic+regex'></span><span id='topic+regexp'></span><span id='topic+regular+20expression'></span>

<h3>Description</h3>

<p>This help page documents the regular expression patterns supported by
<code><a href="#topic+grep">grep</a></code> and related functions <code>grepl</code>, <code>regexpr</code>,
<code>gregexpr</code>, <code>sub</code> and <code>gsub</code>, as well as by
<code><a href="#topic+strsplit">strsplit</a></code> and optionally by <code><a href="#topic+agrep">agrep</a></code> and
<code><a href="#topic+agrepl">agrepl</a></code>.
</p>


<h3>Details</h3>

<p>A &lsquo;regular expression&rsquo; is a pattern that describes a set of
strings.  Two types of regular expressions are used in <span class="rlang"><b>R</b></span>,
<em>extended</em> regular expressions (the default) and
<em>Perl-like</em> regular expressions used by <code>perl = TRUE</code>.
There is also <code>fixed = TRUE</code> which can be considered to use a
<em>literal</em> regular expression.
</p>
<p>Other functions which use regular expressions (often via the use of
<code>grep</code>) include <code>apropos</code>, <code>browseEnv</code>,
<code>help.search</code>, <code>list.files</code> and <code>ls</code>.
These will all use <em>extended</em> regular expressions.
</p>
<p>Patterns are described here as they would be printed by <code>cat</code>:
(<em>do remember that backslashes need to be doubled when entering <span class="rlang"><b>R</b></span>
character strings</em>, e.g. from the keyboard).
</p>
<p>Long regular expression patterns may or may not be accepted: the POSIX
standard only requires up to 256 <em>bytes</em>.
</p>


<h3>Extended Regular Expressions</h3>

<p>This section covers the regular expressions allowed in the default
mode of <code>grep</code>, <code>grepl</code>, <code>regexpr</code>, <code>gregexpr</code>,
<code>sub</code>, <code>gsub</code>, <code>regexec</code> and <code>strsplit</code>.  They use
an implementation of the POSIX 1003.2 standard: that allows some scope
for interpretation and the interpretations here are those currently
used by <span class="rlang"><b>R</b></span>.  The implementation supports some extensions to the
standard.
</p>
<p>Regular expressions are constructed analogously to arithmetic
expressions, by using various operators to combine smaller
expressions.  The whole expression matches zero or more characters
(read &lsquo;character&rsquo; as &lsquo;byte&rsquo; if <code>useBytes = TRUE</code>).
</p>
<p>The fundamental building blocks are the regular expressions that match
a single character.  Most characters, including all letters and
digits, are regular expressions that match themselves.  Any
metacharacter with special meaning may be quoted by preceding it with
a backslash.  The metacharacters in extended regular expressions are
&lsquo;<span class="samp">&#8288;. \ | ( ) [ { ^ $ * + ?&#8288;</span>&rsquo;, but note that whether these have a
special meaning depends on the context.
</p>
<p>Escaping non-metacharacters with a backslash is
implementation-dependent.  The current implementation interprets
&lsquo;<span class="samp">&#8288;\a&#8288;</span>&rsquo; as &lsquo;<span class="samp">&#8288;BEL&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\e&#8288;</span>&rsquo; as &lsquo;<span class="samp">&#8288;ESC&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\f&#8288;</span>&rsquo; as
&lsquo;<span class="samp">&#8288;FF&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\n&#8288;</span>&rsquo; as &lsquo;<span class="samp">&#8288;LF&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\r&#8288;</span>&rsquo; as &lsquo;<span class="samp">&#8288;CR&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;\t&#8288;</span>&rsquo; as &lsquo;<span class="samp">&#8288;TAB&#8288;</span>&rsquo;.  (Note that these will be interpreted by
<span class="rlang"><b>R</b></span>'s parser in literal character strings.)
</p>
<p>A <em>character class</em> is a list of characters enclosed between
&lsquo;<span class="samp">&#8288;[&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;]&#8288;</span>&rsquo; which matches any single character in that list;
unless the first character of the list is the caret &lsquo;<span class="samp">&#8288;^&#8288;</span>&rsquo;, when it
matches any character <em>not</em> in the list.  For example, the
regular expression &lsquo;<span class="samp">&#8288;[0123456789]&#8288;</span>&rsquo; matches any single digit, and
&lsquo;<span class="samp">&#8288;[^abc]&#8288;</span>&rsquo; matches anything except the characters &lsquo;<span class="samp">&#8288;a&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;b&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;c&#8288;</span>&rsquo;.  A range of characters may be specified by
giving the first and last characters, separated by a hyphen.  (Because
their interpretation is locale- and implementation-dependent,
character ranges are best avoided.  Some but not all implementations
include both cases in ranges when doing caseless matching.)  The only
portable way to specify all ASCII letters is to list them all as the
character class<br />
&lsquo;<span class="samp">&#8288;[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz]&#8288;</span>&rsquo;.<br /> (The
current implementation uses numerical order of the encoding, normally a
single-byte encoding or Unicode points.)

</p>
<p>Certain named classes of characters are predefined.  Their
interpretation depends on the <em>locale</em> (see <a href="#topic+locales">locales</a>); the
interpretation below is that of the POSIX locale.
</p>

<dl>
<dt>&lsquo;<span class="samp">&#8288;[:alnum:]&#8288;</span>&rsquo;</dt><dd><p>Alphanumeric characters: &lsquo;<span class="samp">&#8288;[:alpha:]&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;[:digit:]&#8288;</span>&rsquo;.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:alpha:]&#8288;</span>&rsquo;</dt><dd><p>Alphabetic characters: &lsquo;<span class="samp">&#8288;[:lower:]&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;[:upper:]&#8288;</span>&rsquo;.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:blank:]&#8288;</span>&rsquo;</dt><dd><p>Blank characters: space and tab, and
possibly other locale-dependent characters, but on most platforms
not including non-breaking space.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:cntrl:]&#8288;</span>&rsquo;</dt><dd>
<p>Control characters.  In ASCII, these characters have octal codes
000 through 037, and 177 (<code>DEL</code>).  In another character set,
these are the equivalent characters, if any.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:digit:]&#8288;</span>&rsquo;</dt><dd><p>Digits: &lsquo;<span class="samp">&#8288;0 1 2 3 4 5 6 7 8 9&#8288;</span>&rsquo;.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:graph:]&#8288;</span>&rsquo;</dt><dd><p>Graphical characters: &lsquo;<span class="samp">&#8288;[:alnum:]&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;[:punct:]&#8288;</span>&rsquo;.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:lower:]&#8288;</span>&rsquo;</dt><dd><p>Lower-case letters in the current locale.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:print:]&#8288;</span>&rsquo;</dt><dd>
<p>Printable characters: &lsquo;<span class="samp">&#8288;[:alnum:]&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;[:punct:]&#8288;</span>&rsquo; and space.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:punct:]&#8288;</span>&rsquo;</dt><dd><p>Punctuation characters:<br />
&lsquo;<span class="samp">&#8288;! " # $ % &amp; ' ( ) * + , - . / : ; &lt; = &gt; ? @ [ \ ] ^ _ ` { | } ~&#8288;</span>&rsquo;.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:space:]&#8288;</span>&rsquo;</dt><dd>
<p>Space characters: tab, newline, vertical tab, form feed, carriage
return, space and possibly other locale-dependent characters &ndash; on
most platforms this does not include non-breaking spaces.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:upper:]&#8288;</span>&rsquo;</dt><dd><p>Upper-case letters in the current locale.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;[:xdigit:]&#8288;</span>&rsquo;</dt><dd><p>Hexadecimal digits:<br />
&lsquo;<span class="samp">&#8288;0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f&#8288;</span>&rsquo;.</p>
</dd>
</dl>

<p>For example, &lsquo;<span class="samp">&#8288;[[:alnum:]]&#8288;</span>&rsquo; means &lsquo;<span class="samp">&#8288;[0-9A-Za-z]&#8288;</span>&rsquo;, except the
latter depends upon the locale and the character encoding, whereas the
former is independent of locale and character set.  (Note that the
brackets in these class names are part of the symbolic names, and must
be included in addition to the brackets delimiting the bracket list.)
Most metacharacters lose their special meaning inside a character
class.  To include a literal &lsquo;<span class="samp">&#8288;]&#8288;</span>&rsquo;, place it first in the list.
Similarly, to include a literal &lsquo;<span class="samp">&#8288;^&#8288;</span>&rsquo;, place it anywhere but first.
Finally, to include a literal &lsquo;<span class="samp">&#8288;-&#8288;</span>&rsquo;, place it first or last (or,
for <code>perl = TRUE</code> only, precede it by a backslash).  (Only
&lsquo;<span class="samp">&#8288;^ - \ ]&#8288;</span>&rsquo; are special inside character classes.)
</p>
<p>The period &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo; matches any single character.  The symbol
&lsquo;<span class="samp">&#8288;\w&#8288;</span>&rsquo; matches a &lsquo;word&rsquo; character (a synonym for
&lsquo;<span class="samp">&#8288;[[:alnum:]_]&#8288;</span>&rsquo;, an extension) and &lsquo;<span class="samp">&#8288;\W&#8288;</span>&rsquo; is its negation
(&lsquo;<span class="samp">&#8288;[^[:alnum:]_]&#8288;</span>&rsquo;).  Symbols &lsquo;<span class="samp">&#8288;\d&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\s&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\D&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;\S&#8288;</span>&rsquo; denote the digit and space classes and their negations
(these are all extensions).
</p>
<p>The caret &lsquo;<span class="samp">&#8288;^&#8288;</span>&rsquo; and the dollar sign &lsquo;<span class="samp">&#8288;$&#8288;</span>&rsquo; are metacharacters
that respectively match the empty string at the beginning and end of a
line.  The symbols &lsquo;<span class="samp">&#8288;\&lt;&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\&gt;&#8288;</span>&rsquo; match the empty string at
the beginning and end of a word.  The symbol &lsquo;<span class="samp">&#8288;\b&#8288;</span>&rsquo; matches the
empty string at either edge of a word, and &lsquo;<span class="samp">&#8288;\B&#8288;</span>&rsquo; matches the
empty string provided it is not at an edge of a word.  (The
interpretation of &lsquo;word&rsquo; depends on the locale and
implementation: these are all extensions.)
</p>
<p>A regular expression may be followed by one of several repetition
quantifiers:
</p>

<dl>
<dt>&lsquo;<span class="samp">&#8288;?&#8288;</span>&rsquo;</dt><dd><p>The preceding item is optional and will be matched
at most once.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;*&#8288;</span>&rsquo;</dt><dd><p>The preceding item will be matched zero or more
times.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;+&#8288;</span>&rsquo;</dt><dd><p>The preceding item will be matched one or more
times.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;{n}&#8288;</span>&rsquo;</dt><dd><p>The preceding item is matched exactly <code>n</code>
times.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;{n,}&#8288;</span>&rsquo;</dt><dd><p>The preceding item is matched <code>n</code> or more
times.</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;{n,m}&#8288;</span>&rsquo;</dt><dd><p>The preceding item is matched at least <code>n</code>
times, but not more than <code>m</code> times.</p>
</dd>
</dl>

<p>By default repetition is greedy, so the maximal possible number of
repeats is used.  This can be changed to &lsquo;minimal&rsquo; by appending
<code>?</code> to the quantifier.  (There are further quantifiers that allow
approximate matching: see the TRE documentation.)
</p>
<p>Regular expressions may be concatenated; the resulting regular
expression matches any string formed by concatenating the substrings
that match the concatenated subexpressions.
</p>
<p>Two regular expressions may be joined by the infix operator &lsquo;<span class="samp">&#8288;|&#8288;</span>&rsquo;;
the resulting regular expression matches any string matching either
subexpression.   For example, &lsquo;<span class="samp">&#8288;abba|cde&#8288;</span>&rsquo; matches either the
string <code>abba</code> or the string <code>cde</code>.  Note that alternation
does not work inside character classes, where &lsquo;<span class="samp">&#8288;|&#8288;</span>&rsquo; has its literal
meaning.
</p>
<p>Repetition takes precedence over concatenation, which in turn takes
precedence over alternation.  A whole subexpression may be enclosed in
parentheses to override these precedence rules.
</p>
<p>The backreference &lsquo;<span class="samp">&#8288;\N&#8288;</span>&rsquo;, where &lsquo;<span class="samp">&#8288;N = 1 ... 9&#8288;</span>&rsquo;, matches
the substring previously matched by the Nth parenthesized
subexpression of the regular expression.  (This is an
extension for extended regular expressions: POSIX defines them only
for basic ones.)
</p>


<h3>Perl-like Regular Expressions</h3>

<p>The <code>perl = TRUE</code> argument to <code>grep</code>, <code>regexpr</code>,
<code>gregexpr</code>, <code>sub</code>, <code>gsub</code> and <code>strsplit</code> switches
to the PCRE library that implements regular expression pattern
matching using the same syntax and semantics as Perl 5.x,
with just a few differences.
</p>
<p>For complete details please consult the man pages for PCRE, especially
<code>man pcrepattern</code> and <code>man pcreapi</code>, on your system or
from the sources at <a href="https://www.pcre.org">https://www.pcre.org</a>.  (The version in use can be
found by calling <code><a href="#topic+extSoftVersion">extSoftVersion</a></code>.  It need not be the version
described in the system's man page.  PCRE1 (reported as version &lt; 10.00 by
<code><a href="#topic+extSoftVersion">extSoftVersion</a></code>) has been feature-frozen for some time
(essentially 2012), the man pages at
<a href="https://www.pcre.org/original/doc/html/">https://www.pcre.org/original/doc/html/</a> should be a good match.
PCRE2 (PCRE version &gt;= 10.00) has man pages at
<a href="https://www.pcre.org/current/doc/html/">https://www.pcre.org/current/doc/html/</a>).
</p>
<p>Perl regular expressions can be computed byte-by-byte or
(UTF-8) character-by-character: the latter is used in all multibyte
locales and if any of the inputs are marked as UTF-8 (see
<code><a href="#topic+Encoding">Encoding</a></code>, or as Latin-1 except in a Latin-1 locale.
</p>
<p>All the regular expressions described for extended regular expressions
are accepted except &lsquo;<span class="samp">&#8288;\&lt;&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\&gt;&#8288;</span>&rsquo;: in Perl all backslashed
metacharacters are alphanumeric and backslashed symbols always are
interpreted as a literal character. &lsquo;<span class="samp">&#8288;{&#8288;</span>&rsquo; is not special if it
would be the start of an invalid interval specification.  There can be
more than 9 backreferences (but the replacement in <code><a href="#topic+sub">sub</a></code>
can only refer to the first 9).
</p>
<p>Character ranges are interpreted in the numerical order of the
characters, either as bytes in a single-byte locale or as Unicode code
points in UTF-8 mode.  So in either case &lsquo;<span class="samp">&#8288;[A-Za-z]&#8288;</span>&rsquo; specifies the
set of ASCII letters.
</p>
<p>In UTF-8 mode the named character classes only match ASCII characters:
see &lsquo;<span class="samp">&#8288;\p&#8288;</span>&rsquo; below for an alternative.
</p>
<p>The construct &lsquo;<span class="samp">&#8288;(?...)&#8288;</span>&rsquo; is used for Perl extensions in a variety
of ways depending on what immediately follows the &lsquo;<span class="samp">&#8288;?&#8288;</span>&rsquo;.
</p>
<p>Perl-like matching can work in several modes, set by the options
&lsquo;<span class="samp">&#8288;(?i)&#8288;</span>&rsquo; (caseless, equivalent to Perl's &lsquo;<span class="samp">&#8288;/i&#8288;</span>&rsquo;), &lsquo;<span class="samp">&#8288;(?m)&#8288;</span>&rsquo;
(multiline, equivalent to Perl's &lsquo;<span class="samp">&#8288;/m&#8288;</span>&rsquo;), &lsquo;<span class="samp">&#8288;(?s)&#8288;</span>&rsquo; (single line,
so a dot matches all characters, even new lines: equivalent to Perl's
&lsquo;<span class="samp">&#8288;/s&#8288;</span>&rsquo;) and &lsquo;<span class="samp">&#8288;(?x)&#8288;</span>&rsquo; (extended, whitespace data characters are
ignored unless escaped and comments are allowed: equivalent to Perl's
&lsquo;<span class="samp">&#8288;/x&#8288;</span>&rsquo;).  These can be concatenated, so for example, &lsquo;<span class="samp">&#8288;(?im)&#8288;</span>&rsquo;
sets caseless multiline matching.  It is also possible to unset these
options by preceding the letter with a hyphen, and to combine setting
and unsetting such as &lsquo;<span class="samp">&#8288;(?im-sx)&#8288;</span>&rsquo;.  These settings can be applied
within patterns, and then apply to the remainder of the pattern.
Additional options not in Perl include &lsquo;<span class="samp">&#8288;(?U)&#8288;</span>&rsquo; to set
&lsquo;ungreedy&rsquo; mode (so matching is minimal unless &lsquo;<span class="samp">&#8288;?&#8288;</span>&rsquo; is used
as part of the repetition quantifier, when it is greedy).  Initially
none of these options are set.
</p>
<p>If you want to remove the special meaning from a sequence of
characters, you can do so by putting them between &lsquo;<span class="samp">&#8288;\Q&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;\E&#8288;</span>&rsquo;. This is different from Perl in that &lsquo;<span class="samp">&#8288;$&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;@&#8288;</span>&rsquo; are
handled as literals in &lsquo;<span class="samp">&#8288;\Q...\E&#8288;</span>&rsquo; sequences in PCRE, whereas in
Perl, &lsquo;<span class="samp">&#8288;$&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;@&#8288;</span>&rsquo; cause variable interpolation.
</p>
<p>The escape sequences &lsquo;<span class="samp">&#8288;\d&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\s&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\w&#8288;</span>&rsquo; represent
any decimal digit, space character and &lsquo;word&rsquo; character
(letter, digit or underscore in the current locale: in UTF-8 mode only
ASCII letters and digits are considered) respectively, and their
upper-case versions represent their negation.  Vertical tab was not
regarded as a space character in a <code>C</code> locale before PCRE 8.34.
Sequences &lsquo;<span class="samp">&#8288;\h&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\v&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\H&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\V&#8288;</span>&rsquo; match
horizontal and vertical space or the negation.  (In UTF-8 mode, these
do match non-ASCII Unicode code points.)
</p>
<p>There are additional escape sequences: &lsquo;<span class="samp">&#8288;\cx&#8288;</span>&rsquo; is
&lsquo;<span class="samp">&#8288;cntrl-x&#8288;</span>&rsquo; for any &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\ddd&#8288;</span>&rsquo; is the
octal character (for up to three digits unless
interpretable as a backreference, as &lsquo;<span class="samp">&#8288;\1&#8288;</span>&rsquo; to &lsquo;<span class="samp">&#8288;\7&#8288;</span>&rsquo; always
are), and &lsquo;<span class="samp">&#8288;\xhh&#8288;</span>&rsquo; specifies a character by two hex digits.
In a UTF-8 locale, &lsquo;<span class="samp">&#8288;\x{h...}&#8288;</span>&rsquo; specifies a Unicode code point
by one or more hex digits.  (Note that some of these will be
interpreted by <span class="rlang"><b>R</b></span>'s parser in literal character strings.)
</p>
<p>Outside a character class, &lsquo;<span class="samp">&#8288;\A&#8288;</span>&rsquo; matches at the start of a
subject (even in multiline mode, unlike &lsquo;<span class="samp">&#8288;^&#8288;</span>&rsquo;), &lsquo;<span class="samp">&#8288;\Z&#8288;</span>&rsquo; matches
at the end of a subject or before a newline at the end, &lsquo;<span class="samp">&#8288;\z&#8288;</span>&rsquo;
matches only at end of a subject. and &lsquo;<span class="samp">&#8288;\G&#8288;</span>&rsquo; matches at first
matching position in a subject (which is subtly different from Perl's
end of the previous match).  &lsquo;<span class="samp">&#8288;\C&#8288;</span>&rsquo; matches a single
byte, including a newline, but its use is warned against.  In UTF-8
mode, &lsquo;<span class="samp">&#8288;\R&#8288;</span>&rsquo; matches any Unicode newline character (not just CR),
and &lsquo;<span class="samp">&#8288;\X&#8288;</span>&rsquo; matches any number of Unicode characters that form an
extended Unicode sequence. &lsquo;<span class="samp">&#8288;\X&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\R&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\B&#8288;</span>&rsquo; cannot be
used inside a character class (with PCRE1, they are treated as characters
&lsquo;<span class="samp">&#8288;X&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;R&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;B&#8288;</span>&rsquo;; with PCRE2 they cause an error).
</p>
<p>A hyphen (minus) inside a character class is treated as a range, unless it
is first or last character in the class definition.  It can be quoted to
represent the hyphen literal (&lsquo;<span class="samp">&#8288;\-&#8288;</span>&rsquo;).  PCRE1 allows an unquoted hyphen
at some other locations inside a character class where it cannot represent
a valid range, but PCRE2 reports an error in such cases.
</p>
<p>In UTF-8 mode, some Unicode properties may be supported via
&lsquo;<span class="samp">&#8288;\p{xx}&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\P{xx}&#8288;</span>&rsquo; which match characters with and
without property &lsquo;<span class="samp">&#8288;xx&#8288;</span>&rsquo; respectively.  For a list of supported
properties see the PCRE documentation, but for example &lsquo;<span class="samp">&#8288;Lu&#8288;</span>&rsquo; is
&lsquo;upper case letter&rsquo; and &lsquo;<span class="samp">&#8288;Sc&#8288;</span>&rsquo; is &lsquo;currency symbol&rsquo;. Note
that properties such as &lsquo;<span class="samp">&#8288;\w&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\W&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\d&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\D&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\s&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;\S&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;\b&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\B&#8288;</span>&rsquo; by default do not refer to full
Unicode, but one can override this by starting a pattern with &lsquo;<span class="samp">&#8288;(*UCP)&#8288;</span>&rsquo;
(which comes with a performance penalty).
(This support depends on the PCRE library being compiled with
&lsquo;Unicode property support&rsquo; which can be checked <em>via</em>
<code><a href="#topic+pcre_config">pcre_config</a></code>. PCRE2 when compiled with Unicode support always
supports also Unicode properties.)
</p>
<p>The sequence &lsquo;<span class="samp">&#8288;(?#&#8288;</span>&rsquo; marks the start of a comment which continues
up to the next closing parenthesis.  Nested parentheses are not
permitted.  The characters that make up a comment play no part at all in
the pattern matching.
</p>
<p>If the extended option is set, an unescaped &lsquo;<span class="samp">&#8288;#&#8288;</span>&rsquo; character outside
a character class introduces a comment that continues up to the next
newline character in the pattern.
</p>
<p>The pattern &lsquo;<span class="samp">&#8288;(?:...)&#8288;</span>&rsquo; groups characters just as parentheses do
but does not make a backreference.
</p>
<p>Patterns &lsquo;<span class="samp">&#8288;(?=...)&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;(?!...)&#8288;</span>&rsquo; are zero-width positive and
negative lookahead <em>assertions</em>: they match if an attempt to
match the <code>...</code> forward from the current position would succeed
(or not), but use up no characters in the string being processed.
Patterns &lsquo;<span class="samp">&#8288;(?&lt;=...)&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;(?&lt;!...)&#8288;</span>&rsquo; are the lookbehind
equivalents: they do not allow repetition quantifiers nor &lsquo;<span class="samp">&#8288;\C&#8288;</span>&rsquo;
in <code>...</code>.
</p>
<p><code>regexpr</code> and <code>gregexpr</code> support &lsquo;named capture&rsquo;.  If
groups are named, e.g., <code>"(?&lt;first&gt;[A-Z][a-z]+)"</code> then the
positions of the matches are also returned by name.  (Named
backreferences are not supported by <code>sub</code>.)
</p>
<p>Atomic grouping, possessive qualifiers and conditional
and recursive patterns are not covered here.
</p>


<h3>Author(s)</h3>

<p>This help page is based on the TRE documentation and the POSIX
standard, and the <code>pcre2pattern</code> man page from PCRE2 10.35.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grep">grep</a></code>, <code><a href="utils.html#topic+apropos">apropos</a></code>, <code><a href="utils.html#topic+browseEnv">browseEnv</a></code>,
<code><a href="utils.html#topic+glob2rx">glob2rx</a></code>, <code><a href="utils.html#topic+help.search">help.search</a></code>, <code><a href="#topic+list.files">list.files</a></code>,
<code><a href="#topic+ls">ls</a></code>, <code><a href="#topic+strsplit">strsplit</a></code> and <code><a href="#topic+agrep">agrep</a></code>.
</p>
<p>The <a href="https://htmlpreview.github.io/?https://raw.githubusercontent.com/laurikari/tre/master/doc/tre-syntax.html">TRE regexp syntax</a>.
</p>
<p>The POSIX 1003.2 standard at
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html">https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap09.html</a>.
</p>
<p>The <code>pcre2pattern</code> or <code>pcrepattern</code> <code>man</code> page
(found as part of <a href="https://www.pcre.org/original/pcre.txt">https://www.pcre.org/original/pcre.txt</a>), and
details of Perl's own implementation at
<a href="https://perldoc.perl.org/perlre">https://perldoc.perl.org/perlre</a>.
</p>

<hr>
<h2 id='regmatches'>Extract or Replace Matched Substrings</h2><span id='topic+regmatches'></span><span id='topic+regmatches+3C-'></span>

<h3>Description</h3>

<p>Extract or replace matched substrings from match data obtained by
<code><a href="#topic+regexpr">regexpr</a></code>, <code><a href="#topic+gregexpr">gregexpr</a></code>,
<code><a href="#topic+regexec">regexec</a></code> or <code><a href="#topic+gregexec">gregexec</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmatches(x, m, invert = FALSE)
regmatches(x, m, invert = FALSE) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regmatches_+3A_x">x</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="regmatches_+3A_m">m</code></td>
<td>
<p>an object with match data.</p>
</td></tr>
<tr><td><code id="regmatches_+3A_invert">invert</code></td>
<td>
<p>a logical: if <code>TRUE</code>, extract or replace the
non-matched substrings.</p>
</td></tr>
<tr><td><code id="regmatches_+3A_value">value</code></td>
<td>
<p>an object with suitable replacement values for the
matched or non-matched substrings (see <code>Details</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>invert</code> is <code>FALSE</code> (default), <code>regmatches</code> extracts
the matched substrings as specified by the match data.  For vector
match data (as obtained from <code><a href="#topic+regexpr">regexpr</a></code>), empty matches are
dropped; for list match data, empty matches give empty components
(zero-length character vectors).
</p>
<p>If <code>invert</code> is <code>TRUE</code>, <code>regmatches</code> extracts the
non-matched substrings, i.e., the strings are split according to the
matches similar to <code><a href="#topic+strsplit">strsplit</a></code> (for vector match data, at
most a single split is performed).
</p>
<p>If <code>invert</code> is <code>NA</code>, <code>regmatches</code> extracts both
non-matched and matched substrings, always starting and ending with a
non-match (empty if the match occurred at the beginning or the end,
respectively).
</p>
<p>Note that the match data can be obtained from regular expression
matching on a modified version of <code>x</code> with the same numbers of
characters.
</p>
<p>The replacement function can be used for replacing the matched or
non-matched substrings.  For vector match data, if <code>invert</code> is
<code>FALSE</code>, <code>value</code> should be a character vector with length the
number of matched elements in <code>m</code>.  Otherwise, it should be a
list of character vectors with the same length as <code>m</code>, each as
long as the number of replacements needed.  Replacement coerces values
to character or list and generously recycles values as needed.
Missing replacement values are not allowed.
</p>


<h3>Value</h3>

<p>For <code>regmatches</code>, a character vector with the matched substrings
if <code>m</code> is a vector and <code>invert</code> is <code>FALSE</code>.  Otherwise,
a list with the matched or/and non-matched substrings.
</p>
<p>For <code>regmatches&lt;-</code>, the updated character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("A and B", "A, B and C", "A, B, C and D", "foobar")
pattern &lt;- "[[:space:]]*(,|and)[[:space:]]"
## Match data from regexpr()
m &lt;- regexpr(pattern, x)
regmatches(x, m)
regmatches(x, m, invert = TRUE)
## Match data from gregexpr()
m &lt;- gregexpr(pattern, x)
regmatches(x, m)
regmatches(x, m, invert = TRUE)

## Consider
x &lt;- "John (fishing, hunting), Paul (hiking, biking)"
## Suppose we want to split at the comma (plus spaces) between the
## persons, but not at the commas in the parenthesized hobby lists.
## One idea is to "blank out" the parenthesized parts to match the
## parts to be used for splitting, and extract the persons as the
## non-matched parts.
## First, match the parenthesized hobby lists.
m &lt;- gregexpr("\\([^)]*\\)", x)
## Create blank strings with given numbers of characters.
blanks &lt;- function(n) strrep(" ", n)
## Create a copy of x with the parenthesized parts blanked out.
s &lt;- x
regmatches(s, m) &lt;- Map(blanks, lapply(regmatches(s, m), nchar))
s
## Compute the positions of the split matches (note that we cannot call
## strsplit() on x with match data from s).
m &lt;- gregexpr(", *", s)
## And finally extract the non-matched parts.
regmatches(x, m, invert = TRUE)

## regexec() and gregexec() return overlapping ranges because the
## first match is the full match.  This conflicts with regmatches()&lt;-
## and regmatches(..., invert=TRUE).  We can work-around by dropping
## the first match.
drop_first &lt;- function(x) {
    if(!anyNA(x) &amp;&amp; all(x &gt; 0)) {
        ml &lt;- attr(x, 'match.length')
        if(is.matrix(x)) x &lt;- x[-1,] else x &lt;- x[-1]
        attr(x, 'match.length') &lt;- if(is.matrix(ml)) ml[-1,] else ml[-1]
    }
    x
}
m &lt;- gregexec("(\\w+) \\(((?:\\w+(?:, )?)+)\\)", x)
regmatches(x, m)
try(regmatches(x, m, invert=TRUE))
regmatches(x, lapply(m, drop_first))
## invert=TRUE loses matrix structure because we are retrieving what
## is in between every sub-match
regmatches(x, lapply(m, drop_first), invert=TRUE)
y &lt;- z &lt;- x
## Notice **list**(...) on the RHS
regmatches(y, lapply(m, drop_first)) &lt;- list(c("&lt;NAME&gt;", "&lt;HOBBY-LIST&gt;"))
y
regmatches(z, lapply(m, drop_first), invert=TRUE) &lt;-
    list(sprintf("&lt;%d&gt;", 1:5))
z

## With `perl = TRUE` and `invert = FALSE` capture group names
## are preserved.  Collect functions and arguments in calls:
NEWS &lt;- head(readLines(file.path(R.home(), 'doc', 'NEWS.2')), 100)
m &lt;- gregexec("(?&lt;fun&gt;\\w+)\\((?&lt;args&gt;[^)]*)\\)", NEWS, perl = TRUE)
y &lt;- regmatches(NEWS, m)
y[[16]]
## Make tabular, adding original line numbers
mdat &lt;- as.data.frame(t(do.call(cbind, y)))
mdat &lt;- cbind(mdat, line=rep(seq_along(y), lengths(y) / ncol(mdat)))
head(mdat)
NEWS[head(mdat[['line']])]
</code></pre>

<hr>
<h2 id='remove'>Remove Objects from a Specified Environment</h2><span id='topic+rm'></span><span id='topic+remove'></span>

<h3>Description</h3>

<p><code>remove</code> and <code>rm</code> are identical <span class="rlang"><b>R</b></span> functions that
can be used to remove objects.  These can
be specified successively as character strings, or in the character
vector <code>list</code>, or through a combination of both.  All objects
thus specified will be removed.
</p>
<p>If <code>envir</code> is NULL then the currently active environment is
searched first.
</p>
<p>If <code>inherits</code> is <code>TRUE</code> then parents of the supplied
directory are searched until a variable with the given name is
encountered.  A warning is printed for each variable that is not
found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove(..., list = character(), pos = -1,
       envir = as.environment(pos), inherits = FALSE)

rm    (..., list = character(), pos = -1,
       envir = as.environment(pos), inherits = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_+3A_...">...</code></td>
<td>
<p>the objects to be removed, as names (unquoted) or
character strings (quoted).</p>
</td></tr>
<tr><td><code id="remove_+3A_list">list</code></td>
<td>
<p>a character vector (or <code><a href="#topic+NULL">NULL</a></code>) naming objects to be removed.</p>
</td></tr>
<tr><td><code id="remove_+3A_pos">pos</code></td>
<td>
<p>where to do the removal.  By default, uses the
current environment.  See &lsquo;details&rsquo; for other possibilities.</p>
</td></tr>
<tr><td><code id="remove_+3A_envir">envir</code></td>
<td>
<p>the <code><a href="#topic+environment">environment</a></code> to use.  See &lsquo;details&rsquo;.</p>
</td></tr>
<tr><td><code id="remove_+3A_inherits">inherits</code></td>
<td>
<p>should the enclosing frames of the environment be
inspected?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pos</code> argument can specify the  environment from which to remove
the objects in any of several ways:
as an integer (the position in the <code><a href="#topic+search">search</a></code> list); as
the character string name of an element in the search list; or as an
<code><a href="#topic+environment">environment</a></code> (including using <code><a href="#topic+sys.frame">sys.frame</a></code> to
access the currently active function calls).
The <code>envir</code> argument is an alternative way to specify an
environment, but is primarily there for back compatibility.
</p>
<p>It is not allowed to remove variables from the base environment and
base namespace, nor from any environment which is locked (see
<code><a href="#topic+lockEnvironment">lockEnvironment</a></code>).
</p>
<p>Earlier versions of <span class="rlang"><b>R</b></span> incorrectly claimed that supplying a character
vector in <code>...</code> removed the objects named in the character
vector, but it removed the character vector.  Use the <code>list</code>
argument to specify objects <em>via</em> a character vector.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ls">ls</a></code>, <code><a href="#topic+objects">objects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp &lt;- 1:4
## work with tmp  and cleanup
rm(tmp)

## Not run: 
## remove (almost) everything in the working environment.
## You will get no warning, so don't do this unless you are really sure.
rm(list = ls())

## End(Not run)</code></pre>

<hr>
<h2 id='rep'>Replicate Elements of Vectors and Lists</h2><span id='topic+rep'></span><span id='topic+rep.factor'></span><span id='topic+rep.int'></span><span id='topic+rep.POSIXct'></span><span id='topic+rep.POSIXlt'></span><span id='topic+rep.Date'></span><span id='topic+rep_len'></span>

<h3>Description</h3>

<p><code>rep</code> replicates the values in <code>x</code>.  It is a generic
function, and the (internal) default method is described here.
</p>
<p><code>rep.int</code> and <code>rep_len</code> are faster simplified versions for
two common cases.  Internally, they are generic, so methods can be
defined for them (see <a href="#topic+InternalMethods">InternalMethods</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep(x, ...)

rep.int(x, times)

rep_len(x, length.out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rep_+3A_x">x</code></td>
<td>
<p>a vector (of any mode including a <code><a href="#topic+list">list</a></code>) or a factor or (for
<code>rep</code> only) a <code>POSIXct</code> or <code>POSIXlt</code> or <code>Date</code>
object; or an S4 object containing such an object.</p>
</td></tr>
<tr><td><code id="rep_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods.
For the internal default method these can include:
</p>

<dl>
<dt><code>times</code></dt><dd><p>an integer-valued vector giving the
(non-negative) number of times to repeat each element if of
length <code>length(x)</code>, or to repeat the whole vector if of
length 1.  Negative or <code>NA</code> values are an error.  A
<code>double</code> vector is accepted, other inputs being coerced to
an integer or double vector.</p>
</dd>
<dt><code>length.out</code></dt><dd><p>non-negative integer.  The desired length of the
output vector.  Other inputs will be coerced to a double
vector and the first element taken.  Ignored if <code>NA</code> or invalid.</p>
</dd>
<dt><code>each</code></dt><dd><p>non-negative integer.  Each element of <code>x</code>
is repeated <code>each</code> times.  Other inputs will be coerced to
an integer or double vector and the first element taken.  Treated as
<code>1</code> if <code>NA</code> or invalid.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="rep_+3A_times">times</code>, <code id="rep_+3A_length.out">length.out</code></td>
<td>
<p>see <code>...</code> above.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default behaviour is as if the call was
</p>
<pre>  rep(x, times = 1, length.out = NA, each = 1)
</pre><p>.  Normally just one of the additional
arguments is specified, but if <code>each</code> is specified with either
of the other two, its replication is performed first, and then that
implied by <code>times</code> or <code>length.out</code>.
</p>
<p>If <code>times</code> consists of a single integer, the result consists of
the whole input repeated this many times.  If <code>times</code> is a
vector of the same length as <code>x</code> (after replication by
<code>each</code>), the result consists of <code>x[1]</code> repeated
<code>times[1]</code> times, <code>x[2]</code> repeated <code>times[2]</code> times and
so on.
</p>
<p><code>length.out</code> may be given in place of <code>times</code>,
in which case <code>x</code> is repeated as many times as is
necessary to create a vector of this length.  If both are given,
<code>length.out</code> takes priority and <code>times</code> is ignored.
</p>
<p>Non-integer values of <code>times</code> will be truncated towards zero.
If <code>times</code> is a computed quantity it is prudent to add a small
fuzz or use <code><a href="#topic+round">round</a></code>.  And analogously for <code>each</code>.
</p>
<p>If <code>x</code> has length zero and <code>length.out</code> is supplied and is
positive, the values are filled in using the extraction rules, that is
by an <code>NA</code> of the appropriate class for an atomic vector
(<code>0</code> for raw vectors) and <code>NULL</code> for a list.
</p>


<h3>Value</h3>

<p>An object of the same type as <code>x</code>.
</p>
<p><code>rep.int</code> and <code>rep_len</code> return no attributes (except the
class if returning a factor).
</p>
<p>The default method of <code>rep</code> gives the result names (which will
almost always contain duplicates) if <code>x</code> had names, but retains
no other attributes.
</p>


<h3>Note</h3>

<p>Function <code>rep.int</code> is a simple case which was provided as a
separate function partly for S compatibility and partly for speed
(especially when names can be dropped).  The performance of <code>rep</code>
has been improved since, but <code>rep.int</code> is still at least twice as
fast when <code>x</code> has names.
</p>
<p>The name <code>rep.int</code> long precedes making <code>rep</code> generic.
</p>
<p>Function <code>rep</code> is a primitive, but (partial) matching of argument
names is performed as for normal functions.
</p>
<p>For historical reasons <code>rep</code> (only) works on <code>NULL</code>: the
result is always <code>NULL</code> even when <code>length.out</code> is positive.
</p>
<p>Although it has never been documented, these functions have always
worked on <a href="#topic+expression">expression</a> vectors.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seq">seq</a></code>, <code><a href="#topic+sequence">sequence</a></code>, <code><a href="#topic+replicate">replicate</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rep(1:4, 2)
rep(1:4, each = 2)       # not the same.
rep(1:4, c(2,2,2,2))     # same as second.
rep(1:4, c(2,1,2,1))
rep(1:4, each = 2, length.out = 4)    # first 4 only.
rep(1:4, each = 2, length.out = 10)   # 8 integers plus two recycled 1's.
rep(1:4, each = 2, times = 3)         # length 24, 3 complete replications

rep(1, 40*(1-.8)) # length 7 on most platforms
rep(1, 40*(1-.8)+1e-7) # better

## replicate a list
fred &lt;- list(happy = 1:10, name = "squash")
rep(fred, 5)

# date-time objects
x &lt;- .leap.seconds[1:3]
rep(x, 2)
rep(as.POSIXlt(x), rep(2, 3))

## named factor
x &lt;- factor(LETTERS[1:4]); names(x) &lt;- letters[1:4]
x
rep(x, 2)
rep(x, each = 2)
rep.int(x, 2)  # no names
rep_len(x, 10)
</code></pre>

<hr>
<h2 id='replace'>Replace Values in a Vector</h2><span id='topic+replace'></span>

<h3>Description</h3>

<p><code>replace</code> replaces the values in <code>x</code>
with indices given in <code>list</code> by those given in <code>values</code>.
If necessary, the values in <code>values</code> are recycled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace(x, list, values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_+3A_x">x</code></td>
<td>
<p>a vector.</p>
</td></tr>
<tr><td><code id="replace_+3A_list">list</code></td>
<td>
<p>an index vector.</p>
</td></tr>
<tr><td><code id="replace_+3A_values">values</code></td>
<td>
<p>replacement values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the values replaced.
</p>


<h3>Note</h3>

<p><code>x</code> is unchanged: remember to assign the result.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>

<hr>
<h2 id='Reserved'>Reserved Words in R</h2><span id='topic+Reserved'></span><span id='topic+reserved'></span>

<h3>Description</h3>

<p>The reserved words in <span class="rlang"><b>R</b></span>'s parser are
</p>
<p><code><a href="#topic+if">if</a></code> <code><a href="#topic+else">else</a></code> <code><a href="#topic+repeat">repeat</a></code> <code><a href="#topic+while">while</a></code>
<code><a href="#topic+function">function</a></code> <code><a href="#topic+for">for</a></code> <code>in</code>
<code><a href="#topic+next">next</a></code> <code><a href="#topic+break">break</a></code>
</p>
<p><code><a href="#topic+TRUE">TRUE</a></code> <code><a href="#topic+FALSE">FALSE</a></code> <code><a href="#topic+NULL">NULL</a></code>
<code><a href="#topic+Inf">Inf</a></code> <code><a href="#topic+NaN">NaN</a></code>
<code><a href="#topic+NA">NA</a></code> <code><a href="#topic+NA_integer_">NA_integer_</a></code> <code><a href="#topic+NA_real_">NA_real_</a></code>
<code><a href="#topic+NA_complex_">NA_complex_</a></code> <code><a href="#topic+NA_character_">NA_character_</a></code>
</p>
<p><code>...</code> and <code>..1</code>, <code>..2</code> etc, which are used to refer to
arguments passed down from a calling function, see <code><a href="#topic+...">...</a></code>.
</p>


<h3>Details</h3>

<p>Reserved words outside <a href="#topic+Quotes">quotes</a> are always parsed to be
references to the objects linked to in the &lsquo;Description&rsquo;, and
hence they are not allowed as syntactic names (see
<code><a href="#topic+make.names">make.names</a></code>).  They <b>are</b> allowed as non-syntactic
names, e.g. inside <a href="#topic+backtick">backtick</a> quotes.
</p>

<hr>
<h2 id='rev'>Reverse Elements</h2><span id='topic+rev'></span><span id='topic+rev.default'></span>

<h3>Description</h3>

<p><code>rev</code> provides a reversed version of its argument.  It is generic
function with a default method for vectors and one for
<code><a href="stats.html#topic+dendrogram">dendrogram</a></code>s.
</p>
<p>Note that this is no longer needed (nor efficient) for obtaining
vectors sorted into descending order, since that is now rather more
directly achievable by <code><a href="#topic+sort">sort</a>(x, decreasing = TRUE)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rev(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rev_+3A_x">x</code></td>
<td>
<p>a vector or another object for which reversal is defined.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seq">seq</a></code>, <code><a href="#topic+sort">sort</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:5, 5:3)
## sort into descending order; first more efficiently:
stopifnot(sort(x, decreasing = TRUE) == rev(sort(x)))
stopifnot(rev(1:7) == 7:1)  #- don't need 'rev' here
</code></pre>

<hr>
<h2 id='Rhome'>Return the R Home Directory</h2><span id='topic+R.home'></span><span id='topic+R_HOME'></span>

<h3>Description</h3>

<p>Return the <span class="rlang"><b>R</b></span> home directory, or the full path to a component of the
<span class="rlang"><b>R</b></span> installation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.home(component = "home")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rhome_+3A_component">component</code></td>
<td>
<p><code>"home"</code> gives the <span class="rlang"><b>R</b></span> home
directory, other known values are <code>"bin"</code>, <code>"doc"</code>,
<code>"etc"</code>, <code>"include"</code>, <code>"modules"</code> and <code>"share"</code>
giving the paths to the corresponding parts of an <span class="rlang"><b>R</b></span> installation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <span class="rlang"><b>R</b></span> home directory is the top-level directory of the <span class="rlang"><b>R</b></span>
installation being run.
</p>
<p>The <span class="rlang"><b>R</b></span> home directory is often referred to as <var>R_HOME</var>,
and is the value of an environment variable of that name in an <span class="rlang"><b>R</b></span>
session.
It can be found outside an <span class="rlang"><b>R</b></span> session by <code>R <a href="utils.html#topic+RHOME">RHOME</a></code>.
</p>
<p>The paths to components often are subdirectories of <var>R_HOME</var> but
need not be:  <code>"doc"</code>, <code>"include"</code> and <code>"share"</code> are
not for some Linux binary installations of <span class="rlang"><b>R</b></span>.
</p>


<h3>Value</h3>

<p>A character string giving the <span class="rlang"><b>R</b></span> home directory or path to a
particular component.  Normally the components are all subdirectories
of the <span class="rlang"><b>R</b></span> home directory, but this need not be the case in a Unix-like
installation.
</p>
<p>The value for <code>"modules"</code> and on Windows <code>"bin"</code> is a
sub-architecture-specific location.  (This is not so for
<code>"etc"</code>, which may have sub-architecture-specific files as well
as common ones.)
</p>
<p>On a Unix-alike, the constructed paths are based on the current
values of the environment variables <span class="env">R_HOME</span> and where set
<span class="env">R_SHARE_DIR</span>, <span class="env">R_DOC_DIR</span> and <span class="env">R_INCLUDE_DIR</span> (these are
set on startup and should not be altered).
</p>
<p>On Windows the values of <code>R.home()</code> and <span class="env">R_HOME</span> are
switched to the 8.3 short form of path elements if required and if
the Windows service to do that is enabled.  The value of
<span class="env">R_HOME</span> is set to use forward slashes (since many package
maintainers pass it unquoted to shells, for example in
&lsquo;<span class="file">Makefile</span>&rsquo;s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+commandArgs">commandArgs</a>()[1]</code> may provide related information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These result quite platform-dependently :
rbind(home = R.home(),
      bin  = R.home("bin")) # often the 'bin' sub directory of 'home'
                            # but not always ...
list.files(R.home("bin"))
</code></pre>

<hr>
<h2 id='rle'>Run Length Encoding</h2><span id='topic+rle'></span><span id='topic+inverse.rle'></span><span id='topic+print.rle'></span>

<h3>Description</h3>

<p>Compute the lengths and values of runs of equal values in a vector
&ndash; or the reverse operation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rle(x)
inverse.rle(x, ...)

## S3 method for class 'rle'
print(x, digits = getOption("digits"), prefix = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rle_+3A_x">x</code></td>
<td>
<p>a vector (atomic, not a list) for <code>rle()</code>;
an object of class <code>"rle"</code> for <code>inverse.rle()</code>.</p>
</td></tr>
<tr><td><code id="rle_+3A_...">...</code></td>
<td>
<p>further arguments; ignored here.</p>
</td></tr>
<tr><td><code id="rle_+3A_digits">digits</code></td>
<td>
<p>number of significant digits for printing, see
<code><a href="#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="rle_+3A_prefix">prefix</code></td>
<td>
<p>character string, prepended to each printed line.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;vector&rsquo; is used in the sense of <code><a href="#topic+is.vector">is.vector</a></code>.
</p>
<p>Missing values are regarded as unequal to the previous value, even if
that is also missing.
</p>
<p><code>inverse.rle()</code> is the inverse function of <code>rle()</code>,
reconstructing <code>x</code> from the runs.
</p>


<h3>Value</h3>

<p><code>rle()</code> returns an object of class <code>"rle"</code> which is a list
with components:
</p>
<table>
<tr><td><code>lengths</code></td>
<td>
<p>an integer vector containing the length of each run.</p>
</td></tr>
<tr><td><code>values</code></td>
<td>
<p>a vector of the same length as <code>lengths</code> with the
corresponding values.</p>
</td></tr>
</table>
<p><code>inverse.rle()</code> returns an atomic vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rev(rep(6:10, 1:5))
rle(x)
## lengths [1:5]  5 4 3 2 1
## values  [1:5] 10 9 8 7 6

z &lt;- c(TRUE, TRUE, FALSE, FALSE, TRUE, FALSE, TRUE, TRUE, TRUE)
rle(z)
rle(as.character(z))
print(rle(z), prefix = "..| ")

N &lt;- integer(0)
stopifnot(x == inverse.rle(rle(x)),
          identical(N, inverse.rle(rle(N))),
          z == inverse.rle(rle(z)))
</code></pre>

<hr>
<h2 id='Round'>Rounding of Numbers</h2><span id='topic+ceiling'></span><span id='topic+floor'></span><span id='topic+round'></span><span id='topic+signif'></span><span id='topic+trunc'></span>

<h3>Description</h3>

<p><code>ceiling</code> takes a single numeric argument <code>x</code> and returns a
numeric vector containing the smallest integers not less than the
corresponding elements of <code>x</code>.
</p>
<p><code>floor</code> takes a single numeric argument <code>x</code> and returns a
numeric vector containing the largest integers not greater than the
corresponding elements of <code>x</code>.
</p>
<p><code>trunc</code> takes a single numeric argument <code>x</code> and returns a
numeric vector containing the integers formed by truncating the values in
<code>x</code> toward <code>0</code>.
</p>
<p><code>round</code> rounds the values in its first argument to the specified
number of decimal places (default 0).  See &lsquo;Details&rsquo; about
&ldquo;round to even&rdquo; when rounding off a 5.
</p>
<p><code>signif</code> rounds the values in its first argument to the specified
number of <em>significant</em> digits.   Hence, for <code>numeric</code> <code>x</code>,
<code>signif(x, dig)</code> is the same as <code>round(x, dig - ceiling(log10(abs(x))))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceiling(x)
floor(x)
trunc(x, ...)

round(x, digits = 0, ...)
signif(x, digits = 6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Round_+3A_x">x</code></td>
<td>
<p>a numeric vector.  Or, for <code>round</code> and <code>signif</code>, a
complex vector.</p>
</td></tr>
<tr><td><code id="Round_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places
(<code>round</code>) or significant digits (<code>signif</code>) to be used.
For <code>round</code>, negative values are allowed (see &lsquo;Details&rsquo;).</p>
</td></tr>
<tr><td><code id="Round_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are generic functions: methods can be defined for them
individually or via the <code><a href="#topic+S3groupGeneric">Math</a></code> group
generic.
</p>
<p>Note that for rounding off a 5, the <abbr>IEC</abbr> 60559 standard (see also
&lsquo;IEEE 754&rsquo;) is expected to be used, &lsquo;<em>go to the even digit</em>&rsquo;.
Therefore <code>round(0.5)</code> is <code>0</code> and <code>round(-1.5)</code> is
<code>-2</code>.  However, this is dependent on OS services and on
representation error (since e.g. <code>0.15</code> is not represented
exactly, the rounding rule applies to the represented number and not
to the printed number, and so <code>round(0.15, 1)</code> could be either
<code>0.1</code> or <code>0.2</code>).
</p>
<p>Rounding to a negative number of digits means rounding to a power of
ten, so for example <code>round(x, digits = -2)</code> rounds to the nearest
hundred.
</p>
<p>For <code>signif</code> the recognized values of <code>digits</code> are
<code>1...22</code>, and non-missing values are rounded to the nearest
integer in that range. Each element of the vector is rounded individually, 
unlike printing.
</p>
<p>These are all primitive functions.
</p>


<h3>S4 methods</h3>

<p>These are all (internally) S4 generic.
</p>
<p><code>ceiling</code>, <code>floor</code> and <code>trunc</code> are members of the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.  As an S4
generic, <code>trunc</code> has only one argument.
</p>
<p><code>round</code> and <code>signif</code> are members of the
<code><a href="methods.html#topic+S4groupGeneric">Math2</a></code> group generic.
</p>


<h3>Warning</h3>

<p>The realities of computer arithmetic can cause unexpected results,
especially with <code>floor</code> and <code>ceiling</code>.  For example, we
&lsquo;know&rsquo; that <code>floor(log(x, base = 8))</code> for <code>x = 8</code> is
<code>1</code>, but <code>0</code> has been seen on an <span class="rlang"><b>R</b></span> platform.  It is
normally necessary to use a tolerance.
</p>
<p>Rounding to decimal digits in binary arithmetic is non-trivial (when
<code>digits != 0</code>) and may be surprising.  Be aware that most decimal
fractions are <em>not</em> exactly representable in binary double precision.
In <span class="rlang"><b>R</b></span> 4.0.0, the algorithm for <code>round(x, d)</code>, for <code class="reqn">d &gt; 0</code>, has
been improved to <em>measure</em> and round &ldquo;to nearest even&rdquo;,
contrary to earlier versions of <span class="rlang"><b>R</b></span> (or also to <code><a href="#topic+sprintf">sprintf</a>()</code>
or <code><a href="#topic+format">format</a>()</code> based rounding).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.  Wadsworth &amp; Brooks/Cole.
</p>
<p>The ISO/<abbr>IEC</abbr>/IEEE 60559:2011 standard is available for money from
<a href="https://www.iso.org">https://www.iso.org</a>.
</p>
<p>The IEEE 754:2008 standard is more openly documented, e.g, at
<a href="https://en.wikipedia.org/wiki/IEEE_754">https://en.wikipedia.org/wiki/IEEE_754</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.integer">as.integer</a></code>.
Package <a href="https://CRAN.R-project.org/package=round"><span class="pkg">round</span></a>'s <code><a href="round.html#topic+roundX">roundX</a>()</code> for several
versions or implementations of rounding, including some previous and the
current <span class="rlang"><b>R</b></span> version (as <code>version = "3d.C"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>round(.5 + -2:4) # IEEE / IEC rounding: -2  0  0  2  2  4  4
## (this is *good* behaviour -- do *NOT* report it as bug !)

( x1 &lt;- seq(-2, 4, by = .5) )
round(x1) #-- IEEE / IEC rounding !
x1[trunc(x1) != floor(x1)]
x1[round(x1) != floor(x1 + .5)]
(non.int &lt;- ceiling(x1) != floor(x1))

x2 &lt;- pi * 100^(-1:3)
round(x2, 3)
signif(x2, 3)
</code></pre>

<hr>
<h2 id='round.POSIXt'>Round / Truncate Date-Time Objects</h2><span id='topic+round.POSIXt'></span><span id='topic+trunc.POSIXt'></span><span id='topic+round.Date'></span><span id='topic+trunc.Date'></span>

<h3>Description</h3>

<p>Round or truncate date-time objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXt'
round(x,
      units = c("secs", "mins", "hours", "days", "months", "years"))
## S3 method for class 'POSIXt'
trunc(x,
      units = c("secs", "mins", "hours", "days", "months", "years"),
      ...)

## S3 method for class 'Date'
round(x, ...)
## S3 method for class 'Date'
trunc(x,
      units = c("secs", "mins", "hours", "days", "months", "years"),
      ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round.POSIXt_+3A_x">x</code></td>
<td>
<p>an object inheriting from <code>"<a href="#topic+POSIXt">POSIXt</a>"</code> or <code>"<a href="#topic+Date">Date</a>"</code>.</p>
</td></tr>
<tr><td><code id="round.POSIXt_+3A_units">units</code></td>
<td>
<p>one of the units listed, a string.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="round.POSIXt_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from other methods, notably
<code>digits</code> for <code>round</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time is rounded or truncated to the second, minute, hour, day,
month or year.  Time zones are only relevant to days or more, when
midnight in the current <a href="#topic+time+20zone">time zone</a> is used.
</p>
<p>For <code>units</code> arguments besides &ldquo;months&rdquo; and &ldquo;years&rdquo;,
the methods for class <code>"Date"</code> are of little use except to remove
fractional days.
</p>


<h3>Value</h3>

<p>An object of class <code>"POSIXlt"</code> or <code>"Date"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+round">round</a></code> for the generic function and default methods.
</p>
<p><code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code>, <code><a href="#topic+Date">Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>round(.leap.seconds + 1000, "hour")

         trunc(Sys.time(), "day")
(timM &lt;- trunc(Sys.time() -&gt; St, "months")) # shows timezone
(datM &lt;- trunc(Sys.Date() -&gt; Sd, "months"))
(timY &lt;- trunc(St, "years")) # + timezone
(datY &lt;- trunc(Sd, "years"))

stopifnot(inherits(datM, "Date"), inherits(timM, "POSIXt"),
          substring(format(datM), 9,10) == "01", # first of month
          substring(format(datY), 6,10) == "01-01", # Jan 1
          identical(format(datM), format(timM)),
          identical(format(datY), format(timY)))
</code></pre>

<hr>
<h2 id='row'>Row Indexes</h2><span id='topic+row'></span><span id='topic+.row'></span>

<h3>Description</h3>

<p>Returns a matrix of integers indicating their row number in a
matrix-like object, or a factor indicating the row labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>row(x, as.factor = FALSE)
.row(dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="row_+3A_x">x</code></td>
<td>
<p>a matrix-like object, that is one with a two-dimensional
<code>dim</code>.</p>
</td></tr>
<tr><td><code id="row_+3A_dim">dim</code></td>
<td>
<p>a matrix dimension, i.e., an integer valued numeric vector of
length two (with non-negative entries).</p>
</td></tr>
<tr><td><code id="row_+3A_as.factor">as.factor</code></td>
<td>
<p>a logical value indicating whether the value should
be returned as a factor of row labels (created if necessary)
rather than as numbers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer (or factor) matrix with the same dimensions as <code>x</code> and whose
<code>ij</code>-th element is equal to <code>i</code> (or the <code>i</code>-th row label).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+col">col</a></code> to get columns;
<code><a href="#topic+slice.index">slice.index</a></code> for a general way to get slice indices
in an array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:12, 3, 4)
# extract the diagonal of a matrix - more slowly than diag(x)
dx &lt;- x[row(x) == col(x)]
dx

# create an identity 5-by-5 matrix more slowly than diag(n = 5):
x &lt;- matrix(0, nrow = 5, ncol = 5)
x[row(x) == col(x)] &lt;- 1
x

(i34 &lt;- .row(3:4))
stopifnot(identical(i34, .row(c(3,4)))) # 'dim' maybe "double"
</code></pre>

<hr>
<h2 id='row.names'>Get and Set Row Names for Data Frames</h2><span id='topic+row.names'></span><span id='topic+row.names.data.frame'></span><span id='topic+row.names.default'></span><span id='topic+row.names+3C-'></span><span id='topic+row.names+3C-.data.frame'></span><span id='topic+row.names+3C-.default'></span><span id='topic+.rowNamesDF+3C-'></span>

<h3>Description</h3>

<p>All data frames have row names, a character vector of
length the number of rows with no duplicates nor missing values.
</p>
<p>There are generic functions for getting and setting row names,
with default methods for arrays.
The description here is for the <code>data.frame</code> method.
</p>
<p><code>`.rowNamesDF&lt;-`</code> is a (non-generic replacement) function to set
row names for data frames, with extra argument <code>make.names</code>.
This function only exists as workaround as we cannot easily change the
<code>row.names&lt;-</code> generic without breaking legacy code in existing packages.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>row.names(x)
row.names(x) &lt;- value
.rowNamesDF(x, make.names=FALSE) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="row.names_+3A_x">x</code></td>
<td>
<p>object of class <code>"data.frame"</code>, or any other class for
which a method has been defined.</p>
</td></tr>
<tr><td><code id="row.names_+3A_make.names">make.names</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code>, i.e., one of <code>FALSE, NA, TRUE</code>,
indicating what should happen if the specified row names, i.e.,
<code>value</code>, are invalid, e.g., duplicated or <code>NA</code>.  The default
(is back compatible), <code>FALSE</code>, will signal an error, where
<code>NA</code> will &ldquo;automatic&rdquo; row names and <code>TRUE</code> will call
<code><a href="#topic+make.names">make.names</a>(value, unique=TRUE)</code> for constructing valid
names.</p>
</td></tr>
<tr><td><code id="row.names_+3A_value">value</code></td>
<td>
<p>an object to be coerced to character unless an integer
vector.  It should have (after coercion) the same length as the
number of rows of <code>x</code> with no duplicated nor missing values.
<code>NULL</code> is also allowed: see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A data frame has (by definition) a vector of <em>row names</em> which
has length the number of rows in the data frame, and contains neither
missing nor duplicated values.  Where a row names sequence has been
added by the software to meet this requirement, they are regarded as
&lsquo;automatic&rsquo;.
</p>
<p>Row names are currently allowed to be integer or character, but
for backwards compatibility (with <span class="rlang"><b>R</b></span> &lt;= 2.4.0) <code>row.names</code> will
always return a character vector.  (Use <code>attr(x, "row.names")</code> if
you need to retrieve an integer-valued set of row names.)
</p>
<p>Using <code>NULL</code> for the value resets the row names to
<code>seq_len(nrow(x))</code>, regarded as &lsquo;automatic&rsquo;.
</p>


<h3>Value</h3>

<p><code>row.names</code> returns a character vector.
</p>
<p><code>row.names&lt;-</code> returns a data frame with the row names changed.
</p>


<h3>Note</h3>

<p><code>row.names</code> is similar to <code><a href="#topic+rownames">rownames</a></code> for arrays, and
it has a method that calls <code>rownames</code> for an array argument.
</p>
<p>Row names of the form <code>1:n</code> for <code>n &gt; 2</code> are stored
internally in a compact form, which might be seen from C code or by
deparsing but never via <code>row.names</code> or
<code><a href="#topic+attr">attr</a>(x, "row.names")</code>.  Additionally, some names of this
sort are marked as &lsquo;automatic&rsquo; and handled differently by
<code><a href="#topic+as.matrix">as.matrix</a></code> and <code><a href="#topic+data.matrix">data.matrix</a></code> (and potentially
other functions).  (All zero-row data frames are regarded as having
automatic row names.)
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.frame">data.frame</a></code>, <code><a href="#topic+rownames">rownames</a></code>, <code><a href="#topic+names">names</a></code>.
</p>
<p><code>.row_names_info</code> for the internal representations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## To illustrate the note:
df &lt;- data.frame(x = c(TRUE, FALSE, NA, NA), y = c(12, 34, 56, 78))
row.names(df) &lt;- 1 : 4
attr(df, "row.names") #&gt; 1:4
deparse(df) # or dput(df)
##--&gt; c(NA, 4L) : Compact storage, *not* regarded as automatic.

row.names(df) &lt;- NULL
attr(df, "row.names") #&gt; 1:4
deparse(df) # or dput(df) -- shows
##--&gt; c(NA, -4L) : Compact storage, regarded as automatic.
</code></pre>

<hr>
<h2 id='row+2Bcolnames'>Row and Column Names</h2><span id='topic+rownames'></span><span id='topic+rownames+3C-'></span><span id='topic+colnames'></span><span id='topic+colnames+3C-'></span>

<h3>Description</h3>

<p>Retrieve or set the row or column names of a matrix-like object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rownames(x, do.NULL = TRUE, prefix = "row")
rownames(x) &lt;- value

colnames(x, do.NULL = TRUE, prefix = "col")
colnames(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="row+2B2Bcolnames_+3A_x">x</code></td>
<td>
<p>a matrix-like <span class="rlang"><b>R</b></span> object, with at least two dimensions for
<code>colnames</code>.</p>
</td></tr>
<tr><td><code id="row+2B2Bcolnames_+3A_do.null">do.NULL</code></td>
<td>
<p>logical. If <code>FALSE</code> and names are <code>NULL</code>, names are created.</p>
</td></tr>
<tr><td><code id="row+2B2Bcolnames_+3A_prefix">prefix</code></td>
<td>
<p>for created names.</p>
</td></tr>
<tr><td><code id="row+2B2Bcolnames_+3A_value">value</code></td>
<td>
<p>a valid value for that component of
<code><a href="#topic+dimnames">dimnames</a>(x)</code>.  For a matrix or array this is either
<code>NULL</code> or a character vector of non-zero length equal to the
appropriate dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The extractor functions try to do something sensible for any
matrix-like object <code>x</code>.  If the object has <code><a href="#topic+dimnames">dimnames</a></code>
the first component is used as the row names, and the second component
(if any) is used for the column names.  For a data frame, <code>rownames</code>
and <code>colnames</code> eventually call <code><a href="#topic+row.names">row.names</a></code> and
<code><a href="#topic+names">names</a></code> respectively, but the latter are preferred.
</p>
<p>If <code>do.NULL</code> is <code>FALSE</code>, a character vector (of length
<code><a href="#topic+NROW">NROW</a>(x)</code> or <code><a href="#topic+NCOL">NCOL</a>(x)</code>) is returned in any
case, prepending <code>prefix</code> to simple numbers, if there are no
dimnames or the corresponding component of the dimnames is <code>NULL</code>.
</p>
<p>The replacement methods for arrays/matrices coerce vector and factor
values of <code>value</code> to character, but do not dispatch methods for
<code>as.character</code>.
</p>
<p>For a data frame, <code>value</code> for <code>rownames</code> should be a
character vector of non-duplicated and non-missing names (this is
enforced), and for <code>colnames</code> a character vector of (preferably)
unique syntactically-valid names.  In both cases, <code>value</code> will be
coerced by <code><a href="#topic+as.character">as.character</a></code>, and setting <code>colnames</code>
will convert the row names to character.
</p>


<h3>Note</h3>

<p>If the replacement versions are called on a matrix without any
existing dimnames, they will add suitable dimnames.  But
constructions such as
</p>
<pre>    rownames(x)[3] &lt;- "c"</pre>
<p>may not work unless <code>x</code> already has dimnames, since this will
create a length-3 <code>value</code> from the <code>NULL</code> value of
<code>rownames(x)</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dimnames">dimnames</a></code>,
<code><a href="stats.html#topic+case.names">case.names</a></code>,
<code><a href="stats.html#topic+variable.names">variable.names</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m0 &lt;- matrix(NA, 4, 0)
rownames(m0)

m2 &lt;- cbind(1, 1:4)
colnames(m2, do.NULL = FALSE)
colnames(m2) &lt;- c("x","Y")
rownames(m2) &lt;- rownames(m2, do.NULL = FALSE, prefix = "Obs.")
m2
</code></pre>

<hr>
<h2 id='rowsum'>Give Column Sums of a Matrix or Data Frame, Based on a Grouping Variable</h2><span id='topic+rowsum'></span><span id='topic+rowsum.default'></span><span id='topic+rowsum.data.frame'></span>

<h3>Description</h3>

<p>Compute column sums across rows of a numeric matrix-like object for
each level of a grouping variable.  <code>rowsum</code> is generic, with a
method for data frames and a default method for vectors and matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rowsum(x, group, reorder = TRUE, ...)

## S3 method for class 'data.frame'
rowsum(x, group, reorder = TRUE, na.rm = FALSE, ...)

## Default S3 method:
rowsum(x, group, reorder = TRUE, na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rowsum_+3A_x">x</code></td>
<td>
<p>a matrix, data frame or vector of numeric data.  Missing
values are allowed.  A numeric vector will be treated as a column vector.</p>
</td></tr>
<tr><td><code id="rowsum_+3A_group">group</code></td>
<td>
<p>a vector or factor giving the grouping, with one element
per row of <code>x</code>.  Missing values will be treated as another
group and a warning will be given.</p>
</td></tr>
<tr><td><code id="rowsum_+3A_reorder">reorder</code></td>
<td>
<p>if <code>TRUE</code>, then the result will be in order of
<code>sort(unique(group))</code>, if <code>FALSE</code>, it will be in the order
that groups were encountered.</p>
</td></tr>
<tr><td><code id="rowsum_+3A_na.rm">na.rm</code></td>
<td>
<p>logical (<code>TRUE</code> or <code>FALSE</code>).  Should <code>NA</code>
(including <code>NaN</code>) values be discarded?</p>
</td></tr>
<tr><td><code id="rowsum_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default is to reorder the rows to agree with <code>tapply</code> as in
the example below.  Reordering should not add noticeably to the time
except when there are very many distinct values of <code>group</code> and
<code>x</code> has few columns.
</p>
<p>The original function was written by Terry Therneau, but this is a
new implementation using hashing that is much faster for large matrices.
</p>
<p>To sum over all the rows of a matrix (i.e., a single <code>group</code>) use
<code><a href="#topic+colSums">colSums</a></code>, which should be even faster.
</p>
<p>For integer arguments, over/underflow in forming the sum results in
<code>NA</code>.
</p>


<h3>Value</h3>

<p>A matrix or data frame containing the sums.  There will be one row per
unique value of <code>group</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tapply">tapply</a></code>, <code><a href="stats.html#topic+aggregate">aggregate</a></code>, <code><a href="#topic+rowSums">rowSums</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

x &lt;- matrix(runif(100), ncol = 5)
group &lt;- sample(1:8, 20, TRUE)
(xsum &lt;- rowsum(x, group))
## Slower versions
tapply(x, list(group[row(x)], col(x)), sum)
t(sapply(split(as.data.frame(x), group), colSums))
aggregate(x, list(group), sum)[-1]
</code></pre>

<hr>
<h2 id='S3method'>
Register S3 Methods
</h2><span id='topic+.S3method'></span>

<h3>Description</h3>

<p>Register S3 methods in R scripts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.S3method(generic, class, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="S3method_+3A_generic">generic</code></td>
<td>
<p>a character string naming an S3 generic function.</p>
</td></tr>
<tr><td><code id="S3method_+3A_class">class</code></td>
<td>
<p>a character string naming an S3 class.</p>
</td></tr>
<tr><td><code id="S3method_+3A_method">method</code></td>
<td>
<p>a character string or function giving the S3 method to
be registered.  If not given, the function named
<code><var>generic</var>.<var>class</var></code> is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should only be used in R scripts: for package code, one
should use the corresponding &lsquo;<span class="samp">&#8288;S3method&#8288;</span>&rsquo; &lsquo;<span class="file">NAMESPACE</span>&rsquo; directive.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a generic function and register a method for objects
## inheriting from class 'cls':
gen &lt;- function(x) UseMethod("gen")
met &lt;- function(x) writeLines("Hello world.")
.S3method("gen", "cls", met)
## Create an object inheriting from class 'cls', and call the
## generic on it:
x &lt;- structure(123, class = "cls")
gen(x)
</code></pre>

<hr>
<h2 id='sample'>Random Samples and Permutations</h2><span id='topic+sample'></span><span id='topic+sample.int'></span>

<h3>Description</h3>

<p><code>sample</code> takes a sample of the specified size from the elements
of <code>x</code> using either with or without replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample(x, size, replace = FALSE, prob = NULL)

sample.int(n, size = n, replace = FALSE, prob = NULL,
           useHash = (n &gt; 1e+07 &amp;&amp; !replace &amp;&amp; is.null(prob) &amp;&amp; size &lt;= n/2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_+3A_x">x</code></td>
<td>
<p>either a vector of one or more elements from which to choose,
or a positive integer.  See &lsquo;Details.&rsquo;</p>
</td></tr>
<tr><td><code id="sample_+3A_n">n</code></td>
<td>
<p>a positive number, the number of items to choose from.  See
&lsquo;Details.&rsquo;</p>
</td></tr>
<tr><td><code id="sample_+3A_size">size</code></td>
<td>
<p>a non-negative integer giving the number of items to choose.</p>
</td></tr>
<tr><td><code id="sample_+3A_replace">replace</code></td>
<td>
<p>should sampling be with replacement?</p>
</td></tr>
<tr><td><code id="sample_+3A_prob">prob</code></td>
<td>
<p>a vector of probability weights for obtaining the elements
of the vector being sampled.</p>
</td></tr>
<tr><td><code id="sample_+3A_usehash">useHash</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating if the hash-version of
the algorithm should be used.  Can only be used for <code>replace =
      FALSE</code>, <code>prob = NULL</code>, and <code>size &lt;= n/2</code>, and really
should be used for large <code>n</code>, as <code>useHash=FALSE</code> will use
memory proportional to <code>n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> has length 1, is numeric (in the sense of
<code><a href="#topic+is.numeric">is.numeric</a></code>) and <code>x &gt;= 1</code>, sampling <em>via</em>
<code>sample</code> takes place from <code>1:x</code>.  <em>Note</em> that this
convenience feature may lead to undesired behaviour when <code>x</code> is
of varying length in calls such as <code>sample(x)</code>.  See the examples.
</p>
<p>Otherwise <code>x</code> can be any <span class="rlang"><b>R</b></span> object for which <code>length</code> and
subsetting by integers make sense: S3 or S4 methods for these
operations will be dispatched as appropriate.
</p>
<p>For <code>sample</code> the default for <code>size</code> is the number of items
inferred from the first argument, so that <code>sample(x)</code> generates a
random permutation of the elements of <code>x</code> (or <code>1:x</code>).
</p>
<p>It is allowed to ask for <code>size = 0</code> samples with <code>n = 0</code> or
a length-zero <code>x</code>, but otherwise <code>n &gt; 0</code> or positive
<code>length(x)</code> is required.
</p>
<p>Non-integer positive numerical values of <code>n</code> or <code>x</code> will be
truncated to the next smallest integer, which has to be no larger than
<code><a href="#topic+.Machine">.Machine</a>$integer.max</code>.
</p>
<p>The optional <code>prob</code> argument can be used to give a vector of
weights for obtaining the elements of the vector being sampled.  They
need not sum to one, but they should be non-negative and not all zero.
If <code>replace</code> is true, Walker's alias method (Ripley, 1987) is
used when there are more than 200 reasonably probable values: this
gives results incompatible with those from <span class="rlang"><b>R</b></span> &lt; 2.2.0.
</p>
<p>If <code>replace</code> is false, these probabilities are applied
sequentially, that is the probability of choosing the next item is
proportional to the weights amongst the remaining items.  The number
of nonzero weights must be at least <code>size</code> in this case.
</p>
<p><code>sample.int</code> is a bare interface in which both <code>n</code> and
<code>size</code> must be supplied as integers.
</p>
<p>Argument <code>n</code> can be larger than the largest integer of
type <code>integer</code>, up to the largest representable integer in type
<code>double</code>.  Only uniform sampling is supported.  Two
random numbers are used to ensure uniform sampling of large integers.
</p>


<h3>Value</h3>

<p>For <code>sample</code> a vector of length <code>size</code> with elements
drawn from either <code>x</code> or from the integers <code>1:x</code>.
</p>
<p>For <code>sample.int</code>, an integer vector of length <code>size</code> with
elements from <code>1:n</code>, or a double vector if
<code class="reqn">n \ge 2^{31}</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Ripley, B. D. (1987) <em>Stochastic Simulation</em>. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNGkind">RNGkind</a>(sample.kind = ..)</code> about random number generation,
notably the change of <code>sample()</code> results with <span class="rlang"><b>R</b></span> version 3.6.0.
</p>
<p>CRAN package <a href="https://CRAN.R-project.org/package=sampling"><span class="pkg">sampling</span></a> for other methods of weighted sampling
without replacement.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:12
# a random permutation
sample(x)
# bootstrap resampling -- only if length(x) &gt; 1 !
sample(x, replace = TRUE)

# 100 Bernoulli trials
sample(c(0,1), 100, replace = TRUE)

## More careful bootstrapping --  Consider this when using sample()
## programmatically (i.e., in your function or simulation)!

# sample()'s surprise -- example
x &lt;- 1:10
    sample(x[x &gt;  8]) # length 2
    sample(x[x &gt;  9]) # oops -- length 10!
    sample(x[x &gt; 10]) # length 0

## safer version:
resample &lt;- function(x, ...) x[sample.int(length(x), ...)]
resample(x[x &gt;  8]) # length 2
resample(x[x &gt;  9]) # length 1
resample(x[x &gt; 10]) # length 0

## R 3.0.0 and later
sample.int(1e10, 12, replace = TRUE)
sample.int(1e10, 12) # not that there is much chance of duplicates
</code></pre>

<hr>
<h2 id='save'>Save R Objects</h2><span id='topic+save'></span><span id='topic+save.image'></span>

<h3>Description</h3>

<p><code>save</code> writes an external representation of <span class="rlang"><b>R</b></span> objects to the
specified file.  The objects can be read back from the file at a later
date by using the function <code><a href="#topic+load">load</a></code> or <code><a href="#topic+attach">attach</a></code>
(or <code><a href="utils.html#topic+data">data</a></code> in some cases).
</p>
<p><code>save.image()</code> is just a short-cut for &lsquo;save my current
workspace&rsquo;, i.e., <code>save(list = ls(all.names = TRUE), file =
    ".RData", envir = .GlobalEnv)</code>.
It is also what happens with <code><a href="#topic+q">q</a>("yes")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save(..., list = character(),
     file = stop("'file' must be specified"),
     ascii = FALSE, version = NULL, envir = parent.frame(),
     compress = isTRUE(!ascii), compression_level,
     eval.promises = TRUE, precheck = TRUE)

save.image(file = ".RData", version = NULL, ascii = FALSE,
           compress = !ascii, safe = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_+3A_...">...</code></td>
<td>
<p>the names of the objects to be saved (as symbols or
character strings).</p>
</td></tr>
<tr><td><code id="save_+3A_list">list</code></td>
<td>
<p>a character vector (or <code><a href="#topic+NULL">NULL</a></code>) containing the names of objects to be
saved.</p>
</td></tr>
<tr><td><code id="save_+3A_file">file</code></td>
<td>
<p>a (writable binary-mode) <a href="#topic+connection">connection</a> or the name of the
file where the data will be saved (when <a href="#topic+tilde+20expansion">tilde expansion</a>
is done).  Must be a file name for <code>save.image</code> or
<code>version = 1</code>.</p>
</td></tr>
<tr><td><code id="save_+3A_ascii">ascii</code></td>
<td>
<p>if <code>TRUE</code>, an ASCII representation of the data is
written.  The default value of <code>ascii</code> is <code>FALSE</code> which
leads to a binary file being written.  If <code>NA</code> and
<code>version &gt;= 2</code>, a different ASCII representation is used which
writes double/complex numbers as binary fractions.</p>
</td></tr>
<tr><td><code id="save_+3A_version">version</code></td>
<td>
<p>the workspace format version to use.  <code>NULL</code>
specifies the current default format (3).  Version 1 was the default
from <span class="rlang"><b>R</b></span> 0.99.0 to <span class="rlang"><b>R</b></span> 1.3.1 and version 2 from <span class="rlang"><b>R</b></span> 1.4.0 to 3.5.0.
Version 3 is supported from <span class="rlang"><b>R</b></span> 3.5.0.</p>
</td></tr>
<tr><td><code id="save_+3A_envir">envir</code></td>
<td>
<p>environment to search for objects to be saved.</p>
</td></tr>
<tr><td><code id="save_+3A_compress">compress</code></td>
<td>
<p>logical or character string specifying whether saving
to a named file is to use compression.  <code>TRUE</code> corresponds to
<code>gzip</code> compression, and character strings <code>"gzip"</code>,
<code>"bzip2"</code> or <code>"xz"</code> specify the type of
compression.  Ignored when <code>file</code> is a connection and
for workspace format version 1.</p>
</td></tr>
<tr><td><code id="save_+3A_compression_level">compression_level</code></td>
<td>
<p>integer: the level of compression to be
used.  Defaults to <code>6</code> for <code>gzip</code> compression and to
<code>9</code> for <code>bzip2</code> or <code>xz</code> compression.  See the
help for <code><a href="#topic+file">file</a></code> for possible values and their merits.</p>
</td></tr>
<tr><td><code id="save_+3A_eval.promises">eval.promises</code></td>
<td>
<p>logical: should objects which are promises be
forced before saving?</p>
</td></tr>
<tr><td><code id="save_+3A_precheck">precheck</code></td>
<td>
<p>logical: should the existence of the objects be
checked before starting to save (and in particular before opening
the file/connection)?  Does not apply to version 1 saves.</p>
</td></tr>
<tr><td><code id="save_+3A_safe">safe</code></td>
<td>
<p>logical.  If <code>TRUE</code>, a temporary file is used for
creating the saved workspace.  The temporary file is renamed to
<code>file</code> if the save succeeds.  This preserves an existing
workspace <code>file</code> if the save fails, but at the cost of using
extra disk space during the save.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names of the objects specified either as symbols (or character
strings) in <code>...</code> or as a character vector in <code>list</code> are
used to look up the objects from environment <code>envir</code>.  By default
<a href="#topic+promises">promises</a> are evaluated, but if <code>eval.promises = FALSE</code>
promises are saved (together with their evaluation environments).
(Promises embedded in objects are always saved unevaluated.)
</p>
<p>All <span class="rlang"><b>R</b></span> platforms use the XDR (big-endian) representation of C ints and
doubles in binary save-d files, and these are portable across all <span class="rlang"><b>R</b></span>
platforms.
</p>
<p>ASCII saves used to be useful for moving data between platforms but
are now mainly of historical interest.  They can be more compact than
binary saves where compression is not used, but are almost always
slower to both read and write: binary saves compress much better than
ASCII ones.  Further, decimal ASCII saves may not restore
double/complex values exactly, and what value is restored may depend
on the <span class="rlang"><b>R</b></span> platform.
</p>
<p>Default values for the <code>ascii</code>, <code>compress</code>, <code>safe</code> and
<code>version</code> arguments can be modified with the
<code>"save.defaults"</code> option (used both by <code>save</code> and
<code>save.image</code>), see also the &lsquo;Examples&rsquo; section.  If a
<code>"save.image.defaults"</code> option is set it is used in preference to
<code>"save.defaults"</code> for function <code>save.image</code> (which allows
this to have different defaults).  In addition,
<code>compression_level</code> can be part of the <code>"save.defaults"</code>
option.
</p>
<p>A connection that is not already open will be opened in mode
<code>"wb"</code>.  Supplying a connection which is open and not in binary
mode gives an error.
</p>


<h3>Compression</h3>

<p>Large files can be reduced considerably in size by compression.  A
particular 46MB <span class="rlang"><b>R</b></span> object was saved as 35MB without compression in 2
seconds, 22MB with <code>gzip</code> compression in 8 secs, 19MB with
<code>bzip2</code> compression in 13 secs and 9.4MB with <code>xz</code>
compression in 40 secs.  The load times were 1.3, 2.8, 5.5 and 5.7
seconds respectively.  These results are indicative, but the relative
performances do depend on the actual file: <code>xz</code> compressed
unusually well here.
</p>
<p>It is possible to compress later (with <code>gzip</code>, <code>bzip2</code>
or <code>xz</code>) a file saved with <code>compress = FALSE</code>: the effect
is the same as saving with compression.  Also, a saved file can be
uncompressed and re-compressed under a different compression scheme
(and see <code><a href="tools.html#topic+resaveRdaFiles">resaveRdaFiles</a></code> for a way to do so from within <span class="rlang"><b>R</b></span>).
</p>


<h3>Parallel compression</h3>

<p>That <code>file</code> can be a connection can be exploited to make use of
an external parallel compression utility such as <code>pigz</code>
(<a href="https://zlib.net/pigz/">https://zlib.net/pigz/</a>) or <code>pbzip2</code>
(<a href="https://launchpad.net/pbzip2">https://launchpad.net/pbzip2</a>) <em>via</em> a <code><a href="#topic+pipe">pipe</a></code>
connection.  For example, using 8 threads,
</p>
<pre>    con &lt;- pipe("pigz -p8 &gt; fname.gz", "wb")
    save(myObj, file = con); close(con)

    con &lt;- pipe("pbzip2 -p8 -9 &gt; fname.bz2", "wb")
    save(myObj, file = con); close(con)

    con &lt;- pipe("xz -T8 -6 -e &gt; fname.xz", "wb")
    save(myObj, file = con); close(con)
</pre>
<p>where the last requires <code>xz</code> 5.1.1 or later built with support
for multiple threads (and parallel compression is only effective for
large objects: at level 6 it will compress in serialized chunks of 12MB).
</p>


<h3>Warnings</h3>

<p>The <code>...</code> arguments only give the <em>names</em> of the objects
to be saved: they are searched for in the environment given by the
<code>envir</code> argument, and the actual objects given as arguments need
not be those found.
</p>
<p>Saved <span class="rlang"><b>R</b></span> objects are binary files, even those saved with
<code>ascii = TRUE</code>, so ensure that they are transferred without
conversion of end-of-line markers and of 8-bit characters.  The lines
are delimited by <abbr>LF</abbr> on all platforms.
</p>
<p>Although the default version was not changed between <span class="rlang"><b>R</b></span> 1.4.0 and <span class="rlang"><b>R</b></span>
3.4.4 nor since <span class="rlang"><b>R</b></span> 3.5.0, this does not mean that saved files are
necessarily backwards compatible.  You will be able to load a saved
image into an earlier version of <span class="rlang"><b>R</b></span> which supports its version unless
use is made of later additions (for example for version 2, raw
vectors, external pointers and some S4 objects).
</p>
<p>One such &lsquo;later addition&rsquo; was <a href="#topic+long+20vectors">long vectors</a>, introduced in <span class="rlang"><b>R</b></span>
3.0.0 and loadable only on 64-bit platforms.
</p>
<p>Loading files saved with <code>ASCII = NA</code> requires a C99-compliant C
function <code>sscanf</code>: this is a problem on Windows, first worked
around in <span class="rlang"><b>R</b></span> 3.1.2: version-2 files in that format should be readable
in earlier versions of <span class="rlang"><b>R</b></span> on all other platforms.
</p>


<h3>Note</h3>

<p>For saving single <span class="rlang"><b>R</b></span> objects, <code><a href="#topic+saveRDS">saveRDS</a>()</code> is mostly
preferable to <code>save()</code>, notably because of the <em>functional</em>
nature of <code><a href="#topic+readRDS">readRDS</a>()</code>, as opposed to <code><a href="#topic+load">load</a>()</code>.
</p>
<p>The most common reason for failure is lack of write permission in the
current directory.  For <code>save.image</code> and for saving at the end of
a session this will shown by messages like
</p>
<pre>    Error in gzfile(file, "wb") : unable to open connection
    In addition: Warning message:
    In gzfile(file, "wb") :
      cannot open compressed file '.RDataTmp',
      probable reason 'Permission denied'
</pre>


<h3>See Also</h3>

<p><code><a href="#topic+dput">dput</a></code>, <code><a href="#topic+dump">dump</a></code>, <code><a href="#topic+load">load</a></code>,
<code><a href="utils.html#topic+data">data</a></code>.
</p>
<p>For other interfaces to the underlying serialization format, see
<code><a href="#topic+serialize">serialize</a></code> and <code><a href="#topic+saveRDS">saveRDS</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- stats::runif(20)
y &lt;- list(a = 1, b = TRUE, c = "oops")
save(x, y, file = "xy.RData")
save.image() # creating ".RData" in current working directory
unlink("xy.RData")

# set save defaults using option:
options(save.defaults = list(ascii = TRUE, safe = FALSE))
save.image() # creating ".RData"
if(interactive()) withAutoprint({
   file.info(".RData")
   readLines(".RData", n = 7) # first 7 lines; first starts w/ "RDA"..
})
unlink(".RData")

</code></pre>

<hr>
<h2 id='scale'>Scaling and Centering of Matrix-like Objects</h2><span id='topic+scale'></span><span id='topic+scale.default'></span>

<h3>Description</h3>

<p><code>scale</code> is generic function whose default method centers and/or
scales the columns of a numeric matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale(x, center = TRUE, scale = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_+3A_x">x</code></td>
<td>
<p>a numeric matrix(like object).</p>
</td></tr>
<tr><td><code id="scale_+3A_center">center</code></td>
<td>
<p>either a logical value or numeric-alike vector of length
equal to the number of columns of <code>x</code>, where
&lsquo;numeric-alike&rsquo; means that <code><a href="#topic+as.numeric">as.numeric</a>(.)</code> will
be applied successfully if <code><a href="#topic+is.numeric">is.numeric</a>(.)</code> is not true.</p>
</td></tr>
<tr><td><code id="scale_+3A_scale">scale</code></td>
<td>
<p>either a logical value or a numeric-alike vector of length
equal to the number of columns of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of <code>center</code> determines how column centering is
performed.  If <code>center</code> is a numeric-alike vector with length equal to
the number of columns of <code>x</code>, then each column of <code>x</code> has
the corresponding value from <code>center</code> subtracted from it.  If
<code>center</code> is <code>TRUE</code> then centering is done by subtracting the
column means (omitting <code>NA</code>s) of <code>x</code> from their
corresponding columns, and if <code>center</code> is <code>FALSE</code>, no
centering is done.
</p>
<p>The value of <code>scale</code> determines how column scaling is performed
(after centering).  If <code>scale</code> is a numeric-alike vector with length
equal to the number of columns of <code>x</code>, then each column of
<code>x</code> is divided by the corresponding value from <code>scale</code>.
If <code>scale</code> is <code>TRUE</code> then scaling is done by dividing the
(centered) columns of <code>x</code> by their standard deviations if
<code>center</code> is <code>TRUE</code>, and the root mean square otherwise.
If <code>scale</code> is <code>FALSE</code>, no scaling is done.
</p>
<p>The root-mean-square for a (possibly centered) column is defined as
<code class="reqn">\sqrt{\sum(x^2)/(n-1)}</code>, where <code class="reqn">x</code> is
a vector of the non-missing values and <code class="reqn">n</code> is the number of
non-missing values.  In the case <code>center = TRUE</code>, this is the
same as the standard deviation, but in general it is not.  (To scale
by the standard deviations without centering, use
<code>scale(x, center = FALSE, scale = apply(x, 2, sd, na.rm = TRUE))</code>.)
</p>


<h3>Value</h3>

<p>For <code>scale.default</code>, the centered, scaled matrix.  The numeric
centering and scalings used (if any) are returned as attributes
<code>"scaled:center"</code> and <code>"scaled:scale"</code>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sweep">sweep</a></code> which allows centering (and scaling) with
arbitrary statistics.
</p>
<p>For working with the scale of a plot, see <code><a href="graphics.html#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
x &lt;- matrix(1:10, ncol = 2)
(centered.x &lt;- scale(x, scale = FALSE))
cov(centered.scaled.x &lt;- scale(x)) # all 1
</code></pre>

<hr>
<h2 id='scan'>Read Data Values</h2><span id='topic+scan'></span>

<h3>Description</h3>

<p>Read data into a vector or list from the console or file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scan(file = "", what = double(), nmax = -1, n = -1, sep = "",
     quote = if(identical(sep, "\n")) "" else "'\"", dec = ".",
     skip = 0, nlines = 0, na.strings = "NA",
     flush = FALSE, fill = FALSE, strip.white = FALSE,
     quiet = FALSE, blank.lines.skip = TRUE, multi.line = TRUE,
     comment.char = "", allowEscapes = FALSE,
     fileEncoding = "", encoding = "unknown", text, skipNul = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scan_+3A_file">file</code></td>
<td>
<p>the name of a file to read data values from.  If the
specified file is <code>""</code>, then input is taken from the keyboard
(or whatever <code><a href="#topic+stdin">stdin</a>()</code> reads if input is redirected or
<span class="rlang"><b>R</b></span> is embedded).
(In this case input can be terminated by a blank line or an <abbr>EOF</abbr>
signal, &lsquo;<span class="samp">&#8288;Ctrl-D&#8288;</span>&rsquo; on Unix and &lsquo;<span class="samp">&#8288;Ctrl-Z&#8288;</span>&rsquo; on Windows.)
</p>
<p>Otherwise, the file name is interpreted <em>relative</em> to the
current working directory (given by <code><a href="#topic+getwd">getwd</a>()</code>),
unless it specifies an <em>absolute</em> path.
Tilde-expansion is performed where supported.
When running <span class="rlang"><b>R</b></span> from a script, <code>file = "stdin"</code> can be used to
refer to the process's <code>stdin</code> file stream.
</p>
<p>This can be a compressed file (see <code><a href="#topic+file">file</a></code>).
</p>
<p>Alternatively, <code>file</code> can be a <code><a href="#topic+connection">connection</a></code>,
which will be opened if necessary, and if so closed at the end of
the function call.  Whatever mode the connection is opened in,
any of <abbr>LF</abbr>, <abbr>CRLF</abbr> or <abbr>CR</abbr> will be accepted as the
<abbr>EOL</abbr> marker for a line and so will match <code>sep = "\n"</code>.
</p>
<p><code>file</code> can also be a complete URL.  (For the supported URL
schemes, see the &lsquo;URLs&rsquo; section of the help for
<code><a href="#topic+url">url</a></code>.)
</p>
<p>To read a data file not in the current encoding (for example a
Latin-1 file in a UTF-8 locale or conversely) use a
<code><a href="#topic+file">file</a></code> connection setting its <code>encoding</code> argument
(or <code>scan</code>'s <code>fileEncoding</code> argument).
</p>
</td></tr>
<tr><td><code id="scan_+3A_what">what</code></td>
<td>
<p>the <a href="#topic+type">type</a> of <code>what</code> gives the type of data to
be read.  (Here &lsquo;type&rsquo; is used in the sense of
<code><a href="#topic+typeof">typeof</a></code>.)  The supported types are <code>logical</code>,
<code>integer</code>, <code>numeric</code>, <code>complex</code>, <code>character</code>,
<code>raw</code> and <code><a href="#topic+list">list</a></code>.  If <code>what</code> is a list, it is
assumed that the lines of the data file are records each containing
<code>length(what)</code> items (&lsquo;fields&rsquo;) and the list components
should have elements which are one of the first six (<a href="#topic+atomic">atomic</a>)
types listed or <code>NULL</code>, see section &lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="scan_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of data values to be read, or if
<code>what</code> is a list, the maximum number of records to be read.  If
omitted or not positive or an invalid value for an integer
(and <code>nlines</code> is not set to a positive value), <code>scan</code> will
read to the end of <code>file</code>.</p>
</td></tr>
<tr><td><code id="scan_+3A_n">n</code></td>
<td>
<p>integer: the maximum number of data values to be read, defaulting to
no limit.  Invalid values will be ignored.</p>
</td></tr>
<tr><td><code id="scan_+3A_sep">sep</code></td>
<td>
<p>by default, scan expects to read &lsquo;white-space&rsquo;
delimited input fields.  Alternatively, <code>sep</code> can be used to
specify a character which delimits fields.  A field is always
delimited by an end-of-line marker unless it is quoted.
</p>
<p>If specified this should be the empty character string (the default)
or <code>NULL</code> or a character string containing just one single-byte
character.
</p>
</td></tr>
<tr><td><code id="scan_+3A_quote">quote</code></td>
<td>
<p>the set of quoting characters as a single character
string or <code>NULL</code>.  In a multibyte locale the quoting characters
must be ASCII (single-byte).</p>
</td></tr>
<tr><td><code id="scan_+3A_dec">dec</code></td>
<td>
<p>decimal point character.  This should be a character string
containing just one single-byte character.  (<code>NULL</code> and a
zero-length character vector are also accepted, and taken as the
default.)</p>
</td></tr>
<tr><td><code id="scan_+3A_skip">skip</code></td>
<td>
<p>the number of  lines of the input file to skip before
beginning to read data values.</p>
</td></tr>
<tr><td><code id="scan_+3A_nlines">nlines</code></td>
<td>
<p>if positive, the maximum number of lines of data to be read.</p>
</td></tr>
<tr><td><code id="scan_+3A_na.strings">na.strings</code></td>
<td>
<p>character vector.  Elements of this vector are to be
interpreted as missing (<code><a href="#topic+NA">NA</a></code>) values.  Blank fields are
also considered to be missing values in logical, integer, numeric
and complex fields.  Note that the test happens <em>after</em> 
white space is stripped from the input (if enabled), so <code>na.strings</code> values
may need their own white space stripped in advance.</p>
</td></tr>
<tr><td><code id="scan_+3A_flush">flush</code></td>
<td>
<p>logical: if <code>TRUE</code>, <code>scan</code> will flush to the
end of the line after reading the last of the fields requested.
This allows putting comments after the last field, but precludes
putting more than one record on a line.</p>
</td></tr>
<tr><td><code id="scan_+3A_fill">fill</code></td>
<td>
<p>logical: if <code>TRUE</code>, <code>scan</code> will implicitly add
empty fields to any lines with fewer fields than implied by
<code>what</code>.</p>
</td></tr>
<tr><td><code id="scan_+3A_strip.white">strip.white</code></td>
<td>
<p>vector of logical value(s) corresponding to items
in the <code>what</code> argument.  It is used only when <code>sep</code> has
been specified, and allows the stripping of leading and trailing
&lsquo;white space&rsquo; from <code>character</code> fields (other fields
are always stripped).  Note: white space inside quoted strings is
not stripped.
</p>
<p>If <code>strip.white</code> is of length 1, it applies to all fields;
otherwise, if <code>strip.white[i]</code> is <code>TRUE</code> <em>and</em> the
<code>i</code>-th field is of mode character (because <code>what[i]</code> is)
then the leading and trailing unquoted white space from field <code>i</code> is
stripped.
</p>
</td></tr>
<tr><td><code id="scan_+3A_quiet">quiet</code></td>
<td>
<p>logical: if <code>FALSE</code> (default), scan() will print a
line, saying how many items have been read.</p>
</td></tr>
<tr><td><code id="scan_+3A_blank.lines.skip">blank.lines.skip</code></td>
<td>
<p>logical: if <code>TRUE</code> blank lines in the
input are ignored, except when counting <code>skip</code> and <code>nlines</code>.</p>
</td></tr>
<tr><td><code id="scan_+3A_multi.line">multi.line</code></td>
<td>
<p>logical.  Only used if <code>what</code> is a list.  If
<code>FALSE</code>, all of a record must appear on one line (but more than
one record can appear on a single line).  Note that using <code>fill = TRUE</code>
implies that a record will be terminated at the end of a line.</p>
</td></tr>
<tr><td><code id="scan_+3A_comment.char">comment.char</code></td>
<td>
<p>character: a character vector of length one
containing a single character or an empty string.  Use <code>""</code> to
turn off the interpretation of comments altogether (the default).</p>
</td></tr>
<tr><td><code id="scan_+3A_allowescapes">allowEscapes</code></td>
<td>
<p>logical.  Should C-style escapes such as
&lsquo;<span class="samp">&#8288;\n&#8288;</span>&rsquo; be processed (the default) or read verbatim?   Note that if
not within quotes these could be interpreted as a delimiter (but not
as a comment character).
</p>
<p>The escapes which are interpreted are the control characters
&lsquo;<span class="samp">&#8288;\a, \b, \f, \n, \r, \t, \v&#8288;</span>&rsquo; and octal and
hexadecimal representations like &lsquo;<span class="samp">&#8288;\040&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;\0x2A&#8288;</span>&rsquo;.  Any
other escaped character is treated as itself, including backslash.
Note that Unicode escapes (starting &lsquo;<span class="samp">&#8288;\u&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;\U&#8288;</span>&rsquo;: see
<a href="#topic+Quotes">Quotes</a>) are never processed.
</p>
</td></tr>
<tr><td><code id="scan_+3A_fileencoding">fileEncoding</code></td>
<td>
<p>character string: if non-empty declares the
encoding used on a file (not a connection nor the keyboard) so the
character data can be re-encoded.  See the &lsquo;Encoding&rsquo; section
of the help for <code><a href="#topic+file">file</a></code>, and the &lsquo;R Data
Import/Export Manual&rsquo;.
</p>
</td></tr>
<tr><td><code id="scan_+3A_encoding">encoding</code></td>
<td>
<p>encoding to be assumed for input strings.  If the
value is <code>"latin1"</code> or <code>"UTF-8"</code> it is used to mark
character strings as known to be in Latin-1 or UTF-8: it is not used
to re-encode the input (see <code>fileEncoding</code>).
See also &lsquo;Details&rsquo;.
</p>
</td></tr>
<tr><td><code id="scan_+3A_text">text</code></td>
<td>
<p>character string: if <code>file</code> is not supplied and this is,
then data are read from the value of <code>text</code> via a text connection.
</p>
</td></tr>
<tr><td><code id="scan_+3A_skipnul">skipNul</code></td>
<td>
<p>logical: should <abbr>NUL</abbr>s be skipped when reading character
fields?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of <code>what</code> can be a list of types, in which case
<code>scan</code> returns a list of vectors with the types given by the
types of the elements in <code>what</code>.  This provides a way of reading
columnar data.  If any of the types is <code>NULL</code>, the corresponding
field is skipped (but a <code>NULL</code> component appears in the result).
</p>
<p>The type of <code>what</code> or its components can be one of the six
atomic vector types or <code>NULL</code> (see <code><a href="#topic+is.atomic">is.atomic</a></code>).
</p>
<p>&lsquo;White space&rsquo; is defined for the purposes of this function as
one or more contiguous characters from the set space, horizontal tab,
carriage return and line feed (aka &ldquo;newline&rdquo;, <code>"\n"</code>).  It
does not include form feed nor
vertical tab, but in Latin-1 and Windows 8-bit locales (but not UTF-8)
'space' includes the non-breaking space &lsquo;<span class="samp">&#8288;"\xa0"&#8288;</span>&rsquo;.
</p>
<p>Empty numeric fields are always regarded as missing values.
Empty character fields are scanned as empty character vectors, unless
<code>na.strings</code> contains <code>""</code> when they are regarded as missing
values.
</p>
<p>The allowed input for a numeric field is optional whitespace, followed by
either <code>NA</code> or an optional sign followed by a decimal or
hexadecimal constant (see <a href="#topic+NumericConstants">NumericConstants</a>), or <code>NaN</code>,
<code>Inf</code> or <code>infinity</code> (ignoring case).  Out-of-range values
are recorded as <code>Inf</code>, <code>-Inf</code> or <code>0</code>.
</p>
<p>For an integer field the allowed input is optional whitespace,
followed by either <code>NA</code> or an optional sign and one or more
digits (&lsquo;<span class="samp">&#8288;0-9&#8288;</span>&rsquo;): all out-of-range values are converted to
<code>NA_integer_</code>.
</p>
<p>If <code>sep</code> is the default (<code>""</code>), the character &lsquo;<span class="samp">&#8288;\&#8288;</span>&rsquo;
in a quoted string escapes the following character, so quotes may be
included in the string by escaping them.
</p>
<p>If <code>sep</code> is non-default, the fields may be quoted in the style of
&lsquo;<span class="file">.csv</span>&rsquo; files where separators inside quotes (<code>''</code> or
<code>""</code>) are ignored and quotes may be put inside strings by
doubling them.  However, if <code>sep = "\n"</code> it is assumed
by default that one wants to read entire lines verbatim.
</p>
<p>Quoting is only interpreted in character fields and in <code>NULL</code>
fields (which might be skipping character fields).
</p>
<p>Note that since <code>sep</code> is a separator and not a terminator,
reading a file by <code>scan("foo", sep = "\n", blank.lines.skip = FALSE)</code>
will give an empty final line if the file ends in a line feed (<code>"\n"</code>)
and not if it does not.  This might not be what you expected; see also
<code><a href="#topic+readLines">readLines</a></code>.
</p>
<p>If <code>comment.char</code> occurs (except inside a quoted character
field), it signals that the rest of the line should be regarded as a
comment and be discarded.  Lines beginning with a comment character
(possibly after white space with the default separator) are treated as
blank lines.
</p>
<p>There is a line-length limit of 4095 bytes when reading from the
console (which may impose a lower limit: see &lsquo;An Introduction
to R&rsquo;).
</p>
<p>There is a check for a user interrupt every 1000 lines if <code>what</code>
is a list, otherwise every 10000 items.
</p>
<p>If <code>file</code> is a character string and <code>fileEncoding</code> is
non-default, or if it is a not-already-open <a href="#topic+connection">connection</a> with a
non-default <code>encoding</code> argument, the text is converted to UTF-8
and declared as such (and the <code>encoding</code> argument to <code>scan</code>
is ignored).  See the examples of <code><a href="#topic+readLines">readLines</a></code>.
</p>
<p>Embedded <abbr>NUL</abbr>s in the input stream will terminate the field currently
being read, with a warning once per call to <code>scan</code>.  Setting
<code>skipNul = TRUE</code> causes them to be ignored.
</p>


<h3>Value</h3>

<p>if <code>what</code> is a list, a list of the same length and same names (as
any) as <code>what</code>.
</p>
<p>Otherwise, a vector of the type of <code>what</code>.
</p>
<p>Character strings in the result will have a declared encoding if
<code>encoding</code> is <code>"latin1"</code> or <code>"UTF-8"</code>.
</p>


<h3>Note</h3>

<p>The default for <code>multi.line</code> differs from S.  To read one record
per line, use <code>flush = TRUE</code> and <code>multi.line = FALSE</code>.
(Note that quoted character strings can still include embedded newlines.)
</p>
<p>If number of items is not specified, the internal
mechanism re-allocates memory in powers of two and so could use up
to three times as much memory as needed.  (It needs both old and new
copies.)  If you can, specify either <code>n</code> or <code>nmax</code> whenever
inputting a large vector, and <code>nmax</code> or <code>nlines</code> when
inputting a large list.
</p>
<p>Using <code>scan</code> on an open connection to read partial lines can lose
chars: use an explicit separator to avoid this.
</p>
<p>Having <code>nul</code> bytes in fields (including &lsquo;<span class="samp">&#8288;\0&#8288;</span>&rsquo; if
<code>allowEscapes = TRUE</code>) may lead to interpretation of the
field being terminated at the <code>nul</code>.  They not normally present
in text files &ndash; see <code><a href="#topic+readBin">readBin</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+read.table">read.table</a></code> for more user-friendly reading of data
matrices;
<code><a href="#topic+readLines">readLines</a></code> to read a file a line at a time.
<code><a href="#topic+write">write</a></code>.
</p>
<p><code>Quotes</code> for the details of C-style escape sequences.
</p>
<p><code><a href="#topic+readChar">readChar</a></code> and <code><a href="#topic+readBin">readBin</a></code> to read fixed or
variable length character strings or binary representations of numbers
a few at a time from a connection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cat("TITLE extra line", "2 3 5 7", "11 13 17", file = "ex.data", sep = "\n")
pp &lt;- scan("ex.data", skip = 1, quiet = TRUE)
scan("ex.data", skip = 1)
scan("ex.data", skip = 1, nlines = 1) # only 1 line after the skipped one
scan("ex.data", what = list("","","")) # flush is F -&gt; read "7"
scan("ex.data", what = list("","",""), flush = TRUE)
unlink("ex.data") # tidy up

## "inline" usage
scan(text = "1 2 3")

</code></pre>

<hr>
<h2 id='search'>Give Search Path for R Objects</h2><span id='topic+search'></span><span id='topic+searchpaths'></span>

<h3>Description</h3>

<p>Gives a list of <code><a href="#topic+attach">attach</a></code>ed <em>packages</em>
(see <code><a href="#topic+library">library</a></code>), and <span class="rlang"><b>R</b></span> objects, usually
<code><a href="#topic+data.frame">data.frame</a>s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search()
searchpaths()
</code></pre>


<h3>Value</h3>

<p>A character vector, starting with <code>"<a href="#topic+.GlobalEnv">.GlobalEnv</a>"</code>, and
ending with <code>"package:base"</code> which is <span class="rlang"><b>R</b></span>'s <span class="pkg">base</span> package
required always.
</p>
<p><code>searchpaths</code> gives a similar character vector, with the
entries for packages being the path to the package used to load the
code.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.  (<code>search</code>.)
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.  (<code>searchpaths</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.packages">.packages</a></code> to list just the packages on search path.
</p>
<p><code><a href="#topic+loadedNamespaces">loadedNamespaces</a></code> to list loaded namespaces.
</p>
<p><code><a href="#topic+attach">attach</a></code> and <code><a href="#topic+detach">detach</a></code> to change the
search path, <code><a href="#topic+objects">objects</a></code> to find <span class="rlang"><b>R</b></span> objects in there.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>search()
searchpaths()
</code></pre>

<hr>
<h2 id='seek'>Functions to Reposition Connections</h2><span id='topic+seek'></span><span id='topic+seek.connection'></span><span id='topic+truncate'></span><span id='topic+truncate.connection'></span><span id='topic+isSeekable'></span>

<h3>Description</h3>

<p>Functions to re-position connections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seek(con, ...)
## S3 method for class 'connection'
seek(con, where = NA, origin = "start", rw = "", ...)

isSeekable(con)

truncate(con, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seek_+3A_con">con</code></td>
<td>
<p>a <a href="#topic+connection">connection</a>.</p>
</td></tr>
<tr><td><code id="seek_+3A_where">where</code></td>
<td>
<p>numeric.  A file position (relative to the origin
specified by <code>origin</code>), or <code>NA</code>.</p>
</td></tr>
<tr><td><code id="seek_+3A_rw">rw</code></td>
<td>
<p>character string.  Empty or <code>"read"</code> or <code>"write"</code>,
partial matches allowed.</p>
</td></tr>
<tr><td><code id="seek_+3A_origin">origin</code></td>
<td>
<p>character string.  One of <code>"start"</code>, <code>"current"</code>,
<code>"end"</code>: see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="seek_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>seek</code> with <code>where = NA</code> returns the current byte offset
of a connection (from the beginning), and with a non-missing <code>where</code>
argument the connection is re-positioned (if possible) to the
specified position.  <code>isSeekable</code> returns whether the connection
in principle supports <code>seek</code>: currently only (possibly
<abbr>gz</abbr>-compressed) file connections do.
</p>
<p><code>where</code> is stored as a real but should represent an integer:
non-integer values are likely to be truncated.  Note that the possible
values can exceed the largest representable number in an <span class="rlang"><b>R</b></span>
<code>integer</code> on 64-bit builds, and on some 32-bit builds.
</p>
<p>File connections can be open for both writing/appending, in which case
<span class="rlang"><b>R</b></span> keeps separate positions for reading and writing.  Which <code>seek</code>
refers to can be set by its <code>rw</code> argument: the default is the
last mode (reading or writing) which was used.  Most files are
only opened for reading or writing and so default to that state.  If a
file is open for both reading and writing but has not been used, the
default is to give the reading position (0).
</p>
<p>The initial file position for reading is always at the beginning.
The initial position for writing is at the beginning of the file
for modes <code>"r+"</code> and <code>"r+b"</code>, otherwise at the end of the
file.  Some platforms only allow writing at the end of the file in
the append modes.  (The reported write position for a file opened in
an append mode will typically be unreliable until the file has been
written to.)
</p>
<p><code>gzfile</code> connections support <code>seek</code> with a number of
limitations, using the file position of the uncompressed file.
They do not support <code>origin = "end"</code>.  When writing, seeking is
only possible forwards: when reading seeking backwards is supported by
rewinding the file and re-reading from its start.
</p>
<p>If <code>seek</code> is called with a non-<code>NA</code> value of <code>where</code>,
any pushback on a text-mode connection is discarded.
</p>
<p><code>truncate</code> truncates a file opened for writing at its current
position.  It works only for <code>file</code> connections, and is not
implemented on all platforms: on others (including Windows) it will
not work for large (&gt; 2<abbr>Gb</abbr>) files.
</p>
<p>None of these should be expected to work on text-mode connections with
re-encoding selected.
</p>


<h3>Value</h3>

<p><code>seek</code> returns the current position (before any move), as a
(numeric) byte offset from the origin, if relevant, or <code>0</code> if
not.  Note that the position can exceed the largest representable
number in an <span class="rlang"><b>R</b></span> <code>integer</code> on 64-bit builds, and on some 32-bit
builds.
</p>
<p><code>truncate</code> returns <code>NULL</code>: it stops with an error if
it fails (or is not implemented).
</p>
<p><code>isSeekable</code> returns a logical value, whether the connection
supports <code>seek</code>.
</p>


<h3>Warning</h3>

<p>Use of <code>seek</code> on Windows is discouraged.  We have found so many
errors in the Windows implementation of file positioning that users
are advised to use it only at their own risk, and asked not to waste
the <span class="rlang"><b>R</b></span> developers' time with bug reports on Windows' deficiencies.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>
</p>

<hr>
<h2 id='seq'>Sequence Generation</h2><span id='topic+seq'></span><span id='topic+seq.default'></span><span id='topic+seq.int'></span><span id='topic+seq_along'></span><span id='topic+seq_len'></span>

<h3>Description</h3>

<p>Generate regular sequences.  <code>seq</code> is a standard generic with a
default method.  <code>seq.int</code> is a primitive which can be
much faster but has a few restrictions.  <code>seq_along</code> and
<code>seq_len</code> are very fast primitives for two common cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seq(...)

## Default S3 method:
seq(from = 1, to = 1, by = ((to - from)/(length.out - 1)),
    length.out = NULL, along.with = NULL, ...)

seq.int(from, to, by, length.out, along.with, ...)

seq_along(along.with)
seq_len(length.out)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq_+3A_...">...</code></td>
<td>
<p>arguments passed to or from methods.</p>
</td></tr>
<tr><td><code id="seq_+3A_from">from</code>, <code id="seq_+3A_to">to</code></td>
<td>
<p>the starting and (maximal) end values of the
sequence.  Of length <code>1</code> unless just <code>from</code> is supplied as
an unnamed argument.</p>
</td></tr>
<tr><td><code id="seq_+3A_by">by</code></td>
<td>
<p>number: increment of the sequence.</p>
</td></tr>
<tr><td><code id="seq_+3A_length.out">length.out</code></td>
<td>
<p>desired length of the sequence.  A
non-negative number, which for <code>seq</code> and <code>seq.int</code> will be
rounded up if fractional.</p>
</td></tr>
<tr><td><code id="seq_+3A_along.with">along.with</code></td>
<td>
<p>take the length from the length of this argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical inputs should all be <a href="#topic+finite">finite</a> (that is, not infinite,
<code><a href="#topic+NaN">NaN</a></code> or <code>NA</code>).
</p>
<p>The interpretation of the unnamed arguments of <code>seq</code> and
<code>seq.int</code> is <em>not</em> standard, and it is recommended always to
name the arguments when programming.
</p>
<p><code>seq</code> is  generic, and only the default method is described here.
Note that it dispatches on the class of the <strong>first</strong> argument
irrespective of argument names.  This can have unintended consequences
if it is called with just one argument intending this to be taken as
<code>along.with</code>: it is much better to use <code>seq_along</code> in that
case.
</p>
<p><code>seq.int</code> is an <a href="#topic+internal+20generic">internal generic</a> which dispatches on
methods for <code>"seq"</code> based on the class of the first supplied
argument (before argument matching).
</p>
<p>Typical usages are
</p>
<pre>seq(from, to)
seq(from, to, by= )
seq(from, to, length.out= )
seq(along.with= )
seq(from)
seq(length.out= )
</pre>
<p>The first form generates the sequence <code>from, from+/-1, ..., to</code>
(identical to <code>from:to</code>).
</p>
<p>The second form generates <code>from, from+by</code>, ..., up to the
sequence value less than or equal to <code>to</code>.  Specifying <code>to -
  from</code> and <code>by</code> of opposite signs is an error.  Note that the
computed final value can go just beyond <code>to</code> to allow for
rounding error, but is truncated to <code>to</code>.  (&lsquo;Just beyond&rsquo;
is by up to <code class="reqn">10^{-10}</code> times <code>abs(from - to)</code>.)
</p>
<p>The third generates a sequence of <code>length.out</code> equally spaced
values from <code>from</code> to <code>to</code>.  (<code>length.out</code> is usually
abbreviated to <code>length</code> or <code>len</code>, and <code>seq_len</code> is much
faster.)
</p>
<p>The fourth form generates the integer sequence <code>1, 2, ...,
    length(along.with)</code>.  (<code>along.with</code> is usually abbreviated to
<code>along</code>, and <code>seq_along</code> is much faster.)
</p>
<p>The fifth form generates the sequence <code>1, 2, ..., length(from)</code>
(as if argument <code>along.with</code> had been specified), <em>unless</em>
the argument is numeric of length 1 when it is interpreted as
<code>1:from</code> (even for <code>seq(0)</code> for compatibility with S).
Using either <code>seq_along</code> or <code>seq_len</code> is much preferred
(unless strict S compatibility is essential).
</p>
<p>The final form generates the integer sequence <code>1, 2, ...,
  length.out</code> unless <code>length.out = 0</code>, when it generates
<code>integer(0)</code>.
</p>
<p>Very small sequences (with <code>from - to</code> of the order of <code class="reqn">10^{-14}</code>
times the larger of the ends) will return <code>from</code>.
</p>
<p>For <code>seq</code> (only), up to two of <code>from</code>, <code>to</code> and
<code>by</code> can be supplied as complex values provided <code>length.out</code>
or <code>along.with</code> is specified.  More generally, the default method
of <code>seq</code> will handle classed objects with methods for
the <code>Math</code>, <code>Ops</code> and <code>Summary</code> group generics.
</p>
<p><code>seq.int</code>, <code>seq_along</code> and <code>seq_len</code> are
<a href="#topic+primitive">primitive</a>.
</p>


<h3>Value</h3>

<p><code>seq.int</code> and the default method of <code>seq</code> for numeric
arguments return a vector of type <code>"integer"</code> or <code>"double"</code>:
programmers should not rely on which.
</p>
<p><code>seq_along</code> and <code>seq_len</code> return an integer vector, unless
it is a <em><a href="#topic+long+20vector">long vector</a></em> when it will be double.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>The methods <code><a href="#topic+seq.Date">seq.Date</a></code> and <code><a href="#topic+seq.POSIXt">seq.POSIXt</a></code>.
</p>
<p><code><a href="#topic++3A">:</a></code>,
<code><a href="#topic+rep">rep</a></code>,
<code><a href="#topic+sequence">sequence</a></code>,
<code><a href="#topic+row">row</a></code>,
<code><a href="#topic+col">col</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seq(0, 1, length.out = 11)
seq(stats::rnorm(20)) # effectively 'along'
seq(1, 9, by = 2)     # matches 'end'
seq(1, 9, by = pi)    # stays below 'end'
seq(1, 6, by = 3)
seq(1.575, 5.125, by = 0.05)
seq(17) # same as 1:17, or even better seq_len(17)
</code></pre>

<hr>
<h2 id='seq.Date'>Generate Regular Sequences of Dates</h2><span id='topic+seq.Date'></span>

<h3>Description</h3>

<p>The method for <code><a href="#topic+seq">seq</a></code> for objects of class
<code>"<a href="#topic+Date">Date</a>"</code> representing calendar dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Date'
seq(from, to, by, length.out = NULL, along.with = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq.Date_+3A_from">from</code></td>
<td>
<p>starting date.  Required.</p>
</td></tr>
<tr><td><code id="seq.Date_+3A_to">to</code></td>
<td>
<p>end date.  Optional.</p>
</td></tr>
<tr><td><code id="seq.Date_+3A_by">by</code></td>
<td>
<p>increment of the sequence.  Optional.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="seq.Date_+3A_length.out">length.out</code></td>
<td>
<p>integer, optional.  Desired length of the sequence.</p>
</td></tr>
<tr><td><code id="seq.Date_+3A_along.with">along.with</code></td>
<td>
<p>take the length from the length of this argument.</p>
</td></tr>
<tr><td><code id="seq.Date_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>by</code> can be specified in several ways.
</p>

<ul>
<li><p> A number, taken to be in days.
</p>
</li>
<li><p> A object of class <code><a href="#topic+difftime">difftime</a></code>
</p>
</li>
<li><p> A character string, containing one of <code>"day"</code>,
<code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>.
This can optionally be preceded by a (positive or negative) integer
and a space, or followed by <code>"s"</code>.
</p>
<p>See <code><a href="#topic+seq.POSIXt">seq.POSIXt</a></code> for the details of <code>"month"</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector of class <code>"Date"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Date">Date</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## first days of years
seq(as.Date("1910/1/1"), as.Date("1999/1/1"), "years")
## by month
seq(as.Date("2000/1/1"), by = "month", length.out = 12)
## quarters
seq(as.Date("2000/1/1"), as.Date("2003/1/1"), by = "quarter")

## find all 7th of the month between two dates, the last being a 7th.
st &lt;- as.Date("1998-12-17")
en &lt;- as.Date("2000-1-7")
ll &lt;- seq(en, st, by = "-1 month")
rev(ll[ll &gt; st &amp; ll &lt; en])
</code></pre>

<hr>
<h2 id='seq.POSIXt'>Generate Regular Sequences of Times</h2><span id='topic+seq.POSIXt'></span>

<h3>Description</h3>

<p>The method for <code><a href="#topic+seq">seq</a></code> for date-time classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXt'
seq(from, to, by, length.out = NULL, along.with = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq.POSIXt_+3A_from">from</code></td>
<td>
<p>starting date.  Required.</p>
</td></tr>
<tr><td><code id="seq.POSIXt_+3A_to">to</code></td>
<td>
<p>end date.  Optional.</p>
</td></tr>
<tr><td><code id="seq.POSIXt_+3A_by">by</code></td>
<td>
<p>increment of the sequence.  Optional.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="seq.POSIXt_+3A_length.out">length.out</code></td>
<td>
<p>integer, optional.  Desired length of the sequence.</p>
</td></tr>
<tr><td><code id="seq.POSIXt_+3A_along.with">along.with</code></td>
<td>
<p>take the length from the length of this argument.</p>
</td></tr>
<tr><td><code id="seq.POSIXt_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>by</code> can be specified in several ways.
</p>

<ul>
<li><p> A number, taken to be in seconds.
</p>
</li>
<li><p> A object of class <code><a href="#topic+difftime">difftime</a></code>
</p>
</li>
<li><p> A character string, containing one of <code>"sec"</code>,
<code>"min"</code>, <code>"hour"</code>, <code>"day"</code>, <code>"DSTday"</code>,
<code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>.
This can optionally be preceded by a (positive or negative) integer
and a space, or followed by <code>"s"</code>.
</p>
</li></ul>

<p>The difference between <code>"day"</code> and <code>"DSTday"</code> is that the
former ignores changes to/from daylight savings time and the latter takes
the same clock time each day.  <code>"week"</code> ignores DST (it is a
period of 144 hours), but <code>"7 DSTdays"</code> can be used as an
alternative.  <code>"month"</code> and <code>"year"</code> allow for DST.
</p>
<p>The <a href="#topic+time+20zone">time zone</a> of the result is taken from <code>from</code>: remember
that GMT means UTC (and not the time zone of Greenwich, England) and so
does not have daylight savings time.
</p>
<p>Using <code>"month"</code> first advances the month without changing the
day: if this results in an invalid day of the month, it is counted
forward into the next month: see the examples.
</p>


<h3>Value</h3>

<p>A vector of class <code>"POSIXct"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## first days of years
seq(ISOdate(1910,1,1), ISOdate(1999,1,1), "years")
## by month
seq(ISOdate(2000,1,1), by = "month", length.out = 12)
seq(ISOdate(2000,1,31), by = "month", length.out = 4)
## quarters
seq(ISOdate(1990,1,1), ISOdate(2000,1,1), by = "quarter") # or "3 months"
## days vs DSTdays: use c() to lose the time zone.
seq(c(ISOdate(2000,3,20)), by = "day", length.out = 10)
seq(c(ISOdate(2000,3,20)), by = "DSTday", length.out = 10)
seq(c(ISOdate(2000,3,20)), by = "7 DSTdays", length.out = 4)
</code></pre>

<hr>
<h2 id='sequence'>Create A Vector of Sequences</h2><span id='topic+sequence'></span><span id='topic+sequence.default'></span>

<h3>Description</h3>

<p>The default method for <code>sequence</code> generates the sequence
<code><a href="#topic+seq">seq</a>(from[i], by = by[i], length.out = nvec[i])</code> for each
element <code>i</code> in the parallel (and recycled) vectors <code>from</code>,
<code>by</code> and <code>nvec</code>. It then returns the result of concatenating
those sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequence(nvec, ...)
## Default S3 method:
sequence(nvec, from = 1L, by = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sequence_+3A_nvec">nvec</code></td>
<td>
<p>coerced to a non-negative integer vector each element of which
specifies the length of a sequence.</p>
</td></tr>
<tr><td><code id="sequence_+3A_from">from</code></td>
<td>
<p>coerced to an integer vector each element of which
specifies the first element of a sequence.</p>
</td></tr>
<tr><td><code id="sequence_+3A_by">by</code></td>
<td>
<p>coerced to an integer vector each element of which
specifies the step size between elements of a sequence.</p>
</td></tr>
<tr><td><code id="sequence_+3A_...">...</code></td>
<td>
<p>additional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Negative values are supported for <code>from</code> and
<code>by</code>. <code>sequence(nvec, from, by=0L)</code> is equivalent to
<code>rep(from, each=nvec)</code>.
</p>
<p>This function was originally implemented in R with fewer features, but
it has since become more flexible, and the default method is
implemented in C for speed.
</p>


<h3>Author(s)</h3>

<p>Of the current version, Michael Lawrence based on code from the
S4Vectors Bioconductor package</p>


<h3>See Also</h3>

<p><code><a href="#topic+gl">gl</a></code>, <code><a href="#topic+seq">seq</a></code>, <code><a href="#topic+rep">rep</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sequence(c(3, 2)) # the concatenated sequences 1:3 and 1:2.
#&gt; [1] 1 2 3 1 2
sequence(c(3, 2), from=2L)
#&gt; [1] 2 3 4 2 3
sequence(c(3, 2), from=2L, by=2L)
#&gt; [1] 2 4 6 2 4
sequence(c(3, 2), by=c(-1L, 1L))
#&gt; [1] 1 0 -1 1 2
</code></pre>

<hr>
<h2 id='serialize'>Simple Serialization Interface</h2><span id='topic+serialize'></span><span id='topic+unserialize'></span>

<h3>Description</h3>

<p>A simple low-level interface for serializing to connections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>serialize(object, connection, ascii, xdr = TRUE,
          version = NULL, refhook = NULL)

unserialize(connection, refhook = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="serialize_+3A_object">object</code></td>
<td>
<p><span class="rlang"><b>R</b></span> object to serialize.</p>
</td></tr>
<tr><td><code id="serialize_+3A_connection">connection</code></td>
<td>
<p>an open <a href="#topic+connection">connection</a> or (for <code>serialize</code>)
<code>NULL</code> or (for <code>unserialize</code>) a raw vector
(see &lsquo;Details&rsquo;).</p>
</td></tr>
<tr><td><code id="serialize_+3A_ascii">ascii</code></td>
<td>
<p>a logical.  If <code>TRUE</code> or <code>NA</code>, an ASCII
representation is written; otherwise (default) a binary one.
See also the comments in the help for <code><a href="#topic+save">save</a></code>.</p>
</td></tr>
<tr><td><code id="serialize_+3A_xdr">xdr</code></td>
<td>
<p>a logical: if a binary representation is used, should a
big-endian one (XDR) be used?</p>
</td></tr>
<tr><td><code id="serialize_+3A_version">version</code></td>
<td>
<p>the workspace format version to use.  <code>NULL</code>
specifies the current default version (3). The only other supported
value is 2, the default from <span class="rlang"><b>R</b></span> 1.4.0 to <span class="rlang"><b>R</b></span> 3.5.0.</p>
</td></tr>
<tr><td><code id="serialize_+3A_refhook">refhook</code></td>
<td>
<p>a hook function for handling reference objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>serialize</code> serializes <code>object</code> to the specified
connection.  If <code>connection</code> is <code>NULL</code> then <code>object</code> is
serialized to a raw vector, which is returned as the result of
<code>serialize</code>.
</p>
<p>Sharing of reference objects is preserved within the object but not
across separate calls to <code>serialize</code>.
</p>
<p><code>unserialize</code> reads an object (as written by <code>serialize</code>)
from <code>connection</code> or a raw vector.
</p>
<p>The <code>refhook</code> functions can be used to customize handling of
non-system reference objects (all external pointers and weak
references, and all environments other than namespace and package
environments and <code>.GlobalEnv</code>).  The hook function for
<code>serialize</code> should return a character vector for references it
wants to handle; otherwise it should return <code>NULL</code>.  The hook for
<code>unserialize</code> will be called with character vectors supplied to
<code>serialize</code> and should return an appropriate object.
</p>
<p>For a text-mode connection, the default value of <code>ascii</code> is set
to <code>TRUE</code>: only ASCII representations can be written to text-mode
connections and attempting to use <code>ascii = FALSE</code> will throw an
error.
</p>
<p>The format consists of a single line followed by the data: the first
line contains a single character: <code>X</code> for binary serialization
and <code>A</code> for ASCII serialization, followed by a new line.  (The
format used is identical to that used by <code><a href="#topic+readRDS">readRDS</a></code>.)
</p>
<p>As almost all systems in current use are little-endian, <code>xdr =
  FALSE</code> can be used to avoid byte-shuffling at both ends when
transferring data from one little-endian machine to another (or
between processes on the same machine).  Depending on the system, this
can speed up serialization and unserialization by a factor of up to
3x.
</p>


<h3>Value</h3>

<p>For <code>serialize</code>, <code>NULL</code> unless <code>connection = NULL</code>, when
the result is returned in a raw vector.
</p>
<p>For <code>unserialize</code> an <span class="rlang"><b>R</b></span> object.
</p>


<h3>Warning</h3>

<p>These functions have provided a stable interface since <span class="rlang"><b>R</b></span> 2.4.0 (when
the storage of serialized objects was changed from character to raw
vectors).  However, the serialization format may change in future
versions of <span class="rlang"><b>R</b></span>, so this interface should not be used for long-term
storage of <span class="rlang"><b>R</b></span> objects.
</p>
<p>On 32-bit platforms a raw vector is limited to <code class="reqn">2^{31} - 1</code> bytes, but <span class="rlang"><b>R</b></span> objects can exceed this and their serializations will
normally be larger than the objects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saveRDS">saveRDS</a></code> for a more convenient interface to serialize an
object to a file or connection.
</p>
<p><code><a href="#topic+save">save</a></code> and <code><a href="#topic+load">load</a></code> to serialize and restore one
or more named objects.
</p>
<p>The &lsquo;R Internals&rsquo; manual for details of the format used.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- serialize(list(1,2,3), NULL)
unserialize(x)

## see also the examples for saveRDS
</code></pre>

<hr>
<h2 id='sets'>Set Operations</h2><span id='topic+union'></span><span id='topic+intersect'></span><span id='topic+setdiff'></span><span id='topic+is.element'></span><span id='topic+setequal'></span><span id='topic+intersection'></span>

<h3>Description</h3>

<p>Performs <b>set</b> union, intersection, (asymmetric!) difference,
equality and membership on two vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>union(x, y)
intersect(x, y)
setdiff(x, y)
setequal(x, y)

is.element(el, set)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sets_+3A_x">x</code>, <code id="sets_+3A_y">y</code>, <code id="sets_+3A_el">el</code>, <code id="sets_+3A_set">set</code></td>
<td>
<p>vectors (of the same mode) containing a sequence
of items (conceptually) with no duplicated values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of <code>union</code>, <code>intersect</code>, <code>setdiff</code> and
<code>setequal</code> will discard any duplicated values in the arguments,
and they apply <code><a href="#topic+as.vector">as.vector</a></code> to their arguments (and so
in particular coerce factors to character vectors).
</p>
<p><code>is.element(x, y)</code> is identical to <code>x %in% y</code>.
</p>


<h3>Value</h3>

<p>For <code>union</code>, a vector of a common mode.
</p>
<p>For <code>intersect</code>, a vector of a common mode, or <code>NULL</code> if
<code>x</code> or <code>y</code> is <code>NULL</code>.
</p>
<p>For <code>setdiff</code>, a vector of the same <code><a href="#topic+mode">mode</a></code> as <code>x</code>.
</p>
<p>A logical scalar for <code>setequal</code> and a logical of the same
length as <code>x</code> for <code>is.element</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic++25in+25">%in%</a></code>
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>union</code> and
<code>intersect</code> in plot annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(x &lt;- c(sort(sample(1:20, 9)), NA))
(y &lt;- c(sort(sample(3:23, 7)), NA))
union(x, y)
intersect(x, y)
setdiff(x, y)
setdiff(y, x)
setequal(x, y)

## True for all possible x &amp; y :
setequal( union(x, y),
          c(setdiff(x, y), intersect(x, y), setdiff(y, x)))

is.element(x, y) # length 10
is.element(y, x) # length  8
</code></pre>

<hr>
<h2 id='setTimeLimit'>Set CPU and/or Elapsed Time Limits</h2><span id='topic+setTimeLimit'></span><span id='topic+setSessionTimeLimit'></span>

<h3>Description</h3>

<p>Functions to set CPU and/or elapsed time limits for top-level
computations or the current session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setTimeLimit(cpu = Inf, elapsed = Inf, transient = FALSE)

setSessionTimeLimit(cpu = Inf, elapsed = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setTimeLimit_+3A_cpu">cpu</code>, <code id="setTimeLimit_+3A_elapsed">elapsed</code></td>
<td>
<p>double (of length one).  Set a limit on
the total or elapsed CPU time in seconds, respectively.</p>
</td></tr>
<tr><td><code id="setTimeLimit_+3A_transient">transient</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the limits apply only to
the rest of the current computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>setTimeLimit</code> sets limits which apply to each top-level
computation, that is a command line (including any continuation lines)
entered at the console or from a file.  If it is called from within a
computation the limits apply to the rest of the computation and
(unless <code>transient = TRUE</code>) to subsequent top-level computations.
</p>
<p><code>setSessionTimeLimit</code> sets limits for the rest of the
session.  Once a session limit is reached it is reset to <code>Inf</code>.
</p>
<p>Setting any limit has a small overhead &ndash; well under 1% on the
systems measured.
</p>
<p>Time limits are checked whenever a user interrupt could occur.
This will happen frequently in <span class="rlang"><b>R</b></span> code and during <code><a href="#topic+Sys.sleep">Sys.sleep</a></code>,
but only at points in compiled C and Fortran code identified by the
code author.
</p>
<p>&lsquo;Total CPU time&rsquo; includes that used by child processes where
the latter is reported.
</p>

<hr>
<h2 id='showConnections'>Display Connections</h2><span id='topic+showConnections'></span><span id='topic+getConnection'></span><span id='topic+getAllConnections'></span><span id='topic+closeAllConnections'></span><span id='topic+stdin'></span><span id='topic+stdout'></span><span id='topic+stderr'></span><span id='topic+nullfile'></span><span id='topic+isatty'></span>

<h3>Description</h3>

<p>Display aspects of <a href="#topic+connections">connections</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showConnections(all = FALSE)
getConnection(what)
closeAllConnections()

stdin()
stdout()
stderr()
nullfile()

isatty(con)

getAllConnections()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showConnections_+3A_all">all</code></td>
<td>
<p>logical: if true all connections, including closed ones
and the standard ones are displayed.  If false only open user-created
connections are included.</p>
</td></tr>
<tr><td><code id="showConnections_+3A_what">what</code></td>
<td>
<p>integer: a row number of the table given by
<code>showConnections</code>.</p>
</td></tr>
<tr><td><code id="showConnections_+3A_con">con</code></td>
<td>
<p>a connection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>stdin()</code>, <code>stdout()</code> and <code>stderr()</code> are standard
connections corresponding to input, output and error on the console
respectively (and not necessarily to file streams).  They are text-mode
connections of class <code>"terminal"</code> which cannot be opened or
closed, and are read-only, write-only and write-only respectively.
The <code>stdout()</code> and <code>stderr()</code> connections can be
re-directed by <code><a href="#topic+sink">sink</a></code> (and in some circumstances the
output from <code>stdout()</code> can be split: see the help page).
</p>
<p>The encoding for <code><a href="#topic+stdin">stdin</a>()</code> when redirected can
be set by the command-line flag <span class="option">--encoding</span>.
</p>
<p><code>nullfile()</code> returns filename of the null device (<code>"/dev/null"</code>
on Unix, <code>"nul:"</code> on Windows).
</p>
<p><code>showConnections</code> returns a matrix of information.  If a
connection object has been lost or forgotten, <code>getConnection</code>
will take a row number from the table and return a connection object
for that connection, which can be used to close the connection,
for example.  However, if there is no <span class="rlang"><b>R</b></span> level object referring to the
connection it will be closed automatically at the next garbage
collection (except for <code><a href="#topic+gzcon">gzcon</a></code> connections).
</p>
<p><code>closeAllConnections</code> closes (and destroys) all user
connections, restoring all <code><a href="#topic+sink">sink</a></code> diversions as it does
so.
</p>
<p><code>isatty</code> returns true if the connection is one of the class
<code>"terminal"</code> connections and it is apparently connected to a
terminal, otherwise false.  This may not be reliable in embedded
applications, including GUI consoles.
</p>
<p><code>getAllConnections</code> returns a sequence of integer connection
descriptors for use with <code>getConnection</code>, corresponding to the
row names of the table returned by <code>showConnections(all =
  TRUE)</code>. 
</p>


<h3>Value</h3>

<p><code>stdin()</code>, <code>stdout()</code> and <code>stderr()</code> return connection
objects.
</p>
<p><code>showConnections</code> returns a character matrix of information with
a row for each connection, by default only for open non-standard connections.
</p>
<p><code>getConnection</code> returns a connection object, or <code>NULL</code>.
</p>


<h3>Note</h3>

<p><code>stdin()</code> refers to the &lsquo;console&rsquo; and not to the C-level
&lsquo;<span class="file">stdin</span>&rsquo; of the process.  The distinction matters in GUI consoles
(which may not have an active &lsquo;<span class="file">stdin</span>&rsquo;, and if they do it may not
be connected to console input), and also in embedded applications.
If you want access to the C-level file stream &lsquo;<span class="file">stdin</span>&rsquo;, use
<code><a href="#topic+file">file</a>("stdin")</code>.
</p>
<p>When <span class="rlang"><b>R</b></span> is reading a script from a file, the <em>file</em> is the
&lsquo;console&rsquo;: this is traditional usage to allow in-line data (see
&lsquo;An Introduction to R&rsquo; for an example).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>showConnections(all = TRUE)
## Not run: 
textConnection(letters)
# oops, I forgot to record that one
showConnections()
#  class     description      mode text   isopen   can read can write
#3 "letters" "textConnection" "r"  "text" "opened" "yes"    "no"
mycon &lt;- getConnection(3)

## End(Not run)

c(isatty(stdin()), isatty(stdout()), isatty(stderr()))
</code></pre>

<hr>
<h2 id='shQuote'>Quote Strings for Use in OS Shells</h2><span id='topic+shQuote'></span>

<h3>Description</h3>

<p>Quote a string to be passed to an operating system shell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shQuote(string, type = c("sh", "csh", "cmd", "cmd2"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shQuote_+3A_string">string</code></td>
<td>
<p>a character vector, usually of length one.</p>
</td></tr>
<tr><td><code id="shQuote_+3A_type">type</code></td>
<td>
<p>character: the type of shell quoting.  Partial matching is
supported.  <code>"cmd"</code> and <code>"cmd2"</code> refer to the Windows shell.
<code>"cmd"</code> is the default under Windows.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The default type of quoting supported under Unix-alikes is that for
the Bourne shell <code>sh</code>.  If the string does not contain single
quotes, we can just surround it with single quotes.  Otherwise, the
string is surrounded in double quotes, which suppresses all special
meanings of metacharacters except dollar, backquote and backslash, so
these (and of course double quote) are preceded by backslash.  This
type of quoting is also appropriate for <code>bash</code>, <code>ksh</code> and
<code>zsh</code>.
</p>
<p>The other type of quoting is for the C-shell (<code>csh</code> and
<code>tcsh</code>).  Once again, if the string does not contain single
quotes, we can just surround it with single quotes.  If it does
contain single quotes, we can use double quotes provided it does not
contain dollar or backquote (and we need to escape backslash,
exclamation mark and double quote).  As a last resort, we need to
split the string into pieces not containing single quotes (some may be
empty) and surround each with single quotes, and the single quotes
with double quotes.
</p>
<p>In Windows, command line interpretation is done by the application as well
as the shell.  It may depend on the compiler used: Microsoft's rules for
the C run-time are given at
<a href="https://learn.microsoft.com/en-us/cpp/c-language/parsing-c-command-line-arguments?view=msvc-160">https://learn.microsoft.com/en-us/cpp/c-language/parsing-c-command-line-arguments?view=msvc-160</a>. 
It may depend on the whim of the programmer of the application: check its
documentation.  The <code>type = "cmd"</code> prepares the string for parsing as
an argument by the Microsoft's rules and makes <code>shQuote</code> safe for use
with many applications when used with <code><a href="#topic+system">system</a></code> or
<code><a href="#topic+system2">system2</a></code>.  It surrounds the string by double quotes and
escapes internal double quotes by a backslash.  Any trailing backslashes
and backslashes that were originally before double quotes are doubled.
</p>
<p>The Windows
<code>cmd.exe</code> shell (used by default with <code><a href="#topic+shell">shell</a></code>)
uses <code>type = "cmd2"</code> quoting:  special characters are prefixed
with <code>"^"</code>.  In some cases, two types of quoting should be
used:  first for the application, and then <code>type = "cmd2"</code> 
for <code>cmd.exe</code>.  See the examples below.  
</p>


<h3>Value</h3>

<p>A character vector of the same length as <code>string</code>.
</p>


<h3>References</h3>

<p> Loukides, M. <em>et al</em> (2002) <em>Unix Power Tools</em>
Third Edition. O'Reilly.  Section 27.12.
</p>
<p>Discussion in <a href="https://bugs.R-project.org/show_bug.cgi?id=16636">PR#16636</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+Quotes">Quotes</a> for quoting <span class="rlang"><b>R</b></span> code.
</p>
<p><code><a href="#topic+sQuote">sQuote</a></code> for quoting English text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- "abc$def`gh`i\\j"
cat(shQuote(test), "\n")
## Not run: system(paste("echo", shQuote(test)))
test &lt;- "don't do it!"
cat(shQuote(test), "\n")

tryit &lt;- paste("use the", sQuote("-c"), "switch\nlike this")
cat(shQuote(tryit), "\n")
## Not run: system(paste("echo", shQuote(tryit)))
cat(shQuote(tryit, type = "csh"), "\n")

## Windows-only example, assuming cmd.exe:
perlcmd &lt;- 'print "Hello World\\n";'
## Not run: 
shell(shQuote(paste("perl -e", 
                    shQuote(perlcmd, type = "cmd")),
              type = "cmd2"))

## End(Not run)
</code></pre>

<hr>
<h2 id='sign'>Sign Function</h2><span id='topic+sign'></span>

<h3>Description</h3>

<p><code>sign</code> returns a vector with the signs of the corresponding
elements of <code>x</code> (the sign of a real number is 1, 0, or <code class="reqn">-1</code>
if the number is positive, zero, or negative, respectively).
</p>
<p>Note that <code>sign</code> does not operate on complex vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sign(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sign_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a> function: methods
can be defined for it directly or via the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generic.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+abs">abs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sign(pi)    # == 1
sign(-2:3)  # -1 -1 0 1 1 1
</code></pre>

<hr>
<h2 id='Signals'>Interrupting Execution of R</h2><span id='topic+Signals'></span>

<h3>Description</h3>

<p>On receiving <code>SIGUSR1</code> <span class="rlang"><b>R</b></span> will save the workspace and quit.
<code>SIGUSR2</code> has the same result except that the <code><a href="#topic+.Last">.Last</a></code>
function and <code><a href="#topic+on.exit">on.exit</a></code> expressions will not be called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kill -USR1 pid
kill -USR2 pid
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Signals_+3A_pid">pid</code></td>
<td>
<p>The process ID of the <span class="rlang"><b>R</b></span> process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The commands history will also be saved if would be at normal
termination.
</p>
<p>This is not available on Windows, and possibly on other OSes which do
not support these signals.
</p>


<h3>Warning</h3>

<p>It is possible that one or more <span class="rlang"><b>R</b></span> objects will be undergoing
modification at the time the signal is sent.  These objects could be
saved in a corrupted form.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.getpid">Sys.getpid</a></code> to report the process ID for future use.
</p>

<hr>
<h2 id='sink'>Send R Output to a File</h2><span id='topic+sink'></span><span id='topic+sink.number'></span>

<h3>Description</h3>

<p><code>sink</code> diverts <span class="rlang"><b>R</b></span> output to a connection (and stops such diversions).
</p>
<p><code>sink.number()</code> reports how many diversions are in use.
</p>
<p><code>sink.number(type = "message")</code> reports the number of the
connection currently being used for error messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sink(file = NULL, append = FALSE, type = c("output", "message"),
     split = FALSE)

sink.number(type = c("output", "message"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sink_+3A_file">file</code></td>
<td>
<p>a writable <a href="#topic+connection">connection</a> or a character string naming the
file to write to, or <code>NULL</code> to stop sink-ing.</p>
</td></tr>
<tr><td><code id="sink_+3A_append">append</code></td>
<td>
<p>logical.  If <code>TRUE</code>, output will be appended to
<code>file</code>; otherwise, it will overwrite the contents of
<code>file</code>.</p>
</td></tr>
<tr><td><code id="sink_+3A_type">type</code></td>
<td>
<p>character string.  Either the output stream or the messages
stream.  The name will be partially matched so can be abbreviated.</p>
</td></tr>
<tr><td><code id="sink_+3A_split">split</code></td>
<td>
<p>logical: if <code>TRUE</code>, output will be sent to the new
sink and to the current output stream, like the Unix program <code>tee</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sink</code> diverts <span class="rlang"><b>R</b></span> output to a connection (and must be used again
to finish such a diversion, see below!).  If <code>file</code> is a
character string, a file connection with that name will be established
for the duration of the diversion.
</p>
<p>Normal <span class="rlang"><b>R</b></span> output (to connection <code><a href="#topic+stdout">stdout</a></code>) is diverted by
the default <code>type = "output"</code>.  Only prompts and (most)
messages continue to appear on the console.  Messages sent to
<code><a href="#topic+stderr">stderr</a>()</code> (including those from <code><a href="#topic+message">message</a></code>,
<code><a href="#topic+warning">warning</a></code> and <code><a href="#topic+stop">stop</a></code>) can be diverted by
<code>sink(type = "message")</code> (see below).
</p>
<p><code>sink()</code> or <code>sink(file = NULL)</code> ends the last diversion (of
the specified type).  There is a stack of diversions for normal
output, so output reverts to the previous diversion (if there was
one).  The stack is of up to 21 connections (20 diversions).
</p>
<p>If <code>file</code> is a connection it will be opened if necessary (in
<code>"wt"</code> mode) and closed once it is removed from the stack of
diversions.
</p>
<p><code>split = TRUE</code> only splits <span class="rlang"><b>R</b></span> output (via <code>Rvprintf</code>) and
the default output from <code><a href="#topic+writeLines">writeLines</a></code>: it does not split
all output that might be sent to <code><a href="#topic+stdout">stdout</a>()</code>.
</p>
<p>Sink-ing the messages stream should be done only with great care.
For that stream <code>file</code> must be an already open connection, and
there is no stack of connections.
</p>
<p>If <code>file</code> is a character string, the file will be opened using
the current encoding.  If you want a different encoding (e.g., to
represent strings which have been stored in UTF-8), use a
<code><a href="#topic+file">file</a></code> connection &mdash; but some ways to produce <span class="rlang"><b>R</b></span> output
will already have converted such strings to the current encoding.
</p>


<h3>Value</h3>

<p><code>sink</code> returns <code>NULL</code>.
</p>
<p>For <code>sink.number()</code> the number (0, 1, 2, ...) of diversions of
output in place.
</p>
<p>For <code>sink.number("message")</code> the connection number used for
messages, 2 if no diversion has been used.
</p>


<h3>Warning</h3>

<p>Do not use a connection that is open for <code>sink</code> for any other
purpose.  The software will stop you closing one such inadvertently.
</p>
<p>Do not sink the messages stream unless you understand the source code
implementing it and hence the pitfalls.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+capture.output">capture.output</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>sink("sink-examp.txt")
i &lt;- 1:10
outer(i, i)
sink()


## capture all the output to a file.
zz &lt;- file("all.Rout", open = "wt")
sink(zz)
sink(zz, type = "message")
try(log("a"))
## revert output back to the console -- only then access the file!
sink(type = "message")
sink()
file.show("all.Rout", delete.file = TRUE)
</code></pre>

<hr>
<h2 id='slice.index'>Slice Indexes in an Array</h2><span id='topic+slice.index'></span>

<h3>Description</h3>

<p>Returns a matrix of integers indicating the number of their slice in a
given array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice.index(x, MARGIN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice.index_+3A_x">x</code></td>
<td>
<p>an array.  If <code>x</code> has no dimension attribute, it is
considered a one-dimensional array.</p>
</td></tr>
<tr><td><code id="slice.index_+3A_margin">MARGIN</code></td>
<td>
<p>an integer vector giving the dimension numbers to slice 
by.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>MARGIN</code> gives a single dimension, then all elements of slice
number <code>i</code> with respect to this have value <code>i</code>.  In general,
slice numbers are obtained by numbering all combinations of indices in
the dimensions given by <code>MARGIN</code> in column-major order.  I.e.,
with <code class="reqn">m_1</code>, ..., <code class="reqn">m_k</code> the dimension numbers (elements of
<code>MARGIN</code>) sliced by and <code class="reqn">d_{m_1}</code>, ..., <code class="reqn">d_{m_k}</code> the
corresponding extents, and <code class="reqn">n_1 = 1</code>, <code class="reqn">n_2 = d_{m_1}</code>, ...,
<code class="reqn">n_k = d_{m_1} \cdots d_{m_{k-1}}</code>,
the number of the slice where dimension <code class="reqn">m_1</code> has value <code class="reqn">i_1</code>,
..., dimension <code class="reqn">m_k</code> has value <code class="reqn">i_k</code> is 
<code class="reqn">1 + n_1 (i_1 - 1) + \cdots + n_k (i_k - 1)</code>.
</p>


<h3>Value</h3>

<p>An integer array <code>y</code> with dimensions corresponding to those of
<code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+row">row</a></code> and <code><a href="#topic+col">col</a></code> for determining row and column
indexes; in fact, these are special cases of <code>slice.index</code>
corresponding to <code>MARGIN</code> equal to 1 and 2, respectively when
<code>x</code> is a matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- array(1 : 24, c(2, 3, 4))
slice.index(x, 2)
slice.index(x, c(1, 3))
## When slicing by dimensions 1 and 3, slice index 5 is obtained for
## dimension 1 has value 1 and dimension 3 has value 3 (see above):
which(slice.index(x, c(1, 3)) == 5, arr.ind = TRUE)
</code></pre>

<hr>
<h2 id='slotOp'>Extract or Replace a Slot or Property</h2><span id='topic++40'></span><span id='topic++40+3C-'></span>

<h3>Description</h3>

<p>Extract or replace the contents of a slot or property of an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>object@name
object@name &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slotOp_+3A_object">object</code></td>
<td>
<p>An object from a formally defined (S4) class, or an
object with a class for which '@' or '@&lt;-' S3 methods are defined.</p>
</td></tr>
<tr><td><code id="slotOp_+3A_name">name</code></td>
<td>
<p>The name of the slot or property, supplied as a character
string or unquoted symbol. If <code>object</code> has an S4 class, then
<code>name</code> must be the name of a slot in the definition of the class
of <code>object</code>.</p>
</td></tr>
<tr><td><code id="slotOp_+3A_value">value</code></td>
<td>
<p>A suitable replacement value for the slot or
property. For an S4 object this must be from a class compatible
with the class defined for this slot in the definition of the class
of <code>object</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>object</code> is not an S4 object, then a suitable S3 method for
'@' or '@&lt;-' is searched for. If no method is found, then an error
is signaled.
</p>
<p>if <code>object</code> is an S4 object, then these operators are for slot
access, and are enabled only when package <span class="pkg">methods</span> is loaded (as
per default).  The slot must be formally defined. (There is an
exception for the name <code>.Data</code>, intended for internal use only.)
The replacement operator checks that the slot already exists on the
object (which it should if the object is really from the class it
claims to be).  See <code><a href="methods.html#topic+slot">slot</a></code> for further details, in
particular for the differences between <code>slot()</code> and the <code>@</code>
operator.
</p>
<p>These are internal generic operators: see <a href="#topic+InternalMethods">InternalMethods</a>.
</p>


<h3>Value</h3>

<p>The current contents of the slot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Extract">Extract</a></code>, <code><a href="methods.html#topic+slot">slot</a></code>
</p>

<hr>
<h2 id='socketSelect'>Wait on Socket Connections</h2><span id='topic+socketSelect'></span>

<h3>Description</h3>

<p>Waits for the first of several socket connections and server sockets
to become available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>socketSelect(socklist, write = FALSE, timeout = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="socketSelect_+3A_socklist">socklist</code></td>
<td>
<p>list of open socket connections and server sockets.</p>
</td></tr>
<tr><td><code id="socketSelect_+3A_write">write</code></td>
<td>
<p>logical.  If <code>TRUE</code> wait for corresponding socket to
become available for writing; otherwise wait for it to become
available for reading or for accepting an incoming
connection (server sockets).</p>
</td></tr>
<tr><td><code id="socketSelect_+3A_timeout">timeout</code></td>
<td>
<p>numeric or <code>NULL</code>. Time in seconds to wait for a
socket to become available; <code>NULL</code> means wait
indefinitely.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values in <code>write</code> are recycled if necessary to make up a
logical vector the same length as <code>socklist</code>. Socket connections
can appear more than once in <code>socklist</code>; this can be useful if
you want to determine whether a socket is available for reading or
writing.
</p>


<h3>Value</h3>

<p>Logical the same length as <code>socklist</code> indicating
whether the corresponding socket connection is available for
output or input, depending on the corresponding value of <code>write</code>.
Server sockets can only become available for input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## test whether socket connection s is available for writing or reading
socketSelect(list(s, s), c(TRUE, FALSE), timeout = 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='solve'>Solve a System of Equations</h2><span id='topic+solve'></span><span id='topic+solve.default'></span>

<h3>Description</h3>

<p>This generic function solves the equation <code>a %*% x = b</code> for <code>x</code>,
where <code>b</code> can be either a vector or a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve(a, b, ...)

## Default S3 method:
solve(a, b, tol, LINPACK = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solve_+3A_a">a</code></td>
<td>
<p>a square numeric or complex matrix containing the coefficients of
the linear system.  Logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="solve_+3A_b">b</code></td>
<td>
<p>a numeric or complex vector or matrix giving the right-hand
side(s) of the linear system.  If missing, <code>b</code> is taken to be
an identity matrix and <code>solve</code> will return the inverse of <code>a</code>.</p>
</td></tr>
<tr><td><code id="solve_+3A_tol">tol</code></td>
<td>
<p>the tolerance for detecting linear dependencies in the
columns of <code>a</code>.  The default is <code>.Machine$double.eps</code>.</p>
</td></tr>
<tr><td><code id="solve_+3A_linpack">LINPACK</code></td>
<td>
<p>logical.  Defunct and an error.</p>
</td></tr>
<tr><td><code id="solve_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>a</code> or <code>b</code> can be complex, but this uses double complex
arithmetic which might not be available on all platforms.
</p>
<p>The row and column names of the result are taken from the column names
of <code>a</code> and of <code>b</code> respectively.  If <code>b</code> is missing the
column names of the result are the row names of <code>a</code>.  No check is
made that the column names of <code>a</code> match the row names of <code>b</code>.
</p>
<p>For back-compatibility <code>a</code> can be a (real) QR decomposition,
although <code><a href="#topic+qr.solve">qr.solve</a></code> should be called in that case.
<code><a href="#topic+qr.solve">qr.solve</a></code> can handle non-square systems.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code: these can only be interpreted by
detailed study of the FORTRAN code.
</p>
<p>What happens if <code>a</code> and/or <code>b</code> contain missing, <code>NaN</code>
or infinite values is platform-dependent, including on the version of
LAPACK is in use.
</p>
<p><code>tol</code> is a tolerance for the (estimated 1-norm)
&lsquo;reciprocal condition number&rsquo;: the check is skipped if
<code>tol &lt;= 0</code>.
</p>
<p>For historical reasons, the default method accepts <code>a</code> as an
object of class <code>"<a href="#topic+qr">qr</a>"</code> (with a warning) and passes it on to
<code><a href="#topic+solve.qr">solve.qr</a></code>.
</p>


<h3>Source</h3>

<p>The default method is an interface to the LAPACK routines <code>DGESV</code>
and <code>ZGESV</code>.
</p>
<p>LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a>.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition. SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+solve.qr">solve.qr</a></code> for the <code>qr</code> method,
<code><a href="#topic+chol2inv">chol2inv</a></code> for inverting from the Cholesky factor
<code><a href="#topic+backsolve">backsolve</a></code>, <code><a href="#topic+qr.solve">qr.solve</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, `+`) }
h8 &lt;- hilbert(8); h8
sh8 &lt;- solve(h8)
round(sh8 %*% h8, 3)

A &lt;- hilbert(4)
A[] &lt;- as.complex(A)
## might not be supported on all platforms
try(solve(A))
</code></pre>

<hr>
<h2 id='sort'>Sorting or Ordering Vectors</h2><span id='topic+sort'></span><span id='topic+sort.default'></span><span id='topic+sort.POSIXlt'></span><span id='topic+sort.int'></span>

<h3>Description</h3>

<p>Sort (or <em>order</em>) a vector or factor (partially) into
ascending or descending order.  For ordering along more than one
variable, e.g., for sorting data frames, see <code><a href="#topic+order">order</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort(x, decreasing = FALSE, ...)

## Default S3 method:
sort(x, decreasing = FALSE, na.last = NA, ...)

sort.int(x, partial = NULL, na.last = NA, decreasing = FALSE,
         method = c("auto", "shell", "quick", "radix"), index.return = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sort_+3A_x">x</code></td>
<td>
<p>for <code>sort</code> an <span class="rlang"><b>R</b></span> object with a class or a numeric,
complex, character or logical vector.  For <code>sort.int</code>, a
numeric, complex, character or logical vector, or a factor.</p>
</td></tr>
<tr><td><code id="sort_+3A_decreasing">decreasing</code></td>
<td>
<p>logical.  Should the sort be increasing or decreasing?
Not available for partial sorting.</p>
</td></tr>
<tr><td><code id="sort_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from methods or (for the
default methods and objects without a class) to <code>sort.int</code>.</p>
</td></tr>
<tr><td><code id="sort_+3A_na.last">na.last</code></td>
<td>
<p>for controlling the treatment of <code>NA</code>s.
If <code>TRUE</code>, missing values in the data are put last; if
<code>FALSE</code>, they are put first; if <code>NA</code>, they are removed.</p>
</td></tr>
<tr><td><code id="sort_+3A_partial">partial</code></td>
<td>
<p><code>NULL</code> or a  vector of indices for partial sorting.</p>
</td></tr>
<tr><td><code id="sort_+3A_method">method</code></td>
<td>
<p>character string specifying the algorithm used.  Not
available for partial sorting.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="sort_+3A_index.return">index.return</code></td>
<td>
<p>logical indicating if the ordering index vector should
be returned as well. Supported by <code>method == "radix"</code> for any
<code>na.last</code> mode and data type, and the other methods when
<code>na.last = NA</code> (the default) and fully sorting non-factors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sort</code> is a generic function for which methods can be written,
and <code>sort.int</code> is the internal method which is compatible
with S if only the first three arguments are used.
</p>
<p>The default <code>sort</code> method makes use of <code><a href="#topic+order">order</a></code> for
classed objects, which in turn makes use of the generic function
<code><a href="#topic+xtfrm">xtfrm</a></code> (and can be slow unless a <code>xtfrm</code> method has
been defined or <code><a href="#topic+is.numeric">is.numeric</a>(x)</code> is true).
</p>
<p>Complex values are sorted first by the real part, then the imaginary
part.
</p>
<p>The <code>"auto"</code> method selects <code>"radix"</code> for short (less than
<code class="reqn">2^{31}</code> elements) numeric vectors, integer vectors, logical
vectors and factors; otherwise, <code>"shell"</code>.
</p>
<p>Except for method <code>"radix"</code>,
the sort order for character vectors will depend on the collating
sequence of the locale in use: see <code><a href="#topic+Comparison">Comparison</a></code>.
The sort order for factors is the order of their levels (which is
particularly appropriate for ordered factors).
</p>
<p>If <code>partial</code> is not <code>NULL</code>, it is taken to contain indices
of elements of the result which are to be placed in their correct
positions in the sorted array by partial sorting.  For each of the
result values in a specified position, any values smaller than that
one are guaranteed to have a smaller index in the sorted array and any
values which are greater are guaranteed to have a bigger index in the
sorted array.  (This is included for efficiency, and many of the
options are not available for partial sorting.  It is only
substantially more efficient if <code>partial</code> has a handful of
elements, and a full sort is done (a Quicksort if possible) if there
are more than 10.)  Names are discarded for partial sorting.
</p>
<p>Method <code>"shell"</code> uses Shellsort (an <code class="reqn">O(n^{4/3})</code> variant from
Sedgewick (1986)).  If <code>x</code> has names a stable modification is
used, so ties are not reordered.  (This only matters if names are
present.)
</p>
<p>Method <code>"quick"</code> uses Singleton (1969)'s implementation of
Hoare's Quicksort method and is only available when <code>x</code> is
numeric (double or integer) and <code>partial</code> is <code>NULL</code>.  (For
other types of <code>x</code> Shellsort is used, silently.)  It is normally
somewhat faster than Shellsort (perhaps 50% faster on vectors of
length a million and twice as fast at a billion) but has poor
performance in the rare worst case.  (Peto's modification using a
pseudo-random midpoint is used to make the worst case rarer.)  This is
not a stable sort, and ties may be reordered.
</p>
<p>Method <code>"radix"</code> relies on simple hashing to scale time linearly
with the input size, i.e., its asymptotic time complexity is O(n). The
specific variant and its implementation originated from the data.table
package and are due to Matt Dowle and Arun Srinivasan.  For small
inputs (&lt; 200), the implementation uses an insertion sort (O(n^2))
that operates in-place to avoid the allocation overhead of the radix
sort. For integer vectors of range less than 100,000, it switches to a
simpler and faster linear time counting sort. In all cases, the sort
is stable; the order of ties is preserved. It is the default method
for integer vectors and factors.
</p>
<p>The <code>"radix"</code> method generally outperforms the other methods,
especially for small integers.  Compared to quick sort, it is slightly
faster for vectors with large integer or real values (but unlike quick
sort, radix is stable and supports all <code>na.last</code> options). The
implementation is orders of magnitude faster than shell sort for
character vectors, but collation <em>does not respect the
locale</em> and so gives incorrect answers even in English locales.
</p>
<p>However, there are some caveats for the radix sort:
</p>

<ul>
<li>
<p>If <code>x</code> is a <code>character</code> vector, all elements must share
the same encoding.  Only UTF-8 (including ASCII) and Latin-1
encodings are supported.  Collation follows that with
<span class="env">LC_COLLATE=C</span>, that is lexicographically byte-by-byte using
numerical ordering of bytes.
</p>
</li>
<li>
<p><a href="#topic+Long+20vectors">Long vectors</a> (with <code class="reqn">2^{31}</code> or more elements)
and <code>complex</code> vectors are not supported.
</p>
</li></ul>



<h3>Value</h3>

<p>For <code>sort</code>, the result depends on the S3 method which is
dispatched.  If <code>x</code> does not have a class <code>sort.int</code> is used
and it description applies.  For classed objects which do not have a
specific method the default method will be used and is equivalent to
<code>x[order(x, ...)]</code>: this depends on the class having a suitable
method for <code>[</code> (and also that <code><a href="#topic+order">order</a></code> will work,
which requires a <code><a href="#topic+xtfrm">xtfrm</a></code> method).
</p>
<p>For <code>sort.int</code> the value is the sorted vector unless
<code>index.return</code> is true, when the result is a list with components
named <code>x</code> and <code>ix</code> containing the sorted numbers and the
ordering index vector.  In the latter case, if <code>method ==
    "quick"</code> ties may be reversed in the ordering (unlike
<code>sort.list</code>) as quicksort is not stable.  For <code>method ==
  "radix"</code>, <code>index.return</code> is supported for all <code>na.last</code>
modes. The other methods only support <code>index.return</code>
when <code>na.last</code> is <code>NA</code>. The index vector
refers to element numbers <em>after removal of <code>NA</code>s</em>: see
<code><a href="#topic+order">order</a></code> if you want the original element numbers.
</p>
<p>All attributes are removed from the return value (see Becker
<abbr>et al.</abbr>, 1988, p.146) except names, which are sorted.  (If
<code>partial</code> is specified even the names are removed.)  Note that
this means that the returned value has no class, except for factors
and ordered factors (which are treated specially and whose result is
transformed back to the original class).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988).
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Knuth, D. E. (1998).
<em>The Art of Computer Programming, Volume 3: Sorting and
Searching</em>, 2nd ed.
Addison-Wesley.
</p>
<p>Sedgewick, R. (1986).
A new upper bound for Shellsort.
<em>Journal of Algorithms</em>, <b>7</b>, 159&ndash;173.
<a href="https://doi.org/10.1016/0196-6774%2886%2990001-5">doi:10.1016/0196-6774(86)90001-5</a>.
</p>
<p>Singleton, R. C. (1969).
Algorithm 347: an efficient algorithm for sorting with minimal storage.
<em>Communications of the ACM</em>, <b>12</b>, 185&ndash;186.
<a href="https://doi.org/10.1145/362875.362901">doi:10.1145/362875.362901</a>.
</p>


<h3>See Also</h3>

<p>&lsquo;<a href="#topic+Comparison">Comparison</a>&rsquo; for how character strings are collated.
</p>
<p><code><a href="#topic+order">order</a></code> for sorting on or reordering multiple variables.
</p>
<p><code><a href="#topic+is.unsorted">is.unsorted</a></code>. <code><a href="#topic+rank">rank</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

x &lt;- swiss$Education[1:25]
x; sort(x); sort(x, partial = c(10, 15))

## illustrate 'stable' sorting (of ties):
sort(c(10:3, 2:12), method = "shell", index.return = TRUE) # is stable
## $x : 2  3  3  4  4  5  5  6  6  7  7  8  8  9  9 10 10 11 12
## $ix: 9  8 10  7 11  6 12  5 13  4 14  3 15  2 16  1 17 18 19
sort(c(10:3, 2:12), method = "quick", index.return = TRUE) # is not
## $x : 2  3  3  4  4  5  5  6  6  7  7  8  8  9  9 10 10 11 12
## $ix: 9 10  8  7 11  6 12  5 13  4 14  3 15 16  2 17  1 18 19

x &lt;- c(1:3, 3:5, 10)
is.unsorted(x)                  # FALSE: is sorted
is.unsorted(x, strictly = TRUE) # TRUE : is not (and cannot be)
                                # sorted strictly
## Not run: 
## Small speed comparison simulation:
N &lt;- 2000
Sim &lt;- 20
rep &lt;- 1000 # &lt;&lt; adjust to your CPU
c1 &lt;- c2 &lt;- numeric(Sim)
for(is in seq_len(Sim)){
  x &lt;- rnorm(N)
  c1[is] &lt;- system.time(for(i in 1:rep) sort(x, method = "shell"))[1]
  c2[is] &lt;- system.time(for(i in 1:rep) sort(x, method = "quick"))[1]
  stopifnot(sort(x, method = "shell") == sort(x, method = "quick"))
}
rbind(ShellSort = c1, QuickSort = c2)
cat("Speedup factor of quick sort():\n")
summary({qq &lt;- c1 / c2; qq[is.finite(qq)]})

## A larger test
x &lt;- rnorm(1e7)
system.time(x1 &lt;- sort(x, method = "shell"))
system.time(x2 &lt;- sort(x, method = "quick"))
system.time(x3 &lt;- sort(x, method = "radix"))
stopifnot(identical(x1, x2))
stopifnot(identical(x1, x3))

## End(Not run)</code></pre>

<hr>
<h2 id='sort_by'>Sorting Vectors or Data Frames by Other Vectors</h2><span id='topic+sort_by'></span><span id='topic+sort_by.default'></span><span id='topic+sort_by.data.frame'></span>

<h3>Description</h3>

<p>Generic function to sort an object in the order determined by one or
more other objects, typically vectors. A method is defined for data
frames to sort its rows (typically by one or more columns), and the
default method handles vector-like objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort_by(x, y, ...)

## Default S3 method:
sort_by(x, y, ...)

## S3 method for class 'data.frame'
sort_by(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sort_by_+3A_x">x</code></td>
<td>
<p>An object to be sorted, typically a vector or data frame. </p>
</td></tr>
<tr><td><code id="sort_by_+3A_y">y</code></td>
<td>
<p>Variables to sort by.
</p>
<p>For the default method, this can be a vector, or more generally any
object that has a <code><a href="#topic+xtfrm">xtfrm</a></code> method.
</p>
<p>For the <code>data.frame</code> method, typically a formula specifying the
variables to sort by. The formula can take the forms <code> ~ g</code> or
<code>~ list(g)</code> to sort by the variable <code>g</code>, or more generally
the forms <code> ~ g1 + ... + gk</code> or <code>~ list(g1, ..., gk)</code>
to sort by the variables <code>g1</code>, ..., <code>gk</code>, using the
later ones to resolve ties in the preceding ones.  These variables
are evaluated in the data frame <code>x</code> using the usual
non-standard evaluation rules. If not a formula, <code>y = g</code> is
equivalent to <code>y = ~ g</code> and <code>y = list(g1, ..., gk)</code> is
equivalent to <code>y = ~ list(g1, ..., gk)</code>. However,
non-standard evaluation in <code>x</code> is not done in this case.
</p>
</td></tr>
<tr><td><code id="sort_by_+3A_...">...</code></td>
<td>
<p>Additional arguments, typically passed on to
<code><a href="#topic+order">order</a></code>. These may include additional variables to sort
by, as well as named arguments recognized by <code>order</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sorted version of <code>x</code>. If <code>x</code> is a data frame, this means
that the rows of <code>x</code> have been reordered to sort the variables
specified in <code>y</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sort">sort</a></code>, <code><a href="#topic+order">order</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>mtcars$am
mtcars$mpg
with(mtcars, sort_by(mpg, am)) # group mpg by am

## data.frame method
sort_by(mtcars, runif(nrow(mtcars))) # random row permutation
sort_by(mtcars, list(mtcars$am, mtcars$mpg))

# formula interface
sort_by(mtcars, ~ am + mpg) |&gt; subset(select = c(am, mpg))
sort_by.data.frame(mtcars, ~ list(am, -mpg)) |&gt; subset(select = c(am, mpg))

</code></pre>

<hr>
<h2 id='source'>Read R Code from a File, a Connection or Expressions</h2><span id='topic+source'></span><span id='topic+withAutoprint'></span>

<h3>Description</h3>

<p><code>source</code> causes <span class="rlang"><b>R</b></span> to accept its input from the named file or URL
or connection or expressions directly.  Input is read and
<code><a href="#topic+parse">parse</a></code>d from that file
until the end of the file is reached, then the parsed expressions are
evaluated sequentially in the chosen environment.
</p>
<p><code>withAutoprint(exprs)</code> is a wrapper for <code>source(exprs =
  exprs, ..)</code> with different defaults.  Its main purpose is to evaluate
and auto-print expressions as if in a toplevel context, e.g, as in the
<span class="rlang"><b>R</b></span> console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>source(file, local = FALSE, echo = verbose, print.eval = echo,
       exprs, spaced = use_file,
       verbose = getOption("verbose"),
       prompt.echo = getOption("prompt"),
       max.deparse.length = 150, width.cutoff = 60L,
       deparseCtrl = "showAttributes",
       chdir = FALSE,
       catch.aborts = FALSE,
       encoding = getOption("encoding"),
       continue.echo = getOption("continue"),
       skip.echo = 0, keep.source = getOption("keep.source"))

withAutoprint(exprs, evaluated = FALSE, local = parent.frame(),
              print. = TRUE, echo = TRUE, max.deparse.length = Inf,
              width.cutoff = max(20, getOption("width")),
              deparseCtrl = c("keepInteger", "showAttributes", "keepNA"),
              skip.echo = 0,
              ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="source_+3A_file">file</code></td>
<td>
<p>a <a href="#topic+connection">connection</a> or a character string giving the
pathname of the file or URL to read from.  The <code><a href="#topic+stdin">stdin</a>()</code>
connection reads from the console when interactive.</p>
</td></tr>
<tr><td><code id="source_+3A_local">local</code></td>
<td>
<p><code>TRUE</code>, <code>FALSE</code> or an environment, determining
where the parsed expressions are evaluated.  <code>FALSE</code> (the
default) corresponds to the user's workspace (the global
environment) and <code>TRUE</code> to the environment from which
<code>source</code> is called.</p>
</td></tr>
<tr><td><code id="source_+3A_echo">echo</code></td>
<td>
<p>logical; if <code>TRUE</code>, each expression is printed
after parsing, before evaluation.</p>
</td></tr>
<tr><td><code id="source_+3A_print.eval">print.eval</code>, <code id="source_+3A_print.">print.</code></td>
<td>
<p>logical; if <code>TRUE</code>, the result of
<code>eval(i)</code> is printed for each expression <code>i</code>; defaults
to the value of <code>echo</code>.</p>
</td></tr>
<tr><td><code id="source_+3A_exprs">exprs</code></td>
<td>
<p>for <code>source()</code> and <code>withAutoprint(*, evaluated=TRUE)</code>:
<em>instead</em> of specifying <code>file</code>, an
<code><a href="#topic+expression">expression</a></code>, <code><a href="#topic+call">call</a></code>, or <code><a href="#topic+list">list</a></code>
of <code><a href="#topic+call">call</a></code>'s, but <em>not</em> an unevaluated &ldquo;expression&rdquo;.
</p>
<p>for <code>withAutoprint()</code> (with default <code>evaluated=FALSE</code>):
one or more unevaluated &ldquo;expressions&rdquo;.
</p>
</td></tr>
<tr><td><code id="source_+3A_evaluated">evaluated</code></td>
<td>
<p>logical indicating that <code>exprs</code> is passed to
<code>source(exprs= *)</code> and hence must be evaluated, i.e., a formal
<code>expression</code>, <code>call</code> or <code>list</code> of calls.</p>
</td></tr>
<tr><td><code id="source_+3A_spaced">spaced</code></td>
<td>
<p>logical indicating if newline (hence empty line) should
be printed before each expression (when <code>echo = TRUE</code>).</p>
</td></tr>
<tr><td><code id="source_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, more diagnostics (than just
<code>echo = TRUE</code>) are printed during parsing and evaluation of
input, including extra info for <b>each</b> expression.</p>
</td></tr>
<tr><td><code id="source_+3A_prompt.echo">prompt.echo</code></td>
<td>
<p>character; gives the prompt to be used if
<code>echo = TRUE</code>.</p>
</td></tr>
<tr><td><code id="source_+3A_max.deparse.length">max.deparse.length</code></td>
<td>
<p>integer; is used only if <code>echo</code> is
<code>TRUE</code> and gives the maximal number of characters output for
the deparse of a single expression.</p>
</td></tr>
<tr><td><code id="source_+3A_width.cutoff">width.cutoff</code></td>
<td>
<p>integer, passed to <code><a href="#topic+deparse">deparse</a>()</code> which
is used (only) when there are no source references.</p>
</td></tr>
<tr><td><code id="source_+3A_deparsectrl">deparseCtrl</code></td>
<td>
<p><code><a href="#topic+character">character</a></code> vector, passed as
<code>control</code> to <code><a href="#topic+deparse">deparse</a>()</code>, see also
<code><a href="#topic+.deparseOpts">.deparseOpts</a></code>.  In <span class="rlang"><b>R</b></span> version &lt;= 3.3.x, this was
hardcoded to <code>"showAttributes"</code>, which is the default
currently; <code>deparseCtrl = "all"</code> may be preferable, when strict
back compatibility is not of importance.</p>
</td></tr>
<tr><td><code id="source_+3A_chdir">chdir</code></td>
<td>
<p>logical; if <code>TRUE</code> and <code>file</code> is a pathname,
the <span class="rlang"><b>R</b></span> working directory is temporarily changed to the directory
containing <code>file</code> for evaluating.</p>
</td></tr>
<tr><td><code id="source_+3A_catch.aborts">catch.aborts</code></td>
<td>
<p>logical indicating that &ldquo;abort&rdquo;ing errors
should be caught.</p>
</td></tr>
<tr><td><code id="source_+3A_encoding">encoding</code></td>
<td>
<p>character vector.  The encoding(s) to be assumed when
<code>file</code> is a character string: see <code><a href="#topic+file">file</a></code>.  A
possible value is <code>"unknown"</code> when the encoding is guessed: see
the &lsquo;Encodings&rsquo; section.</p>
</td></tr>
<tr><td><code id="source_+3A_continue.echo">continue.echo</code></td>
<td>
<p>character; gives the prompt to use on
continuation lines if <code>echo = TRUE</code>.</p>
</td></tr>
<tr><td><code id="source_+3A_skip.echo">skip.echo</code></td>
<td>
<p>integer; how many comment lines at the start of the
file to skip if <code>echo = TRUE</code>.</p>
</td></tr>
<tr><td><code id="source_+3A_keep.source">keep.source</code></td>
<td>
<p>logical: should the source formatting be retained
when echoing expressions, if possible?</p>
</td></tr>
<tr><td><code id="source_+3A_...">...</code></td>
<td>
<p>(for <code>withAutoprint()</code>:) further (non-file related)
arguments to be passed to <code>source(.)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that running code via <code>source</code> differs in a few respects
from entering it at the <span class="rlang"><b>R</b></span> command line.  Since expressions are not
executed at the top level, auto-printing is not done.  So you will
need to include explicit <code>print</code> calls for things you want to be
printed (and remember that this includes plotting by <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>,
FAQ Q7.22).  Since the complete file is parsed before any of it is
run, syntax errors result in none of the code being run.  If an error
occurs in running a syntactically correct script, anything assigned
into the workspace by code that has been run will be kept (just as
from the command line), but diagnostic information such as
<code><a href="#topic+traceback">traceback</a>()</code> will contain additional calls to
<code><a href="#topic+withVisible">withVisible</a></code>.
</p>
<p>All versions of <span class="rlang"><b>R</b></span> accept input from a connection with end of line
marked by <abbr>LF</abbr> (as used on Unix), <abbr>CRLF</abbr> (as used on
DOS/Windows) or <abbr>CR</abbr> (as used on classic Mac OS) and map this to
newline.  The final line can be incomplete, that is missing the final
end-of-line marker. 
</p>
<p>If <code>keep.source</code> is true (the default in interactive use), the
source of functions is kept so they can be listed exactly as input.
</p>
<p>Unlike input from a console, lines in the file or on a connection can
contain an unlimited number of characters.
</p>
<p>When <code>skip.echo &gt; 0</code>, that many comment lines at the start of
the file will not be echoed.  This does not affect the execution of
the code at all.  If there are executable lines within the first
<code>skip.echo</code> lines, echoing will start with the first of them.
</p>
<p>If <code>echo</code> is true and a deparsed expression exceeds
<code>max.deparse.length</code>, that many characters are output followed by
<code> .... [TRUNCATED] </code>.
</p>


<h3>Encodings</h3>

<p>By default the input is read and parsed in  the current encoding of
the <span class="rlang"><b>R</b></span> session.  This is usually what is required, but occasionally
re-encoding is needed, e.g. if a file from a UTF-8-using system is to
be read on Windows (or <em>vice versa</em>).
</p>
<p>The rest of this paragraph applies if <code>file</code> is an actual
filename or URL (and not a connection).  If
<code>encoding = "unknown"</code>, an attempt is made to guess the encoding:
the result of <code><a href="utils.html#topic+localeToCharset">localeToCharset</a>()</code> is used as a guide.  If
<code>encoding</code> has two or more elements, they are tried in turn until
the file/URL can be read without error in the trial encoding.  If an
actual <code>encoding</code> is specified (rather than the default or
<code>"unknown"</code>) in a Latin-1 or UTF-8 locale then character strings
in the result will be translated to the current encoding and marked as
such (see <code><a href="#topic+Encoding">Encoding</a></code>).
</p>
<p>If <code>file</code> is a connection,
it is not possible to re-encode the input inside <code>source</code>, and so
the <code>encoding</code> argument is just used to mark character strings in the
parsed input in Latin-1 and UTF-8 locales: see <code><a href="#topic+parse">parse</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+demo">demo</a></code> which uses <code>source</code>;
<code><a href="#topic+eval">eval</a></code>, <code><a href="#topic+parse">parse</a></code> and <code><a href="#topic+scan">scan</a></code>;
<code><a href="#topic+options">options</a>("keep.source")</code>.
</p>
<p><code><a href="#topic+sys.source">sys.source</a></code> which is a streamlined version to source a
file into an environment.
</p>
<p>&lsquo;The R Language Definition&rsquo; for a discussion of source
directives.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>someCond &lt;- 7 &gt; 6
## want an if-clause to behave "as top level" wrt auto-printing :
## (all should look "as if on top level", e.g. non-assignments should print:)
if(someCond) withAutoprint({
   x &lt;- 1:12
   x-1
   (y &lt;- (x-5)^2)
   z &lt;- y
   z - 10
})

## If you want to source() a bunch of files, something like
## the following may be useful:
sourceDir &lt;- function(path, trace = TRUE, ...) {
    op &lt;- options(); on.exit(options(op)) # to reset after each
    for (nm in list.files(path, pattern = "[.][RrSsQq]$")) {
       if(trace) cat(nm,":")
       source(file.path(path, nm), ...)
       if(trace) cat("\n")
       options(op)
    }
}

suppressWarnings( rm(x,y) ) # remove 'x' or 'y' from global env
withAutoprint({ x &lt;- 1:2; cat("x=",x, "\n"); y &lt;- x^2 })
## x and y now exist:
stopifnot(identical(x, 1:2), identical(y, x^2))

withAutoprint({ formals(sourceDir); body(sourceDir) },
              max.deparse.length = 20, verbose = TRUE)

## Continuing after (catchable) errors:
tc &lt;- textConnection('1:3
 2 + "3"
 cat(" .. in spite of error: happily continuing! ..\n")
 6*7')
r &lt;- source(tc, catch.aborts = TRUE)
## Error in 2 + "3" ....
## .. in spite of error: happily continuing! ..
stopifnot(identical(r, list(value = 42, visible=TRUE)))
</code></pre>

<hr>
<h2 id='Special'>Special Functions of Mathematics</h2><span id='topic+Special'></span><span id='topic+beta'></span><span id='topic+lbeta'></span><span id='topic+gamma'></span><span id='topic+lgamma'></span><span id='topic+psigamma'></span><span id='topic+digamma'></span><span id='topic+trigamma'></span><span id='topic+choose'></span><span id='topic+lchoose'></span><span id='topic+factorial'></span><span id='topic+lfactorial'></span>

<h3>Description</h3>

<p>Special mathematical functions related to the beta and gamma
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta(a, b)
lbeta(a, b)

gamma(x)
lgamma(x)
psigamma(x, deriv = 0)
digamma(x)
trigamma(x)

choose(n, k)
lchoose(n, k)
factorial(x)
lfactorial(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Special_+3A_a">a</code>, <code id="Special_+3A_b">b</code></td>
<td>
<p>non-negative numeric vectors.</p>
</td></tr>
<tr><td><code id="Special_+3A_x">x</code>, <code id="Special_+3A_n">n</code></td>
<td>
<p>numeric vectors.</p>
</td></tr>
<tr><td><code id="Special_+3A_k">k</code>, <code id="Special_+3A_deriv">deriv</code></td>
<td>
<p>integer vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>beta</code> and <code>lbeta</code> return the beta function
and the natural logarithm of the beta function,
</p>
<p style="text-align: center;"><code class="reqn">B(a,b) = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)}.</code>
</p>

<p>The formal definition is
</p>
<p style="text-align: center;"><code class="reqn">B(a, b) = \int_0^1 t^{a-1} (1-t)^{b-1} dt</code>
</p>

<p>(Abramowitz and Stegun section 6.2.1, page 258).
Note that it is only
defined in <span class="rlang"><b>R</b></span> for non-negative <code>a</code> and <code>b</code>, and is infinite
if either is zero.
</p>
<p>The functions <code>gamma</code> and <code>lgamma</code> return the gamma function
<code class="reqn">\Gamma(x)</code> and the natural logarithm of <em>the absolute value of</em> the
gamma function.  The gamma function is defined by
(Abramowitz and Stegun section 6.1.1, page 255)
</p>
<p style="text-align: center;"><code class="reqn">\Gamma(x) = \int_0^\infty t^{x-1} e^{-t} dt</code>
</p>

<p>for all real <code>x</code> except zero and negative integers (when
<code>NaN</code> is returned).  There will be a warning on possible loss of
precision for values which are too close (within about
<code class="reqn">10^{-8}</code>) to a negative integer less than &lsquo;<span class="samp">&#8288;-10&#8288;</span>&rsquo;.
</p>
<p><code>factorial(x)</code> (<code class="reqn">x!</code> for non-negative integer <code>x</code>)
is defined to be <code>gamma(x+1)</code> and <code>lfactorial</code> to be
<code>lgamma(x+1)</code>.
</p>
<p>The functions <code>digamma</code> and <code>trigamma</code> return the first and second
derivatives of the logarithm of the gamma function.
<code>psigamma(x, deriv)</code> (<code>deriv &gt;= 0</code>) computes the
<code>deriv</code>-th derivative of <code class="reqn">\psi(x)</code>.
</p>
<p style="text-align: center;"><code class="reqn">\code{digamma(x)} = \psi(x) = \frac{d}{dx}\ln\Gamma(x) =
    \frac{\Gamma'(x)}{\Gamma(x)}</code>
</p>

<p><code class="reqn">\psi</code> and its derivatives, the <code>psigamma()</code> functions, are
often called the &lsquo;polygamma&rsquo; functions, e.g. in
Abramowitz and Stegun (section 6.4.1, page 260); and higher
derivatives (<code>deriv = 2:4</code>) have occasionally been called
&lsquo;tetragamma&rsquo;, &lsquo;pentagamma&rsquo;, and &lsquo;hexagamma&rsquo;.
</p>
<p>The functions <code>choose</code> and <code>lchoose</code> return binomial
coefficients and the logarithms of their absolute values.  Note that
<code>choose(n, k)</code> is defined for all real numbers <code class="reqn">n</code> and integer
<code class="reqn">k</code>.  For <code class="reqn">k \ge 1</code> it is defined as
<code class="reqn">n(n-1)\cdots(n-k+1) / k!</code>,
as <code class="reqn">1</code> for <code class="reqn">k = 0</code> and as <code class="reqn">0</code> for negative <code class="reqn">k</code>.
Non-integer values of <code>k</code> are rounded to an integer, with a warning.
<br /> <code>choose(*, k)</code> uses direct arithmetic (instead of
<code>[l]gamma</code> calls) for small <code>k</code>, for speed and accuracy
reasons.  Note the function <code><a href="utils.html#topic+combn">combn</a></code> (package
<span class="pkg">utils</span>) for enumeration of all possible combinations.
</p>
<p>The <code>gamma</code>, <code>lgamma</code>, <code>digamma</code> and <code>trigamma</code>
functions are <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a> functions: methods can be
defined for them individually or via the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generic.
</p>


<h3>Source</h3>

<p><code>gamma</code>, <code>lgamma</code>, <code>beta</code> and <code>lbeta</code> are based on
C translations of Fortran subroutines by W. Fullerton of Los Alamos
Scientific Laboratory (now available as part of SLATEC).
</p>
<p><code>digamma</code>, <code>trigamma</code> and <code>psigamma</code> for <code>x &gt;= 0</code> are based on
</p>
<p>Amos, D. E. (1983). A portable Fortran subroutine for
derivatives of the psi function, Algorithm 610,
<em>ACM Transactions on Mathematical Software</em> <b>9(4)</b>, 494&ndash;502.
</p>
<p>For, <code>x &lt; 0</code> and <code>deriv &lt;= 5</code>, the reflection formula (6.4.7) of
Abramowitz and Stegun is used.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole. (For <code>gamma</code> and <code>lgamma</code>.)
</p>
<p>Abramowitz, M. and Stegun, I. A. (1972)
<em>Handbook of Mathematical Functions</em>. New York: Dover.
<a href="https://en.wikipedia.org/wiki/Abramowitz_and_Stegun">https://en.wikipedia.org/wiki/Abramowitz_and_Stegun</a> provides
links to the full text which is in public domain.<br />
Chapter 6: Gamma and Related Functions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Arithmetic">Arithmetic</a></code> for simple, <code><a href="#topic+sqrt">sqrt</a></code> for
miscellaneous mathematical functions and <code><a href="#topic+Bessel">Bessel</a></code> for the
real Bessel functions.
</p>
<p>For the incomplete gamma function see <code><a href="stats.html#topic+pgamma">pgamma</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)

choose(5, 2)
for (n in 0:10) print(choose(n, k = 0:n))

factorial(100)
lfactorial(10000)

## gamma has 1st order poles at 0, -1, -2, ...
## this will generate loss of precision warnings, so turn off
op &lt;- options("warn")
options(warn = -1)
x &lt;- sort(c(seq(-3, 4, length.out = 201), outer(0:-3, (-1:1)*1e-6, `+`)))
plot(x, gamma(x), ylim = c(-20,20), col = "red", type = "l", lwd = 2,
     main = expression(Gamma(x)))
abline(h = 0, v = -3:0, lty = 3, col = "midnightblue")
options(op)

x &lt;- seq(0.1, 4, length.out = 201); dx &lt;- diff(x)[1]
par(mfrow = c(2, 3))
for (ch in c("", "l","di","tri","tetra","penta")) {
  is.deriv &lt;- nchar(ch) &gt;= 2
  nm &lt;- paste0(ch, "gamma")
  if (is.deriv) {
    dy &lt;- diff(y) / dx # finite difference
    der &lt;- which(ch == c("di","tri","tetra","penta")) - 1
    nm2 &lt;- paste0("psigamma(*, deriv = ", der,")")
    nm  &lt;- if(der &gt;= 2) nm2 else paste(nm, nm2, sep = " ==\n")
    y &lt;- psigamma(x, deriv = der)
  } else {
    y &lt;- get(nm)(x)
  }
  plot(x, y, type = "l", main = nm, col = "red")
  abline(h = 0, col = "lightgray")
  if (is.deriv) lines(x[-1], dy, col = "blue", lty = 2)
}
par(mfrow = c(1, 1))

## "Extended" Pascal triangle:
fN &lt;- function(n) formatC(n, width=2)
for (n in -4:10) {
    cat(fN(n),":", fN(choose(n, k = -2:max(3, n+2))))
    cat("\n")
}

## R code version of choose()  [simplistic; warning for k &lt; 0]:
mychoose &lt;- function(r, k)
    ifelse(k &lt;= 0, (k == 0),
           sapply(k, function(k) prod(r:(r-k+1))) / factorial(k))
k &lt;- -1:6
cbind(k = k, choose(1/2, k), mychoose(1/2, k))

## Binomial theorem for n = 1/2 ;
## sqrt(1+x) = (1+x)^(1/2) = sum_{k=0}^Inf  choose(1/2, k) * x^k :
k &lt;- 0:10 # 10 is sufficient for ~ 9 digit precision:
sqrt(1.25)
sum(choose(1/2, k)* .25^k)


</code></pre>

<hr>
<h2 id='split'>Divide into Groups and Reassemble</h2><span id='topic+split'></span><span id='topic+split.default'></span><span id='topic+split.data.frame'></span><span id='topic+split+3C-'></span><span id='topic+split+3C-.default'></span><span id='topic+split+3C-.data.frame'></span><span id='topic+unsplit'></span>

<h3>Description</h3>

<p><code>split</code> divides the data in the vector <code>x</code> into the groups
defined by <code>f</code>.  The replacement forms replace values
corresponding to such a division.  <code>unsplit</code> reverses the effect of
<code>split</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split(x, f, drop = FALSE, ...)
## Default S3 method:
split(x, f, drop = FALSE, sep = ".", lex.order = FALSE, ...)

split(x, f, drop = FALSE, ...) &lt;- value
unsplit(value, f, drop = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_+3A_x">x</code></td>
<td>
<p>vector or data frame containing values to be divided into groups.</p>
</td></tr>
<tr><td><code id="split_+3A_f">f</code></td>
<td>
<p>a &lsquo;factor&rsquo; in the sense that <code><a href="#topic+as.factor">as.factor</a>(f)</code>
defines the grouping, or a list of such factors in which case their
interaction is used for the grouping. If <code>x</code> is a data frame,
<code>f</code> can also be a formula of the form <code> ~ g</code> to split by
the variable <code>g</code>, or more generally of the form <code> ~ g1 +
      ... + gk</code> to split by the interaction of the variables
<code>g1</code>, ..., <code>gk</code>, where these variables are evaluated in
the data frame <code>x</code> using the usual non-standard evaluation
rules.</p>
</td></tr>
<tr><td><code id="split_+3A_drop">drop</code></td>
<td>
<p>logical indicating if levels that do not occur should be dropped
(if <code>f</code> is a <code>factor</code> or a list).</p>
</td></tr>
<tr><td><code id="split_+3A_value">value</code></td>
<td>
<p>a list of vectors or data frames compatible with a
splitting of <code>x</code>. Recycling applies if the lengths do not match.</p>
</td></tr>
<tr><td><code id="split_+3A_sep">sep</code></td>
<td>
<p>character string, passed to <code><a href="#topic+interaction">interaction</a></code> in the
case where <code>f</code> is a <code><a href="#topic+list">list</a></code>.</p>
</td></tr>
<tr><td><code id="split_+3A_lex.order">lex.order</code></td>
<td>
<p>logical, passed to <code><a href="#topic+interaction">interaction</a></code> when
<code>f</code> is a list.</p>
</td></tr>
<tr><td><code id="split_+3A_...">...</code></td>
<td>
<p>further potential arguments passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>split</code> and <code>split&lt;-</code> are generic functions with default and
<code>data.frame</code> methods.  The data frame method can also be used to
split a matrix into a list of matrices, and the replacement form
likewise, provided they are invoked explicitly.
</p>
<p><code>unsplit</code> works with lists of vectors or data frames (assumed to
have compatible structure, as if created by <code>split</code>).  It puts
elements or rows back in the positions given by <code>f</code>.  In the data
frame case, row names are obtained by unsplitting the row name
vectors from the elements of <code>value</code>.
</p>
<p><code>f</code> is recycled as necessary and if the length of <code>x</code> is not
a multiple of the length of <code>f</code> a warning is printed.
</p>
<p>Any missing values in <code>f</code> are dropped together with the
corresponding values of <code>x</code>.
</p>
<p>The default method calls <code><a href="#topic+interaction">interaction</a></code> when <code>f</code> is a
<code><a href="#topic+list">list</a></code>.  If the levels of the factors contain &lsquo;<span class="samp">&#8288;.&#8288;</span>&rsquo;
the factors may not be split as expected, unless <code>sep</code> is set to
string not present in the factor <code><a href="#topic+levels">levels</a></code>.
</p>


<h3>Value</h3>

<p>The value returned from <code>split</code> is a list of vectors containing
the values for the groups.  The components of the list are named by
the levels of <code>f</code> (after converting to a factor, or if already a
factor and <code>drop = TRUE</code>, dropping unused levels).
</p>
<p>The replacement forms return their right hand side.  <code>unsplit</code>
returns a vector or data frame for which <code>split(x, f)</code> equals
<code>value</code>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cut">cut</a></code> to categorize numeric values.
</p>
<p><code><a href="#topic+strsplit">strsplit</a></code> to split strings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
n &lt;- 10; nn &lt;- 100
g &lt;- factor(round(n * runif(n * nn)))
x &lt;- rnorm(n * nn) + sqrt(as.numeric(g))
xg &lt;- split(x, g)
boxplot(xg, col = "lavender", notch = TRUE, varwidth = TRUE)
sapply(xg, length)
sapply(xg, mean)

### Calculate 'z-scores' by group (standardize to mean zero, variance one)
z &lt;- unsplit(lapply(split(x, g), scale), g)

# or

zz &lt;- x
split(zz, g) &lt;- lapply(split(x, g), scale)

# and check that the within-group std dev is indeed one
tapply(z, g, sd)
tapply(zz, g, sd)


### data frame variation

## Notice that assignment form is not used since a variable is being added

g &lt;- airquality$Month
l &lt;- split(airquality, g)

## Alternative using a formula
identical(l, split(airquality, ~ Month))

l &lt;- lapply(l, transform, Oz.Z = scale(Ozone))
aq2 &lt;- unsplit(l, g)
head(aq2)
with(aq2, tapply(Oz.Z,  Month, sd, na.rm = TRUE))


### Split a matrix into a list by columns
ma &lt;- cbind(x = 1:10, y = (-4:5)^2)
split(ma, col(ma))

split(1:10, 1:2)
</code></pre>

<hr>
<h2 id='sprintf'>Use C-style String Formatting Commands</h2><span id='topic+sprintf'></span><span id='topic+gettextf'></span>

<h3>Description</h3>

<p>A wrapper for the C function <code>sprintf</code>, that returns a character
vector containing a formatted combination of text and variable values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sprintf(fmt, ...)
gettextf(fmt, ..., domain = NULL, trim = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sprintf_+3A_fmt">fmt</code></td>
<td>
<p>a character vector of format strings, each of up to 8192 bytes.</p>
</td></tr>
<tr><td><code id="sprintf_+3A_...">...</code></td>
<td>
<p>values to be passed into <code>fmt</code>.  Only logical,
integer, real and character vectors are supported, but some coercion
will be done: see the &lsquo;Details&rsquo; section. Up to 100.</p>
</td></tr>
<tr><td><code id="sprintf_+3A_trim">trim</code>, <code id="sprintf_+3A_domain">domain</code></td>
<td>
<p>see <code><a href="#topic+gettext">gettext</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sprintf</code> is a wrapper for the system <code>sprintf</code> C-library
function.  Attempts are made to check that the mode of the values
passed match the format supplied, and <span class="rlang"><b>R</b></span>'s special values (<code>NA</code>,
<code>Inf</code>, <code>-Inf</code> and <code>NaN</code>) are handled correctly.
</p>
<p><code>gettextf</code> is a convenience function which provides C-style
string formatting with possible translation of the format string.
</p>
<p>The arguments (including <code>fmt</code>) are recycled if possible a whole
number of times to the length of the longest, and then the formatting
is done in parallel.  Zero-length arguments are allowed and will give
a zero-length result.  All arguments are evaluated even if unused, and
hence some types (e.g., <code>"symbol"</code> or <code>"language"</code>, see
<code><a href="#topic+typeof">typeof</a></code>) are not allowed. Arguments unused by <code>fmt</code>
result in a warning. (The format <code>%.0s</code> can be used to
&ldquo;skip&rdquo; an argument.)
</p>
<p>The following is abstracted from
Kernighan and Ritchie (1988):
however the actual implementation will follow the C99
standard and fine details (especially the behaviour under user error)
may depend on the platform. References to numbered arguments come from
POSIX.
</p>
<p>The string <code>fmt</code> contains normal characters,
which are passed through to the output string, and also conversion
specifications which operate on the arguments provided through
<code>...</code>.  The allowed conversion specifications start with a
<code>%</code> and end with one of the letters in the set
<code>aAdifeEgGosxX%</code>.  These letters denote the following types:
</p>

<dl>
<dt><code>d</code>, <code>i</code>, <code>o</code>, <code>x</code>, <code>X</code></dt><dd><p>Integer
value, <code>o</code> being octal, 
<code>x</code> and <code>X</code> being hexadecimal (using the same case for
<code>a-f</code> as the code).  Numeric variables with exactly integer
values will be coerced to integer.  Formats <code>d</code> and <code>i</code>
can also be used for logical variables, which will be converted to
<code>0</code>, <code>1</code> or <code>NA</code>.
</p>
</dd>
<dt><code>f</code></dt><dd><p>Double precision value, in &ldquo;<b>f</b>ixed
point&rdquo; decimal notation of the form &lsquo;<span class="samp">&#8288;"[-]mmm.ddd"&#8288;</span>&rsquo;.  The number of
decimal places (&quot;d&quot;) is specified by the precision: the default is 6;
a precision of 0 suppresses the decimal point.  Non-finite values
are converted to <code>NA</code>, <code>NaN</code> or (perhaps a sign followed
by) <code>Inf</code>.
</p>
</dd>
<dt><code>e</code>, <code>E</code></dt><dd><p>Double precision value, in
&ldquo;<b>e</b>xponential&rdquo; decimal notation of the
form <code>[-]m.ddde[+-]xx</code> or <code>[-]m.dddE[+-]xx</code>.
</p>
</dd>
<dt><code>g</code>, <code>G</code></dt><dd><p>Double precision value, in <code>%e</code> or
<code>%E</code> format if the exponent is less than -4 or greater than or
equal to the precision, and <code>%f</code> format otherwise.
(The precision (default 6) specifies the number of
<em>significant</em> digits here, whereas in <code>%f, %e</code>, it is
the number of digits after the decimal point.)
</p>
</dd>
<dt><code>a</code>, <code>A</code></dt><dd><p>Double precision value, in binary notation
of the form <code>[-]0xh.hhhp[+-]d</code>.  This is a binary fraction
expressed in hex multiplied by a (decimal) power of 2.  The number
of hex digits after the decimal point is specified by the precision:
the default is enough digits to represent exactly the internal
binary representation.  Non-finite values are converted to <code>NA</code>,
<code>NaN</code> or (perhaps a sign followed by) <code>Inf</code>.  Format
<code>%a</code> uses lower-case for <code>x</code>, <code>p</code> and the hex
values: format <code>%A</code> uses upper-case.
</p>
<p>This should be supported on all platforms as it is a feature of C99.
The format is not uniquely defined: although it would be possible
to make the leading <code>h</code> always zero or one, this is not
always done.  Most systems will suppress trailing zeros, but a few
do not.  On a well-written platform, for normal numbers there will
be a leading one before the decimal point plus (by default) 13
hexadecimal digits, hence 53 bits.  The treatment of denormalized
(aka &lsquo;subnormal&rsquo;) numbers is very platform-dependent.
</p>
</dd>
<dt><code>s</code></dt><dd><p>Character string.  Character <code>NA</code>s are
converted to <code>"NA"</code>.
</p>
</dd>
<dt><code>%</code></dt><dd><p>Literal <code>%</code> (none of the extra formatting
characters given below are permitted in this case).
</p>
</dd>
</dl>

<p>Conversion by <code><a href="#topic+as.character">as.character</a></code> is used for non-character
arguments with <code>s</code> and by <code><a href="#topic+as.double">as.double</a></code> for
non-double arguments with <code>f, e, E, g, G</code>.  NB: the length is
determined before conversion, so do not rely on the internal
coercion if this would change the length.  The coercion is done only
once, so if <code>length(fmt) &gt; 1</code> then all elements must expect the
same types of arguments.
</p>
<p>In addition, between the initial <code>%</code> and the terminating
conversion character there may be, in any order:
</p>

<dl>
<dt><code>m.n</code></dt><dd><p>Two numbers separated by a period, denoting the
field width (<code>m</code>) and the precision (<code>n</code>).</p>
</dd>
<dt><code>-</code></dt><dd><p>Left adjustment of converted argument in its field.</p>
</dd>
<dt><code>+</code></dt><dd><p>Always print number with sign: by default only
negative numbers are printed with a sign.</p>
</dd>
<dt>a space</dt><dd><p>Prefix a space if the first character is not a sign.</p>
</dd>
<dt><code>0</code></dt><dd><p>For numbers, pad to the field width with leading
zeros. For characters, this zero-pads on some platforms and is
ignored on others.</p>
</dd>
<dt><code>#</code></dt><dd><p>specifies &ldquo;alternate output&rdquo; for numbers, its
action depending on the type:
For <code>x</code> or <code>X</code>, <code>0x</code> or <code>0X</code> will be prefixed
to a non-zero result.  For <code>e</code>, <code>e</code>, <code>f</code>, <code>g</code>
and <code>G</code>, the output will always have a decimal point; for
<code>g</code> and <code>G</code>, trailing zeros will not be removed.
</p>
</dd>
</dl>

<p>Further, immediately after <code>%</code> may come <code>1$</code> to <code>99$</code>
to refer to a numbered argument: this allows arguments to be
referenced out of order and is mainly intended for translators of
error messages.  If this is done it is best if all formats are
numbered: if not the unnumbered ones process the arguments in order.
See the examples.  This notation allows arguments to be used more than
once, in which case they must be used as the same type (integer,
double or character).
</p>
<p>A field width or precision (but not both) may be indicated by an
asterisk <code>*</code>: in this case an argument specifies the desired
number.  A negative field width is taken as a '-' flag followed by a
positive field width.  A negative precision is treated as if the
precision were omitted.  The argument should be integer, but a double
argument will be coerced to integer.
</p>
<p>There is a limit of 8192 bytes on elements of <code>fmt</code>, and on
strings included from a single <code>%</code><em>letter</em> conversion
specification.
</p>
<p>Field widths and precisions of <code>%s</code> conversions are interpreted
as bytes, not characters, as described in the C standard.
</p>
<p>The C doubles used for <span class="rlang"><b>R</b></span> numerical vectors have signed zeros, which
<code>sprintf</code> may output as <code>-0</code>, <code>-0.000</code> ....
</p>


<h3>Value</h3>

<p>A character vector of length that of the longest input.  If any
element of <code>fmt</code> or any character argument is declared as UTF-8,
the element of the result will be in UTF-8 and have the encoding
declared as UTF-8.  Otherwise it will be in the current locale's
encoding.
</p>


<h3>Warning</h3>

<p>The format string is passed down the OS's <code>sprintf</code> function, and
incorrect formats can cause the latter to crash the <span class="rlang"><b>R</b></span> process .  <span class="rlang"><b>R</b></span>
does perform sanity checks on the format, but not all possible user
errors on all platforms have been tested, and some might be terminal.
</p>
<p>The behaviour on inputs not documented here is &lsquo;undefined&rsquo;,
which means it is allowed to differ by platform.
</p>


<h3>Author(s)</h3>

<p>Original code by Jonathan Rougier.
</p>


<h3>References</h3>

<p>Kernighan, B. W. and Ritchie, D. M. (1988)
<em>The C Programming Language.</em> Second edition, Prentice Hall.
Describes the format options in table B-1 in the Appendix.
</p>
<p>The C Standards, especially ISO/IEC 9899:1999 for &lsquo;C99&rsquo;.  Links
can be found at
<a href="https://developer.r-project.org/Portability.html">https://developer.r-project.org/Portability.html</a>.
</p>
<p><a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/snprintf.html">https://pubs.opengroup.org/onlinepubs/9699919799/functions/snprintf.html</a>
for POSIX extensions such as numbered arguments.
</p>
<p><code>man sprintf</code> on a Unix-alike system.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+formatC">formatC</a></code> for a way of formatting vectors of numbers in a
similar fashion.
</p>
<p><code><a href="#topic+paste">paste</a></code> for another way of creating a vector combining
text and values.
</p>
<p><code><a href="#topic+gettext">gettext</a></code> for the mechanisms for the automated translation
of text.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## be careful with the format: most things in R are floats
## only integer-valued reals get coerced to integer.

sprintf("%s is %f feet tall\n", "Sven", 7.1)      # OK
try(sprintf("%s is %i feet tall\n", "Sven", 7.1)) # not OK
    sprintf("%s is %i feet tall\n", "Sven", 7  )  # OK

## use a literal % :

sprintf("%.0f%% said yes (out of a sample of size %.0f)", 66.666, 3)

## various formats of pi :

sprintf("%f", pi)
sprintf("%.3f", pi)
sprintf("%1.0f", pi)
sprintf("%5.1f", pi)
sprintf("%05.1f", pi)
sprintf("%+f", pi)
sprintf("% f", pi)
sprintf("%-10f", pi) # left justified
sprintf("%e", pi)
sprintf("%E", pi)
sprintf("%g", pi)
sprintf("%g",   1e6 * pi) # -&gt; exponential
sprintf("%.9g", 1e6 * pi) # -&gt; "fixed"
sprintf("%G", 1e-6 * pi)

## no truncation:
sprintf("%1.f", 101)

## re-use one argument three times, show difference between %x and %X
xx &lt;- sprintf("%1$d %1$x %1$X", 0:15)
xx &lt;- matrix(xx, dimnames = list(rep("", 16), "%d%x%X"))
noquote(format(xx, justify = "right"))

## More sophisticated:

sprintf("min 10-char string '%10s'",
        c("a", "ABC", "and an even longer one"))

n &lt;- 1:18
sprintf(paste0("e with %2d digits = %.", n, "g"), n, exp(1))

## Platform-dependent bad example: may pad with spaces or zeroes
sprintf("%09s", month.name)

## Using arguments out of order
sprintf("second %2$1.0f, first %1$5.2f, third %3$1.0f", pi, 2, 3)

## Using asterisk for width or precision
sprintf("precision %.*f, width '%*.3f'", 3, pi, 8, pi)

## Asterisk and argument re-use, 'e' example reiterated:
sprintf("e with %1$2d digits = %2$.*1$g", n, exp(1))

## re-cycle arguments
sprintf("%s %d", "test", 1:3)

## binary output showing rounding/representation errors
x &lt;- seq(0, 1.0, 0.1); y &lt;- c(0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1)
cbind(x, sprintf("%a", x), sprintf("%a", y))
</code></pre>

<hr>
<h2 id='sQuote'>Quote Text</h2><span id='topic+sQuote'></span><span id='topic+dQuote'></span>

<h3>Description</h3>

<p>Single or double quote text by combining with appropriate single or
double left and right quotation marks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sQuote(x, q = getOption("useFancyQuotes"))
dQuote(x, q = getOption("useFancyQuotes"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sQuote_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, to be coerced to a character vector.</p>
</td></tr>
<tr><td><code id="sQuote_+3A_q">q</code></td>
<td>
<p>the kind of quotes to be used, see &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of the functions is to provide a simple means of markup
for quoting text to be used in the R output, e.g., in warnings or
error messages.
</p>
<p>The choice of the appropriate quotation marks depends on both the
locale and the available character sets.  Older Unix/X11 fonts
displayed the grave accent (ASCII code 0x60) and the apostrophe (0x27)
in a way that they could also be used as matching open and close
single quotation marks.  Using modern fonts, or non-Unix systems,
these characters no longer produce matching glyphs.  Unicode provides
left and right single quotation mark characters (U+2018 and U+2019);
if Unicode markup cannot be assumed to be available, it seems good
practice to use the apostrophe as a non-directional single quotation
mark.
</p>
<p>Similarly, Unicode has left and right double quotation mark characters
(U+201C and U+201D); if only ASCII's typewriter characteristics can be
employed, than the ASCII quotation mark (0x22) should be used as both
the left and right double quotation mark.
</p>
<p>Some other locales also have the directional quotation marks, notably
on Windows.  TeX uses grave and apostrophe for the directional single
quotation marks, and doubled grave and doubled apostrophe for the
directional double quotation marks.
</p>
<p>What rendering is used depends on <code>q</code> which by default depends on
the <code><a href="#topic+options">options</a></code> setting for <code>useFancyQuotes</code>.  If this
is <code>FALSE</code> then the undirectional
ASCII quotation style is used.  If this is <code>TRUE</code> (the default),
Unicode directional quotes are used are used where available
(currently, UTF-8 locales on Unix-alikes and all Windows locales
except <code>C</code>): if set to <code>"UTF-8"</code> UTF-8 markup is used
(whatever the current locale). If set to <code>"TeX"</code>, TeX-style
markup is used.  Finally, if this is set to a character vector of
length four, the first two entries are used for beginning and ending
single quotes and the second two for beginning and ending double
quotes: this can be used to implement non-English quoting conventions
such as the use of guillemets.
</p>
<p>Where fancy quotes are used, you should be aware that they may not be
rendered correctly as not all fonts include the requisite glyphs: for
example some have directional single quotes but not directional double
quotes.
</p>


<h3>Value</h3>

<p>A character vector of the same length as <code>x</code> (after any coercion)
in the current locale's encoding.
</p>


<h3>References</h3>

<p>Markus Kuhn, &ldquo;ASCII and Unicode quotation marks&rdquo;.
<a href="https://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html">https://www.cl.cam.ac.uk/~mgk25/ucs/quotes.html</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+Quotes">Quotes</a> for quoting <span class="rlang"><b>R</b></span> code.
</p>
<p><code><a href="#topic+shQuote">shQuote</a></code> for quoting OS commands.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- options("useFancyQuotes")
paste("argument", sQuote("x"), "must be non-zero")
options(useFancyQuotes = FALSE)
cat("\ndistinguish plain", sQuote("single"), "and",
    dQuote("double"), "quotes\n")
options(useFancyQuotes = TRUE)
cat("\ndistinguish fancy", sQuote("single"), "and",
    dQuote("double"), "quotes\n")
options(useFancyQuotes = "TeX")
cat("\ndistinguish TeX", sQuote("single"), "and",
    dQuote("double"), "quotes\n")
if(l10n_info()$`Latin-1`) {
    options(useFancyQuotes = c("\xab", "\xbb", "\xbf", "?"))
    cat("\n", sQuote("guillemet"), "and",
        dQuote("Spanish question"), "styles\n")
} else if(l10n_info()$`UTF-8`) {
    options(useFancyQuotes = c("\xc2\xab", "\xc2\xbb", "\xc2\xbf", "?"))
    cat("\n", sQuote("guillemet"), "and",
        dQuote("Spanish question"), "styles\n")
}
options(op)
</code></pre>

<hr>
<h2 id='srcfile'>References to Source Files and Code</h2><span id='topic+srcfile'></span><span id='topic+srcfilecopy'></span><span id='topic+getSrcLines'></span><span id='topic+srcref'></span><span id='topic+srcfile-class'></span><span id='topic+srcfilecopy-class'></span><span id='topic+srcref-class'></span><span id='topic+print.srcfile'></span><span id='topic+summary.srcfile'></span><span id='topic+open.srcfile'></span><span id='topic+open.srcfilecopy'></span><span id='topic+close.srcfile'></span><span id='topic+print.srcref'></span><span id='topic+summary.srcref'></span><span id='topic+as.character.srcref'></span><span id='topic+.isOpen'></span><span id='topic+srcfilealias-class'></span><span id='topic+srcfilealias'></span><span id='topic+open.srcfilealias'></span><span id='topic+close.srcfilealias'></span>

<h3>Description</h3>

<p>These functions are for working with source files and more generally
with &ldquo;source references&rdquo; (<code>"srcref"</code>), i.e., references to
source code.  The resulting data is used for printing and source level
debugging, and is typically available in interactive <span class="rlang"><b>R</b></span> sessions,
namely when <code><a href="#topic+options">options</a>(keep.source = TRUE)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srcfile(filename, encoding = getOption("encoding"), Enc = "unknown")
srcfilecopy(filename, lines, timestamp = Sys.time(), isFile = FALSE)
srcfilealias(filename, srcfile)
getSrcLines(srcfile, first, last)
srcref(srcfile, lloc)
## S3 method for class 'srcfile'
print(x, ...)
## S3 method for class 'srcfile'
summary(object, ...)
## S3 method for class 'srcfile'
open(con, line, ...)
## S3 method for class 'srcfile'
close(con, ...)
## S3 method for class 'srcref'
print(x, useSource = TRUE, ...)
## S3 method for class 'srcref'
summary(object, useSource = FALSE, ...)
## S3 method for class 'srcref'
as.character(x, useSource = TRUE, to = x, ...)
.isOpen(srcfile)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="srcfile_+3A_filename">filename</code></td>
<td>
<p> The name of a file. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_encoding">encoding</code></td>
<td>
<p> The character encoding to assume for the file. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_enc">Enc</code></td>
<td>
<p> The encoding with which to make strings: see the
<code>encoding</code> argument of <code><a href="#topic+parse">parse</a></code>.</p>
</td></tr>
<tr><td><code id="srcfile_+3A_lines">lines</code></td>
<td>
<p> A character vector of source lines.  Other <span class="rlang"><b>R</b></span> objects
will be coerced to character. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_timestamp">timestamp</code></td>
<td>
<p> The timestamp to use on a copy of a file. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_isfile">isFile</code></td>
<td>
<p> Is this <code>srcfilecopy</code> known to come from a file system file? </p>
</td></tr>
<tr><td><code id="srcfile_+3A_srcfile">srcfile</code></td>
<td>
<p> A <code>srcfile</code> object. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_first">first</code>, <code id="srcfile_+3A_last">last</code>, <code id="srcfile_+3A_line">line</code></td>
<td>
<p> Line numbers. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_lloc">lloc</code></td>
<td>
<p> A vector of four, six or eight values giving a source location; see
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="srcfile_+3A_x">x</code>, <code id="srcfile_+3A_object">object</code>, <code id="srcfile_+3A_con">con</code></td>
<td>
<p> An object of the appropriate class. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_usesource">useSource</code></td>
<td>
<p> Whether to read the <code>srcfile</code> to obtain the
text of a <code>srcref</code>. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_to">to</code></td>
<td>
<p> An optional second <code>srcref</code> object to mark the end
of the character range. </p>
</td></tr>
<tr><td><code id="srcfile_+3A_...">...</code></td>
<td>
<p> Additional arguments to the methods; these will be ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions and classes handle source code references.
</p>
<p>The <code>srcfile</code> function produces an object of class
<code>srcfile</code>, which contains the name and directory of a source code
file, along with its timestamp, for use in source level debugging (not
yet implemented) and source echoing.  The encoding of the file is
saved; see <code><a href="#topic+file">file</a></code> for a discussion of encodings, and
<code><a href="#topic+iconvlist">iconvlist</a></code> for a list of allowable encodings on your platform.
</p>
<p>The <code>srcfilecopy</code> function produces an object of the descendant
class <code>srcfilecopy</code>, which saves the source lines in a character
vector.  It copies the value of the <code>isFile</code> argument, to help
debuggers identify whether this text comes from a real file in the
file system.
</p>
<p>The <code>srcfilealias</code> function produces an object of the descendant
class <code>srcfilealias</code>, which gives an alternate name to another
<code>srcfile</code>.  This is produced by the parser when a <code>#line</code> directive
is used.
</p>
<p>The <code>getSrcLines</code> function reads the specified lines from
<code>srcfile</code>.
</p>
<p>The <code>srcref</code> function produces an object of class
<code>srcref</code>, which describes a range of characters in a
<code>srcfile</code>.
The <code>lloc</code> value gives the following values:
</p>
<pre>c(first_line, first_byte, last_line, last_byte, first_column,
  last_column, first_parsed, last_parsed)
</pre>
<p>Bytes (elements 2, 4) and
columns (elements 5, 6) may be different due to multibyte
characters.  If only four values are given, the columns and bytes
are assumed to match.  Lines (elements 1, 3) and parsed lines
(elements 7, 8) may differ if a <code>#line</code> directive is used in
code:  the former will respect the directive, the latter will just
count lines.  If only 4 or 6 elements are given, the parsed lines
will be assumed to match the lines.
</p>
<p>Methods are defined for <code>print</code>, <code>summary</code>, <code>open</code>,
and <code>close</code> for classes <code>srcfile</code> and <code>srcfilecopy</code>.
The <code>open</code> method opens its internal <code><a href="#topic+file">file</a></code> connection at
a particular line; if it was already open, it will be repositioned
to that line.
</p>
<p>Methods are defined for <code>print</code>, <code>summary</code> and
<code>as.character</code> for class <code>srcref</code>.  The <code>as.character</code>
method will read the associated source file to obtain the text
corresponding to the reference.  If the <code>to</code> argument is given,
it should be a second <code>srcref</code> that follows the first, in the
same file; they will be treated as one reference to the whole
range.  The exact behaviour depends on the
class of the source file.  If the source file inherits from
class <code>srcfilecopy</code>, the lines are taken from the saved copy
using the &ldquo;parsed&rdquo; line counts.  If not, an attempt
is made to read the file, and the original line numbers of the
<code>srcref</code> record (i.e., elements 1 and 3) are used.  If an error
occurs (e.g., the file no longer exists), text like
&lsquo;<span class="samp">&#8288;&lt;srcref: "file" chars 1:1 to 2:10&gt;&#8288;</span>&rsquo; will be returned instead,
indicating the <code>line:column</code> ranges of the first and last
character.  The <code>summary</code> method defaults to this type of
display.
</p>
<p>Lists of <code>srcref</code> objects may be attached to expressions as the
<code>"srcref"</code> attribute.  (The list of <code>srcref</code> objects should be the same
length as the expression.)  By default, expressions are printed by
<code><a href="#topic+print.default">print.default</a></code> using the associated <code>srcref</code>.  To
see deparsed code instead, call <code><a href="#topic+print">print</a></code> with argument
<code>useSource = FALSE</code>.  If a <code>srcref</code> object
is printed with <code>useSource = FALSE</code>, the &lsquo;<span class="samp">&#8288;&lt;srcref: ....&gt;&#8288;</span>&rsquo;
record will be printed.
</p>
<p><code>.isOpen</code> is intended for internal use:  it checks whether the
connection associated with a <code>srcfile</code> object is open.
</p>


<h3>Value</h3>

<p><code>srcfile</code> returns a <code>srcfile</code> object.
</p>
<p><code>srcfilecopy</code> returns a <code>srcfilecopy</code> object.
</p>
<p><code>getSrcLines</code> returns a character vector of source code lines.
</p>
<p><code>srcref</code> returns a <code>srcref</code> object.
</p>


<h3>Author(s)</h3>

<p>Duncan Murdoch</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+getSrcFilename">getSrcFilename</a></code> for extracting information from a source
reference, or <code><a href="utils.html#topic+removeSource">removeSource</a></code> to remove it from a
(non-primitive) function (aka &lsquo;closure&rsquo;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>src &lt;- srcfile(system.file("DESCRIPTION", package = "base"))
summary(src)
getSrcLines(src, 1, 4)
ref &lt;- srcref(src, c(1, 1, 2, 1000))
ref
print(ref, useSource = FALSE)
</code></pre>

<hr>
<h2 id='StackOverflows'>Stack Overflow Errors</h2><span id='topic+StackOverflows'></span><span id='topic+stackOverflowError'></span><span id='topic+CStackOverflowError'></span><span id='topic+expressionStackOverflowError'></span><span id='topic+protectStackOverflowError'></span><span id='topic+nodeStackOverflowError'></span>

<h3>Description</h3>

<p>Errors signaled by <span class="rlang"><b>R</b></span> when stacks used in evaluation overflow.
</p>


<h3>Details</h3>

<p><span class="rlang"><b>R</b></span> uses several stacks in evaluating expressions: the C stack, the
pointer protection stack, and the node stack used by the byte code
engine. In addition, the number of nested <span class="rlang"><b>R</b></span> expressions currently
under evaluation is limited by the value set as
<code><a href="#topic+options">options</a>("expressions")</code>.  Overflowing these stacks or
limits signals an error that inherits from classes
<code>stackOverflowError</code>, <code>error</code>, and <code>condition</code>.
</p>
<p>The specific classes signaled are:
</p>

<ul>
<li> <p><code>CStackOverflowError</code>: Signaled when the C stack
overflows. The <code>usage</code> field of the error object contains the
current stack usage.
</p>
</li>
<li> <p><code>protectStackOverflowError</code>: Signaled when the pointer
protection stack overflows.
</p>
</li>
<li> <p><code>nodeStackOverflowError</code>: Signaled when the node stack
used by the byte code engine overflows.
</p>
</li>
<li> <p><code>expressionStackOverflowError</code>: Signaled when the the
evaluation depth, the number of nested <span class="rlang"><b>R</b></span> expressions currently
under evaluation, exceeds the limit set by
<code><a href="#topic+options">options</a>("expressions")</code>
</p>
</li></ul>

<p>Stack overflow errors can be caught and handled by exiting handlers
established with <code><a href="#topic+tryCatch">tryCatch</a>()</code> Calling handlers established
by <code><a href="#topic+withCallingHandlers">withCallingHandlers</a>()</code> may fail since there may not be
enough stack space to run the handler. In this case the next available
exiting handler will be run, or error handling will fall back to the
default handler. Default handlers set by
<code><a href="#topic+tryCatch">tryCatch</a>("error")</code> may also fail to run in a stack
overflow situation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Cstack_info">Cstack_info</a></code> for information on the environment and the
evaluation depth limit.
</p>
<p><code><a href="#topic+Memory">Memory</a></code> and <code><a href="#topic+options">options</a></code> for information on the
protection stack.
</p>

<hr>
<h2 id='standardGeneric'>Formal Method System &ndash; Dispatching S4 Methods</h2><span id='topic+standardGeneric'></span>

<h3>Description</h3>

<p>The function <code>standardGeneric</code> initiates dispatch of S4
methods: see the references and the documentation of the
<span class="pkg">methods</span> package.  Usually, calls to this function are
generated automatically and not explicitly by the programmer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardGeneric(f, fdef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standardGeneric_+3A_f">f</code></td>
<td>

<p>The name of the generic.
</p>
</td></tr>
<tr><td><code id="standardGeneric_+3A_fdef">fdef</code></td>
<td>

<p>The generic function definition. Never passed when
defining a new generic.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>standardGeneric</code> dispatches the method defined for a generic
function named <code>f</code>, using the actual arguments in the frame from which
it is called.
</p>
<p>The argument <code>fdef</code> is inserted (automatically) when dispatching
methods for a primitive function.  If present, it must always be the function
definition for the corresponding generic.  Don't insert this argument
by hand, as there is no validity checking and miss-specifying the
function definition will cause certain failure.
</p>
<p>For more, use the <span class="pkg">methods</span> package, and see the documentation in
<code><a href="methods.html#topic+GenericFunctions">GenericFunctions</a></code>.
</p>


<h3>Author(s)</h3>

<p> John Chambers </p>


<h3>References</h3>

<p>Chambers, John M. (2008)
<em>Software for Data Analysis: Programming with R</em>
Springer.  (For the R version.)
</p>
<p>Chambers, John M. (1998)
<em>Programming with Data</em>
Springer (For the original S4 version.)
</p>

<hr>
<h2 id='startsWith'>Does String Start or End With Another String?</h2><span id='topic+endsWith'></span><span id='topic+startsWith'></span>

<h3>Description</h3>

<p>Determines if entries of <code>x</code> start or end with string (entries of)
<code>prefix</code> or <code>suffix</code> respectively, where strings are
recycled to common lengths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startsWith(x, prefix)
  endsWith(x, suffix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startsWith_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+character">character</a></code> vector whose &ldquo;starts&rdquo; or
&ldquo;ends&rdquo; are considered.</p>
</td></tr>
<tr><td><code id="startsWith_+3A_prefix">prefix</code>, <code id="startsWith_+3A_suffix">suffix</code></td>
<td>
<p><code><a href="#topic+character">character</a></code> vector, typically of length
one, i.e., a string.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startsWith()</code> is equivalent to but much faster than
</p>
<pre>  substring(x, 1, nchar(prefix)) == prefix  </pre>
<p>or also
</p>
<pre>  grepl("^&lt;prefix&gt;", x)  </pre>
<p>where <code>prefix</code> is not to contain special regular expression
characters (and for <code>grepl</code>, <code>x</code> does not contain missing
values, see below).
</p>
<p>The code has an optimized branch for the most common usage in which
<code>prefix</code> or <code>suffix</code> is of length one, and is further
optimized in a UTF-8 or 8-byte locale if that is an ASCII string.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+logical">logical</a></code> vector, of &ldquo;common length&rdquo; of <code>x</code>
and <code>prefix</code> (or <code>suffix</code>), i.e., of the longer of the two
lengths unless one of them is zero when the result is
also of zero length.  A shorter input is recycled to the output length.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grepl">grepl</a></code>, <code><a href="#topic+substring">substring</a></code>; the partial string
matching functions <code><a href="#topic+charmatch">charmatch</a></code> and <code><a href="#topic+pmatch">pmatch</a></code>
solve a different task.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>startsWith(search(), "package:") # typically at least two FALSE, nowadays often three

x1 &lt;- c("Foobar", "bla bla", "something", "another", "blu", "brown",
        "blau blüht der Enzian")# non-ASCII
x2 &lt;- cbind(
      startsWith(x1, "b"),
      startsWith(x1, "bl"),
      startsWith(x1, "bla"),
        endsWith(x1, "n"),
        endsWith(x1, "an"))
rownames(x2) &lt;- x1; colnames(x2) &lt;- c("b", "b1", "bla", "n", "an")
x2

## Non-equivalence in case of missing values in 'x', see Details:
x &lt;- c("all", "but", NA_character_)
cbind(startsWith(x, "a"),
      substring(x, 1L, 1L) == "a",
      grepl("^a", x))
</code></pre>

<hr>
<h2 id='Startup'>Initialization at Start of an R Session</h2><span id='topic+Startup'></span><span id='topic+Rprofile'></span><span id='topic+.Rprofile'></span><span id='topic+Rprofile.site'></span><span id='topic+Renviron'></span><span id='topic+Renviron.site'></span><span id='topic+.Renviron'></span><span id='topic+.First'></span><span id='topic+.First.sys'></span><span id='topic+.OptRequireMethods'></span><span id='topic+R_DEFAULT_PACKAGES'></span><span id='topic+R_ENVIRON'></span><span id='topic+R_ENVIRON_USER'></span><span id='topic+R_PROFILE'></span><span id='topic+R_PROFILE_USER'></span>

<h3>Description</h3>

<p>In <span class="rlang"><b>R</b></span>, the startup mechanism is as follows.
</p>
<p>Unless <span class="option">--no-environ</span> was given on the command line, <span class="rlang"><b>R</b></span>
searches for site and user files to process for setting environment
variables.  The name of the site file is the one pointed to by the
environment variable <span class="env">R_ENVIRON</span>; if this is unset,
&lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/Renviron.site</span>&rsquo; is used (if it exists,
which it does not in a &lsquo;factory-fresh&rsquo; installation).  The name
of the user file can be specified by the <span class="env">R_ENVIRON_USER</span>
environment variable; if this is unset, the files searched for are
&lsquo;<span class="file">.Renviron</span>&rsquo; in the current or in the user's home directory (in
that order).  See &lsquo;Details&rsquo; for how the files are read.
</p>
<p>Then <span class="rlang"><b>R</b></span> searches for the site-wide startup profile file of <span class="rlang"><b>R</b></span> code
unless the command line option <span class="option">--no-site-file</span> was given.  The
path of this file is taken from the value of the <span class="env">R_PROFILE</span>
environment variable (after <a href="#topic+tilde+20expansion">tilde expansion</a>).  If this variable
is unset, the default is &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/Rprofile.site</span>&rsquo;,
which is used if it exists
(which it does not in a &lsquo;factory-fresh&rsquo; installation).
This code is sourced into the workspace (global environment).  Users need
to be careful not to unintentionally create objects in the workspace, and
it is normally advisable to use <code><a href="#topic+local">local</a></code> if code needs to be
executed: see the examples.  <code>.Library.site</code> may be assigned to and
the assignment will effectively modify the value of the variable in the
base namespace where <code><a href="#topic+.libPaths">.libPaths</a>()</code> finds it.  One may also
assign to <code>.First</code> and <code>.Last</code>, but assigning to other variables
in the execution environment is not recommended and does not work in
some older versions of <span class="rlang"><b>R</b></span>.
</p>
<p>Then, unless <span class="option">--no-init-file</span> was given, <span class="rlang"><b>R</b></span> searches for a user
profile, a file of <span class="rlang"><b>R</b></span> code.  The path of this file can be specified by
the <span class="env">R_PROFILE_USER</span> environment variable (and
<a href="#topic+tilde+20expansion">tilde expansion</a> will be performed).  If this is unset, a file
called &lsquo;<span class="file">.Rprofile</span>&rsquo; is searched for in the current directory or in
the user's home directory (in that order).  The user profile file is
sourced into the workspace.
</p>
<p>Note that when the site and user profile files are sourced only the
<span class="pkg">base</span> package is loaded, so objects in other packages need to be
referred to by e.g. <code>utils::dump.frames</code> or after explicitly
loading the package concerned.
</p>
<p><span class="rlang"><b>R</b></span> then loads a saved image of the user workspace from &lsquo;<span class="file">.RData</span>&rsquo;
in the current directory if there is one (unless
<span class="option">--no-restore-data</span> or <span class="option">--no-restore</span> was specified on
the command line).
</p>
<p>Next, if a function <code>.First</code> is found on the search path,
it is executed as <code>.First()</code>.  Finally, function
<code>.First.sys()</code> in the <span class="pkg">base</span> package is run.  This calls
<code><a href="#topic+require">require</a></code> to attach the default packages specified by
<code><a href="#topic+options">options</a>("defaultPackages")</code>.  If the <span class="pkg">methods</span>
package is included, this will have been attached earlier (by function
<code>.OptRequireMethods()</code>) so that namespace initializations such
as those from the user workspace will proceed correctly.
</p>
<p>A function <code>.First</code> (and <code><a href="#topic+.Last">.Last</a></code>) can be defined in
appropriate &lsquo;<span class="file">.Rprofile</span>&rsquo; or &lsquo;<span class="file">Rprofile.site</span>&rsquo; files or have
been saved in &lsquo;<span class="file">.RData</span>&rsquo;.  If you want a different set of packages
than the default ones when you start, insert a call to
<code><a href="#topic+options">options</a></code> in the &lsquo;<span class="file">.Rprofile</span>&rsquo; or &lsquo;<span class="file">Rprofile.site</span>&rsquo;
file.  For example, <code>options(defaultPackages = character())</code> will
attach no extra packages on startup (only the <span class="pkg">base</span> package) (or
set <code>R_DEFAULT_PACKAGES=NULL</code> as an environment variable before
running <span class="rlang"><b>R</b></span>).  Using <code>options(defaultPackages = "")</code> or
<code>R_DEFAULT_PACKAGES=""</code> enforces the R <em>system</em> default.
</p>
<p>On front-ends which support it, the commands history is read from the
file specified by the environment variable <span class="env">R_HISTFILE</span> (default
&lsquo;<span class="file">.Rhistory</span>&rsquo; in the current directory) unless
<span class="option">--no-restore-history</span> or <span class="option">--no-restore</span> was specified.
</p>
<p>The command-line option <span class="option">--vanilla</span> implies
<span class="option">--no-site-file</span>, <span class="option">--no-init-file</span>,
<span class="option">--no-environ</span> and (except for <code>R CMD</code>)
<span class="option">--no-restore</span>
</p>


<h3>Details</h3>

<p>Note that there are two sorts of files used in startup:
<em>environment files</em> which contain lists of environment variables
to be set, and <em>profile files</em> which contain <span class="rlang"><b>R</b></span> code.
</p>
<p>Lines in a site or user environment file should be either comment
lines starting with <code>#</code>, or lines of the form
<code><var>name</var>=<var>value</var></code>. The latter sets the environmental
variable <code><var>name</var></code> to <code><var>value</var></code>, overriding an
existing value.  If <code><var>value</var></code> contains an expression of the
form <code>${foo-bar}</code>, the value is that of the environmental
variable <code>foo</code> if that is set, otherwise <code>bar</code>.  For
<code>${foo:-bar}</code>, the value is that of <code>foo</code> if that is set to
a non-empty value, otherwise <code>bar</code>.  (If it is of the form
<code>${foo}</code>, the default is <code>""</code>.)  This construction can be
nested, so <code>bar</code> can be of the same form (as in
<code>${foo-${bar-blah}}</code>).  Note that the braces are essential: for
example <code>$HOME</code> will not be interpreted.
</p>
<p>Leading and trailing white space in <code><var>value</var></code> are stripped.
<code><var>value</var></code> is then processed in a similar way to a Unix shell:
in particular (single or double) quotes not preceded by backslash
are removed and backslashes are removed except inside such quotes.
</p>
<p>For readability and future compatibility it is recommended to only use
constructs that have the same behavior as in a Unix shell.  Hence,
expansions of variables should be in double quotes (e.g. 
<code>"${HOME}"</code>, in case they may contain a backslash) and literals
including a backslash should be in single quotes. If a variable value
may end in a backslash, such as <code>PATH</code> on Windows, it may be
necessary to protect the following quote from it, e.g. <code>"${PATH}/"</code>.
It is recommended to use forward slashes instead of backslashes.
It is ok to mix text in single and double quotes, see examples below.
</p>
<p>On systems with sub-architectures (mainly Windows), the
files &lsquo;<span class="file">Renviron.site</span>&rsquo; and &lsquo;<span class="file">Rprofile.site</span>&rsquo; are looked for
first in architecture-specific directories,
e.g. &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/i386/Renviron.site</span>&rsquo;.
And e.g. &lsquo;<span class="file">.Renviron.i386</span>&rsquo; will be used in preference
to &lsquo;<span class="file">.Renviron</span>&rsquo;.
</p>
<p>There is a 100,000 byte limit on the length of a line (after expansions)
in environment files.
</p>


<h3>Note</h3>

<p>It is not intended that there be interaction with the user during
startup code.  Attempting to do so can crash the <span class="rlang"><b>R</b></span> process.
</p>
<p>On Unix versions of <span class="rlang"><b>R</b></span> there is also a  file
&lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/Renviron</span>&rsquo; which is read very early in
the start-up processing.  It contains environment variables set by <span class="rlang"><b>R</b></span>
in the configure process.  Values in that file can be overridden in
site or user environment files: do not change
&lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/Renviron</span>&rsquo; itself.  Note that this is
distinct from &lsquo;<span class="file"><var><a href="#topic+R_HOME">R_HOME</a></var>/etc/Renviron.site</span>&rsquo;.
</p>
<p>Command-line options may well not apply to alternative front-ends:
they do not apply to <code>R.app</code> on macOS.
</p>
<p><code>R CMD check</code> and <code>R CMD build</code> do not always read the
standard startup files, but they do always read specific
&lsquo;<span class="samp">&#8288;Renviron&#8288;</span>&rsquo; files.  The location of these can be controlled by the
environment variables <span class="env">R_CHECK_ENVIRON</span> and <span class="env">R_BUILD_ENVIRON</span>.
If these are set their value is used as the path for the
&lsquo;<span class="samp">&#8288;Renviron&#8288;</span>&rsquo; file; otherwise, files &lsquo;<span class="file">~/.R/check.Renviron</span>&rsquo; or
&lsquo;<span class="file">~/.R/build.Renviron</span>&rsquo; or sub-architecture-specific versions are
employed.
</p>
<p>If you want &lsquo;<span class="file">~/.Renviron</span>&rsquo; or &lsquo;<span class="file">~/.Rprofile</span>&rsquo; to be ignored by
child <span class="rlang"><b>R</b></span> processes (such as those run by <code>R CMD check</code> and
<code>R CMD build</code>), set the appropriate environment variable
<span class="env">R_ENVIRON_USER</span> or <span class="env">R_PROFILE_USER</span> to (if possible, which it
is not on Windows) <code>""</code> or to the name of a non-existent file.
</p>





<h3>See Also</h3>

<p>For the definition of the &lsquo;home&rsquo; directory on Windows see the
&lsquo;<span class="file">rw-FAQ</span>&rsquo; Q2.14.  It can be found from a running <span class="rlang"><b>R</b></span> by
<code>Sys.getenv("R_USER")</code>.
</p>
<p><code><a href="#topic+.Last">.Last</a></code> for final actions at the close of an <span class="rlang"><b>R</b></span> session.
<code><a href="#topic+commandArgs">commandArgs</a></code> for accessing the command line arguments.
</p>
<p>There are examples of using startup files to set defaults for graphics
devices in the help for
<code><a href="grDevices.html#topic+X11">X11</a></code> and <code><a href="grDevices.html#topic+quartz">quartz</a></code>.
</p>
<p><em>An Introduction to R</em> for more command-line options: those
affecting memory management are covered in the help file for
<a href="#topic+Memory">Memory</a>.
</p>
<p><code><a href="#topic+readRenviron">readRenviron</a></code> to read &lsquo;<span class="file">.Renviron</span>&rsquo; files.
</p>
<p>For profiling code, see <code><a href="utils.html#topic+Rprof">Rprof</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example ~/.Renviron on Unix
R_LIBS=~/R/library
PAGER=/usr/local/bin/less

## Example .Renviron on Windows
R_LIBS=C:/R/library
MY_TCLTK="c:/Program Files/Tcl/bin"
# Variable expansion in double quotes, string literals with backslashes in
# single quotes.
R_LIBS_USER="${APPDATA}"'\R-library'

## Example of setting R_DEFAULT_PACKAGES (from R CMD check)
R_DEFAULT_PACKAGES='utils,grDevices,graphics,stats'
# this loads the packages in the order given, so they appear on
# the search path in reverse order.

## Example of .Rprofile
options(width=65, digits=5)
options(show.signif.stars=FALSE)
setHook(packageEvent("grDevices", "onLoad"),
        function(...) grDevices::ps.options(horizontal=FALSE))
set.seed(1234)
.First &lt;- function() cat("\n   Welcome to R!\n\n")
.Last &lt;- function()  cat("\n   Goodbye!\n\n")

## Example of Rprofile.site
local({
  # add MASS to the default packages, set a CRAN mirror
  old &lt;- getOption("defaultPackages"); r &lt;- getOption("repos")
  r["CRAN"] &lt;- "http://my.local.cran"
  options(defaultPackages = c(old, "MASS"), repos = r)
  ## (for Unix terminal users) set the width from COLUMNS if set
  cols &lt;- Sys.getenv("COLUMNS")
  if(nzchar(cols)) options(width = as.integer(cols))
  # interactive sessions get a fortune cookie (needs fortunes package)
  if (interactive())
    fortunes::fortune()
})

## if .Renviron contains
FOOBAR="coo\bar"doh\ex"abc\"def'"

## then we get
# &gt; cat(Sys.getenv("FOOBAR"), "\n")
# coo\bardoh\exabc"def'

## End(Not run)</code></pre>

<hr>
<h2 id='stop'>Stop Function Execution</h2><span id='topic+stop'></span><span id='topic+geterrmessage'></span>

<h3>Description</h3>

<p><code>stop</code> stops execution of the current expression and executes
an error action.
</p>
<p><code>geterrmessage</code> gives the last error message.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop(..., call. = TRUE, domain = NULL)
geterrmessage()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stop_+3A_...">...</code></td>
<td>
<p>zero or more objects which can be coerced to character
(and which are pasted together with no separator) or a single
condition object.</p>
</td></tr>
<tr><td><code id="stop_+3A_call.">call.</code></td>
<td>
<p>logical, indicating if the call should become part of the
error message.</p>
</td></tr>
<tr><td><code id="stop_+3A_domain">domain</code></td>
<td>
<p>see <code><a href="#topic+gettext">gettext</a></code>.  If <code>NA</code>, messages will
not be translated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The error action is controlled by error handlers established within
the executing code and by the current default error handler set by
<code>options(error=)</code>.  The error is first signaled as if using
<code><a href="#topic+signalCondition">signalCondition</a>()</code>.  If there are no handlers or if all handlers
return, then the error message is printed (if
<code>options("show.error.messages")</code> is true) and the default error
handler is used.  The default behaviour (the <code>NULL</code>
error-handler) in interactive use is to return to the top level
prompt or the top level browser, and in non-interactive use to
(effectively) call <code><a href="#topic+q">q</a>("no", status = 1, runLast = FALSE)</code>
unless <code><a href="#topic+getOption">getOption</a>("catch.script.errors")</code> is true.
</p>
<p>The default handler stores the error message in a buffer; it can be
retrieved by <code>geterrmessage()</code>.  It also stores a trace of
the call stack that can be retrieved by <code><a href="#topic+traceback">traceback</a>()</code>.
</p>
<p>Errors will be truncated to <code>getOption("warning.length")</code>
characters, default 1000.
</p>
<p>If a condition object is supplied it should be the only argument, and
further arguments will be ignored, with a warning.
</p>


<h3>Value</h3>

<p><code>geterrmessage</code> gives the last error message, as a character string
ending in <code>"\n"</code>.
</p>


<h3>Note</h3>

<p>Use <code>domain = NA</code> whenever <code>...</code> contain a
result from <code><a href="#topic+gettextf">gettextf</a>()</code> as that is translated already.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+warning">warning</a></code>, <code><a href="#topic+try">try</a></code> to catch errors and retry,
and <code><a href="#topic+options">options</a></code> for setting error handlers.
<code><a href="#topic+stopifnot">stopifnot</a></code> for validity testing.  <code>tryCatch</code>
and <code>withCallingHandlers</code> can be used to establish custom handlers
while executing an expression.
</p>
<p><code><a href="#topic+gettext">gettext</a></code> for the mechanisms for the automated translation
of messages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iter &lt;- 12
try(if(iter &gt; 10) stop("too many iterations"))

tst1 &lt;- function(...) stop("dummy error")
try(tst1(1:10, long, calling, expression))

tst2 &lt;- function(...) stop("dummy error", call. = FALSE)
try(tst2(1:10, longcalling, expression, but.not.seen.in.Error))
</code></pre>

<hr>
<h2 id='stopifnot'>Ensure the Truth of R Expressions</h2><span id='topic+stopifnot'></span>

<h3>Description</h3>

<p>If any of the expressions (in <code>...</code> or <code>exprs</code>) are not
<code><a href="#topic+all">all</a></code> <code>TRUE</code>, <code><a href="#topic+stop">stop</a></code> is called, producing
an error message indicating the <em>first</em> expression which was not
(<code><a href="#topic+all">all</a></code>) true.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stopifnot(..., exprs, exprObject, local = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stopifnot_+3A_...">...</code>, <code id="stopifnot_+3A_exprs">exprs</code></td>
<td>
<p>any number of <span class="rlang"><b>R</b></span> expressions, which should each
evaluate to (a logical vector of all) <code><a href="#topic+TRUE">TRUE</a></code>.  Use
<em>either</em> <code>...</code> <em>or</em>
<code>exprs</code>, the latter typically an unevaluated expression of the
form </p>
<pre>{
   expr1
   expr2
   ....
}</pre>
<p>Note that e.g., positive numbers are <em>not</em> <code>TRUE</code>, even when
they are coerced to <code>TRUE</code>, e.g., inside <code>if(.)</code> or in
arithmetic computations in <span class="rlang"><b>R</b></span>.
</p>
<p>If names are provided to <code>...</code>, they will be used in lieu of
the default error message.
</p>
</td></tr>
<tr><td><code id="stopifnot_+3A_exprobject">exprObject</code></td>
<td>
<p>alternative to <code>exprs</code> or <code>...</code>:
an &lsquo;expression-like&rsquo; object, typically an
<code><a href="#topic+expression">expression</a></code>, but also a <code><a href="#topic+call">call</a></code>, a
<code><a href="#topic+name">name</a></code>, or atomic constant such as <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="stopifnot_+3A_local">local</code></td>
<td>
<p>(only when <code>exprs</code> is used:) indicates the
<code><a href="#topic+environment">environment</a></code> in which the expressions should be
evaluated; by default the one from where <code>stopifnot()</code> has been
called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended for use in regression tests or also argument
checking of functions, in particular to make them easier to read.
</p>
<p><code>stopifnot(A, B)</code> or equivalently <code>stopifnot(exprs= {A ;
      B})</code> are conceptually equivalent to </p>
<pre> { if(any(is.na(A)) || !all(A)) stop(...);
   if(any(is.na(B)) || !all(B)) stop(...) }</pre>
<p>Since <span class="rlang"><b>R</b></span> version 3.6.0, <code>stopifnot()</code> no longer handles potential
errors or warnings (by <code><a href="#topic+tryCatch">tryCatch</a>()</code> etc) for each single
expression
and may use <code><a href="#topic+sys.call">sys.call</a>(<var>n</var>)</code> to get a meaningful and short
error message in case an expression did not evaluate to all TRUE.  This
provides considerably less overhead.
</p>
<p>Since <span class="rlang"><b>R</b></span> version 3.5.0, expressions <em>are</em> evaluated sequentially,
and hence evaluation stops as soon as there is a &ldquo;non-TRUE&rdquo;, as
indicated by the above conceptual equivalence statement.





</p>
<p>Also, since <span class="rlang"><b>R</b></span> version 3.5.0, <code>stopifnot(exprs = { ... })</code> can be used
alternatively and may be preferable in the case of several
expressions, as they are more conveniently evaluated interactively
(&ldquo;no extraneous <code>,</code> &rdquo;).
</p>
<p>Since <span class="rlang"><b>R</b></span> version 3.4.0, when an expression (from <code>...</code>) is not
true <em>and</em> is a call to <code><a href="#topic+all.equal">all.equal</a></code>, the error
message will report the (first part of the) differences reported by
<code><a href="#topic+all.equal">all.equal</a>(*)</code>; since <span class="rlang"><b>R</b></span> 4.3.0, this happens for all calls
where <code>"all.equal"</code> <code><a href="#topic+pmatch">pmatch</a>()</code>es the function called,
e.g., when that is called <code>all.equalShow</code>, see the example in
<code><a href="#topic+all.equal">all.equal</a></code>.
</p>


<h3>Value</h3>

<p>(<code><a href="#topic+NULL">NULL</a></code> if all statements in <code>...</code> are <code>TRUE</code>.)
</p>


<h3>Note</h3>

<p>Trying to use the <code>stopifnot(exprs = ..)</code> version via a shortcut,
say, </p>
<pre> assertWRONG &lt;- function(exprs) stopifnot(exprs = exprs) </pre>
<p>is delicate and the above is <em>not a good idea</em>.  Contrary to <code>stopifnot()</code>
which takes care to evaluate the parts of <code>exprs</code> one by one and
stop at the first non-TRUE, the above short cut would typically evaluate
all parts of <code>exprs</code> and pass the result, i.e., typically of the
<em>last</em> entry of <code>exprs</code> to <code>stopifnot()</code>.
</p>
<p>However, a more careful version, </p>
<pre> assert &lt;- function(exprs) eval.parent(substitute(stopifnot(exprs = exprs))) </pre>
<p>may be a nice short cut for <code>stopifnot(exprs = *)</code> calls using the
more commonly known verb as function name.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stop">stop</a></code>, <code><a href="#topic+warning">warning</a></code>;
<code><a href="tools.html#topic+assertCondition">assertCondition</a></code> in package <span class="pkg">tools</span> complements
<code>stopifnot()</code> for testing warnings and errors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NB: Some of these examples are expected to produce an error. To
##     prevent them from terminating a run with example() they are
##     piped into a call to try().

stopifnot(1 == 1, all.equal(pi, 3.14159265), 1 &lt; 2) # all TRUE

m &lt;- matrix(c(1,3,3,1), 2, 2)
stopifnot(m == t(m), diag(m) == rep(1, 2)) # all(.) |=&gt;  TRUE

stopifnot(length(10)) |&gt; try() # gives an error: '1' is *not* TRUE
## even when   if(1) "ok"   works

stopifnot(all.equal(pi, 3.141593),  2 &lt; 2, (1:10 &lt; 12), "a" &lt; "b") |&gt; try()
## More convenient for interactive "line by line" evaluation:
stopifnot(exprs = {
  all.equal(pi, 3.1415927)
  2 &lt; 2
  1:10 &lt; 12
  "a" &lt; "b"
}) |&gt; try()

eObj &lt;- expression(2 &lt; 3, 3 &lt;= 3:6, 1:10 &lt; 2)
stopifnot(exprObject = eObj) |&gt; try()
stopifnot(exprObject = quote(3 == 3))
stopifnot(exprObject = TRUE)


# long all.equal() error messages are abbreviated:
stopifnot(all.equal(rep(list(pi),4), list(3.1, 3.14, 3.141, 3.1415))) |&gt; try()

# The default error message can be overridden to be more informative:
m[1,2] &lt;- 12
stopifnot("m must be symmetric"= m == t(m)) |&gt; try()
#=&gt; Error: m must be symmetric

##' warnifnot(): a "only-warning" version of stopifnot()
##'   {Yes, learn how to use do.call(substitute, ...) in a powerful manner !!}
warnifnot &lt;- stopifnot ; N &lt;- length(bdy &lt;- body(warnifnot))
bdy        &lt;- do.call(substitute, list(bdy,   list(stopifnot = quote(warnifnot))))
bdy[[N-1]] &lt;- do.call(substitute, list(bdy[[N-1]], list(stop = quote(warning))))
body(warnifnot) &lt;- bdy
warnifnot(1 == 1, 1 &lt; 2, 2 &lt; 2) # =&gt; warns " 2 &lt; 2 is not TRUE  "
warnifnot(exprs = {
    1 == 1
    3 &lt; 3  # =&gt; warns "3 &lt; 3 is not TRUE"
})
</code></pre>

<hr>
<h2 id='strptime'>Date-time Conversion Functions to and from Character</h2><span id='topic+format.POSIXct'></span><span id='topic+format.POSIXlt'></span><span id='topic+strftime'></span><span id='topic+strptime'></span><span id='topic+as.character.POSIXt'></span>

<h3>Description</h3>

<p>Functions to convert between character representations and objects of
classes <code>"POSIXlt"</code> and <code>"POSIXct"</code> representing calendar
dates and times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXct'
format(x, format = "", tz = "", usetz = FALSE, ...)
## S3 method for class 'POSIXlt'
format(x, format = "", usetz = FALSE,
       digits = getOption("digits.secs"), ...)

## S3 method for class 'POSIXt'
as.character(x, digits = if(inherits(x, "POSIXlt")) 14L else 6L,
             OutDec = ".", ...)

strftime(x, format = "", tz = "", usetz = FALSE, ...)
strptime(x, format, tz = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strptime_+3A_x">x</code></td>
<td>
<p>an object to be converted: a character vector for
<code>strptime</code>, an object which can be converted to
<code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code> for <code>strftime</code>.</p>
</td></tr>
<tr><td><code id="strptime_+3A_tz">tz</code></td>
<td>
<p>a character string specifying the time zone to be used for
the conversion.  System-specific (see <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code>), but
<code>""</code> is the current time zone, and <code>"GMT"</code> is UTC.
Invalid values are most commonly treated as UTC, on some platforms with
a warning.</p>
</td></tr>
<tr><td><code id="strptime_+3A_format">format</code></td>
<td>
<p>a character string.  The default for the <code>format</code>
methods is
<code>"%Y-%m-%d %H:%M:%S"</code> if any element has a time
component which is not midnight, and <code>"%Y-%m-%d"</code>
otherwise.  If <code><a href="#topic+options">options</a>("digits.secs")</code> is set, up to
the specified number of digits will be printed for seconds.</p>
</td></tr>
<tr><td><code id="strptime_+3A_...">...</code></td>
<td>
<p>further arguments to be passed from or to other methods.</p>
</td></tr>
<tr><td><code id="strptime_+3A_usetz">usetz</code></td>
<td>
<p>logical.  Should the time zone abbreviation be appended
to the output?  This is used in printing times, and more reliable
than using <code>"%Z"</code>.</p>
</td></tr>
<tr><td><code id="strptime_+3A_digits">digits</code></td>
<td>
<p>integer determining the <code>format()</code>ing of seconds when
needed.  Note that the defaults for <code>format()</code> and
<code>as.character()</code> differ on purpose, <code>as.character()</code> giving
close to full accuracy as it does for numbers.</p>
</td></tr>
<tr><td><code id="strptime_+3A_outdec">OutDec</code></td>
<td>
<p>a 1-character string specifying the decimal point to be
used; the default is <em>not</em> <code><a href="#topic+getOption">getOption</a>("OutDec")</code> on
purpose.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>format</code> and <code>as.character</code> methods and <code>strftime</code>
convert objects from the classes <code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code> and
<code>"<a href="#topic+POSIXct">POSIXct</a>"</code> to <code><a href="#topic+character">character</a></code> vectors.
</p>
<p><code>strptime</code> converts character vectors to class <code>"POSIXlt"</code>:
its input <code>x</code> is first converted by <code><a href="#topic+as.character">as.character</a></code>.
Each input string is processed as far as necessary for the format
specified: any trailing characters are ignored.
</p>
<p><code>strftime</code> is a wrapper for <code>format.POSIXlt</code>, and it and
<code>format.POSIXct</code> first convert to class <code>"POSIXlt"</code> by
calling <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> (so they also work for class
<code>"<a href="#topic+Date">Date</a>"</code>).  Note that only that conversion depends on the
time zone.  Since <span class="rlang"><b>R</b></span> version 4.2.0, <code>as.POSIXlt()</code> conversion now
treats the non-finite numeric <code>-Inf</code>, <code>Inf</code>, <code>NA</code> and
<code>NaN</code> differently (where previously all were treated as
<code>NA</code>). Also the <code>format()</code> method for <code>POSIXlt</code> now
treats these different non-finite times and dates analogously to type
<code><a href="#topic+double">double</a></code>.
</p>
<p>The usual vector re-cycling rules are applied to <code>x</code> and
<code>format</code> so the answer will be of length of the longer of these
vectors.
</p>
<p>Locale-specific conversions to and from character strings are used
where appropriate and available.  This affects the names of the days
and months, the AM/PM indicator (if used) and the separators in output
formats such as <code>%x</code> and <code>%X</code>, <em>via</em> the setting of
the <code><a href="#topic+LC_TIME">LC_TIME</a></code> locale category.  The &lsquo;current
locale&rsquo; of the descriptions might mean the locale in use at the start
of the <span class="rlang"><b>R</b></span> session or when these functions are first used.  (For input,
the locale-specific conversions can be changed by calling
<code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code> with category <code>LC_TIME</code> (or
<code>LC_ALL</code>).  For output, what happens depends on the OS but
usually works.)
</p>

<p>The details of the formats are platform-specific, but the following are
likely to be widely available: most are defined by the POSIX standard.
A <em>conversion specification</em> is introduced by <code>%</code>, usually
followed by a single letter or <code>O</code> or <code>E</code> and then a single
letter.  Any character in the format string not part of a conversion
specification is interpreted literally (and <code>%%</code> gives
<code>%</code>).  Widely implemented conversion specifications include
</p>

<dl>
<dt><code>%a</code></dt><dd><p>Abbreviated weekday name in the current
locale on this platform.  (Also matches full name on input:
in some locales there are no abbreviations of names.)</p>
</dd>
<dt><code>%A</code></dt><dd><p>Full weekday name in the current locale.  (Also
matches abbreviated name on input.)</p>
</dd>
<dt><code>%b</code></dt><dd><p>Abbreviated month name in the current locale on
this platform.  (Also matches full name on input: in
some locales there are no abbreviations of names.)</p>
</dd>
<dt><code>%B</code></dt><dd><p>Full month name in the current locale.  (Also
matches abbreviated name on input.)</p>
</dd>
<dt><code>%c</code></dt><dd><p>Date and time.   Locale-specific on output,
<code>"%a %b %e %H:%M:%S %Y"</code> on input.</p>
</dd>
<dt><code>%C</code></dt><dd><p>Century (00&ndash;99): the integer part of the year
divided by 100.</p>
</dd>
<dt><code>%d</code></dt><dd><p>Day of the month as decimal number (01&ndash;31).</p>
</dd>
<dt><code>%D</code></dt><dd><p>Date format such as <code>%m/%d/%y</code>: the C99
standard says it should be that exact format (but not all OSes
comply).</p>
</dd>
<dt><code>%e</code></dt><dd><p>Day of the month as decimal number (1&ndash;31), with
a leading space for a single-digit number.</p>
</dd>
<dt><code>%F</code></dt><dd><p>Equivalent to %Y-%m-%d (the ISO 8601 date
format).</p>
</dd>
<dt><code>%g</code></dt><dd><p>The last two digits of the week-based year
(see <code>%V</code>).  (Accepted but ignored on input.)</p>
</dd>
<dt><code>%G</code></dt><dd><p>The week-based year (see <code>%V</code>) as a decimal
number.  (Accepted but ignored on input.)</p>
</dd>
<dt><code>%h</code></dt><dd><p>Equivalent to <code>%b</code>.</p>
</dd>
<dt><code>%H</code></dt><dd><p>Hours as decimal number (00&ndash;23).  As a special
exception strings such as &lsquo;<span class="samp">&#8288;24:00:00&#8288;</span>&rsquo; are accepted for input,
since ISO 8601 allows these.</p>
</dd>
<dt><code>%I</code></dt><dd><p>Hours as decimal number (01&ndash;12).</p>
</dd>
<dt><code>%j</code></dt><dd><p>Day of year as decimal number (001&ndash;366):  For
input, 366 is only valid in a leap year.</p>
</dd>
<dt><code>%m</code></dt><dd><p>Month as decimal number (01&ndash;12).</p>
</dd>
<dt><code>%M</code></dt><dd><p>Minute as decimal number (00&ndash;59).</p>
</dd>
<dt><code>%n</code></dt><dd><p>Newline on output, arbitrary whitespace on input.</p>
</dd>
<dt><code>%p</code></dt><dd><p>AM/PM indicator in the locale.  Used in
conjunction with <code>%I</code> and <b>not</b> with <code>%H</code>.  An
empty string in some locales (for example on some OSes,
non-English European locales including Russia). The behaviour is
undefined if used for input in such a locale.
</p>
<p>Some platforms accept <code>%P</code> for output, which uses a lower-case
version (<code>%p</code> may also use lower case): others will output
<code>P</code>.</p>
</dd>
<dt><code>%r</code></dt><dd><p>For output, the 12-hour clock time (using the
locale's AM or PM): only defined in some locales, and on some OSes
misleading in locales which do not define an AM/PM indicator.
For input, equivalent to <code>%I:%M:%S %p</code>.</p>
</dd>
<dt><code>%R</code></dt><dd><p>Equivalent to <code>%H:%M</code>.</p>
</dd>
<dt><code>%S</code></dt><dd><p>Second as integer (00&ndash;61), allowing for
up to two leap-seconds (but POSIX-compliant implementations
will ignore leap seconds).</p>
</dd>
<dt><code>%t</code></dt><dd><p>Tab on output, arbitrary whitespace on input.</p>
</dd>
<dt><code>%T</code></dt><dd><p>Equivalent to <code>%H:%M:%S</code>.</p>
</dd>
<dt><code>%u</code></dt><dd><p>Weekday as a decimal number (1&ndash;7, Monday is 1).</p>
</dd>

<dt><code>%U</code></dt><dd><p>Week of the year as decimal number (00&ndash;53) using
Sunday as the first day 1 of the week (and typically with the
first Sunday of the year as day 1 of week 1).  The US convention.</p>
</dd>
<dt><code>%V</code></dt><dd><p>Week of the year as decimal number (01&ndash;53) as
defined in ISO 8601.
If the week (starting on Monday) containing 1 January has four or
more days in the new year, then it is considered week 1.  Otherwise, it
is the last week of the previous year, and the next week is week
1. See <code>%G</code> (<code>%g</code>) for the year corresponding to the
week given by <code>%V</code>. (Accepted but ignored on input.)</p>
</dd>
<dt><code>%w</code></dt><dd><p>Weekday as decimal number (0&ndash;6, Sunday is 0).</p>
</dd>
<dt><code>%W</code></dt><dd><p>Week of the year as decimal number (00&ndash;53) using
Monday as the first day of week (and typically with the
first Monday of the year as day 1 of week 1).  The UK convention.</p>
</dd>
<dt><code>%x</code></dt><dd><p>Date.  Locale-specific on output,
<code>"%y/%m/%d"</code> on input.</p>
</dd>
<dt><code>%X</code></dt><dd><p>Time.  Locale-specific on output,
<code>"%H:%M:%S"</code> on input.</p>
</dd>
<dt><code>%y</code></dt><dd><p>Year without century (00&ndash;99).  On input, values
00 to 68 are prefixed by 20 and 69 to 99 by 19 &ndash; that is the
behaviour specified by the 2018 POSIX standard, but it does
also say &lsquo;it is expected that in a future version the
default century inferred from a 2-digit year will change&rsquo;.</p>
</dd>
<dt><code>%Y</code></dt><dd><p>Year with century.  Note that whereas there was no
zero in the original Gregorian calendar, ISO 8601:2004 defines it
to be valid (interpreted as 1BC): see
<a href="https://en.wikipedia.org/wiki/0_(year)">https://en.wikipedia.org/wiki/0_(year)</a>.  However, the standards
also say that years before 1582 in its calendar should only be used
with agreement of the parties involved.
</p>
<p>For input, only years <code>0:9999</code> are accepted.</p>
</dd>
<dt><code>%z</code></dt><dd><p>Signed offset in hours and minutes from UTC, so
<code>-0800</code> is 8 hours behind UTC.  (Standard only for output.  For
input <span class="rlang"><b>R</b></span> currently supports it on all platforms &ndash; values from
<code>-1400</code> to <code>+1400</code> are accepted.)</p>
</dd>

<dt><code>%Z</code></dt><dd><p>(Output only.)  Time zone abbreviation as a
character string (empty if not available).  This may not be reliable
when a time zone has changed abbreviations over the years.</p>
</dd>
</dl>

<p>Where leading zeros are shown they will be used on output but are
optional on input.  Names are matched case-insensitively on input:
whether they are capitalized on output depends on the platform and the
locale.  Note that abbreviated names are platform-specific (although
the standards specify that in the &lsquo;<span class="samp">&#8288;C&#8288;</span>&rsquo; locale they must be the
first three letters of the capitalized English name: this convention
is widely used in English-language locales but for example the French
month abbreviations are not the same on any two of Linux, macOS, Solaris
and Windows). Knowing what the abbreviations are is essential
if you wish to use <code>%a</code>, <code>%b</code> or <code>%h</code> as part of an
input format: see the examples for how to check.
</p>
<p>When <code>%z</code> or <code>%Z</code> is used for output with an
object with an assigned time zone an attempt is made to use the values
for that time zone &mdash; but it is not guaranteed to succeed.
</p>
<p>The definition of &lsquo;whitespace&rsquo; for <code>%n</code> and <code>%t</code>
is platform-dependent: for most it does not include non-breaking spaces.
</p>
<p>Not in the standards and less widely implemented are
</p>

<dl>
<dt><code>%k</code></dt><dd><p>The 24-hour clock time with single digits preceded
by a blank.</p>
</dd>
<dt><code>%l</code></dt><dd><p>The 12-hour clock time with single digits preceded
by a blank.</p>
</dd>
<dt><code>%s</code></dt><dd><p>(Output only.) The number of seconds since the
epoch.</p>
</dd>
<dt><code>%+</code></dt><dd><p>(Output only.) Similar to <code>%c</code>, often
<code>"%a %b %e %H:%M:%S %Z %Y"</code>. May depend on the locale.</p>
</dd>
</dl>

<p>For output there are also <code>%O[dHImMUVwWy]</code> which may emit
numbers in an alternative locale-dependent format (e.g., roman
numerals), and <code>%E[cCyYxX]</code> which can use an alternative
&lsquo;era&rsquo; (e.g., a different religious calendar).  Which of these
are supported is OS-dependent.  These are accepted for input, but with
the standard interpretation.
</p>
<p>Specific to <span class="rlang"><b>R</b></span> is <code>%OSn</code>, which for output gives the seconds
truncated to <code>0 &lt;= n &lt;= 6</code> decimal places (and if <code>%OS</code> is
not followed by a digit, it uses the setting of
<code><a href="#topic+getOption">getOption</a>("digits.secs")</code>, or if that is unset, <code>n =
  0</code>).  Further, for <code>strptime</code> <code>%OS</code> will input seconds
including fractional seconds.  Note that <code>%S</code> does not read
fractional parts on output.
</p>
<p>The behaviour of other conversion specifications (and even if other
character sequences commencing with <code>%</code> <em>are</em> conversion
specifications) is system-specific.  Some systems document that the
use of multi-byte characters in <code>format</code> is unsupported: UTF-8
locales are unlikely to cause a problem.
</p>


<h3>Value</h3>

<p>The <code>format</code> methods and <code>strftime</code> return character vectors
representing the time.  <code>NA</code> times are returned as
<code>NA_character_</code>.
</p>
<p><code>strptime</code> turns character representations into an object of
class <code>"<a href="#topic+POSIXlt">POSIXlt</a>"</code>.  The time zone is used to set the
<code>isdst</code> component and to set the <code>"tzone"</code> attribute if
<code>tz != ""</code>.  If the specified time is invalid (for example
&lsquo;<span class="samp">&#8288;"2010-02-30 08:00"&#8288;</span>&rsquo;) all the components of the result are
<code>NA</code>.  (NB: this does means exactly what it says &ndash; if it is an
invalid time, not just a time that does not exist in some time zone.)
</p>


<h3>Printing years</h3>

<p>Everyone agrees that years from 1000 to 9999 should be printed with 4
digits, but the standards do not define what is to be done outside
that range.  For years 0 to 999 most OSes pad with zeros or spaces to
4 characters, but Linux/glibc outputs just the number.
</p>
<p>OS facilities will probably not print years before 1 CE (aka 1 AD)
&lsquo;correctly&rsquo; (they tend to assume the existence of a year 0: see
<a href="https://en.wikipedia.org/wiki/0_(year)">https://en.wikipedia.org/wiki/0_(year)</a>, and some OSes get them
completely wrong).  Common formats are <code>-45</code> and <code>-045</code>.
</p>
<p>Years after 9999 and before -999 are normally printed with five or
more characters.
</p>
<p>Some platforms support modifiers from POSIX 2008 (and others).  On
Linux/glibc the format <code>"%04Y"</code> assures a minimum of four
characters and zero-padding (the default is no padding).  The internal
code (as used on Windows and by default on macOS) uses zero-padding by
default (this can be controlled by environment variable
<span class="env">R_PAD_YEARS_BY_ZERO</span>).  On those platforms, formats <code>%04Y</code>,
<code>%_4Y</code> and <code>%_Y</code> can be used for zero, space and no
padding respectively. (On macOS, the native code (not the default)
supports none of these and uses zero-padding to 4 digits.)
</p>


<h3>Time zone offsets</h3>

<p>Offsets from GMT (also known as UTC) are part of the conversion
between timezones and to/from class <code>"POSIXct"</code>, but cause
difficulties as they are often computed incorrectly.
</p>
<p>They conventionally have the opposite sign from time-zone
specifications (see <code><a href="#topic+Sys.timezone">Sys.timezone</a></code>): positive values are
East of the meridian.  Although there have been time zones with
offsets like +00:09:21 (Paris in 1900), and -00:44:30 (Liberia until
1972), offsets are usually treated as whole numbers of minutes, and
are most often seen in RFC 5322 email headers in forms like
<code>-0800</code> (e.g., used on the Pacific coast of the USA in winter).
</p>
<p>Format <code>%z</code> can be used for input or output: it is a character
string, conventionally plus or minus followed by two digits for hours
and two for minutes: the standards say that an empty string should be
output if the offset is undetermined, but some systems use
<code>+0000</code> or the offsets for the time zone in use for the current
year.  (On some platforms this works better after conversion to
<code>"POSIXct"</code>.  Some platforms only recognize hour or half-hour
offsets for output.)
</p>
<p>Using <code>%z</code> for input makes most sense with <code>tz = "UTC"</code>.
</p>


<h3>Sources</h3>

<p>Input uses the POSIX function <code>strptime</code> and output the C99
function <code>strftime</code>.
</p>
<p>However, not all OSes (notably Windows) provided <code>strptime</code> and
many issues were found for those which did, so since 2000 <span class="rlang"><b>R</b></span> has used
a fork of code from &lsquo;<span class="samp">&#8288;glibc&#8288;</span>&rsquo;.  The forked code uses the
system's <code>strftime</code> to find the locale-specific day and month
names and any AM/PM indicator.
</p>
<p>On some platforms (including Windows and by default on macOS) the
system's <code>strftime</code> is replaced (along with most of the rest of
the C-level datetime code) by code modified from <abbr>IANA</abbr>'s &lsquo;<span class="samp">&#8288;tzcode&#8288;</span>&rsquo;
distribution (<a href="https://www.iana.org/time-zones">https://www.iana.org/time-zones</a>).
</p>
<p>Note that as <code>strftime</code> is used for output (and not
<code>wcsftime</code>), argument <code>format</code> is translated if necessary to
the session encoding.
</p>


<h3>Note</h3>

<p>The default formats follow the rules of the ISO 8601 international
standard which expresses a day as <code>"2001-02-28"</code> and a time as
<code>"14:01:02"</code> using leading zeroes as here.  (The ISO form uses no
space, possibly &lsquo;<span class="samp">&#8288;T&#8288;</span>&rsquo;, to separate dates and times: <span class="rlang"><b>R</b></span> uses a space
by default.)
</p>
<p>For <code>strptime</code> the input string need not specify the date
completely: it is assumed that unspecified seconds, minutes or hours
are zero, and an unspecified year, month or day is the current one.
(However, if a month is specified, the day of that month has to be
specified by <code>%d</code> or <code>%e</code> since the current day of the
month need not be valid for the specified month.)  Some components may
be returned as <code>NA</code> (but an unknown <code>tzone</code> component is
represented by an empty string).
</p>
<p>If the time zone specified is invalid on your system, what happens is
system-specific but it will probably be ignored.
</p>
<p>Remember that in most time zones some times do not occur and some
occur twice because of transitions to/from &lsquo;daylight saving&rsquo;
(also known as &lsquo;summer&rsquo;) time.  <code>strptime</code> does not
validate such times (it does not assume a specific time zone), but
conversion by <code><a href="#topic+as.POSIXct">as.POSIXct</a></code> will do so.  Conversion by
<code>strftime</code> and formatting/printing uses OS facilities and may
return nonsensical results for non-existent times at DST transitions.
</p>
<p>In a C locale <code>%c</code> is required to be
<code>"%a %b %e %H:%M:%S %Y"</code>.  As Windows does not comply (and
uses a date format not understood outside N. America), that format is
used by <span class="rlang"><b>R</b></span> on Windows in all locales.
</p>
<p>There is a limit of 2048 bytes on each string produced by
<code>strftime</code> and the <code>format</code> methods.  As from <span class="rlang"><b>R</b></span> 4.3.0
attempting to exceed this is an error (previous versions silently
truncated at 255 bytes).
</p>


<h3>References</h3>

<p>International Organization for Standardization (2004, 2000, ...)
&lsquo;ISO 8601.  Data elements and interchange formats &ndash;
Information interchange &ndash; Representation of dates and times.&rsquo;,
slightly updated to International Organization for Standardization (2019)
&lsquo;ISO 8601-1:2019.  Date and time &ndash; Representations for
information interchange &ndash; Part 1: Basic rules&rsquo;, and further amended
in 2022.
For links to versions available on-line see (at the time of writing)
<a href="https://dotat.at/tmp/ISO_8601-2004_E.pdf">https://dotat.at/tmp/ISO_8601-2004_E.pdf</a> and
<a href="https://www.qsl.net/g1smd/isopdf.htm">https://www.qsl.net/g1smd/isopdf.htm</a>; for information on the
current official version, see <a href="https://www.iso.org/iso/iso8601">https://www.iso.org/iso/iso8601</a> and
<a href="https://en.wikipedia.org/wiki/ISO_8601">https://en.wikipedia.org/wiki/ISO_8601</a>.
</p>
<p>The POSIX 1003.1 standard, which is in some respects stricter than ISO 8601.
</p>


<h3>See Also</h3>

<p><a href="#topic+DateTimeClasses">DateTimeClasses</a> for details of the date-time classes;
<a href="#topic+locales">locales</a> to query or set a locale.
</p>
<p>Your system's help page on <code>strftime</code> to see how to specify their
formats.  (On some systems, including Windows, <code>strftime</code> is
replaced by more comprehensive internal code.)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## locale-specific version of date()
format(Sys.time(), "%a %b %d %X %Y %Z")

## time to sub-second accuracy (if supported by the OS)
format(Sys.time(), "%H:%M:%OS3")

## read in date info in format 'ddmmmyyyy'
## This will give NA(s) in some non-English locales; setting the C locale
## as in the commented lines will overcome this on most systems.
## lct &lt;- Sys.getlocale("LC_TIME"); Sys.setlocale("LC_TIME", "C")
x &lt;- c("1jan1960", "2jan1960", "31mar1960", "30jul1960")
z &lt;- strptime(x, "%d%b%Y")
## Sys.setlocale("LC_TIME", lct)
z
(chz &lt;- as.character(z)) # same w/o TZ
## *here* (but not in general), the same as format():
stopifnot(exprs = {
     identical(chz, format(z))
     grepl("^1960-0[137]-[03][012]$", chz[!is.na(z)])
})

## read in date/time info in format 'm/d/y h:m:s'
dates &lt;- c("02/27/92", "02/27/92", "01/14/92", "02/28/92", "02/01/92")
times &lt;- c("23:03:20", "22:29:56", "01:03:30", "18:21:03", "16:56:26")
x &lt;- paste(dates, times)
z2 &lt;- strptime(x, "%m/%d/%y %H:%M:%S")
z2 
## *here* (but not in general), the same as format():
stopifnot(identical(format(z2), as.character(z2)))

## time with fractional seconds
z3 &lt;- strptime("20/2/06 11:16:16.683", "%d/%m/%y %H:%M:%OS") 
z3 # prints without fractional seconds by default, digits.sec = NULL ("= 0")
op &lt;- options(digits.secs = 3)
z3 # shows the 3 extra digits
as.character(z3) # ditto
options(op)

## time zone names are not portable, but 'EST5EDT' comes pretty close.
## (but its interpretation may not be universal: see ?timezones)
z4 &lt;- strptime(c("2006-01-08 10:07:52", "2006-08-07 19:33:02"),
               "%Y-%m-%d %H:%M:%S", tz = "EST5EDT")
z4 
attr(z4, "tzone")
as.character(z4)
z4$sec[2] &lt;- pi # "very" fractional seconds
as.character(z4) # shows full precision
format(z4) # no fractional sec
format(z4, digits=8) # shows only 6  (hard-wired maximum)
format(z4, digits=4)


## An RFC 5322 header (Eastern Canada, during DST)
## In a non-English locale the commented lines may be needed.

## prev &lt;- Sys.getlocale("LC_TIME"); Sys.setlocale("LC_TIME", "C")
strptime("Tue, 23 Mar 2010 14:36:38 -0400", "%a, %d %b %Y %H:%M:%S %z")
## Sys.setlocale("LC_TIME", prev)

## Make sure you know what the abbreviated names are for you if you wish
## to use them for input (they are matched case-insensitively):
format(s1 &lt;- seq.Date(as.Date('1978-01-01'), by = 'day',   len =  7), "%a")
format(s2 &lt;- seq.Date(as.Date('2000-01-01'), by = 'month', len = 12), "%b")

## Non-finite date-times :
format(as.POSIXct(Inf)) # "Inf"  (was  NA  in R &lt;= 4.1.x)
format(as.POSIXlt(c(-Inf,Inf,NaN,NA))) # were all NA
</code></pre>

<hr>
<h2 id='strrep'>Repeat the Elements of a Character Vector</h2><span id='topic+strrep'></span>

<h3>Description</h3>

<p>Repeat the character strings in a character vector a given number of
times (i.e., concatenate the respective numbers of copies of the
strings).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strrep(x, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strrep_+3A_x">x</code></td>
<td>
<p>a character vector, or an object which can be coerced to a
character vector using <code>as.character</code>.</p>
</td></tr>
<tr><td><code id="strrep_+3A_times">times</code></td>
<td>
<p>an integer vector giving the (non-negative) numbers of
times to repeat the respective elements of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elements of <code>x</code> and <code>times</code> will be recycled as
necessary (if one has no elements, and empty character vector is
returned).  Missing elements in <code>x</code> or <code>times</code> result in
missing elements of the return value.
</p>


<h3>Value</h3>

<p>A character vector with the elements of the given character vector
repeated the given numbers of times.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strrep("ABC", 2)
strrep(c("A", "B", "C"), 1 : 3)
## Create vectors with the given numbers of spaces:
strrep(" ", 1 : 5)
</code></pre>

<hr>
<h2 id='strsplit'>Split the Elements of a Character Vector</h2><span id='topic+strsplit'></span>

<h3>Description</h3>

<p>Split the elements of a character vector <code>x</code> into substrings
according to the matches to substring <code>split</code> within them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strsplit(x, split, fixed = FALSE, perl = FALSE, useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strsplit_+3A_x">x</code></td>
<td>

<p>character vector, each element of which is to be split.  Other
inputs, including a factor, will give an error.
</p>
</td></tr>
<tr><td><code id="strsplit_+3A_split">split</code></td>
<td>

<p>character vector (or object which can be coerced to such)
containing <a href="#topic+regular+20expression">regular expression</a>(s) (unless <code>fixed = TRUE</code>)
to use for splitting.  If empty matches occur, in particular if
<code>split</code> has length 0, <code>x</code> is split into single characters.
If <code>split</code> has length greater than 1, it is re-cycled along
<code>x</code>.
</p>
</td></tr>
<tr><td><code id="strsplit_+3A_fixed">fixed</code></td>
<td>

<p>logical.  If <code>TRUE</code> match <code>split</code> exactly, otherwise
use regular expressions.  Has priority over <code>perl</code>.
</p>
</td></tr>
<tr><td><code id="strsplit_+3A_perl">perl</code></td>
<td>
<p>logical.  Should Perl-compatible regexps be used?</p>
</td></tr>
<tr><td><code id="strsplit_+3A_usebytes">useBytes</code></td>
<td>
<p>logical.  If <code>TRUE</code> the matching is done
byte-by-byte rather than character-by-character, and inputs with
marked encodings are not converted.  This is forced (with a warning)
if any input is found which is marked as <code>"bytes"</code>
(see <code><a href="#topic+Encoding">Encoding</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>split</code> will be coerced to character, so
you will see uses with <code>split = NULL</code> to mean
<code>split = character(0)</code>, including in the examples below.
</p>
<p>Note that splitting into single characters can be done <em>via</em>
<code>split = character(0)</code> or <code>split = ""</code>; the two are
equivalent.  The definition of &lsquo;character&rsquo; here depends on the
locale: in a single-byte locale it is a byte, and in a multi-byte
locale it is the unit represented by a &lsquo;wide character&rsquo; (almost
always a Unicode code point).
</p>
<p>A missing value of <code>split</code> does not split the corresponding
element(s) of <code>x</code> at all.
</p>
<p>The algorithm applied to each input string is
</p>
<pre>    repeat {
        if the string is empty
            break.
        if there is a match
            add the string to the left of the match to the output.
            remove the match and all to the left of it.
        else
            add the string to the output.
            break.
    }
</pre>
<p>Note that this means that if there is a match at the beginning of a
(non-empty) string, the first element of the output is <code>""</code>, but
if there is a match at the end of the string, the output is the same
as with the match removed.
</p>
<p>Note also that if there is an empty match at the beginning of a non-empty
string, the first character is returned and the algorithm continues with
the rest of the string.  This needs to be kept in mind when designing the
regular expressions.  For example, when looking for a word boundary
followed by a letter (<code>"[[:&lt;:]]"</code> with <code>perl = TRUE</code>), one can
disallow a match at the beginning of a string (via <code>"(?!^)[[:&lt;:]]"</code>).
</p>
<p>Invalid inputs in the current locale are warned about up to 5 times.
</p>


<h3>Value</h3>

<p>A list of the same length as <code>x</code>, the <code>i</code>-th element of which
contains the vector of splits of <code>x[i]</code>.
</p>
<p>If any element of <code>x</code> or <code>split</code> is declared to be in UTF-8
(see <code><a href="#topic+Encoding">Encoding</a></code>), all non-ASCII character strings in the
result will be in UTF-8 and have their encoding declared as UTF-8.
(This also holds if any element is declared to be Latin-1 except in a
Latin-1 locale.)
For <code>perl = TRUE, useBytes = FALSE</code> all non-ASCII strings in a
multibyte locale are translated to UTF-8.
</p>
<p>If any element of <code>x</code> or <code>split</code> is marked as <code>"bytes"</code>
(see <code><a href="#topic+Encoding">Encoding</a></code>), all non-ASCII character strings created by
the splitting in the result will be marked as <code>"bytes"</code>, but encoding
of the resulting character strings not split is unspecified (may be
<code>"bytes"</code> or the original).  If no element of <code>x</code> or
<code>split</code> is marked as <code>"bytes"</code>, but <code>useBytes = TRUE</code>, even
the encoding of the resulting character strings created by splitting is
unspecified (may be <code>"bytes"</code> or <code>"unknown"</code>, possibly invalid
in the current encoding).  Mixed use of <code>"bytes"</code> and other marked
encodings is discouraged, but if still desired one may use
<code><a href="#topic+iconv">iconv</a></code> to re-encode the result e.g.  to UTF-8 with suitably
substituted invalid bytes.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+paste">paste</a></code> for the reverse,
<code><a href="#topic+grep">grep</a></code> and <code><a href="#topic+sub">sub</a></code> for string search and
manipulation; also <code><a href="#topic+nchar">nchar</a></code>, <code><a href="#topic+substr">substr</a></code>.
</p>
<p>&lsquo;<a href="#topic+regular+20expression">regular expression</a>&rsquo; for the details of the pattern
specification.
</p>
<p>Option <code>PCRE_use_JIT</code> controls the details when <code>perl = TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>noquote(strsplit("A text I want to display with spaces", NULL)[[1]])

x &lt;- c(as = "asfef", qu = "qwerty", "yuiop[", "b", "stuff.blah.yech")
# split x on the letter e
strsplit(x, "e")

unlist(strsplit("a.b.c", "."))
## [1] "" "" "" "" ""
## Note that 'split' is a regexp!
## If you really want to split on '.', use
unlist(strsplit("a.b.c", "[.]"))
## [1] "a" "b" "c"
## or
unlist(strsplit("a.b.c", ".", fixed = TRUE))

## a useful function: rev() for strings
strReverse &lt;- function(x)
        sapply(lapply(strsplit(x, NULL), rev), paste, collapse = "")
strReverse(c("abc", "Statistics"))

## get the first names of the members of R-core
a &lt;- readLines(file.path(R.home("doc"),"AUTHORS"))[-(1:8)]
a &lt;- a[(0:2)-length(a)]
(a &lt;- sub(" .*","", a))
# and reverse them
strReverse(a)

## Note that final empty strings are not produced:
strsplit(paste(c("", "a", ""), collapse="#"), split="#")[[1]]
# [1] ""  "a"
## and also an empty string is only produced before a definite match:
strsplit("", " ")[[1]]    # character(0)
strsplit(" ", " ")[[1]]   # [1] ""
</code></pre>

<hr>
<h2 id='strtoi'>Convert Strings to Integers</h2><span id='topic+strtoi'></span>

<h3>Description</h3>

<p>Convert strings to integers according to the given base using the C
function <code>strtol</code>, or choose a suitable base following the C rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strtoi(x, base = 0L)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strtoi_+3A_x">x</code></td>
<td>
<p>a character vector, or something coercible to this by
<code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="strtoi_+3A_base">base</code></td>
<td>
<p>an integer which is between 2 and 36 inclusive, or zero
(default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversion is based on the C library function <code>strtol</code>.
</p>
<p>For the default <code>base = 0L</code>, the base chosen from the string
representation of that element of <code>x</code>, so different elements can
have different bases (see the first example).  The standard C rules
for choosing the base are that octal constants (prefix <code>0</code> not
followed by <code>x</code> or <code>X</code>) and hexadecimal constants (prefix
<code>0x</code> or <code>0X</code>) are interpreted as base <code>8</code> and
<code>16</code>; all other strings are interpreted as base <code>10</code>.
</p>
<p>For a base greater than <code>10</code>, letters <code>a</code> to <code>z</code> (or
<code>A</code> to <code>Z</code>) are used to represent <code>10</code> to <code>35</code>.
</p>


<h3>Value</h3>

<p>An integer vector of the same length as <code>x</code>.  Values which cannot
be interpreted as integers or would overflow are returned as
<code><a href="#topic+NA_integer_">NA_integer_</a></code>.
</p>


<h3>See Also</h3>

<p>For decimal strings <code><a href="#topic+as.integer">as.integer</a></code> is equally useful.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strtoi(c("0xff", "077", "123"))
strtoi(c("ffff", "FFFF"), 16L)
strtoi(c("177", "377"), 8L)
</code></pre>

<hr>
<h2 id='strtrim'>Trim Character Strings to Specified Display Widths</h2><span id='topic+strtrim'></span>

<h3>Description</h3>

<p>Trim character strings to specified display widths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strtrim(x, width)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strtrim_+3A_x">x</code></td>
<td>
<p>a character vector, or an object which can be coerced to a
character vector by <code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="strtrim_+3A_width">width</code></td>
<td>
<p>positive integer values: recycled to the length of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&lsquo;Width&rsquo; is interpreted as the display width in a monospaced
font.  What happens with non-printable characters (such as backspace, tab)
is implementation-dependent and may depend on the locale (e.g., they
may be included in the count or they may be omitted).
</p>
<p>Using this function rather than <code><a href="#topic+substr">substr</a></code> is important when
there might be double-width (e.g., Chinese/Japanese/Korean) characters
in the character vector.
</p>


<h3>Value</h3>

<p>A character vector of the same length and with the same attributes
as <code>x</code> (after possible coercion).
</p>
<p>Elements of the result will have the encoding declared as that of
the current locale (see <code><a href="#topic+Encoding">Encoding</a></code>) if the corresponding
input had a declared encoding and the current locale is either Latin-1
or UTF-8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strtrim(c("abcdef", "abcdef", "abcdef"), c(1,5,10))
</code></pre>

<hr>
<h2 id='structure'>Attribute Specification</h2><span id='topic+structure'></span>

<h3>Description</h3>

<p><code>structure</code> returns the given object with further
<a href="#topic+attributes">attributes</a> set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>structure(.Data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="structure_+3A_.data">.Data</code></td>
<td>
<p>an object which will have
various attributes attached to it.</p>
</td></tr>
<tr><td><code id="structure_+3A_...">...</code></td>
<td>
<p>attributes, specified in <code>tag = value</code>
form, which will be attached to data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adding a  class <code>"factor"</code> will ensure that numeric codes are
given integer storage mode.
</p>
<p>For historical reasons (these names are used when deparsing),
attributes <code>".Dim"</code>, <code>".Dimnames"</code>, <code>".Names"</code>,
<code>".Tsp"</code> and <code>".Label"</code> are renamed to <code>"dim"</code>,
<code>"dimnames"</code>, <code>"names"</code>, <code>"tsp"</code> and <code>"levels"</code>.
</p>
<p>It is possible to give the same tag more than once, in which case the
last value assigned wins.  As with other ways of assigning attributes,
using <code>tag = NULL</code> removes attribute <code>tag</code> from <code>.Data</code> if
it is present.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+attributes">attributes</a></code>, <code><a href="#topic+attr">attr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>structure(1:6, dim = 2:3)
</code></pre>

<hr>
<h2 id='strwrap'>Wrap Character Strings to Format Paragraphs</h2><span id='topic+strwrap'></span>

<h3>Description</h3>

<p>Each character string in the input is first split into paragraphs (or
lines containing whitespace only).  The paragraphs are then formatted
by breaking lines at word boundaries.  The target columns for wrapping
lines and the indentation of the first and all subsequent lines of a
paragraph can be controlled independently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strwrap(x, width = 0.9 * getOption("width"), indent = 0,
        exdent = 0, prefix = "", simplify = TRUE, initial = prefix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strwrap_+3A_x">x</code></td>
<td>
<p>a character vector, or an object which can be converted to a
character vector by <code><a href="#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="strwrap_+3A_width">width</code></td>
<td>
<p>a positive integer giving the target column for wrapping
lines in the output.</p>
</td></tr>
<tr><td><code id="strwrap_+3A_indent">indent</code></td>
<td>
<p>a non-negative integer giving the indentation of the
first line in a paragraph.</p>
</td></tr>
<tr><td><code id="strwrap_+3A_exdent">exdent</code></td>
<td>
<p>a non-negative integer specifying the indentation of
subsequent lines in paragraphs.</p>
</td></tr>
<tr><td><code id="strwrap_+3A_prefix">prefix</code>, <code id="strwrap_+3A_initial">initial</code></td>
<td>
<p>a character string to be used as prefix for
each line except the first, for which <code>initial</code> is used.</p>
</td></tr>
<tr><td><code id="strwrap_+3A_simplify">simplify</code></td>
<td>
<p>a logical.  If <code>TRUE</code>, the result is a single
character vector of line text; otherwise, it is a list of the same
length as <code>x</code> the elements of which are character vectors of
line text obtained from the corresponding element of <code>x</code>.
(Hence, the result in the former case is obtained by unlisting that
of the latter.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whitespace (space, tab or newline characters) in the input is
destroyed.  Double spaces after periods, question and explanation
marks (thought as representing sentence ends) are preserved.
Currently, possible sentence ends at line breaks are not considered
specially.
</p>
<p>Indentation is relative to the number of characters in the prefix
string.
</p>


<h3>Value</h3>

<p>A character vector (if <code>simplify</code> is <code>TRUE</code>), or a list of
such character vectors, with declared input encodings preserved.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in file 'THANKS'.
x &lt;- paste(readLines(file.path(R.home("doc"), "THANKS")), collapse = "\n")
## Split into paragraphs and remove the first three ones
x &lt;- unlist(strsplit(x, "\n[ \t\n]*\n"))[-(1:3)]
## Join the rest
x &lt;- paste(x, collapse = "\n\n")
## Now for some fun:
writeLines(strwrap(x, width = 60))
writeLines(strwrap(x, width = 60, indent = 5))
writeLines(strwrap(x, width = 60, exdent = 5))
writeLines(strwrap(x, prefix = "THANKS&gt; "))

## Note that messages are wrapped AT the target column indicated by
## 'width' (and not beyond it).
## From an R-devel posting by J. Hosking &lt;jh910@juno.com&gt;.
x &lt;- paste(sapply(sample(10, 100, replace = TRUE),
           function(x) substring("aaaaaaaaaa", 1, x)), collapse = " ")
sapply(10:40,
       function(m)
       c(target = m, actual = max(nchar(strwrap(x, m)))))
</code></pre>

<hr>
<h2 id='subset'>Subsetting Vectors, Matrices and Data Frames</h2><span id='topic+subset'></span><span id='topic+subset.default'></span><span id='topic+subset.matrix'></span><span id='topic+subset.data.frame'></span>

<h3>Description</h3>

<p>Return subsets of vectors, matrices or data frames which meet conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset(x, ...)

## Default S3 method:
subset(x, subset, ...)

## S3 method for class 'matrix'
subset(x, subset, select, drop = FALSE, ...)

## S3 method for class 'data.frame'
subset(x, subset, select, drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_+3A_x">x</code></td>
<td>
<p>object to be subsetted.</p>
</td></tr>
<tr><td><code id="subset_+3A_subset">subset</code></td>
<td>
<p>logical expression indicating elements or rows to keep:
missing values are taken as false.</p>
</td></tr>
<tr><td><code id="subset_+3A_select">select</code></td>
<td>
<p>expression, indicating columns to select from a
data frame.</p>
</td></tr>
<tr><td><code id="subset_+3A_drop">drop</code></td>
<td>
<p>passed on to <code>[</code> indexing operator.</p>
</td></tr>
<tr><td><code id="subset_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function, with methods supplied for matrices, data
frames and vectors (including lists).  Packages and users can add
further methods.
</p>
<p>For ordinary vectors, the result is simply
<code>x[subset &amp; !is.na(subset)]</code>.
</p>
<p>For data frames, the <code>subset</code> argument works on the rows.  Note
that <code>subset</code> will be evaluated in the data frame, so columns can
be referred to (by name) as variables in the expression (see the examples).
</p>
<p>The <code>select</code> argument exists only for the methods for data frames
and matrices.  It works by first replacing column names in the
selection expression with the corresponding column numbers in the data
frame and then using the resulting integer vector to index the
columns.  This allows the use of the standard indexing conventions so
that for example ranges of columns can be specified easily, or single
columns can be dropped (see the examples).
</p>
<p>The <code>drop</code> argument is passed on to the indexing method for
matrices and data frames: note that the default for matrices is
different from that for indexing.
</p>
<p>Factors may have empty levels after subsetting; unused levels are
not automatically removed.  See <code><a href="#topic+droplevels">droplevels</a></code> for a way to
drop all unused levels from a data frame.
</p>


<h3>Value</h3>

<p>An object similar to <code>x</code> contain just the selected elements (for
a vector), rows and columns (for a matrix or data frame), and so on.
</p>


<h3>Warning</h3>

<p>This is a convenience function intended for use interactively.  For
programming it is better to use the standard subsetting functions like
<code><a href="#topic++5B">[</a></code>, and in particular the non-standard evaluation of
argument <code>subset</code> can have unanticipated consequences.
</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard and Brian Ripley</p>


<h3>See Also</h3>

<p><code><a href="#topic++5B">[</a></code>, 
<code><a href="#topic+transform">transform</a></code>
<code><a href="#topic+droplevels">droplevels</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subset(airquality, Temp &gt; 80, select = c(Ozone, Temp))
subset(airquality, Day == 1, select = -Temp)
subset(airquality, select = Ozone:Wind)

with(airquality, subset(Ozone, Temp &gt; 80))

## sometimes requiring a logical 'subset' argument is a nuisance
nm &lt;- rownames(state.x77)
start_with_M &lt;- nm %in% grep("^M", nm, value = TRUE)
subset(state.x77, start_with_M, Illiteracy:Murder)
# but in recent versions of R this can simply be
subset(state.x77, grepl("^M", nm), Illiteracy:Murder)
</code></pre>

<hr>
<h2 id='substitute'>Substituting and Quoting Expressions</h2><span id='topic+substitute'></span><span id='topic+quote'></span><span id='topic+enquote'></span>

<h3>Description</h3>

<p><code>substitute</code> returns the parse tree for the (unevaluated)
expression <code>expr</code>, substituting any variables bound in
<code>env</code>.
</p>
<p><code>quote</code> simply returns its argument. The argument is not evaluated
and can be any R expression.
</p>
<p><code>enquote</code> is a simple one-line utility which transforms a call of
the form <code>Foo(....)</code> into the call <code>quote(Foo(....))</code>.  This
is typically used to protect a <code><a href="#topic+call">call</a></code> from early evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>substitute(expr, env)
quote(expr)
enquote(cl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="substitute_+3A_expr">expr</code></td>
<td>
<p>any syntactically valid <span class="rlang"><b>R</b></span> expression.</p>
</td></tr>
<tr><td><code id="substitute_+3A_cl">cl</code></td>
<td>
<p>a <code><a href="#topic+call">call</a></code>, i.e., an <span class="rlang"><b>R</b></span> object of
<code><a href="#topic+class">class</a></code> (and <code><a href="#topic+mode">mode</a></code>) <code>"call"</code>.</p>
</td></tr>
<tr><td><code id="substitute_+3A_env">env</code></td>
<td>
<p>an environment or a list object.  Defaults to the
current evaluation environment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The typical use of <code>substitute</code> is to create informative labels
for data sets and plots.
The <code>myplot</code> example below shows a simple use of this facility.
It uses the functions <code><a href="#topic+deparse">deparse</a></code> and <code>substitute</code>
to create labels for a plot which are character string versions
of the actual arguments to the function <code>myplot</code>.
</p>
<p>Substitution takes place by examining each component of the parse tree
as follows: If it is not a bound symbol in <code>env</code>, it is
unchanged.  If it is a promise object, i.e., a formal argument to a
function or explicitly created using <code><a href="#topic+delayedAssign">delayedAssign</a>()</code>,
the expression slot of the promise replaces the symbol.  If it is an
ordinary variable, its value is substituted, unless <code>env</code> is
<code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code> in which case the symbol is left unchanged.
</p>
<p>Both <code>quote</code> and <code>substitute</code> are &lsquo;special&rsquo;
<a href="#topic+primitive">primitive</a> functions which do not evaluate their arguments.
</p>


<h3>Value</h3>

<p>The <code><a href="#topic+mode">mode</a></code> of the result is generally <code>"call"</code> but
may in principle be any type. In particular, single-variable
expressions have mode <code>"name"</code> and constants have the
appropriate base mode.
</p>


<h3>Note</h3>

<p><code>substitute</code> works on a purely lexical basis.  There is no
guarantee that the resulting expression makes any sense.
</p>
<p>Substituting and quoting often cause confusion when the argument is
<code>expression(...)</code>.  The result is a call to the
<code><a href="#topic+expression">expression</a></code> constructor function and needs to be evaluated
with <code><a href="#topic+eval">eval</a></code> to give the actual expression object.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+missing">missing</a></code> for argument &lsquo;missingness&rsquo;,
<code><a href="#topic+bquote">bquote</a></code> for partial substitution,
<code><a href="#topic+sQuote">sQuote</a></code> and <code><a href="#topic+dQuote">dQuote</a></code> for adding quotation
marks to strings.
<code><a href="#topic+Quotes">Quotes</a></code> about forward, back, and double quotes &lsquo;<span class="samp">&#8288;'&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;`&#8288;</span>&rsquo;, and &lsquo;<span class="samp">&#8288;"&#8288;</span>&rsquo;. 
</p>
<p><code><a href="#topic+all.names">all.names</a></code> to retrieve the symbol names from an expression
or call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)
(s.e &lt;- substitute(expression(a + b), list(a = 1)))  #&gt; expression(1 + b)
(s.s &lt;- substitute( a + b,            list(a = 1)))  #&gt; 1 + b
c(mode(s.e), typeof(s.e)) #  "call", "language"
c(mode(s.s), typeof(s.s)) #   (the same)
# but:
(e.s.e &lt;- eval(s.e))          #&gt;  expression(1 + b)
c(mode(e.s.e), typeof(e.s.e)) #  "expression", "expression"

substitute(x &lt;- x + 1, list(x = 1)) # nonsense

myplot &lt;- function(x, y)
    plot(x, y, xlab = deparse1(substitute(x)),
               ylab = deparse1(substitute(y)))

## Simple examples about lazy evaluation, etc:

f1 &lt;- function(x, y = x)             { x &lt;- x + 1; y }
s1 &lt;- function(x, y = substitute(x)) { x &lt;- x + 1; y }
s2 &lt;- function(x, y) { if(missing(y)) y &lt;- substitute(x); x &lt;- x + 1; y }
a &lt;- 10
f1(a)  # 11
s1(a)  # 11
s2(a)  # a
typeof(s2(a))  # "symbol"
</code></pre>

<hr>
<h2 id='substr'>Substrings of a Character Vector</h2><span id='topic+substr'></span><span id='topic+substring'></span><span id='topic+substr+3C-'></span><span id='topic+substring+3C-'></span>

<h3>Description</h3>

<p>Extract or replace substrings in a character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>substr(x, start, stop)
substring(text, first, last = 1000000L)

substr(x, start, stop) &lt;- value
substring(text, first, last = 1000000L) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="substr_+3A_x">x</code>, <code id="substr_+3A_text">text</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="substr_+3A_start">start</code>, <code id="substr_+3A_first">first</code></td>
<td>
<p>integer.  The first element to be extracted or replaced.</p>
</td></tr>
<tr><td><code id="substr_+3A_stop">stop</code>, <code id="substr_+3A_last">last</code></td>
<td>
<p>integer.  The last element to be extracted or replaced.</p>
</td></tr>
<tr><td><code id="substr_+3A_value">value</code></td>
<td>
<p>a character vector, recycled if necessary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>substring</code> is compatible with S, with <code>first</code> and
<code>last</code> instead of <code>start</code> and <code>stop</code>.
For vector arguments, it expands the arguments cyclically to the
length of the longest <em>provided</em> none are of zero length.
</p>
<p>When extracting, if <code>start</code> is larger than the string length then
<code>""</code> is returned.
</p>
<p>For the extraction functions, <code>x</code> or <code>text</code> will be
converted to a character vector by <code><a href="#topic+as.character">as.character</a></code> if it is not
already one.
</p>
<p>For the replacement functions, if <code>start</code> is larger than the
string length then no replacement is done.  If the portion to be
replaced is longer than the replacement string, then only the
portion the length of the string is replaced.
</p>
<p>If any argument is an <code>NA</code> element, the corresponding element of
the answer is <code>NA</code>.
</p>
<p>Elements of the result will be have the encoding declared as that of
the current locale (see <code><a href="#topic+Encoding">Encoding</a></code>) if the corresponding
input had a declared Latin-1 or UTF-8 encoding and the current locale
is either Latin-1 or UTF-8.
</p>
<p>If an input element has declared <code>"bytes"</code> encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>), the subsetting is done in units of bytes not
characters.
</p>


<h3>Value</h3>

<p>For <code>substr</code>, a character vector of the same length and with the
same attributes as <code>x</code> (after possible coercion).
</p>
<p>For <code>substring</code>, a character vector of length the longest of the
arguments.  This will have names taken from <code>x</code> (if it has any
after coercion, repeated as needed), and other attributes copied from
<code>x</code> if it is the longest of the arguments).
</p>
<p>For the replacement functions, a character vector of the same length as
<code>x</code> or <code>text</code>, with <code><a href="#topic+attributes">attributes</a></code> such as
<code><a href="#topic+names">names</a></code> preserved.
</p>
<p>Elements of <code>x</code> or <code>text</code> with a declared encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>) will be returned with the same encoding.
</p>


<h3>Note</h3>

<p>The S version of <code>substring&lt;-</code> ignores <code>last</code>; this version
does not.
</p>
<p>These functions are often used with <code><a href="#topic+nchar">nchar</a></code> to truncate a
display.  That does not really work (you want to limit the width, not
the number of characters, so it would be better to use
<code><a href="#topic+strtrim">strtrim</a></code>), but at least make sure you use the default
<code>nchar(type = "chars")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.  (<code>substring</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+strsplit">strsplit</a></code>, <code><a href="#topic+paste">paste</a></code>, <code><a href="#topic+nchar">nchar</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>substr("abcdef", 2, 4)
substring("abcdef", 1:6, 1:6)
## strsplit() is more efficient ...

substr(rep("abcdef", 4), 1:4, 4:5)
x &lt;- c("asfef", "qwerty", "yuiop[", "b", "stuff.blah.yech")
substr(x, 2, 5)
substring(x, 2, 4:6)

X &lt;- x
names(X) &lt;- LETTERS[seq_along(x)]
comment(X) &lt;- noquote("is a named vector")
str(aX &lt;- attributes(X))
substring(x, 2) &lt;- c("..", "+++")
substring(X, 2) &lt;- c("..", "+++")
X
stopifnot(x == X, identical(aX, attributes(X)), nzchar(comment(X)))
</code></pre>

<hr>
<h2 id='sum'>Sum of Vector Elements</h2><span id='topic+sum'></span>

<h3>Description</h3>

<p><code>sum</code> returns the sum of all the values
present in its arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sum_+3A_...">...</code></td>
<td>
<p>numeric or complex or logical vectors.</p>
</td></tr>
<tr><td><code id="sum_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.  Should missing values (including <code>NaN</code>) be
removed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function: methods can be defined for it
directly or via the <code><a href="#topic+S3groupGeneric">Summary</a></code> group generic.
For this to work properly, the arguments <code>...</code> should be
unnamed, and dispatch is on the first argument.
</p>
<p>If <code>na.rm</code> is <code>FALSE</code> an <code>NA</code> or <code>NaN</code> value in
any of the arguments will cause a value of <code>NA</code> or <code>NaN</code> to
be returned, otherwise <code>NA</code> and <code>NaN</code> values are ignored.
</p>
<p>Logical true values are regarded as one, false values as zero.
For historical reasons, <code>NULL</code> is accepted and treated as if it
were <code>integer(0)</code>.
</p>
<p>Loss of accuracy can occur when summing values of different signs:
this can even occur for sufficiently long integer inputs if the
partial sums would cause integer overflow.  Where possible
extended-precision accumulators are used, typically well supported
with C99 and newer, but possibly platform-dependent.
</p>


<h3>Value</h3>

<p>The sum.  If all of the <code>...</code> arguments are of type
integer or logical, then the sum is <code><a href="#topic+integer">integer</a></code> when
possible and is <code>double</code> otherwise.  Integer overflow should no
longer happen since <span class="rlang"><b>R</b></span> version 3.5.0.
For other argument types it is a length-one numeric
(<code><a href="#topic+double">double</a></code>) or complex vector.
</p>
<p><strong>NB:</strong> the sum of an empty set is zero, by definition.
</p>


<h3>S4 methods</h3>

<p>This is part of the S4 <code><a href="methods.html#topic+S4groupGeneric">Summary</a></code>
group generic.  Methods for it must use the signature
<code>x, ..., na.rm</code>.
</p>
<p>&lsquo;<a href="grDevices.html#topic+plotmath">plotmath</a>&rsquo; for the use of <code>sum</code> in plot annotation.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colSums">colSums</a></code> for row and column sums.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Pass a vector to sum, and it will add the elements together.
sum(1:5)

## Pass several numbers to sum, and it also adds the elements.
sum(1, 2, 3, 4, 5)

## In fact, you can pass vectors into several arguments, and everything gets added.
sum(1:2, 3:5)

## If there are missing values, the sum is unknown, i.e., also missing, ....
sum(1:5, NA)
## ... unless  we exclude missing values explicitly:
sum(1:5, NA, na.rm = TRUE)
</code></pre>

<hr>
<h2 id='summary'>Object Summaries</h2><span id='topic+summary'></span><span id='topic+summary.default'></span><span id='topic+summary.data.frame'></span><span id='topic+summary.factor'></span><span id='topic+summary.matrix'></span><span id='topic+format.summaryDefault'></span><span id='topic+print.summaryDefault'></span>

<h3>Description</h3>

<p><code>summary</code> is a generic function used to produce result summaries
of the results of various model fitting functions.  The function
invokes particular <code><a href="utils.html#topic+methods">methods</a></code> which depend on the
<code><a href="#topic+class">class</a></code> of the first argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object, ...)

## Default S3 method:
summary(object, ..., digits, quantile.type = 7)
## S3 method for class 'data.frame'
summary(object, maxsum = 7,
       digits = max(3, getOption("digits")-3), ...)

## S3 method for class 'factor'
summary(object, maxsum = 100, ...)

## S3 method for class 'matrix'
summary(object, ...)

## S3 method for class 'summaryDefault'
format(x, digits = max(3L, getOption("digits") - 3L), ...)
 ## S3 method for class 'summaryDefault'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td></tr>
<tr><td><code id="summary_+3A_x">x</code></td>
<td>
<p>a result of the <em>default</em> method of <code>summary()</code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_maxsum">maxsum</code></td>
<td>
<p>integer, indicating how many levels should be shown for
<code><a href="#topic+factor">factor</a></code>s.</p>
</td></tr>
<tr><td><code id="summary_+3A_digits">digits</code></td>
<td>
<p>integer, used for number formatting with
<code><a href="#topic+signif">signif</a>()</code> (for <code>summary.default</code>) or
<code><a href="#topic+format">format</a>()</code> (for <code>summary.data.frame</code>).  In
<code>summary.default</code>, if not specified (i.e.,
<code><a href="#topic+missing">missing</a>(.)</code>), <code>signif()</code> will <em>not</em> be called
anymore (since <span class="rlang"><b>R</b></span> &gt;= 3.4.0, where the default has been changed to
only round in the <code>print</code> and <code>format</code> methods).</p>
</td></tr>
<tr><td><code id="summary_+3A_quantile.type">quantile.type</code></td>
<td>
<p>integer code used in <code>quantile(*, type=quantile.type)</code>
for the default method.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code><a href="#topic+factor">factor</a></code>s, the frequency of the first <code>maxsum - 1</code>
most frequent levels is shown, and the less frequent levels are
summarized in <code>"(Others)"</code> (resulting in at most <code>maxsum</code>
frequencies).
</p>
<p>The functions <code>summary.lm</code> and <code>summary.glm</code> are examples
of particular methods which summarize the results produced by
<code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Value</h3>

<p>The form of the value returned by <code>summary</code> depends on the
class of its argument.  See the documentation of the particular
methods for details of what is produced by that method.
</p>
<p>The default method returns an object of class
<code>c("summaryDefault", "<a href="#topic+table">table</a>")</code> which has specialized
<code><a href="#topic+format">format</a></code> and <code><a href="#topic+print">print</a></code> methods.  The
<code><a href="#topic+factor">factor</a></code> method returns an integer vector.
</p>
<p>The matrix and data frame methods return a matrix of class
<code>"<a href="#topic+table">table</a>"</code>, obtained by applying <code>summary</code> to each
column and collating the results.
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+anova">anova</a></code>,
<code><a href="stats.html#topic+summary.glm">summary.glm</a></code>,
<code><a href="stats.html#topic+summary.lm">summary.lm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summary(attenu, digits = 4) #-&gt; summary.data.frame(...), default precision
summary(attenu $ station, maxsum = 20) #-&gt; summary.factor(...)

lst &lt;- unclass(attenu$station) &gt; 20 # logical with NAs
## summary.default() for logicals -- different from *.factor:
summary(lst)
summary(as.factor(lst))
</code></pre>

<hr>
<h2 id='svd'>Singular Value Decomposition of a Matrix</h2><span id='topic+svd'></span><span id='topic+La.svd'></span>

<h3>Description</h3>

<p>Compute the singular-value decomposition of a rectangular matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svd(x, nu = min(n, p), nv = min(n, p), LINPACK = FALSE)

La.svd(x, nu = min(n, p), nv = min(n, p))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svd_+3A_x">x</code></td>
<td>
<p>a numeric or complex matrix whose SVD decomposition
is to be computed.  Logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="svd_+3A_nu">nu</code></td>
<td>
<p>the number of left  singular vectors to be computed.
This must between <code>0</code> and <code>n = nrow(x)</code>.</p>
</td></tr>
<tr><td><code id="svd_+3A_nv">nv</code></td>
<td>
<p>the number of right singular vectors to be computed.
This must be between <code>0</code> and <code>p = ncol(x)</code>.</p>
</td></tr>
<tr><td><code id="svd_+3A_linpack">LINPACK</code></td>
<td>
<p>logical.  Defunct and an error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The singular value decomposition plays an important role in many
statistical techniques.  <code>svd</code> and <code>La.svd</code> provide two
interfaces which differ in their return values.
</p>
<p>Computing the singular vectors is the slow part for large matrices.
The computation will be more efficient if both <code>nu &lt;= min(n, p)</code>
and <code>nv &lt;= min(n, p)</code>, and even more so if both are zero.
</p>
<p>Unsuccessful results from the underlying LAPACK code will result in an
error giving a positive error code (most often <code>1</code>): these can
only be interpreted by detailed study of the FORTRAN code but mean
that the algorithm failed to converge.
</p>
<p>Missing, <code>NaN</code>  or infinite values in <code>x</code> will given
an error.
</p>


<h3>Value</h3>

<p>The SVD decomposition of the matrix as computed by LAPACK, </p>
<p style="text-align: center;"><code class="reqn">
  \bold{X = U D V'},</code>
</p>
<p> where <code class="reqn">\bold{U}</code> and <code class="reqn">\bold{V}</code> are
orthogonal, <code class="reqn">\bold{V'}</code> means <em>V transposed</em> (and conjugated
for complex input), and <code class="reqn">\bold{D}</code> is a diagonal matrix with the
(non-negative) singular values <code class="reqn">D_{ii}</code> in decreasing
order.  Equivalently, <code class="reqn">\bold{D = U' X V}</code>, which is verified in
the examples.
</p>
<p>The returned value is a list with components
</p>
<table>
<tr><td><code>d</code></td>
<td>
<p>a vector containing the singular values of <code>x</code>, of
length <code>min(n, p)</code>, sorted decreasingly.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>a matrix whose columns contain the left singular vectors of
<code>x</code>, present if <code>nu &gt; 0</code>.  Dimension <code>c(n, nu)</code>.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>a matrix whose columns contain the right singular vectors of
<code>x</code>, present if <code>nv &gt; 0</code>.  Dimension <code>c(p, nv)</code>.</p>
</td></tr>
</table>
<p>Recall that the singular vectors are only defined up to sign (a
constant of modulus one in the complex case).  If a left singular
vector has its sign changed, changing the sign of the corresponding
right vector gives an equivalent decomposition.
</p>
<p>For <code>La.svd</code> the return value replaces <code>v</code> by <code>vt</code>, the
(conjugated if complex) transpose of <code>v</code>.
</p>


<h3>Source</h3>

<p>The main functions used are the LAPACK routines <code>DGESDD</code> and
<code>ZGESDD</code>.
</p>
<p>LAPACK is from <a href="https://netlib.org/lapack/">https://netlib.org/lapack/</a> and its guide is
listed in the references.
</p>


<h3>References</h3>

<p>Anderson. E. and ten others (1999)
<em>LAPACK Users' Guide</em>. Third Edition. SIAM.<br />
Available on-line at
<a href="https://netlib.org/lapack/lug/lapack_lug.html">https://netlib.org/lapack/lug/lapack_lug.html</a>.
</p>
<p>The <a href="https://en.wikipedia.org/wiki/Singular-value_decomposition">
&lsquo;Singular-value decomposition&rsquo;</a> Wikipedia article.
</p>
<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eigen">eigen</a></code>, <code><a href="#topic+qr">qr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hilbert &lt;- function(n) { i &lt;- 1:n; 1 / outer(i - 1, i, `+`) }
X &lt;- hilbert(9)[, 1:6]
(s &lt;- svd(X))
D &lt;- diag(s$d)
s$u %*% D %*% t(s$v) #  X = U D V'
t(s$u) %*% X %*% s$v #  D = U' X V
</code></pre>

<hr>
<h2 id='sweep'>Sweep out Array Summaries</h2><span id='topic+sweep'></span>

<h3>Description</h3>

<p>Return an array obtained from an input array by sweeping out a summary
statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sweep(x, MARGIN, STATS, FUN = "-", check.margin = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sweep_+3A_x">x</code></td>
<td>
<p>an array, including a matrix.</p>
</td></tr>
<tr><td><code id="sweep_+3A_margin">MARGIN</code></td>
<td>
<p>a vector of indices giving the extent(s) of <code>x</code>
which correspond to <code>STATS</code>.
Where <code>x</code> has named dimnames, it can be a character
vector selecting dimension names.</p>
</td></tr>
<tr><td><code id="sweep_+3A_stats">STATS</code></td>
<td>
<p>the summary statistic which is to be swept out.</p>
</td></tr>
<tr><td><code id="sweep_+3A_fun">FUN</code></td>
<td>
<p>the function to be used to carry out the sweep.</p>
</td></tr>
<tr><td><code id="sweep_+3A_check.margin">check.margin</code></td>
<td>
<p>logical.  If <code>TRUE</code> (the default), warn if the
length or dimensions of <code>STATS</code> do not match the specified
dimensions of <code>x</code>.  Set to <code>FALSE</code> for a small speed gain
when you <em>know</em> that dimensions match.</p>
</td></tr>
<tr><td><code id="sweep_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>FUN</code> is found by a call to <code><a href="#topic+match.fun">match.fun</a></code>.  As in the
default, binary operators can be supplied if quoted or backquoted.
</p>
<p><code>FUN</code> should be a function of two arguments: it will be called
with arguments <code>x</code> and an array of the same dimensions generated
from <code>STATS</code> by <code><a href="#topic+aperm">aperm</a></code>.
</p>
<p>The consistency check among <code>STATS</code>, <code>MARGIN</code> and <code>x</code>
is stricter if <code>STATS</code> is an array than if it is a vector.
In the vector case, some kinds of recycling are allowed without a
warning.  Use <code>sweep(x, MARGIN, as.array(STATS))</code> if <code>STATS</code>
is a vector and you want to be warned if any recycling occurs.
</p>


<h3>Value</h3>

<p>An array with the same shape as <code>x</code>, but with the summary
statistics swept out.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+apply">apply</a></code> on which <code>sweep</code> used to be based;
<code><a href="#topic+scale">scale</a></code> for centering and scaling.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for median
med.att &lt;- apply(attitude, 2, median)
sweep(data.matrix(attitude), 2, med.att)  # subtract the column medians

## More sweeping:
A &lt;- array(1:24, dim = 4:2)

## no warnings in normal use
sweep(A, 1, 5)
(A.min &lt;- apply(A, 1, min))  # == 1:4
sweep(A, 1, A.min)
sweep(A, 1:2, apply(A, 1:2, median))

## warnings when mismatch
sweep(A, 1, 1:3)  # STATS does not recycle
sweep(A, 1, 6:1)  # STATS is longer

## exact recycling:
sweep(A, 1, 1:2)  # no warning
sweep(A, 1, as.array(1:2))  # warning

## Using named dimnames

dimnames(A) &lt;- list(fee=1:4, fie=1:3, fum=1:2)

mn_fum_fie &lt;- apply(A, c("fum", "fie"), mean)
mn_fum_fie
sweep(A, c("fum", "fie"), mn_fum_fie)
</code></pre>

<hr>
<h2 id='switch'>Select One of a List of Alternatives</h2><span id='topic+switch'></span>

<h3>Description</h3>

<p><code>switch</code> evaluates <code>EXPR</code> and accordingly chooses one of the
further arguments (in <code>...</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switch(EXPR, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switch_+3A_expr">EXPR</code></td>
<td>
<p>an expression evaluating to a number or a character
string.</p>
</td></tr>
<tr><td><code id="switch_+3A_...">...</code></td>
<td>
<p>the list of alternatives.  If it is intended that
<code>EXPR</code> has a character-string value these will be
named, perhaps except for one alternative to be used as a
&lsquo;default&rsquo; value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>switch</code> works in two distinct ways depending whether the first
argument evaluates to a character string or a number.
</p>
<p>If the value of <code>EXPR</code> is not a character string it is coerced to
integer.  Note that this also happens for <code><a href="#topic+factor">factor</a></code>s, with
a warning, as typically the character level is meant.  If the integer
is between 1 and <code>nargs()-1</code> then the corresponding element of
<code>...</code> is evaluated and the result returned: thus if the first
argument is <code>3</code> then the fourth argument is evaluated and
returned.
</p>
<p>If <code>EXPR</code> evaluates to a character string then that string is
matched (exactly) to the names of the elements in <code>...</code>.  If
there is a match then that element is evaluated unless it is missing,
in which case the next non-missing element is evaluated, so for
example <code>switch("cc", a = 1, cc =, cd =, d = 2)</code> evaluates to
<code>2</code>.  If there is more than one match, the first matching element
is used.  In the case of no match, if there is an unnamed element of
<code>...</code> its value is returned.  (If there is more than one such
argument an error is signaled.)
</p>
<p>The first argument is always taken to be <code>EXPR</code>: if it is named
its name must (partially) match.
</p>
<p>A warning is signaled if no alternatives are provided, as this is
usually a coding error.
</p>
<p>This is implemented as a <a href="#topic+primitive">primitive</a> function that only evaluates
its first argument and one other if one is selected.
</p>


<h3>Value</h3>

<p>The value of one of the elements of <code>...</code>, or <code>NULL</code>,
invisibly (whenever no element is selected).
</p>
<p>The result has the visibility (see <code><a href="#topic+invisible">invisible</a></code>) of the
element evaluated.
</p>


<h3>Warning</h3>

<p>It is possible to write calls to <code>switch</code> that can be confusing
and may not work in the same way in earlier versions of <span class="rlang"><b>R</b></span>.  For
compatibility (and clarity), always have <code>EXPR</code> as the first
argument, naming it if partial matching is a possibility.  For the
character-string form, have a single unnamed argument as the default
after the named values.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
centre &lt;- function(x, type) {
  switch(type,
         mean = mean(x),
         median = median(x),
         trimmed = mean(x, trim = .1))
}
x &lt;- rcauchy(10)
centre(x, "mean")
centre(x, "median")
centre(x, "trimmed")

ccc &lt;- c("b","QQ","a","A","bb")
# note: cat() produces no output for NULL
for(ch in ccc)
    cat(ch,":", switch(EXPR = ch, a = 1, b = 2:3), "\n")
for(ch in ccc)
    cat(ch,":", switch(EXPR = ch, a =, A = 1, b = 2:3, "Otherwise: last"),"\n")

## switch(f, *) with a factor f
ff &lt;- gl(3,1, labels=LETTERS[3:1])
ff[1] # C
## so one might expect " is C" here, but
switch(ff[1], A = "I am A", B="Bb..", C=" is C")# -&gt; "I am A"
## so we give a warning

## Numeric EXPR does not allow a default value to be specified
## -- it is always NULL
for(i in c(-1:3, 9))  print(switch(i, 1, 2 , 3, 4))

## visibility
switch(1, invisible(pi), pi)
switch(2, invisible(pi), pi)
</code></pre>

<hr>
<h2 id='Syntax'>Operator Syntax and Precedence</h2><span id='topic+Syntax'></span>

<h3>Description</h3>

<p>Outlines <span class="rlang"><b>R</b></span> syntax and gives the precedence of operators.
</p>


<h3>Details</h3>

<p>The following unary and binary operators are defined.  They are listed
in precedence groups, from highest to lowest.
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>:: :::</code></td><td style="text-align: left;"> access variables in a namespace</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>$ @</code></td><td style="text-align: left;"> component / slot extraction</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>[ [[</code></td><td style="text-align: left;"> indexing</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>^</code></td><td style="text-align: left;"> exponentiation (right to left)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>- +</code></td><td style="text-align: left;"> unary minus and plus</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>:</code></td><td style="text-align: left;"> sequence operator</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>%any% |&gt;</code></td><td style="text-align: left;"> special operators (including <code>%%</code> and <code>%/%</code>)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>* /</code></td><td style="text-align: left;"> multiply, divide</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>+ -</code></td><td style="text-align: left;"> (binary) add, subtract</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>&lt; &gt; &lt;= &gt;= == !=</code></td><td style="text-align: left;"> ordering and comparison</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>!</code></td><td style="text-align: left;"> negation</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>&amp;  &amp;&amp;</code></td><td style="text-align: left;"> and</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>| ||</code></td><td style="text-align: left;"> or</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>~</code></td><td style="text-align: left;"> as in formulae</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>-&gt; -&gt;&gt;</code></td><td style="text-align: left;"> rightwards assignment</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>&lt;- &lt;&lt;-</code></td><td style="text-align: left;"> assignment (right to left)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>=</code></td><td style="text-align: left;"> assignment (right to left)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>?</code></td><td style="text-align: left;"> help (unary and binary)</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>Within an expression operators of equal precedence are evaluated
from left to right except where indicated.  (Note that <code>=</code> is not
necessarily an operator.)
</p>
<p>The binary operators <code>::</code>, <code>:::</code>, <code>$</code> and <code>@</code> require
names or string constants on the right hand side, and the first two
also require them on the left.
</p>
<p>The links in the <b>See Also</b> section cover most other aspects of
the basic syntax.
</p>


<h3>Note</h3>

<p>There are substantial precedence differences between <span class="rlang"><b>R</b></span> and S.  In
particular, in S <code>?</code> has the same precedence as (binary) <code>+ -</code>
and <code>&amp; &amp;&amp; | ||</code> have equal precedence.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Arithmetic">Arithmetic</a></code>, <code><a href="#topic+Comparison">Comparison</a></code>, <code><a href="#topic+Control">Control</a></code>,
<code><a href="#topic+Extract">Extract</a></code>, <code><a href="#topic+Logic">Logic</a></code>,
<code><a href="#topic+NumericConstants">NumericConstants</a></code>, <code><a href="#topic+Paren">Paren</a></code>,
<code><a href="#topic+Quotes">Quotes</a></code>, <code><a href="#topic+Reserved">Reserved</a></code>.
</p>
<p>The &lsquo;R Language Definition&rsquo; manual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Logical AND ("&amp;&amp;") has higher precedence than OR ("||"):
TRUE || TRUE &amp;&amp; FALSE   # is the same as
TRUE || (TRUE &amp;&amp; FALSE) # and different from
(TRUE || TRUE) &amp;&amp; FALSE

## Special operators have higher precedence than "!" (logical NOT).
## You can use this for %in% :
! 1:10 %in% c(2, 3, 5, 7) # same as !(1:10 %in% c(2, 3, 5, 7))
## but we strongly advise to use the "!( ... )" form in this case!


## '=' has lower precedence than '&lt;-' ... so you should not mix them
##     (and '&lt;-' is considered better style anyway):
## Not run: ## Consequently, this gives a ("non-catchable") error
 x &lt;- y = 5  #-&gt;  Error in (x &lt;- y) = 5 : ....

## End(Not run)
</code></pre>

<hr>
<h2 id='Sys.getenv'>Get Environment Variables</h2><span id='topic+Sys.getenv'></span>

<h3>Description</h3>

<p><code>Sys.getenv</code> obtains the values of the environment variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.getenv(x = NULL, unset = "", names = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.getenv_+3A_x">x</code></td>
<td>
<p>a character vector, or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="Sys.getenv_+3A_unset">unset</code></td>
<td>
<p>a character string.</p>
</td></tr>
<tr><td><code id="Sys.getenv_+3A_names">names</code></td>
<td>
<p>logical: should the result be named?  If <code>NA</code> (the
default) single-element results are not named whereas multi-element
results are.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both arguments will be coerced to character if necessary.
</p>
<p>Setting <code>unset = NA</code> will enable unset variables and those set to
the value <code>""</code> to be distinguished, <em>if the OS does</em>.  POSIX
requires the OS to distinguish, and all known current <span class="rlang"><b>R</b></span> platforms do.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code>, with (if <code>names ==
  TRUE</code>) the variable names as its <code>names</code> attribute.  Each element
holds the value of the environment variable named by the corresponding
component of <code>x</code> (or the value of <code>unset</code> if no environment
variable with that name was found).
</p>
<p>On most platforms <code>Sys.getenv()</code> will return a named vector
giving the values of all the environment variables, sorted in the
current locale.  It may be confused by names containing <code>=</code> which
some platforms allow but POSIX does not.  (Windows is such a platform:
there names including <code>=</code> are truncated just before the first
<code>=</code>.)
</p>
<p>When <code>x</code> is missing and <code>names</code> is not false, the result is
of class <code>"Dlist"</code> in order to get a nice
<code><a href="#topic+print">print</a></code> method.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.setenv">Sys.setenv</a></code>,
<code><a href="#topic+Sys.getlocale">Sys.getlocale</a></code> for the locale in use,
<code><a href="#topic+getwd">getwd</a></code> for the working directory.
</p>
<p>The help for &lsquo;<a href="#topic+environment+20variables">environment variables</a>&rsquo; lists many of the
environment variables used by <span class="rlang"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## whether HOST is set will be shell-dependent e.g. Solaris' csh did not.
Sys.getenv(c("R_HOME", "R_PAPERSIZE", "R_PRINTCMD", "HOST"))

s &lt;- Sys.getenv() # *all* environment variables
op &lt;- options(width=111) # (nice printing)
names(s)    # all settings (the values could be very long)
head(s, 12) # using the Dlist print() method

## Language and Locale settings -- but rather use Sys.getlocale()
s[grep("^L(C|ANG)", names(s))]
## typically R-related:
s[grep("^_?R_", names(s))]
options(op)# reset
</code></pre>

<hr>
<h2 id='Sys.getpid'>Get the Process ID of the R Session</h2><span id='topic+Sys.getpid'></span>

<h3>Description</h3>

<p>Get the process ID of the <span class="rlang"><b>R</b></span> Session.  It is guaranteed by the
operating system that two <span class="rlang"><b>R</b></span> sessions running simultaneously will
have different IDs, but it is possible that <span class="rlang"><b>R</b></span> sessions running at
different times will have the same ID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.getpid()
</code></pre>


<h3>Value</h3>

<p>An integer, often between 1 and 32767 under Unix-alikes (but for
example FreeBSD and macOS use IDs up to 99999) and a
positive integer (up to 32767) under Windows.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Sys.getpid()

## Show files opened from this R process
if(.Platform$OS.type == "unix") ## on Unix-alikes such Linux, macOS, FreeBSD:
   system(paste("lsof -p", Sys.getpid()))
</code></pre>

<hr>
<h2 id='Sys.glob'>Wildcard Expansion on File Paths</h2><span id='topic+Sys.glob'></span>

<h3>Description</h3>

<p>Function to do wildcard expansion (also known as &lsquo;globbing&rsquo;) on
file paths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.glob(paths, dirmark = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.glob_+3A_paths">paths</code></td>
<td>
<p>character vector of patterns for relative or absolute
filepaths.  Missing values will be ignored.</p>
</td></tr>
<tr><td><code id="Sys.glob_+3A_dirmark">dirmark</code></td>
<td>
<p>logical: should matches to directories from patterns
that do not already end in <code>/</code>
have a slash appended?  May not be supported on all platforms.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This expands tilde (see <a href="#topic+tilde+20expansion">tilde expansion</a>) and wildcards in file paths. 
For precise details of wildcards expansion, see your
system's documentation on the <code>glob</code> system call.  There is a
POSIX 1003.2 standard (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/glob.html">https://pubs.opengroup.org/onlinepubs/9699919799/functions/glob.html</a>)
but some OSes will go beyond this.
</p>
<p>All systems should interpret <code>*</code> (match zero or more characters),
<code>?</code> (match a single character) and (probably) <code>[</code> (begin a
character class or range).  The handling of paths
ending with a separator is system-dependent.  On a POSIX-2008
compliant OS they will match directories (only), but as they are not
valid filepaths on Windows, they match nothing there.  (Earlier POSIX
standards allowed them to match files.)

</p>
<p>The rest of these details are indicative (and based on the POSIX
standard).
</p>
<p>If a filename starts with <code>.</code> this may need to be matched
explicitly: for example <code>Sys.glob("*.RData")</code> may or may not
match &lsquo;<span class="file">.RData</span>&rsquo; but will not usually match &lsquo;<span class="file">.aa.RData</span>&rsquo;.  Note
that this is platform-dependent: e.g. on Solaris
<code>Sys.glob("*.*")</code> matches &lsquo;<span class="file">.</span>&rsquo; and &lsquo;<span class="file">..</span>&rsquo;.
</p>
<p><code>[</code> begins a character class.  If the first character in
<code>[...]</code> is not <code>!</code>, this is a character class which matches
a single character against any of the characters specified.  The class
cannot be empty, so <code>]</code> can be included provided it is first.  If
the first character is <code>!</code>, the character class matches a single
character which is <em>none</em> of the specified characters.  Whether
<code>.</code> in a character class matches a leading <code>.</code> in the
filename is OS-dependent.
</p>
<p>Character classes can include ranges such as <code>[A-Z]</code>: include
<code>-</code> as a character by having it first or last in a class.  (The
interpretation of ranges should be locale-specific, so the example is
not a good idea in an Estonian locale.)
</p>
<p>One can remove the special meaning of <code>?</code>, <code>*</code>  and
<code>[</code> by preceding them by a backslash (except within a
character class).
</p>


<h3>Value</h3>

<p>A character vector of matched file paths.  The order is
system-specific (but in the order of the elements of <code>paths</code>): it
is normally collated in either the current locale or in byte (ASCII)
order; however, on Windows collation is in the order of Unicode
points.
</p>
<p>Directory errors are normally ignored, so the matches are to
accessible file paths (but not necessarily accessible files).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+path.expand">path.expand</a></code>.
</p>
<p><a href="#topic+Quotes">Quotes</a> for handling backslashes in character strings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Sys.glob(file.path(R.home(), "library", "*", "R", "*.rdx"))
</code></pre>

<hr>
<h2 id='Sys.info'>Extract System and User Information</h2><span id='topic+Sys.info'></span>

<h3>Description</h3>

<p>Reports system and user information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.info()
</code></pre>


<h3>Details</h3>

<p>This uses POSIX or Windows system calls.  Note that OS names (<code>sysname</code>) might not
be what you expect: for example macOS identifies itself as
&lsquo;<span class="samp">&#8288;Darwin&#8288;</span>&rsquo; and Solaris as &lsquo;<span class="samp">&#8288;SunOS&#8288;</span>&rsquo;.
</p>
<p><code>Sys.info()</code> returns details of the platform <span class="rlang"><b>R</b></span> is running on,
whereas <code><a href="#topic+R.version">R.version</a></code> gives details of the platform <span class="rlang"><b>R</b></span> was
built on: the <code>release</code> and <code>version</code> may well be different.
</p>


<h3>Value</h3>

<p>A character vector with fields
</p>
<table>
<tr><td><code>sysname</code></td>
<td>
<p>The operating system name.</p>
</td></tr>
<tr><td><code>release</code></td>
<td>
<p>The OS release.</p>
</td></tr>
<tr><td><code>version</code></td>
<td>
<p>The OS version.</p>
</td></tr>
<tr><td><code>nodename</code></td>
<td>
<p>A name by which the machine is known on the network (if
any).</p>
</td></tr>
<tr><td><code>machine</code></td>
<td>
<p>A concise description of the hardware, often the CPU type.</p>
</td></tr>
<tr><td><code>login</code></td>
<td>
<p>The user's login name, or <code>"unknown"</code> if it cannot be
ascertained.</p>
</td></tr>
<tr><td><code>user</code></td>
<td>
<p>The name of the real user ID, or <code>"unknown"</code> if it
cannot be ascertained.</p>
</td></tr>
<tr><td><code>effective_user</code></td>
<td>
<p>The name of the effective user ID, or
<code>"unknown"</code> if it
cannot be ascertained.  This may differ from the real user in
&lsquo;set-user-ID&rsquo; processes.</p>
</td></tr>
</table>

<dl>
<dt>On Unix-alike platforms: </dt><dd>
<p>The first five fields come from the <code>uname(2)</code> system call.  The
login name comes from <code>getlogin(2)</code>, and the user names from
<code>getpwuid(getuid())</code> and <code>getpwuid(geteuid())</code>.</p>
</dd>
<dt>On Windows: </dt><dd><p>The last three fields give the same value.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The meaning of <code>release</code> and <code>version</code> is system-dependent:
on a Unix-alike they normally refer to the kernel.  There, usually
<code>release</code> contains a numeric version and <code>version</code> gives
additional information.  Examples for <code>release</code>:
</p>
<pre>
    "4.17.11-200.fc28.x86_64" # Linux (Fedora)
    "3.16.0-5-amd64"          # Linux (Debian)
    "17.7.0"                  # macOS 10.13.6
    "5.11"                    # Solaris
  </pre>
<p>There is no guarantee that the node or login or user names will be
what you might reasonably expect.  (In particular on some Linux
distributions the login name is unknown from sessions with re-directed
inputs.)
</p>
<p>The use of alternatives such as <code>system("whoami")</code> is not
portable: the POSIX command <code>system("id")</code> is much more portable
on Unix-alikes, provided only the POSIX options <span class="option">-[Ggu][nr]</span> are
used (and not the many BSD and GNU extensions).  <code>whoami</code> is
equivalent to <code>id -un</code> (on Solaris, <code>/usr/xpg4/bin/id -un</code>).
</p>
<p>Windows may report unexpected versions: there, see the help for
</p>


<h3>See Also</h3>

<p><code><a href="#topic+.Platform">.Platform</a></code>, and <code><a href="#topic+R.version">R.version</a></code>.
<code><a href="utils.html#topic+sessionInfo">sessionInfo</a>()</code> gives a synopsis of both your system and
the <span class="rlang"><b>R</b></span> session (and gives the OS version in a human-readable form).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sys.info()
## An alternative (and probably better) way to get the login name on Unix
Sys.getenv("LOGNAME")
</code></pre>

<hr>
<h2 id='Sys.localeconv'>Find Details of the Numerical and Monetary Representations
in the Current Locale</h2><span id='topic+localeconv'></span><span id='topic+Sys.localeconv'></span>

<h3>Description</h3>

<p>Get details of the numerical and monetary representations in the
current locale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.localeconv()
</code></pre>


<h3>Details</h3>

<p>Normally <span class="rlang"><b>R</b></span> is run without looking at the value of <span class="env">LC_NUMERIC</span>,
so the decimal point remains '<code>.</code>'.  So the first three of these
components will only be useful if you have set the locale category
<code>LC_NUMERIC</code> using <code>Sys.setlocale</code> in the current <span class="rlang"><b>R</b></span> session
(when <span class="rlang"><b>R</b></span> may not work correctly).
</p>
<p>The monetary components will only be set to non-default values (see
the &lsquo;Examples&rsquo; section) if the <code>LC_MONETARY</code> category is
set.  It often is not set: set the examples for how to trigger setting it.
</p>


<h3>Value</h3>

<p>A character vector with 18 named components.  See your ISO C
documentation for details of the meaning.
</p>
<p>It is possible to compile <span class="rlang"><b>R</b></span> without support for locales, in which
case the value will be <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code> for ways to set locales.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sys.localeconv()
## The results in the C locale are
##    decimal_point     thousands_sep          grouping   int_curr_symbol
##              "."                ""                ""                ""
##  currency_symbol mon_decimal_point mon_thousands_sep      mon_grouping
##               ""                ""                ""                ""
##    positive_sign     negative_sign   int_frac_digits       frac_digits
##               ""                ""             "127"             "127"
##    p_cs_precedes    p_sep_by_space     n_cs_precedes    n_sep_by_space
##            "127"             "127"             "127"             "127"
##      p_sign_posn       n_sign_posn
##            "127"             "127"

## Now try your default locale (which might be "C").
old &lt;- Sys.getlocale()
## The category may not be set:
## the following may do so, but it might not be supported.
Sys.setlocale("LC_MONETARY", locale = "")
Sys.localeconv()
## or set an appropriate value yourself, e.g.
Sys.setlocale("LC_MONETARY", "de_AT")
Sys.localeconv()
Sys.setlocale(locale = old)

## Not run: read.table("foo", dec=Sys.localeconv()["decimal_point"])
</code></pre>

<hr>
<h2 id='sys.parent'>Functions to Access the Function Call Stack</h2><span id='topic+sys.parent'></span><span id='topic+sys.call'></span><span id='topic+sys.calls'></span><span id='topic+sys.frame'></span><span id='topic+sys.frames'></span><span id='topic+sys.nframe'></span><span id='topic+sys.function'></span><span id='topic+sys.parents'></span><span id='topic+sys.on.exit'></span><span id='topic+sys.status'></span><span id='topic+parent.frame'></span>

<h3>Description</h3>

<p>These functions provide access to <code><a href="#topic+environment">environment</a></code>s
(&lsquo;frames&rsquo; in S terminology) associated with functions further
up the calling stack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sys.call(which = 0)
sys.frame(which = 0)
sys.nframe()
sys.function(which = 0)
sys.parent(n = 1)

sys.calls()
sys.frames()
sys.parents()
sys.on.exit()
sys.status()
parent.frame(n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sys.parent_+3A_which">which</code></td>
<td>
<p>the frame number if non-negative, the number of frames
to go back if negative.</p>
</td></tr>
<tr><td><code id="sys.parent_+3A_n">n</code></td>
<td>
<p>the number of generations to go back.  (See the
&lsquo;Details&rsquo; section.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code> is given number 0 in the list of frames.
Each subsequent function evaluation increases the frame stack by 1.
The call, function definition and the environment for evaluation
of that function are returned by <code>sys.call</code>, <code>sys.function</code>
and <code>sys.frame</code> with the appropriate index.
</p>
<p><code>sys.call</code>, <code>sys.function</code> and <code>sys.frame</code> accept
integer values for the argument <code>which</code>.  Non-negative values of
<code>which</code> are frame numbers starting from <code><a href="#topic+.GlobalEnv">.GlobalEnv</a></code>
whereas negative values are counted back from the frame number of the
current evaluation.
</p>
<p>The parent frame of a function evaluation is the environment in which
the function was called.  It is not necessarily numbered one less than
the frame number of the current evaluation, nor is it the environment
within which the function was defined.  <code>sys.parent</code> returns the
number of the parent frame if <code>n</code> is 1 (the default), the
grandparent if <code>n</code> is 2, and so on.  See also the &lsquo;Note&rsquo;.
</p>
<p><code>sys.nframe</code> returns an integer, the number of the current frame
as described in the first paragraph.
</p>
<p><code>sys.calls</code> and <code>sys.frames</code> give a pairlist of all the
active calls and frames, respectively, and <code>sys.parents</code> returns
an integer vector of indices of the parent frames of each of those
frames.
</p>
<p>Notice that even though the <code>sys.</code><em>xxx</em> functions (except
<code>sys.status</code>) are interpreted, their contexts are not counted nor
are they reported.  There is no access to them.
</p>
<p><code>sys.status()</code> returns a list with components <code>sys.calls</code>,
<code>sys.parents</code> and <code>sys.frames</code>, the results of calls to
those three functions (which will include the call to
<code>sys.status</code>: see the first example).
</p>
<p><code>sys.on.exit()</code> returns the expression stored for use by
<code><a href="#topic+on.exit">on.exit</a></code> in the function currently being evaluated.
(Note that this differs from S, which returns a list of expressions
for the current frame and its parents.)
</p>
<p><code>parent.frame(n)</code> is a convenient shorthand for
<code>sys.frame(sys.parent(n))</code> (implemented slightly more efficiently).
</p>


<h3>Value</h3>

<p><code>sys.call</code> returns a call, <code>sys.function</code> a function
definition, and <code>sys.frame</code> and <code>parent.frame</code> return an
environment.
</p>
<p>For the other functions, see the &lsquo;Details&rsquo; section.
</p>


<h3>Note</h3>

<p>Strictly, <code>sys.parent</code> and <code>parent.frame</code> refer to the
<em>context</em> of the parent interpreted function.  So internal
functions (which may or may not set contexts and so may or may not
appear on the call stack) may not be counted, and S3 methods can also do
surprising things.
</p>
<p>As an effect of lazy evaluation, these functions look at the call stack at
the time they are evaluated, not at the time they are called.  Passing
calls to them as function arguments is unlikely to be a good idea, but
these functions still look at the call stack and count frames from the
frame of the function evaluation from which they were called.
</p>
<p>Hence, when these functions are called to provide default values for
function arguments, they are evaluated in the evaluation of the called
function and they count frames accordingly (see e.g. the <code>envir</code>
argument of <code><a href="#topic+eval">eval</a></code>).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.  (Not <code>parent.frame</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eval">eval</a></code> for a usage of <code>sys.frame</code> and <code>parent.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(utils)

## Note: the first two examples will give different results
## if run by example().
ff &lt;- function(x) gg(x)
gg &lt;- function(y) sys.status()
str(ff(1))

gg &lt;- function(y) {
    ggg &lt;- function() {
        cat("current frame is", sys.nframe(), "\n")
        cat("parents are", sys.parents(), "\n")
        print(sys.function(0)) # ggg
        print(sys.function(2)) # gg
    }
    if(y &gt; 0) gg(y-1) else ggg()
}
gg(3)

t1 &lt;- function() {
  aa &lt;- "here"
  t2 &lt;- function() {
    ## in frame 2 here
    cat("current frame is", sys.nframe(), "\n")
    str(sys.calls()) ## list with two components t1() and t2()
    cat("parents are frame numbers", sys.parents(), "\n") ## 0 1
    print(ls(envir = sys.frame(-1))) ## [1] "aa" "t2"
    invisible()
  }
  t2()
}
t1()

test.sys.on.exit &lt;- function() {
  on.exit(print(1))
  ex &lt;- sys.on.exit()
  str(ex)
  cat("exiting...\n")
}
test.sys.on.exit()
## gives 'language print(1)', prints 1 on exit

## An example where the parent is not the next frame up the stack
## since method dispatch uses a frame.
as.double.foo &lt;- function(x)
{
    str(sys.calls())
    print(sys.frames())
    print(sys.parents())
    print(sys.frame(-1)); print(parent.frame())
    x
}
t2 &lt;- function(x) as.double(x)
a &lt;- structure(pi, class = "foo")
t2(a)
</code></pre>

<hr>
<h2 id='Sys.readlink'>
Read File Symbolic Links
</h2><span id='topic+Sys.readlink'></span>

<h3>Description</h3>

<p>Find out if a file path is a symbolic link, and if so what it is
linked to, <em>via</em> the system call <code>readlink</code>.
</p>
<p>Symbolic links are a POSIX concept, not implemented on Windows but for
most filesystems on Unix-alikes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.readlink(paths)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.readlink_+3A_paths">paths</code></td>
<td>
<p>character vector of file paths.  Tilde expansion is done:
see <code><a href="#topic+path.expand">path.expand</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of the same length as <code>paths</code>.  The
entries are the path of the file linked to, <code>""</code> if the path is
not a symbolic link, and <code>NA</code> if there is an error (e.g., the
path does not exist or cannot be converted to the native encoding).
</p>
<p>On platforms without the <code>readlink</code> system call, all elements are
<code>""</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.symlink">file.symlink</a></code> for the creation of symbolic links (and
their Windows analogues), <code><a href="#topic+file.info">file.info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##' To check if files (incl. directories) are symbolic links:
is.symlink &lt;- function(paths) isTRUE(nzchar(Sys.readlink(paths), keepNA=TRUE))
## will return all FALSE when the platform has no `readlink` system call.
is.symlink("/foo/bar")
</code></pre>

<hr>
<h2 id='Sys.setenv'>Set or Unset Environment Variables</h2><span id='topic+Sys.setenv'></span><span id='topic+Sys.unsetenv'></span>

<h3>Description</h3>

<p><code>Sys.setenv</code> sets environment variables (for other processes
called from within <span class="rlang"><b>R</b></span> or future calls to <code><a href="#topic+Sys.getenv">Sys.getenv</a></code> from
this <span class="rlang"><b>R</b></span> process).
</p>
<p><code>Sys.unsetenv</code> removes environment variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.setenv(...)

Sys.unsetenv(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.setenv_+3A_...">...</code></td>
<td>
<p>named arguments with values coercible to a character string.</p>
</td></tr>
<tr><td><code id="Sys.setenv_+3A_x">x</code></td>
<td>
<p>a character vector, or an object coercible to character.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-standard <span class="rlang"><b>R</b></span> names must be quoted in <code>Sys.setenv</code>: see the
examples.  Most platforms (and POSIX) do not allow names containing
<code>"="</code>.  Windows does, but the facilities provided by <span class="rlang"><b>R</b></span> may not
handle these correctly so they should be avoided.  Most platforms
allow setting an environment variable to <code>""</code>, but Windows does
not and there <code>Sys.setenv(FOO = "")</code> unsets <span class="env">FOO</span>.
</p>
<p>There may be system-specific limits on the maximum length of the
values of individual environment variables or of names+values of all
environment variables.
</p>

<p>Recent versions of Windows have a maximum length of 32,767 characters for a
environment variable; however <code>cmd.exe</code> has a limit of 8192
characters for a command line, hence <code>set</code> can only set 8188.

</p>


<h3>Value</h3>

<p>A logical vector, with elements being true if (un)setting the
corresponding variable succeeded.  (For <code>Sys.unsetenv</code> this
includes attempting to remove a non-existent variable.)
</p>


<h3>Note</h3>

<p>On Unix-alikes, if <code>Sys.unsetenv</code> is not supported, it will at
least try to set the value of the environment variable to <code>""</code>,
with a warning.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.getenv">Sys.getenv</a></code>, <a href="#topic+Startup">Startup</a> for ways to set environment
variables for the <span class="rlang"><b>R</b></span> session.
</p>
<p><code><a href="#topic+setwd">setwd</a></code> for the working directory.
</p>
<p><code><a href="#topic+Sys.setlocale">Sys.setlocale</a></code> to set (and get) language locale variables,
and notably <code><a href="#topic+Sys.setLanguage">Sys.setLanguage</a></code> to set the <span class="env">LANGUAGE</span>
environment variable which is used for <code><a href="#topic+conditionMessage">conditionMessage</a></code>
translations.
</p>
<p>The help for &lsquo;<a href="#topic+environment+20variables">environment variables</a>&rsquo; lists many of the
environment variables used by <span class="rlang"><b>R</b></span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(Sys.setenv(R_TEST = "testit", "A+C" = 123))  # `A+C` could also be used
Sys.getenv("R_TEST")
Sys.unsetenv("R_TEST") # on Unix-alike may warn and not succeed
Sys.getenv("R_TEST", unset = NA)
</code></pre>

<hr>
<h2 id='Sys.setFileTime'>
Set File Time
</h2><span id='topic+Sys.setFileTime'></span>

<h3>Description</h3>

<p>Uses system calls to set the times on a file or directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.setFileTime(path, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.setFileTime_+3A_path">path</code></td>
<td>

<p>A character vector containing file or directory paths.
</p>
</td></tr>
<tr><td><code id="Sys.setFileTime_+3A_time">time</code></td>
<td>

<p>A date-time of class <code>"<a href="#topic+POSIXct">POSIXct</a>"</code> or an object which can be
coerced to one.  Fractions of a second may be ignored.  Recycled along
<code>paths</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This attempts sets the file time to the value specified.
</p>
<p>On a Unix-alike it uses the system call <code>utimensat</code> if that is
available, otherwise <code>utimes</code> or <code>utime</code>.  On a POSIX file
system it sets both the last-access and modification times.
Fractional seconds will set as from <span class="rlang"><b>R</b></span> 3.4.0 on OSes with the
requisite system calls and suitable filesystems.
</p>
<p>On Windows it uses the system call <code>SetFileTime</code> to set the
&lsquo;last write time&rsquo;.  Some Windows file systems only record the
time at a resolution of two seconds.
</p>
<p><code>Sys.setFileTime</code> has been vectorized in <span class="rlang"><b>R</b></span> 3.6.0.  Earlier versions
of <span class="rlang"><b>R</b></span> required <code>path</code> and <code>time</code> to be vectors of length one.
</p>


<h3>Value</h3>

<p>A logical vector indicating if the operation succeeded for each of the
files and directories attempted, returned invisibly.
</p>

<hr>
<h2 id='Sys.sleep'>Suspend Execution for a Time Interval</h2><span id='topic+Sys.sleep'></span>

<h3>Description</h3>

<p>Suspend execution of <span class="rlang"><b>R</b></span> expressions for a specified time interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.sleep(time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.sleep_+3A_time">time</code></td>
<td>
<p>The time interval to suspend execution for, in seconds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using this function allows <span class="rlang"><b>R</b></span> to temporarily be given very low
priority and hence not to interfere with more important foreground
tasks.  A typical use is to allow a process launched from <span class="rlang"><b>R</b></span> to set
itself up and read its input files before <span class="rlang"><b>R</b></span> execution is resumed.
</p>
<p>The intention is that this function suspends execution of <span class="rlang"><b>R</b></span>
expressions but wakes the process up often enough to respond to GUI
events, typically every half second.  It can be interrupted
(e.g. by &lsquo;<span class="samp">&#8288;Ctrl-C&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;Esc&#8288;</span>&rsquo; at the <span class="rlang"><b>R</b></span> console).
</p>
<p>There is no guarantee that the process will sleep for the whole of the
specified interval (sleep might be interrupted), and it may well take
slightly longer in real time to resume execution.
</p>
<p><code>time</code> must be non-negative (and not <code>NA</code> nor <code>NaN</code>):
<code>Inf</code> is allowed (and might be appropriate if the intention is to
wait indefinitely for an interrupt).  The resolution of the time
interval is system-dependent, but will normally be 20ms or better.
(On modern Unix-alikes it will be better than 1ms.)
</p>


<h3>Value</h3>

<p>Invisible <code>NULL</code>.
</p>


<h3>Note</h3>

<p>Despite its name, this is not currently implemented using the
<code>sleep</code> system call (although on Windows it does make use of
<code>Sleep</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
testit &lt;- function(x)
{
    p1 &lt;- proc.time()
    Sys.sleep(x)
    proc.time() - p1 # The cpu usage should be negligible
}
testit(3.7)
</code></pre>

<hr>
<h2 id='sys.source'>Parse and Evaluate Expressions from a File</h2><span id='topic+sys.source'></span>

<h3>Description</h3>

<p>Parses expressions in the given file, and then successively evaluates
them in the specified environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sys.source(file, envir = baseenv(), chdir = FALSE,
           keep.source = getOption("keep.source.pkgs"),
           keep.parse.data = getOption("keep.parse.data.pkgs"),
           toplevel.env = as.environment(envir))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sys.source_+3A_file">file</code></td>
<td>
<p>a character string naming the file to be read from.</p>
</td></tr>
<tr><td><code id="sys.source_+3A_envir">envir</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object specifying the environment in which the
expressions are to be evaluated.  May also be a list or an integer.
The default <code><a href="#topic+baseenv">baseenv</a>()</code> corresponds to evaluation in the base
environment.  This is probably not what you want; you should
typically supply an explicit <code>envir</code> argument, see the
&lsquo;Note&rsquo;.</p>
</td></tr>
<tr><td><code id="sys.source_+3A_chdir">chdir</code></td>
<td>
<p>logical; if <code>TRUE</code>, the <span class="rlang"><b>R</b></span> working directory is
changed to the directory containing <code>file</code> for evaluating.</p>
</td></tr>
<tr><td><code id="sys.source_+3A_keep.source">keep.source</code></td>
<td>
<p>logical.  If <code>TRUE</code>, functions keep
their source including comments, see
<code><a href="#topic+options">options</a>(keep.source = *)</code> for more details.</p>
</td></tr>
<tr><td><code id="sys.source_+3A_keep.parse.data">keep.parse.data</code></td>
<td>
<p>logical.  If <code>TRUE</code> and <code>keep.source</code> is
also <code>TRUE</code>, functions keep parse data with their source, see
<code><a href="#topic+options">options</a>(keep.parse.data = *)</code> for more details.</p>
</td></tr>
<tr><td><code id="sys.source_+3A_toplevel.env">toplevel.env</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> environment to be used as top level while
evaluating the expressions.  This argument is useful for frameworks
running package tests; the default should be used in other cases.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For large files, <code>keep.source = FALSE</code> may save quite a bit of
memory. Disabling only parse data via <code>keep.parse.data = FALSE</code>
can already save a lot.
</p>


<h3>Note on <code>envir</code></h3>

<p>In order for the code being evaluated to use the correct environment
(for example, in global assignments), source code in packages should
call <code><a href="#topic+topenv">topenv</a>()</code>, which will return the namespace, if any,
the environment set up by <code>sys.source</code>, or the global environment
if a saved image is being used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+source">source</a></code>, and <code><a href="#topic+loadNamespace">loadNamespace</a></code> which
is called from <code><a href="#topic+library">library</a>(.)</code> and uses <code>sys.source(.)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a simple way to put some objects in an environment
## high on the search path
tmp &lt;- tempfile()
writeLines("aaa &lt;- pi", tmp)
env &lt;- attach(NULL, name = "myenv")
sys.source(tmp, env)
unlink(tmp)
search()
aaa
detach("myenv")
</code></pre>

<hr>
<h2 id='Sys.time'>Get Current Date and Time</h2><span id='topic+Sys.time'></span><span id='topic+Sys.Date'></span>

<h3>Description</h3>

<p><code>Sys.time</code> and <code>Sys.Date</code> returns the system's idea of the
current date with and without time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.time()
Sys.Date()
</code></pre>


<h3>Details</h3>

<p><code>Sys.time</code> returns an absolute date-time value which can be
converted to various time zones and may return different days.
</p>
<p><code>Sys.Date</code> returns the current day in the current <a href="#topic+time+20zone">time zone</a>.
</p>


<h3>Value</h3>

<p><code>Sys.time</code> returns an object of class <code>"POSIXct"</code> (see
<a href="#topic+DateTimeClasses">DateTimeClasses</a>).  On almost all systems it will have
sub-second accuracy, possibly microseconds or better.  On Windows it
increments in clock ticks (usually 1/60 of a second) reported to
millisecond accuracy.
</p>
<p><code>Sys.Date</code> returns an object of class <code>"Date"</code> (see <a href="#topic+Date">Date</a>).
</p>


<h3>Note</h3>

<p><code>Sys.time</code> may return fractional seconds, but they are ignored by
the default conversions (e.g., printing) for class <code>"POSIXct"</code>.
See the examples and <code><a href="#topic+format.POSIXct">format.POSIXct</a></code> for ways to reveal them.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+date">date</a></code> for the system time in a fixed-format character
string.
</p>
<p><code><a href="#topic+Sys.timezone">Sys.timezone</a></code>.
</p>
<p><code><a href="#topic+system.time">system.time</a></code> for measuring elapsed/CPU time of expressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Sys.time()
## print with possibly greater accuracy:
op &lt;- options(digits.secs = 6)
Sys.time()
options(op)

## locale-specific version of date()
format(Sys.time(), "%a %b %d %X %Y")

Sys.Date()
</code></pre>

<hr>
<h2 id='Sys.which'>Find Full Paths to Executables</h2><span id='topic+Sys.which'></span>

<h3>Description</h3>

<p>This is an interface to the system command <code>which</code>, or to an
emulation on Windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.which(names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sys.which_+3A_names">names</code></td>
<td>
<p>Character vector of names or paths of possible executables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The system command <code>which</code> reports on the full path names of
an executable (including an executable script) as would be executed by
a shell, accepting either absolute paths or looking on the path.
</p>
<p>On Windows an &lsquo;executable&rsquo; is a file with extension
&lsquo;<span class="file">.exe</span>&rsquo;, &lsquo;<span class="file">.com</span>&rsquo;, &lsquo;<span class="file">.cmd</span>&rsquo; or &lsquo;<span class="file">.bat</span>&rsquo;.  Such files need
not actually be executable, but they are what <code><a href="#topic+system">system</a></code>
tries.
</p>
<p>On a Unix-alike the full path to <code>which</code> (usually
&lsquo;<span class="file">/usr/bin/which</span>&rsquo;) is found when <span class="rlang"><b>R</b></span> is installed.
</p>


<h3>Value</h3>

<p>A character vector of the same length as <code>names</code>, named by
<code>names</code>.  The elements are either the full path to the
executable  or some indication that no executable of that name was
found.  Typically the indication is <code>""</code>, but this does depend on
the OS (and the known exceptions are changed to <code>""</code>).  Missing
values in <code>names</code> have missing return values.
</p>
<p>On Windows the paths will be short paths (8+3 components, no spaces)
with <code>\</code> as the path delimiter.
</p>


<h3>Note</h3>

<p>Except on Windows this calls the system command <code>which</code>: since
that is not part of e.g. the POSIX standards, exactly what it does is
OS-dependent.  It will usually do tilde-expansion and it may make use
of <code>csh</code> aliases.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## the first two are likely to exist everywhere
## texi2dvi exists on most Unix-alikes and under MiKTeX
Sys.which(c("ftp", "ping", "texi2dvi", "this-does-not-exist"))
</code></pre>

<hr>
<h2 id='system'>Invoke a System Command</h2><span id='topic+system'></span><span id='topic+shell'></span>

<h3>Description</h3>

<p><code>system</code> invokes the OS command specified by <code>command</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>system(command, intern = FALSE,
       ignore.stdout = FALSE, ignore.stderr = FALSE,
       wait = TRUE, input = NULL, show.output.on.console = TRUE,
       minimized = FALSE, invisible = TRUE, timeout = 0,
       receive.console.signals = wait)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="system_+3A_command">command</code></td>
<td>
<p>the system command to be invoked, as a character string.</p>
</td></tr>
<tr><td><code id="system_+3A_intern">intern</code></td>
<td>
<p>a logical (not <code>NA</code>) which indicates whether to
capture the output of the command as an <span class="rlang"><b>R</b></span> character vector.</p>
</td></tr>
<tr><td><code id="system_+3A_ignore.stdout">ignore.stdout</code>, <code id="system_+3A_ignore.stderr">ignore.stderr</code></td>
<td>
<p>a logical (not <code>NA</code>)
indicating whether messages written to &lsquo;<span class="file">stdout</span>&rsquo; or
&lsquo;<span class="file">stderr</span>&rsquo; should be ignored.</p>
</td></tr>
<tr><td><code id="system_+3A_wait">wait</code></td>
<td>
<p>a logical (not <code>NA</code>) indicating whether the <span class="rlang"><b>R</b></span>
interpreter should wait for the command to finish, or run it
asynchronously.  This will be ignored (and the interpreter will
always wait) if <code>intern = TRUE</code>. When running the command
asynchronously, no output will be displayed on the <code>Rgui</code>
console in Windows (it will be dropped, instead).</p>
</td></tr>
<tr><td><code id="system_+3A_input">input</code></td>
<td>
<p>if a character vector is supplied, this is copied one
string per line to a temporary file, and the standard input of
<code>command</code> is redirected to the file.</p>
</td></tr>
<tr><td><code id="system_+3A_timeout">timeout</code></td>
<td>
<p>timeout in seconds, ignored if 0.  This is a limit for the
elapsed time running <code>command</code> in a separate process.  Fractions
of seconds are ignored.</p>
</td></tr>
<tr><td><code id="system_+3A_receive.console.signals">receive.console.signals</code></td>
<td>
<p>a logical (not <code>NA</code>) indicating
whether the command should receive events from the terminal/console that
<span class="rlang"><b>R</b></span> runs from, particularly whether it should be interrupted by
<kbd>Ctrl-C</kbd>. This will be ignored and events will always be received when
<code>intern = TRUE</code> or <code>wait = TRUE</code>.</p>
</td></tr>
<tr><td><code id="system_+3A_show.output.on.console">show.output.on.console</code>, <code id="system_+3A_minimized">minimized</code>, <code id="system_+3A_invisible">invisible</code></td>
<td>
<p>arguments
that are accepted on Windows but ignored on this platform, with a
warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This interface has become rather complicated over the years: see
<code><a href="#topic+system2">system2</a></code> for a more portable and flexible interface
which is recommended for new code.
</p>
<p><code>command</code> is parsed as a command plus arguments separated by
spaces.  So if the path to the command (or a single argument such as a
file path) contains spaces, it must be quoted e.g. by
<code><a href="#topic+shQuote">shQuote</a></code>.
Unix-alikes pass the command line to a shell (normally &lsquo;<span class="file">/bin/sh</span>&rsquo;,
and POSIX requires that shell), so <code>command</code> can be anything the
shell regards as executable, including shell scripts, and it can
contain multiple commands separated by <code>;</code>.
</p>
<p>On Windows, <code>system</code> does not use a shell and there is a separate
function <code>shell</code> which passes command lines to a shell.
</p>
<p>If <code>intern</code> is <code>TRUE</code> then <code>popen</code> is used to invoke the
command and the output collected, line by line, into an <span class="rlang"><b>R</b></span>
<code><a href="#topic+character">character</a></code> vector.  If <code>intern</code> is <code>FALSE</code> then
the C function <code>system</code> is used to invoke the command.
</p>
<p><code>wait</code> is implemented by appending <code>&amp;</code> to the command: this
is in principle shell-dependent, but required by POSIX and so widely
supported.
</p>
<p>When <code>timeout</code> is non-zero, the command is terminated after the given
number of seconds.  The termination works for typical commands, but is not
guaranteed: it is possible to write a program that would keep running
after the time is out.  Timeouts can only be set with <code>wait = TRUE</code>.
</p>
<p>Timeouts cannot be used with interactive commands: the command is run with
standard input redirected from &lsquo;<span class="file">/dev/null</span>&rsquo; and it must not modify
terminal settings.  As long as tty <code>tostop</code> option is disabled, which
it usually is by default, the executed command may write to standard
output and standard error.  One cannot rely on that the execution time of
the child processes will be included into <code>user.child</code> and
<code>sys.child</code> element of <code>proc_time</code> returned by <code>proc.time</code>. 
For the time to be included, all child processes have to be waited for by
their parents, which has to be implemented in the parent applications.
</p>
<p>The ordering of arguments after the first two has changed from time to
time: it is recommended to name all arguments after the first.
</p>
<p>There are many pitfalls in using <code>system</code> to ascertain if a
command can be run &mdash; <code><a href="#topic+Sys.which">Sys.which</a></code> is more suitable.
</p>
<p><code>receive.console.signals = TRUE</code> is useful when running asynchronous
processes (using <code>wait = FALSE</code>) to implement a synchronous operation.
In all other cases it is recommended to use the default.
</p>


<h3>Value</h3>

<p>If <code>intern = TRUE</code>, a character vector giving the output of the
command, one line per character string.  (Output lines of more than
8095 bytes will be split on some systems.)
If the command could not be run an <span class="rlang"><b>R</b></span> error is generated.
If <code>command</code> runs but gives a non-zero exit status this will be
reported with a warning and in the attribute <code>"status"</code> of the
result: an attribute <code>"errmsg"</code> may also be available.
</p>
<p>If <code>intern = FALSE</code>, the return value is an error code (<code>0</code>
for success), given the invisible attribute (so needs to be printed
explicitly).  If the command could not be run for any reason, the
value is <code>127</code> and a warning is issued (as from <span class="rlang"><b>R</b></span> 3.5.0).
Otherwise if <code>wait = TRUE</code> the value is the exit status returned
by the command, and if <code>wait = FALSE</code> it is <code>0</code> (the
conventional success value).
</p>
<p>If the command times out, a warning is reported and the exit status is
<code>124</code>.
</p>


<h3>Stdout and stderr</h3>

<p>For command-line <span class="rlang"><b>R</b></span>, error messages written to &lsquo;<span class="file">stderr</span>&rsquo; will be
sent to the terminal unless <code>ignore.stderr = TRUE</code>.  They can be
captured (in the most likely shells) by
</p>
<pre>    system("some command 2&gt;&amp;1", intern = TRUE)
</pre>
<p>For GUIs, what happens to output sent to &lsquo;<span class="file">stdout</span>&rsquo; or
&lsquo;<span class="file">stderr</span>&rsquo; if <code>intern = FALSE</code> is interface-specific, and it
is unsafe to assume that such messages will appear on a GUI console
(they do on the macOS GUI's console, but not on some others).
</p>


<h3>Differences between Unix and Windows</h3>

<p>How processes are launched differs fundamentally between Windows and
Unix-alike operating systems, as do the higher-level OS functions on
which this <span class="rlang"><b>R</b></span> function is built.  So it should not be surprising that
there are many differences between OSes in how <code>system</code> behaves.
For the benefit of programmers, the more important ones are summarized
in this section.
</p>

<ul>
<li><p> The most important difference is that on a Unix-alike
<code>system</code> launches a shell which then runs <code>command</code>.  On
Windows the command is run directly &ndash; use <code>shell</code> for an
interface which runs <code>command</code> <em>via</em> a shell (by default
the Windows shell <code>cmd.exe</code>, which has many differences from
a POSIX shell).
</p>
<p>This means that it cannot be assumed that redirection or piping will
work in <code>system</code> (redirection sometimes does, but we have seen
cases where it stopped working after a Windows security patch), and
<code><a href="#topic+system2">system2</a></code> (or <code>shell</code>) must be used on Windows.
</p>
</li>
<li><p> What happens to <code>stdout</code> and <code>stderr</code> when not
captured depends on how <span class="rlang"><b>R</b></span> is running: Windows batch commands behave
like a Unix-alike, but from the Windows GUI they are
generally lost.  <code>system(intern = TRUE)</code> captures &lsquo;<span class="file">stderr</span>&rsquo;
when run from the Windows GUI console unless <code>ignore.stderr =
      TRUE</code>.
</p>
</li>
<li><p> The behaviour on error is different in subtle ways (and has
differed between <span class="rlang"><b>R</b></span> versions).
</p>
</li>
<li><p> The quoting conventions for <code>command</code> differ, but
<code><a href="#topic+shQuote">shQuote</a></code> is a portable interface.
</p>
</li>
<li><p> Arguments <code>show.output.on.console</code>, <code>minimized</code>,
<code>invisible</code> only do something on Windows (and are most relevant
to <code>Rgui</code> there).
</p>
</li></ul>



<h3>See Also</h3>

<p><code>man system</code> and <code>man sh</code> for how this is implemented
on the OS in use.
</p>
<p><code><a href="#topic+.Platform">.Platform</a></code> for platform-specific variables.
</p>
<p><code><a href="#topic+pipe">pipe</a></code> to set up a pipe connection.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># list all files in the current directory using the -F flag
## Not run: system("ls -F")

# t1 is a character vector, each element giving a line of output from who
# (if the platform has who)
t1 &lt;- try(system("who", intern = TRUE))

try(system("ls fizzlipuzzli", intern = TRUE, ignore.stderr = TRUE))
# zero-length result since file does not exist, and will give warning.
</code></pre>

<hr>
<h2 id='system.file'>Find Names of R System Files</h2><span id='topic+system.file'></span>

<h3>Description</h3>

<p>Finds the full file names of files in packages etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>system.file(..., package = "base", lib.loc = NULL,
            mustWork = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="system.file_+3A_...">...</code></td>
<td>
<p>character vectors, specifying subdirectory and file(s)
within some package.  The default, none, returns the
root of the package.  Wildcards are not supported.</p>
</td></tr>
<tr><td><code id="system.file_+3A_package">package</code></td>
<td>
<p>a character string with the name of a single package.
An error occurs if more than one package name is given.</p>
</td></tr>
<tr><td><code id="system.file_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector with path names of <span class="rlang"><b>R</b></span> libraries.
See &lsquo;Details&rsquo; for the meaning of the default value of <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="system.file_+3A_mustwork">mustWork</code></td>
<td>
<p>logical.  If <code>TRUE</code>, an error is given if there
are no matching files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This checks the existence of the specified files with
<code><a href="#topic+file.exists">file.exists</a></code>.  So file paths are only returned if there
are sufficient permissions to establish their existence.
</p>
<p>The unnamed arguments in <code>...</code> are usually character strings, but
if character vectors they are recycled to the same length.
</p>
<p>This uses <code><a href="#topic+find.package">find.package</a></code> to find the package, and hence
with the default <code>lib.loc = NULL</code> looks first for attached
packages then in each library listed in <code><a href="#topic+.libPaths">.libPaths</a>()</code>.
Note that if a namespace is loaded but the package is not attached,
this will look only on <code><a href="#topic+.libPaths">.libPaths</a>()</code>.
</p>


<h3>Value</h3>

<p>A character vector of positive length, containing the file paths
that matched <code>...</code>, or the empty string, <code>""</code>, if none
matched (unless <code>mustWork = TRUE</code>).
</p>
<p>If matching the root of a package, there is no trailing separator.
</p>
<p><code>system.file()</code> with no arguments gives the root of the
<span class="pkg">base</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+R.home">R.home</a></code> for the root directory of the <span class="rlang"><b>R</b></span>
installation, <code><a href="#topic+list.files">list.files</a></code>.
</p>
<p><code><a href="#topic+Sys.glob">Sys.glob</a></code> to find paths via wildcards.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>system.file()                  # The root of the 'base' package
system.file(package = "stats") # The root of package 'stats'
system.file("INDEX")
system.file("help", "AnIndex", package = "splines")
</code></pre>

<hr>
<h2 id='system.time'>CPU Time Used</h2><span id='topic+system.time'></span>

<h3>Description</h3>

<p>Return CPU (and other) times that <code>expr</code> used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>system.time(expr, gcFirst = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="system.time_+3A_expr">expr</code></td>
<td>
<p>Valid <span class="rlang"><b>R</b></span> expression to be timed.</p>
</td></tr>
<tr><td><code id="system.time_+3A_gcfirst">gcFirst</code></td>
<td>
<p>Logical - should a garbage collection be performed
immediately before the timing?  Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>system.time</code> calls the function <code><a href="#topic+proc.time">proc.time</a></code>,
evaluates <code>expr</code>, and then calls <code>proc.time</code> once more,
returning the difference between the two <code>proc.time</code> calls.
</p>
<p><code>unix.time</code> has been an alias of <code>system.time</code>, for
compatibility with S, has been deprecated in 2016 and finally became
defunct in 2022.
</p>
<p>Timings of evaluations of the same expression can vary considerably
depending on whether the evaluation triggers a garbage collection.  When
<code>gcFirst</code> is <code>TRUE</code> a garbage collection (<code><a href="#topic+gc">gc</a></code>)
will be performed immediately before the evaluation of <code>expr</code>.
This will usually produce more consistent timings.
</p>


<h3>Value</h3>

<p>A object of class <code>"proc_time"</code>: see
<code><a href="#topic+proc.time">proc.time</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+proc.time">proc.time</a></code>, <code><a href="stats.html#topic+time">time</a></code> which is for time series.
</p>
<p><code><a href="#topic+setTimeLimit">setTimeLimit</a></code> to limit the (CPU/elapsed) time <span class="rlang"><b>R</b></span> is allowed
to use.
</p>
<p><code><a href="#topic+Sys.time">Sys.time</a></code> to get the current date &amp; time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
system.time(for(i in 1:100) mad(runif(1000)))
## Not run: 
exT &lt;- function(n = 10000) {
  # Purpose: Test if system.time works ok;   n: loop size
  system.time(for(i in 1:n) x &lt;- mean(rt(1000, df = 4)))
}
#-- Try to interrupt one of the following (using Ctrl-C / Escape):
exT()                 #- about 4 secs on a 2.5GHz Xeon
system.time(exT())    #~ +/- same

## End(Not run)</code></pre>

<hr>
<h2 id='system2'>Invoke a System Command</h2><span id='topic+system2'></span>

<h3>Description</h3>

<p><code>system2</code> invokes the OS command specified by <code>command</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>system2(command, args = character(),
        stdout = "", stderr = "", stdin = "", input = NULL,
        env = character(), wait = TRUE,
        minimized = FALSE, invisible = TRUE, timeout = 0,
        receive.console.signals = wait)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="system2_+3A_command">command</code></td>
<td>
<p>the system command to be invoked, as a character string.</p>
</td></tr>
<tr><td><code id="system2_+3A_args">args</code></td>
<td>
<p>a character vector of arguments to <code>command</code>.
The arguments have to be quoted e.g. by <code><a href="#topic+shQuote">shQuote</a></code>
in case they contain space or other special characters
(a double quote or backslash on Windows, shell-specific special
characters on Unix).</p>
</td></tr>
<tr><td><code id="system2_+3A_stdout">stdout</code>, <code id="system2_+3A_stderr">stderr</code></td>
<td>
<p>where output to &lsquo;<span class="file">stdout</span>&rsquo; or
&lsquo;<span class="file">stderr</span>&rsquo; should be sent.  Possible values are <code>""</code>, to the <span class="rlang"><b>R</b></span>
console (the default), <code>NULL</code> or <code>FALSE</code> (discard output),
<code>TRUE</code> (capture the output in a character vector) or a
character string naming a file.</p>
</td></tr>
<tr><td><code id="system2_+3A_stdin">stdin</code></td>
<td>
<p>should input be diverted?  <code>""</code> means the default,
alternatively a character string naming a file.  Ignored
if <code>input</code> is supplied.</p>
</td></tr>
<tr><td><code id="system2_+3A_input">input</code></td>
<td>
<p>if a character vector is supplied, this is copied one
string per line to a temporary file, and the standard input of
<code>command</code> is redirected to the file.</p>
</td></tr>
<tr><td><code id="system2_+3A_env">env</code></td>
<td>
<p>character vector of name=value strings to set environment
variables.</p>
</td></tr>
<tr><td><code id="system2_+3A_wait">wait</code></td>
<td>
<p>a logical (not <code>NA</code>) indicating whether the <span class="rlang"><b>R</b></span>
interpreter should wait for the command to finish, or run it
asynchronously.  This will be ignored (and the interpreter will
always wait) if <code>stdout = TRUE</code> or <code>stderr = TRUE</code>. When
running the command asynchronously, no output will be displayed on
the <code>Rgui</code> console in Windows (it will be dropped, instead).</p>
</td></tr>
<tr><td><code id="system2_+3A_timeout">timeout</code></td>
<td>
<p>timeout in seconds, ignored if 0.  This is a limit for the
elapsed time running <code>command</code> in a separate process.   Fractions
of seconds are ignored.</p>
</td></tr>
<tr><td><code id="system2_+3A_receive.console.signals">receive.console.signals</code></td>
<td>
<p>a logical (not <code>NA</code>) indicating whether
the command should receive events from the terminal/console that <span class="rlang"><b>R</b></span> runs
from, particularly whether it should be interrupted by <kbd>Ctrl-C</kbd>. This
will be ignored and events will always be received when
<code>intern = TRUE</code> or <code>wait = TRUE</code>.</p>
</td></tr>
<tr><td><code id="system2_+3A_minimized">minimized</code>, <code id="system2_+3A_invisible">invisible</code></td>
<td>
<p>arguments that are accepted on Windows but
ignored on this platform, with a warning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike <code><a href="#topic+system">system</a></code>, <code>command</code> is always quoted by
<code><a href="#topic+shQuote">shQuote</a></code>, so it must be a single command without arguments.
</p>
<p>For details of how <code>command</code> is found see <code><a href="#topic+system">system</a></code>.
</p>
<p>On Windows, <code>env</code> is only supported for commands such as
<code>R</code> and <code>make</code> which accept environment variables on
their command line.
</p>
<p>Some Unix commands (such as some implementations of <code>ls</code>) change
their output if they consider it to be piped or redirected:
<code>stdout = TRUE</code> uses a pipe whereas <code>stdout =
  "some_file_name"</code> uses redirection.
</p>
<p>Because of the way it is implemented, on a Unix-alike <code>stderr =
    TRUE</code> implies <code>stdout = TRUE</code>: a warning is given if this is
not what was specified.
</p>
<p>When <code>timeout</code> is non-zero, the command is terminated after the given
number of seconds.  The termination works for typical commands, but is not
guaranteed: it is possible to write a program that would keep running
after the time is out.  Timeouts can only be set with <code>wait = TRUE</code>.
</p>
<p>Timeouts cannot be used with interactive commands: the command is run with
standard input redirected from <code>/dev/null</code> and it must not modify
terminal settings.  As long as tty <code>tostop</code> option is disabled, which
it usually is by default, the executed command may write to standard
output and standard error.
</p>
<p><code>receive.console.signals = TRUE</code> is useful when running asynchronous
processes (using <code>wait = FALSE</code>) to implement a synchronous operation.
In all other cases it is recommended to use the default.
</p>


<h3>Value</h3>

<p>If <code>stdout = TRUE</code> or <code>stderr = TRUE</code>, a character vector
giving the output of the command, one line per character string.
(Output lines of more than 8095 bytes will be split.)  If the command
could not be run an <span class="rlang"><b>R</b></span> error is generated.  If <code>command</code> runs but
gives a non-zero exit status this will be reported with a warning and
in the attribute <code>"status"</code> of the result: an attribute
<code>"errmsg"</code> may also be available.
</p>
<p>In other cases, the return value is an error code (<code>0</code> for
success), given the <a href="#topic+invisible">invisible</a> attribute (so needs to be printed
explicitly).  If the command could not be run for any reason, the
value is <code>127</code> and a warning is issued (as from <span class="rlang"><b>R</b></span> 3.5.0).
Otherwise if <code>wait = TRUE</code> the value is the exit status returned
by the command, and if <code>wait = FALSE</code> it is <code>0</code> (the
conventional success value).
</p>
<p>If the command times out, a warning is issued and the exit status is
<code>124</code>.
</p>


<h3>Note</h3>

<p><code>system2</code> is a more portable and flexible interface than
<code><a href="#topic+system">system</a></code>.  It allows redirection of output without needing
to invoke a shell on Windows, a portable way to set environment
variables for the execution of <code>command</code>, and finer control over
the redirection of <code>stdout</code> and <code>stderr</code>.  Conversely,
<code>system</code> (and <code>shell</code> on Windows) allows the invocation of
arbitrary command lines.
</p>
<p>There is no guarantee that if <code>stdout</code> and <code>stderr</code> are both
<code>TRUE</code> or the same file that the two streams will be interleaved
in order.  This depends on both the buffering used by the command and
the OS.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+system">system</a></code>.
</p>

<hr>
<h2 id='t'>Matrix Transpose</h2><span id='topic+t'></span><span id='topic+t.default'></span><span id='topic+t.data.frame'></span>

<h3>Description</h3>

<p>Given a matrix or <code><a href="#topic+data.frame">data.frame</a></code> <code>x</code>,
<code>t</code> returns the transpose of <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t_+3A_x">x</code></td>
<td>
<p>a matrix or data frame, typically.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function for which methods can be written.  The
description here applies to the default and <code>"data.frame"</code> methods.
</p>
<p>A data frame is first coerced to a matrix: see <code><a href="#topic+as.matrix">as.matrix</a></code>.
When <code>x</code> is a vector, it is treated as a column, i.e., the
result is a 1-row matrix.
</p>


<h3>Value</h3>

<p>A matrix, with <code>dim</code> and <code>dimnames</code> constructed
appropriately from those of <code>x</code>, and other attributes except
names copied across.
</p>


<h3>Note</h3>

<p>The <em>conjugate</em> transpose of a complex matrix <code class="reqn">A</code>, denoted
<code class="reqn">A^H</code> or <code class="reqn">A^*</code>, is computed as <code><a href="#topic+Conj">Conj</a>(t(A))</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aperm">aperm</a></code> for permuting the dimensions of arrays.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- matrix(1:30, 5, 6)
ta &lt;- t(a) ##-- i.e.,  a[i, j] == ta[j, i] for all i,j :
for(j in seq(ncol(a)))
  if(! all(a[, j] == ta[j, ])) stop("wrong transpose")
</code></pre>

<hr>
<h2 id='table'>Cross Tabulation and Table Creation</h2><span id='topic+table'></span><span id='topic+summary.table'></span><span id='topic+print.summary.table'></span><span id='topic+as.data.frame.table'></span><span id='topic+as.table'></span><span id='topic+as.table.default'></span><span id='topic+is.table'></span><span id='topic++5B.table'></span>

<h3>Description</h3>

<p><code>table</code> uses cross-classifying factors to build a contingency
table of the counts at each combination of factor levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table(...,
      exclude = if (useNA == "no") c(NA, NaN),
      useNA = c("no", "ifany", "always"),
      dnn = list.names(...), deparse.level = 1)

as.table(x, ...)
is.table(x)

## S3 method for class 'table'
as.data.frame(x, row.names = NULL, ...,
              responseName = "Freq", stringsAsFactors = TRUE,
              sep = "", base = list(LETTERS))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table_+3A_...">...</code></td>
<td>
<p>one or more objects which can be interpreted as factors
(including numbers or character strings), or a <code><a href="#topic+list">list</a></code> (such
as a data frame) whose
components can be so interpreted.  (For <code>as.table</code>, arguments
passed to specific methods; for <code>as.data.frame</code>, unused.)</p>
</td></tr>
<tr><td><code id="table_+3A_exclude">exclude</code></td>
<td>
<p>levels to remove for all factors in <code>...</code>.  If
it does not contain <code><a href="#topic+NA">NA</a></code> and <code>useNA</code> is not
specified, it implies <code>useNA = "ifany"</code>.  See
&lsquo;Details&rsquo; for its interpretation for non-factor arguments.</p>
</td></tr>
<tr><td><code id="table_+3A_usena">useNA</code></td>
<td>
<p>whether to include <code>NA</code> values in the table.
See &lsquo;Details&rsquo;.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="table_+3A_dnn">dnn</code></td>
<td>
<p>the names to be given to the dimensions in the result (the
<em>dimnames names</em>).</p>
</td></tr>
<tr><td><code id="table_+3A_deparse.level">deparse.level</code></td>
<td>
<p>controls how the default <code>dnn</code> is
constructed.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="table_+3A_x">x</code></td>
<td>
<p>an arbitrary <span class="rlang"><b>R</b></span> object, or an object inheriting from class
<code>"table"</code> for the <code>as.data.frame</code> method. Note that
<code>as.data.frame.table(x, *)</code> may be called explicitly for
non-table <code>x</code> for &ldquo;reshaping&rdquo; <code><a href="#topic+array">array</a></code>s.</p>
</td></tr>
<tr><td><code id="table_+3A_row.names">row.names</code></td>
<td>
<p>a character vector giving the row names for the data
frame.</p>
</td></tr>
<tr><td><code id="table_+3A_responsename">responseName</code></td>
<td>
<p>the name to be used for the column of table
entries, usually counts.</p>
</td></tr>
<tr><td><code id="table_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>logical: should the classifying factors be
returned as factors (the default) or character vectors?</p>
</td></tr>
<tr><td><code id="table_+3A_sep">sep</code>, <code id="table_+3A_base">base</code></td>
<td>
<p>passed to <code><a href="#topic+provideDimnames">provideDimnames</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the argument <code>dnn</code> is not supplied, the internal function
<code>list.names</code> is called to compute the &lsquo;dimname names&rsquo; as
follows:
If <code>...</code> is one <code>list</code> with its own <code><a href="#topic+names">names</a>()</code>,
these <code>names</code> are used.  Otherwise, if the
arguments in <code>...</code> are named, those names are used.  For the
remaining arguments, <code>deparse.level = 0</code> gives an empty name,
<code>deparse.level = 1</code> uses the supplied argument if it is a symbol,
and <code>deparse.level = 2</code> will deparse the argument.
</p>
<p>Only when <code>exclude</code> is specified (i.e., not by default) and
non-empty, will <code>table</code> potentially drop levels of factor
arguments.
</p>
<p><code>useNA</code> controls if the table includes counts of <code>NA</code>
values: the allowed values correspond to never (<code>"no"</code>), only if the count is
positive (<code>"ifany"</code>) and even for zero counts (<code>"always"</code>).
Note the somewhat &ldquo;pathological&rdquo; case of two different kinds of
<code>NA</code>s which are treated differently, depending on both
<code>useNA</code> and <code>exclude</code>, see <code>d.patho</code> in the
&lsquo;Examples:&rsquo; below.
</p>
<p>Both <code>exclude</code> and <code>useNA</code> operate on an &ldquo;all or none&rdquo;
basis.  If you want to control the dimensions of a multiway table
separately, modify each argument using <code><a href="#topic+factor">factor</a></code> or
<code><a href="#topic+addNA">addNA</a></code>.
</p>
<p>Non-factor arguments <code>a</code> are coerced via <code>factor(a,
    exclude=exclude)</code>.  Since <span class="rlang"><b>R</b></span> 3.4.0, care is taken <em>not</em> to
count the excluded values (where they were included in the <code>NA</code>
count, previously).
</p>
<p>The <code>summary</code> method for class <code>"table"</code> (used for objects
created by <code>table</code> or <code><a href="stats.html#topic+xtabs">xtabs</a></code>) which gives basic
information and performs a chi-squared test for independence of
factors (note that the function <code><a href="stats.html#topic+chisq.test">chisq.test</a></code> currently
only handles 2-d tables).
</p>


<h3>Value</h3>

<p><code>table()</code> returns a <em>contingency table</em>, an object of
class <code>"table"</code>, an array of integer values.
Note that unlike S the result is always an <code><a href="#topic+array">array</a></code>, a 1D
array if one factor is given.
</p>
<p><code>as.table</code> and <code>is.table</code> coerce to and test for contingency
table, respectively.
</p>
<p>The <code>as.data.frame</code> method for objects inheriting from class
<code>"table"</code> can be used to convert the array-based representation
of a contingency table to a data frame containing the classifying
factors and the corresponding entries (the latter as component
named by <code>responseName</code>).  This is the inverse of <code><a href="stats.html#topic+xtabs">xtabs</a></code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tabulate">tabulate</a></code> is the underlying function and allows finer
control.
</p>
<p>Use <code><a href="stats.html#topic+ftable">ftable</a></code> for printing (and more) of
multidimensional tables.  <code><a href="#topic+margin.table">margin.table</a></code>,
<code><a href="#topic+prop.table">prop.table</a></code>, <code><a href="stats.html#topic+addmargins">addmargins</a></code>.
</p>
<p><code><a href="#topic+addNA">addNA</a></code> for constructing factors with <code><a href="#topic+NA">NA</a></code> as
a level.
</p>
<p><code><a href="stats.html#topic+xtabs">xtabs</a></code> for cross tabulation of data frames with a
formula interface.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for rpois and xtabs
## Simple frequency distribution
table(rpois(100, 5))
## Check the design:
with(warpbreaks, table(wool, tension))
table(state.division, state.region)

# simple two-way contingency table
with(airquality, table(cut(Temp, quantile(Temp)), Month))

a &lt;- letters[1:3]
table(a, sample(a))                    # dnn is c("a", "")
table(a, sample(a), dnn = NULL)        # dimnames() have no names
table(a, sample(a), deparse.level = 0) # dnn is c("", "")
table(a, sample(a), deparse.level = 2) # dnn is c("a", "sample(a)")

## xtabs() &lt;-&gt; as.data.frame.table() :
UCBAdmissions ## already a contingency table
DF &lt;- as.data.frame(UCBAdmissions)
class(tab &lt;- xtabs(Freq ~ ., DF)) # xtabs &amp; table
## tab *is* "the same" as the original table:
all(tab == UCBAdmissions)
all.equal(dimnames(tab), dimnames(UCBAdmissions))

a &lt;- rep(c(NA, 1/0:3), 10)
table(a)                 # does not report NA's
table(a, exclude = NULL) # reports NA's
b &lt;- factor(rep(c("A","B","C"), 10))
table(b)
table(b, exclude = "B")
d &lt;- factor(rep(c("A","B","C"), 10), levels = c("A","B","C","D","E"))
table(d, exclude = "B")
print(table(b, d), zero.print = ".")

## NA counting:
is.na(d) &lt;- 3:4
d. &lt;- addNA(d)
d.[1:7]
table(d.) # ", exclude = NULL" is not needed
## i.e., if you want to count the NA's of 'd', use
table(d, useNA = "ifany")

## "pathological" case:
d.patho &lt;- addNA(c(1,NA,1:2,1:3))[-7]; is.na(d.patho) &lt;- 3:4
d.patho
## just 3 consecutive NA's ? --- well, have *two* kinds of NAs here :
as.integer(d.patho) # 1 4 NA NA 1 2
##
## In R &gt;= 3.4.0, table() allows to differentiate:
table(d.patho)                   # counts the "unusual" NA
table(d.patho, useNA = "ifany")  # counts all three
table(d.patho, exclude = NULL)   #  (ditto)
table(d.patho, exclude = NA)     # counts none

## Two-way tables with NA counts. The 3rd variant is absurd, but shows
## something that cannot be done using exclude or useNA.
with(airquality,
   table(OzHi = Ozone &gt; 80, Month, useNA = "ifany"))
with(airquality,
   table(OzHi = Ozone &gt; 80, Month, useNA = "always"))
with(airquality,
   table(OzHi = Ozone &gt; 80, addNA(Month)))
</code></pre>

<hr>
<h2 id='tabulate'>Tabulation for Vectors</h2><span id='topic+tabulate'></span>

<h3>Description</h3>

<p><code>tabulate</code> takes the integer-valued vector <code>bin</code> and counts
the number of times each integer occurs in it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tabulate(bin, nbins = max(1, bin, na.rm = TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tabulate_+3A_bin">bin</code></td>
<td>
<p>a numeric vector (of positive integers), or a factor.
<a href="#topic+Long+20vectors">Long vectors</a> are supported.</p>
</td></tr>
<tr><td><code id="tabulate_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tabulate</code> is the workhorse for the <code><a href="#topic+table">table</a></code> function.
</p>
<p>If <code>bin</code> is a factor, its internal integer representation
is tabulated.
</p>
<p>If the elements of <code>bin</code> are numeric but not integers,
they are truncated by <code><a href="#topic+as.integer">as.integer</a></code>.
</p>


<h3>Value</h3>

<p>An integer valued <code><a href="#topic+integer">integer</a></code> or <code><a href="#topic+double">double</a></code> vector
(without names).  There is a bin for each of the values <code>1,
  ..., nbins</code>; values outside that range and <code>NA</code>s are (silently)
ignored.
</p>
<p>On 64-bit platforms <code>bin</code> can have <code class="reqn">2^{31}</code> or more
elements (i.e., <code>length(bin) &gt; .Machine$integer.max</code>), and hence
a count could exceed the maximum integer.  For this reason, the return
value is of type double for such long <code>bin</code> vectors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+table">table</a></code>, <code><a href="#topic+factor">factor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tabulate(c(2,3,5))
tabulate(c(2,3,3,5), nbins = 10)
tabulate(c(-2,0,2,3,3,5))  # -2 and 0 are ignored
tabulate(c(-2,0,2,3,3,5), nbins = 3)
tabulate(factor(letters[1:10]))
</code></pre>

<hr>
<h2 id='Tailcall'><code>Tailcall</code> and <code>Exec</code></h2><span id='topic+Tailcall'></span><span id='topic+Exec'></span>

<h3>Description</h3>

<p><code>Tailcall</code> and <code>Exec</code> allow writing more
stack-space-efficient recursive functions in <span class="rlang"><b>R</b></span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tailcall(FUN, ...)
Exec(expr, envir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tailcall_+3A_fun">FUN</code></td>
<td>
<p>a function or a non-empty character string naming the
function to be called.</p>
</td></tr>
<tr><td><code id="Tailcall_+3A_...">...</code></td>
<td>
<p>all the arguments to be passed.</p>
</td></tr>
<tr><td><code id="Tailcall_+3A_expr">expr</code></td>
<td>
<p>a call expression.</p>
</td></tr>
<tr><td><code id="Tailcall_+3A_envir">envir</code></td>
<td>
<p>environment for evaluating <code>expr</code>; default is the
environment from which <code>Exec</code> is called.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Tailcall</code> evaluates a call to <code>FUN</code> with arguments ... in
the current environment, and <code>Exec</code> evaluates the call
<code>expr</code> in environment <code>envir</code>. If a <code>Tailcall</code> or
<code>Exec</code> expression appears in tail position in an <span class="rlang"><b>R</b></span> function, and
if there are no <code>on.exit</code> expressions set, then the evaluation
context of the new calls replaces the currently executing call context
with a new one. If the requirements for context re-use are not met,
then evaluation proceeds in the standard way adding another context to
the stack.
</p>
<p>Using <code>Tailcall</code> it is possible to define tail-recursive
functions that do not grow the evaluation stack.  <code>Exec</code> can be
used to simplify the call stack for functions that create and then
evaluate an expression.
</p>
<p>Because of lazy evaluation of arguments in <span class="rlang"><b>R</b></span> it may be necessary to
force evaluation of some arguments to avoid accumulating deferred
evaluations.
</p>
<p>This <em>tail call optimization</em> has the advantage of not growing
the call stack and permitting arbitrarily deep tail recursions. It
does also mean that stack traces produced by <code><a href="#topic+traceback">traceback</a></code>
or <code><a href="#topic+sys.calls">sys.calls</a></code> will only show the call specified by
<code>Tailcall</code> or <code>Exec</code>, not the previous call whose stack
entry has been replaced.
</p>


<h3>Note</h3>

<p><code>Tailcall</code> and <code>Exec</code> are experimental and may be
changed or dropped in future released versions of <span class="rlang"><b>R</b></span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Recall">Recall</a></code> and <code><a href="#topic+force">force</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tail-recursive log10-factorial
lfact &lt;- function(n) {
    lfact_iter &lt;- function(val, n) {
        if (n &lt;= 0)
            val
        else {
            val &lt;- val + log10(n) # forces val
            Tailcall(lfact_iter, val, n - 1)
        }
    }
    lfact_iter(0, n)
}
10 ^ lfact(3)
lfact(100000)

## simplified variant of do.call using Exec:
docall &lt;- function (what, args, quote = FALSE) {
    if (!is.list(args)) 
        stop("second argument must be a list")
    if (quote) 
        args &lt;- lapply(args, enquote)
    Exec(as.call(c(list(substitute(what)), args)), parent.frame())
}
## the call stack does not contain the call to docall:
docall(function() sys.calls(), list()) |&gt; 
    Find(function(x) identical(x[[1]], quote(docall)), x = _)
## contrast to do.call:
do.call(function(x) sys.calls(), list()) |&gt; 
    Find(function(x) identical(x[[1]], quote(do.call)), x = _)
</code></pre>

<hr>
<h2 id='tapply'>Apply a Function Over a Ragged Array</h2><span id='topic+tapply'></span>

<h3>Description</h3>

<p>Apply a function to each cell of a ragged array, that is to each
(non-empty) group of values or data rows given by a unique
combination of the levels of certain factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tapply(X, INDEX, FUN = NULL, ..., default = NA, simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tapply_+3A_x">X</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object for which a <code><a href="#topic+split">split</a></code> method
exists.  Typically vector-like, allowing subsetting with
<code><a href="#topic++5B">[</a></code>, or a data frame. </p>
</td></tr>
<tr><td><code id="tapply_+3A_index">INDEX</code></td>
<td>
<p>a <code><a href="#topic+list">list</a></code> of one or more <code><a href="#topic+factor">factor</a></code>s,
each of same length as <code>X</code>.  The elements are coerced to
factors by <code><a href="#topic+as.factor">as.factor</a></code>. Can also be a formula, which is
useful if <code>X</code> is a data frame; see the <code>f</code> argument in
<code><a href="#topic+split">split</a></code> for interpretation. </p>
</td></tr>
<tr><td><code id="tapply_+3A_fun">FUN</code></td>
<td>
<p>a function (or name of a function) to be applied, or <code>NULL</code>.
In the case of functions like <code>+</code>, <code>%*%</code>, etc.,
the function name must be backquoted or quoted.  If <code>FUN</code> is
<code>NULL</code>, <code>tapply</code> returns a vector which can be used to subscript
the multi-way array <code>tapply</code> normally produces.</p>
</td></tr>
<tr><td><code id="tapply_+3A_...">...</code></td>
<td>
<p>optional arguments to <code>FUN</code>: the Note section.</p>
</td></tr>
<tr><td><code id="tapply_+3A_default">default</code></td>
<td>
<p>(only in the case of simplification to an array) the
value with which the array is initialized as
<code><a href="#topic+array">array</a>(default, dim = ..)</code>.  Before <span class="rlang"><b>R</b></span> 3.4.0, this
was hard coded to <code><a href="#topic+array">array</a>()</code>'s default <code>NA</code>.  If it
is <code>NA</code> (the default), the missing value of the answer type,
e.g. <code><a href="#topic+NA_real_">NA_real_</a></code>, is chosen (<code><a href="#topic+as.raw">as.raw</a>(0)</code> for
<code>"raw"</code>).  In a numerical case, it may be set, e.g., to
<code>FUN(integer(0))</code>, e.g., in the case of <code>FUN = sum</code> to
<code>0</code> or <code>0L</code>.</p>
</td></tr>
<tr><td><code id="tapply_+3A_simplify">simplify</code></td>
<td>
<p>logical; if <code>FALSE</code>, <code>tapply</code> always returns
an array of mode <code>"list"</code>; in other words, a <code><a href="#topic+list">list</a></code>
with a <code><a href="#topic+dim">dim</a></code> attribute.  If <code>TRUE</code> (the default), then if
<code>FUN</code> always returns a scalar, <code>tapply</code> returns an array
with the mode of the scalar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>FUN</code> is not <code>NULL</code>, it is passed to
<code><a href="#topic+match.fun">match.fun</a></code>, and hence it can be a function or a symbol or
character string naming a function.
</p>


<h3>Value</h3>

<p>When <code>FUN</code> is present, <code>tapply</code> calls <code>FUN</code> for each
cell that has any data in it.  If <code>FUN</code> returns a single atomic
value for each such cell (e.g., functions <code>mean</code> or <code>var</code>)
and when <code>simplify</code> is <code>TRUE</code>, <code>tapply</code> returns a
multi-way <a href="#topic+array">array</a> containing the values, and <code>NA</code> for the
empty cells.  The array has the same number of dimensions as
<code>INDEX</code> has components; the number of levels in a dimension is
the number of levels (<code>nlevels()</code>) in the corresponding component
of <code>INDEX</code>.  Note that if the return value has a class (e.g., an
object of class <code>"<a href="#topic+Date">Date</a>"</code>) the class is discarded.
</p>
<p><code>simplify = TRUE</code> always returns an array, possibly 1-dimensional.
</p>
<p>If <code>FUN</code> does not return a single atomic value, <code>tapply</code>
returns an array of mode <code><a href="#topic+list">list</a></code> whose components are the
values of the individual calls to <code>FUN</code>, i.e., the result is a
list with a <code><a href="#topic+dim">dim</a></code> attribute.
</p>
<p>When there is an array answer, its <code><a href="#topic+dimnames">dimnames</a></code> are named by
the names of <code>INDEX</code> and are based on the levels of the grouping
factors (possibly after coercion).
</p>
<p>For a list result, the elements corresponding to empty cells are
<code>NULL</code>.
</p>
<p>The <code><a href="#topic+array2DF">array2DF</a></code> function can be used to convert the array
returned by <code>tapply</code> into a data frame, which may be more
convenient for further analysis.
</p>


<h3>Note</h3>

<p>Optional arguments to <code>FUN</code> supplied by the <code>...</code> argument
are not divided into cells.  It is therefore inappropriate for
<code>FUN</code> to expect additional arguments with the same length as
<code>X</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>the convenience functions <code><a href="#topic+by">by</a></code> and
<code><a href="stats.html#topic+aggregate">aggregate</a></code> (using <code>tapply</code>);
<code><a href="#topic+apply">apply</a></code>,
<code><a href="#topic+lapply">lapply</a></code> with its versions
<code><a href="#topic+sapply">sapply</a></code> and <code><a href="#topic+mapply">mapply</a></code>.
</p>
<p><code><a href="#topic+array2DF">array2DF</a></code> to convert the result into a data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
groups &lt;- as.factor(rbinom(32, n = 5, prob = 0.4))
tapply(groups, groups, length) #- is almost the same as
table(groups)

## contingency table from data.frame : array with named dimnames
tapply(warpbreaks$breaks, warpbreaks[,-1], sum)
tapply(warpbreaks$breaks, warpbreaks[, 3, drop = FALSE], sum)

n &lt;- 17; fac &lt;- factor(rep_len(1:3, n), levels = 1:5)
table(fac)
tapply(1:n, fac, sum)
tapply(1:n, fac, sum, default = 0) # maybe more desirable
tapply(1:n, fac, sum, simplify = FALSE)
tapply(1:n, fac, range)
tapply(1:n, fac, quantile)
tapply(1:n, fac, length) ## NA's
tapply(1:n, fac, length, default = 0) # == table(fac)

## example of ... argument: find quarterly means
tapply(presidents, cycle(presidents), mean, na.rm = TRUE)

ind &lt;- list(c(1, 2, 2), c("A", "A", "B"))
table(ind)
tapply(1:3, ind) #-&gt; the split vector
tapply(1:3, ind, sum)

## Some assertions (not held by all patch propsals):
nq &lt;- names(quantile(1:5))
stopifnot(
  identical(tapply(1:3, ind), c(1L, 2L, 4L)),
  identical(tapply(1:3, ind, sum),
            matrix(c(1L, 2L, NA, 3L), 2, dimnames = list(c("1", "2"), c("A", "B")))),
  identical(tapply(1:n, fac, quantile)[-1],
            array(list(`2` = structure(c(2, 5.75, 9.5, 13.25, 17), names = nq),
                 `3` = structure(c(3, 6, 9, 12, 15), names = nq),
                 `4` = NULL, `5` = NULL), dim=4, dimnames=list(as.character(2:5)))))
</code></pre>

<hr>
<h2 id='taskCallback'>Add or Remove a Top-Level Task Callback</h2><span id='topic+addTaskCallback'></span><span id='topic+removeTaskCallback'></span>

<h3>Description</h3>

<p><code>addTaskCallback</code> registers an R function
that is to be called each time a top-level task
is completed.
</p>
<p><code>removeTaskCallback</code> un-registers a function
that was registered earlier via <code>addTaskCallback</code>.
</p>
<p>These provide low-level access to the internal/native
mechanism for managing task-completion actions.
One can use <code><a href="#topic+taskCallbackManager">taskCallbackManager</a></code>
at the <span class="rlang"><b>R</b></span>-language level to manage <span class="rlang"><b>R</b></span> functions
that are called at the completion of each task.
This is easier and more direct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addTaskCallback(f, data = NULL, name = character())
removeTaskCallback(id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taskCallback_+3A_f">f</code></td>
<td>
<p>the function that is to be invoked each time a top-level task
is successfully completed.  This is called with 5 or 4 arguments
depending on whether <code>data</code> is specified or not, respectively.
The return value should be a logical value indicating whether to
keep the callback in the list of active callbacks or discard it.</p>
</td></tr>
<tr><td><code id="taskCallback_+3A_data">data</code></td>
<td>
<p>if specified, this is the 5-th argument in the call to the
callback function <code>f</code>.</p>
</td></tr>
<tr><td><code id="taskCallback_+3A_id">id</code></td>
<td>
<p>a string or an integer identifying the element in the
internal callback list to be removed.
Integer indices are 1-based, i.e the first element is 1.
The names of currently registered handlers is available
using <code><a href="#topic+getTaskCallbackNames">getTaskCallbackNames</a></code>
and is also returned in a call to <code><a href="#topic+addTaskCallback">addTaskCallback</a></code>.
</p>
</td></tr>
<tr><td><code id="taskCallback_+3A_name">name</code></td>
<td>
<p>character: names to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Top-level tasks are individual expressions
rather than entire lines of input.  Thus an input
line of the form <code>expression1 ; expression2</code>
will give rise to 2 top-level tasks.
</p>
<p>A top-level task callback is called with the expression for the
top-level task, the result of the top-level task, a logical value
indicating whether it was successfully completed or not (always TRUE
at present), and a logical value indicating whether the result was
printed or not.  If the <code>data</code> argument was specified in the call
to <code>addTaskCallback</code>, that value is given as the fifth argument.
</p>
<p>The callback function should return a logical value.
If the value is FALSE, the callback is removed from the task
list and will not be called again by this mechanism.
If the function returns TRUE, it is kept in the list and
will be called on the completion of the next top-level task.
</p>


<h3>Value</h3>

<p><code>addTaskCallback</code> returns
an integer value giving  the position in the list
of task callbacks that this new callback occupies.
This is only the current position of the callback.
It can be used to remove the entry as long as
no other values are removed from earlier positions
in the list first.
</p>
<p><code>removeTaskCallback</code> returns a logical value
indicating whether the specified element was removed.
This can fail (i.e., return <code>FALSE</code>)
if an incorrect name or index is given that does not
correspond to the name or position of an element in the list.
</p>


<h3>Note</h3>

<p>There is also C-level access to top-level task callbacks
to allow C routines rather than R functions be used.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getTaskCallbackNames">getTaskCallbackNames</a></code>
<code><a href="#topic+taskCallbackManager">taskCallbackManager</a></code>
<a href="https://developer.r-project.org/TaskHandlers.pdf">https://developer.r-project.org/TaskHandlers.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>times &lt;- function(total = 3, str = "Task a") {
  ctr &lt;- 0
  function(expr, value, ok, visible) {
    ctr &lt;&lt;- ctr + 1
    cat(str, ctr, "\n")
    keep.me &lt;- (ctr &lt; total)
    if (!keep.me)
      cat("handler removing itself\n")

    # return
    keep.me
  }
}

# add the callback that will work for
# 4 top-level tasks and then remove itself.
n &lt;- addTaskCallback(times(4))

# now remove it, assuming it is still first in the list.
removeTaskCallback(n)

## See how the handler is called every time till "self destruction":

addTaskCallback(times(4)) # counts as once already

sum(1:10) ; mean(1:3) # two more
sinpi(1)              # 4th - and "done"
cospi(1)
tanpi(1)
</code></pre>

<hr>
<h2 id='taskCallbackManager'>Create an R-level Task Callback Manager</h2><span id='topic+taskCallbackManager'></span>

<h3>Description</h3>

<p>This provides an entirely <span class="rlang"><b>R</b></span>-language mechanism
for managing callbacks or actions  that are invoked at
the conclusion of each top-level task.  Essentially,
we register a single <span class="rlang"><b>R</b></span> function from this manager
with the underlying, native
task-callback mechanism and this function handles invoking the other
R callbacks under the control of the manager.
The manager consists of a collection of functions that access shared
variables to manage the list of user-level callbacks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taskCallbackManager(handlers = list(), registered = FALSE,
                    verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taskCallbackManager_+3A_handlers">handlers</code></td>
<td>
<p>this can be a list of callbacks in which each element
is a list with  an element  named <code>"f"</code>
which is a callback function, and an optional
element named <code>"data"</code> which is the 5-th argument to be
supplied  to the callback when it is invoked.
Typically this argument is not specified, and one uses <code>add</code> to
register callbacks after the manager is created.</p>
</td></tr>
<tr><td><code id="taskCallbackManager_+3A_registered">registered</code></td>
<td>
<p>a logical value indicating whether
the <code>evaluate</code> function has already been registered
with the internal task callback mechanism.
This is usually <code>FALSE</code> and
the first time a callback is added
via the <code>add</code> function, the
<code>evaluate</code> function is automatically registered.
One can control when the function is registered
by specifying <code>TRUE</code> for this argument
and calling <code><a href="#topic+addTaskCallback">addTaskCallback</a></code> manually.
</p>
</td></tr>
<tr><td><code id="taskCallbackManager_+3A_verbose">verbose</code></td>
<td>
<p>a logical value, which if <code>TRUE</code>,
causes information to be printed to the console
about certain activities this dispatch manager performs.
This is useful for debugging callbacks and the handler
itself.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+list">list</a></code> containing 6 functions:
</p>
<table>
<tr><td><code>add()</code></td>
<td>
<p>register a callback with this manager, giving the
function, an optional 5-th argument, an optional name
by which the callback is stored in the list,
and a <code>register</code> argument which controls whether
the <code>evaluate</code> function is registered with the internal
C-level dispatch mechanism if necessary.</p>
</td></tr>
<tr><td><code>remove()</code></td>
<td>
<p>remove an element from the manager's collection
of callbacks, either by name or position/index.</p>
</td></tr>
<tr><td><code>evaluate()</code></td>
<td>
<p>the &lsquo;real&rsquo; callback function that is registered
with the C-level dispatch mechanism and which invokes each of the
R-level callbacks within this manager's control.</p>
</td></tr>
<tr><td><code>suspend()</code></td>
<td>
<p>a function to set the suspend state
of the manager.  If it is suspended, none of the callbacks will be
invoked when a task is completed.  One sets the state by specifying
a logical value for the <code>status</code> argument.
</p>
</td></tr>
<tr><td><code>register()</code></td>
<td>
<p>a function to register the <code>evaluate</code>
function with the internal C-level dispatch mechanism.  This is
done automatically by the <code>add</code> function, but can be called
manually.</p>
</td></tr>
<tr><td><code>callbacks()</code></td>
<td>
<p>returns the list of callbacks being maintained
by this manager.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Duncan Temple Lang (2001)
<em>Top-level Task Callbacks in R</em>, 
<a href="https://developer.r-project.org/TaskHandlers.pdf">https://developer.r-project.org/TaskHandlers.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addTaskCallback">addTaskCallback</a></code>,
<code><a href="#topic+removeTaskCallback">removeTaskCallback</a></code>,
<code><a href="#topic+getTaskCallbackNames">getTaskCallbackNames</a></code> and the reference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create the manager
h &lt;- taskCallbackManager()

# add a callback
h$add(function(expr, value, ok, visible) {
                       cat("In handler\n")
                       return(TRUE)
                     }, name = "simpleHandler")

# look at the internal callbacks.
getTaskCallbackNames()

# look at the R-level callbacks
names(h$callbacks())

removeTaskCallback("R-taskCallbackManager")
</code></pre>

<hr>
<h2 id='taskCallbackNames'>Query the Names of the Current Internal Top-Level Task Callbacks</h2><span id='topic+getTaskCallbackNames'></span>

<h3>Description</h3>

<p>This provides a way to get the names (or identifiers)
for the currently registered task callbacks
that are invoked at the conclusion of each top-level task.
These identifiers can be used to remove a callback.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTaskCallbackNames()
</code></pre>


<h3>Value</h3>

<p>A character vector giving the name for each of the
registered callbacks which are invoked when
a top-level task is completed successfully.
Each name is the one used when registering
the callbacks and returned as the in the
call to <code><a href="#topic+addTaskCallback">addTaskCallback</a></code>.
</p>


<h3>Note</h3>

<p>One can use <code><a href="#topic+taskCallbackManager">taskCallbackManager</a></code>
to manage user-level task callbacks,
i.e., S-language functions, entirely within
the S language and access the names
more directly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addTaskCallback">addTaskCallback</a></code>,
<code><a href="#topic+removeTaskCallback">removeTaskCallback</a></code>,
<code><a href="#topic+taskCallbackManager">taskCallbackManager</a></code>\
<a href="https://developer.r-project.org/TaskHandlers.pdf">https://developer.r-project.org/TaskHandlers.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> n &lt;- addTaskCallback(function(expr, value, ok, visible) {
                        cat("In handler\n")
                        return(TRUE)
                      }, name = "simpleHandler")

 getTaskCallbackNames()

   # now remove it by name
 removeTaskCallback("simpleHandler")


 h &lt;- taskCallbackManager()
 h$add(function(expr, value, ok, visible) {
                        cat("In handler\n")
                        return(TRUE)
                      }, name = "simpleHandler")
 getTaskCallbackNames()
 removeTaskCallback("R-taskCallbackManager")
</code></pre>

<hr>
<h2 id='tempfile'>Create Names for Temporary Files</h2><span id='topic+tempfile'></span><span id='topic+tempdir'></span>

<h3>Description</h3>

<p><code>tempfile</code> returns a vector of character strings which can be used as
names for temporary files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
tempfile(pattern = "file", tmpdir = tempdir(), fileext = "")
tempdir(check = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tempfile_+3A_pattern">pattern</code></td>
<td>
<p>a non-empty character vector giving the initial part
of the name.</p>
</td></tr>
<tr><td><code id="tempfile_+3A_tmpdir">tmpdir</code></td>
<td>
<p>a non-empty character vector giving the directory name.</p>
</td></tr>
<tr><td><code id="tempfile_+3A_fileext">fileext</code></td>
<td>
<p>a non-empty character vector giving the file extension.</p>
</td></tr>
<tr><td><code id="tempfile_+3A_check">check</code></td>
<td>
<p><code><a href="#topic+logical">logical</a></code> indicating if <code>tmpdir()</code>
should be checked and recreated if no longer valid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length of the result is the maximum of the lengths of the three
arguments; values of shorter arguments are recycled.
</p>
<p>The names are very likely to be unique among calls to <code>tempfile</code>
in an <span class="rlang"><b>R</b></span> session and across simultaneous <span class="rlang"><b>R</b></span> sessions (unless
<code>tmpdir</code> is specified).  The filenames are guaranteed not to be
currently in use.
</p>
<p>The file name is made by concatenating the path given by
<code>tmpdir</code>, the <code>pattern</code> string, a random string in hex and
a suffix of <code>fileext</code>.
</p>
<p>By default, <code>tmpdir</code> will be the directory given by
<code>tempdir()</code>.  This will be a subdirectory of the per-session
temporary directory found by the following rule when the <span class="rlang"><b>R</b></span> session is
started.  The environment variables <span class="env">TMPDIR</span>, <span class="env">TMP</span> and
<span class="env">TEMP</span> are checked in turn and the first found which points to a
writable directory is used:
if none succeeds &lsquo;<span class="file">/tmp</span>&rsquo; is used.  The path must not contain spaces.
Note that setting any of these environment variables in the <span class="rlang"><b>R</b></span> session
has no effect on <code>tempdir()</code>: the per-session temporary directory
is created before the interpreter is started.
</p>


<h3>Value</h3>

<p>For <code>tempfile</code> a character vector giving the names of possible
(temporary) files.  Note that no files are generated by <code>tempfile</code>.
</p>
<p>For <code>tempdir</code>, the path of the per-session temporary directory.
</p>
<p>On Windows, both will use a backslash as the path separator.
</p>
<p>On a Unix-alike, the value will be an absolute path (unless
<code>tmpdir</code> is set to a relative path), but it need not be canonical
(see <code><a href="#topic+normalizePath">normalizePath</a></code>) and on macOS it often is not.  
</p>


<h3>Note on parallel use</h3>

<p><span class="rlang"><b>R</b></span> processes forked by functions such as <code><a href="parallel.html#topic+mclapply">mclapply</a></code> and
<code><a href="parallel.html#topic+makeForkCluster">makeForkCluster</a></code> in package <span class="pkg">parallel</span> share a
per-session temporary directory.  Further, the &lsquo;guaranteed not
to be currently in use&rsquo; applies only at the time of asking, and two
children could ask simultaneously.  This is circumvented by ensuring
that <code>tempfile</code> calls in different children try different names.
</p>


<h3>Source</h3>

<p>The final component of <code>tempdir()</code> is created by the POSIX system
call <code>mkdtemp</code>, or if this is not available (e.g. on
Windows) a version derived from the source code of GNU <code>glibc</code>.
</p>
<p>It will be of the form &lsquo;<span class="file">RtmpXXXXXX</span>&rsquo; where the last 6 characters
are replaced in a platform-specific way.  POSIX only requires that the
replacements be ASCII, which allows <code>.</code> (so the value may appear
to have a file extension) and <a href="#topic+regexp">regexp</a> metacharacters such as
<code>+</code>.  Most commonly the replacements are from the <a href="#topic+regexp">regexp</a>
pattern <code>[A-Za-z0-9]</code>, but <code>.</code> <em>has</em> been seen.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unlink">unlink</a></code> for deleting files.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tempfile(c("ab", "a b c"))   # give file name with spaces in!

tempfile("plot", fileext = c(".ps", ".pdf"))

tempdir() # works on all platforms with a platform-dependent result


## Show how 'check' is working on some platforms:
if(exists("I'm brave") &amp;&amp; `I'm brave` &amp;&amp;
   identical(.Platform$OS.type, "unix") &amp;&amp; grepl("^/tmp/", tempdir())) {
  cat("Current tempdir(): ", tempdir(), "\n")
  cat("Removing it :", file.remove(tempdir()),
      "; dir.exists(tempdir()):", dir.exists(tempdir()), "\n")
  cat("and now  tempdir(check = TRUE) :", tempdir(check = TRUE),"\n")
}

</code></pre>

<hr>
<h2 id='textConnection'>Text Connections</h2><span id='topic+textConnection'></span><span id='topic+textConnectionValue'></span>

<h3>Description</h3>

<p>Input and output text connections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>textConnection(object, open = "r", local = FALSE,
               name = deparse1(substitute(object)),
               encoding = c("", "bytes", "UTF-8"))

textConnectionValue(con)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="textConnection_+3A_object">object</code></td>
<td>
<p>character.  A description of the <a href="#topic+connection">connection</a>.
For an input this is an <span class="rlang"><b>R</b></span> character vector object, and for an output
connection the name for the <span class="rlang"><b>R</b></span> character vector to receive the
output, or <code>NULL</code> (for none).
</p>
</td></tr>
<tr><td><code id="textConnection_+3A_open">open</code></td>
<td>
<p>character string.  Either <code>"r"</code> (or equivalently <code>""</code>)
for an input connection or <code>"w"</code> or <code>"a"</code> for an output
connection.</p>
</td></tr>
<tr><td><code id="textConnection_+3A_local">local</code></td>
<td>
<p>logical.  Used only for output connections.  If <code>TRUE</code>,
output is assigned to a variable in the calling environment.  Otherwise
the global environment is used.</p>
</td></tr>
<tr><td><code id="textConnection_+3A_name">name</code></td>
<td>
<p>a <code><a href="#topic+character">character</a></code> string specifying the connection name.</p>
</td></tr>
<tr><td><code id="textConnection_+3A_encoding">encoding</code></td>
<td>
<p>character string, partially matched.  Used only for input connections.  How
marked strings in <code>object</code> should be handled: converted to the
current locale, used byte-by-byte or translated to UTF-8.</p>
</td></tr>
<tr><td><code id="textConnection_+3A_con">con</code></td>
<td>
<p>an output text connection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An input text connection is opened and the character vector is copied
at time the connection object is created, and <code>close</code> destroys
the copy.  <code>object</code> should be the name of a character vector:
however, short expressions will be accepted provided they <a href="#topic+deparse">deparse</a> to
less than 60 bytes.
</p>
<p>An output text connection is opened and creates an <span class="rlang"><b>R</b></span> character vector
of the given name in the user's workspace or in the calling environment,
depending on the value of the <code>local</code> argument.  This object will at all
times hold the completed lines of output to the connection, and
<code><a href="#topic+isIncomplete">isIncomplete</a></code> will indicate if there is an incomplete
final line.  Closing the connection will output the final line,
complete or not.  (A line is complete once it has been terminated by
end-of-line, represented by <code>"\n"</code> in <span class="rlang"><b>R</b></span>.)   The output character
vector has locked bindings (see <code><a href="#topic+lockBinding">lockBinding</a></code>) until
<code>close</code> is called on the connection.  The character vector can
also be retrieved <em>via</em> <code>textConnectionValue</code>, which is the
only way to do so if <code>object = NULL</code>.  If the current locale is
detected as Latin-1 or UTF-8, non-ASCII elements of the character vector
will be marked accordingly (see <code>Encoding</code>).
</p>
<p>Opening a text connection with <code>mode = "a"</code> will attempt to
append to an existing character vector with the given name in the
user's workspace or the calling environment.  If none is found (even
if an object exists of the right name but the wrong type) a new
character vector will be created, with a warning.
</p>
<p>You cannot <code>seek</code> on a text connection, and <code>seek</code> will
always return zero as the position.
</p>
<p>Text connections have slightly unusual semantics: they are always
open, and throwing away an input text connection without closing it
(so it get garbage-collected) does not give a warning.
</p>


<h3>Value</h3>

<p>For <code>textConnection</code>, a connection object of class
<code>"textConnection"</code> which inherits from class <code>"connection"</code>.
</p>
<p>For <code>textConnectionValue</code>, a character vector.
</p>


<h3>Note</h3>

<p>As output text connections keep the character vector up to date
line-by-line, they are relatively expensive to use, and it is often
better to use an anonymous <code><a href="#topic+file">file</a>()</code> connection to collect
output.
</p>
<p>On (rare) platforms where <code>vsnprintf</code> does not return the needed
length of output there is a 100,000 character limit on the length of
line for output connections: longer lines will be truncated with a
warning.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language.</em> Springer.<br />
[S has input text connections only.]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+showConnections">showConnections</a></code>,
<code><a href="#topic+pushBack">pushBack</a></code>, <code><a href="utils.html#topic+capture.output">capture.output</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>zz &lt;- textConnection(LETTERS)
readLines(zz, 2)
scan(zz, "", 4)
pushBack(c("aa", "bb"), zz)
scan(zz, "", 4)
close(zz)

zz &lt;- textConnection("foo", "w")
writeLines(c("testit1", "testit2"), zz)
cat("testit3 ", file = zz)
isIncomplete(zz)
cat("testit4\n", file = zz)
isIncomplete(zz)
close(zz)
foo

# capture R output: use part of example from help(lm)
zz &lt;- textConnection("foo", "w")
ctl &lt;- c(4.17, 5.58, 5.18, 6.11, 4.5, 4.61, 5.17, 4.53, 5.33, 5.14)
trt &lt;- c(4.81, 4.17, 4.41, 3.59, 5.87, 3.83, 6.03, 4.89, 4.32, 4.69)
group &lt;- gl(2, 10, 20, labels = c("Ctl", "Trt"))
weight &lt;- c(ctl, trt)
sink(zz)
anova(lm.D9 &lt;- lm(weight ~ group))
cat("\nSummary of Residuals:\n\n")
summary(resid(lm.D9))
sink()
close(zz)
cat(foo, sep = "\n")

</code></pre>

<hr>
<h2 id='tilde'>Tilde Operator</h2><span id='topic+~'></span><span id='topic+tilde'></span>

<h3>Description</h3>

<p>Tilde is used to separate the left- and right-hand sides in a model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>y ~ model
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tilde_+3A_y">y</code>, <code id="tilde_+3A_model">model</code></td>
<td>
<p>symbolic expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The left-hand side is optional, and one-sided formulae are used in
some contexts.
</p>
<p>A formula has <a href="#topic+mode">mode</a> <code><a href="#topic+call">call</a></code>.  It can be subsetted by
<code>[[</code>: the components are <code>~</code>, the left-hand side (if
present) and the right-hand side <em>in that order</em>.  (Thus
one-sided formulae have two components.)
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical models.</em>
Chapter 2 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+formula">formula</a></code>
</p>

<hr>
<h2 id='timezones'>Time Zones</h2><span id='topic+Sys.timezone'></span><span id='topic+OlsonNames'></span><span id='topic+timezone'></span><span id='topic+timezones'></span><span id='topic+time+20zone'></span><span id='topic+time+20zones'></span><span id='topic+TZ'></span><span id='topic+TZDIR'></span><span id='topic+.sys.timezone'></span>

<h3>Description</h3>

<p>Information about time zones in <span class="rlang"><b>R</b></span>.  <code>Sys.timezone</code> returns
the name of the current time zone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sys.timezone(location = TRUE)

OlsonNames(tzdir = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timezones_+3A_location">location</code></td>
<td>
<p>logical.  Defunct, with a warning if <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="timezones_+3A_tzdir">tzdir</code></td>
<td>
<p>the time-zone database to be used: the default is to try
known locations until one is found.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time zones are a system-specific topic, but these days almost all <span class="rlang"><b>R</b></span>
platforms use similar underlying code, used by Linux, macOS, Solaris,
AIX and FreeBSD, and installed with <span class="rlang"><b>R</b></span> on Windows.  (Unfortunately
there are many system-specific errors in the implementations.)  It is
possible to use the <span class="rlang"><b>R</b></span> sources' version of the code on Unix-alikes as
well as on Windows: this is the default on macOS.
</p>
<p>It should be possible to set the current time zone via the environment
variable <span class="env">TZ</span>: see the section on &lsquo;Time zone names&rsquo; for
suitable values.  <code>Sys.timezone()</code> will return the value of
<span class="env">TZ</span> if set initially (and on some OSes it is always set),
otherwise it will try to retrieve from the OS a value which if set for
<span class="env">TZ</span> would give the initial time zone. (&lsquo;Initially&rsquo; means
before any time-zone functions are used: if <span class="env">TZ</span> is being set to
override the OS setting or if the &lsquo;try&rsquo; does not get this
right, it should be set before the <span class="rlang"><b>R</b></span> process is started or (probably
early enough) in file <code><a href="#topic+.Rprofile">.Rprofile</a></code>).
</p>


<p>If <span class="env">TZ</span> is set but invalid, most platforms default to &lsquo;<span class="samp">&#8288;UTC&#8288;</span>&rsquo;,
the time zone colloquially known as &lsquo;<span class="samp">&#8288;GMT&#8288;</span>&rsquo; (see
<a href="https://en.wikipedia.org/wiki/Coordinated_Universal_Time">https://en.wikipedia.org/wiki/Coordinated_Universal_Time</a>).
(Some but not all platforms will give a warning for invalid values.)
If it is unset or empty the <em>system</em> time zone is used (the one
returned by <code>Sys.timezone</code>).
</p>

<p>Time zones did not come into use until the middle of the nineteenth
century and were not widely adopted until the twentieth, and
<em>daylight saving time</em> (DST, also known as <em>summer time</em>)
was first introduced in the early twentieth century, most widely in
1916.  Over the last 100 years places have changed their affiliation
between major time zones, have opted out of (or in to) DST in various
years or adopted DST rule changes late or not at all.  (For example,
the UK experimented with DST throughout 1971, only.)  In a few
countries (one is the Irish Republic) it is the summer time which is
the &lsquo;standard&rsquo; time and a different name is used in winter.
And there can be multiple changes during a year, for example for
Ramadan.
</p>
<p>A quite common system implementation of <code>POSIXct</code> was as signed
32-bit integers and so only went back to the end of 1901: on such
systems <span class="rlang"><b>R</b></span> assumes that dates prior to that are in the same time zone
as they were in 1902.  Most of the world had not adopted time zones by
1902 (so used local &lsquo;mean time&rsquo; based on longitude) but for a
few places there had been time-zone changes before then.  64-bit
representations are becoming by far the most common; unfortunately on
some 64-bit OSes the database information is 32-bit and so only
available for the range 1901&ndash;2038, and incompletely for the end
years.
</p>
<p>When a time zone location is first found in a session its value is
cached in object <code>.sys.timezone</code> in the base environment.
</p>


<h3>Value</h3>

<p><code>Sys.timezone</code> returns an OS-specific character string, possibly
<code>NA</code> or an empty string (which on some OSes means &lsquo;<span class="samp">&#8288;UTC&#8288;</span>&rsquo;).
This will be a location such as <code>"Europe/London"</code> if one can be
ascertained.
</p>
<p>A time zone region may be known by several names: for example
&lsquo;<span class="samp">&#8288;"Europe/London"&#8288;</span>&rsquo; may also be known as &lsquo;<span class="samp">&#8288;GB&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;GB-Eire&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;Europe/Belfast&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;Europe/Guernsey&#8288;</span>&rsquo;,
&lsquo;<span class="samp">&#8288;Europe/Isle_of_Man&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;Europe/Jersey&#8288;</span>&rsquo;.  A few regions are
also known by a summary of their time zone,
e.g. &lsquo;<span class="samp">&#8288;PST8PDT&#8288;</span>&rsquo; is (on most but not all systems) an alias
for &lsquo;<span class="samp">&#8288;America/Los_Angeles&#8288;</span>&rsquo;.
</p>
<p><code>OlsonNames</code> returns a character vector, see the examples for
typical cases.  It may have an attribute <code>"Version"</code>, something
like &lsquo;<span class="samp">&#8288;"2023a"&#8288;</span>&rsquo;.  (It does on systems using
<span class="option">--with-internal-tzcode</span> and those like Fedora distributing
file &lsquo;<span class="file">tzdata.zi</span>&rsquo;.)
</p>


<h3>Time zone names</h3>

<p>Names <code>"UTC"</code> and its synonym <code>"GMT"</code> are accepted on all
platforms.
</p>
<p>Where OSes describe their valid time zones can be obscure.  The help
for the C function <code>tzset</code> can be helpful, but it can also be
inaccurate.  There is a cumbersome POSIX specification (listed under
environment variable <span class="env">TZ</span> at
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08">https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html#tag_08</a>),
which is often at least partially supported, but there are other more
user-friendly ways to specify time zones.
</p>
<p>Almost all <span class="rlang"><b>R</b></span> platforms make use of a time-zone database originally
compiled by Arthur David Olson and now managed by <abbr>IANA</abbr>, in which the
preferred way to refer to a time zone is by a location (typically of a
city), e.g., <code>Europe/London</code>, <code>America/Los_Angeles</code>,
<code>Pacific/Easter</code> within a &lsquo;time zone region&rsquo;.  Some
traditional designations are also allowed such as <code>EST5EDT</code> or
<code>GB</code>.  (Beware that some of these designations may not be what
you expect: in particular <code>EST</code> is a time zone used in Canada
<em>without</em> daylight saving time, and not <code>EST5EDT</code> nor
(Australian) Eastern Standard Time.)  The designation can also be an
optional colon prepended to the path to a file giving complied zone
information (and the examples above are all files in a system-specific
location).  See <a href="https://data.iana.org/time-zones/tz-link.html">https://data.iana.org/time-zones/tz-link.html</a>
for more details and references.  By convention, regions with a unique
time-zone history since 1970 have specific names in the database, but
those with different earlier histories may not.  Each time zone has
one or two (the second for &lsquo;summer&rsquo;) <em>abbreviations</em> used when
formatting times.
</p>

<p>Increasingly OSes are (optionally or always) not including
&lsquo;legacy&rsquo; names such as <code>US/Eastern</code>: only names of the
forms <code>Continent/City</code> and <code>Etc/...</code> are fully portable.
</p>
<p>The abbreviations used have changed over the years: for example France
used &lsquo;<span class="samp">&#8288;PMT&#8288;</span>&rsquo; (&lsquo;Paris Mean Time&rsquo;) from 1891 to 1911 then
&lsquo;<span class="samp">&#8288;WET/WEST&#8288;</span>&rsquo; up to 1940 and &lsquo;<span class="samp">&#8288;CET/CEST&#8288;</span>&rsquo; from 1946.  (In almost
all time zones the abbreviations have been stable since 1970.)  The
POSIX standard allows only one or two abbreviations per time zone, so
you may see the current abbreviation(s) used for older times.
</p>
<p>For some time zones abbreviations are like &lsquo;<span class="samp">&#8288;-03&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;+0845&#8288;</span>&rsquo;: this is done when there is no official abbreviation.
(Negative values are behind (West of) UTC, as for the <code>"%z"</code>
format for <code><a href="#topic+strftime">strftime</a></code>.)
</p>
<p>The function <code>OlsonNames</code> returns the time-zone names known to
the currently selected Olson/<abbr>IANA</abbr> database.  The system-specific
location in the file system varies,
e.g. &lsquo;<span class="file">/usr/share/zoneinfo</span>&rsquo; (Linux, macOS, FreeBSD),
&lsquo;<span class="file">/usr/share/lib/zoneinfo</span>&rsquo; (Solaris, AIX), ....  It is likely
that there is a file named something like &lsquo;<span class="file">zone1970.tab</span>&rsquo; or
(older) &lsquo;<span class="file">zone.tab</span>&rsquo; under that directory listing the locations
known as time-zone names (but not for example <code>EST5EDT</code>).  See
also <a href="https://en.wikipedia.org/wiki/Zone.tab">https://en.wikipedia.org/wiki/Zone.tab</a>.
</p>
<p>Where <span class="rlang"><b>R</b></span> was configured with option <span class="option">--with-internal-tzcode</span>
(the default on Windows), the database at
<code>file.path(R.home("share"), "zoneinfo")</code> is used by default: file
&lsquo;<span class="file">VERSION</span>&rsquo; in that directory states the version.  That option is
also the default on macOS but there whichever is more recent of the
system database at &lsquo;<span class="file">/var/db/timezone/zoneinfo</span>&rsquo; and that
distributed with <span class="rlang"><b>R</b></span> is used by default.  Environment variable
<span class="env">TZDIR</span> can be used to give the full path to a different
&lsquo;<span class="file">zoneinfo</span>&rsquo; database: value <code>"internal"</code> indicates the
database from the <span class="rlang"><b>R</b></span> sources and <code>"macOS"</code> indicates the system
database. (Setting either of those values would not be recognized by
other software using <span class="env">TZDIR</span>.)
</p>
<p>Setting <span class="env">TZDIR</span> is also supported by the native services on some
OSes, e.g. Linux using <code>glibc</code> except in secure modes.

</p>
<p>Time zones given by name (<em>via</em> environment variable <span class="env">TZ</span>, in
<code>tz</code> arguments to functions such as <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> and
perhaps the system time zone) are loaded from the currently selected
&lsquo;<span class="file">zoneinfo</span>&rsquo; database.
</p>
<p><em>On Windows only:</em>
An attempt is made (once only per session) to map Windows' idea of the
current time zone to a location, following a version of
<a href="http://unicode.org/repos/cldr/trunk/common/supplemental/windowsZones.xml">http://unicode.org/repos/cldr/trunk/common/supplemental/windowsZones.xml</a>
with additional values deduced from the Windows Registry and documentation.
It can be overridden by setting the <span class="env">TZ</span> environment variable
before any date-times are used in the session.
</p>
<p>Most platforms support time zones of the form &lsquo;<span class="samp">&#8288;Etc/GMT+n&#8288;</span>&rsquo; and
&lsquo;<span class="samp">&#8288;Etc/GMT-n&#8288;</span>&rsquo; (possibly also without prefix &lsquo;<span class="samp">&#8288;Etc/&#8288;</span>&rsquo;), which
assume a fixed offset from UTC (hence no DST).  Contrary to some
expectations (but consistent with names such as &lsquo;<span class="samp">&#8288;PST8PDT&#8288;</span>&rsquo;),
negative offsets are times ahead of (East of) UTC, positive offsets
are times behind (West of) UTC.
</p>
<p>Immediately prior to the advent of legislated time zones, most people
used time based on their longitude (or that of a nearby town), known
as &lsquo;Local Mean Time&rsquo; and abbreviated as &lsquo;<span class="samp">&#8288;LMT&#8288;</span>&rsquo; in the
databases: in many countries that was codified with a specific name
before the switch to a standard time.  For example, Paris codified its
<abbr>LMT</abbr> as &lsquo;Paris Mean Time&rsquo; in 1891 (to be used throughout
mainland France) and switched to &lsquo;<span class="samp">&#8288;GMT+0&#8288;</span>&rsquo; in 1911.
</p>

<p>Some systems (notably Linux) have a <code>tzselect</code> command which
allows the interactive selection of a supported time zone name.  On
systems using <code>systemd</code> (notably Linux), the OS command
<code>timedatectl list-timezones</code> will list all available time zone
names.
</p>


<h3>Warnings</h3>

<p>There is a system-specific upper limit on the number of bytes in
(abbreviated) time-zone names which can be as low as 6 (as required by
POSIX).  Some OSes allow the setting of time zones with names which
exceed their limit, and that can crash the <span class="rlang"><b>R</b></span> session.
</p>
<p>Information about future times is speculative (&lsquo;proleptic&rsquo;):
the database provides the best-known information based on current
rules set by civil authorities.  For the period 1900&ndash;1970 those rules
(and which of any authority's rules were enacted) are often obscure,
and the databases do get corrected frequently.
</p>
<p><code>OlsonNames</code> tries to find an Olson database in known locations.
It might not succeed (when it returns an empty vector with a warning)
and even if it does it might not locate the database used by the
date-time code linked into <span class="rlang"><b>R</b></span>.  Fortunately names are added rarely
and most databases are pretty complete.  On the other hand, many names
which duplicate other named timezones have been moved to the
&lsquo;<span class="file">backward</span>&rsquo; list &ndash; these are regarded as optional and omitted on
minimal installations.  Similarly, there are timezones named in file
&lsquo;<span class="file">backzone</span>&rsquo; which differ only from those in the main lists prior
to 1970 &ndash; these are usually included but may not be in minimalist
systems.
</p>


<p>For many years, the legacy names <code>EST5EDT</code> and <code>PST8PDT</code>
were portable, but <code>musl</code> (the C runtime used by Alpine Linux)
does not use DST with those names.
</p>


<h3>How the system time zone is found &ndash; on Unix-alikes</h3>

<p>This section is of background interest for users of a Unix-alike, but
may help if an <code>NA</code> value is returned unexpectedly.
</p>
<p>Commercial Unixen such as Solaris and AIX set <span class="env">TZ</span>, so the value
when <span class="rlang"><b>R</b></span> is started is used.
</p>
<p>All other common platforms (Linux, macOS, *BSD) use similar schemes,
either derived from <code>tzcode</code> (currently distributed from
<a href="https://www.iana.org/time-zones">https://www.iana.org/time-zones</a>) or independently coded
(<code>glibc</code>, <code>musl-libc</code>).  Such systems read the time-zone
information from a file &lsquo;<span class="file">localtime</span>&rsquo;, usually under &lsquo;<span class="file">/etc</span>&rsquo;
(but possibly under &lsquo;<span class="file">/usr/local/etc</span>&rsquo; or
&lsquo;<span class="file">/usr/local/etc/zoneinfo</span>&rsquo;).  As the usual Linux manual page for
<code>localtime</code> says
</p>
<p>&lsquo;Because the time zone identifier is extracted from the symlink
target name of &lsquo;<span class="file">/etc/localtime</span>&rsquo;, this file may not be a normal
file or hardlink.&rsquo;
</p>
<p>Nevertheless, some Linux distributions (including the one from which
that quote was taken) or sysadmins have chosen to copy a time-zone file
to &lsquo;<span class="file">localtime</span>&rsquo;.  For a non-symlink, the ultimate fallback is to
compare that file to all files in the time-zone database.
</p>
<p>Some Linux platforms provide two other mechanisms which are tried in
turn before looking at &lsquo;<span class="file">/etc/localtime</span>&rsquo;.
</p>

<ul>
<li> <p>&lsquo;Modern&rsquo; Linux systems use <code>systemd</code> which
provides mechanisms to set and retrieve the time zone (amongst other
things).  There is a command <code>timedatectl</code> to give details.
(Unfortunately RHEL/Centos 6.x were not &lsquo;modern&rsquo;.)
</p>
</li>
<li><p> Debian-derived systems since <em>ca</em> 2007 have supplied a
file &lsquo;<span class="file">/etc/timezone</span>&rsquo;.  Its format is undocumented but
empirically it contains a single line of text naming the time zone.
</p>
</li></ul>

<p>In each case a sanity check is performed that the time-zone name is the
name of a file in the time-zone database.  (The systems probably use
the time-zone file (symlinked to) &lsquo;<span class="file">/etc/localtime</span>&rsquo;, but the
<code>Sys.timezone</code> code does not check that is the same as the named
file in the database.  This is deliberate as they may be from
different dates.)
</p>


<h3>Note</h3>

<p>Since 2007 there has been considerable disruption over changes to the
timings of the DST transitions; these often have short notice and
time-zone databases may not be up to date.  (Morocco in 2013 announced
a change to the end of DST at <em>a day's</em> notice.  In
2023 there was chaos in Lebanon as the authorities changed their minds
repeatedly and some changes were not widely implemented.)
</p>
<p>There have also been changes to the &lsquo;standard&rsquo; time with little
notice (Kazakhstan switched to a single time zone in Mar 2024 with six
weeks' notice), and to whether &lsquo;summer&rsquo; or &lsquo;winter&rsquo;
time is regarded as &lsquo;standard&rsquo; (and hence to abbreviations).

</p>
<p>On platforms with case-insensitive file systems, time zone names will be
case-insensitive.  They may or may not be on other platforms and so,
for example, <code>"gmt"</code> is valid on some platforms and not on others.
</p>
<p>Note that except where replaced, the operation of time zones is an OS
service, and even where replaced a third-party database is used and
can be updated (see the section on &lsquo;Time zone names&rsquo;).
Incorrect results will never be an <span class="rlang"><b>R</b></span> issue, so please ensure that you
have the courtesy not to blame <span class="rlang"><b>R</b></span> for them.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sys.time">Sys.time</a></code>, <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code>.
</p>
<p><a href="https://en.wikipedia.org/wiki/Time_zone">https://en.wikipedia.org/wiki/Time_zone</a> and
<a href="https://data.iana.org/time-zones/tz-link.html">https://data.iana.org/time-zones/tz-link.html</a>
for extensive sets of links.
</p>
<p><a href="https://data.iana.org/time-zones/theory.html">https://data.iana.org/time-zones/theory.html</a> for the
&lsquo;rules&rsquo; of the Olson/<abbr>IANA</abbr> database.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sys.timezone()

str(OlsonNames()) ## typically around six hundred names,
## typically some acronyms/aliases such as "UTC", "NZ", "MET", "Eire", ..., but
## mostly pairs (and triplets) such as "Pacific/Auckland"
table(sl &lt;- grepl("/", OlsonNames()))
OlsonNames()[ !sl ] # the simple ones
head(Osl &lt;- strsplit(OlsonNames()[sl], "/"))
(tOS1 &lt;- table(vapply(Osl, `[[`, "", 1))) # Continents, countries, ...
table(lengths(Osl))# most are pairs, some triplets
str(Osl[lengths(Osl) &gt;= 3])# "America" South and North ...
</code></pre>

<hr>
<h2 id='toString'>Convert an R Object to a Character String</h2><span id='topic+toString'></span><span id='topic+toString.default'></span>

<h3>Description</h3>

<p>This is a helper function for <code><a href="#topic+format">format</a></code> to produce a single
character string describing an <span class="rlang"><b>R</b></span> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toString(x, ...)

## Default S3 method:
toString(x, width = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toString_+3A_x">x</code></td>
<td>
<p>The object to be converted.</p>
</td></tr>
<tr><td><code id="toString_+3A_width">width</code></td>
<td>
<p>Suggestion for the maximum field width.  Values of
<code>NULL</code> or <code>0</code> indicate no maximum.
The minimum value accepted is 6 and smaller values are taken as 6.</p>
</td></tr>
<tr><td><code id="toString_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to or from methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function for which methods can be written: only the
default method is described here.  Most methods should honor the
<code>width</code> argument to specify the maximum display width (as measured
by <code><a href="#topic+nchar">nchar</a>(type = "width")</code>) of the result.
</p>
<p>The default method first converts <code>x</code> to character and then
concatenates the elements separated by <code>", "</code>.
If <code>width</code> is supplied and is not <code>NULL</code>, the default method
returns the first <code>width - 4</code> characters of the result with
<code>....</code> appended, if the full result would use more than
<code>width</code> characters.
</p>


<h3>Value</h3>

<p>A character vector of length 1 is returned.
</p>


<h3>Author(s)</h3>

<p> Robert Gentleman </p>


<h3>See Also</h3>

 <p><code><a href="#topic+format">format</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c("a", "b", "aaaaaaaaaaa")
toString(x)
toString(x, width = 8)
</code></pre>

<hr>
<h2 id='trace'>Interactive Tracing and Debugging of Calls to a Function or Method</h2><span id='topic+trace'></span><span id='topic+untrace'></span><span id='topic+tracingState'></span><span id='topic+.doTrace'></span><span id='topic+returnValue'></span>

<h3>Description</h3>

<p>A call to <code>trace</code> allows you to insert debugging code (e.g., a
call to <code><a href="#topic+browser">browser</a></code> or <code><a href="utils.html#topic+recover">recover</a></code>) at chosen
places in any function.  A call to <code>untrace</code> cancels the tracing.
Specified methods can be traced the same way, without tracing all
calls to the generic function.  Trace code (<code>tracer</code>) can be any
<span class="rlang"><b>R</b></span> expression.  Tracing can be temporarily turned on or off globally
by calling <code>tracingState</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trace(what, tracer, exit, at, print, signature,
      where = topenv(parent.frame()), edit = FALSE)
untrace(what, signature = NULL, where = topenv(parent.frame()))

tracingState(on = NULL)
.doTrace(expr, msg)
returnValue(default = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trace_+3A_what">what</code></td>
<td>
<p>the name, possibly <code><a href="#topic+quote">quote</a>()</code>d, of a function
to be traced or untraced.  For <code>untrace</code> or for <code>trace</code>
with more than one argument, more than one name can be given in the
quoted form, and the same action will be applied to each one.  For
&ldquo;hidden&rdquo; functions such as S3 methods in a namespace,
<code>where = *</code> typically needs to be specified as well.</p>
</td></tr>
<tr><td><code id="trace_+3A_tracer">tracer</code></td>
<td>
<p>either a <a href="#topic+function">function</a> or an unevaluated expression.  The
function will be called or the expression will be evaluated either
at the beginning of the call, or before those steps in the call
specified by the argument <code>at</code>.
See the details section.</p>
</td></tr>
<tr><td><code id="trace_+3A_exit">exit</code></td>
<td>
<p>either a <code><a href="#topic+function">function</a></code> or an unevaluated expression.  The
function will be called or the expression will be evaluated on
exiting the function.
See the details section.</p>
</td></tr>
<tr><td><code id="trace_+3A_at">at</code></td>
<td>
<p>optional numeric vector or list.  If supplied, <code>tracer</code>
will be called just before the corresponding step in the body of the
function.
See the details section. </p>
</td></tr>
<tr><td><code id="trace_+3A_print">print</code></td>
<td>
<p>if <code>TRUE</code> (as per default), a descriptive line is
printed before any trace expression is evaluated.</p>
</td></tr>
<tr><td><code id="trace_+3A_signature">signature</code></td>
<td>
<p>an optional
signature for a method for function <code>what</code>.  If supplied, the
method, and <em>not</em> the function itself, is traced.</p>
</td></tr>
<tr><td><code id="trace_+3A_edit">edit</code></td>
<td>
<p> For complicated tracing, such as tracing within a loop
inside the function, you will need to insert the desired calls by
editing the body of the function.  If so, supply the <code>edit</code>
argument either as <code>TRUE</code>, or as the name of the editor you
want to use.  Then <code>trace()</code> will call <code><a href="utils.html#topic+edit">edit</a></code> and
use the version of the function after you edit it.  See the details
section for additional information.
</p>
</td></tr>
<tr><td><code id="trace_+3A_where">where</code></td>
<td>
<p>where to look for the function to be
traced; by default, the top-level environment of the call to
<code>trace</code>.
</p>
<p>An important use of this argument is to trace functions from a
package which are &ldquo;hidden&rdquo; or called from another package.
The namespace mechanism imports the functions to be called (with the
exception of functions in the base package).  The functions being
called are <em>not</em> the same objects seen from the top-level (in
general, the imported packages may not even be attached).
Therefore, you must ensure that the correct versions are being
traced.  The way to do this is to set argument <code>where</code> to a
function in the namespace (or that namespace).  The tracing
computations will then start looking in the environment of that
function (which will be the namespace of the corresponding package).
(Yes, it's subtle, but the semantics here are central to how
namespaces work in <span class="rlang"><b>R</b></span>.)
</p>
</td></tr>
<tr><td><code id="trace_+3A_on">on</code></td>
<td>
<p>logical; a call to the support function <code>tracingState</code> returns <code>TRUE</code>
if tracing is globally turned on, <code>FALSE</code> otherwise.  An
argument of one or the other of those values sets the state.  If the
tracing state is <code>FALSE</code>, none of the trace actions will
actually occur (used, for example, by debugging functions to shut
off tracing during debugging).</p>
</td></tr>
<tr><td><code id="trace_+3A_expr">expr</code>, <code id="trace_+3A_msg">msg</code></td>
<td>
<p>arguments to the support function <code>.doTrace</code>, calls to
which are inserted into the modified function or method:
<code>expr</code> is the tracing action (such as a call to
<code>browser()</code>), and <code>msg</code> is a string identifying the
place where the trace action occurs.
</p>
</td></tr>
<tr><td><code id="trace_+3A_default">default</code></td>
<td>
<p>if <code>returnValue</code> finds no return value (e.g., when
a function exited because of an error, restart or as a result
of evaluating a return from a caller function), it will return
<code>default</code> instead.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>trace</code> function operates by constructing a revised version
of the function (or of the method, if <code>signature</code> is supplied),
and assigning the new object back where the original was found.
If only the <code>what</code> argument is given, a line of trace printing is
produced for each call to the function (back compatible with the
earlier version of <code>trace</code>).
</p>
<p>The object constructed by <code>trace</code> is from a class that extends
<code>"function"</code> and which contains the original, untraced version.
A call to <code>untrace</code> re-assigns this version.
</p>
<p>If the argument <code>tracer</code> or <code>exit</code> is the name of a
function, the tracing expression will be a call to that function, with
no arguments.  This is the easiest and most common case, with the
functions <code><a href="#topic+browser">browser</a></code> and <code><a href="utils.html#topic+recover">recover</a></code> the
likeliest candidates; the former browses in the frame of the function
being traced, and the latter allows browsing in any of the currently
active calls. The arguments <code>tracer</code> and <code>exit</code> are evaluated to
see whether they are functions, but only their names are used in the
tracing expressions.  The lookup is done again when the traced function
executes, so it may not be <code>tracer</code> or <code>exit</code> that will be called
while tracing.
</p>
<p>The <code>tracer</code> or <code>exit</code> argument can also be an unevaluated
expression (such as returned by a call to <code><a href="#topic+quote">quote</a></code> or
<code><a href="#topic+substitute">substitute</a></code>).  This expression itself is inserted in the
traced function, so it will typically involve arguments or local
objects in the traced function.  An expression of this form is useful
if you only want to interact when certain conditions apply (and in
this case you probably want to supply <code>print = FALSE</code> in the call
to <code>trace</code> also).
</p>
<p>When the <code>at</code> argument is supplied, it can be a vector of
integers referring to the substeps of the body of the function (this
only works if the body of the function is enclosed in <code>{ ...}</code>).  In
this case <code>tracer</code> is <em>not</em> called on entry, but instead
just before evaluating each of the steps listed in <code>at</code>.  (Hint:
you don't want to try to count the steps in the printed version of a
function; instead, look at <code>as.list(body(f))</code> to get the numbers
associated with the steps in function <code>f</code>.)
</p>
<p>The <code>at</code> argument can also be a list of integer vectors.  In
this case, each vector refers to a step nested within another step of
the function.  For example, <code>at = list(c(3,4))</code>
will call the tracer just before the fourth step of the third step
of the function.  See the example below.
</p>
<p>Using <code><a href="utils.html#topic+setBreakpoint">setBreakpoint</a></code> (from package <span class="pkg">utils</span>) may be an
alternative, calling <code>trace(...., at, ...)</code>.
</p>
<p>The <code>exit</code> argument is called during <code><a href="#topic+on.exit">on.exit</a></code>
processing.  In an <code>on.exit</code> expression, the experimental <code>returnValue()</code>
function may be called to obtain the value about to be returned by
the function. Calling this function in other circumstances will give
undefined results.
</p>
<p>An intrinsic limitation in the <code>exit</code> argument is that it won't
work if the function itself uses <code>on.exit</code> with <code>add=
  FALSE</code> (the default), since the existing calls will override the one
supplied by <code>trace</code>.
</p>
<p>Tracing does not nest.  Any call to <code>trace</code> replaces previously
traced versions of that function or method (except for edited
versions as discussed below), and <code>untrace</code> always
restores an untraced version.  (Allowing nested tracing has too many
potentials for confusion and for accidentally leaving traced versions
behind.)
</p>
<p>When the <code>edit</code> argument is used repeatedly with no call to
<code>untrace</code> on the same function or method in between, the
previously edited version is retained.  If you want to throw away
all the previous tracing and then edit, call <code>untrace</code> before the next
call to <code>trace</code>.  Editing may be combined with automatic
tracing; just supply the other arguments such as <code>tracer</code>, and
the <code>edit</code> argument as well.  The <code>edit = TRUE</code> argument
uses the default editor (see <code><a href="utils.html#topic+edit">edit</a></code>).
</p>
<p>Tracing primitive functions (builtins and specials) from the base
package works, but only by a special mechanism and not very
informatively.  Tracing a primitive causes the primitive to be
replaced by a function with argument ... (only).  You can get a bit
of information out, but not much.  A warning message is issued when
<code>trace</code> is used on a primitive.
</p>
<p>The practice of saving the traced version of the function back where
the function came from means that tracing carries over from one
session to another, <em>if</em> the traced function is saved in the
session image.  (In the next session, <code>untrace</code> will remove the
tracing.)  On the other hand, functions that were in a package, not in
the global environment, are not saved in the image, so tracing expires
with the session for such functions.
</p>
<p>Tracing an S4 method is basically just like tracing a function, with the
exception that the traced version is stored by a call to
<code><a href="methods.html#topic+setMethod">setMethod</a></code> rather than by direct assignment, and so is
the untraced version after a call to <code>untrace</code>.
</p>
<p>The version of <code>trace</code> described here is largely compatible with
the version in S-Plus, although the two work by entirely different
mechanisms.  The S-Plus <code>trace</code> uses the session frame, with the
result that tracing never carries over from one session to another (<span class="rlang"><b>R</b></span>
does not have a session frame).  Another relevant distinction has
nothing directly to do with <code>trace</code>:  The browser in S-Plus
allows changes to be made to the frame being browsed, and the changes
will persist after exiting the browser.  The <span class="rlang"><b>R</b></span> browser allows changes,
but they disappear when the browser exits.  This may be relevant in
that the S-Plus version allows you to experiment with code changes
interactively, but the <span class="rlang"><b>R</b></span> version does not.  (A future revision may
include a &lsquo;destructive&rsquo; browser for <span class="rlang"><b>R</b></span>.)
</p>


<h3>Value</h3>

<p>In the simple version (just the first argument), <code>trace</code> returns
an invisible <code>NULL</code>.
Otherwise, the traced function(s) name(s).  The relevant consequence is the
assignment that takes place.
</p>
<p><code>untrace</code> returns the function name invisibly.
</p>
<p><code>tracingState</code> returns the current global tracing state, and possibly
changes it.
</p>
<p>When called during <code>on.exit</code> processing, <code>returnValue</code> returns
the value about to be returned by the exiting function.  Behaviour in
other circumstances is undefined.
</p>


<h3>Note</h3>

<p>Using <code>trace()</code> is conceptually a generalization of
<code><a href="#topic+debug">debug</a></code>, implemented differently.  Namely by calling
<code><a href="#topic+browser">browser</a></code> via its <code>tracer</code> or <code>exit</code> argument.


</p>
<p>The version of function tracing that includes any of the arguments
except for the function name requires the <span class="pkg">methods</span> package
(because it uses special classes of objects to store and restore
versions of the traced functions).
</p>
<p>If methods dispatch is not currently on, <code>trace</code> will load the
methods namespace, but will not put the methods package on the
<code><a href="#topic+search">search</a></code> list.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+browser">browser</a></code> and <code><a href="utils.html#topic+recover">recover</a></code>, the likeliest
tracing functions;
also, <code><a href="#topic+quote">quote</a></code> and <code><a href="#topic+substitute">substitute</a></code> for
constructing general expressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)

##  Very simple use
trace(sum)
hist(rnorm(100)) # shows about 3-4 calls to sum()
untrace(sum)

## Show how pt() is called from inside power.t.test():
if(FALSE)
  trace(pt) ## would show ~20 calls, but we want to see more:
trace(pt, tracer = quote(cat(sprintf("tracing pt(*, ncp = %.15g)\n", ncp))),
      print = FALSE) # &lt;- not showing typical extra
power.t.test(20, 1, power=0.8, sd=NULL)  ##--&gt; showing the ncp root finding:
untrace(pt)

f &lt;- function(x, y) {
    y &lt;- pmax(y, 0.001)
    if (x &gt; 0) x ^ y else stop("x must be positive")
}

## arrange to call the browser on entering and exiting
## function f
trace("f", quote(browser(skipCalls = 4)),
      exit = quote(browser(skipCalls = 4)))

## instead, conditionally assign some data, and then browse
## on exit, but only then.  Don't bother me otherwise

trace("f", quote(if(any(y &lt; 0)) yOrig &lt;- y),
      exit = quote(if(exists("yOrig")) browser(skipCalls = 4)),
      print = FALSE)

## Enter the browser just before stop() is called.  First, find
## the step numbers

untrace(f) # (as it has changed f's body !)
as.list(body(f))
as.list(body(f)[[3]]) # -&gt; stop(..) is [[4]]

## Now call the browser there

trace("f", quote(browser(skipCalls = 4)), at = list(c(3,4)))
## Not run: 
f(-1,2) # --&gt; enters browser just before stop(..)

## End(Not run)

## trace a utility function, with recover so we
## can browse in the calling functions as well.

trace("as.matrix", recover)

## turn off the tracing (that happened above)

untrace(c("f", "as.matrix"))

## Not run: 
## Useful to find how system2() is called in a higher-up function:
trace(base::system2, quote(print(ls.str())))

## End(Not run)

##-------- Tracing hidden functions : need 'where = *'
##
## 'where' can be a function whose environment is meant:
trace(quote(ar.yw.default), where = ar)
a &lt;- ar(rnorm(100)) # "Tracing ..."
untrace(quote(ar.yw.default), where = ar)

## trace() more than one function simultaneously:
##         expression(E1, E2, ...)  here is equivalent to
##          c(quote(E1), quote(E2), quote(.*), ..)
trace(expression(ar.yw, ar.yw.default), where = ar)
a &lt;- ar(rnorm(100)) # --&gt; 2 x "Tracing ..."
# and turn it off:
untrace(expression(ar.yw, ar.yw.default), where = ar)


## Not run: 
## trace calls to the function lm() that come from
## the nlme package.
trace("lm", where = asNamespace("nlme"))
      lm    (len ~ log(dose) * supp, ToothGrowth) -&gt; fit1  # NOT traced
nlme::lmList(len ~ log(dose) | supp, ToothGrowth) -&gt; fit2  # traced
untrace("lm", where = asNamespace("nlme"))

## End(Not run)
</code></pre>

<hr>
<h2 id='traceback'>Get and Print Call Stacks</h2><span id='topic+traceback'></span><span id='topic+.traceback'></span><span id='topic+.Traceback'></span>

<h3>Description</h3>

<p>By default <code>traceback()</code> prints the call stack of the last
uncaught error, i.e., the sequence of calls that lead to the error.
This is useful when an error occurs with an unidentifiable error
message.  It can also be used to print the current stack or
arbitrary lists of calls.
</p>
<p><code>.traceback()</code> now <em>returns</em> the above call stack (and
<code>traceback(x, *)</code> can be regarded as convenience function for
printing the result of <code>.traceback(x)</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> traceback(x = NULL, max.lines = getOption("traceback.max.lines",
                                           getOption("deparse.max.lines", -1L)))
.traceback(x = NULL, max.lines = getOption("traceback.max.lines",
                                           getOption("deparse.max.lines", -1L)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceback_+3A_x">x</code></td>
<td>
<p><code>NULL</code> (default, meaning <code>.Traceback</code>), or an
integer count of calls to skip in the current stack, or a list or
pairlist of calls.  See the details.</p>
</td></tr>
<tr><td><code id="traceback_+3A_max.lines">max.lines</code></td>
<td>
<p>a number, the maximum number of lines to be printed
<em>per call</em>.  The default is unlimited.  Applies only when <code>x</code>
is <code>NULL</code>, a <code><a href="#topic+list">list</a></code> or a <code><a href="#topic+pairlist">pairlist</a></code> of
calls, see the details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default display is of the stack of the last uncaught error as
stored as a list of <code><a href="#topic+call">call</a></code>s in <code>.Traceback</code>, which
<code>traceback</code> prints in a user-friendly format.  The stack of
calls always contains all function calls and all foreign
function calls (such as <code><a href="#topic+.Call">.Call</a></code>): if profiling is in
progress it will include calls to some primitive functions.  (Calls
to builtins are included, but not to specials.)
</p>
<p>Errors which are caught <em>via</em> <code><a href="#topic+try">try</a></code> or
<code><a href="#topic+tryCatch">tryCatch</a></code> do not generate a traceback, so what is printed
is the call sequence for the last uncaught error, and not necessarily
for the last error.
</p>
<p>If <code>x</code> is numeric, then the current stack is printed, skipping
<code>x</code> entries at the top of the stack.  For example,
<code>options(error = function() traceback(3))</code> will print the stack
at the time of the error, skipping the call to <code>traceback()</code> and
<code>.traceback()</code>
and the error function that called it.
</p>
<p>Otherwise, <code>x</code> is assumed to be a list or pairlist of calls or
deparsed calls and will be displayed in the same way.
</p>
<p><code>.traceback()</code> and by extension <code>traceback()</code> may trigger
deparsing of <code><a href="#topic+call">call</a></code>s.  This is an expensive operation
for large calls so it may be advisable to set <code>max.lines</code>
to a reasonable value when such calls are on the call stack.
</p>


<h3>Value</h3>

<p><code>.traceback()</code> returns the deparsed call stack deepest call
first as a list or pairlist.  The number of lines deparsed from
the call can be limited via <code>max.lines</code>.  Calls for which
<code>max.lines</code> results in truncated output will gain a
<code>"truncated"</code> attribute.
</p>
<p><code>traceback()</code> formats, prints, and returns the call stack
produced by <code>.traceback()</code> invisibly.
</p>


<h3>Warning</h3>

<p>It is undocumented where <code>.Traceback</code> is stored nor that it is
visible, and this is subject to change.  Currently
<code>.Traceback</code> contains the <code><a href="#topic+call">call</a></code>s as language
objects.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>foo &lt;- function(x) { print(1); bar(2) }
bar &lt;- function(x) { x + a.variable.which.does.not.exist }
## Not run: 
foo(2) # gives a strange error
traceback()
## End(Not run)
## 2: bar(2)
## 1: foo(2)
bar
## Ah, this is the culprit ...

## This will print the stack trace at the time of the error.
options(error = function() traceback(3))
</code></pre>

<hr>
<h2 id='tracemem'>Trace Copying of Objects</h2><span id='topic+tracemem'></span><span id='topic+untracemem'></span><span id='topic+retracemem'></span>

<h3>Description</h3>

<p>This function marks an object so that a message is printed whenever the
internal code copies the object.  It is a
major cause of hard-to-predict memory use in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tracemem(x)
untracemem(x)
retracemem(x, previous = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tracemem_+3A_x">x</code></td>
<td>
<p>An R object, not a function or environment or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="tracemem_+3A_previous">previous</code></td>
<td>
<p>A value as returned by <code>tracemem</code> or <code>retracemem</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functionality is optional, determined at compilation, because it
makes R run a little more slowly even when no objects are being
traced.  <code>tracemem</code> and <code>untracemem</code> give errors when R is not
compiled with memory profiling; <code>retracemem</code> does not (so it can be
left in code during development).
</p>
<p>It is enabled in the CRAN macOS and Windows builds of <span class="rlang"><b>R</b></span>.
</p>
<p>When an object is traced any copying of the object by the C function
<code>duplicate</code> produces a message to standard output, as does type
coercion and copying when passing arguments to <code>.C</code> or
<code>.Fortran</code>.
</p>
<p>The message consists of the string <code>tracemem</code>, the identifying
strings for the object being copied and the new object being created,
and a stack trace showing where the duplication occurred.
<code>retracemem()</code> is used to indicate that a variable should be
considered a copy of a previous variable (e.g., after subscripting).
</p>
<p>The messages can be turned off with <code><a href="#topic+tracingState">tracingState</a></code>.
</p>
<p>It is not possible to trace functions, as this would conflict with
<code><a href="#topic+trace">trace</a></code> and it is not useful to trace <code>NULL</code>,
environments, promises, weak references, or external pointer objects, as
these are not duplicated.
</p>
<p>These functions are <a href="#topic+primitive">primitive</a>.
</p>


<h3>Value</h3>

<p>A character string for identifying the object in the trace output (an
address in hex enclosed in angle brackets), or <code>NULL</code> (invisibly).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+capabilities">capabilities</a>("profmem")</code> to see if this was enabled for
this build of <span class="rlang"><b>R</b></span>.
</p>
<p><code><a href="#topic+trace">trace</a></code>, <code><a href="utils.html#topic+Rprofmem">Rprofmem</a></code>
</p>
<p><a href="https://developer.r-project.org/memory-profiling.html">https://developer.r-project.org/memory-profiling.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
a &lt;- 1:10
tracemem(a)
## b and a share memory
b &lt;- a
b[1] &lt;- 1
untracemem(a)

## copying in lm: less than R &lt;= 2.15.0
d &lt;- stats::rnorm(10)
tracemem(d)
lm(d ~ a+log(b))

## f is not a copy and is not traced
f &lt;- d[-1]
f+1
## indicate that f should be traced as a copy of d
retracemem(f, retracemem(d))
f+1

## End(Not run)</code></pre>

<hr>
<h2 id='transform'>Transform an Object, for Example a Data Frame</h2><span id='topic+transform'></span><span id='topic+transform.default'></span><span id='topic+transform.data.frame'></span>

<h3>Description</h3>

<p><code>transform</code> is a generic function, which&mdash;at least
currently&mdash;only does anything useful with
data frames.  <code>transform.default</code> converts its first argument to
a data frame if possible and calls <code>transform.data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform(`_data`, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_+3A__data">_data</code></td>
<td>
<p>The object to be transformed</p>
</td></tr>
<tr><td><code id="transform_+3A_...">...</code></td>
<td>
<p>Further arguments of the form <code>tag=value</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>...</code> arguments to <code>transform.data.frame</code> are tagged
vector expressions, which are evaluated in the data frame
<code>_data</code>.  The tags are matched against <code>names(_data)</code>, and for
those that match, the value replace the corresponding variable in
<code>_data</code>, and the others are appended to <code>_data</code>.
</p>


<h3>Value</h3>

<p>The modified value of <code>_data</code>.
</p>


<h3>Warning</h3>

<p>This is a convenience function intended for use interactively.  For
programming it is better to use the standard subsetting arithmetic functions,
and in particular the non-standard evaluation of
argument <code>transform</code> can have unanticipated consequences.
</p>


<h3>Note</h3>

<p>If some of the values are not vectors of the appropriate length,
you deserve whatever you get!
</p>


<h3>Author(s)</h3>

<p>Peter Dalgaard</p>


<h3>See Also</h3>

 <p><code><a href="#topic+within">within</a></code> for a more flexible approach,
<code><a href="#topic+subset">subset</a></code>,
<code><a href="#topic+list">list</a></code>,
<code><a href="#topic+data.frame">data.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>transform(airquality, Ozone = -Ozone)
transform(airquality, new = -Ozone, Temp = (Temp-32)/1.8)

attach(airquality)
transform(Ozone, logOzone = log(Ozone)) # marginally interesting ...
detach(airquality)
</code></pre>

<hr>
<h2 id='Trig'>Trigonometric Functions</h2><span id='topic+Trig'></span><span id='topic+cos'></span><span id='topic+sin'></span><span id='topic+tan'></span><span id='topic+acos'></span><span id='topic+arccos'></span><span id='topic+asin'></span><span id='topic+arcsin'></span><span id='topic+atan'></span><span id='topic+arctan'></span><span id='topic+atan2'></span><span id='topic+cospi'></span><span id='topic+sinpi'></span><span id='topic+tanpi'></span>

<h3>Description</h3>

<p>These functions give the obvious trigonometric functions.  They
respectively compute the cosine, sine, tangent, arc-cosine, arc-sine,
arc-tangent, and the two-argument arc-tangent.
</p>
<p><code>cospi(x)</code>, <code>sinpi(x)</code>, and <code>tanpi(x)</code>, compute
<code>cos(pi*x)</code>, <code>sin(pi*x)</code>, and <code>tan(pi*x)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cos(x)
sin(x)
tan(x)

acos(x)
asin(x)
atan(x)
atan2(y, x)

cospi(x)
sinpi(x)
tanpi(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Trig_+3A_x">x</code>, <code id="Trig_+3A_y">y</code></td>
<td>
<p>numeric or complex vectors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arc-tangent of two arguments <code>atan2(y, x)</code> returns the angle
between the x-axis and the vector from the origin to <code class="reqn">(x, y)</code>,
i.e., for positive arguments <code>atan2(y, x) == atan(y/x)</code>.
</p>
<p>Angles are in radians, not degrees, for the standard versions (i.e., a
right angle is <code class="reqn">\pi/2</code>), and in &lsquo;half-rotations&rsquo; for
<code>cospi</code> etc.
</p>
<p><code>cospi(x)</code>, <code>sinpi(x)</code>, and <code>tanpi(x)</code> are accurate
for <code>x</code> values which are multiples of a half.
</p>
<p>All except <code>atan2</code> are <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a>
functions: methods can be defined for them individually or via the
<code><a href="#topic+S3groupGeneric">Math</a></code> group generic.
</p>
<p>These are all wrappers to system calls of the same name (with prefix
<code>c</code> for complex arguments) where available.  (<code>cospi</code>,
<code>sinpi</code>, and <code>tanpi</code> are part of a C11 extension
and provided by e.g. macOS and Solaris: where not yet
available call to <code>cos</code> <em>etc</em> are used, with special cases
for  multiples of a half.)
</p>


<h3>Value</h3>

<p><code>tanpi(0.5)</code> is <code><a href="#topic+NaN">NaN</a></code>.  Similarly for other inputs
with fractional part <code>0.5</code>.
</p>


<h3>Complex values</h3>

<p>For the inverse trigonometric functions, branch cuts are defined as in
Abramowitz and Stegun, figure 4.4, page 79.
</p>
<p>For <code>asin</code> and <code>acos</code>, there are two cuts, both along
the real axis: <code class="reqn">\left(-\infty, -1\right]</code> and
<code class="reqn">\left[1, \infty\right)</code>.
</p>
<p>For <code>atan</code> there are two cuts, both along the pure imaginary
axis: <code class="reqn">\left(-\infty i, -1i\right]</code> and
<code class="reqn">\left[1i, \infty i\right)</code>.
</p>
<p>The behaviour actually on the cuts follows the C99 standard which
requires continuity coming round the endpoint in a counter-clockwise
direction.
</p>
<p>Complex arguments for  <code>cospi</code>, <code>sinpi</code>, and <code>tanpi</code>
are not yet implemented, and they are a &lsquo;future direction&rsquo; of
ISO/<abbr>IEC</abbr> TS 18661-4.
</p>


<h3>S4 methods</h3>

<p>All except <code>atan2</code> are S4 generic functions: methods can be defined
for them individually or via the
<code><a href="methods.html#topic+S4groupGeneric">Math</a></code> group generic.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Abramowitz, M. and Stegun, I. A. (1972). <em>Handbook of
Mathematical Functions</em>. New York: Dover.<br />
Chapter 4. Elementary Transcendental Functions: Logarithmic,
Exponential, Circular and Hyperbolic Functions
</p>
<p>For <code>cospi</code>, <code>sinpi</code>, and <code>tanpi</code> the C11 extension
ISO/IEC TS 18661-4:2015 (draft at
<a href="https://www.open-std.org/jtc1/sc22/wg14/www/docs/n1950.pdf">https://www.open-std.org/jtc1/sc22/wg14/www/docs/n1950.pdf</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-3, 7, by = 1/8)
tx &lt;- cbind(x, cos(pi*x), cospi(x), sin(pi*x), sinpi(x),
               tan(pi*x), tanpi(x), deparse.level=2)
op &lt;- options(digits = 4, width = 90) # for nice formatting
head(tx)
tx[ (x %% 1) %in% c(0, 0.5) ,]
options(op)
</code></pre>

<hr>
<h2 id='trimws'>Remove Leading/Trailing Whitespace</h2><span id='topic+trimws'></span>

<h3>Description</h3>

<p>Remove leading and/or trailing whitespace from character strings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trimws(x, which = c("both", "left", "right"), whitespace = "[ \t\r\n]")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trimws_+3A_x">x</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="trimws_+3A_which">which</code></td>
<td>
<p>a character string specifying whether to remove both
leading and trailing whitespace (default), or only leading
(<code>"left"</code>) or trailing (<code>"right"</code>).  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="trimws_+3A_whitespace">whitespace</code></td>
<td>
<p>a string specifying a regular expression to match
(one character of) &ldquo;white space&rdquo;, see Details for
alternatives to the default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, <code><a href="#topic+sub">sub</a>(re, "", *, perl = TRUE)</code>, i.e., PCRE
library regular expressions are used.
For portability, the default &lsquo;whitespace&rsquo; is the character class
<code>[ \t\r\n]</code> (space, horizontal tab, carriage return,
newline).  Alternatively, <code>[\h\v]</code> is a good (PCRE)
generalization to match all Unicode horizontal and vertical white
space characters, see also <a href="https://www.pcre.org">https://www.pcre.org</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- "  Some text. "
x
trimws(x)
trimws(x, "l")
trimws(x, "r")

## Unicode --&gt; need "stronger" 'whitespace' to match all :
tt &lt;- "text with unicode 'non breakable space'."
xu &lt;- paste(" \t\v", tt, "\u00a0 \n\r")
(tu &lt;- trimws(xu, whitespace = "[\\h\\v]"))
stopifnot(identical(tu, tt))
</code></pre>

<hr>
<h2 id='try'>Try an Expression Allowing Error Recovery</h2><span id='topic+try'></span>

<h3>Description</h3>

<p><code>try</code> is a wrapper to run an expression that might fail and allow
the user's code to handle error-recovery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>try(expr, silent = FALSE,
    outFile = getOption("try.outFile", default = stderr()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="try_+3A_expr">expr</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> expression to try.</p>
</td></tr>
<tr><td><code id="try_+3A_silent">silent</code></td>
<td>
<p>logical: should the report of error messages be
suppressed?</p>
</td></tr>
<tr><td><code id="try_+3A_outfile">outFile</code></td>
<td>
<p>a <a href="#topic+connection">connection</a>, or a character string naming the
file to print to (via <code><a href="#topic+cat">cat</a>(*, file = outFile)</code>);
used only if <code>silent</code> is false, as by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>try</code> evaluates an expression and traps any errors that occur
during the evaluation.  If an error occurs then the error
message is printed to the <code><a href="#topic+stderr">stderr</a></code> connection unless
<code>options("show.error.messages")</code> is false or
the call includes <code>silent = TRUE</code>.  The error message is also
stored in a buffer where it can be retrieved by
<code>geterrmessage</code>. (This should not be needed as the value returned
in case of an error contains the error message.)
</p>
<p><code>try</code> is implemented using <code><a href="#topic+tryCatch">tryCatch</a></code>; for
programming, instead of <code>try(expr, silent = TRUE)</code>, something like
<code>tryCatch(expr, error = function(e) e)</code> (or other simple
error handler functions) may be more efficient and flexible.
</p>
<p>It may be useful to set the default for <code>outFile</code> to
<code><a href="#topic+stdout">stdout</a>()</code>, i.e., </p>
<pre>  options(try.outFile = stdout()) </pre>
<p>instead of the default <code><a href="#topic+stderr">stderr</a>()</code>,
notably when <code>try()</code> is used inside a <code><a href="utils.html#topic+Sweave">Sweave</a></code> code
chunk and the error message should appear in the resulting document.
</p>


<h3>Value</h3>

<p>The value of the expression if <code>expr</code> is evaluated without error:
otherwise an invisible object inheriting from class <code>"try-error"</code>
containing the error message with the error condition as the
<code>"condition"</code> attribute.
</p>


<h3>Warning</h3>

<p>Do not test</p>
<pre>
    if (class(res) == "try-error"))
</pre>
<p>as if there is no error, the result might (now or in future) have a
class of length &gt; 1. Use <code>if(<a href="#topic+inherits">inherits</a>(res, "try-error"))</code>
instead.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+options">options</a></code> for setting error handlers and suppressing the
printing of error messages;
<code><a href="#topic+geterrmessage">geterrmessage</a></code> for retrieving the last error message.
The underlying <code><a href="#topic+tryCatch">tryCatch</a></code> provides more flexible means of
catching and handling errors.
</p>
<p><code><a href="tools.html#topic+assertCondition">assertCondition</a></code> in package <span class="pkg">tools</span> is related and
useful for testing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## this example will not work correctly in example(try), but
## it does work correctly if pasted in
options(show.error.messages = FALSE)
try(log("a"))
print(.Last.value)
options(show.error.messages = TRUE)

## alternatively,
print(try(log("a"), TRUE))

## run a simulation, keep only the results that worked.
set.seed(123)
x &lt;- stats::rnorm(50)
doit &lt;- function(x)
{
    x &lt;- sample(x, replace = TRUE)
    if(length(unique(x)) &gt; 30) mean(x)
    else stop("too few unique points")
}
## alternative 1
res &lt;- lapply(1:100, function(i) try(doit(x), TRUE))
## alternative 2
## Not run: res &lt;- vector("list", 100)
for(i in 1:100) res[[i]] &lt;- try(doit(x), TRUE)
## End(Not run)
unlist(res[sapply(res, function(x) !inherits(x, "try-error"))])
</code></pre>

<hr>
<h2 id='typeof'>The Type of an Object</h2><span id='topic+typeof'></span><span id='topic+type'></span>

<h3>Description</h3>

<p><code>typeof</code> determines the (<span class="rlang"><b>R</b></span> internal)
type or storage mode of any object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>typeof(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="typeof_+3A_x">x</code></td>
<td>
<p>any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string.  The possible values are listed in the structure
<code>TypeTable</code> in &lsquo;<span class="file">src/main/util.c</span>&rsquo;. Current values are
the vector types <code>"logical"</code>, <code>"integer"</code>, <code>"double"</code>,
<code>"complex"</code>, <code>"character"</code>, <code>"raw"</code> and <code>"list"</code>,
<code>"NULL"</code>,
<code>"closure"</code> (function), <code>"special"</code> and <code>"builtin"</code>
(basic functions and operators), <code>"environment"</code>, <code>"S4"</code>
(some S4 objects) and others that are unlikely to be seen at user
level (<code>"symbol"</code>, <code>"pairlist"</code>, <code>"promise"</code>,
<code>"object"</code>,
<code>"language"</code>, <code>"char"</code>, <code>"..."</code>, <code>"any"</code>,
<code>"expression"</code>, <code>"externalptr"</code>, <code>"bytecode"</code> and
<code>"weakref"</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mode">mode</a></code>, <code><a href="#topic+storage.mode">storage.mode</a></code>.
</p>
<p><code><a href="#topic+isS4">isS4</a></code> to determine if an object has an S4 class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>typeof(2)
mode(2)
## for a table of examples, see  ?mode  /  examples(mode)
</code></pre>

<hr>
<h2 id='unique'>Extract Unique Elements</h2><span id='topic+unique'></span><span id='topic+unique.default'></span><span id='topic+unique.data.frame'></span><span id='topic+unique.matrix'></span><span id='topic+unique.array'></span>

<h3>Description</h3>

<p><code>unique</code> returns a vector, data frame or array like <code>x</code>
but with duplicate elements/rows removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique(x, incomparables = FALSE, ...)

## Default S3 method:
unique(x, incomparables = FALSE, fromLast = FALSE,
        nmax = NA, ...)

## S3 method for class 'matrix'
unique(x, incomparables = FALSE, MARGIN = 1,
       fromLast = FALSE, ...)

## S3 method for class 'array'
unique(x, incomparables = FALSE, MARGIN = 1,
       fromLast = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unique_+3A_x">x</code></td>
<td>
<p>a vector or a data frame or an array or <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="unique_+3A_incomparables">incomparables</code></td>
<td>
<p>a vector of values that cannot be compared.
<code>FALSE</code> is a special value, meaning that all values can be
compared, and may be the only value accepted for methods other than
the default.  It will be coerced internally to the same type as
<code>x</code>.</p>
</td></tr>
<tr><td><code id="unique_+3A_fromlast">fromLast</code></td>
<td>
<p>logical indicating if duplication should be considered
from the last, i.e., the last (or rightmost) of identical elements will
be kept.  This only matters for <code><a href="#topic+names">names</a></code> or
<code><a href="#topic+dimnames">dimnames</a></code>.</p>
</td></tr>
<tr><td><code id="unique_+3A_nmax">nmax</code></td>
<td>
<p>the maximum number of unique items expected (greater than one).
See <code><a href="#topic+duplicated">duplicated</a></code>.</p>
</td></tr>
<tr><td><code id="unique_+3A_...">...</code></td>
<td>
<p>arguments for particular methods.</p>
</td></tr>
<tr><td><code id="unique_+3A_margin">MARGIN</code></td>
<td>
<p>the array margin to be held fixed: a single integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function with methods for vectors, data frames and
arrays (including matrices).
</p>
<p>The array method calculates for each element of the dimension
specified by <code>MARGIN</code> if the remaining dimensions are identical
to those for an earlier element (in row-major order).  This would most
commonly be used for matrices to find unique rows (the default) or columns
(with <code>MARGIN = 2</code>).
</p>
<p>Note that unlike the Unix command <code>uniq</code> this omits
<em>duplicated</em> and not just <em>repeated</em> elements/rows.  That
is, an element is omitted if it is equal to any previous element and
not just if it is equal the immediately previous one.  (For the
latter, see <code><a href="#topic+rle">rle</a></code>).
</p>
<p>Missing values (<code>"<a href="#topic+NA">NA</a>"</code>) are regarded as equal, numeric and
complex ones differing from <code>NaN</code>; character strings will be compared in a
&ldquo;common encoding&rdquo;; for details, see <code><a href="#topic+match">match</a></code> (and
<code><a href="#topic+duplicated">duplicated</a></code>) which use the same concept.
</p>
<p>Values in <code>incomparables</code> will never be marked as duplicated.
This is intended to be used for a fairly small set of values and will
not be efficient for a very large set.
</p>
<p>When used on a data frame with more than one column, or an array or
matrix when comparing dimensions of length greater than one, this
tests for identity of character representations.  This will
catch people who unwisely rely on exact equality of floating-point
numbers!
</p>


<h3>Value</h3>

<p>For a vector, an object of the same type of <code>x</code>, but with only
one copy of each duplicated element.  No attributes are copied (so
the result has no names).
</p>
<p>For a data frame, a data frame is returned with the same columns but
possibly fewer rows (and with row names from the first occurrences of
the unique rows).
</p>
<p>A matrix or array is subsetted by <code>[, drop = FALSE]</code>, so
dimensions and dimnames are copied appropriately, and the result
always has the same number of dimensions as <code>x</code>.
</p>


<h3>Warning</h3>

<p>Using this for lists is potentially slow, especially if the elements
are not atomic vectors (see <code><a href="#topic+vector">vector</a></code>) or differ only
in their attributes.  In the worst case it is <code class="reqn">O(n^2)</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+duplicated">duplicated</a></code> which gives the indices of duplicated
elements.
</p>
<p><code><a href="#topic+rle">rle</a></code> which is the equivalent of the Unix <code>uniq -c</code>
command.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(3:5, 11:8, 8 + 0:5)
(ux &lt;- unique(x))
(u2 &lt;- unique(x, fromLast = TRUE)) # different order
stopifnot(identical(sort(ux), sort(u2)))

length(unique(sample(100, 100, replace = TRUE)))
## approximately 100(1 - 1/e) = 63.21

unique(iris)
</code></pre>

<hr>
<h2 id='units'>Units</h2><span id='topic+units'></span><span id='topic+units+3C-'></span>

<h3>Description</h3>

<p>Get or set units.</p>


<h3>Usage</h3>

<pre><code class='language-R'>units(x)
units(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="units_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object</p>
</td></tr>
<tr><td><code id="units_+3A_value">value</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are generic functions, with methods for <code>"<a href="#topic+difftime">difftime</a>"</code>
objects.
</p>

<hr>
<h2 id='unlink'>Delete Files and Directories</h2><span id='topic+unlink'></span>

<h3>Description</h3>

<p><code>unlink</code> deletes the file(s) or directories specified by <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unlink(x, recursive = FALSE, force = FALSE, expand = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unlink_+3A_x">x</code></td>
<td>
<p>a character vector with the names of the file(s) or
directories to be deleted.</p>
</td></tr>
<tr><td><code id="unlink_+3A_recursive">recursive</code></td>
<td>
<p>logical.  Should directories be deleted recursively?</p>
</td></tr>
<tr><td><code id="unlink_+3A_force">force</code></td>
<td>
<p>logical.  Should permissions be changed (if possible) to
allow the file or directory to be removed?</p>
</td></tr>
<tr><td><code id="unlink_+3A_expand">expand</code></td>
<td>
<p>logical. Should wildcards (see &lsquo;Details&rsquo; below) and
tilde (see <code><a href="#topic+path.expand">path.expand</a></code>) be expanded?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>recursive = FALSE</code> directories are not deleted,
not even empty ones.
</p>
<p>On most platforms &lsquo;file&rsquo; includes symbolic links, fifos and
sockets.  <code>unlink(x, recursive = TRUE)</code>
deletes just the symbolic link if the target of such a link is a directory.
</p>
<p>Wildcard expansion (normally &lsquo;<span class="file">*</span>&rsquo; and &lsquo;<span class="file">?</span>&rsquo; are allowed) is done by
the internal code of <code><a href="#topic+Sys.glob">Sys.glob</a></code>.  Wildcards never match a
leading &lsquo;<span class="file">.</span>&rsquo; in the filename, and files &lsquo;<span class="file">.</span>&rsquo;, &lsquo;<span class="file">..</span>&rsquo; and
&lsquo;<span class="file">~</span>&rsquo; will never be considered for deletion.
Wildcards will only be expanded if the system supports it.  Most
systems will support not only &lsquo;<span class="file">*</span>&rsquo; and &lsquo;<span class="file">?</span>&rsquo; but also character
classes such as &lsquo;<span class="file">[a-z]</span>&rsquo; (see the <code>man</code> pages for the system
call <code>glob</code> on your OS).  The metacharacters <code>* ? [</code> can
occur in Unix filenames, and this makes it difficult to use
<code>unlink</code> to delete such files (see <code><a href="#topic+file.remove">file.remove</a></code>),
although escaping the metacharacters by backslashes usually works.  If
a metacharacter matches nothing it is considered as a literal
character.
</p>
<p><code>recursive = TRUE</code> might not be supported on all platforms, when it
will be ignored, with a warning: however there are no known current
examples.
</p>


<h3>Value</h3>

<p><code>0</code> for success, <code>1</code> for failure, invisibly.
Not deleting a non-existent file is not a failure, nor is being unable
to delete a directory if <code>recursive = FALSE</code>.  However, missing
values in <code>x</code> are regarded as failures.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+file.remove">file.remove</a></code>.
</p>

<hr>
<h2 id='unlist'>Flatten Lists</h2><span id='topic+unlist'></span>

<h3>Description</h3>

<p>Given a list structure <code>x</code>, <code>unlist</code> simplifies it to
produce a vector which contains all the atomic components
which occur in <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unlist(x, recursive = TRUE, use.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unlist_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object, typically a list or vector.</p>
</td></tr>
<tr><td><code id="unlist_+3A_recursive">recursive</code></td>
<td>
<p>logical.  Should unlisting be applied to list
components of <code>x</code>?</p>
</td></tr>
<tr><td><code id="unlist_+3A_use.names">use.names</code></td>
<td>
<p>logical.  Should names be preserved?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>unlist</code> is generic: you can write methods to handle
specific classes of objects, see <a href="#topic+InternalMethods">InternalMethods</a>,
and note, e.g., <code><a href="utils.html#topic+relist">relist</a></code> with the <code>unlist</code> method
for <code>relistable</code> objects.
</p>
<p>If <code>recursive = FALSE</code>, the function will not recurse beyond the
first level items in <code>x</code>.
</p>
<p>Factors are treated specially.  If all non-list elements of <code>x</code>
are <code><a href="#topic+factor">factor</a></code> (or ordered factor) objects then the result
will be a factor with
levels the union of the level sets of the elements, in the order the
levels occur in the level sets of the elements (which means that if
all the elements have the same level set, that is the level set of the
result).
</p>
<p><code>x</code> can be an atomic vector, but then <code>unlist</code> does nothing useful,
not even drop names.
</p>
<p>By default, <code>unlist</code> tries to retain the naming
information present in <code>x</code>.  If <code>use.names = FALSE</code> all
naming information is dropped.
</p>
<p>Where possible the list elements are coerced to a common mode during
the unlisting, and so the result often ends up as a character
vector.  Vectors will be coerced to the highest type of the components
in the hierarchy NULL &lt; raw &lt; logical &lt; integer &lt; double &lt; complex &lt; character
&lt; list &lt; expression: pairlists are treated as lists.
</p>
<p>A list is a (generic) vector, and the simplified vector might still be
a list (and might be unchanged).  Non-vector elements of the list
(for example language elements such as names, formulas and calls)
are not coerced, and so a list containing one or more of these remains a
list.  (The effect of unlisting an <code><a href="stats.html#topic+lm">lm</a></code> fit is a list which
has individual residuals as components.)
Note that <code>unlist(x)</code> now returns <code>x</code> unchanged also for
non-vector <code>x</code>, instead of signalling an error in that case.
</p>


<h3>Value</h3>

<p><code>NULL</code> or an expression or a vector of an appropriate mode to
hold the list components.
</p>
<p>The output type is determined from the highest type
of the components in the hierarchy NULL &lt; raw &lt; logical &lt; integer &lt; double &lt;
complex &lt; character &lt; list &lt; expression, after coercion of pairlists
to lists.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+c">c</a></code>, <code><a href="#topic+as.list">as.list</a></code>, <code><a href="utils.html#topic+relist">relist</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>unlist(options())
unlist(options(), use.names = FALSE)

l.ex &lt;- list(a = list(1:5, LETTERS[1:5]), b = "Z", c = NA)
unlist(l.ex, recursive = FALSE)
unlist(l.ex, recursive = TRUE)

l1 &lt;- list(a = "a", b = 2, c = pi+2i)
unlist(l1) # a character vector
l2 &lt;- list(a = "a", b = as.name("b"), c = pi+2i)
unlist(l2) # remains a list

ll &lt;- list(as.name("sinc"), quote( a + b ), 1:10, letters, expression(1+x))
utils::str(ll)
for(x in ll)
  stopifnot(identical(x, unlist(x)))
</code></pre>

<hr>
<h2 id='unname'>Remove <code>names</code> or <code>dimnames</code></h2><span id='topic+unname'></span>

<h3>Description</h3>

<p>Remove the <code><a href="#topic+names">names</a></code> or <code><a href="#topic+dimnames">dimnames</a></code> attribute of
an <span class="rlang"><b>R</b></span> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unname(obj, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unname_+3A_obj">obj</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="unname_+3A_force">force</code></td>
<td>
<p>logical; if true, the <code>dimnames</code> (names and row
names) are removed even from <code><a href="#topic+data.frame">data.frame</a></code>s.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object as <code>obj</code> but without <code><a href="#topic+names">names</a></code> or
<code><a href="#topic+dimnames">dimnames</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics); require(stats)

## Answering a question on R-help (14 Oct 1999):
col3 &lt;- 750+ 100*rt(1500, df = 3)
breaks &lt;- factor(cut(col3, breaks = 360+5*(0:155)))
z &lt;- table(breaks)
z[1:5] # The names are larger than the data ...
barplot(unname(z), axes = FALSE)
</code></pre>

<hr>
<h2 id='use'>Use Packages</h2><span id='topic+use'></span>

<h3>Description</h3>

<p>Use packages in R scripts by loading their namespace and attaching a
package environment including (a subset of) their exports to the
search path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use(package, include.only)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_+3A_package">package</code></td>
<td>
<p>a character string given the name of a package.</p>
</td></tr>
<tr><td><code id="use_+3A_include.only">include.only</code></td>
<td>
<p>character vector of names of objects to
include in the attached environment frame.  If missing, all exports
are included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple wrapper around <code><a href="#topic+library">library</a></code> which always
uses <code>attach.required = FALSE</code>, so that packages listed in the
<code>Depends</code> clause of the <code>DESCRIPTION</code> file of the package to
be used never get attached automatically to the search path.
</p>
<p>This therefore allows to write R scripts with full control over what
gets found on the search path.  In addition, such scripts can easily
be integrated as package code, replacing the calls to <code>use</code> by
the corresponding <code>ImportFrom</code> directives in &lsquo;<span class="file">NAMESPACE</span>&rsquo;
files.
</p>


<h3>Value</h3>

<p>(invisibly) a logical indicating whether the package to be used is
available.
</p>


<h3>Note</h3>

<p>This functionality is still experimental: interfaces may change in
future versions.
</p>

<hr>
<h2 id='UseMethod'>Class Methods</h2><span id='topic+UseMethod'></span><span id='topic+NextMethod'></span><span id='topic+S3Methods'></span><span id='topic+.Method'></span><span id='topic+.Generic'></span><span id='topic+.Class'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> possesses a simple generic function mechanism which can be used for
an object-oriented style of programming.  Method dispatch takes place
based on the class(es) of the first argument to the generic function or of
the object supplied as an argument to <code>UseMethod</code> or <code>NextMethod</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UseMethod(generic, object)

NextMethod(generic = NULL, object = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UseMethod_+3A_generic">generic</code></td>
<td>
<p>a character string naming a function (and not a
built-in operator).  Required for <code>UseMethod</code>.</p>
</td></tr>
<tr><td><code id="UseMethod_+3A_object">object</code></td>
<td>
<p>for <code>UseMethod</code>: an object whose class will
determine the method to be dispatched.  Defaults to the first
argument of the enclosing function.</p>
</td></tr>
<tr><td><code id="UseMethod_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the next method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An <span class="rlang"><b>R</b></span> object is a data object which has a <code>class</code>
attribute (and this can be tested by <code><a href="#topic+is.object">is.object</a></code>).
A class attribute is a character vector giving the names of
the classes from which the object <em>inherits</em>.
</p>
<p>If the object does not have a class attribute, it has an
<em>implicit class</em>.  Matrices and arrays have class <code>"matrix"</code>
or <code>"array"</code> followed by the class of the underlying vector.
Most vectors have class the result of <code><a href="#topic+mode">mode</a>(x)</code>, except
that integer vectors have class <code>c("integer", "numeric")</code> and
real vectors have class <code>c("double", "numeric")</code>.
Function <code><a href="#topic+.class2">.class2</a>(x)</code> (since <span class="rlang"><b>R</b></span> 4.0.x) returns the full
implicit (or explicit) class vector of <code>x</code>.
</p>
<p>When a function calling <code>UseMethod("fun")</code> is applied to an
object with class vector <code>c("first", "second")</code>, the system
searches for a function called <code>fun.first</code> and, if it finds it,
applies it to the object.  If no such function is found a function
called <code>fun.second</code> is tried.  If no class name produces a
suitable function, the function <code>fun.default</code> is used, if it
exists, or an error results.
</p>
<p>Function <code><a href="utils.html#topic+methods">methods</a></code> can be used to find out about the
methods for a particular generic function or class.
</p>
<p><code>UseMethod</code> is a primitive function but uses standard argument
matching.  It is not the only means of dispatch of methods, for there
are <a href="#topic+internal+20generic">internal generic</a> and <a href="#topic+group+20generic">group generic</a> functions.
<code>UseMethod</code> currently dispatches on the implicit class even for
arguments that are not objects, but the other means of dispatch do
not.
</p>
<p><code>NextMethod</code> invokes the next method (determined by the
class vector, either of the object supplied to the generic, or of
the first argument to the function containing <code>NextMethod</code> if a
method was invoked directly).  Normally <code>NextMethod</code> is used with
only one argument, <code>generic</code>, but if further arguments are
supplied these modify the call to the next method.
</p>
<p><code>NextMethod</code> should not be called except in methods called by
<code>UseMethod</code> or from internal generics (see
<a href="#topic+InternalGenerics">InternalGenerics</a>).  In particular it will not work inside
anonymous calling functions (e.g., <code>get("print.ts")(AirPassengers)</code>).
</p>
<p>Namespaces can register methods for generic functions.  To support
this, <code>UseMethod</code> and <code>NextMethod</code> search for methods in
two places: in the environment in which the generic function
is called, and in the registration data base for the
environment in which the generic is defined (typically a namespace).
So methods for a generic function need to be available in the
environment of the call to the generic, or they must be registered.
(It does not matter whether they are visible in the environment in
which the generic is defined.)  As from <span class="rlang"><b>R</b></span> 3.5.0, the registration
data base is searched after the top level environment (see
<code><a href="#topic+topenv">topenv</a></code>) of the calling environment (but before the
parents of the top level environment).
</p>


<h3>Technical Details</h3>

<p>Now for some obscure details that need to appear somewhere.  These
comments will be slightly different than those in Chambers(1992).
(See also the draft &lsquo;R Language Definition&rsquo;.)
<code>UseMethod</code> creates a new function call with
arguments matched as they came in to the generic.  [Previously local
variables defined before the call to <code>UseMethod</code> were retained;
as of <span class="rlang"><b>R</b></span> 4.4.0 this is no longer the case.] Any
statements after the call to <code>UseMethod</code> will not be evaluated as
<code>UseMethod</code> does not return.  <code>UseMethod</code> can be called with
more than two arguments: a warning will be given and additional
arguments ignored.  (They are not completely ignored in S.)  If it is
called with just one argument, the class of the first argument of the
enclosing function is used as <code>object</code>: unlike S this is the first
actual argument passed and not the current value of the object of that
name.
</p>
<p><code>NextMethod</code> works by creating a special call frame for the next
method.  If no new arguments are supplied, the arguments will be the
same in number, order and name as those to the current method but
their values will be promises to evaluate their name in the current
method and environment.  Any named arguments matched to <code>...</code>
are handled specially: they either replace existing arguments of the
same name or are appended to the argument list.  They are passed on as
the promise that was supplied as an argument to the current
environment.  (S does this differently!)  If they have been evaluated
in the current (or a previous environment) they remain evaluated.
(This is a complex area, and subject to change: see the draft
&lsquo;R Language Definition&rsquo;.)
</p>
<p>The search for methods for <code>NextMethod</code> is slightly different
from that for <code>UseMethod</code>.   Finding no <code>fun.default</code> is not
necessarily an error, as the search continues to the generic
itself.  This is to pick up an <a href="#topic+internal+20generic">internal generic</a> like <code>[</code>
which has no separate default method, and succeeds only if the generic
is a <a href="#topic+primitive">primitive</a> function or a wrapper for a
<code><a href="#topic+.Internal">.Internal</a></code> function of the same name.  (When a primitive
is called as the default method, argument matching may not work as
described above due to the different semantics of primitives.)
</p>
<p>You will see objects such as <code>.Generic</code>, <code>.Method</code>, and
<code>.Class</code> used in methods.  These are set in the environment
within which the method is evaluated by the dispatch mechanism, which
is as follows:
</p>

<ol>
<li><p> Find the context for the calling function (the generic): this
gives us the unevaluated arguments for the original call.
</p>
</li>
<li><p> Evaluate the object (usually an argument) to be used for
dispatch, and find a method (possibly the default method) or throw
an error.
</p>
</li>
<li><p> Create an environment for evaluating the method and insert
special variables (see below) into that environment.  Also copy any
variables in the environment of the generic that are not formal (or
actual) arguments.
</p>
</li>
<li><p> Fix up the argument list to be the arguments of the call
matched to the formals of the method.
</p>
</li></ol>

<p><code>.Generic</code> is a length-one character vector naming the generic function.
</p>
<p><code>.Method</code> is a character vector (normally of length one) naming
the method function.  (For functions in the group generic
<code><a href="#topic+S3groupGeneric">Ops</a></code> it is of length two.)
</p>
<p><code>.Class</code> is a character vector of classes used to find the next
method.  <code>NextMethod</code> adds an attribute <code>"previous"</code> to
<code>.Class</code> giving the <code>.Class</code> last used for dispatch, and
shifts <code>.Class</code> along to that used for dispatch.
</p>
<p><code>.GenericCallEnv</code> and <code>.GenericDefEnv</code> are the environments
of the call to be generic and defining the generic respectively.  (The
latter is used to find methods registered for the generic.)
</p>
<p>Note that <code>.Class</code> is set when the generic is called, and is
unchanged if the class of the dispatching argument is changed in a
method.  It is possible to change the method that <code>NextMethod</code>
would dispatch by manipulating <code>.Class</code>, but &lsquo;this is not
recommended unless you understand the inheritance mechanism
thoroughly&rsquo; (Chambers &amp; Hastie, 1992, p. 469).
</p>


<h3>Note</h3>

<p>This scheme is called <em>S3</em> (S version 3).  For new projects,
it is recommended to use the more flexible and robust <em>S4</em> scheme
provided in the <span class="pkg">methods</span> package.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Classes and methods: object-oriented programming in S.</em>
Appendix A of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p>The draft &lsquo;R Language Definition&rsquo;.
</p>
<p><code><a href="utils.html#topic+methods">methods</a></code>, <code><a href="#topic+class">class</a></code> incl <code><a href="#topic+.class2">.class2</a>()</code>;
<code><a href="utils.html#topic+getS3method">getS3method</a></code>, <code><a href="#topic+is.object">is.object</a></code>.
</p>

<hr>
<h2 id='userhooks'>Functions to Get and Set Hooks for Load, Attach, Detach and Unload</h2><span id='topic+getHook'></span><span id='topic+setHook'></span><span id='topic+packageEvent'></span><span id='topic+.userHooksEnv'></span>

<h3>Description</h3>

<p>These functions allow users to set actions to be taken before packages
are attached/detached and namespaces are (un)loaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHook(hookName)
setHook(hookName, value,
        action = c("append", "prepend", "replace"))

packageEvent(pkgname,
             event = c("onLoad", "attach", "detach", "onUnload"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="userhooks_+3A_hookname">hookName</code></td>
<td>
<p>character string: the hook name.</p>
</td></tr>
<tr><td><code id="userhooks_+3A_pkgname">pkgname</code></td>
<td>
<p>character string: the package/namespace name.</p>
</td></tr>
<tr><td><code id="userhooks_+3A_event">event</code></td>
<td>
<p>character string: an event for the package.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="userhooks_+3A_value">value</code></td>
<td>
<p>a function or a list of functions, or for <code>action = "replace"</code>, <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="userhooks_+3A_action">action</code></td>
<td>
<p>the action to be taken.  Can be abbreviated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>setHook</code> provides a general mechanism for users to register
hooks, a list of functions to be called from system (or user)
functions.  The initial set of hooks was associated with events on
packages/namespaces: these hooks are named via calls to
<code>packageEvent</code>.
</p>
<p>To remove a hook completely, call <code>setHook(hookName, NULL, "replace")</code>.
</p>
<p>When an <span class="rlang"><b>R</b></span> package is attached by <code><a href="#topic+library">library</a></code> or loaded by
other means, it can call initialization code.  See
<code><a href="#topic+.onLoad">.onLoad</a></code> for a description of the package hook functions
called during initialization.  Users can add their own initialization
code via the hooks provided by <code>setHook()</code>, functions which will
be called as <code>funname(pkgname, pkgpath)</code> inside a
<code><a href="#topic+try">try</a></code> call.
</p>
<p>The sequence of events depends on which hooks are defined, and whether
a package is attached or just loaded.  In the case where all hooks
are defined and a package is attached, the order of initialization
events is as follows:
</p>

<ol>
<li><p> The package namespace is loaded.
</p>
</li>
<li><p> The package's <code><a href="#topic+.onLoad">.onLoad</a></code> function is run.
</p>
</li>
<li><p> If S4 methods dispatch is on, any actions set by
<code><a href="methods.html#topic+setLoadAction">setLoadAction</a></code> are run.
</p>
</li>
<li><p> The namespace is sealed.
</p>
</li>
<li><p> The user's <code>"onLoad"</code> hook is run.
</p>
</li>
<li><p> The package is added to the search path.
</p>
</li>
<li><p> The package's <code><a href="#topic+.onAttach">.onAttach</a></code> function is run.
</p>
</li>
<li><p> The package environment is sealed.
</p>
</li>
<li><p> The user's <code>"attach"</code> hook is run.
</p>
</li></ol>

<p>A similar sequence (but in reverse) is run when a package is detached
and its namespace unloaded:
</p>

<ol>
<li><p> The user's <code>"detach"</code> hook is run.
</p>
</li>
<li><p> The package's <code><a href="#topic+.Last.lib">.Last.lib</a></code> function is run.
</p>
</li>
<li><p> The package is removed from the search path.
</p>
</li>
<li><p> The user's <code>"onUnload"</code> hook is run.
</p>
</li>
<li><p> The package's <code><a href="#topic+.onUnload">.onUnload</a></code> function is run.
</p>
</li>
<li><p> The package namespace is unloaded.
</p>
</li></ol>

<p>Note that when an <span class="rlang"><b>R</b></span> session is finished, packages are not detached and
namespaces are not unloaded, so the corresponding hooks will not be
run.
</p>
<p>Also note that some of the user hooks are run without the package
being on the search path, so in those hooks objects in the package
need to be referred to using the double (or triple) colon operator,
as in the example.
</p>
<p>If multiple hooks are added, they are normally run in the order shown
by <code>getHook</code>, but the <code>"detach"</code> and <code>"onUnload"</code> hooks
are run in reverse order so the default for package events is to add
hooks &lsquo;inside&rsquo; existing ones.
</p>
<p>The hooks are stored in the environment <code>.userHooksEnv</code> in the
base package, with &lsquo;mangled&rsquo; names.
</p>


<h3>Value</h3>

<p>For <code>getHook</code> function, a list of functions (possibly empty).
For <code>setHook</code> function, no return value.
For <code>packageEvent</code>, the derived hook name (a character string).
</p>


<h3>Note</h3>

<p>Hooks need to be set before the event they modify: for standard
packages this can be problematic as <span class="pkg">methods</span> is loaded and
attached early in the startup sequence.   The usual place to set hooks
such as the example below is in the &lsquo;<span class="file">.Rprofile</span>&rsquo; file, but that
will not work for <span class="pkg">methods</span>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+library">library</a></code>, <code><a href="#topic+detach">detach</a></code>, <code><a href="#topic+loadNamespace">loadNamespace</a></code>.
</p>
<p>See <code><a href="#topic++3A+3A">::</a></code>
for a discussion of the double and triple colon operators.
</p>
<p>Other hooks may be added later: functions <code><a href="graphics.html#topic+plot.new">plot.new</a></code> and
<code><a href="graphics.html#topic+persp">persp</a></code> already have them.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>setHook(packageEvent("grDevices", "onLoad"),
        function(...) grDevices::ps.options(horizontal = FALSE))
</code></pre>

<hr>
<h2 id='utf8Conversion'>Convert Integer Vectors to or from UTF-8-encoded Character Vectors</h2><span id='topic+utf8ToInt'></span><span id='topic+intToUtf8'></span><span id='topic+Unicode'></span><span id='topic+code+20point'></span>

<h3>Description</h3>

<p>Conversion of UTF-8 encoded character vectors to and from integer
vectors representing a UTF-32 encoding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utf8ToInt(x)
intToUtf8(x, multiple = FALSE, allow_surrogate_pairs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utf8Conversion_+3A_x">x</code></td>
<td>
<p>object to be converted.</p>
</td></tr>
<tr><td><code id="utf8Conversion_+3A_multiple">multiple</code></td>
<td>
<p>logical: should the conversion be to a single
character string or multiple individual characters?</p>
</td></tr>
<tr><td><code id="utf8Conversion_+3A_allow_surrogate_pairs">allow_surrogate_pairs</code></td>
<td>
<p>logical: should interpretation of
surrogate pairs be attempted?  (See &lsquo;Details&rsquo;.)
Only supported for <code>multiple = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These will work in any locale, including on platforms that do not
otherwise support multi-byte character sets.
</p>
<p>Unicode defines a name and a number of all of the glyphs it
encompasses: the numbers are called <em>code points</em>: since RFC3629
they run from <code>0</code> to <code>0x10FFFF</code> (with about 5% being
assigned by version 13.0 of the Unicode standard and 7% reserved for
&lsquo;private use&rsquo;).
</p>
<p><code>intToUtf8</code> does not by default handle surrogate pairs: inputs in
the surrogate ranges are mapped to <code>NA</code>.  They might occur if a
UTF-16 byte stream has been read as 2-byte integers (in the correct
byte order), in which case <code>allow_surrogate_pairs = TRUE</code> will
try to interpret them (with unmatched surrogate values still treated
as <code>NA</code>).
</p>


<h3>Value</h3>

<p><code>utf8ToInt</code> converts a length-one character string encoded in
UTF-8 to an integer vector of Unicode code points.
</p>
<p><code>intToUtf8</code> converts a numeric vector of Unicode code points
either (default) to a single character string or a character vector of
single characters. Non-integral numeric values are truncated to
integers.  For output to a single character string <code>0</code> is
silently omitted: otherwise <code>0</code> is mapped to <code>""</code>.  The
<code><a href="#topic+Encoding">Encoding</a></code> of a non-<code>NA</code> return value is declared as
<code>"UTF-8"</code>.
</p>
<p>Invalid and <code>NA</code> inputs are mapped to <code>NA</code> output.
</p>


<h3>Validity</h3>

<p>Which code points are regarded as valid has changed over the lifetime
of UTF-8.  Originally all 32-bit unsigned integers were potentially
valid and could be converted to up to 6 bytes in UTF-8.  Since 2003 it
has been stated that there will never be valid code points larger than
<code>0x10FFFF</code>, and so valid UTF-8 encodings are never more than 4
bytes.
</p>
<p>The code points in the surrogate-pair range <code>0xD800</code> to
<code>0xDFFF</code> are prohibited in UTF-8 and so are regarded as invalid
by <code>utf8ToInt</code> and by default by <code>intToUtf8</code>.
</p>
<p>The position of &lsquo;noncharacters&rsquo; (notably <code>0xFFFE</code> and
<code>0xFFFF</code>) was clarified by &lsquo;Corrigendum 9&rsquo; in 2013.  These
are valid but will never be given an official interpretation.  (In some
earlier versions of <span class="rlang"><b>R</b></span> <code>utf8ToInt</code> treated them as invalid.)

</p>


<h3>References</h3>

<p><a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>, the current standard for UTF-8.
</p>
<p><a href="https://www.unicode.org/versions/corrigendum9.html">https://www.unicode.org/versions/corrigendum9.html</a> for non-characters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## will only display in some locales and fonts
intToUtf8(0x03B2L) # Greek beta

utf8ToInt("bi\u00dfchen")
utf8ToInt("\xfa\xb4\xbf\xbf\x9f")

## A valid UTF-16 surrogate pair (for U+10437)
x &lt;- c(0xD801, 0xDC37)
intToUtf8(x)
intToUtf8(x, TRUE)
(xx &lt;- intToUtf8(x, , TRUE)) # will only display in some locales and fonts
charToRaw(xx)

## An example of how surrogate pairs might occur
x &lt;- "\U10437"
charToRaw(x)
foo &lt;- tempfile()
writeLines(x, file(foo, encoding = "UTF-16LE"))
## next two are OS-specific, but are mandated by POSIX
system(paste("od -x", foo)) # 2-byte units, correct on little-endian platforms
system(paste("od -t x1", foo)) # single bytes as hex
y &lt;- readBin(foo, "integer", 2, 2, FALSE, endian = "little")
sprintf("%X", y)
intToUtf8(y, , TRUE)

</code></pre>

<hr>
<h2 id='UTF8filepaths'>File Paths not in the Native Encoding</h2><span id='topic+file+20path+20encoding'></span><span id='topic+UTF-8+20file+20path'></span>

<h3>Description</h3>

<p>Most modern file systems store file-path components (names of
directories and files) in a character encoding of wide scope: usually
UTF-8 on a Unix-alike and UCS-2/UTF-16 on Windows.  However, this was
not true when <span class="rlang"><b>R</b></span> was first developed and there are still exceptions
amongst file systems, e.g. FAT32.
</p>
<p>This was not something anticipated by the C and POSIX standards which
only provide means to access files <em>via</em> file paths encoded in
the current locale, for example those specified in Latin-1 in a
Latin-1 locale.
</p>
<p>Everything here apart from the specific section on Windows is about
Unix-alikes.
</p>


<h3>Details</h3>

<p>It is possible to mark character strings (elements of character
vectors) as being in UTF-8 or Latin-1 (see <code><a href="#topic+Encoding">Encoding</a></code>).
This allows file paths not in the native encoding to be
expressed in <span class="rlang"><b>R</b></span> character vectors but there is almost no way to use
them unless they can be translated to the native encoding.  That is of
course not a problem if that is UTF-8, so these details are really only
relevant to the use of a non-UTF-8 locale (including a C locale) on a
Unix-alike.
</p>
<p>Functions to open a file such as <code><a href="#topic+file">file</a></code>,
<code><a href="#topic+fifo">fifo</a></code>, <code><a href="#topic+pipe">pipe</a></code>, <code><a href="#topic+gzfile">gzfile</a></code>,
<code><a href="#topic+bzfile">bzfile</a></code>, <code><a href="#topic+xzfile">xzfile</a></code> and <code><a href="#topic+unz">unz</a></code> give
an error for non-native filepaths.  Where functions look at existence
such as <code>file.exists</code>, <code><a href="#topic+dir.exists">dir.exists</a></code>,
<code><a href="#topic+unlink">unlink</a></code>, <code><a href="#topic+file.info">file.info</a></code> and
<code><a href="#topic+list.files">list.files</a></code>, non-native filepaths are treated as
non-existent.
</p>
<p>Many other functions use <code>file</code> or <code>gzfile</code> to open their
files.
</p>
<p><code><a href="#topic+file.path">file.path</a></code> allows non-native file paths to be combined,
marking them as UTF-8 if needed.
</p>
<p><code><a href="#topic+path.expand">path.expand</a></code> only handles paths in the native encoding.  
</p>


<h3>Windows</h3>

<p>Windows provides proprietary entry points to access its file systems,
and these gained &lsquo;wide&rsquo; versions in Windows NT that allowed
file paths in UCS-2/UTF-16 to be accessed from any locale.
</p>
<p>Some <span class="rlang"><b>R</b></span> functions use these entry points when file paths are marked
as Latin-1 or UTF-8 to allow access to paths not in the current
encoding.  These include

<code><a href="#topic+file">file</a></code>, <code><a href="#topic+file.access">file.access</a></code>,
<code><a href="#topic+file.append">file.append</a></code>, <code><a href="#topic+file.copy">file.copy</a></code>,
<code><a href="#topic+file.create">file.create</a></code>, <code><a href="#topic+file.exists">file.exists</a></code>,
<code><a href="#topic+file.info">file.info</a></code>, <code><a href="#topic+file.link">file.link</a></code>,
<code><a href="#topic+file.remove">file.remove</a></code>, <code><a href="#topic+file.rename">file.rename</a></code>,
<code><a href="#topic+file.symlink">file.symlink</a></code>

and

<code><a href="#topic+dir.create">dir.create</a></code>, <code><a href="#topic+dir.exists">dir.exists</a></code>,
<code><a href="#topic+normalizePath">normalizePath</a></code>, <code><a href="#topic+path.expand">path.expand</a></code>,
<code><a href="#topic+pipe">pipe</a></code>, <code><a href="#topic+Sys.glob">Sys.glob</a></code>,
<code>Sys.junction</code>,
<code><a href="#topic+unlink">unlink</a></code>

but not <code><a href="#topic+gzfile">gzfile</a></code> <code><a href="#topic+bzfile">bzfile</a></code>,
<code><a href="#topic+xzfile">xzfile</a></code> nor <code><a href="#topic+unz">unz</a></code>.
</p>
<p>For functions using <code><a href="#topic+gzfile">gzfile</a></code> (including
<code><a href="#topic+load">load</a></code>, <code><a href="#topic+readRDS">readRDS</a></code>, <code><a href="#topic+read.dcf">read.dcf</a></code> and
<code><a href="utils.html#topic+tar">tar</a></code>), it is often possible to use a <code><a href="#topic+gzcon">gzcon</a></code>
connection wrapping a <code><a href="#topic+file">file</a></code> connection.
</p>
<p>Other notable exceptions are <code><a href="#topic+list.files">list.files</a></code>,
<code><a href="#topic+list.dirs">list.dirs</a></code>, <code><a href="#topic+system">system</a></code> and file-path inputs for
graphics devices.
</p>


<h3>Historical comment</h3>

<p>Before <span class="rlang"><b>R</b></span> 4.0.0, file paths marked as being in Latin-1 or UTF-8 were
silently translated to the native encoding using escapes such as
&lsquo;<span class="samp">&#8288;&lt;e7&gt;&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;&lt;U+00e7&gt;&#8288;</span>&rsquo;.  This created valid file names but
maybe not those intended.
</p>


<h3>Note</h3>

<p>This document is still a work-in-progress.
</p>

<hr>
<h2 id='validUTF8'>Check if a Character Vector is Validly Encoded</h2><span id='topic+validUTF8'></span><span id='topic+validEnc'></span>

<h3>Description</h3>

<p>Check if each element of a character vector is valid in its implied
encoding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validUTF8(x)
validEnc(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validUTF8_+3A_x">x</code></td>
<td>
<p>a character vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These use similar checks to those used by functions such as
<code><a href="#topic+grep">grep</a></code>.
</p>
<p><code>validUTF8</code> ignores any marked encoding (see
<code><a href="#topic+Encoding">Encoding</a></code>) and so looks directly if the bytes in each
string are valid UTF-8.  (For the validity of &lsquo;noncharacters&rsquo;
see the help for <code><a href="#topic+intToUtf8">intToUtf8</a></code>.)
</p>
<p><code>validEnc</code> regards character strings as validly encoded unless
their encodings are marked as UTF-8 or they are unmarked and the <span class="rlang"><b>R</b></span>
session is in a UTF-8 or other multi-byte locale.  (The checks in
other multi-byte locales depend on the OS and as with
<code><a href="#topic+iconv">iconv</a></code> not all invalid inputs may be detected.)
</p>


<h3>Value</h3>

<p>A logical vector of the same length as <code>x</code>.   <code>NA</code> elements
are regarded as validly encoded.
</p>


<h3>Note</h3>

<p>It would be possible to check for the validity of character strings in
a Latin-1 encoding, but extensions such as CP1252 are widely accepted
as &lsquo;Latin-1&rsquo; and 8-bit encodings rarely need to be checked for
validity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;-
  ## from example(text)
c("Jetz", "no", "chli", "z\xc3\xbcrit\xc3\xbc\xc3\xbctsch:",
  "(noch", "ein", "bi\xc3\x9fchen", "Z\xc3\xbc", "deutsch)",
   ## from a CRAN check log
   "\xfa\xb4\xbf\xbf\x9f")
validUTF8(x)
validEnc(x) # depends on the locale
Encoding(x) &lt;-"UTF-8"
validEnc(x) # typically the last, x[10], is invalid

## Maybe advantageous to declare it "unknown":
G &lt;- x ; Encoding(G[!validEnc(G)]) &lt;- "unknown"
try( substr(x, 1,1) ) # gives 'invalid multibyte string' error in a UTF-8 locale
try( substr(G, 1,1) ) # works in a UTF-8 locale
nchar(G) # fine, too
## but it is not "more valid" typically:
all.equal(validEnc(x),
          validEnc(G)) # typically TRUE
</code></pre>

<hr>
<h2 id='vector'>Vectors - Creation, Coercion, etc</h2><span id='topic+vector'></span><span id='topic+as.vector'></span><span id='topic+as.vector.data.frame'></span><span id='topic+as.vector.factor'></span><span id='topic+as.vector.POSIXlt'></span><span id='topic+is.vector'></span><span id='topic+atomic'></span>

<h3>Description</h3>

<p>A <em>vector</em> in <span class="rlang"><b>R</b></span> is either an atomic vector i.e., one of the atomic
types, see &lsquo;Details&rsquo;, or of type (<code><a href="#topic+typeof">typeof</a></code>) or mode
<code><a href="#topic+list">list</a></code> or <code><a href="#topic+expression">expression</a></code>.
</p>
<p><code>vector</code> produces a &lsquo;simple&rsquo; vector of the given length and
mode, where a &lsquo;simple&rsquo; vector has no attribute, i.e., fulfills
<code>is.null(<a href="#topic+attributes">attributes</a>(.))</code>.
</p>
<p><code>as.vector</code>, a generic, attempts to coerce its argument into a
vector of mode <code>mode</code> (the default is to coerce to whichever
vector mode is most convenient): if the result is atomic
(<code><a href="#topic+is.atomic">is.atomic</a></code>), all attributes are removed.
For <code>mode="any"</code>, see &lsquo;Details&rsquo;.
</p>
<p><code>is.vector(x)</code> returns <code>TRUE</code> if <code>x</code> is a vector of the
specified mode having no attributes <em>other than names</em>.
For <code>mode="any"</code>, see &lsquo;Details&rsquo;.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>vector(mode = "logical", length = 0)
as.vector(x, mode = "any")
is.vector(x, mode = "any")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vector_+3A_mode">mode</code></td>
<td>
<p>character string naming an atomic mode or
<code>"list"</code> or <code>"expression"</code> or (except for <code>vector</code>)
<code>"any"</code>.  Currently, <code>is.vector()</code> allows any type (see
<code><a href="#topic+typeof">typeof</a></code>) for <code>mode</code>, and when mode is not
<code>"any"</code>, <code>is.vector(x, mode)</code> is almost the same as
<code>typeof(x) == mode</code>.</p>
</td></tr>
<tr><td><code id="vector_+3A_length">length</code></td>
<td>
<p>a non-negative integer specifying the desired length.  For
a <a href="#topic+long+20vector">long vector</a>, i.e., <code>length &gt; .Machine$integer.max</code>, it
has to be of type <code>"double"</code>.  Supplying an argument of length
other than one is an error.</p>
</td></tr>
<tr><td><code id="vector_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The atomic modes are <code>"logical"</code>, <code>"integer"</code>,
<code>"numeric"</code> (synonym <code>"double"</code>), <code>"complex"</code>,
<code>"character"</code> and <code>"raw"</code>.
</p>
<p>If <code>mode = "any"</code>, <code>is.vector</code> may return <code>TRUE</code> for
the atomic modes, <code><a href="#topic+list">list</a></code> and <code><a href="#topic+expression">expression</a></code>.
For any <code>mode</code>, it will return <code>FALSE</code> if <code>x</code> has any
attributes except names.  (This is incompatible with S.)  On the other
hand, <code>as.vector</code> removes <em>all</em> attributes including names
for results of atomic mode.
</p>
<p>For <code>mode = "any"</code>, and atomic vectors <code>x</code>, <code>as.vector(x)</code>
strips all <code><a href="#topic+attributes">attributes</a></code> (including <code><a href="#topic+names">names</a></code>),
returning a simple atomic vector. <br />
However, when <code>x</code> is of type <code>"<a href="#topic+list">list</a>"</code> or
<code>"<a href="#topic+expression">expression</a>"</code>, <code>as.vector(x)</code> currently returns the
argument <code>x</code> unchanged, unless there is an <code>as.vector</code> method
for <code><a href="#topic+class">class</a>(x)</code>.
</p>
<p>Note that factors are <em>not</em> vectors; <code>is.vector</code> returns
<code>FALSE</code> and <code>as.vector</code> converts a factor to a character
vector for <code>mode = "any"</code>.
</p>


<h3>Value</h3>

<p>For <code>vector</code>, a vector of the given length and mode.  Logical
vector elements are initialized to <code>FALSE</code>, numeric vector
elements to <code>0</code>, character vector elements to <code>""</code>, raw
vector elements to <code>nul</code> bytes and list/expression elements to
<code>NULL</code>.
</p>
<p>For <code>as.vector</code>, a vector (atomic or of type list or expression).
All attributes are removed from the result if it is of an atomic mode,
but not in general for a list or expression result.  The default method handles 24
input types and 12 values of <code>type</code>: the details of most
coercions are undocumented and subject to change.
</p>
<p>For <code>is.vector</code>, <code>TRUE</code> or <code>FALSE</code>.
<code>is.vector(x, mode = "numeric")</code> can be true for vectors of types
<code>"integer"</code> or <code>"double"</code> whereas <code>is.vector(x, mode =
  "double")</code> can only be true for those of type <code>"double"</code>.
</p>


<h3>Methods for <code>as.vector()</code></h3>

<p>Writers of methods for <code>as.vector</code> need to take care to
follow the conventions of the default method.  In particular
</p>

<ul>
<li><p> Argument <code>mode</code> can be <code>"any"</code>, any of the atomic
modes, <code>"list"</code>, <code>"expression"</code>, <code>"symbol"</code>,
<code>"pairlist"</code> or one of the aliases <code>"double"</code> and <code>"name"</code>.
</p>
</li>
<li><p> The return value should be of the appropriate mode.  For
<code>mode = "any"</code> this means an atomic vector or list or expression.
</p>
</li>
<li><p> Attributes should be treated appropriately: in particular when
the result is an atomic vector there should be no attributes, not
even names.
</p>
</li>
<li> <p><code>is.vector(as.vector(x, m), m)</code> should be true for any
mode <code>m</code>, including the default <code>"any"</code>.
</p>
<p>Currently this is not fulfilled in <span class="rlang"><b>R</b></span> when <code>m == "any"</code> and
<code>x</code> is of type <code><a href="#topic+list">list</a></code> or <code><a href="#topic+expression">expression</a></code> with
attributes in addition to <code><a href="#topic+names">names</a></code> &mdash; typically the case for
(S3 or S4) objects (see <code><a href="#topic+is.object">is.object</a></code>) which are lists
internally.
</p>
</li></ul>



<h3>Note</h3>

<p><code>as.vector</code> and <code>is.vector</code> are quite distinct from the
meaning of the formal class <code>"vector"</code> in the <span class="pkg">methods</span>
package, and hence <code><a href="methods.html#topic+as">as</a>(x, "vector")</code> and
<code><a href="methods.html#topic+is">is</a>(x, "vector")</code>.
</p>
<p>Note that <code>as.vector(x)</code> is not necessarily a null operation if
<code>is.vector(x)</code> is true: any names will be removed from an atomic
vector. 

</p>
<p>Non-vector <code>mode</code>s <code>"symbol"</code> (synonym <code>"name"</code>) and
<code>"pairlist"</code> are accepted but have long been undocumented: they
are used to implement <code><a href="#topic+as.name">as.name</a></code> and
<code><a href="#topic+as.pairlist">as.pairlist</a></code>, and those functions should preferably be
used directly.  None of the description here applies to those
<code>mode</code>s: see the help for the preferred forms.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+c">c</a></code>, <code><a href="#topic+is.numeric">is.numeric</a></code>, <code><a href="#topic+is.list">is.list</a></code>, etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(x = 1:3, y = 5:7)
## Error:
try(as.vector(data.frame(x = 1:3, y = 5:7), mode = "numeric"))

x &lt;- c(a = 1, b = 2)
is.vector(x)
as.vector(x)
all.equal(x, as.vector(x)) ## FALSE


###-- All the following are TRUE:
is.list(df)
! is.vector(df)
! is.vector(df, mode = "list")

is.vector(list(), mode = "list")
</code></pre>

<hr>
<h2 id='Vectorize'>Vectorize a Scalar Function</h2><span id='topic+Vectorize'></span>

<h3>Description</h3>

<p><code>Vectorize</code> creates a function wrapper that vectorizes the
action of its argument <code>FUN</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Vectorize(FUN, vectorize.args = arg.names, SIMPLIFY = TRUE,
          USE.NAMES = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vectorize_+3A_fun">FUN</code></td>
<td>
<p>function to apply, found via <code><a href="#topic+match.fun">match.fun</a></code>.</p>
</td></tr>
<tr><td><code id="Vectorize_+3A_vectorize.args">vectorize.args</code></td>
<td>
<p>a character vector of arguments which should be
vectorized.  Defaults to all arguments of <code>FUN</code>.</p>
</td></tr>
<tr><td><code id="Vectorize_+3A_simplify">SIMPLIFY</code></td>
<td>
<p>logical or character string; attempt to reduce the
result to a vector, matrix or higher dimensional array; see
the <code>simplify</code> argument of <code><a href="#topic+sapply">sapply</a></code>.</p>
</td></tr>
<tr><td><code id="Vectorize_+3A_use.names">USE.NAMES</code></td>
<td>
<p>logical; use names if the first ... argument has
names, or if it is a character vector, use that character vector as
the names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments named in the <code>vectorize.args</code> argument to
<code>Vectorize</code> are the arguments passed in the <code>...</code>  list to
<code><a href="#topic+mapply">mapply</a></code>.  Only those that are actually passed will be
vectorized; default values will not.  See the examples.
</p>
<p><code>Vectorize</code> cannot be used with primitive functions as they do
not have a value for <code><a href="#topic+formals">formals</a></code>.
</p>
<p>It also cannot be used with functions that have arguments named
<code>FUN</code>, <code>vectorize.args</code>, <code>SIMPLIFY</code> or
<code>USE.NAMES</code>, as they will interfere with the <code>Vectorize</code>
arguments.  See the <code>combn</code> example below for a workaround.  
</p>


<h3>Value</h3>

<p>A function with the same arguments as <code>FUN</code>, wrapping a call to
<code><a href="#topic+mapply">mapply</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We use rep.int as rep is primitive
vrep &lt;- Vectorize(rep.int)
vrep(1:4, 4:1)
vrep(times = 1:4, x = 4:1)

vrep &lt;- Vectorize(rep.int, "times")
vrep(times = 1:4, x = 42)

f &lt;- function(x = 1:3, y) c(x, y)
vf &lt;- Vectorize(f, SIMPLIFY = FALSE)
f(1:3, 1:3)
vf(1:3, 1:3)
vf(y = 1:3) # Only vectorizes y, not x

# Nonlinear regression contour plot, based on nls() example
require(graphics)
SS &lt;- function(Vm, K, resp, conc) {
    pred &lt;- (Vm * conc)/(K + conc)
    sum((resp - pred)^2 / pred)
}
vSS &lt;- Vectorize(SS, c("Vm", "K"))
Treated &lt;- subset(Puromycin, state == "treated")

Vm &lt;- seq(140, 310, length.out = 50)
K &lt;- seq(0, 0.15, length.out = 40)
SSvals &lt;- outer(Vm, K, vSS, Treated$rate, Treated$conc)
contour(Vm, K, SSvals, levels = (1:10)^2, xlab = "Vm", ylab = "K")

# combn() has an argument named FUN
combnV &lt;- Vectorize(function(x, m, FUNV = NULL) combn(x, m, FUN = FUNV),
                    vectorize.args = c("x", "m"))
combnV(4, 1:4)
combnV(4, 1:4, sum)
</code></pre>

<hr>
<h2 id='warning'>Warning Messages</h2><span id='topic+warning'></span><span id='topic+suppressWarnings'></span>

<h3>Description</h3>

<p>Generates a warning message that corresponds to its argument(s) and
(optionally) the expression or function from which it was called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warning(..., call. = TRUE, immediate. = FALSE, noBreaks. = FALSE,
        domain = NULL)
suppressWarnings(expr, classes = "warning")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warning_+3A_...">...</code></td>
<td>
<p><em>either</em> zero or more objects which can be coerced
to character (and which are pasted together with no separator)
<em>or</em> a single <a href="#topic+condition">condition</a> object.</p>
</td></tr>
<tr><td><code id="warning_+3A_call.">call.</code></td>
<td>
<p>logical, indicating if the call should become part of the
warning message.</p>
</td></tr>
<tr><td><code id="warning_+3A_immediate.">immediate.</code></td>
<td>
<p>logical, indicating if the warning should be output
immediately, even if <code><a href="#topic+getOption">getOption</a>("warn") &lt;=
      0</code>. <strong>NB:</strong> this is not respected for condition objects.</p>
</td></tr>
<tr><td><code id="warning_+3A_nobreaks.">noBreaks.</code></td>
<td>
<p>logical, indicating as far as possible the message should
be output as a single line when <code><a href="#topic+options">options</a>(warn = 1)</code>.</p>
</td></tr>
<tr><td><code id="warning_+3A_expr">expr</code></td>
<td>
<p>expression to evaluate.</p>
</td></tr>
<tr><td><code id="warning_+3A_domain">domain</code></td>
<td>
<p>see <code><a href="#topic+gettext">gettext</a></code>.  If <code>NA</code>, messages will
not be translated, see also the note in <code><a href="#topic+stop">stop</a></code>.</p>
</td></tr>
<tr><td><code id="warning_+3A_classes">classes</code></td>
<td>
<p>character, indicating which classes of warnings should
be suppressed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result <em>depends</em> on the value of
<code><a href="#topic+options">options</a>("warn")</code> and on handlers established in the
executing code.
</p>
<p>If a <a href="#topic+condition">condition</a> object is supplied it should be the only
argument, and further arguments will be ignored, with a message.
<code><a href="#topic+options">options</a>(warn = 1)</code> can be used to request an immediate
report.
</p>
<p><code>warning</code> signals a warning condition by (effectively) calling
<code>signalCondition</code>.  If there are no handlers or if all handlers
return, then the value of <code>warn = <a href="#topic+getOption">getOption</a>("warn")</code> is
used to determine the appropriate action.  If <code>warn</code> is negative
warnings are ignored; if it is zero they are stored and printed after
the top&ndash;level function has completed; if it is one they are printed
as they occur and if it is 2 (or larger) warnings are turned into
errors. Calling <code>warning(immediate. = TRUE)</code> turns <code>warn &lt;=
    0</code> into <code>warn = 1</code> for this call only.
</p>
<p>If <code>warn</code> is zero (the default), a read-only variable
<code>last.warning</code> is created.  It contains the warnings which can be
printed via a call to <code><a href="#topic+warnings">warnings</a></code>.
</p>
<p>Warnings will be truncated to <code><a href="#topic+getOption">getOption</a>("warning.length")</code>
characters, default 1000, indicated by <code>[... truncated]</code>.
</p>
<p>While the warning is being processed, a <code>muffleWarning</code> restart
is available.  If this restart is invoked with <code>invokeRestart</code>,
then <code>warning</code> returns immediately.
</p>
<p>An attempt is made to coerce other types of inputs to <code>warning</code>
to character vectors.
</p>
<p><code>suppressWarnings</code> evaluates its expression in a context that
ignores all warnings.
</p>


<h3>Value</h3>

<p>The warning message as <code><a href="#topic+character">character</a></code> string, invisibly.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stop">stop</a></code> for fatal errors,
<code><a href="#topic+message">message</a></code> for diagnostic messages,
<code><a href="#topic+warnings">warnings</a></code>,
and <code><a href="#topic+options">options</a></code> with argument <code>warn=</code>.
</p>
<p><code><a href="#topic+gettext">gettext</a></code> for the mechanisms for the automated translation
of messages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
testit &lt;- function() warning("testit")
testit() ## shows call
testit &lt;- function() warning("problem in testit", call. = FALSE)
testit() ## no call
suppressWarnings(warning("testit"))

</code></pre>

<hr>
<h2 id='warnings'>Print Warning Messages</h2><span id='topic+warnings'></span><span id='topic+last.warning'></span><span id='topic+print.warnings'></span><span id='topic++5B.warnings'></span><span id='topic+c.warnings'></span><span id='topic+duplicated.warnings'></span><span id='topic+unique.warnings'></span><span id='topic+summary.warnings'></span><span id='topic+print.summary.warnings'></span>

<h3>Description</h3>

<p><code>warnings</code> and its <code>print</code> method print the
variable <code>last.warning</code> in a pleasing form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warnings(...)

## S3 method for class 'warnings'
summary(object, ...)

## S3 method for class 'warnings'
print(x, tags,
      header = ngettext(n, "Warning message:\n", "Warning messages:\n"),
      ...)
## S3 method for class 'summary.warnings'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warnings_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+cat">cat</a></code> (for
<code>warnings()</code>).</p>
</td></tr>
<tr><td><code id="warnings_+3A_object">object</code></td>
<td>
<p>a <code>"warnings"</code> object as returned by
<code>warnings()</code>.</p>
</td></tr>
<tr><td><code id="warnings_+3A_x">x</code></td>
<td>
<p>a <code>"warnings"</code> or <code>"summary.warnings"</code> object.</p>
</td></tr>
<tr><td><code id="warnings_+3A_tags">tags</code></td>
<td>
<p>if not <code><a href="#topic+missing">missing</a></code>, a <code><a href="#topic+character">character</a></code>
vector of the same <code><a href="#topic+length">length</a></code> as <code>x</code>, to &ldquo;label&rdquo;
the messages.  Defaults to <code>paste0(seq_len(n), ": ")</code> for
<code class="reqn">n \ge 2</code> where <code>n &lt;- length(x)</code>.</p>
</td></tr>
<tr><td><code id="warnings_+3A_header">header</code></td>
<td>
<p>a character string <code><a href="#topic+cat">cat</a>()</code>ed before the
messages are printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the description of <code><a href="#topic+options">options</a>("warn")</code> for the
circumstances under which there is a <code>last.warning</code> object and
<code>warnings()</code> is used.  In essence this is if <code>options(warn =
    0)</code> and <code>warning</code> has been called at least once.
</p>
<p>Note that the <code><a href="#topic+length">length</a>(last.warning)</code> is maximally
<code><a href="#topic+getOption">getOption</a>("nwarnings")</code> (at the time the warnings are
generated) which is <code>50</code> by default.  To increase, use something
like </p>
<pre>  options(nwarnings = 10000)  </pre>
<p>It is possible that <code>last.warning</code> refers to the last recorded
warning and not to the last warning, for example if <code>options(warn)</code> has
been changed or if a catastrophic error occurred.
</p>


<h3>Value</h3>

<p><code>warnings()</code> returns an object of S3 class <code>"warnings"</code>, basically a named
<code><a href="#topic+list">list</a></code>.
In <span class="rlang"><b>R</b></span> versions before 4.4.0, it returned <code><a href="#topic+NULL">NULL</a></code> when there
were no warnings, contrary to the above documentation.
</p>
<p><code>summary(&lt;warnings&gt;)</code> returns a <code>"summary.warnings"</code>
object which is basically the <code><a href="#topic+list">list</a></code> of unique warnings
(<code>unique(object)</code>) with a <code>"counts"</code> attribute, somewhat
experimentally.
</p>


<h3>Warning</h3>

<p>It is undocumented where <code>last.warning</code> is stored nor that it is
visible, and this is subject to change.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+warning">warning</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NB this example is intended to be pasted in,
##    rather than run by example()
ow &lt;- options("warn")
for(w in -1:1) {
   options(warn = w); cat("\n warn =", w, "\n")
   for(i in 1:3) { cat(i,"..\n"); m &lt;- matrix(1:7, 3,4) }
   cat("--=--=--\n")
}
## at the end prints all three warnings, from the 'option(warn = 0)' above
options(ow) # reset to previous, typically 'warn = 0'
tail(warnings(), 2) # see the last two warnings only (via '[' method)

## Often the most useful way to look at many warnings:
summary(warnings())

op &lt;- options(nwarnings = 10000) ## &lt;- get "full statistics"
x &lt;- 1:36; for(n in 1:13) for(m in 1:12) A &lt;- matrix(x, n,m) # There were 105 warnings ...
summary(warnings())
options(op) # revert to previous (keeping 50 messages by default)
</code></pre>

<hr>
<h2 id='weekdays'>Extract Parts of a POSIXt or Date Object</h2><span id='topic+weekdays'></span><span id='topic+weekdays.POSIXt'></span><span id='topic+weekdays.Date'></span><span id='topic+months'></span><span id='topic+months.POSIXt'></span><span id='topic+months.Date'></span><span id='topic+quarters'></span><span id='topic+quarters.POSIXt'></span><span id='topic+quarters.Date'></span><span id='topic+julian'></span><span id='topic+julian.POSIXt'></span><span id='topic+julian.Date'></span>

<h3>Description</h3>

<p>Extract the weekday, month or quarter, or the Julian time
(days since some origin).  These are generic functions: the methods
for the internal date-time classes are documented here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weekdays(x, abbreviate)
## S3 method for class 'POSIXt'
weekdays(x, abbreviate = FALSE)
## S3 method for class 'Date'
weekdays(x, abbreviate = FALSE)

months(x, abbreviate)
## S3 method for class 'POSIXt'
months(x, abbreviate = FALSE)
## S3 method for class 'Date'
months(x, abbreviate = FALSE)

quarters(x, abbreviate)
## S3 method for class 'POSIXt'
quarters(x, ...)
## S3 method for class 'Date'
quarters(x, ...)

julian(x, ...)
## S3 method for class 'POSIXt'
julian(x, origin = as.POSIXct("1970-01-01", tz = "GMT"), ...)
## S3 method for class 'Date'
julian(x, origin = as.Date("1970-01-01"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weekdays_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>"POSIXt"</code> or <code>"Date"</code>.</p>
</td></tr>
<tr><td><code id="weekdays_+3A_abbreviate">abbreviate</code></td>
<td>
<p>logical vector (possibly recycled).  Should the names be
abbreviated?</p>
</td></tr>
<tr><td><code id="weekdays_+3A_origin">origin</code></td>
<td>
<p>an length-one object inheriting from class
<code>"POSIXt"</code> or <code>"Date"</code>.</p>
</td></tr>
<tr><td><code id="weekdays_+3A_...">...</code></td>
<td>
<p>arguments for other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>weekdays</code> and <code>months</code> return a character
vector of names in the locale in use, i.e., <code><a href="#topic+Sys.getlocale">Sys.getlocale</a>("LC_TIME")</code>.
</p>
<p><code>quarters</code> returns a character vector of <code>"Q1"</code> to
<code>"Q4"</code>.
</p>
<p><code>julian</code> returns the number of days (possibly fractional)
since the origin, with the origin as a <code>"origin"</code> attribute.
All time calculations in <span class="rlang"><b>R</b></span> are done ignoring leap-seconds.
</p>


<h3>Note</h3>

<p>Other components such as the day of the month or the year are
very easy to compute: just use <code><a href="#topic+as.POSIXlt">as.POSIXlt</a></code> and extract
the relevant component.  Alternatively (especially if the components
are desired as character strings), use <code><a href="#topic+strftime">strftime</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DateTimeClasses">DateTimeClasses</a></code>, <code><a href="#topic+Date">Date</a></code>;
<code><a href="#topic+Sys.getlocale">Sys.getlocale</a>("LC_TIME")</code> crucially for <code>months()</code> and <code>weekdays()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## first two are locale dependent:
weekdays(.leap.seconds)
months  (.leap.seconds)
quarters(.leap.seconds)

## Show how easily you get month, day, year, day (of {month, week, yr}), ... :
## (remember to count from 0 (!): mon = 0..11, wday = 0..6,  etc !!)

##' Transform (Time-)Date vector  to  convenient data frame :
dt2df &lt;- function(dt, dName = deparse(substitute(dt))) {
    DF &lt;- as.data.frame(unclass(as.POSIXlt( dt )))
    `names&lt;-`(cbind(dt, DF, deparse.level=0L), c(dName, names(DF)))
}
## e.g.,
dt2df(.leap.seconds)    # date+time
dt2df(Sys.Date() + 0:9) # date

##' Even simpler:  Date -&gt; Matrix - dropping time info {sec,min,hour, isdst}
d2mat &lt;- function(x) simplify2array(unclass(as.POSIXlt(x))[4:7])
## e.g.,
d2mat(seq(as.Date("2000-02-02"), by=1, length.out=30)) # has R 1.0.0's release date


## Julian Day Number (JDN, https://en.wikipedia.org/wiki/Julian_day)
## is the number of days since noon UTC on the first day of 4317 BCE.
## in the proleptic Julian calendar.  To more recently, in
## 'Terrestrial Time' which differs from UTC by a few seconds
## See https://en.wikipedia.org/wiki/Terrestrial_Time
julian(Sys.Date(), -2440588) # from a day
floor(as.numeric(julian(Sys.time())) + 2440587.5) # from a date-time

</code></pre>

<hr>
<h2 id='which'>Which indices are TRUE?</h2><span id='topic+which'></span><span id='topic+arrayInd'></span>

<h3>Description</h3>

<p>Give the <code>TRUE</code> indices of a logical object, allowing for array
indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>which(x, arr.ind = FALSE, useNames = TRUE)
arrayInd(ind, .dim, .dimnames = NULL, useNames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="which_+3A_x">x</code></td>
<td>
<p>a <code><a href="#topic+logical">logical</a></code> vector or array.  <code><a href="#topic+NA">NA</a></code>s
are allowed and omitted (treated as if <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="which_+3A_arr.ind">arr.ind</code></td>
<td>
<p>logical; should <b>arr</b>ay <b>ind</b>ices be returned
when <code>x</code> is an array?  Anything other than a single true value
is treated as false.</p>
</td></tr>
<tr><td><code id="which_+3A_ind">ind</code></td>
<td>
<p>integer-valued index vector, as resulting from
<code>which(x)</code>.</p>
</td></tr>
<tr><td><code id="which_+3A_.dim">.dim</code></td>
<td>
<p><code><a href="#topic+dim">dim</a>(.)</code> integer vector.</p>
</td></tr>
<tr><td><code id="which_+3A_.dimnames">.dimnames</code></td>
<td>
<p>optional list of character <code><a href="#topic+dimnames">dimnames</a>(.)</code>.
If <code>useNames</code> is true, to be used for constructing dimnames for
<code>arrayInd()</code> (and hence, <code>which(*, arr.ind=TRUE)</code>).
If <code><a href="#topic+names">names</a>(.dimnames)</code> is not empty, these are used as
column names.  <code>.dimnames[[1]]</code> is used as row names.</p>
</td></tr>
<tr><td><code id="which_+3A_usenames">useNames</code></td>
<td>
<p>logical indicating if the value of <code>arrayInd()</code>
should have (non-null) dimnames at all.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>arr.ind == FALSE</code> (the default), an integer vector,
or a double vector if <code>x</code> is a <em><a href="#topic+long+20vector">long vector</a></em>, with
<code>length</code> equal to <code>sum(x)</code>, i.e., to the number of
<code>TRUE</code>s in <code>x</code>.
</p>
<p>Basically, the result is <code>(1:length(x))[x]</code> in typical cases;
more generally, including when <code>x</code> has <code><a href="#topic+NA">NA</a></code>'s,
<code>which(x)</code> is <code>seq_along(x)[!is.na(x) &amp; x]</code> plus
<code><a href="#topic+names">names</a></code> when <code>x</code> has.
</p>
<p>If <code>arr.ind == TRUE</code> and <code>x</code> is an <code><a href="#topic+array">array</a></code> (has
a <code><a href="#topic+dim">dim</a></code> attribute), the result is
<code>arrayInd(which(x), dim(x), dimnames(x))</code>, namely a matrix
whose rows each are the indices of one element of <code>x</code>; see
Examples below.
</p>


<h3>Note</h3>

<p>Unlike most other base <span class="rlang"><b>R</b></span> functions this does not coerce <code>x</code>
to logical: only arguments with <code><a href="#topic+typeof">typeof</a></code> logical are
accepted and others give an error.
</p>


<h3>Author(s)</h3>

<p>Werner Stahel and Peter Holzer (ETH Zurich) proposed the
<code>arr.ind</code> option.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Logic">Logic</a></code>, <code><a href="#topic+which.min">which.min</a></code> for the index of
the minimum or maximum, and <code><a href="#topic+match">match</a></code> for the first index of
an element in a vector, i.e., for a scalar <code>a</code>, <code>match(a, x)</code>
is equivalent to  <code>min(which(x == a))</code> but much more efficient.</p>


<h3>Examples</h3>

<pre><code class='language-R'>which(LETTERS == "R")
which(ll &lt;- c(TRUE, FALSE, TRUE, NA, FALSE, FALSE, TRUE)) #&gt; 1 3 7
names(ll) &lt;- letters[seq(ll)]
which(ll)
which((1:12)%%2 == 0) # which are even?
which(1:10 &gt; 3, arr.ind = TRUE)

( m &lt;- matrix(1:12, 3, 4) )
div.3 &lt;- m %% 3 == 0
which(div.3)
which(div.3, arr.ind = TRUE)
rownames(m) &lt;- paste("Case", 1:3, sep = "_")
which(m %% 5 == 0, arr.ind = TRUE)

dim(m) &lt;- c(2, 2, 3); m
which(div.3, arr.ind = FALSE)
which(div.3, arr.ind = TRUE)

vm &lt;- c(m)
dim(vm) &lt;- length(vm) #-- funny thing with  length(dim(...)) == 1
which(div.3, arr.ind = TRUE)

</code></pre>

<hr>
<h2 id='which.min'>Where is the Min() or Max() or first TRUE or FALSE ?</h2><span id='topic+which.min'></span><span id='topic+which.max'></span>

<h3>Description</h3>

<p>Determines the location, i.e., index of the (first) minimum or maximum
of a numeric (or logical) vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>which.min(x)
which.max(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="which.min_+3A_x">x</code></td>
<td>
<p>numeric (logical, integer or double) vector or an <span class="rlang"><b>R</b></span> object
for which the internal coercion to <code><a href="#topic+double">double</a></code> works whose
<code><a href="#topic+min">min</a></code> or <code><a href="#topic+max">max</a></code> is searched for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Missing and <code>NaN</code> values are discarded.
</p>
<p>an <code><a href="#topic+integer">integer</a></code> or on 64-bit platforms, if
<code><a href="#topic+length">length</a>(x) =: n</code><code class="reqn">\ge 2^{31}</code> an integer
valued <code><a href="#topic+double">double</a></code> of length 1 or 0 (iff <code>x</code> has no
non-<code>NA</code>s), giving the index of the <em>first</em> minimum or
maximum respectively of <code>x</code>.
</p>
<p>If this extremum is unique (or empty), the results are the same as
(but more efficient than) <code>which(x == min(x, na.rm = TRUE))</code> or
<code>which(x == max(x, na.rm = TRUE))</code> respectively.
</p>


<h3>Logical <code>x</code> &ndash; First <code>TRUE</code> or <code>FALSE</code></h3>

<p>For a <code><a href="#topic+logical">logical</a></code> vector <code>x</code> with both <code>FALSE</code> and
<code>TRUE</code> values, <code>which.min(x)</code> and <code>which.max(x)</code> return
the index of the first <code>FALSE</code> or <code>TRUE</code>, respectively, as
<code>FALSE &lt; TRUE</code>.  However, <code>match(FALSE, x)</code> or
<code>match(TRUE, x)</code> are typically <em>preferred</em>, as they do
indicate mismatches.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler</p>


<h3>See Also</h3>

<p><code><a href="#topic+which">which</a></code>, <code><a href="#topic+max.col">max.col</a></code>, <code><a href="#topic+max">max</a></code>, etc.
</p>
<p>Use <code><a href="#topic+arrayInd">arrayInd</a>()</code>, if you need array/matrix indices instead
of 1D vector ones.
</p>
<p><code><a href="nnet.html#topic+which.is.max">which.is.max</a></code> in package <a href="https://CRAN.R-project.org/package=nnet"><span class="pkg">nnet</span></a> differs in
breaking ties at random (and having a &lsquo;fuzz&rsquo; in the definition
of ties).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:4, 0:5, 11)
which.min(x)
which.max(x)

## it *does* work with NA's present, by discarding them:
presidents[1:30]
range(presidents, na.rm = TRUE)
which.min(presidents) # 28
which.max(presidents) #  2

## Find the first occurrence, i.e. the first TRUE, if there is at least one:
x &lt;- rpois(10000, lambda = 10); x[sample.int(50, 20)] &lt;- NA
## where is the first value &gt;= 20 ?
which.max(x &gt;= 20)

## Also works for lists (which can be coerced to numeric vectors):
which.min(list(A = 7, pi = pi)) ##  -&gt;  c(pi = 2L)

</code></pre>

<hr>
<h2 id='with'>Evaluate an Expression in a Data Environment</h2><span id='topic+with'></span><span id='topic+with.default'></span><span id='topic+within'></span><span id='topic+within.list'></span><span id='topic+within.data.frame'></span>

<h3>Description</h3>

<p>Evaluate an <span class="rlang"><b>R</b></span> expression in an environment constructed from data,
possibly modifying (a copy of) the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with(data, expr, ...)
within(data, expr, ...)
## S3 method for class 'list'
within(data, expr, keepAttrs = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_+3A_data">data</code></td>
<td>
<p>data to use for constructing an environment. For the
default <code>with</code> method this may be an environment, a list, a
data frame, or an integer as in <code>sys.call</code>. For <code>within</code>,
it can be a list or a data frame.</p>
</td></tr>
<tr><td><code id="with_+3A_expr">expr</code></td>
<td>
<p>expression to evaluate; particularly for <code>within()</code>
often a &ldquo;compound&rdquo; expression, i.e., of the form </p>
<pre>   {
     a &lt;- somefun()
     b &lt;- otherfun()
     .....
     rm(unused1, temp)
   }
</pre></td></tr>
<tr><td><code id="with_+3A_keepattrs">keepAttrs</code></td>
<td>
<p>for the <code><a href="#topic+list">list</a></code> method of <code>within()</code>,
a <code><a href="#topic+logical">logical</a></code> specifying if the resulting list should keep
the <code><a href="#topic+attributes">attributes</a></code> from <code>data</code> and have its
<code><a href="#topic+names">names</a></code> in the same order.  Often this is unneeded as
the result is a <em>named</em> list anyway, and then <code>keepAttrs =
      FALSE</code> is more efficient.</p>
</td></tr>
<tr><td><code id="with_+3A_...">...</code></td>
<td>
<p>arguments to be passed to (future) methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>with</code> is a generic function that evaluates <code>expr</code> in a
local environment constructed from <code>data</code>.  The environment has
the caller's environment as its parent.  This is useful for
simplifying calls to modeling functions.  (Note: if <code>data</code> is
already an environment then this is used with its existing parent.)
</p>
<p>Note that assignments within <code>expr</code> take place in the constructed
environment and not in the user's workspace.
</p>
<p><code>within</code> is similar, except that it examines the environment
after the evaluation of <code>expr</code> and makes the corresponding
modifications to a copy of <code>data</code> (this may fail in the data
frame case if objects are created which cannot be stored in a data
frame), and returns it.  <code>within</code> can be used as an alternative
to <code>transform</code>.
</p>


<h3>Value</h3>

<p>For <code>with</code>, the value of the evaluated <code>expr</code>.  For
<code>within</code>, the modified object.
</p>


<h3>Note</h3>

<p>For <em>interactive</em> use this is very effective and nice to read.  For
<em>programming</em> however, i.e., in one's functions, more care is
needed, and typically one should refrain from using <code>with()</code>, as,
e.g., variables in <code>data</code> may accidentally override local
variables, see the reference.
</p>
<p>Further, when using modeling or graphics functions with an explicit
<code>data</code> argument (and typically using <code><a href="stats.html#topic+formula">formula</a></code>s),
it is typically preferred to use the <code>data</code> argument of that
function rather than to use <code>with(data, ...)</code>.
</p>


<h3>References</h3>

<p>Thomas Lumley (2003)  <em>Standard nonstandard evaluation rules</em>.
<a href="https://developer.r-project.org/nonstandard-eval.pdf">https://developer.r-project.org/nonstandard-eval.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evalq">evalq</a></code>, <code><a href="#topic+attach">attach</a></code>, <code><a href="#topic+assign">assign</a></code>,
<code><a href="#topic+transform">transform</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>with(mtcars, mpg[cyl == 8  &amp;  disp &gt; 350])
    # is the same as, but nicer than
mtcars$mpg[mtcars$cyl == 8  &amp;  mtcars$disp &gt; 350]

require(stats); require(graphics)

# examples from glm:
with(data.frame(u = c(5,10,15,20,30,40,60,80,100),
                lot1 = c(118,58,42,35,27,25,21,19,18),
                lot2 = c(69,35,26,21,18,16,13,12,12)),
    list(summary(glm(lot1 ~ log(u), family = Gamma)),
         summary(glm(lot2 ~ log(u), family = Gamma))))

aq &lt;- within(airquality, {     # Notice that multiple vars can be changed
    lOzone &lt;- log(Ozone)
    Month &lt;- factor(month.abb[Month])
    cTemp &lt;- round((Temp - 32) * 5/9, 1) # From Fahrenheit to Celsius
    S.cT &lt;- Solar.R / cTemp  # using the newly created variable
    rm(Day, Temp)
})
head(aq)




# example from boxplot:
with(ToothGrowth, {
    boxplot(len ~ dose, boxwex = 0.25, at = 1:3 - 0.2,
            subset = (supp == "VC"), col = "yellow",
            main = "Guinea Pigs' Tooth Growth",
            xlab = "Vitamin C dose mg",
            ylab = "tooth length", ylim = c(0, 35))
    boxplot(len ~ dose, add = TRUE, boxwex = 0.25, at = 1:3 + 0.2,
            subset = supp == "OJ", col = "orange")
    legend(2, 9, c("Ascorbic acid", "Orange juice"),
           fill = c("yellow", "orange"))
})

# alternate form that avoids subset argument:
with(subset(ToothGrowth, supp == "VC"),
     boxplot(len ~ dose, boxwex = 0.25, at = 1:3 - 0.2,
             col = "yellow", main = "Guinea Pigs' Tooth Growth",
             xlab = "Vitamin C dose mg",
             ylab = "tooth length", ylim = c(0, 35)))
with(subset(ToothGrowth,  supp == "OJ"),
     boxplot(len ~ dose, add = TRUE, boxwex = 0.25, at = 1:3 + 0.2,
             col = "orange"))
legend(2, 9, c("Ascorbic acid", "Orange juice"),
       fill = c("yellow", "orange"))
</code></pre>

<hr>
<h2 id='withVisible'>Return both a Value and its Visibility</h2><span id='topic+withVisible'></span>

<h3>Description</h3>

<p>This function evaluates an expression, returning it in a two element list
containing its value and a flag showing whether it would automatically print.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>withVisible(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="withVisible_+3A_x">x</code></td>
<td>
<p>an expression to be evaluated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument, <em>not</em> an <code><a href="#topic+expression">expression</a></code> object, rather
an (unevaluated function) <code><a href="#topic+call">call</a></code>, is evaluated in the
caller's context.
</p>
<p>This is a <a href="#topic+primitive">primitive</a> function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>value</code></td>
<td>
<p>The value of <code>x</code> after evaluation.</p>
</td></tr>
<tr><td><code>visible</code></td>
<td>
<p>logical; whether the value would auto-print.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+invisible">invisible</a></code>, <code><a href="#topic+eval">eval</a></code>;
<code><a href="#topic+withAutoprint">withAutoprint</a>()</code> calls <code><a href="#topic+source">source</a>()</code> which
itself uses <code>withVisible()</code> in order to correctly
&ldquo;auto print&rdquo;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1
withVisible(x &lt;- 1) # *$visible is FALSE
x
withVisible(x)      # *$visible is TRUE

# Wrap the call in evalq() for special handling

df &lt;- data.frame(a = 1:5, b = 1:5)
evalq(withVisible(a + b), envir = df)
</code></pre>

<hr>
<h2 id='write'>Write Data to a File</h2><span id='topic+write'></span>

<h3>Description</h3>

<p>Write data <code>x</code> to a file or other <code><a href="#topic+connection">connection</a></code>.
<br />
As it simply calls <code><a href="#topic+cat">cat</a>()</code>, less formatting happens than
with <code><a href="#topic+print">print</a>()</code>ing.
If <code>x</code> is a matrix you need to transpose it (and typically set
<code>ncolumns</code>) to get the columns in <code>file</code> the same as those in
the internal representation.
</p>
<p>Whereas atomic vectors (<code><a href="#topic+numeric">numeric</a></code>, <code><a href="#topic+character">character</a></code>,
etc, including matrices) are written plainly, i.e., without any names,
less simple vector-like objects such as <code>"<a href="#topic+factor">factor</a>"</code>,
<code>"<a href="#topic+Date">Date</a>"</code>, or <code>"<a href="#topic+POSIXt">POSIXt</a>"</code> may be
<code><a href="#topic+format">format</a></code>ted to character before writing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write(x, file = "data",
      ncolumns = if(is.character(x)) 1 else 5,
      append = FALSE, sep = " ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_+3A_x">x</code></td>
<td>
<p>the data to be written out. </p>
</td></tr>
<tr><td><code id="write_+3A_file">file</code></td>
<td>
<p>a <code><a href="#topic+connection">connection</a></code>, or a character string naming
the file to write to.  If <code>""</code>, print to the standard output
connection.
</p>
<p>When <code><a href="#topic+.Platform">.Platform</a>$OS.type != "windows"</code>, and it
is <code>"|cmd"</code>, the output is piped to the command given
by &lsquo;<span class="file">cmd</span>&rsquo;.
</p>
</td></tr>
<tr><td><code id="write_+3A_ncolumns">ncolumns</code></td>
<td>
<p>the number of columns to write the data in.</p>
</td></tr>
<tr><td><code id="write_+3A_append">append</code></td>
<td>
<p>if <code>TRUE</code> the data <code>x</code> are appended to the
connection.</p>
</td></tr>
<tr><td><code id="write_+3A_sep">sep</code></td>
<td>
<p>a string used to separate columns.  Using <code>sep = "\t"</code>
gives tab delimited output; default is <code>" "</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code>write</code> is a wrapper for <code><a href="#topic+cat">cat</a></code>, which gives further
details on the format used.
</p>
<p><code><a href="utils.html#topic+write.table">write.table</a></code> for matrix and data frame objects,
<code><a href="#topic+writeLines">writeLines</a></code> for lines of text,
and <code><a href="#topic+scan">scan</a></code> for reading data.
</p>
<p><code><a href="#topic+saveRDS">saveRDS</a></code> and <code><a href="#topic+save">save</a></code> are often preferable (for
writing any <span class="rlang"><b>R</b></span> objects).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Demonstrate default ncolumns, writing to the console
write(month.abb,  "")  # 1 element  per line for "character"
write(stack.loss, "")  # 5 elements per line for "numeric"

# Build a file with sequential calls
fil &lt;- tempfile("data")
write("# Model settings", fil)
write(month.abb, fil, ncolumns = 6, append = TRUE)
write("\n# Initial parameter values", fil, append = TRUE)
write(sqrt(stack.loss), fil, append = TRUE)
if(interactive()) file.show(fil)
unlink(fil) # tidy up
</code></pre>

<hr>
<h2 id='writeLines'>Write Lines to a Connection</h2><span id='topic+writeLines'></span>

<h3>Description</h3>

<p>Write text lines to a connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeLines(text, con = stdout(), sep = "\n", useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeLines_+3A_text">text</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="writeLines_+3A_con">con</code></td>
<td>
<p>a <a href="#topic+connection">connection</a> object or a character string.</p>
</td></tr>
<tr><td><code id="writeLines_+3A_sep">sep</code></td>
<td>
<p>character string.  A string to be written to the connection
after each line of text.</p>
</td></tr>
<tr><td><code id="writeLines_+3A_usebytes">useBytes</code></td>
<td>
<p>logical.  See &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the <code>con</code> is a character string, the function calls
<code><a href="#topic+file">file</a></code> to obtain a file connection which is opened for
the duration of the function call.
(<a href="#topic+tilde+20expansion">tilde expansion</a> of the file path is done by <code>file</code>.)
</p>
<p>If the connection is open it is written from its current position.
If it is not open, it is opened for the duration of the call in
<code>"wt"</code> mode and then closed again.
</p>
<p>Normally <code>writeLines</code> is used with a text-mode  connection, and the
default separator is converted to the normal separator for that
platform (<abbr>LF</abbr> on Unix/Linux, <abbr>CRLF</abbr> on Windows).  For more
control, open 
a binary connection and specify the precise value you want written to
the file in <code>sep</code>.  For even more control, use
<code><a href="#topic+writeChar">writeChar</a></code> on a binary connection.
</p>
<p><code>useBytes</code> is for expert use.  Normally (when false) character
strings with marked encodings are converted to the current encoding
before being passed to the connection (which might do further
re-encoding).  <code>useBytes = TRUE</code> suppresses the re-encoding of
marked strings so they are passed byte-by-byte to the connection:
this can be useful when strings have already been re-encoded by
e.g. <code><a href="#topic+iconv">iconv</a></code>.  (It is invoked automatically for strings
with marked encoding <code>"bytes"</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+connections">connections</a></code>, <code><a href="#topic+writeChar">writeChar</a></code>, <code><a href="#topic+writeBin">writeBin</a></code>,
<code><a href="#topic+readLines">readLines</a></code>, <code><a href="#topic+cat">cat</a></code>
</p>

<hr>
<h2 id='xtfrm'>Auxiliary Function for Sorting and Ranking</h2><span id='topic+xtfrm'></span><span id='topic+xtfrm.default'></span><span id='topic+xtfrm.factor'></span><span id='topic+xtfrm.AsIs'></span><span id='topic+xtfrm.Date'></span><span id='topic+xtfrm.POSIXct'></span><span id='topic+xtfrm.POSIXlt'></span><span id='topic+xtfrm.difftime'></span><span id='topic+xtfrm.data.frame'></span>

<h3>Description</h3>

<p>A generic auxiliary function that produces a numeric vector which
will sort in the same order as <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xtfrm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xtfrm_+3A_x">x</code></td>
<td>
<p>an <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a special case of ranking, but as a less general function than
<code><a href="#topic+rank">rank</a></code> is more suitable to be made generic.  The default
method is similar to <code>rank(x, ties.method = "min",
    na.last = "keep")</code>, so <code>NA</code> values are given rank <code>NA</code> and all
tied values are given equal integer rank.
</p>
<p>The <code><a href="#topic+factor">factor</a></code> method extracts the codes.




</p>
<p>The default method will unclass the object if
<code><a href="#topic+is.numeric">is.numeric</a>(x)</code> is true but otherwise make use of
<code>==</code> and <code>&gt;</code> methods for the class of <code>x[i]</code> (for
integers <code>i</code>), and the <code>is.na</code> method for the class of
<code>x</code>, but might be rather slow when doing so.
</p>
<p>This is an <a href="#topic+internal+20generic">internal generic</a> <a href="#topic+primitive">primitive</a>, so S3 or S4
methods can be written for it.
Differently to other internal generics, the default method is called
explicitly when no other dispatch has happened.
</p>


<h3>Value</h3>

<p>A numeric (usually integer) vector of the same length as <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rank">rank</a></code>, <code><a href="#topic+sort">sort</a></code>, <code><a href="#topic+order">order</a></code>.
</p>

<hr>
<h2 id='zapsmall'>Rounding of Numbers: Zapping Small Ones to Zero</h2><span id='topic+zapsmall'></span>

<h3>Description</h3>

<p><code>zapsmall</code> determines a <code>digits</code> argument <code>dr</code> for
calling <code>round(x, digits = dr)</code> such that values close to
zero (compared with the maximal absolute value in the vector) are
&lsquo;zapped&rsquo;, i.e., replaced by <code>0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zapsmall(x, digits = getOption("digits"),
         mFUN = function(x, ina) max(abs(x[!ina])),
         min.d = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zapsmall_+3A_x">x</code></td>
<td>
<p>a numeric or complex vector or any <span class="rlang"><b>R</b></span> number-like object
which has a <code><a href="#topic+round">round</a></code> method and basic arithmetic methods
including <code><a href="#topic+log10">log10</a>()</code>.</p>
</td></tr>
<tr><td><code id="zapsmall_+3A_digits">digits</code></td>
<td>
<p>integer indicating the precision to be used.</p>
</td></tr>
<tr><td><code id="zapsmall_+3A_mfun">mFUN</code></td>
<td>
<p>a <code><a href="#topic+function">function</a>(x, ina)</code> of the numeric (or complex)
<code>x</code> and  the <code><a href="#topic+logical">logical</a></code> <code>ina := is.na(x)</code>
returning a positive number in the order of magnitude of the maximal
<code>abs(x)</code> value.  The default is back compatible but not robust,
and e.g., not very useful when <code>x</code> has infinite entries.</p>
</td></tr>
<tr><td><code id="zapsmall_+3A_min.d">min.d</code></td>
<td>
<p>an integer specifying the minimal number of digits to use in
the resulting <code><a href="#topic+round">round</a>(x, digits=*)</code> call when <code>mFUN(*) &gt; 0</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chambers, J. M. (1998)
<em>Programming with Data.  A Guide to the S Language</em>.
Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x2 &lt;- pi * 100^(-2:2)/10
   print(  x2, digits = 4)
zapsmall(  x2) # automatical digits
zapsmall(  x2, digits = 4)
zapsmall(c(x2, Inf)) # round()s to integer ..
zapsmall(c(x2, Inf), min.d=-Inf) # everything  is small wrt  Inf

(z &lt;- exp(1i*0:4*pi/2))
zapsmall(z)

zapShow &lt;- function(x, ...) rbind(orig = x, zapped = zapsmall(x, ...))
zapShow(x2)

## using a *robust* mFUN
mF_rob &lt;- function(x, ina) boxplot.stats(x, do.conf=FALSE)$stats[5]
## with robust mFUN(), 'Inf' is no longer distorting the picture:
zapShow(c(x2, Inf), mFUN = mF_rob)
zapShow(c(x2, Inf), mFUN = mF_rob, min.d = -5) # the same
zapShow(c(x2, 999), mFUN = mF_rob) # same *rounding* as w/ Inf
zapShow(c(x2, 999), mFUN = mF_rob, min.d =  3) # the same
zapShow(c(x2, 999), mFUN = mF_rob, min.d =  8) # small diff
</code></pre>

<hr>
<h2 id='zpackages'>Listing of Packages</h2><span id='topic+.packages'></span>

<h3>Description</h3>

<p><code>.packages</code> returns information about package availability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.packages(all.available = FALSE, lib.loc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zpackages_+3A_all.available">all.available</code></td>
<td>
<p>logical; if <code>TRUE</code> return a character vector
of all available packages in <code>lib.loc</code>.</p>
</td></tr>
<tr><td><code id="zpackages_+3A_lib.loc">lib.loc</code></td>
<td>
<p>a character vector describing the location of <span class="rlang"><b>R</b></span>
library trees to search through, or <code>NULL</code>.  The default value
of <code>NULL</code> corresponds to <code><a href="#topic+.libPaths">.libPaths</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>.packages()</code> returns the names of the currently
attached packages <em>invisibly</em> whereas
<code>.packages(all.available = TRUE)</code> gives (visibly) <em>all</em>
packages available in the library location path <code>lib.loc</code>.
</p>
<p>For a package to be regarded as being &lsquo;available&rsquo; it must have valid
metadata (and hence be an installed package).  However, this will
report a package as available if the metadata does not match the
directory name: use <code><a href="#topic+find.package">find.package</a></code> to confirm that the
metadata match or <code><a href="utils.html#topic+installed.packages">installed.packages</a></code> for a much slower
but more comprehensive check of &lsquo;available&rsquo; packages.
</p>


<h3>Value</h3>

<p>A character vector of package base names, invisible unless
<code>all.available = TRUE</code>.
</p>


<h3>Note</h3>

<p><code>.packages(all.available = TRUE)</code> is not a way to find out if a
small number of packages are available for use: not only is it
expensive when thousands of packages are installed, it is an
incomplete test.  See the help for <code><a href="#topic+find.package">find.package</a></code> for why
<code><a href="#topic+require">require</a></code> should be used.
</p>


<h3>Author(s)</h3>

<p>R core;
Guido Masarotto for the <code>all.available = TRUE</code> part of
<code>.packages</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+library">library</a></code>, <code><a href="#topic+.libPaths">.libPaths</a></code>,
<code><a href="utils.html#topic+installed.packages">installed.packages</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(.packages())               # maybe just "base"
.packages(all.available = TRUE) # return all available as character vector
require(splines)
(.packages())               # "splines", too
detach("package:splines")
</code></pre>

<hr>
<h2 id='zutils'>Miscellaneous Internal/Programming Utilities</h2><span id='topic+.standard_regexps'></span>

<h3>Description</h3>

<p>Miscellaneous internal/programming utilities.</p>


<h3>Usage</h3>

<pre><code class='language-R'>.standard_regexps()
</code></pre>


<h3>Details</h3>

<p><code>.standard_regexps</code> returns a list of &lsquo;standard&rsquo; regexps,
including elements named <code>valid_package_name</code> and
<code>valid_package_version</code> with the obvious meanings.  The regexps
are not anchored.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
