<!DOCTYPE html><html lang="en"><head><title>Help for package downscale</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {downscale}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#downscale-package'>
<p>Downscaling Species Occupancy</p></a></li>
<li><a href='#downscale'><p>Model area of occupancy against grain size for downscaling</p></a></li>
<li><a href='#ensemble.downscale'><p>Ensemble modelling of multiple downscaling functions</p></a></li>
<li><a href='#hui.downscale'><p>Predict occupancy at fine grain sizes using the Hui model</p></a></li>
<li><a href='#plot.predict.downscale'><p>Plotting of downscaled occupancy at fine grain sizes</p></a></li>
<li><a href='#predict.downscale'><p>Predict occupancy at fine grain sizes</p></a></li>
<li><a href='#upgrain'><p>Upgraining of atlas data to larger grain sizes</p></a></li>
<li><a href='#upgrain.threshold'><p>Exploration of trade-offs in threshold selection for upgraining</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Downscaling Species Occupancy</td>
</tr>
<tr>
<td>Version:</td>
<td>5.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charles Marsh &lt;charlie.marsh@mailbox.org&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/charliem2003/downscale">https://github.com/charliem2003/downscale</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Uses species occupancy at coarse grain sizes to predict species occupancy at fine grain sizes. Ten models are provided to fit and extrapolate the occupancy-area relationship, as well as methods for preparing atlas data for modelling. See Marsh et. al. (2018) &lt;<a href="https://doi.org/10.18637%2Fjss.v086.c03">doi:10.18637/jss.v086.c03</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cubature (&ge; 1.1-2), graphics, grDevices, methods, minpack.lm
(&ge; 1.1-9), Rmpfr, stats, sf (&ge; 1.0-9), terra (&ge; 1.7-3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rgbif (&ge; 0.9.2), knitr, rmarkdown, bookdown</td>
</tr>
<tr>
<td>Collate:</td>
<td>'checkInputs.R' 'DataInput.R' 'downscale.R' 'OptimisePars.R'
'OptimiseParsGNB.R' 'OptimiseParsFNB.R' 'OptimiseParsLogis.R'
'OptimiseParsThomas.R' 'PredictFunctions.R' 'ResidFunctions.R'
'StartingParams.R' 'ThomasFunctions.R'
'plot.predict.downscale.R' 'predict.downscale.R'
'ensemble.downscale.R' 'upgrain.R' 'hui.downscale.R'
'HuiFunctions.R' 'upgrain.threshold.R' 'zzz.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-31 11:46:22 UTC; charlie</td>
</tr>
<tr>
<td>Author:</td>
<td>Charles Marsh <a href="https://orcid.org/0000-0002-0281-3115"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-31 22:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='downscale-package'>
Downscaling Species Occupancy
</h2><span id='topic+downscale-package'></span>

<h3>Description</h3>

<p>The package provides a set of functions that model the occupancy-area relationship (OAR) of known coarse scale data. The models are then extrapolated to predict the proportion of occupied area at finer grain sizes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> downscale</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.2-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-10-25</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Overview</h3>

<p>The package provides three sets of functions for each stage of analysis:
</p>
<p>1) <code><a href="#topic+upgrain">upgrain</a></code> and <code><a href="#topic+upgrain.threshold">upgrain.threshold</a></code> prepare atlas data for downscaling. 
</p>
<p>2) <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+hui.downscale">hui.downscale</a></code> model the OAR to the prepared data for one of ten possible downscaling models. 
</p>
<p>3) <code><a href="#topic+predict.downscale">predict.downscale</a></code> and <code><a href="#topic+plot.predict.downscale">plot.predict.downscale</a></code> take the model outputs and predict occupancy at finer grains. 
</p>
<p>Finally, <code><a href="#topic+ensemble.downscale">ensemble.downscale</a></code> will run <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+predict.downscale">predict.downscale</a></code> for a number of selected downscaling functions and calculate the mean predicted occupancies across all models.
</p>
<p>The general flow of the package, and the inputs required for each function, is as follows:
</p>
<p><img src="../help/figures/Flow.png" width="65%" alt="Figure: Flow.png" />

</p>
<p>Two vignettes are available to guide users. Both work through examples in code:<br />
</p>
<p><code>vignette("Downscaling", package = "downscale")</code><br />
</p>
<p><code>vignette("Upgraining", package = "downscale")</code>
</p>


<h3>Credits</h3>

<p>This package was created as part of deliverable D3.2 of WP3 of the project: <b>EU-BON: Building the European Biodiversity Observation Network</b> - a 7th Framework Programme funded by the European Union under Contract No. 308454.
</p>


<h3>Author(s)</h3>

<p>Charles Marsh with input from Louise Barwell and Cang Hui.
</p>
<p>Maintainer: Charles Marsh &lt;charlie.marsh@mailbox.com&gt;
</p>
<p>Website: https://github.com/charliem2003/downscale
</p>
<p>For reporting bugs or requesting information please include <em>'downscale'</em> in the subject line.
</p>


<h3>References</h3>

<p>Azaele, S., Cornell, S.J., &amp; Kunin, W.E. (2012). Downscaling species occupancy from coarse spatial scales. <em>Ecological Applications</em> 22, 1004-1014.
</p>
<p>Barwell, L.J., Azaele, S., Kunin, W.E., &amp; Isaac, N.J.B. (2014). Can coarse-grain patterns in insect atlas data predict local occupancy? <em>Diversity and Distributions</em> 20, 895-907.
</p>
<p>Hui, C. (2009). On the scaling patterns of species spatial distribution and association. <em>Journal of Theoretical Biology</em> 261, 481-487.
</p>
<p>Hui, C., McGeoch, M.A., &amp; Warren, M. (2006). A spatially explicit approach to estimating species occupancy and spatial correlation. <em>Journal of Animal Ecology</em> 7, 140-147.
</p>
<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software</em> 86(Code Snippet 3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>

<hr>
<h2 id='downscale'>Model area of occupancy against grain size for downscaling</h2><span id='topic+downscale'></span>

<h3>Description</h3>

<p>Fits the log observed proportion of occupancies against log grain size (cell area) for coarse-scale data (typically atlas data) for nine commonly used downscaling models (see Azaele et al. 2012 and Barwell et al. 2014). See <code><a href="#topic+hui.downscale">hui.downscale</a></code> for downscaling using the Hui model. The parameters of the fitted models may then be used to estimate the area of occupancy at finer grain sizes than the observed data using <code><a href="#topic+predict.downscale">predict.downscale</a></code>. Presence-absence atlas data can be prepared for downscaling using <code><a href="#topic+upgrain">upgrain</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downscale(occupancies, model, extent = NULL, tolerance = 1e-06,
          starting_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="downscale_+3A_occupancies">occupancies</code></td>
<td>
<p>Either a data frame containing two columns or an object of class <code>"upgrain"</code> from the <code><a href="#topic+upgrain">upgrain</a></code> function. If using a data frame the first column must be the grain sizes (cell area in squared units e.g. km^2). The second column is the proportion of occupancies at each grain size.</p>
</td></tr>
<tr><td><code id="downscale_+3A_model">model</code></td>
<td>
<p>selected downscaling model, chosen from one of <code>"Nachman"</code>,
<code>"PL"</code>, <code>"Logis"</code>, <code>"Poisson"</code>, <code>"NB"</code>, <code>"GNB"</code>,
<code>"INB"</code>, <code>"FNB"</code>, <code>"Thomas"</code>. See <code>Details</code> below for
model descriptions.</p>
</td></tr>
<tr><td><code id="downscale_+3A_extent">extent</code></td>
<td>
<p>total area in same units as occupancy. If using an object of class <code>"upgrain"</code>, this is automatically inputted.</p>
</td></tr>
<tr><td><code id="downscale_+3A_tolerance">tolerance</code></td>
<td>
<p>only applicable for the <code>Thomas</code> model. The tolerance used during integration in the Thomas model during optimisation of parameters. Lower numbers allow for greater accuracy but require longer processing times (default = <code>1e-6</code>).</p>
</td></tr>
<tr><td><code id="downscale_+3A_starting_params">starting_params</code></td>
<td>
<p>a list of starting values for model parameters. Useful if the default values are not converging during optimisation. The parameter names must be the same for the default values (see <code>Details</code> for information on the parameters).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nine downscaling models are available (and also see <code><a href="#topic+hui.downscale">hui.downscale</a></code> for downscaling using the Hui model). <code>area</code> is the grain size (cell area) and <code>extent</code> the total area in the same units:
</p>


<table>
<tr>
 <td style="text-align: left;">
   <code>"Nachman"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Nachman model </td><td style="text-align: left;">
     <em>log(1 - exp(-C * area ^ z))</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"PL"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Power law model </td><td style="text-align: left;">
     <em>log(C * area ^ z)</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"Logis"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Logistic model </td><td style="text-align: left;">
     <em>log((C * (area ^ z)) / (1 + (C * (area ^ z))))</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"Poisson"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Poisson model </td><td style="text-align: left;">
     <em>log(1 - (exp(-gamma * area)))</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"NB"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Negative binomial model </td><td style="text-align: left;">
     <em>log(1 - (1 + (gamma * area) / k) ^ -k)</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"GNB"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Generalised negative binomial model </td><td style="text-align: left;">
     <em>log(1 - (1 + (C * area ^ z) / k) ^ -k)</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"INB"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Improved negative binomial model </td><td style="text-align: left;">
     <em>log(1 - ((C * area ^ (b - 1)) ^ ((gamma * area) /
(1 - C * area ^ (b - 1)))))</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"FNB"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Finite negative binomial model </td><td style="text-align: left;">
     <em>log(1 -
((gamma(N + ((extent * k) / area) - k) * 
gamma(extent * k) / area) / 
(gamma(N + ((extent * k) / area)) * 
gamma(((extent * k) / area) - k)))
</em></td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>"Thomas"</code> </td><td style="text-align: left;">  </td><td style="text-align: left;">  Thomas model </td><td style="text-align: left;"> see below</td>
</tr>
<tr>
 <td style="text-align: left;">
   </td>
</tr>

</table>



<p>The finite negative binomial model (<code>"FNB"</code>) incorporates several gamma functions. This may result in integers larger than is possible to store in R. Therefore multiple precision floating point numbers (<code>mpfr</code> function in package <span class="pkg">Rmpfr</span>) are used to make calculations possible.
</p>
<p>The Thomas model incorporates spatial point processes in order to estimate species aggregations. This involves multi-dimensional integration which may be time-consuming. Users can alter the tolerance value during the integration process - a smaller value will give more accurate estimates but longer processing times.
</p>
<p>The optimisation procedure requires initial starting values for all model parameters. In most cases the default values should work, however if the model is not converging adequately it is possible to input the starting parameters. The parameters must be in the form of a list with the same parameter names as in the table below. For example for the <code>Nachman</code> model the code would be <code>starting_params = list("C" = 0.1, "z" = 0.01)</code>. Please take particular note of captials. The default starting parameters are:
</p>


<table>
<tr>
 <td style="text-align: left;">
<code>"Nachman"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"PL"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Logis"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Poisson"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> gamma = 1e-8 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"NB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> gamma = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"GNB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.00001; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 1; </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 0.01</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"INB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 1; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> gamma = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> b = 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"FNB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> N = 10; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 10 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Thomas"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> rho = 1e-8; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> mu = 10; </td><td style="text-align: left;"> </td><td style="text-align: left;"> sigma = 1</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<p>NOTE: for downscaling it is important that occupancies above the scale of saturation (the grain size at which all cells are occupied) and the scale of saturation (the grain size where only a single cell is occupied) are not included for modelling. The <code>downscale</code> functions will automatically set these occupancies to NA.
</p>


<h3>Value</h3>

<p><code>downscale</code> returns an object of class <code>"downscale"</code> containing four objects:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>Downscaling model selected.</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>Estimated parameters for the downscaling model.</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for which occupancy have been observed.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Observed area of occupancy for each grain size.</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
<tr><td><code>extent</code></td>
<td>
<p>Only for <code>FNB</code> and <code>Thomas</code> models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt; with input from Louise Barwell.
</p>


<h3>References</h3>

<p>Azaele, S., Cornell, S.J., &amp; Kunin, W.E. (2012). Downscaling species occupancy from coarse spatial scales. <em>Ecological Applications</em> 22, 1004-1014.
</p>
<p>Barwell, L.J., Azaele, S., Kunin, W.E., &amp; Isaac, N.J.B. (2014). Can coarse-grain patterns in insect atlas data predict local occupancy? <em>Diversity and Distributions</em> 20, 895-907.
</p>
<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software, Code Snippets</em> 86(3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+upgrain">upgrain</a></code> for the preparation of presence-absence atlas data to occupancy data at several spatial scales.
</p>
<p>The function output may be used as the input for <code><a href="#topic+predict.downscale">predict.downscale</a></code> for extrapolating downscaling functions to smaller grain sizes using the estimated parameters from the downscale output.
</p>
<p>See <code><a href="#topic+hui.downscale">hui.downscale</a></code> for downscaling using the Hui model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "x", "y"
## and "presence"
head(atlas.data)

## explore thresholds using upgrain.threshold
thresh &lt;- upgrain.threshold(atlas.data = atlas.data,
                            cell.width = 10,
                            scales = 3,
                            thresholds = seq(0, 1, 0.1))

## upgrain data (using All Sampled threshold)
occupancy &lt;- upgrain(atlas.data,
                     cell.width = 10,
                     scales = 3,
                     method = "All_Sampled")

## Logistic model
(logis &lt;- downscale(occupancies = occupancy,
                    model = "Logis"))
                    
### predict occupancy at finer grain sizes
pred &lt;- predict(logis,
                new.areas = c(1, 2, 5, 25, 100, 400, 1600, 6400))
                
### Plot predictions
plot(pred)

## Improved Negative Binomial model
(inb &lt;- downscale(occupancies = occupancy,
                  model = "INB"))

## Specifying the starting parameters (gives a poorer fit in this case)
new.params &lt;- list("C" = 0.1, "gamma" = 0.00001, "b" = 0.1)
(inb.new &lt;- downscale(occupancies = occupancy,
                      model = "INB",
                      starting_params = new.params))

## plot the predictions of two FNB models using predict.downscale
predict(inb,
        new.areas = c(1, 2, 5, 25, 100, 400, 1600, 6400),
        plot = TRUE)
predict(inb.new,
        new.areas = c(1, 2, 5, 25, 100, 400, 1600, 6400),
        plot = TRUE)
</code></pre>

<hr>
<h2 id='ensemble.downscale'>Ensemble modelling of multiple downscaling functions</h2><span id='topic+ensemble.downscale'></span>

<h3>Description</h3>

<p>Predict area of occupancy at fine grain sizes for multiple downscaling methods using <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+predict.downscale">predict.downscale</a></code>. Occupancies are converted to area of occupancy (AOO) by multiplying by the total extent. The mean of the logged predicted occupancies of all models is then calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ensemble.downscale(occupancies, new.areas, extent, cell.width = NULL, 
                   models = "all", tolerance_mod = 1e-6, tolerance_pred = 1e-6,
                   tolerance_hui = 1e-6, starting_params = NULL, plot = TRUE, 
                   verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ensemble.downscale_+3A_occupancies">occupancies</code></td>
<td>
<p>Either a data frame containing two columns or an object of class &quot;upgrain&quot; from the upgrain function. If using the <code>Hui</code> model (or <code>model = "all"</code>) occupancies must be of class <code>"upgrain"</code>. If using a data frame the first column must be the grain sizes (cell area in squared units e.g. km^2). The second column is the proportion of occupancies at each grain size.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_new.areas">new.areas</code></td>
<td>
<p>vector of grain sizes (in squared units e.g. km^2) for which area of occupancy will be predicted.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_extent">extent</code></td>
<td>
<p>total area in same units as occupancy. If using an object of class &quot;upgrain&quot;, this is automatically inputted.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_cell.width">cell.width</code></td>
<td>
<p>the cell width of the atlas data. Only required for <code>Hui</code> model.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_tolerance_mod">tolerance_mod</code></td>
<td>
<p>only applicable for the <code>Thomas</code> model. The tolerance used during integration in the Thomas model during optimisation of parameters. Lower numbers allow for greater accuracy but require longer processing times (default = <code>1e-6</code>).</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_tolerance_pred">tolerance_pred</code></td>
<td>
<p>only applicable for the <code>Thomas</code> model. The tolerance used during the prediction stage.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_tolerance_hui">tolerance_hui</code></td>
<td>
<p>only applicable for the <code>Hui</code> model. The tolerance used during integration in the Thomas model during optimisation of parameters. Lower numbers allow for greater accuracy but require longer processing times (default = <code>1e-6</code>).</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_models">models</code></td>
<td>
<p>vector of chosen downscaling models. Default <code>models = "all"</code> runs all available models. See <code><a href="#topic+downscale">downscale</a></code> for list of available models.</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_starting_params">starting_params</code></td>
<td>
<p>Starting values for model parameters if a model is not converging sufficiently. A list where each model to be specified is a list of parameter values. The parameter names must be the same for the default values (see <code>Details</code> for information on the parameters and how to specify them).</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> predictions of all models (red) are plotted against
grain size along with the mean of all models (grey) and observed occupancies (black).</p>
</td></tr>
<tr><td><code id="ensemble.downscale_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> prints updates on modelling status.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ten downscaling models are available: <code>"Nachman"</code>, <code>"PL"</code>, <code>"Logis"</code>, <code>"Poisson"</code>, <code>"NB"</code>, <code>"GNB"</code>, <code>"INB"</code>, <code>"FNB"</code>, <code>"Thomas"</code> and <code>"Hui"</code>. They can be input in any order, or all models run through <code>models = "all"</code>. If the <code>Hui</code> model is included the input data must be an object of class <code>"upgrain"</code> generated through <code><a href="#topic+upgrain">upgrain</a></code>. See <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+hui.downscale">hui.downscale</a></code> for more details of the available models.
</p>
<p>The optimisation procedure requires initial starting values for all model parameters. In most cases the default values should work, however if one or more models are not converging adequately it is possible to input the starting parameters. For each model we wish to specify, the parameters must be in the form of a list with the same parameter names as in the table below. <code>starting_params</code> is then a list of these lists - the names of the lists are the same as the models. For example, if we wish to specify the starting parameters for the Nachman model and the Generalised Negative Binomial model the code would be:
</p>


<p><code style="white-space: pre;">&#8288;starting_params = list(Nachman = list("C" = 0.1, "z" = 0.01),
                       GNB = list("C" = 0.1, "z" = 1, "k" = 0.01))&#8288;</code>

</p>
<p>Please take particular note of captials. The default starting parameters are:
</p>


<table>
<tr>
 <td style="text-align: left;">
<code>"Nachman"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"PL"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Logis"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Poisson"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> gamma = 1e-8 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"NB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 0.01 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"GNB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 0.00001; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> z = 1; </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 0.01</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"INB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> C = 1; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> gamma = 0.01; </td><td style="text-align: left;"> </td><td style="text-align: left;"> b = 0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"FNB"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> N = 10; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> k = 10 </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Thomas"</code> </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> rho = 1e-8; </td><td style="text-align: left;"> </td><td style="text-align: left;"> </td><td style="text-align: left;"> mu = 10; </td><td style="text-align: left;"> </td><td style="text-align: left;"> sigma = 1</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>





<h3>Value</h3>

<p>Returns a list of two data frames: 
<code>Occupancy</code> = proportion of occupancies; 
<code>AOO</code> = occupancies converted to area of occupancy. 
</p>
<p>In each data frame the first column <code>cell.area</code> are the grain sizes used for predictions. The final column <code>Means</code> are the mean of the logged predictions of all models for each grain size. Intermediate columns are the predicted occupancies for the selected downscaling models.
</p>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt; with input from Louise Barwell.
</p>


<h3>References</h3>

<p>Azaele, S., Cornell, S.J., &amp; Kunin, W.E. (2012). Downscaling species occupancy from coarse spatial scales. <em>Ecological Applications</em> 22, 1004-1014.
</p>
<p>Barwell, L.J., Azaele, S., Kunin, W.E., &amp; Isaac, N.J.B. (2014). Can coarse-grain patterns in insect atlas data predict local occupancy? <em>Diversity and Distributions</em> 20, 895-907.
</p>
<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software</em> 86(Code Snippet 3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+upgrain">upgrain</a></code> for creating objects of class <code>"upgrain"</code>. See <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+predict.downscale">predict.downscale</a></code>, and <code>link{hui.downscale}</code> for downscaling models individually.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "x", "y"
## and "presence"
head(atlas.data)

## upgrain data (using All Samples threshold)
occupancy &lt;- upgrain(atlas.data,
                     cell.width = 10,
                     scales = 3,
                     method = "All_Sampled",
                     plot = FALSE)

## ensemble downscaling with an object of class upgrain
ensemble.downscale(occupancies = occupancy,
                   new.areas = c(1, 2, 5, 15, 50, 100, 400, 1600, 6400),
                   cell.width = 10,
                   models = c("Nachman", "PL", "Logis", "GNB", "FNB", "Hui"),
                   plot = TRUE)

## ensemble modelling with data frame of occupancies (not applicable for Hui
## model) with hypothetical species occupancy data
occupancy.dd &lt;- data.frame(Cell.areas = c(100, 400, 1600, 6400),
                           Occupancy = c(0.16, 0.36, 0.59, 0.86))

## now extent must be specified (but cell.width not needed)
ensemble.downscale(occupancies = occupancy.dd,
                   new.areas = c(1, 2, 5, 15, 50, 100, 400, 1600, 6400),
                   extent = 384000,
                   models = c("Nachman", "PL", "Logis", "GNB", "FNB"),
                   plot = TRUE)
</code></pre>

<hr>
<h2 id='hui.downscale'>Predict occupancy at fine grain sizes using the Hui model</h2><span id='topic+hui.downscale'></span>

<h3>Description</h3>

<p>Predict area of occupancy at fine grain sizes from atlas data using the Hui model. There is also a simple plot function. Essentially the function is equivalent to <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+predict.downscale">predict.downscale</a></code> combined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hui.downscale(atlas.data, cell.width, new.areas, extent = NULL,
              tolerance = 1e-6, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hui.downscale_+3A_atlas.data">atlas.data</code></td>
<td>
<p>either an object of class <code>"upgrain"</code>; or a raster file where 1 = presence and 0 = absence; or a spatial points object of class sf with a single column of presence (1) and absences (0); or a data frame containing these columns: <code>presence</code> = presence - absence data; <code>x</code> = easting coordinates of cells; <code>y</code> = northing coordinates of cells.</p>
</td></tr>
<tr><td><code id="hui.downscale_+3A_cell.width">cell.width</code></td>
<td>
<p>the cell width of the atlas data.</p>
</td></tr>
<tr><td><code id="hui.downscale_+3A_new.areas">new.areas</code></td>
<td>
<p>vector of grain sizes as cell area (in same units as cell.width but squared e.g. km^2) at fine scales for model prediction.</p>
</td></tr>
<tr><td><code id="hui.downscale_+3A_extent">extent</code></td>
<td>
<p>the extent of the atlas data in same units as <code>cell.areas</code>. If the input data is of class <code>"upgrain"</code> this can be left as <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="hui.downscale_+3A_tolerance">tolerance</code></td>
<td>
<p>tolerance for root solving to estimate probability of absence at the fine scale (default = <code>1e-6</code>).</p>
</td></tr>
<tr><td><code id="hui.downscale_+3A_plot">plot</code></td>
<td>
<p>if <code>plot = TRUE</code> (default = <code>FALSE</code>) plots observed and predicted occupancies against grain size on a log-log plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates fine-scale occupancy from atlas-scale data using the model developed by Hui. The model requires presence-absence data only at a single scale (the atlas scale) and calculates the probability of occupancy at a fine scale through the conditional probability that at the atlas scale a randomly chosen cell adjacent to an occupied cell is also occupied. Plotting can be called directly from <code><a href="#topic+hui.downscale">hui.downscale</a></code> or from <code><a href="#topic+plot.predict.downscale">plot.predict.downscale</a></code>.
</p>
<p>NOTE: if comparing occupancy predictions from the Hui model with those from other models using <code><a href="#topic+downscale">downscale</a></code> it is important that the atlas data used here is the standardised atlas data whose extent is the same as the largest grain size used in the other models. This ensures that all models are modelling the proportion of occupancy of the same extent. This standardised atlas raster can be obtained through the <code><a href="#topic+upgrain">upgrain</a></code> function (see <code>vignette("Upgraining", package = "downscale")</code> for more details.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'predict.downscale'</code> with three
objects:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>Downscaling model used (Hui model in this case).</p>
</td></tr>
<tr><td><code>predicted</code></td>
<td>
<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for which occupancy have been estimated</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Predicted area of occupancy for each grain size</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for which occupancy have been
       observed</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Observed area of occupancy for each grain
       size</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt; with input from Louise Barwell and Cang Hui.
</p>


<h3>References</h3>

<p>Hui, C. (2009). On the scaling patterns of species spatial distribution and association. <em>Journal of Theoretical Biology</em> 261, 481-487.
</p>
<p>Hui, C., McGeoch, M.A., &amp; Warren, M. (2006). A spatially explicit approach to estimating species occupancy and spatial correlation. <em>Journal of Animal Ecology</em> 7, 140-147.
</p>
<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software</em> 86(Code Snippet 3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+downscale">downscale</a></code> for estimating parameters of a downscaling function from observed occupancies at coarse grain sizes using
other downscaling models.
</p>
<p>See <code><a href="#topic+upgrain">upgrain</a></code> for creating extent-standardised atlas data as an input.
</p>
<p>See <code><a href="#topic+ensemble.downscale">ensemble.downscale</a></code> for ensemble modelling of multiple downscaling models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "x", "y"
## and "presence"
head(atlas.data)

## Fit Hui model to atlas.data
(hui &lt;- hui.downscale(atlas.data, 
                      cell.width = 10,
                      extent = 228900,
                      new.areas = c(1, 2, 5, 15, 50,75),
                      plot = TRUE))

## Fit Hui model to standardised atlas data for comparison with other models
## First, upgrain data (using All Sampled threshold)
occupancy &lt;- upgrain(atlas.data,
                     cell.width = 10,
                     scales = 3,
                     method = "All_Sampled")
                     
## the "upgrain" object can be used as input for the Hui model
(hui.stand &lt;- hui.downscale(occupancy,
                            cell.width = 10,
                            new.areas = c(1, 2, 5, 15, 50,75),
                            plot = TRUE))

## compare the area of occupancy (AOO) predictions of the two models
hui$predicted
hui.stand$predicted
</code></pre>

<hr>
<h2 id='plot.predict.downscale'>Plotting of downscaled occupancy at fine grain sizes</h2><span id='topic+plot.predict.downscale'></span>

<h3>Description</h3>

<p>A simple plotting function of <code>predict.downscale</code> objects. Occupancy is plotted against grain size (cell area) in log-log space. Observed occupancy at large grain sizes are plotted in black, and occupancies predicted through <code><a href="#topic+predict.downscale">predict.downscale</a></code> plotted in red.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.downscale'
plot(x, xlim = NULL, ylim = NULL,
     xlab = NULL, ylab = NULL, main = NULL, lwd.obs = NULL, lwd.pred = NULL,
     col.obs = NULL, col.pred = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.predict.downscale_+3A_x">x</code></td>
<td>
<p>Output object from <code>predict.downscale</code> and of class 
<code>predict.downscale</code></p>
</td></tr>
<tr><td><code id="plot.predict.downscale_+3A_xlim">xlim</code>, <code id="plot.predict.downscale_+3A_ylim">ylim</code></td>
<td>
<p>limits of axes. Defaults to minimum and maximum of data.</p>
</td></tr>
<tr><td><code id="plot.predict.downscale_+3A_xlab">xlab</code>, <code id="plot.predict.downscale_+3A_ylab">ylab</code>, <code id="plot.predict.downscale_+3A_main">main</code></td>
<td>
<p>axis labels and title.</p>
</td></tr>
<tr><td><code id="plot.predict.downscale_+3A_lwd.obs">lwd.obs</code>, <code id="plot.predict.downscale_+3A_lwd.pred">lwd.pred</code></td>
<td>
<p>line width of observed and predicted occupancies (<code>default</code> = 2).</p>
</td></tr>
<tr><td><code id="plot.predict.downscale_+3A_col.obs">col.obs</code>, <code id="plot.predict.downscale_+3A_col.pred">col.pred</code></td>
<td>
<p>line and point colours of observed (<code>default</code> = black) and predicted (<code>default</code> = red) occupancies.</p>
</td></tr>
<tr><td><code id="plot.predict.downscale_+3A_...">...</code></td>
<td>
<p>arguments, including graphical parameters passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No returned value.
</p>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt;.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+predict.downscale">predict.downscale</a></code> and <code><a href="#topic+hui.downscale">hui.downscale</a></code> for generating <code>predict.downscale</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## upgrain data (using All Occurrences threshold)
occupancy &lt;- upgrain(atlas.data,
                     cell.width = 10,
                     scales = 3,
                     method = "All_Sampled",
                     plot = FALSE)

## Logistic model
logis &lt;- downscale(occupancies = occupancy,
                   model = "Logis")

## predict occupancies at fine scales
logis.pred &lt;- predict(logis,
                      new.areas = c(1, 5, 25, 100, 400, 1600, 6400))

## plot predictions
plot(logis.pred)

## change some of the plotting arguments
plot(logis.pred,
     col.obs = "blue",
     pch = 16,
     ylim = c(0.01, 0.7))
</code></pre>

<hr>
<h2 id='predict.downscale'>Predict occupancy at fine grain sizes</h2><span id='topic+predict.downscale'></span>

<h3>Description</h3>

<p>Predict proportion of occupancy at fine grain sizes using parameters from an object of class <code>downscale</code> estimated from coarse grain sizes using <code><a href="#topic+downscale">downscale</a></code>. Proportion of occupancy is converted to area of occupancy (AOO) by multiplying by the extent. There is also a simple plot function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'downscale'
predict(object, new.areas, tolerance = 1e-6, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.downscale_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code>'downscale'</code>.</p>
</td></tr>
<tr><td><code id="predict.downscale_+3A_new.areas">new.areas</code></td>
<td>
<p>vector of grain sizes (in squared units e.g. km^2) for which area of occupancy will be predicted.</p>
</td></tr>
<tr><td><code id="predict.downscale_+3A_tolerance">tolerance</code></td>
<td>
<p>only applicable for the <code>Thomas</code> model. The tolerance used during integration in the Thomas model during optimisation of parameters. Lower numbers allow for greater accuracy but require longer processing times (default = <code>1e-6</code>).</p>
</td></tr>
<tr><td><code id="predict.downscale_+3A_plot">plot</code></td>
<td>
<p>if <code>plot = TRUE</code> (default) plots observed and predicted occupancies against grain size on a log-log plot using 
<code><a href="#topic+plot.predict.downscale">plot.predict.downscale</a></code>.</p>
</td></tr>
<tr><td><code id="predict.downscale_+3A_...">...</code></td>
<td>
<p>arguments, including graphical parameters for <code><a href="#topic+plot.predict.downscale">plot.predict.downscale</a></code>, passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function takes the parameters for a downscaling model estimated through <code><a href="#topic+downscale">downscale</a></code> and uses the model to predict area of occupancy at finer grain sizes. See <code><a href="#topic+downscale">downscale</a></code> for details on the downscaling models and their parameterisation. Plotting can be called directly from <code><a href="#topic+predict.downscale">predict.downscale</a></code> or from <code><a href="#topic+plot.predict.downscale">plot.predict.downscale</a></code>.
</p>
<p>For predictions using the Thomas model, if the tolerance value is not sufficiently low it may lead to innacurate results. Typically, this will be indicated by fine grain sizes with higher predicted occupancies than those at larger grain sizes. In these cases try a lower tolerance value in the arguments.
</p>


<h3>Value</h3>

<p><code>predict</code> returns an object of class <code>'predict.downscale'</code> with three objects:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>Downscaling model used.</p>
</td></tr>
<tr><td><code>predicted</code></td>
<td>
<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for which occupancies have been estimated</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Predicted proportion of occupancy for each grain size</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>AOO</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Predicted area of occupancy (proportion of area occupancy multiplied by extent)</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Data frame containing two columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for which occupancies have been observed</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Observed proportion of occupancy for each grain size</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt; with input from Louise Barwell.
</p>


<h3>References</h3>

<p>Azaele, S., Cornell, S.J., &amp; Kunin, W.E. (2012). Downscaling
species occupancy from coarse spatial scales. <em>Ecological
Applications</em> 22, 1004-1014.
</p>
<p>Barwell, L.J., Azaele, S., Kunin, W.E., &amp; Isaac, N.J.B. (2014).
Can coarse-grain patterns in insect atlas data predict local occupancy?
<em>Diversity and Distributions</em> 20, 895-907.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+downscale">downscale</a></code> for estimating parameters of a
downscaling function from observed occupancies at coarse grain sizes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "lon", "lat"
## and "presence"
head(atlas.data)

## explore thresholds using upgrain.threshold
thresh &lt;- upgrain.threshold(atlas.data = atlas.data,
                            cell.width = 10,
                            scales = 3,
                            thresholds = seq(0, 1, 0.1))

## upgrain data (using All Sampled threshold)
occupancy &lt;- upgrain(atlas.data,
                     cell.width = 10,
                     scales = 3,
                     method = "All_Sampled")

## Logistic model
(logis &lt;- downscale(occupancies = occupancy,
                      model = "Logis"))

## Predictions occupancy at finer scales
logis.pred &lt;- predict(logis,
                      new.areas = c(1, 2, 5, 25, 100),
                      plot = FALSE)
logis.pred
plot(logis.pred)

## It can also be a good idea to include the observed cell sizes in the
## predictions to observe the fit of the model (this time run plot = TRUE)
predict(logis,
        new.areas = c(1, 2, 5, 25, 100, 400, 1600, 6400),
        plot = TRUE)
</code></pre>

<hr>
<h2 id='upgrain'>Upgraining of atlas data to larger grain sizes</h2><span id='topic+upgrain'></span>

<h3>Description</h3>

<p>Takes presence-absence atlas data and aggregates data to larger grain sizes, returning occupancy at each grain size for use in  <code><a href="#topic+downscale">downscale</a></code> modelling. Atlas data may be in the form of raster data or as a data frame with presence-absence information and cell coordinates.
</p>
<p>The extent for all scales is standardised to that of the largest grain size by applying a threshold for the proportion of unsampled atlas cells allowed within a cell at the largest grain size. The threshold can be chosen by the user or one of four threshold selections methods apply. See <code><a href="#topic+upgrain.threshold">upgrain.threshold</a></code> for a visualisation of the thresholds.
</p>
<p>The function outputs a data frame of occupancies suitable as input for <code><a href="#topic+downscale">downscale</a></code>, and will also plot the original atlas data along with the standardised data for each upgrained scale. In all plots presence = red, absence = white, and NA = grey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upgrain(atlas.data, cell.width = NULL, scales, threshold = NULL,
        method = "All_Sampled", plot = TRUE, return.rasters = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="upgrain_+3A_atlas.data">atlas.data</code></td>
<td>
<p>either a raster file of presence-absence; a spatial points object of class sf where the data frame contains a single column of presence (1) and absences (0); or a data frame of sampled cells, which must contain columns named 'x', 'y' and 'presence'.</p>
</td></tr>
<tr><td><code id="upgrain_+3A_cell.width">cell.width</code></td>
<td>
<p>if data is a data frame or sf spatial points object, the cell widths of sampled cells. If data is a raster then leave as default (<code>= NULL</code>)</p>
</td></tr>
<tr><td><code id="upgrain_+3A_scales">scales</code></td>
<td>
<p>the number of cells to upgrain. Upgraining will happen by factors of 2 - ie if scales = 3, the atlas data will be aggregated in 2x2 cells, 4x4 cells and 8x8 cells.</p>
</td></tr>
<tr><td><code id="upgrain_+3A_threshold">threshold</code></td>
<td>
<p>default = <code>NULL</code>. A user defined threshold for the proportion of unsampled atlas cells allowed within a cell at the largest grain size. Note: if a <code>method</code> is selected then threshold must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="upgrain_+3A_method">method</code></td>
<td>
<p>one of <code>"All_Sampled"</code>, <code>"All_Occurrences"</code>, <code>"Gain_Equals_Loss"</code> or <code>"Sampled_Only"</code> (default = <code>"All_Sampled"</code>). If the user wishes to define their own <code>threshold</code> then method must equal <code>NULL</code>. See <code>details</code> and <code><a href="#topic+upgrain.threshold">upgrain.threshold</a></code> for descriptions of the different methods.</p>
</td></tr>
<tr><td><code id="upgrain_+3A_plot">plot</code></td>
<td>
<p>default = <code>TRUE</code>. Plots the original atlas data alongside the standardised atlas data at each grain size.</p>
</td></tr>
<tr><td><code id="upgrain_+3A_return.rasters">return.rasters</code></td>
<td>
<p>default = <code>FALSE</code>. If <code>TRUE</code> returns the extent-standardised atlas data upgrained to all grain sizes (NOTE: the extent-standardised atlas data at the original grain size is always returned regardless).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When aggregating data to larger grain sizes, the extent of all grain sizes is set to the extent of the largest grain size. At the atlas scale, unsampled NA cells that fall within this extent are assigned as absences. This ensures that there are subsequently equal extents across all scales and therefore consistency of occupancy estimates. Therefore, it is necessary to apply a threshold whereby only those cells at the largest grain size are retained if a certain proportion of them are sampled at the altas scale. However, there is a trade-off between assigning unsampled cells as absences, and discarding sampled cells and presences.
</p>
<p>It is highly advisable before selecting a threshold to explore this trade-off on a case-by-case basis with <code><a href="#topic+upgrain.threshold">upgrain.threshold</a></code> and to read the help file therein as well as referring to <code>vignette("Upgraining", package = "downscale")</code>.
</p>

<p>The user may input their own threshold or use one of four suggested threshold criteria:

</p>

<table>
<tr>
 <td style="text-align: left;">
      Threshold </td><td style="text-align: left;">  Method </td><td style="text-align: left;"> </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
      0  </td><td style="text-align: left;"> All_Sampled	</td><td style="text-align: left;"> </td><td style="text-align: left;"> All of the original atlas data is included. </td>
</tr>
<tr>
 <td style="text-align: left;">
      Species specific </td><td style="text-align: left;">	All_Occurrences </td><td style="text-align: left;"> </td><td style="text-align: left;">	The threshold where no occurrences in the atlas data are excluded. </td>
</tr>
<tr>
 <td style="text-align: left;">
      Atlas specific </td><td style="text-align: left;">	Gain_Equals_Loss </td><td style="text-align: left;"> </td><td style="text-align: left;">	The threshold where the number of sampled atlas cells reclassified as No Data equals the number of unsampled exterior cells reclassified as absence. In this threshold the new standardised extent also equals the extent of the original atlas data. </td>
</tr>
<tr>
 <td style="text-align: left;">
      1 </td><td style="text-align: left;">	Sampled_Only </td><td style="text-align: left;"> </td><td style="text-align: left;">	Only cells that contain 100% sampled atlas data are included. </td>
</tr>
<tr>
 <td style="text-align: left;">
      </td>
</tr>

</table>



<p><img src="../help/figures/Maps.png" width="75%" alt="Figure: Maps.png" />

</p>


<h3>Value</h3>

<p>Returns a list of class <code>"upgrain"</code> that can be used as a direct input to <code><a href="#topic+downscale">downscale</a></code> and <code><a href="#topic+hui.downscale">hui.downscale</a></code>. The list contains five objects:
</p>
<table role = "presentation">
<tr><td><code>threshold</code></td>
<td>
<p>The proportion of unsampled atlas cells allowed within a cell at the largest grain size, either defined by the user through <code>threshold</code> or calculated according to <code>method</code>.</p>
</td></tr>
<tr><td><code>extent.stand</code></td>
<td>
<p>The standardised extent after upgraining (equal to the extent of the largest grain size)</p>
</td></tr>
<tr><td><code>occupancy.stand</code></td>
<td>
<p>Occupancy for each grain size where extent has been standardised. The data frame contains three columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for for each upgrained scale.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Extent</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Extent for each grain size.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Observed area of occupancy for each grain
       size.</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
<tr><td><code>occupancy.orig</code></td>
<td>
<p>Original occupancies for each grain size before extent has been standardised. The data frame contains three columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Cell.area</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Grain sizes for for each upgrained scale.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Extent</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Extent for each grain size.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Occupancy</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Observed area of occupancy for each grain
       size.</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
<tr><td><code>atlas.raster.stand</code></td>
<td>
<p>A raster layer of the extent-standardised atlas data</p>
</td></tr>
<tr><td><code>scaled.rasters</code></td>
<td>
<p>If <code>return.rasters = TRUE</code>. A list containing the extent-standardised atlas data upgrained to all grain sizes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt;
</p>


<h3>References</h3>

<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software</em> 86(Code Snippet 3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "x", "y"
## and "presence"
head(atlas.data)

## explore thresholds using upgrain.threshold
thresh &lt;- upgrain.threshold(atlas.data = atlas.data,
                            cell.width = 10,
                            scales = 3,
                            thresholds = seq(0, 1, 0.1))

## use a specified threshold - method must equal NULL
upgrain(atlas.data = atlas.data,
        cell.width= 10,
        scales = 3,
        threshold = 0.15,
        method = NULL)
        
## use one of the suggested methods - do not specify a threshold
all_sampled &lt;- upgrain(atlas.data = atlas.data,
                       cell.width= 10,
                       scales = 3,
                       method = "All_Sampled")
        

## input data for downscale for All Sampled threshold
all_sampled$occupancy.stand

## and the original occupancies (note that extent varies with scale)
all_sampled$occupancy.orig

## if data is an sf spatial points object
presence &lt;- data.frame(presence = atlas.data$presence)
spdf &lt;- sf::st_as_sf(atlas.data, coords = c("x", "y"))
                               
all_sampled &lt;- upgrain(atlas.data = spdf,
                       cell.width= 10,
                       scales = 3,
                       method = "All_Sampled")
</code></pre>

<hr>
<h2 id='upgrain.threshold'>Exploration of trade-offs in threshold selection for upgraining</h2><span id='topic+upgrain.threshold'></span>

<h3>Description</h3>

<p>Explores the NoData threshold selection for upgraining whilst keeping a constant extent across scales. The thresholds are the quantity of unsampled cells at the atlas scale allowed within each cell at the largest grain size. A low threshold means that many unsampled cells will be assigned as absences, whereas a high threshold will mean that many sampled cells and many presence records will be excluded. These trade-offs are plotted, and four possible threshold choices are suggested and their maps presented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upgrain.threshold(atlas.data, cell.width = NULL, scales,
                  thresholds = seq(0, 1, 0.01), plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="upgrain.threshold_+3A_atlas.data">atlas.data</code></td>
<td>
<p>either a raster file of presence-absence; a spatial points object of class sf where the data frame contains a single column of presence (1) and absences (0); or a data frame of sampled cells, which must contain columns named 'x', 'y' and 'presence'.</p>
</td></tr>
<tr><td><code id="upgrain.threshold_+3A_cell.width">cell.width</code></td>
<td>
<p>if data is a data frame or sf spatial points object, the cell widths of sampled cells. If data is a raster then leave as default (<code>= NULL</code>)</p>
</td></tr>
<tr><td><code id="upgrain.threshold_+3A_scales">scales</code></td>
<td>
<p>the number of cells to upgrain. Upgraining will happen by factors of 2 - ie if scales = 3, the atlas data will be aggregated in 2x2 cells, 4x4 cells and 8x8 cells.</p>
</td></tr>
<tr><td><code id="upgrain.threshold_+3A_thresholds">thresholds</code></td>
<td>
<p>a vector of thresholds between and including 0 and 1 for the quantity of unsampled NA cells that can be included.</p>
</td></tr>
<tr><td><code id="upgrain.threshold_+3A_plot">plot</code></td>
<td>
<p>Two sets of four plots (hit return to see the next set). Default = TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A more detailed description is available at <code>vignette("Upgraining", package = "downscale")</code>.
</p>
<p>In order to <code><a href="#topic+downscale">downscale</a></code> we need to <code><a href="#topic+upgrain">upgrain</a></code> our atlas data across several scales. However, if the atlas data is not rectangular, as we aggregate cells during upgraining then the extent also increases.
</p>
<p><img src="../help/figures/Original.png" width="100%" alt="Figure: Original.png" />

</p>
<p>Instead we must ensure the extent is constant across all scales by fixing the extent at all grain sizes to the extent of the largest grain size and convert our proportion of occupied cells back to area of occupancy by using the standardised extent (not the original atlas data extent).
</p>
<p>However, if we fix the extent there is trade-off between assigning large areas of unsampled areas as absence, and discarding sampled areas and known Occurrences. The <code>upgrain.threshold</code> function allows visualisations of this trade-off at the atlas scale through four plots:
</p>


<table>
<tr>
 <td style="text-align: left;">
a) </td><td style="text-align: left;"> </td><td style="text-align: left;">  The total standardised extent; </td>
</tr>
<tr>
 <td style="text-align: left;">
b) </td><td style="text-align: left;"> </td><td style="text-align: left;">  The number of unsampled cells added and assigned as absences, and the number of sampled cells excluded and assigned as No Data; </td>
</tr>
<tr>
 <td style="text-align: left;">
c) </td><td style="text-align: left;"> </td><td style="text-align: left;">  The proportion of the original atlas data retained; </td>
</tr>
<tr>
 <td style="text-align: left;">
d) </td><td style="text-align: left;"> </td><td style="text-align: left;">  The proportion of known Occurrences excluded. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<p>The final choice of threshold is up to the user on a case-by-case basis but we propose four threshold criteria in this function:

</p>

<table>
<tr>
 <td style="text-align: left;">
      Threshold </td><td style="text-align: left;">  Method </td><td style="text-align: left;"> </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
      0  </td><td style="text-align: left;"> All_Sampled  </td><td style="text-align: left;"> </td><td style="text-align: left;"> All of the original atlas data is included. </td>
</tr>
<tr>
 <td style="text-align: left;">
      Species specific </td><td style="text-align: left;">	All_Occurrences </td><td style="text-align: left;"> </td><td style="text-align: left;">	The threshold where no occurrences in the atlas data are excluded. </td>
</tr>
<tr>
 <td style="text-align: left;">
      Atlas specific </td><td style="text-align: left;">	Gain_Equals_Loss </td><td style="text-align: left;"> </td><td style="text-align: left;">	The threshold where the number of sampled atlas cells reclassified as No Data equals the number of unsampled exterior cells reclassified as absence. In this threshold the new standardised extent also equals the extent of the original atlas data. </td>
</tr>
<tr>
 <td style="text-align: left;">
      1 </td><td style="text-align: left;">	Sampled_Only </td><td style="text-align: left;"> </td><td style="text-align: left;">	Only cells that contain 100% sampled atlas data are included. </td>
</tr>
<tr>
 <td style="text-align: left;">
      </td>
</tr>

</table>



<p>The function also creates maps for each of these four thresholds. In the example case this clearly demonstrates the trade-off between generating assumptions about unsampled areas, and losing data (and Occurrences) for the sampled atlas data.
</p>
<p><img src="../help/figures/Maps.png" width="100%" alt="Figure: Maps.png" />

</p>


<h3>Value</h3>

<p>Returns a list contatining two objects:
</p>
<table role = "presentation">
<tr><td><code>Thresholds</code></td>
<td>
<p>the threshold values for the four default threshold selections.</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>Data frame containing six columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>Thresholds</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Thresholds tested.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>SampledExluded</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Number of sampled cells exluded.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>SampledIncluded</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Number of sampled cells included.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>UnsampledAdded</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Number of unsampled NoData cells added.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Extent</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Total number of cells included.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>OccurrencesExluded</code> </td><td style="text-align: left;">  </td><td style="text-align: left;"> Number of cells with presence records excluded.</td>
</tr>
<tr>
 <td style="text-align: left;">
     </td>
</tr>

</table>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Charles Marsh &lt;<a href="mailto:charlie.marsh@mailbox.org">charlie.marsh@mailbox.org</a>&gt;
</p>


<h3>References</h3>

<p>Groom, Q., Marsh, C.J., Gavish, Y. Kunin, W.E. (2018). How to predict fine resolution occupancy from coarse occupancy data, <em>Methods in Ecology and Evolution</em>. 9(11), 2273-2284.
</p>
<p>Marsh, C.J, Barwell, L.J., Gavish, Y., Kunin, W.E. (2018). downscale: An R package for downscaling species occupancy from coarse-grain data to predict occupancy at fine-grain sizes, <em>Journal of Statistical Software</em> 86(Code Snippet 3), 1-20.
</p>
<p>Marsh, C.J, Gavish, Y., Kunin, W.E., Brummitt N.A. (2019). Mind the gap: Can downscaling Area of Occupancy overcome sampling gaps when assessing IUCN Red List status?, <em>Diversity and Distributions</em> 25, 1832-1845.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example species data
data.file &lt;- system.file("extdata", "atlas_data.txt", package = "downscale")
atlas.data &lt;- read.table(data.file, header = TRUE)

## if the input data is a data frame it must have the columns "x", "y"
## and "presence"
head(atlas.data)

thresh &lt;- upgrain.threshold(atlas.data = atlas.data,
                            cell.width = 10,
                            scales = 3,
                            thresholds = seq(0, 1, 0.02))

## the four optional thresholds
thresh$Thresholds
head(thresh$Data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
