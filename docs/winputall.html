<!DOCTYPE html><html><head><title>Help for package winputall</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {winputall}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#winputall-package'><p>The 'winputall' package.</p></a></li>
<li><a href='#my_winputall_data'><p>Example data</p></a></li>
<li><a href='#print.rpinpall'><p>Fit Input Allocation Random Parameters Model</p></a></li>
<li><a href='#rp_model_fun'><p>Random Parameters Transformation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Variable Input Allocation Among Crops</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Using a time-varying random parameters model developed in
    Koutchade et al., (2024) <a href="https://hal.science/hal-04318163">https://hal.science/hal-04318163</a>, this
    package allows allocating variable input costs among crops produced by
    farmers based on panel data including information on input expenditure
    aggregated at the farm level and acreage shares. It also considers in
    fairly way the weighting data and can allow integrating time-varying
    and time-constant control variables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, future, future.apply, graphics, ks, LearnBayes, MASS,
Matrix, matrixcalc, matrixStats, methods, plm, Rcpp (&ge;
0.12.0), RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), rstantools
(&ge; 2.4.0), stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-07 11:03:14 UTC; opkoutchade</td>
</tr>
<tr>
<td>Author:</td>
<td>Obafèmi Philippe Koutchade
    <a href="https://orcid.org/0000-0001-7327-3139"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Fabienne Femenia [aut],
  Alain Carpentier [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Obafèmi Philippe Koutchade &lt;obafemi-philippe.koutchade@inrae.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-07 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='winputall-package'>The 'winputall' package.</h2><span id='topic+winputall-package'></span><span id='topic+winputall'></span>

<h3>Description</h3>

<p>Using a time-varying random parameters model, this package allows
allocating variable input costs among crops produced by farmers based on panel
data including information on input expenditure aggregated at the farm level
and acreage shares. It also considers in fairly way the weighting data and
can allow integrating time-varying and time-constant control variables.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Obafèmi Philippe Koutchade <a href="mailto:obafemi-philippe.koutchade@inrae.fr">obafemi-philippe.koutchade@inrae.fr</a> (<a href="https://orcid.org/0000-0001-7327-3139">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Fabienne Femenia <a href="mailto:fabienne.femenia@inrae.fr">fabienne.femenia@inrae.fr</a>
</p>
</li>
<li><p> Alain Carpentier <a href="mailto:alain.carpentier@inrae.fr">alain.carpentier@inrae.fr</a>
</p>
</li></ul>



<h3>References</h3>

<p>Koutchade Obafèmi Philippe, Fabienne Femenia, Alain Carpentier (2024).Variable Input Allocation Among Crops: A Time-Varying Random Parameters Approach https://hal.science/hal-04318163
</p>

<hr>
<h2 id='my_winputall_data'>Example data</h2><span id='topic+my_winputall_data'></span>

<h3>Description</h3>

<p>An unbalanced panel data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>my_winputall_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 175 rows and 9 variables:
</p>

<dl>
<dt>id</dt><dd><p>individual index</p>
</dd>
<dt>year</dt><dd><p>time index</p>
</dd>
<dt>tx</dt><dd><p>Total input uses</p>
</dd>
<dt>s_crop1</dt><dd><p>acreage of crop number 1</p>
</dd>
<dt>s_crop2</dt><dd><p>acreage of crop number 2</p>
</dd>
<dt>s_crop3</dt><dd><p>acreage of crop number 3</p>
</dd>
<dt>k</dt><dd><p>Capital</p>
</dd>
<dt>tempmoy</dt><dd><p>Temperature</p>
</dd>
<dt>precip</dt><dd><p>Annual precipitation</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='print.rpinpall'>Fit Input Allocation Random Parameters Model</h2><span id='topic+print.rpinpall'></span><span id='topic+summary.rpinpall'></span><span id='topic+plot.rpinpall'></span><span id='topic+rpinpallEst'></span>

<h3>Description</h3>

<p>Designed to fit a random parameters input allocation
model proposed in Koutchade et al., (2024) <a href="https://hal.science/hal-04318163">https://hal.science/hal-04318163</a>.
It provides crops input cost for each individual at each time and can account
for Weighted Panel Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rpinpall'
print(x, error = FALSE, ...)

## S3 method for class 'rpinpall'
summary(object, ...)

## S3 method for class 'rpinpall'
plot(x, ...)

rpinpallEst(
  data,
  id_time,
  total_input,
  crop_acreage,
  crop_indvar = NULL,
  crop_rp_indvar = NULL,
  weight = NULL,
  distrib_method = c("lognormal", "normal", "censored-normal"),
  sim_method = c("map_imh", "mhrw", "marg_imh", "mhrw_imh", "nuts", "variat",
    "lapl_approx"),
  calib_method = c("cmode", "cmean", "rscd", "estim-sim"),
  saem_control = list(),
  par_init = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rpinpall_+3A_x">x</code></td>
<td>
<p>An object produced by the function <code>rpinpallEst</code>, to be displayed</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_error">error</code></td>
<td>
<p>logical. If TRUE, residuals are considered in variable input prediction</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_object">object</code></td>
<td>
<p>An object produced by the function <code>rpinpallEst</code>, to be displayed</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_data">data</code></td>
<td>
<p>name of the data frame or matrix containing all the variables
included in the model.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_id_time">id_time</code></td>
<td>
<p>first (individual) and second (time) level variables allowing
characterizing panel data.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_total_input">total_input</code></td>
<td>
<p>variable (name) containing the total input used  at farm
level per ha to be allocated to the different crops.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_crop_acreage">crop_acreage</code></td>
<td>
<p>list of variables containing the acreage of the different crops.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_crop_indvar">crop_indvar</code></td>
<td>
<p>optional list of vector of (time-varying) variables
specific to each crop used to control for observed (individual and/or temporal)
characteristics in the estimation process. Default=NULL.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_crop_rp_indvar">crop_rp_indvar</code></td>
<td>
<p>optional list of vector of (time-constant) variables
specific to each crop used to control for observed time-constant
characteristics in the estimation process. Default=NULL.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_weight">weight</code></td>
<td>
<p>optional variable containing weights of individual sample farms.
Default=NULL (equal weight is given to each farm). Default=NULL.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_distrib_method">distrib_method</code></td>
<td>
<p>assumption on the distribution of input use
per crop (x_kit): &quot;normal&quot;, &quot;lognormal&quot; or &quot;censored-normal&quot;. Default=&quot;lognormal&quot;.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_sim_method">sim_method</code></td>
<td>
<p>method used to draw the random parameters in the simulation
step of the SAEM algorithm in the estimation process: &quot;map_imh&quot; (independant
Metropolis Hasting with Laplace approximation as proposal distribution),
&quot;marg_imh&quot; (independant Metropolis Hasting with marginal distribution of
random pararameters as proposal distribution), &quot;mhrw&quot; (Metropolis Hasting Random Walk),
&quot;mhrw_imh&quot; (combined &quot;imh&quot; and &quot;mhrw&quot;), &quot;nuts&quot;,&quot;variat&quot; and&quot;lapl_approx&quot;. Default= &quot;map_imh&quot;.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_calib_method">calib_method</code></td>
<td>
<p>method used: &quot;cmode&quot; (conditional mode),
&quot;cmean&quot; (conditional mean). Default=&quot;cmode&quot;.</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_saem_control">saem_control</code></td>
<td>
<p>list of options for the SAEM algorithm. See 'Details</p>
</td></tr>
<tr><td><code id="print.rpinpall_+3A_par_init">par_init</code></td>
<td>
<p>list of some parameters' initialization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An SAEM algorithm is used to perform the estimation of input uses per crop.
Different options can be specified by the user for this algorithm in the saem_control argument.
The saem_control argument is list that can supply any of the following component.
</p>

<ul>
<li> <p><code>nb_burn_saem</code>: Number of iterations of the burn-in phase where individual
parameters are sampled from their conditional distribution using
sim_method and the initial values for model parameters without update
these parameters. Default=20.
</p>
</li>
<li> <p><code>nb_SA</code>: Number of iterations in the exploration phase where algorithm
explore parameters space without memory. The parameter that controls the
convergence of the algorithm is set to 1. Default=200.
</p>
</li>
<li> <p><code>nb_smooth</code>: Number of iterations in the smoothing phase.Default=200 and
the parameter that controls the convergence of the algorithm is set to 0.85 by default.
</p>
</li>
<li> <p><code>nb_RS</code>: Number of iterations where tempering approach is used
</p>
</li>
<li> <p><code>tol</code>: Tolerance value for the convergence. Default 1.10-3.
</p>
</li>
<li> <p><code>estim_rdraw</code>: Number of random draws using in the estimation process. Default=100
</p>
</li>
<li> <p><code>calib_rdraw</code>: Number of random draws using in the calibration process. Default=100
</p>
</li>
<li> <p><code>stde_rdraw</code>:  Number of random draws using for computation of estimation
standard errors. Default=100
</p>
</li>
<li> <p><code>p_SA</code>: Parameter determining  step sizes in the Stochastic
Approximation (SA) step. Must be comprise between 0 and 1. Default=0.85
</p>
</li>
<li> <p><code>doParallels</code>:  Logical.If TRUE a parallel processing is used when more
than 2 cores are available. Default=FALSE
</p>
</li>
<li> <p><code>doTempering</code>: Logical. If TRUE the tempering approach proposed by
(Allassonnière and Chevallier, 2021) is used to avoid convergence to local
maxima. Default=TRUE
</p>
</li>
<li> <p><code>doDiagEps</code>: = &quot;2&quot;,
</p>
</li>
<li> <p><code>showProgress</code>: Logical. If TRUE the evolution of the estimation process is
displayed graphically at the bottom of the screen. Default=TRUE
</p>
</li>
<li> <p><code>showIterConvLL</code>: Logical. If TRUE iteration number and convergence value
are displayed during the estimation process. Default=FALSE
</p>
</li></ul>



<h3>Value</h3>

<p>Distribution of estimated crop input uses.
</p>
<p>This function returns a list with the following components:
</p>

<ul>
<li> <p><code>xit_pred</code>: matrix of predicted crop input used per ha.
</p>
</li>
<li> <p><code>xit_pred_with_error</code>: matrix of predicted crop input used per ha.
</p>
</li>
<li> <p><code>yit_predict</code>: vector of predicted totat input used.
</p>
</li>
<li> <p><code>est_pop</code> list of results of estimation: estimated parameters.
</p>
</li>
<li> <p><code>est_stde</code>list of  parameters standard errors.
</p>
</li>
<li> <p><code>call</code>: a copy of the function call.
</p>
</li>
<li> <p><code>opt</code>: a list of saem algorithm control parameters.
</p>
</li>
<li> <p><code>conv_ind_cll</code>: vector of convergence indicator.
</p>
</li>
<li> <p><code>data_list</code>: a list of individual data used for estimation.
</p>
</li></ul>



<h3>Functions</h3>


<ul>
<li> <p><code>print(rpinpall)</code>: Displays the distribution of estimated crop input uses accounting for error by default
</p>
</li>
<li> <p><code>summary(rpinpall)</code>: Displays a summary of estimated parameters
</p>
</li>
<li> <p><code>plot(rpinpall)</code>: Plot the &quot;global&quot; convergence indicator
</p>
</li></ul>


<h3>References</h3>

<p>Koutchade, O. P., Carpentier A. and Femenia F. (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(my_winputall_data)
mydata &lt;- my_winputall_data
fit &lt;- rpinpallEst(data = my_winputall_data,
                   id_time = c("id","year"),
                   total_input = "tx",
                   crop_acreage = c("s_crop1","s_crop2","s_crop3"),
                   distrib_method = "lognormal",
                   sim_method = "map_imh",
                   calib_method = "cmode",
                   saem_control = list(nb_SA = 10, nb_smooth = 10, estim_rdraw = 10))
print(fit)
plot(fit)
summary(fit)
head(fit$xit_pred)


</code></pre>

<hr>
<h2 id='rp_model_fun'>Random Parameters Transformation</h2><span id='topic+rp_model_fun'></span>

<h3>Description</h3>

<p>rp.model.fun is used to tranform the random parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rp_model_fun(beta, opt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rp_model_fun_+3A_beta">beta</code></td>
<td>
<p>vector of random parameters. beta follows multivariate normal distribution.</p>
</td></tr>
<tr><td><code id="rp_model_fun_+3A_opt">opt</code></td>
<td>
<p>a list of control parameters. See rpinpall.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the transformed beta
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
