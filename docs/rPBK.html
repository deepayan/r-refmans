<!DOCTYPE html><html><head><title>Help for package rPBK</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rPBK}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dataCompartment4'><p>An example data set with 4 compartment</p></a></li>
<li><a href='#dataMaleGammarusSingle'><p>An example data set with 1 compartment</p></a></li>
<li><a href='#dataPBK'><p>Create a list giving data and parameters to use in the model inference.</p></a></li>
<li><a href='#df_quant95_'><p>Compute 95 credible intervals</p></a></li>
<li><a href='#export_interpolate'><p>Interpolate function implemented in Stan only export for checking</p></a></li>
<li><a href='#fitPBK'><p>Bayesian inference of TK model with Stan</p></a></li>
<li><a href='#fitPBK_C4'><p>An example of fitPBK object</p></a></li>
<li><a href='#plot.fitPBK'><p>Plotting method for <code>fitPBK</code> objects</p></a></li>
<li><a href='#ppc'><p>Posterior predictive check plot</p></a></li>
<li><a href='#rPBK-package'><p>The 'rPBK' package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Inference and Prediction of Generic Physiologically-Based
Kinetic Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/rPBK/-/issues">https://gitlab.in2p3.fr/mosaic-software/rPBK/-/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/rPBK/">https://gitlab.in2p3.fr/mosaic-software/rPBK/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and simulate any kind of
    physiologically-based kinetic ('PBK') models whatever the number of compartments.
    Moreover, it allows to account for any link between pairs of compartments, as
    well as any link of each of the compartments with the external medium. Such
    generic PBK models have today applications in pharmacology (PBPK models) to
    describe drug effects, in toxicology and ecotoxicology (PBTK models) to describe
    chemical substance effects. In case of exposure to a parent compound (drug or
    chemical) the 'rPBK' package allows to consider metabolites, whatever their number
    and their phase (I, II, ...). Last but not least, package 'rPBK' can also be used for
    dynamic flux balance analysis (dFBA) to deal with metabolic networks. See also
    Charles et al. (2022) &lt;<a href="https://doi.org/10.1101%2F2022.04.29.490045">doi:10.1101/2022.04.29.490045</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, methods, Rcpp (&ge; 0.12.0), rstan (&ge; 2.26.0),
rstantools</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, loo, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 16:18:20 UTC; virgile</td>
</tr>
<tr>
<td>Author:</td>
<td>Virgile Baudrot [aut, cre],
  Sandrine Charles [aut],
  Christelle Lopes [aut],
  Ophélia Gestin [ctb],
  Dominique Lamonica [ctb],
  Aurélie Siberchicot [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Virgile Baudrot &lt;virgile.baudrot@qonfluens.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dataCompartment4'>An example data set with 4 compartment</h2><span id='topic+dataCompartment4'></span>

<h3>Description</h3>

<p>A dataset containing an example with 4 compartments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataCompartment4)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 7 variables:
</p>

<dl>
<dt>temps</dt><dd><p>vector of time</p>
</dd>
<dt>condition</dt><dd><p>exposure concentration</p>
</dd>
<dt>replicat</dt><dd><p>replicate of experiment</p>
</dd>
<dt>intestin</dt><dd><p>compartiment 'intestin'</p>
</dd>
<dt>caecum</dt><dd><p>compartiment 'caecum'</p>
</dd>
<dt>cephalon</dt><dd><p>compartiment 'cephalon'</p>
</dd>
<dt>reste</dt><dd><p>compartiment 'reste'</p>
</dd></dl>
<p>#'

</p>

<hr>
<h2 id='dataMaleGammarusSingle'>An example data set with 1 compartment</h2><span id='topic+dataMaleGammarusSingle'></span>

<h3>Description</h3>

<p>A dataset containing an example with a single compartment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataMaleGammarusSingle)
</code></pre>


<h3>Format</h3>

<p>A data frame with 22 rows and 4 variables:
</p>

<dl>
<dt>time</dt><dd><p>vector of time</p>
</dd>
<dt>expw </dt><dd><p>exposure concentration</p>
</dd>
<dt>replicate</dt><dd><p>replicat of experiment</p>
</dd>
<dt>conc</dt><dd><p>internal measured concentration</p>
</dd></dl>
<p>#'

</p>

<hr>
<h2 id='dataPBK'>Create a list giving data and parameters to use in the model inference.</h2><span id='topic+dataPBK'></span><span id='topic+dataPBK.data.frame'></span><span id='topic+nested_model'></span><span id='topic+nested_model.stanPBKdata'></span>

<h3>Description</h3>

<p>Create a list giving data and parameters to use in the model inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataPBK(object, ...)

## S3 method for class 'data.frame'
dataPBK(
  object,
  col_time = NA,
  col_replicate = NA,
  col_exposure = NA,
  col_compartment = NA,
  time_accumulation = NA,
  ku_nest = NA,
  ke_nest = NA,
  k_nest = NA,
  ...
)

nested_model(object)

## S3 method for class 'stanPBKdata'
nested_model(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataPBK_+3A_object">object</code></td>
<td>
<p>An object of class <code>stanPBKdata</code> (from <code>dataPBK()</code> function.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_col_time">col_time</code></td>
<td>
<p>Column name of the time column</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_col_replicate">col_replicate</code></td>
<td>
<p>Column name of the replicate column</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_col_exposure">col_exposure</code></td>
<td>
<p>Column name of the exposure column.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_col_compartment">col_compartment</code></td>
<td>
<p>Column names of the compartment column. If several columns,
give a vector with the column names.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_time_accumulation">time_accumulation</code></td>
<td>
<p>A scalar giving accumulation time.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_ku_nest">ku_nest</code></td>
<td>
<p>Vector of binary (0 or 1) to select the uptake route. Use the
nested_model() on the <code>stanPBKdata</code> object to check it.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_ke_nest">ke_nest</code></td>
<td>
<p>Vector of binary (0 or 1) to select the excretion route. Use the
nested_model() on the <code>stanPBKdata</code> object to check it.</p>
</td></tr>
<tr><td><code id="dataPBK_+3A_k_nest">k_nest</code></td>
<td>
<p>Matrix of binary (0 or 1) to select interaction routes. Use the
nested_model() on the <code>stanPBKdata</code> object to check it.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> with data and parameters require for model inference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load data file
data("dataCompartment4")
# (2) prepare data set
dataPBK_C4 &lt;- dataPBK(
  object = dataCompartment4,
  col_time = "temps",
  col_replicate = "replicat",
  col_exposure = "condition",
  col_compartment = c("intestin", "reste", "caecum", "cephalon"),
  time_accumulation = 7)

# (1) load data file
data("dataCompartment4")
# (2) prepare data set
dataPBK_C4 &lt;- dataPBK(
  object = dataCompartment4,
  col_time = "temps",
  col_replicate = "replicat",
  col_exposure = "condition",
  col_compartment = c("intestin", "reste", "caecum", "cephalon"),
  time_accumulation = 7)
# (3) check nesting
nested_model(dataPBK_C4)
# (2bis)
dataPBK_C42 &lt;- dataPBK(
  object = dataCompartment4,
  col_time = "temps",
  col_replicate = "replicat",
  col_exposure = "condition",
  col_compartment = c("intestin", "reste", "caecum", "cephalon"),
  time_accumulation = 7,
  ku_nest = c(1,1,1,1), # No Change here
  ke_nest = c(1,1,1,1), # No Change here
  k_nest = matrix(c(
            c(0,1,1,1),
            c(0,0,1,1),
            c(0,0,0,0),
            c(0,0,0,0)),
            ncol=4,nrow=4,byrow=TRUE) # Remove 
  )
# (3bis) re-checking nesting
nested_model(dataPBK_C42)

</code></pre>

<hr>
<h2 id='df_quant95_'>Compute 95 credible intervals</h2><span id='topic+df_quant95_'></span>

<h3>Description</h3>

<p>Compute quantiles 95 credible intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_quant95_(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_quant95__+3A_x">x</code></td>
<td>
<p>An object of class <code>fitPBK</code></p>
</td></tr>
<tr><td><code id="df_quant95__+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> returning median and 95 credible interval
</p>

<hr>
<h2 id='export_interpolate'>Interpolate function implemented in Stan only export for checking</h2><span id='topic+export_interpolate'></span>

<h3>Description</h3>

<p>This function export the linear iterpolation implemented in Stan. It
can be use to re-sample the exposure profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_interpolate(x, xpt, ypt, chain = 1, iter = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_interpolate_+3A_x">x</code></td>
<td>
<p>interpolation point x</p>
</td></tr>
<tr><td><code id="export_interpolate_+3A_xpt">xpt</code></td>
<td>
<p>a vector of x axis (has to be same size as <code>ypt</code> vector)</p>
</td></tr>
<tr><td><code id="export_interpolate_+3A_ypt">ypt</code></td>
<td>
<p>a vector of y axis (has to be same size as <code>ypt</code> vector)</p>
</td></tr>
<tr><td><code id="export_interpolate_+3A_chain">chain</code></td>
<td>
<p>number of chain</p>
</td></tr>
<tr><td><code id="export_interpolate_+3A_iter">iter</code></td>
<td>
<p>number of iteration</p>
</td></tr>
<tr><td><code id="export_interpolate_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sample of a stanfit object returning a linear interpolation
</p>

<hr>
<h2 id='fitPBK'>Bayesian inference of TK model with Stan</h2><span id='topic+fitPBK'></span><span id='topic+fitPBK.stanPBKdata'></span>

<h3>Description</h3>

<p>Bayesian inference of TK model with Stan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitPBK(stanPBKdata, ...)

## S3 method for class 'stanPBKdata'
fitPBK(stanPBKdata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitPBK_+3A_stanpbkdata">stanPBKdata</code></td>
<td>
<p>List of Data require for computing</p>
</td></tr>
<tr><td><code id="fitPBK_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fitPBK</code> containing two object: <code>stanPBKdata</code>
the data set used for inference and <code>stanfit</code>  returned by <code>rstan::sampling</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load data file
data("dataCompartment4")
# (2) prepare data set
dataPBK_C4 &lt;- dataPBK(
  object = dataCompartment4,
  col_time = "temps",
  col_replicate = "replicat",
  col_exposure = "condition",
  col_compartment = c("intestin", "reste", "caecum", "cephalon"),
  time_accumulation = 7)
# (3) run Bayesian fitting: &lt;5 sec to be executed
# 1 chain and 10 iterations is fast to run but provide
# bad goodness-of-fit
fitPBK_C4_FASTbadGOF &lt;- fitPBK(dataPBK_C4, chains = 1, iter = 10)

  # (3) run Bayesian fitting: &gt; 5 sec to be executed
  # 4 chains and 2000 iterations provides better estimates
  fitPBK_C4 &lt;- fitPBK(dataPBK_C4, chains = 4, iter = 2000)


</code></pre>

<hr>
<h2 id='fitPBK_C4'>An example of fitPBK object</h2><span id='topic+fitPBK_C4'></span>

<h3>Description</h3>

<p>A fitPBK object containing Bayesian inference of the
<code>dataCompartment4</code> data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fitPBK_C4)
</code></pre>


<h3>Format</h3>

<p>A <code>fitPBK</code> object with:
</p>

<dl>
<dt>stanPBKdata</dt><dd><p>original data frame wrap in a formatted list for inference</p>
</dd>
<dt>stanfit</dt><dd><p>a <code>stanfit</code> object resulting from inference with stan</p>
</dd>
</dl>


<hr>
<h2 id='plot.fitPBK'>Plotting method for <code>fitPBK</code> objects</h2><span id='topic+plot.fitPBK'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>fitTK</code>.  It plots the fit obtained for each
variable in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitPBK'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fitPBK_+3A_x">x</code></td>
<td>
<p>And object returned by <code>fitPBK</code></p>
</td></tr>
<tr><td><code id="plot.fitPBK_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load a fitPBK object
data("fitPBK_C4")
# (2) plot result of bayesian fitting
plot(fitPBK_C4)

</code></pre>

<hr>
<h2 id='ppc'>Posterior predictive check plot</h2><span id='topic+ppc'></span><span id='topic+ppc.fitPBK'></span>

<h3>Description</h3>

<p>Plots posterior predictive check for <code>fitPBK</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc(x, ...)

## S3 method for class 'fitPBK'
ppc(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppc_+3A_x">x</code></td>
<td>
<p>an object used to select a method <code>ppc</code></p>
</td></tr>
<tr><td><code id="ppc_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># (1) load a fitPBK object
data("fitPBK_C4")
# (2) plot ppc of bayesian fitting
ppc(fitPBK_C4)


</code></pre>

<hr>
<h2 id='rPBK-package'>The 'rPBK' package.</h2><span id='topic+rPBK-package'></span><span id='topic+rPBK'></span>

<h3>Description</h3>

<p>Fit and simulate any kind ofphysiologically-based kinetic ('PBK') models whatever
the number of compartments
</p>


<h3>References</h3>

<p>Stan Development Team (2022). RStan: the R interface to Stan. R package version 2.21.5. https://mc-stan.org
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
