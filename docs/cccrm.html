<!DOCTYPE html><html><head><title>Help for package cccrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cccrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bdaw'><p>Blood draw data</p></a></li>
<li><a href='#bfat'><p>Body fat data</p></a></li>
<li><a href='#bpres'><p>Blood pressure data</p></a></li>
<li><a href='#ccclon'><p>Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components</p></a></li>
<li><a href='#ccclonw'><p>Weighted Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components</p></a></li>
<li><a href='#cccUst'><p>Repeated Measures Concordance Correlation Coefficient estimated by U-statistics</p></a></li>
<li><a href='#cccvc'><p>Concordance Correlation Coefficient estimated by Variance Components</p></a></li>
<li><a href='#icc'><p>Intraclass correlation coefficient</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Concordance Correlation Coefficient for Repeated (and
Non-Repeated) Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-1-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Josep Lluis Carrasco &lt;jlcarrasco@ub.edu&gt;, Josep Puig Martinez
        &lt;j.puig04@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josep Lluis Carrasco &lt;jlcarrasco@ub.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, dplyr, Deriv, tidyselect</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the Concordance Correlation Coefficient to assess agreement. The scenarios considered are non-repeated measures, non-longitudinal repeated measures (replicates) and longitudinal repeated measures. It also includes the estimation of the one-way intraclass correlation coefficient also known as reliability index. The estimation approaches implemented are variance components and U-statistics approaches. Description of methods can be found in Fleiss (1986) &lt;<a href="https://doi.org/10.1002%2F9781118032923">doi:10.1002/9781118032923</a>&gt; and Carrasco et al. (2013) &lt;<a href="https://doi.org/10.1016%2Fj.cmpb.2012.09.002">doi:10.1016/j.cmpb.2012.09.002</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-12 13:46:23 UTC; hexac</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-12 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bdaw'>Blood draw data
</h2><span id='topic+bdaw'></span>

<h3>Description</h3>

<p>Plasma cortisol area under curve (AUC) was calculated from the trapezoidal rule over the 12-h period of the hourly blood draws. The subjects were required to repeat the process in five visits. The aim of the agreement study was to assess how well the plasma cortisol AUC from hourly measurements agreed with plasma cortisol AUC that was measured every two hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bdaw")</code></pre>


<h3>References</h3>

<p>King, TS; Chinchilli, VM: Carrasco, JL. (2007). A repeated measures concordance correlation coefficient, Statistics in Medicine 26, 3095-3113.
</p>

<hr>
<h2 id='bfat'>Body fat data
</h2><span id='topic+bfat'></span>

<h3>Description</h3>

<p>Percentage body fat was estimated from skinfold calipers and DEXA on a cohort of 90 adolescent girls. Skinfold caliper and DEXA measurements were taken at ages 12.5, 13 and 13.5. The objective was to determine the amount of agreement between the skinfold caliper and DEXA measurements of percentage body fat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bfat")</code></pre>


<h3>References</h3>

<p>King, TS; Chinchilli, VM: Carrasco, JL. (2007). A repeated measures concordance correlation coefficient, Statistics in Medicine 26, 3095-3113.
</p>

<hr>
<h2 id='bpres'>Blood pressure data
</h2><span id='topic+bpres'></span>

<h3>Description</h3>

<p>Systolic and diastolic blood pressure was measured in a sample of 384 subjects using a handle mercury sphyg momanometer device and an automatic device. The blood pressure was simultaneously measured twice by each instrument, thus every subject had four measurements, two by each method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bpres")</code></pre>


<h3>References</h3>

<p>Carrasco, JL; Jover, L. (2003). Estimating the generalized concordance correlation coefficient through variance components. Biometrics, 59, 849:858.
</p>

<hr>
<h2 id='ccclon'>Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components</h2><span id='topic+ccclon'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for repeated measurements using the variance components from a linear mixed model. The appropriate intraclass correlation coefficient is used as estimator of the concordance correlation coefficient.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccclon(dataset, ry, rind, rtime, rmet, covar = NULL, rho = 0, cl = 0.95,
control.lme=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ccclon_+3A_dataset">dataset</code></td>
<td>

<p>An object of class <code>data.frame</code>.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_ry">ry</code></td>
<td>

<p>Character string. Name of the outcome in the data set.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rind">rind</code></td>
<td>

<p>Character string. Name of the subject variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rtime">rtime</code></td>
<td>

<p>Character string. Name of the time variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rmet">rmet</code></td>
<td>

<p>Character string. Name of the method variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_covar">covar</code></td>
<td>

<p>Character vector. Name of covariables to include in the linear mixed model as fixed effects.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rho">rho</code></td>
<td>

<p>Within subject correlation structure. A value of 0 (default option) stands for compound simmetry and 1 is used for autoregressive of order 1 structure.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_cl">cl</code></td>
<td>

<p>Confidence level.
</p>
</td></tr>
<tr><td><code id="ccclon_+3A_control.lme">control.lme</code></td>
<td>

<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordance correlation coefficient is estimated using the appropriate intraclass correlation coefficient (see Carrasco et al, 2009; Carrasco et al, 2013). The variance components estimates are obtained from a linear mixed model (LMM) estimated by restricted maximum likelihood. The function <em>lme</em> from package <em>nlme</em> (Pinheiro et al., 2021) is used to estimate the LMM. The standard error of CCC is computed using an Taylor's series expansion of 1st order (Ver Hoef, 2012). Confidence interval is built by applying the Fisher's Z-transformation.
</p>


<h3>Value</h3>

<p>An object of class <code>ccc</code>. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>
<table>
<tr><td><code>ccc</code></td>
<td>
<p>Concordance Correlation Coefficient estimate</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>nlme object with the fitted linear mixed model</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>Variance components estimates</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Variance components asymptotic covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josep Puig-Martinez and Josep L. Carrasco
</p>


<h3>References</h3>

<p>Carrasco, JL; King, TS; Chinchilli, VM. (2009). The concordance correlation coefficient for repeated measures estimated by variance components. Journal of Biopharmaceutical Statistics, 19, 90:105.
</p>
<p>Carrasco, JL; Phillips, BR; Puig-Martinez, J; King, TS;  Chinchilli, VM. (2013). Estimation of the concordance correlation coefficient for repeated measures using SAS and R. Computer Methods and Programs in Biomedicine, 109, 293-304.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-152, https://CRAN.R-project.org/package=nlme.
</p>
<p>Ver Hoef, J.M. (2012) Who Invented the Delta Method?, The American Statistician, 66:2, 124-127.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccclonw">ccclonw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bdaw)
estccc&lt;-ccclon(bdaw,"AUC","SUBJ","VNUM","MET")
estccc
summary(estccc)

</code></pre>

<hr>
<h2 id='ccclonw'>Weighted Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components
</h2><span id='topic+ccclonw'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient (CCC) for repeated measurements using the variance components from a linear mixed model. The appropriate intraclass correlation coefficient is used as estimator of the concordance correlation coefficient. Weights are assigned to repeated measurements in the CCC computation process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccclonw(dataset, ry, rind, rtime, rmet, vecD, covar = NULL, rho = 0, cl = 0.95, 
control.lme=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ccclonw_+3A_dataset">dataset</code></td>
<td>

<p>an object of class <code>data.frame</code>.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_ry">ry</code></td>
<td>

<p>Character string. Name of the outcome in the data set.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rind">rind</code></td>
<td>

<p>Character string. Name of the subject variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rtime">rtime</code></td>
<td>

<p>Character string. Name of the time variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rmet">rmet</code></td>
<td>

<p>Character string. Name of the method variable in the data set.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_vecd">vecD</code></td>
<td>

<p>Vector of weigths. The length of the vector must be the same as the number of repeated measures.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_covar">covar</code></td>
<td>

<p>Character vector. Name of covariables to include in the linear mixed model as fixed effects.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rho">rho</code></td>
<td>

<p>Within subject correlation structure. A value of 0 (default option) stands for compound simmetry and 1 is used for autoregressive of order 1 structure.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_cl">cl</code></td>
<td>

<p>Confidence level.
</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_control.lme">control.lme</code></td>
<td>

<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordance correlation coefficient is estimated using the appropriate intraclass correlation coefficient  which expression is modified accordingly to assign different weights to each repeated measurement (see Carrasco et al, 2009; Carrasco et al, 2013). The variance components estimates are obtained from a linear mixed model (LMM) estimated by restricted maximum likelihood. The function <em>lme</em> from package <em>nlme</em> (Pinheiro et al., 2021) is used to estimate the LMM. The standard error of CCC is computed using an Taylor's series expansion of 1st order (Ver Hoef, 2012). Confidence interval is built by applying the Fisher's Z-transformation.
</p>


<h3>Value</h3>

<p>An object of class <code>ccc</code>. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>
<table>
<tr><td><code>ccc</code></td>
<td>
<p>Concordance Correlation Coefficient estimate</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>nlme object with the fitted linear mixed model</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>Variance components estimates</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Variance components asymptotic covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josep Puig-Martinez and Josep L. Carrasco
</p>


<h3>References</h3>

<p>Carrasco, JL; King, TS; Chinchilli, VM. (2009). The concordance correlation coefficient for repeated measures estimated by variance components. Journal of Biopharmaceutical Statistics, 19, 90:105.
</p>
<p>Carrasco, JL; Phillips, BR; Puig-Martinez, J; King, TS;  Chinchilli, VM. (2013). Estimation of the concordance correlation coefficient for repeated measures using SAS and R. Computer Methods and Programs in Biomedicine, 109, 293-304.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-152, https://CRAN.R-project.org/package=nlme.
</p>
<p>Ver Hoef, J.M. (2012) Who Invented the Delta Method?, The American Statistician, 66:2, 124-127.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccclon">ccclon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bfat)
estccc&lt;-ccclonw(bfat,"BF","SUBJECT","VISITNO","MET",vecD=c(2,1,1))
estccc
summary(estccc)
</code></pre>

<hr>
<h2 id='cccUst'>Repeated Measures Concordance Correlation Coefficient estimated by U-statistics
</h2><span id='topic+cccUst'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for repeated measurements using the U-statistics approach. The function is also applicable for the non-repeated measurements scenario.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cccUst(dataset, ry, rmet, rtime = NULL, Dmat = NULL, delta = 1, cl = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cccUst_+3A_dataset">dataset</code></td>
<td>

<p>An object of class <code>data.frame</code>.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_ry">ry</code></td>
<td>

<p>Character string. Name of the outcome in the data set.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_rmet">rmet</code></td>
<td>

<p>Character string. Name of the method variable in the data set.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_rtime">rtime</code></td>
<td>

<p>Character string. Name of the time variable in the data set.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_dmat">Dmat</code></td>
<td>

<p>Matrix of weights.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_delta">delta</code></td>
<td>

<p>Power of the differences. A value of 0 provides an estimate that is comparable to a repeated measures version of kappa index.
</p>
</td></tr>
<tr><td><code id="cccUst_+3A_cl">cl</code></td>
<td>

<p>Confidence level.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector that includes the point estimate, confidence interval and standard error of the CCC. Additionally the Fisher's Z-transformation value and its standard error are also provided.
</p>


<h3>Author(s)</h3>

<p>Josep Puig-Martinez and Josep L. Carrasco
</p>


<h3>References</h3>

<p>King, TS and Chinchilli, VM. (2001). A generalized concordance correlation coefficient for continuous and categorical data. Statistics in Medicine, 20, 2131:2147.
</p>
<p>King, TS; Chinchilli, VM; Carrasco, JL. (2007). A repeated measures concordance correlation coefficient. Statistics in Medicine, 26, 3095:3113.
</p>
<p>Carrasco, JL; Phillips, BR; Puig-Martinez, J; King, TS;  Chinchilli, VM. (2013). Estimation of the concordance correlation coefficient for repeated measures using SAS and R. Computer Methods and Programs in Biomedicine, 109, 293-304.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Non-longitudinal scenario
data(bpres)
newdat=bpres[bpres$NM==1,]
estccc=cccUst(newdat,"DIA","METODE")
estccc

# Longitudinal scenario
data(bdaw)
estccc=cccUst(bdaw,"AUC","MET","VNUM")
estccc

# Weighted CCC
data(bfat)
estccc=cccUst(bfat,"BF","MET","VISITNO",Dmat=diag(c(2,1,1)))
estccc
</code></pre>

<hr>
<h2 id='cccvc'>Concordance Correlation Coefficient estimated by Variance Components
</h2><span id='topic+cccvc'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for non-repeated measurements and non-longitudinal repeated measurements (replicates) using the variance components from a linear mixed model. The appropriate intraclass correlation coefficient is used as estimator of the concordance correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cccvc(dataset, ry, rind, rmet, covar = NULL, int = FALSE, cl=0.95, control.lme=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cccvc_+3A_dataset">dataset</code></td>
<td>

<p>an object of class <code>data.frame</code>.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_ry">ry</code></td>
<td>

<p>Character string. Name of the outcome in the data set.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_rind">rind</code></td>
<td>

<p>Character string. Name of the subject variable in the data set.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_rmet">rmet</code></td>
<td>

<p>Character string. Name of the method variable in the data set.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_covar">covar</code></td>
<td>

<p>Character vector. Name of covariables to include in the linear mixed model as fixed effects.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_int">int</code></td>
<td>

<p>Boolean indicating if the subject-method interaction has to be included in the model
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_cl">cl</code></td>
<td>

<p>Confidence level.
</p>
</td></tr>
<tr><td><code id="cccvc_+3A_control.lme">control.lme</code></td>
<td>

<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordance correlation coefficient is estimated using the appropriate intraclass correlation coefficient (see Carrasco and Jover, 2003; Carrasco et al., 2009; Carrasco et al, 2013). The scenarios considered are non-repeated measurements (only one measurement by subject and method) and non-longitudinal repeated measurements, i.e. replicates (multiple measurements by subject and method). The variance components estimates are obtained from a linear mixed model (LMM) estimated by restricted maximum likelihood. The function <em>lme</em> from package <em>nlme</em> (Pinheiro et al., 2021) is used to estimate the LMM. The standard error of CCC is computed using an Taylor's series expansion of 1st order (Ver Hoef, 2012). Confidence interval is built by applying the Fisher's Z-transformation.
</p>


<h3>Value</h3>

<p>An object of class <code>ccc</code>. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>
<table>
<tr><td><code>ccc</code></td>
<td>
<p>Concordance Correlation Coefficient estimate</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>nlme object with the fitted linear mixed model</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>Variance components estimates</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Variance components asymptotic covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josep Puig-Martinez and Josep L. Carrasco
</p>


<h3>References</h3>

<p>Carrasco, JL; Jover, L. (2003). Estimating the generalized concordance correlation coefficient through variance components. Biometrics, 59, 849:858.
</p>
<p>Carrasco, JL; King, TS; Chinchilli, VM. (2009). The concordance correlation coefficient for repeated measures estimated by variance components. Journal of Biopharmaceutical Statistics, 19, 90:105.
</p>
<p>Carrasco, JL; Phillips, BR; Puig-Martinez, J; King, TS;  Chinchilli, VM. (2013). Estimation of the concordance correlation coefficient for repeated measures using SAS and R. Computer Methods and Programs in Biomedicine, 109, 293-304.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-152, https://CRAN.R-project.org/package=nlme.
</p>
<p>Ver Hoef, J.M. (2012) Who Invented the Delta Method?, The American Statistician, 66:2, 124-127.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bpres)

# Scenario 1. 
#Only 1 measure by subject and method. 
#No subject-method interaction included in the model.

newdat=bpres[bpres$NM==1,]
estccc=cccvc(newdat,"DIA","ID","METODE")
estccc
summary(estccc)

# Scenario 2. 
#Two measures by subject and method. 
#No subject-method interaction included in the model.

estccc=cccvc(bpres,"DIA","ID","METODE")
estccc
summary(estccc)

</code></pre>

<hr>
<h2 id='icc'>Intraclass correlation coefficient
</h2><span id='topic+icc'></span>

<h3>Description</h3>

<p>Estimates the one-way intraclass correlation coefficient using the variance components from a linear mixed model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icc(dataset, ry, rind, covar = NULL, cl=0.95, control.lme=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icc_+3A_dataset">dataset</code></td>
<td>

<p>an object of class <code>data.frame</code>.
</p>
</td></tr>
<tr><td><code id="icc_+3A_ry">ry</code></td>
<td>

<p>Character string. Name of the outcome in the data set.
</p>
</td></tr>
<tr><td><code id="icc_+3A_rind">rind</code></td>
<td>

<p>Character string. Name of the subject variable in the data set.
</p>
</td></tr>
<tr><td><code id="icc_+3A_covar">covar</code></td>
<td>

<p>Character vector. Name of covariables to include in the linear mixed model as fixed effects.
</p>
</td></tr>
<tr><td><code id="icc_+3A_cl">cl</code></td>
<td>

<p>Confidence level.
</p>
</td></tr>
<tr><td><code id="icc_+3A_control.lme">control.lme</code></td>
<td>

<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intraclass correlation coefficient (ICC) (Fleiss, 1986) is estimated using a linear mixed model with subjects (cluster) random effect and random error as components. The effects are assumed to follow Normal distributions with variances Sa and Se respectively. The expression of the ICC is <code class="reqn">Sa/(Sa + Se)</code>. This intraclass correlation coefficient is also known as reliability index. The variance components estimates are obtained from a linear mixed model (LMM) estimated by restricted maximum likelihood. The function <em>lme</em> from package <em>nlme</em> (Pinheiro et al., 2021) is used to estimate the LMM. The standard error of CCC is computed using an Taylor's series expansion of 1st order (Ver Hoef, 2012). Confidence interval is built by applying the Fisher's Z-transformation.
</p>


<h3>Value</h3>

<p>An object of class <code>icc</code>. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>
<table>
<tr><td><code>icc</code></td>
<td>
<p>Intraclass Correlation Coefficient estimate</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>nlme object with the fitted linear mixed model</p>
</td></tr>
<tr><td><code>vc</code></td>
<td>
<p>Variance components estimates</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Variance components asymptotic covariance matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josep L. Carrasco
</p>


<h3>References</h3>

<p>Fleiss, JL. (1986). Reliability of Measurement in *Design and analysis of clinical experiments*. New York:Wiley.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-152, https://CRAN.R-project.org/package=nlme.
</p>
<p>Ver Hoef, J.M. (2012) Who Invented the Delta Method?, The American Statistician, 66:2, 124-127.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bpres)
 
# Reliability of method 1 

newdat=bpres[(bpres$METODE==1),]
est=icc(newdat,"DIA","ID")
est
summary(est)

# Reliability of method 2 

newdat=bpres[(bpres$METODE==2),]
est=icc(newdat,"DIA","ID")
est
summary(est)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
