<!DOCTYPE html><html lang="en"><head><title>Help for package cccrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cccrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cccrm-package'><p>cccrm: Concordance Correlation Coefficient for Repeated (and Non-Repeated) Measures</p></a></li>
<li><a href='#bdaw'><p>Blood draw data</p></a></li>
<li><a href='#bfat'><p>Body fat data</p></a></li>
<li><a href='#bpres'><p>Blood pressure data</p></a></li>
<li><a href='#ccc_est'><p>Concordance correlation Coefficient estimation from a linear mixed model</p></a></li>
<li><a href='#ccc_est_by_time'><p>Concordance Correlation Coefficient estimation by variance components.</p></a></li>
<li><a href='#ccc_sim_data'><p>Data simulation using fixed and random effects</p></a></li>
<li><a href='#ccc_vc'><p>Concordance Correlation Coefficient estimation by variance components.</p></a></li>
<li><a href='#ccclon'><p>Concordance Correlation Coefficient estimated by Variance Components</p></a></li>
<li><a href='#ccclonw'><p>Concordance Correlation Coefficient estimated by Variance Components</p></a></li>
<li><a href='#cccUst'><p>Repeated Measures Concordance Correlation Coefficient estimated by U-statistics</p></a></li>
<li><a href='#cccvc'><p>Concordance Correlation Coefficient estimated by Variance Components</p></a></li>
<li><a href='#lme_model'><p>Fits a Linear Mixed Effects Model</p></a></li>
<li><a href='#np_boot_ccc_by_time'><p>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient by time variable</p></a></li>
<li><a href='#np_boot_ci'><p>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient</p></a></li>
<li><a href='#para_boot_ci'><p>Parametric bootstrap to make inference on the concordance correlation coefficient</p></a></li>
<li><a href='#sim_power_ccc'><p>Power and confidence interval range</p></a></li>
<li><a href='#Ztest'><p>Wald's test on the Concordance Correlation Coefficient</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Concordance Correlation Coefficient for Repeated (and
Non-Repeated) Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-25</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, dplyr, Deriv, tidyselect, progressr, furrr, nlmeU,
parallelly, purrr, tidyr, lifecycle, future, MASS, ggplot2</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates the Concordance Correlation Coefficient to assess agreement. The scenarios considered are non-repeated measures, non-longitudinal repeated measures (replicates) and longitudinal repeated measures. It also includes the estimation of the one-way intraclass correlation coefficient also known as reliability index. The estimation approaches implemented are variance components and U-statistics approaches. Description of methods can be found in Fleiss (1986) &lt;<a href="https://doi.org/10.1002%2F9781118032923">doi:10.1002/9781118032923</a>&gt; and Carrasco et al. (2013) &lt;<a href="https://doi.org/10.1016%2Fj.cmpb.2012.09.002">doi:10.1016/j.cmpb.2012.09.002</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-07 14:48:40 UTC; hexac</td>
</tr>
<tr>
<td>Author:</td>
<td>Josep Lluis Carrasco [aut, cre],
  Gonzalo Peon Pena [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josep Lluis Carrasco &lt;jlcarrasco@ub.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-07 15:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='cccrm-package'>cccrm: Concordance Correlation Coefficient for Repeated (and Non-Repeated) Measures</h2><span id='topic+cccrm'></span><span id='topic+cccrm-package'></span>

<h3>Description</h3>

<p>Estimates the Concordance Correlation Coefficient to assess agreement. The scenarios considered are non-repeated measures, non-longitudinal repeated measures (replicates) and longitudinal repeated measures. It also includes the estimation of the one-way intraclass correlation coefficient also known as reliability index. The estimation approaches implemented are variance components and U-statistics approaches. Description of methods can be found in Fleiss (1986) <a href="https://doi.org/10.1002/9781118032923">doi:10.1002/9781118032923</a> and Carrasco et al. (2013) <a href="https://doi.org/10.1016/j.cmpb.2012.09.002">doi:10.1016/j.cmpb.2012.09.002</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Josep Lluis Carrasco <a href="mailto:jlcarrasco@ub.edu">jlcarrasco@ub.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Gonzalo Peon Pena
</p>
</li></ul>


<hr>
<h2 id='bdaw'>Blood draw data</h2><span id='topic+bdaw'></span>

<h3>Description</h3>

<p>Plasma cortisol area under curve (AUC) was calculated from the trapezoidal rule over the 12-h period of the hourly blood draws. The subjects were required to repeat the process in five visits. The aim of the agreement study was to assess how well the plasma cortisol AUC from hourly measurements agreed with plasma cortisol AUC that was measured every two hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdaw
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt>SUBJ</dt><dd><p>Subject identifier</p>
</dd>
<dt>VNUM</dt><dd><p>Visit number</p>
</dd>
<dt>AUC</dt><dd><p>Area under the curve</p>
</dd>
<dt>MET</dt><dd><p>Device identifier</p>
</dd>
</dl>


<hr>
<h2 id='bfat'>Body fat data</h2><span id='topic+bfat'></span>

<h3>Description</h3>

<p>Percentage body fat was estimated from skinfold calipers and DEXA on a cohort of 90 adolescent girls. Skinfold caliper and DEXA measurements were taken at ages 12.5, 13 and 13.5. The objective was to determine the amount of agreement between the skinfold caliper and DEXA measurements of percentage body fat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bfat
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt>SUBJECT</dt><dd><p>Subject identifier</p>
</dd>
<dt>VISITNO</dt><dd><p>Visit number</p>
</dd>
<dt>BF</dt><dd><p>Percentage body fat</p>
</dd>
<dt>MET</dt><dd><p>Device identifier</p>
</dd>
</dl>


<hr>
<h2 id='bpres'>Blood pressure data</h2><span id='topic+bpres'></span>

<h3>Description</h3>

<p>Systolic and diastolic blood pressure was measured in a sample of 384 subjects using a handle mercury sphygmomanometer device and an automatic device. The blood pressure was simultaneously measured twice by each instrument, thus every subject had four measurements, two by each method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpres
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt>ID</dt><dd><p>Subject identifier</p>
</dd>
<dt>SIS</dt><dd><p>Systolic blood pressure in mmHg</p>
</dd>
<dt>DIA</dt><dd><p>Diastolic blood pressure in mmHg</p>
</dd>
<dt>METODE</dt><dd><p>Device identifier</p>
</dd>
<dt>NM</dt><dd><p>Identifier of replicates</p>
</dd>
<dt>ALTURA</dt><dd><p>Height in cm</p>
</dd>
<dt>EDAD</dt><dd><p>Age in years</p>
</dd>
<dt>FRECUENC</dt><dd><p>Heart rate</p>
</dd>
<dt>INFOR_AR</dt><dd><p>Have the subject been informed about he is hypertense?</p>
</dd>
<dt>PESO</dt><dd><p>Weight in Kg</p>
</dd>
<dt>SEXO</dt><dd><p>Gender. 1 for Male. 2 for Female</p>
</dd>
<dt>TA</dt><dd><p>Was the subject's blood pressure measured the last year? 1=Yes, 2=No, 9=Unknown</p>
</dd>
<dt>TNSI_MED</dt><dd><p>Does the subject receive treatment for hypertension? 1=Yes, 2=No, 3=Doubtful, 8=not applicable, 9=Insufficient data.</p>
</dd>
</dl>


<hr>
<h2 id='ccc_est'>Concordance correlation Coefficient estimation from a linear mixed model</h2><span id='topic+ccc_est'></span>

<h3>Description</h3>

<p>It computes the Concordance Correlation Coefficient and its asymptotic confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccc_est(model, D = NULL, cl = 0.95, transf = "F2", sd_est = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccc_est_+3A_model">model</code></td>
<td>
<p>The lme model.</p>
</td></tr>
<tr><td><code id="ccc_est_+3A_d">D</code></td>
<td>
<p>Weights vector.</p>
</td></tr>
<tr><td><code id="ccc_est_+3A_cl">cl</code></td>
<td>
<p>Confidence level (0.95 as a default). Bounded between 0 and 1.</p>
</td></tr>
<tr><td><code id="ccc_est_+3A_transf">transf</code></td>
<td>
<p>Character string. Whether to apply a transformation of the coefficient for inference. Valid options are: &quot;F&quot; for Fisher's Z-transformation; &quot;F2&quot; For Fisher's Z-transformation setting m=2 (default); &quot;KG&quot; Konishi-Gupta transformation; &quot;None&quot;, no transformation is applied. See *Details* for further information.</p>
</td></tr>
<tr><td><code id="ccc_est_+3A_sd_est">sd_est</code></td>
<td>
<p>Logical. Whether to estimate the asymptotic standard deviation (defaults to TRUE) or to only report the <code>ccc</code> value.</p>
</td></tr>
<tr><td><code id="ccc_est_+3A_...">...</code></td>
<td>
<p>To pass further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ccc</code> class object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccc_vc">ccc_vc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1984)
df &lt;- ccc_sim_data(n=50,b = c(0,1), mu = -0.25, sa = 1.5, se = 1, nrep=2)
mod &lt;- lme_model(df,"y","id",rmet="met")
ccc_est(mod)
</code></pre>

<hr>
<h2 id='ccc_est_by_time'>Concordance Correlation Coefficient estimation by variance components.</h2><span id='topic+ccc_est_by_time'></span>

<h3>Description</h3>

<p>Estimation of the non-longitudinal concordance correlation coefficient at each time using the variance components approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccc_est_by_time(
  dataset,
  ry,
  rind,
  rmet,
  rtime,
  covar = NULL,
  int = F,
  cl = 0.95,
  control.lme = list(),
  future_seed = TRUE,
  transf = "F2",
  workers = 15,
  plotit = TRUE,
  test = FALSE,
  nboot = 500,
  adj.method = "holm",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccc_est_by_time_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in  <code><a href="furrr.html#topic+furrr_options">furrr_options</a></code>.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_transf">transf</code></td>
<td>
<p>Character string. Whether to apply a transformation of the coefficient for inference. Valid options are: &quot;F&quot; for Fisher's Z-transformation; &quot;F2&quot; For Fisher's Z-transformation setting m=2 (default); &quot;KG&quot; Konishi-Gupta transformation; &quot;None&quot;, no transformation is applied. See *Details* for further information.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_workers">workers</code></td>
<td>
<p>Integer. Number of cores to be used for parallellization. Default is 15. Capped to number of available cores minus 1.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_plotit">plotit</code></td>
<td>
<p>Logical. If TRUE it generates a plot with the CCC and their confidence intervals for each time.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_test">test</code></td>
<td>
<p>Logical. If TRUE the equality of CCCs is assessed. Default to FALSE.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_adj.method">adj.method</code></td>
<td>
<p>Character string. Correction method for pairwise comparisons. See <code><a href="stats.html#topic+p.adjust">p.adjust</a></code></p>
</td></tr>
<tr><td><code id="ccc_est_by_time_+3A_...">...</code></td>
<td>
<p>To pass further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordance correlation coefficient is estimated using the variance components approach. Confidence intervals are built using the asymptotic Normal distribution approach.
Variance-covariance matrix of CCC estimates is estimated by non-parametric balanced randomized cluster bootstrap approach (Davison and Hinkley, 1997; Field and Welsh, 2007).
Overall equality of CCCs is tested following the non-parametric bootstrap approach suggested in  Vanbelle (2017).
</p>


<h3>Value</h3>

<p>A <code>ccc</code> class object. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>

<ul>
<li> <p><code>ccc</code>. CCC estimates at each level of time variable.
</p>
</li>
<li> <p><code>plot</code>. Plot of the CCC along with their confidence intervals.
</p>
</li>
<li> <p><code>res_test</code>. Test of equality of CCCs.
</p>
</li>
<li> <p><code>ph_table</code>. Pairwise comparison of CCCs.
</p>
</li></ul>



<h3>References</h3>


<p>Davison A.C., Hinkley D.V. (1997). Bootstrap Methods and Their Application. Cambridge: Cambridge University Press.
</p>
<p>Field, C.A., Welsh, A.H. (2007). Bootstrapping Clustered Data. Journal of the Royal Statistical Society. Series B (Statistical Methodology) 69(3):369-390.
</p>
<p>Vanbelle S. (2017). Comparing dependent kappa coefficients obtained on multilevel data. Biometrical Journal 59(5):1016-1034. 
</p>



<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
ccc_est_by_time(bdaw, "AUC", "SUBJ", "MET", "VNUM")
ccc_est_by_time(bpres, "SIS", "ID", "METODE", "NM",test=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='ccc_sim_data'>Data simulation using fixed and random effects</h2><span id='topic+ccc_sim_data'></span>

<h3>Description</h3>

<p>The fixed effects and standard deviations of random effects can be set to specific values or, alternatively, obtained from an object of class <code>lme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccc_sim_data(
  n = 30,
  nrep = 1,
  nsim = 1,
  model = NULL,
  b = NULL,
  g = NULL,
  mu = 0,
  sa = 1,
  sab = 0,
  sag = 0,
  bg = NULL,
  se = 1,
  future_seed = TRUE,
  workers = 15,
  extra.info = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccc_sim_data_+3A_n">n</code></td>
<td>
<p>Integer. Number of subjects</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_nrep">nrep</code></td>
<td>
<p>Integer. Number of replicates</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_nsim">nsim</code></td>
<td>
<p>Integer. Number of data sets simulated.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_model">model</code></td>
<td>
<p>Object of class <code>lme</code>.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_b">b</code></td>
<td>
<p>Vector. Method fixed effects.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_g">g</code></td>
<td>
<p>Vector. Time fixed effects.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_mu">mu</code></td>
<td>
<p>Integer. Overall mean.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_sa">sa</code></td>
<td>
<p>Integer. Standard deviation of subject's random effect.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_sab">sab</code></td>
<td>
<p>Integer. Standard deviation of subject-method interaction's random effect.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_sag">sag</code></td>
<td>
<p>Integer. Standard deviation of subject-time interaction's random effect.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_bg">bg</code></td>
<td>
<p>Vector. Method-time interaction's fixed effects. The vector of effects have to be ordered by method and time.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_se">se</code></td>
<td>
<p>Integer. Standard deviation of random error effect.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in <code><a href="furrr.html#topic+furrr_options">furrr_options</a></code>.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_workers">workers</code></td>
<td>
<p>Integer. Number of cores to be used for parallellization. Default is 15. Capped to number of available cores minus 1.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_extra.info">extra.info</code></td>
<td>
<p>Logical. Should the information about CCC/ICC and variance components simulated be shown?  Default is set to TRUE.</p>
</td></tr>
<tr><td><code id="ccc_sim_data_+3A_...">...</code></td>
<td>
<p>To pass further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Random effects are simulated as normal distributions with mean 0 and the correspondign standard deviations. The simulated data is obtained
as the addition of the simulated values and the fixed efffects. Parallel computation is used except if data is simulated from an object of class 'lme'. In this case.
data is simulated using the <code><a href="nlmeU.html#topic+simulateY">simulateY</a></code> function from <code>nlmeU</code> package.
</p>


<h3>Value</h3>

<p>A data frame with the simulated data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ccc_vc">ccc_vc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# # Reliability data: 
# 50 subjects, one method, one time, 2 replicates
# Overall mean: -0.25; Subjects standard deviation: 1.5, Random error standard deviation: 1
set.seed(101)
df &lt;- ccc_sim_data(n=50, b = NULL, g = NULL, mu = -0.25, sa = 1.5, se = 1, nrep=2)

# Method comparison data (non-longitudinal)
# 50 subjects, two methods, 2 replicates
# Overall mean: -0.25; Subjects standard deviation: 1.5, Random error standard deviation: 1
# Difference of means between methods 2 and 1: 1
# Three data sets simulated

set.seed(202)
df &lt;- ccc_sim_data(n=50, nsim=3,b = c(0,1), mu = -0.25, sa = 1.5, se = 1, nrep=2)

# Method comparison data (longitudinal)
# 50 subjects, two methods, 3 times, 1 replicate, 
# Overall mean: -0.25; Subjects standard deviation: 1.5, Random error standard deviation: 1
# Difference of means between methods 2 and 1: 1
# Difference of means between times 3,2 and 1 respectively: 0.5 and 0.25.
# Subject-methods interaction standard deviation: 0.25
# Subject-times interaction standard deviation: 0.5
# Same difference of means at each time

set.seed(202)
df &lt;- ccc_sim_data(n=50, b = c(0,1), g=c(0,0.25,0.5), mu = -0.25, sa = 1.5, 
sab=0.25,sag=0.5,se = 1, nrep=2)

# Simulate data using the estimates of a linear mixed model
set.seed(2024)
df3 &lt;- ccc_sim_data(n=50, b = c(0,1), g=c(0,0.25,0.5), mu = -0.25, sa = 1.5, 
                    sab=0.25,sag=0.5,bg=c(0,0.5,0.75,0,1,1),se = 1, nrep=2)
mod3 &lt;- lme_model(df3,"y","id","times","met",control.lme=nlme::lmeControl(opt = 'optim'))
ccc_sim_data(nsim=10,model=mod3)


</code></pre>

<hr>
<h2 id='ccc_vc'>Concordance Correlation Coefficient estimation by variance components.</h2><span id='topic+ccc_vc'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for either non-repeated, non-longitudinal, or longitudinal repeated measurements using the variance components from a linear mixed model. The appropriate intraclass correlation coefficient is used as estimator of the concordance correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccc_vc(
  dataset,
  ry,
  rind,
  rmet = NULL,
  rtime = NULL,
  vecD = NULL,
  covar = NULL,
  int = F,
  rho = 0,
  cl = 0.95,
  control.lme = list(),
  transf = "F2",
  boot = FALSE,
  boot_param = FALSE,
  boot_ci = "BCa",
  nboot = 300,
  parallel = FALSE,
  future_seed = TRUE,
  workers = 15,
  sd_est = TRUE,
  apVar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccc_vc_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_transf">transf</code></td>
<td>
<p>Character string. Whether to apply a transformation of the coefficient for inference. Valid options are: &quot;F&quot; for Fisher's Z-transformation; &quot;F2&quot; For Fisher's Z-transformation setting m=2 (default); &quot;KG&quot; Konishi-Gupta transformation; &quot;None&quot;, no transformation is applied. See *Details* for further information.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_boot">boot</code></td>
<td>
<p>Logical. Whether to compute the CCC confidence interval by bootstrapping or asymptotic methods (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_boot_param">boot_param</code></td>
<td>
<p>Logical. Whether to compute a parametric bootstrap or a non-parametric bootstrap (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_boot_ci">boot_ci</code></td>
<td>
<p>Character. Type of bootstrap confidence interval. Either &quot;BCa&quot; (which is the default) or &quot;empirical&quot;.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_nboot">nboot</code></td>
<td>
<p>Integer. Number of bootstrap resamples. Default is 300.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_parallel">parallel</code></td>
<td>
<p>Logical. Whether the code is parallellized. The parallellization method is <code>multisession</code>.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in  <code><a href="furrr.html#topic+furrr_options">furrr_options</a></code>.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_workers">workers</code></td>
<td>
<p>Integer. Number of cores to be used for parallellization. Default is 15. Capped to number of available cores minus 1.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_sd_est">sd_est</code></td>
<td>
<p>Logical. Whether to estimate the asymptotic standard deviation (defaults to TRUE) or to only report the <code>ccc/icc</code> value.</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_apvar">apVar</code></td>
<td>
<p>Logical. Should the asymptotic variance-covariance matrix of the variance components be estimated in the linear mixed model? (Defaults to TRUE).</p>
</td></tr>
<tr><td><code id="ccc_vc_+3A_...">...</code></td>
<td>
<p>To pass further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concordance correlation coefficient is estimated using the appropriate intraclass correlation coefficient (see Carrasco and Jover, 2003; Carrasco et al., 2009; Carrasco et al, 2013). 
</p>
<p>The scenarios considered are: a) reliability assessment (several measurements taken with one method); b) methods comparison data with non-repeated measurements (only one measurement by subject and method);
c) Methods comparison data with non-longitudinal repeated measurements, i.e. replicates (multiple measurements by subject and method); and d) Methods comparison data with longitudinal repeated measurements (multiple longitudinal measurements by subject and method).
</p>
<p>The variance components estimates are obtained from a linear mixed model (LMM) estimated by restricted maximum likelihood. The function <em>lme</em> from package <em>nlme</em> (Pinheiro et al., 2021) is used to estimate the LMM. 
</p>
<p>The standard error of CCC and its confidence interval can be obtained: a) asymptotically, using Taylor's series expansion of 1st order (Ver Hoef, 2012); b) using balanced randomized cluster bootstrap approach (Davison and Hinkley, 1997; Field and Welsh, 2007); c) using parametric bootstrap (Davison and Hinkley, 1997).
</p>
<p>When estimating asymptotically the standard error, the confidence intervals are built using the point estimate of the CCC/ICC, its standard error, and the appropriate quantile of the  standard Normal distribution.
However, the approximation to the asymptotic Normal distribution is improved if the CCC/ICC is transformed using the Fisher's Z-transformation (Fisher, 1925), or the Konishi-Gupta transformation (Konishi and Gupta, 1989).
In case the number of replicates is equal to 2, both transformations give the same result.
</p>


<h3>Value</h3>

<p>A <code>ccc</code> class object. Generic function <code>summary</code> show a summary of the results. The output is a list with the following components:
</p>

<ul>
<li> <p><code>ccc</code>. CCC/ICC estimate
</p>
</li>
<li> <p><code>model</code>. nlme object with the fitted linear mixed model.
</p>
</li>
<li> <p><code>vc</code>. Variance components estimates.
</p>
</li>
<li> <p><code>sigma</code>. Variance components asymptotic covariance matrix.
</p>
</li></ul>



<h3>References</h3>


<p>Carrasco, JL; Jover, L. (2003). Estimating the generalized concordance correlation coefficient through variance components. Biometrics, 59, 849:858.
</p>
<p>Carrasco, JL; King, TS; Chinchilli, VM. (2009). The concordance correlation coefficient for repeated measures estimated by variance components. Journal of Biopharmaceutical Statistics, 19, 90:105.
</p>
<p>Davison A.C., Hinkley D.V. (1997). Bootstrap Methods and Their Application. Cambridge: Cambridge University Press.
</p>
<p>Field, C.A., Welsh, A.H. (2007). Bootstrapping Clustered Data. Journal of the Royal Statistical Society. Series B (Statistical Methodology). 69(3), 369-390.
</p>
<p>Fisher, R. A. (1925) Statistical Methods for Research Workers. Edinburgh: Oliver
</p>
<p>Konishi, S. and Gupta, A. K. (1989) Testing the equality of several intraclass correlation coefficients. J Statist. Planng Inf., 21, 93-105.
</p>
<p>Pinheiro J, Bates D, DebRoy S, Sarkar D, R Core Team (2021). nlme: Linear and Nonlinear Mixed Effects Models. R package version 3.1-152, <a href="https://CRAN.R-project.org/package=nlme">https://CRAN.R-project.org/package=nlme</a>.
</p>
<p>Ver Hoef, J.M. (2012) Who Invented the Delta Method?, The American Statistician, 66:2, 124-127.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Scenario 1. Reliability 
newdat &lt;- bpres |&gt; dplyr::filter(METODE==1)
icc_rel&lt;-ccc_vc(newdat,"DIA","ID")
icc_rel
summary(icc_rel)


# Confidence interval using non-parametric bootstrap

icc_rel_bt&lt;-ccc_vc(newdat,"DIA","ID",boot=TRUE,sd_est=FALSE,
nboot=500,parallel=TRUE)
icc_rel_bt
summary(icc_rel_bt)


#' # Scenario 2. Non-longitudinal methods comparison.
# Only 1 measure by subject and method. 
# No subjects-method interaction included in the model.

newdat &lt;- bpres |&gt; dplyr::filter(NM==1)
ccc_mc&lt;-ccc_vc(newdat,"DIA","ID","METODE")
ccc_mc
summary(ccc_mc)


# Confidence interval using parametric bootstrap

ccc_mc_bt&lt;-ccc_vc(newdat,"DIA","ID",boot=TRUE,boot_param=TRUE,
sd_est=FALSE,nboot=500,parallel=TRUE)
ccc_mc_bt
summary(ccc_mc_bt)


# Scenario 3. Non-longitudinal methods comparison. 
# Two measures by subject and method. 
# No subject-method interaction included in the model.

ccc_mc=ccc_vc(bpres,"DIA","ID","METODE")
ccc_mc
summary(ccc_mc)



# Scenario 4. Methods comparison in longitudinal repeated measures setting.
ccc_mc_lon&lt;-ccc_vc(bdaw,"AUC","SUBJ","MET","VNUM")
ccc_mc_lon
summary(ccc_mc_lon)

# Scenario 5. Methods comparison in longitudinal repeated measures setting.
# More weight given to readings from first time.

ccc_mc_lonw&lt;-ccc_vc(bfat,"BF","SUBJECT","MET","VISITNO",vecD=c(2,1,1))
ccc_mc_lonw
summary(ccc_mc_lonw)

## End(Not run)

</code></pre>

<hr>
<h2 id='ccclon'>Concordance Correlation Coefficient estimated by Variance Components</h2><span id='topic+ccclon'></span>

<h3>Description</h3>

<p>Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccclon(
  dataset,
  ry,
  rind,
  rtime,
  rmet,
  covar = NULL,
  rho = 0,
  cl = 0.95,
  control.lme = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccclon_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="ccclon_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been deprecated. See <a href="#topic+ccc_vc">ccc_vc</a>.
</p>

<hr>
<h2 id='ccclonw'>Concordance Correlation Coefficient estimated by Variance Components</h2><span id='topic+ccclonw'></span>

<h3>Description</h3>

<p>Concordance Correlation Coefficient for longitudinal repeated measures estimated by variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccclonw(
  dataset,
  ry,
  rind,
  rtime,
  rmet,
  vecD,
  covar = NULL,
  rho = 0,
  cl = 0.95,
  control.lme = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ccclonw_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="ccclonw_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been deprecated. See <a href="#topic+ccc_vc">ccc_vc</a>.
</p>

<hr>
<h2 id='cccUst'>Repeated Measures Concordance Correlation Coefficient estimated by U-statistics</h2><span id='topic+cccUst'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for repeated measurements using the U-statistics approach. The function is also applicable for the non-repeated measurements scenario.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cccUst(dataset, ry, rmet, rtime = NULL, Dmat = NULL, delta = 1, cl = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cccUst_+3A_dataset">dataset</code></td>
<td>
<p>An object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_dmat">Dmat</code></td>
<td>
<p>Matrix of weights.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_delta">delta</code></td>
<td>
<p>Power of the differences. A value of 0 provides an estimate that is comparable to a repeated measures version of kappa index.</p>
</td></tr>
<tr><td><code id="cccUst_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector that includes the point estimate, confidence interval and standard error of the CCC. Additionally the Fisher's Z-transformation value and its standard error are also provided.
</p>


<h3>References</h3>


<p>King, TS and Chinchilli, VM. (2001). A generalized concordance correlation coefficient for continuous and categorical data. Statistics in Medicine, 20, 2131:2147.
</p>
<p>King, TS; Chinchilli, VM; Carrasco, JL. (2007). A repeated measures concordance correlation coefficient. Statistics in Medicine, 26, 3095:3113.
</p>
<p>Carrasco, JL; Phillips, BR; Puig-Martinez, J; King, TS;  Chinchilli, VM. (2013). Estimation of the concordance correlation coefficient for repeated measures using SAS and R. Computer Methods and Programs in Biomedicine, 109, 293-304.

</p>


<h3>Examples</h3>

<pre><code class='language-R'># Non-longitudinal scenario
newdat=bpres[bpres$NM==1,]
estccc=cccUst(newdat,"DIA","METODE")
estccc

estccc=cccUst(bdaw,"AUC","MET","VNUM")
estccc

estccc=cccUst(bfat,"BF","MET","VISITNO",Dmat=diag(c(2,1,1)))
estccc
</code></pre>

<hr>
<h2 id='cccvc'>Concordance Correlation Coefficient estimated by Variance Components</h2><span id='topic+cccvc'></span>

<h3>Description</h3>

<p>Estimation of the concordance correlation coefficient for non-repeated measurements and non-longitudinal repeated measurements (replicates) using the variance components from a linear mixed model. The appropriate intraclass correlation coefficient is used as estimator of the concordance correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cccvc(
  dataset,
  ry,
  rind,
  rmet,
  covar = NULL,
  int = FALSE,
  cl = 0.95,
  control.lme = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cccvc_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="cccvc_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="cccvc_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has been deprecated. See <a href="#topic+ccc_vc">ccc_vc</a>.
</p>

<hr>
<h2 id='lme_model'>Fits a Linear Mixed Effects Model</h2><span id='topic+lme_model'></span>

<h3>Description</h3>

<p>Fits a Linear Mixed Effects Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lme_model(
  dataset,
  ry,
  rind,
  rtime = NULL,
  rmet = NULL,
  vecD = NULL,
  covar = NULL,
  rho = 0,
  int = FALSE,
  cl = 0.95,
  control.lme = list(),
  apVar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lme_model_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autoregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_int">int</code></td>
<td>
<p>Boolean indicating if the subject-method interaction has to be included in the model.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="lme_model_+3A_apvar">apVar</code></td>
<td>
<p>Logical. Should the asymptotic variance-covariance matrix of the variance components be estimated in the linear mixed model? (Defaults to TRUE).</p>
</td></tr>
<tr><td><code id="lme_model_+3A_...">...</code></td>
<td>
<p>To pass further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>lme</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reliability ICC
set.seed(2024)
df &lt;- ccc_sim_data(b = NULL, g = NULL, mu = -0.25, sa = 1.5, se = 1)
mod1 &lt;- lme_model(df,"y","id")
mod1

#Non-longitudinal Methods comparison data
set.seed(2024)
df2 &lt;- ccc_sim_data(n=50,b = c(0,1), mu = -0.25, sa = 1.5, se = 1, nrep=2)
mod2 &lt;- lme_model(df2,"y","id",rmet="met")
mod2

# Longitudinal Methods comparison data
set.seed(2024)
df3 &lt;- ccc_sim_data(n=50, b = c(0,1), g=c(0,0.25,0.5), mu = -0.25, sa = 1.5, 
                    sab=0.25,sag=0.5,bg=c(0,0.5,0.75,0,1,1),se = 1, nrep=2)

mod3 &lt;- lme_model(df3,"y","id","times","met",control.lme=nlme::lmeControl(opt = 'optim'))
mod3

</code></pre>

<hr>
<h2 id='np_boot_ccc_by_time'>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient by time variable</h2><span id='topic+np_boot_ccc_by_time'></span>

<h3>Description</h3>

<p>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient by time variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np_boot_ccc_by_time(
  dataset,
  ry,
  rind,
  rmet,
  rtime,
  covar = NULL,
  int = FALSE,
  cl = 0.95,
  control.lme = list(),
  nboot = 500,
  future_seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="np_boot_ccc_by_time_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code></p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="np_boot_ccc_by_time_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in <code>furrr_options</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of CCC bootstrap estimates.
</p>

<hr>
<h2 id='np_boot_ci'>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient</h2><span id='topic+np_boot_ci'></span>

<h3>Description</h3>

<p>Non-parametric cluster bootstrap to make inference on the concordance correlation coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np_boot_ci(
  dataset,
  ry,
  rind,
  rtime = NULL,
  rmet = NULL,
  vecD = NULL,
  covar = NULL,
  rho = 0,
  int = FALSE,
  cl = 0.95,
  control.lme = list(),
  nboot = 500,
  parallel = TRUE,
  future_seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="np_boot_ci_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code></p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_parallel">parallel</code></td>
<td>
<p>Whether the code is parallellized. The parallellization method is <code>multisession</code>.</p>
</td></tr>
<tr><td><code id="np_boot_ci_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in <code>furrr_options</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of CCC bootstrap estimates.
</p>

<hr>
<h2 id='para_boot_ci'>Parametric bootstrap to make inference on the concordance correlation coefficient</h2><span id='topic+para_boot_ci'></span>

<h3>Description</h3>

<p>Parametric bootstrap to make inference on the concordance correlation coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>para_boot_ci(
  dataset,
  model,
  ry,
  rind,
  rtime = NULL,
  rmet = NULL,
  vecD = NULL,
  covar = NULL,
  rho = 0,
  int = F,
  cl = 0.95,
  control.lme = list(),
  nboot = 500,
  parallel = TRUE,
  future_seed = 121
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="para_boot_ci_+3A_dataset">dataset</code></td>
<td>
<p>an object of class <code>data.frame</code></p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_model">model</code></td>
<td>
<p>an object of class <code>lme</code></p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_ry">ry</code></td>
<td>
<p>Character string. Name of the outcome in the data set.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_rind">rind</code></td>
<td>
<p>Character string. Name of the subject variable in the data set.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_rtime">rtime</code></td>
<td>
<p>Character string. Name of the time variable in the data set.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_rmet">rmet</code></td>
<td>
<p>Character string. Name of the method variable in the data set.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_parallel">parallel</code></td>
<td>
<p>Whether the code is parallellized. The parallellization method is <code>multisession</code>.</p>
</td></tr>
<tr><td><code id="para_boot_ci_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in <code>furrr_options</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of CCC bootstrap estimates.
</p>

<hr>
<h2 id='sim_power_ccc'>Power and confidence interval range</h2><span id='topic+sim_power_ccc'></span>

<h3>Description</h3>

<p>Power and confidence interval range obtained by simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_power_ccc(
  n = 30,
  nrep = 2,
  nsim = 300,
  r0 = 0,
  alpha = 0.05,
  model = NULL,
  b = NULL,
  g = NULL,
  mu = 0,
  sa = 1,
  sab = 0,
  sag = 0,
  bg = NULL,
  se = 1,
  extra.info = TRUE,
  vecD = NULL,
  covar = NULL,
  int = FALSE,
  rho = 0,
  cl = 0.95,
  control.lme = list(),
  transf = "F2",
  future_seed = TRUE,
  workers = 15
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_power_ccc_+3A_n">n</code></td>
<td>
<p>Integer. Number of subjects</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_nrep">nrep</code></td>
<td>
<p>Integer. Number of replicates</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_nsim">nsim</code></td>
<td>
<p>Integer. Number of data sets simulated.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_r0">r0</code></td>
<td>
<p>Integer. Null hypothesis value.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_alpha">alpha</code></td>
<td>
<p>Type-I error rate.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_model">model</code></td>
<td>
<p>object of class <code>lme</code>.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_b">b</code></td>
<td>
<p>Vector. Method fixed effects.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_g">g</code></td>
<td>
<p>Vector. Time fixed effects.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_mu">mu</code></td>
<td>
<p>Integer. Overall mean.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_sa">sa</code></td>
<td>
<p>Integer. Standard deviation of subject's random effect.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_sab">sab</code></td>
<td>
<p>Integer. Standard deviation of subject-method interaction's random effect.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_sag">sag</code></td>
<td>
<p>Integer. Standard deviation of subject-time interaction's random effect.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_bg">bg</code></td>
<td>
<p>Vector. Method-time interaction's fixed effects</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_se">se</code></td>
<td>
<p>Integer. Standard deviation of random error effect.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_extra.info">extra.info</code></td>
<td>
<p>Logical. Should the information about CCC and variance components simulated be shown?  Default is set to TRUE.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_vecd">vecD</code></td>
<td>
<p>Vector of weights. The length of the vector must be the same as the number of repeated measures.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_covar">covar</code></td>
<td>
<p>Character vector. Name of covariates to include in the linear mixed model as fixed effects.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_int">int</code></td>
<td>
<p>Binary indicating if the subject-method interaction has to be included in the model when analyzing the non-longitudinal setting (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_rho">rho</code></td>
<td>
<p>Within subject correlation structure. A value of 0 (default option) stands for compound symmetry and 1 is used for autorregressive of order 1 structure.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_cl">cl</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_control.lme">control.lme</code></td>
<td>
<p>A list of control values for the estimation algorithm used in <code>lme</code> function. For further details see <code>lme</code> help.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_transf">transf</code></td>
<td>
<p>Character string. Whether to apply a transformation of the coefficient for inference. Valid options are: &quot;F&quot; for Fisher's Z-transformation; &quot;F2&quot; For Fisher's Z-transformation setting m=2 (default); &quot;KG&quot; Konishi-Gupta transformasion; &quot;None&quot;, no transformation is applied. See *Details* for further information.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_future_seed">future_seed</code></td>
<td>
<p>Logical/Integer. The seed to be used for parallellization. Further details in <code>furrr_options</code>.</p>
</td></tr>
<tr><td><code id="sim_power_ccc_+3A_workers">workers</code></td>
<td>
<p>Integer. Number of cores to be used for parallellization. Default is 15. Capped to number of available cores minus 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power and the range of the confidence interval are computed using the approach suggested in Choudhary and Nagaraja (2018). Data sets are simulated by setting the fixed effects values and the standard deviation of the random effects. The CCC and its standard error are estimated in each data set, along with its 95% confidence interval and the Wald test <code><a href="#topic+Ztest">Ztest</a></code>.
</p>


<h3>Value</h3>

<p>A data frame with the following components:
</p>

<ul>
<li> <p><code>n</code> Number of subjects
</p>
</li>
<li> <p><code>reps</code> Number of replicates
</p>
</li>
<li> <p><code>CCC</code>. Median of the CCC estimates.
</p>
</li>
<li> <p><code>Power</code>. Empirical power computed as proportion of times the null hypothesis is rejected using a type-I error rate of <code>alpha</code>.
</p>
</li>
<li> <p><code>SEICC</code>. Average of CCC standard errors.
</p>
</li>
<li> <p><code>SEZ</code>. Average of transformed CCC standard errors.
</p>
</li>
<li> <p><code>Range IC95</code>. Average of CCC confidence interval widths.
</p>
</li></ul>



<h3>References</h3>

<p>Choudhary, P.K. and Nagaraja, H.N. (2018). Measuring Agreement-Models, Methods, and Applications. John Wiley &amp; Sons
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Power to test the CCC is above 0.8 with 35 subjects and 4 replicates.
# Two methods, three times. Simulated CCC=0.87.
sim_pw&lt;-sim_power_ccc(n = 35, nrep=4, nsim=500, r0=0.8, b = c(-0.5,0.5), 
g=c(-0.25,0,0.25), mu = -0.25, sa = 4,sab=0.5,sag=1,
bg=c(-0.5,-0.25,0.25,-0.5,0.25,0.75),se = 1)




</code></pre>

<hr>
<h2 id='Ztest'>Wald's test on the Concordance Correlation Coefficient</h2><span id='topic+Ztest'></span>

<h3>Description</h3>

<p>Wald's test is applied to assess whether the CCC (ICC) is greater than a reference value.
Additionally, Wald's test is also used to compare two independent CCC (ICC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ztest(cccfit, cccfit2 = NULL, r0 = 0, info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ztest_+3A_cccfit">cccfit</code></td>
<td>
<p>An object of class <code>ccc</code>.</p>
</td></tr>
<tr><td><code id="Ztest_+3A_cccfit2">cccfit2</code></td>
<td>
<p>An object of class <code>ccc</code>.</p>
</td></tr>
<tr><td><code id="Ztest_+3A_r0">r0</code></td>
<td>
<p>Integer. Null hypothesis value.</p>
</td></tr>
<tr><td><code id="Ztest_+3A_info">info</code></td>
<td>
<p>Logical. Should information about the transformation used be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If only one ccc is provided, the function runs a one sided test to the null hypothesis value </p>
<p style="text-align: center;"><code class="reqn">\rho_0</code>
</p>
<p>.
</p>
<p style="text-align: center;"><code class="reqn">z=\frac{\hat{\theta}-\rho_0}{SE\left(\hat{\theta}\right)}</code>
</p>
<p> where </p>
<p style="text-align: center;"><code class="reqn">\hat{\theta}</code>
</p>
<p> stands for the CCC estimate and </p>
<p style="text-align: center;"><code class="reqn">SE\left(\hat{\theta}\right)</code>
</p>
<p> its standard error.
If a second CCC is provided, the function runs a two-sided test to the null hypothesis of equality of CCCs.
</p>
<p style="text-align: center;"><code class="reqn">z=\frac{\hat{\theta_1}-\hat{\theta_2}}{\sqrt{Var\left(\hat{\theta_1}\right)}+Var\left(\hat{\theta_2}\right)}</code>
</p>
<p>.
In both cases, the p-value is computed as </p>
<p style="text-align: center;"><code class="reqn">P\left(X&gt;z\right)</code>
</p>
<p> where X follows a standard Normal distribution.
The test uses the transformation indicated when the <code>ccc</code> object was generated.
</p>


<h3>Value</h3>

<p>A data frame with two columns: <code>Z</code>, the statistical test value; and the P-value associated.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing the CCC is above 0.8
ccc_mc=ccc_vc(bpres,"DIA","ID","METODE")
ccc_mc
Ztest(ccc_mc,r0=0.8)

# Comparing two CCC

bpres_Male &lt;- bpres |&gt; dplyr::filter(SEXO==1)
bpres_Female &lt;- bpres |&gt; dplyr::filter(SEXO==2)

ccc_DIA_Male=ccc_vc(bpres_Male,"DIA","ID","METODE")
ccc_DIA_Female=ccc_vc(bpres_Female,"DIA","ID","METODE")
Ztest(ccc_DIA_Male,ccc_DIA_Female)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
