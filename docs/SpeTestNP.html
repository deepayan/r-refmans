<!DOCTYPE html><html><head><title>Help for package SpeTestNP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpeTestNP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#print.STNP'>
<p>Print a specification test <code>STNP</code> object</p></a></li>
<li><a href='#SpeTest'>
<p>Nonparametric specification test</p></a></li>
<li><a href='#SpeTest_Dist'>
<p>Nonparametric specification test statistic distribution</p></a></li>
<li><a href='#SpeTest_Stat'>
<p>Nonparametric specification test statistic</p></a></li>
<li><a href='#summary.STNP'>
<p>Summarize a specification test <code>STNP</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Parametric Tests of Parametric Specifications</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-24</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats, foreach, parallel, doParallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, AER</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Hippolyte Boucher [aut, cre],
  Pascal Lavergne [aut]</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Performs non-parametric tests of parametric specifications.
    Five tests are available. 
    Specific bandwidth and kernel methods can be chosen along with many other options. 
    Allows parallel computing to quickly compute p-values based on the bootstrap. 
    Methods implemented in the package are H.J. Bierens (1982) &lt;<a href="https://doi.org/10.1016%2F0304-4076%2882%2990105-1">doi:10.1016/0304-4076(82)90105-1</a>&gt;,
    J.C. Escanciano (2006) &lt;<a href="https://doi.org/10.1017%2FS0266466606060506">doi:10.1017/S0266466606060506</a>&gt;,
    P.L. Gozalo (1997) &lt;<a href="https://doi.org/10.1016%2FS0304-4076%2897%2986571-2">doi:10.1016/S0304-4076(97)86571-2</a>&gt;,
    P. Lavergne and V. Patilea (2008) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2007.08.014">doi:10.1016/j.jeconom.2007.08.014</a>&gt;,
    P. Lavergne and V. Patilea (2012) &lt;<a href="https://doi.org/10.1198%2Fjbes.2011.07152">doi:10.1198/jbes.2011.07152</a>&gt;,
    J.H. Stock and M.W. Watson (2006) &lt;<a href="https://doi.org/10.1111%2Fj.1538-4616.2007.00014.x">doi:10.1111/j.1538-4616.2007.00014.x</a>&gt;,
    C.F.J. Wu (1986) &lt;<a href="https://doi.org/10.1214%2Faos%2F1176350142">doi:10.1214/aos/1176350142</a>&gt;,
    J. Yin, Z. Geng, R. Li, H. Wang (2010) <a href="https://www.jstor.org/stable/24309002">https://www.jstor.org/stable/24309002</a>
    and J.X. Zheng (1996) &lt;<a href="https://doi.org/10.1016%2F0304-4076%2895%2901760-7">doi:10.1016/0304-4076(95)01760-7</a>&gt;.</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/HippolyteBoucher/SpeTestNP">https://github.com/HippolyteBoucher/SpeTestNP</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-24 10:35:19 UTC; Hippo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-28 17:10:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='print.STNP'>
Print a specification test <code>STNP</code> object
</h2><span id='topic+print.STNP'></span>

<h3>Description</h3>

<p>Prints the test statistic and p-value of a specification test object of class <code>STNP</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STNP'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.STNP_+3A_x">x</code></td>
<td>

<p>An object of class <code>STNP</code> resulting from function <code><a href="#topic+SpeTest">SpeTest</a></code>
</p>
</td></tr>
<tr><td><code id="print.STNP_+3A_...">...</code></td>
<td>

<p>Additional print arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, prints the test statistic and p-value
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpeTest">SpeTest</a></code> is the function which performs a specification test and records it along with all its options in an object of class <code>STNP</code>
</p>
<p><code><a href="#topic+summary.STNP">summary.STNP</a></code> prints a summary of the specification test with all the options used
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)


print(SpeTest(eq=eq,type="icm",nboot=50))

</code></pre>

<hr>
<h2 id='SpeTest'>
Nonparametric specification test
</h2><span id='topic+SpeTest'></span>

<h3>Description</h3>

<p><code>SpeTest</code> tests a parametric specification. It returns the test statistic and its p-value for five different heteroskedasticity-robust nonparametric specification tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpeTest(eq, type="icm", rejection="bootstrap", norma="no", boot="wild", 
nboot=50, para=FALSE, ker="normal",knorm="sd", cch="default", hv="default", 
nbeta="default", direct="default", alphan="default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpeTest_+3A_eq">eq</code></td>
<td>

<p>A fitted model of class <code>lm</code> or <code>nls</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_type">type</code></td>
<td>

<p>Test type
</p>
<p>If <code>type = "icm"</code> the test of Bierens (1982) is performed (default)
</p>
<p>If <code>type = "zheng"</code> the test of Zheng (1996) is performed
</p>
<p>If <code>type = "esca"</code> the test of Escanciano (2006) is performed, significantly increases computing time
</p>
<p>If <code>type = "pala"</code> the test of Lavergne and Patilea (2008) is performed
</p>
<p>If <code>type = "sicm"</code> the test of Lavergne and Patilea (2012) is performed
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_rejection">rejection</code></td>
<td>

<p>Rejection rule
</p>
<p>If <code>rejection = "bootstrap"</code> the p-value of the test is based on the bootstrap (default)
</p>
<p>If <code>rejection = "asymptotics"</code> and <code>type = "zheng"</code> or <code>type = "esca"</code> or <code>type = "sicm"</code> the p-value of the test is based on asymptotic normality of the normalized test statistic under the null hypothesis
</p>
<p>If <code>type = "icm"</code> or <code>type = "esca"</code> the argument <code>rejection</code> is ignored and the p-value is based on the bootstrap
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_norma">norma</code></td>
<td>

<p>Normalization of the test statistic
</p>
<p>If <code>norma = "no"</code> the test statistic is not normalized (default)
</p>
<p>If <code>norma = "naive"</code> the test statistic is normalized with a naive estimator of the variance of its components
</p>
<p>If <code>norma = "np"</code> the test statistic is normalized with a nonparametric estimator of the variance of its components
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_boot">boot</code></td>
<td>

<p>Bootstrap method to compute the test p-value
</p>
<p>If <code>boot = "wild"</code> the wild bootstrap of Wu (1986) is used (default)
</p>
<p>If <code>boot = "smooth"</code> the smooth conditional moments bootstrap of Gozalo (1997) is used
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_nboot">nboot</code></td>
<td>

<p>Number of bootstraps used to compute the test p-value, by default <code>nboot = 50</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_para">para</code></td>
<td>

<p>Parallel computing
</p>
<p>If <code>para = FALSE</code> parallel computing is not used to generate the bootstrap samples to compute the test p-value (default)
</p>
<p>If <code>para = TRUE</code> parallel computing is used to generate the bootstrap samples to compute the test p-value, significantly decreases computing time, makes use of all CPU cores except one
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_ker">ker</code></td>
<td>

<p>Kernel function used in the central matrix and for the nonparametric covariance estimator
</p>
<p>If <code>ker = "normal"</code> the central matrix kernel function is the normal p.d.f (default)
</p>
<p>If <code>ker = "triangle"</code> the central matrix kernel function is the triangular p.d.f
</p>
<p>If <code>ker = "logistic"</code> the central matrix kernel function is the logistic p.d.f
</p>
<p>If <code>ker = "sinc"</code> the central matrix kernel function is the sine cardinal function
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_knorm">knorm</code></td>
<td>

<p>Normalization of the kernel function
</p>
<p>If <code>knorm = "sd"</code> then the standard deviation using the kernel function equals 1 (default)
</p>
<p>If <code>knorm ="sq"</code> then the integral of the squared kernel function equals 1
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_cch">cch</code></td>
<td>

<p>Central matrix kernel bandwidth 
</p>
<p>If <code>type = "icm"</code> or <code>type = "esca"</code> then <code>cch</code> always equals <code>1</code>
</p>
<p>If <code>type = "zheng"</code> the <code>"default"</code> bandwidth is the scaled
rule of thumb: <code>cch = 1.06*n^(-1/(4+k))</code> where <code>k</code> is
the number of regressors
</p>
<p>If <code>type = "sicm"</code> or <code>type = "pala"</code> the <code>"default"</code>
bandwidth is the scaled rule of thumb: <code>cch = 1.06*n^(-1/5)</code>
</p>
<p>The user may change the bandwidth when <code>type = "zheng"</code>, <code>type = "sicm"</code> or <code>type = "pala"</code>.
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_hv">hv</code></td>
<td>

<p>If <code>norma = "np"</code> or <code>rejection = "bootstrap"</code> and <code>boot = "smooth"</code>, <code>hv</code> is the bandwidth of the nonparametric errors covariance estimator, by <code>"default"</code> the bandwidth is the scaled rule of thumb <code>hv = 1.06*n^(-1/(4+k))</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_nbeta">nbeta</code></td>
<td>

<p>If <code>type = "pala"</code> or <code>type = "sicm"</code>, <code>nbeta</code> is the number of &quot;betas&quot; in the unit hypersphere used to compute the statistic, computing time increases as <code>nbeta</code> gets larger
</p>
<p>By <code>"default"</code> it is equal to 20 times the square root of the number of exogenous control variables
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_direct">direct</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>direct</code> is the favored direction for beta, by <code>"default"</code> it is the OLS estimator if <code>class(eq) = "lm"</code>
</p>
<p>If <code>type = "sicm"</code>, <code>direct</code> is the initial direction for beta. This direction should be a vector of <code>0</code> (for no direction), <code>1</code> (for positive direction) and <code>-1</code> (for negative direction)
</p>
<p>For ex, <code>c(1,-1,0)</code> indicates that the user thinks that the first regressor has a positive effect on the dependent variable, that the second regressor has a negative effect on the dependent variable, and that he has no idea about the effect of the third regressor
</p>
<p>By <code>"default"</code> no direction is given to the hypersphere
</p>
</td></tr>
<tr><td><code id="SpeTest_+3A_alphan">alphan</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>alphan</code> is the weight given to the favored direction for beta, by <code>"default"</code> it is equal to <code>log(n)*n^(-3/2)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To perform a nonparametric specification test the only argument needed is a model <code>eq</code> of class <code>lm</code> or of class <code>nls</code>.
But other options can and should be specified: the test type <code>type</code>, the rejection rule <code>rejection</code>, the normalization of the test statistic <code>norm</code>, the bootstrap type <code>boot</code> and the size of the vector being generated which is equal to the number of bootstrap samples <code>nboot</code>, whether the vector is generated using parallel computing <code>para</code>, the central matrix kernel function <code>ker</code> and its standardization <code>ker</code>, the bandwidths <code>cch</code> and <code>hv</code>. If the user has knowledge of the tests coined by Lavergne and Patilea he may choose a higher number of betas for the hypersphere (which may significantly increase computational time) and an initial &quot;direction&quot; to the hypersphere for the SICM test (none is given by <code>"default"</code>) or a starting beta for the PALA test (which is the OLS estimator by <code>"default"</code> if <code>class(eq) = "nls"</code>).
</p>
<p>The statistic can be normalized with a naive estimator of the conditional covariance of its elements as in Zheng (1996), or with a nonparametric estimator of the conditional covariance of its elements as in in Yin, Geng, Li, Wang (2010). The p-value is based either on the wild bootstrap of Wu (1986) or on the smooth conditional moments bootstrap of Gozalo (1997).
</p>


<h3>Value</h3>

<p><code>SpeTest</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>STNP</code>.
</p>
<p><code><a href="base.html#topic+summary">summary</a></code> and <code><a href="base.html#topic+print">print</a></code> can be used on objects of this class.
</p>
<p>An object of class <code>STNP</code> is a list which contains the following elements:
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>The value of the test statistic used in the test</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The test p-value</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The type of test which was used</p>
</td></tr>
<tr><td><code>boot</code></td>
<td>
<p>The type of bootstrap which was used to compute the p-value</p>
</td></tr>
<tr><td><code>nboot</code></td>
<td>
<p>The number of bootstrap samples used to compute the p-value</p>
</td></tr>
<tr><td><code>ker</code></td>
<td>
<p>The central matrix kernel function which was used</p>
</td></tr>
<tr><td><code>knorm</code></td>
<td>
<p>The kernel matrix standardization: <code>"sq"</code> if the second moment equals
1 or <code>"sd"</code> if the standard deviation equals 1
</p>
</td></tr>
<tr><td><code>cch</code></td>
<td>
<p>The central matrix kernel function bandwidth</p>
</td></tr>
<tr><td><code>hv</code></td>
<td>
<p>The nonparametric covariance estimator bandwidth</p>
</td></tr>
<tr><td><code>nbeta</code></td>
<td>
<p>The number of directions in the unit hypersphere used to compute the test statistic if <code>type = "pala"</code> or <code>type = "sicm"</code></p>
</td></tr>
<tr><td><code>direct</code></td>
<td>
<p>The preferred / initial direction in the unit hypersphere if <code>type = "pala"</code> or <code>type = "sicm"</code></p>
</td></tr>
<tr><td><code>alphan</code></td>
<td>
<p>The weight given to the preferred direction if <code>type = "pala"</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>The data used to obtain the fitted model <code>eq</code> should not contain factors, factor variables should be transformed into dummy variables a priori
</p>
<p>Requires the packages <code>stats</code>  (already installed and loaded by default in Rstudio), <code>foreach</code>, <code>parallel</code> and <code>doParallel</code> (if parallel computing is used to generate the test p-value) to be installed
</p>
<p>For more information and to be able to use the package to its full potential see the references
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>References</h3>

<p>H.J. Bierens (1982), &quot;Consistent Model Specification Test&quot;,
<cite>Journal of Econometrics</cite>, 20 (1), 105-134
</p>
<p>J.C. Escanciano (2006), &quot;A Consistent Diagnostic Test for Regression Models using Projections&quot;,
<cite>Economic Theory</cite>, 22 (6), 1030-1051
</p>
<p>P.L. Gozalo (1997), &quot;Nonparametric Bootstrap Analysis with Applications to Demographic Effects in Demand Functions&quot;,
<cite>Journal of Econometrics</cite>, 81 (2), 357-393
</p>
<p>P. Lavergne and V. Patilea (2008), &quot;Breaking the Curse of Dimensionality in Nonparametric Testing&quot;, <cite>Journal of Econometrics</cite>, 143 (1), 103-122
</p>
<p>P. Lavergne and V. Patilea (2012), &quot;One for All and All for One: Regression Checks with Many Regressors&quot;,
<cite>Journal of Business and Economic Statistics</cite>, 30 (1), 41-52
</p>
<p>C.F.J. Wu (1986), &quot;Jackknife, bootstrap and other resampling methods in regression analysis (with discussion)&quot;, <cite>Annals of Statistics</cite>, 14 (4), 1261-1350
</p>
<p>J. Yin, Z. Geng, R. Li, H. Wang (2010), &quot;Nonparametric covariance model&quot;,
<cite>Statistica Sinica</cite>, 20 (1), 469-479
</p>
<p>J.X. Zheng (1996), &quot;A Consistent Test of Functional Form via Nonparametric Estimation Techniques&quot;,
<cite>Journal of Econometrics</cite>, 75 (2), 263-289
</p>


<h3>See Also</h3>

<p><code>print</code> and <code><a href="#topic+print.STNP">print.STNP</a></code> applied to an object of class <code>STNP</code> print the specification test statistic and its p-value
</p>
<p><code>summary</code> and <code><a href="#topic+summary.STNP">summary.STNP</a></code> applied to an object of class <code>STNP</code> print a summary of the specification test with all the options used
</p>
<p><code><a href="#topic+SpeTest_Stat">SpeTest_Stat</a></code> is the function which only returns the specification test statistic
</p>
<p><code><a href="#topic+SpeTest_Dist">SpeTest_Dist</a></code> generates a vector drawn from the distribution of the test statistic under the null hypothesis using the bootstrap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)

summary(SpeTest(eq=eq,type="icm",norma="naive",boot="smooth"))

eq&lt;-nls(out~expla1*a+b*expla2+c,start=list(a=0,b=4,c=2),
data=data.frame(out=y,expla1=x[,1],expla2=x[,2]))

print(SpeTest(eq=eq,type="icm",norma="naive",boot="smooth"))

</code></pre>

<hr>
<h2 id='SpeTest_Dist'>
Nonparametric specification test statistic distribution
</h2><span id='topic+SpeTest_Dist'></span>

<h3>Description</h3>

<p><code>SpeTest_Dist</code> generates a vector from the nonparametric specification test statistic distribution under the null hypothesis for one of five different tests using the bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpeTest_Dist(eq, type="icm", norma="no", boot="wild", nboot=50, para=FALSE, ker="normal",
knorm="sd", cch="default", hv="default", nbeta="default", direct="default", 
alphan="default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpeTest_Dist_+3A_eq">eq</code></td>
<td>

<p>A fitted model of class <code>lm</code> or <code>nls</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_type">type</code></td>
<td>

<p>Test type
</p>
<p>If <code>type = "icm"</code> the vector is generated from the distribution of the test of Bierens (1982) under the null hypothesis (default)
</p>
<p>If <code>type = "zheng"</code> the vector is generated from the distribution of the test of Zheng (1996) under the null hypothesis
</p>
<p>If <code>type = "esca"</code> the vector is generated from the distribution of the test of Escanciano (2006) under the null hypothesis, significantly increases computing time
</p>
<p>If <code>type = "pala"</code> the vector is generated from the distribution of the test of Lavergne and Patilea (2008) under the null hypothesis
</p>
<p>If <code>type = "sicm"</code> the vector is generated from the distribution of the test of Lavergne and Patilea (2012) under the null hypothesis
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_norma">norma</code></td>
<td>

<p>Normalization of the test statistic
</p>
<p>If <code>norma = "no"</code> the test statistic is not normalized (default)
</p>
<p>If <code>norma = "naive"</code> the test statistic is normalized with a naive estimator of the variance of its components
</p>
<p>If <code>norma = "np"</code> the test statistic is normalized with a nonparametric estimator of the variance of its components
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_boot">boot</code></td>
<td>

<p>Bootstrap type to generate the vector drawn from the distribution under the null hypothesis of the test statistic
</p>
<p>If <code>boot = "wild"</code> the wild bootstrap of Wu (1986) is used
</p>
<p>If <code>boot = "smooth"</code> the smooth conditional moments bootstrap of Gozalo (1997) is used
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_nboot">nboot</code></td>
<td>

<p>Size of the vector drawn from the test statistic distribution under the null using the bootstrap, by default <code>nboot = 50</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_para">para</code></td>
<td>

<p>Parallel computing
</p>
<p>If <code>para = FALSE</code> parallel computing is not used to generate the vector from the test statistic distribution under the null (default)
</p>
<p>If <code>para = TRUE</code> parallel computing is used to generate the vector from the test statistic distribution under the null, significantly decreases computing time, makes use of all CPU cores except one
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_ker">ker</code></td>
<td>

<p>Kernel function used in the central matrix and for the nonparametric covariance estimator
</p>
<p>If <code>ker = "normal"</code> the central matrix kernel function is the normal p.d.f (default)
</p>
<p>If <code>ker = "triangle"</code> the central matrix kernel function is the triangular p.d.f
</p>
<p>If <code>ker = "logistic"</code> the central matrix kernel function is the logistic p.d.f
</p>
<p>If <code>ker = "sinc"</code> the central matrix kernel function is the sine cardinal function
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_knorm">knorm</code></td>
<td>

<p>Normalization of the kernel function
</p>
<p>If <code>knorm = "sd"</code> then the standard deviation using the kernel function equals 1 (default)
</p>
<p>If <code>knorm ="sq"</code> then the integral of the squared kernel function equals 1
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_cch">cch</code></td>
<td>

<p>Central matrix kernel bandwidth 
</p>
<p>If <code>type = "icm"</code> or <code>type = "esca"</code> then <code>cch</code> always equals <code>1</code>
</p>
<p>If <code>type = "zheng"</code> the <code>"default"</code> bandwidth is the scaled
rule of thumb: <code>cch = 1.06*n^(-1/(4+k))</code> where <code>k</code> is
the number of regressors
</p>
<p>If <code>type = "sicm"</code> or <code>type = "pala"</code> the <code>"default"</code>
bandwidth is the scaled rule of thumb: <code>cch = 1.06*n^(-1/5)</code>
</p>
<p>The user may change the bandwidth when <code>type = "zheng"</code>, <code>type = "sicm"</code> or <code>type = "pala"</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_hv">hv</code></td>
<td>

<p>If <code>norma = "np"</code> or <code>rejection = "bootstrap"</code> and <code>boot = "smooth"</code>, <code>hv</code> is the bandwidth of the nonparametric errors covariance estimator, by <code>"default"</code> the bandwidth is the scaled rule of thumb <code>hv = 1.06*n^(-1/(4+k))</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_nbeta">nbeta</code></td>
<td>

<p>If <code>type = "pala"</code> or <code>type = "sicm"</code>, <code>nbeta</code> is the number of &quot;betas&quot; in the unit hypersphere used to compute the statistic, computing time increases as <code>nbeta</code> gets larger
</p>
<p>By <code>"default"</code> it is equal to 20 times the square root of the number of exogenous control variables
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_direct">direct</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>direct</code> is the favored direction for beta, by <code>"default"</code> it is the OLS estimator if <code>class(eq) = "lm"</code>
</p>
<p>If <code>type = "sicm"</code>, <code>direct</code> is the initial direction for beta. This direction should be a vector of <code>0</code> (for no direction), <code>1</code> (for positive direction) and <code>-1</code> (for negative direction)
</p>
<p>For ex, <code>c(1,-1,0)</code> indicates that the user thinks that the first regressor has a positive effect on the dependent variable, that the second regressor has a negative effect on the dependent variable, and that he has no idea about the effect of the third regressor
</p>
<p>By <code>"default"</code> no direction is given to the hypersphere
</p>
</td></tr>
<tr><td><code id="SpeTest_Dist_+3A_alphan">alphan</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>alphan</code> is the weight given to the favored direction for beta, by <code>"default"</code> it is equal to <code>log(n)*n^(-3/2)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To generate a vector from the specification test statistic distribution under the null using the bootstrap the only argument needed is a model <code>eq</code> of class <code>lm</code> or of class <code>nls</code>.
But other options can and should be specified: the test statistic type <code>type</code>, the normalization of the test statistic <code>norma</code>, the bootstrap type <code>boot</code> and the size of the vector being generated which is equal to the number of bootstrap samples <code>nboot</code>, whether the vector is generated using parallel computing <code>para</code>, the central matrix kernel function <code>ker</code> and its standardization <code>knorm</code>, the bandwidths <code>cch</code> and <code>hv</code>. If the user has knowledge of the tests coined by Lavergne and Patilea he may choose a higher number of betas for the hypersphere (which may significantly increase computational time) and an initial &quot;direction&quot; to the hypersphere for the SICM test (none is given by <code>"default"</code>) or a starting beta for the PALA test (which is the OLS estimator by <code>"default"</code> if <code>class(eq) = "nls"</code>).
</p>
<p>The statistic can be normalized with a naive estimator of the conditional covariance of its elements as in Zheng (1996), or with a nonparametric estimator of the conditional covariance of its elements as in in Yin, Geng, Li, Wang (2010). The vector is generated either from the wild bootstrap of Wu (1986) or from the smooth conditional moments bootstrap of Gozalo (1997).
</p>


<h3>Value</h3>

<p><code>SpeTest_Dist</code> returns a vector of size <code>nboot</code> which is drawn from the distribution of the test statistic under the null hypothesis using the bootstrap
</p>


<h3>Note</h3>

<p>The data used to obtain the fitted model <code>eq</code> should not contain factors, factor variables should be transformed into dummy variables a priori
</p>
<p>Requires the packages <code>stats</code>  (already installed and loaded by default in Rstudio), <code>foreach</code>, <code>parallel</code> and <code>doParallel</code> (if parallel computing is used to generate the vector) to be installed
</p>
<p>For more information and to be able to use the package to its full potential see the references
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>References</h3>

<p>H.J. Bierens (1982), &quot;Consistent Model Specification Test&quot;,
<cite>Journal of Econometrics</cite>, 20 (1), 105-134
</p>
<p>J.C. Escanciano (2006), &quot;A Consistent Diagnostic Test for Regression Models using Projections&quot;,
<cite>Economic Theory</cite>, 22 (6), 1030-1051
</p>
<p>P.L. Gozalo (1997), &quot;Nonparametric Bootstrap Analysis with Applications to Demographic Effects in Demand Functions&quot;,
<cite>Journal of Econometrics</cite>, 81 (2), 357-393
</p>
<p>P. Lavergne and V. Patilea (2008), &quot;Breaking the Curse of Dimensionality in Nonparametric Testing&quot;, <cite>Journal of Econometrics</cite>, 143 (1), 103-122
</p>
<p>P. Lavergne and V. Patilea (2012), &quot;One for All and All for One: Regression Checks with Many Regressors&quot;,
<cite>Journal of Business and Economic Statistics</cite>, 30 (1), 41-52
</p>
<p>C.F.J. Wu (1986), &quot;Jackknife, bootstrap and other resampling methods in regression analysis (with discussion)&quot;, <cite>Annals of Statistics</cite>, 14 (4), 1261-1350
</p>
<p>J. Yin, Z. Geng, R. Li, H. Wang (2010), &quot;Nonparametric covariance model&quot;,
<cite>Statistica Sinica</cite>, 20 (1), 469-479
</p>
<p>J.X. Zheng (1996), &quot;A Consistent Test of Functional Form via Nonparametric Estimation Techniques&quot;,
<cite>Journal of Econometrics</cite>, 75 (2), 263-289
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpeTest">SpeTest</a></code> is the function which performs a specification test and records it along with all its options in an object of class <code>STNP</code>
</p>
<p><code><a href="#topic+SpeTest_Stat">SpeTest_Stat</a></code> is the function which only returns the specification test statistic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)

SpeTest_Dist(eq=eq,type="zheng",boot="wild",nboot=10)

eq&lt;-nls(out~expla1*a+b*expla2+c,start=list(a=0,b=4,c=2),
data=data.frame(out=y,expla1=x[,1],expla2=x[,2]))

SpeTest_Dist(eq=eq,type="zheng",boot="wild",nboot=20)

</code></pre>

<hr>
<h2 id='SpeTest_Stat'>
Nonparametric specification test statistic
</h2><span id='topic+SpeTest_Stat'></span>

<h3>Description</h3>

<p><code>SpeTest</code> computes the nonparametric specification test statistic for one of five different tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpeTest_Stat(eq, type="icm", norma="no", ker="normal", knorm="sd",
cch="default", hv="default", nbeta="default", direct="default", 
alphan="default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpeTest_Stat_+3A_eq">eq</code></td>
<td>

<p>A fitted model of class <code>lm</code> or <code>nls</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_type">type</code></td>
<td>

<p>Test statistic type
</p>
<p>If <code>type = "icm"</code> the test statistic of Bierens (1982) is returned (default)
</p>
<p>If <code>type = "zheng"</code> the test statistic of Zheng (1996) is returned
</p>
<p>If <code>type = "esca"</code> the test statistic of Escanciano (2006) is returned, significantly increases computing time
</p>
<p>If <code>type = "pala"</code> the test statistic of Lavergne and Patilea (2008) is returned
</p>
<p>If <code>type = "sicm"</code> the test statistic of Lavergne and Patilea (2012) is returned
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_norma">norma</code></td>
<td>

<p>Normalization of the test statistic
</p>
<p>If <code>norma = "no"</code> the test statistic is not normalized (default)
</p>
<p>If <code>norma = "naive"</code> the test statistic is normalized with a naive estimator of the variance of its components
</p>
<p>If <code>norma = "np"</code> the test statistic is normalized with a nonparametric estimator of the variance of its components
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_ker">ker</code></td>
<td>

<p>Kernel function used in the central matrix and for the nonparametric covariance estimator
</p>
<p>If <code>ker = "normal"</code> the central matrix kernel function is the normal p.d.f (default)
</p>
<p>If <code>ker = "triangle"</code> the central matrix kernel function is the triangular p.d.f
</p>
<p>If <code>ker = "logistic"</code> the central matrix kernel function is the logistic p.d.f
</p>
<p>If <code>ker = "sinc"</code> the central matrix kernel function is the sine cardinal function
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_knorm">knorm</code></td>
<td>

<p>Normalization of the kernel function
</p>
<p>If <code>knorm = "sd"</code> then the standard deviation using the kernel function equals 1 (default)
</p>
<p>If <code>knorm ="sq"</code> then the integral of the squared kernel function equals 1
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_cch">cch</code></td>
<td>

<p>Central matrix kernel bandwidth 
</p>
<p>If <code>type = "icm"</code> or <code>type = "esca"</code> then <code>cch</code> always equals <code>1</code>
</p>
<p>If <code>type = "zheng"</code> the <code>"default"</code> bandwidth is the scaled
rule of thumb: <code>cch = 1.06*n^(-1/(4+k))</code> where <code>k</code> is
the number of regressors
</p>
<p>If <code>type = "sicm"</code> or <code>type = "pala"</code> the <code>"default"</code>
bandwidth is the scaled rule of thumb: <code>cch = 1.06*n^(-1/5)</code>
</p>
<p>The user may change the bandwidth when <code>type = "zheng"</code>, <code>type = "sicm"</code> or <code>type = "pala"</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_hv">hv</code></td>
<td>

<p>If <code>norma = "np"</code> or <code>rejection = "bootstrap"</code> and <code>boot = "smooth"</code>, <code>hv</code> is the bandwidth of the nonparametric errors covariance estimator, by <code>"default"</code> the bandwidth is the scaled rule of thumb <code>hv = 1.06*n^(-1/(4+k))</code>
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_nbeta">nbeta</code></td>
<td>

<p>If <code>type = "pala"</code> or <code>type = "sicm"</code>, <code>nbeta</code> is the number of &quot;betas&quot; in the unit hypersphere used to compute the statistic, computing time increases as <code>nbeta</code> gets larger
</p>
<p>By <code>"default"</code> it is equal to 20 times the square root of the number of exogenous control variables
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_direct">direct</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>direct</code> is the favored direction for beta, by <code>"default"</code> it is the OLS estimator if <code>class(eq) = "lm"</code>
</p>
<p>If <code>type = "sicm"</code>, <code>direct</code> is the initial direction for beta. This direction should be a vector of <code>0</code> (for no direction), <code>1</code> (for positive direction) and <code>-1</code> (for negative direction)
</p>
<p>For ex, <code>c(1,-1,0)</code> indicates that the user thinks that the first regressor has a positive effect on the dependent variable, that the second regressor has a negative effect on the dependent variable, and that he has no idea about the effect of the third regressor
</p>
<p>By <code>"default"</code> no direction is given to the hypersphere
</p>
</td></tr>
<tr><td><code id="SpeTest_Stat_+3A_alphan">alphan</code></td>
<td>

<p>If <code>type = "pala"</code>, <code>alphan</code> is the weight given to the favored direction for beta, by <code>"default"</code> it is equal to <code>log(n)*n^(-3/2)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To compute the specification test statistic the only argument needed is a model <code>eq</code> of class <code>lm</code> or of class <code>nls</code>.
But other options can and should be specified: the test statistic type <code>type</code>, the normalization of the test statistic <code>norma</code>, the central matrix kernel function <code>ker</code> and its standardization <code>ker</code>, the bandwidths <code>cch</code> and <code>hv</code>. If the user has knowledge of the tests coined by Lavergne and Patilea he may choose a higher number of betas for the hypersphere (which may significantly increase computational time) and an initial &quot;direction&quot; to the hypersphere for the SICM test (none is given by <code>"default"</code>) or a starting beta for the PALA test (which is the OLS estimator by <code>"default"</code> if <code>class(eq) = "nls"</code>).
</p>
<p>The statistic can be normalized with a naive estimator of the conditional covariance of its elements as in Zheng (1996), or with a nonparametric estimator of the conditional covariance of its elements as in in Yin, Geng, Li, Wang (2010).
</p>


<h3>Value</h3>

<p><code>SpeTest_Stat</code> returns the nonparametric specification test statistic
</p>


<h3>Note</h3>

<p>The data used to obtain the fitted model <code>eq</code> should not contain factors, factor variables should be transformed into dummy variables a priori
</p>
<p>Requires the packages <code>stats</code>  (already installed and loaded by default in Rstudio), <code>foreach</code>, <code>parallel</code> and <code>doParallel</code> (if parallel computing is used to generate the vector) to be installed
</p>
<p>For more information and to be able to use the package to its full potential see the references
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>References</h3>

<p>H.J. Bierens (1982), &quot;Consistent Model Specification Test&quot;,
<cite>Journal of Econometrics</cite>, 20 (1), 105-134
</p>
<p>J.C. Escanciano (2006), &quot;A Consistent Diagnostic Test for Regression Models using Projections&quot;,
<cite>Economic Theory</cite>, 22 (6), 1030-1051
</p>
<p>P.L. Gozalo (1997), &quot;Nonparametric Bootstrap Analysis with Applications to Demographic Effects in Demand Functions&quot;,
<cite>Journal of Econometrics</cite>, 81 (2), 357-393
</p>
<p>P. Lavergne and V. Patilea (2008), &quot;Breaking the Curse of Dimensionality in Nonparametric Testing&quot;, <cite>Journal of Econometrics</cite>, 143 (1), 103-122
</p>
<p>P. Lavergne and V. Patilea (2012), &quot;One for All and All for One: Regression Checks with Many Regressors&quot;,
<cite>Journal of Business and Economic Statistics</cite>, 30 (1), 41-52
</p>
<p>C.F.J. Wu (1986), &quot;Jackknife, bootstrap and other resampling methods in regression analysis (with discussion)&quot;, <cite>Annals of Statistics</cite>, 14 (4), 1261-1350
</p>
<p>J. Yin, Z. Geng, R. Li, H. Wang (2010), &quot;Nonparametric covariance model&quot;,
<cite>Statistica Sinica</cite>, 20 (1), 469-479
</p>
<p>J.X. Zheng (1996), &quot;A Consistent Test of Functional Form via Nonparametric Estimation Techniques&quot;,
<cite>Journal of Econometrics</cite>, 75 (2), 263-289
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpeTest">SpeTest</a></code> is the function which performs a specification test and records it along with all its options in an object of class <code>STNP</code>
</p>
<p><code><a href="#topic+SpeTest_Dist">SpeTest_Dist</a></code> generates a vector drawn from the distribution of the test statistic under the null hypothesis using the bootstrap
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)

SpeTest_Stat(eq=eq,type="icm")

eq&lt;-nls(out~expla1*a+b*expla2+c,start=list(a=0,b=4,c=2),
data=data.frame(out=y,expla1=x[,1],expla2=x[,2]))

SpeTest_Stat(eq=eq,type="icm")

</code></pre>

<hr>
<h2 id='summary.STNP'>
Summarize a specification test <code>STNP</code> object
</h2><span id='topic+summary.STNP'></span>

<h3>Description</h3>

<p>Prints a summary of a specification test object of class <code>STNP</code> with all the options used, including if options were <code>"default"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STNP'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.STNP_+3A_object">object</code></td>
<td>

<p>An object of class <code>STNP</code> resulting from function <code><a href="#topic+SpeTest">SpeTest</a></code>
</p>
</td></tr>
<tr><td><code id="summary.STNP_+3A_...">...</code></td>
<td>

<p>Additional summary arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, prints a summary of the test
</p>


<h3>Author(s)</h3>

<p>Hippolyte Boucher &lt;Hippolyte.Boucher@outlook.com&gt;
</p>
<p>Pascal Lavergne &lt;lavergnetse@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SpeTest">SpeTest</a></code> is the function which performs a specification test and records it along with all its options in an object of class <code>STNP</code>
</p>
<p><code><a href="#topic+print.STNP">print.STNP</a></code> prints the specification test statistic and p-value only
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 100
k &lt;- 2
x &lt;- matrix(rnorm(n*k),ncol=k)
y&lt;-1+x%*%(1:k)+rnorm(n)

eq&lt;-lm(y~x+0)


summary(SpeTest(eq=eq,type="icm",norma="np"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
