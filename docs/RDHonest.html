<!DOCTYPE html><html><head><title>Help for package RDHonest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RDHonest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cghs'><p>Oreopoulos (2006) UK general household survey dataset</p></a></li>
<li><a href='#CVb'><p>Critical values for CIs based on a biased Gaussian estimator.</p></a></li>
<li><a href='#headst'><p>Head Start data from Ludwig and Miller (2007)</p></a></li>
<li><a href='#lee08'><p>Lee (2008) US House elections dataset</p></a></li>
<li><a href='#rcp'><p>Battistin, Brugiavini, Rettore, and Weber (2009) retirement consumption</p>
puzzle dataset</a></li>
<li><a href='#RDHonest'><p>Honest inference in RD</p></a></li>
<li><a href='#RDHonestBME'><p>Honest CIs in sharp RD with discrete regressors under BME function class</p></a></li>
<li><a href='#RDScatter'><p>Scatterplot of binned raw observations</p></a></li>
<li><a href='#RDSmoothnessBound'><p>Lower bound on smoothness constant M in sharp RD designs</p></a></li>
<li><a href='#RDTEfficiencyBound'><p>Finite-sample efficiency bounds for minimax CIs</p></a></li>
<li><a href='#rebp'><p>Austrian unemployment duration data from Lalive (2008)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Honest Inference in Regression Discontinuity Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Honest and nearly-optimal confidence intervals in fuzzy and sharp
    regression discontinuity designs and for inference at a point based on local
    linear regression. The implementation is based on Armstrong and Kolesár (2018)
    &lt;<a href="https://doi.org/10.3982%2FECTA14434">doi:10.3982/ECTA14434</a>&gt;, and Kolesár and Rothe (2018)
    &lt;<a href="https://doi.org/10.1257%2Faer.20160945">doi:10.1257/aer.20160945</a>&gt;. Supports covariates, clustering, and weighting.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Formula, withr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, ggplot2, testthat, knitr, rmarkdown, formatR</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kolesarm/RDHonest">https://github.com/kolesarm/RDHonest</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kolesarm/RDHonest/issues">https://github.com/kolesarm/RDHonest/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-22 00:10:30 UTC; kolesarm</td>
</tr>
<tr>
<td>Author:</td>
<td>Michal Kolesár <a href="https://orcid.org/0000-0002-2482-7796"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Tim Armstrong [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michal Kolesár &lt;kolesarmi@googlemail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-22 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cghs'>Oreopoulos (2006) UK general household survey dataset</h2><span id='topic+cghs'></span>

<h3>Description</h3>

<p>Oreopoulos (2006) UK general household survey dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cghs
</code></pre>


<h3>Format</h3>

<p>A data frame with 73,954 rows and 2 variables:
</p>

<dl>
<dt>earnings</dt><dd><p>Annual earnings in 1998 (UK pounds)</p>
</dd>
<dt>yearat14</dt><dd><p>Year individual turned 14</p>
</dd>
</dl>



<h3>Source</h3>

<p>American Economic Review data archive,
<a href="https://doi.org/10.1257/000282806776157641">doi:10.1257/000282806776157641</a>
</p>


<h3>References</h3>


<p><cite>Philip Oreopoulos. Estimating average and local average treatment
effects when compulsory education schooling laws really matter.
American Economic Review, 96(1):152–175, 2006.
<a href="https://doi.org/10.1257/000282806776157641">doi:10.1257/000282806776157641</a></cite>
</p>


<hr>
<h2 id='CVb'>Critical values for CIs based on a biased Gaussian estimator.</h2><span id='topic+CVb'></span>

<h3>Description</h3>

<p>Computes the critical value <code class="reqn">cv_{1-\alpha}(B)</code> such that
the confidence interval <code class="reqn">X\pm cv_{1-\alpha}(B)</code>
has coverage <code class="reqn">1-\alpha</code>, where the estimator <code class="reqn">X</code> is normally
distributed with variance equal to <code class="reqn">1</code> and maximum bias at most <code class="reqn">B</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CVb(B, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CVb_+3A_b">B</code></td>
<td>
<p>Maximum bias, vector of non-negative numbers.</p>
</td></tr>
<tr><td><code id="CVb_+3A_alpha">alpha</code></td>
<td>
<p>Determines CI level, <code class="reqn">1-\alpha</code>. Scalar between 0
and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of critical values, one for each value of maximum bias
supplied by <code>B</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 90% critical value:
CVb(B = 1, alpha = 0.1)
## Usual 95% critical value
CVb(0)
## Returns vector with 3 critical values
CVb(B = c(0, 0.5, 1), alpha = 0.05)
</code></pre>

<hr>
<h2 id='headst'>Head Start data from Ludwig and Miller (2007)</h2><span id='topic+headst'></span>

<h3>Description</h3>

<p>Subset of Ludwig-Miller (2007) data. Counties with missing poverty rate, or
with both outcomes missing (<code>hs</code> and <code>mortality</code>) were removed. In
the original dataset, Yellowstone County, MT (<code>oldcode = 27056</code>) was
entered twice, here the duplicate is removed. Yellowstone National Park, MT
(<code>oldcode = 27057</code>) is also removed due to it being an outlier for both
outcomes. Counties with <code>oldcode</code> equal to (3014, 32032, 47010, 47040,
47074, 47074, 47078, 47079, 47096) matched more than one FIPS entry, so the
county labels may not be correct. Mortality data is missing for Alaska.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>headst
</code></pre>


<h3>Format</h3>

<p>A data frame with 3,127 rows and 18 variables:
</p>

<dl>
<dt>statefp</dt><dd><p>State FIPS code</p>
</dd>
<dt>countyfp</dt><dd><p>County FIPS code</p>
</dd>
<dt>oldcode</dt><dd><p>ID in Ludwig-Miller dataset</p>
</dd>
<dt>povrate</dt><dd><p>Poverty rate in 1960 relative to 300th poorest county (which
had poverty rate 59.1984)</p>
</dd>
<dt>mortHS</dt><dd><p>Average Mortality rate per 100,000 for children aged 5-9 over
1973&ndash;83 due to causes addressed as part of Head Start's health services</p>
</dd>
<dt>mortInj</dt><dd><p>Average Mortality rate per 100,000 for children aged 5-9 over
1973&ndash;83 due to injury</p>
</dd>
<dt>hs90</dt><dd><p>High school completion rate in 1990 census, ages 18-24</p>
</dd>
<dt>pop</dt><dd><p>County population (1960 census)</p>
</dd>
<dt>sch1417</dt><dd><p>Percent attending school, ages 14-17 (1960 census)</p>
</dd>
<dt>sch534</dt><dd><p>Percent attending school, ages 5-34 (1960 census)</p>
</dd>
<dt>hs60</dt><dd><p>High school completion rate in 1960 census, ages 25+</p>
</dd>
<dt>pop1417</dt><dd><p>Population aged 14-17 (1960 census)</p>
</dd>
<dt>pop534</dt><dd><p>Population aged 5-34 (1960 census)</p>
</dd>
<dt>pop25</dt><dd><p>Population aged 25+ (1960 census)</p>
</dd>
<dt>urban</dt><dd><p>Percent urban (1960 census)</p>
</dd>
<dt>black</dt><dd><p>Percent black (1960 census)</p>
</dd>
<dt>statepc</dt><dd><p>State postal code</p>
</dd>
<dt>county</dt><dd><p>County name</p>
</dd>
</dl>



<h3>Source</h3>

<p>Douglas Miller's former website,
<a href="http://web.archive.org/web/20190619165949/http://faculty.econ.ucdavis.edu:80/faculty/dlmiller/statafiles/">http://web.archive.org/web/20190619165949/http://faculty.econ.ucdavis.edu:80/faculty/dlmiller/statafiles/</a>
</p>


<h3>References</h3>


<p><cite>Jens Ludwig and Douglas L. Miller. Does head start improve children's
life chances? Evidence from a regression discontinuity design.
Quarterly Journal of Economics, 122(1):159–208, February 2007.
<a href="https://doi.org/10.1162/qjec.122.1.159">doi:10.1162/qjec.122.1.159</a></cite>
</p>


<hr>
<h2 id='lee08'>Lee (2008) US House elections dataset</h2><span id='topic+lee08'></span>

<h3>Description</h3>

<p>Lee (2008) US House elections dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lee08
</code></pre>


<h3>Format</h3>

<p>A data frame with 6,558 rows and 2 variables:
</p>

<dl>
<dt>voteshare</dt><dd><p>Vote share in next election</p>
</dd>
<dt>margin</dt><dd><p>Democratic margin of victory</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mostly Harmless Econometrics data archive,
<a href="https://economics.mit.edu/people/faculty/josh-angrist/mhe-data-archive">https://economics.mit.edu/people/faculty/josh-angrist/mhe-data-archive</a>
</p>


<h3>References</h3>


<p><cite>David S. Lee. Randomized experiments from non-random selection in U.S.
House elections. Journal of Econometrics, 142(2):675–697, 2008.
<a href="https://doi.org/10.1016/j.jeconom.2007.05.004">doi:10.1016/j.jeconom.2007.05.004</a></cite>
</p>


<hr>
<h2 id='rcp'>Battistin, Brugiavini, Rettore, and Weber (2009) retirement consumption
puzzle dataset</h2><span id='topic+rcp'></span>

<h3>Description</h3>

<p>Battistin, Brugiavini, Rettore, and Weber (2009) retirement consumption
puzzle dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcp
</code></pre>


<h3>Format</h3>

<p>A data frame with 30,006 rows and 6 variables:
</p>

<dl>
<dt>survey_year</dt><dd><p>Survey year</p>
</dd>
<dt>elig_year</dt><dd><p>Years to/from eligibility (males)</p>
</dd>
<dt>retired</dt><dd><p>Retirement status (males)</p>
</dd>
<dt>food</dt><dd><p>Total household food expenditure</p>
</dd>
<dt>c</dt><dd><p>Total household consumption</p>
</dd>
<dt>cn</dt><dd><p>Total household expenditure on non-durable goods</p>
</dd>
</dl>



<h3>Source</h3>

<p>American Economic Review data archive, <a href="https://doi.org/10.1257/aer.99.5.2209">doi:10.1257/aer.99.5.2209</a>
</p>


<h3>References</h3>


<p><cite>Erich Battistin, Agar Brugiavini, Enrico Rettore, and Guglielmo Weber.
The retirement consumption puzzle: Evidence from a regression
discontinuity approach. American Economic Review, 99(5):2209–2226, 2009.
<a href="https://doi.org/10.1257/aer.99.5.2209">doi:10.1257/aer.99.5.2209</a></cite>
</p>


<hr>
<h2 id='RDHonest'>Honest inference in RD</h2><span id='topic+RDHonest'></span>

<h3>Description</h3>

<p>Calculate estimators and bias-aware CIs for the sharp or fuzzy RD parameter,
or for value of the conditional mean at a point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDHonest(
  formula,
  data,
  subset,
  weights,
  cutoff = 0,
  M,
  kern = "triangular",
  na.action,
  opt.criterion = "MSE",
  h,
  se.method = "nn",
  alpha = 0.05,
  beta = 0.8,
  J = 3,
  sclass = "H",
  T0 = 0,
  point.inference = FALSE,
  sigmaY2,
  sigmaD2,
  sigmaYD,
  clusterid
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDHonest_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code> (or one that can be
coerced to that class). The formula syntax is <code>outcome ~
running_variable</code> for inference at a point. For sharp RD, it is
<code>outcome ~ running_variable</code> if there are no covariates, or
<code>outcome ~ running_variable | covariates</code> if covariates are present.
For fuzzy RD, it is <code>outcome | treatment ~ running_variable |
covariates</code>, with <code>covariates</code> optional.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_data">data</code></td>
<td>
<p>optional data frame, list or environment (or object coercible by
<code>as.data.frame</code> to a data frame) containing the outcome and running
variables in the model. If not found in <code>data</code>, the variables are
taken from <code>environment(formula)</code>, typically the environment from
which the function is called.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_subset">subset</code></td>
<td>
<p>optional vector specifying a subset of observations to be used
in the fitting process.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_weights">weights</code></td>
<td>
<p>Optional vector of weights to weight the observations (useful
for aggregated data). The weights are interpreted as the number of
observations that each aggregated data point averages over. Disregarded
if optimal kernel is used.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_cutoff">cutoff</code></td>
<td>
<p>specifies the RD cutoff in the running variable. For inference
at a point, specifies the point <code class="reqn">x_0</code> at which to calculate the
conditional mean.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_m">M</code></td>
<td>
<p>Bound on second derivative of the conditional mean function, a
numeric vector of length one. For fuzzy RD, <code>M</code> needs to be a
numeric vector of length two, specifying the smoothness of the
conditional mean for the outcome and treatment, respectively.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_kern">kern</code></td>
<td>
<p>specifies the kernel function used in the local regression. It
can either be a string equal to <code>"triangular"</code>
(<code class="reqn">k(u)=(1-|u|)_{+}</code>), <code>"epanechnikov"</code>
(<code class="reqn">k(u)=(3/4)(1-u^2)_{+}</code>), or <code>"uniform"</code> (<code class="reqn">k(u)=
(|u|&lt;1)/2</code>), or else a kernel function. If equal to <code>"optimal"</code>, use
the finite-sample optimal linear estimator under Taylor smoothness class,
instead of a local linear estimator.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_na.action">na.action</code></td>
<td>
<p>function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code> (usually <code>na.omit</code>). Another possible value is
<code>na.fail</code></p>
</td></tr>
<tr><td><code id="RDHonest_+3A_opt.criterion">opt.criterion</code></td>
<td>
<p>Optimality criterion that the bandwidth is designed to
optimize. The options are:
</p>

<dl>
<dt><code>"MSE"</code></dt><dd><p>Finite-sample maximum MSE</p>
</dd>
<dt><code>"FLCI"</code></dt><dd><p>Length of (fixed-length) two-sided
confidence intervals.</p>
</dd>
<dt><code>"OCI"</code></dt><dd><p>Given quantile of excess length of one-sided
confidence intervals</p>
</dd>
</dl>

<p>The methods use conditional variance given by <code>sigmaY2</code>, if
supplied. For fuzzy RD, <code>sigmaD2</code> and <code>sigmaYD</code> also need to be
supplied in this case. Otherwise, the methods use preliminary variance
estimates based on assuming homoskedasticity on either side of the
cutoff.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_h">h</code></td>
<td>
<p>bandwidth, a scalar parameter. If not supplied, optimal bandwidth is
computed according to criterion given by <code>opt.criterion</code>.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_se.method">se.method</code></td>
<td>
<p>method for estimating standard error of the estimate, one
of:
</p>

<dl>
<dt>&quot;nn&quot;</dt><dd><p>Nearest neighbor method</p>
</dd>
<dt>&quot;EHW&quot;</dt><dd><p>Eicker-Huber-White, with residuals from local regression
(local polynomial estimators only).</p>
</dd>
<dt>&quot;supplied.var&quot;</dt><dd><p>Use conditional variance supplied by <code>sigmaY2</code>
instead of computing residuals. For fuzzy RD, <code>sigmaD2</code> and
<code>sigmaYD</code> also need to be supplied in this case.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="RDHonest_+3A_alpha">alpha</code></td>
<td>
<p>determines confidence level, <code>1-alpha</code> for
constructing/optimizing confidence intervals.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_beta">beta</code></td>
<td>
<p>Determines quantile of excess length to optimize, if bandwidth
optimizes given quantile of excess length of one-sided confidence
intervals (<code>opt.criterion="OCI"</code>); otherwise ignored.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_j">J</code></td>
<td>
<p>Number of nearest neighbors, if <code>se.method="nn"</code> is specified.
Otherwise ignored.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_sclass">sclass</code></td>
<td>
<p>Smoothness class, either <code>"T"</code> for Taylor or <code>"H"</code>
for Hölder class.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_t0">T0</code></td>
<td>
<p>Initial estimate of the treatment effect for calculating the
optimal bandwidth. Only relevant for fuzzy RD.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_point.inference">point.inference</code></td>
<td>
<p>Do inference at a point determined by <code>cutoff</code>
instead of RD.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_sigmay2">sigmaY2</code></td>
<td>
<p>Supply variance of outcome. Ignored when kernel is optimal.</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_sigmad2">sigmaD2</code></td>
<td>
<p>Supply variance of treatment (fuzzy RD only).</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_sigmayd">sigmaYD</code></td>
<td>
<p>Supply covariance of treatment and outcome (fuzzy RD only).</p>
</td></tr>
<tr><td><code id="RDHonest_+3A_clusterid">clusterid</code></td>
<td>
<p>Vector specifying cluster membership. If supplied,
<code>se.method="EHW"</code> is required, and standard errors use
cluster-robust variance formulas.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bandwidth is calculated to be optimal for a given performance criterion,
as specified by <code>opt.criterion</code>. Alternatively, for local polynomial
estimators, the bandwidth can be specified by <code>h</code>. For
<code>kern="optimal"</code>, calculate optimal estimators under second-order Taylor
smoothness class (sharp RD only).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"RDResults"</code>. The function
<code>print</code> can be used to obtain and print a summary of the results. An
object of class <code>"RDResults"</code> is a list containing four components.
First, a data frame <code>"coefficients"</code> containing the following
columns:
</p>

<dl>
<dt><code>term</code></dt><dd><p>type of parameter being estimated</p>
</dd>
<dt><code>estimate</code></dt><dd><p>point estimate</p>
</dd>
<dt><code>std.error</code></dt><dd><p>standard error of <code>estimate</code></p>
</dd>
<dt><code>maximum.bias</code></dt><dd><p>maximum bias of <code>estimate</code></p>
</dd>
<dt><code>conf.low</code>, <code>conf.high</code></dt><dd><p>lower (upper) end-point of a
two-sided CI based on <code>estimate</code></p>
</dd>
<dt><code>conf.low.onesided</code>, <code>conf.high.onesided</code></dt><dd><p>lower (upper)
end-point of a one-sided CIs based on <code>estimate</code></p>
</dd>
<dt><code>bandwidth</code></dt><dd><p>bandwidth used. If <code>kern="optimal"</code>, the
smoothing parameters <code>bandwidth.m</code> and <code>bandwidth.p</code> on
either side of the cutoff are reported instead</p>
</dd>
<dt><code>eff.obs</code></dt><dd><p>number of effective observations</p>
</dd>
<dt><code>leverage</code></dt><dd><p>maximal leverage of <code>estimate</code></p>
</dd>
<dt><code>cv</code></dt><dd><p>critical value used to compute two-sided CIs</p>
</dd>
<dt><code>alpha</code></dt><dd><p>coverage level, as specified by option <code>alpha</code></p>
</dd>
<dt><code>method</code></dt><dd><p><code>sclass</code> is used</p>
</dd>
<dt><code>M</code></dt><dd><p>curvature bound used for worst-case bias
calculations. For fuzzy RD, equals
<code>(abs(estimate)*M.fs+M.rf)/first.stage</code></p>
</dd>
<dt><code>M.rf</code>, <code>M.fs</code></dt><dd><p>curvature bound for the outcome (i.e.
reduced-form) and first-stage regressions. Fuzzy RD only.</p>
</dd>
<dt><code>first.stage</code></dt><dd><p>estimate of the first-stage coefficient.
Fuzzy RD only.</p>
</dd>
<dt><code>kernel</code></dt><dd><p>kernel used</p>
</dd>
<dt><code>p.value</code></dt><dd><p>p-value for testing the null of no effect</p>
</dd>
</dl>

<p>Second, a list called <code>"data"</code> containing the data used for
estimation. This is useful mostly for internal calculations. Third, an
object of class <code>"lm"</code> containing the local linear regression
estimates. Finally, a <code>call</code> object containing the matched call
called <code>"call"</code>.
</p>
<p>If <code>kern="optimal"</code>, the <code>"lm"</code> object is empty, and the
numeric vectors <code>"delta"</code> and <code>"omega"</code> are returned in
addition. These correspond to the parameters in the modulus problem used
to compute the optimal estimation weights.
</p>


<h3>Note</h3>

<p><code>subset</code> is evaluated in the same way as variables in <code>formula</code>,
that is first in <code>data</code> and then in the environment of <code>formula</code>.
</p>


<h3>References</h3>


<p><cite>Timothy B. Armstrong and Michal Kolesár. Optimal inference in a class
of regression models. Econometrica, 86(2):655–683, March 2018.
<a href="https://doi.org/10.3982/ECTA14434">doi:10.3982/ECTA14434</a></cite>
</p>
<p><cite>Timothy B. Armstrong and Michal Kolesár. Simple and honest confidence
intervals in nonparametric regression. Quantitative Economics, 11(1):1–39,
January 2020.</cite>
</p>
<p><cite>Michal Kolesár and Christoph Rothe. Inference in regression
discontinuity designs with a discrete running variable. American Economic
Review, 108(8):2277—-2304, August 2018. <a href="https://doi.org/10.1257/aer.20160945">doi:10.1257/aer.20160945</a></cite>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>RDHonest(voteshare ~ margin, data = lee08, kern = "uniform", M = 0.1, h = 10)
RDHonest(cn | retired ~ elig_year, data=rcp, cutoff=0, M=c(4, 0.4),
          kern="triangular", opt.criterion="MSE", T0=0, h=3)
RDHonest(voteshare ~ margin, data = lee08, subset = margin&gt;0,
          kern = "uniform", M = 0.1, h = 10, point.inference=TRUE)
</code></pre>

<hr>
<h2 id='RDHonestBME'>Honest CIs in sharp RD with discrete regressors under BME function class</h2><span id='topic+RDHonestBME'></span>

<h3>Description</h3>

<p>Computes honest CIs for local polynomial regression with uniform kernel in
sharp RD under the assumption that the conditional mean lies in the bounded
misspecification error (BME) class of functions, as considered in Kolesár and
Rothe (2018). This class formalizes the notion that the fit of the chosen
model is no worse at the cutoff than elsewhere in the estimation window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDHonestBME(
  formula,
  data,
  subset,
  cutoff = 0,
  na.action,
  h = Inf,
  alpha = 0.05,
  order = 0,
  regformula
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDHonestBME_+3A_formula">formula</code></td>
<td>
<p>object of class <code>"formula"</code> (or one that can be coerced
to that class) of the form <code>outcome ~ running_variable</code></p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_data">data</code></td>
<td>
<p>optional data frame, list or environment (or object coercible by
<code>as.data.frame</code> to a data frame) containing the outcome and running
variables in the model. If not found in <code>data</code>, the variables are
taken from <code>environment(formula)</code>, typically the environment from
which the function is called.</p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_subset">subset</code></td>
<td>
<p>optional vector specifying a subset of observations to be used
in the fitting process.</p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_cutoff">cutoff</code></td>
<td>
<p>specifies the RD cutoff in the running variable.</p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_na.action">na.action</code></td>
<td>
<p>function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code> (usually <code>na.omit</code>). Another possible value is
<code>na.fail</code></p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_h">h</code></td>
<td>
<p>bandwidth, a scalar parameter.</p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_alpha">alpha</code></td>
<td>
<p>determines confidence level, <code class="reqn">1-\alpha</code></p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_order">order</code></td>
<td>
<p>Order of local regression <code>1</code> for linear, <code>2</code> for
quadratic, etc.</p>
</td></tr>
<tr><td><code id="RDHonestBME_+3A_regformula">regformula</code></td>
<td>
<p>Explicitly specify regression formula to use instead of
running a local polynomial regression, with <code>y</code> and <code>x</code>
denoting the outcome and the running variable, and cutoff is normalized
to <code>0</code>. Local linear regression (<code>order = 1</code>) is equivalent to
<code>regformula = "y~x*I(x&gt;0)"</code>. Inference is done on the
<code>order+2</code>th element of the design matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"RDResults"</code>. This is a list with at least
the following elements:
</p>

<dl>
<dt><code>"coefficients"</code></dt><dd><p>Data frame containing estimation results,
including point estimate, one- and two-sided confidence intervals, a bound
on worst-case bias, bandwidth used, and the number of effective
observations.</p>
</dd>
<dt><code>"call"</code></dt><dd><p>The matched call.</p>
</dd>
<dt><code>"lm"</code></dt><dd><p>An <code>"lm"</code> object containing the fitted
regression.</p>
</dd>
<dt><code>"na.action"</code></dt><dd><p>(If relevant) information on the special
handling of <code>NA</code>s.</p>
</dd>
</dl>



<h3>Note</h3>

<p><code>subset</code> is evaluated in the same way as variables in <code>formula</code>,
that is first in <code>data</code> and then in the environment of <code>formula</code>.
</p>


<h3>References</h3>


<p><cite>Michal Kolesár and Christoph Rothe. Inference in regression
discontinuity designs with a discrete running variable. American
Economic Review, 108(8):2277—-2304, August 2018.
<a href="https://doi.org/10.1257/aer.20160945">doi:10.1257/aer.20160945</a></cite>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>RDHonestBME(log(earnings)~yearat14, data=cghs, h=3,
            order=1, cutoff=1947)
## Equivalent to
RDHonestBME(log(earnings)~yearat14, data=cghs, h=3,
            cutoff=1947, order=1, regformula="y~x*I(x&gt;=0)")
</code></pre>

<hr>
<h2 id='RDScatter'>Scatterplot of binned raw observations</h2><span id='topic+RDScatter'></span>

<h3>Description</h3>

<p>Scatterplot of raw observations in which each point corresponds to an binned
average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDScatter(
  formula,
  data,
  subset,
  cutoff = 0,
  na.action,
  avg = 10,
  xlab = NULL,
  ylab = NULL,
  vert = TRUE,
  propdotsize = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDScatter_+3A_formula">formula</code></td>
<td>
<p>object of class <code>"formula"</code> (or one that can be coerced
to that class) of the form <code>outcome ~ running_variable</code></p>
</td></tr>
<tr><td><code id="RDScatter_+3A_data">data</code></td>
<td>
<p>optional data frame, list or environment (or object coercible by
<code>as.data.frame</code> to a data frame) containing the outcome and running
variables in the model. If not found in <code>data</code>, the variables are
taken from <code>environment(formula)</code>, typically the environment from
which the function is called.</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_subset">subset</code></td>
<td>
<p>optional vector specifying a subset of observations to be used
in the fitting process.</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_cutoff">cutoff</code></td>
<td>
<p>specifies the RD cutoff for the running variable.</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_na.action">na.action</code></td>
<td>
<p>function which indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> setting of
<code>options</code> (usually <code>na.omit</code>). Another possible value is
<code>na.fail</code></p>
</td></tr>
<tr><td><code id="RDScatter_+3A_avg">avg</code></td>
<td>
<p>Number of observations to average over. If set to <code>Inf</code>, then
take averages for each possible value of the running variable (convenient
when the running variable is discrete).</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_xlab">xlab</code>, <code id="RDScatter_+3A_ylab">ylab</code></td>
<td>
<p>x- and y-axis labels</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_vert">vert</code></td>
<td>
<p>Draw a vertical line at cutoff?</p>
</td></tr>
<tr><td><code id="RDScatter_+3A_propdotsize">propdotsize</code></td>
<td>
<p>If <code>TRUE</code>, then size of points is proportional to
number of observations that the point averages over (useful when
<code>avg=Inf</code>). Otherwise the size of points is constant.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"ggplot"</code>, a scatterplot the binned raw
observations.
</p>


<h3>Note</h3>

<p><code>subset</code> is evaluated in the same way as variables in <code>formula</code>,
that is first in <code>data</code> and then in the environment of <code>formula</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDScatter(log(earnings)~yearat14, data=cghs, cutoff=1947,
               avg=Inf, propdotsize=TRUE)
</code></pre>

<hr>
<h2 id='RDSmoothnessBound'>Lower bound on smoothness constant M in sharp RD designs</h2><span id='topic+RDSmoothnessBound'></span>

<h3>Description</h3>

<p>Estimate a lower bound on the smoothness constant M and provide a lower
confidence interval for it, using method described in supplement to
Kolesár and Rothe (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDSmoothnessBound(
  object,
  s,
  separate = FALSE,
  multiple = TRUE,
  alpha = 0.05,
  sclass = "H"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDSmoothnessBound_+3A_object">object</code></td>
<td>
<p>An object of class <code>"RDResults"</code>, typically a result of a
call to <code><a href="#topic+RDHonest">RDHonest</a></code>.</p>
</td></tr>
<tr><td><code id="RDSmoothnessBound_+3A_s">s</code></td>
<td>
<p>Number of support points that curvature estimates should average
over.</p>
</td></tr>
<tr><td><code id="RDSmoothnessBound_+3A_separate">separate</code></td>
<td>
<p>If <code>TRUE</code>, report estimates separately for data above
and below cutoff. If <code>FALSE</code>, report pooled estimates.</p>
</td></tr>
<tr><td><code id="RDSmoothnessBound_+3A_multiple">multiple</code></td>
<td>
<p>If <code>TRUE</code>, use multiple curvature estimates. If
<code>FALSE</code>, only use a single curvature estimate using observations
closest to the cutoff.</p>
</td></tr>
<tr><td><code id="RDSmoothnessBound_+3A_alpha">alpha</code></td>
<td>
<p>determines confidence level <code>1-alpha</code>.</p>
</td></tr>
<tr><td><code id="RDSmoothnessBound_+3A_sclass">sclass</code></td>
<td>
<p>Smoothness class, either <code>"T"</code> for Taylor or <code>"H"</code>
for Hölder class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame wit the following columns:
</p>

<dl>
<dt><code>estimate</code></dt><dd><p>Point estimate for lower bounds for M. </p>
</dd>
<dt><code>conf.low</code></dt><dd><p>Lower endpoint for a one-sided confidence interval
for M</p>
</dd>
</dl>

<p>The data frame has a single row if <code>separate==FALSE</code>; otherwise it has
two rows, corresponding to smoothness bound estimates and confidence
intervals below and above the cutoff, respectively.
</p>


<h3>References</h3>


<p><cite>Michal Kolesár and Christoph Rothe. Inference in regression
discontinuity designs with a discrete running variable.
American Economic Review, 108(8):2277—-2304,
August 2018. <a href="https://doi.org/10.1257/aer.20160945">doi:10.1257/aer.20160945</a></cite>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## Subset data to increase speed
r &lt;- RDHonest(log(earnings)~yearat14, data=cghs,
              subset=abs(yearat14-1947)&lt;10,
              cutoff=1947, M=0.04, h=3)
RDSmoothnessBound(r, s=2)
</code></pre>

<hr>
<h2 id='RDTEfficiencyBound'>Finite-sample efficiency bounds for minimax CIs</h2><span id='topic+RDTEfficiencyBound'></span>

<h3>Description</h3>

<p>Compute efficiency of minimax one-sided CIs at constant functions, or
efficiency of two-sided fixed-length CIs at constant functions under
second-order Taylor smoothness class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDTEfficiencyBound(object, opt.criterion = "FLCI", beta = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RDTEfficiencyBound_+3A_object">object</code></td>
<td>
<p>An object of class <code>"RDResults"</code>, typically a result of a
call to <code><a href="#topic+RDHonest">RDHonest</a></code>.</p>
</td></tr>
<tr><td><code id="RDTEfficiencyBound_+3A_opt.criterion">opt.criterion</code></td>
<td>
<p>Either <code>"FLCI"</code> for computing efficiency of
two-sided CIs, or else <code>"OCI"</code> for minimax one-sided CIs.</p>
</td></tr>
<tr><td><code id="RDTEfficiencyBound_+3A_beta">beta</code></td>
<td>
<p>Determines quantile of excess length for evaluating minimax
efficiency of one-sided CIs. Ignored if <code>opt.criterion=="FLCI"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Efficiency bound, a numeric vector of length one.
</p>


<h3>References</h3>


<p><cite>Timothy B. Armstrong and Michal Kolesár. Optimal inference in a class
of regression models. Econometrica, 86(2):655–683, March 2018.
<a href="https://doi.org/10.3982/ECTA14434">doi:10.3982/ECTA14434</a></cite>
</p>



<h3>Examples</h3>

<pre><code class='language-R'>r &lt;- RDHonest(voteshare ~ margin, data=lee08,
              subset=abs(margin)&lt;10, M=0.1, h=2)
RDTEfficiencyBound(r, opt.criterion="OCI")
</code></pre>

<hr>
<h2 id='rebp'>Austrian unemployment duration data from Lalive (2008)</h2><span id='topic+rebp'></span>

<h3>Description</h3>

<p>Subset of Lalive (2008) data for individuals in the regions affected by the
REBP program
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rebp
</code></pre>


<h3>Format</h3>

<p>A data frame with 29,371 rows and 4 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age in years, at monthly accuracy</p>
</dd>
<dt>period</dt><dd><p>Indicator for whether REBP is in place</p>
</dd>
<dt>female</dt><dd><p>Indicator for female</p>
</dd>
<dt>duration</dt><dd><p>unemployment duration in weeks</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rafael Lalive's website,
<a href="https://sites.google.com/site/rafaellalive/">https://sites.google.com/site/rafaellalive/</a>
</p>


<h3>References</h3>


<p><cite>Rafael Lalive. How do extended benefits affect unemployment duration? A
regression discontinuity approach. Journal of Econometrics,
142(2):785–806, February 2008. <a href="https://doi.org/10.1016/j.jeconom.2007.05.013">doi:10.1016/j.jeconom.2007.05.013</a></cite>
</p>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
