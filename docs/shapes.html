<!DOCTYPE html><html><head><title>Help for package shapes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shapes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apes'><p>Great ape data</p></a></li>
<li><a href='#backfit'><p>Backfit from scores to configuration</p></a></li>
<li><a href='#bookstein2d'><p>Bookstein's baseline registration for 2D data</p></a></li>
<li><a href='#brains'><p>Brain landmark data</p></a></li>
<li><a href='#centroid.size'><p>Centroid size</p></a></li>
<li><a href='#cortical'><p>Cortical surface data</p></a></li>
<li><a href='#digit3.dat'><p>Digit 3 data</p></a></li>
<li><a href='#distcov'><p>Compute a distance between two covariance matrices</p></a></li>
<li><a href='#dna.dat'><p>DNA data</p></a></li>
<li><a href='#estcov'><p>Weighted Frechet mean of covariance matrices</p></a></li>
<li><a href='#frechet'><p>Mean shape estimators</p></a></li>
<li><a href='#gels'><p>Electrophoresis gel data</p></a></li>
<li><a href='#gorf.dat'><p>Female gorilla data</p></a></li>
<li><a href='#gorm.dat'><p>Male gorilla data</p></a></li>
<li><a href='#groupstack'><p>Combine two or more groups of configurations</p></a></li>
<li><a href='#humanmove'><p>Human movement data</p></a></li>
<li><a href='#macaques'><p>Male and Female macaque data</p></a></li>
<li><a href='#macf.dat'><p>Female macaque data</p></a></li>
<li><a href='#macm.dat'><p>Male macaque data</p></a></li>
<li><a href='#mice'><p>T2 mouse vertabrae data</p></a></li>
<li><a href='#panf.dat'><p>Female chimpanzee data</p></a></li>
<li><a href='#panm.dat'><p>Male chimpanzee data</p></a></li>
<li><a href='#plot3darcs'><p>Modes of variation plots for PCA and PNSS</p></a></li>
<li><a href='#plotshapes'><p>Plot configurations</p></a></li>
<li><a href='#pns'><p>Principal Nested Spheres</p></a></li>
<li><a href='#pns4pc'><p>Principal Nested Shape Spaces from PCA</p></a></li>
<li><a href='#pnss3d'><p>Principal Nested Shape Space Analysis</p></a></li>
<li><a href='#pongof.dat'><p>Female orang utan data</p></a></li>
<li><a href='#pongom.dat'><p>Male orang utan data</p></a></li>
<li><a href='#procdist'><p>Procrustes distance</p></a></li>
<li><a href='#procGPA'><p>Generalised Procrustes analysis</p></a></li>
<li><a href='#procOPA'><p>Ordinary Procrustes analysis</p></a></li>
<li><a href='#procWGPA'><p>Weighted Procrustes analysis</p></a></li>
<li><a href='#qcet2.dat'><p>Control T2 mouse vertabrae data</p></a></li>
<li><a href='#qlet2.dat'><p>Large T2 mouse vertabrae data</p></a></li>
<li><a href='#qset2.dat'><p>Small T2 mouse vertabrae data</p></a></li>
<li><a href='#rats'><p>Rat skulls data</p></a></li>
<li><a href='#resampletest'><p>Tests for mean shape difference using complex arithmetic, including bootstrap and permutation tests.</p></a></li>
<li><a href='#riemdist'><p>Riemannian shape distance</p></a></li>
<li><a href='#rigidbody'><p>Rigid body transformations</p></a></li>
<li><a href='#sand'><p>Sand particle outline data</p></a></li>
<li><a href='#schizophrenia'><p>Bookstein's schizophrenia data</p></a></li>
<li><a href='#schizophrenia.dat'><p>Bookstein's schizophrenia data</p></a></li>
<li><a href='#shapepca'><p>Principal components analysis for shape</p></a></li>
<li><a href='#shapes-internal'><p>Internal function(s)</p></a></li>
<li><a href='#shapes.cva'><p>Canonical variate analysis for shapes</p></a></li>
<li><a href='#shapes3d'><p>Plot 3D data</p></a></li>
<li><a href='#shells'><p>Microfossil shell data</p></a></li>
<li><a href='#sooty'><p>Sooty mangabey data</p></a></li>
<li><a href='#ssriemdist'><p>Riemannian size-and-shape distance</p></a></li>
<li><a href='#steroids'><p>Steroid data</p></a></li>
<li><a href='#testmeanshapes'><p>Tests for mean shape difference, including permutation and bootstrap tests</p></a></li>
<li><a href='#tpsgrid'><p>Thin-plate spline transformation grids</p></a></li>
<li><a href='#transformations'><p>Calculate similarity transformations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Statistical Shape Analysis</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-03</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.7</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian L. Dryden</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for the statistical analysis of landmark 
  shapes, including Procrustes analysis, graphical displays, principal
  components analysis, permutation and bootstrap tests, thin-plate 
  spline transformation grids and comparing covariance matrices. 
     See Dryden, I.L. and Mardia, K.V. (2016). Statistical shape analysis, 
     with Applications in R (2nd Edition), John Wiley and Sons. </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian Dryden   &lt;ian.dryden@nottingham.ac.uk&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>minpack.lm, scatterplot3d, rgl, MASS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.maths.nottingham.ac.uk/~ild/shapes">http://www.maths.nottingham.ac.uk/~ild/shapes</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-03 15:45:05 UTC; pmzild</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-03 21:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='apes'>Great ape data</h2><span id='topic+apes'></span>

<h3>Description</h3>

<p>Great ape skull landmark data. 8 landmarks 
in 2 dimensions, 167 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(apes)</code></pre>


<h3>Format</h3>

<p>apes$x :  An array of dimension 8 x 2 x 167
</p>
<p>apes$group :  Species and sex of each specimen: 
&quot;gorf&quot; 30 female gorillas,
&quot;gorm&quot; 29 male gorillas,
&quot;panf&quot; 26 female chimpanzees,
&quot;pamm&quot; 28 male chimpanzees,
&quot;pongof&quot; 24 female orang utans,
&quot;pongom&quot; 30 male orang utans.
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. 
</p>
<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apes)
par(mfrow=c(1,2))
plotshapes(apes$x[,,apes$group=="gorf"],symbol="f")
plotshapes(apes$x[,,apes$group=="gorm"],symbol="m")
</code></pre>

<hr>
<h2 id='backfit'>Backfit from scores to configuration</h2><span id='topic+backfit'></span>

<h3>Description</h3>

<p>Backfit from PNSS or PCA scores to a representative configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backfit(scores, x, type="pnss", size=1) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backfit_+3A_scores">scores</code></td>
<td>
<p>n x p matrix of scores</p>
</td></tr>
<tr><td><code id="backfit_+3A_x">x</code></td>
<td>

<p>An object that is the output of either pnss3d (if type=&quot;pnss&quot;) or procGPA (if type=&quot;pca&quot;)
</p>
</td></tr> 
<tr><td><code id="backfit_+3A_type">type</code></td>
<td>
 
<p>Either &quot;pnss&quot; for PNSS or &quot;pca&quot; for PCA 
</p>
</td></tr>
<tr><td><code id="backfit_+3A_size">size</code></td>
<td>

<p>The centroid size of the backfitted configuration. The default is 1 but one can rescale the backfitting if desired. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A k x m matrix of co-ordinates of the backfitted configuration
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L., Kim, K., Laughton, C.A. and Le, H. (2019). Principal nested shape 
space analysis of molecular dynamics data. Annals of Applied Statistics, 13, 2213-2234.
</p>
<p>Jung, S., Dryden, I.L. and Marron, J.S. (2012). Analysis of principal nested spheres. 
Biometrika, 99, 551-568.
</p>


<h3>See Also</h3>

<p>pns, pns4pc, plot3darcs</p>


<h3>Examples</h3>

<pre><code class='language-R'>ans &lt;- pnss3d( macf.dat, sphere.type="BIC", n.pc=8)
y &lt;- backfit( ans$PNS$scores[1,] , ans ,type="pnss")
riemdist( macf.dat[,,1] , y )  #should be close to zero

ans2 &lt;- procGPA( macf.dat, tangentcoords="partial")
y &lt;- backfit( ans2$scores[1,] , ans2 ,type="pca")
riemdist( macf.dat[,,1] , y )  #should be close to zero
</code></pre>

<hr>
<h2 id='bookstein2d'>Bookstein's baseline registration for 2D data</h2><span id='topic+bookstein2d'></span>

<h3>Description</h3>

<p>Carries out Bookstein's baseline registration and calculates a mean shape</p>


<h3>Usage</h3>

<pre><code class='language-R'>bookstein2d(A,l1=1,l2=2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bookstein2d_+3A_a">A</code></td>
<td>
<p>a k x 2 x n real array, or k x n complex matrix, where  k is
the number of landmarks, n is the number of observations</p>
</td></tr>
<tr><td><code id="bookstein2d_+3A_l1">l1</code></td>
<td>
<p>l1: an integer : l1 is sent to (-1/2,0) in the registration</p>
</td></tr>
<tr><td><code id="bookstein2d_+3A_l2">l2</code></td>
<td>
<p>l2: an integer : l2 is sent to (1/2,0) in the registration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>k</code></td>
<td>
<p>number of landmarks</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>mshape</code></td>
<td>
<p>Bookstein mean shape with baseline l1, l2</p>
</td></tr>
<tr><td><code>bshpv</code></td>
<td>
<p>the k x n x 2 array of Bookstein shape variables, including the baseline</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. Chapter 2.
</p>
<p>Bookstein, F. L. (1986) Size and shape spaces for landmark data in
two dimensions  (with discussion). Statistical Science, 1:181-242.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     data(gorf.dat)
     data(gorm.dat)

     bookf&lt;-bookstein2d(gorf.dat)
     bookm&lt;-bookstein2d(gorm.dat)

     plotshapes(bookf$mshape,bookm$mshape,joinline=c(1,6,7,8,2,3,4,5,1))
</code></pre>

<hr>
<h2 id='brains'>Brain landmark data</h2><span id='topic+brains'></span>

<h3>Description</h3>

<p>24 landmarks located in 58 adult healthy brains</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(brains)</code></pre>


<h3>Format</h3>

<p>A list with components: 
</p>
<p>brains$x  :  An array of dimension 24 x 3 x 58  containing the landmarks in 3D
</p>
<p>brains$sex : Sex of each volunteer (m or f)
</p>
<p>brains$age : Age of each volunteer
</p>
<p>brains$handed : Handedness of each volunteer (r or l)
</p>
<p>brains$grp : group label: 1= right-handed males, 2=left-handed males, 3=right-handed females, 
4=left-handed females
</p>


<h3>References</h3>

<p>Free, S.L., O'Higgins, P., Maudgil, D.D., Dryden, I.L., Lemieux, L., Fish, D.R. and Shorvon, S.D. (2001). Landmark-based morphometrics of the normal adult brain using MRI.  Neuroimage  ,  13  , 801&ndash;813.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(brains)
# plot first three brains
shapes3d(brains$x[,,1:3])
</code></pre>

<hr>
<h2 id='centroid.size'>Centroid size</h2><span id='topic+centroid.size'></span>

<h3>Description</h3>

<p>Calculate cetroid size from a configuration 
or a sample of configurations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centroid.size(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centroid.size_+3A_x">x</code></td>
<td>
<p>For a single configuration  k x m matrix or complex k-vector
</p>
<p>For a sample of configurations k x m x n array or k x n complex matrix
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Centroid size(s)
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mice)
centroid.size(mice$x[,,1])
</code></pre>

<hr>
<h2 id='cortical'>Cortical surface data</h2><span id='topic+cortical'></span>

<h3>Description</h3>

<p>Cortical surface data, from MR scans. Axial slice outlines with 
500 points on each outline. 68 individuals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cortical)</code></pre>


<h3>Format</h3>

<p>cortical$age   ( age)
cortical$group ( Control, Schizophrenia)
cortical$sex   ( 1 = male, 2 = female)
cortical$symm  ( a symmetry measure 
from the original 3D cortical surface )
</p>
<p>cortical$x     (500 x , y  coordinates of an axial slice through the
cortical surface intersecting the anterior and posterior 
commissures)
</p>
<p>cortical$r     (500 radii from equal angular polar coordinates )
</p>


<h3>Source</h3>

<p>Brignell, C.J., Dryden, I.L., Gattone, S.A., Park, B., Leask, S., Browne, W.J. and Flynn, S. (2010).
Surface shape analysis, with an application to brain surface asymmetry in schizophrenia. Biostatistics,
11, 609-630.
</p>
<p>Dryden, I.L. (2005). Statistical analysis on high-dimensional spheres and shape spaces. Annals of Statistics,
33, 1643-1665
</p>


<h3>References</h3>

<p>Original MR data from Sean Flynn (UBC) in collaboration with Bert Park (Nottingham). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cortical)
plotshapes(cortical$x)
</code></pre>

<hr>
<h2 id='digit3.dat'>Digit 3 data</h2><span id='topic+digit3.dat'></span>

<h3>Description</h3>

<p>Handwritten digit &lsquo;3&rsquo; data. 13 landmarks 
in 2 dimensions, 30 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(digit3.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 13 x 2 x 30
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/digit3.dat
</p>
<p>Data from Cath Anderson
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(digit3.dat)
k&lt;-dim(digit3.dat)[1]
n&lt;-dim(digit3.dat)[3]
plotshapes(digit3.dat,joinline=c(1:13))
</code></pre>

<hr>
<h2 id='distcov'>Compute a distance between two covariance matrices</h2><span id='topic+distcov'></span>

<h3>Description</h3>

<p>Compute a distance between two covariance matrices, 
with non-Euclidean options. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distcov(S1, S2, method="Riemannian",alpha=1/2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distcov_+3A_s1">S1</code></td>
<td>
<p>Input a covariance matrix (square, symmetric, positive definite)</p>
</td></tr>
<tr><td><code id="distcov_+3A_s2">S2</code></td>
<td>
<p>Input another covariance matrix of the same size </p>
</td></tr>
<tr><td><code id="distcov_+3A_method">method</code></td>
<td>
<p>The type of distance to be used: 
&quot;Procrustes&quot;: Procrustes size-and-shape metric, 
&quot;ProcrustesShape&quot;: Procrustes metric with scaling, 
&quot;Riemannian&quot;: Riemannian metric, 
&quot;Cholesky&quot;: Cholesky based distance, 
&quot;Power: Power Euclidean, with power alpha, 
&quot;Euclidean&quot;: Euclidean metric, 
&quot;LogEuclidean&quot;: Log-Euclidean metric, 
&quot;RiemannianLe&quot;: Another Riemannian metric.</p>
</td></tr>
<tr><td><code id="distcov_+3A_alpha">alpha</code></td>
<td>
<p>The power to be used in the power Euclidean metric 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The distance                        
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L., Koloydenko, A. and Zhou, D. (2009). Non-Euclidean statistics for covariance matrices,
with applications to diffusion tensor imaging. Annals of Applied Statistics, 3, 1102-1123.</p>


<h3>See Also</h3>

<p>estcov</p>


<h3>Examples</h3>

<pre><code class='language-R'>

A &lt;- diag(5)
B &lt;- A + .1*matrix(rnorm(25),5,5) 
S1&lt;-A
S2&lt;- B

distcov( S1, S2, method="Procrustes")

</code></pre>

<hr>
<h2 id='dna.dat'>DNA data</h2><span id='topic+dna.dat'></span>

<h3>Description</h3>

<p>Part of a 3D DNA molecule moving in time, k = 22 atoms, 30 time points</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dna.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 22 x 3 x 30
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dna.dat)
plotshapestime3d(dna.dat)
</code></pre>

<hr>
<h2 id='estcov'>Weighted Frechet mean of covariance matrices</h2><span id='topic+estcov'></span>

<h3>Description</h3>

<p>Computes the weighted Frechet means of an array of covariance 
matrices, with different options for the covariance metric. Also carries 
out principal co-ordinate analysis of the covariance matrices</p>


<h3>Usage</h3>

<pre><code class='language-R'>estcov(S , method="Riemannian",weights=1,alpha=1/2,MDSk=2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estcov_+3A_s">S</code></td>
<td>
<p>Input an array of covariance matrices of size k x k x n 
where each matrix is square, symmetric and positive definite</p>
</td></tr>
<tr><td><code id="estcov_+3A_method">method</code></td>
<td>
<p>The type of distance to be used: 
&quot;Procrustes&quot;: Procrustes size-and-shape metric, 
&quot;ProcrustesShape&quot;: Procrustes metric with scaling, 
&quot;Riemannian&quot;: Riemannian metric, 
&quot;Cholesky&quot;: Cholesky based distance, 
&quot;Power: Power Euclidean, with power alpha, 
&quot;Euclidean&quot;: Euclidean metric, 
&quot;LogEuclidean&quot;: Log-Euclidean metric, 
&quot;RiemannianLe&quot;: Another Riemannian metric. </p>
</td></tr>
<tr><td><code id="estcov_+3A_weights">weights</code></td>
<td>
<p>The weights to be used for calculating the mean. 
If weights=1 then equal weights are used, otherwise the vector 
must be of length n.</p>
</td></tr>
<tr><td><code id="estcov_+3A_alpha">alpha</code></td>
<td>
<p>The power to be used in the power Euclidean metric</p>
</td></tr>
<tr><td><code id="estcov_+3A_mdsk">MDSk</code></td>
<td>
<p>The number of MDS components in the principal co-ordinate analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with values
</p>
<table>
<tr><td><code>mean</code></td>
<td>
<p>The weighted mean covariance matrix</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The weighted standard deviation</p>
</td></tr>
<tr><td><code>pco</code></td>
<td>
<p>Principal co-ordinates (from multidimensional scaling with the metric)</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>The eigenvalues from the principal co-ordinate analysis</p>
</td></tr>                  
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L., Koloydenko, A. and Zhou, D. (2009). Non-Euclidean statistics for covariance matrices,
with applications to diffusion tensor imaging. Annals of Applied Statistics, 3, 1102-1123.</p>


<h3>See Also</h3>

<p>distcov</p>


<h3>Examples</h3>

<pre><code class='language-R'>
S &lt;- array(0,c(5,5,10) )
for (i in 1:10){
tem &lt;- diag(5)+.1*matrix(rnorm(25),5,5)
S[,,i]&lt;- tem
}

estcov( S , method="Procrustes")

</code></pre>

<hr>
<h2 id='frechet'>Mean shape estimators</h2><span id='topic+frechet'></span>

<h3>Description</h3>

<p>Calculation of different types of Frechet mean
shapes, or the isotropic offset Gaussian MLE mean shape
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frechet(x, mean="intrinsic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frechet_+3A_x">x</code></td>
<td>
<p>Input k x m x n real array, where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="frechet_+3A_mean">mean</code></td>
<td>
<p>Type of mean shape. The Frechet mean shape is obtained 
by minimizing sum d(x_i,mu)^2 with respect to mu. Different estimators 
are obtained with different choices of distance d.  
&quot;intrinsic&quot; intrinsic mean shape (d = rho = Riemannian distance);
&quot;partial.procrustes&quot; partial Procrustes (d = 2*sin(rho/2));
&quot;full.procrustes&quot; full Procrustes (d = sin(rho));
h (positive real number) M-estimator (d^2 = (1 - cos^(2h)(rho))/h) Kent (1992);  
&quot;mle&quot; - isotropic offset Gaussian MLE of Mardia and Dryden (1989)  
</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>mshape</code></td>
<td>
<p>Mean shape estimate</p>
</td></tr> 
<tr><td><code>var</code></td>
<td>
<p>Minimized Frechet variance (not available for MLE)</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>(if available) The estimated kappa for the MLE</p>
</td></tr> 
<tr><td><code>code</code></td>
<td>
<p>Code from optimization, as given by function nlm - should be 1 or 2</p>
</td></tr>
<tr><td><code>gradient</code></td>
<td>
<p>Gradient from the optimization, as given by function nlm - should be close to zero</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I. L. (1991). Discussion to 'Procrustes methods in the statistical analysis
of shape' by C.R. Goodall. Journal of the Royal Statistical Society, Series B,
53:327-328.
</p>
<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. 
</p>
<p>Kent, J. T. (1992). New directions in shape analysis. In Mardia, K. V., editor, The
Art of Statistical Science, pages 115-127. Wiley, Chichester. 
</p>
<p>Mardia, K. V. and Dryden, I. L. (1989b). The statistical analysis of shape data.
Biometrika, 76:271-282.
</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas (cf. Dryden and Mardia, 2016)

data(gorf.dat)
frechet(gorf.dat[,,1:4],mean="intrinsic")

</code></pre>

<hr>
<h2 id='gels'>Electrophoresis gel data</h2><span id='topic+gels'></span>

<h3>Description</h3>

<p>Electrophoresis gel data. 10 invariant spots have been picked out by an expert
on two electrophoretic gels. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gels)</code></pre>


<h3>Format</h3>

<p>An array of dimension 10 x 2 x 2
</p>


<h3>Source</h3>

<p>Dryden, I. L. and Walker, G. (1999). Highly resistant regression and object matching. Biometrics, 55,
820-825.
</p>


<h3>References</h3>

<p>Data from Chris Glasbey (BioSS)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gels)
plotshapes(gels)
</code></pre>

<hr>
<h2 id='gorf.dat'>Female gorilla data</h2><span id='topic+gorf.dat'></span>

<h3>Description</h3>

<p>Female gorilla skull data. 8 landmarks 
in 2 dimensions, 30 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gorf.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 30
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>
<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/gorf.dat
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
plotshapes(gorf.dat)
</code></pre>

<hr>
<h2 id='gorm.dat'>Male gorilla data</h2><span id='topic+gorm.dat'></span>

<h3>Description</h3>

<p>Male gorilla skull data. 8 landmarks 
in 2 dimensions, 29 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gorm.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 29
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>
<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/gorm.dat
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorm.dat)
plotshapes(gorm.dat)
</code></pre>

<hr>
<h2 id='groupstack'>Combine two or more groups of configurations</h2><span id='topic+groupstack'></span>

<h3>Description</h3>

<p>Combine two or more groups of configurations and 
create a group label vector. (Maximum 8 groups).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupstack(A1, A2, A3=0, A4=0, A5=0, A6=0, A7=0, A8=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupstack_+3A_a1">A1</code></td>
<td>
<p>Input k x m x n real array of the Procrustes 
transformed configurations, 
where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="groupstack_+3A_a2">A2</code></td>
<td>
<p>Input k x m x n real array of the Procrustes
original configurations,
where k is the number of points, m
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="groupstack_+3A_a3">A3</code></td>
<td>
<p> Optional array</p>
</td></tr>
<tr><td><code id="groupstack_+3A_a4">A4</code></td>
<td>
<p> Optional array</p>
</td></tr>
<tr><td><code id="groupstack_+3A_a5">A5</code></td>
<td>
<p> Optional array</p>
</td></tr>
<tr><td><code id="groupstack_+3A_a6">A6</code></td>
<td>
<p> Optional array</p>
</td></tr>
<tr><td><code id="groupstack_+3A_a7">A7</code></td>
<td>
<p> Optional array</p>
</td></tr>
<tr><td><code id="groupstack_+3A_a8">A8</code></td>
<td>
<p> Optional array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The combined array of all configurations</p>
</td></tr>
<tr><td><code>groups</code></td>
<td>
<p>The group labels (integers)</p>
</td></tr>                             
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester.</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas (cf. Dryden and Mardia, 2016)

data(gorf.dat)
data(gorm.dat)

groupstack(gorf.dat,gorm.dat)

</code></pre>

<hr>
<h2 id='humanmove'>Human movement data</h2><span id='topic+humanmove'></span>

<h3>Description</h3>

<p>Human movement data. 4 landmarks 
in 2 dimensions, 5 individuals observed at 10 times. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(humanmove)</code></pre>


<h3>Format</h3>

<p>humanmove: An array of landmark configurations 4 x 2 x 10 x 5
</p>


<h3>Source</h3>

<p>Alshabani, A. K. S. and Dryden, I. L. and Litton, C. D. and
Richardson, J. (2007).
Bayesian analysis of human movement curves, 
J. Roy. Statist. Soc. Ser. C, 56, 415&ndash;428. 
</p>


<h3>References</h3>

<p>Data from James Richardson.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(humanmove)
#plotshapes(humanmove[,,,1])
#for (i in 2:5){
#for (j in 1:4){
#for (k in 1:10){
#points(humanmove[j,,k,i],col=i)
#}
#}
#}
</code></pre>

<hr>
<h2 id='macaques'>Male and Female macaque data</h2><span id='topic+macaques'></span>

<h3>Description</h3>

<p>Male and female macaque skull data. 7 landmarks 
in 3 dimensions, 18 individuals (9 males, 9 females)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(macaques)</code></pre>


<h3>Format</h3>

<p>macaques$x : An array of dimension 7 x 3 x 18
</p>
<p>macaques$group : A factor indicating the sex (&lsquo;m&rsquo; for male and &lsquo;f&rsquo; for female)
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>Dryden, I. L. and Mardia, K. V. (1993). Multivariate shape analysis. Sankhya Series A, 55, 460-480.
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(macaques)
shapes3d(macaques$x[,,1])
</code></pre>

<hr>
<h2 id='macf.dat'>Female macaque data</h2><span id='topic+macf.dat'></span>

<h3>Description</h3>

<p>Female macaque skull data. 7 landmarks 
in 3 dimensions, 9 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(macf.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 7 x 3 x 9
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(macf.dat)
plotshapes(macf.dat)
</code></pre>

<hr>
<h2 id='macm.dat'>Male macaque data</h2><span id='topic+macm.dat'></span>

<h3>Description</h3>

<p>Male macaque skull data. 7 landmarks 
in 3 dimensions, 9 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(macm.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 7 x 3 x 9
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(macm.dat)
plotshapes(macm.dat)
</code></pre>

<hr>
<h2 id='mice'>T2 mouse vertabrae data</h2><span id='topic+mice'></span>

<h3>Description</h3>

<p>T2 mouse vertebrae data - 6 landmarks 
in 2 dimensions, in 3 groups (30 Control, 23 Large, 23 Small mice). The 6 landmarks 
are obtained using a semi-automatic method at points of high curvature. This particular strain of mice is 
the &lsquo;QE&rsquo; strain.  In addition pseudo-landmarks are given around each outlines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mice)</code></pre>


<h3>Format</h3>

<p>mice$x  : An array of dimension 6 x 2 x 76 of the two dimensional co-ordinates 
of 6 landmarks for each of the 76 mice.
</p>
<p>mice$group  :  Group labels. &quot;c&quot; Control, &quot;l&quot; Large, &quot;s&quot; Small mice
</p>
<p>mice$outlines : An array of dimension 60 x 2 x 76 containing the 6 landmarks and 
54 pseudo-landmarks, with 9 pseudo-landmarks approximately equally spaced between 
each pair of landmarks.
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (1998). 
Statistical Shape Analysis, Wiley, Chichester. p313
</p>


<h3>References</h3>

<p>Mardia, K. V. and Dryden, I. L. (1989). The statistical analysis of shape data. Biometrika, 76, 271-281.
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School) and David Johnson (Leeds)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mice)
plotshapes(mice$x,symbol=as.character(mice$group),joinline=c(1,6,2:5,1))
</code></pre>

<hr>
<h2 id='panf.dat'>Female chimpanzee data</h2><span id='topic+panf.dat'></span>

<h3>Description</h3>

<p>Female chimpanzee skull data. 8 landmarks
in 2 dimensions, 26 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(panf.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 26
</p>


<h3>Source</h3>

<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(panf.dat)
plotshapes(panf.dat)
</code></pre>

<hr>
<h2 id='panm.dat'>Male chimpanzee data</h2><span id='topic+panm.dat'></span>

<h3>Description</h3>

<p>Male chimpanzee skull data. 8 landmarks
in 2 dimensions, 28 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(panm.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 28
</p>


<h3>Source</h3>

<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(panm.dat)
plotshapes(panm.dat)
</code></pre>

<hr>
<h2 id='plot3darcs'>Modes of variation plots for PCA and PNSS</h2><span id='topic+plot3darcs'></span>

<h3>Description</h3>

<p>Modes of variation plots for PCA and PNSS based on 3D views and arcs along a mode. 
c * sd : the extent along lower and upper principal arcs. 
</p>
<p>The lower principal arc -&gt; 0 -&gt; upper principal arc has a total of 2*nn+1 configurations
with: nn configurations along the negative principal arc to 0; one configuration at the PNS mean; nn configurations along the positive principal arc. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot3darcs(x,pcno=1,c=1,nn=100,boundary.data=TRUE,view.theta=0,view.phi=0,type="pnss")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot3darcs_+3A_x">x</code></td>
<td>
<p>Output from pnss3d</p>
</td></tr>
<tr><td><code id="plot3darcs_+3A_pcno">pcno</code></td>
<td>
<p>The number of the PC/PNSS component. The default is 1, the first PC/PNSS</p>
</td></tr> 
<tr><td><code id="plot3darcs_+3A_c">c</code></td>
<td>
<p>Number of standard deviations along each arc</p>
</td></tr> 
<tr><td><code id="plot3darcs_+3A_nn">nn</code></td>
<td>
<p>In total 2 * nn + 1 configurations: n configurations on arc from negative to 0; 
1 configuration at 0; nn configurations from 0 to positive</p>
</td></tr> 
<tr><td><code id="plot3darcs_+3A_boundary.data">boundary.data</code></td>
<td>
<p>Logical for whether to use boundary data or not. </p>
</td></tr>
<tr><td><code id="plot3darcs_+3A_view.theta">view.theta</code></td>
<td>
<p>Viewing angle theta</p>
</td></tr>
<tr><td><code id="plot3darcs_+3A_view.phi">view.phi</code></td>
<td>
<p>Viewing angle phi</p>
</td></tr>
<tr><td><code id="plot3darcs_+3A_type">type</code></td>
<td>
<p>&quot;pnss&quot; principal nested sphere mean and arc, or &quot;pca&quot; Procrustes mean and linear PC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>PNSmean</code></td>
<td>
<p>the PNSS mean</p>
</td></tr>
<tr><td><code>lu.arc</code></td>
<td>
<p>the configurations along the arc</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kwang-Rae Kim, Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L., Kim, K., Laughton, C.A. and Le, H. (2019). Principal nested shape space analysis of molecular dynamics data. Annals of Applied Statistics, 13, 2213-2234.
</p>
<p>Jung, S., Dryden, I.L. and Marron, J.S. (2012). Analysis of principal nested spheres. Biometrika, 99, 551-568.
</p>


<h3>See Also</h3>

<p>pns, pns4pc, pnss3d</p>


<h3>Examples</h3>

<pre><code class='language-R'>ans &lt;- pnss3d(digit3.dat, sphere.type="BIC", n.pc=5)
#aa &lt;- plot3darcs(ans,c=2,pcno=1)
#bb &lt;- plot3darcs(ans,c=2,pcno=1,type="pca")
</code></pre>

<hr>
<h2 id='plotshapes'>Plot configurations</h2><span id='topic+plotshapes'></span>

<h3>Description</h3>

<p>Plots configurations. Either one or two groups of observations
can be plotted on the same scale. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotshapes(A, B = 0, joinline = c(1, 1),orthproj=c(1,2),color=1,symbol=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotshapes_+3A_a">A</code></td>
<td>
<p>k x m x n array, or k x m matrix for first group</p>
</td></tr> 
<tr><td><code id="plotshapes_+3A_b">B</code></td>
<td>
<p>k x m x n array, or k x m matrix for 2nd group (can be missing)</p>
</td></tr>
<tr><td><code id="plotshapes_+3A_joinline">joinline</code></td>
<td>
<p>A vector stating which landmarks are joined up by lines,
e.g. joinline=c(1:n,1) will start at landmark 1, join to 2, ..., join to n, 
then re-join to landmark 1.</p>
</td></tr>
<tr><td><code id="plotshapes_+3A_orthproj">orthproj</code></td>
<td>
<p>A vector stating which two orthogonal projections will be
used. For example, for m=3 dimensional data: X-Y projection given by c(1,2) 
(default), X-Z projection given by c(1,3), Y-Z projection given by c(2,3).</p>
</td></tr>
<tr><td><code id="plotshapes_+3A_color">color</code></td>
<td>
<p>Colours for points. Can be a vector, e.g. 1:k gives each landmark
a different colour for the specimens</p>
</td></tr>
<tr><td><code id="plotshapes_+3A_symbol">symbol</code></td>
<td>
<p>Plotting symbols. Can be a vector, e.g. 1:k gives each landmark
a different symbol for the specimens</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Just graphical output
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>See Also</h3>

<p>shapepca,tpsgrid</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
data(gorm.dat)
plotshapes(gorf.dat,gorm.dat,joinline=c(1,6,7,8,2,3,4,5,1))

data(macm.dat)
data(macf.dat)
plotshapes(macm.dat,macf.dat)
</code></pre>

<hr>
<h2 id='pns'>Principal Nested Spheres</h2><span id='topic+pns'></span>

<h3>Description</h3>

<p>Calculation of Principal Nested Spheres
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pns(x, sphere.type = "seq.test", alpha = 0.1, R = 100, 
                              nlast.small.sphere = 1, output=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pns_+3A_x">x</code></td>
<td>
<p>a (d + 1) x n data matrix where each column is a unit vector in S^d and n is the sample size.
</p>
</td></tr>
<tr><td><code id="pns_+3A_sphere.type">sphere.type</code></td>
<td>

<p>a character string specifying the type of sphere fitting method.
&quot;seq.test&quot;
specifies sequential tests to decide either &quot;small&quot; or &quot;great&quot;;
&quot;small&quot;
specifies Principal Nested SMALL Sphere;
&quot;great&quot;
specifies Principal Nested GREAT Sphere (radius pi/2);
&quot;BIC&quot;
specifies BIC statistic to decide either &quot;small&quot; or &quot;great&quot;; and
&quot;bi.sphere&quot;
specifies Principal Nested GREAT Sphere for the first part and Principal Nested SMALL Sphere for last parts. The default is &quot;seq.test&quot;.
</p>
</td></tr> 
<tr><td><code id="pns_+3A_alpha">alpha</code></td>
<td>
<p>significance level (0 &lt; alpha &lt; 1) used when sphere.type = &quot;seq.test&quot;. The default is 0.1.
</p>
</td></tr>
<tr><td><code id="pns_+3A_r">R</code></td>
<td>
<p>the number of bootstrap samples to be evaluated for the sequential test. The default is 100.</p>
</td></tr>
<tr><td><code id="pns_+3A_nlast.small.sphere">nlast.small.sphere</code></td>
<td>
<p>the number of small spheres in the finishing part used when 
sphere.type = &quot;bi.sphere&quot;.</p>
</td></tr>
<tr><td><code id="pns_+3A_output">output</code></td>
<td>
<p>Logical. If TRUE then plots and some brief printed summaries are given. If FALSE then no plots or output is given.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>resmat</code></td>
<td>
<p>the residual matrix (X_PNS). Each entry in row k works like the kth principal component</p>
</td></tr> 
<tr><td><code>$PNS</code></td>
<td>
<p>= the list with the following components.</p>
</td></tr>
<tr><td><code>radii</code></td>
<td>
<p>the size (radius) of PNS.</p>
</td></tr>
<tr><td><code>orthaxis</code></td>
<td>
<p>the orthogonal axis v_i of subspheres.</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>the distance r_i of subspheres</p>
</td></tr>
<tr><td><code>pvalues</code></td>
<td>
<p>the p-values of LRT and parametric boostrap tests (if any).</p>
</td></tr>
<tr><td><code>ratio</code></td>
<td>
<p>the estimated ratios. Now unavailable.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>the location of the PNS mean.</p>
</td></tr>
<tr><td><code>sphere.type</code></td>
<td>
<p>the type of method for fitting subspheres.</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>proportion of variances explained.</p>
</td></tr>
<tr><td><code>spherePNS</code></td>
<td>
<p>The co-ordinates of the data points projected to the sphere in 3D (also plotted)</p>
</td></tr>
<tr><td><code>circlePNS</code></td>
<td>
<p>The co-ordinates of the 2D circle projections on the sphere in 3D (also plotted)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kwang-Rae Kim: R translation of Sungkyu Jung's matlab code</p>


<h3>References</h3>

<p>Dryden, I.L., Kim, K., Laughton, C.A. and Le, H. (2019). Principal nested shape space analysis of molecular dynamics data. Annals of Applied Statistics, 13, 2213-2234.
</p>
<p>Jung, S., Dryden, I.L. and Marron, J.S. (2012). Analysis of principal nested spheres. Biometrika, 99, 551-568.
</p>


<h3>See Also</h3>

<p>pns4pc, pnss3d</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#  out &lt;- pc2sphere(x = gorf.dat, n.pc = 2)
#  spheredata &lt;- t(out$spheredata)
#  pns.out &lt;- pns(x = spheredata)

</code></pre>

<hr>
<h2 id='pns4pc'>Principal Nested Shape Spaces from PCA</h2><span id='topic+pns4pc'></span>

<h3>Description</h3>

<p>Approximation of Principal Nested Shapes Spaces using PCA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pns4pc(x, sphere.type = "seq.test", alpha = 0.1, R = 100, nlast.small.sphere = 1,n.pc=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pns4pc_+3A_x">x</code></td>
<td>
<p>k x m x n array of landmark data.</p>
</td></tr>
<tr><td><code id="pns4pc_+3A_sphere.type">sphere.type</code></td>
<td>

<p>a character string specifying the type of sphere fitting method.
&quot;seq.test&quot;
specifies sequential tests to decide either &quot;small&quot; or &quot;great&quot;;
&quot;small&quot;
specifies Principal Nested SMALL Sphere;
&quot;great&quot;
specifies Principal Nested GREAT Sphere (radius pi/2);
&quot;BIC&quot;
specifies BIC statistic to decide either &quot;small&quot; or &quot;great&quot;; and
&quot;bi.sphere&quot;
specifies Principal Nested GREAT Sphere for the first part and Principal Nested SMALL Sphere for The default is &quot;seq.test&quot;.
</p>
</td></tr> 
<tr><td><code id="pns4pc_+3A_alpha">alpha</code></td>
<td>
<p>significance level (0 &lt; alpha &lt; 1) used when sphere.type = &quot;seq.test&quot;. The default is 0.1.
</p>
</td></tr>
<tr><td><code id="pns4pc_+3A_r">R</code></td>
<td>
<p>the number of bootstrap samples to be evaluated for the sequential test. The default is 100.</p>
</td></tr>
<tr><td><code id="pns4pc_+3A_nlast.small.sphere">nlast.small.sphere</code></td>
<td>
<p>the number of small spheres in the finishing part used when 
sphere.type = &quot;bi.sphere&quot;.</p>
</td></tr>
<tr><td><code id="pns4pc_+3A_n.pc">n.pc</code></td>
<td>
<p>the number of PC scores to be used (n.pc &gt;= 2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>PNS</code></td>
<td>
<p>the output of the function pns</p>
</td></tr>
<tr><td><code>GPAout</code></td>
<td>
<p>the result of GPA</p>
</td></tr>
<tr><td><code>spheredata</code></td>
<td>
<p>transformed spherical data from the PC scores</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>proportion of variances explained.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kwang-Rae Kim</p>


<h3>References</h3>

<p>Dryden, I.L., Kim, K., Laughton, C.A. and Le, H. (2019). Principal nested shape space analysis of molecular dynamics data. Annals of Applied Statistics, 13, 2213-2234.
</p>
<p>Jung, S., Dryden, I.L. and Marron, J.S. (2012). Analysis of principal nested spheres. Biometrika, 99, 551-568.
</p>


<h3>See Also</h3>

<p>pns, pns4pc, pnss3d, plot3darcs</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pns4pc(digit3.dat,n.pc=2)

</code></pre>

<hr>
<h2 id='pnss3d'>Principal Nested Shape Space Analysis</h2><span id='topic+pnss3d'></span>

<h3>Description</h3>

<p>Approximation of Principal Nested Shapes Spaces using PCA: 
2D or 3D data, small or large samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnss3d(x,sphere.type="seq.test",alpha = 0.1,R = 100,
                        nlast.small.sphere = 1,n.pc="Full",output=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pnss3d_+3A_x">x</code></td>
<td>
<p>k x m x n array of landmark data.</p>
</td></tr>
<tr><td><code id="pnss3d_+3A_sphere.type">sphere.type</code></td>
<td>

<p>a character string specifying the type of sphere fitting method.
&quot;seq.test&quot;
specifies sequential tests to decide either &quot;small&quot; or &quot;great&quot;;
&quot;small&quot;
specifies Principal Nested SMALL Sphere;
&quot;great&quot;
specifies Principal Nested GREAT Sphere (radius pi/2);
&quot;BIC&quot;
specifies BIC statistic to decide either &quot;small&quot; or &quot;great&quot;; and
&quot;bi.sphere&quot;
specifies Principal Nested GREAT Sphere for the first part and Principal Nested 
SMALL Sphere for the last part. The default is &quot;seq.test&quot;.
</p>
</td></tr> 
<tr><td><code id="pnss3d_+3A_alpha">alpha</code></td>
<td>
<p>significance level (0 &lt; alpha &lt; 1) used when sphere.type = &quot;seq.test&quot;. 
The default is 0.1.
</p>
</td></tr>
<tr><td><code id="pnss3d_+3A_r">R</code></td>
<td>
<p>the number of bootstrap samples to be evaluated for the sequential test. 
The default is 100.</p>
</td></tr>
<tr><td><code id="pnss3d_+3A_nlast.small.sphere">nlast.small.sphere</code></td>
<td>
<p>the number of small spheres in the finishing part used when 
sphere.type = &quot;bi.sphere&quot;.</p>
</td></tr>
<tr><td><code id="pnss3d_+3A_n.pc">n.pc</code></td>
<td>
<p>the number of PC scores to be used (n.pc &gt;= 2)</p>
</td></tr>
<tr><td><code id="pnss3d_+3A_output">output</code></td>
<td>
<p>Logical. If TRUE then plots and some brief printed summaries are given. If FALSE then no plots or output is given.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>PNS</code></td>
<td>
<p>the output of the function pns</p>
</td></tr>
<tr><td><code>GPAout</code></td>
<td>
<p>the result of GPA</p>
</td></tr>
<tr><td><code>spheredata</code></td>
<td>
<p>transformed spherical data from the PC scores</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>proportion of variances explained.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kwang-Rae Kim, Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L., Kim, K., Laughton, C.A. and Le, H. (2019). Principal nested shape 
space analysis of molecular dynamics data. Annals of Applied Statistics, 13, 2213-2234.
</p>
<p>Jung, S., Dryden, I.L. and Marron, J.S. (2012). Analysis of principal nested spheres. 
Biometrika, 99, 551-568.
</p>


<h3>See Also</h3>

<p>pns, pns4pc, plot3darcs</p>


<h3>Examples</h3>

<pre><code class='language-R'>ans &lt;- pnss3d(digit3.dat, sphere.type="BIC", n.pc=5)
#aa &lt;- plot3darcs(ans,c=2,pcno=1)
#bb &lt;- plot3darcs(ans,c=2,pcno=1,type="pca")
</code></pre>

<hr>
<h2 id='pongof.dat'>Female orang utan data</h2><span id='topic+pongof.dat'></span>

<h3>Description</h3>

<p>Female orang utan skull data. 8 landmarks
in 2 dimensions, 30 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pongof.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 30
</p>


<h3>Source</h3>

<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pongof.dat)
plotshapes(pongof.dat)
</code></pre>

<hr>
<h2 id='pongom.dat'>Male orang utan data</h2><span id='topic+pongom.dat'></span>

<h3>Description</h3>

<p>Male orang utan skull data. 8 landmarks
in 2 dimensions, 30 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pongom.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 8 x 2 x 30
</p>


<h3>Source</h3>

<p>O'Higgins, P. and Dryden, I. L. (1993). Sexual dimorphism in
hominoids: further studies of craniofacial shape differences in
Pan, Gorilla, Pongo, Journal of Human Evolution, 24, 183-205.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pongom.dat)
plotshapes(pongom.dat)
</code></pre>

<hr>
<h2 id='procdist'>Procrustes distance</h2><span id='topic+procdist'></span>

<h3>Description</h3>

<p>Calculates different types of Procrustes shape or size-and-shape distance between two
configurations</p>


<h3>Usage</h3>

<pre><code class='language-R'>procdist(x, y,type="full",reflect=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="procdist_+3A_x">x</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data) 
where k = number of landmarks and m = no of dimensions</p>
</td></tr> 
<tr><td><code id="procdist_+3A_y">y</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data)</p>
</td></tr> 
<tr><td><code id="procdist_+3A_type">type</code></td>
<td>
<p>string indicating the type of distance; 
&quot;full&quot; full Procrustes distance, 
&quot;partial&quot; partial Procrustes distance, 
&quot;Riemannian&quot; Riemannian shape distance, 
&quot;sizeandshape&quot; size-and-shape Riemannian/Procrustes distance</p>
</td></tr>
<tr><td><code id="procdist_+3A_reflect">reflect</code></td>
<td>
<p> Logical. If reflect = TRUE then reflection invariance is included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The distance between the two configurations.</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester.
</p>


<h3>See Also</h3>

<p>procOPA,procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
data(gorm.dat)
gorf&lt;-procGPA(gorf.dat)
gorm&lt;-procGPA(gorm.dat)
distfull&lt;-procdist(gorf$mshape,gorm$mshape)
cat("Full Procustes distance between mean shapes is ",distfull," \n")
</code></pre>

<hr>
<h2 id='procGPA'>Generalised Procrustes analysis</h2><span id='topic+procGPA'></span>

<h3>Description</h3>

<p>Generalised Procrustes analysis to register landmark configurations into optimal registration using translation, 
rotation and scaling. Reflection invariance can also be chosen, and registration without scaling is also an option. Also, obtains principal 
components, and some summary statistics. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>procGPA(x, scale = TRUE, reflect = FALSE, eigen2d = FALSE, 
tol1 = 1e-05, tol2 = tol1, tangentcoords = "residual", proc.output=FALSE, 
distances=TRUE, pcaoutput=TRUE, alpha=0, affine=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="procGPA_+3A_x">x</code></td>
<td>
<p>Input k x m x n real array, (or k x n complex 
matrix for m=2 is OK), where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="procGPA_+3A_scale">scale</code></td>
<td>
<p>Logical quantity indicating if scaling is required</p>
</td></tr>
<tr><td><code id="procGPA_+3A_reflect">reflect</code></td>
<td>
<p>Logical quantity indicating if reflection 
is required</p>
</td></tr>
<tr><td><code id="procGPA_+3A_eigen2d">eigen2d</code></td>
<td>
<p>Logical quantity indicating if complex eigenanalysis 
should be used to calculate Procrustes mean for the particular 2D case when 
scale=TRUE, reflect=FALSE</p>
</td></tr> 
<tr><td><code id="procGPA_+3A_tol1">tol1</code></td>
<td>
<p>Tolerance for optimal rotation for the iterative 
algorithm: tolerance on the mean sum of squares 
(divided by size of mean squared) between successive iterations</p>
</td></tr>
<tr><td><code id="procGPA_+3A_tol2">tol2</code></td>
<td>
<p>tolerance for rescale/rotation step for the iterative 
algorithm: tolerance on the mean sum of squares 
(divided by size of mean squared) between successive iterations</p>
</td></tr>
<tr><td><code id="procGPA_+3A_tangentcoords">tangentcoords</code></td>
<td>
<p>Type of tangent coordinates. If (SCALE=TRUE) 
the options are &quot;residual&quot; (Procrustes residuals, which are approximate 
tangent coordinates to shape space), &quot;partial&quot; (Kent's partial tangent 
co-ordinates), &quot;expomap&quot; (tangent coordinates from the inverse of the 
exponential map, which are the similar to &quot;partial&quot; but scaled by 
(rho/sin(rho)) where rho is the Riemannian distance to the pole of
the projection. If (SCALE=FALSE) then all three options give the
same tangent co-ordinates to size-and-shape space, which is simply the 
Procrustes residual X^P - mu. </p>
</td></tr>
<tr><td><code id="procGPA_+3A_proc.output">proc.output</code></td>
<td>
<p>Logical quantity indicating if printed output during the
iterations of the Procrustes GPA algorithm should be given</p>
</td></tr> 
<tr><td><code id="procGPA_+3A_distances">distances</code></td>
<td>
<p>Logical quantity indicating if shape distances and sizes 
should be calculated</p>
</td></tr>
<tr><td><code id="procGPA_+3A_pcaoutput">pcaoutput</code></td>
<td>
<p>Logical quantity indicating if PCA should be carried out</p>
</td></tr> 
<tr><td><code id="procGPA_+3A_alpha">alpha</code></td>
<td>
<p>The parameter alpha used for relative warps analysis, where alpha 
is the power of the bending energy matrix. 
If alpha = 0 then standard Procrustes PCA is carried out. If alpha = 1 then large scale variations 
are emphasized, if alpha = -1 then small scale variations are emphasised. 
Requires m=2 and m=3 dimensional data if alpha $!=$ 0.</p>
</td></tr>
<tr><td><code id="procGPA_+3A_affine">affine</code></td>
<td>
<p>Logical. If TRUE then only the affine subspace of shape variability is 
considered.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>k</code></td>
<td>
<p>no of landmarks</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>no of dimensions (m-D dimension configurations)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>mshape</code></td>
<td>
<p>Procrustes mean shape. Note this is unit size if complex 
eigenanalysis used, but on the scale of the data if iterative GPA is used.</p>
</td></tr> 
<tr><td><code>tan</code></td>
<td>
<p>The tangent shape (or size-and-shape) coordinates</p>
</td></tr>
<tr><td><code>rotated</code></td>
<td>
<p>the k x m x n array of full Procrustes 
rotated data</p>
</td></tr> 
<tr><td><code>pcar</code></td>
<td>
<p>the columns are eigenvectors (PCs) of the sample 
covariance Sv of tan</p>
</td></tr> 
<tr><td><code>pcasd</code></td>
<td>
<p>the square roots of eigenvalues of Sv using tan (s.d.'s of PCs)</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>the percentage of variability explained by the PCs using
tan. If alpha $!=0$ then it is the percent of non-affine variation of the relative warp scores. 
If affine is TRUE it is the percentage of total shape variability of each affine 
component.</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>the centroid sizes of the configurations</p>
</td></tr>
<tr><td><code>stdscores</code></td>
<td>
<p>standardised PC scores (each with unit variance) using 
tan</p>
</td></tr> 
<tr><td><code>rawscores</code></td>
<td>
<p>raw PC scores using tan</p>
</td></tr> 
<tr><td><code>rho</code></td>
<td>
<p>Kendall's Riemannian shape distance rho to the mean shape</p>
</td></tr>
<tr><td><code>rmsrho</code></td>
<td>
<p>root mean square (r.m.s.) of rho</p>
</td></tr> 
<tr><td><code>rmsd1</code></td>
<td>
<p>r.m.s. of full Procrustes distances to the mean shape $d_F$</p>
</td></tr>
<tr><td><code>GSS</code></td>
<td>
<p>Minimized Procrustes sum of squares</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden, with input from Mohammad Faghihi and Alfred Kume</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. Chapter 7.
</p>
<p>Goodall, C.R. (1991). Procrustes methods in the statistical analysis 
of shape (with discussion). Journal of the Royal Statistical Society, 
Series B, 53: 285-339. 
</p>
<p>Gower, J.C. (1975). Generalized Procrustes analysis, Psychometrika, 40, 33&ndash;50. 
</p>
<p>Kent, J.T. (1994). The complex Bingham distribution and shape analysis,
Journal of the Royal Statistical Society, Series B, 56, 285-299.
</p>
<p>Ten Berge, J.M.F. (1977). Orthogonal Procrustes rotation for two or more 
matrices. Psychometrika, 42, 267-276. </p>


<h3>See Also</h3>

<p>procOPA,riemdist,shapepca,testmeanshapes</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas (cf. Dryden and Mardia, 2016)

data(gorf.dat)
data(gorm.dat)

plotshapes(gorf.dat,gorm.dat)
n1&lt;-dim(gorf.dat)[3]
n2&lt;-dim(gorm.dat)[3]
k&lt;-dim(gorf.dat)[1]
m&lt;-dim(gorf.dat)[2]
gor.dat&lt;-array(0,c(k,2,n1+n2))
gor.dat[,,1:n1]&lt;-gorf.dat
gor.dat[,,(n1+1):(n1+n2)]&lt;-gorm.dat

gor&lt;-procGPA(gor.dat)
shapepca(gor,type="r",mag=3)
shapepca(gor,type="v",mag=3)

gor.gp&lt;-c(rep("f",times=30),rep("m",times=29))
x&lt;-cbind(gor$size,gor$rho,gor$scores[,1:3])
pairs(x,panel=function(x,y) text(x,y,gor.gp),
   label=c("s","rho","score 1","score 2","score 3"))


##########################################################
#3D example

data(macm.dat)
out&lt;-procGPA(macm.dat,scale=FALSE)

par(mfrow=c(2,2))
plot(out$rawscores[,1],out$rawscores[,2],xlab="PC1",ylab="PC2")
title("PC scores")
plot(out$rawscores[,2],out$rawscores[,3],xlab="PC2",ylab="PC3")
plot(out$rawscores[,1],out$rawscores[,3],xlab="PC1",ylab="PC3")
plot(out$size,out$rho,xlab="size",ylab="rho")
title("Size versus shape distance")

</code></pre>

<hr>
<h2 id='procOPA'>Ordinary Procrustes analysis</h2><span id='topic+procOPA'></span>

<h3>Description</h3>

<p>Ordinary Procustes analysis : the matching of one configuration to  
another using translation, rotation and (possibly) scale. Reflections 
can also be included if desired. The function matches configuration B 
onto A by least squares.</p>


<h3>Usage</h3>

<pre><code class='language-R'>procOPA(A, B, scale = TRUE, reflect = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="procOPA_+3A_a">A</code></td>
<td>
<p>k x m matrix (or complex k-vector for 2D data), of 
k landmarks in m dimensions. This is the reference figure.</p>
</td></tr> 
<tr><td><code id="procOPA_+3A_b">B</code></td>
<td>
<p>k x m matrix (or complex k-vector for 2D data). This is 
the figure which is to be transformed.</p>
</td></tr> 
<tr><td><code id="procOPA_+3A_scale">scale</code></td>
<td>
<p>logical indicating if scaling is required</p>
</td></tr> 
<tr><td><code id="procOPA_+3A_reflect">reflect</code></td>
<td>
<p>logical indicating if reflection is allowed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:          
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>The estimated rotation matrix (may be an orthogonal matrix 
if reflection is allowed)</p>
</td></tr> 
<tr><td><code>s</code></td>
<td>
<p>The estimated scale matrix</p>
</td></tr>   
<tr><td><code>Ahat</code></td>
<td>
<p>The centred configuration A</p>
</td></tr>
<tr><td><code>Bhat</code></td>
<td>
<p>The Procrustes registered configuration B</p>
</td></tr>
<tr><td><code>OSS</code></td>
<td>
<p>The ordinary Procrustes sum of squares, which is 
$\|Ahat-Bhat\|^2$</p>
</td></tr>
<tr><td><code>rmsd</code></td>
<td>
<p>rmsd = sqrt(OSS/(km))</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. Chapter 7.</p>


<h3>See Also</h3>

<p>procGPA,riemdist,tpsgrid</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(digit3.dat)

A&lt;-digit3.dat[,,1]
B&lt;-digit3.dat[,,2]
ans&lt;-procOPA(A,B) 
plotshapes(A,B,joinline=1:13)
plotshapes(ans$Ahat,ans$Bhat,joinline=1:13)

#Sooty Mangabey data
data(sooty.dat)
A&lt;-sooty.dat[,,1]   #juvenile
B&lt;-sooty.dat[,,2]   #adult
par(mfrow=c(1,3))
par(pty="s")
plot(A,xlim=c(-2000,3000),ylim=c(-2000,3000),xlab=" ",ylab=" ")
lines(A[c(1:12,1),])
points(B)
lines(B[c(1:12,1),],lty=2)
title("Juvenile (-------) Adult (- - - -)")
#match B onto A
out&lt;-procOPA(A,B)
#rotation angle
print(atan2(out$R[1,2],out$R[1,1])*180/pi)
#scale
print(out$s)
plot(A,xlim=c(-2000,3000),ylim=c(-2000,3000),xlab=" ",ylab=" ")
lines(A[c(1:12,1),])
points(out$Bhat)
lines(out$Bhat[c(1:12,1),],lty=2)
title("Match adult onto juvenile")
#match A onto B
out&lt;-procOPA(B,A)
#rotation angle
print(atan2(out$R[1,2],out$R[1,1])*180/pi)
#scale
print(out$s)
plot(B,xlim=c(-2000,3000),ylim=c(-2000,3000),xlab=" ",ylab=" ")
lines(B[c(1:12,1),],lty=2)
points(out$Bhat)
lines(out$Bhat[c(1:12,1),])
title("Match juvenile onto adult")
</code></pre>

<hr>
<h2 id='procWGPA'>Weighted Procrustes analysis</h2><span id='topic+procWGPA'></span>

<h3>Description</h3>

<p>Weighted Procrustes analysis to register landmark configurations into optimal registration using translation, 
rotation and scaling. Registration without scaling is also an option. Also, obtains principal 
components, and some summary statistics. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>procWGPA(x, fixcovmatrix=FALSE, initial="Identity", maxiterations=10, scale=TRUE,
 reflect=FALSE, prior="Exponential",diagonal=TRUE,sampleweights="Equal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="procWGPA_+3A_x">x</code></td>
<td>
<p>Input k x m x n real array, where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="procWGPA_+3A_fixcovmatrix">fixcovmatrix</code></td>
<td>
<p>If FALSE then the landmark covariance 
matrix is estimated. If a fixed covariance matrix is desired then 
the value should be given here, e.g. fixcovmatrix=diag(8) for the identity matrix
with 8 landmarks.</p>
</td></tr> 
<tr><td><code id="procWGPA_+3A_initial">initial</code></td>
<td>
<p>The initial value of the estimated covariance matrix. 
&quot;Identity&quot; - identity matrix, &quot;Rawdata&quot; - based on sample variance of the 
raw landmarks. Also, could be a k x k symmetric positive definite matrix.</p>
</td></tr>
<tr><td><code id="procWGPA_+3A_maxiterations">maxiterations</code></td>
<td>
<p>The maximum number of iterations for estimating 
the covariance matrix</p>
</td></tr></table>
<p>,
</p>
<table>
<tr><td><code id="procWGPA_+3A_scale">scale</code></td>
<td>
<p>Logical quantity indicating if scaling is required</p>
</td></tr></table>
<p>,
</p>
<table>
<tr><td><code id="procWGPA_+3A_reflect">reflect</code></td>
<td>
<p>Logical quantity indicating if reflection invariance is
required</p>
</td></tr></table>
<p>, 
</p>
<table>
<tr><td><code id="procWGPA_+3A_prior">prior</code></td>
<td>
<p>Indicates the type of prior. &quot;Exponential&quot; is exponential 
for the inverse eigenvalues. &quot;Identity&quot; is an inverse Wishart with 
the identity matrix as parameters.</p>
</td></tr>
<tr><td><code id="procWGPA_+3A_diagonal">diagonal</code></td>
<td>
<p>Logical. Indicates if the diagonal of the landmark 
covariance matrix (only) should be used. Diagonal matrices can lead to 
some landmarks having very small variability, which may or may not be desirable.</p>
</td></tr>
<tr><td><code id="procWGPA_+3A_sampleweights">sampleweights</code></td>
<td>
<p>Gives the weights of the observations in the sample, 
rather than the landmarks. This is a fixed quatity. &quot;Equal&quot; indicates
that all observations in the sample have equal weight. The weights
do not need to sum to 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The factored covariance model is assumed:
$Sigma_k x I_m$ with 
$Sigma_k$ being the covariance matrix of the landmarks, and the
cov matrix at each landmark is the identity matrix.</p>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>k</code></td>
<td>
<p>no of landmarks</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>no of dimensions (m-D dimension configurations)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>mshape</code></td>
<td>
<p>Weighted Procrustes mean shape.</p>
</td></tr> 
<tr><td><code>tan</code></td>
<td>
<p>This is the mk x n matrix of 
Procrustes residuals $X_i^P$ - Xbar.</p>
</td></tr>
<tr><td><code>rotated</code></td>
<td>
<p>the k x m x n array of weighted Procrustes 
rotated data</p>
</td></tr> 
<tr><td><code>pcar</code></td>
<td>
<p>the columns are eigenvectors (PCs) of the sample 
covariance Sv of tan</p>
</td></tr> 
<tr><td><code>pcasd</code></td>
<td>
<p>the square roots of eigenvalues of Sv using tan (s.d.'s of PCs)</p>
</td></tr>
<tr><td><code>percent</code></td>
<td>
<p>the percentage of variability explained by the PCs using
tan. </p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>the centroid sizes of the configurations</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>standardised PC scores (each with unit variance) using 
tan</p>
</td></tr> 
<tr><td><code>rawscores</code></td>
<td>
<p>raw PC scores using tan</p>
</td></tr> 
<tr><td><code>rho</code></td>
<td>
<p>Kendall's Riemannian distance rho to the mean shape</p>
</td></tr>
<tr><td><code>rmsrho</code></td>
<td>
<p>r.m.s. of rho</p>
</td></tr> 
<tr><td><code>rmsd1</code></td>
<td>
<p>r.m.s. of full Procrustes distances to the mean shape $d_F$</p>
</td></tr>
<tr><td><code>Sigmak</code></td>
<td>
<p>Estimate of the sample covariance matrix of the landmarks</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. 
</p>
<p>Goodall, C.R. (1991). Procrustes methods in the statistical analysis 
of shape (with discussion). Journal of the Royal Statistical Society, 
Series B, 53: 285-339. 
</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female Gorillas (cf. Dryden and Mardia, 2016)

data(gorf.dat)

gor&lt;-procWGPA(gorf.dat,maxiterations=3)

</code></pre>

<hr>
<h2 id='qcet2.dat'>Control T2 mouse vertabrae data</h2><span id='topic+qcet2.dat'></span>

<h3>Description</h3>

<p>T2 mouse vertebrae data - control group. 6 landmarks 
in 2 dimensions, 30 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(qcet2.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 6 x 2 x 30
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/qcet2.dat
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School) and David Johnson (Leeds)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(qcet2.dat)
plotshapes(qcet2.dat)
</code></pre>

<hr>
<h2 id='qlet2.dat'>Large T2 mouse vertabrae data</h2><span id='topic+qlet2.dat'></span>

<h3>Description</h3>

<p>T2 mouse vertebrae data - large group. 6 landmarks 
in 2 dimensions, 23 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(qlet2.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 6 x 2 x 23
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/qlet2.dat
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School) and David Johnson (Leeds)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(qlet2.dat)
plotshapes(qlet2.dat)
</code></pre>

<hr>
<h2 id='qset2.dat'>Small T2 mouse vertabrae data</h2><span id='topic+qset2.dat'></span>

<h3>Description</h3>

<p>T2 mouse vertebrae data - small group. 6 landmarks 
in 2 dimensions, 23 individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(qset2.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 6 x 2 x 23
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>http://www.maths.nott.ac.uk/personal/ild/bookdata/qset2.dat
</p>
<p>Data from Paul O'Higgins (Hull-York Medical School) and David Johnson (Leeds)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(qset2.dat)
plotshapes(qset2.dat)
</code></pre>

<hr>
<h2 id='rats'>Rat skulls data</h2><span id='topic+rats'></span>

<h3>Description</h3>

<p>Rat skulls data, from X rays. 8 landmarks 
in 2 dimensions, 18 individuals observed at 7, 14, 21, 30, 40, 60, 90, 150 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rats)</code></pre>


<h3>Format</h3>

<p>rats$x: An array of landmark configurations 144 x 2 x 2
</p>
<p>rats$no: Individual rat number (note rats 3, 13, 20 missing due to incomplete data)
</p>
<p>rats$time observed time in days 
</p>


<h3>Source</h3>

<p>Vilmann's rat data set (Bookstein, 1991,
Morphometric Tools for Landmark Data: Geometry and Biology, pp. 408-414)
</p>


<h3>References</h3>

<p>Bookstein, F.L. (1991). Morphometric tools for landmark data: geometry and biology, Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rats)
plotshapes(rats$x,col=1:8)
</code></pre>

<hr>
<h2 id='resampletest'>Tests for mean shape difference using complex arithmetic, including bootstrap and permutation tests. 
</h2><span id='topic+resampletest'></span>

<h3>Description</h3>

<p>Carries out tests to examine differences in mean shape
between two independent populations.
For 2D data the methods use complex arithmetic and exploit the geometry of
the shape space (which is the main use of this function). An alternative 
faster, approximate procedure using Procrustes residuals is given
by the function &lsquo;testmeanshapes&rsquo;.
For 3D data tests are carried out on the Procrustes residuals, 
which is an approximation suitable for small variations in shape.
</p>
<p>Up to four test statistics are calculated:
</p>
<p>lambda : the asymptotically pivotal statistic $lambda_min$ from Amaral et al. (2007), equ.(14),(16)
(m=2 only)
</p>
<p>H : Hotelling $T^2$ statistic (see Amaral et al., 2007, equ.(23), Dryden and Mardia, 2016, equ.(9.4))
</p>
<p>J : James' statistic (see Amaral et al., 2007, equ.(24) )
(m=2 only)
</p>
<p>G : Goodall's F statistic (see Amaral et al., 2007, equ.(25), Dryden and Mardia, 2016, equ.(9.9))
</p>
<p>p-values are given based on resampling as well as the usual table based p-values.
</p>
<p>Note when the sample sizes are low (compared to the number of landmarks) some regularization 
is carried out. In particular if Sw is a singular within group covariance matrix, it is replaced by 
Sw + 0.000001 (Identity matrix) and a &lsquo;*&rsquo; is printed in the output. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampletest(A, B, resamples = 200, replace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampletest_+3A_a">A</code></td>
<td>
<p>The random sample for group 1: k x m x n1 array of data, where
k is the number of landmarks and n1 is the sample size. (Alternatively a k x n1 complex matrix for 2D)</p>
</td></tr>
<tr><td><code id="resampletest_+3A_b">B</code></td>
<td>
<p>The random sample for group 3: k x m x n2 array of data, where
k is the number of landmarks and n2 is the sample size. (Alternatively a k x n2 complex matrix for 2D)</p>
</td></tr>
<tr><td><code id="resampletest_+3A_resamples">resamples</code></td>
<td>
<p>Integer. The number of resampling iterations. If resamples = 0 then no resampling
procedures are carried out, and the tabular p-values are given only.</p>
</td></tr>
<tr><td><code id="resampletest_+3A_replace">replace</code></td>
<td>
<p>Logical. If replace = TRUE then for 2D data bootstrap resampling is
carried out with replacement *within* each group. If replace = FALSE then permutation 
resampling is carried out (sampling without replacement in *pooled* samples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components (or a subset of these)
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>$lambda_min$ statistic</p>
</td></tr>
<tr><td><code>lambda.pvalue</code></td>
<td>
<p>p-value for $lambda_min$ test based on resampling</p>
</td></tr>
<tr><td><code>lambda.table.pvalue</code></td>
<td>
<p>p-value for $lambda_min$ test based on the asymptotic chi-squared distribution (large n1,n2)</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>The Hotelling $T^2$ statistic</p>
</td></tr>
<tr><td><code>H.pvalue</code></td>
<td>
<p>p-value for the Hotelling $T^2$ test based on resampling</p>
</td></tr>
<tr><td><code>H.table.pvalue</code></td>
<td>
<p>p-value for the Hotelling $T^2$ test based on the null F distribution, assuming normality
and equal covariance matrices</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>The Hotelling $T^2$ statistic</p>
</td></tr>
<tr><td><code>J.pvalue</code></td>
<td>
<p>p-value for the Hotelling $T^2$ test based on resampling</p>
</td></tr>
<tr><td><code>J.table.pvalue</code></td>
<td>
<p>p-value for the Hotelling $T^2$ test based on the null F distribution, assuming normality
and unequal covariance matrices</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>The Goodall $F$ statistic</p>
</td></tr>
<tr><td><code>G.pvalue</code></td>
<td>
<p>p-value for the Goodall test based on resampling</p>
</td></tr>
<tr><td><code>G.table.pvalue</code></td>
<td>
<p>p-value for the Goodall test based on the null F distribution, assuming normality and
equal isotropic covariance matrices)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Amaral, G.J.A., Dryden, I.L. and Wood, A.T.A. (2007) Pivotal bootstrap methods for 
$k$-sample problems in directional statistics and shape analysis.  Journal of the American Statistical Association.   102, 695-707. 
</p>
<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 9.
</p>
<p>Goodall, C. R. (1991). Procrustes methods in the statistical analysis
of shape (with discussion). Journal of the Royal Statistical Society,
Series B, 53: 285-339.
</p>


<h3>See Also</h3>

<p>testmeanshapes</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas

data(gorf.dat)
data(gorm.dat)

#just select 3 landmarks and the first 10 observations in each group
select&lt;-c(1,2,3)
A&lt;-gorf.dat[select,,1:10]
B&lt;-gorm.dat[select,,1:10]
resampletest(A,B,resamples=100)

</code></pre>

<hr>
<h2 id='riemdist'>Riemannian shape distance</h2><span id='topic+riemdist'></span>

<h3>Description</h3>

<p>Calculates the Riemannian shape distance rho between two
configurations</p>


<h3>Usage</h3>

<pre><code class='language-R'>riemdist(x, y, reflect=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riemdist_+3A_x">x</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data) 
where k = number of landmarks and m = no of dimensions</p>
</td></tr> 
<tr><td><code id="riemdist_+3A_y">y</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data)</p>
</td></tr> 
<tr><td><code id="riemdist_+3A_reflect">reflect</code></td>
<td>
<p> Logical. If reflect = TRUE then reflection invariance is included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Riemannian shape distance rho between the two configurations. 
Note 0 &lt;= rho &lt;= pi/2 if no reflection invariance. 
(for the Riemannian size-and-shape distance use ssriemdist)</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Kendall, D. G. (1984). 
Shape manifolds,  Procrustean metrics and complex
projective spaces, 
Bulletin of the  London Mathematical Society, 
16,
81-121. 
</p>


<h3>See Also</h3>

<p>procOPA,procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
data(gorm.dat)
gorf&lt;-procGPA(gorf.dat)
gorm&lt;-procGPA(gorm.dat)
rho&lt;-riemdist(gorf$mshape,gorm$mshape)
cat("Riemannian distance between mean shapes is ",rho," \n")
</code></pre>

<hr>
<h2 id='rigidbody'>Rigid body transformations</h2><span id='topic+rigidbody'></span>

<h3>Description</h3>

<p>Applies a rigid body transformations to a landmark configuration 
or array</p>


<h3>Usage</h3>

<pre><code class='language-R'>rigidbody(X,transx=0,transy=0,transz=0,thetax=0,thetay=0,thetaz=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rigidbody_+3A_x">X</code></td>
<td>
<p>k x m matrix, or k x m x n array 
where k = number of landmarks and m = no of dimensions and n is no of specimens</p>
</td></tr> 
<tr><td><code id="rigidbody_+3A_transx">transx</code></td>
<td>
<p>negative shift in x-coordinates</p>
</td></tr> 
<tr><td><code id="rigidbody_+3A_transy">transy</code></td>
<td>
<p>negative shift in y-coordinates</p>
</td></tr> 
<tr><td><code id="rigidbody_+3A_transz">transz</code></td>
<td>
<p>negative shift in z-coordinates</p>
</td></tr> 
<tr><td><code id="rigidbody_+3A_thetax">thetax</code></td>
<td>
<p>Rotation about x-axis in degrees</p>
</td></tr>
<tr><td><code id="rigidbody_+3A_thetay">thetay</code></td>
<td>
<p>Rotation about y-axis in degrees</p>
</td></tr>
<tr><td><code id="rigidbody_+3A_thetaz">thetaz</code></td>
<td>
<p>Rotation about z-axis in degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The transformed coordinates  (X - trans) Rx Ry Rz </p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
plotshapes ( rigidbody(gorf.dat , 0, 0, 0, 0, 0, -90 ) )
</code></pre>

<hr>
<h2 id='sand'>Sand particle outline data</h2><span id='topic+sand'></span>

<h3>Description</h3>

<p>50 points on 24 sea sand and 25 river sand grain profiles in 2D. The original 
data were kindly provided by Professor Dietrich Stoyan (Stoyan and Stoyan, 1994; Stoyan, 1997). 
The 50 points on each outline were extracted at approximately equal arc-lengths by the method 
described in Kent et al. (2000, section 8.1)</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sand)</code></pre>


<h3>Format</h3>

<p>A list with components: 
</p>
<p>sea$x  :  An array of dimension 50 x 2 x 49  containing the 50 point co-ordinates in 2D for each grain
</p>
<p>sea$group : The types of the sand grains: &quot;sea&quot;, 24 particles from the Baltic Sea
</p>
<p>&quot;river&quot;, 25 particles from the Caucasian River Selenchuk
</p>


<h3>References</h3>

<p>Kent, J. T., Dryden, I. L. and Anderson, C. R. (2000). Using circulant symmetry to model featureless
objects. Biometrika, 87, 527&ndash;544.
</p>
<p>Stoyan, D. (1997). Geometrical means, medians and variances for samples of particles. Particle Particle Syst. Charact. 14, 30&ndash;34.
</p>
<p>Stoyan, D. and Stoyan, H. (1994).  Fractals, Random Shapes and Point Fields: Methods of Geometric Statistics, John Wiley, Chichester. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sand)
plotshapes(sand$x[,,sand$group=="sea"],sand$x[,,sand$group=="river"],joinline=c(1:50))
</code></pre>

<hr>
<h2 id='schizophrenia'>Bookstein's schizophrenia data</h2><span id='topic+schizophrenia'></span>

<h3>Description</h3>

<p>Bookstein's schizophrenia data. 13 landmarks
in 2 dimensions, 28 individuals.
The first 14 individuals are controls. The last fourteen cases
were diagnosed with schizophrenia.
The landmarks were taken in the near midline from MR images of the brain:
(1) splenium, posteriormost point on corpus callosum; (2) genu,
anteriormost point on corpus callosum; (3) top of corpus callosum,
uppermost point on arch of callosum (all three to an
approximate registration on the diameter of the callosum);
(4) top of head, a point relaxed from a standard landmark
along the apparent margin of the dura; (5) tentorium of
cerebellum at dura; (6) top of cerebellum; (7) tip of
fourth ventricle; (8) bottom of cerebellum;
(9) top of pons, anterior margin; (10) bottom of pons,
anterior margin; (11) optic chiasm; (12) frontal pole,
extension of a line from landmark 1 through  landmark 2 until it
intersects the dura; (13) superior colliculus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schizophrenia.dat)</code></pre>


<h3>Format</h3>

<p>schizophrenia$x : An array of dimension 13 x 2 x 28
</p>
<p>schizophrenia$group : A factor of group labels &lsquo;con&rsquo; for Controls and &lsquo;scz&rsquo; for 
the schizophrenia patients. 
</p>


<h3>Source</h3>

<p>Bookstein, F. L. (1996). Biometrics, biomathematics and the morphometric synthesis,
Bulletin of Mathematical Biology, 58, 313&ndash;365.
</p>


<h3>References</h3>

<p>Data kindly provided by Fred Bookstein (University of Washington and University of Vienna)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schizophrenia)
plotshapes(schizophrenia$x,symbol=as.integer(schizophrenia$group))
</code></pre>

<hr>
<h2 id='schizophrenia.dat'>Bookstein's schizophrenia data</h2><span id='topic+schizophrenia.dat'></span>

<h3>Description</h3>

<p>Bookstein's schizophrenia data. 13 landmarks
in 2 dimensions, 28 individuals.
The first 14 individuals are controls. The last fourteen cases
were diagnosed with schizophrenia.
The landmarks were taken in the near midline from MR images of the brain:
(1) splenium, posteriormost point on corpus callosum; (2) genu,
anteriormost point on corpus callosum; (3) top of corpus callosum,
uppermost point on arch of callosum (all three to an
approximate registration on the diameter of the callosum);
(4) top of head, a point relaxed from a standard landmark
along the apparent margin of the dura; (5) tentorium of
cerebellum at dura; (6) top of cerebellum; (7) tip of
fourth ventricle; (8) bottom of cerebellum;
(9) top of pons, anterior margin; (10) bottom of pons,
anterior margin; (11) optic chiasm; (12) frontal pole,
extension of a line from landmark 1 through  landmark 2 until it
intersects the dura; (13) superior colliculus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schizophrenia.dat)</code></pre>


<h3>Format</h3>

<p>An array of dimension 13 x 2 x 28
</p>


<h3>Source</h3>

<p>Bookstein, F. L. (1996). Biometrics, biomathematics and the morphometric synthesis,
Bulletin of Mathematical Biology, 58, 313&ndash;365.
</p>


<h3>References</h3>

<p>Data kindly provided by Fred Bookstein (University of Washington and University of Vienna)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schizophrenia.dat)
k&lt;-dim(schizophrenia.dat)[1]
n&lt;-dim(schizophrenia.dat)[3]
plotshapes(schizophrenia.dat)
</code></pre>

<hr>
<h2 id='shapepca'>Principal components analysis for shape</h2><span id='topic+shapepca'></span>

<h3>Description</h3>

<p>Provides graphical summaries of principal components for shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapepca(proc, pcno = c(1, 2, 3), type = "r", mag = 1, joinline = c(1, 1), 
           project=c(1,2),scores3d=FALSE,color=2,axes3=FALSE,rglopen=TRUE,zslice=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shapepca_+3A_proc">proc</code></td>
<td>
<p>List given by the output from <code>procGPA()</code> </p>
</td></tr>
<tr><td><code id="shapepca_+3A_pcno">pcno</code></td>
<td>
<p>A vector of the PCs to be plotted</p>
</td></tr>
<tr><td><code id="shapepca_+3A_type">type</code></td>
<td>
<p>Options for the types of plot for the $m=2$ planar case:
&quot;r&quot; : rows along PCs evaluated at c = -3,0,3 sd's along PC,
&quot;v&quot; : vectors drawn from mean to +3 sd's along PC,
&quot;s&quot; : plots along c= -3, -2, -1, 0, 1, 2, 3 superimposed,
&quot;m&quot; : movie backward and forwards from -3 to +3 sd's along PC,
&quot;g&quot; : TPS grid from mean to +3 sd's along PC.
</p>
</td></tr>
<tr><td><code id="shapepca_+3A_mag">mag</code></td>
<td>
<p>Magnification of the effect of the PC (scalar multiple of sd's)</p>
</td></tr>
<tr><td><code id="shapepca_+3A_joinline">joinline</code></td>
<td>
<p>A vector stating which landmarks are joined up by lines,
e.g. joinline=c(1:n,1) will start at landmark 1, join to 2, ..., join to n, then
re-join to landmark 1.</p>
</td></tr>
<tr><td><code id="shapepca_+3A_project">project</code></td>
<td>
<p>The default orthogonal projections if in higher than 2 dimensions</p>
</td></tr>
<tr><td><code id="shapepca_+3A_scores3d">scores3d</code></td>
<td>
<p>Logical. If TRUE then a 3D scatterplot of the first 3 raw PC scores with 
labels in &lsquo;pcno&rsquo; is given, instead 
of the default plot of the mean and PC vectors.</p>
</td></tr>
<tr><td><code id="shapepca_+3A_color">color</code></td>
<td>
<p>Color of the spheres used in plotting. Default color = 2 (red). 
If a vector is given then the points are colored in that order.</p>
</td></tr>
<tr><td><code id="shapepca_+3A_axes3">axes3</code></td>
<td>
<p>Logical. If TRUE then the axes are plotted in a 3D plot.</p>
</td></tr>
<tr><td><code id="shapepca_+3A_rglopen">rglopen</code></td>
<td>
<p>Logical. If TRUE open a new RGL window, otherwise plot in current window.</p>
</td></tr>
<tr><td><code id="shapepca_+3A_zslice">zslice</code></td>
<td>
<p>For 3D case, type = &quot;g&quot;: the z co-ordinate(s) for the grid slice(s)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean and PCs are plotted. 
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 7.</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>#2d example
data(gorf.dat)
data(gorm.dat)

gorf&lt;-procGPA(gorf.dat)
gorm&lt;-procGPA(gorm.dat)
shapepca(gorf,type="r",mag=3)
shapepca(gorf,type="v",mag=3)
shapepca(gorm,type="r",mag=3)
shapepca(gorm,type="v",mag=3)

#3D example
#data(macm.dat)
#out&lt;-procGPA(macm.dat)
#movie
#shapepca(out,pcno=1)
</code></pre>

<hr>
<h2 id='shapes-internal'>Internal function(s)</h2><span id='topic+sphere1.f'></span><span id='topic+rgl.sphgrid1'></span><span id='topic+sph2car1'></span><span id='topic+pc2sphere2'></span><span id='topic+pcscore2sphere2'></span><span id='topic+preshape2shape'></span><span id='topic+tangentcoords.partial.inv'></span><span id='topic+multiply_by_transpose_of_helmert_implicitly'></span><span id='topic+multiply_by_helmert_implicitly_3d'></span><span id='topic+uji3_centroid.size'></span><span id='topic+uji2_centroid.size'></span><span id='topic+multiply_by_transpose_of_helmert_explicitly'></span><span id='topic+multiply_by_transpose_of_helmert'></span><span id='topic+multiply_by_helmert_implicitly'></span><span id='topic+multiply_by_helmert_explicitly'></span><span id='topic+multiply_by_helmert'></span><span id='topic+uji_preshape'></span><span id='topic+uji_centroid.size'></span><span id='topic+uji_defh'></span><span id='topic+uji_Enorm'></span><span id='topic+uji_distProcrustesFull'></span><span id='topic+uji_distProcrustesSizeShape'></span><span id='topic+uji_distCholesky'></span><span id='topic+uji_estSS'></span><span id='topic+uji_estShape'></span><span id='topic+uji_centroid.size.complex'></span><span id='topic+uji_centroid.size.mD'></span><span id='topic+uji_preshape.mD'></span><span id='topic+uji_preshape.mat'></span><span id='topic+uji_tanfigure'></span><span id='topic+uji_tanfigurefull'></span><span id='topic+uji_kendall.shpv'></span><span id='topic+ild_preshape'></span><span id='topic+ild_centroid.size'></span><span id='topic+ild_defh'></span><span id='topic+ild_Enorm'></span><span id='topic+ild_distProcrustesFull'></span><span id='topic+ild_distProcrustesSizeShape'></span><span id='topic+ild_distCholesky'></span><span id='topic+ild_estSS'></span><span id='topic+ild_estShape'></span><span id='topic+ild_centroid.size.complex'></span><span id='topic+ild_centroid.size.mD'></span><span id='topic+ild_preshape.mD'></span><span id='topic+ild_preshape.mat'></span><span id='topic+ild_tanfigure'></span><span id='topic+ild_tanfigurefull'></span><span id='topic+ild_kendall.shpv'></span><span id='topic+ild_preshapetoicon'></span><span id='topic+Enormalize'></span><span id='topic+ExpNPd'></span><span id='topic+LRTpval'></span><span id='topic+LogNPd'></span><span id='topic+PNSe2s'></span><span id='topic+PNSs2e'></span><span id='topic+Plot3D'></span><span id='topic+Procrustes.dist.full'></span><span id='topic+UNIFORMdirections'></span><span id='topic+col2RGB'></span><span id='topic+flipud0'></span><span id='topic+geodmeanS1'></span><span id='topic+get.data.subsphere'></span><span id='topic+get.prinarc'></span><span id='topic+get.prinarc.subsphere'></span><span id='topic+get.prinarc.value'></span><span id='topic+getSubSphere'></span><span id='topic+mod'></span><span id='topic+objfn'></span><span id='topic+pc2sphere'></span><span id='topic+pcscore2sphere'></span><span id='topic+plotshapes3d.pns'></span><span id='topic+pns.pc'></span><span id='topic+project.subsphere'></span><span id='topic+randvonMisesFisherm'></span><span id='topic+repmat'></span><span id='topic+rot.mat'></span><span id='topic+rotMat'></span><span id='topic+shape.pcscores'></span><span id='topic+shape.pcscores.partial'></span><span id='topic+sphere.jac'></span><span id='topic+sphere.obj'></span><span id='topic+sphere.res'></span><span id='topic+sphere2pcscore'></span><span id='topic+sphereFit'></span><span id='topic+tangent.coords.partial'></span><span id='topic+tr'></span><span id='topic+trans.subsphere'></span><span id='topic+vMFtest'></span><span id='topic+ped'></span><span id='topic+pedreg'></span><span id='topic+sooty.dat'></span><span id='topic+MDSshape'></span><span id='topic+distCholesky'></span><span id='topic+distEuclidean'></span><span id='topic+distLogEuclidean'></span><span id='topic+distPowerEuclidean'></span><span id='topic+distProcrustesFull'></span><span id='topic+distProcrustesSizeShape'></span><span id='topic+rootmat'></span><span id='topic+distRiemPennec'></span><span id='topic+Enorm'></span><span id='topic+estChol'></span><span id='topic+estShapes'></span><span id='topic+estEuclid'></span><span id='topic+estLogEuclid'></span><span id='topic+estPowerEuclid'></span><span id='topic+estLogRiem2'></span><span id='topic+distRiemannianLe'></span><span id='topic+estCholesky'></span><span id='topic+estRiemLe'></span><span id='topic+estShape'></span><span id='topic+estSS'></span><span id='topic+Hessian2'></span><span id='topic+iglogl'></span><span id='topic+Lambdamin'></span><span id='topic+nsa'></span><span id='topic+protein'></span><span id='topic+James'></span><span id='topic+select'></span><span id='topic+procWGPA1'></span><span id='topic+rotatexyz'></span><span id='topic+objfun'></span><span id='topic+objfun4'></span><span id='topic+bootstraptest'></span><span id='topic+testmeanshapes.old'></span><span id='topic+permutationtest2'></span><span id='topic+Goodall'></span><span id='topic+Hotelling'></span><span id='topic+abind'></span><span id='topic+tpsgrid.old'></span><span id='topic+shaperw'></span><span id='topic+BoxM'></span><span id='topic+Goodall2D'></span><span id='topic+Goodalltest'></span><span id='topic+Hotelling2D'></span><span id='topic+Hotelling2Djames'></span><span id='topic+Hotellingtest'></span><span id='topic+MGM'></span><span id='topic+I2mat'></span><span id='topic+TPSgrid'></span><span id='topic+V'></span><span id='topic+Vinv'></span><span id='topic+Vmat'></span><span id='topic+add'></span><span id='topic+as.3d'></span><span id='topic+banner1'></span><span id='topic+banner4'></span><span id='topic+bendingenergy'></span><span id='topic+bgpa'></span><span id='topic+bookstein.shpv'></span><span id='topic+bookstein.shpv.complex'></span><span id='topic+braincon.dat'></span><span id='topic+brainscz.dat'></span><span id='topic+cbevec'></span><span id='topic+cbevectors'></span><span id='topic+centroid.size.complex'></span><span id='topic+centroid.size.mD'></span><span id='topic+close1'></span><span id='topic+cnt3'></span><span id='topic+complextoreal'></span><span id='topic+defh'></span><span id='topic+defplotsize2'></span><span id='topic+defplotsize3'></span><span id='topic+del'></span><span id='topic+dif'></span><span id='topic+dif.old'></span><span id='topic+dis'></span><span id='topic+fJ'></span><span id='topic+fcel'></span><span id='topic+fcnt'></span><span id='topic+fgpa'></span><span id='topic+fgpa.rot'></span><span id='topic+fgpa.singleiteration'></span><span id='topic+fopa'></span><span id='topic+fort.ROTATEANDREFLECT'></span><span id='topic+fort.ROTATION'></span><span id='topic+fort'></span><span id='topic+fos'></span><span id='topic+fos.REFLECT'></span><span id='topic+ftrsq'></span><span id='topic+full.procdist'></span><span id='topic+genpower'></span><span id='topic+goodall2d'></span><span id='topic+goodalltest'></span><span id='topic+graf'></span><span id='topic+hotelling2d'></span><span id='topic+hotellingtest'></span><span id='topic+isodens'></span><span id='topic+isologdens'></span><span id='topic+isomle'></span><span id='topic+isotropy.test'></span><span id='topic+kendall.shpv'></span><span id='topic+linegrid'></span><span id='topic+loglikeiso'></span><span id='topic+loglikeiso2'></span><span id='topic+loneFone'></span><span id='topic+mahpreshapedist'></span><span id='topic+makearray'></span><span id='topic+movie'></span><span id='topic+msh'></span><span id='topic+norm'></span><span id='topic+objfuniso'></span><span id='topic+oneFone'></span><span id='topic+partial.procdist'></span><span id='topic+partialwarpgrids'></span><span id='topic+partialwarps'></span><span id='topic+permutationtest'></span><span id='topic+plot2rwscores'></span><span id='topic+plot3Ddata'></span><span id='topic+plot3Ddata.static'></span><span id='topic+plot3Dmean'></span><span id='topic+plot3Dpca'></span><span id='topic+plotPDM'></span><span id='topic+plotPDM2'></span><span id='topic+plotPDM3'></span><span id='topic+plotPDMbook'></span><span id='topic+plotPDMnoaxis'></span><span id='topic+plotPDMnoaxis3'></span><span id='topic+plotpairscores'></span><span id='topic+plotpca'></span><span id='topic+plotpca3d'></span><span id='topic+plotprinwarp'></span><span id='topic+plotproc'></span><span id='topic+plotrelwarp'></span><span id='topic+plotshapes3d'></span><span id='topic+plotshapestime3d'></span><span id='topic+pointsPDMnoaxis3'></span><span id='topic+prcomp1'></span><span id='topic+preshape'></span><span id='topic+preshape.mD'></span><span id='topic+preshape.mat'></span><span id='topic+preshapetoicon'></span><span id='topic+prinwscoregrids'></span><span id='topic+procdistreflect'></span><span id='topic+procrustes2d'></span><span id='topic+procrustesGPA'></span><span id='topic+procrustesGPA.rot'></span><span id='topic+procrustesgpa'></span><span id='topic+project'></span><span id='topic+read.array'></span><span id='topic+read.in'></span><span id='topic+realtocomplex'></span><span id='topic+reassqpr'></span><span id='topic+relwarps'></span><span id='topic+rgpa'></span><span id='topic+riemdist.complex'></span><span id='topic+riemdist.mD'></span><span id='topic+rotateaxes'></span><span id='topic+schizo.dat'></span><span id='topic+sgpa'></span><span id='topic+sh'></span><span id='topic+sigmacov'></span><span id='topic+sim1'></span><span id='topic+st'></span><span id='topic+tanfigure'></span><span id='topic+tanfigurefull'></span><span id='topic+tanpreshape'></span><span id='topic+testshapes'></span><span id='topic+vec1'></span>

<h3>Description</h3>

<p>Internal function(s)</p>

<hr>
<h2 id='shapes.cva'>Canonical variate analysis for shapes</h2><span id='topic+shapes.cva'></span>

<h3>Description</h3>

<p>Carry out canonical variate analysis for shapes (in two or more groups)    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapes.cva(X,groups,scale=TRUE,tangentcoords = "residual",ncv=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shapes.cva_+3A_x">X</code></td>
<td>
<p>Input k x m x n real array of the configurations, 
where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="shapes.cva_+3A_groups">groups</code></td>
<td>
<p>The group labels</p>
</td></tr>      
<tr><td><code id="shapes.cva_+3A_scale">scale</code></td>
<td>
<p>Logical, indicating if Procrustes 
scaling should be carried out</p>
</td></tr>
<tr><td><code id="shapes.cva_+3A_tangentcoords">tangentcoords</code></td>
<td>
<p>The type of Procrustes tangent coordinates to use (as for procGPA)</p>
</td></tr>
<tr><td><code id="shapes.cva_+3A_ncv">ncv</code></td>
<td>
<p>Number of canonical variates to display</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot if ncv=2 or 3 and the Canonical Variate Scores</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester.</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male apes   (cf. Dryden and Mardia, 2016)

data(pongof.dat)
data(pongom.dat) 
data(panm.dat)
data(panf.dat)

apes   &lt;- groupstack( pongof.dat , pongom.dat , panm.dat, panf.dat )

shapes.cva( apes$x, apes$groups) 
</code></pre>

<hr>
<h2 id='shapes3d'>Plot 3D data</h2><span id='topic+shapes3d'></span>

<h3>Description</h3>

<p>Plot the landmark configurations from a 3D dataset</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapes3d(x,loop=0,type="p", color = 2, joinline=c(1:1), axes3=FALSE, rglopen=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shapes3d_+3A_x">x</code></td>
<td>
<p>An array of size k x 3 x n, where k is the number of landmarks
and n is the number of observations</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_loop">loop</code></td>
<td>
<p>gives the number of times an animated loop through the observations is
displayed (in order 1 to n). loop &gt; 0 is suitable when a time-series of shapes
is available. loop = 0 gives a plot of all the observations on the same figure.
</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_type">type</code></td>
<td>
<p>Type of plot: &quot;p&quot; points, &quot;dots&quot; dots (quicker for large plots), &quot;l&quot; dots and  
lines though landmarks 1:k if &lsquo;joinline&rsquo; not stated</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_color">color</code></td>
<td>
<p>Colour of points (default color = 2 (red)). If a vector is given then the points 
are coloured in that order.</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_joinline">joinline</code></td>
<td>
<p>Join the numbered landmarks by lines</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_axes3">axes3</code></td>
<td>
<p>Logical. If TRUE then plot the axes.</p>
</td></tr>
<tr><td><code id="shapes3d_+3A_rglopen">rglopen</code></td>
<td>
<p>Logical. If TRUE then open a new RGL window, if FALSE then plot in current window.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dna.dat)
shapes3d(dna.dat)
</code></pre>

<hr>
<h2 id='shells'>Microfossil shell data</h2><span id='topic+shells'></span>

<h3>Description</h3>

<p>Microfossil shell data. Triangles from 21 individuals. 
Lohmann (1983) published 21 mean outlines of the microfossil which were 
based on random samples of organisms taken at different 
latitudes in the South Indian Ocean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shells)</code></pre>


<h3>Format</h3>

<p>shells$uv    Scaled shape coordinates (Bookstein shape co-ordinates 
with base (0,0) and (1,0). 
shells$size  Centroid size 
</p>


<h3>Source</h3>

<p>Bookstein, F. L. (1986). Size and shape spaces for landmark data in two dimensions (with discussion).
Statistical Science, 1:181-242.
</p>
<p>Lohmann, G. P. (1983). Eigenshape analysis of microfossils: a general morphometric procedure for
describing changes in shape. Mathematical Geology, 15:659-672.
</p>


<h3>References</h3>

<p>The data have been extracted from Fig. 7 of Bookstein (1986). 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shells)
plotshapes(shells$uv)
</code></pre>

<hr>
<h2 id='sooty'>Sooty mangabey data</h2><span id='topic+sooty'></span>

<h3>Description</h3>

<p>Sooty mangabey data skull data. 12 landmarks 
in 2 dimensions, 2 individuals (juvenile and male adult) followed by 
three individuals, female adult, male adult. The first entries are rotated, translated versions of
the 3rd and 7th figure. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sooty)</code></pre>


<h3>Format</h3>

<p>An array of dimension 12 x 2 x 7
</p>


<h3>Source</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 1.
</p>


<h3>References</h3>

<p>Data from Paul O'Higgins (Hull-York Medical School)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sooty)
plotshapes(sooty,joinline=c(1:12,1))
</code></pre>

<hr>
<h2 id='ssriemdist'>Riemannian size-and-shape distance</h2><span id='topic+ssriemdist'></span>

<h3>Description</h3>

<p>Calculates the Riemannian size-and-shape distance d_S between two
configurations</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssriemdist(x, y, reflect=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssriemdist_+3A_x">x</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data) 
where k = number of landmarks and m = no of dimensions</p>
</td></tr> 
<tr><td><code id="ssriemdist_+3A_y">y</code></td>
<td>
<p>k x m matrix  (or complex k-vector  for 2D data)</p>
</td></tr> 
<tr><td><code id="ssriemdist_+3A_reflect">reflect</code></td>
<td>
<p> Logical. If reflect = TRUE then reflection invariance is included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Riemannian size-and-shape distance d_S between the two configurations. 
(for the Riemannian shape distance use riemdist)
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Le, H.-L. (1995). Mean size-and-shapes and mean shapes: a geometric point of
view. Advances in Applied Probability, 27:44-55.
</p>


<h3>See Also</h3>

<p>procOPA,procGPA,riemdist</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
data(gorm.dat)
gorf&lt;-procGPA(gorf.dat,scale=FALSE)
gorm&lt;-procGPA(gorm.dat,scale=FALSE)
ds&lt;-ssriemdist(gorf$mshape,gorm$mshape)
cat("Riemannian size-and-shape distance between mean size-and-shapes is ",ds," \n")
</code></pre>

<hr>
<h2 id='steroids'>Steroid data</h2><span id='topic+steroids'></span>

<h3>Description</h3>

<p>Steroid data. Between 42 and 61 atoms for each of 31 steroid molecules. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(steroids)</code></pre>


<h3>Format</h3>

<p>steroids$x : An array of dimension 61 x 3 x 31 of 3D co-ordinates of the 31 steroids. 
If a molecules has less than 61 atoms then the remaining co-ordinates are all zero.  
</p>
<p>steroids$activity : Activity class (&lsquo;1&rsquo; = high, &lsquo;2&rsquo; = intermediate, and &lsquo;3&rsquo; = low 
binding affinities to the corticosteroid
binding globulin (CBG) receptor)
</p>
<p>steroids$radius : van der Waals radius (0 = missing value)
</p>
<p>steoirds$atom : atom type (0 = missing value)
</p>
<p>steroids$charge : partial charge (0 = missing value)
</p>
<p>steroids$names : steroid names
</p>


<h3>Source</h3>

<p>This particular version of the steroids data set of (x, y, z) atom co-ordinates and partial charges was constructed by 
Jonathan Hirst and James Melville (School of Chemistry, University of Nottingham). 
</p>
<p>Also see Wagener, M., Sadowski, J., Gasteiger, J. (1995).
J. Am. Chem. Soc., 117, 7769-7775.
</p>
<p>http://www2.ccc.uni-erlangen.de/services/steroids/
</p>


<h3>References</h3>

<p>Dryden, I.L., Hirst, J.D. and Melville, J.L. (2007). Statistical analysis of unlabelled point sets: comparing molecules in chemoinformatics.
Biometrics, 63, 237-251.
</p>
<p>Czogiel I., Dryden, I.L. and Brignell, C.J. (2011). Bayesian matching of unlabeled point sets using
random fields, with an application to molecular alignment. Annals of Applied Statistics, 5, 2603-2629.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(steroids)
shapes3d(steroids$x[,,1])
</code></pre>

<hr>
<h2 id='testmeanshapes'>Tests for mean shape difference, including permutation and bootstrap tests</h2><span id='topic+testmeanshapes'></span>

<h3>Description</h3>

<p>Carries out tests to examine differences in mean shape
between two independent populations, for $m=2$ or $m=3$ dimensional data. 
Tests are carried out using tangent co-ordinates. 
</p>
<p>H : Hotelling $T^2$ statistic (see Dryden and Mardia, 2016, equ.(9.4))
</p>
<p>G : Goodall's F statistic (see Dryden and Mardia, 2016, equ.(9.9))
</p>
<p>J : James $T^2$ statistic (see Amaral et al., 2007)
</p>
<p>p-values are given based on resampling (either a bootstrap test or a permutation test) 
as well as the usual table based p-values. Bootstrap tests involve sampling with replacement under H0 
(as in Amaral et al., 2007). 
</p>
<p>Note when the sample sizes are low (compared to the number of landmarks) some minor regularization 
is carried out. In particular if Sw is a singular within group covariance matrix, it is replaced by 
Sw + 0.000001 (Identity matrix) and a &lsquo;*&rsquo; is printed in the output. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testmeanshapes(A, B, resamples = 1000, replace = FALSE, scale= TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testmeanshapes_+3A_a">A</code></td>
<td>
<p>The random sample for group 1: k x m x n1 array of data, where
k is the number of landmarks and n1 is the sample size. (Alternatively a k x n1 complex matrix for 2D)</p>
</td></tr>
<tr><td><code id="testmeanshapes_+3A_b">B</code></td>
<td>
<p>The random sample for group 2: k x m x n2 array of data, where
k is the number of landmarks and n2 is the sample size. (Alternatively a k x n2 complex matrix for 2D)</p>
</td></tr>
<tr><td><code id="testmeanshapes_+3A_resamples">resamples</code></td>
<td>
<p>Integer. The number of resampling iterations. If resamples = 0 then no resampling
procedures are carried out, and the tabular p-values are given only.</p>
</td></tr>
<tr><td><code id="testmeanshapes_+3A_replace">replace</code></td>
<td>
<p>Logical. If replace = TRUE then bootstrap resampling is
carried out with replacement *within* each group. If replace = FALSE then permutation 
resampling is carried out (sampling without replacement in *pooled* samples).</p>
</td></tr>
<tr><td><code id="testmeanshapes_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether or not to carry out Procrustes with scaling in the procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components 
</p>
<table>
<tr><td><code>H</code></td>
<td>
<p>The Hotelling statistic (F statistic)</p>
</td></tr>
<tr><td><code>H.pvalue</code></td>
<td>
<p>p-value for the Hotelling test based on resampling</p>
</td></tr>
<tr><td><code>H.table.pvalue</code></td>
<td>
<p>p-value for the Hotelling test based on the null F distribution, assuming normality
and equal covariance matrices</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>The James $T^2$ statistic</p>
</td></tr>
<tr><td><code>J.pvalue</code></td>
<td>
<p>p-value for the James $T^2$ test based on resampling</p>
</td></tr>
<tr><td><code>J.table.pvalue</code></td>
<td>
<p>p-value for the James $T^2$ test based on the null F distribution, assuming normality
but unequal covariance matrices</p>
</td></tr>   
<tr><td><code>G</code></td>
<td>
<p>The Goodall $F$ statistic</p>
</td></tr>
<tr><td><code>G.pvalue</code></td>
<td>
<p>p-value for the Goodall test based on resampling</p>
</td></tr>
<tr><td><code>G.table.pvalue</code></td>
<td>
<p>p-value for the Goodall test based on the null F distribution, assuming normality and
equal isotropic covariance matrices)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Amaral, G.J.A., Dryden, I.L. and Wood, A.T.A. (2007) Pivotal bootstrap methods for 
$k$-sample problems in directional statistics and shape analysis.  Journal of the American Statistical Association.   102, 695-707. 
</p>
<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with applications in R (Second Edition). Wiley, Chichester. Chapter 9.
</p>
<p>Goodall, C. R. (1991). Procrustes methods in the statistical analysis
of shape (with discussion). Journal of the Royal Statistical Society,
Series B, 53: 285-339.
</p>


<h3>See Also</h3>

<p>resampletest</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas

data(gorf.dat)
data(gorm.dat)

A&lt;-gorf.dat
B&lt;-gorm.dat
testmeanshapes(A,B,resamples=100)

</code></pre>

<hr>
<h2 id='tpsgrid'>Thin-plate spline transformation grids</h2><span id='topic+tpsgrid'></span>

<h3>Description</h3>

<p>Thin-plate spline transformation grids from one set of landmarks 
to another. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tpsgrid(TT, YY, xbegin=-999, ybegin=-999, xwidth=-999, opt=1, ext=0.1, ngrid=22, 
                  cex=1, pch=20, col=2,zslice=0, mag=1, axes3=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tpsgrid_+3A_tt">TT</code></td>
<td>
<p>First object (source): (k x m matrix)</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_yy">YY</code></td>
<td>
<p>Second object (target): (k x m matrix)</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_xbegin">xbegin</code></td>
<td>
<p>lowest x value for plot: if -999 then a value is determined</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_ybegin">ybegin</code></td>
<td>
<p>lowest y value for plot: if -999 then a value is determined </p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_xwidth">xwidth</code></td>
<td>
<p>width of plot: if -999 then a value is determined</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_opt">opt</code></td>
<td>
<p>Option 1: (just deformed grid on YY is displayed), 
option 2: both grids are displayed</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_ext">ext</code></td>
<td>
<p>Amount of border on plot in 2D case.</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_ngrid">ngrid</code></td>
<td>
<p>Number of grid points: size is ngrid * (ngrid -1)</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_cex">cex</code></td>
<td>
<p>Point size</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_pch">pch</code></td>
<td>
<p>Point symbol</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_col">col</code></td>
<td>
<p>Point colour</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_zslice">zslice</code></td>
<td>
<p>For 3D case the scaled z co-ordinate(s) for the grid slice(s). The 
values are on a standardized scale as a proportion of height from the middle of 
the z-axis to the top and bottom. Values in the range -1 to 1 would be sensible.</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_mag">mag</code></td>
<td>
<p>Exaggerate effect (mag &gt; 1). Standard effect has mag=1.</p>
</td></tr>
<tr><td><code id="tpsgrid_+3A_axes3">axes3</code></td>
<td>
<p>Logical. If TRUE then the axes are plotted in a 3D plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A square grid on the first configuration is deformed smoothly using a pair of 
thin-plate splines in 2D, or a triple of splines in 3D, to a curved grid on 
the second object. For 3D data the grid is placed at a constant z-value on the 
first figuure, indicated by the value of zslice. 
</p>
<p>For 2D data the covariance function in the thin-plate spline is 
$sigma(h) = |h|^2 log |h|^2$ and in 3D it is given by $sigma(h) =  -| h |$. 
</p>


<h3>Value</h3>

<p>No returned value
</p>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Bookstein, F.L. (1989). Principal  warps: thin-plate
splines and  the decomposition  of  deformations,
IEEE Transactions on Pattern Analysis and Machine Intelligence,
11, 567&ndash;585. 
</p>
<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester. Chapter 12.
</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gorf.dat)
data(gorm.dat)

#TPS grid with shape change exaggerated (2x)
gorf&lt;-procGPA(gorf.dat)
gorm&lt;-procGPA(gorm.dat)
TT&lt;-gorf$mshape
YY&lt;-gorm$mshape
tpsgrid(TT,YY,mag=2) 
title("TPS grid: Female mean (left) to Male mean (right)")   

</code></pre>

<hr>
<h2 id='transformations'>Calculate similarity transformations</h2><span id='topic+transformations'></span>

<h3>Description</h3>

<p>Calculate similarity transformations between configurations in two arrays. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformations(Xrotated,Xoriginal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformations_+3A_xrotated">Xrotated</code></td>
<td>
<p>Input k x m x n real array of the Procrustes 
transformed configurations, 
where k is the number of points, m 
is the number of dimensions, and n is the sample size. </p>
</td></tr>
<tr><td><code id="transformations_+3A_xoriginal">Xoriginal</code></td>
<td>
<p>Input k x m x n real array of the Procrustes
original configurations,
where k is the number of points, m
is the number of dimensions, and n is the sample size. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components
</p>
<table>
<tr><td><code>translation</code></td>
<td>
<p>The translation parameters. These are the relative translations of the centroids of the individuals.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>The scale parameters</p>
</td></tr>                             
<tr><td><code>rotation</code></td>
<td>
<p>The rotation parameters. These are the rotations between the individuals after they have both been centred.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Ian Dryden</p>


<h3>References</h3>

<p>Dryden, I.L. and Mardia, K.V. (2016). Statistical 
Shape Analysis, with Applications in R (Second Edition). Wiley, Chichester.</p>


<h3>See Also</h3>

<p>procGPA</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#2D example : female and male Gorillas (cf. Dryden and Mardia, 2016)

data(gorf.dat)

Xorig &lt;- gorf.dat
Xrotated &lt;- procGPA(gorf.dat)$rotated

transformations(Xrotated,Xorig)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
