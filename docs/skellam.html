<!DOCTYPE html><html><head><title>Help for package skellam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {skellam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Skellam'><p> The Skellam Distribution</p></a></li>
<li><a href='#skellam.mle'><p> MLE of the Skellam distribution</p></a></li>
<li><a href='#skellam.reg'><p> Regression assuming a Skellam distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-25</td>
</tr>
<tr>
<td>Title:</td>
<td>Densities and Sampling for the Skellam Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>Jerry W. Lewis &lt;Jerry.Lewis@biogen.com&gt;, Patrick E. Brown &lt;patrick.brown@utoronto.ca&gt;, Michail Tsagris &lt;mtsagris@yahoo.gr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick E. Brown &lt;patrick.brown@utoronto.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the Skellam distribution, including: density
    (pmf), cdf, quantiles and regression.</td>
</tr>
<tr>
<td>URL:</td>
<td>https//r-forge.r-project.org/projects/healthqueues/</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>Enhances:</td>
<td>VGAM</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 12:32:33 UTC; patrick</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Skellam'> The Skellam Distribution </h2><span id='topic+Skellam'></span><span id='topic+skellam'></span><span id='topic+dskellam'></span><span id='topic+pskellam'></span><span id='topic+qskellam'></span><span id='topic+rskellam'></span><span id='topic+dskellam.sp'></span><span id='topic+pskellam.sp'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number
generation for the Skellam distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dskellam(x, lambda1, lambda2 = lambda1, log = FALSE)
pskellam(q, lambda1, lambda2 = lambda1, 
    lower.tail = TRUE, log.p = FALSE)
qskellam(p, lambda1, lambda2 = lambda1, 
    lower.tail = TRUE, log.p = FALSE)
rskellam(n, lambda1, lambda2 = lambda1)
dskellam.sp(x, lambda1, lambda2 = lambda1, log = FALSE)
pskellam.sp(q, lambda1, lambda2 = lambda1, 
    lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Skellam_+3A_x">x</code>, <code id="Skellam_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="Skellam_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="Skellam_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>,
the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="Skellam_+3A_lambda1">lambda1</code>, <code id="Skellam_+3A_lambda2">lambda2</code></td>
<td>
<p>vectors of (non-negative) means.</p>
</td></tr>
<tr><td><code id="Skellam_+3A_log">log</code>, <code id="Skellam_+3A_log.p">log.p</code></td>
<td>
<p> logical; if <code>TRUE</code>, probabilities p are given 
as log(p). </p>
</td></tr>
<tr><td><code id="Skellam_+3A_lower.tail">lower.tail</code></td>
<td>
<p> logical; if <code>TRUE</code> 
(default), probabilities are <code class="reqn">P[X \le x]</code>,
otherwise, <code class="reqn">P[X &gt; x]</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">Y_1</code> and <code class="reqn">Y_2</code> are Poisson variables with means 
<code class="reqn">\mu_1</code> and <code class="reqn">\mu_2</code>
and correlation <code class="reqn">\rho</code>, then <code class="reqn">X = Y_1 - Y_2</code> is Skellam with parameters
<code class="reqn">\lambda_1 = \mu_1 - \rho \sqrt{\mu_1 \mu_2}</code> and 
<code class="reqn">\lambda_2 = \mu_2 - \rho \sqrt{\mu_1 \mu_2}</code>.
</p>
<p><code>dskellam</code> returns a value equivalent to
</p>
<p style="text-align: center;"><code class="reqn">I(2 \sqrt{\lambda_1 \lambda_2}, |x|)  
    (\lambda_1/\lambda_2)^{x/2} \exp(-\lambda_1-\lambda_2)</code>
</p>

<p>where <code class="reqn">I(y,\nu)</code> is the modified Bessel function of the first kind.
The <code class="reqn">|x|</code> differs from most Skellam expressions in the literature, but is correct since <code class="reqn">x</code> is an integer, 
resulting in improved portability and (in R versions prior to 2.9) improved accuracy for <code class="reqn">x&lt;0</code>.
Exponential scaling is used in <code><a href="base.html#topic+besselI">besselI</a></code> to postpone numerical problems. 
When numerical problems do occur, a saddlepoint approximation is substituted,
which typically gives at least 4-figure accuracy.
An alternative representation is
<code class="reqn">dchisq(2 \lambda_1,2(x+1),2\lambda_2) 2</code>
for <code class="reqn">x \ge 0</code>, and
<code class="reqn">dchisq(2 \lambda_2,2(1-x),2\lambda_1) 2</code>
for <code class="reqn">x \le 0</code>; but in R <code>besselI</code> appears to be more accurately implemented
(for very small probabilities) than <code>dchisq</code>.
</p>
<p><code>pskellam(x,lambda1,lambda2)</code> returns
<code>pchisq(2*lambda2, -2*x, 2*lambda1)</code>
for <code class="reqn">x&lt;=0</code> and
<code>1 - pchisq(2*lambda1, 2*(x+1), 2*lambda2)</code>
for <code class="reqn">x&gt;=0</code>.
When <code><a href="stats.html#topic+pchisq">pchisq</a></code> incorrectly returns 0, a saddlepoint approximation is substituted,
which typically gives at least 2-figure accuracy.
</p>
<p>The quantile is defined as the smallest value <code class="reqn">x</code> such that
<code class="reqn">F(x) \ge p</code>, where <code class="reqn">F</code> is the distribution function.
For <code>lower.tail=FALSE</code>, the quantile is defined as the largest value <code class="reqn">x</code> such that
<code class="reqn">F(x,</code><code>lower.tail=FALSE</code><code class="reqn">) \le p</code>.
</p>
<p><code>rskellam</code> is calculated as <code>rpois(n,lambda1)-rpois(n,lambda2)</code>
</p>
<p><code>dskellam.sp</code> and <code>pskellam.sp</code> return saddlepoint approximations to the pmf and cdf.
They are called by <code>dskellam</code> and <code>pskellam</code> when results from primary methods are in doubt.
</p>


<h3>Value</h3>

<p><code>dskellam</code> gives the (log) density, <code>pskellam</code> gives the (log) distribution function,
<code>qskellam</code> gives the quantile function, and <code>rskellam</code> generates random deviates. 
Invalid <code>lambda</code>s will result in return value <code>NaN</code>, with a warning.
</p>


<h3>Note</h3>

<p>The <span class="pkg">VGAM</span> package
also contains <a href="VGAM.html#topic+Skellam">Skellam</a> functions, which are syntactically similar;
independently developed versions are included here for completeness.
Moreover, this <code>dskellam</code> function offers a broader working range,
correct handling of cases where at least one rate parameter is zero,
enhanced argument checking,
and (in R versions prior to 2.9) improved accuracy for <code class="reqn">x&lt;0</code>.
If both packages are loaded,
<code>skellam::dskellam</code>
or
<code>VGAM::dskellam</code>
can unambiguously specify which implementation to use.
</p>


<h3>Author(s)</h3>

<p> Jerry W. Lewis, Patrick E. Brown</p>


<h3>Source</h3>

<p>The relation of <code>dgamma</code> to the modified Bessel function of the first kind
was given by Skellam (1946).
The relation of <code>pgamma</code> to the noncentral chi-square was given by Johnson (1959).
Tables are given by Strackee and van der Gon (1962), which can be used to verify this implementation 
(cf. direct calculation in the examples below).
</p>
<p><code>qskellam</code> uses the Cornish&ndash;Fisher expansion to include skewness and kurtosis
corrections to a normal approximation, followed by a search.
If <code>getOption("verbose")==TRUE</code>, then <code>qskellam</code> will not use <code><a href="stats.html#topic+qpois">qpois</a></code>
when one of the <code>lambda</code>s is zero,
in order to verify that this search algorithm has been implemented properly.
</p>


<h3>References</h3>

<p>Butler, R. (2007) <em>Saddlepoint Approximations with Applications</em>,
Cambridge University Press, Cambridge &amp; New York, p.17.
</p>
<p>Johnson, N. L. (1959) On an extension of the connection between Poisson and <code class="reqn">\chi^2</code> distributions.
<em>Biometrika</em> <b>46</b>, 352&ndash;362.
</p>
<p>Johnson, N. L.; Kotz, S.; Kemp, A. W. (1993) <em>Univariate Discrete Distributions</em>, 2nd ed.,
John Wiley and Sons, New York, pp.190-192.
</p>
<p>Skellam, J. G. (1946) The frequency distribution of the difference between two Poisson variates
belonging to different populations. <em>Journal of the Royal Statistical Society, series A</em> <b>109</b>/3, 26.
</p>
<p>Strackee, J.; van der Gon, J. J. D. (1962) The frequency distribution of the difference between two Poisson variates.
<em>Statistica Neerlandica</em> <b>16</b>/1, 17-23.
</p>
<p>Wikipedia. <em>Skellam distribution</em> <a href="https://en.wikipedia.org/wiki/Skellam_distribution">https://en.wikipedia.org/wiki/Skellam_distribution</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require('skellam')

# one lambda = 0 ~ Poisson
c(dskellam(0:10,5,0), dpois(0:10,5))
c(dskellam(-(0:10),0,5), dpois(0:10,5))
c(pskellam(0:10,5,0,lower.tail=TRUE), 
    ppois(0:10,5,lower.tail=TRUE))
c(pskellam(0:10,5,0,lower.tail=FALSE),
    ppois(0:10,5,lower.tail=FALSE))
c(pskellam(-(0:10),0,5,lower.tail=FALSE),
    ppois(0:10-1,5,lower.tail=TRUE))
c(pskellam(-(0:10),0,5,lower.tail=TRUE),
    ppois(0:10-1,5,lower.tail=FALSE))

# both lambdas != 0 ~ convolution of Poissons
dskellam(1,0.5,0.75)  # sum(dpois(1+0:10,0.5)*dpois(0:10,0.75))
pskellam(1,0.5,0.75)  # sum(dskellam(-10:1,0.5,0.75))
dskellam(c(-1,1),c(12,10),c(10,12))  # c(0.0697968,0.0697968)
dskellam(c(-1,1),c(12,10),c(10,12),log=TRUE) 
 # log(dskellam(c(-1,1),c(12,10),c(10,12)))
dskellam(256,257,1)  
# 0.024829348733183769  
# exact result for comparison with saddlepoint
dskellam(-3724,2000,3000)  
# 3.1058145363400105e-308  
# exact result for comparison with saddlepoint 
# (still accurate in extreme tail)
pskellam(c(-1,0),c(12,10),c(10,12))  # c(0.2965079,0.7034921)
pskellam(c(-1,0),c(12,10),c(10,12),lower.tail=FALSE) 
 # 1-pskellam(c(-1,0),c(12,10),c(10,12))
pskellam(-2:2,8.5,10.25,log.p=TRUE)  # log(pskellam(-2:2,8.5,10.25))
qskellam(c(0.05,0.95),3,4)  # c(-5,3); pskellam(cbind(-6:-5,2:3),3,4)
qskellam(c(0.05,0.95),3,0)  # c(1,6); qpois(c(0.05,0.95),3)
rskellam(35,8.5,10.25)
</code></pre>

<hr>
<h2 id='skellam.mle'> MLE of the Skellam distribution</h2><span id='topic+skellam.mle'></span>

<h3>Description</h3>

<p>MLE of the Skellam distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skellam.mle(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skellam.mle_+3A_x">x</code></td>
<td>

<p>A vector of integers, positive or negative.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Instead of having to maximise the log-likelihood with respect 
to the two parameters, <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>, we maximise with respect to 
<code class="reqn">\lambda_2</code> and then <code class="reqn">\lambda_1 = \lambda_2 + \bar{x}</code>. This makes it faster. 
The command &quot;nlm&quot; is used to optimise the log-likelihood as it proved to be faster than the &quot;optimise&quot;. 
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>iters</code></td>
<td>

<p>The number of iterations required by &quot;nlm&quot;.
</p>
</td></tr>  
<tr><td><code>loglik</code></td>
<td>

<p>The maximised log-likelihood value.
</p>
</td></tr>
<tr><td><code>param</code></td>
<td>

<p>The estimated parameters, <code class="reqn">\hat{\lambda}_1</code> and <code class="reqn">\hat{\lambda}_2</code>. 
</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p> Michail Tsagris </p>


<h3>References</h3>

<p>Butler, R. (2007) <em>Saddlepoint Approximations with Applications</em>,
Cambridge University Press, Cambridge &amp; New York, p.17.
</p>
<p>Johnson, N. L. (1959) On an extension of the connection between Poisson and <code class="reqn">chi^2</code> distributions.
<em>Biometrika</em> <b>46</b>, 352&ndash;362.
</p>
<p>Johnson, N. L.; Kotz, S.; Kemp, A. W. (1993) <em>Univariate Discrete Distributions</em>, 2nd ed.,
John Wiley and Sons, New York, pp.190-192.
</p>
<p>Skellam, J. G. (1946) The frequency distribution of the difference between two Poisson variates
belonging to different populations. <em>Journal of the Royal Statistical Society, series A</em> <b>109</b>/3, 26.
</p>
<p>Strackee, J.; van der Gon, J. J. D. (1962) The frequency distribution of the difference between two Poisson variates.
<em>Statistica Neerlandica</em> <b>16</b>/1, 17-23.
</p>
<p>Abdulhamid, A. A.; Maha, A. O. (2010) On The Poisson Difference Distribution Inference and Applications.
<em>BULLETIN of the Malaysian Mathematical Sciences Society</em>, <b>33</b>/1, 17&ndash;45.
</p>
<p>Wikipedia. <em>Skellam distribution</em> <a href="https://en.wikipedia.org/wiki/Skellam_distribution">https://en.wikipedia.org/wiki/Skellam_distribution</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require('skellam')

x1 &lt;- rpois(1000, 10)
x2 &lt;- rpois(1000, 6)
x &lt;- x1 - x2
skellam.mle(x)

x1 &lt;- rpois(10000, 10)
x2 &lt;- rpois(10000, 6)
x &lt;- x1 - x2
skellam.mle(x)
</code></pre>

<hr>
<h2 id='skellam.reg'> Regression assuming a Skellam distribution </h2><span id='topic+skellam.reg'></span>

<h3>Description</h3>

<p>Regression assuming a Skellam distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skellam.reg(y, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skellam.reg_+3A_y">y</code></td>
<td>

<p>A vector of integers, positive or negative.
</p>
</td></tr>
<tr><td><code id="skellam.reg_+3A_x">x</code></td>
<td>

<p>A matrix, a vector or a data.frame with the covariates.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We use the exponential link function to ensure that the both <code class="reqn">\lambda_s</code> are positive. 
The command <code><a href="stats.html#topic+nlm">nlm</a></code> does the main job.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr><td><code>loglik</code></td>
<td>

<p>The maximised log-likelihood value.
</p>
</td></tr>  
<tr><td><code>param1</code></td>
<td>

<p>The estimated regression coefficients of <code class="reqn">\lambda_1</code>. This is matrix, with the first 
column being the estimated regression coefficients. The second column is their relevant standard error.
The third column is the t value (coef/se(coef)) and the final column is the p-value of the Wald test.
</p>
</td></tr>
<tr><td><code>param2</code></td>
<td>

<p>The estimated regression coefficients of <code class="reqn">\lambda_2</code>. This is matrix, with the first 
column being the estimated regression coefficients. The second column is their relevant standard error.
The third column is the t value (coef/se(coef)) and the final column is the p-value of the Wald test.
</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p> Michail Tsagris </p>


<h3>References</h3>

<p>Skellam, J. G. (1946) The frequency distribution of the difference between two Poisson variates
belonging to different populations. <em>Journal of the Royal Statistical Society, series A</em> <b>109</b>/3, 26.
</p>
<p>Strackee, J.; van der Gon, J. J. D. (1962) The frequency distribution of the difference between two Poisson variates.
<em>Statistica Neerlandica</em> <b>16</b>/1, 17-23.
</p>
<p><em>Karlis and Ntzoufras IMA 2009 presentation</em> <a href="http://www2.stat-athens.aueb.gr/~jbn/papers/files/20_Karlis_Ntzoufras_2009_IMA_presentation_handouts_v01.pdf">http://www2.stat-athens.aueb.gr/~jbn/papers/files/20_Karlis_Ntzoufras_2009_IMA_presentation_handouts_v01.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require('skellam')

set.seed(0)

x &lt;- rnorm(1000)
y1 &lt;- rpois(1000, exp(1 + 1 * x) )
y2 &lt;- rpois(1000 , exp(-1 + 1 * x) )
y &lt;- y2 - y1
skellam.reg(y, x)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
