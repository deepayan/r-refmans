<!DOCTYPE html><html lang="en"><head><title>Help for package SEERaBomb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SEERaBomb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SEERaBomb-package'><p> SEER and A-Bomb Data Analysis Tools</p></a></li>
<li><a href='#canc2py'><p>Converts canc made by mkSEER into a data.frame with py at risk after firsts</p></a></li>
<li><a href='#csd'><p>Cancer risk vs years Since Diagnosis of other cancer</p></a></li>
<li><a href='#esd'><p>Event vs years Since Diagnosis</p></a></li>
<li><a href='#fillPYM'><p>Fills age-year person year (PY) matrix</p></a></li>
<li><a href='#getBinInfo'><p>Gets the lower and upper limit and index of a tsd bin</p></a></li>
<li><a href='#getDF'><p>Converts a seerSet$L series to a data.frame</p></a></li>
<li><a href='#getE'><p>Get expected numbers of cases</p></a></li>
<li><a href='#getFields'><p>Get fields from SEER SAS file</p></a></li>
<li><a href='#getPY'><p>Get tsd interval PY</p></a></li>
<li><a href='#incidAbomb'><p>Computes A-bomb incidences</p></a></li>
<li><a href='#incidSEER'><p>Computes SEER incidences</p></a></li>
<li><a href='#mapCancs'><p>Map ICD9 and ICD-O3 codes to cancers</p></a></li>
<li><a href='#mapCODs'><p>Map CODs to strings</p></a></li>
<li><a href='#mapRegs'><p>Map registry codes to acronyms</p></a></li>
<li><a href='#mapTrts'><p>Map treatment codes to factor</p></a></li>
<li><a href='#mk2D'><p>Make 2D-spline fits of incidences</p></a></li>
<li><a href='#mkAbomb'><p>Make Abomb Binaries</p></a></li>
<li><a href='#mkDemographics'><p>Make Demographics Tables</p></a></li>
<li><a href='#mkDF'><p>Converts seerSet$L series to a data.frame</p></a></li>
<li><a href='#mkExcelCsd'><p>Make RR Excel file from csd output</p></a></li>
<li><a href='#mkExcelTsd'><p>Make RR Excel file from tsd function output</p></a></li>
<li><a href='#mkLT'><p>Make Life Tables</p></a></li>
<li><a href='#mkMrt'><p>Make mortality binaries</p></a></li>
<li><a href='#mkMrtLocal'><p>Make mortality binaries from local HMD data files</p></a></li>
<li><a href='#mkSEER'><p> Make R binaries of SEER data.</p></a></li>
<li><a href='#mkSEERold'><p> Make SEER binaries as before</p></a></li>
<li><a href='#msd'><p>Mortality vs years Since Diagnosis</p></a></li>
<li><a href='#nvsr'><p>National Vital Statistic Report (nvsr) Data</p></a></li>
<li><a href='#nvsr01'><p>National Vital Statistic Report (nvsr01) Data</p></a></li>
<li><a href='#p2s'><p>Primary to Secondary</p></a></li>
<li><a href='#pickFields'><p>Pick SEER fields of interest</p></a></li>
<li><a href='#plot2D'><p>Plot 2D cancer incidence splines</p></a></li>
<li><a href='#post1PYO'><p>Get person-years at risk and observed cases after first cancers</p></a></li>
<li><a href='#post1PYOc'><p>Get person-years at risk and observed cases after first cancers</p></a></li>
<li><a href='#post1PYOm'><p>Get person-years at risk and observed deaths after cancer</p></a></li>
<li><a href='#print.seerSet.summary'><p>Prints seerSet.summary objects</p></a></li>
<li><a href='#riskVsAge'><p>Second cancer risk vs attained age after first cancer</p></a></li>
<li><a href='#seerSet'><p>Join SEER cancers and PY</p></a></li>
<li><a href='#seerStats'><p>Summarize SEER data.</p></a></li>
<li><a href='#Sigurdson'><p>Chromosome translocation versus age data</p></a></li>
<li><a href='#simSeerSet'><p>Simulate SEER cancers and population person years</p></a></li>
<li><a href='#simSurv'><p>Simulate Survival Times</p></a></li>
<li><a href='#stdUS'><p>The standard population of the US in 2000</p></a></li>
<li><a href='#summary.seerSet'><p>Summary of seerSet object</p></a></li>
<li><a href='#tsd'><p>Compute RR vs tsd</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>SEER and Atomic Bomb Survivor Data Analysis Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>2019.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Creates SEER (Surveillance, Epidemiology and End Results) and 
    A-bomb data binaries from ASCII sources and provides tools for estimating
    SEER second cancer risks. Methods are described in &lt;<a href="https://doi.org/10.1038%2Fleu.2015.258">doi:10.1038/leu.2015.258</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>dplyr, ggplot2, rgl, demography</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bbmle</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.3), reshape2, mgcv, tibble, LaF, DBI, RSQLite,
openxlsx, WriteXLS, labelled, scales, forcats, purrr,readr,
tidyr, stringr, plyr, survival</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://epbi-radivot.cwru.edu/SEERaBomb/SEERaBomb.html">http://epbi-radivot.cwru.edu/SEERaBomb/SEERaBomb.html</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-12 18:25:36 UTC; radivot</td>
</tr>
<tr>
<td>Author:</td>
<td>Tomas Radivoyevitch [aut, cre],
  R. Molenaar [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tomas Radivoyevitch &lt;radivot@ccf.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-12 18:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='SEERaBomb-package'> SEER and A-Bomb Data Analysis Tools </h2><span id='topic+SEERaBomb-package'></span>

<h3>Description</h3>

<p>Creates SEER (Surveillance, Epidemiology and End Results) and Japanese A-bomb survivor data binaries 
from ASCII sources and provides tools for estimating SEER second cancer risks.     
Depicted below, <code>mkSEER</code>
merges cancers and populations of all three of the SEER databases into single cancer and 
population data frames.  
</p>
<p><img src="../help/figures/mkSEERfig.png" width=420 alt="mkSEERfig.png" />

</p>
<p>SEER data field positions and names change over the years and the original purpose of  
SEERaBomb was to buffer/protect R scripts from such changes. A second purpose was to speed up SEER data computations by 
reducing the data [via <code>pickFields()</code>] to only fields of interest. SEERaBomb now has an additional purpose:
estimating relative risks of SEER second cancers after diagnoses of first cancers, using all three SEER databases.
Note: SEER no longer includes radiation therapy data by default. Users must thus obtain custom SEER treatment data  
<a href="https://seer.cancer.gov/data/treatment.html">https://seer.cancer.gov/data/treatment.html</a>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> <span class="pkg">SEERaBomb</span></td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> dplyr,  ggplot2, rgl,   demography</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> bbmle </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> <a href="http://epbi-radivot.cwru.edu/SEERaBomb/SEERaBomb.html">http://epbi-radivot.cwru.edu/SEERaBomb/SEERaBomb.html</a></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>References</h3>

<p>    Surveillance, Epidemiology, and End Results (SEER) Program
(www.seer.cancer.gov) Research Data (1973-2015), National Cancer
Institute, DCCPS, Surveillance Research Program, Surveillance Systems Branch,
released April 2018, based on the November 2017 submission.</p>


<h3>See Also</h3>

<p><code><a href="#topic+getFields">getFields</a>,<a href="#topic+pickFields">pickFields</a>,<a href="#topic+mkSEER">mkSEER</a>,<a href="#topic+mkSEERold">mkSEERold</a>,<a href="#topic+mkAbomb">mkAbomb</a> </code></p>

<hr>
<h2 id='canc2py'>Converts canc made by mkSEER into a data.frame with py at risk after firsts</h2><span id='topic+canc2py'></span>

<h3>Description</h3>

<p>Makes a data frame in the exernal second cancer data format expected by esd.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>canc2py(canc,firstS,secondS) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="canc2py_+3A_canc">canc</code></td>
<td>
<p>output of mkSEER</p>
</td></tr>
<tr><td><code id="canc2py_+3A_firsts">firstS</code></td>
<td>
<p>Charcter vector of first cancers of interest.</p>
</td></tr>
<tr><td><code id="canc2py_+3A_seconds">secondS</code></td>
<td>
<p>Charcter vector of second cancers of interest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use is currently limited to 2nd cancers in SEER since 1973, e.g. AML, since
esd assumes  its py column is in synch with times since diagnosis. This is not the 
case when e.g. MDS or CMML are in secondS. 
</p>


<h3>Value</h3>

<p>data.frame with columns: yrdx, agedx, sex, py at risk (in years), cancer1, and cancer2.
Cases not ending in a second cancer have cancer2 set to &quot;none&quot;. </p>


<h3>Note</h3>

<p>This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+esd">esd</a>,<a href="#topic+msd">msd</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
rm(list=ls()) 
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") 
secS=c("AML","MDS")
frstS=c("HL")
canc=canc%&gt;%filter(cancer%in%union(frstS,secS))
load("~/data/SEER/mrgd/popsae.RData")
popsa=popsae%&gt;%group_by(db,race,sex,age,year)%&gt;%summarize(py=sum(py)) # sum on regs
pm=seerSet(canc,popsa,Sex="male",ageStart=0,ageEnd=100) 
pf=seerSet(canc,popsa,Sex="female",ageStart=0,ageEnd=100) 
pm=mk2D(pm,secondS=secS) 
pf=mk2D(pf,secondS=secS)
brks=c(0,1,5,10)
pm=csd(pm,brkst=brks,firstS=frstS) 
pf=csd(pf,brkst=brks,firstS=frstS)
S=rbind(pf$DF,pm$DF)%&gt;%select(int,t,cancer1,cancer2,O,E) #merge sexes
S=S%&gt;%group_by(int,cancer1,cancer2)%&gt;%summarize(O=sum(O),E=sum(E),t=mean(t))
S=S%&gt;%mutate(RR=O/E,rrL=qchisq(.025,2*O)/(2*E),rrU=qchisq(.975,2*O+2)/(2*E))
S$data="SEER"

ds=canc2py(canc,frstS,secS)
S2=esd(ds,pf$D,pm$D,brks)
S2=S2%&gt;%group_by(int,cancer1,cancer2)%&gt;%summarize(O=sum(O),E=sum(E),t=mean(t))
S2=S2%&gt;%mutate(RR=O/E,rrL=qchisq(.025,2*O)/(2*E),rrU=qchisq(.975,2*O+2)/(2*E))
S2$data="SEER2"
d=rbind(S,S2)
d%&gt;%filter(cancer1=="HL",cancer2=="AML")%&gt;%arrange(int)
d%&gt;%filter(cancer1=="HL",cancer2=="MDS")%&gt;%arrange(int) #low because MDS not observable before 2001
yrcut=2001  # try to fix it like this
ds=ds%&gt;%filter(yeaR+py&gt;yrcut)
I=ds$yeaR&lt;yrcut
ds$py[I]=(ds$py-(yrcut-ds$yeaR))[I]
S2=esd(ds,pf$D,pm$D,brks)
S2=S2%&gt;%group_by(int,cancer1,cancer2)%&gt;%summarize(O=sum(O),E=sum(E),t=mean(t))
S2=S2%&gt;%mutate(RR=O/E,rrL=qchisq(.025,2*O)/(2*E),rrU=qchisq(.975,2*O+2)/(2*E))
S2$data="SEER2"
d=rbind(S,S2)
d%&gt;%filter(cancer1=="HL",cancer2=="MDS")%&gt;%arrange(int) 
#the problem is that esd assumes that py is synched with tsx. csd handles the delays correctly.
d%&gt;%filter(cancer1=="HL",cancer2=="MDS")%&gt;%group_by(data)%&gt;%summarize(o=sum(O)) #cases were shifted

## End(Not run)
</code></pre>

<hr>
<h2 id='csd'>Cancer risk vs years Since Diagnosis of other cancer</h2><span id='topic+csd'></span>

<h3>Description</h3>

<p>Computes relative risks (RR) of 2nd cancers over specified intervals of 
times since diagnoses of a 1st cancer. 2D spline fits are used to produce 
expected cases E controlling for background risk dedepence on 
age and calendar year.  RR is then O/E where O is the number of observed cases. </p>


<h3>Usage</h3>

<pre><code class='language-R'>csd(seerSet,brkst=c(0),brksy=c(1975),brksa=c(0),trts=NULL,
                    PYLong=FALSE,firstS="all",exclUnkSurv=FALSE) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csd_+3A_seerset">seerSet</code></td>
<td>
<p>A seerSet object produced by mk2D().  </p>
</td></tr>
<tr><td><code id="csd_+3A_brkst">brkst</code></td>
<td>
<p>Vector of breaks in years used to form Time intervals/bins since diagnosis. 
An upper limit of 100, well beyond 40 years of SEER follow up currently available, 
is assumed/added to brkst internally, and should thus not be in brkst. </p>
</td></tr>
<tr><td><code id="csd_+3A_brksy">brksy</code></td>
<td>
<p>Vector of breaks used to form groups of calendar Year at 1st cancer diagnosis intervals/bins.
An upper limit of yearEnd (last year in SEER; a seerSet field) is assumed/added to brksy internally.</p>
</td></tr>
<tr><td><code id="csd_+3A_brksa">brksa</code></td>
<td>
<p>Vector of breaks used to form groups of Age at 1st cancer diagnosis intervals/bins. An upper limit of 126 is assumed. </p>
</td></tr>
<tr><td><code id="csd_+3A_trts">trts</code></td>
<td>
<p>Character vector of treatments of interest. Default of NULL =&gt; all levels in seerSet's canc$trt. </p>
</td></tr>
<tr><td><code id="csd_+3A_pylong">PYLong</code></td>
<td>
<p>Set true if in addition to O and E for each tsd interval you also want PY strips
for each individual; having these big dataframes slows saving seerSets, so only fetch if needed.</p>
</td></tr>
<tr><td><code id="csd_+3A_firsts">firstS</code></td>
<td>
<p>Character vector of first cancers of interest. Default of &quot;all&quot; sets it to the vector of all cancers
in the seerSet field cancerS, which is created when the object is first created by seerSet().</p>
</td></tr>
<tr><td><code id="csd_+3A_exclunksurv">exclUnkSurv</code></td>
<td>
<p>Set true if you wish to exclude all cases with unknown survival times as a marker of bad data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input with an L component added to it or extended it if it already existed. Each component of
L is a nested list of lists that can yield
second cancer relative risks as a function of time since 1st cancer diagnosis. The most recent
component of L is also provided as a data.frame seerSet$DF produced internally using getDF. 
</p>


<h3>Note</h3>

<p> This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
pm=simSeerSet()
pm=mk2D(pm)
pm$canc
pm=csd(pm,brkst=c(0,5),brksy=c(1975,2000),brksa=c(0,50),trts=c("noRad","rad"))
pm
library(ggplot2)
theme_set(theme_gray(base_size = 16)) 
theme_update(legend.position = "top")
g=qplot(x=t,y=RR,data=subset(pm$DF,cancer1=="A"&amp;cancer2=="B"),col=trt,geom=c("line","point"),
        xlab="Years Since First Cancer Diagnosis",ylab="Relative Risk")
g=g+facet_grid(yearG~ageG,scales="free")+geom_abline(intercept=1, slope=0) 
g+geom_errorbar(aes(ymin=rrL,ymax=rrU,width=.15))

## End(Not run)
</code></pre>

<hr>
<h2 id='esd'>Event vs years Since Diagnosis</h2><span id='topic+esd'></span>

<h3>Description</h3>

<p>Computes relative risks (RR) of second cancers over specified years-since-diagnosis intervals. 
SEER incidence rates are used to compute background/expected numbers of cases E, sex, age, and calendar year
specifically.  RR = O/E where O and E are the numbers of observed and expected cases. </p>


<h3>Usage</h3>

<pre><code class='language-R'>esd(d,srfF,srfM,brkst=c(0,2,5),brksy=NULL) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="esd_+3A_d">d</code></td>
<td>
<p>Input data.frame with columns: yrdx, agedx, sex, py at risk (in years), cancer1, and cancer2.
Cancer1 and cancer2 should use standard SEERaBomb cancer names, see mapCancs. Cases
not ending in a second cancer should have cancer2 set to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="esd_+3A_srff">srfF</code></td>
<td>
<p>Female incidence surface. Output D of mk2D for females, for cancers in cancer2 </p>
</td></tr>
<tr><td><code id="esd_+3A_srfm">srfM</code></td>
<td>
<p>Male incidence surface. Output D of mk2D for males, for cancers in cancer2 </p>
</td></tr>
<tr><td><code id="esd_+3A_brkst">brkst</code></td>
<td>
<p>Vector of breaks in years used to form times since diagnosis intervals/bins. </p>
</td></tr>
<tr><td><code id="esd_+3A_brksy">brksy</code></td>
<td>
<p>Vector of breaks of calendar years to show  trends. Leave NULL for all in one. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with observed and expected cases, RR, and RR CI for each time since diagnosis interval. </p>


<h3>Note</h3>

<p> This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+msd">msd</a></code> </p>

<hr>
<h2 id='fillPYM'>Fills age-year person year (PY) matrix</h2><span id='topic+fillPYM'></span><span id='topic+SEERaBomb_fillPYM'></span>

<h3>Description</h3>

<p>This internal function converts a matrix with lots of individual PY contributions and starting ages and years as rows, 
into a population-level PY histrogram matrix of (1-year age)x(1-year year) resolution bins. The output matrix is
more square-like (currently at 40 calendar years by 126 age years) than the tall dataframe-like input matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fillPYM(PYin,PYM)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fillPYM_+3A_pyin">PYin</code></td>
<td>
<p>Tall input matrix where rows hold individual PY at risk, year and starting (left) ages ageL.  </p>
</td></tr>
<tr><td><code id="fillPYM_+3A_pym">PYM</code></td>
<td>
<p>Output PY matrix with age and calendar year rows and columns at single year resolution.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The second argument becomes the output. This matrix should be filled with zeros in R before calling this 
function. After the call, it will be filled; this function uses pointers in Rcpp C++ code. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>Examples</h3>

<pre><code class='language-R'>  yrs=1975:1990
  ages=0.5:70.5
  PYM=matrix(0,ncol=length(yrs),nrow=length(ages))
  colnames(PYM)=yrs
  rownames(PYM)=ages
(PYin=structure(c(3.5, 11.25,5.2, 51.5, 58.5,0.75, 1976, 1977,1980),.Dim = c(3L,3L), 
                  .Dimnames=list(c("1","2","3"),c("py", "ageL", "year"))))
fillPYM(PYin, PYM)
</code></pre>

<hr>
<h2 id='getBinInfo'>Gets the lower and upper limit and index of a tsd bin</h2><span id='topic+getBinInfo'></span>

<h3>Description</h3>

<p> Extract time since diagnosis (tsd) interval information 
in strings produced by cut.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBinInfo(binLab, binS)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBinInfo_+3A_binlab">binLab</code></td>
<td>
<p>The label of the specific bin of interest.  </p>
</td></tr>
<tr><td><code id="getBinInfo_+3A_bins">binS</code></td>
<td>
<p>The character vector of bin labels in which binLab exists.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containting the lower limit (LL), upper limit (UL), and position (index) in the parent vector binS.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
brks=c(0,0.25,1,3,5)  
(binS=levels(cut(brks+0.1,breaks=c(brks,100)))) #make a vector of intervals 
getBinInfo(binS[4],binS) # test getBinInfo
</code></pre>

<hr>
<h2 id='getDF'>Converts a seerSet$L series to a data.frame</h2><span id='topic+getDF'></span>

<h3>Description</h3>

<p>Creates a data.frame of observed and expected cases for each first and second cancer and treatment. 
csd() calls this internally for the most recent time series, so it may not need to be called directly.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDF(seerSet,srs=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDF_+3A_seerset">seerSet</code></td>
<td>
<p>seerSet object produced by csd(). </p>
</td></tr>
<tr><td><code id="getDF_+3A_srs">srs</code></td>
<td>
<p>Series. The time series of interest. NULL (default) implies the currently active series, which is
the most recent. A number i implies the ith series. A string identifies the series by name (numeric vectors 
will be coerced to such a string via paste0(&quot;b&quot;,paste(brks,collapse=&quot;_&quot;)) where brks = vector of time breakpoints.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame in long format that can be used by ggplot.  </p>


<h3>Note</h3>

<p>I envision getting away from saving multiseries seerSet objects and instead just saving several DF outputs of getDF. 
Besides smaller objects, a reason for this is that two L objects out of csd can now be confounded if they have
the same time since diagnosis series but a different series for age and/or year of diagnosis. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+csd">csd</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
canc=canc%&gt;%select(-reg,-recno,-agerec,-numprims,-COD,
          -age19,-age86,-radiatn,-ICD9,-db,-histo3) 
popsa=popsae%&gt;%group_by(db,race,sex,age,year)%&gt;%summarize(py=sum(py)) # sum on regs
pm=seerSet(canc,popsa,Sex="male",ageStart=0,ageEnd=100) #pooled (races) male seerSet
pm=mk2D(pm,secondS=c("AML","MDS"))
firstS=c("NHL","MM")
pm=csd(pm,brkst=c(0,1,5),trts=c("rad","noRad"),firstS=firstS)
pm$DF 
getDF(pm)

## End(Not run)
</code></pre>

<hr>
<h2 id='getE'>Get expected numbers of cases  </h2><span id='topic+getE'></span>

<h3>Description</h3>

<p>Converts list of matrices produced by post1PYO into a matrix that corresponds to the matrix of observed cases 
produced by post1PYO. </p>


<h3>Usage</h3>

<pre><code class='language-R'>getE(LPYM,D,ageStart,ageEnd,yearEnd,firstS,secondS)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getE_+3A_lpym">LPYM</code></td>
<td>
<p>List of first cancer PY matrices produced by post1PYO.</p>
</td></tr>
<tr><td><code id="getE_+3A_d">D</code></td>
<td>
<p>D component of seerSet list produced by mk2D. </p>
</td></tr>
<tr><td><code id="getE_+3A_agestart">ageStart</code></td>
<td>
<p>ageStart component of seerSet. </p>
</td></tr>
<tr><td><code id="getE_+3A_ageend">ageEnd</code></td>
<td>
<p>ageEnd component of seerSet. </p>
</td></tr>
<tr><td><code id="getE_+3A_yearend">yearEnd</code></td>
<td>
<p>The most recent year in the SEER datasets. </p>
</td></tr>
<tr><td><code id="getE_+3A_firsts">firstS</code></td>
<td>
<p>Character vector of first cancers of interest; added to seerSet by tsd. </p>
</td></tr>
<tr><td><code id="getE_+3A_seconds">secondS</code></td>
<td>
<p>Character vector of second cancers of interest; added to seerSet by mk2D. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of expected cases with first cancers labeling the rows and second cancers labeling the columns.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
pm=simSeerSet()
pm=mk2D(pm,secondS="B") 
L=post1PYO(pm$canc,brks=c(0,2,5),binIndx=1,Trt="rad",yearEnd=2012 )
names(L)
names(pm)
with(pm,getE(L$LPYM,D,ageStart,ageEnd,yearEnd,cancerS,secondS))

## End(Not run)
</code></pre>

<hr>
<h2 id='getFields'>Get fields from SEER SAS file</h2><span id='topic+getFields'></span>

<h3>Description</h3>

<p>Converts the SAS file in the SEER &lsquo;<span class="file">incidence</span>&rsquo; directory into a data frame in R.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFields(seerHome="~/data/SEER")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFields_+3A_seerhome">seerHome</code></td>
<td>
<p>The directory that contains the SEER &lsquo;<span class="file">population</span>&rsquo; and &lsquo;<span class="file">incidence</span>&rsquo; directories.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SEER provides a SAS file for reading SEER ASCII data files into SAS.  This file is parsed by 
getFields() to generate
a data frame in R that contains all of the SEER fields. This data frame describes these fields in 
terms of their names (short and long forms), their starting points, and their widths.</p>


<h3>Value</h3>

<p>A data frame with one row for each field and columns that contain corresponding 
starting positions, widths, sas names, short names, and expansions thereof.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mkSEER">mkSEER</a>, <a href="#topic+pickFields">pickFields</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
(df=getFields())
head(df,20)

## End(Not run)
</code></pre>

<hr>
<h2 id='getPY'>Get tsd interval PY</h2><span id='topic+getPY'></span>

<h3>Description</h3>

<p>Gets person year (PY) contributions to a particular time since diagnosis (tsd) interval
from survival times.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPY(surv, bin, binS, brks)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPY_+3A_surv">surv</code></td>
<td>
<p>The total survival time of the patient.  </p>
</td></tr>
<tr><td><code id="getPY_+3A_bin">bin</code></td>
<td>
<p>The label of the specific bin of interest.  </p>
</td></tr>
<tr><td><code id="getPY_+3A_bins">binS</code></td>
<td>
<p>The character vector of bin labels in which binLab exists.  </p>
</td></tr>
<tr><td><code id="getPY_+3A_brks">brks</code></td>
<td>
<p>The numeric vector of break points used by cut to create binS. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector as long as the survival vector input of PY at risk in a particular interval.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+getBinInfo">getBinInfo</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
brks=c(0,0.25,1,3,6)  
(binS=levels(cut(brks+0.1,breaks=c(brks,100)))) #make a vector of intervals 
survTimes=c(8,16,1.5,3.7)
getPY(survTimes,binS[1],binS,brks)# all contribute 0.25 to first interval 
getPY(survTimes,binS[4],binS,brks)# 3rd and 4th survivals contribute 0 and 0.7 to (3,6]
getPY(survTimes,binS[5],binS,brks)# 1st and 2nd survival contribute 2 and 10 years to (6,100]
</code></pre>

<hr>
<h2 id='incidAbomb'>Computes A-bomb incidences</h2><span id='topic+incidAbomb'></span>

<h3>Description</h3>

<p>Creates A-bomb survivor incidence rates and confidence intervals. </p>


<h3>Usage</h3>

<pre><code class='language-R'>incidAbomb(d)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="incidAbomb_+3A_d">d</code></td>
<td>
<p>Tibble, typically grouped, with DG column ending 1st block and py starting the last.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns  <code>DG</code> and  <code>py</code> must exist in  <code>d</code>, in that order. 
Person-year weighted means will be formed of any columns between them. 
Its OK if none exist. Sums are formed on <code>py</code> and anything to their right. It is assumed
that cancer types begin after py, with at most upy and/or subjects intervening them. 
</p>


<h3>Value</h3>

<p>A tibble data frame, summarized by groups, with cancers after py in a new cancers column,
and new columns O (observed cases), incid and incid 95% CI limits LL and UL.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a> </code></p>

<hr>
<h2 id='incidSEER'>Computes SEER incidences</h2><span id='topic+incidSEER'></span>

<h3>Description</h3>

<p>Creates SEER incidence rates and confidence intervals. </p>


<h3>Usage</h3>

<pre><code class='language-R'>incidSEER(canc,popsae,cancers)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="incidSEER_+3A_canc">canc</code></td>
<td>
<p>data frame of cancer cases</p>
</td></tr>
<tr><td><code id="incidSEER_+3A_popsae">popsae</code></td>
<td>
<p>data frame of person years at risk</p>
</td></tr>
<tr><td><code id="incidSEER_+3A_cancers">cancers</code></td>
<td>
<p>character vector of cancer types</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This left joins popsae and cancers in canc.</p>


<h3>Value</h3>

<p>A data frame with observed cases (O), incid, and incid 95% CI limits LL and UL.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a> </code></p>

<hr>
<h2 id='mapCancs'>Map ICD9 and ICD-O3 codes to cancers</h2><span id='topic+mapCancs'></span>

<h3>Description</h3>

<p> Adds a factor cancer with easily recognizable levels to a SEER cancer data.frame.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapCancs(D)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapCancs_+3A_d">D</code></td>
<td>
<p>A data frame that includes ICD9 and histo3 as columns.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data frame with an additional cancer column added on.</p>


<h3>Note</h3>

<p>This is used by mkSEER() when it generates R binaries of the SEER data. Otherwise it provides current cancer 
definitions (seen by looking at the function definition).</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mapRegs">mapRegs</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
mapCancs # shows default definitions
</code></pre>

<hr>
<h2 id='mapCODs'>Map CODs to strings</h2><span id='topic+mapCODs'></span>

<h3>Description</h3>

<p> Maps integer cause of death (COD) codes in COD of a SEER cancer data frame 
to a factor CODS with recognizable levels. This is a bit slow, so it is called within mkSEER.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapCODs(D)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapCODs_+3A_d">D</code></td>
<td>
<p>A data frame that includes COD as a column.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data frame with an additional CODS column added on.</p>


<h3>Note</h3>

<p>Typing mapCODs dumps the function definition and thus the mapping used.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mapRegs">mapRegs</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
mapCODs # shows default definitions
</code></pre>

<hr>
<h2 id='mapRegs'>Map registry codes to acronyms</h2><span id='topic+mapRegs'></span>

<h3>Description</h3>

<p> Maps codes for SEER registries to 2-letter acronyms and 
corresponding descriptions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapRegs(code=NA)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapRegs_+3A_code">code</code></td>
<td>
<p> Full SEER codes as found in SEER Cancer files. Add 1500 to popuation file codes get such cancer file codes. 
If this argument is missing (the default) a full dataframe of symbols and descriptions is returned. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of SEER registry symbols and descriptions with rownames such as &quot;1501&quot; for 
sf (san francisco) and &quot;1520&quot; for dM (detroit Michigan), or just the symbol if the rowname is given.
Note that city characters are in lower case and state characters are in upper case.</p>


<h3>Note</h3>

<p>This function is used by mkSEER when it generates merged R binaries. It is exposed 
to provide quick access to registry acronym definitions.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mapCancs">mapCancs</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
mapRegs(1501)
mapRegs()
</code></pre>

<hr>
<h2 id='mapTrts'>Map treatment codes to factor</h2><span id='topic+mapTrts'></span>

<h3>Description</h3>

<p>Uses SEER codes in the SEER field radiatn to add a
factor named trt with levels &quot;noRad&quot;,&quot;rad&quot;, and &quot;unk&quot; to a cancer data frame.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapTrts(D)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapTrts_+3A_d">D</code></td>
<td>
<p>A SEER cancer data frame that includes the field radiatn as a column.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data frame with an additional trt column added to its end.</p>


<h3>Note</h3>

<p>This function is used by mkSEER when it generates merged R binaries. It is exposed to state
the default definition of trt and, by way of example, 
to show how to override it.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mapTrts">mapTrts</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
mapTrts # exposes default definition of trt
</code></pre>

<hr>
<h2 id='mk2D'>Make 2D-spline fits of incidences</h2><span id='topic+mk2D'></span>

<h3>Description</h3>

<p>Produces two dimensional (2D) spline 
fits of cancer incidence versus age and calendar year, with interactions. In conjunction with person years 
(PY) at risk, this 
is used in csd() to produce expected numbers of cases under a null hypothesis 
that prior cancers do not impact subsequent cancer risks.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk2D(seerSet, knots=5, write=FALSE, outDir="~/Results",txt=NULL,secondS=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mk2D_+3A_seerset">seerSet</code></td>
<td>
<p>Object of class seerSet, i.e. output list of seerSet(). </p>
</td></tr>
<tr><td><code id="mk2D_+3A_knots">knots</code></td>
<td>
<p>Base number of knots; overrides are in place for some cancers.  </p>
</td></tr>
<tr><td><code id="mk2D_+3A_write">write</code></td>
<td>
<p>TRUE = write 2D fits to files. The fits can be &gt;300 MB and take &gt;60 seconds to write, 
so leave FALSE unless you need it.</p>
</td></tr>
<tr><td><code id="mk2D_+3A_outdir">outDir</code></td>
<td>
<p>Folder that will hold the output files.</p>
</td></tr>
<tr><td><code id="mk2D_+3A_txt">txt</code></td>
<td>
<p>Additional text to distinguish files with different cancer lists. This may be 
useful during spline fit development. </p>
</td></tr>
<tr><td><code id="mk2D_+3A_seconds">secondS</code></td>
<td>
<p>Charcter vector of second cancers of interest (note: I often capitalize 
the final S of vectors of Strings).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input seerSet with an additional data frame D added to this list. 
D holds background/expected incidences over a 1-year resolution age-year grid. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+plot2D">plot2D</a>, <a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
(pm=simSeerSet())
(pm=mk2D(pm))
names(pm)
head(pm$D)
tail(pm$D)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkAbomb'>Make Abomb Binaries</h2><span id='topic+mkAbomb'></span>

<h3>Description</h3>

<p>Converts Abomb files &lsquo;<span class="file">lsshempy.csv</span>&rsquo; and &lsquo;<span class="file">lssinc07.csv</span>&rsquo; 
into tibbles <code>heme</code> and <code>solid</code> in the file &lsquo;<span class="file">abomb.RData</span>&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkAbomb(AbombHome="~/data/abomb")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkAbomb_+3A_abombhome">AbombHome</code></td>
<td>
<p> Directory with Abomb files.  Should be writable by user.</p>
</td></tr>
</table>


<h3>Details</h3>

  
<p>The files &lsquo;<span class="file">lsshempy.csv</span>&rsquo; and &lsquo;<span class="file">lssinc07.csv</span>&rsquo; can be found under
The incidence of leukemia, lymphoma and multiple myeloma among atomic bomb survivors: 1950-2001 and Life Span Study Cancer Incidence Data, 1958-1998 of the Radiation Effects Research Foundation (RERF) website <a href="http://www.rerf.or.jp/">http://www.rerf.or.jp/</a>.
</p>


<h3>Value</h3>

<p>None. This function is called for its side-effect of producing &lsquo;<span class="file">abomb.RData</span>&rsquo;. </p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
mkAbomb()
load("~/data/abomb/abomb.RData")
View(heme)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkDemographics'>Make Demographics Tables</h2><span id='topic+mkDemographics'></span>

<h3>Description</h3>

<p>Provides, in an Excel file, quartiles of age at diagnoses  in one sheet and median overall survival times on a second. Many tables are placed in each sheet. One Excel file is produced per cancer type.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkDemographics(canc,outDir="~/Results/SEERaBomb")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkDemographics_+3A_canc">canc</code></td>
<td>
<p>A dataframe that includes cancer, age at diagnosis (agedx), age (grouped agedx), 
race, sex, year (grouped), COD, surv, and trt.  </p>
</td></tr>
<tr><td><code id="mkDemographics_+3A_outdir">outDir</code></td>
<td>
<p>Folder of the Excel file(s) that will be generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returned invisibly is a list of data frames corresponding to tables of the Excel file(s).</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
rm(list=ls())
load("~/data/SEER/mrgd/cancDef.RData")
canc$year=cut(canc$yrdx,c(1973,2003,2009,2015),include.lowest = T,dig.lab=4)
canc$age=cut(canc$agedx,c(0,40,50,60,70,80,90,126),include.lowest = T)
canc=canc%&gt;%filter(surv&lt;9999)
canc=canc%&gt;%select(-age86,-radiatn,-chemo,-db,-casenum,-modx,-seqnum,-yrbrth,-ICD9,-reg,-histo3)
canc=canc%&gt;%filter(cancer%in%c("AML","MDS","MPN"))
head(canc,3)
mkDemographics(canc)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkDF'>Converts seerSet$L series to a data.frame</h2><span id='topic+mkDF'></span>

<h3>Description</h3>

<p>Creates a data.frame of observed and expected cases for each first and second cancer and treatment. 
Use of this function is deprecated. Use getDF() instead, if needed: csd now calls getDF internally for the 
most recent time series, so even it may not need to be called directly.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkDF(seerSet,srs)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkDF_+3A_seerset">seerSet</code></td>
<td>
<p>seerSet object produced by tsd(). </p>
</td></tr>
<tr><td><code id="mkDF_+3A_srs">srs</code></td>
<td>
<p>Series. The time series of interest. NULL (default) implies the currently active series, which is
the most recent. A number i implies the ith series. A string identifies the series by name (numeric vectors 
will be coerced to such a string via paste0(&quot;b&quot;,paste(brks,collapse=&quot;_&quot;)) where brks = vector of time breakpoints.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame in long format that can be used by ggplot.  </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>, <a href="#topic+tsd">tsd</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
canc=canc%&gt;%select(-reg,-recno,-agerec,-numprims,-COD,
          -age19,-age86,-radiatn,-ICD9,-db,-histo3) 
popsa=popsae%&gt;%group_by(db,race,sex,age,year)%&gt;%summarize(py=sum(py)) # sum on regs
pm=seerSet(canc,popsa,Sex="male",ageStart=0,ageEnd=100) #pooled (races) male seerSet
pm=mk2D(pm,secondS=c("AML","MDS"))
brks=c(0,1,5)
firstS=c("NHL","MM")
pm=tsd(pm,brks=brks,trts=c("rad","noRad"),firstS=firstS)
mkDF(pm)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkExcelCsd'>Make RR Excel file from csd output</h2><span id='topic+mkExcelCsd'></span>

<h3>Description</h3>

<p>Provides relative risks (RR) organized by 1st and 2nd cancers, times since 1st cancer diagnoses, and 1st cancer treatment. RR = O/E where O = observed cases and E = cases expected under a null hypothesis that prior cancers do not impact subsequent risks. If flip = FALSE (default), sheets = 1st cancers and rows = 2nd cancers, else sheets = 2nd cancers and rows = 1st cancers; columns are always intervals of years since diagnosis, in 
1st cancer treatment blocks. RR CI and observed numbers are included in each data cell.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkExcelCsd(seerSet,tsdn,biny="[1975,2017)",bina="(0,126]",
                        outDir="~/Results",outName=NULL,flip=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkExcelCsd_+3A_seerset">seerSet</code></td>
<td>
<p>A seerSet list after it has been processed by csd().  </p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_tsdn">tsdn</code></td>
<td>
<p>Name of set of times since diagnosis. This is based on the brkst argument to csd().
If length &gt;1 a brkst vector is assumed and coerced/collapsed to a tsdn string.</p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_biny">biny</code></td>
<td>
<p>Year at DX interval. </p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_bina">bina</code></td>
<td>
<p>Age at DX interval.</p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_outdir">outDir</code></td>
<td>
<p>Folder of the Excel file that will be generated.</p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_outname">outName</code></td>
<td>
<p>if null (default), Excel file name = seerSet base file name (bfn) + tsdn,
else it is outName. Eitherway, &quot;Flipped&quot; is appended to the name if flip is TRUE.  </p>
</td></tr>
<tr><td><code id="mkExcelCsd_+3A_flip">flip</code></td>
<td>
<p>If FALSE, sheets are first cancers, rows seconds. If TRUE, sheets are second cancers, rows firsts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returned invisibly, a list of data frames corresponding to sheets of the Excel file. 
</p>


<h3>Note</h3>

<p> Outputs are for a given sex. Races are typically pooled.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
pm=simSeerSet()
pm=mk2D(pm) 
mybrks=c(0,1,5,10)
pm=csd(pm,brkst=mybrks,trts=c("noRad","rad")) 
(lab=paste0("b",paste(mybrks,collapse="_")))
(L=mkExcelCsd(pm,lab))
(L=mkExcelCsd(pm,lab,flip=TRUE))

## End(Not run)

</code></pre>

<hr>
<h2 id='mkExcelTsd'>Make RR Excel file from tsd function output</h2><span id='topic+mkExcelTsd'></span>

<h3>Description</h3>

<p>Provides relative risks (RR) organized by 1st and 2nd cancers, times since 1st cancer diagnoses, and 1st cancer treatment. RR = O/E where O = observed cases and E = cases expected under a null hypothesis that prior cancers do not impact subsequent risks. If flip = FALSE (default), sheets = 1st cancers and rows = 2nd cancers, else sheets = 2nd cancers and rows = 1st cancers; columns are always intervals of years since diagnosis, in 
1st cancer treatment blocks. RR CI and observed numbers are included in each data cell.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkExcelTsd(seerSet,tsdn,outDir="~/Results",outName=NULL,flip=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkExcelTsd_+3A_seerset">seerSet</code></td>
<td>
<p>A seerSet list after it has been processed by tsd().  </p>
</td></tr>
<tr><td><code id="mkExcelTsd_+3A_tsdn">tsdn</code></td>
<td>
<p>Name of set of times since diagnosis. This is based on the brks argument to tsd().
If length &gt;1 a brkst vector is assumed and coerced/collapsed to a tsdn string.</p>
</td></tr>
<tr><td><code id="mkExcelTsd_+3A_outdir">outDir</code></td>
<td>
<p>Folder of the Excel file that will be generated.</p>
</td></tr>
<tr><td><code id="mkExcelTsd_+3A_outname">outName</code></td>
<td>
<p>if null (default), Excel file name = seerSet base file name (bfn) + tsdn,
else it is outName. Eitherway, &quot;Flipped&quot; is appended to the name if flip is TRUE.  </p>
</td></tr>
<tr><td><code id="mkExcelTsd_+3A_flip">flip</code></td>
<td>
<p>If FALSE, sheets are first cancers, rows seconds. If TRUE, sheets are second cancers, rows firsts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returned invisibly, a list of data frames corresponding to sheets of the Excel file. 
</p>


<h3>Note</h3>

<p> Outputs are for a given sex. Races are typically pooled.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
pm=simSeerSet()
pm=mk2D(pm) 
mybrks=c(0,1,5,10)
pm=tsd(pm,brkst=mybrks,trts=c("noRad","rad")) 
(lab=paste0("b",paste(mybrks,collapse="_")))
(L=mkExcelTsd(pm,lab))
(L=mkExcelTsd(pm,lab,flip=TRUE))

## End(Not run)

</code></pre>

<hr>
<h2 id='mkLT'>Make Life Tables</h2><span id='topic+mkLT'></span>

<h3>Description</h3>

<p>Makes life tables from mortality data binaries produced by mkMrt() and places the files in the same folder.</p>


<h3>Usage</h3>

<pre><code class='language-R'> mkLT(mrtHome="~/data/usMort",input="mrt.RData",output="ltb.RData")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkLT_+3A_mrthome">mrtHome</code></td>
<td>
<p> Directory that contains the mortality data binary.  </p>
</td></tr>
<tr><td><code id="mkLT_+3A_input">input</code></td>
<td>
<p> File that contains the mortality data binary.  </p>
</td></tr>
<tr><td><code id="mkLT_+3A_output">output</code></td>
<td>
<p> File that will contain the life tables.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. This function is called for its side-effect of producing male and female life tables in files.  </p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
mkLT()
load("~/data/usMort/ltb.RData")
tail(ltb$Female)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkMrt'>Make mortality binaries</h2><span id='topic+mkMrt'></span>

<h3>Description</h3>

<p>Gets mortality data from the Human Mortality Database <a href="http://www.mortality.org/">http://www.mortality.org/</a> 
and puts it in the file &lsquo;<span class="file">mrt.RData</span>&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'> mkMrt(username,passwd,country="USA",mrtHome="~/data/usMort")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkMrt_+3A_username">username</code></td>
<td>
<p> Username of Human Mortality Database account.</p>
</td></tr>
<tr><td><code id="mkMrt_+3A_passwd">passwd</code></td>
<td>
<p> Password of Human Mortality Database account.</p>
</td></tr>
<tr><td><code id="mkMrt_+3A_country">country</code></td>
<td>
<p> This should probably stay at its default of USA.</p>
</td></tr>
<tr><td><code id="mkMrt_+3A_mrthome">mrtHome</code></td>
<td>
<p> Directory that will contain the mortality data binary.  Should be writable by user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. This function is called for its side-effect of producing &lsquo;<span class="file">mrt.RData</span>&rsquo;. </p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>References</h3>

<p> Barbieri M, Wilmoth JR, Shkolnikov VM, et al. Data Resource Profile: 
The Human Mortality Database (HMD). Int J Epidemiol. 2015;44: 1549-1556.</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
mkMrt("username", "password")# sub in your personal account info
load("~/data/usMort/mrt.RData")
head(mrt$Female)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkMrtLocal'>Make mortality binaries from local HMD data files</h2><span id='topic+mkMrtLocal'></span>

<h3>Description</h3>

<p>Converts locally installed Human Mortality Data <a href="http://www.mortality.org/">http://www.mortality.org/</a> into an R binary file
&lsquo;<span class="file">mrtCOUNTRY.RData</span>&rsquo;.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkMrtLocal(country="USA",mrtHome="~/data/mrt",
                    mrtSrc1="~/data/hmd_countries",
                    mrtSrc2="~/data/hmd_statistics/death_rates/Mx_1x1"
                    )</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkMrtLocal_+3A_country">country</code></td>
<td>
<p>Default is USA. See names of subfolders of &lsquo;<span class="file">hmd_countries</span>&rsquo; for other options.</p>
</td></tr>
<tr><td><code id="mkMrtLocal_+3A_mrthome">mrtHome</code></td>
<td>
<p>Directory that will contain the mortality data binary.  Should be writable by user.</p>
</td></tr>
<tr><td><code id="mkMrtLocal_+3A_mrtsrc1">mrtSrc1</code></td>
<td>
<p>Directory with hmd_countries data (first choice of files = &quot;all HMD countries&quot;).</p>
</td></tr>
<tr><td><code id="mkMrtLocal_+3A_mrtsrc2">mrtSrc2</code></td>
<td>
<p>Directory with hmd_statistics data (second choice of files = &quot;all HMD statistics&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. This function is called for its side-effect of producing &lsquo;<span class="file">mrt.RData</span>&rsquo; from HMD files
organized as all HMD countries or all HMD statistics on the HMD download page (you need at least one of these). </p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>References</h3>

<p> Barbieri M, Wilmoth JR, Shkolnikov VM, et al. Data Resource Profile: 
The Human Mortality Database (HMD). Int J Epidemiol. 2015;44: 1549-1556.</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
mkMrtLocal() 
load("~/data/mrt/mrtUSA.RData")
head(mrt$Female)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkSEER'> Make R binaries of SEER data.</h2><span id='topic+mkSEER'></span>

<h3>Description</h3>

<p>Converts SEER ASCII text files into large R binaries that include all cancer types and registries combined.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkSEER(df,seerHome="~/data/SEER",outDir="mrgd",outFile="cancDef",
                  indices = list(c("sex","race"), c("histo3","seqnum"),  "ICD9"),
                  writePops=TRUE,writeRData=TRUE,writeDB=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkSEER_+3A_df">df</code></td>
<td>
<p> A data frame that was the output of <code>pickFields()</code>. This determines which fields to transfer. 
Using the output of <code>getFields()</code> is a common mistake that must be avoided.</p>
</td></tr>
<tr><td><code id="mkSEER_+3A_seerhome">seerHome</code></td>
<td>
<p> The directory that contains the SEER &lsquo;<span class="file">population</span>&rsquo; and &lsquo;<span class="file">incidence</span>&rsquo; directories.  This should be writable by the user.</p>
</td></tr>
<tr><td><code id="mkSEER_+3A_outdir">outDir</code></td>
<td>
<p>seerHome subdirectory to write to. Default is &lsquo;<span class="file">mrgd</span>&rsquo; for all registries merged together.</p>
</td></tr>
<tr><td><code id="mkSEER_+3A_outfile">outFile</code></td>
<td>
<p>Base name of the SQLite database and cancer binary. Default = cancDef (Cancer Default). </p>
</td></tr>           
<tr><td><code id="mkSEER_+3A_indices">indices</code></td>
<td>
<p>Passed to <code>copy_to()</code> in <span class="pkg">dplyr</span>. </p>
</td></tr>           
<tr><td><code id="mkSEER_+3A_writepops">writePops</code></td>
<td>
<p>TRUE if you wish to write out the population data frame binaries. Doing so takes ~10 seconds, so
savings of FALSE are small.</p>
</td></tr>           
<tr><td><code id="mkSEER_+3A_writerdata">writeRData</code></td>
<td>
<p>TRUE if you wish to write out the cancer data frame binary. Writing files takes most of the time. </p>
</td></tr>           
<tr><td><code id="mkSEER_+3A_writedb">writeDB</code></td>
<td>
<p>TRUE if you wish to write cancer, popga, popsa, and popsae data frames to SQLite database tables.  </p>
</td></tr>           
</table>


<h3>Details</h3>

<p>This function uses the R package <span class="pkg">LaF</span> to access the fixed-width format data files 
of SEER. <span class="pkg">LaF</span> is fast, but it requires knowledge of all the widths of columns wanted, as well as the the widths of unwanted stretches in between. This knowledge is produced by <code>getFields()</code> and <code>pickFields()</code> combined. It is passed to <code>mkSEER()</code> via the argument <code>df</code>. 
</p>


<h3>Value</h3>

<p>None, it produces R binary files of the SEER data.</p>


<h3>Note</h3>

<p> This takes a substantial amount of RAM (it works on a Mac with 16 GB of RAM) and time (~3 minutes
using default fields).</p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+getFields">getFields</a>,<a href="#topic+pickFields">pickFields</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
(df=getFields())
(df=pickFields(df))
# the following will take a several minutes, but may only need 
# to be done roughly once per year, with each release.
mkSEER(df)

## End(Not run)
</code></pre>

<hr>
<h2 id='mkSEERold'> Make SEER binaries as before  </h2><span id='topic+mkSEERold'></span>

<h3>Description</h3>

<p> Converts SEER ASCII text files into smaller R binaries.
This is being maintained to avoid fixing old scripts. Please use mkSEER for new scripts.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkSEERold(df,seerHome="~/data/SEER",
            dataset=c("00","73","92"),SQL=TRUE, mkDFs=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkSEERold_+3A_df">df</code></td>
<td>
<p> A data frame that was the output of <code>pickFields</code>. This determines which fields to transfer. </p>
</td></tr>
<tr><td><code id="mkSEERold_+3A_seerhome">seerHome</code></td>
<td>
<p> The directory that contains the SEER &lsquo;<span class="file">population</span>&rsquo; and &lsquo;<span class="file">incidence</span>&rsquo; directories.  This should be writable by the user.</p>
</td></tr>
<tr><td><code id="mkSEERold_+3A_dataset">dataset</code></td>
<td>
<p>The SEER database to use, specified as a string of the last two digits of the starting year, i.e. <code>"73"</code> = 1973-2011, <code>"92"</code>  = 1992-2011, and <code>"00"</code> = 2000-2011. This determines the subdirectory in &lsquo;<span class="file">incidence</span>&rsquo; and &lsquo;<span class="file">population</span>&rsquo; from which data is taken and is also the name of the subdirectory of <code>seerHome</code> to which the R data files will be written, e.g. <code>"00"</code> processes the 2000 database and places the binary results in /data/SEER/00.</p>
</td></tr>
<tr><td><code id="mkSEERold_+3A_sql">SQL</code></td>
<td>
<p>TRUE if an SQLite database is to be created. The file &lsquo;<span class="file">all.db</span>&rsquo; produced in this case can be significantly larger than the sum of the &lsquo;<span class="file">*.RData</span>&rsquo; files also produced. </p>
</td></tr>           
<tr><td><code id="mkSEERold_+3A_mkdfs">mkDFs</code></td>
<td>
<p>TRUE if you wish to make data frame binaries. </p>
</td></tr>           
</table>


<h3>Details</h3>

<p>See <a href="#topic+mkSEER">mkSEER</a>.</p>


<h3>Value</h3>

<p>None.  This function produces R binary data files.</p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a>,<a href="#topic+getFields">getFields</a>,<a href="#topic+pickFields">pickFields</a> </code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
(df=getFields())
(df=pickFields(df))
for (i in c("73","92","00")) mkSEERold(df,dataset=i)

## End(Not run)
</code></pre>

<hr>
<h2 id='msd'>Mortality vs years Since Diagnosis</h2><span id='topic+msd'></span>

<h3>Description</h3>

<p>Computes relative risks (RR) of death over specified years-since-diagnosis intervals. 
US mortality rates obtained via the R package demography are used to compute background death dedepence on 
age and calendar year.  RR is then O/E where O and E are the number of observed and expected cases. </p>


<h3>Usage</h3>

<pre><code class='language-R'>msd(canc,mrt,brkst=c(0,2,5),brksy=NULL) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msd_+3A_canc">canc</code></td>
<td>
<p>Input data.frame with columns: yrdx, agedx, sex, surv (in years), and status (1=dead).</p>
</td></tr>
<tr><td><code id="msd_+3A_mrt">mrt</code></td>
<td>
<p>List with male and female fields, each matrices with mortality rates vs year and age. </p>
</td></tr>
<tr><td><code id="msd_+3A_brkst">brkst</code></td>
<td>
<p>Vector of breaks in years used to form Times since diagnosis intervals/bins. </p>
</td></tr>
<tr><td><code id="msd_+3A_brksy">brksy</code></td>
<td>
<p>Vector of breaks of calendar Years to show mortality trends. Leave NULL for all in one. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with observed and expected cases, RR, and RR CI for each tsd interval. </p>


<h3>Note</h3>

<p> This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #loads in canc
lu=canc%&gt;%filter(cancer=="lung")
lu=lu%&gt;%mutate(status=as.numeric(COD&gt;0))%&gt;%select(yrdx,agedx,sex,surv,status) 
lu=lu%&gt;%mutate(surv=round((surv+0.5)/12,3))#convert surv to years

# library(demography)
# d=hmd.mx("USA", "username", "password") #make an account and put your info in here
# mrt=d$rate
# save(mrt,file="~/data/usMort/mrt.RData")
load("~/data/usMort/mrt.RData"); object.size(mrt)# 250kb
brks=c(0,0.5,3,6,10,15,20,25)    
(dlu=msd(lu,mrt,brkst=brks))

## End(Not run)
</code></pre>

<hr>
<h2 id='nvsr'>National Vital Statistic Report (nvsr) Data</h2><span id='topic+nvsr'></span>

<h3>Description</h3>

<p>US mortality rates (probability of death that year) in 2010; report published Nov. 2014.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nvsr
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns.
</p>

<dl>
<dt><code>age</code></dt><dd><p>Single-year resolution ages up to 99.5. </p>
</dd>
<dt><code>p</code></dt><dd><p>Pooled sexes and races. </p>
</dd>
<dt><code>pm</code></dt><dd><p>Pooled races, males. </p>
</dd>
<dt><code>pf</code></dt><dd><p>Pooled races, females. </p>
</dd>
<dt><code>w</code></dt><dd><p>Whites, sexes pooled.</p>
</dd>
<dt><code>b</code></dt><dd><p>Blacks, sexes pooled.</p>
</dd>
<dt><code>o</code></dt><dd><p>Others, sexes pooled.</p>
</dd>
<dt><code>wm</code></dt><dd><p>White males. </p>
</dd>
<dt><code>wf</code></dt><dd><p>White females. </p>
</dd>
<dt><code>bm</code></dt><dd><p>Black males. </p>
</dd>
<dt><code>bf</code></dt><dd><p>Black females. </p>
</dd>
<dt><code>om</code></dt><dd><p>Other males. </p>
</dd>
<dt><code>of</code></dt><dd><p>Other females. </p>
</dd>
</dl>



<h3>References</h3>

<p>National Vital Statistics Reports, Vol. 63, No. 7, November 6, 2014
<a href="http://www.cdc.gov/nchs/data/nvsr/nvsr63/nvsr63_07.pdf">http://www.cdc.gov/nchs/data/nvsr/nvsr63/nvsr63_07.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
head(nvsr)
</code></pre>

<hr>
<h2 id='nvsr01'>National Vital Statistic Report (nvsr01) Data</h2><span id='topic+nvsr01'></span>

<h3>Description</h3>

<p>US mortality rates (probability of death that year) in 2001 (Report 52_14).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nvsr01
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns.
</p>

<dl>
<dt><code>age</code></dt><dd><p>Single-year resolution ages up to 99.5. </p>
</dd>
<dt><code>p</code></dt><dd><p>Pooled sexes and races. </p>
</dd>
<dt><code>pm</code></dt><dd><p>Pooled races, males. </p>
</dd>
<dt><code>pf</code></dt><dd><p>Pooled races, females. </p>
</dd>
<dt><code>wm</code></dt><dd><p>White males. </p>
</dd>
<dt><code>wf</code></dt><dd><p>White females. </p>
</dd>
<dt><code>bm</code></dt><dd><p>Black males. </p>
</dd>
<dt><code>bf</code></dt><dd><p>Black females. </p>
</dd>
</dl>



<h3>Details</h3>

<p>This data is used to extrapolate PY at risk in SEER population files from 85+ to older ages.  
</p>


<h3>References</h3>

<p><a href="ftp://ftp.cdc.gov/pub/Health_Statistics/NCHS/Publications/NVSR/52_14/">ftp://ftp.cdc.gov/pub/Health_Statistics/NCHS/Publications/NVSR/52_14/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
head(nvsr01)
</code></pre>

<hr>
<h2 id='p2s'>Primary to Secondary</h2><span id='topic+p2s'></span>

<h3>Description</h3>

<p>Using a SEER data frame, this function computes times between primary and secondary cancers. In the resulting data frame, surv and status can be analyzed at the individual level, e.g. using Cox regression. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2s(canc,firstS,secondS,yrcut=2010) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p2s_+3A_canc">canc</code></td>
<td>
<p>Data frame produced by mkSEER().  </p>
</td></tr>
<tr><td><code id="p2s_+3A_firsts">firstS</code></td>
<td>
<p>Vector of names (as Strings) of first cancers you wish to consider. </p>
</td></tr>
<tr><td><code id="p2s_+3A_seconds">secondS</code></td>
<td>
<p>Vector of names of second cancers you wish to consider. </p>
</td></tr>
<tr><td><code id="p2s_+3A_yrcut">yrcut</code></td>
<td>
<p>Only cases diagnosed in yrcut or newer are analyzed. The default of 2010 is the year AML cases after MDS
began to be entered into SEER as second cancers; before they were considered to be part of the first cancer.
This function facilitates studies of the rate at which myeloid neoplasms such as MDS progress to AML. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with a row for each primary (first cancer) diagnosed on or after yrcut. The surv column holds the
time in months to last follow up or death (status=0), or to the time of diagnosis of the second cancer (status=1). 
</p>


<h3>Author(s)</h3>

<p>Remco J. Molenaar (r.j.molenaar@amc.uva.nl )</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# 

## End(Not run)
</code></pre>

<hr>
<h2 id='pickFields'>Pick SEER fields of interest</h2><span id='topic+pickFields'></span>

<h3>Description</h3>

<p> Reduces the full set of SEER data fields to a smaller set of interest. SEER fields 
are rows of the input and output dataframes
of this function. The output dataframe differs from the input dataframe not only in there being fewer rows  
but also in there being an additional column needed by <code>mkSEER()</code> downstream.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickFields(sas,picks=c("casenum","reg","race","sex","agedx",
        "yrbrth","seqnum","modx","yrdx","histo3",
        "ICD9","COD","surv","radiatn","chemo"))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pickFields_+3A_sas">sas</code></td>
<td>
<p>A data frame created by <code>getFields()</code> using the SAS file found in 
the &lsquo;<span class="file">incidence</span>&rsquo; directory of <code>seerHome</code>, the root of the SEER ASCII data installation.</p>
</td></tr>
<tr><td><code id="pickFields_+3A_picks">picks</code></td>
<td>
<p> Vector of names of variables of interest. This set should not be smaller than the default.   
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R binaries become too large if all of the fields are selected. <code>SEERaBomb</code> is faster than SEER*Stat 
because it tailors/streamlines the database to your interests. The default picks are a reasonable place to start; if you 
determine later that you need more fields, you can always rebuild the binaries. Grabbing all fields is  
discouraged, but if you want this anyway, note that you still need <code>pickFields()</code> to create a data type column, i.e. you cannot bypass <code>pickFields()</code> by sending the output of <code>getFields()</code> straight to <code>mkSEER()</code>.</p>


<h3>Value</h3>

<p>The SAS-based input data frame <code>sas</code>, shortened to just the rows of <code>picks</code>, and expanded to include 
spacer rows of fields of no interest pooled into single strings: the width of such a spacer row is equal to 
the distance in bytes between the fields of interest above and below it. This data frame is then 
used by <code>laf_open_fwf()</code> of <span class="pkg">LaF</span> in <code>mkSEER()</code> to read the SEER files.  Proper use of this function, and of the SEER data in general,
requires an understanding of the contents of &lsquo;<span class="file">seerdic.pdf</span>&rsquo; in the &lsquo;<span class="file">incidence</span>&rsquo; directory of <code>seerHome</code>.
</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+getFields">getFields</a>, <a href="#topic+pickFields">pickFields</a>, <a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
(df=getFields())
(df=pickFields(df))


## End(Not run)
</code></pre>

<hr>
<h2 id='plot2D'>Plot 2D cancer incidence splines</h2><span id='topic+plot2D'></span>

<h3>Description</h3>

<p>Plots splines of incidence versus age and calendar year produced by mk2D. </p>


<h3>Usage</h3>

<pre><code class='language-R'>plot2D(seerSet, write=TRUE,outDir="~/Results/plots",col="red")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot2D_+3A_seerset">seerSet</code></td>
<td>
<p>seerSet object after it is processed by mk2D.   </p>
</td></tr>
<tr><td><code id="plot2D_+3A_write">write</code></td>
<td>
<p>TRUE if you want to write images to a seerSet subfolder. 
The name of this subfolder is the basefilename (bfn) of the seerSet. </p>
</td></tr>
<tr><td><code id="plot2D_+3A_outdir">outDir</code></td>
<td>
<p>Parent folder of seerSet subfolders.</p>
</td></tr>
<tr><td><code id="plot2D_+3A_col">col</code></td>
<td>
<p>Color of surface plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot will be produced for each cancer fitted by mk2D. For the first of these,
RGL will open a new X11 window.  Adjustments of size and angle of this 
first plot will hold for all subsequent plots. After each plot, 
the user hits any key to write the plot to a file and advance through the list of cancers.</p>


<h3>Value</h3>

<p>None, results go to the screen and to png files.   </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
n=simSeerSet()
n=mk2D(n) 
plot2D(n)

## End(Not run)
</code></pre>

<hr>
<h2 id='post1PYO'>Get person-years at risk and observed cases after first cancers </h2><span id='topic+post1PYO'></span>

<h3>Description</h3>

<p>Converts a canc data.frame into a list of objects containing information regarding person years at risk
for a second cancer after having a first cancer, and the number observed, in a defined time since exposure interval
and after a defined first cancer therapy.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>post1PYO(canc, brks=c(0,2,5),binIndx=1,Trt="rad",PYLong=FALSE,yearEnd,firstS,secondS)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post1PYO_+3A_canc">canc</code></td>
<td>
<p>Input canc data.frame that is already sex, and possibly race, specific, but not cancer specific, as 
treatment of any first cancer could potentially cause any second cancer.</p>
</td></tr>
<tr><td><code id="post1PYO_+3A_brks">brks</code></td>
<td>
<p>A vector of break points in years used to form time since diagnosis bins. </p>
</td></tr>
<tr><td><code id="post1PYO_+3A_binindx">binIndx</code></td>
<td>
<p>The index of the interval for which py are to be computed by calling this function.</p>
</td></tr>
<tr><td><code id="post1PYO_+3A_trt">Trt</code></td>
<td>
<p>The treatment for the first cancers. Note that the second cancer treatment is irrelevant here, so 
the input canc must not be reduced to only certain treatment types. </p>
</td></tr>
<tr><td><code id="post1PYO_+3A_pylong">PYLong</code></td>
<td>
<p>PYLong of tsd.</p>
</td></tr>
<tr><td><code id="post1PYO_+3A_yearend">yearEnd</code></td>
<td>
<p>This is taken from the seerSet object.</p>
</td></tr>
<tr><td><code id="post1PYO_+3A_firsts">firstS</code></td>
<td>
<p>Vector of first cancers of interest as strings.</p>
</td></tr>
<tr><td><code id="post1PYO_+3A_seconds">secondS</code></td>
<td>
<p>Vector of second cancers of interest as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where the first element is a list LPYM with as many PY matrices (PYM) as cancers in canc. The second
element is a matrix of cases observed in this interval after this treatment, where row names are first cancers and column names
are second cancers. The third element is a trivial scalar, the py-weighted midpoint of the time interval selected. </p>


<h3>Note</h3>

<p>After the SEER data is installed, see the script mkRRtsx.R in the examples folder. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+getE">getE</a>,<a href="#topic+seerSet">seerSet</a></code> </p>

<hr>
<h2 id='post1PYOc'>Get person-years at risk and observed cases after first cancers </h2><span id='topic+post1PYOc'></span>

<h3>Description</h3>

<p>Converts a canc data.frame into a list of objects containing information regarding person years at risk
for a second cancer after having a first cancer, and the number observed, in defined intervals of time since diagnosis, calendar year, and age at diagnosis.   </p>


<h3>Usage</h3>

<pre><code class='language-R'>post1PYOc(canc, brkst=c(0),binIndxt=1,brksy=c(1973),binIndxy=1,brksa=c(0),binIndxa=1,
             Trt="rad",PYLong=FALSE,yearEnd,firstS,secondS)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post1PYOc_+3A_canc">canc</code></td>
<td>
<p>Input canc data.frame that is already sex, and possibly race, specific, but not cancer specific, as 
treatment of any first cancer could potentially cause any second cancer.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_brkst">brkst</code></td>
<td>
<p>Vector of breaks in years used to form tsd intervals/bins. An upper limit of 100, well beyond 40 years
of SEER follow up currently available, is assumed/added to brkst internally, and should thus not be in brkst. </p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_binindxt">binIndxt</code></td>
<td>
<p>The index of the tsd interval for which py are to be computed by calling this function.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_brksy">brksy</code></td>
<td>
<p>Vector of breaks used to form groups of calendar year at diagnosis intervals/bins.
An upper limit of yearEnd (last year in SEER; a seerSet field) is assumed/added to brksy internally.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_binindxy">binIndxy</code></td>
<td>
<p>The index of the year interval for which py are to be computed by calling this function.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_brksa">brksa</code></td>
<td>
<p>Vector of breaks used to form groups of age at diagnosis intervals/bins. An upper limit of 126 is assumed. </p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_binindxa">binIndxa</code></td>
<td>
<p>The index of the age at DX interval for which py are to be computed by calling this function.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_trt">Trt</code></td>
<td>
<p>The treatment for the first cancers. Note that the second cancer treatment is irrelevant here, so 
the input canc must not be reduced to only certain treatment types. </p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_pylong">PYLong</code></td>
<td>
<p>PYLong of tsd.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_yearend">yearEnd</code></td>
<td>
<p>This is taken from the seerSet object.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_firsts">firstS</code></td>
<td>
<p>Vector of first cancers of interest as strings.</p>
</td></tr>
<tr><td><code id="post1PYOc_+3A_seconds">secondS</code></td>
<td>
<p>Vector of second cancers of interest as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where the first element is a list LPYM with as many PY matrices (PYM) as cancers in canc. The second
element is a matrix of cases observed in this interval after this treatment, where row names are first cancers and column names
are second cancers. And after a few other slots, the last element is a trivial scalar, the py-weighted midpoint of the time interval selected. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+getE">getE</a>,<a href="#topic+seerSet">seerSet</a></code> </p>

<hr>
<h2 id='post1PYOm'>Get person-years at risk and observed deaths after cancer </h2><span id='topic+post1PYOm'></span>

<h3>Description</h3>

<p>Converts data.frame D into a list of objects containing information regarding person years at risk
of death after cancer and the number of deaths observed, in a defined time since exposure interval.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>post1PYOm(D,brks=c(0,2,5),binIndx=1,yearEnd)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="post1PYOm_+3A_d">D</code></td>
<td>
<p>Input data.frame with columns: yrdx, agedx, surv, and status (1=dead).</p>
</td></tr>
<tr><td><code id="post1PYOm_+3A_brks">brks</code></td>
<td>
<p>A vector of break points in years used to form time since diagnosis bins. </p>
</td></tr>
<tr><td><code id="post1PYOm_+3A_binindx">binIndx</code></td>
<td>
<p>The index of the interval for which py are to be computed by calling this function.</p>
</td></tr>
<tr><td><code id="post1PYOm_+3A_yearend">yearEnd</code></td>
<td>
<p>The most recent year of available mortality data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where the first element is a PY matrix (PYM), the second
element is a vector of deaths observed in the intervals, and the third is a scalar, the py-weighted midpoint of the time intervals. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+getE">getE</a>,<a href="#topic+post1PYO">post1PYO</a></code> </p>

<hr>
<h2 id='print.seerSet.summary'>Prints seerSet.summary objects</h2><span id='topic+print.seerSet.summary'></span>

<h3>Description</h3>

<p>Renders data.frame of cases and median ages and
survival times with a title above and notes below it. Also qplots PY versus years.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seerSet.summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.seerSet.summary_+3A_x">x</code></td>
<td>
<p>seerSet.summary object produced by summary.seerSet(). </p>
</td></tr>
<tr><td><code id="print.seerSet.summary_+3A_...">...</code></td>
<td>
<p>Included to match arg list of generic print. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+summary.seerSet">summary.seerSet</a>, <a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
canc=canc%&gt;%select(casenum,race:histo3,surv,cancer,trt,id) 
popsa=popsae%&gt;%group_by(db,race,sex,age,year)%&gt;%summarize(py=sum(py)) # sum on regs
pm=seerSet(canc,popsa,Sex="male",ageStart=0,ageEnd=100) #pooled (races) male seerSet
pm # no print method for seerSet object, so we see the list
summary(pm) # print method for summary renders the summary and a plot of PY

## End(Not run)
</code></pre>

<hr>
<h2 id='riskVsAge'>Second cancer risk vs attained age after first cancer</h2><span id='topic+riskVsAge'></span>

<h3>Description</h3>

<p>Computes absolute risk of 2nd cancers as a function of attained age after first cancer. </p>


<h3>Usage</h3>

<pre><code class='language-R'>riskVsAge(canc,firstS=c("NHL","HL","MM"),
                secondS=c("AML","MDS"),brksa=c(0,30,50,60,70,80)) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="riskVsAge_+3A_canc">canc</code></td>
<td>
<p>canc made by mkSEER().</p>
</td></tr>
<tr><td><code id="riskVsAge_+3A_firsts">firstS</code></td>
<td>
<p>Character vector of first cancers of interest.</p>
</td></tr>
<tr><td><code id="riskVsAge_+3A_seconds">secondS</code></td>
<td>
<p>Character vector of second cancers of interest.</p>
</td></tr>
<tr><td><code id="riskVsAge_+3A_brksa">brksa</code></td>
<td>
<p>Vector of breaks in years used to form attained age intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with incidence vs age. </p>


<h3>Note</h3>

<p> This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mkSEER">mkSEER</a></code> </p>

<hr>
<h2 id='seerSet'>Join SEER cancers and PY</h2><span id='topic+seerSet'></span>

<h3>Description</h3>

<p>Creates a sex-specific list of cancer and population person year (PY) data frames, possibly specific 
to a race and interval of ages at diagnosis. </p>


<h3>Usage</h3>

<pre><code class='language-R'>seerSet(canc,popsa,Sex, Race="pooled",ageStart=15,ageEnd=85)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seerSet_+3A_canc">canc</code></td>
<td>
<p>Data frame of cancers that includes agedx, sex, race, yrdx, modx, surv and cancer. </p>
</td></tr>
<tr><td><code id="seerSet_+3A_popsa">popsa</code></td>
<td>
<p>Data frame of population PY at 1-year age resolution.  </p>
</td></tr>
<tr><td><code id="seerSet_+3A_sex">Sex</code></td>
<td>
<p>&quot;male&quot;  or &quot;female&quot;. </p>
</td></tr>
<tr><td><code id="seerSet_+3A_race">Race</code></td>
<td>
<p>&quot;white&quot;, &quot;black&quot;, &quot;other&quot;,  or &quot;pooled&quot; (default).</p>
</td></tr>
<tr><td><code id="seerSet_+3A_agestart">ageStart</code>, <code id="seerSet_+3A_ageend">ageEnd</code></td>
<td>
<p>canc and popsa will be reduced to ages in ageEnd&gt;age&gt;=ageStart.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the output: 1) 0.5 years is added to ages at diagnosis (agedx) 
to reverse SEER flooring to integers; 2) 0.5 months is added to survival months (again, to reverse flooring) 
before dividing by 12 to convert to years; 
3) year of diagnosis integers are converted to reals by adding to them the month of diagnosis (modx) - 0.5 
divided by 12 (note that a modx of 1 represents anytime in the month of January).
If ageEnd&gt;85, popsae (extended to ages up to 99) should be used as the input for popsa. 
If popsa is used, the age86 column of popsa will be replaced by an age column.
The age86 and yrbrth columns of a canc are not used and will be removed if they happen to be present; 
users should manually remove any other columns not needed to minimize seerSet object sizes.
Sex and race columns in inputs are removed from outputs as they are specified
in other (scalar) seerSet elements. Also removed from canc are cancer factor levels not present for that sex. 
</p>


<h3>Value</h3>

<p>A list containing sex specific subsets of canc and popsa and information regarding how they were reduced. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>, <a href="#topic+plot2D">plot2D</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
simSeerSet() # without data, a simulated seerSet
#  else, with data ...
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
# trim columns
library(dplyr)  
canc=canc%&gt;%select(-reg,-recno,-agerec,-numprims,-COD,
          -age19,-age86,-radiatn,-ICD9,-db,-histo3) 
popsae=popsae%&gt;%select(-reg,-db)   
seerSet(canc,popsae,Sex="male",ageStart=0,ageEnd=100) 

## End(Not run)
</code></pre>

<hr>
<h2 id='seerStats'>Summarize SEER data.</h2><span id='topic+seerStats'></span>

<h3>Description</h3>

<p>Shows numbers of cases per cancer in each SEER database and PY in each registry. Sexes are pooled. </p>


<h3>Usage</h3>

<pre><code class='language-R'>seerStats(canc,popsa)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seerStats_+3A_canc">canc</code></td>
<td>
<p>Data frame of cancers that includes agedx and cancer columns. </p>
</td></tr>
<tr><td><code id="seerStats_+3A_popsa">popsa</code></td>
<td>
<p>Data frame of population PY at 1-year age resolution.  </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 2 data.frames with sexes pooled, one of cases with cancer types as rows and as columns, databases, totals, cases &gt;=100 years old or not, and numbers of first-, second-, third- and higher cancers. The second data.frame holds population PY, and PY-weighted ages, per registry. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>, <a href="#topic+plot2D">plot2D</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
seerStats(canc,popsae)

## End(Not run)
</code></pre>

<hr>
<h2 id='Sigurdson'>Chromosome translocation versus age data</h2><span id='topic+Sigurdson'></span>

<h3>Description</h3>

<p>This is chromosome translocation versus age data that is pooled across gender and race.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Sigurdson)</code></pre>


<h3>Format</h3>

<p>A data frame named Sigurdson with the following columns.
</p>

<dl>
<dt><code>age</code></dt><dd><p>Age of donor of lymphocytes. </p>
</dd>
<dt><code>tlcn</code></dt><dd><p>Total number of chromosomal translocations per 100 cell equivalents. </p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were obtained using FISH, see reference below. This dataset is loaded automatically with 
<code>library(SEERaBomb)</code>. As such, the function <code>data()</code> is not needed.  </p>


<h3>References</h3>

<p>Sigurdson et al. Mutation Research 652 (2008) 112-121
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
with(Sigurdson,plot(age,tlcn,cex=2,cex.axis=2,cex.lab=2,las=1,cex.main=2,
               ylab="",main="Translocations per 100 cells"))
</code></pre>

<hr>
<h2 id='simSeerSet'>Simulate SEER cancers and population person years</h2><span id='topic+simSeerSet'></span>

<h3>Description</h3>

<p>Simulates data for two cancers, A and B. </p>


<h3>Usage</h3>

<pre><code class='language-R'>simSeerSet(N=2e9,yearEnd=2016,ka=1e-5,kb=0.04,Ab=1e-5,
                 tauA=10,tauB=1,delay=1,period=4)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simSeerSet_+3A_n">N</code></td>
<td>
<p>Number of person years to simulate. Default is roughly that of SEER. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_yearend">yearEnd</code></td>
<td>
<p>Most recent SEER year to simulate. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_ka">ka</code></td>
<td>
<p>Rate at which cancer A incidence increases linearly with age. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_kb">kb</code></td>
<td>
<p>Exponential aging rate constant for cancer B incidence. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_ab">Ab</code></td>
<td>
<p>Exponential amplitude for cancer B incidence. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_taua">tauA</code></td>
<td>
<p>Survival mean in years for cancer A. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_taub">tauB</code></td>
<td>
<p>Survival mean in years for cancer B. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_delay">delay</code></td>
<td>
<p>Years until the beginning of the excess risk of B. </p>
</td></tr>
<tr><td><code id="simSeerSet_+3A_period">period</code></td>
<td>
<p>Duration in Years of the excess risk of B. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simulated seerSet object with popsa filled using US 2000 Std population proportions and canc with 
cancers A and B
where the incidence of A increases linearly with age and B increase exponentially in age.
Survival times are assumed to be exponentially distributed with means of tauA years for A and tauB years for B.
Radiation therapy of A is assumed to increase RR of B to 5 uniformly for <code>period</code> years after <code>delay</code> years.</p>


<h3>Note</h3>

<p>Supported by the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+seerSet">seerSet</a>,<a href="#topic+mk2D">mk2D</a>, <a href="#topic+plot2D">plot2D</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
n=simSeerSet()
n=mk2D(n,secondS="B") 
mybrks=c(0,0.75,0.9,1.1,1.25,2,2.5,3,3.5,4,4.75,4.9,5.1,5.25,6)
n=tsd(n,brks=mybrks,trts=c("rad","noRad")) 
D=mkDF(n)%&gt;%filter(cancer1=="A")%&gt;%select(t,RR,L=rrL,U=rrU,trt)
head(D,2)
library(ggplot2)
theme_update(legend.position = c(.8, .815),
             axis.text=element_text(size=rel(1.2)),
             axis.title=element_text(size=rel(1.3)),
             legend.title=element_text(size=rel(1.2)),
             legend.text=element_text(size=rel(1.2)))
g=qplot(x=t,y=RR,col=trt,data=D,geom=c("line","point"),
        xlab="Years Since First Cancer Diagnosis",ylab="Relative Risk")
g+geom_abline(intercept=1, slope=0)+geom_errorbar(aes(ymin=L,ymax=U,width=.05))

## End(Not run)
</code></pre>

<hr>
<h2 id='simSurv'>Simulate Survival Times</h2><span id='topic+simSurv'></span>

<h3>Description</h3>

<p>Uses background mortality rates to simulate background survival time for matching sex, age and year.</p>


<h3>Usage</h3>

<pre><code class='language-R'> simSurv(d,mrt,rep=1,ltb=NULL,unif=TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simSurv_+3A_d">d</code></td>
<td>
<p>Data frame containing sex, agedx, yrdx, surv, and status columns of observed data. </p>
</td></tr>
<tr><td><code id="simSurv_+3A_mrt">mrt</code></td>
<td>
<p>Mortality data binary made by mkMrt().  </p>
</td></tr>
<tr><td><code id="simSurv_+3A_rep">rep</code></td>
<td>
<p>Number of simulated replicates of each observed case.  </p>
</td></tr>
<tr><td><code id="simSurv_+3A_ltb">ltb</code></td>
<td>
<p>Life table data binary made by mkLT(). Default of NULL =&gt; skip it.    </p>
</td></tr>
<tr><td><code id="simSurv_+3A_unif">unif</code></td>
<td>
<p>TRUE =&gt; death time in final year is uniform random draw. False =&gt; death at mid-point of year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Input d with simulation rows added below it, identified as &quot;simulated&quot; in a new column called type.</p>


<h3>Author(s)</h3>

<p> Tom Radivoyevitch (<a href="mailto:radivot@ccf.org">radivot@ccf.org</a>) </p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>,<a href="#topic+mkSEER">mkSEER</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
mkLT()
load("~/data/usMort/ltb.RData")
tail(ltb$Female)

## End(Not run)
</code></pre>

<hr>
<h2 id='stdUS'>The standard population of the US in 2000</h2><span id='topic+stdUS'></span>

<h3>Description</h3>

<p>The US population in 2000 for ages up to 100 years. Sexes are pooled.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdUS
</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns.
</p>

<dl>
<dt><code>age</code></dt><dd><p>Sigle-year resolution ages up to 100. </p>
</dd>
<dt><code>pop</code></dt><dd><p>The population within each age group. </p>
</dd>
<dt><code>prop</code></dt><dd><p>Proportion of the total population within each age group. </p>
</dd>
</dl>



<h3>Details</h3>

<p>This population data can be used to map age specific incidence rate vectors
into summarizing scalars. It allows cancer incidence rates across different
SEER registries to be compared without concerns of differences in age distributions of the populations. 
</p>


<h3>References</h3>

<p><a href="http://seer.cancer.gov/stdpopulations/">http://seer.cancer.gov/stdpopulations/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(SEERaBomb)
with(stdUS,plot(age,pop/1e6,type="l",xlab="Age",
     ylab="People (Millions)",main="US Population in 2000"))
library(dplyr)
stdUS%&gt;%filter(age&gt;=85)%&gt;%summarize(weighted.mean(age,w=pop)) 
### so ave age &gt;=85.0 is 89.4
</code></pre>

<hr>
<h2 id='summary.seerSet'>Summary of seerSet object</h2><span id='topic+summary.seerSet'></span>

<h3>Description</h3>

<p>Creates a data.frame of cases and median ages and
survival times for each cancer and treatment type. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seerSet'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.seerSet_+3A_object">object</code></td>
<td>
<p>seerSet object produced by seerSet(). </p>
</td></tr>
<tr><td><code id="summary.seerSet_+3A_...">...</code></td>
<td>
<p>Included to match arg list of generic summary. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that includes: a data.frame of cases, median ages at diagnosis, and
survival times, in years, for each cancer and treatment type; a data.frame of person-years by year; and 
smaller things such as a title, sex, race, and notes. The resulting list is set to class seerSet.summary 
which has a print method. </p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>, <a href="#topic+plot2D">plot2D</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
library(SEERaBomb)
load("~/data/SEER/mrgd/cancDef.RData") #load in canc
load("~/data/SEER/mrgd/popsae.RData") # load in popsae
canc=canc%&gt;%select(casenum,race:yrdx,surv,cancer,trt,id) 
popsa=popsae%&gt;%group_by(db,race,sex,age,year)%&gt;%summarize(py=sum(py)) # sum on regs
pm=seerSet(canc,popsa,Sex="male",ageStart=0,ageEnd=100) #pooled (races) male seerSet
pm # no print method for seerSet object, so we see the list
(x=summary(pm)) # print renders summary and plot of PY
class(x)&lt;-NULL #if you want to see the list as is, kill its class.
x    # It then goes through the regular print method for lists.

## End(Not run)
</code></pre>

<hr>
<h2 id='tsd'>Compute RR vs tsd</h2><span id='topic+tsd'></span>

<h3>Description</h3>

<p>Computes relative risks (RR) over specified times since diagnoses (tsd) of a 1st cancer. 2D spline fits are used to produce expected cases E controlling for background risk dedepence on 
age and calendar year.  RR is then O/E where O is the number of observed cases.
WARNING: Use of this function is deprecated, please use csd() instead.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsd(seerSet,brks,trts=NULL,PYLong=FALSE,firstS="all") </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsd_+3A_seerset">seerSet</code></td>
<td>
<p>A seerSet object produced by mk2D().  </p>
</td></tr>
<tr><td><code id="tsd_+3A_brks">brks</code></td>
<td>
<p>Vector of breaks in years used to form tsd intervals/bins. </p>
</td></tr>
<tr><td><code id="tsd_+3A_trts">trts</code></td>
<td>
<p>Character vector of treatments of interest. Default of NULL =&gt; all levels in seerSet's canc$trt. </p>
</td></tr>
<tr><td><code id="tsd_+3A_pylong">PYLong</code></td>
<td>
<p>Set true if in addition to O and E for each tsd interval you also want PY strips
for each individual; having these big dataframes slows saving seerSets, so only fetch if needed.</p>
</td></tr>
<tr><td><code id="tsd_+3A_firsts">firstS</code></td>
<td>
<p>Character vector of first cancers of interest. Default of &quot;all&quot; sets it to the vector of all cancers
in the seerSet field cancerS, which is created when the object is first created by seerSet().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input with an L component added to it or extended it if it already existed. Each component of
L is a nested list of lists that can yield
second cancer relative risks as a function of time since diagnosis and different first cancers and if they 
were irradiated or not. 
</p>


<h3>Note</h3>

<p> This function was developed with support from the Cleveland Clinic Foundation.</p>


<h3>Author(s)</h3>

<p>Tom Radivoyevitch (radivot@ccf.org)</p>


<h3>See Also</h3>

<p><code><a href="#topic+SEERaBomb-package">SEERaBomb-package</a>, <a href="#topic+mk2D">mk2D</a>,<a href="#topic+seerSet">seerSet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SEERaBomb)
pm=simSeerSet()
pm=mk2D(pm) 
mybrks=c(0,1,5,10)
pm=tsd(pm,brks=mybrks,trts=c("noRad","rad"),PYM=TRUE)
(lab=paste0("b",paste(mybrks,collapse="_")))
LM=pm$L[[lab]]$'rad'
names(LM)
LM$PyM
LM$Obs
LM$Exp
table(LM$PyM$`(0,1]`$cancer2)
table(LM$PyM$`(1,5]`$cancer2)
table(LM$PyM$`(5,10]`$cancer2)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
