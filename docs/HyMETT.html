<!DOCTYPE html><html><head><title>Help for package HyMETT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HyMETT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#benchmark_KGE_DOY'><p>Calculate benchmark Kling&ndash;Gupta efficiency (KGE) values from day-of-year (DOY) observations</p></a></li>
<li><a href='#calc_annual_flow_stats'><p>Calculate annual flow statistics from daily data</p></a></li>
<li><a href='#calc_annual_stat_trend'><p>Calculate trend in annual statistics</p></a></li>
<li><a href='#calc_logistic_regression'><p>Calculate logistic regression in annual statistics with zero values</p></a></li>
<li><a href='#calc_qlpearsonIII'><p>Quantile of Pearson Type III distribution for log-transformed data</p></a></li>
<li><a href='#calc_qpearsonIII'><p>Quantile of Pearson Type III distribution</p></a></li>
<li><a href='#censor_values'><p>Censor values above or below a threshold</p></a></li>
<li><a href='#example_annual'><p>Example Annual Observations</p></a></li>
<li><a href='#example_mod'><p>Example Model Output</p></a></li>
<li><a href='#example_mod_zf'><p>Example Model Output with zero flows</p></a></li>
<li><a href='#example_obs'><p>Example Observations</p></a></li>
<li><a href='#example_obs_zf'><p>Example Observations with zero flows</p></a></li>
<li><a href='#example_preproc'><p>Example Observations prepocessed</p></a></li>
<li><a href='#GOF_correlation_tests'><p>Calculates Kendall's Tau, Spearman's Rho, Pearson Correlation</p></a></li>
<li><a href='#GOF_kling_gupta_efficiency'><p>Calculate Kling&ndash;Gupta Efficiency (KGE)</p></a></li>
<li><a href='#GOF_mean_absolute_error'><p>Calculates mean absolute error (MAE).</p></a></li>
<li><a href='#GOF_mean_error'><p>Calculates mean error.</p></a></li>
<li><a href='#GOF_nash_sutcliffe_efficiency'><p>Calculate Nash&ndash;Sutcliffe Efficiency (NSE)</p></a></li>
<li><a href='#GOF_percent_bias'><p>Calculates percent bias.</p></a></li>
<li><a href='#GOF_rmse'><p>Calculate root-mean-square error with options to normalize</p></a></li>
<li><a href='#GOF_summary'><p>Calculate Goodness-of-fit metrics and output into table</p></a></li>
<li><a href='#GOF_volumetric_efficiency'><p>Calculate Volumetric Efficiency</p></a></li>
<li><a href='#HyMETT-package'><p>Hydrologic Model Evaluation and Time-series Tools</p></a></li>
<li><a href='#POR_apply_annual_hiflow_stats'><p>Calculate the 50th and 90th percentiles of a streamflow time series</p></a></li>
<li><a href='#POR_apply_annual_lowflow_stats'><p>Calculate 10-year and 2-year return periods of a streamflow time series</p></a></li>
<li><a href='#POR_calc_amp_and_phase'><p>Calculate the seasonal amplitude and phase of a daily time series</p></a></li>
<li><a href='#POR_calc_AR1'><p>calculates lag-one autocorrelation (AR1) coefficient for a time series</p></a></li>
<li><a href='#POR_calc_lp3_quantile'><p>Calculate quantile from fitted log-Pearson type III distribution</p></a></li>
<li><a href='#POR_deseasonalize'><p>Removes seasonal trends from a daily or monthly time series.</p></a></li>
<li><a href='#POR_distribution_metrics'><p>Calculates various metrics that describe the distribution of a time series of streamflow</p></a></li>
<li><a href='#preproc_audit_data'><p>Audit daily data for total days in year</p></a></li>
<li><a href='#preproc_fill_daily'><p>Fills daily data with missing dates as <code>NA</code> values</p></a></li>
<li><a href='#preproc_main'><p>A wrapper function for preproc_precondition_data, preproc_audit_data, and calc_annual_flow_stats</p></a></li>
<li><a href='#preproc_precondition_data'><p>Pre-conditions data with time information and n-day moving averages</p></a></li>
<li><a href='#preproc_validate_daily'><p>Validates that daily data do not contain gaps</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hydrologic Model Evaluation and Time-Series Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-21</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates the analysis and evaluation of hydrologic model output and 
    time-series data with functions focused on comparison of modeled (simulated) and observed data, 
    period-of-record statistics, and trends.  </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://code.usgs.gov/hymett/hymett">https://code.usgs.gov/hymett/hymett</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://code.usgs.gov/hymett/hymett/-/issues">https://code.usgs.gov/hymett/hymett/-/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, dplyr, EnvStats, lmomco, lubridate, plyr, rlang,
stats, tibble, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, roxygen2, testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>Copyright:</td>
<td>This software is in the public domain because it contains
materials that originally came from the U.S. Geological Survey,
an agency of the U.S. Department of Interior. For more
information, see the official USGS copyright policy at
http://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-21 21:01:29 UTC; cpenn</td>
</tr>
<tr>
<td>Author:</td>
<td>Colin Penn <a href="https://orcid.org/0000-0002-5195-2744"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Caelan Simeone <a href="https://orcid.org/0000-0003-3263-6452"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sara Levin <a href="https://orcid.org/0000-0002-2448-3129"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Samuel Saxe <a href="https://orcid.org/0000-0003-1151-8908"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Sydney Foks <a href="https://orcid.org/0000-0002-7668-9735"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Robert Dudley <a href="https://orcid.org/0000-0002-0934-0568"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [dtc],
  Glenn Hodgkins <a href="https://orcid.org/0000-0002-4916-5565"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [dtc],
  Timothy Hodson <a href="https://orcid.org/0000-0003-0962-5130"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas Over <a href="https://orcid.org/0000-0001-8280-4368"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [dtc],
  Amy Russell <a href="https://orcid.org/0000-0003-0582-0094"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [dtc]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Colin Penn &lt;cpenn@usgs.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-22 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='benchmark_KGE_DOY'>Calculate benchmark Kling&ndash;Gupta efficiency (KGE) values from day-of-year (DOY) observations</h2><span id='topic+benchmark_KGE_DOY'></span>

<h3>Description</h3>

<p>Calculate benchmark Kling&ndash;Gupta efficiency (KGE) values from daily observed
time-series data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>benchmark_KGE_DOY(obs_preproc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="benchmark_KGE_DOY_+3A_obs_preproc">obs_preproc</code></td>
<td>
<p>'data.frame' of daily observational data, preprocessed as output from <br />
<code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code> or <code><a href="#topic+preproc_main">preproc_main</a></code> <code>"daily"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates a &quot;benchmark&quot; KGE value (see Knoben and others, 2020) from a daily
observed data time-series. First, the interannual mean and median is calculated for each day of
the calendar year. Next, the interannual mean and median values are joined to each corresponding
day in the observation time series. Finally, a KGE value (<code><a href="#topic+GOF_kling_gupta_efficiency">GOF_kling_gupta_efficiency</a></code>) is
calculated comparing the mean or median value repeated time series to the daily observational
time series. These benchmark KGE values can be used as comparisons for modeled (simulated)
calibration results.
</p>


<h3>Value</h3>

<p>A data.frame with columns <code>"KGE_DOY_mean"</code> and <code>"KGE_DOY_median"</code>.
</p>


<h3>References</h3>

<p>Knoben, W.J.M, Freer, J.E., Peel, M.C., Fowler, K.J.A, Woods, R.A., 2020. A Brief Analysis of
Conceptual Model Structure Uncertainty Using 36 Models and 559 Catchments: Water Resources
Research, v. 56.<br />
[Also available at https://doi.org/10.1029/2019WR025975.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>benchmark_KGE_DOY(obs_preproc = example_preproc)

</code></pre>

<hr>
<h2 id='calc_annual_flow_stats'>Calculate annual flow statistics from daily data</h2><span id='topic+calc_annual_flow_stats'></span>

<h3>Description</h3>

<p>Calculate annual flow statistics from daily data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_annual_flow_stats(
  data = NULL,
  Date,
  year_group,
  Q,
  Q3 = NA_real_,
  Q7 = NA_real_,
  Q30 = NA_real_,
  jd = NA_integer_,
  calc_high = FALSE,
  calc_low = FALSE,
  calc_percentiles = FALSE,
  calc_monthly = FALSE,
  calc_WSCVD = FALSE,
  longitude = NA,
  calc_ICVD = FALSE,
  zero_threshold = 33,
  quantile_type = 8,
  na.action = c("na.omit", "na.pass")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_annual_flow_stats_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code>,<br />
<code>year_group</code>, <code>Q</code>, and <code style="white-space: pre;">&#8288;Q3, Q7, Q30, jd&#8288;</code> (if required). Column names are specified as strings
in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or character' string identifying
Date column name when <code>data</code> is specified. Date associated with each value in <code>Q</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_year_group">year_group</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying
grouping column name when <code>data</code> is specified. Year grouping for each daily value in <code>Q</code>
parameter. Must be same length as <code>Q</code> parameter. Often <code>year_group</code> is water year or climate
year.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_q">Q</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying streamflow values
column name when <code>data</code> is specified. Daily streamflow data. Must be same length as <code>year_group</code>.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_q3">Q3</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying Q3 column name
when <code>data</code> is specified. 3-day moving average of daily streamflow data <code>Q</code> parameter, often
returned from <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>. Default is <code>NA_real_</code>, required if <code>calc_high</code> or
<code>calc_low = TRUE</code>. If specified, must be same length as <code>Q</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_q7">Q7</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying Q7 column name
when <code>data</code> is specified. 7-day moving average of daily streamflow data <code>Q</code> parameter, often
returned from <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>. Default is <code>NA_real_</code>, required if <code>calc_high</code> or
<code>calc_low = TRUE</code>. If specified, must be same length as <code>Q</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_q30">Q30</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying Q30 column name
when <code>data</code> is specified. 30-day average of daily streamflow data <code>Q</code> parameter, often returned
from <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>. Default is <code>NA_real_</code>, required if <code>calc_high</code> or
<code>calc_low = TRUE</code>. If specified, must be same length as <code>Q</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_jd">jd</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying jd column name
when <code>data</code> is specified. Calendar Julian day of daily streamflow data <code>Q</code> parameter, often
returned from <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>. Default is <code>NA_integer_</code>, required if <code>calc_high</code>,
<code>calc_low</code>, <code>calc_WSCVD</code> or <code>calc_ICVD = TRUE</code>. If specified, must be same length as <code>Q</code>
parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_high">calc_high</code></td>
<td>
<p>'boolean' value. Calculate high flow statistics for years in <code>year_group</code>.
Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_low">calc_low</code></td>
<td>
<p>'boolean' value. Calculate low flow statistics for years in <code>year_group</code>.
Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_percentiles">calc_percentiles</code></td>
<td>
<p>'boolean' value. Calculate percentiles for years in <code>year_group</code>.
Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_monthly">calc_monthly</code></td>
<td>
<p>'boolean' value. Calculate monthly statistics for years in <code>year_group</code>.
Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_wscvd">calc_WSCVD</code></td>
<td>
<p>'boolean' value. Calculate winter-spring center volume date for years in
<code>year_group</code>. Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_longitude">longitude</code></td>
<td>
<p>'numeric' value. Site longitude in North American Datum of 1983 (NAD83),
required in WSCVD calculation. Default is <code>NA</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_calc_icvd">calc_ICVD</code></td>
<td>
<p>'boolean' value. Calculate inverse center volume date for years in <code>year_group</code>.
Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p>'numeric' value as percentage. The percentage of years of a statistic that
need to be zero in order for it to be deemed a zero flow site for that statistic. For use in
trend calculation. See <strong>Details</strong> on attributes. Default is <code>33</code> (33 percent) of the
annual statistic values.</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_quantile_type">quantile_type</code></td>
<td>
<p>'numeric' value. The distribution type used in the <code><a href="stats.html#topic+quantile">stats::quantile</a></code>
function. Default is <code>8</code> (median-unbiased regardless of distribution). Other
types common in hydrology are <code>6</code> (Weibull) or <code>9</code> (unbiased for normal distributions).</p>
</td></tr>
<tr><td><code id="calc_annual_flow_stats_+3A_na.action">na.action</code></td>
<td>
<p>'character' string indicating na.action passed to <code><a href="stats.html#topic+aggregate">stats::aggregate</a></code>
<code>na.action</code> parameter. Default is <code>"na.omit"</code>, which removes <code>NA</code> values before aggregating
statistics, or <code>"na.pass"</code>, which will pass <code>NA</code> values and return <code>NA</code> in the grouped calculation
if any <code>NA</code> values are present.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>year_group</code> is commonly water year, climate year, or calendar year.<br />
</p>
<p>Default annual statistics returned:
</p>

<dl>
<dt><code>annual_mean</code></dt><dd><p>annual mean in <code>year_group</code></p>
</dd>
<dt><code>annual_sd</code></dt><dd><p>annual standard deviation in <code>year_group</code></p>
</dd>
<dt><code>annual_sum</code></dt><dd><p>annual sum in <code>year_group</code></p>
</dd>
</dl>

<p>If <code>calc_high/low</code> are selected, annual statistics returned:<br />
1-, 3-, 7-, and 30-day high/low and Julian date (jd) of n-day high/low.
</p>

<dl>
<dt><code>high_q</code><em>n</em></dt><dd><p>where <em>n</em> = 1, 3, 7, and 30</p>
</dd>
<dt><code>high_q</code><em>n</em><code style="white-space: pre;">&#8288;_jd&#8288;</code></dt><dd><p>where <em>n</em> = 1, 3, 7, and 30</p>
</dd>
<dt><code>low_q</code><em>n</em></dt><dd><p>where <em>n</em> = 1, 3, 7, and 30</p>
</dd>
<dt><code>low_q</code><em>n</em><code style="white-space: pre;">&#8288;_jd&#8288;</code></dt><dd><p>where <em>n</em> = 1, 3, 7, and 30</p>
</dd>
</dl>

<p>If <code>calc_percentiles</code> is selected, annual statistics returned:<br />
1, 5, 10, 25, 50, 75, 90, 95, 99 percentile based on daily streamflow.
</p>

<dl>
<dt><code>annual_</code><em>n</em><code style="white-space: pre;">&#8288;_percentile&#8288;</code></dt><dd><p>where <em>n</em> = 1, 5, 10, 25, 50, 75, 90, 95, and 99</p>
</dd>
</dl>

<p>If <code>calc_monthly</code> is selected, annual statistics returned:<br />
Monthly mean, standard deviation, max, min, percent of annual for each month in <code>year_group</code>.
</p>

<dl>
<dt><em>month</em><code style="white-space: pre;">&#8288;_mean&#8288;</code></dt><dd><p>monthly mean, where <em>month</em> = <code><a href="base.html#topic+month.abb">month.abb</a></code></p>
</dd>
<dt><em>month</em><code style="white-space: pre;">&#8288;_sd&#8288;</code></dt><dd><p>monthly standard deviation, where <em>month</em> = <code><a href="base.html#topic+month.abb">month.abb</a></code></p>
</dd>
<dt><em>month</em><code style="white-space: pre;">&#8288;_max&#8288;</code></dt><dd><p>monthly maximum, where <em>month</em> = <code><a href="base.html#topic+month.abb">month.abb</a></code></p>
</dd>
<dt><em>month</em><code style="white-space: pre;">&#8288;_min&#8288;</code></dt><dd><p>monthly minimum, where <em>month</em> = <code><a href="base.html#topic+month.abb">month.abb</a></code></p>
</dd>
<dt><em>month</em><code style="white-space: pre;">&#8288;_percent_annual&#8288;</code></dt><dd><p>monthly percent of annual, where <em>month</em> = <code><a href="base.html#topic+month.abb">month.abb</a></code></p>
</dd>
</dl>

<p>If <code>calc_WSCVD</code> is selected, Julian date of annual winter-spring center volume date is returned.<br />
Longitude (in NAD83 datum) is used to determine the ending month of spring. July for longitudes
West of <code class="reqn">-</code>95 degrees, May for longitudes east of <code class="reqn">-</code>95 degrees. See <strong>References</strong>
Dudley and others, 2017. Commonly calculated when <code>year_group</code> is water year.
</p>

<dl>
<dt><code>WSCVD</code></dt><dd><p>Julian date of winter-spring center volume</p>
</dd>
</dl>

<p>If <code>calc_ICVD</code> is selected, Julian date of annual inverse center volume date is returned.<br />
Commonly calculated when <code>year_group</code> is climate year.
</p>

<dl>
<dt><code>ICVD</code></dt><dd><p>Julian date of inverse center volume date</p>
</dd>
</dl>

<p><strong>Attribute:</strong> <code>zero_flow_years</code><br />
A data.frame with each annual statistic calculated, the percentage of years where the
statistic = 0, a flag indicating if the percentage is over the <code>zero_threshold</code> parameter,
and the number of years with a zero value. Columns in <code>zero_flow_years</code>:
</p>

<dl>
<dt><code>annual_stat</code></dt><dd><p>annual statistic</p>
</dd>
<dt><code>percent_zeros</code></dt><dd><p>percentage of years with 0 statistic value</p>
</dd>
<dt><code>over_threshold</code></dt><dd><p>boolean if percentage is over threshold</p>
</dd>
<dt><code>number_years</code></dt><dd><p>number of years with 0 value statistic</p>
</dd>
</dl>

<p>The <code>zero_flow_years</code> attribute can be useful in trend calculation, where a trend may not be
appropriate to calculate with many zero flow years.
</p>


<h3>Value</h3>

<p>A tibble (see <code><a href="tibble.html#topic+tibble">tibble::tibble</a></code>) with annual statistics depending on options selected.
See <strong>Details</strong>.
</p>


<h3>References</h3>

<p>Dudley, R.W., Hodgkins, G.A, McHale, M.R., Kolian, M.J., Renard, B., 2017, Trends in
snowmelt-related streamflow timing in the conterminous United States: Journal of Hydrology, v.
547, p. 208-221. [Also available at https://doi.org/10.1016/j.jhydrol.2017.01.051.]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_annual_flow_stats(data = example_preproc, Date = "Date", year_group = "WY", Q = "value")

</code></pre>

<hr>
<h2 id='calc_annual_stat_trend'>Calculate trend in annual statistics</h2><span id='topic+calc_annual_stat_trend'></span>

<h3>Description</h3>

<p>Calculate trend in annual statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_annual_stat_trend(data = NULL, year, value, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_annual_stat_trend_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>year</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="calc_annual_stat_trend_+3A_year">year</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Year of each value in <code>value</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_annual_stat_trend_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying value column
name when <code>data</code> is specified. Values to calculate trend on.</p>
</td></tr>
<tr><td><code id="calc_annual_stat_trend_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from <code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper for <code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code> with the passed equation
<code>value ~ year</code>. The returned values include Mann-Kendall test statistic and p-value,
Theil-Sen slope and intercept values, and trend details (Millard, 2013; Helsel and others, 2020).
</p>

<dl>
<dt><code>z_stat</code></dt><dd><p>Mann-Kendall test statistic, returned directly from
<code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code></p>
</dd>
<dt><code>p_value</code></dt><dd><p><code>z_stat</code> p-value, returned directly from
<code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code></p>
</dd>
<dt><code>sen_slope</code></dt><dd><p>Sen slope in units value per year, returned directly from
<code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code></p>
</dd>
<dt><code>intercept</code></dt><dd><p>Sen slope intercept, returned directly from <code><a href="EnvStats.html#topic+kendallTrendTest">EnvStats::kendallTrendTest</a></code></p>
</dd>
<dt><code>trend_mag</code></dt><dd><p>Trend magnitude over entire period, in units of <code>value</code>,
calculated as <code style="white-space: pre;">&#8288;sen_slope * (max(year)&#8288;</code> <code class="reqn">-</code> <code style="white-space: pre;">&#8288;min(year))&#8288;</code></p>
</dd>
<dt><code>val_beg/end</code></dt><dd><p>Calculated value at beginning or end of period, calculated as
<code>sen_slope * year + intercept</code></p>
</dd>
<dt><code>val_perc_change</code></dt><dd><p>Percentage change over period, calculated as
<code>(val_end - val_beg) / val_beg * 100</code></p>
</dd>
</dl>



<h3>Value</h3>

<p>A tibble (see <code><a href="tibble.html#topic+tibble">tibble::tibble</a></code>) with test statistic, p-value, trend coefficients, and
trend calculations. See <strong>Details</strong>.
</p>


<h3>References</h3>

<p>Millard, S.P., 2013, EnvStats: An R Package for Environmental Statistics: New York, New York,
Springer, 291 p. [Also available at https://doi.org/10.1007/978-1-4614-8456-1.]
</p>
<p>Helsel, D.R., Hirsch, R.M., Ryberg, K.R., Archfield, S.A., and Gilroy, E.J., 2020, Statistical
methods in water resources: U.S. Geological Survey Techniques and Methods, book 4, chap. A3, 458
p. [Also available at https://doi.org/10.3133/tm4a3.]
</p>


<h3>See Also</h3>

<p><code><a href="EnvStats.html#topic+kendallTrendTest">kendallTrendTest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_annual_stat_trend(data = example_annual, year = "WY", value = "annual_mean")

</code></pre>

<hr>
<h2 id='calc_logistic_regression'>Calculate logistic regression in annual statistics with zero values</h2><span id='topic+calc_logistic_regression'></span>

<h3>Description</h3>

<p>Calculate logistic regression (Everitt and Hothorn, 2009) in annual statistics with
zero values. A model fit to compute the probability of a zero flow annual statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_logistic_regression(data = NULL, year, value, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_logistic_regression_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>year</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="calc_logistic_regression_+3A_year">year</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Year of each value in <code>value</code> parameter.</p>
</td></tr>
<tr><td><code id="calc_logistic_regression_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying value column
name when <code>data</code> is specified. Values to calculate logistic regression on.</p>
</td></tr>
<tr><td><code id="calc_logistic_regression_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from <code><a href="stats.html#topic+glm">stats::glm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper for <code style="white-space: pre;">&#8288;stats::glm(y ~ year, family = stats::binomial(link="logit")&#8288;</code>
with <code>y = 1</code> when <code>value = 0</code> (for example a zero flow annual statistic) and <code>y = 0</code> otherwise.
The returned values include
</p>

<dl>
<dt><code>p_value</code></dt><dd><p>Probability value of the explanatory (<code>year</code>) variable in the logistic model</p>
</dd>
<dt><code>stdErr_slope</code></dt><dd><p>Standard error of the regression slope (log odds per year)</p>
</dd>
<dt><code>odds_ratio</code></dt><dd><p>Exponential of the explanatory coefficient (year coefficient)</p>
</dd>
<dt><code>prob_beg/end</code></dt><dd><p>Logistic regression predicted (fitted) values at the beginning and ending year.</p>
</dd>
<dt><code>prob_change</code></dt><dd><p>Change in probability from beginning to end.</p>
</dd>
</dl>

<p>Example, an odds ratio of 1.05 represents the odds of a zero-flow year (versus non-zero)
increase by a factor of 1.05 (or 5 percent).
</p>


<h3>Value</h3>

<p>A tibble (see <code><a href="tibble.html#topic+tibble">tibble::tibble</a></code>) with logistic regression p-value, standard error of
slope, odds ratio, beginning and ending probability, and probability change. See <strong>Details</strong>.
</p>


<h3>References</h3>

<p>Everitt, B. S. and Hothorn T., 2009, A Handbook of Statistical Analyses Using R, 2nd Ed.
Boca Raton, Florida, Chapman and Hall/CRC, 376p.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_logistic_regression(data = example_annual, year = "WY", value = "annual_mean")

</code></pre>

<hr>
<h2 id='calc_qlpearsonIII'>Quantile of Pearson Type III distribution for log-transformed data</h2><span id='topic+calc_qlpearsonIII'></span>

<h3>Description</h3>

<p>Quantile of Pearson Type III distribution for log-transformed data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_qlpearsonIII(p, meanlog = 0, sdlog = 1, skew = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_qlpearsonIII_+3A_p">p</code></td>
<td>
<p>Vector of non-exceedance probabilities, between 0 and 1, to calculate quantiles.</p>
</td></tr>
<tr><td><code id="calc_qlpearsonIII_+3A_meanlog">meanlog</code></td>
<td>
<p>Vector of mean of the distribution of the log-transformed data.</p>
</td></tr>
<tr><td><code id="calc_qlpearsonIII_+3A_sdlog">sdlog</code></td>
<td>
<p>Vector of standard deviation of the distribution of the log-transformed data.</p>
</td></tr>
<tr><td><code id="calc_qlpearsonIII_+3A_skew">skew</code></td>
<td>
<p>Vector of skewness of the distribution of the log-transformed data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+calc_qpearsonIII">calc_qpearsonIII</a></code> and <code><a href="#topic+calc_qlpearsonIII">calc_qlpearsonIII</a></code> are functions to fit a log-Pearson type III
distribution from a given mean, standard deviation, and skew. This source code is replicated,
unchanged, from the <code>swmrBase</code> package in order to reduce the dependency on that package.
</p>


<h3>Value</h3>

<p>Quantiles for the described distribution
</p>


<h3>References</h3>

<p>Asquith, W.H., Kiang, J.E., and Cohn, T.A., 2017, Application of at-site peak-streamflow
frequency analyses for very low annual exceedance probabilities: U.S. Geological Survey
Scientific Investigation Report 2017–5038, 93 p.
[Also available at https://doi.org/10.3133/sir20175038.]
</p>
<p>Lorenz, D.L., 2015, smwrBase—An R package for managing hydrologic data, version 1.1.1: U.S.
Geological Survey Open-File Report 2015–1202, 7 p.<br />
[Also available at https://doi.org/10.3133/ofr20151202.]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_qpearsonIII">calc_qpearsonIII</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_qlpearsonIII(0.1)

</code></pre>

<hr>
<h2 id='calc_qpearsonIII'>Quantile of Pearson Type III distribution</h2><span id='topic+calc_qpearsonIII'></span>

<h3>Description</h3>

<p>Quantile of Pearson Type III distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_qpearsonIII(p, mean = 0, sd = 1, skew = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_qpearsonIII_+3A_p">p</code></td>
<td>
<p>Vector of non-exceedance probabilities, between 0 and 1, to calculate quantiles.</p>
</td></tr>
<tr><td><code id="calc_qpearsonIII_+3A_mean">mean</code></td>
<td>
<p>Vector of means of the distribution of the data.</p>
</td></tr>
<tr><td><code id="calc_qpearsonIII_+3A_sd">sd</code></td>
<td>
<p>Vector of standard deviation of the distribution of the data.</p>
</td></tr>
<tr><td><code id="calc_qpearsonIII_+3A_skew">skew</code></td>
<td>
<p>Vector of skewness of the distribution of the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+calc_qpearsonIII">calc_qpearsonIII</a></code> and <code><a href="#topic+calc_qlpearsonIII">calc_qlpearsonIII</a></code> are functions to fit a log-Pearson type III
distribution from a given mean, standard deviation, and skew. This source code is replicated,
unchanged, from the <code>swmrBase</code> package in order to reduce the dependency on that package.
</p>


<h3>Value</h3>

<p>Quantiles for the described distribution
</p>


<h3>References</h3>

<p>Asquith, W.H., Kiang, J.E., and Cohn, T.A., 2017, Application of at-site peak-streamflow
frequency analyses for very low annual exceedance probabilities: U.S. Geological Survey
Scientific Investigation Report 2017–5038, 93 p.
[Also available at https://doi.org/10.3133/sir20175038.]
</p>
<p>Lorenz, D.L., 2015, smwrBase—An R package for managing hydrologic data, version 1.1.1: U.S.
Geological Survey Open-File Report 2015–1202, 7 p.<br />
[Also available at https://doi.org/10.3133/ofr20151202.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calc_qpearsonIII(0.1)

</code></pre>

<hr>
<h2 id='censor_values'>Censor values above or below a threshold</h2><span id='topic+censor_values'></span>

<h3>Description</h3>

<p>Replaces values in a vector with <code>NA</code> when above or below a censor level.<br />
Censoring is <code style="white-space: pre;">&#8288;values censor_symbol censor_threshold&#8288;</code> are censored,
for example with the defaults (values lte 0 set to <code>NA</code>) all values &lt;= 0 are
replaced with <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censor_values(
  value,
  censor_threshold = 0,
  censor_symbol = c("lte", "lt", "gt", "gte")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censor_values_+3A_value">value</code></td>
<td>
<p>'numeric' vector. Values to censor.</p>
</td></tr>
<tr><td><code id="censor_values_+3A_censor_threshold">censor_threshold</code></td>
<td>
<p>'numeric' value.
Threshold to censor values on. Default is 0.</p>
</td></tr>
<tr><td><code id="censor_values_+3A_censor_symbol">censor_symbol</code></td>
<td>
<p>'character' string.<br />
Inequality symbol to censor values based on censor_threshold.<br />
Accepted values are <code>"gt"</code> (greater than),<br />
<code>"gte"</code> (greater than or equal to),<br />
<code>"lt"</code> (less than),<br />
or <code>"lte"</code> (less than or equal to).<br />
Default is <code>"lte"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'numeric' vector with censored values replaced with <code>NA</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>censor_values(value = seq.int(1, 10, 1), censor_threshold = 5)

</code></pre>

<hr>
<h2 id='example_annual'>Example Annual Observations</h2><span id='topic+example_annual'></span>

<h3>Description</h3>

<p>An example dataset with daily observed streamflow processed to annual water year values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_annual
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>WY</code></dt><dd><p>water year</p>
</dd>
<dt><code>annual_mean</code></dt><dd><p>annual mean</p>
</dd>
<dt><code>annual_sd</code></dt><dd><p>annual standard deviation</p>
</dd>
<dt><code>annual_sum</code></dt><dd><p>annual sum</p>
</dd>
<dt><code>high_q1</code></dt><dd><p>annual maximum of daily mean</p>
</dd>
<dt><code>high_q3</code></dt><dd><p>annual maximum of 3-day mean</p>
</dd>
<dt><code>high_q7</code></dt><dd><p>annual maximum of 7-day mean</p>
</dd>
<dt><code>high_q30</code></dt><dd><p>annual maximum of 30-day mean</p>
</dd>
<dt><code>high_q1_jd</code></dt><dd><p>Julian day of annual maximum of daily mean</p>
</dd>
<dt><code>high_q3_jd</code></dt><dd><p>Julian day of annual maximum of 3-day mean</p>
</dd>
<dt><code>high_q7_jd</code></dt><dd><p>Julian day of annual maximum of 7-day mean</p>
</dd>
<dt><code>high_q30_jd</code></dt><dd><p>Julian day of annual maximum of 30-day mean</p>
</dd>
<dt><code>low_q7</code></dt><dd><p>annual minimum of 7-day mean</p>
</dd>
<dt><code>low_q30</code></dt><dd><p>annual minimum of 30-day mean</p>
</dd>
<dt><code>low_q3</code></dt><dd><p>annual minimum of 3-day mean</p>
</dd>
<dt><code>low_q1</code></dt><dd><p>annual minimum of daily mean</p>
</dd>
<dt><code>low_q7_jd</code></dt><dd><p>Julian day of annual minimum of 7-day mean</p>
</dd>
<dt><code>low_q30_jd</code></dt><dd><p>Julian day of annual minimum of 30-day mean</p>
</dd>
<dt><code>low_q3_jd</code></dt><dd><p>Julian day of annual minimum of 3-day mean</p>
</dd>
<dt><code>low_q1_jd</code></dt><dd><p>Julian day of annual minimum of daily mean</p>
</dd>
<dt><code>annual_1_percentile</code></dt><dd><p>annual first percentile</p>
</dd>
<dt><code>annual_5_percentile</code></dt><dd><p>annual 5th percentile</p>
</dd>
<dt><code>annual_10_percentile</code></dt><dd><p>annual 10th percentile</p>
</dd>
<dt><code>annual_25_percentile</code></dt><dd><p>annual 25th percentile</p>
</dd>
<dt><code>annual_50_percentile</code></dt><dd><p>annual 50th percentile</p>
</dd>
<dt><code>annual_75_percentile</code></dt><dd><p>annual 75th percentile</p>
</dd>
<dt><code>annual_90_percentile</code></dt><dd><p>annual 90th percentile</p>
</dd>
<dt><code>annual_95_percentile</code></dt><dd><p>annual 95th percentile</p>
</dd>
<dt><code>annual_99_percentile</code></dt><dd><p>annual 99th percentile</p>
</dd>
<dt><code>Jan_mean</code></dt><dd><p>annual January mean</p>
</dd>
<dt><code>Jan_sd</code></dt><dd><p>annual January standard deviation</p>
</dd>
<dt><code>Jan_max</code></dt><dd><p>annual January maximum</p>
</dd>
<dt><code>Jan_min</code></dt><dd><p>annual January minimum</p>
</dd>
<dt><code>Jan_percent_annual</code></dt><dd><p>annual January percentage of annual sum</p>
</dd>
<dt><code>Feb_mean</code></dt><dd><p>annual February mean</p>
</dd>
<dt><code>Feb_sd</code></dt><dd><p>annual February standard deviation</p>
</dd>
<dt><code>Feb_max</code></dt><dd><p>annual February maximum</p>
</dd>
<dt><code>Feb_min</code></dt><dd><p>annual February minimum</p>
</dd>
<dt><code>Feb_percent_annual</code></dt><dd><p>annual February percentage of annual sum</p>
</dd>
<dt><code>Mar_mean</code></dt><dd><p>annual March mean</p>
</dd>
<dt><code>Mar_sd</code></dt><dd><p>annual March standard deviation</p>
</dd>
<dt><code>Mar_max</code></dt><dd><p>annual March maximum</p>
</dd>
<dt><code>Mar_min</code></dt><dd><p>annual March minimum</p>
</dd>
<dt><code>Mar_percent_annual</code></dt><dd><p>annual March percentage of annual sum</p>
</dd>
<dt><code>Apr_mean</code></dt><dd><p>annual April mean</p>
</dd>
<dt><code>Apr_sd</code></dt><dd><p>annual April standard deviation</p>
</dd>
<dt><code>Apr_max</code></dt><dd><p>annual April maximum</p>
</dd>
<dt><code>Apr_min</code></dt><dd><p>annual April minimum</p>
</dd>
<dt><code>Apr_percent_annual</code></dt><dd><p>annual April percentage of annual sum</p>
</dd>
<dt><code>May_mean</code></dt><dd><p>annual May mean</p>
</dd>
<dt><code>May_sd</code></dt><dd><p>annual May standard deviation</p>
</dd>
<dt><code>May_max</code></dt><dd><p>annual May maximum</p>
</dd>
<dt><code>May_min</code></dt><dd><p>annual May minimum</p>
</dd>
<dt><code>May_percent_annual</code></dt><dd><p>annual May percentage of annual sum</p>
</dd>
<dt><code>Jun_mean</code></dt><dd><p>annual June mean</p>
</dd>
<dt><code>Jun_sd</code></dt><dd><p>annual June standard deviation</p>
</dd>
<dt><code>Jun_max</code></dt><dd><p>annual June maximum</p>
</dd>
<dt><code>Jun_min</code></dt><dd><p>annual June minimum</p>
</dd>
<dt><code>Jun_percent_annual</code></dt><dd><p>annual June percentage of annual sum</p>
</dd>
<dt><code>Jul_mean</code></dt><dd><p>annual July mean</p>
</dd>
<dt><code>Jul_sd</code></dt><dd><p>annual July standard deviation</p>
</dd>
<dt><code>Jul_max</code></dt><dd><p>annual July maximum</p>
</dd>
<dt><code>Jul_min</code></dt><dd><p>annual July minimum</p>
</dd>
<dt><code>Jul_percent_annual</code></dt><dd><p>annual July percentage of annual sum</p>
</dd>
<dt><code>Aug_mean</code></dt><dd><p>annual August mean</p>
</dd>
<dt><code>Aug_sd</code></dt><dd><p>annual August standard deviation</p>
</dd>
<dt><code>Aug_max</code></dt><dd><p>annual August maximum</p>
</dd>
<dt><code>Aug_min</code></dt><dd><p>annual August minimum</p>
</dd>
<dt><code>Aug_percent_annual</code></dt><dd><p>annual August percentage of annual sum</p>
</dd>
<dt><code>Sep_mean</code></dt><dd><p>annual September mean</p>
</dd>
<dt><code>Sep_sd</code></dt><dd><p>annual September standard deviation</p>
</dd>
<dt><code>Sep_max</code></dt><dd><p>annual September maximum</p>
</dd>
<dt><code>Sep_min</code></dt><dd><p>annual September minimum</p>
</dd>
<dt><code>Sep_percent_annual</code></dt><dd><p>annual September percentage of annual sum</p>
</dd>
<dt><code>Oct_mean</code></dt><dd><p>annual October mean</p>
</dd>
<dt><code>Oct_sd</code></dt><dd><p>annual October standard deviation</p>
</dd>
<dt><code>Oct_max</code></dt><dd><p>annual October maximum</p>
</dd>
<dt><code>Oct_min</code></dt><dd><p>annual October minimum</p>
</dd>
<dt><code>Oct_percent_annual</code></dt><dd><p>annual October percentage of annual sum</p>
</dd>
<dt><code>Nov_mean</code></dt><dd><p>annual November mean</p>
</dd>
<dt><code>Nov_sd</code></dt><dd><p>annual November standard deviation</p>
</dd>
<dt><code>Nov_max</code></dt><dd><p>annual November maximum</p>
</dd>
<dt><code>Nov_min</code></dt><dd><p>annual November minimum</p>
</dd>
<dt><code>Nov_percent_annual</code></dt><dd><p>annual November percentage of annual sum</p>
</dd>
<dt><code>Dec_mean</code></dt><dd><p>annual December mean</p>
</dd>
<dt><code>Dec_sd</code></dt><dd><p>annual December standard deviation</p>
</dd>
<dt><code>Dec_max</code></dt><dd><p>annual December maximum</p>
</dd>
<dt><code>Dec_min</code></dt><dd><p>annual December minimum</p>
</dd>
<dt><code>Dec_percent_annual</code></dt><dd><p>annual December percentage of annual sum</p>
</dd>
<dt><code>WSV</code></dt><dd><p>winter-spring volume</p>
</dd>
<dt><code>wscvd</code></dt><dd><p>Julian date of winter-spring center volume</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated with <code><a href="#topic+example_obs">example_obs</a></code> from </p>
<pre>
HyMETT::preproc_main(data = example_obs, 
                     Date = "Date", value = "streamflow_cfs", longitude = -68)$annual</pre>


<h3>See Also</h3>

<p><code><a href="#topic+example_obs">example_obs</a></code>, <code><a href="#topic+preproc_main">preproc_main</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_annual)

</code></pre>

<hr>
<h2 id='example_mod'>Example Model Output</h2><span id='topic+example_mod'></span>

<h3>Description</h3>

<p>An example dataset with daily modeled (simulated) streamflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_mod
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date as 'character' column class.</p>
</dd>
<dt><code>streamflow_cfs</code></dt><dd><p>modeled streamflow in units of feet^3/second.</p>
</dd>
<dt><code>Date</code></dt><dd><p>date as 'Date' column class.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated from example data available at <code>system.file("extdata", "01013500_MOD.csv", package = "HyMETT")</code>
</p>


<h3>References</h3>

<p>Johnson, M., D. Blodgett, 2020, NOAA National Water Model Reanalysis Data at RENCI, HydroShare,
accessed September 17, 2020 at<br /> https://doi.org/10.4211/hs.89b0952512dd4b378dc5be8d2093310f
</p>
<p>Johnson, M., 2021, nwmHistoric: National Water Model Historic Data. R package version 0.0.0.9000,
accessed September 17, 2020 at https://github.com/mikejohnson51/nwmHistoric
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_mod)

</code></pre>

<hr>
<h2 id='example_mod_zf'>Example Model Output with zero flows</h2><span id='topic+example_mod_zf'></span>

<h3>Description</h3>

<p>An example dataset with daily modeled (simulated) streamflow that includes zero flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_mod_zf
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date as 'character' column class.</p>
</dd>
<dt><code>streamflow_cfs</code></dt><dd><p>modeled streamflow in units of feet^3/second.</p>
</dd>
<dt><code>Date</code></dt><dd><p>date as 'Date' column class.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated from example data available at <code>system.file("extdata", "08202700_MOD.csv", package = "HyMETT")</code>
</p>


<h3>References</h3>

<p>Johnson, M., D. Blodgett, 2020, NOAA National Water Model Reanalysis Data at RENCI, HydroShare,
accessed September 17, 2020 at<br /> https://doi.org/10.4211/hs.89b0952512dd4b378dc5be8d2093310f
</p>
<p>Johnson, M., 2021, nwmHistoric: National Water Model Historic Data. R package version 0.0.0.9000,
accessed September 17, 2020 at https://github.com/mikejohnson51/nwmHistoric
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_mod_zf)

</code></pre>

<hr>
<h2 id='example_obs'>Example Observations</h2><span id='topic+example_obs'></span>

<h3>Description</h3>

<p>An example dataset with daily observed streamflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_obs
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date as 'character' column class.</p>
</dd>
<dt><code>streamflow_cfs</code></dt><dd><p>observed streamflow in units of feet^3/second.</p>
</dd>
<dt><code>quality_cd</code></dt><dd><p>qualifier for value in <code>streamflow_cfs</code> (U.S. Geological Survey, 2020b)</p>
</dd>
<dt><code>Date</code></dt><dd><p>date as 'Date' column class.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated from example data available at <code>system.file("extdata", "01013500_OBS.csv", package = "HyMETT")</code>
</p>


<h3>References</h3>

<p>De Cicco, L.A., Hirsch, R.M., Lorenz, D., and Watkins, W.D., 2021, dataRetrieval: R packages for
discovering and retrieving water data available from Federal hydrologic web services, accessed
September 16, 2020 at https://doi.org/10.5066/P9X4L3GE.
</p>
<p>U.S. Geological Survey, 2020a, USGS water data for the Nation: U.S. Geological Survey National
Water Information System database, accessed September 16, 2020, at<br />
https://doi.org/10.5066/F7P55KJN.
</p>
<p>U.S. Geological Survey, 2020b, Instantaneous and Daily Data-Value Qualification Codes, in USGS
water data for the Nation: U.S. Geological Survey National Water Information System database,
accessed September 16, 2020, at https://doi.org/10.5066/F7P55KJN.
[information directly accessible at
https://help.waterdata.usgs.gov/codes-and-parameters/instantaneous-value-qualification-code-uv_rmk_cd.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_obs)

</code></pre>

<hr>
<h2 id='example_obs_zf'>Example Observations with zero flows</h2><span id='topic+example_obs_zf'></span>

<h3>Description</h3>

<p>An example dataset with daily observed streamflow that includes zero flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_obs_zf
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>date</code></dt><dd><p>date as 'character' column class.</p>
</dd>
<dt><code>streamflow_cfs</code></dt><dd><p>observed streamflow in units of feet^3/second.</p>
</dd>
<dt><code>quality_cd</code></dt><dd><p>qualifier for value in <code>streamflow_cfs</code> (U.S. Geological Survey, 2020b)</p>
</dd>
<dt><code>Date</code></dt><dd><p>date as 'Date' column class.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated from example data available at <code>system.file("extdata", "08202700_OBS.csv", package = "HyMETT")</code>
</p>


<h3>References</h3>

<p>De Cicco, L.A., Hirsch, R.M., Lorenz, D., and Watkins, W.D., 2021, dataRetrieval: R packages for
discovering and retrieving water data available from Federal hydrologic web services, accessed
September 16, 2020 at https://doi.org/10.5066/P9X4L3GE.
</p>
<p>U.S. Geological Survey, 2020a, USGS water data for the Nation: U.S. Geological Survey National
Water Information System database, accessed September 16, 2020, at<br />
https://doi.org/10.5066/F7P55KJN.
</p>
<p>U.S. Geological Survey, 2020b, Instantaneous and Daily Data-Value Qualification Codes, in USGS
water data for the Nation: U.S. Geological Survey National Water Information System database,
accessed September 16, 2020, at https://doi.org/10.5066/F7P55KJN.
[information directly accessible at
https://help.waterdata.usgs.gov/codes-and-parameters/instantaneous-value-qualification-code-uv_rmk_cd.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_obs_zf)

</code></pre>

<hr>
<h2 id='example_preproc'>Example Observations prepocessed</h2><span id='topic+example_preproc'></span>

<h3>Description</h3>

<p>An example dataset with daily observed streamflow preprocessed to include additional timing and
n-day moving averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_preproc
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following variables:
</p>

<dl>
<dt><code>Date</code></dt><dd></dd>
<dt><code>value</code></dt><dd></dd>
<dt><code>year</code></dt><dd></dd>
<dt><code>month</code></dt><dd></dd>
<dt><code>day</code></dt><dd></dd>
<dt><code>decimal_date</code></dt><dd></dd>
<dt><code>WY</code></dt><dd><p>Water Year: October 1 - September 30</p>
</dd>
<dt><code>CY</code></dt><dd><p>Climate Year: April 1 - March 30</p>
</dd>
<dt><code>Q3</code></dt><dd><p>3-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>Q7</code></dt><dd><p>7-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>Q30</code></dt><dd><p>30-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>jd</code></dt><dd><p>Julian date</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated with <code><a href="#topic+example_obs">example_obs</a></code> from </p>
<pre>
HyMETT::preproc_main(data = example_obs, 
                     Date = "Date", value = "streamflow_cfs", longitude = -68)$daily`</pre>


<h3>See Also</h3>

<p><code><a href="#topic+example_obs">example_obs</a></code>, <code><a href="#topic+preproc_main">preproc_main</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(example_preproc)

</code></pre>

<hr>
<h2 id='GOF_correlation_tests'>Calculates Kendall's Tau, Spearman's Rho, Pearson Correlation</h2><span id='topic+GOF_correlation_tests'></span>

<h3>Description</h3>

<p>Calculates Kendall's Tau, Spearman's Rho, Pearson Correlation, and p-values
as a wrapper to the <code><a href="stats.html#topic+cor.test">stats::cor.test</a></code> function. Output is tidy-style data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_correlation_tests(mod, obs, na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_correlation_tests_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_correlation_tests_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_correlation_tests_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="GOF_correlation_tests_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from <code><a href="stats.html#topic+cor.test">stats::cor.test</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="stats.html#topic+cor.test">stats::cor.test</a></code> for more details and further arguments to be passed to or from methods.
Defaults are used.
</p>


<h3>Value</h3>

<p>A tibble (<code><a href="tibble.html#topic+tibble">tibble::tibble</a></code>) with test statistic values and p-values.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor.test">cor.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_correlation_tests(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)

</code></pre>

<hr>
<h2 id='GOF_kling_gupta_efficiency'>Calculate Kling&ndash;Gupta Efficiency (KGE)</h2><span id='topic+GOF_kling_gupta_efficiency'></span>

<h3>Description</h3>

<p>Calculate Kling&ndash;Gupta Efficiency (KGE) (or modified KGE ('KGE)) between
modeled (simulated) and observed values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_kling_gupta_efficiency(mod, obs, modified = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_kling_gupta_efficiency_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_kling_gupta_efficiency_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_kling_gupta_efficiency_+3A_modified">modified</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should the KGE calculation use the original
variability ratio in the standard deviations (see Gupta and others, 2009) (<code>modified  = FALSE</code>)
or the modified variability ratio in the coefficient of variations (see Kling and others, 2012)
(<code>modified = TRUE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="GOF_kling_gupta_efficiency_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of computed KGE or 'KGE.
</p>


<h3>References</h3>

<p>Kling, H., Fuchs, M. and Paulin, M., 2012. Runoff conditions in the upper Danube basin under an
ensemble of climate change scenarios: Journal of Hydrology, v. 424-425, p. 264-277.<br />
[Also available at https://doi.org/10.1016/j.jhydrol.2012.01.011.]
</p>
<p>Gupta, H.V., Kling, H., Yilmaz, K.K., and Martinez, G.G., 2009. Decomposition of the mean
squared error and NSE performance criteria: Implications for improving hydrological modelling:
Journal of Hydrology, v. 377, no.1-2, p. 80-91.<br />
[Also available at https://doi.org/10.1016/j.jhydrol.2009.08.003.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_kling_gupta_efficiency(
  mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs
)

</code></pre>

<hr>
<h2 id='GOF_mean_absolute_error'>Calculates mean absolute error (MAE).</h2><span id='topic+GOF_mean_absolute_error'></span>

<h3>Description</h3>

<p>Calculates mean absolute error (MAE) between modeled (simulated) and observed
values. Error is defined as modeled minus observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_mean_absolute_error(mod, obs, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_mean_absolute_error_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_mean_absolute_error_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_mean_absolute_error_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed
before calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return
<code>NA</code>. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The absolute value of each modeled-observed pair error is calculated, then the mean of those
values taken. Values returned are in units of input data.
</p>


<h3>Value</h3>

<p>Value of calculated mean absolute error (MAE).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_mean_absolute_error(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)

</code></pre>

<hr>
<h2 id='GOF_mean_error'>Calculates mean error.</h2><span id='topic+GOF_mean_error'></span>

<h3>Description</h3>

<p>Calculates mean error between modeled (simulated) and observed values. Error is
defined as modeled minus observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_mean_error(mod, obs, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_mean_error_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_mean_error_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_mean_error_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values returned are in units of input data.
</p>


<h3>Value</h3>

<p>Value of calculated mean error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_mean_error(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)

</code></pre>

<hr>
<h2 id='GOF_nash_sutcliffe_efficiency'>Calculate Nash&ndash;Sutcliffe Efficiency (NSE)</h2><span id='topic+GOF_nash_sutcliffe_efficiency'></span>

<h3>Description</h3>

<p>Calculate Nash&ndash;Sutcliffe Efficiency (NSE) (with options for modified NSE) between
modeled (simulated) and observed values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_nash_sutcliffe_efficiency(mod, obs, j = 2, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_nash_sutcliffe_efficiency_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_nash_sutcliffe_efficiency_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_nash_sutcliffe_efficiency_+3A_j">j</code></td>
<td>
<p>'numeric' value. Exponent value for modified NSE (mNSE) equation. Default value is
<code>j = 2</code>, which is traditional NSE equation.</p>
</td></tr>
<tr><td><code id="GOF_nash_sutcliffe_efficiency_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of computed NSE or mNSE.
</p>


<h3>References</h3>

<p>Krause, P., Boyle, D.P., and Base, F., 2005. Comparison of different efficiency criteria for
hydrological model assessment: Advances in Geosciences, v. 5, p. 89-97.<br />
[Also available at https://doi.org/10.5194/adgeo-5-89-2005.]
</p>
<p>Legates D.R and McCabe G.J., 1999, Evaluating the use of &quot;goodness-of-fit&quot; measures in hydrologic
and hydroclimatic model validation: Water Resources Research. v. 35, no. 1, p. 233-241.
[Also available at https://doi.org/10.1029/1998WR900018.]
</p>
<p>Nash, J.E. and Sutcliffe, J.V., 1970, River flow forecasting through conceptual models part I:
A discussion of principles: Journal of Hydrology, v. 10, no. 3, p. 282-290.
[Also available at https://doi.org/10.1016/0022-1694(70)90255-6.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_nash_sutcliffe_efficiency(
  mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs
)

</code></pre>

<hr>
<h2 id='GOF_percent_bias'>Calculates percent bias.</h2><span id='topic+GOF_percent_bias'></span>

<h3>Description</h3>

<p>Calculates percent bias between modeled (simulated) and observed values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_percent_bias(mod, obs, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_percent_bias_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_percent_bias_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_percent_bias_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values returned are in percent.
</p>


<h3>Value</h3>

<p>Value of calculated percent bias as percent.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_percent_bias(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)

</code></pre>

<hr>
<h2 id='GOF_rmse'>Calculate root-mean-square error with options to normalize</h2><span id='topic+GOF_rmse'></span>

<h3>Description</h3>

<p>Calculate root-mean-square error (RMSE) between modeled (simulated) and observed
values. Error is defined as modeled minus observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_rmse(
  mod,
  obs,
  normalize = c("none", "mean", "range", "stdev", "iqr", "iqr-1", "iqr-2", "iqr-3",
    "iqr-4", "iqr-5", "iqr-6", "iqr-7", "iqr-8", "iqr-9", NULL),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_rmse_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_rmse_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_rmse_+3A_normalize">normalize</code></td>
<td>
<p>'character' value. Option to normalize the root-mean-square error (NRMSE) by
several normalizing options. Default is <code>'none'</code>(no normalizing). RMSE is
returned.<br />
<code>'mean'</code>. RMSE is normalized by the mean of <code>obs</code>.<br />
<code>'range'</code>. RMSE is normalized by the range <code>(max - min)</code> of <code>obs</code>.<br />
<code>'stdev'</code>. RMSE is normalized by the standard deviation of <code>obs</code>.<br />
<code>'iqr-#'</code>. RMSE is normalized by the inter-quartile range of <code>obs</code>, with distribution type
(see <code><a href="stats.html#topic+quantile">stats::quantile</a></code> function) indicated by integer number (for example <code>"iqr-8"</code>).
If no type specified, default type is <code>iqr-7</code>, the quantile function default.</p>
</td></tr>
<tr><td><code id="GOF_rmse_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'numeric' value of computed root-mean-square error (RMSE) or
normalized root-mean-square error (NRMSE)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RMSE
GOF_rmse(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)
# NRMSE
GOF_rmse(
  mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs, normalize = 'stdev'
)

</code></pre>

<hr>
<h2 id='GOF_summary'>Calculate Goodness-of-fit metrics and output into table</h2><span id='topic+GOF_summary'></span>

<h3>Description</h3>

<p>Calculate Goodness-of-fit (GOF) metrics for correlation, Kling&ndash;Gupta efficiency,
mean absolute error, mean error, Nash&ndash;Sutcliffe efficiency, percent bias,
root-mean-square error, normalized root-mean-square error, and volumetric efficiency, and output
into a table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_summary(
  mod,
  obs,
  metrics = c("cor", "kge", "mae", "me", "nse", "pb", "rmse", "nrmse", "ve"),
  censor_threshold = NULL,
  censor_symbol = NULL,
  na.rm = TRUE,
  kge_modified = FALSE,
  nse_j = 2,
  rmse_normalize = c("mean", "range", "stdev", "iqr", "iqr-1", "iqr-2", "iqr-3", "iqr-4",
    "iqr-5", "iqr-6", "iqr-7", "iqr-8", "iqr-9", NULL),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_summary_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_metrics">metrics</code></td>
<td>
<p>'character' vector. Which GOF metrics should be computed and output. Default is
<code>c("cor", "kge", "mae", "me", "nse", "pb", "rmse", "nrmse", "ve")</code>.<br />
<code>"cor"</code>. Correlation tests computed from <code><a href="#topic+GOF_correlation_tests">GOF_correlation_tests</a></code>.<br />
<code>"kge"</code>. Kling&ndash;Gupta efficiency computed from <code><a href="#topic+GOF_kling_gupta_efficiency">GOF_kling_gupta_efficiency</a></code>.<br />
<code>"mae"</code>. Mean absolute error computed from <code><a href="#topic+GOF_mean_absolute_error">GOF_mean_absolute_error</a></code>.<br />
<code>"me"</code>. Mean error computed from <code><a href="#topic+GOF_mean_error">GOF_mean_error</a></code>.<br />
<code>"nse"</code>. Nash&ndash;Sutcliffe efficiency computed from<br />
<code><a href="#topic+GOF_nash_sutcliffe_efficiency">GOF_nash_sutcliffe_efficiency</a></code> with option for modified NSE specified by
parameter <code>nse_j</code>.<br />
<code>"pb"</code>. Percent bias computed from <code><a href="#topic+GOF_percent_bias">GOF_percent_bias</a></code>.<br />
<code>"rmse"</code>. Root-mean-square error computed from <code><a href="#topic+GOF_rmse">GOF_rmse</a></code>.<br />
<code>"nrmse"</code>. Normalized root-mean-square error computed from <code><a href="#topic+GOF_rmse">GOF_rmse</a></code> and
&quot;normalize&quot; option specified in parameter <code>rmse_normalize</code>.<br />
<code>"ve"</code>. Volumetric efficiency computed from <code><a href="#topic+GOF_volumetric_efficiency">GOF_volumetric_efficiency</a></code>.<br /></p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_censor_threshold">censor_threshold</code></td>
<td>
<p>'numeric' value. Threshold to censor values on utilizing
<code><a href="#topic+censor_values">censor_values</a></code> function. Default is <code>NULL</code>, no censoring. If level specified, must also
specify<br /><code>censor_symbol</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_censor_symbol">censor_symbol</code></td>
<td>
<p>'character' string. Inequality symbol to censor values based on
<code>censor_threshold</code> utilizing <code><a href="#topic+censor_values">censor_values</a></code> function. Accepted values are<br />
<code>"gt"</code> (greater than),<br />
<code>"gte"</code> (greater than or equal to),<br />
<code>"lt"</code> (less than),<br />
or <code>"lte"</code> (less than or equal to).<br />
Default is <code>NULL</code>, no censoring. If symbol specified, must also specify <code>censor_value</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_kge_modified">kge_modified</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should the KGE calculation use the original
variability ratio in the standard deviations (<code>kge_modified  = FALSE</code>) or the modified
variability ratio in the coefficient of variations (<code>kge_modified = TRUE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_nse_j">nse_j</code></td>
<td>
<p>'numeric' value. Exponent value for modified NSE (mNSE) equation, utilized if
<code>"nse"</code> option is in parameter <code>metrics</code>. Default value is <code>nse_j = 2</code>, which is traditional
NSE equation.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_rmse_normalize">rmse_normalize</code></td>
<td>
<p>'character' value. Normalize option for NRMSE, utilized if &quot;nrmse&quot; option
is in paramter <code>metrics</code>. Default is <code>"mean"</code>. Options are<br />
<code>'mean'</code>. RMSE is normalized by the mean of <code>obs</code>.<br />
<code>'range'</code>. RMSE is normalized by the range <code>(max - min)</code> of <code>obs</code>.<br />
<code>'stdev'</code>. RMSE is normalized by the standard deviation of <code>obs</code>.<br />
<code>'iqr-#'</code>. RMSE is normalized by the inter-quartile range of <code>obs</code>, with distribution type
(see <code><a href="stats.html#topic+quantile">stats::quantile</a></code> function) indicated by integer number (for example <code>"iqr-8"</code>).
If no type specified, default type is <code>iqr-7</code>, the quantile function default.</p>
</td></tr>
<tr><td><code id="GOF_summary_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from <code><a href="stats.html#topic+cor.test">stats::cor.test</a></code> if <code>"cor"</code> is in
<code>metrics</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+GOF_correlation_tests">GOF_correlation_tests</a></code>, <code><a href="#topic+GOF_kling_gupta_efficiency">GOF_kling_gupta_efficiency</a></code>,<br />
<code><a href="#topic+GOF_mean_absolute_error">GOF_mean_absolute_error</a></code>, <code><a href="#topic+GOF_mean_error">GOF_mean_error</a></code>, <br />
<code><a href="#topic+GOF_nash_sutcliffe_efficiency">GOF_nash_sutcliffe_efficiency</a></code>, <code><a href="#topic+GOF_percent_bias">GOF_percent_bias</a></code>, <code><a href="#topic+GOF_rmse">GOF_rmse</a></code>,<br />
and <code><a href="#topic+GOF_volumetric_efficiency">GOF_volumetric_efficiency</a></code>.
</p>


<h3>Value</h3>

<p>A tibble (see <code><a href="tibble.html#topic+tibble">tibble::tibble</a></code>) with GOF metrics
</p>


<h3>See Also</h3>

<p><code><a href="#topic+censor_values">censor_values</a></code>, <code><a href="#topic+GOF_correlation_tests">GOF_correlation_tests</a></code>,
<code><a href="#topic+GOF_kling_gupta_efficiency">GOF_kling_gupta_efficiency</a></code>,
<code><a href="#topic+GOF_mean_absolute_error">GOF_mean_absolute_error</a></code>, <code><a href="#topic+GOF_mean_error">GOF_mean_error</a></code>, <br />
<code><a href="#topic+GOF_nash_sutcliffe_efficiency">GOF_nash_sutcliffe_efficiency</a></code>, <code><a href="#topic+GOF_percent_bias">GOF_percent_bias</a></code>,
<code><a href="#topic+GOF_rmse">GOF_rmse</a></code>, <br />
<code><a href="#topic+GOF_volumetric_efficiency">GOF_volumetric_efficiency</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_summary(mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs)

</code></pre>

<hr>
<h2 id='GOF_volumetric_efficiency'>Calculate Volumetric Efficiency</h2><span id='topic+GOF_volumetric_efficiency'></span>

<h3>Description</h3>

<p>Calculate Volumetric efficiency (VE) between modeled (simulated) and observed
values. VE is defined as the fraction of water delivered at the proper time
(Criss and Winston, 2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF_volumetric_efficiency(mod, obs, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_volumetric_efficiency_+3A_mod">mod</code></td>
<td>
<p>'numeric' vector. Modeled or simulated values. Must be same length as <code>obs</code>.</p>
</td></tr>
<tr><td><code id="GOF_volumetric_efficiency_+3A_obs">obs</code></td>
<td>
<p>'numeric' vector. Observed or comparison values. Must be same length as <code>mod</code>.</p>
</td></tr>
<tr><td><code id="GOF_volumetric_efficiency_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If any
<code>NA</code> values are present in <code>mod</code> or <code>obs</code>, the <em>i</em>th position from each will be removed before
calculating. If <code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Volumetric efficiency was proposed in order to circumvent some problems associated to the
Nash&ndash;Sutcliffe efficiency. It ranges from <code>0</code> to <code>1</code> and represents the fraction of water
delivered at the proper time; its compliment represents the fractional volumetric mismatch
(Criss and Winston, 2008).
</p>


<h3>Value</h3>

<p>Value of computed Volumetric efficiency.
</p>


<h3>References</h3>

<p>Criss, R.E. and Winston, W.E., 2008, Do Nash values have value? Discussion and alternate
proposals: Hydrological Processes, v. 22, p. 2723-2725.<br />
[Also available at https://doi.org/10.1002/hyp.7072.]
</p>
<p>Zambrano-Bigiarini, M., 2020, hydroGOF: Goodness-of-fit functions for comparison of simulated
and observed hydrological time series R package version 0.4-0.
accessed September 16, 2020, at https://github.com/hzambran/hydroGOF.
[Also available at https://doi.org/10.5281/zenodo.839854.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GOF_volumetric_efficiency(
  mod = example_mod$streamflow_cfs, obs = example_obs$streamflow_cfs
)

</code></pre>

<hr>
<h2 id='HyMETT-package'>Hydrologic Model Evaluation and Time-series Tools</h2><span id='topic+HyMETT-package'></span><span id='topic+HyMETT'></span>

<h3>Description</h3>

<p>This package facilitates the analysis and evaluation of hydrologic model output and time-series data with
functions focused on comparison of modeled (simulated) and observed data, period-of-record statistics, and trends.
</p>


<h3>Details</h3>

<p>Please see <a href="https://doi.org/10.5066/P9FNXEWI">doi:10.5066/P9FNXEWI</a> for more details.
</p>

<hr>
<h2 id='POR_apply_annual_hiflow_stats'>Calculate the 50th and 90th percentiles of a streamflow time series</h2><span id='topic+POR_apply_annual_hiflow_stats'></span>

<h3>Description</h3>

<p>This function computes the 50th and 90th percentiles of a streamflow time series from annual
n-day high flow values and returns a data.frame in the format of other period-of-record (POR)
metrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_apply_annual_hiflow_stats(annual_max, quantile_type = 8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_apply_annual_hiflow_stats_+3A_annual_max">annual_max</code></td>
<td>
<p>'numeric' vector or data.frame. Vector or data.frame with columns of annual
n-day maximum streamflows.</p>
</td></tr>
<tr><td><code id="POR_apply_annual_hiflow_stats_+3A_quantile_type">quantile_type</code></td>
<td>
<p>'numeric' value. The distribution type used in the <code><a href="stats.html#topic+quantile">stats::quantile</a></code>
function. Default is <code>8</code> (median-unbiased regardless of distribution). Other
types common in hydrology are <code>6</code> (Weibull) or <code>9</code> (unbiased for normal distributions).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>annual maximum of n-day moving averages can be computed during pre-processing step using <br />
<code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code> and <code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>, or <code><a href="#topic+preproc_main">preproc_main</a></code> for both
observed and modeled data.
</p>


<h3>Value</h3>

<p>Data.frame of 0.5 and 0.9 non-exceedance probabilities (50th and 90th percentiles),
with metric names if <code>annual_max</code> is a data.frame with columns named by metric.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>, <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>,
<code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>, <code><a href="#topic+preproc_main">preproc_main</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_apply_annual_hiflow_stats(annual_max = example_annual[ , c("high_q1", "high_q30")])

</code></pre>

<hr>
<h2 id='POR_apply_annual_lowflow_stats'>Calculate 10-year and 2-year return periods of a streamflow time series</h2><span id='topic+POR_apply_annual_lowflow_stats'></span>

<h3>Description</h3>

<p>Calculates 10-year and 2-year return periods of a streamflow time series from
annual n-day low streamflow values and returns a data.frame in the format of other
period-of-record (POR) metrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_apply_annual_lowflow_stats(annual_min)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_apply_annual_lowflow_stats_+3A_annual_min">annual_min</code></td>
<td>
<p>'numeric' vector or data.frame. Vector or data.frame with columns of annual
n-day minimum streamflows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>POR_apply_POR_lowflow_metrics</code> is a helper function that applies the <code><a href="#topic+POR_calc_lp3_quantile">POR_calc_lp3_quantile</a></code>
function to the data.frame of n-day moving averages, which can be computed during pre-processing
step using <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code> and <code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>, or <code><a href="#topic+preproc_main">preproc_main</a></code> for
both observed and modeled data. This function returns a data.frame with the 10-year and 2-year
return period streamflows for each n-day low streamflow in the input data.frame.
</p>


<h3>Value</h3>

<p>data.frame with 10-year and 2-year return period of n-day streamflows.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+POR_calc_lp3_quantile">POR_calc_lp3_quantile</a></code>, <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>,
<code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>, <br />
<code><a href="#topic+preproc_main">preproc_main</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_apply_annual_lowflow_stats(annual_min = example_annual[ , c("low_q1", "low_q30")])

</code></pre>

<hr>
<h2 id='POR_calc_amp_and_phase'>Calculate the seasonal amplitude and phase of a daily time series</h2><span id='topic+POR_calc_amp_and_phase'></span>

<h3>Description</h3>

<p>Calculates the  seasonal amplitude and phase of a daily time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_calc_amp_and_phase(
  data = NULL,
  Date,
  value,
  time_step = c("daily", "monthly")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_calc_amp_and_phase_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="POR_calc_amp_and_phase_+3A_date">Date</code></td>
<td>
<p>'numeric' vector of Dates corresponding to each <code>value</code> when <code>data = NULL</code>, or
'character' string identifying Date column name when <code>data</code> is specified.</p>
</td></tr>
<tr><td><code id="POR_calc_amp_and_phase_+3A_value">value</code></td>
<td>
<p>'numeric' vector of values (often streamflow) when <code>data = NULL</code>, or 'character'
string identifying value column name when <code>data</code> is specified. Assumed to be daily or monthly.</p>
</td></tr>
<tr><td><code id="POR_calc_amp_and_phase_+3A_time_step">time_step</code></td>
<td>
<p>'character' value. Either <code>"daily"</code> or <code>"monthly"</code>, Default is <code>"daily"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with calculated seasonal amplitude and phase
</p>


<h3>References</h3>

<p>Farmer, W.H., Archfield, S.A., Over, T.M., Hay, L.E., LaFontaine, J.H., and Kiang, J.E., 2014,
A comparison of methods to predict historical daily streamflow time series in the southeastern
United States: U.S. Geological Survey Scientific Investigations Report 2014–5231, 34 p.
[Also available at https://doi.org/10.3133/sir20145231.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_calc_amp_and_phase(data = example_obs, Date = "Date", value = "streamflow_cfs")

</code></pre>

<hr>
<h2 id='POR_calc_AR1'>calculates lag-one autocorrelation (AR1) coefficient for a time series</h2><span id='topic+POR_calc_AR1'></span>

<h3>Description</h3>

<p>calculates lag-one autocorrelation (AR1) coefficient for a time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_calc_AR1(data = NULL, Date, value, time_step = c("daily", "monthly"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_calc_AR1_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="POR_calc_AR1_+3A_date">Date</code></td>
<td>
<p>'numeric' vector of Dates corresponding to each <code>value</code> when <code>data = NULL</code>, or
'character' string identifying Date column name when <code>data</code> is specified.</p>
</td></tr>
<tr><td><code id="POR_calc_AR1_+3A_value">value</code></td>
<td>
<p>'numeric' vector of values (often streamflow) when <code>data = NULL</code>, or
'character' string identifying value column name when <code>data</code> is specified. Assumed to be
daily or monthly.</p>
</td></tr>
<tr><td><code id="POR_calc_AR1_+3A_time_step">time_step</code></td>
<td>
<p>'character' value. Either <code>"daily"</code> or <code>"monthly"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function  calculates lag-one autocorrelation (AR1) coefficient for a time series using the<br />
<code><a href="stats.html#topic+ar">stats::ar</a></code> function. When applied to an observed or modeled time series of streamflow, the <br />
<code><a href="#topic+POR_deseasonalize">POR_deseasonalize</a></code> function can be applied to the raw data prior to running the
<code>POR_calc_AR1</code> function.
</p>


<h3>Value</h3>

<p>A data.frame with calculated seasonal amplitude and phase.
</p>


<h3>References</h3>

<p>Farmer, W.H., Archfield, S.A., Over, T.M., Hay, L.E., LaFontaine, J.H., and Kiang, J.E., 2014,
A comparison of methods to predict historical daily streamflow time series in the southeastern
United States: U.S. Geological Survey Scientific Investigations Report 2014–5231, 34 p.
[Also available at https://doi.org/10.3133/sir20145231.]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+POR_deseasonalize">POR_deseasonalize</a></code>, <code><a href="stats.html#topic+ar">ar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_calc_AR1(data = example_obs, Date = "Date", value = "streamflow_cfs")

</code></pre>

<hr>
<h2 id='POR_calc_lp3_quantile'>Calculate quantile from fitted log-Pearson type III distribution</h2><span id='topic+POR_calc_lp3_quantile'></span>

<h3>Description</h3>

<p>Calculate the specified flow quantile from a fitted log-Pearson type III
distribution from a time series of n-day low flows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_calc_lp3_quantile(annual_min, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_calc_lp3_quantile_+3A_annual_min">annual_min</code></td>
<td>
<p>'numeric' vector. Vector of minimum annual n-day mean flows.</p>
</td></tr>
<tr><td><code id="POR_calc_lp3_quantile_+3A_p">p</code></td>
<td>
<p>'numeric' value of exceedance probabilities. Quantile of fitted distribution that is
returned (<code>p=0.1</code> for 10-year return period, <code>p=0.5</code> for 2-year return period)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>POR_calc_lp3_quantile</code> fits an log-Pearson type III distribution to a series of annual n-day
flows and returns the quantile of a user-specified probability using <code><a href="#topic+calc_qlpearsonIII">calc_qlpearsonIII</a></code>. This
represents a theoretical return period for than n-day flow.
</p>


<h3>Value</h3>

<p>Specified quantile from the fitted log-Pearson type 3 distribution.
</p>


<h3>References</h3>

<p>Asquith, W.H., Kiang, J.E., and Cohn, T.A., 2017, Application of at-site peak-streamflow
frequency analyses for very low annual exceedance probabilities: U.S. Geological Survey
Scientific Investigation Report 2017–5038, 93 p.
[Also available at https://doi.org/10.3133/sir20175038.]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc_qlpearsonIII">calc_qlpearsonIII</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_calc_lp3_quantile(annual_min = example_annual$low_q1, p = 0.1)

</code></pre>

<hr>
<h2 id='POR_deseasonalize'>Removes seasonal trends from a daily or monthly time series.</h2><span id='topic+POR_deseasonalize'></span>

<h3>Description</h3>

<p>Removes seasonal trends from a daily or monthly time series. Daily data are
deseasonalized by subtracting monthly mean values. Monthly data are deseasonalized by
subtracting mean monthly values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_deseasonalize(data = NULL, Date, value, time_step = c("daily", "monthly"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_deseasonalize_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="POR_deseasonalize_+3A_date">Date</code></td>
<td>
<p>'numeric' vector of Dates corresponding to each <code>value</code> when <code>data = NULL</code>, or<br />
'character' string identifying Date column name when <code>data</code> is specified.</p>
</td></tr>
<tr><td><code id="POR_deseasonalize_+3A_value">value</code></td>
<td>
<p>'numeric' vector of values (often streamflow) when <code>data = NULL</code>, or<br />
'character' string identifying value column name when <code>data</code> is specified.<br />
(assumed to be daily or monthly).</p>
</td></tr>
<tr><td><code id="POR_deseasonalize_+3A_time_step">time_step</code></td>
<td>
<p>'character' value. Either <code>"daily"</code> or <code>"monthly"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deseasonalize function removes seasonal trends from a daily or monthly time series
and returns a deseasonalized time series, which can be used in the <code><a href="#topic+POR_calc_AR1">POR_calc_AR1</a></code> function.
</p>


<h3>Value</h3>

<p>Deseasonalized values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+POR_calc_AR1">POR_calc_AR1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_deseasonalize(data = example_obs, Date = "Date", value = "streamflow_cfs")

</code></pre>

<hr>
<h2 id='POR_distribution_metrics'>Calculates various metrics that describe the distribution of a time series of streamflow</h2><span id='topic+POR_distribution_metrics'></span>

<h3>Description</h3>

<p>Calculates various metrics that describe the distribution of a time series
of streamflow, which can be of any time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POR_distribution_metrics(value, quantile_type = 8, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POR_distribution_metrics_+3A_value">value</code></td>
<td>
<p>'numeric' vector of values (assumed to be streamflow) at any time step.</p>
</td></tr>
<tr><td><code id="POR_distribution_metrics_+3A_quantile_type">quantile_type</code></td>
<td>
<p>'numeric' value. The distribution type used in the <code><a href="stats.html#topic+quantile">stats::quantile</a></code>
function. Default is <code>8</code> (median-unbiased regardless of distribution). Other
types common in hydrology are <code>6</code> (Weibull) or <code>9</code> (unbiased for normal distributions).</p>
</td></tr>
<tr><td><code id="POR_distribution_metrics_+3A_na.rm">na.rm</code></td>
<td>
<p>'boolean' <code>TRUE</code> or <code>FALSE</code>. Should <code>NA</code> values be removed before computing. If
<code>NA</code> values are present and <code>na.rm = FALSE</code>, then function will return <code>NA</code>s. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Metrics computed include:
</p>

<dl>
<dt><code>p_</code><em>n</em></dt><dd><p>Flow-duration curve (FDC) percentile where <em>n</em> = 1, 5, 10, 25, 50, 75, 90, 95,
and 99</p>
</dd>
<dt><code>POR_mean</code></dt><dd><p>Period of record mean</p>
</dd>
<dt><code>POR_sd</code></dt><dd><p>Period of record standard deviation</p>
</dd>
<dt><code>POR_cv</code></dt><dd><p>Period of record coefficient of variation</p>
</dd>
<dt><code>POR_min</code></dt><dd><p>Period of record minimum</p>
</dd>
<dt><code>POR_max</code></dt><dd><p>Period of record maximum</p>
</dd>
<dt><code>LCV</code></dt><dd><p>L-moment coefficient of variation</p>
</dd>
<dt><code>Lskew</code></dt><dd><p>L-moment skewness</p>
</dd>
<dt><code>Lkurtosis</code></dt><dd><p>L-moment kurtosis</p>
</dd>
</dl>



<h3>Value</h3>

<p>A data.frame with FDC quantiles, and distribution metrics. See <strong>Details</strong>.
This function calculates various metrics that describe the distribution of a time series
of streamflow, which can be of any time step.
</p>


<h3>References</h3>

<p>Farmer, W.H., Archfield, S.A., Over, T.M., Hay, L.E., LaFontaine, J.H., and Kiang, J.E., 2014,
A comparison of methods to predict historical daily streamflow time series in the southeastern
United States: U.S. Geological Survey Scientific Investigations Report 2014–5231, 34 p.
[Also available at https://doi.org/10.3133/sir20145231.]
</p>
<p>Asquith, W.H., Kiang, J.E., and Cohn, T.A., 2017, Application of at-site peak-streamflow
frequency analyses for very low annual exceedance probabilities: U.S. Geological Survey
Scientific Investigation Report 2017–5038, 93 p.
[Also available at https://doi.org/10.3133/sir20175038.]
</p>
<p>Asquith, W.H., 2021, lmomco&mdash;L-moments, censored L-moments, trimmed L-moments,<br />
L-comoments, and many distributions. R package version 2.3.7, Texas Tech University,
Lubbock, Texas.
</p>


<h3>See Also</h3>

<p><code><a href="lmomco.html#topic+lmoms">lmoms</a></code>, <code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>POR_distribution_metrics(value = example_obs$streamflow_cfs)
 
</code></pre>

<hr>
<h2 id='preproc_audit_data'>Audit daily data for total days in year</h2><span id='topic+preproc_audit_data'></span>

<h3>Description</h3>

<p>Audit daily data for total days in year. An audit is performed to inventory and
flag missing days in daily data and help determine if further analyses are appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preproc_audit_data(
  data = NULL,
  Date,
  value,
  year_group,
  use_specific_years = FALSE,
  begin_year = NULL,
  end_year = NULL,
  days_cutoff = 360,
  date_format = "%Y-%m-%d"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preproc_audit_data_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or 'character' string identifying
Date column name when <code>data</code> is specified. Dates associated with each value in value parameter.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Values to audit, must be daily data.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_year_group">year_group</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying
grouping column name when <code>data</code> is specified. Year grouping for each daily value in <code>value</code>
parameter. Must be same length as <code>value</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_use_specific_years">use_specific_years</code></td>
<td>
<p>'boolean' value. Flag to clip data to a certain set of years in
<code>year_group</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_begin_year">begin_year</code></td>
<td>
<p>'numeric' value. If <code>use_specific_years = TRUE</code>, beginning year to clip value.
Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_end_year">end_year</code></td>
<td>
<p>'numeric' value. If <code>use_specific_years = TRUE</code>, ending year to clip value.
Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_days_cutoff">days_cutoff</code></td>
<td>
<p>'numeric' value. Designating the number of days required for a year to be
counted as full. Default is <code>360</code>.</p>
</td></tr>
<tr><td><code id="preproc_audit_data_+3A_date_format">date_format</code></td>
<td>
<p>'character' string. Format of Date. Default is <code>"%Y-%m-%d"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Year grouping is commonly water year, climate year, or calendar year.
</p>


<h3>Value</h3>

<p>A data.frame with <code>year_group</code>, count (n, excluding <code>NA</code> values)
of days in each <code>year_group</code>, and a complete years 'boolean' flag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preproc_fill_daily">preproc_fill_daily</a></code>, <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>preproc_audit_data(
  data = example_preproc, Date = "Date", value = "value", year_group = "WY"
)

</code></pre>

<hr>
<h2 id='preproc_fill_daily'>Fills daily data with missing dates as <code>NA</code> values</h2><span id='topic+preproc_fill_daily'></span>

<h3>Description</h3>

<p>Fills daily data with missing dates as <code>NA</code> values. Days that are
absent from the daily time series are inserted with a corresponding value of <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preproc_fill_daily(
  data = NULL,
  Date,
  value,
  POR_start = NA,
  POR_end = NA,
  date_format = "%Y-%m-%d"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preproc_fill_daily_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_fill_daily_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or 'character' string identifying
Date column name when <code>data</code> is specified. Date associated with each value in <code>value</code>
parameter.</p>
</td></tr>
<tr><td><code id="preproc_fill_daily_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying values
column name when <code>data</code> is specified.</p>
</td></tr>
<tr><td><code id="preproc_fill_daily_+3A_por_start">POR_start</code></td>
<td>
<p>'character' value. Optional period of record start. If not specified, defaults
to <code>min(Date)</code>.</p>
</td></tr>
<tr><td><code id="preproc_fill_daily_+3A_por_end">POR_end</code></td>
<td>
<p>'character' value. Optional period of record end. If not specified, defaults to
<code>max(Date)</code>.</p>
</td></tr>
<tr><td><code id="preproc_fill_daily_+3A_date_format">date_format</code></td>
<td>
<p>'character' string. Format of Date. Default is <code>"%Y-%m-%d"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can be used prior to <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code> to fill daily data before computation
of n-day moving averages, or prior to <code><a href="#topic+preproc_audit_data">preproc_audit_data</a></code>.
</p>


<h3>Value</h3>

<p>A data.frame with <code>Date</code> and <code>value</code>, sequenced from <code>POR_start</code> to <code>POR_end</code> by 1 day.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preproc_audit_data">preproc_audit_data</a></code>, <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Dates = c(seq.Date(as.Date("2020-01-01"), as.Date("2020-01-10"), by = "1 day"),
          seq.Date(as.Date("2020-01-20"), as.Date("2020-01-31"), by = "1 day"))
values = c(seq.int(1, 22, 1))
preproc_fill_daily(Date = Dates, value = values)

</code></pre>

<hr>
<h2 id='preproc_main'>A wrapper function for preproc_precondition_data, preproc_audit_data, and calc_annual_flow_stats</h2><span id='topic+preproc_main'></span>

<h3>Description</h3>

<p>A wrapper function for <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>,
<code><a href="#topic+preproc_audit_data">preproc_audit_data</a></code>, and <br /> <code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preproc_main(
  data = NULL,
  Date,
  value,
  date_format = "%Y-%m-%d",
  year_group = c("WY", "CY", "year"),
  use_specific_years = FALSE,
  begin_year = NULL,
  end_year = NULL,
  days_cutoff = 360,
  calc_high = TRUE,
  calc_low = TRUE,
  calc_percentiles = TRUE,
  calc_monthly = TRUE,
  calc_WSCVD = TRUE,
  longitude = NA,
  calc_ICVD = FALSE,
  zero_threshold = 33,
  quantile_type = 8,
  na.action = c("na.omit", "na.pass")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preproc_main_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or 'character' string identifying
Date column name when <code>data</code> is specified. Dates associated with each value in <code>value</code>
parameter.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Values to precondition and calculate n-day moving averages
from. N-day moving averages only calculated for daily data.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_date_format">date_format</code></td>
<td>
<p>'character' string. Format of Date. Default is <code>"%Y-%m-%d"</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_year_group">year_group</code></td>
<td>
<p>'character' value. Specify either <code>"year"</code> for calendar year, <code>"WY"</code> for water
year, or <code>"CY"</code> for climate year. Used to select data after preconditioning for audit and
annual statistics. Default is <code>"WY"</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_use_specific_years">use_specific_years</code></td>
<td>
<p>'boolean' value. Flag to clip data to a certain set of years in
<code>year_group</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_begin_year">begin_year</code></td>
<td>
<p>'numeric' value. If <code>use_specific_years = TRUE</code>, beginning year to clip
<code>value</code>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_end_year">end_year</code></td>
<td>
<p>'numeric' value. If <code>use_specific_years = TRUE</code>, ending year to clip <code>value</code>.
Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_days_cutoff">days_cutoff</code></td>
<td>
<p>'numeric' value. Designating the number of days required for a year to be
counted as full. Default is <code>360</code>.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_high">calc_high</code></td>
<td>
<p>'boolean' value. Calculate high streamflow statistics for years in <code>year_group</code>.
Default is <code>TRUE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_low">calc_low</code></td>
<td>
<p>'boolean' value. Calculate low streamflow statistics for years in <code>year_group</code>.
Default is <code>TRUE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_percentiles">calc_percentiles</code></td>
<td>
<p>'boolean' value. Calculate percentiles for years in <code>year_group</code>.
Default is <code>TRUE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_monthly">calc_monthly</code></td>
<td>
<p>'boolean' value. Calculate monthly statistics for years in <code>year_group</code>.
Default is <code>TRUE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_wscvd">calc_WSCVD</code></td>
<td>
<p>'boolean' value. Calculate winter-spring center volume date for years in
<code>year_group</code>. Default is <code>TRUE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_longitude">longitude</code></td>
<td>
<p>'numeric' value. Site longitude in NAD83, required in WSCVD calculation.
Default is <code>NA</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_calc_icvd">calc_ICVD</code></td>
<td>
<p>'boolean' value. Calculate inverse center volume date for years in
<code>year_group</code>. Default is <code>FALSE</code>. See <strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_zero_threshold">zero_threshold</code></td>
<td>
<p>'numeric' value as percentage. The percentage of years of a statistic that
need to be zero in order for it to be deemed a zero streamflow site for that statistic. For
use in trend calculation. See <strong>Details</strong> on attributes. Default is <code>33</code> (33 percent) of
the annual statistic values.</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_quantile_type">quantile_type</code></td>
<td>
<p>'numeric' value. The distribution type used in the <code><a href="stats.html#topic+quantile">stats::quantile</a></code>
function. Default is <code>8</code> (median-unbiased regardless of distribution). Other
types common in hydrology are <code>6</code> (Weibull) or <code>9</code> (unbiased for normal distributions).</p>
</td></tr>
<tr><td><code id="preproc_main_+3A_na.action">na.action</code></td>
<td>
<p>'character' string indicating na.action passed to <code><a href="stats.html#topic+aggregate">stats::aggregate</a></code>
<code>na.action</code> parameter. Default is <code>"na.omit"</code>, which removes <code>NA</code> values before aggregating
statistics, or <code>"na.pass"</code>, which will pass <code>NA</code> values and return <code>NA</code> in the grouped
calculation if any <code>NA</code> values are present.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper function of <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>, <code><a href="#topic+preproc_audit_data">preproc_audit_data</a></code>, and<br />
<code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>. Data are first passed to the precondition function, then audited,
then annual statistics are computed.<br />
It also checks the timestep of the data to make sure that it is daily timestep.
Other time steps are currently not supported and will return the data.frame without moving
averages computed.
</p>


<h3>Value</h3>

<p>A list of three data.frames: 1 of preconditioned data, 1 data audit, and 1 annual
statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preproc_audit_data">preproc_audit_data</a></code>, <code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code>,
<code><a href="#topic+calc_annual_flow_stats">calc_annual_flow_stats</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>preproc_main(data = example_obs, Date = "Date", value = "streamflow_cfs", longitude = -68)

</code></pre>

<hr>
<h2 id='preproc_precondition_data'>Pre-conditions data with time information and n-day moving averages</h2><span id='topic+preproc_precondition_data'></span>

<h3>Description</h3>

<p>Pre-conditions data with time information and n-day moving averages, with options
to fill missing days with <code>NA</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preproc_precondition_data(
  data = NULL,
  Date,
  value,
  date_format = "%Y-%m-%d",
  fill_daily = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preproc_precondition_data_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_precondition_data_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or 'character' string identifying
Date column name when <code>data</code> is specified. Dates associated with each value in <code>value</code>
parameter.</p>
</td></tr>
<tr><td><code id="preproc_precondition_data_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Values to precondition and calculate n-day moving averages
from. N-day moving averages only calculated for daily data.</p>
</td></tr>
<tr><td><code id="preproc_precondition_data_+3A_date_format">date_format</code></td>
<td>
<p>'character' string. Format of <code>Date</code>. Default is <code>"%Y-%m-%d"</code>.</p>
</td></tr>
<tr><td><code id="preproc_precondition_data_+3A_fill_daily">fill_daily</code></td>
<td>
<p>'logical' value. Should gaps in <code>Date</code> and <code>value</code> be filled using <br />
<code><a href="#topic+preproc_fill_daily">preproc_fill_daily</a></code>. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These columns are added to the data:
</p>

<dl>
<dt><code>year</code></dt><dd></dd>
<dt><code>month</code></dt><dd></dd>
<dt><code>day</code></dt><dd></dd>
<dt><code>decimal_date</code></dt><dd></dd>
<dt><code>WY</code></dt><dd><p>Water Year: October 1 to September 30</p>
</dd>
<dt><code>CY</code></dt><dd><p>Climate Year: April 1 to March 30</p>
</dd>
<dt><code>Q3</code></dt><dd><p>3-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>Q7</code></dt><dd><p>7-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>Q30</code></dt><dd><p>30-Day Moving Average: computed at end of moving interval</p>
</dd>
<dt><code>jd</code></dt><dd><p>Julian date</p>
</dd>
</dl>

<p>This function also checks the time step of the data to make sure that it is daily time step. Daily
values with gaps are important to fill with <code>NA</code> to ensure proper calculation of n-day moving
averages. Use <code>fill_daily = TRUE</code> or <code><a href="#topic+preproc_fill_daily">preproc_fill_daily</a></code>. Other time steps are currently not
supported and will return the data.frame without moving averages computed.
</p>


<h3>Value</h3>

<p>A data.frame with Date, value, and additional columns with time and n-day moving average
information.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preproc_fill_daily">preproc_fill_daily</a></code>, <code><a href="zoo.html#topic+rollmean">rollmean</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>preproc_precondition_data(data = example_obs, Date = "Date", value = "streamflow_cfs")

</code></pre>

<hr>
<h2 id='preproc_validate_daily'>Validates that daily data do not contain gaps</h2><span id='topic+preproc_validate_daily'></span>

<h3>Description</h3>

<p>Validates that daily data do not contain gaps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preproc_validate_daily(
  data = NULL,
  Date = "Date",
  value = "value",
  date_format = "%Y-%m-%d"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preproc_validate_daily_+3A_data">data</code></td>
<td>
<p>'data.frame'. Optional data.frame input, with columns containing <code>Date</code> and <code>value</code>.
Column names are specified as strings in the corresponding parameter. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="preproc_validate_daily_+3A_date">Date</code></td>
<td>
<p>'Date' or 'character' vector when <code>data = NULL</code>, or 'character' string identifying
Date column name when <code>data</code> is specified. Dates associated with each value in <code>value</code>
parameter.</p>
</td></tr>
<tr><td><code id="preproc_validate_daily_+3A_value">value</code></td>
<td>
<p>'numeric' vector when <code>data = NULL</code>, or 'character' string identifying year column
name when <code>data</code> is specified. Values to precondition and calculate n-day moving averages
from. N-day moving averages only calculated for daily data.</p>
</td></tr>
<tr><td><code id="preproc_validate_daily_+3A_date_format">date_format</code></td>
<td>
<p>'character' string. Format of <code>Date</code>. Default is <code>"%Y-%m-%d"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used to validate there are no gaps in the daily record before computing n-day moving averages in
<code><a href="#topic+preproc_precondition_data">preproc_precondition_data</a></code> or lag-1 autocorrelation in <code><a href="#topic+POR_calc_AR1">POR_calc_AR1</a></code>. If gaps are present,
<code><a href="#topic+preproc_fill_daily">preproc_fill_daily</a></code> can be used to fill them with <code>NA</code> values.
</p>


<h3>Value</h3>

<p>An error message with missing dates, otherwise nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>preproc_validate_daily(data = example_obs, Date = "Date", value = "streamflow_cfs")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
