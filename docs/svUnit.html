<!DOCTYPE html><html><head><title>Help for package svUnit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {svUnit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#svUnit-package'><p>svUnit: 'SciViews' - Unit, Integration and System Testing</p></a></li>
<li><a href='#check'><p>SciViews-R Unit assertions (check functions)</p></a></li>
<li><a href='#guiTestReport'><p>Report or give feedback to the GUI client about running test units</p></a></li>
<li><a href='#koUnit'><p>Interact with the test unit GUI in Komodo/SciViews-K</p></a></li>
<li><a href='#Log'><p>SciViews-R log management functions</p></a></li>
<li><a href='#makeTestListFromExamples'><p>Create, attach to and manipulate test functions in R objects</p></a></li>
<li><a href='#svSuite'><p>Create and run test suites by collecting together unit tests and function</p>
tests defined in objects</a></li>
<li><a href='#svSuiteData'><p>Objects of class 'svSuiteData' contain results from running test suites</p></a></li>
<li><a href='#svTestData'><p>Objects of class 'svTestData' contain results from running a test</p></a></li>
<li><a href='#unitTests.svUnit'><p>Unit tests for the package 'svUnit'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-18</td>
</tr>
<tr>
<td>Title:</td>
<td>'SciViews' - Unit, Integration and System Testing</td>
</tr>
<tr>
<td>Description:</td>
<td>A complete unit test system and functions to implement its GUI part.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philippe Grosjean &lt;phgrosjean@sciviews.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.9.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>svGUI, datasets, XML, RUnit, knitr, markdown, covr, spelling</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SciViews/svUnit">https://github.com/SciViews/svUnit</a>,
<a href="https://www.sciviews.org/svUnit/">https://www.sciviews.org/svUnit/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SciViews/svUnit/issues">https://github.com/SciViews/svUnit/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-18 19:35:28 UTC; phgrosjean</td>
</tr>
<tr>
<td>Author:</td>
<td>Philippe Grosjean <a href="https://orcid.org/0000-0002-2694-9471"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-19 05:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='svUnit-package'>svUnit: 'SciViews' - Unit, Integration and System Testing</h2><span id='topic+svUnit'></span><span id='topic+svUnit-package'></span>

<h3>Description</h3>

<p>A complete unit test system and functions to implement its GUI part.
</p>


<h3>Details</h3>

<p>The SciViews 'svUnit' package defines a framework for testing R code, not
unlike jUnit for Java. It is inspired on the <code>checkxxx()</code> functions from the
'RUnit' package and the same test unit files should be compatible with both
'svUnit' and 'RUnit'. However, the internal implementation is completely
different and svUnit can also be used interactively, while 'RUnit' is only
designed to run test units written in files on disks.
</p>
<p>The test unit framework provided in 'svUnit' is based on tests, also called
assertions, implemented in <code>checkxxx()</code> functions. For instance, the
<code>checkTrue(expr)</code> function check if its 'expr' argument returns <code>TRUE</code>.
Results of these assertions are collected in a centralized logger located in
the <code>.Log</code> object in <code>.GlobalEnv</code>. This is a 'svSuiteData' object with data
about the context of the tests (see for instance, <code><a href="#topic+lastTest">lastTest()</a></code>, <code><a href="#topic+lastSuite">lastSuite()</a></code>
or <code>metadata(.Log)</code>).
</p>
<p>Assertions can give three results: (1) <code>TRUE</code> if success, (2) <code>FALSE</code> in
case of failure (in our example, 'expr' in <code>checkTrue(expr)</code> did not return
<code>TRUE</code>), and (3) <code>NA</code> if the code in 'expr' cannot be parsed or executed
correctly. All these errors or failures are catch and recorded in the logger,
as individual 'svTestData' objects.
</p>
<p>Both the logger ('svSuiteData' object) and test records inside it
('svTestData' objects) have convenient methods to visualize information they
contain: <code><a href="base.html#topic+print">print()</a></code>, <code><a href="base.html#topic+summary">summary()</a></code> and <code><a href="#topic+stats">stats()</a></code> methods. Access to the
individual test records in the logger is done with list-like instructions:
<code>.Log$mytest</code> returns the 'svTestData' object named 'mytest', itself the
result of running test in the 'mytest' test function (i.e.,
<code>runTest(mytest)</code>, see hereunder). Assertions run at the command line,
outside of specific contexts provided by test functions, test units and
test suites (see hereunder) are recorded under the 'eval' 'svTestData' object
in the logger (i.e., <code>.Log$eval</code>).
</p>
<p>Since a 'svSuiteData' object (the logger) is also an environment, you can get
the list of all test records it contains using <code>ls(.Log)</code>, and you can
eliminate a given test record using <code>rm(mytest, envir = .Log)</code>.
</p>
<p>Test cases are collections of assertions with the satellite code needed to
build example or situations to be tested. They are collected together in
argument-less functions with class being 'svTest'. See <code>?svTest</code>  for
further explanations and a couple of example test cases/test functions.
</p>
<p>In its simplest instance, a test function is defined as a separate R object
loaded in memory (unlike RUnit where all test must be defined in files). You
run it simply by using <code>runTest(mytest)</code>. A slightly more structured way
to work is to attach the test function to the object it testes. You use
<code>test(myobj) &lt;- testmyobj</code> to do so, and retrieve it with <code>test(myobj)</code>. Now,
the test function always follows the tested object. Testing the object is
still simple by using <code>runTest(myobj)</code>, which is totally equivalent to
<code>runTest(test(myobj))</code>. One can determine if an object has a test function
associated, or is a test function itself by using <code>is.test(myobj)</code>.
</p>
<p>Several test functions can be collected together in so-called test units. A
test unit only exists on disk. It is a file named 'runit*.R' containing
sourceable R code with test functions having names starting with 'test'
(unlike 'RUnit', the default convention of file names starting with 'runit'
and test function names starting with 'test' is not customizable in
'svUnit'). One can also define special <code>.setUp()</code> and <code>.tearDown()</code> functions
in the test unit. The first function will be run before each test function,
and the latter one will be run after it. Test units are created manually, or
from a collection of objects with associated test functions loaded in an
environment (usually <code>.GlobalEnv</code>) thanks to the <code><a href="#topic+makeUnit">makeUnit()</a></code> method. These
units should be mutually compatible with those used in the 'RUnit' package
(at least this is verified with version 0.4-17 of 'RUnit').
</p>
<p>Test units defined for packages should be located in the package /runitTests
subdirectory (/inst/runitTests for source of the package) or one of its
subdirectories. That way, they are located automatically by the function
<code><a href="#topic+svSuiteList">svSuiteList()</a></code> that also automatically detects all objects with associated
test functions loaded in <code>.GlobalEnv</code>. Test suites are 'svSuite'
objects with a list of test units or test objects to collect in the suite.
Thus, <code><a href="#topic+svSuiteList">svSuiteList()</a></code> automatically builds such a suite with all tests it
finds in R, with many possibilities to filter packages' test units, objects'
test functions, or to add non standard directories with test units, for
instance. See <code>?svSuite</code> for more details on creating and using these
suites.
</p>
<p>A GUI (Graphical User Interface) is provided to automatically build and run
tests suites and to get a graphical (tree) interactive report of the results
in the Komodo Edit or IDE code editor, together with the SciViews-K
extension. If you want to use this (optional) GUI, you have to install
required software components on your machine.
</p>
<p>Finally, the 'svUnit' framework is compatible with <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> (see the
manual &quot;Writing R extensions&quot;). You simply define man pages (.Rd files) with
an example section running selected test units from your package. The
function <code><a href="#topic+errorLog">errorLog()</a></code> is designed to generate and error if one or more tests
failed or raised an error during <code style="white-space: pre;">&#8288;R CMD check&#8288;</code>, and it should be used at the
end of the example that runs your unit test(s). That way, <code style="white-space: pre;">&#8288;R CMD check&#8288;</code> is
interrupted and a detailed report of the tests that failed or raised an error
is printed. See an example in <code>?unitTests.svUnit</code>.
</p>


<h3>Author(s)</h3>

<p>Written by Ph. Grosjean, inspired from the general design of the
'RUnit' package by Thomas Konig, Klaus Junemann &amp; Matthias Burger.
</p>


<h3>References</h3>

<p>There is a huge literature and unit testing. An easy starting
point is: <a href="https://en.wikipedia.org/wiki/Unit_test">https://en.wikipedia.org/wiki/Unit_test</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/SciViews/svUnit">https://github.com/SciViews/svUnit</a>
</p>
</li>
<li> <p><a href="https://www.sciviews.org/svUnit/">https://www.sciviews.org/svUnit/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/SciViews/svUnit/issues">https://github.com/SciViews/svUnit/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Clear the logger
clearLog()

# Design and attach a simple test function to an object
foo &lt;- function(x, y = 2)
  return(x * y)
testfoo &lt;- function() {
  #DEACTIVATED()	# Use this to deactive the test (notice placed in the log)
  checkEqualsNumeric(5, foo(2),  "Check return of foo()")
  checkException(foo("b"),       "Wrong first argument")
  checkException(foo(2, "a"),    "Wrong second argument")
}
# Attach this to the foo function
test(foo) &lt;- testfoo

# Run this test
runTest(foo)

# Inspect the result
ls(.Log)
.Log$`test(foo)`
# This test fails. You see that the test function requires that foo(2) = 5
# and the actual implementation returns 4. This is a trivial, useless example,
# but you are supposed to correct the function. For instance:
foo &lt;- function(x, y = 2)
  return(x * y + 1)
test(foo) &lt;- testfoo

(runTest(foo))	# Now, that's fine!
</code></pre>

<hr>
<h2 id='check'>SciViews-R Unit assertions (check functions)</h2><span id='topic+check'></span><span id='topic+checkEquals'></span><span id='topic+checkEqualsNumeric'></span><span id='topic+checkIdentical'></span><span id='topic+checkTrue'></span><span id='topic+checkException'></span><span id='topic+DEACTIVATED'></span>

<h3>Description</h3>

<p>These functions define the assertions in test functions. They are designed to
check the result of some test calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkEquals(
  target,
  current,
  msg = "",
  tolerance = .Machine$double.eps^0.5,
  checkNames = TRUE,
  ...
)

checkEqualsNumeric(
  target,
  current,
  msg = "",
  tolerance = .Machine$double.eps^0.5,
  ...
)

checkIdentical(target, current, msg = "")

checkTrue(expr, msg = "")

checkException(expr, msg = "", silent = getOption("svUnit.silentException"))

DEACTIVATED(msg = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_+3A_target">target</code></td>
<td>
<p>a target object as reference for comparison.</p>
</td></tr>
<tr><td><code id="check_+3A_current">current</code></td>
<td>
<p>An object created for comparison (not an S4 class object).</p>
</td></tr>
<tr><td><code id="check_+3A_msg">msg</code></td>
<td>
<p>An optional (short!) message to document a test. This message is
stored in the log and printed in front of each test report.</p>
</td></tr>
<tr><td><code id="check_+3A_tolerance">tolerance</code></td>
<td>
<p>numeric &gt;= 0. A numeric check does not fail if differences
are smaller than 'tolerance'.</p>
</td></tr>
<tr><td><code id="check_+3A_checknames">checkNames</code></td>
<td>
<p>Flag, if <code>FALSE</code> the names attributes are set to <code>NULL</code> for
both <code>current</code> and <code>target</code> before performing the check.</p>
</td></tr>
<tr><td><code id="check_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to <code><a href="Matrix.html#topic+all.equal">all.equal()</a></code> or
<code><a href="base.html#topic+all.equal.numeric">all.equal.numeric()</a></code>.</p>
</td></tr>
<tr><td><code id="check_+3A_expr">expr</code></td>
<td>
<p>Syntactically valid R expression which can be evaluated and must
return a logical vector (<code>TRUE</code>|<code>FALSE</code>). A named expression is also allowed
but the name is disregarded. In <code><a href="#topic+checkException">checkException()</a></code>, expr is supposed to
generate an error to pass the test.</p>
</td></tr>
<tr><td><code id="check_+3A_silent">silent</code></td>
<td>
<p>Flag passed on to try, which determines if the error message
generated by the checked function is displayed at the R console. By default,
it is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These check functions are equivalent to various methods of the class
junit.framework.Assert of Java junit framework. They should be
code-compatible with functions of same name in 'RUnit' 0.4.17, except
for <code><a href="#topic+checkTrue">checkTrue()</a></code> that is vectorized here, but accept only a scalar result in
'RUnit'. For scalar test, the behavior of the function is the same in both
packages.
See <code><a href="#topic+svTest">svTest()</a></code> for examples of use of these functions in
actual test cases attached to R objects.
See also the note about S4 objects in the <code><a href="RUnit.html#topic+checkTrue">RUnit::checkTrue()</a></code> online help of the
'RUnit' package.
</p>


<h3>Value</h3>

<p>These function return <code>TRUE</code> if the test succeeds, <code>FALSE</code> if it fails,
possibly with a 'result' attribute containing more information about the
problem. This is very different from corresponding functions in 'RUnit' that
stop with an error in case of test failure. Consequently, current functions
do not require the complex evaluation framework designed in 'RUnit' for that
reason.
</p>


<h3>Author(s)</h3>

<p>Written by Ph. Grosjean, inspired from the general design of the
'RUnit' package by Thomas Konig, Klaus Junemann &amp; Matthias Burger.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+Log">Log()</a></code>, <code><a href="#topic+guiTestReport">guiTestReport()</a></code>, <a href="RUnit.html#topic+checkTrue">RUnit::checkTrue</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clearLog()     # Clear the svUnit log

# All these tests are correct
(checkEquals(c("A", "B", "C"), LETTERS[1:3]))
(checkEqualsNumeric(1:10, seq(1, 10)))
(checkIdentical(iris[1:50, ], iris[iris$Species == "setosa",]))
(checkTrue(1 &lt; 2))
(checkException(log("a")))
Log()    # See what's recorded in the log

# ... but these ones fail
(checkEquals("A", LETTERS[1:3]))
(checkEqualsNumeric(2:11, seq(1, 10)))
(checkIdentical(iris[1:49, ], iris[iris$Species == "setosa",]))
(checkTrue(1 &gt; 2))
(checkException(log(1)))
Log()    # See what's recorded in the log

# Create a test function and run it
foo &lt;- function(x, y = 2)
  return(x * y)
test(foo) &lt;- function() {
  #DEACTIVATED()
  checkEqualsNumeric(5, foo(2))
  checkEqualsNumeric(6, foo(2, 3))
  checkTrue(is.test(foo))
  checkTrue(is.test(test(foo)))
  checkIdentical(test(foo), attr(foo, "test"))
  checkException(foo("b"))
  checkException(foo(2, "a"))
}
(runTest(foo))

# Of course, everything is recorded in the log
Log()

clearLog()
</code></pre>

<hr>
<h2 id='guiTestReport'>Report or give feedback to the GUI client about running test units</h2><span id='topic+guiTestReport'></span><span id='topic+guiSuiteList'></span><span id='topic+guiSuiteAutoList'></span><span id='topic+guiTestFeedback'></span>

<h3>Description</h3>

<p>These functions are usually not called from the command line. They return
data to compatible GUI clients, like Komodo Edit with the SciViews-K
extension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>guiTestReport(object, sep = "\t", path = NULL, ...)

guiSuiteList(sep = "\t", path = NULL, compare = TRUE)

guiSuiteAutoList(...)

guiTestFeedback(object, path = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="guiTestReport_+3A_object">object</code></td>
<td>
<p>a 'svUnitData' object.</p>
</td></tr>
<tr><td><code id="guiTestReport_+3A_sep">sep</code></td>
<td>
<p>Field separator to use in the results.</p>
</td></tr>
<tr><td><code id="guiTestReport_+3A_path">path</code></td>
<td>
<p>Path where to write a 'Suites.txt' file with the list of
currently available test suites (to be used by the GUI client). If <code>NULL</code>,
no file is written (by default).</p>
</td></tr>
<tr><td><code id="guiTestReport_+3A_...">...</code></td>
<td>
<p>Not used currently.</p>
</td></tr>
<tr><td><code id="guiTestReport_+3A_compare">compare</code></td>
<td>
<p>Do we compare the list of available test suite and return
something to the GUI client only if there are changes in the list? This is
used (when <code>TRUE</code>) to avoid unnecessary multiple processing of the same list
by the GUI client.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+guiSuiteList">guiSuiteList()</a></code> returns the list of available test suites invisibly.
<code><a href="#topic+guiSuiteAutoList">guiSuiteAutoList()</a></code> is used to establish a callback to automatically list
the available test suites in the GUI. It is not intended to be called
directly by the user. The other functions just return <code>TRUE</code> invisibly.They
are used for their side effect of sending data to compatible GUI clients.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+svSuite">svSuite()</a></code>, <code><a href="#topic+koUnit_version">koUnit_version()</a></code>
</p>

<hr>
<h2 id='koUnit'>Interact with the test unit GUI in Komodo/SciViews-K</h2><span id='topic+koUnit'></span><span id='topic+koUnit_setAutoTest'></span><span id='topic+koUnit_isAutoTest'></span><span id='topic+koUnit_runTest'></span><span id='topic+koUnit_showRUnitPane'></span><span id='topic+koUnit_version'></span>

<h3>Description</h3>

<p>These functions allow controlling the test unit module (R Unit tab at right)
in Komodo with SciViews-K and SciViews-K Unit extensions. R must be correctly
connected to Komodo, meaning that the 'svGUI' package must be loaded with
proper configuration of client/server socket connections between R and
Komodo. See the manual about SciViews-K for more information. The functions
defined here are the same as JavaScript functions defined in the 'sv.r.unit'
namespace in Komodo/SciViews-K Unit. For instance, <code><a href="#topic+koUnit_runTest">koUnit_runTest()</a></code> is
equivalent to <code>sv.r.unit.runTest();</code> in a Javascript macro in Komodo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koUnit_setAutoTest(state)

koUnit_isAutoTest()

koUnit_runTest()

koUnit_showRUnitPane(state)

koUnit_version()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="koUnit_+3A_state">state</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>, or missing for <code>koUnit_showRUnitPane()</code>, in
this case, the R Unit pane visibility is toggled.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+koUnit_isAutoTest">koUnit_isAutoTest()</a></code> returns <code>TRUE</code> if the test unit is in auto mode in
Komodo (the selected tests are run automatically each time a .R file
edited in Komodo is saved).
</p>
<p><code><a href="#topic+koUnit_version">koUnit_version()</a></code> returns the version for which the SciViews-K Unit
extension was designed for. This allow to check if this version is compatible
with current 'svUnit' R package version, and to propose to update the Komodo
extension if needed (this mechanism is not running currently, but it will be
implemented in the future to avoid or limit incompatibilities between
respective R and Komodo extensions).
</p>
<p>The other functions are invoked for their side-effect and they return
nothing. Note, however, that correct execution of this code in Komodo is
verified, and the functions issue an error in R if they fail to execute
correctly in Komodo.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+guiTestReport">guiTestReport()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Make sure R is communicating with Komodo before use, see ?koCmd in svGUI
koUnit_version()

# Toggle visibility of the R Unit pane in Komodo twice
koUnit_showRUnitPane()
koUnit_showRUnitPane()

# Make sure that the R Unit pane is visible
koUnit_showRUnitPane(TRUE)

# Is the test unit running in auto mode?
koUnit_isAutoTest()

# Toggle auto test mode off
koUnit_setAutoTest(FALSE)

# Run the test units from within Komodo
koUnit_runTest()

## End(Not run)
</code></pre>

<hr>
<h2 id='Log'>SciViews-R log management functions</h2><span id='topic+Log'></span><span id='topic+createLog'></span><span id='topic+clearLog'></span><span id='topic+errorLog'></span><span id='topic+lastTest'></span><span id='topic+lastSuite'></span>

<h3>Description</h3>

<p>These functions define the code of test functions. They are designed to check
the result of some test calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Log(description = NULL)

createLog(description = NULL, deleteExisting = FALSE)

clearLog()

errorLog(stopit = TRUE, summarize = TRUE)

lastTest()

lastSuite()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Log_+3A_description">description</code></td>
<td>
<p>A (short) character string describing this test suite log.</p>
</td></tr>
<tr><td><code id="Log_+3A_deleteexisting">deleteExisting</code></td>
<td>
<p>Do we delete an existing a <code>.Log</code> object already
defined in <code>.GlobalEnv</code> (no, by default)?</p>
</td></tr>
<tr><td><code id="Log_+3A_stopit">stopit</code></td>
<td>
<p>Do we issue an error (<code><a href="base.html#topic+stop">stop()</a></code> in case of any error or failure?
This is particularly useful if you want to interrupt R CMD check on packages,
when you included one or more test suites in examples (see <code>?unitTests</code>).</p>
</td></tr>
<tr><td><code id="Log_+3A_summarize">summarize</code></td>
<td>
<p>Should the summary of the log be printed in case we stop
execution of the code when an error is found (see <code style="white-space: pre;">&#8288;stopit =&#8288;</code> argument. It is,
indeed, useful to indicate at this time which tests failed or raised an
error. So, this argument should usually be left at its default value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>svUnit records results of assertions (using the checkxxx() functions) in a
'svSuiteData' object named <code>.Log</code> and located in .GlobalEnv. Hence, this log
is easy to access. However, in order to avoid errors in your code in case
this object was deleted, or not created, it is better to access it using
<code><a href="#topic+Log">Log()</a></code> which take care to create the object if it is missing.
</p>


<h3>Value</h3>

<p><code><a href="#topic+Log">Log()</a></code> and <code><a href="#topic+createLog">createLog()</a></code> return the <code>.Log</code> object defined in <code>.GlobalEnv</code> by
reference (it is indeed an environment). So, you can use its content (and
change it, if you write functions to manipulate this log).
</p>
<p><code><a href="#topic+clearLog">clearLog()</a></code> return invisibly <code>TRUE</code> or <code>FALSE</code>, depending if an existing log
object was deleted or not.
</p>
<p><code><a href="#topic+errorLog">errorLog()</a></code> is mainly used for its side-effect of stopping code execution
and/or printing a summary of the test runs in the context of example
massaging in R CMD check (see the &quot;Writing R extensions&quot; manual). However,
this function also returns invisibly a contingency table with the number of
successes, failures, errors and deactivated tests recorded so far.
</p>
<p><code><a href="#topic+lastTest">lastTest()</a></code> and <code><a href="#topic+lastSuite">lastSuite()</a></code> recall results of last test and last suite
run, respectively.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svSuiteData">svSuiteData()</a></code>, <code><a href="#topic+svSuite">svSuite()</a></code>, <code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+checkEquals">checkEquals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clearLog()           # Clear the svUnit log

# Two correct tests
(checkTrue(1 &lt; 2))
(checkException(log("a")))
errorLog()           # Nothing, because there is no error

## Not run: 
(checkTrue(1 &gt; 2))    # This test fails
lastTest()            # Print results of last test
errorLog()            # Stop and summarize the tests run so far

## End(Not run)

clearLog()
</code></pre>

<hr>
<h2 id='makeTestListFromExamples'>Create, attach to and manipulate test functions in R objects</h2><span id='topic+makeTestListFromExamples'></span><span id='topic+svTest'></span><span id='topic+print.svTest'></span><span id='topic+as.svTest'></span><span id='topic+is.svTest'></span><span id='topic+is.test'></span><span id='topic+test'></span><span id='topic+test+3C-'></span><span id='topic+makeUnit'></span><span id='topic+makeUnit.default'></span><span id='topic+makeUnit.svTest'></span><span id='topic+runTest'></span><span id='topic+runTest.default'></span><span id='topic+runTest.list'></span><span id='topic+runTest.svTest'></span>

<h3>Description</h3>

<p>Test functions are functions without arguments with class 'svTest' containing
one or more assertions using <code>checkxxx()</code> functions. They can be
attached to any object as a 'test' attribute. They can also be transferred
into a more formal test unit file on disk by applying the <code><a href="#topic+makeUnit">makeUnit()</a></code> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeTestListFromExamples(packageName, manFilesDir, skipFailing = FALSE)

svTest(testFun)

## S3 method for class 'svTest'
print(x, ...)

as.svTest(x)

is.svTest(x)

is.test(x)

test(x)

test(x) &lt;- value

makeUnit(x, ...)

## Default S3 method:
makeUnit(
  x,
  name = make.names(deparse(substitute(x))),
  dir = tempdir(),
  objfile = "",
  codeSetUp = NULL,
  codeTearDown = NULL,
  ...
)

## S3 method for class 'svTest'
makeUnit(
  x,
  name = make.names(deparse(substitute(x))),
  dir = tempdir(),
  objfile = "",
  codeSetUp = NULL,
  codeTearDown = NULL,
  ...
)

runTest(x, ...)

## Default S3 method:
runTest(
  x,
  name = deparse(substitute(x)),
  objfile = "",
  tag = "",
  msg = "",
  ...
)

## S3 method for class 'list'
runTest(x, ...)

## S3 method for class 'svTest'
runTest(
  x,
  name = deparse(substitute(x)),
  objfile = "",
  tag = "",
  msg = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeTestListFromExamples_+3A_packagename">packageName</code></td>
<td>
<p>A character string identifying the package from which to
extract examples.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_manfilesdir">manFilesDir</code></td>
<td>
<p>A character string identifying the directory holding the
manual pages and examples.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_skipfailing">skipFailing</code></td>
<td>
<p>A logical indicating whether missing or failing
documentation examples should be marked as <code>skipped</code> instead of as <code>failure</code>.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_testfun">testFun</code></td>
<td>
<p>A function without arguments defining assertions (using
<code>checkxxx()</code> functions) for tests to be transformed into a 'svTest' object.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_x">x</code></td>
<td>
<p>Any kind of object.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_...">...</code></td>
<td>
<p>Further arguments to the method (not used yet).</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_value">value</code></td>
<td>
<p>The tests to place in the object (as 'test' attribute); could be
a 'svTest' object, or a function without arguments with
assertions (<code>checkxxx()</code> functions).</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_name">name</code></td>
<td>
<p>The name of a test.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_dir">dir</code></td>
<td>
<p>The directory where to create the test unit file.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_objfile">objfile</code></td>
<td>
<p>The path to the file containing the original source code of
the object being tested. This argument is used to bring a context for a test
and allow a GUI to automatically open the source file for edition when the
user clicks on a test that failed or raised an error.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_codesetup">codeSetUp</code></td>
<td>
<p>An expression with some code you want to add to the
<code>.setUp()</code> function in your unit file (this function is executed before each
test.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_codeteardown">codeTearDown</code></td>
<td>
<p>An expression with some code you want to add to the
<code>.tearDown()</code> function in your unit file (this function is executed after
each test.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_tag">tag</code></td>
<td>
<p>A tag is a character string identifying a location in source code
files (either a test unit file, or the original source code of the tested
objects defined in <code style="white-space: pre;">&#8288;objfile =&#8288;</code>. This character string will be searched by the
text editor for easy location of the cursor near the corresponding test
command, or near the location in the original object that is concerned by
this test. Use any string you want to uniquely identify your tag, both in
your files, and in this argument.</p>
</td></tr>
<tr><td><code id="makeTestListFromExamples_+3A_msg">msg</code></td>
<td>
<p>A message you want to associate with this test run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'svTest' object for <code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+as.svTest">as.svTest()</a></code> and <code><a href="#topic+test">test()</a></code>. Function
<code><a href="#topic+is.svTest">is.svTest()</a></code> returns <code>TRUE</code> if 'x' is a 'svTest' object, and <code>is.test()</code>
does the same but also looks in the 'test' attribute if the class of 'x' is
not 'svTest' and returns <code>TRUE</code> if it finds something there.
</p>
<p><code><a href="#topic+makeUnit">makeUnit()</a></code> takes an object, extract its test function and write it in a
sourceable test unit on the disk (it should be compatible with 'RUnit' test
unit files too).
</p>
<p><code><a href="#topic+runTest">runTest()</a></code> returns invisibly a 'svTestData' object with all results after running specified tests.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svSuite">svSuite()</a></code>, <code><a href="#topic+is.svTestData">is.svTestData()</a></code>, <code><a href="#topic+Log">Log()</a></code>, <code><a href="#topic+checkEquals">checkEquals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clearLog()    # Clear the log file

foo &lt;- function(x, y = 2)
  return(x * y)
is.test(foo)    # No
# Create test cases for this function
test(foo) &lt;- function() {
  checkEqualsNumeric(4, foo(2))
  checkEqualsNumeric(6, foo(2, 3))
  checkTrue(is.test(foo))
  checkTrue(is.test(test(foo)))
  checkIdentical(attr(foo, "test"), test(foo))
  checkException(foo(2, "aa"))
  checkException(foo("bb"))
}
is.test(foo)    # Yes

## Not run: 
# Create a test unit on disk and view it
unit &lt;- makeUnit(foo)
file.show(unit, delete.file = TRUE)

## End(Not run)

# Run the test
(runTest(foo))
# Same as...
bar &lt;- test(foo)
(runTest(bar))

# How fast can we run 100 times such kind of tests (700 test in total)?
# (just an indication because in real situation with test unit files, we
# have also the time required to source the units!)
system.time(for (i in 1:100) runTest(foo))[3]

is.svTest(test(foo))    # Yes, of course!
# When an object without associated test is passed to runTest(),
# a simple test containing only a DEACTIVATED entry is build
x &lt;- 1:10
summary(runTest(x))

summary(Log())

rm(foo, bar, x)
</code></pre>

<hr>
<h2 id='svSuite'>Create and run test suites by collecting together unit tests and function
tests defined in objects</h2><span id='topic+svSuite'></span><span id='topic+as.svSuite'></span><span id='topic+is.svSuite'></span><span id='topic+print.svSuite'></span><span id='topic+svSuiteList'></span><span id='topic+makeUnit.svSuite'></span><span id='topic+runTest.svSuite'></span>

<h3>Description</h3>

<p>A 'svSuite' object is essentially a list of test units directories (or
packages, in this case, corresponding directories are PKG/unitTests and its
subdirectories), and of object names containing tests to add temporarily to
the test suite. These must be formatted in a concise way as described for the
'tests' argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svSuite(tests)

as.svSuite(x)

is.svSuite(x)

## S3 method for class 'svSuite'
print(x, ...)

svSuiteList(
  packages = TRUE,
  objects = TRUE,
  dirs = getOption("svUnit.dirs"),
  excludeList = getOption("svUnit.excludeList"),
  pos = .GlobalEnv,
  loadPackages = FALSE
)

## S3 method for class 'svSuite'
makeUnit(
  x,
  name = make.names(deparse(substitute(x))),
  dir = tempdir(),
  objfile = "",
  codeSetUp = NULL,
  codeTearDown = NULL,
  pos = .GlobalEnv,
  ...
)

## S3 method for class 'svSuite'
runTest(x, name = make.names(deparse(substitute(x))), unitname = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svSuite_+3A_tests">tests</code></td>
<td>
<p>A character string with items to include in the test suite. It
could be 'package:PKG' for including test units located in the /unitTests
subdirectory of the package PGK, or 'package:PKG (SUITE)' for test units
located in the subdirectory /unitTests/SUITE of package PKG, or 'dir:MYDIR'
for including test units in MYDIR, or 'test(OBJ)' for tests embedded in an
object, or 'OBJ' for 'svTest' object directly.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_x">x</code></td>
<td>
<p>Any kind of object.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_...">...</code></td>
<td>
<p>Further arguments to pass to <code><a href="#topic+makeUnit">makeUnit()</a></code> or <code><a href="#topic+runTest">runTest()</a></code> (not used
yet).</p>
</td></tr>
<tr><td><code id="svSuite_+3A_packages">packages</code></td>
<td>
<p>Do we list test units available in loaded packages?
Alternatively one can provide a character vector of package names, and it
will be used to filter packages (take care: in this case it will look at
installed packages, not only loaded packages)!</p>
</td></tr>
<tr><td><code id="svSuite_+3A_objects">objects</code></td>
<td>
<p>Do we list test available in objects? Alternatively, one can
provide a character vector of object names, and it will filter objects in
'pos' according to this vector.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_dirs">dirs</code></td>
<td>
<p>An additional list of directories where to look for more test
units. For convenience, this list can simply be saved as an 'svUnit.dirs'
options.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_excludelist">excludeList</code></td>
<td>
<p>A list of items to exclude from the listing. The function
uses regular expression to match the exclusions. So, for instance, specifying
<code>"package:MYPKG"</code> will exclude all items from package 'MYPKG', while using
<code>"package:MYPKG$"</code> will exclude only tests suites defined in the
.../MYPKG/unitTests directory, bur not in its subdirectories. For
convenience, it can be saved in a 'svUnit.excludeList' option. By default,
all tests for packages whose name start with 'sv' or 'RUnit' are excluded,
that is, <code>c("package:sv", "package:RUnit")</code>.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_pos">pos</code></td>
<td>
<p>The environment to look for 'objects' (environment, character
string with name of an environment, or integer with position of the
environment in the search path.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_loadpackages">loadPackages</code></td>
<td>
<p>In the case a list of packages is provided in
<code style="white-space: pre;">&#8288;packages =&#8288;</code>, do we make sure that these packages are loaded? If yes, the
function will try to load all packages in that list that are not loaded yet
and will issue a warning for the packages not found. Default, <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_name">name</code></td>
<td>
<p>The name of the test suite to build.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_dir">dir</code></td>
<td>
<p>The directory where to create the test unit file.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_objfile">objfile</code></td>
<td>
<p>The path to the file containing the original source code of
the object being tested. This argument is used to bring a context for a
test and allow a GUI to automatically open the source file for edition when
the user clicks on a test that failed or raised an error.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_codesetup">codeSetUp</code></td>
<td>
<p>An expression with some code you want to add to the
<code>.setUp()</code> function in your unit file (this function is executed before each
test.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_codeteardown">codeTearDown</code></td>
<td>
<p>An expression with some code you want to add to the
<code>.tearDown()</code> function in your unit file (this function is executed after
each test.</p>
</td></tr>
<tr><td><code id="svSuite_+3A_unitname">unitname</code></td>
<td>
<p>The name of a unit to run inside the suite. If <code>NULL</code> (by
default), all units are run.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+svSuiteList">svSuiteList()</a></code> lists all loaded packages having /unitTests/runit*.R files
(or similar files in subdirectories), and all objects in the user workspace
that have a 'test' attribute, or are 'svTest' objects (by default). It is a
rather exhaustive list of all test items currently available in the current R
session, but restricted by <code>getOption("svUnit.excludeList")</code>.
</p>
<p><code><a href="#topic+makeUnit">makeUnit()</a></code> writes a test unit on disk with the tests from the objects
listed in the 'svSuite' object that do not belong yet to a test unit.
<code><a href="#topic+runTest">runTest()</a></code> runs all the test in packages, directories and objects listed in
the 'svSuite' object.
</p>
<p>Thanks to the variety of sources allowed for tests, it is possible to define
these tests in a structured way, inside packages, like for the 'RUnit'
package (but with automatic recognition of test units associated to packages,
in the present case). It is also easy to define tests more loosely by just
attaching those tests to the objects you want to check. Whenever there objects
are loaded in the user's workspace, their tests are available. In both cases,
a test unit file on disk is sourced in a local environment and test functions
are run (same approach as in the 'RUnit' package, and the same test unit files
should be compatibles with both 'RUnit' and 'svUnit' packages), but in the
case of a loosely definition of the tests by attachment to objects, the test
unit file is created on the fly in the temporary directory (by default).
</p>
<p>At any time, you can transform a series of tests loosely attached to objects
into a test unit file by applying <code><a href="#topic+makeUnit">makeUnit()</a></code> to a 'svSuite' object,
probably specifying another directory than the (default) temporary dir for
more permanent storage of your test unit file. The best choice is the
'/inst/unitTests' directory of a package source, or one of its
subdirectories. That way, your test unit file(s) will be automatically listed
and available each time you load the compiled package in R (if you list them
using <code><a href="#topic+svSuiteList">svSuiteList()</a></code>). Of course, you still can exclude tests from given
packages by adding 'package:PKG' in the exclusion list with something
like: <code>options(svUnit.excludeList = c(getOption("svUnit.excludeList"), "package:PKG"))</code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+svSuite">svSuite()</a></code>, <code><a href="#topic+as.svSuite">as.svSuite()</a></code> and <code><a href="#topic+svSuiteList">svSuiteList()</a></code> return a 'svSuite' object.
<code><a href="#topic+is.svSuite">is.svSuite()</a></code> returns <code>TRUE</code> if the object is an 'svSuite'.
</p>
<p><code><a href="#topic+makeUnit">makeUnit()</a></code> creates a test unit file on disk, and <code><a href="#topic+runTest">runTest()</a></code> runs the tests
in such a file. They are used for their side-effect, but the first one also
returns the file created, and the second one returns invisibly the list of
all test unit files that where sourced ans run.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svSuiteData">svSuiteData()</a></code>, <code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+Log">Log()</a></code>, <code><a href="#topic+checkEquals">checkEquals()</a></code>, <code><a href="RUnit.html#topic+checkEquals">RUnit::checkEquals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>svSuiteList() # List all currently available test units and test cases
# Exclusion list is used (regular expression filtering!). It contains:
(oex &lt;- getOption("svUnit.excludeList"))
# Clear it, and relist available test units
options(svUnit.excludeList = NULL)
svSuiteList()

# Two functions that include their test cases
Square &lt;- function(x)
  return(x^2)
test(Square) &lt;- function() {
  checkEquals(9, Square(3))
  checkEquals(c(1, 4, 9), Square(1:3))
  checkException(Square("xx"))
}

Cube &lt;- function(x)
  return(x^3)
test(Cube) &lt;- function() {
  checkEquals(27, Cube(3))
  checkEquals(c(1, 8, 28), Cube(1:3))
  checkException(Cube("xx"))
}

# A separate test case object (not attached to a particular object)
# This is the simplest way to define quick and durty integration tests
test_Integrate &lt;- svTest(function() {
  checkTrue(1 &lt; 2, "check1")
  v &lt;- 1:3 	# The reference
  w &lt;- 1:3 	# The value to compare to the reference
  checkEquals(v, w)
})

# A function without test cases (will be filtered out of the suite list)
foo &lt;- function(x)
  return(x)

# Look now which tests are available
svSuiteList()

# Only objects, no package units
svSuiteList(packages = FALSE)

## Not run: 
# Create the test unit file for all objects with tests in .GlobalEnv
myunit &lt;- makeUnit(svSuiteList(), name = "AllTests")
file.show(myunit, delete.file = TRUE)

## End(Not run)

# Filter objects using a list (object with/without tests and a nonexisting obj)
svSuiteList(packages = FALSE, objects = c("Cube", "foo", "bar"))

# Create another svSuite object with selected test items
(mysuite &lt;- svSuite(c("package:svUnit (VirtualClass)", "test(Cube)")))
is.svSuite(mysuite)	# Should be!

## Not run: 
# Run all the tests currently available
(runTest(svSuiteList(), name = "AllTests"))
summary(Log())

## End(Not run)

# Restore previous exclusion list, and clean up the environment
options(svUnit.excludeList = oex)
rm(Square, Cube, foo, test_Integrate, mysuite, myunit, oex)
</code></pre>

<hr>
<h2 id='svSuiteData'>Objects of class 'svSuiteData' contain results from running test suites</h2><span id='topic+svSuiteData'></span><span id='topic+is.svSuiteData'></span><span id='topic+stats.svSuiteData'></span><span id='topic+metadata'></span><span id='topic+metadata.svSuiteData'></span><span id='topic+print.svSuiteData'></span><span id='topic+summary.svSuiteData'></span><span id='topic+protocol'></span><span id='topic+protocol.default'></span><span id='topic+protocol.svSuiteData'></span><span id='topic+protocol_text'></span><span id='topic+protocol_text.svSuiteData'></span><span id='topic+protocol_junit'></span><span id='topic+protocol_junit.svSuiteData'></span>

<h3>Description</h3>

<p>The 'svSuiteData' object contains results of all test run in one or more test
suites. The <code>checkxxx()</code> functions and the <code><a href="#topic+runTest">runTest()</a></code> method generate data
(objects 'svTestData') contained in the default 'svSuiteData' named <code>.Log</code>
and located in <code>.GlobalEnv</code>. It is then possible to display and report
information it contains in various ways to analyze the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.svSuiteData(x)

## S3 method for class 'svSuiteData'
stats(object, ...)

metadata(object, ...)

## S3 method for class 'svSuiteData'
metadata(
  object,
  fields = c("R.version", "sessionInfo", "time", "description"),
  ...
)

## S3 method for class 'svSuiteData'
print(x, all = FALSE, file = "", append = FALSE, ...)

## S3 method for class 'svSuiteData'
summary(object, ...)

protocol(object, type = "text", file = "", append = FALSE, ...)

## Default S3 method:
protocol(object, type = "text", file = "", append = FALSE, ...)

## S3 method for class 'svSuiteData'
protocol(object, type = "text", file = "", append = FALSE, ...)

protocol_text(object, file = "", append = FALSE, ...)

## S3 method for class 'svSuiteData'
protocol_text(object, file = "", append = FALSE, ...)

protocol_junit(object, ...)

## S3 method for class 'svSuiteData'
protocol_junit(object, file = "", append = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svSuiteData_+3A_x">x</code></td>
<td>
<p>Any kind of object, or a 'svSuiteData' object in the case of
<code><a href="base.html#topic+print">print()</a></code>.</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_object">object</code></td>
<td>
<p>A 'svSuiteData' object.</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_...">...</code></td>
<td>
<p>Further arguments to pass to methods. Not used yet.</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_fields">fields</code></td>
<td>
<p>Character vector. The name of all metadata items you want to
extract for the object. The default value is an exhaustive list of all
available metadata (i.e., defined by default) in the object, but you can add
more: just add a corresponding attribute to your object.</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_all">all</code></td>
<td>
<p>Do we print concise report for all test, or only for the tests
that fail or produce an error?</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_file">file</code></td>
<td>
<p>Character. The path to the file where to write the report.
If <code>file = ""</code>, the protocol report is output to the console.</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_append">append</code></td>
<td>
<p>Do we append to this file?</p>
</td></tr>
<tr><td><code id="svSuiteData_+3A_type">type</code></td>
<td>
<p>Character. The type of protocol report to create. For the moment,
only <code>type = "text"</code> and <code>type = "junit"</code> are supported, but further types
(HTML, LaTeX, Wiki, etc.) could be provided later.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A 'svSuiteData' is, indeed, an environment. The results for the various tests
runs are in non hidden (i.e., names not starting with a dot) objects that are
of class 'svTestData' in this environment. Various other objects that control
the execution of the test, their context, etc. are contained as hidden objects
with name starting with a dot. Note that using an environment instead of a
list for this object allows for a call by reference instead of a usual call by
value in R, when passing this object to a function. This property is largely
exploited in all svUnit functions to make sure results of test runs are
centralized in the same log ('svSuiteData' object).
</p>


<h3>Value</h3>

<p><code><a href="#topic+is.svSuiteData">is.svSuiteData()</a></code> returns <code>TRUE</code> if the object is an 'svSuiteData'. The
various methods serve to extract or print content in the object.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean; Mario Frasca for the junit protocol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svSuite">svSuite()</a></code>, <code><a href="#topic+is.svTestData">is.svTestData()</a></code>, <code><a href="#topic+Log">Log()</a></code>, <code><a href="#topic+checkEquals">checkEquals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>clearLog()    # Clear any existing log

# Run some tests
checkTrue(1 &lt; 2)
checkException(log("a"))
foo &lt;- function(x, y = 2)
  return(x * y)
test(foo) &lt;- function() {
  checkEqualsNumeric(4, foo(2))
  checkEqualsNumeric(6, foo(2, nonexisting))
  checkTrue(is.test(foo))
  warning("This is a warning")
  cat("Youhou from test!\n")  # Don't use, except for debugging!
  checkTrue(is.test(test(foo)))
  checkIdentical(attr(foo, "test"), test(foo))
  checkException(foo(2, nonexisting))
  #DEACTIVATED("My deactivation message")
  checkException(foo(2))  # This test fails
}
runTest(foo)

# Now inspect the log, which is a 'svSuiteData' object
is.svSuiteData(Log())
stats(Log())
metadata(Log())
Log()    # Print method
summary(Log())

## Not run: 
# To get a print of the test protocol on file, use:
protocol(Log(), type = "text", file = "RprofProtocol.out")
file.show("RprofProtocol.out")
unlink("RprofProtocol.out")

## End(Not run)

rm(foo)

## Not run: 
# Profiling of very simple test runs
library(utils)
createLog(description = "test profiling", deleteExisting = TRUE)
imax &lt;- 3
jmax &lt;- 100
l &lt;- 50
Rprof()
for (i in 1:imax) {
  # Change the context for these tests
  .Log$..Test &lt;- paste("Test", i, sep = "")
  .Log$..Tag &lt;- paste("#", i, sep = "")
  res &lt;- system.time({
    for (j in 1:jmax) checkTrue(i &lt;= j, "My test")
  }, gcFirst = TRUE)[3]
  print(res)
  flush.console()
}
Rprof(NULL)
# Look at profile
summaryRprof()
unlink("Rprof.out")

# Look at the log
summary(Log())

## End(Not run)
</code></pre>

<hr>
<h2 id='svTestData'>Objects of class 'svTestData' contain results from running a test</h2><span id='topic+svTestData'></span><span id='topic+is.svTestData'></span><span id='topic+stats'></span><span id='topic+stats.svTestData'></span><span id='topic+print.svTestData'></span><span id='topic+summary.svTestData'></span><span id='topic+protocol_junit.svTestData'></span>

<h3>Description</h3>

<p>The 'svTestData' contains results of test run. The <code>checkxxx()</code> functions and
the <code>runTest()</code> method generate one such object which is located in the
<code>.Log</code> object in <code>.GlobalEnv</code>. It is then possible to display and report
information it contains in various ways to analyze the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.svTestData(x)

stats(object, ...)

## S3 method for class 'svTestData'
stats(object, ...)

## S3 method for class 'svTestData'
print(x, all = FALSE, header = TRUE, file = "", append = FALSE, ...)

## S3 method for class 'svTestData'
summary(object, header = TRUE, file = "", append = FALSE, ...)

## S3 method for class 'svTestData'
protocol_junit(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svTestData_+3A_x">x</code></td>
<td>
<p>Any kind of object, or a 'svTestData' object in the case of
<code><a href="base.html#topic+print">print()</a></code>.</p>
</td></tr>
<tr><td><code id="svTestData_+3A_object">object</code></td>
<td>
<p>A 'svTestData' object.</p>
</td></tr>
<tr><td><code id="svTestData_+3A_...">...</code></td>
<td>
<p>Further arguments to pass to methods. Not used yet.</p>
</td></tr>
<tr><td><code id="svTestData_+3A_all">all</code></td>
<td>
<p>Do we print concise report for all test, or only for the tests
that fail or produce an error?</p>
</td></tr>
<tr><td><code id="svTestData_+3A_header">header</code></td>
<td>
<p>Do we print a header or not?</p>
</td></tr>
<tr><td><code id="svTestData_+3A_file">file</code></td>
<td>
<p>Character. The path to the file where to write the report. If
<code>file = ""</code>, the report is output to the console.</p>
</td></tr>
<tr><td><code id="svTestData_+3A_append">append</code></td>
<td>
<p>Do we append to this file?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+is.svTestData">is.svTestData()</a></code> returns <code>TRUE</code> if the object is an 'svTestData'. The
various methods serve to extract or print content in the object.
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>See Also</h3>

<p><code><a href="#topic+svTest">svTest()</a></code>, <code><a href="#topic+is.svSuiteData">is.svSuiteData()</a></code>, <code><a href="#topic+Log">Log()</a></code>, <code><a href="#topic+checkEquals">checkEquals()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>foo &lt;- function(x, y = 2)
  return(x * y)
is.test(foo)  # No
# Create test cases for this function
test(foo) &lt;- function() {
  checkEqualsNumeric(4, foo(2))
  checkEqualsNumeric(5, foo(2, 3))
  checkEqualsNumeric(5, foo(nonexists))
}
# Generate a 'svTestData' object by running the test
obj &lt;- runTest(foo)  # Equivalent to runTest(test(foo)), but shorter
obj
summary(obj)
stats(obj)
is.svTestData(obj)

rm(foo, obj)
</code></pre>

<hr>
<h2 id='unitTests.svUnit'>Unit tests for the package 'svUnit'</h2><span id='topic+unitTests.svUnit'></span>

<h3>Description</h3>

<p>Performs unit tests defined in this package by running
<code>example(unitTests.svUnit)</code>. Tests are in <code>runit*.R</code> files located in the
'/unitTests' subdirectory or one of its subdirectories ('/inst/unitTests' and
subdirectories in package sources).
</p>


<h3>Author(s)</h3>

<p>Philippe Grosjean
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require(svUnit)) {
  clearLog()
  runTest(svSuite("package:svUnit"), "svUnit")
  
  # Tests to run with example() but not with R CMD check
  runTest(svSuite("package:svUnit (VirtualClass)"), "VirtualClass")
  
  ## Not run: 
  # Tests to present in ?unitTests.svUnit but not run automatically
  # Run all currently loaded packages test cases and test suites
  runTest(svSuiteList(), "AllTests")
  
## End(Not run)
  
  # Check errors at the end (needed to interrupt R CMD check)
  errorLog()
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
