<!DOCTYPE html><html><head><title>Help for package eemR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eemR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eemR-package'><p>eemR: Tools for Pre-Processing Emission-Excitation-Matrix (EEM) Fluorescence</p>
Data</a></li>
<li><a href='#absorbance'><p>CDOM absorbance data.</p></a></li>
<li><a href='#eem'><p>eem constructor</p></a></li>
<li><a href='#eem_bind'><p>Bind eem or eemlist</p></a></li>
<li><a href='#eem_biological_index'><p>Calculate the biological fluorescence index (BIX)</p></a></li>
<li><a href='#eem_coble_peaks'><p>Extract fluorescence peaks</p></a></li>
<li><a href='#eem_cut'><p>Cut emission and/or excitation wavelengths from EEMs</p></a></li>
<li><a href='#eem_export_matlab'><p>Export EEMs to Matlab</p></a></li>
<li><a href='#eem_extract'><p>Extract EEM samples</p></a></li>
<li><a href='#eem_extract_blank'><p>Extract blank EEM</p></a></li>
<li><a href='#eem_fluorescence_index'><p>Calculate the fluorescence index (FI)</p></a></li>
<li><a href='#eem_humification_index'><p>Calculate the fluorescence humification index (HIX)</p></a></li>
<li><a href='#eem_inner_filter_effect'><p>Inner-filter effect correction</p></a></li>
<li><a href='#eem_names'><p>The names of an eem or eemlist objects</p></a></li>
<li><a href='#eem_names&lt;-'><p>Set the sample names of an eem or eemlist objects</p></a></li>
<li><a href='#eem_peaks'><p>Extract fluorescence peaks</p></a></li>
<li><a href='#eem_raman_normalisation'><p>Fluorescence Intensity Calibration Using the Raman Scatter Peak of Water</p></a></li>
<li><a href='#eem_read'><p>Read excitation-emission fluorescence matrix (eem)</p></a></li>
<li><a href='#eem_remove_blank'><p>Blank correction</p></a></li>
<li><a href='#eem_remove_scattering'><p>Remove Raman and Rayleigh scattering</p></a></li>
<li><a href='#eem_set_wavelengths'><p>Set Excitation and/or Emission wavelengths</p></a></li>
<li><a href='#plot.eemlist'><p>Surface plot of eem</p></a></li>
<li><a href='#print.eemlist'><p>Display summary of an eemlist object</p></a></li>
<li><a href='#summary.eemlist'><p>Display summary of an eemlist object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Pre-Processing Emission-Excitation-Matrix (EEM)
Fluorescence Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides various tools for preprocessing Emission-Excitation-Matrix (EEM) for Parallel Factor Analysis (PARAFAC). Different
  methods are also provided to calculate common metrics such as humification index and fluorescence index.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/PMassicotte/eemR/issues">https://github.com/PMassicotte/eemR/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/PMassicotte/eemR">https://github.com/PMassicotte/eemR</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringr, dplyr, R.matlab, pracma, stats, rlist, viridis,
purrr, assertthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cdom, magrittr, testthat, knitr, rmarkdown, ggplot2, plot3D,
extrafont, tidyr, shiny, DT, MBA</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-25 18:12:39 UTC; pmassicotte</td>
</tr>
<tr>
<td>Author:</td>
<td>Philippe Massicotte [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philippe Massicotte &lt;pmassicotte@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-26 13:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='eemR-package'>eemR: Tools for Pre-Processing Emission-Excitation-Matrix (EEM) Fluorescence
Data</h2><span id='topic+eemR'></span><span id='topic+eemR-package'></span>

<h3>Description</h3>

<p>Provides various tools for preprocessing Emission-Excitation-Matrix (EEM) for Parallel Factor Analysis (PARAFAC). Different
methods are also provided to calculate common metrics such as humification index and fluorescence index.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Philippe Massicotte <a href="mailto:pmassicotte@hotmail.com">pmassicotte@hotmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/PMassicotte/eemR">https://github.com/PMassicotte/eemR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/PMassicotte/eemR/issues">https://github.com/PMassicotte/eemR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='absorbance'>CDOM absorbance data.</h2><span id='topic+absorbance'></span>

<h3>Description</h3>

<p>Simple absorbance spectra used to test package's functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("absorbance")
</code></pre>


<h3>Format</h3>

<p>A data frame with 711 rows and 4 variables</p>


<h3>Details</h3>


<ul>
<li><p> wavelength.  Wavelengths used for measurements (190-900 nm.)
</p>
</li>
<li><p> absorbance
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
data("absorbance")

plot(absorbance$wavelength, absorbance$sample1,
  type = "l",
  xlab = "Wavelengths", ylab = "Absorbance per meter"
)
lines(absorbance$wavelength, absorbance$sample2, col = "blue")
lines(absorbance$wavelength, absorbance$sample3, col = "red")
</code></pre>

<hr>
<h2 id='eem'>eem constructor</h2><span id='topic+eem'></span>

<h3>Description</h3>

<p>eem constructor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_+3A_data">data</code></td>
<td>
<p>A list containing &quot;file&quot;, &quot;x&quot;, &quot;em&quot;, &quot;ex&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eem</code> containing:
</p>

<ul>
<li><p> sample The file name of the eem.
</p>
</li>
<li><p> x A matrix with fluorescence values.
</p>
</li>
<li><p> em Emission vector of wavelengths.
</p>
</li>
<li><p> ex Excitation vector of wavelengths.
</p>
</li></ul>


<hr>
<h2 id='eem_bind'>Bind eem or eemlist</h2><span id='topic+eem_bind'></span>

<h3>Description</h3>

<p>Function to bind EEMs that have been loaded from different folders or have
been processed differently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_bind(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_bind_+3A_...">...</code></td>
<td>
<p>One or more object of class <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>eemlist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem &lt;- eem_bind(eem, eem)
</code></pre>

<hr>
<h2 id='eem_biological_index'>Calculate the biological fluorescence index (BIX)</h2><span id='topic+eem_biological_index'></span>

<h3>Description</h3>

<p>The biological fluorescence index (BIX) is calculated by
dividing the fluorescence at excitation 310 nm and emission at 380 nm (ex =
310, em = 380) by that at excitation 310 nm and emission at 430 nm (ex =
310, em = 430).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_biological_index(eem, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_biological_index_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_biological_index_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if additional messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A data frame containing the biological index (BIX) for each eem.
</p>


<h3>Interpolation</h3>

<p>Different excitation and emission wavelengths are often used to measure
EEMs. Hence, it is possible to have mismatchs between measured wavelengths
and wavelengths used to calculate specific metrics. In these circumstances,
EEMs are interpolated using the <code><a href="pracma.html#topic+interp2">interp2</a></code> function from the
<code>parcma</code> library. A message warning the user will be prompted if data
interpolation is performed.
</p>


<h3>References</h3>

<p>Huguet, A., Vacher, L., Relexans, S., Saubusse, S., Froidefond,
J. M., &amp; Parlanti, E. (2009). Properties of fluorescent dissolved organic
matter in the Gironde Estuary. Organic Geochemistry, 40(6), 706-719.
</p>
<p><a href="http://doi.org/10.1016/j.orggeochem.2009.03.002">http://doi.org/10.1016/j.orggeochem.2009.03.002</a>
</p>


<h3>See Also</h3>

<p><a href="pracma.html#topic+interp2">interp2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem_biological_index(eem)
</code></pre>

<hr>
<h2 id='eem_coble_peaks'>Extract fluorescence peaks</h2><span id='topic+eem_coble_peaks'></span>

<h3>Description</h3>

<p>Extract fluorescence peaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_coble_peaks(eem, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_coble_peaks_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_coble_peaks_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if additional messages should be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to Coble (1996), peaks are defined as follow:
</p>
<p>Peak B: ex = 275 nm, em = 310 nm
</p>
<p>Peak T: ex = 275 nm, em = 340 nm
</p>
<p>Peak A: ex = 260 nm, em = 380:460 nm
</p>
<p>Peak M: ex = 312 nm, em = 380:420 nm
</p>
<p>peak C: ex = 350 nm, em = 420:480 nm
</p>
<p>Given that peaks A, M and C are not defined at fix emission wavelength,
the maximum fluorescence value in the region is extracted.
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A data frame containing peaks B, T, A, M and C for each eem. See
details for more information.
</p>


<h3>Interpolation</h3>

<p>Different excitation and emission wavelengths are often used to measure
EEMs. Hence, it is possible to have mismatchs between measured wavelengths
and wavelengths used to calculate specific metrics. In these circumstances,
EEMs are interpolated using the <code><a href="pracma.html#topic+interp2">interp2</a></code> function from the
<code>parcma</code> library. A message warning the user will be prompted if data
interpolation is performed.
</p>


<h3>References</h3>

<p>Coble, P. G. (1996). Characterization of marine and terrestrial
DOM in seawater using excitation-emission matrix spectroscopy. Marine
Chemistry, 51(4), 325-346.
</p>
<p><a href="http://doi.org/10.1016/0304-4203(95)00062-3">http://doi.org/10.1016/0304-4203(95)00062-3</a>
</p>


<h3>See Also</h3>

<p><a href="pracma.html#topic+interp2">interp2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem_coble_peaks(eem)
</code></pre>

<hr>
<h2 id='eem_cut'>Cut emission and/or excitation wavelengths from EEMs</h2><span id='topic+eem_cut'></span>

<h3>Description</h3>

<p>Cut emission and/or excitation wavelengths from EEMs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_cut(eem, ex, em, exact = TRUE, fill_with_na = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_cut_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_cut_+3A_ex">ex</code></td>
<td>
<p>A numeric vector of excitation wavelengths to be removed.</p>
</td></tr>
<tr><td><code id="eem_cut_+3A_em">em</code></td>
<td>
<p>A numeric vector of emission wavelengths to be removed.</p>
</td></tr>
<tr><td><code id="eem_cut_+3A_exact">exact</code></td>
<td>
<p>Logical. If TRUE, only wavelengths matching <code>em</code> and/or
<code>ex</code> will be removed. If FALSE, all wavelengths in the range of
<code>em</code> and/or <code>ex</code> will be removed.</p>
</td></tr>
<tr><td><code id="eem_cut_+3A_fill_with_na">fill_with_na</code></td>
<td>
<p>Logical. If TRUE, fluorescence values at specified
wavelengths will be replaced with NA. If FALSE, these values will be
removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the fluorescence eem
file &lt;- system.file("extdata/cary/scans_day_1/", "sample1.csv", package = "eemR")

eem &lt;- eem_read(file, import_function = "cary")
plot(eem)

# Cut few excitation wavelengths
eem &lt;- eem_cut(eem, ex = c(220, 225, 230, 230))
plot(eem)

eem &lt;- eem_read(file, import_function = "cary")
eem &lt;- eem_cut(eem, em = 350:400, fill_with_na = TRUE)
plot(eem)
</code></pre>

<hr>
<h2 id='eem_export_matlab'>Export EEMs to Matlab</h2><span id='topic+eem_export_matlab'></span>

<h3>Description</h3>

<p>Export EEMs to Matlab
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_export_matlab(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_export_matlab_+3A_file">file</code></td>
<td>
<p>The .mat file name where to export the structure.</p>
</td></tr>
<tr><td><code id="eem_export_matlab_+3A_...">...</code></td>
<td>
<p>One or more object of class <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function exports EEMs into PARAFAC-ready Matlab <code>.mat</code> file
usable by the <a href="http://www.models.life.ku.dk/drEEM">drEEM</a> toolbox.
</p>


<h3>Value</h3>

<p>A structure named <code>OriginalData</code> is created and contains:
</p>
 <dl>
<dt>nSample</dt><dd><p>The number of eems.</p>
</dd> <dt>nEx</dt><dd><p>The number of
excitation wavelengths.</p>
</dd> <dt>nEm</dt><dd><p>The number of emission wavelengths.</p>
</dd>
<dt>Ex</dt><dd><p>A vector containing excitation wavelengths.</p>
</dd> <dt>Em</dt><dd><p>A vector
containing emission wavelengths.</p>
</dd> <dt>X</dt><dd><p>A 3D matrix (nSample X nEx X
nEm) containing EEMs.</p>
</dd> </dl>

<p><code>sample_name</code> The list of sample names (i.e. file names) of the
imported EEMs.
</p>


<h3>Known bug in export</h3>

<p><code>eemR</code> uses <code>R.Matlab</code> to export the
the fluorescence data into a matfile. However, there is currently a bug in
the latter package that require the user to reshape the exported data once
in Matlab. This can be done using the following command:
<code>load('OriginalData.mat'); OriginalData.X = reshape(OriginalData.X,
  OriginalData.nSample, OriginalData.nEm, OriginalData.nEx)</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/", package = "eemR")
eem &lt;- eem_read(file, recursive = TRUE, import_function = "cary")

export_to &lt;- paste(tempfile(), ".mat", sep = "")
eem_export_matlab(export_to, eem)
</code></pre>

<hr>
<h2 id='eem_extract'>Extract EEM samples</h2><span id='topic+eem_extract'></span>

<h3>Description</h3>

<p>Extract EEM samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_extract(eem, sample, keep = FALSE, ignore_case = FALSE,
  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_extract_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_extract_+3A_sample">sample</code></td>
<td>
<p>Either numeric of character vector. See <code>details</code> for more
information.</p>
</td></tr>
<tr><td><code id="eem_extract_+3A_keep">keep</code></td>
<td>
<p>logical. If TRUE, the specified <code>sample</code> will be returned.
If FALSE, they will be removed.</p>
</td></tr>
<tr><td><code id="eem_extract_+3A_ignore_case">ignore_case</code></td>
<td>
<p>Logical, should sample name case should be ignored (TRUE)
or not (FALSE). Default is FALSE.</p>
</td></tr>
<tr><td><code id="eem_extract_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if removed/extracted eems should be
printed on screen.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sample</code> argument can be either numeric or character vector. If
it is numeric, samples at specified index will be removed.
</p>
<p>If <code>sample</code> is character, regular expression will be used and all
sample names that have a partial or complete match with the expression will
be removed. See <code>examples</code> for more details.
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/cary/scans_day_1", package = "eemR")
eems &lt;- eem_read(folder, import_function = "cary")

eems

# Remove first and third samples
eem_extract(eems, c(1, 3))

# Remove everything except first and third samples
eem_extract(eems, c(1, 3), keep = TRUE)

# Remove all samples containing "3" in their names.
eem_extract(eems, "3")

# Remove all samples containing either character "s" or character "2" in their names.
eem_extract(eems, c("s", "2"))

# Remove all samples containing "blank" or "nano"
eem_extract(eems, c("blank", "nano"))
</code></pre>

<hr>
<h2 id='eem_extract_blank'>Extract blank EEM</h2><span id='topic+eem_extract_blank'></span>

<h3>Description</h3>

<p>Extract blank EEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_extract_blank(eem, average = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_extract_blank_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_extract_blank_+3A_average">average</code></td>
<td>
<p>Logical. If TRUE blank EEMs will be averaged</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>

<hr>
<h2 id='eem_fluorescence_index'>Calculate the fluorescence index (FI)</h2><span id='topic+eem_fluorescence_index'></span>

<h3>Description</h3>

<p>Calculate the fluorescence index (FI)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_fluorescence_index(eem, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_fluorescence_index_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_fluorescence_index_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if additional messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A data frame containing fluorescence index (FI) for each eem.
</p>


<h3>Interpolation</h3>

<p>Different excitation and emission wavelengths are often used to measure
EEMs. Hence, it is possible to have mismatchs between measured wavelengths
and wavelengths used to calculate specific metrics. In these circumstances,
EEMs are interpolated using the <code><a href="pracma.html#topic+interp2">interp2</a></code> function from the
<code>parcma</code> library. A message warning the user will be prompted if data
interpolation is performed.
</p>


<h3>References</h3>

<p><a href="http://doi.wiley.com/10.4319/lo.2001.46.1.0038">http://doi.wiley.com/10.4319/lo.2001.46.1.0038</a>
</p>


<h3>See Also</h3>

<p><a href="pracma.html#topic+interp2">interp2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem_fluorescence_index(eem)
</code></pre>

<hr>
<h2 id='eem_humification_index'>Calculate the fluorescence humification index (HIX)</h2><span id='topic+eem_humification_index'></span>

<h3>Description</h3>

<p>The fluorescence humification index (HIX), which compares two
broad aromatic dominated fluorescence maxima, is calculated at 254 nm
excitation by dividing the sum of fluorescence intensities between emission
435 to 480 nm by the the sum of fluorescence intensities between 300 to 345
nm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_humification_index(eem, scale = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_humification_index_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_humification_index_+3A_scale">scale</code></td>
<td>
<p>Logical indicating if HIX should be scaled, default is FALSE.
See details for more information.</p>
</td></tr>
<tr><td><code id="eem_humification_index_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if additional messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A data frame containing the humification index (HIX) for each eem.
</p>


<h3>Interpolation</h3>

<p>Different excitation and emission wavelengths are often used to measure
EEMs. Hence, it is possible to have mismatchs between measured wavelengths
and wavelengths used to calculate specific metrics. In these circumstances,
EEMs are interpolated using the <code><a href="pracma.html#topic+interp2">interp2</a></code> function from the
<code>parcma</code> library. A message warning the user will be prompted if data
interpolation is performed.
</p>


<h3>References</h3>

<p>Ohno, T. (2002). Fluorescence Inner-Filtering Correction for
Determining the Humification Index of Dissolved Organic Matter.
Environmental Science &amp; Technology, 36(4), 742-746.
</p>
<p><a href="http://doi.org/10.1021/es0155276">http://doi.org/10.1021/es0155276</a>
</p>


<h3>See Also</h3>

<p><a href="pracma.html#topic+interp2">interp2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem_humification_index(eem)
</code></pre>

<hr>
<h2 id='eem_inner_filter_effect'>Inner-filter effect correction</h2><span id='topic+eem_inner_filter_effect'></span>

<h3>Description</h3>

<p>Inner-filter effect correction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_inner_filter_effect(eem, absorbance, pathlength = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_inner_filter_effect_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_inner_filter_effect_+3A_absorbance">absorbance</code></td>
<td>
<p>A data frame with:
</p>
 <dl>
<dt>wavelength</dt><dd><p>A numeric vector containing wavelengths.</p>
</dd>
<dt>...</dt><dd><p>One or more numeric vectors containing absorbance spectra.</p>
</dd></dl>
</td></tr>
<tr><td><code id="eem_inner_filter_effect_+3A_pathlength">pathlength</code></td>
<td>
<p>A numeric value indicating the pathlength (in cm) of the
cuvette used for absorbance measurement. Default is 1 (1cm).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inner-filter effect correction procedure is assuming that
fluorescence has been measured in 1 cm cuvette. Hence, absorbance will be
converted per cm. Note that absorbance spectra should be provided (i.e. not
absorption).
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>An object of class <code>eem</code> containing: </p>
 <ul>
<li><p> sample The
file name of the eem. </p>
</li>
<li><p> x A matrix with fluorescence values. </p>
</li>
<li><p> em
Emission vector of wavelengths. </p>
</li>
<li><p> ex Excitation vector of wavelengths.
</p>
</li></ul>



<h3>Names matching</h3>

<p>The names of <code>absorbance</code> variables are expected to match those of the
eems. If the appropriate absorbance spectrum is not found, an uncorrected
eem will be returned and a warning message will be printed.
</p>


<h3>Sample dilution</h3>

<p>Kothawala et al. 2013 have shown that a 2-fold dilution was required for
sample presenting total absorbance &gt; 1.5 in a 1 cm cuvette. Accordingly, a
message will warn the user if total absorbance is greater than this
threshold.
</p>


<h3>References</h3>

<p>Parker, C. a., &amp; Barnes, W. J. (1957). Some experiments with
spectrofluorometers and filter fluorimeters. The Analyst, 82(978), 606.
<a href="http://doi.org/10.1039/an9578200606">http://doi.org/10.1039/an9578200606</a>
</p>
<p>Kothawala, D. N., Murphy, K. R., Stedmon, C. A., Weyhenmeyer, G. A., &amp;
Tranvik, L. J. (2013). Inner filter correction of dissolved organic matter
fluorescence. Limnology and Oceanography: Methods, 11(12), 616-630.
<a href="http://doi.org/10.4319/lom.2013.11.616">http://doi.org/10.4319/lom.2013.11.616</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(eemR)
data("absorbance")

folder &lt;- system.file("extdata/cary/scans_day_1", package = "eemR")
eems &lt;- eem_read(folder, import_function = "cary")
eems &lt;- eem_extract(eems, "nano") # Remove the blank sample

# Remove scattering (1st order)
eems &lt;- eem_remove_scattering(eems, "rayleigh")

eems_corrected &lt;- eem_inner_filter_effect(eems, absorbance = absorbance, pathlength = 1)

op &lt;- par(mfrow = c(2, 1))
plot(eems, which = 1)
plot(eems_corrected, which = 1)
par(op)
</code></pre>

<hr>
<h2 id='eem_names'>The names of an eem or eemlist objects</h2><span id='topic+eem_names'></span>

<h3>Description</h3>

<p>The names of an eem or eemlist objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_names(eem)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_names_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A character vector containing the names of the EEMs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/", package = "eemR")
eem &lt;- eem_read(file, recursive = TRUE, import_function = "cary")

eem_names(eem)
</code></pre>

<hr>
<h2 id='eem_names+26lt+3B-'>Set the sample names of an eem or eemlist objects</h2><span id='topic+eem_names+3C-'></span>

<h3>Description</h3>

<p>Set the sample names of an eem or eemlist objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_names(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_names+2B26lt+2B3B-_+3A_x">x</code></td>
<td>
<p>An object of class <code>eem</code> or <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_names+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>A character vector with new sample names. Must be equal
in length to the number of samples in the <code>eem</code> or <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>eem</code> or <code>eemlist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/cary/scans_day_1", package = "eemR")
eems &lt;- eem_read(folder, import_function = "cary")

eem_names(eems)
eem_names(eems) &lt;- c("a", "b", "c", "d")
eem_names(eems)
</code></pre>

<hr>
<h2 id='eem_peaks'>Extract fluorescence peaks</h2><span id='topic+eem_peaks'></span>

<h3>Description</h3>

<p>Extract fluorescence peaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_peaks(eem, ex, em, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_peaks_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_peaks_+3A_ex">ex</code></td>
<td>
<p>A numeric vector with excitation wavelengths.</p>
</td></tr>
<tr><td><code id="eem_peaks_+3A_em">em</code></td>
<td>
<p>A numeric vector with emission wavelengths.</p>
</td></tr>
<tr><td><code id="eem_peaks_+3A_verbose">verbose</code></td>
<td>
<p>Logical determining if additional messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>A data frame containing excitation and emission peak values. See
details for more information.
</p>


<h3>Interpolation</h3>

<p>Different excitation and emission wavelengths are often used to measure
EEMs. Hence, it is possible to have mismatchs between measured wavelengths
and wavelengths used to calculate specific metrics. In these circumstances,
EEMs are interpolated using the <code><a href="pracma.html#topic+interp2">interp2</a></code> function from the
<code>parcma</code> library. A message warning the user will be prompted if data
interpolation is performed.
</p>


<h3>See Also</h3>

<p><a href="pracma.html#topic+interp2">interp2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

eem_peaks(eem, ex = c(250, 350), em = c(300, 400))
</code></pre>

<hr>
<h2 id='eem_raman_normalisation'>Fluorescence Intensity Calibration Using the Raman Scatter Peak of Water</h2><span id='topic+eem_raman_normalisation'></span>

<h3>Description</h3>

<p>Normalize fluorescence intensities to the standard scale of
Raman Units (R.U).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_raman_normalisation(eem, blank = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_raman_normalisation_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_raman_normalisation_+3A_blank">blank</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will first try to use the provided <code>blank</code>. If the
blank is omitted, the function will then try to extract the blank from the
<code>eemlist</code> object. This is done by looking for sample names containing
one of these complete or partial strings (ignoring case):
</p>
 <ol>
<li><p> nano </p>
</li>
<li><p> miliq </p>
</li>
<li><p> milliq </p>
</li>
<li><p> mq </p>
</li>
<li><p> blank </p>
</li></ol>

<p>Note that if <code>blank</code> is omitted, the function will group the
<code>eemlist</code> based on file location and will assumes that there is a
blank sample in each folder. In that context, the blank will be used on
each sample in the same folder. If more than one blank is found they will
be averaged (a message will be printed if this appends).
</p>
<p>Consider the following example where there are two folders that could
represent scans performed on two different days 'scans_day_1' and
'scans_day_2'.
</p>

<table>
<tr>
 <td style="text-align: left;"> scans_day_1</td><td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> nano.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> sample1.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;">
  sample2.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> sample3.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> scans_day_2 </td><td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> blank.csv</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> s1.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> s2.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> s3.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

<p>In each folder there are three samples and one blank files. In that
context, 'eem_remove_blank()' will use the blank 'nano.csv' from
'sample1.csv', 'sample2.csv' and 'sample3.csv'. The same strategy will be
used for files in folder 'scans_day_2' but with blank named 'blank.csv'.
</p>
<p>Note that the blanks eem are not returned by the function.
</p>
<p>The normalization procedure consists in dividing all fluorescence
intensities by the area (integral) of the Raman peak. The peak is located
at excitation of 350 nm. (ex = 370) between 371 nm. and 428 nm in emission
(371 &lt;= em &lt;= 428). Note that the data is interpolated to make sure that
fluorescence at em 350 exist.
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>
<p>An object of class <code>eem</code> containing: </p>
 <ul>
<li><p> sample The
file name of the eem. </p>
</li>
<li><p> x A matrix with fluorescence values. </p>
</li>
<li><p> em
Emission vector of wavelengths. </p>
</li>
<li><p> ex Excitation vector of wavelengths.
</p>
</li></ul>



<h3>References</h3>

<p>Lawaetz, A. J., &amp; Stedmon, C. A. (2009). Fluorescence Intensity Calibration
Using the Raman Scatter Peak of Water. Applied Spectroscopy, 63(8), 936-940.
</p>
<p><a href="https://journals.sagepub.com/doi/10.1366/000370209788964548">https://journals.sagepub.com/doi/10.1366/000370209788964548</a>
</p>
<p>Murphy, K. R., Stedmon, C. a., Graeber, D., &amp; Bro, R. (2013). Fluorescence
spectroscopy and multi-way techniques. PARAFAC. Analytical Methods, 5(23),
6557.
</p>
<p><a href="http://xlink.rsc.org/?DOI=c3ay41160e">http://xlink.rsc.org/?DOI=c3ay41160e</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the fluorescence eem
file &lt;- system.file("extdata/cary/scans_day_1", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

plot(eem)

# Open the blank eem
file &lt;- system.file("extdata/cary/scans_day_1", "nano.csv", package = "eemR")
blank &lt;- eem_read(file, import_function = "cary")

# Do the normalisation
eem &lt;- eem_raman_normalisation(eem, blank)

plot(eem)
</code></pre>

<hr>
<h2 id='eem_read'>Read excitation-emission fluorescence matrix (eem)</h2><span id='topic+eem_read'></span>

<h3>Description</h3>

<p>Read excitation-emission fluorescence matrix (eem)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_read(file, recursive = FALSE, import_function)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_read_+3A_file">file</code></td>
<td>
<p>File name or folder containing fluorescence file(s).</p>
</td></tr>
<tr><td><code id="eem_read_+3A_recursive">recursive</code></td>
<td>
<p>logical. Should the listing recurse into directories?</p>
</td></tr>
<tr><td><code id="eem_read_+3A_import_function">import_function</code></td>
<td>
<p>Either a character or a user-defined function to
import a single eem. If a character, it should be one of &quot;cary&quot;, &quot;aqualog&quot;,
&quot;shimadzu&quot;, &quot;fluoromax4&quot;. See <code>browseVignettes("eemR")</code> to learn how to create your own
import function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>At the moment, Cary Eclipse, Aqualog and Shimadzu EEMs are
supported.
</p>
<p><code>eemR</code> will automatically try to determine from which
spectrofluorometer the files originate and load the data accordingly. Note
that EEMs are reshaped so X[1, 1] represents the fluorescence intensity at
X[min(ex), min(em)].
</p>


<h3>Value</h3>

<p>If <code>file</code> is a single filename:
</p>
<p>An object of class <code>eem</code> containing: </p>
 <ul>
<li><p> sample The file
name of the eem. </p>
</li>
<li><p> x A matrix with fluorescence values. </p>
</li>
<li><p> em
Emission vector of wavelengths. </p>
</li>
<li><p> ex Excitation vector of wavelengths.
</p>
</li></ul>

<p>If <code>file</code> is a folder, the function returns an object of class
<code>eemlist</code> which is simply a list of <code>eem</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata/cary/scans_day_1/", package = "eemR")
eems &lt;- eem_read(file, recursive = TRUE, import_function = "cary")
</code></pre>

<hr>
<h2 id='eem_remove_blank'>Blank correction</h2><span id='topic+eem_remove_blank'></span>

<h3>Description</h3>

<p>This function is used to remove blank from eems which can help
to reduce the effect of scatter bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_remove_blank(eem, blank = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_remove_blank_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_remove_blank_+3A_blank">blank</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will first try to use the provided <code>blank</code>. If the
blank is omitted, the function will then try to extract the blank from the
<code>eemlist</code> object. This is done by looking for sample names containing
one of these complete or partial strings (ignoring case):
</p>
 <ol>
<li><p> nano </p>
</li>
<li><p> miliq </p>
</li>
<li><p> milliq </p>
</li>
<li><p> mq </p>
</li>
<li><p> blank </p>
</li></ol>

<p>Note that if <code>blank</code> is omitted, the function will group the
<code>eemlist</code> based on file location and will assumes that there is a
blank sample in each folder. In that context, the blank will be used on
each sample in the same folder. If more than one blank is found they will
be averaged (a message will be printed if this appends).
</p>
<p>Consider the following example where there are two folders that could
represent scans performed on two different days 'scans_day_1' and
'scans_day_2'.
</p>

<table>
<tr>
 <td style="text-align: left;"> scans_day_1</td><td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> nano.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> sample1.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;">
  sample2.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> sample3.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> scans_day_2 </td><td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> blank.csv</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> s1.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> s2.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td><td style="text-align: left;"> s3.csv</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

<p>In each folder there are three samples and one blank files. In that
context, 'eem_remove_blank()' will use the blank 'nano.csv' from
'sample1.csv', 'sample2.csv' and 'sample3.csv'. The same strategy will be
used for files in folder 'scans_day_2' but with blank named 'blank.csv'.
</p>
<p>Note that the blanks eem are not returned by the function.
</p>
<p>Note that blank correction should be performed before Raman
normalization (<code>eem_raman_normalisation()</code>). An error will occur
if trying to perform blank correction after Raman normalization.
</p>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>


<h3>References</h3>

<p>Murphy, K. R., Stedmon, C. a., Graeber, D., &amp; Bro, R. (2013).
Fluorescence spectroscopy and multi-way techniques. PARAFAC. Analytical
Methods, 5(23), 6557. http://doi.org/10.1039/c3ay41160e
</p>
<p><a href="http://xlink.rsc.org/?DOI=c3ay41160e">http://xlink.rsc.org/?DOI=c3ay41160e</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1

# Open the fluorescence eem
file &lt;- system.file("extdata/cary/scans_day_1", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

plot(eem)

# Open the blank eem
file &lt;- system.file("extdata/cary/scans_day_1", "nano.csv", package = "eemR")
blank &lt;- eem_read(file, import_function = "cary")

plot(blank)

# Remove the blank
eem &lt;- eem_remove_blank(eem, blank)

plot(eem)

## Example 2

# Open the fluorescence eem
folder &lt;- system.file("extdata/cary/scans_day_1", package = "eemR")
eems &lt;- eem_read(folder, import_function = "cary")

plot(eems, which = 3)

# Open the blank eem
file &lt;- system.file("extdata/cary/scans_day_1", "nano.csv", package = "eemR")
blank &lt;- eem_read(file, import_function = "cary")

plot(blank)

# Remove the blank
eem &lt;- eem_remove_blank(eems, blank)

plot(eems, which = 3)

# Automatic correction
folder &lt;- system.file("extdata/cary/", package = "eemR")

# Look at the folder structure
list.files(folder, "*.csv", recursive = TRUE)

eems &lt;- eem_read(folder, recursive = TRUE, import_function = "cary")
res &lt;- eem_remove_blank(eems)
</code></pre>

<hr>
<h2 id='eem_remove_scattering'>Remove Raman and Rayleigh scattering</h2><span id='topic+eem_remove_scattering'></span>

<h3>Description</h3>

<p>Remove Raman and Rayleigh scattering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_remove_scattering(eem, type, order = 1, width = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_remove_scattering_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_remove_scattering_+3A_type">type</code></td>
<td>
<p>A string, either &quot;raman&quot; or &quot;rayleigh&quot;.</p>
</td></tr>
<tr><td><code id="eem_remove_scattering_+3A_order">order</code></td>
<td>
<p>A integer number, either 1 (first order) or 2 (second order).</p>
</td></tr>
<tr><td><code id="eem_remove_scattering_+3A_width">width</code></td>
<td>
<p>Slit width in nm for the cut. Default is 10 nm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>


<h3>References</h3>

<p>Lakowicz, J. R. (2006). Principles of Fluorescence Spectroscopy.
Boston, MA: Springer US.#'
</p>
<p><a href="http://doi.org/10.1007/978-0-387-46312-4">http://doi.org/10.1007/978-0-387-46312-4</a>
</p>
<p>Murphy, K. R., Stedmon, C. a., Graeber, D., &amp; Bro, R. (2013).
Fluorescence spectroscopy and multi-way techniques. PARAFAC. Analytical
Methods, 5(23), 6557. http://doi.org/10.1039/c3ay41160e#'
</p>
<p><a href="http://xlink.rsc.org/?DOI=c3ay41160e">http://xlink.rsc.org/?DOI=c3ay41160e</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the fluorescence eem
file &lt;- system.file("extdata/cary/scans_day_1", "sample1.csv", package = "eemR")
eem &lt;- eem_read(file, import_function = "cary")

plot(eem)

# Remove the scattering
eem &lt;- eem_remove_scattering(eem = eem, type = "raman", order = 1, width = 10)
eem &lt;- eem_remove_scattering(eem = eem, type = "rayleigh", order = 1, width = 10)

plot(eem)
</code></pre>

<hr>
<h2 id='eem_set_wavelengths'>Set Excitation and/or Emission wavelengths</h2><span id='topic+eem_set_wavelengths'></span>

<h3>Description</h3>

<p>This function allows to manually specify either excitation or emission vector
of wavelengths in EEMs. This function is mostly used with spectrophotometers
such as Shimadzu that do not include excitation wavelengths in fluorescence
files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eem_set_wavelengths(eem, ex, em)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eem_set_wavelengths_+3A_eem">eem</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="eem_set_wavelengths_+3A_ex">ex</code></td>
<td>
<p>A numeric vector of excitation wavelengths.</p>
</td></tr>
<tr><td><code id="eem_set_wavelengths_+3A_em">em</code></td>
<td>
<p>A numeric vector of emission wavelengths.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>eemlist</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/shimadzu", package = "eemR")

eem &lt;- eem_read(folder, import_function = "shimadzu")
eem &lt;- eem_set_wavelengths(eem, ex = seq(230, 450, by = 5))

plot(eem)
</code></pre>

<hr>
<h2 id='plot.eemlist'>Surface plot of eem</h2><span id='topic+plot.eemlist'></span>

<h3>Description</h3>

<p>Surface plot of eem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eemlist'
plot(x, which = 1, interactive = FALSE,
  show_peaks = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.eemlist_+3A_x">x</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="plot.eemlist_+3A_which">which</code></td>
<td>
<p>An integer representing the index of eem to be plotted.</p>
</td></tr>
<tr><td><code id="plot.eemlist_+3A_interactive">interactive</code></td>
<td>
<p>If <code>TRUE</code> a Shiny app will start to visualize EEMS.</p>
</td></tr>
<tr><td><code id="plot.eemlist_+3A_show_peaks">show_peaks</code></td>
<td>
<p>Boolean indicating if Cobble's peaks should be displayed on
the surface plot. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.eemlist_+3A_...">...</code></td>
<td>
<p>Extra arguments for <code>image.plot</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/cary/scans_day_1/", package = "eemR")
eem &lt;- eem_read(folder, import_function = "cary")

plot(eem, which = 3)
</code></pre>

<hr>
<h2 id='print.eemlist'>Display summary of an eemlist object</h2><span id='topic+print.eemlist'></span>

<h3>Description</h3>

<p>Display summary of an eemlist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eemlist'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.eemlist_+3A_x">x</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="print.eemlist_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing summarized information on EEMs. </p>

<dl>
<dt>sample</dt><dd><p>Character. Sample name of the EEM,</p>
</dd> <dt>ex_min</dt><dd><p>Numerical.
Minimum excitation wavelength</p>
</dd> <dt>ex_max</dt><dd><p>Numerical. Maximum excitation
wavelength</p>
</dd> <dt>em_min</dt><dd><p>Numerical. Minimum emission wavelength</p>
</dd>
<dt>em_max</dt><dd><p>Numerical. Maximum emission wavelength</p>
</dd>
<dt>is_blank_corrected</dt><dd><p>Logical. TRUE if the sample has been blank
corrected.</p>
</dd> <dt>is_scatter_corrected</dt><dd><p>Logical. TRUE if scattering bands
have been removed from the sample.</p>
</dd> <dt>is_ife_corrected</dt><dd><p>Logical. TRUE
if the sample has been corrected for inner-filter effect.</p>
</dd>
<dt>is_raman_normalized</dt><dd><p>Logical. TRUE if the sample has been Raman
normalized.</p>
</dd> <dt>manufacturer</dt><dd><p>Character. The name of the manufacturer.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/cary", package = "eemR")
eem &lt;- eem_read(folder, recursive = TRUE, import_function = "cary")

print(eem)
</code></pre>

<hr>
<h2 id='summary.eemlist'>Display summary of an eemlist object</h2><span id='topic+summary.eemlist'></span>

<h3>Description</h3>

<p>Display summary of an eemlist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eemlist'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.eemlist_+3A_object">object</code></td>
<td>
<p>An object of class <code>eemlist</code>.</p>
</td></tr>
<tr><td><code id="summary.eemlist_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing summarized information on EEMs. </p>

<dl>
<dt>sample</dt><dd><p>Character. Sample name of the EEM,</p>
</dd> <dt>ex_min</dt><dd><p>Numerical.
Minimum excitation wavelength</p>
</dd> <dt>ex_max</dt><dd><p>Numerical. Maximum excitation
wavelength</p>
</dd> <dt>em_min</dt><dd><p>Numerical. Minimum emission wavelength</p>
</dd>
<dt>em_max</dt><dd><p>Numerical. Maximum emission wavelength</p>
</dd>
<dt>is_blank_corrected</dt><dd><p>Logical. TRUE if the sample has been blank
corrected.</p>
</dd> <dt>is_scatter_corrected</dt><dd><p>Logical. TRUE if scattering bands
have been removed from the sample.</p>
</dd> <dt>is_ife_corrected</dt><dd><p>Logical. TRUE
if the sample has been corrected for inner-filter effect.</p>
</dd>
<dt>is_raman_normalized</dt><dd><p>Logical. TRUE if the sample has been Raman
normalized.</p>
</dd> <dt>manufacturer</dt><dd><p>Character. The name of the manufacturer.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata/cary", package = "eemR")
eem &lt;- eem_read(folder, recursive = TRUE, import_function = "cary")

summary(eem)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
