<!DOCTYPE html><html lang="en"><head><title>Help for package extrememix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {extrememix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_convergence'><p>Convergence Assessment of MCMC Algorithms</p></a></li>
<li><a href='#DIC'><p>Deviance Information Criterion</p></a></li>
<li><a href='#ES'><p>Expected Shortfall</p></a></li>
<li><a href='#fggpd'><p>GGPD Estimation</p></a></li>
<li><a href='#fmgpd'><p>MGPD Estimation</p></a></li>
<li><a href='#ggpd'><p>The GGPD distribution</p></a></li>
<li><a href='#logLik.evmm'><p>Log-likelihood Method</p></a></li>
<li><a href='#mgamma'><p>The Gamma Mixture Distribution</p></a></li>
<li><a href='#mgpd'><p>The MGPD distribution</p></a></li>
<li><a href='#plot_summaries'><p>Plot Methods for Summaries</p></a></li>
<li><a href='#plot.evmm'><p>Plot of Extreme Value Mixture Models</p></a></li>
<li><a href='#plot.upper_bound'><p>Plot Upper Bounds</p></a></li>
<li><a href='#pred'><p>Predictive Distribution</p></a></li>
<li><a href='#print'><p>Printing Methods</p></a></li>
<li><a href='#quant'><p>Estimated Quantiles</p></a></li>
<li><a href='#rainfall'><p>Monthly Maxima Daily Rainfall in Madrid</p></a></li>
<li><a href='#rainfall_ggpd'><p>Rainfall FGGPD Output</p></a></li>
<li><a href='#rainfall_mgpd'><p>Rainfall FMGPD Output</p></a></li>
<li><a href='#return_level'><p>Return Levels</p></a></li>
<li><a href='#summary.evmm'><p>Summary Method</p></a></li>
<li><a href='#upper_bound'><p>Upper Bound</p></a></li>
<li><a href='#VaR'><p>Value-at-Risk</p></a></li>
<li><a href='#WAIC'><p>Widely Applicable Information Criteria</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Estimation of Extreme Value Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits extreme value mixture models, which are models for tails not requiring selection of a threshold, for continuous data. It includes functions for model comparison, estimation of quantity of interest in extreme value analysis and plotting. Reference: CN Behrens, HF Lopes, D Gamerman (2004) &lt;<a href="https://doi.org/10.1191%2F1471082X04st075oa">doi:10.1191/1471082X04st075oa</a>&gt;. FF do Nascimento, D. Gamerman, HF Lopes &lt;<a href="https://doi.org/10.1007%2Fs11222-011-9270-z">doi:10.1007/s11222-011-9270-z</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/manueleleonelli/extrememix">https://github.com/manueleleonelli/extrememix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/manueleleonelli/extrememix/issues">https://github.com/manueleleonelli/extrememix/issues</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppProgress</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, ggplot2, gridExtra, mixtools, Rcpp, RcppProgress, stats,
threshr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-03 22:53:22 UTC; manueleleonelli</td>
</tr>
<tr>
<td>Author:</td>
<td>Manuele Leonelli <a href="https://orcid.org/0000-0002-2562-5192"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manuele Leonelli &lt;manuele.leonelli@ie.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-04 10:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_convergence'>Convergence Assessment of MCMC Algorithms</h2><span id='topic+check_convergence'></span><span id='topic+check_convergence.evmm'></span>

<h3>Description</h3>

<p>Plot of the traceplot and autocorrelation function for the 0.99 quantile from the posterior sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_convergence(x, ...)

## S3 method for class 'evmm'
check_convergence(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_convergence_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="check_convergence_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots to check if the estimation with <code>fggpd</code> and <code>mgpd</code> converged: traceplot and autocorrelation plot for the 99th quantile of the posterior density.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_convergence(rainfall_ggpd)
</code></pre>

<hr>
<h2 id='DIC'>Deviance Information Criterion</h2><span id='topic+DIC'></span><span id='topic+DIC.evmm'></span>

<h3>Description</h3>

<p>Computation of the DIC for an extreme value mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DIC(x, ...)

## S3 method for class 'evmm'
DIC(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DIC_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code></p>
</td></tr>
<tr><td><code id="DIC_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">y</code> denote a dataset and <code class="reqn">p(y|\theta)</code> the likelihood of a parametric model with parameter <code class="reqn">\theta</code>. The deviance is defined as <code class="reqn">D(\theta)= -2\log p(y|\theta)</code>. The deviance information criterion (DIC) is defined as </p>
<p style="text-align: center;"><code class="reqn">DIC = D(\hat\theta) + 2p_D,</code>
</p>
<p> where <code class="reqn">\hat\theta</code> is the posterior estimate of <code class="reqn">\theta</code> and <code class="reqn">p_D</code> is referred to as the effective number of parameters and defined as </p>
<p style="text-align: center;"><code class="reqn">E_{\theta|y}(D(\theta)) - D(\hat\theta).</code>
</p>
<p> Models with a smaller DIC are favored.
</p>


<h3>Value</h3>

<p>The DIC of a model estimated with <code>extrememix</code>
</p>


<h3>References</h3>

<p>Spiegelhalter, David J., et al. &quot;Bayesian measures of model complexity and fit.&quot; Journal of the Royal Statistical Society: Series B 64.4 (2002): 583-639.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WAIC">WAIC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DIC(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='ES'>Expected Shortfall</h2><span id='topic+ES'></span><span id='topic+ES.evmm'></span>

<h3>Description</h3>

<p>Computation of the expected shortfall for an extreme value mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ES(x, ...)

## S3 method for class 'evmm'
ES(x, values = NULL, cred = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ES_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="ES_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="ES_+3A_values">values</code></td>
<td>
<p>numeric vector of values of which to compute the expected shortfall.</p>
</td></tr>
<tr><td><code id="ES_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expected shortfall is the expectation of a random variable conditional of being larger of a specific Value-at-Risk (quantile). For an extreme value mixture model this is equal to: </p>
<p style="text-align: center;"><code class="reqn">ES_p = \frac{VaR_p}{1-\xi} +\frac{\sigma-\xi u }{1-\xi}</code>
</p>



<h3>Value</h3>

<p>A list with the following entries: </p>

<ul>
<li> <p><code>quantiles</code>: a matrix containing the estimated shortfall, the posterior credibility intervals and the empirical estimate.
</p>
</li>
<li> <p><code>data</code>: the dataset used to estimate the expected shortfall.
</p>
</li>
<li> <p><code>complete</code>: a matrix with the expected shortfall for each value in the posterior sample.
</p>
</li></ul>



<h3>References</h3>

<p>Lattanzi, Chiara, and Manuele Leonelli. &quot;A changepoint approach for the identification of financial extreme regimes.&quot; Brazilian Journal of Probability and Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+quant">quant</a></code>, <code><a href="#topic+return_level">return_level</a></code>, <code><a href="#topic+VaR">VaR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ES(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='fggpd'>GGPD Estimation</h2><span id='topic+fggpd'></span>

<h3>Description</h3>

<p>Fit of the GGPD model using an MCMC algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fggpd(x, it, start = NULL, var = NULL, prior = NULL, thin = 1, burn = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fggpd_+3A_x">x</code></td>
<td>
<p>A vector of positive observations.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_it">it</code></td>
<td>
<p>Number of iterations of the algorithm.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_start">start</code></td>
<td>
<p>A list of starting parameter values.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_var">var</code></td>
<td>
<p>A list of starting proposal variances.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_prior">prior</code></td>
<td>
<p>A list of hyperparameters for the prior distribution.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_thin">thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="fggpd_+3A_burn">burn</code></td>
<td>
<p>Burn-in length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the GGPD is carried out using an adaptive block Metropolis-Hastings algorithm. As standard, the user needs to specify the data to use during estimation, the number of iterations of the algorithm, the burn-in period (by default equal to zero) and the thinning interval (by default equal to one).
To run the algorithm it is also needed the choice of the starting values, the starting values of the proposal variances, and the parameters of the prior distribution. If not provided, these are automatically set as follows:
</p>

<ul>
<li> <p><em>starting values</em>: <code class="reqn">u</code> is chosen by the function <code>ithresh</code> of the <code>threshr</code> package; <code class="reqn">\xi</code> and <code class="reqn">\sigma</code> are chosen by the <code>fpot</code> function of <code>evd</code> for data over the threshold; <code class="reqn">\mu</code> and <code class="reqn">\eta</code> are chosen as the maximum likelihood estimate of the Gamma distribution over data below the threshold.
</p>
</li>
<li> <p><em>variances</em>: variances are chosen as the standard deviation of the normal distribution whose 0.01 quantile is equal to 0.9 times the starting value of the associated parameter.
</p>
</li>
<li> <p><em>prior distributions</em>: the prior distribution for <code class="reqn">\xi</code> and <code class="reqn">\sigma</code> is the objective prior </p>
<p style="text-align: center;"><code class="reqn">p(\xi,\sigma) = \sigma^{-1}(1+\xi)^{-1}(1+2\xi)^{-1/2}.</code>
</p>
<p> The prior for the threshold <code class="reqn">u</code> is Normal with mean chosen as for the starting values and the standard deviation is chosen so that the 0.05 quantile of the prior is equal to the median of the data. The priors for the parameters <code class="reqn">\mu</code> and <code class="reqn">\eta</code> are Gammas with mean chosen as for the starting values and shapes equal to 0.001 so to give high prior variances.
</p>
</li></ul>

<p>The user can also select any of the three inputs above. </p>

<ul>
<li><p> The starting values <code>start</code> must be a list with entries <code>xi</code>, <code>sigma</code>, <code>u</code>, <code>mu</code>, <code>eta</code>.
</p>
</li>
<li><p> The variances <code>var</code> must be a list with entries <code>xi</code>, <code>sigma</code>, <code>u</code>, <code>mu</code>, <code>eta</code>.
</p>
</li>
<li><p> The prior <code>prior</code> must be a list with entries <code>u</code>, <code>mu</code>, <code>eta</code> all containing a vector of length two (for <code>u</code> giving the mean and the standard deviation of the Normal prior, for <code>mu</code> and <code>eta</code> giving the mean and shape of the Gamma prior).</p>
</li></ul>



<h3>Value</h3>

<p><code>fggpd</code> returns a list with three elements: </p>

<ul>
<li> <p><code>chain</code>: a matrix of size (<code>it</code> - <code>burn</code>)/<code>thin</code><code class="reqn">\times</code>5, reporting in each column the posterior sample for each parameter.
</p>
</li>
<li> <p><code>var</code>: a matrix of size <code>it</code><code class="reqn">\times</code>5 reporting the variance of the proposal distribution for each parameter.
</p>
</li>
<li> <p><code>data</code>: the dataset used for estimation.
</p>
</li></ul>



<h3>References</h3>

<p>Behrens, Cibele N., Hedibert F. Lopes, and Dani Gamerman. &quot;Bayesian analysis of extreme events with threshold estimation.&quot; Statistical Modelling 4.3 (2004): 227-244.
</p>
<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggpd">ggpd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Small number of iterations and burn-in for quick execution
data(rainfall)
model1 &lt;- fggpd(rainfall, it = 250, burn = 50, thin = 25)

start &lt;- list(xi = 0.2, sigma = 2, u = 10, mu = 5, eta = 2)
var &lt;- list(xi = 0.01, sigma = 1, u = 3, mu = 3, eta = 1)
prior &lt;- list(u = c(22,5), mu = c(4,16), eta = c(0.001,0.001))
model2 &lt;- fggpd(rainfall,it = 250, start = start, var =var, prior = prior)


</code></pre>

<hr>
<h2 id='fmgpd'>MGPD Estimation</h2><span id='topic+fmgpd'></span>

<h3>Description</h3>

<p>Fit of the MGPD model using an MCMC algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmgpd(x, it, k, start = NULL, var = NULL, prior = NULL, thin = 1, burn = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fmgpd_+3A_x">x</code></td>
<td>
<p>A vector of positive observations.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_it">it</code></td>
<td>
<p>Number of iterations of the algorithm.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_k">k</code></td>
<td>
<p>number of mixture components for the bulk. Must be either 2, 3, or 4.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_start">start</code></td>
<td>
<p>A list of starting parameter values.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_var">var</code></td>
<td>
<p>A list of starting proposal variance.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_prior">prior</code></td>
<td>
<p>A list of hyperparameters for the prior distribution.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_thin">thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="fmgpd_+3A_burn">burn</code></td>
<td>
<p>Burn-in.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the MGPD is carried out using an adaptive block Metropolis-Hastings algorithm. As standard, the user needs to specify the data to use during estimation, the number of mixture components for the bulk, the number of iterations of the algorithm, the burn-in period (by default equal to zero) and the thinning interval (by default equal to one).
To run the algorithm it is also needed the choice of the starting values, the starting values of the proposal variances, and the parameters of the prior distribution. If not provided, these are automatically set as follows:
</p>

<ul>
<li> <p><em>starting values</em>: <code class="reqn">u</code> is chosen by the function <code>ithresh</code> of the <code>threshr</code> package; <code class="reqn">\xi</code> and <code class="reqn">\sigma</code> are chosen by the <code>fpot</code> function of <code>evd</code> for data over the threshold; <code class="reqn">\mu</code> and <code class="reqn">\eta</code> are chosen as estimates of the <code>gammamixEM</code> function from the <code>mixtools</code> package; <code class="reqn">w</code> is chosen as the vector with entries <code class="reqn">1/k</code>.
</p>
</li>
<li> <p><em>variances</em>: variances for <code class="reqn">\sigma</code> and <code class="reqn">u</code> are chosen as the standard deviation of the normal distribution whose 0.01 quantile is equal to 0.9 times the starting value of the associated parameter. The parameters <code class="reqn">\mu_i</code> and <code class="reqn">\eta_i</code> are sampled jointly and the proposal variance is chosen using the same method as for <code class="reqn">\sigma</code> with respect to the parameter <code class="reqn">\mu</code>. The proposal variance for <code class="reqn">w</code> is 0.1 and the proposal variance for <code class="reqn">\xi</code> is 0.1 if negative and 0.25 if positive.
</p>
</li>
<li> <p><em>prior distributions</em>: the prior distribution for <code class="reqn">\xi</code> and <code class="reqn">\sigma</code> is the objective prior </p>
<p style="text-align: center;"><code class="reqn">p(\xi,\sigma) = \sigma^{-1}(1+\xi)^{-1}(1+2\xi)^{-1/2}.</code>
</p>
<p> The prior for the threshold <code class="reqn">u</code> is Normal with mean chosen as for the starting values and the standard deviation is chosen so that the 0.05 quantile of the prior is equal to the median of the data. The priors for the parameters <code class="reqn">\mu_i</code> and <code class="reqn">\eta_i</code> are Gammas with mean chosen as for the starting values and shapes equal to 0.001 so to give high prior variances. The prior for the weigths is the non-informative Dirichlet with parameter 1.
</p>
</li></ul>

<p>The user can also select any of the three inputs above. </p>

<ul>
<li><p> The starting values <code>start</code> must be a list with entries <code>xi</code>, <code>sigma</code>, <code>u</code>, <code>mu</code>, <code>eta</code> and <code>w</code>. The length of  <code>mu</code>, <code>eta</code> and <code>w</code> must be <code>k</code>.
</p>
</li>
<li><p> The variances <code>var</code> must be a list with entries <code>xi</code>, <code>sigma</code>, <code>u</code>, <code>mu</code> and  <code>w</code>. The length of <code>mu</code> must be <code>k</code>.
</p>
</li>
<li><p> The prior <code>prior</code> must be a list with entries <code>u</code>, <code>mu_mu</code>, <code>mu_eta</code>, <code>eta_mu</code> and <code>eta_eta</code>.  <code>u</code> gives the mean and the standard deviation of the Normal prior for <code class="reqn">u</code>. The vectors of length <code>k</code>, <code>mu_mu</code> and <code>eta_mu</code> give the prior means of <code class="reqn">\mu</code> and <code class="reqn">\eta</code>, whilst <code>mu_eta</code> and <code>eta_eta</code> give their prior shapes.</p>
</li></ul>



<h3>Value</h3>

<p><code>fmgpd</code> returns a list with three elements: </p>

<ul>
<li> <p><code>chain</code>: a matrix of size (<code>it</code> - <code>burn</code>)/<code>thin</code><code class="reqn">\times</code>5, reporting in each column the posterior sample for each parameter.
</p>
</li>
<li> <p><code>var</code>: a matrix of size <code>it</code><code class="reqn">\times</code>5 reporting the variance of the proposal distribution for each parameter.
</p>
</li>
<li> <p><code>data</code>: the dataset used for estimation.
</p>
</li></ul>



<h3>References</h3>

<p>Behrens, Cibele N., Hedibert F. Lopes, and Dani Gamerman. &quot;Bayesian analysis of extreme events with threshold estimation.&quot; Statistical Modelling 4.3 (2004): 227-244.
</p>
<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fggpd">fggpd</a></code>, <code><a href="#topic+mgpd">mgpd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(rainfall)
## Small number of iterations and burn-in for quick execution
model1 &lt;- fmgpd(rainfall, k = 2, it = 250, burn = 50, thin = 25)
start &lt;- list(xi = 0.2, sigma = 2, u = 10, mu = c(2,5), eta = c(2,2) , w = c(0.4,0.6))
var &lt;- list(xi = 0.01, sigma = 1, u = 3, mu = c(3,3), w = 0.01)
prior &lt;- list(u = c(22,5), mu_mu = c(2,5), mu_eta = c(0.01,0.01),
         eta_mu = c(3,3),eta_eta = c(0.01,0.01))

model2 &lt;- fmgpd(rainfall, k= 2, it = 250, start = start, var =var, prior = prior)


</code></pre>

<hr>
<h2 id='ggpd'>The GGPD distribution</h2><span id='topic+ggpd'></span><span id='topic+dggpd'></span><span id='topic+pggpd'></span><span id='topic+qggpd'></span><span id='topic+rggpd'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the GGPD distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dggpd(x, xi, sigma, u, mu, eta, log = FALSE)

pggpd(q, xi, sigma, u, mu, eta, lower.tail = TRUE)

qggpd(p, xi, sigma, u, mu, eta, lower.tail = TRUE)

rggpd(N, xi, sigma, u, mu, eta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggpd_+3A_x">x</code>, <code id="ggpd_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="ggpd_+3A_xi">xi</code></td>
<td>
<p>shape parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_u">u</code></td>
<td>
<p>threshold parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_mu">mu</code></td>
<td>
<p>mean of the gamma bulk (scalar).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_eta">eta</code></td>
<td>
<p>shape of the gamma bulk (scalar).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_log">log</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="ggpd_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P(X\leq x)</code> otherwise <code class="reqn">P(X&gt;x)</code>.</p>
</td></tr>
<tr><td><code id="ggpd_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="ggpd_+3A_n">N</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The GGPD distribution is an extreme value mixture model with density
</p>
<p style="text-align: center;"><code class="reqn">f_{GGPD}(x|\xi,\sigma,u,\mu,\eta,w)=\left\{\begin{array}{ll} f_{GA}(x|\mu,\eta), &amp; x\leq u \\ (1-F_{GA}(u|\mu,\eta))f_{GPD}(x|\xi,\sigma,u), &amp;\mbox{otherwise},  \end{array}\right.</code>
</p>
<p> where <code class="reqn">f_{GA}</code> is the density of the Gamma parametrized by mean <code class="reqn">\mu</code> and shape <code class="reqn">\eta</code>, <code class="reqn">F_{GA}</code> is the distribution function of the Gamma and <code class="reqn">f_{GPD}</code> is the density of the Generalized Pareto Distribution, i.e.
</p>
<p style="text-align: center;"><code class="reqn">f_{GPD}(x|\xi,\sigma,u)=\left\{\begin{array}{ll} 1- (1+\frac{\xi}{\sigma}(x-u))^{-1/\xi}, &amp; \mbox{if } \xi\neq 0,\\ 1- \exp\left(-\frac{x-u}{\sigma}\right), &amp; \mbox{if } \xi = 0, \end{array}\right.</code>
</p>

<p>where <code class="reqn">\xi</code> is a shape parameter, <code class="reqn">\sigma &gt; 0</code> is a scale parameter and <code class="reqn">u&gt;0</code> is a threshold.
</p>
<p><code>dggpd</code> gives the density, <code>pggpd</code> gives the distribution function, <code>qggpd</code> gives the quantile function, and <code>rggpd</code> generates random deviates. The length of the result is determined by <code>N</code> for <code>rggpd</code> and by the length of <code>x</code>, <code>q</code> or <code>p</code> otherwise.
</p>


<h3>References</h3>

<p>Behrens, Cibele N., Hedibert F. Lopes, and Dani Gamerman. &quot;Bayesian analysis of extreme events with threshold estimation.&quot; Statistical Modelling 4.3 (2004): 227-244.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dggpd(3, xi = 0.5, sigma = 2, u = 5, mu = 3, eta = 3)


</code></pre>

<hr>
<h2 id='logLik.evmm'>Log-likelihood Method</h2><span id='topic+logLik.evmm'></span>

<h3>Description</h3>

<p>Computation of the log-likelihood of an extreme value mixture model (thus also <code>AIC</code> and <code>BIC</code> are available).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmm'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.evmm_+3A_object">object</code></td>
<td>
<p>an object of class <code>evmm</code>.</p>
</td></tr>
<tr><td><code id="logLik.evmm_+3A_...">...</code></td>
<td>
<p>additional parameters for compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log-likelihood of a model estimated with <code>extrememix</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logLik(rainfall_ggpd)
</code></pre>

<hr>
<h2 id='mgamma'>The Gamma Mixture Distribution</h2><span id='topic+mgamma'></span><span id='topic+dmgamma'></span><span id='topic+pmgamma'></span><span id='topic+qmgamma'></span><span id='topic+rmgamma'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the mixture of Gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmgamma(x, mu, eta, w, log = FALSE)

pmgamma(q, mu, eta, w, lower.tail = TRUE)

qmgamma(p, mu, eta, w, lower.tail = TRUE)

rmgamma(N, mu, eta, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgamma_+3A_x">x</code>, <code id="mgamma_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="mgamma_+3A_mu">mu</code></td>
<td>
<p>means of the gamma mixture components (vector).</p>
</td></tr>
<tr><td><code id="mgamma_+3A_eta">eta</code></td>
<td>
<p>shapes of the gamma mixture components (vector).</p>
</td></tr>
<tr><td><code id="mgamma_+3A_w">w</code></td>
<td>
<p>weights of the gamma mixture components (vector). Must sum to one.</p>
</td></tr>
<tr><td><code id="mgamma_+3A_log">log</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="mgamma_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P(X\leq x)</code> otherwise <code class="reqn">P(X&gt;x)</code>.</p>
</td></tr>
<tr><td><code id="mgamma_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="mgamma_+3A_n">N</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Gamma distribution has density </p>
<p style="text-align: center;"><code class="reqn">f_{GA}(x|\mu,\eta)= \frac{(\eta/\mu)^\eta}{\Gamma(\eta)}x^{\eta-1}\exp(-(\eta/\mu)x), \hspace{1cm} x&gt;0,</code>
</p>
<p> where <code class="reqn">\mu&gt;0</code> is the mean of the distribution and <code class="reqn">\eta&gt;0</code> is its shape.
The density of a mixture of Gamma distributions with <code class="reqn">k</code> components is defined as  </p>
<p style="text-align: center;"><code class="reqn">f_{MG}(x|\mu,\eta,w)=\sum_{i=1}^k w_if_{GA}(x|\mu_i,\eta_i),</code>
</p>
<p> where <code class="reqn">w_i,\mu_i,\eta_i &gt;0</code>, for <code class="reqn">i=1,\dots,k</code>, <code class="reqn">w_1+\cdots+w_k=1</code>, <code class="reqn">\mu=(\mu_1,\dots,\mu_k)</code>, <code class="reqn">\eta = (\eta_1,\dots,\eta_k)</code> and <code class="reqn">w=(w_1,\dots,w_k)</code>.
</p>


<h3>Value</h3>

<p><code>dmgamma</code> gives the density, <code>pmgamma</code> gives the distribution function, <code>qmgamma</code> gives the quantile function, and <code>rmgamma</code> generates random deviates.
</p>
<p>The length of the result is determined by <code>N</code> for <code>rmgamma</code> and by the length of <code>x</code>, <code>q</code> or <code>p</code> otherwise.
</p>


<h3>References</h3>

<p>Wiper, Michael, David Rios Insua, and Fabrizio Ruggeri. &quot;Mixtures of gamma distributions with applications.&quot; Journal of Computational and Graphical Statistics 10.3 (2001): 440-454.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dmgamma(3, mu = c(2,3), eta = c(1,2), w = c(0.3,0.7))

</code></pre>

<hr>
<h2 id='mgpd'>The MGPD distribution</h2><span id='topic+mgpd'></span><span id='topic+dmgpd'></span><span id='topic+pmgpd'></span><span id='topic+qmgpd'></span><span id='topic+rmgpd'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the MGPD distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmgpd(x, xi, sigma, u, mu, eta, w, log = FALSE)

pmgpd(q, xi, sigma, u, mu, eta, w, lower.tail = TRUE)

qmgpd(p, xi, sigma, u, mu, eta, w, lower.tail = TRUE)

rmgpd(N, xi, sigma, u, mu, eta, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgpd_+3A_x">x</code>, <code id="mgpd_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="mgpd_+3A_xi">xi</code></td>
<td>
<p>shape parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_u">u</code></td>
<td>
<p>threshold parameter of the tail GPD (scalar).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_mu">mu</code></td>
<td>
<p>means of the gamma mixture components (vector).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_eta">eta</code></td>
<td>
<p>shapes of the gamma mixture components (vector).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_w">w</code></td>
<td>
<p>weights of the gamma mixture components (vector). Must sum to one.</p>
</td></tr>
<tr><td><code id="mgpd_+3A_log">log</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="mgpd_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P(X\leq x)</code> otherwise <code class="reqn">P(X&gt;x)</code>.</p>
</td></tr>
<tr><td><code id="mgpd_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="mgpd_+3A_n">N</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MGPD distribution is an extreme value mixture model with density
</p>
<p style="text-align: center;"><code class="reqn">f_{MGPD}(x|\xi,\sigma,u,\mu,\eta,w)=\left\{\begin{array}{ll} f_{MG}(x|\mu,\eta,w), &amp; x\leq u \\ (1-F_{MG}(u|\mu,\eta,w))f_{GPD}(x|\xi,\sigma,u), &amp;\mbox{otherwise},  \end{array}\right.</code>
</p>
<p> where <code class="reqn">f_{MG}</code> is the density of the mixture of Gammas, <code class="reqn">F_{MG}</code> is the distribution function of the mixture of Gammas and <code class="reqn">f_{GPD}</code> is the density of the Generalized Pareto Distribution, i.e.
</p>
<p style="text-align: center;"><code class="reqn">f_{GPD}(x|\xi,\sigma,u)=\left\{\begin{array}{ll} 1- (1+\frac{\xi}{\sigma}(x-u))^{-1/\xi}, &amp; \mbox{if } \xi\neq 0,\\ 1- \exp\left(-\frac{x-u}{\sigma}\right), &amp; \mbox{if } \xi = 0, \end{array}\right.</code>
</p>

<p>where <code class="reqn">\xi</code> is a shape parameter, <code class="reqn">\sigma &gt; 0</code> is a scale parameter and <code class="reqn">u&gt;0</code> is a threshold.
</p>


<h3>Value</h3>

<p><code>dmgpd</code> gives the density, <code>pmgpd</code> gives the distribution function, <code>qmgpd</code> gives the quantile function, and <code>rmgpd</code> generates random deviates. The length of the result is determined by <code>N</code> for <code>rmgpd</code> and by the length of <code>x</code>, <code>q</code> or <code>p</code> otherwise.
</p>


<h3>References</h3>

<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dmgpd(3, xi = 0.5, sigma = 2,5, u = 5, mu = c(2,3), eta = c(1,2), w = c(0.3,0.7))

</code></pre>

<hr>
<h2 id='plot_summaries'>Plot Methods for Summaries</h2><span id='topic+plot_summaries'></span><span id='topic+plot.quant'></span><span id='topic+plot.return_level'></span><span id='topic+plot.VaR'></span><span id='topic+plot.ES'></span>

<h3>Description</h3>

<p>Plotting methods for objects created with <code>quant</code>, <code>ES</code>, <code>return_level</code> or <code>VaR</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'quant'
plot(x, ylim = NULL, ...)

## S3 method for class 'return_level'
plot(x, ylim = NULL, ...)

## S3 method for class 'VaR'
plot(x, ylim = NULL, ...)

## S3 method for class 'ES'
plot(x, ylim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_summaries_+3A_x">x</code></td>
<td>
<p>an object of class <code>quant</code>, <code>ES</code>, <code>return_level</code> or <code>VaR</code>.</p>
</td></tr>
<tr><td><code id="plot_summaries_+3A_ylim">ylim</code></td>
<td>
<p>limits of the y-axis.</p>
</td></tr>
<tr><td><code id="plot_summaries_+3A_...">...</code></td>
<td>
<p>additional parameters  for compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two types of plot can be output: either a line plot in the case the functions <code>quant</code>, <code>ES</code>, <code>return_level</code> or <code>VaR</code> where called with more than one value for the input <code>values</code>, or an histogram otherwise.
</p>


<h3>Value</h3>

<p>Appropriate plots for quantities computed with <code>extrememix</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(return_level(rainfall_ggpd)) ## for line plot
plot(return_level(rainfall_ggpd, values = 100)) ## for histogram


</code></pre>

<hr>
<h2 id='plot.evmm'>Plot of Extreme Value Mixture Models</h2><span id='topic+plot.evmm'></span>

<h3>Description</h3>

<p>Plotting method for objects of class <code>evmm</code> giving an overview of an estimated model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.evmm_+3A_x">x</code></td>
<td>
<p>an object of class <code>evmm</code>.</p>
</td></tr>
<tr><td><code id="plot.evmm_+3A_...">...</code></td>
<td>
<p>additional parameters for compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> method for objects of class <code>evmm</code> reports four plots: </p>

<ul>
<li><p> An histogram of the posterior distribution of xi.
</p>
</li>
<li><p> An histogram of the posterior distribution of sigma.
</p>
</li>
<li><p> A line plot of the estimated quantiles, their posterior credibility interval, and the empirical ones.
</p>
</li>
<li><p> A plot of the predictive distribution together with the data histogram.
</p>
</li></ul>



<h3>Value</h3>

<p>Plots of a model estimated with <code>extrememix</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='plot.upper_bound'>Plot Upper Bounds</h2><span id='topic+plot.upper_bound'></span>

<h3>Description</h3>

<p>Plotting method for the posterior distribution of the upper bound. No plot is reported if the posterior sample of xi has only positive values (unbounded distribution).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'upper_bound'
plot(x, xlim = c(min(x$bound), max(x$bound)), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.upper_bound_+3A_x">x</code></td>
<td>
<p>an object of class <code>upper_bound</code>.</p>
</td></tr>
<tr><td><code id="plot.upper_bound_+3A_xlim">xlim</code></td>
<td>
<p>limits of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.upper_bound_+3A_...">...</code></td>
<td>
<p>additional parameters for compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A histogram for the posterior estimated upper bound of the distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(upper_bound(rainfall_ggpd))

</code></pre>

<hr>
<h2 id='pred'>Predictive Distribution</h2><span id='topic+pred'></span><span id='topic+pred.evmm'></span>

<h3>Description</h3>

<p>Plot of the predictive distribution of an extreme value mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred(x, ...)

## S3 method for class 'evmm'
pred(
  x,
  x_axis = seq(min(x$data), max(x$data), length.out = 1000),
  cred = 0.95,
  xlim = c(min(x$data), max(x$data)),
  ylim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="pred_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="pred_+3A_x_axis">x_axis</code></td>
<td>
<p>vector of points where to estimate the predictive distribution.</p>
</td></tr>
<tr><td><code id="pred_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
<tr><td><code id="pred_+3A_xlim">xlim</code></td>
<td>
<p>limits of the x-axis.</p>
</td></tr>
<tr><td><code id="pred_+3A_ylim">ylim</code></td>
<td>
<p>limits of the y-axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider an extreme value mixture model <code class="reqn">f(y|\theta)</code> and suppose a sample <code class="reqn">(\theta^{(1)},\dots,\theta^{(S)})</code> from the posterior distribution is available. The predictive distribution at the point <code class="reqn">y</code> is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{S}\sum_{s=1}^Sf(y|\theta^{(s)})</code>
</p>



<h3>Value</h3>

<p>A plot of the estimate of the predictive distribution together with the data histogram.
</p>


<h3>References</h3>

<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pred(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='print'>Printing Methods</h2><span id='topic+print'></span><span id='topic+print.evmm'></span><span id='topic+print.summary.ggpd'></span><span id='topic+print.quantile'></span><span id='topic+print.return_level'></span><span id='topic+print.VaR'></span><span id='topic+print.ES'></span><span id='topic+print.upper_bound'></span>

<h3>Description</h3>

<p>Collection of printing methods for various objects created by <code>extrememix</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmm'
print(x, ...)

## S3 method for class 'summary.ggpd'
print(x, ...)

## S3 method for class 'quantile'
print(x, ...)

## S3 method for class 'return_level'
print(x, ...)

## S3 method for class 'VaR'
print(x, ...)

## S3 method for class 'ES'
print(x, ...)

## S3 method for class 'upper_bound'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>an object created by <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A printed output of a model estimated with <code>extrememix</code>.
</p>

<hr>
<h2 id='quant'>Estimated Quantiles</h2><span id='topic+quant'></span><span id='topic+quant.evmm'></span>

<h3>Description</h3>

<p>Computation of posterior quantiles for an extreme value mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quant(x, ...)

## S3 method for class 'evmm'
quant(x, values = NULL, cred = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quant_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="quant_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="quant_+3A_values">values</code></td>
<td>
<p>numeric vector of values of which to compute the quantile.</p>
</td></tr>
<tr><td><code id="quant_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a random variable <code class="reqn">X</code> the p-quantile is the value <code class="reqn">x</code> such that <code class="reqn">P(X&gt;x)=1-p</code>. For an extreme value mixture model this can be computed as
</p>
<p style="text-align: center;"><code class="reqn">x = u +\frac{\sigma}{\xi}((1-p^*)^{-\xi}-1),</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">p^* = \frac{p-F_\textnormal{bulk}(u|\theta)}{1-F_\textnormal{bulk}(u|\theta)},</code>
</p>

<p>and <code class="reqn">F_\textnormal{bulk}</code> is the distribution function of the bulk, parametrized by <code class="reqn">\theta</code>.
</p>


<h3>Value</h3>

<p>A list with the following entries: </p>

<ul>
<li> <p><code>quantiles</code>: a matrix containing the quantiles, the posterior credibility intervals and the empirical estimate.
</p>
</li>
<li> <p><code>data</code>: the dataset used to estimate the quantiles.
</p>
</li>
<li> <p><code>complete</code>: a matrix with the quantiles for each value in the posterior sample.
</p>
</li></ul>



<h3>References</h3>

<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quant(rainfall_ggpd)


</code></pre>

<hr>
<h2 id='rainfall'>Monthly Maxima Daily Rainfall in Madrid</h2><span id='topic+rainfall'></span>

<h3>Description</h3>

<p>Monthly maxima of the daily rainfall (measured in mms) recorded at the Retiro station in the city centre of Madrid, Spain, between 1985 and 2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rainfall)
</code></pre>


<h3>Format</h3>

<p>A  positive numeric vector of length 414. Observations where the monthly maxima are zero were discarded.
</p>


<h3>Source</h3>

<p>Instituto de Estadistica, Communidad de Madrid.
</p>

<hr>
<h2 id='rainfall_ggpd'>Rainfall FGGPD Output</h2><span id='topic+rainfall_ggpd'></span>

<h3>Description</h3>

<p>Estimated ggpd model over the rainfall dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rainfall_ggpd)
</code></pre>


<h3>Format</h3>

<p>A list storing the output of the fggpd function over the rainfall dataset.
</p>

<hr>
<h2 id='rainfall_mgpd'>Rainfall FMGPD Output</h2><span id='topic+rainfall_mgpd'></span>

<h3>Description</h3>

<p>Estimated mgpd model over the rainfall dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rainfall_mgpd)
</code></pre>


<h3>Format</h3>

<p>A list storing the output of the fmgpd function over the rainfall dataset.
</p>

<hr>
<h2 id='return_level'>Return Levels</h2><span id='topic+return_level'></span><span id='topic+return_level.evmm'></span>

<h3>Description</h3>

<p>Computation of the return levels  for an extreme value mixture model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>return_level(x, ...)

## S3 method for class 'evmm'
return_level(x, values = NULL, cred = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="return_level_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code></p>
</td></tr>
<tr><td><code id="return_level_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="return_level_+3A_values">values</code></td>
<td>
<p>numeric vector of values of which to compute the value at risk.</p>
</td></tr>
<tr><td><code id="return_level_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A return level at <code class="reqn">T</code> units of time is defined as the <code class="reqn">1-1/T</code> quantile.
</p>


<h3>Value</h3>

<p>A list with the following entries: </p>

<ul>
<li> <p><code>quantiles</code>: a matrix containing the estimated return levels, the posterior credibility intervals and the empirical estimate.
</p>
</li>
<li> <p><code>data</code>: the dataset used to estimate the return levels.
</p>
</li>
<li> <p><code>complete</code>: a matrix with the return levels for each value in the posterior sample.
</p>
</li></ul>



<h3>References</h3>

<p>do Nascimento, Fernando Ferraz, Dani Gamerman, and Hedibert Freitas Lopes. &quot;A semiparametric Bayesian approach to extreme value estimation.&quot; Statistics and Computing 22.2 (2012): 661-675.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ES">ES</a></code>, <code><a href="#topic+quant">quant</a></code>, <code><a href="#topic+VaR">VaR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>return_level(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='summary.evmm'>Summary Method</h2><span id='topic+summary.evmm'></span>

<h3>Description</h3>

<p>Posterior estimates and credibility intervals for the parameters of extreme value mixture models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.evmm_+3A_object">object</code></td>
<td>
<p>an object of class <code>evmm</code>.</p>
</td></tr>
<tr><td><code id="summary.evmm_+3A_...">...</code></td>
<td>
<p>additional parameters (compatibility).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A printed summary of a model estimated with <code>extrememix</code> or any quantity associated with it.
</p>

<hr>
<h2 id='upper_bound'>Upper Bound</h2><span id='topic+upper_bound'></span><span id='topic+upper_bound.evmm'></span>

<h3>Description</h3>

<p>Computation of the upper bound of the distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upper_bound(x, ...)

## S3 method for class 'evmm'
upper_bound(x, cred = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="upper_bound_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="upper_bound_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="upper_bound_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For an extreme value mixture model with a shape parameter <code class="reqn">xi &lt; 0</code> the distribution is right-bounded with upper limit equal to <code class="reqn">u-\sigma/\xi</code>.
</p>


<h3>Value</h3>

<p><code>upper_bound</code> returns a list with entries: </p>

<ul>
<li> <p><code>bound</code>: a sample from the posterior distribution of the upper limit of the model, taken over the posterior values of xi which are negative.
</p>
</li>
<li> <p><code>prob</code>: the posterior probability that the distribution is unbounded.
</p>
</li>
<li> <p><code>cred</code>: the requested amplitude of the posterior credibility intervals.
</p>
</li></ul>



<h3>References</h3>

<p>Coles, Stuart, et al. An introduction to statistical modeling of extreme values. Vol. 208. London: Springer, 2001.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>upper_bound(rainfall_ggpd)

</code></pre>

<hr>
<h2 id='VaR'>Value-at-Risk</h2><span id='topic+VaR'></span><span id='topic+VaR.evmm'></span>

<h3>Description</h3>

<p>Computation of the Value-at-Risk for an extreme value mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VaR(x, ...)

## S3 method for class 'evmm'
VaR(x, values = NULL, cred = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VaR_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code></p>
</td></tr>
<tr><td><code id="VaR_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
<tr><td><code id="VaR_+3A_values">values</code></td>
<td>
<p>numeric vector of values of which to compute the value at risk.</p>
</td></tr>
<tr><td><code id="VaR_+3A_cred">cred</code></td>
<td>
<p>amplitude of the posterior credibility interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Value-at-Risk for level q\
</p>


<h3>Value</h3>

<p>A list with the following entries: </p>

<ul>
<li> <p><code>quantiles</code>: a matrix containing the estimated value at risk, the posterior credibility intervals and the empirical estimate.
</p>
</li>
<li> <p><code>data</code>: the dataset used to estimate the value at risk.
</p>
</li>
<li> <p><code>complete</code>: a matrix with the value at risk for each value in the posterior sample.
</p>
</li></ul>



<h3>References</h3>

<p>Lattanzi, Chiara, and Manuele Leonelli. &quot;A changepoint approach for the identification of financial extreme regimes.&quot; Brazilian Journal of Probability and Statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ES">ES</a></code>, <code><a href="#topic+quant">quant</a></code>, <code><a href="#topic+return_level">return_level</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>VaR(rainfall_ggpd)
</code></pre>

<hr>
<h2 id='WAIC'>Widely Applicable Information Criteria</h2><span id='topic+WAIC'></span><span id='topic+WAIC.evmm'></span>

<h3>Description</h3>

<p>Computation of the WAIC for an extreme value mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WAIC(x, ...)

## S3 method for class 'evmm'
WAIC(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WAIC_+3A_x">x</code></td>
<td>
<p>the output of a model estimated with <code>extrememix</code>.</p>
</td></tr>
<tr><td><code id="WAIC_+3A_...">...</code></td>
<td>
<p>additional arguments for compatibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a dataset <code class="reqn">y=(y_1,\dots,y_n)</code>, <code class="reqn">p(y|\theta)</code> the likelihood of a parametric model with parameter <code class="reqn">\theta</code>, and <code class="reqn">(\theta^{(1)},\dots,\theta^{(S)})</code> a sample from the posterior distribution <code class="reqn">p(\theta|y)</code>.
Define </p>
<p style="text-align: center;"><code class="reqn">\textnormal{llpd} = \sum_{i=1}^n \log\left(\sum_{i=1}^Sp(y_i|\theta^{(s)}\right)</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">p_\textnormal{WAIC} = \sum_{i=1}^n Var_{\theta|y}(\log p(y_i|\theta)).</code>
</p>

<p>Then the Widely Applicable Information Criteria is defined as </p>
<p style="text-align: center;"><code class="reqn">WAIC = -2\textnormal{llpd} + 2p_\textnormal{WAIC}.</code>
</p>
<p> Models with a smaller WAIC are favored.
</p>


<h3>Value</h3>

<p>The WAIC of a model estimated with <code>extrememix</code>
</p>


<h3>References</h3>

<p>Gelman, Andrew, Jessica Hwang, and Aki Vehtari. &quot;Understanding predictive information criteria for Bayesian models.&quot; Statistics and computing 24.6 (2014): 997-1016.
</p>
<p>Watanabe, Sumio. &quot;A widely applicable Bayesian information criterion.&quot; Journal of Machine Learning Research 14.Mar (2013): 867-897.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DIC">DIC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>WAIC(rainfall_ggpd)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
