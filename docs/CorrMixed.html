<!DOCTYPE html><html><head><title>Help for package CorrMixed</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CorrMixed}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Example.Data'>
<p>An example dataset</p></a></li>
<li><a href='#Explore.WS.Corr'>
<p>Explore within-subject correlations (reliabilities)</p></a></li>
<li><a href='#Fract.Poly'><p>Fit fractional polynomials</p></a></li>
<li><a href='#Heatmap'>
<p>Plot a heatmap of the correlation structure</p></a></li>
<li><a href='#Model.Fit'>
<p>Compare the fit of linear mixed-effects models</p></a></li>
<li><a href='#plot Explore.WS.Corr'>
<p>Plot of exploratory within-subject correlations (reliabilities)</p></a></li>
<li><a href='#plot.WS.Corr.Mixed'>
<p>Plot the within-subject correlations (reliabilities) obtained by using the mixed-effects modeling approch</p></a></li>
<li><a href='#Spaghetti.Plot'><p>Make a Spaghetti plot</p></a></li>
<li><a href='#summary'><p>Summary</p></a></li>
<li><a href='#WS.Corr.Mixed'>
<p>Estimate within-subject correlations (reliabilities) based on a mixed-effects model.</p></a></li>
<li><a href='#WS.Corr.Mixed.SAS'>
<p>Estimate within-subject (test-retest) correlations based on a mixed-effects model using the SAS proc MIXED output.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimate Correlations Between Repeatedly Measured Endpoints
(E.g., Reliability) Based on Linear Mixed-Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Wim Van der Elst, Geert Molenberghs, Dieter Hilgers, &amp; Nicole Heussen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wim Van der Elst &lt;Wim.vanderelst@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In clinical practice and research settings in medicine and the behavioral sciences, it is often of interest to quantify the correlation of a continuous endpoint that was repeatedly measured (e.g., test-retest correlations, ICC, etc.). This package allows for estimating these correlations based on mixed-effects models. Part of this software has been developed using funding provided from the European Union's 7th Framework Programme for research, technological development and demonstration under Grant Agreement no 602552.</td>
</tr>
<tr>
<td>Depends:</td>
<td>nlme</td>
</tr>
<tr>
<td>Imports:</td>
<td>psych</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-18 14:21:10 UTC; wim</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-18 15:24:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='Example.Data'>
An example dataset
</h2><span id='topic+Example.Data'></span>

<h3>Description</h3>

<p><code>Example.Data</code> is a hypothetical dataset constructed to demonstrate some of the functions in the package. Data are provided for a hypothetical experiment in which a stimulus is provided under different experimental conditions. The outcome is a normally distributed variable. The entire experiment is repeated multiple times (cycle) in each patient.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Example.Data)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">360</code> observations on <code class="reqn">5</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The Subject identifier.</p>
</dd>
<dt><code>Cycle</code></dt><dd><p>The same experiment is repeated multiple times in a patient. Cycle indicates the order of these repeated experiments.</p>
</dd>
<dt><code>Condition</code></dt><dd><p>The experimental condition under which the outcome was measured.</p>
</dd>
<dt><code>Time</code></dt><dd><p>The time point at which the outcome was measured.</p>
</dd>
<dt><code>Outcome</code></dt><dd><p>A continuous outcome.</p>
</dd>   
</dl>


<hr>
<h2 id='Explore.WS.Corr'>
Explore within-subject correlations (reliabilities)
</h2><span id='topic+Explore.WS.Corr'></span>

<h3>Description</h3>

<p>This function allows for exploring the  within-subject (test-retest) correlation (<code class="reqn">R</code>) structure in the data, taking relevant covariates into account. Estimated correlations as a function of time lag (= absolute difference between measurement moments <code class="reqn">t_1</code> and <code class="reqn">t_2</code>) are provided as well as their confidence intervals (based on a non-parametric bootstrap). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Explore.WS.Corr(OLS.Model=" ", Dataset, Id, Time, 
Alpha=0.05, Smoother.Span=.2, Number.Bootstrap=100, 
Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Explore.WS.Corr_+3A_ols.model">OLS.Model</code></td>
<td>
<p><code>OLS.Model</code> is a formula passed to <code>lm</code> (to obtain the OLS residuals, i.e., to take covariates into account in the computation of <code class="reqn">R</code>). <code>OLS.Model</code> should thus be a formula that specifies the outcome of interest followed by a ~ sign and the covariates to be taken into account, e.g. 
</p>
<p><code>OLS.Model="Outcome~1+as.factor(Time) + as.factor(Treatment)"</code>. </p>
</td></tr>
<tr><td><code id="Explore.WS.Corr_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td></tr>
<tr><td><code id="Explore.WS.Corr_+3A_id">Id</code></td>
<td>
<p>The subject indicator.</p>
</td></tr>
<tr><td><code id="Explore.WS.Corr_+3A_time">Time</code></td>
<td>
<p>The time indicator. Should be coded as <code class="reqn">1</code>, <code class="reqn">2</code>, etc.</p>
</td></tr>
<tr><td><code id="Explore.WS.Corr_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used in the non-parametric bootstrap-based Confidence Interval for <code class="reqn">R</code>. Default <code>Alpha=0.05</code></p>
</td></tr> 
<tr><td><code id="Explore.WS.Corr_+3A_smoother.span">Smoother.Span</code></td>
<td>
<p>A smoothing (loess) technique is used to estimate <code class="reqn">R</code> as a function of time lag. The smoother span gives the proportion of points in the plot which influence the smooth at each value. Larger values give more smoothness. For details, see <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html">https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html</a>. Defauls <code>Smoother.Span=.2</code>.</p>
</td></tr>
<tr><td><code id="Explore.WS.Corr_+3A_number.bootstrap">Number.Bootstrap</code></td>
<td>
<p>The number of non-parametric bootstrap samples to be used to estimate the Confidence Interval for <code class="reqn">R</code>. Default <code>Number.Bootstrap=100</code></p>
</td></tr> 
<tr><td><code id="Explore.WS.Corr_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap. Default <code>Seed=1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Est.Corr</code></td>
<td>
<p>The estimated correlations <code class="reqn">R</code> as a function of time lag. A smoothing (loess) technique is used to estimate <code class="reqn">R</code> as a function of time lag (based on the output in <code>All.Corrs).</code></p>
</td></tr>
<tr><td><code>All.Corrs</code></td>
<td>
<p>A <code>matrix</code> that contains the estimated correlations <code class="reqn">R</code> for all individual time lags.</p>
</td></tr>
<tr><td><code>Bootstrapped.Corrs</code></td>
<td>
<p>A <code>matrix</code> that contains the estimated correlations <code class="reqn">R</code> as a function of time lag in the bootstrapped samples.</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code> level used in the estimation of the confidence interval.</p>
</td></tr>
<tr><td><code>CI.Upper</code></td>
<td>
<p>The upper bounds of the confidence intervals.</p>
</td></tr>
<tr><td><code>CI.Lower</code></td>
<td>
<p>The lower bounds of the confidence intervals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.Explore.WS.Corr">plot.Explore.WS.Corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data
data(Example.Data)

# Explore correlation structure
Expl_Corr &lt;- Explore.WS.Corr(OLS.Model="Outcome~as.factor(Time)+ 
  as.factor(Cycle) + as.factor(Condition)", Dataset=Example.Data, 
  Id="Id", Time="Time", Alpha=.05, Number.Bootstrap=50, Seed=123)

# explore results
summary(Expl_Corr)

# plot with correlations for all time lags, and 
# add smoothed (loess) correlation function 
plot(Expl_Corr, Indiv.Corrs=TRUE)
# plot bootstrapped smoothed (loess) correlation function 
plot(Expl_Corr)
</code></pre>

<hr>
<h2 id='Fract.Poly'>Fit fractional polynomials</h2><span id='topic+Fract.Poly'></span>

<h3>Description</h3>

<p>Fits regression models with <code class="reqn">m</code> terms of the form <code class="reqn">X^{p}</code>, where the exponents <code class="reqn">p</code> are selected from a small predefined set <code class="reqn">S</code> of both integer and non-integer values. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fract.Poly(Covariate, Outcome, S=c(-2,-1,-0.5,0,0.5,1,2,3), Max.M=5, Dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fract.Poly_+3A_covariate">Covariate</code></td>
<td>
<p>The covariate to be considered in the models.</p>
</td></tr>
<tr><td><code id="Fract.Poly_+3A_outcome">Outcome</code></td>
<td>
<p>The outcome to be considered in the models.</p>
</td></tr>
<tr><td><code id="Fract.Poly_+3A_s">S</code></td>
<td>
<p>The set <code class="reqn">S</code> from which each power <code class="reqn">p^{m}</code>
is selected. Default 
<code>S={-2, -1, -0.5, 0, 0.5, 1, 2, 3}</code>.</p>
</td></tr>
<tr><td><code id="Fract.Poly_+3A_max.m">Max.M</code></td>
<td>
<p>The maximum order <code class="reqn">M</code> to be considered for the fractional polynomial. This value can be <code class="reqn">5</code> at most. When <code class="reqn">M=5</code>, then fractional polynomials of order <code class="reqn">1</code> to <code class="reqn">5</code> are considered. Default <code>Max.M=5</code>.</p>
</td></tr>
<tr><td><code id="Fract.Poly_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Results.M1</code></td>
<td>
<p>The results (powers and AIC values) of the fractional polynomials of order <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code>Results.M2</code></td>
<td>
<p>The results (powers and AIC values) of the fractional polynomials of order <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code>Results.M3</code></td>
<td>
<p>The results (powers and AIC values) of the fractional polynomials of order <code class="reqn">3</code>.</p>
</td></tr>
<tr><td><code>Results.M4</code></td>
<td>
<p>The results (powers and AIC values) of the fractional polynomials of order <code class="reqn">4</code>.</p>
</td></tr>
<tr><td><code>Results.M5</code></td>
<td>
<p>The results (powers and AIC values) of the fractional polynomials of order <code class="reqn">5</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data
data(Example.Data)

# Fit fractional polynomials, mox. order = 3
FP &lt;- Fract.Poly(Covariate = Time, Outcome = Outcome, 
Dataset = Example.Data, Max.M=3)

# Explore results
summary(FP)
# best fitting model (based on AIC) for m=3, 
# powers:  p_{1}=3,  p_{2}=3, and  p_{3}=2

# Fit model and compare with observed means

    # plot of mean 
Spaghetti.Plot(Dataset = Example.Data, Outcome = Outcome,
Time = Time, Id=Id, Add.Profiles = FALSE, Lwd.Me=1, 
ylab="Mean Outcome")

    # Coding of predictors (note that when p_{1}=p_{2},
    # beta_{1}*X ** {p_{1}} + beta_{2}*X ** {p_{1}} * log(X)
    #  and when p=0, X ** {0}= log(X)    )
term1 &lt;- Example.Data$Time**3
term2 &lt;- (Example.Data$Time**3) * log(Example.Data$Time) 
term3 &lt;- Example.Data$Time**2 

    # fit model
Model &lt;- lm(Outcome~term1+term2+term3, data=Example.Data)
Model$coef # regression weights (beta's)  

    # make prediction for time 1 to 47
term1 &lt;- (1:47)**3 
term2 &lt;- ((1:47)**3) * log(1:47)   
term3 &lt;- (1:47)**2 
    # compute predicted values
pred &lt;- Model$coef[1] + (Model$coef[2] * term1) + 
  (Model$coef[3] * term2) + (Model$coef[4] * term3)
   # Add predicted values to plot
lines(x = 1:47, y=pred,  lty=2)
legend("topright", c("Observed", "Predicted"), lty=c(1, 2))
</code></pre>

<hr>
<h2 id='Heatmap'>
Plot a heatmap of the correlation structure 
</h2><span id='topic+Heatmap'></span>

<h3>Description</h3>

<p>This function plots a heatmap of the correlation structure (reliability) in the data. It is a wrapper function for the <code>cor.plot</code> function of the <code>psych</code> package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Heatmap(Dataset, Id, Outcome, Time, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Heatmap_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td></tr>
<tr><td><code id="Heatmap_+3A_id">Id</code></td>
<td>
<p>The subject indicator.</p>
</td></tr>
<tr><td><code id="Heatmap_+3A_outcome">Outcome</code></td>
<td>
<p>The outcome indicator.</p>
</td></tr>
<tr><td><code id="Heatmap_+3A_time">Time</code></td>
<td>
<p>The time indicator.</p>
</td></tr>
<tr><td><code id="Heatmap_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to <code>cor.plot</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.Explore.WS.Corr">plot.Explore.WS.Corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data
data(Example.Data)

# Make heatmap
Heatmap(Dataset=Example.Data, Id = "Id", 
Outcome="Outcome", Time = "Time")

# Make heatmap in black and white
Heatmap(Dataset=Example.Data, Id = "Id", 
Outcome="Outcome", Time = "Time", colors=FALSE)
</code></pre>

<hr>
<h2 id='Model.Fit'>
Compare the fit of linear mixed-effects models
</h2><span id='topic+Model.Fit'></span>

<h3>Description</h3>

<p>This function compares the fit of Model 1 (random intercept) and 2 (random intercept and Gausssian serial correlation), and of Model 2 (random intercept and Gausssian serial correlation) and 3 (random intercept, slope and Gausssian serial correlation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Model.Fit(Model.1, Model.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Model.Fit_+3A_model.1">Model.1</code></td>
<td>
<p>An object of class <code>WS.Corr.Mixed</code>, the first fitted model.</p>
</td></tr>
<tr><td><code id="Model.Fit_+3A_model.2">Model.2</code></td>
<td>
<p>Another object of class <code>WS.Corr.Mixed</code>, the second fitted model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WS.Corr.Mixed">WS.Corr.Mixed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Example.Data)

# Code predictors for time
Example.Data$Time2 &lt;- Example.Data$Time**2
Example.Data$Time3 &lt;- Example.Data$Time**3
Example.Data$Time3_log &lt;- (Example.Data$Time**3) * (log(Example.Data$Time))

# model 1
Model1 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Dataset=Example.Data, Model=1, Id="Id", 
Number.Bootstrap = 0, Seed = 12345)

# model 2
Model2 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Correlation=corGaus(form= ~ Time, nugget = TRUE),
Dataset=Example.Data, Model=2, Id="Id", 
Number.Bootstrap = 0, Seed = 12345)

# model 3
Model3 &lt;- WS.Corr.Mixed(
  Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
  + as.factor(Condition), Random.Part = ~ 1 + Time|Id, 
  Correlation=corGaus(form= ~ Time, nugget = TRUE),
  Dataset=Example.Data, Model=3, Id="Id", 
  Number.Bootstrap = 0, Seed = 12345)

# compare models 1 and 2
Model.Fit(Model.1=Model1, Model.2=Model2)

# compare models 2 and 3
Model.Fit(Model.1=Model2, Model.2=Model3)
</code></pre>

<hr>
<h2 id='plot+20Explore.WS.Corr'>
Plot of exploratory within-subject correlations (reliabilities) 
</h2><span id='topic+plot.Explore.WS.Corr'></span><span id='topic+plot+20Explore.WS.Corr'></span>

<h3>Description</h3>

<p>Provides an exploratory plot that allows for examining the within-subject correlations <code class="reqn">R</code> (reliabilities) as a function if time lag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Explore.WS.Corr'
plot(x, Est.Corrs=TRUE, Indiv.Corrs=FALSE, 
Add.CI=FALSE, Add.CI.Smoothed=TRUE, Smoother.Span=0.2, 
Add.Boot.Corrs=FALSE, Add.CI.Polygon=FALSE, 
ylim=c(-1, 1), xlab="Time Lag", ylab="Reliability", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>Explore.WS.Corr</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_est.corrs">Est.Corrs</code></td>
<td>
<p>Logical. Should the smoothed (loess) correlation function as a function of time lag be added? Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_indiv.corrs">Indiv.Corrs</code></td>
<td>
<p>Logical. Should the estimated correlations for all individual time lags be added? Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_add.ci">Add.CI</code></td>
<td>
<p>Logical. Should a bootstrapped <code class="reqn">100(1-\alpha)</code>% Confidence Interval be added around the smoothed correlation function? Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_add.ci.smoothed">Add.CI.Smoothed</code></td>
<td>
<p>Logical. Should a smoothed bootstrapped <code class="reqn">100(1-\alpha)</code>% Confidence Interval be added around the smoothed correlation function? Default <code>FALSE</code>.</p>
</td></tr>  
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_smoother.span">Smoother.Span</code></td>
<td>
<p>The smoother span to be used. The smoother span gives the proportion of points in the plot which influence the smooth at each value. Larger values give more smoothness. For details, see <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html">https://stat.ethz.ch/R-manual/R-patched/library/stats/html/lowess.html</a>. Defauls <code>Smoother.Span=.2</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_add.boot.corrs">Add.Boot.Corrs</code></td>
<td>
<p>Logical. Should the inidividual bootstrapped smoothed (loess) correlation functions be added? Default <code>FALSE</code>.</p>
</td></tr>  
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_add.ci.polygon">Add.CI.Polygon</code></td>
<td>
<p>Logical. Similar to <code>Add.CI</code> but adds a grey polygon to mark the a bootstrapped <code class="reqn">100(1-\alpha)</code>% Confidence Interval (instead of dashed lines). Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_ylim">ylim</code></td>
<td>
<p>The minimum and maximum values of the Y-axis. Default <code>ylim=c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_xlab">xlab</code></td>
<td>
<p>The label of the X-axis. Default <code>xlab="Time Lag"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_ylab">ylab</code></td>
<td>
<p>The label of the Y-axis. Default <code>ylab="Reliability"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Explore.WS.Corr_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the plot function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Explore.WS.Corr">Explore.WS.Corr</a>, <a href="#topic+Heatmap">Heatmap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data
data(Example.Data)

# Explore correlation structure
Expl_Corr &lt;- Explore.WS.Corr(OLS.Model="Outcome~as.factor(Time)+ 
  as.factor(Cycle) + as.factor(Condition)", Dataset=Example.Data, 
  Id="Id", Time="Time", Alpha=.05, Number.Bootstrap=50, Seed=123)

# explore results
summary(Expl_Corr)

# plot with correlations for all time lags, and 
# add smoothed (loess) correlation function 
plot(Expl_Corr, Indiv.Corrs=TRUE, Add.CI=FALSE, Add.Boot.Corrs=FALSE)
# plot bootstrapped smoothed (loess) correlation function 
plot(Expl_Corr, Add.Boot.Corrs=TRUE)
</code></pre>

<hr>
<h2 id='plot.WS.Corr.Mixed'>
Plot the within-subject correlations (reliabilities) obtained by using the mixed-effects modeling approch
</h2><span id='topic+plot.WS.Corr.Mixed'></span><span id='topic+plot.WS.Corr.Mixed.SAS'></span><span id='topic+plot+20WS.Corr.Mixed'></span><span id='topic+plot+20WS.Corr.Mixed.SAS'></span>

<h3>Description</h3>

<p>Plots the within-subject correlations (reliabilities) and <code class="reqn">100(1-\alpha)</code>% Confidence Intervals based on the fitted mixed-effect models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'WS.Corr.Mixed'
plot(x, xlab, ylab, ylim, main, All.Individual=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>WS.Corr.Mixed</code></p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_xlab">xlab</code></td>
<td>
<p>The label of the X-axis.</p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_ylab">ylab</code></td>
<td>
<p>The label of the Y-axis.</p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_ylim">ylim</code></td>
<td>
<p>The min, max values of the Y-axis.</p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_main">main</code></td>
<td>
<p>The main title of the plot.</p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_all.individual">All.Individual</code></td>
<td>
<p><code>Logical</code>. Should correlation functions be provided that show the correlations between all indidual measurement moments <code class="reqn">R(t_{i},t_{k})</code>? Argument is only used if Model <code class="reqn">2</code> was fitted. Default <code>All.Individual=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.WS.Corr.Mixed_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the plot function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WS.Corr.Mixed">WS.Corr.Mixed</a></code>, <code><a href="#topic+plot+20WS.Corr.Mixed">plot WS.Corr.Mixed</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># open data
data(Example.Data)

# Make covariates used in mixed model
Example.Data$Time2 &lt;- Example.Data$Time**2
Example.Data$Time3 &lt;- Example.Data$Time**3
Example.Data$Time3_log &lt;- (Example.Data$Time**3) * (log(Example.Data$Time))

# model 1: random intercept model
Model1 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Dataset=Example.Data, Model=1, Id="Id", Number.Bootstrap = 50, 
Seed = 12345)

  # plot the results
plot(Model1)

## Not run: time-consuming code parts
# model 2: random intercept + Gaussian serial corr
Model2 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Correlation=corGaus(form= ~ Time, nugget = TRUE),
Dataset=Example.Data, Model=2, Id="Id", Seed = 12345)

  # plot the results
    # estimated corrs as a function of time lag (default plot)
plot(Model2)
    # estimated corrs for all pairs of time points
plot(Model2, All.Individual = T)

# model 3
Model3 &lt;- WS.Corr.Mixed(
  Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
  + as.factor(Condition), Random.Part = ~ 1 + Time|Id, 
  Correlation=corGaus(form= ~ Time, nugget = TRUE),
  Dataset=Example.Data, Model=3, Id="Id", Seed = 12345)

  # plot the results
    # estimated corrs for all pairs of time points
plot(Model3)
    # estimated corrs as a function of time lag

## End(Not run)
</code></pre>

<hr>
<h2 id='Spaghetti.Plot'>Make a Spaghetti plot</h2><span id='topic+Spaghetti.Plot'></span>

<h3>Description</h3>

<p>Makes a spaghetti plot, i.e., a plot that depicts the outcome as a function of time for each individual subject.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Spaghetti.Plot(Dataset, Outcome, Time, Id, Add.Profiles=TRUE, Add.Mean=TRUE, 
Add.Median=FALSE, Col=8, Lwd.Me=3, xlim, ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Spaghetti.Plot_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_outcome">Outcome</code></td>
<td>
<p>The name of the outcome variable.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_time">Time</code></td>
<td>
<p>The name of the time indicator.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_id">Id</code></td>
<td>
<p>The subject indicator.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_add.profiles">Add.Profiles</code></td>
<td>
<p>Logical. Should the individual profiles be added? Default <code>Add.Profiles=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_add.mean">Add.Mean</code></td>
<td>
<p>Logical. Should a line that depicts the mean as a function of time be added? Default <code>Add.Mean=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_add.median">Add.Median</code></td>
<td>
<p>Logical. Should a line that depicts the medean as a function of time be added? Default <code>Add.Mean=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_col">Col</code></td>
<td>
<p>The color of the individual profiles. Default <code>Col=8</code> (grey).</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_lwd.me">Lwd.Me</code></td>
<td>
<p>The line width of the lines with mean and/or median. Default <code>Lwd.Me=3</code>.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_xlim">xlim</code></td>
<td>
<p>The (min, max) values for the x-axis.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_ylim">ylim</code></td>
<td>
<p>The (min, max) values for the y-axis.</p>
</td></tr>
<tr><td><code id="Spaghetti.Plot_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data
data(Example.Data)

# Plot individual profiles + mean
Spaghetti.Plot(Dataset = Example.Data, Outcome = Outcome, Id=Id, Time = Time)

# Plot individual profiles + median
Spaghetti.Plot(Dataset = Example.Data, Outcome = Outcome, Id=Id, Time = Time,
Add.Mean = FALSE, Add.Median = TRUE)
</code></pre>

<hr>
<h2 id='summary'>Summary</h2><span id='topic+summary'></span><span id='topic+summary.Explore.WS.Corr'></span><span id='topic+summary.Fract.Poly'></span><span id='topic+summary.WS.Corr.Mixed'></span><span id='topic+summary.WS.Corr.Mixed.SAS'></span>

<h3>Description</h3>

<p>summary</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Explore.WS.Corr'
summary(object, ..., Object)
## S3 method for class 'Fract.Poly'
summary(object, ..., Object)
## S3 method for class 'WS.Corr.Mixed'
summary(object, ..., Object)
## S3 method for class 'WS.Corr.Mixed.SAS'
summary(object, ..., Object)
</code></pre>

<hr>
<h2 id='WS.Corr.Mixed'>
Estimate within-subject correlations (reliabilities) based on a mixed-effects model.
</h2><span id='topic+WS.Corr.Mixed'></span>

<h3>Description</h3>

<p>This function allows for the estimation of the within-subject correlations using a general and flexible modeling approach that allows at the same time to capture hierarchies in the data, the presence of covariates, and the derivation of correlation estimates. Non-parametric bootstrap-based confidence intervals can be requested. </p>


<h3>Usage</h3>

<pre><code class='language-R'>WS.Corr.Mixed(Dataset, Fixed.Part=" ", Random.Part=" ", 
Correlation=" ", Id, Time=Time, Model=1, 
Number.Bootstrap=100, Alpha=.05, Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WS.Corr.Mixed_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of multiple lines per subject ('long' format).</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_fixed.part">Fixed.Part</code></td>
<td>
<p>The outcome and fixed-effect part of the mixed-effects model to be fitted. The model should be specified in agreement with the <code>lme</code> function requirements of the <code>nlme</code> package. See <b>examples</b> below.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_random.part">Random.Part</code></td>
<td>
<p>The random-effect part of the mixed-effects model to be fitted (specified in line with the <code>lme</code> function requirements). See <b>examples</b> below.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_correlation">Correlation</code></td>
<td>
<p>An optional object describing the within-group correlation structure (specified in line with the <code>lme</code> function requirements). See <b>examples</b> below.</p>
</td></tr> 
<tr><td><code id="WS.Corr.Mixed_+3A_id">Id</code></td>
<td>
<p>The subject indicator.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_time">Time</code></td>
<td>
<p>The time indicator. Default <code>Time=Time</code>.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted. <code>Model=1</code>: random intercept model, <code>Model=2</code>: random intercept and Gaussian serial correlation, <code>Model=3</code>: random intercept,  slope, and Gaussian serial correlation, and  <code>Model=4</code>: random intercept + slope. Default <code>Model=1</code>.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_number.bootstrap">Number.Bootstrap</code></td>
<td>
<p>The number of bootstrap samples to be used to estimate the Confidence Intervals around <code class="reqn">R</code>.  Default <code>Number.Bootstrap=100</code>. As an alternative to obtain confidence intervals, the Delta method can be used (see <a href="#topic+WS.Corr.Mixed.SAS">WS.Corr.Mixed.SAS</a>). </p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used in the bootstrap-based Confidence Interval for <code class="reqn">R</code>. Default <code class="reqn">Alpha=0.05</code></p>
</td></tr> 
<tr><td><code id="WS.Corr.Mixed_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap. Default <code class="reqn">Seed=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Warning 1</b>
</p>
<p>To avoid problems with the <code>lme</code> function, do not specify powers directly in the function call. For example, rather than specifying <code>Fixed.Part=ZSV ~ Time + Time**2</code> in the function call, first add <code>Time**2</code> to the dataset 
(<code>Dataset$TimeSq &lt;- Dataset$Time ** 2</code>) and then use the new variable name in the call:
<code>Fixed.Part=ZSV ~ Time + TimeSq</code>
</p>
<p><b>Warning 2</b>
To avoid problems with the <code>lme</code> function, specify the Random.Part and Correlation arguments like e.g.,
<code>Random.Part = ~ 1| Subject</code> and 
<code>Correlation=corGaus(form= ~ Time, nugget = TRUE)</code>
</p>
<p>not like e.g., 
<code>Random.Part = ~ 1| Subject</code> and
<code>Correlation=corGaus(form= ~ Time| Subject, nugget = TRUE)</code> 
</p>
<p>(i.e., do not use <code>Time| Subject</code>)
</p>


<h3>Value</h3>

<table>
<tr><td><code>Model</code></td>
<td>
<p>The type of model that was fitted (model <code class="reqn">1</code>, <code class="reqn">2</code>, or <code class="reqn">3</code>.)</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The <code class="reqn">D</code> matrix of the fitted model.</p>
</td></tr>
<tr><td><code>Tau2</code></td>
<td>
<p>The <code class="reqn">\tau^2</code> component of the fitted model. This component is only obtained when serial correlation is requested (Model <code class="reqn">2</code> or <code class="reqn">3</code>), <code class="reqn">\varepsilon_{2}  \sim N(0, \tau^2 H_{i}))</code>.</p>
</td></tr>
<tr><td><code>Rho</code></td>
<td>
<p>The <code class="reqn">\rho</code> component of the fitted model which determines the matrix <code class="reqn">H_{i}</code>, <code class="reqn">\rho(|t_{ij}-t_{ik}|)</code>. This component is only obtained when serial correlation is considered (Model <code class="reqn">2</code> or <code class="reqn">3</code>).</p>
</td></tr>
<tr><td><code>Sigma2</code></td>
<td>
<p>The residual variance.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>The AIC value of the fitted model.</p>
</td></tr>
<tr><td><code>LogLik</code></td>
<td>
<p>The log likelihood value of the fitted model.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The estimated reliabilities.</p>
</td></tr>
<tr><td><code>CI.Upper</code></td>
<td>
<p>The upper bounds of the bootstrapped confidence intervals.</p>
</td></tr>
<tr><td><code>CI.Lower</code></td>
<td>
<p>The lower bounds of the bootstrapped confidence intervals.</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code> level used in the estimation of the confidence interval.</p>
</td></tr>
<tr><td><code>Coef.Fixed</code></td>
<td>
<p>The estimated fixed-effect parameters.</p>
</td></tr>
<tr><td><code>Std.Error.Fixed</code></td>
<td>
<p>The standard errors of the fixed-effect parameters.</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The time values in the dataset.</p>
</td></tr>
<tr><td><code>Fitted.Model</code></td>
<td>
<p>A fitted model of class <code>lme</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Explore.WS.Corr">Explore.WS.Corr</a>, <a href="#topic+WS.Corr.Mixed.SAS">WS.Corr.Mixed.SAS</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># open data
data(Example.Data)

# Make covariates used in mixed model
Example.Data$Time2 &lt;- Example.Data$Time**2
Example.Data$Time3 &lt;- Example.Data$Time**3
Example.Data$Time3_log &lt;- (Example.Data$Time**3) * (log(Example.Data$Time))

# model 1: random intercept model
Model1 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Dataset=Example.Data, Model=1, Id="Id", Number.Bootstrap = 50, 
Seed = 12345)

  # summary of the results
summary(Model1)
  # plot the results
plot(Model1)

## Not run: time-consuming code parts
# model 2: random intercept + Gaussian serial corr
Model2 &lt;- WS.Corr.Mixed(
Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
+ as.factor(Condition), Random.Part = ~ 1|Id, 
Correlation=corGaus(form= ~ Time, nugget = TRUE),
Dataset=Example.Data, Model=2, Id="Id", Seed = 12345)

  # summary of the results
summary(Model2)

  # plot the results
    # estimated corrs as a function of time lag (default plot)
plot(Model2)
    # estimated corrs for all pairs of time points
plot(Model2, All.Individual = T)

# model 3
Model3 &lt;- WS.Corr.Mixed(
  Fixed.Part=Outcome ~ Time2 + Time3 + Time3_log + as.factor(Cycle) 
  + as.factor(Condition), Random.Part = ~ 1 + Time|Id, 
  Correlation=corGaus(form= ~ Time, nugget = TRUE),
  Dataset=Example.Data, Model=3, Id="Id", Seed = 12345)

  # summary of the results
summary(Model3)

  # plot the results
    # estimated corrs for all pairs of time points
plot(Model3)
    # estimated corrs as a function of time lag

## End(Not run)
</code></pre>

<hr>
<h2 id='WS.Corr.Mixed.SAS'>
Estimate within-subject (test-retest) correlations based on a mixed-effects model using the SAS proc MIXED output.
</h2><span id='topic+WS.Corr.Mixed.SAS'></span>

<h3>Description</h3>

<p>This function allows for the estimation of the within-subject correlations using a general and flexible modeling approach that allows at the same time to capture hierarchies in the data, the presence of covariates, and the derivation of correlation estimates. The output of proc MIXED (SAS) is used as the input for this function. Confidence intervals for the correlations based on the Delta method are provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WS.Corr.Mixed.SAS(Model, D, Sigma2, Asycov, Rho, Tau2, Alpha=0.05, Time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted. <code>Model=1</code>: random intercept model, <code>Model=2</code>: random intercept and serial correlation, and <code>Model=3</code>: random intercept,  slope, and serial correlation. Default <code>Model=1</code>.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_d">D</code></td>
<td>
<p>The <code class="reqn">D</code> matrix of the fitted model.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_sigma2">Sigma2</code></td>
<td>
<p>The residual variance.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_asycov">Asycov</code></td>
<td>
<p>The asymptotic correlation matrix of covariance parameter estimates.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_rho">Rho</code></td>
<td>
<p>The <code class="reqn">\rho</code> component of the fitted model which determines the matrix <code class="reqn">H_{i}</code>, <code class="reqn">\rho(|t_{ij}-t_{ik}|)</code>. This component is only needed when serial correlation is involved, i.e., when Model <code class="reqn">2</code> or <code class="reqn">3</code> used.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_tau2">Tau2</code></td>
<td>
<p>The <code class="reqn">\tau^2</code> component of the fitted model. This component is only needed when serial correlation is involved (i.e., when Model <code class="reqn">2</code> or <code class="reqn">3</code> used), <code class="reqn">\varepsilon_{2} \sim N(0, \tau^2 H_{i}))</code>.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used in the computation of the Confidence Intervals around the within-subject correlation. The Confidence Intervals are based on the Delta method. Default <code>Alpha=0.05</code>.</p>
</td></tr>
<tr><td><code id="WS.Corr.Mixed.SAS_+3A_time">Time</code></td>
<td>
<p>The time points available in the dataset on which the analysis was conducted.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Model</code></td>
<td>
<p>The type of model that was fitted.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The estimated within-subject correlations.</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level used to computed the Confidence Intervals around <code class="reqn">R</code>.</p>
</td></tr>
<tr><td><code>CI.Upper</code></td>
<td>
<p>The upper bounds of the confidence intervals (Delta-method based).</p>
</td></tr>
<tr><td><code>CI.Lower</code></td>
<td>
<p>The lower bounds of the confidence intervals (Delta-method based).</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The time values in the dataset.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Geert Molenberghs, Ralf-Dieter Hilgers, &amp; Nicole Heussen
</p>


<h3>References</h3>

<p>Van der Elst, W., Molenberghs, G., Hilgers, R., &amp; Heussen, N. (2015). Estimating the reliability of repeatedly measured endpoints based on linear mixed-effects models. A tutorial. <em>Submitted.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WS.Corr.Mixed">WS.Corr.Mixed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open data 
data(Example.Data)

# Estimate R and Delta method-based CI 
# based on SAS output of fitted Model 2

# First specify asycov matrix
Asy_mat &lt;- matrix(c(129170, -10248, -12.0814, -74.8605,
                    -10248, 25894, 21.0976, -50.1059,
                    -12.0814, 21.0976, 0.07791, 1.2120,
                    -74.8605, -50.1059, 1.212, 370.65), nrow = 4)
Model2_SAS &lt;-  WS.Corr.Mixed.SAS(Model="Model 2", 
D=500.98, Tau2=892.97, Rho=3.6302, Sigma2=190.09, 
Asycov = Asy_mat, Time=c(1:45))                               
summary(Model2_SAS)
plot(Model2_SAS)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
