<!DOCTYPE html><html lang="en"><head><title>Help for package welchADF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {welchADF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adhdData'><p>Children's reaction times (milliseconds) to stimuli of different nature, arranged with</p>
four response columns.</a></li>
<li><a href='#adhdData2'><p>Children's reaction times (milliseconds) to stimuli of different nature, arranged with one single</p>
response column and taking the multi-variate response as an explicit within-subjects factor.</a></li>
<li><a href='#confint.welchADFt'><p>Confidence interval for the effect size of model effects</p></a></li>
<li><a href='#miceData'><p>Number of visits and time spent in different tunnels of laboratory mice</p></a></li>
<li><a href='#perceptionData'><p>Number of puzzles 42 students were able to solve</p></a></li>
<li><a href='#summary.welchADFt'><p>Summarizing Welch Approximate Degrees of Freedom test results</p></a></li>
<li><a href='#welchADF.test'><p>General Approximate Degrees of Freedom Solution for Inference and Estimation</p></a></li>
<li><a href='#womenStereotypeData'><p>Students' scores (men and women) on an arithmetic test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Welch-James Statistic for Robust Hypothesis Testing under
Heterocedasticity and Non-Normality</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of Johansen's general formulation of Welch-James's statistic with Approximate Degrees of Freedom, which makes it suitable for testing 
    any linear hypothesis concerning cell means in univariate and multivariate mixed model designs when the data pose non-normality and non-homogeneous variance. Some 
    improvements, namely trimmed means and Winsorized variances, and bootstrapping for calculating an empirical critical value, have been added to the classical formulation. 
    The code departs from a previous SAS implementation by L.M. Lix and H.J. Keselman, available at <a href="http://supp.apa.org/psycarticles/supplemental/met_13_2_110/SAS_Program.pdf">http://supp.apa.org/psycarticles/supplemental/met_13_2_110/SAS_Program.pdf</a> and
    published in Keselman, H.J., Wilcox, R.R., and Lix, L.M. (2003) &lt;<a href="https://doi.org/10.1111%2F1469-8986.00060">doi:10.1111/1469-8986.00060</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Pablo J. Villacorta &lt;pjvi@decsai.ugr.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pablo J. Villacorta &lt;pjvi@decsai.ugr.es&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="http://decsai.ugr.es/~pjvi/r-packages.html&amp;gt;">http://decsai.ugr.es/~pjvi/r-packages.html&gt;</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-07 22:44:52 UTC; AsusPC</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-08 07:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adhdData'>Children's reaction times (milliseconds) to stimuli of different nature, arranged with
four response columns.</h2><span id='topic+adhdData'></span>

<h3>Description</h3>

<p>The data (Keselman et al., 2003) represent the reaction times in milliseconds 
of children with attention-deficit hyperactivity (ADHD) and normal children 
when they are presented four kinds of inputs: 
a target alone or an arrow stimuli incongruent, congruent and neutral to the target. 
According to the authors, the dataset was artificially generated from the summary 
measures given in the original study by Jonkman et al. (1999), in groups of 20 
and 10 children to create an unbalanced design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adhdData
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 5 variables:
</p>

<dl>
<dt>Group</dt><dd><p>whether the child has ADHD or is healty (normal)</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>TargetAlone</dt><dd><p>Reaction time (milliseconds) to a target alone.</p>
</dd>
<dt>Congruent</dt><dd><p>Reaction time (milliseconds) to a congruent stimulus.</p>
</dd>
<dt>Neutral</dt><dd><p>Reaction time (milliseconds) to a neutral stimulus.</p>
</dd>
<dt>Incongruent</dt><dd><p>Reaction time (milliseconds) to an incongruent stimulus.</p>
</dd>
</dl>


<h3>Source</h3>

<p>H. J. Keselman, R. R. Wilcox, and L. M. Lix. A generally robust approach to hypothesis testing in
independent and correlated groups designs. Psychophyisiology, 40:586-596, 2003. (Data displayed in page 593).
</p>


<h3>References</h3>

<p>L. Jonkman, C. Kemner, M. Verbaten, H. van Engeland, J. Kenemans, G. Camfferman, J. Buitelaar, and
H. Koelega. Perceptual and response interference in children with attention-deficit hyperactivity
disorder, and the effects of methylphenidate. 36(4):419-429, 1999.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assuming a multivariate response
omnibus_LSM_multi &lt;- welchADF.test(adhdData, response = c("TargetAlone", "Congruent",
  "Neutral", "Incongruent"), between.s = "Group", within.s = "multivariate", contrast = "omnibus")
# The same using the S3 method for class formula
omnibus_LSM_multi_form &lt;- welchADF.test(cbind(TargetAlone, Congruent, Neutral, Incongruent)
~ Group, data = adhdData)
  
# Pairwise comparisons of the implicit within-subjects effect present in the multivariate response
pairwise_LSM_multi &lt;- update(omnibus_LSM_multi, contrast = "all.pairwise", effect = "multivariate")
summary(omnibus_LSM_multi)
summary(pairwise_LSM_multi)
</code></pre>

<hr>
<h2 id='adhdData2'>Children's reaction times (milliseconds) to stimuli of different nature, arranged with one single
response column and taking the multi-variate response as an explicit within-subjects factor.</h2><span id='topic+adhdData2'></span>

<h3>Description</h3>

<p>Exactly the same data explained in &quot;adhdData&quot; but reshaped as follows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adhdData2
</code></pre>


<h3>Format</h3>

<p>A data frame with 120 rows and 4 variables:
</p>

<dl>
<dt>Group</dt><dd><p>whether the child has ADHD or is healty (normal)</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>Stimulus</dt><dd><p>the stimulus to which the reaction time in this row corresponds.</p>
</dd>
<dt>Subject</dt><dd><p>an integer ID that identifies the subject to which the reaction time corresponds.</p>
</dd>
<dt>Milliseconds</dt><dd><p>reaction time (milliseconds) to of the aforementioned subject to the aforementioned stimulus.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'># Omnibus test of a mixed between x within subjects model, 
# using trimmed means and Winsorized variances
omnibus_trimmed &lt;- welchADF.test(adhdData2, response = "Milliseconds",between.s = "Group", 
  within.s = "Stimulus", subject = "Subject", contrast = "omnibus", trimming = TRUE)
  
# The same using S3 method for class formula. The data can be in separate variables in
# the scope of the call, not necessarily in a data.frame
millis &lt;- adhdData2$Milliseconds
gr &lt;- adhdData2$Group
st &lt;- adhdData2$Stimulus
sbj &lt;- adhdData2$Subject
omnibus_trimmed_formula &lt;- welchADF.test(millis ~ gr*st + (st|sbj), 
  contrast = "omnibus", trimming = TRUE)
summary(omnibus_trimmed_formula)

# Pairwise contrasts of the effects
pairwise_LSM &lt;- welchADF.test(adhdData2, response = "Milliseconds", between.s = "Group", 
  within.s = "Stimulus", subject = "Subject", contrast = "all.pairwise", effect = "Stimulus")
pairwise_trimmed &lt;- update(pairwise_LSM, trimming = TRUE)
  
# Bootstrapping to obtain an empirical critical value
## Not run: 
  pairwise_trimmed_boot &lt;- update(pairwise_trimmed, bootstrap =TRUE, seed = 123456)
  summary(pairwise_trimmed_boot)

## End(Not run)
</code></pre>

<hr>
<h2 id='confint.welchADFt'>Confidence interval for the effect size of model effects</h2><span id='topic+confint.welchADFt'></span>

<h3>Description</h3>

<p>For the effects indicated by the user, extracts confidence intervals 
for the effect size from an object of class <code>welchADFt</code>
returned by a call to <code><a href="#topic+welchADF.test">welchADF.test</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'welchADFt'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.welchADFt_+3A_object">object</code></td>
<td>
<p>a object of (S3 class) welchADF.t</p>
</td></tr>
<tr><td><code id="confint.welchADFt_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals, 
either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.welchADFt_+3A_level">level</code></td>
<td>
<p>confidence level (completely ignored, since the confidence threshold 
had been in the call to <code><a href="#topic+welchADF.test">welchADF.test</a></code>).</p>
</td></tr>
<tr><td><code id="confint.welchADFt_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If  <code>effect.size</code> was set to <code>TRUE</code> in the call to <code>welchADF.test</code>, 
a matrix (or vector) with columns giving lower and upper confidence limits for each parameter. 
These will be labelled as (1-level)/2 and 1 - (1-level)/2 in 
If <code>effect.size</code> was set to <code>FALSE</code>, <code>NULL</code> is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+welchADF.test">welchADF.test</a></code>, <code><a href="stats.html#topic+confint.lm">confint.lm</a></code>
</p>

<hr>
<h2 id='miceData'>Number of visits and time spent in different tunnels of laboratory mice</h2><span id='topic+miceData'></span>

<h3>Description</h3>

<p>Wild strain house mice were, at birth, cross fostered onto house mouse (Mus), 
deer mouse (Peromyscus) or rat (Rattus) nursing mothers. Ten days after weaning, 
each subject was tested in an apparatus that allowed it to enter four different tunnels: 
one scented with clean pine shavings, and the other three tunnels with shavings 
bearing the scent of Mus, Peromyscus, or Rattus respectively. 
Three variables were measured for each tunnel: the number of visits to the 
tunnel during a twenty minute test, the time spent by each subject
in each of the four tunnels and the latency to first visit of each tunnel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>miceData
</code></pre>


<h3>Format</h3>

<p>A data frame with 144 rows and 6 variables:
</p>

<dl>
<dt>Subject</dt><dd><p>an ID that identifies the mouse to which the measurements of the row correspond.</p>
</dd>
<dt>nurs</dt><dd><p>type of nursing mother this mouse had at birth.</p>
</dd>
<dt>tunnel</dt><dd><p>type of tunnel to which the measurements of this row correspond.</p>
</dd>
<dt>visits</dt><dd><p>number of visits to the aforementioned tunnel.</p>
</dd>
<dt>time</dt><dd><p>total time spent by the mouse at this tunnel.</p>
</dd>
<dt>latency</dt><dd><p>seconds passed before the mouse first visited this tunnel.</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://core.ecu.edu/psyc/wuenschk/SPSS/TUNNEL4b.sav">http://core.ecu.edu/psyc/wuenschk/SPSS/TUNNEL4b.sav</a>
</p>


<h3>References</h3>

<p>K. L.Wuensch. Fostering house mice onto rats and deer mice: Effects on response to species odors.
Animal Learning &amp; Behavior, 20(3):253 - 258, 1992
</p>


<h3>Examples</h3>

<pre><code class='language-R'>omnibus_LSM &lt;- welchADF.test(miceData, response = c("visits", "time", "latency"),
  between.s = "nurs", within.s = "tunnel", subject = "Subject", contrast = "omnibus")
# Formula interface, using cbind() to specify a multivariate response.
omnibus_LSM_formula &lt;- welchADF.test(
  cbind(visits, time, latency) ~ nurs*tunnel + (tunnel|Subject), data = miceData) 
pairwise_LSM_nurs &lt;- welchADF.test(miceData, response = c("visits", "time",
  "latency"), between.s = "nurs", within.s = "tunnel", subject = "Subject",
  effect = "nurs", contrast = "all.pairwise")
pairwise_LSM_tunnel &lt;- update(pairwise_LSM_nurs, effect = "tunnel")
## Not run: 
  pairwise_nurs_trimmed_boot &lt;- update(pairwise_LSM_nurs, trimming = TRUE, bootstrap = TRUE)
  pairwise_tunnel_trimmed_boot &lt;- update(pairwise_nurs_trimmed_boot, effect = "tunnel")
  summary(pairwise_nurs_trimmed_boot)

## End(Not run)
summary(omnibus_LSM)
summary(pairwise_LSM_nurs)
summary(pairwise_LSM_tunnel)
</code></pre>

<hr>
<h2 id='perceptionData'>Number of puzzles 42 students were able to solve</h2><span id='topic+perceptionData'></span>

<h3>Description</h3>

<p>An artificial dataset created by Lix et al. which recreates data reported by a real study
on perception and concentration, on which 42 students were given several puzzles to be solved. 
The students are divided into three balanced groups as they had previously been asked to 
imagine solving puzzles in the distant future, near future, or not to imagine anything at all 
(control group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perceptionData
</code></pre>


<h3>Format</h3>

<p>A data frame with 42 rows and 2 variables:
</p>

<dl>
<dt>Group</dt><dd><p>group of the student (what the student was asked to imagine)</p>
</dd>
<dt>y</dt><dd><p>number of puzzles the student was able to solve, out of 12</p>
</dd>
</dl>


<h3>References</h3>

<p>Forster, J., Liberman, N., &amp; Friedman, R.S. (2004). Temporal construal effects on
abstract and concrete thinking: consequences for insight and creative cognition.
Journal of Personality and Social Psychology, 87, 2, 177-189.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>omnibus_LSM &lt;- welchADF.test(perceptionData, response = "y", between.s = "Group")
omnibus_trimmed &lt;- update(omnibus_LSM, trimming = TRUE)
pairwise_LSM &lt;- update(omnibus_LSM, effect = "Group", contrast = "all.pairwise")
pairwise_trimmed &lt;- update(pairwise_LSM, trimming = TRUE, effect.size = TRUE)
summary(omnibus_LSM)
## Not run: 
  pairwise_trimmed_boot &lt;- update(pairwise_trimmed, bootstrap = TRUE, seed = 12345, numsim_b = 600)
  summary(pairwise_trimmed_boot, digits = 6) # digits defaults to max(4, getOption("digits"))

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.welchADFt'>Summarizing Welch Approximate Degrees of Freedom test results</h2><span id='topic+summary.welchADFt'></span><span id='topic+print.welchADFt'></span>

<h3>Description</h3>

<p><code>summary</code> and <code>print</code> methods for class <code>"welchADF"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'welchADFt'
summary(object, verbose = FALSE, digits = max(4,
  getOption("digits")), ...)

## S3 method for class 'welchADFt'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.welchADFt_+3A_object">object</code></td>
<td>
<p>an object of class &quot;welchADFt&quot; returned by a call to 
<code><a href="#topic+welchADF.test">welchADF.test</a></code>.</p>
</td></tr>
<tr><td><code id="summary.welchADFt_+3A_verbose">verbose</code></td>
<td>
<p>whether the summary table should be preceded by an extended description of the
welch ADF test performed, including the kind of means (trimmed or not), kind of test
(omnibus or pairwise) and whether bootstrap was used or not. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="summary.welchADFt_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.welchADFt_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="summary.welchADFt_+3A_x">x</code></td>
<td>
<p>an object of class &quot;welchADFt&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string which summarizes the info, with class <code>"summary.welchADFt"</code>
ready to be printed by specific method <code>print.summary.welchADFt</code>.
</p>

<hr>
<h2 id='welchADF.test'>General Approximate Degrees of Freedom Solution for Inference and Estimation</h2><span id='topic+welchADF.test'></span><span id='topic+welchADF.test.formula'></span><span id='topic+welchADF.test.lm'></span><span id='topic+welchADF.test.aov'></span><span id='topic+welchADF.test.lmer'></span><span id='topic+welchADF.test.default'></span>

<h3>Description</h3>

<p>Computes the Welch-James statistic with Approximate Degrees of Freedom, 
based on the SAS code by H.J. Keselman, R.R. Wilcox and L.M. Lix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>welchADF.test(formula, ...)

## S3 method for class 'formula'
welchADF.test(formula, data, subset, ...)

## S3 method for class 'lm'
welchADF.test(formula, ...)

## S3 method for class 'aov'
welchADF.test(formula, ...)

## S3 method for class 'lmer'
welchADF.test(formula, ...)

## Default S3 method:
welchADF.test(formula, response, between.s = NULL,
  within.s = NULL, subject = NULL, contrast = c("omnibus",
  "all.pairwise"), effect = NULL, correction = c("hochberg", "holm"),
  trimming = FALSE, per = 0.2, bootstrap = FALSE, numsim_b = 999,
  effect.size = FALSE, numsim_es = 999, scaling = TRUE,
  standardize.effsz = TRUE, alpha = 0.05, seed = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="welchADF.test_+3A_formula">formula</code></td>
<td>
<p>A data frame or a formula or an lm object returned by <code><a href="stats.html#topic+lm">lm</a></code>.
If <code>formula</code> is a data frame, it must have 
the format described for argument <code>data</code> of <code>welchADF.test</code> for class formula.
If <code>formula</code> is a formula, it must be a two-sided linear formula object describing the 
between-subjects effects of the model, with the response variable(s) (surrounded by <code>cbind()</code> 
if it is a multivariate response, as <code>cbind(r1, r2, r3)</code>) on the left of the ~ 
operator and the terms on the right. Within-subject factors must be specified as a parenthesis
term on the rhs with the form (w1*w2*...|subject) with 'subject' being the name of the 
subject ID column, which must be present in the data (cannot be omitted like in the data.frame version)
e.g. <code>cbind(y1,y2) ~ A*B*C + (B*C|subjet)</code>. In this example, A would be a between-subject
factor because it is the only variable not present again on the left side of the parenthesis term
(where the within-subjects factors are specified). Multi-level or customized structures are not supported, e.g.
those having strata or more than one random factor. The formula does not affect the results of the tests as 
no 'model' is actually fit to the data. It only affects the terms displayed as a result of an omnibus
contrast when no <code>effect</code> argument is given (which means <em>run an omnibus test for every effect
or interaction (up to second order)</em>). In such case, the factors or interactions not specified in the formula
will not be applied an omnibus test. In case of a pairwise contrast, the structure in the formula is ignored
beyond interpreting which variables are between-subject factors and which are within-subjects factors.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to specialized methods. Should be named arguments.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_data">data</code></td>
<td>
<p>A data.frame with the data, formatted as follows: one row per 
observation of the response variable(s), and as many columns as needed to indicate the 
factor combination to which the observation corresponds. If necessary, an extra column with
the subject ID for designs having within-subjects factors
(can be omitted if there is only one within-subjects factor, see the vignette).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_subset">subset</code></td>
<td>
<p>A specification of the rows to be used as in <code><a href="stats.html#topic+model.frame">model.frame</a></code>: defaults to all rows. 
This can be any valid indexing vector (see [.data.frame) for the rows of data 
or if that is not supplied, a data frame made up of the variables used in formula.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_response">response</code></td>
<td>
<p>A string or vector of strings with the name(s) of the column(s) of <code>data</code> corresponding to the response variable(s). If 
a vector of strings is provided, the responses are taken as a set of repeated measurements or dependent variables.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_between.s">between.s</code></td>
<td>
<p>Vector of strings with the columns that correspond to between-subjects factors, if any (defaults to NULL).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_within.s">within.s</code></td>
<td>
<p>Vector of strings with the columns that correspond to within-subjects factors, if any (defaults to NULL).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_subject">subject</code></td>
<td>
<p>Name of the column (if any) containing the subject ID (defaults to NULL).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_contrast">contrast</code></td>
<td>
<p>One of <code>"omnibus", "all.pairwise"</code> indicating the type of contrast to be performed with the data.
<code>"omnibus"</code> stands for omnibus contrasts on either all the variables found in the data, including the within-subjects factor if any,
or on a single effect specified in the <code>effect</code> argument.
<code>"all.pairwise"</code> stands for pairwise comparisons of the response(s) variable(s) over all combinations of values of one effect, indicated
in the <code>effect</code> parameter.
Defaults to <code>"omnibus"</code>.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_effect">effect</code></td>
<td>
<p>If <code>contrast = "omnibus"</code>, then <code>effect</code> must be a string or vector of strings with the name of the effect(s) for which the <code>"omnibus"</code> 
contrasts will be applied. 
If <code>contrast = "all.pairwise"</code>, then <code>effect</code> must be <em>a tagged list</em> in which the names are the factors, and the elements must be vectors of two strings
each, indicating 
If <code>contrast = "omnibus"</code> but <code>effect</code> is not specified, then an omnibus contrast will be done separately for each of the effects and also all possible interactions.
If <code>contrast = "omnibus"</code> and <code>effect</code> is a vector of strings, then only <em>one</em> contrast will be done, involving the simultaneous interaction of all effects
indicated in the <code>effect</code> vector (i.e. no other interaction or main effect contrasts will be performed).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_correction">correction</code></td>
<td>
<p>The type of p-value correction when applying multiple pariwise comparisons (i.e. when <code>contrast = "all.pairwise"</code>). Defaults to &quot;hochberg&quot;.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_trimming">trimming</code></td>
<td>
<p>Boolean to control the use of robust estimators. 
<code>FALSE</code> indicates the ADF test statistic will be computed with the usual Least-Squares Estimators. 
<code>TRUE</code> indicates that trimmed means and Winsorized variances/covariances will be used to compute the ADF test statistic.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_per">per</code></td>
<td>
<p>(Only if trimming is TRUE) The proportion of trimming in EACH tail of the data distribution. Must be between 
0 and .49 (i.e., 49% trimming in each tail). Recommended per = 0.2 symmetric trimming (i.e., 20% of the observations in each tail are trimmed).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Boolean; whether bootstrap should be used to compute a critical value for the test statistic produced by WJGLM. <code>FALSE</code> means a theoretical 
critical value for the test statistic TWJ/c (or TWJt/c) will be computed. <code>TRUE</code> indicates the non-parametric percentile bootstrap method 
will be used to compute a critical value. When combined with <code>contrast = "all.pairwise"</code>, then Family-Wise Error Rate (FWER) control is achieved using
bootstrapping to compute an adjusted empirical critical value (refer to Keselman, Wilcox &amp; Lix 2003, page 589 for details).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_numsim_b">numsim_b</code></td>
<td>
<p>If <code>bootstrap = TRUE</code>, this is a positive integer that defines the number of bootstrap samples to generate a critical 
value (defaults to 999).  Carpenter and Bithell (2000) recommend between 1000 and 2000 samples for setting confidence intervals around a 
parameter estimate, but Efron and Tibshirani (1986) note that for other applications of the bootstrap, such as computing the standard error, as 
few as 100 bootstrap samples will be sufficient. Choosing a value of B such that (B + 1)<code class="reqn">\alpha</code> is an integer value is recommended, because it 
avoids the need for interpolation.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_effect.size">effect.size</code></td>
<td>
<p>Boolean; whether effect size estimates should be computed. <code>TRUE</code> means effect size estimates together with its confidence intervals 
will be computed (defaults to FALSE).</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_numsim_es">numsim_es</code></td>
<td>
<p>Positive integer defining the number of bootstrap samples to generate a CI for the effect size estimate (defaults to 999). Ignored if <code>effect.size = FALSE</code>.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_scaling">scaling</code></td>
<td>
<p>Boolean; whether a scaling factor for the effect size estimator should be used (0.642 for 20% symmetric trimming) when 
robust estimators are adopted. <code>FALSE</code> means no scaling factor will be used. <code>TRUE</code> indicates that a scaling factor will be adopted. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_standardize.effsz">standardize.effsz</code></td>
<td>
<p>Boolean: whether the effect size should be standardized by the average of variances or not. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_alpha">alpha</code></td>
<td>
<p>Significance threshold for the confidence interval calculation, where 1 - <code>alpha</code> is the probability coverage. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="welchADF.test_+3A_seed">seed</code></td>
<td>
<p>Initial seed (positive integer) for the (R default) random number generator. Defaults to NULL (seed taken from the current time).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;welchADFt&quot; which is a list of lists (one sub-list per effect, even if there is only one).
There are methods <code><a href="#topic+print.welchADFt">print.welchADFt</a></code> and <code><a href="#topic+summary.welchADFt">summary.welchADFt</a></code>
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>formula</code>: Specialized method that accepts a formula
</p>
</li>
<li> <p><code>lm</code>: Specialized method that accepts a linear model object of class <code><a href="stats.html#topic+lm">lm</a></code>
</p>
</li>
<li> <p><code>aov</code>: Specialized method that accepts an Analysis of Variance Model of class <code><a href="stats.html#topic+aov">aov</a></code>
</p>
</li>
<li> <p><code>lmer</code>: Specialized method that accepts a Linear Mixed-Effects Model of class <code><a href="lme4.html#topic+lmer">lmer</a></code>
</p>
</li>
<li> <p><code>default</code>: Default method that accepts a data.frame (see argument <code>formula</code>) and where 
factors are passed as strings corresponding to column names
</p>
</li></ul>


<h3>References</h3>

<p>Villacorta, P.J. (2017). The welchADF Package for Robust Hypothesis Testing in Unbalanced Multivariate Mixed Models with Heteroscedastic and Non-normal Data. 
<em>The R Journal</em>, 9:2, 309 - 328.
</p>
<p>Website with the original SAS code and examples: <a href="http://supp.apa.org/psycarticles/supplemental/met_13_2_110/met_13_2_110_supp.html">http://supp.apa.org/psycarticles/supplemental/met_13_2_110/met_13_2_110_supp.html</a>
</p>
<p>Keselman, H. J., Wilcox, R. R., &amp; Lix, L. M. (2003). A generally robust approach to hypothesis testing in independent and correlated groups designs. 
<em>Psychophysiology</em>, 40, 586-596.
</p>
<p>Lix, L. M., &amp; Keselman, H. J. (1995). Approximate degrees of freedom tests: A unified perspective on testing for mean equality. 
<em>Psychological Bulletin</em>, 117, 547-560.
</p>
<p>Carpenter, J., &amp; Bithell, J. (2000). Bootstrap confidence intervals: When, which, what? A practical guide for medical statisticians. 
<em>Statistics in Medicine</em>, 19, 1141-1164.
</p>
<p>Efron, B., &amp; Tibshirani, R. (1986). Bootstrap methods for standard errors, confidence intervals, and other measures of statistical accuracy. 
<em>Statistical Science</em>, 1, 54-75.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.welchADFt">print.welchADFt</a></code>, <code><a href="#topic+summary.welchADFt">summary.welchADFt</a></code>
</p>
<p><code><a href="stats.html#topic+p.adjust.methods">p.adjust.methods</a></code> 
<code><a href="#topic+perceptionData">perceptionData</a></code>
<code><a href="#topic+adhdData">adhdData</a></code>
<code><a href="#topic+adhdData2">adhdData2</a></code>
<code><a href="#topic+womenStereotypeData">womenStereotypeData</a></code>
<code><a href="#topic+miceData">miceData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Omnibus contrast only of those effects included, namely condition and sex (no interaction)
omnibus_LSM_formula &lt;- welchADF.test(y ~ condition + sex, data = womenStereotypeData)
# Works well with update.default() method
omnibus_interact_formula &lt;- update(omnibus_LSM_formula, . ~ condition*sex)
summary(omnibus_LSM_formula)
summary(omnibus_interact_formula)

# Fit a linear model using the built-in function stats::lm
lm.women &lt;- lm(y ~ condition + sex, womenStereotypeData)

# Fit an Analysis of Variance model using the built-in function stats::aov
aov.women &lt;- aov(lm.women)

# Now use the this object to apply a welchADF test to the same formula and data
omnibus_no_interact &lt;- welchADF.test(lm.women, contrast = "omnibus")
omnibus_no_interactB &lt;- welchADF.test(aov.women) # omnibus as well

# Integrates well with the update.default() method
omnibus_interact &lt;- update(omnibus_no_interact, . ~ condition*sex)
summary(omnibus_no_interact)
summary(omnibus_interact)
# Two-way factorial design using the default interface. See the vignette.
omnibus_LSM &lt;- welchADF.test(womenStereotypeData, response = "y", between.s = 
  c("condition", "sex"), contrast = "omnibus")
# Method update() also works with the welchADF.test.default interface
omnibus_trimmed &lt;- update(omnibus_LSM, effect = "condition", trimming = TRUE)
pairwise_LSM &lt;- update(omnibus_LSM, contrast = "all.pairwise", effect = c("condition", "sex"))
pairwise_trimmed &lt;- update(pairwise_LSM, trimming = TRUE) # just trimming
summary(omnibus_LSM)
pairwise_LSM
## Not run: 
  pairwise_trimmed_boot &lt;- update(pairwise_trimmed, bootstrap = TRUE) # trimming and bootstrapping
  summary(pairwise_trimmed_boot)

## End(Not run)
</code></pre>

<hr>
<h2 id='womenStereotypeData'>Students' scores (men and women) on an arithmetic test</h2><span id='topic+womenStereotypeData'></span>

<h3>Description</h3>

<p>An artificial dataset created by Lix et al. from summary data presented by Wicherts et al. (2005)
(see the vignette). These authors examined the effects of stereotype threat on women's mathematics ability. 
Originally there were four different tests administered to study participants (arithmetic,
number series, word problems, and sums tests). The dataset contains only scores for the arithmetic test
because these scores exhibited a greater magnitude of variance heterogeneity than scores for
the other tests. It is an unbalanced design with cell sizes ranging from 45 to 50 participants, and a total
sample size of 283.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>womenStereotypeData
</code></pre>


<h3>Format</h3>

<p>A data frame with 283 rows and 3 variables:
</p>

<dl>
<dt>condition</dt><dd><p>test condition (control, nullified, stereotype threat)</p>
</dd>
<dt>sex</dt><dd><p>the individual's sex (male, female)</p>
</dd>
<dt>y</dt><dd><p>score on the arithmetic test, out of 40</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="http://supp.apa.org/psycarticles/supplemental/met_13_2_110/Example_2_Factorial_Independent_Groups_Design.pdf">http://supp.apa.org/psycarticles/supplemental/met_13_2_110/Example_2_Factorial_Independent_Groups_Design.pdf</a>
</p>


<h3>References</h3>

<p>J.Wicherts, C. Dolan, and D. Hessen. Stereotype threat and group differences in test performance: 
a question of measurement invariance. Journal of Personality and Social Psychology, 89(5):696-716, 2005.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>omnibus_LSM &lt;- welchADF.test(womenStereotypeData, response = "y", between.s =
  c("condition", "sex"), contrast = "omnibus", effect = "condition")
omnibus_trimmed &lt;- update(omnibus_LSM, trimming = TRUE, effect = NULL) # unset value of "effect"
pairwise_LSM &lt;- update(omnibus_LSM, contrast = "all.pairwise", effect = c("condition", "sex"))
pairwise_trimmed &lt;- update(pairwise_LSM, trimming = TRUE)
summary(omnibus_LSM)
summary(omnibus_trimmed)
summary(pairwise_trimmed)
## Not run: 
  pairwise_trimmed_boot &lt;- update(pairwise_trimmed, bootstrap = TRUE, seed = 12345)
  summary(pairwise_trimmed_boot)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
