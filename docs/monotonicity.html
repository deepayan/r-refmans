<!DOCTYPE html><html lang="en"><head><title>Help for package monotonicity</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {monotonicity}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#demo_returns'><p>Asset returns used in Ang, Chen and Xing (RFS, 2006), sorted into ten portfolios.</p></a></li>
<li><a href='#monoBonferroni'><p>Test of weak monotonicity using Bonferroni bounds</p></a></li>
<li><a href='#monoRelation'><p>Testing the monotonic relationship in asset returns</p></a></li>
<li><a href='#monoSummary'><p>Summary of Patton and Timmermann monotonicity (JoE, 2010) tests</p></a></li>
<li><a href='#monoUpDown'><p>Up and Down test</p></a></li>
<li><a href='#statBootstrap'><p>Stationary bootstrap method</p></a></li>
<li><a href='#wolak'><p>Testing inequality constraints in linear econometric models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Test for Monotonicity in Expected Asset Returns, Sorted by
Portfolios</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Siegfried Köstlmeier &lt;siegfried.koestlmeier@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Test for monotonicity in financial variables sorted by portfolios. It is conventional practice in empirical research to form portfolios of assets ranked by a certain sort variable. A t-test is then used to consider the mean return spread between the portfolios with the highest and lowest values of the sort variable. Yet comparing only the average returns on the top and bottom portfolios does not provide a sufficient way to test for a monotonic relation between expected returns and the sort variable. This package provides nonparametric tests for the full set of monotonic patterns by Patton, A. and Timmermann, A. (2010) &lt;<a href="https://doi.org/10.1016%2Fj.jfineco.2010.06.006">doi:10.1016/j.jfineco.2010.06.006</a>&gt; and compares the proposed results with extant alternatives such as t-tests, Bonferroni bounds, and multivariate inequality tests through empirical applications and simulations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/skoestlmeier/monotonicity">https://github.com/skoestlmeier/monotonicity</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>lmtest, MASS, sandwich, stats, methods, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, xts</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-05 13:02:27 UTC; LocalAdmin</td>
</tr>
<tr>
<td>Author:</td>
<td>Siegfried Köstlmeier
    <a href="https://orcid.org/0000-0002-7221-6981"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    trl]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-05 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='demo_returns'>Asset returns used in Ang, Chen and Xing (RFS, 2006), sorted into ten portfolios.</h2><span id='topic+demo_returns'></span>

<h3>Description</h3>

<p><code>demo_returns</code> is a sample of asset returns from July 1963 to December 2001 of all stocks listed on the NYSE and is computed as follows: at the begiinig of each month, tocks are sorted into deciles using estimates of beta based on the past year of daily returns, and value-weighted portfolios are formed. two tests from Wolak (1989, JoE) of inequality constraints in linear econometric models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(demo_returns)
</code></pre>


<h3>References</h3>

<p>Patton, A. and Timmermann, A. (2010):
Monotonicity in asset returns: New testes with applications to the term structure, the CAPM, and portfolio sorts.
<em>Journal of Financial Economics</em>, <b>98</b>, No. 3, p. 605&ndash;625.
doi: <a href="https://doi.org/10.1016/j.jfineco.2010.06.006">10.1016/j.jfineco.2010.06.006</a>.
</p>
<p>Ang, A., Chen, J. and Xing, Y. (2006):
Downside Risk. <em>Review of Financial Studies</em>, <b>19</b>, No. 4, p. 1191&ndash;1239.
doi: <a href="https://doi.org/10.1093/rfs/hhj035">10.1093/rfs/hhj035</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load demo data
data(demo_returns)

## calculate the mean difference return between the top and bottom portfolio
mean(demo_returns[, ncol(demo_returns)] - demo_returns[, 1])
</code></pre>

<hr>
<h2 id='monoBonferroni'>Test of weak monotonicity using Bonferroni bounds</h2><span id='topic+monoBonferroni'></span>

<h3>Description</h3>

<p><code>monoBonferroni</code> implements the test of weak monotonicity using Bonferroni bounds described in Patton &amp; Timmermann (2010, JFE):
<strong>Test 1:</strong>
<code class="reqn">H0*: d1 &gt;= 0, d2 &gt;= 0, ..., dK &gt;= 0</code>
vs.
<code class="reqn">H1*: dj &lt; 0  for some j=1,2,..,K</code>
</p>
<p><strong>Test 2:</strong>
<code class="reqn">H0**: d1 &lt;= 0, d2 &lt;= 0, ..., dK &lt;= 0</code>
vs.
<code class="reqn">H1**: dj &gt; 0  for some j=1,2,..,K.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monoBonferroni(data, difference = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monoBonferroni_+3A_data">data</code></td>
<td>
<p>an object of class <code>"<a href="base.html#topic+matrix">matrix</a>"</code> (or one that
can be coerced to that class): asset returns or differences in asset returns for the sorting application.</p>
</td></tr>
<tr><td><code id="monoBonferroni_+3A_difference">difference</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>data</code> is already differences in asset returns, use TRUE. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>monoBonferroni</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"list"</code>
</p>
<p>The returning list contains p-values (see Note) using Bonferroni-bounds for the
two statistical tests described above:
</p>
<table role = "presentation">
<tr><td><code>TestOnePvalBonferroni:</code></td>
<td>
<p>p-value for <code class="reqn">H0*</code> of Test 1.</p>
</td></tr>
<tr><td><code>TestTwoPvalBonferroni:</code></td>
<td>
<p>p-value for <code class="reqn">H0**</code> of Test 2.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The &quot;Bonferroni p-values&quot; are in the sense that we reject the null hypothesis if
they are less than the size of the test. NOTE of course that unlike usual
p-valuess these won't be uniformly distributed between <code class="reqn">0</code> and <code class="reqn">1</code> under the null hypothesis. In fact, they do not even
have to lie in [0,1] - they could be lesser than 0 or greater than 1. In such a case, <code>monoBonferroni</code> returns <code>min(pvalBonferroni, 1)</code> if <code class="reqn">pvalBonferroni &gt; 1</code> and <code>max(pvalBonferroni, 0)</code> if <code class="reqn">pvalBonferroni &lt; 1</code>.
</p>


<h3>References</h3>

<p>Patton, A. and Timmermann, A. (2010):
Monotonicity in asset returns: New testes with applications to the term structure, the CAPM, and portfolio sorts.
<em>Journal of Financial Economics</em>, <b>98</b>, No. 3, p. 605&ndash;625.
doi: <a href="https://doi.org/10.1016/j.jfineco.2010.06.006">10.1016/j.jfineco.2010.06.006</a>.
</p>
<p>Bonferroni, Carlo E. (1936):
Teoria statistica delle classi e calcolo delle probabillita.  [Statistical Class Theory and Calculation of Probability]<em>Pubbl. d. R. Ist. Super. di Sci. Econom. e Commerciali di Firenze</em>, <b>8</b>, p. 1&ndash;62.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load non-difference return data and calculate the p-value for H0* of Test 1.
data(demo_returns)
tmp &lt;- monoBonferroni(demo_returns, difference = FALSE)
tmp$TestOnePvalBonferroni
</code></pre>

<hr>
<h2 id='monoRelation'>Testing the monotonic relationship in asset returns</h2><span id='topic+monoRelation'></span>

<h3>Description</h3>

<p><code>monoRelation</code> implements the 'monotonic relationship' tests from Patton &amp; Timmermann (2010, JFE). We define <code class="reqn">\Delta_i = E[r_(i,t)] - E[r_(i-1,t)]</code> and test
</p>
<p><code class="reqn">H0: \Delta &lt;= 0</code>
</p>
<p>vs.
</p>
<p><code class="reqn">H1: min_(i = 1..N){\Delta_i} &gt; 0</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monoRelation(data, bootstrapRep = 1000, increasing = TRUE,
  difference = FALSE, block_length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monoRelation_+3A_data">data</code></td>
<td>
<p>an object of class <code>"<a href="base.html#topic+matrix">matrix</a>"</code> (or one that
can be coerced to that class): asset returns or differences in asset returns which are sorted in a maximum of 15 portfolios. Each column of the matrix 'data' represents a single portfolio. <code>data</code> is therefore limited to a 15 columns.</p>
</td></tr>
<tr><td><code id="monoRelation_+3A_bootstraprep">bootstrapRep</code></td>
<td>
<p>A numeric scalar: the number of used bootstrap samples.</p>
</td></tr>
<tr><td><code id="monoRelation_+3A_increasing">increasing</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: Assume an increasing or a decreasing pattern in monotonicity for the returns of the sorted portfolios.</p>
</td></tr>
<tr><td><code id="monoRelation_+3A_difference">difference</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>data</code> is already differences in asset returns, use TRUE. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
<tr><td><code id="monoRelation_+3A_block_length">block_length</code></td>
<td>
<p>A numeric scalar: The average length of the block to usefor the stationary bootstrap. This parameter is related to how much serial correlation is in your data. Use 10/6/3/2 as the block length if data is measured in daily/monthly/quarterly/annual returns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>monoRelation</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"matrix"</code>.
</p>
<p>The returning matrix consists of the following components:
</p>
<table role = "presentation">
<tr><td><code>matrix</code></td>
<td>
<p>a 4x2 matrix. The values of the first column are non-studentised, the values of the second column are studentised.
Row (1): the t-statistic associated with a t-test that <code class="reqn">\Delta_i &lt;= 0</code>
Row (2): the p-value associated with a t-test that <code class="reqn">\Delta_i &lt;= 0</code>
Row (3): the MR test p-value from the proposed test, based on adjacent portfolios
Row (4): the MR test p-value from the proposed test, on all pair-wise portfolio comparisons</p>
</td></tr>
</table>


<h3>References</h3>

<p>Patton, A. and Timmermann, A. (2010):
Monotonicity in asset returns: New testes with applications to the term structure, the CAPM, and portfolio sorts.
<em>Journal of Financial Economics</em>, <b>98</b>, No. 3, p. 605&ndash;625.
doi: <a href="https://doi.org/10.1016/j.jfineco.2010.06.006">10.1016/j.jfineco.2010.06.006</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load non-difference return data and apply test with daily returns.
data(demo_returns)
monoRelation(demo_returns, block_length = 10)
</code></pre>

<hr>
<h2 id='monoSummary'>Summary of Patton and Timmermann monotonicity (JoE, 2010) tests</h2><span id='topic+monoSummary'></span>

<h3>Description</h3>

<p><code>monoSummary</code> implements the test for monotonicity in asset returns, based on portfolio sorts in (JoE, 2010)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monoSummary(data, bootstrapRep = 1000, wolakRep = 100,
  increasing = TRUE, difference = FALSE, plot = FALSE, block_length, zero_treshold = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monoSummary_+3A_data">data</code></td>
<td>
<p>an object of class <code>"<a href="base.html#topic+matrix">matrix</a>"</code> (or one that
can be coerced to that class): asset returns or differences in asset returns which are sorted in a maximum of 15 portfolios. Each column of the matrix 'data' represents a single portfolio. <code>data</code> is therefore limited to a 15 columns.</p>
</td></tr>
<tr><td><code id="monoSummary_+3A_bootstraprep">bootstrapRep</code></td>
<td>
<p>A numeric scalar: the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="monoSummary_+3A_wolakrep">wolakRep</code></td>
<td>
<p>A numeric scalar, stating the number of simulations to use to estimate the weight function in the weighted-sum of chi-square variables.</p>
</td></tr>
<tr><td><code id="monoSummary_+3A_increasing">increasing</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: Assume an increasing or a decreasing pattern in monotonicity for the sorted portfolios.</p>
</td></tr>
<tr><td><code id="monoSummary_+3A_difference">difference</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>data</code> is already differences in asset returns, use TRUE. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
<tr><td><code id="monoSummary_+3A_plot">plot</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>plot</code> is TRUE, a plot is generated of the average returns on sorted portfolios with the p-value of the test on monotonicity from <code>monoRelation.R</code>. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
<tr><td><code id="monoSummary_+3A_block_length">block_length</code></td>
<td>
<p>A numeric scalar: The average length of the block to usefor the stationary bootstrap. This parameter is related to how much serial correlation is in your data. Use 10/6/3/2 as the block length if data is measured in daily/monthly/quarterly/annual returns.</p>
</td></tr>
<tr><td><code id="monoSummary_+3A_zero_treshold">zero_treshold</code></td>
<td>
<p>A numeric scalar, being the treshold for comparing solution values of a non-linear optimization in the Wolak (1989, JoE) test against zero. See section DETAILS for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, a non-linear optimization using <code>"<a href="stats.html#topic+constrOptim">constrOptim</a>"</code> is used for the Monte-Carlo simulation within the Wolak (1989, JoE) test. The resulting values of the solution are close to zero, but due to the used machine precision numerically differnt from zero. For this reason, we suggest a treshold value close to zero. The default value is <code class="reqn">1e-6</code>, so all resulting solutions smaller than the treshold value are treated as being zero. The default treshold value is consistent with the data-set and results of Patton and Timmermann (JoE, 2010). Of course, the appropriate treshold value can differ across applications (e.g. run the code on one set of data, and then the same data/100).
</p>


<h3>Value</h3>

<p><code>monoSummary</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"data.frame"</code>.
</p>
<p>The returning value of <code>"monoSummary"</code> is a <code>"data.frame"</code> containing the
following components:
</p>
<table role = "presentation">
<tr><td><code>TopMinusBottom</code></td>
<td>
<p>Mean difference return between top and bottom portfolio.</p>
</td></tr>
<tr><td><code>t_stat</code></td>
<td>
<p>the residuals, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>t_pval</code></td>
<td>
<p>the fitted mean values.</p>
</td></tr>
<tr><td><code>MR_pval</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>MRall_pval</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>UP_pval</code></td>
<td>
<p>studentized p-value from Patton and Timmermanns (JoE, 2010) &quot;Up and Down&quot; test for assumed increasing monotonicity pattern and using absolute difference returns.</p>
</td></tr>
<tr><td><code>DOWN_pval</code></td>
<td>
<p>studentized p-value from Patton and Timmermanns (JoE, 2010) &quot;Up and Down&quot; test for assumed decreasing monotonicity pattern and using absolute difference returns.</p>
</td></tr>
<tr><td><code>Wolak_pval</code></td>
<td>
<p>p-value &quot;TestOnePvalueWolak&quot; for <code class="reqn">H0*</code> of Test 1 in <code>wolak.R</code></p>
</td></tr>
<tr><td><code>Bonferroni_pval</code></td>
<td>
<p>p-value for <code class="reqn">H0*</code> of Test 1 from <code>monoBonferroni.R</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Patton, A. and Timmermann, A. (2010):
Monotonicity in asset returns: New testes with applications to the term structure, the CAPM, and portfolio sorts.
<em>Journal of Financial Economics</em>, <b>98</b>, No. 3, p. 605&ndash;625.
doi: <a href="https://doi.org/10.1016/j.jfineco.2010.06.006">10.1016/j.jfineco.2010.06.006</a>.
</p>
<p>Wolak, Frank A. (1989):
Testing Inequality Constraints in Linear Econometric Models.
<em>Journal of Econometrics</em>, <b>41</b>, p. 205&ndash;235.
doi: <a href="https://doi.org/10.1016/0304-4076(89)90094-8">10.1016/0304-4076(89)90094-8</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monoRelation">monoRelation</a></code>,
<code><a href="#topic+monoUpDown">monoUpDown</a></code>,
<code><a href="#topic+wolak">wolak</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load daily non-difference return data.
## test an increasing pattern of monotonicity

data(demo_returns)
monoSummary(demo_returns, increasing = TRUE, block_length = 10)

</code></pre>

<hr>
<h2 id='monoUpDown'>Up and Down test</h2><span id='topic+monoUpDown'></span>

<h3>Description</h3>

<p><code>monoUpDown</code> implements the 'Up and Down' tests from Patton &amp; Timmermann (2010, JFE) based on:
</p>
<p>(1) sum of squared differences for positive diffs and negative diffs,
(2) sum of absolute differences for positive diffs and negative diffs,
</p>
<p>and uses the stationary bootstrap method from Politis &amp; Romano (1994, JASA).</p>


<h3>Usage</h3>

<pre><code class='language-R'>monoUpDown(data, difference = FALSE, bootstrapRep = 1000, block_length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monoUpDown_+3A_data">data</code></td>
<td>
<p>an object of class <code>"<a href="base.html#topic+matrix">matrix</a>"</code> (or one that
can be coerced to that class): asset returns or differences in asset returns which are sorted in a maximum of 15 portfolios. Each column of the matrix 'data' represents a single portfolio. <code>data</code> is therefore limited to a 15 columns.</p>
</td></tr>
<tr><td><code id="monoUpDown_+3A_difference">difference</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>data</code> is already differences in asset returns, use TRUE. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
<tr><td><code id="monoUpDown_+3A_bootstraprep">bootstrapRep</code></td>
<td>
<p>A numeric scalar: the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="monoUpDown_+3A_block_length">block_length</code></td>
<td>
<p>A numeric scalar: The average length of the block to usefor the stationary bootstrap. This parameter is related to how much serial correlation is in your data. Use 10/6/3/2 as the block length if data is measured in daily/monthly/quarterly/annual returns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>monoUpDown</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"matrix"</code>:
</p>
<table role = "presentation">
<tr><td><code>"matrix":</code></td>
<td>
<p>A named 4x2 matrix with the bootstrap p-values from a test for a  monotonic relationship. The first row contains p-values for squared diffs in an assumed increasing monotonic pattern, the second row respectively for a decreasing pattern. The third row contains p-values for absolute differences in an assumed increasing monotonic pattern, the fourth row respectively for a decreasing pattern. The first column gives p-values which are not studentised, the second column the equivalent studentised p-values.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Patton, A. and Timmermann, A. (2010):
Monotonicity in asset returns: New testes with applications to the term structure, the CAPM, and portfolio sorts.
<em>Journal of Financial Economics</em>, <b>98</b>, No. 3, p. 605&ndash;625.
doi: <a href="https://doi.org/10.1016/j.jfineco.2010.06.006">10.1016/j.jfineco.2010.06.006</a>.
</p>
<p>Wolak, Frank A. (1989):
Testing Inequality Constraints in Linear Econometric Models.
<em>Journal of Econometrics</em>, <b>41</b>, p. 205&ndash;235.
doi: <a href="https://doi.org/10.1016/0304-4076(89)90094-8">10.1016/0304-4076(89)90094-8</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load demo data and apply monoUpDown with daily data, which are not yet in differences
data(demo_returns)
test &lt;- monoUpDown(demo_returns,block_length = 10)
</code></pre>

<hr>
<h2 id='statBootstrap'>Stationary bootstrap method</h2><span id='topic+statBootstrap'></span>

<h3>Description</h3>

<p><code>statBootstrap</code> implements the stationary bootstrap method from Politis &amp; Romano (1994, JASA). This function generates bootstrap samples of the matrix data and returns the time indices for each sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statBootstrap(T, bootstrapRep = 1000, block_length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="statBootstrap_+3A_t">T</code></td>
<td>
<p>A scalar, the number of time series observations to generate.</p>
</td></tr>
<tr><td><code id="statBootstrap_+3A_bootstraprep">bootstrapRep</code></td>
<td>
<p>A numeric scalar: the number of used bootstrap samples.</p>
</td></tr>
<tr><td><code id="statBootstrap_+3A_block_length">block_length</code></td>
<td>
<p>A numeric scalar: The average length of the block to usefor the stationary bootstrap. This parameter is related to how much serial correlation is in your data. Use 10/6/3/2 as the block length if data is measured in daily/monthly/quarterly/annual returns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>statBootstrap</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"matrix"</code>:
</p>
<table role = "presentation">
<tr><td><code>"matrix":</code></td>
<td>
<p>A &quot;T x bootstrapRep&quot; matrix of time indices for each bootstrap sample.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Politis, Dimitris N. &amp; Romano, Joseph P. (1994): The Stationary Bootstrap. <em>Journal of The American Statistical Association</em>,
<b>89</b>, No. 428, p. 1303&ndash;1313. doi: <a href="https://doi.org/10.1080/01621459.1994.10476870">10.1080/01621459.1994.10476870</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Assuming daily return data for 100 time series observations.
## The returning matrix for default settings contains 1,000 bootstrap samples.
bootstrap_sample &lt;- statBootstrap(T = 100, block_length = 10)

## 200 bootstrap samples using monthly return data with 250 time series observations.
bootstrap_sample &lt;- statBootstrap(T = 250, bootstrapRep = 200, block_length = 6)
</code></pre>

<hr>
<h2 id='wolak'>Testing inequality constraints in linear econometric models</h2><span id='topic+wolak'></span>

<h3>Description</h3>

<p><code>wolak</code> implements two tests from Wolak (1989, JoE) of inequality constraints in linear econometric models.
</p>
<p><strong>Test 1:</strong>
<code class="reqn">H0*: d1 &gt;= 0, d2 &gt;= 0, ..., dK &gt;= 0</code>
vs.
<code class="reqn">H1*: (d1, d2, ..., dK) in R^K, (ie: general alternative)</code>
</p>
<p><strong>Test 2:</strong>
<code class="reqn">H0**: d1 = d2 = ... = dK = 0</code>
vs.
<code class="reqn">H1**: d1 &gt; 0, d2 &gt; 0, ..., dK &gt; 0.</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wolak(data, increasing = TRUE, difference = FALSE, wolakRep = 100, zero_treshold = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wolak_+3A_data">data</code></td>
<td>
<p>an object of class <code>"<a href="base.html#topic+matrix">matrix</a>"</code> (or one that
can be coerced to that class): asset returns or differences in asset returns for the sorting application.</p>
</td></tr>
<tr><td><code id="wolak_+3A_increasing">increasing</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: Assume an increasing or a decreasing pattern in monotonicity for the sorted portfolios. If a decreasing pattern is assumed, then <code class="reqn">H0*</code> of Test 1 changes to <code class="reqn">H0*: d1 &lt;= 0, d2 &lt;= 0, ..., dK &lt;= 0</code> and respectively <code class="reqn">H1**</code> of Test 2 changes to <code class="reqn">H1**: d1 &lt; 0, d2 &lt; 0, ..., dK &lt; 0.</code></p>
</td></tr>
<tr><td><code id="wolak_+3A_difference">difference</code></td>
<td>
<p>An object of class <code>"<a href="base.html#topic+logical">logical</a>"</code>: If <code>data</code> is already differences in asset returns, use TRUE. Otherwise <code>data</code> will be transformed to difference returns <code class="reqn">r_p(n+1) - r_p(n)</code> between portfolio <code class="reqn">n+1 </code> and portfolio <code class="reqn">n</code></p>
</td></tr>
<tr><td><code id="wolak_+3A_wolakrep">wolakRep</code></td>
<td>
<p>A numeric scalar, stating the number of simulations to use to estimate the weight function in the weighted-sum of chi-square variables.</p>
</td></tr>
<tr><td><code id="wolak_+3A_zero_treshold">zero_treshold</code></td>
<td>
<p>A numeric scalar, being the treshold for comparing solution values of a non-linear optimization against zero. See section DETAILS for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently supported as input type of <code>data</code> are classes <code>"<a href="base.html#topic+matrix">matrix</a>"</code>,
<code>"<a href="base.html#topic+data.frame">data.frame</a>"</code>, <code>ts</code>, <code>xts</code> and <code>zoo</code>.
</p>
<p>Using demo data shows for <code>wolakRep</code>, that results do not change much at all for 100 or 1000 simulations, but the running time dramatically increases with the number of simulations. However, for robust results a minimum of 100 runs is highly recommended.
</p>
<p>Internally, a non-linear optimization using <code>"<a href="stats.html#topic+constrOptim">constrOptim</a>"</code> is used for the Monte-Carlo simulation. The resulting values of the solution are close to zero, but due to the used machine precision numerically differnt from zero. For this reason, we suggest a treshold value close to zero. The default value is <code class="reqn">1e-6</code>, so all resulting solutions smaller than the treshold value are treated as being zero. The default treshold value is consistent with the data-set and results of Patton and Timmermann (JoE, 2010). Of course, the appropriate treshold value can differ across applications (e.g. run the code on one set of data, and then the same data/100).
</p>
<p>The HAC estimator of the covariance matrix of follows the adjustment of Newey-West (1987, 1994).
The kernel used is &quot;Bartlett&quot;. See <code><a href="sandwich.html#topic+NeweyWest">NeweyWest</a></code> for further information.
</p>


<h3>Value</h3>

<p><code>wolak</code> returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"list"</code>.
</p>
<p>The returning list contains p-values for the
following components:
</p>
<table role = "presentation">
<tr><td><code>TestOnePvalueWolak:</code></td>
<td>
<p>p-value for <code class="reqn">H0*</code> of Test 1.</p>
</td></tr>
<tr><td><code>TestTwoPvalueWolak:</code></td>
<td>
<p>p-value for <code class="reqn">H0**</code> of Test 2.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wolak, Frank A. (1989):
Testing Inequality Constraints in Linear Econometric Models.
<em>Journal of Econometrics</em>, <b>41</b>, p. 205&ndash;235.
doi: <a href="https://doi.org/10.1016/0304-4076(89)90094-8">10.1016/0304-4076(89)90094-8</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load demo data and apply Wolak tests

data(demo_returns)
tmp &lt;- wolak(demo_returns)
tmp$TestOnePvalueWolak

## transform existing data (asset returns) into difference returns before applying wolak()
## as data is finally in difference returns, appy wolak() with difference = TRUE


data &lt;- demo_returns[, 2:ncol(demo_returns)] - (demo_returns[, 1:(ncol(demo_returns) - 1)])
wolak(data, difference = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
