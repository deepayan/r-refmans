<!DOCTYPE html><html><head><title>Help for package mixl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#av_matrix'><p>Extract the availabilites matrix from the dataset, using column indicies</p></a></li>
<li><a href='#check_draw_inputs'><p>Check the inputs to the draw function</p></a></li>
<li><a href='#check_inputs'><p>Check the inputs to the estimate function</p></a></li>
<li><a href='#compileUtilityFunction'><p>compileUtilityFunction</p>
Deprecated, please see <code>specify_model()</code></a></li>
<li><a href='#create_halton_draws'><p>Create a standard set of Halton draws to use in estimation</p></a></li>
<li><a href='#estimate'><p>Runs a maximum likelihood estimation on a mixl choice model</p></a></li>
<li><a href='#extract_av_cols'><p>Extract the availabilites matrix from the dataset using a column name prefix</p></a></li>
<li><a href='#extract_indiv_data'><p>Extract the individual level data from the dataset for use in posterior analysis</p></a></li>
<li><a href='#generate_default_availabilities'><p>Generate a ones-matrix of availabilities</p></a></li>
<li><a href='#mixl-package'>
<p>Estimate mixed multinomial logit models</p></a></li>
<li><a href='#posteriors'><p>Calculate the posteriors for a specified and estimated model</p></a></li>
<li><a href='#print.mixl'><p>Prints the output of a model</p></a></li>
<li><a href='#print.summary.mixl'><p>Print a model summary</p></a></li>
<li><a href='#probabilities'><p>Calculate the probabilities for a specified and estimated model.</p>
Note that if new data or draws are provided, the model will not be re-estimated</a></li>
<li><a href='#specify_model'><p>Validate the utility functions against the dataset and generate the optimised logliklihood function</p></a></li>
<li><a href='#summary_tex'><p>Return tex formatted output of a model summary. If an output_file parameter is provided, save the object to that location</p></a></li>
<li><a href='#summary.mixl'><p>Create a model summary</p></a></li>
<li><a href='#utilities'><p>Return the the utilities for a set of coefficients</p></a></li>
<li><a href='#vcov.mixl'><p>Calculates the Variance-Covariance Matrix of the mixl summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulated Maximum Likelihood Estimation of Mixed Logit Models
for Large Datasets</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Specification and estimation of multinomial logit
    models.  Large datasets and complex models are supported, with an
    intuitive syntax.  Multinomial Logit Models, Mixed models, random
    coefficients and Hybrid Choice are all supported.  For more
    information, see Molloy et al. (2021) <a href="https://www.research-collection.ethz.ch/handle/20.500.11850/477416">https://www.research-collection.ethz.ch/handle/20.500.11850/477416</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/joemolloy/fast-mixed-mnl">https://github.com/joemolloy/fast-mixed-mnl</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/joemolloy/fast-mixed-mnl/issues">https://github.com/joemolloy/fast-mixed-mnl/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>maxLik, numDeriv, randtoolbox, Rcpp (&ge; 0.12.19), readr,
sandwich, stats, stringr (&ge; 1.3.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, mlogit, rmarkdown, testthat, texreg, xtable</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-06 09:50:53 UTC; joemolloy</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Molloy [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Molloy &lt;joe.m34@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-07 12:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='av_matrix'>Extract the availabilites matrix from the dataset, using column indicies</h2><span id='topic+av_matrix'></span>

<h3>Description</h3>

<p>Extract the availabilites matrix from the dataset, using column indicies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>av_matrix(data, av_cols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="av_matrix_+3A_data">data</code></td>
<td>
<p>The dataset used in the model</p>
</td></tr>
<tr><td><code id="av_matrix_+3A_av_cols">av_cols</code></td>
<td>
<p>A vector of the the column indicies of the availabilities for each alternative</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of availabilities for alternatives and the number of choice observations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Train", package="mlogit")
Train$ID &lt;- Train$id
Train$CHOICE &lt;- as.numeric(Train$choice)
Train$avail_A &lt;- sample(2, replace=TRUE, size=nrow(Train))-1
Train$avail_B &lt;- sample(2, replace=TRUE, size=nrow(Train))-1
av_matrix(Train, c('avail_A', 'avail_B'))
</code></pre>

<hr>
<h2 id='check_draw_inputs'>Check the inputs to the draw function</h2><span id='topic+check_draw_inputs'></span>

<h3>Description</h3>

<p>Check the inputs to the draw function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_draw_inputs(draws, nDraws, draw_dimensions, Nindividuals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_draw_inputs_+3A_draws">draws</code></td>
<td>
<p>The specified Model</p>
</td></tr>
<tr><td><code id="check_draw_inputs_+3A_ndraws">nDraws</code></td>
<td>
<p>Named vector of proposed start values for the model</p>
</td></tr>
<tr><td><code id="check_draw_inputs_+3A_draw_dimensions">draw_dimensions</code></td>
<td>
<p>the dataset on which to estimate</p>
</td></tr>
<tr><td><code id="check_draw_inputs_+3A_nindividuals">Nindividuals</code></td>
<td>
<p>The availabilities for the alternatives in the model specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consisting of the checked draws and Ndraws, both computed if required)
</p>

<hr>
<h2 id='check_inputs'>Check the inputs to the estimate function</h2><span id='topic+check_inputs'></span>

<h3>Description</h3>

<p>This function checks the start_vlaues, data, availabilities, draws and fixedparams for validity.
If this function runs without error, then the inputs are valid for the maxLikelihood function.
These checks are important, because an error in the internal C++ code will cause the Rstudio session to crash.
Incidentally, if there is concern of this happening, it is recommended to run the script from the
command line, using Rscript.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_inputs(
  model_spec,
  start_values,
  data,
  availabilities,
  draws,
  fixedparam,
  weights
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_inputs_+3A_model_spec">model_spec</code></td>
<td>
<p>The specified Model</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_start_values">start_values</code></td>
<td>
<p>Named vector of proposed start values for the model</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_data">data</code></td>
<td>
<p>the dataset on which to estimate</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_availabilities">availabilities</code></td>
<td>
<p>The availabilities for the alternatives in the model specification</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_draws">draws</code></td>
<td>
<p>The matrix of random draws</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_fixedparam">fixedparam</code></td>
<td>
<p>Named vector of parameters to be fixed</p>
</td></tr>
<tr><td><code id="check_inputs_+3A_weights">weights</code></td>
<td>
<p>The weights vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='compileUtilityFunction'>compileUtilityFunction
Deprecated, please see <code><a href="#topic+specify_model">specify_model()</a></code></h2><span id='topic+compileUtilityFunction'></span>

<h3>Description</h3>

<p>compileUtilityFunction
Deprecated, please see <code><a href="#topic+specify_model">specify_model()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compileUtilityFunction(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compileUtilityFunction_+3A_...">...</code></td>
<td>
<p>Parameters to specify_model</p>
</td></tr>
</table>

<hr>
<h2 id='create_halton_draws'>Create a standard set of Halton draws to use in estimation</h2><span id='topic+create_halton_draws'></span>

<h3>Description</h3>

<p>Create a standard set of Halton draws to use in estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_halton_draws(Nindividuals, nDraws, draw_dimensions)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_halton_draws_+3A_nindividuals">Nindividuals</code></td>
<td>
<p>The number individuals in the dataset</p>
</td></tr>
<tr><td><code id="create_halton_draws_+3A_ndraws">nDraws</code></td>
<td>
<p>The number of draws needed</p>
</td></tr>
<tr><td><code id="create_halton_draws_+3A_draw_dimensions">draw_dimensions</code></td>
<td>
<p>the number of draw dimensions needed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of availabilities for alternatives and the number of choice observations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_halton_draws(100, 10, 5)
create_halton_draws(100, 100, 20)

</code></pre>

<hr>
<h2 id='estimate'>Runs a maximum likelihood estimation on a mixl choice model</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p>This function performs a maximum likelihood estimation for choice models speficied using this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(
  model_spec,
  start_values,
  data,
  availabilities,
  draws,
  nDraws,
  fixedparam = c(),
  num_threads = 1,
  weights = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_+3A_model_spec">model_spec</code></td>
<td>
<p>The object that contains the loglikelihood function and other
variables that help return better error messages. This function is best generated using the
<code><a href="#topic+specify_model">specify_model()</a></code> function.</p>
</td></tr>
<tr><td><code id="estimate_+3A_start_values">start_values</code></td>
<td>
<p>A named vector of start values for the estimation.
A warning and error will be given respectively if to many values are included or some are missing.</p>
</td></tr>
<tr><td><code id="estimate_+3A_data">data</code></td>
<td>
<p>A dataframe of the observations. It must include The columns CHOICE and ID, as well as
columns for the variables specified in the utility function. The CHOICE variable must be from 1..k,
where k is the number of  utility functions</p>
</td></tr>
<tr><td><code id="estimate_+3A_availabilities">availabilities</code></td>
<td>
<p>A 1/0 matrix of availabilities. The dimensions must be <code>nrows(data) * k</code>, where there are k utility functions.</p>
</td></tr>
<tr><td><code id="estimate_+3A_draws">draws</code></td>
<td>
<p>A numeric matrix of draws for calculating mixed effects. If there no mixed effects, this should be left null.
If the model specification included mixed effects, either this or <code>nDraws</code> need to be specified.</p>
</td></tr>
<tr><td><code id="estimate_+3A_ndraws">nDraws</code></td>
<td>
<p>The number of draws to use in estimating a mixed model.
Only needed if <code>draws</code> is left null. Then a matrix of normal halton draws will be generated.</p>
</td></tr>
<tr><td><code id="estimate_+3A_fixedparam">fixedparam</code></td>
<td>
<p>(optional) Coefficients which should be fixed to their starting values during estimation.</p>
</td></tr>
<tr><td><code id="estimate_+3A_num_threads">num_threads</code></td>
<td>
<p>The maximum number of parallel cores to use in estimation. The default is 1.
This should only be speficied on machines with an openMP compiler (linux and some OSXs).</p>
</td></tr>
<tr><td><code id="estimate_+3A_weights">weights</code></td>
<td>
<p>(optional) A vector of weights (vector length must equal the number of observations).</p>
</td></tr>
<tr><td><code id="estimate_+3A_...">...</code></td>
<td>
<p>futher arguments. such as control are passed to the maximisaiton routine in maxLik.
See <code><a href="maxLik.html#topic+maxLik">maxLik::maxLik()</a></code> for more details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a wrapper for the maxLik function in the maxLik package.
And additional arguments can be passed through to this function if required.
</p>


<h3>Value</h3>

<p>a mixl object that contains the results of the estimation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions)

	model &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model)

</code></pre>

<hr>
<h2 id='extract_av_cols'>Extract the availabilites matrix from the dataset using a column name prefix</h2><span id='topic+extract_av_cols'></span>

<h3>Description</h3>

<p>Extract the availabilites matrix from the dataset using a column name prefix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_av_cols(data, prefix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_av_cols_+3A_data">data</code></td>
<td>
<p>The dataset used in the model</p>
</td></tr>
<tr><td><code id="extract_av_cols_+3A_prefix">prefix</code></td>
<td>
<p>The prefix of the availability columns, i.e. avail_</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of availabilities for alternatives and the number of choice observations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Train", package="mlogit")
Train$ID &lt;- Train$id
Train$CHOICE &lt;- as.numeric(Train$choice)
Train$avail_A &lt;- sample(2, replace=TRUE, size=nrow(Train))-1
Train$avail_B &lt;- sample(2, replace=TRUE, size=nrow(Train))-1
extract_av_cols(Train, 'avail_')
</code></pre>

<hr>
<h2 id='extract_indiv_data'>Extract the individual level data from the dataset for use in posterior analysis</h2><span id='topic+extract_indiv_data'></span>

<h3>Description</h3>

<p>Extract the individual level data from the dataset for use in posterior analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_indiv_data(data, data_cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_indiv_data_+3A_data">data</code></td>
<td>
<p>The dataset</p>
</td></tr>
<tr><td><code id="extract_indiv_data_+3A_data_cols">data_cols</code></td>
<td>
<p>The individual level columns of attributes - Can be null to take aggregate for each column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of all individual level data for each ID
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Train", package="mlogit")
Train$ID &lt;- Train$id
Train$CHOICE &lt;- as.numeric(Train$choice)
#in this case not actually individual data columns 
#an ID column is required here
extract_indiv_data(Train, c('comfort_A', 'comfort_B'))
</code></pre>

<hr>
<h2 id='generate_default_availabilities'>Generate a ones-matrix of availabilities</h2><span id='topic+generate_default_availabilities'></span>

<h3>Description</h3>

<p>Generate a ones-matrix of availabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_default_availabilities(data, num_utility_functions)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_default_availabilities_+3A_data">data</code></td>
<td>
<p>The dataset used in the model</p>
</td></tr>
<tr><td><code id="generate_default_availabilities_+3A_num_utility_functions">num_utility_functions</code></td>
<td>
<p>the number of alternatives in the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Ones-matrix of availabilities for alternatives and the number of choice observations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Train", package="mlogit")
Train$ID &lt;- Train$id
Train$CHOICE &lt;- as.numeric(Train$choice)
generate_default_availabilities(Train, 5)
</code></pre>

<hr>
<h2 id='mixl-package'>
Estimate mixed multinomial logit models
</h2><span id='topic+mixl-package'></span><span id='topic+mixl'></span>

<h3>Description</h3>

<p>Estimate mixed multinomial logit models using (simulated) maximum likelihood estimation. 
The package supports standard mnl, mixed-logit and hybrid choice. Using compilation to C++,
model estimation is significantly faster than in native R code.
</p>


<h3>Details</h3>

<p>This section should provide a more detailed overview of how to use the
package, including the most important functions.
</p>


<h3>Author(s)</h3>

<p>Joe Molloy &lt;joseph.molloy@ivt.baug.ethz.ch&gt;.
</p>


<h3>References</h3>

<p>Molloy, J., Becker, F., Schmid, B., &amp; Axhausen, K. W. (2021). mixl: An open-source R package for estimating complex choice models on large datasets. Journal of choice modelling, 39, 100284.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  
  data("Train", package="mlogit")
  head(Train, 3)
  Train$ID &lt;- Train$id
  Train$CHOICE &lt;- as.numeric(Train$choice)

  mnl_test &lt;- "
    ASC_B_RND 	= @ASC_B 	+ draw_2 * @SIGMA_B;

    U_A =             @B_price * $price_A / 1000 + @B_time * $time_A / 60 + @B_change * $change_A; 
    U_B = ASC_B_RND + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
  "
  
  model_spec &lt;- mixl::specify_model(mnl_test, Train)
  
  #only take starting values that are needed
  est &lt;- stats::setNames(c(0,0,0,0,0,0), c("B_price", "B_time", "B_timeB", 
  "B_change", "ASC_B", "SIGMA_B"))
  
  availabilities &lt;- mixl::generate_default_availabilities(Train, model_spec$num_utility_functions)
  
  model &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities, nDraws = 20)  
  
  summary(model)
  
</code></pre>

<hr>
<h2 id='posteriors'>Calculate the posteriors for a specified and estimated model</h2><span id='topic+posteriors'></span>

<h3>Description</h3>

<p>Calculate the posteriors for a specified and estimated model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posteriors(model, indiv_data, code_output_file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posteriors_+3A_model">model</code></td>
<td>
<p>The estimated Model</p>
</td></tr>
<tr><td><code id="posteriors_+3A_indiv_data">indiv_data</code></td>
<td>
<p>Alternative individual data to use insteaf of that in the dataset</p>
</td></tr>
<tr><td><code id="posteriors_+3A_code_output_file">code_output_file</code></td>
<td>
<p>An (optional) location where the compiled code should be saved (useful for debugging</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe of individual-level posteriors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	mnl_test &lt;- "
	      ASC_A_RND = @ASC_A + draw_1 * @SIGMA_A1 + draw_7 * @SIGMA_A2;
	      ASC_B_RND = @ASC_B + draw_2 * @SIGMA_B;

	      U_A = ASC_A_RND + @B_price * $price_A / 1000 
	      		+ @B_time * $time_A / 60 + @B_change * $change_A; 
	      U_B = ASC_B_RND + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	    "

	#only take starting values that are needed
	est &lt;- stats::setNames(c(-1059.69729,  -181.27796,  -251.78909,  
							 -241.18878,   -86.77386, -173.09451,   
							  291.02618,   142.71793,   332.60909)
	    , c("B_price", "B_time", "B_timeB", "B_change", 
	    	"ASC_A", "ASC_B", "SIGMA_A1", "SIGMA_A2", "SIGMA_B"))

	availabilities &lt;- generate_default_availabilities(Train, 2)

	model_specification &lt;- specify_model(mnl_test, Train, disable_multicore=T)
	model &lt;- estimate(model_specification, est, Train,
			availabilities = availabilities, nDraws = 1)

	posteriors(model)

</code></pre>

<hr>
<h2 id='print.mixl'>Prints the output of a model</h2><span id='topic+print.mixl'></span>

<h3>Description</h3>

<p><code><a href="base.html#topic+print">print()</a></code> is an S3 method for the mixl class.
It creates a model summary and then prints the result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mixl_+3A_x">x</code></td>
<td>
<p>The model to print</p>
</td></tr>
<tr><td><code id="print.mixl_+3A_...">...</code></td>
<td>
<p>Options to pass to print</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions
	)

	model2 &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model2)

</code></pre>

<hr>
<h2 id='print.summary.mixl'>Print a model summary</h2><span id='topic+print.summary.mixl'></span>

<h3>Description</h3>

<p><code><a href="base.html#topic+print">print()</a></code> is an S3 method for the summary.mixl class, the output of a model plus goodness of fit metrics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.mixl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.mixl_+3A_x">x</code></td>
<td>
<p>The summary to print.</p>
</td></tr>
<tr><td><code id="print.summary.mixl_+3A_...">...</code></td>
<td>
<p>Options to pass to print.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions
	)

	model2 &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model2)

</code></pre>

<hr>
<h2 id='probabilities'>Calculate the probabilities for a specified and estimated model.
Note that if new data or draws are provided, the model will not be re-estimated</h2><span id='topic+probabilities'></span>

<h3>Description</h3>

<p>Calculate the probabilities for a specified and estimated model.
Note that if new data or draws are provided, the model will not be re-estimated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probabilities(
  model,
  data = NULL,
  availabilities = NULL,
  draws = NULL,
  nDraws = NULL,
  num_threads = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probabilities_+3A_model">model</code></td>
<td>
<p>The estimated Model</p>
</td></tr>
<tr><td><code id="probabilities_+3A_data">data</code></td>
<td>
<p>(Optional) New data to use instead of that in the dataset</p>
</td></tr>
<tr><td><code id="probabilities_+3A_availabilities">availabilities</code></td>
<td>
<p>(Optional) New availabilites to use</p>
</td></tr>
<tr><td><code id="probabilities_+3A_draws">draws</code></td>
<td>
<p>(Optional) Optional new set of random draws to use</p>
</td></tr>
<tr><td><code id="probabilities_+3A_ndraws">nDraws</code></td>
<td>
<p>(Optional) Optional new number of random draws to use</p>
</td></tr>
<tr><td><code id="probabilities_+3A_num_threads">num_threads</code></td>
<td>
<p>Enable parallel computing where available using this many cores</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe of individual-level posteriors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions
	)

	model &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	probabilities(model)

	#hypothetical scenario where the travel time of option A doubles
	Train$time_A = Train$time_A * 2
	probabilities(model, Train)

</code></pre>

<hr>
<h2 id='specify_model'>Validate the utility functions against the dataset and generate the optimised logliklihood function</h2><span id='topic+specify_model'></span>

<h3>Description</h3>

<p>This function takes a utility function description, and generates a optimised C++ version
of the utility function which can be called from R. If the data_names are provided, then the variables
in the function are checked against those provided. If an <code>output_file</code> is provided, the C++ code is saved there.
See the user guide vignette for how to write valid utility scripts. There is some minimal specific syntax required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specify_model(
  utility_script,
  dataset = NULL,
  output_file = NULL,
  compile = TRUE,
  model_name = "mixl_model",
  disable_multicore = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="specify_model_+3A_utility_script">utility_script</code></td>
<td>
<p>The utility script to be compiled</p>
</td></tr>
<tr><td><code id="specify_model_+3A_dataset">dataset</code></td>
<td>
<p>An (optional) dataframe to check if the all the variables are present</p>
</td></tr>
<tr><td><code id="specify_model_+3A_output_file">output_file</code></td>
<td>
<p>An (optional) location where the compiled code should be saved (useful for debugging</p>
</td></tr>
<tr><td><code id="specify_model_+3A_compile">compile</code></td>
<td>
<p>If compile is false, then the code will not be compiled, but just validated and saved if an <code>output_file</code> is specified. Default is true.</p>
</td></tr>
<tr><td><code id="specify_model_+3A_model_name">model_name</code></td>
<td>
<p>A name for the model, which will be used for saving. Defaults to <em>mixl_model</em></p>
</td></tr>
<tr><td><code id="specify_model_+3A_disable_multicore">disable_multicore</code></td>
<td>
<p>Depreciated and not used. Mutlicore is now autodetected</p>
</td></tr>
<tr><td><code id="specify_model_+3A_...">...</code></td>
<td>
<p>Further parameters to pass to <a href="Rcpp.html#topic+sourceCpp">sourceCpp</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>object</code> which contains the loglikelihood function, and information from the compile process
</p>


<h3>See Also</h3>

<p>browseVignettes(&quot;mixl&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions)

	model &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model)

</code></pre>

<hr>
<h2 id='summary_tex'>Return tex formatted output of a model summary. If an output_file parameter is provided, save the object to that location</h2><span id='topic+summary_tex'></span>

<h3>Description</h3>

<p>Return tex formatted output of a model summary. If an output_file parameter is provided, save the object to that location
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_tex(model_summary, output_file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_tex_+3A_model_summary">model_summary</code></td>
<td>
<p>A summary of an estimated Model</p>
</td></tr>
<tr><td><code id="summary_tex_+3A_output_file">output_file</code></td>
<td>
<p>Where to save the tex representation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted texreg object containing the latex table suitable for a research paper. See <a href="texreg.html#topic+createTexreg">createTexreg</a>
</p>

<hr>
<h2 id='summary.mixl'>Create a model summary</h2><span id='topic+summary.mixl'></span>

<h3>Description</h3>

<p><code><a href="base.html#topic+summary">summary()</a></code> is an S3 method for the class mixl, which adds metrics of goodness of fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixl'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mixl_+3A_object">object</code></td>
<td>
<p>The mixl output to summarize.</p>
</td></tr>
<tr><td><code id="summary.mixl_+3A_...">...</code></td>
<td>
<p>Options to pass to summarize (currently).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary object for a mixl model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions
	)

	model2 &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model2)

</code></pre>

<hr>
<h2 id='utilities'>Return the the utilities for a set of coefficients</h2><span id='topic+utilities'></span>

<h3>Description</h3>

<p>Return the the utilities for a set of coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utilities(model_spec, beta, data, availabilities, draws, nDraws)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="utilities_+3A_model_spec">model_spec</code></td>
<td>
<p>The generated model_spec.</p>
</td></tr>
<tr><td><code id="utilities_+3A_beta">beta</code></td>
<td>
<p>The coefficients to use in the model when estimating the utilities.</p>
</td></tr>
<tr><td><code id="utilities_+3A_data">data</code></td>
<td>
<p>The dataframe of observations.</p>
</td></tr>
<tr><td><code id="utilities_+3A_availabilities">availabilities</code></td>
<td>
<p>The availabilities of each alternative.</p>
</td></tr>
<tr><td><code id="utilities_+3A_draws">draws</code></td>
<td>
<p>For mixed models, a matrix of draws. If none is provided, one is created.</p>
</td></tr>
<tr><td><code id="utilities_+3A_ndraws">nDraws</code></td>
<td>
<p>The number of draws to use or generated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe of utilties for each observation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data("Train", package="mlogit")
  Train$ID &lt;- Train$id
  Train$CHOICE &lt;- as.numeric(Train$choice)
  
  est &lt;- stats::setNames(c(1,1,1,1), c("B_price", "B_time", "B_timeB", "B_change"))
  
  availabilities &lt;- mixl::generate_default_availabilities(Train, 2)
  
  Nindividuals &lt;- length(unique(Train$ID))
  
  utility_script &lt;- "
      U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60 + @B_change * $change_A;
      U_B = @B_price * $price_B / 1000 + @B_timeB * $time_B / 60 ;
      "
  
  model_spec &lt;- mixl::specify_model(utility_script, Train)
  
  utilities_matrix = mixl::utilities(model_spec, est, Train, availabilities, NULL)
  
  utilities_matrix

</code></pre>

<hr>
<h2 id='vcov.mixl'>Calculates the Variance-Covariance Matrix of the mixl summary</h2><span id='topic+vcov.mixl'></span>

<h3>Description</h3>

<p><code><a href="stats.html#topic+vcov">vcov()</a></code> is an S3 method for the summary.mixl class, giving the Variance-Covariance Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixl'
vcov(object, eigentol = 1e-12, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mixl_+3A_object">object</code></td>
<td>
<p>The summary to print.</p>
</td></tr>
<tr><td><code id="vcov.mixl_+3A_eigentol">eigentol</code></td>
<td>
<p>The tolerance value.</p>
</td></tr>
<tr><td><code id="vcov.mixl_+3A_...">...</code></td>
<td>
<p>Options to pass to print.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
	data("Train", package="mlogit")
	Train$ID &lt;- Train$id
	Train$CHOICE &lt;- as.numeric(Train$choice)
	    
	mnl_test &lt;- "
	U_A = @B_price * $price_A / 1000 + @B_time * $time_A / 60;
	U_B = @asc + @B_price * $price_B / 1000 + @B_timeB * $time_B / 60;
	"

	model_spec &lt;- mixl::specify_model(mnl_test, Train, disable_multicore=T)

	#only take starting values that are needed
	est &lt;- stats::setNames(c(1, 1,1,1), c("asc", "B_price", "B_time", "B_timeB"))
	availabilities &lt;- mixl::generate_default_availabilities(
		Train, model_spec$num_utility_functions
	)

	model2 &lt;- mixl::estimate(model_spec, est, Train, availabilities = availabilities)
	print(model2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
