<!DOCTYPE html><html><head><title>Help for package mvmeta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mvmeta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mvmeta-package'>
<p>Multivariate and Univariate Meta-Analysis and Meta-Regression</p></a></li>
<li><a href='#berkey98'><p> Five Published Trials on Periodontal Disease</p></a></li>
<li><a href='#blup'><p> Best Linear Unbiased Predictions</p></a></li>
<li><a href='#blup.mvmeta'><p> Best Linear Unbiased Predictions from mvmeta Models</p></a></li>
<li><a href='#coef.mvmeta'><p> Extract Coefficients and (Co)Variance Matrix from mvmeta Objects</p></a></li>
<li><a href='#fibrinogen'><p> Fibrinogen Studies Collaboration</p></a></li>
<li><a href='#hsls'><p> High School Longitudinal Study</p></a></li>
<li><a href='#hyp'><p> Ten Studies Assessing an Hypertension Treatment</p></a></li>
<li><a href='#inputcov'><p> Input (Co)Variance Matrices</p></a></li>
<li><a href='#inputna'><p> Input Missing Values</p></a></li>
<li><a href='#logLik.mvmeta'><p> Extract Log-Likelihood from mvmeta Objects</p></a></li>
<li><a href='#mlprof.fn'><p> Likelihood Functions for mvmeta Models</p></a></li>
<li><a href='#model.frame.mvmeta'><p> Extract Model Frame and Design Matrix from mvmeta Objects</p></a></li>
<li><a href='#mvmeta'><p> Fitting Multivariate and Univariate Meta-Analysis and Meta-Regression Models</p></a></li>
<li><a href='#mvmeta.control'><p> Ancillary Parameters for Controlling the Fit in mvmeta Models</p></a></li>
<li><a href='#mvmeta.fixed'><p> Fixed-Effects Estimator for mvmeta Models</p></a></li>
<li><a href='#mvmeta.ml'><p> ML and REML Estimators for mvmeta Models</p></a></li>
<li><a href='#mvmeta.mm'><p> Method of Moments Estimator for mvmeta Models</p></a></li>
<li><a href='#mvmeta.vc'><p> Variance Components Estimator for mvmeta Models</p></a></li>
<li><a href='#mvmetaCovStruct'><p> Covariance Structures for mvmeta Models</p></a></li>
<li><a href='#mvmetaObject'><p> mvmeta Objects</p></a></li>
<li><a href='#mvmetaSim'><p> Simulating Responses for mvmeta Models</p></a></li>
<li><a href='#na.omit.data.frame.mvmeta'><p> Handling Missing Values in mvmeta Models</p></a></li>
<li><a href='#p53'><p> Mutant p53 Gene and Squamous Cell Carcinoma</p></a></li>
<li><a href='#predict.mvmeta'><p> Predicted Values from mvmeta Models</p></a></li>
<li><a href='#qtest'><p> Cochran Q Test of Heterogeneity</p></a></li>
<li><a href='#qtest.mvmeta'><p> Cochran Q Test of Heterogeneity for mvmeta Models</p></a></li>
<li><a href='#smoking'><p> Meta-Analysis of Interventions to Promote Smoking Cessation</p></a></li>
<li><a href='#summary.mvmeta'><p> Summarizing mvmeta Models</p></a></li>
<li><a href='#vechMat'><p> Vectorization and Expansion of Symmetric Matrices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate and Univariate Meta-Analysis and Meta-Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Antonio Gasparrini</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Antonio Gasparrini &lt;antonio.gasparrini@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.13.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>mixmeta, stats, graphics, grDevices, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>metafor, meta, rmeta, nlme, MASS, dlnm</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions to perform fixed and random-effects multivariate and univariate meta-analysis and meta-regression.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.ag-myresearch.com/package-mvmeta">http://www.ag-myresearch.com/package-mvmeta</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-10 11:26:34 UTC; emsuagas</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-10 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mvmeta-package'>
Multivariate and Univariate Meta-Analysis and Meta-Regression
</h2><span id='topic+mvmeta-package'></span>

<h3>Description</h3>

<p>The package <span class="pkg">mvmeta</span> consists of a collection of functions to perform fixed and random-effects multivariate and univariate meta-analysis and meta-regression in <span class="rlang"><b>R</b></span>.
</p>
<p>It is now superseded by the package <span class="pkg">mixmeta</span>, which offers a unified mixed-effects framework to perform various meta-analytical models in <span class="rlang"><b>R</b></span>, including non-standard extensions such as multivariate, multilevel, longitudinal, and dose-response models. The package <span class="pkg">mvmeta</span> will be still maintained, but its development is now discontinued. Improvements and further extensions will be implemented in <span class="pkg">mixmeta</span>. Users are suggested to switch to the latter.
</p>


<h3>Modelling framework</h3>

<p>Multivariate meta-analytical models represent an extension of the standard univariate techniques, where estimates of a single effect size, here defined generally as outcome, are pooled across studies. In multivariate meta-analysis, estimates of multiple outcomes are combined while accounting for their correlation. Multivariate meta-regression also models such multivariate distribution in terms of study-level predictors. These statistical tools were originally proposed to model multiple endpoints in clinical trials. Applications and methodological developments are currently proposed also for network meta-analysis (indirect treatment comparison), for the meta-analysis of multi-parameter associations and for meta-analysis of diagnostic studies, among others. See references below for details.
</p>
<p>Similarly to univariate methods, fixed-effects models do not assume heterogeneity among studies, and the estimates are conditional on the set of studies collected in the meta-analysis, based on a multivariate weighted average of study-level estimates. Random-effects meta-analysis, instead, allows a degree of heterogeneity among studies, assuming the (true but unobserved) study-specific outcomes as randomly sampled from a multivariate normal distribution of studies. Inference from these models may therefore be extended to other unmeasured studies assumed to belong to the same (usually hypothetical) population.
</p>
<p>Estimation and interpretation exploit here the framework of linear mixed models. The fixed part of the model provides an estimate of fixed effects, which represent the population-averaged outcomes and, in the case of meta-regression, are defined by a set of coefficients associated to study-level predictors. The random part of the model describes the deviation from the population averages, estimating the components of a between-study (co)variance matrix. Assuming <code class="reqn">k</code> outcomes <code class="reqn">\boldsymbol{y}_i</code> estimated in each of <code class="reqn">i = 1, \ldots, m</code> studies, and related to <code class="reqn">p</code> study-level predictors <code class="reqn">\boldsymbol{x}_i</code>, random-effects multivariate meta-regression models can be generally described with:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{y}_i \sim \mbox{N}_k(\boldsymbol{X}_i \boldsymbol{\beta}, \boldsymbol{S}_i + \Psi)</code>
</p>

<p>Here the outcomes <code class="reqn">\boldsymbol{y}_i</code> are assumed to be sampled from a multivariate normal distribution of order <code class="reqn">k</code>. Their distribution is centred on <code class="reqn">\boldsymbol{X}_i \boldsymbol{\beta}</code>, with <code class="reqn">\boldsymbol{X}_i</code> as a <code class="reqn">k \times kp</code> design matrix and <code class="reqn">\boldsymbol{\beta}</code> the vector of fixed-effects coefficients. The marginal <code class="reqn">k \times k</code> (co)variance matrix <code class="reqn">\boldsymbol{\Sigma}_i = \boldsymbol{S}_i + \boldsymbol{\Psi}</code> is given by the sum of within (assumed known) and between-study (co)variance matrices <code class="reqn">\boldsymbol{S}_i</code> and <code class="reqn">\boldsymbol{\Psi}</code>, respectively.
</p>
<p>Other models are taken as special cases of that above. In multivariate meta-analysis, <code class="reqn">\boldsymbol{X}_i</code> becomes an identity matrix with <code class="reqn">p=1</code>, and <code class="reqn">\boldsymbol{\beta}</code> reduces to <code class="reqn">k</code> intercepts, interpreted as the population-averaged outcomes. For <code class="reqn">k=1</code>, the model reduces to the standard univariate meta-analysis or meta-regression. In fixed-effects meta-analytic models, <code class="reqn">\boldsymbol{\Psi}</code> is assumed not to exist, and the variability between studies is due exclusively to the within-study estimation error.
</p>


<h3>Estimation methods</h3>

<p>The aim is to estimate the coefficients <code class="reqn">\boldsymbol{\beta}</code> and, for random-effects models, the components of the between-study (co)variance matrix <code class="reqn">\boldsymbol{\Psi}</code>. If the same linear predictor of <code class="reqn">p</code> terms <code class="reqn">\boldsymbol{x}_i</code> measured in each study is specified for all the outcomes (the only option available in the current version), the dimension of <code class="reqn">\boldsymbol{\beta}</code> is <code class="reqn">kp</code>. The parameters for the random part depend on the chosen structure of the between-study (co)variance matrix <code class="reqn">\boldsymbol{\Psi}</code>, with <code class="reqn">k(k+1)/2</code> parameters for an unstructured form, and a smaller set of parameters for structured (co)variances. 
</p>
<p>Different estimator are implemented in the package <span class="pkg">mvmeta</span>. The estimation options available in the current version are:
</p>

<ul>
<li> <p><b>Fixed-effects</b>
</p>
</li>
<li> <p><b>Maximum likelihood</b> (ML)
</p>
</li>
<li> <p><b>Restricted maximum likelihood</b> (REML)
</p>
</li>
<li> <p><b>Method of moments</b>
</p>
</li>
<li> <p><b>Variance components</b>
</p>
</li></ul>

<p>The fixed-effects model is fitted through generalized least squares (GLS), assuming the (co)variance structure, composed by the within-study error only, as completely known. Among random-effects models, ML and REML approaches provides fit criteria and inferential test derived from likelihood theory, such as AIC and likelihood ratio test. However, they are based on computationally intensive iterative procedures of optimization, and convergence can be slow for high-dimensional models (with a high number of outcomes). Estimators based on semiparametric alternatives such as the non-iterative method of moments or the iterative variance components approach are generally faster. Further details on estimation methods are given in the related help pages.
</p>


<h3>Functions and data included in the package</h3>

<p>The main function in the package is <code><a href="#topic+mvmeta">mvmeta</a></code>, which performs the various models illustrated above. This function resembles standard regression functions in <span class="rlang"><b>R</b></span>, and specifies the model through a regression formula. The function returns a list object of class <code>"mvmeta"</code> (see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>).
</p>
<p>The estimation is carried out internally through <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, a wrapper which prepares the data and calls specific estimation functions for fitting the models. Specifically, <code><a href="#topic+mvmeta.fixed">mvmeta.fixed</a></code> is applied for fixed-effects models, while estimators for random-effects models are implemented in the functions <code><a href="#topic+mvmeta.ml">mvmeta.ml</a></code> and <code><a href="#topic+mvmeta.reml">mvmeta.reml</a></code> for (restricted) maximum likelihood, <code><a href="#topic+mvmeta.mm">mvmeta.mm</a></code> for the method of moments, and <code><a href="#topic+mvmeta.vc">mvmeta.vc</a></code> for variance components. For likelihood-based methods, iterative <code><a href="#topic+mlprof.fn">optimizations algorithms</a></code> are used for maximizing the (restricted) likelihood, and specific <code><a href="#topic+mvmetaCovStruct">(co)variance structures</a></code> for the between-study random effects are available. Fitting parameter options are set by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.
</p>
<p>Method functions are available for objects of class <code>"mvmeta"</code> (see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code> for a complete list). The method <code><a href="#topic+summary.mvmeta">summary</a></code> produces a list of class <code>"summary.mvmeta"</code> for summarizing the fit of the model and providing additional results. The method function <code><a href="#topic+predict.mvmeta">predict</a></code> computes predicted values, optionally for a set of new values of the predictors. <code><a href="#topic+blup.mvmeta">blup</a></code> gives the (empirical) best linear unbiased predictions for the set of studies used for estimation. Other default or specific method functions for regression can be used on objects of class <code>"mvmeta"</code>, such as <code><a href="stats.html#topic+fitted">fitted</a></code> and <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="#topic+logLik.mvmeta">logLik</a></code>, <code><a href="stats.html#topic+AIC">AIC</a></code> and <code><a href="stats.html#topic+BIC">BIC</a></code>, among others.
</p>
<p>Methods for <code><a href="#topic+model.frame.mvmeta">model.frame</a></code> and <code><a href="#topic+model.matrix.mvmeta">model.matrix</a></code> are used to extract and construct the model frame and the design matrix of the regression meta-analytical model, respectively. Methods for <code><a href="#topic+na.omit.data.frame.mvmeta">na.omit</a></code> and <code><a href="#topic+na.exclude.data.frame.mvmeta">na.exclude</a></code> help handle correctly missing values.
</p>
<p>Simulations can be produced using the function <code><a href="#topic+mvmetaSim">mvmetaSim</a></code> and the method function <code><a href="#topic+simulate.mvmeta">simulate</a></code>, which return one or multiple sets of simulated outcomes for a group of studies. The function <code><a href="#topic+inputna">inputna</a></code> and <code><a href="#topic+inputcov">inputcov</a></code> are used internally to augment the missing data values and to input missing correlations, respectively.
</p>
<p>The method function <code><a href="#topic+qtest.mvmeta">qtest.mvmeta</a></code> (producing an object with class of the same name) performs the (multivariate) Cochran Q test for (residual) heterogeneity, both on the overall multivariate distribution and on each single outcome. The generic method function is <code><a href="#topic+qtest">qtest</a></code>.
</p>
<p>Printing functions for the objects of classes defined above are also provided. Other functions are used internally in the source code, and not exported in the namespace. For users interested in getting into details of the package structure, these functions can be displayed using the triple colon ('<code>:::</code>') operator. For instance, <code>mvmeta:::glsfit</code> displays the code of the function <code>glsfit</code>. Also, some comments are added in the original source code.
</p>
<p>The package includes the datasets <code><a href="#topic+berkey98">berkey98</a></code>, <code><a href="#topic+fibrinogen">fibrinogen</a></code>, <code><a href="#topic+hsls">hsls</a></code>, <code><a href="#topic+hyp">hyp</a></code>, <code><a href="#topic+p53">p53</a></code> and <code><a href="#topic+smoking">smoking</a></code> as data frames, which are used in the examples.
</p>


<h3>Additional information</h3>

<p>A list of changes included in the current and previous versions can be found by typing:
</p>
<p><code>file.show(system.file("ChangeLog",package="mvmeta"))</code>
</p>
<p>General information on the development and applications of the <span class="pkg">mvmeta</span> package and on the modelling framework of multivariate meta-analysis, together with an updated version of the <span class="rlang"><b>R</b></span> scripts for running the examples in published papers, can be found at <b><a href="http://www.ag-myresearch.com">www.ag-myresearch.com</a></b>.
</p>


<h3>Warnings</h3>

<p>This release of the package <span class="pkg">mvmeta</span> has been tested with different simulated and real datasets. The functions generally perform well under several scenarios, and comparisons with alternative software implementations show good agreement. However, bugs and bad performance under un-tested conditions may not be excluded. Please report any error or unexpected behaviour to the e-mail address below.
</p>


<h3>Note</h3>

<p>The functions included in the package <span class="pkg">mvmeta</span> may be applied also to perform standard univariate meta-analysis and meta-regression. However, alternative packages provides a more exhaustive and efficient set of functions. See for example the packages <span class="pkg">metafor</span>, <span class="pkg">meta</span>, <span class="pkg">rmeta</span> and <span class="pkg">metaLik</span>, among others.
</p>
<p>Functions for fitting multivariate models are available in other <span class="rlang"><b>R</b></span> packages. The package <span class="pkg">metafor</span> provides functions to perform fixed or random-effects multivariate models, the latter fitted through maximum or restricted maximum likelihood. A thorough comparison with the implementation offered in <span class="pkg">mvmeta</span> is not available yet. The package <span class="pkg">metaSEM</span> (not in CRAN) offers functions to perfor fixed-effects and likelihood-based random-effects multivariate meta-analysis through structural equation modelling. The package <span class="pkg">mvtmeta</span> performs fixed-effects and random-effects multivariate meta-analysis using the same method of moments estimator adopted here, although without allowing for missing outcomes or meta-regression. The package <span class="pkg">mada</span> contains functions for bivariate models used in diagnostic studies.
</p>
<p>Use <code>citation("mvmeta")</code> to cite this package.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>
</p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>White IR (2009). Multivariate random-effects meta-analysis. <em>Stata Journal</em>. <b>9</b>(1):40&ndash;56.
</p>
<p>Jackson D, Riley R, White IR (2011). Multivariate meta-analysis: Potential and promise. <em>Statistics in Medicine</em>. <b>30</b>(20);2481&ndash;2498.
</p>
<p>White IR (2011). Multivariate random-effects meta-regression: updates to mvmeta. <em>Stata Journal</em>. <b>11</b>(2):255&ndash;270.
</p>
<p>van Houwelingen HC, Arends LR, et al. (2002). Advanced methods in meta-analysis: multivariate approach and meta-regression. <em>Statistics in Medicine</em>. <b>21</b>(4):589&ndash;624.
</p>
<p>Lu G, Ades AE (2004). Combination of direct and indirect evidence in mixed treatment comparisons. <em>Statistics in Medicine</em>. <b>23</b>(20):3105&ndash;3124.
</p>
<p>Nam IS, Mengersen K, et al. (2003). Multivariate meta-analysis. <em>Statistics in Medicine</em>. <b>22</b>(14):2309&ndash;2333.
</p>
<p>Arends LR, Voko Z, Stijnen T (2003). Combining multiple outcome measures in a meta-analysis: an application. <em>Statistics in Medicine</em>. <b>22</b>(8):1335&ndash;1353.
</p>
<p>Ritz J, Demidenko E, Spiegelman G (2008). Multivariate meta-analysis for data consortia, individual patient meta-analysis, and pooling projects. <em>Journal of Statistical Planning and Inference</em>. <b>139</b>(7):1919&ndash;1933.
</p>
<p>Berkey, CS, Anderson JJ, Hoaglin DC (1996). Multiple-outcome meta-analysis of clinical trials. <em>Statistics in Medicine</em>. <b>15</b>(5):537&ndash;547.
</p>
<p>Berkey, CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>(22):2537&ndash;2550.
</p>
<p>Jackson D, White IR, Riley RD (2013). A matrix based method of moments for fitting the multivariate random effects model for meta-analysis and meta-regression. <em>Biometrical Journal</em>. <b>55</b>(2):231-245.
</p>
<p>Chen H, Manning AK, Dupuis J (2012). A method of moments estimator for random effect multivariate meta-analysis. <em>Biometrics</em>. <b>68</b>(4):1278-1284.
</p>
<p>Cheung MWL, Chan W (2009). A two-stage approach to synthesizing covariance matrices in meta-analytic structural equation modeling. <em>Structural Equation Modeling</em>. <b>16</b>(1):28&ndash;53.
</p>
<p>Doebler P, Holling H, Bohning D (2012). A mixed model approach to meta-analysis of diagnostic studies with binary test outcome. <em>Psychological Methods</em>. <b>17</b>(3):418&ndash;36.
</p>

<hr>
<h2 id='berkey98'> Five Published Trials on Periodontal Disease </h2><span id='topic+berkey98'></span>

<h3>Description</h3>

<p>The dataset contains the results of 5 published trials comparing surgical and non-surgical treatments for medium-severity periodontal disease, one year after treatment. The 2 estimated outcomes are average improvements (surgical minus non-surgical, in mm) in probing depth (PD) and attachment level (AL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>berkey98</code></pre>


<h3>Format</h3>

<p>A data frame with 5 observations on the following 7 variables:
</p>

<dl>
<dt><code>pubyear</code></dt><dd><p> publication year of the trial.</p>
</dd>
<dt><code>npat</code></dt><dd><p> number of patients included in the trial.</p>
</dd>
<dt><code>PD</code></dt><dd><p> estimated improvement of surgical versus non-surgical treatments in probing depth (mm).</p>
</dd>
<dt><code>AL</code></dt><dd><p> estimated improvement of surgical versus non-surgical treatments in attachment level (mm).</p>
</dd>
<dt><code>var_PD</code></dt><dd><p> variance of the estimated outcome for <code>PD</code>.</p>
</dd>
<dt><code>cov_PD_AL</code></dt><dd><p> covariance of the estimated outcomes for <code>PD</code> and <code>AL</code>.</p>
</dd>
<dt><code>var_AL</code></dt><dd><p> variance of the estimated outcome for <code>AL</code>.</p>
</dd>
</dl>

<p>Row names specify the author of the paper reporting the results of each trial.
</p>


<h3>Source</h3>

<p>Berkey CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>:2537&ndash;2550.
</p>
<p>Berkey C. S., Antczak-Bouckoms A., et al. (1995). Multiple-outcomes meta-analysis of treatments for periodontal disease. <em>Journal of Dental Research</em>. <b>74</b>(4):1030&ndash;1039.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS IN BERKEY ET AL. (1998)

# INSPECT THE DATA
berkey98

# FIXED-EFFECTS
year &lt;- berkey98$pubyear - 1983
model &lt;- mvmeta(cbind(PD,AL)~year,S=berkey98[5:7],data=berkey98,method="fixed")
print(summary(model),digits=3)

# GLS MODEL (VARIANCE COMPONENTS) 
model &lt;- mvmeta(cbind(PD,AL)~year,S=berkey98[5:7],data=berkey98,method="vc",
  control=list(vc.adj=FALSE))
print(summary(model),digits=3)
round(model$Psi,3)

# ML MODEL
model &lt;- mvmeta(cbind(PD,AL)~year,S=berkey98[5:7],data=berkey98,method="ml")
print(summary(model),digits=3)
round(model$Psi,3)
</code></pre>

<hr>
<h2 id='blup'> Best Linear Unbiased Predictions </h2><span id='topic+blup'></span>

<h3>Description</h3>

<p>This is a generic function for generating best linear unbiased predictions (BLUPs) from the results of various fitting functions for meta-analytical models. The function invokes particular methods which depend on the <code><a href="base.html#topic+class">class</a></code> of the first argument. Currently, specific methods exist for several meta-analytical models in various packages: <code><a href="mixmeta.html#topic+blup.mixmeta">blup.mixmeta</a></code>, <code><a href="metafor.html#topic+blup.rma.uni">blup.rma.uni</a></code>, <code><a href="#topic+blup.mvmeta">blup.mvmeta</a></code>, and <code><a href="dosresmeta.html#topic+blup.dosresmeta">blup.dosresmeta</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blup(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blup_+3A_object">object</code></td>
<td>
<p> a model object for which BLUPs are desired.</p>
</td></tr>
<tr><td><code id="blup_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic method function <code>blup</code> calls specific method functions to produces (empirical) best linear unbiased predictions (BLUPs) from model objects.
</p>
<p>These predictions are a shrunk version of unit-specific realizations, where unit-specific estimates borrow strength from the assumption of an underlying (potentially multivariate) distribution in a (usually hypothetical) population. The amount of shrinkage depends from the relative size of the within and between-unit covariance matrices.
</p>


<h3>Value</h3>

<p>The form of the value returned by <code>blup</code> depends on the class of its argument. See the documentation of the particular methods for details of what is produced by that method. Usually, the results consist of point estimates of BLUPs and optionally some measure of their uncertainty.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt; and Francesco Sera &lt;<a href="mailto:francesco.sera@lshtm.ac.uk">francesco.sera@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Verbeke G, Molenberghs G. <em>Linear Mixed Models for Longitudinal Data</em>. Springer; 1997.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

<p>Specific methods for various classes: <code><a href="mixmeta.html#topic+blup.mixmeta">blup.mixmeta</a></code>, <code><a href="metafor.html#topic+blup.rma.uni">blup.rma.uni</a></code>, <code><a href="#topic+blup.mvmeta">blup.mvmeta</a></code>, and <code><a href="dosresmeta.html#topic+blup.dosresmeta">blup.dosresmeta</a></code>.
</p>

<hr>
<h2 id='blup.mvmeta'> Best Linear Unbiased Predictions from mvmeta Models </h2><span id='topic+blup.mvmeta'></span>

<h3>Description</h3>

<p>This method function computes (empirical) best linear unbiased predictions from fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>. Such predictions are optionally accompanied by standard errors, prediction intervals or the entire (co)variance matrix of the predicted outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
blup(object, se=FALSE, pi=FALSE, vcov=FALSE, pi.level=0.95,
  format=c("matrix","list"), aggregate=c("stat","y"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blup.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_se">se</code></td>
<td>
<p> logical switch indicating if standard errors must be included.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_pi">pi</code></td>
<td>
<p> logical switch indicating if prediction intervals must be included.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_vcov">vcov</code></td>
<td>
<p> logical switch indicating if the (co)variance matrix must be included.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_pi.level">pi.level</code></td>
<td>
<p> a numerical value between 0 and 1, specifying the confidence level for the computation of prediction intervals.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_format">format</code></td>
<td>
<p> the format for the returned results. See Value.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_aggregate">aggregate</code></td>
<td>
<p> when <code>format="matrix"</code> and <code>se</code> or <code>ci</code> are required, the results may be aggregated by statistic or by outcome. See Value.</p>
</td></tr>
<tr><td><code id="blup.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method function <code>blup</code> produces (empirical) best linear unbiased predictions from <code>mvmeta</code> objects. For random-effects models, predictions are given by the sum of the estimated mean outcomes from the fixed part of the model, plus study-specific deviations predicted as random effects given the between-study distribution.
</p>
<p>Predicted outcomes from <code>blup</code> are a shrunk version of study-specific realizations, where study-specific estimates borrow strength from the assumption of an underlying multivariate distribution of outcomes in a (usually hypothetical) population of studies. In practice, the results from <code>blup</code> represent a weighted average between population mean outcomes (estimated by the fixed part of the model) and study-specific estimates. The weights depend from the relative size of the within and between-study covariance matrices reported as components <code>S</code> and <code>Psi</code> in <code>mvmeta</code> objects (see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>).
</p>
<p>Fixed-effects models do not assume study-specific random effects, and the results of <code>blup</code> for these models are identical to <code><a href="#topic+predict.mvmeta">predict</a></code> with <code>interval="confidence"</code>.
</p>
<p>How to handle predictions for studies removed from estimation due to invalid missing pattern is determined by the <code>na.action</code> argument used in <code><a href="#topic+mvmeta">mvmeta</a></code> to produce <code>object</code>. If <code>na.action=na.omit</code>, studies excluded from estimation will not appear, whereas if <code>na.action=na.exclude</code> they will appear, with values set to <code>NA</code> for all the outcomes. This step is performed by <code><a href="stats.html#topic+napredict">napredict</a></code>. See Note below.
</p>
<p>In the presence of missing values in the study-specific estimated outcome <code>y</code> of the fitted model, correspondent values of point estimates and covariance terms are set to 0, while the variance terms are set to <code>1e+10</code>. In this case, in practice, the study-specific estimates do not provide any information (their weight is virtually 0), and the prediction tends to the value returned by <code><a href="#topic+predict.mvmeta">predict</a></code> with <code>interval="prediction"</code>, when applied to a new but identical set of predictors. See also Note below.
</p>


<h3>Value</h3>

<p>The results may be aggregated in matrices (the default), or returned as lists, depending on the argument <code>format</code>. For multivariate models, the aggregation is ruled by the argument <code>aggregate</code>, and the results may be grouped by statistic or by outcome. If <code>vcov=TRUE</code>, lists are always returned.
</p>


<h3>Note</h3>

<p>The definition of missing in model frames used for estimation in <code><a href="#topic+mvmeta">mvmeta</a></code> is different than that commonly adopted in other regression models such as <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>. See info on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code> in <code><a href="#topic+mvmeta">mvmeta</a></code>.
</p>
<p>Differently from <code><a href="#topic+predict.mvmeta">predict</a></code>, this method function computes the predicted values in the presence of partially missing outcomes. Interestingly, BLUPs for missing outcomes may be slightly different than predictions returned by <code><a href="#topic+predict.mvmeta">predict</a></code> on a new but identical set of predictors, as the BLUP also depends on the random part of the model. Specifically, the function uses information from the between-study covariance to predict missing outcomes given the observed ones.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+predict.mvmeta">predict</a></code> for standard predictions. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~1,S=berkey98[5:7],data=berkey98)

# ONLY BLUP
blup(model)

# BLUP AND SE
blup(model,se=TRUE)

# SAME AS ABOVE, AGGREGATED BY OUTCOME, WITH PREDICTION INTERVALS
blup(model,se=TRUE,pi=TRUE,aggregate="y")

# WITH VCOV, FORCED TO A LIST
blup(model,se=TRUE,pi=TRUE,vcov=TRUE,aggregate="y")
</code></pre>

<hr>
<h2 id='coef.mvmeta'> Extract Coefficients and (Co)Variance Matrix from mvmeta Objects </h2><span id='topic+coef.mvmeta'></span><span id='topic+vcov.mvmeta'></span>

<h3>Description</h3>

<p>These method functions return the estimated fixed-effects coefficients and their (co)variance matrix for fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
coef(object, format=c("vector","matrix"), ...)

## S3 method for class 'mvmeta'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="coef.mvmeta_+3A_format">format</code></td>
<td>
<p> format of the returned object.</p>
</td></tr>
<tr><td><code id="coef.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>coef</code>, a vector (default) or matrix with the estimated fixed-effects coefficients. The matrix-structure is used to store the fixed-effects coefficients in <code>mvmeta</code> objects, and is preserved if <code>format="matrix"</code>.
</p>
<p>For <code>vcov</code>, the (co)variance matrix of the estimated fixed-effects coefficients.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# COEFFICIENTS
model$coef
coef(model)
coef(model,format="matrix")
summary(model)$coef

# (CO)VARIANCE MATRIX
vcov(model)
</code></pre>

<hr>
<h2 id='fibrinogen'> Fibrinogen Studies Collaboration </h2><span id='topic+fibrinogen'></span>

<h3>Description</h3>

<p>The Fibrinogen Studies Collaboration is a meta-analysis of individual data on 154,012 adults from 31 prospective cohort studies with information on plasma fibrinogen and major disease outcomes. The dataset reports a subset of the results of a first-stage analysis consisting of the log-hazard ratio of coronary heart disease for categories of levels of fibrinogen versus a baseline category. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fibrinogen</code></pre>


<h3>Format</h3>

<p>A data frame with 31 observations on the following 15 variables:
</p>

<ul>
<li><p><code>cohort</code>: study ID.
</p>
</li>
<li><p><code>b2, b3, b4, b5</code>: estimated log-hazard ratios for the second to fifth categories versus the baseline category.
</p>
</li>
<li><p><code>V_2_2, V_3_3, V_4_4, V_5_5</code>: variances of the estimated log-hazard ratios.
</p>
</li>
<li><p><code>V_2_3, V_2_4, V_2_5, V_3_4, V_3_5, V_4_5</code>: covariances of the estimated log-hazard ratios.
</p>
</li></ul>



<h3>Details</h3>

<p>The published analysis adopted a fixed-effects model on 10 categories of fibrinogen (Fibrinogen Studies Collaboration 2004, 2005). Here a subset of the results of the first-stage analysis is reported, namely the log-hazard ratio for 4 categories and associated (co)variance terms, ordered as the lower triangular elements of the (co)variance matrix taken by column. Details on the first-stage model and the second-stage meta-analysis are provided in White (2009) and Jackson and colleagues (2010).
</p>


<h3>Note</h3>

<p>The data provide an example of application of multivariate meta-analysis for multi-parameter association, where a relationship is defined by functions specified by several coefficients. In this case, the coefficients refer to log-hazard ratio for strata of the original variable versus a baseline category. A general overview of the application of multivariate meta-analysis in this setting is provided by Gasparrini and colleagues (2012).
</p>


<h3>Source</h3>

<p>Fibrinogen Studies Collaboration (2004). Collaborative meta-analysis of prospective studies of plasma fibrinogen and cardiovascular disease. <em>European Journal of Cardiovascular Prevention and Rehabilitation</em>. <b>11</b>:9&ndash;17.
</p>
<p>Fibrinogen Studies Collaboration (2005). Plasma fibrinogen level and the risk of major cardiovascular diseases and nonvascular mortality: an individual participant meta-analysis. <em>Journal of the American Medical Association</em>. <b>294</b>:1799&ndash;1809.
</p>
<p>White IR (2009). Multivariate random-effects meta-analysis. <em>Stata Journal</em>. <b>9</b>(1):40&ndash;56.
</p>
<p>Jackson D, White IR, Thompson SG (2010). Extending DerSimonian and Laird's methodology to perform multivariate random effects meta-analyses. <em>Statistics in Medicine</em>. <b>29</b>(12):1282&ndash;1297.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS IN WHITE (2009) AND JACKSON ET AL. (2010)

# INSPECT THE DATA
head(fibrinogen)

# REML MODEL
y &lt;- as.matrix(fibrinogen[2:5])
S &lt;- as.matrix(fibrinogen[6:15])
model &lt;- mvmeta(y,S)

# SUMMARIZE THE RESULTS
print(summary(model),digits=3)
round(model$Psi,3)
</code></pre>

<hr>
<h2 id='hsls'> High School Longitudinal Study </h2><span id='topic+hsls'></span>

<h3>Description</h3>

<p>This is a nationally representative, longitudinal study of more than 21,000 9th graders in 944 schools who will be followed through their secondary and postsecondary years. The data are used for testing whether sex, socioeconomic status and sex by socio-economic status interaction are predictive of the mathematics standardized score in each of the eight race groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hsls</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 10 variables:
</p>

<ul>
<li><p><code>race</code>: race group.
</p>
</li>
<li><p><code>b1, b2, b3</code>: estimated regression coefficients for sex, socio-economic status and sex by socio-economic status interaction, respectively, on the mathematics standardized score.
</p>
</li>
<li><p><code>V11, V22, V33</code>: variances of the estimated coefficients.
</p>
</li>
<li><p><code>V12, V13, V23</code>: covariances of the estimated coefficients.
</p>
</li></ul>



<h3>Source</h3>

<p>Chen H, Manning AK, Dupuis J (2012). A method of moments estimator for random effect multivariate meta-analysis. <em>Biometrics</em>. <b>68</b>(4):1278-1284.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS IN CHEN ET AL. (2012)

# INSPECT THE DATA
hsls

# FIXED-EFFECTS MODEL
S &lt;- as.matrix(hsls[5:10])
model &lt;- mvmeta(cbind(b1,b2,b3),S,data=hsls,method="fixed")
summary(model)

# MM MODEL
model &lt;- mvmeta(cbind(b1,b2,b3),S,data=hsls,method="mm")
summary(model)
model$Psi
</code></pre>

<hr>
<h2 id='hyp'> Ten Studies Assessing an Hypertension Treatment </h2><span id='topic+hyp'></span>

<h3>Description</h3>

<p>The dataset contains the results of ten studies that assess the effectiveness of hypertension treatment for lowering blood pressure. Each study provides complete data on two treatment effects, the difference in systolic blood pressure (SBP) and diastolic blood pressure (DBP) between the treatment and the control groups, where these differences are adjusted for the participants' baseline blood pressures. The within-study correlations of the two outcomes are known. Some trials are conducted on patients with isolated systolic hypertension (ISH).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyp</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 7 variables:
</p>

<ul>
<li><p><code>study</code>: study ID.
</p>
</li>
<li><p><code>sbp, sbp_se</code>: estimated difference and its standard error in systolic blood pressure.
</p>
</li>
<li><p><code>dbp, dbp_se</code>: estimated difference and its standard error in diastolic blood pressure.
</p>
</li>
<li><p><code>rho</code>: within-study correlation between the estimated differences in systolic and diastolic blood pressure.
</p>
</li>
<li><p><code>ish</code>: indicator for studies on patients with isolated systolic hypertension.
</p>
</li></ul>



<h3>Note</h3>

<p>The standard errors for the two outcomes are wrongly reported as variances in the original article by Jackson and colleagues (2013).
</p>


<h3>Source</h3>

<p>Jackson D, White IR, Riley RD (2013). A matrix based method of moments for fitting the multivariate random effects model for meta-analysis and meta-regression. <em>Biometrical Journal</em>. <b>55</b>(2):231&ndash;45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS IN JACKSON ET AL. (2013)

# INSPECT THE DATA
hyp

# INPUT THE CORRELATION (CAN ALSO BE INPUTTED DIRECTLY, SEE BELOW)
(S &lt;- inputcov(hyp[c("sbp_se","dbp_se")],cor=hyp$rho))
# CHECK WITH THE FIRST STUDY
cov2cor(xpndMat(S[1,]))

# META-ANALYSIS, REML MODEL
model &lt;- mvmeta(cbind(sbp,dbp),S=S,data=hyp)
print(summary(model),digits=2)
round(model$Psi,2)

# META-ANALYSIS, REML MODEL (INPUTTING THE CORRELATION DIRECTLY)
model &lt;- mvmeta(cbind(sbp,dbp),S=cbind(sbp_se,dbp_se)^2,data=hyp,
  control=list(Scor=hyp$rho))
print(summary(model),digits=2)

# META-ANALYSIS, MM MODEL
model &lt;- mvmeta(cbind(sbp,dbp),S=S,data=hyp,method="mm")
print(summary(model),digits=2)
round(model$Psi,2)

# META-REGRESSION, REML MODEL
model &lt;- mvmeta(cbind(sbp,dbp)~ish,S=S,data=hyp)
print(summary(model),digits=2)

# META-REGRESSION, MM MODEL
model &lt;- mvmeta(cbind(sbp,dbp)~ish,S=S,data=hyp,method="mm")
print(summary(model),digits=2)
</code></pre>

<hr>
<h2 id='inputcov'> Input (Co)Variance Matrices </h2><span id='topic+inputcov'></span>

<h3>Description</h3>

<p>This function inputs (co)variance matrices of a set of outcomes given the corresponding standard deviation and correlation values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inputcov(sd, cor=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inputcov_+3A_sd">sd</code></td>
<td>
<p> a <code class="reqn">m \times k</code> matrix of standard deviations for <code class="reqn">k</code> outcomes in <code class="reqn">m</code> matrices, or a vector for <code class="reqn">k</code> outcomes in a single matrix.</p>
</td></tr>
<tr><td><code id="inputcov_+3A_cor">cor</code></td>
<td>
<p> either a vector of length 1, <code class="reqn">m</code> or <code class="reqn">k(k-1)/2</code>, or alternatively a <code class="reqn">k \times k</code> or <code class="reqn">m \times k(k-1)/2</code> matrix. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending the number of outcomes <code class="reqn">k</code> and matrices <code class="reqn">m</code>, the argument <code>cor</code> is interpreted as:
</p>

<ul>
<li><p> if a vector of length 1 (a scalar), the same correlation for all the <code class="reqn">k</code> outcomes for all the <code class="reqn">m</code> matrices;
</p>
</li>
<li><p> if a vector of length <code class="reqn">m</code>, the same correlation for all the <code class="reqn">k</code> outcomes for each of the <code class="reqn">m</code> matrices;
</p>
</li>
<li><p> if a vector of length <code class="reqn">k(k-1)/2</code>, the lower triangular elements (without diagonal, taken by column) of the correlation matrix of the <code class="reqn">k</code> outcomes, the same for all the <code class="reqn">m</code> matrices;
</p>
</li>
<li><p> if a <code class="reqn">k \times k</code> matrix, the correlation matrix for the single matrix (only when <code class="reqn">m</code>=1);
</p>
</li>
<li><p> if a <code class="reqn">m \times k(k-1)/2</code> matrix, each row represents the lower triangular elements (without diagonal, taken by column) of the correlation matrix of the <code class="reqn">k</code> outcomes for each of the <code class="reqn">m</code> matrices.
</p>
</li></ul>



<h3>Value</h3>

<p>For a single matrix, the (co)variance matrix itself. For multiple matrices, a <code class="reqn">m \times k(k+1)/2</code> matrix, where each row represents the vectorized entries of the lower triangle (with diagonal, taken by column) of the related (co)variance matrix (see <code><a href="#topic+vechMat">vechMat</a></code>).
</p>


<h3>Note</h3>

<p>This function is imported from the package <span class="pkg">mixmeta</span>. It is called internally by <code><a href="#topic+mvmeta">mvmeta</a></code> for multivariate models to input the correlation(s) when only the within-unit variances are provided through the argument <code>S</code>. In this case, the correlation values are set through the argument <code>Scor</code> in the control list (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>).
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt;</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+xpndMat">xpndMat</a></code>. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># SOME RANDOM SD FOR A SINGLE MATRIX, WITH CONSTANT CORRELATION
(M &lt;- inputcov(runif(4, 0.1, 3), 0.7))
# CHECK CORRELATION
cov2cor(M)

# NOW WITH A MORE COMPLEX CORRELATION STRUCTURE
(M &lt;- inputcov(runif(3, 0.1, 3), c(0.7,0.2,0.4)))
cov2cor(M)

# MULTIPLE MATRICES
(V &lt;- matrix(runif(5*3, 0.1, 3), 5, 3,
  dimnames=list(1:5, paste("V", 1:3, sep=""))))
inputcov(V, 0.6)

# WITH REAL DATA WHEN CORRELATIONS AVAILABLE
hyp
(S &lt;- inputcov(hyp[c("sbp_se","dbp_se")], cor=hyp$rho))
# CHECK FIRST STUDY
cov2cor(xpndMat(S[1,]))

# USED INTERNALLY IN mvmeta
p53
inputcov(sqrt(p53[c("V1","V2")]), 0.5)
model &lt;- mvmeta(cbind(y1,y2), S=cbind(V1,V2), data=p53, control=list(Scor=0.5))
model$S
</code></pre>

<hr>
<h2 id='inputna'> Input Missing Values </h2><span id='topic+inputna'></span>

<h3>Description</h3>

<p>This function augment data by replacing missing values. It can be used internally in <code><a href="#topic+mvmeta">mvmeta</a></code> through the <code><a href="#topic+mvmeta.control">control</a></code> list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inputna(y, S, inputvar=10^4)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">n</code> units and <code class="reqn">k</code> outcomes:
</p>
<table>
<tr><td><code id="inputna_+3A_y">y</code></td>
<td>
<p> a <code class="reqn">n</code>-dimensional vector (for univariate models) or <code class="reqn">m \times k</code> matrix (for multivariate models) of outcomes.</p>
</td></tr>
<tr><td><code id="inputna_+3A_s">S</code></td>
<td>
<p> series of within-unit variances (or (co)variance matrices for multivariate models) of the estimated outcome(s). For univariate models, this is usually a <code class="reqn">n</code>-dimensional vector. For multivariate models, it can be provided as: a <code class="reqn">m</code>-dimensional list of <code class="reqn">k \times k</code> matrices; a tri-dimensional <code class="reqn">k \times k \times m</code> array; a matrix or data frame with <code class="reqn">n</code> rows and <code class="reqn">k(k+1)/2</code> or <code class="reqn">k</code> columns, depending on the availability of the within-unit correlations.</p>
</td></tr>
<tr><td><code id="inputna_+3A_inputvar">inputvar</code></td>
<td>
<p> multiplier for inputting the missing variances in <code>S</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function augments the data by replacing missing values in the outcomes and the associated (co)variances. Specifically, it replaces missing outcomes and missing covariances (if provided) with 0, and missing variances with the largest observed variance multiplied by <code>inputvar</code>. This value is expected to be very high, by default <code class="reqn">10^4</code>, so that the corresponding observation contributes only negligibly to the final estimate.
</p>


<h3>Value</h3>

<p>A matrix with the first <code class="reqn">k</code> column corresponding to the augmented outcomes, and the remaining <code class="reqn">k(k+1)/2</code> or <code class="reqn">k</code> columns (depending on the availability of the within-study covariances) corresponding to vectorized entries of the lower triangle of the related (co)variance matrices.
</p>


<h3>Note</h3>

<p>Data augmentation used to be the approach to deal with missing values in the first implementation of <span class="pkg">mvmeta</span>. The current algorithms directly account for missing. This function is now imported from the package <span class="pkg">mixmeta</span>.
</p>
<p>Inputting missing values can be useful when two or more outcomes are never observed jointly, and the estimation is entirely based on indirect comparison. This method can be applied in network meta-analysis, also called indirect treatment comparison.
</p>
<p>This approach can produce different results than standard methods, especially when the occurrence of missing is substantial. Preliminary analyses indicate that likelihood-based estimation methods do not seem to be affected, while non-iterative estimators such as method of moments and variance components are more sensitive. The user should be careful on the application of missing augmentation.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Jackson D, Riley R, White IR (2011). Multivariate meta-analysis: Potential and promise. <em>Statistics in Medicine</em>. <b>30</b>(20);2481&ndash;2498.
</p>
<p>White IR (2009). Multivariate random-effects meta-analysis. <em>Stata Journal</em>. <b>9</b>(1):40&ndash;56.
</p>
<p>White IR (2011). Multivariate random-effects meta-regression: updates to mvmeta. <em>Stata Journal</em>. <b>11</b>(2):255-270.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+inputcov">inputcov</a></code> for inputting (co)variance matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># INSPECT THE DATA
head(smoking)

# STANDARD APPROACH TO MISSING DATA
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
mod1 &lt;- mvmeta(y, S)
summary(mod1)

# WITH DATA AUGMENTATION
augdata &lt;- inputna(y, S)
y &lt;- augdata[,1:3]
S &lt;- augdata[,-c(1:3)]
mod2 &lt;- mvmeta(y, S)
summary(mod2)
# NB: SAME PARAMETER ESTIMATES, BUT WRONG NYUMBER OF OBS

# USED INTERNALLY IN mvmeta
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
mod3 &lt;- mvmeta(y, S, control=list(inputna=TRUE))
summary(mod3)
# NOW RIGHT NUMBER OF OBS
</code></pre>

<hr>
<h2 id='logLik.mvmeta'> Extract Log-Likelihood from mvmeta Objects </h2><span id='topic+logLik.mvmeta'></span>

<h3>Description</h3>

<p>This method function returns the log-likelihood for fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="logLik.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric scalar of class <code>"logLik"</code> with attributes, providing the (restricted) log likelihood of the model. Attributes correspond to the component <code>df</code> of <code>mvmeta</code> objects, namely the following scalars: <code>nall</code> (number of observations used for estimation, excluding missing values), <code>nobs</code> (equal to <code>nall</code>, minus the number of fixed-effects coefficients for REML models, <code>fixed</code> (number of estimated fixed-effects coefficients), <code>random</code> (number of estimated (co)variance terms).
</p>


<h3>Note</h3>

<p>This functions is called by <code><a href="stats.html#topic+AIC">AIC</a></code> and <code><a href="stats.html#topic+BIC">BIC</a></code> for computing the Akaike and Bayesian information criteria.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

 
<p>See the default method <code><a href="stats.html#topic+logLik">logLik</a></code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL 
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# LOG-LIKELIHOOD
ll &lt;- logLik(model)
ll
attributes(ll)

# AIC and BIC
AIC(model)
BIC(model)
</code></pre>

<hr>
<h2 id='mlprof.fn'> Likelihood Functions for mvmeta Models </h2><span id='topic+mlprof.fn'></span><span id='topic+remlprof.fn'></span><span id='topic+mlprof.gr'></span><span id='topic+remlprof.gr'></span><span id='topic+iter.igls'></span>

<h3>Description</h3>

<p>These functions compute the value of the log-likelihood and the related vectors of first partial derivatives for random-effects multivariate and univariate meta-analysis and meta-regression, in terms of model parameters. They are meant to be used internally and not directly run by the users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
mlprof.fn(par, Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, ctrl)
mlprof.gr(par, Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, ctrl)

remlprof.fn(par, Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, ctrl)
remlprof.gr(par, Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, ctrl)

iter.igls(Psi, Xlist, ylist, Slist, nalist, k, m)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mlprof.fn_+3A_par">par</code></td>
<td>
<p> a vector representing the random-effects parameters defining the between-study (co)variance matrix.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_psi">Psi</code></td>
<td>
<p> a <code class="reqn">k \times k</code> matrix representing the current estimate of the between-study (co)variance matrix.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_xlist">Xlist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific design matrices for the fixed-effects part of the model. Rows corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_ylist">ylist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific of vectors of estimated outcomes. Entries corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_slist">Slist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of within-study (co)variance matrices of estimated outcomes. Rows and columns corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_nalist">nalist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of <code class="reqn">k</code>-dimensional study-specific logical vectors, identifying missing outcomes.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_k">k</code>, <code id="mlprof.fn_+3A_m">m</code>, <code id="mlprof.fn_+3A_p">p</code>, <code id="mlprof.fn_+3A_nall">nall</code></td>
<td>
<p> numeric scalars: number of outcomes, number of studies included in estimation (equal to the length of lists above), number of predictors (including the intercept), number of observations (excluding missing).</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_bscov">bscov</code></td>
<td>
<p> a string defining the between-study (co)variance structure in likelihood based models. See Details.</p>
</td></tr>
<tr><td><code id="mlprof.fn_+3A_ctrl">ctrl</code></td>
<td>
<p>  list of parameters for controlling the fitting process, usually internally set to default values by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. The name is chosen to avoid conflicts with the argument <code>control</code> in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are called internally by the fitting functions <code><a href="#topic+mvmeta.ml">mvmeta.ml</a></code> and <code><a href="#topic+mvmeta.reml">mvmeta.reml</a></code> to perform iterative optimization algorithms for estimating random effects meta-analytical models.
</p>
<p>The maximization of the (restricted) likelihood starts with few runs of an iterative generalized least square algorithm implemented in <code>iter.igls</code>. This can be regarded as a fast and stable way to get starting values close to the maximum for the Quasi-Newton iterative algorithm, implemented in <code><a href="stats.html#topic+optim">optim</a></code>. Alternatively, starting values can be provided by the user in the control list (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>). The function  <code><a href="stats.html#topic+optim">optim</a></code> requires the algorithms to compute the value of the (restricted) likelihood and (optionally) the vector of its first partial derivatives, provided by the related likelihood functions.
</p>
<p>These functions actually specify the <em>profiled</em> version of the (restricted) likelihood, expressed only in terms of random-effects parameters, while the estimate of the fixed-effects coefficients is provided at each iteration by the internal function <code>glsfit</code>, based on the current value of the between-study (co)variance matrix. At convergence, the value of this profiled version is identical to the full (restricted) likelihood. This approach is computationally efficient, as it reduces the number of parameters in the optimization routine, especially for meta-regression models.
</p>
<p>The random-effects parameters in <code>par</code> depends on the chosen <code><a href="#topic+mvmetaCovStruct">structure</a></code> for the between-study (co)variance matrix. The parameterization ensures the positive-definiteness of the estimated matrix. A Cholesky decomposition is then performed on the marginal (co)variance matrix in order to re-express the problem as standard least square equations, an approach which speeds up the computation of matrix inverses and determinants. These equations are finally solved through a QR decomposition, which guarantees stability. More details are provided in the references below.
</p>
<p>Some parameters of the fitting procedures are determined through <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. Specifically, the user can obtain the Hessian matrix of the estimated parameters (appropriately transformed, see <code><a href="#topic+mvmetaCovStruct">mvmetaCovStruct</a></code>) in the optimization function by setting <code>hessian=TRUE</code>, and specific control settings in the optimization process can be defined by the control list argument <code>optim</code>. These values are passed to the optimization function <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Value</h3>

<p><code>mlprof.fn</code> and <code>remlprof.fn</code> return the value of the (restricted) log-likelihood for a given set of parameters in <code>par</code>. <code>mlprof.gr</code> and <code>remlprof.gr</code> return instead the related vector of first partial derivatives. <code>iter.igls</code> returns an updated estimate of <code>Psi</code> given its initial value or the value at the previous iteration.
</p>


<h3>Note</h3>

<p>As stated earlier, these functions are called internally by <code><a href="#topic+mvmeta.ml">mvmeta.ml</a></code> and <code><a href="#topic+mvmeta.reml">mvmeta.reml</a></code>, and are not meant to be used directly. In particular, their code does not contain any check on the arguments provided, which are expected in specific formats. They are however exported in the namespace and documented for completeness.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Goldstein H (1986). Multilevel mixed linear model analysis using iterative generalized least squares. <em>Biometrika</em>. <b>73</b>(1):43.
</p>
<p>Lindstrom MJ and Bates DM (1988). Newton-Raphson and EM algorithms for linear mixed-effects models for repeated-measures data. <em>Journal of the American Statistical Association</em>. <b>83</b>(404):1014&ndash;1022.
</p>
<p>Pinheiro JC and Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. New York, Springer Verlag.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code> and <code><a href="#topic+mvmeta.ml">mvmeta.ml</a></code> for additional info on the fitting procedures. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> to determine specific parameters of the fitting procedures. See <code><a href="#topic+mvmetaCovStruct">mvmetaCovStruct</a></code> for (co)variance structures. See <code><a href="base.html#topic+chol">chol</a></code> and <code><a href="base.html#topic+qr">qr</a></code> for info on the Cholesky and QR decomposition.
See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>

<hr>
<h2 id='model.frame.mvmeta'> Extract Model Frame and Design Matrix from mvmeta Objects </h2><span id='topic+model.frame.mvmeta'></span><span id='topic+model.matrix.mvmeta'></span>

<h3>Description</h3>

<p>These method functions return the model frame and design matrix for univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
model.frame(formula, ...)

## S3 method for class 'mvmeta'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.frame.mvmeta_+3A_object">object</code>, <code id="model.frame.mvmeta_+3A_formula">formula</code></td>
<td>
<p> an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="model.frame.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model frame is produced by <code><a href="#topic+mvmeta">mvmeta</a></code> when fitting the meta-analytical model, and stored in the <code>mvmeta</code> object if argument <code>model=TRUE</code>. Alternatively, the model frame is directly returned by <code><a href="#topic+mvmeta">mvmeta</a></code> with argument <code>method="model.frame"</code>. The method function <code>model.frame</code> simply extracts the saved model frame if available, or otherwise evaluates a call to <code><a href="#topic+mvmeta">mvmeta</a></code> when <code>method="model.frame"</code>.
</p>
<p>The method function <code>model.matrix</code> extracts the design matrix from a fitted meta-analytical model. It first extract the model frame by calling <code>model.frame</code>, and then passes the call to the default method.
</p>
<p>These methods functions are similar to those provided for regression objects <code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+lm">lm</a></code>.
</p>


<h3>Value</h3>

<p>For <code>model.frame</code>, a data.frame with special attributes (see the default method <code><a href="stats.html#topic+model.frame">model.frame</a></code>) and the additional class <code>"data.frame.mvmeta"</code>.
</p>
<p>For <code>model.matrix</code>, the design matrix used to fit the model.
</p>


<h3>Note</h3>

<p>The reason why these specific method functions are made available for class <code>mvmeta</code>, and in particular why a new class <code>"data.frame.mvmeta"</code> has been defined for model frames, lies in the special handling of missing values in multivariate meta-analysis models fitted with <code><a href="#topic+mvmeta">mvmeta</a></code>. Methods <code><a href="#topic+na.omit.data.frame.mvmeta">na.omit</a></code> and <code><a href="#topic+na.exclude.data.frame.mvmeta">na.exclude</a></code> for class <code>"data.frame.mvmeta"</code> are useful for properly accounting for missing values when fitting these models.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>See Also</h3>

<p>See the default methods <code><a href="stats.html#topic+model.frame">model.frame</a></code> and <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>. See <code><a href="#topic+na.omit.data.frame.mvmeta">na.omit</a></code> and <code><a href="#topic+na.exclude.data.frame.mvmeta">na.exclude</a></code> on the handling of missing values.
See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL AND SUMMARIZE THE RESULTS
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98,method="ml")

# MODEL FRAME
model$model
model.frame(model)
update(model,method="model.frame")
class(model.frame(model))

# MODEL MATRIX
model.matrix(model)
</code></pre>

<hr>
<h2 id='mvmeta'> Fitting Multivariate and Univariate Meta-Analysis and Meta-Regression Models </h2><span id='topic+mvmeta'></span><span id='topic+mvmeta.fit'></span>

<h3>Description</h3>

<p>The function <code>mvmeta</code> performs fixed and random-effects multivariate and univariate meta-analysis and meta-regression, with various estimation methods. The function <code>mvmeta.fit</code> is a wrapper for actual fitting functions based on different estimation methods, usually called internally. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta(formula, S, data, subset, method="reml", bscov="unstr", model=TRUE,
  contrasts=NULL, offset, na.action, control=list())
    
mvmeta.fit(X, y, S, offset=NULL, method="reml", bscov="unstr", control=list())
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mvmeta_+3A_formula">formula</code></td>
<td>
<p> an object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code> (or one that can be coerced to that class) offering a symbolic description of the linear predictor of the model to be fitted to each outcome. Alternatively, for meta-analysis with no predictor, a single  vector (for univariate models) or matrix-type object (for multivariate models). Terms in <code>formula</code> must be vector or matrix-type objects, optionally provided in the <code>data</code> argument below. See Details.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_x">X</code></td>
<td>
<p> a <code class="reqn">m \times p</code> design matrix containing the study-specific predictors. Usually produced internally by <code>mvmeta</code> from <code>formula</code> above.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_y">y</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional vector (for univariate models) or <code class="reqn">m \times k</code> matrix (for multivariate models) of outcomes. Usually produced internally by <code>mvmeta</code> from <code>formula</code> above.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_s">S</code></td>
<td>
<p> series of within-study (co)variance matrices of the estimated outcomes for each one of the <code class="reqn">m</code> studies. Accepted formats by <code>mvmeta</code> are: a <code class="reqn">m</code>-dimensional list of <code class="reqn">k \times k</code> matrices; a tri-dimensional <code class="reqn">k \times k \times m</code> array; a matrix or data frame with <code class="reqn">m</code> rows and <code class="reqn">k(k+1)/2</code> or <code class="reqn">k</code> columns, depending on the availability of the within-study correlations. Optionally, terms may be provided in the <code>data</code> argument below. <code>mvmeta.fit</code> accepts only the last option. See Details below.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_data">data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the variables in <code>formula</code>. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>mvmeta</code> is called.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_subset">subset</code></td>
<td>
<p> an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_method">method</code></td>
<td>
<p> estimation method: <code>"fixed"</code> for fixed-effects models, <code>"ml"</code> or <code>"reml"</code> for random-effects models fitted through (restricted) maximum likelihood, <code>"mm"</code> for random-effects models fitted through method of moments, and <code>"vc"</code> for random-effects models fitted through variance components. See Details below. If <code>"model.frame"</code>, the model frame is returned, as in <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_bscov">bscov</code></td>
<td>
<p> a string defining the between-study (co)variance structure in likelihood based models. Default to <code>"unstr"</code> (unstructured). Among other options, the user can select <code>"diag"</code> (diagonal), <code>"cs"</code> (compound symmetry), <code>"hcs"</code> (heterogeneous compound symmetry), <code>"ar1"</code> (autoregressive of first order), <code>"fixed"</code> (fixed). See Details.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_model">model</code></td>
<td>
<p> a logical value indicating whether the model frame should be included as a component of the returned value. See the <code><a href="#topic+model.frame.mvmeta">model.frame</a></code> method function.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_contrasts">contrasts</code></td>
<td>
<p> an optional list. See the <code>contrasts.arg</code> of <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_offset">offset</code></td>
<td>
<p> optionally, a <code class="reqn">m</code>-dimensional numeric vector used to specify an a priori known component in the linear predictor. One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be included in the formula instead or as well. See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain <code>NA</code>s. Default to <code>na.action</code> setting of <code><a href="base.html#topic+options">options</a></code>, usually <code><a href="#topic+na.omit.data.frame.mvmeta">na.omit</a></code>. <code><a href="#topic+na.exclude.data.frame.mvmeta">na.exclude</a></code> can be useful. See details on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code> in <code>mvmeta</code>.</p>
</td></tr>
<tr><td><code id="mvmeta_+3A_control">control</code></td>
<td>
<p> list of parameters for controlling the fitting process. These are passed to  <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> by <code>mvmeta.fit</code> to replace otherwise selected default values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>mvmeta</code> resembles standard regression functions in <span class="rlang"><b>R</b></span> (see <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>). This function defines the design matrix and the vector (for univariate models) or matrix (for multivariate models) of outcome responses, and calls the wrapper <code>mvmeta.fit</code> to perform the actual fitting. The latter prepares the data and calls specific fitting functions, depending on the chosen <code>method</code>. Functions other than <code>mvmeta</code> are not expected to be called directly for model fitting.
</p>
<p>The model is specified through a regression formula. Simple meta-analysis is specified with the formula <code>y ~ 1</code>, where the left-hand side is a vector (in univariate models) or a matrix (in multivariate models), optionally of form <code>cbind(y1,...,yk)</code>, with terms stored in <code>data</code>. Alternatively, matrix or vector objects are allowed, and the formula is retrieved internally adding <code>~ 1</code>. In meta-regression, other terms are added in the right-hand side of the formula, defining the linear predictor common to all outcomes. Factors, variable transformations and interactions are allowed, following the standard formula specification. Labels are automatically retrieved from the objects in <code>formula</code>. See <code><a href="stats.html#topic+formula">formula</a></code> for further details. See <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code> for info on the other arguments.
</p>
<p>The within-study (co)variances are provided through the argument <code>S</code>, usually as a matrix. If the correlations are available, each of the <code class="reqn">m</code> row represents the <code class="reqn">k(k+1)/2</code> vectorized entries of the lower triangle of the related (co)variance matrix, taken by column (see <code><a href="#topic+xpndMat">xpndMat</a></code>). If correlations are not available, each row represents the <code class="reqn">k</code> variances, and the correlations are inputted internally through the argument <code>Scor</code> of the <code>control</code> list. See <code><a href="#topic+inputcov">inputcov</a></code>.
</p>
<p>Different estimator are available in the package <code>mvmeta</code> and chosen through the argument <code>method</code>. In the current version, the options are:
</p>

<ul>
<li> <p><code>method="fixed"</code>: <code><a href="#topic+mvmeta.fixed">Fixed-effects estimator</a></code>
</p>
</li>
<li> <p><code>method="ml"</code>: <code><a href="#topic+mvmeta.ml">Maximum likelihood (ML) estimator</a></code>
</p>
</li>
<li> <p><code>method="reml"</code>: <code><a href="#topic+mvmeta.reml">Restricted maximum likelihood (REML) estimator</a></code>
</p>
</li>
<li> <p><code>method="mm"</code>: <code><a href="#topic+mvmeta.mm">Method of moments estimator</a></code>
</p>
</li>
<li> <p><code>method="vc"</code>: <code><a href="#topic+mvmeta.vc">Variance components estimator</a></code>
</p>
</li></ul>

<p>Specific fitting functions are called internally. Likelihood-based methods allow alternative <code><a href="#topic+mvmetaCovStruct">(co)variance structures</a></code> for the between-study random effects through the argument <code>bscov</code>. See their help pages for further details on the estimation methods, following the links above.
</p>
<p>Missing values are allowed in both sides of <code>formula</code>. In the case of missing predictors (right-hand side of <code>formula</code>), the related study is entirely excluded from estimation. In contrast, a study still contributes to estimation if at least outcome is non-missing. This behaviour is different than in standard regression functions such as <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>. Before the call to <code>mvmeta.fit</code>, studies matching such missing definition are removed from the the model frame. The missing pattern in <code>S</code> must be consistent with that in <code>y</code>. See further details on handling <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code> in <code>mvmeta</code>.
</p>
<p>The fitting procedure can be controlled through the additional terms specified in <code>control</code>, which are passed to the function <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.
</p>


<h3>Value</h3>

<p>The <code>mvmeta</code> function typically returns a list object of class <code>"mvmeta"</code> representing the meta-analytical model fit, as described in <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>. When <code>method="data.frame"</code>, the model is not fitted and the model frame is returned, namely a data frame with special attributes (see the default method <code><a href="stats.html#topic+model.frame">model.frame</a></code>) and, in this case, the additional class <code>"data.frame.mvmeta"</code>.
</p>
<p>The wrapper function <code>mvmeta.fit</code> is usually called internally in <code>mvmeta</code>, and returns an intermediate list object with some of the components expected in the <code>"mvmeta"</code> class.
</p>
<p>Several method functions for regression objects are available, either default or specifically-written for the <code>"mvmeta"</code> class. See <code><a href="#topic+mvmetaObject">mvmetaObject</a></code> for a complete list.
</p>


<h3>Note</h3>

<p>In the current version, the same linear predictor specified in <code>formula</code> is set for all the outcomes.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Jackson D, Riley R, White IR (2011). Multivariate meta-analysis: Potential and promise. <em>Statistics in Medicine</em>. <b>30</b>(20);2481&ndash;2498.
</p>
<p>White IR (2009). Multivariate random-effects meta-analysis. <em>Stata Journal</em>. <b>9</b>(1):40&ndash;56.
</p>
<p>White IR (2011). Multivariate random-effects meta-regression: updates to mvmeta. <em>Stata Journal</em>. <b>11</b>(2):255-270.
</p>
<p>Berkey, CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>(22):2537&ndash;2550.
</p>


<h3>See Also</h3>

 
<p>See additional info on the estimation procedures at the related page of the fitting functions. See alternative <code><a href="#topic+mvmetaCovStruct">(co)variance structures</a></code> for likelihood-based estimation methods. See handling of <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code> in <code>mvmeta</code>. See <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code> for standard regression functions. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### BIVARIATE META-ANALYSIS, ESTIMATED THROUGH REML

# RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL),S=berkey98[5:7],data=berkey98)

# SUMMARIZE THE RESULTS
summary(model)

# RESIDUALS AND FITTED VALUES
residuals(model)
fitted(model)

# LOG-LIKELIHOOD AND AIC VALUE
logLik(model)
AIC(model)


### BIVARIATE META-REGRESSION, ESTIMATED THROUGH METHOD OF MOMENTS

# RUN THE MODEL AND SUMMARIZE THE RESULTS
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98,method="mm")
summary(model)

# BLUP ESTIMATES AND 90% PREDICTION INTERVALS, AGGREGATED BY OUTCOME
blup(model,pi=TRUE,aggregate="y",pi.level=0.90)

# COCHRAN Q TEST FOR RESIDUAL HETEROGENEITY
qtest(model)

# PREDICTED AVERAGED OUTOCOMES AND STANDARD ERRORS FROM YEAR 1985 TO 1989
newdata &lt;- data.frame(pubyear=1985:1989)
predict(model,newdata,se=TRUE)

# MODEL FRAME AND MODEL MATRIX
model.frame(model)
model.matrix(model)


### UNIVARIATE META-REGRESSION, FIXED-EFFECTS MODEL

# RUN THE MODEL
model &lt;- mvmeta(sbp~ish,S=sbp_se^2,data=hyp,method="fixed")
summary(model)

# RESIDUALS AND FITTED VALUES
residuals(model)
fitted(model)

# COCHRAN Q TEST FOR RESIDUAL HETEROGENEITY
qtest(model)


### MULTIVARIATE META-ANALYSIS WITH MORE THAN 2 OUTCOMES

# RUN THE MODEL
y &lt;- as.matrix(fibrinogen[2:5])
S &lt;- as.matrix(fibrinogen[6:15])
model &lt;- mvmeta(y,S)
summary(model)


### IN THE PRESENCE OF MISSING VALUES

# RUN THE MODEL
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S)
summary(model)

# MODEL FRAME: SEE help(na.omit.data.frame.mvmeta) FOR MORE EXAMPLES
model.frame(model)


### WHEN WITHIN-STUDY COVIARIANCES ARE NOT AVAILABLE AND/OR NEED TO BE INPUTTED

# GENERATE S
(S &lt;- inputcov(hyp[c("sbp_se","dbp_se")],cor=hyp$rho))

# RUN THE MODEL
model &lt;- mvmeta(cbind(sbp,dbp),S=S,data=hyp)

# INPUTTING THE CORRELATION DIRECTLY IN THE MODEL
model &lt;- mvmeta(cbind(y1,y2),cbind(V1,V2),data=p53,control=list(Scor=0.95))
summary(model)

# SEE help(hyp) AND help(p53) FOR MORE EXAMPLES


### STRUCTURING THE BETWEEN-STUDY (CO)VARIANCE

# DIAGONAL
S &lt;- as.matrix(hsls[5:10])
model &lt;- mvmeta(cbind(b1,b2,b3),S,data=hsls,bscov="diag")
summary(model)
model$Psi

# COMPOUND SYMMETRY
model &lt;- mvmeta(cbind(b1,b2,b3),S,data=hsls,bscov="cs")
summary(model)
model$Psi

# SEE help(mvmetaCovStruct) FOR DETAILS AND ADDITIONAL EXAMPLES


### USE OF THE CONTROL LIST

# PRINT THE ITERATIONS AND CHANGE THE DEFAULT FOR STARTING VALUES
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S,control=list(showiter=TRUE,igls.iter=20))

# SEE help(mvmeta.control) FOR FURTHER DETAILS
</code></pre>

<hr>
<h2 id='mvmeta.control'> Ancillary Parameters for Controlling the Fit in mvmeta Models </h2><span id='topic+mvmeta.control'></span>

<h3>Description</h3>

<p>This internal function sets the parameter options used for fitting meta-analytical models, commonly to pre-specified default values. It is usually internally called by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta.control(optim=list(), showiter=FALSE, maxiter=100, initPsi=NULL,
  Psifix=NULL,Psicor=0, Scor=0, inputna=FALSE, inputvar=10^4, igls.iter=10, 
  hessian=FALSE, vc.adj=TRUE,reltol=sqrt(.Machine$double.eps),
  set.negeigen=sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvmeta.control_+3A_optim">optim</code></td>
<td>
<p> list of parameters passed to the <code>control</code> argument of the function <code><a href="stats.html#topic+optim">optim</a></code>, which performs the quasi-Newton optimization in likelihood-based random-effects models. See <code><a href="stats.html#topic+optim">optim</a></code> for the list of arguments. See Details for additional info.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_showiter">showiter</code></td>
<td>
<p> logical. If <code>TRUE</code>, the progress of iterative optimization is shown.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_maxiter">maxiter</code></td>
<td>
<p> positive interger value. Maximum number of iterations in methods involving optimization procedures.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_initpsi">initPsi</code></td>
<td>
<p> either a matrix or a vector of its lower triangular elements (with diagonal, taken by column) from which starting values of the parameters of the between-study (co)variance matrix are derived, used in the optimization procedure for likelihood-based random-effects models. If <code>NULL</code> (the default, and recommended), the starting value is created internally through an iterative generalized least square algorithm.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_psifix">Psifix</code></td>
<td>
<p> either a matrix or a vector of its lower triangular elements (with diagonal, taken by column) equal or proportional to the between-study (co)variance. Only used when <code>bscov="fixed"</code> or <code>bscov="prop"</code> in <code><a href="#topic+mvmeta">mvmeta</a></code>, and, if not provided, it set internally to a 0 or identity matrix, respectively.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_psicor">Psicor</code></td>
<td>
<p>  either a scalar, vector or matrix representing the between-study correlation(s) (see <code><a href="#topic+inputcov">inputcov</a></code>). Only used when <code>bscov="cor"</code> in <code><a href="#topic+mvmeta">mvmeta</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_scor">Scor</code></td>
<td>
<p> either a scalar, vector or matrix representing the within-study correlation(s) to be inputted when the covariances are not provided, and ignored if they are (see <code><a href="#topic+inputcov">inputcov</a></code>).</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_inputna">inputna</code></td>
<td>
<p> logical. If missing values must be internally inputted. To be used with caution, see <code><a href="#topic+inputna">inputna</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_inputvar">inputvar</code></td>
<td>
<p> multiplier for inputting the missing variances, to be passed as an argument to <code><a href="#topic+inputna">inputna</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_igls.iter">igls.iter</code></td>
<td>
<p> number of iteration of the iterative generalized least square algorithm to be run in the hybrid optimization procedure of linkelihood-based models to provide the starting value. See <code><a href="#topic+iter.igls">iter.igls</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_hessian">hessian</code></td>
<td>
<p> logical. If <code>TRUE</code>, the Hessian matrix of the parameters estimated in the optimization process is computed and returned. Only applicable to likelihood-based estimation methods. For details, see the info provided in the help pages of the <code><a href="#topic+mlprof.fn">optimizations algorithms</a></code> and <code><a href="#topic+mvmetaCovStruct">(co)variance structure</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_vc.adj">vc.adj</code></td>
<td>
<p> logical. If <code>TRUE</code>, an adjustement to the way the marginal variance part is computed in the variance components estimator is applied. See <code><a href="#topic+mvmeta.vc">mvmeta.vc</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_reltol">reltol</code></td>
<td>
<p> relative convergence tolerance in methods involving optimization procedures. The algorithm stops if it is unable to reduce the value by a factor of <code>reltol * (abs(val) + reltol)</code> at a step.</p>
</td></tr>
<tr><td><code id="mvmeta.control_+3A_set.negeigen">set.negeigen</code></td>
<td>
<p> positive value. Value to which negative eigenvalues are to be set in estimators where such method is used to force positive semi-definiteness of the estimated between-study (co)variance matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The control argument of <code><a href="#topic+mvmeta">mvmeta</a></code> is by default passed to <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, which uses its elements as arguments of <code>mvmeta.control</code>.
</p>
<p>Many arguments refer to specific fitting procedures. Refer to the help page of the related estimator for details.
</p>
<p>The function automatically sets non-default values for some control arguments for <code><a href="stats.html#topic+optim">optim</a></code>, unless explicitly set in the list passed to it. Specifically, the function selects <code>fnscale=-1</code>, <code>maxit=maxiter</code> and <code>reltol=reltol</code>, where the latter two are specified by other arguments of this function.
</p>
<p>The function is expected to be extended and/or modified at every release of the package <span class="pkg">mvmeta</span>.
</p>


<h3>Value</h3>

<p>A list with components named as the arguments.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+mvmeta">mvmeta</a></code>. See also <code><a href="stats.html#topic+glm.control">glm.control</a></code>. See the help pages of the related fitting functions for details on each parameter. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># PRINT THE ITERATIONS (SEE ?optim) AND CHANGE THE DEFAULT FOR STARTING VALUES
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98,
  control=list(showiter=TRUE,igls.iter=20))
  
# INPUT THE CORRELATION
model &lt;- mvmeta(cbind(y1,y2),S=cbind(V1,V2),data=p53,control=list(Scor=0.5))
</code></pre>

<hr>
<h2 id='mvmeta.fixed'> Fixed-Effects Estimator for mvmeta Models </h2><span id='topic+mvmeta.fixed'></span>

<h3>Description</h3>

<p>This function implements a generalized least square estimator for fixed-effects multivariate and univariate meta-analysis and meta-regression. It is meant to be used internally and not directly run by the users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta.fixed(Xlist, ylist, Slist, nalist, k, m, p, nall, control, ...)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mvmeta.fixed_+3A_xlist">Xlist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific design matrices for the fixed-effects part of the model. Rows corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_ylist">ylist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific vectors of estimated outcomes. Entries corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_slist">Slist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of within-study (co)variance matrices of estimated outcomes. Rows and columns corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_nalist">nalist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of <code class="reqn">k</code>-dimensional study-specific logical vectors, identifying missing outcomes.</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_k">k</code>, <code id="mvmeta.fixed_+3A_m">m</code>, <code id="mvmeta.fixed_+3A_p">p</code>, <code id="mvmeta.fixed_+3A_nall">nall</code></td>
<td>
<p> numeric scalars: number of outcomes, number of studies included in estimation (equal to the length of lists above), number of predictors (including the intercept), number of observations (excluding missing).</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_control">control</code></td>
<td>
<p> list of parameters for controlling the fitting process, usually internally set to default values by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.fixed_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation involves only the <code class="reqn">kp</code> fixed-effects coefficients.
</p>
<p>The routine is based on a standard generalized least square (GLS) algorithm implemented in the internal function <code>glsfit</code>. The between-study (co)variance matrix is set to zero, so the marginal (co)variance matrix, composed only by elements of the within-study component, is assumed as completely known. Similarly to the likelihood-based estimators implemented in  <code><a href="#topic+mvmeta.ml">mvmeta.ml</a></code> and <code><a href="#topic+mvmeta.reml">mvmeta.reml</a></code>, the computation involves Cholesky and and QR decompositions for computational stability and efficiency. The method is described in details in Gasparrini and collaborators (2012) (see references below).
</p>


<h3>Value</h3>

<p>This function returns an intermediate list object, whose components are then processed by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>. Other components are added later through <code><a href="#topic+mvmeta">mvmeta</a></code> to finalize an object of class <code>"mvmeta"</code>.
</p>


<h3>Note</h3>

<p>As stated earlier, this function is called internally by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, and is not meant to be used directly. In particular, its code does not contain any check on the arguments provided, which are expected in specific formats. The function is however exported in the namespace and documented for completeness.
</p>
<p>The arguments above are prepared by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code> from its arguments <code>X</code>, <code>y</code> and <code>S</code>. The list structure, although requiring more elaborate coding, is computationally more efficient, as it avoids the specification of sparse block-diagonal matrices, especially for meta-analysis involving a large number of studies.
</p>
<p>Some parameters of the fitting procedures are determined by the <code>control</code> argument, with default set by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. No missing values are accepted in the fitting functions. See details on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Berkey, CS, Anderson JJ, Hoaglin DC (1996). Multiple-outcome meta-analysis of clinical trials. <em>Statistics in Medicine</em>. <b>15</b>(5):537&ndash;547.
</p>
<p>Berkey, CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>(22):2537&ndash;2550.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta">mvmeta</a></code> for the general usage of the functions. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> to determine specific parameters of the fitting procedures. Use the triple colon operator ('<code>:::</code>') to access the code of the internal functions, such as <code>glsfit</code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># UNIVARIATE FIXED-EFFECTS MODEL
model &lt;- mvmeta(yC,S=SCC,data=smoking,method="fixed")
summary(model)

# MULTIVARIATE FIXED-EFFECTS MODEL
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S,method="fixed")
summary(model)

# MULTIVARIATE FIXED-EFFECTS MODEL: REPLICATE THE RESULTS IN BERKEY ET AL. 1998
model &lt;- mvmeta(cbind(PD,AL)~I(pubyear-1983),S=berkey98[5:7],
  data=berkey98,method="fixed")
summary(model)
</code></pre>

<hr>
<h2 id='mvmeta.ml'> ML and REML Estimators for mvmeta Models </h2><span id='topic+mvmeta.ml'></span><span id='topic+mvmeta.reml'></span>

<h3>Description</h3>

<p>These functions implement maximum likeliihood (ML) and restricted maximum likelihood (REML) estimators for random-effects multivariate and univariate meta-analysis and meta-regression. They are meant to be used internally and not directly run by the users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta.ml(Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, control, ...)

mvmeta.reml(Xlist, ylist, Slist, nalist, k, m, p, nall, bscov, control, ...)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mvmeta.ml_+3A_xlist">Xlist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific design matrices for the fixed-effects part of the model. Rows corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_ylist">ylist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific vectors of estimated outcomes. Entries corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_slist">Slist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of within-study (co)variance matrices of estimated outcomes. Rows and columns corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_nalist">nalist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of <code class="reqn">k</code>-dimensional study-specific logical vectors, identifying missing outcomes.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_k">k</code>, <code id="mvmeta.ml_+3A_m">m</code>, <code id="mvmeta.ml_+3A_p">p</code>, <code id="mvmeta.ml_+3A_nall">nall</code></td>
<td>
<p> numeric scalars: number of outcomes, number of studies included in estimation (equal to the length of lists above), number of predictors (including the intercept), number of observations (excluding missing).</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_bscov">bscov</code></td>
<td>
<p> a string defining the between-study (co)variance structure in likelihood based models. See Details.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_control">control</code></td>
<td>
<p> list of parameters for controlling the fitting process, usually internally set to default values by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.ml_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation involves <code class="reqn">kp</code> fixed-effects coefficients and a number of random-effects parameters defining the between-study (co)variance matrix, depending on the chosen <code><a href="#topic+mvmetaCovStruct">(co)variance structure</a></code>. Up to <code class="reqn">k(k+1)/2</code> parameters are needed for an unstructured form, while a smaller set are required for structed matrices
</p>
<p>The hybrid estimation procedure is based first on few runs of iterative generalized least square algorithm and then quasi-Newton iterations, using specific <code><a href="#topic+mlprof.fn">likelihood functions</a></code>, until convergence. The estimation algorithm adopts a profiled (or concentrated) approach, that is expressed only in terms of the random-effects parameters. Cholesky and and QR decompositions are used for computational stability and efficiency, and for assuring the positive-definiteness of the estimated between-study (co)variance matrix. See the help page for the <code><a href="#topic+mlprof.fn">likelihood functions</a></code> for further details. The method is described in details in Gasparrini and collaborators (2012) (see references below).
</p>


<h3>Value</h3>

<p>These functions return an intermediate list object, whose components are then processed by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>. Other components are added later through <code><a href="#topic+mvmeta">mvmeta</a></code> to finalize an object of class <code>"mvmeta"</code>.
</p>


<h3>Note</h3>

<p>As stated earlier, these functions are called internally by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, and are not meant to be used directly. In particular, their code does not contain any check on the arguments provided, which are expected in specific formats. The functions are not exported in the namespace, and only documented for completeness.
</p>
<p>The arguments above are prepared by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code> from its arguments <code>X</code>, <code>y</code> and <code>S</code>. The list structure, although requiring more elaborate coding, is computationally more efficient, as it avoids the specification of sparse block-diagonal matrices, especially for meta-analysis involving a large number of studies.
</p>
<p>Some parameters of the fitting procedures are determined by the <code>control</code> argument, with default set by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. No missing values are accepted in the fitting functions. See details on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Pinheiro JC and Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. New York, Springer Verlag.
</p>
<p>Lindstrom MJ and Bates DM (1988). Newton-Raphson and EM algorithms for linear mixed-effects models for repeated-measures data. <em>Journal of the American Statistical Association</em>. <b>83</b>(404):1014&ndash;1022.
</p>
<p>White IR (2009). Multivariate random-effects meta-analysis. <em>Stata Journal</em>. <b>9</b>(1):40&ndash;56.
</p>
<p>White IR (2011). Multivariate random-effects meta-regression: updates to mvmeta. <em>Stata Journal</em>. <b>11</b>(2):255-270.
</p>
<p>Goldstein H (1986). Multilevel mixed linear model analysis using iterative generalized least squares. <em>Biometrika</em>. <b>73</b>(1):43.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta">mvmeta</a></code> for the general usage of the functions. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> to determine specific parameters of the fitting procedures. Use the triple colon operator ('<code>:::</code>') to access the code of the internal functions, such as <code>glsfit</code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># REML ESTIMATOR: UNIVARIATE MODEL
model &lt;- mvmeta(yC,S=SCC,data=smoking)
summary(model)

# REML ESTIMATOR: REPRODUCE THE RESULTS IN WHITE (2011)
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S)
summary(model)

# ML ESTIMATOR: REPRODUCE THE RESULTS IN BERKEY ET AL. (1998)
year &lt;- berkey98$pubyear - 1983
model &lt;- mvmeta(cbind(PD,AL)~year,S=berkey98[5:7],data=berkey98,method="ml")
print(summary(model),digits=3)
round(model$Psi,3)

# UNSTRUCTURED AND STRUCTURED BETWEEN-STUDY (CO)VARIANCE
y &lt;- as.matrix(fibrinogen[2:5])
S &lt;- as.matrix(fibrinogen[6:15])
model &lt;- mvmeta(y,S)
summary(model)
model &lt;- mvmeta(y,S,bscov="diag")
summary(model)
model &lt;- mvmeta(y,S,bscov="hcs")
summary(model)

# SEE help(mvmetaCovStruct) for additional info and examples
</code></pre>

<hr>
<h2 id='mvmeta.mm'> Method of Moments Estimator for mvmeta Models </h2><span id='topic+mvmeta.mm'></span>

<h3>Description</h3>

<p>This function implements a method of moments estimator for multivariate and univariate  random-effects meta-analysis and meta-regression. It is meant to be used internally and not directly run by the users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta.mm(Xlist, ylist, Slist, nalist, k, m, p, nall, control, ...)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mvmeta.mm_+3A_xlist">Xlist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific design matrices for the fixed-effects part of the model. Rows corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_ylist">ylist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific vectors of estimated outcomes. Entries corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_slist">Slist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of within-study (co)variance matrices of estimated outcomes. Rows and columns corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_nalist">nalist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of <code class="reqn">k</code>-dimensional study-specific logical vectors, identifying missing outcomes.</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_k">k</code>, <code id="mvmeta.mm_+3A_m">m</code>, <code id="mvmeta.mm_+3A_p">p</code>, <code id="mvmeta.mm_+3A_nall">nall</code></td>
<td>
<p> numeric scalars: number of outcomes, number of studies included in estimation (equal to the length of lists above), number of predictors (including the intercept), number of observations (excluding missing).</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_control">control</code></td>
<td>
<p> list of parameters for controlling the fitting process, usually internally set to default values by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.mm_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation involves <code class="reqn">kp</code> fixed-effects coefficients and <code class="reqn">k(k+1)/2</code> random-effects parameters, corresponding to the lower triangular entries of the between-study (co)variance matrix.
</p>
<p>The approach implemented here represents the multivariate extension of the traditional estimator proposed by DerSimonian and Laird (1986), and simplifies to the standard method in the univariate case. This non-iterative routine forces the positive semi-definiteness of the estimated between-study (co)variance matrix by setting its negative eigenvalues to zero.
</p>
<p>The specific method of moment estimator used here is described in Jackson and collaborators (2013), and represents a generalization of that developed by Chen and collaborators (2012). However, this general version is computationally more intensive, and may turn out to be slow when applied to meta-analysis of a relatively high number of studies. An alternative and computationally faster method of moment estimator was previously proposed by Jackson and collaborators (2010), although it is not invariant to reparameterization. This latter estimator is not implemented yet in <span class="pkg">mvmeta</span>. See references below.
</p>


<h3>Value</h3>

<p>This function returns an intermediate list object, whose components are then processed by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>. Other components are added later through <code><a href="#topic+mvmeta">mvmeta</a></code> to finalize an object of class <code>"mvmeta"</code>.
</p>


<h3>Note</h3>

<p>As stated earlier, this function is called internally by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, and is not meant to be used directly. In particular, its code does not contain any check on the arguments provided, which are expected in specific formats. The function is however exported in the namespace and documented for completeness.
</p>
<p>The arguments above are prepared by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code> from its arguments <code>X</code>, <code>y</code> and <code>S</code>. The list structure, although requiring more elaborate coding, is computationally more efficient, as it avoids the specification of sparse block-diagonal matrices, especially for meta-analysis involving a large number of studies.
</p>
<p>Some parameters of the fitting procedures are determined by the <code>control</code> argument, with default set by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. No missing values are accepted in the fitting functions. See details on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Jackson D, White IR, Riley RD (2013). A matrix based method of moments for fitting the multivariate random effects model for meta-analysis and meta-regression. <em>Biometrical Journal</em>. <b>55</b>(2):231-245.
</p>
<p>Chen H, Manning AK, Dupuis J (2012). A method of moments estimator for random effect multivariate meta-analysis. <em>Biometrics</em>. <b>68</b>(4):1278-1284.
</p>
<p>Jackson D, White IR, Thompson SG (2010). Extending DerSimonian and Laird's methodology to perform multivariate random effects meta-analyses. <em>Statistics in Medicine</em>. <b>29</b>(12):1282&ndash;1297.
</p>
<p>DerSimonian R, Laird N (1986). Meta-analysis in clinical trials. <em>Controlled Clinical Trials</em>. <b>7</b>(3):177-188.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta">mvmeta</a></code> for the general usage of the functions. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> to determine specific parameters of the fitting procedures. Use the triple colon operator ('<code>:::</code>') to access the code of the internal functions, such as <code>fbtr</code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># MM ESTIMATOR: UNIVARIATE MODEL
model &lt;- mvmeta(PD~pubyear,S=berkey98[,5],data=berkey98,method="mm")
summary(model)

# MM ESTIMATOR: REPRODUCE THE RESULTS IN CHEN ET AL. (2012)
S &lt;- as.matrix(hsls[5:10])
model &lt;- mvmeta(cbind(b1,b2,b3),S,data=hsls,method="mm")
summary(model)

# MM ESTIMATOR: REPRODUCE THE RESULTS IN JACKSON ET AL. (2013)
S &lt;- inputcov(hyp[c("sbp_se","dbp_se")],cor=hyp$rho)
model &lt;- mvmeta(cbind(sbp,dbp),S=S,data=hyp,method="mm")
summary(model)
</code></pre>

<hr>
<h2 id='mvmeta.vc'> Variance Components Estimator for mvmeta Models </h2><span id='topic+mvmeta.vc'></span>

<h3>Description</h3>

<p>This function implements a variance components estimator for multivariate and univariate  random-effects meta-analysis and meta-regression. It is meant to be used internally and not directly run by the users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmeta.vc(Xlist, ylist, Slist, nalist, k, m, p, nall, control, ...)
</code></pre>


<h3>Arguments</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">m</code> studies, <code class="reqn">k</code> outcomes and <code class="reqn">p</code> predictors:
</p>
<table>
<tr><td><code id="mvmeta.vc_+3A_xlist">Xlist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific design matrices for the fixed-effects part of the model. Rows corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_ylist">ylist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of study-specific vectors of estimated outcomes. Entries corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_slist">Slist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of within-study (co)variance matrices of estimated outcomes. Rows and columns corresponding to missing outcomes have been excluded.</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_nalist">nalist</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional list of <code class="reqn">k</code>-dimensional study-specific logical vectors, identifying missing outcomes.</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_k">k</code>, <code id="mvmeta.vc_+3A_m">m</code>, <code id="mvmeta.vc_+3A_p">p</code>, <code id="mvmeta.vc_+3A_nall">nall</code></td>
<td>
<p> numeric scalars: number of outcomes, number of studies included in estimation (equal to the length of lists above), number of predictors (including the intercept), number of observations (excluding missing).</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_control">control</code></td>
<td>
<p> list of parameters for controlling the fitting process, usually internally set to default values by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.</p>
</td></tr>
<tr><td><code id="mvmeta.vc_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation involves <code class="reqn">kp</code> fixed-effects coefficients and <code class="reqn">k(k+1)/2</code> random-effects parameters, corresponding to the lower triangular entries of the between-study (co)variance matrix.
</p>
<p>The procedure is based on the estimate of the between-study (co)variance as the difference between the marginal (co)variance and the average within-study (co)variance. This in turn requires the estimate of the marginal (co)variance, obtained by the residuals of the fitted model. The procedure is iterative, with the current estimate of the between-study (co)variance plugged into a generalized least square (GLS) routine. Starting values are provided by a fixed-effects estimator (see <code><a href="#topic+mvmeta.fixed">mvmeta.fixed</a></code>). The algorithm is fast and generally converges with few iterations.
</p>
<p>Similar versions of this estimator has been previously proposed. Berkey and collaborators (1998) simply called it GLS method, and a non-iterative approach was proposed by Ritz and collaborators (2008), referred to as MVEE3. A non-iterative version for univariate models is discussed in Sidik and Jonkman (2007). The results from Berkey and collaborators (1998) are reproduced in the example below.
</p>
<p>In the original approach, the estimate of the marginal (co)variance is obtained from the sum of the residual components using a denominator equal to <code>m-p</code>. Following the development proposed by Kauermann and Carroll (2001) and Fay and Graubard (2001) in the context of sandwich (co)variance estimators, then discussed by Lu and collaborators (2007), an adjusted denominator can be computed as a quantity derived from the hat matrix. This method is expected to perform better in the presence of missing values and small data sets. This alternative adjustment is chosen by default by setting <code>vc.adj=TRUE</code> in the <code>control</code> argument.
</p>
<p>The variance component estimator is not bounded to provide a positive semi-definite between-study (co)variance matrix, as shown in the simulation study by Liu and colleagues (2009). Here positive semi-definiteness is forced by setting the negative eigenvalues of the estimated matrix to zero at each iteration. Little is known about the impact of such constraint.
</p>


<h3>Value</h3>

<p>This function returns an intermediate list object, whose components are then processed by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>. Other components are added later through <code><a href="#topic+mvmeta">mvmeta</a></code> to finalize an object of class <code>"mvmeta"</code>.
</p>


<h3>Note</h3>

<p>As stated earlier, this function is called internally by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code>, and is not meant to be used directly. In particular, its code does not contain any check on the arguments provided, which are expected in specific formats. The function is however exported in the namespace and documented for completeness.
</p>
<p>The arguments above are prepared by <code><a href="#topic+mvmeta.fit">mvmeta.fit</a></code> from its arguments <code>X</code>, <code>y</code> and <code>S</code>. The list structure, although requiring more elaborate coding, is computationally more efficient, as it avoids the specification of sparse block-diagonal matrices, especially for meta-analysis involving a large number of studies.
</p>
<p>Some parameters of the fitting procedures are determined by the <code>control</code> argument, with default set by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. No missing values are accepted in the fitting functions. See details on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Ritz J, Demidenko E, Spiegelman G (2008). Multivariate meta-analysis for data consortia, individual patient meta-analysis, and pooling projects. <em>Journal of Statistical Planning and Inference</em>. <b>139</b>(7):1919&ndash;1933.
</p>
<p>Berkey, CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>(22):2537&ndash;2550.
</p>
<p>Liu Q, Cook NR, Bergstrom A, Hsieh CC (2009). A two-stage hierarchical regression model for meta-analysis of epidemiologic nonlinear dose-response data. <em>Computational Statistics and Data Analysis</em>. <b>53</b>(12):4157&ndash;4167
</p>
<p>Sidik K, Jonkman JN (2007). A comparison of heterogeneity variance estimators in combining results of studies. <em>Statistics in  Medicine</em>. <b>26</b>(9):1964&ndash;81.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta">mvmeta</a></code> for the general usage of the functions. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> to determine specific parameters of the fitting procedures. Use the triple colon operator ('<code>:::</code>') to access the code of the internal functions, such as <code>sumlist</code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># VC ESTIMATOR: UNIVARIATE MODEL
model &lt;- mvmeta(PD~pubyear,S=berkey98[,5],data=berkey98,method="vc")
summary(model)

# VC ESTIMATOR: MULTIVARIATE MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98,method="vc")
summary(model)

# VC ESTIMATOR: NON-ITERATIVE VERSION
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98,method="vc",
  control=list(maxiter=1))
summary(model)

# VARIANCE COMPONENTS ESTIMATOR: REPLICATE THE RESULTS IN BERKEY ET AL. (1998)
model &lt;- mvmeta(cbind(PD,AL)~I(pubyear-1983),S=berkey98[5:7],
  data=berkey98,method="vc",control=list(vc.adj=FALSE))
summary(model)
</code></pre>

<hr>
<h2 id='mvmetaCovStruct'> Covariance Structures for mvmeta Models </h2><span id='topic+mvmetaCovStruct'></span>

<h3>Description</h3>

<p>Alternative covariance structures for the between-study (co)variance matrix of random effects in multivariate meta-analysis or meta-regression, usually defined through the argument <code>bscov</code> of the function <code><a href="#topic+mvmeta">mvmeta</a></code>.
</p>


<h3>Options</h3>

<p>Assuming a meta-analysis or meta-regression based on <code class="reqn">k</code> outcomes:
</p>

<ul>
<li> <p><code>unstr</code>: an unstructured form for a general positive-definite matrix. The matrix is represented by <code class="reqn">k(k+1)/2</code> unrestricted parameters defined as the upper triangular entries of its Cholesky decomposition.
</p>
</li>
<li> <p><code>diag</code>: a diagonal positive-definite matrix. The matrix is represented by <code class="reqn">k</code> unrestricted parameters defined as the logarithm of the diagonal values.
</p>
</li>
<li> <p><code>id</code>: a multiple of the identity positive-definite matrix. The matrix is represented by a single unrestricted parameter defined as the logarithm of the diagonal value.
</p>
</li>
<li> <p><code>cs</code>: a positive-definite matrix with compound symmetry structure. The matrix is represented by 2 unrestricted parameters defined as the logarithm of the diagonal value and the transformed correlation. The latter is parameterized so to obtain a correlation value between <code class="reqn">-1/(k-1)</code> and 1, in order to ensure positive-definiteness.
</p>
</li>
<li> <p><code>hcs</code>: a positive-definite matrix with heterogeneous compound symmetry structure. The matrix is represented by <code class="reqn">k+1</code> unrestricted parameters defined as the logarithm of the diagonal values and the transformed correlation. The latter is parameterized so to obtain a correlation value between <code class="reqn">-1/(k-1)</code> and 1, in order to ensure positive-definiteness.
</p>
</li>
<li> <p><code>ar1</code>: a positive-definite matrix with autoregressive structure of first order. The matrix is represented by <code class="reqn">k+1</code> unrestricted parameters defined as the logarithm of the diagonal value and the logistic transformed correlation. The latter is parameterized so to obtain a correlation value between -1 and 1.
</p>
</li>
<li> <p><code>prop</code>: a positive-definite matrix proportional to that provided by the user through the argument <code>Psifix</code> in the control list (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>). The matrix is represented by 1 unrestricted parameter defined as the logarithm of the multiplier.
</p>
</li>
<li> <p><code>cor</code>: a positive-definite matrix with correlation structure provided by the user through the argument <code>Psicor</code> in the control list (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>). The matrix is represented by <code class="reqn">k</code> unrestricted parameters defined as the logarithm of the diagonal values.
</p>
</li>
<li> <p><code>fixed</code>: a known matrix provided by the user through the argument <code>Psifix</code> in the control list (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>). The matrix is known and no parameters are needed to represent it.
</p>
</li></ul>



<h3>Details</h3>

<p>The structuring of the between-study (co)variance matrix of random effects is only available for models estimated through (restricted) maximum likelihood.
</p>
<p>The unrestricted parameters defining the between-study matrix are estimated in the iterative optimization algorithm. The starting values are usually obtained by a iterative generalized least square algorithm (see the specific <code><a href="#topic+mlprof.fn">likelihood functions</a></code>). The algorithm computes an unstructured matrix. For structured forms, the starting values for variances and/or correlations are taken as the average of the related elements. Although rarely needed and not recommeded, the user can provided a starting value of the (co)variance matrix, from which the parameters are derived (see <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>).
</p>


<h3>Note</h3>

<p>The choice of structures can affect the performance of the optimization procedure, determining forms of likelihood surfaces which induce convergence to local maxima. In particular, structures such as multiple of identity of proportional to a fixed matrix are based on strong assumptions and should be used with caution.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Pinheiro JC and Bates DM (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. New York, Springer Verlag.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+mvmeta">mvmeta</a></code>. See <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code> for standard regression functions. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># UNSTRUCTURED AND STRUCTURED BETWEEN-STUDY (CO)VARIANCE
y &lt;- as.matrix(fibrinogen[2:5])
S &lt;- as.matrix(fibrinogen[6:15])
model &lt;- mvmeta(y,S)
summary(model)
model$Psi

# DIAGONAL
model &lt;- mvmeta(y,S,bscov="diag")
summary(model)
model$Psi

# HETEROGENEOUS COMPOUND SYMMETRY
model &lt;- mvmeta(y,S,bscov="hcs")
summary(model)
model$Psi

# PROPORTIONAL
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S,bscov="prop",control=list(Psifix=diag(3)+1))
summary(model)
model$Psi

# CORRELATION
model &lt;- mvmeta(y,S,bscov="cor",control=list(Psicor=0.2))
summary(model)
model$Psi
</code></pre>

<hr>
<h2 id='mvmetaObject'> mvmeta Objects </h2><span id='topic+mvmetaObject'></span>

<h3>Description</h3>

<p>An object returned by the <code><a href="#topic+mvmeta">mvmeta</a></code> function, inheriting from class <code>"mvmeta"</code>, and representing a fitted univariate or multivariate meta-analytical model.
</p>


<h3>Value</h3>

<p>Objects of class <code>"mvmeta"</code> are lists with defined components. Dimensions of such components may refer to <code class="reqn">k</code> outcome parameters, <code class="reqn">p</code> predictors and <code class="reqn">m</code> studies used for fitting the model (the latter can be different from those originally selected due to missing). The following components needs to be included in a legitimate <code>mvmeta</code> object:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a <code class="reqn">p</code>-dimensional vector (for univariate models) or a <code class="reqn">p \times k</code> matrix (for multivariate models) of the fixed-effects coefficients.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> estimated <code class="reqn">kp \times kp</code> (co)variance matrix of the fixed-effects coefficients.</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p> for random-effects models, the estimated <code class="reqn">k \times k</code> between-study (co)variance matrix.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional vector (for univariate models) or <code class="reqn">m \times k</code> matrix (for multivariate models) of residuals, that is observed minus fitted values.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional vector (for univariate models) or <code class="reqn">m \times k</code> matrix (for multivariate models) of fitted mean values.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p> the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p> the numeric rank of the fitted model.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p> the (restricted) log-likelihood of the fitted model. Set to <code>NA</code> for non-likelihood models.</p>
</td></tr>
<tr><td><code>converged</code>, <code>niter</code></td>
<td>
<p> for models with iterative estimation methods, logical scalar indicating if the algorithm eventually converged.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p> parameters estimated in the optimization process when using likelihood-based estimators. These correspond to trasformations of entries of the between-study (co)variance matrix of random effects, dependent on chosen <code><a href="#topic+mvmetaCovStruct">(co)variance structure</a></code>. See also the <code><a href="#topic+mlprof.fn">optimizations algorithms</a></code> for details.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p> Hessian matrix of the estimated parameters in <code>par</code> above, only returned if <code>hessian=TRUE</code> in <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>. See the related <code><a href="#topic+mlprof.fn">optimizations algorithms</a></code> for details.</p>
</td></tr>
<tr><td><code>negeigen</code></td>
<td>
<p> for models fitted through method of moments, the number of negative eigenvalues in the estimated between-study (co)variance matrix, then set to 0.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p> a list with the values of the control arguments used, as returned by <code><a href="#topic+mvmeta.control">mvmeta.control</a></code>.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the estimation method.</p>
</td></tr>
<tr><td><code>bscov</code></td>
<td>
<p> a string defining the between-study (co)variance structure in likelihood based models.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p> a <code class="reqn">m \times k(k+1)/2</code> matrix, where each row represents the vectorized entries of the lower triangle of the related within-study (co)variance matrix, taken by column. See <code><a href="#topic+mvmeta">mvmeta</a></code>.</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p> list with the following scalar components: <code>m</code> (number of studies included in estimation, which could be lower than the total number in the presence of missing values), <code>k</code> (number of outcome parameters), <code>p</code> (number of coefficients for each outcome parameter).</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> list with the following scalar components: <code>nall</code> (number of observations used for estimation, excluding missing values), <code>nobs</code> (equal to <code>nall</code>, minus the number of fixed-effects coefficients in REML models), <code>fixed</code> (number of estimated fixed-effects coefficients), <code>random</code> (number of estimated (co)variance terms).</p>
</td></tr>
<tr><td><code>lab</code></td>
<td>
<p> list with the following label vectors: <code>m</code> for the <code class="reqn">m</code> studies, <code>k</code> for the <code class="reqn">k</code> outcome parameters, <code>p</code> for the <code class="reqn">p</code> predictors (including intercept). The first two are derived from the vector/matrix of outcome parameters in <code><a href="stats.html#topic+formula">formula</a></code>, the third from the design matrix derived from <code><a href="#topic+model.matrix.mvmeta">model.matrix</a></code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p> the model frame used for fitting. Reported if <code>model=TRUE</code> in <code><a href="#topic+mvmeta">mvmeta</a></code>. See <code><a href="#topic+model.frame.mvmeta">model.frame</a></code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> the function call.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p> (where relevant) information returned by <code><a href="#topic+model.frame.mvmeta">model.frame</a></code> on the special handling of NAs. See info on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code>.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p> the model supplied.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p> the <code><a href="stats.html#topic+terms">terms</a></code> object representing the fitted model.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p> (where relevant) the contrasts used.</p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>
<p> (where relevant) a record of the levels of the factors used in fitting.</p>
</td></tr>
</table>


<h3>Methods</h3>

<p>A number of methods functions are available for <code>mvmeta</code> objects, most of them common to other regression functions.
</p>
<p>Specifically-written method functions are defined for <code><a href="#topic+predict.mvmeta">predict</a></code> (standard predictions) and <code><a href="#topic+blup.mvmeta">blup</a></code> (best linear unbiased predictions). The method function <code><a href="#topic+simulate.mvmeta">simulate</a></code> produces simulated outcomes from a fitted model, while <code><a href="#topic+qtest.mvmeta">qtest</a></code> performs the Cochran Q test for heterogeneity. Other methods have been produced for <code><a href="#topic+summary.mvmeta">summary</a></code>, <code><a href="#topic+logLik.mvmeta">logLik</a></code>, <code><a href="#topic+coef.mvmeta">coef</a></code>, and <code><a href="#topic+vcov.mvmeta">vcov</a></code>.
</p>
<p>Specific methods are also available for <code><a href="#topic+model.frame.mvmeta">model.frame</a></code> and <code><a href="#topic+model.matrix.mvmeta">model.matrix</a></code>. In particular, the former produces the model frame (a data frame with special attributes storing the variables used for fitting) with the additional class <code>"data.frame.mvmeta"</code>. Methods <code><a href="#topic+na.omit.data.frame.mvmeta">na.omit</a></code> and <code><a href="#topic+na.exclude.data.frame.mvmeta">na.exclude</a></code> for this class are useful for the handling of missing values in <code>mvmeta</code> objects.
</p>
<p>Printing functions for the objects of classes defined above are also provided. <code>anova</code> methods for performing tests in <code>mvmeta</code> objects are in development.
</p>
<p>All the methods above are visible (exported from the namespace) and documented. In additions, several default method functions for regression are also  applicable to objects of class <code>"mvmeta"</code>, such as <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+AIC">AIC</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code> and <code><a href="stats.html#topic+update">update</a></code>, among others.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+mvmeta">mvmeta</a></code>. See <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code> for standard regression functions. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of this modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# INSPECT THE OBJECT
names(model)

# LABELS
model$lab

# FORMULA
model$formula

# CONVERGED?
model$converged
</code></pre>

<hr>
<h2 id='mvmetaSim'> Simulating Responses for mvmeta Models </h2><span id='topic+mvmetaSim'></span><span id='topic+simulate.mvmeta'></span>

<h3>Description</h3>

<p>These functions simulate sets of multivariate or univariate responses for a group of studies, in terms of their mean (expected) values and within and between-study (co)variances. These sets of outcomes can be used in meta-analytical models for simulation purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvmetaSim(y, S, Psi, sd, cor, nsim=1, seed=NULL, posdeftol)

## S3 method for class 'mvmeta'
simulate(object, nsim=1, seed=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<p>In order to simulate <code class="reqn">k</code> outcomes for <code class="reqn">m</code> studies:
</p>
<table>
<tr><td><code id="mvmetaSim_+3A_y">y</code></td>
<td>
<p> a <code class="reqn">m</code>-dimensional vector (for simulating univariate responses) or <code class="reqn">m \times k</code> matrix (for simulating multivariate responses) of mean (expected) outcomes.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_s">S</code></td>
<td>
<p> series of within-study (co)variance matrices of the outcomes for each one of the <code class="reqn">m</code> studies. Accepted formats are a <code class="reqn">m</code>-dimensional list of <code class="reqn">k \times k</code> matrices; a tri-dimensional <code class="reqn">k \times k \times m</code> array; or a <code class="reqn">m \times k(k+1)/2</code> matrix or data frame where each row represents the vectorized entries of the lower triangle of the related (co)variance matrix, taken by column (see <code><a href="#topic+xpndMat">xpndMat</a></code>).</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_psi">Psi</code></td>
<td>
<p> the between-study (co)variance matrices of the outcomes. Accepted formats are a <code class="reqn">k \times k</code> matrix or a <code class="reqn">k(k+1)/2</code>-dimensional vector, representing the vectorized entries of the lower triangle of the related (co)variance matrix, taken by column (see <code><a href="#topic+xpndMat">xpndMat</a></code>).</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_sd">sd</code></td>
<td>
<p> a <code class="reqn">k</code>-dimensional vector of between-study standard deviations.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_cor">cor</code></td>
<td>
<p> between-study correlations. Either a scalar, a vector or a matrix. See <code><a href="#topic+inputcov">inputcov</a></code>.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_nsim">nsim</code></td>
<td>
<p> number of simulation sets.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_seed">seed</code></td>
<td>
<p> an object specifying if and how the random number generator should be initialized.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_posdeftol">posdeftol</code></td>
<td>
<p> tolerance (relative to largest variance) for numerical lack of positive-definiteness. Default to the square root of the machine precision.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_object">object</code></td>
<td>
<p>  an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="mvmetaSim_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The set(s) of responses can be simulated either from a fitted model, using the method function <code>simulate</code> for objects of class <code>"mvmeta"</code>, or directly through the function <code>mvmetaSim</code>. In the former case, the fitted values from the model are used as mean (expected) outcomes, together with the within and estimated between-study (co)variance. In the latter option, this information need to be provided by the user in the correct dimensions and forms.
</p>
<p>In <code>mvmetaSim</code>, the between-study (co)variance matrix can be inputted directly through <code>Psi</code>, or given in the form <code class="reqn">\boldsymbol{DRD}</code>, with a diagonal matrix  <code class="reqn">\boldsymbol{D}</code> of standard deviations and correlation matrix <code class="reqn">\boldsymbol{R}</code>. These values are provided through <code>sd</code> and <code>cor</code>. See <code><a href="#topic+inputcov">inputcov</a></code> for details.
</p>
<p>The functions simulate the responses for each study separately from a marginal multivariate normal distribution with mean equal to the expected values and (co)variance equal to the sum of the within and between-study components. The computation is identical to that implemented in the function <code>mvrnorm</code> of the package <span class="pkg">MASS</span>, involving a eigen decomposition of the marginal (co)variance matrix. Numerical negative definiteness is allowed with a tolerance specified by <code>posdeftol</code>, and positive semi-definiteness is then forced by truncating the eigenvalues at zero.
</p>


<h3>Value</h3>

<p>If <code>nsim=1</code>, a matrix or vector of simulated <code class="reqn">k</code> outcomes for the <code class="reqn">m</code> studies. If more simulation sets are required (<code>nsim</code> higher than 1), a list of matrices or vectors.
</p>


<h3>Note</h3>

<p>Studies with missing values in the fitted values or in the components of the within (co)variances are excluded by <code>simulate</code>. Missing values are instead not accepted in <code>metaSim</code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

 
<p>See <code><a href="stats.html#topic+simulate">simulate</a></code> for the general method function. See <code><a href="#topic+inputcov">inputcov</a></code> for inputting correlations. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN A MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# SIMULATE A NEW SET OF OUTCOMES
simulate(model)

# SIMULATE FROM SCRATCH: 3 OUTCOMES, 8 STUDIES
(y &lt;- matrix(0,8,3))
(S &lt;- inputcov(matrix(runif(8*3,0.1,2),8,3,dimnames=list(NULL,
  c("V1","V2","V3"))),cor=c(0,0.5,0.7)))
(Psi &lt;- inputcov(1:3,cor=0.3))
mvmetaSim(y,S,Psi)

# ALTERNATIVELY, DEFINE Psi THROUGH STANDARD DEVIATIONS AND CORRELATION 0.2
mvmetaSim(y,S,sd=1:3,cor=0.3)

# 2 SIMULATION SETS
mvmetaSim(y,S,Psi,nsim=2)
</code></pre>

<hr>
<h2 id='na.omit.data.frame.mvmeta'> Handling Missing Values in mvmeta Models </h2><span id='topic+na.omit.data.frame.mvmeta'></span><span id='topic+na.exclude.data.frame.mvmeta'></span>

<h3>Description</h3>

<p>These method functions exclude rows corresponding to studies with invalid missing pattern from model frames of class <code>"data.frame.mvmeta"</code>. This guarantees the correct handling of missing values while fitting multivariate and univariate meta-analytical models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame.mvmeta'
na.omit(object, ...)

## S3 method for class 'data.frame.mvmeta'
na.exclude(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na.omit.data.frame.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"data.frame.mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="na.omit.data.frame.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A model frame of class <code>"data.frame.mvmeta"</code> is produced by <code><a href="#topic+mvmeta">mvmeta</a></code>. A call to <code>na.omit</code> or <code>na.exclude</code> removes from the model frame the rows corresponding to studies with invalid missing pattern. In addition, a <code>na.action</code> attribute is added to the model frame, namely a numeric vector corresponding to the removed rows and class <code>"omit"</code> or <code>"exclude"</code>, respectively. This information is used by <code><a href="stats.html#topic+naresid">naresid</a></code> and <code><a href="stats.html#topic+napredict">napredict</a></code> to deal with missing values in functions such as <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="#topic+predict.mvmeta">predict</a></code> and <code><a href="#topic+blup.mvmeta">blup</a></code>, among others.
</p>
<p>The definition of missing, identifying an invalid missing pattern, is different in multivariate meta-analytical models performed through <code><a href="#topic+mvmeta">mvmeta</a></code> if compared to other regression functions such as <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>. Specifically, while a study is removed if at least an observation for one predictor is missing, partially missing outcomes do not prevent the study to contribute to estimation (see <code><a href="#topic+mvmeta">mvmeta</a></code>). Specific methods <code>na.omit</code> and <code>na.exclude</code> for class <code>"data.frame.mvmeta"</code> allow  this different definition.
</p>


<h3>Value</h3>

<p>These functions returns the model frame <code>object</code> with rows corresponding to studies with invalid missing pattern being removed. They also add the related <code>na.action</code> attribute as explained above.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>See Also</h3>

<p>See <code><a href="stats.html#topic+na.action">na.action</a></code>, <code><a href="stats.html#topic+naresid">naresid</a></code> and <code><a href="stats.html#topic+napredict">napredict</a></code>. See <code><a href="#topic+model.frame.mvmeta">model.frame</a></code>.
See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># INPUT MISSING VALUES IN PREDICTOR AND ONE RESPONSE
data &lt;- berkey98
data[2,1] &lt;- data[4,3] &lt;- NA
data

# RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=data[5:7],data=data,method="ml")

# SUMMARIZE: NOTE THE NUMBER OF STUDIES AND OBSERVATIONS
summary(model)
df.residual(model)

# EXTRACT THE MODEL FRAME WITH na.pass
model.frame(model,na.action="na.pass")
# EXTRACT THE MODEL FRAME WITH na.omit (DEFAULT)
model.frame(model,na.action="na.omit")

# COMPARE WITH DEFAULT METHOD FOR na.omit
frame &lt;- model.frame(model,na.action="na.pass")
na.omit(frame)
class(frame)
class(frame) &lt;- "data.frame"
na.omit(frame)

# WITH na.exclude
residuals(model)
residuals(update(model,na.action="na.exclude"))
</code></pre>

<hr>
<h2 id='p53'> Mutant p53 Gene and Squamous Cell Carcinoma </h2><span id='topic+p53'></span>

<h3>Description</h3>

<p>The dataset includes studies providing evidence about whether the presence of mutant p53 tumour suppressor gene is a prognostic factor for patients presenting with squamous cell carcinoma arising from the oropharynx cavity. Unadjusted estimates of log hazard ratios of mutant p53 to normal p53 for disease-free and overall survival, together with the associated variances, are collected from 6 observational studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p53</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 5 variables:
</p>

<ul>
<li><p><code>study</code>: study ID.
</p>
</li>
<li><p><code>y1, V1</code>: estimate and associated variance of the log hazard ratio for disease-free survival.
</p>
</li>
<li><p><code>y2, V2</code>: estimate and associated variance of the log hazard ratio for overall survival.
</p>
</li></ul>



<h3>Details</h3>

<p>Only 3 studies provide estimates for disease-free survival. The within-study correlations are not reported in the original studies but are expected to be highly positively correlated. The original data are described in Tandon and colleagues (2010) and used as an example in Jackson and colleagues (2011).
</p>


<h3>Note</h3>

<p>The data provide an example of application of multivariate meta-analysis when the within-study correlations are not known. These correlations can be inputted directly in the <code><a href="#topic+mvmeta">mvmeta</a></code> function through the <code>control</code> argument. See <code><a href="#topic+mvmeta.control">mvmeta.control</a></code> for details.
</p>


<h3>Source</h3>

<p>Jackson D, Riley R, White IR (2011). Multivariate meta-analysis: Potential and promise. <em>Statistics in Medicine</em>. <b>30</b>(20);2481&ndash;2498.
</p>
<p>Tandon S, Tudur-Smith C, Riley RD, et al. (2010). A systematic review of p53 as a prognostic factor of survival in squamous cell carcinoma of the four main anatomical subsites of the head and neck. <em>Cancer Epidemiology, Biomarkers and Prevention</em>. <b>19</b>(2):574&ndash;587.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS OF EXAMPLE 3 IN JACKSON ET AL. (2011)

# INSPECT THE DATA
p53

# REML MODEL WITH INPUTTED CORRELATION EQUAL TO 0.95
model &lt;- mvmeta(cbind(y1,y2),cbind(V1,V2),data=p53,control=list(Scor=0.95))
print(summary(model),digits=2)
</code></pre>

<hr>
<h2 id='predict.mvmeta'> Predicted Values from mvmeta Models </h2><span id='topic+predict.mvmeta'></span>

<h3>Description</h3>

<p>This method function computes predictions from fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>, optionally for a new set of predictor values in meta-regression models. Predictions are optionally accompanied by standard errors, confidence intervals or the entire (co)variance matrix of the predicted outcomes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
predict(object, newdata, se=FALSE, ci=FALSE, vcov=FALSE,
  interval=c("confidence","prediction"), ci.level=0.95,
  format=c("matrix","list"), aggregate=c("stat","y"), na.action=na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"mvmeta"</code>.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_newdata">newdata</code></td>
<td>
<p> An optional data frame in which to look for variables values with which to predict from meta-regression models.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_se">se</code></td>
<td>
<p> logical switch indicating if standard errors must be included.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_ci">ci</code></td>
<td>
<p> logical switch indicating if confidence intervals must be included.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_vcov">vcov</code></td>
<td>
<p> logical switch indicating if the (co)variance matrix must be included.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_interval">interval</code></td>
<td>
<p> type of prediction. See Details.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_ci.level">ci.level</code></td>
<td>
<p> a numerical value between 0 and 1, specifying the confidence level for the computation of confidence intervals.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_format">format</code></td>
<td>
<p> the format for the returned results. See Value.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_aggregate">aggregate</code></td>
<td>
<p> when <code>format="matrix"</code> and <code>se</code> or <code>ci</code> are required, the results may be aggregated by statistic or by outcome. See Value</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_na.action">na.action</code></td>
<td>
<p> a function which indicates what should happen when the data contain <code>NA</code>s. The default to the value saved in <code>object</code>. See Note.</p>
</td></tr>
<tr><td><code id="predict.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method function <code>predict</code> produces predicted values from <code>mvmeta</code> objects, obtained by evaluating the original call to <code><a href="#topic+mvmeta">mvmeta</a></code> in the frame <code>newdata</code>. For both fixed and random-effects models, estimated predictions are only based on the fixed part of the model, ignoring study-specific deviations, differently from <code><a href="#topic+blup.mvmeta">blup</a></code>.
</p>
<p>For random-effects models, if <code>interval="confidence"</code> (the default), standard errors, confidence intervals and (co)variance matrix of the predicted values are computed only using the estimated (co)variance matrix of the fixed-effects coefficients. If <code>interval="prediction"</code>, the estimated between-study (co)variance matrix, stored in the <code>Psi</code> component of <code>mvmeta</code> objects, is also added. In this case, interpretation of the uncertainty reflects that of a new single study sampled from the same population.
</p>
<p>If <code>newdata</code> is omitted, the predictions are based on the data used for the fit. In that case how to handle predictions for studies removed from estimation due to invalid missing pattern is determined by the <code>na.action</code> argument used in <code><a href="#topic+mvmeta">mvmeta</a></code> to produce <code>object</code>. If <code>na.action=na.omit</code>, studies excluded from estimation will not appear, whereas if <code>na.action=na.exclude</code> they will appear, with values set to <code>NA</code> for all the outcomes. This step is performed by <code><a href="stats.html#topic+napredict">napredict</a></code>. See Notes.
</p>


<h3>Value</h3>

<p>The results may be aggregated in matrices (the default), or returned as lists, depending on the argument <code>format</code>. For multivariate models, the aggregation is ruled by the argument <code>aggregate</code>, and the results may be grouped by statistic or by outcome. If <code>vcov=TRUE</code>, lists are always returned.
</p>


<h3>Note</h3>

<p>The definition of missing in model frames used for estimation in <code><a href="#topic+mvmeta">mvmeta</a></code> is different than that commonly adopted in other regression models such as <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+glm">glm</a></code>. See info on <code><a href="#topic+na.omit.data.frame.mvmeta">missing values</a></code> in <code><a href="#topic+mvmeta">mvmeta</a></code>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+blup.mvmeta">blup</a></code> for best linear unbiased predictions. See the default method <code><a href="stats.html#topic+predict">predict</a></code>. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# PREDICTED FROM YEAR 1985 TO 1987, WITH LABELS
newdata &lt;- data.frame(pubyear=1985:1987,row.names=1985:1987)

# AVERAGED OUTOCOMES AND SE
predict(model,newdata,se=TRUE)

# SAME AS ABOVE, AGGREGATED BY OUTCOME
predict(model,newdata,se=TRUE,aggregate="y")

# SAME AS ABOVE, WITH PREDICTION INTERVALS
predict(model,newdata,se=TRUE,aggregate="y",interval="prediction")

# WITH VCOV, FORCED TO A LIST
predict(model,newdata,se=TRUE,vcov=TRUE,aggregate="y")
</code></pre>

<hr>
<h2 id='qtest'> Cochran Q Test of Heterogeneity </h2><span id='topic+qtest'></span>

<h3>Description</h3>

<p>This is a generic function to perform a Cochran Q test of (residual) heterogeneity. The function invokes particular <code><a href="utils.html#topic+methods">methods</a></code> which depend on the <code><a href="base.html#topic+class">class</a></code> of the first argument. Currently, specific methods exist for several meta-analytical models in various packages: <code><a href="mixmeta.html#topic+qtest.mixmeta">qtest.mixmeta</a></code>, <code><a href="#topic+qtest.mvmeta">qtest.mvmeta</a></code>, and <code><a href="dosresmeta.html#topic+qtest.dosresmeta">qtest.dosresmeta</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qtest(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qtest_+3A_object">object</code></td>
<td>
<p> an object for which the test is desired</p>
</td></tr>
<tr><td><code id="qtest_+3A_...">...</code></td>
<td>
<p> further arguments passed to specific methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test assesses the null hypothesis that the variability in the distribution of the outcomes is explained only in terms of within-unit estimation errors. This corresponds to a test on the hypotesis that there is no variation attributable to random-effects terms.
</p>


<h3>Value</h3>

<p>Returned values depend on the specific class. Usually, the results of the test.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt;</p>


<h3>References</h3>

<p>Cochran WG (1950). The comparison of percentages in matched samples&quot;. <em>Biometrika</em>. <b>37</b>(3/4):256&ndash;266.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

<p>Specific methods for various classes: <code><a href="mixmeta.html#topic+qtest.mixmeta">qtest.mixmeta</a></code>, <code><a href="#topic+qtest.mvmeta">qtest.mvmeta</a></code>, and <code><a href="dosresmeta.html#topic+qtest.dosresmeta">qtest.dosresmeta</a></code>.</p>

<hr>
<h2 id='qtest.mvmeta'> Cochran Q Test of Heterogeneity for mvmeta Models </h2><span id='topic+qtest.mvmeta'></span><span id='topic+print.qtest.mvmeta'></span>

<h3>Description</h3>

<p>This method function performs a Cochran Q test of (residual) heterogeneity on fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
qtest(object, ...)

## S3 method for class 'qtest.mvmeta'
print(x, digits=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qtest.mvmeta_+3A_object">object</code>, <code id="qtest.mvmeta_+3A_x">x</code></td>
<td>
<p> objects of classes <code>"mvmeta"</code> and <code>"qtest.mvmeta"</code>, respectively.</p>
</td></tr>
<tr><td><code id="qtest.mvmeta_+3A_digits">digits</code></td>
<td>
<p>  an integer specifying the number of digits to which printed results must be rounded.</p>
</td></tr>
<tr><td><code id="qtest.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In multivariate models, the test assesses the null hypothesis that the variability in the multivariate distribution of the outcomes is explained only in terms of estimation error in each study, measured by the within-study (co)variance matrices stored in the component <code>S</code> of <code>mvmeta</code> objects. This is equal to test the hypothesis that the between-study (co)variance matrix is a zero matrix, and there is no random deviation in study-specific estimates. Tests for single outcome parameters, comparable to estimates from multiple univariate meta-analysis, are also reported. This test reduces to the standard Q test in univariate models. 
</p>
<p>The function compute the statistics by actually fitting the related fixed-effects model, re-evaluating the call of the model with <code>method</code> changed to <code>"fixed"</code>.
</p>


<h3>Value</h3>

<p>A list object of class <code>"qtest.mvmeta"</code> with the following components:
</p>
<table>
<tr><td><code>Q</code></td>
<td>
<p> the vector of test statistics for overall and outcome-specific tests, distributed under the null hypothesis as a Chi-square with degrees of freedom <code>df</code>.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> the vector of degrees of freedom of the null distribution for overall and outcome-specific tests. For the overall test, equal to the number of observations used for estimation minus the number of coefficients in the fixed part of the model. For outcome-specific test, equal to number of observed values minus the number of coefficients.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p> the vector of p-values for overall and outcome-specific tests.</p>
</td></tr>
<tr><td><code>residual</code></td>
<td>
<p> logical switch indicating if a meta-regression model is assessed, meaning that the tested heterogeneity is residual.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p> dimensionality of the overall test, that is the number of outcome parameters in the model.</p>
</td></tr>
</table>
<p>As usual, the <code>print</code> method function for class <code>"qtest.mvmeta"</code> does not return any value.
</p>


<h3>Note</h3>

 
<p>Tests on single outcome parameters are performed by extracting the related estimates and variances, but they do not account for the correlation between them, which nevertheless has been considered in estimation. These tests are not therefore comparable with those performed by running a univariate model on each outcome parameter.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>
<p>Berkey, CS, Hoaglin DC, et al. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>. <b>17</b>(22):2537&ndash;2550.
</p>
<p>Ritz J, Demidenkob E, Spiegelman G (2008). Multivariate meta-analysis for data consortia, individual patient meta-analysis, and pooling projects. <em>Journal of Statistical Planning and Inference</em>. <b>139</b>(7):1919&ndash;1933.
</p>


<h3>See Also</h3>

 
<p>See <code><a href="#topic+qtest">qtest</a></code> for the generic method function. See <code><a href="#topic+mvmeta-package">mvmeta-package</a></code> for an overview of the package and modelling framework.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL
model &lt;- mvmeta(cbind(PD,AL)~1,S=berkey98[5:7],data=berkey98)

# MULTIVARIATE COCHRAN Q TEST FOR HETEROGENEITY
test &lt;- qtest(model)
print(test,digits=2)
unclass(test)
</code></pre>

<hr>
<h2 id='smoking'> Meta-Analysis of Interventions to Promote Smoking Cessation </h2><span id='topic+smoking'></span>

<h3>Description</h3>

<p>The dataset contains the results of 24 trials comparing four alternative interventions to promote smoking cessation. The trials have different designs, comparing two or three different interventions. The data consist of the number of successes out of the total participants, and the estimated log-odds ratio for arms B, C, and D relative to arm A, as well as the (co)variance matrix of these three estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoking</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 19 variables:
</p>

<ul>
<li><p><code>study</code>: study ID.
</p>
</li>
<li><p><code>design</code>: design of the trial, reporting the interventions being compared.
</p>
</li>
<li><p><code>dA, dB, dC, dD</code>: number of successes for each intervention.
</p>
</li>
<li><p><code>nA, nB, nC, nD</code>: number of participants for each intervention.
</p>
</li>
<li><p><code>yB, yC, yD</code>: estimated log-odds ratios for interventions B, C and D versus intervention A.
</p>
</li>
<li><p><code>SBB, SBC, SBD, SCC, SCD, SDD</code>: variances and co-variances of the estimated log-odds ratios for interventions B, C and D versus intervention A. The order corresponds to the lower triangular elements of the (co)variance matrix taken by column.
</p>
</li></ul>



<h3>Details</h3>

<p>Intervention A is chosen as the reference category. Trials without an arm A (trials 2 and 21-24) are augmented with an arm A with 0.01 individuals and 0.001 successes. Trials containing zero cells (trials 9 and 20) have 1 individual with 0.5 successes added to each intervention. Details on the data augmentation and estimation of (co)variances of the log-odds ratios are provided by White (2011).
</p>


<h3>Note</h3>

<p>The data provide an example of application of network meta-analysis, also referred to as indirect mixed-treatment comparison. Additional information using examples based on these data are provided by Lu and Ades (2006), White (2011) and Higgins and colleagues (2012).
</p>


<h3>Source</h3>

<p>Lu G, Ades AE (2006). Assessing evidence inconsistency in mixed treatment comparisons. <em>Journal of the American Statistical Association</em>. <b>101</b>:447&ndash;459.
</p>
<p>Higgins JPT, Jackson D, Barrett JK et al (2012). Consistency and inconsistency in network meta-analysis: concepts and models for multi-arm studies. <em>Research Synthesis Methods</em>. <b>3</b>(2):98&ndash;110.
</p>
<p>White IR (2011). Multivariate random-effects meta-regression. <em>The Stata Journal</em>. <b>11</b>:255&ndash;270.
</p>
<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### REPRODUCE THE RESULTS IN WHITE (2011)

# INSPECT THE DATA
head(smoking)
names(smoking)

# UNSTRUCTURED BETWEEN-STUDY (CO)VARIANCE
y &lt;- as.matrix(smoking[11:13])
S &lt;- as.matrix(smoking[14:19])
model &lt;- mvmeta(y,S)
summary(model)

# STRUCTURED BETWEEN-STUDY (CO)VARIANCE (PROPORTIONAL)
model &lt;- mvmeta(y,S,bscov="prop",control=list(Psifix=diag(3)+1))
summary(model)

# SEE help(mvmetaCovStruct) for additional info and examples
</code></pre>

<hr>
<h2 id='summary.mvmeta'> Summarizing mvmeta Models </h2><span id='topic+summary.mvmeta'></span><span id='topic+print.mvmeta'></span><span id='topic+print.summary.mvmeta'></span>

<h3>Description</h3>

<p>Print and summary method functions for fitted univariate or multivariate meta-analytical models represented in objects of class <code>"mvmeta"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvmeta'
summary(object, ci.level=0.95, ...)

## S3 method for class 'summary.mvmeta'
print(x, digits=4, ...)

## S3 method for class 'mvmeta'
print(x, digits=4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mvmeta_+3A_object">object</code></td>
<td>
<p> an object of class <code>"mvmeta"</code> produced by a call to <code><a href="#topic+mvmeta">mvmeta</a></code>.</p>
</td></tr>
<tr><td><code id="summary.mvmeta_+3A_x">x</code></td>
<td>
<p> an object of class <code>"mvmeta"</code> or <code>"summary.mvmeta"</code>, produced by calls to <code><a href="#topic+mvmeta">mvmeta</a></code> or <code>summary.mvmeta</code>, respectively.</p>
</td></tr>
<tr><td><code id="summary.mvmeta_+3A_ci.level">ci.level</code></td>
<td>
<p> a numerical value between 0 and 1, specifying the confidence level for the computation of confidence intervals.</p>
</td></tr>
<tr><td><code id="summary.mvmeta_+3A_digits">digits</code></td>
<td>
<p> an integer specifying the number of digits to which printed results must be rounded.</p>
</td></tr>
<tr><td><code id="summary.mvmeta_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>print</code> method function for class <code>"mvmeta"</code> only returns basic information on the fitted model, namely the call, estimated fixed-effects coefficients, dimensions and fit statistics (log-likelihood, AIC, BIC).
</p>
<p>The <code>summary</code> method function computes additional statistics and tests, and produces a list object of class <code>"summary.mvmeta"</code>. The <code>print</code> method function for this class shows additional information, such as tables reporting the estimates for the fixed and random-effects parts of the model, Cochran Q test for heterogeneity and <code class="reqn">I^2</code>. 
</p>


<h3>Value</h3>

<p>The <code>summary</code> method function for <code>mvmeta</code> objects produces a list of class <code>"summary.mvmeta"</code>. The components of the lists are some of those stored in the related <code>mvmeta</code> object, plus the following:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a matrix reporting point estimates, standard errors, z statistics and related p-values of the test, and confidence intervals for the <code class="reqn">kp</code> fixed-effects coefficients. Note this is different than the component with the same name stored in <code>mvmeta</code> objects, simply reporting the point estimates (see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>).</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> the value of the Akaike information criterion for the fitted <code>mvmeta</code> model, obtained through a call to <code><a href="stats.html#topic+AIC">AIC</a></code>.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>  the value of the Bayesian information criterion for the fitted <code>mvmeta</code> model, obtained through a call to <code><a href="stats.html#topic+BIC">BIC</a></code>.</p>
</td></tr>
<tr><td><code>corFixed</code></td>
<td>
<p> the <code class="reqn">kp \times kp</code> correlation matrix of the fixed-effects coefficients, obtained from the (co)variance matrix <code>vcov</code> (see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code> and <code><a href="#topic+vcov.mvmeta">vcov</a></code>).</p>
</td></tr>
<tr><td><code>corRandom</code></td>
<td>
<p> the <code class="reqn">k \times k</code> correlation matrix of the random effects, obtained from the between-study (co)variance matrix <code>Psi</code> (see see <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>).</p>
</td></tr>
<tr><td><code>qstat</code></td>
<td>
<p> results from the Cochran Q test for heterogeneity, namely a list corresponding to a <code>qtest.mvmeta</code> object without its class, obtained through <code><a href="#topic+qtest.mvmeta">qtest</a></code>.</p>
</td></tr>
<tr><td><code>ci.level</code></td>
<td>
<p> the confidence level used for defining the confidence intervals for the estimates of the fixed-effects coefficients.</p>
</td></tr>
</table>
<p>As usual, the <code>print</code> method functions for classes <code>"mvmeta"</code> and <code>"summary.mvmeta"</code> do not return any value.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini, <a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a></p>


<h3>References</h3>

<p>Sera F, Armstrong B, Blangiardo M, Gasparrini A (2019). An extended mixed-effects framework for meta-analysis.<em>Statistics in Medicine</em>. 2019;38(29):5429-5444. [Freely available <a href="http://www.ag-myresearch.com/2019_sera_statmed.html"><b>here</b></a>].
</p>
<p>Gasparrini A, Armstrong B, Kenward MG (2012). Multivariate meta-analysis for non-linear and other multi-parameter associations. <em>Statistics in Medicine</em>. <b>31</b>(29):3821&ndash;3839. [Freely available <a href="http://www.ag-myresearch.com/2012_gasparrini_statmed.html"><b>here</b></a>].
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+mvmeta">mvmeta</a></code> and <code><a href="#topic+mvmetaObject">mvmetaObject</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RUN THE MODEL 
model &lt;- mvmeta(cbind(PD,AL)~pubyear,S=berkey98[5:7],data=berkey98)

# SIMPLE PRINT
model
# DEFINE DIGITS
print(model,digit=2)
# SUMMARY WITH 80TH CONFIDENCE INTERVALS
summary(model,ci.level=0.80)
</code></pre>

<hr>
<h2 id='vechMat'> Vectorization and Expansion of Symmetric Matrices </h2><span id='topic+vechMat'></span><span id='topic+xpndMat'></span>

<h3>Description</h3>

<p>The function <code>vechMat</code> transforms a symmetric matrix in a vector containing its lower triangular elements, taken by column. The function <code>xpndMat</code> reverses this transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vechMat(mat, diag=TRUE)

xpndMat(vech)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vechMat_+3A_mat">mat</code></td>
<td>
<p> a square matrix.</p>
</td></tr>
<tr><td><code id="vechMat_+3A_vech">vech</code></td>
<td>
<p> a vector.</p>
</td></tr>
<tr><td><code id="vechMat_+3A_diag">diag</code></td>
<td>
<p> a logical switch indicating if the diagonal entries must be included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector for <code>vechMat</code>, a symmetric matrix for <code>xnpdMat</code>.
</p>


<h3>Note</h3>

<p>These functions are imported from the package <span class="pkg">mixmeta</span>.
</p>


<h3>Author(s)</h3>

<p>Antonio Gasparrini &lt;<a href="mailto:antonio.gasparrini@lshtm.ac.uk">antonio.gasparrini@lshtm.ac.uk</a>&gt;</p>


<h3>See Also</h3>

 
<p>See functions <code>vech</code> and <code>xpnd</code> in package <span class="pkg">MCMCpack</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># GENERATE A POSITIVE-DEFINITE MATRIX, VECTORIZE IT AND THEN RE-EXPAND
(M &lt;- crossprod(matrix(rnorm(9),3)))
(v &lt;- vechMat(M))
xpndMat(v)

# EXTRACT VECTORIZED S, EXPAND TO A LIST, AND RE-VECTORIZE
(S &lt;- as.matrix(berkey98[5:7]))
(Slist &lt;- lapply(seq(nrow(S)), function(i) xpndMat(S[i,])))
t(sapply(Slist,vechMat))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
