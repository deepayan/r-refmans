<!DOCTYPE html><html><head><title>Help for package GB2group</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GB2group}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit.plot'><p>Plot of the estimated Lorenz curve and the empirical income shares</p></a></li>
<li><a href='#fitgroup.b2'><p>Estimation of the Beta 2 distribution from group data</p></a></li>
<li><a href='#fitgroup.da'><p>Estimation of the Dagum distribution from group data</p></a></li>
<li><a href='#fitgroup.f'><p>Estimation of the Fisk distribution from group data</p></a></li>
<li><a href='#fitgroup.gb2'><p>Estimation of the GB2 distribution from group data</p></a></li>
<li><a href='#fitgroup.ln'><p>Estimation of the Lognormal distribution from group data</p></a></li>
<li><a href='#fitgroup.sm'><p>Estimation of the Singh-Maddala distribution from group data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of the Generalised Beta Distribution of the Second
Kind from Grouped Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Vanesa Jorda &lt;jordav@unican.es&gt;, Jose Maria Sarabia
    &lt;jose.sarabia@unican.es&gt;, Markus Jäntti &lt;markus.jantti@sofi.su.se&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vanesa Jorda &lt;jordav@unican.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>GB2, minpack.lm, ineq, numDeriv</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of the generalized beta distribution of the second 
    kind (GB2) and related models using grouped data in form of income shares. 
    The GB2 family is a general class of distributions that provides an accurate 
    fit to income data. 'GB2group' includes functions to estimate the GB2, the 
    Singh-Maddala, the Dagum, the Beta 2, the Lognormal and the Fisk distributions. 
    'GB2group' deploys two different econometric strategies to estimate these 
    parametric distributions, the equally weighted minimum distance (EWMD) estimator and the  
    optimally weighted minimum distance (OMD) estimator. Asymptotic standard errors are reported for the 
    OMD estimates. Standard errors of the EWMD estimates are obtained by Monte 
    Carlo simulation. See Jorda et al. (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1808.09831">doi:10.48550/arXiv.1808.09831</a>&gt; for a detailed 
    description of the estimation procedure. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-26 15:35:34 UTC; Vanesa</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-26 17:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit.plot'>Plot of the estimated Lorenz curve and the empirical income shares</h2><span id='topic+fit.plot'></span>

<h3>Description</h3>

<p>The function <code>fit.plot</code> plots the parametric Lorenz curve and the observed income shares used for the estimation of the income distributions belonging to the GB2 family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.plot(fit, fit.type = 1, fit.legend = FALSE, l.size = 0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.plot_+3A_fit">fit</code></td>
<td>
<p>A character string &quot;name&quot; naming the object that contains the estimation of the parametric model for which the Lorenz curve is plotted.</p>
</td></tr>
<tr><td><code id="fit.plot_+3A_fit.type">fit.type</code></td>
<td>
<p>specifies the method used to estimate the parametric model. By default, <code>fit.type = 1</code>, which represents the Lorenz curve estimated by EWMD. If <code>fit.type = 2</code>, the Lorenz curve belongs to the OMD estimation.</p>
</td></tr>
<tr><td><code id="fit.plot_+3A_fit.legend">fit.legend</code></td>
<td>
<p>If <code>TRUE</code>, the graph includes a legend indicating the model for which the Lorenz curve is plotted.</p>
</td></tr>
<tr><td><code id="fit.plot_+3A_l.size">l.size</code></td>
<td>
<p>determines the size of the legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>fit.plot</code> represents the parametric Lorenz curves of some models of the GB2 family. Closed expressions
of the Lorenz curves of these models are provided by Jorda et al. (2018). The parametric model must be estimated
before representing the theoretical Lorenz curve. To do so, create an object containing the result of the following functions:
<code><a href="#topic+fitgroup.gb2">fitgroup.gb2</a></code>, <code><a href="#topic+fitgroup.b2">fitgroup.b2</a></code>, <code><a href="#topic+fitgroup.da">fitgroup.da</a></code>,
<code><a href="#topic+fitgroup.sm">fitgroup.sm</a></code>, <code><a href="#topic+fitgroup.ln">fitgroup.ln</a></code> or <code><a href="#topic+fitgroup.f">fitgroup.f</a></code>. The name of this object is used (with quotations marks)
as the first argument of <code>fit.plot</code> (see examples below). This function returns a plot with the Lorenz curve of the model
estimated by EWMD or OMD. More than one fit can be plotted, even when different sets of data are used. The legend indicates the
distribution for which the Lorenz curve is represented.
</p>


<h3>Value</h3>

<p>the function <code>fit.plot</code> returns a graph with the theoretical Lorenz curves of the Generalised Beta of the Second Kind (GB2) family of income distributions and the income shares used for the estimation of these models.
</p>


<h3>References</h3>

<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit.ln &lt;- fitgroup.ln(y = c(9, 13, 17, 22, 39), gini.e = 0.29)
fit.b2 &lt;- fitgroup.b2(y = c(9, 13, 17, 22, 39), gini.e = 0.29)
fit.plot(c("fit.ln", "fit.b2"), fit.legend = TRUE, l.size = 0.8)
</code></pre>

<hr>
<h2 id='fitgroup.b2'>Estimation of the Beta 2 distribution from group data</h2><span id='topic+fitgroup.b2'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.b2</code> implements the estimation of the Beta 2 distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.b2(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.b2_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.b2_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The Beta 2 distribution is a particular case of this model with <code class="reqn">a = 1</code>, defined in terms of
the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn">F(x; b, p, q) = B\bigg(\frac{x/b}{1+x/b}; p; q\bigg); x &gt; 0,</code>
</p>

<p>where <code class="reqn">b</code> is the scale parameter and <code class="reqn">p, q</code> are the shape parameters that define the
heaviness of the tail and the skewness of the distribution.
</p>
<p>The function <code>fitgroup.da</code> estimates the parameters of the Beta 2 distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
including The World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via <code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>
Conventionally, moment estimates of a restricted model are taken as initial values. A potential
limitation of this method is that, as the dimensionality of the parameter
space increases, it is more difficult to achieve global convergence. Although it seems
quite intuitive that the moment estimates of the restricted model might be a good starting
point, the optimization could converge to
a local minimum, which might lead to inaccurate estimates of the parameters.
</p>
<p>To provide different non-arbitrary combinations of starting values, we propose to
define a sequence of numbers (provided by <code>grid</code>). For each value in this
sequence, the moment estimate of one of the parameters is obtained using the survey Gini index,
assuming that the other one is equal to the grid value. Using this procedure,
we end up with as many combinations of initial values as values in the grid,
which are used to obtain different sets of estimates, keeping the one with the smallest
residual sum of squares. Although we cannot ensure that our estimates belong to
the global minimum, this procedure covers a larger proportion of the parameter
space than just using the moment estimates of a
particular sub-model. See Jorda et al. (2018) for details.
</p>
<p>This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the Beta 2 distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.b2</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the Beta 2 distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the Beta 2 distribution is computed using the function
<code>simgini.b2</code> which makes use of <code>gini.b2</code>.
If this function reports NaN, the Gini index is estimated by Monte
Carlo simulation of 10^6 samples of size N = 10^6.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.b2</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the Beta 2 distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the Beta 2 distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.b2(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

<hr>
<h2 id='fitgroup.da'>Estimation of the Dagum distribution from group data</h2><span id='topic+fitgroup.da'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.da</code> implements the estimation of the Dagum distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.da(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.da_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.da_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The Dagum distribution is a particular case of this model with <code class="reqn">q = 1</code>, defined in terms of
the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn">F(x; a, b, p) = \bigg(1+\bigg(\frac{x}{b}\bigg)^{-a}\bigg)^{-p} </code>
</p>

<p>where <code class="reqn">b</code> is the scale parameter and <code class="reqn">a, p</code> are the shape parameters that define the
heaviness of the tail and the skewness of the distribution.
</p>
<p>The function <code>fitgroup.da</code> estimates the parameters of the Dagum distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
includingThe World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via <code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>
Conventionally, moment estimates of a restricted model are taken as initial values. A potential
limitation of this method is that, as the dimensionality of the parameter
space increases, it is more difficult to achieve global convergence. Although it seems
quite intuitive that the moment estimates of the restricted model might be a good starting
point, the optimization could converge to
a local minimum, which might lead to inaccurate estimates of the parameters.
</p>
<p>To provide different non-arbitrary combinations of starting values, we propose to
define a sequence of numbers (provided by <code>grid</code>). For each value in this
sequence, the moment estimate of one of the parameters is obtained using the survey Gini index,
assuming that the other one is equal to the grid value. Using this procedure,
we end up with as many combinations of initial values as values in the grid,
which are used to obtain different sets of estimates, keeping the one with the smallest
residual sum of squares. Although we cannot ensure that our estimates belong to
the global minimum, this procedure covers a larger proportion of the parameter
space than just using the moment estimates of a
particular sub-model. See Jorda et al. (2018) for details.
</p>
<p>This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the Dagum distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.da</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the Dagum distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the Dagum distribution is computed using the function
<code>simgini.da</code> which makes use of <code>gini.d</code>.
If this function reports NaN, the Gini index is estimated by Monte
Carlo simulation of 10^6 samples of size N = 10^6.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.da</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the Dagum distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the Dagum distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.da(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

<hr>
<h2 id='fitgroup.f'>Estimation of the Fisk distribution from group data</h2><span id='topic+fitgroup.f'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.f</code> implements the estimation of the Fisk distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.f(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.f_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.f_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The Fisk distribution is a particular case of this model with <code class="reqn">p = q = 1</code>, defined in terms of
the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn">F(x; a, b) = \bigg(1-\bigg(\frac{x}{b}\bigg)^{a}\bigg)^{-1} </code>
</p>

<p>where <code class="reqn">b</code> is the scale parameter and <code class="reqn">a</code> is the shape parameter.
</p>
<p>The function <code>fitgroup.f</code> estimates the parameters of the Fisk distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
including The World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD estimators, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via
<code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>. We use the moment estimate of the <code class="reqn">a</code> parameter, obtained by
equating the sample Gini index specified by <code>gini.e</code> to the population Gini index, as initial value.
This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the Fisk distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.f</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the Fisk distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the Fisk distribution is computed using the function
<code>simgini.f</code>.If this function reports a value greater than 1, the Gini index is estimated by Monte
Carlo simulation of 10^6 samples of size N = 10^6.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.f</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the Fisk distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the Fisk distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.f(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

<hr>
<h2 id='fitgroup.gb2'>Estimation of the GB2 distribution from group data</h2><span id='topic+fitgroup.gb2'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.gb2</code> implements the estimation of the GB2 distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.gb2(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.gb2_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.gb2_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The GB2 distribution can be defined in terms of the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn"> F(x; a, b, p, q) = B(\frac{(x/b)^a}{1+(x/b)^a}; p; q); x &gt; 0,</code>
</p>

<p>where <code class="reqn">b</code> is the scale parameter and <code class="reqn">a, p, q</code> are the shape parameters that define the
heaviness of the tail and the skewness of the distribution.
</p>
<p>The function <code>fitgroup.gb2</code> estimates the parameters of the GB2 distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
including The World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via <code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>
Conventionally, moment estimates of a restricted model are taken as initial values. A potential
limitation of this method is that, as the dimensionality of the parameter
space increases, it is more difficult to achieve global convergence. Although it seems quite intuitive that the moment
estimates of the restricted model might be a good starting point, the optimization could converge to
a local minimum, which might lead to inaccurate estimates of the parameters.
</p>
<p>To provide several non-arbitrary combinations of starting values, we propose to set one of the parameters equal to one
so that, the GB2 distribution becomes one of its three particular cases: the Dagum, the Beta 2 and
the Singh-Maddala distributions. Then, we define a sequence of numbers (provided by <code>grid</code>). For each value in this
sequence, the moment estimate of one of the parameters is obtained using the survey Gini index,
assuming that the other one is equal to the grid value. Using this procedure, we end up with three
times as many combinations of initial values as values in the grid, which are used to obtain
different sets of estimates, keeping the estimation with the smallest residual sum of squares.
Although we cannot ensure that our estimates belong to the global minimum, this procedure
covers a larger proportion of the parameter space than just using the moment estimates of a
particular sub-model. See Jorda et al. (2018) for details.
</p>
<p>This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the GB2 distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.gb2</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the GB2 distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the GB2 distribution is computed using the function <code><a href="GB2.html#topic+gini.gb2">gini.gb2</a></code>.
If this function reports NA or 1, the Gini index is estimated by Monte
Carlo simulation of 10^6 samples of size N = 10^6.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.gb2</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the GB2 distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the GB2 distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.gb2(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

<hr>
<h2 id='fitgroup.ln'>Estimation of the Lognormal distribution from group data</h2><span id='topic+fitgroup.ln'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.ln</code> implements the estimation of the Lognormal distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.ln(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.ln_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.ln_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The Lognormal distribution is a limit case of this model, defined in terms of
the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn">F(x; \mu, \sigma) = \Phi\bigg( \frac{log(x)- \mu}{\sigma}\bigg)</code>
</p>

<p>where <code class="reqn">\mu</code> is the scale parameter and <code class="reqn">\sigma</code> is the shape parameter.
</p>
<p>The function <code>fitgroup.ln</code> estimates the parameters of the Lognormal distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
including The World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via
<code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>. We use the moment estimate of the <code class="reqn">a</code> parameter, obtained by
equating the sample Gini index specified by <code>gini.e</code> to the population Gini index, as initial value.
This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the Lognormal distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.ln</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the Lognormal distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the Lognormal distribution is computed using the function <code>gini.ln</code>.
<code>gini.ln</code>.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.ln</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the Lognormal distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the Lognormal distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.ln(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

<hr>
<h2 id='fitgroup.sm'>Estimation of the Singh-Maddala distribution from group data</h2><span id='topic+fitgroup.sm'></span>

<h3>Description</h3>

<p>The function <code>fitgroup.sm</code> implements the estimation of the Singh-Maddala distribution from group
data in form of income shares using the equally weighted minimum distance (EWMD) and the 
optimally weighted minimum distance (OMD) estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitgroup.sm(
  y,
  x = rep(1/length(y), length(y)),
  gini.e,
  pc.inc = NULL,
  se.omd = FALSE,
  se.ewmd = FALSE,
  se.scale = FALSE,
  N = NULL,
  nrep = 10^3,
  grid = 1:20,
  rescale = 1000,
  gini = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitgroup.sm_+3A_y">y</code></td>
<td>
<p>Vector of (non-cumulative) income shares expressed as decimals or percentage.
At least four data points are required to estimate the parameters of the income distribution.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_x">x</code></td>
<td>
<p>Vector of population shares associated with the income shares provided by
<code>y</code>. The default is a vector of equally sized population shares of the same length of
<code>y</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_gini.e">gini.e</code></td>
<td>
<p>specifies the survey Gini index expressed as a decimal.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_pc.inc">pc.inc</code></td>
<td>
<p>specifies an estimate of per capita income. If not provided, the weighting matrix
cannot be computed, hence OMD estimates will not be reported.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_se.omd">se.omd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors
of the shape parameters of the OMD estimates are computed using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016).See Jorda et al. (2018) for details. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_se.ewmd">se.ewmd</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard errors of the EWMD estimates
are obtained using Monte Carlo simulation of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_se.scale">se.scale</code></td>
<td>
<p>If <code>TRUE</code> and the argument <code>N</code> is not <code>NULL</code>, the standard error
of the scale parameter of the OMD estimation is obtained by Monte Carlo simulation
of random samples of size <code>N</code>. By default, this argument is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_n">N</code></td>
<td>
<p>Specifies the size of the sample from which the grouped data was generated. This
information is required to compute the standard errors.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_nrep">nrep</code></td>
<td>
<p>Number of samples to be drawn in the Monte Carlo simulation of the standard error of
the EWMD estimates and the scale parameter of the OMD estimation.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_grid">grid</code></td>
<td>
<p>A sequence of positive real numbers to be used as initial values using the
algorithm developed by Jorda et al. (2018).</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_rescale">rescale</code></td>
<td>
<p>Rescalation factor of per capita income. Reescalation might help to invert
the weight matrix when the scale is too large or too small. The argument <code>rescale</code> should be
a positive real number which, by default, is set to 1000. The magnitude of this  factor is taken into account in the estimation of the scale parameter, so the provided estimate and its standard error are equivalent to those obtained with <code>rescale = 1</code>.</p>
</td></tr>
<tr><td><code id="fitgroup.sm_+3A_gini">gini</code></td>
<td>
<p>if <code>TRUE</code>, reports an estimate of the Gini index using the EWMD estimator and, if
possible, the OMD estimator.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Beta of the Second Kind (GB2) is a general class of distributions that is
acknowledged to provide an accurate fit to income data (McDonald 1984; McDonald and Mantrala,1995).
The Singh-Maddala distribution is a particular case of this model with <code class="reqn">p = 1</code>, defined in terms of
the cumulative distribution function as follows:
</p>
<p style="text-align: center;"><code class="reqn">F(x; a, b, q) = \bigg(1-\bigg(\frac{x}{b}\bigg)^{a}\bigg)^{-q}</code>
</p>

<p>where <code class="reqn">b</code> is the scale parameter and <code class="reqn">a, q</code> are the shape parameters that define the
heaviness of the tail and the skewness of the distribution.
</p>
<p>The function <code>fitgroup.sm</code> estimates the parameters of the Singh-Maddala distribution using grouped data in form of
income shares. These data must have been generated by setting the proportion of observations in each
group before sampling, so that the population proportions are fixed, whereas income shares are random
variables. Examples of this type of data can be found in the largest datasets of grouped data,
including The World Income Inequality Database (UNU-WIDER, 2017), PovcalNet (World Bank, 2018) or the World Wealth
and Income Database (Alvaredo et al., 2018).
</p>
<p>For EWMD, numerical optimisation is achieved using the Levenberg-Marquardt Algorithm via <code><a href="minpack.lm.html#topic+nlsLM">nlsLM</a></code>
Conventionally, moment estimates of a restricted model are taken as initial values. A potential
limitation of this method is that, as the dimensionality of the parameter
space increases, it is more difficult to achieve global convergence. Although it seems
quite intuitive that the moment estimates of the restricted model might be a good starting
point, the optimization could converge to
a local minimum, which might lead to inaccurate estimates of the parameters.
</p>
<p>To provide different non-arbitrary combinations of starting values, we propose to
define a sequence of numbers (provided by <code>grid</code>). For each value in this
sequence, the moment estimate of one of the parameters is obtained using the survey Gini index,
assuming that the other one is equal to the grid value. Using this procedure,
we end up with as many combinations of initial values as values in the grid,
which are used to obtain different sets of estimates, keeping the one with the smallest
residual sum of squares. Although we cannot ensure that our estimates belong to
the global minimum, this procedure covers a larger proportion of the parameter
space than just using the moment estimates of a
particular sub-model. See Jorda et al. (2018) for details.
</p>
<p>This method, however, does not provide
an estimate for the scale parameter because the Lorenz curve is independent to scale. The scale
parameter is estimated by equating the sample mean, specified by <code>pc.inc</code>, to the population
mean of the Singh-Maddala distribution. Because EWMD does not use the optimal
covariance matrix of the moment conditions, the standard errors of the parameters
are obtained by Monte Carlo simulation. Please be aware that the estimation of the standard errors
might take a long time, especially if the sample size is large.
</p>
<p><code>fitgroup.sm</code> also implements a two-stage OMD estimator. In the first stage, EWMD estimates
are obtained as described above, which are used to compute a first stage estimator
of the weighting matrix. The weighting matrix is used in the second stage to obtain optimally
weighted estimates of the parameters. The numerical optimisation is performed using
<code><a href="stats.html#topic+optim">optim</a></code> with the BFGS method. If <code>optim</code> reports an error, the L-BFGS method
is used. EWMD estimates are used as initial values for the optimisation algorithm. The OMD estimation
incorporates the optimal weight matrix, thus making possible to derive the asymptotic standard
errors of the parameters using results from Beach and Davison(1983) and Hajargasht and
Griffiths (2016). As in the EWMD estimation, the scale parameter is obtained by matching the
population mean of the Singh-Maddala distribution to the sample mean. Hence, the standard error of the scale
parameter is estimated by Monte Carlo simulation.
</p>
<p>The Gini index of the Singh-Maddala distribution is computed using the function
<code>simgini.sm</code> which makes use of <code>gini.sm</code>.
If this function reports NaN, the Gini index is estimated by Monte
Carlo simulation of 10^6 samples of size N = 10^6.
</p>


<h3>Value</h3>

<p>the function <code>fitgroup.sm</code> returns the following objects:
</p>

<ul>
<li> <p><code>ewmd.estimation</code> Matrix containing the parameters of the Singh-Maddala distribution estimated
by EWMD and, if <code>se.ewmd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>ewmd.rss</code> Residual sum of squares of the EWMD estimation.
</p>
</li>
<li> <p><code>omd.estimation</code> Matrix containing the parameters of the Singh-Maddala distribution estimated
by OMD and, if <code>se.omd = TRUE</code>, their standard errors.
</p>
</li>
<li> <p><code>omd.rss</code> Weighted residual sum of squares of the OMD estimation.
</p>
</li>
<li> <p><code>gini.estimation</code> Vector with the survey Gini index and the estimated Gini
indices using EWMD and OMD estimates whenever possible.
</p>
</li></ul>



<h3>References</h3>

<p>Alvaredo, F., A. Atkinson, T. Piketty, E. Saez, and G. Zucman. The World Wealth and Income Database.
</p>
<p>Beach, C.M. and R. Davidson (1983): Distribution-free statistical inference with
Lorenz curves and income shares, <em>The Review of Economic Studies</em>, 50, 723 - 735.
</p>
<p>Hajargasht, G. and W.E. Griffiths (2016): Inference for Lorenz Curves, Tech. Rep.,
The University of Melbourne.
</p>
<p>Jorda, V., Sarabia, J.M., &amp; Jäntti, M. (2018). Estimation of income inequality from grouped data.
arXiv preprint arXiv:1808.09831.
</p>
<p>McDonald, J.B. (1984): Some Generalized Functions for the Size Distribution of Income,
<em>Econometrica</em>, 52, 647 - 665.
</p>
<p>McDonald, J.B. and A. Mantrala (1995): The distribution of personal income: revisited,
<em>Journal of Applied Econometrics</em>, 10, 201 - 204.
</p>
<p>UNU-WIDER (2018). World Income Inequality Database (WIID3.4).
</p>
<p>World Bank (2018). PovcalNet Data Base. Washington, DC: World Bank. <a href="http://iresearch.worldbank.org/PovcalNet/home.aspx">http://iresearch.worldbank.org/PovcalNet/home.aspx</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fitgroup.sm(y = c(9, 13, 17, 22, 39), gini.e = 0.29)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
