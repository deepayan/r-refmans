<!DOCTYPE html><html><head><title>Help for package NEONiso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NEONiso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate_12CO2'><p>calculate_12CO2</p></a></li>
<li><a href='#calculate_13CO2'><p>calculate_13CO2</p></a></li>
<li><a href='#calibrate_ambient_carbon_Bowling2003'><p>calibrate_ambient_carbon_Bowling2003</p></a></li>
<li><a href='#calibrate_ambient_carbon_linreg'><p>calibrate_ambient_carbon_linreg</p></a></li>
<li><a href='#calibrate_ambient_water_linreg'><p>calibrate_ambient_water_isotopes</p></a></li>
<li><a href='#calibrate_carbon'><p>calibrate_carbon</p></a></li>
<li><a href='#calibrate_carbon_bymonth'><p>calibrate_carbon_bymonth</p></a></li>
<li><a href='#calibrate_carbon_reference_data'><p>calibrate_carbon_reference_data</p></a></li>
<li><a href='#calibrate_standards_carbon'><p>calibrate_standards_carbon</p></a></li>
<li><a href='#calibrate_standards_water'><p>calibrate_standards_water</p></a></li>
<li><a href='#calibrate_water'><p>calibrate_water</p></a></li>
<li><a href='#calibrate_water_linreg_bymonth'><p>calibrate_water_linreg</p></a></li>
<li><a href='#calibrate_water_reference_data'><p>calibrate_water_reference_data</p></a></li>
<li><a href='#carbon_regression_plots'><p>carbon_regression_plots</p></a></li>
<li><a href='#convert_NEONhdf5_to_POSIXct_time'><p>convert_NEONhdf5_to_POSIXct_time</p></a></li>
<li><a href='#convert_POSIXct_to_NEONhdf5_time'><p>convert_POSIXct_to_NEONhdf5_time</p></a></li>
<li><a href='#copy_qfqm_group'><p>copy_qfqm_group</p></a></li>
<li><a href='#copy_ucrt_group'><p>copy_ucrt_group</p></a></li>
<li><a href='#correct_carbon_ref_cval'><p>correct_carbon_ref_cval</p></a></li>
<li><a href='#correct_carbon_ref_output'><p>Correct carbon ref output</p></a></li>
<li><a href='#delta_to_R'><p>delta_to_R</p></a></li>
<li><a href='#estimate_calibration_error'><p>estimate_calibration_error</p></a></li>
<li><a href='#extract_carbon_calibration_data'><p>extract_carbon_calibration_data.R</p></a></li>
<li><a href='#extract_water_calibration_data'><p>extract_water_calibration_data</p></a></li>
<li><a href='#filter_median_brock86'><p>filter_median_Brock86</p></a></li>
<li><a href='#fit_carbon_regression'><p>fit_carbon_regression</p></a></li>
<li><a href='#fit_water_regression'><p>fit_water_regression</p></a></li>
<li><a href='#get_Rstd'><p>get_Rstd</p></a></li>
<li><a href='#ingest_data'><p>ingest_data</p></a></li>
<li><a href='#loocv'><p>loocv</p></a></li>
<li><a href='#manage_local_EC_archive'><p>manage_local_EC_archive</p></a></li>
<li><a href='#NEONiso-package'><p>NEONiso: Tools to Calibrate and Work with NEON Atmospheric Isotope Data</p></a></li>
<li><a href='#R_to_delta'><p>R_to_delta</p></a></li>
<li><a href='#restructure_ambient_data'><p>restructure_ambient_data</p></a></li>
<li><a href='#restructure_ambient_data2'><p>restructure_ambient_data2</p></a></li>
<li><a href='#restructure_carbon_variables'><p>restructure_carbon_variables</p></a></li>
<li><a href='#restructure_water_variables'><p>restructure_water_variables</p></a></li>
<li><a href='#select_daily_reference_data'><p>select_daily_reference_data</p></a></li>
<li><a href='#setup_output_file'><p>setup_output_file</p></a></li>
<li><a href='#swap_standard_isotoperatios'><p>swap_standard_isotoperatios</p></a></li>
<li><a href='#terrestrial_core_sites'><p>terrestrial_core_sites</p></a></li>
<li><a href='#terrestrial_relocatable_sites'><p>terrestrial_relocatable_sites</p></a></li>
<li><a href='#validate_analyte'><p>validate_analyte</p></a></li>
<li><a href='#validate_output_file'><p>validate_output_file</p></a></li>
<li><a href='#water_isotope_sites'><p>water_isotope_sites</p></a></li>
<li><a href='#write_carbon_ambient_data'><p>write_carbon_ambient_data</p></a></li>
<li><a href='#write_carbon_calibration_data'><p>write_carbon_calibration_data</p></a></li>
<li><a href='#write_carbon_reference_data'><p>write_carbon_reference_data</p></a></li>
<li><a href='#write_qfqm'><p>write_qfqm</p></a></li>
<li><a href='#write_ucrt'><p>write_ucrt</p></a></li>
<li><a href='#write_water_calibration_data'><p>write_water_calibration_data</p></a></li>
<li><a href='#write_water_reference_data'><p>write_water_reference_data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Calibrate and Work with NEON Atmospheric Isotope Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rich Fiorella &lt;rfiorella@lanl.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for downloading,
    calibrating, and analyzing atmospheric isotope data bundled
    into the eddy covariance data products of the National Ecological
    Observatory Network (NEON) <a href="https://www.neonscience.org">https://www.neonscience.org</a>. 
    Calibration tools are provided for carbon and water isotope products.
    Carbon isotope calibration details are found in Fiorella et al. (2021)
    &lt;<a href="https://doi.org/10.1029%2F2020JG005862">doi:10.1029/2020JG005862</a>&gt;, and the readme 
    file at <a href="https://github.com/lanl/NEONiso">https://github.com/lanl/NEONiso</a>. Tools for calibrating water 
    isotope products have been added as of 0.6.0, but have known deficiencies
    and should be considered very experimental currently.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lanl/NEONiso/issues">https://github.com/lanl/NEONiso/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lanl/NEONiso">https://github.com/lanl/NEONiso</a>, <a href="https://lanl.github.io/NEONiso/">https://lanl.github.io/NEONiso/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, zoo, httr, lubridate, neonUtilities (&ge; 2.0.1),
magrittr, rhdf5 (&ge; 2.33.7), R.utils, tidyselect, data.table,
rlang, lifecycle, caret, ggplot2, gridExtra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), fasttime</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-20 00:40:46 UTC; rfiorella</td>
</tr>
<tr>
<td>Author:</td>
<td>Rich Fiorella <a href="https://orcid.org/0000-0002-0824-4777"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-20 04:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate_12CO2'>calculate_12CO2</h2><span id='topic+calculate_12CO2'></span>

<h3>Description</h3>

<p>calculate_12CO2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_12CO2(total_co2, delta13C, f = 0.00474)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_12CO2_+3A_total_co2">total_co2</code></td>
<td>
<p>Vector of CO2 mole fractions.</p>
</td></tr>
<tr><td><code id="calculate_12CO2_+3A_delta13c">delta13C</code></td>
<td>
<p>Vector of d13C values.</p>
</td></tr>
<tr><td><code id="calculate_12CO2_+3A_f">f</code></td>
<td>
<p>Fraction of CO2 that is not 12CO2 or 13CO2. Assumed fixed
at 0.00474</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of 12CO2 mole fractions.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculate_12CO2(total_co2 = 410, delta13C = -8.5)

</code></pre>

<hr>
<h2 id='calculate_13CO2'>calculate_13CO2</h2><span id='topic+calculate_13CO2'></span>

<h3>Description</h3>

<p>calculate_13CO2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_13CO2(total_co2, delta13C, f = 0.00474)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_13CO2_+3A_total_co2">total_co2</code></td>
<td>
<p>Vector of CO2 mole fractions.</p>
</td></tr>
<tr><td><code id="calculate_13CO2_+3A_delta13c">delta13C</code></td>
<td>
<p>Vector of d13C values.</p>
</td></tr>
<tr><td><code id="calculate_13CO2_+3A_f">f</code></td>
<td>
<p>Fraction of CO2 that is not 12CO2 or 13CO2. Assumed fixed
at 0.00474</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of 13CO2 mole fractions.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>calculate_13CO2(total_co2 = 410, delta13C = -8.5)

</code></pre>

<hr>
<h2 id='calibrate_ambient_carbon_Bowling2003'>calibrate_ambient_carbon_Bowling2003</h2><span id='topic+calibrate_ambient_carbon_Bowling2003'></span>

<h3>Description</h3>

<p>calibrate_ambient_carbon_Bowling2003
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_ambient_carbon_Bowling2003(
  amb_data_list,
  caldf,
  site,
  filter_data = TRUE,
  force_to_end = TRUE,
  force_to_beginning = TRUE,
  gap_fill_parameters = FALSE,
  r2_thres = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_amb_data_list">amb_data_list</code></td>
<td>
<p>List containing an ambient d13C dataset.
Will include all variables in 000_0x0_xxm. (character)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_caldf">caldf</code></td>
<td>
<p>Calibration data frame containing gain and offset values for
12C and 13C isotopologues.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_site">site</code></td>
<td>
<p>Four-letter NEON code corresponding to site being processed.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_filter_data">filter_data</code></td>
<td>
<p>Apply median absolute deviation filter from Brock 86 to
remove impulse spikes? Inherited from
<code>calibrate_ambient_carbon_Bowling2003()</code></p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_force_to_end">force_to_end</code></td>
<td>
<p>In given month, calibrate ambient data later than last
calibration, using the last calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_force_to_beginning">force_to_beginning</code></td>
<td>
<p>In given month, calibrate ambient data before than
first calibration, using the first calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_gap_fill_parameters">gap_fill_parameters</code></td>
<td>
<p>Should function attempt to 'gap-fill' across a
bad calibration by carrying the last known good calibration
forward? Implementation is fairly primitive currently, as
it only carries the last known good calibration that's
available forward rather than interpolating, etc. Default FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_Bowling2003_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 value for calibration to be considered &quot;good&quot; and
applied to ambient data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depends on <code>write_to_file</code> argument.
If true, returns nothing to environment;
but returns calibrated ambient observations to the output file.
If false, returns modified version of amb_data_list that include
calibrated ambient data.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>
<p>Function called by <code>calibrate_carbon_bymonth()</code> to apply
gain and offset parameters to the ambient datasets (000_0x0_09m and
000_0x0_30m). This function should generally not be used independently,
but should be used in coordination with
<code>calibrate_carbon_bymonth()</code>.
</p>

<hr>
<h2 id='calibrate_ambient_carbon_linreg'>calibrate_ambient_carbon_linreg</h2><span id='topic+calibrate_ambient_carbon_linreg'></span>

<h3>Description</h3>

<p>calibrate_ambient_carbon_linreg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_ambient_carbon_linreg(
  amb_data_list,
  caldf,
  outname,
  site,
  filter_data = TRUE,
  force_to_end = TRUE,
  force_to_beginning = TRUE,
  gap_fill_parameters = FALSE,
  r2_thres = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_amb_data_list">amb_data_list</code></td>
<td>
<p>List containing an ambient d13C dataset.
Will include all variables in 000_0x0_xxm. (character)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_caldf">caldf</code></td>
<td>
<p>Calibration data frame containing gain and offset values for
12C and 13C isotopologues.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_outname">outname</code></td>
<td>
<p>Output variable name. Inherited from
<code>calibrate_ambient_carbon_linreg</code></p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_site">site</code></td>
<td>
<p>Four-letter NEON code corresponding to site being processed.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_filter_data">filter_data</code></td>
<td>
<p>Apply median absolute deviation filter from Brock 86 to
remove impulse spikes? Inherited from
<code>calibrate_ambient_carbon_linreg</code></p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_force_to_end">force_to_end</code></td>
<td>
<p>In given month, calibrate ambient data later than last
calibration, using the last calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_force_to_beginning">force_to_beginning</code></td>
<td>
<p>In given month, calibrate ambient data before than
first calibration, using the first calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_gap_fill_parameters">gap_fill_parameters</code></td>
<td>
<p>Should function attempt to 'gap-fill' across a
bad calibration by carrying the last good calibration forward?
Implementation is fairly primitive currently, as it only carries
the last known good calibration that's available forward rather
than interpolating, etc. Default FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_carbon_linreg_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 value for calibration to be considered &quot;good&quot; and
applied to ambient data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to environment; returns calibrated ambient observations to
the function orchestrating calibration (calibrate_carbon).
This function is not designed to be called on its own,
and is not exported to the namespace.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>
<p>Function called by <code>calibrate_ambient_carbon_linreg</code> to apply
gain and offset parameters to the ambient datasets (000_0x0_09m and
000_0x0_30m). This function should generally not be used independently,
but should be used with <code>calibrate_ambient_carbon_linreg</code>.
</p>

<hr>
<h2 id='calibrate_ambient_water_linreg'>calibrate_ambient_water_isotopes</h2><span id='topic+calibrate_ambient_water_linreg'></span>

<h3>Description</h3>

<p>calibrate_ambient_water_isotopes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_ambient_water_linreg(
  amb_data_list,
  caldf,
  outname,
  site,
  file,
  filter_data,
  force_to_end,
  force_to_beginning,
  r2_thres
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_amb_data_list">amb_data_list</code></td>
<td>
<p>List containing ambient d18O/d2H datasets.
Will include all variables in 000_0x0_xxm. (character)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_caldf">caldf</code></td>
<td>
<p>Calibration data frame containing slope and intercept values
for d18O and d2H values.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_outname">outname</code></td>
<td>
<p>Output variable name. Inherited from
<code>calibrate_ambient_water_linreg</code></p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_site">site</code></td>
<td>
<p>Four-letter NEON code corresponding to site being processed.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_file">file</code></td>
<td>
<p>Output file name. Inherited from
<code>calibrate_ambient_water_linreg</code></p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_filter_data">filter_data</code></td>
<td>
<p>Apply a median filter to output ambient data? inherited.</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_force_to_end">force_to_end</code></td>
<td>
<p>In given month, calibrate ambient data later than last
calibration, using the last calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_force_to_beginning">force_to_beginning</code></td>
<td>
<p>In given month, calibrate ambient data before than
first calibration, using the first calibration? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_ambient_water_linreg_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 value for calibration to be considered &quot;good&quot; and
applied to ambient data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to environment; returns calibrated ambient observations to
the output file. This function is not designed to be called on its own.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>
<p>Function called by <code>calibrate_ambient_water_linreg</code> to apply
slope and intercept parameters to the ambient datasets (000_0x0_09m and
000_0x0_30m) to correct to the VSMOW scale.
This function should generally not be used independently,
but should be used with <code>calibrate_ambient_water_linreg</code>.
Note that in this version <em>NO CORRECTION FOR HUMIDITY</em> is performed.
Use with caution.
</p>

<hr>
<h2 id='calibrate_carbon'>calibrate_carbon</h2><span id='topic+calibrate_carbon'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This function drives a workflow that reads in NEON carbon isotope data
of atmospheric CO2, calibrates it to the VPDB scale, and (optionally)
writes the calibrated data to a new HDF5 file. Two different approaches
are possible: a) a calibration on 12CO2 and 13CO2 isotopologues
independently, after Bowling et al. 2003 (Agr. For. Met.), or b) a direct
calibration of d13C and CO2 values using linear regression. Most of the time
the results generated are extremely similar to each other.
Wen et al. 2013 compared several different carbon
isotope calibration techniques and found this to be the superior method
under most circumstances. We also found this to be the case for NEON data
(Fiorella et al. 2021; JGR-Biogeosciences).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_carbon(
  inname,
  outname,
  site,
  method = "Bowling_2003",
  calibration_half_width = 0.5,
  force_cal_to_beginning = TRUE,
  force_cal_to_end = TRUE,
  gap_fill_parameters = FALSE,
  filter_ambient = TRUE,
  r2_thres = 0.95,
  correct_refData = TRUE,
  write_to_file = TRUE,
  remove_known_bad_months = TRUE,
  plot_regression_data = FALSE,
  plot_directory = NULL,
  avg = 9,
  min_nobs = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_carbon_+3A_inname">inname</code></td>
<td>
<p>Input file(s) that are to be calibrated. If a single file is
given, output will be a single file per site per month. If a
list of files corresponding to a timeseries at a given site
is provided, will calibrate the whole time series.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_outname">outname</code></td>
<td>
<p>Name of the output file. (character)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_site">site</code></td>
<td>
<p>Four letter NEON site code for site being processed. (character)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_method">method</code></td>
<td>
<p>Are we using the Bowling et al. 2003 method
(&quot;Bowling_2003&quot;) or direct linear regression of
d13C and CO2 mole fractions (&quot;linreg&quot;)?</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_calibration_half_width">calibration_half_width</code></td>
<td>
<p>Determines the period (in days)
from which reference data are selected (period
is 2*calibration_half_width).</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_force_cal_to_beginning">force_cal_to_beginning</code></td>
<td>
<p>Extend first calibration to the beginning
of the file? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_force_cal_to_end">force_cal_to_end</code></td>
<td>
<p>Extend last calibration to the end of the file?
(default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_gap_fill_parameters">gap_fill_parameters</code></td>
<td>
<p>Should function attempt to 'gap-fill' across a
bad calibration by carrying the last good calibration forward?
Implementation is fairly primitive currently, as it only carries
the last known good calibration that's available forward rather
than interpolating, etc. Default FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_filter_ambient">filter_ambient</code></td>
<td>
<p>Apply the median absolute deviation filter (Brock 86)
to remove impulse spikes in output ambient data?
(logical; default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 threshold of an &quot;acceptable&quot; calibration. Acts to
remove calibration periods where a measurement error makes
relationship nonlinear. Default = 0.95</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_correct_refdata">correct_refData</code></td>
<td>
<p>NEON has indicated there are a few instances where
reported d13C or CO2 reference values are wrong. If set to true,
correct known incorrect values. This argument will (hopefully,
eventually) go away after NEON has fixed the reference database.
Users will be warned prior to removal of this argument.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_write_to_file">write_to_file</code></td>
<td>
<p>Write calibrated ambient data to file?
(Mostly used for testing)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_remove_known_bad_months">remove_known_bad_months</code></td>
<td>
<p>There are a few site months with known
spectral issues where the isotope ratios are likely unrecoverable.
This parameter allows removal of these files, but allows them to
remain in archive.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_plot_regression_data">plot_regression_data</code></td>
<td>
<p>Default false; this is useful for diagnostics.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_plot_directory">plot_directory</code></td>
<td>
<p>Only used if plot_regression_data is TRUE, but specify
where to write out diagnostic plot of regression data.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_avg">avg</code></td>
<td>
<p>The averaging interval to extract, in minutes. Default 9, but will
change to 6 eventually.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_+3A_min_nobs">min_nobs</code></td>
<td>
<p>Minimum number of high-frequency observations to define a peak.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'linreg' method simply takes measured and reference d13C and CO2 values
and generates a transfer function between them using <code>lm()</code>. For the
gain-and-offset method, d13C and CO2 values are converted to 12CO2 and 13CO2
mole fractions. Gain and offset parameters are calculated for each
isotopologue independently, and are analogous to regression slope and
intercepts, but jointly correct for CO2 concentration dependence
and place d13C values on the VPDB scale.
The gain and offset parameters are defined by:
</p>
<p style="text-align: center;"><code class="reqn">G = (X_{2,ref}-X_{1,ref})/(X_{2,meas}-X_{1,meas})</code>
</p>

<p style="text-align: center;"><code class="reqn">O = X_{2,ref}- G X_{2,meas}</code>
</p>

<p>Calibrated ambient isotopologues are then given as:
</p>
<p style="text-align: center;"><code class="reqn">X_{cal} = X_{meas} G + O</code>
</p>

<p>Measurements of reference materials were considered &quot;good&quot; if the following
conditions were met:
</p>

<ul>
<li><p> Measured CO2 concentrations were within 10 ppm
of known &quot;reference&quot; concentrations.
</p>
</li>
<li><p> Variance of the CO2 concentration in standard peak was &lt; 5 ppm.
</p>
</li>
<li><p> Measured d13C value must be within 5 per mil
of known &quot;reference&quot; d13C value.
</p>
</li></ul>

<p>The first two criteria are intended to filter out periods where there is
a clear issue with the gas delivery system (i.e., nearly empty gas tank,
problem with a valve in the manifold, etc.); the third criterion was adopted
after visual inspection of data timeseries revealed that often the first
standard measurement following an instrument issue had higher-than-expected
error. This criterion clips clearly poor values. Selection of these criteria
will become a function argument, and therefore customizable,
in a future release.
</p>
<p>The behavior of this function will be a bit different depending on what
is supplied as <code>inname</code>. If a single file is provided, the output will be
monthly. However, a list of files corresponding to a site can also be
provided, and then a single output file per site will be generated.
</p>


<h3>Value</h3>

<p>Returns nothing to the environment, but creates a new output HDF5
file containing calibrated carbon isotope values.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: fin &lt;- system.file('extdata',
'NEON.D15.ONAQ.DP4.00200.001.nsae.2019-05.basic.20201020T211037Z.packed.h5',
         package = 'NEONiso', mustWork = TRUE)
calibrate_carbon_bymonth(inname = fin, outname = 'out.h5',
         site = 'ONAQ', write_to_file = FALSE)
calibrate_carbon_bymonth(inname = fin, outname = 'out.h5',
         site = 'ONAQ', method = 'linreg', write_to_file = FALSE)
## End(Not run)

</code></pre>

<hr>
<h2 id='calibrate_carbon_bymonth'>calibrate_carbon_bymonth</h2><span id='topic+calibrate_carbon_bymonth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
This function drives a workflow that reads in NEON carbon isotope data
of atmospheric CO2, calibrates it to the VPDB scale, and (optionally)
writes the calibrated data to a new HDF5 file. Two different approaches
are possible: a) a calibration on 12CO2 and 13CO2 isotopologues separately,
after Bowling et al. 2003 (Agr. For. Met.), or b) a direct calibration
of d13C and CO2 values using linear regression. The vast majority of the time
the results generated from either method are extremely similar to each other.
Wen et al. 2013 compared several different carbon
isotope calibration techniques and found this to be the superior method
under most circumstances. We also found this to be the case for NEON data
(Fiorella et al. 2021; JGR-Biogeosciences).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_carbon_bymonth(
  inname,
  outname,
  site,
  method = "Bowling_2003",
  calibration_half_width = 0.5,
  force_cal_to_beginning = TRUE,
  force_cal_to_end = TRUE,
  gap_fill_parameters = FALSE,
  filter_ambient = TRUE,
  r2_thres = 0.95,
  correct_refData = TRUE,
  write_to_file = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_carbon_bymonth_+3A_inname">inname</code></td>
<td>
<p>Name of the input file. (character)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_outname">outname</code></td>
<td>
<p>Name of the output file. (character)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_site">site</code></td>
<td>
<p>Four letter NEON site code for site being processed. (character)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_method">method</code></td>
<td>
<p>Are we using the Bowling et al. 2003 method
(&quot;Bowling_2003&quot;) or direct linear regression of
d13C and CO2 mole fractions (&quot;linreg&quot;)?</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_calibration_half_width">calibration_half_width</code></td>
<td>
<p>Determines the period (in days)
from which reference data are selected (period
is 2*calibration_half_width).</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_force_cal_to_beginning">force_cal_to_beginning</code></td>
<td>
<p>Extend first calibration to the beginning
of the file? (default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_force_cal_to_end">force_cal_to_end</code></td>
<td>
<p>Extend last calibration to the end of the file?
(default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_gap_fill_parameters">gap_fill_parameters</code></td>
<td>
<p>Should function attempt to 'gap-fill' across a
bad calibration by carrying the last known good calibration
forward?
Implementation is fairly primitive currently, as it only carries
the last known good calibration that's available forward rather
than interpolating, etc. Default FALSE.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_filter_ambient">filter_ambient</code></td>
<td>
<p>Apply the median absolute deviation filter (Brock 86)
to remove impulse spikes in output ambient data?
(logical; default true)</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 threshold of an &quot;acceptable&quot; calibration. Acts to
remove calibration periods where a measurement error makes
relationship nonlinear. Default = 0.95</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_correct_refdata">correct_refData</code></td>
<td>
<p>NEON has indicated there are a few instances where
reported d13C or CO2 reference values are wrong. If set to true,
correct known incorrect values. This argument will (hopefully,
eventually) go away after NEON has fixed the reference database.
Users will be warned prior to removal of this argument.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_bymonth_+3A_write_to_file">write_to_file</code></td>
<td>
<p>Write calibrated ambient data to file?
(Mostly used for testing)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'linreg' method simply takes measured and reference d13C and CO2 values
and generates a transfer function between them using <code>lm()</code>. For the
gain-and-offset method, d13C and CO2 values are converted to 12CO2 and 13CO2
mole fractions. Gain and offset parameters are calculated for each
isotopologue independently, and are analogous to regression slope
and intercepts, but jointly correct for CO2 concentration dependence
and place d13C values on the VPDB scale.
The gain and offset parameters are defined by:
</p>
<p style="text-align: center;"><code class="reqn">G = (X_{2,ref}-X_{1,ref})/(X_{2,meas}-X_{1,meas})</code>
</p>

<p style="text-align: center;"><code class="reqn">O = X_{2,ref}- G X_{2,meas}</code>
</p>

<p>Calibrated ambient isotopologues are then given as:
</p>
<p style="text-align: center;"><code class="reqn">X_{cal} = X_{meas} G + O</code>
</p>

<p>Measurements of reference materials were considered &quot;good&quot; if the following
conditions were met:
</p>

<ul>
<li><p> Measured CO2 concentrations were within 10 ppm
of known &quot;reference&quot; concentrations.
</p>
</li>
<li><p> Variance of the CO2 concentration in standard peak was &lt; 5 ppm.
</p>
</li>
<li><p> Measured d13C value must be within 5 per mil
of known &quot;reference&quot; d13C value.
</p>
</li></ul>

<p>The first two criteria are intended to filter out periods where there is
a clear issue with the gas delivery system (i.e., nearly empty gas tank,
problem with a valve in the manifold, etc.); the third criterion was adopted
after visual inspection of data timeseries revealed that often the first
standard measurement following an instrument issue had higher-than-expected
error. This criterion clips clearly poor values. Selection of these criteria
will become a function argument, and therefore customizable,
in a future release.
</p>


<h3>Value</h3>

<p>Returns nothing to the environment, but creates a new output HDF5
file containing calibrated carbon isotope values.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: fin &lt;- system.file('extdata',
'NEON.D15.ONAQ.DP4.00200.001.nsae.2019-05.basic.20201020T211037Z.packed.h5',
         package = 'NEONiso', mustWork = TRUE)
calibrate_carbon_bymonth(inname = fin, outname = 'out.h5',
         site = 'ONAQ', write_to_file = FALSE)
calibrate_carbon_bymonth(inname = fin, outname = 'out.h5',
         site = 'ONAQ', method = 'linreg', write_to_file = FALSE)
## End(Not run)

</code></pre>

<hr>
<h2 id='calibrate_carbon_reference_data'>calibrate_carbon_reference_data</h2><span id='topic+calibrate_carbon_reference_data'></span>

<h3>Description</h3>

<p>calibrate_carbon_reference_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_carbon_reference_data(inname, outname, standard, site, calDf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_carbon_reference_data_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_reference_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_reference_data_+3A_standard">standard</code></td>
<td>
<p>Which standard are we working on? Must be &quot;Low&quot;,
&quot;Med&quot;, or &quot;High&quot;</p>
</td></tr>
<tr><td><code id="calibrate_carbon_reference_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="calibrate_carbon_reference_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_carbon_regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='calibrate_standards_carbon'>calibrate_standards_carbon</h2><span id='topic+calibrate_standards_carbon'></span>

<h3>Description</h3>

<p>calibrate_standards_carbon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_standards_carbon(
  cal_df,
  ref_df,
  f = 0.00474,
  r2_thres = 0.95,
  correct_bad_refvals = FALSE,
  site,
  refGas
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_standards_carbon_+3A_cal_df">cal_df</code></td>
<td>
<p>Data.frame containing calibration parameters</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_ref_df">ref_df</code></td>
<td>
<p>Data.frame containing reference gas measurements</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_f">f</code></td>
<td>
<p>Fraction of CO2 isotopologues that are not 12CO2 or 13CO2.
Inherited from script calling this function.</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Threshold for calibration regression to be used to
calibrate standards data. Default is 0.95. Calibrated reference
gas measurements occurring during calibration periods
with r2 values less than <code>r2_thres</code> will be marked NA.</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_correct_bad_refvals">correct_bad_refvals</code></td>
<td>
<p>Should we correct known/suspected incorrect
reference values in the NEON HDF5 files? (Default = <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_site">site</code></td>
<td>
<p>Four letter NEON site code.
Only used if <code>correct_bad_refvals = TRUE</code>.</p>
</td></tr>
<tr><td><code id="calibrate_standards_carbon_+3A_refgas">refGas</code></td>
<td>
<p>One of &quot;low&quot;, &quot;med&quot;, or &quot;high.&quot;
Only used if <code>correct_bad_refvals = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame having the same number of rows of <code>cal_df</code>, with
additional columns added for calibrated CO2 mole fractions
and d13C values.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='calibrate_standards_water'>calibrate_standards_water</h2><span id='topic+calibrate_standards_water'></span>

<h3>Description</h3>

<p>calibrate_standards_water
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_standards_water(cal_df, ref_df, r2_thres = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_standards_water_+3A_cal_df">cal_df</code></td>
<td>
<p>Data.frame containing calibration parameters</p>
</td></tr>
<tr><td><code id="calibrate_standards_water_+3A_ref_df">ref_df</code></td>
<td>
<p>Data.frame containing reference gas measurements</p>
</td></tr>
<tr><td><code id="calibrate_standards_water_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Threshold for calibration regression to be used to
calibrate standards data. Default is 0.95. Calibrated reference
gas measurements occurring during calibration periods
with r2 values less than <code>r2_thres</code> will be marked NA.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='calibrate_water'>calibrate_water</h2><span id='topic+calibrate_water'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
This function uses NEON validation data to apply drift corrections to
measured ambient water isotope ratios. In brief, ambient water isotope
ratios are calibrated by generating regressions using reference water
measurements bracketing an ambient period. Three reference waters are
measured once per day, with several injections per reference water.
Due to memory effects, only the last three are used currently to generate
calibration equations. Regressions between measured d18O and d2H values
and NEON-provisioned known reference values are generated, and used to
calibrate the period of ambient measurements between them if the r2 of
the regression is greater than a threshold value (by default, this is 0.95).
Most of this function deals with selecting the appropriate calibration data
and determining calibration quality. This function also contains a wrapper
for <code>calibrate_ambient_water_linreg</code>, which calibrates the ambient
water data using the calibration parameters generated in this function.
This function also copies over data in the qfqm and ucrt hdf5 data groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_water(
  inpath,
  outpath,
  site,
  calibration_half_width = 14,
  filter_data = TRUE,
  force_cal_to_beginning = FALSE,
  force_cal_to_end = FALSE,
  r2_thres = 0.95,
  slope_tolerance = 9999
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_water_+3A_inpath">inpath</code></td>
<td>
<p>Directory path to input (monthly) NEON HDF5 files.</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_outpath">outpath</code></td>
<td>
<p>Directory path to save output data file.
(For now, 1 per site).</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_site">site</code></td>
<td>
<p>Four-letter NEON code for site being processed.</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_calibration_half_width">calibration_half_width</code></td>
<td>
<p>Determines the range of standard measurements
to use in determining the calibration regression dataset. Creates
a moving window that is <code>2*calibration_half_width</code> days wide.
Default is set to 14 for a 28 day moving window.</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_filter_data">filter_data</code></td>
<td>
<p>Apply median absolute deviation filter from Brock 86 to
remove impulse spikes?</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_force_cal_to_beginning">force_cal_to_beginning</code></td>
<td>
<p>Extend first calibration to
the beginning of the file?</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_force_cal_to_end">force_cal_to_end</code></td>
<td>
<p>Extend last calibration to the end of the file?</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 threshold of an &quot;acceptable&quot; calibration. Acts to
remove calibration periods where a measurement error makes
relationship nonlinear. Default = 0.95</p>
</td></tr>
<tr><td><code id="calibrate_water_+3A_slope_tolerance">slope_tolerance</code></td>
<td>
<p>How different from 1 should we allow
'passing' regression slopes to be? Experimental parameter,
off by default (e.g., default slope parameter = 9999)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>IMPORTANT NOTE</em> Currently this function does not apply a correction for
humidity dependence of Picarro isotopic measurements. This is because the
data to implement these corrections is not yet publicly available.
Caution is suggested when analyzing data at low humidities, below ~5000 ppm,
with likely higher biases at lower humidity values.
</p>
<p>Additionally, please note that this function is meant to work on <em>all</em> files
for a given site at the same time. A more flexible version that can handle
all files or monthly files will be added to a future release.
</p>


<h3>Value</h3>

<p>nothing to the workspace, but creates a new output file of
calibrated water isotope data.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='calibrate_water_linreg_bymonth'>calibrate_water_linreg</h2><span id='topic+calibrate_water_linreg_bymonth'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
This function uses NEON validation data to apply drift corrections to
measured ambient water isotope ratios. In brief, ambient water isotope
ratios are calibrated by generating regressions using reference water
measurements bracketing an ambient period. Three reference waters are
measured once per day, with several injections per reference water.
Due to memory effects, only the last three are used currently to generate
calibration equations. Regressions between measured d18O and d2H values
and NEON-provisioned known reference values are generated, and used to
calibrate the period of ambient measurements between them if the r2 of
the regression is greater than a threshold value (by default, this is 0.95).
Most of this function deals with selecting the appropriate calibration data
and determining calibration quality. This function also contains a wrapper
for <code>calibrate_ambient_water_linreg</code>, which calibrates the ambient
water data using the calibration parameters generated in this function.
This function also copies over data in the qfqm and ucrt hdf5 data groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_water_linreg_bymonth(
  inname,
  outname,
  site,
  time_diff_betweeen_standards = 1800,
  filter_data = TRUE,
  force_cal_to_beginning = TRUE,
  force_cal_to_end = TRUE,
  r2_thres = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_inname">inname</code></td>
<td>
<p>Name of the input file.</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_outname">outname</code></td>
<td>
<p>Name of the output file.</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_site">site</code></td>
<td>
<p>Four-letter NEON code for site being processed.</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_time_diff_betweeen_standards">time_diff_betweeen_standards</code></td>
<td>
<p>Time (in seconds) required between
consecutive standard measurements.</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_filter_data">filter_data</code></td>
<td>
<p>Apply median absolute deviation filter from Brock 86 to
remove impulse spikes?</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_force_cal_to_beginning">force_cal_to_beginning</code></td>
<td>
<p>Extend first calibration to
the beginning of the file?</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_force_cal_to_end">force_cal_to_end</code></td>
<td>
<p>Extend last calibration to the end of the file?</p>
</td></tr>
<tr><td><code id="calibrate_water_linreg_bymonth_+3A_r2_thres">r2_thres</code></td>
<td>
<p>Minimum r2 threshold of an &quot;acceptable&quot; calibration. Acts to
remove calibration periods where a measurement error makes
relationship nonlinear. Default = 0.95</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>IMPORTANT NOTE</em> Currently this function does not apply a correction for
humidity dependence of Picarro isotopic measurements. This is because the
data to implement these corrections is not yet publicly available.
Caution is suggested when analyzing data at low humidities, below ~5000 ppm,
with likely higher biases at lower humidity values.
</p>


<h3>Value</h3>

<p>nothing to the workspace, but creates a new output file of
calibrated carbon isotope data.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='calibrate_water_reference_data'>calibrate_water_reference_data</h2><span id='topic+calibrate_water_reference_data'></span>

<h3>Description</h3>

<p>calibrate_water_reference_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate_water_reference_data(outname, standard, site, stdDf, calDf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate_water_reference_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="calibrate_water_reference_data_+3A_standard">standard</code></td>
<td>
<p>Which reference material is being 'calibrated'?
(Low, med, or high)</p>
</td></tr>
<tr><td><code id="calibrate_water_reference_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="calibrate_water_reference_data_+3A_stddf">stdDf</code></td>
<td>
<p>Data frame of reference material measurements.</p>
</td></tr>
<tr><td><code id="calibrate_water_reference_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_water_regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment.
</p>

<hr>
<h2 id='carbon_regression_plots'>carbon_regression_plots</h2><span id='topic+carbon_regression_plots'></span>

<h3>Description</h3>

<p>carbon_regression_plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>carbon_regression_plots(caldata, plot_filename, method, mtitle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="carbon_regression_plots_+3A_caldata">caldata</code></td>
<td>
<p>Data frame corresponding to a specific calibration
period.</p>
</td></tr>
<tr><td><code id="carbon_regression_plots_+3A_plot_filename">plot_filename</code></td>
<td>
<p>What should the output file name for diagnostic plot be?</p>
</td></tr>
<tr><td><code id="carbon_regression_plots_+3A_method">method</code></td>
<td>
<p>Which method are we using? Currently works for gain/offset.</p>
</td></tr>
<tr><td><code id="carbon_regression_plots_+3A_mtitle">mtitle</code></td>
<td>
<p>Fed from above routine - what should the plot title be?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but a pdf plot to a file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='convert_NEONhdf5_to_POSIXct_time'>convert_NEONhdf5_to_POSIXct_time</h2><span id='topic+convert_NEONhdf5_to_POSIXct_time'></span>

<h3>Description</h3>

<p>convert_NEONhdf5_to_POSIXct_time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_NEONhdf5_to_POSIXct_time(intime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_NEONhdf5_to_POSIXct_time_+3A_intime">intime</code></td>
<td>
<p>Vector of datetimes in NEON data files (as string)
to convert to POSIXct class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of datetimes from NEON data file now in POSIXct format.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_NEONhdf5_to_POSIXct_time("2019-06-01T12:00:00.000Z")
</code></pre>

<hr>
<h2 id='convert_POSIXct_to_NEONhdf5_time'>convert_POSIXct_to_NEONhdf5_time</h2><span id='topic+convert_POSIXct_to_NEONhdf5_time'></span>

<h3>Description</h3>

<p>Converts a POSIXct object back to the character format used by NEON in their
HDF eddy covariance files. Output format,  using strptime syntax,  is
%Y-%m-%dT%H:%M:%OSZ.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_POSIXct_to_NEONhdf5_time(intime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_POSIXct_to_NEONhdf5_time_+3A_intime">intime</code></td>
<td>
<p>POSIXct vector to convert to NEON time format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns character version of POSIXct object
matching NEON time variable format.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_POSIXct_to_NEONhdf5_time(Sys.time())
</code></pre>

<hr>
<h2 id='copy_qfqm_group'>copy_qfqm_group</h2><span id='topic+copy_qfqm_group'></span>

<h3>Description</h3>

<p>copy_qfqm_group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_qfqm_group(data_list, outname, site, file, species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_qfqm_group_+3A_data_list">data_list</code></td>
<td>
<p>List of groups to retrieve qfqm data from.</p>
</td></tr>
<tr><td><code id="copy_qfqm_group_+3A_outname">outname</code></td>
<td>
<p>Output filename.</p>
</td></tr>
<tr><td><code id="copy_qfqm_group_+3A_site">site</code></td>
<td>
<p>Four-letter NEON site code.</p>
</td></tr>
<tr><td><code id="copy_qfqm_group_+3A_file">file</code></td>
<td>
<p>Input filename.</p>
</td></tr>
<tr><td><code id="copy_qfqm_group_+3A_species">species</code></td>
<td>
<p>CO2 or H2O? Same function used for both CO2 and H2O isotopes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the workspace, but copies qfqm group from input file to
output file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='copy_ucrt_group'>copy_ucrt_group</h2><span id='topic+copy_ucrt_group'></span>

<h3>Description</h3>

<p>copy_ucrt_group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_ucrt_group(data_list, outname, site, file, species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="copy_ucrt_group_+3A_data_list">data_list</code></td>
<td>
<p>List of groups to retrieve ucrt data from.</p>
</td></tr>
<tr><td><code id="copy_ucrt_group_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="copy_ucrt_group_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="copy_ucrt_group_+3A_file">file</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="copy_ucrt_group_+3A_species">species</code></td>
<td>
<p>H2O or CO2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the workspace, but copies ucrt group from input file to
output file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='correct_carbon_ref_cval'>correct_carbon_ref_cval</h2><span id='topic+correct_carbon_ref_cval'></span>

<h3>Description</h3>

<p>This ugly function is present out of necessity, and will
only exist for as long as it is necessary. It is an internal
correction within the NEONiso calibration routines that is
required as there are some mismatches between the 'true'
isotope reference values and those in the NEON HDF5 files.
NEON is working on correcting this, and after it has been
corrected, this function has no need to exist and will be
immediately deprecated. As a result, this function is
fairly messy but there is little incentive to improve it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_carbon_ref_cval(
  std_frame,
  site,
  omit_already_corrected = TRUE,
  co2_tol = 5,
  d13c_tol = 0.25
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct_carbon_ref_cval_+3A_std_frame">std_frame</code></td>
<td>
<p>Standard data frame to perform swap on.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_cval_+3A_site">site</code></td>
<td>
<p>NEON four letter site code.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_cval_+3A_omit_already_corrected">omit_already_corrected</code></td>
<td>
<p>Should we attempt correction, if it's
already been corrected in the raw files.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_cval_+3A_co2_tol">co2_tol</code></td>
<td>
<p>Tolerance to use to select co2 values that need to be
replaced, in ppm. Default = 5 ppm.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_cval_+3A_d13c_tol">d13c_tol</code></td>
<td>
<p>Tolerance to use to select d13C values that need to be
replaced, in ppm. Default = 0.25 per mil.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Current sites and time periods affected:
</p>


<h3>Value</h3>

<p>A data.frame, based on <code>std_frame</code>, where NEON-supplied
reference values have been corrected if a mismatch has previously
been identified.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='correct_carbon_ref_output'>Correct carbon ref output</h2><span id='topic+correct_carbon_ref_output'></span>

<h3>Description</h3>

<p>Correct carbon ref output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correct_carbon_ref_output(
  std_list,
  site,
  omit_already_corrected = TRUE,
  co2_tol = 5,
  d13c_tol = 0.25,
  refGas
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correct_carbon_ref_output_+3A_std_list">std_list</code></td>
<td>
<p>List containing reference/validation gas measurements.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_output_+3A_site">site</code></td>
<td>
<p>Four-letter NEON site code.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_output_+3A_omit_already_corrected">omit_already_corrected</code></td>
<td>
<p>Skip correction if the reference gas
values have already been corrected in the files (default TRUE)
If you have older versions of the files, you may want to set
this to FALSE.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_output_+3A_co2_tol">co2_tol</code></td>
<td>
<p>Tolerance used to identify a mismatch in CO2 values. Will
correct measured CO2 values within +/- co2_tol within time period
identified as having incorrect reference values.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_output_+3A_d13c_tol">d13c_tol</code></td>
<td>
<p>Tolerance used to identify a mismatch in d13C values. Will
correct measured d13C values within +/- d13c_tol within time
period identified as having incorrect reference values.</p>
</td></tr>
<tr><td><code id="correct_carbon_ref_output_+3A_refgas">refGas</code></td>
<td>
<p>Which reference gas is being corrected? Expects &quot;co2High&quot;,
&quot;co2Med&quot;, or &quot;co2Low&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A version of std_list with corrected reference values.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='delta_to_R'>delta_to_R</h2><span id='topic+delta_to_R'></span>

<h3>Description</h3>

<p>delta_to_R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta_to_R(delta_values, element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta_to_R_+3A_delta_values">delta_values</code></td>
<td>
<p>A vector of isotope ratios in delta notation.</p>
</td></tr>
<tr><td><code id="delta_to_R_+3A_element">element</code></td>
<td>
<p>Which element to return R values -
carbon, oxygen, or hydrogen.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of isotope ratios (R values).
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>delta_to_R(delta_values = 0, element = 'oxygen') # 2005.2e-6 for VSMOW.

</code></pre>

<hr>
<h2 id='estimate_calibration_error'>estimate_calibration_error</h2><span id='topic+estimate_calibration_error'></span>

<h3>Description</h3>

<p>estimate_calibration_error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_calibration_error(formula, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_calibration_error_+3A_formula">formula</code></td>
<td>
<p>Formula to pass to caret::train to perform cross validation.</p>
</td></tr>
<tr><td><code id="estimate_calibration_error_+3A_data">data</code></td>
<td>
<p>Data frame to perform cross-validation on.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='extract_carbon_calibration_data'>extract_carbon_calibration_data.R</h2><span id='topic+extract_carbon_calibration_data'></span>

<h3>Description</h3>

<p>extract_carbon_calibration_data.R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_carbon_calibration_data(data_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_carbon_calibration_data_+3A_data_list">data_list</code></td>
<td>
<p>List containing data, from the /*/dp01/data/
group in NEON HDF5 file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data frame of required variables.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='extract_water_calibration_data'>extract_water_calibration_data</h2><span id='topic+extract_water_calibration_data'></span>

<h3>Description</h3>

<p>extract_water_calibration_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_water_calibration_data(
  data_list,
  ucrt_list = NULL,
  standard,
  ucrt_source = "data",
  method = "by_site"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_water_calibration_data_+3A_data_list">data_list</code></td>
<td>
<p>List containing data, from the /*/dp01/data/
group in NEON HDF5 file.</p>
</td></tr>
<tr><td><code id="extract_water_calibration_data_+3A_ucrt_list">ucrt_list</code></td>
<td>
<p>List containing uncertainty data, from the /*/dp01/ucrt/
group in NEON HDF5 file. (only works if paired with
ucrt_source = 'ucrt' and method = 'by_month')</p>
</td></tr>
<tr><td><code id="extract_water_calibration_data_+3A_standard">standard</code></td>
<td>
<p>String indicating whether to grab data from the high,
medium, or low standard.</p>
</td></tr>
<tr><td><code id="extract_water_calibration_data_+3A_ucrt_source">ucrt_source</code></td>
<td>
<p>Where from HDF5 file should  variance be extracted from?
(Only &quot;data&quot; works now...&quot;ucrt&quot; will throw an error.)</p>
</td></tr>
<tr><td><code id="extract_water_calibration_data_+3A_method">method</code></td>
<td>
<p>Are we calling this function from the calibrate_water_linreg
function (use &quot;by_month&quot;) or the calibrate_water_linreg_bysite
function (use &quot;by_site)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns data frame of required variables.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='filter_median_brock86'>filter_median_Brock86</h2><span id='topic+filter_median_brock86'></span>

<h3>Description</h3>

<p>Median absolute deviation filter of Brock 1986.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_median_brock86(data, width = 7, threshold = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_median_brock86_+3A_data">data</code></td>
<td>
<p>Vector to filter.</p>
</td></tr>
<tr><td><code id="filter_median_brock86_+3A_width">width</code></td>
<td>
<p>Width of filter, in rows.</p>
</td></tr>
<tr><td><code id="filter_median_brock86_+3A_threshold">threshold</code></td>
<td>
<p>Only filter values that are <code>abs(threshold)</code>
away from median</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns filtered vector.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='fit_carbon_regression'>fit_carbon_regression</h2><span id='topic+fit_carbon_regression'></span>

<h3>Description</h3>

<p>fit_carbon_regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_carbon_regression(
  ref_data,
  method,
  calibration_half_width,
  plot_regression_data = FALSE,
  plot_dir = "/dev/null",
  site,
  min_nobs = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_carbon_regression_+3A_ref_data">ref_data</code></td>
<td>
<p>Reference data.frame from which to estimate
calibration parameters.</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_method">method</code></td>
<td>
<p>Are we using the Bowling et al. 2003 method
(&quot;Bowling_2003&quot;) or direct linear regression of
d13C and CO2 mole fractions (&quot;linreg&quot;)?</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_calibration_half_width">calibration_half_width</code></td>
<td>
<p>Determines the period (in days)
from which reference data are selected (period
is 2*calibration_half_width).</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_plot_regression_data">plot_regression_data</code></td>
<td>
<p>True or false - should we plot the data used in
the regression? Useful for debugging.</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_plot_dir">plot_dir</code></td>
<td>
<p>If plot_regression_data is true, where should the
plots be saved?</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_site">site</code></td>
<td>
<p>Needed for regression plots.</p>
</td></tr>
<tr><td><code id="fit_carbon_regression_+3A_min_nobs">min_nobs</code></td>
<td>
<p>Minimum number of high-frequency observations
to define a peak.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame of calibration parameters. If
<code>method == "Bowling_2003"</code>, then data.frame includes
gain and offset parameters for 12CO2 and 13CO2, and r^2
values for each regression. If <code>method == "linreg"</code>,
then data.frame includes slope, intercept, and r^2 values
for d13C and CO2 values.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='fit_water_regression'>fit_water_regression</h2><span id='topic+fit_water_regression'></span>

<h3>Description</h3>

<p>fit_water_regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_water_regression(stds, calibration_half_width, slope_tolerance, r2_thres)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_water_regression_+3A_stds">stds</code></td>
<td>
<p>Reference data.frame from which to estimate
calibration parameters.</p>
</td></tr>
<tr><td><code id="fit_water_regression_+3A_calibration_half_width">calibration_half_width</code></td>
<td>
<p>Determines the period (in days)
from which reference data are selected (period
is 2*calibration_half_width).</p>
</td></tr>
<tr><td><code id="fit_water_regression_+3A_slope_tolerance">slope_tolerance</code></td>
<td>
<p>Allows for filtering of slopes that deviate
from 1 by slope_tolerance.</p>
</td></tr>
<tr><td><code id="fit_water_regression_+3A_r2_thres">r2_thres</code></td>
<td>
<p>What is the minimum r2 value permitted in a 'useful'
calibration relationship.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data.frame of calibration parameters.
Output data.frame includes slope, intercept, and r^2 values
for d13C and CO2 values.
</p>

<hr>
<h2 id='get_Rstd'>get_Rstd</h2><span id='topic+get_Rstd'></span>

<h3>Description</h3>

<p>get_Rstd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_Rstd(element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_Rstd_+3A_element">element</code></td>
<td>
<p>Which element to return standard ratio -
carbon, oxygen, or hydrogen.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Heavy-to-light isotope ratio of most common
stable isotope standard. VSMOW for water,
VPDB for carbon.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_Rstd("carbon") # returns 0.0111797
get_Rstd("oxygen") # returns 2005.20e-6

</code></pre>

<hr>
<h2 id='ingest_data'>ingest_data</h2><span id='topic+ingest_data'></span>

<h3>Description</h3>

<p>ingest_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ingest_data(inname, analyte, name_fix = TRUE, avg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ingest_data_+3A_inname">inname</code></td>
<td>
<p>A file (or list of files) to extract data from for calibration.</p>
</td></tr>
<tr><td><code id="ingest_data_+3A_analyte">analyte</code></td>
<td>
<p>Carbon (Co2) or water (H2o)?</p>
</td></tr>
<tr><td><code id="ingest_data_+3A_name_fix">name_fix</code></td>
<td>
<p>Fix to data frame required for next-generation calibration
functions, but breaks old 'by_month()' functions. This
parameter provides a necessary work around until these
functions are removed.</p>
</td></tr>
<tr><td><code id="ingest_data_+3A_avg">avg</code></td>
<td>
<p>The averaging interval to extract, in minutes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data frames, taken from files specified in <code>inname</code>
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='loocv'>loocv</h2><span id='topic+loocv'></span>

<h3>Description</h3>

<p>loocv
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loocv(mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loocv_+3A_mod">mod</code></td>
<td>
<p>Fitted model to estimate leave-one-out CV on.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>
<p>helper function for the leave-one-out cross variance
</p>

<hr>
<h2 id='manage_local_EC_archive'>manage_local_EC_archive</h2><span id='topic+manage_local_EC_archive'></span>

<h3>Description</h3>

<p>Utility function to help retrieve new EC data and/or prune duplicates,
as NEON provisions new data or re-provisions data for an existing site
and month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manage_local_EC_archive(
  file_dir,
  get = TRUE,
  unzip_files = TRUE,
  trim = FALSE,
  dry_run = TRUE,
  sites = "all",
  release = "RELEASE-2023"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manage_local_EC_archive_+3A_file_dir">file_dir</code></td>
<td>
<p>Specify the root directory where the local EC store is kept.</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_get">get</code></td>
<td>
<p>Pull down data from NEON API that does not exist locally?</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_unzip_files">unzip_files</code></td>
<td>
<p>NEON gzips the hdf5 files, should we unzip any gzipped
files within file_dir? (Searches recursively)</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_trim">trim</code></td>
<td>
<p>Search through local holdings, and remove older file where
there are duplicates?</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_dry_run">dry_run</code></td>
<td>
<p>List files identified as duplicates, but do not actually
delete them? Default true to prevent unintended data loss.</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_sites">sites</code></td>
<td>
<p>Which sites to retrieve data from? Default will be all sites
with available data, but can specify a single site or a vector
here.</p>
</td></tr>
<tr><td><code id="manage_local_EC_archive_+3A_release">release</code></td>
<td>
<p>Download data corresponding to a specific release? Defaults to
&quot;RELEASE-2023.&quot; To download all data, including provisional data,
set to NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns nothing to the environment, but will download new NEON HDF5
files for selected sites (if <code>get = TRUE</code>), unzip them in the local
file directory (if <code>unzip_files = TRUE</code>), and identify and remove
suspected duplicate files (if <code>trim = TRUE</code> and <code>dry_run = FALSE</code>).
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='NEONiso-package'>NEONiso: Tools to Calibrate and Work with NEON Atmospheric Isotope Data</h2><span id='topic+NEONiso'></span><span id='topic+NEONiso-package'></span>

<h3>Description</h3>

<p>Functions for downloading, calibrating, and analyzing atmospheric isotope data bundled into the eddy covariance data products of the National Ecological Observatory Network (NEON) <a href="https://www.neonscience.org">https://www.neonscience.org</a>. Calibration tools are provided for carbon and water isotope products. Carbon isotope calibration details are found in Fiorella et al. (2021) <a href="https://doi.org/10.1029/2020JG005862">doi:10.1029/2020JG005862</a>, and the readme file at <a href="https://github.com/lanl/NEONiso">https://github.com/lanl/NEONiso</a>. Tools for calibrating water isotope products have been added as of 0.6.0, but have known deficiencies and should be considered very experimental currently.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a> (<a href="https://orcid.org/0000-0002-0824-4777">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/lanl/NEONiso">https://github.com/lanl/NEONiso</a>
</p>
</li>
<li> <p><a href="https://lanl.github.io/NEONiso/">https://lanl.github.io/NEONiso/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/lanl/NEONiso/issues">https://github.com/lanl/NEONiso/issues</a>
</p>
</li></ul>


<hr>
<h2 id='R_to_delta'>R_to_delta</h2><span id='topic+R_to_delta'></span>

<h3>Description</h3>

<p>R_to_delta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R_to_delta(R_values, element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R_to_delta_+3A_r_values">R_values</code></td>
<td>
<p>A vector of isotope ratios (e.g., R values).</p>
</td></tr>
<tr><td><code id="R_to_delta_+3A_element">element</code></td>
<td>
<p>Which element to return delta values -
carbon, oxygen, or hydrogen.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of isotope ratios in delta notation.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R_to_delta(R_values = 2005.20e-6, element = 'oxygen') # returns 0.
</code></pre>

<hr>
<h2 id='restructure_ambient_data'>restructure_ambient_data</h2><span id='topic+restructure_ambient_data'></span>

<h3>Description</h3>

<p>restructure_ambient_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restructure_ambient_data(inpath, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restructure_ambient_data_+3A_inpath">inpath</code></td>
<td>
<p>Folder containing data to stack.</p>
</td></tr>
<tr><td><code id="restructure_ambient_data_+3A_analyte">analyte</code></td>
<td>
<p>Carbon (Co2) or water (H2o)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data extracted from files listed in inpath.
</p>

<hr>
<h2 id='restructure_ambient_data2'>restructure_ambient_data2</h2><span id='topic+restructure_ambient_data2'></span>

<h3>Description</h3>

<p>restructure_ambient_data2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restructure_ambient_data2(inpath, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restructure_ambient_data2_+3A_inpath">inpath</code></td>
<td>
<p>Folder containing data to stack.</p>
</td></tr>
<tr><td><code id="restructure_ambient_data2_+3A_analyte">analyte</code></td>
<td>
<p>Carbon (Co2) or water (H2o)?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of data extracted from files listed in inpath.
</p>

<hr>
<h2 id='restructure_carbon_variables'>restructure_carbon_variables</h2><span id='topic+restructure_carbon_variables'></span>

<h3>Description</h3>

<p>restructure_carbon_variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restructure_carbon_variables(dataframe, varname, mode, group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restructure_carbon_variables_+3A_dataframe">dataframe</code></td>
<td>
<p>Input data.frame, from <code>neonUtilities::stackEddy</code></p>
</td></tr>
<tr><td><code id="restructure_carbon_variables_+3A_varname">varname</code></td>
<td>
<p>Which variable are we applying this function to? There's
a list of ~10 common ones to write to the hdf5 file.</p>
</td></tr>
<tr><td><code id="restructure_carbon_variables_+3A_mode">mode</code></td>
<td>
<p>Are we fixing a reference data frame or an ambient data frame?</p>
</td></tr>
<tr><td><code id="restructure_carbon_variables_+3A_group">group</code></td>
<td>
<p>Data, ucrt, or qfqm?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame formatted for output to hdf5 file.
</p>

<hr>
<h2 id='restructure_water_variables'>restructure_water_variables</h2><span id='topic+restructure_water_variables'></span>

<h3>Description</h3>

<p>restructure_water_variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restructure_water_variables(dataframe, varname, mode)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restructure_water_variables_+3A_dataframe">dataframe</code></td>
<td>
<p>Input data.frame, from <code>neonUtilities::stackEddy</code></p>
</td></tr>
<tr><td><code id="restructure_water_variables_+3A_varname">varname</code></td>
<td>
<p>Which variable are we applying this function to? There's
a list of ~10 common ones to write to the hdf5 file.</p>
</td></tr>
<tr><td><code id="restructure_water_variables_+3A_mode">mode</code></td>
<td>
<p>Are we fixing a reference data frame or an ambient data frame?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame formatted for output to hdf5 file.
</p>

<hr>
<h2 id='select_daily_reference_data'>select_daily_reference_data</h2><span id='topic+select_daily_reference_data'></span>

<h3>Description</h3>

<p>select_daily_reference_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_daily_reference_data(standard_df, analyte, min_nobs = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_daily_reference_data_+3A_standard_df">standard_df</code></td>
<td>
<p>Input reference data.frame.</p>
</td></tr>
<tr><td><code id="select_daily_reference_data_+3A_analyte">analyte</code></td>
<td>
<p>Are we calibrating CO2 and H2O?
(Use argument 'co2' or 'h2o', or else function will throw error)</p>
</td></tr>
<tr><td><code id="select_daily_reference_data_+3A_min_nobs">min_nobs</code></td>
<td>
<p>Minimum number of high-frequency
observations to define a peak. If not supplied,
defaults are 200 for <code>analyte = 'co2'</code> or 30 for
<code>analyte = 'h2o'</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Smaller data.frame where only the reference data selected
to use in the calibration routines is returned. Assumes that we are
calibrating on a daily basis, and not on a longer time scale. Data
are selected based on two criteria: cannot be missing, and must be
at least a certain number of high-frequency observations in order to
qualify as a valid measurement. For the water system, this function
also keeps only the last three injections for each reference water
per day.
</p>

<hr>
<h2 id='setup_output_file'>setup_output_file</h2><span id='topic+setup_output_file'></span>

<h3>Description</h3>

<p>Creates a skeleton hdf5 file for the calibrated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_output_file(inname, outname, site, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_output_file_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="setup_output_file_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="setup_output_file_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="setup_output_file_+3A_analyte">analyte</code></td>
<td>
<p>Carbon ('Co2') or water ('H2o') system?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but creates a new data file
with the most basic output HDF5 structure consistent with
NEON's data files.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='swap_standard_isotoperatios'>swap_standard_isotoperatios</h2><span id='topic+swap_standard_isotoperatios'></span>

<h3>Description</h3>

<p>There are a few suspected instances where the water
isotope ratios for oxygen and hydrogen have been flipped
in the reference data. This function corrects them until
they are corrected in the NEON database using a d-excess
filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swap_standard_isotoperatios(std_frame, dxs_thres = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swap_standard_isotoperatios_+3A_std_frame">std_frame</code></td>
<td>
<p>Standard data frame to perform swap on.</p>
</td></tr>
<tr><td><code id="swap_standard_isotoperatios_+3A_dxs_thres">dxs_thres</code></td>
<td>
<p>d-excess threshold to indicate when to swap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame based on <code>std_frame</code>, where d18O and
d2H values have been swapped from NEON input files if
determined to have a reference value mismatch. Mismatch
is determined based on the d-excess of the standard (=
d2H - 8*d18O), using a value of 500 by default.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='terrestrial_core_sites'>terrestrial_core_sites</h2><span id='topic+terrestrial_core_sites'></span>

<h3>Description</h3>

<p>terrestrial_core_sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>terrestrial_core_sites()
</code></pre>


<h3>Value</h3>

<p>A vector listing NEON core terrestrial sites.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terrestrial_core_sites()
</code></pre>

<hr>
<h2 id='terrestrial_relocatable_sites'>terrestrial_relocatable_sites</h2><span id='topic+terrestrial_relocatable_sites'></span>

<h3>Description</h3>

<p>terrestrial_relocatable_sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>terrestrial_relocatable_sites()
</code></pre>


<h3>Value</h3>

<p>A vector listing NEON core terrestrial sites.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>terrestrial_relocatable_sites()
</code></pre>

<hr>
<h2 id='validate_analyte'>validate_analyte</h2><span id='topic+validate_analyte'></span>

<h3>Description</h3>

<p>validate_analyte
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_analyte(analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_analyte_+3A_analyte">analyte</code></td>
<td>
<p>Co2 or H2o?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Standardized string for the water ('H2o') or
carbon ('Co2') systems to make sure strings
are standardized across package functions.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='validate_output_file'>validate_output_file</h2><span id='topic+validate_output_file'></span>

<h3>Description</h3>

<p>validate_output_file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_output_file(inname, outname, site, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_output_file_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="validate_output_file_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="validate_output_file_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="validate_output_file_+3A_analyte">analyte</code></td>
<td>
<p>Carbon ('Co2') or water ('H2o') system?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to environment, simply checks to make sure expected groups
are in output.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='water_isotope_sites'>water_isotope_sites</h2><span id='topic+water_isotope_sites'></span>

<h3>Description</h3>

<p>water_isotope_sites
</p>


<h3>Usage</h3>

<pre><code class='language-R'>water_isotope_sites()
</code></pre>


<h3>Value</h3>

<p>A vector listing NEON sites measuring water vapor isotope ratios.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>water_isotope_sites()
</code></pre>

<hr>
<h2 id='write_carbon_ambient_data'>write_carbon_ambient_data</h2><span id='topic+write_carbon_ambient_data'></span>

<h3>Description</h3>

<p>Write out ambient observations from the NEON EC
towers where the isotope data (either H2O or CO2)
have been calibrated using this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_carbon_ambient_data(outname, site, amb_data_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_carbon_ambient_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_carbon_ambient_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_carbon_ambient_data_+3A_amb_data_list">amb_data_list</code></td>
<td>
<p>Calibrated list of ambient data -
this is the output from one of the calibrate_ambient_carbon* functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes data in amb_data_list to file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_carbon_calibration_data'>write_carbon_calibration_data</h2><span id='topic+write_carbon_calibration_data'></span>

<h3>Description</h3>

<p>write_carbon_calibration_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_carbon_calibration_data(outname, site, calDf, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_carbon_calibration_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_carbon_calibration_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_carbon_calibration_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_carbon_regression</p>
</td></tr>
<tr><td><code id="write_carbon_calibration_data_+3A_method">method</code></td>
<td>
<p>Was the Bowling et al. 2003 or the linear regression
method used in fit_carbon_regression?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes out the
calibration parameters (e.g., gain and offset or
regression slopes and intercepts) to the output
hdf5 file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_carbon_reference_data'>write_carbon_reference_data</h2><span id='topic+write_carbon_reference_data'></span>

<h3>Description</h3>

<p>write_carbon_reference_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_carbon_reference_data(inname, outname, site, calDf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_carbon_reference_data_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="write_carbon_reference_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_carbon_reference_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_carbon_reference_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_carbon_regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes calibrated
reference data to hdf5 file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_qfqm'>write_qfqm</h2><span id='topic+write_qfqm'></span>

<h3>Description</h3>

<p>Write NEON's qfqm data for an isotope species to
output file. Wraps copy_qfqm_group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_qfqm(inname, outname, site, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_qfqm_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="write_qfqm_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_qfqm_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_qfqm_+3A_analyte">analyte</code></td>
<td>
<p>Carbon ('Co2') or water ('H2o') system?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes qfqm data to file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_ucrt'>write_ucrt</h2><span id='topic+write_ucrt'></span>

<h3>Description</h3>

<p>Write NEON's ucrt data for an isotope species to
output file. Wraps copy_ucrt_group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_ucrt(inname, outname, site, analyte)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_ucrt_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="write_ucrt_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_ucrt_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_ucrt_+3A_analyte">analyte</code></td>
<td>
<p>Carbon ('Co2') or water ('H2o') system?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes ucrt data to file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_water_calibration_data'>write_water_calibration_data</h2><span id='topic+write_water_calibration_data'></span>

<h3>Description</h3>

<p>write_water_calibration_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_water_calibration_data(outname, site, calDf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_water_calibration_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_water_calibration_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_water_calibration_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_water_regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes out the
calibration parameters (e.g.,
regression slopes and intercepts) to the output
hdf5 file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

<hr>
<h2 id='write_water_reference_data'>write_water_reference_data</h2><span id='topic+write_water_reference_data'></span>

<h3>Description</h3>

<p>write_water_reference_data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_water_reference_data(inname, outname, site, lowDf, medDf, highDf, calDf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_water_reference_data_+3A_inname">inname</code></td>
<td>
<p>Input file name.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_outname">outname</code></td>
<td>
<p>Output file name.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_site">site</code></td>
<td>
<p>NEON 4-letter site code.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_lowdf">lowDf</code></td>
<td>
<p>Dataframe corresponding to the &quot;low&quot; reference water.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_meddf">medDf</code></td>
<td>
<p>Data frame corresponding to the &quot;med&quot; reference water.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_highdf">highDf</code></td>
<td>
<p>Data frame corresponding to the &quot;high&quot; reference water.</p>
</td></tr>
<tr><td><code id="write_water_reference_data_+3A_caldf">calDf</code></td>
<td>
<p>Calibration data frame -
this is the output from fit_water_regression</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing to the environment, but writes calibrated
reference data to hdf5 file.
</p>


<h3>Author(s)</h3>

<p>Rich Fiorella <a href="mailto:rfiorella@lanl.gov">rfiorella@lanl.gov</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
