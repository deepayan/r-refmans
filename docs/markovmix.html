<!DOCTYPE html><html><head><title>Help for package markovmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {markovmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#markovmix-package'><p>markovmix package</p></a></li>
<li><a href='#Extract.MarkovMix'><p>Extract or replace components of MarkovMix object</p></a></li>
<li><a href='#fit_markov_mix'><p>Fit mixture of Markov chains</p></a></li>
<li><a href='#get_counts'><p>Get transition pattern counts from MarkovFit object</p></a></li>
<li><a href='#get_order'><p>Get the order of Markov chains</p></a></li>
<li><a href='#get_prior'><p>Get component priors from MarkovFit object</p></a></li>
<li><a href='#get_prob'><p>Get probability matrix from MarkovFit object</p></a></li>
<li><a href='#get_states'><p>Get the states of Markov chains</p></a></li>
<li><a href='#get_states_mat'><p>Get state transition patterns from MarkovFit object</p></a></li>
<li><a href='#markov_mix_ex'><p>Mixture of Markov chain example</p></a></li>
<li><a href='#MarkovMix-class'><p>MarkovMix class</p></a></li>
<li><a href='#predict.MarkovMix'><p>Predict probabilities with MarkovMix object and new sequence list</p></a></li>
<li><a href='#print.MarkovMix'><p>Print MarkovMix object</p></a></li>
<li><a href='#restate'><p>Reorganize states in MarkovMix object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Mixture of Markov Chains with Support of Higher Orders and
Multiple Sequences</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiurui Zhu &lt;zxr6@163.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit mixture of Markov chains of higher orders from multiple
    sequences. It is also compatible with ordinary 1-component, 1-order or
    single-sequence Markov chains. Various utility functions are provided
    to derive transition patterns, transition probabilities per component
    and component priors. In addition, print(), predict() and component
    extracting/replacing methods are also defined as a convention of
    mixture models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.8), forcats (&ge; 1.0.0), pillar (&ge; 1.9.0), purrr
(&ge; 0.3.4), Rcpp, rlang (&ge; 1.1.0), tibble (&ge; 3.1.6), tidyr
(&ge; 1.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bench (&ge; 1.1.2), covr, ggplot2 (&ge; 3.4.2), testthat (&ge;
3.1.7)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'data.R' 'utils.R' 'markov_mix_utils.R'
'markov_mix.R' 'markovmix-package.R'</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhuxr11/markovmix">https://github.com/zhuxr11/markovmix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhuxr11/markovmix/issues">https://github.com/zhuxr11/markovmix/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-02 10:42:13 UTC; Xiurui Zhu</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiurui Zhu [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-02 11:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='markovmix-package'>markovmix package</h2><span id='topic+markovmix-package'></span>

<h3>Description</h3>

<p><code>markovmix</code> package Fit mixture of Markov chains of higher orders from multiple
sequences. It is also compatible with ordinary 1-component, 1-order or
single-sequence Markov chains. Various utility functions are provided
to derive transition patterns, transition probabilities per component
and component priors. In addition, <code><a href="#topic+print.MarkovMix">print</a>()</code>,
<code><a href="#topic+predict.MarkovMix">predict</a>()</code> and <code><a href="#topic+Extract.MarkovMix">component extracting/replacing</a></code>
methods are also defined as a convention of mixture models.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the package.
</p>
</li>
<li><p>0.1.2 Xiurui Zhu - Update package documentation.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>

<hr>
<h2 id='Extract.MarkovMix'>Extract or replace components of MarkovMix object</h2><span id='topic+Extract.MarkovMix'></span><span id='topic++5B.MarkovMix'></span><span id='topic++60+5B.MarkovMix+60'></span><span id='topic++5B+3C-.MarkovMix'></span><span id='topic++60+5B+3C-.MarkovMix+60'></span>

<h3>Description</h3>

<p>Operators to extract or replace components of a <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MarkovMix'
x[i]

## S3 replacement method for class 'MarkovMix'
x[i] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract.MarkovMix_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="Extract.MarkovMix_+3A_i">i</code></td>
<td>
<p>Indices specifying components to extract or replace.</p>
</td></tr>
<tr><td><code id="Extract.MarkovMix_+3A_value">value</code></td>
<td>
<p>Numeric matrix as soft counts for transition patterns (like <code>get_counts(object = x)</code>),
whose rows correspond to the rows in <code>get_states_mat(x)</code>
and columns correspond to the number of components to replace.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.1 Xiurui Zhu - Initiate the functions.
</p>
</li>
<li><p>0.1.2 Xiurui Zhu - Update function documentation.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='fit_markov_mix'>Fit mixture of Markov chains</h2><span id='topic+fit_markov_mix'></span>

<h3>Description</h3>

<p><code>fit_markov_mix</code> fits mixture of Markov chains. It supports high-order Markov chains,
multiple sequences and mixture components with cluster probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_markov_mix(
  seq_list,
  order. = 1L,
  states = NULL,
  clusters = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_markov_mix_+3A_seq_list">seq_list</code></td>
<td>
<p>Sequence list containing vectors of the same class.</p>
</td></tr>
<tr><td><code id="fit_markov_mix_+3A_order.">order.</code></td>
<td>
<p>Integer (1L) indicating the order of the Markov chain.</p>
</td></tr>
<tr><td><code id="fit_markov_mix_+3A_states">states</code></td>
<td>
<p><code>NULL</code> or vector indicating the states in the Markov chain.
If <code>NULL</code>, states are inferred from unique non-NA elements in all the sequences.
If vector, it should match the class of the sequences. NA elements in the vector are removed.</p>
</td></tr>
<tr><td><code id="fit_markov_mix_+3A_clusters">clusters</code></td>
<td>
<p><code>NULL</code> or matrix containing clustering probabilities.
If <code>NULL</code>, Markov chain is fit without mixture components.
If matrix, rows are probabilities of sequences and columns are components.
As probabilities of sequences, rows are normalized to sum up to 1.</p>
</td></tr>
<tr><td><code id="fit_markov_mix_+3A_verbose">verbose</code></td>
<td>
<p>Logical (1L) indicating whether additional messages should be printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MarkovMix">MarkovMix</a></code>.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a list of integer sequences of different lengths with 4 states
test_states &lt;- seq_len(4L)
test_maxlen &lt;- 10L
set.seed(1111L)
test_seq &lt;- purrr::map(
  seq_len(100L),
  ~ sample(test_states, sample.int(test_maxlen, 1L), replace = TRUE)
)

# Fit a 1-order Markov chain
markov_fit &lt;- fit_markov_mix(
  seq_list = test_seq,
  order. = 1L,
  states = test_states
)
print(markov_fit)

# Fit a mixture of 2-order Markov chain with 3 components
test_n_comp &lt;- 3L
test_clusters &lt;- matrix(
  runif(length(test_seq) * test_n_comp),
  nrow = length(test_seq),
  ncol = test_n_comp
)
markov_mix_fit &lt;- fit_markov_mix(
  seq_list = test_seq,
  order. = 2L,
  states = test_states,
  clusters = test_clusters
)
print(markov_mix_fit)
</code></pre>

<hr>
<h2 id='get_counts'>Get transition pattern counts from MarkovFit object</h2><span id='topic+get_counts'></span>

<h3>Description</h3>

<p><code>get_counts</code> gets transition pattern counts from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_counts(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_counts_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_counts_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix indicates transition pattern (soft) counts,
where each row corresponds to a transition pattern and each column
corresponds to a component.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.2 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='get_order'>Get the order of Markov chains</h2><span id='topic+get_order'></span>

<h3>Description</h3>

<p><code>get_order</code> gets the order of Markov chains from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_order(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_order_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_order_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer as the order of Markov chains.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.2 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='get_prior'>Get component priors from MarkovFit object</h2><span id='topic+get_prior'></span>

<h3>Description</h3>

<p><code>get_prior</code> gets component priors from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object,
normalized to sum up to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prior(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_prior_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_prior_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector indicates component priors.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='get_prob'>Get probability matrix from MarkovFit object</h2><span id='topic+get_prob'></span>

<h3>Description</h3>

<p><code>get_prob</code> gets probability matrix from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
It normalizes each column in the count matrix to sum up to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prob(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_prob_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_prob_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix indicating probabilities of each state transition pattern in each component.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='get_states'>Get the states of Markov chains</h2><span id='topic+get_states'></span>

<h3>Description</h3>

<p><code>get_states</code> gets the states of Markov chains from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_states(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_states_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_states_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector as the states used in Markov chains.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.2 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='get_states_mat'>Get state transition patterns from MarkovFit object</h2><span id='topic+get_states_mat'></span>

<h3>Description</h3>

<p><code>get_states_mat</code> gets state transition patterns from <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
The number of columns is the order of the (mixture of) Markov chain(s) plus 1 (the destination state).
Each column is arranged in the ascending order of the states.
The last column serves as the destination state and iterates the fastest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_states_mat(object, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_states_mat_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="get_states_mat_+3A_check">check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix indicating the state transition patterns.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>,
<code><a href="#topic+restate">restate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Derive transition pattern soft counts
get_counts(object = markov_mix_ex)

# Derive the order of Markov chains
get_order(object = markov_mix_ex)

# Derive the states of Markov chains
get_states(object = markov_mix_ex)

# Derive state transition patterns
get_states_mat(markov_mix_ex)

# Derive probability matrices
get_prob(markov_mix_ex)

# Derive component priors
get_prior(markov_mix_ex)

# Combine state transition patterns and their probabilities
cbind(
  as.data.frame(get_states_mat(markov_mix_ex)),
  as.data.frame(get_prob(markov_mix_ex))
)

# Extract 1 or more components
markov_mix_ex[2L]
markov_mix_ex[c(1L, 3L)]

# Replace 1 or more components
nrow_value &lt;- length(get_states(object = markov_mix_ex, check = FALSE))^
  (get_order(object = markov_mix_ex, check = FALSE) + 1L)
markov_mix_ex2 &lt;- markov_mix_ex
markov_mix_ex2[2L] &lt;- runif(nrow_value)
print(markov_mix_ex2)
markov_mix_ex3 &lt;- markov_mix_ex
markov_mix_ex3[c(1L, 3L)] &lt;- matrix(runif(nrow_value * 2L), ncol = 2L)
print(markov_mix_ex3)
</code></pre>

<hr>
<h2 id='markov_mix_ex'>Mixture of Markov chain example</h2><span id='topic+markov_mix_ex'></span>

<h3>Description</h3>

<p>A mixture of 2-order Markov chain fit from 100 random sequences
with 4 states
(A, B, C, D)
and 3 components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>markov_mix_ex
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+MarkovMix">MarkovMix</a></code> object.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the dataset.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>

<hr>
<h2 id='MarkovMix-class'>MarkovMix class</h2><span id='topic+MarkovMix-class'></span><span id='topic+MarkovMix'></span>

<h3>Description</h3>

<p>An object of class <code>MarkovMix</code> is a list containing the following components:
</p>

<dl>
<dt>counts</dt><dd><p>Numeric matrix containing soft counts of sub-sequence patterns in each component.
For (non-mixture) Markov chains, the matrix contains only 1 column and counts are actually integers,
but they are still stored as numeric values.</p>
</dd>
<dt>order</dt><dd><p>Integer (1L) as the order of (mixture) Markov chain(s).</p>
</dd>
<dt>states</dt><dd><p>Vector as the states in the (mixture) Markov chain(s).</p>
</dd>
</dl>



<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the class.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>

<hr>
<h2 id='predict.MarkovMix'>Predict probabilities with MarkovMix object and new sequence list</h2><span id='topic+predict.MarkovMix'></span>

<h3>Description</h3>

<p><code>predict.MarkovMix</code> predicts probabilities with <code><a href="#topic+MarkovMix">MarkovMix</a></code> object
and new sequence list. NA values are returned for sequences with no valid sub-sequences
to distinguish them from those that are truly not observed (probabilities = 0)
in the transition matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MarkovMix'
predict(object, newdata, aggregate. = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.MarkovMix_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="predict.MarkovMix_+3A_newdata">newdata</code></td>
<td>
<p>Sequence list containing vectors of the same class.</p>
</td></tr>
<tr><td><code id="predict.MarkovMix_+3A_aggregate.">aggregate.</code></td>
<td>
<p>Logical (1L) indicating whether probabilities
from each component should be weighted mean by component priors
(<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="predict.MarkovMix_+3A_...">...</code></td>
<td>
<p>Currently ignored for this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>aggregate. = TRUE</code>, a numeric vector of probabilities.
For <code>aggregate. = TRUE</code>, a numeric matrix of probabilities
from each component.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix methods: 
<code><a href="#topic+print.MarkovMix">print.MarkovMix</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Generate a new list of sequences
set.seed(2222L)
new_maxlen &lt;- 8L
new_seq_list &lt;- purrr::map(
  seq_len(50L),
  ~ sample(get_states(object = markov_mix_ex, check = FALSE),
           sample.int(new_maxlen, 1L),
           replace = TRUE)
)

# Predict the probabilities of sequences
predict(markov_mix_ex, newdata = new_seq_list)

# Predict the probabilities of sequences from each component
predict(markov_mix_ex, newdata = new_seq_list, aggregate. = FALSE)
</code></pre>

<hr>
<h2 id='print.MarkovMix'>Print MarkovMix object</h2><span id='topic+print.MarkovMix'></span>

<h3>Description</h3>

<p><code>print.MarkovMix</code> prints <code><a href="#topic+MarkovMix">MarkovMix</a></code> object in a user-friendly form,
including component priors and transition matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MarkovMix'
print(x, sep = "-&gt;", print_max = 20L, print_min = 10L, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.MarkovMix_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="print.MarkovMix_+3A_sep">sep</code></td>
<td>
<p>Character (1L) used as separator between states in the row names of transition matrix.</p>
</td></tr>
<tr><td><code id="print.MarkovMix_+3A_print_max">print_max</code>, <code id="print.MarkovMix_+3A_print_min">print_min</code></td>
<td>
<p>Integers as the numbers of rows to print each transition matrix.
See <code><a href="pillar.html#topic+pillar_options">pillar_options</a></code> for details.</p>
</td></tr>
<tr><td><code id="print.MarkovMix_+3A_...">...</code></td>
<td>
<p>Currently ignored for this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Input <code>x</code>, invisibly.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix methods: 
<code><a href="#topic+predict.MarkovMix">predict.MarkovMix</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a list of integer sequences of different lengths with 4 states
test_states &lt;- seq_len(4L)
test_maxlen &lt;- 10L
set.seed(1111L)
test_seq &lt;- purrr::map(
  seq_len(100L),
  ~ sample(test_states, sample.int(test_maxlen, 1L), replace = TRUE)
)

# Fit a 1-order Markov chain
markov_fit &lt;- fit_markov_mix(
  seq_list = test_seq,
  order. = 1L,
  states = test_states
)
print(markov_fit)

# Fit a mixture of 2-order Markov chain with 3 components
test_n_comp &lt;- 3L
test_clusters &lt;- matrix(
  runif(length(test_seq) * test_n_comp),
  nrow = length(test_seq),
  ncol = test_n_comp
)
markov_mix_fit &lt;- fit_markov_mix(
  seq_list = test_seq,
  order. = 2L,
  states = test_states,
  clusters = test_clusters
)
print(markov_mix_fit)
</code></pre>

<hr>
<h2 id='restate'>Reorganize states in MarkovMix object</h2><span id='topic+restate'></span>

<h3>Description</h3>

<p><code>restate</code> reorganizes states in <code><a href="#topic+MarkovMix">MarkovMix</a></code> object with a function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restate(.object, .fun, .check = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restate_+3A_.object">.object</code></td>
<td>
<p><code><a href="#topic+MarkovMix">MarkovMix</a></code> object.</p>
</td></tr>
<tr><td><code id="restate_+3A_.fun">.fun</code></td>
<td>
<p>Function to process each column in state transition patterns as factors,
such as those in <code><a href="forcats.html#topic+forcats-package">forcats</a></code> package.</p>
</td></tr>
<tr><td><code id="restate_+3A_.check">.check</code></td>
<td>
<p>Logical (1L) indicating whether to check <code>object</code>
at the beginning.</p>
</td></tr>
<tr><td><code id="restate_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to <code>.fun</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+MarkovMix">MarkovMix</a></code> object with modified states and count matrix.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Xiurui Zhu
</p>


<h3>See Also</h3>

<p>Other MarkovMix utilities: 
<code><a href="#topic+Extract.MarkovMix">Extract.MarkovMix</a></code>,
<code><a href="#topic+get_counts">get_counts</a>()</code>,
<code><a href="#topic+get_order">get_order</a>()</code>,
<code><a href="#topic+get_prior">get_prior</a>()</code>,
<code><a href="#topic+get_prob">get_prob</a>()</code>,
<code><a href="#topic+get_states_mat">get_states_mat</a>()</code>,
<code><a href="#topic+get_states">get_states</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example MarkovMix object
data("markov_mix_ex")

# Reverse states (using function)
markov_mix_new1 &lt;- restate(
  .object = markov_mix_ex,
  .fun = forcats::fct_rev
)
print(markov_mix_new1)

# Reorder states by hand (using function name with additional arguments)
markov_mix_new2 &lt;- restate(
  .object = markov_mix_ex,
  .fun = "levels&lt;-",
  value = c("B", "D", "C", "A")
)
print(markov_mix_new2)

# Merge state D into C (using purrr-style lambda function)
markov_mix_new3 &lt;- restate(
  .object = markov_mix_ex,
  .fun = ~ forcats::fct_recode(.x, "C" = "D")
)
print(markov_mix_new3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
