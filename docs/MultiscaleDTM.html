<!DOCTYPE html><html><head><title>Help for package MultiscaleDTM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiscaleDTM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AdjSD'><p>Calculates standard deviation of bathymetry (a measure of rugosity) adjusted for slope</p></a></li>
<li><a href='#annulus_window'><p>Creates annulus focal window</p></a></li>
<li><a href='#BPI'><p>Calculates Bathymetric Position Index</p></a></li>
<li><a href='#circle_window'><p>Creates circular focal window</p></a></li>
<li><a href='#classify_features_ff'><p>Helper function factory to classify morphometric features</p></a></li>
<li><a href='#DMV'><p>Calculates Difference from Mean Value (DMV)</p></a></li>
<li><a href='#erupt'><p>Create georeferenced version of R's built in volcano dataset</p></a></li>
<li><a href='#explore_terrain'><p>Interactive Shiny app to look at terrain attributes</p></a></li>
<li><a href='#kmax'><p>Calculate max curvature</p></a></li>
<li><a href='#kmean'><p>Calculate mean curvature</p></a></li>
<li><a href='#kmin'><p>Calculate min curvature</p></a></li>
<li><a href='#knc'><p>Calculate normal contour curvature</p></a></li>
<li><a href='#kns'><p>Calculate normal slope line curvature</p></a></li>
<li><a href='#ku'><p>Calculate unsphericity curvature</p></a></li>
<li><a href='#outlier_filter'><p>Helper function to filter outliers from regression parameters using interquartile range</p></a></li>
<li><a href='#Qfit'><p>Calculates multiscale slope, aspect, curvature, and morphometric features using a local quadratic fit</p></a></li>
<li><a href='#RelPos'><p>Calculates Relative Position of a focal cell</p></a></li>
<li><a href='#RIE'><p>Calculates Roughness Index-Elevation</p></a></li>
<li><a href='#SAPA'><p>Calculates surface area to planar area rugosity</p></a></li>
<li><a href='#SlpAsp'><p>Multiscale Slope and Aspect</p></a></li>
<li><a href='#SurfaceArea'><p>Calculates surface area of a DTM</p></a></li>
<li><a href='#tgc'><p>Calculate contour geodesic torsion</p></a></li>
<li><a href='#TPI'><p>Calculates Topographic Position Index</p></a></li>
<li><a href='#VRM'><p>Implementation of the Sappington et al., (2007) vector ruggedness measure</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Multi-Scale Geomorphometric Terrain Attributes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates multi-scale geomorphometric terrain attributes from regularly gridded digital terrain models using a variable focal windows size (Ilich et al. (2023) &lt;<a href="https://doi.org/10.1111%2Ftgis.13067">doi:10.1111/tgis.13067</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ailich/MultiscaleDTM/issues">https://github.com/ailich/MultiscaleDTM/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>terra (&ge; 1.7.46)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, raster, dplyr, shiny, rgl, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, tmap, colorRamps, cowplot, magick</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ailich.github.io/MultiscaleDTM/">https://ailich.github.io/MultiscaleDTM/</a>,
<a href="https://github.com/ailich/MultiscaleDTM">https://github.com/ailich/MultiscaleDTM</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 20:34:28 UTC; socce</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Ilich <a href="https://orcid.org/0000-0003-1758-8499"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Vincent Lecours [aut],
  Benjamin Misiuk [aut],
  Steven Murawski [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Ilich &lt;ailich@usf.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-22 21:02:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='AdjSD'>Calculates standard deviation of bathymetry (a measure of rugosity) adjusted for slope</h2><span id='topic+AdjSD'></span>

<h3>Description</h3>

<p>Calculates standard deviation of bathymetry (a measure of rugosity). Using a sliding rectangular window a plane is fit to the data and the standard deviation of the residuals is calculated (Ilich et al., 2023)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AdjSD(
  r,
  w = c(3, 3),
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AdjSD_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer in a projected coordinate system where map units match elevation/depth units</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_w">w</code></td>
<td>
<p>A vector of length 2 specifying the dimensions of the rectangular window to use where the first number is the number of rows and the second number is the number of columns. Window size must be an odd number.</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical indicating whether or not to remove NA values before calculations</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_include_scale">include_scale</code></td>
<td>
<p>logical indicating whether to append window size to the layer names (default = FALSE)</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_filename">filename</code></td>
<td>
<p>character Output filename.</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="AdjSD_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a SpatRaster or RasterLayer of adjusted rugosity
</p>


<h3>References</h3>

<p>Ilich, A. R., Misiuk, B., Lecours, V., &amp; Murawski, S. A. (2023). MultiscaleDTM: An open-source R package for multiscale geomorphometric analysis. Transactions in GIS, 27(4). https://doi.org/10.1111/tgis.13067
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
adjsd&lt;- AdjSD(r, w=c(5,5), na.rm = TRUE)
plot(adjsd)
</code></pre>

<hr>
<h2 id='annulus_window'>Creates annulus focal window</h2><span id='topic+annulus_window'></span>

<h3>Description</h3>

<p>Creates annulus focal window around central pixel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annulus_window(radius, unit, resolution)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annulus_window_+3A_radius">radius</code></td>
<td>
<p>radius of inner annulus c(inner,outer). Inner radius must be less than or equal to outer radius.</p>
</td></tr>
<tr><td><code id="annulus_window_+3A_unit">unit</code></td>
<td>
<p>unit for radius. Either &quot;cell&quot; (number of cells, the default) or &quot;map&quot; for map units (e.g. meters).</p>
</td></tr>
<tr><td><code id="annulus_window_+3A_resolution">resolution</code></td>
<td>
<p>resolution of intended raster layer (one number or a vector of length 2). Only necessary if unit= &quot;map&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of 1's and NA's showing which cells to include and exclude respectively in focal calculations. It also contains attributes attributes 'unit', 'scale', and 'shape'.
</p>

<hr>
<h2 id='BPI'>Calculates Bathymetric Position Index</h2><span id='topic+BPI'></span>

<h3>Description</h3>

<p>Calculates Bathymetric Position Index (BPI). BPI is a measure of relative position that calculates the difference between the value of the focal cell and the mean of cells contained within an annulus shaped neighborhood. Positive values indicate local highs (i.e. peaks) and negative values indicate local lows (i.e. depressions). BPI can be expressed in units of the input DTM raster or can standardized relative to the local topography by dividing by the standard deviation or range of included elevation values in the focal window. BPI calls the function RelPos internally which serves as a general purpose and more flexible function for calculating relative position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BPI(
  r,
  w,
  stand = "none",
  unit = "cell",
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BPI_+3A_r">r</code></td>
<td>
<p>r DTM as a SpatRaster or RasterLayer.</p>
</td></tr>
<tr><td><code id="BPI_+3A_w">w</code></td>
<td>
<p>Vector of length 2 specifying c(inner, outer) radii of the annulus in &quot;cell&quot; or &quot;map&quot; units or a focal weights matrix created by MultiscaleDTM::annulus_window. Inner radius must be less than or equal to outer radius. There is no default size.</p>
</td></tr>
<tr><td><code id="BPI_+3A_stand">stand</code></td>
<td>
<p>Standardization method. Either &quot;none&quot; (the default), &quot;range&quot; or &quot;sd&quot; indicating whether the relative position should be standardized by dividing by the standard deviation or range of included values in the focal window. If stand is 'none' the layer name will be &quot;bpi&quot;, otherwise it will be &quot;sbpi&quot; to indicate that the layer has been standardized.</p>
</td></tr>
<tr><td><code id="BPI_+3A_unit">unit</code></td>
<td>
<p>Unit for w if it is a vector (default is unit=&quot;cell&quot;). If w is a matrix, unit is ignored and extracted directly from w.</p>
</td></tr>
<tr><td><code id="BPI_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations.</p>
</td></tr>
<tr><td><code id="BPI_+3A_include_scale">include_scale</code></td>
<td>
<p>Logical indicating whether to append window size to the layer names (default = FALSE) or a character vector specifying the name you would like to append or a number specifying the number of significant digits. If include_scale = TRUE the appended scale will be the inner and outer radius. If unit=&quot;map&quot; then window size will have &quot;MU&quot; after the number indicating that the number represents the scale in map units (note units can be extracted from w created with MultiscaleDTM::circle_window and MultiscaleDTM::annulus_window).</p>
</td></tr>
<tr><td><code id="BPI_+3A_filename">filename</code></td>
<td>
<p>Character output filename.</p>
</td></tr>
<tr><td><code id="BPI_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="BPI_+3A_wopt">wopt</code></td>
<td>
<p>List with named options for writing files as in writeRaster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SpatRaster or RasterLayer.
</p>


<h3>References</h3>

<p>Lundblad, E.R., Wright, D.J., Miller, J., Larkin, E.M., Rinehart, R., Naar, D.F., Donahue, B.T., Anderson, S.M., Battista, T., 2006. A benthic terrain classification scheme for American Samoa. Marine Geodesy 29, 89–111. https://doi.org/10.1080/01490410600738021
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
bpi&lt;- BPI(r, w = c(2,4), stand= "none", unit = "cell", na.rm = TRUE)
plot(bpi)
</code></pre>

<hr>
<h2 id='circle_window'>Creates circular focal window</h2><span id='topic+circle_window'></span>

<h3>Description</h3>

<p>Creates circular focal window around central pixel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circle_window(radius, unit, resolution, return_dismat = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circle_window_+3A_radius">radius</code></td>
<td>
<p>radius of circular window</p>
</td></tr>
<tr><td><code id="circle_window_+3A_unit">unit</code></td>
<td>
<p>unit for radius. Either &quot;cell&quot; (number of cells) or &quot;map&quot; for map units (e.g. meters).</p>
</td></tr>
<tr><td><code id="circle_window_+3A_resolution">resolution</code></td>
<td>
<p>resolution of intended raster layer (one number or a vector of length 2). Only necessary if unit= &quot;map&quot;</p>
</td></tr>
<tr><td><code id="circle_window_+3A_return_dismat">return_dismat</code></td>
<td>
<p>logical, if TRUE return a matrix of distances from focal cell instead of a matrix to pass to terra::focal.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of 1's and NA's showing which cells to include and exclude respectively in focal calculations, or if return_dismat=TRUE, a matrix indicating the distance from the focal cell. It also contains attributes attributes 'unit', 'scale', and 'shape' if return_dismat=FALSE, and if return_dismat=TRUE the attribute 'unit'.
</p>

<hr>
<h2 id='classify_features_ff'>Helper function factory to classify morphometric features</h2><span id='topic+classify_features_ff'></span>

<h3>Description</h3>

<p>Helper function factory to classify morphometric features according to a modified version of Wood 1996 page 120
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classify_features_ff(slope_tolerance = 1, curvature_tolerance = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classify_features_ff_+3A_slope_tolerance">slope_tolerance</code></td>
<td>
<p>Slope tolerance that defines a 'flat' surface (degrees; default is 1.0). Relevant for the features layer.</p>
</td></tr>
<tr><td><code id="classify_features_ff_+3A_curvature_tolerance">curvature_tolerance</code></td>
<td>
<p>Curvature tolerance that defines 'planar' surface (default is 0.0001). Relevant for the features layer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that can be passed to raster::overlay to classify morphometric features
</p>


<h3>References</h3>

<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>

<hr>
<h2 id='DMV'>Calculates Difference from Mean Value (DMV)</h2><span id='topic+DMV'></span>

<h3>Description</h3>

<p>Calculates Difference from Mean Value (DMV). DMV is a measure of relative position that calculates the difference between the value of the focal cell and the mean of all cells in a rectangular or circular neighborhood. Positive values indicate local highs (i.e. peaks) and negative values indicate local lows (i.e. depressions). DMV can be expressed in units of the input DTM raster or can standardized relative to the local topography by dividing by the standard deviation or range of elevation values in the focal window. DMV calls the function RelPos internally which serves as a general purpose and more flexible function for calculating relative position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DMV(
  r,
  w = dplyr::case_when(tolower(shape) == "rectangle" ~ 3, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "cell") ~ 1, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "map") ~ max(terra::res(r))),
  shape = "rectangle",
  stand = "none",
  unit = "cell",
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DMV_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer.</p>
</td></tr>
<tr><td><code id="DMV_+3A_w">w</code></td>
<td>
<p>For a &quot;rectangle&quot; focal window, a vector of length 2 containing odd numbers specifying dimensions where the first number is the number of rows and the second is the number of columns (or a single number if the number of rows and columns is equal). For a &quot;circle&quot; shaped focal window, a single integer representing the radius in &quot;cell&quot; or &quot;map&quot; units or a focal weights matrix created by MultiscaleDTM::circle_window.</p>
</td></tr>
<tr><td><code id="DMV_+3A_shape">shape</code></td>
<td>
<p>Character representing the shape of the focal window. Either &quot;rectangle&quot; (default) or &quot;circle&quot;.</p>
</td></tr>
<tr><td><code id="DMV_+3A_stand">stand</code></td>
<td>
<p>Standardization method. Either &quot;none&quot; (the default), &quot;range&quot; or &quot;sd&quot; indicating whether the TPI should be standardized by dividing by the standard deviation or range of included values in the focal window. If stand is 'none' the layer name will be &quot;dmv&quot;, otherwise it will be &quot;sdmv&quot; to indicate that the layer has been standardized.</p>
</td></tr>
<tr><td><code id="DMV_+3A_unit">unit</code></td>
<td>
<p>Unit for w if shape is 'circle' and it is a vector (default is unit=&quot;cell&quot;). For circular windows specified with a matrix, unit is ignored and extracted directly from w. For rectangular and custom focal windows set unit='cell' or set unit to NA/NULL.</p>
</td></tr>
<tr><td><code id="DMV_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations.</p>
</td></tr>
<tr><td><code id="DMV_+3A_include_scale">include_scale</code></td>
<td>
<p>Logical indicating whether to append window size to the layer names (default = FALSE) or a character vector specifying the name you would like to append or a number specifying the number of significant digits. If include_scale = TRUE the number of rows and number of columns will be appended for rectangular windows. For circular windows it will be a single number representing the radius. If unit=&quot;map&quot; then window size will have &quot;MU&quot; after the number indicating that the number represents the scale in map units (note units can be extracted from w created with MultiscaleDTM::circle_window).</p>
</td></tr>
<tr><td><code id="DMV_+3A_filename">filename</code></td>
<td>
<p>Character output filename.</p>
</td></tr>
<tr><td><code id="DMV_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="DMV_+3A_wopt">wopt</code></td>
<td>
<p>List with named options for writing files as in writeRaster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a SpatRaster or RasterLayer.
</p>


<h3>References</h3>

<p>Lecours, V., Devillers, R., Simms, A.E., Lucieer, V.L., Brown, C.J., 2017. Towards a Framework for Terrain Attribute Selection in Environmental Studies. Environmental Modelling &amp; Software 89, 19-30. https://doi.org/10.1016/j.envsoft.2016.11.027
Wilson, J.P., Gallant, J.C. (Eds.), 2000. Terrain Analysis: Principles and Applications. John Wiley &amp; Sons, Inc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
dmv&lt;- DMV(r, w=c(5,5), shape= "rectangle", stand="range", na.rm = TRUE)
plot(dmv)
</code></pre>

<hr>
<h2 id='erupt'>Create georeferenced version of R's built in volcano dataset</h2><span id='topic+erupt'></span>

<h3>Description</h3>

<p>Create georeferenced version of R's built in volcano dataset. Useful dataset for generating quick examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>erupt()
</code></pre>


<h3>Value</h3>

<p>SpatRaster
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- erupt()
</code></pre>

<hr>
<h2 id='explore_terrain'>Interactive Shiny app to look at terrain attributes</h2><span id='topic+explore_terrain'></span>

<h3>Description</h3>

<p>Interactive Shiny app to look at terrain attributes based on a surface fit using a Wood/Evans Quadratic Equation: Z =ax^2+by^2+cxy+dx+ey(+f)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_terrain()
</code></pre>


<h3>Value</h3>

<p>No return value, launches Shiny app.
</p>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='kmax'>Calculate max curvature</h2><span id='topic+kmax'></span>

<h3>Description</h3>

<p>Calculate max curvature, kmax, from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmax(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmax_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmax_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmax_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmax_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmax_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='kmean'>Calculate mean curvature</h2><span id='topic+kmean'></span>

<h3>Description</h3>

<p>Calculate mean curvature, kmean, from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmean(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmean_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmean_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmean_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmean_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmean_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='kmin'>Calculate min curvature</h2><span id='topic+kmin'></span>

<h3>Description</h3>

<p>Calculate min curvature, kmin, from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmin(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kmin_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmin_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmin_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmin_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kmin_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='knc'>Calculate normal contour curvature</h2><span id='topic+knc'></span>

<h3>Description</h3>

<p>Calculate normal contour curvature (kn)c, which is the principal representative of the plan curvature group based on regression coefficients from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knc(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knc_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="knc_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="knc_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="knc_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="knc_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='kns'>Calculate normal slope line curvature</h2><span id='topic+kns'></span>

<h3>Description</h3>

<p>Calculate normal slope line curvature (kn)s, which is the principal representative of the profile curvature group based on regression coefficients from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kns(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kns_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kns_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kns_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kns_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="kns_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='ku'>Calculate unsphericity curvature</h2><span id='topic+ku'></span>

<h3>Description</h3>

<p>Calculate  unsphericity curvature, ku, from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ku(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ku_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="ku_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="ku_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="ku_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="ku_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='outlier_filter'>Helper function to filter outliers from regression parameters using interquartile range</h2><span id='topic+outlier_filter'></span>

<h3>Description</h3>

<p>Helper function to filter outliers from regression parameters using interquartile range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlier_filter(params, outlier_quantile, wopt = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outlier_filter_+3A_params">params</code></td>
<td>
<p>regression parameters for fitted surface</p>
</td></tr>
<tr><td><code id="outlier_filter_+3A_outlier_quantile">outlier_quantile</code></td>
<td>
<p>A numeric vector of length two or three. If two numbers are used it specifies the lower (Q1) and upper (Q2) quantiles used for determining the interquantile range (IQR). These values should be between 0 and 1 with Q2 &gt; Q1. An optional third number can be used to specify a the size of a regular sample to be taken which can be useful if the full dataset is too large to fit in memory. Values are considered outliers if they are less than Q1-(100<em>IQR) or greater than Q2+(100</em>IQR), where IQR=Q2-Q1.</p>
</td></tr>
<tr><td><code id="outlier_filter_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>

<hr>
<h2 id='Qfit'>Calculates multiscale slope, aspect, curvature, and morphometric features using a local quadratic fit</h2><span id='topic+Qfit'></span>

<h3>Description</h3>

<p>Calculates multiscale slope, aspect, curvature, and morphometric features of a DTM over a sliding rectangular window using a local quadratic fit to the surface (Evans, 1980; Wood, 1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qfit(
  r,
  w = c(3, 3),
  unit = "degrees",
  metrics = c("elev", "qslope", "qaspect", "qeastness", "qnorthness", "profc", "planc",
    "twistc", "meanc", "maxc", "minc", "features"),
  slope_tolerance = 1,
  curvature_tolerance = 1e-04,
  outlier_quantile = c(0.01, 0.99),
  na.rm = FALSE,
  force_center = FALSE,
  include_scale = FALSE,
  mask_aspect = TRUE,
  return_params = FALSE,
  as_derivs = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qfit_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster (terra) or RasterLayer (raster) in a projected coordinate system where map units match elevation/depth units (up is assumed to be north for calculations of aspect, northness, and eastness).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_w">w</code></td>
<td>
<p>Vector of length 2 specifying the dimensions of the rectangular window to use where the first number is the number of rows and the second number is the number of columns. Window size must be an odd number. Default is 3x3.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_unit">unit</code></td>
<td>
<p>&quot;degrees&quot; or &quot;radians&quot;.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_metrics">metrics</code></td>
<td>
<p>Character vector specifying which terrain attributes to return. The default is to return all available metrics, c(&quot;elev&quot;, &quot;qslope&quot;, &quot;qaspect&quot;, &quot;qeastness&quot;, &quot;qnorthness&quot;, &quot;profc&quot;, &quot;planc&quot;, &quot;twistc&quot;, &quot;meanc&quot;, &quot;maxc&quot;, &quot;minc&quot;, &quot;features&quot;). Slope, aspect, eastness, and northness are preceded with a 'q' to differentiate them from the measures calculated by SlpAsp() where the 'q' indicates that a quadratic surface was used for the calculation. 'elev' is the predicted elevation at the central cell (i.e. the intercept term of the regression) and is only relevant when force_center=FALSE. 'profc' is the profile curvature, 'planc' is the plan curvature, 'meanc' is the mean curvature, 'minc' is minimum curvature, and 'features' are morphometric features. See details.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_slope_tolerance">slope_tolerance</code></td>
<td>
<p>Slope tolerance that defines a 'flat' surface (degrees; default = 1.0). Relevant for the features layer.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_curvature_tolerance">curvature_tolerance</code></td>
<td>
<p>Curvature tolerance that defines 'planar' surface (default = 0.0001). Relevant for the features layer.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_outlier_quantile">outlier_quantile</code></td>
<td>
<p>A numeric vector of length two or three. If two numbers are used it specifies the lower (Q1) and upper (Q2) quantiles used for determining the interquantile range (IQR). These values should be between 0 and 1 with Q2 &gt; Q1. An optional third number can be used to specify a the size of a regular sample to be taken which can be useful if the full dataset is too large to fit in memory. Values are considered outliers and replaced with NA if they are less than Q1-(100<em>IQR) or greater than Q2+(100</em>IQR), where IQR=Q2-Q1. The outlier filter is performed on the results of the regression parameters ('a'-'e' and 'elev') prior to calculation of subsequent terrain attributes. Note that c(0,1) will skip the outlier filtering step and can speed up computations. The default is c(0.01,0.99).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_force_center">force_center</code></td>
<td>
<p>Logical specifying whether the constrain the model through the central cell of the focal window</p>
</td></tr>
<tr><td><code id="Qfit_+3A_include_scale">include_scale</code></td>
<td>
<p>Logical indicating whether to append window size to the layer names (default = FALSE).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_mask_aspect">mask_aspect</code></td>
<td>
<p>Logical. If TRUE (default), aspect will be set to NA and northness and eastness will be set to 0 when slope = 0. If FALSE, aspect is set to 270 degrees or 3<em>pi/2 radians ((-pi/2)- atan2(0,0)+2</em>pi) and northness and eastness will be calculated from this.</p>
</td></tr>
<tr><td><code id="Qfit_+3A_return_params">return_params</code></td>
<td>
<p>Logical indicating whether to return Wood/Evans regression parameters (default = FALSE).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_as_derivs">as_derivs</code></td>
<td>
<p>Logical indicating whether parameters should be formatted as partial derivatives instead of regression coefficients (default = FALSE) (Minár et al., 2020).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_filename">filename</code></td>
<td>
<p>character Output filename. Can be a single filename, or as many filenames as there are layers to write a file for each layer</p>
</td></tr>
<tr><td><code id="Qfit_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="Qfit_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates slope, aspect, eastness, northness, profile curvature, plan curvature, mean curvature, twisting curvature, maximum curvature, minimum curvature, morphometric features, and a smoothed version of the elevation surface using a quadratic surface fit from Z = aX^2+bY^2+cXY+dX+eY+f, where Z is the elevation or depth values, X and Y are the xy coordinates relative to the central cell in the focal window, and a-f are parameters to be estimated (Evans, 1980; Minár et al. 2020; Wood, 1996). For aspect, 0 degrees represents north (or if rotated, the direction that increases as you go up rows in your data) and increases clockwise. For calculations of northness (cos(asp)) and eastness (sin(asp)), up in the y direction is assumed to be north, and if this is not true for your data (e.g. you are using a rotated coordinate system), you must adjust accordingly. All curvature formulas are adapted from Minár et al 2020. Therefore  all curvatures are measured in units of 1/length (e.g. m^-1) except twisting curvature which is measured in radians/length (i.e. change in angle per unit distance), and we adopt a geographic sign convention where convex is positive and concave is negative (i.e., hills are considered convex with positive. Naming convention for curvatures is not consistent across the literature, however Minár et al (2020) has suggested a framework in which the reported measures of curvature translate to profile curvature = (kn)s, plan curvature = (kn)c, twisting curvature (Tg)c, mean curvature = kmean, maximum curvature = kmax, minimum curvature = kmin. For morphometric features cross-sectional curvature (zcc) was replaced by planc (kn)c, z&rdquo;min was replaced by kmax, and z&rdquo;max was replaced by kmin as these are more robust ways to measures the same types of curvature (Minár et al., 2020). Additionally, the planar feature from Wood (1996) was split into planar flat and slope depending on whether the slope threshold is exceeded or not.
</p>


<h3>Value</h3>

<p>a SpatRaster (terra) or RasterStack/RasterLayer (raster)
</p>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>
<p>Wilson, M.F., O’Connell, B., Brown, C., Guinan, J.C., Grehan, A.J., 2007. Multiscale Terrain Analysis of Multibeam Bathymetry Data for Habitat Mapping on the Continental Slope. Marine Geodesy 30, 3-35. https://doi.org/10.1080/01490410701295962
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
qmetrics&lt;- Qfit(r, w = c(5,5), unit = "degrees", na.rm = TRUE)
plot(qmetrics)

# To get only the regression coefficients, set "metrics=c()" and "return_params=TRUE"
reg_coefs&lt;- Qfit(r, w = c(5,5), metrics=c(), unit = "degrees", na.rm = TRUE, return_params=TRUE)
plot(reg_coefs)
</code></pre>

<hr>
<h2 id='RelPos'>Calculates Relative Position of a focal cell</h2><span id='topic+RelPos'></span>

<h3>Description</h3>

<p>Calculates the relative position of a focal cell, which represents whether an area is a local high or low. Relative position is the value of the focal cell minus the value of a reference elevation (often the mean of included values in the focal window but see &quot;fun&quot; argument). Positive values indicate local highs (i.e. peaks) and negative values indicate local lows (i.e. depressions). Relative Position can be expressed in units of the input DTM raster or can standardized relative to the local topography by dividing by the standard deviation or range of included elevation values in the focal window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RelPos(
  r,
  w = dplyr::case_when(tolower(shape) == "rectangle" ~ 3, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "cell") ~ 1, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "map") ~ max(terra::res(r))),
  shape = "rectangle",
  stand = "none",
  exclude_center = FALSE,
  unit = "cell",
  fun = "mean",
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RelPos_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_w">w</code></td>
<td>
<p>For a &quot;rectangle&quot; focal window, a vector of length 2 containing odd numbers specifying dimensions where the first number is the number of rows and the second is the number of columns (or a single number if the number of rows and columns is equal). For a &quot;circle&quot; shaped focal window, a single integer representing the radius in &quot;cell&quot; or &quot;map&quot; units or a focal weights matrix created by MultiscaleDTM::circle_window. The default radius is 1 cell if unit= &quot;cell&quot; or the maximum of the x and y cell resolution if unit=&quot;map&quot;. For an &quot;annulus&quot; shaped focal window, a vector of length 2 specifying c(inner, outer) radii of the annulus in &quot;cell&quot; or &quot;map&quot; units or a focal weights matrix created by MultiscaleDTM::annulus_window. Inner radius must be less than or equal to outer radius. There is no default size for an annulus window. If a &quot;custom&quot; focal window shape is used, w must be a focal weights matrix with 1's for included values and NAs for excluded values.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_shape">shape</code></td>
<td>
<p>Character representing the shape of the focal window. Either &quot;rectangle&quot; (default), &quot;circle&quot;, or &quot;annulus&quot;, or &quot;custom&quot;. If a &quot;custom&quot; shape is used, w must be a focal weights matrix.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_stand">stand</code></td>
<td>
<p>Standardization method. Either &quot;none&quot; (the default), &quot;range&quot; or &quot;sd&quot; indicating whether the relative position should be standardized by dividing by the standard deviation or range of included values in the focal window. If stand is 'none' the layer name will be &quot;rpos&quot;, otherwise it will be &quot;srpos&quot; to indicate that the layer has been standardized.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_exclude_center">exclude_center</code></td>
<td>
<p>Logical indicating whether to exclude the central value from focal calculations (Default=FALSE). Use FALSE for DMV and TRUE for TPI. Note, if a focal weights matrix is supplied to w, setting exclude_center=TRUE will overwrite the center value of w to NA, but setting exclude_center=FALSE will not overwrite the central value to be 1.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_unit">unit</code></td>
<td>
<p>Unit for w if shape is 'circle' or 'annulus' and it is a vector (default is unit=&quot;cell&quot;). For circular and annulus shaped windows specified with a matrix, unit is ignored and extracted directly from w. For rectangular and custom focal windows set unit='cell' or set unit to NA/NULL.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_fun">fun</code></td>
<td>
<p>Function to apply to included values to determine the reference elevation. Accepted values are &quot;mean&quot;,&quot;median&quot;, &quot;min&quot;, and &quot;max&quot;. The default is &quot;mean&quot;</p>
</td></tr>
<tr><td><code id="RelPos_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_include_scale">include_scale</code></td>
<td>
<p>Logical indicating whether to append window size to the layer names (default = FALSE) or a character vector specifying the name you would like to append or a number specifying the number of significant digits. If include_scale = TRUE the number of rows and number of columns will be appended for rectangular or custom windows. For circular windows it will be a single number representing the radius. For annulus windows it will be the inner and outer radius. If unit=&quot;map&quot; then window size will have &quot;MU&quot; after the number indicating that the number represents the scale in map units (note units can be extracted from w created with MultiscaleDTM::circle_window and MultiscaleDTM::annulus_window).</p>
</td></tr>
<tr><td><code id="RelPos_+3A_filename">filename</code></td>
<td>
<p>Character output filename.</p>
</td></tr>
<tr><td><code id="RelPos_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="RelPos_+3A_wopt">wopt</code></td>
<td>
<p>List with named options for writing files as in writeRaster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SpatRaster or RasterLayer.
</p>


<h3>References</h3>

<p>Lecours, V., Devillers, R., Simms, A.E., Lucieer, V.L., Brown, C.J., 2017. Towards a Framework for Terrain Attribute Selection in Environmental Studies. Environmental Modelling &amp; Software 89, 19-30. https://doi.org/10.1016/j.envsoft.2016.11.027
</p>
<p>Lundblad, E.R., Wright, D.J., Miller, J., Larkin, E.M., Rinehart, R., Naar, D.F., Donahue, B.T., Anderson, S.M., Battista, T., 2006. A benthic terrain classification scheme for American Samoa. Marine Geodesy 29, 89–111. https://doi.org/10.1080/01490410600738021
</p>
<p>Weiss, A., 2001. Topographic Position and Landforms Analysis. Presented at the ESRI user conference, San Diego, CA.
</p>
<p>Wilson, J.P., Gallant, J.C. (Eds.), 2000. Terrain Analysis: Principles and Applications. John Wiley &amp; Sons, Inc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
rpos&lt;- RelPos(r, w = c(5,5), shape= "rectangle", exclude_center = TRUE, na.rm = TRUE)
plot(rpos)
</code></pre>

<hr>
<h2 id='RIE'>Calculates Roughness Index-Elevation</h2><span id='topic+RIE'></span>

<h3>Description</h3>

<p>Calculates Roughness Index-Elevation. This is the standard deviation of residual topography in a focal window where residual topography is calculated as the focal pixel minus the focal mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RIE(
  r,
  w = c(3, 3),
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RIE_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer</p>
</td></tr>
<tr><td><code id="RIE_+3A_w">w</code></td>
<td>
<p>A vector of length 2 specifying the dimensions of the rectangular window to use where the first number is the number of rows and the second number is the number of columns. Window size must be an odd number. Default is 3x3.</p>
</td></tr>
<tr><td><code id="RIE_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical indicating whether or not to remove NA values before calculation of SD</p>
</td></tr>
<tr><td><code id="RIE_+3A_include_scale">include_scale</code></td>
<td>
<p>logical indicating whether to append window size to the layer names (default = FALSE)</p>
</td></tr>
<tr><td><code id="RIE_+3A_filename">filename</code></td>
<td>
<p>character Output filename.</p>
</td></tr>
<tr><td><code id="RIE_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="RIE_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note the original paper by Cavalli et al (2008) uses a fixed 5x5 window and uses 25 as the denominator indicating use of the population standard deviation. This implementation provides a flexible window size and istead calculates the sample standard deviation which uses a denominator of n-1.
</p>


<h3>Value</h3>

<p>a SpatRaster or RasterLayer
</p>


<h3>References</h3>

<p>Cavalli, M., Tarolli, P., Marchi, L., Dalla Fontana, G., 2008. The effectiveness of airborne LiDAR data in the recognition of channel-bed morphology. CATENA 73, 249–260. https://doi.org/10.1016/j.catena.2007.11.001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
rie&lt;- RIE(r, w=c(5,5), na.rm = TRUE)
plot(rie)
</code></pre>

<hr>
<h2 id='SAPA'>Calculates surface area to planar area rugosity</h2><span id='topic+SAPA'></span>

<h3>Description</h3>

<p>Calculates surface area (Jenness, 2004) to planar area rugosity and by default corrects planar area for slope using the arc-chord ratio (Du Preez, 2015). Additionally, the method has been modified to allow for calculations at multiple different window sizes (see details and Ilich et al. (2023)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAPA(
  r = NULL,
  w = 1,
  slope_correction = TRUE,
  na.rm = FALSE,
  include_scale = FALSE,
  slope_layer = NULL,
  sa_layer = NULL,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SAPA_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer in a projected coordinate system where map units match elevation/depth units (Not used if both slope_layer and sa_layer are specified).</p>
</td></tr>
<tr><td><code id="SAPA_+3A_w">w</code></td>
<td>
<p>A single number or a vector of length 2 (row, column) specifying the dimensions of the rectangular window over which surface area will be summed. Window size must be an odd number. 1 refers to &quot;native&quot; scale and surface area and planar area will be calculated per cell (the traditional implementation).</p>
</td></tr>
<tr><td><code id="SAPA_+3A_slope_correction">slope_correction</code></td>
<td>
<p>Whether to use the arc-chord ratio to correct planar area for slope (default is TRUE)</p>
</td></tr>
<tr><td><code id="SAPA_+3A_na.rm">na.rm</code></td>
<td>
<p>logical indicating whether to remove/account for NAs in calculations. If FALSE any calculations involving NA will be NA. If TRUE, NA values will be removed and accounted for.</p>
</td></tr>
<tr><td><code id="SAPA_+3A_include_scale">include_scale</code></td>
<td>
<p>logical indicating whether to append window size to the layer names (default = FALSE)</p>
</td></tr>
<tr><td><code id="SAPA_+3A_slope_layer">slope_layer</code></td>
<td>
<p>Optionally specify an appropriate slope layer IN RADIANS to use. If not supplied, it will be calculated using the SlpAsp function based on Misiuk et al (2021). The slope layer should have a window size that is 2 larger than the w specified for SAPA.</p>
</td></tr>
<tr><td><code id="SAPA_+3A_sa_layer">sa_layer</code></td>
<td>
<p>Optionally specify a surface area raster that contains the surface area on a per cell level. This can be calculated with the SurfaceArea function. If calculating SAPA at multiple scales it will be more efficient to supply this so that it does not need to be calculated every time.</p>
</td></tr>
<tr><td><code id="SAPA_+3A_filename">filename</code></td>
<td>
<p>character Output filename.</p>
</td></tr>
<tr><td><code id="SAPA_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="SAPA_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Planar area is calculated as the x_dis * y_dis if uncorrected for slope and (x_dis * y_dis)/cos(slope) if corrected for slope. When w=1, this is called &quot;native&quot; scale and is equivalent to what is presented in Du Preez (2015) and available in the ArcGIS Benthic Terrain Modeller add-on. In this case operations are performed on a per cell basis where x_dis is the resolution of the raster in the x direction (left/right) and y_dis is the resolution of the raster in the y direction (up/down) and slope is calculated using the Horn (1981) method. To expand this to multiple scales of analysis, at w &gt; 1 slope is calculated based on Misiuk et al (2021) which provides a modification of the Horn method to extend the matric to multiple spatial scales. Planar area is calculated the same way as for w=1 except that now x_dis is the x resolution of the raster * the number of columns in the focal window, and y_dis is y resolution of the raster * the number of rows. For w &gt; 1, surface area is calculated as the sum of surface areas within the focal window. Although the (modified) Horn slope is used by default to be consistent with Du Preez (2015), slope calculated using a different algorithm (e.g. Wood 1996) could be supplied using the slope_layer argument. Additionally, a slope raster can be supplied if you have already calculated it and do not wish to recalculate it. However, be careful to supply a slope layer measured in radians and calculated at the relevant scale (2 larger than the w of SAPA).
</p>


<h3>Value</h3>

<p>a SpatRaster or RasterLayer
</p>


<h3>References</h3>

<p>Du Preez, C., 2015. A new arc–chord ratio (ACR) rugosity index for quantifying three-dimensional landscape structural complexity. Landscape Ecol 30, 181–192. https://doi.org/10.1007/s10980-014-0118-8
</p>
<p>Horn, B.K., 1981. Hill Shading and the Reflectance Map. Proceedings of the IEEE 69, 14-47.
</p>
<p>Ilich, A. R., Misiuk, B., Lecours, V., &amp; Murawski, S. A. (2023). MultiscaleDTM: An open-source R package for multiscale geomorphometric analysis. Transactions in GIS, 27(4). https://doi.org/10.1111/tgis.13067
</p>
<p>Jenness, J.S., 2004. Calculating landscape surface area from digital elevation models. Wildlife Society Bulletin 32, 829-839.
</p>
<p>Misiuk, B., Lecours, V., Dolan, M.F.J., Robert, K., 2021. Evaluating the Suitability of Multi-Scale Terrain Attribute Calculation Approaches for Seabed Mapping Applications. Marine Geodesy 44, 327-385. https://doi.org/10.1080/01490419.2021.1925789
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
sapa&lt;- SAPA(r, w=c(5,5), slope_correction = TRUE)
plot(sapa)
</code></pre>

<hr>
<h2 id='SlpAsp'>Multiscale Slope and Aspect</h2><span id='topic+SlpAsp'></span>

<h3>Description</h3>

<p>Calculates multiscale slope and aspect based on the slope.k/aspect.k algorithm from Misiuk et al (2021) which extends classical formulations of slope restricted to a 3x3 window to multiple scales. The code from Misiuk et al (2021) was modified to allow for rectangular rather than only square windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SlpAsp(
  r,
  w = c(3, 3),
  unit = "degrees",
  method = "queen",
  metrics = c("slope", "aspect", "eastness", "northness"),
  na.rm = FALSE,
  include_scale = FALSE,
  mask_aspect = TRUE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SlpAsp_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer in a projected coordinate system where map units match elevation/depth units</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_w">w</code></td>
<td>
<p>A vector of length 2 specifying the dimensions of the rectangular window to use where the first number is the number of rows and the second number is the number of columns. Window size must be an odd number.</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_unit">unit</code></td>
<td>
<p>&quot;degrees&quot; or &quot;radians&quot;</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_method">method</code></td>
<td>
<p>&quot;queen&quot; or &quot;rook&quot;, indicating how many neighboring cells to use to compute slope for any cell. queen uses 8 neighbors (up, down, left, right, and diagonals) and rook uses 4 (up, down, left, right). Alternatively, instead of &quot;queen&quot; or &quot;rook&quot;, method can be specified as 8 and 4 respectively.</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_metrics">metrics</code></td>
<td>
<p>a character string or vector of character strings of which terrain attributes to return. Default is to return all available attributes which are c(&quot;slope&quot;, &quot;aspect&quot;, &quot;eastness&quot;, &quot;northness&quot;).</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations. Only applicable if method is &quot;queen&quot; or &quot;8&quot;.</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_include_scale">include_scale</code></td>
<td>
<p>logical indicating whether to append window size to the layer names (default = FALSE)</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_mask_aspect">mask_aspect</code></td>
<td>
<p>A logical. When mask_aspect is TRUE (the default), if slope evaluates to 0, aspect will be set to NA and both eastness and northness will be set to 0. When mask_aspect is FALSE, when slope is 0 aspect will be pi/2 radians or 90 degrees which is the behavior of raster::terrain, and northness and eastness will be calculated from that.</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_filename">filename</code></td>
<td>
<p>character Output filename. Can be a single filename, or as many filenames as there are layers to write a file for each layer</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="SlpAsp_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When method=&quot;rook&quot;, slope and aspect are computed according to Fleming and Hoffer (1979) and Ritter (1987). When method=&quot;queen&quot;, slope and aspect are computed according to Horn (1981). These are the standard slope algorithms found in many GIS packages but are traditionally restricted to a 3 x 3 window size. Misiuk et al (2021) extended these classical formulations  to multiple window sizes. This function modifies the code from Misiuk et al (2021) to allow for rectangular rather than only square windows and also added aspect.
</p>


<h3>Value</h3>

<p>a SpatRaster or RasterStack of slope and/or aspect (and components of aspect)
</p>


<h3>References</h3>

<p>Fleming, M.D., Hoffer, R.M., 1979. Machine processing of landsat MSS data and DMA topographic data for forest cover type mapping (No. LARS Technical Report 062879). Laboratory for Applications of Remote Sensing, Purdue University, West Lafayette, Indiana.
</p>
<p>Horn, B.K., 1981. Hill Shading and the Reflectance Map. Proceedings of the IEEE 69, 14-47.
</p>
<p>Misiuk, B., Lecours, V., Dolan, M.F.J., Robert, K., 2021. Evaluating the Suitability of Multi-Scale Terrain Attribute Calculation Approaches for Seabed Mapping Applications. Marine Geodesy 44, 327-385. https://doi.org/10.1080/01490419.2021.1925789
</p>
<p>Ritter, P., 1987. A vector-based slope and aspect generation algorithm. Photogrammetric Engineering and Remote Sensing 53, 1109-1111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
slp_asp&lt;- SlpAsp(r = r, w = c(5,5), unit = "degrees", 
method = "queen", metrics = c("slope", "aspect", 
"eastness", "northness"))
plot(slp_asp)
</code></pre>

<hr>
<h2 id='SurfaceArea'>Calculates surface area of a DTM</h2><span id='topic+SurfaceArea'></span>

<h3>Description</h3>

<p>Calculates surface area on a per cell basis of a DTM based on Jenness, 2004.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfaceArea(
  r,
  na.rm = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurfaceArea_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer in a projected coordinate system where map units match elevation/depth units</p>
</td></tr>
<tr><td><code id="SurfaceArea_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether to remove NAs from calculations. When FALSE, the sum of the eight triangles is calculated. When TRUE, the mean of the created triangles is calculated and multiplied by 8 to scale it to the proper area.</p>
</td></tr>
<tr><td><code id="SurfaceArea_+3A_filename">filename</code></td>
<td>
<p>character Output filename.</p>
</td></tr>
<tr><td><code id="SurfaceArea_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="SurfaceArea_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a SpatRaster or RasterLayer
</p>


<h3>References</h3>

<p>Jenness, J.S., 2004. Calculating landscape surface area from digital elevation models. Wildlife Society Bulletin 32, 829-839.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
sa&lt;- SurfaceArea(r)
plot(sa)
</code></pre>

<hr>
<h2 id='tgc'>Calculate contour geodesic torsion</h2><span id='topic+tgc'></span>

<h3>Description</h3>

<p>Calculate contour geodesic torsion (tg)c, which is the principal representative of the twisting curvature group based on regression coefficients from the equation Z =ax^2+by^2+cxy+dx+ey(+f).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgc(a, b, c, d, e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tgc_+3A_a">a</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="tgc_+3A_b">b</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="tgc_+3A_c">c</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="tgc_+3A_d">d</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
<tr><td><code id="tgc_+3A_e">e</code></td>
<td>
<p>regression coefficient</p>
</td></tr>
</table>


<h3>References</h3>

<p>Evans, I.S., 1980. An integrated system of terrain analysis and slope mapping. Zeitschrift f¨ur Geomorphologic Suppl-Bd 36, 274–295.
</p>
<p>Wood, J., 1996. The geomorphological characterisation of digital elevation models (Ph.D.). University of Leicester.
</p>
<p>Minár, J., Evans, I.S., Jenčo, M., 2020. A comprehensive system of definitions of land surface (topographic) curvatures, with implications for their application in geoscience modelling and prediction. Earth-Science Reviews 211, 103414. https://doi.org/10.1016/j.earscirev.2020.103414
</p>

<hr>
<h2 id='TPI'>Calculates Topographic Position Index</h2><span id='topic+TPI'></span>

<h3>Description</h3>

<p>Calculates Topographic Position Index (TPI). TPI is a measure of relative position that calculates the the difference between the value of the focal cell and the mean of mean of the surrounding cells (i.e. local mean but excluding the value of the focal cell).Positive values indicate local highs (i.e. peaks) and negative values indicate local lows (i.e. depressions). TPI can be expressed in units of the input DTM raster or can standardized relative to the local topography by dividing by the standard deviation or range of included elevation  values in the focal window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TPI(
  r,
  w = dplyr::case_when(tolower(shape) == "rectangle" ~ 3, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "cell") ~ 1, tolower(shape) == "circle" &amp;
    isTRUE(tolower(unit) == "map") ~ max(terra::res(r))),
  shape = "rectangle",
  stand = "none",
  unit = "cell",
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TPI_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer. TPI calls the function RelPos internally which serves as a general purpose and more flexible function for calculating relative position.</p>
</td></tr>
<tr><td><code id="TPI_+3A_w">w</code></td>
<td>
<p>For a &quot;rectangle&quot; focal window, a vector of length 2 containing odd numbers specifying dimensions where the first number is the number of rows and the second is the number of columns (or a single number if the number of rows and columns is equal). For a &quot;circle&quot; shaped focal window, a single integer representing the radius in &quot;cell&quot; or &quot;map&quot; units or a focal weights matrix created by MultiscaleDTM::circle_window.</p>
</td></tr>
<tr><td><code id="TPI_+3A_shape">shape</code></td>
<td>
<p>Character representing the shape of the focal window. Either &quot;rectangle&quot; (default) or &quot;circle&quot;.</p>
</td></tr>
<tr><td><code id="TPI_+3A_stand">stand</code></td>
<td>
<p>Standardization method. Either &quot;none&quot; (the default), &quot;range&quot; or &quot;sd&quot; indicating whether the TPI should be standardized by dividing by the standard deviation or range of included values in the focal window. If stand is 'none' the layer name will be &quot;tpi&quot;, otherwise it will be &quot;stpi&quot; to indicate that the layer has been standardized.</p>
</td></tr>
<tr><td><code id="TPI_+3A_unit">unit</code></td>
<td>
<p>Unit for w if shape is 'circle' and it is a vector (default is unit=&quot;cell&quot;). For circular windows specified with a matrix, unit is ignored and extracted directly from w. For rectangular and custom focal windows set unit='cell' or set unit to NA/NULL.</p>
</td></tr>
<tr><td><code id="TPI_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether or not to remove NA values before calculations.</p>
</td></tr>
<tr><td><code id="TPI_+3A_include_scale">include_scale</code></td>
<td>
<p>Logical indicating whether to append window size to the layer names (default = FALSE) or a character vector specifying the name you would like to append or a number specifying the number of significant digits. If include_scale = TRUE the number of rows and number of columns will be appended for rectangular windows. For circular windows it will be a single number representing the radius. If unit=&quot;map&quot; then window size will have &quot;MU&quot; after the number indicating that the number represents the scale in map units (note units can be extracted from w created with MultiscaleDTM::circle_window).</p>
</td></tr>
<tr><td><code id="TPI_+3A_filename">filename</code></td>
<td>
<p>Character output filename.</p>
</td></tr>
<tr><td><code id="TPI_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="TPI_+3A_wopt">wopt</code></td>
<td>
<p>List with named options for writing files as in writeRaster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster or RasterLayer.
</p>


<h3>References</h3>

<p>Weiss, A., 2001. Topographic Position and Landforms Analysis. Presented at the ESRI user conference, San Diego, CA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
tpi&lt;- TPI(r, w=c(5,5), shape="rectangle", stand="none", na.rm = TRUE)
plot(tpi)
</code></pre>

<hr>
<h2 id='VRM'>Implementation of the Sappington et al., (2007) vector ruggedness measure</h2><span id='topic+VRM'></span>

<h3>Description</h3>

<p>Implementation of the Sappington et al., (2007) vector ruggedness measure, modified from Evans (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VRM(
  r,
  w = c(3, 3),
  na.rm = FALSE,
  include_scale = FALSE,
  filename = NULL,
  overwrite = FALSE,
  wopt = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VRM_+3A_r">r</code></td>
<td>
<p>DTM as a SpatRaster or RasterLayer</p>
</td></tr>
<tr><td><code id="VRM_+3A_w">w</code></td>
<td>
<p>A vector of length 2 specifying the dimensions of the rectangular window to use where the first number is the number of rows and the second number is the number of columns. Window size must be an odd number. Default is 3x3.</p>
</td></tr>
<tr><td><code id="VRM_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical indicating whether or not to remove NA values before calculations. See details for more information.</p>
</td></tr>
<tr><td><code id="VRM_+3A_include_scale">include_scale</code></td>
<td>
<p>logical indicating whether to append window size to the layer names (default = FALSE)</p>
</td></tr>
<tr><td><code id="VRM_+3A_filename">filename</code></td>
<td>
<p>character Output filename.</p>
</td></tr>
<tr><td><code id="VRM_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If TRUE, filename is overwritten (default is FALSE).</p>
</td></tr>
<tr><td><code id="VRM_+3A_wopt">wopt</code></td>
<td>
<p>list with named options for writing files as in writeRaster</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the crs is cartesian, when na.rm=TRUE, NA's will be removed from the slope/aspect calculations. When the crs is lat/lon, na.rm=TRUE will not affect the calculation of slope/aspect as terra::terrain will be used since it can calculate slope and aspect for spherical geometry but it does not support na.rm. In both cases when na.rm=TRUE, the x, y, and z components will be summed with na.rm=TRUE, and the N used in the denominator of the VRM equation will be the number of non-NA cells in the window rather than the total number of cells.
</p>


<h3>Value</h3>

<p>a RasterLayer
</p>


<h3>References</h3>

<p>Evans JS (2021). spatialEco. R package version 1.3-6, https://github.com/jeffreyevans/spatialEco.
</p>
<p>Sappington, J.M., Longshore, K.M., Thompson, D.B., 2007. Quantifying Landscape Ruggedness for Animal Habitat Analysis: A Case Study Using Bighorn Sheep in the Mojave Desert. The Journal of Wildlife Management 71, 1419-1426. https://doi.org/10.2193/2005-723
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r&lt;- rast(volcano, extent= ext(2667400, 2667400 + 
ncol(volcano)*10, 6478700, 6478700 + nrow(volcano)*10), 
crs = "EPSG:27200")
vrm&lt;- VRM(r, w=c(5,5), na.rm = TRUE)
plot(vrm)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
