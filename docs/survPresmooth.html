<!DOCTYPE html><html><head><title>Help for package survPresmooth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {survPresmooth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#control.presmooth'><p>Control Values for the presmooth() Function</p></a></li>
<li><a href='#presmooth'><p>Compute Presmoothed Estimators</p></a></li>
<li><a href='#print.survPresmooth'><p>Print a survPresmooth Object</p></a></li>
<li><a href='#pscheck'><p>Example Dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Presmoothed Estimation in Survival Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-11</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-06</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ignacio Lopez de Ullibarri &lt;ilu@udc.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.0.1)</td>
</tr>
<tr>
<td>Description:</td>
<td>Presmoothed estimators of survival, density, cumulative and non-cumulative hazard functions with right-censored survival data. For details, see Lopez-de-Ullibarri and Jacome (2013) &lt;<a href="https://doi.org/10.18637%2Fjss.v054.i11">doi:10.18637/jss.v054.i11</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-06 09:32:29 UTC; ilu</td>
</tr>
<tr>
<td>Author:</td>
<td>Ignacio Lopez de Ullibarri [aut, cre],
  Maria Amalia Jacome [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-06 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='control.presmooth'>Control Values for the presmooth() Function</h2><span id='topic+control.presmooth'></span>

<h3>Description</h3>

<p>This function returns a list of values for control
parameters of the <code>presmooth</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control.presmooth(n.boot = c(5000, 1000), q.weight = c(0.2, 0.8),
   k = 1, length.grid.bw.plugin = 100, length.grid.ise = 100,
   pilot.par.ini = NULL, save.data = FALSE, save.mise = FALSE,
   na.action = na.omit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="control.presmooth_+3A_n.boot">n.boot</code></td>
<td>
<p>A numeric vector of length 2 or, alternatively, a
numeric value specifying the number of bootstrap resamples used in
bootstrap bandwidth selection. If a vector, the first element is used
for S and H estimation, and the second for f and h. The default is
c(5000, 1000).
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_q.weight">q.weight</code></td>
<td>
<p>A numeric vector of length 2 specifying the order of
quantiles of the observed times that determine the left- and
right-ends of the support of the weight function. The default is
c(0.2, 0.8).
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_k">k</code></td>
<td>
<p>A numeric value specifying the multiple of the data range
used as the maximum possible value for the selected plug-in or
bootstrap bandwidth. The default is 1.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_length.grid.bw.plugin">length.grid.bw.plugin</code></td>
<td>
<p>An integer specifying the number of
points of the grid used for numerical integration (Simpson's rule) of
integrals involved in plug-in bandwidth selection. The default is 100.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_length.grid.ise">length.grid.ise</code></td>
<td>
<p>An integer specifying the number of points of
the grid used for computing the integrated squared error by numerical
integration (Simpson's rule) in bootstrap bandwidth selection. The
default is 100.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_pilot.par.ini">pilot.par.ini</code></td>
<td>
<p>A numeric vector of length 8 specifying the
initial values of optimization routines used for pilot bandwidth
computation in plug-in and bootstrap bandwidth selection (although, in
the last case, it is not needed for survival and cumulative hazard
function estimation). If <code>NULL</code>, the default, values are
internally computed.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_save.data">save.data</code></td>
<td>
<p>A logical value specifying if the data must be saved
as a component of the value returned by the <code>presmooth</code>
function. The default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_save.mise">save.mise</code></td>
<td>
<p>A logical value specifying if the MISE computed for
bootstrap bandwidth selection must be saved as a component of the
value returned by the <code>presmooth</code> function. The default is
<code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="control.presmooth_+3A_na.action">na.action</code></td>
<td>
<p>A function specifying how to handle missing
values. The default value, na.omit, deletes the rows containing
missing values in the (internal) data frame formed by the <code>times</code>
and <code>status</code> arguments of the call to the <code>presmooth</code>
function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default values of <code>n.boot</code> represent a trade-off
between computational speed and precision in bootstrap bandwidth
selection. If enough computing power or time are available, it is
recommended to increase the number of bootstrap resamples up to 10000
(which could be very slow for hazard and density estimation).
</p>
<p>The six first values of <code>pilot.par.ini</code> are three pairs of
parameters specifying three Weibull distributions (in each pair, the
first element is the shape parameter; the second one, the scale
parameter). These three Weibull distributions form a mixture, the
weights of its first two components being given by the last two values
of <code>pilot.par.ini</code>.
</p>


<h3>Value</h3>

<p>A list whose components are the arguments of the function, its
defaults being replaced with the values the function was called with.
</p>


<h3>Author(s)</h3>

<p>Ignacio Lopez-de-Ullibarri [aut, cre],
Maria Amalia Jacome [aut]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+presmooth">presmooth</a></code></p>

<hr>
<h2 id='presmooth'>Compute Presmoothed Estimators</h2><span id='topic+presmooth'></span>

<h3>Description</h3>

<p>This function computes presmoothed estimators of the main
functions used in survival analysis (survival function, cumulative
hazard function, density function and non-cumulative hazard function)
with right-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presmooth(times, status, dataset = NULL, estimand = c("S", "H",
"f", "h"), bw.selec = c("fixed", "plug-in", "bootstrap"), presmoothing =
TRUE, fixed.bw = NULL, grid.bw.pil = NULL, grid.bw = NULL, kernel =
c("biweight", "triweight"), bound = c("none", "left","right", "both"),
x.est = NULL, control = control.presmooth())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="presmooth_+3A_times">times</code></td>
<td>
<p>An object of mode numeric giving the observed, possibly
right-censored times. If dataset is not <code>NULL</code> it is interpreted
as the name of the corresponding variable of the dataset.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_status">status</code></td>
<td>
<p>An object of mode numeric giving the censoring status of
the times coded in the <code>times</code> object. Censored values must be
coded as 0, uncensored values as 1. If <code>dataset</code> is not
<code>NULL</code> it is interpreted as the name of the corresponding
variable of the dataset.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_dataset">dataset</code></td>
<td>
<p>An optional data frame in which the variables named in
<code>times</code> and <code>status</code> are interpreted. If it is <code>NULL</code>,
<code>times</code> and <code>status</code> must be objects of the workspace.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_estimand">estimand</code></td>
<td>
<p>An optional character string identifying the function
to estimate: &quot;S&quot; for survival function, &quot;H&quot; for cumulative hazard
function, &quot;f&quot; for density function and &quot;h&quot; for non-cumulative hazard
function. Defaults to &quot;S&quot;.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_bw.selec">bw.selec</code></td>
<td>
<p>An optional (partially matched) character string
specifying the method of bandwidth selection. &quot;fixed&quot; if no bandwidth
selection is done, in which case the bandwidth(s) given by the
<code>fixed.bw</code> argument is (are) used, &quot;plug-in&quot; for plug-in
bandwidth selection and &quot;bootstrap&quot; for bootstrap bandwidth
selection. Defaults to &quot;fixed&quot;.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_presmoothing">presmoothing</code></td>
<td>
<p>An optional logical value. If <code>TRUE</code>, the
default, a presmoothed estimate is computed; if <code>FALSE</code>, the
non-presmoothed counterpart (also including bandwidth selection) is
computed.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_fixed.bw">fixed.bw</code></td>
<td>
<p>An optional numeric vector with the fixed bandwidth(s)
used when the value of the <code>bw.selec</code> argument is &quot;fixed&quot;. It
must be of length 1 for estimating survival and cumulative hazard
functions, and of length 2 for density and hazard functions (in this
case, the first element is the presmoothing bandwidth).
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_grid.bw.pil">grid.bw.pil</code></td>
<td>
<p>An optional numeric vector specifying the grid
where the pilot bandwidth for the Nadaraya-Watson estimate of the
conditional probability of uncensoring, p, will be selected. Not used
in plug-in bandwidth selection for survival or cumulative hazard
function estimation. If <code>NULL</code>, it is internally computed.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_grid.bw">grid.bw</code></td>
<td>
<p>An optional list of length 1 (for presmoothed
estimation of survival and cumulative hazard functions, and
non-presmoothed estimation of density and hazard functions) or 2 (for
presmoothed estimation of density and hazard functions) whose
component(s) (is) are (a) numeric vector(s) specifying the grid of
bandwidths needed for bootstrap bandwith selection when the value of
the <code>bw.selec</code> argument is &quot;bootstrap&quot;. If it is a list of length
1, it can also be inputted as a numeric vector. If <code>NULL</code>, it is
internally computed.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_kernel">kernel</code></td>
<td>
<p>A (partially matched) character string specifying the
kernel function used. One of &quot;biweight&quot;, for biweight kernel, and
&quot;triweight&quot;, for triweight kernel. Defaults to &quot;biweight&quot;.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_bound">bound</code></td>
<td>
<p>A (partially matched) character string specifying the
end(s) of the data range where boundary-effect correction is
applied. If &quot;none&quot;, the default, no correction is done; if &quot;left&quot;,
&quot;right&quot; or &quot;both&quot;, the correction is applied at the left, right or
both ends, respectively.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_x.est">x.est</code></td>
<td>
<p>A numeric vector specifying the points where the estimate
will be computed. Only meaningful for density and hazard function
estimation. Internally computed when <code>NULL</code>, the default.
</p>
</td></tr>
<tr><td><code id="presmooth_+3A_control">control</code></td>
<td>
<p>A list of control values. The value returned by the
<code>control.presmooth</code> function called without arguments is the
default.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In survival analysis with right-censored data, presmoothing
(see references below for details) provides a method to obtain new
estimators from classical estimators, essentially by replacing the
indicator of non-censoring with a nonparametric estimate (in our
implementation, through the use of Nadaraya-Watson regression
estimator) of the conditional probability of uncensoring. The
<code>pres</code>-<code>mooth</code> function computes presmoothed versions of: 1)
Kaplan-Meier survival function estimator, 2) Nelson-Aalen cumulative
hazard function estimator, 3) the kernel density function estimator of
Foldes-Rejto-Winter, and 4) the kernel hazard function estimator of
Tanner-Wong (similar to that proposed by Yandell and
Ramlau-Hansen). All presmoothed estimators have at least one
presmoothing bandwidth (the smoothing parameter of the Nadaraya-Watson
estimator), but in the case of the kernel estimators of density and
hazard they have an additional smoothing bandwidth scaling the kernel.
</p>
<p>The <code>presmooth</code> function incorporates plug-in and bootstrap global
bandwidth selectors for every estimator implemented. Plug-in bandwith
selection is done according to Cao et al. (2005) in the case of survival
and cumulative hazard estimation, and following Jacome et al. (2008)
together with the results given in Cao and Lopez-de-Ullibarri (2007) in
the case of density and hazard estimation. As for bootstrap bandwidth
selection, our method follows the approach of Gonzalez-Manteiga et
al. (1996). See Jacome et al. (2008) for more details in the case of
density estimation. The weight function needed for the bootstrap
bandwidth is taken as constantly equal to 1. The left and right
endpoints of its support are fixed via the <code>q.weight</code> argument of
the <code>control.presmooth</code> function (see the online help for this
function) and form the <code>q.weight</code> component of the value returned
by <code>presmooth</code>. An upper bound equal to the range of the observed
times is set for the selected (plug-in or bootstrap) bandwidth. On the
other hand, bandwidths can also be fixed by the user. When the
presmoothing bandwidth is fixed at 0, the classical, non-presmoothed
versions of the estimators are computed. Non-presmoothed estimates are
also obtained by calling <code>presmooth</code> with the value of the
<code>presmoothing</code> argument equal to <code>FALSE</code>. This is equivalent
to the previous procedure for survival and cumulative hazard
estimation, but not for hazard and density function estimation. In the
latter case, a smoothing bandwidth is also selected by
<code>presmooth</code>, instead of being fixed by the user.
</p>
<p>In boundary regions, hazard and density estimates corrected for
boundary effects can be obtained by selecting one of &quot;left&quot;, &quot;right&quot;,
or &quot;both&quot; options of the <code>bound</code> argument (see Mueller and Wang,
1994). Note that negative values of the estimates, a known problem
with boundary kernels, are set to 0. For correcting the right-boundary
effect, the maximum observed time is taken as the right endpoint of
the support. Right-boundary correction should be used cautiously, due
to the combined effect of the increased variance of the estimates and
the small size of the risk set in the neighbouring of that end. With
the default value of the <code>x.est</code> argument, estimation is
restricted to values not greater than the 90th percentile of the
observed times.
</p>


<h3>Value</h3>

<p>An object of class 'survPresmooth'. Formally, it is a list with
the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The call the function was called with.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The data used, returned as a data frame if the value of
<code>control$save.data</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code>q.weight</code></td>
<td>
<p>A numeric vector of length 2 giving the quantiles
chosen as the ends of the support of the weight function.
</p>
</td></tr>
<tr><td><code>bw.selec</code></td>
<td>
<p>The value of the <code>bw.selec</code> argument.
</p>
</td></tr>
<tr><td><code>mise</code></td>
<td>
<p>A vector or matrix with the values of the bootstrap MISE,
returned for bootstrap bandwidth selection if the value of
<code>control$save.mise</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code>grid.pil</code></td>
<td>
<p>The vector of numeric values defining the grid used
for searching the pilot bandwidth when plug-in or bootstrap bandwidth
selection is done.</p>
</td></tr>
<tr><td><code>pilot.bw</code></td>
<td>
<p>The pilot bandwidth(s) used when plug-in or bootstrap
bandwidth selection is done.
</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>The bandwidth(s) selected.
</p>
</td></tr>
<tr><td><code>grid.bw</code></td>
<td>
<p>A list of length 1 or 2 whose elements define the grid
used for searching the bootstrap bandwidth.
</p>
</td></tr>
<tr><td><code>p.hat</code></td>
<td>
<p>Nadaraya-Watson estimate of the conditional probability
of non-censoring at the observed times.
</p>
</td></tr>
<tr><td><code>x.est</code></td>
<td>
<p>A numeric vector with the points where estimates have
been computed.
</p>
</td></tr>
<tr><td><code>estimand</code></td>
<td>
<p>The input for the <code>estimand</code> argument.
</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>A numeric vector with the presmoothed estimates at
points <code>x.est</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ignacio Lopez-de-Ullibarri [aut, cre],
Maria Amalia Jacome [aut]
</p>


<h3>References</h3>

<p>Cao, R. and Jacome, M. A. (2004)
&quot;Presmoothed kernel density estimation for censored data&quot;, Journal of
Nonparametric Statistics, 16, 289-309. 
doi: <a href="https://doi.org/10.1080/10485250310001622622">10.1080/10485250310001622622</a>.
</p>
<p>Cao, R., Lopez-de-Ullibarri, I., Janssen, P. and Veraverbeke, N. (2005)
&quot;Presmoothed Kaplan-Meier and Nelson-Aalen estimators&quot;, Journal of
Nonparametric Statistics, 17, 31-56. 
doi: <a href="https://doi.org/10.1080/10485250410001713981">10.1080/10485250410001713981</a>.
</p>
<p>Cao, R. and Lopez-de-Ullibarri, I. (2007)
&quot;Product-type and presmoothed hazard rate estimators with censored data&quot;,
Test, 16, 355-382.
doi: <a href="https://doi.org/10.1007/s11749-006-0014-x">10.1007/s11749-006-0014-x</a>.
</p>
<p>Gonzalez-Manteiga, W., Cao R. and Marron J. S. (1996)
&quot;Bootstrap selection of the smoothing parameter in nonparametric hazard
rate estimation&quot;, Journal of the American Statistical Association, 91,
1130-1140.
doi: <a href="https://doi.org/10.1080/01621459.1996.10476983">10.1080/01621459.1996.10476983</a>.
</p>
<p>Jacome, M. A., Gijbels, I. and Cao, R. (2008)
&quot;Comparison of presmoothing methods in kernel density estimation under
censoring&quot;, Computational Statistics, 23, 381-406. 
doi: <a href="https://doi.org/10.1007/s00180-007-0076-6">10.1007/s00180-007-0076-6</a>.
</p>
<p>Lopez-de-Ullibarri, I and Jacome,
M. A. (2013). &quot;survPresmooth: An R Package for Presmoothed Estimation in
Survival Analysis&quot;, Journal of Statistical Software, 54(11), 1-26.
doi: <a href="https://doi.org/10.18637/jss.v054.i11">10.18637/jss.v054.i11</a>.
</p>
<p>Mueller, H. G. and Wang, J. L. (1994)
&quot;Hazard rate estimation under random censoring with varying kernels and
bandwidths&quot;, Biometrics, 50, 61-76.
doi: <a href="https://doi.org/10.2307/2533197">10.2307/2533197</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+control.presmooth">control.presmooth</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>	## Not run: 
## Analysis with the example dataset (pscheck)

##############################################
## Cumulative hazard function (chf) estimation
##############################################

## Presmoothed estimate of chf with bootstrap bandwidth (fixing the
## randomization seed makes further comparisons easier)

set.seed(1)

Hboot1 &lt;- presmooth(t, delta, pscheck, estimand = "H", bw.selec =
"bootstrap")

## As above, but: 1) specifying the points where the estimate is computed
## (note the warning), 2) specifying the search grid for the bandwidth,
## and 3) saving the bootstrap MISE

set.seed(1)

Hboot2 &lt;- presmooth(t, delta, pscheck, estimand = "H", bw.selec =
"bootstrap", x.est = seq(0, 1, by = 0.02), grid.bw = seq(0.55, 0.7, by =
0.01), control = control.presmooth(save.mise = TRUE))

## A plot of the MISE, showing the bootstrap bandwidth

with(Hboot2,{
  plot(grid.bw$grid.bw, mise, xlab = "Bandwidth", ylab = "MISE", main = 
  expression(paste("Bootstrap bandwidth, ", b[boot])), type = "l")
  points(bandwidth, mise[grid.bw$grid.bw == bandwidth], pch = 46, cex = 5)
  segments(bandwidth, 0, bandwidth, mise[grid.bw$grid.bw == bandwidth],
  lty = "dotted")
  text(bandwidth, min(mise), bquote(paste("  ", b[boot] ==
  .(bandwidth))), adj = c(0, 0))
})

## A plot of the presmoothed chf compared with Nelson-Aalen estimate and
## the true curve. The point (0, 0) must be added. 

plot(c(0, Hboot2$x.est), c(0, Hboot2$estimate), xlab = "t", ylab =
"Cumulative hazard", type = "s")

Hna &lt;- presmooth(t, delta, pscheck, estimand = "H", bw.selec = "fixed",
fixed.bw = 0)

lines(c(0, Hna$x.est), c(0, Hna$estimate), type = "s", col = "red")

curve(x^3, add = TRUE, col = "grey", lty = "dotted")

legend("topleft", legend = c("Presmoothed Nelson-Aalen", "Nelson-Aalen",
"True"), col = c("black", "red", "grey"), lty = c("solid", "solid",
"dotted"))

## An alternative way of obtaining the Nelson-Aalen estimate

Hna &lt;- presmooth(t, delta, pscheck, "H", presmoothing = FALSE)

##################################
## Hazard function (hf) estimation 
##################################

## (An example where right-boundary correction is successful)
## Presmoothed estimate of hf:
## 1) with plug-in bandwidth with and without right-boundary correction,
## 2) specifying the grid for presmoothing bandwidth selection, and
## 3) specifying the support of the weight function

hpi1 &lt;- presmooth(t, delta, pscheck, estimand = "h", bw.selec =
"plug-in", x.est =  seq(0, max(pscheck$t), by = 0.02), grid.bw.pil =
seq(range(pscheck$t)[1],
range(pscheck)[2], by = 0.01), control = control.presmooth(q.weight =
c(0.25, 0.75)))

hpi2 &lt;- presmooth(t, delta, pscheck, estimand = "h", bw.selec =
"plug-in", bound = "right", x.est = seq(0, max(pscheck$t), by = 0.02),
grid.bw.pil = seq(range(pscheck$t)[1], range(pscheck$t)[2], by = 0.01),
control = control.presmooth(q.weight = c(0.25, 0.75)))

plot(hpi1$x.est, hpi1$estimate, xlab = "t", ylab = "Hazard", ylim = c(0,
max(pmax(hpi1$estimate, hpi2$estimate))), type = "l")

lines(hpi2$x.est, hpi2$estimate, col = 2)

legend("bottomright", legend = c("none", "right"), title =
"Boundary effect correction", col = 1:2, lty = 1)

## Estimation of hf using a bootstrap bandwidth. The values chosen for
## the grid.bw argument are based on the result of preliminary trials
## (Warning: it may take a while ...)

set.seed(1)

hboot &lt;- presmooth(t, delta, pscheck, estimand = "h", bw.selec =
"bootstrap", bound = "right", x.est = seq(0, max(pscheck$t), by = 0.02),
grid.bw.pil = seq(range(pscheck$t)[1],
range(pscheck)[2], by = 0.01), grid.bw = list(seq(0.4, 0.8, by = 0.05),
seq(0.6, 0.9, by = 0.005)), control = control.presmooth(q.weight =
c(0.25, 0.75), save.mise = TRUE))

## A plot of the bootstrap MISE, showing the bootstrap bandwidth

with(hboot, {
  contour(grid.bw$grid.bw.1, grid.bw$grid.bw.2, mise, levels
  = seq(min(mise), max(mise), length.out = 20), xlab =
  "Presmoothing bandwidth", ylab = "Smoothing bandwidth", main =
  "Bootstrap MISE")
  points(bandwidth[1], bandwidth[2], pch = 46, cex = 6)
  text(bandwidth[1], bandwidth[2], bquote(paste("  ", b[boot],
  symbol("="), symbol("("), .(bandwidth[1]), symbol(","), .(bandwidth[2]),
  symbol(")"))), adj = c(1, 0))
}
)

## Compare with the hf estimate obtained with plug-in bandwidth and the
## true curve

plot(hpi2$x.est, hpi2$estimate, xlab = "t", ylab = "Hazard", ylim = c(0,
max(pmax(hpi2$estimate, hboot$estimate))), type = "l")

lines(hboot$x.est, hboot$estimate, col = 2)

curve(3*x^2, add = TRUE, col = "grey", lty = "dotted")

legend("bottomright", legend = c("Plug-in bandwidth",
"Bootstrap bandwidth", "True"), col = c("black", "red", "grey"), lty =
c("solid", "solid", "dotted"))

###################################
## Density function (df) estimation
###################################

## Presmoothed estimate of df with plug-in and bootstrap bandwidths
## (with default options) and comparison with the true df

dpi &lt;- presmooth(t, delta, pscheck, estimand = "f", bw.selec = "plug-in")

## The bootstrap presmoothing bandwidth is on the right boundary of the
## default grid (which in fact is the upper bound for the bandwidth: the
## range of the observed times)

set.seed(1)

dboot &lt;- presmooth(t, delta, pscheck, estimand = "f", bw.selec =
"bootstrap")

## For this example, the estimates with either plugin or bootstrap
## bandwidth are very similar 

plot(dpi$x.est, dpi$estimate, xlab = "t", ylab = "Density", ylim = c(0, 
max(pmax(dpi$estimate, dboot$estimate))), type = "l", col = "blue",
lty = 2)

lines(dboot$x.est, dboot$estimate, col = "red", lty = 4)

curve(3*x^2*exp(-x^3), add = TRUE, lty = 1)

legend("bottomright", legend = c("Plug-in bandwidth",
"Bootstrap bandwidth", "True"), col = c("blue", "red", "black"), lty =
c(2, 4, 1))
   
## End(Not run)
</code></pre>

<hr>
<h2 id='print.survPresmooth'>Print a survPresmooth Object</h2><span id='topic+print.survPresmooth'></span>

<h3>Description</h3>

<p>Print method for &lsquo;survPresmooth&rsquo; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survPresmooth'
print(x, long = FALSE, more = NULL,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.survPresmooth_+3A_x">x</code></td>
<td>
<p>An object of class 'survPresmooth'.
</p>
</td></tr>
<tr><td><code id="print.survPresmooth_+3A_long">long</code></td>
<td>
<p>A logical value. If <code>TRUE</code> the entire estimated curve
is printed; if <code>FALSE</code>, the default, only the head of the
estimated curve is printed if it consists of more than 100 values.
</p>
</td></tr>
<tr><td><code id="print.survPresmooth_+3A_more">more</code></td>
<td>
<p>A character vector specifying the names of additional
components of the <code>x</code> object that will be printed. The valid
values for the components of the character vector are &quot;data&quot;,
&quot;q.weight&quot;, &quot;mise&quot;, &quot;grid.pil&quot;, &quot;pilot.bw&quot;, &quot;grid.bw&quot; and &quot;p.hat&quot;. The
default is <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="print.survPresmooth_+3A_...">...</code></td>
<td>
<p>Optional arguments for the default method
(i.e., <code>print.default</code>) of the <code>print</code> generic function.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ignacio Lopez-de-Ullibarri [aut, cre],
Maria Amalia Jacome [aut]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+presmooth">presmooth</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Printing an object of class 'survPresmooth' with 4 digits, including
## in the output the value of the pilot bandwidth and the estimated p
## function

print(presmooth(t, delta, pscheck), more = c("pilot.bw", "p.hat"),
digits = 4)

## End(Not run)
</code></pre>

<hr>
<h2 id='pscheck'>Example Dataset</h2><span id='topic+pscheck'></span>

<h3>Description</h3>

<p>An artificial data frame used to illustrate the techniques
implemented in the package. Pseudorandom numbers were drawn from
Weibull distributions of scale parameter 1 and shape parameter 3 (for
failure times) and 5 (for censoring times). Each observed time is the
minimum of the corresponding failure and censoring times, and its
censoring status indicates a failure time smaller than a censoring
time (see <code>format</code> below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pscheck</code></pre>


<h3>Format</h3>

<p>The data frame contains 2 variables:
</p>

<dl>
<dt><code>t</code></dt><dd><p>Observed time.	
</p>
</dd>
<dt><code>delta</code></dt><dd><p>Censoring status (0 = censored, 1 = uncensored).
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Ignacio Lopez-de-Ullibarri [aut, cre],
Maria Amalia Jacome [aut]
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
