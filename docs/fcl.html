<!DOCTYPE html><html><head><title>Help for package fcl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fcl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fixed_bond'><p>Create Fixed Bond Object</p></a></li>
<li><a href='#make_rtn'><p>Create a Return Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Financial Calculator</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xianying Tan &lt;shrektan@126.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A financial calculator that provides very fast implementations
    of common financial indicators using 'Rust' code. It includes functions for
    bond-related indicators, such as yield to maturity ('YTM'), modified duration,
    and Macaulay duration, as well as functions for calculating time-weighted
    and money-weighted rates of return (using 'Modified Dietz' method) for multiple portfolios,
    given their market values and profit and loss ('PnL') data. 'fcl' is designed
    to be efficient and accurate for financial analysis and computation. The methods
    used in this package are based on the following references:
    <a href="https://en.wikipedia.org/wiki/Modified_Dietz_method">https://en.wikipedia.org/wiki/Modified_Dietz_method</a>,
    <a href="https://en.wikipedia.org/wiki/Time-weighted_return">https://en.wikipedia.org/wiki/Time-weighted_return</a>.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/shrektan/fcl">https://github.com/shrektan/fcl</a>, <a href="https://shrektan.github.io/fcl/">https://shrektan.github.io/fcl/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shrektan/fcl/issues">https://github.com/shrektan/fcl/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Cargo (Rust's package manager), rustc</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>xts, ymd</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/rextendr/version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-13 14:46:06 UTC; shrektan</td>
</tr>
<tr>
<td>Author:</td>
<td>Xianying Tan <a href="https://orcid.org/0000-0002-6072-3521"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Raymon Mina [ctb] (find_root.rs, xirr.rs),
  The authors of the dependency Rust crates [ctb] (see inst/AUTHORS file
    for details)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-13 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fixed_bond'>Create Fixed Bond Object</h2><span id='topic+fixed_bond'></span>

<h3>Description</h3>

<p>Create Fixed Bond Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixed_bond(value_date, mty_date, redem_value, cpn_rate, cpn_freq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixed_bond_+3A_value_date">value_date</code>, <code id="fixed_bond_+3A_mty_date">mty_date</code></td>
<td>
<p>the value and maturity date of the bond</p>
</td></tr>
<tr><td><code id="fixed_bond_+3A_redem_value">redem_value</code>, <code id="fixed_bond_+3A_cpn_rate">cpn_rate</code>, <code id="fixed_bond_+3A_cpn_freq">cpn_freq</code></td>
<td>
<p>the redemption value, coupon rate and coupon frequency of the bond.
Note that the <strong>frequency</strong> can only be one of 1, 2, 4, 0 (pay at mature)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>it returns an environment containing the following objects:
</p>

<ul>
<li> <p><code>.self</code>: an external pointer of the Rust object.
</p>
</li>
<li> <p><code>len()</code>: a function returns the length of the internal bonds object.
</p>
</li>
<li> <p><code>ytm_dur(ref_date, clean_price)</code>: a function returns a data.frame, with three columns,
'YTM' (Yield to Maturity), 'MODD' (Modified Duration) and 'MACD' (Macaulay Duration).
</p>
</li>
<li> <p><code>cf(ref_date)</code>: a function returns the schedualed bond cashflows, in <code>xts</code> format.
</p>
</li></ul>



<h3>Note</h3>


<ul>
<li><p> all arguments must be the same length or 1.
</p>
</li>
<li><p> The date input will be converted to Date object via <code><a href="ymd.html#topic+ymd">ymd::ymd()</a></code>.
</p>
</li></ul>


<ul>
<li><p> It doesn't take the day count convention into account for now.
</p>
</li>
<li><p> There's no support for business day calendar. The dates in the cashflow projection are the
same days in the next few months (see <code><a href="ymd.html#topic+edate">ymd::edate()</a></code>). It considers different days in each
month but no weekend date adjustment.
</p>
</li>
<li><p> The 'YTM' value is the cashflow's 'IRR' (internal rate of return) value. Thus, it doesn't
equal to the Excel's Yield value, which is adjusted using this formula
<code class="reqn">YTM (fcl) = (1 + frac{Yield (Excel)}{n})^n - 1</code>,
where n is the the coupon payment frequency, when the remaining life of the bond is larger
than 1.
</p>
</li>
<li><p> When the bond is going to mature within one year, the <code class="reqn">Yield (Excel) = frac{Cashflow}{Price} - 1</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>bond &lt;- fixed_bond(
  value_date = 210101,
  mty_date = c(250101, 300201),
  redem_value = 100,
  cpn_rate = c(0.05, 0.03),
  cpn_freq = c(0, 1)
)
bond$ytm_dur(
  ref_date = c(220101, 220201),
  clean_price = 100
)
bond$cf(
  ref_date = c(220101, 220131)
)
</code></pre>

<hr>
<h2 id='make_rtn'>Create a Return Object</h2><span id='topic+make_rtn'></span>

<h3>Description</h3>

<p>By providing a &quot;group&quot; (<code>ids</code>) of <code>dates</code>, <code>mvs</code> and <code>pls</code>,
calucating the Time-weighted Rate of Return (TWRR) or Modified
Dietz Rate of Return (DIETZ).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_rtn(date, mv, pl, id = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_rtn_+3A_date">date</code></td>
<td>
<p>a Date vector, the reference date of each row</p>
</td></tr>
<tr><td><code id="make_rtn_+3A_mv">mv</code>, <code id="make_rtn_+3A_pl">pl</code></td>
<td>
<p>a double vector, the market value and the 'PnL' (Profit and Loss) of each day</p>
</td></tr>
<tr><td><code id="make_rtn_+3A_id">id</code></td>
<td>
<p>an integer vector, the ID of each row belongs to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of functions, with signature of <code>from</code>, <code>to</code> and <code>id</code>, all of
which are only allowed to accept a scalar. They all return an <code>xts</code> object
with one column.
</p>

<ul>
<li> <p><code>twrr_cr</code>: the cumulative Time-weighted Return
</p>
</li>
<li> <p><code>twrr_dr</code>: the daily Time-weighted Return
</p>
</li>
<li> <p><code>dietz</code>: the Modified Dietz Return
</p>
</li>
<li> <p><code>dietz_avc</code>: the denominator used to calculate the 'Modifie Dietz Return
</p>
</li>
<li> <p><code>cum_pl</code>: the cumulative PnL
</p>
</li></ul>



<h3>Cash flow handling</h3>


<ul>
<li><p> The cash flow is not provided externally. Instead, it's deducted via
market value and PnL, with the equation <code class="reqn">\Delta MV = \Delta PnL + CF</code>.
</p>
</li>
<li><p> The cash inflow is treating as if it happens at the beginning of the day,
while the cash outflow is at the end of the day. The reasons are two.
The first is to reduce the possibility of having a close-to-zero denominator.
The second is the cash is usually not usable for the whole day.
</p>
</li>
<li><p> The calculation is based on calendar days. No business calendar or weekday
considers. You can't change the calculation frequency, either. However,
this is possible in the future version.
</p>
</li></ul>



<h3>Note</h3>

<p>All the input vector must be 1 or the same length.
</p>


<h3>References</h3>

<p>Modified Dietz Method: https://en.wikipedia.org/wiki/Modified_Dietz_method
</p>
<p>Time weighed Return: https://en.wikipedia.org/wiki/Time-weighted_return
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rtn &lt;- make_rtn(date = c(210101, 210105, 210110), mv = c(100, 123, 140), pl = c(0, 3, 7))
rtn$twrr_cr(210102, 210110)
rtn$twrr_dr(210102, 210110)
rtn$dietz(210102, 210110)
rtn$dietz_avc(210102, 210110)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
