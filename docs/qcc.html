<!DOCTYPE html><html><head><title>Help for package qcc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qcc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#qcc-package'><p>Quality Control Charts</p></a></li>
<li><a href='#boiler'><p>Boiler temperature data</p></a></li>
<li><a href='#cause.and.effect'><p>Cause and effect diagram</p></a></li>
<li><a href='#circuit'><p>Circuit boards data</p></a></li>
<li><a href='#cusum'><p>Cusum chart</p></a></li>
<li><a href='#dyedcloth'><p>Dyed cloth data</p></a></li>
<li><a href='#ellipseChart'><p>Multivariate Quality Control Charts</p></a></li>
<li><a href='#ewma'><p>EWMA chart</p></a></li>
<li><a href='#ewmaSmooth'><p>EWMA smoothing function</p></a></li>
<li><a href='#mqcc'><p>Multivariate Quality Control Charts</p></a></li>
<li><a href='#oc.curves'><p>Operating Characteristic Function</p></a></li>
<li><a href='#orangejuice'><p>Orange juice data</p></a></li>
<li><a href='#orangejuice2'><p>Orange juice data &ndash;  Part 2</p></a></li>
<li><a href='#pareto.chart'><p>Pareto chart</p></a></li>
<li><a href='#pcmanufact'><p>Personal computer manufacturer data</p></a></li>
<li><a href='#pistonrings'><p>Piston rings data</p></a></li>
<li><a href='#process.capability'><p>Process capability analysis</p></a></li>
<li><a href='#qcc'><p>Quality Control Charts</p></a></li>
<li><a href='#qcc-internal'><p>Internal 'qcc' functions</p></a></li>
<li><a href='#qcc.groups'><p>Grouping data based on a sample indicator</p></a></li>
<li><a href='#qcc.options'><p>Set or return options for the 'qcc' package.</p></a></li>
<li><a href='#qcc.overdispersion.test'><p>Overdispersion test for binomial and poisson data</p></a></li>
<li><a href='#shewhart.rules'><p>Functions specifying rules for Shewhart charts</p></a></li>
<li><a href='#stats.c'><p>Functions to plot Shewhart c chart</p></a></li>
<li><a href='#stats.g'><p>Statistics used in computing and drawing a Shewhart g chart</p></a></li>
<li><a href='#stats.np'><p>Statistics used in computing and drawing a Shewhart np chart</p></a></li>
<li><a href='#stats.p'><p>Statistics used in computing and drawing a Shewhart p chart</p></a></li>
<li><a href='#stats.R'><p>Statistics used in computing and drawing a Shewhart R chart</p></a></li>
<li><a href='#stats.S'><p>Functions to plot Shewhart S chart</p></a></li>
<li><a href='#stats.T2'><p>Statistics used in computing and drawing the Hotelling T^2 chart for subgrouped data</p></a></li>
<li><a href='#stats.T2.single'><p>Statistics used in computing and drawing the Hotelling T^2 chart for individual observations data</p></a></li>
<li><a href='#stats.u'><p>Statistics used in computing and drawing a Shewhart u chart</p></a></li>
<li><a href='#stats.xbar'><p>Statistics used in computing and drawing a Shewhart xbar chart</p></a></li>
<li><a href='#stats.xbar.one'><p>Statistics used in computing and drawing a Shewhart xbar chart for one-at-time data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-07-09</td>
</tr>
<tr>
<td>Title:</td>
<td>Quality Control Charts</td>
</tr>
<tr>
<td>Description:</td>
<td>Shewhart quality control charts for continuous, attribute and count data. Cusum and EWMA charts. Operating characteristic curves. Process capability analysis. Pareto chart and cause-and-effect chart. Multivariate control charts.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, utils, graphics, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.12), rmarkdown (&ge; 0.9)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/luca-scr/qcc">https://github.com/luca-scr/qcc</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-10 14:05:44 UTC; luca</td>
</tr>
<tr>
<td>Author:</td>
<td>Luca Scrucca [aut, cre],
  Greg Snow [ctb],
  Peter Bloomfield [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luca Scrucca &lt;luca.scrucca@unipg.it&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-11 05:51:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='qcc-package'>Quality Control Charts</h2><span id='topic+qcc-package'></span>

<h3>Description</h3>

<p>Shewhart quality control charts for continuous, attribute and count data. Cusum and EWMA charts. Operating characteristic curves. Process capability analysis. Pareto chart and cause-and-effect chart. Multivariate control charts.
</p>


<h3>Details</h3>

<p>See <a href="../doc/index.html">vignette and documentation</a> accompanying the package.
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code>, <code><a href="#topic+mqcc">mqcc</a></code>, <code><a href="#topic+cusum">cusum</a></code>, <code><a href="#topic+ewma">ewma</a></code>, <code><a href="#topic+oc.curves">oc.curves</a></code>, <code><a href="#topic+process.capability">process.capability</a></code>, <code><a href="#topic+pareto.chart">pareto.chart</a></code>, <code><a href="#topic+cause.and.effect">cause.and.effect</a></code>.</p>

<hr>
<h2 id='boiler'>Boiler temperature data</h2><span id='topic+boiler'></span>

<h3>Description</h3>

<p>Temperature readings from the eight configured burners on a boiler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(boiler)</code></pre>


<h3>Format</h3>

<p>A data frame with 25 observations on the following 8 variables:
</p>

<dl>
<dt>t1</dt><dd><p>temperature reading 1</p>
</dd>
<dt>t2</dt><dd><p>temperature reading 2</p>
</dd>
<dt>t3</dt><dd><p>temperature reading 3</p>
</dd>
<dt>t4</dt><dd><p>temperature reading 4</p>
</dd>
<dt>t5</dt><dd><p>temperature reading 5</p>
</dd>
<dt>t6</dt><dd><p>temperature reading 6</p>
</dd>
<dt>t7</dt><dd><p>temperature reading 7</p>
</dd>
<dt>t8</dt><dd><p>temperature reading 8</p>
</dd>
</dl>



<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM, p. 86.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(boiler)
summary(boiler)
boxplot(boiler)
</code></pre>

<hr>
<h2 id='cause.and.effect'>Cause and effect diagram</h2><span id='topic+cause.and.effect'></span>

<h3>Description</h3>

<p>Draw a basic cause and effect diagram.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cause.and.effect(cause, effect, title = "Cause-and-Effect diagram", 
                 cex = c(1, 0.9, 1), font = c(1, 3, 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cause.and.effect_+3A_cause">cause</code></td>
<td>
<p>a list of causes and branches providing descriptive labels (see the example below).</p>
</td></tr>
<tr><td><code id="cause.and.effect_+3A_effect">effect</code></td>
<td>
<p>a string label or the effect.</p>
</td></tr>
<tr><td><code id="cause.and.effect_+3A_title">title</code></td>
<td>
<p>a string specifying the main title to appear on the plot.</p>
</td></tr>
<tr><td><code id="cause.and.effect_+3A_cex">cex</code></td>
<td>
<p>a vector of values for the graphical character expansion. The values refer, in order, to branches, causes and effect.</p>
</td></tr>
<tr><td><code id="cause.and.effect_+3A_font">font</code></td>
<td>
<p>a vector of values for the font to use. The values refer, in order, to branches, causes and effect.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cause.and.effect(cause=list(Measurements=c("Micrometers", "Microscopes", "Inspectors"),
                            Materials=c("Alloys", "Lubricants", "Suppliers"),
                            Personnel=c("Shifts", "Supervisors", "Training", "Operators"),
                            Environment=c("Condensation", "Moisture"),
                            Methods=c("Brake", "Engager", "Angle"),
                            Machines=c("Speed", "Lathes", "Bits", "Sockets")),
                 effect="Surface Flaws")
</code></pre>

<hr>
<h2 id='circuit'>Circuit boards data</h2><span id='topic+circuit'></span>

<h3>Description</h3>

<p>Number of nonconformities observed in 26 successive samples of 100 printed circuit boards.
Sample 6 and 20 are outside the control limits. Sample 6 was examined by a new inspector and he did not recognize several type of nonconformities that could have been present. Furthermore, the unusually large number of nonconformities in sample 20 resulted from a temperature control problem in the wave soldering machine, which was subsequently repaired.
The last 20 samples are further samples collected on inspection units (each formed by 100 boards).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(circuit)</code></pre>


<h3>Format</h3>

<p>A data frame with 46 observations on the following 3 variables.
</p>

<dl>
<dt>x</dt><dd><p>number of defectives in 100 printed circuit boards (inspection unit)</p>
</dd>
<dt>size</dt><dd><p>sample size</p>
</dd>
<dt>trial</dt><dd><p>trial sample indicator (TRUE/FALSE)</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 173&ndash;175</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(circuit)
attach(circuit)
summary(circuit)
boxplot(x ~ trial)
plot(x, type="b")
detach(circuit)
</code></pre>

<hr>
<h2 id='cusum'>Cusum chart</h2><span id='topic+cusum'></span><span id='topic+cusum.qcc'></span><span id='topic+print.cusum.qcc'></span><span id='topic+summary.cusum.qcc'></span><span id='topic+plot.cusum.qcc'></span>

<h3>Description</h3>

<p>Create an object of class 'cusum.qcc' to compute a Cusum chart for statistical quality control.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum(data, sizes, center, std.dev, head.start = 0,
      decision.interval = 5, se.shift = 1, data.name, labels,
      newdata, newsizes, newlabels, plot = TRUE, ...)

## S3 method for class 'cusum.qcc'
print(x, ...)

## S3 method for class 'cusum.qcc'
summary(object, digits = getOption("digits"), ...)

## S3 method for class 'cusum.qcc'
plot(x, add.stats = TRUE, chart.all = TRUE, 
     label.bounds = c("LDB", "UDB"), title, xlab, ylab, ylim, 
     axes.las = 0, digits =  getOption("digits"),
     restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cusum_+3A_data">data</code></td>
<td>
<p>a data frame, a matrix or a vector containing observed data for the variable to chart. Each row of a data frame or a matrix, and each value of a vector, refers to a sample or &rdquo;rationale group&rdquo;.</p>
</td></tr>
<tr><td><code id="cusum_+3A_sizes">sizes</code></td>
<td>
<p>a value or a vector of values specifying the sample sizes associated with each group. If not provided the sample sizes are obtained counting the non-<code>NA</code> elements of each row of a data frame or a matrix; sample sizes are set all equal to one if <code>data</code> is a vector.</p>
</td></tr>
<tr><td><code id="cusum_+3A_center">center</code></td>
<td>
<p>a value specifying the center of group statistics or the &rdquo;target&rdquo; value of the process.</p>
</td></tr>
<tr><td><code id="cusum_+3A_std.dev">std.dev</code></td>
<td>
<p>a value or an available method specifying the within-group standard deviation(s) of the process. <br />
Several methods are available for estimating the standard deviation. See <code><a href="#topic+sd.xbar">sd.xbar</a></code> and <code><a href="#topic+sd.xbar.one">sd.xbar.one</a></code> for, respectively, the grouped data case and the individual observations case.
</p>
</td></tr>
<tr><td><code id="cusum_+3A_head.start">head.start</code></td>
<td>
<p>The initializing value for the above-target and
below-target cumulative sums, measured in standard errors of the summary
statistics. Use zero for the traditional Cusum chart, or a positive
value less than the <code>decision.interval</code> for a Fast Initial Response.</p>
</td></tr>
<tr><td><code id="cusum_+3A_decision.interval">decision.interval</code></td>
<td>
<p>A numeric value specifying the number of standard errors of the summary statistics at which the cumulative sum is out of control.</p>
</td></tr>
<tr><td><code id="cusum_+3A_se.shift">se.shift</code></td>
<td>
<p>The amount of shift to detect in the process, measured in standard errors of the summary statistics.</p>
</td></tr>
<tr><td><code id="cusum_+3A_data.name">data.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as data.</p>
</td></tr>
<tr><td><code id="cusum_+3A_labels">labels</code></td>
<td>
<p>a character vector of labels for each group.</p>
</td></tr>
<tr><td><code id="cusum_+3A_newdata">newdata</code></td>
<td>
<p>a data frame, matrix or vector, as for the <code>data</code> argument, providing further data to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="cusum_+3A_newsizes">newsizes</code></td>
<td>
<p>a vector as for the <code>sizes</code> argument providing further data sizes to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="cusum_+3A_newlabels">newlabels</code></td>
<td>
<p>a character vector of labels for each new group defined in the argument <code>newdata</code>.</p>
</td></tr>
<tr><td><code id="cusum_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> a Cusum chart is plotted.</p>
</td></tr>
<tr><td><code id="cusum_+3A_add.stats">add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and other information should be printed at the bottom of the chart.</p>
</td></tr>
<tr><td><code id="cusum_+3A_chart.all">chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td></tr>
<tr><td><code id="cusum_+3A_label.bounds">label.bounds</code></td>
<td>
<p>a character vector specifying the labels for the the decision interval boundaries.</p>
</td></tr>
<tr><td><code id="cusum_+3A_title">title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td></tr>
<tr><td><code id="cusum_+3A_xlab">xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td></tr>
<tr><td><code id="cusum_+3A_ylab">ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td></tr>
<tr><td><code id="cusum_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="cusum_+3A_axes.las">axes.las</code></td>
<td>
<p>numeric in {0,1,2,3} specifying the style of axis labels. See <code>help(par)</code>.</p>
</td></tr>
<tr><td><code id="cusum_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use.</p>
</td></tr>
<tr><td><code id="cusum_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cusum_+3A_object">object</code></td>
<td>
<p>an object of class 'cusum.qcc'.</p>
</td></tr>
<tr><td><code id="cusum_+3A_x">x</code></td>
<td>
<p>an object of class 'cusum.qcc'.</p>
</td></tr>
<tr><td><code id="cusum_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Cusum charts display how the group summary statistics deviate above or below the process center or target value, relative to the standard errors of the summary statistics. Useful to detect small and permanent variation on the mean of the process.
</p>


<h3>Value</h3>

<p>Returns an object of class 'cusum.qcc'.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code>, <code><a href="#topic+ewma">ewma</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Grouped-data
##
data(pistonrings)
attach(pistonrings)
diameter &lt;- qcc.groups(diameter, sample)

q &lt;- cusum(diameter[1:25,], decision.interval = 4, se.shift = 1)
summary(q)

q &lt;- cusum(diameter[1:25,], newdata=diameter[26:40,])
summary(q)
plot(q, chart.all=FALSE)

detach(pistonrings)
</code></pre>

<hr>
<h2 id='dyedcloth'>Dyed cloth data</h2><span id='topic+dyedcloth'></span>

<h3>Description</h3>

<p>In a textile finishing plant, dyed cloth is inspected for the occurrence of defects per 50 square meters. The data on ten rolls of cloth are presented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dyedcloth)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 2 variables.
</p>

<dl>
<dt>x</dt><dd><p>number of nonconformities per 50 square meters (inspection units)</p>
</dd>
<dt>size</dt><dd><p>number of inspection units in roll (variable sample size)</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 183&ndash;184</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dyedcloth)
attach(dyedcloth)
summary(dyedcloth)
plot(x/size, type="b")
detach(dyedcloth)
</code></pre>

<hr>
<h2 id='ellipseChart'>Multivariate Quality Control Charts</h2><span id='topic+ellipseChart'></span>

<h3>Description</h3>

<p>Plot an ellipse chart for a bivariate quality control data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipseChart(object, chart.all = TRUE, show.id = FALSE, ngrid = 50,
             confidence.level, correct.multiple = TRUE, 
             title, xlim, ylim, xlab, ylab,
             restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ellipseChart_+3A_object">object</code></td>
<td>
<p>an object of class 'mqcc'.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_chart.all">chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_show.id">show.id</code></td>
<td>
<p>a logical value indicating whether to plot point labels (<code>TRUE</code>) or symbols (<code>FALSE</code>) for group means.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_ngrid">ngrid</code></td>
<td>
<p>a value for the size of the grid over which the ellipse is evaluated.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_confidence.level">confidence.level</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the confidence level of the computed probability limits.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_correct.multiple">correct.multiple</code></td>
<td>
<p>a logical value indicating whether to correct or not for multiple comparisons.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_title">title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector specifying the limits for the x-axis.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_xlab">xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_ylab">ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ellipseChart_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic <code><a href="graphics.html#topic+points">points</a></code> function.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mqcc">mqcc</a></code>, <code><a href="#topic+stats.T2">stats.T2</a></code>, <code><a href="#topic+stats.T2.single">stats.T2.single</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in help(mqcc)
</code></pre>

<hr>
<h2 id='ewma'>EWMA chart</h2><span id='topic+ewma'></span><span id='topic+ewma.qcc'></span><span id='topic+print.ewma.qcc'></span><span id='topic+summary.ewma.qcc'></span><span id='topic+plot.ewma.qcc'></span>

<h3>Description</h3>

<p>Create an object of class 'ewma.qcc' to compute and draw an Exponential Weighted Moving Average (EWMA) chart for statistical quality control.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ewma(data, sizes, center, std.dev, lambda = 0.2, nsigmas = 3, 
     data.name, labels, newdata, newsizes, newlabels, 
     plot = TRUE, ...)

## S3 method for class 'ewma.qcc'
print(x, ...)

## S3 method for class 'ewma.qcc'
summary(object, digits = getOption("digits"), ...)

## S3 method for class 'ewma.qcc'
plot(x, add.stats = TRUE, chart.all = TRUE, 
     label.limits = c("LCL", "UCL"), title, xlab, ylab, ylim, 
     axes.las = 0, digits = getOption("digits"),
     restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ewma_+3A_data">data</code></td>
<td>
<p>a data frame, a matrix or a vector containing observed data for the variable to chart. Each row of a data frame or a matrix, and each value of a vector, refers to a sample or &rdquo;rationale group&rdquo;.</p>
</td></tr>
<tr><td><code id="ewma_+3A_sizes">sizes</code></td>
<td>
<p>a value or a vector of values specifying the sample sizes associated with each group. If not provided the sample sizes are obtained counting the non-<code>NA</code> elements of each row of a data frame or a matrix; sample sizes are set all equal to one if <code>data</code> is a vector.</p>
</td></tr>
<tr><td><code id="ewma_+3A_center">center</code></td>
<td>
<p>a value specifying the center of group statistics or target.</p>
</td></tr>
<tr><td><code id="ewma_+3A_std.dev">std.dev</code></td>
<td>
<p>a value or an available method specifying the within-group standard deviation(s) of the process. <br />
Several methods are available for estimating the standard deviation. See <code><a href="#topic+sd.xbar">sd.xbar</a></code> and <code><a href="#topic+sd.xbar.one">sd.xbar.one</a></code> for, respectively, the grouped data case and the individual observations case.
</p>
</td></tr>
<tr><td><code id="ewma_+3A_lambda">lambda</code></td>
<td>
<p>the smoothing parameter <code class="reqn">0 \le \lambda \le 1</code></p>
</td></tr>
<tr><td><code id="ewma_+3A_nsigmas">nsigmas</code></td>
<td>
<p>a numeric value specifying the number of sigmas to use for computing control limits.</p>
</td></tr>
<tr><td><code id="ewma_+3A_data.name">data.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as data.</p>
</td></tr>
<tr><td><code id="ewma_+3A_labels">labels</code></td>
<td>
<p>a character vector of labels for each group.</p>
</td></tr>
<tr><td><code id="ewma_+3A_newdata">newdata</code></td>
<td>
<p>a data frame, matrix or vector, as for the <code>data</code> argument, providing further data to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="ewma_+3A_newsizes">newsizes</code></td>
<td>
<p>a vector as for the <code>sizes</code> argument providing further data sizes to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="ewma_+3A_newlabels">newlabels</code></td>
<td>
<p>a character vector of labels for each new group defined in the argument <code>newdata</code>.</p>
</td></tr>
<tr><td><code id="ewma_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> an EWMA chart is plotted.</p>
</td></tr>
<tr><td><code id="ewma_+3A_add.stats">add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and other information should be printed at the bottom of the chart.</p>
</td></tr>
<tr><td><code id="ewma_+3A_chart.all">chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td></tr>
<tr><td><code id="ewma_+3A_label.limits">label.limits</code></td>
<td>
<p>a character vector specifying the labels for control limits.</p>
</td></tr>
<tr><td><code id="ewma_+3A_title">title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td></tr>
<tr><td><code id="ewma_+3A_xlab">xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td></tr>
<tr><td><code id="ewma_+3A_ylab">ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td></tr>
<tr><td><code id="ewma_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="ewma_+3A_axes.las">axes.las</code></td>
<td>
<p>numeric in {0,1,2,3} specifying the style of axis labels. See <code>help(par)</code>.</p>
</td></tr>
<tr><td><code id="ewma_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use.</p>
</td></tr>
<tr><td><code id="ewma_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ewma_+3A_object">object</code></td>
<td>
<p>an object of class 'ewma.qcc'.</p>
</td></tr>
<tr><td><code id="ewma_+3A_x">x</code></td>
<td>
<p>an object of class 'ewma.qcc'.</p>
</td></tr>
<tr><td><code id="ewma_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>EWMA chart smooths a series of data based on a moving average with weights which decay exponentially. Useful to detect small and permanent variation on the mean of the process.
</p>


<h3>Value</h3>

<p>Returns an object of class 'ewma.qcc'.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code>, <code><a href="#topic+ewmaSmooth">ewmaSmooth</a></code>, <code><a href="#topic+cusum">cusum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Grouped-data
##
data(pistonrings)
attach(pistonrings)
diameter &lt;- qcc.groups(diameter, sample)

q &lt;- ewma(diameter[1:25,], lambda=0.2, nsigmas=3)
summary(q)

q &lt;-  ewma(diameter[1:25,], lambda=0.2, nsigmas=2.7, newdata=diameter[26:40,], plot = FALSE) 
summary(q)
plot(q)

detach(pistonrings)

##
## Individual observations: viscosity data (Montgomery, pag. 242)
##
x &lt;- c(33.75, 33.05, 34, 33.81, 33.46, 34.02, 33.68, 
33.27, 33.49, 33.20, 33.62, 33.00, 33.54, 33.12, 33.84)
q &lt;-  ewma(x, lambda=0.2, nsigmas=2.7)
summary(q)
</code></pre>

<hr>
<h2 id='ewmaSmooth'>EWMA smoothing function</h2><span id='topic+ewmaSmooth'></span>

<h3>Description</h3>

<p>Compute Exponential Weighted Moving Average.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ewmaSmooth(x, y, lambda = 0.2, start, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ewmaSmooth_+3A_x">x</code></td>
<td>
<p>a vector of x-values.</p>
</td></tr>
<tr><td><code id="ewmaSmooth_+3A_y">y</code></td>
<td>
<p>a vector of y-values.</p>
</td></tr>
<tr><td><code id="ewmaSmooth_+3A_lambda">lambda</code></td>
<td>
<p>the smoothing parameter.</p>
</td></tr>
<tr><td><code id="ewmaSmooth_+3A_start">start</code></td>
<td>
<p>the starting value.</p>
</td></tr>
<tr><td><code id="ewmaSmooth_+3A_...">...</code></td>
<td>
<p>additional arguments (currently not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>EWMA function smooths a series of data based on a moving average with weights which decay exponentially.
</p>
<p>For each <code class="reqn">y_t</code> value the smoothed value is computed as
</p>
<p style="text-align: center;"><code class="reqn">z_t = \lambda y_t + (1-\lambda) z_{t-1}</code>
</p>

<p>where <code class="reqn">0 \le \lambda \le 1</code> is the parameter which controls the weights applied.
</p>


<h3>Value</h3>

<p>Returns a list with elements:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>ordered x-values</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>smoothed y-values</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the smoothing parameter</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>the starting value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code>, <code><a href="#topic+cusum">cusum</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:50
y &lt;- rnorm(50, sin(x/5), 0.5)
plot(x,y)
lines(ewmaSmooth(x,y,lambda=0.1), col="red")
</code></pre>

<hr>
<h2 id='mqcc'>Multivariate Quality Control Charts</h2><span id='topic+mqcc'></span><span id='topic+print.mqcc'></span><span id='topic+summary.mqcc'></span><span id='topic+plot.mqcc'></span>

<h3>Description</h3>

<p>Create an object of class 'mqcc' to perform multivariate statistical quality control.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mqcc(data, type = c("T2", "T2.single"), center, cov,
     limits = TRUE, pred.limits = FALSE,
     data.name, labels, newdata, newlabels, 
     confidence.level = (1 - 0.0027)^p, rules = shewhart.rules,
     plot = TRUE, ...)

## S3 method for class 'mqcc'
print(x, ...)

## S3 method for class 'mqcc'
summary(object, digits = getOption("digits"), ...)

## S3 method for class 'mqcc'
plot(x, add.stats = TRUE, chart.all = TRUE,
     label.limits = c("LCL", "UCL"), label.pred.limits = c("LPL", "UPL"),
     title, xlab, ylab, ylim, axes.las = 0, 
     digits = getOption("digits"), restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mqcc_+3A_data">data</code></td>
<td>
<p>For subgrouped data, a list with a data frame or a matrix for each variable to monitor. Each row of the data frame or matrix refers to a sample or &rdquo;rationale&rdquo; group. 
For individual observations, where each sample has a single observation, users can provide a list with a data frame or a matrix having a single column, or a data frame or a matrix where each rows refer to samples and columns to variables. See examples.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_type">type</code></td>
<td>
<p>a character string specifying the type of chart:
</p>

<table>
<tr>
 <td style="text-align: left;">
            </td><td style="text-align: left;"> Chart description </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"T2"</code> </td><td style="text-align: left;"> Hotelling <code class="reqn">T^2</code> chart for subgrouped data </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"T2.single"</code> </td><td style="text-align: left;"> Hotelling <code class="reqn">T^2</code> chart for individual observations </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

</td></tr>
<tr><td><code id="mqcc_+3A_center">center</code></td>
<td>
<p>a vector of values to use for center of input variables.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_cov">cov</code></td>
<td>
<p>a matrix of values to use for the covariance matrix of input variables.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_limits">limits</code></td>
<td>
<p>a logical indicating if control limits (Phase I) must be computed (by default using <code><a href="#topic+limits.T2">limits.T2</a></code> or <code><a href="#topic+limits.T2.single">limits.T2.single</a></code>) and plotted, or a two-values vector specifying control limits.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_pred.limits">pred.limits</code></td>
<td>
<p>a logical indicating if prediction limits (Phase II) must be computed (by default using <code><a href="#topic+limits.T2">limits.T2</a></code> or <code><a href="#topic+limits.T2.single">limits.T2.single</a></code>) and plotted, or a two-values vector specifying prediction limits.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_data.name">data.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as data.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_labels">labels</code></td>
<td>
<p>a character vector of labels for each group.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_newdata">newdata</code></td>
<td>
<p>a data frame, matrix or vector, as for the <code>data</code> argument, providing further data to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_newlabels">newlabels</code></td>
<td>
<p>a character vector of labels for each new group defined in the argument <code>newdata</code>.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_confidence.level">confidence.level</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the confidence level of the computed probability limits. 
By default is set at <code class="reqn">(1 - 0.0027)^p</code> where <code class="reqn">p</code> is the number of variables, and <code class="reqn">0.0027</code> is the probability of Type I error for a single Shewhart chart at the usual 3-sigma control level.</p>
</td></tr> 
<tr><td><code id="mqcc_+3A_rules">rules</code></td>
<td>
<p>a function of rules to apply to the chart. By default, the <code>shewhart.rules</code> function is used.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> a quality chart is plotted.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_add.stats">add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and other information should be printed at the bottom of the chart.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_chart.all">chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_label.limits">label.limits</code></td>
<td>
<p>a character vector specifying the labels for control limits (Phase I).</p>
</td></tr>
<tr><td><code id="mqcc_+3A_label.pred.limits">label.pred.limits</code></td>
<td>
<p>a character vector specifying the labels for prediction  control limits (Phase II).</p>
</td></tr>
<tr><td><code id="mqcc_+3A_title">title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_xlab">xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_ylab">ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_axes.las">axes.las</code></td>
<td>
<p>numeric in {0,1,2,3} specifying the style of axis labels. See <code>help(par)</code>.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when <code>add.stats = TRUE</code>.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_object">object</code></td>
<td>
<p>an object of class 'mqcc'.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_x">x</code></td>
<td>
<p>an object of class 'mqcc'.</p>
</td></tr>
<tr><td><code id="mqcc_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Returns an object of class 'mqcc'.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stats.T2">stats.T2</a></code>, <code><a href="#topic+stats.T2.single">stats.T2.single</a></code>, <code><a href="#topic+limits.T2">limits.T2</a></code>, <code><a href="#topic+limits.T2.single">limits.T2.single</a></code>, <code><a href="#topic+ellipseChart">ellipseChart</a></code>, <code><a href="#topic+qcc">qcc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
##  Subgrouped data
##

# Ryan (2000, Table 9.2) data with p = 2 variables, m = 20 samples, n = 4 sample size:
X1 &lt;- matrix(c(72, 56, 55, 44, 97, 83, 47, 88, 57, 26, 46, 
49, 71, 71, 67, 55, 49, 72, 61, 35, 84, 87, 73, 80, 26, 89, 66, 
50, 47, 39, 27, 62, 63, 58, 69, 63, 51, 80, 74, 38, 79, 33, 22, 
54, 48, 91, 53, 84, 41, 52, 63, 78, 82, 69, 70, 72, 55, 61, 62, 
41, 49, 42, 60, 74, 58, 62, 58, 69, 46, 48, 34, 87, 55, 70, 94, 
49, 76, 59, 57, 46), ncol = 4)
X2 &lt;- matrix(c(23, 14, 13, 9, 36, 30, 12, 31, 14, 7, 10, 
11, 22, 21, 18, 15, 13, 22, 19, 10, 30, 31, 22, 28, 10, 35, 18, 
11, 10, 11, 8, 20, 16, 19, 19, 16, 14, 28, 20, 11, 28, 8, 6, 
15, 14, 36, 14, 30, 8, 35, 19, 27, 31, 17, 18, 20, 16, 18, 16, 
13, 10, 9, 16, 25, 15, 18, 16, 19, 10, 30, 9, 31, 15, 20, 35, 
12, 26, 17, 14, 16), ncol = 4)
X &lt;- list(X1 = X1, X2 = X2)

q &lt;- mqcc(X, type = "T2")
summary(q)
ellipseChart(q)
ellipseChart(q, show.id = TRUE)

q &lt;- mqcc(X, type = "T2", pred.limits = TRUE)

# Ryan (2000) discussed Xbar-charts for single variables computed adjusting the 
# confidence level of the T^2 chart:
q1 &lt;- qcc(X1, type = "xbar", confidence.level = q$confidence.level^(1/2))
summary(q1)
q2 &lt;- qcc(X2, type = "xbar", confidence.level = q$confidence.level^(1/2))
summary(q2)


require(MASS)
# generate new "in control" data
Xnew &lt;- list(X1 = matrix(NA, 10, 4), X2 =  matrix(NA, 10, 4))
for(i in 1:4)
   { x &lt;- mvrnorm(10, mu = q$center, Sigma = q$cov)
     Xnew$X1[,i] &lt;- x[,1]
     Xnew$X2[,i] &lt;- x[,2] 
   }
qq &lt;- mqcc(X, type = "T2", newdata = Xnew, pred.limits = TRUE)
summary(qq)

# generate new "out of control" data
Xnew &lt;- list(X1 = matrix(NA, 10, 4), X2 =  matrix(NA, 10, 4))
for(i in 1:4)
   { x &lt;- mvrnorm(10, mu = 1.2*q$center, Sigma = q$cov)
     Xnew$X1[,i] &lt;- x[,1]
     Xnew$X2[,i] &lt;- x[,2] 
   }
qq &lt;- mqcc(X, type = "T2", newdata = Xnew, pred.limits = TRUE)
summary(qq)

##
## Individual observations data
##

data(boiler)

q &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999)
summary(q)

# generate new "in control" data
boilerNew &lt;- mvrnorm(10, mu = q$center, Sigma = q$cov)
qq &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999, 
           newdata = boilerNew, pred.limits = TRUE)
summary(qq)

# generate new "out of control" data
boilerNew = mvrnorm(10, mu = 1.01*q$center, Sigma = q$cov)
qq &lt;- mqcc(boiler, type = "T2.single", confidence.level = 0.999, 
           newdata = boilerNew, pred.limits = TRUE)
summary(qq)

# provides "robust" estimates of means and covariance matrix
library(MASS)
rob &lt;- cov.rob(boiler)
qrob &lt;- mqcc(boiler, type = "T2.single", center = rob$center, cov = rob$cov)
summary(qrob)

</code></pre>

<hr>
<h2 id='oc.curves'>Operating Characteristic Function</h2><span id='topic+oc.curves'></span><span id='topic+oc.curves.xbar'></span><span id='topic+oc.curves.R'></span><span id='topic+oc.curves.S'></span><span id='topic+oc.curves.p'></span><span id='topic+oc.curves.c'></span>

<h3>Description</h3>

<p>Draws the operating characteristic curves for a 'qcc' object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>oc.curves(object, ...)

oc.curves.xbar(object, n, c = seq(0, 5, length=101), 
               nsigmas = object$nsigmas, identify=FALSE, restore.par=TRUE)

oc.curves.R(object, n, c = seq(1, 6, length=101),
            nsigmas = object$nsigmas, identify = FALSE, restore.par=TRUE)

oc.curves.S(object, n, c = seq(1, 6, length=101),
            nsigmas = object$nsigmas, identify = FALSE, restore.par=TRUE)

oc.curves.p(object, nsigmas = object$nsigmas, identify = FALSE, restore.par=TRUE)

oc.curves.c(object, nsigmas = object$nsigmas, identify = FALSE, restore.par=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oc.curves_+3A_object">object</code></td>
<td>
<p>an object of class 'qcc'.</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_identify">identify</code></td>
<td>
<p>logical specifying whether to interactively identify points on the plot (see help for <code><a href="graphics.html#topic+identify">identify</a></code>).</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_n">n</code></td>
<td>
<p>a vector of values specifying the sample sizes for which to draw the OC curves.</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_c">c</code></td>
<td>
<p>a vector of values specifying the multipliers for sigma in case of continuous variable.</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_nsigmas">nsigmas</code></td>
<td>
<p>a numeric value specifying the number of sigmas to use for
computing control limits; if <code>nsigmas</code> is <code>NULL</code>,
<code>object$conf</code> is used to set up probability limits; <code>nsigmas</code>
is ignored for types &quot;p&quot; and &quot;c&quot;.</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="oc.curves_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An operating characteristic curve graphically provides information about the probability of not detecting a shift in the process. <code>oc.curves</code> is a generic function which calls the proper function depending on the type of 'qcc' object. Further arguments provided through ... are passed to the specific function depending on the type of chart.
</p>
<p>The probabilities are based on the conventional assumptions about
process distributions: the normal distribution for &quot;xbar&quot; , &quot;R&quot;, and &quot;S&quot;,
the binomial distribution for &quot;p&quot; and &quot;np&quot;, and the Poisson distribution
for &quot;c&quot; and &quot;u&quot;. They are all sensitive to departures from those assumptions,
but to varying degrees. The performance of the &quot;S&quot; chart, and especially
the &quot;R&quot; chart,
are likely to be seriously affected by longer tails.</p>


<h3>Value</h3>

<p>The function invisibly returns a matrix or a vector of beta values, the probability of type II error.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pistonrings)
attach(pistonrings)
diameter &lt;- qcc.groups(diameter, sample)
beta &lt;- oc.curves.xbar(qcc(diameter, type="xbar", nsigmas=3, plot=FALSE))
print(round(beta, digits=4))
# or to identify points on the plot use
## Not run: oc.curves.xbar(qcc(diameter, type="xbar", nsigmas=3, plot=FALSE), identify=TRUE)
detach(pistonrings)

data(orangejuice)
attach(orangejuice)
beta &lt;- oc.curves(qcc(D[trial], sizes=size[trial], type="p", plot=FALSE))
print(round(beta, digits=4))
# or to identify points on the plot use
## Not run: oc.curves(qcc(D[trial], sizes=size[trial], type="p", plot=FALSE), identify=TRUE)
detach(orangejuice)

data(circuit)
attach(circuit)
q &lt;- qcc(x[trial], sizes=size[trial], type="c", plot=FALSE)
beta &lt;- oc.curves(q)
print(round(beta, digits=4))
# or to identify points on the plot use
## Not run: oc.curves(qcc(x[trial], sizes=size[trial], type="c", plot=FALSE), identify=TRUE)
detach(circuit)
</code></pre>

<hr>
<h2 id='orangejuice'>Orange juice data</h2><span id='topic+orangejuice'></span>

<h3>Description</h3>

<p>Frozen orange juice concentrate is packed in 6-oz cardboard cans. These cans are formed on a machine by spinning them from cardboard stock and attaching a metal bottom panel. A can is then inspected to determine whether, when filled, the liquid could possible leak either on the side seam or around the bottom joint. If this occurs, a can is considered nonconforming.
The data were collected as 30 samples of 50 cans each at half-hour intervals over a three-shift period in which the machine was in continuous operation.
From sample 15 used a new batch of cardboard stock was punt into production.
Sample 23 was obtained when an inexperienced operator was temporarily assigned to the machine.
After the first 30 samples, a machine adjustment was made. Then further 24 samples were taken from the process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(orangejuice)</code></pre>


<h3>Format</h3>

<p>A data frame with 54 observations on the following 4 variables:
</p>
<dl>
<dt>sample</dt><dd><p>sample id</p>
</dd>
<dt>D</dt><dd><p>number of defectives</p>
</dd>
<dt>size</dt><dd><p>sample sizes</p>
</dd>
<dt>trial</dt><dd><p>trial samples (TRUE/FALSE)</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 152&ndash;155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(orangejuice)
orangejuice$d &lt;- orangejuice$D/orangejuice$size
attach(orangejuice)
summary(orangejuice)
boxplot(d ~ trial)
mark &lt;- ifelse(trial, 1, 2)
plot(sample, d, type="b", col=mark, pch=mark)
detach(orangejuice)
</code></pre>

<hr>
<h2 id='orangejuice2'>Orange juice data &ndash;  Part 2</h2><span id='topic+orangejuice2'></span>

<h3>Description</h3>

<p>A full description of the problem is given in <code><a href="#topic+orangejuice">orangejuice</a></code>. <br />
</p>
<p>This dataset contains samples taken after the machine adjustment was made. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(orangejuice)</code></pre>


<h3>Format</h3>

<p>A data frame with 64 observations on the following 4 variables:
</p>
<dl>
<dt>sample</dt><dd><p>sample id</p>
</dd>
<dt>D</dt><dd><p>number of defectives</p>
</dd>
<dt>size</dt><dd><p>sample sizes</p>
</dd>
<dt>trial</dt><dd><p>trial samples (TRUE/FALSE)</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 155&ndash;159.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(orangejuice2)
orangejuice2$d &lt;- orangejuice2$D/orangejuice2$size
attach(orangejuice2)
summary(orangejuice2)
boxplot(d ~ trial)
mark &lt;- ifelse(trial, 1, 2)
plot(sample, d, type="b", col=mark, pch=mark)
detach(orangejuice2)
</code></pre>

<hr>
<h2 id='pareto.chart'>Pareto chart</h2><span id='topic+pareto.chart'></span><span id='topic+print.pareto.chart'></span><span id='topic+plot.pareto.chart'></span><span id='topic+blues.colors'></span>

<h3>Description</h3>

<p>Computes a table of statistics and plot a Pareto chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pareto.chart(data, plot = TRUE, ...)

## S3 method for class 'pareto.chart'
plot(x, xlab = NULL, ylab = "Frequency", 
     ylab2 = "Cumulative Percentage", 
     cumperc = seq(0, 100, by = 25), 
     ylim = NULL, main = NULL,
     col = blues.colors(nlevels), 
     ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pareto.chart_+3A_data">data</code></td>
<td>
<p>a vector of values. <code>names(data)</code> are used for labelling the bars.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_plot">plot</code></td>
<td>
<p>a logical specifying if the chart should be provided (<code>TRUE</code>, default).</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_x">x</code></td>
<td>
<p>the object of class 'pareto.chart' returned by a call to <code>pareto.chart</code> function.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_xlab">xlab</code></td>
<td>
<p>a string specifying the label for the x-axis.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_ylab">ylab</code></td>
<td>
<p>a string specifying the label for the y-axis.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_ylab2">ylab2</code></td>
<td>
<p>a string specifying the label for the second y-axis on the right side.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_cumperc">cumperc</code></td>
<td>
<p>a vector of percentage values to be used as tickmarks for the second y-axis on the right side.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_main">main</code></td>
<td>
<p>a string specifying the main title to appear on the plot.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_col">col</code></td>
<td>
<p>a value for the color, a vector of colors, or a palette for the bars. See the help for <code>colors</code> and <code>palette</code>.</p>
</td></tr>
<tr><td><code id="pareto.chart_+3A_...">...</code></td>
<td>
<p>other graphical arguments to be passed to the corresponding <code>plot</code> method, and eventually to the <code>barplot</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Pareto chart is a barplot where the categories are ordered in non increasing order, and a line is also added to show the cumulative sum.</p>


<h3>Value</h3>

<p>Returns an object of class 'pareto.chart' containing the descriptive statistics used to draw the Pareto chart. This object has associated a <code>print</code> and <code>plot</code> mehod.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+barplot">barplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>defect &lt;- c(80, 27, 66, 94, 33)
names(defect) &lt;- c("price code", "schedule date", "supplier code", "contact num.", "part num.")
pareto.chart(defect, ylab = "Error frequency")
pareto.chart(defect, ylab = "Error frequency", xlab = "Error causes", las=1)
pareto.chart(defect, ylab = "Error frequency", col=rainbow(length(defect)))
pareto.chart(defect, cumperc = seq(0, 100, by = 5), ylab2 = "A finer tickmarks grid")
</code></pre>

<hr>
<h2 id='pcmanufact'>Personal computer manufacturer data</h2><span id='topic+pcmanufact'></span>

<h3>Description</h3>

<p>A personal computer manufacturer counts the number of nonconformities per unit on the final assembly line. He collects data on 20 samples of 5 computers each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pcmanufact)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 2 variables.
</p>

<dl>
<dt>x</dt><dd><p>number of nonconformities (inspection units)</p>
</dd>
<dt>size</dt><dd><p>number of computers inspected</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 181&ndash;182</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pcmanufact)
attach(pcmanufact)
summary(pcmanufact)
plot(x/size, type="b")
detach(pcmanufact)
</code></pre>

<hr>
<h2 id='pistonrings'>Piston rings data</h2><span id='topic+pistonrings'></span>

<h3>Description</h3>

<p>Piston rings for an automotive engine are produced by a forging process. The inside diameter of the rings manufactured by the process is measured on 25 samples, each of size 5, for the control phase I, when preliminary samples from a process being considered 'in control' are used to construct control charts. Then, further 15 samples, again each of size 5, are obtained for phase II.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pistonrings)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 3 variables.
</p>

<dl>
<dt>diameter</dt><dd><p>a numeric vector</p>
</dd>
<dt>sample</dt><dd><p>sample ID</p>
</dd>
<dt>trial</dt><dd><p>preliminary sample indicator (TRUE/FALSE)</p>
</dd>
</dl>



<h3>References</h3>

<p>Montgomery, D.C. (1991) <em>Introduction to Statistical Quality Control</em>, 2nd ed, New York, John Wiley &amp; Sons, pp. 206&ndash;213</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pistonrings)
attach(pistonrings)
summary(pistonrings)
boxplot(diameter ~ sample)
plot(sample, diameter, cex=0.7)
lines(tapply(diameter,sample,mean))
detach(pistonrings)
</code></pre>

<hr>
<h2 id='process.capability'>Process capability analysis</h2><span id='topic+process.capability'></span>

<h3>Description</h3>

<p>Computes process capability indices for a 'qcc' object of type <code>"xbar"</code> and plot the histogram.</p>


<h3>Usage</h3>

<pre><code class='language-R'>process.capability(object,spec.limits, target, std.dev, nsigmas, 
                   confidence.level = 0.95, breaks = "scott", 
                   add.stats = TRUE, print = TRUE, 
                   digits = getOption("digits"), restore.par = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process.capability_+3A_object">object</code></td>
<td>
<p>a 'qcc' object of type <code>"xbar"</code></p>
</td></tr>
<tr><td><code id="process.capability_+3A_spec.limits">spec.limits</code></td>
<td>
<p>a two-values vector specifying the lower and upper specification limits. For one-sided specification limits, the value of the missing limit must be set to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_target">target</code></td>
<td>
<p>a value specifying the target of the process. If missing the value from the 'qcc' object is used if not <code>NULL</code>, otherwise the target is set at the middle value bewteen specification limits.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_std.dev">std.dev</code></td>
<td>
<p>a value specifying the within-group standard deviation. If not provided is taken from the 'qcc' object.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_nsigmas">nsigmas</code></td>
<td>
<p>a numeric value specifying the number of sigmas to use. If not provided is taken from the 'qcc' object.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_confidence.level">confidence.level</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the level to use for computing confidence intervals.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_breaks">breaks</code></td>
<td>
<p>a value or string used to draw the histogram. See the help for  <code><a href="graphics.html#topic+hist">hist</a></code> for more details. </p>
</td></tr>
<tr><td><code id="process.capability_+3A_add.stats">add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and capability indices should be added at the bottom of the chart.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_print">print</code></td>
<td>
<p>a logical value indicating whether statistics and capability indices should be printed.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use.</p>
</td></tr>
<tr><td><code id="process.capability_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a chart set this to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates confidence limits for <code class="reqn">C_p</code> using the method described by Chou et al. (1990). 
Approximate confidence limits for <code class="reqn">C_{pl}</code>, <code class="reqn">C_{pu}</code> and  <code class="reqn">C_{pk}</code> are computed using the method in Bissell (1990).  
Confidence limits for <code class="reqn">C_{pm}</code> are based on the method of Boyles (1991); this method is approximate and it assumes that the target is midway between the specification limits.
</p>


<h3>Value</h3>

<p>Invisibly returns a list with components:
</p>
<table>
<tr><td><code>nobs</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>center</p>
</td></tr>
<tr><td><code>std.dev</code></td>
<td>
<p>standard deviation</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>target</p>
</td></tr>
<tr><td><code>spec.limits</code></td>
<td>
<p>a vector of values giving the lower specification limit (LSL) and the upper specification limit (USL)</p>
</td></tr>
<tr><td><code>indices</code></td>
<td>
<p>a matrix of capability indices (<code class="reqn">C_p</code>, <code class="reqn">C_{pl}</code>, <code class="reqn">C_{pu}</code>, <code class="reqn">C_{pk}</code>, <code class="reqn">C_{pm}</code>) and the corresponding confidence limits.</p>
</td></tr>
<tr><td><code>exp</code></td>
<td>
<p>a vector of values giving the expected fraction, based on a normal approximation, of the observations less than LSL and greater than USL.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>a vector of values giving the fraction of observations less than LSL and greater than USL.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Bissell, A.F. (1990) <em>How reliable is your capability index?</em>, Applied Statistics, 39, 331-340. <br />
Boyles, R.A. (1991) <em>The Taguchi capability index</em>, Journal of Quality Technology, 23, 107-126. <br />
Chou, Y., Owen D.B. and Borrego S.A. (1990) <em>Lower Confidence Limits on Process Capability Indices</em>, Journal of Quality Technology, 22, 223-229. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pistonrings)
attach(pistonrings)
diameter &lt;- qcc.groups(diameter, sample)
q &lt;- qcc(diameter[1:25,], type="xbar", nsigmas=3, plot=FALSE)
process.capability(q, spec.limits=c(73.95,74.05))
process.capability(q, spec.limits=c(73.95,74.05), target=74.02)
process.capability(q, spec.limits=c(73.99,74.01))
process.capability(q, spec.limits = c(73.99, 74.1))
</code></pre>

<hr>
<h2 id='qcc'>Quality Control Charts</h2><span id='topic+qcc'></span><span id='topic+print.qcc'></span><span id='topic+summary.qcc'></span><span id='topic+plot.qcc'></span>

<h3>Description</h3>

<p>Create an object of class 'qcc' to perform statistical quality control. This object may then be used to plot Shewhart charts, drawing OC curves, computes capability indices, and more.</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcc(data, type, sizes, center, std.dev, limits,
    data.name, labels, newdata, newsizes, newdata.name,
    newlabels, nsigmas = 3, confidence.level,
    rules = shewhart.rules, plot = TRUE, ...)

## S3 method for class 'qcc'
print(x, ...)

## S3 method for class 'qcc'
summary(object, digits = getOption("digits"), ...)

## S3 method for class 'qcc'
plot(x, add.stats = TRUE, chart.all = TRUE, 
     label.limits = c("LCL ", "UCL"), title, xlab, ylab, ylim, 
     axes.las = 0, digits = getOption("digits"),
     restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcc_+3A_data">data</code></td>
<td>
<p>a data frame, a matrix or a vector containing observed data for
the variable to chart. Each row of a data frame or a matrix, and each
value of a vector, refers to a sample or &rdquo;rationale group&rdquo;.</p>
</td></tr>
<tr><td><code id="qcc_+3A_type">type</code></td>
<td>
<p>a character string specifying the group statistics to compute. <br />
Available methods are:
</p>

<table>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> Statistic charted   </td><td style="text-align: left;"> Chart description </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"xbar"</code> </td><td style="text-align: left;"> mean                </td><td style="text-align: left;"> means of a continuous process variable </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"R"</code>    </td><td style="text-align: left;"> range               </td><td style="text-align: left;"> ranges of a continuous process variable </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"S"</code>    </td><td style="text-align: left;"> standard deviation  </td><td style="text-align: left;"> standard deviations of a continuous variable </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"xbar.one"</code> </td><td style="text-align: left;"> mean            </td><td style="text-align: left;"> one-at-time data of a continuous process variable </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"p"</code>    </td><td style="text-align: left;"> proportion          </td><td style="text-align: left;"> proportion of nonconforming units </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"np"</code>   </td><td style="text-align: left;"> count               </td><td style="text-align: left;"> number of nonconforming units </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"c"</code>    </td><td style="text-align: left;"> count               </td><td style="text-align: left;"> nonconformities per unit </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"u"</code>    </td><td style="text-align: left;"> count               </td><td style="text-align: left;"> average nonconformities per unit </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"g"</code>    </td><td style="text-align: left;"> count               </td><td style="text-align: left;"> number of non-events between events
</td>
</tr>

</table>

<p>Furthermore, a user specified type of chart, say <code>"newchart"</code>, can be provided. This requires the definition of <code>"stats.newchart"</code>, <code>"sd.newchart"</code>, and <code>"limits.newchart"</code>. As an example, see <code><a href="#topic+stats.xbar">stats.xbar</a></code>.
</p>
</td></tr>
<tr><td><code id="qcc_+3A_sizes">sizes</code></td>
<td>
<p>a value or a vector of values specifying the sample sizes associated with each group. For continuous data provided as data frame or matrix the sample sizes are obtained counting the non-<code>NA</code> elements of each row. For <code>"p"</code>, <code>"np"</code> and <code>"u"</code> charts the argument <code>sizes</code> is required.</p>
</td></tr>
<tr><td><code id="qcc_+3A_center">center</code></td>
<td>
<p>a value specifying the center of group statistics or the &rdquo;target&rdquo; value of the process.</p>
</td></tr>
<tr><td><code id="qcc_+3A_std.dev">std.dev</code></td>
<td>
<p>a value or an available method specifying the within-group standard deviation(s) of the process. <br />
Several methods are available for estimating the standard deviation in case of a continuous process variable; see <code><a href="#topic+sd.xbar">sd.xbar</a></code>, <code><a href="#topic+sd.xbar.one">sd.xbar.one</a></code>, <code><a href="#topic+sd.R">sd.R</a></code>, <code><a href="#topic+sd.S">sd.S</a></code>.
</p>
</td></tr>
<tr><td><code id="qcc_+3A_limits">limits</code></td>
<td>
<p>a two-values vector specifying control limits.</p>
</td></tr>
<tr><td><code id="qcc_+3A_data.name">data.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as data.</p>
</td></tr>
<tr><td><code id="qcc_+3A_labels">labels</code></td>
<td>
<p>a character vector of labels for each group.</p>
</td></tr>
<tr><td><code id="qcc_+3A_newdata">newdata</code></td>
<td>
<p>a data frame, matrix or vector, as for the <code>data</code> argument, providing further data to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="qcc_+3A_newsizes">newsizes</code></td>
<td>
<p>a vector as for the <code>sizes</code> argument providing further data sizes to plot but not included in the computations.</p>
</td></tr>
<tr><td><code id="qcc_+3A_newdata.name">newdata.name</code></td>
<td>
<p>a string specifying the name of the variable which appears on the plots. If not provided is taken from the object given as newdata.</p>
</td></tr>
<tr><td><code id="qcc_+3A_newlabels">newlabels</code></td>
<td>
<p>a character vector of labels for each new group defined in the argument <code>newdata</code>.</p>
</td></tr>
<tr><td><code id="qcc_+3A_nsigmas">nsigmas</code></td>
<td>
<p>a numeric value specifying the number of sigmas to use for computing control limits. It is ignored when the <code>confidence.level</code> argument is  provided.</p>
</td></tr> 
<tr><td><code id="qcc_+3A_confidence.level">confidence.level</code></td>
<td>
<p>a numeric value between 0 and 1 specifying the confidence level of the computed probability limits.</p>
</td></tr> 
<tr><td><code id="qcc_+3A_rules">rules</code></td>
<td>
<p>a function of rules to apply to the chart. By default, the <code>shewhart.rules</code> function is used.</p>
</td></tr>
<tr><td><code id="qcc_+3A_plot">plot</code></td>
<td>
<p>logical. If <code>TRUE</code> a Shewhart chart is plotted.</p>
</td></tr>
<tr><td><code id="qcc_+3A_add.stats">add.stats</code></td>
<td>
<p>a logical value indicating whether statistics and other information should be printed at the bottom of the chart.</p>
</td></tr>
<tr><td><code id="qcc_+3A_chart.all">chart.all</code></td>
<td>
<p>a logical value indicating whether both statistics for <code>data</code> and for <code>newdata</code> (if given) should be plotted.</p>
</td></tr>
<tr><td><code id="qcc_+3A_label.limits">label.limits</code></td>
<td>
<p>a character vector specifying the labels for control limits.</p>
</td></tr>
<tr><td><code id="qcc_+3A_title">title</code></td>
<td>
<p>a string giving the label for the main title.</p>
</td></tr>
<tr><td><code id="qcc_+3A_xlab">xlab</code></td>
<td>
<p>a string giving the label for the x-axis.</p>
</td></tr>
<tr><td><code id="qcc_+3A_ylab">ylab</code></td>
<td>
<p>a string giving the label for the y-axis.</p>
</td></tr>
<tr><td><code id="qcc_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector specifying the limits for the y-axis.</p>
</td></tr>
<tr><td><code id="qcc_+3A_axes.las">axes.las</code></td>
<td>
<p>numeric in {0,1,2,3} specifying the style of axis labels. See <code>help(par)</code>.</p>
</td></tr>
<tr><td><code id="qcc_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use.</p>
</td></tr>
<tr><td><code id="qcc_+3A_restore.par">restore.par</code></td>
<td>
<p>a logical value indicating whether the previous <code>par</code> settings must be restored. If you need to add points, lines, etc. to a control chart set this to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="qcc_+3A_object">object</code></td>
<td>
<p>an object of class 'qcc'.</p>
</td></tr>
<tr><td><code id="qcc_+3A_x">x</code></td>
<td>
<p>an object of class 'qcc'.</p>
</td></tr>
<tr><td><code id="qcc_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the generic function.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>Returns an object of class 'qcc'.</p>


<h3>Note</h3>

<p>For a nice blog post discussing the <code>qcc</code> package, in particular how to implement the <em>Western Eletric Rules (WER)</em>, see <a href="http://blog.yhathq.com/posts/quality-control-in-r.html">http://blog.yhathq.com/posts/quality-control-in-r.html</a>.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc. <br />
Scrucca, L. (2004). qcc: an R package for quality control charting and statistical process control. <em>R News</em> 4/1, 11-17. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shewhart.rules">shewhart.rules</a></code>, <code><a href="#topic+cusum">cusum</a></code>, <code><a href="#topic+ewma">ewma</a></code>, <code><a href="#topic+oc.curves">oc.curves</a></code>, <code><a href="#topic+process.capability">process.capability</a></code>, <code><a href="#topic+qcc.groups">qcc.groups</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>##
##  Continuous data 
##
data(pistonrings)
attach(pistonrings)
diameter &lt;- qcc.groups(diameter, sample)

qcc(diameter[1:25,], type="xbar")
qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,])
q &lt;- qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,], plot=FALSE)
plot(q, chart.all=FALSE)
qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,], nsigmas=2)
qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,], confidence.level=0.99)

qcc(diameter[1:25,], type="R")
qcc(diameter[1:25,], type="R", newdata=diameter[26:40,])

qcc(diameter[1:25,], type="S")
qcc(diameter[1:25,], type="S", newdata=diameter[26:40,])

# add warning limits at 2 std. deviations
q &lt;- qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,], plot=FALSE)
(warn.limits &lt;- limits.xbar(q$center, q$std.dev, q$sizes, 2))
plot(q, restore.par = FALSE)
abline(h = warn.limits, lty = 3, col = "chocolate")

# variable control limits
out &lt;- c(9, 10, 30, 35, 45, 64, 65, 74, 75, 85, 99, 100)
diameter &lt;- qcc.groups(pistonrings$diameter[-out], sample[-out])
qcc(diameter[1:25,], type="xbar")
qcc(diameter[1:25,], type="R")
qcc(diameter[1:25,], type="S")
qcc(diameter[1:25,], type="xbar", newdata=diameter[26:40,])
qcc(diameter[1:25,], type="R", newdata=diameter[26:40,])
qcc(diameter[1:25,], type="S", newdata=diameter[26:40,])

detach(pistonrings)

##
##  Attribute data 
##

data(orangejuice)
attach(orangejuice)
qcc(D[trial], sizes=size[trial], type="p")

# remove out-of-control points (see help(orangejuice) for the reasons)
inc &lt;- setdiff(which(trial), c(15,23))
q1 &lt;- qcc(D[inc], sizes=size[inc], type="p")
qcc(D[inc], sizes=size[inc], type="p", newdata=D[!trial], newsizes=size[!trial]) 
detach(orangejuice)

data(orangejuice2)
attach(orangejuice2)
names(D) &lt;- sample
qcc(D[trial], sizes=size[trial], type="p")
q2 &lt;- qcc(D[trial], sizes=size[trial], type="p", newdata=D[!trial], newsizes=size[!trial])
detach(orangejuice2)

# put on the same graph the two orange juice samples
oldpar &lt;- par(no.readonly = TRUE)
par(mfrow=c(1,2), mar=c(5,5,3,0))
plot(q1, title="First samples", ylim=c(0,0.5), add.stats=FALSE, restore.par=FALSE)
par("mar"=c(5,0,3,3), yaxt="n")
plot(q2, title="Second samples", add.stats=FALSE, ylim=c(0,0.5))
par(oldpar)

data(circuit)
attach(circuit)
qcc(x[trial], sizes=size[trial], type="c")
# remove out-of-control points (see help(circuit) for the reasons)
inc &lt;- setdiff(which(trial), c(6,20))
qcc(x[inc], sizes=size[inc], type="c", labels=inc)
qcc(x[inc], sizes=size[inc], type="c", labels=inc, 
    newdata=x[!trial], newsizes=size[!trial], newlabels=which(!trial))
qcc(x[inc], sizes=size[inc], type="u", labels=inc, 
    newdata=x[!trial], newsizes=size[!trial], newlabels=which(!trial))
detach(circuit)

data(pcmanufact)
attach(pcmanufact)
qcc(x, sizes=size, type="u")
detach(pcmanufact)

data(dyedcloth)
attach(dyedcloth)
qcc(x, sizes=size, type="u")
# standardized control chart
q &lt;- qcc(x, sizes=size, type="u", plot=FALSE)
z &lt;- (q$statistics - q$center)/sqrt(q$center/q$size)
plot(z,  type="o", ylim=range(z,3,-3), pch=16)
abline(h=0, lty=2)
abline(h=c(-3,3), lty=2)
detach(dyedcloth)

##
##  Continuous one-at-time data 
##

# viscosity data (Montgomery, pag. 242)
x &lt;- c(33.75, 33.05, 34, 33.81, 33.46, 34.02, 33.68, 33.27, 33.49, 33.20,
       33.62, 33.00, 33.54, 33.12, 33.84)
qcc(x, type="xbar.one")
qcc(x, type="xbar.one", std.dev = "SD")
</code></pre>

<hr>
<h2 id='qcc-internal'>Internal 'qcc' functions</h2><span id='topic+.printShortMatrix'></span><span id='topic+.qcc.options'></span>

<h3>Description</h3>

<p>Internal functions for package 'qcc'.</p>


<h3>Usage</h3>

<pre><code class='language-R'>.printShortMatrix(x, head = 2, tail = 1, chead = 5, ctail = 1, ...)
</code></pre>


<h3>Details</h3>

<p>These functions are not intended to be called by the user.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>

<hr>
<h2 id='qcc.groups'>Grouping data based on a sample indicator</h2><span id='topic+qcc.groups'></span>

<h3>Description</h3>

<p>This function allows to easily group data to use as input to the 'qcc' function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcc.groups(data, sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcc.groups_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="qcc.groups_+3A_sample">sample</code></td>
<td>
<p>the sample indicators for the data values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a matrix of suitable dimensions. If one or more group have few observations than others, <code>NA</code> values are appended.
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pistonrings)
attach(pistonrings)
# 40 sample of 5 obs each
qcc.groups(diameter, sample)
# some obs are removed, the result is still a 40x5 matrix but with NAs added
qcc.groups(diameter[-c(1,2,50,52, 199)], sample[-c(1,2,50,52, 199)])
</code></pre>

<hr>
<h2 id='qcc.options'>Set or return options for the 'qcc' package.</h2><span id='topic+qcc.options'></span>

<h3>Description</h3>

<p>This function can be used to control the behavior of the
'qcc' library such as the background color, out-of-control points appearance,
and many others.</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcc.options(...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcc.options_+3A_...">...</code></td>
<td>
<p>the option to be set or retrieved. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available options are:
</p>

<dl>
<dt><code>exp.R.unscaled</code></dt><dd><p>a vector specifying, for each sample size, the expected value of the relative range (i.e. <code class="reqn">R/\sigma</code>) for a normal distribution. This appears as <code class="reqn">d_2</code> on most tables containing factors for the construction of control charts.</p>
</dd>
<dt><code>se.R.unscaled</code></dt><dd><p>a vector specifying, for each sample size, the standard error of the relative range (i.e. <code class="reqn">R/\sigma</code>) for a normal distribution. This appears as <code class="reqn">d_3</code> on most tables containing factors for the construction of control charts.</p>
</dd>
<dt><code>beyond.limits$pch</code></dt><dd><p>plotting character used to highlight points beyond control limits.</p>
</dd>  
<dt><code>beyond.limits$col</code></dt><dd><p>color used to highlight points beyond control limits.</p>
</dd>  
<dt><code>violating.runs$pch</code></dt><dd><p>plotting character used to highlight points violating runs.</p>
</dd>
<dt><code>violating.runs$col</code></dt><dd><p>color used to highlight points violating runs.</p>
</dd>  
<dt><code>run.length</code></dt><dd><p>the maximum value of a run before to signal a point as out of control.</p>
</dd>  
<dt><code>bg.margin</code></dt><dd><p>background color used to draw the margin of the charts.</p>
</dd> 
<dt><code>bg.figure</code></dt><dd><p>background color used to draw the figure of the charts.</p>
</dd>
<dt><code>cex</code></dt><dd><p>character expansion used to draw plot annotations (labels, title, tickmarks, etc.).</p>
</dd>
<dt><code>font.stats</code></dt><dd><p>font used to draw text at the bottom of control charts.</p>
</dd>
<dt><code>cex.stats</code></dt><dd><p>character expansion used to draw text at the bottom of control charts.</p>
</dd>
</dl>



<h3>Value</h3>

<p>If the functions is called with no argument return a list of available options. 
</p>
<p>If an option argument is provided the corresponding value is returned. 
</p>
<p>If a value is associated with an option argument, such option is set and the list of updated option values is invisibly returned.
In this case the list <code>.qcc.options</code> is modified and any modification will remain in effect for the rest of the session.
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>old &lt;- qcc.options()			# save defaults
qcc.options("cex.stats")		# get a single parameter
qcc.options("cex.stats"=1.2)	# change parameters
qcc.options(bg.margin="azure2")
qcc.options("violating.runs" = list(pch = 15, col = "purple"))
qcc.options("beyond.limits" = list(pch = 15, col = "orangered"))
qcc(rnorm(100), type = "xbar.one", std.dev = 0.7)	# see the results
qcc.options(old)				# restore old defaults 
</code></pre>

<hr>
<h2 id='qcc.overdispersion.test'>Overdispersion test for binomial and poisson data</h2><span id='topic+qcc.overdispersion.test'></span>

<h3>Description</h3>

<p>This function allows to test for overdispersed data in the binomial and poisson case.</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcc.overdispersion.test(x, size, type=ifelse(missing(size), "poisson", "binomial"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcc.overdispersion.test_+3A_x">x</code></td>
<td>
<p>a vector of observed data values</p>
</td></tr>
<tr><td><code id="qcc.overdispersion.test_+3A_size">size</code></td>
<td>
<p>for binomial data, a vector of sample sizes</p>
</td></tr>
<tr><td><code id="qcc.overdispersion.test_+3A_type">type</code></td>
<td>
<p>a character string specifying the distribution for testing, either <code>"poisson"</code> or <code>"binomial"</code>. By default, if <code>size</code> is provided a binomial distributed is assumed, otherwise a poisson distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This very simple test amounts to compute the statistic 
</p>

<table>
<tr>
 <td style="text-align: center;">
D = Observed variance / Theoretical variance <code class="reqn">\times</code> (no. observations - 1)</td>
</tr>

</table>

<p>and refer this to a Chi-square distribution with (no. observations - 1) degrees of freedom.</p>


<h3>Value</h3>

<p>The function returns a matrix of results.</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process
Control</em>, New York, Chapman and Hall, pp. 216&ndash;218</p>


<h3>Examples</h3>

<pre><code class='language-R'># data from Wetherill and Brown (1991) pp. 212--213, 216--218:
x &lt;- c(12,11,18,11,10,16,9,11,14,15,11,9,10,13,12,
       8,12,13,10,12,13,16,12,18,16,10,16,10,12,14)
size &lt;- rep(50, length(x))
qcc.overdispersion.test(x,size)

x &lt;- c(11,8,13,11,13,17,25,23,11,16,9,15,10,16,12,
       8,9,15,4,12,12,12,15,17,14,17,12,12,7,16)
qcc.overdispersion.test(x)
</code></pre>

<hr>
<h2 id='shewhart.rules'>Functions specifying rules for Shewhart charts</h2><span id='topic+shewhart.rules'></span><span id='topic+beyond.limits'></span><span id='topic+violating.runs'></span>

<h3>Description</h3>

<p>These functions are used to signal out of control points in Shewhart charts.</p>


<h3>Usage</h3>

<pre><code class='language-R'>shewhart.rules(object, limits = object$limits, run.length = qcc.options("run.length"))
beyond.limits(object, limits = object$limits)
violating.runs(object, run.length = qcc.options("run.length"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shewhart.rules_+3A_object">object</code></td>
<td>
<p>an object of class 'qcc'.</p>
</td></tr>
<tr><td><code id="shewhart.rules_+3A_limits">limits</code></td>
<td>
<p>control limits</p>
</td></tr>
<tr><td><code id="shewhart.rules_+3A_run.length">run.length</code></td>
<td>
<p>the maximum value of a run before to signal a
point as out of control.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>shewhart.rules</code> simply calls the <code>beyond.limits</code> and <code>violating.runs</code> functions which actually do the real calculations.
</p>


<h3>Value</h3>

<p>The <code>shewhart.rules</code> function returns a list with components:
</p>
<table>
<tr><td><code>beyond.limits</code></td>
<td>
<p>the indices of points beyond control limits.</p>
</td></tr>
<tr><td><code>violating.runs</code></td>
<td>
<p>the indices of points violating runs.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>

<hr>
<h2 id='stats.c'>Functions to plot Shewhart c chart</h2><span id='topic+stats.c'></span><span id='topic+sd.c'></span><span id='topic+limits.c'></span>

<h3>Description</h3>

<p>Statistics used in computing and drawing a Shewhart c chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.c(data, sizes)
sd.c(data, sizes, ...)
limits.c(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.c_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.c_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.c_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes.</p>
</td></tr>
<tr><td><code id="stats.c_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation.</p>
</td></tr>
<tr><td><code id="stats.c_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
<tr><td><code id="stats.c_+3A_...">...</code></td>
<td>
<p>further arguments are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.c</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.c</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.c</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.g'>Statistics used in computing and drawing a Shewhart g chart</h2><span id='topic+stats.g'></span><span id='topic+sd.g'></span><span id='topic+limits.g'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the g chart
(geometric distribution) for use with the qcc package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.g(data, sizes)
sd.g(data, sizes, ...)
limits.g(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.g_+3A_data">data</code></td>
<td>
<p> the observed data values </p>
</td></tr>
<tr><td><code id="stats.g_+3A_center">center</code></td>
<td>
<p> sample center statistic </p>
</td></tr>
<tr><td><code id="stats.g_+3A_sizes">sizes</code></td>
<td>
<p> sample sizes (not used) </p>
</td></tr>
<tr><td><code id="stats.g_+3A_std.dev">std.dev</code></td>
<td>
<p> standard deviation of geometric distribution </p>
</td></tr>
<tr><td><code id="stats.g_+3A_conf">conf</code></td>
<td>
<p> a numeric value used to compute control limits,
specifying the number of standard deviations (if 'conf' &gt; 1) or the
confidence level (if 0 &lt; 'conf' &lt; 1).</p>
</td></tr>
<tr><td><code id="stats.g_+3A_...">...</code></td>
<td>
<p>further arguments are ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The g chart plots the number of non-events between events.  np charts
do not work well when the probability of an event is rare (see example
below).  Instead of plotting the number of events, the g chart plots
the number of non-events between events.
</p>


<h3>Value</h3>

<p>The function <code>stats.g()</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.g()</code> returns <code>std.dev</code> the standard deviation
<code class="reqn">sqrt(1-p)/p</code>.
</p>
<p>The function <code>limits.g()</code> returns a matrix with lower and upper control limits.
</p>


<h3>Note</h3>

<p> The geometric distribution is quite skewed so it is best to set
conf at the required confidence interval (0 &lt; conf &lt; 1) rather than as
a multiplier of sigma.</p>


<h3>Author(s)</h3>

<p> Greg Snow <a href="mailto:greg.snow@ihc.com">greg.snow@ihc.com</a> </p>


<h3>References</h3>

<p>Kaminsky, FC et. al. (1992) <em>Statistical Control Charts Based on a Geometric Distribution</em>, Journal of Quality Technology, 24, pp 63&ndash;69. <br />
Yang, Z et. al. (2002) On the Performance of Geometric Charts with
Estimated Control Limits, <em>Journal of Quality Technology</em>, 34, pp 448&ndash;458.
</p>


<h3>See Also</h3>

<p><code>qcc</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>success &lt;- rbinom(1000, 1, 0.01)
num.noevent &lt;- diff(which(c(1,success)==1))-1
qcc(success, type = "np", sizes = 1)
qcc(num.noevent, type = "g")
</code></pre>

<hr>
<h2 id='stats.np'>Statistics used in computing and drawing a Shewhart np chart</h2><span id='topic+stats.np'></span><span id='topic+sd.np'></span><span id='topic+limits.np'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the np chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.np(data, sizes)
sd.np(data, sizes, ...)
limits.np(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.np_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.np_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.np_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes.</p>
</td></tr>
<tr><td><code id="stats.np_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation.</p>
</td></tr>
<tr><td><code id="stats.np_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
<tr><td><code id="stats.np_+3A_...">...</code></td>
<td>
<p>further arguments are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.np</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.np</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.np</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.p'>Statistics used in computing and drawing a Shewhart p chart</h2><span id='topic+stats.p'></span><span id='topic+sd.p'></span><span id='topic+limits.p'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the p chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.p(data, sizes)
sd.p(data, sizes, ...)
limits.p(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.p_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.p_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.p_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes.</p>
</td></tr>
<tr><td><code id="stats.p_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation.</p>
</td></tr>
<tr><td><code id="stats.p_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
<tr><td><code id="stats.p_+3A_...">...</code></td>
<td>
<p>further arguments are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.p</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.p</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.p</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.R'>Statistics used in computing and drawing a Shewhart R chart</h2><span id='topic+stats.R'></span><span id='topic+sd.R'></span><span id='topic+limits.R'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the R chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.R(data, sizes)
sd.R(data, sizes, std.dev = c("UWAVE-R", "MVLUE-R"))
limits.R(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.R_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.R_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.R_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes. Optional</p>
</td></tr>
<tr><td><code id="stats.R_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation. Optional for <code>sd.R</code> function, required for <code>limits.R</code>. See <code><a href="#topic+sd.xbar">sd.xbar</a></code>.</p>
</td></tr>
<tr><td><code id="stats.R_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.R</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.R</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.R</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.S'>Functions to plot Shewhart S chart</h2><span id='topic+stats.S'></span><span id='topic+sd.S'></span><span id='topic+limits.S'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the S chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.S(data, sizes)
sd.S(data, sizes, std.dev = c("UWAVE-SD", "MVLUE-SD", "RMSDF"))
limits.S(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.S_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.S_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.S_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes. Optional</p>
</td></tr>
<tr><td><code id="stats.S_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation. Optional for <code>sd.S</code> function, required for <code>limits.S</code>. See <code><a href="#topic+sd.xbar">sd.xbar</a></code>.</p>
</td></tr>
<tr><td><code id="stats.S_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.S</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.S</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.S</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.T2'>Statistics used in computing and drawing the Hotelling T^2 chart for subgrouped data</h2><span id='topic+stats.T2'></span><span id='topic+limits.T2'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the <code class="reqn">T^2</code> chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.T2(data, center = NULL, cov = NULL)

limits.T2(ngroups, size, nvars, conf) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.T2_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_center">center</code></td>
<td>
<p>a vector of values to use for center of input variables.</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_cov">cov</code></td>
<td>
<p>a matrix of values to use for the covariance matrix of input variables.</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_ngroups">ngroups</code></td>
<td>
<p>number of groups</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_size">size</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_nvars">nvars</code></td>
<td>
<p>number of variables</p>
</td></tr>
<tr><td><code id="stats.T2_+3A_conf">conf</code></td>
<td>
<p>confidence level (0 &lt; <code>conf</code> &lt; 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.T2</code> returns a list with components: 
</p>
<table>
<tr><td><code>statistics</code></td>
<td>
<p>a vector of values for the <code class="reqn">T^2</code> statistic</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>a matrix of within group means for each variable</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>sample/group center statistic</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
</table>
<p>The function <code>limits.T2</code> returns a list with components: 
</p>
<table>
<tr><td><code>control</code></td>
<td>
<p>control limits</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>pred.limits</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mqcc">mqcc</a></code>, <code><a href="#topic+stats.T2.single">stats.T2.single</a></code></p>

<hr>
<h2 id='stats.T2.single'>Statistics used in computing and drawing the Hotelling T^2 chart for individual observations data</h2><span id='topic+stats.T2.single'></span><span id='topic+limits.T2.single'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the <code class="reqn">T^2</code> chart for individual observations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.T2.single(data, center = NULL, cov = NULL)

limits.T2.single(ngroups, size, nvars, conf) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.T2.single_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_center">center</code></td>
<td>
<p>a vector of values to use for center of input variables.</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_cov">cov</code></td>
<td>
<p>a matrix of values to use for the covariance matrix of input variables.</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_ngroups">ngroups</code></td>
<td>
<p>number of groups</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_size">size</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_nvars">nvars</code></td>
<td>
<p>number of variables</p>
</td></tr>
<tr><td><code id="stats.T2.single_+3A_conf">conf</code></td>
<td>
<p>confidence level (0 &lt; <code>conf</code> &lt; 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.T2.single</code> returns a list with components: 
</p>
<table>
<tr><td><code>statistics</code></td>
<td>
<p>a vector of values for the <code class="reqn">T^2</code> statistic</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>a matrix of within group means for each variable (which is equal to <code>data</code> since sample are of sizes one)</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>sample/group center statistic</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
</table>
<p>The function <code>limits.T2.single</code> returns a list with components: 
</p>
<table>
<tr><td><code>control</code></td>
<td>
<p>control limits</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>pred.limits</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Mason, R.L. and Young, J.C. (2002) <em>Multivariate Statistical Process Control with Industrial Applications</em>, SIAM. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan, T. P. (2000), <em>Statistical Methods for Quality Improvement</em>, 2nd ed. New York: John Wiley &amp; Sons, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mqcc">mqcc</a></code>, <code><a href="#topic+stats.T2">stats.T2</a></code></p>

<hr>
<h2 id='stats.u'>Statistics used in computing and drawing a Shewhart u chart</h2><span id='topic+stats.u'></span><span id='topic+sd.u'></span><span id='topic+limits.u'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the u chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.u(data, sizes)
sd.u(data, sizes, ...)
limits.u(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.u_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.u_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.u_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes.</p>
</td></tr>
<tr><td><code id="stats.u_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation.</p>
</td></tr>
<tr><td><code id="stats.u_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
<tr><td><code id="stats.u_+3A_...">...</code></td>
<td>
<p>further arguments are ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>stats.u</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.u</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.u</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.xbar'>Statistics used in computing and drawing a Shewhart xbar chart</h2><span id='topic+stats.xbar'></span><span id='topic+sd.xbar'></span><span id='topic+limits.xbar'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the xbar chart.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.xbar(data, sizes)
sd.xbar(data, sizes, std.dev = c("UWAVE-R", "UWAVE-SD", "MVLUE-R", "MVLUE-SD", "RMSDF"))
limits.xbar(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.xbar_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.xbar_+3A_center">center</code></td>
<td>
<p>sample/group center statistic</p>
</td></tr>
<tr><td><code id="stats.xbar_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes. Optional</p>
</td></tr>
<tr><td><code id="stats.xbar_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation. Optional for <code>sd.xbar</code> function, required for <code>limits.xbar</code>. See details.</p>
</td></tr>
<tr><td><code id="stats.xbar_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods are available for estimating the process standard deviation:
</p>

<dl>
<dt><code>"UWAVE-R"</code></dt><dd><p>UnWeighted AVErage of subgroup estimates based on subgroup Ranges</p>
</dd>
<dt><code>"UWAVE-SD"</code></dt><dd><p>UnWeighted AVErage of subgroup estimates based on subgroup Standard Deviations</p>
</dd>
<dt><code>"MVLUE-R"</code></dt><dd><p>Minimum Variance Linear Unbiased Estimator computed as a weighted average of subgroups estimates based on subgroup Ranges</p>
</dd>
<dt><code>"MVLUE-SD"</code></dt><dd><p>Minimum Variance Linear Unbiased Estimator computed as a weighted average of subgroup estimates based on subgroup Standard Deviations</p>
</dd>
<dt><code>"RMSDF"</code></dt><dd><p>Root-Mean-Square estimator computed as a weighted average of subgroup estimates based on subgroup Standard Deviations</p>
</dd>
</dl>

<p>Depending on the chart, a method may be available or not, or set as the default according to the following table:
</p>

<table>
<tr>
 <td style="text-align: left;">
Method </td><td style="text-align: center;"></td><td style="text-align: center;"> <code>"xbar"</code> </td><td style="text-align: center;"> <code>"R"</code> </td><td style="text-align: center;"> <code>"S"</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"UWAVE-R"</code> </td><td style="text-align: center;"></td><td style="text-align: center;"> default </td><td style="text-align: center;"> default </td><td style="text-align: center;"> not available </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"UWAVE-SD"</code> </td><td style="text-align: center;"></td><td style="text-align: center;">  </td><td style="text-align: center;"> not available </td><td style="text-align: center;"> default </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"MVLUE-R"</code> </td><td style="text-align: center;"></td><td style="text-align: center;"> </td><td style="text-align: center;"> </td><td style="text-align: center;"> not available  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"MVLUE-SD"</code> </td><td style="text-align: center;"></td><td style="text-align: center;"> </td><td style="text-align: center;"> not available  </td><td style="text-align: center;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"RMSDF"</code> </td><td style="text-align: center;"></td><td style="text-align: center;"> </td><td style="text-align: center;"> not available </td><td style="text-align: center;">
</td>
</tr>

</table>

<p>Detailed definitions of formulae implemented are available in the SAS/QC 9.2 User's Guide.
</p>


<h3>Value</h3>

<p>The function <code>stats.xbar</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.xbar</code> returns <code>std.dev</code> the standard deviation of the statistic charted. This is based on results from Burr (1969).
</p>
<p>The function <code>limits.xbar</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Burr, I.W. (1969) Control charts for measurements with varying sample sizes. <em>Journal of Quality Technology</em>, 1(3), 163-167. <br />
Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>

<hr>
<h2 id='stats.xbar.one'>Statistics used in computing and drawing a Shewhart xbar chart for one-at-time data</h2><span id='topic+stats.xbar.one'></span><span id='topic+sd.xbar.one'></span><span id='topic+limits.xbar.one'></span>

<h3>Description</h3>

<p>These functions are used to compute statistics required by the xbar chart for one-at-time data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats.xbar.one(data, sizes)
sd.xbar.one(data, sizes, std.dev = c("MR", "SD"), k=2)
limits.xbar.one(center, std.dev, sizes, conf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stats.xbar.one_+3A_data">data</code></td>
<td>
<p>the observed data values</p>
</td></tr>
<tr><td><code id="stats.xbar.one_+3A_center">center</code></td>
<td>
<p>sample/group center statistic.</p>
</td></tr>
<tr><td><code id="stats.xbar.one_+3A_sizes">sizes</code></td>
<td>
<p>samples sizes. Not needed, size=1 is used.</p>
</td></tr>
<tr><td><code id="stats.xbar.one_+3A_k">k</code></td>
<td>
<p>number of successive pairs of observations for computing the standard deviation based on moving ranges of k points.</p>
</td></tr>
<tr><td><code id="stats.xbar.one_+3A_std.dev">std.dev</code></td>
<td>
<p>within group standard deviation. Optional for <code>sd.xbar.one</code> function, required for <code>limits.xbar.one</code>. See details.</p>
</td></tr>
<tr><td><code id="stats.xbar.one_+3A_conf">conf</code></td>
<td>
<p>a numeric value used to compute control limits, specifying the number of standard deviations (if <code>conf</code> &gt; 1) or the confidence level (if 0 &lt; <code>conf</code> &lt; 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methods  available for estimating the process standard deviation:
</p>

<table>
<tr>
 <td style="text-align: left;">
Method </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"MR"</code> </td><td style="text-align: left;"> moving range: this is estimate is based on the scaled mean of moving ranges </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"SD"</code> </td><td style="text-align: left;"> sample standard deviation: this estimate is defined as as(x)/cd(n), where n = number of observations x.
</td>
</tr>

</table>



<h3>Value</h3>

<p>The function <code>stats.xbar.one</code> returns a list with components <code>statistics</code> and <code>center</code>.
</p>
<p>The function <code>sd.xbar.one</code> returns <code>std.dev</code> the standard deviation of the statistic charted.
</p>
<p>The function <code>limits.xbar.one</code> returns a matrix with lower and upper control limits. 
</p>


<h3>Author(s)</h3>

<p>Luca Scrucca</p>


<h3>References</h3>

<p>Montgomery, D.C. (2005) <em>Introduction to Statistical Quality Control</em>, 5th ed. New York: John Wiley &amp; Sons. <br />
Ryan T.P. (2000) <em>Statistical Methods for Quality Improvement</em>, New York: John Wiley &amp; Sons. <br />
Wetherill, G.B. and Brown, D.W. (1991) <em>Statistical Process Control</em>. New York: Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qcc">qcc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># Water content of antifreeze data (Wetherill and Brown, 1991, p. 120)
x &lt;- c(2.23, 2.53, 2.62, 2.63, 2.58, 2.44, 2.49, 2.34, 2.95, 2.54, 2.60, 2.45,
       2.17, 2.58, 2.57, 2.44, 2.38, 2.23, 2.23, 2.54, 2.66, 2.84, 2.81, 2.39,
       2.56, 2.70, 3.00, 2.81, 2.77, 2.89, 2.54, 2.98, 2.35, 2.53)
# the Shewhart control chart for one-at-time data
# 1) using MR (default)
qcc(x, type="xbar.one", data.name="Water content (in ppm) of batches of antifreeze")
# 2) using SD
qcc(x, type="xbar.one", std.dev = "SD", data.name="Water content (in ppm) of batches of antifreeze")

# "as the size increases further, we would expect sigma-hat to settle down
#  at a value close to the overall sigma-hat" (Wetherill and Brown, 1991,
# p. 121)
sigma &lt;- NA
k &lt;- 2:24
for (j in k)
    sigma[j] &lt;- sd.xbar.one(x, k=j)
plot(k, sigma[k], type="b")     # plot estimates of sigma for 
abline(h=sd(x), col=2, lty=2)   # different values of k
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
