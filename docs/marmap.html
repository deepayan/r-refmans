<!DOCTYPE html><html><head><title>Help for package marmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {marmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aleutians'>
<p>Bathymetric data for the Aleutians (Alaska)</p></a></li>
<li><a href='#antimeridian.box'>
<p>Adds a box to maps including antimeridian</p></a></li>
<li><a href='#as.bathy'>
<p>Convert to bathymetric data in an object of class bathy</p></a></li>
<li><a href='#as.raster'>
<p>Convert bathymetric data to a raster layer</p></a></li>
<li><a href='#as.SpatialGridDataFrame'>
<p>Convert bathymetric data to a spatial grid</p></a></li>
<li><a href='#as.xyz'>
<p>Convert to xyz format</p></a></li>
<li><a href='#autoplot.bathy'>
<p>Ploting bathymetric data with ggplot</p></a></li>
<li><a href='#celt'>
<p>Bathymetric data for the North Est Atlantic</p></a></li>
<li><a href='#check.bathy'>
<p>Sort bathymetric data matrix by increasing latitude and longitude</p></a></li>
<li><a href='#col2alpha'>
<p>Adds alpha transparency to a (vector of) color(s)</p></a></li>
<li><a href='#collate.bathy'>
<p>Collates two bathy matrices with data from either sides of the antimeridian</p></a></li>
<li><a href='#combine.buffers'>
<p>Create a new, (non circular) composite buffer from a list of existing buffers.</p></a></li>
<li><a href='#create.buffer'>
<p>Create a buffer of specified radius around one or several points</p></a></li>
<li><a href='#diag.bathy'>
<p>Finds matrix diagonal for non-square matrices</p></a></li>
<li><a href='#dist2isobath'>
<p>Computes the shortest great circle distance between any point and a given isobath</p></a></li>
<li><a href='#etopo'>
<p>Etopo colours</p></a></li>
<li><a href='#florida'>
<p>Bathymetric data around Florida, USA</p></a></li>
<li><a href='#fortify.bathy'>
<p>Extract bathymetry data in a data.frame</p></a></li>
<li><a href='#get.area'>
<p>Get projected surface area</p></a></li>
<li><a href='#get.box'>
<p>Get bathymetric information of a belt transect</p></a></li>
<li><a href='#get.depth'>
<p>Get depth data by clicking on a map</p></a></li>
<li><a href='#get.sample'>
<p>Get sample data by clicking on a map</p></a></li>
<li><a href='#get.transect'>
<p>Compute approximate cross section along a depth transect</p></a></li>
<li><a href='#getNOAA.bathy'>
<p>Import bathymetric data from the NOAA server</p></a></li>
<li><a href='#griddify'>
<p>Fill a grid with irregularly spaced data</p></a></li>
<li><a href='#hawaii'>
<p>Bathymetric data for Hawaii, USA</p></a></li>
<li><a href='#irregular'>
<p>Irregularly spaced bathymetric data.</p></a></li>
<li><a href='#is.bathy'>
<p>Test whether an object is of class bathy</p></a></li>
<li><a href='#lc.dist'>
<p>Computes least cost distances between two or more locations</p></a></li>
<li><a href='#linesGC'>
<p>Add Great Circle lines on a map</p></a></li>
<li><a href='#marmap'>
<p>Import, plot and analyze bathymetric and topographic data</p></a></li>
<li><a href='#metallo'>
<p>Coral sampling information from the North West Atlantic</p></a></li>
<li><a href='#nw.atlantic'>
<p>Bathymetric data for the North West Atlantic</p></a></li>
<li><a href='#nw.atlantic.coast'>
<p>Coastline data for the North West Atlantic</p></a></li>
<li><a href='#outline.buffer'>
<p>Get a composite buffer in a format suitable for plotting its outline</p></a></li>
<li><a href='#palette.bathy'>
<p>Builds a bathymetry- and/or topography-constrained color palette</p></a></li>
<li><a href='#path.profile'>
<p>Geographic coordinates, kilometric distance and depth along a path</p></a></li>
<li><a href='#plot.bathy'>
<p>Ploting bathymetric data</p></a></li>
<li><a href='#plot.buffer'>
<p>Plots a circular buffer and or its outline</p></a></li>
<li><a href='#plotArea'>
<p>Plotting projected surface areas</p></a></li>
<li><a href='#plotProfile'>
<p>Ploting bathymetric data along a transect or path</p></a></li>
<li><a href='#read.bathy'>
<p>Read bathymetric data in XYZ format</p></a></li>
<li><a href='#readGEBCO.bathy'>
<p>Read bathymetric data from a GEBCO file</p></a></li>
<li><a href='#scaleBathy'>
<p>Adds a scale to a map</p></a></li>
<li><a href='#space.pies'>
<p>Automatic placement of piecharts on maps</p></a></li>
<li><a href='#subsetBathy'>
<p>Creates bathy objects from larger bathy objects</p></a></li>
<li><a href='#subsetSQL'>
<p>Creating and querying local SQL database for bathymetric data</p></a></li>
<li><a href='#summary.bathy'>
<p>Summary of bathymetric data of class <code>bathy</code></p></a></li>
<li><a href='#trans.mat'>
<p>Transition matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Import, Plot and Analyze Bathymetric and Topographic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.10</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Pante, Benoit Simon-Bouhet, and Jean-Olivier Irisson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benoit Simon-Bouhet &lt;besibo@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>DBI, RSQLite, gdistance, geosphere, sp, raster, ncdf4,
plotrix, shape, reshape2, adehabitatMA, ggplot2, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>maps, mapdata, lattice, mapproj, R.rsp</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ericpante/marmap/issues">https://github.com/ericpante/marmap/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Import xyz data from the NOAA (National Oceanic and Atmospheric Administration, <a href="https://www.noaa.gov">https://www.noaa.gov</a>), GEBCO (General Bathymetric Chart of the Oceans, <a href="https://www.gebco.net">https://www.gebco.net</a>) and other sources, plot xyz data to prepare publication-ready figures, analyze xyz data to extract transects, get depth / altitude based on geographical coordinates, or calculate z-constrained least-cost paths.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ericpante/marmap">https://github.com/ericpante/marmap</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-24 12:35:01 UTC; bsimonbo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-24 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aleutians'>
Bathymetric data for the Aleutians (Alaska)</h2><span id='topic+aleutians'></span>

<h3>Description</h3>

<p>Bathymetric matrix of class <code>bathy</code> created from NOAA GEODAS data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aleutians)
</code></pre>


<h3>Details</h3>

<p>Data imported from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>) and transformed into an object of class <code>bathy</code> by <code>as.bathy</code>. 
</p>


<h3>Value</h3>

<p>A text file.
</p>


<h3>Author(s)</h3>

<p>see <a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+antimeridian.box">antimeridian.box</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load celt data
data(aleutians)

# class "bathy"
class(aleutians)
summary(aleutians)

# test plot.bathy
plot(aleutians,image = TRUE, 
     bpal = list(c(0,max(aleutians),"grey"),
                 c(min(aleutians),0,"darkblue","lightblue")), 
     land = TRUE, lwd = 0.1, axes = FALSE)
antimeridian.box(aleutians, 10)
</code></pre>

<hr>
<h2 id='antimeridian.box'>
Adds a box to maps including antimeridian
</h2><span id='topic+antimeridian.box'></span>

<h3>Description</h3>

<p>Adds a box on maps including the antimeridian (180)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>antimeridian.box(object, tick.spacing)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="antimeridian.box_+3A_object">object</code></td>
<td>

<p>matrix of class bathy
</p>
</td></tr>
<tr><td><code id="antimeridian.box_+3A_tick.spacing">tick.spacing</code></td>
<td>

<p>spacing between tick marks (in degrees, default=20)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function adds a box and tick marks to an existing plot which contains the antimeridian line (180 degrees). 
</p>


<h3>Author(s)</h3>

<p>Eric Pante &amp; Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aleutians)

# default plot:
plot(aleutians,n=1)

# plot with corrected box and labels:
plot(aleutians,n=1,axes=FALSE)
antimeridian.box(aleutians, 10)
</code></pre>

<hr>
<h2 id='as.bathy'>
Convert to bathymetric data in an object of class bathy</h2><span id='topic+as.bathy'></span>

<h3>Description</h3>

<p>Reads either an object of class <code>RasterLayer</code>, <code>SpatialGridDataFrame</code> or a three-column data.frame containing longitude (x), latitude (y) and depth (z) data and converts it to a matrix of class bathy. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.bathy(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.bathy_+3A_x">x</code></td>
<td>

<p>Object of <code>RasterLayer</code> or <code>SpatialGridDataFrame</code>, or a three-column data.frame with longitude (x), latitude (y) and depth (z) (no default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x</code> can contain data downloaded from the NOAA GEODAS Grid Translator webpage (http://www.ngdc.noaa.gov/mgg/gdas/gd_designagrid.html) in the form of an xyz table. The function <code>as.bathy</code> can also be used to transform objects of class <code>raster</code> (see package <code>raster</code>) and <code>SpatialGridDataFrame</code> (see package <code>sp</code>).
</p>


<h3>Value</h3>

<p>The output of <code>as.bathy</code> is a matrix of class <code>bathy</code>, which dimensions and resolution are identical to the original object. The class <code>bathy</code> has its own methods for summarizing and ploting the data.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+as.xyz">as.xyz</a></code>, <code><a href="#topic+as.raster">as.raster</a></code>, <code><a href="#topic+as.SpatialGridDataFrame">as.SpatialGridDataFrame</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data
data(nw.atlantic)

# use as.bathy
atl &lt;- as.bathy(nw.atlantic)

# class "bathy"
class(atl)

# summarize data of class "bathy"
summary(atl)

</code></pre>

<hr>
<h2 id='as.raster'>
Convert bathymetric data to a raster layer</h2><span id='topic+as.raster'></span>

<h3>Description</h3>

<p>Transforms an object of class <code>bathy</code> to a raster layer. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.raster(bathy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.raster_+3A_bathy">bathy</code></td>
<td>

<p>an object of class <code>bathy</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.raster</code> transforms <code>bathy</code> objects into objects of class <code>RasterLayer</code> as defined in the <code>raster</code> package. All methods from the <code>raster</code> package are thus available for bathymetric data (e.g. rotations, projections...).
</p>


<h3>Value</h3>

<p>An object of class <code>RasterLayer</code> with the same characteristics as the <code>bathy</code> object (same longitudinal and latitudinal ranges, same resolution).
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.xyz">as.xyz</a></code>, <code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+as.SpatialGridDataFrame">as.SpatialGridDataFrame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load Hawaii bathymetric data
data(hawaii)

# use as.raster
r.hawaii &lt;- as.raster(hawaii)

# class "RasterLayer"
class(r.hawaii)

# Summaries
summary(hawaii)
summary(r.hawaii)

# structure of the RasterLayer object
str(r.hawaii)

## Not run: 
# Plots
#require(raster)
plot(hawaii,image=TRUE,lwd=.2)
plot(r.hawaii)

## End(Not run)
</code></pre>

<hr>
<h2 id='as.SpatialGridDataFrame'>
Convert bathymetric data to a spatial grid</h2><span id='topic+as.SpatialGridDataFrame'></span>

<h3>Description</h3>

<p>Transforms an object of class <code>bathy</code> to a <code>SpatialGridDataFrame</code> object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.SpatialGridDataFrame(bathy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.SpatialGridDataFrame_+3A_bathy">bathy</code></td>
<td>

<p>an object of class <code>bathy</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.SpatialGridDataFrame</code> transforms <code>bathy</code> objects into objects of class <code>SpatialGridDataFrame</code> as defined in the <code>sp</code> package. All methods from the <code>sp</code> package are thus available for bathymetric data (e.g. rotations, projections...).
</p>


<h3>Value</h3>

<p>An object of class <code>SpatialGridDataFrame</code> with the same characteristics as the <code>bathy</code> object (same longitudinal and latitudinal ranges, same resolution).
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.xyz">as.xyz</a></code>, <code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+as.raster">as.raster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load Hawaii bathymetric data
data(hawaii)

# use as.SpatialGridDataFrame
sp.hawaii &lt;- as.SpatialGridDataFrame(hawaii)

# Summaries
summary(hawaii)
summary(sp.hawaii)

# structure of the SpatialGridDataFrame object
str(sp.hawaii)

# Plots
plot(hawaii,image=TRUE,lwd=.2)
image(sp.hawaii)
</code></pre>

<hr>
<h2 id='as.xyz'>
Convert to xyz format</h2><span id='topic+as.xyz'></span>

<h3>Description</h3>

<p>Converts a matrix of class <code>bathy</code> into a three-column data.frame containing longitude, latitude and depth data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.xyz(bathy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.xyz_+3A_bathy">bathy</code></td>
<td>

<p>matrix of class <code>bathy</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The use of <code>as.bathy</code> and <code>as.xyz</code> allows to swicth back and forth between the long format (xyz) and the wide format of class <code>bathy</code> suitable for plotting bathymetric maps, computing least cost distances, etc. <code>as.xyz</code> is especially usefull for exporting xyz files when data are obtained using <code>subsetSQL</code>, i.e. bathymetric matrices of class <code>bathy</code>.
</p>


<h3>Value</h3>

<p>Three-column data.frame with a format similar to xyz files downloaded from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>). The first column contains longitude data, the second contains latitude data and the third contains depth/elevation data.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load celt data
data(celt)
dim(celt)
class(celt)
summary(celt)
plot(celt,deep= -300,shallow= -25,step=25)

# use as.xyz
celt2 &lt;- as.xyz(celt)
dim(celt2)
class(celt2)
summary(celt2)

</code></pre>

<hr>
<h2 id='autoplot.bathy'>
Ploting bathymetric data with ggplot
</h2><span id='topic+autoplot.bathy'></span>

<h3>Description</h3>

<p>Plots contour or image map from bathymetric data matrix of class <code>bathy</code> with ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bathy'
autoplot(x, geom="contour", mapping=NULL, coast=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.bathy_+3A_x">x</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code><a href="#topic+read.bathy">read.bathy</a></code>
</p>
</td></tr>
<tr><td><code id="autoplot.bathy_+3A_geom">geom</code></td>
<td>

<p>geometry to use for the plot, i.e. type of plot; can be &lsquo;contour&rsquo;, &lsquo;tile&rsquo; or &lsquo;raster&rsquo;. contour does a contour plot. tile and raster produce an image plot. tile allows true geographical projection through <code><a href="ggplot2.html#topic+coord_map">coord_map</a></code>. raster only allows approximate projection but is faster to plot.
Names can be abbreviated. Geometries can be combined by specifying several in a vector.
</p>
</td></tr>
<tr><td><code id="autoplot.bathy_+3A_mapping">mapping</code></td>
<td>

<p>additional mappings between the data obtained from calling <code><a href="#topic+fortify.bathy">fortify.bathy</a></code> on x and the aesthetics for all geoms. When not NULL, this is a call to aes().
</p>
</td></tr>
<tr><td><code id="autoplot.bathy_+3A_coast">coast</code></td>
<td>

<p>boolean; wether to highlight the coast (isobath 0 m) as a black line
</p>
</td></tr>
<tr><td><code id="autoplot.bathy_+3A_...">...</code></td>
<td>

<p>passed to the chosen geom(s)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+fortify.bathy">fortify.bathy</a></code> is called with argument <code>x</code> to produce a data.frame compatible with ggplot2. Then layers are added to the plot based om the argument <code>geom</code>. Finally, the whole plot is projected geographically using <code><a href="ggplot2.html#topic+coord_map">coord_map</a></code> (for <code>geom="contour"</code>) or an approximation thereof.
</p>


<h3>Author(s)</h3>

<p>Jean-Olivier Irisson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fortify.bathy">fortify.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
	data(nw.atlantic)
	atl &lt;- as.bathy(nw.atlantic)

  # basic plot
## Not run: 
  library("ggplot2")
	autoplot.bathy(atl)

  # plot images
	autoplot.bathy(atl, geom=c("tile"))
	autoplot.bathy(atl, geom=c("raster")) # faster but not resolution independant

  # plot both!
	autoplot.bathy(atl, geom=c("raster", "contour"))

  # geom names can be abbreviated
	autoplot.bathy(atl, geom=c("r", "c"))

  # do not highlight the coastline
	autoplot.bathy(atl, coast=FALSE)
    
  # better colour scale
  	autoplot.bathy(atl, geom=c("r", "c")) +
    scale_fill_gradient2(low="dodgerblue4", mid="gainsboro", high="darkgreen")

  # set aesthetics
	autoplot.bathy(atl, geom=c("r", "c"), colour="white", size=0.1)
  
  # topographical colour scale, see ?scale_fill_etopo
	autoplot.bathy(atl, geom=c("r", "c"), colour="white", size=0.1) + scale_fill_etopo()
  	
	# add sampling locations
	data(metallo)
  last_plot() + geom_point(aes(x=lon, y=lat), data=metallo, alpha=0.5)

  # an alternative contour map making use of additional mappings
  # see ?stat_contour in ggplot2 to understand the ..level.. argument
	autoplot.bathy(atl, geom="contour", mapping=aes(colour=..level..))

## End(Not run)
</code></pre>

<hr>
<h2 id='celt'>
Bathymetric data for the North Est Atlantic</h2><span id='topic+celt'></span>

<h3>Description</h3>

<p>Bathymetric matrix of class <code>bathy</code> created from NOAA GEODAS data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(celt)
</code></pre>


<h3>Details</h3>

<p>Data imported from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>) and transformed into an object of class <code>bathy</code> by <code>as.bathy</code>. 
</p>


<h3>Value</h3>

<p>A text file.
</p>


<h3>Author(s)</h3>

<p>see <a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load celt data
data(celt)

# class "bathy"
class(celt)
summary(celt)

# test plot.bathy
plot(celt, deep=-300, shallow=-50, step=25)

</code></pre>

<hr>
<h2 id='check.bathy'>
Sort bathymetric data matrix by increasing latitude and longitude</h2><span id='topic+check.bathy'></span>

<h3>Description</h3>

<p>Reads a bathymetric data matrix and orders its rows and columns by increasing latitude and longitude. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.bathy(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.bathy_+3A_x">x</code></td>
<td>

<p>a matrix
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>check.bathy</code> allows to sort rows and columns by increasing latitude and longitude, which is necessary for ploting with the function <code>image</code> (package <code>graphics</code>). <code>check.bathy</code> is used within the <code>marmap</code> functions <code>read.bathy</code> and <code>as.bathy</code> (it is also used in <code>getNOAA.bathy</code> through <code>as.bathy</code>). 
</p>


<h3>Value</h3>

<p>The output of <code>check.bathy</code> is an ordered matrix.
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+getNOAA.bathy">getNOAA.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>matrix(1:100, ncol=5, dimnames=list(20:1, c(3,2,4,1,5))) -&gt; a
check.bathy(a)
</code></pre>

<hr>
<h2 id='col2alpha'>
Adds alpha transparency to a (vector of) color(s)
</h2><span id='topic+col2alpha'></span>

<h3>Description</h3>

<p>Adds transparency to a color or a vector of colors by specifying one or several alpha values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2alpha(color,alpha = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col2alpha_+3A_color">color</code></td>
<td>

<p>a (vector of) color codes or names
</p>
</td></tr>
<tr><td><code id="col2alpha_+3A_alpha">alpha</code></td>
<td>

<p>a value (or vector of values) between 0 (full transparency) and 1 (no transparency).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the size of <code>color</code> and <code>alpha</code> vectors are different, <code>alpha</code> values are recycled.
</p>


<h3>Value</h3>

<p>A (vector) of color code(s).
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate random data
dat &lt;- rnorm(4000)

# plot with plain color for points
plot(dat,pch=19,col="red")

# Add some transparency to get a better idea of density
plot(dat,pch=19,col=col2alpha("red",.3))

# Same color for all points but with increasing alpha (decreasing transparency)
plot(dat,pch=19,col=col2alpha(rep("red",4000),seq(0,1,len=4000)))

# Two colors, same alpha
plot(dat,pch=19,col=col2alpha(rep(c("red","purple"),each=2000),.2))

# Four colors, gradient of transparency for each color
plot(dat,pch=19,col=col2alpha(rep(c("blue","purple","red","orange"),each=1000),seq(.1,.6,len=1000)))

# Alpha transparency applied to a gradient of colors
plot(dat,pch=19,col=col2alpha(rainbow(4000),.5))

</code></pre>

<hr>
<h2 id='collate.bathy'>
Collates two bathy matrices with data from either sides of the antimeridian
</h2><span id='topic+collate.bathy'></span>

<h3>Description</h3>

<p>Collates two bathy matrices, one with longitude 0 to 180 degrees East, and the other with longitude 0 to 180 degrees West
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collate.bathy(east,west)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collate.bathy_+3A_east">east</code></td>
<td>

<p>matrix of class <code>bathy</code> with eastern data (West of antimeridian)
</p>
</td></tr>
<tr><td><code id="collate.bathy_+3A_west">west</code></td>
<td>

<p>matrix of class <code>bathy</code> with western data (East of antimeridian)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is meant to be used with <code>read.bathy()</code> or <code>readGEBCO.bathy()</code>, when data is downloaded from either sides of the antimeridian line (180 degrees longitude). If, for example, data is downloaded from GEBCO for longitudes of 170E-180 and 180-170W, <code>collate.bathy()</code> will create a single matrix of class <code>bathy</code> with a coordinate system going from 170 to 190 degrees longitude. 
</p>
<p><code>getNOAA.bathy()</code> deals with data from both sides of the antimeridian and does not need further processing with <code>collate.bathy()</code>.
</p>


<h3>Value</h3>

<p>A single matrix of class <code>bathy</code> that can be interpreted by <code>plot.bathy</code>. When plotting collated data (with longitudes 0 to 180 and 180 to 360 degrees), plots can be modified to display the conventional coordinate system (with longitudes 0 to 180 and -180 to 0 degrees) using function <code>antimeridian.box()</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNOAA.bathy">getNOAA.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+antimeridian.box">antimeridian.box</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## faking two datasets using aleutians, for this example
## "a" and "b" simulate two datasets downloaded from GEBCO, for ex.
	data(aleutians)
	aleutians[1:181,] -&gt; a ; "bathy" -&gt; class(a)
	aleutians[182:601,] -&gt; b ; "bathy" -&gt; class(b)
	-(360-as.numeric(rownames(b))) -&gt; rownames(b) 

## check these objects with summary(): pay attention of the Longitudinal range
	summary(aleutians)
	summary(a)
	summary(b)

## merge datasets:
	collate.bathy(a,b) -&gt; collated
	summary(collated) # should be identical to summary(aleutians)
</code></pre>

<hr>
<h2 id='combine.buffers'>
Create a new, (non circular) composite buffer from a list of existing buffers.
</h2><span id='topic+combine.buffers'></span>

<h3>Description</h3>

<p>Creates a new bathy object from a list of existing buffers of compatible dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine.buffers(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine.buffers_+3A_...">...</code></td>
<td>

<p>2 or more buffer objects as produced by <code><a href="#topic+create.buffer">create.buffer</a></code>. All <code>bathy</code> objects within the <code>buffer</code> objects must be compatible: they should have the same dimensions (same number of rows and columns) and cover the same area (same longitudes and latitudes).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>bathy</code> of the same dimensions as the original <code>bathy</code> objects contained within each <code>buffer</code> objects. The resulting <code>bathy</code> object contains only <code>NA</code>s outside of the combined buffer and values of depth/altitude inside the combined buffer.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create.buffer">create.buffer</a></code>, <code><a href="#topic+plot.buffer">plot.buffer</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot a bathymetry
data(florida)
plot(florida, lwd = 0.2)
plot(florida, n = 1, lwd = 0.7, add = TRUE)

# add points around which a buffer will be computed
loc &lt;- data.frame(c(-80,-82), c(26,24))
points(loc, pch = 19, col = "red")

# create 2 distinct buffer objects with different radii
buf1 &lt;- create.buffer(florida, loc[1,], radius=1.9)
buf2 &lt;- create.buffer(florida, loc[2,], radius=1.2)

# combine both buffers
buf &lt;- combine.buffers(buf1,buf2)

## Not run: 
# Add outline of the resulting buffer in red 
# and the outline of the original buffers in blue
plot(outline.buffer(buf), lwd = 3, col = 2, add=TRUE)
plot(buf1, lwd = 0.5, fg="blue")
plot(buf2, lwd = 0.5, fg="blue")

## End(Not run)
</code></pre>

<hr>
<h2 id='create.buffer'>
Create a buffer of specified radius around one or several points
</h2><span id='topic+create.buffer'></span><span id='topic+print.buffer'></span>

<h3>Description</h3>

<p>Create a circular buffer of user-defined radius around one or several points defined by their longitudes and latitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.buffer(x, loc, radius, km = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.buffer_+3A_x">x</code></td>
<td>

<p>an object of class <code>bathy</code>
</p>
</td></tr>
<tr><td><code id="create.buffer_+3A_loc">loc</code></td>
<td>

<p>a 2-column <code>data.frame</code> of longitudes and latitudes for points around which the buffer is to be created.
</p>
</td></tr>
<tr><td><code id="create.buffer_+3A_radius">radius</code></td>
<td>

<p><code>numeric</code>. Radius of the buffer in the same unit as the <code>bathy</code> object (i.e. usually decimal degrees) when <code>km=FALSE</code> (default) or in kilometers when <code>radius=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="create.buffer_+3A_km">km</code></td>
<td>

<p><code>logical</code>. If <code>TRUE</code>, the <code>radius</code> should be provided in kilometers. When <code>FALSE</code> (default) the radius is in the same unit as the <code>bathy</code> object (i.e. usually decimal degrees).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes advantage of the <code>buffer</code> function from package <code>adehabitatMA</code> and several functions from packages <code>sp</code> to define the buffer around the points provided by the user.
</p>


<h3>Value</h3>

<p>An object of class <code>bathy</code> of the same size as <code>mat</code> containing only <code>NA</code>s outside of the buffer and values of depth/altitude (taken from <code>mat</code>) within the buffer.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+outline.buffer">outline.buffer</a></code>, <code><a href="#topic+combine.buffers">combine.buffers</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot a bathymetry
data(florida)
plot(florida, lwd = 0.2)
plot(florida, n = 1, lwd = 0.7, add = TRUE)

# add a point around which a buffer will be created
loc &lt;- data.frame(-80, 26)
points(loc, pch = 19, col = "red")

# compute and print buffer
buf &lt;- create.buffer(florida, loc, radius=1.5)
buf

# highlight isobath with the buffer and add outline
plot(buf, outline=FALSE, n = 10, col = 2, lwd=.4)
plot(buf, lwd = 0.7, fg = 2)
</code></pre>

<hr>
<h2 id='diag.bathy'>
Finds matrix diagonal for non-square matrices
</h2><span id='topic+diag.bathy'></span>

<h3>Description</h3>

<p>Finds either the values of the coordinates of the non-linear diagonal of non-square matrices. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag.bathy(mat,coord=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diag.bathy_+3A_mat">mat</code></td>
<td>

<p>a data matrix
</p>
</td></tr>
<tr><td><code id="diag.bathy_+3A_coord">coord</code></td>
<td>

<p>whether of not to output the coordinates of the diagonal (default is <code>FALSE</code>)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>diag.bathy gets the values or coordinates from the first element of a matrix to its last elements. If the matrix is non-square, that is, its number of rows and columns differ, diag.bathy computes an approximate diagonal.  
</p>


<h3>Value</h3>

<p>A vector of diagonal values is <code>coord</code> is <code>FALSE</code>, or a table of diagonal coordinates if<code>coord</code> is <code>FALSE</code></p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.transect">get.transect</a></code>, <code><a href="base.html#topic+diag">diag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
# a square matrix: diag.bathy behaves as diag
	matrix(1:25, 5, 5) -&gt; a ; a
	diag(a)
	diag.bathy(a)

# a non-square matrix: diag.bathy does not behaves as diag
	matrix(1:15, 3, 5) -&gt; b ; b
	diag(b)
	diag.bathy(b)
	
# output the diagonal or its coordinates: 
	rownames(b) &lt;- seq(32,35, length.out=3)
	colnames(b) &lt;- seq(-100,-95, length.out=5)
	diag.bathy(b, coord=FALSE)
	diag.bathy(b, coord=TRUE)
	
</code></pre>

<hr>
<h2 id='dist2isobath'>
Computes the shortest great circle distance between any point and a given isobath
</h2><span id='topic+dist2isobath'></span>

<h3>Description</h3>

<p>Computes the shortest (great circle) distance between a set of points and an isoline of depth or altitude. Points can be selected interactively by clicking on a map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist2isobath(mat, x, y=NULL, isobath=0, locator=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist2isobath_+3A_mat">mat</code></td>
<td>

<p>Bathymetric data matrix of class <code>bathy</code>, as imported with <code>read.bathy</code>.
</p>
</td></tr>
<tr><td><code id="dist2isobath_+3A_x">x</code></td>
<td>

<p>Either a list of two elements (numeric vectors of longitude and latitude), a 2-column matrix or data.frame of longitudes and latitudes, or a numeric vector of longitudes.
</p>
</td></tr>
<tr><td><code id="dist2isobath_+3A_y">y</code></td>
<td>

<p>Either <code>NULL</code> (default) or a numerical vector of latitudes. Ignored if <code>x</code> is not a numeric vector.
</p>
</td></tr>
<tr><td><code id="dist2isobath_+3A_isobath">isobath</code></td>
<td>

<p>A single numerical value indicating the isobath to which the shortest distance is to be computed (default is set to 0, <em>i.e.</em> the coastline).
</p>
</td></tr>
<tr><td><code id="dist2isobath_+3A_locator">locator</code></td>
<td>

<p>Logical. Whether to choose data points interactively with a map or not. If <code>TRUE</code>, a bathymetric map must have been plotted and both <code>x</code> and <code>y</code> are both ignored.
</p>
</td></tr>
<tr><td><code id="dist2isobath_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to <code>locator</code> when the interactive mode is used (<code>locator=TRUE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dist2isobath</code> allows the user to compute the shortest great circle distance between a set of points (selected interactively on a map or not) and a user-defined isobath. <code>dist2isobath</code> takes advantage of functions from packages <code>sp</code> (<code>Lines()</code> and <code>SpatialLines()</code>) and <code>geosphere</code> (<code>dist2Line</code>) to compute the coordinates of the nearest location along a given isobath for each point provided by the user.
</p>


<h3>Value</h3>

<p>A 5-column data.frame. The first column contains the distance in meters between each point and the nearest point located on the given <code>isobath</code>. Columns 2 and 3 indicate the longitude and latitude of starting points (<em>i.e.</em> either coordinates provided as <code>x</code> and <code>y</code> or coordinates of points selected interactively on a map when <code>locator=TRUE</code>) and columns 4 and 5 contains coordinates (longitudes and latitudes) arrival points <em>i.e.</em> the nearest points on the <code>isobath</code>.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+linesGC">linesGC</a></code>, <code><a href="#topic+lc.dist">lc.dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

# Create vectors of latitude and longitude
lon &lt;- c(-70, -65, -63, -55, -48)
lat &lt;- c(33, 35, 40, 37, 33)

# Compute distances between each point and the -200m isobath
d &lt;- dist2isobath(atl, lon, lat, isobath = -200)
d

# Visualize the great circle distances
blues &lt;- c("lightsteelblue4","lightsteelblue3","lightsteelblue2","lightsteelblue1")
plot(atl, image=TRUE, lwd=0.1, land=TRUE, bpal = list(c(0,max(atl),"grey"), c(min(atl),0,blues)))
plot(atl, deep=-200, shallow=-200, step=0, lwd=0.6, add=TRUE)
points(lon,lat, pch=21, col="orange4", bg="orange2", cex=.8)
linesGC(d[2:3],d[4:5])
</code></pre>

<hr>
<h2 id='etopo'>
Etopo colours
</h2><span id='topic+etopo'></span><span id='topic+etopo.colors'></span><span id='topic+etopo.colours'></span><span id='topic+scale_color_etopo'></span><span id='topic+scale_colour_etopo'></span><span id='topic+scale_fill_etopo'></span>

<h3>Description</h3>

<p>Various ways to access the colors on the etopo color scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etopo.colors(n)

scale_fill_etopo(...)
scale_color_etopo(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etopo_+3A_n">n</code></td>
<td>

<p>number of colors to get from the scale. Those are evenly spaced within the scale.
</p>
</td></tr>
<tr><td><code id="etopo_+3A_...">...</code></td>
<td>

<p>passed to <code>scale_fill_gradientn</code> or <code>scale_color_gradientn</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>etopo.colors</code> is equivalent to other color scales in R (e.g. <code>grDevices::heat.colors</code>, <code>grDevices::cm.colors</code>).
</p>
<p><code>scale_fill/color_etopo</code> are meant to be used with ggplot2. They allow consistent plots in various subregions by setting the limits of the scale explicitly.
</p>


<h3>Author(s)</h3>

<p>Jean-Olivier Irisson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.bathy">autoplot.bathy</a></code>, <code><a href="#topic+palette.bathy">palette.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

# plot with base graphics
plot(atl, image=TRUE)

# using the etopo color scale
etopo_cols &lt;- rev(etopo.colors(8))
plot(atl, image=TRUE, bpal=list(
  c(min(atl), 0, etopo_cols[1:2]),
  c(0, max(atl), etopo_cols[3:8])
))


# plot using ggplot2; in which case the limits of the scale are automatic
library("ggplot2")
ggplot(atl, aes(x=x, y=y)) + coord_quickmap() +
  # background
  geom_raster(aes(fill=z)) +
  scale_fill_etopo() +
  # countours
  geom_contour(aes(z=z),
    breaks=c(0, -100, -200, -500, -1000, -2000, -4000),
    colour="black", size=0.2
  ) +
  scale_x_continuous(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0))
</code></pre>

<hr>
<h2 id='florida'>
Bathymetric data around Florida, USA</h2><span id='topic+florida'></span>

<h3>Description</h3>

<p>Bathymetric object of class <code>bathy</code> created from NOAA GEODAS data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(florida)
</code></pre>


<h3>Details</h3>

<p>Data imported from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>) and transformed into an object of class <code>bathy</code> by <code>read.bathy</code>. 
</p>


<h3>Value</h3>

<p>A bathymetric object of class <code>bathy</code> with 539 rows and 659 columns.
</p>


<h3>Author(s)</h3>

<p>see <a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load florida data
data(florida)

# class "bathy"
class(florida)
summary(florida)

# test plot.bathy
plot(florida,asp=1)
plot(florida,asp=1,image=TRUE,drawlabels=TRUE,land=TRUE,n=40)
</code></pre>

<hr>
<h2 id='fortify.bathy'>
Extract bathymetry data in a data.frame</h2><span id='topic+fortify.bathy'></span>

<h3>Description</h3>

<p>Extract bathymetry data in a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bathy'
fortify(model, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fortify.bathy_+3A_model">model</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code><a href="#topic+read.bathy">read.bathy</a></code>
</p>
</td></tr>
<tr><td><code id="fortify.bathy_+3A_data">data</code></td>
<td>

<p>ignored  
</p>
</td></tr>
<tr><td><code id="fortify.bathy_+3A_...">...</code></td>
<td>

<p>ignored
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fortify.bathy</code> is really just calling <code><a href="#topic+as.xyz">as.xyz</a></code> and ensuring consistent names for the columns. It then allows to use ggplot2 functions directly.
</p>


<h3>Author(s)</h3>

<p>Jean-Olivier Irisson, Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.bathy">autoplot.bathy</a></code>, <code><a href="#topic+as.xyz">as.xyz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

library("ggplot2")
# convert bathy object into a data.frame
head(fortify(atl))

# one can now use bathy objects with ggplot directly
ggplot(atl) + geom_contour(aes(x=x, y=y, z=z)) + coord_map()

# which allows complete plot configuration
atl.df &lt;- fortify(atl)
ggplot(atl.df, aes(x=x, y=y)) + coord_quickmap() +
  geom_raster(aes(fill=z), data=atl.df[atl.df$z &lt;= 0,]) +
  geom_contour(aes(z=z),
    breaks=c(-100, -200, -500, -1000, -2000, -4000),
    colour="white", size=0.1
  ) +
  scale_x_continuous(expand=c(0,0)) +
  scale_y_continuous(expand=c(0,0))
</code></pre>

<hr>
<h2 id='get.area'>
Get projected surface area
</h2><span id='topic+get.area'></span>

<h3>Description</h3>

<p>Get projected surface area for specific depth layers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.area(mat, level.inf, level.sup=0, xlim=NULL, ylim=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.area_+3A_mat">mat</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code>read.bathy</code> (no default)
</p>
</td></tr>
<tr><td><code id="get.area_+3A_level.inf">level.inf</code></td>
<td>

<p>lower depth limit for calculation of projected surface area (no default)
</p>
</td></tr>
<tr><td><code id="get.area_+3A_level.sup">level.sup</code></td>
<td>

<p>upper depth limit for calculation of projected surface area (default is zero)
</p>
</td></tr>
<tr><td><code id="get.area_+3A_xlim">xlim</code></td>
<td>

<p>longitudinal range of the area of interest (default is <code>NULL</code>)
</p>
</td></tr>
<tr><td><code id="get.area_+3A_ylim">ylim</code></td>
<td>

<p>latitudinal range of the area of interest (default is <code>NULL</code>)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.area</code> calculates the projected surface area of specific depth layers (e.g. upper bathyal, lower bathyal), the projected plane being the ocean surface. The resolution of <code>get.area</code> depends on the resolution of the input bathymetric data. <code>xlim</code> and <code>ylim</code> can be used to restrict the area of interest. Area calculation is based on <code>areaPolygon</code> of package <code>geosphere</code> (using an average Earth radius of 6,371 km). 
</p>


<h3>Value</h3>

<p>A list of four objects: the projeced surface area in squared kilometers, a matrix with the cells used for calculating the projected surface area, the longitude and latitude of the matrix used for the calculations. 
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet and Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotArea">plotArea</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="graphics.html#topic+contour">contour</a></code>, <code><a href="geosphere.html#topic+areaPolygon">areaPolygon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get area for the entire hawaii dataset:
	data(hawaii)
	plot(hawaii, lwd=0.2)
	
	mesopelagic &lt;- get.area(hawaii, level.inf=-1000, level.sup=-200)
	bathyal &lt;- get.area(hawaii, level.inf=-4000, level.sup=-1000)
	abyssal &lt;- get.area(hawaii, level.inf=min(hawaii), level.sup=-4000)
	
	col.meso &lt;- rgb(0.3, 0, 0.7, 0.3) 
	col.bath &lt;- rgb(0.7, 0, 0, 0.3) 
	col.abys &lt;- rgb(0.7, 0.7, 0.3, 0.3) 

	plotArea(mesopelagic, col = col.meso)
	plotArea(bathyal, col = col.bath)
	plotArea(abyssal, col = col.abys)
	
	me &lt;- round(mesopelagic$Square.Km, 0)
	ba &lt;- round(bathyal$Square.Km, 0)
	ab &lt;- round(abyssal$Square.Km, 0)

	legend(x="bottomleft",
		legend=c(paste("mesopelagic:",me,"km2"),
		         paste("bathyal:",ba,"km2"), 
		         paste("abyssal:",ab,"km2")), 
		col="black", pch=21, 
		pt.bg=c(col.meso,col.bath,col.abys))

# Use of xlim and ylim
	data(hawaii)
	plot(hawaii, lwd=0.2)
	
	mesopelagic &lt;- get.area(hawaii, xlim=c(-161.4,-159), ylim=c(21,23),
	                        level.inf=-1000, level.sup=-200)
	bathyal &lt;- get.area(hawaii, xlim=c(-161.4,-159), ylim=c(21,23),
	                        level.inf=-4000, level.sup=-1000)
	abyssal &lt;- get.area(hawaii, xlim=c(-161.4,-159), ylim=c(21,23),
	                        level.inf=min(hawaii), level.sup=-4000)
	
	col.meso &lt;- rgb(0.3, 0, 0.7, 0.3) 
	col.bath &lt;- rgb(0.7, 0, 0, 0.3) 
	col.abys &lt;- rgb(0.7, 0.7, 0.3, 0.3) 
	
	plotArea(mesopelagic, col = col.meso)
	plotArea(bathyal, col = col.bath)
	plotArea(abyssal, col = col.abys)
	
	me &lt;- round(mesopelagic$Square.Km, 0)
	ba &lt;- round(bathyal$Square.Km, 0)
	ab &lt;- round(abyssal$Square.Km, 0)
	
	legend(x="bottomleft",
		legend=c(paste("mesopelagic:",me,"km2"),
		         paste("bathyal:",ba,"km2"), 
		         paste("abyssal:",ab,"km2")), 
		col="black", pch=21, 
		pt.bg=c(col.meso,col.bath,col.abys))
</code></pre>

<hr>
<h2 id='get.box'>
Get bathymetric information of a belt transect
</h2><span id='topic+get.box'></span>

<h3>Description</h3>

<p><code>get.box</code> gets depth information of a belt transect of width <code>width</code> around a transect defined by two points on a bathymetric map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.box(bathy,x1,x2,y1,y2,width,locator=FALSE,ratio=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.box_+3A_bathy">bathy</code></td>
<td>

<p>Bathymetric data matrix of class <code>bathy</code>.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_x1">x1</code></td>
<td>

<p>Numeric. Start longitude of the transect. Requested when <code>locator=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_x2">x2</code></td>
<td>

<p>Numeric. Stop longitude of the transect. Requested when <code>locator=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_y1">y1</code></td>
<td>

<p>Numeric. Start latitude of the transect. Requested when <code>locator=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_y2">y2</code></td>
<td>

<p>Numeric. Stop latitude of the transect. Requested when <code>locator=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_width">width</code></td>
<td>

<p>Numeric. Width of the belt transect in degrees. 
</p>
</td></tr>
<tr><td><code id="get.box_+3A_locator">locator</code></td>
<td>

<p>Logical. Whether to choose transect bounds interactively with a map or not. When <code>FALSE</code> (default), a bathymetric map  (<code>plot.bathy(bathy,image=TRUE)</code>) is automatically plotted and the position of the belt transect is added.
</p>
</td></tr>
<tr><td><code id="get.box_+3A_ratio">ratio</code></td>
<td>

<p>Logical. Should aspect ratio for the <code>wireframe</code> plotting function (package <code>lattice</code>) be computed (default is <code>FALSE</code>).
</p>
</td></tr>
<tr><td><code id="get.box_+3A_...">...</code></td>
<td>

<p>Other arguments to be passed to <code><a href="graphics.html#topic+locator">locator</a></code> and <code><a href="graphics.html#topic+lines">lines</a></code> to specify the characteristics of the points and lines to draw on the bathymetric map for both the transect and the bounding box of belt transect.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.box</code> allows the user to get depth data for a rectangle area of the map around an approximate linear transect (belt transect). Both the position and size of the belt transect are user defined. The position of the transect can be specified either by inputing start and stop coordinates, or by clicking on a map created with <code>plot.bathy</code>. In its interactive mode, this function uses the <code>locator</code> function (<code><a href="graphics.html#topic+graphics">graphics</a></code> package) to retrieve and plot the coordinates of the selected transect. The argument <code>width</code> allows the user to specify the width of the belt transect in degrees. 
</p>


<h3>Value</h3>

<p>A matrix containing depth values for the belt transect. <code>rownames</code> indicate the kilometric distance from the start of the transect and <code>colnames</code> indicate the distance form the central transect in degrees.
If <code>ratio=TRUE</code>, a list of two elements: <code>depth</code>, a matrix containing depth values for the belt transect similar to the description above and <code>ratios</code> a vector of length two specifying the ratio between (i) the width and length of the belt transect and (ii) the depth range and the length of the belt transect. These ratios can be used by the function <code>wireframe</code> to produce realistic 3D bathymetric plots of the selected belt transect.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet and Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+get.transect">get.transect</a></code>, <code><a href="#topic+get.depth">get.depth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load and plot bathymetry
	data(hawaii)
	plot(hawaii,im=TRUE)

# get the depth matrix for a belt transect
	depth &lt;- get.box(hawaii,x1=-157,y1=20,x2=-155.5,y2=21,width=0.5,col=2)
	
# plotting a 3D bathymetric map of the belt transect
	require(lattice)
	wireframe(depth,shade=TRUE)
	
# get the depth matrix for a belt transect with realistic aspect ratios
	depth &lt;- get.box(hawaii,x1=-157,y1=20,x2=-155.5,y2=21,width=0.5,col=2,ratio=TRUE)

# plotting a 3D bathymetric map of the belt transect with realistic aspect ratios
	require(lattice)
	wireframe(depth[[1]],shade=TRUE,aspect=depth[[2]])
</code></pre>

<hr>
<h2 id='get.depth'>
Get depth data by clicking on a map
</h2><span id='topic+get.depth'></span>

<h3>Description</h3>

<p>Outputs depth information based on points selected by clicking on a map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.depth(mat, x, y=NULL, locator=TRUE, distance=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.depth_+3A_mat">mat</code></td>
<td>

<p>Bathymetric data matrix of class <code>bathy</code>, as imported with <code>read.bathy</code>.
</p>
</td></tr>
<tr><td><code id="get.depth_+3A_x">x</code></td>
<td>

<p>Either a list of two elements (numeric vectors of longitude and latitude), a 2-column matrix or data.frame of longitudes and latitudes, or a numeric vector of longitudes.
</p>
</td></tr>
<tr><td><code id="get.depth_+3A_y">y</code></td>
<td>

<p>Either <code>NULL</code> (default) or a numerical vector of latitudes. Ignored if <code>x</code> is not a numeric vector.
</p>
</td></tr>
<tr><td><code id="get.depth_+3A_locator">locator</code></td>
<td>

<p>Logical. Whether to choose data points interactively with a map or not. If <code>TRUE</code> (default), a bathymetric map must have been plotted and both <code>x</code> and <code>y</code> are both ignored.
</p>
</td></tr>
<tr><td><code id="get.depth_+3A_distance">distance</code></td>
<td>

<p>whether to compute the haversine distance (in km) from the first data point on (default is <code>FALSE</code>). Only available when at least two points are provided.
</p>
</td></tr>
<tr><td><code id="get.depth_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to <code>locator</code> when the interactive mode is used (<code>locator=TRUE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.depth</code> allows the user to get depth data by clicking on a map created with <code>plot.bathy</code> or by providing coordinates of points of interest. This function uses the <code>locator</code> function (<code>graphics</code> package); after creating a map with <code>plot.bathy</code>, the user can click on the map once or several times (if <code>locator=TRUE</code>), press the Escape button, and get the depth of those locations in a three-coumn data.frame (longitude, latitude and depth). Alternatively, when <code>locator=FALSE</code>, the user can submit a list of longitudes and latitudes, a two-column matrix or data.frame of longitudes and latitudes (as input for <code>x</code>), or one vector of longitudes (<code>x</code>) and one vector of latitudes (<code>y</code>). The non-interactive mode is well suited to get depth information for each point provided by GPS tracking devices. While <code><a href="#topic+get.transect">get.transect</a></code> gets every single depth value available in the bathymetric matrix between two points along a user-defined transect, <code>get.depth</code> only provides depth data for the specific points provided as input by the user.
</p>


<h3>Value</h3>

<p>A data.frame with at least, longitude, latitude and depth with one line for each point of interest. If <code>distance=TRUE</code>, a fourth column containing the kilometric distance from the first point is added.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet and Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+path.profile">path.profile</a></code>, <code><a href="#topic+get.transect">get.transect</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+subsetBathy">subsetBathy</a></code>, <code><a href="#topic+nw.atlantic">nw.atlantic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

# create vectors of latitude and longitude
lon &lt;- c(-70, -65, -63, -55)
lat &lt;- c(33, 35, 40, 37)

# a simple example
plot(atl, lwd=.5)
points(lon,lat,pch=19,col=2)

# Use get.depth to get the depth for each point
get.depth(atl, x=lon, y=lat, locator=FALSE)

# alternativeley once the map is plotted, use the iteractive mode:
## Not run: 
get.depth(atl, locator=TRUE, pch=19, col=3)

## End(Not run)
# click several times and press Escape

</code></pre>

<hr>
<h2 id='get.sample'>
Get sample data by clicking on a map
</h2><span id='topic+get.sample'></span>

<h3>Description</h3>

<p>Outputs sample information based on points selected by clicking on a map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.sample(mat, sample, col.lon, col.lat, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.sample_+3A_mat">mat</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code>read.bathy</code> (no default)
</p>
</td></tr>
<tr><td><code id="get.sample_+3A_sample">sample</code></td>
<td>

<p>data.frame containing sampling information (at least longitude and latitude) (no default)
</p>
</td></tr>
<tr><td><code id="get.sample_+3A_col.lon">col.lon</code></td>
<td>

<p>column number of data frame <code>sample</code> containing longitude information (no default)
</p>
</td></tr>
<tr><td><code id="get.sample_+3A_col.lat">col.lat</code></td>
<td>

<p>column number of data frame <code>sample</code> containing latitude information (no default)
</p>
</td></tr>
<tr><td><code id="get.sample_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code><a href="graphics.html#topic+rect">rect</a></code> for drawing a box around the selected area
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.sample</code> allows the user to get sample data by clicking on a map created with <code>plot.bathy</code>. This function uses the <code>locator</code> function (<code>graphics</code> package). After creating a map with <code>plot.bathy</code>, the user can  click twice on the map to delimit an area (for example, lower left and upper right corners of a rectangular area of interest), and get a dataframe corresponding to the <code>sample</code> points present within the selected area. 
</p>


<h3>Value</h3>

<p>a dataframe of the elements of <code>sample</code> present within the area selected
</p>


<h3>Warning </h3>

<p>clicking once or more than twice on the map will return a warning message: &quot;Please choose two points from the map&quot;
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+nw.atlantic">nw.atlantic</a></code>, <code><a href="#topic+metallo">metallo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load metallo sampling data and add a third field containing a specimen ID
data(metallo)
metallo$id &lt;- factor(paste("Metallo",1:38))

# load NW Atlantic data, convert to class bathy, and plot
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)
plot(atl, deep=-8000, shallow=0, step=1000, col="grey")

# once the map is plotted, use get.sample to get sampling info!
get.sample(atl, metallo, 1, 2)
# click twice

## End(Not run)
</code></pre>

<hr>
<h2 id='get.transect'>
Compute approximate cross section along a depth transect
</h2><span id='topic+get.transect'></span>

<h3>Description</h3>

<p>Compute the depth along a linear transect which bounds are specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.transect(mat, x1, y1, x2, y2, locator=FALSE, distance=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.transect_+3A_mat">mat</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code>read.bathy</code> (no default)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_x1">x1</code></td>
<td>

<p>start longitude of the transect (no default)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_x2">x2</code></td>
<td>

<p>stop longitude of the transect (no default)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_y1">y1</code></td>
<td>

<p>start latitude of the transect (no default)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_y2">y2</code></td>
<td>

<p>stop latitude of the transect (no default)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_locator">locator</code></td>
<td>

<p>whether to use locator to choose transect bounds interactively with a map (default is <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_distance">distance</code></td>
<td>

<p>whether to compute the haversine distance (in km) from the start of the transect, along the transect (default is <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="get.transect_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to <code>locator()</code> to specify the characteristics of the points and lines to draw on the bathymetric map when <code>locator=TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>get.transect</code> allows the user to compute an approximate linear depth cross section either by inputing start and stop coordinates, or by clicking on a map created with <code>plot.bathy</code>. In its interactive mode, this function uses the <code>locator</code> function (<code>graphics</code> package); after creating a map with <code>plot.bathy</code>, the user can click twice to delimit the bound of the transect of interest (for example, lower left and upper right corners of a rectangular area of interest), press Escape, and get a table with the transect information. 
</p>


<h3>Value</h3>

<p>A table with, at least, longitude, latitude and depth along the transect, and if specified (distance=<code>TRUE</code>), the distance in kilometers from the start of the transect. The number of elements in the resulting table depends on the resolution of the <code>bathy</code> object.
</p>


<h3>Warning </h3>

<p>Clicking once or more than twice on the map will return a warning message: &quot;Please choose only two points from the map&quot;. Manually entering coordinates that are outside the geographical range of the input <code>bathy</code> matrix will return a warning message. 
</p>


<h3>Note</h3>

<p>The distance option of <code>get.transect</code> is calculated based on the haversine formula for getting the great circle distance (takes into account the curvature of the Earth). <code>get.transect</code> uses an internal function called <code>diag.bathy</code> that extracts the approximate diagonal of a matrix, when that matrix has uneven dimentions (different numbers of columns and rows).
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+nw.atlantic">nw.atlantic</a></code>, <code><a href="#topic+nw.atlantic.coast">nw.atlantic.coast</a></code>, <code><a href="#topic+get.depth">get.depth</a></code>, <code><a href="#topic+get.sample">get.sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
# load datasets
	data(nw.atlantic); as.bathy(nw.atlantic) -&gt; atl
	data(nw.atlantic.coast)

# Example 1. get.transect(), without use of locator()
	get.transect(atl, -65, 43,-59,40) -&gt; test ; plot(test[,3]~test[,2],type="l")
	get.transect(atl, -65, 43,-59,40, distance=TRUE) -&gt; test ; plot(test[,4]~test[,3],type="l")

# Example 2. get.transect(), without use of locator(); pretty plot
	par(mfrow=c(2,1),mai=c(1.2, 1, 0.1, 0.1))
	plot(atl, deep=-6000, shallow=-10, step=1000, lwd=0.5, col="grey50",drawlabels=TRUE)
	lines(nw.atlantic.coast)

	get.transect(atl, -75, 44,-46,32, loc=FALSE, dis=TRUE) -&gt; test
	points(test$lon,test$lat,type="l",col="blue",lwd=2,lty=2)
	plotProfile(test)

# Example 3. get.transect(), with use of locator(); pretty plot
## Not run: 
	par(mfrow=c(2,1),mai=c(1.2, 1, 0.1, 0.1))
	plot(atl, deep=-6000, shallow=-10, step=1000, lwd=0.5, col="grey50",drawlabels=TRUE)
	lines(nw.atlantic.coast)
	
	get.transect(atl, loc=TRUE, dis=TRUE, col=2, lty=2) -&gt; test
	plotProfile(test)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='getNOAA.bathy'>
Import bathymetric data from the NOAA server</h2><span id='topic+getNOAA.bathy'></span>

<h3>Description</h3>

<p>Imports bathymetric data from the NOAA server, given coordinate bounds and resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNOAA.bathy(lon1, lon2, lat1, lat2, resolution = 4,
              keep = FALSE, antimeridian = FALSE, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNOAA.bathy_+3A_lon1">lon1</code></td>
<td>

<p>first longitude of the area for which bathymetric data will be downloaded
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_lon2">lon2</code></td>
<td>

<p>second longitude of the area for which bathymetric data will be downloaded
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_lat1">lat1</code></td>
<td>

<p>first latitude of the area for which bathymetric data will be downloaded
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_lat2">lat2</code></td>
<td>

<p>second latitude of the area for which bathymetric data will be downloaded
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_resolution">resolution</code></td>
<td>

<p>resolution of the grid, in minutes (default is 4)
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_keep">keep</code></td>
<td>

<p>whether to write the data downloaded from NOAA into a file (default is FALSE)
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_antimeridian">antimeridian</code></td>
<td>

<p>whether the area should include the antimeridian (longitude 180 or -180). See details.
</p>
</td></tr>
<tr><td><code id="getNOAA.bathy_+3A_path">path</code></td>
<td>

<p>Where should bathymetric data be downloaded to if <code>keep = TRUE</code>? Where should <code>getNOAA.bathy()</code> look up for bathymetric data already downloaded? Defaults to the current working directory.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getNOAA.bathy</code> queries the ETOPO 2022 database hosted on the NOAA website, given the coordinates of the area of interest and desired resolution. Users have the option of directly writing the downloaded data into a file (<code>keep = TRUE</code> argument ; see below). If an identical query is performed (i.e. using identical lat-long and resolution), <code>getNOAA.bathy</code> will load data from the file previously written to the disk instead of querying the NOAA database. This behavior should be used preferentially (1) to reduce the number of uncessary queries to the NOAA website, and (2) to reduce data load time. If the user wants to make multiple, identical queries to the NOAA website without loading the data written to disk, the data file name must be modified by the user. Alternatively, the data file can be moved outside of the present working directory.
</p>
<p><code>getNOAA.bathy</code> allows users to download bathymetric data in the antimeridian region when <code>antimeridian=TRUE</code>. The antimeridian is the 180th meridian and is located about in the middle of the Pacific Ocean, east of New Zealand and Fidji, west of Hawaii and Tonga. For a given pair of longitude values, e.g. -150 (150 degrees West) and 150 (degrees East), you have the possibility to get data for 2 distinct regions: the area centered on the antimeridian (60 degrees wide, when <code>antimeridian = TRUE</code>) or the area centered on the prime meridian (300 degrees wide, when <code>antimeridian = FALSE</code>). It is recommended to use <code>keep = TRUE</code> in combination with <code>antimeridian = TRUE</code> since gathering data for an area around the antimeridian requires two distinct queries to NOAA servers.
</p>


<h3>Value</h3>

<p>The output of <code>getNOAA.bathy</code> is a matrix of class <code>bathy</code>, which dimensions depends on the resolution of the grid uploaded from the NOAA server. The class <code>bathy</code> has its own methods for summarizing and plotting the data. If <code>keep=TRUE</code>, a csv file containing the downloaded data is produced. This file is named using the following format: 'marmap_coord_COORDINATES_res_RESOLUTION.csv' (COORDINATES separated by semicolons, and the RESOLUTION in degrees).
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>NOAA National Centers for Environmental Information. 2022: ETOPO 2022 15 Arc-Second Global Relief Model. NOAA National Centers for Environmental Information. <a href="https://doi.org/doi.org/10.25921/fd45-gt74">doi:doi.org/10.25921/fd45-gt74</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+readGEBCO.bathy">readGEBCO.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# you must have an internet connection. This line queries the NOAA ETOPO 2022 database
# for data from North Atlantic, for a resolution of 10 minutes.

getNOAA.bathy(lon1=-20,lon2=-90,lat1=50,lat2=20, resolution=10) -&gt; a
plot(a, image=TRUE, deep=-6000, shallow=0, step=1000)

# download speed for a matrix of 10 degrees x 10 degrees x 30 minutes
system.time(getNOAA.bathy(lon1=0,lon2=10,lat1=0,lat2=10, resolution=30))

## End(Not run)
</code></pre>

<hr>
<h2 id='griddify'>
Fill a grid with irregularly spaced data</h2><span id='topic+griddify'></span>

<h3>Description</h3>

<p>Transforms irregularly spaced xyz data into a raster object suitable to create a bathy object with regularly spaced longitudes and latitudes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>griddify(xyz, nlon, nlat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="griddify_+3A_xyz">xyz</code></td>
<td>

<p>3-column matrix or data.frame containing (in this order) arbitrary longitude, latitude and altitude/depth values.
</p>
</td></tr>
<tr><td><code id="griddify_+3A_nlon">nlon</code></td>
<td>

<p>integer. The number of unique regularly-spaced longitude values that will be used to create the grid.
</p>
</td></tr>
<tr><td><code id="griddify_+3A_nlat">nlat</code></td>
<td>

<p>integer. The number of unique regularly-spaced latitude values that will be used to create the grid.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>griddify</code> takes anys dataset with irregularly spaced xyz data and transforms it into a raster object (i.e. a grid) with user specified dimensions. <code>griddify</code> relies on several functions from the <code>raster</code> package, especially <code>rasterize</code> and <code>resample</code>.
If a cell of the user-defined grig does not contain any depth/altitude value in the original xyz matrix/data.frame, a <code>NA</code> is added in that cell. A bilinear interpolation is then applied in order to fill in most of the missing cells. For cells of the user-defined grig containing more than one depth/altitude value in the original xyz matrix/data.frame, the mean depth/altitude value is computed.
</p>


<h3>Value</h3>

<p>The output of <code>griddify</code> is an object of class <code>raster</code>, with <code>nlon</code> unique longitude values and <code>nlat</code> unique latitude values. 
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>Robert J. Hijmans (2015). raster: Geographic Data Analysis and Modeling. R package version 2.4-20. <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+readGEBCO.bathy">readGEBCO.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load irregularly spaced xyz data
data(irregular)
head(irregular)

# use griddify to create a 40x60 grid
reg &lt;- griddify(irregular, nlon = 40, nlat = 60)

# switch to class "bathy"
class(reg)
bat &lt;- as.bathy(reg)
summary(bat)

# Plot the new bathy object and overlay the original data points
plot(bat, image = TRUE, lwd = 0.1)
points(irregular$lon, irregular$lat, pch = 19, cex = 0.3, col = col2alpha(3))
</code></pre>

<hr>
<h2 id='hawaii'>
Bathymetric data for Hawaii, USA
</h2><span id='topic+hawaii'></span><span id='topic+hawaii.sites'></span>

<h3>Description</h3>

<p>Bathymetric object of class <code>bathy</code> created from NOAA GEODAS data and arbitrary locations around the main Hawaiian islands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hawaii)
data(hawaii.sites)
</code></pre>


<h3>Details</h3>

<p><code>hawaii</code> contains data imported from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>) and transformed into an object of class <code>bathy</code> by <code>read.bathy</code>.
<code>hawaii.sites</code> is a 2-columns data.frame containing longitude and latitude of 6 locations spread at sea around Hawaii.
</p>


<h3>Value</h3>

<p><code>hawaii</code>: a bathymetric object of class <code>bathy</code> with 539 rows and 659 columns.
<code>hawaii.sites</code>: data.frame (6 rows, 2 columns)
</p>


<h3>Author(s)</h3>

<p>see <a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load hawaii data
	data(hawaii)
	data(hawaii.sites)

# class "bathy"
	class(hawaii)
	summary(hawaii)

## Not run: 
## use of plot.bathy to produce a bathymetric map
# creation of a color palette
	pal &lt;- colorRampPalette(c("black","darkblue","blue","lightblue"))

# Plotting the bathymetry
	plot(hawaii,image=TRUE,draw=TRUE,bpal=pal(100),asp=1,col="grey40",lwd=.7)

# Adding coastline
	require(mapdata)
	map("worldHires",res=0,fill=TRUE,col=rgb(.8,.95,.8,.7),add=TRUE)

# Adding hawaii.sites location on the map
	points(hawaii.sites,pch=21,col="yellow",bg=col2alpha("yellow",.9),cex=1.2)

## End(Not run)
</code></pre>

<hr>
<h2 id='irregular'>
Irregularly spaced bathymetric data.
</h2><span id='topic+irregular'></span>

<h3>Description</h3>

<p>Three-column data.frame of irregularly-spaced longitudes, latitudes and depths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(irregular)
</code></pre>


<h3>Value</h3>

<p>A three-columns data.frame containing longitude, latitude and depth/elevation data.
</p>


<h3>Author(s)</h3>

<p>Data modified form a dataset kindly provided by Noah Lottig from the university of Wisconsin <a href="https://limnology.wisc.edu/staff/lottig-noah/">https://limnology.wisc.edu/staff/lottig-noah/</a> in the framework of the North Temperate Lakes Long Term Ecological Research program <a href="https://lter.limnology.wisc.edu">https://lter.limnology.wisc.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+griddify">griddify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(irregular)

# use griddify
reg &lt;- griddify(irregular, nlon = 40, nlat = 60)

# switch to class "bathy"
class(reg)
bat &lt;- as.bathy(reg)
summary(bat)

# Plot the new bathy object along with the original data
plot(bat, image = TRUE, lwd = 0.1)
points(irregular$lon, irregular$lat, pch = 19, cex = 0.3, col = col2alpha(3))
</code></pre>

<hr>
<h2 id='is.bathy'>
Test whether an object is of class bathy
</h2><span id='topic+is.bathy'></span>

<h3>Description</h3>

<p>Test whether an object is of class bathy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.bathy(xyz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.bathy_+3A_xyz">xyz</code></td>
<td>

<p>three-column data.frame with longitude (x), latitude (y) and depth (z) (no default)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns <code>TRUE</code> or <code>FALSE</code>
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.bathy">as.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data
data(nw.atlantic)

# test class "bathy"
is.bathy(nw.atlantic)

# use as.bathy
atl &lt;- as.bathy(nw.atlantic)

# class "bathy"
class(atl)
is.bathy(atl)

# summarize data of class "bathy"
summary(atl)

</code></pre>

<hr>
<h2 id='lc.dist'>
Computes least cost distances between two or more locations
</h2><span id='topic+lc.dist'></span>

<h3>Description</h3>

<p>Computes least cost distances between two or more locations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lc.dist(trans, loc, res = c("dist", "path"), meters = FALSE, round = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lc.dist_+3A_trans">trans</code></td>
<td>

<p>transition object as computed by <code>trans.mat</code>
</p>
</td></tr>
<tr><td><code id="lc.dist_+3A_loc">loc</code></td>
<td>

<p>A two-columns matrix or data.frame containing latitude and longitude for 2 or more locations.
</p>
</td></tr>
<tr><td><code id="lc.dist_+3A_res">res</code></td>
<td>

<p>either <code>"dist"</code> or <code>"path"</code>. See details.
</p>
</td></tr>
<tr><td><code id="lc.dist_+3A_meters">meters</code></td>
<td>

<p>logical. When <code>res = "dist"</code>, should the results be returned in kilometers (default) or in meters.
</p>
</td></tr>
<tr><td><code id="lc.dist_+3A_round">round</code></td>
<td>

<p>integer indicating the number of decimal places to be used for printing results when <code>res = "dist"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lc.dist</code> computes least cost distances between 2 or more locations. This function relies on the package <code>gdistance</code> (van Etten, 2011. <a href="https://CRAN.R-project.org/package=gdistance">https://CRAN.R-project.org/package=gdistance</a>) and on the <code>trans.mat</code> function to define a range of depths where the paths are possible.
</p>


<h3>Value</h3>

<p>Results can be presented either as a kilometric distance matrix between all possible pairs of locations (argument <code>res="dist"</code>) or as a list of paths (i.e. 2-columns matrices of routes) between pairs of locations (<code>res="path"</code>).
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>Jacob van Etten (2011). gdistance: distances and routes on geographical grids. R package version 1.1-2.  <a href="https://CRAN.R-project.org/package=gdistance">https://CRAN.R-project.org/package=gdistance</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trans.mat">trans.mat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load and plot bathymetry
	data(hawaii)
	pal &lt;- colorRampPalette(c("black","darkblue","blue","lightblue"))
	plot(hawaii,image=TRUE,bpal=pal(100),asp=1,col="grey40",lwd=.7,
	     main="Bathymetric map of Hawaii")

# Load and plot several locations
	data(hawaii.sites)
	sites &lt;- hawaii.sites[-c(1,4),]
	rownames(sites) &lt;- 1:4
	points(sites,pch=21,col="yellow",bg=col2alpha("yellow",.9),cex=1.2)
	text(sites[,1],sites[,2],lab=rownames(sites),pos=c(3,4,1,2),col="yellow")

## Not run: 
# Compute transition object with no depth constraint
	trans1 &lt;- trans.mat(hawaii)

# Compute transition object with minimum depth constraint:
# path impossible in waters shallower than -200 meters depth
	trans2 &lt;- trans.mat(hawaii,min.depth=-200)

# Computes least cost distances for both transition matrix and plots the results on the map
	out1 &lt;- lc.dist(trans1,sites,res="path")
	out2 &lt;- lc.dist(trans2,sites,res="path")
	lapply(out1,lines,col="yellow",lwd=4,lty=1) # No depth constraint (yellow paths)
	lapply(out2,lines,col="red",lwd=1,lty=1) # Min depth set to -200 meters (red paths)

# Computes and display distance matrices for both situations
	dist1 &lt;- lc.dist(trans1,sites,res="dist")
	dist2 &lt;- lc.dist(trans2,sites,res="dist")
	dist1
	dist2

# plots the depth profile between location 1 and 3 in the two situations
	dev.new()
	par(mfrow=c(2,1))
	path.profile(out1[[2]],hawaii,pl=TRUE,
                 main="Path between locations 1 &amp; 3\nProfile with no depth constraint")
	path.profile(out2[[2]],hawaii,pl=TRUE,
                 main="Path between locations 1 &amp; 3\nProfile with min depth set to -200m")

## End(Not run)
</code></pre>

<hr>
<h2 id='linesGC'>
Add Great Circle lines on a map
</h2><span id='topic+linesGC'></span>

<h3>Description</h3>

<p><code>linesGC</code> draws Great Circle lines between a set of start and end points on an existing map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linesGC(start.points, end.points, n = 10, antimeridian = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linesGC_+3A_start.points">start.points</code></td>
<td>

<p>Two-column data.frame or matrix of longitudes and latitudes for start points.
</p>
</td></tr>
<tr><td><code id="linesGC_+3A_end.points">end.points</code></td>
<td>

<p>Two-column data.frame or matrix of longitudes and latitudes for end points. The dimensions of <code>start.points</code> and <code>end.points</code> must be compatible (<em>i.e.</em> they must have the same number of rows).
</p>
</td></tr>
<tr><td><code id="linesGC_+3A_n">n</code></td>
<td>

<p>Numeric. The number of intermediate points to add along the great circle line between the start end end points.
</p>
</td></tr>
<tr><td><code id="linesGC_+3A_antimeridian">antimeridian</code></td>
<td>

<p>Logical indicating if the map on which the great circle lines will be plotted covers the antimeridian region. The antimeridian (or antemeridian) is the 180th meridian and is located in the middle of the Pacific Ocean, east of New Zealand and Fidji, west of Hawaii and Tonga.
</p>
</td></tr>
<tr><td><code id="linesGC_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to <code>lines</code> to control the aspect of the lines to draw.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>linesGCD</code> takes advantage of the <code>gcIntermediate</code> function from package <code>geosphere</code> to plot lines following a great circle. When working with <code>marmap</code> maps encompassing the antimeridian, longitudes are numbered from 0 to 360 (as opposed to the classical numbering from -180 to +180). It is thus critical to set <code>antimeridian=TRUE</code> to avoid plotting incoherent great circle lines.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dist2isobath">dist2isobath</a></code>, <code><a href="#topic+lc.dist">lc.dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load NW Atlantic data and convert to class bathy
data(nw.atlantic)
atl &lt;- as.bathy(nw.atlantic)

# Create vectors of latitude and longitude
lon &lt;- c(-70, -65, -63, -55, -48)
lat &lt;- c(33, 35, 40, 37, 33)

# Compute distances between each point and the -200m isobath
d &lt;- dist2isobath(atl, lon, lat, isobath = -200)
d

# Create a nice palette of bleus for the bathymetry
blues &lt;- c("lightsteelblue4","lightsteelblue3","lightsteelblue2","lightsteelblue1")

# Visualize the great circle distances
plot(atl, image=TRUE, lwd=0.1, land=TRUE, 
	 bpal = list(c(0,max(atl),"grey"), c(min(atl),0,blues)))
points(lon,lat, pch=21, col="orange4", bg="orange2", cex=.8)
linesGC(d[2:3],d[4:5])

# Load aleutians data and plot the map
data(aleutians)
plot(aleutians, image=TRUE, lwd=0.1, land=TRUE, 
	 bpal = list(c(0,max(aleutians),"grey"), c(min(aleutians),0,blues)))

# define start and end points
start &lt;- matrix(c(170,55, 190, 60), ncol=2, byrow=TRUE, dimnames=list(1:2, c("lon","lat")))
end &lt;- matrix(c(200, 56, 201, 57), ncol=2, byrow=TRUE, dimnames=list(1:2, c("lon","lat")))
start
end

# Add points and great circle distances on the map
points(start, pch=21, col="orange4", bg="orange2", cex=.8)
points(end, pch=21, col="orange4", bg="orange2", cex=.8)
linesGC(start, end, antimeridian=TRUE)
</code></pre>

<hr>
<h2 id='marmap'>
Import, plot and analyze bathymetric and topographic data
</h2><span id='topic+marmap'></span><span id='topic+marmap'></span>

<h3>Description</h3>

<p>marmap is a package designed for downloading, plotting and manipulating bathymetric and topographic data in R. It can query the ETOPO 2022 bathymetry and topography database hosted by the NOAA, use simple latitude-longitude-depth data in ascii format, and take advantage of the advanced plotting tools available in R to build publication-quality bathymetric maps. Functions to query data (bathymetry, sampling information, etc...) are available interactively by clicking on marmap maps. Bathymetric and topographic data can also be used to calculate projected surface areas within specified depth/altitude intervals, and constrain the calculation of realistic shortest path distances.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> marmap</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.10</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-03-24</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Import, plot and analyze bathymetric and topographic data
</p>


<h3>Author(s)</h3>

<p>Eric Pante, Benoit Simon-Bouhet and Jean-Olivier Irisson
</p>
<p>Maintainer: Benoit Simon-Bouhet &lt;besibo@gmail.com&gt;
</p>


<h3>References</h3>

<p>Pante E, Simon-Bouhet B (2013) marmap: A Package for Importing, Plotting and Analyzing Bathymetric and Topographic Data in R. PLoS ONE 8(9): e73051. doi:10.1371/journal.pone.0073051
</p>

<hr>
<h2 id='metallo'>
Coral sampling information from the North West Atlantic
</h2><span id='topic+metallo'></span>

<h3>Description</h3>

<p>Coral sampling data from Thoma et al 2009 (MEPS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nw.atlantic)
</code></pre>


<h3>Details</h3>

<p>Sampling locations (longitude, latitude, depth in meters) for the deep-sea octocoral species Metallogorgia melanotrichos (see Thoma et al 2009 for details, including cruise information)
</p>


<h3>Value</h3>

<p>A 3-column data frame
</p>


<h3>References</h3>

<p>Thoma, J. N., E. Pante, M. R. Brugler, and S. C. France. 2009. Deep-sea octocorals and antipatharians show no evidence of seamount-scale endemism in the NW Atlantic. Marine Ecology Progress Series 397:25-35. <a href="https://www.int-res.com/articles/theme/m397p025.pdf">https://www.int-res.com/articles/theme/m397p025.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nw.atlantic">nw.atlantic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
data(nw.atlantic,metallo)
atl &lt;- as.bathy(nw.atlantic)

## the function plot below plots:
## - the coastline in blue,
## - isobaths between 8000-4000 in light grey,
## - isobaths between 4000-500 in dark grey (to emphasize seamounts)

# 1st example: function points uses first two columns ; 3rd column contains depth info
plot(atl, deep=c(-8000,-4000,0), shallow=c(-4000,-500,0), step=c(500,500,0),
 	 lwd=c(0.5,0.5,1.5),lty=c(1,1,1),
 	 col=c("grey80", "grey20", "blue"),
 	 drawlabels=c(FALSE,FALSE,FALSE) )
points(metallo, cex=1.5, pch=19,col=rgb(0,0,1,0.5))

# 2nd example: plot points according to coordinates
plot(atl, deep=c(-8000,-4000,0), shallow=c(-4000,-500,0), step=c(500,500,0),
 	 lwd=c(0.5,0.5,1.5),lty=c(1,1,1),
 	 col=c("grey80", "grey20", "blue"),
 	 drawlabels=c(FALSE,FALSE,FALSE) )
subset(metallo, metallo$lon&gt;-55) -&gt; s # isolate points from the Corner Rise seamounts:
points(s, cex=1.5, pch=19,col=rgb(0,0,1,0.5)) # only plot those points

# 3rd example: point colors corresponding to a depth gradient:
par(mai=c(1,1,1,1.5))
plot(atl, deep=c(-6500,0), shallow=c(-50,0), step=c(500,0),
     lwd=c(0.3,1), lty=c(1,1),
     col=c("black","black"),
     drawlabels=c(FALSE,FALSE,FALSE))

max(metallo$depth, na.rm=TRUE) -&gt; mx
colorRamp(c("white","lightyellow","lightgreen","blue","lightblue1","purple")) -&gt; ramp
rgb( ramp(seq(0, 1, length = mx)), max = 255) -&gt; blues

points(metallo, col="black", bg=blues[metallo$depth], pch=21,cex=1.5)
require(shape); colorlegend(zlim=c(-mx,0), col=rev(blues), main="depth (m)",posx=c(0.85,0.88))

</code></pre>

<hr>
<h2 id='nw.atlantic'>
Bathymetric data for the North West Atlantic
</h2><span id='topic+nw.atlantic'></span>

<h3>Description</h3>

<p>Data imported from the NOAA GEODAS server
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nw.atlantic)
</code></pre>


<h3>Details</h3>

<p>Data imported from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>). To prepare data from NOAA, fill the custom grid form, and choose &quot;XYZ (lon,lat,depth)&quot; as the &quot;Output Grid Format&quot;, &quot;No Header&quot; as the &quot;Output Grid Header&quot;, and either of the space, tab or comma as the column delimiter (either can be used, but &quot;comma&quot; is the default import format of <code>read.bathy</code>). Choose &quot;omit empty grid cells&quot; to reduce memory usage. 
</p>


<h3>Value</h3>

<p>A three-columns data.frame containing longitude, latitude and depth/elevation data.
</p>


<h3>Author(s)</h3>

<p>see <a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data
data(nw.atlantic)

# use as.bathy
atl &lt;- as.bathy(nw.atlantic)

# class "bathy"
class(atl)
summary(atl)

# test plot.bathy
plot(atl, deep=-8000, shallow=-1000, step=1000)

</code></pre>

<hr>
<h2 id='nw.atlantic.coast'>
Coastline data for the North West Atlantic
</h2><span id='topic+nw.atlantic.coast'></span>

<h3>Description</h3>

<p>Coastline data for the North West Atlantic, as downloaded using the NOAA Coastline Extractor tool.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nw.atlantic.coast)
</code></pre>


<h3>Details</h3>

<p>Coastline data for the NW Atlantic was obtained using the NOAA Coastline Extractor tool. To get more coastline data, go to <a href="https://www.ngdc.noaa.gov/mgg/shorelines/">https://www.ngdc.noaa.gov/mgg/shorelines/</a>. 
</p>


<h3>Value</h3>

<p>A 2-column data frame
</p>


<h3>References</h3>

<p>see <a href="https://www.ngdc.noaa.gov/mgg/shorelines/">https://www.ngdc.noaa.gov/mgg/shorelines/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nw.atlantic">nw.atlantic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
data(nw.atlantic,nw.atlantic.coast)
atl &lt;- as.bathy(nw.atlantic)

## the function plot below plots only isobaths:
## - isobaths between 8000-4000 in light grey, 
## - isobaths between 4000-500 in dark grey (to emphasize seamounts)

plot(atl, deep=c(-8000,-4000), shallow=c(-4000,-500), step=c(500,500), 
 	 lwd=c(0.5,0.5,1.5),lty=c(1,1,1),
 	 col=c("grey80", "grey20", "blue"), 
 	 drawlabels=c(FALSE,FALSE,FALSE) )
 	 
## the coastline can be added from a different source, 
## and can therefore have a different resolution:
lines(nw.atlantic.coast)

## add a geographical reference on the coast:
points(-71.064,42.358, pch=19); text(-71.064,42.358,"Boston", adj=c(1.2,0))

</code></pre>

<hr>
<h2 id='outline.buffer'>
Get a composite buffer in a format suitable for plotting its outline
</h2><span id='topic+outline.buffer'></span>

<h3>Description</h3>

<p>Get a buffer (i.e. a non-circular buffer as produced by <code>combine.buffers()</code>) in a format suitable for plotting its outline. <code>outline.buffer()</code> replaces any <code>NA</code> values in a <code>buffer</code> or <code>bathy</code> object by 0 and non-<code>NA</code> values by -1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outline.buffer(buffer)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outline.buffer_+3A_buffer">buffer</code></td>
<td>

<p>a buffer object of class <code>bathy</code> (i.e. <code>bathy</code> matrix containing depth/altitude values within the buffer and <code>NA</code>s outside)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is essentially used to prepare a composite buffer for plotting its outline on a bathymetric map. Plotting a single circular buffer should be done using the <code>plot.buffer()</code> function since it offers a more straightforward method for plotting and much smoother outlines, especially for low-resolution bathymetries.
</p>


<h3>Value</h3>

<p>An object of class <code>bathy</code> of the same dimensions as <code>buffer</code> containing only zeros (outside the buffer area) and -1 values (within the buffer).
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create.buffer">create.buffer</a></code>, <code><a href="#topic+combine.buffers">combine.buffers</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot a bathymetry
data(florida)
plot(florida, lwd = 0.2)
plot(florida, n = 1, lwd = 0.7, add = TRUE)

# add points around which a buffer will be computed
loc &lt;- data.frame(c(-80,-82), c(26,24))
points(loc, pch = 19, col = "red")

# create 2 distinct buffer objects with different radii
buf1 &lt;- create.buffer(florida, loc[1,], radius=1.9)
buf2 &lt;- create.buffer(florida, loc[2,], radius=1.2)

# combine both buffers
buf &lt;- combine.buffers(buf1,buf2)

## Not run: 
# Add outline of the resulting buffer in red 
# and the outline of the original buffers in blue
plot(outline.buffer(buf), lwd = 3, col = 2, add=TRUE)
plot(buf1, lwd = 0.5, fg="blue")
plot(buf2, lwd = 0.5, fg="blue")

## End(Not run)
</code></pre>

<hr>
<h2 id='palette.bathy'>
Builds a bathymetry- and/or topography-constrained color palette</h2><span id='topic+palette.bathy'></span>

<h3>Description</h3>

<p>Builds a constrained color palette based on depth / altitude bounds and given colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>palette.bathy(mat, layers, land=FALSE, default.col="white")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="palette.bathy_+3A_mat">mat</code></td>
<td>

<p>a matrix of bathymetric data, class bathy not required.
</p>
</td></tr>
<tr><td><code id="palette.bathy_+3A_layers">layers</code></td>
<td>

<p>a list of depth bounds and colors (see below)
</p>
</td></tr>
<tr><td><code id="palette.bathy_+3A_land">land</code></td>
<td>

<p>logical. Wether to consider land or not (<code>default</code> is <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="palette.bathy_+3A_default.col">default.col</code></td>
<td>

<p>a color for the area of the matrix not bracketed by the list supplied to <code>layers</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>palette.bathy</code> allows the production of color palettes for specified bathymetric and/or topographic layers. The <code>layers</code> argument must be a list of vectors. Each vector corresponds to a bathymetry/topography layer (for example, one layer for bathymetry and one layer for topography). The first and second elements of the vector are the minimum and maximum bathymetry/topography, respectively. The other elements of the vector (3, onward) correspond to colors (see example below). <code>palette.bathy</code> is called internally by <code>plot.bathy</code> when the <code>image</code> argument is set to <code>TRUE</code>.
</p>


<h3>Value</h3>

<p>A vector of colors which size depends on the depth / altitude range of the <code>bathy</code> matrix.
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
	data(nw.atlantic)
	atl &lt;- as.bathy(nw.atlantic)

# creating depth-constrained palette for the ocean only
    newcol &lt;- palette.bathy(mat=atl,
		layers = list(c(min(atl), 0, "purple", "blue", "lightblue")),
		land = FALSE, default.col = "grey" )
	plot(atl, land = FALSE, n = 10, lwd = 0.5, image = TRUE,
		bpal = newcol, default.col = "grey")

# same:
	plot(atl, land = FALSE, n = 10, lwd = 0.5, image = TRUE,
		bpal = list(c(min(atl), 0, "purple", "blue", "lightblue")),
		default.col = "gray")

# creating depth-constrained palette for 3 ocean "layers"
	newcol &lt;- palette.bathy(mat = atl, layers = list(
		c(min(atl), -3000, "purple", "blue", "grey"),
		c(-3000, -150, "white"),
		c(-150, 0, "yellow", "green", "brown")),
		land = FALSE, default.col = "grey")
	plot(atl, land = FALSE, n = 10, lwd = 0.7, image = TRUE,
		bpal = newcol, default.col = "grey")

# same
	plot(atl, land = FALSE, n = 10, lwd = 0.7, image = TRUE,
		bpal = list(c(min(atl), -3000, "purple","blue","grey"),
					c(-3000, -150, "white"),
					c(-150, 0, "yellow", "green", "brown")),
		default.col = "grey")

# creating depth-constrained palette for land and ocean
	newcol &lt;- palette.bathy(mat= atl, layers = list(
		c(min(atl),0,"purple","blue","lightblue"),
		c(0, max(atl), "gray90", "gray10")),
		land = TRUE)
	plot(atl, land = TRUE, n = 10, lwd = 0.5, image = TRUE, bpal = newcol)

# same
	plot(atl, land = TRUE, n = 10, lwd = 0.7, image = TRUE,
		bpal = list(
			c(min(atl), 0, "purple", "blue", "lightblue"),
			c(0, max(atl), "gray90", "gray10")))
</code></pre>

<hr>
<h2 id='path.profile'>
Geographic coordinates, kilometric distance and depth along a path 
</h2><span id='topic+path.profile'></span>

<h3>Description</h3>

<p>Computes and plots the depth/altitude along a transect or path
</p>


<h3>Usage</h3>

<pre><code class='language-R'>path.profile(path,bathy,plot=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="path.profile_+3A_path">path</code></td>
<td>

<p>2-columns matrix of longitude and latitude as obtained from <code>lc.dist</code> with argument <code>dist=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="path.profile_+3A_bathy">bathy</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>.
</p>
</td></tr>
<tr><td><code id="path.profile_+3A_plot">plot</code></td>
<td>

<p>logical. Should the depth profile be plotted?
</p>
</td></tr>
<tr><td><code id="path.profile_+3A_...">...</code></td>
<td>

<p>when <code>plot=TRUE</code>, other arguments to be passed to <code>plotProfile</code>, such as <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="graphics.html#topic+par">par</a></code> and <code><a href="#topic+plotProfile">plotProfile</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a four-columns matrix containing longitude, latitude, kilometric distance from the start of a route and depth for a set of points along a route. Optionally (i.e. when <code>plot=TRUE</code>) a bivariate plot of depth against the kilometric distance from the starting point of a transect or least cost path.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotProfile">plotProfile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading an object of class bathy and a data.frame of locations
	require(mapdata)
	data(hawaii)
	data(hawaii.sites)

# Preparing a color palette for the bathymetric map
	pal &lt;- colorRampPalette(c("black","darkblue","blue","lightblue"))

# Plotting the bathymetric data and the path between locations
# (the path starts on location 1)
	plot(hawaii,image=TRUE,bpal=pal(100),col="grey40",lwd=.7, 
	     main="Bathymetric map of Hawaii")
	map("worldHires",res=0,fill=TRUE,col=rgb(.8,.95,.8,.7),add=TRUE)
	lines(hawaii.sites,type="o",lty=2,lwd=2,pch=21,
	      col="yellow",bg=col2alpha("yellow",.9),cex=1.2)
	text(hawaii.sites[,1], hawaii.sites[,2], 
	     lab=rownames(hawaii.sites),pos=c(3,3,4,4,1,2),col="yellow")

# Computing and plotting the depth profile for this path
	profile &lt;- path.profile(hawaii.sites,hawaii,plot=TRUE, 
	                        main="Depth profile along the path\nconnecting the 6 sites")
	summary(profile)

</code></pre>

<hr>
<h2 id='plot.bathy'>
Ploting bathymetric data
</h2><span id='topic+plot.bathy'></span>

<h3>Description</h3>

<p>Plots contour map from bathymetric data matrix of class <code>bathy</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bathy'
plot(x, image=FALSE, bpal=NULL, land=FALSE,
           deepest.isobath, shallowest.isobath, step, n=20,
           lwd=1, lty=1, col="black", default.col="white", drawlabels = FALSE,
           xlab="Longitude", ylab="Latitude", asp=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bathy_+3A_x">x</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code>read.bathy</code>
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_image">image</code></td>
<td>

<p>whether or not to color depth layers (default is <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_bpal">bpal</code></td>
<td>

<p>if image is <code>TRUE</code>, either <code>NULL</code> (default: a simple blue color palette is used), a vector of colors, or a list of depth bounds and colors (see below)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_land">land</code></td>
<td>

<p>whether or not to use topographic data that may be available in the <code>bathy</code> dataset (default is <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_deepest.isobath">deepest.isobath</code></td>
<td>

<p>deepest isobath(s) to plot
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_shallowest.isobath">shallowest.isobath</code></td>
<td>

<p>shallowest isobath(s) to plot
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_step">step</code></td>
<td>

<p>distance(s) between two isobaths
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_n">n</code></td>
<td>

<p>if the user does not specify the range within which isobaths should be plotted, about <code>n</code> isobaths are automatically plotted within the depth range of the <code>bathy</code> matrix (default is 20).
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_lwd">lwd</code></td>
<td>

<p>isobath line(s) width (default is 1)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_lty">lty</code></td>
<td>

<p>isobath line type(s) (default is 1)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_col">col</code></td>
<td>

<p>isobath line color(s) (default is black)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_default.col">default.col</code></td>
<td>

<p>if image is <code>TRUE</code>, a color for the area of the matrix not bracketed by the list supplied to bpal (see below; default is <code>white</code>)
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_drawlabels">drawlabels</code></td>
<td>

<p>whether or not to plot isobath depth as a label (default is <code>FALSE</code>); may contain several elements
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_xlab">xlab</code></td>
<td>

<p>label for the x axis of the plot
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_ylab">ylab</code></td>
<td>

<p>label for the y axis of the plot
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_asp">asp</code></td>
<td>

<p>numeric, giving the aspect ratio y/x of the plot. See <code><a href="graphics.html#topic+plot.window">plot.window</a></code>
</p>
</td></tr>
<tr><td><code id="plot.bathy_+3A_...">...</code></td>
<td>

<p>Other arguments to be passed either to <code>countour</code> (default) or to <code>image</code> when argument <code>image=TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.bathy</code> uses the base <code>contour</code> and <code>image</code> functions. If a vector of isobath characteristics is provided, different types of isobaths can be added to the same plot using a single call of <code>plot.bathy</code> (see examples)
</p>
<p>If <code>image=TRUE</code>, the user has three choices for colors: (1) bpal can be set to <code>NULL</code>, in which case a default blue color palette is generated; (2) colors can be user-defined as in example 4, in which case the palette can be generated with function <code>colorRampPalette</code> (colors are then supplied as a vector to <code>plot.bathy</code>) ; (3) colors can be constrained to bathymetry- and/or topography. In this last case, a list of vectors is supplied to <code>plot.bathy</code> (example 7): each vector corresponds to a bathymetry/topography layer (for example, one layer for bathymetry and one layer for topography). The first and second elements of the vector are the minimum and maximum bathymetry/topography, respectively. The other elements of the vector (3, onward) correspond to colors (see example 7).
</p>


<h3>Value</h3>

<p>a bathymetric map with isobaths
</p>


<h3>Note</h3>

<p><code>plot.bathy</code> uses a matrix of class <code>bathy</code>, and can therefore be substituted for <code>plot</code>.
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>Eric Pante, Benoit Simon-Bouhet (2013) marmap: A Package for Importing, Plotting and Analyzing Bathymetric and Topographic Data in R. PLoS ONE 8(9): e73051. doi:10.1371/journal.pone.0073051. <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0073051">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0073051</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+nw.atlantic">nw.atlantic</a></code>, <code><a href="#topic+metallo">metallo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
	data(nw.atlantic)
	atl &lt;- as.bathy(nw.atlantic)

## Example 1: a simple marine chart
	plot(atl) # without specifying any isobath parameters
	plot(atl, n=5, drawlabels=TRUE) # with about 5 isobaths
	plot(atl, deep=-8000, shallow=0, step=1000) # with isobath parameters

## Example 2: taking advantage of multiple types of isobaths
	plot(atl, deep=c(-8000,-2000,0), shallow=c(-2000,-100,0), step=c(1000,100,0),
		 lwd=c(0.5,0.5,1),lty=c(1,1,1),col=c("grey80","red", "blue"),
		 drawlabels=c(FALSE,FALSE,FALSE) )

## Example 3: plotting a colored map with the default color palette
	plot(atl, image=TRUE, deep=c(-8000,0), shallow=c(-1000,0), step=c(1000,0),
	     lwd=c(0.5,1), lty=c(1,1), col=c("grey","black"), drawlabels=c(FALSE,FALSE))

## Example 4: make a pretty custom color ramp
	colorRampPalette(c("purple","lightblue","cadetblue2","cadetblue1","white")) -&gt; blues

	plot(atl, image=TRUE, bpal=blues(100), deep=c(-6500,0), shallow=c(-50,0), step=c(500,0),
	     lwd=c(0.3,1), lty=c(1,1), col=c("black","black"), drawlabels=c(FALSE,FALSE))

	scaleBathy(atl, deg=3, x="bottomleft", inset=5)

## Example 5: add points corresponding to sampling locations
##            point colors correspond to the sampling depth
	par(mai=c(1,1,1,1.5))
	plot(atl, deep=c(-4500,0), shallow=c(-50,0), step=c(500,0),
	     lwd=c(0.3,1), lty=c(1,1), col=c("black","black"), drawlabels=c(FALSE,FALSE))

	# add a title to the plot
	title(main="Distribution of coral samples\non the New England and Corner Rise seamounts")
	# add a scale
	scaleBathy(atl, deg=3, x="bottomleft", inset=5)

	# add a geographical reference on the coast:
	points(-71.064,42.358, pch=19)
	text(-71.064,42.358,"Boston", adj=c(1.2,0))

	# prepare colors for the sampling locations:
	data(metallo) ## see dataset metallo
	max(metallo$depth, na.rm=TRUE) -&gt; mx
	colorRampPalette(c("white","lightyellow","lightgreen","blue","lightblue1","purple")) -&gt; ramp
	blues &lt;- ramp(max(metallo$depth))

	# plot sampling locations:
	points(metallo, col="black", bg=blues[metallo$depth], pch=21,cex=1.5)
	library(shape)
	colorlegend(zlim=c(-mx,0), col=rev(blues), main="depth (m)",posx=c(0.85,0.88))

## Example 6: use packages maps and mapdata in combination with marmap
	# use maps and mapdata to plot the coast
	library(maps)
	library(mapdata)
	map('worldHires',xlim=c(-75,-46),ylim=c(32,44), fill=TRUE, col="grey")
	box();axis(1);axis(2)

	# add bathymetric data from 'bathy' data
    plot(atl, add=TRUE, lwd=.3, deep=-4500, shallow=-10, step=500,
		drawlabel=FALSE, col="grey50")

## Example 7: provide a list of depths and colors to argument bpal to finely tune palette
	# check out ?palette.bathy to see details on how the palette is handled

	# creating depth-constrained palette for the ocean only
	plot(atl, land = FALSE, n = 10, lwd = 0.5, image = TRUE,
	     bpal = list(c(min(atl), 0, "purple", "blue", "lightblue")),
	     default.col = "gray")

	# creating depth-constrained palette for 3 ocean "layers"
	plot(atl, land = FALSE, n = 10, lwd = 0.7, image = TRUE,
	     bpal = list(c(min(atl), -3000, "purple","blue","grey"),
	                 c(-3000, -150, "white"),
	                 c(-150, 0, "yellow", "green", "brown")),
	     default.col = "grey")

	# creating depth-constrained palette for land and ocean
	plot(atl, land = TRUE, n = 10, lwd = 0.7, image = TRUE,
	     bpal = list(c(min(atl), 0, "purple", "blue", "lightblue"),
	                 c(0, max(atl), "gray90", "gray10")))
</code></pre>

<hr>
<h2 id='plot.buffer'>
Plots a circular buffer and or its outline
</h2><span id='topic+plot.buffer'></span>

<h3>Description</h3>

<p><code>plot.buffer</code> is a generic function that allows the plotting of objects of class <code>buffer</code>, either as new plots or as a new layer added on top of an existing one. The plotting of both the bathymetry/hypsometry as well as the outline of the buffer is possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'buffer'
plot(x, outline = TRUE, add = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.buffer_+3A_x">x</code></td>
<td>

<p>an object of class <code>buffer</code> as produced by the <code>create.buffer()</code> function.
</p>
</td></tr>
<tr><td><code id="plot.buffer_+3A_outline">outline</code></td>
<td>

<p>Should the outline of the buffer be plotted (default) or the bathymetric/hypsometric data within the buffer.
</p>
</td></tr>
<tr><td><code id="plot.buffer_+3A_add">add</code></td>
<td>

<p>Should the plot be added on top of an existing bathymetric/hypsometric plot (default) or as a new plot
</p>
</td></tr>
<tr><td><code id="plot.buffer_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to the <code>symbols()</code> function from the <code>graphics</code> package when <code>outline = TRUE</code> (default) or to <code>plot.bathy()</code> when <code>outline = FALSE</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either a plot of the outline of a buffer (default) or a bathymetric map with isobaths of a buffer when <code>outline = FALSE</code>
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create.buffer">create.buffer</a></code>, <code><a href="#topic+combine.buffers">combine.buffers</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot a bathymetry
data(florida)
plot(florida, lwd = 0.2)
plot(florida, n = 0, lwd = 0.7, add = TRUE)

# add points around which a buffer will be computed
loc &lt;- data.frame(-80, 26)
points(loc, pch = 19, col = "red")

# compute buffer
buf &lt;- create.buffer(florida, loc, radius=1.5)

# plot buffer bathymetry 
plot(buf, outline=FALSE, n=10, lwd=.5, col=2)

# add buffer outline
plot(buf, lwd=.7, fg=2)
</code></pre>

<hr>
<h2 id='plotArea'>
Plotting projected surface areas
</h2><span id='topic+plotArea'></span>

<h3>Description</h3>

<p>Highlights the projected surface area for specific depth layers on an existing bathymetric/hypsometric map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotArea(area, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotArea_+3A_area">area</code></td>
<td>

<p>a list of 4 elements as produced by <code><a href="#topic+get.area">get.area</a></code>.
</p>
</td></tr>
<tr><td><code id="plotArea_+3A_col">col</code></td>
<td>

<p>color of the projected surface area on the map.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.area">get.area</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="geosphere.html#topic+areaPolygon">areaPolygon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot a bathymetry
data(florida)
plot(florida, lwd = 0.2)
plot(florida, n = 1, lwd = 0.7, add = TRUE)

# Create a point and a buffer around this point
loc &lt;- data.frame(-80, 26)
buf &lt;- create.buffer(florida, loc, radius=1.8)

# Get the surface within the buffer for several depth slices
surf1 &lt;- get.area(buf, level.inf=-200, level.sup=-1)
surf2 &lt;- get.area(buf, level.inf=-800, level.sup=-200)
surf3 &lt;- get.area(buf, level.inf=-3000, level.sup=-800)

s1 &lt;- round(surf1$Square.Km)
s2 &lt;- round(surf2$Square.Km)
s3 &lt;- round(surf3$Square.Km)

# Add buffer elements on the plot
col.surf1 &lt;- rgb(0.7, 0.7, 0.3, 0.3)
col.surf2 &lt;- rgb(0, 0.7, 0.3, 0.3)
col.surf3 &lt;- rgb(0.7, 0, 0, 0.3)

plotArea(surf1, col = col.surf1)
plotArea(surf2, col = col.surf2)
plotArea(surf3, col = col.surf3)
plot(buf, lwd = 0.7)
points(loc, pch = 19, col = "red")

## Add legend
legend("topleft", fill = c(col.surf1, col.surf2, col.surf3),
       legend = c(paste("]-200 ; -1] -",s1,"km2"),
	   			  paste("]-800 ; -200] -",s2,"km2"),
				  paste("]-3000 ; -800] -",s3,"km2")))
</code></pre>

<hr>
<h2 id='plotProfile'>
Ploting bathymetric data along a transect or path 
</h2><span id='topic+plotProfile'></span>

<h3>Description</h3>

<p>Plots the depth/altitude along a transect or path
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProfile(profile,shadow=TRUE,xlim,ylim,col.sea,col.bottom,xlab,ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProfile_+3A_profile">profile</code></td>
<td>

<p>4-columns matrix obtained from <code>get.transect</code> with argument <code>dist=TRUE</code>, or from <code>path.profile</code>.
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_shadow">shadow</code></td>
<td>

<p>logical. Should the depth profile cast a shadow over the plot background?
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_xlim">xlim</code>, <code id="plotProfile_+3A_ylim">ylim</code></td>
<td>

<p>numeric vectors of length 2, giving the x and y coordinates ranges. If unspecified, <code>xlim</code> values are based on the length of the transect or path and <code>ylim</code> values are based on the depth range of the bathymetric matrix <code>bathy</code>.
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_col.sea">col.sea</code></td>
<td>

<p>color for the sea area of the plot. Defaults to <code>rgb(130/255,180/255,212/255)</code>
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_col.bottom">col.bottom</code></td>
<td>

<p>color for the bottom area of the plot. Defaults to <code>rgb(198/255,184/255,151/255)</code>
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_xlab">xlab</code>, <code id="plotProfile_+3A_ylab">ylab</code></td>
<td>

<p>titles for the x and y axes. If unspecified, <code>xlab="Distance from start of transect (km)"</code> and <code>ylab="Depth (m)"</code>
</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_...">...</code></td>
<td>

<p>arguments to be passed to methods, such as <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="graphics.html#topic+par">par</a></code>)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a bivariate plot of depth against the kilometric distance from the starting point of a transect or least cost path.
</p>


<h3>Note</h3>

<p><code>path.profile</code> with argument <code>plot</code> set to <code>TRUE</code> plots depth profiles with default values for all arguments of <code>plotProfile</code>.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+path.profile">path.profile</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1:
	data(celt)
	layout(matrix(1:2,nc=1),height=c(2,1))
	par(mar=c(4,4,1,1))
	plot(celt,n=40,draw=TRUE)
	points(c(-6.34,-5.52),c(52.14,50.29),type="o",col=2)
	
	tr &lt;- get.transect(celt, x1 = -6.34, y1 = 52.14, x2 = -5.52, y2 = 50.29, distance = TRUE)
	plotProfile(tr)

# Example 2: 
	layout(matrix(1:2,nc=1),height=c(2,1))
	par(mar=c(4,4,1,1))
	plot(celt,n=40,draw=TRUE)
	points(c(-5,-6.34),c(49.8,52.14),type="o",col=2)
	
	tr2 &lt;- get.transect(celt, x1 = -5, y1 = 49.8, x2 = -6.34, y2 = 52.14, distance = TRUE)
	plotProfile(tr2)

# Example 3: click several times on the map and press ESC
## Not run: 
	layout(matrix(1:2,nc=1),height=c(2,1))
	par(mar=c(4,4,1,1))
	data(florida)
	plot(florida,image=TRUE,dra=TRUE,land=TRUE,n=40)
	
	out &lt;- path.profile(as.data.frame(locator(type="o",col=2,pch=19,cex=.8)),florida)
	plotProfile(out)

## End(Not run)
</code></pre>

<hr>
<h2 id='read.bathy'>
Read bathymetric data in XYZ format
</h2><span id='topic+read.bathy'></span>

<h3>Description</h3>

<p>Reads a three-column table containing longitude (x), latitude (y) and depth (z) data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.bathy(xyz, header = FALSE, sep = ",", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.bathy_+3A_xyz">xyz</code></td>
<td>

<p>three-column table with longitude (x), latitude (y) and depth (z) (no default)
</p>
</td></tr>
<tr><td><code id="read.bathy_+3A_header">header</code></td>
<td>

<p>whether this table has a row of column names (default = FALSE)
</p>
</td></tr>
<tr><td><code id="read.bathy_+3A_sep">sep</code></td>
<td>

<p>character separating columns, (default=&quot;,&quot;)
</p>
</td></tr>
<tr><td><code id="read.bathy_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>read.table()</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Allows direct import of data from the NOAA GEODAS Grid Translator webpage (<a href="https://maps.ngdc.noaa.gov/viewers/wcs-client/">https://maps.ngdc.noaa.gov/viewers/wcs-client/</a>). To prepare data from NOAA, fill the custom grid form, and choose &quot;XYZ (lon,lat,depth)&quot; as the &quot;Output Grid Format&quot;, &quot;No Header&quot; as the &quot;Output Grid Header&quot;, and either of the space, tab of comma as the column delimiter (either can be used, but &quot;comma&quot; is the default import format of <code>read.bathy</code>). Choose &quot;omit empty grid cells&quot; to reduce memory usage. 
</p>


<h3>Value</h3>

<p>The output of <code>read.bathy</code> is a matrix of class <code>bathy</code>, which dimensions depends on the resolution of the grid uploaded from the NOAA GEODAS server (Grid Cell Size). The class <code>bathy</code> has its own methods for summarizing and ploting the data.
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+readGEBCO.bathy">readGEBCO.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data
data(nw.atlantic)

# write example file to disk
write.table(nw.atlantic, "NW_Atlantic.csv", sep=",", quote=FALSE, row.names=FALSE)

# use read.bathy
read.bathy("NW_Atlantic.csv", header=TRUE) -&gt; atl

# remove temporary file
system("rm NW_Atlantic.csv") # remove file, for unix-like systems

# class "bathy"
class(atl)

# summarize data of class "bathy"
summary(atl)

</code></pre>

<hr>
<h2 id='readGEBCO.bathy'>
Read bathymetric data from a GEBCO file</h2><span id='topic+readGEBCO.bathy'></span>

<h3>Description</h3>

<p>Imports 30-sec and 1-min bathymetric data from a .nc file downloaded on the GEBCO website.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readGEBCO.bathy(file, resolution = 1, sid = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readGEBCO.bathy_+3A_file">file</code></td>
<td>

<p>name of the <code>.nc</code> file
</p>
</td></tr>
<tr><td><code id="readGEBCO.bathy_+3A_resolution">resolution</code></td>
<td>

<p>resolution of the grid, in units of the selected database (default is 1; see details)
</p>
</td></tr>
<tr><td><code id="readGEBCO.bathy_+3A_sid">sid</code></td>
<td>

<p>logical. Is the data file containing SID information?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readGEBCO.bathy</code> reads a 30 arcseconds or 1 arcminute bathymetry file downloaded from the GEBCO (General Bathymetric Chart of the Oceans) website (British Oceanographic Data Center). The website allows the download of bathymetric data in the netCDF format. <code>readGEBCO.bathy</code> uses the <code>ncdf4</code> package to load the data into R, and parses it into an object of class <code>bathy</code>.
</p>
<p>Data can be downloaded from the 30 arcseconds database (GEBCO_08) or the 1 arcminute database (GEBCO_1min, the default). A third database type, GEBCO_08 SID, is available from the website. This database includes a source identifier specifying which grid cells have depth information based on soundings ; it does not include bathymetry or topography data. <code>readGEBCO.bathy</code> can read this type of database when <code>sid</code> is set to <code>TRUE</code>. Then only the SID information will be included in the object of class <code>bathy</code>. Therefore, to display a map with both the bathymetry and the SID information, you will have to download both datasets from GEBCO, and import and plot both independently.
</p>
<p>The argument <code>resolution</code> specifies the resolution of the object of class <code>bathy</code>. Because the resolution of GEBCO data is rather fine, we offer the possibility of downsizing the dataset with <code>resolution</code>. <code>resolution</code> is in units of the selected database: in &quot;GEBCO_1min&quot;, <code>resolution</code> is in minutes; in &quot;GEBCO_08&quot;, <code>resolution</code> is in 30 arcseconds (that is, <code>resolution = 3</code> corresponds to 3x30sec, or 1.5 arcminute).
</p>


<h3>Value</h3>

<p>The output of <code>readGEBCO.bathy</code> is a matrix of class <code>bathy</code>, which dimensions depends on the resolution specified (one-minute, the original GEBCO resolution, is the default). The class <code>bathy</code> has its own methods for summarizing and ploting the data.
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>British Oceanographic Data Center: General Bathymetric Chart of the Oceans gridded bathymetric data sets (accessed July 10, 2020) <a href="https://www.bodc.ac.uk/data/hosted_data_systems/gebco_gridded_bathymetry_data/">https://www.bodc.ac.uk/data/hosted_data_systems/gebco_gridded_bathymetry_data/</a>
</p>
<p>General Bathymetric Chart of the Oceans website (accessed Oct 5, 2013) <a href="https://www.gebco.net">https://www.gebco.net</a>
</p>
<p>David Pierce (2019). ncdf4: Interface to Unidata netCDF (Version 4 or Earlier) Format Data Files. R package version 1.17. https://cran.r-project.org/package=ncdf4
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNOAA.bathy">getNOAA.bathy</a></code>, <code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example will not run, and we do not provide the dummy "gebco_file.nc" file,
# because a copyright license must be signed on the GEBCO website before the data can be
# downloaded and used. We just provide this line as an example for synthax.
  readGEBCO.bathy(file="gebco_file.nc", resolution=1) -&gt; nw.atl

# Second not-run example, with GEBCO_08 and SID:
  readGEBCO.bathy("gebco_08_7_38_10_43_corsica.nc") -&gt; med
  summary(med) # the bathymetry data

  readGEBCO.bathy("gebco_SID_7_38_10_43_corsica.nc")-&gt; sid
  summary(sid) # the SID data

  colorRampPalette(c("lightblue","cadetblue1","white")) -&gt; blues # custom col palette
  plot(med, n=1, im=T, bpal=blues(100)) # bathymetry

  as.numeric(rownames(sid)) -&gt; x.sid
  as.numeric(colnames(sid)) -&gt; y.sid
  contour(x.sid, y.sid, sid, drawlabels=FALSE, lwd=.1, add=TRUE) # SID

## End(Not run)
</code></pre>

<hr>
<h2 id='scaleBathy'>
Adds a scale to a map
</h2><span id='topic+scaleBathy'></span>

<h3>Description</h3>

<p>Uses geographic information from object of class <code>bathy</code> to calculate and plot a scale in kilometer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleBathy(mat, deg=1, x="bottomleft", y=NULL, inset=10, angle=90, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaleBathy_+3A_mat">mat</code></td>
<td>

<p>bathymetric data matrix of class <code>bathy</code>, imported using <code>read.bathy</code>
</p>
</td></tr>
<tr><td><code id="scaleBathy_+3A_deg">deg</code></td>
<td>

<p>the number of degrees of longitudes to convert into kilometers (default is 1)
</p>
</td></tr>
<tr><td><code id="scaleBathy_+3A_x">x</code>, <code id="scaleBathy_+3A_y">y</code></td>
<td>

<p>the coordinates used to plot the scale on the map (see Details)
</p>
</td></tr>
<tr><td><code id="scaleBathy_+3A_inset">inset</code></td>
<td>

<p>when <code>x</code> is a keyword (e.g. <code>"bottomleft"</code>), <code>inset</code> is a percentage of the plotting space controlling the relative position of the plotted scale (see Examples)
</p>
</td></tr>
<tr><td><code id="scaleBathy_+3A_angle">angle</code></td>
<td>

<p>angle from the shaft of the arrow to the edge of the arrow head
</p>
</td></tr>
<tr><td><code id="scaleBathy_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>text</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>scaleBathy</code> is a simple utility to add a scale to the lower left corner of a <code>bathy</code> plot. The distance in kilometers between two points separated by 1 degree longitude is calculated based on the minimum latitude of the <code>bathy</code> object used to plot the map. Option <code>deg</code> allows the user to plot the distance separating more than one degree (default is one). 
</p>
<p>The plotting coordinates <code>x</code> and <code>y</code> either correspond to two points on the map (i.e. longitude and latitude of the point where the scale should be plotted), or correspond to a keyword (set with <code>x</code>, <code>y</code> being set to <code>NULL</code>) from the list &quot;bottomright&quot;, &quot;bottomleft&quot;, &quot;topright&quot;, &quot;topleft&quot;. When a keyword is used, the option <code>inset</code> controls how far the scale will be from the edges of the plot.
</p>


<h3>Value</h3>

<p>a scale added to the active graphical device
</p>


<h3>Note</h3>

<p>The calculation formula is from function <code>map.scale</code> of package <code>maps</code>. 6372.798 km is used as the Earth radius. 
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data and convert to class bathy
	data(nw.atlantic)
	atl &lt;- as.bathy(nw.atlantic)

# a simple example
	plot(atl, deep=-8000, shallow=-1000, step=1000, lwd=0.5, col="grey")
	scaleBathy(atl, deg=4)

# using keywords to place the scale with inset=10%
	par(mfrow=c(2,2))
	plot(atl, deep=-8000, shallow=-1000, step=1000, lwd=0.5, col="grey")
	scaleBathy(atl, deg=4, x="bottomleft", y=NULL)
	plot(atl, deep=-8000, shallow=-1000, step=1000, lwd=0.5, col="grey")
	scaleBathy(atl, deg=4, x="bottomright", y=NULL)

# using keywords to place the scale with inset=20%
	plot(atl, deep=-8000, shallow=-1000, step=1000, lwd=0.5, col="grey")
	scaleBathy(atl, deg=4, x="topleft", y=NULL, inset=20)
	plot(atl, deep=-8000, shallow=-1000, step=1000, lwd=0.5, col="grey")
	scaleBathy(atl, deg=4, x="topright", y=NULL, inset=20) 

</code></pre>

<hr>
<h2 id='space.pies'>
Automatic placement of piecharts on maps</h2><span id='topic+space.pies'></span>

<h3>Description</h3>

<p>Attemps to automatically place piecharts on maps, avoiding overlap. Work in progress...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>space.pies(x, y, pie.slices, pie.colors=NULL, pie.radius=1, pie.space=5,
              link=TRUE, seg.lwd=1, seg.col=1, seg.lty=1, coord=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="space.pies_+3A_x">x</code></td>
<td>

<p>the longitude of the anchor point for the piechart
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_y">y</code></td>
<td>

<p>the latitude of the anchor point for the piechart
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_pie.slices">pie.slices</code></td>
<td>

<p>a table with the counts to draw pies (col: pie categories, or slices; rows: sites on the map)
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_pie.colors">pie.colors</code></td>
<td>

<p>a table with the colors to draw pies (col: pie categories, or slices; rows: sites on the map)
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_pie.radius">pie.radius</code></td>
<td>

<p>size of the piechart
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_pie.space">pie.space</code></td>
<td>

<p>factor of spacing between the anchor and the pie (the larger, the farther the pie from the anchor)
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_link">link</code></td>
<td>

<p>logical; whether to add a segment to link pie and anchor
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_seg.lwd">seg.lwd</code></td>
<td>

<p>the line width of the link
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_seg.col">seg.col</code></td>
<td>

<p>the line color of the link
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_seg.lty">seg.lty</code></td>
<td>

<p>the line type of the link
</p>
</td></tr>
<tr><td><code id="space.pies_+3A_coord">coord</code></td>
<td>

<p>when coord = <code>NULL</code> (default), placement is automatic. Otherwise, a 2-col table of lon/lat for pies.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>space.pies</code> tries to position piecharts on a map while avoiding overlap between them. The function heavily relies on two other functions. <code>floating.pie</code> from package plotrix is used to draw individual piecharts. <code>floating.pie</code> treats one pie at a time; <code>space.pies</code> can handle one or multiple pies by looping <code>floating.pie</code>. <code>pointLabels</code> from package maptools was modified to find the best placement for the pies, given their size and distance from their anchor point. <code>pointLabels</code> was originally meant to automatically place text labels, not objects; the modified version contained in <code>space.pies</code> uses the coordinates chosen by <code>pointLabels</code> for text. The algorithm used is simulating annealing (SANN). You can get a different result each time you run <code>space.pies</code>, because <code>pointLabel</code> finds one good solution out of many. If you are not satisfied by the solution, you can try running the function again.
</p>
<p>The argument <code>coord</code> allows to choose between the automatic placement outlined above, and a user-defined list of longitudes and latitudes (in a two-column table format) for plotting the piecharts.
</p>
<p>Anchor point: spatial location of the data corresponding to the piechart (e.g. a sampling point).
</p>


<h3>Value</h3>

<p>Piechart(s) added to a plot.
</p>


<h3>Author(s)</h3>

<p>Eric Pante, using functions <code>plotrix::floating.pie</code> and <code>maptools::pointLabel</code>.
</p>


<h3>References</h3>

<p>Bivand, R. and Lewin-Koh, N. (2013) maptools: Tools for reading and handling spatial objects. R package version 0.8-25. http://CRAN.R-project.org/package=maptools
</p>
<p>Lemon, J. (2006) Plotrix: a package in the red light district of R. R-News, 6(4): 8-12.
</p>
<p>SANN code implemented in <code>pointLabel</code> based on: Jon Christensen, Joe Marks, and Stuart Shieber. Placing text labels on maps and diagrams. In Paul Heckbert, editor, Graphics Gems IV, pages 497-504. Academic Press, Boston, MA, 1994.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code>plotrix::floating.pie</code>, <code>maptools::pointLabel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fake frequencies to feed to space.pies()
	sample(seq(10,90,5), 11)-&gt; freq.a
	100-freq.a -&gt; freq.b
	rep("lightblue",11) -&gt; col.a
	rep("white",11) -&gt; col.b

# some coordinates on the NW Atlantic coast, and on seamounts
	x = c(-74.28487,-73.92323,-73.80753,-72.51728,-71.12418,
		  -69.81176,-69.90715,-70.43201,-70.17135,-69.43912,-65.49608)
	y = c(39.36714,39.98515,40.40316,40.79654,41.49872,41.62076,
		  41.99805,42.68061,43.40714,43.81499,43.36471)
	pts.coast = data.frame(x,y, freq.a, freq.b, col.a, col.b)

	x = c(-66.01404,-65.47260,-63.75456,-63.26082,-62.12838,
	      -60.46885,-59.96952,-56.90925,-52.20397,-51.32288,-50.72461)
	y = c(39.70769,39.39064,38.83020,38.56479,38.01881,38.95405,
	      37.55675,34.62617,36.15592,36.38992,35.91779)
	pts.smt = data.frame(x,y, freq.a, freq.b, col.a, col.b)

# prepare the plot
	data(nw.atlantic) ; atl &lt;- as.bathy(nw.atlantic)
	plot(atl, deep=-8000, shallow=0, step=1000,col="grey")
	points(pts.coast,pch=19,col="blue", cex=0.5)
	points(pts.smt,pch=19,col="blue", cex=0.5)

# automatic placement of piecharts with space.pies
	space.pies(pts.coast[,1], pts.coast[,2],
	           pie.slices=pts.coast[,3:4], pie.colors=pts.coast[,5:6], pie.radius=0.5)
	space.pies(pts.smt[,1], pts.smt[,2],
	           pie.slices=pts.smt[,3:4], pie.colors=pts.coast[,5:6], pie.radius=0.5)
</code></pre>

<hr>
<h2 id='subsetBathy'>
Creates bathy objects from larger bathy objects
</h2><span id='topic+subsetBathy'></span>

<h3>Description</h3>

<p>Generates rectangular or non rectangular <code>bathy</code> objects by extracting bathymetric data from larger <code>bathy</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subsetBathy(mat, x, y=NULL, locator=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subsetBathy_+3A_mat">mat</code></td>
<td>

<p>Bathymetric data matrix of class <code>bathy</code>, as imported with <code>read.bathy</code>.
</p>
</td></tr>
<tr><td><code id="subsetBathy_+3A_x">x</code></td>
<td>

<p>Either a list of two elements (numeric vectors of longitude and latitude), a 2-column matrix or data.frame of longitudes and latitudes, or a numeric vector of longitudes.
</p>
</td></tr>
<tr><td><code id="subsetBathy_+3A_y">y</code></td>
<td>

<p>Either <code>NULL</code> (default) or a numerical vector of latitudes. Ignored if <code>x</code> is not a numeric vector.
</p>
</td></tr>
<tr><td><code id="subsetBathy_+3A_locator">locator</code></td>
<td>

<p>Logical. Whether to choose data points interactively with a map or not. If <code>TRUE</code> (default), a bathymetric map must have been plotted and both <code>x</code> and <code>y</code> are both ignored.
</p>
</td></tr>
<tr><td><code id="subsetBathy_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to <code>locator</code> when the interactive mode is used (<code>locator=TRUE</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>subsetBathy</code> allows the user to generate new <code>bathy</code> objects by extracting data from larger <code>bathy</code> objects. The extraction of bathymetric data can be done interactively by clicking on a bathymetric map, or by providing longitudes and latitudes for the boundaries for the new <code>bathy</code> object. If two data points are provided, a rectangular area is selected. If more than two points are provided, a polygon is defined by linking the points and the bathymetic data is extracted within the polygon only. <code>subsetBathy</code> relies on the <code>point.in.polygon</code> function from package <code>sp</code> to identify which points of the initial bathy matrix lie witin the boundaries of the user-defined polygon.
</p>


<h3>Value</h3>

<p>A matrix of class <code>bathy</code>.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>Pebesma, EJ, RS Bivand, (2005). Classes and methods for spatial data in R. R News 5 (2), <a href="https://cran.r-project.org/doc/Rnews/">https://cran.r-project.org/doc/Rnews/</a>
</p>
<p>Bivand RS, Pebesma EJ, Gomez-Rubio V (2013). Applied spatial data analysis with R, Second edition. Springer, NY. <a href="https://asdar-book.org">https://asdar-book.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bathy">plot.bathy</a></code>, <code><a href="#topic+get.depth">get.depth</a></code>, <code><a href="#topic+summary.bathy">summary.bathy</a></code>, <code><a href="#topic+aleutians">aleutians</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load aleutians dataset
data(aleutians)

# create vectors of latitude and longitude to define the boundary of a polygon
lon &lt;- c(188.56, 189.71, 191, 193.18, 196.18, 196.32, 196.32, 194.34, 188.83)
lat &lt;- c(54.33, 55.88, 56.06, 55.85, 55.23, 54.19, 52.01, 50.52, 51.71)


# plot the initial bathy and overlay the polygon
plot(aleutians, image=TRUE, land=TRUE, lwd=.2)
polygon(lon,lat)

# Use of subsetBathy to extract the new bathy object
zoomed &lt;- subsetBathy(aleutians, x=lon, y=lat, locator=FALSE)

# plot the new bathy object
dev.new() ; plot(zoomed, land=TRUE, image=TRUE, lwd=.2)

# alternativeley once the map is plotted, use the interactive mode:
## Not run: 
plot(aleutians, image=TRUE, land=TRUE, lwd=.2)
zoomed2 &lt;- subsetBathy(aleutians, pch=19, col=3)
dev.new() ; plot(zoomed2, land=TRUE, image=TRUE, lwd=.2)

## End(Not run)
# click several times and press Escape

</code></pre>

<hr>
<h2 id='subsetSQL'>
Creating and querying local SQL database for bathymetric data
</h2><span id='topic+subsetSQL'></span><span id='topic+setSQL'></span>

<h3>Description</h3>

<p><code>subsetSQL</code> queries the local SQL database created with <code>setSQL</code> to extract smaller data subsets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSQL(bathy, header = TRUE, sep = ",", db.name = "bathy_db")
subsetSQL(min_lon, max_lon, min_lat, max_lat, db.name = "bathy_db")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subsetSQL_+3A_bathy">bathy</code></td>
<td>

<p>A text file containing a comma-separated, three-column table with longitude, latitude and depth data (no default)
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_header">header</code></td>
<td>

<p>does the xyz file contains a row of column names (default = TRUE)
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_sep">sep</code></td>
<td>

<p>character separating columns in the xyz file, (default=&quot;,&quot;)
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_min_lon">min_lon</code></td>
<td>

<p>minimum longitude of the data to be extracted from the local SQL database
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_max_lon">max_lon</code></td>
<td>

<p>maximum longitude of the data to be extracted from the local SQL database
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_min_lat">min_lat</code></td>
<td>

<p>minimum latitude of the data to be extracted from the local SQL database
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_max_lat">max_lat</code></td>
<td>

<p>maximum latitude of the data to be extracted from the local SQL database
</p>
</td></tr>
<tr><td><code id="subsetSQL_+3A_db.name">db.name</code></td>
<td>

<p>The name of (or path to) the SQL database to be created on disk by <code>setSQL</code> or from which <code>subsetSQL</code> will extract data (&quot;bathy_db&quot; by default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>setSQL</code> and <code>subsetSQL</code> were built to work together. <code>setSQL</code> builds an SQL database and saves it on disk. <code>subsetSQL</code> queries that local database and the fields <code>min_lon</code>, <code>max_lon</code>, etc, are used to extract a subset of the database. The functions were built as two entities so that multiple queries can be done multiple times, without re-building the database each time. These functions were designed to access the very large (&gt;5Go) ETOPO 2022 file that can be downloaded from the NOAA website (<a href="https://www.ncei.noaa.gov/products/etopo-global-relief-model">https://www.ncei.noaa.gov/products/etopo-global-relief-model</a>)
</p>


<h3>Value</h3>

<p><code>setSQL</code> returns <code>TRUE</code> if the database was successfully created. <code>subsetSQL</code> returns a matrix of class <code>bathy</code> that can directly be used with <code>plot.bathy</code>.
</p>


<h3>Note</h3>

<p>If unspecified, <code>db.name</code> is set to &quot;bathy_db&quot; by default. Thus, theere must be no database file called <code>bathy_db</code> in the working directory prior to running <code>setSQL</code> unless a different name is used for the new database.
Make sure that your &quot;bathy&quot; input is a xyz text file (for function <code>setSQL</code>) with 3 columns containing longitude, latitude and depth data, in that order.
<code>setSQL</code> and <code>subsetSQL</code> were modified on Nov. 2, 2014 to comply with RSQLite 1.0.0.
</p>


<h3>Author(s)</h3>

<p>Eric Pante
</p>


<h3>References</h3>

<p>NOAA National Centers for Environmental Information. 2022: ETOPO 2022 15 Arc-Second Global Relief Model. NOAA National Centers for Environmental Information. <a href="https://doi.org/doi.org/10.25921/fd45-gt74">doi:doi.org/10.25921/fd45-gt74</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load NW Atlantic data
data(nw.atlantic)

# write data to disk as a comma-separated text file
write.table(nw.atlantic, "NW_Atlantic.csv", sep=",", quote=FALSE, row.names=FALSE)

# prepare SQL database
setSQL(bathy="NW_Atlantic.csv")

# uses data from the newly-created SQL database:
subsetSQL(min_lon=-70,max_lon=-50,
             min_lat=35, max_lat=41) -&gt; test

# visualize the results (of class bathy)
summary(test)

# remove temporary database and CSV files
system("rm bathy_db") # remove file, for unix-like systems
system("rm NW_Atlantic.csv") # remove file, for unix-like systems

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.bathy'>
Summary of bathymetric data of class <code>bathy</code>
</h2><span id='topic+summary.bathy'></span>

<h3>Description</h3>

<p>Summary of bathymetric data of class <code>bathy</code>. Provides geographic bounds and resolution (in minutes) of the dataset, statistics on depth data, and a preview of the bathymetric matrix.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bathy'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.bathy_+3A_object">object</code></td>
<td>

<p>object of class <code>bathy</code>
</p>
</td></tr>
<tr><td><code id="summary.bathy_+3A_...">...</code></td>
<td>

<p>additional arguments affecting the summary produced (see <code>base</code> function <code>summary</code>).  	
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Information on the geographic bounds of the dataset (minimum and maximum latitude and longitude), resolution of the matrix in minutes, statistics on the depth data (e.g. min, max, median...), and a preview of the data. 
</p>


<h3>Author(s)</h3>

<p>Eric Pante and Benoit Simon-Bouhet
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.bathy">read.bathy</a></code>, <code><a href="#topic+plot.bathy">plot.bathy</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load NW Atlantic data
data(nw.atlantic)

# use as.bathy
atl &lt;- as.bathy(nw.atlantic)

# class bathy
class(atl)

# summarize data of class bathy
summary(atl)

</code></pre>

<hr>
<h2 id='trans.mat'>
Transition matrix
</h2><span id='topic+trans.mat'></span>

<h3>Description</h3>

<p>Creates a transition object to be used by <code>lc.dist</code> to compute least cost distances between locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trans.mat(bathy,min.depth=0,max.depth=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trans.mat_+3A_bathy">bathy</code></td>
<td>

<p>A matrix of class <code>bathy</code>.
</p>
</td></tr>
<tr><td><code id="trans.mat_+3A_min.depth">min.depth</code>, <code id="trans.mat_+3A_max.depth">max.depth</code></td>
<td>

<p>Numeric. The range of depth between which the path will be possible. The default (<code>min.depth=0</code> and max.depth=NULL) indicates that the transition between cells of the grid is possible between 0 meters depth and the maximum depth of <code>bathy</code>. See details
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>trans.mat</code> creates a transition object usable by <code>lc.dist</code> to computes least cost distances between a set of locations. <code>trans.mat</code> rely on the function <code>raster</code> from package <code>raster</code> (Hijmans &amp; van Etten, 2012. <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>) and on <code>transition</code> from package <code>gdistance</code> (van Etten, 2011. <a href="https://CRAN.R-project.org/package=gdistance">https://CRAN.R-project.org/package=gdistance</a>).
</p>
<p>The transition object contains the probability of transition from one cell of a bathymetric grid to adjacent cells and depends on user defined parameters. <code>trans.mat</code> is especially usefull when least cost distances need to be calculated between several locations at sea. The default values for <code>min.depth</code> and <code>max.depth</code> ensure that the path computed by <code>lc.dist</code> will be the shortest path possible at sea avoiding land masses. The path can be constrained to a given depth range by setting manually <code>min.depth</code> and <code>max.depth</code>. For instance, it is possible to limit the possible paths to the continental shelf by setting <code>max.depth=-200</code>. Inaccuracies of the bathymetric data can occasionally result in paths crossing land masses. Setting <code>min.depth</code> to low negative values (e.g. -10 meters) can limit this problem.
</p>
<p><code>trans.mat</code> takes also advantage of the function <code>geoCorrection</code> from package <code>gdistance</code> (van Etten, 2012. <a href="https://CRAN.R-project.org/package=gdistance">https://CRAN.R-project.org/package=gdistance</a>) to take into account map distortions over large areas.
</p>


<h3>Value</h3>

<p>A transition object.
</p>


<h3>Warning </h3>

<p>Please be aware that the use of <code>trans.mat</code> can be time consumming for large bathymetric datasets. The function takes about one minute to compute a transition matrix for the <code>hawaii</code> bathymetric data (bathymetric data of class <code>bathy</code> with 599 rows and 419 columns, see <code><a href="#topic+hawaii">hawaii</a></code>) on a MacBook Pro with a 2.66 GHz Intel Core i7 processor and 4 Go of RAM.
</p>


<h3>Author(s)</h3>

<p>Benoit Simon-Bouhet
</p>


<h3>References</h3>

<p>Jacob van Etten (2011). gdistance: distances and routes on geographical grids. R package version 1.1-2.  <a href="https://CRAN.R-project.org/package=gdistance">https://CRAN.R-project.org/package=gdistance</a>
Robert J. Hijmans &amp; Jacob van Etten (2012). raster: Geographic analysis and modeling with raster data. R package version 1.9-92. <a href="https://CRAN.R-project.org/package=raster">https://CRAN.R-project.org/package=raster</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lc.dist">lc.dist</a></code>, <code><a href="#topic+hawaii">hawaii</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load and plot bathymetry
data(hawaii)
summary(hawaii)
plot(hawaii)

## Not run: 
# Compute transition object with no depth constraint
trans1 &lt;- trans.mat(hawaii)

# Compute transition object with minimum depth constraint: 
# path impossible in waters shallower than -200 meters depth
trans2 &lt;- trans.mat(hawaii,min.depth=-200)

# Visualizing results
par(mfrow=c(1,2))
plot(raster(trans1), main="No depth constraint")
plot(raster(trans2), main="Constraint in shallow waters")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
