<!DOCTYPE html><html><head><title>Help for package bgms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bgms}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgms-package'><p>bgms: Bayesian Analysis of Networks of Binary and/or Ordinal Variables</p></a></li>
<li><a href='#bgm'><p>Bayesian edge selection or Bayesian estimation for Markov Random Fields of</p>
mixed binary and ordinal variables using MCMC.</a></li>
<li><a href='#mrfSampler'><p>Sample states of the ordinal MRF</p></a></li>
<li><a href='#print.bgms'><p>Print method for <code>bgms</code> objects</p></a></li>
<li><a href='#Wenchuan'><p>Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Analysis of Networks of Binary and/or Ordinal Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Marsman &lt;m.marsman@uva.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian variable selection methods for analyzing the structure of a Markov Random Field model for a network of binary and/or ordinal variables. Details of the implemented methods can be found in: Marsman and Haslbeck (2023) &lt;<a href="https://doi.org/10.31234%2Fosf.io%2Fukwrf">doi:10.31234/osf.io/ukwrf</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://maartenmarsman.github.io/bgms/">https://maartenmarsman.github.io/bgms/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MaartenMarsman/bgms/issues">https://github.com/MaartenMarsman/bgms/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7), Rdpack, methods</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppProgress</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, qgraph, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-25 18:24:37 UTC; maartenmarsman</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Marsman <a href="https://orcid.org/0000-0001-5309-7502"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Karoline Huth <a href="https://orcid.org/0000-0002-0662-1591"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Nikola Sekulovski <a href="https://orcid.org/0000-0001-7032-1684"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Don van den Bergh <a href="https://orcid.org/0000-0002-9838-7308"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-25 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bgms-package'>bgms: Bayesian Analysis of Networks of Binary and/or Ordinal Variables</h2><span id='topic+bgms'></span><span id='topic+bgms-package'></span>

<h3>Description</h3>

<p>The <code>R</code> package <strong>bgms</strong> provides tools for Bayesian analysis of
graphical models describing networks of variables. The package uses Markov
chain Monte Carlo methods combined with a pseudolikelihood approach to
estimate the posterior distribution of model parameters.
</p>
<p>Gibbs variable selection (George and McCulloch 1993) is used to
model the underlying network structure of the graphical model. By imposing a
discrete spike and slab prior on the pairwise interactions, it is possible to
shrink the interactions to exactly zero. The Gibbs sampler embeds a
Metropolis approach for mixtures of mutually singular distributions
(Gottardo and Raftery 2008) to account for the discontinuity at
zero. The goal is to provide these tools for Markov Random Field (MRF) models
for a wide range of variable types in the <strong>bgms</strong> package, and
it currently provides them for analyzing networks of binary and/or ordinal
variables (Marsman and Haslbeck 2023).
</p>
<p>While the goal is to provide the above tools for Markov Random Field (MRF)
models for a wide range of variable types in the <strong>bgms</strong> package, it
currently provides tools for analyzing networks of binary and/or ordinal
variables (Marsman and Haslbeck 2023).
</p>
<p>MRFs are a special class of graphical models whose graph structure reflects
the conditional associations between their variables, making them useful for
testing for conditional independence or dependence. For example, the
inclusion Bayes factor tests for conditional independence or dependence of a
pair of variables in the network by comparing the predictive adequacy of
models that include the edge between these variables and models that exclude
the edge. (Huth et al. 2023; Sekulovski et al. 2023).
</p>
<p>The <strong>bgms</strong> package offers several tools for analyzing the structure of
the MRF:
</p>

<ol>
<li><p> Simulate response data from the MRF using the Gibbs sampler.
</p>

<ul>
<li><p> Simulate <code><a href="#topic+mrfSampler">mrfSampler</a></code>.
</p>
</li></ul>

</li>
<li><p> Estimate the posterior distribution of the MRF's parameters and
possibly its network structure using Gibbs variable selection.
</p>

<ul>
<li><p> Bayesian estimation or Bayesian edge selection with <code><a href="#topic+bgm">bgm</a></code>.
</p>
</li></ul>

</li></ol>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Maarten Marsman <a href="mailto:m.marsman@uva.nl">m.marsman@uva.nl</a> (<a href="https://orcid.org/0000-0001-5309-7502">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Karoline Huth (<a href="https://orcid.org/0000-0002-0662-1591">ORCID</a>) [contributor]
</p>
</li>
<li><p> Nikola Sekulovski (<a href="https://orcid.org/0000-0001-7032-1684">ORCID</a>) [contributor]
</p>
</li>
<li><p> Don van den Bergh (<a href="https://orcid.org/0000-0002-9838-7308">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>George EI, McCulloch RE (1993).
&ldquo;Variable selection via Gibbs sampling.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>88</b>(423), 881-889.
<a href="https://doi.org/10.1080/01621459.1993.10476353">doi:10.1080/01621459.1993.10476353</a>.<br /><br /> Gottardo R, Raftery AE (2008).
&ldquo;Markov Chain Monte Carlo With Mixtures of Mutually Singular Distributions.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>17</b>(4), 949&ndash;975.
<a href="https://doi.org/10.1198/106186008X386102">doi:10.1198/106186008X386102</a>.<br /><br /> Huth K, de Ron J, Goudriaan AE, Luigjes K, Mohammadi R, van Holst RJ, Wagenmakers E, Marsman M (2023).
&ldquo;Bayesian analysis of cross-sectional networks: A tutorial in R and JASP.&rdquo;
<em>Advances in Methods and Practices in Psychological Science</em>, <b>6</b>(4), 1-18.
<a href="https://doi.org/10.1177/25152459231193334">doi:10.1177/25152459231193334</a>.<br /><br /> Marsman M, Haslbeck JMB (2023).
&ldquo;Bayesian analysis of the ordinal Markov Random Field.&rdquo;
<em>PsyArXiv</em>.
<a href="https://doi.org/10.31234/osf.io/ukwrf">doi:10.31234/osf.io/ukwrf</a>.<br /><br /> Sekulovski N, Keetelaar S, Huth K, Wagenmakers E, van Bork R, van den Bergh D, Marsman M (2023).
&ldquo;Testing conditional independence in psychometric networks: An analysis of three Bayesian methods.&rdquo;
<em>PsyArXiv</em>.
<a href="https://doi.org/10.31234/osf.io/ch7a2">doi:10.31234/osf.io/ch7a2</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://maartenmarsman.github.io/bgms/">https://maartenmarsman.github.io/bgms/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/MaartenMarsman/bgms/issues">https://github.com/MaartenMarsman/bgms/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bgm'>Bayesian edge selection or Bayesian estimation for Markov Random Fields of
mixed binary and ordinal variables using MCMC.</h2><span id='topic+bgm'></span>

<h3>Description</h3>

<p>The function <code>bgm</code> explores the joint pseudoposterior distribution of
parameters and possibly edge indicators for a Markov Random Field model for
mixed binary and ordinal variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgm(
  x,
  variable_type = "ordinal",
  reference_category,
  iter = 10000,
  burnin = 1000,
  interaction_scale = 2.5,
  threshold_alpha = 0.5,
  threshold_beta = 0.5,
  edge_selection = TRUE,
  edge_prior = c("Bernoulli", "Beta-Bernoulli"),
  inclusion_probability = 0.5,
  beta_bernoulli_alpha = 1,
  beta_bernoulli_beta = 1,
  na.action = c("listwise", "impute"),
  save = FALSE,
  display_progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgm_+3A_x">x</code></td>
<td>
<p>A data frame or matrix with <code>n</code> rows and <code>p</code> columns
containing binary and ordinal variables for <code>n</code> independent observations
and <code>p</code> variables in the network. Regular binary and ordinal variables
are recoded as non-negative integers <code>(0, 1, ..., m)</code> if not already
done. Unobserved categories are collapsed into other categories after
recoding (i.e., if category 1 is unobserved, the data are recoded from
(0, 2) to (0, 1)). Blume-Capel ordinal variables are also coded as
non-negative integers if not already done. However, since &ldquo;distance&rdquo; to the
reference category plays an important role in this model, unobserved
categories are not collapsed after recoding.</p>
</td></tr>
<tr><td><code id="bgm_+3A_variable_type">variable_type</code></td>
<td>
<p>What kind of variables are there in <code>x</code>? Can be a
single character string specifying the variable type of all <code>p</code>
variables at once or a vector of character strings of length <code>p</code>
specifying the type for each variable in <code>x</code> separately. Currently, bgm
supports &ldquo;ordinal&rdquo; and &ldquo;blume-capel&rdquo;. Binary variables are automatically
treated as &ldquo;ordinal’’. Defaults to <code>variable_type = "ordinal"</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_reference_category">reference_category</code></td>
<td>
<p>The reference category in the Blume-Capel model.
Should be an integer within the range of integer scores observed for the
&ldquo;blume-capel&rdquo; variable. Can be a single number specifying the reference
category for all Blume-Capel variables at once, or a vector of length
<code>p</code> where the <code>i</code>-th element contains the reference category for
variable <code>i</code> if it is Blume-Capel, and bgm ignores its elements for
other variable types. The value of the reference category is also recoded
when bgm recodes the corresponding observations. Only required if there is at
least one variable of type &ldquo;blume-capel&rdquo;.</p>
</td></tr>
<tr><td><code id="bgm_+3A_iter">iter</code></td>
<td>
<p>How many iterations should the Gibbs sampler run? The default of
<code>1e4</code> is for illustrative purposes. For stable estimates, it is
recommended to run the Gibbs sampler for at least <code>1e5</code> iterations.</p>
</td></tr>
<tr><td><code id="bgm_+3A_burnin">burnin</code></td>
<td>
<p>The number of iterations of the Gibbs sampler before saving its
output. Since it may take some time for the Gibbs sampler to converge to
the posterior distribution, it is recommended not to set this number too low.</p>
</td></tr>
<tr><td><code id="bgm_+3A_interaction_scale">interaction_scale</code></td>
<td>
<p>The scale of the Cauchy distribution that is used as a
prior for the pairwise interaction parameters. Defaults to <code>2.5</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_threshold_alpha">threshold_alpha</code>, <code id="bgm_+3A_threshold_beta">threshold_beta</code></td>
<td>
<p>The shape parameters of the beta-prime
prior density for the threshold parameters. Must be positive values. If the
two values are equal, the prior density is symmetric about zero. If
<code>threshold_beta</code> is greater than <code>threshold_alpha</code>, the
distribution is skewed to the left, and if <code>threshold_beta</code> is less than
<code>threshold_alpha</code>, it is skewed to the right. Smaller values tend to
lead to more diffuse prior distributions.</p>
</td></tr>
<tr><td><code id="bgm_+3A_edge_selection">edge_selection</code></td>
<td>
<p>Should the function perform Bayesian edge selection on
the edges of the MRF in addition to estimating its parameters
(<code>edge_selection = TRUE</code>), or should it just estimate the parameters
(<code>edge_selection = FALSE</code>)? The default is <code>edge_selection = TRUE</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_edge_prior">edge_prior</code></td>
<td>
<p>The inclusion or exclusion of individual edges in the
network is modeled with binary indicator variables that capture the structure
of the network. The argument <code>edge_prior</code> is used to set a prior
distribution for the edge indicator variables, i.e., the structure of the
network. Currently, two options are implemented: The Bernoulli model
<code>edge_prior = "Bernoulli"</code> assumes that the probability that an edge
between two variables is included is equal to <code>inclusion_probability</code>
and independent of other edges or variables. When
<code>inclusion_probability = 0.5</code>, this means that each possible network
structure is given the same prior weight. The Beta-Bernoulli model
<code>edge_prior = "Beta-Bernoulli"</code> assumes a beta prior for the unknown
inclusion probability with shape parameters <code>beta_bernoulli_alpha</code> and
<code>beta_bernoulli_beta</code>. If <code>beta_bernoulli_alpha = 1</code> and
<code>beta_bernoulli_beta = 1</code>, this means that networks with the same
complexity (number of edges) get the same prior weight. The default is
<code>edge_prior = "Bernoulli"</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_inclusion_probability">inclusion_probability</code></td>
<td>
<p>The prior edge inclusion probability for the
Bernoulli model. Can be a single probability, or a matrix of <code>p</code> rows
and <code>p</code> columns specifying an inclusion probability for each edge pair.
The default is <code>inclusion_probability = 0.5</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_beta_bernoulli_alpha">beta_bernoulli_alpha</code>, <code id="bgm_+3A_beta_bernoulli_beta">beta_bernoulli_beta</code></td>
<td>
<p>The two shape parameters of
the Beta prior density for the Bernoulli inclusion probability. Must be
positive numbers. Defaults to <code>beta_bernoulli_alpha = 1</code> and
<code>beta_bernoulli_beta = 1</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_na.action">na.action</code></td>
<td>
<p>How do you want the function to handle missing data? If
<code>na.action = "listwise"</code>, listwise deletion is used. If
<code>na.action = "impute"</code>, missing data are imputed iteratively during the
MCMC procedure. Since imputation of missing data can have a negative impact
on the convergence speed of the MCMC procedure, it is recommended to run the
MCMC for more iterations. Also, since the numerical routines that search for
the mode of the posterior do not have an imputation option, the bgm function
will automatically switch to <code>interaction_prior = "Cauchy"</code> and
<code>adaptive = TRUE</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_save">save</code></td>
<td>
<p>Should the function collect and return all samples from the Gibbs
sampler (<code>save = TRUE</code>)? Or should it only return the (model-averaged)
posterior means (<code>save = FALSE</code>)? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bgm_+3A_display_progress">display_progress</code></td>
<td>
<p>Should the function show a progress bar
(<code>display_progress = TRUE</code>)? Or not (<code>display_progress = FALSE</code>)?
The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, bgm supports two types of ordinal variables. The regular, default,
ordinal variable type has no restrictions on its distribution. Every response
category except the first receives its own threshold parameter. The
Blume-Capel ordinal variable assumes that there is a specific reference
category, such as the &ldquo;neutral&rdquo; in a Likert scale, and responses are scored
in terms of their distance to this reference category. Specifically, the
Blume-Capel model specifies the following quadratic model for the threshold
parameters:
</p>
<p style="text-align: center;"><code class="reqn">\mu_{\text{c}} = \alpha \times \text{c} + \beta \times (\text{c} - \text{r})^2,</code>
</p>

<p>where <code class="reqn">\mu_{\text{c}}</code> is the threshold for category c.
The parameter <code class="reqn">\alpha</code> models a linear trend across categories,
such that <code class="reqn">\alpha &gt; 0</code> leads to an increasing number of
observations in higher response categories and <code class="reqn">\alpha &lt;0</code>
leads to a decreasing number of observations in higher response categories.
The parameter <code class="reqn">\beta</code> models the response style in terms of an
offset with respect to the reference category <code class="reqn">r</code>; if <code class="reqn">\beta&lt;0</code>
there is a preference to respond in the reference category (i.e., the model
introduces a penalty for responding in a category further away from the
reference_category category <code>r</code>), while if <code class="reqn">\beta &gt; 0</code>
there is preference to score in the extreme categories further away from the
reference_category category.
</p>
<p>The Bayesian estimation procedure (<code>edge_selection = FALSE</code>) simply
estimates the threshold and pairwise interaction parameters of the ordinal
MRF, while the Bayesian edge selection procedure
(<code>edge_selection = TRUE</code>) also models the probability that individual
edges should be included or excluded from the model. Bayesian edge selection
imposes a discrete spike and slab prior distribution on the pairwise
interactions. By formulating it as a mixture of mutually singular
distributions, the function can use a combination of Metropolis-Hastings and
Gibbs sampling to create a Markov chain that has the joint posterior
distribution as an invariant. The current option for the slab distribution is
a Cauchy with an optional scaling parameter. The slab distribution is also used
as the prior for the interaction parameters for Bayesian estimation. A
beta-prime distribution is used for the exponent of the category parameters.
For Bayesian edge selection, two prior distributions are implemented for the
edge inclusion variables (i.e., the prior probability that an edge is
included); the Bernoulli prior and the Beta-Bernoulli prior.
</p>


<h3>Value</h3>

<p>If <code>save = FALSE</code> (the default), the result is a list of class
&ldquo;bgms&rdquo; containing the following matrices:
</p>

<ul>
<li> <p><code>gamma</code>: A matrix with <code>p</code> rows and <code>p</code> columns,
containing posterior inclusion probabilities of individual edges.
</p>
</li>
<li> <p><code>interactions</code>: A matrix with <code>p</code> rows and <code>p</code> columns,
containing model-averaged posterior means of the pairwise associations.
</p>
</li>
<li> <p><code>thresholds</code>: A matrix with <code>p</code> rows and <code>max(m)</code>
columns, containing model-averaged category thresholds. In the case of
&ldquo;blume-capel&rdquo; variables, the first entry is the parameter for the linear
effect and the second entry is the parameter for the quadratic effect, which
models the offset to the reference category.
</p>
</li></ul>

<p>If <code>save = TRUE</code>, the result is a list of class &ldquo;bgms&rdquo; containing:
</p>

<ul>
<li> <p><code>gamma</code>: A matrix with <code>iter</code> rows and
<code>p * (p - 1) / 2</code> columns, containing the edge inclusion indicators from
every iteration of the Gibbs sampler.
</p>
</li>
<li> <p><code>interactions</code>: A matrix with <code>iter</code> rows and
<code>p * (p - 1) / 2</code> columns, containing parameter states from every
iteration of the Gibbs sampler for the pairwise associations.
</p>
</li>
<li> <p><code>thresholds</code>: A matrix with <code>iter</code> rows and
<code>sum(m)</code> columns, containing parameter states from every iteration of
the Gibbs sampler for the category thresholds.
</p>
</li></ul>

<p>Column averages of these matrices provide the model-averaged posterior means.
</p>
<p>In addition to the analysis results, the bgm output lists some of the
arguments of its call. This is useful for post-processing the results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 #Store user par() settings
 op &lt;- par(no.readonly = TRUE)

 ##Analyse the Wenchuan dataset

 # Here, we use 1e4 iterations, for an actual analysis please use at least
 # 1e5 iterations.
 fit = bgm(x = Wenchuan)


 #------------------------------------------------------------------------------|
 # INCLUSION - EDGE WEIGHT PLOT
 #------------------------------------------------------------------------------|

 par(mar = c(6, 5, 1, 1))
 plot(x = fit$interactions[lower.tri(fit$interactions)],
      y = fit$gamma[lower.tri(fit$gamma)], ylim = c(0, 1),
      xlab = "", ylab = "", axes = FALSE, pch = 21, bg = "gray", cex = 1.3)
 abline(h = 0, lty = 2, col = "gray")
 abline(h = 1, lty = 2, col = "gray")
 abline(h = .5, lty = 2, col = "gray")
 mtext("Posterior Mode Edge Weight", side = 1, line = 3, cex = 1.7)
 mtext("Posterior Inclusion Probability", side = 2, line = 3, cex = 1.7)
 axis(1)
 axis(2, las = 1)


 #------------------------------------------------------------------------------|
 # EVIDENCE - EDGE WEIGHT PLOT
 #------------------------------------------------------------------------------|

 #For the default choice of the structure prior, the prior odds equal one:
 prior.odds = 1
 posterior.inclusion = fit$gamma[lower.tri(fit$gamma)]
 posterior.odds = posterior.inclusion / (1 - posterior.inclusion)
 log.bayesfactor = log(posterior.odds / prior.odds)
 log.bayesfactor[log.bayesfactor &gt; 5] = 5

 par(mar = c(5, 5, 1, 1) + 0.1)
 plot(fit$interactions[lower.tri(fit$interactions)], log.bayesfactor, pch = 21, bg = "#bfbfbf",
      cex = 1.3, axes = FALSE, xlab = "", ylab = "", ylim = c(-5, 5.5),
      xlim = c(-0.5, 1.5))
 axis(1)
 axis(2, las = 1)
 abline(h = log(1/10), lwd = 2, col = "#bfbfbf")
 abline(h = log(10), lwd = 2, col = "#bfbfbf")

 text(x = 1, y = log(1 / 10), labels = "Evidence for Exclusion", pos = 1,
      cex = 1.7)
 text(x = 1, y = log(10), labels = "Evidence for Inclusion", pos = 3, cex = 1.7)
 text(x = 1, y = 0, labels = "Absence of Evidence", cex = 1.7)
 mtext("Log-Inclusion Bayes Factor", side = 2, line = 3, cex = 1.5, las = 0)
 mtext("Posterior Mean Interactions ", side = 1, line = 3.7, cex = 1.5, las = 0)


 #------------------------------------------------------------------------------|
 # THE LOCAL MEDIAN PROBABILITY NETWORK
 #------------------------------------------------------------------------------|

 tmp = fit$interactions[lower.tri(fit$interactions)]
 tmp[posterior.inclusion &lt; 0.5] = 0

 median.prob.model = matrix(0, nrow = ncol(Wenchuan), ncol = ncol(Wenchuan))
 median.prob.model[lower.tri(median.prob.model)] = tmp
 median.prob.model = median.prob.model + t(median.prob.model)

 rownames(median.prob.model) = colnames(Wenchuan)
 colnames(median.prob.model) = colnames(Wenchuan)

 library(qgraph)
 qgraph(median.prob.model,
        theme = "TeamFortress",
        maximum = .5,
        fade = FALSE,
        color = c("#f0ae0e"), vsize = 10, repulsion = .9,
        label.cex = 1.1, label.scale = "FALSE",
        labels = colnames(Wenchuan))

 #Restore user par() settings
 par(op)

</code></pre>

<hr>
<h2 id='mrfSampler'>Sample states of the ordinal MRF</h2><span id='topic+mrfSampler'></span>

<h3>Description</h3>

<p>This function samples states from the ordinal MRF using a Gibbs sampler. The
Gibbs sampler is initiated with random values from the response options,
after which it proceeds by simulating states for each variable from a logistic
model using the other variable states as predictor variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mrfSampler(
  no_states,
  no_variables,
  no_categories,
  interactions,
  thresholds,
  variable_type = "ordinal",
  reference_category,
  iter = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mrfSampler_+3A_no_states">no_states</code></td>
<td>
<p>The number of states of the ordinal MRF to be generated.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_no_variables">no_variables</code></td>
<td>
<p>The number of variables in the ordinal MRF.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_no_categories">no_categories</code></td>
<td>
<p>Either a positive integer or a vector of positive
integers of length <code>no_variables</code>. The number of response categories on top
of the base category: <code>no_categories = 1</code> generates binary states.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_interactions">interactions</code></td>
<td>
<p>A symmetric <code>no_variables</code> by <code>no_variables</code> matrix of
pairwise interactions. Only its off-diagonal elements are used.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_thresholds">thresholds</code></td>
<td>
<p>A <code>no_variables</code> by <code>max(no_categories)</code> matrix of
category thresholds. The elements in row <code>i</code> indicate the thresholds of
variable <code>i</code>. If <code>no_categories</code> is a vector, only the first
<code>no_categories[i]</code> elements are used in row <code>i</code>. If the Blume-Capel
model is used for the category thresholds for variable <code>i</code>, then row
<code>i</code> requires two values (details below); the first is
<code class="reqn">\alpha</code>, the linear contribution of the Blume-Capel model and
the second is <code class="reqn">\beta</code>, the quadratic contribution.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_variable_type">variable_type</code></td>
<td>
<p>What kind of variables are simulated? Can be a single
character string specifying the variable type of all <code>p</code> variables at
once or a vector of character strings of length <code>p</code> specifying the type
for each variable separately. Currently, bgm supports &ldquo;ordinal&rdquo; and
&ldquo;blume-capel&rdquo;. Binary variables are automatically treated as &ldquo;ordinal’’.
Defaults to <code>variable_type = "ordinal"</code>.</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_reference_category">reference_category</code></td>
<td>
<p>An integer vector of length <code>no_variables</code> specifying the
reference_category category that is used for the Blume-Capel model (details below).
Can be any integer value between <code>0</code> and <code>no_categories</code> (or
<code>no_categories[i]</code>).</p>
</td></tr>
<tr><td><code id="mrfSampler_+3A_iter">iter</code></td>
<td>
<p>The number of iterations used by the Gibbs sampler.
The function provides the last state of the Gibbs sampler as output. By
default set to <code>1e3</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two modeling options for the category thresholds. The default
option assumes that the category thresholds are free, except that the first
threshold is set to zero for identification. The user then only needs to
specify the thresholds for the remaining response categories. This option is
useful for any type of ordinal variable and gives the user the most freedom
in specifying their model.
</p>
<p>The Blume-Capel option is specifically designed for ordinal variables that
have a special type of reference_category category, such as the neutral
category in a Likert scale. The Blume-Capel model specifies the following
quadratic model for the threshold parameters:
</p>
<p style="text-align: center;"><code class="reqn">\mu_{\text{c}} = \alpha \times \text{c} + \beta \times (\text{c} - \text{r})^2,</code>
</p>

<p>where <code class="reqn">\mu_{\text{c}}</code> is the threshold for category c
(which now includes zero), <code class="reqn">\alpha</code> offers a linear trend
across categories (increasing threshold values if
<code class="reqn">\alpha &gt; 0</code> and decreasing threshold values if
<code class="reqn">\alpha &lt;0</code>), if <code class="reqn">\beta &lt; 0</code>, it offers an
increasing penalty for responding in a category further away from the
reference_category category r, while <code class="reqn">\beta &gt; 0</code> suggests a
preference for responding in the reference_category category.
</p>


<h3>Value</h3>

<p>A <code>no_states</code> by <code>no_variables</code> matrix of simulated states of
the ordinal MRF.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate responses from a network of five binary and ordinal variables.
no_variables = 5
no_categories = sample(1:5, size = no_variables, replace = TRUE)

Interactions = matrix(0, nrow = no_variables, ncol = no_variables)
Interactions[2, 1] = Interactions[4, 1] = Interactions[3, 2] =
  Interactions[5, 2] = Interactions[5, 4] = .25
Interactions = Interactions + t(Interactions)
Thresholds = matrix(0, nrow = no_variables, ncol = max(no_categories))
x = mrfSampler(no_states = 1e3,
               no_variables = no_variables,
               no_categories = no_categories,
               interactions = Interactions,
               thresholds = Thresholds)
</code></pre>

<hr>
<h2 id='print.bgms'>Print method for <code>bgms</code> objects</h2><span id='topic+print.bgms'></span>

<h3>Description</h3>

<p>Used to prevent bgms output cluttering the console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bgms'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.bgms_+3A_x">x</code></td>
<td>
<p>An object of class <code>bgms</code>.</p>
</td></tr>
<tr><td><code id="print.bgms_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>

<hr>
<h2 id='Wenchuan'>Post-traumatic stress disorder symptoms of Wenchuan earthquake survivors</h2><span id='topic+Wenchuan'></span>

<h3>Description</h3>

<p>A data set containing items measuring symptoms of posttraumatic stress 
disorder (PTSD) (McNally et al. 2015). Participants were 362 
Chinese adults who survived the Wenchuan earthquake and lost at least one 
child in the disaster. PTSD symptoms were reported using the civilian version 
of the Posttraumatic Checklist, which consists of 17 items, each assessing 
one of the DSM-IV symptoms of PTSD. Participants rated each item on a 
five-point scale ranging from &ldquo;not at all&rdquo; to &ldquo;extremely&rdquo; to indicate how 
much the symptom bothered them in the past month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Wenchuan")
</code></pre>


<h3>Format</h3>

<p>A matrix with 362 rows and 17 columns:
</p>

<dl>
<dt>intrusion</dt><dd><p>Repeated, disturbing memories, thoughts, or images of a 
stressful experience from the past?</p>
</dd>
<dt>dreams</dt><dd><p>Repeated, disturbing dreams of a stressful experience from 
the past?</p>
</dd>
<dt>flash</dt><dd><p>Suddenly acting or feeling as if a stressful experience were 
happening again (as if you were reliving it)?</p>
</dd>
<dt>upset</dt><dd><p>Feeling very upset when something reminded you of a stressful 
experience from the past?</p>
</dd>
<dt>physior</dt><dd><p>Having physical reactions (e.g., heart pounding, trouble 
breathing, sweating) when something reminded you of a stressful experience 
from the past?</p>
</dd>
<dt>avoidth</dt><dd><p>Avoiding thinking about or talking about a stressful 
experience from the past or avoiding having feelings related to it?</p>
</dd>
<dt>avoidact</dt><dd><p>Avoiding activities or situations because they reminded you 
of a stressful experience from the past?</p>
</dd>
<dt>amnesia</dt><dd><p>Trouble remembering important parts of a stressful 
experience from the past?</p>
</dd>
<dt>lossint</dt><dd><p>Loss of interest in activities that you used to enjoy?</p>
</dd>
<dt>distant</dt><dd><p>Feeling distant or cut off from other people?</p>
</dd>
<dt>numb</dt><dd><p>Feeling emotionally numb or being unable to have loving 
feelings for those close to you?</p>
</dd>
<dt>future</dt><dd><p>Feeling as if your future will somehow be cut short?</p>
</dd>
<dt>sleep</dt><dd><p>Trouble falling or staying asleep?</p>
</dd>
<dt>anger</dt><dd><p>Feeling irritable or having angry outbursts?</p>
</dd>
<dt>concen</dt><dd><p>Having difficulty concentrating?</p>
</dd>
<dt>hyper</dt><dd><p>Being &quot;super-alert&quot; or watchful or on guard?</p>
</dd>
<dt>startle</dt><dd><p>Feeling jumpy or easily startled?</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://psychosystems.org/wp-content/uploads/2014/10/Wenchuan.csv">http://psychosystems.org/wp-content/uploads/2014/10/Wenchuan.csv</a>
</p>


<h3>References</h3>

<p>McNally RJ, Robinaugh DJ, Wu GWY, Wang L, Deserno MK, Borsboom D (2015).
&ldquo;Mental disorders as causal systems: A network approach to posttraumatic stress disorder.&rdquo;
<em>Clinical Psychological Science</em>, <b>5</b>(6), 836&ndash;849.
<a href="https://doi.org/10.1177/2167702614553230">doi:10.1177/2167702614553230</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
