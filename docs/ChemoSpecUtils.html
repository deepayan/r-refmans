<!DOCTYPE html><html><head><title>Help for package ChemoSpecUtils</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ChemoSpecUtils}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ChemoSpecUtils-package'><p>Functions Supporting Packages ChemoSpec and ChemoSpec2D</p></a></li>
<li><a href='#.addEllipseInfo'><p>Add Info About Ellipses to Plot</p></a></li>
<li><a href='#.addLegend'><p>Add a Legend to a Plot</p></a></li>
<li><a href='#.addMethod'><p>Add Info About Data Reduction Method to Plot</p></a></li>
<li><a href='#.chkArgs'><p>Check spectra and pca Arguments of Functions That Require Them</p></a></li>
<li><a href='#.chkReqGraphicsPkgs'><p>Verify Required Graphics Packages are Available.</p></a></li>
<li><a href='#.colLeaf'><p>Color the Leaves of a Dendrogram Based on a Spectra Object</p></a></li>
<li><a href='#.computeEllipses'><p>Compute Confidence Ellipses</p></a></li>
<li><a href='#.distPlot'><p>Draw a Distance Plot</p></a></li>
<li><a href='#.drawEllipses'><p>Add Ellipses to Plot</p></a></li>
<li><a href='#.drawPoints'><p>Add Points to a Score Plot</p></a></li>
<li><a href='#.extraData'><p>Check for Extra Data Appended to a Spectra or Spectra2D Object</p></a></li>
<li><a href='#.findNA'><p>Find NA in a Spectra2D Object</p></a></li>
<li><a href='#.getExtremeCoords'><p>getExtremeCoords</p></a></li>
<li><a href='#.getLimits'><p>Process Limits for a Spectra2D Plot</p></a></li>
<li><a href='#.getVarExplained'><p>Compute the Variance Explained from PCA or Other Reduction Methods</p></a></li>
<li><a href='#.ggAddLegend'><p>Add Legend to a ggplot2 Plot</p></a></li>
<li><a href='#.ggAnnotate'><p>Annotate a ggplot2 Plot with Text</p></a></li>
<li><a href='#.ggRepel'><p>Wrapper for geom_text_repel</p></a></li>
<li><a href='#.groupNcolor'><p>Assign Group Membership and Colors for a Spectra or Spectra2D Object</p></a></li>
<li><a href='#.labelExtremes'><p>Label Extreme Values</p></a></li>
<li><a href='#.plotHCA'><p>Plot Dendrogram for Spectra or Spectra2D Object</p></a></li>
<li><a href='#.prepLegendCoords'><p>Sanitize Legend Coordinates</p></a></li>
<li><a href='#.remGrpSam'><p>Remove Groups or Samples from a Spectra or Spectra2D Object</p></a></li>
<li><a href='#.scorePlot'><p>scorePlot</p></a></li>
<li><a href='#.shrinkLeaf'><p>Shrink the Leaves of a Dendrogram Based on a Spectra Object</p></a></li>
<li><a href='#check4Gaps'><p>Check for Discontinuities (Gaps) in a Vector &amp; Optionally Make a Plot</p></a></li>
<li><a href='#checkForPackageWithVersion'><p>Check for an Installed Package with a Particular Version or Newer</p></a></li>
<li><a href='#chkGraphicsOpt'><p>Check the Graphic Output Option/Mode</p></a></li>
<li><a href='#chkSpectra'><p>Verify the Integrity of a Spectra or Spectra2D Object</p></a></li>
<li><a href='#colorSymbol'><p>Color in ChemoSpec and ChemoSpec2D</p></a></li>
<li><a href='#conColScheme'><p>Change the Color Scheme of a Spectra or Spectra2D Object</p></a></li>
<li><a href='#GraphicsOptions'><p>Graphic Output Options in ChemoSpec and ChemoSpec2D</p></a></li>
<li><a href='#hcaScores'><p>HCA on PCA/MIA/PARAFAC scores from a Spectra or Spectra2D Object</p></a></li>
<li><a href='#plotScores'><p>Plot Scores from PCA, MIA or PARAFAC Analysis of a Spectra or Spectra2D Object</p></a></li>
<li><a href='#plotScree'><p>Scree Plots from PCA or MIA Analysis of a Spectra or Spectra2D Object</p></a></li>
<li><a href='#removeFreq'><p>Remove Frequencies from a Spectra or Spectra2D Object</p></a></li>
<li><a href='#removeGroup'><p>Remove a Group from a Spectra or Spectra2D Object</p></a></li>
<li><a href='#removeSample'><p>Remove Samples from a Spectra or Spectra2D Object</p></a></li>
<li><a href='#rowDist'><p>Compute Distance Between Rows of a Matrix</p></a></li>
<li><a href='#sampleDist'><p>Compute the Distances Between Samples in a Spectra or Spectra2D Object</p></a></li>
<li><a href='#sumGroups'><p>Summarize the Group Membership of a Spectra or Spectra2D Object</p></a></li>
<li><a href='#sumSpectra'><p>Summarize a Spectra or Spectra2D Object</p></a></li>
<li><a href='#updateGroups'><p>Update Group Names in a Spectra or Spectra2D Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions Supporting Packages ChemoSpec and ChemoSpec2D</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-31</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions supporting the common needs of packages 'ChemoSpec' and 'ChemoSpec2D'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ChemoSpec (&ge; 6.0), ChemoSpec2D (&ge; 0.5), tinytest,
robustbase, RColorBrewer, amap, irlba, lattice, roxut,
patchwork, ThreeWay, multiway, mvoutlier</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, ggplot2, ggrepel, plotly, magrittr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bryanhanson/ChemoSpecUtils">https://github.com/bryanhanson/ChemoSpecUtils</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bryanhanson/ChemoSpecUtils/issues">https://github.com/bryanhanson/ChemoSpecUtils/issues</a></td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-31 15:28:29 UTC; bryanh</td>
</tr>
<tr>
<td>Author:</td>
<td>Bryan A. Hanson <a href="https://orcid.org/0000-0003-3536-8246"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Tejasvi Gupta [ctb] (implemented ggplot2 graphics)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bryan A. Hanson &lt;hanson@depauw.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-31 17:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ChemoSpecUtils-package'>Functions Supporting Packages ChemoSpec and ChemoSpec2D</h2><span id='topic+ChemoSpecUtils-package'></span><span id='topic+ChemoSpecUtils'></span>

<h3>Description</h3>

<p>Functions supporting the packages ChemoSpec and ChemoSpec2D.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>
<p>Maintainer: Bryan A. Hanson <a href="mailto:hanson@depauw.edu">hanson@depauw.edu</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/bryanhanson/ChemoSpecUtils">https://github.com/bryanhanson/ChemoSpecUtils</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/bryanhanson/ChemoSpecUtils/issues">https://github.com/bryanhanson/ChemoSpecUtils/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.addEllipseInfo'>Add Info About Ellipses to Plot</h2><span id='topic+.addEllipseInfo'></span>

<h3>Description</h3>

<p><em>Internal</em> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.addEllipseInfo(ellipse)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".addEllipseInfo_+3A_ellipse">ellipse</code></td>
<td>
<p>String giving the type of ellipse; one of <code>cls</code>, <code>rob</code> or <code>both</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Side effect is a modified plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.addLegend'>Add a Legend to a Plot</h2><span id='topic+.addLegend'></span>

<h3>Description</h3>

<p><em>Internal function</em>.  Add a legend to a plot created by either <code>ChemoSpec</code> or <code>ChemoSpec2D</code>.
<code>ChemoSpec2D</code> does not use symbols.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.addLegend(spectra, leg.loc, use.sym, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".addLegend_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".addLegend_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Either a list with elements <code>x</code> and <code>y</code>, or a string like <code>'topright'</code>.  Values in a list should be on <code style="white-space: pre;">&#8288;[0,1]&#8288;</code>, i.e. the lower left of the plot area is <code style="white-space: pre;">&#8288;0,0&#8288;</code> and the upper right is <code style="white-space: pre;">&#8288;1,1&#8288;</code>.  Allowed string values are those described in <code><a href="graphics.html#topic+legend">graphics::legend()</a></code> under 'Details'. A value of <code>'none'</code> is acceptable as well.</p>
</td></tr>
<tr><td><code id=".addLegend_+3A_use.sym">use.sym</code></td>
<td>
<p>Logical; if true, the color scheme is set to black and the
points plotted with symbols.  Applies only to <code>ChemoSpec</code>.</p>
</td></tr>
<tr><td><code id=".addLegend_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Side effect is to modify an existing plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.addMethod'>Add Info About Data Reduction Method to Plot</h2><span id='topic+.addMethod'></span>

<h3>Description</h3>

<p><em>Internal</em> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.addMethod(pca)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".addMethod_+3A_pca">pca</code></td>
<td>
<p>An object of <code>prcomp</code> etc with a <code>method</code> slot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Side effect is a modifed plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.chkArgs'>Check spectra and pca Arguments of Functions That Require Them</h2><span id='topic+.chkArgs'></span>

<h3>Description</h3>

<p><em>Internal</em> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.chkArgs(mode = 11L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".chkArgs_+3A_mode">mode</code></td>
<td>
<p>Integer code giving the type of check to be run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Stops if there is a problem with the arguments.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.chkReqGraphicsPkgs'>Verify Required Graphics Packages are Available.</h2><span id='topic+.chkReqGraphicsPkgs'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.chkReqGraphicsPkgs(pkgs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".chkReqGraphicsPkgs_+3A_pkgs">pkgs</code></td>
<td>
<p>Character. Vector of package names.  Each is checked for availability.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.colLeaf'>Color the Leaves of a Dendrogram Based on a Spectra Object</h2><span id='topic+.colLeaf'></span>

<h3>Description</h3>

<p><em>Internal function.</em> This function colors the leaves of a dendrogram object.  The code was taken
from the help files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.colLeaf(n, spectra)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".colLeaf_+3A_n">n</code></td>
<td>
<p>A node in a dendrogram object.</p>
</td></tr>
<tr><td><code id=".colLeaf_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a node with the label color properties set.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.computeEllipses'>Compute Confidence Ellipses</h2><span id='topic+.computeEllipses'></span>

<h3>Description</h3>

<p><em>Internal function</em>. A utility function which when given a <code>x,y</code> data set computes both classical
and robust confidence ellipses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.computeEllipses(x, quan = 1/2, alpha = 0.025)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".computeEllipses_+3A_x">x</code></td>
<td>
<p>As per <code><a href="mvoutlier.html#topic+corr.plot">corr.plot</a></code>.</p>
</td></tr>
<tr><td><code id=".computeEllipses_+3A_quan">quan</code></td>
<td>
<p>As per <code><a href="mvoutlier.html#topic+corr.plot">corr.plot</a></code>.</p>
</td></tr>
<tr><td><code id=".computeEllipses_+3A_alpha">alpha</code></td>
<td>
<p>As per <code><a href="mvoutlier.html#topic+corr.plot">corr.plot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements (a simpler version of that in the
original function <code><a href="mvoutlier.html#topic+corr.plot">corr.plot</a></code>): </p>
<table>
<tr><td><code>x.cls</code></td>
<td>
<p>The x
values for the classical ellipse.</p>
</td></tr> <tr><td><code>y.cls</code></td>
<td>
<p>The y values for the
classical ellipse.</p>
</td></tr> <tr><td><code>c</code></td>
<td>
<p>The correlation value for the classical
ellipse.</p>
</td></tr> <tr><td><code>x.rob</code></td>
<td>
<p>The x values for the robust ellipse.</p>
</td></tr>
<tr><td><code>y.rob</code></td>
<td>
<p>The y values for the robust ellipse.</p>
</td></tr> <tr><td><code>r</code></td>
<td>
<p>The correlation
value for the robust ellipse.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p>See function <code><a href="mvoutlier.html#topic+corr.plot">corr.plot</a></code> in package
<span class="pkg">mvoutlier</span> on which this function is based.
</p>

<hr>
<h2 id='.distPlot'>Draw a Distance Plot</h2><span id='topic+.distPlot'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.distPlot(spectra, M, method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".distPlot_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".distPlot_+3A_m">M</code></td>
<td>
<p>Matrix of class <code>dist</code> containing the distances.</p>
</td></tr>
<tr><td><code id=".distPlot_+3A_method">method</code></td>
<td>
<p>String.  The distance method used to create the matrix.</p>
</td></tr>
<tr><td><code id=".distPlot_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Side effect is a plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.drawEllipses'>Add Ellipses to Plot</h2><span id='topic+.drawEllipses'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.drawEllipses(ELL, gr, ellipse, use.sym, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".drawEllipses_+3A_ell">ELL</code></td>
<td>
<p>Coordinates of the ellipse points.</p>
</td></tr>
<tr><td><code id=".drawEllipses_+3A_gr">gr</code></td>
<td>
<p>Group information.</p>
</td></tr>
<tr><td><code id=".drawEllipses_+3A_ellipse">ellipse</code></td>
<td>
<p>Type of ellipse; one of <code>cls</code>, <code>rob</code> or <code>both</code>.</p>
</td></tr>
<tr><td><code id=".drawEllipses_+3A_use.sym">use.sym</code></td>
<td>
<p>Logical.  Should symbols be used?  For this function, determines color of lines.</p>
</td></tr>
<tr><td><code id=".drawEllipses_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Side effect is a modified plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.drawPoints'>Add Points to a Score Plot</h2><span id='topic+.drawPoints'></span>

<h3>Description</h3>

<p><em>Internal function.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.drawPoints(PCs, spectra, case, use.sym, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".drawPoints_+3A_pcs">PCs</code></td>
<td>
<p>Integer.  The PCs to plot.</p>
</td></tr>
<tr><td><code id=".drawPoints_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".drawPoints_+3A_case">case</code></td>
<td>
<p>String. The type of data reduction that was done.</p>
</td></tr>
<tr><td><code id=".drawPoints_+3A_use.sym">use.sym</code></td>
<td>
<p>Logical.  Should symbols be used?</p>
</td></tr>
<tr><td><code id=".drawPoints_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Side effect is a modifed plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.extraData'>Check for Extra Data Appended to a Spectra or Spectra2D Object</h2><span id='topic+.extraData'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.extraData(spectra)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".extraData_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>.  Logical. <code>TRUE</code> if a mismatch was found for the data lengths.  Message are emited as well.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.findNA'>Find NA in a Spectra2D Object</h2><span id='topic+.findNA'></span>

<h3>Description</h3>

<p><em>Internal function</em>. This function identifies the extent of any NA in a <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code> object.
This information can be used for summaries and plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.findNA(spectra, retFreq = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".findNA_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".findNA_+3A_retfreq">retFreq</code></td>
<td>
<p>Logical. Should the frequencies be returned?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements giving the indices of NAs for rows and columns,
unless <code>retFreq = TRUE</code>, in which case the frequencies are returned.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.getExtremeCoords'>getExtremeCoords</h2><span id='topic+.getExtremeCoords'></span>

<h3>Description</h3>

<p><em>Internal function</em>. A utility function which returns a list of the extreme
coordinates that are to be labelled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.getExtremeCoords(data, names, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".getExtremeCoords_+3A_data">data</code></td>
<td>
<p>A matrix containing the x values of the points/samples in the
first column, and the y values in the second.</p>
</td></tr>
<tr><td><code id=".getExtremeCoords_+3A_names">names</code></td>
<td>
<p>A character vector of sample names.  Length must match the
number of rows in <code>data</code>.</p>
</td></tr>
<tr><td><code id=".getExtremeCoords_+3A_tol">tol</code></td>
<td>
<p><code>.writeDoc_Tol()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements <code>x</code>, <code>y</code> and <code>l</code>, giving the coordinates,
and labels of the most extreme data points.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.getLimits'>Process Limits for a Spectra2D Plot</h2><span id='topic+.getLimits'></span>

<h3>Description</h3>

<p><em>Internal function</em>. Get limits from a user specified formula
(used in <code><a href="ChemoSpec2D.html#topic+removeFreq">ChemoSpec2D::removeFreq()</a></code> and <code><a href="ChemoSpec2D.html#topic+removePeaks2D">ChemoSpec2D::removePeaks2D()</a></code>).
The user may not know or think about whether F2 or F1 is ascending or descending
so we will try to get it right no matter how the user gives
the formula; e.g. 6 ~ 3 ought to be handled as 3 ~ 6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.getLimits(spectra, dim, form)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".getLimits_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".getLimits_+3A_dim">dim</code></td>
<td>
<p>The dimension for which the limits are desired.</p>
</td></tr>
<tr><td><code id=".getLimits_+3A_form">form</code></td>
<td>
<p>A formula specification.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of S3 class <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.getVarExplained'>Compute the Variance Explained from PCA or Other Reduction Methods</h2><span id='topic+.getVarExplained'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.getVarExplained(so)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".getVarExplained_+3A_so">so</code></td>
<td>
<p>A object returned by a data reduction method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector giving the variance explained by each successive component.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.ggAddLegend'>Add Legend to a ggplot2 Plot</h2><span id='topic+.ggAddLegend'></span>

<h3>Description</h3>

<p><em>Internal function</em>. This function creates a suitable legend and returns it as a set of grobs,
ready to be added to an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ggAddLegend(spectra, use.sym, leg.loc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ggAddLegend_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code>.</p>
</td></tr>
<tr><td><code id=".ggAddLegend_+3A_use.sym">use.sym</code></td>
<td>
<p>Logical specifying if symbols will be used or not.</p>
</td></tr>
<tr><td><code id=".ggAddLegend_+3A_leg.loc">leg.loc</code></td>
<td>
<p>A list giving x, y coordinates, and a reference point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A grob containing the legend.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.ggAnnotate'>Annotate a ggplot2 Plot with Text</h2><span id='topic+.ggAnnotate'></span>

<h3>Description</h3>

<p><em>Internal function</em>. General purpose function to add text to a ggplot2 plot.  Uses
<code>textGrob</code> so arguments like <code>hjust</code> can be passed via ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ggAnnotate(text, x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ggAnnotate_+3A_text">text</code></td>
<td>
<p>Character.  The text to be plotted, but certain values are intercepted
for special handling.</p>
</td></tr>
<tr><td><code id=".ggAnnotate_+3A_x">x</code></td>
<td>
<p>Numeric. The x coordinate for the text to be plotted, in NPC.</p>
</td></tr>
<tr><td><code id=".ggAnnotate_+3A_y">y</code></td>
<td>
<p>Numeric. The y coordinate for the text to be plotted, in NPC.</p>
</td></tr>
<tr><td><code id=".ggAnnotate_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>textGrob</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A custom annotation grob, ready to be added to an existing plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.ggRepel'>Wrapper for geom_text_repel</h2><span id='topic+.ggRepel'></span>

<h3>Description</h3>

<p><em>Internal function</em>. Wrapper for <code>geom_text_repel</code> to make customization, modifcation
and maintenance easy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ggRepel(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ggRepel_+3A_df">df</code></td>
<td>
<p>Data frame, containing elements <code>x</code>, <code>y</code> and <code>label</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A geom that can be added to an existing plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.groupNcolor'>Assign Group Membership and Colors for a Spectra or Spectra2D Object</h2><span id='topic+.groupNcolor'></span>

<h3>Description</h3>

<p><em>Internal function</em>. A utility function which looks for <code>gr.crit</code> in the file names of .csv
files and assigns group membership.  Also assigns a color,
and for <code>Spectra</code> objects, a symbol and an
alternate symbol to each group.  Warnings are given if there are file names
that don't match entries in <code>gr.crit</code> or there are entries in
<code>gr.crit</code> that don't match any file names.  An internal function, not
generally called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.groupNcolor(spectra, gr.crit = NULL, gr.cols = "auto", mode = "1D")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".groupNcolor_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".groupNcolor_+3A_gr.crit">gr.crit</code></td>
<td>
<p>As per <code><a href="ChemoSpec.html#topic+files2SpectraObject">ChemoSpec::files2SpectraObject()</a></code>.</p>
</td></tr>
<tr><td><code id=".groupNcolor_+3A_gr.cols">gr.cols</code></td>
<td>
<p>As per <code><a href="ChemoSpec.html#topic+files2SpectraObject">ChemoSpec::files2SpectraObject()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>complete</em> object of S3 class <code>Spectra</code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code>.  This
function is the last internal step in creating these objects.
Until this function has done its job, these objects
will not pass checks as the assembly is not complete
(see <code><a href="#topic+chkSpectra">chkSpectra</a></code>).
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code><a href="ChemoSpec.html#topic+files2SpectraObject">files2SpectraObject</a></code> or
<code>files2Spectra2DObject</code>for details;
<code><a href="#topic+sumGroups">sumGroups</a></code> to see the outcome.
</p>

<hr>
<h2 id='.labelExtremes'>Label Extreme Values</h2><span id='topic+.labelExtremes'></span>

<h3>Description</h3>

<p><em>Internal function</em>. A utility function which plots the sample names next to the sample points.
The number of samples labeled can be specified by passing it from the
calling function. An internal function, not generally called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.labelExtremes(data, names, tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".labelExtremes_+3A_data">data</code></td>
<td>
<p>A matrix containing the x values of the points/samples in the
first column, and the y values in the second.</p>
</td></tr>
<tr><td><code id=".labelExtremes_+3A_names">names</code></td>
<td>
<p>A character vector of sample names.  Length must match the
number of rows in <code>x</code>.</p>
</td></tr>
<tr><td><code id=".labelExtremes_+3A_tol">tol</code></td>
<td>
<p><code>.writeDoc_Tol()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.  Annotates the plot with labels.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.plotHCA'>Plot Dendrogram for Spectra or Spectra2D Object</h2><span id='topic+.plotHCA'></span>

<h3>Description</h3>

<p><em>Internal function</em>. This function plots the results of an HCA analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.plotHCA(spectra, hclst, sub.title, use.sym, leg.loc, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".plotHCA_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".plotHCA_+3A_hclst">hclst</code></td>
<td>
<p>A <code><a href="stats.html#topic+hclust">hclust</a></code> object.</p>
</td></tr>
<tr><td><code id=".plotHCA_+3A_sub.title">sub.title</code></td>
<td>
<p>A character string for the subtitle.</p>
</td></tr>
<tr><td><code id=".plotHCA_+3A_use.sym">use.sym</code></td>
<td>
<p>Logical; if true, the color scheme will be black and
lower-case letters will be used to indicate group membership.
Applies to <code>Spectra</code> objects only.</p>
</td></tr>
<tr><td><code id=".plotHCA_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Character; if <code>"none"</code> no legend will be drawn.
Otherwise, any string acceptable to <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id=".plotHCA_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="stats.html#topic+dendrogram">dendrogram</a></code>. Side effect is a plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.prepLegendCoords'>Sanitize Legend Coordinates</h2><span id='topic+.prepLegendCoords'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.prepLegendCoords(go, leg.loc, x.min = 0, x.max = 0, y.min = 0, y.max = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".prepLegendCoords_+3A_go">go</code></td>
<td>
<p>A string specifying the graphics mode.</p>
</td></tr>
<tr><td><code id=".prepLegendCoords_+3A_leg.loc">leg.loc</code></td>
<td>
<p>A list giving x and y coordinates.</p>
</td></tr>
<tr><td><code id=".prepLegendCoords_+3A_x.min">x.min</code></td>
<td>
<p>A number giving the minimum x value in the data. Used only if graphics mode is set to base.</p>
</td></tr>
<tr><td><code id=".prepLegendCoords_+3A_x.max">x.max</code></td>
<td>
<p>A number giving the maximum x value in the data. Used only if graphics mode is set to base.</p>
</td></tr>
<tr><td><code id=".prepLegendCoords_+3A_y.min">y.min</code></td>
<td>
<p>A number giving the minimum y value in the data. Used only if graphics mode is set to base.</p>
</td></tr>
<tr><td><code id=".prepLegendCoords_+3A_y.max">y.max</code></td>
<td>
<p>A number giving the maximum y value in the data. Used only if graphics mode is set to base.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of coordinates specifying x and y position of the legend along with a position
designation, except in one case where a string is returned.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.remGrpSam'>Remove Groups or Samples from a Spectra or Spectra2D Object</h2><span id='topic+.remGrpSam'></span>

<h3>Description</h3>

<p><em>Internal function</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.remGrpSam(spectra, kill, group = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".remGrpSam_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id=".remGrpSam_+3A_kill">kill</code></td>
<td>
<p>A vector of character strings giving a regex pattern to be applied to the sample
or group names.  If <code>group = FALSE</code> can also be an integer vector giving the samples
to be removed.</p>
</td></tr>
<tr><td><code id=".remGrpSam_+3A_group">group</code></td>
<td>
<p>Logical. <code>TRUE</code> means we are removing groups.  <code>FALSE</code> means we are removing samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='.scorePlot'>scorePlot</h2><span id='topic+.scorePlot'></span>

<h3>Description</h3>

<p><em>Internal function</em>.  Parameters etc are documented in <code><a href="#topic+plotScores">plotScores()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.scorePlot(
  spectra,
  so,
  pcs = c(1, 2),
  ellipse = "none",
  tol = "none",
  use.sym = FALSE,
  leg.loc = "topright",
  ...
)
</code></pre>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>

<hr>
<h2 id='.shrinkLeaf'>Shrink the Leaves of a Dendrogram Based on a Spectra Object</h2><span id='topic+.shrinkLeaf'></span>

<h3>Description</h3>

<p><em>Internal function</em>. This function shrinks the size of leaves of a dendrogram object.  The code
was taken from the help files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.shrinkLeaf(n, spectra)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".shrinkLeaf_+3A_n">n</code></td>
<td>
<p>A node in a dendrogram object.</p>
</td></tr>
<tr><td><code id=".shrinkLeaf_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a node with the label size properties set.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>References</h3>

<p><a href="https://github.com/bryanhanson/ChemoSpec">https://github.com/bryanhanson/ChemoSpec</a>
</p>

<hr>
<h2 id='check4Gaps'>Check for Discontinuities (Gaps) in a Vector &amp; Optionally Make a Plot</h2><span id='topic+check4Gaps'></span>

<h3>Description</h3>

<p>The basic procedure is to compare <code>x[n + 1] - x[n]</code> for successive values of
n.  When this value jumps, there is a gap which is flagged. <code>beg.indx</code>
and <code>end.indx</code> will always be contiguous as indices must be; it is the
<code>x</code> values that jump or have the gap.  The indices are provided as they
are more convenient in some programming contexts.  If not assigned, the
result appears at the console.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check4Gaps(x, y = NULL, silent = FALSE, tol = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check4Gaps_+3A_x">x</code></td>
<td>
<p>A numeric vector to be checked for gaps.</p>
</td></tr>
<tr><td><code id="check4Gaps_+3A_y">y</code></td>
<td>
<p>An optional vector of <code>y</code>-values which correspond to the <code>x</code>
values.  Only used in <code>ChemoSpec</code>.  If provided, a plot will be made
in the style of a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> object showing the gap(s).</p>
</td></tr>
<tr><td><code id="check4Gaps_+3A_silent">silent</code></td>
<td>
<p>Logical indicating a &quot;no gap&quot; message
should not be reported to the console.  Important because
<code>check4Gaps</code> is called iteratively by other functions.</p>
</td></tr>
<tr><td><code id="check4Gaps_+3A_tol">tol</code></td>
<td>
<p>A number indicating the tolerance for checking to see if the step
between successive <code>x</code> values are the same.  Depending upon how the
<code>x</code> values are stored and rounded, you may need to change the value of
<code>tol</code> to avoid flagging trivial &quot;gaps&quot;.  If <code>NULL</code>, a value is
chosen which is just above the median difference between <code>x</code> values.</p>
</td></tr>
<tr><td><code id="check4Gaps_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to the plot routines if
<code>y</code> is provided, e.g. <code>xlim</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame giving the data chunks found, with one chunk per row.
Also a plot if <code>y</code> is provided.  In the event there are no gaps found,
a data frame with one row is returned.  The data frame has columns as follows:
</p>
<table>
<tr><td><code>beg.freq</code></td>
<td>
<p>The first frequency value in a given data chunk.</p>
</td></tr>
<tr><td><code>end.freq</code></td>
<td>
<p>The last frequency value in a given data chunk.</p>
</td></tr>
<tr><td><code>size</code></td>
<td>
<p>The length (in frequency units) of the data chunk.</p>
</td></tr>
<tr><td><code>beg.indx</code></td>
<td>
<p>The index of the first frequency value in the data chunk.</p>
</td></tr>
<tr><td><code>end.indx</code></td>
<td>
<p>The index of the last frequency value in the data chunk.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sumSpectra">sumSpectra</a></code> which make extensive use of this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- seq(0, 2 * pi, 0.1)
y &lt;- sin(x)
remove &lt;- c(8:11, 40:45)
x &lt;- x[-remove]
y &lt;- y[-remove]
gaps &lt;- check4Gaps(x, tol = 0.11) # tol just larger than orig spacing
gaps
gaps &lt;- check4Gaps(x, y, tol = 0.11) # show a plot if y given

</code></pre>

<hr>
<h2 id='checkForPackageWithVersion'>Check for an Installed Package with a Particular Version or Newer</h2><span id='topic+checkForPackageWithVersion'></span>

<h3>Description</h3>

<p>Utility function for making sure a package is available with a particular version or newer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkForPackageWithVersion(pkg, vers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkForPackageWithVersion_+3A_pkg">pkg</code></td>
<td>
<p>Character.  The name of the package to check.</p>
</td></tr>
<tr><td><code id="checkForPackageWithVersion_+3A_vers">vers</code></td>
<td>
<p>Character. The minimum acceptable version of the package.  Will only be checked
to the major.minor level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the package with the required version or higher is available, <code>TRUE</code> is returned
invisibly.  Otherwise <code>FALSE</code> is returned.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>

<hr>
<h2 id='chkGraphicsOpt'>Check the Graphic Output Option/Mode</h2><span id='topic+chkGraphicsOpt'></span>

<h3>Description</h3>

<p>This function should be used to check the current graphics mode.  It simply reports
the current setting unless it is invalid in which case the mode is set to <code>base</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chkGraphicsOpt(silent = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chkGraphicsOpt_+3A_silent">silent</code></td>
<td>
<p>Logical.  Silences most messages if <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character.  The value of the current graphics output option/mode.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+GraphicsOptions">GraphicsOptions</a></code> for more information about the graphics options.
</p>

<hr>
<h2 id='chkSpectra'>Verify the Integrity of a Spectra or Spectra2D Object</h2><span id='topic+chkSpectra'></span>

<h3>Description</h3>

<p>Utility function to verify that the structure of a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code>
or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object is internally consistent.
This function should be used after manual editing of these objects.
However, in most cases rather than
directly editing these objects, one should modify them via:
</p>

<ul>
<li> <p><code><a href="#topic+removeFreq">removeFreq</a></code>
</p>
</li>
<li> <p><code><a href="#topic+removeSample">removeSample</a></code>
</p>
</li>
<li> <p><code><a href="#topic+removeGroup">removeGroup</a></code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>chkSpectra(spectra, confirm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chkSpectra_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="chkSpectra_+3A_confirm">confirm</code></td>
<td>
<p>Logical indicating whether or not to write the results to the
console, as would be desirable for interactive use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. When used at the console, and the object is OK, no message is
written unless <code>confirm = TRUE</code>.  At the console, if there is a
problem, messages are issued regardless of the value of <code>confirm</code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)
  chkSpectra(SrE.IR)
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)
  chkSpectra(MUD1)
}
</code></pre>

<hr>
<h2 id='colorSymbol'>Color in ChemoSpec and ChemoSpec2D</h2><span id='topic+colorSymbol'></span><span id='topic+Col7'></span><span id='topic+Col12'></span><span id='topic+Sym12'></span><span id='topic+Col8'></span><span id='topic+Sym8'></span><span id='topic+ColorScheme'></span>

<h3>Description</h3>

<p>In <code>ChemoSpec</code> and <code>ChemoSpec2D</code>, the user may use any color name/format
known to R.  The current color scheme of a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or
<code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object
may be determined using <code><a href="#topic+sumGroups">sumGroups</a></code> or <code><a href="#topic+sumSpectra">sumSpectra</a></code>.
The colors can also be queried and changed using <code><a href="#topic+conColScheme">conColScheme</a></code>.
</p>


<h3>Format</h3>

<p>Colors are stored as character vectors and symbols as numeric vectors.
</p>


<h3>Details</h3>

<p>An important fact to keep in mind is that most people with normal vision cannot distinguish
more than about 8-12 colors, and doing so depends upon the viewing circumstances:
if on paper, printer, ink and paper type all matter, and if on a screen, the background color
makes a big difference.  Further, color-blind individuals have additional challenges.
A great discussion of color issues can be found in the <code>colorspace</code> package.  The
<code>Polychrome</code> package has further discussion and utilities for choosing qualitative
colorschemes, including those for color-blind individuals.
</p>
<p><code>ChemoSpec</code>, but not <code>ChemoSpec2D</code>, can also create plots using
the built-in symbols and lower case letters.  This is useful for color-blind individuals,
plots in <code>rgl</code> which can't plot regular symbols, and plots for where there are
more groups than could be reasonably coded in color.  A good discussion of which symbols
are most readily distinguished can be found in Robinson: &quot;Good Plot Symbols by Default&quot;
<em>Journal of Computational and Graphical Statistics</em> DOI: 10.1080/10618600.2019.1637746
</p>
<p><code>ChemoSpecUtils</code> supplies four color/symbol schemes for your consideration.
If the particular order of colors in any of these does not suit your needs, you can always
choose the ones you want, and/or rearrange the order, or simply provide your own.
</p>

<ul>
<li><p> The colors and symbols produced by <code>gr.cols = "auto"</code> in the import functions.
</p>
</li>
<li> <p><code>Col8</code> provides eight unique colors.  These are more saturated
than the automatic colors.
</p>
</li>
<li> <p><code>Col12</code> provides a mostly paired set of 12 unique colors suitable for groups
that come in pairs.
</p>
</li>
<li> <p><code>Col7</code> provides seven color-blind friendly colors.  These can be visualized
at https://projects.susielu.com/viz-palette by using the hex codes obtained
by typing <code>data(Col7); Col7</code> in the <code>R</code> console.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Make a plot showing all the built-in color options

data(Col7)
data(Col12)
data(Sym12)
data(Col8)
data(Sym8)
# You need to install package "RColorBrewer" to display the default color scheme
if (requireNamespace("RColorBrewer", quietly = TRUE)) {
  auto &lt;- RColorBrewer::brewer.pal(8, "Set1")
}

sp &lt;- 0.75 # space between major plot elements
tsp &lt;- 0.15 # additional space between points and color swatches/descriptive text
h &lt;- 0.25 # height of the swatch
y &lt;- 0.0 # bottom of the plot, the reference point

# empty plot
plot(1:12, rep(0.0, 12),
  type = "n", yaxt = "n", xaxt = "n", bty = "n",
  xlab = "", ylab = "", ylim = c(0, 3.5)
)
text(6.5, y + h + tsp * 4 + sp * 3.5,
  labels = "Automatic Color &amp; Symbol Options", cex = 1.25, font = 2
)

# Col12
for (i in 1:12) {
  rect(i - 0.5, y, i + 0.5, y + h, border = NA, col = Col12[i])
}
points(1:12, rep(y + h + tsp, 12), pch = Sym12)
text(0.6, y + h + tsp * 2, adj = 0,
  labels = "gr.cols = 'Col12'     12 mostly paired distinct colors/symbols"
)

# Col8
for (i in 1:8) {
  rect(i - 0.5, y + sp, i + 0.5, y + sp + h, border = NA, col = Col8[i])
}
points(1:8, rep(y + h + tsp + sp, 8), pch = Sym8)
text(0.6, y + h + tsp * 2 + sp, adj = 0,
  labels = "gr.cols = 'Col8'     8 distinct colors/symbols"
)

# auto (default)
if (requireNamespace("RColorBrewer", quietly = TRUE)) {
  for (i in 1:8) {
    rect(i - 0.5, y + sp * 2, i + 0.5, y + sp * 2 + h, border = NA, col = auto[i])
  }
  points(1:8, rep(y + h + tsp + sp * 2, 8), pch = Sym8)
  text(0.6, y + h + tsp * 2 + sp * 2, adj = 0,
    labels = "gr.cols = 'auto'     8 distinct colors/symbols"
  )
}

# colorblind-friendly
for (i in 1:7) {
  rect(i - 0.5, y + sp * 3, i + 0.5, y + sp * 3 + h, border = NA, col = Col7[i])
}
points(1:7, rep(y + h + tsp + sp * 3, 7), pch = Sym8[1:7])
text(0.6, y + h + tsp * 2 + sp * 3, adj = 0,
  labels = "gr.cols = 'Col7'     7 colorblind-friendly colors"
)
</code></pre>

<hr>
<h2 id='conColScheme'>Change the Color Scheme of a Spectra or Spectra2D Object</h2><span id='topic+conColScheme'></span>

<h3>Description</h3>

<p>This function permits you to change the color scheme of an existing
<code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conColScheme(spectra, new.cols = NULL, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conColScheme_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="conColScheme_+3A_new.cols">new.cols</code></td>
<td>
<p>A character vector giving the new color values, of
<code>length(unique(spectra$colors))</code>.
If not provided, the function will print the old values for reference.</p>
</td></tr>
<tr><td><code id="conColScheme_+3A_silent">silent</code></td>
<td>
<p>Logical.  If <code>TRUE</code>, suppresses all reporting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p>For a discussion of general issues of color, see
<code>colorSymbol</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(metMUD1)

  sumSpectra(metMUD1)
  newSpec &lt;- conColScheme(metMUD1) # reports old colors
  newSpec &lt;- conColScheme(metMUD1, new = c("pink", "violet"))
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)

  sumSpectra(MUD1)
  newSpec &lt;- conColScheme(MUD1) # reports old colors
  newSpec &lt;- conColScheme(MUD1, new = c("pink", "violet"))
}

</code></pre>

<hr>
<h2 id='GraphicsOptions'>Graphic Output Options in ChemoSpec and ChemoSpec2D</h2><span id='topic+GraphicsOptions'></span>

<h3>Description</h3>

<p>In <code>ChemoSpec</code> and <code>ChemoSpec2D</code>, the user may chose from the following graphics output options:
</p>

<ul>
<li> <p><code>base</code> graphics (also the only style from the early days of <code>ChemoSpec</code> through version 5).
</p>
</li>
<li> <p><code>ggplot2</code> graphics, <em>the default</em>.
</p>
</li>
<li> <p><code>plotly</code> graphics.
</p>
</li></ul>



<h3>Details</h3>

<p>Here's how it works:
</p>

<ul>
<li><p> Upon starting <code>ChemoSpec</code> or <code>ChemoSpec2D</code> the graphics output mode
is set to <code>ggplot2</code>.
</p>
</li>
<li><p> To see the current value, do <code><a href="#topic+chkGraphicsOpt">chkGraphicsOpt</a></code>.  If by some chance the
value is corrupted it will be set to <code>base</code>.
</p>
</li>
<li><p> To change the graphics output mode, do <code>options(ChemoSpecGraphics = 'option')</code>,
where 'option' is one of the options listed above.
</p>
</li>
<li> <p><code>ggplot2</code> graphics are not available for all plots.  If <code>ggplot2</code> graphics are not available,
<code>base</code> graphics will be automatically used, regardless of the setting in
<code>options(ChemoSpecGraphics)</code>.
</p>
</li></ul>

<p>What you can do with your plots:
</p>

<ul>
<li><p> Base graphics are the original graphics option in <code>R</code>.  They cannot be modified.
</p>
</li>
<li><p> For <code>ggplot2</code> graphics, <code>ChemoSpec</code> and <code>ChemoSpec2D</code> employ <code>theme_bw</code>
with only a
very few modifications.  You can add things to your plot, or override the theme
used here via the usual <code>ggplot2</code> methods.  A few simple examples are given below
but this is not the place for a <code>ggplot2</code> tutorial.  See <a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a>
for all things <code>ggplot2</code>.
</p>
</li>
<li> <p><code>plotly</code> graphics is an interactive graphics option where the user can
use the tools provided by <code>plotly</code> package and interact with the plot.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  library("ggplot2")
  data(metMUD1)

  # Using the default ggplot2 graphics
  p1 &lt;- plotSpectra(metMUD1,
    which = c(10, 11), yrange = c(0, 1.5),
    offset = 0.06, amplify = 10, lab.pos = 0.5)
  p1

  # Modifying ggplot2 graphics
  # Add a title
  p2 &lt;- p1 + ggtitle("metMUD1 NMR Data")
  p2

  # Zoom the axes
  p3 &lt;- p1 + coord_cartesian(xlim = c(1.5, 2.0))
  p3

  # Change the ggplot2 theme
  p4 &lt;- p1 + theme_gray() + theme(legend.position = "none")
  p4

  # plotLoadings uses patchwork, whose plots are modified differently
  if (requireNamespace("patchwork", quietly = TRUE)) {
    pca &lt;- c_pcaSpectra(metMUD1)
    p5 &lt;- plotLoadings(metMUD1, pca, loads = c(1, 2))
    p5
    p6 &lt;- p5 + patchwork::plot_annotation(title = "metMUD1 NMR Data")
    p6
    # but to change the theme on each subplot, use the &amp; operator
    p7 &lt;- p6 &amp; theme_gray() # compare to p6 + theme_gray()
    p7
  }
}

</code></pre>

<hr>
<h2 id='hcaScores'>HCA on PCA/MIA/PARAFAC scores from a Spectra or Spectra2D Object</h2><span id='topic+hcaScores'></span>

<h3>Description</h3>

<p>A wrapper which performs HCA on the scores from a PCA of a
<code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> object or POP/MIA/PARAFAC of a <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
Many methods for computing the clusters and distances are
available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hcaScores(
  spectra,
  so,
  scores = c(1:5),
  c.method = "complete",
  d.method = "euclidean",
  use.sym = FALSE,
  leg.loc = "topright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hcaScores_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_so">so</code></td>
<td>
<p>&quot;Score Object&quot; One of the following:
</p>

<ul>
<li><p> An object of class <code><a href="stats.html#topic+prcomp">prcomp</a></code>, created by <code>ChemoSpec</code> functions
<code><a href="ChemoSpec.html#topic+c_pcaSpectra">c_pcaSpectra</a></code>, <code><a href="ChemoSpec.html#topic+r_pcaSpectra">r_pcaSpectra</a></code>,
<code><a href="ChemoSpec.html#topic+irlba_pcaSpectra">irlba_pcaSpectra</a></code> or <code><a href="ChemoSpec.html#topic+s_pcaSpectra">s_pcaSpectra</a></code>.
</p>
</li>
<li><p> An object of class <code>mia</code> produced by
function <code><a href="ChemoSpec2D.html#topic+miaSpectra2D">miaSpectra2D</a></code>.
</p>
</li>
<li><p> An object of class <code>parafac</code> produced by
function <code><a href="ChemoSpec2D.html#topic+pfacSpectra2D">pfacSpectra2D</a></code>.
</p>
</li>
<li><p> An object of class <code>pop</code> produced by
function <code><a href="ChemoSpec2D.html#topic+popSpectra2D">popSpectra2D</a></code>.
</p>
</li></ul>

<p>Any of the above score objects will have been modified to include a
list element called <code>$method</code>, a character string describing the
pre-processing carried out and the type of PCA performed (used to annotate the
plot).</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_scores">scores</code></td>
<td>
<p>A vector of integers specifying the components (scores) to plot.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_c.method">c.method</code></td>
<td>
<p>A character string describing the clustering method; must be
acceptable to <code><a href="stats.html#topic+hclust">hclust</a></code>.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_d.method">d.method</code></td>
<td>
<p>A character string describing the distance calculation
method; must be acceptable as a method in <code><a href="#topic+rowDist">rowDist</a></code>.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_use.sym">use.sym</code></td>
<td>
<p>A logical; if true, use no color and use lower-case letters
to indicate group membership.  Applies only to <code>Spectra</code> objects.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Character; if <code>"none"</code> no legend will be drawn.
Otherwise, any string acceptable to <code><a href="graphics.html#topic+legend">legend</a></code>.</p>
</td></tr>
<tr><td><code id="hcaScores_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, containing an object of class <code><a href="stats.html#topic+hclust">hclust</a></code> and an
object of class <code><a href="stats.html#topic+dendrogram">dendrogram</a></code>.  The side effect is a plot.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code> for the underlying function. See
<code><a href="ChemoSpec.html#topic+hcaSpectra">hcaSpectra</a></code> for HCA of the entire data set stored in the
<code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(metMUD1)

  pca &lt;- c_pcaSpectra(metMUD1)
  hca &lt;- hcaScores(metMUD1, pca, main = "metMUD1 NMR Data PCA Scores")
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)

  mia &lt;- miaSpectra2D(MUD1)
  hca &lt;- hcaScores(MUD1, mia, scores = 1:2, main = "MUD1 MIA Scores")

  set.seed(123)
  pfac &lt;- pfacSpectra2D(MUD1, parallel = FALSE, nfac = 2)
  hca &lt;- hcaScores(MUD1, pfac, scores = 1:2, main = "MUD1 PARAFAC Scores")
}
</code></pre>

<hr>
<h2 id='plotScores'>Plot Scores from PCA, MIA or PARAFAC Analysis of a Spectra or Spectra2D Object</h2><span id='topic+plotScores'></span>

<h3>Description</h3>

<p>Plots the requested scores using the color scheme derived from the
<code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
Options are provided to add confidence ellipses for each group in the object.
The ellipses may be robust or classical.  Option to label the extreme points provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScores(
  spectra,
  so,
  pcs = c(1, 2),
  ellipse = "none",
  tol = "none",
  use.sym = FALSE,
  leg.loc = "topright",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScores_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_so">so</code></td>
<td>
<p>&quot;Score Object&quot; One of the following:
</p>

<ul>
<li><p> An object of class <code><a href="stats.html#topic+prcomp">prcomp</a></code>, created by <code>ChemoSpec</code> functions
<code><a href="ChemoSpec.html#topic+c_pcaSpectra">c_pcaSpectra</a></code>, <code><a href="ChemoSpec.html#topic+r_pcaSpectra">r_pcaSpectra</a></code>,
<code><a href="ChemoSpec.html#topic+irlba_pcaSpectra">irlba_pcaSpectra</a></code> or <code><a href="ChemoSpec.html#topic+s_pcaSpectra">s_pcaSpectra</a></code>.
</p>
</li>
<li><p> An object of class <code>mia</code> produced by
function <code><a href="ChemoSpec2D.html#topic+miaSpectra2D">miaSpectra2D</a></code>.
</p>
</li>
<li><p> An object of class <code>parafac</code> produced by
function <code><a href="ChemoSpec2D.html#topic+pfacSpectra2D">pfacSpectra2D</a></code>.
</p>
</li>
<li><p> An object of class <code>pop</code> produced by
function <code><a href="ChemoSpec2D.html#topic+popSpectra2D">popSpectra2D</a></code>.
</p>
</li></ul>

<p>Any of the above score objects will have been modified to include a
list element called <code>$method</code>, a character string describing the
pre-processing carried out and the type of PCA performed (used to annotate the
plot).</p>
</td></tr>
<tr><td><code id="plotScores_+3A_pcs">pcs</code></td>
<td>
<p>A vector of two integers specifying the components (scores) to plot.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_ellipse">ellipse</code></td>
<td>
<p>A character vector specifying the type of ellipses to be
plotted.  One of <code>c("both"</code>, <code>"none"</code>, <code>"cls"</code>, <code>"rob")</code>.  <code>cls</code>
specifies classical confidence ellipses, <code>rob</code> specifies robust
confidence ellipses.  An ellipse is drawn for each group unless there
are three or fewer samples in the group.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_tol">tol</code></td>
<td>
<p>A number describing the fraction of points to be labeled. <code>tol = 1.0</code> labels all the points; <code>tol = 0.05</code> labels <em>approximately</em> the most extreme 5 percent. Set to <code>'none'</code> to completely suppress labels. Note that a simple approach based upon quantiles is used, assumes that both x and y are each normally distributed, and treats x and y separately.  Thus, this is not a formal treatment of outliers, just a means of labeling points. Groups are lumped together for the computation.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_use.sym">use.sym</code></td>
<td>
<p>A logical; if TRUE, the color scheme is set to black and the
points plotted with symbols.  Applies only to <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> objects.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Either a list with elements <code>x</code> and <code>y</code>, or a string like <code>'topright'</code>.  Values in a list should be on <code style="white-space: pre;">&#8288;[0,1]&#8288;</code>, i.e. the lower left of the plot area is <code style="white-space: pre;">&#8288;0,0&#8288;</code> and the upper right is <code style="white-space: pre;">&#8288;1,1&#8288;</code>.  Allowed string values are those described in <code><a href="graphics.html#topic+legend">graphics::legend()</a></code> under 'Details'. A value of <code>'none'</code> is acceptable as well.</p>
</td></tr>
<tr><td><code id="plotScores_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code><a href="#topic+GraphicsOptions">GraphicsOptions()</a></code>).
</p>

<ul>
<li> <p><code>base</code>: None.  Side effect is a plot.
</p>
</li>
<li> <p><code>ggplot2</code>: The plot is displayed, and a <code>ggplot2</code> object is returned if the value is assigned.  The plot can be modified in the usual <code>ggplot2</code> manner.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  # This example assumes the graphics output is set to ggplot2 (see ?GraphicsOptions).
  library("ggplot2")
  data(metMUD1)

  pca &lt;- c_pcaSpectra(metMUD1)
  p &lt;- plotScores(metMUD1, pca, pcs = c(1, 2), ellipse = "cls", tol = 0.05)
  p &lt;- p + ggtitle("metMUD1 NMR Data")
  p
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  library("ggplot2")
  data(MUD1)

  mia &lt;- miaSpectra2D(MUD1)
  p1 &lt;- plotScores(MUD1, mia, tol = 0.1, ellipse = "cls")
  p1 &lt;- p1 + ggtitle("MIA Scores")
  p1

  set.seed(123)
  pfac &lt;- pfacSpectra2D(MUD1, parallel = FALSE, nfac = 2)
  p2 &lt;- plotScores(MUD1, pfac, tol = 0.1, leg.loc = "bottomright")
  p2 &lt;- p2 + ggtitle("PARAFAC Score Plot")
  p2
}
</code></pre>

<hr>
<h2 id='plotScree'>Scree Plots from PCA or MIA Analysis of a Spectra or Spectra2D Object</h2><span id='topic+plotScree'></span>

<h3>Description</h3>

<p>Functions that draw a traditional scree plot, or an alternative style that is perhaps
more informative.  These plots illustrate the variance explained by each component
in a PCA or MIA analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScree(pca, style = "alt", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScree_+3A_pca">pca</code></td>
<td>
<p>Either:
</p>

<ul>
<li><p> An object of class <code><a href="stats.html#topic+prcomp">prcomp</a></code>, modified to include a
list element called <code>$method</code>, a character string describing the
pre-processing carried out and the type of PCA performed (it appears on the
plot).  This is automatically provided if <code>ChemoSpec</code> functions
<code><a href="ChemoSpec.html#topic+c_pcaSpectra">c_pcaSpectra</a></code> or <code><a href="ChemoSpec.html#topic+r_pcaSpectra">r_pcaSpectra</a></code>
were used to create <code>pca</code>.
</p>
</li>
<li><p> An object of class <code>mia</code> produced by
function <code>miaSpectra2D</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plotScree_+3A_style">style</code></td>
<td>
<p>Character.  One of <code>c("trad", "alt")</code> giving the style of
plot desired (traditional or alternative).  <code>"trad"</code> is not supported
for <code>mia</code> objects.</p>
</td></tr>
<tr><td><code id="plotScree_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned value depends on the graphics option selected (see <code><a href="#topic+GraphicsOptions">GraphicsOptions()</a></code>).
</p>

<ul>
<li> <p><code>base</code>: None.  Side effect is a plot.
</p>
</li>
<li> <p><code>ggplot2</code>: The plot is displayed, and a <code>ggplot2</code> object is returned if the value is assigned.  The plot can be modified in the usual <code>ggplot2</code> manner.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University), Tejasvi Gupta.
</p>


<h3>References</h3>

<p>The idea for the alternative style plot came from the NIR-Quimiometria
blog by jrcuesta, at <a href="https://nir-quimiometria.blogspot.com/2012/02/pca-for-nir-spectrapart-004-projections.html">https://nir-quimiometria.blogspot.com/2012/02/pca-for-nir-spectrapart-004-projections.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(metMUD1)

  pca &lt;- c_pcaSpectra(metMUD1)
  p1 &lt;- plotScree(pca, style = "trad")
  p1
  p2 &lt;- plotScree(pca, style = "alt")
  p2
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)

  mia &lt;- miaSpectra2D(MUD1)
  plotScree(mia, style = "alt")
}
</code></pre>

<hr>
<h2 id='removeFreq'>Remove Frequencies from a Spectra or Spectra2D Object</h2><span id='topic+removeFreq'></span>

<h3>Description</h3>

<p>This function removes specified frequencies from a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code>
or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
For instance, one might want to remove regions lacking any useful
information (to reduce the data size), remove regions with large
interfering peaks (e.g. the water peak in 1H NMR) or simply focus
on a region of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeFreq(spectra, rem.freq = NULL, remF2 = NULL, remF1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeFreq_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="removeFreq_+3A_rem.freq">rem.freq</code></td>
<td>
<p>For a <code>Spectra</code> object, a vector of logicals.
<code>rem.freq</code> can be any valid <code>R</code> statement that leads to a vector of
logicals (must be of <code>length(Spectra$freq)</code>).  This vector should be <code>TRUE</code>
for frequencies you want to be removed
and <code>FALSE</code> for those frequencies which will be kept.
In the examples, the | and &amp; operators may seem backward in
a sense, but R evaluates them one at a time and then combines them to give
the desired result.  You may wish to look at <code><a href="base.html#topic+Comparison">Comparison</a></code> and
<code><a href="base.html#topic+Logic">Logic</a></code>. See the examples.  <em>In addition, since January 2020 <code>rem.freq</code>
may be a formula as described below.</em></p>
</td></tr>
<tr><td><code id="removeFreq_+3A_remf2">remF2</code></td>
<td>
<p>Applies to <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> objects. A formula giving the range of
frequencies to be extracted.  May include
&quot;low&quot; or &quot;high&quot; representing the extremes of the spectra.  Values outside the range of
F2 are tolerated without notice and are handled as <code>min</code> or <code>max</code>. See the examples.</p>
</td></tr>
<tr><td><code id="removeFreq_+3A_remf1">remF1</code></td>
<td>
<p>As for <code>remF2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Modifying Spectra2D Objects</h3>

<p>Regarding <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> objects, one cannot remove frequencies from the interior of
a 2D NMR data set and expect
to get a meaningful contour plot, because doing so puts unrelated peaks adjacent
in the data set. This would lead to contours being drawn that don't exist in the
original data set. However, one can remove data from the interior and run a PARAFAC
analysis on the result, using the spectrum as an abstract object (that is, the
spectrum may not plottable, but the resulting scores are still meaningful).
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p><code><a href="ChemoSpec2D.html#topic+removeFreq">removeFreq</a></code> for another way to remove data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)
  sumSpectra(SrE.IR)

  # Examples where rem.freq is a logical vector

  # Remove frequencies from one end:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = SrE.IR$freq &gt; 3500)

  # Remove frequencies from both ends at once:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = SrE.IR$freq &gt; 3500
    | SrE.IR$freq &lt; 800)

  # Remove frequencies from the middle:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = SrE.IR$freq &gt; 800
    &amp; SrE.IR$freq &lt; 1000)

  # The logic of this last one is as follows.  Any values
  # that are TRUE will be removed.
  values &lt;- 1:7
  values &gt; 2
  values &lt; 6
  values &gt; 2 &amp; values &lt; 6

  # Examples where rem.freq is a formula

  # Remove frequencies from one end:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = 3500 ~ high)

  # Remove frequencies from both ends is a two step process with formulas:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = 3500 ~ high)
  newIR &lt;- removeFreq(newIR, rem.freq = low ~ 800)

  # Remove frequencies from the middle:
  newIR &lt;- removeFreq(SrE.IR, rem.freq = 800 ~ 1000)

  # After any of these, inspect the results:
  sumSpectra(newIR)
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
# Note we will set contours a bit low to better
# show what is going on.

  data(MUD1)

  plotSpectra2D(MUD1, which = 7, lvls = 0.1, cols = "black",
    main = "MUD1 Sample 7: Complete Data Set")

  MUD1a &lt;- removeFreq(MUD1, remF2 = 2.5 ~ 4)
  sumSpectra(MUD1a) # don't plot, removing peaks from interior is misleading

  MUD1b &lt;- removeFreq(MUD1, remF2 = low ~ 2)
  sumSpectra(MUD1b)
  plotSpectra2D(MUD1b, which = 7, lvls = 0.1, cols = "black",
    main = "MUD1 Sample 7\nRemoved Peaks: F2 low ~ 2")

  MUD1c &lt;- removeFreq(MUD1, remF1 = high ~ 23)
  sumSpectra(MUD1c)
  plotSpectra2D(MUD1c, which = 7, lvls = 0.1, cols = "black",
    main = "MUD1 Sample 7\nRemoved Peaks: F1 high ~ 23")

  MUD1d &lt;- removeFreq(MUD1, remF2 = 2.5 ~ 4, remF1 = 45 ~ 55)
  sumSpectra(MUD1d)  # don't plot, removing peaks from interior is misleading

}
</code></pre>

<hr>
<h2 id='removeGroup'>Remove a Group from a Spectra or Spectra2D Object</h2><span id='topic+removeGroup'></span>

<h3>Description</h3>

<p>Removes specified groups from a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or
<code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeGroup(spectra, rem.group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeGroup_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="removeGroup_+3A_rem.group">rem.group</code></td>
<td>
<p>A character vector (handled as a regex) giving the groups to be removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will report if extra data elements are found.  These will
probably need to be edited manually.  The indices reported to the console
can be helpful in this regard.
</p>
<p>If <code>rem.group</code> is a character vector, the sample
names are grepped for the corresponding values.  Remember that the
grepping process is greedy, i.e. grepping for &quot;XY&quot; find not only &quot;XY&quot; but
also &quot;XYZ&quot;.
</p>
<p>Unused levels in <code>$groups</code> are dropped.
</p>


<h3>Value</h3>

<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)

  sumGroups(SrE.IR)
  SrE.IRa &lt;- removeGroup(SrE.IR, rem.group = "pSrE")
  sumGroups(SrE.IRa)
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)

  sumGroups(MUD1)
  MUD1a &lt;- removeGroup(MUD1, rem.group = "Ether")
  sumGroups(MUD1a)
}
</code></pre>

<hr>
<h2 id='removeSample'>Remove Samples from a Spectra or Spectra2D Object</h2><span id='topic+removeSample'></span>

<h3>Description</h3>

<p>Removes specified samples from a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or
<code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeSample(spectra, rem.sam)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeSample_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="removeSample_+3A_rem.sam">rem.sam</code></td>
<td>
<p>Either an integer vector specifying the samples to be
removed, or a character vector (handled as a regex) giving the sample names to be removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will report if extra data elements are found.  These will
probably need to be edited manually.  The indices reported to the console
can be helpful in this regard.
</p>
<p>If <code>rem.sam</code> is a character vector, the sample
names are grepped for the corresponding values.  Remember that the
grepping process is greedy, i.e. grepping for &quot;XY&quot; find not only &quot;XY&quot; but
also &quot;XYZ&quot;.
</p>


<h3>Value</h3>

<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)

  # Remove the 9th spectrum/sample:
  SrE.IR$names
  SrE.IRa &lt;- removeSample(SrE.IR, rem.sam = 9)
  SrE.IRa$names

  # Removes a spectrum/sample with this exact name:
  SrE.IRb &lt;- removeSample(SrE.IR, rem.sam = "NW_adSrE")
  SrE.IRb$names
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)

  # Removes the 5th spectrum:
  MUD1$names
  MUD1a &lt;- removeSample(MUD1, rem.sam = 5)
  MUD1a$names

  # Removes a spectrum/sample with this exact name:
  MUD1$names
  MUD1b &lt;- removeSample(MUD1, rem.sam = "Ether_3")
  MUD1b$names
}
</code></pre>

<hr>
<h2 id='rowDist'>Compute Distance Between Rows of a Matrix</h2><span id='topic+rowDist'></span>

<h3>Description</h3>

<p>This function computes the distance between rows of a matrix using a number of methods.
It is primarily a wrapper for <code><a href="amap.html#topic+Dist">Dist</a></code> which provides many options.
However, cosine distance is calculated locally.
See the reference for an excellent summary of distances and similarities.
Keep in mind that distances are always positive by definition.  Further, in the literature one
can find the same distance defined different ways.  For instance, the definition of the
<code>"pearson"</code> and <code>"correlation"</code> distances differs slightly between the reference below
and <code><a href="amap.html#topic+Dist">Dist</a></code>.  So please study the definitions carefully to get the one you want.
The example illustrates the behavior of some common distance definitions.  Notice that <code>"pearson"</code>
and <code>"cosine"</code> are mathematically identical for the particular definition of <code>"pearson"</code>
used by <code><a href="amap.html#topic+Dist">Dist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rowDist(x, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rowDist_+3A_x">x</code></td>
<td>
<p>A matrix whose rows will be used for the distance calculation.</p>
</td></tr>
<tr><td><code id="rowDist_+3A_method">method</code></td>
<td>
<p>Character; one of <code>"cosine"</code>, <code>"euclidean"</code>, <code>"maximum"</code>, <code>"manhattan"</code>,
<code>"canberra"</code>,  <code>"binary"</code>, <code>"pearson"</code>, <code>"correlation"</code>, <code>"spearman"</code>,
<code>"kendall"</code>, <code>"abspearson"</code>, <code>"abscorrelation"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>dist</code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>References</h3>

<p>R. Todeschini, D. Ballabio, V. Consonni
&quot;Distances and Similarity Measures in Chemometrics and Chemoinformatics&quot;
in <em>Encyclopedia of Analytical Chemistry</em> Wiley and Sons, 2020
<a href="https://doi.org/10.1002/9780470027318.a9438.pub2">doi:10.1002/9780470027318.a9438.pub2</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># You need to install package "amap" to run the examples
if (requireNamespace("amap", quietly = TRUE)) {
  # These examples imagines spectra as a series of vectors
  # on a half unit circle.
  # 1. Compute half of a unit circle
  theta &lt;- seq(0, pi, length = 100) 
  x = cos(theta)
  y = sin(theta)

  # 2. Compute some illustrative vectors
  # Get tail/origin &amp; tip/head coordinates
  lt &lt;- length(theta)
  set.seed(6)
  tips &lt;- theta[c(1, sample(2:100, 5))]
  x0 &lt;- y0 &lt;- rep(0.0, lt) # tail/origin at 0,0
  x1 &lt;- cos(tips) # tips/heads
  y1 &lt;- sin(tips)

  # 3. Compute the distance functions
  # Bounded distances
  RDcor &lt;- rep(NA_real_, lt) # correlation distance
  RDpea &lt;- rep(NA_real_, lt) # pearson distance
  RDabp &lt;- rep(NA_real_, lt) # abspearson distance
  RDcos &lt;- rep(NA_real_, lt) # cosine distance

  # Unbounded distances
  RDeuc &lt;- rep(NA_real_, lt) # Euclidean distance
  RDman &lt;- rep(NA_real_, lt) # manhattan distance

  # Compute all
  np &lt;- 5
  refVec &lt;- c(seq(0.0, x[1], length.out = np), seq(0.0, y[1], length.out = np))
  for (i in 1:lt) {
    Vec &lt;- c(seq(0.0, x[i], length.out = np), seq(0.0, y[i], length.out = np))
    M &lt;- matrix(c(refVec, Vec), nrow = 2, byrow = TRUE)
    RDman[i] &lt;- rowDist(M, method = "manhattan")
    RDeuc[i] &lt;- rowDist(M, method = "euclidean")
    RDcos[i] &lt;- rowDist(M, method = "cosine")
    RDcor[i] &lt;- rowDist(M, method = "correlation")
    RDpea[i] &lt;- rowDist(M, method = "pearson")
    RDabp[i] &lt;- rowDist(M, method = "abspearson")
  }

  # 4. Plots
  # a. Unit circle w/representative vectors/spectra
  plot.new()
  plot.window(xlim = c(-1, 1), ylim = c(0, 1), asp = 1)
  title(main = "Representative 'Spectral' Vectors on a Unit Half Circle\nReference Vector in Red",
    sub = "Each 'spectrum' is represented by a series of x, y points") 
  lines(x, y, col = "gray") # draw half circle
  lines(x = x[c(1,100)], y = y[c(1,100)], col = "gray") # line across bottom
  arrows(x0, y0, x1, y1, angle = 5) # add arrows &amp; a red reference vector
  arrows(x0[1], y0[1], x1[1], y1[1], col = "red", angle = 5, lwd = 2)

  # b. Distances
  degrees &lt;- theta*180/pi
  plot(degrees, RDman, type = "l",
    xlab = "Angle Between Spectral Vectors and Reference Vector in Degrees",
    ylab = "Distance",
    main = "Spectral Distance Comparisons\nUsing ChemoSpecUtils::rowDist")
  abline(h = c(1.0, 2.0), col = "gray")
  lines(degrees, RDeuc, col = "blue")
  lines(degrees, RDcos, col = "green", lwd = 4)
  lines(degrees, RDcor, col = "red")
  lines(degrees, RDabp, col = "black", lty = 2)
  lines(degrees, RDpea, col = "black", lty = 3)
  leg.txt &lt;- c("manhattan", "euclidean", "correlation", "cosine", "pearson", "abspearson")
  leg.col &lt;- c("black", "blue", "red", "green", "black", "black")
  leg.lwd &lt;- c(1, 1, 1, 4, 1, 1)
  leg.lty &lt;- c(1, 1, 1, 1, 3, 2)
  legend("topleft", legend = leg.txt, col = leg.col, lwd = leg.lwd, lty = leg.lty)
}

</code></pre>

<hr>
<h2 id='sampleDist'>Compute the Distances Between Samples in a Spectra or Spectra2D Object</h2><span id='topic+sampleDist'></span>

<h3>Description</h3>

<p>Compute the distances between samples in a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or
<code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object. This is a means
to quantify the similarity between samples. A heat map style plot is an
option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleDist(spectra, method = "pearson", plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleDist_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="sampleDist_+3A_method">method</code></td>
<td>
<p>Character.  A string giving the distance method.  See
<code><a href="#topic+rowDist">rowDist</a></code> for options.</p>
</td></tr>
<tr><td><code id="sampleDist_+3A_plot">plot</code></td>
<td>
<p>Logical.  Shall a level plot (heat map) be made?</p>
</td></tr>
<tr><td><code id="sampleDist_+3A_...">...</code></td>
<td>
<p>Parameters to be passed to the plotting routines. <em>Applies to base graphics only</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix giving the distances between the samples.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p>For <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> objects, see <code><a href="ChemoSpec.html#topic+plotSpectraDist">plotSpectraDist</a></code>
which compares all spectra to a single reference spectrum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># You need to install package "lattice" for this example
if (requireNamespace("lattice", quietly = TRUE)) {
  if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
    library("ChemoSpec")
    library("lattice")
    data(SrE.IR)

    SrE.dmatrix &lt;- sampleDist(SrE.IR, # cosine distance bounded on [0...2]
      method = "cosine",
      main = "SrE.IR Cosine Distance Between Samples"
    )
    SrE.dmatrix &lt;- sampleDist(SrE.IR, # abspearson distance bounded on [0...1]
      method = "abspearson",
      main = "SrE.IR Absolute Pearson Distance Between Samples"
    )
    SrE.dmatrix &lt;- sampleDist(SrE.IR, # euclidean distance unbounded
      method = "euclidean",
      main = "SrE.IR Euclidean Distance Between Samples"
    )
  }

  if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
    library("ChemoSpec2D")
    library("lattice")
    data(MUD1)

    MUD1.dmatrix &lt;- sampleDist(MUD1,
      method = "cosine",
      main = "MUD1 Cosine Distance Between Samples"
    )
  }
}

</code></pre>

<hr>
<h2 id='sumGroups'>Summarize the Group Membership of a Spectra or Spectra2D Object</h2><span id='topic+sumGroups'></span>

<h3>Description</h3>

<p>This function summarizes the group membership	 of
a <code>Spectra</code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumGroups(spectra)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumGroups_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame as follows. Note that if there are groups with no
members these are dropped.
</p>
<table>
<tr><td><code>group</code></td>
<td>
<p>The name of the group.</p>
</td></tr>
<tr><td><code>no.</code></td>
<td>
<p>The number in the group.</p>
</td></tr>
<tr><td><code>color</code></td>
<td>
<p>The color assigned to the group.</p>
</td></tr>
<tr><td><code>symbol</code></td>
<td>
<p>The symbol assigned to the group. <code>Spectra</code> objects only.</p>
</td></tr>
<tr><td><code>alt.symbol</code></td>
<td>
<p>The alternative symbol assigned to the group. <code>Spectra</code> objects only.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>See Also</h3>

<p>To summarize the entire object, <code><a href="#topic+sumSpectra">sumSpectra</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)
  sumGroups(SrE.IR)
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)
  sumGroups(MUD1)
}
</code></pre>

<hr>
<h2 id='sumSpectra'>Summarize a Spectra or Spectra2D Object</h2><span id='topic+sumSpectra'></span>

<h3>Description</h3>

<p>Provides a summary of a <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code>
or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code> object,
essentially a more spectroscopist-friendly version of <code>str()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumSpectra(spectra, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumSpectra_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="sumSpectra_+3A_...">...</code></td>
<td>
<p>Arguments to be passed downstream.  Main use is to pass a value for <code>tol</code>
to function <code><a href="#topic+check4Gaps">check4Gaps</a></code> when using <code>ChemoSpec</code>.
Not used in <code>ChemoSpec2D</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prior to summarizing, <code><a href="#topic+chkSpectra">chkSpectra</a></code> is run with confirm = FALSE.
If there are problems, warnings are issued to the console and the summary is
not done.
The <code><a href="ChemoSpec.html#topic+Spectra">Spectra</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">Spectra2D</a></code>
object is checked to see if it contains data elements
beyond what is required.  If so, these extra elements are reported to the
console.
</p>


<h3>Value</h3>

<p>None.  Results printed at console.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(SrE.IR)
  sumSpectra(SrE.IR)
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)
  sumSpectra(MUD1)
}
</code></pre>

<hr>
<h2 id='updateGroups'>Update Group Names in a Spectra or Spectra2D Object</h2><span id='topic+updateGroups'></span>

<h3>Description</h3>

<p>A convenience function that can be used to update (change)
group names.  The default group names come from the <code>gr.crit</code>
argument in the import functions <code><a href="ChemoSpec.html#topic+files2SpectraObject">files2SpectraObject</a></code>,
<code><a href="ChemoSpec.html#topic+matrix2SpectraObject">matrix2SpectraObject</a></code> or
<code><a href="ChemoSpec2D.html#topic+files2Spectra2DObject">files2Spectra2DObject</a></code>. In some cases <code>gr.crit</code>
may have complex regex patterns, and this function makes updating them to more
appropriate/more readible strings easier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateGroups(spectra, new.grps = NULL, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateGroups_+3A_spectra">spectra</code></td>
<td>
<p>An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.</p>
</td></tr>
<tr><td><code id="updateGroups_+3A_new.grps">new.grps</code></td>
<td>
<p>A vector of character values giving the new group names.
The new values must correspond to the order of the old values.  This vector should
give the unique values only (so, it should have <code>length(unique(spectra$groups))</code>).
If not provided, the function will print the old values for reference.</p>
</td></tr>
<tr><td><code id="updateGroups_+3A_silent">silent</code></td>
<td>
<p>Logical.  If <code>TRUE</code>, suppresses all reporting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra An object of S3 class <code><a href="ChemoSpec.html#topic+Spectra">ChemoSpec::Spectra()</a></code> or <code><a href="ChemoSpec2D.html#topic+Spectra2D">ChemoSpec2D::Spectra2D()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Bryan A. Hanson (DePauw University).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (checkForPackageWithVersion("ChemoSpec", 6.0)) {
  library("ChemoSpec")
  data(metMUD1)
  metMUD1a &lt;- updateGroups(metMUD1) # reports old groups
  metMUD1a &lt;- updateGroups(metMUD1, new.grps = c("C", "T"))
}

if (checkForPackageWithVersion("ChemoSpec2D", 0.5)) {
  library("ChemoSpec2D")
  data(MUD1)
  MUD1a &lt;- updateGroups(MUD1, new.grps = c("control", "treatment"))
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
