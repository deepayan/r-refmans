<!DOCTYPE html><html><head><title>Help for package lmomRFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmomRFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lmomRFA-package'><p>The lmomRFA package</p></a></li>
<li><a href='#Appalach'><p>Data for streamflow gaging stations in Appalachia</p></a></li>
<li><a href='#Cascades'><p>L-moments of annual precipitation totals</p></a></li>
<li><a href='#cluagg'><p>Hierarchical clustering</p></a></li>
<li><a href='#cluinf'><p>Provide information about a hierarchical clustering</p></a></li>
<li><a href='#clukm'><p>Cluster analysis via K-means algorithm</p></a></li>
<li><a href='#evplot.rfd'><p>Extreme-value plot of a regional frequency distribution</p></a></li>
<li><a href='#Maxwind'><p>Maximum wind speeds</p></a></li>
<li><a href='#regavlmom'><p>Regional weighted average of L-moments</p></a></li>
<li><a href='#regdata'><p>The regdata class</p></a></li>
<li><a href='#regfit'><p>Fit a regional frequency distribution</p></a></li>
<li><a href='#reglmr'><p>Regional weighted average of L-moments</p></a></li>
<li><a href='#regquant'><p>Quantiles and quantile function of a regional frequency distribution</p></a></li>
<li><a href='#regquantbounds'><p>Compute error bounds for a regional frequency distribution</p></a></li>
<li><a href='#regsamlmu'><p>Sample L-moments of multiple data sets</p></a></li>
<li><a href='#regsimh'><p>Simulate the distribution of heterogeneity and goodness-of-fit measures</p></a></li>
<li><a href='#regsimq'><p>Compute error bounds for a fitted regional frequency distribution</p></a></li>
<li><a href='#regtst'><p>Test statistics for regional frequency analysis</p></a></li>
<li><a href='#sitequant'><p>Quantiles and quantile functions for individual sites in a region</p></a></li>
<li><a href='#summary.regtst'><p>Summary of test statistics for regional frequency analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Regional Frequency Analysis using L-Moments</td>
</tr>
<tr>
<td>Author:</td>
<td>J. R. M. Hosking</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>J. R. M. Hosking &lt;jrmhosking@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for regional frequency analysis using the methods
  of J. R. M. Hosking and J. R. Wallis (1997), "Regional frequency analysis:
  an approach based on L-moments".</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), lmom (&ge; 2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.eclipse.org/legal/cpl-v10.html">Common Public License Version 1.0</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-29 02:42:49 UTC; J</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-29 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lmomRFA-package'>The lmomRFA package</h2><span id='topic+lmomRFA'></span><span id='topic+lmomRFA-package'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> functions for regional frequency analysis using <code class="reqn">L</code>-moments.
</p>


<h3>Details</h3>

<p>This package implements methods described in the book
&ldquo;Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments&rdquo;
by J. R. M. Hosking and J. R. Wallis.
It is a supplement to the <span class="pkg">lmom</span> package,
which implements <code class="reqn">L</code>-moment methods for more
general statistical applications.
</p>
<p>The following functions are contained in this package.
</p>
<p><code><a href="#topic+cluagg">cluagg</a></code>
performs agglomerative hierarchical clustering.
</p>
<p><code><a href="#topic+cluinf">cluinf</a></code>
provides information about cluster membership in a
hierarchical clustering.
</p>
<p><code><a href="#topic+clukm">clukm</a></code>
performs cluster analysis via the K-means algorithm.
</p>
<p><code><a href="#topic+as.regdata">as.regdata</a></code>
creates an object of class <code>"regdata"</code>, which contains a
&ldquo;regional data set&rdquo; consisting of summary statistics
for different data samples, one of the main building blocks
of regional frequency analysis.
</p>
<p><code><a href="#topic+regsamlmu">regsamlmu</a></code>
computes the sample <code class="reqn">L</code>-moments of multiple data sets.
</p>
<p><code><a href="#topic+regavlmom">regavlmom</a></code> and <code><a href="#topic+reglmr">reglmr</a></code>
both compute, with slightly different interfaces, a regional
weighted average of sample <code class="reqn">L</code>-moments from multiple sites.
Function <code>regavlmom</code> is recommended for general use;
<code>reglmr</code> is deprecated.
</p>
<p><code><a href="#topic+regtst">regtst</a></code>
computes discordancy, heterogeneity and goodness-of-fit measures
for regional frequency analysis.  These statistics are as described
in Hosking and Wallis (1997, chaps. 3-5).
</p>
<p><code><a href="#topic+regfit">regfit</a></code>
fits a frequency distribution to a regional data set, giving a
&ldquo;regional frequency distribution&rdquo;.
</p>
<p><code><a href="#topic+regqfunc">regqfunc</a></code> and <code><a href="#topic+siteqfunc">siteqfunc</a></code>
return the regional growth curve and the quantile functions for individual
sites, respectively, from a regional frequency distribution fitted by
<code>regfit</code>.
</p>
<p><code><a href="#topic+regquant">regquant</a></code> and <code><a href="#topic+sitequant">sitequant</a></code>
directly compute quantiles of the regional growth curve and of
distributions for individual sites, respectively,
from a regional frequency distribution fitted by <code>regfit</code>.
</p>
<p><code><a href="#topic+regsimh">regsimh</a></code>
runs Monte Carlo simulations to estimate the distribution of
heterogeneity and goodness-of-fit measures for an artificial region.
</p>
<p><code><a href="#topic+regsimq">regsimq</a></code>
runs Monte Carlo simulations to estimate the variability of
quantile estimates from a regional frequency distribution.
</p>
<p><code><a href="#topic+regquantbounds">regquantbounds</a></code> and <code><a href="#topic+sitequantbounds">sitequantbounds</a></code>
compute error bounds for the regional growth curve and for quantiles
at individual sites, respectively, from a regional frequency distribution
fitted by <code>regfit</code>.
</p>
<p>Functions <code>cluagg</code>, <code>cluinf</code>, <code>clukm</code>, <code>reglmr</code>,
and <code>regtst</code> are analogous to Fortran routines from the
LMOMENTS package, version 3.04, available from StatLib at
<a href="http://lib.stat.cmu.edu/general/lmoments">http://lib.stat.cmu.edu/general/lmoments</a>.
In addition, functions <code>regsimh</code> and <code>regsimq</code>
provide similar functionality to <code>PROGRAM XSIM</code>
in the LMOMENTS Fortran package.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>

<hr>
<h2 id='Appalach'>Data for streamflow gaging stations in Appalachia</h2><span id='topic+Appalach'></span>

<h3>Description</h3>

<p>Site characteristics and sample <code class="reqn">L</code>-moments of annual maximum streamflow
for 104 gaging stations in Appalachia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Appalach</code></pre>


<h3>Format</h3>

<p>A data frame with 104 observations on the following 11 variables:
</p>

<dl>
<dt><code>siteid</code></dt><dd><p>Character vector: each site's Hydrologic Unit Code,
a unique identifier.</p>
</dd>
<dt><code>lat</code></dt><dd><p>Numeric vector: gage latitude, in degrees.</p>
</dd>
<dt><code>long</code></dt><dd><p>Numeric vector: gage longitude, in degrees west of the Greenwich Meridian.</p>
</dd>
<dt><code>area</code></dt><dd><p>Numeric vector: drainage basin area, in square miles.</p>
</dd>
<dt><code>elev</code></dt><dd><p>Numeric vector: gage elevation, in feet.</p>
</dd>
<dt><code>n</code></dt><dd><p>Numeric vector: record length.</p>
</dd>
<dt><code>mean</code></dt><dd><p>Numeric vector: sample mean.</p>
</dd>
<dt><code>t</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-CV.</p>
</dd>
<dt><code>t_3</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-skewness.</p>
</dd>
<dt><code>t_4</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-kurtosis.</p>
</dd>
<dt><code>t_5</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-moment ratio <code class="reqn">t_5</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data in columns <code>lat</code>, <code>long</code>, <code>area</code> and <code>elev</code>,
and the streamflow data used to compute the sample <code class="reqn">L</code>-moments,
were obtained from &ldquo;Hydrodata&rdquo; CD-ROMs (Hydrosphere, 1993),
which reproduce data from the U.S. Geological Survey's WATSTORE data files.
</p>


<h3>Source</h3>

<p>The file <code>appalach.dat</code> in the LMOMENTS Fortran package (Hosking, 1996).
</p>


<h3>References</h3>

<p>Hydrosphere (1993).
<em>Hydrodata CD-ROMs, vol. 4.0: USGS peak values</em>.
Hydrosphere Data Products, Boulder, Colo.
</p>
<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Appalach
</code></pre>

<hr>
<h2 id='Cascades'>L-moments of annual precipitation totals</h2><span id='topic+Cascades'></span>

<h3>Description</h3>

<p><code class="reqn">L</code>-moments of annual precipitation totals for the
&ldquo;North Cascades&rdquo; region of Plantico et al. (1990).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cascades</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+regdata">regdata</a></code>.
It is a  data frame with 19 observations on the following 7 variables:
</p>

<dl>
<dt><code>name</code></dt><dd><p>Character vector: site identifier.</p>
</dd>
<dt><code>n</code></dt><dd><p>Numeric vector: record length.</p>
</dd>
<dt><code>mean</code></dt><dd><p>Numeric vector: sample mean.</p>
</dd>
<dt><code>t</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-CV.</p>
</dd>
<dt><code>t_3</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-skewness.</p>
</dd>
<dt><code>t_4</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-kurtosis.</p>
</dd>
<dt><code>t_5</code></dt><dd><p>Numeric vector: sample <code class="reqn">L</code>-moment ratio <code class="reqn">t_5</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are summary statistics of annual precipitation totals
at 19 sites in the northwest U.S.,
the &ldquo;North Cascades&rdquo; region of Plantico et al. (1990).
The precipitation data were obtained from the Historical Climatology Network
(Karl et al., 1990).
</p>


<h3>Source</h3>

<p>The file <code>cascades.dat</code> in the LMOMENTS Fortran package (Hosking, 1996).
</p>


<h3>References</h3>

<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>
<p>Karl, T. R., Williams, C. N., Quinlan, F. T., and Boden, T. A. (1990).
United States historical climatology network (HCN) serial temperature
and precipitation data.
<em>ORNL/CDIAC-30 NDP-019/R1</em>, Carbon Dioxide Information
Analysis Center, Oak Ridge National Laboratory, Oak Ridge, Tenn.
</p>
<p>Plantico, M. S., Karl, T. R., Kukla, G., and Gavin, J. (1990).
Is recent climate change across the United States related to rising
levels of anthropogenic greenhouse gases?
<em>Journal of Geophysical Research</em>, <b>95</b>, 16617&ndash;16637.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cascades        # L-moment ratios, etc., for the Cascades data
lmrd(Cascades)  # L-moment ratio diagram for the Cascades data
</code></pre>

<hr>
<h2 id='cluagg'>Hierarchical clustering</h2><span id='topic+cluagg'></span>

<h3>Description</h3>

<p>Performs cluster analysis by one of several agglomerative hierarchical methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluagg(x, method="ward")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluagg_+3A_x">x</code></td>
<td>

<p>A numeric matrix (or a data frame with all numeric columns,
which will be coerced to a matrix).  Contains the data:
each row should contain the attributes for a single point.</p>
</td></tr>
<tr><td><code id="cluagg_+3A_method">method</code></td>
<td>
<p>Clustering method. Any method valid for
<code><a href="stats.html#topic+hclust">hclust</a></code> may be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In agglomerative hierarchical clustering, there are initially <code class="reqn">n</code> clusters,
each containing one data point, labeled <code class="reqn">1</code> through <code class="reqn">n</code>
in the same order as the data points.
At each stage of clustering, two clusters are merged.
Their labels are saved in the <code>merge</code> array.
The smaller of the two labels is used as the label of the merged cluster.
After the <code class="reqn">i</code>th stage of clustering there are <code class="reqn">n-i</code> clusters.
To find which data points belong to which clusters, use function
<code><a href="#topic+cluinf">cluinf</a></code>.
</p>


<h3>Value</h3>

<p>A list with elements as follows.
</p>
<table>
<tr><td><code>merge</code></td>
<td>
<p>Matrix of dimension <code>(nrow(x)-1,2)</code>.
The <code class="reqn">i</code>th row contains the labels of the clusters merged at the
<code class="reqn">i</code>th merge.</p>
</td></tr>
<tr><td><code>wgss</code></td>
<td>
<p>Vector of length <code>nrow(x)-1</code>.
The <code class="reqn">i</code>th element is the total within-cluster dispersion
after the <code class="reqn">i</code>th merge.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Clustering is performed internally by function <code><a href="stats.html#topic+hclust">hclust</a></code>
in the <span class="rlang"><b>R</b></span> <span class="pkg">stats</span> package.</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cluinf">cluinf</a></code> to get details of the clusters
at a particular stage of the merging.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Clustering of gaging stations in Appalachia, as in Hosking
## and Wallis (1997, sec. 9.2.3)
data(Appalach)
# Form attributes for clustering (Hosking and Wallis's Table 9.4)
att &lt;- cbind(a1 = log(Appalach$area),
             a2 = sqrt(Appalach$elev),
             a3 = Appalach$lat,
             a4 = Appalach$long)
att &lt;- apply(att, 2, function(x) x/sd(x))
att[,1] &lt;- att[,1] * 3
# Clustering by Ward's method
(cl&lt;-cluagg(att))
# Details of the clustering with 7 clusters
cluinf(cl,7)
</code></pre>

<hr>
<h2 id='cluinf'>Provide information about a hierarchical clustering</h2><span id='topic+cluinf'></span>

<h3>Description</h3>

<p>Agglomerative hierarchical clustering procedures typically produce
a list of the clusters merged at each stage of the clustering.
<code>cluinf</code> uses this list to construct arrays that explicitly show
which cluster a given data point belongs to, and which data points belong
to a given cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluinf(merge, nclust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluinf_+3A_merge">merge</code></td>
<td>
<p>Matrix with 2 columns. The <code class="reqn">i</code>th row contains
the labels of the clusters merged at the <code class="reqn">i</code>th merge.
</p>
<p>Can also be the object returned by a call to <code><a href="#topic+cluagg">cluagg</a></code>.</p>
</td></tr>
<tr><td><code id="cluinf_+3A_nclust">nclust</code></td>
<td>
<p>Number of clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Information about the clustering that has <code>nclust</code> clusters.
It is a list with the following elements:
</p>
<table>
<tr><td><code>assign</code></td>
<td>
<p>Vector giving the assignment of items to clusters.</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>List with <code>nclust</code> elements. Each element contains
the labels of the items in one cluster.</p>
</td></tr>
<tr><td><code>num</code></td>
<td>
<p>Vector of length <code>nclust</code>, containing the
number of items in each cluster.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cluagg">cluagg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Clustering of gaging stations in Appalachia, as in Hosking
## and Wallis (1997, sec. 9.2.3)
data(Appalach)
# Form attributes for clustering (Hosking and Wallis's Table 9.4)
att &lt;- cbind(a1 = log(Appalach$area),
             a2 = sqrt(Appalach$elev),
             a3 = Appalach$lat,
             a4 = Appalach$long)
att &lt;- apply(att, 2, function(x) x/sd(x))
att[,1] &lt;- att[,1] * 3
# Clustering by Ward's method
(cl&lt;-cluagg(att))
# Details of the clustering with 7 clusters
cluinf(cl, 7)
</code></pre>

<hr>
<h2 id='clukm'>Cluster analysis via K-means algorithm</h2><span id='topic+clukm'></span>

<h3>Description</h3>

<p>Performs cluster analysis using the K-means algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clukm(x, assign, maxit = 10, algorithm = "Hartigan-Wong")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clukm_+3A_x">x</code></td>
<td>

<p>A numeric matrix (or a data frame with all numeric
columns, which will be coerced to a matrix).  Contains the data:
each row should contain the attributes for a single point.</p>
</td></tr>
<tr><td><code id="clukm_+3A_assign">assign</code></td>
<td>

<p>A vector whose distinct values indicate
the initial clustering of the points.</p>
</td></tr>
<tr><td><code id="clukm_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations.</p>
</td></tr>
<tr><td><code id="clukm_+3A_algorithm">algorithm</code></td>
<td>

<p>Clustering algorithm.  Permitted values are the same as for
<code>kmeans</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>kmeans</code>.  For details see the help
for <code><a href="stats.html#topic+kmeans">kmeans</a></code>.</p>


<h3>Note</h3>

<p><code>clukm</code> is a wrapper for the <span class="rlang"><b>R</b></span> function <code>kmeans</code>.
The only difference is that in <code>clukm</code> the user supplies an initial
assignment of sites to clusters (from which cluster centers are computed),
whereas in <code>kmeans</code> the user supplies the initial cluster centers
explicitly.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+kmeans">kmeans</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Clustering of gaging stations in Appalachia, as in Hosking
## and Wallis (1997, sec. 9.2.3)
data(Appalach)
# Form attributes for clustering (Hosking and Wallis's Table 9.4)
att &lt;- cbind(a1 = log(Appalach$area),
             a2 = sqrt(Appalach$elev),
             a3 = Appalach$lat,
             a4 = Appalach$long)
att &lt;- apply(att, 2, function(x) x/sd(x))
att[,1] &lt;- att[,1] * 3
# Clustering by Ward's method
(cl &lt;- cluagg(att))
# Details of the clustering with 7 clusters
(inf &lt;- cluinf(cl, 7))
# Refine the 7 clusters by K-means
clkm &lt;- clukm(att, inf$assign)
# Compare the original and K-means clusters
table(Kmeans=clkm$cluster, Ward=inf$assign)
# Some details about the K-means clusters: range of area, number
# of sites, weighted average L-CV and L-skewness
bb &lt;- by(Appalach, clkm$cluster, function(x)
  c( min.area = min(x$area),
     max.area = max(x$area),
     n = nrow(x),
     ave.t = round(weighted.mean(x$t, x$n), 3),
     ave.t_3 = round(weighted.mean(x$t_3, x$n), 3)))
# Order the clusters in increasing order of minimum area
ord &lt;- order(sapply(bb, "[", "min.area"))
# Make the result into a data frame.  Compare with Hosking
# and Wallis (1997), Table 9.5.
do.call(rbind, bb[ord])
</code></pre>

<hr>
<h2 id='evplot.rfd'>Extreme-value plot of a regional frequency distribution</h2><span id='topic+evplot'></span><span id='topic+evplot.rfd'></span>

<h3>Description</h3>

<p>Plots a regional frequency distribution, optionally with error bounds
for either the regional growth curve
or the quantile function for an individual site.
</p>
<p>The graph is an &ldquo;extreme-value plot&rdquo;, i.e. the horizontal axis
is the quantile of an extreme-value type I (Gumbel) distribution,
and the quantile function of that distribution would plot as a straight line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfd'
evplot(y, ybounds, npoints=101, add=FALSE, plim,
  xlim=c(-2,5), ylim,
  xlab=expression("Reduced variate,  " * -log(-log(italic(F)))),
  ylab="Quantile", rp.axis=TRUE, type="l", lty=c(1,2), col=c(1,1),
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evplot.rfd_+3A_y">y</code></td>
<td>
<p>Object of class <code><a href="#topic+rfd">rfd</a></code>, containing the specification
of a regional frequency distribution.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_ybounds">ybounds</code></td>
<td>
<p>Optional. Object of class <code>rfdbounds</code> (typically created
by <code><a href="#topic+regquantbounds">regquantbounds</a></code> or <code><a href="#topic+sitequantbounds">sitequantbounds</a></code>),
containing error bounds for quantile estimates for the
regional frequency distribution specified by <code>y</code>.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_npoints">npoints</code></td>
<td>
<p>Number of points to use in drawing the quantile function.
The points are equally spaced along the x axis.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_add">add</code></td>
<td>
<p>Logical: if <code>TRUE</code>, add to existing plot.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_plim">plim</code></td>
<td>
<p>X axis limits, specified as probabilities.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_xlim">xlim</code></td>
<td>
<p>X axis limits, specified as values of the Gumbel reduced variate
<code class="reqn">-\log(-\log(F))</code>, where <code class="reqn">F</code> is the
nonexceedance probability.
Not used if <code>plim</code> is specified.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_ylim">ylim</code></td>
<td>
<p>Y axis limits.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_xlab">xlab</code></td>
<td>
<p>X axis label.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_rp.axis">rp.axis</code></td>
<td>
<p>Logical: whether to draw the &ldquo;Return period&rdquo; axis,
a secondary horizontal axis.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_type">type</code></td>
<td>
<p>Vector of plot types.  The first element is for the quantile
function; subsequent elements are for the error bounds,
and will be used cyclically until all lines are drawn.
Interpreted in the same way as the <code>type</code> plotting parameter,
i.e. <code>"l"</code> for lines, <code>"b"</code> for points connected by lines, etc.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_lty">lty</code></td>
<td>
<p>Vector of line types. The first element is for the quantile
function; subsequent elements are for the error bounds,
and will be used cyclically until all lines are drawn.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_col">col</code></td>
<td>
<p>Vector of colors. The first element is for the quantile
function; subsequent elements are for the error bounds,
and will be used cyclically until all lines are drawn.</p>
</td></tr>
<tr><td><code id="evplot.rfd_+3A_...">...</code></td>
<td>
<p>Additional parameters are passed to the plotting routine.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>ybounds</code> is missing, a graph is drawn of the quantile function
(regional growth curve) of the distribution specified by <code>y</code>.
</p>
<p>If <code>ybounds</code> is present, it may contain error bounds for either
a regional growth curve or the quantile function at a single site.
This regional growth curve or site quantile function is plotted
using arguments <code>type[1]</code>, <code>lty[1]</code> and <code>col[1]</code>.
Then, in each case, error bounds are added to the plot.
The <code>ybounds</code> object typically contains,
for several probabilities specified by <code>ybounds$bounds</code>,
error bounds corresponding to that probability
for several quantiles.
For the<code>j</code>th bound probability, the bounds for the various quantiles
will be joined by straight lines (so to obtain a smooth curve
there should be a lot of quantiles!), using graphics parameters
<code>type[j+1]</code>, <code>lty[j+1]</code> and <code>col[j+1]</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+regfit">regfit</a></code>, which creates objects of class <code>"rfd"</code>;
<code><a href="#topic+regquantbounds">regquantbounds</a></code> and <code><a href="#topic+sitequantbounds">sitequantbounds</a></code>,
which create objects of class <code>"rfdbounds"</code>;
<code>evdistp</code>, <code>evdistq</code>, and <code>evpoints</code>,
all in package <span class="pkg">lmom</span>, for adding further curves and points
to the plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cascades                        # An object of class "regdata"
rfit &lt;- regfit(Cascades, "gno") # Fit a generalized normal distribution

evplot(rfit)                    # Plot the regional growth curve

# Compute error bounds for quantile estimates.  We will
# (optimistically) generate bounds for a homogeneous region
# with the same frequency distribution as the one fitted to
# the Cascades data.
fval &lt;- seq(.01, .99, by=.01)   # A lot of quantiles
simq &lt;- regsimq(rfit$qfunc, nrec=Cascades$n, nrep=100, f=fval,
  fit=rfit$dist)

# Regional growth curve, and bounds
rbounds &lt;- regquantbounds(simq, rfit)
evplot(rfit, rbounds)

# Quantile function for site 3, and bounds
sbounds &lt;- sitequantbounds(simq, rfit, site=3)
evplot(rfit, sbounds)
</code></pre>

<hr>
<h2 id='Maxwind'>Maximum wind speeds</h2><span id='topic+Maxwind'></span>

<h3>Description</h3>

<p>Annual maximum wind speeds at 12 sites in the southeast U.S.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Maxwind</code></pre>


<h3>Format</h3>

<p>A list of 12 numeric vectors.
</p>


<h3>Details</h3>

<p>The name of a list element is the site location, including
a reference number used by Simiu et al. (1979).
Each list element is a numeric vector containing the annual
maximum wind speeds for that site.
The period of observation varies from site to site:
for details see Simiu et al. (1979).
</p>


<h3>Source</h3>

<p>Simiu, E., Changery, M. J., and Filliben, J. J. (1979).
Extreme wind speeds at 129 stations in the contiguous United States.
<em>Building Science Series 118</em>, National Bureau of Standards,
Washington, D.C.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(Maxwind)
regsamlmu(Maxwind)  # sample L-moments
</code></pre>

<hr>
<h2 id='regavlmom'>Regional weighted average of L-moments</h2><span id='topic+regavlmom'></span>

<h3>Description</h3>

<p>Computes a regional weighted average of <code class="reqn">L</code>-moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  regavlmom(regdata, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regavlmom_+3A_regdata">regdata</code></td>
<td>
<p>Object of class <code><a href="#topic+regdata">regdata</a></code>, containing
summary statistics of the data for the sites in a region.</p>
</td></tr>
<tr><td><code id="regavlmom_+3A_weight">weight</code></td>
<td>
<p>Vector containing the weights to be used for each site.
If omitted, weights will be the sample size at each site,
taken from the second column of <code>regdata</code>.
If a single value, equal weights will be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing the regional average <code class="reqn">L</code>-moments.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>reglm &lt;- regsamlmu(Maxwind)
regavlmom(reglm)            # Weight proportional to record length
regavlmom(reglm, weight=1)  # Equal weights
</code></pre>

<hr>
<h2 id='regdata'>The regdata class</h2><span id='topic+regdata'></span><span id='topic+as.regdata'></span>

<h3>Description</h3>

<p>An object of class <code>"regdata"</code> stores
summary statistics of the data for the sites in a region.
It is a data frame with each row containing data for one site.
The columns should contain
the site name, record length and <code class="reqn">L</code>-moments
and <code class="reqn">L</code>-moment ratios, in the order
<code class="reqn">\ell_1</code> (mean),
<code class="reqn">t</code> (<code class="reqn">L</code>-CV),
<code class="reqn">t_3</code> (<code class="reqn">L</code>-skewness),
<code class="reqn">t_4</code> (<code class="reqn">L</code>-kurtosis),
<code class="reqn">t_5</code>,
<code class="reqn">t_6</code>, etc.
</p>
<p>There should be at least four columns, but most functions that use
objects of class <code>"regdata"</code> typically require more columns.
Six or seven columns (4 or 5 <code class="reqn">L</code>-moments) is usually
adequate for regional frequency analysis.
</p>
<p>Note that the fourth column should contain values of
the <code class="reqn">L</code>-CV <code class="reqn">t=\ell_2/\ell_1</code>, not the <code class="reqn">L</code>-scale <code class="reqn">\ell_2</code>!
</p>
<p>Objects of class <code>"regdata"</code> are created by <code>as.regdata</code>,
and by <code>regsamlmu</code> (with default settings of its arguments).
They are used by several functions in package <span class="pkg">lmomRFA</span>, including
<code><a href="#topic+regavlmom">regavlmom</a></code> (which computes regional average <code class="reqn">L</code>-moments),
<code><a href="#topic+regfit">regfit</a></code> (which fits a regional frequency distribution), and
<code><a href="#topic+regtst">regtst</a></code> (which computes discordancy, heterogeneity and
goodness-of-fit measures).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.regdata(x, warn.names=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regdata_+3A_x">x</code></td>
<td>
<p><span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="regdata_+3A_warn.names">warn.names</code></td>
<td>
<p>Logical: if <code>TRUE</code>, warnings are issued if the
column names of <code>x</code> appear to be inconsistent with
what is expected for an object of class <code>"regdata"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.regdata</code> converts an <span class="rlang"><b>R</b></span> object to class <code>"regdata"</code>.
Only data frames and numeric matrices can be converted.
</p>


<h3>Value</h3>

<p>An object of class <code>"regdata"</code>.</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>Cascades        # 'Cascades' is of class "regdata"

# Create a data frame with site statistics
dd&lt;-data.frame(
  name      =c("site 1", "site 2", "site 3"),
  n         =c(  20,   30,   40),
  mean      =c( 100,  110,  120),
  LCV       =c(0.20, 0.25, 0.30),
  L_skewness=c(0.15, 0.20, 0.25),
  L_kurtosis=c(0.10, 0.15, 0.20),
  t_5       =c(0.10, 0.12, 0.14))
# Convert to class "regdata"
rdd&lt;-as.regdata(dd)
rdd
class(rdd)
</code></pre>

<hr>
<h2 id='regfit'>Fit a regional frequency distribution</h2><span id='topic+regfit'></span><span id='topic+rfd'></span><span id='topic+print.rfd'></span>

<h3>Description</h3>

<p>Fits a frequency distribution to a vector of regional average
<code class="reqn">L</code>-moments.  Returns an object of class <code>"rfd"</code>,
which contains the specification of the regional frequency distribution:
the quantile function, parameters of the regional growth curve,
and the index-flood values (site-specific scale factors) for each site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regfit(regdata, dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regfit_+3A_regdata">regdata</code></td>
<td>
<p>Object of class <code><a href="#topic+regdata">regdata</a></code>, containing
summary statistics of the data for the sites in a region.</p>
</td></tr>
<tr><td><code id="regfit_+3A_dist">dist</code></td>
<td>
<p>Character string specifying the distribution to be fitted.
See &ldquo;Details&rdquo; below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes regional average <code class="reqn">L</code>-moments
(by calling <code>regavlmom</code>) and fits a probability distribution
to the regional average <code class="reqn">L</code>-moments.
This distribution has mean 1, i.e., the index flood is the
mean of the distribution.
</p>
<p>For distribution <code>dist</code> there should exist a function to estimate
the parameters of the distribution given a set of <code class="reqn">L</code>-moments.
The function should have a name that is the character string <code>"pel"</code>
followed by the character string <code>dist</code>.
It should accept a single argument, a vector containing <code class="reqn">L</code>-moments
<code class="reqn">\ell_1</code>, <code class="reqn">\ell_2</code>, <code class="reqn">t_3</code>, <code class="reqn">t_4</code>, etc.,
and return a vector of distribution parameters.
</p>
<p>For distribution <code>dist</code> there should also exist a quantile function,
which should have a name that is the character string
<code>"qua"</code> followed by the character string <code>dist</code>.
It should accept two arguments: a vector of probabilities
and a vector containing the parameters of the distribution.
</p>
<p>The search path used to find the <code>"pel"</code> and <code>"qua"</code> functions
is the same as for arguments supplied to <code>regfit</code>, i.e.
the enclosing frames of the function, followed by the search path
specified by <code>search()</code>.
</p>
<p>The estimation routines and quantile functions in package <span class="pkg">lmom</span>
have the form described here.   For example, to use a
generalized extreme value distribution set <code>dist</code> to be
the string <code>"gev"</code>; then the fitting function <code>pelgev</code>
and the quantile function <code>quagev</code> will be used
(unless these functions have been masked by another object
on the search path).
</p>


<h3>Value</h3>

<p>An object of class <code>"rfd"</code>,
containing the specification of the regional frequency distribution:
It is a list with the following elements:
</p>
<table>
<tr><td><code>dist</code></td>
<td>
<p>The character string <code>dist</code>.</p>
</td></tr>
<tr><td><code>para</code></td>
<td>
<p>Vector containing the parameters of the fitted regional distribution.</p>
</td></tr>
<tr><td><code>qfunc</code></td>
<td>
<p>The quantile function of distribution <code>dist</code>.
It is a function that takes a single argument, a vector of probabilities,
and returns a vector of quantiles.</p>
</td></tr>
<tr><td><code>rmom</code></td>
<td>
<p>The regional average <code class="reqn">L</code>-moments.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>Index flood values at each site.  This is a named vector
whose values are the index flood values at each site, from <code>regdata[[3]]</code>,
and whose names are the site names, from <code>regdata[[1]]</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cascades)                  # An object of class "regdata"
rfit &lt;- regfit(Cascades, "gno") # Fit a generalized normal distribution
rfit                            # Print details of the fitted distribution
                                #   (components 'dist' and 'para')
rfit$index                      # Index flood values

evplot(rfit)                    # Plot the regional growth curve
evplot(qfunc=rfit$qfunc)        # The same, but with more typing
evplot(qfunc=regqfunc(rfit))    # The same, with still more typing
</code></pre>

<hr>
<h2 id='reglmr'>Regional weighted average of L-moments</h2><span id='topic+reglmr'></span>

<h3>Description</h3>

<p>Regional weighted average of <code class="reqn">L</code>-moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reglmr(xmom, weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reglmr_+3A_xmom">xmom</code></td>
<td>

<p>Matrix or data frame each of whose rows contains the <code class="reqn">L</code>-moments
and <code class="reqn">L</code>-moment ratios for one site, in the order <code class="reqn">\ell_1</code>,
<code class="reqn">\ell_2</code>, <code class="reqn">t_3</code>, <code class="reqn">t_4</code>, etc.
</p>
</td></tr>
<tr><td><code id="reglmr_+3A_weight">weight</code></td>
<td>

<p>Vector containing the weights to be used for each site.
If omitted, equal weights will be used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing the regional average <code class="reqn">L</code>-moments.
</p>


<h3>Note</h3>

<p>This function is deprecated and may be removed
from a future version of the package.
Function <code><a href="#topic+regavlmom">regavlmom</a></code> is the recommended replacement.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>(xmom&lt;-t(sapply(Maxwind,samlmu)))
nrec&lt;-sapply(Maxwind,length)
reglmr(xmom,nrec)   # weighted by record length
reglmr(xmom)        # unweighted
</code></pre>

<hr>
<h2 id='regquant'>Quantiles and quantile function of a regional frequency distribution</h2><span id='topic+regqfunc'></span><span id='topic+regquant'></span>

<h3>Description</h3>

<p><code>regquant</code> computes quantiles of a regional frequency distribution,
i.e., values of the regional growth curve.
</p>
<p><code>regqfunc</code> returns a function that will compute the quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regquant(f, rfd)

regqfunc(rfd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regquant_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="regquant_+3A_rfd">rfd</code></td>
<td>
<p>Object of class <code><a href="#topic+rfd">rfd</a></code>, containing the specification
of a regional frequency distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>regquant</code> returns a vector of quantiles.
</p>
<p><code>regqfunc</code> returns the <code>qfunc</code> element of <code>rfd</code>.
This is a function that takes one argument,
which should be a vector of probabilities, and returns a vector of quantiles.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+regfit">regfit</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>rfit &lt;- regfit(Cascades,"gno")  # Fit regional distribution

# Compute some quantiles
regquant(seq(0.1, 0.9, by=0.1), regfit(Cascades,"gno"))

# Get the quantile function (regional growth curve)
rgc &lt;- regqfunc(rfit)

# Compute quantiles by evaluating the regional growth curve
rgc(seq(0.1, 0.9, by=0.1))

# Plot the regional growth curve
curve(rgc, 0.01, 0.99)

</code></pre>

<hr>
<h2 id='regquantbounds'>Compute error bounds for a regional frequency distribution</h2><span id='topic+regquantbounds'></span><span id='topic+sitequantbounds'></span>

<h3>Description</h3>

<p>For a regional frequency distribution, the functions compute
the root mean square error (RMSE) and error bounds for quantiles
either of the regional growth curve (<code>regquantbounds</code>)
or of distributions at individual sites (<code>sitequantbounds</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regquantbounds(relbounds, rfd)

sitequantbounds(relbounds, rfd, sitenames, index, seindex, drop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regquantbounds_+3A_relbounds">relbounds</code></td>
<td>
<p>An object of class <code>"regsimq"</code>,
the result of calling function <code>regsimq</code> to simulate
relative RMSE and error bounds for a regional frequency distribution.</p>
</td></tr>
<tr><td><code id="regquantbounds_+3A_rfd">rfd</code></td>
<td>
<p>An object of class <code>"rfd"</code>, containing the specification
of a regional frequency distribution.</p>
</td></tr>
<tr><td><code id="regquantbounds_+3A_sitenames">sitenames</code></td>
<td>
<p>Vector of site names.</p>
</td></tr>
<tr><td><code id="regquantbounds_+3A_index">index</code></td>
<td>
<p>Values of the estimated site-specific scale factor
(&ldquo;index flood&rdquo;) for the sites.</p>
</td></tr>
<tr><td><code id="regquantbounds_+3A_seindex">seindex</code></td>
<td>
<p>Standard errors of the estimates in <code>index</code>.</p>
</td></tr>
<tr><td><code id="regquantbounds_+3A_drop">drop</code></td>
<td>
<p>Logical: if <code>TRUE</code> and there is only one site,
the value returned from <code>sitequantbounds</code> will be an object of
class <code>"rfdbounds"</code> rather than a list containing one such object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The relative RMSE values from <code>relbounds</code> are
multiplied by the quantile values from <code>rfd</code>
to yield absolute RMSE values for quantile estimates,
and the quantile values from <code>rfd</code> are divided by
the error bounds from <code>relbounds</code>
to yield error bounds for quantiles,
as in Hosking and Wallis (1997), eq. (6.19).
These computations apply to quantiles
either of the regional growth curve (for <code>regquantbounds</code>) or
of the frequency distributions at individual sites (for <code>sitequantbounds</code>).
</p>
<p>If argument <code>index</code> of <code>sitequantbounds</code> is missing,
then results (RMSE and error bounds of quantiles) are computed for sites
in the region specified by <code>rfd</code> and its <code>index</code> component,
assuming that the site-specific scale factor (&ldquo;index flood&rdquo;)
is estimated by the sample mean at each site, computed from the same data set
that was used to fit the regional frequency distribution.
</p>
<p>If <code>index</code> and <code>sitenames</code> are both missing, then results
will be computed for all of the sites in the region specified by <code>rfd</code>.
</p>
<p>If <code>index</code> is missing and <code>sitenames</code> is present,
then error bounds will be computed for a subset of the
sites in the region specified by <code>rfd</code>.
<code>sitenames</code> will be used to select sites from the vector <code>rfd$index</code>,
either by position or by name.
</p>
<p>If argument <code>index</code> of <code>sitequantbounds</code> is present,
then results are computed for arbitrary sites
(for example, ungauged sites for which the regional growth curve
of the regional frequency distribution <code>rfd</code> is believed to apply),
assuming that the site-specific scale factor (&ldquo;index flood&rdquo;)
is estimated from data that are (approximately) statistically independent
of the data used to fit the regional frequency distribution.
In this case <code>relbounds$sim.rgc</code> must not be <code>NULL</code>,
i.e. <code>relbounds</code> should have been generated by a call to
<code>regsimq</code> with argument <code>save=TRUE</code>.
</p>
<p>If <code>index</code> and <code>sitenames</code> are both present,
they must have the same length, and will be taken to refer to sites
whose names are the elements of <code>sitenames</code> and whose index-flood values
are the elements of <code>index</code>.
</p>
<p>If <code>index</code> is present and <code>sitenames</code> is missing,
results are computed for sites whose index-flood values
are the elements of <code>index</code>; if <code>index</code> has names, these
names will be used as the site names.
</p>
<p>When <code>index</code> and <code>seindex</code> are specified, it is assumed
in the simulation procedure that the estimated index flood value has a
gamma distribution with mean <code>index</code> and standard deviation <code>seindex</code>.
</p>
<p>As noted by Hosking and Wallis (1997, discussion following (6.19)),
error bounds in the lower tail of the distribution may be unhelpful
when the fitted distribution can take negative values.
In these cases the computed bounds will be
<code>NA</code> (if the quantile estimate is negative) or
<code>Inf</code> (if the quantile estimate is positive but the
corresponding error bound in <code>relbounds</code> is negative).
</p>


<h3>Value</h3>

<p>For <code>regquantbounds</code>, an object of class <code>"rfdbounds"</code>.
This is a data frame with columns
<code>f</code>, probabilities for which quantiles are estimated;
<code>qhat</code>, estimated quantiles;
<code>RMSE</code>, RMSE of the estimated quantiles.
Also, for each bound probability in <code>relbounds$boundprob</code>, there is
a column containing the error bound corresponding to that probability.
The object also has an attribute <code>"boundprob"</code> that contains the
bound probabilities.
</p>
<p>For <code>sitequantbounds</code>, a list each of whose components is
an object of class <code>"rfdbounds"</code> containing results for one site.
In this case the second column of the data frame is named <code>Qhat</code>,
not <code>qhat</code>.
If <code>drop</code> is <code>TRUE</code> and the list has one component,
a single <code>"rfdbounds"</code> object is returned.
</p>
<p>For exact definitions of quantities returned by functions
<code>regquantbounds</code> and <code>regsitebounds</code>, see vignette <code>RegSim</code>.
</p>


<h3>Note</h3>

<p>For a region that is confidently believed to be homogeneous,
the region used to generate the results in <code>relbounds</code>
may be the same as that specified by <code>rfd</code>.
In practice, it is often acknowledged that some degree of heterogeneity
is present in the data to which the distribution <code>rfd</code> is fitted.
The simulations used in function <code>regsimq</code> to generate <code>relbounds</code>
can then be based on a region whose specification includes
an appropriate degree of heterogeneity, and the error bounds calculated
by <code>regquantbounds</code> and <code>sitequantbounds</code> will honestly
reflect the failure of the assumption of homogeneity
made by <code>regfit</code> (i.e. that the at-site growth curves
are the same for all sites in the region) to hold exactly.
The example below illustrates this practice.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code>regsimq</code>, which runs the simulations
that generate the results returned by <code>regquantbounds</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cascades)              # A regional data set

rmom &lt;- regavlmom(Cascades) # Regional average L-moments

# Fit a generalized normal distribution to the regional data
rfit &lt;- regfit(Cascades, "gno")

# Set up an artificial region to be simulated:
# -- Same number of sites as Cascades
# -- Same record lengths as Cascades
# -- Same site means as Cascades
# -- L-CV varies linearly across sites, with mean value equal
#    to the regional average L-CV for the Cascades data.
#      'LCVrange' specifies the  range of L-CV across the sites,
#    and is chosen to reflect the amount of heterogeneity that
#    may reasonably be believed to be present in the Cascades
#    data (see the example for 'regsimh').
# -- L-skewness is the same at each site, and is equal to the
#    regional average L-skewness for the Cascades data
nsites &lt;- nrow(Cascades)
means &lt;- Cascades$mean
LCVrange &lt;- 0.025
LCVs &lt;- seq(rmom[2]-LCVrange/2, rmom[2]+LCVrange/2, len=nsites)
Lskews&lt;-rep(rmom[3], nsites)

# Each site will have a generalized normal distribution:
# get the parameter values for each site
pp &lt;- t(apply(cbind(means, means*LCVs ,Lskews), 1, pelgno))
pp

# Set correlation between each pair of sites to 0.64, the
# average inter-site correlation for the Cascades data
avcor &lt;- 0.64

# Run the simulation.  To save time, use only 100 replications.
simq &lt;- regsimq(qfunc=quagno, para=pp, cor=avcor, nrec=Cascades$n,  nrep=100, fit="gno")

# Apply the simulated bounds to the estimated regional growth curve
regquantbounds(simq, rfit)

# Apply the simulated bounds to quantiles for site 3
sitequantbounds(simq, rfit, site=3)

# Apply the simulated bounds to quantiles for a site whose mean
# is estimated to be 100 with standard error 25
sitequantbounds(simq, rfit, index=100, seindex=25)
</code></pre>

<hr>
<h2 id='regsamlmu'>Sample L-moments of multiple data sets</h2><span id='topic+regsamlmu'></span>

<h3>Description</h3>

<p>Computes the &ldquo;unbiased&rdquo; sample <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment
ratios of multiple sets of data stored in a list or matrix.
Following the paradigm of regional frequency analysis,
we regard the data sets as coming from different measurement sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regsamlmu(x, nmom = 5, sort.data = TRUE, lcv = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regsamlmu_+3A_x">x</code></td>
<td>
<p>A list of numeric vectors, or a numeric matrix.</p>
</td></tr>
<tr><td><code id="regsamlmu_+3A_nmom">nmom</code></td>
<td>
<p>Number of <code class="reqn">L</code>-moments to be computed.</p>
</td></tr>
<tr><td><code id="regsamlmu_+3A_sort.data">sort.data</code></td>
<td>
<p>Logical: whether each data set should be sorted.</p>
</td></tr>
<tr><td><code id="regsamlmu_+3A_lcv">lcv</code></td>
<td>
<p>Logical.
If <code>TRUE</code>, the second <code class="reqn">L</code>-moment will be expressed
as a fraction of the mean, i.e. the computed value will be
the sample <code class="reqn">L</code>-CV <code class="reqn">t=\ell_2/\ell_1</code>.
If <code>FALSE</code>, the second <code class="reqn">L</code>-moment will simply be
the sample <code class="reqn">L</code>-scale value <code class="reqn">\ell_2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sample <code class="reqn">L</code>-moments are computed for each data set.
The calculations use <code>samlmu</code> internally.
If <code>x</code> is a list, each list element should contain data for one site
and the names of the list elements should be the site names.
If <code>x</code> is a matrix, each column should contain data for one site
and the column names should be the site names.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+regdata">regdata</a></code>.
It is a data frame with columns <code>"name"</code> and <code>"n"</code>,
containing respectively the site names and the
number of non-missing data values at each site,
and further columns containing the <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment ratios,
in the order <code class="reqn">\ell_1</code>, <code class="reqn">t</code> (or <code class="reqn">\ell_2</code>),
<code class="reqn">t_3</code>, <code class="reqn">t_4</code>, etc.
</p>


<h3>Note</h3>

<p>The default parameter values are chosen to be convenient
for the regional frequency analysis methods described by
Hosking and Wallis (1997).
Note that the number of <code class="reqn">L</code>-moments and the choice
of whether to return <code class="reqn">L</code>-CV or <code class="reqn">L</code>-scale
are different from the defaults for <code>samlmu</code>.
</p>
<p>Users of the LMOMENTS Fortran package, version 3.04, should note that
its <code>PROGRAM XFIT</code> by default uses plotting-position estimators
of <code class="reqn">L</code>-moment ratios, which give different results from the
&ldquo;unbiased&rdquo; estimators used by <code>regsamlmu</code>
(and by all other functions in package <span class="pkg">lmomRFA</span>).
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Maxwind)       # a list
regsamlmu(Maxwind)

data(airquality)    # a data frame
regsamlmu(airquality[1:4])
</code></pre>

<hr>
<h2 id='regsimh'>Simulate the distribution of heterogeneity and goodness-of-fit measures</h2><span id='topic+regsimh'></span><span id='topic+print.regsimh'></span>

<h3>Description</h3>

<p>Estimates, using Monte Carlo simulation, the distribution of
heterogeneity and goodness-of-fit measures for regional frequency analysis.
These are the statistics <code class="reqn">H</code> and <code class="reqn">Z^{\rm DIST}</code>
defined respectively in sections 4.3.3 and 5.2.3 of Hosking and Wallis (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regsimh(qfunc, para, cor = 0, nrec, nrep = 500, nsim = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regsimh_+3A_qfunc">qfunc</code></td>
<td>
<p>List containing the quantile functions for each site.
Can also be a single quantile function, which will be used for each site.</p>
</td></tr>
<tr><td><code id="regsimh_+3A_para">para</code></td>
<td>
<p>Parameters of the quantile functions at each site.
If <code>qfunc</code> is a list, <code>para</code> must be a list of the same
length whose components are numeric vectors, the parameters of
the corresponding component of <code>qfunc</code>.
If <code>qfunc</code> is a single quantile function, <code>para</code> can be
a single vector, containing a single set of parameter values
that will be used for each site;
a matrix or data frame whose rows each contain the
parameter values for one site;
or a list of length <code>length(nrec)</code> whose components are
numeric vectors, each containing the parameter values for one site.</p>
</td></tr>
<tr><td><code id="regsimh_+3A_cor">cor</code></td>
<td>
<p>Specifies the correlation matrix of the frequency distribution
of each site's data.  Can be a matrix (which will be rescaled to a
correlation matrix if necessary) or a constant (which will be taken
as the correlation between each pair of sites).</p>
</td></tr>
<tr><td><code id="regsimh_+3A_nrec">nrec</code></td>
<td>
<p>Numeric vector containing the record lengths at each site.</p>
</td></tr>
<tr><td><code id="regsimh_+3A_nrep">nrep</code></td>
<td>
<p>Number of simulated regions.</p>
</td></tr>
<tr><td><code id="regsimh_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations used, within each of the <code>nrep</code>
simulated regions, when calculating heterogeneity and
goodness-of-fit measures.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A  realization is generated of data simulated from
the region specified by parameters <code>qfunc</code>, <code>para</code>, and <code>cor</code>,
and with record lengths at each site specified by argument <code>nrec</code>.
The simulation procedure is as described in Hosking and Wallis (1997),
Table 6.1, through step 3.1.2.
Heterogeneity and goodness-of-fit measures are computed
for the realization, using the same method as in function <code>regtst</code>.
The entire procedure is repeated <code>nrep</code> times, and the values
of the heterogeneity and goodness-of-fit measures are saved.
Average values, across all <code>nrep</code> realizations,
of the heterogeneity and goodness-of-fit measures are computed.
</p>


<h3>Value</h3>

<p>An object of class <code>"regsimh"</code>.
This is a list with the following components:
</p>
<table>
<tr><td><code>nrep</code></td>
<td>
<p>The number of simulated regions (argument <code>nrep</code>).</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>The number of simulation used within each region
(argument <code>nsim</code>).</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>Matrix of dimension 8 <code class="reqn">\times</code> <code>nrep</code>,
containing the values, for each of the <code>nrep</code> simulated regions,
of the heterogeneity and goodness-of-fit measures.</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>Vector of length 8, containing the mean values,
across the <code>nrep</code> simulated regions,
of the three heterogeneity and five goodness-of-fit measures.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regtst">regtst</a></code> for details of the
heterogeneity and goodness-of-fit measures.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
data(Cascades)            # A regional data set

rmom&lt;-regavlmom(Cascades) # Regional average L-moments

# Set up an artificial region to be simulated:
# -- Same number of sites as Cascades
# -- Same record lengths as Cascades
# -- Mean 1 at every site (results do not depend on the site means)
# -- L-CV varies linearly across sites, with mean value equal
#    to the regional average L-CV for the Cascades data.
#    'LCVrange' specifies the  range of L-CV across the sites.
# -- L-skewness the same at each site, and equal to the regional
#    average L-skewness for the Cascades data
nsites &lt;- nrow(Cascades)
means &lt;- rep(1,nsites)
LCVrange &lt;- 0.025
LCVs &lt;- seq(rmom[2]-LCVrange/2, rmom[2]+LCVrange/2, len=nsites)
Lskews&lt;-rep(rmom[3], nsites)

# Each site will have a generalized normal distribution:
# get the parameter values for each site
pp &lt;- t(apply(cbind(means, means*LCVs ,Lskews), 1, pelgno))

# Set correlation between each pair of sites to 0.64, the
# average inter-site correlation for the Cascades data
avcor &lt;- 0.64

# Run the simulation.  It will take some time (about 25 sec
# on a Lenovo W500, a moderately fast 2011-vintage laptop)
# Note that the results are consistent with the statement
# "the average H value of simulated regions is 1.08"
# in Hosking and Wallis (1997, p.98).
set.seed(123)
regsimh(qfunc=quagno, para=pp, cor=avcor, nrec=Cascades$n,
  nrep=100)

## End(Not run)</code></pre>

<hr>
<h2 id='regsimq'>Compute error bounds for a fitted regional frequency distribution</h2><span id='topic+regsimq'></span><span id='topic+print.regsimq'></span>

<h3>Description</h3>

<p>Computes, using Monte Carlo simulation, relative error bounds
for estimated quantiles of a regional frequency distribution
fitted by <code>regfit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regsimq(qfunc, para, cor = 0, index = NULL, nrec, nrep = 10000,
        fit = "gev", f = c(0.01, 0.1, 0.5, 0.9, 0.99, 0.999),
        boundprob = c(0.05, 0.95), save = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regsimq_+3A_qfunc">qfunc</code></td>
<td>
<p>List containing the quantile functions for each site.
Can also be a single quantile function, which will be used for each site.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_para">para</code></td>
<td>
<p>Parameters of the quantile functions at each site.
If <code>qfunc</code> is a list, <code>para</code> must be a list of the same length
whose components are numeric vectors, the parameters of
the corresponding component of <code>qfunc</code>.
If <code>qfunc</code> is a single quantile function, <code>para</code> can be
a single vector, containing a single set of parameter values
that will be used for each site;
a matrix or data frame whose rows each contain the
parameter values for one site;
or a list of length <code>length(nrec)</code> whose components are
numeric vectors, each containing the parameter values for one site.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_cor">cor</code></td>
<td>
<p>Specifies the correlation matrix of the frequency distribution of
each site's data.  Can be a matrix (which will be rescaled to a
correlation matrix if necessary) or a constant (which will be taken as
the correlation between each pair of sites).</p>
</td></tr>
<tr><td><code id="regsimq_+3A_index">index</code></td>
<td>
<p>Specifies the value of the site-specific scale factor
(&ldquo;index flood&rdquo;) at each site.  Can be:
a vector, containing the values at each site;
a constant, which will be taken to be the index flood value at each site;
or (the default) <code>NULL</code>, in which case the index floods at each site
will be taken to be the means of the quantile functions implied by
<code>qfunc</code> and <code>para</code>, and will be computed
by numerical integration of those quantile functions.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_nrec">nrec</code></td>
<td>
<p>Numeric vector containing the record lengths at each site.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_nrep">nrep</code></td>
<td>
<p>Number of simulated regions.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_fit">fit</code></td>
<td>
<p>Character string specifying the distribution to be fitted.
See &ldquo;Details&rdquo; below.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_f">f</code></td>
<td>
<p>Vector of probabilities corresponding to the quantiles
whose accuracy is to be estimated.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_boundprob">boundprob</code></td>
<td>
<p>Vector of probabilities for which error bounds will
be computed.</p>
</td></tr>
<tr><td><code id="regsimq_+3A_save">save</code></td>
<td>
<p>Logical. Should the simulated values of the ratio of
the estimated to the true regional growth curve be saved?
These values are needed when <code>sitequantbounds</code> is called with
its argument <code>index</code> present, e.g. to compute error bounds for
quantiles at sites other than those whose data were used to fit the
regional frequency distribution (e.g., ungauged sites).
If this computation is not required, storage can be saved
by setting <code>save</code> to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A  realization of data from a region is generated as follows.
The frequency distributions at sites (specified by
arguments <code>qfunc</code> and <code>para</code>) are expressed
as <code class="reqn">Q_i(F)=\mu_i q_i(F)</code> where <code class="reqn">\mu_i</code> is the site-specific scale factor
(&ldquo;index flood&rdquo;) and <code class="reqn">q_i(F)</code> is the at-site growth curve.
At each simulation run the at-site growth curves of each site
are randomly permuted, and are scaled by the (unpermuted)
index flood values for the sites.
Data are simulated from these frequency distributions,
with inter-site correlation specified by argument <code>cor</code>
and record lengths at each site specified by argument <code>nrec</code>.
The regional frequency distribution specified by argument <code>fit</code>
is then fitted to the simulated data, as in function <code>regfit</code>.
The procedure is as described in Hosking and Wallis (1997), Table 6.1,
except that the permutation of at-site growth curves is a later
modification, intended to give more realistic sets of simulated data.
For more details, including exact definitions of quantities computed
in the simulation and returned by functions <code>regsimq</code>,
<code>regquantbounds</code>, and <code>regsitebounds</code>, see vignette <code>RegSim</code>.
</p>
<p>From each realization the sample mean values and estimates of the
quantiles of the regional growth curve, for nonexceedance probabilities
specified by argument <code>f</code>, are saved.
</p>
<p>From the simulated values, for each quantile specified by argument <code>f</code>
the relative root mean square error (relative RMSE) is computed as in
Hosking and Wallis (1997, eq. (6.15)).
Error bounds are also computed, as in Hosking and Wallis (1997, eq. (6.18))
but with bound probabilities specified by argument <code>boundprob</code>
rather than the fixed values 0.05 and 0.95 considered by Hosking and Wallis.
The error bounds are sample quantiles, across the <code>nrep</code> realizations,
of the ratio of the estimated regional growth curve
to the true at-site growth curve
or of the ratio of the estimated to the true quantiles at individual sites.
</p>
<p>For distribution <code>fit</code> there should exist a function to estimate
the parameters of the distribution given a set of <code class="reqn">L</code>-moments.
The function should have a name that is the character string
<code>"pel"</code> followed by the character string <code>fit</code>.
It should accept a single argument, a vector containing <code class="reqn">L</code>-moments
<code class="reqn">\ell_1</code>, <code class="reqn">\ell_2</code>, <code class="reqn">t_3</code>, <code class="reqn">t_4</code>, etc.,
and return a vector of distribution parameters.
</p>
<p>For distribution <code>fit</code> there should also exist a quantile function,
which should have a name that is the character string
<code>"qua"</code> followed by the character string <code>fit</code>.
It should accept two arguments: a vector of probabilities
and a vector containing the parameters of the distribution.
</p>
<p>The search path used to find the <code>"pel"</code> and <code>"qua"</code> functions
is the same as for arguments supplied to <code>regsimq</code>, i.e.
the enclosing frames of the function, followed by the search path
specified by <code>search()</code>.
</p>
<p>The estimation routines and quantile functions in package <span class="pkg">lmom</span>
have the form described here.   For example, to use a
generalized extreme value distribution set <code>fit</code> to be
the string <code>"gev"</code>; then the fitting function <code>pelgev</code>
and the quantile function <code>quagev</code> will be used
(unless these functions have been masked by another object
on the search path).
</p>


<h3>Value</h3>

<p>An object of class <code>"regsimq"</code>.
This is a list with the following components:
</p>
<table>
<tr><td><code>f</code></td>
<td>
<p>Vector of probabilities corresponding to the quantiles
whose accuracy is to be estimated.  A copy of argument <code>f</code>.</p>
</td></tr>
<tr><td><code>boundprob</code></td>
<td>
<p>Vector of probabilities corresponding to the error bounds.
A copy of argument <code>boundprob</code>.</p>
</td></tr>
<tr><td><code>nrep</code></td>
<td>
<p>Number of simulated regions.</p>
</td></tr>
<tr><td><code>relbounds.rgc</code></td>
<td>
<p>Data frame containing the relative RMSE and
error bounds for the regional growth curve. It has columns
<code>"f"</code>, probabilities corresponding to each quantile,
<code>"rel.RMSE"</code>, relative RMSE of quantiles  of regional growth curve,
and, for each bound probability in <code>boundprob</code>,
a column giving the error bound (quantile of the empirical distribution
of simulated values of the ratio of the estimated regional growth curve
to the true at-site growth curve) for that bound probability.</p>
</td></tr>
<tr><td><code>relbounds.by.site</code></td>
<td>
<p>List of <code>length(nrec)</code> data frames.
Each data frame contains the relative RMSE and error bounds
for quantiles at one site, and has the same structure
as component <code>relbounds.rgc</code> of the return value.</p>
</td></tr>
<tr><td><code>true.asgc</code></td>
<td>
<p>If <code>save</code> is <code>TRUE</code>, a matrix of dimension
<code>length(f)</code> <code class="reqn">\times</code> <code>length(nrec)</code>, containing
values of the at-site growth curves (quantile functions at each site,
divided by the site-specific scale factors)
for quantiles corresponding to probabilities in <code>f</code>.
</p>
<p>If <code>save</code> is <code>FALSE</code>, list element
<code>true.asgc</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code>sim.rgc</code></td>
<td>
<p>If <code>save</code> is <code>TRUE</code>, a matrix of dimension
<code>length(f)</code> <code class="reqn">\times</code> <code>nrep</code>, containing
the simulated values of the estimated regional growth curve
for quantiles corresponding to probabilities in <code>f</code>.
</p>
<p>If <code>save</code> is <code>FALSE</code>, list element
<code>sim.rgc</code> is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Error bounds for the regional growth curve apply to the
regional growth curve regarded as an estimator of the
growth curve for a randomly chosen site.
The growth curve for site <code class="reqn">i</code> is defined to be
<code class="reqn">q_i(\,.\,)=Q_i(\,.\,)/\mu_i</code>
where <code class="reqn">Q_i(\,.\,)</code> is the site's quantile function
and <code class="reqn">\mu_i</code> is the site-specific scale factor
(&ldquo;index flood&rdquo;) for site <code class="reqn">i</code>.
For each of the <code>nrep</code> simulated regions,
and each probability <code class="reqn">F</code> in <code>f</code>,
the regional growth curve <code class="reqn">\hat{q}(F)</code> is estimated
and the ratios <code class="reqn">\hat{q}(F)/q_i(F)</code> are calculated.
The relative error bounds are empirical quantiles,
corresponding to the probabilities in <code>boundprob</code>,
of the <code>nrep * length(nrec)</code> values of these ratios
obtained from the simulations.
</p>
<p>This differs from the approach taken in Hosking and Wallis (1997),
Table 6.2 and Fig. 6.2, in which error bounds are computed regarding
the estimated regional growth curve as an estimator of the regional
average growth curve <code class="reqn">q^{\rm R}(\,.\,)</code>, the harmonic mean
of the sites' growth curves (Hosking and Wallis, 1997, p. 102).
</p>
<p>When the parent region is homogeneous, with identical frequency distributions
at each site (apart from a site-specific scale factor), the two
approaches give identical results.  For heterogeneous regions the
&ldquo;regard as estimator of randomly chosen site growth curve&rdquo; approach
yields error bounds that are wider, but are more realistic given that the
ultimate aim of regional frequency analysis is estimation of quantiles
at individual sites.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regfit">regfit</a></code>, for details of fitting a regional frequency distribution;
<code><a href="#topic+regquantbounds">regquantbounds</a></code> and <code><a href="#topic+sitequantbounds">sitequantbounds</a></code>, for
converting the relative bounds returned by <code>regsimq</code> into absolute bounds
for quantiles of the regional growth curve or of the
frequency distributions at individual sites.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Cascades)              # A regional data set

rmom &lt;- regavlmom(Cascades) # Regional average L-moments

# Fit generalized normal distribution to regional data
rfit &lt;- regfit(Cascades, "gno")

# Set up an artificial region to be simulated:
# -- Same number of sites as Cascades
# -- Same record lengths as Cascades
# -- Same site means as Cascades
# -- L-CV varies linearly across sites, with mean value equal
#    to the regional average L-CV for the Cascades data.
#    'LCVrange' specifies the  range of L-CV across the sites.
# -- L-skewness the same at each site, and equal to the regional
#    average L-skewness for the Cascades data
nsites &lt;- nrow(Cascades)
means &lt;- Cascades$mean
LCVrange &lt;- 0.025
LCVs &lt;- seq(rmom[2]-LCVrange/2, rmom[2]+LCVrange/2, len=nsites)
Lskews&lt;-rep(rmom[3], nsites)

# Each site will have a generalized normal distribution:
# get the parameter values for each site
pp &lt;- t(apply(cbind(means, means*LCVs ,Lskews), 1, pelgno))

# Set correlation between each pair of sites to 0.64, the
# average inter-site correlation for the Cascades data
avcor &lt;- 0.64

# Run the simulation.  To save time, use only 100 replications.
simq &lt;- regsimq(qfunc=quagno, para=pp, cor=avcor, nrec=Cascades$n,
  nrep=100, fit="gno")

# Relative RMSE and error bounds for the regional growth curve
simq$relbounds.rgc

# Relative RMSE and error bounds for quantiles at site 3
simq$relbounds.by.site[[3]]
</code></pre>

<hr>
<h2 id='regtst'>Test statistics for regional frequency analysis</h2><span id='topic+regtst'></span><span id='topic+regtst.s'></span><span id='topic+print.regtst'></span>

<h3>Description</h3>

<p>Computes discordancy, heterogeneity and goodness-of-fit measures
for regional frequency analysis.
These are the statistics <code class="reqn">D_i</code>, <code class="reqn">H</code>, and <code class="reqn">Z^{\rm DIST}</code>
defined respectively in sections 3.2.3, 4.3.3, and 5.2.3 of
Hosking and Wallis (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regtst(regdata, nsim=1000)

regtst.s(regdata, nsim=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regtst_+3A_regdata">regdata</code></td>
<td>

<p>Object of class <code><a href="#topic+regdata">regdata</a></code> containing the input data.
It should be a data frame, each of whose rows contains data for one site.
The first seven columns should contain respectively
the site name, record length and <code class="reqn">L</code>-moments
and <code class="reqn">L</code>-moment ratios, in the order
<code class="reqn">\ell_1</code> (mean),
<code class="reqn">t</code> (<code class="reqn">L</code>-CV),
<code class="reqn">t_3</code> (<code class="reqn">L</code>-skewness),
<code class="reqn">t_4</code> (<code class="reqn">L</code>-kurtosis),
and <code class="reqn">t_5</code>.
</p>
<p>Note that the fourth column should contain values of
the <code class="reqn">L</code>-CV <code class="reqn">t</code>, not the <code class="reqn">L</code>-scale <code class="reqn">\ell_2</code>!
</p>
<p>Function <code>regsamlmu</code>, with default settings
of its arguments, returns an object of class <code>"regdata"</code>.</p>
</td></tr>
<tr><td><code id="regtst_+3A_nsim">nsim</code></td>
<td>

<p>Number of simulations to use in the calculation of the
heterogeneity and goodness-of-fit measures.
</p>
<p>If less than 2, only the discordancy measure will be calculated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The discordancy measure <code class="reqn">D_i</code> indicates, for site <code class="reqn">i</code>,
the discordancy between the site's <code class="reqn">L</code>-moment ratios
and the (unweighted) regional average <code class="reqn">L</code>-moment ratios.
Large values might be used as a flag to indicate potential errors
in the data at the site.  &ldquo;Large&rdquo; might be 3 for regions with 15
or more sites, but less (exact values in list element <code>Dcrit</code>)
for smaller regions.
</p>
<p>Three heterogeneity measures are calculated, each based on
a different measure of between-site dispersion of <code class="reqn">L</code>-moment ratios:
[1] weighted standard deviation of <code class="reqn">L</code>-CVs;
[2] average of <code class="reqn">L</code>-CV/<code class="reqn">L</code>-skew distances;
[3] average of <code class="reqn">L</code>-skew/<code class="reqn">L</code>-kurtosis distances.
These dispersion measures are the quantities <code class="reqn">V</code>, <code class="reqn">V_2</code>,
and <code class="reqn">V_3</code> defined respectively in equations (4.4), (4.6), and (4.7)
of Hosking and Wallis (1997).
The heterogeneity measures are calculated from them as in
equation (4.5) of Hosking and Wallis (1997).
In practice <code>H[1]</code> is probably sufficient.  A value greater than
(say) 1.0 suggests that further subdivision of the region should
be considered as it might improve the accuracy of quantile estimates.
</p>
<p>Goodness of fit is evaluated for five candidate distributions:
generalized logistic,
generalized extreme value,
generalized normal (lognormal),
Pearson type III (3-parameter gamma), and
generalized Pareto.
In the output the distributions are referred to by 3-letter abbreviations,
respectively <code>glo</code>, <code>gev</code>, <code>gno</code>, <code>pe3</code>, and <code>gpa</code>.
If the region is homogeneous and data at different sites are
statistically independent, then if one of the distributions is
the true distribution for the region its goodness-of-fit measure
should have approximately a standard normal distribution.
Provided that the region is acceptably close to homogeneous,
the fit may be judged acceptable at the 10 per cent significance level
if the <code class="reqn">Z</code> value is less than 1.645 (i.e., <code>qnorm(0.95)</code>) in absolute value.
</p>
<p>Calculation of heterogeneity and goodness-of-fit measures
involves the sampling variability of <code class="reqn">L</code>-moment ratios
in a homogeneous region whose record lengths and
average <code class="reqn">L</code>-moment ratios match those of the data.
The sampling variability is estimated by Monte Carlo simulation
using <code>nsim</code> replications of the region.
Results will vary between invocations of <code>regtst</code>
with different seeds for the random-number generator.
</p>
<p>In the homogeneous region used in the simulations, the sites have a
kappa distribution, fitted to the regional average <code class="reqn">L</code>-moment ratios
of the data in <code>regdata</code>.  The kappa fit may fail if the regional average
<code class="reqn">L</code>-kurtosis is high relative to the regional average <code class="reqn">L</code>-skewness.
In this case a kappa distribution is fitted with shape parameter
<code class="reqn">h</code> constrained to be <code class="reqn">-1</code> (i.e., a generalized logistic distribution);
this gives the largest possible <code class="reqn">L</code>-kurtosis value for a kappa distribution
with given <code class="reqn">L</code>-skewness.
</p>
<p><code>regtst</code> and <code>regtst.s</code> are functionally identical.
<code>regtst</code> calls a Fortran routine internally and is faster,
typically by a factor of 3 or 4.
<code>regtst.s</code> is written almost entirely in the S language;
it is provided so that users can see how the calculations are done,
and can conveniently alter the code for their own purposes if necessary.
</p>


<h3>Value</h3>

<p>An object of class <code>"regtst"</code>, which is a list with elements as follows.
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>The input data, i.e. data frame <code>regdata</code>
after coercion to class <code>"regdata"</code> if necessary.</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>Number of simulations, i.e. the argument <code>nsim</code>.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>Vector containing the discordancy measures for each site.</p>
</td></tr>
<tr><td><code>Dcrit</code></td>
<td>

<p>Vector of length 2 containing critical values of the discordancy
measure corresponding to significance levels of 10 and 5 per cent
&mdash; except that the values never exceed 3 and 4 respectively.
See Hosking and Wallis (1997), section 3.2.4.</p>
</td></tr>
<tr><td><code>rmom</code></td>
<td>

<p>Vector of length 5 containing the regional weighted average
<code class="reqn">L</code>-moment ratios (weights proportional to record lengths).</p>
</td></tr>
<tr><td><code>rpara</code></td>
<td>

<p>Vector of length 4 containing the parameters of a kappa distribution
fitted to the regional weighted average <code class="reqn">L</code>-moment ratios.</p>
</td></tr>
<tr><td><code>vobs</code></td>
<td>

<p>Vector of length 3 containing the observed values of the three
measures of between-site dispersion of <code class="reqn">L</code>-moment ratios.</p>
</td></tr>
<tr><td><code>vbar</code></td>
<td>

<p>Vector of length 3 containing the mean of the simulated values
of the three dispersion measures.</p>
</td></tr>
<tr><td><code>vsd</code></td>
<td>

<p>Vector of length 3 containing the standard deviation of the
simulated values of the three dispersion measures.</p>
</td></tr>
<tr><td><code>H</code></td>
<td>

<p>Vector of length 3 containing the three measures of regional
heterogeneity.</p>
</td></tr>
<tr><td><code>para</code></td>
<td>

<p>List of length 6 containing the parameters of the five candidate
distributions and the Wakeby distribution (3-letter abbreviation
<code>"wak"</code>) fitted to the regional weighted average
<code class="reqn">L</code>-moment ratios.</p>
</td></tr>
<tr><td><code>t4fit</code></td>
<td>

<p>Vector of length 5 containing the <code class="reqn">L</code>-kurtosis of the
five candidate distributions fitted to the regional
weighted average <code class="reqn">L</code>-moment ratios.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>

<p>Vector of length 5 containing the goodness-of-fit measures
for each of the five candidate distributions.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Data frame <code>regdata</code> may have only six columns,
i.e. the fifth <code class="reqn">L</code>-moment ratio <code class="reqn">t_5</code> may be omitted.
In this case the return value will contain missing values for
<code>rmom[5]</code> and the elements of <code>para$wak</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>
<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on <code class="reqn">L</code>-moments</em>.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code>summary.regtst</code> for summaries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># An example from Hosking (1996).  Compare the output with
# the file 'cascades.out' in the LMOMENTS Fortran package at
# http://lib.stat.cmu.edu/lmoments/general (results will not
# be identical, because random-number generators are different).
summary(regtst(Cascades, nsim=500))

# Output from 'regsamlmu' can be fed straight into 'regtst'
regtst(regsamlmu(Maxwind))
</code></pre>

<hr>
<h2 id='sitequant'>Quantiles and quantile functions for individual sites in a region</h2><span id='topic+siteqfunc'></span><span id='topic+sitequant'></span>

<h3>Description</h3>

<p>Quantiles and quantile functions for individual sites in a region.
<code>sitequant</code> computes quantiles directly;
<code>siteqfunc</code> returns a function that will compute quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sitequant(f, rfd, sitenames, index, drop = TRUE)

siteqfunc(rfd, sitenames, index)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sitequant_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="sitequant_+3A_rfd">rfd</code></td>
<td>
<p>Object of class <code><a href="#topic+rfd">rfd</a></code>, containing the specification
of a regional frequency distribution.</p>
</td></tr>
<tr><td><code id="sitequant_+3A_sitenames">sitenames</code></td>
<td>
<p>Vector of site names.</p>
</td></tr>
<tr><td><code id="sitequant_+3A_index">index</code></td>
<td>
<p>Values of the site-specific scale factor (&ldquo;index flood&rdquo;)
for the sites.</p>
</td></tr>
<tr><td><code id="sitequant_+3A_drop">drop</code></td>
<td>
<p>Logical: if <code>TRUE</code> and there is only one site,
or one probability value, the value returned from <code>sitequant</code>
will be a vector rather than a matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>index</code> and <code>sitenames</code> are both present,
they must have the same length, and will be taken to refer to sites
whose names are the elements of <code>sitename</code> and whose index-flood values
are the elements of <code>index</code>.
</p>
<p>If <code>index</code> is present and <code>sitenames</code> is missing,
quantiles are computed for sites whose index-flood values
are the elements of <code>index</code>; if <code>index</code> has names, these
names will be used as the site names.
</p>
<p>If <code>sitenames</code> is present and <code>index</code> is missing,
then quantiles will be computed for a subset of the
sites in the region specified by <code>rfd</code>.
<code>sitenames</code> will be used to select sites from the vector <code>rfd$index</code>,
either by position or by name.
</p>
<p>If <code>sitenames</code> and <code>index</code> are both missing,
then quantiles will be computed for all of the
sites in the region specified by <code>rfd</code>.
</p>


<h3>Value</h3>

<p>For <code>sitequant</code>, a matrix whose rows contain quantiles
for a single site, for the probabilities specified in <code>f</code>.
If <code>drop</code> is <code>TRUE</code> and the matrix has only one row or column,
it will be returned as a vector.
</p>
<p>For <code>siteqfunc</code>, a function or a list of functions that each compute
quantiles for one site.
Each function takes a single argument, a vector of probabilities,
and returns a vector of quantiles.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>rfit &lt;- regfit(Cascades, "gno")   # Fit regional distribution

## Quantiles for:
# - sites in the Cascades data set, indexed by number
sitequant(c(0.9, 0.99, 0.999), rfit, sitenames=1:3)

# - sites in the Cascades data set, indexed by name
sitequant(c(0.9, 0.99, 0.999), rfit,
  sitenames=c("350304", "351433", "351862"))

# - other sites, with specified index floods
sitequant(c(0.9, 0.99, 0.999), rfit, index=c(80, 100))

# - other sites, with specified index floods and names
sitequant(c(0.9, 0.99, 0.999), rfit, index=c(80, 100),
  sitenames=c("Site 80", "Site 100"))

# - a single site, with drop=FALSE: result is a matrix
sitequant(c(0.9, 0.99, 0.999), rfit, sitenames=10, drop=FALSE)

# - a single site, with drop=TRUE (the default): result is a vector
sitequant(c(0.9, 0.99, 0.999), rfit, sitenames=10)

# Quantile function for site 10
qfunc10 &lt;- siteqfunc(rfit, site=10)

# Compute quantiles via the quantile function
qfunc10(c(0.9, 0.99, 0.999))

# Plot the quantile function
evplot(qfunc=qfunc10)

</code></pre>

<hr>
<h2 id='summary.regtst'>Summary of test statistics for regional frequency analysis</h2><span id='topic+summary.regtst'></span><span id='topic+print.summary.regtst'></span>

<h3>Description</h3>

<p><code>summary</code> method for an object of class <code>"regtst"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regtst'
summary(object,
  prob = c(0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 0.8, 0.9, 0.95, 0.98, 0.99, 0.999),
  conf = 0.90, decimals = c(4, 4, 2, 3), ...)

## S3 method for class 'summary.regtst'
print(x, decimals, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.regtst_+3A_object">object</code></td>
<td>

<p>An object of class <code>"regtst"</code>, usually the result of a call to
<code>regtst</code>.</p>
</td></tr>
<tr><td><code id="summary.regtst_+3A_x">x</code></td>
<td>

<p>An object of class <code>"summary.regtst"</code>, usually the result of a
call to <code>summary.regtst</code>.</p>
</td></tr>
<tr><td><code id="summary.regtst_+3A_prob">prob</code></td>
<td>

<p>Nonexceedance probabilities for which quantile estimates
should be printed.</p>
</td></tr>
<tr><td><code id="summary.regtst_+3A_conf">conf</code></td>
<td>

<p>Confidence level for printing parameter and quantile estimates.
These quantities will be printed only for distributions that
give an adequate fit at the specified confidence level.</p>
</td></tr>
<tr><td><code id="summary.regtst_+3A_decimals">decimals</code></td>
<td>

<p>Vector of length 4.  The four elements specify the number of
decimal places to be used when printing <code class="reqn">L</code>-moment ratios,
distribution parameters, test statistics,
and quantile estimates, respectively.</p>
</td></tr>
<tr><td><code id="summary.regtst_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The printed output corresponds closely to that produced by
function <code>REGTST</code> in the LMOMENTS Fortran package (Hosking, 1996).
</p>


<h3>Value</h3>

<p><code>summary.regtst</code> and <code>print.summary.regtst</code> each return,
invisibly, an object of class <code>"summary.regtst"</code>, which is a list
with elements as for class <code>"regtst"</code>, plus the following elements:
</p>
<table>
<tr><td><code>conf</code></td>
<td>

<p>Confidence level &mdash; the <code>conf</code> argument supplied to
<code>summary.regtst</code>.</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>

<p>Vector of nonexceedance probabilities &mdash; the <code>prob</code> argument
supplied to <code>summary.regtst</code>.</p>
</td></tr>
<tr><td><code>quant</code></td>
<td>

<p>Matrix with 6 rows and <code>length(prob)</code> columns, containing
quantile estimates for the five candidate distributions and the
Wakeby distribution.</p>
</td></tr>
<tr><td><code>decimals</code></td>
<td>

<p>Vector of length 4.  Number of decimals to be used when printing
an object of class <code>"summary.regtst"</code> if the <code>decimals</code>
argument of <code>print.summary.regtst</code> is not specified.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regtst">regtst</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># An example from Hosking (1996).  Compare the output with
# the file 'cascades.out' in the LMOMENTS Fortran package at
# http://lib.stat.cmu.edu/lmoments/general (results will not
# be identical, because random-number generators are different).
summary(regtst(Cascades, nsim=500))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
