<!DOCTYPE html><html><head><title>Help for package PROreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PROreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BB'>
<p>The Beta-Binomial Distribution</p></a></li>
<li><a href='#BBest'><p>Estimation of the parameters of a beta-binomial distribution</p></a></li>
<li><a href='#BBmm'>
<p>Beta-binomial mixed-effects model</p></a></li>
<li><a href='#BBreg'>
<p>Fit a beta-binomial logistic regression model</p></a></li>
<li><a href='#BI'>
<p>The Binomial distribution with optional Dispersion Parameter</p></a></li>
<li><a href='#BIest'>
<p>Estimation of the parameters of a binomial distribution with optional dispersion parameter.</p></a></li>
<li><a href='#EDpro'>
<p>Eating Disorders patient-reported outcome data.</p></a></li>
<li><a href='#HRQoLplot'>
<p>Spider plot of the dimensions of the Short Form-36 Health Survey</p></a></li>
<li><a href='#print.BBest'>
<p>Print a BBest class model.</p></a></li>
<li><a href='#print.BBmm'>
<p>Print a BBmm class model.</p></a></li>
<li><a href='#print.BBreg'>
<p>Print a BBreg class model.</p></a></li>
<li><a href='#print.summary.BBest'>
<p>Print a summary.BBest class model.</p></a></li>
<li><a href='#print.summary.BBmm'>
<p>Print a summary.BBmm class model.</p></a></li>
<li><a href='#print.summary.BBreg'>
<p>Print a summary.BBreg class model.</p></a></li>
<li><a href='#SF36rec'>
<p>Short Form-36 Health Survey recode</p></a></li>
<li><a href='#summary.BBest'><p>Summarizes a BBest class model.</p></a></li>
<li><a href='#summary.BBmm'>
<p>Summarizes a BBmm class model.</p></a></li>
<li><a href='#summary.BBreg'>
<p>Summarizes a BBreg class model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Patient Reported Outcomes Regression Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Josu Najera-Zuloaga &lt;josu.najera@ehu.eus&gt;, Dae-Jin Lee &lt;Dae-Jin.Lee@ie.edu&gt;, Inmaculada Arostegui &lt;inmaculada.arostegui@ehu.eus&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josu Najera-Zuloaga &lt;josu.najera@ehu.eus&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It offers a wide variety of techniques, such as graphics, recoding, or regression models, for a comprehensive analysis of patient-reported outcomes (PRO). Especially novel is the broad range of regression models based on the beta-binomial distribution useful for analyzing binomial data with over-dispersion in cross-sectional, longitudinal, or multidimensional response studies (see Najera-Zuloaga J., Lee D.-J. and Arostegui I. (2019) &lt;<a href="https://doi.org/10.1002%2Fbimj.201700251">doi:10.1002/bimj.201700251</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>fmsb, car, RColorBrewer, matrixcalc, rootSolve, numDeriv,
Matrix</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-13 11:16:55 UTC; jnajera001</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-13 12:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BB'>
The Beta-Binomial Distribution
</h2><span id='topic+dBB'></span><span id='topic+rBB'></span>

<h3>Description</h3>

<p>Density and random generation for the beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBB(m,p,phi)
rBB(k,m,p,phi)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BB_+3A_k">k</code></td>
<td>
<p> number of simulations.</p>
</td></tr>
<tr><td><code id="BB_+3A_m">m</code></td>
<td>
<p> maximum socre number in each beta-binomial observation..</p>
</td></tr>
<tr><td><code id="BB_+3A_p">p</code></td>
<td>
<p> probability parameter of the beta-binomial distribution.</p>
</td></tr>
<tr><td><code id="BB_+3A_phi">phi</code></td>
<td>
<p> dispersion parameter of the beta-binomial distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta-binomial distribution consists of a finite sum of Bernoulli dependent variables whose probability parameter is random and follows a beta distribution. Assume that we have <code class="reqn">y_j</code> a set of variables, <code class="reqn">j=1,...,m</code>, with m integer, that conditioned on a random variable <code class="reqn">u</code>, are independent and follow a Bernoulli distribution with probability parameter <code class="reqn">u</code>. On the other hand, the random variable <code class="reqn">u</code> follows a beta distribution with parameter <code class="reqn">p/phi</code> and <code class="reqn">(1-p)/phi</code>. Namely,
</p>
<p style="text-align: center;"><code class="reqn">y_j \sim Ber(u), u \sim Beta(p/phi,(1-p)/phi),</code>
</p>

<p>where <code class="reqn">0&lt;p&lt;1</code> and <code class="reqn">phi&gt;0</code>. The first and second order marginal moments of this distribution are defined as
</p>
<p style="text-align: center;"><code class="reqn">E[y_j]=p, Var[y_j]=p(1-p),</code>
</p>

<p>and correlation between observations is defined as
</p>
<p style="text-align: center;"><code class="reqn">Corr[y_j,y_k]=phi/(1+phi),</code>
</p>

<p>where <code class="reqn">j,k=1,...,m</code> are different. Consequently, <code class="reqn">phi</code> can be considered as a dispersion parameter.
</p>
<p>If we sum up all the variables we will define a new variable which follows a new distribution that is called beta-binomial distribution, and it is defined as follows. The variable <code class="reqn">y</code> follows a beta-binomial distribution with parameters <code class="reqn">m</code>, <code class="reqn">p</code> and <code class="reqn">phi</code> if
</p>
<p style="text-align: center;"><code class="reqn">y|u \sim Bin(m,u), u\sim Beta(p/phi,(1-p)/phi).</code>
</p>



<h3>Value</h3>

<p><code>dBB</code> gives the density of a beta-binomial distribution with the defined <code>m</code>, <code>p</code> and <code>phi</code> parameters.
</p>
<p><code>rBB</code> generates <code>k</code> random observations based on a beta-binomial distribution with the defined <code>m</code>, <code>p</code> and <code>phi</code> parameters.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The
beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>See Also</h3>

<p>The <code><a href="stats.html#topic+rbeta">rbeta</a></code> and <code><a href="stats.html#topic+rbinom">rbinom</a></code> functions of package <code>stats</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12)
# We define
m &lt;- 10     
p &lt;- 0.4    
phi &lt;- 1.8  

# We perform k beta-binomial simulations for those parameters.
k &lt;- 100
bb &lt;- rBB(k,m,p,phi)
bb
dd &lt;- dBB(m,p,phi)

# We are going to plot the histogram of the created variable,
# and using dBB() function we are going to fit the distribution:
hist(bb,col="grey",breaks=seq(-0.5,m+0.5,1),probability=TRUE,
  main="Histogram",xlab="Beta-binomial random variable")
lines(seq(0,m),dd,col="red",lwd=4)

</code></pre>

<hr>
<h2 id='BBest'>Estimation of the parameters of a beta-binomial distribution</h2><span id='topic+BBest'></span>

<h3>Description</h3>

<p>This function performs the estimation of the parameters of a beta-binomial distribution for the given data and maximum score number in each observation. 
</p>
<p>There are two different approaches available for performing the estimation of the parameters: (i) Method of moments, and, (ii) maximum likelihood approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BBest(y,m,method="MM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BBest_+3A_y">y</code></td>
<td>
<p> response variable which folloes a beta-binomial distribution.</p>
</td></tr>
<tr><td><code id="BBest_+3A_m">m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code id="BBest_+3A_method">method</code></td>
<td>
<p> the method used for performing the estimation of the probability and dispersion parameters of a beta-binomial distribution, &quot;MM&quot; for the method of moments and &quot;MLE&quot; for maximum likelihood estimation. Default &quot;MM&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>BBest</code> function performs estimations in the parameters of a beta-binomial distribution for the given data. The estimations can be performed using two different approaches, the methods of moments and the maximum likelihood estimation approach.
</p>
<p>The density function of a given observation <code class="reqn">y</code> that follows a beta-binomial distribution with paramters <code class="reqn">m</code>, <code class="reqn">p</code> and <code class="reqn">phi</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">f(y)=[\Gamma(1/phi)*\Gamma(p/phi+m)*\Gamma((1-p)/phi+m)]/[\Gamma(1/phi+m)*\Gamma(p/phi)*\Gamma((1-p)/phi)].</code>
</p>

<p>The first and second order moments are defined as
</p>
<p style="text-align: center;"><code class="reqn">E[y]=mp</code>
</p>

<p style="text-align: center;"><code class="reqn">Var[y]=mp(1-p)[1+(n-1)phi/(1+phi)].</code>
</p>

<p>Hence, if <code class="reqn">y=(y_1,...,y_n)</code> is the given data, we can conclude the method of moments from the previous as
</p>
<p style="text-align: center;"><code class="reqn">p=E/m,</code>
</p>

<p style="text-align: center;"><code class="reqn">phi=[V-mp(1-p)]/[mp(1-p)m-V],</code>
</p>

<p>where <code class="reqn">E</code> is the sample mean and <code class="reqn">V</code> is the sample variance.
</p>
<p>On the other hand, the maximum likelihood estimation of both parameters consits of solving the derivative of the log-likelihood defined by the density function with respect to each parameter and equaling them to zero. An iterative algorithm is needed for both parameter estimation as the score equations the parameters depend each other.
</p>
<p>The variance of the estimation of the probability parameter of the beta-binomial distribution for the given data set is computed by the inverse of the Fisher information, i.e., the inverse of the negative second derivate of the log-likelihodd remplacing <code class="reqn">p</code> by its estimation.
</p>


<h3>Value</h3>

<p><code>BBest</code> returns an object of class &quot;<code>BBest</code>&quot;.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.BBest</code>) can be used to obtain or print a summary of the results.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p> estimated probability parameter of the beta-binomial distribution.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p> estimated dispersion parameter of the beta-binomial distribution.</p>
</td></tr>
<tr><td><code>pVar</code></td>
<td>
<p> variance of the estimation of the probability parameter <code>p</code>.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> estimation of the logarithm of the dispersion parameter <code>phi</code>.</p>
</td></tr>
<tr><td><code>psiVar</code></td>
<td>
<p> variance of the estimation of the logarithm of the dispersion parameter <code>psi</code>.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the response variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the used approach for performing the estimations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We simulate 1000 observations of a beta-binomial distribution
# for the fixed paramters.
m &lt;- 10
k &lt;- 1000
p &lt;- 0.7
phi &lt;- 1.6

set.seed(5)
y &lt;- rBB(k,m,p,phi)

# Performing the estimation of the parameters

# Method of moments:
MM &lt;- BBest(y,m)
MM

# Maximum likelihood approach
MLE &lt;- BBest(y,m,method="MLE")
MLE

</code></pre>

<hr>
<h2 id='BBmm'>
Beta-binomial mixed-effects model
</h2><span id='topic+BBmm'></span>

<h3>Description</h3>

<p><code>BBmm</code> function performs beta-binomial mixed-effects models, i.e., it allows the inclusion of gaussian random effects in the linear predictor of a logistic beta-binomial regression model.
</p>
<p>The structure of the random part of the model can be expecified by two different ways: (i) determining the <code>random.formula</code> argument, or (ii) especifying the model matrix of the random effects, <code>Z</code>, and determining the number of random effects in each random component, <code>nRandComp</code>.
</p>
<p>For the estimation of the parameters the joint log-likelihood can be optimized by means of two different approaches: (i) BB-Delta, specific Delta algorithm developed for beta-binomial mixed-effect regression models, and (ii) usual Newton-Raphson method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BBmm(fixed.formula,X,y,random.formula,Z=NULL,nRandComp=NULL,m,data,
      method="BB-Delta",maxiter=50,show=FALSE,nDim=1,tolerance=10^(-6))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BBmm_+3A_fixed.formula">fixed.formula</code></td>
<td>
<p> an object of class <code>"formula"</code> (or one that can be coerced to that class): a symbolic description of the fixed part of the model to be fitted. It must be specified in cases where the model matrix of the fixed effects <code>X</code> and the outcome variable <code>y</code> are not specified.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_x">X</code></td>
<td>
<p> a matrix class object containing the covariate structure of the fixed part of the model to be fitted. If the <code>fixed.formula</code> argument is specified this argument should not be defined, as we will be specifying twice the fixed structure of the model.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_y">y</code></td>
<td>
<p> a vector containing the outcome variable(s). If joint analysis is expected, the outcome variables must be listed one after another in a vector.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_random.formula">random.formula</code></td>
<td>
<p> an object of class <code>"formula"</code> (or one that can be coerced to that class): a symbolic description of the random part of the model to be fitted. It must be specified in cases where the model matrix of the random effects <code>Z</code> is not determined.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_z">Z</code></td>
<td>
<p> the design matrix of the random effects. If the <code>random.formula</code> argument is specified this argument should not be specified, as we will be specifying twice the random structure of the model.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_nrandcomp">nRandComp</code></td>
<td>
<p> the number of random effects in each random component of the model. It must be especified as a vector, where the 'i'th value must correspond with the number of random effects of the 'i'th random component. It must be only determined when we specify the random structure of the model by the model matrix of the random effects, <code>Z</code>.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_m">m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_data">data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula).</p>
</td></tr>
<tr><td><code id="BBmm_+3A_method">method</code></td>
<td>
<p> the methodology for performing the estimation of the parameters. Options &quot;BB-Delta&quot; or &quot;NR&quot;. Default &quot;BB-Delta&quot;.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_maxiter">maxiter</code></td>
<td>
<p> the maximum number of iterations in the parameters estimation algorithm. Default 50.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_show">show</code></td>
<td>
<p> logical parameter. If <code>TRUE</code>, the step by step optimization process will be shown in the screen. <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_ndim">nDim</code></td>
<td>
<p> number of response outcome variables involved in the multidimensional analysis. <code>nDim=1</code> by default.</p>
</td></tr>
<tr><td><code id="BBmm_+3A_tolerance">tolerance</code></td>
<td>
<p> tolerance of the estimated linear predictor in the estimation process. <code>tolerance=10^(-6)</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>BBmm</code> function performs beta-binomial mixed-effects regression models. It extends the beta-binomial regression model including gaussian random effects in the linear predictor. The model is defined as, conditional on some gaussian random effects <code class="reqn">u</code>, the response variable <code class="reqn">y</code> follows a beta-binomial distribution with parameters <code class="reqn">m</code>, <code class="reqn">p</code> and <code class="reqn">\phi</code>,
</p>
<p style="text-align: center;"><code class="reqn">y|u \sim BB(m,p,\phi), \text{and } u \sim N(0,D)</code>
</p>

<p>where the regression model is defined as,
</p>
<p style="text-align: center;"><code class="reqn">\log(p/(1-p))=X*\beta+Z*u</code>
</p>

<p>and <code class="reqn">D</code> is determined by some dispersion parameters icluded in the parameter vector <code class="reqn">\theta</code>.
</p>
<p>The estimation of the regression parameters <code class="reqn">\beta</code> and the prediction of the random effects <code class="reqn">u</code> is done via the extended likelihood, where the marginal likelihood is approximated to the h-likelihood by a first order Laplace approximation,
</p>
<p style="text-align: center;"><code class="reqn">h=f(y|\beta,u,\theta)+f(u|\theta).</code>
</p>

<p>The previous formula do not have a closed form and numerical methods are needed for the estimation precedure. Two approches are available in the function in order to perform the fixed and random effects estimation: (i) A special case of the Delta algorithm developed for beta-binomial mixed-effects model estimations, and (ii) the general Newton-Raphson algorithm available in R-package <code>rootSolve</code>.
</p>
<p>On the other hand, the estimation of dispersion parameters by the h-likelihood can be bias due to the previous estimation of the regression parameters. Consequenlty, a penalization of the h-likelihood must be performed to get unbiased estimations of the dispersion parameters. Lee and Nelder (1996) proposed the adjusted profile h-likelihood, where the following penalization is applied,
</p>
<p style="text-align: center;"><code class="reqn">h(\theta)=h+(1/2)*\log[det(2\pi H^{-1})],</code>
</p>

<p>being <code class="reqn">H</code> the Hessian matrix of the model, replacing the terms <code class="reqn">\beta</code> and <code class="reqn">u</code> involved in the previous formula with their estimates.
</p>
<p>The method iterates between both estimation processes until convergence is reached based on the pre-established tolerance of the linear predictor.
</p>


<h3>Value</h3>

<p><code>BBmm</code> returns an object of class &quot;<code>BBmm</code>&quot;.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.BBmm</code>) can be used to obtain or print a summary of the results..
</p>
<table>
<tr><td><code>fixed.coef</code></td>
<td>
<p> estimated value of the fixed coefficients of the regression.</p>
</td></tr>
<tr><td><code>fixed.vcov</code></td>
<td>
<p> variance and covariance matrix of the estimated fixed coefficients of the regression.</p>
</td></tr>
<tr><td><code>random.coef</code></td>
<td>
<p> predicted random effects of the regression.</p>
</td></tr>
<tr><td><code>sigma.coef</code></td>
<td>
<p> estimated value of the random effects variance parameters.</p>
</td></tr>
<tr><td><code>sigma.var</code></td>
<td>
<p> variance of the estimated value of the random effects variance parameters.</p>
</td></tr>
<tr><td><code>phi.coef</code></td>
<td>
<p> estimated value of the dispersion parameter of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>psi.coef</code></td>
<td>
<p> estimated value of the logrithm of the dispersion parameter of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>psi.var</code></td>
<td>
<p> variance of the estimation of the logarithm of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted mean values of the probability parameter of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> convergence of the methodology. If the method has converged it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p> deviance of the model.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> degrees of freedom of the model.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p> null-deviance, deviance of the null model. The null model will only include an intercept as the estimation of the probability parameter.</p>
</td></tr>
<tr><td><code>null.df</code></td>
<td>
<p> degrees of freedom of the null model.</p>
</td></tr>
<tr><td><code>nRand</code></td>
<td>
<p> number of random effects.</p>
</td></tr>
<tr><td><code>nComp</code></td>
<td>
<p> number of random components.</p>
</td></tr>
<tr><td><code>nRandComp</code></td>
<td>
<p> number of random effects in each random component of the model.</p>
</td></tr>
<tr><td><code>namesRand</code></td>
<td>
<p> names of the random components.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> number of iterations in the estimation method.</p>
</td></tr>
<tr><td><code>nObs</code></td>
<td>
<p> number of observations in the data.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> dependent response variable in the model.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p> model matrix of the fixed effects.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p> model matrix of the random effects.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p> variance and covariance matrix of the random effects.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the response dependent variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p> the formula supplied.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Najera-Zuloaga, J.; Lee, D.-J.; Esteban, C. &amp; Arostegui, I. (2023): Multidimensional beta-binomial regression model: a joint
analysis of patient-reported outcomes. <em>Statistical Modelling</em>, 0(0).
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui, I. (2019): A beta-binomial mixed effects model approach for analysing longitudinal discrete and bounded outcomes. <em>Biometrical Journal</em>, 61(3), 600-615.
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2018): Comparison of beta-binomial regression model approaches to analyze health related quality of life data. <em>Statistical Methods in Medical Research</em>, 27(10), 2989-3009.
</p>
<p>Lee Y. &amp; Nelder J. A. (1996): Hierarchical generalized linear models, <em>Journal of the Royal Statistical
Society. Series B</em>, <b>58</b>, 619-678
</p>


<h3>See Also</h3>

<p>The <code>multiroot</code> and <code><a href="stats.html#topic+uniroot">uniroot</a></code> functions of the R-package <code>rootSolve</code> for the general Newton-Raphson algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(7)

# Defining the parameters
k &lt;- 100
m &lt;- 10
phi &lt;- 0.5
beta &lt;- c(1.5,-1.1)
sigma &lt;- 0.5

# Simulating the covariate and random effects
x &lt;- runif(k,0,10)
X &lt;- model.matrix(~x)
z &lt;- as.factor(rBI(k,4,0.5,2))
Z &lt;- model.matrix(~z-1)
u &lt;- rnorm(5,0,sigma)


# The linear predictor and simulated response variable
eta &lt;- beta[1]+beta[2]*x+crossprod(t(Z),u)
p &lt;- 1/(1+exp(-eta))
y &lt;- rBB(k,m,p,phi)
dat &lt;- data.frame(cbind(y,x,z))
dat$z &lt;- as.factor(dat$z)

# Apply the model
model &lt;- BBmm(fixed.formula = y~x,random.formula = ~z,m=m,data=dat)
model

#---------#

# Multidimensional regression with 2 dimensions

set.seed(5)
nId &lt;- 25

# Simulation

m &lt;- 10
beta1 &lt;- c(1,-0.5)
beta2 &lt;- c(-1,0.5)
beta &lt;- cbind(beta1,beta2)

x1 &lt;- rnorm(nId, 1,2)
X1 &lt;- model.matrix(~x1)
x2 &lt;- rnorm(nId, -1,1)
X2 &lt;- model.matrix(~x2)

sigma &lt;- 0.6
u &lt;- rnorm(nId,0,sigma)

eta1 &lt;- beta1[1]+x1*beta1[2]+u
p1 &lt;- 1/(1+exp(-eta1))
eta2 &lt;- beta2[1]+x2*beta2[2]+u
p2 &lt;- 1/(1+exp(-eta2))

phi1 &lt;- 0.3
phi2 &lt;- 1
phi &lt;- c(phi1,phi2)

y1 &lt;- rBB(nId,m,p1,phi1)
y2 &lt;- rBB(nId,m,p2,phi2)
y &lt;- c(y1,y2)

# Define matrices

X &lt;- Matrix::bdiag(X1,X2)
X &lt;- as.matrix(X)
Z. &lt;- diag(nId)
Z &lt;- kronecker(rbind(1,1),Z.)

# Fit the model

Model.multi &lt;- BBmm(X=X,y=y,Z=Z,nRandComp = nId,m=m,nDim=2)
Model.multi

</code></pre>

<hr>
<h2 id='BBreg'>
Fit a beta-binomial logistic regression model
</h2><span id='topic+BBreg'></span>

<h3>Description</h3>

<p><code>BBreg</code> function fits a beta-binomial logistic regression model, i.e., it links the probability parameter of a beta-binomial distribution with the given covariates by means of a logistic link function. The estimation of the parameters in the model is done via maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  BBreg(formula,m,data,maxiter=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BBreg_+3A_formula">formula</code></td>
<td>
<p> an object of class <code>"formula"</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="BBreg_+3A_m">m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code id="BBreg_+3A_data">data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula).</p>
</td></tr>
<tr><td><code id="BBreg_+3A_maxiter">maxiter</code></td>
<td>
<p> the maximum number of iterations in the estimation process. Default 100.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two different ways of defining a regression model based on the beta-binomial distribution: (i) the marginal regression approach, (ii) hierarchical generalized linear model approach. <cite>Najera-Zuloaga et al. (2017)</cite> proved that the first approach is more adequate when the interest consists of the interpretation of the regression coefficients. Consequenlty, this function is based on the first approach, i.e., the marginal regression approach.
</p>
<p>Once the marginal density function of the beta-binomial distribution is explicity calculated, we connect the probability parameter with the given covariates by means of a logistic link function:
</p>
<p style="text-align: center;"><code class="reqn">logit(p)=log(p/(1-p))=X*beta</code>
</p>

<p>where <code class="reqn">X</code> a model matrix composed by the given covariates and <code class="reqn">beta</code> are the regression coefficients of the model.
</p>
<p>Remplacing the previous linear predictor in the marginal density function of the beta-binomial distribution, we can derive maximum likelihood estimations of both regression and dispersion parameters. Forcina and Franconi (1988) presented an estimation algorithm based on the Newton-Raphson approach. This function performs the estimation of the parameters following the presented methodology. 
</p>


<h3>Value</h3>

<p><code>BBreg</code> returns an object of class &quot;<code>BBreg</code>&quot;.
</p>
<p>The function <code>summary</code> (i.e., <code>summary.BBreg</code>) can be used to obtain or print a summary of the results.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> the estimated value of the regression coefficients.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the variance-covariance matrix of the estimated coefficients of the regression.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p> the estimation of the dispersion parameter of the beta-binomial distribution.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p> the estimation of the logarithm of the dispersion parameter of the beta-binomial distribution. </p>
</td></tr>
<tr><td><code>psi.var</code></td>
<td>
<p> the variance of the estimated logarithm of the dispersion parameter of the beta-binomial distribution.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> convergence of the methodology. If the method has converged it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted mean values of the model.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p> the deviance of the model.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> degrees of freedom of the model.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p> null-deviance, the deviance for the null model. The null model will only include an intercept as the estimation of the probability parameter.</p>
</td></tr>
<tr><td><code>null.df</code></td>
<td>
<p> the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> number of iterations in the estimation process.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p> the model matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> the dependent response variable in the model.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the response beta-binomial variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>nObs</code></td>
<td>
<p> number of observations.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p> the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p> the formula supplied.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Forcina A. &amp; Franconi L. (1988): Regression analysis with Beta-Binomial distribution, <em>Revista di Statistica Applicata</em>, <b>21</b>, 7-12
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We simulate a covariate, fix the paramters of the beta-binomial 
# distribution and simulate a response variable.

# Then we apply the model, and try to get the same values.
set.seed(18)
k &lt;- 1000
m &lt;- 10
x &lt;- rnorm(k,5,3)

beta &lt;- c(-10,2)
p &lt;- 1/(1+exp(-(beta[1]+beta[2]*x)))
phi &lt;- 1.2

y &lt;- rBB(k,m,p,phi)

model &lt;- BBreg(y~x,m)
model
</code></pre>

<hr>
<h2 id='BI'>
The Binomial distribution with optional Dispersion Parameter
</h2><span id='topic+dBI'></span><span id='topic+rBI'></span>

<h3>Description</h3>

<p>Density and random generation for the binomial distribution with optional dispersion parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBI(m,p,phi)
rBI(k,m,p,phi)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BI_+3A_k">k</code></td>
<td>
<p> number of simulations.</p>
</td></tr>
<tr><td><code id="BI_+3A_m">m</code></td>
<td>
<p> number of trials in each binomial observation.</p>
</td></tr>
<tr><td><code id="BI_+3A_p">p</code></td>
<td>
<p> probability parameter of the binomial distribution.</p>
</td></tr>
<tr><td><code id="BI_+3A_phi">phi</code></td>
<td>
<p> dispersion parameter of the binomial distribution. If <code>phi</code>=1, the binomial distribution without dispersion parameter will be considered. Default 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The binomial distribution belongs to the exponential family of distributions. Consequenlty, although the usual binomial distribution only consists of two paramters, an additional dispersion parameter can be included. The inclusion of a dispersion parameter softens the relationship between the expectation and variance that the binomial distribution keeps, i.e. the model allows overdispersion to be included,
</p>
<p style="text-align: center;"><code class="reqn">E[y]=mp, Var[y]=phi*mp(1-p).</code>
</p>

<p>The density function of the binomial distribution with dispersion parameter is based on the exponential family approach and it is defined as
</p>
<p style="text-align: center;"><code class="reqn">f(y)=exp\{[y*log(p/(1-p))+m*log(1-p)]/phi+c(y,phi)\},</code>
</p>

<p>where <code class="reqn">c()</code> is a function that it is approximated with the deviance of the model by quadratic approximations of the log-likelihood function.
</p>


<h3>Value</h3>

<p><code>dBI</code> gives the density of the binomial distribution for those <code>m</code>, <code>p</code> and <code>phi</code> parameters.
</p>
<p><code>rBI</code> generates <code>k</code> random observations based on a binomial distribution for those <code>m</code>, <code>p</code> and <code>phi</code> parameters.</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Pawitan Y. (2001): <em>In All Likelihood: Statistical Modelling and Inference Using Likelihood</em>. Oxford University Press
</p>


<h3>See Also</h3>

<p>The <code><a href="stats.html#topic+rbinom">rbinom</a></code> functions of package <code>stats</code>. This function performs simulations based on a binomial distribution without dispersion parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k &lt;- 1000
m &lt;- 10
p &lt;- 0.765
phi &lt;- 4.35

#simulating
y &lt;- rBI(k,m,p,phi)
y

#density function
d &lt;- dBI(m,p,phi)
d

#plot the simulated variable and fit the density
hist(y,col="lightgrey")
lines(seq(0,m),k*d,col="blue",lwd=2)
</code></pre>

<hr>
<h2 id='BIest'>
Estimation of the parameters of a binomial distribution with optional dispersion parameter.
</h2><span id='topic+BIest'></span>

<h3>Description</h3>

<p><code>BIest</code> function estimates the probability parameter of a binomial distribution for the given data and number of trials. It is possible to include a dispersion parameter in the binomial distribution and get the estimation by the method of moments or maximum quasi-likelihood approach. This function also returns the standard deviation of the estimated probability parameter and the upper and lower bounds of the 95% confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIest(y,m,disp=FALSE,method="MM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIest_+3A_y">y</code></td>
<td>
<p> response variable wich follows a binomial distribution.</p>
</td></tr>
<tr><td><code id="BIest_+3A_m">m</code></td>
<td>
<p> number of trials in each binomial observation.</p>
</td></tr>
<tr><td><code id="BIest_+3A_disp">disp</code></td>
<td>
<p> dispersion parameter of the binomial distribution. If <code>phi</code>=FALSE, then the binomial distribution without dispersion parameter will be considered for estimation. Default FALSE.</p>
</td></tr>
<tr><td><code id="BIest_+3A_method">method</code></td>
<td>
<p> the method used for estimating the parameters, &quot;MM&quot; for the method of moments and &quot;MLE&quot; for maximum quasi-likelihood. Default &quot;MM&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the estimation of the parameters involved in a binomial distribution for a given data.
</p>
<p>The estimation of the probability parameter is done by either maximum likelihood approach or method of moments due to the fact that both approaches give the same estimation,
</p>
<p style="text-align: center;"><code class="reqn">p=sum(y)/(m*n),</code>
</p>

<p>where <code class="reqn">m</code> is the number of trials and <code class="reqn">n</code> is the number of observations. 
</p>
<p>If the dispersion parameter is included in the model, <code>BIest</code> function performs its estimation by the method of moments or maximum quasi-likelihood methodology. The method of moments is based on the variance equation of a binomial distribution with dispersion parameter
</p>
<p style="text-align: center;"><code class="reqn">Var[y]=phi*mp(1-p).</code>
</p>

<p>The maximum quasi-likelihood approach is based on the quadratic approximation of the log-likelihood function of a binomial distribution with dispersion parameter, where the unknown term involving <code class="reqn">phi</code> is estimated with the deviance of the model.
</p>
<p>The standard deviation of the estimated probability parameter is calculated by the Fisher information, i.e., the negative of the second derivative of the log-likelihood (log-quasi-likelihood) function.</p>


<h3>Value</h3>

<p><code>BIest</code> returns an object of class &quot;<code>BIest</code>&quot;.
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p> estimation of the probability parameter. Both estimating approaches, the method of moments and the maximum likelihood estimation, perform the same estimation.</p>
</td></tr>
<tr><td><code>pVar</code></td>
<td>
<p> the variance of the estimated probability parameter.</p>
</td></tr>
<tr><td><code>pIC.low</code></td>
<td>
<p> the lower bound of the 95% confidence interval of the estimated probability parameter.</p>
</td></tr>
<tr><td><code>pIC.up</code></td>
<td>
<p> the upper bound of the 95% confidence interval of the estimated probability parameter.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p> if the <code>disp</code> option is TRUE, it returns the estimated value of the dispersion parameter. Default FALSE.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> number of trials in each binomial observation.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the data is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> the used methodology for performing the estimation of the parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Pawitan Y. (2001): <em>In All Likelihood: Statistical Modelling and Inference Using Likelihood</em>, Oxford University Press</p>


<h3>See Also</h3>

<p>The <code><a href="#topic+rBI">rBI</a></code> and <code><a href="#topic+dBI">dBI</a></code> functions of package <code>HRQoL</code>. The functions perform simulations and estimate the density of a binomial distribution with optional dispersion parameter for a given set of parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(9)
# We simulate the binomial data with some fixed parameters and
# then try to reach the same estimations.
m &lt;- 10   
k &lt;- 100
p &lt;- 0.654
y &lt;- rBI(k,m,p) #Simulations

# without dispersion parameter
BIest(y,m)

# with dispersion parameter
# estimation by method of moments.
BIest(y,m,disp=TRUE,method="MM")
# estimation by maximum quasi-likelihood.
BIest(y,m,disp=TRUE,method="MLE")
</code></pre>

<hr>
<h2 id='EDpro'>
Eating Disorders patient-reported outcome data.
</h2><span id='topic+EDpro'></span><span id='topic+EDpro'></span>

<h3>Description</h3>

<p>A prospective study of patients diagnosed with an eating disorder who were followed up for two years in the Eating Disorders Outpatient Clinic of the Psychiatric Service at Galdakao Hospital in Bizkaia, Basque Country.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EDpro)</code></pre>


<h3>Format</h3>

<p>The <code>EDpro</code> data frame has 525 rows and 18 columns. The variables included in the data frame are the following:
</p>
<p>-id: Patient identifier.
</p>
<p>-visit: Visit number.
</p>
<p>-bmi: Body Mass Index.
</p>
<p>age: Age.
</p>
<p>-duration: Duration of the illness in years.
</p>
<p>-diagnosis: Diagnosis of the eating disorder (1: Anorexia Nervosa, 2: Bulimic Anorexia, 3: Bulimia Nervosa/Binge Eating).
</p>
<p>-severity: Severity of the disease, using the Eating Attitudes Test (1: Mild, 2: Moderate, 3: Severe).
</p>
<p>-anxiety: Level of anxiety using the Hospital Anxiety and Depression Scale (0: No, 1: Yes).
</p>
<p>-depression: Level of depression using the Hospital Anxiety and Depression Scale (0: No, 1: Yes).
</p>
<p>-pf: Physical Function dimension measured by the SF-36 questionnaire.
</p>
<p>-rp: Role Physical dimension measured by the SF-36 questionnaire.
</p>
<p>-bp: Body Pain dimension measured by the SF-36 questionnaire.
</p>
<p>-gh: General Health dimension measured by the SF-36 questionnaire.
</p>
<p>-vt: Vitality dimension measured by the SF-36 questionnaire.
</p>
<p>-sf: Social Functioning dimension measured by the SF-36 questionnaire.
</p>
<p>-re: Role Emotional dimension measured by the SF-36 questionnaire.
</p>
<p>-mh: Mental Health dimension measured by the SF-36 questionnaire.
</p>
<p>-time: Years elapsed since the beginning of the study.
</p>


<h3>Details</h3>

<p>All consecutive patients seen at the Eating Disorders Outpatient Clinic of the Psychiatric Service at Galdakao Hospital between October 1996 and October 1997 were eligible for the study. Patients were included if they were ambulatory; had received a diagnosis of anorexia nervosa or bulimia nervosa based on criteria in the Diagnostic and Statistical Manual of Mental Disorders, 4th edition (DSM-IV); and were between the ages of 14 and 65 years.
</p>
<p>Throughout the 2-year study period, each of the 193 patient received a psychopharmacologic and psychotherapeutic treatment program consisting of cognitive-behavioural treatment; nutritional orientation and counselling; psychoeducation; motivationaltherapy; social skills training; and therapy to modify distorted perception of body image. These interventions were adjusted to each patient's needs by a multidisciplinary team.
</p>
<p>At most, 3 measurements were obtained from each of the 193 patients: at baseline, at one year, and at two years from the start of the study. Clinical measurements and Helath-Related Quality of Life (HQRoL) data were recorded at each visit using the Short Form-36 (SF-36) and the Hospital Anxiety and Depression (HAD) Scale helath questionnaires.
</p>
<p>More information about the study can be found in Padierna et al. (2002) and Arostegui et al. (2007).</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2007): Analysis of short-form-36 (SF-36): The
beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342.
</p>
<p>Padierna A., Quintana J.M., Arostegui I., Gonzalez N. &amp; Horcajo M.J.(2002): Changes in health related quality of life among patients treated for eating disorders, <em>Quality of Life Research</em>, <b>11</b>, 545-552.
</p>

<hr>
<h2 id='HRQoLplot'>
Spider plot of the dimensions of the Short Form-36 Health Survey
</h2><span id='topic+HRQoLplot'></span>

<h3>Description</h3>

<p>This function creates a spider plot with the 8 health realted quality of life dimensions provided by the Short Form-36 Health Survey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HRQoLplot(data,legend=FALSE,title="Short Form-36 Health Survey",
  dimlabel.cex=NULL,legend.cex=1,linewidth=3,title.cex=1,lty=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HRQoLplot_+3A_data">data</code></td>
<td>
<p> a data frame with each column relative to the observations of each SF-36 dimension. The columns of the data frame must be introduced in the following order:
</p>

<ol>
<li><p> column -&gt; Physical Functioning
</p>
</li>
<li><p> column -&gt; Role Physical
</p>
</li>
<li><p> column -&gt; Body Pain
</p>
</li>
<li><p> column -&gt; General Health
</p>
</li>
<li><p> column -&gt; Vitality
</p>
</li>
<li><p> column -&gt; Social Functioning
</p>
</li>
<li><p> column -&gt; Role Emotional
</p>
</li>
<li><p> column -&gt; Mental Health
</p>
</li></ol>

</td></tr>
<tr><td><code id="HRQoLplot_+3A_legend">legend</code></td>
<td>
<p> logical parameter, if TRUE the legend with the name of the rows of the data will appear. Default FALSE.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_title">title</code></td>
<td>
<p> the title of the plot. Default &quot;Short Form-36 Health Survey&quot;.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_dimlabel.cex">dimlabel.cex</code></td>
<td>
<p> font size magnification for the labels of the dimension in the plot. If NULL, the font size is fixed at text()'s default. Default NULL.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_legend.cex">legend.cex</code></td>
<td>
<p> font size of legend text(). Default 1.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_linewidth">linewidth</code></td>
<td>
<p> the width of the lines of the plot. Default 3.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_title.cex">title.cex</code></td>
<td>
<p> the font size of the title. Default 1.</p>
</td></tr>
<tr><td><code id="HRQoLplot_+3A_lty">lty</code></td>
<td>
<p> the line type of the plot and the legend. Default 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Short Form-36 Health Survey is a commonly used technique to measure the Health Related Quality of Life (HRQoL) in chronich diseases. It was developed within the Medical Outcomes Study <cite>(Ware et al. (1993))</cite>. It measures generic HRQoL concepts and provides an objective way to measure HRQoL from the patients point of view by scoring standardized responses to standardized questions. The validity and reability of this instrument has been broadly tested <cite>(Stansfeld et al. (1997))</cite>. The SF-36 has 36 items, with different answer options. It was constructed to respresent eight health dimensions, which are <em>physical functioning</em> (PF), <em>role physical</em> (RP), <em>body pain</em> (BP), <em>general health</em> (GH), <em>vitality</em> (VT), <em>social functioning</em> (SF), <em>role emotional</em> (RE) and <em> mental health</em> (MH). Each item is assigned to a unique helath dimension. Each of the multi-item dimensions contains two to ten items. The first four dimensions are mainly physical, whereas the last four measure mental aspects of HRQoL. The resulting raw scores are tipically transformed to standardized scale scores from 0 to 100, where a higher score indicates a better health status.
</p>
<p><cite>Arostegui et al. (2013)</cite> proposed a recoding methodology for the Short Form-36 Health Survey (SF-36) dimensions in order to apply a beta-binomial distribution. The <code>HRQoLplot</code> function plots the SF-36 dimensions scores in a spider plot. Each axis of the plot refers to an expecific SF-36 dimension. Hence, the order of the dimensions in the data frame object of the function has been stablished as it has been explained in Arguments section. Each observation of the data frame, the value of each observation in all the dimensions, is drawn with a line of a different color in the plot. The plot shows the name of each dimension and the maximum number of scores each dimension can obtain in each axis of the plot.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>
<p>This function depends on the function <code>radarchart</code> of the package <code>fmsb</code> created by Minato Nakazawa.
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2013): On the recoding of continuous and bounded indexes to a binomial form: an application to quality-of-life scores, <em>Journal of Applied Statistics</em>, <b>40</b>, 563-583
</p>


<h3>See Also</h3>

<p>As it is said in the author section, the function depends on the function <code>radarchart</code> of the package <code>fmsb</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(5)
# We insert the columns in the order that has been determined:
n &lt;- c(20,4,9,20,20,8,3,13)
k=3
p=runif(8,0,1)
phi &lt;- runif(8,1,3)
dat &lt;- data.frame(
  PF=rBB(k,n[1],p[1],phi[1]),
  RP=rBB(k,n[2],p[2],phi[2]),
  BP=rBB(k,n[3],p[3],phi[3]),
  GH=rBB(k,n[4],p[4],phi[4]),
  VT=rBB(k,n[5],p[5],phi[5]),
  SF=rBB(k,n[6],p[6],phi[6]),
  RE=rBB(k,n[7],p[7],phi[7]),
  MH=rBB(k,n[8],p[8],phi[8]))

rownames(dat) &lt;- c("ID1", "ID2", "ID3")
HRQoLplot(dat,TRUE)
</code></pre>

<hr>
<h2 id='print.BBest'>
Print a BBest class model.
</h2><span id='topic+print.BBest'></span>

<h3>Description</h3>

<p><code>print.BBest</code> is the BBest specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BBest_+3A_x">x</code></td>
<td>
<p> a BBest class model.</p>
</td></tr>
<tr><td><code id="print.BBest_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a BBest object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBest">BBest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(9)
# Simulate a binomial distribution
y &lt;- rBB(100,10,0.5,2)

# Apply the model
model &lt;- BBest(y,10)
print(model)   # or just model

</code></pre>

<hr>
<h2 id='print.BBmm'>
Print a BBmm class model.
</h2><span id='topic+print.BBmm'></span>

<h3>Description</h3>

<p><code>print.BBmm</code> is the BBmm specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBmm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BBmm_+3A_x">x</code></td>
<td>
<p> a BBmm class model.</p>
</td></tr>
<tr><td><code id="print.BBmm_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a BBmm object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Breslow N. E. &amp; Calyton D. G. (1993): Approximate Inference in Generalized Linear Mixed Models, <em>Journal of the American Statistical Association</em>, <b>88</b>, 9-25
</p>
<p>Lee Y. &amp; Nelder J. A. (1996): Hierarchical generalized linear models, <em>Journal of the Royal Statistical
Society. Series B</em>, <b>58</b>, 619-678
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBmm">BBmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(14)

# Defining the parameters
k &lt;- 100
m &lt;- 10
phi &lt;- 0.5
beta &lt;- c(1.5,-1.1)
sigma &lt;- 0.5

# Simulating the covariate and random effects
x &lt;- runif(k,0,10)
X &lt;- model.matrix(~x)
z &lt;- as.factor(rBI(k,4,0.5,2))
Z &lt;- model.matrix(~z-1)
u &lt;- rnorm(5,0,sigma)


# The linear predictor and simulated response variable
eta &lt;- beta[1]+beta[2]*x+crossprod(t(Z),u)
p &lt;- 1/(1+exp(-eta))
y &lt;- rBB(k,m,p,phi)
dat &lt;- data.frame(cbind(y,x,z))
dat$z &lt;- as.factor(dat$z)

# Apply the model
model &lt;- BBmm(fixed.formula = y~x,random.formula = ~z,m=m,data=dat)
print(model) # or just model
</code></pre>

<hr>
<h2 id='print.BBreg'>
Print a BBreg class model.
</h2><span id='topic+print.BBreg'></span>

<h3>Description</h3>

<p><code>print.BBreg</code> is the BBreg specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BBreg_+3A_x">x</code></td>
<td>
<p> a BBreg class model.</p>
</td></tr>
<tr><td><code id="print.BBreg_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a BBreg object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Forcina A. &amp; Franconi L. (1988): Regression analysis with Beta-Binomial distribution, <em>Revista di Statistica Applicata</em>, <b>21</b>, 7-12
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBreg">BBreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We simulate a covariate, fix the paramters of the beta-binomial 
# distribution and simulate a response variable.

# Then we apply the model, and try to get the same values.
set.seed(18)
k &lt;- 1000
m &lt;- 10
x &lt;- rnorm(k,5,3)

beta &lt;- c(-10,2)
p &lt;- 1/(1+exp(-(beta[1]+beta[2]*x)))
phi &lt;- 1.2

y &lt;- rBB(k,m,p,phi)

model &lt;- BBreg(y~x,m)
print(model) # or just model
</code></pre>

<hr>
<h2 id='print.summary.BBest'>
Print a summary.BBest class model.
</h2><span id='topic+print.summary.BBest'></span>

<h3>Description</h3>

<p><code>print.summary.BBest</code> is the summary.BBest specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.BBest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.BBest_+3A_x">x</code></td>
<td>
<p> a summary.BBest class model.</p>
</td></tr>
<tr><td><code id="print.summary.BBest_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a summary.BBest object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBest">BBest</a></code>,<code><a href="#topic+summary.BBest">summary.BBest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(9)
# Simulate a binomial distribution
y &lt;- rBB(100,10,0.5,2)

# Apply the model
model &lt;- BBest(y,10)
sum.model &lt;- summary(model)
print(sum.model) # or just sum.model
</code></pre>

<hr>
<h2 id='print.summary.BBmm'>
Print a summary.BBmm class model.
</h2><span id='topic+print.summary.BBmm'></span>

<h3>Description</h3>

<p><code>print.summary.BBmm</code> is the summary.BBmm specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.BBmm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.BBmm_+3A_x">x</code></td>
<td>
<p> a summary.BBmm class model.</p>
</td></tr>
<tr><td><code id="print.summary.BBmm_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a summary.BBmm object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Breslow N. E. &amp; Calyton D. G. (1993): Approximate Inference in Generalized Linear Mixed Models, <em>Journal of the American Statistical Association</em>, <b>88</b>, 9-25
</p>
<p>Lee Y. &amp; Nelder J. A. (1996): Hierarchical generalized linear models, <em>Journal of the Royal Statistical
Society. Series B</em>, <b>58</b>, 619-678
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBmm">BBmm</a></code>, <code><a href="#topic+summary.BBmm">summary.BBmm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(14)

# Defining the parameters
k &lt;- 100
m &lt;- 10
phi &lt;- 0.5
beta &lt;- c(1.5,-1.1)
sigma &lt;- 0.5

# Simulating the covariate and random effects
x &lt;- runif(k,0,10)
X &lt;- model.matrix(~x)
z &lt;- as.factor(rBI(k,4,0.5,2))
Z &lt;- model.matrix(~z-1)
u &lt;- rnorm(5,0,sigma)


# The linear predictor and simulated response variable
eta &lt;- beta[1]+beta[2]*x+crossprod(t(Z),u)
p &lt;- 1/(1+exp(-eta))
y &lt;- rBB(k,m,p,phi)
dat &lt;- data.frame(cbind(y,x,z))
dat$z &lt;- as.factor(dat$z)

# Apply the model
model &lt;- BBmm(fixed.formula = y~x,random.formula = ~z,m=m,data=dat)
sum.model &lt;- summary(model)
print(sum.model) # or just sum.model
</code></pre>

<hr>
<h2 id='print.summary.BBreg'>
Print a summary.BBreg class model.
</h2><span id='topic+print.summary.BBreg'></span>

<h3>Description</h3>

<p><code>print.summary.BBreg</code> is the summary.BBreg specific method fot the generic function print which prints objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.BBreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.BBreg_+3A_x">x</code></td>
<td>
<p> a summary.BBreg class model.</p>
</td></tr>
<tr><td><code id="print.summary.BBreg_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a summary.BBreg object.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Forcina A. &amp; Franconi L. (1988): Regression analysis with Beta-Binomial distribution, <em>Revista di Statistica Applicata</em>, <b>21</b>, 7-12
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBreg">BBreg</a></code>,<code><a href="#topic+summary.BBreg">summary.BBreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We simulate a covariate, fix the paramters of the beta-binomial 
# distribution and simulate a response variable.

# Then we apply the model, and try to get the same values.
set.seed(18)
k &lt;- 1000
m &lt;- 10
x &lt;- rnorm(k,5,3)

beta &lt;- c(-10,2)
p &lt;- 1/(1+exp(-(beta[1]+beta[2]*x)))
phi &lt;- 1.2

y &lt;- rBB(k,m,p,phi)

model &lt;- BBreg(y~x,m)
sum.model &lt;- summary(model)
print(sum.model) # or just sum.model
</code></pre>

<hr>
<h2 id='SF36rec'>
Short Form-36 Health Survey recode
</h2><span id='topic+SF36rec'></span>

<h3>Description</h3>

<p>The <code>SF36rec</code> function recodes to a binomial form the 0-100 original standardized scores of the dimensions provided by the Short Form-36 Health Survey (SF-36) based on <cite>Arostegui et al. (2013)</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SF36rec(x,k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SF36rec_+3A_x">x</code></td>
<td>
<p> the 0-100 scale standardized dimension of the SF-36. It must be numeric and bounded between 0 and 100.</p>
</td></tr>
<tr><td><code id="SF36rec_+3A_k">k</code></td>
<td>
<p> an integer from 1 to 8 that defines which SF-36 dimension belongs <code>x</code>. These are the dimensions depending on the <code>k</code> value:
</p>
<p><code>k=1</code> -&gt; Physical functioning
</p>
<p><code>k=2</code> -&gt; Role physical
</p>
<p><code>k=3</code> -&gt; Body pain
</p>
<p><code>k=4</code> -&gt; General health
</p>
<p><code>k=5</code> -&gt; Vitality
</p>
<p><code>k=6</code> -&gt; Social functioning
</p>
<p><code>k=7</code> -&gt; Role emotional
</p>
<p><code>k=8</code> -&gt; Mental health
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Short Form-36 Health Survey is a commonly used technique to measure the Health Related Quality of Life (HRQoL) in chronich diseases. It was developed within the Medical Outcomes Study <cite>(Ware et al. (1993))</cite>. It measures generic HRQoL concepts and provides an objective way to measure HRQoL from the patients point of view by scoring standardized responses to standardized questions. The validity and reability of this instrument has been broadly tested <cite>(Stansfeld et al. (1997))</cite>. The SF-36 has 36 items, with different answer options. It was constructed to respresent eight health dimensions, which are <em>physical functioning</em> (PF), <em>role physical</em> (RP), <em>body pain</em> (BP), <em>general health</em> (GH), <em>vitality</em> (VT), <em>social functioning</em> (SF), <em>role emotional</em> (RE) and <em> mental health</em> (MH). Each item is assigned to a unique helath dimension. Each of the multi-item dimensions contains two to ten items. The first four dimensions are mainly physical, whereas the last four measure mental aspects of HRQoL. The resulting raw scores are tipically transformed to standardized scale scores from 0 to 100, where a higher score indicates a better health status.
</p>
<p><cite>Arostegui et al. (2013)</cite> proposed a recoding methodology of the SF-36 standardized scores to a binomial form in order to apply the beta-binomial distribution. The method was mainly based on the possible number of values each dimension can obtain, which comes from the number of items related with the construction of each dimension.
</p>
<p>The <code>SF36rec</code> function performes the cited recoding methodology to the specified SF-36 dimension. It has two inputs. The first one is the dimension that will be recoded, and the second one identifies which SF-36 dimension is. 
</p>


<h3>Value</h3>

<p>The score values of the recoded dimension.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2013): On the recoding of continuous and bounded indexes to a binomial form: an application to quality-of-life scores, <em>Journal of Applied Statistics</em>, <b>40</b>, 563-583
</p>
<p>Ware J. E., Snow K. K., Kosinski M. A. &amp; Gandek B. (1993): <em>SF-36 Health Survey, Manual and Interpretation Guides</em>. The Health Institute, New England Medical Center.
</p>
<p>Stansfeld S. A., Roberts R. &amp; Foot S. P. (1997): Assessing the validity of the SF-36 general health survey.
Quality of Life Research, <b>6</b>, 217-224.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
# We simulate a variable bounded between 0 and 100.
BodyPain &lt;- runif(1000,0,100)

# We specify that the simulated dimension corresponds
# with body pain dimension.
k &lt;- 3

# We perform the recoding.
BodyPain.rec &lt;- SF36rec(BodyPain,k)
</code></pre>

<hr>
<h2 id='summary.BBest'>Summarizes a BBest class model.</h2><span id='topic+summary.BBest'></span>

<h3>Description</h3>

<p><code>summary.BBest</code> si the BBest specific method for the generic function <code>summary</code> which summarizes objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BBest_+3A_object">object</code></td>
<td>
<p> a BBest class model.</p>
</td></tr>
<tr><td><code id="summary.BBest_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.BBest</code> summarizes all the relevant information about the estimation of the parameters in a BBest class model. 
</p>


<h3>Value</h3>

<p><code>summary.BBest</code> returns an object of class &quot;<code>summary.BBest</code>&quot;.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a table with the estimated parameters is in the BBest class model.</p>
</td></tr>
<tr><td><code>p.coefficients</code></td>
<td>
<p> a summarized table of the estimation of the probability parameter of the beta-binomial distribution. The table contents the estimation of the probability parameter and the standard errors of the estimations.</p>
</td></tr>
<tr><td><code>psi.coefficients</code></td>
<td>
<p> a summarized table of the estimation of the logarithm of the dispersion parameter of the beta-binomial distribution. The table contents the estimation of the logarithm of the dispersion parameter and the standard errors of the estimations.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> the maximum score number in each beta-binomial observation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BBest">BBest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(9)
# Simulate a binomial distribution
y &lt;- rBB(100,10,0.5,2)

# Apply the model
model &lt;- BBest(y,10)
sum.model &lt;- summary(model)
</code></pre>

<hr>
<h2 id='summary.BBmm'>
Summarizes a BBmm class model.</h2><span id='topic+summary.BBmm'></span>

<h3>Description</h3>

<p><code>summary.BBmm</code> si the BBmm specific method for the generic function <code>summary</code> which summarizes objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBmm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BBmm_+3A_object">object</code></td>
<td>
<p> a BBmm class model.</p>
</td></tr>
<tr><td><code id="summary.BBmm_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.BBmm</code> summarizes all the relevant information about the estimation of the parameters in a BBmm class model.
</p>
<p>The function performs statistical significance hypothesis about the estimated fixed parameters based on the normal distribution of the estimates. It also performs a goodness of fit test based on the difference between the calculated deviance of the model and the null deviance or deviance of the null model, which it is suppose to follow a Chi-square distribution with degrees of freedom equal to the difference in degrees of freedom of the models.
</p>


<h3>Value</h3>

<p><code>summary.BBmm</code> returns an object of class &quot;<code>summary.BBmm</code>&quot;.
</p>
<table>
<tr><td><code>fixed.coefficients</code></td>
<td>
<p> a table with all the relevant information about the significance of the fixed effects estimates in the model. It includes the estimates, the standard errors of the estimates, the test-statistics and the p-values.</p>
</td></tr>
<tr><td><code>sigma.table</code></td>
<td>
<p> a table which inlcudes the estimates and the standard errors of the estimates of the random effects variance parameters.</p>
</td></tr>
<tr><td><code>psi.table</code></td>
<td>
<p> a table which includes the estimate and the standard errors of the estimate of the logarithm of the dispersion parameter of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>random.coef</code></td>
<td>
<p> predicted random effects of the regression.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> number of iterations in the estimation method.</p>
</td></tr>
<tr><td><code>nObs</code></td>
<td>
<p> number of observations in the data.</p>
</td></tr>
<tr><td><code>nRand</code></td>
<td>
<p> number of random effects.</p>
</td></tr>
<tr><td><code>nComp</code></td>
<td>
<p> number of random components.</p>
</td></tr>
<tr><td><code>nRandComp</code></td>
<td>
<p> number of random effects in each random component of the model.</p>
</td></tr>
<tr><td><code>namesRand</code></td>
<td>
<p> names of the random components.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p> deviance of the model.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> degrees of freedom of the model.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p> null-deviance, deviance of the null model. The null model will only include an intercept as the estimation of the probability parameter of the conditinal beta-binomial distribution.</p>
</td></tr>
<tr><td><code>null.df</code></td>
<td>
<p> degrees of freedom of the null model.</p>
</td></tr>
<tr><td><code>Goodness.of.fit</code></td>
<td>
<p> p-value of the goodness of fit test.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the conditional beta-binomial response variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> maximum score number in each beta-binomial observation.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> convergence of the methodology. If the algorithm has converged it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Breslow N. E. &amp; Calyton D. G. (1993): Approximate Inference in Generalized Linear Mixed Models, <em>Journal of the American Statistical Association</em>, <b>88</b>, 9-25
</p>
<p>Lee Y. &amp; Nelder J. A. (1996): Hierarchical generalized linear models, <em>Journal of the Royal Statistical
Society. Series B</em>, <b>58</b>, 619-678
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413
</p>


<h3>See Also</h3>

<p>The <code>multiroot</code> and <code><a href="stats.html#topic+uniroot">uniroot</a></code> functions of the R-package <code>rootSolve</code> for the general Newton-Raphson algorithm.
</p>
<p><code><a href="#topic+BBmm">BBmm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(14)

# Defining the parameters
k &lt;- 100
m &lt;- 10
phi &lt;- 0.5
beta &lt;- c(1.5,-1.1)
sigma &lt;- 0.5

# Simulating the covariate and random effects
x &lt;- runif(k,0,10)
X &lt;- model.matrix(~x)
z &lt;- as.factor(rBI(k,4,0.5,2))
Z &lt;- model.matrix(~z-1)
u &lt;- rnorm(5,0,sigma)


# The linear predictor and simulated response variable
eta &lt;- beta[1]+beta[2]*x+crossprod(t(Z),u)
p &lt;- 1/(1+exp(-eta))
y &lt;- rBB(k,m,p,phi)
dat &lt;- data.frame(cbind(y,x,z))
dat$z &lt;- as.factor(dat$z)

# Apply the model
model &lt;- BBmm(fixed.formula = y~x,random.formula = ~z,m=m,data=dat)
sum.model &lt;- summary(model)

</code></pre>

<hr>
<h2 id='summary.BBreg'>
Summarizes a BBreg class model.
</h2><span id='topic+summary.BBreg'></span>

<h3>Description</h3>

<p><code>summary.BBreg</code> si the BBreg specific method for the generic function <code>summary</code> which summarizes objects returned by modelling functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BBreg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BBreg_+3A_object">object</code></td>
<td>
<p> a BBreg class model.</p>
</td></tr>
<tr><td><code id="summary.BBreg_+3A_...">...</code></td>
<td>
<p> for extra arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.BBreg</code> summarizes all the relevant information about the estimation of the parameters in a BBreg class model.
</p>
<p>The function performs statistical significance hypothesis about the estimated regression parameters based on the normal distribution of the estimates. It also performs a goodness of fit test based on the difference between the calculated deviance of the model and the null deviance or deviance of the null model, which it is suppose to follow a Chi-square distribution with degrees of freedom equal to the difference in degrees of freedom of the models.
</p>


<h3>Value</h3>

<p><code>summary.BBreg</code> returns an object of class &quot;<code>summary.BBreg</code>&quot;.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a table with all the relevant information about the significance of the regression coefficients of the model. It includes the estimations, the standard errors of the estimations, the test-statistics and the p-values.</p>
</td></tr>
<tr><td><code>psi.table</code></td>
<td>
<p> a table which includes the estimation and standard errors of the logarithm of the dispersion parameter of the conditional beta-binomial distribution.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p> deviance of the model.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> degrees of freedom of the model.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p> null-deviance, deviance of the null model.</p>
</td></tr>
<tr><td><code>null.df</code></td>
<td>
<p> degrees of freedom of the null model.</p>
</td></tr>
<tr><td><code>Goodness.of.fit</code></td>
<td>
<p> p-value of the goodness of fit test.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> number of iterations in the estimation method.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p> the model matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> the dependent variable in the model.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the response variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> number of trials in each binomial observation.</p>
</td></tr>
<tr><td><code>nObs</code></td>
<td>
<p> number of observations.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p> number of trials in each observation.</p>
</td></tr>
<tr><td><code>balanced</code></td>
<td>
<p> if the response beta-binomial variable is balanced it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> convergence of the methodology. If the algorithm has converged it returns &quot;yes&quot;, otherwise &quot;no&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Forcina A. &amp; Franconi L. (1988): Regression analysis with Beta-Binomial distribution, <em>Revista di Statistica Applicata</em>, <b>21</b>, 7-12
</p>
<p>Najera-Zuloaga J., Lee D.-J. &amp; Arostegui I. (2017): Comparison of beta-binomial regression model approaches to analyze health related quality of life data, <em>Statistical Methods in Medical Research</em>, DOI: 10.1177/0962280217690413 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># We simulate a covariate, fix the paramters of the beta-binomial 
# distribution and simulate a response variable.

# Then we apply the model, and try to get the same values.
set.seed(18)
k &lt;- 1000
m &lt;- 10
x &lt;- rnorm(k,5,3)

beta &lt;- c(-10,2)
p &lt;- 1/(1+exp(-(beta[1]+beta[2]*x)))
phi &lt;- 1.2

y &lt;- rBB(k,m,p,phi)

model &lt;- BBreg(y~x,m)
sum.model &lt;- summary(model)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
