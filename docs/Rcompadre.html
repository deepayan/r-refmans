<!DOCTYPE html><html><head><title>Help for package Rcompadre</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rcompadre}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rcompadre-package'><p>Rcompadre: Utilities for using the 'COM(P)ADRE' Matrix Model Database</p></a></li>
<li><a href='#as_cdb'><p>Convert legacy COM(P)ADRE database object to CompadreDB</p></a></li>
<li><a href='#cdb_build_cdb'><p>Create a CompadreDB object from user-specified data</p></a></li>
<li><a href='#cdb_check_species'><p>Check whether a COM(P)ADRE database contains one or more species of interest</p></a></li>
<li><a href='#cdb_collapse'><p>Collapse a COM(P)ADRE database by averaging matrices over levels of one or</p>
more grouping variables</a></li>
<li><a href='#cdb_compare'><p>Compare two versions or subsets of a COM(P)ADRE database</p></a></li>
<li><a href='#cdb_fetch'><p>Fetch the COM(P)ADRE database from compadre-db.org or a local file</p></a></li>
<li><a href='#cdb_flag'><p>Flag potential issues in matrices of a COM(P)ADRE database</p></a></li>
<li><a href='#cdb_flatten'><p>Convert a COM(P)ADRE database to a flat data frame with matrices and vectors</p>
stored in string representation</a></li>
<li><a href='#cdb_id'><p>Create integer identifiers for a COM(P)ADRE database corresponding to unique</p>
combinations of a given set of columns</a></li>
<li><a href='#cdb_id_stages'><p>Create integer identifiers for a COM(P)ADRE database corresponding to unique</p>
combinations of species and matrix stage class definitions</a></li>
<li><a href='#cdb_id_studies'><p>Create a vector of unique study identifiers from a COM(P)ADRE database</p></a></li>
<li><a href='#cdb_mean_matF'><p>Calculate a population-specific mean fecundity matrix for each set of</p>
matrices in a COM(P)ADRE database</a></li>
<li><a href='#cdb_metadata'><p>Extract metadata from a COM(P)ADRE database</p></a></li>
<li><a href='#cdb_rbind'><p>Merge two COM(P)ADRE databases via row-bind</p></a></li>
<li><a href='#cdb_unflatten'><p>Reconstitute a flattened COM(P)ADRE database (created by cdb_flatten) as a</p>
CompadreDB object</a></li>
<li><a href='#cdb_unnest'><p>Unnest a COM(P)ADRE database by spreading the components of CompadreMat into</p>
separate list-columns</a></li>
<li><a href='#Compadre'><p>Subsamples of the COMPADRE Plant Matrix Database and COMADRE Animal</p>
Matrix Database for testing and examples</a></li>
<li><a href='#CompadreDB'><p>CompadreDB Class</p></a></li>
<li><a href='#CompadreDB-Methods'><p>Methods for CompadreDB objects</p></a></li>
<li><a href='#CompadreDB-Subsetting'><p>Subsetting CompadreDB objects</p></a></li>
<li><a href='#CompadreDB-Tidyverse'><p>Tidyverse methods for CompadreDB objects</p></a></li>
<li><a href='#CompadreLegacy'><p>Subsample of a legacy version of the COMPADRE Plant Matrix Database for</p>
testing and examples</a></li>
<li><a href='#CompadreMatrixMethods'><p>Methods for working with matrices in com(p)adre</p></a></li>
<li><a href='#mpm_mean'><p>Calculate a mean over a list of matrices or CompadreMat objects</p></a></li>
<li><a href='#mpm_median'><p>Calculate a median over a list of matrices or CompadreMat objects</p></a></li>
<li><a href='#mpm_methods'><p>Extract stage-class information from CompadreMat or CompadreDB objects</p></a></li>
<li><a href='#mpm_sd'><p>Calculate a standard deviation over a list of matrices or CompadreMat objects</p></a></li>
<li><a href='#string_representation'><p>Convert vectors or square numeric matrices to and from string representation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Utilities for using the 'COM(P)ADRE' Matrix Model Database</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Utility functions for interacting with the 'COMPADRE' and
    'COMADRE' databases of matrix population models. Described in Jones et
    al. (2021) &lt;<a href="https://doi.org/10.1101%2F2021.04.26.441330">doi:10.1101/2021.04.26.441330</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jonesor/Rcompadre">https://github.com/jonesor/Rcompadre</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jonesor/Rcompadre/issues">https://github.com/jonesor/Rcompadre/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, popdemo, stats, tibble, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, ggplot2, knitr, maps, rcrossref, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>false</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CompadreDB.R' 'Rcompadre-package.R' 'CompadreDB-Methods.R'
'CompadreDB-Subsetting.R' 'CompadreDB-Tidyverse.R'
'CompadreMat.R' 'ClassUnionMethods.R' 'cdb_check_species.R'
'cdb_build_cdb.R' 'cdb_collapse.R' 'cdb_compare.R'
'cdb_fetch.R' 'cdb_flag.R' 'cdb_flatten.R' 'cdb_id.R'
'cdb_id_stages.R' 'cdb_id_studies.R' 'cdb_mean_matF.R'
'cdb_metadata.R' 'cdb_rbind.R' 'cdb_unflatten.R' 'cdb_unnest.R'
'data.R' 'mpm_mean.R' 'mpm_methods.R' 'mpm_sd.R' 'mpm_median.R'
'string_representation.R' 'zzz.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-02 15:43:44 UTC; jones</td>
</tr>
<tr>
<td>Author:</td>
<td>Patrick Barks <a href="https://orcid.org/0000-0002-5947-8151"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Danny Buss [aut],
  Roberto Salguero-Gomez
    <a href="https://orcid.org/0000-0002-6085-4433"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Iain Stott <a href="https://orcid.org/0000-0003-2724-7436"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  William K. Petry <a href="https://orcid.org/0000-0002-5230-5987"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Tamora James <a href="https://orcid.org/0000-0003-1363-4742"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Owen Jones <a href="https://orcid.org/0000-0001-5720-4686"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Julia Jones <a href="https://orcid.org/0000-0001-9223-1778"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Gesa RÃ¶mer <a href="https://orcid.org/0000-0002-4859-5870"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Sam Levin <a href="https://orcid.org/0000-0002-3289-9925"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Owen Jones &lt;jones@biology.sdu.dk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-02 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rcompadre-package'>Rcompadre: Utilities for using the 'COM(P)ADRE' Matrix Model Database</h2><span id='topic+Rcompadre'></span><span id='topic+Rcompadre-package'></span>

<h3>Description</h3>

<p>Utility functions for interacting with the 'COMPADRE' and 'COMADRE' databases of matrix population models. Described in Jones et al. (2021) <a href="https://doi.org/10.1101/2021.04.26.441330">doi:10.1101/2021.04.26.441330</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Owen Jones <a href="mailto:jones@biology.sdu.dk">jones@biology.sdu.dk</a> (<a href="https://orcid.org/0000-0001-5720-4686">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Patrick Barks <a href="mailto:barks@biology.sdu.dk">barks@biology.sdu.dk</a> (<a href="https://orcid.org/0000-0002-5947-8151">ORCID</a>)
</p>
</li>
<li><p> Danny Buss <a href="mailto:dlb50@cam.ac.uk">dlb50@cam.ac.uk</a>
</p>
</li>
<li><p> Roberto Salguero-Gomez <a href="mailto:rob.salguero@zoo.ox.ac.uk">rob.salguero@zoo.ox.ac.uk</a> (<a href="https://orcid.org/0000-0002-6085-4433">ORCID</a>)
</p>
</li>
<li><p> Iain Stott <a href="mailto:stott@biology.sdu.dk">stott@biology.sdu.dk</a> (<a href="https://orcid.org/0000-0003-2724-7436">ORCID</a>)
</p>
</li>
<li><p> William K. Petry <a href="mailto:wpetry@ncsu.edu">wpetry@ncsu.edu</a> (<a href="https://orcid.org/0000-0002-5230-5987">ORCID</a>)
</p>
</li>
<li><p> Tamora James <a href="mailto:tamoradjames@protonmail.com">tamoradjames@protonmail.com</a> (<a href="https://orcid.org/0000-0003-1363-4742">ORCID</a>)
</p>
</li>
<li><p> Julia Jones <a href="mailto:juagjones@gmail.com">juagjones@gmail.com</a> (<a href="https://orcid.org/0000-0001-9223-1778">ORCID</a>)
</p>
</li>
<li><p> Gesa RÃ¶mer <a href="mailto:gesa@biology.sdu.dk">gesa@biology.sdu.dk</a> (<a href="https://orcid.org/0000-0002-4859-5870">ORCID</a>)
</p>
</li>
<li><p> Sam Levin <a href="mailto:levisc8@gmail.com">levisc8@gmail.com</a> (<a href="https://orcid.org/0000-0002-3289-9925">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jonesor/Rcompadre">https://github.com/jonesor/Rcompadre</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jonesor/Rcompadre/issues">https://github.com/jonesor/Rcompadre/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as_cdb'>Convert legacy COM(P)ADRE database object to CompadreDB</h2><span id='topic+as_cdb'></span>

<h3>Description</h3>

<p>Convert a legacy COM(P)ADRE database object (of class 'list') to a CompadreDB
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_cdb(from)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_cdb_+3A_from">from</code></td>
<td>
<p>A legacy COM(P)ADRE database</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A CompadreDB object
</p>


<h3>Author(s)</h3>

<p>Iain M. Stott
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Compadre &lt;- as_cdb(CompadreLegacy)
</code></pre>

<hr>
<h2 id='cdb_build_cdb'>Create a CompadreDB object from user-specified data</h2><span id='topic+cdb_build_cdb'></span>

<h3>Description</h3>

<p>Creates a CompadreDB object from data provided by the user in the form of
matrices and metadata. Users can provide either a list of A matrices (i.e.
the whole matrix population model) or lists of process-based submatrices
<code>matU</code>, <code>matF</code>and <code>matC</code>. In this latter case, we assume that
<code>matA = matU + matF + matC</code>. If only one type of the submatrices are
provided, the others are assumed to be 0. If only the A matrices are
provided, the submatrices are recorded as 'NA'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_build_cdb(
  mat_a = NULL,
  mat_u = NULL,
  mat_f = NULL,
  mat_c = NULL,
  stages = NULL,
  version = NULL,
  metadata = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_build_cdb_+3A_mat_a">mat_a</code></td>
<td>
<p>A 'list' of A matrices</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_mat_u">mat_u</code></td>
<td>
<p>A 'list' of U matrices (representing survival and growth)</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_mat_f">mat_f</code></td>
<td>
<p>A 'list' of F matrices (representing sexual reproduction)</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_mat_c">mat_c</code></td>
<td>
<p>A 'list' of C matrices (representing clonal reproduction)</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_stages">stages</code></td>
<td>
<p>A 'list' of stage definitions provided as 'data.frame's that
include two columns: 'MatrixClassOrganized' and 'MatrixClassAuthor'. If
this argument is not provided, numeric stage names are generated
automatically</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_version">version</code></td>
<td>
<p>An optional string allowing users to add version information
to their output object. If this argument is not provided the current date
and time is used.</p>
</td></tr>
<tr><td><code id="cdb_build_cdb_+3A_metadata">metadata</code></td>
<td>
<p>A 'data.frame' of metadata associated with each matrix.
Metadata should be provided by row in the same order as the matrices are
placed in the lists.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A valid CompadreDB object
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data acquisition: 
<code><a href="#topic+cdb_fetch">cdb_fetch</a>()</code>,
<code><a href="#topic+cdb_metadata">cdb_metadata</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># If you only have A matrices

mat_a1 &lt;- rbind(
  c(0.1, 1.9),
  c(0.5, 0.7)
)

mat_a2 &lt;- rbind(
  c(0.2, 1.4, 2.3),
  c(0.6, 0.3, 1.1),
  c(0.2, 0.2, 1.5)
)

mat_a3 &lt;- rbind(
  c(0.1, 2.1),
  c(0.3, 0.4)
)

# Place the matrices into a list
mat_a_list &lt;- mget(ls(pattern = "mat_a[0-9]"))

my_compadre &lt;- cdb_build_cdb(mat_a = mat_a_list, version = "testrun")
my_compadre


mat_u1 &lt;- rbind(
  c(0.1, 0.0),
  c(0.5, 0.7)
)

mat_u2 &lt;- rbind(
  c(0.2, 0.0, 0.0),
  c(0.6, 0.3, 1.1),
  c(0.2, 0.2, 1.5)
)

mat_f1 &lt;- rbind(
  c(0.0, 1.9),
  c(0.0, 0.0)
)

mat_f2 &lt;- rbind(
  c(0.0, 1.4, 2.3),
  c(0.0, 0.0, 0.0),
  c(0.0, 0.0, 0.0)
)

mat_u_list &lt;- mget(ls(pattern = "mat_u[0-9]"))
mat_f_list &lt;- mget(ls(pattern = "mat_f[0-9]"))

meta &lt;- data.frame(idNum = 1:2, SpeciesAccepted = c("A", "B"), x = 4:5)

stageInfo &lt;- list(
  data.frame(
    MatrixClassOrganized = rep("active", 2),
    MatrixClassAuthor = c("small", "large")
  ),
  data.frame(
    MatrixClassOrganized = rep("active", 3),
    MatrixClassAuthor = c("small", "medium", "large")
  )
)


my_compadre &lt;- cdb_build_cdb(
  mat_u = mat_u_list, mat_f = mat_f_list,
  metadata = meta, stages = stageInfo
)
my_compadre

my_compadre &lt;- cdb_build_cdb(
  mat_u = mat_u_list, mat_f = mat_f_list,
  metadata = meta
)
my_compadre
</code></pre>

<hr>
<h2 id='cdb_check_species'>Check whether a COM(P)ADRE database contains one or more species of interest</h2><span id='topic+cdb_check_species'></span>

<h3>Description</h3>

<p>Takes a vector of species names and checks whether those species are
represented within a CompadreDB object. It outputs either a data frame
depicting the species of interest and whether they occur in the database
(TRUE/FALSE), or, if <code>return_db == TRUE</code>, a CompadreDB object subset to
the species of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_check_species(cdb, species, return_db = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_check_species_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_check_species_+3A_species">species</code></td>
<td>
<p>Character vector of binomial species names, with the genus and
specific epithet separated by either an underscore or a space (e.g.
<code>c("Acipenser_fulvescens", "Borrelia_burgdorferi")</code>)</p>
</td></tr>
<tr><td><code id="cdb_check_species_+3A_return_db">return_db</code></td>
<td>
<p>Logical argument indicating whether a database should be
returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>return_db == FALSE</code>, returns a data frame with a column of
species names and a column indicating whether a species occurs in the
database. If <code>return_db == TRUE</code>, returns a subset of <code>cdb</code>
containing only those species within argument <code>species</code>.
</p>


<h3>Author(s)</h3>

<p>Danny Buss &lt;dlb50@cam.ac.uk&gt;
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Rob Salguero-GÃ³mez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data checking: 
<code><a href="#topic+cdb_collapse">cdb_collapse</a>()</code>,
<code><a href="#topic+cdb_compare">cdb_compare</a>()</code>,
<code><a href="#topic+cdb_flag">cdb_flag</a>()</code>,
<code><a href="#topic+mpm_methods">mpm_methods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>species &lt;- c("Primula vulgaris", "Trillium ovatum", "Homo sapiens")
cdb_check_species(Compadre, species)
CompadreSubset &lt;- cdb_check_species(Compadre, species, return_db = TRUE)

</code></pre>

<hr>
<h2 id='cdb_collapse'>Collapse a COM(P)ADRE database by averaging matrices over levels of one or
more grouping variables</h2><span id='topic+cdb_collapse'></span>

<h3>Description</h3>

<p>Collapses a CompadreDB object by averaging matrices over levels of one or
more grouping variables (e.g. SpeciesAuthor, MatrixPopulation).
</p>
<p>For a given study and species, a COM(P)ADRE database may contain multiple
matrices, reflecting different combinations of population, year, and/or
treatment. Collapsing allows a user to obtain a single 'grand mean matrix'
for each group of interest (e.g. MatrixPopulation), and therefore limit
pseudoreplication.
</p>
<p>All members of a group <em>must</em> have the same matrix dimension (consider
adding MatrixDimension as a grouping variable). All members of a group
<em>should</em> have the same ProjectionInterval and matrix stage class
definitions (see <code><a href="#topic+cdb_id_stages">cdb_id_stages</a></code>). Note that Seasonal matrices
should not be collapsed using this method (they should be matrix-multiplied
rather than averaged).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_collapse(cdb, columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_collapse_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_collapse_+3A_columns">columns</code></td>
<td>
<p>Vector of grouping variables to collapse over (corresponding
to columns within <code>cdb</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Will give a warning if members of any group do not all share the same
ProjectionInterval or stage class definitions, or if <code>cdb</code> contains any
rows with a MatrixComposite value of &quot;Seasonal&quot;.
</p>
<p>Prior to collapsing, columns of class 'factor' will be coerced to
'character', and any list-column apart from <code>mat</code> will be removed.
</p>
<p>Within a group, rows of a given column are collapsed as follows:
</p>

<ul>
<li> <p><code>mat</code>: matrices are averaged using <a href="#topic+mpm_mean">mpm_mean</a>, and stage
class definitions are taken from the first group member
</p>
</li>
<li> <p><code>MatrixComposite</code>: return original value if N = 1, else return
&quot;Collapsed&quot;
</p>
</li>
<li> <p><code>Lat</code>: re-calculated by averaging Lat column (if available)
</p>
</li>
<li> <p><code>Lon</code>: re-calculated by averaging Lon column (if available)
</p>
</li>
<li> <p><code>SurvivalIssue</code>: re-calculated from the collapsed <code>mat</code>
(<code>max(colSums(matU))</code>)
</p>
</li>
<li> <p><code>others</code>: if all elements equal return that unique value, else
paste together all unique values separated by &quot;; &quot;
</p>
</li></ul>



<h3>Value</h3>

<p>A CompadreDB object
</p>


<h3>Author(s)</h3>

<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_id_stages">cdb_id_stages</a>
</p>
<p>Other data checking: 
<code><a href="#topic+cdb_check_species">cdb_check_species</a>()</code>,
<code><a href="#topic+cdb_compare">cdb_compare</a>()</code>,
<code><a href="#topic+cdb_flag">cdb_flag</a>()</code>,
<code><a href="#topic+mpm_methods">mpm_methods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># filter out Seasonal matrices
CompSub &lt;- subset(Compadre, MatrixComposite != "Seasonal")

# add column identifying unique stage class definitions
CompSub$id_stage &lt;- cdb_id_stages(CompSub, "MatrixClassOrganized")

# collapse
CompCollapse &lt;- cdb_collapse(CompSub, columns = c("id_stage"))

</code></pre>

<hr>
<h2 id='cdb_compare'>Compare two versions or subsets of a COM(P)ADRE database</h2><span id='topic+cdb_compare'></span>

<h3>Description</h3>

<p>Prints a summary of the differences between two CompadreDB objects, including
the number of species, studies, and matrices in each. If argument
<code>verbose == TRUE</code>, additionally prints a list of the species and studies
that are present in one database but not the other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_compare(cdb1, cdb2, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_compare_+3A_cdb1">cdb1</code>, <code id="cdb_compare_+3A_cdb2">cdb2</code></td>
<td>
<p>CompadreDB objects to compare</p>
</td></tr>
<tr><td><code id="cdb_compare_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument indicating whether or not to return lots of
detail</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. Output is printed rather than returned.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data checking: 
<code><a href="#topic+cdb_check_species">cdb_check_species</a>()</code>,
<code><a href="#topic+cdb_collapse">cdb_collapse</a>()</code>,
<code><a href="#topic+cdb_flag">cdb_flag</a>()</code>,
<code><a href="#topic+mpm_methods">mpm_methods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Compadre1 &lt;- subset(Compadre, Continent == "Asia")
Compadre2 &lt;- subset(Compadre, Continent == "Africa")

cdb_compare(Compadre1, Compadre2)

</code></pre>

<hr>
<h2 id='cdb_fetch'>Fetch the COM(P)ADRE database from compadre-db.org or a local file</h2><span id='topic+cdb_fetch'></span>

<h3>Description</h3>

<p>Fetches the current version of a COM(P)ADRE database from
<a href="https://compadre-db.org">https://compadre-db.org</a>, or load any version stored in a local .RData
file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_fetch(cdb, version = NULL, flag = FALSE, userComment = NULL, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_fetch_+3A_cdb">cdb</code></td>
<td>
<p>Either &quot;comadre&quot; or &quot;compadre&quot; (case insensitive) to fetch the
most recent database from <a href="https://compadre-db.org">https://compadre-db.org</a>, or a path to an
existing COMPADRE database (i.e. .RData file) stored on the local machine.</p>
</td></tr>
<tr><td><code id="cdb_fetch_+3A_version">version</code></td>
<td>
<p>Optional. The version number of a particular database to be
downloaded e.g. &quot;3.0.0&quot;. If this is not included (as default) the latest
versions are downloaded.</p>
</td></tr>
<tr><td><code id="cdb_fetch_+3A_flag">flag</code></td>
<td>
<p>Logical argument where 'TRUE' will automatically run
<a href="#topic+cdb_flag">cdb_flag</a> to add logical columns to the metadata to flag potential
problems in the matrix population models. Default is 'FALSE'.</p>
</td></tr>
<tr><td><code id="cdb_fetch_+3A_usercomment">userComment</code></td>
<td>
<p>An optional string to enable users to add a comment as an
attribute to the returned data frame. This could be useful for keeping
track of multiple versions of the database. Accessed by
'attributes(db)$comment'.</p>
</td></tr>
<tr><td><code id="cdb_fetch_+3A_quiet">quiet</code></td>
<td>
<p>A logical argument. If 'TRUE' the download message that includes
version information and link to the user agreement is suppressed. Default
is 'FALSE'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A CompadreDB object
</p>


<h3>Note</h3>

<p>The downloaded databases include a set of attributes accessible with
'attributes'. These include version information and date and time of
creation.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data acquisition: 
<code><a href="#topic+cdb_build_cdb">cdb_build_cdb</a>()</code>,
<code><a href="#topic+cdb_metadata">cdb_metadata</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Download latest version of COMPADRE direct from the website
compadre &lt;- cdb_fetch("compadre")

# Examine the attributes of the downloaded database
attributes(compadre)

# Download COMPADRE version 3.0.0 direct from the website
compadre &lt;- cdb_fetch("compadre", version = "3.0.0")

# using file path to downloaded data
compadre &lt;- cdb_fetch("data/COMPADRE_v.5.0.1.RData")

## End(Not run)
</code></pre>

<hr>
<h2 id='cdb_flag'>Flag potential issues in matrices of a COM(P)ADRE database</h2><span id='topic+cdb_flag'></span>

<h3>Description</h3>

<p>Adds columns to the data slot of a 'CompadreDB' object that flag potential
problems in the matrix population models. These columns can subsequently be
used to subset the database by logical argument.
</p>
<p>Optional checks include:
</p>

<ul>
<li> <p><code>check_NA_A</code>: missing values in 'matA'? Missing ('NA') values in
matrices prevent most calculations using those matrices.
</p>
</li>
<li> <p><code>check_NA_U</code>: missing values in 'matU'? Missing ('NA') values in
matrices prevent most calculations using those matrices.
</p>
</li>
<li> <p><code>check_NA_F</code>: missing values in 'matF'? Missing ('NA') values in
matrices prevent most calculations using those matrices.
</p>
</li>
<li> <p><code>check_NA_C</code>: missing values in 'matC'? Missing ('NA') values in
matrices prevent most calculations using those matrices.
</p>
</li>
<li> <p><code>check_zero_U</code>: 'matU' all zeros (including 'NA')? Submatrices
composed entirely of zero values can be problematic. There may be good
biological reasons for this phenomenon. For example, in the particular
focal population in the particular focal year, there was truly zero
survival recorded. Nevertheless, zero-value submatrices can cause some
calculations to fail and it may be necessary to exclude them.
</p>
</li>
<li> <p><code>check_zero_F</code>: 'matF' all zeros (including 'NA')? Submatrices
composed entirely of zero values can be problematic. There may be good
biological reasons for this phenomenon. For example, in the particular
focal population in the particular focal year, there was truly zero
reproduction recorded. Nevertheless, zero-value submatrices can cause some
calculations to fail and it may be necessary to exclude them.
</p>
</li>
<li> <p><code>check_zero_U_colsum</code>: Columns of 'matU' that sum to zero imply
that there is is no survival from that particular stage. This may be a
perfectly valid parameterisation for a particular year/place but is
biologically unreasonable in the longer term and users may wish to exclude
problematic matrices from their analysis.
</p>
</li>
<li> <p><code>check_singular_U</code>: 'matU' singular? Matrices are said to be
singular if they cannot be inverted. Inversion is required for many matrix
calculations and, therefore, singularity can cause some calculations to
fail.
</p>
</li>
<li> <p><code>check_component_sum</code>: do 'matU'/'matF'/'matC' submatrices sum
to 'matA' (see <em>Details</em>)? A complete MPM ('matA') can be split into
its component submatrices (i.e., 'matU', 'matF' and  'matC'). The sum of
these submatrices should equal the complete MPM (i.e., 'matA' = 'matU' +
'matF' + 'matC'). Sometimes, however, errors occur so that the submatrices
do NOT sum to 'matA'. Normally, this is caused by rounding errors, but more
significant errors are possible.
</p>
</li>
<li> <p><code>check_ergodic</code>: is 'matA' ergodic (see
<code><a href="popdemo.html#topic+isErgodic">isErgodic</a></code>)? Some matrix calculations require that
the MPM ('matA') be ergodic. Ergodic MPMs are those where there is a single
asymptotic stable state that does not depend on initial stage structure.
Conversely, non-ergodic MPMs are those where there are multiple asymptotic
stable states, which depend on initial stage structure. MPMs that are
non-ergodic are usually biologically unreasonable, both in terms of their
life cycle description and their projected dynamics. They cause some
calculations to fail.
</p>
</li>
<li> <p><code>check_irreducible</code>: is 'matA' irreducible (see
<code><a href="popdemo.html#topic+isIrreducible">isIrreducible</a></code>)? Some matrix calculations require
that the MPM ('matA') be irreducible. Irreducible MPMs are those where
parameterised transition rates facilitate pathways from all stages to all
other stages. Conversely, reducible MPMs depict incomplete life cycles
where pathways from all stages to every other stage are not possible. MPMs
that are reducible are usually biologically unreasonable, both in terms of
their life cycle description and their projected dynamics. They cause some
calculations to fail. Irreducibility is necessary but not sufficient for
ergodicity.
</p>
</li>
<li> <p><code>check_primitive</code>: is 'matA' primitive (see
<code><a href="popdemo.html#topic+isPrimitive">isPrimitive</a></code>)? A primitive matrix is non-negative
matrix that is irreducible and has only a single eigenvalue of maximum
modulus. This check is therefore redundant due to the overlap with
'check_irreducible' and 'checkErdogic'.
</p>
</li>
<li> <p><code>check_surv_gte_1</code>: does 'matU' contains values that are equal
to or greater than 1? Survival is bounded between 0 and 1. Values in excess
of 1 are biologically unreasonable.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>cdb_flag(
  cdb,
  checks = c("check_NA_A", "check_NA_U", "check_NA_F", "check_NA_C", "check_zero_U",
    "check_zero_F", "check_zero_C", "check_zero_U_colsum", "check_singular_U",
    "check_component_sum", "check_ergodic", "check_irreducible", "check_primitive",
    "check_surv_gte_1")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_flag_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_flag_+3A_checks">checks</code></td>
<td>
<p>Character vector specifying which checks to run.
</p>
<p>Defaults to all, i.e. <code>c("check_NA_A", "check_NA_U", "check_NA_F",
  "check_NA_C", "check_zero_U", "check_singular_U", "check_component_sum",
  "check_ergodic", "check_irreducible", "check_primitive",
  "check_surv_gte_1")</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the flag <code>check_component_sum</code>, a value of <code>NA</code> will be
returned if the matrix sum of matU, matF, and matC consists only of zeros
and/or <code>NA</code>, indicating that the matrix has not been split.
</p>


<h3>Value</h3>

<p>Returns <code>cdb</code> with extra columns appended to the data slot
(columns have the same names as the corresponding elements of
<code>checks</code>) to indicate (TRUE/FALSE) whether there are potential
problems with the matrices corresponding to a given row of the data.
</p>


<h3>Author(s)</h3>

<p>Owen Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Julia Jones &lt;juliajones@biology.sdu.dk&gt;
</p>
<p>Roberto Salguero-Gomez &lt;rob.salguero@zoo.ox.ac.uk&gt;
</p>
<p>Danny Buss &lt;dlb50@cam.ac.uk&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>References</h3>

<p>Stott, I., Townley, S., &amp; Carslake, D. 2010. On reducibility and
ergodicity of population projection matrix models. Methods in Ecology and
Evolution. 1 (3), 242-252
</p>


<h3>See Also</h3>

<p>Other data checking: 
<code><a href="#topic+cdb_check_species">cdb_check_species</a>()</code>,
<code><a href="#topic+cdb_collapse">cdb_collapse</a>()</code>,
<code><a href="#topic+cdb_compare">cdb_compare</a>()</code>,
<code><a href="#topic+mpm_methods">mpm_methods</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CompadreFlag &lt;- cdb_flag(Compadre)

# only check whether matA has missing values, and whether matA is ergodic
CompadreFlag &lt;- cdb_flag(Compadre, checks = c("check_NA_A", "check_ergodic"))
</code></pre>

<hr>
<h2 id='cdb_flatten'>Convert a COM(P)ADRE database to a flat data frame with matrices and vectors
stored in string representation</h2><span id='topic+cdb_flatten'></span>

<h3>Description</h3>

<p>Converts a CompadreDB object to a flat data frame by extracting the data
slot, and splitting the <code>mat</code> column into separate columns for each
component (matrices <code>matA</code>, <code>matU</code>, <code>matF</code>, <code>matC</code>, and
vectors <code>MatrixClassAuthor</code>, and <code>MatrixClassOrganized</code>). The
component matrices and vectors within the six new columns are stored in
string format so that the database can be written to a flat file format such
as csv (see <a href="#topic+string_representation">string_representation</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_flatten(cdb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_flatten_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame based on the data slot of <code>cdb</code>, but with the
column <code>mat</code> replaced by six separate columns (for matrices
<code>matA</code>, <code>matU</code>, <code>matF</code>, <code>matC</code>, and vectors
<code>MatrixClassAuthor</code>, and <code>MatrixClassOrganized</code>), whose elements
are matrices or vectors in string representation.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_unflatten">cdb_unflatten</a> <a href="#topic+string_representation">string_representation</a>
</p>
<p>Other data management: 
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CompadreFlat &lt;- cdb_flatten(Compadre)

</code></pre>

<hr>
<h2 id='cdb_id'>Create integer identifiers for a COM(P)ADRE database corresponding to unique
combinations of a given set of columns</h2><span id='topic+cdb_id'></span>

<h3>Description</h3>

<p>Creates a vector of integer identifiers corresponding to the rows of a
CompadreDB object, based on unique combinations of the elements in a given
set of columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_id(cdb, columns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_id_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_id_+3A_columns">columns</code></td>
<td>
<p>Vector of column names from which unique combinations should
be identified</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Identifiers are assigned by pasting together the relevant columns, assigning
factor levels based on alphabetical order, and then converting the factor
levels to integers.
</p>


<h3>Value</h3>

<p>Vector of integer identifiers corresponding to the rows of
<code>cdb</code>, based on unique combinations of the elements in <code>columns</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cdb_id(Compadre, columns = c("SpeciesAuthor", "MatrixTreatment"))

</code></pre>

<hr>
<h2 id='cdb_id_stages'>Create integer identifiers for a COM(P)ADRE database corresponding to unique
combinations of species and matrix stage class definitions</h2><span id='topic+cdb_id_stages'></span>

<h3>Description</h3>

<p>Creates a vector of integer identifiers corresponding to the rows of a
CompadreDB object, based on unique combinations of the column
'SpeciesAccepted' and a list of matrix stage class definitions (either
'MatrixClassAuthor' or 'MatrixClassOrganized').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_id_stages(cdb, stage_def = "MatrixClassAuthor")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_id_stages_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_id_stages_+3A_stage_def">stage_def</code></td>
<td>
<p>Whether to define matrix stage class based on
&quot;MatrixClassAuthor&quot; or &quot;MatrixClassOrganized&quot; (see <em>Details</em>).
Defaults to &quot;MatrixClassAuthor&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector 'MatrixClassOrganized' reflects standardized stage classes
('prop', 'active', or 'dorm'), whereas 'MatrixClassAuthor' reflects a
description of the stage classes as defined by the original author (e.g.
<code>c('Seedling', 'Medium rosette', 'Large (2 rosettes)', 'Flowering')</code>).
</p>
<p>Because the 'MatrixClassAuthor' definitions are less standardized, they are
more prone to typos that could lead to slight differences between stage
descriptions of matrices that really do have the same stage classes (e.g. a
set of matrices from a single study/species/population). Therefore, using
'MatrixClassAuthor' to define stage classes is potentially prone to
mistakenly 'splitting' identifiers that should really be the same.
</p>
<p>'MatrixClassOrganized' has the opposite problem. It's possible for two
matrices from a given study to have the same stage definitions based on
'MatrixClassOrganized', but legitimately differ in stage definitions as
defined by the author. Therefore, using 'MatrixClassAuthor' to define stage
classes is potentially prone to mistakenly 'lumping' identifiers that should
actually differ.
</p>
<p>Because the majority of studies in COM(P)ADRE use a single set of stage
definitions for all matrices, and typos are rare, results for the different
stage definitions will usually be similar. Note, however, that the actual
integers returned for the different stage definitions are likely to be very
different (because they are based on alphabetical order).
</p>


<h3>Value</h3>

<p>Vector of integer identifiers corresponding to the rows of
<code>cdb</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_id">cdb_id</a>
</p>
<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cdb_id_stages(Compadre, stage_def = "MatrixClassOrganized")

</code></pre>

<hr>
<h2 id='cdb_id_studies'>Create a vector of unique study identifiers from a COM(P)ADRE database</h2><span id='topic+cdb_id_studies'></span>

<h3>Description</h3>

<p>Creates a vector of integer study identifiers corresponding to the rows of a
CompadreDB object, based on unique combinations of the columns 'Authors',
'Journal', 'YearPublication', and 'DOI_ISBN' (or optionally, a different set
of columns supplied by the user).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_id_studies(
  cdb,
  columns = c("Authors", "Journal", "YearPublication", "DOI_ISBN")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_id_studies_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_id_studies_+3A_columns">columns</code></td>
<td>
<p>Vector of column names from which unique combinations should
be identified. Defaults to <code>c("Authors", "Journal", "YearPublication",
"DOI_ISBN")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Identifiers are assigned by pasting together the relevant columns, assigning
factor levels based on alphabetical order, and then converting the factor
levels to integers.
</p>


<h3>Value</h3>

<p>Vector of integer study identifiers corresponding to the rows of
<code>cdb</code>, based on unique combinations of the elements in <code>columns</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_id">cdb_id</a>
</p>
<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Compadre$StudyID &lt;- cdb_id_studies(Compadre)

</code></pre>

<hr>
<h2 id='cdb_mean_matF'>Calculate a population-specific mean fecundity matrix for each set of
matrices in a COM(P)ADRE database</h2><span id='topic+cdb_mean_matF'></span>

<h3>Description</h3>

<p>Takes a CompadreDB object and calculates a grand mean fecundity matrix for
each unique population (a mean of all population-specific fecundity matrices,
including fecundity matrices for which <code>MatrixComposite == 'Mean'</code>).
</p>
<p>Populations are defined based on unique combinations of the columns
'SpeciesAuthor', 'MatrixPopulation', and 'MatrixDimension', (or optionally, a
different set of columns supplied by the user).
</p>
<p>The main purpose of this function is to identify stage classes that are
<em>potentially</em> reproductive (i.e. the absence of fecundity in a given
stage class and year does not necessarily indicate that the stage in question
is non-reproductive).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_mean_matF(
  cdb,
  columns = c("SpeciesAuthor", "MatrixPopulation", "MatrixDimension")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_mean_matF_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_mean_matF_+3A_columns">columns</code></td>
<td>
<p>Vector of column names from which unique populations should be
identified. Defaults to <code>c("SpeciesAuthor", "MatrixPopulation",
"MatrixDimension")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of matrices, representing the mean fecundity matrix
associated with each row of the database.
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Danny Buss &lt;dlb50@cam.ac.uk&gt;
</p>
<p>Julia Jones &lt;juliajones@biology.sdu.dk&gt;
</p>
<p>Iain Stott &lt;stott@biology.sdu.dk&gt;
</p>
<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># print matF associated with row 16 of database
Compadre$mat[[16]]

# create list of meanMatFs
meanF &lt;- cdb_mean_matF(Compadre)

# print meanMatF associated with row 16 of database
meanF[[16]]

</code></pre>

<hr>
<h2 id='cdb_metadata'>Extract metadata from a COM(P)ADRE database</h2><span id='topic+cdb_metadata'></span>

<h3>Description</h3>

<p>Extract a tibble with only metadata information from a CompadreDB object, by
dropping the matrix column &quot;mat&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_metadata(cdb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_metadata_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transforms the large CompadreDB object into a tibble and drops the
matrix column (&quot;mat&quot;).
</p>


<h3>Value</h3>

<p>Tibble with all metadata columns of <code>cdb</code>
</p>


<h3>Author(s)</h3>

<p>Gesa RÃ¶mer &lt;gesa.roemer@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data acquisition: 
<code><a href="#topic+cdb_build_cdb">cdb_build_cdb</a>()</code>,
<code><a href="#topic+cdb_fetch">cdb_fetch</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Compadre_metadata &lt;- cdb_metadata(Compadre)

</code></pre>

<hr>
<h2 id='cdb_rbind'>Merge two COM(P)ADRE databases via row-bind</h2><span id='topic+cdb_rbind'></span>

<h3>Description</h3>

<p>Merges two CompadreDB objects via a row-bind of the data slots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_rbind(cdb1, cdb2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_rbind_+3A_cdb1">cdb1</code>, <code id="cdb_rbind_+3A_cdb2">cdb2</code></td>
<td>
<p>CompadreDB objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A CompadreDB object created by binding the rows of <code>cdb1</code> and
<code>cdb2</code>
</p>


<h3>Author(s)</h3>

<p>Sam Levin &lt;levisc8@gmail.com&gt;
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Compadre1 &lt;- subset(Compadre, Continent == "Asia")
Compadre2 &lt;- subset(Compadre, Continent == "Africa")

cdb_rbind(Compadre1, Compadre2)

</code></pre>

<hr>
<h2 id='cdb_unflatten'>Reconstitute a flattened COM(P)ADRE database (created by cdb_flatten) as a
CompadreDB object</h2><span id='topic+cdb_unflatten'></span>

<h3>Description</h3>

<p>Converts a flattened COM(P)ADRE database (created by <a href="#topic+cdb_flatten">cdb_flatten</a>) back
to the CompadreDB class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdb_unflatten(db)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_unflatten_+3A_db">db</code></td>
<td>
<p>A data frame created with <a href="#topic+cdb_flatten">cdb_flatten</a>, with columns for
matrices <code>matA</code>, <code>matU</code>, <code>matF</code>, <code>matC</code>, and vectors
<code>MatrixClassAuthor</code>, and <code>MatrixClassOrganized</code> in string
representation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A CompadreDB object. Because version details are lost when the
database is flattened, the <code>Version</code> and <code>DateCreated</code> elements
of the returned CompadreDB object will be <code>NA</code>.
</p>


<h3>Author(s)</h3>

<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_flatten">cdb_flatten</a> <a href="#topic+string_representation">string_representation</a>
</p>
<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CompadreFlat &lt;- cdb_flatten(Compadre) # flatten
Compadre2 &lt;- cdb_unflatten(CompadreFlat) # reconstitute

</code></pre>

<hr>
<h2 id='cdb_unnest'>Unnest a COM(P)ADRE database by spreading the components of CompadreMat into
separate list-columns</h2><span id='topic+cdb_unnest'></span>

<h3>Description</h3>

<p>Unnests a CompadreDB object by spreading the components of CompadreMat into
separate list-columns. Components that may be extracted include:
</p>

<ul>
<li> <p><code>matA</code> (matrix)
</p>
</li>
<li> <p><code>matU</code> (matrix)
</p>
</li>
<li> <p><code>matF</code> (matrix)
</p>
</li>
<li> <p><code>matC</code> (matrix)
</p>
</li>
<li> <p><code>MatrixClassAuthor</code> (character vector)
</p>
</li>
<li> <p><code>MatrixClassOrganized</code> (character vector)
</p>
</li>
<li> <p><code>MatrixClassNumber</code> (integer vector)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>cdb_unnest(
  cdb,
  components = c("matA", "matU", "matF", "matC", "MatrixClassAuthor",
    "MatrixClassOrganized", "MatrixClassNumber")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdb_unnest_+3A_cdb">cdb</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="cdb_unnest_+3A_components">components</code></td>
<td>
<p>Character vector specifying which components to extract.
</p>
<p>Defaults to all, i.e. <code>c("matA", "matU", "matF", "matC",
  "MatrixClassAuthor", "MatrixClassOrganized", "MatrixClassNumber")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>cdb</code> with additional list-columns for each element of argument
<code>components</code>
</p>


<h3>Author(s)</h3>

<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># unnest all components
CompadreUnnest &lt;- cdb_unnest(Compadre)

# unnest select components (matU and MatrixClassAuthor)
CompadreUnnest &lt;- cdb_unnest(Compadre, c("matU", "MatrixClassAuthor"))

</code></pre>

<hr>
<h2 id='Compadre'>Subsamples of the COMPADRE Plant Matrix Database and COMADRE Animal
Matrix Database for testing and examples</h2><span id='topic+Compadre'></span><span id='topic+Comadre'></span>

<h3>Description</h3>

<p><code>Compadre</code> (plant matrices) and <code>Comadre</code> (animal matrices) are subsamples of
the COMPADRE Plant Matrix Database and COMADRE Animal Matrix Database,
respectively, that are used for testing and examples. Each object is of class
'CompadreDB' and therefore has the following two slots: <code>data</code> and <code>version</code>.
</p>
<p>For full documentation see the <a href="https://jonesor.github.io/CompadreGuides/">COMPADRE User Guide</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Compadre

Comadre
</code></pre>


<h3>Format</h3>

<p>Slot <strong>data</strong> - A tibble-style data frame with the following 48 columns:
</p>

<ul>
<li><p> mat - A list of 'CompadreMat' objects, each with the following slots:
</p>

<ul>
<li><p> matA - A matrix population model
</p>
</li>
<li><p> matU - The survival- and growth-related component of matA
</p>
</li>
<li><p> matF - The sexual reproduction component of matA
</p>
</li>
<li><p> matC - The clonal reproduction component of matA
</p>
</li>
<li><p> matrixClass - A data frame with the following columns:
</p>

<ul>
<li><p> MatrixClassOrganized - Standardized stage class of the matrix
population model
</p>
</li>
<li><p> MatrixClassAuthor - Stage description from the original publication
</p>
</li>
<li><p> MatrixClassNumber - Integer stage number
</p>
</li></ul>

</li></ul>

</li>
<li><p> SpeciesAuthor - Binomial species name given by the paper's author
</p>
</li>
<li><p> SpeciesAccepted - Accepted binomial species name taken from <em>The Plant
List</em> or <em>Catalogue of Life</em>
</p>
</li>
<li><p> CommonName - Common name for species used in the publication
</p>
</li>
<li><p> Genus - Taxonomic genus that the accepted species belongs to
</p>
</li>
<li><p> Family - Family that the species belongs to
</p>
</li>
<li><p> Order - Order that the species belongs to
</p>
</li>
<li><p> Class - Class that the species belongs to
</p>
</li>
<li><p> Phylum - Phylum that the species belongs to
</p>
</li>
<li><p> Kingdom - Kingdom that the species belongs to
</p>
</li>
<li><p> OrganismType - Organism type (see COMPADRE User Guide for documentation)
</p>
</li>
<li><p> DicotMonoc - Whether the species is a dicot or monocot. Non-angiosperms are
<code>NA</code>.
</p>
</li>
<li><p> AngioGymno - Whether the species is an angiosperm or gymnosperm. Non-plants
are <code>NA</code>.
</p>
</li>
<li><p> Authors - Last name of all authors (separated with &quot;;&quot;)
</p>
</li>
<li><p> Journal - Abbreviated journal title, or type of source document (e.g. &quot;PhD
thesis&quot;)
</p>
</li>
<li><p> YearPublication - Year of publication
</p>
</li>
<li><p> DOI.ISBN - Digital Object Identifier or International Standard Book Number
codes to identify each publication
</p>
</li>
<li><p> AdditionalSource - Additional source(s) used to reconstruct the matrix or
obtain additional metadata for the matrix (if applicable)
</p>
</li>
<li><p> StudyDuration - Number of years of observation in study (<code>StudyEnd - StudyStart</code>)
</p>
</li>
<li><p> StudyStart - Study start year
</p>
</li>
<li><p> StudyEnd - Study end year
</p>
</li>
<li><p> AnnualPeriodicity - Inverse of the length of the projection interval (in
years)
</p>
</li>
<li><p> NumberPopulations - The number of study populations as defined by the
authors. Within site replication of permanent plots is not defined as
separate populations
</p>
</li>
<li><p> MatrixCriteriaSize - Indicates whether the matrix contains stages based on
size. If so, indicates what that measure of size is
</p>
</li>
<li><p> MatrixCriteriaOntogeny - Indicates whether the matrix contains stages based
on ontogenic/developmental stages
</p>
</li>
<li><p> MatrixCriteriaAge - Indicates whether the matrix contains stages based on
age
</p>
</li>
<li><p> MatrixPopulation - Population name or definition of where the matrix was
recorded, usually given by the author. See COMPADRE User Guide.
</p>
</li>
<li><p> Lat - Latitude in decimal degrees
</p>
</li>
<li><p> Lon - Longitude in decimal degrees
</p>
</li>
<li><p> Altitude - Altitude of study site (m above sea level)
</p>
</li>
<li><p> Country - 3-letter ISO country code for the country in which the study took
place (multiple countries separated with &quot;;&quot;)
</p>
</li>
<li><p> Continent - Continent on which study took place
</p>
</li>
<li><p> Ecoregion - Ecoregion in which study took place. See COMPADRE User Guide.
</p>
</li>
<li><p> StudiedSex - Whether study included only males (&quot;M&quot;), only females (&quot;F&quot;),
or both sexes (&quot;M/F&quot;)
</p>
</li>
<li><p> MatrixComposite - Indicates the type of matrix population model. Possible
values are <code>Individual</code>, <code>Mean</code>, <code>Pooled</code>, and <code>Seasonal</code>. See COMPADRE
User Guide.
</p>
</li>
<li><p> MatrixTreatment - Describes if a treatment was applied to the population or
not. If yes, includes a brief description of the treatment. If not,
<code>Unmanipulated</code>
</p>
</li>
<li><p> MatrixCaptivity - Whether species was studied in the wild (<code>W</code>), captivity
(<code>C</code>), or captured from a wild population (<code>CW</code>)
</p>
</li>
<li><p> MatrixStartYear - First year of matrix
</p>
</li>
<li><p> MatrixStartSeason - First season of matrix as described by author
(hemisphere-specific)
</p>
</li>
<li><p> MatrixStartMonth - First month of matrix
</p>
</li>
<li><p> MatrixEndYear - Final year of matrix
</p>
</li>
<li><p> MatrixEndSeason - Final season of matrix as described by author
(hemisphere-specific)
</p>
</li>
<li><p> MatrixEndMonth - Final month of matrix
</p>
</li>
<li><p> MatrixSplit - Whether the <strong>A</strong> matrix has been split into components
<strong>U</strong>, <strong>F</strong>, and <strong>C</strong> (&quot;Divided&quot;) or not (&quot;Indivisible&quot;). If not,
elements of <code>matU</code>, <code>matF</code>, and <code>matC</code> are filled with <code>NA</code>
</p>
</li>
<li><p> MatrixFec - Whether fecundity was measured for the matrix model
</p>
</li>
<li><p> Observation - Additional observations recorded by database compilers
</p>
</li>
<li><p> MatrixDimension - Dimension of the <strong>A</strong> matrix
</p>
</li>
<li><p> SurvivalIssue - Denotes the maximum stage-specific survival value
<br />
</p>
</li></ul>

<p>Slot <strong>version</strong> - A list with the following elements:
</p>

<ul>
<li><p> Version - The version number of the database
</p>
</li>
<li><p> DateCreated - The date that the <code>.RData</code> file was created
</p>
</li>
<li><p> Agreement - Link to the COMADRE license agreement
</p>
</li></ul>

<p>An object of class <code>CompadreDB</code> with 150 rows and 49 columns.
</p>
<p>An object of class <code>CompadreDB</code> with 150 rows and 49 columns.
</p>

<hr>
<h2 id='CompadreDB'>CompadreDB Class</h2><span id='topic+CompadreDB'></span><span id='topic+CompadreData'></span><span id='topic+CompadreData+2CCompadreDB-method'></span><span id='topic++24+2CCompadreDB-method'></span><span id='topic++24+3C-+2CCompadreDB-method'></span><span id='topic++5B+5B+2CCompadreDB+2CANY+2Cmissing-method'></span><span id='topic++5B+5B+3C-+2CCompadreDB+2CANY+2Cmissing-method'></span><span id='topic+VersionData'></span><span id='topic+VersionData+2CCompadreDB-method'></span><span id='topic+Version'></span><span id='topic+Version+2CCompadreDB-method'></span><span id='topic+DateCreated'></span><span id='topic+DateCreated+2CCompadreDB-method'></span>

<h3>Description</h3>

<p>This page describes the CompadreDB class, including methods for accessing the
slots (see functions <code>CompadreData</code> and <code>VersionData</code>), accessing
(<code>$</code>) and replacing (<code>$&lt;-</code>) columns within the <code>data</code> slot,
accessing elements from the <code>version</code> slot (see functions
<code>VersionData</code> and <code>DateCreated</code>), and converting legacy database
objects to the CompadreDB class (see <code>as_cdb</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompadreData(object)

## S4 method for signature 'CompadreDB'
CompadreData(object)

## S4 method for signature 'CompadreDB'
x$name

## S4 replacement method for signature 'CompadreDB'
x$name &lt;- value

## S4 method for signature 'CompadreDB,ANY,missing'
x[[i, j, ...]]

## S4 replacement method for signature 'CompadreDB,ANY,missing'
x[[i, j]] &lt;- value

VersionData(object)

## S4 method for signature 'CompadreDB'
VersionData(object)

Version(object)

## S4 method for signature 'CompadreDB'
Version(object)

DateCreated(object)

## S4 method for signature 'CompadreDB'
DateCreated(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompadreDB_+3A_object">object</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="CompadreDB_+3A_x">x</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="CompadreDB_+3A_name">name</code></td>
<td>
<p>The name of a column within x</p>
</td></tr>
<tr><td><code id="CompadreDB_+3A_value">value</code></td>
<td>
<p>Vector of values to assign to the column</p>
</td></tr>
<tr><td><code id="CompadreDB_+3A_i">i</code>, <code id="CompadreDB_+3A_j">j</code></td>
<td>
<p>elements to extract or replace (see <a href="base.html#topic++5B+5B.data.frame">[[.data.frame</a>)</p>
</td></tr>
<tr><td><code id="CompadreDB_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>A tibble-style data frame with a list-column of matrix population
models (column <code>mat</code>) and a variety of other metadata columns.</p>
</dd>
<dt><code>version</code></dt><dd><p>A list with elements <code>Version</code> (database version number),
<code>DateCreated</code> (date of version release), and <code>Agreement</code> (a url
link to the User Agreement)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Iain M. Stott
</p>
<p>Tamora D. James
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CompadreDB-Methods">CompadreDB-Methods</a></code> <code><a href="#topic+CompadreDB-Subsetting">CompadreDB-Subsetting</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># extract entire 'data' slot
dat &lt;- CompadreData(Compadre)

# access the date of database creation
DateCreated(Compadre)

# extract column SpeciesAccepted
Compadre$SpeciesAccepted

# create new list-column with stage-specific survival
Compadre$stage_survival &lt;- lapply(Compadre$mat, function(x) colSums(x@matU))
</code></pre>

<hr>
<h2 id='CompadreDB-Methods'>Methods for CompadreDB objects</h2><span id='topic+CompadreDB-Methods'></span><span id='topic+as.data.frame.CompadreDB'></span><span id='topic+as_tibble.CompadreDB'></span><span id='topic+head.CompadreDB'></span><span id='topic+tail.CompadreDB'></span><span id='topic+names.CompadreDB'></span><span id='topic+dim.CompadreDB'></span><span id='topic+merge.CompadreDB'></span><span id='topic+NumberAcceptedSpecies'></span><span id='topic+NumberAcceptedSpecies+2CCompadreDB-method'></span><span id='topic+NumberStudies'></span><span id='topic+NumberStudies+2CCompadreDB-method'></span><span id='topic+NumberMatrices'></span><span id='topic+NumberMatrices+2CCompadreDB-method'></span>

<h3>Description</h3>

<p>This page describes a variety of methods that can be used with CompadreDB
objects, including common data frame operations (<code>head</code>, <code>names</code>,
and <code>merge</code>), conversion methods (<code>as.data.frame</code> and
<code>as_tibble</code>), and methods to calculate the number of species
(<code>NumberAcceptedSpecies</code>), studies (<code>NumberStudies</code>), or matrices
(<code>NumberMatrices</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CompadreDB'
as.data.frame(x, ...)

## S3 method for class 'CompadreDB'
as_tibble(
  x,
  .rows = NULL,
  .name_repair = c("check_unique", "unique", "universal", "minimal"),
  rownames = NULL,
  ...
)

## S3 method for class 'CompadreDB'
head(x, n = 6L, ...)

## S3 method for class 'CompadreDB'
tail(x, n = 6L, ...)

## S3 method for class 'CompadreDB'
names(x)

## S3 method for class 'CompadreDB'
dim(x)

## S3 method for class 'CompadreDB'
merge(x, y, ...)

NumberAcceptedSpecies(object)

## S4 method for signature 'CompadreDB'
NumberAcceptedSpecies(object)

NumberStudies(object)

## S4 method for signature 'CompadreDB'
NumberStudies(object)

NumberMatrices(object)

## S4 method for signature 'CompadreDB'
NumberMatrices(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompadreDB-Methods_+3A_x">x</code>, <code id="CompadreDB-Methods_+3A_object">object</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_.rows">.rows</code></td>
<td>
<p>passed to [tibble::as_tibble()]</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_.name_repair">.name_repair</code></td>
<td>
<p>passed to [tibble::as_tibble()]</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_rownames">rownames</code></td>
<td>
<p>passed to [tibble::as_tibble()]</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_n">n</code></td>
<td>
<p>The number of rows to extract</p>
</td></tr>
<tr><td><code id="CompadreDB-Methods_+3A_y">y</code></td>
<td>
<p>A data.frame to merge with x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='CompadreDB-Subsetting'>Subsetting CompadreDB objects</h2><span id='topic+CompadreDB-Subsetting'></span><span id='topic++5B+2CCompadreDB+2CANY+2CANY+2CANY-method'></span><span id='topic+subset.CompadreDB'></span>

<h3>Description</h3>

<p><code>CompadreDB</code> objects can be subset just like a regular
<code>data.frame</code>, using either <code>[</code> or <code>subset()</code>. Note, however,
that the <code>mat</code> column will always be retained during subsetting, even if
it is not included in the user's column subset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'CompadreDB,ANY,ANY,ANY'
x[i, j, ..., drop = FALSE]

## S3 method for class 'CompadreDB'
subset(x, subset, select, drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompadreDB-Subsetting_+3A_x">x</code></td>
<td>
<p>A <code>CompadreDB</code> object</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_i">i</code></td>
<td>
<p>row indices (see <a href="base.html#topic++5B.data.frame">[.data.frame</a>)</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_j">j</code></td>
<td>
<p>column indices (see <a href="base.html#topic++5B.data.frame">[.data.frame</a>)</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_drop">drop</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_subset">subset</code></td>
<td>
<p>logical expression indicating which rows to keep</p>
</td></tr>
<tr><td><code id="CompadreDB-Subsetting_+3A_select">select</code></td>
<td>
<p>expression indicating which columns to keep</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'># subset to the first 10 rows
Compadre[1:10, ]

# subset to the species 'Echinacea angustifolia'
subset(Compadre, SpeciesAccepted == "Echinacea angustifolia")

# remove the column SurvivalIssue
Compadre[, names(Compadre) != "SurvivalIssue"]

## Not run: 
# column selection doesn't include mat, but mat will still be returned with a
#  along with a warning
subset(Compadre, select = c("SpeciesAccepted", "Authors"))

## End(Not run)
</code></pre>

<hr>
<h2 id='CompadreDB-Tidyverse'>Tidyverse methods for CompadreDB objects</h2><span id='topic+CompadreDB-Tidyverse'></span><span id='topic+fortify.CompadreDB'></span><span id='topic+filter.CompadreDB'></span><span id='topic+slice.CompadreDB'></span><span id='topic+arrange.CompadreDB'></span><span id='topic+mutate.CompadreDB'></span><span id='topic+group_by.CompadreDB'></span><span id='topic+ungroup.CompadreDB'></span><span id='topic+summarize.CompadreDB'></span><span id='topic+summarise.CompadreDB'></span><span id='topic+select.CompadreDB'></span><span id='topic+rename.CompadreDB'></span><span id='topic+left_join.CompadreDB'></span><span id='topic+right_join.CompadreDB'></span><span id='topic+inner_join.CompadreDB'></span><span id='topic+full_join.CompadreDB'></span>

<h3>Description</h3>

<p>CompadreDB methods for functions in <a href="dplyr.html#topic+dplyr">dplyr</a> and
<a href="ggplot2.html#topic+ggplot2">ggplot2</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fortify.CompadreDB(model, data, ...)

filter.CompadreDB(.data, ...)

slice.CompadreDB(.data, ...)

arrange.CompadreDB(.data, ...)

mutate.CompadreDB(.data, ...)

group_by.CompadreDB(.data, ..., add = FALSE)

ungroup.CompadreDB(x, ...)

summarize.CompadreDB(.data, ...)

summarise.CompadreDB(.data, ...)

select.CompadreDB(.data, ...)

rename.CompadreDB(.data, ...)

left_join.CompadreDB(
  x,
  y,
  by = NULL,
  copy = FALSE,
  suffix = c(".x", ".y"),
  ...
)

right_join.CompadreDB(
  x,
  y,
  by = NULL,
  copy = FALSE,
  suffix = c(".x", ".y"),
  ...
)

inner_join.CompadreDB(
  x,
  y,
  by = NULL,
  copy = FALSE,
  suffix = c(".x", ".y"),
  ...
)

full_join.CompadreDB(
  x,
  y,
  by = NULL,
  copy = FALSE,
  suffix = c(".x", ".y"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompadreDB-Tidyverse_+3A_data">data</code></td>
<td>
<p>see <code><a href="ggplot2.html#topic+fortify">fortify</a></code></p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_add">add</code></td>
<td>
<p>Logical indicating whether to overwrite existing groups
(<code>FALSE</code>) or add to any existing groups (<code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_x">x</code>, <code id="CompadreDB-Tidyverse_+3A_model">model</code>, <code id="CompadreDB-Tidyverse_+3A_.data">.data</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_y">y</code></td>
<td>
<p>see <code><a href="dplyr.html#topic+join">join</a></code></p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_by">by</code></td>
<td>
<p>see <code><a href="dplyr.html#topic+join">join</a></code></p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_copy">copy</code></td>
<td>
<p>see <code><a href="dplyr.html#topic+join">join</a></code></p>
</td></tr>
<tr><td><code id="CompadreDB-Tidyverse_+3A_suffix">suffix</code></td>
<td>
<p>see <code><a href="dplyr.html#topic+join">join</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='CompadreLegacy'>Subsample of a legacy version of the COMPADRE Plant Matrix Database for
testing and examples</h2><span id='topic+CompadreLegacy'></span>

<h3>Description</h3>

<p><code>CompadreLegacy</code> is a subsample of the COMPADRE Plant Matrix Database in the
legacy format (class 'list'), for use in testing and examples. For full
documentation see the <a href="https://jonesor.github.io/CompadreGuides/">COMPADRE User Guide</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CompadreLegacy
</code></pre>


<h3>Format</h3>

<p>A list with four elements:
</p>
<p><strong>metadata</strong> - A data frame with the following 47 columns:
</p>

<ul>
<li><p> SpeciesAuthor - Binomial species name given by the paper's author
</p>
</li>
<li><p> SpeciesAccepted - Accepted binomial species name taken from <em>The Plant
List</em> or <em>Catalogue of Life</em>
</p>
</li>
<li><p> CommonName - Common name for species used in the publication
</p>
</li>
<li><p> Genus - Taxonomic genus that the accepted species belongs to
</p>
</li>
<li><p> Family - Family that the species belongs to
</p>
</li>
<li><p> Order - Order that the species belongs to
</p>
</li>
<li><p> Class - Class that the species belongs to
</p>
</li>
<li><p> Phylum - Phylum that the species belongs to
</p>
</li>
<li><p> Kingdom - Kingdom that the species belongs to
</p>
</li>
<li><p> OrganismType - Organism type (see COMPADRE User Guide for documentation)
</p>
</li>
<li><p> DicotMonoc - Whether the species is a dicot or monocot. Non-angiosperms are
<code>NA</code>.
</p>
</li>
<li><p> AngioGymno - Whether the species is an angiosperm or gymnosperm. Non-plants
are <code>NA</code>.
</p>
</li>
<li><p> Authors - Last name of all authors (separated with &quot;;&quot;)
</p>
</li>
<li><p> Journal - Abbreviated journal title, or type of source document (e.g. &quot;PhD
thesis&quot;)
</p>
</li>
<li><p> YearPublication - Year of publication
</p>
</li>
<li><p> DOI.ISBN - Digital Object Identifier or International Standard Book Number
codes to identify each publication (note that the name has changed to
DOI_ISBN in later database versions.)
</p>
</li>
<li><p> AdditionalSource - Additional source(s) used to reconstruct the matrix or
obtain additional metadata for the matrix (if applicable)
</p>
</li>
<li><p> StudyDuration - Number of years of observation in study (<code>StudyEnd - StudyStart</code>)
</p>
</li>
<li><p> StudyStart - Study start year
</p>
</li>
<li><p> StudyEnd - Study end year
</p>
</li>
<li><p> AnnualPeriodicity - Inverse of the length of the projection interval (in
years). Note that the name has changed to ProjectionInterval in later
database versions.
</p>
</li>
<li><p> NumberPopulations - The number of study populations as defined by the
authors. Within site replication of permanent plots is not defined as
separate populations
</p>
</li>
<li><p> MatrixCriteriaSize - Indicates whether the matrix contains stages based on
size. If so, indicates what that measure of size is
</p>
</li>
<li><p> MatrixCriteriaOntogeny - Indicates whether the matrix contains stages based
on ontogenic/developmental stages
</p>
</li>
<li><p> MatrixCriteriaAge - Indicates whether the matrix contains stages based on
age
</p>
</li>
<li><p> MatrixPopulation - Population name or definition of where the matrix was
recorded, usually given by the author. See COMPADRE User Guide.
</p>
</li>
<li><p> Lat - Latitude in decimal degrees
</p>
</li>
<li><p> Lon - Longitude in decimal degrees
</p>
</li>
<li><p> Altitude - Altitude of study site (m above sea level)
</p>
</li>
<li><p> Country - 3-letter ISO country code for the country in which the study took
place (multiple countries separated with &quot;;&quot;)
</p>
</li>
<li><p> Continent - Continent on which study took place
</p>
</li>
<li><p> Ecoregion - Ecoregion in which study took place. See COMPADRE User Guide.
</p>
</li>
<li><p> StudiedSex - Whether study included only males (&quot;M&quot;), only females (&quot;F&quot;),
or both sexes (&quot;M/F&quot;)
</p>
</li>
<li><p> MatrixComposite - Indicates the type of matrix population model. Possible
values are <code>Individual</code>, <code>Mean</code>, <code>Pooled</code>, and <code>Seasonal</code>. See COMPADRE
User Guide.
</p>
</li>
<li><p> MatrixTreatment - Describes if a treatment was applied to the population or
not. If yes, includes a brief description of the treatment. If not,
<code>Unmanipulated</code>
</p>
</li>
<li><p> MatrixCaptivity - Whether species was studied in the wild (<code>W</code>), captivity
(<code>C</code>), or captured from a wild population (<code>CW</code>)
</p>
</li>
<li><p> MatrixStartYear - First year of matrix
</p>
</li>
<li><p> MatrixStartSeason - First season of matrix as described by author
(hemisphere-specific)
</p>
</li>
<li><p> MatrixStartMonth - First month of matrix
</p>
</li>
<li><p> MatrixEndYear - Final year of matrix
</p>
</li>
<li><p> MatrixEndSeason - Final season of matrix as described by author
(hemisphere-specific)
</p>
</li>
<li><p> MatrixEndMonth - Final month of matrix
</p>
</li>
<li><p> MatrixSplit - Whether the <strong>A</strong> matrix has been split into components
<strong>U</strong>, <strong>F</strong>, and <strong>C</strong> (&quot;Divided&quot;) or not (&quot;Indivisible&quot;). If not,
elements of <code>matU</code>, <code>matF</code>, and <code>matC</code> are filled with <code>NA</code>
</p>
</li>
<li><p> MatrixFec - Whether fecundity was measured for the matrix model
</p>
</li>
<li><p> Observation - Additional observations recorded by database compilers
</p>
</li>
<li><p> MatrixDimension - Dimension of the <strong>A</strong> matrix
</p>
</li>
<li><p> SurvivalIssue - Denotes the maximum stage-specific survival value
</p>
</li></ul>

<p><strong>mat</strong> - A list of population projection models, which are also
in list format. Each list element contains four matrices:
</p>

<ul>
<li><p> matA - A matrix population model
</p>
</li>
<li><p> matU - The survival- and growth-related component of matA
</p>
</li>
<li><p> matF - The sexual reproduction component of matA
</p>
</li>
<li><p> matC - The clonal reproduction component of matA
</p>
</li></ul>

<p><strong>matrixClass</strong> - A list of data frames, each with the following columns:
</p>

<ul>
<li><p> MatrixClassOrganized - Standardized stage class of the matrix population
model
</p>
</li>
<li><p> MatrixClassAuthor - Stage description from the original publication
</p>
</li>
<li><p> MatrixClassNumber - Integer stage number
</p>
</li></ul>

<p><strong>version</strong> - A list with the following elements:
</p>

<ul>
<li><p> Version - The version number of the database
</p>
</li>
<li><p> DateCreated - The date that the <code>.RData</code> file was created
</p>
</li>
<li><p> NumberAcceptedSpecies - The number of accepted species in the original
version
</p>
</li>
<li><p> NumberStudies - The number of studies in the original version
</p>
</li>
<li><p> NumberMatrices - The number of matrices in the original version
</p>
</li>
<li><p> Agreement - Link to the COMADRE license agreement
</p>
</li></ul>


<hr>
<h2 id='CompadreMatrixMethods'>Methods for working with matrices in com(p)adre</h2><span id='topic+CompadreMatrixMethods'></span><span id='topic+matA'></span><span id='topic+matA+2CCompadreMat-method'></span><span id='topic+matA+2CCompadreDB-method'></span><span id='topic+matA+2Clist-method'></span><span id='topic+matU'></span><span id='topic+matU+2CCompadreMat-method'></span><span id='topic+matU+2CCompadreDB-method'></span><span id='topic+matU+2Clist-method'></span><span id='topic+matF'></span><span id='topic+matF+2CCompadreMat-method'></span><span id='topic+matF+2CCompadreDB-method'></span><span id='topic+matF+2Clist-method'></span><span id='topic+matC'></span><span id='topic+matC+2CCompadreMat-method'></span><span id='topic+matC+2CCompadreDB-method'></span><span id='topic+matC+2Clist-method'></span><span id='topic+matrixClass'></span><span id='topic+matrixClass+2CCompadreMat-method'></span><span id='topic+matrixClass+2CCompadreDB-method'></span><span id='topic+matrixClass+2Clist-method'></span><span id='topic+MatrixClassAuthor'></span><span id='topic+MatrixClassAuthor+2CCompadreMat-method'></span><span id='topic+MatrixClassAuthor+2CCompadreDB-method'></span><span id='topic+MatrixClassAuthor+2Clist-method'></span><span id='topic+MatrixClassOrganized'></span><span id='topic+MatrixClassOrganized+2CCompadreMat-method'></span><span id='topic+MatrixClassOrganized+2CCompadreDB-method'></span><span id='topic+MatrixClassOrganized+2Clist-method'></span><span id='topic+MatrixClassNumber'></span><span id='topic+MatrixClassNumber+2CCompadreMat-method'></span><span id='topic+MatrixClassNumber+2CCompadreDB-method'></span><span id='topic+MatrixClassNumber+2Clist-method'></span>

<h3>Description</h3>

<p>This page describes methods for accessing any matrix information from
CompadreMat and CompadreDB objects.
</p>
<p>Most methods for working with matrices are applicable to both CompadreMat and
CompadreDB objects. These are described on this page (along with a couple)
of methods applicable to only CompadreMat or CompadreDB objects).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matA(object)

## S4 method for signature 'CompadreMat'
matA(object)

## S4 method for signature 'CompadreDB'
matA(object)

## S4 method for signature 'list'
matA(object)

matU(object)

## S4 method for signature 'CompadreMat'
matU(object)

## S4 method for signature 'CompadreDB'
matU(object)

## S4 method for signature 'list'
matU(object)

matF(object)

## S4 method for signature 'CompadreMat'
matF(object)

## S4 method for signature 'CompadreDB'
matF(object)

## S4 method for signature 'list'
matF(object)

matC(object)

## S4 method for signature 'CompadreMat'
matC(object)

## S4 method for signature 'CompadreDB'
matC(object)

## S4 method for signature 'list'
matC(object)

matrixClass(object)

## S4 method for signature 'CompadreMat'
matrixClass(object)

## S4 method for signature 'CompadreDB'
matrixClass(object)

## S4 method for signature 'list'
matrixClass(object)

MatrixClassAuthor(object)

## S4 method for signature 'CompadreMat'
MatrixClassAuthor(object)

## S4 method for signature 'CompadreDB'
MatrixClassAuthor(object)

## S4 method for signature 'list'
MatrixClassAuthor(object)

MatrixClassOrganized(object)

## S4 method for signature 'CompadreMat'
MatrixClassOrganized(object)

## S4 method for signature 'CompadreDB'
MatrixClassOrganized(object)

## S4 method for signature 'list'
MatrixClassOrganized(object)

MatrixClassNumber(object)

## S4 method for signature 'CompadreMat'
MatrixClassNumber(object)

## S4 method for signature 'CompadreDB'
MatrixClassNumber(object)

## S4 method for signature 'list'
MatrixClassNumber(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompadreMatrixMethods_+3A_object">object</code></td>
<td>
<p>A CompadreDB object</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>matA</code></dt><dd><p>A matrix population model (i.e. a square projection matrix)</p>
</dd>
<dt><code>matU</code></dt><dd><p>The survival component of a matrix population model (i.e. a square
projection matrix reflecting survival-related transitions; e.g.
progression, stasis, and retrogression)</p>
</dd>
<dt><code>matF</code></dt><dd><p>The sexual component of a matrix population model (i.e. a square
projection matrix reflecting transitions due to sexual reproduction)</p>
</dd>
<dt><code>matC</code></dt><dd><p>The clonal component of a matrix population model (i.e. a square
projection matrix reflecting transitions due to clonal reproduction)</p>
</dd>
<dt><code>matrixClass</code></dt><dd><p>A data frame with columns <code>MatrixClassOrganized</code>
(elements are &quot;active&quot;, &quot;prop&quot;, or &quot;dorm&quot;) <code>MatrixClassAuthor</code> (the
matrix author's stage description), and <code>MatrixClassNumber</code> (integer
stage number)</p>
</dd>
</dl>

<hr>
<h2 id='mpm_mean'>Calculate a mean over a list of matrices or CompadreMat objects</h2><span id='topic+mpm_mean'></span><span id='topic+mat_mean'></span>

<h3>Description</h3>

<p>Calculates an element-wise mean over a list of matrices or CompadreMat
objects of constant dimension. 
</p>
<p>The difference between function <code>mat_mean</code>) and (<code>mpm_mean</code> is that
<code>mat_mean</code> takes input as a list of matrices (e.g., a list of **A**
matrices) while <code>mat_mean</code> takes input as a list of 'CompadreMat' objects and
thus calculates the mean matrices for both the **A** matrix and its
submatrices (**U**, **F**, **C**).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat_mean(x, na.rm = FALSE)

mpm_mean(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpm_mean_+3A_x">x</code></td>
<td>
<p>A list of matrices or, for <code>mpm_mean</code> a list of 'CompadreMat' objects,
all of the same dimension</p>
</td></tr>
<tr><td><code id="mpm_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether missing values should be excluded
(see <em>Details</em>). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>na.rm == TRUE</code>, missing values are ignored in the calculation of the
mean matrix. If <code>na.rm == TRUE</code> and a given element is <code>NA</code> in
<em>every</em> matrix within <code>x</code>, the value returned for that element will
be <code>0</code>.
</p>


<h3>Value</h3>

<p>A matrix (<code>mat_mean</code>) or a CompadreMat object (<code>mpm_mean</code>).
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># there are four rows for species 'Haplopappus_radiatus' in Compadre
mpms &lt;- Compadre$mat[Compadre$SpeciesAuthor == "Haplopappus_radiatus"]

#The object mpms is a list, containing compadre objects
class(mpms)
class(mpms[[1]])

mpm_mean(mpms)

# extract list of matA and take mean
mats &lt;- matA(mpms)
mat_mean(mats)
</code></pre>

<hr>
<h2 id='mpm_median'>Calculate a median over a list of matrices or CompadreMat objects</h2><span id='topic+mpm_median'></span><span id='topic+mat_median'></span>

<h3>Description</h3>

<p>Calculates an element-wise median over a list of matrices or
CompadreMat objects of constant dimension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat_median(x, na.rm = FALSE)

mpm_median(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpm_median_+3A_x">x</code></td>
<td>
<p>A list of matrices or, for <code>mpm_sd</code> a list of 'CompadreMat' objects,
all of the same dimension</p>
</td></tr>
<tr><td><code id="mpm_median_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether missing values should be excluded
(see <em>Details</em>). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The difference between function <code>mat_median</code>) and (<code>mpm_median</code> is that
<code>mat_median</code> takes input as a list of matrices (e.g., a list of **A**
matrices) while <code>mat_median</code> takes input as a list of 'CompadreMat' objects and
thus calculates the mean matrices for both the **A** matrix and its
submatrices (**U**, **F**, **C**).
</p>
<p>If <code>na.rm == TRUE</code>, missing values are ignored in the calculation of the
mean matrix. If <code>na.rm == TRUE</code> and a given element is <code>NA</code> in
<em>every</em> matrix within <code>x</code>, the value returned for that element will
be <code>0</code>.
</p>


<h3>Value</h3>

<p>A matrix containing the median of each element across all matrices in
the list
</p>


<h3>Author(s)</h3>

<p>Darren Norris
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for repeatability
set.seed(42)

# create a function that generates a matrix with random values
create_matrix &lt;- function() {
  matrix(runif(9, 0, 1), nrow = 3)
}

# use replicate() to call the create_matrix() function 20 times
mat_list &lt;- replicate(20, create_matrix(), simplify = FALSE)

# get the median matrix
mat_median(mat_list)

# If the matrices are in an RCompadre object, extract them using `matA` before
# passing to `mat_median`
my_compadre &lt;- cdb_build_cdb(mat_a = mat_list)
mat_median(matA(my_compadre))
</code></pre>

<hr>
<h2 id='mpm_methods'>Extract stage-class information from CompadreMat or CompadreDB objects</h2><span id='topic+mpm_methods'></span><span id='topic+mpm_has_prop'></span><span id='topic+mpm_has_prop+2CCompadreMat-method'></span><span id='topic+mpm_has_prop+2CCompadreDB-method'></span><span id='topic+mpm_has_active'></span><span id='topic+mpm_has_active+2CCompadreMat-method'></span><span id='topic+mpm_has_active+2CCompadreDB-method'></span><span id='topic+mpm_has_dorm'></span><span id='topic+mpm_has_dorm+2CCompadreMat-method'></span><span id='topic+mpm_has_dorm+2CCompadreDB-method'></span><span id='topic+mpm_first_active'></span><span id='topic+mpm_first_active+2CCompadreMat-method'></span><span id='topic+mpm_first_active+2CCompadreDB-method'></span>

<h3>Description</h3>

<p>Methods for extracting stage-class information from CompadreMat or CompadreDB
objects, including whether the matrix population model includes one or more
propagule stages (<code>mpm_has_prop</code>), dormant stages (<code>mpm_has_dorm</code>),
or active stages (<code>mpm_has_active</code>), and the integer index of the first
active stage class (<code>mpm_first_active</code>).
</p>
<p>These methods will return a single value if passed a CompadreMat object, or a
vector of values if passed a CompadreDB object (one value for every
CompadreMat object within the column 'mat').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpm_has_prop(object)

## S4 method for signature 'CompadreMat'
mpm_has_prop(object)

## S4 method for signature 'CompadreDB'
mpm_has_prop(object)

mpm_has_active(object)

## S4 method for signature 'CompadreMat'
mpm_has_active(object)

## S4 method for signature 'CompadreDB'
mpm_has_active(object)

mpm_has_dorm(object)

## S4 method for signature 'CompadreMat'
mpm_has_dorm(object)

## S4 method for signature 'CompadreDB'
mpm_has_dorm(object)

mpm_first_active(object)

## S4 method for signature 'CompadreMat'
mpm_first_active(object)

## S4 method for signature 'CompadreDB'
mpm_first_active(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpm_methods_+3A_object">object</code></td>
<td>
<p>A CompadreMat or CompadreDB object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Patrick Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p>Other data checking: 
<code><a href="#topic+cdb_check_species">cdb_check_species</a>()</code>,
<code><a href="#topic+cdb_collapse">cdb_collapse</a>()</code>,
<code><a href="#topic+cdb_compare">cdb_compare</a>()</code>,
<code><a href="#topic+cdb_flag">cdb_flag</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># with CompadreMat object
mpm_has_prop(Compadre$mat[[1]])
mpm_has_active(Compadre$mat[[1]])
mpm_has_dorm(Compadre$mat[[1]])
mpm_first_active(Compadre$mat[[1]])

# with CompadreDB object
mpm_has_prop(Compadre)
mpm_has_active(Compadre)
mpm_has_dorm(Compadre)
mpm_first_active(Compadre)

</code></pre>

<hr>
<h2 id='mpm_sd'>Calculate a standard deviation over a list of matrices or CompadreMat objects</h2><span id='topic+mpm_sd'></span><span id='topic+mat_sd'></span>

<h3>Description</h3>

<p>Calculates an element-wise standard deviation over a list of matrices or
CompadreMat objects of constant dimension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat_sd(x, na.rm = FALSE)

mpm_sd(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpm_sd_+3A_x">x</code></td>
<td>
<p>A list of matrices or, for <code>mpm_sd</code> a list of 'CompadreMat' objects,
all of the same dimension</p>
</td></tr>
<tr><td><code id="mpm_sd_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical indicating whether missing values should be excluded
(see <em>Details</em>). Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The difference between function <code>mat_sd</code>) and (<code>mpm_sd</code> is that
<code>mat_sd</code> takes input as a list of matrices (e.g., a list of **A**
matrices) while <code>mat_sd</code> takes input as a list of 'CompadreMat' objects and
thus calculates the mean matrices for both the **A** matrix and its
submatrices (**U**, **F**, **C**).
</p>
<p>If <code>na.rm == TRUE</code>, missing values are ignored in the calculation of the
mean matrix. If <code>na.rm == TRUE</code> and a given element is <code>NA</code> in
<em>every</em> matrix within <code>x</code>, the value returned for that element will
be <code>0</code>.
</p>


<h3>Value</h3>

<p>A matrix containing the standard deviation of each element across all
matrices in the list
</p>


<h3>Author(s)</h3>

<p>Darren Norris
</p>
<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>


<h3>See Also</h3>

<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+string_representation">string_representation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set seed for repeatability
set.seed(42)

# create a function that generates a matrix with random values
create_matrix &lt;- function() {
  matrix(runif(9, 0, 1), nrow = 3)
}

# use replicate() to call the create_matrix() function 20 times
mat_list &lt;- replicate(20, create_matrix(), simplify = FALSE)

# get the sd matrix
mat_sd(mat_list)

# If the matrices are in an RCompadre object, extract them using `matA` before
# passing to `mat_sd`
my_compadre &lt;- cdb_build_cdb(mat_a = mat_list)
mat_sd(matA(my_compadre))
</code></pre>

<hr>
<h2 id='string_representation'>Convert vectors or square numeric matrices to and from string representation</h2><span id='topic+string_representation'></span><span id='topic+mat_to_string'></span><span id='topic+vec_to_string'></span><span id='topic+string_to_mat'></span><span id='topic+string_to_vec'></span>

<h3>Description</h3>

<p>Functions to convert vectors or square numeric matrices to and from string
representation, which is primarily useful for writing data frames with
list-columns containing vectors or matrices to a flat file format such as
csv.
</p>
<p>String representations of vectors and matrices begin with an open bracket
(&quot;[&quot;) and end with a closed bracket (&quot;]&quot;). Matrix elements are separated with
a space (&quot;[0.2 0.3 0.1 0]&quot;) whereas vector elements are separate with two
vertical bars (&quot;[Seedling||Juvenile||Reproductive]&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat_to_string(mat)

vec_to_string(vec)

string_to_mat(mat_str)

string_to_vec(vec_str, numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string_representation_+3A_mat">mat</code></td>
<td>
<p>A square numeric matrix</p>
</td></tr>
<tr><td><code id="string_representation_+3A_vec">vec</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id="string_representation_+3A_mat_str">mat_str</code></td>
<td>
<p>A square numeric matrix in string representation</p>
</td></tr>
<tr><td><code id="string_representation_+3A_vec_str">vec_str</code></td>
<td>
<p>A vector in string representation</p>
</td></tr>
<tr><td><code id="string_representation_+3A_numeric">numeric</code></td>
<td>
<p>Logical value indicating whether a string representation of a
vector should be coerced to numeric (if FALSE remains character)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A square numeric matrix (<code>string_to_mat</code>), vector
(<code>string_to_vec</code>), or string (<code>mat_to_string</code> or
<code>vec_to_string</code>).
</p>


<h3>Author(s)</h3>

<p>Owen R. Jones &lt;jones@biology.sdu.dk&gt;
</p>
<p>Patrick M. Barks &lt;patrick.barks@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><a href="#topic+cdb_flatten">cdb_flatten</a> <a href="#topic+cdb_unflatten">cdb_unflatten</a>
</p>
<p>Other data management: 
<code><a href="#topic+cdb_flatten">cdb_flatten</a>()</code>,
<code><a href="#topic+cdb_id_stages">cdb_id_stages</a>()</code>,
<code><a href="#topic+cdb_id_studies">cdb_id_studies</a>()</code>,
<code><a href="#topic+cdb_id">cdb_id</a>()</code>,
<code><a href="#topic+cdb_mean_matF">cdb_mean_matF</a>()</code>,
<code><a href="#topic+cdb_rbind">cdb_rbind</a>()</code>,
<code><a href="#topic+cdb_unflatten">cdb_unflatten</a>()</code>,
<code><a href="#topic+cdb_unnest">cdb_unnest</a>()</code>,
<code><a href="#topic+mpm_mean">mpm_mean</a>()</code>,
<code><a href="#topic+mpm_median">mpm_median</a>()</code>,
<code><a href="#topic+mpm_sd">mpm_sd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat_str &lt;- "[3.3 5.2 6.1 0.1 NA 0.3 0.2 0.4 0.1]"
mat &lt;- string_to_mat(mat_str)

vec1_str &lt;- "[0.30||0.42||0.19||0.09]"
vec1 &lt;- string_to_vec(vec1_str, numeric = TRUE)

vec2_str &lt;- "[Seedling 1||Seedling 2||Juvenile||Reproductive]"
vec2 &lt;- string_to_vec(vec2_str)

# convert back to string format
mat_to_string(mat)
vec_to_string(vec1)
vec_to_string(vec2)

## Not run: 
# non-square matrix
mat_str &lt;- "[0.42 0.52 0.15 0.23 0.14]"
string_to_mat(mat_str)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
