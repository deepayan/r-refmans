<!DOCTYPE html><html><head><title>Help for package EstCRM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EstCRM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bootCRM'>
<p>Computing Standard Errors for Item Parameter Estimates using Bootstrap Sampling</p></a></li>
<li><a href='#EPIA'>
<p>The Eysenck Personality Inventory Impulsivity Subscale</p></a></li>
<li><a href='#EstCRM'>
<p>Calibrating Parameters for the Samejima's Continuous Response Model</p></a></li>
<li><a href='#EstCRMitem'><p>Estimating Item Parameters for the Continuous Response Model</p></a></li>
<li><a href='#EstCRMperson'><p>Estimating Person Parameters for the Continuous Response Model</p></a></li>
<li><a href='#fitCRM'><p>Compute item fit residual statistics for the Continuous Response Model</p></a></li>
<li><a href='#plotCRM'>
<p>Draw Three-Dimensional Item Category Response Curves</p></a></li>
<li><a href='#print.CRM'>
<p>Summary output for the object of class <code>CRM</code></p></a></li>
<li><a href='#SelfEff'>
<p>Teaching Self Efficacy Scale</p></a></li>
<li><a href='#simCRM'>
<p>Generating Data under the Continuous Response Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-9-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Calibrating Parameters for the Samejima's Continuous IRT Model</td>
</tr>
<tr>
<td>Author:</td>
<td>Cengiz Zopluoglu </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cengiz Zopluoglu &lt;cen.zop@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>Hmisc, lattice</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates item and person parameters for the Continuous Response Model (CRM; Samejima, 1973, &lt;<a href="https://doi.org/10.1007%2FBF02291114">doi:10.1007/BF02291114</a>&gt;), computes item fit residual statistics, draws empirical 3D item category response curves, draws theoretical 3D item category response curves, and generates data under the CRM for simulation studies.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cengiz.me/">https://cengiz.me/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-16 17:48:17 UTC; cengiz</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-16 21:46:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='bootCRM'>
Computing Standard Errors for Item Parameter Estimates using Bootstrap Sampling
</h2><span id='topic+bootCRM'></span>

<h3>Description</h3>

<p>Computes the standard errors of item parameter estimates using a non-parametric bootstrapping approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootCRM(data,max.item,min.item,max.EMCycle=500,converge=.01,
        type="Shojima",BFGS=TRUE,nsample=50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootCRM_+3A_data">data</code></td>
<td>

<p>a data frame with <em>N</em> rows and <em>m</em> columns, with <em>N</em> denoting the number of subjects and <em>m</em> denoting the number of items.
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each item.
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_min.item">min.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the minimum possible score for each item. 
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_max.emcycle">max.EMCycle</code></td>
<td>

<p>a number of maximum EM Cycles used in the iteration. Default is 500.
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_converge">converge</code></td>
<td>

<p>a criteria value indicating the difference between loglikelihoods of two consecutive EM cycles to stop the iteration. Default is .01 
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_type">type</code></td>
<td>

<p>type of optimization. Default is the non-iterative EM 
developed by Shojima(2005). 
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_bfgs">BFGS</code></td>
<td>

<p>a valid argument when <code>type</code> is equal to &quot;Wang&amp;Zeng&quot;. If TRUE, the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm is used to update Hessian.
</p>
</td></tr>
<tr><td><code id="bootCRM_+3A_nsample">nsample</code></td>
<td>

<p>a number of bootstrap samples used in estimating the standard errors. Default is 50
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bootCRM</code> computes the standard errors of item parameter estimates using a non-parametric bootstrap sampling approach. 
</p>


<h3>Value</h3>

<p><code>bootCRM</code> returns a list with three elements. Each element of the list is an <em>m</em>x3 matrix where <em>m</em> is the number of items. The first column includes the item parameter estimates from the original sample, the second column includes the average item parameter estimates from R bootstrap samples (the mean of the empirical sampling distribution), and the third column includes the standard errors of the item parameter estimates obtained from bootstrap samples (standard deviation of the empirical sampling distribution).
</p>
<table>
<tr><td><code>Discrimination</code></td>
<td>
<p>Estimates for item discriminations</p>
</td></tr>
<tr><td><code>Difficulty</code></td>
<td>
<p>Estimates for item difficulties</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>Estimates for alpha parameters</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It may make take too long to get the results if you request a large number of bootstrap samples. By default, the number of bootstrap samples is 50, and it takes a couple minutes for the sample datasets provided in the package. It would be a good idea to try 100 or 500 bootstrap samples if you have enough time.
</p>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters, 
<code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit statistics and drawing empirical 3D item response curves,
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  ## Not run: 
  
  ##load the dataset EPIA
  data(EPIA)
  
  bootCRM(data=EPIA,
  max.item=c(112,112,112,112,112),
  min.item=c(0,0,0,0,0),
  max.EMCycle=200,
  converge=.01,
  nsample=100)
  
  
  ##load the dataset SelfEff
  data(SelfEff)
  
  bootCRM(data=SelfEff,
  max.item=c(11,11,11,11,11,11,11,11,11,11),
  min.item=c(0,0,0,0,0,0,0,0,0,0),
  max.EMCycle=200,
  converge=.01,
  nsample=100)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='EPIA'>
The Eysenck Personality Inventory Impulsivity Subscale
</h2><span id='topic+EPIA'></span>

<h3>Description</h3>

<p>The data came from a published study and was kindly provided by Dr. Ferrando. A group of 1,033 undergraduate students were asked to check on a 112 mm line segment with two end points (almost never, almost always) using their own judgement for the five items taken from the Spanish version of the EPI-A impulsivity subscale. The direct item score was the distance in mm of the check mark from the left end point (Ferrando, 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EPIA)</code></pre>


<h3>Format</h3>

<p>A data frame with 1033 observations on the following 5 variables.
</p>

<dl>
<dt><code>Item 1</code></dt><dd><p>Longs for excitement</p>
</dd>
<dt><code>Item 2</code></dt><dd><p>Does not stop and think things over before doing anything</p>
</dd>
<dt><code>Item 3</code></dt><dd><p>Often shouts back when shouted at</p>
</dd>
<dt><code>Item 4</code></dt><dd><p>Likes doing things in which he/she has to act quickly</p>
</dd>
<dt><code>Item 5</code></dt><dd><p>Tends to do many things at the same time</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.
</p>


<h3>References</h3>

<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.
</p>

<hr>
<h2 id='EstCRM'>
Calibrating Parameters for the Samejima's Continuous Response Model
</h2><span id='topic+EstCRM'></span><span id='topic+EstCRM'></span>

<h3>Description</h3>

<p>This package includes the tools to estimate model parameters for the Samejima's Continuous Response Model (CRM) via marginal maximum likelihood estimation and EM algorithm, to compute item fit residual statistics, to draw empirical 3D item category response curves, to draw theoretical 3D item category response curves, and to generate data under the CRM for simulation studies.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EstCRM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-06-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package can be used to estimate item parameters by using <code><a href="#topic+EstCRMitem">EstCRMitem</a></code>, to estimate person ability parameters by using <code><a href="#topic+EstCRMperson">EstCRMperson</a></code>, to compute the item fit residual statistics after parameter calibration by using <code><a href="#topic+fitCRM">fitCRM</a></code>, to draw empirical 3D item category response curves by using <code><a href="#topic+fitCRM">fitCRM</a></code>, to draw theoretical 3D item category response curves by using <code><a href="#topic+plotCRM">plotCRM</a></code>, and to generate data under the Continuous Response Model for the simulation studies by using <code><a href="#topic+simCRM">simCRM</a></code>.
</p>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>
<p>Maintainer: Cengiz Zopluoglu &lt;cen.zop@gmail.com&gt;
</p>


<h3>References</h3>

<p>Kan, A.(2009). Effect of scale response format on psychometric properties in teaching self-efficacy. <em>Euroasian Journal of Educational Research</em>, <em>34</em>, 215-228.<br />
</p>
<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.
</p>
<p>Samejima, F.(1973). Homogeneous Case of the Continuous                Response Model. <em>Psychometrika</em>, 38(2), 203-219.          
</p>
<p>Shojima, K.(2005). A Noniterative Item Parameter Solution in Each EM Cycyle of the Continuous Response Model. <em>Educational Technology Research</em>, 28, 11-22.
</p>
<p>Wang, T. &amp; Zeng, L.(1998). Item Parameter Estimation for a Continuous  Response Model Using an EM Algorithm. <em>Applied Psychological Measurement</em>, 22(4), 333-343. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters,
<code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit residual statistics and drawing empirical 3D item category response curves,
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
<code><a href="#topic+simCRM">simCRM</a></code> for simulating data under CRM.
</p>

<hr>
<h2 id='EstCRMitem'>Estimating Item Parameters for the Continuous Response Model</h2><span id='topic+EstCRMitem'></span>

<h3>Description</h3>

<p>Estimate item parameters for the Continuous Response Model (Samejima,1973)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstCRMitem(data, max.item, min.item, max.EMCycle = 500, converge = 0.01,
           type="Shojima",BFGS=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstCRMitem_+3A_data">data</code></td>
<td>

<p>a data frame with <em>N</em> rows and <em>m</em> columns, with <em>N</em> denoting the number of subjects and <em>m</em> denoting the number of items.
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each item.
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_min.item">min.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the minimum possible score for each item. 
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_max.emcycle">max.EMCycle</code></td>
<td>

<p>a number of maximum EM Cycles used in the iteration. Default 500.
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_converge">converge</code></td>
<td>

<p>a criteria value indicating the difference between loglikelihoods of two consecutive EM cycles to stop the iteration. Default .01 
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_type">type</code></td>
<td>

<p>type of optimization. Takes two values, either &quot;Shojima&quot; or &quot;Wang&amp;Zeng&quot;. Default is the non-iterative EM developed by Shojima(2005). See details.
</p>
</td></tr>
<tr><td><code id="EstCRMitem_+3A_bfgs">BFGS</code></td>
<td>

<p>a valid argument when <code>type</code> is equal to &quot;Wang&amp;Zeng&quot;. If TRUE, the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm is used to update Hessian.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Samejima (1973) proposed an IRT model for continuous item scores as a limiting form of the graded response model. Even though the Continuous Response Model (CRM) is as old as the well-known and popular binary and polytomous IRT models, it is not commonly used in practice. This may be due to the lack of accessible computer software to estimate the parameters for the CRM. Another reason might be that the continuous outcome is not a type of response format commonly observed in the field of education and psychology. There are few published studies that used the CRM (Ferrando, 2002; Wang &amp; Zeng, 1998). In the field of education, the model may have useful applications for estimating a single reading ability from a set of reading passages in the Curriculum Based Measurement context. Also, this type of continuous response format may be more frequently observed in the future as the use of computerized testing increases. For instance, the examinees or raters may check anywhere on the line between extremely positive and extremely negative in a computerized testing environment rather than responding to a likert type item. 
</p>
<p>Wang &amp; Zeng (1998) proposed a re-parameterized version of the CRM. In this re-parameterization, the probability of an examinee <em>i</em> with a spesific <em>&theta;</em> obtaining a score of <em>x</em> or higher on a particular item <em>j</em> with a continuous measurement scale ranging from 0 to <em>k</em> and with the parameters <em>a</em>, <em>b</em>, and <em>&alpha;</em> is defined as the following:<br />
</p>
<p style="text-align: center;"><code class="reqn">
P(X_{ij} \geq x|\theta_{i},a_{j},b_{j},\alpha_{j})=\frac{1}{\sqrt{2\pi}}\int\limits_{-\infty}^{v}{e^{\frac{-t^2}{2}}dt}
</code>
</p>

<p><code class="reqn">
v=a_{j}(\theta_{i}-b_{j}-\frac{1}{\alpha_{j}}ln\frac{x_{ij}}{k_{j}-x_{ij}})
</code><br />
</p>
<p>where <em>a</em> is a discrimination parameter, <em>b</em> is a difficulty parameter, and <em>&alpha;</em> represents a scaling parameter that defines some scale transformation linking the original observed score scale to the <em>&theta;</em> scale (Wang &amp; Zeng, 1998). <em>k</em> is the maximum possible score for the item. <em>a</em> and <em>b</em> in this model have practical meaning and are interpreted same as in the binary and polytomous IRT models. <em>&alpha;</em> is a scaling parameter and does not have a practical meaning.
</p>
<p>In the model fitting process, the observed <em>X</em> scores are first transformed to a random variable <em>Z</em> by using the following equation:<br />
</p>
<p style="text-align: center;"><code class="reqn">
Z_{ij}=ln(\frac{X_{ij}}{k_{j}-X_{ij}})
</code>
</p>

<p>Then, the conditional probability density function of the random variable <em>Z</em> is equal to:<br />
</p>
<p style="text-align: center;"><code class="reqn">
{f}(z_{ij}|\theta_{i},a_{j},b_{j},\alpha_{j})=\frac{a_{j}}{\sqrt{2\pi}\alpha_{j}}exp^{-\frac{[a_{j}(\theta_{i}-b_{j}-\frac{z_{ij}}{\alpha_{j}})]^2}{2}}
</code>
</p>

<p>The conditional pdf of <em>Z</em> is a normal density function with a mean of <em>&alpha;</em>(<em>&theta;</em>-<em>b</em>) and a variance of <em>&alpha;^2</em>/ a^2.<br />
</p>
<p>Wang &amp; Zeng (1998) proposed an algorithm to estimate the CRM parameters via marginal maximum likelihood and Expectation-Maximization (EM) algorithm. In the Expectation step, the expected log-likelihood function is obtained based on the integration over the posterior <em>&theta;</em> distribution by using the Gaussian quadrature points. In the Maximization step, the parameters are estimated by solving the first and second derivatives of the expected log-likelihood function with rescpect to <em>a</em>, <em>b</em>, and <em>&alpha;</em> parameters via Newton-Raphson procedure. A sequence of E-step and M-step repeats until the difference between the two consecutive loglikelihoods is smaller than a convergence criteria. This procedure is available through <code>type="Wang&amp;Zeng"</code> argument. If <code>type</code> is equal to &quot;Wang&amp;Zeng&quot;, then user can specify <code>BFGS</code> argument as either TRUE or FALSE. If <code>BFGS</code> argument is TRUE, then the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm is used to approximate Hessian.  If <code>BFGS</code> argument is FALSE, then the Hessian is directly computed.<br />
</p>
<p>Shojima (2005) simplified the EM algorithm proposed by Wang &amp; Zeng(1998). He derived the closed formulas for computing the loglikelihood in the E-step and estimating the parameters in the M-step (please see the reference paper below for equations). He showed that the equations of the first derivatives in the M-step can be solved algebraically by assuming flat (non-informative) priors for the item parameters.  This procedure is available through <code>type="Shojima"</code> argument.  <br />
</p>


<h3>Value</h3>

<p><code>EstCRMitem()</code> returns an object of class &quot;<code>CRM</code>&quot;. An object of class &quot;<code>CRM</code>&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p> original data</p>
</td></tr>
<tr><td><code>descriptive</code></td>
<td>
<p> descriptive statistics for the original data and the transformed z scores</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p> estimated item parameters in the last EM Cycle</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p> a list that reports the information for each EM cycle</p>
</td></tr>
<tr><td><code>dif</code></td>
<td>
<p>The difference of loglikelihoods between the last two EM cycles</p>
</td></tr>
</table>


<h3>Note</h3>

<p>* The ID variable ,if included, has to be excluded from the data before the analysis. If the format of the data is not a &quot;data frame&quot;, the function does not work. Please use &quot;as.data.frame()&quot; to change the format of the input data.<br />
</p>
<p>* A previous published simulation study (Shojima, 2005) was replicated as an example to check the performance of <code>EstCRMitem()</code>.Please see the examples of <code><a href="#topic+simCRM">simCRM</a></code> in this package.<br />
</p>
<p>*The example below is a reproduction of the results from another published study (Ferrando, 2002). Dr. Ferrando kindly provided the dataset used in the published study. The dataset was previously analyzed by using EM2 program and the estimated CRM item parameters were reported in Table 2 in the paper. The estimates from <code>EstCRMitem()</code> is comparable to the item parameter estimates reported in Table 2.
</p>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>References</h3>

<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.<br />
</p>
<p>Samejima, F.(1973). Homogeneous Case of the Continuous                Response Model. <em>Psychometrika</em>, 38(2), 203-219.<br />          
</p>
<p>Shojima, K.(2005). A Noniterative Item Parameter Solution in Each EM Cycyle of the Continuous Response Model. <em>Educational Technology Research</em>, 28, 11-22.<br />
</p>
<p>Wang, T. &amp; Zeng, L.(1998). Item Parameter Estimation for a Continuous  Response Model Using an EM Algorithm. <em>Applied Psychological Measurement</em>, 22(4), 333-343.                                                                                                          
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit residual statistics and drawing empirical 3D item category response curves,
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
<code><a href="#topic+simCRM">simCRM</a></code> for generating data under CRM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  ## Not run: 
  
  ##load the dataset EPIA
  data(EPIA)
  
  ##Check the class. "data.frame" is required.
  class(EPIA)
  
  ##Define the vectors "max.item" and "min.item". The maximum possible
  ##score was 112 and the minimum possible score was 0 for all items
  
  max.item &lt;- c(112,112,112,112,112)
  min.item &lt;- c(0,0,0,0,0)
  
  ##The maximum number of EM Cycle and the convergence criteria can be
  ##specified
  
  max.EMCycle=200
  converge=.01
  
  ##Estimate the item parameters
  CRM &lt;- EstCRMitem(EPIA, max.item, min.item, max.EMCycle, converge)
  CRM
  
  ##Other details
  
  CRM$descriptive
  CRM$param
  CRM$iterations
  CRM$dif
  
  ##load the dataset SelfEff
  
  data(SelfEff)
  
  ##Check the class. "data.frame" is required.
  
  class(SelfEff)
  
  ##Define the vectors "max.item" and "min.item". The maximum possible
  ##score was 11 and the minimum possible score was 0 for all items
  
  max.item &lt;- c(11,11,11,11,11,11,11,11,11,11)
  min.item &lt;- c(0,0,0,0,0,0,0,0,0,0)
  
  ##Estimate the item parameters
  CRM2 &lt;- EstCRMitem(SelfEff, max.item, min.item, max.EMCycle=200, converge=.01)
  CRM2
  
  ##Other details
  
  CRM2$descriptive
  CRM2$param
  CRM2$iterations
  CRM2$dif
  
## End(Not run)
</code></pre>

<hr>
<h2 id='EstCRMperson'>Estimating Person Parameters for the Continuous Response Model</h2><span id='topic+EstCRMperson'></span>

<h3>Description</h3>

<p>Estimate person parameters for the Continuous Response Model(Samejima,1973)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstCRMperson(data,ipar,min.item,max.item)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstCRMperson_+3A_data">data</code></td>
<td>
 
<p>a data frame with <em>N</em> rows and <em>m</em> columns, with <em>N</em> denoting the number of subjects and <em>m</em> denoting the number of items. 
</p>
</td></tr>
<tr><td><code id="EstCRMperson_+3A_ipar">ipar</code></td>
<td>
 
<p>a matrix with <em>m</em> rows and three columns, with <em>m</em> denoting the number of items. The first column is the <em>a</em> parameters, the second column is the <em>b</em> parameters, and the third column is the <em>alpha</em> parameters
</p>
</td></tr>
<tr><td><code id="EstCRMperson_+3A_min.item">min.item</code></td>
<td>
 
<p>a vector of length <em>m</em> indicating the minimum possible score for each item. 
</p>
</td></tr>
<tr><td><code id="EstCRMperson_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each item. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Samejima(1973) derived the closed formula for the maximum likelihood estimate (MLE) of the person parameters (ability levels) under Continuous Response Model. Given that the item parameters are known, the parameter for person <em>i</em> (ability level) can be estimated from the following equation:
</p>
<p style="text-align: center;"><code class="reqn">
MLE(\theta_{i})=\frac{\sum_{j=1}^m[a_{j}^2(b_{j}+\frac{z_{ij}}{\alpha_{j}})]}{\sum_{j=1}^m \alpha_{j}^2}
</code>
</p>

<p>As suggested in Ferrando (2002), the ability level estimates are re-scaled once they are obtained from the equation above. So, the mean and the variance of the sample estimates equal those of the latent distribution on which the estimation is based.
</p>
<p>Samejima (1973) also derived that the item information is equal to:
</p>
<p style="text-align: center;"><code class="reqn">
I(\theta_{i})=a^2
</code>
</p>

<p>So, the item information is constant along the theta continuum in the Continuous Response Model. 
</p>
<p>The asymptotic standard error of the MLE ability level estimate is the square root of the reciprocal of the total test information:
</p>
<p style="text-align: center;"><code class="reqn">
SE(\hat{\theta_{i}})=\sqrt\frac{1}{\sum_{j=1}^m a_{j}^2}
</code>
</p>

<p>In the Continuous Response Model, the standard error of the ability estimate is same for all examinees unless an examinee has missing data. If the examinee has missing data, the ability level estimate and its standard error is obtained from the available item scores.
</p>


<h3>Value</h3>

<p><code>EstCRMperson()</code> returns an object of class &quot;<code>CRMtheta</code>&quot;. An object of class &quot;<code>CRMtheta</code>&quot; contains the following component:<br />
</p>
<table>
<tr><td><code>thetas</code></td>
<td>
<p> a three column matrix, the first column is the examinee ID, the second column is the re-scaled theta estimate, the third column is the standard error of the theta estimate.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See the examples of <code><a href="#topic+simCRM">simCRM</a></code> for an R code that runs a simulation to examine the recovery of person parameter estimates by <code>EstCRMperson</code>.
</p>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>References</h3>

<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.
</p>
<p>Samejima, F.(1973). Homogeneous Case of the Continuous                Response Model. <em>Psychometrika</em>, 38(2), 203-219.          
</p>
<p>Wang, T. &amp; Zeng, L.(1998). Item Parameter Estimation for a Continuous  Response Model Using an EM Algorithm. <em>Applied Psychological Measurement</em>, 22(4), 333-343. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit residual statistics and drawing empirical 3D item category response curves,
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
<code><a href="#topic+simCRM">simCRM</a></code> for generating data under CRM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Not run: 
    #Load the dataset EPIA
    
    data(EPIA)
    
    ##Define the vectors "max.item" and "min.item". The maximum possible
    ##score was 112 and the minimum possible score was 0 for all items
    max.item &lt;- c(112,112,112,112,112)
    min.item &lt;- c(0,0,0,0,0)
    
    ##Estimate item parameeters
    CRM &lt;- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
    par &lt;- CRM$param
    
    ##Estimate the person parameters
    
    CRMthetas &lt;- EstCRMperson(EPIA,par,min.item,max.item)
    theta.par &lt;- CRMthetas$thetas
    theta.par
    
    #Load the dataset SelfEff
    data(SelfEff)
    
    ##Define the vectors "max.item" and "min.item". The maximum possible
    ##score was 11 and the minimum possible score was 0 for all items
    
    max.item &lt;- c(11,11,11,11,11,11,11,11,11,11)
    min.item &lt;- c(0,0,0,0,0,0,0,0,0,0)
    
    ##Estimate the item parameters
    CRM2 &lt;- EstCRMitem(SelfEff, max.item, min.item, max.EMCycle=200, converge=.01)
    par2 &lt;- CRM2$param
    
    ##Estimate the person parameters
    
    CRMthetas2 &lt;- EstCRMperson(SelfEff,par2,min.item,max.item)
    theta.par2 &lt;- CRMthetas2$thetas
    theta.par2
  
## End(Not run)
</code></pre>

<hr>
<h2 id='fitCRM'>Compute item fit residual statistics for the Continuous Response Model</h2><span id='topic+fitCRM'></span>

<h3>Description</h3>

<p>Compute item fit residual statistics for the Continuous Response Model as described in Ferrando (2002)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCRM(data, ipar, est.thetas, max.item,group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitCRM_+3A_data">data</code></td>
<td>

<p>a data frame with <em>N</em> rows and <em>m</em> columns, with <em>N</em> denoting the number of subjects and <em>m</em> denoting the number of items. 
</p>
</td></tr>
<tr><td><code id="fitCRM_+3A_ipar">ipar</code></td>
<td>

<p>a matrix with <em>m</em> rows and three columns, with <em>m</em> denoting the number of items. The first column is the <em>a</em> parameters, the second column is the <em>b</em> parameters, and the third column is the <em>alpha</em> parameters
</p>
</td></tr>
<tr><td><code id="fitCRM_+3A_est.thetas">est.thetas</code></td>
<td>

<p>object of class &quot;<code>CRMtheta</code>&quot; obtained by using <code>EstCRMperson()</code>
</p>
</td></tr>
<tr><td><code id="fitCRM_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each item. 
</p>
</td></tr>
<tr><td><code id="fitCRM_+3A_group">group</code></td>
<td>

<p>an integer, number of ability groups to compute item fit residual statistics. Default 20.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the item fit residual statistics as decribed in Ferrando (2002). The steps in the procedure are as the following:
</p>
<p>1- Re-scaled <em>&theta;</em> estimates are obtained.
</p>
<p>2-  <em>&theta;</em> estimates are sorted and assigned to <em>k</em> intervals on the <em>&theta;</em> continuum.
</p>
<p>3- The mean item score  is computed in each interval for each of the items.
</p>
<p>4- The expected item score and the conditional variance in each interval are obtained with the item parameter estimates and taking the median theta estimate for the interval.
</p>
<p>5- An approximate standardized residual for item <em>m</em> at ability interval <em>k</em> is obtained as:
</p>
<p style="text-align: center;"><code class="reqn">
z_{mk}= \frac{\bar{X}_{mk} - E(X_{m}|\theta_{k})}{\sqrt{\frac{\sigma^2(X_{m}|\theta_{k})}{N_{k}}}}
</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>fit.stat</code></td>
<td>
<p> a data frame with <em>k</em> rows and <em>m+1</em> columns with <em>k</em> denoting the number of ability intervals and <em>m</em> denoting the number of items. The first column is the ability interval. Other elements are the standardized residuals of item <em>m</em> in ability interval <em>k</em>.
</p>
</td></tr>
<tr><td><code>emp.irf</code></td>
<td>
<p> a list of length <em>m</em> with <em>m</em> denoting the number of items. Each element is a 3D plot representing the item category response curve based on the empirical probabilities. See examples below.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>References</h3>

<p>Ferrando, P.J.(2002). Theoretical and Empirical Comparison between Two Models for Continuous Item Responses. <em>Multivariate Behavioral Research</em>, 37(4), 521-542.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
<code><a href="#topic+simCRM">simCRM</a></code> for generating data under CRM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Not run: 

    ##load the dataset EPIA
    
    data(EPIA)
    
    ##Define the vectors "max.item" and "min.item". The maximum possible
    ##score was 112 and the minimum possible score was 0 for all items
    
    max.item &lt;- c(112,112,112,112,112)
    min.item &lt;- c(0,0,0,0,0)
    
    ##Estimate item parameters
    
    CRM &lt;- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
    par &lt;- CRM$param
    
    ##Estimate the person parameters
    
    CRMthetas &lt;- EstCRMperson(EPIA,par,min.item,max.item)
    
    ##Compute the item fit residual statistics and empirical item category
    ##response curves
    
    fit &lt;- fitCRM(EPIA, par, CRMthetas, max.item,group=10)
    
    ##Item-fit residual statistics
    
    fit$fit.stat
    
    ##Empirical item category response curves
    fit$emp.irf[[1]]   #Item 1
  
## End(Not run)

</code></pre>

<hr>
<h2 id='plotCRM'>
Draw Three-Dimensional Item Category Response Curves
</h2><span id='topic+plotCRM'></span>

<h3>Description</h3>

<p>This function draws the 3D item category response curves given the item parameter matrix and the maximum and minimum possible values that examinees can get as a score for the item. This 3D representation is an extension of 2D item category response curves in binary and polytomous IRT models. Due to the fact that there are many possible response categories, another dimension is drawn for the response categories in the 3D representation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCRM(ipar, item, min.item, max.item)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCRM_+3A_ipar">ipar</code></td>
<td>

<p>a matrix with <em>m</em> rows and three columns, with <em>m</em> denoting the number of items. The first column is the <em>a</em> parameters, the second column is the <em>b</em> parameters, and the third column is the <em>alpha</em> parameters
</p>
</td></tr>
<tr><td><code id="plotCRM_+3A_item">item</code></td>
<td>

<p>item number, an integer between 1 and <em>m</em> with <em>m</em> denoting the number of items
</p>
</td></tr>
<tr><td><code id="plotCRM_+3A_min.item">min.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the minimum possible score for each item. 
</p>
</td></tr>
<tr><td><code id="plotCRM_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each item. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>irf</code></td>
<td>
<p> a 3D theoretical item category response curves</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters, 
<code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit residual statistics and drawing empirical 3D item category response curves,
<code><a href="#topic+simCRM">simCRM</a></code> for generating data under CRM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Not run: 

    ##load the dataset EPIA
    
    data(EPIA)
    
    ##Define the vectors "max.item" and "min.item". The maximum possible
    ##score was 112 and the minimum possible score was 0 for all items
    
    min.item &lt;- c(0,0,0,0,0)
    max.item &lt;- c(112,112,112,112,112)
    
    ##Estimate item parameters
    
    CRM &lt;- EstCRMitem(EPIA, max.item, min.item, max.EMCycle = 500, converge = 0.01)
    par &lt;- CRM$param
    
    ##Draw theoretical item category response curves for Item 2
    plotCRM(par,2,min.item, max.item)
    
## End(Not run)
</code></pre>

<hr>
<h2 id='print.CRM'>
Summary output for the object of class <code>CRM</code> 
</h2><span id='topic+print.CRM'></span>

<h3>Description</h3>

<p>Print the output for the object of class <code>CRM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CRM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.CRM_+3A_x">x</code></td>
<td>

<p>an object of class <code>CRM</code> obtained from <code>EstCRMitem</code>
</p>
</td></tr>
<tr><td><code id="print.CRM_+3A_...">...</code></td>
<td>

<p>More options to pass to summary and print
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The summary output includes the information from the last EM Cycle, final parameter estimates, and the descriptive statistics of the original data and the transformed data.
</p>

<hr>
<h2 id='SelfEff'>
Teaching Self Efficacy Scale
</h2><span id='topic+SelfEff'></span>

<h3>Description</h3>

<p>The data came from a published study and was kindly provided by Dr. Adnan Kan. A group of 307 pre-service teachers graduated from various departments in the college of education were asked to check on a 11 cm line segment with two end points (can not do at all, highly certain can do) using their own judgement for the 10 items that measure teacher self-efficacy on different activities. The direct item score was the distance in cm of the check mark from the left end point (Kan, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SelfEff)</code></pre>


<h3>Format</h3>

<p>A data frame with 307 observations on the following 10 items.
</p>

<dl>
<dt><code>Item1</code></dt><dd><p>Implementing variety of teaching strategies</p>
</dd>
<dt><code>Item2</code></dt><dd><p>Creating learning environments for the effective participation of students</p>
</dd>
<dt><code>Item3</code></dt><dd><p>Providing the acquisition of learning experiences according to the students' physical, emotional, and psychomotor characteristics</p>
</dd>
<dt><code>Item4</code></dt><dd><p>Creating learning environments in which students can effectively express themselves</p>
</dd>
<dt><code>Item5</code></dt><dd><p>Implementing a variety of assessment strategies (formal, informal)</p>
</dd>
<dt><code>Item6</code></dt><dd><p>Understanding differences in students' learning styles and providing learning opportunities in compliance with these differences</p>
</dd>
<dt><code>Item7</code></dt><dd><p>Using teaching methods and techniques within the framework of educational plans and aims</p>
</dd>
<dt><code>Item8</code></dt><dd><p>Discovering students' interests and skills and guiding them accordingly </p>
</dd>
<dt><code>Item9</code></dt><dd><p>Using educational technology effectively in classrooms to support teaching</p>
</dd>
<dt><code>Item10</code></dt><dd><p>Designing and implementing educational variables such as motivation, reinforcement, feedback, etc.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kan, A.(2009). Effect of scale response format on psychometric properties in teaching self-efficacy. <em>Euroasian Journal of Educational Research</em>, <em>34</em>, 215-228.
</p>


<h3>References</h3>

<p>Kan, A.(2009). Effect of scale response format on psychometric properties in teaching self-efficacy. <em>Euroasian Journal of Educational Research</em>, <em>34</em>, 215-228.<br />
</p>

<hr>
<h2 id='simCRM'>
Generating Data under the Continuous Response Model
</h2><span id='topic+simCRM'></span>

<h3>Description</h3>

<p>Generating data under the Continuous Response Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simCRM(thetas, true.param, max.item)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simCRM_+3A_thetas">thetas</code></td>
<td>

<p>a vector of length <em>N</em> with <em>N</em> denoting the number of examinees. Each element of the vector is the true ability level for an examinee
</p>
</td></tr>
<tr><td><code id="simCRM_+3A_true.param">true.param</code></td>
<td>

<p>a matrix of true item parameters with <em>m</em> rows and three columns, with <em>m</em> denoting the number of items. The first column is the <em>a</em> parameters, the second column is the <em>b</em> parameters, and the third column is the <em>alpha</em> parameters
</p>
</td></tr>
<tr><td><code id="simCRM_+3A_max.item">max.item</code></td>
<td>

<p>a vector of length <em>m</em> indicating the maximum possible score for each hypothetical item. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>simCRM</code> generates data under Continuous Response Model as described in Shojima(2005). Given the true ability level for person <em>i</em> and the true item parameters for item <em>j</em>, the transformed response  of person <em>i</em> for item <em>j</em> follows a normal distribution with a mean of <em>&alpha;</em>((<em>&theta;</em>-<em>&beta;</em>)) and a standard deviation of <em>&alpha;</em>^2/<em>a^-2</em>.
</p>


<h3>Value</h3>

<p>a data frame with <em>N</em> rows and <em>m</em> columns with <em>N</em> denoting the number of observations and <em>m</em> denoting the number of items.
</p>


<h3>Author(s)</h3>

<p>Cengiz Zopluoglu
</p>


<h3>References</h3>

<p>Shojima, K.(2005). A Noniterative Item Parameter Solution in Each EM Cycyle of the Continuous Response Model. <em>Educational Technology Research</em>, 28, 11-22.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EstCRMitem">EstCRMitem</a></code> for estimating item parameters, 
<code><a href="#topic+EstCRMperson">EstCRMperson</a></code> for estimating person parameters, 
<code><a href="#topic+fitCRM">fitCRM</a></code> for computing item-fit statistics and drawing empirical 3D item response curves,
<code><a href="#topic+plotCRM">plotCRM</a></code> for drawing theoretical 3D item category response curves,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  ## Not run: 
  
  #####################################################
  #                      Example 1:                   #
  #   Basic data generation and parameter recovery    #
  #####################################################
  
  #Generate true person ability parameters for 1000 examinees from 
  #a standard normal distribution
  
  true.thetas &lt;- rnorm(1000,0,1)
  
  #Generate the true item parameter matrix for the hypothetical items
  
  true.par &lt;- matrix(c(.5,1,1.5,2,2.5,
  -1,-.5,0,.5,1,1,.8,1.5,.9,1.2),
  nrow=5,ncol=3)
  true.par
  
  #Generate the vector maximum possible scores that students can 
  #get for the items
  
  max.item &lt;- c(30,30,30,30,30)
  
  #Generate the response matrix
  
  simulated.data &lt;- simCRM(true.thetas,true.par,max.item)
  
  #Let's examine the simulated data
  
  head(simulated.data)
  summary(simulated.data)
  
  #Let's try to recover the item parameters
  
  min.item &lt;- c(0,0,0,0,0)
  
  CRM &lt;- EstCRMitem(simulated.data,max.item, min.item,
  max.EMCycle=500,converge=0.01)
  
  #Compare the true item parameters with the estimated item parameters. 
  #The first three column is the true item parameters, and the second
  #three column is the estimated item parameters
  
  cbind(true.par,CRM$param)
  
  #Let's recover the person parameters
  
  par &lt;- CRM$param
  CRMthetas &lt;- EstCRMperson(simulated.data,par,min.item,max.item)
  theta.par &lt;- CRMthetas$thetas
  
  #Compare the true person ability parameters to the estimated person
  ##ability parameters.The first column is the true parameters and the
  ##second column is the estimated parameters
  
  thetas &lt;- cbind(true.thetas,theta.par[,2])
  head(thetas)
  cor(thetas)
  plot(thetas[,1],thetas[,2])
  
  #RMSE for the estimated person parameters
  
  sqrt(sum((thetas[,1]-thetas[,2])^2)/nrow(thetas))
  
  #RMSE is comparable and similar to the standard error of the 
  #theta estimates. Standard error of the theta estimate is the square
  #root of the reciprocal of the total test information which is the sum
  #of square of the "a" parameters
  
  sqrt(1/sum(CRM$param[,1]^2))
  
  #####################################################
  #                      Example 2:                   #
  #   Item fit Residuals, Empirical and Theoretical   #
  #  Item Category Response Curves for the Simulated  #
  #                    Data Above                     #
  #####################################################
  
  #Because of the run time issues during the package development,
  #I run the fit analysis for a subset of simulated data above.
  #The simulated data has 1000 examinees, but I run the fit analysis
  #for the first 100 subjects of the simulated data. Please ignore the 
  #following line and run the analysis for whole data
  
  simulated.data &lt;- simulated.data[1:100,] #Ignore this line 
  
  par &lt;- CRM$param
  max.item &lt;- c(30,30,30,30,30)
  min.item &lt;- c(0,0,0,0,0)
  CRMthetas &lt;- EstCRMperson(simulated.data,par,min.item,max.item)
  theta.par &lt;- CRMthetas$thetas
  mean(theta.par[,2])
  sd(theta.par[,2])
  hist(theta.par[,2])
  
  fit &lt;- fitCRM(simulated.data,par, CRMthetas, max.item, group=10)
  
  #Item-Fit Residuals
  
  fit$fit.stat
  
  #Empirical Item Category Response Curves
  fit$emp.irf[[1]]   #Item 1
  fit$emp.irf[[5]]   #Item 5
  
  #Theoretical Item Category Response Curves
  plotCRM(par,1,min.item, max.item)   #Item 1
  
  
  
  #####################################################
  #                      Example 3:                   #
  #   The replication of Shojima's simulation study   #
  #                         2005                      #
  #####################################################
  
  #In Shojima's simulation study published in 2005
  
   #true person parameters were generated from a standard normal distribution.
   #The natural logarithm of the true "a" parameters were generated from a N(0,0.09)
   #The true "b" parameters were generated from a N(0,1)
   #The natural logarithm of the true "alpha" parameters were generated from a N(0,0.09)
  
  #The independent variables were the number of items and sample size 
  #in the simulation study
  
  #There were 9 different conditions and 100 replications for each condition.
  
  #In Table 1 (Shojima,2005), the RMSD statistics were reported for each condition.
  
  #The code below replicates the same study. The results are comparable to the Table 1. 
  #The user 
  #should only specify the sample size and the number of items. Then, the user should 
  #run the rest of the code. 
  #At the end, RMSEa, RMSEb, RMSEalp are the item parameter recovery statistics which is 
  #comparable to Table 1
  
  
  #Set the conditions for the simulation study. 
  #It takes longer to run for big number of replications
  
  N=500              #sample size
  n=10               #number of items
  replication=1      #number if replications for each condition  
  
  ############################################################
  #       Run the rest of the code from START to END         #
  ############################################################
  
  #START
  
  true.person &lt;- vector("list",replication)
  true.item &lt;- vector("list",replication)
  est.person &lt;- vector("list",replication)
  est.item &lt;- vector("list",replication)
  simulated.datas &lt;- vector("list",replication)
  
  for(i in 1:replication) {
  true.person[[i]] &lt;- rnorm(N,0,1)
  true.item[[i]] &lt;- cbind(exp(rnorm(n,0,.09)),rnorm(n,0,1),1/exp(rnorm(n,0,.09)))
  }
  
  max.item &lt;- rep(50,n)
  min.item &lt;- rep(0,n)
  
  for(i in 1:replication) {
  simulated.datas[[i]] &lt;- simCRM(true.person[[i]],true.item[[i]],max.item)
  }
  
  for(i in 1:replication) {
  CRM&lt;-EstCRMitem(simulated.datas[[i]],max.item,min.item,max.EMCycle= 500,converge=0.01)
  est.item[[i]]=CRM$par
  }
  for(i in 1:replication) {
  persontheta &lt;- EstCRMperson(simulated.datas[[i]],est.item[[i]],min.item,max.item)
  est.person[[i]]&lt;- persontheta$thetas[,2]
  }
  
  #END
  ############################################################
  
  #RMSE for parameter "a"
  
  RMSEa &lt;- c()
  for(i in 1:replication) {
  RMSEa[i]=sqrt(sum((true.item[[i]][,1]-est.item[[i]][,1])^2)/n)
  }
  
  mean(RMSEa)
  
  
  #RMSE for parameter "b"
  
  RMSEb &lt;- c()
  for(i in 1:replication) {
  RMSEb[i]=sqrt(sum((true.item[[i]][,2]-est.item[[i]][,2])^2)/n)
  }
  
  mean(RMSEb)
  
  #RMSE for parameter "alpha" 
  RMSEalp &lt;- c()
  for(i in 1:replication) {
  RMSEalp[i]=sqrt(sum((true.item[[i]][,3]-est.item[[i]][,3])^2)/n)
  }
  
  mean(RMSEalp)
  
  #RMSE for person parameter
  
  RMSEtheta &lt;- c()
  for(i in 1:replication) {
  RMSEtheta[i]=sqrt(sum((true.person[[i]]-est.person[[i]])^2)/N)
  }
  
  mean(RMSEtheta)
  
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
