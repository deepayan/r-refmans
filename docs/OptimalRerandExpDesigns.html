<!DOCTYPE html><html><head><title>Help for package OptimalRerandExpDesigns</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OptimalRerandExpDesigns}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#complete_randomization_plus_one_min_one'><p>Implements the complete randomization design (CRD) AKA Bernoulli Trial</p></a></li>
<li><a href='#complete_randomization_with_forced_balance_plus_one_min_one'><p>Implements the balanced complete randomization design (BCRD)</p></a></li>
<li><a href='#compute_objective_val_plus_one_min_one_enc'><p>Returns the objective value given a design vector as well an an objective function.</p>
This is code duplication since this is implemented within Java. This is only to be
run if...</a></li>
<li><a href='#frob_norm_sq'><p>Naive Frobenius Norm Squared</p></a></li>
<li><a href='#frob_norm_sq_debiased'><p>Debiased Frobenius Norm Squared Var-Cov matrix</p></a></li>
<li><a href='#frob_norm_sq_debiased_times_matrix'><p>Debiased Frobenius Norm Squared Constant Times Var-Cov matrix</p></a></li>
<li><a href='#generate_W_base_and_sort'><p>Generate Base Assignments and Sorts</p></a></li>
<li><a href='#optimal_rerandomization_exact'><p>Find the Optimal Rerandomization Design Exactly</p></a></li>
<li><a href='#optimal_rerandomization_normality_assumed'><p>Find the Optimal Rerandomization Design Under the Gaussian Approximation</p></a></li>
<li><a href='#optimal_rerandomization_tail_approx'><p>Find the Optimal Rerandomization Design Under the Tail and Kurtosis Approximation</p></a></li>
<li><a href='#OptimalRerandExpDesigns'><p>Optimal Rerandomization Threshold Search for Experimental Design</p></a></li>
<li><a href='#plot.optimal_rerandomization_obj'><p>Plots a summary of a <code>optimal_rerandomization_obj</code> object</p></a></li>
<li><a href='#plot.W_base_object'><p>Plots a summary of the imbalances in a <code>W_base_object</code> object</p></a></li>
<li><a href='#print.optimal_rerandomization_obj'><p>Prints a summary of a <code>optimal_rerandomization_obj</code> object</p></a></li>
<li><a href='#print.W_base_object'><p>Prints a summary of a <code>W_base_object</code> object</p></a></li>
<li><a href='#summary.optimal_rerandomization_obj'><p>Prints a summary of a <code>optimal_rerandomization_obj</code> object</p></a></li>
<li><a href='#summary.W_base_object'><p>Prints a summary of a <code>W_base_object</code> object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimal Rerandomization Experimental Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Adam Kapelner, Michael Sklar, Abba M. Krieger and David Azriel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adam Kapelner &lt;kapelner@qc.cuny.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a tool to find the optimal rerandomization threshold in non-sequential experiments. We offer three procedures based 
	on assumptions made on the residuals distribution: (1) normality assumed (2) excess kurtosis assumed (3) entire distribution assumed.
	Illustrations are included. Also included is a routine to unbiasedly estimate Frobenius norms of variance-covariance matrices.
	Details of the method can be found in "Optimal Rerandomization via a Criterion that Provides Insurance Against Failed Experiments"
	Adam Kapelner, Abba M. Krieger, Michael Sklar and David Azriel (2020) &lt;<a href="https://arxiv.org/abs/1905.03337">arXiv:1905.03337</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), ggplot2 (&ge; 3.0), momentchi2 (&ge; 0.1.5),
GreedyExperimentalDesign (&ge; 1.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kapelner/OptimalRerandExpDesigns">https://github.com/kapelner/OptimalRerandExpDesigns</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-25 20:09:23 UTC; kapel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-28 12:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='complete_randomization_plus_one_min_one'>Implements the complete randomization design (CRD) AKA Bernoulli Trial</h2><span id='topic+complete_randomization_plus_one_min_one'></span>

<h3>Description</h3>

<p>Implements the complete randomization design (CRD) AKA Bernoulli Trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complete_randomization_plus_one_min_one(n, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complete_randomization_plus_one_min_one_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="complete_randomization_plus_one_min_one_+3A_r">r</code></td>
<td>
<p>number of randomized designs you would like</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix where each column is one of the <code>r</code> designs
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='complete_randomization_with_forced_balance_plus_one_min_one'>Implements the balanced complete randomization design (BCRD)</h2><span id='topic+complete_randomization_with_forced_balance_plus_one_min_one'></span>

<h3>Description</h3>

<p>Implements the balanced complete randomization design (BCRD)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complete_randomization_with_forced_balance_plus_one_min_one(n, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complete_randomization_with_forced_balance_plus_one_min_one_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="complete_randomization_with_forced_balance_plus_one_min_one_+3A_r">r</code></td>
<td>
<p>number of randomized designs you would like</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix where each column is one of the <code>r</code> designs
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='compute_objective_val_plus_one_min_one_enc'>Returns the objective value given a design vector as well an an objective function.
This is code duplication since this is implemented within Java. This is only to be
run if...</h2><span id='topic+compute_objective_val_plus_one_min_one_enc'></span>

<h3>Description</h3>

<p>Returns the objective value given a design vector as well an an objective function.
This is code duplication since this is implemented within Java. This is only to be
run if...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_objective_val_plus_one_min_one_enc(
  X,
  indic_T,
  objective = "abs_sum_diff",
  inv_cov_X = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_objective_val_plus_one_min_one_enc_+3A_x">X</code></td>
<td>
<p>The n x p design matrix</p>
</td></tr>
<tr><td><code id="compute_objective_val_plus_one_min_one_enc_+3A_indic_t">indic_T</code></td>
<td>
<p>The n-length binary allocation vector</p>
</td></tr>
<tr><td><code id="compute_objective_val_plus_one_min_one_enc_+3A_objective">objective</code></td>
<td>
<p>The objective function to use. Default is <code>abs_sum_diff</code>.</p>
</td></tr>
<tr><td><code id="compute_objective_val_plus_one_min_one_enc_+3A_inv_cov_x">inv_cov_X</code></td>
<td>
<p>Optional: the inverse sample variance covariance matrix. Use this
argument if you will be doing many calculations since passing this
in will cache this data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of computed objective values.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='frob_norm_sq'>Naive Frobenius Norm Squared</h2><span id='topic+frob_norm_sq'></span>

<h3>Description</h3>

<p>Compute naive / vanilla squared Frobenius Norm of matrix A
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frob_norm_sq(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frob_norm_sq_+3A_a">A</code></td>
<td>
<p>The matrix of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Frobenius Norm of <code>A</code> squared.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='frob_norm_sq_debiased'>Debiased Frobenius Norm Squared Var-Cov matrix</h2><span id='topic+frob_norm_sq_debiased'></span>

<h3>Description</h3>

<p>Compute debiased Frobenius Norm of matrix Sigmahat (Appendix 5.8). Note
that for S &lt;= 2, it returns the naive estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frob_norm_sq_debiased(
  Sigmahat,
  s,
  n,
  frob_norm_sq_bias_correction_min_samples = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frob_norm_sq_debiased_+3A_sigmahat">Sigmahat</code></td>
<td>
<p>The var-cov matrix of interest</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_+3A_s">s</code></td>
<td>
<p>The number of vectors <code>Sigmahat</code> was generated from</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_+3A_n">n</code></td>
<td>
<p>The length of each vector</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_+3A_frob_norm_sq_bias_correction_min_samples">frob_norm_sq_bias_correction_min_samples</code></td>
<td>
<p>This estimate suffers from high variance when there are not enough samples. Thus, we only implement
the correction beginning at this number of samples otherwise we return the naive estimate. Default is 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The unbiased estimate of the Frobenius Norm of a variance-covariance matrix squared.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='frob_norm_sq_debiased_times_matrix'>Debiased Frobenius Norm Squared Constant Times Var-Cov matrix</h2><span id='topic+frob_norm_sq_debiased_times_matrix'></span>

<h3>Description</h3>

<p>Compute debiased Frobenius Norm of matrix P times Sigmahat (Appendix 5.9). Note
that for S &lt;= 2, it returns the naive estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frob_norm_sq_debiased_times_matrix(
  Sigmahat,
  A,
  s,
  n,
  frob_norm_sq_bias_correction_min_samples = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frob_norm_sq_debiased_times_matrix_+3A_sigmahat">Sigmahat</code></td>
<td>
<p>The var-cov matrix of interest</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_times_matrix_+3A_a">A</code></td>
<td>
<p>The matrix that multiplies Sigmahat</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_times_matrix_+3A_s">s</code></td>
<td>
<p>The number of vectors <code>Sigmahat</code> was generated from</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_times_matrix_+3A_n">n</code></td>
<td>
<p>The length of each vector</p>
</td></tr>
<tr><td><code id="frob_norm_sq_debiased_times_matrix_+3A_frob_norm_sq_bias_correction_min_samples">frob_norm_sq_bias_correction_min_samples</code></td>
<td>
<p>This estimate suffers from high variance when there are not enough samples. Thus, we only implement
the correction beginning at this number of samples otherwise we return the naive estimate. Default is 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The unbiased estimate of the Frobenius Norm of <code>A</code> times a variance-covariance matrix quantity squared.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='generate_W_base_and_sort'>Generate Base Assignments and Sorts</h2><span id='topic+generate_W_base_and_sort'></span>

<h3>Description</h3>

<p>Generates the base vectors to be used when locating the optimal rerandomization threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_W_base_and_sort(
  X,
  max_designs = 25000,
  imbalance_function = "mahal_dist",
  r = 0,
  max_max_iters = 5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_W_base_and_sort_+3A_x">X</code></td>
<td>
<p>The data as an <code class="reqn">n \times p</code> matrix.</p>
</td></tr>
<tr><td><code id="generate_W_base_and_sort_+3A_max_designs">max_designs</code></td>
<td>
<p>The maximum number of designs. Default is 25,000.</p>
</td></tr>
<tr><td><code id="generate_W_base_and_sort_+3A_imbalance_function">imbalance_function</code></td>
<td>
<p>A string indicating the imbalance function. Currently,
&quot;abs_sum_difference&quot; and &quot;mahal_dist&quot; are the options with the
latter being the default.</p>
</td></tr>
<tr><td><code id="generate_W_base_and_sort_+3A_r">r</code></td>
<td>
<p>An experimental feature that adds lower imbalance vectors
to the base set using the <code>GreedyExperimentalDesign</code>
package. This controls the number of vectors to search through
on each iteration.</p>
</td></tr>
<tr><td><code id="generate_W_base_and_sort_+3A_max_max_iters">max_max_iters</code></td>
<td>
<p>An experimental feature that adds lower imbalance vectors
to the base set using the <code>GreedyExperimentalDesign</code>
package. The maximum number of iterations to use for the greedy search.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including all arguments plus a matrix <code>W_base_sorted</code>
whose <code>max_designs</code> rows are <code>n</code>-length allocation vectors
and the allocation vectors are in
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>


<h3>Examples</h3>

<pre><code class='language-R'> n = 100
 p = 10
 X = matrix(rnorm(n * p), nrow = n, ncol = p)
 X = apply(X, 2, function(xj){(xj - mean(xj)) / sd(xj)})
 S = 1000
 
 W_base_obj = generate_W_base_and_sort(X, max_designs = S)
 W_base_obj
</code></pre>

<hr>
<h2 id='optimal_rerandomization_exact'>Find the Optimal Rerandomization Design Exactly</h2><span id='topic+optimal_rerandomization_exact'></span>

<h3>Description</h3>

<p>Finds the optimal rerandomization threshold based on a user-defined quantile
and a function that generates the non-linear component of the response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal_rerandomization_exact(
  W_base_object,
  estimator = "linear",
  q = 0.95,
  skip_search_length = 1,
  smoothing_degree = 1,
  smoothing_span = 0.1,
  z_sim_fun,
  N_z = 1000,
  dot_every_x_iters = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimal_rerandomization_exact_+3A_w_base_object">W_base_object</code></td>
<td>
<p>An object that contains the assignments to begin with sorted by</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_estimator">estimator</code></td>
<td>
<p>&quot;linear&quot; for the covariate-adjusted linear regression estimator (default).</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_q">q</code></td>
<td>
<p>The tail criterion's quantile of MSE over z's. The default is 95%.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_skip_search_length">skip_search_length</code></td>
<td>
<p>In the exhaustive search, how many designs are skipped? Default is 1 for 
full exhaustive search through all assignments provided for in <code>W_base_object</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_smoothing_degree">smoothing_degree</code></td>
<td>
<p>The smoothing degree passed to <code>loess</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_smoothing_span">smoothing_span</code></td>
<td>
<p>The smoothing span passed to <code>loess</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_z_sim_fun">z_sim_fun</code></td>
<td>
<p>This function returns vectors of numeric values of size <code>n</code>. No default is provided.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_n_z">N_z</code></td>
<td>
<p>The number of times to simulate z's within each strategy.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_exact_+3A_dot_every_x_iters">dot_every_x_iters</code></td>
<td>
<p>Print out a dot every this many iterations. The default is 100. Set to
<code>NULL</code> for no printout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal design threshold, strategy, and
other information.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
 n = 100
 p = 10
 X = matrix(rnorm(n * p), nrow = n, ncol = p)
 X = apply(X, 2, function(xj){(xj - mean(xj)) / sd(xj)})
 S = 25000
 
 W_base_obj = generate_W_base_and_sort(X, max_designs = S)
 design = optimal_rerandomization_exact(W_base_obj, 
				z_sim_fun = function(){rnorm(n)}, 
				skip_search_length = 10)
 design
	
</code></pre>

<hr>
<h2 id='optimal_rerandomization_normality_assumed'>Find the Optimal Rerandomization Design Under the Gaussian Approximation</h2><span id='topic+optimal_rerandomization_normality_assumed'></span>

<h3>Description</h3>

<p>Finds the optimal rerandomization threshold based on a user-defined quantile
and a function that generates the non-linear component of the response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal_rerandomization_normality_assumed(
  W_base_object,
  estimator = "linear",
  q = 0.95,
  skip_search_length = 1,
  dot_every_x_iters = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimal_rerandomization_normality_assumed_+3A_w_base_object">W_base_object</code></td>
<td>
<p>An object that contains the assignments to begin with sorted by</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_normality_assumed_+3A_estimator">estimator</code></td>
<td>
<p>&quot;linear&quot; for the covariate-adjusted linear regression estimator (default).</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_normality_assumed_+3A_q">q</code></td>
<td>
<p>The tail criterion's quantile of MSE over z's. The default is 95%.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_normality_assumed_+3A_skip_search_length">skip_search_length</code></td>
<td>
<p>In the exhaustive search, how many designs are skipped? Default is 1 for 
full exhaustive search through all assignments provided for in <code>W_base_object</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_normality_assumed_+3A_dot_every_x_iters">dot_every_x_iters</code></td>
<td>
<p>Print out a dot every this many iterations. The default is 100. Set to
<code>NULL</code> for no printout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal design threshold, strategy, and
other information.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
 n = 100
 p = 10
 X = matrix(rnorm(n * p), nrow = n, ncol = p)
 X = apply(X, 2, function(xj){(xj - mean(xj)) / sd(xj)})
 S = 25000
 
 W_base_obj = generate_W_base_and_sort(X, max_designs = S)
 design = optimal_rerandomization_normality_assumed(W_base_obj, 
				skip_search_length = 10)
 design
	
</code></pre>

<hr>
<h2 id='optimal_rerandomization_tail_approx'>Find the Optimal Rerandomization Design Under the Tail and Kurtosis Approximation</h2><span id='topic+optimal_rerandomization_tail_approx'></span>

<h3>Description</h3>

<p>Finds the optimal rerandomization threshold based on a user-defined quantile
and kurtosis based on an approximation of tail standard errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal_rerandomization_tail_approx(
  W_base_object,
  estimator = "linear",
  q = 0.95,
  c_val = NULL,
  skip_search_length = 1,
  binary_search = FALSE,
  excess_kurtosis_z = 0,
  use_frob_norm_sq_unbiased_estimator = TRUE,
  frob_norm_sq_bias_correction_min_samples = 10,
  smoothing_degree = 1,
  smoothing_span = 0.1,
  dot_every_x_iters = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_w_base_object">W_base_object</code></td>
<td>
<p>An object that contains the assignments to begin with sorted by imbalance.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_estimator">estimator</code></td>
<td>
<p>&quot;linear&quot; for the covariate-adjusted linear regression estimator (default).</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_q">q</code></td>
<td>
<p>The tail criterion's quantile of MSE over z's. The default is 95%.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_c_val">c_val</code></td>
<td>
<p>The c value used (see Equation 8 in the paper). The default is <code>NULL</code> corresponding to <code>qnorm(q)</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_skip_search_length">skip_search_length</code></td>
<td>
<p>In the exhaustive search, how many designs are skipped? Default is 1 for 
full exhaustive search through all assignments provided for in <code>W_base_object</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_binary_search">binary_search</code></td>
<td>
<p>If <code>TRUE</code>, a binary search is employed to find the optimal threshold instead of 
an exhaustive search. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_excess_kurtosis_z">excess_kurtosis_z</code></td>
<td>
<p>An estimate of the excess kurtosis in the measure on z. Default is 0.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_use_frob_norm_sq_unbiased_estimator">use_frob_norm_sq_unbiased_estimator</code></td>
<td>
<p>If <code>TRUE</code>, this would use the debiased Frobenius norm estimator
instead of the naive. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_frob_norm_sq_bias_correction_min_samples">frob_norm_sq_bias_correction_min_samples</code></td>
<td>
<p>The bias-corrected estimate suffers from high variance when there 
are not enough samples. Thus, we only implement
the correction beginning at this number of vectors. Default is 10 and
this parameter is only applicable if <code>use_frob_norm_sq_unbiased_estimator</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_smoothing_degree">smoothing_degree</code></td>
<td>
<p>The smoothing degree passed to <code>loess</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_smoothing_span">smoothing_span</code></td>
<td>
<p>The smoothing span passed to <code>loess</code>.</p>
</td></tr>
<tr><td><code id="optimal_rerandomization_tail_approx_+3A_dot_every_x_iters">dot_every_x_iters</code></td>
<td>
<p>Print out a dot every this many iterations. The default is 100. Set to
<code>NULL</code> for no printout.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal design threshold, strategy, and
other information.
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
 n = 100
 p = 10
 X = matrix(rnorm(n * p), nrow = n, ncol = p)
 X = apply(X, 2, function(xj){(xj - mean(xj)) / sd(xj)})
 S = 25000
 
 W_base_obj = generate_W_base_and_sort(X, max_designs = S)
 design = optimal_rerandomization_tail_approx(W_base_obj, 
				skip_search_length = 10)
 design
	
</code></pre>

<hr>
<h2 id='OptimalRerandExpDesigns'>Optimal Rerandomization Threshold Search for Experimental Design</h2><span id='topic+OptimalRerandExpDesigns'></span>

<h3>Description</h3>

<p>A tool to find the optimal rerandomization threshold in non-sequential experiments
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner <a href="mailto:kapelner@qc.cuny.edu">kapelner@qc.cuny.edu</a>
</p>


<h3>References</h3>

<p>Kapelner, A
</p>

<hr>
<h2 id='plot.optimal_rerandomization_obj'>Plots a summary of a <code>optimal_rerandomization_obj</code> object</h2><span id='topic+plot.optimal_rerandomization_obj'></span>

<h3>Description</h3>

<p>Plots a summary of a <code>optimal_rerandomization_obj</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optimal_rerandomization_obj'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.optimal_rerandomization_obj_+3A_x">x</code></td>
<td>
<p>The <code>optimal_rerandomization_obj</code> object to be summarized in the plot</p>
</td></tr>
<tr><td><code id="plot.optimal_rerandomization_obj_+3A_...">...</code></td>
<td>
<p>The option <code>advanced = TRUE</code> can be passed here for optimal rerandomization 
results from algorithm type &quot;approx&quot; to see how all the terms in the criterion behave.
You can pass <code>s_min</code> which controls the minimum number of vectors the plot begins at. 
Below a certain number, the criterion is unstable.
Also, <code>title</code>, <code>subtitle</code>, <code>xlab</code> and <code>ylab</code> can be passed here.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='plot.W_base_object'>Plots a summary of the imbalances in a <code>W_base_object</code> object</h2><span id='topic+plot.W_base_object'></span>

<h3>Description</h3>

<p>Plots a summary of the imbalances in a <code>W_base_object</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'W_base_object'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.W_base_object_+3A_x">x</code></td>
<td>
<p>The <code>W_base_object</code> object to be summarized in the plot</p>
</td></tr>
<tr><td><code id="plot.W_base_object_+3A_...">...</code></td>
<td>
<p><code>title</code>, <code>subtitle</code>, <code>xlab</code>, <code>bins</code> can 
be specified here to be passed to the ggplot plotting function.
Also <code>log10</code> can be set to <code>FALSE</code> to not log the x-axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='print.optimal_rerandomization_obj'>Prints a summary of a <code>optimal_rerandomization_obj</code> object</h2><span id='topic+print.optimal_rerandomization_obj'></span>

<h3>Description</h3>

<p>Prints a summary of a <code>optimal_rerandomization_obj</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optimal_rerandomization_obj'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.optimal_rerandomization_obj_+3A_x">x</code></td>
<td>
<p>The <code>optimal_rerandomization_obj</code> object to be summarized in the console</p>
</td></tr>
<tr><td><code id="print.optimal_rerandomization_obj_+3A_...">...</code></td>
<td>
<p>Other parameters to pass to the default print function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='print.W_base_object'>Prints a summary of a <code>W_base_object</code> object</h2><span id='topic+print.W_base_object'></span>

<h3>Description</h3>

<p>Prints a summary of a <code>W_base_object</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'W_base_object'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.W_base_object_+3A_x">x</code></td>
<td>
<p>The <code>W_base_object</code> object to be summarized in the console</p>
</td></tr>
<tr><td><code id="print.W_base_object_+3A_...">...</code></td>
<td>
<p>Other parameters to pass to the default print function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='summary.optimal_rerandomization_obj'>Prints a summary of a <code>optimal_rerandomization_obj</code> object</h2><span id='topic+summary.optimal_rerandomization_obj'></span>

<h3>Description</h3>

<p>Prints a summary of a <code>optimal_rerandomization_obj</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'optimal_rerandomization_obj'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.optimal_rerandomization_obj_+3A_object">object</code></td>
<td>
<p>The <code>optimal_rerandomization_obj</code> object to be summarized in the console</p>
</td></tr>
<tr><td><code id="summary.optimal_rerandomization_obj_+3A_...">...</code></td>
<td>
<p>Other parameters to pass to the default summary function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

<hr>
<h2 id='summary.W_base_object'>Prints a summary of a <code>W_base_object</code> object</h2><span id='topic+summary.W_base_object'></span>

<h3>Description</h3>

<p>Prints a summary of a <code>W_base_object</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'W_base_object'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.W_base_object_+3A_object">object</code></td>
<td>
<p>The <code>W_base_object</code> object to be summarized in the console</p>
</td></tr>
<tr><td><code id="summary.W_base_object_+3A_...">...</code></td>
<td>
<p>Other parameters to pass to the default summary function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Kapelner
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
