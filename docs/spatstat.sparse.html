<!DOCTYPE html><html><head><title>Help for package spatstat.sparse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spatstat.sparse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spatstat.sparse-package'><p>The spatstat.sparse Package</p></a></li>
<li><a href='#aperm.sparse3Darray'>
<p>Transposition of Sparse Array</p></a></li>
<li><a href='#as.array.sparse3Darray'>
<p>Convert Sparse Array to Full Array</p></a></li>
<li><a href='#as.sparse3Darray'>
<p>Convert Data to a Sparse Three-Dimensional Array</p></a></li>
<li><a href='#bind.sparse3Darray'>
<p>Combine Three-Dimensional Sparse Arrays</p></a></li>
<li><a href='#Extract.sparse3Darray'><p>Extract or Replace Entries in a Sparse Array</p></a></li>
<li><a href='#gridadjacencymatrix'>
<p>Create Adjacency Matrix for Spatial Grid</p></a></li>
<li><a href='#marginSumsSparse'>
<p>Margin Sums of a Sparse Matrix or Sparse Array</p></a></li>
<li><a href='#Math.sparse3Darray'><p>S3 Group Generic Methods for Sparse Three-Dimensional Arrays</p></a></li>
<li><a href='#matrixpower'>
<p>Power of a Matrix</p></a></li>
<li><a href='#methods.sparse3Darray'>
<p>Methods for Sparse Three-Dimensional Arrays</p></a></li>
<li><a href='#sparse3Darray'>
<p>Create a Sparse Three-Dimensional Array</p></a></li>
<li><a href='#spatstat.sparse-internal'><p>Internal Functions of spatstat.sparse Package</p></a></li>
<li><a href='#sumouter'><p>Compute Quadratic Forms</p></a></li>
<li><a href='#tensorSparse'>
<p>Tensor Product of Sparse Vectors, Matrices or Arrays</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.0-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>Title:</td>
<td>Sparse Three-Dimensional Arrays and Linear Algebra Utilities</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrian Baddeley &lt;Adrian.Baddeley@curtin.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats, utils, methods, Matrix, abind, tensor</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat.utils (&ge; 3.0-2)</td>
</tr>
<tr>
<td>Description:</td>
<td>Defines sparse three-dimensional arrays
	     and supports standard operations on them.
	     The package also includes utility functions for
	     matrix calculations that are common in
	     statistics, such as quadratic forms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://spatstat.org/">http://spatstat.org/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/spatstat/spatstat.sparse/issues">https://github.com/spatstat/spatstat.sparse/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 04:58:31 UTC; adrian</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrian Baddeley <a href="https://orcid.org/0000-0001-9499-8382"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Rolf Turner <a href="https://orcid.org/0000-0001-5521-5218"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph],
  Ege Rubak <a href="https://orcid.org/0000-0002-6675-533X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 05:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spatstat.sparse-package'>The spatstat.sparse Package</h2><span id='topic+spatstat.sparse-package'></span><span id='topic+spatstat.sparse'></span>

<h3>Description</h3>

<p>The <span class="pkg">spatstat.sparse</span> package defines three-dimensional
sparse arrays, and supports standard operations on them.
It also provides some utility functions for matrix calculations
such as quadratic forms.
</p>


<h3>Details</h3>

<p>The <span class="pkg">spatstat.sparse</span> package
</p>

<ul>
<li><p> defines a class of sparse three-dimensional arrays
and supports standard operations on them
(see Section <em>Sparse 3D Arrays</em>).
</p>
</li>
<li><p> provides utility functions for matrix computations
that are common in statistics,
such as quadratic forms (see Section <em>Matrix Utilities</em>).
</p>
</li></ul>

<p>The code in <span class="pkg">spatstat.sparse</span> was originally written
for internal use within the <span class="pkg">spatstat</span> package, but has now been
removed and organised into a separate, stand-alone package
which can be used for other purposes.
</p>


<h3>Sparse 3D Arrays</h3>

<p>The main purpose of <span class="pkg">spatstat.sparse</span> is to 
define a class of sparse three-dimensional arrays.
</p>
<p>An array <code>A</code> is three-dimensional if it is indexed by
three integer indices, so that <code>A[i,j,k]</code> specifies an element of
the array. The array is called sparse if only a small fraction of the
entries are non-zero. A sparse array can be represented economically
by listing only the entries which are non-zero.
</p>
<p>The <span class="pkg">spatstat.sparse</span> package defines the class
<code>sparse3Darray</code> of sparse three-dimensional arrays.
These arrays can have numeric, integer, logical, or complex
entries. 
</p>
<p>The package supports:
</p>

<ul>
<li><p> creation of sparse arrays from raw data
</p>
</li>
<li><p> conversion to/from other data types
</p>
</li>
<li><p> array indexing, extraction of entries, assignment of new values
</p>
</li>
<li><p> arithmetic and logical operations
</p>
</li>
<li><p> tensor operations (generalising matrix multiplication)
</p>
</li>
<li><p> permutation of array dimensions
</p>
</li>
<li><p> binding of several arrays into a single array
</p>
</li>
<li><p> printing of sparse arrays.
</p>
</li></ul>

<p>The <span class="pkg">spatstat.sparse</span> package uses the <span class="pkg">Matrix</span> package to
handle slices of three-dimensional arrays which are two-dimensional
(sparse matrices) or one-dimensional (sparse vectors).
</p>
<p>The main functions are:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+sparse3Darray">sparse3Darray</a></code> </td><td style="text-align: left;"> Create a sparse 3D array </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code> </td><td style="text-align: left;"> Convert other data to a sparse
    3D array </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic++5B.sparse3Darray">[.sparse3Darray</a></code> </td><td style="text-align: left;"> Subset operator </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+aperm.sparse3Darray">aperm.sparse3Darray</a></code> </td><td style="text-align: left;"> Permute a sparse array </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Ops.sparse3Darray">Ops.sparse3Darray</a></code> </td><td style="text-align: left;"> arithmetic and logical operators </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Complex.sparse3Darray">Complex.sparse3Darray</a></code> </td><td style="text-align: left;"> complex operators </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Math.sparse3Darray">Math.sparse3Darray</a></code></td><td style="text-align: left;"> standard mathematical functions </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+Summary.sparse3Darray">Summary.sparse3Darray</a></code> </td><td style="text-align: left;"> mean, maximum etc </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+tensorSparse">tensorSparse</a></code> </td><td style="text-align: left;"> Tensor product </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+as.array.sparse3Darray">as.array.sparse3Darray</a></code> </td><td style="text-align: left;"> Convert sparse array to full array </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>
    
<p>The class <code>"sparse3Darray"</code> has
methods for <code>anyNA</code>, <code>dim</code>, <code>dim&lt;-</code>,
<code>dimnames</code>, <code>dimnames&lt;-</code> and <code>print</code>,
documented in <code><a href="#topic+methods.sparse3Darray">methods.sparse3Darray</a></code>.
</p>
<p>For other undocumented functions,
see <code><a href="#topic+spatstat.sparse-internal">spatstat.sparse-internal</a></code>.
</p>


<h3>Matrix Utilities</h3>

<p>The package also includes some utilities for matrix calculations:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+sumouter">sumouter</a></code> </td><td style="text-align: left;"> sum of outer products of rows of a matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+quadform">quadform</a></code> </td><td style="text-align: left;"> quadratic form involving rows of a matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+bilinearform">bilinearform</a></code> </td><td style="text-align: left;"> bilinear form involving rows of a matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+matrixsqrt">matrixsqrt</a></code> </td><td style="text-align: left;"> square root of a matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code><a href="#topic+matrixpower">matrixpower</a></code> </td><td style="text-align: left;"> powers of a matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>




<h3>Licence</h3>

<p>This library and its documentation are usable under the terms of the
&ldquo;GNU General Public License&rdquo;,
a copy of which is distributed with <span class="rlang"><b>R</b></span>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>

<hr>
<h2 id='aperm.sparse3Darray'>
Transposition of Sparse Array
</h2><span id='topic+aperm.sparse3Darray'></span>

<h3>Description</h3>

<p>Transpose a sparse three-dimensional array by permuting its dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'sparse3Darray'
aperm(a, perm = NULL, resize = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aperm.sparse3Darray_+3A_a">a</code></td>
<td>

<p>A sparse three-dimensional array (object of class <code>"sparse3Darray"</code>).
</p>
</td></tr>
<tr><td><code id="aperm.sparse3Darray_+3A_perm">perm</code></td>
<td>

<p>The subscript permutation vector, a permutation of the integers <code>1:3</code>.
</p>
</td></tr>
<tr><td><code id="aperm.sparse3Darray_+3A_resize">resize</code></td>
<td>

<p>Logical value specifying whether the dimensions and dimnames of the array
should also be adjusted, by permuting them according to the permutation.
</p>
</td></tr>
<tr><td><code id="aperm.sparse3Darray_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="base.html#topic+aperm">aperm</a></code> is generic. This is the method
for the class <code>"sparse3Darray"</code> of sparse three-dimensional
arrays.
</p>


<h3>Value</h3>

<p>Another sparse three-dimensional array
(object of class <code>"sparse3Darray"</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>,
<code><a href="#topic+tensorSparse">tensorSparse</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:4, j=sample(1:4, replace=TRUE),
                     k=c(1,2,1,2), x=1:4, dims=c(5,7,2))
  dim(M)
  P &lt;- aperm(M, c(3,1,2))
  dim(P)
</code></pre>

<hr>
<h2 id='as.array.sparse3Darray'>
Convert Sparse Array to Full Array
</h2><span id='topic+as.array.sparse3Darray'></span>

<h3>Description</h3>

<p>Convert a sparse three-dimensional array to a full three-dimensional array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sparse3Darray'
as.array(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.array.sparse3Darray_+3A_x">x</code></td>
<td>

<p>Sparse three-dimensional array
(object of class <code>"sparse3Darray"</code>).
</p>
</td></tr>
<tr><td><code id="as.array.sparse3Darray_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a method for the generic <code><a href="base.html#topic+as.array">as.array</a></code>
for sparse three-dimensional arrays (class <code>"sparse3Darray"</code>).
It converts the sparse three-dimensional array <code>x</code> into
an <code><a href="base.html#topic+array">array</a></code> representing the same data.
</p>


<h3>Value</h3>

<p>An array (class <code>"array"</code>) with the same dimensions as <code>x</code>
and the same type of entries as <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>,
<code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:3, j=c(3,1,2), k=4:2,
                     x=runif(3), dims=rep(4, 3))
  V &lt;- as.array(M)
</code></pre>

<hr>
<h2 id='as.sparse3Darray'>
Convert Data to a Sparse Three-Dimensional Array
</h2><span id='topic+as.sparse3Darray'></span>

<h3>Description</h3>

<p>Convert other kinds of data to a sparse three-dimensional array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.sparse3Darray(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.sparse3Darray_+3A_x">x</code></td>
<td>

<p>Data in another format (see Details).
</p>
</td></tr>
<tr><td><code id="as.sparse3Darray_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts data in various formats
into a sparse three-dimensional array (object of class
<code>"sparse3Darray"</code>).
</p>
<p>The argument <code>x</code> can be
</p>

<ul>
<li><p> a sparse three-dimensional array (class <code>"sparse3Darray"</code>)
</p>
</li>
<li><p> an <code>array</code>
</p>
</li>
<li><p> a <code>matrix</code>,
which will be interpreted as an array
with dimension <code>c(dim(x), 1)</code>
</p>
</li>
<li><p> a sparse matrix (inheriting class <code>"sparseMatrix"</code> in the
<span class="pkg">Matrix</span> package)
which will be interpreted as an array
with dimension <code>c(dim(x), 1)</code>
</p>
</li>
<li><p> a vector of atomic values,
which will be interpreted as an array of dimension
<code>c(length(x), 1, 1)</code>
</p>
</li>
<li><p> a sparse vector (inheriting class <code>"sparseVector"</code> in the
<span class="pkg">Matrix</span> package)
which will be interpreted as an array of dimension <code>c(x@length, 1, 1)</code>
</p>
</li>
<li><p> a list of matrices with the same dimensions,
which will be interpreted as slices <code>A[,,k]</code> of an array <code>A</code>
</p>
</li>
<li><p> a list of sparse matrices (each inheriting class
<code>"sparseMatrix"</code> in the <span class="pkg">Matrix</span> package) with the same
dimensions,
which will be interpreted as slices <code>A[,,k]</code> of an array <code>A</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>Sparse three-dimensional array (object of class <code>"sparse3Darray"</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  A &lt;- array(c(1,3,0,0,0,0,0,4,0,2,0,5,
               0,0,1,0,0,0,1,0,0,0,1,0),
             dim=c(3,4,2))
  #' array to sparse array
  B &lt;- as.sparse3Darray(A) # positive extent
  #' list of matrices to sparse array
  B &lt;- as.sparse3Darray(list(A[,,1], A[,,2]))
  #' matrix to sparse array
  B1 &lt;- as.sparse3Darray(A[,,1])
  #' vector to sparse array
  B11 &lt;- as.sparse3Darray(A[,1,1])
</code></pre>

<hr>
<h2 id='bind.sparse3Darray'>
Combine Three-Dimensional Sparse Arrays
</h2><span id='topic+bind.sparse3Darray'></span>

<h3>Description</h3>

<p>Two sparse arrays will be joined to make a larger sparse array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind.sparse3Darray(A, B, along)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind.sparse3Darray_+3A_a">A</code>, <code id="bind.sparse3Darray_+3A_b">B</code></td>
<td>

<p>Sparse three-dimensional arrays
(objects of class <code>"sparse3Darray"</code>)
or data acceptable to <code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code>.
</p>
</td></tr>
<tr><td><code id="bind.sparse3Darray_+3A_along">along</code></td>
<td>

<p>The dimension along which the two arrays will be joined.
An integer from 1 to 3. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This operation is similar to <code><a href="base.html#topic+rbind">rbind</a></code>, <code><a href="base.html#topic+cbind">cbind</a></code>
and <code><a href="abind.html#topic+abind">abind</a></code>. The two 3D arrays <code>A</code> and <code>B</code>
will be joined to make a larger 3D array by concatenating them along
the dimension specified by <code>along</code>.
</p>
<p>The arguments <code>A</code> and <code>B</code> should be sparse three-dimensional arrays
(objects of class <code>"sparse3Darray"</code>)
or data acceptable to <code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code>.
They must have identical array dimensions except in the dimension
specified by <code>along</code>.
</p>


<h3>Value</h3>

<p>A sparse three-dimensional array (object of class <code>"sparse3Darray"</code>).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code>,
<code><a href="#topic+methods.sparse3Darray">methods.sparse3Darray</a></code>.
</p>
<p>See <code><a href="abind.html#topic+abind">abind</a></code> for joining non-sparse arrays.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:3, j=c(3,1,2), k=4:2,
                     x=runif(3), dims=rep(4, 3))
  dim(M)
  U &lt;- M[ , 1:3, ]
  dim(U)
  V &lt;- bind.sparse3Darray(M, U, along=2)
  dim(V)
</code></pre>

<hr>
<h2 id='Extract.sparse3Darray'>Extract or Replace Entries in a Sparse Array</h2><span id='topic++5B.sparse3Darray'></span><span id='topic++5B+3C-.sparse3Darray'></span>

<h3>Description</h3>

<p>Extract or replace entries in a sparse three-dimensional array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'sparse3Darray'
x[i, j, k, drop=TRUE, ...]
  ## S3 replacement method for class 'sparse3Darray'
x[i, j, k, ...] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract.sparse3Darray_+3A_x">x</code></td>
<td>

<p>Sparse three-dimensional array
(object of class <code>"sparse3Darray"</code>).
</p>
</td></tr>
<tr><td><code id="Extract.sparse3Darray_+3A_i">i</code>, <code id="Extract.sparse3Darray_+3A_j">j</code>, <code id="Extract.sparse3Darray_+3A_k">k</code></td>
<td>

<p>Subset indices for each dimension of the array. See Details.
</p>
</td></tr>
<tr><td><code id="Extract.sparse3Darray_+3A_value">value</code></td>
<td>

<p>Replacement value for the subset. 
</p>
</td></tr>
<tr><td><code id="Extract.sparse3Darray_+3A_drop">drop</code></td>
<td>

<p>Logical value indicating whether to return a lower-dimensional
object (matrix or vector) when appropriate.
</p>
</td></tr>
<tr><td><code id="Extract.sparse3Darray_+3A_...">...</code></td>
<td>

<p>Ignored. This argument is required for compatibility
with the generic function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are defined for a sparse three-dimensional array <code>x</code>.
They extract a designated subset of the array,
or replace the values in the designated subset.
</p>
<p>The function <code>[.sparse3Darray</code> is a method for the generic
subset extraction operator <code><a href="base.html#topic++5B">[</a></code>.
The function <code>[&lt;-.sparse3Darray</code> is a method for the generic
subset replacement operator <code><a href="base.html#topic++5B+3C-">[&lt;-</a></code>.
</p>
<p>These methods use the same indexing rules
as the subset operator for full arrays:
</p>

<ul>
<li><p> If <code>i</code>, <code>j</code> and <code>k</code> are integer vectors,
the subset is the Cartesian product (i.e. all cells in the array
identified by an entry of <code>i</code>, an entry of <code>j</code> and
an entry of <code>k</code>).
</p>
</li>
<li><p> Some or all of the arguments <code>i</code>, <code>j</code> and <code>k</code>
may be missing from the call; a missing index argument is
interpreted as meaning that all possible values of that index are
allowed.
</p>
</li>
<li><p> Arguments <code>i</code>, <code>j</code> and <code>k</code> may be logical
vectors (with the value <code>TRUE</code> assigned to entries that should
be included).
</p>
</li>
<li><p> Arguments <code>i</code>, <code>j</code> and <code>k</code> may be
character vectors with entries matching the corresponding
<code>dimnames</code>.
</p>
</li>
<li><p> Argument <code>i</code> may be an integer matrix with 3 columns
(and the arguments <code>j,k</code> should be absent).
Each row of the matrix contains the indices
of one cell in the array.
</p>
</li></ul>

<p>If the designated subset lies within the array bounds, then
the result of <code>[</code> will be a sparse three-dimensional array,
sparse matrix or sparse vector. If <code>drop=FALSE</code> the result
will always be three-dimensional; if <code>drop=TRUE</code> (the default)
the result will be reduced to two or one dimensions when appropriate.
</p>
<p>If the designated subset <em>does not</em> lie within the array bounds, then
the result of <code>[</code> will be a full three-dimensional array,
matrix or vector containing <code>NA</code> values at the positions that
were outside the array bounds.
</p>
<p>The result of <code>[&lt;-</code> is always a sparse three-dimensional array.
If the designated subset did not lie within the array bounds of
<code>x</code>, then the array bounds will be extended (with a warning message).
</p>


<h3>Value</h3>

<p><code>[.sparse3Darray</code> returns either
a sparse three-dimensional array (class <code>"sparse3Darray"</code>),
a sparse matrix (class <code>sparseMatrix</code> in the <span class="pkg">Matrix</span> package),
a sparse vector (class <code>sparseVector</code> in the <span class="pkg">Matrix</span> package),
or in some cases a full array, matrix or vector.
</p>
<p><code>[&lt;-.sparse3Darray</code> returns another sparse three-dimensional
array.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>,
<code><a href="#topic+methods.sparse3Darray">methods.sparse3Darray</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:4, j=sample(1:4, replace=TRUE),
                     k=c(1,2,1,2), x=1:4, dims=c(5,5,2))
  dimnames(M) &lt;- list(letters[1:5], LETTERS[1:5], c("yes", "no"))
  M[ 3:4, , ]
  M[ 3:4, 2:4, ]
  M[ 4:3, 4:2, 1:2]
  M[, 3, ]
</code></pre>

<hr>
<h2 id='gridadjacencymatrix'>
Create Adjacency Matrix for Spatial Grid
</h2><span id='topic+gridadjacencymatrix'></span>

<h3>Description</h3>

<p>Given the dimensions of a rectangular grid of points, this command
creates the adjacency matrix for the corresponding neighbourhood
graph, whose vertices are the grid points, and whose edges are the
joins between neighbouring grid points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridadjacencymatrix(dims, across = TRUE, down = TRUE, diagonal=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gridadjacencymatrix_+3A_dims">dims</code></td>
<td>

<p>Grid dimensions. An integer, or a vector of two integers.
First entry specifies the number of points in the <code class="reqn">y</code> direction.
</p>
</td></tr>
<tr><td><code id="gridadjacencymatrix_+3A_across">across</code></td>
<td>

<p>Logical value equal to <code>TRUE</code> if horizontal neighbours should
be joined.
</p>
</td></tr>
<tr><td><code id="gridadjacencymatrix_+3A_down">down</code></td>
<td>

<p>Logical value equal to <code>TRUE</code> if vertical neighbours should
be joined.
</p>
</td></tr>
<tr><td><code id="gridadjacencymatrix_+3A_diagonal">diagonal</code></td>
<td>

<p>Logical value equal to <code>TRUE</code> if diagonal neighbours should
be joined.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>N = prod(dims)</code> is the total number of grid points,
then the result is an <code>N * N</code> sparse matrix with logical entries
equal to <code>TRUE</code> if the corresponding grid points are joined.
</p>


<h3>Value</h3>

<p>A sparse matrix. 
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  gridadjacencymatrix(c(2,3))  
</code></pre>

<hr>
<h2 id='marginSumsSparse'>
Margin Sums of a Sparse Matrix or Sparse Array
</h2><span id='topic+marginSumsSparse'></span>

<h3>Description</h3>

<p>For a sparse matrix or sparse array, compute the sum of array entries
for a specified margin or margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginSumsSparse(X, MARGIN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginSumsSparse_+3A_x">X</code></td>
<td>

<p>A matrix, an array,
a sparse matrix (of class <code>"sparseMatrix"</code> from the
<span class="pkg">Matrix</span> package) or a sparse three-dimensional array
(of class <code>"sparse3Darray"</code> from the
<span class="pkg">spatstat.sparse</span> package).
</p>
</td></tr>
<tr><td><code id="marginSumsSparse_+3A_margin">MARGIN</code></td>
<td>

<p>Integer or integer vector specifying the margin or margins.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the equivalent of
<code><a href="base.html#topic+apply">apply</a>(X, MARGIN, sum)</code>
for sparse matrices and arrays <code>X</code>. The argument <code>X</code> may be
</p>

<ul>
<li><p> a matrix
</p>
</li>
<li><p> an array of any number of dimensions
</p>
</li>
<li><p> a sparse matrix (object inheriting class <code>"sparseMatrix"</code>
in the <span class="pkg">Matrix</span> package)
</p>
</li>
<li><p> a sparse three-dimensional array (of class
<code>"sparse3Darray"</code> 
from the <span class="pkg">spatstat.sparse</span> package).
</p>
</li></ul>

<p>In the first two cases, the computation is performed by
calling   <code><a href="base.html#topic+apply">apply</a>(X, MARGIN, sum)</code>
and the result is a vector, matrix or array.
In the last two cases, the result is a single value, a sparse vector,
a sparse matrix, or a sparse three-dimensional array.
</p>


<h3>Value</h3>

<p>A single value, vector, matrix, array,
sparse vector (class <code>"sparseVector"</code> in the <span class="pkg">Matrix</span>
package), sparse matrix (class <code>"sparseMatrix"</code> in the
<span class="pkg">Matrix</span> package), or sparse three-dimensional array
(class <code>"sparse3Darray"</code> 
from the <span class="pkg">spatstat.sparse</span> package).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+apply">apply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:3, j=c(3,1,2), k=4:2,
                     x=round(runif(3), 2), dims=rep(4, 3))
  marginSumsSparse(M, 1:2)
  marginSumsSparse(M, 1)
  marginSumsSparse(M, integer(0)) # equivalent to sum(M)
</code></pre>

<hr>
<h2 id='Math.sparse3Darray'>S3 Group Generic Methods for Sparse Three-Dimensional Arrays</h2><span id='topic+Math.sparse3Darray'></span><span id='topic+Ops.sparse3Darray'></span><span id='topic+Complex.sparse3Darray'></span><span id='topic+Summary.sparse3Darray'></span>

<h3>Description</h3>

<p>Group generic methods which make it possible to
apply the familiar mathematical operators and functions
to sparse three-dimensional arrays (objects of class
<code>"sparse3Darray"</code>).
See Details for a list of implemented functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 methods for group generics have prototypes:
Math(x, ...)
Ops(e1, e2)
Complex(z)
Summary(..., na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Math.sparse3Darray_+3A_x">x</code>, <code id="Math.sparse3Darray_+3A_z">z</code>, <code id="Math.sparse3Darray_+3A_e1">e1</code>, <code id="Math.sparse3Darray_+3A_e2">e2</code></td>
<td>

<p>Sparse three-dimensional arrays (objects of class
<code>"sparse3Darray"</code>). Alternatively <code>e1</code> or <code>e2</code> can be
a single scalar, vector, sparse vector, matrix or sparse matrix.
</p>
</td></tr>
<tr><td><code id="Math.sparse3Darray_+3A_...">...</code></td>
<td>
<p>further arguments passed to methods.</p>
</td></tr>
<tr><td><code id="Math.sparse3Darray_+3A_na.rm">na.rm</code></td>
<td>

<p>Logical value specifying whether missing values
should be removed. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These group generics make it possible to
perform element-wise arithmetic and logical operations
with sparse three-dimensional arrays, or apply mathematical functions
element-wise, or compute standard summaries such as the mean and maximum.
</p>
<p>Below is a list of mathematical functions and operators which are
defined for sparse 3D arrays. 
</p>

<ol>
<li><p> Group <code>"Math"</code>:
</p>

<ul>
<li>
<p><code>abs</code>, <code>sign</code>, <code>sqrt</code>,<br />
<code>floor</code>, <code>ceiling</code>, <code>trunc</code>,<br />
<code>round</code>, <code>signif</code>
</p>
</li>
<li>
<p><code>exp</code>, <code>log</code>,  <code>expm1</code>, <code>log1p</code>,<br />
<code>cos</code>, <code>sin</code>, <code>tan</code>,<br />
<code>cospi</code>, <code>sinpi</code>, <code>tanpi</code>,<br />
<code>acos</code>, <code>asin</code>, <code>atan</code>
</p>
<p><code>cosh</code>, <code>sinh</code>, <code>tanh</code>,<br />
<code>acosh</code>, <code>asinh</code>, <code>atanh</code>
</p>
</li>
<li>
<p><code>lgamma</code>, <code>gamma</code>, <code>digamma</code>, <code>trigamma</code>
</p>
</li>
<li> <p><code>cumsum</code>, <code>cumprod</code>, <code>cummax</code>, <code>cummin</code>
</p>
</li></ul>

</li>
<li><p> Group <code>"Ops"</code>:
</p>

<ul>
<li>
<p><code>"+"</code>, <code>"-"</code>, <code>"*"</code>, <code>"/"</code>,
<code>"^"</code>, <code>"%%"</code>, <code>"%/%"</code>
</p>
</li>
<li> <p><code>"&amp;"</code>, <code>"|"</code>, <code>"!"</code>
</p>
</li>
<li> <p><code>"=="</code>, <code>"!="</code>,
<code>"&lt;"</code>, <code>"&lt;="</code>, <code>"&gt;="</code>, <code>"&gt;"</code>
</p>
</li></ul>

</li>
<li><p> Group <code>"Summary"</code>:
</p>

<ul>
<li> <p><code>all</code>, <code>any</code>
</p>
</li>
<li> <p><code>sum</code>, <code>prod</code>
</p>
</li>
<li> <p><code>min</code>, <code>max</code>
</p>
</li>
<li> <p><code>range</code>
</p>
</li></ul>

</li>
<li><p> Group <code>"Complex"</code>:
</p>

<ul>
<li> <p><code>Arg</code>, <code>Conj</code>, <code>Im</code>, <code>Mod</code>, <code>Re</code>
</p>
</li></ul>

</li></ol>



<h3>Value</h3>

<p>The result of group <code>"Math"</code> functions is another 
three-dimensional array of the same dimensions as <code>x</code>,
which is sparse if the function maps 0 to 0, and otherwise is a
full three-dimensional array.
</p>
<p>The result of group <code>"Ops"</code> operators is 
another three-dimensional array of the same dimensions as
<code>e1</code> and <code>e2</code>, which is sparse if both <code>e1</code> and
<code>e2</code> are sparse.
</p>
<p>The result of group <code>"Complex"</code> functions is 
another sparse three-dimensional array of the same dimensions as
<code>z</code>.
</p>
<p>The result of group <code>"Summary"</code> functions is
a logical value or a numeric value or a numeric vector of length 2.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>,
<code><a href="#topic+tensorSparse">tensorSparse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:4, j=sample(1:4, replace=TRUE),
                     k=c(1,2,1,2), x=1:4, dims=c(5,5,2))
  negM &lt;- -M
  twoM &lt;- M + M
  Mplus &lt;- M + 1 ## not sparse!
  posM &lt;- (M &gt; 0)
  range(M)
  sinM &lt;- sin(M)
  cosM &lt;- cos(M) ## not sparse!
  expM1 &lt;- expm1(M)
</code></pre>

<hr>
<h2 id='matrixpower'>
Power of a Matrix
</h2><span id='topic+matrixpower'></span><span id='topic+matrixsqrt'></span><span id='topic+matrixinvsqrt'></span>

<h3>Description</h3>

<p>Evaluate a specified power of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  matrixpower(x, power, complexOK = TRUE)
  matrixsqrt(x, complexOK = TRUE)
  matrixinvsqrt(x, complexOK = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrixpower_+3A_x">x</code></td>
<td>

<p>A square matrix containing numeric or complex values.
</p>
</td></tr>
<tr><td><code id="matrixpower_+3A_power">power</code></td>
<td>

<p>A numeric value giving the power (exponent) to which <code>x</code> should
be raised.
</p>
</td></tr>
<tr><td><code id="matrixpower_+3A_complexok">complexOK</code></td>
<td>

<p>Logical value indicating whether the result is allowed to be complex.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions raise the matrix <code>x</code> to the desired power:
<code>matrixsqrt</code> takes the square root, <code>matrixinvsqrt</code> takes
the inverse square root, and <code>matrixpower</code> takes the specified
power of <code>x</code>.
</p>
<p>Up to numerical error, <code>matrixpower(x, 2)</code> should be equivalent
to <code>x %*% x</code>, and <code>matrixpower(x, -1)</code> should be
equivalent to <code>solve(x)</code>, the inverse of <code>x</code>. 
</p>
<p>The square root <code>y &lt;- matrixsqrt(x)</code> should satisfy
<code>y %*% y = x</code>. The inverse square root
<code>z &lt;- matrixinvsqrt(x)</code> should satisfy <code>z %*% z = solve(x)</code>.
</p>
<p>Computations are performed using the eigen decomposition
(<code><a href="base.html#topic+eigen">eigen</a></code>).
</p>


<h3>Value</h3>

<p>A matrix of the same size as <code>x</code> containing
numeric or complex values.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+eigen">eigen</a></code>, <code><a href="base.html#topic+svd">svd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- matrix(c(10,2,2,1), 2, 2)
  y &lt;- matrixsqrt(x)
  y
  y %*% y 
  z &lt;- matrixinvsqrt(x)
  z %*% y
  matrixpower(x, 0.1)
</code></pre>

<hr>
<h2 id='methods.sparse3Darray'>
Methods for Sparse Three-Dimensional Arrays
</h2><span id='topic+methods.sparse3Darray'></span><span id='topic+anyNA.sparse3Darray'></span><span id='topic+dim.sparse3Darray'></span><span id='topic+dim+3C-.sparse3Darray'></span><span id='topic+dimnames.sparse3Darray'></span><span id='topic+dimnames+3C-.sparse3Darray'></span><span id='topic+print.sparse3Darray'></span>

<h3>Description</h3>

<p>Methods for the class <code>"sparse3Darray"</code>
of sparse three-dimensional arrays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'sparse3Darray'
anyNA(x, recursive = FALSE)
 ## S3 method for class 'sparse3Darray'
dim(x)
 ## S3 replacement method for class 'sparse3Darray'
dim(x) &lt;- value
 ## S3 method for class 'sparse3Darray'
dimnames(x)
 ## S3 replacement method for class 'sparse3Darray'
dimnames(x) &lt;- value
 ## S3 method for class 'sparse3Darray'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="methods.sparse3Darray_+3A_x">x</code></td>
<td>

<p>A sparse three-dimensional array (object of class <code>"sparse3Darray"</code>).
</p>
</td></tr>
<tr><td><code id="methods.sparse3Darray_+3A_value">value</code></td>
<td>

<p>Replacement value (see Details).
</p>
</td></tr>
<tr><td><code id="methods.sparse3Darray_+3A_recursive">recursive</code>, <code id="methods.sparse3Darray_+3A_...">...</code></td>
<td>

<p>Ignored.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are methods for the generics
<code><a href="base.html#topic+anyNA">anyNA</a></code>,
<code><a href="base.html#topic+dim">dim</a></code>,
<code><a href="base.html#topic+dim+3C-">dim&lt;-</a></code>,
<code><a href="base.html#topic+dimnames">dimnames</a></code>,
<code><a href="base.html#topic+dimnames+3C-">dimnames&lt;-</a></code>
and <code><a href="base.html#topic+print">print</a></code>
for the class <code>"sparse#Darray"</code> of sparse three-dimensional
arrays.
</p>
<p>For <code>dimnames(x) &lt;- value</code>, the <code>value</code> should either be
<code>NULL</code>, or a list of length 3 containing character vectors giving
the names of the margins.
</p>
<p>For <code>dim(x) &lt;- value</code>, the <code>value</code> should be an integer
vector of length 3 giving the new dimensions of the array. Note that this
operation does not change the array positions of the non-zero entries
(unlike <code>dim(x) &lt;- value</code> for a full array). An error occurs if
some of the non-zero entries would lie outside the new extent of the array.
</p>


<h3>Value</h3>

<p><code>anyNA</code> returns a single logical value.
</p>
<p><code>dim</code> returns an integer vector of length 3.
</p>
<p><code>dimnames</code> returns <code>NULL</code>, or a list of length 3
whose entries are character vectors.
</p>
<p><code>dim&lt;-</code> and <code>dimnames&lt;-</code> return a sparse 3D array.
</p>
<p><code>print</code> returns <code>NULL</code>, invisibly.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> M &lt;- sparse3Darray(i=1:4, j=sample(1:4, replace=TRUE),
                    k=c(1,2,1,2), x=1:4, dims=c(5,5,2))

 anyNA(M)
 dim(M)
 dimnames(M)
 dimnames(M) &lt;- list(letters[1:5], LETTERS[1:5], c("Yes", "No"))
 print(M)
</code></pre>

<hr>
<h2 id='sparse3Darray'>
Create a Sparse Three-Dimensional Array
</h2><span id='topic+sparse3Darray'></span>

<h3>Description</h3>

<p>Create a sparse representation of a three-dimensional array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparse3Darray(i = integer(0), j = integer(0), k = integer(0),
              x = numeric(0),
              dims = c(max(i), max(j), max(k)), dimnames = NULL,
              strict = FALSE, nonzero = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparse3Darray_+3A_i">i</code>, <code id="sparse3Darray_+3A_j">j</code>, <code id="sparse3Darray_+3A_k">k</code></td>
<td>

<p>Integer vectors of equal length (or length 1), specifying the cells in the
array which have non-zero entries.
</p>
</td></tr>
<tr><td><code id="sparse3Darray_+3A_x">x</code></td>
<td>

<p>Vector (numeric, integer, logical or complex)
of the same length as <code>i</code>, <code>j</code> and <code>k</code>,
giving the values of the array entries that are not zero.
</p>
</td></tr>
<tr><td><code id="sparse3Darray_+3A_dims">dims</code></td>
<td>

<p>Dimension of the array. An integer vector of length 3.
</p>
</td></tr>
<tr><td><code id="sparse3Darray_+3A_dimnames">dimnames</code></td>
<td>

<p>Names for the three margins of the array. Either <code>NULL</code>
or a list of three character vectors.
</p>
</td></tr>
<tr><td><code id="sparse3Darray_+3A_strict">strict</code></td>
<td>

<p>Logical value specifying whether to enforce the rule that
each entry in <code>i,j,k,x</code> refers to a different cell.
If <code>strict=TRUE</code>, entries which refer to the same cell
in the array will be reduced to a single entry by summing the
<code>x</code> values. Default is <code>strict=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="sparse3Darray_+3A_nonzero">nonzero</code></td>
<td>

<p>Logical value specifying whether to remove any entries
of <code>x</code> which equal zero.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An array <code>A</code> is three-dimensional if it is indexed by
three integer indices, so that <code>A[i,j,k]</code> specifies an element of
the array. The array is called sparse if only a small fraction of the
entries are non-zero. A sparse array can be represented economically
by listing only the entries which are non-zero.
</p>
<p>The <span class="pkg">spatstat.sparse</span> package defines the class
<code>sparse3Darray</code> of sparse three-dimensional arrays.
These arrays can have numeric, integer, logical, or complex
entries.
</p>
<p>The function <code>sparse3Darray</code> creates an object of class
<code>"sparse3Darray"</code>. This object is essentially a list containing
the vectors <code>i,j,k,x</code> and the arguments <code>dims,dimnames</code>.
</p>
<p>The arguments <code>i,j,k,x</code> should be vectors of equal length 
identifying the cells in the array which have non-zero entries (indexed
by <code>i,j,k</code>) and giving the values in these cells (given by <code>x</code>).
</p>
<p>The default behaviour of <code>sparse3Darray</code>
is to accept the arguments <code>i,j,k,x</code> without modifying them.
This would allow some entries of <code>x</code> to be equal to zero,
and would allow a cell in the array to be referenced more than once
in the indices <code>i,j,k</code>.
</p>
<p>If <code>nonzero=TRUE</code>, entries will be removed if the <code>x</code> value
equals zero.
</p>
<p>If <code>strict=TRUE</code>, entries which refer to the same cell in the
array will be combined into a single entry by summing the <code>x</code> values.
</p>


<h3>Value</h3>

<p>An object of class <code>"sparse3Darray"</code>.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.sparse3Darray">as.sparse3Darray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## creation by specifying nonzero elements
  M &lt;- sparse3Darray(i=1:3, j=c(3,1,2), k=4:2,
                     x=runif(3), dims=rep(4, 3))
  M
  ## duplicate entries
  Mn &lt;- sparse3Darray(i=c(1,1,2), j=c(2,2,1), k=c(3,3,2),
                     x=runif(3), dims=rep(3, 3))
  ## cumulate entries in duplicate positions
  Ms &lt;- sparse3Darray(i=c(1,1,2), j=c(2,2,1), k=c(3,3,2),
                      x=runif(3), dims=rep(3, 3), strict=TRUE)
</code></pre>

<hr>
<h2 id='spatstat.sparse-internal'>Internal Functions of spatstat.sparse Package</h2><span id='topic+spatstat.sparse-internal'></span><span id='topic+representativeRows'></span><span id='topic+checksolve'></span><span id='topic+check.mat.mul'></span><span id='topic+sumsymouter'></span><span id='topic+unionOfSparseIndices'></span><span id='topic+inside3Darray'></span><span id='topic+SparseEntries'></span><span id='topic+SparseIndices'></span><span id='topic+EntriesToSparse'></span><span id='topic+mapSparseEntries'></span><span id='topic+applySparseEntries'></span><span id='topic+sumsymouterSparse'></span><span id='topic+rbindCompatibleDataFrames'></span><span id='topic+check.anySparseVector'></span><span id='topic+evalSparse3Dentrywise'></span><span id='topic+expandSparse'></span><span id='topic+sparseVectorCumul'></span><span id='topic+tensor1x1'></span>

<h3>Description</h3>

<p>Internal utility functions of the <code>spatstat.sparse</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>representativeRows(x)
checksolve(M, action, descrip, target)
check.mat.mul(A, B, Acols, Brows, fatal)
sumsymouter(x, w, distinct)
unionOfSparseIndices(A,B)
inside3Darray(d, i, j, k)
SparseEntries(x)
SparseIndices(x)
EntriesToSparse(df, dims)
mapSparseEntries(x, margin, values, conform, across)
applySparseEntries(x, f, ...)
sumsymouterSparse(x, w, distinct, dbg)
rbindCompatibleDataFrames(x)
check.anySparseVector(v, npoints, fatal, things,
                      naok, warn, vname, oneok)
evalSparse3Dentrywise(expr, envir)
expandSparse(x, n, across)
sparseVectorCumul(x, i, length)
tensor1x1(A, B)
</code></pre>


<h3>Details</h3>

<p>These internal <span class="pkg">spatstat.sparse</span> functions are not usually called
directly by the user. Their names and capabilities may change
without warning from one version of <span class="pkg">spatstat.utils</span> to the next.
</p>

<hr>
<h2 id='sumouter'>Compute Quadratic Forms</h2><span id='topic+sumouter'></span><span id='topic+quadform'></span><span id='topic+bilinearform'></span>

<h3>Description</h3>

<p>Calculates certain quadratic forms of matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  sumouter(x, w=NULL, y=x)
  quadform(x, v)
  bilinearform(x, v, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumouter_+3A_x">x</code>, <code id="sumouter_+3A_y">y</code></td>
<td>
<p>A matrix, whose rows are the vectors in the quadratic form.</p>
</td></tr>
<tr><td><code id="sumouter_+3A_w">w</code></td>
<td>
<p>Optional vector of weights</p>
</td></tr>
<tr><td><code id="sumouter_+3A_v">v</code></td>
<td>
<p>Matrix determining the quadratic form</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrices <code>x</code> and <code>y</code> will be interpreted as
collections of row vectors. They must have the same number of rows.
The entries of <code>x</code> and <code>y</code> may be
numeric, integer, logical or complex values.
</p>
<p>The command <code>sumouter</code> computes the sum of the outer
products of corresponding row vectors, weighted by the entries of <code>w</code>:
</p>
<p style="text-align: center;"><code class="reqn">
    M = \sum_i w_i x_i^\top y_i
  </code>
</p>

<p>where <code class="reqn">x_i</code> is the <code>i</code>-th row of <code>x</code>
and <code class="reqn">y_i</code> is the <code>i</code>-th row of <code>y</code>
(after removing any rows containing <code>NA</code> or other non-finite
values).
If <code>w</code> is missing or <code>NULL</code>, the weights will be taken as 1.
The result is a <code class="reqn">p \times q</code> matrix where
<code>p = ncol(x)</code> and <code>q = ncol(y)</code>.
</p>
<p>The command <code>quadform</code> evaluates the quadratic form, defined by
the matrix <code>v</code>, for each of the row vectors of <code>x</code>:
</p>
<p style="text-align: center;"><code class="reqn"> 
    y_i = x_i V x_i^\top
  </code>
</p>

<p>The result <code>y</code> is a numeric vector of length <code>n</code> where
<code>n = nrow(x)</code>. If <code>x[i,]</code> contains <code>NA</code> or
other non-finite values, then <code>y[i] = NA</code>.
If <code>v</code> is missing or <code>NULL</code>,
it will be taken as the identity matrix, so
that the resulting values will be
</p>
<p style="text-align: center;"><code class="reqn"> 
    y_i = x_i x_i^\top
  </code>
</p>

<p>The command <code>bilinearform</code> evaluates the more general bilinear
form defined by the matrix <code>v</code>. Here <code>x</code> and <code>y</code> must
be matrices of the same dimensions. For each row vector of
<code>x</code> and corresponding row vector of <code>y</code>, the bilinear form is
</p>
<p style="text-align: center;"><code class="reqn"> 
   z_i = x_i V y_i^\top
  </code>
</p>

<p>The result <code>z</code> is a numeric vector of length <code>n</code> where
<code>n = nrow(x)</code>. If <code>x[i,]</code> or <code>y[i,]</code> contains <code>NA</code> or
other non-finite values, then <code>z[i] = NA</code>.
If <code>v</code> is missing or <code>NULL</code>,
it will be taken as the identity matrix, so
that the resulting values will be
</p>
<p style="text-align: center;"><code class="reqn"> 
    z_i = x_i y_i^\top
  </code>
</p>



<h3>Value</h3>

<p>A vector or matrix.
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>
and Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- matrix(1:12, 4, 3)
  dimnames(x) &lt;- list(c("Wilma", "Fred", "Barney", "Betty"), letters[1:3])
  x

  sumouter(x)

  w &lt;- 4:1
  sumouter(x, w)
  v &lt;- matrix(1, 3, 3)
  quadform(x, v)

  # should be the same as quadform(x, v)
  bilinearform(x, v, x)

  # See what happens with NA's
  x[3,2] &lt;- NA
  sumouter(x, w)
  quadform(x, v)
</code></pre>

<hr>
<h2 id='tensorSparse'>
Tensor Product of Sparse Vectors, Matrices or Arrays
</h2><span id='topic+tensorSparse'></span>

<h3>Description</h3>

<p>Compute the tensor product of two vectors, matrices or arrays
which may be sparse or non-sparse. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tensorSparse(A, B, alongA = integer(0), alongB = integer(0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tensorSparse_+3A_a">A</code>, <code id="tensorSparse_+3A_b">B</code></td>
<td>

<p>Vectors, matrices, three-dimensional arrays,
or objects of class <code>sparseVector</code>, <code>sparseMatrix</code>
or <code>sparse3Darray</code>.
</p>
</td></tr>
<tr><td><code id="tensorSparse_+3A_alonga">alongA</code></td>
<td>

<p>Integer vector specifying the dimensions of <code>A</code> to be collapsed.
</p>
</td></tr>
<tr><td><code id="tensorSparse_+3A_alongb">alongB</code></td>
<td>

<p>Integer vector specifying the dimensions of <code>B</code> to be collapsed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a generalisation, to sparse arrays, of the function
<code><a href="tensor.html#topic+tensor">tensor</a></code> in the <span class="pkg">tensor</span> package.
</p>
<p><code>tensorSparse</code> has the same syntax and interpretation
as <code><a href="tensor.html#topic+tensor">tensor</a></code>.
For example, if <code>A</code> and <code>B</code> are matrices, then
<code>tensor(A,B,2,1)</code> is the matrix product <code>A %*% B</code>
while <code>tensor(A,B,2,2)</code> is <code>A %*% t(B)</code>.
</p>
<p>This function <code>tensorSparse</code> handles
sparse vectors (class <code>"sparseVector"</code> in the <span class="pkg">Matrix</span> package), 
sparse matrices (class <code>"sparseMatrix"</code> in the <span class="pkg">Matrix</span>
package) and sparse three-dimensional arrays (class
<code>"sparse3Darray"</code> in the <span class="pkg">spatstat.sparse</span> package)
in addition to the usual vectors, matrices and arrays.
</p>
<p>The result is a sparse object if at least one of <code>A</code> and <code>B</code>
is sparse. Otherwise, if neither <code>A</code> nor <code>B</code> is sparse, then the
result is computed using <code><a href="tensor.html#topic+tensor">tensor</a></code>.
</p>
<p>The main limitation is that the result cannot have more than 3
dimensions (because sparse arrays with more than 3 dimensions are not yet
supported).
</p>


<h3>Value</h3>

<p>Either a scalar, a vector, a matrix, an array,
a sparse vector (class <code>"sparseVector"</code> in the <span class="pkg">Matrix</span> package), 
a sparse matrix (class <code>"sparseMatrix"</code> in the <span class="pkg">Matrix</span>
package) or a sparse three-dimensional array (class
<code>"sparse3Darray"</code> in the <span class="pkg">spatstat.sparse</span> package).
</p>


<h3>Author(s)</h3>

<p>Adrian Baddeley <a href="mailto:Adrian.Baddeley@curtin.edu.au">Adrian.Baddeley@curtin.edu.au</a>, Rolf Turner <a href="mailto:rolfturner@posteo.net">rolfturner@posteo.net</a> and Ege Rubak <a href="mailto:rubak@math.aau.dk">rubak@math.aau.dk</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparse3Darray">sparse3Darray</a></code>,
<code><a href="#topic+aperm.sparse3Darray">aperm.sparse3Darray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- sparse3Darray(i=1:4, j=sample(1:4, replace=TRUE),
                     k=c(1,2,1,2), x=1:4, dims=c(5,5,2))
  A &lt;- tensorSparse(M, M, 1:2, 2:1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
