<!DOCTYPE html><html><head><title>Help for package qrmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qrmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bisquare'><p>Tukey's Bisquare Loss</p></a></li>
<li><a href='#blood.pressure'><p>Blood Pressure Data for qrmix</p></a></li>
<li><a href='#Huber'><p>Huber Loss</p>
</p></a></li>
<li><a href='#plot.qrmix'><p>Plot Method for a qrmix Object</p>
</p></a></li>
<li><a href='#predict.qrmix'><p>Predict Method for qrmix Fits</p>
</p></a></li>
<li><a href='#qrmix'><p>Quantile Regression Classification</p>
</p></a></li>
<li><a href='#summary.qrmix'><p>Summarizing qrmix Fits</p>
</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantile Regression Mixture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Maria de los Angeles Resa, Birol Emir, Javier Cabrera</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria de los Angeles Resa &lt;maria@stat.columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the robust algorithm for fitting finite mixture models based on quantile regression proposed by Emir et al., 2017 (unpublished).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, quantreg</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-03 17:29:11 UTC; Angeles</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-03 21:49:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bisquare'>Tukey's Bisquare Loss
</h2><span id='topic+Bisquare'></span>

<h3>Description</h3>

<p><code>"Bisquare"</code> evaluates Tukey's Bisquare function defined as
</p>
<p style="text-align: center;"><code class="reqn"> f(r) = \left\{
\begin{array}{ll}
1-(1-(\frac{r}{c})^2)^3) &amp; |r| \le c \\
1  &amp; |r| &gt; c
\end{array}
\right. </code>
</p>




<h3>Usage</h3>

<pre><code class='language-R'>Bisquare(r, c = 4.685)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bisquare_+3A_r">r</code></td>
<td>
<p>a real number or vector.</p>
</td></tr>
<tr><td><code id="Bisquare_+3A_c">c</code></td>
<td>
<p>a positive number. If the value is negative, it's absolute value will be used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
x = rnorm(200, mean = 3)
y = Bisquare(x)
plot(x, y)

</code></pre>

<hr>
<h2 id='blood.pressure'>Blood Pressure Data for qrmix
</h2><span id='topic+blood.pressure'></span>

<h3>Description</h3>

<p>Simulated blood pressure data created for usage in qrmix examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blood.pressure</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations on the following 7 variables.
</p>

<dl>
<dt><code>bmi</code></dt><dd><p>a numeric vector referring to body mass index</p>
</dd>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>systolic</code></dt><dd><p>a numeric vector referring to systolic blood pressure</p>
</dd>
<dt><code>diastolic</code></dt><dd><p>a numeric vector referring to diastolic blood pressure</p>
</dd>
<dt><code>gender</code></dt><dd><p>a factor with levels <code>female</code> and <code>male</code></p>
</dd>
<dt><code>race</code></dt><dd><p>a factor with levels <code>white</code>, <code>black</code>, and <code>other</code></p>
</dd>
<dt><code>smoking</code></dt><dd><p>a factor with levels <code>yes</code> and <code>no</code></p>
</dd>
</dl>



<h3>Note</h3>

<p>This data does not include any real patient information.
</p>

<hr>
<h2 id='Huber'>Huber Loss
</h2><span id='topic+Huber'></span>

<h3>Description</h3>

<p>Evaluates the Huber loss function defined as </p>
<p style="text-align: center;"><code class="reqn"> f(r) = \left\{
\begin{array}{ll}
\frac{1}{2}|r|^2 &amp; |r| \le c \\
c(|r|-\frac{1}{2}c)  &amp; |r| &gt; c
\end{array}
\right. </code>
</p>




<h3>Usage</h3>

<pre><code class='language-R'>Huber(r, c = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Huber_+3A_r">r</code></td>
<td>
<p>a real number or vector.
</p>
</td></tr>
<tr><td><code id="Huber_+3A_c">c</code></td>
<td>
<p>a positive number. If the value is negative, it's absolute value will be used.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
x = rnorm(200, mean = 1)
y = Huber(x)
plot(x, y)
abline(h = (1.345)^2/2)

</code></pre>

<hr>
<h2 id='plot.qrmix'>Plot Method for a qrmix Object
</h2><span id='topic+plot.qrmix'></span>

<h3>Description</h3>

<p>Three types of plots (chosen with <code>type</code>) are currently available: density of the response variable by cluster, plots of the response variable against each covariate included in the model (scatterplots with the k fitted lines for continues variables and boxplots by cluster for the categorical variables), and boxplots of the residuals by cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qrmix'
plot(x, data = NULL, type = c(1,2,3), lwd = 2, bw = "SJ", adjust = 2, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.qrmix_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>"qrmix"</code>.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_data">data</code></td>
<td>
<p>the data used to fit the model <code>object</code>. It is only necessary when the when the parameter <code>xy</code> was set to FALSE when fitting the qrmix model.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_type">type</code></td>
<td>
<p>a numeric vector with values chosen from 1:3 to specify a subset of types of plots required.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_lwd">lwd</code></td>
<td>
<p>the line width for the first type of plot (density plot), a positive number. If a negative number is given, <code>lwd = 1</code> will be used instead. See <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_bw">bw</code></td>
<td>
<p>the smoothing bandwidth to be used to obtain the density for the first type of plot. See <code><a href="stats.html#topic+density">density</a></code> for details.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_adjust">adjust</code></td>
<td>
<p>the bandwidth used is adjust*bw. See <code><a href="stats.html#topic+density">density</a></code> for details.
</p>
</td></tr>
<tr><td><code id="plot.qrmix_+3A_...">...</code></td>
<td>
<p>other argumets passed to other methods.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(blood.pressure)

#qrmix model using default function values:
mod1 = qrmix(bmi ~ ., data = blood.pressure, k = 3)
plot(mod1)
plot(mod1, type = c(1,3), lwd = 1)

</code></pre>

<hr>
<h2 id='predict.qrmix'>Predict Method for qrmix Fits
</h2><span id='topic+predict.qrmix'></span>

<h3>Description</h3>

<p>Obtains clusters, predictions, or residuals from a fitted qrmix object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qrmix'
predict(object, newdata = NULL, type = "clusters", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.qrmix_+3A_object">object</code></td>
<td>

<p>a fitted object of class <code>"qrmix"</code>.
</p>
</td></tr>
<tr><td><code id="predict.qrmix_+3A_newdata">newdata</code></td>
<td>

<p>optional data frame for which clusters, predictions, or residuals will be obtained from the qrmix fitted object. If omitted, the training values will be used.
</p>
</td></tr>
<tr><td><code id="predict.qrmix_+3A_type">type</code></td>
<td>
<p>the type of prediction. <code>type = "clusters"</code> (default value) for predicted clusters, <code>"yhat"</code> for the response predicted value corresponding to the predicted cluste, <code>"residuals"</code> for the residuals corresponding to the response predicted values.
</p>
</td></tr>
<tr><td><code id="predict.qrmix_+3A_...">...</code></td>
<td>
<p>other argumets passed to other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with predicted clusters, responses, or residuals, depending on <code>type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(blood.pressure)

set.seed(8)
sampleInd = sort(sample(1:500, 400))
bpSample1 = blood.pressure[sampleInd,]
bpSample2 = blood.pressure[-sampleInd,]

mod1 = qrmix(bmi ~ ., data = bpSample1, k = 3)

#Cluster assigned to the training values
predict(mod1)

#Residuals corresponding to the response predicted values from mod1 for new data
predict(mod1, newdata = bpSample2, type = "residuals")

</code></pre>

<hr>
<h2 id='qrmix'>Quantile Regression Classification
</h2><span id='topic+qrmix'></span>

<h3>Description</h3>

<p><code>qrmix</code> estimates the components of a finite mixture model by using quantile regression  to select a group of quantiles that satisfy an optimality criteria chosen by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qrmix(formula, data, k, Ntau=50, alpha=0.03, lossFn="Squared", fitMethod="lm",
xy=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qrmix_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code>.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_data">data</code></td>
<td>
<p>an optional data frame that contains the variables in <code>formula</code>.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_k">k</code></td>
<td>
<p>number of clusters.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_ntau">Ntau</code></td>
<td>
<p>an optional value that indicates the number of quantiles that will be considered for quantile regression comparison. <code>Ntau</code> should be greater or equal than <code class="reqn">2k</code>.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_alpha">alpha</code></td>
<td>
<p>an optional value that will determine the minimum separation between the k quantiles that represent each of the k clusters. <code>alpha</code> should be smaller than <code class="reqn">\frac{1}{2k}</code>.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_lossfn">lossFn</code></td>
<td>
<p>the loss function to be used to select the best combination of k quantiles. The available functions are <code>"Squared"</code>, <code>"Absolute"</code>, <code>"Bisquare"</code>, and <code>"Huber"</code>.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_fitmethod">fitMethod</code></td>
<td>
<p>the method to be used for the final fitting. Use <code>"lm"</code> for OLS (default), <code>"rlm"</code> for robust regression, and <code>"rq"</code> to use fit from quantile regression.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_xy">xy</code></td>
<td>
<p>logical. If <code>TRUE</code> (the default), the data will be saved in the qrmix object.
</p>
</td></tr>
<tr><td><code id="qrmix_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the function determined in <code>fitMethod</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The optimality criteria is determined by the <code>lossFn</code> parameter. If, for example, the default value is used (<code>lossFn = "Squared"</code>), the <code>k</code> quantiles selected will minimize the sum of squared residuals. Use <code>"Bisquare"</code> or <code>"Huber"</code> to make the method less sensitive to outliers.
</p>


<h3>Value</h3>

<p><code>qrmix</code> returns an object of class &quot;qrmix&quot;
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a matrix with k columns that represent the coefficients for each cluster.</p>
</td></tr>
<tr><td><code>clusters</code></td>
<td>
<p>cluster assignment for each observation.</p>
</td></tr>
<tr><td><code>quantiles</code></td>
<td>
<p>the set of k quantiles that minimize the mean loss.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, response minus fitted values.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>xy</code></td>
<td>
<p>the data used if xy is set to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Emir, B., Willke, R. J., Yu, C. R., Zou, K. H., Resa, M. A., and Cabrera, J. (2017), &quot;A Comparison and Integration of Quantile Regression and Finite Mixture Modeling&quot; (submitted).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(blood.pressure)

#qrmix model using default function values:
mod1 = qrmix(bmi ~ ., data = blood.pressure, k = 3)
summary(mod1)

#qrmix model using Bisquare loss function and refitted with robust regression:
mod2 = qrmix(bmi ~ age + systolic + diastolic + gender, data = blood.pressure, k = 3,
Ntau = 25, alpha = 0.1, lossFn = "Bisquare", fitMethod = "rlm")
summary(mod2)



</code></pre>

<hr>
<h2 id='summary.qrmix'>Summarizing qrmix Fits
</h2><span id='topic+summary.qrmix'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>"qrmix"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qrmix'
summary(object, fitMethod=NULL, data=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.qrmix_+3A_object">object</code></td>
<td>
<p>an object of class <code>"qrmix"</code>.
</p>
</td></tr>
<tr><td><code id="summary.qrmix_+3A_fitmethod">fitMethod</code></td>
<td>
<p>an optional refitting method if the user wants a method different than the one used to obtain <code>"object"</code> Use <code>"lm"</code> for OLS, <code>"rlm"</code> for robust regression, and <code>"rq"</code> to use fit from quantile regression.
</p>
</td></tr>
<tr><td><code id="summary.qrmix_+3A_data">data</code></td>
<td>
<p>data used to fit <code>object</code> if it is not contained in <code>object</code>.
</p>
</td></tr>
<tr><td><code id="summary.qrmix_+3A_...">...</code></td>
<td>
<p>other argumets passed to other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, response minus fitted values.</p>
</td></tr>
<tr><td><code>clusters</code></td>
<td>
<p>cluster assignment for each observation.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>fitMethod</code></td>
<td>
<p>the fitting method used to obtain <code>residuals</code> and <code>clusters</code>.</p>
</td></tr>
<tr><td><code>quantiles</code></td>
<td>
<p>the set of k quantiles that minimize the mean loss.</p>
</td></tr>
<tr><td><code>clusters#</code></td>
<td>
<p>generic summary from function <code>fitMethod</code> for data in cluster #.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(blood.pressure)

#qrmix model using default function values:
mod1 = qrmix(bmi ~ ., data = blood.pressure, k = 3)

#summary using fitMethod = "rlm" instead of the one used when fitting the model mod1
summary1 = summary(mod1, fitMethod = "rlm")

#Are the quantiles selected in this case the same as in the original model?
summary1$quantiles
mod1$quantiles



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
