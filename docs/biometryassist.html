<!DOCTYPE html><html><head><title>Help for package biometryassist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biometryassist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#biometryassist'><p>biometryassist: Functions to Assist Design and Analysis of Agronomic Experiments</p></a></li>
<li><a href='#autoplot'><p>Generate automatic plots for objects generated in biometryassist</p></a></li>
<li><a href='#biometryassist-deprecated'><p>Deprecated functions in package <span class="pkg">biometryassist</span>.</p></a></li>
<li><a href='#create_buffers'><p>Create buffers for design plots</p></a></li>
<li><a href='#create_mac_folder'><p>Create the folder MacOS needs for licensing</p></a></li>
<li><a href='#des_info'><p>Produce a graph of design layout, skeletal ANOVA table and data frame with complete design</p></a></li>
<li><a href='#design'><p>Create a complete experimental design with graph of design layout and skeletal ANOVA table</p></a></li>
<li><a href='#get_r_os'><p>Get the version of R and OS</p></a></li>
<li><a href='#get_version_table'><p>Get released versions of ASReml-R in lookup table</p></a></li>
<li><a href='#heat_map'><p>Produce a heatmap of variables in a grid layout.</p></a></li>
<li><a href='#install_asreml'><p>Install or update the ASReml-R package</p></a></li>
<li><a href='#logl_test'><p>Conduct a log-likelihood test for comparing terms in ASReml-R models</p></a></li>
<li><a href='#multiple_comparisons'><p>Perform Multiple Comparison Tests on a statistical model</p></a></li>
<li><a href='#newer_version'><p>Compare installed version of ASReml-R with available versions</p></a></li>
<li><a href='#print.mct'><p>Print output of multiple_comparisons</p></a></li>
<li><a href='#quiet'><p>Function to suppress output if desired, especially useful for ASReml output</p></a></li>
<li><a href='#resplot'><p>Produce residual plots of linear models</p></a></li>
<li><a href='#resplt-deprecated'><p>Residual plots of linear models.</p></a></li>
<li><a href='#satab'><p>Produces a skeletal ANOVA table</p></a></li>
<li><a href='#summary_graph'><p>Visualise a graphical summary of variables from a data frame</p></a></li>
<li><a href='#vario_df'><p>Calculate the variogram data frame for a model</p></a></li>
<li><a href='#variogram'><p>Display variogram plots for spatial models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions to Assist Design and Analysis of Agronomic Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to aid in the design and analysis of
    agronomic and agricultural experiments through easy access to
    documentation and helper functions, especially for users who are
    learning these concepts. While not required for most functionality,
    this package enhances the &lsquo;asreml' package which provides a 
    computationally efficient algorithm for fitting mixed models 
    using Residual Maximum Likelihood. It is a commercial package 
    that can be purchased as &rsquo;asreml-R' from 'VSNi' 
    <a href="https://vsni.co.uk/">https://vsni.co.uk/</a>, who will supply a zip file for local 
    installation/updating (see <a href="https://asreml.kb.vsni.co.uk/">https://asreml.kb.vsni.co.uk/</a>). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://biometryhub.github.io/biometryassist/">https://biometryhub.github.io/biometryassist/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/biometryhub/biometryassist/issues">https://github.com/biometryhub/biometryassist/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>agricolae, askpass, cowplot, curl, emmeans, farver, ggplot2,
lattice, multcompView, pracma, rlang (&ge; 1.0.0), scales,
stringi, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, crayon, knitr, rmarkdown, testthat, vdiffr, withr</td>
</tr>
<tr>
<td>Enhances:</td>
<td>asreml, ARTool, lme4, nlme, sommer</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-04 09:02:09 UTC; holly</td>
</tr>
<tr>
<td>Author:</td>
<td>Sharon Nielsen [aut],
  Sam Rogers [aut, cre],
  Annie Conway [aut],
  University of Adelaide [cph, fnd] (https://adelaide.edu.au/),
  Grains Research and Development Corporation [cph, fnd]
    (https://grdc.com.au/)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sam Rogers &lt;biometrytraining@adelaide.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-05 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='biometryassist'>biometryassist: Functions to Assist Design and Analysis of Agronomic Experiments</h2><span id='topic+biometryassist'></span><span id='topic+biometryassist-package'></span>

<h3>Description</h3>

<p>Provides functions to aid in the design and analysis of agronomic and agricultural experiments through easy access to documentation and helper functions, especially for users who are learning these concepts. While not required for most functionality, this package enhances the &lsquo;asreml' package which provides a computationally efficient algorithm for fitting mixed models using Residual Maximum Likelihood. It is a commercial package that can be purchased as &rsquo;asreml-R' from 'VSNi' <a href="https://vsni.co.uk/">https://vsni.co.uk/</a>, who will supply a zip file for local installation/updating (see <a href="https://asreml.kb.vsni.co.uk/">https://asreml.kb.vsni.co.uk/</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sam Rogers <a href="mailto:biometrytraining@adelaide.edu.au">biometrytraining@adelaide.edu.au</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Sharon Nielsen <a href="mailto:biometrytraining@adelaide.edu.au">biometrytraining@adelaide.edu.au</a>
</p>
</li>
<li><p> Annie Conway <a href="mailto:biometrytraining@adelaide.edu.au">biometrytraining@adelaide.edu.au</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> University of Adelaide (https://adelaide.edu.au/) [copyright holder, funder]
</p>
</li>
<li><p> Grains Research and Development Corporation (https://grdc.com.au/) [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://biometryhub.github.io/biometryassist/">https://biometryhub.github.io/biometryassist/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/biometryhub/biometryassist/issues">https://github.com/biometryhub/biometryassist/issues</a>
</p>
</li></ul>


<hr>
<h2 id='autoplot'>Generate automatic plots for objects generated in biometryassist</h2><span id='topic+autoplot'></span><span id='topic+autoplot.mct'></span><span id='topic+autoplot.design'></span>

<h3>Description</h3>

<p>Generate automatic plots for objects generated in biometryassist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoplot(object, ...)

## S3 method for class 'mct'
autoplot(
  object,
  size = 4,
  label_height = 0.1,
  rotation = 0,
  axis_rotation = rotation,
  label_rotation = rotation,
  ...
)

## S3 method for class 'design'
autoplot(
  object,
  rotation = 0,
  size = 4,
  margin = FALSE,
  palette = "default",
  buffer = NULL,
  row = NULL,
  column = NULL,
  block = NULL,
  treatments = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot_+3A_object">object</code></td>
<td>
<p>An object to create a plot for. Currently objects from the <code><a href="#topic+multiple_comparisons">multiple_comparisons()</a></code> or <code><a href="#topic+design">design()</a></code> functions with class &quot;mct&quot; or &quot;design&quot; respectively are supported.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_...">...</code></td>
<td>
<p>Arguments passed to methods.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_size">size</code></td>
<td>
<p>Increase or decrease the text size within the plot for treatment labels. Numeric with default value of 4.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_label_height">label_height</code></td>
<td>
<p>Height of the text labels above the upper error bar on the plot. Default is 0.1 (10%) of the difference between upper and lower error bars above the top error bar. Values &gt; 1 are interpreted as the actual value above the upper error bar.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_rotation">rotation</code></td>
<td>
<p>Rotate the x axis labels and the treatment group labels within the plot. Allows for easier reading of long axis or treatment labels. Number between 0 and 360 (inclusive) - default 0</p>
</td></tr>
<tr><td><code id="autoplot_+3A_axis_rotation">axis_rotation</code></td>
<td>
<p>Enables rotation of the x axis independently of the group labels within the plot.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_label_rotation">label_rotation</code></td>
<td>
<p>Enables rotation of the treatment group labels independently of the x axis labels within the plot.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_margin">margin</code></td>
<td>
<p>Logical (default <code>FALSE</code>). A value of <code>FALSE</code> will expand the plot to the edges of the plotting area i.e. remove white space between plot and axes.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_palette">palette</code></td>
<td>
<p>A string specifying the colour scheme to use for plotting. Default is equivalent to &quot;Spectral&quot;. Colour blind friendly palettes can also be provided via options <code>"colour blind"</code> (or <code>"color blind"</code>, both equivalent to <code>"viridis"</code>), <code>"magma"</code>, <code>"inferno"</code>, <code>"plasma"</code> or <code>"cividis"</code>. Other palettes from <code><a href="scales.html#topic+pal_brewer">scales::brewer_pal()</a></code> are also possible.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_buffer">buffer</code></td>
<td>
<p>A string specifying the buffer plots to include for plotting. Default is <code>NULL</code> (no buffers plotted). Other options are &quot;edge&quot; (outer edge of trial area), &quot;rows&quot; (between rows), &quot;columns&quot; (between columns), &quot;double row&quot; (a buffer row each side of a treatment row) or &quot;double column&quot; (a buffer row each side of a treatment column). &quot;blocks&quot; (a buffer around each treatment block) will be implemented in a future release.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_row">row</code></td>
<td>
<p>A variable to plot a column from <code>object</code> as rows.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_column">column</code></td>
<td>
<p>A variable to plot a column from <code>object</code> as columns.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_block">block</code></td>
<td>
<p>A variable to plot a column from <code>object</code> as blocks.</p>
</td></tr>
<tr><td><code id="autoplot_+3A_treatments">treatments</code></td>
<td>
<p>A variable to plot a column from <code>object</code> as treatments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiple_comparisons">multiple_comparisons()</a></code> and <code><a href="#topic+design">design()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat.aov &lt;- aov(Petal.Width ~ Species, data = iris)
output &lt;- multiple_comparisons(dat.aov, classify = "Species")
autoplot(output, label_height = 0.5)
des.out &lt;- design(type = "crd", treatments = c(1, 5, 10, 20),
                  reps = 5, nrows = 4, ncols = 5, seed = 42, plot = FALSE)
autoplot(des.out)

# Colour blind friendly colours
autoplot(des.out, palette = "colour-blind")

# Alternative colour scheme
autoplot(des.out, palette = "plasma")
</code></pre>

<hr>
<h2 id='biometryassist-deprecated'>Deprecated functions in package <span class="pkg">biometryassist</span>.</h2><span id='topic+biometryassist-deprecated'></span><span id='topic+resplt'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be removed in
the future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resplt(
  model.obj,
  shapiro = TRUE,
  call = FALSE,
  label.size = 10,
  axes.size = 10,
  call.size = 9,
  mod.obj
)
</code></pre>


<h3>Value</h3>

<p>No return value.
</p>
<p>A list containing ggplot2 objects which are diagnostic plots.
For <code>resplt</code>, use <code><a href="#topic+resplot">resplot()</a></code>.
</p>


<h3>resplt</h3>

<p>Residual plots of linear models.
</p>

<hr>
<h2 id='create_buffers'>Create buffers for design plots</h2><span id='topic+create_buffers'></span>

<h3>Description</h3>

<p>Create buffers for design plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_buffers(design, type, blocks = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_buffers_+3A_design">design</code></td>
<td>
<p>The data frame of the design.</p>
</td></tr>
<tr><td><code id="create_buffers_+3A_type">type</code></td>
<td>
<p>The type of buffer. One of edge, row, column, double row, double column, or block (coming soon).</p>
</td></tr>
<tr><td><code id="create_buffers_+3A_blocks">blocks</code></td>
<td>
<p>Does the design data frame contain blocks?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original data frame, updated to include buffers
</p>

<hr>
<h2 id='create_mac_folder'>Create the folder MacOS needs for licensing</h2><span id='topic+create_mac_folder'></span>

<h3>Description</h3>

<p>Create the folder MacOS needs for licensing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_mac_folder()
</code></pre>


<h3>Value</h3>

<p>logical; TRUE if folder successfully created, otherwise it will error
</p>

<hr>
<h2 id='des_info'>Produce a graph of design layout, skeletal ANOVA table and data frame with complete design</h2><span id='topic+des_info'></span>

<h3>Description</h3>

<p>Produce a graph of design layout, skeletal ANOVA table and data frame with complete design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>des_info(
  design.obj,
  nrows,
  ncols,
  brows = NA,
  bcols = NA,
  byrow = TRUE,
  fac.names = NULL,
  fac.sep = c("", " "),
  plot = TRUE,
  rotation = 0,
  size = 4,
  margin = FALSE,
  save = FALSE,
  savename = paste0(design.obj$parameters$design, "_design"),
  plottype = "pdf",
  return.seed = TRUE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="des_info_+3A_design.obj">design.obj</code></td>
<td>
<p>An <code>agricolae</code> design object.</p>
</td></tr>
<tr><td><code id="des_info_+3A_nrows">nrows</code></td>
<td>
<p>The number of rows in the design.</p>
</td></tr>
<tr><td><code id="des_info_+3A_ncols">ncols</code></td>
<td>
<p>The number of columns in the design.</p>
</td></tr>
<tr><td><code id="des_info_+3A_brows">brows</code></td>
<td>
<p>For RCBD only. The number of rows in a block.</p>
</td></tr>
<tr><td><code id="des_info_+3A_bcols">bcols</code></td>
<td>
<p>For RCBD only. The number of columns in a block.</p>
</td></tr>
<tr><td><code id="des_info_+3A_byrow">byrow</code></td>
<td>
<p>For split-plot only. Logical (default: <code>TRUE</code>). Provides a way to arrange plots within whole-plots when there are multiple possible arrangements.</p>
</td></tr>
<tr><td><code id="des_info_+3A_fac.names">fac.names</code></td>
<td>
<p>Allows renaming of the <code>A</code> level of factorial designs (i.e. those using <code><a href="agricolae.html#topic+design.ab">agricolae::design.ab()</a></code>) by passing (optionally named) vectors of new labels to be applied to the factors within a list. See examples and details for more information.</p>
</td></tr>
<tr><td><code id="des_info_+3A_fac.sep">fac.sep</code></td>
<td>
<p>The separator used by <code>fac.names</code>. Used to combine factorial design levels. If a vector of 2 levels is supplied, the first separates factor levels and label, and the second separates the different factors.</p>
</td></tr>
<tr><td><code id="des_info_+3A_plot">plot</code></td>
<td>
<p>Logical (default <code>TRUE</code>). If <code>TRUE</code>, display a plot of the generated design. A plot can always be produced later using <code><a href="#topic+autoplot">autoplot()</a></code>.</p>
</td></tr>
<tr><td><code id="des_info_+3A_rotation">rotation</code></td>
<td>
<p>Rotate the text output as Treatments within the plot. Allows for easier reading of long treatment labels. Takes positive and negative values being number of degrees of rotation from horizontal.</p>
</td></tr>
<tr><td><code id="des_info_+3A_size">size</code></td>
<td>
<p>Increase or decrease the text size within the plot for treatment labels. Numeric with default value of 4.</p>
</td></tr>
<tr><td><code id="des_info_+3A_margin">margin</code></td>
<td>
<p>Logical (default FALSE). Setting to <code>TRUE</code> will add a margin (white space) between plot and axes.</p>
</td></tr>
<tr><td><code id="des_info_+3A_save">save</code></td>
<td>
<p>One of <code>FALSE</code> (default)/<code>"none"</code>, <code>TRUE</code>/<code>"both"</code>, <code>"plot"</code> or <code>"workbook"</code>. Specifies which output to save.</p>
</td></tr>
<tr><td><code id="des_info_+3A_savename">savename</code></td>
<td>
<p>A filename for the design to be saved to. Default is the type of the design combined with &quot;_design&quot;.</p>
</td></tr>
<tr><td><code id="des_info_+3A_plottype">plottype</code></td>
<td>
<p>The type of file to save the plot as. Usually one of <code>"pdf"</code>, <code>"png"</code>, or <code>"jpg"</code>. See <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> for all possible options.</p>
</td></tr>
<tr><td><code id="des_info_+3A_return.seed">return.seed</code></td>
<td>
<p>Logical (default TRUE). Output the seed used in the design?</p>
</td></tr>
<tr><td><code id="des_info_+3A_quiet">quiet</code></td>
<td>
<p>Logical (default FALSE). Return the objects without printing output.</p>
</td></tr>
<tr><td><code id="des_info_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> for saving the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>save = TRUE</code> (or <code>"both"</code>), both the plot and the workbook will be saved to the current working directory, with filename given by <code>savename</code>. If one of either <code>"plot"</code> or <code>"workbook"</code> is specified, only that output is saved. If <code>save = FALSE</code> (the default, or equivalently <code>"none"</code>), nothing will be output.
</p>
<p><code>fac.names</code> can be supplied to provide more intuitive names for factors and their levels in factorial designs. They should be specified in a list format, for example <code>fac.names = list(A_names = c("a", "b", "c"), B_names = c("x", "y", "z"))</code>. This will result a design output with a column named <code>A_names</code> with levels <code style="white-space: pre;">&#8288;a, b, c&#8288;</code> and another named <code>B_names</code> with levels <code style="white-space: pre;">&#8288;x, y, z&#8288;</code>. Only the first two elements of the list will be used.
</p>
<p>If <code>fac.sep</code> is a single element (e.g. &quot;<em>&quot;), this is used to separate all factor labels (e.g. A_1_B_1). If it is two elements (e.g. c(&quot;&quot;, &quot;</em>&quot;)), the first element separates the factor names and their levels, and the second level separates the two factors (e.g. A1_B1).
</p>
<p><code>...</code> allows extra arguments to be passed to ggsave for output of the plot. The details of possible arguments can be found in  <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code>.
</p>


<h3>Value</h3>

<p>A list containing a data frame with the complete design, a ggplot object with plot layout, the seed (if <code>return.seed = TRUE</code>), and the <code>satab</code> object, allowing repeat output of the <code>satab</code> table via <code>cat(output$satab)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(agricolae)

# Completely Randomised Design
trt &lt;- c(1, 5, 10, 20)
rep &lt;- 5
outdesign &lt;- design.crd(trt = trt, r = rep, seed = 42)
des.out &lt;- des_info(design.obj = outdesign, nrows = 4, ncols = 5)

# Randomised Complete Block Design
trt &lt;- LETTERS[1:11]
rep &lt;- 4
outdesign &lt;- design.rcbd(trt = trt, r = rep, seed = 42)
des.out &lt;- des_info(
  design.obj = outdesign, nrows = 11,
  ncols = 4, brows = 11, bcols = 1
)

# Latin Square Design
trt &lt;- c("S1", "S2", "S3", "S4")
outdesign &lt;- design.lsd(trt)
des.out &lt;- des_info(design.obj = outdesign, nrows = 4, ncols = 4)

# Factorial Design (Crossed, Completely Randomised)
trt &lt;- c(3, 2) # Factorial 3 x 2
rep &lt;- 3
outdesign &lt;- design.ab(trt, r = rep, design = "crd")
des.out &lt;- des_info(design.obj = outdesign, nrows = 6, ncols = 3)

# Factorial Design (Crossed, Completely Randomised), renaming factors
trt &lt;- c(3, 2) # Factorial 3 x 2
rep &lt;- 3
outdesign &lt;- design.ab(trt, r = rep, design = "crd")
des.out &lt;- des_info(design.obj = outdesign, nrows = 6, ncols = 3,
                    fac.names = list(N = c(50, 100, 150),
                                     Water = c("Irrigated", "Rain-fed")))

# Factorial Design (Nested, Latin Square)
trt &lt;- c("A1", "A2", "A3", "A4", "B1", "B2", "B3")
outdesign &lt;- design.lsd(trt)
des.out &lt;- des_info(design.obj = outdesign, nrows = 7, ncols = 7)

# Split plot design
trt1 &lt;- c("A", "B")
trt2 &lt;- 1:4
rep &lt;- 4
outdesign &lt;- design.split(trt1, trt2, r = rep)
des.out &lt;- des_info(design.obj = outdesign, nrows = 8, ncols = 4, brows = 4, bcols = 2)
</code></pre>

<hr>
<h2 id='design'>Create a complete experimental design with graph of design layout and skeletal ANOVA table</h2><span id='topic+design'></span>

<h3>Description</h3>

<p>Create a complete experimental design with graph of design layout and skeletal ANOVA table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design(
  type,
  treatments,
  reps,
  nrows,
  ncols,
  brows = NA,
  bcols = NA,
  byrow = TRUE,
  sub_treatments = NULL,
  fac.names = NULL,
  fac.sep = c("", " "),
  plot = TRUE,
  rotation = 0,
  size = 4,
  margin = FALSE,
  save = FALSE,
  savename = paste0(type, "_design"),
  plottype = "pdf",
  seed = TRUE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_+3A_type">type</code></td>
<td>
<p>The type of design. Supported design types are <code>crd</code>, <code>rcbd</code>, <code>lsd</code>, <code style="white-space: pre;">&#8288;crossed:&lt;type&gt;&#8288;</code> where <code style="white-space: pre;">&#8288;&lt;type&gt;&#8288;</code> is one of the previous types, and <code>split</code>. See Details for more information.</p>
</td></tr>
<tr><td><code id="design_+3A_treatments">treatments</code></td>
<td>
<p>A vector containing the treatment names or labels.</p>
</td></tr>
<tr><td><code id="design_+3A_reps">reps</code></td>
<td>
<p>The number of replicates. Ignored for Latin Square Designs.</p>
</td></tr>
<tr><td><code id="design_+3A_nrows">nrows</code></td>
<td>
<p>The number of rows in the design.</p>
</td></tr>
<tr><td><code id="design_+3A_ncols">ncols</code></td>
<td>
<p>The number of columns in the design.</p>
</td></tr>
<tr><td><code id="design_+3A_brows">brows</code></td>
<td>
<p>For RCBD and Split Plot designs. The number of rows in a block.</p>
</td></tr>
<tr><td><code id="design_+3A_bcols">bcols</code></td>
<td>
<p>For RCBD and Split Plot designs. The number of columns in a block.</p>
</td></tr>
<tr><td><code id="design_+3A_byrow">byrow</code></td>
<td>
<p>For split-plot only. Logical (default <code>TRUE</code>). Provides a way to arrange plots within whole-plots when there are multiple possible arrangements.</p>
</td></tr>
<tr><td><code id="design_+3A_sub_treatments">sub_treatments</code></td>
<td>
<p>A vector of treatments for sub-plots in a split plot design.</p>
</td></tr>
<tr><td><code id="design_+3A_fac.names">fac.names</code></td>
<td>
<p>Allows renaming of the <code>A</code> level of factorial designs (i.e. those using <code><a href="agricolae.html#topic+design.ab">agricolae::design.ab()</a></code>) by passing (optionally named) vectors of new labels to be applied to the factors within a list. See examples and details for more information.</p>
</td></tr>
<tr><td><code id="design_+3A_fac.sep">fac.sep</code></td>
<td>
<p>The separator used by <code>fac.names</code>. Used to combine factorial design levels. If a vector of 2 levels is supplied, the first separates factor levels and label, and the second separates the different factors.</p>
</td></tr>
<tr><td><code id="design_+3A_plot">plot</code></td>
<td>
<p>Logical (default <code>TRUE</code>). If <code>TRUE</code>, display a plot of the generated design. A plot can always be produced later using <code><a href="#topic+autoplot">autoplot()</a></code>.</p>
</td></tr>
<tr><td><code id="design_+3A_rotation">rotation</code></td>
<td>
<p>Rotate the text output as Treatments within the plot. Allows for easier reading of long treatment labels. Takes positive and negative values being number of degrees of rotation from horizontal.</p>
</td></tr>
<tr><td><code id="design_+3A_size">size</code></td>
<td>
<p>Increase or decrease the text size within the plot for treatment labels. Numeric with default value of 4.</p>
</td></tr>
<tr><td><code id="design_+3A_margin">margin</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Expand the plot to the edges of the plotting area i.e. remove white space between plot and axes.</p>
</td></tr>
<tr><td><code id="design_+3A_save">save</code></td>
<td>
<p>One of <code>FALSE</code> (default)/<code>"none"</code>, <code>TRUE</code>/<code>"both"</code>, <code>"plot"</code> or <code>"workbook"</code>. Specifies which output to save.</p>
</td></tr>
<tr><td><code id="design_+3A_savename">savename</code></td>
<td>
<p>A file name for the design to be saved to. Default is the type of the design combined with &quot;_design&quot;.</p>
</td></tr>
<tr><td><code id="design_+3A_plottype">plottype</code></td>
<td>
<p>The type of file to save the plot as. Usually one of <code>"pdf"</code>, <code>"png"</code>, or <code>"jpg"</code>. See <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> for all possible options.</p>
</td></tr>
<tr><td><code id="design_+3A_seed">seed</code></td>
<td>
<p>Logical (default <code>TRUE</code>). If <code>TRUE</code>, return the seed used to generate the design. If a numeric value, use that value as the seed for the design.</p>
</td></tr>
<tr><td><code id="design_+3A_quiet">quiet</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Hide the output.</p>
</td></tr>
<tr><td><code id="design_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> for saving the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The designs currently supported by <code>type</code> are Completely Randomised designs (<code>crd</code>), Randomised Complete Block designs (<code>rcbd</code>), Latin Square Designs (<code>lsd</code>), Factorial with crossed structure (use <code style="white-space: pre;">&#8288;crossed:&lt;type&gt;&#8288;</code> where <code style="white-space: pre;">&#8288;&lt;type&gt;&#8288;</code> is one of the previous types e.g. <code>crossed:crd</code>) and Split Plot designs (<code>split</code>). Nested factorial designs are supported through manual setup, see Examples.
</p>
<p>If <code>save = TRUE</code> (or <code>"both"</code>), both the plot and the workbook will be saved to the current working directory, with filename given by <code>savename</code>. If one of either <code>"plot"</code> or <code>"workbook"</code> is specified, only that output is saved. If <code>save = FALSE</code> (the default, or equivalently <code>"none"</code>), nothing will be output.
</p>
<p><code>fac.names</code> can be supplied to provide more intuitive names for factors and their levels in factorial and split plot designs. They can be specified in a list format, for example <code>fac.names = list(A_names = c("a", "b", "c"), B_names = c("x", "y", "z"))</code>. This will result a design output with a column named <code>A_names</code> with levels <code style="white-space: pre;">&#8288;a, b, c&#8288;</code> and another named <code>B_names</code> with levels <code style="white-space: pre;">&#8288;x, y, z&#8288;</code>. Labels can also be supplied as a character vector (e.g. <code>c("A", "B")</code>) which will result in only the treatment column names being renamed. Only the first two elements of the list will be used, except in the case of a 3-way factorial design.
</p>
<p><code>...</code> allows extra arguments to be passed to <code>ggsave()</code> for output of the plot. The details of possible arguments can be found in  <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code>.
</p>


<h3>Value</h3>

<p>A list containing a data frame with the complete design (<code style="white-space: pre;">&#8288;$design&#8288;</code>), a ggplot object with plot layout (<code style="white-space: pre;">&#8288;$plot.des&#8288;</code>), the seed (<code style="white-space: pre;">&#8288;$seed&#8288;</code>, if <code>return.seed = TRUE</code>), and the <code>satab</code> object (<code style="white-space: pre;">&#8288;$satab&#8288;</code>), allowing repeat output of the <code>satab</code> table via <code>cat(output$satab)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Completely Randomised Design
des.out &lt;- design(type = "crd", treatments = c(1, 5, 10, 20),
                  reps = 5, nrows = 4, ncols = 5, seed = 42)

# Randomised Complete Block Design
des.out &lt;- design("rcbd", treatments = LETTERS[1:11], reps = 4,
                  nrows = 11, ncols = 4, brows = 11, bcols = 1, seed = 42)

# Latin Square Design
# Doesn't require reps argument
des.out &lt;- design(type = "lsd", c("S1", "S2", "S3", "S4"),
                  nrows = 4, ncols = 4, seed = 42)

# Factorial Design (Crossed, Completely Randomised)
des.out &lt;- design(type = "crossed:crd", treatments = c(3, 2),
                  reps = 3, nrows = 6, ncols = 3, seed = 42)

# Factorial Design (Crossed, Completely Randomised), renaming factors
des.out &lt;- design(type = "crossed:crd", treatments = c(3, 2),
                  reps = 3, nrows = 6, ncols = 3, seed = 42,
                  fac.names = list(N = c(50, 100, 150),
                                   Water = c("Irrigated", "Rain-fed")))

# Factorial Design (Crossed, Randomised Complete Block Design),
# changing separation between factors
des.out &lt;- design(type = "crossed:rcbd", treatments = c(3, 2),
                  reps = 3, nrows = 6, ncols = 3,
                  brows = 6, bcols = 1,
                  seed = 42, fac.sep = c(":", "_"))

# Factorial Design (Nested, Latin Square)
trt &lt;- c("A1", "A2", "A3", "A4", "B1", "B2", "B3")
des.out &lt;- design(type = "lsd", treatments = trt,
                  nrows = 7, ncols = 7, seed = 42)

# Split plot design
des.out &lt;- design(type = "split", treatments = c("A", "B"), sub_treatments = 1:4,
                  reps = 4, nrows = 8, ncols = 4, brows = 4, bcols = 2, seed = 42)

# Alternative arrangement of the same design as above
des.out &lt;- design(type = "split", treatments = c("A", "B"), sub_treatments = 1:4,
                  reps = 4, nrows = 8, ncols = 4, brows = 4, bcols = 2,
                  byrow = FALSE, seed = 42)

</code></pre>

<hr>
<h2 id='get_r_os'>Get the version of R and OS</h2><span id='topic+get_r_os'></span>

<h3>Description</h3>

<p>Get the version of R and OS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_r_os()
</code></pre>


<h3>Value</h3>

<p>A list with the version of R and the OS in a standard format
</p>

<hr>
<h2 id='get_version_table'>Get released versions of ASReml-R in lookup table</h2><span id='topic+get_version_table'></span>

<h3>Description</h3>

<p>Get released versions of ASReml-R in lookup table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_version_table()
</code></pre>


<h3>Value</h3>

<p>A list of data frames containing the version number and release date of released ASReml-R versions for comparison
</p>

<hr>
<h2 id='heat_map'>Produce a heatmap of variables in a grid layout.</h2><span id='topic+heat_map'></span>

<h3>Description</h3>

<p>This function plots a heatmap of variables in a grid layout, optionally grouping them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heat_map(
  data,
  value,
  x_axis,
  y_axis,
  grouping = NULL,
  raster = TRUE,
  smooth = FALSE,
  palette = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heat_map_+3A_data">data</code></td>
<td>
<p>A data frame containing the data to be plotted.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_value">value</code></td>
<td>
<p>A column of <code>data</code>, containing the values that vary over the space which produces the colours.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_x_axis">x_axis</code></td>
<td>
<p>The column of <code>data</code> to use as the x axis data.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_y_axis">y_axis</code></td>
<td>
<p>The column of <code>data</code> to use as the y axis data.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_grouping">grouping</code></td>
<td>
<p>An optional grouping variable to facet the plot by.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_raster">raster</code></td>
<td>
<p>Logical (default: <code>TRUE</code>). If <code>TRUE</code> uses <code><a href="ggplot2.html#topic+geom_tile">ggplot2::geom_raster()</a></code> for speed. Will not work if the grid is irregular.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_smooth">smooth</code></td>
<td>
<p>Logical (default: <code>FALSE</code>). If <code>raster</code> is <code>TRUE</code>, interpolation can be applied across the grid to obtain a smoothed grid. Ignored if <code>raster</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_palette">palette</code></td>
<td>
<p>Colour palette to use. By default it will use the <code>viridis</code> (colour-blind friendly) palette. Other palettes available can be seen with <code><a href="grDevices.html#topic+palettes">grDevices::hcl.pals()</a></code>.</p>
</td></tr>
<tr><td><code id="heat_map_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="ggplot2.html#topic+facet_wrap">facet_wrap()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42)
dat &lt;- expand.grid(x = 1:5, y = 1:6)
dat$value &lt;- rnorm(30)
dat$groups &lt;- sample(rep(LETTERS[1:6], times = 5))

heat_map(dat, value, x, y)

# Column names can be quoted, but don't need to be.
heat_map(dat, "value", "x", "y", "groups")

# Different palettes are available
heat_map(dat, value, x, y, palette = "Spectral")

# Arguments in ... are passed through to facet_wrap
heat_map(dat, value, x, y, groups, labeller = ggplot2:::label_both)
heat_map(dat, value, x, y, groups, scales = "free_y")
heat_map(dat, value, x, y, groups, nrow = 1)
</code></pre>

<hr>
<h2 id='install_asreml'>Install or update the ASReml-R package</h2><span id='topic+install_asreml'></span><span id='topic+update_asreml'></span>

<h3>Description</h3>

<p>Helper functions for installing or updating the ASReml-R package, intended to reduce the difficulty of finding the correct version for your operating system and R version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>install_asreml(
  library = .libPaths()[1],
  quiet = FALSE,
  force = FALSE,
  keep_file = FALSE
)

update_asreml(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="install_asreml_+3A_library">library</code></td>
<td>
<p>Library location to install ASReml-R. Uses first option in <code>.libPaths()</code> by default.</p>
</td></tr>
<tr><td><code id="install_asreml_+3A_quiet">quiet</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Should package be installed quietly?</p>
</td></tr>
<tr><td><code id="install_asreml_+3A_force">force</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Force ASReml-R to install. Useful for upgrading if it is already installed.</p>
</td></tr>
<tr><td><code id="install_asreml_+3A_keep_file">keep_file</code></td>
<td>
<p>Should the downloaded asreml package file be kept? Default is <code>FALSE</code>. <code>TRUE</code> downloads to current directory. A file path can also be provided to save to another directory. See <code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="install_asreml_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>install_asreml()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ASReml-R package file is downloaded from a shortlink, and if <code>keep_file</code> is <code>TRUE</code>, the package archive file will be saved in the current directory. If a valid path is provided in <code>keep_file</code>, the file will be saved to that path, but all directories are assumed to exist and will not be created. If <code>keep_file</code> does not specify an existing, valid path, an error will be shown after package installation.
</p>


<h3>Value</h3>

<p>Silently returns <code>TRUE</code> if <code>asreml</code> installed successfully or already present, <code>FALSE</code> otherwise. Optionally prints a confirmation message on success.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example 1: download and install asreml
install_asreml()

# Example 2: install asreml and save file for later
install_asreml(keep_file = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='logl_test'>Conduct a log-likelihood test for comparing terms in ASReml-R models</h2><span id='topic+logl_test'></span>

<h3>Description</h3>

<p>Conduct a log-likelihood test for comparing terms in ASReml-R models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logl_test(
  model.obj,
  rand.terms = NULL,
  resid.terms = NULL,
  decimals = 3,
  numeric = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logl_test_+3A_model.obj">model.obj</code></td>
<td>
<p>An ASReml-R model object</p>
</td></tr>
<tr><td><code id="logl_test_+3A_rand.terms">rand.terms</code></td>
<td>
<p>Random terms from the model. Default is NULL.</p>
</td></tr>
<tr><td><code id="logl_test_+3A_resid.terms">resid.terms</code></td>
<td>
<p>Residual terms from the model. Default is NULL.</p>
</td></tr>
<tr><td><code id="logl_test_+3A_decimals">decimals</code></td>
<td>
<p>Controls rounding of decimal places in output. Default is 3 decimal places.</p>
</td></tr>
<tr><td><code id="logl_test_+3A_numeric">numeric</code></td>
<td>
<p>Return p-values as numeric? Default is that they are characters, where very small values shown as less than a small number. See <code>details</code> for more.</p>
</td></tr>
<tr><td><code id="logl_test_+3A_quiet">quiet</code></td>
<td>
<p>Logical (default: <code>FALSE</code>). Hide warnings and messages?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typically p-values cannot be 0, and are usually just below some threshold of accuracy in calculation of probability.
</p>


<h3>Value</h3>

<p>A dataframe containing the results of the test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(asreml)
dat &lt;- asreml::oats
dat &lt;- dat[order(dat$Row, dat$Column),]

#Fit ASReml Model
model.asr &lt;- asreml(yield ~ Nitrogen + Variety + Nitrogen:Variety,
                    random = ~ Blocks + Blocks:Wplots,
                    residual = ~ ar1(Row):ar1(Column),
                    data = dat)
oats.logl &lt;- logl_test(
  model.obj = model.asr, rand.terms = c("Blocks", "Blocks:Wplots"),
  resid.terms = c("ar1(Row)", "ar1(Column)")
)
oats.logl

## End(Not run)

</code></pre>

<hr>
<h2 id='multiple_comparisons'>Perform Multiple Comparison Tests on a statistical model</h2><span id='topic+multiple_comparisons'></span>

<h3>Description</h3>

<p>A function for comparing and ranking predicted means with Tukey's Honest Significant Difference (HSD) Test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple_comparisons(
  model.obj,
  classify,
  sig = 0.05,
  int.type = "ci",
  trans = NA,
  offset = NA,
  power = NA,
  decimals = 2,
  descending = FALSE,
  plot = FALSE,
  label_height = 0.1,
  rotation = 0,
  save = FALSE,
  savename = "predicted_values",
  order,
  pred.obj,
  pred,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiple_comparisons_+3A_model.obj">model.obj</code></td>
<td>
<p>An ASReml-R or aov model object. Will likely also work with <code>lme</code> (<code><a href="nlme.html#topic+lme">nlme::lme()</a></code>), <code>lmerMod</code> (<code><a href="lme4.html#topic+lmer">lme4::lmer()</a></code>) models as well.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_classify">classify</code></td>
<td>
<p>Name of predictor variable as string.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_sig">sig</code></td>
<td>
<p>The significance level, numeric between 0 and 1. Default is 0.05.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_int.type">int.type</code></td>
<td>
<p>The type of confidence interval to calculate. One of <code>ci</code>, <code style="white-space: pre;">&#8288;1se&#8288;</code> or <code style="white-space: pre;">&#8288;2se&#8288;</code>. Default is <code>ci</code>.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_trans">trans</code></td>
<td>
<p>Transformation that was applied to the response variable. One of <code>log</code>, <code>sqrt</code>, <code>logit</code>, <code>power</code> or <code>inverse</code>. Default is <code>NA</code>.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_offset">offset</code></td>
<td>
<p>Numeric offset applied to response variable prior to transformation. Default is <code>NA</code>. Use 0 if no offset was applied to the transformed data. See Details for more information.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_power">power</code></td>
<td>
<p>Numeric power applied to response variable with power transformation. Default is <code>NA</code>. See Details for more information.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_decimals">decimals</code></td>
<td>
<p>Controls rounding of decimal places in output. Default is 2 decimal places.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_descending">descending</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Order of the output sorted by the predicted value. If <code>TRUE</code>, largest will be first, through to smallest last.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_plot">plot</code></td>
<td>
<p>Automatically produce a plot of the output of the multiple comparison test? Default is <code>FALSE</code>. This is maintained for backwards compatibility, but the preferred method now is to use <code style="white-space: pre;">&#8288;autoplot(&lt;multiple_comparisons output&gt;)&#8288;</code>. See <code><a href="#topic+autoplot.mct">autoplot.mct()</a></code> for more details.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_label_height">label_height</code></td>
<td>
<p>Height of the text labels above the upper error bar on the plot. Default is 0.1 (10%) of the difference between upper and lower error bars above the top error bar.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_rotation">rotation</code></td>
<td>
<p>Rotate the text output as Treatments within the plot. Allows for easier reading of long treatment labels. Number between 0 and 360 (inclusive) - default 0</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_save">save</code></td>
<td>
<p>Logical (default <code>FALSE</code>). Save the predicted values to a csv file?</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_savename">savename</code></td>
<td>
<p>A file name for the predicted values to be saved to. Default is <code>predicted_values</code>.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_order">order</code></td>
<td>
<p>Deprecated. Use <code>descending</code> instead.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_pred.obj">pred.obj</code></td>
<td>
<p>Deprecated. Predicted values are calculated within the function from version 1.0.1 onwards.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_pred">pred</code></td>
<td>
<p>Deprecated. Use <code>classify</code> instead.</p>
</td></tr>
<tr><td><code id="multiple_comparisons_+3A_...">...</code></td>
<td>
<p>Other arguments passed through to <code>predict.asreml()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some transformations require that data has a small offset applied, otherwise it will cause errors (for example taking a log of 0, or square root of negative values). In order to correctly reverse this offset, if the <code>trans</code> argument is supplied, an offset value must also be supplied. If there was no offset required for a transformation, then use a value of 0 for the <code>offset</code> argument.
</p>


<h3>Value</h3>

<p>A list containing a data frame with predicted means, standard errors, confidence interval upper and lower bounds, and significant group allocations (named <code>predicted_values</code>), as well as a plot visually displaying the predicted values (named <code>predicted_plot</code>). If some of the predicted values are aliased, a warning is printed, and the aliased treatment levels are returned in the output (named <code>aliased</code>).
</p>


<h3>References</h3>

<p>JÃ¸rgensen, E. &amp; Pedersen, A. R. (1997). How to Obtain Those Nasty Standard Errors From Transformed Data - and Why They Should Not Be Used. <a href="https://pure.au.dk/portal/en/publications/how-to-obtain-those-nasty-standard-errors-from-transformed-data--and-why-they-should-not-be-used(d649ca20-d15f-11db-8e26-000ea68e967b).html">https://pure.au.dk/portal/en/publications/how-to-obtain-those-nasty-standard-errors-from-transformed-data&ndash;and-why-they-should-not-be-used(d649ca20-d15f-11db-8e26-000ea68e967b).html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit aov model
model &lt;- aov(Petal.Length ~ Species, data = iris)

# Display the ANOVA table for the model
anova(model)

# Determine ranking and groups according to Tukey's Test
pred.out &lt;- multiple_comparisons(model, classify = "Species")

# Display the predicted values table
pred.out

# Show the predicted values plot
autoplot(pred.out, label_height = 0.5)



## Not run: 
# ASReml-R Example
library(asreml)

#Fit ASReml Model
model.asr &lt;- asreml(yield ~ Nitrogen + Variety + Nitrogen:Variety,
                    random = ~ Blocks + Blocks:Wplots,
                    residual = ~ units,
                    data = asreml::oats)

wald(model.asr) #Nitrogen main effect significant

#Determine ranking and groups according to Tukey's Test
pred.out &lt;- multiple_comparisons(model.obj = model.asr, classify = "Nitrogen",
                    descending = TRUE, decimals = 5)

pred.out

# Example using a box-cox transformation
set.seed(42) # See the seed for reproducibility
resp &lt;- rnorm(n = 50, 5, 1)^3
trt &lt;- as.factor(sample(rep(LETTERS[1:10], 5), 50))
block &lt;- as.factor(rep(1:5, each = 10))
ex_data &lt;- data.frame(resp, trt, block)

# Change one treatment random values to get significant difference
ex_data$resp[ex_data$trt=="A"] &lt;- rnorm(n = 5, 7, 1)^3

model.asr &lt;- asreml(resp ~ trt,
                    random = ~ block,
                    residual = ~ units,
                    data = ex_data)

resplot(model.asr)

# Perform Box-Cox transformation and get maximum value
out &lt;- MASS::boxcox(ex_data$resp~ex_data$trt)
out$x[which.max(out$y)] # 0.3838

# Fit cube root to the data
model.asr &lt;- asreml(resp^(1/3) ~ trt,
                    random = ~ block,
                    residual = ~ units,
                    data = ex_data)
resplot(model.asr) # residual plots look much better

#Determine ranking and groups according to Tukey's Test
pred.out &lt;- multiple_comparisons(model.obj = model.asr,
                                 classify = "trt",
                                 trans = "power", power = (1/3))

pred.out
autoplot(pred.out)

## End(Not run)

</code></pre>

<hr>
<h2 id='newer_version'>Compare installed version of ASReml-R with available versions</h2><span id='topic+newer_version'></span>

<h3>Description</h3>

<p>Compare installed version of ASReml-R with available versions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newer_version()
</code></pre>


<h3>Value</h3>

<p>TRUE if a newer version is available online, FALSE otherwise
</p>

<hr>
<h2 id='print.mct'>Print output of multiple_comparisons</h2><span id='topic+print.mct'></span>

<h3>Description</h3>

<p>Print output of multiple_comparisons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mct'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mct_+3A_x">x</code></td>
<td>
<p>An mct object to print to the console.</p>
</td></tr>
<tr><td><code id="print.mct_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original object invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiple_comparisons">multiple_comparisons()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat.aov &lt;- aov(Petal.Width ~ Species, data = iris)
output &lt;- multiple_comparisons(dat.aov, classify = "Species")
print(output)
</code></pre>

<hr>
<h2 id='quiet'>Function to suppress output if desired, especially useful for ASReml output</h2><span id='topic+quiet'></span>

<h3>Description</h3>

<p>Function to suppress output if desired, especially useful for ASReml output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quiet(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quiet_+3A_x">x</code></td>
<td>
<p>A function call with output to be suppressed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The invisible output of the function called.
</p>

<hr>
<h2 id='resplot'>Produce residual plots of linear models</h2><span id='topic+resplot'></span>

<h3>Description</h3>

<p>Produces plots of residuals for assumption checking of linear (mixed) models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resplot(
  model.obj,
  shapiro = TRUE,
  call = FALSE,
  label.size = 10,
  axes.size = 10,
  call.size = 9,
  mod.obj
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resplot_+3A_model.obj">model.obj</code></td>
<td>
<p>An <code>aov</code>, <code>lm</code>, <code>lme</code> (<code><a href="nlme.html#topic+lme">nlme::lme()</a></code>), <code>lmerMod</code> (<code><a href="lme4.html#topic+lmer">lme4::lmer()</a></code>), <code>asreml</code> or <code>mmer</code> (sommer) model object.</p>
</td></tr>
<tr><td><code id="resplot_+3A_shapiro">shapiro</code></td>
<td>
<p>(Logical) Display the Shapiro-Wilks test of normality on the plot?</p>
</td></tr>
<tr><td><code id="resplot_+3A_call">call</code></td>
<td>
<p>(Logical) Display the model call on the plot?</p>
</td></tr>
<tr><td><code id="resplot_+3A_label.size">label.size</code></td>
<td>
<p>A numeric value for the size of the label (A,B,C) font point size.</p>
</td></tr>
<tr><td><code id="resplot_+3A_axes.size">axes.size</code></td>
<td>
<p>A numeric value for the size of the axes label font size in points.</p>
</td></tr>
<tr><td><code id="resplot_+3A_call.size">call.size</code></td>
<td>
<p>A numeric value for the size of the model displayed on the plot.</p>
</td></tr>
<tr><td><code id="resplot_+3A_mod.obj">mod.obj</code></td>
<td>
<p>Deprecated to be consistent with other functions. Please use <code>model.obj</code> instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object containing the diagnostic plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat.aov &lt;- aov(Petal.Length ~ Petal.Width, data = iris)
resplot(dat.aov)
resplot(dat.aov, call = TRUE)
</code></pre>

<hr>
<h2 id='resplt-deprecated'>Residual plots of linear models.</h2><span id='topic+resplt-deprecated'></span>

<h3>Description</h3>

<p>Produces plots of residuals for assumption checking of linear (mixed) models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resplt(model.obj, shapiro = TRUE, call = FALSE, label.size = 10,
axes.size = 10, call.size = 9, mod.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resplt-deprecated_+3A_model.obj">model.obj</code></td>
<td>
<p>An <code>aov</code>, <code>lm</code>, <code>lme</code> (<code><a href="nlme.html#topic+lme">nlme::lme()</a></code>), <code>lmerMod</code> (<code><a href="lme4.html#topic+lmer">lme4::lmer()</a></code>), <code>asreml</code> or <code>mmer</code> (sommer) model object.</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_shapiro">shapiro</code></td>
<td>
<p>(Logical) Display the Shapiro-Wilks test of normality on the plot?</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_call">call</code></td>
<td>
<p>(Logical) Display the model call on the plot?</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_axes.size">axes.size</code></td>
<td>
<p>A numeric value for the size of the axes label font size in points.</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_label.size">label.size</code></td>
<td>
<p>A numeric value for the size of the label (A,B,C) font point size.</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_call.size">call.size</code></td>
<td>
<p>A numeric value for the size of the model displayed on the plot.</p>
</td></tr>
<tr><td><code id="resplt-deprecated_+3A_mod.obj">mod.obj</code></td>
<td>
<p>Deprecated to be consistent with other functions. Please use <code>model.obj</code> instead.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing ggplot2 objects which are diagnostic plots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+biometryassist-deprecated">biometryassist-deprecated</a></code>
</p>

<hr>
<h2 id='satab'>Produces a skeletal ANOVA table</h2><span id='topic+satab'></span>

<h3>Description</h3>

<p>Produces a skeletal ANOVA table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satab(design.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satab_+3A_design.obj">design.obj</code></td>
<td>
<p>An <code>agricolae</code> design object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints skeletal ANOVA table to console output.
</p>

<hr>
<h2 id='summary_graph'>Visualise a graphical summary of variables from a data frame</h2><span id='topic+summary_graph'></span>

<h3>Description</h3>

<p>Variables are plotted in different ways according to the number of explanatory
variables provided as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_graph(data, response, exp_var, resp_units = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_graph_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables to be plotted.</p>
</td></tr>
<tr><td><code id="summary_graph_+3A_response">response</code></td>
<td>
<p>The response variable to plot.</p>
</td></tr>
<tr><td><code id="summary_graph_+3A_exp_var">exp_var</code></td>
<td>
<p>The explanatory (or grouping) variable(s) to plot. Up to three can be provided.</p>
</td></tr>
<tr><td><code id="summary_graph_+3A_resp_units">resp_units</code></td>
<td>
<p>A string providing units to display on the response variable (y) axis. Will use the empty string by default so axes will have no units by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With a single explanatory variable, a boxplot grouped by <code>exp_var</code> is produced.
With two explanatory variables, a dot-plot with lines connecting the mean of each
group is produced, with the first element of <code>exp_var</code> used as the x axis variable,
and the second is used to colour the points. Three explanatory variables produces
the same as two, but with the third used to facet the plot.
</p>


<h3>Value</h3>

<p>A ggplot2 plot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
summary_graph(iris, "Petal.Length", "Species", "mm")

# Multiple
summary_graph(npk, "yield", c("N", "P"), "lb/plot")

summary_graph(npk, "yield", c("N", "P", "K"), "lb/plot")

</code></pre>

<hr>
<h2 id='vario_df'>Calculate the variogram data frame for a model</h2><span id='topic+vario_df'></span>

<h3>Description</h3>

<p>Calculate the variogram data frame for a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vario_df(model.obj, Row = NA, Column = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vario_df_+3A_model.obj">model.obj</code></td>
<td>
<p>An asreml model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the variogram for a model. The data frame contains the spatial coordinates (typically row and column), the <code>gamma</code> for that position and the number of points with the separation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(asreml)
oats &lt;- asreml::oats
oats &lt;- oats[order(oats$Row, oats$Column),]
model.asr &lt;- asreml(yield ~ Nitrogen + Variety + Nitrogen:Variety,
                    random = ~ Blocks + Blocks:Wplots,
                    residual = ~ ar1(Row):ar1(Column),
                    data = oats)
vario_df(model.asr)

## End(Not run)

</code></pre>

<hr>
<h2 id='variogram'>Display variogram plots for spatial models</h2><span id='topic+variogram'></span>

<h3>Description</h3>

<p>Produces variogram plots for checking spatial trends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variogram(
  model.obj,
  row = NA,
  column = NA,
  horizontal = TRUE,
  palette = "default"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variogram_+3A_model.obj">model.obj</code></td>
<td>
<p>An <code>asreml</code> model object.</p>
</td></tr>
<tr><td><code id="variogram_+3A_row">row</code></td>
<td>
<p>A row variable.</p>
</td></tr>
<tr><td><code id="variogram_+3A_column">column</code></td>
<td>
<p>A column variable.</p>
</td></tr>
<tr><td><code id="variogram_+3A_horizontal">horizontal</code></td>
<td>
<p>Logical (default <code>TRUE</code>). The direction the plots are arranged. The default <code>TRUE</code> places the plots above and below, while <code>FALSE</code> will place them side by side.</p>
</td></tr>
<tr><td><code id="variogram_+3A_palette">palette</code></td>
<td>
<p>A string specifying the colour scheme to use for plotting. The default value (<code>"default"</code>) is equivalent to <code>"rainbow"</code>. Colour blind friendly palettes can also be provided via options <code>"colo(u)r blind"</code> (both equivalent to <code>"viridis"</code>), <code>"magma"</code>, <code>"inferno"</code>, <code>"plasma"</code>, <code>"cividis"</code>, <code>"rocket"</code>, <code>"mako"</code> or <code>"turbo"</code>. The <code>"Spectral"</code> palette from <code><a href="scales.html#topic+pal_brewer">scales::brewer_pal()</a></code> is also possible.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>References</h3>

<p>S. P. Kaluzny, S. C. Vega, T. P. Cardoso, A. A. Shelly, &quot;S+SpatialStats: Userâs Manual for WindowsÂ® and UNIXÂ®&quot; <em>Springer New York</em>, 2013, p. 68, https://books.google.com.au/books?id=iADkBwvario_pointsQBAJ.
</p>
<p>A. R. Gilmour, B. R. Cullis, A. P. Verbyla, &quot;Accounting for Natural and Extraneous Variation in the Analysis of Field Experiments.&quot; <em>Journal of Agricultural, Biological, and Environmental Statistics 2, no. 3</em>, 1997, pp. 269â93, https://doi.org/10.2307/1400446.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(asreml)
oats &lt;- asreml::oats
oats &lt;- oats[order(oats$Row, oats$Column),]
model.asr &lt;- asreml(yield ~ Nitrogen + Variety + Nitrogen:Variety,
                    random = ~ Blocks + Blocks:Wplots,
                    residual = ~ ar1(Row):ar1(Column),
                    data = oats)
variogram(model.asr)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
