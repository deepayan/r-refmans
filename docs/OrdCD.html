<!DOCTYPE html><html><head><title>Help for package OrdCD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OrdCD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#OrdCD'><p>Causal Discovery for Ordinal Categorical Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ordinal Causal Discovery</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-14</td>
</tr>
<tr>
<td>Description:</td>
<td>Algorithms for ordinal causal discovery. This package aims to enable users to discover causality for observational ordinal categorical data with greedy and exhaustive search. See Ni, Y., &amp; Mallick, B. (2022) <a href="https://proceedings.mlr.press/v180/ni22a/ni22a.pdf">https://proceedings.mlr.press/v180/ni22a/ni22a.pdf</a> "Ordinal Causal Discovery. Proceedings of the 38th Conference on Uncertainty in Artificial Intelligence, (UAI 2022), PMLR 180:1530â€“1540".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>gRbase, MASS, bnlearn, igraph, stats, Matrix</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nySTAT/OrdCD">https://github.com/nySTAT/OrdCD</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nySTAT/OrdCD/issues">https://github.com/nySTAT/OrdCD/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-17 19:27:50 UTC; yangni</td>
</tr>
<tr>
<td>Author:</td>
<td>Yang Ni <a href="https://orcid.org/0000-0003-0636-2363"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yang Ni &lt;yni@stat.tamu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-17 21:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='OrdCD'>Causal Discovery for Ordinal Categorical Data</h2><span id='topic+OrdCD'></span>

<h3>Description</h3>

<p>Estimate a causal directed acyclic graph (DAG) for ordinal categorical data with greedy or exhaustive search.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrdCD(
  y,
  search = "greedy",
  ic = "bic",
  edge_list = NULL,
  link = "probit",
  G = NULL,
  nstart = 1,
  verbose = FALSE,
  maxit = 50,
  boot = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OrdCD_+3A_y">y</code></td>
<td>
<p>a data frame with each column being an ordinal categorical variable, which must be a factor.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_search">search</code></td>
<td>
<p>the search method used to find the best-scored DAG. The default search method is &quot;greedy&quot;. When the number of nodes is less than 4, &quot;exhaust&quot; search is available.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_ic">ic</code></td>
<td>
<p>the information criterion (AIC or BIC) used to score DAGs. The default is &quot;bic&quot;.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_edge_list">edge_list</code></td>
<td>
<p>an edge list of a CPDAG, which may contain both directed and undirected edges. This option can significantly speed up the algorithm by restricting the search space to DAGs that are Markov equivalent to the input CPDAG. Such CPDAG may be obtained by e.g., the PC algorithm; see the example below.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_link">link</code></td>
<td>
<p>the link function for ordinal regression. The default is &quot;probit&quot;. Other choices are &quot;logistic&quot;, &quot;loglog&quot;, &quot;cloglog&quot;, and &quot;cauchit&quot;.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_g">G</code></td>
<td>
<p>a list of DAG adjacency matrices that users want to restrict their search on for the &quot;exhaust&quot; search. The default is &quot;NULL&quot; meaning no restriction imposed on the search.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_nstart">nstart</code></td>
<td>
<p>number of random graph initializations for the &quot;greedy&quot; search.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_verbose">verbose</code></td>
<td>
<p>if TRUE, messages are printed during the run of the greedy search algorithm.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations for the greedy search algorithm. The default is 50. When the maximum number of iteration is achieved, a warning message will be generated to caution the user that the algorithm has not converged.</p>
</td></tr>
<tr><td><code id="OrdCD_+3A_boot">boot</code></td>
<td>
<p>the number of bootstrap samples. Default is no bootstrapping.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with &quot;boot&quot; elements. Each element is a list with two elements, gam and ic_best. gam is an estimated DAG adjacency matrix whose (i,j)th entry is 1 if j-&gt;i is present in the graph and 0 otherwise. ic_best is the corresponding information criterion value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2020)
n=1000 #sample size
q=3 #number of nodes
y = u = matrix(0,n,q)
u[,1] = 4*rnorm(n)
y[,1] = (u[,1]&gt;1) + (u[,1]&gt;2)
for (j in 2:q){
  u[,j] = 2*y[,j-1] + rnorm(n)
  y[,j]=(u[,j]&gt;1) + (u[,j]&gt;2)
}
A=matrix(0,q,q) #true DAG adjacency matrix
A[2,1]=A[3,2]=1
y=as.data.frame(y)
for (j in 1:q){
  y[,j]=as.factor(y[,j])
}

time=proc.time()
G=OrdCD(y) #estimated DAG adjacency matrix
time=proc.time() - time
print(A) #display the true adjacency
print(G) #display the estimated adjacency
print(time[3]) #elapsed time

time2=proc.time()
colnames(y)=1:ncol(y)
PC=bnlearn::pc.stable(y,test="mi-sh",alpha=0.01)
edge_list=matrix(as.numeric(PC$arcs),ncol=2)
G2=OrdCD(y, edge_list=edge_list) #estimated DAG with an input CPDAG from PC algorithm
time2=proc.time()-time2
print(G2) #display the estimated adjacency
print(time2[3]) #elapsed time

## Not run: 
time3=proc.time()
G3=OrdCD(y,boot=10) #estimated DAG adjacency matrix with bootstrapping
time3=proc.time() - time3
#average over bootstrap samples
G_avg = matrix(colMeans(matrix(unlist(G3),nrow=q^2+1,byrow=TRUE))[1:(q^2)],q,q)
print(G_avg) #display the estimated adjacency averaged over 10 bootstrap samples
print(time3[3]) #elapsed time

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
