<!DOCTYPE html><html><head><title>Help for package tailDepFun</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tailDepFun}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AsymVarBR'><p>Asymptotic variance matrix for the Brown-Resnick process.</p></a></li>
<li><a href='#AsymVarGumbel'><p>Asymptotic variance matrix for the Gumbel model.</p></a></li>
<li><a href='#AsymVarMaxLinear'><p>Asymptotic variance matrix for the max-linear model.</p></a></li>
<li><a href='#dataEUROSTOXX'><p>EUROSTOXX50 weekly negative log-returns.</p></a></li>
<li><a href='#dataKNMI'><p>Wind speeds in the Netherlands.</p></a></li>
<li><a href='#EstimationBR'><p>Estimation of the parameters of the Brown-Resnick process</p></a></li>
<li><a href='#EstimationGumbel'><p>Estimation of the parameter of the Gumbel model</p></a></li>
<li><a href='#EstimationMaxLinear'><p>Estimation of the parameters of the max-linear model</p></a></li>
<li><a href='#selectGrid'><p>Selects a grid of indices.</p></a></li>
<li><a href='#stdfEmp'><p>Empirical stable tail dependence function</p></a></li>
<li><a href='#stdfEmpCorr'><p>Bias-corrected empirical stable tail dependence function</p></a></li>
<li><a href='#stdfEmpInt'><p>Integrated empirical stable tail dependence function</p></a></li>
<li><a href='#tailDepFun'><p>tailDepFun</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Minimum Distance Estimation of Tail Dependence Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions implementing minimal distance estimation methods for parametric tail dependence models, as proposed in  
	 Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016) &lt;<a href="https://doi.org/10.1111%2Frssb.12114">doi:10.1111/rssb.12114</a>&gt; and 
	 Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018) &lt;<a href="https://doi.org/10.1007%2Fs10687-017-0303-7">doi:10.1007/s10687-017-0303-7</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Anna Kiriliouk</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anna Kiriliouk &lt;anna.kiriliouk@unamur.be&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cubature, mvtnorm, SpatialExtremes, copula, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Collate:</td>
<td>'Other.R' 'helpFunctions.R' 'EstimationBR.R'
'EstimationGumbel.R' 'EstimationML.R' 'empbetacop.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-01 10:23:31 UTC; akirilio</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-03 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AsymVarBR'>Asymptotic variance matrix for the Brown-Resnick process.</h2><span id='topic+AsymVarBR'></span>

<h3>Description</h3>

<p>Computes the asymptotic variance matrix for the Brown-Resnick process, estimated using the pairwise M-estimator or the weighted least squares estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsymVarBR(locations, indices, par, method, Tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsymVarBR_+3A_locations">locations</code></td>
<td>
<p>A <code class="reqn">d</code> x 2 matrix containing the Cartesian coordinates of <code class="reqn">d</code> points in the plane.</p>
</td></tr>
<tr><td><code id="AsymVarBR_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing exactly 2 ones per row, representing a pair of points from the matrix <code>locations</code>, and zeroes elsewhere.</p>
</td></tr>
<tr><td><code id="AsymVarBR_+3A_par">par</code></td>
<td>
<p>The parameters of the Brown-Resnick process. Either <code class="reqn">(\alpha,\rho)</code> for an isotropic process or <code class="reqn">(\alpha,\rho,\beta,c)</code> for an anisotropic process.</p>
</td></tr>
<tr><td><code id="AsymVarBR_+3A_method">method</code></td>
<td>
<p>Choose between &quot;Mestimator&quot; and &quot;WLS&quot;.</p>
</td></tr>
<tr><td><code id="AsymVarBR_+3A_tol">Tol</code></td>
<td>
<p>For &quot;Mestimator&quot; only. The tolerance in the numerical integration procedure. Defaults to 1e-05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters of a The matrix <code>indices</code> can be either user-defined or returned from the function <code>selectGrid</code> with <code>cst = c(0,1)</code>. Calculation might be rather slow for <code>method = "Mestimator"</code>.
</p>


<h3>Value</h3>

<p>A <code>q</code> by <code>q</code> matrix.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>locations &lt;- cbind(rep(1:2, 3), rep(1:3, each = 2))
indices &lt;- selectGrid(cst = c(0,1), d = 6, locations = locations, maxDistance = 1)
AsymVarBR(locations, indices, par = c(1.5,3), method = "WLS")
</code></pre>

<hr>
<h2 id='AsymVarGumbel'>Asymptotic variance matrix for the Gumbel model.</h2><span id='topic+AsymVarGumbel'></span>

<h3>Description</h3>

<p>Computes the asymptotic variance matrix for the Gumbel model, estimated using the pairwise M-estimator or the weighted least squares estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsymVarGumbel(indices, par, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsymVarGumbel_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing at least 2 non-zero elements per row, representing the values in which we will evaluate the stable tail dependence function. For <code>method = Mestimator</code>, this matrix should contain exactly two ones per row.</p>
</td></tr>
<tr><td><code id="AsymVarGumbel_+3A_par">par</code></td>
<td>
<p>The parameter of the Gumbel model.</p>
</td></tr>
<tr><td><code id="AsymVarGumbel_+3A_method">method</code></td>
<td>
<p>Choose between &quot;Mestimator&quot; and &quot;WLS&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix <code>indices</code> can be either user defines or returned by <code>selectGrid</code>. For <code>method = "Mestimator"</code>, only a grid with exactly two ones per row is accepted, representing the pairs to be used.
</p>


<h3>Value</h3>

<p>A <code>q</code> by <code>q</code> matrix.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>indices &lt;- selectGrid(c(0,1), d = 3, nonzero = c(2,3))
AsymVarGumbel(indices, par = 0.7, method = "WLS")
</code></pre>

<hr>
<h2 id='AsymVarMaxLinear'>Asymptotic variance matrix for the max-linear model.</h2><span id='topic+AsymVarMaxLinear'></span>

<h3>Description</h3>

<p>Computes the asymptotic variance matrix for the max-linear model, estimated using the weighted least squares estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AsymVarMaxLinear(indices, par, Bmatrix = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AsymVarMaxLinear_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing at least 2 non-zero elements per row, representing the values in which we will evaluate the stable tail dependence function.</p>
</td></tr>
<tr><td><code id="AsymVarMaxLinear_+3A_par">par</code></td>
<td>
<p>The parameter vector.</p>
</td></tr>
<tr><td><code id="AsymVarMaxLinear_+3A_bmatrix">Bmatrix</code></td>
<td>
<p>A function that converts the parameter vector theta to a parameter matrix B. If <code>NULL</code>, then a simple 2-factor model is assumed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>q</code> by <code>q</code> matrix.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>indices &lt;- selectGrid(c(0,0.5,1), d = 3, nonzero = 3)
AsymVarMaxLinear(indices, par = c(0.1,0.55,0.75))
</code></pre>

<hr>
<h2 id='dataEUROSTOXX'>EUROSTOXX50 weekly negative log-returns.</h2><span id='topic+dataEUROSTOXX'></span>

<h3>Description</h3>

<p>The first three columns represent the weekly negative log-returns of the index prices
of the EUROSTOXX50 and of its subindices correspoding to the supersectors chemicals and insurance.
The fourth and fifth columns represent the weekly negative log-returns of the index prices of
the DAX and the CAC40 indices.
The sixth to tenth columnds represent the weekly negative log-returns of the stock prices of Bayer,
BASF, Allianz, AXA, and Airliquide respectively.
</p>


<h3>Format</h3>

<p><code>dataEUROSTOXX</code> is a matrix with 711 rows and 10 columns.
</p>


<h3>Source</h3>

<p>Yahoo Finance
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataEUROSTOXX)
## Transform data to unit Pareto margins
n &lt;- nrow(dataEUROSTOXX)
x &lt;- apply(dataEUROSTOXX, 2, function(i) n/(n + 0.5 - rank(i)))
## Define indices in which we evaluate the estimator
indices &lt;- selectGrid(c(0,0.5,1), d = 10, nonzero = c(2,3))
start &lt;- c(0.67,0.8,0.77,0.91,0.41,0.47,0.25,0.7,0.72,0.19,0.37,0.7,0.09,0.58)
## Estimate the parameters. Lasts up to ten minutes.

EstimationMaxLinear(x, indices, k = 40, method = "WLS", startingValue = start,
covMat = FALSE, EURO = TRUE)

</code></pre>

<hr>
<h2 id='dataKNMI'>Wind speeds in the Netherlands.</h2><span id='topic+dataKNMI'></span>

<h3>Description</h3>

<p>Daily maximal speeds of wind gusts, measured in 0.1 m/s. The data are observed at
22 inland weather stations in the Netherlands. Only the summer months are presented
here (June, July, August). Also included are the Euclidian coordinates of the 22
weather stations, where a distance of 1 corresponds to 100 kilometers.
</p>


<h3>Format</h3>

<p>dataKNMI$data is a matrix with 672 rows and 22 columns, dataKNMI$loc is a matrix with 22 rows
and 2 columns.
</p>


<h3>Source</h3>

<p>KNMI
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dataKNMI)
n &lt;- nrow(dataKNMI$data)
locations &lt;- dataKNMI$loc
x &lt;- apply(dataKNMI$data, 2, function(i) n/(n + 0.5 - rank(i)))
indices &lt;- selectGrid(cst = c(0,1), d = 22, locations = locations, maxDistance = 0.5)
EstimationBR(x, locations, indices, k = 60, method = "Mestimator", isotropic = TRUE,
covMat = FALSE)$theta
</code></pre>

<hr>
<h2 id='EstimationBR'>Estimation of the parameters of the Brown-Resnick process</h2><span id='topic+EstimationBR'></span>

<h3>Description</h3>

<p>Estimation the parameters of the Brown-Resnick process, using either the pairwise M-estimator or weighted least squares (WLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimationBR(
  x,
  locations,
  indices,
  k,
  method,
  isotropic = FALSE,
  biascorr = FALSE,
  Tol = 1e-05,
  k1 = (nrow(x) - 10),
  tau = 5,
  startingValue = NULL,
  Omega = diag(nrow(indices)),
  iterate = FALSE,
  covMat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstimationBR_+3A_x">x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">d</code> data matrix.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_locations">locations</code></td>
<td>
<p>A <code class="reqn">d</code> x 2 matrix containing the Cartesian coordinates of <code class="reqn">d</code> points in the plane.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing exactly 2 ones per row, representing a pair of points from the matrix <code>locations</code>, and zeroes elsewhere.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_method">method</code></td>
<td>
<p>Choose between <code>Mestimator</code> and <code>WLS</code>.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_isotropic">isotropic</code></td>
<td>
<p>A Boolean variable. If <code>FALSE</code> (the default), then an anisotropic process is estimated.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_biascorr">biascorr</code></td>
<td>
<p>For <code>method = "WLS"</code> only. If <code>TRUE</code>, then the bias-corrected estimator of the stable tail dependence function is used. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_tol">Tol</code></td>
<td>
<p>For <code>method = "Mestimator"</code> only. The tolerance parameter used in the numerical integration procedure. Defaults to 1e-05.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_k1">k1</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The value of <code class="reqn">k_1</code> in the definition of the bias-corrected estimator of the stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_tau">tau</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The parameter of the power kernel.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_startingvalue">startingValue</code></td>
<td>
<p>Initial value of the parameters in the minimization routine. Defaults to <code class="reqn">c(1,1.5)</code> if <code>isotropic = TRUE</code> and <code class="reqn">c(1, 1.5, 0.75, 0.75)</code> if <code>isotropic = FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_omega">Omega</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">q</code> matrix specifying the metric with which the distance between the parametric and nonparametric estimates will be computed. The default is the identity matrix, i.e., the Euclidean metric.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_iterate">iterate</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code>, then for <code>method = "Mestimator"</code> the estimator is calculated twice, first with <code>Omega</code> specified by the user, and then a second time with the optimal <code>Omega</code> calculated at the initial estimate. If <code>method = "WLS"</code>, then continuous updating is used.</p>
</td></tr>
<tr><td><code id="EstimationBR_+3A_covmat">covMat</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code> (the default), the covariance matrix is calculated. Standard errors are obtained by taking the square root of the diagonal elements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters of the Brown-Resnick process are either <code class="reqn">(\alpha,\rho)</code> for an isotropic process or <code class="reqn">(\alpha,\rho,\beta,c)</code> for an anisotropic process. The matrix <code>indices</code> can be either user-defined or returned from the function <code>selectGrid</code> with <code>cst = c(0,1)</code>. Estimation might be rather slow when <code>iterate = TRUE</code> or even when <code>covMat = TRUE</code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>theta</code> </td><td style="text-align: left;"> The estimator using the optimal weight matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>theta_pilot</code> </td><td style="text-align: left;"> The estimator without the optimal weight matrix.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>covMatrix</code> </td><td style="text-align: left;"> The estimated covariance matrix for the estimator. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> The value of the minimized function at <code>theta</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## define the locations of 9 stations
locations &lt;- cbind(rep(c(1:3), each = 3), rep(1:3, 3))
## select the pairs of locations
indices &lt;- selectGrid(cst = c(0,1), d = 9, locations = locations, maxDistance = 1.5)
## The Brown-Resnick process
set.seed(1)
x &lt;- SpatialExtremes::rmaxstab(n = 1000, coord = locations, cov.mod = "brown",
                               range = 3, smooth = 1)
## Calculate the estimtors.
EstimationBR(x, locations, indices, 100, method = "Mestimator", isotropic = TRUE,
             covMat = FALSE)$theta
EstimationBR(x, locations, indices, 100, method = "WLS", isotropic = TRUE,
covMat = FALSE)$theta
</code></pre>

<hr>
<h2 id='EstimationGumbel'>Estimation of the parameter of the Gumbel model</h2><span id='topic+EstimationGumbel'></span>

<h3>Description</h3>

<p>Estimation the parameter of the Gumbel model, using either the pairwise M-estimator or weighted least squares (WLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimationGumbel(
  x,
  indices,
  k,
  method,
  biascorr = FALSE,
  k1 = (nrow(x) - 10),
  tau = 5,
  covMat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstimationGumbel_+3A_x">x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">d</code> data matrix.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing at least 2 non-zero elements per row, representing the values in which we will evaluate the stable tail dependence function. For <code>method = Mestimator</code>, this matrix should contain exactly two ones per row.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_method">method</code></td>
<td>
<p>Choose between <code>Mestimator</code> and <code>WLS</code>.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_biascorr">biascorr</code></td>
<td>
<p>For <code>method = "WLS"</code> only. If <code>TRUE</code>, then the bias-corrected estimator of the stable tail dependence function is used. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_k1">k1</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The value of <code class="reqn">k_1</code> in the definition of the bias-corrected estimator of the stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_tau">tau</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The parameter of the power kernel.</p>
</td></tr>
<tr><td><code id="EstimationGumbel_+3A_covmat">covMat</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code> (the default), the covariance matrix is calculated. Standard errors are obtained by taking the square root of the diagonal elements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix <code>indices</code> can be either user defined or returned by <code>selectGrid</code>. For <code>method = "Mestimator"</code>, only a grid with exactly two ones per row is accepted, representing the pairs to be used.
</p>


<h3>Value</h3>

<p>For <code>WLS</code>, a list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>theta</code> </td><td style="text-align: left;"> The estimator with weight matrix identity. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>covMatrix</code> </td><td style="text-align: left;"> The estimated covariance matrix for the estimator. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> The value of the minimized function at <code>theta</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate data with theta = 0.5
set.seed(1)
n &lt;- 1000
cop &lt;- copula::gumbelCopula(param = 2, dim = 3)
data &lt;- copula::rCopula(n = n,copula = cop)
## Transform data to unit Pareto margins
x &lt;- apply(data, 2, function(i) n/(n + 0.5 - rank(i)))
## Define indices in which we evaluate the estimator
indices &lt;- selectGrid(c(0,1), d = 3)
EstimationGumbel(x, indices, k = 50, method = "WLS", biascorr = TRUE)
</code></pre>

<hr>
<h2 id='EstimationMaxLinear'>Estimation of the parameters of the max-linear model</h2><span id='topic+EstimationMaxLinear'></span>

<h3>Description</h3>

<p>Estimation the parameters of the max-linear model, using either the pairwise M-estimator or weighted least squares (WLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EstimationMaxLinear(
  x,
  indices,
  k,
  method,
  Bmatrix = NULL,
  Ldot = NULL,
  biascorr = FALSE,
  k1 = (nrow(x) - 10),
  tau = 5,
  startingValue,
  Omega = diag(nrow(indices)),
  iterate = FALSE,
  covMat = TRUE,
  GoFtest = FALSE,
  dist = 0.01,
  EURO = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EstimationMaxLinear_+3A_x">x</code></td>
<td>
<p>An <code class="reqn">n</code> x <code class="reqn">d</code> data matrix.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_indices">indices</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">d</code> matrix containing at least 2 non-zero elements per row, representing the values in which we will evaluate the stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_method">method</code></td>
<td>
<p>Choose between <code>Mestimator</code> and <code>WLS</code>.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_bmatrix">Bmatrix</code></td>
<td>
<p>A function that converts the parameter vector theta to a parameter matrix B. If nothing is provided, then a simple 2-factor model is assumed.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_ldot">Ldot</code></td>
<td>
<p>For <code>method = "WLS"</code> only. A <code class="reqn">q</code> x <code class="reqn">p</code> matrix, where <code class="reqn">p</code> is the number of parameters of the model. Represents the total derivative of the function L defined in Einmahl et al. (2016). If nothing is provided, then a simple 2-factor model is assumed.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_biascorr">biascorr</code></td>
<td>
<p>For <code>method = "WLS"</code> only. If <code>TRUE</code>, then the bias-corrected estimator of the stable tail dependence function is used. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_k1">k1</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The value of <code class="reqn">k_1</code> in the definition of the bias-corrected estimator of the stable tail dependence function.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_tau">tau</code></td>
<td>
<p>For <code>biascorr = TRUE</code> only. The parameter of the power kernel.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_startingvalue">startingValue</code></td>
<td>
<p>Initial value of the parameters in the minimization routine.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_omega">Omega</code></td>
<td>
<p>A <code class="reqn">q</code> x <code class="reqn">q</code> matrix specifying the metric with which the distance between the parametric and nonparametric estimates will be computed. The default is the identity matrix, i.e., the Euclidean metric.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_iterate">iterate</code></td>
<td>
<p>A Boolean variable. For <code>method = "WLS"</code> only. If <code>TRUE</code>, then continuous updating is used. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_covmat">covMat</code></td>
<td>
<p>A Boolean variable. For <code>method = "WLS"</code> only. If <code>TRUE</code> (the default), the covariance matrix is calculated.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_goftest">GoFtest</code></td>
<td>
<p>A Boolean variable. For <code>method = "WLS"</code> only. If <code>TRUE</code>, then the goodness-of-fit test of Corollary 2.6 from Einmahl et al. (2016) is performed. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_dist">dist</code></td>
<td>
<p>A positive scalar. If <code>GoFtest = TRUE</code>, only eigenvalues <code class="reqn">\nu</code> larger than <code>dist</code> are used; see Corollary 2.6 (Einmahl et al., 2016). Defaults to 0.01.</p>
</td></tr>
<tr><td><code id="EstimationMaxLinear_+3A_euro">EURO</code></td>
<td>
<p>A Boolean variable. If <code>TRUE</code>, then the model from Einmahl et al. (2016, Section 4) is assumed, and the corresponding <code>Bmatrix</code> and <code>Ldot</code> are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix <code>indices</code> can be either user defined or returned by <code>selectGrid</code>.
For <code>method = "Mestimator"</code>, only a grid with exactly two ones per row is accepted,
representing the pairs to be used. The functions <code>Bmatrix</code> and <code>Ldot</code> can be defined
such that they represent a max-linear model on a directed acyclic graph: see the vignette for this package for an example.
</p>


<h3>Value</h3>

<p>For <code>Mestimator</code>, the estimator <code>theta</code> is returned. For <code>WLS</code>, a list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>theta</code> </td><td style="text-align: left;"> The estimator with estimated optimal weight matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>theta_pilot</code> </td><td style="text-align: left;"> The estimator without the optimal weight matrix.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>covMatrix</code> </td><td style="text-align: left;"> The estimated covariance matrix for the estimator. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>value</code> </td><td style="text-align: left;"> The value of the minimized function at <code>theta</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>GoFresult</code> </td><td style="text-align: left;"> A list of length two, returning the value of the test statistic and <code>s</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectGrid">selectGrid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate data
set.seed(1)
n &lt;- 1000
fr &lt;- matrix(-1/log(runif(2*n)), nrow = n, ncol = 2)
data &lt;- cbind(pmax(0.3*fr[,1],0.7*fr[,2]),pmax(0.5*fr[,1],0.5*fr[,2]),pmax(0.9*fr[,1],0.1*fr[,2]))
## Transform data to unit Pareto margins
x &lt;- apply(data, 2, function(i) n/(n + 0.5 - rank(i)))
## Define indices in which we evaluate the estimator
indices &lt;- selectGrid(cst = c(0,0.5,1), d = 3)
EstimationMaxLinear(x, indices, k = 100, method = "WLS", startingValue = c(0.3,0.5,0.9))
indices &lt;- selectGrid(cst = c(0,1), d = 3)
EstimationMaxLinear(x, indices, k = 100, method = "Mestimator", startingValue = c(0.3,0.5,0.9))
</code></pre>

<hr>
<h2 id='selectGrid'>Selects a grid of indices.</h2><span id='topic+selectGrid'></span>

<h3>Description</h3>

<p>Returns a regular grid of indices in which to evaluate the stable tail dependence function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectGrid(cst, d, nonzero = 2, locations = NULL, maxDistance = 10^6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectGrid_+3A_cst">cst</code></td>
<td>
<p>A vector containing the values used to construct the grid. Must contain 0.</p>
</td></tr>
<tr><td><code id="selectGrid_+3A_d">d</code></td>
<td>
<p>An integer, representing the dimension.</p>
</td></tr>
<tr><td><code id="selectGrid_+3A_nonzero">nonzero</code></td>
<td>
<p>An vector containing integers between <code class="reqn">2</code> and <code class="reqn">d</code>, representing the number of non-zero elements in every row of the grid. Defaults to <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="selectGrid_+3A_locations">locations</code></td>
<td>
<p>A <code>d</code> x <code class="reqn">2</code> matrix containing the Cartesian coordinates of <code class="reqn">d</code> points in the plane. Used for the Brown-Resnick process only. If not <code>NULL</code>, then <code>cst</code> must be <code>c(0,1)</code> and <code>nonzero</code> must be <code>2</code>.</p>
</td></tr>
<tr><td><code id="selectGrid_+3A_maxdistance">maxDistance</code></td>
<td>
<p>If <code>locations</code> is not <code>NULL</code>, pairs of locations with distance not larger than <code>maxDistance</code> will be selected.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with <code>q</code> rows and <code>d</code> columns, where every row represents a vector in which we will evaluate the stable tail dependence function (for the weighted least squares estimator) or where every row indicates which pairs of variables to use (for the M-estimator)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>selectGrid(cst = c(0,0.5,1), d = 3, nonzero = c(2,3))
locations &lt;- cbind(rep(1:3, each = 3), rep(1:3,3))
selectGrid(c(0,1), d = 9, locations = locations, maxDistance = 1.5)
</code></pre>

<hr>
<h2 id='stdfEmp'>Empirical stable tail dependence function</h2><span id='topic+stdfEmp'></span>

<h3>Description</h3>

<p>Returns the stable tail dependence function in dimension <code>d</code>, evaluated in a point <code>cst</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdfEmp(ranks, k, cst = rep(1, ncol(ranks)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdfEmp_+3A_ranks">ranks</code></td>
<td>
<p>A <code>n</code> x <code>d</code> matrix, where each column is a permutation of the integers <code>1:n</code>, representing the ranks computed from a sample of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="stdfEmp_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td></tr>
<tr><td><code id="stdfEmp_+3A_cst">cst</code></td>
<td>
<p>The value in which the tail dependence function is evaluated: defaults to <code>rep(1,d)</code>, i.e., the extremal coefficient.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar between <code class="reqn">\max(x_1,\ldots,x_d)</code> and <code class="reqn">x_1 + \cdots + x_d</code>.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stdfEmpCorr">stdfEmpCorr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate data from the Gumbel copula and compute the extremal coefficient in dimension four.
set.seed(2)
cop &lt;- copula::gumbelCopula(param = 2, dim = 4)
data &lt;- copula::rCopula(n = 1000, copula = cop)
stdfEmp(apply(data,2,rank), k = 50)
</code></pre>

<hr>
<h2 id='stdfEmpCorr'>Bias-corrected empirical stable tail dependence function</h2><span id='topic+stdfEmpCorr'></span>

<h3>Description</h3>

<p>Returns the bias-corrected stable tail dependence function in dimension <code>d</code>, evaluated in a point <code>cst</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdfEmpCorr(
  ranks,
  k,
  cst = rep(1, ncol(ranks)),
  tau = 5,
  k1 = (nrow(ranks) - 10)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdfEmpCorr_+3A_ranks">ranks</code></td>
<td>
<p>A <code>n</code> x <code>d</code> matrix, where each column is a permutation of the integers <code>1:n</code>, representing the ranks computed from a sample of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="stdfEmpCorr_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.</p>
</td></tr>
<tr><td><code id="stdfEmpCorr_+3A_cst">cst</code></td>
<td>
<p>The value in which the tail dependence function is evaluated: defaults to <code>rep(1,d)</code>.</p>
</td></tr>
<tr><td><code id="stdfEmpCorr_+3A_tau">tau</code></td>
<td>
<p>The parameter of the power kernel. Defaults to 5.</p>
</td></tr>
<tr><td><code id="stdfEmpCorr_+3A_k1">k1</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n</code>; defaults to <code class="reqn">n</code> - 10.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values for <code>k1</code> and <code>tau</code> are chosen as recommended in Beirlant et al. (2016). This function might be slow for large <code>n</code>.
</p>


<h3>Value</h3>

<p>A scalar between <code class="reqn">\max(x_1,\ldots,x_d)</code> and <code class="reqn">x_1 + \cdots + x_d</code>.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>
<p>Beirlant, J., Escobar-Bach, M., Goegebeur, Y., and Guillou, A. (2016). Bias-corrected estimation of stable tail dependence function. Journal of Multivariate Analysis, 143, 453-466.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stdfEmp">stdfEmp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate data from the Gumbel copula
set.seed(2)
cop &lt;- copula::gumbelCopula(param = 2, dim = 4)
data &lt;- copula::rCopula(n = 1000, copula = cop)
stdfEmpCorr(apply(data,2,rank), k = 50)
</code></pre>

<hr>
<h2 id='stdfEmpInt'>Integrated empirical stable tail dependence function</h2><span id='topic+stdfEmpInt'></span>

<h3>Description</h3>

<p>Analytical implementation of the integral of the bivariate stable tail dependence function over the unit square.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdfEmpInt(ranks, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stdfEmpInt_+3A_ranks">ranks</code></td>
<td>
<p>A <code>n</code> x 2 matrix, where each column is a permutation of the integers <code>1:n</code>, representing the ranks computed from a sample of size <code>n</code>.</p>
</td></tr>
<tr><td><code id="stdfEmpInt_+3A_k">k</code></td>
<td>
<p>An integer between 1 and <code class="reqn">n - 1</code>; the threshold parameter in the definition of the empirical stable tail dependence function.#' @return A scalar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A positive scalar.
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ranks &lt;- cbind(sample(1:20), sample(1:20))
stdfEmpInt(ranks, k = 5)
</code></pre>

<hr>
<h2 id='tailDepFun'>tailDepFun</h2><span id='topic+tailDepFun'></span>

<h3>Description</h3>

<p>The package <code>tailDepFun</code> provides functions implementing two rank-based minimal distance estimation
methods for parametric tail dependence models for distributions attracted to a max-stable law.
The estimators, referred to as the pairwise M-estimator and the weighted least squares estimator, are
described in Einmahl et al. (2016a) and Einmahl et al. (2016b). Extensive examples to illustrate the use
of the package can be found in the accompanying vignette.
</p>


<h3>Details</h3>

<p>Currently, this package allows for estimation of the Brown-Resnick process, the Gumbel (or logistic) model
and max-linear models (possibly on a directed acyclic graph). The main functions of this package are
<code><a href="#topic+EstimationBR">EstimationBR</a></code>, <code><a href="#topic+EstimationGumbel">EstimationGumbel</a></code> and <code><a href="#topic+EstimationMaxLinear">EstimationMaxLinear</a></code>,
but several other functions are exported as well: <code><a href="#topic+stdfEmpInt">stdfEmpInt</a></code>
returns the integral of the bivariate empirical stable tail dependence function over the unit square, and
<code><a href="#topic+stdfEmp">stdfEmp</a></code> and <code><a href="#topic+stdfEmpCorr">stdfEmpCorr</a></code> return the (bias-corrected) empirical stable tail dependence
function. The functions <code><a href="#topic+AsymVarBR">AsymVarBR</a></code>, <code><a href="#topic+AsymVarGumbel">AsymVarGumbel</a></code>, <code><a href="#topic+AsymVarMaxLinear">AsymVarMaxLinear</a></code>
return the asymptotic covariance matrices of the estimators. An auxiliary function to select a regular
grid of indices in which to evaluate the stable tail dependence function is exported as well,
<code><a href="#topic+selectGrid">selectGrid</a></code>. Finally, two datasets are available: <code><a href="#topic+dataKNMI">dataKNMI</a></code> (Einmahl et al., 2016)
and <code><a href="#topic+dataEUROSTOXX">dataEUROSTOXX</a></code> (Einmahl et al., 2018).
</p>


<h3>References</h3>

<p>Einmahl, J.H.J., Kiriliouk, A., Krajina, A., and Segers, J. (2016). An Mestimator of spatial tail dependence. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 78(1), 275-298.
</p>
<p>Einmahl, J.H.J., Kiriliouk, A., and Segers, J. (2018). A continuous updating weighted least squares estimator of tail dependence in high dimensions. Extremes 21(2), 205-233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get a list of all help files of user-visible functions in the package
help(package = tailDepFun)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
