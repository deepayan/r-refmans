<!DOCTYPE html><html><head><title>Help for package cartographer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cartographer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_geometry'><p>Convert input data frame into a spatial data frame</p></a></li>
<li><a href='#cartographer-package'><p>Turn Place Names into Map Data</p></a></li>
<li><a href='#feature_names'><p>List known feature names</p></a></li>
<li><a href='#feature_types'><p>List known feature types</p></a></li>
<li><a href='#map_outline'><p>Retrieve a map outline registered with cartographer.</p></a></li>
<li><a href='#map_sf'><p>Retrieve map data registered with cartographer.</p></a></li>
<li><a href='#map_sfc'><p>Retrieve geometry of a single location.</p></a></li>
<li><a href='#nc_type_example_1'><p>Example datasets with a feature name column and random data</p></a></li>
<li><a href='#register_map'><p>Register a new feature type</p></a></li>
<li><a href='#resolve_feature_names'><p>Canonicalise feature names accounting for aliases and character case</p></a></li>
<li><a href='#resolve_feature_type'><p>Guess the feature type if it was missing</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Turn Place Names into Map Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A tool for easily matching spatial data when you have a list of
    place/region names. You might have a data frame that came from a
    spreadsheet tracking some data by suburb or state. This package can
    convert it into a spatial data frame ready for plotting. The actual map
    data is provided by other packages (or your own code).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli (&ge; 3.6.0), dplyr (&ge; 1.1.0), rlang (&ge; 1.1.0), sf (&ge;
1.0.12)</td>
</tr>
<tr>
<td>Collate:</td>
<td>'cartographer-global.R' 'cartographer-package.R'
'add_geometry.R' 'data.R' 'resolve.R' 'zzz.R'</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="http://packages.ropensci.org">http://packages.ropensci.org</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2 (&ge; 3.4.2), knitr, maps, rnaturalearth,
rnaturalearthhires, rmarkdown</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cidm-ph/cartographer">https://github.com/cidm-ph/cartographer</a>,
<a href="https://cidm-ph.github.io/cartographer/">https://cidm-ph.github.io/cartographer/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cidm-ph/cartographer/issues">https://github.com/cidm-ph/cartographer/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-28 06:38:09 UTC; carl</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl Suster <a href="https://orcid.org/0000-0001-7021-9380"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Western Sydney Local Health District, NSW Health [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carl Suster &lt;Carl.Suster@health.nsw.gov.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-28 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_geometry'>Convert input data frame into a spatial data frame</h2><span id='topic+add_geometry'></span>

<h3>Description</h3>

<p>Convert input data frame into a spatial data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_geometry(x, location, feature_type = NA, geom_name = "geometry")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_geometry_+3A_x">x</code></td>
<td>
<p>Data frame with a feature name column.</p>
</td></tr>
<tr><td><code id="add_geometry_+3A_location">location</code></td>
<td>
<p>Feature names (tidy evaluation).</p>
</td></tr>
<tr><td><code id="add_geometry_+3A_feature_type">feature_type</code></td>
<td>
<p>The registered map corresponding to values in <code>location</code>.
If NA (the default), the type is guessed from the values in <code>location</code>.</p>
</td></tr>
<tr><td><code id="add_geometry_+3A_geom_name">geom_name</code></td>
<td>
<p>Name for the new column to contain the geometry.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A spatial data frame containing all of the columns from the input
data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>add_geometry(nc_type_example_2, county, feature_type = "sf.nc")
</code></pre>

<hr>
<h2 id='cartographer-package'>Turn Place Names into Map Data</h2><span id='topic+cartographer'></span><span id='topic+cartographer-package'></span>

<h3>Description</h3>

<p>Cartographer is a framework for easily matching spatial data when
you have a list of standardised place names. You might have a data frame
that came from a spreadsheet tracking some data by suburb or state. This
package can convert it into a spatial data frame ready for plotting. The
actual map data is provided by other packages (or your own code) that
register the data with cartographer.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Carl Suster <a href="mailto:Carl.Suster@health.nsw.gov.au">Carl.Suster@health.nsw.gov.au</a> (<a href="https://orcid.org/0000-0001-7021-9380">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Western Sydney Local Health District, NSW Health [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/cidm-ph/cartographer">https://github.com/cidm-ph/cartographer</a>
</p>
</li>
<li> <p><a href="https://cidm-ph.github.io/cartographer/">https://cidm-ph.github.io/cartographer/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/cidm-ph/cartographer/issues">https://github.com/cidm-ph/cartographer/issues</a>
</p>
</li></ul>


<hr>
<h2 id='feature_names'>List known feature names</h2><span id='topic+feature_names'></span>

<h3>Description</h3>

<p>This gives the list of feature names that are part of the specified map data.
The list includes any aliases defined when the map was registered. Note that
the <code>location</code> column matching is case insensitive (see Details below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feature_names(feature_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feature_names_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of feature names.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+register_map">register_map()</a></code> and <code><a href="#topic+resolve_feature_names">resolve_feature_names()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(feature_names("sf.nc"))
</code></pre>

<hr>
<h2 id='feature_types'>List known feature types</h2><span id='topic+feature_types'></span>

<h3>Description</h3>

<p>Each feature type corresponds to map data that has been registered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feature_types()
</code></pre>


<h3>Value</h3>

<p>Character vector of registered feature types.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+register_map">register_map()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>feature_types()
</code></pre>

<hr>
<h2 id='map_outline'>Retrieve a map outline registered with cartographer.</h2><span id='topic+map_outline'></span>

<h3>Description</h3>

<p>Retrieve a map outline registered with cartographer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_outline(feature_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_outline_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The map outline that was registered under <code>feature_type</code>. Note that
the outline is optional, so this will return <code>NULL</code> if none was registered.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>map_outline("sf.nc")
</code></pre>

<hr>
<h2 id='map_sf'>Retrieve map data registered with cartographer.</h2><span id='topic+map_sf'></span>

<h3>Description</h3>

<p>Retrieve map data registered with cartographer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_sf(feature_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_sf_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The spatial data frame that was registered under <code>feature_type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>map_sf("sf.nc")
</code></pre>

<hr>
<h2 id='map_sfc'>Retrieve geometry of a single location.</h2><span id='topic+map_sfc'></span>

<h3>Description</h3>

<p>Retrieve geometry of a single location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_sfc(feature_names, feature_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_sfc_+3A_feature_names">feature_names</code></td>
<td>
<p>Name of the feature(s) to retrieve. This must be an exact
case-sensitive match, and aliases are not consulted.</p>
</td></tr>
<tr><td><code id="map_sfc_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The geometry as a <code>sfc</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>map_sfc("Ashe", "sf.nc")
map_sfc(c("Craven", "Buncombe"), "sf.nc")
</code></pre>

<hr>
<h2 id='nc_type_example_1'>Example datasets with a feature name column and random data</h2><span id='topic+nc_type_example_1'></span><span id='topic+nc_type_example_2'></span>

<h3>Description</h3>

<p>This dataset contains random data compatible with the <code>sf.nc</code> example
map data for illustrating cartographer's features. <code>nc_type_example_1</code>
contains a deliberate error in the county name for a single row, whereas
<code>nc_type_example_2</code> contains correct data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nc_type_example_1

nc_type_example_2
</code></pre>


<h3>Format</h3>

<p>Objects of class <code>data.frame</code> with 50 and 200 rows respectively, and 2 columns:
</p>

<dl>
<dt>county</dt><dd><p>Feature names that match the NAME field of the nc dataset</p>
</dd>
<dt>type</dt><dd><p>Arbitrary categorical data</p>
</dd>
</dl>


<hr>
<h2 id='register_map'>Register a new feature type</h2><span id='topic+register_map'></span>

<h3>Description</h3>

<p>This adds a new feature type that can then be used by all the geoms in this
package. If registering from another package, this should occur in the
<code>.onLoad()</code> hook in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_map(
  feature_type,
  data,
  feature_column,
  aliases = NULL,
  outline = NULL,
  lazy = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="register_map_+3A_feature_type">feature_type</code></td>
<td>
<p>Name of the type. If registering from within a package,
the suggested format is <code>"&lt;package name&gt;.&lt;map name&gt;"</code> to avoid clashes
between packages.</p>
</td></tr>
<tr><td><code id="register_map_+3A_data">data</code></td>
<td>
<p>A simple feature data frame with the map data, or a function
that returns a data frame. When <code>lazy</code> is <code>TRUE</code>, the value
will not be evaluated until the data is first accessed.</p>
</td></tr>
<tr><td><code id="register_map_+3A_feature_column">feature_column</code></td>
<td>
<p>Name of the column of <code>data</code> that contains the
feature names.</p>
</td></tr>
<tr><td><code id="register_map_+3A_aliases">aliases</code></td>
<td>
<p>Optional named character vector or list that maps aliases to
values that appear in the feature column. This allows abbreviations or
alternative names to be supported.</p>
</td></tr>
<tr><td><code id="register_map_+3A_outline">outline</code></td>
<td>
<p>Optional sf geometry containing just the outline of the map,
or a function returning such a geometry. When <code>lazy</code> is <code>TRUE</code>,
the value will not be evaluated until the data is first accessed.</p>
</td></tr>
<tr><td><code id="register_map_+3A_lazy">lazy</code></td>
<td>
<p>When <code>TRUE</code>, defer evaluation of <code>data</code> and
<code>outline</code> until it is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Registration supports delayed evaluation (lazy loading). This is particularly
useful for larger datasets, so that they are not loaded into memory until
they are accessed.
</p>


<h3>Value</h3>

<p>No return value; this updates the global feature registry.
</p>


<h3>See Also</h3>

<p><code>vignette("registering_maps")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># register a map of the states of Italy from rnaturalearth using the
# Italian names, and providing an outline of the country
register_map(
  "italy",
  data = rnaturalearth::ne_states(country = "italy", returnclass = "sf"),
  feature_column = "name_it",
  outline = rnaturalearth::ne_countries(country = "italy", returnclass = "sf", scale = "large")
)
</code></pre>

<hr>
<h2 id='resolve_feature_names'>Canonicalise feature names accounting for aliases and character case</h2><span id='topic+resolve_feature_names'></span>

<h3>Description</h3>

<p>Names are resolved by checking for the first match using:
</p>

<ol>
<li><p> case sensitive match, then
</p>
</li>
<li><p> case sensitive match using aliases, then
</p>
</li>
<li><p> case insensitive match, then
</p>
</li>
<li><p> case insensitive match using aliases.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>resolve_feature_names(feature_names, feature_type, unmatched = "error")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resolve_feature_names_+3A_feature_names">feature_names</code></td>
<td>
<p>Character vector of feature names in the data.</p>
</td></tr>
<tr><td><code id="resolve_feature_names_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types.</p>
</td></tr>
<tr><td><code id="resolve_feature_names_+3A_unmatched">unmatched</code></td>
<td>
<p>Controls behaviour when <code>feature_names</code> contains values
that do not match registered feature names. Possible values are
<code>"error"</code> to throw an error or
<code>"pass"</code> to return the original values unaltered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of the canonicalised names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>resolve_feature_names(c("LEE", "ansoN"), feature_type = "sf.nc")
resolve_feature_names(c("LEE", "ansoNe"), feature_type = "sf.nc", unmatched = "pass")
</code></pre>

<hr>
<h2 id='resolve_feature_type'>Guess the feature type if it was missing</h2><span id='topic+resolve_feature_type'></span>

<h3>Description</h3>

<p>If <code>feature_type</code> is provided, this simply checks that the type has been
registered. If it is <code>NA</code>, however, an attempt it made to guess the
appropriate choice. This is done by comparing the example values provided
as <code>feature_names</code> with the names of all registered map datasets. If there
is an unambiguous match, that will be filled in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resolve_feature_type(feature_type, feature_names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resolve_feature_type_+3A_feature_type">feature_type</code></td>
<td>
<p>Type of map feature. See <code><a href="#topic+feature_types">feature_types()</a></code> for a list of
registered types. If <code>NA</code>, the type is guessed based on the values in
<code>feature_names</code>.</p>
</td></tr>
<tr><td><code id="resolve_feature_type_+3A_feature_names">feature_names</code></td>
<td>
<p>Character vector of feature names in the data. This can
be a subset of the values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cartographer lazy loads map data for registered maps. In order to compare
the example <code>feature_names</code> with registered maps, it might be necessary
to force some of these datasets to load. To minimise the impact, any maps
that have already been loaded are checked first. Other maps are then
loaded one at a time until any matches are found. Consequently, the result
returned by this function is not deterministic.
</p>
<p>In the worst case where none of the registered maps matches, all of them
will be loaded. This might take several seconds and occupy some memory,
depending on which maps are registered. If a match is found, however, it
will be found quickly on subsequent calls since the data will have
already been loaded.
</p>
<p>The best way to avoid these issues is to explicitly specify the
<code>feature_type</code>.
</p>


<h3>Value</h3>

<p>The resolved feature type as a scalar character.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>resolve_feature_type("sf.nc")
resolve_feature_type(NA, feature_names = c("ANSON", "Stanly"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
