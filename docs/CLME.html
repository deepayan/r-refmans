<!DOCTYPE html><html lang="en"><head><title>Help for package CLME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CLME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CLME-package'><p>Constrained inference for linear mixed models.</p></a></li>
<li><a href='#AIC.clme'><p>Akaike information criterion</p></a></li>
<li><a href='#BIC.clme'><p>Bayesian information criterion</p></a></li>
<li><a href='#clme'><p>Constrained Inference for Linear Mixed Effects Models</p></a></li>
<li><a href='#clme_em_fixed'><p>Constrained EM algorithm for linear fixed or mixed effects models.</p></a></li>
<li><a href='#clme_resids'><p>Computes various types of residuals</p></a></li>
<li><a href='#confint.clme'><p>Individual confidence intervals</p></a></li>
<li><a href='#create.constraints'><p>Generate common order constraints</p></a></li>
<li><a href='#fibroid'><p>Fibroid Growth Study</p></a></li>
<li><a href='#fixef.clme'><p>Extract fixed effects</p></a></li>
<li><a href='#formula.clme'><p>Extract formula</p></a></li>
<li><a href='#is.clme'><p>Constructor method for objects S3 class clme</p></a></li>
<li><a href='#logLik.clme'><p>Log-likelihood</p></a></li>
<li><a href='#lrt.stat'><p>Likelihood ratio type statistic (global)</p></a></li>
<li><a href='#minque'><p>MINQUE Algorithm</p></a></li>
<li><a href='#model_terms_clme'><p>Create model matrices for <code>clme</code></p></a></li>
<li><a href='#model.matrix.clme'><p>Extract the model design matrix.</p></a></li>
<li><a href='#nobs.clme'><p>Number of observations</p></a></li>
<li><a href='#plot.clme'><p>S3 method to plot objects of class <code>clme</code></p></a></li>
<li><a href='#plot.summary.clme'><p>S3 method to plot objects of class <code>clme</code></p></a></li>
<li><a href='#print.clme'><p>Printout of fitted object.</p></a></li>
<li><a href='#print.summary.clme'><p>S3 method to print a summary for objects of class <code>clme</code></p></a></li>
<li><a href='#print.varcorr_clme'><p>Printout for variance components</p></a></li>
<li><a href='#random.effects'><p>Extract random effects</p></a></li>
<li><a href='#ranef.clme'><p>Extract random effects</p></a></li>
<li><a href='#rat.blood'><p>Experiment on mice</p></a></li>
<li><a href='#resid_boot'><p>Obtain Residual Bootstrap</p></a></li>
<li><a href='#residuals.clme'><p>Various types of residuals</p></a></li>
<li><a href='#shiny_clme'><p>Shiny GUI for CLME</p></a></li>
<li><a href='#sigma.clme'><p>Residual variance components</p></a></li>
<li><a href='#sigma.summary.clme'><p>Residual variance components</p></a></li>
<li><a href='#summary.clme'><p>Produce summary values for objects of class <code>clme</code></p></a></li>
<li><a href='#VarCorr'><p>Variance components</p></a></li>
<li><a href='#vcov.clme'><p>Variance-covariance matrix</p></a></li>
<li><a href='#w.stat'><p>Williams' Type Test Statistic.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Constrained Inference for Linear Mixed Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0-12</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), shiny, lme4, MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, methods, isotone, stringr, prettyR, stats, openxlsx,
graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, nnet</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-04</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation and inference for linear models where some or all of the
    fixed-effects coefficients are subject to order restrictions. This package uses
    the robust residual bootstrap methodology for inference, and can handle some
    structure in the residual variance matrix.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Casey M. Jelsema &lt;jelsema.casey@gmail.com&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jelsema/CLME/issues">https://github.com/jelsema/CLME/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-07 18:04:17 UTC; statman</td>
</tr>
<tr>
<td>Author:</td>
<td>Casey M. Jelsema [aut, cre],
  Shyamal D. Peddada [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-07 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CLME-package'>Constrained inference for linear mixed models.</h2><span id='topic+CLME'></span><span id='topic+CLME-package'></span>

<h3>Description</h3>

<p>Constrained inference on linear fixed and mixed models using residual bootstrap. 
Covariates and random effects are permitted but not required.
</p>
<p>Appropriate credit should be given when publishing results obtained using <span class="pkg">CLME</span>, or when 
developing other programs/packages based off of this one. Use <code>citation(package="CLME")</code> 
for Bibtex information.
</p>
<p>The work was produced in part with funding from the Intramural Research Program of the NIH, 
National Institute of Environmental Health Sciences (Z01 ES101744).
</p>


<h3>Details</h3>

<p>This package was introduced in Jelsema and Peddada (2016). The primary function is <code><a href="#topic+clme">clme</a></code>. 
The other functions in this package may be run separately, but in general are designed for use by <code><a href="#topic+clme">clme</a></code>.
</p>
<p>The method which is implemented is the constrained linear mixed effects model described in 
Farnan, Ivanova, and Peddada (2014). See that paper for more details regarding the method. 
Here we give a brief overview of the assumed model:
</p>
<p style="text-align: center;"><code class="reqn"> Y = X_{1}\theta_{1} + X_{2}\theta_{2} + U\xi + \epsilon </code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">X_1</code> is a <code class="reqn">N \times p_1</code> design matrix.
</p>
</li>
<li> <p><code class="reqn">\theta_1</code> are the coefficients (often treatment effects).
</p>
</li>
<li> <p><code class="reqn">X_2</code> is a <code class="reqn">N \times p_2</code> matrix of fixed covariates.
</p>
</li>
<li> <p><code class="reqn">\theta_1</code> are the coefficients for the covariates.
</p>
</li>
<li> <p><code class="reqn">U</code> is a <code class="reqn">N \times c</code> matrix of random effects.
</p>
</li>
<li> <p><code class="reqn">\xi</code> is a zero-mean random vector with covariance <code class="reqn">T</code> (see below).
</p>
</li>
<li> <p><code class="reqn">\epsilon</code> is a zero-mean random vector with covariance <code class="reqn">\Sigma</code> (see below).
</p>
</li></ul>

<p>Neither covariates (<code class="reqn">X_2</code>) nor random effects (<code class="reqn">U</code>) are required by the model or <span class="pkg">CLME</span>. The covariance matrix of <code class="reqn">\xi</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn"> T = diag\left( \tau^{2}_{1}I_{c_{1}}, \tau^{2}_{2}I_{c_{2}}  , \dots , \tau^{2}_{q}I_{c_{q}} \right) </code>
</p>

<p>The first <code class="reqn">c_{1}</code> random effects will share a common variance, <code class="reqn">\tau^{2}_{1}</code>, the next <code class="reqn">c_{2}</code> random effects will share a common variance, and so on. Note that <code class="reqn">c = \sum_{i=1}^{q} c_i</code>. Homogeneity of variances in the random effects can be induced by letting <code class="reqn">q=1</code> (hence <code class="reqn">c_{1}=c=ncol(U)</code>).
</p>
<p>Similarly, the covariance matrix of <code class="reqn">\epsilon</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn"> \Sigma = diag\left( \sigma^{2}_{1}I_{n_{1}}, \sigma^{2}_{2}I_{n_{2}}  , \dots , \sigma^{2}_{q}I_{n_{k}} \right) </code>
</p>

<p>Again, the first <code class="reqn">n_{1}</code> observations will share a common variance, <code class="reqn">\sigma^{2}_{1}</code>, the next <code class="reqn">n_{2}</code> will share a common variance, and so on. Note that <code class="reqn">N = \sum_{i=1}^{k} n_i</code>. Homogeneity of variances in the residuals can be induced by letting <code class="reqn">k=1</code>.
</p>
<p>The order constraints are defined by the matrix <code class="reqn">A</code>. This is an <code class="reqn">r \times p</code> matrix where <code class="reqn">r</code> is the number of constraints, and <code class="reqn">p=p_{1}+p_{2}</code> is the dimension of <code class="reqn"> \theta = ( \theta_{1}' , \theta_{2}')'</code>. Formally the hypothesis being tested is:
</p>
<p style="text-align: center;"><code class="reqn"> H_{a}: A\theta &gt; 0 </code>
</p>

<p>For several default orders (simple, umbrella, simple tree) the <code class="reqn">A</code> matrix can be automatically generated. Alternatively, the user may define a custom <code class="reqn">A</code> matrix to test other patterns among the elements of <code class="reqn">\theta</code>. See <code><a href="#topic+create.constraints">create.constraints</a></code> and <code><a href="#topic+clme">clme</a></code> for more details.
</p>
<p>For computational reasons, the implementation is not identical to the model expressed. Particularly, the fixed-effects matrix (or matrices) and the random effects matrix are assumed to be columns in a data frame, not passed as matrices. The <code class="reqn">A</code> matrix is not <code class="reqn">r\ times p</code>, but <code class="reqn">r\ times 2</code>, where each row gives the indices of the constrained coefficients. See <code><a href="#topic+create.constraints">create.constraints</a></code> for further explanation.
</p>
<p>The creation of this package <span class="pkg">CLME</span>, this manual, and the vignette were all supported by the Intramural Research Program of the United States' National Institutes of Health (Z01 ES101744).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Casey M. Jelsema <a href="mailto:jelsema.casey@gmail.com">jelsema.casey@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Shyamal D. Peddada
</p>
</li></ul>



<h3>References</h3>

<p>Jelsema, C. M. and Peddada, S. D. (2016). 
CLME: An R Package for Linear Mixed Effects Models under Inequality Constraints. 
<em>Journal of Statistical Software</em>, 75(1), 1-32. doi:10.18637/jss.v075.i01
</p>
<p>Farnan, L., Ivanova, A., and Peddada, S. D. (2014).
Linear Mixed Efects Models under Inequality Constraints with Applications.
<em>PLOS ONE</em>, 9(1). e84778. doi: 10.1371/journal.pone.0084778
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/jelsema/CLME/issues">https://github.com/jelsema/CLME/issues</a>
</p>
</li></ul>


<hr>
<h2 id='AIC.clme'>Akaike information criterion</h2><span id='topic+AIC.clme'></span><span id='topic+AIC.summary.clme'></span>

<h3>Description</h3>

<p>Calculates the Akaike and Bayesian information criterion for objects of class <code>clme</code>.
</p>
<p>Calculates the Akaike and Bayesian information criterion for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
AIC(object, ..., k = 2)

## S3 method for class 'summary.clme'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="AIC.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
<tr><td><code id="AIC.clme_+3A_k">k</code></td>
<td>
<p>value multiplied by number of coefficients</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-likelihood is assumed to be the Normal distribution. The model uses residual bootstrap methodology, and Normality is neither required nor assumed. Therefore the log-likelihood and these information criterion may not be useful measures for comparing models.
For <code>k=2</code>, the function computes the AIC. To obtain BIC, set <code class="reqn">k = log( n/(2*pi) )</code>; which the method <code>BIC.clme</code> does.
</p>


<h3>Value</h3>

<p>Returns the information criterion (numeric).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )

cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

AIC( clme.out )
AIC( clme.out, k=log( nobs(clme.out)/(2*pi) ) )


</code></pre>

<hr>
<h2 id='BIC.clme'>Bayesian information criterion</h2><span id='topic+BIC.clme'></span><span id='topic+BIC.summary.clme'></span>

<h3>Description</h3>

<p>Calculates the Bayesian information criterion for objects of class <code>clme</code>.
</p>
<p>Calculates the Akaike and Bayesian information criterion for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
BIC(object, ..., k = log(nobs(object)/(2 * pi)))

## S3 method for class 'summary.clme'
BIC(object, ..., k = log(nobs(object)/(2 * pi)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIC.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="BIC.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
<tr><td><code id="BIC.clme_+3A_k">k</code></td>
<td>
<p>value multiplied by number of coefficients</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-likelihood is assumed to be the Normal distribution. The model uses residual bootstrap methodology, and Normality is neither required nor assumed. Therefore the log-likelihood and these information criterion may not be useful measures for comparing models.
For <code>k=2</code>, the function computes the AIC. To obtain BIC, set <code class="reqn">k = log( n/(2*pi) )</code>; which the method <code>BIC.clme</code> does.
</p>


<h3>Value</h3>

<p>Returns the Bayesian information criterion (numeric).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )

cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

BIC( clme.out )
BIC( clme.out, k=log( nobs(clme.out)/(2*pi) ) )


</code></pre>

<hr>
<h2 id='clme'>Constrained Inference for Linear Mixed Effects Models</h2><span id='topic+clme'></span>

<h3>Description</h3>

<p>Constrained inference for linear fixed or mixed
effects models using distribution-free bootstrap methodology
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clme(
  formula,
  data = NULL,
  gfix = NULL,
  constraints = list(),
  tsf = lrt.stat,
  tsf.ind = w.stat.ind,
  mySolver = "LS",
  all_pair = FALSE,
  verbose = c(FALSE, FALSE, FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clme_+3A_formula">formula</code></td>
<td>
<p>a formula expression. The constrained effect must come before any unconstrained 
covariates on the right-hand side of the expression. The constrained effect should 
be an ordered factor.</p>
</td></tr>
<tr><td><code id="clme_+3A_data">data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="clme_+3A_gfix">gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td></tr>
<tr><td><code id="clme_+3A_constraints">constraints</code></td>
<td>
<p>optional list containing the constraints. See Details for further information.</p>
</td></tr>
<tr><td><code id="clme_+3A_tsf">tsf</code></td>
<td>
<p>function to calculate the test statistic.</p>
</td></tr>
<tr><td><code id="clme_+3A_tsf.ind">tsf.ind</code></td>
<td>
<p>function to calculate the test statistic for individual constrats. See Details for further information.</p>
</td></tr>
<tr><td><code id="clme_+3A_mysolver">mySolver</code></td>
<td>
<p>solver to use in isotonization (passed to <code>activeSet</code>).</p>
</td></tr>
<tr><td><code id="clme_+3A_all_pair">all_pair</code></td>
<td>
<p>logical, whether all pairwise comparisons should be considered (constraints will be ignored).</p>
</td></tr>
<tr><td><code id="clme_+3A_verbose">verbose</code></td>
<td>
<p>optional. Vector of 3 logicals. The first causes printing of iteration step, the second two are passed as the <code>verbose</code> argument to the functions <code><a href="#topic+minque">minque</a></code> and <code><a href="#topic+clme_em">clme_em</a></code>, respectively.</p>
</td></tr>
<tr><td><code id="clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any random effects are included, the function computes MINQUE estimates of variance components. After, 
<code><a href="#topic+clme_em">clme_em</a></code> is run to obtain the observed values. If <code>nsim</code>&gt;0, a bootstrap test is performed
using <code><a href="#topic+resid_boot">resid_boot</a></code>.
For the argument <code>levels</code> the first list element should be the column index (in <code>data</code>) of the
constrained effect. The second element should be the true order of the levels.
</p>


<h3>Value</h3>

<p>The output of <code>clme</code> is an object of the class <code>clme</code>, which is list with elements:
</p>
    
<ul>
<li><p><code>theta</code> estimates of <code class="reqn">\theta</code> coefficients
</p>
</li>
<li><p><code>theta</code> estimates of <code class="reqn">\theta_0</code> coefficients under the null hypothesis
</p>
</li>
<li><p><code>ssq</code> estimate of residual variance(s), <code class="reqn">\sigma^{2}_{i}</code>.
</p>
</li>
<li><p><code>tsq</code> estimate of random effects variance component(s), <code class="reqn">\tau^{2}_{i}</code>.
</p>
</li>
<li><p><code>cov.theta</code> the unconstrained covariance matrix of <code class="reqn">\theta</code>
</p>
</li>
<li><p><code>ts.glb</code> test statistic for the global hypothesis.
</p>
</li>
<li><p><code>ts.ind</code> test statistics for each of the constraints.
</p>
</li>
<li><p><code>mySolver</code> the solver used for isotonization.
</p>
</li>
<li><p><code>constraints</code> list containing the constraints (<code>A</code>) and the contrast for the global test (<code>B</code>).
</p>
</li>
<li><p><code>dframe</code> data frame containing the variables in the model.
</p>
</li>
<li><p><code>residuals</code> matrix containing residuals. For mixed models three types of residuals are given. 
</p>
</li>
<li><p><code>random.effects</code> estimates of random effects. 
</p>
</li>
<li><p><code>gfix</code> group sample sizes for residual variances. 
</p>
</li>
<li><p><code>gran</code> group sizes for random effect variance components. 
</p>
</li>
<li><p><code>gfix_group</code> group names for residual variances. 
</p>
</li>
<li><p><code>formula</code> the formula used in the model. 
</p>
</li>
<li><p><code>call</code> the function call. 
</p>
</li>
<li><p><code>order</code> list describing the specified or estimated constraints.
</p>
</li>
<li><p><code>P1</code> the number of constrained parameters.
</p>
</li>
<li><p><code>nsim</code> the number of bootstrap simulations used for inference.
</p>
</li></ul>



<h3>Note</h3>

<p>The argument <code>constraints</code> is a list containing the order restrictions. The elements are 
<code>order</code>, <code>node</code>, <code>decreasing</code>, <code>A</code>, and <code>B</code>, though not all are necessary.
The function can calculate the last two for default orders (simple, umbrella, or simple tree). For
default orders, <code>constraints</code> should be a list containing any subset of <code>order</code>, 
<code>node</code>, and <code>descending</code>. See Figure 1 from Jelsema \&amp; Peddada (2016); the 
pictured <code>node</code> of the simple tree orders (middle column) is 1, and the <code>node</code> for the
umbrella orders (right column) is 3. These may be vectors (e.g. order=('simple','umbrella') ).
If any of these three are missing, the function will test for all possible values of the missing 
element(s), excluding simple tree.
</p>
<p>For non-default orders, the elements <code>A</code> and <code>B</code> should be provided. <code>A</code> is an
<code class="reqn">r \times2</code> matrix (where r is the number of linear constraints, <code class="reqn">0 &lt; r</code>. 
Each row should contain two indices, the first element is the index of the lesser coefficient, the 
second element is the index of the greater coefficient. So a row of <code class="reqn">(1,2)</code> corresponds
to the constraint <code class="reqn">\theta_1 \leq \theta_2</code>, and a row <code class="reqn">(4,3)</code> 
corresponds to the constraint <code class="reqn">\theta_4 \leq \theta_3</code>, etc. Element <code>B</code>
should hold similar contrasts, specifically those needed for calculating the Williams' type test 
statistic (<code>B</code> is only needed if <code>tsf=w.stat</code>)
The argument <code>tsf</code> is a function to calculate the desired test statistic. The default function 
calculates likelihood ratio type test statistic. A Williams type test statistic, which is the maximum 
of the test statistic over the constraints in <code>constraints\$B</code>, is also available, and custom 
functions may be defined. See <code><a href="#topic+w.stat">w.stat</a></code> for details.
By default, homogeneity of variances is assumed for residuals (e.g., <code>gfix</code> does not define groups)
and for each random effect. 
Some values can be passed to <code>clme</code> that are not used in this function. For instance, 
<code>seed</code> and <code>nsim</code> can each be passed as an argument here, and <code><a href="#topic+summary.clme">summary.clme</a></code> will
use these values.
</p>


<h3>References</h3>

<p>Jelsema, C. M. and Peddada, S. D. (2016). 
CLME: An R Package for Linear Mixed Effects Models under Inequality Constraints. 
<em>Journal of Statistical Software</em>, 75(1), 1-32. doi:10.18637/jss.v075.i01
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )
cons &lt;- list(order="simple", decreasing=FALSE, node=1 )

clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data=rat.blood , 
                 constraints=cons, seed=42, nsim=10 )

</code></pre>

<hr>
<h2 id='clme_em_fixed'>Constrained EM algorithm for linear fixed or mixed effects models.</h2><span id='topic+clme_em_fixed'></span><span id='topic+clme_em_mixed'></span><span id='topic+clme_em'></span>

<h3>Description</h3>

<p><code>clme_em_fixed</code> performs a constrained EM algorithm for linear fixed effects models.
</p>
<p><code>clme_em_mixed</code> performs a constrained EM algorithm for linear mixed effects models.
</p>
<p><code>clme_em</code> is the general function, it will call the others.
These Expectation-maximization (EM) algorithms estimate model parameters and 
compute a test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clme_em_fixed(
  Y,
  X1,
  X2 = NULL,
  U = NULL,
  Nks = dim(X1)[1],
  Qs = dim(U)[2],
  constraints,
  mq.phi = NULL,
  tsf = lrt.stat,
  tsf.ind = w.stat.ind,
  mySolver = "LS",
  em.iter = 500,
  em.eps = 1e-04,
  all_pair = FALSE,
  dvar = NULL,
  verbose = FALSE,
  ...
)

clme_em_mixed(
  Y,
  X1,
  X2 = NULL,
  U = NULL,
  Nks = dim(X1)[1],
  Qs = dim(U)[2],
  constraints,
  mq.phi = NULL,
  tsf = lrt.stat,
  tsf.ind = w.stat.ind,
  mySolver = "LS",
  em.iter = 500,
  em.eps = 1e-04,
  all_pair = FALSE,
  dvar = NULL,
  verbose = FALSE,
  ...
)

clme_em(
  Y,
  X1,
  X2 = NULL,
  U = NULL,
  Nks = nrow(X1),
  Qs = ncol(U),
  constraints,
  mq.phi = NULL,
  tsf = lrt.stat,
  tsf.ind = w.stat.ind,
  mySolver = "LS",
  em.iter = 500,
  em.eps = 1e-04,
  all_pair = FALSE,
  dvar = NULL,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clme_em_fixed_+3A_y">Y</code></td>
<td>
<p><code class="reqn">N \times 1</code> vector of response data.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_x1">X1</code></td>
<td>
<p><code class="reqn">N \times p_1</code> design matrix.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_x2">X2</code></td>
<td>
<p>optional <code class="reqn">N \times p_2</code> matrix of covariates.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_u">U</code></td>
<td>
<p>optional <code class="reqn">N \times c</code> matrix of random effects.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_nks">Nks</code></td>
<td>
<p>optional <code class="reqn">K \times 1</code> vector of group sizes.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_qs">Qs</code></td>
<td>
<p>optional <code class="reqn">Q \times 1</code> vector of group sizes for random effects.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_constraints">constraints</code></td>
<td>
<p>list containing the constraints. See Details.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_mq.phi">mq.phi</code></td>
<td>
<p>optional MINQUE estimates of variance parameters.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_tsf">tsf</code></td>
<td>
<p>function to calculate the test statistic.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_tsf.ind">tsf.ind</code></td>
<td>
<p>function to calculate the test statistic for individual constrats. See Details for further information.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_mysolver">mySolver</code></td>
<td>
<p>solver to use in isotonization (passed to <code>activeSet</code>).</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_em.iter">em.iter</code></td>
<td>
<p>maximum number of iterations permitted for the EM algorithm.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_em.eps">em.eps</code></td>
<td>
<p>criterion for convergence for the EM algorithm.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_all_pair">all_pair</code></td>
<td>
<p>logical, whether all pairwise comparisons should be considered (constraints will be ignored).</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_dvar">dvar</code></td>
<td>
<p>fixed values to replace bootstrap variance of 0.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, function prints messages on progress of the EM algorithm.</p>
</td></tr>
<tr><td><code id="clme_em_fixed_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>constraints</code> is a list including at least the elements <code>A</code>, <code>B</code>, and <code>Anull</code>. This argument can be generated by function <code><a href="#topic+create.constraints">create.constraints</a></code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the elements:
</p>

<ul>
<li><p><code>theta</code> coefficient estimates.
</p>
</li>
<li><p><code>theta.null</code> vector of coefficient estimates under the null hypothesis.
</p>
</li>
<li><p><code>ssq</code> estimate of residual variance term(s).
</p>
</li>
<li><p><code>tsq</code> estimate of variance components for any random effects.
</p>
</li>
<li><p><code>cov.theta</code> covariance matrix of the unconstrained coefficients. 
</p>
</li>
<li><p><code>ts.glb</code> test statistic for the global hypothesis.
</p>
</li>
<li><p><code>ts.ind</code> test statistics for each of the constraints.
</p>
</li>
<li><p><code>mySolver</code> the solver used for isotonization.
</p>
</li></ul>



<h3>Note</h3>

<p>There are few error catches in these functions. If only the EM estimates are desired, 
users are recommended to run <code><a href="#topic+clme">clme</a></code> setting <code>nsim=0</code>.
</p>
<p>By default, homogeneous variances are assumed for the residuals and (if included) 
random effects. Heterogeneity can be induced using the arguments <code>Nks</code> and <code>Qs</code>,
which refer to the vectors <code class="reqn"> (n_{1}, n_{2}, \ldots, n_{k}) </code> and
<code class="reqn"> (c_{1}, c_{2}, \ldots, c_{q}) </code>, respectively. See 
<code><a href="#topic+CLME-package">CLME-package</a></code> for further explanation the model and these values.
</p>
<p>See <code><a href="#topic+w.stat">w.stat</a></code> and <code><a href="#topic+lrt.stat">lrt.stat</a></code> for more details on using custom 
test statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
<code><a href="#topic+create.constraints">create.constraints</a></code>
<code><a href="#topic+lrt.stat">lrt.stat</a></code>
<code><a href="#topic+w.stat">w.stat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )

model_mats &lt;- model_terms_clme( mcv ~ time + temp + sex + (1|id), data = rat.blood )

Y  &lt;- model_mats$Y
X1 &lt;- model_mats$X1
X2 &lt;- model_mats$X2
U  &lt;- model_mats$U

cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )

clme.out &lt;- clme_em(Y = Y, X1 = X1, X2 = X2, U = U, constraints = cons)

</code></pre>

<hr>
<h2 id='clme_resids'>Computes various types of residuals</h2><span id='topic+clme_resids'></span>

<h3>Description</h3>

<p>Computes several types of residuals for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clme_resids(formula, data, gfix = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clme_resids_+3A_formula">formula</code></td>
<td>
<p>a formula expression. The constrained effect(s) must come before any unconstrained covariates on the right-hand side of the expression. The first <code>ncon</code> terms will be assumed to be constrained.</p>
</td></tr>
<tr><td><code id="clme_resids_+3A_data">data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="clme_resids_+3A_gfix">gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For fixed-effects models <code class="reqn">Y = X\beta + \epsilon</code>, residuals are given as <code class="reqn">\hat{e} = Y - X\hat{\beta}</code>.
For mixed-effects models <code class="reqn">Y = X\beta + + U\xi + \epsilon</code>, three types of residuals are available.
<code class="reqn">PA = Y - X\hat{\beta}</code>\
<code class="reqn">SS = U\hat{\xi}</code>\
<code class="reqn">FM = Y - X\hat{\beta} - U\hat{\xi}</code>
</p>


<h3>Value</h3>

<p>List containing the elements <code>PA</code>, <code>SS</code>, <code>FM</code>, <code>cov.theta</code>, <code>xi</code>, <code>ssq</code>, <code>tsq</code>.
<code>PA</code>, <code>SS</code>, <code>FM</code> are defined above (for fixed-effects models, the residuals are only <code>PA</code>). Then <code>cov.theta</code> is the unconstrained covariance matrix of the fixed-effects coefficients, <code>xi</code> is the vector of random effect estimates, and <code>ssq</code> and <code>tsq</code> are unconstrained estimates of the variance components.
</p>


<h3>Note</h3>

<p>There are few error catches in these functions. If only the EM estimates are desired, 
users are recommended to run <code><a href="#topic+clme">clme</a></code> setting <code>nsim=0</code>.
</p>
<p>By default, homogeneous variances are assumed for the residuals and (if included) 
random effects. Heterogeneity can be induced using the arguments <code>Nks</code> and <code>Qs</code>,
which refer to the vectors <code class="reqn"> (n_{1}, n_{2}, \ldots, n_{k}) </code> and
<code class="reqn"> (c_{1}, c_{2}, \ldots, c_{q}) </code>, respectively. See 
<code><a href="#topic+CLME-package">CLME-package</a></code> for further explanation the model and these values.
</p>
<p>See <code><a href="#topic+w.stat">w.stat</a></code> and <code><a href="#topic+lrt.stat">lrt.stat</a></code> for more details on using custom 
test statistics.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )

clme.out &lt;- clme_resids(mcv ~ time + temp + sex + (1|id), data = rat.blood )

## End(Not run)

</code></pre>

<hr>
<h2 id='confint.clme'>Individual confidence intervals</h2><span id='topic+confint.clme'></span><span id='topic+confint.summary.clme'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for fixed effects parameter estimates in objects of class <code>clme</code>.
</p>
<p>Calculates confidence intervals for fixed effects parameter estimates in objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
confint(object, parm, level = 0.95, ...)

## S3 method for class 'summary.clme'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="confint.clme_+3A_parm">parm</code></td>
<td>
<p>parameter for which confidence intervals are computed (not used).</p>
</td></tr>
<tr><td><code id="confint.clme_+3A_level">level</code></td>
<td>
<p>nominal confidence level.</p>
</td></tr>
<tr><td><code id="confint.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are computed using Standard Normal critical values. 
Standard errors are taken from the covariance matrix of the unconstrained parameter estimates.
</p>


<h3>Value</h3>

<p>Returns a matrix with two columns named lcl and ucl (lower and upper confidence limit).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

confint( clme.out )


</code></pre>

<hr>
<h2 id='create.constraints'>Generate common order constraints</h2><span id='topic+create.constraints'></span>

<h3>Description</h3>

<p>Automatically generates the constraints in the format used by <code><a href="#topic+clme">clme</a></code>. Allowed orders are simple, simple tree, and umbrella orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.constraints(P1, constraints)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create.constraints_+3A_p1">P1</code></td>
<td>
<p>the length of <code class="reqn">\theta_1</code>, the vector constrained coefficients.</p>
</td></tr>
<tr><td><code id="create.constraints_+3A_constraints">constraints</code></td>
<td>
<p>List with the elements <code>order</code>, <code>node</code>, and <code>decreasing</code>. See Details for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The elements of <code>constraints</code> are:
</p>

<ul>
<li> <p><code>order</code>: string. Currently &ldquo;simple&rdquo;, &ldquo;simple.tree&rdquo; and &ldquo;umbrella&rdquo; are supported.
</p>
</li>
<li> <p><code>node</code>: numeric, the node of the coefficients (unnecessary for simple orders).
</p>
</li>
<li> <p><code>decreasing</code>: logical. For simple orders, is the trend decreasing? For umbrella and simple tree, does the nodal parameter have the greatest value (e.g., the peak, instead of the valley)?
</p>
</li></ul>

<p>See <code><a href="#topic+clme">clme</a></code> for more information and a depiction of these three elements.
</p>


<h3>Value</h3>

<p>The function returns a list containing the elements of input argument <code>constraints</code> as well as
</p>

<ul>
<li> <p><code>A</code> matrix of dimension <code class="reqn">r \times 2</code> containing the order constraints, where r is the number of linear constraints.
</p>
</li>
<li> <p><code>B</code> matrix containing the contrasts necessary for computation of the Williams' type test statistic (may be identical to <code>A</code>).
</p>
</li>
<li> <p><code>Anull</code> matrix similar to <code>A</code> which defines all possible constraints. Used to obtain parameter estimates under the null hypothesis.
</p>
</li>
<li> <p><code>order</code> the input argument for <code>constraints\$order</code>.
</p>
</li>
<li> <p><code>node</code> the input argument for <code>constraints\$node</code>.
</p>
</li>
<li> <p><code>decreasing</code>  the input argument for <code>constraints\$decreasing</code>
</p>
</li></ul>

<p>See <code><a href="#topic+w.stat">w.stat</a></code> for more information on <code>B</code>
</p>


<h3>Note</h3>

<p>The function <code><a href="#topic+clme">clme</a></code> also utilizes the argument <code>constraints</code>. For <code>clme</code>, this argument may either be identical to the argument of this function, or may be the output of <code>create.constraints</code> (that is, a list containing appropriate matrices <code>A</code>, <code>Anull</code>, and if necessary, <code>B</code>).
</p>
<p>An example the the <code>A</code> matrix might be:
</p>

<table>
<tr>
 <td style="text-align: center;">
    [1,] </td><td style="text-align: center;"> [,1] </td><td style="text-align: center;"> [,2] </td>
</tr>
<tr>
 <td style="text-align: center;">
    [2,] </td><td style="text-align: center;"> 1    </td><td style="text-align: center;"> 2    </td>
</tr>
<tr>
 <td style="text-align: center;">
    [3,] </td><td style="text-align: center;"> 2    </td><td style="text-align: center;"> 3    </td>
</tr>
<tr>
 <td style="text-align: center;">
    [4,] </td><td style="text-align: center;"> 4    </td><td style="text-align: center;"> 3    </td>
</tr>
<tr>
 <td style="text-align: center;">
    [5,] </td><td style="text-align: center;"> 5    </td><td style="text-align: center;"> 4    </td>
</tr>
<tr>
 <td style="text-align: center;">
    [6,] </td><td style="text-align: center;"> 6    </td><td style="text-align: center;"> 5    </td>
</tr>
<tr>
 <td style="text-align: center;">
  </td>
</tr>

</table>

<p>This matrix defines what <span class="pkg">CLME</span> describes as a decreasing umbrella order. The first row defines the constraint that <code class="reqn">\theta_1 \leq \theta_2</code>, the second row defined the constraint <code class="reqn">\theta_2 \leq \theta_3</code>, the third row defines <code class="reqn">\theta_4 \leq \theta_3</code>, and so on. The values are indexes, and the left column is the index of the parameter constrained to be smaller.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clme">clme</a></code>,
<code><a href="#topic+w.stat">w.stat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # For simple order, the node does not matter
  create.constraints( P1 = 5, constraints = list( order='simple' , 
                                                  decreasing=FALSE ))
  
  # Compare constraints against decreasing=TRUE
  create.constraints( P1 = 5, constraints=list( order='simple' , 
                                                decreasing=TRUE ))
  
  # Umbrella order
  create.constraints( P1 = 5, constraints=list( order='umbrella' , node=3
                                                , decreasing=FALSE ))

## End(Not run)


</code></pre>

<hr>
<h2 id='fibroid'>Fibroid Growth Study</h2><span id='topic+fibroid'></span>

<h3>Description</h3>

<p>This data set contains a subset of the data from the Fibroid Growth Study.
</p>

<table>
<tr>
 <td style="text-align: right;">
[,1] </td><td style="text-align: left;">  ID  </td><td style="text-align: left;"> ID for subject. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,2] </td><td style="text-align: left;"> fid  </td><td style="text-align: left;"> ID for fibroid (each women could have multiple fibroids). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,3] </td><td style="text-align: left;"> lfgr </td><td style="text-align: left;"> log fibroid growth rate. See details. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,4] </td><td style="text-align: left;"> age  </td><td style="text-align: left;"> age category Younger, Middle, Older. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,5] </td><td style="text-align: left;"> loc  </td><td style="text-align: left;"> location of fibroid, corpus, fundus, or lower segment. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,6] </td><td style="text-align: left;"> bmi  </td><td style="text-align: left;"> body mass index of subject. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,7] </td><td style="text-align: left;"> preg </td><td style="text-align: left;"> parity, whether the subject had delivered a child. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,8] </td><td style="text-align: left;"> race </td><td style="text-align: left;"> race of subject (Black or White only). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,9] </td><td style="text-align: left;"> vol  </td><td style="text-align: left;"> initial volume of fibroid. </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>data(fibroid)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 240 observations on 9 variables.
</p>


<h3>Details</h3>

<p>The response variable <code>lfgr</code> was calculated as the change in log fibroid volume, 
divided by the length of time between measurements. The growth rates were averaged to produce
a single value for each fibroid, which was scaled to represent a 6-month percent change in volume.
</p>


<h3>References</h3>

<p>Peddada, Laughlin, Miner, Guyon, Haneke, Vahdat, Semelka, Kowalik, Armao, Davis, and Baird(2008).
Growth of Uterine Leiomyomata Among Premenopausal Black and White Women.
Proceedings of the National Academy of Sciences of the United States of America, 105(50),
19887-19892. URL <a href="http://www.pnas.org/content/105/50/19887.full.pdf">http://www.pnas.org/content/105/50/19887.full.pdf</a>.
</p>

<hr>
<h2 id='fixef.clme'>Extract fixed effects</h2><span id='topic+fixef.clme'></span><span id='topic+fixef.summary.clme'></span><span id='topic+fixed.effects'></span><span id='topic+fixed.effects.summary.clme'></span><span id='topic+fixed.effects.clme'></span><span id='topic+coefficients.clme'></span><span id='topic+coef.clme'></span><span id='topic+coefficients.summary.clme'></span><span id='topic+coef.summary.clme'></span>

<h3>Description</h3>

<p>Extracts the fixed effects estimates from objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
fixef(object, ...)

## S3 method for class 'summary.clme'
fixef(object, ...)

## S3 method for class 'clme'
fixef(object, ...)

fixed.effects(object, ...)

## S3 method for class 'summary.clme'
fixed.effects(object, ...)

## S3 method for class 'clme'
fixed.effects(object, ...)

## S3 method for class 'clme'
coefficients(object, ...)

## S3 method for class 'clme'
coef(object, ...)

## S3 method for class 'summary.clme'
coefficients(object, ...)

## S3 method for class 'summary.clme'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fixef.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="fixef.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

fixef( clme.out )

</code></pre>

<hr>
<h2 id='formula.clme'>Extract formula</h2><span id='topic+formula.clme'></span>

<h3>Description</h3>

<p>Extracts the formula from objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formula.clme_+3A_x">x</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="formula.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The package <span class="pkg">CLME</span> parametrizes the model with no intercept term. 
If an intercept was included, it will be removed automatically.
</p>


<h3>Value</h3>

<p>Returns a formula object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

formula( clme.out )

</code></pre>

<hr>
<h2 id='is.clme'>Constructor method for objects S3 class clme</h2><span id='topic+is.clme'></span><span id='topic+as.clme'></span>

<h3>Description</h3>

<p>Test if an object is of class <code>clme</code> or coerce an object to be such.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.clme(x)

as.clme(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.clme_+3A_x">x</code></td>
<td>
<p>list with the elements corresponding to the output of <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="is.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of the class <code>clme</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )

cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

is.clme( clme.out )
as.clme( clme.out )
</code></pre>

<hr>
<h2 id='logLik.clme'>Log-likelihood</h2><span id='topic+logLik.clme'></span><span id='topic+logLik.summary.clme'></span>

<h3>Description</h3>

<p>Computes the log-likelihood of the fitted model for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
logLik(object, ...)

## S3 method for class 'summary.clme'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="logLik.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-likelihood is computed using the Normal distribution. The model uses residual bootstrap 
methodology, and Normality is neither required nor assumed. Therefore the log-likelihood may 
not be a useful measure in the context of <span class="pkg">CLME</span>.
</p>


<h3>Value</h3>

<p>Numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+logLik.clme">logLik.clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

logLik( clme.out )

</code></pre>

<hr>
<h2 id='lrt.stat'>Likelihood ratio type statistic (global)</h2><span id='topic+lrt.stat'></span>

<h3>Description</h3>

<p>Calculates the likeihood ratio type test statistic (under Normality assumption) for a 
constrained linear mixed effects model. This is the default test statistic for <span class="pkg">CLME</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrt.stat(theta, theta.null, cov.theta, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrt.stat_+3A_theta">theta</code></td>
<td>
<p>estimated coefficients.</p>
</td></tr>
<tr><td><code id="lrt.stat_+3A_theta.null">theta.null</code></td>
<td>
<p>coefficients estimated under the null hypothesis.</p>
</td></tr>
<tr><td><code id="lrt.stat_+3A_cov.theta">cov.theta</code></td>
<td>
<p>covariance matrix of the (unconstrained) coefficients.</p>
</td></tr>
<tr><td><code id="lrt.stat_+3A_...">...</code></td>
<td>
<p>additional arguments, to enable custom test statistic functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output is a numeric value.
</p>


<h3>Note</h3>

<p>This is an internal function, unlikely to be useful outside of <a href="#topic+CLME-package">CLME-package</a>. To define custom functions, the arguments available are:
</p>
<p><code>theta</code>, <code>theta.null</code>, <code>cov.theta</code>, <code>B</code>, <code>A</code>, <code>Y</code>, <code>X1</code>, <code>X2</code>, <code>U</code>, <code>tsq</code>, <code>ssq</code>, <code>Nks</code>, and <code>Qs</code>.
</p>
<p>Of the additional arguments, <code>B</code> and <code>A</code> are identical to those produced by <code><a href="#topic+create.constraints">create.constraints</a></code>. The rest, <code>Y</code>, <code>X1</code>, <code>X2</code>, <code>U</code>, <code>tsq</code>, , <code>ssq</code>, <code>Nks</code>, and <code>Qs</code>, are equivalent to arguments to <code><a href="#topic+clme_em">clme_em</a></code>.
</p>
<p>Custom functions must produce numeric output. Output may have length greater than 1, which corresponds to testing multiple global hypotheses.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clme_em">clme_em</a></code>,
<code><a href="#topic+w.stat">w.stat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )

clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

# Individually compute lrt statistic
lrt.stat(clme.out$theta, clme.out$theta.null, clme.out$cov.theta )

</code></pre>

<hr>
<h2 id='minque'>MINQUE Algorithm</h2><span id='topic+minque'></span>

<h3>Description</h3>

<p>Algorithm to obtain MINQUE estimates of variance components of a linear mixed effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minque(
  Y,
  X1,
  X2 = NULL,
  U = NULL,
  Nks = dim(X1)[1],
  Qs = dim(U)[2],
  mq.eps = 1e-04,
  mq.iter = 500,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="minque_+3A_y">Y</code></td>
<td>
<p><code class="reqn">N \times 1</code> vector of response data.</p>
</td></tr>
<tr><td><code id="minque_+3A_x1">X1</code></td>
<td>
<p><code class="reqn">N \times p_1</code> design matrix.</p>
</td></tr>
<tr><td><code id="minque_+3A_x2">X2</code></td>
<td>
<p>optional <code class="reqn">N \times p_2</code> matrix of covariates.</p>
</td></tr>
<tr><td><code id="minque_+3A_u">U</code></td>
<td>
<p>optional <code class="reqn">N \times c</code> matrix of random effects.</p>
</td></tr>
<tr><td><code id="minque_+3A_nks">Nks</code></td>
<td>
<p>optional <code class="reqn">K \times 1</code> vector of group sizes.</p>
</td></tr>
<tr><td><code id="minque_+3A_qs">Qs</code></td>
<td>
<p>optional <code class="reqn">Q \times 1</code> vector of group sizes for random effects.</p>
</td></tr>
<tr><td><code id="minque_+3A_mq.eps">mq.eps</code></td>
<td>
<p>criterion for convergence for the MINQUE algorithm.</p>
</td></tr>
<tr><td><code id="minque_+3A_mq.iter">mq.iter</code></td>
<td>
<p>maximum number of iterations permitted for the MINQUE algorithm.</p>
</td></tr>
<tr><td><code id="minque_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, function prints messages on progress of the MINQUE algorithm.</p>
</td></tr>
<tr><td><code id="minque_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the model assumes homogeneity of variances for both the residuals and the random effects
(if included). See the Details in <code><a href="#topic+clme_em">clme_em</a></code> for more information on how to use the 
arguments <code>Nks</code> and <code>Qs</code> to permit heterogeneous variances.
</p>


<h3>Value</h3>

<p>The function returns a vector of the form <code class="reqn">(\tau^{2}_{1}, \tau^{2}_{2}, \ldots, \tau^{2}_{q}, \sigma^{2}_{1},\sigma^{2}_{2},\ldots, \sigma^{2}_{k})'</code>. If there are no random effects, then the output is just <code class="reqn">(\sigma^{2}_{1},\sigma^{2}_{2},\ldots, \sigma^{2}_{k})'</code>.
</p>


<h3>Note</h3>

<p>This function is called by several other function in <span class="pkg">CLME</span> to obtain estimates of the random effect variances. If there are no random effects, they will not call <code>minque</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )

model_mats &lt;- model_terms_clme( mcv ~ time + temp + sex + (1|id) , 
                                data = rat.blood )
Y  &lt;- model_mats$Y
X1 &lt;- model_mats$X1
X2 &lt;- model_mats$X2
U  &lt;- model_mats$U

# No covariates or random effects
minque(Y = Y, X1 = X1 )

# Include covariates and random effects
minque(Y = Y, X1 = X1, X2 = X2, U = U )

</code></pre>

<hr>
<h2 id='model_terms_clme'>Create model matrices for <code>clme</code></h2><span id='topic+model_terms_clme'></span>

<h3>Description</h3>

<p>Parses formulas to creates model matrices for <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_terms_clme(formula, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_terms_clme_+3A_formula">formula</code></td>
<td>
<p>a formula defining a linear fixed or mixed effects model. The constrained effect(s) must come before any unconstrained covariates on the right-hand side of the expression. The first <code>ncon</code> terms will be assumed to be constrained.</p>
</td></tr>
<tr><td><code id="model_terms_clme_+3A_data">data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements:
</p>

<table>
<tr>
 <td style="text-align: right;">
  Y       </td><td style="text-align: left;"> response variable </td>
</tr>
<tr>
 <td style="text-align: right;">
  X1      </td><td style="text-align: left;"> design matrix for constrained effect </td>
</tr>
<tr>
 <td style="text-align: right;">
  X2      </td><td style="text-align: left;"> design matrix for covariates </td>
</tr>
<tr>
 <td style="text-align: right;">
  P1      </td><td style="text-align: left;"> number of constrained coefficients </td>
</tr>
<tr>
 <td style="text-align: right;">
  U       </td><td style="text-align: left;"> matrix of random effects </td>
</tr>
<tr>
 <td style="text-align: right;">
  formula </td><td style="text-align: left;"> the final formula call (automatically removes intercept) </td>
</tr>
<tr>
 <td style="text-align: right;">
  dframe  </td><td style="text-align: left;"> the dataframe containing the variables in the model </td>
</tr>
<tr>
 <td style="text-align: right;">
  REidx   </td><td style="text-align: left;"> an element to define random effect variance components </td>
</tr>
<tr>
 <td style="text-align: right;">
  REnames </td><td style="text-align: left;"> an element to define random effect variance components </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>The first term on the right-hand side of the formula should be the fixed effect 
with constrained coefficients. Random effects are represented with a vertical bar, 
so for example the random effect <code>U</code> would be included by 
<code>Y ~ X1 + (1|U)</code>.
</p>
<p>The intercept is removed automatically. This is done to ensure that parameter 
estimates are of the means of interest, rather than being expressed as a mean 
with offsets.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )
model_terms_clme( mcv ~ time + temp + sex + (1|id) , data = rat.blood )

</code></pre>

<hr>
<h2 id='model.matrix.clme'>Extract the model design matrix.</h2><span id='topic+model.matrix.clme'></span><span id='topic+model.matrix.summary.clme'></span>

<h3>Description</h3>

<p>Extracts the fixed-effects design matrix from objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
model.matrix(object, type = "fixef", ...)

## S3 method for class 'summary.clme'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model.matrix.clme_+3A_object">object</code></td>
<td>
<p>an object of class <code>clme</code>.</p>
</td></tr>
<tr><td><code id="model.matrix.clme_+3A_type">type</code></td>
<td>
<p>specify whether to return the fixed-effects or random-effects matrix.</p>
</td></tr>
<tr><td><code id="model.matrix.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+model.matrix.clme">model.matrix.clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

model.matrix( clme.out )

## End(Not run)
</code></pre>

<hr>
<h2 id='nobs.clme'>Number of observations</h2><span id='topic+nobs.clme'></span><span id='topic+nobs.summary.clme'></span>

<h3>Description</h3>

<p>Obtains the number of observations used to fit an model for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
nobs(object, ...)

## S3 method for class 'summary.clme'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nobs.clme_+3A_object">object</code></td>
<td>
<p>an object of class <code>clme</code>.</p>
</td></tr>
<tr><td><code id="nobs.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>
<p><code><a href="#topic+nobs.clme">nobs.clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

nobs( clme.out )

</code></pre>

<hr>
<h2 id='plot.clme'>S3 method to plot objects of class <code>clme</code></h2><span id='topic+plot.clme'></span>

<h3>Description</h3>

<p>Generates a basic plot of estimated coefficients which are subject to constraints (<code class="reqn">\theta_1</code> ). Lines indicate individual constraints (not global tests) and significance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.clme_+3A_x">x</code></td>
<td>
<p>object of class 'clme' to be plotted.</p>
</td></tr>
<tr><td><code id="plot.clme_+3A_...">...</code></td>
<td>
<p>additional plotting arguments.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>While it is possible to plot the output of a clme fit, this will only plot the fitted means.
To indicate significance, plotting must be performed on the summary of a clme fit. This method
will change the class so that plot.summary.clme will be called properly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
<code><a href="#topic+plot.summary.clme">plot.summary.clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  set.seed( 42 )
  data( rat.blood )
  cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
  clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                   constraints = cons, seed = 42, nsim = 10)
  plot( clme.out )

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.summary.clme'>S3 method to plot objects of class <code>clme</code></h2><span id='topic+plot.summary.clme'></span>

<h3>Description</h3>

<p>Generates a basic plot of estimated coefficients which are subject to constraints (<code class="reqn">\theta_1</code> ). Lines indicate individual constraints (not global tests) and significance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.clme'
plot(
  x,
  alpha = 0.05,
  legendx = "below",
  inset = 0.01,
  ci = FALSE,
  ylim = NULL,
  cex = 1.75,
  pch = 21,
  bg = "white",
  xlab = expression(paste("Component of ", theta[1])),
  ylab = expression(paste("Estimated Value of ", theta[1])),
  tree = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.summary.clme_+3A_x">x</code></td>
<td>
<p>object of class 'clme' to be plotted.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_alpha">alpha</code></td>
<td>
<p>significance level of the test.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_legendx">legendx</code></td>
<td>
<p>character indicating placement of legend. See Details.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_inset">inset</code></td>
<td>
<p>inset distance(s) from the margins as a fraction of the plot region when legend is placed by keyword.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_ci">ci</code></td>
<td>
<p>plot individual confidence intervals.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_ylim">ylim</code></td>
<td>
<p>limits of the y axis.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_cex">cex</code></td>
<td>
<p>size of plotting symbols.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_pch">pch</code></td>
<td>
<p>plotting symbols.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_bg">bg</code></td>
<td>
<p>background (fill) color of the plotting symbols.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_xlab">xlab</code></td>
<td>
<p>label of the x axis.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_ylab">ylab</code></td>
<td>
<p>label of the y axis.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_tree">tree</code></td>
<td>
<p>logical to produce alternate graph for tree ordering.</p>
</td></tr>
<tr><td><code id="plot.summary.clme_+3A_...">...</code></td>
<td>
<p>additional plotting arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the individual contrasts in the <code>constraints\$A</code> matrix are tested and plotted. 
The global test is not represented (unless it happens to coincide with an individual contrast). 
Only the elements of <code class="reqn">\theta</code> which appear in any constraints (e.g. the elements of
<code class="reqn">\theta_{1}</code>) are plotted. Coefficients for the covariates are not plotted.
Solid lines denote no significant difference, while dashed lines denote statistical significance.
Significance is determined by the individual p-value being less than or equal to the supplied 
<code class="reqn">\alpha</code> threshold. By default a legend denoting the meaning of solid and dashed lines
will be placed below the graph. Argument <code>legendx</code> may be set to a legend keyword (e.g. 
<code>legend=''bottomright''</code>) to place it inside the graph at the specified location. Setting
<code>legendx</code> to <code>FALSE</code> or to a non-supported keyword suppresses the legend.
Confidence intervals for the coefficients may be plotted. They are individual confidence intervals,
and are computed using the covariance matrix of the unconstrained estimates of 
<code class="reqn">\theta_{1}</code>. These confidence intervals have higher coverage probability than the 
nominal value, and as such may appear to be in conflict with the significance tests. Alternate
forms of confidence intervals may be provided in future updates.#'
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  set.seed( 42 )
  data( rat.blood )
  cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
  clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                   constraints = cons, seed = 42, nsim = 10)
  clme.out2 &lt;- summary( clme.out )
  plot( clme.out2 )

## End(Not run)


</code></pre>

<hr>
<h2 id='print.clme'>Printout of fitted object.</h2><span id='topic+print.clme'></span>

<h3>Description</h3>

<p>Prints basic information on a fitted object of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.clme_+3A_x">x</code></td>
<td>
<p>an object of class <code>clme</code>.</p>
</td></tr>
<tr><td><code id="print.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Text printed to console.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data( rat.blood )
set.seed( 42 )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 10)

print( clme.out )

## End(Not run)

</code></pre>

<hr>
<h2 id='print.summary.clme'>S3 method to print a summary for objects of class <code>clme</code></h2><span id='topic+print.summary.clme'></span>

<h3>Description</h3>

<p>Summarizes the output of objects of class <code>clme</code>, such as those produced by <code><a href="#topic+clme">clme</a></code>. Prints a tabulated display of global and individual tests, as well as parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.clme'
print(x, alpha = 0.05, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.clme_+3A_x">x</code></td>
<td>
<p>an object of class <code>clme</code>.</p>
</td></tr>
<tr><td><code id="print.summary.clme_+3A_alpha">alpha</code></td>
<td>
<p>level of significance.</p>
</td></tr>
<tr><td><code id="print.summary.clme_+3A_digits">digits</code></td>
<td>
<p>number of decimal digits to print.</p>
</td></tr>
<tr><td><code id="print.summary.clme_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>, just prints results to the console.
</p>


<h3>Note</h3>

<p>The individual tests are performed on the specified order. If no specific order was specified, then the individual tests are performed on the estimated order.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  set.seed( 42 )
  data( rat.blood )
  cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
  clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                   constraints = cons, seed = 42, nsim = 10)
  
  summary( clme.out )

## End(Not run)

</code></pre>

<hr>
<h2 id='print.varcorr_clme'>Printout for variance components</h2><span id='topic+print.varcorr_clme'></span>

<h3>Description</h3>

<p>Prints variance components of an objects of <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'varcorr_clme'
print(object, rdig = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.varcorr_clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="print.varcorr_clme_+3A_rdig">rdig</code></td>
<td>
<p>number of digits to round to.</p>
</td></tr>
<tr><td><code id="print.varcorr_clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Text printed to console.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
                 
print.varcorr_clme( clme.out )

## End(Not run)
</code></pre>

<hr>
<h2 id='random.effects'>Extract random effects</h2><span id='topic+random.effects'></span><span id='topic+random.effects.summary.clme'></span>

<h3>Description</h3>

<p>Extract random effects
</p>
<p>Extract random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>random.effects(object, ...)

## S3 method for class 'summary.clme'
random.effects(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="random.effects_+3A_object">object</code></td>
<td>
<p>object of class clme.</p>
</td></tr>
<tr><td><code id="random.effects_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='ranef.clme'>Extract random effects</h2><span id='topic+ranef.clme'></span><span id='topic+ranef.summary.clme'></span><span id='topic+random.effects.clme'></span>

<h3>Description</h3>

<p>Extracts the random effects estimates from objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
ranef(object, ...)

## S3 method for class 'summary.clme'
ranef(object, ...)

## S3 method for class 'clme'
ranef(object, ...)

## S3 method for class 'clme'
random.effects(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranef.clme_+3A_object">object</code></td>
<td>
<p>object of class clme.</p>
</td></tr>
<tr><td><code id="ranef.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)

ranef( clme.out )


</code></pre>

<hr>
<h2 id='rat.blood'>Experiment on mice</h2><span id='topic+rat.blood'></span>

<h3>Description</h3>

<p>This data set contains the data from an experiment on 24 Sprague-Dawley rats from Cora et al (2012).
</p>

<table>
<tr>
 <td style="text-align: right;">
[,1]  </td><td style="text-align: left;"> id   </td><td style="text-align: left;"> ID for rat (factor). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,2]  </td><td style="text-align: left;"> time </td><td style="text-align: left;"> time period (in order, 0 , 6, 24, 48, 72, 96 hours). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,3]  </td><td style="text-align: left;"> temp </td><td style="text-align: left;"> storage temperature reference (<code>''Ref''</code>) vs. room temperature (<code>''RT''</code>). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,4]  </td><td style="text-align: left;"> sex  </td><td style="text-align: left;"> sex, male (<code>''Male''</code>) vs. female (<code>''Female''</code>). Coded as <code>''Female''=1</code>. </td>
</tr>
<tr>
 <td style="text-align: right;">
[,5]  </td><td style="text-align: left;"> wbc  </td><td style="text-align: left;"> white blood cell count (<code class="reqn">10^3 / \mu L</code>). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,6]  </td><td style="text-align: left;"> rbc  </td><td style="text-align: left;"> red blood cell count )<code class="reqn">10^6 / \mu L</code>). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,7]  </td><td style="text-align: left;"> hgb  </td><td style="text-align: left;"> hemoglobin concentration (g/dl). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,8]  </td><td style="text-align: left;"> hct  </td><td style="text-align: left;"> hematocrit (%). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,9]  </td><td style="text-align: left;"> spun </td><td style="text-align: left;"> (HCT %). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,10] </td><td style="text-align: left;"> mcv  </td><td style="text-align: left;"> MCV, a measurement of erythrocyte volume (fl). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,11] </td><td style="text-align: left;"> mch  </td><td style="text-align: left;"> mean corpuscular hemoglobin (pg). </td>
</tr>
<tr>
 <td style="text-align: right;">     
[,12] </td><td style="text-align: left;"> mchc </td><td style="text-align: left;"> mean corpuscular hemoglobin concentration (g/dl). </td>
</tr>
<tr>
 <td style="text-align: right;">
[,13] </td><td style="text-align: left;"> plts </td><td style="text-align: left;"> platelet count (<code class="reqn">10^3 / \mu L</code>). </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>data(rat.blood)
</code></pre>


<h3>Format</h3>

<p>A data frame containing 241 observations on 13 variables.
</p>


<h3>Details</h3>

<p>The response variable <code>lfgr</code> was calculated as the change in log fibroid volume, 
divided by the length of time between measurements. The growth rates were averaged to produce
a single value for each fibroid, which was scaled to represent a 6-month percent change in volume.
</p>


<h3>References</h3>

<p>Cora M, King D, Betz L, Wilson R, and Travlos G (2012). 
Artifactual changes in Sprauge-Dawley rat hematologic parameters after storage of samples at 3 C and 21 C.
Journal of the American Association for Laboratory Animal Science, 51(5), 616-621. 
URL <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3447451/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3447451/</a>.
</p>

<hr>
<h2 id='resid_boot'>Obtain Residual Bootstrap</h2><span id='topic+resid_boot'></span>

<h3>Description</h3>

<p>Generates bootstrap samples of the data vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_boot(
  formula,
  data,
  gfix = NULL,
  eps = NULL,
  xi = NULL,
  null.resids = TRUE,
  theta = NULL,
  ssq = NULL,
  tsq = NULL,
  cov.theta = NULL,
  seed = NULL,
  nsim = 1000,
  mySolver = "LS",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resid_boot_+3A_formula">formula</code></td>
<td>
<p>a formula expression. The constrained effect(s) must come before any unconstrained covariates on the right-hand side of the expression. The first <code>ncon</code> terms will be assumed to be constrained.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_data">data</code></td>
<td>
<p>data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_gfix">gfix</code></td>
<td>
<p>optional vector of group levels for residual variances. Data should be sorted by this value.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_eps">eps</code></td>
<td>
<p>estimates of residuals.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_xi">xi</code></td>
<td>
<p>estimates of random effects.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_null.resids">null.resids</code></td>
<td>
<p>logical indicating if residuals should be computed under the null hypothesis.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_theta">theta</code></td>
<td>
<p>estimates of fixed effects coefficients. Estimated if not submitted.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_ssq">ssq</code></td>
<td>
<p>estimates of residual variance components. Estimated if not submitted.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_tsq">tsq</code></td>
<td>
<p>estimates of random effects variance components. Estimated if not submitted.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_cov.theta">cov.theta</code></td>
<td>
<p>covariance matrix of fixed effects coefficients. Estimated if not submitted.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_seed">seed</code></td>
<td>
<p>set the seed for the RNG.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_nsim">nsim</code></td>
<td>
<p>number of bootstrap samples to use for significance testing.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_mysolver">mySolver</code></td>
<td>
<p>solver to use, passed to <code>activeSet</code>.</p>
</td></tr>
<tr><td><code id="resid_boot_+3A_...">...</code></td>
<td>
<p>space for additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any of the parameters <code>theta</code>, <code>ssq</code>, <code>tsq</code>, <code>eps</code>, or <code>xi</code> are provided, the function will use those values in generating the bootstrap samples. They will be estimated if not submitted. If<code>null.resids=TRUE</code>, then <code>theta</code> will be projected onto the space of the null hypothesis ( <code class="reqn">H_{0}: \theta_1 = \theta_2 = ... = \theta_{p_1}</code>) regardless of whether it is provided or estimated. To generate bootstraps with a specific <code>theta</code>, set <code>null.residuals=FALSE</code>.
</p>


<h3>Value</h3>

<p>Output is <code class="reqn">N \ times nsim</code> matrix, where each column is a bootstrap sample of the response data <code>Y</code>.
</p>


<h3>Note</h3>

<p>This function is primarily designed to be called by <code><a href="#topic+clme">clme</a></code>. 
</p>
<p>By default, homogeneous variances are assumed for the residuals and (if included) random effects. Heterogeneity can be induced using the arguments <code>Nks</code> and <code>Qs</code>, which refer to the vectors <code class="reqn"> (n_{1}, n_{2}, \ldots, n_{k}) </code> and <code class="reqn"> (c_{1}, c_{2}, \ldots, c_{q}) </code>, respectively. See <code><a href="#topic+clme_em">clme_em</a></code> for further explanation of these values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( rat.blood )
boot_sample &lt;- resid_boot(mcv ~ time + temp + sex + (1|id), nsim = 10, 
                          data = rat.blood, null.resids = TRUE  )

</code></pre>

<hr>
<h2 id='residuals.clme'>Various types of residuals</h2><span id='topic+residuals.clme'></span><span id='topic+residuals.summary.clme'></span>

<h3>Description</h3>

<p>Computes several types of residuals for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
residuals(object, type = "FM", ...)

## S3 method for class 'summary.clme'
residuals(object, type = "FM", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.clme_+3A_type">type</code></td>
<td>
<p>type of residual (for mixed-effects models only).</p>
</td></tr>
<tr><td><code id="residuals.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For fixed-effects models <code class="reqn">Y = X\beta + \epsilon</code>, residuals are given as </p>
<p style="text-align: center;"><code class="reqn">\hat{e} = Y - X\hat{\beta}</code>
</p>
<p>.
For mixed-effects models <code class="reqn">Y = X\beta + + U\xi + \epsilon</code>, three types of residuals are available.
<code class="reqn">PA = Y - X\hat{\beta}</code>\
<code class="reqn">SS = U\hat{\xi}</code>\
<code class="reqn">FM = Y - X\hat{\beta} - U\hat{\xi}</code>
</p>


<h3>Value</h3>

<p>Returns a numeric matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
                 
residuals( clme.out, type='PA' )

## End(Not run)
</code></pre>

<hr>
<h2 id='shiny_clme'>Shiny GUI for CLME</h2><span id='topic+shiny_clme'></span><span id='topic+shinyUI_clme'></span><span id='topic+shinyServer_clme'></span>

<h3>Description</h3>

<p>Opens a graphical user interface to run <span class="pkg">CLME</span>, built from the <span class="pkg">shiny</span> package.
</p>
<p>The UI for the shiny app in CLME
</p>
<p>The server for the shiny app in CLME
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shiny_clme()

shinyUI_clme

shinyServer_clme(input, output)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shiny_clme_+3A_input">input</code></td>
<td>
<p>input from GUI.</p>
</td></tr>
<tr><td><code id="shiny_clme_+3A_output">output</code></td>
<td>
<p>output to GUI.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>shiny.tag.list</code> (inherits from <code>list</code>) of length 3.
</p>


<h3>Details</h3>

<p>Currently the GUI does not allow specification of custom orders for the alternative hypothesis. Future versions may enable this capability.
The data should be a CSV or table-delimited file with the first row being a header. Variables are identified using their column letter or number (e.g., 1 or A). Separate multiple variables with a comma (e.g., 1,2,4 or A,B,D), or select a range of variables with a dash (e.g., 1-4 or A-D). Set to 'None' (default) to indicate no covariates or random effects.
If group levels for the constrained effect are character, they may not be read in the proper order. An extra column may contain the ordered group levels (it may therefore have different length than the rest of the dataset).
</p>


<h3>Note</h3>

<p>This function is primarily designed to call <code><a href="#topic+clme">clme</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  shiny_clme() 

</code></pre>

<hr>
<h2 id='sigma.clme'>Residual variance components</h2><span id='topic+sigma.clme'></span>

<h3>Description</h3>

<p>Extract residual variance components for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
sigma(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigma.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="sigma.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
         
sigma( clme.out )


</code></pre>

<hr>
<h2 id='sigma.summary.clme'>Residual variance components</h2><span id='topic+sigma.summary.clme'></span>

<h3>Description</h3>

<p>Extract residual variance components for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.clme'
sigma(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigma.summary.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="sigma.summary.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
                 
sigma( clme.out )

</code></pre>

<hr>
<h2 id='summary.clme'>Produce summary values for objects of class <code>clme</code></h2><span id='topic+summary.clme'></span>

<h3>Description</h3>

<p>Summarizes the output of objects of class <code>clme</code>, such as those produced by <code><a href="#topic+clme">clme</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
summary(object, nsim = 1000, seed = NULL, verbose = c(FALSE, FALSE), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.clme_+3A_object">object</code></td>
<td>
<p>an object of class <code>clme</code>.</p>
</td></tr>
<tr><td><code id="summary.clme_+3A_nsim">nsim</code></td>
<td>
<p>the number of bootstrap samples to use for inference.</p>
</td></tr>
<tr><td><code id="summary.clme_+3A_seed">seed</code></td>
<td>
<p>the value for the seed of the random number generator.</p>
</td></tr>
<tr><td><code id="summary.clme_+3A_verbose">verbose</code></td>
<td>
<p>vector of logicals. First element will print progress for bootstrap test,
second element is passed to the EM algorithm for every bootstrap sample.</p>
</td></tr>
<tr><td><code id="summary.clme_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output of <code>summary.clme</code> is an object of the class <code>summary.clme</code>. This is a list
containing the input object (of class <code>clme</code>), along with elements:
</p>
<table role = "presentation">
<tr><td><code>p.value</code></td>
<td>
<p> p-value for the global hypothesis</p>
</td></tr>
<tr><td><code>p.value.ind</code></td>
<td>
<p> p-values for each of the constraints</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  set.seed( 42 )
  data( rat.blood )
  cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
  clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                   constraints = cons, seed = 42, nsim = 10)
  
  summary( clme.out )

## End(Not run)


</code></pre>

<hr>
<h2 id='VarCorr'>Variance components</h2><span id='topic+VarCorr'></span><span id='topic+VarCorr.summary.clme'></span><span id='topic+VarCorr.clme'></span>

<h3>Description</h3>

<p>Extracts variance components for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarCorr(x, sigma, rdig)

## S3 method for class 'summary.clme'
VarCorr(x, sigma, rdig)

## S3 method for class 'clme'
VarCorr(x, sigma, rdig)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VarCorr_+3A_x">x</code></td>
<td>
<p>object of class <code><a href="#topic+summary.clme">summary.clme</a></code>.</p>
</td></tr>
<tr><td><code id="VarCorr_+3A_sigma">sigma</code></td>
<td>
<p>(unused at present).</p>
</td></tr>
<tr><td><code id="VarCorr_+3A_rdig">rdig</code></td>
<td>
<p>number of digits to round to (unused at present).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
                 
VarCorr( clme.out )



</code></pre>

<hr>
<h2 id='vcov.clme'>Variance-covariance matrix</h2><span id='topic+vcov.clme'></span><span id='topic+vcov.summary.clme'></span>

<h3>Description</h3>

<p>Extracts variance-covariance matrix for objects of class <code>clme</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clme'
vcov(object, ...)

## S3 method for class 'summary.clme'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.clme_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+clme">clme</a></code>.</p>
</td></tr>
<tr><td><code id="vcov.clme_+3A_...">...</code></td>
<td>
<p>space for additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CLME-package">CLME-package</a></code>
<code><a href="#topic+clme">clme</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data( rat.blood )
cons &lt;- list(order = "simple", decreasing = FALSE, node = 1 )
clme.out &lt;- clme(mcv ~ time + temp + sex + (1|id), data = rat.blood , 
                 constraints = cons, seed = 42, nsim = 0)
                 
vcov( clme.out )

</code></pre>

<hr>
<h2 id='w.stat'>Williams' Type Test Statistic.</h2><span id='topic+w.stat'></span><span id='topic+w.stat.ind'></span>

<h3>Description</h3>

<p>Calculates a Williams' type test statistic for a constrained linear mixed effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w.stat(theta, cov.theta, B, A, ...)

w.stat.ind(theta, cov.theta, B, A, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w.stat_+3A_theta">theta</code></td>
<td>
<p>estimated coefficients.</p>
</td></tr>
<tr><td><code id="w.stat_+3A_cov.theta">cov.theta</code></td>
<td>
<p>covariance matrix of the (unconstrained) coefficients.</p>
</td></tr>
<tr><td><code id="w.stat_+3A_b">B</code></td>
<td>
<p>matrix to obtain the global contrast.</p>
</td></tr>
<tr><td><code id="w.stat_+3A_a">A</code></td>
<td>
<p>matrix of linear constraints.</p>
</td></tr>
<tr><td><code id="w.stat_+3A_...">...</code></td>
<td>
<p>additional arguments, to enable custom test statistic functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+create.constraints">create.constraints</a></code> for an example of <code>A</code>. Argument <code>B</code> is similar, but defines the global contrast for a Williams' type test statistic. This is the largest hypothesized difference in the constrained coefficients. So for an increasing simple order, the test statistic is the difference between the two extreme coefficients, <code class="reqn">\theta_1</code> and <code class="reqn">\theta_{p_1}</code>, divided by the standard error (unconstrained). For an umbrella order order, two contrasts are considered, <code class="reqn">\theta_1</code> to <code class="reqn">\theta_{s}</code>, and <code class="reqn">\theta_{p_1}</code> to <code class="reqn">\theta_{s}</code>, each divided by the appropriate unconstrained standard error. A general way to express this statistic is:
</p>
<p style="text-align: center;"><code class="reqn">W = max \theta_{B[i,2]} - \theta_{B[i,1]} / sqrt( VAR( \theta_{B[i,2]} - \theta_{B[i,1]} ) )</code>
</p>

<p>where the numerator is the difference in the constrained estimates, and the standard error in the denominator is based on the covariance matrix of the unconstrained estimates.
</p>
<p>The function <code>w.stat.ind</code> does the same, but uses the <code>A</code> matrix which defines all of the individual constraints, and returns a test statistic for each constraints instead of taking the maximum.
</p>


<h3>Value</h3>

<p>Output is a numeric value.
</p>


<h3>Note</h3>

<p>See <code><a href="#topic+lrt.stat">lrt.stat</a></code> for information on creating custom test statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>theta  &lt;- exp(1:4/4)
th.cov &lt;- diag(4)
X1     &lt;- matrix( 0 , nrow=1 , ncol=4 )
const  &lt;- create.constraints( P1=4 , constraints=list(order='simple' ,
                                                    decreasing=FALSE) )

w.stat( theta , th.cov , const$B , const$A )

w.stat.ind( theta , th.cov , const$B , const$A )

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
