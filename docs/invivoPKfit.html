<!DOCTYPE html><html lang="en"><head><title>Help for package invivoPKfit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {invivoPKfit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#invivoPKfit'><p>invivoPKfit: A package to fit model parameters to in vivo data</p></a></li>
<li><a href='#-.pk'><p>Subtract a pkproto object from a pk object</p></a></li>
<li><a href='#+2B.pk'><p>Add a 'pkproto' object to a 'pk' object</p></a></li>
<li><a href='#AAFE'><p>AAFE()</p></a></li>
<li><a href='#AAFE.default'><p>Default method for AAFE()</p></a></li>
<li><a href='#AAFE.pk'><p>Calculate absolute average fold error (AAFE)</p></a></li>
<li><a href='#add_pk'><p>Add various 'pkproto' objects to a 'pk' object</p></a></li>
<li><a href='#AFE'><p>AFE()</p></a></li>
<li><a href='#AFE.default'><p>Default method for AFE()</p></a></li>
<li><a href='#AFE.pk'><p>Calculate average fold error</p></a></li>
<li><a href='#AIC.pk'><p>Akaike information criterion</p></a></li>
<li><a href='#auc_1comp'><p>Analytic AUC for 1-compartment model</p></a></li>
<li><a href='#auc_1comp_cl'><p>Analytic AUC for 1-compartment model with specific clearance</p></a></li>
<li><a href='#auc_2comp'><p>Analytical AUC for the 2-compartment model</p></a></li>
<li><a href='#auc_flat'><p>AUC for flat model</p></a></li>
<li><a href='#auto_units'><p>Automatically select new time units</p></a></li>
<li><a href='#BIC.pk'><p>Bayesian information criterion</p></a></li>
<li><a href='#calc_hessian'><p>Calculate Hessian</p></a></li>
<li><a href='#calc_nca'><p>Non-compartmental analysis</p></a></li>
<li><a href='#calc_rmse'><p>Calculate RMSE (root mean squared error)</p></a></li>
<li><a href='#calc_rsq'><p>Calculate r-squared for observed vs. predicted values</p></a></li>
<li><a href='#calc_sds_alerts'><p>Calculate parameter SDs</p></a></li>
<li><a href='#check_method'><p>Check methods</p></a></li>
<li><a href='#check_model'><p>Check models</p></a></li>
<li><a href='#check_newdata'><p>Check new data</p></a></li>
<li><a href='#check_params_1comp'><p>Check 1-compartment model parameters</p></a></li>
<li><a href='#check_params_1comp_cl'><p>Check 1-compartment model parameters</p></a></li>
<li><a href='#check_params_2comp'><p>Check 2-compartment model parameters</p></a></li>
<li><a href='#check_params_flat'><p>Check flat model parameters</p></a></li>
<li><a href='#check_required_status'><p>Check required status</p></a></li>
<li><a href='#check_required_status.default'><p>Default method for checking required status</p></a></li>
<li><a href='#check_required_status.pk'><p>Check required status</p></a></li>
<li><a href='#coef_sd'><p>Coefficient standard deviations</p></a></li>
<li><a href='#coef_sd.default'><p>Coefficient standard deviation default</p></a></li>
<li><a href='#coef_sd.pk'><p>Get coefficient standard deviations</p></a></li>
<li><a href='#coef.pk'><p>Get coefficients</p></a></li>
<li><a href='#combined_sd'><p>Combined standard deviation</p></a></li>
<li><a href='#compare_models'><p>Model comparison</p></a></li>
<li><a href='#compare_models.default'><p>Default method for compare_models()</p></a></li>
<li><a href='#compare_models.pk'><p>Model comparison for [pk()] objects</p></a></li>
<li><a href='#conc_scale_use'><p>Get concentration scalings</p></a></li>
<li><a href='#convert_summary_to_log10'><p>Convert sample mean and SD to log10-scale</p></a></li>
<li><a href='#convert_time'><p>Helper function to convert time units</p></a></li>
<li><a href='#cp_1comp'><p>Analytical 1-compartment model</p></a></li>
<li><a href='#cp_1comp_cl'><p>Analytical 1-compartment model with specific clearance</p></a></li>
<li><a href='#cp_2comp'><p>Analytical 2-compartment model</p></a></li>
<li><a href='#cp_2comp_dt'><p>Time derivative of analytical 2-compartment model</p></a></li>
<li><a href='#cp_flat'><p>Flat model</p></a></li>
<li><a href='#cvt'><p>CvTdb data</p></a></li>
<li><a href='#cvt_date'><p>CvTdb download date</p></a></li>
<li><a href='#data_summary'><p>data_summary()</p></a></li>
<li><a href='#data_summary.default'><p>Default method for data_summary()</p></a></li>
<li><a href='#data_summary.pk'><p>Data summary for a 'pk' object</p></a></li>
<li><a href='#dlnorm_summary'><p>Log-normal distribution density function for summary data</p></a></li>
<li><a href='#dnorm_summary'><p>Normal distribution density function for summary data</p></a></li>
<li><a href='#do_data_info'><p>do_data_info generic</p></a></li>
<li><a href='#do_data_info.default'><p>do_data_info default method</p></a></li>
<li><a href='#do_data_info.pk'><p>calculate summary data info</p></a></li>
<li><a href='#do_fit'><p>Fitting</p></a></li>
<li><a href='#do_fit.default'><p>do_fit default method</p></a></li>
<li><a href='#do_fit.pk'><p>Do fitting</p></a></li>
<li><a href='#do_prefit'><p>Prefitting</p></a></li>
<li><a href='#do_prefit.default'><p>do_prefit default method</p></a></li>
<li><a href='#do_prefit.pk'><p>Do pre-fitting</p></a></li>
<li><a href='#do_preprocess'><p>Preprocess data generic</p></a></li>
<li><a href='#do_preprocess.default'><p>do_preprocess default method</p></a></li>
<li><a href='#do_preprocess.pk'><p>Do pre-processing</p></a></li>
<li><a href='#eval_tkstats'><p>eval_tkstats()</p></a></li>
<li><a href='#eval_tkstats.default'><p>Default method for eval_tkstats()</p></a></li>
<li><a href='#eval_tkstats.pk'><p>Evaluate TK statistics</p></a></li>
<li><a href='#facet_data'><p>Facet a PK fit</p></a></li>
<li><a href='#fill_params_1comp'><p>Fill parameters for 1-compartment model</p></a></li>
<li><a href='#fill_params_1comp_cl'><p>Fill parameters for 1-compartment model with specific clearance</p></a></li>
<li><a href='#fill_params_2comp'><p>Fill parameters for 2-compartment model</p></a></li>
<li><a href='#fill_params_flat'><p>Fill parameters for flat model</p></a></li>
<li><a href='#fit_group'><p>Fit a single group of data</p></a></li>
<li><a href='#fold_error'><p>Fold error</p></a></li>
<li><a href='#fold_error.default'><p>fold_error default method</p></a></li>
<li><a href='#fold_error.pk'><p>Fold errors</p></a></li>
<li><a href='#get_data'><p>get_data()</p></a></li>
<li><a href='#get_data_group'><p>get_data_group()</p></a></li>
<li><a href='#get_data_group.default'><p>Default method for get_data_group()</p></a></li>
<li><a href='#get_data_group.pk'><p>Get data grouping</p></a></li>
<li><a href='#get_data_info'><p>get_data_info()</p></a></li>
<li><a href='#get_data_info.default'><p>Default method for get_data_info()</p></a></li>
<li><a href='#get_data_info.pk'><p>Get data_info</p></a></li>
<li><a href='#get_data_original'><p>get_data_original()</p></a></li>
<li><a href='#get_data_original.default'><p>Default method for get_data_original()</p></a></li>
<li><a href='#get_data_original.pk'><p>Get data_original</p></a></li>
<li><a href='#get_data_sigma_group'><p>get_data_sigma_group()</p></a></li>
<li><a href='#get_data_sigma_group.default'><p>Default method for get_data_sigma_group()</p></a></li>
<li><a href='#get_data_sigma_group.pk'><p>Get data_sigma_group</p></a></li>
<li><a href='#get_data_summary'><p>get_data_summary()</p></a></li>
<li><a href='#get_data_summary.default'><p>Default method for get_data_summary()</p></a></li>
<li><a href='#get_data.default'><p>Default method for get_data()</p></a></li>
<li><a href='#get_data.pk'><p>Get data</p></a></li>
<li><a href='#get_elbow'><p>Get an elbow point</p></a></li>
<li><a href='#get_error_group'><p>get_error_group()</p></a></li>
<li><a href='#get_error_group.default'><p>Default method for get_error_group()</p></a></li>
<li><a href='#get_error_group.pk'><p>Get error group</p></a></li>
<li><a href='#get_fit'><p>get_fit()</p></a></li>
<li><a href='#get_fit.default'><p>Default method for get_fit()</p></a></li>
<li><a href='#get_fit.pk'><p>Get fits from a 'pk' object</p></a></li>
<li><a href='#get_hessian'><p>get_hessian()</p></a></li>
<li><a href='#get_hessian.default'><p>Default method for get_hessian()</p></a></li>
<li><a href='#get_hessian.pk'><p>Get Hessian matrixes</p></a></li>
<li><a href='#get_mapping'><p>get_mapping()</p></a></li>
<li><a href='#get_mapping.default'><p>Default method for get_mapping()</p></a></li>
<li><a href='#get_mapping.pk'><p>Get mapping</p></a></li>
<li><a href='#get_nca'><p>get_nca()</p></a></li>
<li><a href='#get_nca.default'><p>Default method for get_nca()</p></a></li>
<li><a href='#get_nca.pk'><p>Get NCA</p></a></li>
<li><a href='#get_params_1comp'><p>Get parameters for 1-compartment model</p></a></li>
<li><a href='#get_params_1comp_cl'><p>Get parameters for 1-compartment model with clearance assumption</p></a></li>
<li><a href='#get_params_1comp_fup'><p>Get parameters for 1-compartment model with clearance assumption</p></a></li>
<li><a href='#get_params_2comp'><p>Get parameters for 2-compartment model</p></a></li>
<li><a href='#get_params_flat'><p>Get parameters to be optimized for flat model</p></a></li>
<li><a href='#get_peak'><p>Find the peak of a data series</p></a></li>
<li><a href='#get_prefit'><p>get_prefit()</p></a></li>
<li><a href='#get_prefit.default'><p>Default method for get_prefit()</p></a></li>
<li><a href='#get_prefit.pk'><p>Get prefit</p></a></li>
<li><a href='#get_scale_conc'><p>get_scale_conc()</p></a></li>
<li><a href='#get_scale_conc.default'><p>Default method for get_scale_conc()</p></a></li>
<li><a href='#get_scale_conc.pk'><p>Get scale_conc</p></a></li>
<li><a href='#get_scale_time'><p>get_scale_time()</p></a></li>
<li><a href='#get_scale_time.default'><p>Default method for get_scale_time()</p></a></li>
<li><a href='#get_scale_time.pk'><p>Get scale_time</p></a></li>
<li><a href='#get_settings_data_info'><p>get_settings_data_info()</p></a></li>
<li><a href='#get_settings_data_info.default'><p>Default method for get_settings_data_info()</p></a></li>
<li><a href='#get_settings_data_info.pk'><p>Get settings_data_info</p></a></li>
<li><a href='#get_settings_optimx'><p>get_settings_optimx()</p></a></li>
<li><a href='#get_settings_optimx.default'><p>Default method for get_settings_optimx()</p></a></li>
<li><a href='#get_settings_optimx.pk'><p>Get settings_optimx</p></a></li>
<li><a href='#get_settings_preprocess'><p>get_settings_preprocess()</p></a></li>
<li><a href='#get_settings_preprocess.default'><p>Default method for get_settings_preprocess()</p></a></li>
<li><a href='#get_settings_preprocess.pk'><p>Get settings_preprocess</p></a></li>
<li><a href='#get_starts_1comp'><p>Get starting values for 1-compartment model</p></a></li>
<li><a href='#get_starts_1comp_cl'><p>Get starting values for 1-compartment model with specific clearance</p></a></li>
<li><a href='#get_starts_1comp_fup'><p>Get starting values for 1-compartment model with specific clearance</p></a></li>
<li><a href='#get_starts_2comp'><p>Get starting values for 2-compartment model</p></a></li>
<li><a href='#get_starts_flat'><p>Get starting values for flat model</p></a></li>
<li><a href='#get_stat_error_model'><p>get_stat_error_model()</p></a></li>
<li><a href='#get_stat_error_model.default'><p>Default method for get_stat_error_model()</p></a></li>
<li><a href='#get_stat_error_model.pk'><p>Get stat_error_model</p></a></li>
<li><a href='#get_stat_model'><p>get_stat_model()</p></a></li>
<li><a href='#get_stat_model.default'><p>Default method for get_stat_model()</p></a></li>
<li><a href='#get_stat_model.pk'><p>Get stat_model</p></a></li>
<li><a href='#get_status'><p>Get status</p></a></li>
<li><a href='#get_status.default'><p>Default method for getting status</p></a></li>
<li><a href='#get_status.pk'><p>Check status of a 'pk' object</p></a></li>
<li><a href='#get_tkstats'><p>Get TK stats</p></a></li>
<li><a href='#get_tkstats.default'><p>Default method for get_tkstats()</p></a></li>
<li><a href='#get_tkstats.pk'><p>Get TK stats</p></a></li>
<li><a href='#get_winning_model'><p>get_winning_model()</p></a></li>
<li><a href='#get_winning_model.default'><p>Default method for get_winning_model()</p></a></li>
<li><a href='#get_winning_model.pk'><p>Get winning model</p></a></li>
<li><a href='#hess_sd1'><p>Inverse diagonal, method 1</p></a></li>
<li><a href='#hess_sd2'><p>Inverse diagonal, method 2</p></a></li>
<li><a href='#ignore_unused_imports'><p>Ignore unused imports</p></a></li>
<li><a href='#is.pk'><p>Check whether an object is of class 'pk'</p></a></li>
<li><a href='#is.pk_faceted'><p>Check whether an object is of class 'pk_faceted'</p></a></li>
<li><a href='#is.pk_scales'><p>Is an object class 'pk_scales'?</p></a></li>
<li><a href='#is.pkproto'><p>Is an object pkproto?</p></a></li>
<li><a href='#log_likelihood'><p>Log-likelihood</p></a></li>
<li><a href='#logLik.pk'><p>Log-likelihood</p></a></li>
<li><a href='#mapping'><p>New mapping</p></a></li>
<li><a href='#midpt_log10'><p>Log10-scaled midpoint</p></a></li>
<li><a href='#model_1comp'><p>1-compartment model</p></a></li>
<li><a href='#model_1comp_cl_nonrest'><p>1-compartment model that assumes non-restrictive clearance</p></a></li>
<li><a href='#model_1comp_cl_rest'><p>1-compartment model that assumes restrictive clearance</p></a></li>
<li><a href='#model_1comp_fup'><p>1-compartment model that assumes restrictive clearance optimizes Fup</p></a></li>
<li><a href='#model_2comp'><p>2-compartment model</p></a></li>
<li><a href='#model_flat'><p>Flat model</p></a></li>
<li><a href='#nca'><p>nca()</p></a></li>
<li><a href='#nca.default'><p>Default method for nca()</p></a></li>
<li><a href='#nca.pk'><p>NCA for a 'pk' object</p></a></li>
<li><a href='#pk'><p>Create a new 'pk' object</p></a></li>
<li><a href='#pk_add'><p>Add a 'pkproto' object to a 'pk' object</p></a></li>
<li><a href='#pk_add.default'><p>Add pkproto object default method</p></a></li>
<li><a href='#pk_add.pk_facet_data'><p>Add facet_data()</p></a></li>
<li><a href='#pk_add.pk_scales'><p>Add a 'pk_scales' object to a 'pk' object.</p></a></li>
<li><a href='#pk_add.pk_settings_data_info'><p>Add a 'pk_settings_data_info' object.</p></a></li>
<li><a href='#pk_add.pk_settings_optimx'><p>Add a 'pk_settings_optimx' object.</p></a></li>
<li><a href='#pk_add.pk_settings_preprocess'><p>Add a 'pk_settings_preprocess' object.</p></a></li>
<li><a href='#pk_add.pk_stat_error_model'><p>Add a 'pk_stat_error_model' object.</p></a></li>
<li><a href='#pk_add.pk_stat_model'><p>Add a 'pk_stat_model' object.</p></a></li>
<li><a href='#pk_add.uneval'><p>Add an 'uneval' object</p></a></li>
<li><a href='#pk_model'><p>Create a new 'pk_model' object</p></a></li>
<li><a href='#pk_subtract'><p>Subtract a 'pkproto' object from a 'pk' object</p></a></li>
<li><a href='#pk_subtract.default'><p>Subtract pkproto object default method</p></a></li>
<li><a href='#pk_subtract.pk_stat_model'><p>Subtract a 'pk_stat_model' object.</p></a></li>
<li><a href='#pkdataset_nheerlcleaned'><p>Toxicokinetic data from the &quot;Concentration vs. Time Database&quot;</p></a></li>
<li><a href='#plot.pk'><p>Plot a [pk()] object.</p></a></li>
<li><a href='#predict.pk'><p>Get predictions</p></a></li>
<li><a href='#print.pk'><p>Print a user-friendly version of a 'pk' object</p></a></li>
<li><a href='#rename2_cvt'><p>Convert invivoPKfit output table names to the CvTdb names</p></a></li>
<li><a href='#residuals.pk'><p>Get residuals</p></a></li>
<li><a href='#rmse'><p>Root mean squared error (RMSE)</p></a></li>
<li><a href='#rmse.default'><p>Root mean squared error (RMSE) default method</p></a></li>
<li><a href='#rmse.pk'><p>Root mean squared error</p></a></li>
<li><a href='#rowwise_calc_percentages'><p>Helper function for calculating percentages of count data, by row</p></a></li>
<li><a href='#rsq'><p>rsq()</p></a></li>
<li><a href='#rsq.default'><p>Default method for rsq()</p></a></li>
<li><a href='#rsq.pk'><p>Calculate R-squared for observed vs. predicted values</p></a></li>
<li><a href='#scale_conc'><p>Scale concentrations</p></a></li>
<li><a href='#scale_time'><p>Scale times</p></a></li>
<li><a href='#settings_data_info'><p>Data info settings</p></a></li>
<li><a href='#settings_optimx'><p>'optimx' optimizer settings</p></a></li>
<li><a href='#settings_preprocess'><p>Data preprocessing settings</p></a></li>
<li><a href='#stat_error_model'><p>Error model</p></a></li>
<li><a href='#stat_model'><p>Add PK model(s) to be fitted</p></a></li>
<li><a href='#status_data_info'><p>Status ID for data summary info</p></a></li>
<li><a href='#status_fit'><p>Status ID for fitting</p></a></li>
<li><a href='#status_init'><p>Status ID for initialization</p></a></li>
<li><a href='#status_prefit'><p>Status ID for pre-fitting</p></a></li>
<li><a href='#status_preprocess'><p>Status ID for preprocessing</p></a></li>
<li><a href='#subtract_pk'><p>Subtract various 'pkproto' objects from a 'pk' object</p></a></li>
<li><a href='#summary.pk'><p>Print summary of a 'pk' object</p></a></li>
<li><a href='#time_conversions'><p>Time conversion table</p></a></li>
<li><a href='#time_units'><p>Allowable time units</p></a></li>
<li><a href='#tkstats_1comp'><p>Toxicokinetic statistics for 1-compartment model</p></a></li>
<li><a href='#tkstats_1comp_cl'><p>Toxicokinetic statistics for 1-compartment model with specific clearance</p></a></li>
<li><a href='#tkstats_2comp'><p>Toxicokinetic statistics for 1-compartment model</p></a></li>
<li><a href='#tkstats_flat'><p>TK stats for flat model</p></a></li>
<li><a href='#transformed_params_2comp'><p>Transformed parameters for 2-compartment model</p></a></li>
<li><a href='#twofold_test'><p>twofold_test()</p></a></li>
<li><a href='#twofold_test.default'><p>Default method for twofold_test()</p></a></li>
<li><a href='#twofold_test.pk'><p>Evaluate whether data and predictions are within two-fold of mean or concentration, respectively</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fits Toxicokinetic Models to In Vivo PK Data Sets</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-23</td>
</tr>
<tr>
<td>Author:</td>
<td>John Wambaugh <a href="https://orcid.org/0000-0002-4024-534X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Caroline Ring <a href="https://orcid.org/0000-0002-0463-1251"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gilberto Padilla Mercado
    <a href="https://orcid.org/0000-0001-5423-1646"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Chris Cook [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Wambaugh &lt;wambaugh.john@epa.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Takes in vivo toxicokinetic concentration-time data and fits
    parameters of 1-compartment and 2-compartment models for each
    chemical. These methods are described in detail in "Informatics for Toxicokinetics" (submitted).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, devtools, dplyr, ggplot2, glue, httk, magrittr, MASS,
Matrix, multidplyr (&ge; 0.1.3), numDeriv, optimx, PK, pracma,
purrr, rlang, scales, tibble, tidyr, tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cowplot, knitr, RColorBrewer, rmarkdown, stringr, testthat
(&ge; 3.0.0), tidyverse</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-08 15:27:26 UTC; GPADILLA</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-09 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='invivoPKfit'>invivoPKfit: A package to fit model parameters to in vivo data</h2><span id='topic+invivoPKfit-package'></span><span id='topic+invivoPKfit'></span>

<h3>Description</h3>

<p>The invivoPKfit package takes in vivo concentration-time data from TNO, RTI,
and NHEERL, and fits parameters of 1-compartment and 2-compartment models
for each chemical.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: John Wambaugh <a href="mailto:wambaugh.john@epa.gov">wambaugh.john@epa.gov</a> (<a href="https://orcid.org/0000-0002-4024-534X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Caroline Ring <a href="mailto:Ring.Caroline@epa.gov">Ring.Caroline@epa.gov</a> (<a href="https://orcid.org/0000-0002-0463-1251">ORCID</a>)
</p>
</li>
<li><p> Gilberto Padilla Mercado (<a href="https://orcid.org/0000-0001-5423-1646">ORCID</a>)
</p>
</li>
<li><p> Chris Cook
</p>
</li></ul>


<hr>
<h2 id='-.pk'>Subtract a pkproto object from a pk object</h2><span id='topic+-.pk'></span>

<h3>Description</h3>

<p>Subtract a pkproto object from a pk object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
e1 - e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="-.pk_+3A_e1">e1</code></td>
<td>
<p>A pk pbject</p>
</td></tr>
<tr><td><code id="-.pk_+3A_e2">e2</code></td>
<td>
<p>A pkproto object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The pk object, modified by adding the pkproto object
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='+2B.pk'>Add a 'pkproto' object to a 'pk' object</h2><span id='topic++2B.pk'></span>

<h3>Description</h3>

<p>Add a 'pkproto' object to a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
e1 + e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2B.pk_+3A_e1">e1</code></td>
<td>
<p>A 'pk' pbject</p>
</td></tr>
<tr><td><code id="+2B2B.pk_+3A_e2">e2</code></td>
<td>
<p>A 'pkproto' object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that 'e1 + e2' is equivalent to
</p>
<p>&ldquo;'
'+'(e1, e2)
&ldquo;'
</p>


<h3>Value</h3>

<p>The 'pk' object, modified by adding the 'pkproto' object
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='AAFE'>AAFE()</h2><span id='topic+AAFE'></span>

<h3>Description</h3>

<p>This is the S3 method generic for AAFE()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AAFE(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AAFE_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="AAFE_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the AAFE of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>See Also</h3>

<p>[AAFE.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='AAFE.default'>Default method for AAFE()</h2><span id='topic+AAFE.default'></span>

<h3>Description</h3>

<p>Default method for AAFE()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
AAFE(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AAFE.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="AAFE.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='AAFE.pk'>Calculate absolute average fold error (AAFE)</h2><span id='topic+AAFE.pk'></span>

<h3>Description</h3>

<p>Calculate aboslute average fold error (AAFE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
AAFE(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  use_scale_conc = FALSE,
  AAFE_group = NULL,
  sub_pLOQ = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AAFE.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions and compute AAFE. If NULL (the default), then AAFE will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route',
'Media', 'Conc', 'Conc_SD', 'N_Subjects', 'Detect', 'pLOQ'.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate AAFE. If NULL (the default), AAFE will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate AAFE. If NULL (the default),
RMSEs will be returned for all of the models in
'obj$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the AAFE excluding any observations
in the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to include all observations, regardless of exclusion status.
Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE', 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'. If 'use_scale_conc = TRUE', then the concentration
scaling/transformations in 'object' will be applied to both predicted and
observed concentrations before the log-likelihood is computed. If
'use_scale_conc = FALSE' (the default for this function), then no
concentration scaling or transformation will be applied before the
log-likelihood is computed. If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_aafe_group">AAFE_group</code></td>
<td>
<p>Default: Chemical, Species. Determines what the data
grouping that is used to calculate absolute average fold error (AAFE). Should be set to lowest number
of variables that still would return unique experimental conditions.
Input in the form of 'ggplot2::vars(Chemical, Species, Route, Media, Dose)'.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>TRUE (default): Substitute all predictions below the LOQ with
the LOQ before computing AAFE. FALSE: do not.</p>
</td></tr>
<tr><td><code id="AAFE.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Absolute average fold error (AAFE) is calculated as
</p>
<p style="text-align: center;"><code class="reqn">
10^{\frac{1}{N}\sum{ \textrm{abs} \left[
log_{10} \left(
 \frac{\textrm{predicted}}{\textrm{observed}}
  \right)
  \right]
  }
  }
</code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the observed value is (temporarily) set equal to the
predicted value, for an effective error of zero.
</p>
<p>If the predicted value is less than the reported LOQ, then the user may
choose whether to (temporarily) set the predicted value equal to LOQ, using
argument 'sub_pLOQ').
</p>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the AAFE of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other fit evaluation metrics: 
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='add_pk'>Add various 'pkproto' objects to a 'pk' object</h2><span id='topic+add_pk'></span>

<h3>Description</h3>

<p>Add various 'pkproto' objects to a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_pk(pk_obj, pkproto_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_pk_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object</p>
</td></tr>
<tr><td><code id="add_pk_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pkproto' object to be added</p>
</td></tr>
<tr><td><code id="add_pk_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pkproto' object to be added</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the addition.
</p>

<hr>
<h2 id='AFE'>AFE()</h2><span id='topic+AFE'></span>

<h3>Description</h3>

<p>This is the S3 method generic for AFE()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AFE(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFE_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="AFE_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the AFE of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>See Also</h3>

<p>[AFE.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='AFE.default'>Default method for AFE()</h2><span id='topic+AFE.default'></span>

<h3>Description</h3>

<p>Default method for AFE()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
AFE(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFE.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="AFE.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='AFE.pk'>Calculate average fold error</h2><span id='topic+AFE.pk'></span>

<h3>Description</h3>

<p>Calculate average fold error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
AFE(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  use_scale_conc = FALSE,
  AFE_group = NULL,
  sub_pLOQ = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AFE.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions and compute AFE. If NULL (the default), then AFE will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route',
'Media', 'Conc', 'Conc_SD', 'N_Subjects', 'Detect', 'pLOQ'.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate AFE. If NULL (the default), AFE will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate AFE. If NULL (the default),
RMSEs will be returned for all of the models in
'obj$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the AFE excluding any observations
in the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to include all observations, regardless of exclusion status.
Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE', 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'. If 'use_scale_conc = TRUE', then the concentration
scaling/transformations in 'object' will be applied to both predicted and
observed concentrations before the log-likelihood is computed. If
'use_scale_conc = FALSE' (the default for this function), then no
concentration scaling or transformation will be applied before the
log-likelihood is computed. If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_afe_group">AFE_group</code></td>
<td>
<p>Default: Chemical, Species. Determines what the data
grouping that is used to calculate average fold error (AFE). Should be set to lowest number
of variables that still would return unique experimental conditions.
Input in the form of 'ggplot2::vars(Chemical, Species, Route, Media, Dose)'.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>TRUE (default): Substitute all predictions below the LOQ with
the LOQ before computing AFE. FALSE: do not.</p>
</td></tr>
<tr><td><code id="AFE.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Average fold error is calculated as
</p>
<p style="text-align: center;"><code class="reqn">
10^{\frac{1}{N}\sum{log_{10} \left( \frac{\textrm{predicted}}{\textrm{observed}} \right)}}
</code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the observed value is (temporarily) set equal to the
predicted value, for an effective error of zero.
</p>
<p>If the predicted value is less than the reported LOQ, then the user may
choose whether to (temporarily) set the predicted value equal to LOQ, using
argument 'sub_pLOQ').
</p>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the AFE of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='AIC.pk'>Akaike information criterion</h2><span id='topic+AIC.pk'></span>

<h3>Description</h3>

<p>Get the Akaike information criterion (AIC) for a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
AIC(
  object,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  drop_obs = TRUE,
  ...,
  k = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.pk_+3A_object">object</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to compute
log-likelihood. If NULL (the default), then log-likelihoods will be
computed for the data in 'object$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose',
'Route','Media', 'Conc', 'Detect', 'N_Subjects'. Before log-likelihood is
calculated, 'Time' will be transformed according to the transformation in
'object$scales$time' and 'Conc' will be transformed according to the
transformation in 'object$scales$conc'.</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
calculate log-likelihood. If NULL (the default), log-likelihoods will be
returned for all of the models in 'object$stat_model'.</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate AICs. If NULL (the default),
log-likelihoods will be returned for all of the models in
'object$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the AIC after removing any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when 'exclude
status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_drop_obs">drop_obs</code></td>
<td>
<p>Logical: 'TRUE' to drop the observations column in the output
of [logLik()].</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_...">...</code></td>
<td>
<p>Additional argument. Not in use.</p>
</td></tr>
<tr><td><code id="AIC.pk_+3A_k">k</code></td>
<td>
<p>Default 2. The 'k' parameter in the log-likelihood formula (see
Details). Must be named if used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The AIC is calculated from the log-likelihood (LL) as follows:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{AIC} = -2\textrm{LL} + k n_{par}</code>
</p>

<p>where <code class="reqn">n_{par}</code> is the number of parameters in the fitted model, and
<code class="reqn">k = 2</code> for the standard AIC.
</p>


<h3>Value</h3>

<p>A data.frame with log-likelihood values and calculated AIC using 'newdata'.
There is one row for each model in &lsquo;obj'&rsquo;s [stat_model()] element and
each [optimx::optimx()] method (specified in [settings_optimx()]).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other log likelihood functions: 
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='auc_1comp'>Analytic AUC for 1-compartment model</h2><span id='topic+auc_1comp'></span>

<h3>Description</h3>

<p>Calculate area under the plasma concentration vs. time curve for the
1-compartment model, using an analytical equation (the integral of the
1-compartment model equation with respect to time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_1comp(params, time, dose, route, medium)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_1comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of model parameter values. See Details for
requirements.</p>
</td></tr>
<tr><td><code id="auc_1comp_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time point when
concentration is measured after the corresponding single bolus dose. Must be
same length as 'dose' and 'iv.dose', or length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as 'time' and 'iv.dose', or
length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: ''oral'&lsquo; or '&rsquo;iv''.  Must be same length as 'time'
and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>kelim</dt><dd><p>Elimination rate, 1/time.</p>
</dd>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, volume/unit BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
<dt>kgutabs</dt><dd><p>Rate of absorption from gut, 1/time.</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/volume). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>


<h3>Value</h3>

<p>A vector of plasma AUC values (concentration*time) corresponding to 'time'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other model AUC functions: 
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>
</p>

<hr>
<h2 id='auc_1comp_cl'>Analytic AUC for 1-compartment model with specific clearance</h2><span id='topic+auc_1comp_cl'></span>

<h3>Description</h3>

<p>Calculate area under the plasma concentration vs. time curve for the
1-compartment model, using an analytical equation (the integral of the
1-compartment model equation with respect to time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_1comp_cl(params, time, dose, route, medium)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_1comp_cl_+3A_params">params</code></td>
<td>
<p>A named numeric vector of model parameter values. See Details for
requirements.</p>
</td></tr>
<tr><td><code id="auc_1comp_cl_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time point when
concentration is measured after the corresponding single bolus dose. Must be
same length as 'dose' and 'iv.dose', or length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_cl_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as 'time' and 'iv.dose', or
length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_cl_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: ''oral'&lsquo; or '&rsquo;iv''.  Must be same length as 'time'
and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="auc_1comp_cl_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>Fup</dt><dd><p>Fraction of compound unbound in plasma. Unitless.</p>
</dd>
<dt>Clint</dt><dd><p>Intrinsic clearance by hepatocytes. Units: 1/hr</p>
</dd>
<dt>Q_totli</dt><dd><p>Total blood flow through the liver. Units: L/h/kg body weight ^ (3/4)</p>
</dd>
<dt>Q_gfr</dt><dd><p>Glomerular filtration rate, how quickly do kidneys filter. Units: L/h/kg body weight ^ (3/4)</p>
</dd>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, volume/unit BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
<dt>kgutabs</dt><dd><p>Rate of absorption from gut, 1/time.</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/volume). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>


<h3>Value</h3>

<p>A vector of plasma AUC values (concentration*time) corresponding to 'time'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other model AUC functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>
</p>

<hr>
<h2 id='auc_2comp'>Analytical AUC for the 2-compartment model</h2><span id='topic+auc_2comp'></span>

<h3>Description</h3>

<p>Calculate area under the plasma concentration vs. time curve for the
1-compartment model, using an analytical equation (the integral of the
1-compartment model equation with respect to time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_2comp(params, time, dose, route, medium = "plasma")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_2comp_+3A_params">params</code></td>
<td>
<p>A named list of parameter values including the following:
</p>

<ul>
<li><p> k12: Rate at which compound moves from central to peripheral
compartment, 1/h.
</p>
</li>
<li><p> k21: Rate at which compound moves from peripheral to central compartment, 1/h.
</p>
</li>
<li><p> kelim: Elimination rate, 1/h.
</p>
</li>
<li><p> V1: Apparent volume of central compartment, L/kg BW. Or see below for &quot;Fgutabs_V1&quot;
</p>
</li></ul>

<p>For oral administration (<code>route</code> FALSE), <code>params</code> must also include:
</p>

<ul>
<li><p> Fgutabs: Oral bioavailability, unitless fraction. Or see below for &quot;Fgutabs_V1&quot;
</p>
</li>
<li><p> kgutabs: Rate of absorption from gut, 1/h.
</p>
</li></ul>

<p>For oral administration, in lieu of &quot;V1&quot; and &quot;Fgutabs&quot;, you may instead
provide &quot;Fgutabs_V1&quot;, the ratio of Fgutabs to V1 (1/L). This is an
alternate parameterization for situations where &quot;Fgutabs&quot; and &quot;V1&quot; are not
identifiable separately (i.e. when oral data are available, but IV data are
not). If &quot;Fgutabs&quot; and &quot;V1&quot; are provided, then &quot;Fgutabs_V1&quot; will not be
used.</p>
</td></tr>
<tr><td><code id="auc_2comp_+3A_time">time</code></td>
<td>
<p>A numeric vector of time values, in hours</p>
</td></tr>
<tr><td><code id="auc_2comp_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses in mg/kg</p>
</td></tr>
<tr><td><code id="auc_2comp_+3A_route">route</code></td>
<td>
<p>A logical vector: TRUE for single IV bolus dose, FALSE for single oral dose</p>
</td></tr>
<tr><td><code id="auc_2comp_+3A_medium">medium</code></td>
<td>
<p>A character string that determines the measured media. Default: &quot;plasma&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of plasma AUC values, evaluated at each time point in <code>time</code>.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 2-compartment model functions: 
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other model AUC functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>
</p>

<hr>
<h2 id='auc_flat'>AUC for flat model</h2><span id='topic+auc_flat'></span>

<h3>Description</h3>

<p>Evaluates the area under the concentration-time curve for a &quot;flat&quot; model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_flat(time, params, dose, route, medium)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_flat_+3A_time">time</code></td>
<td>
<p>A numeric vector of times in hours.</p>
</td></tr>
<tr><td><code id="auc_flat_+3A_params">params</code></td>
<td>
<p>A named list of model parameter values. See Details for requirements.</p>
</td></tr>
<tr><td><code id="auc_flat_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses in mg/kg</p>
</td></tr>
<tr><td><code id="auc_flat_+3A_route">route</code></td>
<td>
<p>A logical vector: TRUE for single IV bolus dose; FALSE for
single oral dose. Not used, but must be present for compatibility with other
model functions.</p>
</td></tr>
<tr><td><code id="auc_flat_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as other arguments, or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, L/kg BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/L). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>


<h3>Value</h3>

<p>A vector of plasma concentration values (mg/L) corresponding to
<code>time</code>.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh, Chris Cook
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other flat model functions: 
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other model AUC functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>
</p>

<hr>
<h2 id='auto_units'>Automatically select new time units</h2><span id='topic+auto_units'></span>

<h3>Description</h3>

<p>Given a vector of time values in original units, this function selects new
time units such that, when time is rescaled to the new units, the midpoint of
the time vector is as close to 10 as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_units(y, from, target = 10, period_units = time_units)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auto_units_+3A_y">y</code></td>
<td>
<p>A numeric vector of time values</p>
</td></tr>
<tr><td><code id="auto_units_+3A_from">from</code></td>
<td>
<p>The original units of 'y'</p>
</td></tr>
<tr><td><code id="auto_units_+3A_target">target</code></td>
<td>
<p>The target value (order of magnitude) for the midpoint of rescaled time values. Default 10.</p>
</td></tr>
<tr><td><code id="auto_units_+3A_period_units">period_units</code></td>
<td>
<p>A list of acceptable/understood time units. See Details. Default 'time_units'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Acceptable/understood time units in 'period_units'
</p>
<p>&ldquo;'
c(&quot;picoseconds&quot;,
&quot;nanoseconds&quot;,
&quot;microseconds&quot;,
&quot;milliseconds&quot;,
&quot;seconds&quot;,
&quot;minutes&quot;,
&quot;hours&quot;,
&quot;days&quot;,
&quot;weeks&quot;,
&quot;months&quot;,
&quot;years&quot;)
&ldquo;'
</p>


<h3>Value</h3>

<p>Character: Automatically-selected new time units, which will be one of 'period_units'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='BIC.pk'>Bayesian information criterion</h2><span id='topic+BIC.pk'></span>

<h3>Description</h3>

<p>Get the Bayesian information criterion (BIC) for a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
BIC(object, newdata = NULL, model = NULL, method = NULL, exclude = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIC.pk_+3A_object">object</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="BIC.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to compute
log-likelihood. If NULL (the default), then BICs will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route','Media', 'Conc',
'Detect', 'N_Subjects'. Before log-likelihood is calculated, 'Time' will be
transformed according to the transformation in 'obj$scales$time' and 'Conc'
will be transformed according to the transformation in 'obj$scales$conc'.</p>
</td></tr>
<tr><td><code id="BIC.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
calculate BIC. If NULL (the default), log-likelihoods will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="BIC.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to calculate BICs. If NULL (the default),
log-likelihoods will be returned for all of the methods in
'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="BIC.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the AIC after removing any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when 'exclude
status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="BIC.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BIC is calculated from the log-likelihood (LL) as follows:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{BIC} = -2\textrm{LL} + \log(n_{obs}) n_{par}</code>
</p>

<p>where <code class="reqn">n_{par}</code> is the number of parameters in the fitted model.
</p>
<p>Note that the BIC is just the AIC with <code class="reqn">k = \log(n_{obs})</code>.
</p>


<h3>Value</h3>

<p>A data.frame with log-likelihood values and calculated BIC using 'newdata'.
There is one row for each model in &lsquo;obj'&rsquo;s [stat_model()] element and
each [optimx::optimx()] method (specified in [settings_optimx()]).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other log likelihood functions: 
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='calc_hessian'>Calculate Hessian</h2><span id='topic+calc_hessian'></span>

<h3>Description</h3>

<p>Calculate Hessian matrix given parameter values and data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_hessian(
  pars_opt,
  pars_const,
  observations,
  modelfun,
  dose_norm,
  log10_trans
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_hessian_+3A_pars_opt">pars_opt</code></td>
<td>
<p>Named numeric: A vector of parameter values for the parameters
that were optimized. For example, you can get this using
[coef.pk()] with 'include_type = &quot;optim&quot;'.</p>
</td></tr>
<tr><td><code id="calc_hessian_+3A_pars_const">pars_const</code></td>
<td>
<p>Named numeric: A vector of parameter values for parameters
that were held constant, not optimized (but are necessary to evaluate the
model). For example, you can get this using [coef.pk()] with 'include_type =
&quot;const&quot;'.</p>
</td></tr>
<tr><td><code id="calc_hessian_+3A_observations">observations</code></td>
<td>
<p>The data used to fit the model. For example, you can get
this using [get_data.pk()].</p>
</td></tr>
<tr><td><code id="calc_hessian_+3A_modelfun">modelfun</code></td>
<td>
<p>The name of the function that evaluates the model (passed to
[log_likelihood()]).</p>
</td></tr>
<tr><td><code id="calc_hessian_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: Whether to dose-normalize concentrations before
evaluating log-likelihood. Passed to [log_likelihood()].</p>
</td></tr>
<tr><td><code id="calc_hessian_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical: Whether to log10-transform concentrations before
evaluating log-likelihood. Passed to [log_likelihood()].</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate the Hessian matrix: the matrix of second derivatives of the
objective function with respect to parameters, evaluated for a single set of
parameter values for a single model and a single data set.
Here, the objective function is the negative
log-likelihood implemented in [log_likelihood()], evaluated jointly across the
data that was used to fit the model.
This is a workhorse function called by [get_hessian.pk()] and, indirectly, by
[coef_sd.pk()]. When the number of optimized parameters is <code class="reqn">n</code>, the
respective Hessian matrix will be <code class="reqn">n \times n</code>.
</p>


<h3>Value</h3>

<p>A square numeric matrix, both dimensions the same as the length of
'pars_opt'. It will have rownames and column names that are the same as the
names of 'pars_opt'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='calc_nca'>Non-compartmental analysis</h2><span id='topic+calc_nca'></span>

<h3>Description</h3>

<p>Do non-compartmental analysis on a single-dose set of concentration vs. time
data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_nca(time, conc, detect, series_id = NULL, dose, route, method = "z", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_nca_+3A_time">time</code></td>
<td>
<p>A numeric vector of time points.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_conc">conc</code></td>
<td>
<p>A numeric vector of concentrations. If detected (above limit of
detection/quantification), contains the measured value; if not detected
(below LOD/LOQ), contains the LOD/LOQ.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_detect">detect</code></td>
<td>
<p>A logical vector: Whether each concentration was detected
(above LOD/LOQ) or not.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_series_id">series_id</code></td>
<td>
<p>Optional: A variable that can be coerced to a factor,
identifying individual time series (e.g., individual replicates &ndash;
individual subjects, or replicate dose groups). Default NULL, in which case
each observation will be assumed to have a different series ID. In other
words, a serial sampling design will be assumed, in which each observation
is from a different subject.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_dose">dose</code></td>
<td>
<p>A numeric scalar: The dose for this data set.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_route">route</code></td>
<td>
<p>A character scalar: The route of administration for this data
set. Currently, only &quot;oral&quot; and &quot;iv&quot; are supported.</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_method">method</code></td>
<td>
<p>As for [PK::nca()]: the method to use for calculation of
confidence intervals. Default ''z'' (this differs from the [PK::nca()]
default).</p>
</td></tr>
<tr><td><code id="calc_nca_+3A_...">...</code></td>
<td>
<p>Other arguments that will be passed to [PK::nca()] (other than
'data', 'design', and 'method': *i.e.*, 'n.tail', 'nsample')</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper around [PK::nca()] to do non-compartmental
analysis, after automatically detecting the study design. It additionally
calls [get_peak()] to calculate the peak concentration and time of peak
concentration.
</p>
<p># Automatic detection of study design
</p>
<p>[PK::nca()] understands three different study designs, and requires the user
to specify which one is being used.
</p>
<p>- 'ssd': Serial sampling design. Each observation is from a different subject.
- 'complete': Every subject was observed at every time point.
- 'batch': Each subject was observed at multiple time points, but not at every time point.
</p>
<p>To automatically detect which study design is applicable, this function first
sorts the data by increasing time. Then, a table of time vs. series ID is
created, with 1 indicating that a measurement exists for the corresponding
time point/series ID combination, and 0 indicating that a measurement does
not exist. If the column sums of this table are all 1, then it is a serial
sampling design, except if there is only one observation per time point, it
is a complete sampling design, and if there are multiple observations for
some time points and only one observation for other time points, it is a
batch design. If the column sums are all equal to the number of rows of the
table, then it is a complete sampling design. Otherwise, it is a batch
sampling design.
</p>
<p># Parameters estimated by NCA
</p>
<p>- 'AUC_infinity': The area under the concentration-time curve, extrapolated out to infinite time. Estimated using the trapezoidal rule, with a tail area correction calculated using the slope of the last 3 data points (by default).
- 'AUC_tlast': The area under the concentration-time curve, calculated at the last observed time point. Estimated using the trapezoidal rule.
- 'AUMC_infinity': The area under the concentration-time first moment curve (the area under the AUC vs. time), extrapolated out to infinite time. Estimated using the trapezoidal rule, with a tail area correction calculated using the slope of the last 3 data points (by default).
- &lsquo;CLtot': The total clearance rate.  Only calculated for 'route == &rsquo;iv'&lsquo;. If 'route == &rsquo;oral'', this is 'NA_real_', and only 'CLtot/Fgutabs' is calculated.
- &lsquo;CLtot/Fgutabs': The total clearance rate, normalized by the oral bioavailability. Only calculated for 'route == &rsquo;oral'&lsquo;. If 'route == &rsquo;iv'', this is 'NA_real_', and only 'CLtot/' is calculated.
- &lsquo;Cmax': The peak concentration. For 'route == &rsquo;iv'&lsquo;, this is expected to be the concentration at the earliest time; for 'route == &rsquo;oral'', it is not. This and 'tmax' are calculated using [get_peak()], not by [PK::nca()].
- &lsquo;halflife': The half-life of elimination.  Only calculated for 'route == &rsquo;iv'&lsquo;. If 'route == &rsquo;oral'', this is 'NA_real_', because half-life estimates are not valid for oral data.
- &lsquo;MRT': The mean residence time. Only calculated for 'route == &rsquo;iv'&lsquo;. If 'route == &rsquo;oral'', this is 'NA_real_', and only 'MTT' is calculated.
- &lsquo;MTT': The mean transit time (the sum of MRT and mean absorption time). Only calculated for 'route == &rsquo;oral'&lsquo;. If 'route == &rsquo;iv'', this is 'NA_real_', and only 'MRT' is calculated.
-&lsquo;tmax': The time of peak concentration. For 'route == &rsquo;iv'&lsquo;, this is expected to be the earliest time; for 'route == &rsquo;oral'', it is not.  This and 'Cmax' are calculated using [get_peak()], not by [PK::nca()].
- &lsquo;Vss': The volume of distribution at steady state ('AUMC_infinity/AUC_infinity^2'). If 'route == &rsquo;oral'', this is 'NA_real_', because 'Vss' estimates are not valid for oral data.
</p>
<p># Output
</p>
<p>The output is a data.frame with 9 rows (one for each NCA parameter) and a
number of variables equal to 'length(method) + 3'.
</p>
<p>The variables are
</p>
<p>- 'design': The automatically-detected design. One of 'ssd', 'complete', or 'batch' (or 'NA_character_' if no analysis could be done).
- 'param_name': The name of each NCA parameter.
- 'param_value': The value of each NCA parameter.
- 'param_sd_[method]': The parameter standard error estimated by the corresponding method.
</p>


<h3>Value</h3>

<p>A 'data.frame' with 9 rows and 'length(method) + 3' variables. See
Details.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='calc_rmse'>Calculate RMSE (root mean squared error)</h2><span id='topic+calc_rmse'></span>

<h3>Description</h3>

<p>Calculate RMSE when observed data may be left-censored (non-detect) or may be
reported in summary form (as sample mean, sample standard deviation, and
sample number of subjects). Additionally, handle the situation when observed
data and predictions need to be log10-transformed before RMSE is calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_rmse(pred, obs, obs_sd, n_subj, detect, log10_trans = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_rmse_+3A_pred">pred</code></td>
<td>
<p>Numeric vector: Model-predicted value corresponding to each
observed value. Even if 'log10_trans 
log-transformed. (If 'log10_trans 
internally to this function before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rmse_+3A_obs">obs</code></td>
<td>
<p>Numeric vector: Observed sample means for each observation if
summary data, or observed values for each observation if non-summary data.
Censored observations should *not* be NA; they should be substituted with
the LOQ. Even if 'log10_trans 
log-transformed. (If 'log10_trans 
log-scale means internally to this function before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rmse_+3A_obs_sd">obs_sd</code></td>
<td>
<p>Numeric vector: Observed sample SDs for each observation, if
summary data. For non-summary data (individual-subject observations), the
corresponding element of 'group_sd' should be set to 0. Even if
'log10_trans 
'log10_trans 
deviations internally to this function before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rmse_+3A_n_subj">n_subj</code></td>
<td>
<p>Numeric vector: Observed sample number of subjects for each
observation. For non-summary data (individual-subject observations),
'n_subj' should be set to 1.</p>
</td></tr>
<tr><td><code id="calc_rmse_+3A_detect">detect</code></td>
<td>
<p>Logical vector: 'TRUE' for each observation that was detected
(above LOQ); 'FALSE' for each observation that was non-detect (below LOQ).</p>
</td></tr>
<tr><td><code id="calc_rmse_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical. FALSE (default) means that RMSE is computed for
natural-scale observations and predictions &ndash; effectively, 'sqrt(mean(
(observed - pred)^2 ))'. TRUE means that observations and predictions will
be log10-transformed before RMSE is calculated (see Details)
&ndash; effectively 'sqrt(mean( ( log(observed) - log(pred) )^2 ))'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RMSE is calculated using the following formula, to properly handle summary
data:
</p>
<p style="text-align: center;"><code class="reqn">
\sqrt{
\frac{1}{N}
 \sum_{i=1}^G \left( (n_i - 1) s_i^2 +
  n_i \bar{y}_i^2 - 2 n_i \bar{y}_i \mu_i + \mu_i^2 \right)
   }
</code>
</p>

<p>In this formula, there are <code class="reqn">G</code> groups. (For CvTdb data, a &quot;group&quot; is a
specific combination of chemical, species, route, medium, dose, and
timepoint.) <code class="reqn">n_i</code> is the number of subjects for group <code class="reqn">i</code>.
<code class="reqn">\bar{y}_i</code> is the sample mean for group <code class="reqn">i</code>. <code class="reqn">s_i</code> is the sample
standard deviation for group <code class="reqn">i</code>.<code class="reqn">\mu_i</code> is the model-predicted value
for group <code class="reqn">i</code>.
</p>
<p><code class="reqn">N</code> is the grand total of subjects:
</p>
<p style="text-align: center;"><code class="reqn">N = \sum_{i=1}^G n_i</code>
</p>

<p>For the non-summary case (<code class="reqn">N</code> single-subject observations, with all
<code class="reqn">n_i = 1</code>, <code class="reqn">s_i = 0</code>, and <code class="reqn">\bar{y}_i = y_i</code>), this formula
reduces to the familiar RMSE formula
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\frac{1}{N} \sum_{i=1}^N (y_i - \mu_i)^2}</code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the observed value is (temporarily) set equal to the
predicted value, for an effective error of zero.
</p>
<p>If the observed value is censored, and the predicted value is greater than
the reported LOQ, the the observed value is set equal to the reported LOQ.
</p>
<p># Log10 transformation
</p>
<p>If 'log10_trans 
log10-transformed before calculating the RMSE. In the case where
observed values are reported in summary format, each sample mean and sample
SD (reported on the natural scale, i.e. the mean and SD of natural-scale
individual observations) are used to produce an estimate of the log10-scale
sample mean and sample SD (i.e., the mean and SD of log10-transformed
individual observations), using [convert_summary_to_log10()].
</p>
<p>The formulas are as follows. Again, <code class="reqn">\bar{y}_i</code> is the sample mean for
group <code class="reqn">i</code>. <code class="reqn">s_i</code> is the sample standard deviation for group <code class="reqn">i</code>.
</p>
<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample mean}_i = \log_{10}
\left(\frac{\bar{y}_i^2}{\sqrt{\bar{y}_i^2 + s_i^2}} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample SD}_i = \sqrt{\log_{10} \left(1 +
\frac{s_i^2}{\bar{y}_i^2} \right)}</code>
</p>



<h3>Value</h3>

<p>A numeric scalar: the root mean squared error (RMSE) for this set of
observations and predictions.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='calc_rsq'>Calculate r-squared for observed vs. predicted values</h2><span id='topic+calc_rsq'></span>

<h3>Description</h3>

<p>Calculate the square of the Pearson correlation coefficient (r) between
observed and model-predicted values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_rsq(pred, obs, obs_sd, n_subj, detect, log10_trans = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_rsq_+3A_pred">pred</code></td>
<td>
<p>Numeric vector: Model-predicted value corresponding to each
observed value. Even if 'log10_trans 
log-transformed.  (If 'log10_trans 
log10-transformed internally to this function before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rsq_+3A_obs">obs</code></td>
<td>
<p>Numeric vector: Observed sample means for summary data, or
observed values for non-summary data. Censored observations should *not* be
NA; they should be substituted with the LOQ. Even if 'log10_trans 
TRUE', these should *not* be log10-transformed. (If 'log10_trans 
they will be transformed to log10-scale means internally to this function
before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rsq_+3A_obs_sd">obs_sd</code></td>
<td>
<p>Numeric vector: Observed sample SDs for summary data. For
non-summary data (individual-subject observations), the corresponding
element of 'obs_sd' should be set to 0. Even if 'log10_trans 
these should *not* be log10-transformed. (If 'log10_trans 
will be transformed to log10-scale standard deviations internally to this
function before calculation.)</p>
</td></tr>
<tr><td><code id="calc_rsq_+3A_n_subj">n_subj</code></td>
<td>
<p>Numeric vector: Observed sample number of subjects for summary
data. For non-summary data (individual-subject observations), 'group_n'
should be set to 1.</p>
</td></tr>
<tr><td><code id="calc_rsq_+3A_detect">detect</code></td>
<td>
<p>Logical: Whether each</p>
</td></tr>
<tr><td><code id="calc_rsq_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical. FALSE (default) means that R-squared is computed for
observations vs. predictions. TRUE means that R-squared is computed for
log10(observations) vs. log10(predictions) (see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate the square of the Pearson correlation coefficient (r) between
observed and model-predicted values, when observed data may be left-censored
(non-detect) or may be reported in summary form (as sample mean, sample
standard deviation, and sample number of subjects). Additionally, handle the
situation when observed data and predictions need to be log-transformed
before RMSE is calculated.
</p>
<p><code class="reqn">r^2</code> is calculated according to the following formula, to properly
handle observations reported in summary format:
</p>
<p style="text-align: center;"><code class="reqn"> r^2 = \left(
\frac{
\sum_{i=1}^G \mu_i n_i \bar{y}_i -
(\bar{\mu} + \bar{y}) \sum_{i=1}^G n_i \mu_i +
(\bar{\mu} \bar{y}) \sum_{i=1}^G n_i
}
{ \sqrt{
\sum_{i=1}^G (n_i - 1) s_i^2 +
\sum_{i=1}^G n_i \bar{y}_i^2 -
2 \bar{y} \sum_{i=1}^G n_i \bar{y}_i +
N + \bar{y}^2
  }
\sqrt{
\sum_{i=1}^G n_i \mu_i^2 -
2 \bar{y} \sum_{i=1}^G n_i \mu_i +
N + \bar{y}^2
}
} \right)^2
</code>
</p>

<p>In this formula, there are <code class="reqn">G</code> groups (reported observations). (For CvTdb
data, a &quot;group&quot; is a specific combination of chemical, species, route,
medium, dose, and timepoint.) <code class="reqn">n_i</code> is the number of subjects for group
<code class="reqn">i</code>. <code class="reqn">\bar{y}_i</code> is the sample mean for group <code class="reqn">i</code>. <code class="reqn">s_i</code> is
the sample standard deviation for group <code class="reqn">i</code>.<code class="reqn">\mu_i</code> is the
model-predicted value for group <code class="reqn">i</code>.
<code class="reqn">\bar{y}</code> is the grand mean of observations:
</p>
<p style="text-align: center;"><code class="reqn"> \bar{y} = \frac{ \sum_{i=1}^G n_i \bar{y}_i }{\sum_{i=1}^G n_i} </code>
</p>

<p><code class="reqn">\bar{\mu}</code> is the grand mean of predictions:
</p>
<p style="text-align: center;"><code class="reqn"> \bar{\mu} = \frac{ \sum_{i=1}^G n_i \mu_i }{\sum_{i=1}^G n_i} </code>
</p>

<p><code class="reqn">N</code> is the grand total of subjects:
</p>
<p style="text-align: center;"><code class="reqn">N = \sum_{i=1}^G n_i</code>
</p>

<p>For the non-summary case (<code class="reqn">N</code> single-subject observations, with all
<code class="reqn">n_i = 1</code>, <code class="reqn">s_i = 0</code>, and <code class="reqn">\bar{y}_i = y_i</code>), this formula
reduces to the familiar formula
</p>
<p style="text-align: center;"><code class="reqn"> r^2 = \left( \frac{\sum_{i=1}^N (y_i - \bar{y}) (\mu_i - \bar{\mu})}
{\sqrt{ \sum_{i=1}^N (y_i - \bar{y})^2 }
\sqrt{ \sum_{i=1}^N (\mu_i - \bar{\mu})^2 }
 } \right)^2
 </code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the observed value is (temporarily) set equal to the
predicted value, for an effective error of zero.
</p>
<p>If the observed value is censored, and the predicted value is greater than
the reported LOQ, the the observed value is (temporarily) set equal to the
reported LOQ, for an effective error of (LOQ - predicted).
</p>
<p># Log-10 transformation
</p>
<p>If 'log10 
log10-transformed before calculating the RMSE. In the case where
observed values are reported in summary format, each sample mean and sample
SD (reported on the natural scale, i.e. the mean and SD of natural-scale
individual observations) are used to produce an estimate of the log10-scale
sample mean and sample SD (i.e., the mean and SD of log10-transformed
individual observations), using [convert_summary_to_log10()].
</p>
<p>The formulas are as follows. Again, <code class="reqn">\bar{y}_i</code> is the sample mean for
group <code class="reqn">i</code>. <code class="reqn">s_i</code> is the sample standard deviation for group <code class="reqn">i</code>.
</p>
<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample mean}_i = \log_{10}
\left(\frac{\bar{y}_i^2}{\sqrt{\bar{y}_i^2 + s_i^2}} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample SD}_i = \sqrt{\log_{10} \left(1 +
\frac{s_i^2}{\bar{y}_i^2} \right)}</code>
</p>



<h3>Value</h3>

<p>A numeric scalar: the R-squared value for observations vs.
predictions.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='calc_sds_alerts'>Calculate parameter SDs</h2><span id='topic+calc_sds_alerts'></span>

<h3>Description</h3>

<p>Calculate parameter SDs using inverse Hessian
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_sds_alerts(
  pars_opt,
  pars_const,
  observations,
  modelfun,
  dose_norm,
  log10_trans
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_sds_alerts_+3A_pars_opt">pars_opt</code></td>
<td>
<p>Named numeric: A vector of parameter values for the
parameters that were optimized. For example, you can get this using
[coef.pk()] with 'include_type = &quot;optim&quot;'.</p>
</td></tr>
<tr><td><code id="calc_sds_alerts_+3A_pars_const">pars_const</code></td>
<td>
<p>Named numeric: A vector of parameter values for parameters
that were held constant, not optimized (but are necessary to evaluate the
model). For example, you can get this using [coef.pk()] with 'include_type
= &quot;const&quot;'.</p>
</td></tr>
<tr><td><code id="calc_sds_alerts_+3A_observations">observations</code></td>
<td>
<p>The data used to fit the model. For example, you can get
this using [get_data.pk()].</p>
</td></tr>
<tr><td><code id="calc_sds_alerts_+3A_modelfun">modelfun</code></td>
<td>
<p>The name of the function that evaluates the model (passed to
[log_likelihood()]).</p>
</td></tr>
<tr><td><code id="calc_sds_alerts_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: Whether to dose-normalize concentrations before
evaluating log-likelihood. Passed to [log_likelihood()].</p>
</td></tr>
<tr><td><code id="calc_sds_alerts_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical: Whether to log10-transform concentrations before
evaluating log-likelihood. Passed to [log_likelihood()].</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate parameter SDs using inverse Hessian approach for a single set of
parameter values for a single model and a single data set.
</p>
<p>This is a workhorse function called by [coef_sd.pk()].
If the length of this vector is <code class="reqn">n</code>, the Hessian matrix will be
<code class="reqn">n \times n</code>.
</p>
<p>The coefficient standard deviations are estimated by computing a numerical
approximation to the model Hessian (the matrix of second derivatives of the
model objective function with respect to each model parameter) and then
attempting to invert it. This procedure yields a variance/covariance matrix
for the model parameters. The square root of the diagonal elements of this
matrix represent the parameter standard deviations.
</p>
<p>A first attempt is made to invert the Hessian using [solve()] (see
[hess_sd1()]). If the Hessian is singular, an attempt is made to calculate a
pseudovariance matrix, following the procedure outlined in Gill &amp; King (2004)
(see [hess_sd2()]). First, the generalized inverse of the Hessian is
calculated using [MASS::ginv()]. Then, a generalized Cholesky decomposition
(to ensure positive-definiteness) is calculated using [Matrix::Cholesky] with
argument 'perm = TRUE'. The generalized inverse is reconstructed from the
generalized Cholesky factorization. The square root of the diagonal elements of this matrix
represent the parameter standard deviations.
</p>
<p>If neither of these procedures is successful, then 'NA_real_' is returned for
all coefficient standard deviations. Record any error messages encountered
during the process, and note which method was used to produce the final
results. This is a workhorse function called by [coef_sd.pk()].
</p>


<h3>Value</h3>

<p>A data.frame with variables 'param_name', 'param_sd', and 'sd_alert',
and as many rows as the length of 'pars_opt'. 'param_name' contains the
names of 'pars_opt'. 'param_sd' contains the parameter standard deviations
calculated using the inverse Hessian. 'sd_alerts' is a character variable
noting any errors encountered while attempting to calculate the parameter
SDs.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>References</h3>

<p>Gill J, King G. (2004) What to Do When Your Hessian is Not
Invertible: Alternatives to Model Respecification in Nonlinear Estimation.
Sociological Methods &amp; Research 33(1):54-87. DOI: 10.1177/0049124103262681
</p>

<hr>
<h2 id='check_method'>Check methods</h2><span id='topic+check_method'></span>

<h3>Description</h3>

<p>Check methods for validity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_method(obj, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_method_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="check_method_+3A_method">method</code></td>
<td>
<p>A user-supplied 'character' vector of method names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helper function to ensure that a list of methods specified by the user matches the methods available in the fitted [pk()] object.
</p>


<h3>Value</h3>

<p>'TRUE' if all 'method 
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_model'>Check models</h2><span id='topic+check_model'></span>

<h3>Description</h3>

<p>Check models for validity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_model(obj, model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_model_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="check_model_+3A_model">model</code></td>
<td>
<p>A user-supplied 'character' vector of model names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helper function to ensure that a list of models specified by the user matches the models available in the fitted [pk()] object.
</p>


<h3>Value</h3>

<p>'TRUE' if all 'model 
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_newdata'>Check new data</h2><span id='topic+check_newdata'></span>

<h3>Description</h3>

<p>Check new data to ensure it has the required variables and classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_newdata(newdata, olddata, req_vars, exclude = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_newdata_+3A_newdata">newdata</code></td>
<td>
<p>A 'data.frame' containing new data</p>
</td></tr>
<tr><td><code id="check_newdata_+3A_olddata">olddata</code></td>
<td>
<p>A 'data.frame' containing existing data. 'newdata' variable
classes will be required to match 'olddata'</p>
</td></tr>
<tr><td><code id="check_newdata_+3A_req_vars">req_vars</code></td>
<td>
<p>A 'character' vector of required variable names that must
appear in 'newdata'</p>
</td></tr>
<tr><td><code id="check_newdata_+3A_exclude">exclude</code></td>
<td>
<p>Logical: Whether a variable '&quot;exclude&quot;' also must be present in 'newdata'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function to check new data to ensure it has the required
variables and that those variables are of the correct classes. This is
useful, for example, when making predictions from a fitted [pk()] model
object on new data.
</p>


<h3>Value</h3>

<p>'TRUE', if required variables are present in 'newdata', and required
variables are of the same class in 'newdata' and 'olddata'. Otherwise, this
function will stop with an error.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_params_1comp'>Check 1-compartment model parameters</h2><span id='topic+check_params_1comp'></span>

<h3>Description</h3>

<p>Check to make sure required parameters are present to evaluate 1-compartment
model for a given route and medium
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_params_1comp(params, route, medium, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_params_1comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameters for the 1-compartment model.</p>
</td></tr>
<tr><td><code id="check_params_1comp_+3A_route">route</code></td>
<td>
<p>A character vector of routes: &quot;iv&quot; and/or &quot;oral&quot;.</p>
</td></tr>
<tr><td><code id="check_params_1comp_+3A_medium">medium</code></td>
<td>
<p>A character vector of tissue media: &quot;plasma&quot; and/or &quot;blood&quot;.</p>
</td></tr>
<tr><td><code id="check_params_1comp_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character: A message. If all required parameters are present for the
given media &amp; routes, the message is &quot;Parameters OK&quot;. If required
parameters for the oral route are missing, the message is &quot;Error: For
1-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.  If required
parameters for the IV route are missing, the message is &quot;Error: For
1-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_params_1comp_cl'>Check 1-compartment model parameters</h2><span id='topic+check_params_1comp_cl'></span>

<h3>Description</h3>

<p>Check to make sure required parameters are present to evaluate 1-compartment
model for a given route and medium
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_params_1comp_cl(params, route, medium, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_params_1comp_cl_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameters for the 1-compartment model.</p>
</td></tr>
<tr><td><code id="check_params_1comp_cl_+3A_route">route</code></td>
<td>
<p>A character vector of routes: &quot;iv&quot; and/or &quot;oral&quot;.</p>
</td></tr>
<tr><td><code id="check_params_1comp_cl_+3A_medium">medium</code></td>
<td>
<p>A character vector of tissue media: &quot;plasma&quot; and/or &quot;blood&quot;.</p>
</td></tr>
<tr><td><code id="check_params_1comp_cl_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character: A message. If all required parameters are present for the
given media &amp; routes, the message is &quot;Parameters OK&quot;. If required
parameters for the oral route are missing, the message is &quot;Error: For
1-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.  If required
parameters for the IV route are missing, the message is &quot;Error: For
1-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_params_2comp'>Check 2-compartment model parameters</h2><span id='topic+check_params_2comp'></span>

<h3>Description</h3>

<p>Check to make sure required parameters are present to evaluate 2-compartment
model for a given route and medium
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_params_2comp(params, route, medium, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_params_2comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameters for the 2-compartment model.</p>
</td></tr>
<tr><td><code id="check_params_2comp_+3A_route">route</code></td>
<td>
<p>A character vector of routes: &quot;iv&quot; and/or &quot;oral&quot;.</p>
</td></tr>
<tr><td><code id="check_params_2comp_+3A_medium">medium</code></td>
<td>
<p>A character vector of tissue media: &quot;plasma&quot; and/or &quot;blood&quot;.</p>
</td></tr>
<tr><td><code id="check_params_2comp_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character: A message. If all required parameters are present for the
given media &amp; routes, the message is &quot;Parameters OK&quot;. If required
parameters for the oral route are missing, the message is &quot;Error: For
2-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.  If required
parameters for the IV route are missing, the message is &quot;Error: For
2-compartment oral model, missing parameters (comma-separated list of
parameter names)&quot;.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_params_flat'>Check flat model parameters</h2><span id='topic+check_params_flat'></span>

<h3>Description</h3>

<p>Check to make sure required parameters are present to evaluate flat
model for a given route and medium
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_params_flat(params, route, medium, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_params_flat_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameters for the flat model.</p>
</td></tr>
<tr><td><code id="check_params_flat_+3A_route">route</code></td>
<td>
<p>A character vector of routes: &quot;iv&quot; and/or &quot;oral&quot;.</p>
</td></tr>
<tr><td><code id="check_params_flat_+3A_medium">medium</code></td>
<td>
<p>A character vector of tissue media: &quot;plasma&quot; and/or &quot;blood&quot;.</p>
</td></tr>
<tr><td><code id="check_params_flat_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character: A message. If all required parameters are present for the
given media &amp; routes, the message is &quot;Parameters OK&quot;. If required
parameters for the oral route are missing, the message is &quot;Error: For
flat oral model, missing parameters (comma-separated list of
parameter names)&quot;.  If required
parameters for the IV route are missing, the message is &quot;Error: For
flat oral model, missing parameters (comma-separated list of
parameter names)&quot;.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='check_required_status'>Check required status</h2><span id='topic+check_required_status'></span>

<h3>Description</h3>

<p>This is the S3 method generic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_required_status(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_required_status_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="check_required_status_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the [pk()] object has the required status or greater, returns
TRUE. If the [pk()] object has less than the required status, returns
FALSE. Returned value has an attribute 'msg', containing an informative
message as a string.
</p>


<h3>See Also</h3>

<p>[check_required_status.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='check_required_status.default'>Default method for checking required status</h2><span id='topic+check_required_status.default'></span>

<h3>Description</h3>

<p>Default method for checking required status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
check_required_status(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_required_status.default_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="check_required_status.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='check_required_status.pk'>Check required status</h2><span id='topic+check_required_status.pk'></span>

<h3>Description</h3>

<p>Check whether a [pk()] object has a particular required status level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
check_required_status(obj, required_status, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_required_status.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="check_required_status.pk_+3A_required_status">required_status</code></td>
<td>
<p>Integer: The required status. 1 = initialized; 2 =
pre-processed; 3 = pre-fitted; 4 = fitted.</p>
</td></tr>
<tr><td><code id="check_required_status.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function to check whether a [pk()] object has the status
required for certain operations. For example, status 4 (fitting complete) is
required for any fit evaluation functions: [predict.pk()], [residuals.pk()],
[coef.pk()], [coef_sd.pk()], [rmse.pk()], [fold_error.pk()]
</p>


<h3>Value</h3>

<p>If the [pk()] object has the required status or greater, returns
TRUE. If the [pk()] object has less than the required status, returns
FALSE. Returned value has an attribute 'msg', containing an informative
message as a string.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='coef_sd'>Coefficient standard deviations</h2><span id='topic+coef_sd'></span>

<h3>Description</h3>

<p>This is the S3 method generic for 'coef_sd'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef_sd(obj, model, method, suppress.messages, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_sd_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="coef_sd_+3A_model">model</code></td>
<td>
<p>The TK model used.</p>
</td></tr>
<tr><td><code id="coef_sd_+3A_method">method</code></td>
<td>
<p>Optimizer method used.</p>
</td></tr>
<tr><td><code id="coef_sd_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Boolean. Whether messages will be printed.</p>
</td></tr>
<tr><td><code id="coef_sd_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The remaining columns include the parameters &amp; hyperparameters as returned
by [coef.pk()], as well as their calculated standard deviations.
</p>


<h3>See Also</h3>

<p>[coef_sd.pk()] for the 'coef_sd' method for class [pk()]
</p>

<hr>
<h2 id='coef_sd.default'>Coefficient standard deviation default</h2><span id='topic+coef_sd.default'></span>

<h3>Description</h3>

<p>Coefficient standard deviation default
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
coef_sd(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_sd.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="coef_sd.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='coef_sd.pk'>Get coefficient standard deviations</h2><span id='topic+coef_sd.pk'></span>

<h3>Description</h3>

<p>Extract coefficient/parameter standard deviations from a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
coef_sd(obj, model = NULL, method = NULL, suppress.messages = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_sd.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk] object</p>
</td></tr>
<tr><td><code id="coef_sd.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models whose
coefficients to return. If NULL (the default), coefficients will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="coef_sd.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
whose coefficients to return. If NULL (the default), coefficients will be
returned for all of the models in 'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="coef_sd.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical. 'TRUE' (the default) to suppress
informative messages. 'FALSE' to see them.</p>
</td></tr>
<tr><td><code id="coef_sd.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use right now.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coefficient standard deviations are estimated by computing a numerical
approximation to the model Hessian (the matrix of second derivatives of the
model objective function with respect to each model parameter) and then
attempting to invert it. This procedure yields a variance/covariance matrix
for the model parameters. The square root of the diagonal elements of this
matrix represent the parameter standard deviations.
</p>
<p>A first attempt is made to invert the Hessian using [solve()] (see
[hess_sd1()]). If the Hessian is singular, an attempt is made to calculate a
pseudovariance matrix, following the procedure outlined in Gill &amp; King (2004)
(see [hess_sd2()]). First, the generalized inverse of the Hessian is calculated using
[MASS::ginv()]. Then, a generalized Cholesky decomposition (to ensure
positive-definiteness) is calculated using [Matrix::Cholesky] with argument
'perm = TRUE'. The generalized inverse is reconstructed from the generalized
Cholesky factorization. The square root of the diagonal elements of this
matrix represent the parameter standard deviations.
</p>
<p>If neither of these procedures is successful, then 'NA_real_' is returned for
all coefficient standard deviations.
</p>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The remaining columns include the parameters &amp; hyperparameters as returned
by [coef.pk()], as well as their calculated standard deviations.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring and Gilberto Padilla Mercado
</p>


<h3>References</h3>

<p>Gill J, King G. (2004) What to Do When Your Hessian is Not
Invertible: Alternatives to Model Respecification in Nonlinear Estimation.
Sociological Methods &amp; Research 33(1):54-87. DOI: 10.1177/0049124103262681
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='coef.pk'>Get coefficients</h2><span id='topic+coef.pk'></span>

<h3>Description</h3>

<p>Extract coefficients from a fitted [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
coef(
  object,
  model = NULL,
  method = NULL,
  drop_sigma = FALSE,
  include_NAs = FALSE,
  include_type = "use",
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.pk_+3A_object">object</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify (as a 'character' vector) one or more of the
fitted models whose coefficients to return. If 'NULL' (the default),
coefficients will be returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify (as a 'character' vector)one or more of the
[optimx::optimx()] methods whose coefficients to return. If 'NULL' (the
default), coefficients will be returned for all of the models in
'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_drop_sigma">drop_sigma</code></td>
<td>
<p>Logical: 'FALSE' by default. Determines whether to include
sigma in the output.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_include_nas">include_NAs</code></td>
<td>
<p>Logical: 'FALSE' by default. Determines whether to include
aborted fits which have NAs as coefficients.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_include_type">include_type</code></td>
<td>
<p>Character: '&quot;use&quot;' (default) will return all parameters
used in evaluating the model, including those that were held constant.
'&quot;optimize&quot;' will return only parameters that were optimized, dropping all
that were held constant. '&quot;constant&quot;' will return *only* parameters that
were held constant (used, but not optimized). ('&quot;optimize&quot;' and
'&quot;constant&quot;' are useful, for example, when evaluating the Hessian of the
log-likelihood function, which requires differentiating between parameters
that were optimized and those that were held constant.) Any value other
than '&quot;use&quot;', '&quot;optim&quot;', or '&quot;const&quot;' will return an error.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: 'NULL' by default to use the setting in
'object$settings_preprocess$suppress.messages'. Determines whether to
display messages.</p>
</td></tr>
<tr><td><code id="coef.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts fitted model parameter values from a fitted [pk()]
object.
</p>


<h3>Value</h3>

<p>A data.frame with a row for each 'data_group' x 'method' x 'model'
combination in a fitted [pk()] object. When 'drop_sigma = TRUE' there is
also a row for each unique standard deviation hyper-parameter defined by
'error_group' in the fitted [pk()] object. There is a column for all
parameter estimates given each model in 'model'. A list-column
'coefs_vector' summarizes all estimated parameters into a named vector.
This named vector is used in functions that call upon the model functions,
such as [predict()].
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='combined_sd'>Combined standard deviation</h2><span id='topic+combined_sd'></span>

<h3>Description</h3>

<p>Given mean, standard deviation, and N for some set of groups, calculate the
combined standard deviation. Note that the groups may not overlap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combined_sd(
  group_mean,
  group_sd,
  group_n,
  unbiased = TRUE,
  na.rm = TRUE,
  log10 = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combined_sd_+3A_group_mean">group_mean</code></td>
<td>
<p>Numeric vector: Observed sample means for summary data, or
observed values for non-summary data. Censored observations should *not* be
NA; they should be substituted with some value at or below the
corresponding LOQ (e.g. LOQ or LOQ/2). Even if 'log10 
should *not* be log10-transformed.</p>
</td></tr>
<tr><td><code id="combined_sd_+3A_group_sd">group_sd</code></td>
<td>
<p>Numeric vector: Observed sample SDs for summary data. For
non-summary data (individual-subject observations), the corresponding
element of 'group_sd' should be set to 0. Even if 'log10 
should *not* be log10-transformed.</p>
</td></tr>
<tr><td><code id="combined_sd_+3A_group_n">group_n</code></td>
<td>
<p>Numeric vector: Observed sample number of subjects for summary
data. For non-summary data (individual-subject observations), 'group_n'
should be set to 1.</p>
</td></tr>
<tr><td><code id="combined_sd_+3A_unbiased">unbiased</code></td>
<td>
<p>Logical. If TRUE (the default), then 'group_sd' is assumed to
be the unbiased estimator of population standard deviation (i.e. calculated
using 'n-1' in the denominator &ndash; the way that 'stats::sd()' calculates
it), and the returned combined SD is also the unbiased estimator of the
combined population SD. If FALSE, then 'group_sd' is assumed to be the
biased estimator (using 'n' in the denominator), and the returned value is
also the biased estimator of the combined population SD.</p>
</td></tr>
<tr><td><code id="combined_sd_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical. If TRUE (default), then any groups where mean, SD, *or*
N were NA will be dropped. If FALSE, they will be retained (and the result
will be NA).</p>
</td></tr>
<tr><td><code id="combined_sd_+3A_log10">log10</code></td>
<td>
<p>Logical. If TRUE, the standard deviations are from log10-transformed values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric: the standard deviation of the combined population (i.e. if
all the groups were concatenated into one large group).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='compare_models'>Model comparison</h2><span id='topic+compare_models'></span>

<h3>Description</h3>

<p>This is the S3 method generic for compare_models()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_models(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_models_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="compare_models_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with variables
- 'model': The name of each model
- 'method': The name of each method
- A variable named for 'criterion' (e.g. if 'criterion = &quot;AIC&quot;' then the result will have a
variable named 'AIC'): The criterion value for each model/method
</p>


<h3>See Also</h3>

<p>[compare_models.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='compare_models.default'>Default method for compare_models()</h2><span id='topic+compare_models.default'></span>

<h3>Description</h3>

<p>Default method for compare_models()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
compare_models(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_models.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="compare_models.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='compare_models.pk'>Model comparison for [pk()] objects</h2><span id='topic+compare_models.pk'></span>

<h3>Description</h3>

<p>Perform model comparison for a fitted [pk()] object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
compare_models(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  criterion = "AIC",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_models.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] model object. Must be fitted, or the function will exit
with an error.</p>
</td></tr>
<tr><td><code id="compare_models.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data for which to
compute the TK stats. Must contain at least variables 'Chemical',
'Species', 'Route', 'Media', 'Dose', and any other variables named in
'tk_grouping'. Default 'NULL', to use the data in 'obj$data'.</p>
</td></tr>
<tr><td><code id="compare_models.pk_+3A_model">model</code></td>
<td>
<p>Character: One or more of the models fitted. Default 'NULL' to
return TK stats for all models.</p>
</td></tr>
<tr><td><code id="compare_models.pk_+3A_method">method</code></td>
<td>
<p>Character: One or more of the [optimx::optimx()] methods used.
Default 'NULL' to return TK stats for all methods.</p>
</td></tr>
<tr><td><code id="compare_models.pk_+3A_criterion">criterion</code></td>
<td>
<p>The name of a criterion function to use for model
comparison. Default &quot;AIC&quot;. Must be the name of a function that (as for
'AIC') accepts arguments 'obj', 'newdata', 'method' and 'model' (may accept
other arguments, specified in '...') and returns output as for 'AIC': a
named list of numeric vectors (named for each of the model names in
'model'), where each vector has elements named for each of the method names
in 'method', containing the criterion value calculated for that model
fitted using that method.</p>
</td></tr>
<tr><td><code id="compare_models.pk_+3A_...">...</code></td>
<td>
<p>Optional: Other arguments to 'criterion' function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models are compared according to the goodness-of-fit criterion named in
&quot;criterion&quot;, and the name of the winning model is returned.
</p>


<h3>Value</h3>

<p>A 'data.frame' with variables
- 'model': The name of each model
- 'method': The name of each method
- A variable named for 'criterion' (e.g. if 'criterion = &quot;AIC&quot;' then the result will have a
variable named 'AIC'): The criterion value for each model/method
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='conc_scale_use'>Get concentration scalings</h2><span id='topic+conc_scale_use'></span>

<h3>Description</h3>

<p>A helper function to get concentration scalings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conc_scale_use(use_scale_conc, obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conc_scale_use_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>The 'use_scale_conc' argument (see Details)</p>
</td></tr>
<tr><td><code id="conc_scale_use_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In methods applied to fitted [pk()] objects that also accept 'newdata'
arguments, the user may specify whether to use the concentration scaling of
the fitted [pk()] object, or use a different concentration scaling. This is
done by specifying an argument 'use_scale_conc', which may be 'TRUE' (to use
the scaling from the fitted object), 'FALSE' (to use no scaling), or may be a
named list with elements 'dose_norm' and 'log10_trans' to specify
scaling/transformation directly. This helper function parses the
'use_scale_conc' argument.
</p>


<h3>Value</h3>

<p>A named list with elements 'dose_norm' and 'log10_trans', both
logical.
</p>

<hr>
<h2 id='convert_summary_to_log10'>Convert sample mean and SD to log10-scale</h2><span id='topic+convert_summary_to_log10'></span>

<h3>Description</h3>

<p>Estimate log10-scale sample mean and standard deviation from natural-scale
sample mean and standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_summary_to_log10(sample_mean, sample_SD)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_summary_to_log10_+3A_sample_mean">sample_mean</code></td>
<td>
<p>Numeric: one or more sample means</p>
</td></tr>
<tr><td><code id="convert_summary_to_log10_+3A_sample_sd">sample_SD</code></td>
<td>
<p>Numeric: one or more sample SDs</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">\bar{y}_i</code> is the natural-scale sample mean for group <code class="reqn">i</code>. <code class="reqn">s_i</code>
is the natural-scale sample standard deviation for group <code class="reqn">i</code>.
</p>
<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample mean}_i = \log_{10}
\left(\frac{\bar{y}_i^2}{\sqrt{\bar{y}_i^2 + s_i^2}} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">
\textrm{log10-scale sample SD}_i =
 \sqrt{
 \log_{10} \left(1 + \frac{s_i^2}{\bar{y}_i^2} \right)
 }
 </code>
</p>



<h3>Value</h3>

<p>A list with two named elements: &quot;log10mean&quot; and &quot;log10SD&quot;, the log10-scale
sample means and log10-scale sample SDs, respectively.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='convert_time'>Helper function to convert time units</h2><span id='topic+convert_time'></span>

<h3>Description</h3>

<p>Convert a vector of times between units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time(x, from = "hours", to = "identity", inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_time_+3A_x">x</code></td>
<td>
<p>Numeric: one or more time values to be converted.</p>
</td></tr>
<tr><td><code id="convert_time_+3A_from">from</code></td>
<td>
<p>Character vector: 'x' is currently in these units. Must be units
understood by 'lubridate::duration()', i.e. '&quot;seconds&quot;', '&quot;hours&quot;',
'&quot;days&quot;', '&quot;weeks&quot;', '&quot;months&quot;', '&quot;years&quot;', '&quot;milliseconds&quot;',
'&quot;microseconds&quot;', '&quot;nanoseconds&quot;', and/or '&quot;picoseconds&quot;'. Default value is
'&quot;hours&quot;'.</p>
</td></tr>
<tr><td><code id="convert_time_+3A_to">to</code></td>
<td>
<p>Character vector: 'x' will be converted to these units. Must be
either '&quot;auto&quot;', '&quot;identity&quot;', or units understood by
'lubridate::duration()', i.e. '&quot;seconds&quot;', '&quot;hours&quot;', '&quot;days&quot;', '&quot;weeks&quot;',
'&quot;months&quot;', '&quot;years&quot;', '&quot;milliseconds&quot;', '&quot;microseconds&quot;', '&quot;nanoseconds&quot;',
and/or '&quot;picoseconds&quot;'. Default value is '&quot;identity&quot;'.  If '&quot;identity&quot;',
then 'x' will be returned unchanged. If '&quot;auto&quot;', then units will be
automatically chosen that make the midpoint of 'x' (or its inverse, if
'inverse = TRUE') as close to an order of magnitude of 10 as possible (see
[auto_units()]).</p>
</td></tr>
<tr><td><code id="convert_time_+3A_inverse">inverse</code></td>
<td>
<p>Logical: TRUE if 'x' is in units of *inverse* time (e.g.
1/hour, 1/day); FALSE if 'x' is in units of time (e.g. hours, days).
Default value is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector the same length as 'x', converted from the units in
'from' to the units in 'to'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='cp_1comp'>Analytical 1-compartment model</h2><span id='topic+cp_1comp'></span>

<h3>Description</h3>

<p>Calculates plasma concentrations vs. time according to the analytical solution
for the 1-compartment model, for single bolus doses (IV and/or oral).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_1comp(params, time, dose, route, medium = "plasma")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp_1comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of model parameter values. See Details for
requirements.</p>
</td></tr>
<tr><td><code id="cp_1comp_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time point when
concentration is measured after the corresponding single bolus dose. Must be
same length as 'dose' and 'route', or length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as 'time' and 'route', or
length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: ''oral'&lsquo; or '&rsquo;iv''.  Must be same length as 'time'
and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>kelim</dt><dd><p>Elimination rate, 1/time.</p>
</dd>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, volume/unit BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
<dt>kgutabs</dt><dd><p>Rate of absorption from gut, 1/time.</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/volume). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>


<h3>Value</h3>

<p>A vector of blood or plasma concentration values  corresponding
to 'time'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other model concentration functions: 
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>
</p>

<hr>
<h2 id='cp_1comp_cl'>Analytical 1-compartment model with specific clearance</h2><span id='topic+cp_1comp_cl'></span>

<h3>Description</h3>

<p>Calculates plasma concentrations vs. time according to the analytical solution
for the 1-compartment model, for single bolus doses (IV and/or oral).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_1comp_cl(params, time, dose, route, medium = "plasma", restrictive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp_1comp_cl_+3A_params">params</code></td>
<td>
<p>A named numeric vector of model parameter values. See Details for
requirements.</p>
</td></tr>
<tr><td><code id="cp_1comp_cl_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time point when
concentration is measured after the corresponding single bolus dose. Must be
same length as 'dose' and 'iv.dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_cl_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as 'time' and 'iv.dose', or
length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_cl_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: ''oral'&lsquo; or '&rsquo;iv''.  Must be same length as 'time'
and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_cl_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_1comp_cl_+3A_restrictive">restrictive</code></td>
<td>
<p>A logical value (TRUE or FALSE. Default: FALSE) that says whether the
assumption is that the clearance is restrictive or non-restrictive</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>Fup</dt><dd><p>Fraction of compound unbound in plasma. Unitless.</p>
</dd>
<dt>Clint</dt><dd><p>Intrinsic clearance by hepatocytes. Units: 1/hr</p>
</dd>
<dt>Q_totli</dt><dd><p>Total blood flow through the liver. Units: L/h/kg body weight ^ (3/4)</p>
</dd>
<dt>Q_gfr</dt><dd><p>Glomerular filtration rate, how quickly do kidneys filter. Units: L/h/kg body weight ^ (3/4)</p>
</dd>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, volume/unit BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
<dt>kgutabs</dt><dd><p>Rate of absorption from gut, 1/time.</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/volume). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>


<h3>Value</h3>

<p>A vector of blood or plasma concentration values  corresponding
to 'time'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other model concentration functions: 
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>
</p>

<hr>
<h2 id='cp_2comp'>Analytical 2-compartment model</h2><span id='topic+cp_2comp'></span>

<h3>Description</h3>

<p>Calculates plasma concentration according to the analytical solution for the
2-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_2comp(params, time, dose, route, medium = "plasma")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp_2comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameter values. See Details for requirements.</p>
</td></tr>
<tr><td><code id="cp_2comp_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time points
when concentration is measured after the corresponding single bolus dose.
Must be same length as other arguments, or length 1.</p>
</td></tr>
<tr><td><code id="cp_2comp_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as other arguments, or
length 1.</p>
</td></tr>
<tr><td><code id="cp_2comp_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: <code>'oral'</code> or <code>'iv'</code>.  Must be same length as <code>time</code>
and <code>dose</code>, or length 1.</p>
</td></tr>
<tr><td><code id="cp_2comp_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as other arguments, or length 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of blood or plasma concentration values (mass chemical/volume media) corresponding to each
value in <code>time</code>
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other model concentration functions: 
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>
</p>

<hr>
<h2 id='cp_2comp_dt'>Time derivative of analytical 2-compartment model</h2><span id='topic+cp_2comp_dt'></span>

<h3>Description</h3>

<p>Calculates the time derivative (instantaneous rate of change) of plasma
concentration according to the analytical solution for the 2-compartment
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_2comp_dt(params, time, dose, route, medium)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp_2comp_dt_+3A_params">params</code></td>
<td>
<p>A named list of parameter values including the following:
</p>

<dl>
<dt>k12</dt><dd><p>Rate at which compound moves from central to peripheral
compartment, 1/h.</p>
</dd>
<dt>k21</dt><dd><p>Rate at which compound moves from peripheral to central
compartment, 1/h.</p>
</dd>
<dt>kelim</dt><dd><p>Elimination rate, 1/h.</p>
</dd>
<dt>V1</dt><dd><p>Apparent volume of central compartment, L/kg BW. Or see below for
&quot;Fgutabs_V1&quot;</p>
</dd>
</dl>

<p>For oral administration ('route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
&quot;Fgutabs_V1&quot;</p>
</dd>
<dt>kgutabs</dt><dd><p>Rate of absorption from gut, 1/h.</p>
</dd>
</dl>

<p>For oral administration, in lieu of &quot;V1&quot; and &quot;Fgutabs&quot;, you may instead
provide &quot;Fgutabs_V1&quot;, the ratio of Fgutabs to V1 (1/L). This is an alternate
parameterization for situations where &quot;Fgutabs&quot; and &quot;V1&quot; are not
identifiable separately (i.e. when oral data are available, but IV data are
not). If &quot;Fgutabs&quot; and &quot;V1&quot; are provided, then &quot;Fgutabs_V1&quot; will not be
used.</p>
</td></tr>
<tr><td><code id="cp_2comp_dt_+3A_time">time</code></td>
<td>
<p>A numeric vector of times in hours, reflecting the time points
when concentration is measured after the corresponding single bolus dose.
Must be same length as 'dose' and 'route', or length 1.</p>
</td></tr>
<tr><td><code id="cp_2comp_dt_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses in mg/kg, reflecting single bolus doses
administered at time 0. Must be same length as 'time' and 'route', or length
1.</p>
</td></tr>
<tr><td><code id="cp_2comp_dt_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose. Currently, only &quot;iv&quot; and &quot;oral&quot; are supported. Must
be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_2comp_dt_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as 'time' and 'dose', or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used by [postprocess_data()] to determine the time of peak
concentration for the 2-compartment model, by locating the point where the
time derivative of concentration crosses zero.
</p>


<h3>Value</h3>

<p>A vector of instantaneous rates of change of plasma concentration
values (mg/L/time) corresponding to each value in <code>time</code>
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='cp_flat'>Flat model</h2><span id='topic+cp_flat'></span>

<h3>Description</h3>

<p>Evaluates a &quot;flat&quot; model for concentration vs. time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp_flat(params, time, dose, route, medium = "plasma")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp_flat_+3A_params">params</code></td>
<td>
<p>A named list of parameter values. See Details for requirements.</p>
</td></tr>
<tr><td><code id="cp_flat_+3A_time">time</code></td>
<td>
<p>A numeric vector of times, reflecting the time points
when concentration is measured after the corresponding single bolus dose.
Must be same length as other arguments, or length 1.</p>
</td></tr>
<tr><td><code id="cp_flat_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses, reflecting single bolus doses
administered at time 0. Must be same length as other arguments, or
length 1.</p>
</td></tr>
<tr><td><code id="cp_flat_+3A_route">route</code></td>
<td>
<p>A character vector, reflecting the route of administration of
each single bolus dose: ''oral'&lsquo; or '&rsquo;iv''.  Must be same length as 'time'
and 'dose', or length 1.</p>
</td></tr>
<tr><td><code id="cp_flat_+3A_medium">medium</code></td>
<td>
<p>A character vector reflecting the medium in which each resulting
concentration is to be calculated: &quot;blood&quot; or &quot;plasma&quot;. Default is &quot;plasma&quot;.
Must be same length as other arguments, or length 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used for model comparison: does a 1- or 2-compartment TK
model fit the data any better than this naive &quot;flat&quot; model?
</p>
<p># Required parameters
</p>
<p>'params' must include the following named items:
</p>

<dl>
<dt>Vdist</dt><dd><p>Apparent volume of central compartment, volume/unit BW. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration (if any 'route 
include:
</p>

<dl>
<dt>Fgutabs</dt><dd><p>Oral bioavailability, unitless fraction. Or see below for
'Fgutabs_Vdist'</p>
</dd>
</dl>

<p>For oral administration, in lieu of 'Vdist' and 'Fgutabs', you may instead
provide 'Fgutabs_Vdist', the ratio of Fgutabs to Vdist (1/volume). This is an
alternate parameterization for situations where 'Fgutabs' and 'Vdist' are not
identifiable separately (i.e., when oral TK data are available, but IV data
are not). If 'Fgutabs' and 'Vdist' are provided, they will override any value
provided for 'Fgutabs_Vdist'.
</p>
<p>If both oral and IV administration are specified (i.e., some 'route 
and some 'route 
'Fgutabs' or 'Fgutabs_Vdist'. (If 'Vdist' and 'Fgutabs_Vdist' are provided,
but 'Fgutabs' is not provided, then 'Fgutabs' will be calculated from 'Vdist'
and 'Fgutabs_Vdist'.)
</p>
<p>If 'any(medium 
'Rblood2plasma', the ratio of chemical concentration in whole blood to the
chemical concentration in blood plasma.
</p>
<p># Flat model equations
</p>
<p>## IV administration
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Conc} = \frac{\textrm{Dose}}{V_{\textrm{dist}}}</code>
</p>

<p>## Oral administration
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Conc} = \frac{F_{\textrm{gutabs}} \textrm{Dose}}{V_{\textrm{dist}}}</code>
</p>



<h3>Value</h3>

<p>A vector of plasma concentration values (mass chemical/volume) corresponding to
<code>time</code>.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, John Wambaugh, Chris Cook
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other flat model functions: 
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other model concentration functions: 
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>
</p>

<hr>
<h2 id='cvt'>CvTdb data</h2><span id='topic+cvt'></span>

<h3>Description</h3>

<p>Concentration vs. time data from CvTdb
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvt
</code></pre>


<h3>Format</h3>

<p>A 'data.frame' with 13937 rows and 61 variables:
</p>

<dl>
<dt>conc_time_id</dt><dd><p>Unique database identifier for each CvT observation.</p>
</dd>
<dt>time_original</dt><dd><p>Timepoint in original units.</p>
</dd>
<dt>time_hr</dt><dd><p>Timepoint in hours.</p>
</dd>
<dt>conc_original</dt><dd><p>Concentration in original units.</p>
</dd>
<dt>conc_sd_original</dt><dd><p>Standard deviation of concentration in original units.</p>
</dd>
<dt>conc</dt><dd><p>Concentration in normalized units.</p>
</dd>
<dt>conc_sd</dt><dd><p>Standard deviation of concentration in normalized units.</p>
</dd>
<dt>fk_series_id</dt><dd><p>Unique database identifier for experimental series.</p>
</dd>
<dt>analyte_name_original</dt><dd><p>Original analyte name.</p>
</dd>
<dt>analyte_dtxsid</dt><dd><p>DTXSID of chemical analyte.</p>
</dd>
<dt>analyte_casrn</dt><dd><p>CASRN of chemical analyte.</p>
</dd>
<dt>fk_analyzed_chemical_id</dt><dd><p>Unique database identifier for analyte.</p>
</dd>
<dt>fk_test_chemical_id</dt><dd><p>Unique database identifier for tested chemical.</p>
</dd>
<dt>test_substance_dtxsid</dt><dd><p>DTXSID of tested chemical.</p>
</dd>
<dt>analyte_name_secondary_original</dt><dd><p>Alternative names for analyte.</p>
</dd>
<dt>conc_medium_normalized</dt><dd><p>Standardized media names, blood or plasma.</p>
</dd>
<dt>conc_medium_original</dt><dd><p>Original media names.</p>
</dd>
<dt>time_units_original</dt><dd><p>Original time units.</p>
</dd>
<dt>conc_units_original</dt><dd><p>Original concentration units.</p>
</dd>
<dt>conc_units_normalized</dt><dd><p>Normalized concentration units.</p>
</dd>
<dt>conc_unit_norm_factor</dt><dd><p>Ratio of conc/conc_original</p>
</dd>
<dt>loq</dt><dd><p>Level of quantification.</p>
</dd>
<dt>loq_units</dt><dd><p>Units for loq.</p>
</dd>
<dt>n_subjects_in_series</dt><dd><p>Number of subjects in each series.</p>
</dd>
<dt>radiolabeled</dt><dd><p>Answers whether this observation comes from a radiolabelling or isotope tracing experiment.</p>
</dd>
<dt>fk_study_id</dt><dd><p>Unique database identifier for each study.</p>
</dd>
<dt>administration_route_normalized</dt><dd><p>Route of exposure/administration, either oral or iv.</p>
</dd>
<dt>fk_dosed_chemical_id</dt><dd><p>Unique database identifier for dosed chemical.</p>
</dd>
<dt>dose_volume</dt><dd><p>Volume of dose.</p>
</dd>
<dt>dose_volume_units</dt><dd><p>Units for dose_volume.</p>
</dd>
<dt>dose_vehicle</dt><dd><p>If available, specifies what vehicle was used CvT experiment.</p>
</dd>
<dt>dose_duration</dt><dd><p>Duration of the dose, if available.</p>
</dd>
<dt>dose_duration_units</dt><dd><p>Units for dose_duration.</p>
</dd>
<dt>dose_frequency</dt><dd><p>Frequency of dosing, these should all be 1 for a single bolus.</p>
</dd>
<dt>fasting_period</dt><dd><p>If available, describes the fasting period for subjects.</p>
</dd>
<dt>dose_level_normalized</dt><dd><p>Dose levels in normalized units.</p>
</dd>
<dt>dose_level_original</dt><dd><p>Dose levels in original units.</p>
</dd>
<dt>dose_level_units_original</dt><dd><p>Units for dose_level_original.</p>
</dd>
<dt>fk_subject_id</dt><dd><p>Unique database identifier for each subject.</p>
</dd>
<dt>weight_kg</dt><dd><p>Subject weight, in kilograms.</p>
</dd>
<dt>species</dt><dd><p>Subject species.</p>
</dd>
<dt>sex</dt><dd><p>Subject sex, if available.</p>
</dd>
<dt>age</dt><dd><p>Subject age, if available.</p>
</dd>
<dt>age_units</dt><dd><p>Units for age.</p>
</dd>
<dt>age_category</dt><dd><p>Categories for age.</p>
</dd>
<dt>fk_extraction_document_id</dt><dd><p>Unique database identifier for documents that were curated.</p>
</dd>
<dt>pmid</dt><dd><p>Document PubMed ID.</p>
</dd>
<dt>year</dt><dd><p>Year of publication.</p>
</dd>
<dt>other_study_identifier</dt><dd><p>Alternative identifier for documents, used for NTP studies.</p>
</dd>
<dt>url</dt><dd><p>Document URL address.</p>
</dd>
<dt>doi</dt><dd><p>Document DOI.</p>
</dd>
<dt>extracted</dt><dd><p>Curation level of document.</p>
</dd>
<dt>curation_set_tag</dt><dd><p>A grouping tag for specific document extraction and curation efforts.</p>
</dd>
<dt>n_subjects_normalized</dt><dd><p>Normalized subject number.</p>
</dd>
<dt>invivPK_dose_level_units</dt><dd><p>dose_level_units used in this package, mg/kg.</p>
</dd>
<dt>invivPK_conc_units</dt><dd><p>conc_units used in this package, ug/mL</p>
</dd>
<dt>invivPK_conc</dt><dd><p>Concentrations normalized to ug/mL</p>
</dd>
<dt>invivPK_dose_level</dt><dd><p>Dose normalized to mg/kg</p>
</dd>
<dt>invivPK_loq</dt><dd><p>Level of quantification in ug/mL</p>
</dd>
<dt>invivPK_loq_units</dt><dd><p>LOQ units used in this package, ug/mL.</p>
</dd>
<dt>invivPK_conc_sd</dt><dd><p>Standard deviation of concentrations, in ug/mL.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is concentration vs. time data from CvTdb, most recently downloaded as
of the date in ['cvt_date'].
</p>
<p>These data have been filtered to retain only oral and intravenous
administration, and only measurements in blood and plasma. They have also
been filtered to retain only observations where the same chemical was both
administered and measured in blood/plasma (i.e., excluding observations where
a metabolite was measured).
</p>

<hr>
<h2 id='cvt_date'>CvTdb download date</h2><span id='topic+cvt_date'></span>

<h3>Description</h3>

<p>The most recent download date of ['cvt'] data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvt_date
</code></pre>


<h3>Format</h3>

<p>An object of class <code>Date</code> of length 1.
</p>


<h3>Details</h3>

<p>A character scalar giving the date in &quot;YYYY-MM-DD&quot; format of the download
date of the data in ['cvt'] from the CvTdb database.
</p>

<hr>
<h2 id='data_summary'>data_summary()</h2><span id='topic+data_summary'></span>

<h3>Description</h3>

<p>This is the S3 method generic for data_summary()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_summary(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_summary_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="data_summary_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with variables including all the grouping variables in
'summary_group', 'group_id'; 'param_name' (the name of the summary
statistic; see Details); 'param_value' (the summary statistic value);  'param_units'
(the units of the summary statistic, derived from the units of the data).
</p>


<h3>See Also</h3>

<p>[data_summary.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='data_summary.default'>Default method for data_summary()</h2><span id='topic+data_summary.default'></span>

<h3>Description</h3>

<p>Default method for data_summary()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
data_summary(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_summary.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="data_summary.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='data_summary.pk'>Data summary for a 'pk' object</h2><span id='topic+data_summary.pk'></span>

<h3>Description</h3>

<p>Calculate data summary statistics for a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
data_summary(obj, newdata = NULL, summary_group = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_summary.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] model object. Must be fitted, or the function will exit
with an error.</p>
</td></tr>
<tr><td><code id="data_summary.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data for which to
compute the TK stats. Must contain at least variables 'Chemical',
'Species', 'Route', 'Dose', 'Conc', 'Dose.Units', 'Conc.Units', either
'Time_trans.Units' or 'Time.Units', and any other variables named in
'tk_grouping'. Default 'NULL', to use the data in 'get_data(obj)'.</p>
</td></tr>
<tr><td><code id="data_summary.pk_+3A_summary_group">summary_group</code></td>
<td>
<p>A list of variables provided using a 'dplyr::vars()'
call. The data (either 'newdata' or 'obj$data') will be grouped according
to the unique combinations of these variables. For each unique combination
of these variables in the data, a set of summary statistics will be
computed. The default is 'NULL', to use the same data grouping that was set
in [stat_nca()] for the 'pk' object. However, you may specify a different
data grouping if you wish.</p>
</td></tr>
<tr><td><code id="data_summary.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get summary statistics for data in a 'pk' object (or optionally, new data),
using data groupings defined by 'get_nca_group()' for the 'pk' object (or
optionally, new groupings). If you provide both 'newdata' and
'summary_group', then everything in the 'pk' object will be ignored and you
will simply be doing data summary *de novo* (which may be what you want).
</p>
<p>Summary statistics include, for each group:
</p>
<p>- 'n_obs': the number of observations
- 'n_exclude': The number of excluded observations
- 'n_detect': The number of non-excluded detected observations
- 'n_series_id': The number of unique series IDs
- 'n_timepts': The number of unique time points
- 'n_ref': The number of unique reference IDs
- 'tlast': The time of the latest non-excluded observation
- 'tlast_detect': The time of the latest non-excluded detected observation
- 'tfirst': The time of the earliest non-excluded observation
- 'tfirst_detect': The time of the earliest non-excluded detected observation
</p>


<h3>Value</h3>

<p>A 'data.frame' with variables including all the grouping variables in
'summary_group', 'group_id'; 'param_name' (the name of the summary
statistic; see Details); 'param_value' (the summary statistic value);  'param_units'
(the units of the summary statistic, derived from the units of the data).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='dlnorm_summary'>Log-normal distribution density function for summary data</h2><span id='topic+dlnorm_summary'></span>

<h3>Description</h3>

<p>Evaluates the normal distribution density function for summary data reported
as sample mean, sample SD, and sample N. Sample mean and sample SD should be
on the *natural* scale. If you have log-scale sample mean and SD (i.e., the
mean and SD of log-transformed observations),then use [dnorm_summary()]
instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlnorm_summary(mu, sigma, x_mean, x_sd, x_N, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dlnorm_summary_+3A_mu">mu</code></td>
<td>
<p>*Log-scale* mean of the log-normal distribution to be evaluated
(*not* the sample mean). May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dlnorm_summary_+3A_sigma">sigma</code></td>
<td>
<p>*Log-scale* standard deviation of the log-normal distribution to
be evaluated (*not* the sample SD). May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dlnorm_summary_+3A_x_mean">x_mean</code></td>
<td>
<p>Sample mean (on the *natural* scale). May be a numeric scalar
or vector.</p>
</td></tr>
<tr><td><code id="dlnorm_summary_+3A_x_sd">x_sd</code></td>
<td>
<p>Sample standard deviation (on the *natural* scale). May be a
numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dlnorm_summary_+3A_x_n">x_N</code></td>
<td>
<p>Sample number of observations. May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dlnorm_summary_+3A_log">log</code></td>
<td>
<p>TRUE/FALSE: Whether to return the log of the density function
(i.e., the log-likelihood). Default FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'x_mean', 'x_sd', 'X_N', 'mu', and 'sigma' should either be all the same
size, or length 1. If they are different lengths, they will be repeated until
their lengths match, with a warning.
</p>


<h3>Value</h3>

<p>A numeric scalar or vector matching the length of the longest of
'mu', 'sigma', 'x_mean', 'x_sd', and 'x_N'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='dnorm_summary'>Normal distribution density function for summary data</h2><span id='topic+dnorm_summary'></span>

<h3>Description</h3>

<p>Evaluates the normal distribution density function for summary data reported
as sample mean, sample SD, and sample N.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnorm_summary(mu, sigma, x_mean, x_sd, x_N, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dnorm_summary_+3A_mu">mu</code></td>
<td>
<p>Mean of the normal distribution to be evaluated (*not* the sample
mean). May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dnorm_summary_+3A_sigma">sigma</code></td>
<td>
<p>Standard deviation of the normal distribution to be evaluated
(*not* the sample SD). May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dnorm_summary_+3A_x_mean">x_mean</code></td>
<td>
<p>Sample mean. May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dnorm_summary_+3A_x_sd">x_sd</code></td>
<td>
<p>Sample standard deviation. May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dnorm_summary_+3A_x_n">x_N</code></td>
<td>
<p>Sample number of observations. May be a numeric scalar or vector.</p>
</td></tr>
<tr><td><code id="dnorm_summary_+3A_log">log</code></td>
<td>
<p>TRUE/FALSE: Whether to return the log of the density function.
Default FALSE (to return the density function value on the natural scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'x_mean', 'x_sd', 'X_N', 'mu', and 'sigma' should either be all the same size, or length 1.
If they are different lengths, they will be repeated until their lengths
match, with a warning.
</p>


<h3>Value</h3>

<p>A numeric scalar or vector matching the length of the longest of
'mu', 'sigma', 'x_mean', 'x_sd', and 'x_N'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='do_data_info'>do_data_info generic</h2><span id='topic+do_data_info'></span>

<h3>Description</h3>

<p>do_data_info generic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_data_info_+3A_obj">obj</code></td>
<td>
<p>the pk object</p>
</td></tr>
<tr><td><code id="do_data_info_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class [pk()] with an added '$data_info' list containing
non-compartmental analysis results.
</p>


<h3>See Also</h3>

<p>[do_data_info.pk()] for the 'do_data_info' method for class [pk()]
</p>

<hr>
<h2 id='do_data_info.default'>do_data_info default method</h2><span id='topic+do_data_info.default'></span>

<h3>Description</h3>

<p>do_data_info default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
do_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_data_info.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="do_data_info.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='do_data_info.pk'>calculate summary data info</h2><span id='topic+do_data_info.pk'></span>

<h3>Description</h3>

<p>Calculate summary data information, including non-compartmental analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
do_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_data_info.pk_+3A_obj">obj</code></td>
<td>
<p>An object of class [pk()].</p>
</td></tr>
<tr><td><code id="do_data_info.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class [pk()] with an added '$data_info' list containing
non-compartmental analysis results.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='do_fit'>Fitting</h2><span id='topic+do_fit'></span>

<h3>Description</h3>

<p>This is the S3 generic method for 'do_fit'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_fit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_fit_+3A_obj">obj</code></td>
<td>
<p>the pk object</p>
</td></tr>
<tr><td><code id="do_fit_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same [pk] object, with element 'fit' containing the fitted
results for each model in 'stat_model'.
</p>


<h3>See Also</h3>

<p>[do_fit.pk()] for the 'do_fit' method for class [pk()]
</p>

<hr>
<h2 id='do_fit.default'>do_fit default method</h2><span id='topic+do_fit.default'></span>

<h3>Description</h3>

<p>do_fit default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
do_fit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_fit.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="do_fit.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='do_fit.pk'>Do fitting</h2><span id='topic+do_fit.pk'></span>

<h3>Description</h3>

<p>Fit PK model(s) for a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
do_fit(obj, n_cores = NULL, rate_names = NULL, max_multiplier = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_fit.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk] object.</p>
</td></tr>
<tr><td><code id="do_fit.pk_+3A_n_cores">n_cores</code></td>
<td>
<p>Number of cores used for parallel computing.</p>
</td></tr>
<tr><td><code id="do_fit.pk_+3A_rate_names">rate_names</code></td>
<td>
<p>The names of the rate units. Leave NULL to utilize default 1/hour.</p>
</td></tr>
<tr><td><code id="do_fit.pk_+3A_max_multiplier">max_multiplier</code></td>
<td>
<p>Numeric value for upper prediction limit (this number multiplied
by maximum concentrations in each experiment). Default set to NULL does not apply this limit.</p>
</td></tr>
<tr><td><code id="do_fit.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the parameters for each model in 'stat_model' from
the data, using numerical optimization implemented in [optimx::optimx()]. The
optimization is done by maximizing the log-likelihood function implemented in
[log_likelihood()] (technically, by minimizing the negative log-likelihood).
Only the non-excluded observations are used.
</p>
<p>Due to limitations of [optimx::optimx()], the log-likelihood function is
forced to return finite values during this optimization. Impossible
combinations of parameters (e.g., parameter values that produce negative
predicted concentrations) should have a log-likelihood of '-Inf', but due to
this limitation, they instead have a log-likelihood of '-Machine.doublexmax'.
This limitation means that the log-likelihood function is flat in regions of
impossible parameter values. It is unlikely, but possible, that the optimizer
might get &quot;stuck&quot; in such a flat region &ndash; report convergence, but return a
&quot;bad&quot; set of parameter values that produces non-physical predictions.
</p>
<p>Before trusting the results of any fit, it is recommended to check the
log-likelihood using [logLik()] and the Akaike Information Criterion using
[AIC()], which check the log-likelihood *without* forcing it to return finite
values.
</p>


<h3>Value</h3>

<p>The same [pk] object, with element 'fit' containing the fitted
results for each model in 'stat_model'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='do_prefit'>Prefitting</h2><span id='topic+do_prefit'></span>

<h3>Description</h3>

<p>Prefitting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_prefit_+3A_obj">obj</code></td>
<td>
<p>the pk object</p>
</td></tr>
<tr><td><code id="do_prefit_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same 'pk' object, but with a new element 'prefit', containing the
results of pre-fit calculations and checks for each model and for the error
model.
</p>


<h3>See Also</h3>

<p>[do_prefit.pk()] for the 'do_prefit' method for class [pk()]
</p>

<hr>
<h2 id='do_prefit.default'>do_prefit default method</h2><span id='topic+do_prefit.default'></span>

<h3>Description</h3>

<p>do_prefit default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
do_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_prefit.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="do_prefit.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='do_prefit.pk'>Do pre-fitting</h2><span id='topic+do_prefit.pk'></span>

<h3>Description</h3>

<p>Do pre-fit calculations and checks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
do_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_prefit.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="do_prefit.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does the following:
</p>
<p>- Based on the error model in 'stat_error_model' and the pre-processed data, determines the number of residual standard deviations (&quot;sigmas&quot;) hyperparameters to be estimated.
- Determines which &quot;sigma&quot; hyperparameter corresponds to each observation in the data.
- Calculates lower/upper bounds and starting guesses for each &quot;sigma&quot; hyperparameter
- For each model in &lsquo;stat_model', calls its 'params_fun', the function that, based on the data, determines whether to optimize each model parameter, and calculates lower/upper bounds and starting guesses for each model parameter to be optimized. Only non-excluded observations are passed to each model&rsquo;s 'params_fun'.
</p>
<p>Lower bounds for each &quot;sigma&quot; hyperparameter are set to 'sqrt(.Machine$double_eps)'.
</p>
<p>Upper bounds for each &quot;sigma&quot; hyperparameter are calculated as the standard
deviation of observations in the corresponding error SD group (see
[combined_sd()]), with any specified transformations applied
(dose-normalization and/or log10-transformation). If the combined SD is
non-finite or less than the sigma lower bound, then the maximum concentration
is used as an upper bound; if this still returns a non-finite value or a
value less than the lower bound, then a constant value of 1000 is
substituted.
</p>
<p>The starting guess for each &quot;sigma&quot; hyperparameter is one-tenth of the upper bound.
</p>


<h3>Value</h3>

<p>The same 'pk' object, but with a new element 'prefit', containing the
results of pre-fit calculations and checks for each model and for the error
model.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='do_preprocess'>Preprocess data generic</h2><span id='topic+do_preprocess'></span>

<h3>Description</h3>

<p>Preprocess data generic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_preprocess_+3A_obj">obj</code></td>
<td>
<p>the pk object.</p>
</td></tr>
<tr><td><code id="do_preprocess_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The same 'pk' object, with added elements 'data' (containing the
cleaned, gap-filled data) and 'data_info' (containing summary information
about the data, e.g. number of observations by route, media,
detect/nondetect; empirical tmax, time of peak concentration for oral data;
number of observations before and after empirical tmax)
</p>


<h3>See Also</h3>

<p>[do_preprocess.pk()] for the 'do_preprocess' method for class [pk()]
</p>

<hr>
<h2 id='do_preprocess.default'>do_preprocess default method</h2><span id='topic+do_preprocess.default'></span>

<h3>Description</h3>

<p>do_preprocess default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
do_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_preprocess.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="do_preprocess.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='do_preprocess.pk'>Do pre-processing</h2><span id='topic+do_preprocess.pk'></span>

<h3>Description</h3>

<p>Pre-process data for a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
do_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_preprocess.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="do_preprocess.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use currently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data pre-processing for an object 'obj' includes the following steps, in order:
</p>
<p>- Coerce data to class 'data.frame' (if it is not already)
- Rename variables to harmonized &quot;'invivopkfit' aesthetic&quot; variable names, using 'obj$mapping'
- Check that the data includes only routes in 'obj$settings_preprocess$routes_keep' and media in 'obj$settings_preprocess$media_keep'
- Check that the data includes only one unit for concentration, one unit for time, and one unit for dose.
- Coerce 'Value', 'Value_SD', 'LOQ', 'Dose', and 'Time' to numeric, if they are not already.
- Coerce 'Species', 'Route', and 'Media' to lowercase.
- Replace any negative 'Value', 'Value_SD', 'Dose', or 'Time' with 'NA'
- If any non-NA 'Value' is currently less than its non-NA LOQ, then replace it with NA
-  Impute any NA 'LOQ': as 'calc_loq_factor' * minimum non-NA 'Value' in each 'loq_group'
- For any cases where 'N_Subject's is NA, impute 'N_Subjects' = 1
- For anything with 'N_Subjects' == 1, set 'Value_SD' to 0
- Impute missing 'Value_SD' as follows: For observations with 'N_Subjects' &gt; 1, take the minimum non-missing 'Value_SD' for each 'sd_group'. If all SDs are missing in an 'sd_group', then 'Value_SD' for each observation in that group will be imputed as 0.
- Mark data for exclusion according to the following criteria:
- Exclude any remaining observations where both Value and LOQ are NA
- For any cases where 'N_Subjects' is NA, impute 'N_Subjects' = 1
- Exclude any remaining observations with 'N_Subjects' &gt; 1 and 'Value_SD' still NA. (This should never occur, if SD imputation is performed, but just in case.)
- Exclude any observations with 'N_Subjects' &gt; 1 where reported 'Value' is NA, because log-likelihood for non-detect multi-subject observations has not been implemented.
- Exclude any observations with NA 'Time' values
- Exclude any observations with 'Dose' = 0
- Apply any time transformations specified by user
- Scale concentration by 'ratio_conc_dose'
- Apply any concentration transformations specified by the user.
- If 'Series_ID' is not included, then assign it as NA
- Create variable 'pLOQ' and set it equal to 'LOQ'
</p>


<h3>Value</h3>

<p>The same 'pk' object, with added elements 'data' (containing the
cleaned, gap-filled data) and 'data_info' (containing summary information
about the data, e.g. number of observations by route, media,
detect/nondetect; empirical tmax, time of peak concentration for oral data;
number of observations before and after empirical tmax)
</p>


<h3>Author(s)</h3>

<p>John Wambaugh, Caroline Ring, Christopher Cook, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='eval_tkstats'>eval_tkstats()</h2><span id='topic+eval_tkstats'></span>

<h3>Description</h3>

<p>This is the S3 method generic for eval_tkstats()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_tkstats(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_tkstats_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="eval_tkstats_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with one  row for each &quot;winning&quot; model in
'model' from [get_winning_model()]. The 'data.frame' will have the variables
returned by the 'tkstats_fun' for its corresponding model. (For the
built-in models 'model_flat', 'model_1comp', and 'model_2comp', these
variables are 'param_name' and 'param_value'.) Additionally, there will be
a variable 'method' denoting the [optimx::optimx()] method used to optimize
the set of model parameters used to derive each set of TK statistics.
</p>


<h3>See Also</h3>

<p>[eval_tkstats.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='eval_tkstats.default'>Default method for eval_tkstats()</h2><span id='topic+eval_tkstats.default'></span>

<h3>Description</h3>

<p>Default method for eval_tkstats()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
eval_tkstats(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_tkstats.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="eval_tkstats.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='eval_tkstats.pk'>Evaluate TK statistics</h2><span id='topic+eval_tkstats.pk'></span>

<h3>Description</h3>

<p>Evaluate TK statistics from a fitted model by comparing to NCA results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
eval_tkstats(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  tk_group = NULL,
  exclude = TRUE,
  dose_norm = FALSE,
  finite_only = TRUE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_tkstats.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] model object. Must be fitted, or the function will exit
with an error.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data for which to
compute the TK stats. Must contain at least variables 'Chemical',
'Species', 'Route', 'Media', 'Dose', 'Dose.Units', 'Conc.Units', either
'Time_trans.Units' or 'Time.Units', and any other variables named in
'tk_grouping'. Default 'NULL', to use the data in 'obj$data'.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_model">model</code></td>
<td>
<p>Character: One or more of the models fitted. Default 'NULL' to
return TK stats for all models.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_method">method</code></td>
<td>
<p>Character: One or more of the [optimx::optimx()] methods used.
Default 'NULL' to return TK stats for all methods.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_tk_group">tk_group</code></td>
<td>
<p>A list of variables provided using a 'dplyr::vars()' call.
The data (either 'newdata' or 'obj$data') will be grouped according to the
unique combinations of these variables. For each unique combination of
these variables in the data, a set of TK statistics will be computed. The
default is 'obj$settings_data_info$summary_group', to derive TK statistics for
the same groups of data as non-compartmental analysis statistics. With the
default, you can directly compare e.g. a model-predicted AUC_inf to the
corresponding NCA-estimated AUC_inf. However, you may specify a different
data grouping if you wish. Each group should have a unique combination of
'Chemical', 'Species', 'Route', 'Media', and 'Dose', because the TK stats
depend on these values, and it is required to have one unique set of TK
stats per group.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to get the TK groupings after removing any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when 'TRUE').
'FALSE' to include all observations when getting the TK
groupings, regardless of exclusion status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: 'TRUE' (default) to dose-normalize before
calculating both the NCA statistics and the fitted TK statistics (i.e. all
dose-dependent statistics will be for a unit dose of 1 mg/kg, including
Cmax, AUC, Css). 'FALSE' to calculate NCA and fitted TK stats separately
for each dose group (you must specify 'Dose' as one of the variables in
'tk_group' for this to work). If 'dose_norm' is 'TRUE' and you also specify
'Dose' as one of the 'tk_group' variables, then the dose part of the
grouping will be ignored in the output. (If 'TRUE', under
the hood, this function will temporarily overwrite the 'Dose' column in its
local copy of &lsquo;newdata' with 1&rsquo;s. This doesn't affect the data outside of
this function. But it means that any values in the 'Dose' variable of
'newdata' will be ignored if 'TRUE'.)</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_finite_only">finite_only</code></td>
<td>
<p>Logical: 'TRUE' (default) returns only rows (observations)
for which AUC is finite in both 'nca' and 'tkstats'. This also means it will
by default never return instances where winning model == 'model_flat'.</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'obj$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="eval_tkstats.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with one  row for each &quot;winning&quot; model in
'model' from [get_winning_model()]. The 'data.frame' will have the variables
returned by the 'tkstats_fun' for its corresponding model. (For the
built-in models 'model_flat', 'model_1comp', and 'model_2comp', these
variables are 'param_name' and 'param_value'.) Additionally, there will be
a variable 'method' denoting the [optimx::optimx()] method used to optimize
the set of model parameters used to derive each set of TK statistics.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='facet_data'>Facet a PK fit</h2><span id='topic+facet_data'></span>

<h3>Description</h3>

<p>Create a &quot;faceted&quot; [pk()] object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>facet_data(facets = vars(Chemical, Species), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="facet_data_+3A_facets">facets</code></td>
<td>
<p>A set of variables or expressions quoted by [dplyr::vars()],
defining groups of data that will each be fitted separately. These
variables should appear in the *original* data (i.e., the 'data' argument
to [pk()]).</p>
</td></tr>
<tr><td><code id="facet_data_+3A_...">...</code></td>
<td>
<p>Additional arguments, not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function automates the process of doing PK fitting in &quot;batch mode&quot;, when
you have multiple concentration-dose-time datasets to fit, and you want to
fit them all using the same set of instructions.
</p>
<p>When you do something like
</p>
<p>&ldquo;'
pk_cvt &lt;- pk(cvt) +
facet_data(
facets = vars(
chemicals_analyzed.dsstox_substance_id,
subjects.species_harmonized
)
)
&ldquo;'
</p>
<p>Now 'pk_cvt' is an object of class 'pk_faceted': under the hood, a
[tibble::tibble()] with one row for each group defined by a unique
combination of the faceting variables, and a 'list' column containing a
[pk()] object corresponding to each group.
</p>
<p>All of the [pk()] objects in the 'list' column contain the same set of
instructions, and they will all have the same status (*i.e.*, they are all in
the same stage of the workflow at the same time). The only thing different
among them is the data.
</p>
<p>If you call a 'pk' method on a 'pk_faceted' object, the method will be
applied in turn to the [pk()] object for each group.
</p>
<p>If the method returns a [pk()] object (e.g. [preprocess_data.pk()],
[data_info.pk()], [prefit.pk()], and [fit.pk()]), then the result for a
'pk_faceted' object will be another 'pk_faceted' object.
</p>
<p>If the method returns something other than a [pk()] object (e.g. [coef.pk()],
[coef_sd.pk()], [residuals.pk()], [predict.pk()], ...) then the result for a
'pk_faceted' object will simply be a [tibble::tibble()] with a 'list' column
containing the result for each group &ndash; it won't have class 'pk_faceted'.
</p>
<p>This function is named by analogy to [ggplot2::facet_wrap()] and
[ggplot2::facet_grid()]. Those functions split up a dataset into groups by
one or more 'factor' variables, and produce a &quot;faceted&quot; grid of plots for
each group of data. This function does an analogous thing for a [pk()]
analysis. The dataset is split into groups by the unique combinations of
variables in 'facets'. For each group, a separate [pk()] object is created,
using the instructions provided by the user. When methods like
[preprocess_data()], [data_info()], [prefit()], and [fit()] are called on the
resulting &quot;faceted&quot;
</p>


<h3>Value</h3>

<p>An object of class 'c(&quot;pkproto&quot;, &quot;pk_facet_data&quot;)'. Under the hood, a
named  'list' containing the arguments provided to this function. Almost
always added to a [pk()] object using ['+.pk'].
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilbert Padilla Mercado, Paul Kruse
</p>

<hr>
<h2 id='fill_params_1comp'>Fill parameters for 1-compartment model</h2><span id='topic+fill_params_1comp'></span>

<h3>Description</h3>

<p>Fill parameters for 1-compartment model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_params_1comp(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_params_1comp_+3A_params">params</code></td>
<td>
<p>Named numeric vector of parameters for the 1-compartment model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of parameters, with any 1-compartment model
parameters not present in 'params' filled with 'NA_real_'. If any two of
'Fgutabs', 'Vdist', and 'Fgutabs_Vdist' were present in 'params', the third will
be imputed to agree with the other two.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='fill_params_1comp_cl'>Fill parameters for 1-compartment model with specific clearance</h2><span id='topic+fill_params_1comp_cl'></span>

<h3>Description</h3>

<p>Fill parameters for 1-compartment model with specific clearance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_params_1comp_cl(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_params_1comp_cl_+3A_params">params</code></td>
<td>
<p>Named numeric vector of parameters for the 1-compartment model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of parameters, with any 1-compartment model
parameters not present in 'params' filled with 'NA_real_'. If any two of
'Fgutabs', 'Vdist', and 'Fgutabs_Vdist' were present in 'params', the third will
be imputed to agree with the other two.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='fill_params_2comp'>Fill parameters for 2-compartment model</h2><span id='topic+fill_params_2comp'></span>

<h3>Description</h3>

<p>Fill parameters for 2-compartment model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_params_2comp(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_params_2comp_+3A_params">params</code></td>
<td>
<p>Named numeric vector of parameters for the 2-compartment model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of parameters, with any 2-compartment model
parameters not present in 'params' filled with 'NA_real_'. If any two of
'Fgutabs', 'V1', and 'Fgutabs_V1' were present in 'params', the third will
be imputed to agree with the other two.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='fill_params_flat'>Fill parameters for flat model</h2><span id='topic+fill_params_flat'></span>

<h3>Description</h3>

<p>Fill parameters for flat model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_params_flat(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_params_flat_+3A_params">params</code></td>
<td>
<p>Named numeric vector of parameters for the flat model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of parameters, with any flat model
parameters not present in 'params' filled with 'NA_real_'. If any two of
'Fgutabs', 'Vdist', and 'Fgutabs_Vdist' were present in 'params', the third will
be imputed to agree with the other two.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='fit_group'>Fit a single group of data</h2><span id='topic+fit_group'></span>

<h3>Description</h3>

<p>Fit a single group of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_group(
  data,
  par_DF,
  sigma_DF,
  fit_decision,
  this_model,
  settings_optimx,
  modelfun,
  dose_norm,
  log10_trans,
  max_mult,
  suppress.messages
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_group_+3A_data">data</code></td>
<td>
<p>A single group of data</p>
</td></tr>
<tr><td><code id="fit_group_+3A_par_df">par_DF</code></td>
<td>
<p>par_DF for a single group of data</p>
</td></tr>
<tr><td><code id="fit_group_+3A_sigma_df">sigma_DF</code></td>
<td>
<p>sigma_DF for a single group of data</p>
</td></tr>
<tr><td><code id="fit_group_+3A_fit_decision">fit_decision</code></td>
<td>
<p>Whether the fit is able to be calculated or excluded.</p>
</td></tr>
<tr><td><code id="fit_group_+3A_this_model">this_model</code></td>
<td>
<p>Name of the 'pk_model' object to fit</p>
</td></tr>
<tr><td><code id="fit_group_+3A_settings_optimx">settings_optimx</code></td>
<td>
<p>The settings for optimization.</p>
</td></tr>
<tr><td><code id="fit_group_+3A_modelfun">modelfun</code></td>
<td>
<p>Name of the model concentration function</p>
</td></tr>
<tr><td><code id="fit_group_+3A_dose_norm">dose_norm</code></td>
<td>
<p>TRUE or FALSE &ndash; whether to dose-normalize concentrations
before evaluating log-likelihood</p>
</td></tr>
<tr><td><code id="fit_group_+3A_log10_trans">log10_trans</code></td>
<td>
<p>TRUE or FALSE &ndash; whether to 1og10-transform concentrations
before evaluating log-likelihood</p>
</td></tr>
<tr><td><code id="fit_group_+3A_max_mult">max_mult</code></td>
<td>
<p>Multiplier for maximum acceptable value. Default set to NULL and
currently unused.</p>
</td></tr>
<tr><td><code id="fit_group_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>TRUE or FALSE &ndash; whether to suppress messages or emit them</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'optimx' (i.e. a data.frame with fit results)
</p>

<hr>
<h2 id='fold_error'>Fold error</h2><span id='topic+fold_error'></span>

<h3>Description</h3>

<p>This is the S3 method generic for 'fold_error'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fold_error(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fold_error_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="fold_error_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and
'method'. A column contains the fold errors (observed/predicted) of the
model fitted by the corresponding method. These residuals are
concentrations in the same units as 'obj$data$Conc.Units'; any
concentration transformations (in 'obj$scale$conc') are *not* applied.
</p>


<h3>See Also</h3>

<p>[fold_error.pk()] for the 'fold_error' method for class [pk()]
</p>

<hr>
<h2 id='fold_error.default'>fold_error default method</h2><span id='topic+fold_error.default'></span>

<h3>Description</h3>

<p>fold_error default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
fold_error(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fold_error.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="fold_error.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='fold_error.pk'>Fold errors</h2><span id='topic+fold_error.pk'></span>

<h3>Description</h3>

<p>Calculate fold errors for a fitted 'pk' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
fold_error(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  sub_pLOQ = TRUE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fold_error.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to compute
fold errors. If NULL (the default), then fold errors will be computed for
the data in 'obj$data'. 'newdata' is required to contain at least the
following variables: 'Time', 'Dose', 'Route', and 'Media'.</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate fold errors. If NULL (the default), fold
errors will be returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate RMSEs. If NULL (the default),
fold errors will be returned for all of the models in
'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to return 'NA_real_' for any observations in
the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to return the prediction for each observation, regardless of
exclusion. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>Logical: whether or not to include predictions below pLOQ.
when TRUE, values below pLOQ will be replaced by pLOQ.</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'object$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="fold_error.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, fold error is defined as 'observed/predicted'.
</p>
<p># Scaling and transformation of concentration variables in 'newdata'
</p>
<p>This function differs from some of the other methods for a fitted [pk()]
object that accept 'newdata', in that there is no 'use_scale_conc' argument
for [fold_error.pk()]. Fold errors are always computed on the natural,
un-transformed concentration scale (but note that fold error on a dose-normalized
scale will be the same as fold error on a non-dose-normalized scale).
</p>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and
'method'. A column contains the fold errors (observed/predicted) of the
model fitted by the corresponding method. These residuals are
concentrations in the same units as 'obj$data$Conc.Units'; any
concentration transformations (in 'obj$scale$conc') are *not* applied.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_data'>get_data()</h2><span id='topic+get_data'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame': the 'data' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_data.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_group'>get_data_group()</h2><span id='topic+get_data_group'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_group_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_group_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'call' giving the data grouping as a 'dplyr::vars()' specification
</p>


<h3>See Also</h3>

<p>[get_data_group.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_group.default'>Default method for get_data_group()</h2><span id='topic+get_data_group.default'></span>

<h3>Description</h3>

<p>Default method for get_data_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_group.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data_group.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data_group.pk'>Get data grouping</h2><span id='topic+get_data_group.pk'></span>

<h3>Description</h3>

<p>Get data grouping
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_data_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_group.pk_+3A_obj">obj</code></td>
<td>
<p>An initialized 'pk' object</p>
</td></tr>
<tr><td><code id="get_data_group.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'call' giving the data grouping as a 'dplyr::vars()' specification
</p>

<hr>
<h2 id='get_data_info'>get_data_info()</h2><span id='topic+get_data_info'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data_info()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_info_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_info_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list' of 'tibble's: the 'data_info' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_data_info.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_info.default'>Default method for get_data_info()</h2><span id='topic+get_data_info.default'></span>

<h3>Description</h3>

<p>Default method for get_data_info()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_info.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data_info.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data_info.pk'>Get data_info</h2><span id='topic+get_data_info.pk'></span>

<h3>Description</h3>

<p>Extract summary data information results from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_info.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object that has had 'data_info()' run on it</p>
</td></tr>
<tr><td><code id="get_data_info.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list' of 'tibble's: the 'data_info' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_data_original'>get_data_original()</h2><span id='topic+get_data_original'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data_original()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_original(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_original_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_original_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' &ndash; the 'data_original' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_data_original.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_original.default'>Default method for get_data_original()</h2><span id='topic+get_data_original.default'></span>

<h3>Description</h3>

<p>Default method for get_data_original()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data_original(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_original.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data_original.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data_original.pk'>Get data_original</h2><span id='topic+get_data_original.pk'></span>

<h3>Description</h3>

<p>Get data_original
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_data_original(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_original.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_data_original.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' &ndash; the 'data_original' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_data_sigma_group'>get_data_sigma_group()</h2><span id='topic+get_data_sigma_group'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data_sigma_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_sigma_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_sigma_group_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_sigma_group_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'factor' vector giving the error SD group ID for each observation,
as the interaction of the factors specified in
'obj$stat_error_model$error_group'.
</p>


<h3>See Also</h3>

<p>[get_data_sigma_group.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_sigma_group.default'>Default method for get_data_sigma_group()</h2><span id='topic+get_data_sigma_group.default'></span>

<h3>Description</h3>

<p>Default method for get_data_sigma_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data_sigma_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_sigma_group.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data_sigma_group.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data_sigma_group.pk'>Get data_sigma_group</h2><span id='topic+get_data_sigma_group.pk'></span>

<h3>Description</h3>

<p>Get data_sigma_group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_data_sigma_group(obj, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_sigma_group.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_data_sigma_group.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to get the
'data_sigma_group's. If NULL (the default), then the groups will be
evaluated for the 'obj$data'.</p>
</td></tr>
<tr><td><code id="get_data_sigma_group.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'factor' vector giving the error SD group ID for each observation,
as the interaction of the factors specified in
'obj$stat_error_model$error_group'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_data_summary'>get_data_summary()</h2><span id='topic+get_data_summary'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_data_summary()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_summary(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_summary_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_data_summary_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'get_data_summary()' is an alias for 'data_summary()'
</p>


<h3>Value</h3>

<p>A 'data.frame' with variables including all the grouping variables in
'summary_group', 'group_id'; 'param_name' (the name of the summary
statistic; see Details); 'param_value' (the summary statistic value);  'param_units'
(the units of the summary statistic, derived from the units of the data).
</p>


<h3>See Also</h3>

<p>[data_summary.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_data_summary.default'>Default method for get_data_summary()</h2><span id='topic+get_data_summary.default'></span>

<h3>Description</h3>

<p>Default method for get_data_summary()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data_summary(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_summary.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data_summary.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data.default'>Default method for get_data()</h2><span id='topic+get_data.default'></span>

<h3>Description</h3>

<p>Default method for get_data()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_data(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_data.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_data.pk'>Get data</h2><span id='topic+get_data.pk'></span>

<h3>Description</h3>

<p>Extract pre-processed data from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_data(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object that has been pre-processed</p>
</td></tr>
<tr><td><code id="get_data.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame': the 'data' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_elbow'>Get an elbow point</h2><span id='topic+get_elbow'></span>

<h3>Description</h3>

<p>Given a set of data specified as two vectors of 'x' and 'y' values, find an
elbow point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_elbow(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_elbow_+3A_x">x</code></td>
<td>
<p>The 'x' values from the data where an elbow point is to be found.</p>
</td></tr>
<tr><td><code id="get_elbow_+3A_y">y</code></td>
<td>
<p>The 'y' values from the data where an elbow point is to be found.</p>
</td></tr>
<tr><td><code id="get_elbow_+3A_...">...</code></td>
<td>
<p>Optional: additional arguments that will be passed to
[stats::approx()] if it is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function for [get_starts()] to find elbow points.
</p>
<p>Given a set of (x,y) data points, an &quot;elbow point&quot; can be defined by drawing
a line connecting the points for minimum and maximum x, and then finding the
x value of the observation where the distance to that line is greatest.
</p>
<p>[get_starts()] uses elbow points as a way to automate separation of
concentration-time data into different kinetic phases in order to calculate
starting points for fitting TK model parameters. For example, if
concentration-time data are described by a two-compartment TK model, then
early and late elimination phases will be separated by an elbow point. This
helper function finds the elbow points. (When this function is called from
[get_starts()], 'x' will be a vector of time values, and 'y' will be a vector
of log-transformed dose-normalized concentration values.)
</p>


<h3>Value</h3>

<p>A list with two named numeric scalar elements, 'x' and 'y'. 'x'
contains the 'x' value at the elbow point. 'y' contains the 'y' value at
the elbow point. The elbow point is *not* necessarily one of the input data
points; it may be interpolated.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_error_group'>get_error_group()</h2><span id='topic+get_error_group'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_error_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_error_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_error_group_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_error_group_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The stat_error_model error grouping
</p>


<h3>See Also</h3>

<p>[get_error_group.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_error_group.default'>Default method for get_error_group()</h2><span id='topic+get_error_group.default'></span>

<h3>Description</h3>

<p>Default method for get_error_group()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_error_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_error_group.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_error_group.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_error_group.pk'>Get error group</h2><span id='topic+get_error_group.pk'></span>

<h3>Description</h3>

<p>Get error group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_error_group(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_error_group.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_error_group.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use currently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The stat_error_model error grouping
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_fit'>get_fit()</h2><span id='topic+get_fit'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_fit()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fit_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_fit_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of objects of class 'optimx', named for the models in
'model'. As described in [optimx::optimx()]  If only one model is
specified, the return value will still be a list, but with only one
element.
</p>


<h3>See Also</h3>

<p>[get_fit.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_fit.default'>Default method for get_fit()</h2><span id='topic+get_fit.default'></span>

<h3>Description</h3>

<p>Default method for get_fit()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_fit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fit.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_fit.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_fit.pk'>Get fits from a 'pk' object</h2><span id='topic+get_fit.pk'></span>

<h3>Description</h3>

<p>Get the [optimx::optimx()] output from a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_fit(obj, model = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fit.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk] object.</p>
</td></tr>
<tr><td><code id="get_fit.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions. If NULL (the default), predictions will be returned for
all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="get_fit.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the object(s) returned by [optimx::optimx()] for the
specified model(s) and method(s), for a fitted 'pk' object. See
[optimx::optimx()] for details. Briefly, an 'optimx' object is a 'data.frame'
with one row for each method used, and variables that give the optimized
values for each parameter, along with several diagnostic variables (e.g. the
objective function value at the optimized parameter values; the number of
function evaluations/iterations; an integer code describing convergence
status). The object will have attributes 'details' (providing
any messages returned by the methods) and 'npar' (the number of parameters
optimized).
</p>


<h3>Value</h3>

<p>A named list of objects of class 'optimx', named for the models in
'model'. As described in [optimx::optimx()]  If only one model is
specified, the return value will still be a list, but with only one
element.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='get_hessian'>get_hessian()</h2><span id='topic+get_hessian'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_hessian()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hessian(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_hessian_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_hessian_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The remaining column is a 'list' column containing the Hessian for each row.
</p>


<h3>See Also</h3>

<p>[hessian.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_hessian.default'>Default method for get_hessian()</h2><span id='topic+get_hessian.default'></span>

<h3>Description</h3>

<p>Default method for get_hessian()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_hessian(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_hessian.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_hessian.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_hessian.pk'>Get Hessian matrixes</h2><span id='topic+get_hessian.pk'></span>

<h3>Description</h3>

<p>Extract Hessian matrixes from a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_hessian(obj, model = NULL, method = NULL, suppress.messages = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_hessian.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk] object</p>
</td></tr>
<tr><td><code id="get_hessian.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models whose
coefficients to return. If NULL (the default), coefficients will be returned
for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="get_hessian.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
whose coefficients to return. If NULL (the default), coefficients will be
returned for all of the models in 'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="get_hessian.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical. 'TRUE' (the default) to suppress informative
messages. 'FALSE' to see them.</p>
</td></tr>
<tr><td><code id="get_hessian.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use right now.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes a numerical approximation to the model Hessian for each
data group and each model in a fitted 'pk' object. The Hessian is the matrix
of second derivatives of the model objective function with respect to each
model parameter. Here, the objective function is the negative log-likelihood
implemented in [log_likelihood()], evaluated jointly across the data that was
used to fit the model.
</p>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The remaining column is a 'list' column containing the Hessian for each row.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring and Gilberto Padilla Mercado
</p>


<h3>References</h3>

<p>Gill J, King G. (2004) What to Do When Your Hessian is Not
Invertible: Alternatives to Model Respecification in Nonlinear Estimation.
Sociological Methods &amp; Research 33(1):54-87. DOI: 10.1177/0049124103262681
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='get_mapping'>get_mapping()</h2><span id='topic+get_mapping'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_mapping()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mapping(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_mapping_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_mapping_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 'quosure's &ndash; the 'mapping' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_mapping.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_mapping.default'>Default method for get_mapping()</h2><span id='topic+get_mapping.default'></span>

<h3>Description</h3>

<p>Default method for get_mapping()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_mapping(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_mapping.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_mapping.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_mapping.pk'>Get mapping</h2><span id='topic+get_mapping.pk'></span>

<h3>Description</h3>

<p>Get mapping
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_mapping(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_mapping.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_mapping.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 'quosure's &ndash; the 'mapping' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_nca'>get_nca()</h2><span id='topic+get_nca'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_nca()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_nca(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_nca_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_nca_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame': the 'data' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_nca.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_nca.default'>Default method for get_nca()</h2><span id='topic+get_nca.default'></span>

<h3>Description</h3>

<p>Default method for get_nca()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_nca(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_nca.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_nca.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_nca.pk'>Get NCA</h2><span id='topic+get_nca.pk'></span>

<h3>Description</h3>

<p>Extract non-compartmental analysis results from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_nca(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_nca.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object that has had 'data_info()' run on it</p>
</td></tr>
<tr><td><code id="get_nca.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame': the 'data' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='get_params_1comp'>Get parameters for 1-compartment model</h2><span id='topic+get_params_1comp'></span>

<h3>Description</h3>

<p>Get parameters for 1-compartment model and determine whether each is to be
estimated from the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params_1comp(
  data,
  lower_bound = ggplot2::aes(kelim = log(2)/(2 * max(Time_trans)), Vdist = 0.01, Fgutabs
    = 0, kgutabs = log(2)/(2 * max(Time_trans)), Fgutabs_Vdist = 0.01, Rblood2plasma =
    0.01),
  upper_bound = ggplot2::aes(kelim = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])),
    Vdist = 100, Fgutabs = 1, kgutabs = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])),
    Fgutabs_Vdist = 100, Rblood2plasma = 100),
  param_units = ggplot2::aes(kelim = paste0("1/", unique(Time_trans.Units)), Vdist =
    paste0("(", unique(Dose.Units), ")", "/", "(", unique(Conc.Units), ")"), Fgutabs =
    "unitless fraction", kgutabs = paste0("1/", unique(Time_trans.Units)), Fgutabs_Vdist
    = paste0("(", unique(Conc.Units), ")", "/", "(", unique(Dose.Units), ")"),
    Rblood2plasma = "unitless ratio")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_params_1comp_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_params_1comp_+3A_lower_bound">lower_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the lower bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_+3A_upper_bound">upper_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the upper bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_+3A_param_units">param_units</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the units for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'kelim', 'kgutabs', 'Fgutabs', and 'Rblood2plasma'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data.
</p>
<p># IV data, no oral data
</p>
<p>If IV dosing data are available, but no oral dosing data are available, then
only the parameters 'Vdist' and 'kelim' will be estimated from the data. The
parameters 'kgutabs' and 'Fgutabs' cannot be estimated from IV data alone, and
will not be used in evaluating the model.
</p>
<p># Oral data, no IV data
</p>
<p>If oral dosing data are available, but no IV dosing data are available, then
the parameters 'kelim' and 'kgutabs' can be estimated from the data. However,
the parameters 'Fgutabs' and 'Vdist' cannot be identified separately. From
oral data alone, only the ratio 'Fgutabs/Vdist' can be identified. This ratio
is represented by a single parameter named 'Fgutabs_Vdist'. 'Fgutabs' and
'Vdist' will not be used to evaluate the model nor be estimated from data, but
'Fgutabs_Vdist' will be estimated from data, along with 'kelim' and 'kgutabs'.
</p>
<p># Oral data and IV data
</p>
<p>If both oral and IV dosing data are available, then 'Vdist', 'kelim',
'kgutabs', and 'Fgutabs' will all be estimated from the data.
</p>
<p># Blood and plasma data
</p>
<p>If both blood and plasma data are available, then 'Rblood2plasma' will be
estimated from the data.
</p>
<p># Only one of blood or plasma data
</p>
<p>If only one of blood or plasma data are available, then 'Rblood2plasma' will be
held constant at 1, not estimated from the data.
</p>
<p># Default lower and upper bounds for each parameter
</p>
<p>## Default lower and upper bounds for 'kelim' and 'kgutabs'
</p>
<p>Default bounds for time constants 'kelim' and 'kgutabs' are set based on
the time scale of the available data.
</p>
<p>The lower bounds are based on the assumption that elimination and absorption
are very slow compared to the time scale of the study. Specifically, the
lower bounds assume that elimination and absorption half-lives are twice as
long as the duration of the available study data, or '2*max(Time_trans)'.
Under this assumption, the corresponding elimination and absorption time
constants would be 'log(2)/(2*max(Time_trans))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are 'log(2)/(2*max(Time_trans))'.
</p>
<p>Upper bounds are based on the opposite assumption: that elimination and
absorption are very fast compared to the time scale of the study.
Specifically, the upper bounds assume that the elimination and absorption
half-lives are half as long as the time of the first observation after time
0, or '0.5*min(Time_trans[Time_trans&gt;0])'. Under this asumption, the
corresponding elimination and absorption time constants would be
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'.
</p>
<p>## Default lower and upper bounds for 'Vdist'
</p>
<p>By default, the lower bound for 'Vdist' is 0.01, and the upper bound for
'Vdist' is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Fgutabs'
</p>
<p>By default, the lower bound for 'Fgutabs' is 0.0, and the upper bound for
'Fgutabs' is 1. These are simply the bounds of the physically-meaningful
range for a fraction.
</p>
<p>## Default lower and upper bounds for 'Fgutabs_Vdist'
</p>
<p>By default, the lower bound for the ratio 'Fgutabs_Vdist' is 0.01, and the
upper bound is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Rblood2plasma'
</p>
<p>By default, the lower bound for the blood:plasma partition coefficient
'Rblood2plasma' is 0.01, and the upper bound is 100. These values were chosen
based on professional judgment.
</p>
<p># Starting values for each parameter
</p>
<p>Starting values for each parameter (starting guesses for the numerical
optimizer) are derived from the data using [get_starts_1comp()].
</p>
<p>If the starting values returned by [get_starts_1comp()] fall outside the
bounds for any parameter(s), then the starting value will be reset to a value
halfway between the lower and upper bounds for that parameter.
</p>


<h3>Value</h3>

<p>A 'data.frame'with the following variables:
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter
- 'start': Numeric: The starting guesses for each parameter
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other get_params functions: 
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_params_1comp_cl'>Get parameters for 1-compartment model with clearance assumption</h2><span id='topic+get_params_1comp_cl'></span>

<h3>Description</h3>

<p>Get parameters for 1-compartment model and determine whether each is to be
estimated from the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params_1comp_cl(
  data,
  lower_bound = ggplot2::aes(Q_totli = NA, Q_gfr = NA, Fup = 0, Clint = 0, Vdist = 0.01,
    Fgutabs = 0, kgutabs = log(2)/(2 * max(Time_trans)), Fgutabs_Vdist = 0.01,
    Rblood2plasma = 0.01),
  upper_bound = ggplot2::aes(Q_totli = NA, Q_gfr = NA, Fup = 1, Clint = 1e+05, Vdist =
    100, Fgutabs = 1, kgutabs = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])),
    Fgutabs_Vdist = 100, Rblood2plasma = 100),
  param_units = ggplot2::aes(Q_totli = "L/h/kg ^3/4", Q_gfr = "L/h/kg ^3/4", Fup =
    "unitless fraction", Clint = "L/h/kg", Vdist = paste0("(", unique(Dose.Units), ")",
    "/", "(", unique(Conc.Units), ")"), Fgutabs = "unitless fraction", kgutabs =
    paste0("1/", unique(Time_trans.Units)), Fgutabs_Vdist = paste0("(",
    unique(Conc.Units), ")", "/", "(", unique(Dose.Units), ")"), Rblood2plasma =
    "unitless ratio"),
  restrictive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_params_1comp_cl_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_params_1comp_cl_+3A_lower_bound">lower_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the lower bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_cl_+3A_upper_bound">upper_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the upper bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_cl_+3A_param_units">param_units</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the units for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_cl_+3A_restrictive">restrictive</code></td>
<td>
<p>A boolean value (Default: FALSE) that determines whether
to assume restrictive clearance when setting starting values for parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'Clint', 'kgutabs', 'Fgutabs', 'Q_totli', 'Q_gfr', 'Fup', and 'Rblood2plasma'.
Whether each one can be estimated from the data depends on which routes of administration
are included in the data.
</p>
<p># Constant parameters from 'httk'
'Q_totli' is the flow through the portal vein from the gut to the liver
and is estimated in this model via [httk::tissue.data] in a species-specific manner.
'Q_gfr' is the glomular filtration rate of kidneys. It is estimated via
[httk::physiology.data] in a species specific manner.
'Fup' and 'Rblood2plasma' are both calculated in [httk::parameterize_1comp()]
For each of these parameters default lower bounds are 10
</p>
<p># IV data, no oral data
</p>
<p>If IV dosing data are available, but no oral dosing data are available, then
only the parameters 'Vdist' and 'kelim' will be estimated from the data. The
parameters 'kgutabs' and 'Fgutabs' cannot be estimated from IV data alone, and
will not be used in evaluating the model.
</p>
<p># Oral data, no IV data
</p>
<p>If oral dosing data are available, but no IV dosing data are available, then
the parameters 'kelim' and 'kgutabs' can be estimated from the data. However,
the parameters 'Fgutabs' and 'Vdist' cannot be identified separately. From
oral data alone, only the ratio 'Fgutabs/Vdist' can be identified. This ratio
is represented by a single parameter named 'Fgutabs_Vdist'. 'Fgutabs' and
'Vdist' will not be used to evaluate the model nor be estimated from data, but
'Fgutabs_Vdist' will be estimated from data, along with 'kelim' and 'kgutabs'.
</p>
<p># Oral data and IV data
</p>
<p>If both oral and IV dosing data are available, then 'Vdist', 'kelim',
'kgutabs', and 'Fgutabs' will all be estimated from the data.
</p>
<p># Blood and plasma data
</p>
<p>If both blood and plasma data are available, then 'Rblood2plasma' will be
estimated from the data.
</p>
<p># Only one of blood or plasma data
</p>
<p>If only one of blood or plasma data are available, then 'Rblood2plasma' will be
held constant at 1, not estimated from the data.
</p>
<p># Default lower and upper bounds for each parameter
</p>
<p>## Default lower and upper bounds for 'kelim' and 'kgutabs'
</p>
<p>Default bounds for time constants 'kelim' and 'kgutabs' are set based on
the time scale of the available data.
</p>
<p>The lower bounds are based on the assumption that elimination and absorption
are very slow compared to the time scale of the study. Specifically, the
lower bounds assume that elimination and absorption half-lives are twice as
long as the duration of the available study data, or '2*max(Time_trans)'.
Under this assumption, the corresponding elimination and absorption time
constants would be 'log(2)/(2*max(Time_trans))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are 'log(2)/(2*max(Time_trans))'.
</p>
<p>Upper bounds are based on the opposite assumption: that elimination and
absorption are very fast compared to the time scale of the study.
Specifically, the upper bounds assume that the elimination and absorption
half-lives are half as long as the time of the first observation after time
0, or '0.5*min(Time_trans[Time_trans&gt;0])'. Under this asumption, the
corresponding elimination and absorption time constants would be
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'.
</p>
<p>## Default lower and upper bounds for 'Vdist'
</p>
<p>By default, the lower bound for 'Vdist' is 0.01, and the upper bound for
'Vdist' is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Fgutabs'
</p>
<p>By default, the lower bound for 'Fgutabs' is 0.0, and the upper bound for
'Fgutabs' is 1. These are simply the bounds of the physically-meaningful
range for a fraction.
</p>
<p>## Default lower and upper bounds for 'Fgutabs_Vdist'
</p>
<p>By default, the lower bound for the ratio 'Fgutabs_Vdist' is 0.01, and the
upper bound is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Rblood2plasma'
</p>
<p>By default, the lower bound for the blood:plasma partition coefficient
'Rblood2plasma' is 0.01, and the upper bound is 100. These values were chosen
based on professional judgment.
</p>
<p># Starting values for each parameter
</p>
<p>Starting values for each parameter (starting guesses for the numerical
optimizer) are derived from the data using [get_starts_1comp()].
</p>
<p>If the starting values returned by [get_starts_1comp()] fall outside the
bounds for any parameter(s), then the starting value will be reset to a value
halfway between the lower and upper bounds for that parameter.
</p>


<h3>Value</h3>

<p>A 'data.frame'with the following variables:
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter
- 'start': Numeric: The starting guesses for each parameter
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other get_params functions: 
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_params_1comp_fup'>Get parameters for 1-compartment model with clearance assumption</h2><span id='topic+get_params_1comp_fup'></span>

<h3>Description</h3>

<p>Get parameters for 1-compartment model and determine whether each is to be
estimated from the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params_1comp_fup(
  data,
  lower_bound = ggplot2::aes(Q_totli = NA, Q_gfr = NA, Fup = 0, Clint = 0, Vdist = 0.01,
    Fgutabs = 0, kgutabs = log(2)/(2 * max(Time_trans)), Fgutabs_Vdist = 0.01,
    Rblood2plasma = 0.01),
  upper_bound = ggplot2::aes(Q_totli = NA, Q_gfr = NA, Fup = 1, Clint = 1e+05, Vdist =
    100, Fgutabs = 1, kgutabs = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])),
    Fgutabs_Vdist = 100, Rblood2plasma = 100),
  param_units = ggplot2::aes(Q_totli = "L/h/kg ^3/4", Q_gfr = "L/h/kg ^3/4", Fup =
    "unitless fraction", Clint = "L/h/kg", Vdist = paste0("(", unique(Dose.Units), ")",
    "/", "(", unique(Conc.Units), ")"), Fgutabs = "unitless fraction", kgutabs =
    paste0("1/", unique(Time_trans.Units)), Fgutabs_Vdist = paste0("(",
    unique(Conc.Units), ")", "/", "(", unique(Dose.Units), ")"), Rblood2plasma =
    "unitless ratio")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_params_1comp_fup_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_params_1comp_fup_+3A_lower_bound">lower_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the lower bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_fup_+3A_upper_bound">upper_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the upper bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_1comp_fup_+3A_param_units">param_units</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the units for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'Clint', 'kgutabs', 'Fgutabs', 'Q_totli', 'Q_gfr', 'Fup', and 'Rblood2plasma'.
Whether each one can be estimated from the data depends on which routes of administration
are included in the data.
</p>
<p># Constant parameters from 'httk'
'Q_totli' is the flow through the portal vein from the gut to the liver
and is estimated in this model via [httk::tissue.data] in a species-specific manner.
'Q_gfr' is the glomular filtration rate of kidneys. It is estimated via
[httk::physiology.data] in a species specific manner.
'Fup' and 'Rblood2plasma' are both calculated in [httk::parameterize_1comp()]
For each of these parameters default lower bounds are 10
</p>
<p># IV data, no oral data
</p>
<p>If IV dosing data are available, but no oral dosing data are available, then
only the parameters 'Vdist' and 'kelim' will be estimated from the data. The
parameters 'kgutabs' and 'Fgutabs' cannot be estimated from IV data alone, and
will not be used in evaluating the model.
</p>
<p># Oral data, no IV data
</p>
<p>If oral dosing data are available, but no IV dosing data are available, then
the parameters 'kelim' and 'kgutabs' can be estimated from the data. However,
the parameters 'Fgutabs' and 'Vdist' cannot be identified separately. From
oral data alone, only the ratio 'Fgutabs/Vdist' can be identified. This ratio
is represented by a single parameter named 'Fgutabs_Vdist'. 'Fgutabs' and
'Vdist' will not be used to evaluate the model nor be estimated from data, but
'Fgutabs_Vdist' will be estimated from data, along with 'kelim' and 'kgutabs'.
</p>
<p># Oral data and IV data
</p>
<p>If both oral and IV dosing data are available, then 'Vdist', 'kelim',
'kgutabs', and 'Fgutabs' will all be estimated from the data.
</p>
<p># Blood and plasma data
</p>
<p>If both blood and plasma data are available, then 'Rblood2plasma' will be
estimated from the data.
</p>
<p># Only one of blood or plasma data
</p>
<p>If only one of blood or plasma data are available, then 'Rblood2plasma' will be
held constant at 1, not estimated from the data.
</p>
<p># Default lower and upper bounds for each parameter
</p>
<p>## Default lower and upper bounds for 'kelim' and 'kgutabs'
</p>
<p>Default bounds for time constants 'kelim' and 'kgutabs' are set based on
the time scale of the available data.
</p>
<p>The lower bounds are based on the assumption that elimination and absorption
are very slow compared to the time scale of the study. Specifically, the
lower bounds assume that elimination and absorption half-lives are twice as
long as the duration of the available study data, or '2*max(Time_trans)'.
Under this assumption, the corresponding elimination and absorption time
constants would be 'log(2)/(2*max(Time_trans))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are 'log(2)/(2*max(Time_trans))'.
</p>
<p>Upper bounds are based on the opposite assumption: that elimination and
absorption are very fast compared to the time scale of the study.
Specifically, the upper bounds assume that the elimination and absorption
half-lives are half as long as the time of the first observation after time
0, or '0.5*min(Time_trans[Time_trans&gt;0])'. Under this asumption, the
corresponding elimination and absorption time constants would be
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'. Therefore, the default lower
bounds for 'kelim' and 'kgutabs' are
'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'.
</p>
<p>## Default lower and upper bounds for 'Vdist'
</p>
<p>By default, the lower bound for 'Vdist' is 0.01, and the upper bound for
'Vdist' is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Fgutabs'
</p>
<p>By default, the lower bound for 'Fgutabs' is 0.0, and the upper bound for
'Fgutabs' is 1. These are simply the bounds of the physically-meaningful
range for a fraction.
</p>
<p>## Default lower and upper bounds for 'Fgutabs_Vdist'
</p>
<p>By default, the lower bound for the ratio 'Fgutabs_Vdist' is 0.01, and the
upper bound is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Rblood2plasma'
</p>
<p>By default, the lower bound for the blood:plasma partition coefficient
'Rblood2plasma' is 0.01, and the upper bound is 100. These values were chosen
based on professional judgment.
</p>
<p># Starting values for each parameter
</p>
<p>Starting values for each parameter (starting guesses for the numerical
optimizer) are derived from the data using [get_starts_1comp()].
</p>
<p>If the starting values returned by [get_starts_1comp()] fall outside the
bounds for any parameter(s), then the starting value will be reset to a value
halfway between the lower and upper bounds for that parameter.
</p>


<h3>Value</h3>

<p>A 'data.frame'with the following variables:
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter
- 'start': Numeric: The starting guesses for each parameter
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other get_params functions: 
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_params_2comp'>Get parameters for 2-compartment model</h2><span id='topic+get_params_2comp'></span>

<h3>Description</h3>

<p>Get parameters for 2-compartment model and determine whether each is to be
estimated from the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params_2comp(
  data,
  lower_bound = ggplot2::aes(kelim = log(2)/(2 * max(Time_trans)), k12 = log(2)/(2 *
    max(Time_trans)), k21 = log(2)/(2 * max(Time_trans)), V1 = 0.01, Fgutabs = 0, kgutabs
    = log(2)/(2 * max(Time_trans)), Fgutabs_V1 = 0.01, Rblood2plasma = 0.01),
  upper_bound = ggplot2::aes(kelim = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])), k12
    = log(2)/(0.5 * min(Time_trans[Time_trans &gt; 0])), k21 = log(2)/(0.5 *
    min(Time_trans[Time_trans &gt; 0])), V1 = 100, Fgutabs = 1, kgutabs = log(2)/(0.5 *
    min(Time_trans[Time_trans &gt; 0])), Fgutabs_V1 = 100, Rblood2plasma = 100),
  param_units = ggplot2::aes(kelim = paste0("1/", unique(Time_trans.Units)), V1 =
    paste0("(", unique(Dose.Units), ")", "/", "(", unique(Conc.Units), ")"), k21 =
    paste0("1/", unique(Time_trans.Units)), k12 = paste0("1/", unique(Time_trans.Units)),
    Fgutabs = "unitless fraction", kgutabs = paste0("1/", unique(Time_trans.Units)),
    Fgutabs_V1 = paste0("(", unique(Conc.Units), ")", "/", "(", unique(Dose.Units), ")"),
    Rblood2plasma = "unitless ratio")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_params_2comp_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_params_2comp_+3A_lower_bound">lower_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the lower bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_2comp_+3A_upper_bound">upper_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the upper bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_2comp_+3A_param_units">param_units</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the units for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full set of model parameters for the 2-compartment model includes 'V1',
'kelim', 'k12', 'k21', 'kgutabs','Fgutabs', and 'Rblood2plasma'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data.
</p>
<p>## IV data, no oral data
</p>
<p>If IV dosing data are available, but no oral dosing data are available, then
only the parameters 'V1', 'kelim', 'k12', and 'k21' will be estimated from
the data. The parameters 'kgutabs' and 'Fgutabs' cannot be estimated from IV
data alone.
</p>
<p>## Oral data, no IV data
</p>
<p>If oral dosing data are available, but no IV dosing data are available, then
the parameters 'kelim', 'k12', 'k21', and 'kgutabs' will be estimated from
the data. However, the parameters 'Fgutabs' and 'V1' cannot be identified
separately. From oral data alone, only the ratio 'Fgutabs/V1' can be
identified. This ratio is represented by a single parameter named
'Fgutabs_V1'. 'Fgutabs' and 'V1' will not be optimized, but 'Fgutabs_V1' will
be optimized, along with 'kelim', 'k12', 'k21', and 'kgutabs'.
</p>
<p>## Oral data and IV data
</p>
<p>If both oral and IV dosing data are available, then 'V1', 'kelim', 'k12',
'k21', 'kgutabs', and 'Fgutabs' will all be estimated from the data.
</p>
<p># Blood and plasma data
</p>
<p>If both blood and plasma data are available, then 'Rblood2plasma' will be
estimated from the data.
</p>
<p># Only one of blood or plasma data
</p>
<p>If only one of blood or plasma data are available, then 'Rblood2plasma' will be
held constant at 1, not estimated from the data.
</p>
<p># Default lower and upper bounds for each parameter
</p>
<p>## Default lower and upper bounds for time constants 'kelim', 'kgutabs',
'k12', and 'k21'.
</p>
<p>Default bounds for time constants 'kelim' and 'kgutabs' are set based on
the time scale of the available data.
</p>
<p>The lower bounds are based on the assumption that elimination, absorption,
and distribution are very slow compared to the time scale of the study.
Specifically, the lower bounds assume thatelimination, absorption, and
distribution half-lives are twice as long as the duration of the available
study data, or '2*max(Time_trans)'. Under this assumption, the corresponding
elimination, absorption, and distribution time constants would be
'log(2)/(2*max(Time_trans))'. Therefore, the default lower bounds for
'kelim', 'kgutabs', 'k12', and 'k21' are 'log(2)/(2*max(Time_trans))'.
</p>
<p>Upper bounds are based on the opposite assumption: that elimination,
absorption, and distribution are very fast compared to the time scale of the
study. Specifically, the upper bounds assume that the elimination,
absorption, and distribution half-lives are half as long as the time of the
first observation after time 0, or '0.5*min(Time_trans[Time_trans&gt;0])'. Under
this assumption, the correspondingelimination, absorption, and distribution
time constants would be 'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'.
Therefore, the default lower bounds for 'kelim', 'kgutabs', 'k12', and 'k21'
are 'log(2)/(0.5*min(Time_trans[Time_trans&gt;0]))'.
</p>
<p>## Default lower and upper bounds for 'V1'
</p>
<p>By default, the lower bound for 'V1' is 0.01, and the upper bound for
'V1' is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Fgutabs'
</p>
<p>By default, the lower bound for 'Fgutabs' is 0.0, and the upper bound for
'Fgutabs' is 1. These are simply the bounds of the physically-meaningful
range for a fraction.
</p>
<p>## Default lower and upper bounds for 'Fgutabs_V1'
</p>
<p>By default, the lower bound for the ratio 'Fgutabs_V1' is 0.01, and the
upper bound is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Rblood2plasma'
</p>
<p>By default, the lower bound for the blood:plasma partition coefficient
'Rblood2plasma' is 0.01, and the upper bound is 100. These values were chosen
based on professional judgment.
</p>
<p># Starting values for each parameter
</p>
<p>Starting values for each parameter (starting guesses for the numerical
optimizer) are derived from the data using [get_starts_2comp()].
</p>
<p>If the starting values returned by [get_starts_2comp()] fall outside the
bounds for any parameter(s), then the starting value will be reset to a value
halfway between the lower and upper bounds for that parameter.
</p>


<h3>Value</h3>

<p>A 'data.frame'with the following variables:
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter
- 'start': Numeric: The starting guesses for each parameter
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other get_params functions: 
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_params_flat'>Get parameters to be optimized for flat model</h2><span id='topic+get_params_flat'></span>

<h3>Description</h3>

<p>The full set of model parameters for the flat model includes
'Vdist', 'Fgutabs', and 'Rblood2plasma'. Whether each one can be estimated
from the data depends on what routes of administration are included in the
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_params_flat(
  data,
  lower_bound = ggplot2::aes(Vdist = 0.01, Fgutabs = 0, Fgutabs_Vdist = 0.01,
    Rblood2plasma = 0.01),
  upper_bound = ggplot2::aes(Vdist = 100, Fgutabs = 1, Fgutabs_Vdist = 100, Rblood2plasma
    = 100),
  param_units = ggplot2::aes(Vdist = paste0("(", unique(Dose.Units), ")", "/", "(",
    unique(Conc.Units), ")"), Fgutabs = "unitless fraction", Fgutabs_Vdist = paste0("(",
    unique(Conc.Units), ")", "/", "(", unique(Dose.Units), ")"), Rblood2plasma =
    "unitless ratio")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_params_flat_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_params_flat_+3A_lower_bound">lower_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the lower bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_flat_+3A_upper_bound">upper_bound</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the upper bounds for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
<tr><td><code id="get_params_flat_+3A_param_units">param_units</code></td>
<td>
<p>A mapping specified using a call to [ggplot2::aes()],
giving the units for each variable, as expressions which may include
variables in 'data'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>## IV data, no oral data
</p>
<p>If IV dosing data are available, but no oral dosing data are available, then
only the parameter 'Vdist' will be estimated from the data. The
parameter 'Fgutabs' cannot be estimated from IV data alone and will not be used to evaluate the model.
</p>
<p>## Oral data, no IV data
</p>
<p>If oral dosing data are available, but no IV dosing data are available, then
the parameters 'Fgutabs' and 'Vdist' cannot be identified separately. From
oral data alone, only the ratio 'Fgutabs/Vdist' can be identified. This ratio
is represented by a single parameter named 'Fgutabs_Vdist'. 'Fgutabs' and
'Vdist' will not be estimated nor used in model evaluation, but 'Fgutabs_Vdist' will be estimated.
</p>
<p>## Oral data and IV data
</p>
<p>If both oral and IV dosing data are available, then 'Vdist' and 'Fgutabs' will both be estimated from the data.
</p>
<p># Blood and plasma data
</p>
<p>If both blood and plasma data are available, then 'Rblood2plasma' will be estimated from the data.
</p>
<p># Only one of blood or plasma data
</p>
<p>If only one of blood or plasma data are available, then 'Rblood2plasma' will be
held constant at 1, not estimated from the data.
</p>
<p># Default lower and upper bounds for each parameter
</p>
<p>## Default lower and upper bounds for 'Vdist'
</p>
<p>By default, the lower bound for 'Vdist' is 0.01, and the upper bound for
'Vdist' is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Fgutabs'
</p>
<p>By default, the lower bound for 'Fgutabs' is 0.0, and the upper bound for
'Fgutabs' is 1. These are simply the bounds of the physically-meaningful
range for a fraction.
</p>
<p>## Default lower and upper bounds for 'Fgutabs_Vdist'
</p>
<p>By default, the lower bound for the ratio 'Fgutabs_Vdist' is 0.01, and the
upper bound is 100. These values were chosen based on professional judgment.
</p>
<p>## Default lower and upper bounds for 'Rblood2plasma'
</p>
<p>By default, the lower bound for the blood:plasma partition coefficient
'Rblood2plasma' is 0.01, and the upper bound is 100. These values were chosen
based on professional judgment.
</p>
<p># Starting values for each parameter
</p>
<p>Starting values for each parameter (starting guesses for the numerical
optimizer) are derived from the data using [get_starts_flat()].
</p>
<p>If the starting values returned by [get_starts_flat()] fall outside the
bounds for any parameter(s), then the starting value will be reset to a value
halfway between the lower and upper bounds for that parameter.
</p>


<h3>Value</h3>

<p>A 'data.frame'with the following variables:
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter
- 'start': Numeric: The starting guesses for each parameter
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other flat model functions: 
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other get_params functions: 
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_peak'>Find the peak of a data series</h2><span id='topic+get_peak'></span>

<h3>Description</h3>

<p>Finds x- and y-value at peak y value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_peak(x, y, ties = "median", na.rm = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_peak_+3A_x">x</code></td>
<td>
<p>A numeric vector of 'x' data</p>
</td></tr>
<tr><td><code id="get_peak_+3A_y">y</code></td>
<td>
<p>A numeric vector of 'y' data</p>
</td></tr>
<tr><td><code id="get_peak_+3A_ties">ties</code></td>
<td>
<p>As for [stats::approxfun()]: The function to apply to y-values
that have the same x-value. Default ''median'&lsquo;. '&rsquo;mean'' may also be
useful.</p>
</td></tr>
<tr><td><code id="get_peak_+3A_na.rm">na.rm</code></td>
<td>
<p>As for [stats::approxfun()]: How to handle missing values.
Default 'TRUE' to exclude missing values from analysis.</p>
</td></tr>
<tr><td><code id="get_peak_+3A_...">...</code></td>
<td>
<p>Optional: Additional arguments which will be passed to
[stats::approx()] (other than 'x', 'y', and 'xout').</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there is more than one unique 'x' value where both 'x' and corresponding
&lsquo;y' are finite, this function calls [stats::approx()] with 'method = &rsquo;linear'', then uses
[base::which.max()] to locate the maximum interpolated 'y'-value.
</p>
<p>If there is only one unique 'x' value where both 'x' and corresponding 'y'
are finite, this function calls [stats::approx()] with &lsquo;method = &rsquo;constant'', then uses
[base::which.max()] to locate the maximum interpolated 'y'-value.
</p>
<p>If there are no unique 'x' values where both 'x' and corresponding 'y' are
finite, this function returns 'NA_real_' for the peak 'x' and 'y' values.
</p>


<h3>Value</h3>

<p>A list with two named numeric scalar components, 'x' and 'y',
containing the x- and y-values at the peak.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_prefit'>get_prefit()</h2><span id='topic+get_prefit'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_prefit()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_prefit_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_prefit_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of &lsquo;data.frame's in the object&rsquo;s 'prefit' element.
</p>


<h3>See Also</h3>

<p>[get_prefit.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_prefit.default'>Default method for get_prefit()</h2><span id='topic+get_prefit.default'></span>

<h3>Description</h3>

<p>Default method for get_prefit()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_prefit.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_prefit.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_prefit.pk'>Get prefit</h2><span id='topic+get_prefit.pk'></span>

<h3>Description</h3>

<p>Extract pre-fitting results from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_prefit(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_prefit.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object that has had 'do_prefit()' run on it</p>
</td></tr>
<tr><td><code id="get_prefit.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of &lsquo;data.frame's in the object&rsquo;s 'prefit' element.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_scale_conc'>get_scale_conc()</h2><span id='topic+get_scale_conc'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_scale_conc()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_scale_conc(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_conc_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_scale_conc_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list': 'obj$scales$conc'
</p>


<h3>See Also</h3>

<p>[get_scale_conc.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_scale_conc.default'>Default method for get_scale_conc()</h2><span id='topic+get_scale_conc.default'></span>

<h3>Description</h3>

<p>Default method for get_scale_conc()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_scale_conc(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_conc.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_scale_conc.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_scale_conc.pk'>Get scale_conc</h2><span id='topic+get_scale_conc.pk'></span>

<h3>Description</h3>

<p>Extract concentration scale/transformation instructions from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_scale_conc(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_conc.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_scale_conc.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list': 'obj$scales$conc'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_scale_time'>get_scale_time()</h2><span id='topic+get_scale_time'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_scale_time()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_scale_time(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_time_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_scale_time_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list': 'obj$scales$time'
</p>


<h3>See Also</h3>

<p>[get_scale_time.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_scale_time.default'>Default method for get_scale_time()</h2><span id='topic+get_scale_time.default'></span>

<h3>Description</h3>

<p>Default method for get_scale_time()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_scale_time(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_time.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_scale_time.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_scale_time.pk'>Get scale_time</h2><span id='topic+get_scale_time.pk'></span>

<h3>Description</h3>

<p>Extract time scale/transformation instructions from a [pk()] object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_scale_time(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_scale_time.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_scale_time.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list': 'obj$scales$time'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_settings_data_info'>get_settings_data_info()</h2><span id='topic+get_settings_data_info'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_settings_data_info()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_settings_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_data_info_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_settings_data_info_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the data_info settings
</p>


<h3>See Also</h3>

<p>[get_settings_data_info.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_settings_data_info.default'>Default method for get_settings_data_info()</h2><span id='topic+get_settings_data_info.default'></span>

<h3>Description</h3>

<p>Default method for get_settings_data_info()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_settings_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_data_info.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_settings_data_info.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_settings_data_info.pk'>Get settings_data_info</h2><span id='topic+get_settings_data_info.pk'></span>

<h3>Description</h3>

<p>Get settings_data_info
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_settings_data_info(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_data_info.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_settings_data_info.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the data_info settings
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_settings_optimx'>get_settings_optimx()</h2><span id='topic+get_settings_optimx'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_settings_optimx()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_settings_optimx(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_optimx_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_settings_optimx_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the optimx settings
</p>


<h3>See Also</h3>

<p>[get_settings_optimx.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_settings_optimx.default'>Default method for get_settings_optimx()</h2><span id='topic+get_settings_optimx.default'></span>

<h3>Description</h3>

<p>Default method for get_settings_optimx()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_settings_optimx(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_optimx.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_settings_optimx.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_settings_optimx.pk'>Get settings_optimx</h2><span id='topic+get_settings_optimx.pk'></span>

<h3>Description</h3>

<p>Get settings_optimx
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_settings_optimx(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_optimx.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_settings_optimx.pk_+3A_...">...</code></td>
<td>
<p>Additional arguents not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the optimx settings
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_settings_preprocess'>get_settings_preprocess()</h2><span id='topic+get_settings_preprocess'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_settings_preprocess()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_settings_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_preprocess_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_settings_preprocess_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the preprocessing settings
</p>


<h3>See Also</h3>

<p>[get_settings_preprocess.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_settings_preprocess.default'>Default method for get_settings_preprocess()</h2><span id='topic+get_settings_preprocess.default'></span>

<h3>Description</h3>

<p>Default method for get_settings_preprocess()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_settings_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_preprocess.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_settings_preprocess.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_settings_preprocess.pk'>Get settings_preprocess</h2><span id='topic+get_settings_preprocess.pk'></span>

<h3>Description</h3>

<p>Get settings_preprocess
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_settings_preprocess(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_settings_preprocess.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_settings_preprocess.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the preprocessing settings
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_starts_1comp'>Get starting values for 1-compartment model</h2><span id='topic+get_starts_1comp'></span>

<h3>Description</h3>

<p>Derive starting values for 1-compartment model parameters from available data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_starts_1comp(data, par_DF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_starts_1comp_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_starts_1comp_+3A_par_df">par_DF</code></td>
<td>
<p>A 'data.frame' with the following variables (e.g., as produced by [get_params_1comp()])
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called internally by [get_params_1comp()] and should
generally not be called directly by the user.
</p>
<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'kelim', 'kgutabs', 'Fgutabs', and 'Rblood2plasma'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data.
</p>
<p>The numerical optimizer requires starting guesses for the value of each
parameter to be estimated from the data. Default starting guesses are derived from the available data.
</p>
<p>These are intended to be *very* rough starting guesses, so the algorithm here
is extremely naive. This function is not itself intended to produce valid
estimates for any of the model parameters, and it is highly unlikely to do so.
</p>
<p>The derivation process is as follows.
</p>
<p>First, data are filtered to exclude any non-detects.
</p>
<p>Then, data are split by route of administration, into an IV data set and an oral data
set. (It is possible that either IV or oral data may not be
available for a chemical.)
</p>
<p># Starting value for 'kelim'
</p>
<p>If IV data exist, then only IV data are used to derive starting estimates for
'kelim', even if oral data also exist.
</p>
<p>If only oral data exist, then the oral data are used to derive a starting
estimate for 'kelim'.
</p>
<p>Whichever data set is used (IV or oral), the starting value for 'kelim' is
derived by assuming that the range of observed time values in the data set
spans two elimination half-lives. This implies that the elimination half-life
is equal to the midpoint of observed time values, and that the starting value
for the elimination time constant 'kelim' is therefore 'log(2)' divided by the
midpoint of observed time values.
</p>
<p>Of course, this assumption is unlikely to be correct. However, we hope that it
will yield a starting guess for 'kelim' that is at least on the right order of
magnitude.
</p>
<p># Starting value for 'Vdist'
</p>
<p>If IV data exist, then only IV data are used to derive a starting estimate
for 'Vdist'.
</p>
<p>This starting estimate is derived by assuming that the IV data obey a
one-compartment model, which means that when concentrations are
dose-normalized and log10-transformed and plotted against time, they will
follow a straight line with slope '-kelim'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>From all observations at the earliest observed time point in the data set
(call it 'tmin'), the median of the dose-normalized, log10-transformed
concentrations is calculated; call it 'C_tmin'. (The median is used, rather
than the mean, in an attempt to be more robust to outliers.)
</p>
<p>If the earliest observed time point is not at time = 0, then the
dose-normalized, log10-transformed concentration at time = 0 is extrapolated
by drawing a straight line with slope '-kelim' back from 'C_tmin', where the
value of 'kelim' is the starting value derived as in the previous section.
</p>
<p>This extrapolated concentration at time t = 0 is called 'A_log10'. 'A_log10'
represents the expected body concentration immediately after IV injection of
a unit dose (under the assumption that TK obeys a one-compartment model).
</p>
<p>Then, the volume of distribution 'Vdist' is derived as '1/(10^A_log10)'. In
other words, 'Vdist' is the volume that would be required to produce a
concentration equal to 'A_log10' after injecting a unit dose.
</p>
<p>(No starting value for 'Vdist' can be derived with only oral data,
but none is needed, because with only oral data, 'Vdist' will not be estimated
from the data).
</p>
<p># Starting value for 'kgutabs'
</p>
<p>If oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'kgutabs'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>The time of peak concentration ('tmax'), and the median (normalized,
log-transformed) peak concentration ('Cmax_log10'), are identified using [get_peak()].
</p>
<p>As a very rough guess,'tmax' is assumed to
occur at one absorption half-life. Under this assumption, 'kgutabs' is equal
to 'log(2)/tmax', and this is taken as the starting value.
</p>
<p># Starting value for 'Fgutabs_Vdist'
</p>
<p>If any oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'Fgutabs_Vdist'.
</p>
<p>If the kinetics obey a one-compartment model, then if concentrations are
dose-normalized, log-transformed, and plotted vs. time, then at late time
points (after concentration has peaked), the concentration vs. time
relationship will approach a straight line with slope '-kelim'.
</p>
<p>If this straight line is extrapolated back to time 0, then the resulting
intercept (call it 'A'), expressed on the natural scale, is equal to
'Fgutabs_Vdist * kgutabs/(kgutabs-kelim)'. See
https://www.boomer.org/c/p4/c09/c0902.php .
</p>
<p>Roughly, we approximate 'A' on the log10 scale by extrapolating back from the peak along a
straight line with slope '-kelim', using the previously-derived starting
value for 'kelim'. So 'log10(A) = Cmax_log10 + kelim*tmax'.
</p>
<p>Using the previously-derived starting values for 'kgutabs' and 'kelim', then,
the starting value for 'Fgutabs_Vdist' can be derived as 'A * (kgutabs-kelim)/kgutabs'.
</p>
<p># Starting value for 'Fgutabs'
</p>
<p>If both oral and IV data exist, then the derived starting values for 'Vdist'
(from the IV data) and 'Fgutabs_Vdist' (from the oral data) are multiplied to
yield a derived starting value for 'Fgutabs'.
</p>
<p>#Starting value for 'Rblood2plasma'
</p>
<p>The starting value for 'Rblood2plasma' is always set at a constant 1.
</p>


<h3>Value</h3>

<p>The same 'data.frame' as 'par_DF', with an additional variable
'starts' containing the derived starting value for each parameter. If a
parameter cannot be estimated from the available data, then its starting value
will be 'NA_real_'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other get_starts functions: 
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_starts_1comp_cl'>Get starting values for 1-compartment model with specific clearance</h2><span id='topic+get_starts_1comp_cl'></span>

<h3>Description</h3>

<p>Derive starting values for 1-compartment model parameters from available data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_starts_1comp_cl(data, par_DF, restrictive)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_starts_1comp_cl_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_starts_1comp_cl_+3A_par_df">par_DF</code></td>
<td>
<p>A 'data.frame' with the following variables (e.g., as produced by [get_params_1comp()])
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter</p>
</td></tr>
<tr><td><code id="get_starts_1comp_cl_+3A_restrictive">restrictive</code></td>
<td>
<p>A boolean value determinining whether to assume restrictive
or non-restrictive clearance when getting starting values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called internally by [get_params_1comp()] and should
generally not be called directly by the user.
</p>
<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'kelim', 'kgutabs', 'Fgutabs', and 'Rblood2plasma'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data. However, in this version of the one-compartment model,
we use the liver and glomerular flow rates ('Q_totli' and 'Q_gfr', respectively)
provided by [httk] as well as intrisic clearance 'Clint' and fraction unbound
in plasma, 'Fup'. These starting values are established and then are used
to calculate the other parameters in the 1-compartment model.
</p>
<p>The numerical optimizer requires starting guesses for the value of each
parameter to be estimated from the data. Default starting guesses are derived from the available data.
</p>
<p>These are intended to be *very* rough starting guesses, so the algorithm here
is extremely naive. This function is not itself intended to produce valid
estimates for any of the model parameters, and it is highly unlikely to do so.
</p>
<p>The derivation process is as follows.
</p>
<p>First, data are filtered to exclude any non-detects.
</p>
<p>Then, data are split by route of administration, into an IV data set and an oral data
set. (It is possible that either IV or oral data may not be
available for a chemical.)
</p>
<p># Starting value for 'kelim'
</p>
<p>If IV data exist, then only IV data are used to derive starting estimates for
'kelim', even if oral data also exist.
</p>
<p>If only oral data exist, then the oral data are used to derive a starting
estimate for 'kelim'.
</p>
<p>Whichever data set is used (IV or oral), the starting value for 'kelim' is
derived by assuming that the range of observed time values in the data set
spans two elimination half-lives. This implies that the elimination half-life
is equal to the midpoint of observed time values, and that the starting value
for the elimination time constant 'kelim' is therefore 'log(2)' divided by the
midpoint of observed time values.
</p>
<p>Of course, this assumption is unlikely to be correct. However, we hope that it
will yield a starting guess for 'kelim' that is at least on the right order of
magnitude.
</p>
<p># Starting value for 'Vdist'
</p>
<p>Using a calculated value for total clearance, 'Cl_tot', 'Vdist' is estimated
by dividing this by the estimation of 'kelim'.
</p>
<p># Starting value for 'kgutabs'
</p>
<p>If oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'kgutabs'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>The time of peak concentration ('tmax'), and the median (normalized,
log-transformed) peak concentration ('Cmax_log10'), are identified using [get_peak()].
</p>
<p>As a very rough guess,'tmax' is assumed to
occur at one absorption half-life. Under this assumption, 'kgutabs' is equal
to 'log(2)/tmax', and this is taken as the starting value.
</p>
<p># Starting value for 'Fgutabs_Vdist'
</p>
<p>If any oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'Fgutabs_Vdist'.
</p>
<p>If the kinetics obey a one-compartment model, then if concentrations are
dose-normalized, log-transformed, and plotted vs. time, then at late time
points (after concentration has peaked), the concentration vs. time
relationship will approach a straight line with slope '-kelim'.
</p>
<p>If this straight line is extrapolated back to time 0, then the resulting
intercept (call it 'A'), expressed on the natural scale, is equal to
'Fgutabs_Vdist * kgutabs/(kgutabs-kelim)'. See
https://www.boomer.org/c/p4/c09/c0902.php .
</p>
<p>Roughly, we approximate 'A' on the log10 scale by extrapolating back from the peak along a
straight line with slope '-kelim', using the previously-derived starting
value for 'kelim'. So 'log10(A) = Cmax_log10 + kelim*tmax'.
</p>
<p>Using the previously-derived starting values for 'kgutabs' and 'kelim', then,
the starting value for 'Fgutabs_Vdist' can be derived as 'A * (kgutabs-kelim)/kgutabs'.
</p>
<p># Starting value for 'Fgutabs'
</p>
<p>If both oral and IV data exist, then the derived starting values for 'Vdist'
(from the IV data) and 'Fgutabs_Vdist' (from the oral data) are multiplied to
yield a derived starting value for 'Fgutabs'.
</p>
<p>#Starting value for 'Rblood2plasma'
</p>
<p>The starting value for 'Rblood2plasma' is set to the value given by [httk::parameterize_gas_pbtk()].
</p>


<h3>Value</h3>

<p>The same 'data.frame' as 'par_DF', with an additional variable
'starts' containing the derived starting value for each parameter. If a
parameter cannot be estimated from the available data, then its starting value
will be 'NA_real_'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>
</p>
<p>Other get_starts functions: 
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_starts_1comp_fup'>Get starting values for 1-compartment model with specific clearance</h2><span id='topic+get_starts_1comp_fup'></span>

<h3>Description</h3>

<p>Derive starting values for 1-compartment model parameters from available data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_starts_1comp_fup(data, par_DF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_starts_1comp_fup_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_starts_1comp_fup_+3A_par_df">par_DF</code></td>
<td>
<p>A 'data.frame' with the following variables (e.g., as produced by [get_params_1comp()])
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called internally by [get_params_1comp()] and should
generally not be called directly by the user.
</p>
<p>The full set of model parameters for the 1-compartment model includes 'Vdist',
'kelim', 'kgutabs', 'Fgutabs', and 'Rblood2plasma'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data. However, in this version of the one-compartment model,
we use the liver and glomerular flow rates ('Q_totli' and 'Q_gfr', respectively)
provided by [httk] as well as intrisic clearance 'Clint' and fraction unbound
in plasma, 'Fup'. These starting values are established and then are used
to calculate the other parameters in the 1-compartment model.
</p>
<p>The numerical optimizer requires starting guesses for the value of each
parameter to be estimated from the data. Default starting guesses are derived from the available data.
</p>
<p>These are intended to be *very* rough starting guesses, so the algorithm here
is extremely naive. This function is not itself intended to produce valid
estimates for any of the model parameters, and it is highly unlikely to do so.
</p>
<p>The derivation process is as follows.
</p>
<p>First, data are filtered to exclude any non-detects.
</p>
<p>Then, data are split by route of administration, into an IV data set and an oral data
set. (It is possible that either IV or oral data may not be
available for a chemical.)
</p>
<p># Starting value for 'kelim'
</p>
<p>If IV data exist, then only IV data are used to derive starting estimates for
'kelim', even if oral data also exist.
</p>
<p>If only oral data exist, then the oral data are used to derive a starting
estimate for 'kelim'.
</p>
<p>Whichever data set is used (IV or oral), the starting value for 'kelim' is
derived by assuming that the range of observed time values in the data set
spans two elimination half-lives. This implies that the elimination half-life
is equal to the midpoint of observed time values, and that the starting value
for the elimination time constant 'kelim' is therefore 'log(2)' divided by the
midpoint of observed time values.
</p>
<p>Of course, this assumption is unlikely to be correct. However, we hope that it
will yield a starting guess for 'kelim' that is at least on the right order of
magnitude.
</p>
<p># Starting value for 'Vdist'
</p>
<p>Using a calculated value for total clearance, 'Cl_tot', 'Vdist' is estimated
by dividing this by the estimation of 'kelim'.
</p>
<p># Starting value for 'kgutabs'
</p>
<p>If oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'kgutabs'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>The time of peak concentration ('tmax'), and the median (normalized,
log-transformed) peak concentration ('Cmax_log10'), are identified using [get_peak()].
</p>
<p>As a very rough guess,'tmax' is assumed to
occur at one absorption half-life. Under this assumption, 'kgutabs' is equal
to 'log(2)/tmax', and this is taken as the starting value.
</p>
<p># Starting value for 'Fgutabs_Vdist'
</p>
<p>If any oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'Fgutabs_Vdist'.
</p>
<p>If the kinetics obey a one-compartment model, then if concentrations are
dose-normalized, log-transformed, and plotted vs. time, then at late time
points (after concentration has peaked), the concentration vs. time
relationship will approach a straight line with slope '-kelim'.
</p>
<p>If this straight line is extrapolated back to time 0, then the resulting
intercept (call it 'A'), expressed on the natural scale, is equal to
'Fgutabs_Vdist * kgutabs/(kgutabs-kelim)'. See
https://www.boomer.org/c/p4/c09/c0902.php .
</p>
<p>Roughly, we approximate 'A' on the log10 scale by extrapolating back from the peak along a
straight line with slope '-kelim', using the previously-derived starting
value for 'kelim'. So 'log10(A) = Cmax_log10 + kelim*tmax'.
</p>
<p>Using the previously-derived starting values for 'kgutabs' and 'kelim', then,
the starting value for 'Fgutabs_Vdist' can be derived as 'A * (kgutabs-kelim)/kgutabs'.
</p>
<p># Starting value for 'Fgutabs'
</p>
<p>If both oral and IV data exist, then the derived starting values for 'Vdist'
(from the IV data) and 'Fgutabs_Vdist' (from the oral data) are multiplied to
yield a derived starting value for 'Fgutabs'.
</p>
<p>#Starting value for 'Rblood2plasma'
</p>
<p>The starting value for 'Rblood2plasma' is set to the value given by [httk::parameterize_gas_pbtk()].
</p>


<h3>Value</h3>

<p>The same 'data.frame' as 'par_DF', with an additional variable
'starts' containing the derived starting value for each parameter. If a
parameter cannot be estimated from the available data, then its starting value
will be 'NA_real_'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 1-compartment model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>
</p>
<p>Other get_starts functions: 
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_starts_2comp'>Get starting values for 2-compartment model</h2><span id='topic+get_starts_2comp'></span>

<h3>Description</h3>

<p>Derive starting values for 2-compartment model parameters from available data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_starts_2comp(data, par_DF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_starts_2comp_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_starts_2comp_+3A_par_df">par_DF</code></td>
<td>
<p>A 'data.frame' with the following variables (e.g., as produced by [get_params_2comp()])
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called internally by [get_params_2comp()] and should
generally not be called directly by the user.
</p>
<p>The full set of model parameters for the 2-compartment model includes 'V1',
'kelim', 'k12', 'k21', 'kgutabs', and 'Fgutabs'. Whether each one can be
estimated from the data depends on what routes of administration are included
in the data.
</p>
<p>The numerical optimizer requires starting guesses for the value of each
parameter to be estimated from the data. Default starting guesses are derived from the available data.
</p>
<p>These are intended to be *very* rough starting guesses, so the algorithm here
is extremely naive. This function is not itself intended to produce valid
estimates for any of the model parameters, and it is highly unlikely to do so.
</p>
<p>At present, the starting guesses for the 2-compartment model are derived in
the same way as for the 1-compartment model, for the parameters that are
common to both. That is, the data are assumed to obey a 1-compartment model to
derive starting guesses for 'kelim', 'V1', 'kgutabs', 'Fgutabs_V1', and
'Fgutabs'.
</p>
<p>Then, starting values for 'k12' and 'k21' are arbitrarily set to
0.1 and 0.5, respectively.
</p>
<p>The following description of the derivation process is therefore identical to
that for [get_starts_1comp()].
</p>
<p>The derivation process
</p>
<p>First, data are filtered to exclude any non-detects.
</p>
<p>Then, data are split by route of administration, into an IV data set and an oral data
set. (It is possible that either IV or oral data may not be
available for a chemical.)
</p>
<p># Starting value for 'kelim'
</p>
<p>If IV data exist, then only IV data are used to derive starting estimates for
'kelim', even if oral data also exist.
</p>
<p>If only oral data exist, then the oral data are used to derive a starting
estimate for 'kelim'.
</p>
<p>Whichever data set is used (IV or oral), the starting value for 'kelim' is
derived by assuming that the range of observed time values in the data set
spans two elimination half-lives. This implies that the elimination half-life
is equal to the midpoint of observed time values, and that the starting value
for the elimination time constant 'kelim' is therefore 'log(2)' divided by the
midpoint of observed time values.
</p>
<p>Of course, this assumption is unlikely to be correct. However, we hope that it
will yield a starting guess for 'kelim' that is at least on the right order of
magnitude.
</p>
<p># Starting value for 'V1'
</p>
<p>If IV data exist, then only IV data are used to derive a starting estimate
for 'V1'.
</p>
<p>This starting estimate is derived by assuming that the IV data obey a
one-compartment model, which means that when concentrations are
dose-normalized and log10-transformed and plotted against time, they will
follow a straight line with slope '-kelim'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>From all observations at the earliest observed time point in the data set
(call it 'tmin'), the median of the dose-normalized, log10-transformed
concentrations is calculated; call it 'C_tmin'. (The median is used, rather
than the mean, in an attempt to be more robust to outliers.)
</p>
<p>If the earliest observed time point is not at time = 0, then the
dose-normalized, log10-transformed concentration at time = 0 is extrapolated
by drawing a straight line with slope '-kelim' back from 'C_tmin', where the
value of 'kelim' is the starting value derived as in the previous section.
</p>
<p>This extrapolated concentration at time t = 0 is called 'A_log10'. 'A_log10'
represents the expected body concentration immediately after IV injection of
a unit dose (under the assumption that TK obeys a one-compartment model).
</p>
<p>Then, the volume of distribution 'V1' is derived as '1/(10^A_log10)'. In
other words, 'V1' is the volume that would be required to produce a
concentration equal to 'A_log10' after injecting a unit dose.
</p>
<p>(No starting value for 'V1' can be derived with only oral data,
but none is needed, because with only oral data, 'V1' will not be estimated
from the data).
</p>
<p># Starting value for 'kgutabs'
</p>
<p>If oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'kgutabs'.
</p>
<p>First, concentrations are dose-normalized by dividing them by their corresponding
doses. Then the normalized concentrations are log10-transformed.
</p>
<p>The time of peak concentration ('tmax'), and the median (normalized,
log-transformed) peak concentration ('Cmax_log10'), are identified using [get_peak()].
</p>
<p>As a very rough guess,'tmax' is assumed to
occur at one absorption half-life. Under this assumption, 'kgutabs' is equal
to 'log(2)/tmax', and this is taken as the starting value.
</p>
<p># Starting value for 'Fgutabs_V1'
</p>
<p>If any oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'Fgutabs_V1'.
</p>
<p>If the kinetics obey a one-compartment model, then if concentrations are
dose-normalized, log-transformed, and plotted vs. time, then at late time
points (after concentration has peaked), the concentration vs. time
relationship will approach a straight line with slope '-kelim'.
</p>
<p>If this straight line is extrapolated back to time 0, then the resulting
intercept (call it 'A'), expressed on the natural scale, is equal to
'Fgutabs_V1 * kgutabs/(kgutabs-kelim)'. See
https://www.boomer.org/c/p4/c09/c0902.php .
</p>
<p>Roughly, we approximate 'A' on the log10 scale by extrapolating back from the peak along a
straight line with slope '-kelim', using the previously-derived starting
value for 'kelim'. So 'log10(A) = Cmax_log10 + kelim*tmax'.
</p>
<p>Using the previously-derived starting values for 'kgutabs' and 'kelim', then,
the starting value for 'Fgutabs_V1' can be derived as 'A * (kgutabs-kelim)/kgutabs'.
</p>
<p># Starting value for 'Fgutabs'
</p>
<p>If both oral and IV data exist, then the derived starting values for 'V1'
(from the IV data) and 'Fgutabs_V1' (from the oral data) are multiplied to
yield a derived starting value for 'Fgutabs'.
#Starting value for 'Rblood2plasma'
</p>
<p>The starting value for 'Rblood2plasma' is always set at a constant 1.
</p>


<h3>Value</h3>

<p>The same 'data.frame' as 'par_DF', with an additional variable
'starts' containing the derived starting value for each parameter. If a
parameter cannot be estimated from the available data, then its starting value
will be 'NA_real_'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other get_starts functions: 
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_starts_flat'>Get starting values for flat model</h2><span id='topic+get_starts_flat'></span>

<h3>Description</h3>

<p>Derive starting values for flat model parameters from available data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_starts_flat(data, par_DF)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_starts_flat_+3A_data">data</code></td>
<td>
<p>The data set to be fitted (e.g. the result of [preprocess_data()])</p>
</td></tr>
<tr><td><code id="get_starts_flat_+3A_par_df">par_DF</code></td>
<td>
<p>A 'data.frame' with the following variables (e.g., as produced by [get_params_flat()])
- 'param_name': Character: Names of the model parameters
- 'param_units': Character: Units of the model parameters
- 'optimize_param': TRUE if each parameter is to be estimated from the data; FALSE otherwise
- 'use_param': TRUE if each parameter is to be used in evaluating the model; FALSE otherwise
-'lower_bounds': Numeric: The lower bounds for each parameter
- 'upper_bounds': Numeric: The upper bounds for each parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called internally by [get_params_1comp()] and should
generally not be called directly by the user.
</p>
<p>The full set of model parameters for the flat model includes
'Vdist','Fgutabs', and 'Rblood2plasma'. Whether each one can be estimated from
the data depends on what routes of administration are included in the data.
</p>
<p>The numerical optimizer requires starting guesses for the value of each
parameter to be estimated from the data. Default starting guesses are derived from the available data.
</p>
<p>These are intended to be *very* rough starting guesses, so the algorithm here
is extremely naive. This function is not itself intended to produce valid
estimates for any of the model parameters, and it is highly unlikely to do so.
</p>
<p>The derivation process is as follows.
</p>
<p>First, data are filtered to exclude any non-detects.
</p>
<p>Then, data are split by route of administration, into an IV data set and an oral data
set. (It is possible that either IV or oral data may not be
available for a chemical.)
</p>
<p>If IV data exist, then only IV data are used to derive a starting estimate for
'Vdist'. Concentrations are dose-normalized (divided by their corresponding
dose) and log10-transformed. The mean dose-normalized, log10-transformed
concentration is calculated (call it 'Cmean_log10'). 'Vdist' starting value is
then derived as '1/(10^Cmean_log10)' .
</p>
<p>If any oral data exist (whether or not IV data also exist), then the oral data
are used to derive a starting value for 'Fgutabs_Vdist'. Concentrations are dose-normalized (divided by their corresponding
dose) and log10-transformed. The mean dose-normalized, log10-transformed
concentration is calculated (call it 'Cmean_log10'). 'Fgutabs_Vdist' starting value is
then set equal to '10^Cmean_log10' .
</p>
<p>#Starting value for 'Rblood2plasma'
</p>
<p>If both blood and plasma data are available, then the starting value for 'Rblood2plasma' is derived as follows.
</p>
<p>If IV data are available for both blood and plasma, then the starting value
for 'Rblood2plasma' is derived as the ratio of 'Vdist' for blood data and
'Vdist' for plasma data.
</p>
<p>If oral data, but not IV data, are available for both blood and plasma, then
the starting value for 'Rblood2plasma' is derived as the ratio of
'Fgutabs_Vdist' for plasma data and 'Fgutabs_Vdist' for blood data.
</p>
<p>If only blood data or only plasma data are available, then the starting value for 'Rblood2plasma' is set at a constant 1.
</p>


<h3>Value</h3>

<p>The same 'data.frame' as 'par_DF', with an additional variable
'starts' containing the derived starting value for each parameter. If a
parameter cannot be estimated from the available data, then its starting value
will be 'NA_real_'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>Other flat model functions: 
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>
</p>
<p>Other get_starts functions: 
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>
</p>
<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='get_stat_error_model'>get_stat_error_model()</h2><span id='topic+get_stat_error_model'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_stat_error_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_stat_error_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_error_model_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_stat_error_model_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the stat_error_model settings
</p>


<h3>See Also</h3>

<p>[get_stat_error_model.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_stat_error_model.default'>Default method for get_stat_error_model()</h2><span id='topic+get_stat_error_model.default'></span>

<h3>Description</h3>

<p>Default method for get_stat_error_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_stat_error_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_error_model.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_stat_error_model.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_stat_error_model.pk'>Get stat_error_model</h2><span id='topic+get_stat_error_model.pk'></span>

<h3>Description</h3>

<p>Get stat_error_model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_stat_error_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_error_model.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_stat_error_model.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of the stat_error_model settings
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_stat_model'>get_stat_model()</h2><span id='topic+get_stat_model'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_stat_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_stat_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_model_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_stat_model_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list' &ndash; the 'stat_model' element of 'obj'
</p>


<h3>See Also</h3>

<p>[get_stat_model.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_stat_model.default'>Default method for get_stat_model()</h2><span id='topic+get_stat_model.default'></span>

<h3>Description</h3>

<p>Default method for get_stat_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_stat_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_model.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_stat_model.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_stat_model.pk'>Get stat_model</h2><span id='topic+get_stat_model.pk'></span>

<h3>Description</h3>

<p>Get stat_model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_stat_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_stat_model.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_stat_model.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'list' &ndash; the 'stat_model' element of 'obj'
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_status'>Get status</h2><span id='topic+get_status'></span>

<h3>Description</h3>

<p>This is the S3 method generic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_status(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_status_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="get_status_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The status of the 'pk' object as an integer.
</p>


<h3>See Also</h3>

<p>[get_status.pk()] for the 'get_status' method for class [pk()]
</p>

<hr>
<h2 id='get_status.default'>Default method for getting status</h2><span id='topic+get_status.default'></span>

<h3>Description</h3>

<p>Default method for getting status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_status(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_status.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="get_status.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_status.pk'>Check status of a 'pk' object</h2><span id='topic+get_status.pk'></span>

<h3>Description</h3>

<p>Check status of a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_status(obj, suppress.messages = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_status.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="get_status.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical. Whether to display messages.</p>
</td></tr>
<tr><td><code id="get_status.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'pk' objects have integer statuses reflecting what stage of the analysis
process they are at.
</p>
<p>1. Object has been initialized
2. Data pre-processing complete
3. Model pre-fitting complete 4
. Model fitting complete
</p>
<p>If a 'pk' object of status 2 or greater has its instructions modified with
'+', then its status will be reset to 1, indicating that any analysis results
contained in the object are now outdated and all steps of the analysis need
to be re-run.
</p>
<p>This function allows the user to check the status of a 'pk' object.
</p>
<p>A message will be printed listing the analysis steps that have been completed
for this 'pk' object, and the integer status will be returned.
</p>


<h3>Value</h3>

<p>The status of the 'pk' object as an integer.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='get_tkstats'>Get TK stats</h2><span id='topic+get_tkstats'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_tkstats(0)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_tkstats(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_tkstats_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="get_tkstats_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and 'method'
with the variables in the 'data.frame' returned by the 'tkstats_fun' for
its corresponding model.
(For the built-in models 'model_flat', 'model_1comp', and 'model_2comp', these
variables are 'param_name' and 'param_value'.)
</p>


<h3>See Also</h3>

<p>[get_tkstats.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_tkstats.default'>Default method for get_tkstats()</h2><span id='topic+get_tkstats.default'></span>

<h3>Description</h3>

<p>Default method for get_tkstats()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_tkstats(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_tkstats.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="get_tkstats.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_tkstats.pk'>Get TK stats</h2><span id='topic+get_tkstats.pk'></span>

<h3>Description</h3>

<p>Extract derived TK statistics from a fitted [pk()] model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_tkstats(
  obj,
  newdata = NULL,
  tk_group = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  vol_unit = "L",
  dose_norm = TRUE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_tkstats.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] model object. Must be fitted, or the function will exit
with an error.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data for which to
compute the TK stats. Must contain at least variables 'Chemical',
'Species', 'Route', 'Media', 'Dose', 'Dose.Units', 'Conc.Units', either
'Time_trans.Units' or 'Time.Units', and any other variables named in
'tk_grouping'. Default 'NULL', to use the data in 'obj$data'.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_tk_group">tk_group</code></td>
<td>
<p>A list of variables provided using a 'dplyr::vars()' call.
The data (either 'newdata' or 'obj$data') will be grouped according to the
unique combinations of these variables. For each unique combination of
these variables in the data, a set of TK statistics will be computed. The
default is 'obj$settings_data_info$summary_group', to derive TK statistics for
the same groups of data as non-compartmental analysis statistics. With the
default, you can directly compare e.g. a model-predicted AUC_inf to the
corresponding NCA-estimated AUC_inf. However, you may specify a different
data grouping if you wish. Each group should have a unique combination of
'Chemical', 'Species', 'Route', 'Media', and 'Dose', because the TK stats
depend on these values, and it is required to have one unique set of TK
stats per group.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_model">model</code></td>
<td>
<p>Character: One or more of the models fitted. Default 'NULL' to
return TK stats for all models.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_method">method</code></td>
<td>
<p>Character: One or more of the [optimx::optimx()] methods used.
Default 'NULL' to return TK stats for all methods.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to get the TK groupings after removing any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when  'TRUE').
'FALSE' to include all observations when getting the TK
groupings, regardless of exclusion status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_vol_unit">vol_unit</code></td>
<td>
<p>Character: Specifies the unit of volume. Defaults to &quot;L&quot; for liters.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: 'TRUE' (default) specifies whether the concentrations are dose-normalized.</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'obj$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="get_tkstats.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After fitting model parameters (e.g. elimination rate, volume of
distribution, absorption rate, bioavailability), it can be useful to derive
summary toxicokinetic statistics such as total clearance rate, half-life,
peak concentration, AUC_inf (the area under the concentration-time curve when
time goes to infinity), etc.
</p>
<p>Many of these TK statistics depend not only on chemical and species, but also
on route, media (tissue), and dose. Therefore, TK stats need to be computed
for a specific set of Chemical, Species, Route, Media, and Dose.
</p>
<p>TK statistics for a defined [pk_model()] object are computed using the
function named in the model's 'tkstats_fun'. For the built-in models, the
'tkstats_fun' functions are the following. See the documentation for the
individual functions for details on what TK stats are calculated for each
model, and how they are calculated.
-'model_1comp': [tkstats_1comp()]
-'model_2comp': [tkstats_2comp()]
-'model_flat': [tkstats_flat()]
</p>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and 'method'
with the variables in the 'data.frame' returned by the 'tkstats_fun' for
its corresponding model.
(For the built-in models 'model_flat', 'model_1comp', and 'model_2comp', these
variables are 'param_name' and 'param_value'.)
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='get_winning_model'>get_winning_model()</h2><span id='topic+get_winning_model'></span>

<h3>Description</h3>

<p>This is the S3 method generic for get_winning_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_winning_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_winning_model_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_winning_model_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and 'method' and
The return value has attribute 'criterion' giving the name of the criterion function used to compare
models.
</p>


<h3>See Also</h3>

<p>[get_winning_model.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='get_winning_model.default'>Default method for get_winning_model()</h2><span id='topic+get_winning_model.default'></span>

<h3>Description</h3>

<p>Default method for get_winning_model()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
get_winning_model(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_winning_model.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="get_winning_model.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='get_winning_model.pk'>Get winning model</h2><span id='topic+get_winning_model.pk'></span>

<h3>Description</h3>

<p>Get winning model for a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
get_winning_model(obj, newdata = NULL, method = NULL, criterion = "AIC", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_winning_model.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] object</p>
</td></tr>
<tr><td><code id="get_winning_model.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data to plot. Must
contain at least variables 'Chemical', 'Species', 'Route', 'Media', 'Dose',
'Time', 'Time.Units', 'Conc', 'Detect', 'Conc_SD'.  Default 'NULL', to use
the data in 'obj$data'.</p>
</td></tr>
<tr><td><code id="get_winning_model.pk_+3A_method">method</code></td>
<td>
<p>Character: One or more of the [optimx::optimx()] methods used in
fitting. The winning model will be determined for each of these methods.
Default 'NULL' to get the winning model for each method in
'obj$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="get_winning_model.pk_+3A_criterion">criterion</code></td>
<td>
<p>The name of a criterion function to use for model comparison.
Default &quot;AIC&quot;. Must be the name of a function that (as for 'AIC') accepts
arguments 'obj', 'newdata', 'method' and 'model' (may accept other
arguments, specified in '...') and returns output as for 'AIC': a data.frame
with a column with the same name as 'criterion' that has calculated values
for model comparison. The &quot;winning&quot; value will be the smallest value.</p>
</td></tr>
<tr><td><code id="get_winning_model.pk_+3A_...">...</code></td>
<td>
<p>Optional: Other arguments to 'criterion' function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get the winning model (i.e. the model with the lowest value of the criterion
specified in 'criterion') for a fitted 'pk' object, for a specified method,
and optionally for a specified new dataset. When there are ties it will
return the first encounter, where the priority is: model_1comp &gt; model_2comp &gt; model_flat.
</p>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and 'method' and
The return value has attribute 'criterion' giving the name of the criterion function used to compare
models.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='hess_sd1'>Inverse diagonal, method 1</h2><span id='topic+hess_sd1'></span>

<h3>Description</h3>

<p>Get square root of diagonal of inverse matrix, first method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hess_sd1(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hess_sd1_+3A_m">m</code></td>
<td>
<p>A square numeric matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Invert a square numeric matrix 'm' of size <code class="reqn">n \times n</code> using [solve()],
then take the square root of the diagonal.
</p>


<h3>Value</h3>

<p>A numeric vector of length 'n'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='hess_sd2'>Inverse diagonal, method 2</h2><span id='topic+hess_sd2'></span>

<h3>Description</h3>

<p>Get square root of diagonal of inverse matrix, second method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hess_sd2(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hess_sd2_+3A_m">m</code></td>
<td>
<p>A square numeric matrix, <code class="reqn">n \times n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Following the procedure outlined in Gill &amp; King
(2004): Calculate generalized inverse of a matrix 'm' using [MASS::ginv()]. Then
perform a generalized Cholesky factorization of the generalized inverse using
[Matrix::Cholesky()] with 'perm = TRUE'. Reconstruct the generalized inverse as
</p>
<p style="text-align: center;"><code class="reqn">\left(m^{-1} + E\right) = P_1^{\prime} L L^{\prime} P_1</code>
</p>

<p>This should ensure positive semi-definiteness of the reconstruction.
</p>
<p>Then, take the diagonal of <code class="reqn">\left(m^{-1} + E \right)</code>, and take the square root.
</p>


<h3>Value</h3>

<p>A numeric vector of length <code class="reqn">n</code>.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>References</h3>

<p>Gill J, King G. (2004) What to Do When Your Hessian is Not
Invertible: Alternatives to Model Respecification in Nonlinear Estimation.
Sociological Methods &amp; Research 33(1):54-87. DOI: 10.1177/0049124103262681
</p>

<hr>
<h2 id='ignore_unused_imports'>Ignore unused imports</h2><span id='topic+ignore_unused_imports'></span>

<h3>Description</h3>

<p>Placeholder function to appease R CMD CHECK
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ignore_unused_imports()
</code></pre>


<h3>Details</h3>

<p>This function does nothing and should be ignored by the user.
</p>
<p>Why it exists: Whenever possible, 'invivopkfit' code calls functions from other packages
using the syntax 'package::function()', which means that the whole package
does not have to be loaded, nor does the function itself have to be loaded
until it is used. The relevant packages are listed in the 'invivofit' package
'DESCRIPTION' file under 'Imports', because they must be installed to use
'invivopkfit'. But because the packages are not actually loaded, this creates
a (spurious) NOTE from 'R CMD CHECK' about a declared Import not being used.
This function is a workaround to suppress that NOTE. It does nothing except contain
namespace-qualified references (not calls) to objects in the relevant packages.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>References</h3>

<p>https://r-pkgs.org/dependencies-in-practice.html#how-to-not-use-a-package-in-imports
</p>

<hr>
<h2 id='is.pk'>Check whether an object is of class 'pk'</h2><span id='topic+is.pk'></span>

<h3>Description</h3>

<p>Check whether an object is of class 'pk'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.pk(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.pk_+3A_obj">obj</code></td>
<td>
<p>The object whose class is to be tested</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the object inherits from class 'pk', FALSE if it does not
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='is.pk_faceted'>Check whether an object is of class 'pk_faceted'</h2><span id='topic+is.pk_faceted'></span>

<h3>Description</h3>

<p>Check whether an object is of class 'pk_faceted'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.pk_faceted(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.pk_faceted_+3A_obj">obj</code></td>
<td>
<p>The object whose class is to be tested</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the object inherits from class 'pk', FALSE if it does not
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='is.pk_scales'>Is an object class 'pk_scales'?</h2><span id='topic+is.pk_scales'></span>

<h3>Description</h3>

<p>Is an object class 'pk_scales'?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.pk_scales(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.pk_scales_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if 'obj' inherits from class 'pk_scales'; FALSE if not
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='is.pkproto'>Is an object pkproto?</h2><span id='topic+is.pkproto'></span>

<h3>Description</h3>

<p>Is an object pkproto?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.pkproto(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.pkproto_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if 'obj' inherits from class 'pkproto'; FALSE if not
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='log_likelihood'>Log-likelihood</h2><span id='topic+log_likelihood'></span>

<h3>Description</h3>

<p>The log-likelihood function (probability of data given model parameters).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_likelihood(
  par,
  const_params = NULL,
  data = NULL,
  data_sigma_group = NULL,
  modelfun = NULL,
  dose_norm = FALSE,
  log10_trans = FALSE,
  negative = TRUE,
  force_finite = FALSE,
  max_multiplier = NULL,
  suppress.messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_likelihood_+3A_par">par</code></td>
<td>
<p>A named list of parameters and their values that are being
optimized.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_const_params">const_params</code></td>
<td>
<p>Optional: A named list of parameters and their values that
are being held constant.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_data">data</code></td>
<td>
<p>A 'data.frame' of data with harmonized variable names. Required:
'Time_trans', 'Dose', 'Conc', 'Detect', 'N_Subjects', 'Conc_SD'. 'Conc' and
'Conc_SD' will be transformed according to 'dose_norm' and 'log10_trans'.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_data_sigma_group">data_sigma_group</code></td>
<td>
<p>A 'factor' vector which could be a new variable in
'data', giving the error group for each row in 'data'.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_modelfun">modelfun</code></td>
<td>
<p>Character or function: The name of the function that produces
concentration predictions for the model being evaluated.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: Whether to dose-normalize predicted and observed
concentrations before calculating likelihood.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical: Whether to apply a [log10()] transformation to
predicted and observed concentrations before calculating likelihood.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_negative">negative</code></td>
<td>
<p>Logical: Whether to return the *negative* log-likelihood
(i.e., the log-likelihood multiplied by negative 1). Default TRUE, to
multiply the log-likelihood by negative 1 before returning it. This option
is useful when treating the log-likelihood as an objective function to be
*minimized* by an optimization algorithm.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_force_finite">force_finite</code></td>
<td>
<p>Logical: Whether to force return of a finite value (e.g.
as required by method 'L-BFGS-B' in [optimx::optimx()]). Default FALSE. If
TRUE, then if the log-likelihood works out to be non-finite, then it will be
replaced with '.Machine$double.xmax'.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_max_multiplier">max_multiplier</code></td>
<td>
<p>Numeric, but NULL by default. Determines which multiple
of the maximum concentration to use to limit possible predictions.
Note: only use this as part of the fitting function.</p>
</td></tr>
<tr><td><code id="log_likelihood_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-likelihood is formulated by assuming that residuals (transformed
model-predicted concentrations minus transformed observed concentrations) are
independent, and that groups of residuals obey zero-mean normal distributions
where each group may have a separate error variance. Error groups are defined
as unique combinations of variables in the harmonized data, by a command such
as 'pk(data = ...) + stat_error_model(error_group = vars(...)'.
</p>
<p># Log-likelihood equations
</p>
<p>For chemical-species combination <code class="reqn">i</code> and study <code class="reqn">j</code>, define the
following quantities.
</p>
<p><code class="reqn">y_{ijk}</code> is the <code class="reqn">k^{th}</code> observation of concentration (which may be
transformed, e.g. dose-normalized and/or log10-transformed), corresponding to
dose <code class="reqn">d_{ijk}</code> and time <code class="reqn">t_{ijk}</code>. Each observation has a
corresponding LOQ, <code class="reqn">\textrm{LOQ}_{ijk}</code>.
</p>
<p>For multiple-subject observations, <code class="reqn">y_{ijk}</code> is the <code class="reqn">k^{th}</code> *sample
mean* observed concentration for chemical-species combination <code class="reqn">i</code> and
study <code class="reqn">j</code>, corresponding to dose <code class="reqn">d_{ijk}</code> and time <code class="reqn">t_{ijk}</code>. It
represents the mean of <code class="reqn">n_{ijk}</code> individual measurements. It has a
corresponding sample standard deviation, <code class="reqn">s_{ijk}</code>. In the harmonized
data,  <code class="reqn">s_{ijk}</code> is contained in variable 'Conc_SD'.
</p>
<p><code class="reqn">\bar{\theta}_i</code> represents the vector of model parameters supplied in
argument 'params' for chemical-species combination <code class="reqn">i</code>.
</p>
<p><code class="reqn">\mu_{ijk}</code> is the model-predicted concentration for dose <code class="reqn">d_{ijk}</code>
and time <code class="reqn">t_{ijk}</code>. If <code class="reqn">f(d, t; \bar{ \theta})</code> is the model function
evaluated at dose <code class="reqn">d</code> and time <code class="reqn">t</code>, with parameter vector
<code class="reqn">\bar{\theta}</code>, then
</p>
<p style="text-align: center;"><code class="reqn">\mu_{ijk} = f \left(d_{ijk}, t_{ijk};
\bar{\theta}_i \right)</code>
</p>

<p><code class="reqn">\sigma_{ij}^2</code> is the study- and chemical-specific residual variance. (It
is a hyperparameter.)
</p>
<p>## Single-subject observations above limit of quantification (detects)
</p>
<p>This is the normal probability density function evaluated at the observed
concentration, as implemented in [stats::dnorm()].
</p>
<p style="text-align: center;"><code class="reqn">LL_{ijk} = \log \left( \frac{1}{\sqrt{\sigma_{ij} 2 \pi}} \exp \left[
\frac{-1}{2} \left( \frac{y_{ijk} - \mu_{ijk}}{\sigma_{ij}} \right)^2
\right]   \right) </code>
</p>

<p>## Single-subject observations below limit of quantification (non-detects)
</p>
<p>This is the normal cumulative density function evaluated at the LOQ, as
implemented in [stats::pnorm()]. It is the total probability of observing a
concentration anywhere between 0 and the LOQ.
</p>
<p style="text-align: center;"><code class="reqn">LL_{ijk} =  \log \left( \frac{1}{2} \left[ 1 + \textrm{erf} \left(
\frac{\textrm{LOQ}_{ijk} - \mu_{ijk}}{\sigma_{ij} \sqrt{2}} \right) \right]  \right) </code>
</p>

<p>## Multiple-subject observations above limit of quantification
</p>
<p>This is the joint log-likelihood across the multiple subjects included in one
observation, re-expressed in terms of the sample mean, sample SD, and number
of subjects for that observation. It is implemented in [dnorm_summary()].
</p>
<p style="text-align: center;"><code class="reqn">LL_{ijk} = n_{ijk} * \log \left[
 \frac{1}{\sigma_{ij} \sqrt{2 \pi}} +
  \frac{-1}{2 \sigma_{ij}^2}  \left(
   \left( n_{ijk} - 1 \right)
     s_{ijk}^2 + n_{ijk} \left( y_{ijk} - \mu_{ijk} \right)^2
      \right)
       \right]</code>
</p>

<p>## Multiple-subject observations below limit of quantification
</p>
<p>This case is not implemented. If sample mean concentration is reported below
LOQ, then it is unclear what individual observed concentrations are
represented, and how they were combined to produce the summary data in terms
of sample mean and sample SD. Were all individual observations below LOQ? Or
were below-LOQ observations replaced with 0, LOQ/2, etc. before sample mean
and sample SD were computed? If the sample mean is reported below LOQ, what
LOQ is reported? Did individual observations all have the same LOQ, or is an
average or median LOQ being used?  It is impossible to formulate the
log-likelihood without knowing the answers to these questions. Therefore,
multiple-subject observations below LOQ are excluded from analysis (they are
marked as excluded in [preprocess_data()]).
</p>
<p># Joint log-likelihood for a chemical and species
</p>
<p>The joint log-likelihood for a chemical and species is simply the sum of
log-likelihoods across observations.
</p>
<p style="text-align: center;"><code class="reqn">LL_{i} = \sum_{j=1}^{J_i} \sum_{k=1}^{K_{ij}} LL_{ijk}</code>
</p>

<p>This is the overall probability of the observed data, given the model and
parameters.
</p>


<h3>Value</h3>

<p>A log-likelihood value for the data given the parameter values in
params
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='logLik.pk'>Log-likelihood</h2><span id='topic+logLik.pk'></span>

<h3>Description</h3>

<p>Extract log-likelihood(s) from a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
logLik(
  object,
  newdata = NULL,
  model = NULL,
  method = NULL,
  negative = FALSE,
  force_finite = FALSE,
  exclude = TRUE,
  drop_obs = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.pk_+3A_object">object</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to compute
log-likelihood. If NULL (the default), then log-likelihoods will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route','Media', 'Conc',
'Detect', 'Conc_SD', 'N_Subjects'. 'Time' will be transformed according to
the transformation in 'obj$scales$time' before making predictions. 'Conc'
will be transformed according to the transformation in 'obj$scales$conc'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
calculate log-likelihood. If NULL (the default), log-likelihoods will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to calculate log-likelihoods. If NULL (the default),
log-likelihoods will be returned for all of the models in
'obj$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_negative">negative</code></td>
<td>
<p>Logical: Whether to return the *negative* log-likelihood
(i.e., the log-likelihood multiplied by negative 1). Default 'FALSE'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_force_finite">force_finite</code></td>
<td>
<p>Logical: Whether to force return of a finite value (e.g.
as required by method 'L-BFGS-B' in [optimx::optimx()]). Default FALSE. If
TRUE, then if the log-likelihood works out to be non-finite, then it will be
replaced with '.Machine$double.xmax'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the log-likelihood excluding any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when 'exclude
log-likelihood, regardless of exclusion status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_drop_obs">drop_obs</code></td>
<td>
<p>Logical: 'TRUE' to drop the observations column after calculating log-likelihood.</p>
</td></tr>
<tr><td><code id="logLik.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not in use currently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details on how the log-likelihood is calculated, see [log_likelihood()].
</p>
<p># New levels in 'newdata'
</p>
<p>The log-likelihood requires an error variance for each observation. Depending
on the error model used for the model fit, each observation may have a
different corresponding error variance, based on its unique combinations of
levels of factor variables as specified in [stat_error_model()] when setting
up the [pk()] object. (The error model specified in the 'pk' object can be
viewed using [get_error_group()]).
</p>
<p>If you are supplying new data in 'newdata', then the unique combinations of
the factor levels for the new observations will be used to find the matching
error hyperparameter. If the new data contains new combinations of factor
levels not found in the data used to fit the model, then the following
procedure will be used to calculate the log-likelihood for the observations
with new levels:
</p>
<p>If there are <code class="reqn">i = 1, 2, ... G</code> groups with unique combinations of the
factor levels in the original data, then there are corresponding error
standard deviations <code class="reqn">\sigma_i = \sigma_1, \sigma_2, ..., \sigma_G</code>.
</p>
<p>Each observation with a new combination of factor levels will have <code class="reqn">G</code>
differerent log-likelihoods computed, as though it were part of each of the
<code class="reqn">G</code> existing groups. Then, the average of these <code class="reqn">G</code> log-likelihoods
will be taken and assigned to the observation. In effect, each observation
with a new level is treated as though it is equally likely to belong to any
of the existing groups.
</p>
<p># Scaling and transformation of concentration variables in 'newdata'
</p>
<p>This function differs from some of the other methods for a fitted [pk()]
object that accept 'newdata', in that there is no 'use_scale_conc' argument
for [logLik.pk()]. You cannot specify a different scaling/transformation for
concentration variables &ndash; you have to use the same scaling/transformation
that was used to fit the model. This is because the log-likelihood depends on
the fitted values of the error variance hyperparameters, and those are valid
only for the transformation of the concentration data that was used to fit
the model.
</p>


<h3>Value</h3>

<p>A data.frame with coefficients and log-likelihood values calculated using 'newdata'.
There is one row for each model in &lsquo;obj'&rsquo;s [stat_model()] element and
each [optimx::optimx()] method (specified in [settings_optimx()]).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other log likelihood functions: 
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='mapping'>New mapping</h2><span id='topic+mapping'></span>

<h3>Description</h3>

<p>New mapping
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapping(
  mapping = ggplot2::aes(Chemical = analyte_dtxsid, Chemical_Name =
    analyte_name_original, DTXSID = analyte_dtxsid, CASRN = analyte_casrn, Species =
    species, Reference = document_id, Media = conc_medium_normalized, Route =
    administration_route_normalized, Dose = dose_level_corrected, Dose.Units = "mg/kg",
    Subject_ID = subject_id, Series_ID = series_id, Study_ID = study_id, ConcTime_ID =
    conc_time_id, N_Subjects = n_subjects_in_series, Weight = weight_kg, Weight.Units =
    "kg", Time = time_hr, Time.Units = "hours", 
     Value = conc, Value.Units = "mg/L",
    Value_SD = conc_sd_normalized, LOQ = loq),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapping_+3A_mapping">mapping</code></td>
<td>
<p>A [ggplot2::aes()] call that maps variable names in the original data to the harmonized 'invivoPKfit' variable names.</p>
</td></tr>
<tr><td><code id="mapping_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'uneval' containing the mapping &ndash; see [ggplot2::aes()] for details.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='midpt_log10'>Log10-scaled midpoint</h2><span id='topic+midpt_log10'></span>

<h3>Description</h3>

<p>Log10-scaled midpoint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>midpt_log10(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="midpt_log10_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log10-scaled midpoint, calculated as 'log10(mean(range(x))'
</p>

<hr>
<h2 id='model_1comp'>1-compartment model</h2><span id='topic+model_1comp'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_1comp
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with named elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_1comp()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_1comp()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_1comp()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_1comp()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='model_1comp_cl_nonrest'>1-compartment model that assumes non-restrictive clearance</h2><span id='topic+model_1comp_cl_nonrest'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_1comp_cl_nonrest
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with named elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_1comp_cl()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_1comp_cl()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_1comp_cl()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_1comp_cl()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='model_1comp_cl_rest'>1-compartment model that assumes restrictive clearance</h2><span id='topic+model_1comp_cl_rest'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_1comp_cl_rest
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with named elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_1comp_cl()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_1comp_cl()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_1comp_cl()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_1comp_cl()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='model_1comp_fup'>1-compartment model that assumes restrictive clearance optimizes Fup</h2><span id='topic+model_1comp_fup'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_1comp_fup
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with named elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_1comp_cl()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_1comp_cl()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_1comp_cl()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_1comp_cl()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='model_2comp'>2-compartment model</h2><span id='topic+model_2comp'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the 2-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_2comp
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_2comp()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_2comp()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_2comp()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_2comp()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='model_flat'>Flat model</h2><span id='topic+model_flat'></span>

<h3>Description</h3>

<p>The 'pk_model' object defining the flat model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_flat
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> (inherits from <code>pk_model</code>) of length 10.
</p>


<h3>Details</h3>

<p>A 'pk_model' object: under the hood, a 'list' object with elements
corresponding to the arguments of [pk_model()]. See that function
documentation for the definition of each element.
</p>
<p>See [cp_flat()] for the function that predicts blood/plasma concentration for a bolus dose (oral or IV).
</p>
<p>See [auc_flat()] for the function that predicts area under the concentration-time curve.
</p>
<p>See [tkstats_flat()] for the function that calculates summary toxicokinetic statistics from 1-compartment model parameters.
</p>
<p>See [params_flat()] for the function that determines bounds and starting guesses for model parameters, based on the data.
</p>

<hr>
<h2 id='nca'>nca()</h2><span id='topic+nca'></span>

<h3>Description</h3>

<p>This is the S3 method generic for nca()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="nca_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with variables including all the grouping variables in
'nca_group', 'nca_group_id'; 'design' (the auto-detected study design for
this group); 'param_name' (the name of the NCA parameter); 'param_value'
(the NCA parameter value); 'param_sd_z' (standard deviation of the
estimated NCA parameter value, if available); 'param_units' (the units of
the NCA parameter, derived from the units of the data).
</p>


<h3>See Also</h3>

<p>[nca.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='nca.default'>Default method for nca()</h2><span id='topic+nca.default'></span>

<h3>Description</h3>

<p>Default method for nca()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
nca(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="nca.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='nca.pk'>NCA for a 'pk' object</h2><span id='topic+nca.pk'></span>

<h3>Description</h3>

<p>Non-compartmental analysis for a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
nca(
  obj,
  newdata = NULL,
  nca_group = NULL,
  exclude = TRUE,
  dose_norm = FALSE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.pk_+3A_obj">obj</code></td>
<td>
<p>A [pk()] model object. Must be fitted, or the function will exit
with an error.</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data for which to
compute the TK stats. Must contain at least variables 'Chemical',
'Species', 'Route', 'Dose', 'Conc', 'Dose.Units', 'Conc.Units', and
'Time.Units', and any other variables named in
'tk_grouping'. Default 'NULL', to use the data in 'get_data(obj)'.</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_nca_group">nca_group</code></td>
<td>
<p>A list of variables provided using a 'dplyr::vars()' call.
The data (either 'newdata' or 'obj$data') will be grouped according to the
unique combinations of these variables. For each unique combination of
these variables in the data, a set of TK statistics will be computed. The
default is 'NULL', to use the same data grouping that was set in
[stat_nca()] for the 'pk' object. However, you may specify a different data
grouping if you wish.</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to group the data for NCA after removing any
observations in the data marked for exclusion (if there is a variable
'exclude' in the data, an observation is marked for exclusion when 'exclude
NCA, regardless of exclusion status. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: 'TRUE' to perform NCA after dose-normalizing
concentrations. 'FALSE' (default) to perform NCA on un-transformed
concentrations.</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'obj$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="nca.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform non-compartmental analysis of data in a 'pk' object (or optionally,
new data), using data groupings defined by 'get_nca_group()' for the 'pk'
object (or optionally, new groupings). If you provide both 'newdata' and
'nca_group', then everything in the 'pk' object will be ignored and you will
simply be doing NCA *de novo* (which may be what you want).
</p>


<h3>Value</h3>

<p>A 'data.frame' with variables including all the grouping variables in
'nca_group', 'nca_group_id'; 'design' (the auto-detected study design for
this group); 'param_name' (the name of the NCA parameter); 'param_value'
(the NCA parameter value); 'param_sd_z' (standard deviation of the
estimated NCA parameter value, if available); 'param_units' (the units of
the NCA parameter, derived from the units of the data).
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk'>Create a new 'pk' object</h2><span id='topic+pk'></span>

<h3>Description</h3>

<p>[pk()] initializes a new 'pk' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk(
  data = NULL,
  mapping = ggplot2::aes(Chemical = analyte_dtxsid, Chemical_Name =
    analyte_name_original, DTXSID = analyte_dtxsid, CASRN = analyte_casrn, Species =
    species, Reference = fk_extraction_document_id, Media = conc_medium_normalized, Route
    = administration_route_normalized, Dose = invivPK_dose_level, Dose.Units = "mg/kg",
    Subject_ID = fk_subject_id, Series_ID = fk_series_id, Study_ID = fk_study_id,
    ConcTime_ID = conc_time_id, N_Subjects = n_subjects_normalized, Weight = weight_kg,
    Weight.Units = "kg", Time = time_hr, 
     Time.Units = "hours", Value =
    invivPK_conc, Value.Units = "mg/L", Value_SD = invivPK_conc_sd, LOQ = invivPK_loq),
  settings_preprocess_args = list(),
  settings_data_info_args = list(),
  settings_optimx_args = list(),
  scale_conc_args = list(),
  scale_time_args = list(),
  stat_model_args = list(),
  stat_error_model_args = list(),
  facet_data_args = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_+3A_data">data</code></td>
<td>
<p>A 'data.frame'. The default is an empty data frame.</p>
</td></tr>
<tr><td><code id="pk_+3A_mapping">mapping</code></td>
<td>
<p>A mapping set up by (ab)using [ggplot2::aes()]. Call is of form
'ggplot2::aes(new_variable = old_variable)' 'new_variable' represents the
harmonized variable name that will be used within 'invivopkfit';
'old_variable' represents the variable name in 'data'. If you want to
provide a fixed/constant value for a 'new_variable' rather than taking its
value from a variable in 'data', simply supply that fixed/constant value in
the 'old_variable' position.</p>
</td></tr>
<tr><td><code id="pk_+3A_settings_preprocess_args">settings_preprocess_args</code></td>
<td>
<p>A list of preprocessing settings.</p>
</td></tr>
<tr><td><code id="pk_+3A_settings_data_info_args">settings_data_info_args</code></td>
<td>
<p>A list of data_info settings.</p>
</td></tr>
<tr><td><code id="pk_+3A_settings_optimx_args">settings_optimx_args</code></td>
<td>
<p>A list of optimx settings.</p>
</td></tr>
<tr><td><code id="pk_+3A_scale_conc_args">scale_conc_args</code></td>
<td>
<p>A list of concentration value scaling arguments.</p>
</td></tr>
<tr><td><code id="pk_+3A_scale_time_args">scale_time_args</code></td>
<td>
<p>A list of time scaling arguments</p>
</td></tr>
<tr><td><code id="pk_+3A_stat_model_args">stat_model_args</code></td>
<td>
<p>A list of TK model arguments.</p>
</td></tr>
<tr><td><code id="pk_+3A_stat_error_model_args">stat_error_model_args</code></td>
<td>
<p>A list of error modeling arguments</p>
</td></tr>
<tr><td><code id="pk_+3A_facet_data_args">facet_data_args</code></td>
<td>
<p>A list of data grouping settings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>[pk()] is used to construct the initial 'pk' object for analysis. It is almost
always followed by '+' to add steps to the workflow. For example, you could
use &lsquo;pk(my_data) + stat_model(model = &rsquo;1comp')' to set up for fitting a
1-compartment model.
</p>
<p># The 'pk' object
</p>
<p>A 'pk' object consists of a set of concentration-dose-time data to be fitted,
and sets of instructions for steps in the analysis workflow:
</p>
<p>- settings for how to pre-process the data (harmonizing variable names, imputing missing data, calculating derived variables)
- scalings/transformations to be applied to the data
- settings for the numerical optimization algorithm to be used to fit any model
- optionally: which PK model(s) should be fitted to this dataset. (You do not have to fit any PK model if you don't want to; you can instead just set up the 'pk' object with data, and do non-compartmental analysis on it.)
</p>
<p>No data processing, model fitting, or any other analysis is done until you
explicitly request it. Until then, the 'pk' object remains just a set of data
and instructions. This allows you to specify the instructions for each
analysis step without regard for the actual order of the analysis steps, and
to overwrite previous instructions, without having to re-do the model fitting
each time you add or change a set of instructions. This is particularly useful
if you are working in interactive mode at the R console.
</p>
<p># Mappings
</p>
<p>Your input data can have any variable names you like. However, internally,
'invivopkfit' needs to use a set of &quot;standard&quot;, harmonized variable names
(e.g., it refers to the variable containing measured tissue concentrations as
'Conc'; the variable containing observed time points as 'Time'; and the
variable containing administered doses as 'Dose'). In effect, 'invivopkfit'
needs to rename the input data, and produce a new 'data.frame' that uses these
internal harmonized variable names.
</p>
<p>In order to know which variable names in the input data correspond to each of
the internal harmonized variable names, we need to set up a mapping between
the internal harmonized variable names and the original variable names.
</p>
<p>The simplest, most flexible way to set up this mapping is by (ab)using a call
to [ggplot2::aes()]. In the context of [ggplot2::ggplot2-package()], you would
use [ggplot2::aes()] to set up mappings to &lsquo;ggplot2'&rsquo;s &quot;aesthetics&quot;, internal
harmonized variable names which it uses for plotting: *e.g.*, 'x', 'y',
'color', 'size', 'shape', and so on. In the context of
[invivopkfit-package()], we are setting up mappings to &lsquo;invivopkfit'&rsquo;s
internal harmonized variable names which it uses in model fitting. These
&quot;'invivopkfit' aesthetic&quot; variables are as follows:
</p>
<p>- 'Chemical': A 'character' variable containing the chemical identifier. All rows of 'data' should have the same value for 'Chemical'.
- 'Species': A 'character' variable containing the name of the species for which the data was measured.  All rows of 'data' should have the same value for 'Species'.
- 'Reference': A 'character' variable containing a unique identifier for the data reference (e.g., a single publication).
- 'Subject': A 'character' variable containing a unique identifier for the subject associated with each observation (an individual animal or group of animals).
- 'N_Subjects': A 'numeric' variable; an integer giving the number of individual animals represented by this observation. (Some data sets report tissue concentrations for individual animals, in which case 'N_Subjects' will be 1; others report average tissue concentrations for groups of multiple animals, in which case 'N_Subjects' will be greater than 1.)
- &lsquo;Weight': A 'numeric' variable giving the subject&rsquo;s body weight.
- 'Weight.Units': A 'character' variable giving the units of body weight.
- 'Route': A 'character' variable denoting the route of administration. Either 'po' (oral) or 'iv' (intravenous). Other routes are not currently supported.
- 'Dose': A 'numeric' variable giving the dose administered.
- 'Dose.Units': A 'character' variable giving the units of the administered doses.
- 'Time': A 'numeric' variable giving the time of tissue collection.
- 'Time.Units': A 'numeric' variable giving the units of 'Time'.
- 'Media': A 'character' variable giving the tissue that was analyzed. Either 'blood' or 'plasma'. Other tissues are not currently supported.
- 'Value': A 'numeric' variable giving the tissue concentration in units of mg/L. If 'N_Subjects &gt; 1', 'Value' is assumed to represent the mean tissue concentration for this group of subjects. If the tissue concentration was below the limit of quantification (LOQ), this value may be 'NA_real_'.
- 'Value_SD': A 'numeric' variable giving the standard deviation of the tissue concentration in units of mg/L, if available and relevant. If 'N_Subjects &gt; 1', 'Value_SD' is assumed to represent the standard deviation of tissue concentrations for this group of subjects. If 'N_Subjects == 1', then 'Value_SD' may be 'NA_real_'.
- 'LOQ': A 'numeric' variable giving the limit of quantification applicable to this tissue concentration in units of mg/L, if available.
- 'Value.Units': A 'character' variable giving the units of 'Value', 'Value_SD', and 'LOQ'.
</p>
<p>You may additionally include mappings to other variable names of your choice,
which will appear in the 'pk' object in 'pk$data' after the analysis is done.
</p>
<p>As with usual calls to [ggplot2::aes()], you should provide the variable names
without quoting them. For example, use 'ggplot2::aes(Chemical = my_chem)'. Do
* not* use 'ggplot2::aes(&quot;Chemical&quot; = &quot;my_chem&quot;)'.
</p>
<p>Also, as with usual calls to [ggplot2::aes()], you may also specify that any
of the &quot;'invivopkfit' aesthetic&quot; variables should be mapped to a constant
value, rather than to a variable in 'data'. For example, imagine that you
don't have a column in 'data' that encodes the units of body weight, but you
know that all body weights are provided in units of kilograms. You could
specify 'mapping = ggplot2::aes(Chemical = my_dtxsid, Species = my_species,
Weight = my_weight, Weight.Units = &quot;kg&quot;)' to map 'Weight.Units' to a fixed
value of &quot;kg&quot;.
</p>
<p>Finally, as with usual calls to [ggplot2::aes()], you may specify mappings as
expressions that use variable names in 'data'. For example, if the
species-name variable in 'data' sometimes says &quot;rat&quot;, sometimes &quot;Rat&quot;,
sometimes &quot;RAT&quot;, you might want to harmonize the capitalization. You can do
that easily by specifying 'mapping = ggplot2::aes(Chemical = my_dtxsid,
Species = tolower(my_species)'.
</p>
<p>The following &quot;aesthetics&quot; variable names are reserved for internal use (i.e.,
they are automatically assigned by [preprocess_data.pk()], and should *not* be
included in 'mapping':
</p>
<p>- 'Conc': This is assigned as the greater of 'Value' and 'LOQ', with NAs removed.
- 'Conc_SD': This is set equal to 'Value_SD'.
- 'Detect': This is a logical variable, 'TRUE' if 'Conc &gt; LOQ' and 'FALSE' otherwise.
- 'Conc_trans': This is 'Conc' with all scalings and transformations applied as specified in '+ scale_conc()'.
- 'Conc_SD_trans': This is 'Conc_SD' with all scalings and transformations applied as specified in '+ scale_conc()'.
- &lsquo;Conc_trans.Units': Automatically-derived from 'Conc.Units' with any scalings and transformations applied. If dose normalization is requested, then 'Dose.Units' is also used to automatically derive the resulting 'Conc_trans.Units'. For example, if both dose-normalization and [log10()] transformation are requested, and 'Conc.Units = &rsquo;mg/L'&lsquo; and 'Dose.Units = &rsquo;mg/kg', then 'Conc_trans.Units = log10((mg/L)/(mg/kg))'.
- 'Time_trans': This is 'Time' with any rescaling specified in '+ scale_time()'.
- 'Time_trans.Units': The new units of time after any rescaling (e.g. 'hours', 'days', 'weeks',...)
</p>
<p>If you do assign any of these reserved variable names in 'mapping', your
mapping will be ignored for those reserved variable names. WARNING: If you
have any variables with these reserved names in your original data, those
original variables will be dropped by [preprocess_data.pk()].
</p>
<p>The default value of 'mapping' is the following (which refers to original
variable names in the built-in dataset [cvt]):
</p>
<p>&ldquo;'
ggplot2::aes(
Chemical = chemicals_analyzed.dsstox_substance_id,
DTXSID = chemicals_analyzed.dsstox_substance_id,
CASRN = chemicals_analyzed.dsstox_casrn,
Species = subjects.species,
Reference = as.character(ifelse(is.na(documents_reference.id),
documents_extraction.id,
documents_reference.id)),
Media = series.conc_medium_normalized,
Route = studies.administration_route_normalized,
Dose = studies.dose_level_normalized,
Dose.Units = &quot;mg/kg&quot;,
Subject = subjects.id,
N_Subjects =  series.n_subjects_in_series,
Weight = subjects.weight_kg,
Weight.Units = &quot;kg&quot;,
Time = conc_time_values.time_hr,
Time.Units = &quot;hours&quot;,
Value = conc_time_values.conc,
Value.Units = &quot;mg/L&quot;,
LOQ = series.loq_normalized,
Value_SD  = conc_time_values.conc_sd_normalized
)
&ldquo;'
</p>
<p># Data
</p>
<p>'Route' values should be either '&quot;oral&quot;' (oral bolus administration) or '&quot;iv&quot;'
(IV bolus administration), and 'Media' values should be either '&quot;blood&quot;' or
'&quot;plasma&quot;'.
</p>
<p>If 'data' contains data for more than one 'Chemical' and 'Species', then you
should use [facet_data()] to run a &quot;faceted&quot; analysis. A faceted analysis will
group the data according to unique combinations of the faceting variables, and
produce a 'pk' object for each group. The result is a [tibble::tibble()]
grouped by the faceting variables, with a list column named 'pk' containing
the 'pk' object for each group. This [tibble::tibble()] is an object of class
'pk_faceted'.
</p>
<p>All methods for 'pk' objects have a corresponding version for a
'pk_faceted' object, which applies the method to each 'pk' object in turn and
either returns the same 'pk_faceted' object with a modified 'pk' column (for
methods that operate on a 'pk' object and return a modified version of the
same 'pk' object like [preprocess_data()], [data_info()], [prefit()], [fit()]), or produces a
[tibble::tibble()] grouped by the faceting variables, with a list column named
after the 'pk' method containing the results of that method (for methods that
operate on a 'pk' object but return something other than a modified 'pk'
object, e.g. [summary.pk()], [coef.pk()], [coef_sd.pk()], [predict.pk()],
[residuals.pk()], [nca.pk()]).
</p>


<h3>Value</h3>

<p>An object of class 'pk'. The initial 'pk' object is a list with
elements 'data_orig', 'data_settings', 'scales' and 'optimx_settings'.
'data_orig' is the original data set to be fitted, as supplied in the
argument 'data'. 'data_settings' is a named list containing all the other
input arguments: these provide settings that will be used when the data is
pre-processed before fitting.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add'>Add a 'pkproto' object to a 'pk' object</h2><span id='topic+pk_add'></span>

<h3>Description</h3>

<p>This is the S3 generic method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pkproto' object to be added</p>
</td></tr>
<tr><td><code id="pk_add_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pkproto' object is to be added</p>
</td></tr>
<tr><td><code id="pk_add_+3A_objectname">objectname</code></td>
<td>
<p>The object name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the addition.
</p>


<h3>See Also</h3>

<p>[pk_add.pk_scales()] for the method for adding 'pk_scales' objects
(from [scale_conc()] and [scale_time()]); [pk_add.pk_settings_preprocess()]
for the method for adding 'pk_settings_preprocess' objects (from
[settings_preprocess()]); [pk_add.pk_settings_data_info()] for the method
for adding 'pk_settings_data_info' objects (from [settings_data_info()]);
[pk_add.pk_settings_optimx()] for the method for adding
'pk_settings_optimx' objects (from [settings_optimx()]);
[pk_add.pk_stat_model()] for the method for adding 'pk_stat_model' objects
(from 'stat_model()')
</p>

<hr>
<h2 id='pk_add.default'>Add pkproto object default method</h2><span id='topic+pk_add.default'></span>

<h3>Description</h3>

<p>Add pkproto object default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.default_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pkproto' object to be added</p>
</td></tr>
<tr><td><code id="pk_add.default_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pkproto' object is to be added</p>
</td></tr>
<tr><td><code id="pk_add.default_+3A_objectname">objectname</code></td>
<td>
<p>The object name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the addition.
</p>

<hr>
<h2 id='pk_add.pk_facet_data'>Add facet_data()</h2><span id='topic+pk_add.pk_facet_data'></span>

<h3>Description</h3>

<p>Add facet_data()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_facet_data'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_facet_data_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_facet_data' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_facet_data_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The [pk()] object to which the 'pk_facet_data' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_facet_data_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_facet_data' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The [pk()] object, with the added 'pk_facet_data'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_scales'>Add a 'pk_scales' object to a 'pk' object.</h2><span id='topic+pk_add.pk_scales'></span>

<h3>Description</h3>

<p>Add a 'pk_scales' object to a 'pk' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_scales'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_scales_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_scales' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_scales_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_scales' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_scales_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_scales' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by the 'pk_scales' object.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_settings_data_info'>Add a 'pk_settings_data_info' object.</h2><span id='topic+pk_add.pk_settings_data_info'></span>

<h3>Description</h3>

<p>Add a 'pk_settings_data_info' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_settings_data_info'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_settings_data_info_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_settings_data_info' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_data_info_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_settings_data_info' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_data_info_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_settings_data_info' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by the 'pk_settings_data_info' object.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_settings_optimx'>Add a 'pk_settings_optimx' object.</h2><span id='topic+pk_add.pk_settings_optimx'></span>

<h3>Description</h3>

<p>Add a 'pk_settings_optimx' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_settings_optimx'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_settings_optimx_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_settings_optimx' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_optimx_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_settings_optimx' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_optimx_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_settings_optimx' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by adding the settings.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_settings_preprocess'>Add a 'pk_settings_preprocess' object.</h2><span id='topic+pk_add.pk_settings_preprocess'></span>

<h3>Description</h3>

<p>Add a 'pk_settings_preprocess' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_settings_preprocess'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_settings_preprocess_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_settings_preprocess' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_preprocess_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_settings_preprocess' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_settings_preprocess_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_settings_preprocess' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by the 'pk_settings_preprocess' object.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_stat_error_model'>Add a 'pk_stat_error_model' object.</h2><span id='topic+pk_add.pk_stat_error_model'></span>

<h3>Description</h3>

<p>Add a 'pk_stat_error_model' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_stat_error_model'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_stat_error_model_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_stat_error_model' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_stat_error_model_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_stat_error_model' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_stat_error_model_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_stat_error_model' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by adding the 'stat_error_model'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.pk_stat_model'>Add a 'pk_stat_model' object.</h2><span id='topic+pk_add.pk_stat_model'></span>

<h3>Description</h3>

<p>Add a 'pk_stat_model' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_stat_model'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.pk_stat_model_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_stat_model' object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_stat_model_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pk_stat_model' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.pk_stat_model_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_stat_model' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by adding the 'stat_model'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_add.uneval'>Add an 'uneval' object</h2><span id='topic+pk_add.uneval'></span>

<h3>Description</h3>

<p>Add an object created by [ggplot2::aes()]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'uneval'
pk_add(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_add.uneval_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'uneval' (mapping) object to be added.</p>
</td></tr>
<tr><td><code id="pk_add.uneval_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The [pk()] object to which the 'uneval' object will be added.</p>
</td></tr>
<tr><td><code id="pk_add.uneval_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'uneval' object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function adds a new variable mapping (created by [ggplot2::aes()]),
which has class 'uneval', to an existing [pk()] object.
</p>
<p>The new mapping will completely replace any existing mapping.
</p>


<h3>Value</h3>

<p>The [pk()] object, modified by adding the new mapping.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_model'>Create a new 'pk_model' object</h2><span id='topic+pk_model'></span>

<h3>Description</h3>

<p># 'conc_fun' requirements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk_model(
  name,
  params,
  conc_fun,
  auc_fun,
  params_fun,
  tkstats_fun,
  conc_fun_args = NULL,
  auc_fun_args = NULL,
  params_fun_args = NULL,
  tkstats_fun_args = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_model_+3A_name">name</code></td>
<td>
<p>Character: The name of the model.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_params">params</code></td>
<td>
<p>Character vector: Parameter names of the model.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_conc_fun">conc_fun</code></td>
<td>
<p>Character: Name of the function to predict tissue concentrations using this model. See
Details for requirements.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_auc_fun">auc_fun</code></td>
<td>
<p>Character: Name of the function to predict AUC (area under the
concentration-time curve) using this model. See Details for requirements.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_params_fun">params_fun</code></td>
<td>
<p>Character: Name of the function that produces the 'data.frame' of
parameter info for this model (see Details)</p>
</td></tr>
<tr><td><code id="pk_model_+3A_tkstats_fun">tkstats_fun</code></td>
<td>
<p>Character: Name of the function that produces a'data.frame' of derived
TK statistics for this model (see Details)</p>
</td></tr>
<tr><td><code id="pk_model_+3A_conc_fun_args">conc_fun_args</code></td>
<td>
<p>A named list: any additional arguments to 'conc_fun' other than those
listed in Details. Default 'NULL'.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_auc_fun_args">auc_fun_args</code></td>
<td>
<p>A named list: any additional arguments to 'auc_fun' other those those
listed in Details. Default 'NULL'.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_params_fun_args">params_fun_args</code></td>
<td>
<p>A named list: any additional arguments to 'params_fun' other than
'data' (see Details). Default 'NULL'.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_tkstats_fun_args">tkstats_fun_args</code></td>
<td>
<p>A named list: any additional arguments to 'tkstats_fun' other than
'data', 'medium', 'route' (see Details). Default NULL.</p>
</td></tr>
<tr><td><code id="pk_model_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently implemented).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'conc_fun' should be a function that takes the following arguments, and
returns a numeric vector of predicted tissue concentrations:
</p>
<p>- 'params': A named list of parameter values
- 'time': A numeric vector of time values
- 'dose': A numeric vector of dose values. Currently, only a single bolus dose at time 0 is supported.
- &lsquo;route': A character vector of the route of administration. Currently, only '&rsquo;oral'&lsquo; and '&rsquo;iv'' are supported.
- &lsquo;medium': The tissue in which concentration is to be predicted. Currently, only '&rsquo;blood'&lsquo; and '&rsquo;plasma'' are supported.
</p>
<p>See [cp_1comp()], [cp_2comp()], [cp_flat()] for examples.
</p>
<p>#'auc_fun' requirements
</p>
<p>'auc_fun' should be a function that takes the same arguments as 'conc_fun',
and returns a numeric vector of predicted tissue AUCs (area under the
concentration-time curve).
</p>
<p>See [auc_1comp()], [auc_2comp()], [auc_flat()] for examples.
</p>
<p># 'params_fun' requirements
</p>
<p>'params_fun' should be a function whose first argument is a 'data.frame',
which will be the pre-processed data using 'invivopkfit' harmonized variable
names. It may take additional arguments, which can be provided in
'params_fun_args'. The function should return a 'data.frame' with the
following variables:
</p>
<p>- 'param_name': Character vector, listing parameter names for the model
- 'param_units': Character vector, listing units of each model parameter
- 'optimize_param': Logical (TRUE/FALSE), whether each parameter is to be estimated given the available data
- 'use_param': Logical (TRUE/FALSE), whether each parameter is to be used in the model even if it is not estimated (i.e., if a parameter value is to be held constant while the others are estimated, then 'optimize_param' should be FALSE but 'use_param' should be TRUE)
-'lower_bound': Numerical. Lower bounds for each parameter. May be '-Inf' if no lower bound.  If 'optimize_param' or 'use_param' is FALSE, thenthe corresponding 'lower_bound' will be ignored (because the parameter is not being estimated from the data).
- 'upper_bound': Numerical. Upper bounds for each parameter. May be 'Inf' if no upper bound. If 'optimize_param' or 'use_param' is FALSE, then the corresponding 'upper_bound' will be ignored (because the parameter is not being estimated from the data).
- 'start': Numerical. Starting values for estimating each parameter. If 'optimize_param' is FALSE and 'use_param' is TRUE, then the parameter will be held constant at the corresponding value in 'start'. If 'use_param' is FALSE, then the corresponding 'start' will be ignored.
</p>
<p>See [get_params_flat()], [get_params_1comp()], [get_params_2comp()] for
examples.
</p>
<p># 'tkstats_fun' requirements
</p>
<p>'tkstats_fun' should be a function which accepts a vector of model parameter
values and calculates derived summary toxicokinetic statistics (e.g. total
clearance, halflife, AUC, volume of distribution at steadystate).
</p>
<p>The function must take the following named arguments:
</p>
<p>- 'pars': A named numeric vector of model parameter values.
- 'route': A character scalar naming a route (e.g. &quot;oral&quot; or &quot;iv&quot;)
- 'medium': A character scalar naming a tissue medium of analysis (e.g. &quot;blood&quot; or &quot;plasma&quot;)
- 'dose': A numeric scalar giving a dose level for which to calculate TK statistics
- 'time_unit': A character scalar giving the units of time
- 'conc_unit': A character scalar giving the units of concentration
- 'vol_unit': A character scalar giving the units of volume
</p>
<p>and return a 'data.frame' of derived toxicokinetic statistics, which should
have the following variables:
</p>
<p>- 'param_name': A character vector giving the names of each derived TK statistic
- 'param_value': A character vector giving the values of each derived TK statistic
- 'param_units': A character vector giving the units of each derived TK statistic
</p>
<p>It is recommended (although not required) that the function return the
following statistics, using these names in the 'param_name' variable:
</p>
<p>- 'CLtot': Total clearance rate (units of volume/time)
- 'CLtot/Fgutabs': Total clearance rate scaled by bioavailability (if oral bioavailability is available) (units of volume/time)
- 'Css': The steady-state concentration after a long-term daily dose of 'dose' (units of concentration)
- 'halflife': The terminal half-life (units of time)
- 'tmax': The time of peak concentration (units of time)
- 'Cmax': The peak concentration (units of time)
- 'AUC_infinity': The area under the concentration-time curve, calculated at infinite time (units of concentration * time)
- 'Vdist_ss': The volume of distribution at steady-state (units of volume)
- 'Vdist_ss/Fgutabs': The volume of distribution at steady-state scaled by bioavailability (if oral bioavailability is available) (units of volume)
</p>
<p>The recommendation to return these statistics, using these names, is intended
to make it easier to compare TK statistics across models, and to compare TK
statistics to the results of non-compartmental analysis. If these names are
not used, then some outputs of [summary.pk()] will not be very useful. The
automated comparison of TK stats from the winning model to the results of
non-compartmental analysis relies on these names being present in the output
of 'tkstats_fun' to match the names of the statistics output from NCA; it
shouldn't crash without them, but the results won't be very useful. And TK
stats compiled across models will not be easy to compare if the models use
different names for the statistics.
</p>


<h3>Value</h3>

<p>An object of class 'pk_model'. Effectively, a named list containing
all of the arguments provided to this function.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pk_subtract'>Subtract a 'pkproto' object from a 'pk' object</h2><span id='topic+pk_subtract'></span>

<h3>Description</h3>

<p>This is the S3 generic method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk_subtract(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_subtract_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pkproto' object to be subtracted</p>
</td></tr>
<tr><td><code id="pk_subtract_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pkproto' object is to be subtracted</p>
</td></tr>
<tr><td><code id="pk_subtract_+3A_objectname">objectname</code></td>
<td>
<p>The object name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the subtraction.
</p>


<h3>See Also</h3>

<p>[pk_subtract.pk_stat_model()] for the method for subtracting 'pk_stat_model' objects
(from 'stat_model()')
</p>

<hr>
<h2 id='pk_subtract.default'>Subtract pkproto object default method</h2><span id='topic+pk_subtract.default'></span>

<h3>Description</h3>

<p>Subtract pkproto object default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
pk_subtract(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_subtract.default_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pkproto' object to be subtracted</p>
</td></tr>
<tr><td><code id="pk_subtract.default_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object to which the 'pkproto' object is to be subtracted</p>
</td></tr>
<tr><td><code id="pk_subtract.default_+3A_objectname">objectname</code></td>
<td>
<p>The object name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the addition.
</p>

<hr>
<h2 id='pk_subtract.pk_stat_model'>Subtract a 'pk_stat_model' object.</h2><span id='topic+pk_subtract.pk_stat_model'></span>

<h3>Description</h3>

<p>Subtract a 'pk_stat_model' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk_stat_model'
pk_subtract(pkproto_obj, pk_obj, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pk_subtract.pk_stat_model_+3A_pkproto_obj">pkproto_obj</code></td>
<td>
<p>The 'pk_stat_model' object to be subtracted.</p>
</td></tr>
<tr><td><code id="pk_subtract.pk_stat_model_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object from which the 'pk_stat_model' object will be subtracted.</p>
</td></tr>
<tr><td><code id="pk_subtract.pk_stat_model_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pk_stat_model' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object, modified by subtracting the 'stat_model'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='pkdataset_nheerlcleaned'>Toxicokinetic data from the &quot;Concentration vs. Time Database&quot;</h2><span id='topic+pkdataset_nheerlcleaned'></span>

<h3>Description</h3>

<p>A dataset containing experimental time-course data of chemical compound
concentrations in body fluids and tissues
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkdataset_nheerlcleaned
</code></pre>


<h3>Format</h3>

<p>A data table with 2454 rows and 19 variables:
</p>


<h3>Source</h3>

<p><a href="https://github.com/USEPA/CompTox-PK-CvTdb">https://github.com/USEPA/CompTox-PK-CvTdb</a>
</p>

<hr>
<h2 id='plot.pk'>Plot a [pk()] object.</h2><span id='topic+plot.pk'></span>

<h3>Description</h3>

<p>Plot data and model fits from a [pk()] object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
plot(
  x,
  newdata = NULL,
  model = NULL,
  method = NULL,
  use_scale_conc = FALSE,
  time_trans = FALSE,
  log10_C = NULL,
  plot_data_aes = NULL,
  plot_point_aes = NULL,
  facet_fun = NULL,
  facet_fun_args = NULL,
  drop_nonDetect = FALSE,
  plot_fit_aes = NULL,
  n_interp = 10,
  fit_limits = NULL,
  print_out = FALSE,
  best_fit = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pk_+3A_x">x</code></td>
<td>
<p>A [pk()] object. In this case 'x' is used to align with generic method.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' containing new data to plot. Must
contain at least variables 'Chemical', 'Species', 'Route', 'Media', 'Dose',
'Time', 'Time.Units', 'Conc', 'Detect', 'Conc_SD'.  Default 'NULL', to use
the data in 'obj$data'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_model">model</code></td>
<td>
<p>Character: One or more of the models fitted. Curve fits will be
plotted for these models. Default 'NULL' to plot fits for all models in
'x$stat_model'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_method">method</code></td>
<td>
<p>Character: One or more of the [optimx::optimx()] methods used.
Default 'NULL' to plot fits for all methods in 'x$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE', 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'.  If 'use_scale_conc = FALSE' (the default for this
function), then the data and fits will be plotted without any
dose-normalization or log-transformation. If 'use_scale_conc = TRUE' , then
the concentration scaling/transformations in 'x' will be applied to the
y-axis (concentration axis). If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied to the y-axis (concentration axis) of
the plots.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_time_trans">time_trans</code></td>
<td>
<p>Default 'FLASE'. Determines whether time values will be transformed.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_log10_c">log10_C</code></td>
<td>
<p>Default 'NULL'. Determines whether y-axis (concentration) should
be log10 transformed. Takes 'TRUE' or 'FALSE' values. Otherwise it defaults
to the value determined from 'use_scale_conc'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_plot_data_aes">plot_data_aes</code></td>
<td>
<p>Optional: Aesthetic mapping for the plot layer that
visualizes the data. Default 'NULL', in which case a default mapping will be
used based on the value of 'use_scale_conc'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_plot_point_aes">plot_point_aes</code></td>
<td>
<p>Optional: Aesthetic mappings for geom_point layer
that determines the fill of the points. Defaults to 'NULL'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_facet_fun">facet_fun</code></td>
<td>
<p>Default '&quot;facet_grid&quot;'. Optional: The name of the 'ggplot2' faceting function to use:
[ggplot2::facet_grid()], [ggplot2::facet_wrap()], or ''none'' to do no
faceting. Default 'NULL', in which case a default faceting will be
applied based on the value of 'use_scale_conc'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_facet_fun_args">facet_fun_args</code></td>
<td>
<p>A named list of arguments to the faceting function in
'facet_fun' (if any). Default:
&ldquo;'
list(rows = ggplot2::vars(Route),
cols= ggplot2::vars(Media),
scales = &quot;free_y&quot;,
labeller = &quot;label_both&quot;)
&ldquo;'</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_drop_nondetect">drop_nonDetect</code></td>
<td>
<p>Default 'FALSE'. Whether to eliminate observations below
the level of quantification (LOQ).</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_plot_fit_aes">plot_fit_aes</code></td>
<td>
<p>Optional: Aesthetic mapping for the plot layer that
visualizes the fitted curves. Default 'NULL', in which case a default mapping will be
used based on the value of 'use_scale_conc'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_n_interp">n_interp</code></td>
<td>
<p>For plotting: the number of time points to interpolate between
each observed time point. Default 10.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_fit_limits">fit_limits</code></td>
<td>
<p>Default 'NULL'. c(Upper Bound, Lower Bound).
Supply a numeric vector. These values filter the predicted
values for fits to not exceed 2.25x of the maximum observed concentration values
for each 'data_group' in the 'pk' object. When there is a log10 transformation
of concentration values, it limits predicted values to 1/20th of the minimum
observed concentration values and 5 times the maximum value.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_print_out">print_out</code></td>
<td>
<p>For plotting: whether the output of the function should be
the list of plots. Default 'FALSE'.</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_best_fit">best_fit</code></td>
<td>
<p>Default FALSE. Determines whether fit plot outputs only the
best fit from 'get_winning_model()'</p>
</td></tr>
<tr><td><code id="plot.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the [pk()] object has not been fitted, then only the data will be plotted
(because no curve fits exist).
</p>


<h3>Value</h3>

<p>A [ggplot2::ggplot()]-class plot object.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>

<hr>
<h2 id='predict.pk'>Get predictions</h2><span id='topic+predict.pk'></span>

<h3>Description</h3>

<p>Extract predictions from a fitted 'pk' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
predict(
  object,
  newdata = NULL,
  model = NULL,
  method = NULL,
  type = "conc",
  exclude = TRUE,
  use_scale_conc = FALSE,
  suppress.messages = NULL,
  include_NAs = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.pk_+3A_object">object</code></td>
<td>
<p>A [pk] object.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions. If NULL (the default), then predictions will be made for the
data in 'object$data'. 'newdata' is required to contain at least the following
variables: 'Time', 'Time.Units', 'Dose', 'Route', and 'Media'.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions. If NULL (the default), predictions will be returned for
all of the models in 'object$stat_model'.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions. If NULL (the default), predictions will be
returned for all of the models in 'object$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_type">type</code></td>
<td>
<p>Either '&quot;conc&quot;' (the default) or '&quot;auc&quot;'. 'type = &quot;conc&quot;'
predicts concentrations; 'type = &quot;auc&quot;' predicts area under the
concentration-time curve (AUC).</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to return 'NA_real_' for any observations in
the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to return the prediction for each observation, regardless of
exclusion. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE', 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'. If 'use_scale_conc = TRUE', then the concentration
scaling/transformations in 'object' will be applied to both predicted and
observed concentrations before the log-likelihood is computed. If
'use_scale_conc = FALSE' (the default for this function), then no
concentration scaling or transformation will be applied before the
log-likelihood is computed. If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'object$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_include_nas">include_NAs</code></td>
<td>
<p>Logical: 'FALSE' by default. Determines whether to include
aborted fits which have NAs as coefficients.</p>
</td></tr>
<tr><td><code id="predict.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with one row for each 'data_group', 'model' and 'method'.
Includes variable 'Conc_est' that contains the predicted concentration or AUC at that timepoint
given the TK parameters for that 'model' and 'method' specified in [coefs()].
If 'use_scale_conc 
un-transformed concentrations in the same units as 'object$data$Conc.Units'.
If 'use_scale_conc 
concentrations in the same units as 'object$data$Conc_trans.Units'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='print.pk'>Print a user-friendly version of a 'pk' object</h2><span id='topic+print.pk'></span>

<h3>Description</h3>

<p>Prints a clear summary of 'pk' object and returns it invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pk_+3A_x">x</code></td>
<td>
<p>A pk object.</p>
</td></tr>
<tr><td><code id="print.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary output
</p>


<h3>Author(s)</h3>

<p>Gilberto Padilla Mercado
</p>

<hr>
<h2 id='rename2_cvt'>Convert invivoPKfit output table names to the CvTdb names</h2><span id='topic+rename2_cvt'></span>

<h3>Description</h3>

<p>Convert invivoPKfit output table names to the CvTdb names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename2_cvt(
  data,
  cvt_LUT = c(analyte_dtxsid = "Chemical", analyte_dtxsid = "DTXSID",
    analyte_name_original = "Chemica_Name", species = "Species",
    fk_extraction_document_id = "Reference", conc_medium_normalized = "Media",
    administration_route_normalized = "Route", invivPK_dose_level = "Dose", fk_subject_id
    = "Subject_ID", fk_series_id = "Series_ID", fk_study_id = "Study_ID", conc_time_id =
    "ConcTime_ID", invivPK_subjects_corrected = "N_Subjects", weight_kg = "Weight",
    time_hr = "Time", invivPK_conc = "Value", invivPK_conc_sd = "Value_SD", 
    
    invivPK_loq = "LOQ")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename2_cvt_+3A_data">data</code></td>
<td>
<p>A data frame from on the invivoPKfit outputs.</p>
</td></tr>
<tr><td><code id="rename2_cvt_+3A_cvt_lut">cvt_LUT</code></td>
<td>
<p>A look-up table for the name conversions, can be constomized.
must be a vector.</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.pk'>Get residuals</h2><span id='topic+residuals.pk'></span>

<h3>Description</h3>

<p>Extract residuals from a fitted 'pk' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
residuals(
  object,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  use_scale_conc = FALSE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.pk_+3A_object">object</code></td>
<td>
<p>A [pk] object</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions and compute residuals. If NULL (the default), then residuals
will be computed for the data in 'object$data'. 'newdata' is required to
contain at least the following variables: 'Time', 'Time.Units', 'Dose',
'Route', 'Media', 'Conc', 'Detect'.</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate residuals. If NULL (the default), residuals
will be returned for all of the models in 'object$stat_model'.</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate residuals. If NULL (the
default), residuals will be returned for all of the models in
'object$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to return 'NA_real_' for any observations in
the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to return the residual for each observation, regardless of
exclusion. Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE', 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'. If 'use_scale_conc = TRUE', then the concentration
scaling/transformations in 'object' will be applied to both predicted and
observed concentrations before the residuals are computed (i.e., the
residuals will be computed on the same scale as the model was originally
fitted). If 'use_scale_conc = FALSE' (the default for this function), then
no concentration scaling or transformation will be applied before the
residuals are computed (i.e., the residuals will be computed on natural
scale concentration data). If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied.</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'object$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="residuals.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Residuals are 'obs - pred' in general, where 'obs' is the observed
concentration value and 'pred' is the predicted concentration value.
</p>
<p>For non-detect observations, residual is zero if 'pred' is also below the
LOQ. Otherwise, the residual is the difference between the LOQ and 'pred'.
</p>


<h3>Value</h3>

<p>A data.frame with the final column being calculated residuals.
There is one row per each [optimx::optimx()] methods (specified in
[settings_optimx()]), and 'data_group'.  The final column
contains the residuals (observed - predicted) of the model fitted by the
corresponding method.  If 'use_scale_conc 
in the same units as 'object$data$Conc.Units'. If 'use_scale_conc 
the residuals are in the same units as 'object$data$Conc_trans.Units'. If
'use_scale_conc' was a named list, then the residuals are in units of
'object$data$Conc.Units' transformed as specified in 'use_scale_conc'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='rmse'>Root mean squared error (RMSE)</h2><span id='topic+rmse'></span>

<h3>Description</h3>

<p>This is the S3 method generic for 'rmse'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmse(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmse_+3A_obj">obj</code></td>
<td>
<p>the pk object</p>
</td></tr>
<tr><td><code id="rmse_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with calculated RMSE as the final column. There is one row per
each model in &lsquo;obj'&rsquo;s [stat_model()] element, i.e. each PK model that was
fitted to the data, each [optimx::optimx()] methods (specified in
[settings_optimx()]), 'rmse_group' specified.
</p>


<h3>See Also</h3>

<p>[rmse.pk()] for the 'rmse' method for class [pk()]
</p>

<hr>
<h2 id='rmse.default'>Root mean squared error (RMSE) default method</h2><span id='topic+rmse.default'></span>

<h3>Description</h3>

<p>Root mean squared error (RMSE) default method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
rmse(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmse.default_+3A_obj">obj</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="rmse.default_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='rmse.pk'>Root mean squared error</h2><span id='topic+rmse.pk'></span>

<h3>Description</h3>

<p>Extract root mean squared error of a fitted 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
rmse(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  use_scale_conc = FALSE,
  rmse_group = NULL,
  sub_pLOQ = TRUE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmse.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions and compute RMSEs. If NULL (the default), then RMSEs will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route',
'Media', 'Conc', 'Conc_SD', 'N_Subjects', 'Detect'.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate RMSEs. If NULL (the default), RMSEs will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate RMSEs. If NULL (the default),
RMSEs will be returned for all of the models in
'obj$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the RMSE excluding any observations
in the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to include all observations, regardless of exclusion status.
Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'FALSE' (default, 'TRUE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'.  If 'use_scale_conc = FALSE' (the default for this
function), then no concentration scaling or transformation will be applied
when the RMSE is computed. If 'use_scale_conc = TRUE, then the
concentration scaling/transformations in 'obj' will be applied to both
predicted and observed concentrations when the RMSE is computed (see
[calc_rmse()] for details).If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied when the RMSE is computed.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_rmse_group">rmse_group</code></td>
<td>
<p>A list of quosures provided in the format 'vars(...)' that
determines the data groupings for which RMSE is calculated. Default NULL,
in which case RMSE is calculated for each data group defined in the
object's 'data_group' element (use [get_data_group.pk()] to access the
object's 'data_group').</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>TRUE (default): Substitute all predictions below the LOQ with
the LOQ before computing R-squared. FALSE: do not.</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'obj$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="rmse.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Formula for RMSE
</p>
<p>RMSE is calculated using the following formula, to properly handle summary
data:
</p>
<p style="text-align: center;"><code class="reqn">
\sqrt{
\frac{1}{N}
 \sum_{i=1}^G \left( (n_i - 1) s_i^2 +
  n_i \bar{y}_i ^2 - 2 n_i \bar{y}_i \mu_i + \mu_i^2 \right)
   }
</code>
</p>

<p>In this formula, there are <code class="reqn">G</code> observations, each of which may be for one
subject or for multiple subjects.
</p>
<p>- <code class="reqn">n_i</code> is the number of subjects for observation <code class="reqn">i</code>.
- <code class="reqn">\bar{y}_i</code> is the sample mean concentration for observation <code class="reqn">i</code>, with no transformations applied.
- <code class="reqn">s_i</code> is the sample standard deviation of concentrations for observation <code class="reqn">i</code>, with no transformations applied.
- <code class="reqn">\mu_i</code> is the model-predicted concentration for observation <code class="reqn">i</code>, with no transformations applied.
</p>
<p><code class="reqn">N</code> is the grand total of subjects across observations:
</p>
<p style="text-align: center;"><code class="reqn">N = \sum_{i=1}^G n_i</code>
</p>

<p>For the non-summary case (<code class="reqn">N</code> single-subject observations, with all
<code class="reqn">n_i = 1</code>, <code class="reqn">s_i = 0</code>, and <code class="reqn">\bar{y}_i = y_i</code>), this formula
reduces to the familiar RMSE formula
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\frac{1}{N} \sum_{i=1}^N (y_i - \mu_i)^2}</code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the predicted value is (temporarily) set equal to the LOQ,
for an effective error of zero.
</p>
<p>If the observed value is censored, and the predicted value is greater than
the reported LOQ, the the observed value is treated as the reported LOQ (so
that the effective error is the difference between the LOQ and the predicted
value).
</p>
<p># Log10 transformation
</p>
<p>If 'log10_trans 
log10-transformed before calculating the RMSE. In the case where
observed values are reported in summary format, each sample mean and sample
SD (reported on the natural scale, i.e. the mean and SD of natural-scale
individual observations) are used to produce an estimate of the log10-scale
sample mean and sample SD (i.e., the mean and SD of log10-transformed
individual observations), using [convert_summary_to_log10()].
</p>
<p>The formulas are as follows. Again, <code class="reqn">\bar{y}_i</code> is the sample mean for
group <code class="reqn">i</code>. <code class="reqn">s_i</code> is the sample standard deviation for group <code class="reqn">i</code>.
</p>
<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample mean}_i = \log_{10}
\left(\frac{\bar{y}_i^2}{\sqrt{\bar{y}_i^2 + s_i^2}} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample SD}_i = \sqrt{\log_{10} \left(1 +
\frac{s_i^2}{\bar{y}_i^2} \right)}</code>
</p>



<h3>Value</h3>

<p>A 'data.frame' with calculated RMSE as the final column. There is one row per
each model in &lsquo;obj'&rsquo;s [stat_model()] element, i.e. each PK model that was
fitted to the data, each [optimx::optimx()] methods (specified in
[settings_optimx()]), 'rmse_group' specified.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado
</p>


<h3>See Also</h3>

<p>[calc_rmse()]
</p>
<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rsq.pk">rsq.pk</a>()</code>
</p>

<hr>
<h2 id='rowwise_calc_percentages'>Helper function for calculating percentages of count data, by row</h2><span id='topic+rowwise_calc_percentages'></span>

<h3>Description</h3>

<p>This function takes totals and calculates rowise percentages across columns
Expects columns for each percentage, can specify a vector of &quot;grouping&quot; column names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rowwise_calc_percentages(data, group_cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rowwise_calc_percentages_+3A_data">data</code></td>
<td>
<p>A data.frame that contains columns of count data and
possibly columns of group names.</p>
</td></tr>
<tr><td><code id="rowwise_calc_percentages_+3A_group_cols">group_cols</code></td>
<td>
<p>String or numeric indices for the columns which contain
grouping variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with rowwise totals and percentages
</p>

<hr>
<h2 id='rsq'>rsq()</h2><span id='topic+rsq'></span>

<h3>Description</h3>

<p>This is the S3 method generic for rsq()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="rsq_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the R-squared of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>See Also</h3>

<p>[rsq.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='rsq.default'>Default method for rsq()</h2><span id='topic+rsq.default'></span>

<h3>Description</h3>

<p>Default method for rsq()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
rsq(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="rsq.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='rsq.pk'>Calculate R-squared for observed vs. predicted values</h2><span id='topic+rsq.pk'></span>

<h3>Description</h3>

<p>Calculate the square of the Pearson correlation coefficient (r) between
observed and model-predicted values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
rsq(
  obj,
  newdata = NULL,
  model = NULL,
  method = NULL,
  exclude = TRUE,
  use_scale_conc = FALSE,
  rsq_group = NULL,
  sub_pLOQ = TRUE,
  suppress.messages = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsq.pk_+3A_obj">obj</code></td>
<td>
<p>A 'pk' object</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_newdata">newdata</code></td>
<td>
<p>Optional: A 'data.frame' with new data for which to make
predictions and compute R-squared. If NULL (the default), then R-squared will be
computed for the data in 'obj$data'. 'newdata' is required to contain at
least the following variables: 'Time', 'Time.Units', 'Dose', 'Route',
'Media', 'Conc', 'Conc_SD', 'N_Subjects', 'Detect'.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions and calculate R-squared. If NULL (the default), R-squared will be
returned for all of the models in 'obj$stat_model'.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions and calculate R-squared. If NULL (the default),
RMSEs will be returned for all of the models in
'obj$optimx_settings$method'.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_exclude">exclude</code></td>
<td>
<p>Logical: 'TRUE' to compute the R-squared excluding any observations
in the data marked for exclusion (if there is a variable 'exclude' in the
data, an observation is marked for exclusion when 'exclude 
'FALSE' to include all observations, regardless of exclusion status.
Default 'TRUE'.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_use_scale_conc">use_scale_conc</code></td>
<td>
<p>Possible values: 'TRUE' (default), 'FALSE', or a named list with
elements 'dose_norm' and 'log10_trans' which themselves should be either
'TRUE' or 'FALSE'. If 'use_scale_conc = TRUE' (the default for this
function), then the concentration scaling/transformations in 'obj' will be
applied to both predicted and observed concentrations when the
R-squared is computed (see [calc_rsq()] for details). If 'use_scale_conc = FALSE', then no
concentration scaling or transformation will be applied when the
R-squared is computed. If 'use_scale_conc = list(dose_norm = ...,
log10_trans = ...)', then the specified dose normalization and/or
log10-transformation will be applied.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_rsq_group">rsq_group</code></td>
<td>
<p>Default: Chemical, Species. Determines what the data
grouping that is used to calculate R-squared value. Should be set to lowest number
of variables that still would return unique experimental conditions.
Input in the form of 'ggplot2::vars(Chemical, Species, Route, Media, Dose)'.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>TRUE (default): Substitute all predictions below the LOQ with
the LOQ before computing R-squared. FALSE: do not.</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in
'obj$settings_preprocess$suppress.messages'</p>
</td></tr>
<tr><td><code id="rsq.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate the square of the Pearson correlation coefficient (r) between
observed and model-predicted values, when observed data may be left-censored
(non-detect) or may be reported in summary form (as sample mean, sample
standard deviation, and sample number of subjects). Additionally, handle the
situation when observed data and predictions need to be log-transformed
before RMSE is calculated.
</p>
<p><code class="reqn">r^2</code> is calculated according to the following formula, to properly
handle multi-subject observations reported in summary format:
</p>
<p style="text-align: center;"><code class="reqn"> r^2 = \left(
\frac{
\sum_{i=1}^G \mu_i n_i \bar{y}_i -
(\bar{\mu} + \bar{y}) \sum_{i=1}^G n_i \mu_i +
(\bar{mu} \bar{y}) \sum_{i=1}^G n_i
}
{ \sqrt{
\sum_{i=1}^G (n_i - 1) s_i^2 +
\sum_{i=1}^G n_i \bar{y}_i^2 -
2 \bar{y} \sum_{i=1}^G n_i \bar{y}_i +
N + \bar{y}^2
  }
\sqrt{
\sum_{i=1}^G n_i \mu_i^2 -
2 \bar{y} \sum_{i=1}^G n_i \mu_i +
N + \bar{y}^2
}
} \right)^2
</code>
</p>

<p>In this formula, there are <code class="reqn">G</code> groups (reported observations). (For CvTdb
data, a &quot;group&quot; is a specific combination of chemical, species, route,
medium, dose, and timepoint.) <code class="reqn">n_i</code> is the number of subjects for group
<code class="reqn">i</code>. <code class="reqn">\bar{y}_i</code> is the sample mean for group <code class="reqn">i</code>. <code class="reqn">s_i</code> is
the sample standard deviation for group <code class="reqn">i</code>.<code class="reqn">\mu_i</code> is the
model-predicted value for group <code class="reqn">i</code>.
<code class="reqn">\bar{y}</code> is the grand mean of observations:
</p>
<p style="text-align: center;"><code class="reqn"> \bar{y} = \frac{ \sum_{i=1}^G n_i \bar{y}_i }{\sum_{i=1}^G n_i} </code>
</p>

<p><code class="reqn">\bar{\mu}</code> is the grand mean of predictions:
</p>
<p style="text-align: center;"><code class="reqn"> \bar{\mu} = \frac{ \sum_{i=1}^G n_i \mu_i }{\sum_{i=1}^G n_i} </code>
</p>

<p><code class="reqn">N</code> is the grand total of subjects:
</p>
<p style="text-align: center;"><code class="reqn">N = \sum_{i=1}^G n_i</code>
</p>

<p>For the non-summary case (<code class="reqn">N</code> single-subject observations, with all
<code class="reqn">n_i = 1</code>, <code class="reqn">s_i = 0</code>, and <code class="reqn">\bar{y}_i = y_i</code>), this formula
reduces to the familiar formula
</p>
<p style="text-align: center;"><code class="reqn"> r^2 = \left( \frac{\sum_{i=1}^N (y_i - \bar{y}) (\mu_i - \bar{\mu})}
{\sqrt{ \sum_{i=1}^N (y_i - \bar{y})^2 }
\sqrt{ \sum_{i=1}^N (\mu_i - \bar{\mu})^2 }
 } \right)^2
 </code>
</p>

<p># Left-censored data
</p>
<p>If the observed value is censored, and the predicted value is less than the
reported LOQ, then the observed value is (temporarily) set equal to the
predicted value, for an effective error of zero.
</p>
<p>If the observed value is censored, and the predicted value is greater than
the reported LOQ, the the observed value is (temporarily) set equal to the
reported LOQ, for an effective error of (LOQ - predicted).
</p>
<p># Log10 transformation
</p>
<p>If 'log10_trans 
log10(observations) vs. log10(predictions).
</p>
<p>In the case where observed values are reported in summary format, each sample
mean and sample SD (reported on the natural scale, i.e. the mean and SD of
natural-scale individual observations) are used to produce an estimate of the
log10-scale sample mean and sample SD (i.e., the mean and SD of
log10-transformed individual observations), using
[convert_summary_to_log10()].
</p>
<p>The formulas are as follows. Again, <code class="reqn">\bar{y}_i</code> is the sample mean for
group <code class="reqn">i</code>. <code class="reqn">s_i</code> is the sample standard deviation for group <code class="reqn">i</code>.
</p>
<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample mean}_i = \log_{10}
\left(\frac{\bar{y}_i^2}{\sqrt{\bar{y}_i^2 + s_i^2}} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">\textrm{log10-scale sample SD}_i = \sqrt{\log_{10} \left(1 +
\frac{s_i^2}{\bar{y}_i^2} \right)}</code>
</p>



<h3>Value</h3>

<p>A dataframe with one row for each 'data_group', 'model' and 'method'.
The final column contains the R-squared of the model fitted by the corresponding
method, using the data in 'newdata'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>


<h3>See Also</h3>

<p>[calc_rsq()]
</p>
<p>Other fit evaluation metrics: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>
</p>
<p>Other methods for fitted pk objects: 
<code><a href="#topic+AAFE.pk">AAFE.pk</a>()</code>,
<code><a href="#topic+AFE.pk">AFE.pk</a>()</code>,
<code><a href="#topic+AIC.pk">AIC.pk</a>()</code>,
<code><a href="#topic+BIC.pk">BIC.pk</a>()</code>,
<code><a href="#topic+coef.pk">coef.pk</a>()</code>,
<code><a href="#topic+coef_sd.pk">coef_sd.pk</a>()</code>,
<code><a href="#topic+eval_tkstats.pk">eval_tkstats.pk</a>()</code>,
<code><a href="#topic+get_fit.pk">get_fit.pk</a>()</code>,
<code><a href="#topic+get_hessian.pk">get_hessian.pk</a>()</code>,
<code><a href="#topic+get_tkstats.pk">get_tkstats.pk</a>()</code>,
<code><a href="#topic+logLik.pk">logLik.pk</a>()</code>,
<code><a href="#topic+predict.pk">predict.pk</a>()</code>,
<code><a href="#topic+residuals.pk">residuals.pk</a>()</code>,
<code><a href="#topic+rmse.pk">rmse.pk</a>()</code>
</p>

<hr>
<h2 id='scale_conc'>Scale concentrations</h2><span id='topic+scale_conc'></span>

<h3>Description</h3>

<p>Scale concentrations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_conc(dose_norm = FALSE, log10_trans = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scale_conc_+3A_dose_norm">dose_norm</code></td>
<td>
<p>Logical: Whether to normalize observed concentrations (and
observed concentration standard deviations and limits of quantification) by
dividing them by the corresponding dose. Default 'FALSE'.</p>
</td></tr>
<tr><td><code id="scale_conc_+3A_log10_trans">log10_trans</code></td>
<td>
<p>Logical: Whether to apply a 'log10()' transformation to
observed concentrations (and limits of quantification), after any dose
normalization is applied. Default 'FALSE'.</p>
</td></tr>
<tr><td><code id="scale_conc_+3A_...">...</code></td>
<td>
<p>Other arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'pk_scales': A named list with two elements. The
first element 'name = &quot;conc&quot;' denotes the variable to be scaled. The second
element 'value' is itself a named list of the arguments supplied to
[scale_conc()]). This object is usually added to an existing [pk()] object
using '+'. See [pk_add.pk_scales()].
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='scale_time'>Scale times</h2><span id='topic+scale_time'></span>

<h3>Description</h3>

<p>Transform time data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_time(new_units = "identity", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scale_time_+3A_new_units">new_units</code></td>
<td>
<p>New units to use for time. Default is '&quot;identity&quot;' (leave
time in the original units). Another useful option is '&quot;auto&quot;', to
automatically select new time units based on the time of the last detected
observation. You may also specify any time units understood by
'lubridate::duration()', i.e., '&quot;seconds&quot;', '&quot;hours&quot;', '&quot;days&quot;', '&quot;weeks&quot;',
'&quot;months&quot;', '&quot;years&quot;', '&quot;milliseconds&quot;', '&quot;microseconds&quot;', '&quot;nanoseconds&quot;',
and/or '&quot;picoseconds&quot;'. You may only specify one new unit (e.g., 'new_units
= c(&quot;days&quot;, &quot;weeks&quot;)' is not valid).</p>
</td></tr>
<tr><td><code id="scale_time_+3A_...">...</code></td>
<td>
<p>Other arguments (not currently used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'pk_scales': A named list with two elements 'name
= &quot;time&quot;' (denoting the variable to be scaled) and 'value = list(&quot;new_units&quot; =
new_units, ...)' (denoting the arguments supplied to [scale_time()]). See
[pk_add.pk_scales()].
</p>

<hr>
<h2 id='settings_data_info'>Data info settings</h2><span id='topic+settings_data_info'></span>

<h3>Description</h3>

<p>Data info settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>settings_data_info(
  summary_group = dplyr::vars(Chemical, Species, Reference, Route, Media, Dose),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="settings_data_info_+3A_summary_group">summary_group</code></td>
<td>
<p>A set of variables. Data will be split into groups according
to unique combinations of these variables, and non-compartmental analysis
will be performed separately on each group. Default 'dplyr::vars(Chemical,
Species, Reference, Route, Media, Dose)'.</p>
</td></tr>
<tr><td><code id="settings_data_info_+3A_...">...</code></td>
<td>
<p>Other arguments (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'c(pkproto, pk_settings_data_info)'
</p>

<hr>
<h2 id='settings_optimx'>'optimx' optimizer settings</h2><span id='topic+settings_optimx'></span>

<h3>Description</h3>

<p>'optimx' optimizer settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>settings_optimx(
  method = c("bobyqa", "L-BFGS-B"),
  itnmax = 1e+06,
  hessian = FALSE,
  control = list(kkt = FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="settings_optimx_+3A_method">method</code></td>
<td>
<p>The name(s) of optimization methods to be used. See
[optimx::optimx()] for options. Default is '&quot;bobyqa&quot;'.</p>
</td></tr>
<tr><td><code id="settings_optimx_+3A_itnmax">itnmax</code></td>
<td>
<p>The maximum number of iterations; as in [optimx::optimx()].</p>
</td></tr>
<tr><td><code id="settings_optimx_+3A_hessian">hessian</code></td>
<td>
<p>Whether to compute the Hessian at the final set of parameters; as in [optimx::optimx()].</p>
</td></tr>
<tr><td><code id="settings_optimx_+3A_control">control</code></td>
<td>
<p>A list of control parameters for the optimizer; see [optimx::optimx()] for options and details.</p>
</td></tr>
<tr><td><code id="settings_optimx_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'pk_settings'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='settings_preprocess'>Data preprocessing settings</h2><span id='topic+settings_preprocess'></span>

<h3>Description</h3>

<p>Data preprocessing settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>settings_preprocess(
  routes_keep = c("oral", "iv"),
  media_keep = c("blood", "plasma"),
  ratio_conc_dose = 1,
  impute_loq = TRUE,
  loq_group = dplyr::vars(Chemical, Species, Reference, Media),
  calc_loq_factor = 0.9,
  impute_sd = TRUE,
  sd_group = dplyr::vars(Chemical, Species, Reference, Media),
  suppress.messages = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="settings_preprocess_+3A_routes_keep">routes_keep</code></td>
<td>
<p>Character: A list of routes to keep. Data will be filtered
so that the harmonized variable 'Route' includes only values in
'routes_keep'. Default is 'c(&quot;oral&quot;, &quot;iv&quot;)'.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_media_keep">media_keep</code></td>
<td>
<p>Character: A list of media to keep. Data will be filtered
so that the harmonized variable name 'Media' includes only values in
'media_keep'. Default is 'c(&quot;blood&quot;, &quot;plasma&quot;)'.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_ratio_conc_dose">ratio_conc_dose</code></td>
<td>
<p>Numeric: The ratio of mass units of observed
concentrations to mass units of applied doses. Default 1, to indicate the
same mass units are used for both.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_impute_loq">impute_loq</code></td>
<td>
<p>TRUE or FALSE: Whether to impute missing LOQ values.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_loq_group">loq_group</code></td>
<td>
<p>A list of variables, specified using a call to
[dplyr::vars()]. These should be harmonized variable names. Unique
combinations of these variables define groups of data. Within each group,
any missing LOQ values will be imputed as the minimum detected Value in the
group, multiplied by 'calc_loq_factor'. Default is 'dplyr::vars(Chemical,
Species, Reference, Media)'.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_calc_loq_factor">calc_loq_factor</code></td>
<td>
<p>A numeric factor used for imputing missing LOQ.
Within each group defined in 'loq_group', any missing LOQ values will be
imputed as the minimum detected Value in the group, multiplied by
'calc_loq_factor'. Default 0.9.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_impute_sd">impute_sd</code></td>
<td>
<p>TRUE or FALSE: Whether to impute missing SD values.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_sd_group">sd_group</code></td>
<td>
<p>A list of variables, specified using a call to
[dplyr::vars()]. These should be harmonized variable names. Unique
combinations of these variables define groups of data. Within each group,
any missing SD values will be imputed as the minimum non-missing SD value
in the group. Default is 'dplyr::vars(Chemical, Species, Reference,
Media)'.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>TRUE or FALSE: Whether to suppress verbose messages.
Default FALSE.</p>
</td></tr>
<tr><td><code id="settings_preprocess_+3A_...">...</code></td>
<td>
<p>Any additional arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'pk_settings_preprocess'. This is a named list of
the arguments provided to this function and their values.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='stat_error_model'>Error model</h2><span id='topic+stat_error_model'></span>

<h3>Description</h3>

<p>Define an error model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_error_model(error_group = vars(Chemical, Species, Reference, Media), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat_error_model_+3A_error_group">error_group</code></td>
<td>
<p>Defined using [dplyr::vars()]: A set of harmonized
variables whose unique combinations define a group with its own error
variance. These variables refer to the 'data' element of the 'pk' object to
which 'stat_error_model()' is added. The variables should not be quoted.
Default is 'vars(Chemical, Species, Reference, Media)'.</p>
</td></tr>
<tr><td><code id="stat_error_model_+3A_...">...</code></td>
<td>
<p>Additional arguments. Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'stat_error_model' defines groupings for a fixed-effects error model. For each
model in 'stat_model', a single set of model parameters will be fit to 'data'.
In order to do the fitting, the residual errors (observed concentrations -
model-predicted concentrations) are assumed to obey a zero-mean normal
distribution. However, in this package, the residuals are not all required to
obey the *same* zero-mean normal distribution. Different groups of residuals
may obey zero-mean normal distributions with different variances.
'stat_error_model' defines these groups as unique combinations of the
variables given in argument 'error_group'. For example, the default value
'vars(Chemical, Species, Reference, Media)' means that for each group of
observations in 'data' with a unique combination of 'Chemical', 'Species',
'Reference', and 'Media', there is a separate residual error variance. For
example, if there happened to be three such unique combinations, there would
be three error variances.
</p>
<p>If you want all residuals to obey the same zero-mean normal distribution
(i.e., for there to be only one residual error variance), then you should
provide an 'error_group' that puts all the data in the same group. For
example, since all data in 'data' should already be for a single 'Chemical'
and 'Species', you could provide 'error_group = vars(Chemical, Species)' to
put all the data in the same group.
</p>
<p>Note that, since all data in 'data' should already be for a single 'Chemical'
and 'Species', you could leave out 'Chemical' and 'Species' from 'error_group'
and still get the same result. However, we recommend explicitly including
'Chemical' and 'Species'. Tncluding them will make your code more explicit and
transparent, and it does no harm. In addition, [invivopkfit] may be extended
in the future to allow input of data with multiple chemicals or species;
explicitly including 'Chemical' and 'Species' in your 'error_group' will
future-proof your code in that sense.
</p>
<p>The error variance(s) are hyperparameters that will be estimated from the data
along with the model parameters. That means there needs to be enough data to
fit the model parameters plus the error variances. For example, if you are
fitting a 1-compartment model to oral and IV data measured in plasma, and
using an error model with three separate error-variance groups (e.g. three
different References), then you are trying to fit 4 model parameters (kelim,
Vdist, Fgutabs, kgutabs) plus 3 error variances, for a total of 7 parameters.
That means you need to have at least 8 data points. (When you call [prefit()],
this checking is done automatically. But it is useful to be aware of this, in
case you are trying to figure out why your fit was aborted due to insufficient data availability.)
</p>


<h3>Value</h3>

<p>An object of class 'pk_stat_error_model': A named list of all the
arguments to 'stat_error_model'.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='stat_model'>Add PK model(s) to be fitted</h2><span id='topic+stat_model'></span>

<h3>Description</h3>

<p>Add PK model(s) to be fitted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_model(model = c("model_flat", "model_1comp", "model_2comp"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat_model_+3A_model">model</code></td>
<td>
<p>A character vector: the name(s) of models to be fitted. These
should be the names of objects of class 'pk_model'. Built-in options are
['model_flat'], ['model_1comp'], and ['model_2comp']. You may add your own
model by using [pk_model()].</p>
</td></tr>
<tr><td><code id="stat_model_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>

<hr>
<h2 id='status_data_info'>Status ID for data summary info</h2><span id='topic+status_data_info'></span>

<h3>Description</h3>

<p>An integer status that denotes [data_info()] has been completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>status_data_info
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 1.
</p>

<hr>
<h2 id='status_fit'>Status ID for fitting</h2><span id='topic+status_fit'></span>

<h3>Description</h3>

<p>An integer status that denotes [fit()] has been completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>status_fit
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 1.
</p>

<hr>
<h2 id='status_init'>Status ID for initialization</h2><span id='topic+status_init'></span>

<h3>Description</h3>

<p>An integer status that denotes a [pk()] object has been initialized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>status_init
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 1.
</p>

<hr>
<h2 id='status_prefit'>Status ID for pre-fitting</h2><span id='topic+status_prefit'></span>

<h3>Description</h3>

<p>An integer status that denotes [prefit()] has been completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>status_prefit
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 1.
</p>

<hr>
<h2 id='status_preprocess'>Status ID for preprocessing</h2><span id='topic+status_preprocess'></span>

<h3>Description</h3>

<p>An integer status that denotes [preprocess_data()] has been completed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>status_preprocess
</code></pre>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 1.
</p>

<hr>
<h2 id='subtract_pk'>Subtract various 'pkproto' objects from a 'pk' object</h2><span id='topic+subtract_pk'></span>

<h3>Description</h3>

<p>Subtract various 'pkproto' objects from a 'pk' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subtract_pk(pk_obj, object, objectname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subtract_pk_+3A_pk_obj">pk_obj</code></td>
<td>
<p>The 'pk' object</p>
</td></tr>
<tr><td><code id="subtract_pk_+3A_object">object</code></td>
<td>
<p>The 'pkproto' object to be subtracted</p>
</td></tr>
<tr><td><code id="subtract_pk_+3A_objectname">objectname</code></td>
<td>
<p>The name of the 'pkproto' object to be subtracted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The 'pk' object modified by the subtraction.
</p>

<hr>
<h2 id='summary.pk'>Print summary of a 'pk' object</h2><span id='topic+summary.pk'></span>

<h3>Description</h3>

<p>This summary includes summary information about the data; about any data
transformations applied; about the models being fitted; about the error model
being applied; and any fitting results, if the 'pk' object has been fitted.
It also includes TK quantities calculated from the fitted model parameters,
e.g. halflife; clearance; tmax; Cmax; AUC; Css.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.pk_+3A_object">object</code></td>
<td>
<p>A [pk] object.</p>
</td></tr>
<tr><td><code id="summary.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 'data.frame's consisting of a summary table of fitting options and results.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring
</p>

<hr>
<h2 id='time_conversions'>Time conversion table</h2><span id='topic+time_conversions'></span>

<h3>Description</h3>

<p>A 'data.frame' that has the converted units from &quot;time_units&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_conversions
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 121 rows and 3 columns.
</p>

<hr>
<h2 id='time_units'>Allowable time units</h2><span id='topic+time_units'></span>

<h3>Description</h3>

<p>A 'character' vector of allowable units for time variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_units
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 11.
</p>


<h3>Details</h3>

<p>These are the time units understood by [lubridate::period()] and [lubridate::duration()].
</p>

<hr>
<h2 id='tkstats_1comp'>Toxicokinetic statistics for 1-compartment model</h2><span id='topic+tkstats_1comp'></span>

<h3>Description</h3>

<p>Calculate predicted toxicokinetic statistics for a 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkstats_1comp(pars, route, medium, dose, time_unit, conc_unit, vol_unit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tkstats_1comp_+3A_pars">pars</code></td>
<td>
<p>A named vector of model parameters (e.g. from [coef.pk()]).</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_route">route</code></td>
<td>
<p>Character: The route for which to compute TK stats. Currently
only &quot;oral&quot; and &quot;iv&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_medium">medium</code></td>
<td>
<p>Character: the media (tissue) for which to compute TK stats.
Currently only &quot;blood&quot; and &quot;plasma&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_dose">dose</code></td>
<td>
<p>Numeric: A dose for which to calculate TK stats.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_time_unit">time_unit</code></td>
<td>
<p>Character: the units of time used for the parameters 'par'.
For example, if 'par[&quot;kelim&quot;]' is in units of 1/weeks, then 'time_unit =
&quot;weeks&quot;'. If 'par[&quot;kelim&quot;]' is in units of 1/hours, then 'time_unit =
&quot;hours&quot;'. This is used to calculate the steady-state plasma/blood
concentration for long-term daily dosing of 1 mg/kg/day.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_conc_unit">conc_unit</code></td>
<td>
<p>Character: The units of concentration.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_vol_unit">vol_unit</code></td>
<td>
<p>Character: The units of dose.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Statistics computed
</p>
<p>## Total clearance
</p>
<p style="text-align: center;"><code class="reqn">\textrm{CL}_{tot} = k_{elim} + V_{dist}</code>
</p>

<p>## Steady-state plasma concentration for long-term daily dose of 1 mg/kg/day
</p>
<p>The dosing interval <code class="reqn">\tau = \frac{1}{\textrm{day}}</code> will be converted to
the same units as <code class="reqn">k_{elim}</code>.
</p>
<p>To convert to steady-state *blood* concentration, multiply by the
blood-to-plasma ratio.
</p>
<p>### Oral route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{F_{gutabs} V_{dist}}{k_{elim} \tau}</code>
</p>

<p>### Intravenous route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{1}{24 * \textrm{CL}_{tot}}</code>
</p>

<p>## Half-life of elimination
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Halflife} = \frac{\log(2)}{k_{elim}}</code>
</p>

<p>## Time of peak concentration
</p>
<p>For oral route:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\log \left( \frac{k_{gutabs}}{k_{elim}} \right)}{k_{gutabs} -
k_{elim}}</code>
</p>

<p>For intravenous route, time of peak concentration is always 0.
</p>
<p>## Peak concentration
</p>
<p>Evaluate [cp_1comp()] at the time of peak concentration.
</p>
<p>## AUC evaluated at infinite time
</p>
<p>Evaluate [auc_1comp()] at time = 'Inf'.
</p>
<p>## AUC evaluated at the time of the last observation
</p>
<p>Evaluate [auc_1comp()] at time = 'tlast'.
</p>


<h3>Value</h3>

<p>A 'data.frame' with two variables:
- 'param_name' = 'c(&quot;CLtot&quot;, &quot;CLtot/Fgutabs&quot;, &quot;Css&quot;, &quot;halflife&quot;, &quot;tmax&quot;, &quot;Cmax&quot;, &quot;AUC_infinity&quot;)'
- 'param_value' = The corresponding values for each statistic (which may be NA if that statistic could not be computed).
</p>


<h3>Author(s)</h3>

<p>John Wambaugh, Caroline Ring
</p>

<hr>
<h2 id='tkstats_1comp_cl'>Toxicokinetic statistics for 1-compartment model with specific clearance</h2><span id='topic+tkstats_1comp_cl'></span>

<h3>Description</h3>

<p>Calculate predicted toxicokinetic statistics for a 1-compartment model.
This does use the parameters for the 'model_1comp_cl' that are taken from
[httk] estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkstats_1comp_cl(
  pars,
  route,
  medium,
  dose,
  time_unit,
  conc_unit,
  vol_unit,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tkstats_1comp_cl_+3A_pars">pars</code></td>
<td>
<p>A named vector of model parameters (e.g. from [coef.pk()]).</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_route">route</code></td>
<td>
<p>Character: The route for which to compute TK stats. Currently
only &quot;oral&quot; and &quot;iv&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_medium">medium</code></td>
<td>
<p>Character: the media (tissue) for which to compute TK stats.
Currently only &quot;blood&quot; and &quot;plasma&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_dose">dose</code></td>
<td>
<p>Numeric: A dose for which to calculate TK stats.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_time_unit">time_unit</code></td>
<td>
<p>Character: the units of time used for the parameters 'par'.
For example, if 'par[&quot;kelim&quot;]' is in units of 1/weeks, then 'time_unit =
&quot;weeks&quot;'. If 'par[&quot;kelim&quot;]' is in units of 1/hours, then 'time_unit =
&quot;hours&quot;'. This is used to calculate the steady-state plasma/blood
concentration for long-term daily dosing of 1 mg/kg/day.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_conc_unit">conc_unit</code></td>
<td>
<p>Character: The units of concentration.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_vol_unit">vol_unit</code></td>
<td>
<p>Character: The units of dose.</p>
</td></tr>
<tr><td><code id="tkstats_1comp_cl_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Statistics computed
</p>
<p>## Total clearance
</p>
<p style="text-align: center;"><code class="reqn">\textrm{CL}_{tot} = k_{elim} + V_{dist}</code>
</p>

<p>## Steady-state plasma concentration for long-term daily dose of 1 mg/kg/day
</p>
<p>The dosing interval <code class="reqn">\tau = \frac{1}{\textrm{day}}</code> will be converted to
the same units as <code class="reqn">k_{elim}</code>.
</p>
<p>To convert to steady-state *blood* concentration, multiply by the
blood-to-plasma ratio.
</p>
<p>### Oral route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{F_{gutabs} V_{dist}}{k_{elim} \tau}</code>
</p>

<p>### Intravenous route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{1}{24 * \textrm{CL}_{tot}}</code>
</p>

<p>## Half-life of elimination
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Halflife} = \frac{\log(2)}{k_{elim}}</code>
</p>

<p>## Time of peak concentration
</p>
<p>For oral route:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\log \left( \frac{k_{gutabs}}{k_{elim}} \right)}{k_{gutabs} -
k_{elim}}</code>
</p>

<p>For intravenous route, time of peak concentration is always 0.
</p>
<p>## Peak concentration
</p>
<p>Evaluate [cp_1comp_cl()] at the time of peak concentration.
</p>
<p>## AUC evaluated at infinite time
</p>
<p>Evaluate [auc_1comp_cl()] at time = 'Inf'.
</p>
<p>## AUC evaluated at the time of the last observation
</p>
<p>Evaluate [auc_1comp_cl()] at time = 'tlast'.
</p>


<h3>Value</h3>

<p>A 'data.frame' with two variables:
- 'param_name' = 'c(&quot;CLtot&quot;, &quot;CLtot/Fgutabs&quot;, &quot;Css&quot;, &quot;halflife&quot;, &quot;tmax&quot;, &quot;Cmax&quot;, &quot;AUC_infinity&quot;)'
- 'param_value' = The corresponding values for each statistic (which may be NA if that statistic could not be computed).
</p>


<h3>Author(s)</h3>

<p>John Wambaugh, Caroline Ring
</p>

<hr>
<h2 id='tkstats_2comp'>Toxicokinetic statistics for 1-compartment model</h2><span id='topic+tkstats_2comp'></span>

<h3>Description</h3>

<p>Calculate predicted toxicokinetic statistics for a 1-compartment model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkstats_2comp(pars, route, medium, dose, time_unit, conc_unit, vol_unit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tkstats_2comp_+3A_pars">pars</code></td>
<td>
<p>A named numeric vector of model parameters (e.g. from [coef.pk()]).</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_route">route</code></td>
<td>
<p>Character: The route for which to compute TK stats. Currently
only &quot;oral&quot; and &quot;iv&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_medium">medium</code></td>
<td>
<p>Character: the media (tissue) for which to compute TK stats..
Currently only &quot;blood&quot; and &quot;plasma&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_dose">dose</code></td>
<td>
<p>Numeric: A dose for which to calculate TK stats.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_time_unit">time_unit</code></td>
<td>
<p>Character: the units of time used for the parameters 'par'.
For example, if 'par[&quot;kelim&quot;]' is in units of 1/weeks, then 'time_unit =
&quot;weeks&quot;'. If 'par[&quot;kelim&quot;]' is in units of 1/hours, then 'time_unit =
&quot;hours&quot;'. This is used to calculate the steady-state plasma/blood
concentration for long-term daily dosing of 1 mg/kg/day.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_conc_unit">conc_unit</code></td>
<td>
<p>Character: The units of concentration.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_vol_unit">vol_unit</code></td>
<td>
<p>Character: The units of dose.</p>
</td></tr>
<tr><td><code id="tkstats_2comp_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p># Statistics computed
</p>
<p>## Total clearance
</p>
<p style="text-align: center;"><code class="reqn">\textrm{CL}_{tot} = k_{elim} + V_{1}</code>
</p>

<p>## Steady-state plasma concentration for long-term daily dose of 1 mg/kg/day
</p>
<p>To convert to steady-state *blood* concentration, multiply by the
blood-to-plasma ratio.
</p>
<p>The dosing interval <code class="reqn">\tau = \frac{1}{\textrm{day}}</code> will be converted to
the same units as <code class="reqn">k_{elim}</code>.
</p>
<p>### Oral route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{F_{gutabs} V_{1}}{k_{elim} \tau}</code>
</p>

<p>### Intravenous route
</p>
<p style="text-align: center;"><code class="reqn">C_{ss} = \frac{1}{\textrm{CL}_{tot} \tau}</code>
</p>

<p>## Half-life of elimination
</p>
<p style="text-align: center;"><code class="reqn">\textrm{Halflife} = \frac{\log(2)}{k_{elim}}</code>
</p>

<p>## Time of peak concentration
</p>
<p>For oral route:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\log \left( \frac{k_{gutabs}}{k_{elim}} \right)}{k_{gutabs} -
k_{elim}}</code>
</p>

<p>For intravenous route, time of peak concentration is always 0.
</p>
<p>## Peak concentration
</p>
<p>Evaluate [cp_1comp()] at the time of peak concentration.
</p>
<p>## AUC evaluated at infinite time
</p>
<p>Evaluate [auc_1comp()] at time = 'Inf'.
</p>
<p>## AUC evaluated at the time of the last observation
</p>
<p>Evaluate [auc_1comp()] at time = 'tlast'.
</p>


<h3>Value</h3>

<p>A 'data.frame' with two variables:
- 'param_name' = 'c(&quot;CLtot&quot;, &quot;CLtot/Fgutabs&quot;, &quot;Css&quot;, &quot;halflife&quot;, &quot;tmax&quot;, &quot;Cmax&quot;, &quot;AUC_infinity&quot;, &quot;A&quot;, &quot;B&quot;, &quot;alpha&quot;, &quot;beta&quot;, &quot;Vbeta&quot;, &quot;Vbeta_Fgutabs&quot;, &quot;Vss&quot;, &quot;Vss_Fgutabs&quot;)'
- 'param_value' = The corresponding values for each statistic (which may be NA if that statistic could not be computed; e.g. all of the '&quot;x_Fgutabs&quot;' parameters can only be computed if 'route = &quot;oral&quot;' ).
</p>


<h3>Author(s)</h3>

<p>John Wambaugh, Caroline Ring
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>
<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+transformed_params_2comp">transformed_params_2comp</a>()</code>
</p>

<hr>
<h2 id='tkstats_flat'>TK stats for flat model</h2><span id='topic+tkstats_flat'></span>

<h3>Description</h3>

<p>TK stats for flat model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkstats_flat(pars, route, medium, dose, time_unit, conc_unit, vol_unit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tkstats_flat_+3A_pars">pars</code></td>
<td>
<p>A named numeric vector of model parameters (e.g. from [coef.pk()]).</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_route">route</code></td>
<td>
<p>Character: The route for which to compute TK stats. Currently
only &quot;oral&quot; and &quot;iv&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_medium">medium</code></td>
<td>
<p>Character: the media (tissue) for which to compute TK stats.
Currently only &quot;blood&quot; and &quot;plasma&quot; are supported.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_dose">dose</code></td>
<td>
<p>Numeric: A dose for which to calculate TK stats.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_time_unit">time_unit</code></td>
<td>
<p>Character: the units of time.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_conc_unit">conc_unit</code></td>
<td>
<p>Character: The units of concentration.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_vol_unit">vol_unit</code></td>
<td>
<p>Character: The units of dose.</p>
</td></tr>
<tr><td><code id="tkstats_flat_+3A_...">...</code></td>
<td>
<p>Additional arguments not currently in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'data.frame' with two variables:
- 'param_name' = 'c(&quot;CLtot&quot;, &quot;CLtot/Fgutabs&quot;, &quot;Css_1mgkgday&quot;, &quot;halflife&quot;, &quot;Cmax&quot;, &quot;AUC_infinity&quot;)'
- 'param_value' = The corresponding values for each statistic (which may be NA if that statistic could not be computed).
</p>


<h3>Author(s)</h3>

<p>John Wambaugh, Caroline Ring
</p>

<hr>
<h2 id='transformed_params_2comp'>Transformed parameters for 2-compartment model</h2><span id='topic+transformed_params_2comp'></span>

<h3>Description</h3>

<p>Transformed parameters for 2-compartment model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformed_params_2comp(params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformed_params_2comp_+3A_params">params</code></td>
<td>
<p>A named numeric vector of parameters for the 2-compartment
model. Any missing parameters will be filled with 'NA_real_'.</p>
</td></tr>
<tr><td><code id="transformed_params_2comp_+3A_...">...</code></td>
<td>
<p>Additional arguments (not currently used).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named numeric vector of transformed parameters with elements
&quot;alpha&quot;, &quot;beta&quot;, &quot;A_iv_unit&quot;, &quot;B_iv_unit&quot;, &quot;A_oral_unit&quot;, &quot;B_oral_unit&quot;.
</p>


<h3>Author(s)</h3>

<p>Caroline Ring, Gilberto Padilla Mercado, John Wambaugh
</p>


<h3>See Also</h3>

<p>Other built-in model functions: 
<code><a href="#topic+auc_1comp">auc_1comp</a>()</code>,
<code><a href="#topic+auc_1comp_cl">auc_1comp_cl</a>()</code>,
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+auc_flat">auc_flat</a>()</code>,
<code><a href="#topic+cp_1comp">cp_1comp</a>()</code>,
<code><a href="#topic+cp_1comp_cl">cp_1comp_cl</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+cp_flat">cp_flat</a>()</code>,
<code><a href="#topic+get_params_1comp">get_params_1comp</a>()</code>,
<code><a href="#topic+get_params_1comp_cl">get_params_1comp_cl</a>()</code>,
<code><a href="#topic+get_params_1comp_fup">get_params_1comp_fup</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_params_flat">get_params_flat</a>()</code>,
<code><a href="#topic+get_starts_1comp">get_starts_1comp</a>()</code>,
<code><a href="#topic+get_starts_1comp_cl">get_starts_1comp_cl</a>()</code>,
<code><a href="#topic+get_starts_1comp_fup">get_starts_1comp_fup</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+get_starts_flat">get_starts_flat</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>
</p>
<p>Other 2-compartment model functions: 
<code><a href="#topic+auc_2comp">auc_2comp</a>()</code>,
<code><a href="#topic+cp_2comp">cp_2comp</a>()</code>,
<code><a href="#topic+cp_2comp_dt">cp_2comp_dt</a>()</code>,
<code><a href="#topic+get_params_2comp">get_params_2comp</a>()</code>,
<code><a href="#topic+get_starts_2comp">get_starts_2comp</a>()</code>,
<code><a href="#topic+tkstats_2comp">tkstats_2comp</a>()</code>
</p>

<hr>
<h2 id='twofold_test'>twofold_test()</h2><span id='topic+twofold_test'></span>

<h3>Description</h3>

<p>This is the S3 method generic for twofold_test()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twofold_test(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twofold_test_+3A_obj">obj</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="twofold_test_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames.
</p>


<h3>See Also</h3>

<p>[twofold_test.pk()] for the method for class [pk()]
</p>

<hr>
<h2 id='twofold_test.default'>Default method for twofold_test()</h2><span id='topic+twofold_test.default'></span>

<h3>Description</h3>

<p>Default method for twofold_test()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
twofold_test(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twofold_test.default_+3A_obj">obj</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="twofold_test.default_+3A_...">...</code></td>
<td>
<p>Additional arguments currently not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An error, when a non-pk object is used for the first argument.
</p>

<hr>
<h2 id='twofold_test.pk'>Evaluate whether data and predictions are within two-fold of mean or concentration, respectively</h2><span id='topic+twofold_test.pk'></span>

<h3>Description</h3>

<p>At each timepoint across CvT experimental data, there are three ways that data may
be presented. These can be found as either:
- multiple individual observations
- single individual observation
- summarized group of observations (mean concentration and standard deviation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pk'
twofold_test(
  obj,
  sub_pLOQ = TRUE,
  suppress.messages = NULL,
  model = NULL,
  method = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twofold_test.pk_+3A_obj">obj</code></td>
<td>
<p>A pk object.</p>
</td></tr>
<tr><td><code id="twofold_test.pk_+3A_sub_ploq">sub_pLOQ</code></td>
<td>
<p>TRUE (default): Substitute all predictions below the LOQ with
the LOQ before computing fold errors. FALSE: do not. Only used if 'obj' has been fitted and predictions are possible.</p>
</td></tr>
<tr><td><code id="twofold_test.pk_+3A_suppress.messages">suppress.messages</code></td>
<td>
<p>Logical: whether to suppress message printing. If
NULL (default), uses the setting in 'obj$settings_preprocess$suppress.messages'.</p>
</td></tr>
<tr><td><code id="twofold_test.pk_+3A_model">model</code></td>
<td>
<p>Optional: Specify one or more of the fitted models for which to
make predictions. If NULL (the default), predictions will be returned for
all of the models in 'object$stat_model'.</p>
</td></tr>
<tr><td><code id="twofold_test.pk_+3A_method">method</code></td>
<td>
<p>Optional: Specify one or more of the [optimx::optimx()] methods
for which to make predictions. If NULL (the default), predictions will be
returned for all of the models in 'object$settings_optimx$method'.</p>
</td></tr>
<tr><td><code id="twofold_test.pk_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the purposes of this calculations we largely divide the data into two groups,
those with individual observations, where N_Subjects == 1, and the summarized
group of observations.
</p>
<p>First this creates mean-normalized concentrations for individual data.
Then it summarizes data (individual &amp; summarized) by 'mean' and 'sd'.
It tests whether predictions are within two-fold of mean,
in the latter case whether the 95
</p>
<p>Furthermore if 'pk' object 'status == 5' then it calculates the model error by
evaluating _prediction/concentration_ at each timepoint for all data. Each test
is done for data from individual subject observations and for all data by summarizing the
observations.
</p>
<p>Only non-excluded detects are included in this analysis.
</p>


<h3>Value</h3>

<p>A list of data frames.
</p>


<h3>Author(s)</h3>

<p>Gilberto Padilla Mercado
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
