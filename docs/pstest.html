<!DOCTYPE html><html><head><title>Help for package pstest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pstest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pstest-package'><p>pstest: An R Package for assessing the goodness-of-fit of parametric propensity score models.</p></a></li>
<li><a href='#pstest'><p>pstest: Tests for the Propensity Score</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Specification Tests for Parametric Propensity Score Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3.900</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro H. C. Sant'Anna &lt;pedro.h.santanna@vanderbilt.edu&gt;, Xiaojun Song
    &lt;sxj@gsm.pku.edu.cn&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro H. C. Sant'Anna &lt;pedro.h.santanna@vanderbilt.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The propensity score is one of the most widely used tools in
    studying the causal effect of a treatment, intervention, or policy. Given that
    the propensity score is usually unknown, it has to be estimated, implying that
    the reliability of many treatment effect estimators depends on the correct
    specification of the (parametric) propensity score. This package implements the
    data-driven nonparametric diagnostic tools for detecting propensity score
    misspecification proposed by Sant'Anna and Song (2019) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2019.02.002">doi:10.1016/j.jeconom.2019.02.002</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pedrohcgs/pstest">https://github.com/pedrohcgs/pstest</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, parallel, glmx, MASS, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1.9000</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-08-25 10:45</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-25 15:40:05 UTC; santanph</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-26 09:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='pstest-package'>pstest: An R Package for assessing the goodness-of-fit of parametric propensity score models.</h2><span id='topic+pstest-package'></span>

<h3>Description</h3>

<p>The propensity score is one of the most widely used tools in studying the causal effect
of a treatment, intervention, or policy. Given that the propensity score is usually unknown,
it has to be estimated, implying that the reliability of many treatment effect estimators depends
on the correct specification of the (parametric) propensity score. This package provides
data-driven nonparametric diagnostic tools for detecting propensity score misspecification.
</p>


<h3>Details</h3>

<p>This R package implements the class of specification test for the propensity score
proposed in Sant'Anna and Song (2016), &lsquo;Specification Tests for the Propensity Score&rsquo;,
available at Pedro H.C. Sant'Anna webpage, <a href="http://sites.google.com/site/pedrohcsantanna/">http://sites.google.com/site/pedrohcsantanna/</a>.
</p>
<p>In short, this package implements Kolmogorov-Smirnov and Cramer-von Mises type tests
for parametric propensity score models with either logistic ('logit'), or
normal ('probit') link function. Critical values are computed with the assistance of a
multiplier bootstrap.
</p>
<p>The tests are based on the integrated conditional moment approach, where the weight function
used is based on an orthogonal projection onto the tangent space of nuisance parameters.
As a result, the tests (a) enjoy improved power properties, (b) do not suffer from the
'curse of dimensionality' when the vector of covariates is of high-dimensionality,
(c) are fully data-driven, (e) do not require tuning parameters such as bandwidths, and
(e) are able to detect a broad class of local alternatives converging to the null at the
parametric rate. These appealing features highlight that the tests can be of great use
in practice.
</p>
<p>It is worth stressing that this package implements in a unified manner a large class of
specification tests, depending on the chosen weight function <code class="reqn">w(q,u)</code>:
</p>

<ul>
<li><p>&lsquo;ind&rsquo; - the indicator weight function <code class="reqn">w(q,u)=1(q \le u)</code>. This is the default.
</p>
</li>
<li><p>&lsquo;exp&rsquo; - the exponential weight function <code class="reqn">w(q,u)=exp(qu)</code>.
</p>
</li>
<li><p>&lsquo;logistic&rsquo; - the logistic weight function <code class="reqn">w(q,u)=1/[1+exp(1-qu)]</code>.
</p>
</li>
<li><p>&lsquo;sin&rsquo; - the sine weight function <code class="reqn">w(q,u)=sin(qu)</code>.
</p>
</li>
<li><p>&lsquo;sincos&rsquo; - the sine and cosine weight function <code class="reqn">w(q,u)=sin(qu)+cos(qu)</code>.
</p>
</li></ul>

<p>Different weight functions <code class="reqn">w(q,u)</code> have different power properties, and therefore,
being able to choose different <code class="reqn">w(q,u)</code> gives us flexibility to direct power in desired
directions.
</p>


<h3>References</h3>

<p>Sant'Anna, Pedro H. C, and Song, Xiaojun (2016), <em>Specification Tests for the Propensity Score</em>,
available at <a href="http://sites.google.com/site/pedrohcsantanna/">http://sites.google.com/site/pedrohcsantanna/</a>.
</p>

<hr>
<h2 id='pstest'>pstest: Tests for the Propensity Score</h2><span id='topic+pstest'></span>

<h3>Description</h3>

<p><em>pstest</em> computes Kolmogorov-Smirnov and Cramer-von Mises type tests
for the null hypothesis that a parametric model for the propensity score is
is correctly specified. For details of the testing procedure, see
Sant'Anna and Song (2016),'Specification Tests for the Propensity Score'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pstest(d, pscore, xpscore, pscore.model = NULL, model = "logit",
  w = "ind", dist = "Mammen", nboot = 1000, cores = 1,
  chunk = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pstest_+3A_d">d</code></td>
<td>
<p>a vector containing the binary treatment indicator.</p>
</td></tr>
<tr><td><code id="pstest_+3A_pscore">pscore</code></td>
<td>
<p>a vector containing the estimated propensity scores.</p>
</td></tr>
<tr><td><code id="pstest_+3A_xpscore">xpscore</code></td>
<td>
<p>a matrix (or data frame) containing the covariates (and their
transformations) included in the propensity score
estimation. It should also include the constant term.</p>
</td></tr>
<tr><td><code id="pstest_+3A_pscore.model">pscore.model</code></td>
<td>
<p>in case you you set model=&quot;het.probit&quot;, pscore.model is the entire hetglm object.
Default for pscore.model is NULL.</p>
</td></tr>
<tr><td><code id="pstest_+3A_model">model</code></td>
<td>
<p>a description of the functional form (link function) used
to estimated propensity score. The alternatives are:
'logit' (default), 'probit', and het.probit</p>
</td></tr>
<tr><td><code id="pstest_+3A_w">w</code></td>
<td>
<p>a description of which weight function the projection is based on.
The alternatives are 'ind' (default), which set <code class="reqn">w(q,u)=1(q&lt;=u)</code>,
'exp', which set <code class="reqn">w(q,u)=exp(qu)</code>, 'logistic', which set
<code class="reqn">w(q,u)=1/[1+exp(1-qu)]</code>, 'sin', which set <code class="reqn">w(q,u)=sin(qu)</code>, and
'sincos', which set <code class="reqn">w(q,u)=sin(qu)+cos(qu)</code>.</p>
</td></tr>
<tr><td><code id="pstest_+3A_dist">dist</code></td>
<td>
<p>a description of which distribution to use during the bootstrap.
The alternatives are 'Mammen' (default), and 'Rademacher'.</p>
</td></tr>
<tr><td><code id="pstest_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replicates to perform. Default is 1,000.</p>
</td></tr>
<tr><td><code id="pstest_+3A_cores">cores</code></td>
<td>
<p>number of cores to use during the bootstrap. Default is 1.
If cores is greater than 1, the bootstrap is conducted using
parLapply, instead of lapply type call.</p>
</td></tr>
<tr><td><code id="pstest_+3A_chunk">chunk</code></td>
<td>
<p>a value that determine the size of each 'tile'. Such argument is used
to split the original data into chunks, saving memory.
Default value is 1,000. If the <em>pstest</em> function throw a
memory error, you should choose a smaller value for <em>chunk</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the Kolmogorov-Smirnov and Cramer-von Mises test
statistics for the null hypothesis of correctly specified propensity
score model (kstest and cvmtest, respectively), and their associate
bootstrapped p-values, pvks and pvcvm, respectively. All inputs are also
returned.
</p>


<h3>References</h3>

<p>Sant'Anna, Pedro H. C, and Song, Xiaojun (2019), <em>Specification Tests for the Propensity Score</em>,
Journal of Econometrics, vol. 210 (2), p. 379-404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example based on simulation data
# Simulate vector of covariates
set.seed(1234)
x1 &lt;- runif(100)
x2 &lt;- rt(100, 5)
x3 &lt;- rpois(100, 3)
# generate treatment status score based on Probit Specification
treat &lt;- (x1 + x2 + x3 &gt;= rnorm(100, 4, 5))
# estimate correctly specified propensity score based on Probit
pscore &lt;- stats::glm(treat ~ x1 + x2 + x3, family = binomial(link = "probit"),
              x = TRUE)
# Test the correct specification of estimated propensity score, using
# the weight function 'ind', and bootstrap based on 'Mammen'.
pstest(d = pscore$y, pscore = pscore$fit, xpscore = pscore$x,
       model = "probit", w = "ind", dist = "Mammen")
# Alternatively, one can use the 'sin' weight function
pstest(d = pscore$y, pscore = pscore$fit, xpscore = pscore$x,
       model = "probit", w = "sin", dist = "Mammen")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
