<!DOCTYPE html><html lang="en"><head><title>Help for package DSAIRM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DSAIRM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DSAIRM-package'><p>DSAIRM: A package to learn about Dynamical Systems Approaches to</p>
Immune Response Modeling</a></li>
<li><a href='#check_simresults'><p>A function that checks if a call to simulation function worked</p></a></li>
<li><a href='#dsairmmenu'><p>The main menu for the DSAIRM package</p></a></li>
<li><a href='#generate_documentation'><p>A helper function which processes and displays the documentation part for each app</p></a></li>
<li><a href='#generate_fctcall'><p>A helper function that produces a call to a simulator function for specific settings</p></a></li>
<li><a href='#generate_ggplot'><p>A helper function that takes simulation results and produces ggplot plots</p></a></li>
<li><a href='#generate_modelsettings'><p>A function to parse modelsettings for simulation runs</p></a></li>
<li><a href='#generate_plotly'><p>A helper function that takes simulation results and produces plotly plots</p></a></li>
<li><a href='#generate_shinyinput'><p>A helper function that takes a model and generates shiny UI elements</p></a></li>
<li><a href='#generate_text'><p>A helper function that takes result from the simulators and produces text output</p></a></li>
<li><a href='#hayden96flu'><p>Influenza virus load data</p></a></li>
<li><a href='#run_model'><p>A function that runs an app for specific settings and processes results for plot and text generation</p></a></li>
<li><a href='#schirm20strep'><p>Streptococcus pneumoniae infection data</p></a></li>
<li><a href='#simulate_acutevirusir_ode'><p>Acute Virus Infection and IR Model</p></a></li>
<li><a href='#simulate_bacteria_fit'><p>Fitting a simple bacteria infection models to Streptococcus pneumoniae infection data</p></a></li>
<li><a href='#simulate_basicbacteria_discrete'><p>Basic Bacteria model - discrete</p></a></li>
<li><a href='#simulate_basicbacteria_modelexploration'><p>Simulation to illustrate parameter scan of the basic bacteria model</p>
#'</a></li>
<li><a href='#simulate_basicbacteria_ode'><p>Basic Bacteria model - ODE</p></a></li>
<li><a href='#simulate_basicvirus_fit'><p>Fitting a simple viral infection models to influenza data</p></a></li>
<li><a href='#simulate_basicvirus_modelexploration'><p>Simulation to illustrate parameter scan of the basic virus model</p>
#'</a></li>
<li><a href='#simulate_basicvirus_ode'><p>Basic Virus Model</p></a></li>
<li><a href='#simulate_basicvirus_stochastic'><p>Basic Virus Model</p></a></li>
<li><a href='#simulate_chronicvirusir_ode'><p>Chronic Virus Infection and IR Model</p></a></li>
<li><a href='#simulate_confint_fit'><p>Fit a simple viral infection model and compute confidence intervals</p></a></li>
<li><a href='#simulate_drugresistance_stochastic'><p>Stochastic simulation of a compartmental acute virus infection model</p>
with treatment and drug resistant strain</a></li>
<li><a href='#simulate_extendedbacteria_ode'><p>Extended Bacteria model - ODE</p></a></li>
<li><a href='#simulate_fludrug_fit'><p>Fitting a simple viral infection model with 2 types of drug mechanisms to influenza data</p></a></li>
<li><a href='#simulate_modelcomparison_fit'><p>Fitting 2 simple viral infection models to influenza data</p></a></li>
<li><a href='#simulate_modelvariants_ode'><p>Simulation of a viral infection model with immune response</p>
The simulation illustrates different alternative models.</a></li>
<li><a href='#simulate_pkpdmodel_ode'><p>PkPd Virus model</p></a></li>
<li><a href='#simulate_usanalysis'><p>Simulation to illustrate uncertainty and sensitivity analysis</p></a></li>
<li><a href='#simulate_virusandir_ode'><p>Simulation of a viral infection model with an immune response</p></a></li>
<li><a href='#simulate_virusandtx_ode'><p>Simulation of a basic viral infection model with drug treatment</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dynamical Systems Approach to Immune Response Modeling</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation models (apps) of various within-host immune response scenarios.
    The purpose of the package is to help individuals learn 
    about within-host infection and immune response modeling from a dynamical systems perspective.
    All apps include explanations of the underlying models and instructions on what to do with the models. </td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-23</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andreas Handel &lt;andreas.handel@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>adaptivetau, boot, deSolve, dplyr, ggplot2, gridExtra, lhs,
nloptr, plotly, rlang, stats, utils, XML</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), shiny (&ge; 1.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, devtools, emoji, knitr, pkgdown, rmarkdown, roxygen2,
testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ahgroup.github.io/DSAIRM/">https://ahgroup.github.io/DSAIRM/</a>,
<a href="https://github.com/ahgroup/DSAIRM/">https://github.com/ahgroup/DSAIRM/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ahgroup/DSAIRM/issues">https://github.com/ahgroup/DSAIRM/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-23 18:21:53 UTC; Andreas</td>
</tr>
<tr>
<td>Author:</td>
<td>Andreas Handel <a href="https://orcid.org/0000-0002-4622-1146"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Cody Dailey [ctb],
  Yang Ge [ctb],
  Spencer Hall [ctb],
  Brian McKay [ctb],
  Sina Solaimanpour [ctb],
  Alexis Vittengl [ctb],
  Henok Woldu [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 18:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='DSAIRM-package'>DSAIRM: A package to learn about Dynamical Systems Approaches to
Immune Response Modeling</h2><span id='topic+DSAIRM'></span><span id='topic+DSAIRM-package'></span>

<h3>Description</h3>

<p>This package provides a number of Shiny apps that simulate various
within-host infection and immune response dynamics models.
By manipulating the models and working
through the instructions provided within the Shiny UI, you can learn about
some important concepts in immune response modeling. You will also
learn how models can be used to study such concepts.
</p>


<h3>Details</h3>

<p>Start the main menu of the package by calling dsairmmenu().
</p>
<p>To learn more about how to use the package, see the documentation
on the package website:
https://ahgroup.github.io/DSAIRM/
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andreas Handel <a href="mailto:andreas.handel@gmail.com">andreas.handel@gmail.com</a> (<a href="https://orcid.org/0000-0002-4622-1146">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Cody Dailey [contributor]
</p>
</li>
<li><p> Yang Ge [contributor]
</p>
</li>
<li><p> Spencer Hall [contributor]
</p>
</li>
<li><p> Brian McKay [contributor]
</p>
</li>
<li><p> Sina Solaimanpour [contributor]
</p>
</li>
<li><p> Alexis Vittengl [contributor]
</p>
</li>
<li><p> Henok Woldu [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ahgroup.github.io/DSAIRM/">https://ahgroup.github.io/DSAIRM/</a>
</p>
</li>
<li> <p><a href="https://github.com/ahgroup/DSAIRM/">https://github.com/ahgroup/DSAIRM/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ahgroup/DSAIRM/issues">https://github.com/ahgroup/DSAIRM/issues</a>
</p>
</li></ul>


<hr>
<h2 id='check_simresults'>A function that checks if a call to simulation function worked</h2><span id='topic+check_simresults'></span>

<h3>Description</h3>

<p>This function takes the return from a call to a simulate_
function and checks that no errors occured.
If something goes wrong, an error message is returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_simresults(simresult)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_simresults_+3A_simresult">simresult</code></td>
<td>
<p>a list of results from a single call to the simulation functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks simulation results generated from a single call to a simulate_ function.
</p>


<h3>Value</h3>

<p>Ane error message string or NULL
</p>

<hr>
<h2 id='dsairmmenu'>The main menu for the DSAIRM package</h2><span id='topic+dsairmmenu'></span>

<h3>Description</h3>

<p>This function opens a Shiny app with a menu that will allow the user to run the different simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsairmmenu()
</code></pre>


<h3>Details</h3>

<p>Run this function with no arguments to start the main menu (a Shiny app) for DSAIRM.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: dsairmmenu()
</code></pre>

<hr>
<h2 id='generate_documentation'>A helper function which processes and displays the documentation part for each app</h2><span id='topic+generate_documentation'></span>

<h3>Description</h3>

<p>This function take the documentation provided as html file
and extracts sections
to generate the tabs with content for each Shiny app.
This is a helper function and only useful for this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_documentation(docfilename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_documentation_+3A_docfilename">docfilename</code></td>
<td>
<p>full path and name to html file containing the documentation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by the Shiny UIs to populate the documentation and information tabs.
</p>


<h3>Value</h3>

<p>tablist A list of tabs for display in a Shiny UI.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>

<hr>
<h2 id='generate_fctcall'>A helper function that produces a call to a simulator function for specific settings</h2><span id='topic+generate_fctcall'></span>

<h3>Description</h3>

<p>This function takes a modelsettings structure and uses that information
to create an unevaluated function call that runs the simulator function with the specified settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_fctcall(modelsettings)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_fctcall_+3A_modelsettings">modelsettings</code></td>
<td>
<p>a list with model settings. Required list elements are: <br />
List elements with names and values for all inputs expected by simulation function. <br />
modelsettings$simfunction - name of simulation function in variable  <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a function call for specific settings.
</p>


<h3>Value</h3>

<p>A string containing an unevaluated function call with the specified settings, or an error message
</p>

<hr>
<h2 id='generate_ggplot'>A helper function that takes simulation results and produces ggplot plots</h2><span id='topic+generate_ggplot'></span>

<h3>Description</h3>

<p>This function generates plots to be displayed in the Shiny UI.
This is a helper function. This function processes results returned from the simulation, supplied as a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_ggplot(res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_ggplot_+3A_res">res</code></td>
<td>
<p>A list structure containing all simulation results that are to be plotted.
The length of the main list indicates the number of separate plots to make.
Each list entry is itself a list, and corresponds to one plot and
needs to contain the following information/elements: <br />
1. A data frame list element called &quot;dat&quot; or &quot;ts&quot;. If the data frame is &quot;ts&quot; it is assumed to be
a time series and by default a line plot will be produced and labeled Time/Numbers.
For plotting, the data needs to be in a format with one column called xvals, one column yvals,
one column called varnames that contains names for different variables.
Varnames needs to be a factor variable or will be converted to one.
If a column 'varnames' exist, it is assumed the data is in the right format. Otherwise it will be transformed.
An optional column called IDvar can be provided for further grouping (i.e. multiple lines for stochastic simulations).
If plottype is 'mixedplot' an additional column called 'style' indicating line or point plot
for each variable is needed. <br />
2. Meta-data for the plot, provided in the following variables: <br />
optional: plottype - One of &quot;Lineplot&quot; (default if nothing is provided),&quot;Scatterplot&quot;,&quot;Boxplot&quot;, &quot;Mixedplot&quot;. <br />
optional: xlab, ylab - Strings to label axes. <br />
optional: xscale, yscale - Scaling of axes, valid ggplot2 expression, e.g. &quot;identity&quot; or &quot;log10&quot;. <br />
optional: xmin, xmax, ymin, ymax - Manual min and max for axes. <br />
optional: makelegend - TRUE/FALSE, add legend to plot. Assume true if not provided. <br />
optional: legendtitle - Legend title, if NULL/not supplied, default is used <br />
optional: legendlocation - if &quot;left&quot; is specified, top left. Otherwise top. <br />
optional: linesize - Width of line, numeric, i.e. 1.5, 2, etc. set to 1.5 if not supplied. <br />
optional: pallette - overwrite plot colors by providing a vector of color names or hex numbers to be used for the plot. <br />
optional: title - A title for each plot. <br />
optional: for multiple plots, specify res[[1]]$ncols to define number of columns <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be called to produce plots, i.e. those displayed for each app.
The input needed by this function is produced by either calling the <code><a href="#topic+run_model">run_model</a></code> function (as done when going through the UI)
or manually transforming the output from a simulate_ function into the correct list structure as explained here.
</p>


<h3>Value</h3>

<p>A ggplot plot structure for display in a Shiny UI.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>

<hr>
<h2 id='generate_modelsettings'>A function to parse modelsettings for simulation runs</h2><span id='topic+generate_modelsettings'></span>

<h3>Description</h3>

<p>This function parses the shiny UI and gets input settings
and combines those with other settings for a full definition of the model and
settings that should be executed. This is a helper function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_modelsettings(app_input, appsettings, appNames)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_modelsettings_+3A_app_input">app_input</code></td>
<td>
<p>a list of shiny GUI input</p>
</td></tr>
<tr><td><code id="generate_modelsettings_+3A_appsettings">appsettings</code></td>
<td>
<p>current appsettings</p>
</td></tr>
<tr><td><code id="generate_modelsettings_+3A_appnames">appNames</code></td>
<td>
<p>character vector of app names, available in shiny server global environment upon app initialization</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns specific settings for simulation runs as a list.
</p>


<h3>Value</h3>

<p>modelsettings a list with model settings. List elements are: <br />
modelsettings$apptitle - The name of the app that's being run.  <br />
modelsettings$simfunction - name of simulation function(s) as string.  <br />
modelsettings$simfunction2 - name of simulation function(s) as string.  <br />
modelsettings$is_mbmodel - indicate of simulation function has mbmodel structure
modelsettings$modeltype - specify what kind of model should be run.
Currently one of: _ode_, _discrete_, _stochastic_, _usanalysis_, _modelexploration_, _fit_. <br />
For more than one model type, place _and_ between them. <br />
modelsettings$plottype - 'Boxplot' or 'Scatterplot' , required for US app <br />
Optinal list elements are: <br />
List elements with names and values for inputs expected by simulation function.
If not provided, defaults of simulator function are used.<br />
modelsettings$plotscale - indicate which axis should be on a log scale (x, y or both).
If not provided or set to &rdquo;, no log scales are used. <br />
modelsettings$nplots -  indicate number of plots that should be produced (number of top list elements in result).
If not provided, a single plot is assumed.  <br />
modelsettings$nreps - required for stochastic models to indicate numer of repeat simulations.
If not provided, a single run will be done. <br />
</p>

<hr>
<h2 id='generate_plotly'>A helper function that takes simulation results and produces plotly plots</h2><span id='topic+generate_plotly'></span>

<h3>Description</h3>

<p>This function generates plots to be displayed in the Shiny UI.
This is a helper function. This function processes results returned from the simulation, supplied as a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_plotly(res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_plotly_+3A_res">res</code></td>
<td>
<p>A list structure containing all simulation results that are to be plotted.
The length of the main list indicates the number of separate plots to make.
Each list entry is itself a list, and corresponds to one plot and
needs to contain the following information/elements: <br />
1. A data frame list element called &quot;dat&quot; or &quot;ts&quot;. If the data frame is &quot;ts&quot; it is assumed to be
a time series and by default a line plot will be produced and labeled Time/Numbers.
For plotting, the data needs to be in a format with one column called xvals, one column yvals,
one column called varnames that contains names for different variables.
Varnames needs to be a factor variable or will be converted to one.
If a column 'varnames' exist, it is assumed the data is in the right format. Otherwise it will be transformed.
An optional column called IDvar can be provided for further grouping (i.e. multiple lines for stochastic simulations).
If plottype is 'mixedplot' an additional column called 'style' indicating line or point plot
for each variable is needed. <br />
2. Meta-data for the plot, provided in the following variables: <br />
optional: plottype - One of &quot;Lineplot&quot; (default is nothing is provided),&quot;Scatterplot&quot;,&quot;Boxplot&quot;, &quot;Mixedplot&quot;. <br />
optional: xlab, ylab - Strings to label axes. <br />
optional: xscale, yscale - Scaling of axes, valid ggplot2 expression, e.g. &quot;identity&quot; or &quot;log10&quot;. <br />
optional: xmin, xmax, ymin, ymax - Manual min and max for axes. <br />
optional: makelegend - TRUE/FALSE, add legend to plot. Assume true if not provided. <br />
optional: legendtitle - Legend title, if NULL/not supplied, default is used <br />
optional: legendlocation - if &quot;left&quot; is specified, top left. Otherwise top right. <br />
optional: linesize - Width of line, numeric, i.e. 1.5, 2, etc. set to 1.5 if not supplied. <br />
optional: title - A title for each plot. <br />
optional: for multiple plots, specify res[[1]]$ncols to define number of columns <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be called to produce plots, i.e. those displayed for each app.
The input needed by this function is produced by either calling the run_model() function (as done when going through the UI)
or manually transforming the output from a simulate_ function into the correct list structure explained below.
</p>


<h3>Value</h3>

<p>A plotly plot structure for display in a Shiny UI.
</p>


<h3>Author(s)</h3>

<p>Yang Ge, Andreas Handel
</p>

<hr>
<h2 id='generate_shinyinput'>A helper function that takes a model and generates shiny UI elements</h2><span id='topic+generate_shinyinput'></span>

<h3>Description</h3>

<p>This function generates shiny UI inputs for a supplied model.
This is a helper function called by the shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_shinyinput(
  use_mbmodel = FALSE,
  mbmodel = NULL,
  use_doc = FALSE,
  model_file = NULL,
  model_function = NULL,
  otherinputs = NULL,
  packagename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_shinyinput_+3A_use_mbmodel">use_mbmodel</code></td>
<td>
<p>TRUE/FALSE if mbmodel list should be used to generate UI</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_mbmodel">mbmodel</code></td>
<td>
<p>a valid mbmodel object</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_use_doc">use_doc</code></td>
<td>
<p>TRUE/FALSE if doc of a model file should be parsed to make UI</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_model_file">model_file</code></td>
<td>
<p>name/path to function file for parsing doc</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_model_function">model_function</code></td>
<td>
<p>name of function who's formals are parsed to make UI</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_otherinputs">otherinputs</code></td>
<td>
<p>a text string that specifies a list of other shiny inputs to include in the UI</p>
</td></tr>
<tr><td><code id="generate_shinyinput_+3A_packagename">packagename</code></td>
<td>
<p>name of package using this function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by the Shiny app to produce the Shiny input UI elements.
It produces UI by 3 different ways.
1. If use_mbmodel is TRUE, an mbmodel list structure, which needs to be provided, is used
2. If use_mbmodel is FALSE and use_doc is TRUE, the documentation header of the function is used.
For that approach, model_file needs to contain the name/path to the R script for the function
The doc needs to have a specific format for this.
3. If both use_mbmodel and use_doc are FALSE, the function formals are parsed and used as UI.
For that approach, model_function needs to specify the name of the model
model_function is assumed to be the name of a function.
The formals of the function will be parsed to create UI elements.
Non-numeric arguments of functions are removed and need to be included in the otherinputs argument.
</p>


<h3>Value</h3>

<p>A renderUI object that can be added to the shiny output object for display in a Shiny UI
</p>

<hr>
<h2 id='generate_text'>A helper function that takes result from the simulators and produces text output</h2><span id='topic+generate_text'></span>

<h3>Description</h3>

<p>This function generates text to be displayed in the Shiny UI.
This is a helper function. This function processes results returned from the simulation, supplied as a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_text(res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_text_+3A_res">res</code></td>
<td>
<p>A list structure containing all simulation results that are to be processed.
This function is meant to be used together with generate_plots() and requires similar input information.
See the generate_plots() function for most details.
Specific entries for this function are 'maketext', 'showtext' and 'finaltext'.
If 'maketext' is set to TRUE (or not provided) the function processes the data corresponding to each plot
and reports min/max/final values (lineplots) or correlation coefficient (scatterplot)
If 'maketext' is FALSE, no text based on the data is generated.
If the entries 'showtext' or 'finaltext' are present, their values
will be returned for each plot or for all together.
The overall message of finaltext should be in the 1st plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by the Shiny server to produce output returned to the Shiny UI.
</p>


<h3>Value</h3>

<p>HTML formatted text for display in a Shiny UI.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>

<hr>
<h2 id='hayden96flu'>Influenza virus load data</h2><span id='topic+hayden96flu'></span>

<h3>Description</h3>

<p>Daily average virus load of volunteers infected with influenza.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hayden96flu)
</code></pre>


<h3>Format</h3>

<p>A data frame with these variables:
</p>

<dl>
<dt>HoursPI</dt><dd><p>Hours post infection - measurements were taken daily.</p>
</dd>
<dt>txtime</dt><dd><p>Hours post infection when treatment started. The value of 29 is the average of the 2 reported early treatment times. A value of 200, which is later than the last recorded virus load, means no treatment.</p>
</dd>
<dt>LogVirusLoad</dt><dd><p>Average virus load for volunteers in a given treatment condition, in log10 units.</p>
</dd>
<dt>LOD</dt><dd><p>Limit of detection for virus load, in log10 units.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data is from Hayden et al 1996 JAMA:
doi:10.1001/jama.1996.03530280047035
</p>
<p>Specifically, data was extracted from Figure 2.
See this article and citations therein for more details on the data.
</p>

<hr>
<h2 id='run_model'>A function that runs an app for specific settings and processes results for plot and text generation</h2><span id='topic+run_model'></span>

<h3>Description</h3>

<p>This function runs a model based on information
provided in the modelsettings list passed into it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_model(modelsettings)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_model_+3A_modelsettings">modelsettings</code></td>
<td>
<p>a list with model settings. Required list elements are: <br />
modelsettings$simfunction - name of simulation function(s) as string.  <br />
modelsettings$is_mbmodel - indicate of simulation function has mbmodel structure
modelsettings$modeltype - specify what kind of model should be run.
Currently one of: _ode_, _discrete_, _stochastic_, _usanalysis_, _modelexploration_, _fit_. <br />
For more than one model type, place _and_ between them. <br />
modelsettings$plottype - 'Boxplot' or 'Scatterplot' , required for US app <br />
Optinal list elements are: <br />
List elements with names and values for inputs expected by simulation function.
If not provided, defaults of simulator function are used.<br />
modelsettings$plotscale - indicate which axis should be on a log scale (x, y or both).
If not provided or set to &rdquo;, no log scales are used. <br />
modelsettings$nplots -  indicate number of plots that should be produced (number of top list elements in result).
If not provided, a single plot is assumed.  <br />
modelsettings$nreps - required for stochastic models to indicate numer of repeat simulations.
If not provided, a single run will be done. <br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function runs a model for specific settings.
</p>


<h3>Value</h3>

<p>A vectored list named &quot;result&quot; with each main list element containing the simulation results in a dataframe called dat and associated metadata required for generate_plot and generate_text functions. Most often there is only one main list entry (result[[1]]) for a single plot/text.
</p>

<hr>
<h2 id='schirm20strep'>Streptococcus pneumoniae infection data</h2><span id='topic+schirm20strep'></span>

<h3>Description</h3>

<p>Time series data from Streptococcus pneumoniae infection in mice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schirm20strep)
</code></pre>


<h3>Format</h3>

<p>A data frame with these variables:
</p>

<dl>
<dt>time</dt><dd><p>Hours post infection.</p>
</dd>
<dt>value</dt><dd><p>Amount of bacteria and neutrophils. See original paper for units.</p>
</dd>
<dt>quantity</dt><dd><p>B = Streptococcus pneumoniae bacteria, I = neutrophils.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data is from Schirm et al 2020 PLoS One:
https://doi.org/10.1371/journal.pone.0243147
</p>
<p>Specifically, data used here are time-series of bacteria and neutrophils
in BAL, as shown in panels a) and c) of Figure 4.
The original data uses P for the bacteria, and N for neutrophils.
For consistency with other DSAIRM models,
we use B for bacteria and I for neutrophils (immune response).
See the original article and citations therein for more details on the data.
</p>

<hr>
<h2 id='simulate_acutevirusir_ode'>Acute Virus Infection and IR Model</h2><span id='topic+simulate_acutevirusir_ode'></span>

<h3>Description</h3>

<p>A model for an acute virus infection with a simple immune response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_acutevirusir_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  F = 1,
  T = 1,
  dI = 1,
  dV = 2,
  b = 1e-06,
  p = 100,
  g = 1,
  rF = 0.001,
  dF = 1,
  kF = 0.01,
  rT = 0.001,
  dT = 1,
  kT = 0.01,
  tstart = 0,
  tfinal = 50,
  dt = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_acutevirusir_ode_+3A_u">U</code></td>
<td>
<p>: starting value for Uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_i">I</code></td>
<td>
<p>: starting value for Infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_v">V</code></td>
<td>
<p>: starting value for Virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_f">F</code></td>
<td>
<p>: starting value for Innate Response : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_t">T</code></td>
<td>
<p>: starting value for Adaptive Response : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_g">g</code></td>
<td>
<p>: possible conversion factor for virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_rf">rF</code></td>
<td>
<p>: rate of innate response induction : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_df">dF</code></td>
<td>
<p>: rate of innate response decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_kf">kF</code></td>
<td>
<p>: strength of innate response action : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_rt">rT</code></td>
<td>
<p>: rate of adaptive response induction : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_dt">dT</code></td>
<td>
<p>: rate of adaptive response decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_kt">kT</code></td>
<td>
<p>: strength of adaptive response action : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_acutevirusir_ode_+3A_dt">dt</code></td>
<td>
<p>: Time step : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes uninfected and infected target cells, virus, and the innate and adaptive immune response. The processes that are modeled are infection, virus production, infected cell and virus death. Immune response dynamics and action are also modeled. See the DSAIRM documentation for model details.
</p>
<p>This code was generated by the modelbuilder R package.
The model is implemented as a set of ordinary differential equations using the deSolve package.
The following R packages need to be loaded for the function to work: deSolve.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do something nonsensical (e.g. have negative values for parameters), the code will likely abort with an error message.
</p>


<h3>Model Author</h3>

<p>Andreas Handel
</p>


<h3>Model creation date</h3>

<p>2022-05-09
</p>


<h3>Code Author</h3>

<p>generated by the <code>modelbuilder</code> R package
</p>


<h3>Code creation date</h3>

<p>2022-05-09
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_acutevirusir_ode()
# To choose values other than the standard one, specify them like this:
result &lt;- simulate_acutevirusir_ode(U = 2e+05,I = 0,V = 2,F = 2,T = 2)
# You can display or further process the result, like this:
plot(result$ts[,'time'],result$ts[,'U'],xlab='Time',ylab='Numbers',type='l')
print(paste('Max number of U: ',max(result$ts[,'U'])))
</code></pre>

<hr>
<h2 id='simulate_bacteria_fit'>Fitting a simple bacteria infection models to Streptococcus pneumoniae infection data</h2><span id='topic+simulate_bacteria_fit'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The model describes a simple bacteria infection system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_bacteria_fit(
  B = 1,
  I = 1,
  g = 0.1,
  glow = 1e-04,
  ghigh = 100,
  Bmax = 1e+08,
  Bmaxlow = 10000,
  Bmaxhigh = 1e+10,
  dB = 0.01,
  dBlow = 1e-04,
  dBhigh = 100,
  kI = 0.001,
  kIlow = 1e-04,
  kIhigh = 100,
  rI = 0.1,
  rIlow = 1e-04,
  rIhigh = 100,
  Imax = 10000,
  Imaxlow = 1,
  Imaxhigh = 1e+10,
  dI = 0.1,
  dIlow = 0.001,
  dIhigh = 100,
  iter = 10,
  solvertype = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_bacteria_fit_+3A_b">B</code></td>
<td>
<p>: initial number of bacteria : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_i">I</code></td>
<td>
<p>: initial number of neutrophils (immune response) : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_g">g</code></td>
<td>
<p>: maximum rate of bacteria growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_glow">glow</code></td>
<td>
<p>: lower bound for g : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_ghigh">ghigh</code></td>
<td>
<p>: upper bound for g : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_bmax">Bmax</code></td>
<td>
<p>: bacteria carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_bmaxlow">Bmaxlow</code></td>
<td>
<p>: lower bound for Bmax : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_bmaxhigh">Bmaxhigh</code></td>
<td>
<p>: upper bound for Bmax : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_db">dB</code></td>
<td>
<p>: bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_dblow">dBlow</code></td>
<td>
<p>: lower bound for dB : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_dbhigh">dBhigh</code></td>
<td>
<p>: upper bound for dB : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_ki">kI</code></td>
<td>
<p>: rate of bacteria killing by immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_kilow">kIlow</code></td>
<td>
<p>: lower bound for k : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_kihigh">kIhigh</code></td>
<td>
<p>: upper bound for k : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_ri">rI</code></td>
<td>
<p>: immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_rilow">rIlow</code></td>
<td>
<p>: lower bound for r : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_rihigh">rIhigh</code></td>
<td>
<p>: upper bound for r : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_imax">Imax</code></td>
<td>
<p>: immune response carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_imaxlow">Imaxlow</code></td>
<td>
<p>: lower bound for Imax : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_imaxhigh">Imaxhigh</code></td>
<td>
<p>: upper bound for Imax : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_di">dI</code></td>
<td>
<p>: immune response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_dilow">dIlow</code></td>
<td>
<p>: lower bound for dI : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_dihigh">dIhigh</code></td>
<td>
<p>: upper bound for dI : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_iter">iter</code></td>
<td>
<p>: max number of steps to be taken by optimizer : numeric</p>
</td></tr>
<tr><td><code id="simulate_bacteria_fit_+3A_solvertype">solvertype</code></td>
<td>
<p>: the type of solver/optimizer to use (1-3) : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple compartmental ODE model for a bacterial infection
is fitted to data.
The fitting is done using solvers/optimizers from the nloptr package (which is a wrapper for the nlopt library).
The package provides access to a large number of solvers.
Here, we only implement 3 solvers, namely 1 = NLOPT_LN_COBYLA, 2 = NLOPT_LN_NELDERMEAD, 3 = NLOPT_LN_SBPLX
For details on what those optimizers are and how they work, see the nlopt/nloptr documentation.
</p>


<h3>Value</h3>

<p>The function returns a list containing as elements the best fit time series data frame, the best fit parameters,
the data and the final SSR
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values,
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the code with default parameters just call the function:
## Not run: result &lt;- simulate_bacteria_fit()
# To apply different settings, provide them to the simulator function, like such:
result &lt;- simulate_bacteria_fit(iter = 5)
</code></pre>

<hr>
<h2 id='simulate_basicbacteria_discrete'>Basic Bacteria model - discrete</h2><span id='topic+simulate_basicbacteria_discrete'></span>

<h3>Description</h3>

<p>A basic bacteria infection model with 2 compartments, implemented as discrete time simulation.
The model tracks bacteria and an immune response dynamics.
The processes modeled are bacteria growth, death and killing by the immune response,
and immune response activation and decay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicbacteria_discrete(
  B = 10,
  I = 1,
  g = 1,
  Bmax = 1e+06,
  dB = 0.1,
  k = 1e-07,
  r = 0.001,
  dI = 1,
  tstart = 0,
  tfinal = 30,
  dt = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicbacteria_discrete_+3A_b">B</code></td>
<td>
<p>: starting value for bacteria : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_i">I</code></td>
<td>
<p>: starting value for immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_g">g</code></td>
<td>
<p>: maximum rate of bacteria growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_bmax">Bmax</code></td>
<td>
<p>: bacteria carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_db">dB</code></td>
<td>
<p>: bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_k">k</code></td>
<td>
<p>: rate of bacteria killing by immune reesponse : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_r">r</code></td>
<td>
<p>: immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_di">dI</code></td>
<td>
<p>: immune response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_tstart">tstart</code></td>
<td>
<p>: start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_tfinal">tfinal</code></td>
<td>
<p>: final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_discrete_+3A_dt">dt</code></td>
<td>
<p>: time step : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes bacteria and an immune response. The processes are bacteria growth,
death and killing by the immune response, and immune response activation and decay.
This is a predator-prey type model.
The model is implemented as a set of discrete-time, deterministic equations,
coded as a for-loop.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do something nonsensical (e.g. have negative values for parameters), the code will likely abort with an error message.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_basicbacteria_discrete()
</code></pre>

<hr>
<h2 id='simulate_basicbacteria_modelexploration'>Simulation to illustrate parameter scan of the basic bacteria model
#'</h2><span id='topic+simulate_basicbacteria_modelexploration'></span>

<h3>Description</h3>

<p>This function simulates the simple bacteria model ODE for a range of parameters.
The function returns a data frame containing the parameter that has been varied and the outcomes (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicbacteria_modelexploration(
  B = 100,
  I = 10,
  g = 2,
  Bmax = 1e+05,
  dB = 1,
  k = 1e-04,
  r = 1e-04,
  dI = 2,
  tstart = 0,
  tfinal = 300,
  dt = 0.1,
  samples = 10,
  parmin = 2,
  parmax = 10,
  samplepar = "g",
  pardist = "lin"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_b">B</code></td>
<td>
<p>: Starting value for bacteria : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_i">I</code></td>
<td>
<p>: Starting value for immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_g">g</code></td>
<td>
<p>: Maximum rate of bacteria growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_bmax">Bmax</code></td>
<td>
<p>: Bacteria carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_db">dB</code></td>
<td>
<p>: Bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_k">k</code></td>
<td>
<p>: Bacteria kill rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_r">r</code></td>
<td>
<p>: Immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_di">dI</code></td>
<td>
<p>: Immune response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_dt">dt</code></td>
<td>
<p>: Times for which result is returned : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_samples">samples</code></td>
<td>
<p>: Number of values to run between pmin and pmax : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_parmin">parmin</code></td>
<td>
<p>: Lower value for varied parameter : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_parmax">parmax</code></td>
<td>
<p>: Upper value for varied parameter : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_samplepar">samplepar</code></td>
<td>
<p>: Name of parameter to be varied : character</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_modelexploration_+3A_pardist">pardist</code></td>
<td>
<p>: spacing of parameter values, can be either 'lin' or 'log' : character</p>
</td></tr>
</table>


<h3>Details</h3>

<p>##this code illustrates how to do analyze a simple model.
A simple 2 compartment ODE model (the simple bacteria model introduced in the app of that name)
is simulated for different parameter values.
This function runs the simple bacterial infection model for a range of parameters.
The user can specify which parameter is sampled, and
the simulation returns for each parameter sample the peak and final value for B and I.
Also returned is the varied parameter and an indicator if steady state was reached.
</p>


<h3>Value</h3>

<p>The function returns the output as a list,
list element 'dat' contains the data frame with results of interest.
The first column is called xvals and contains the values of the
parameter that has been varied as specified by 'samplepar'.
The remaining columns contain peak and steady state values of bacteria and immune response,
Bpeak, Ipeak, Bsteady and Isteady.
A final boolean variable 'steady' is returned for each simulation.
It is TRUE if the simulation reached steady state, otherwise FALSE.
</p>


<h3>Notes</h3>

<p>The parameter dt only determines for which times the solution is returned,
it is not the internal time step. The latter is set automatically by the ODE solver.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter values
or fractions &gt; 1), the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the shiny app documentation corresponding to this simulator
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
## Not run: res &lt;- simulate_basicbacteria_modelexploration()
# To choose parameter values other than the standard one, specify them, like such:
res &lt;- simulate_basicbacteria_modelexploration(samples=5, samplepar='dI', parmin=1, parmax=10)
# You should then use the simulation result returned from the function, like this:
plot(res$dat[,"xvals"],res$data[,"Bpeak"],xlab='Parameter values',ylab='Peak Bacteria',type='l')
</code></pre>

<hr>
<h2 id='simulate_basicbacteria_ode'>Basic Bacteria model - ODE</h2><span id='topic+simulate_basicbacteria_ode'></span>

<h3>Description</h3>

<p>A basic bacteria infection model with 2 compartments, implemented as set of ODEs.
The model tracks bacteria and an immune response dynamics.
The processes modeled are bacteria growth, death and killing by the immune response,
and immune response activation and decay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicbacteria_ode(
  B = 100,
  I = 1,
  g = 1,
  Bmax = 1e+05,
  dB = 0.5,
  k = 1e-04,
  r = 1e-04,
  dI = 2,
  tstart = 0,
  tfinal = 100,
  dt = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicbacteria_ode_+3A_b">B</code></td>
<td>
<p>: starting value for bacteria : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_i">I</code></td>
<td>
<p>: starting value for immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_g">g</code></td>
<td>
<p>: maximum rate of bacteria growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_bmax">Bmax</code></td>
<td>
<p>: bacteria carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_db">dB</code></td>
<td>
<p>: bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_k">k</code></td>
<td>
<p>: rate of bacteria killing by immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_r">r</code></td>
<td>
<p>: immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_di">dI</code></td>
<td>
<p>: immune response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_tstart">tstart</code></td>
<td>
<p>: start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicbacteria_ode_+3A_dt">dt</code></td>
<td>
<p>: times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes bacteria and an immune response. The processes are bacteria growth,
death and killing by the immune response, and immune response activation and decay.
This is a predator-prey type model.
The model is implemented as a set of ordinary differential equations (ODE) using the deSolve package.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Notes</h3>

<p>The parameter dt only determines the times the solution is returned and plotted,
it is not the internal time step for the differential equation solver.
The latter is set automatically by the ODE solver.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking.
So if you try to do something nonsensical (e.g. have negative values for parameters),
the code will likely abort with an error message.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_basicbacteria_ode()
# To run the simulation with different parameter or starting values,
# supply the ones you want to change.
# all other parameters will be kept at their default values shown in the function call above
result &lt;- simulate_basicbacteria_ode(B = 100, g = 0.5, dI = 2)
</code></pre>

<hr>
<h2 id='simulate_basicvirus_fit'>Fitting a simple viral infection models to influenza data</h2><span id='topic+simulate_basicvirus_fit'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The model describes a simple viral infection system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicvirus_fit(
  U = 1e+06,
  I = 0,
  V = 1,
  n = 0,
  dU = 0,
  dI = 2,
  g = 0,
  p = 0.001,
  plow = 1e-04,
  phigh = 100,
  psim = 0.001,
  b = 0.1,
  blow = 0.001,
  bhigh = 10,
  bsim = 0.1,
  dV = 1,
  dVlow = 0.01,
  dVhigh = 100,
  dVsim = 1,
  noise = 0,
  iter = 1,
  solvertype = 1,
  usesimdata = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicvirus_fit_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_n">n</code></td>
<td>
<p>: rate of uninfected cell production : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_g">g</code></td>
<td>
<p>: unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_plow">plow</code></td>
<td>
<p>: lower bound for p : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_phigh">phigh</code></td>
<td>
<p>: upper bound for p : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_psim">psim</code></td>
<td>
<p>: rate at which infected cells produce virus for simulated data : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_blow">blow</code></td>
<td>
<p>: lower bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_bhigh">bhigh</code></td>
<td>
<p>: upper bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_bsim">bsim</code></td>
<td>
<p>: rate at which virus infects cells for simulated data : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_dvlow">dVlow</code></td>
<td>
<p>: lower bound for virus clearance rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_dvhigh">dVhigh</code></td>
<td>
<p>: upper bound for virus clearance rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_dvsim">dVsim</code></td>
<td>
<p>: rate at which infectious virus is cleared for simulated data : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_noise">noise</code></td>
<td>
<p>: noise to be added to simulated data : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_iter">iter</code></td>
<td>
<p>: max number of steps to be taken by optimizer : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_solvertype">solvertype</code></td>
<td>
<p>: the type of solver/optimizer to use (1-3) : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_fit_+3A_usesimdata">usesimdata</code></td>
<td>
<p>: set to 1 if simulated data should be fitted, 0 otherwise : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple compartmental ODE model mimicking acute viral infection
is fitted to data.
Data can either be real or created by running the model with known parameters and using the simulated data to
determine if the model parameters can be identified.
The fitting is done using solvers/optimizers from the nloptr package (which is a wrapper for the nlopt library).
The package provides access to a large number of solvers.
Here, we only implement 3 solvers, namely 1 = NLOPT_LN_COBYLA, 2 = NLOPT_LN_NELDERMEAD, 3 = NLOPT_LN_SBPLX
For details on what those optimizers are and how they work, see the nlopt/nloptr documentation.
</p>


<h3>Value</h3>

<p>The function returns a list containing as elements the best fit time series data frame, the best fit parameters,
the data and the final SSR
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values,
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the code with default parameters just call the function:
## Not run: result &lt;- simulate_basicvirus_fit()
# To apply different settings, provide them to the simulator function, like such:
result &lt;- simulate_basicvirus_fit(iter = 5)
</code></pre>

<hr>
<h2 id='simulate_basicvirus_modelexploration'>Simulation to illustrate parameter scan of the basic virus model
#'</h2><span id='topic+simulate_basicvirus_modelexploration'></span>

<h3>Description</h3>

<p>This function simulates the basic virus model ODE for a range of parameters.
The function returns a data frame containing the parameter that has been varied and the outcomes (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicvirus_modelexploration(
  U = 1e+05,
  I = 0,
  V = 1,
  n = 10000,
  dU = 0.1,
  dI = 1,
  dV = 2,
  b = 2e-05,
  p = 5,
  g = 1,
  tstart = 0,
  tfinal = 100,
  dt = 0.1,
  samples = 10,
  parmin = 1,
  parmax = 10,
  samplepar = "p",
  pardist = "lin"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_u">U</code></td>
<td>
<p>: Starting value for uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_i">I</code></td>
<td>
<p>: Starting value for infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_v">V</code></td>
<td>
<p>: Starting value for virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_n">n</code></td>
<td>
<p>: Rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_du">dU</code></td>
<td>
<p>: Rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_di">dI</code></td>
<td>
<p>: Rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_dv">dV</code></td>
<td>
<p>: Rate at which virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_b">b</code></td>
<td>
<p>: Rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_p">p</code></td>
<td>
<p>: Rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_g">g</code></td>
<td>
<p>: Possible conversion factor for virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_dt">dt</code></td>
<td>
<p>: Times for which result is returned : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_samples">samples</code></td>
<td>
<p>: Number of values to run between pmin and pmax : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_parmin">parmin</code></td>
<td>
<p>: Lower value for varied parameter : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_parmax">parmax</code></td>
<td>
<p>: Upper value for varied parameter : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_samplepar">samplepar</code></td>
<td>
<p>: Name of parameter to be varied : character</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_modelexploration_+3A_pardist">pardist</code></td>
<td>
<p>: spacing of parameter values, can be either 'lin' or 'log' : character</p>
</td></tr>
</table>


<h3>Details</h3>

<p>##this code illustrates how to do analyze a simple model.
A simple 3 compartment ODE model (the basic virus model introduced in the app of that name)
is simulated for different parameter values.
This function runs the model for a range of values for any one parameter,
while holding all other paramter values fixed.
The user can specify which parameter is sampled, and
the simulation returns for each parameter sample the peak and final value for U, I and V.
Also returned is the varied parameter and an indicator if steady state was reached.
</p>


<h3>Value</h3>

<p>The function returns the output as a list,
list element 'dat' contains the data frame with results of interest.
The first column is called xvals and contains the values of the
parameter that has been varied as specified by 'samplepar'.
The remaining columns contain peak and steady state values of bacteria and immune response,
Upeak, Ipeak, Vpeak, Usteady, Isteady and Vsteady.
A final boolean variable 'steady' is returned for each simulation.
It is TRUE if the simulation reached steady state, otherwise FALSE.
</p>


<h3>Notes</h3>

<p>The parameter dt only determines for which times the solution is returned,
it is not the internal time step. The latter is set automatically by the ODE solver.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter values
or fractions &gt; 1), the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the shiny app documentation corresponding to this simulator
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
## Not run: res &lt;- simulate_basicvirus_modelexploration()
# To choose parameter values other than the standard one, specify them, like such:
res &lt;- simulate_basicvirus_modelexploration(samples=5, samplepar='dI', parmin=1, parmax=10)
# You should then use the simulation result returned from the function, like this:
plot(res$dat[,"xvals"],res$data[,"Vpeak"],xlab='Parameter values',ylab='Virus Peak',type='l')
</code></pre>

<hr>
<h2 id='simulate_basicvirus_ode'>Basic Virus Model</h2><span id='topic+simulate_basicvirus_ode'></span>

<h3>Description</h3>

<p>A basic virus infection model with 3 compartments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicvirus_ode(
  U = 1e+05,
  I = 0,
  V = 1,
  n = 0,
  dU = 0,
  dI = 1,
  dV = 2,
  b = 2e-05,
  p = 5,
  g = 1,
  tstart = 0,
  tfinal = 30,
  dt = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicvirus_ode_+3A_u">U</code></td>
<td>
<p>: starting value for Uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_i">I</code></td>
<td>
<p>: starting value for Infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_v">V</code></td>
<td>
<p>: starting value for Virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_n">n</code></td>
<td>
<p>: rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_g">g</code></td>
<td>
<p>: possible conversion factor for virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_ode_+3A_dt">dt</code></td>
<td>
<p>: Time step : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes uninfected and infected target cells, as well as free virus. The processes that are modeled are infection, virus production, uninfected cell birth and death, infected cell and virus death.
</p>
<p>This code was generated by the modelbuilder R package.
The model is implemented as a set of ordinary differential equations using the deSolve package.
The following R packages need to be loaded for the function to work: deSolve.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do something nonsensical (e.g. have negative values for parameters), the code will likely abort with an error message.
</p>


<h3>Model Author</h3>

<p>Andreas Handel
</p>


<h3>Model creation date</h3>

<p>2021-07-19
</p>


<h3>Code Author</h3>

<p>generated by the <code>modelbuilder</code> R package
</p>


<h3>Code creation date</h3>

<p>2021-07-19
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_basicvirus_ode()
# To choose values other than the standard one, specify them like this:
result &lt;- simulate_basicvirus_ode(U = 2e+05,I = 0,V = 2)
# You can display or further process the result, like this:
plot(result$ts[,'time'],result$ts[,'U'],xlab='Time',ylab='Numbers',type='l')
print(paste('Max number of U: ',max(result$ts[,'U'])))
</code></pre>

<hr>
<h2 id='simulate_basicvirus_stochastic'>Basic Virus Model</h2><span id='topic+simulate_basicvirus_stochastic'></span>

<h3>Description</h3>

<p>A basic virus infection model with 3 compartments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_basicvirus_stochastic(
  U = 1e+05,
  I = 0,
  V = 1,
  n = 0,
  dU = 0,
  dI = 1,
  dV = 2,
  b = 2e-05,
  p = 5,
  g = 1,
  tfinal = 30,
  rngseed = 123
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_basicvirus_stochastic_+3A_u">U</code></td>
<td>
<p>: starting value for Uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_i">I</code></td>
<td>
<p>: starting value for Infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_v">V</code></td>
<td>
<p>: starting value for Virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_n">n</code></td>
<td>
<p>: rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_dv">dV</code></td>
<td>
<p>: rate at which virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_g">g</code></td>
<td>
<p>: possible conversion factor for virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_basicvirus_stochastic_+3A_rngseed">rngseed</code></td>
<td>
<p>: set random number seed for reproducibility : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes uninfected and infected target cells, as well as free virus. The processes that are modeled are infection, virus production, uninfected cell birth and death, infected cell and virus death.
</p>
<p>This code was generated by the modelbuilder R package.
The model is implemented as a set of stochastic equations using the adaptivetau package.
The following R packages need to be loaded for the function to work: adpativetau
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do something nonsensical (e.g. have negative values for parameters), the code will likely abort with an error message.
</p>


<h3>Model Author</h3>

<p>Andreas Handel
</p>


<h3>Model creation date</h3>

<p>2021-07-19
</p>


<h3>Code Author</h3>

<p>generated by the <code>modelbuilder</code> R package
</p>


<h3>Code creation date</h3>

<p>2021-07-19
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_basicvirus_stochastic()
# To choose values other than the standard one, specify them like this:
result &lt;- simulate_basicvirus_stochastic(U = 2e+05,I = 0,V = 2)
# You can display or further process the result, like this:
plot(result$ts[,'time'],result$ts[,'U'],xlab='Time',ylab='Numbers',type='l')
print(paste('Max number of U: ',max(result$ts[,'U'])))
</code></pre>

<hr>
<h2 id='simulate_chronicvirusir_ode'>Chronic Virus Infection and IR Model</h2><span id='topic+simulate_chronicvirusir_ode'></span>

<h3>Description</h3>

<p>A model for a chronic virus infection with a simple immune response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_chronicvirusir_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  F = 1,
  T = 1,
  n = 10000,
  dU = 0.1,
  dI = 1,
  dV = 4,
  b = 1e-06,
  p = 100,
  g = 1,
  rF = 0.001,
  dF = 1,
  kF = 0.01,
  rT = 0.001,
  dT = 1,
  kT = 0.01,
  tstart = 0,
  tfinal = 200,
  dt = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_chronicvirusir_ode_+3A_u">U</code></td>
<td>
<p>: starting value for Uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_i">I</code></td>
<td>
<p>: starting value for Infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_v">V</code></td>
<td>
<p>: starting value for Virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_f">F</code></td>
<td>
<p>: starting value for Innate Response : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_t">T</code></td>
<td>
<p>: starting value for Adaptive Response : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_n">n</code></td>
<td>
<p>: rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_g">g</code></td>
<td>
<p>: possible conversion factor for virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_rf">rF</code></td>
<td>
<p>: rate of innate response induction : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_df">dF</code></td>
<td>
<p>: rate of innate response decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_kf">kF</code></td>
<td>
<p>: strength of innate response action : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_rt">rT</code></td>
<td>
<p>: rate of adaptive response induction : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_dt">dT</code></td>
<td>
<p>: rate of adaptive response decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_kt">kT</code></td>
<td>
<p>: strength of adaptive response action : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_chronicvirusir_ode_+3A_dt">dt</code></td>
<td>
<p>: Time step : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model includes uninfected and infected target cells, virus, and the innate and adaptive immune response. The processes that are modeled are cell birth and death, infection, virus production, infected cell and virus death. Immune response dynamics and action are also modeled. See the DSAIRM documentation for model details.
</p>
<p>This code was generated by the modelbuilder R package.
The model is implemented as a set of ordinary differential equations using the deSolve package.
The following R packages need to be loaded for the function to work: deSolve.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do something nonsensical (e.g. have negative values for parameters), the code will likely abort with an error message.
</p>


<h3>Model Author</h3>

<p>Andreas Handel
</p>


<h3>Model creation date</h3>

<p>2022-05-09
</p>


<h3>Code Author</h3>

<p>generated by the <code>modelbuilder</code> R package
</p>


<h3>Code creation date</h3>

<p>2022-05-09
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_chronicvirusir_ode()
# To choose values other than the standard one, specify them like this:
result &lt;- simulate_chronicvirusir_ode(U = 2e+05,I = 0,V = 2,F = 2,T = 2)
# You can display or further process the result, like this:
plot(result$ts[,'time'],result$ts[,'U'],xlab='Time',ylab='Numbers',type='l')
print(paste('Max number of U: ',max(result$ts[,'U'])))
</code></pre>

<hr>
<h2 id='simulate_confint_fit'>Fit a simple viral infection model and compute confidence intervals</h2><span id='topic+simulate_confint_fit'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The model describes a simple viral infection system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_confint_fit(
  U = 1e+05,
  I = 0,
  V = 10,
  n = 0,
  dU = 0,
  dI = 2,
  p = 0.01,
  g = 0,
  b = 0.01,
  blow = 1e-06,
  bhigh = 1000,
  dV = 2,
  dVlow = 0.001,
  dVhigh = 1000,
  iter = 20,
  nsample = 10,
  rngseed = 100,
  parscale = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_confint_fit_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_n">n</code></td>
<td>
<p>: rate of uninfected cell production : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_g">g</code></td>
<td>
<p>: unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_blow">blow</code></td>
<td>
<p>: lower bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_bhigh">bhigh</code></td>
<td>
<p>: upper bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_dvlow">dVlow</code></td>
<td>
<p>: lower bound for virus clearance rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_dvhigh">dVhigh</code></td>
<td>
<p>: upper bound for virus clearance rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_iter">iter</code></td>
<td>
<p>: max number of steps to be taken by optimizer : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_nsample">nsample</code></td>
<td>
<p>: number of samples for conf int determination : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_rngseed">rngseed</code></td>
<td>
<p>: seed for random number generator to allow reproducibility : numeric</p>
</td></tr>
<tr><td><code id="simulate_confint_fit_+3A_parscale">parscale</code></td>
<td>
<p>: 1 for linear, 2 for log space parameter fitting : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple compartmental ODE model mimicking acute viral infection
is fitted to data.
Confidence intervals are computed by simple bootstrapping of the data
using the boot R package. Confidence intervals are computed using the
percentage method in boot.ci. See the boot package for more information.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>The function returns a list containing the best fit time series, the best fit parameters for
the data, the final SSR, and the bootstrapped 95 percent confidence intervals.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the code with default parameters just call the function:
## Not run: result &lt;- simulate_confint_fit()
# To apply different settings, provide them to the simulator function, like such:
result &lt;- simulate_confint_fit(iter = 5, nsample = 5)
</code></pre>

<hr>
<h2 id='simulate_drugresistance_stochastic'>Stochastic simulation of a compartmental acute virus infection model
with treatment and drug resistant strain</h2><span id='topic+simulate_drugresistance_stochastic'></span>

<h3>Description</h3>

<p>Simulation of a stochastic model with the following compartments:
Uninfected target cells (U), Infected with wild-type/sensitive and untreated (Is),
infected with resistant (Ir), wild-type virus (Vs), resistant virus (Vr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_drugresistance_stochastic(
  U = 1e+05,
  Is = 0,
  Ir = 0,
  Vs = 10,
  Vr = 0,
  b = 1e-05,
  dI = 1,
  e = 0,
  m = 0.001,
  p = 100,
  c = 4,
  f = 0.1,
  rngseed = 100,
  tfinal = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_drugresistance_stochastic_+3A_u">U</code></td>
<td>
<p>: initial number of target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_is">Is</code></td>
<td>
<p>: initial number of wild-type infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_ir">Ir</code></td>
<td>
<p>: initial number of resistant infected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_vs">Vs</code></td>
<td>
<p>: initial number of wild-type virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_vr">Vr</code></td>
<td>
<p>: initial number of resistant virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_b">b</code></td>
<td>
<p>: level/rate of infection of cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_di">dI</code></td>
<td>
<p>: rate of infected cell death : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_e">e</code></td>
<td>
<p>: efficacy of drug : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_m">m</code></td>
<td>
<p>: fraction of resistant mutants created : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_p">p</code></td>
<td>
<p>: virus production rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_c">c</code></td>
<td>
<p>: virus removal rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_f">f</code></td>
<td>
<p>: fitness cost of resistant virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_rngseed">rngseed</code></td>
<td>
<p>: seed for random number generator to allow reproducibility : numeric</p>
</td></tr>
<tr><td><code id="simulate_drugresistance_stochastic_+3A_tfinal">tfinal</code></td>
<td>
<p>: maximum simulation time : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compartmental ID model with several states/compartments
is simulated as a stochastic model using the adaptive tau algorithm as implemented by ssa.adaptivetau
in the adpativetau package. See the manual of this package for more details.
The function returns the time series of the simulated disease as output matrix,
with one column per compartment/variable. The first column is time.
</p>


<h3>Value</h3>

<p>A list. The list has only one element called ts.
ts contains the time-series of the simulation.
The 1st column of ts is Time, the other columns are the model variables.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if you try to do
something nonsensical (e.g. have I0 &gt; PopSize or any negative values or fractions &gt; 1),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>References</h3>

<p>See the manual for the adaptivetau package for details on the algorithm.
The implemented model is loosely based on: Handel et al 2007 PLoS Comp Bio
&quot;Neuraminidase Inhibitor Resistance in Influenza: Assessing the Danger of Its
Generation and Spread&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
result &lt;- simulate_drugresistance_stochastic()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_drugresistance_stochastic(tfinal = 100, e = 0.5)
# You should then use the simulation result returned from the function, like this:
plot(result$ts[,"time"],result$ts[,"Vs"],xlab='Time',ylab='Uninfected cells',type='l')
</code></pre>

<hr>
<h2 id='simulate_extendedbacteria_ode'>Extended Bacteria model - ODE</h2><span id='topic+simulate_extendedbacteria_ode'></span>

<h3>Description</h3>

<p>A bacteria infection model with 3 compartments, implemented as set of ODEs.
The model tracks bacteria, and one compartment each for innate and adaptive immune response.
The processes modeled are bacteria growth, death and killing by the immune response,
and growth and decay of each immune response component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_extendedbacteria_ode(
  B = 100,
  I = 1,
  A = 1,
  g = 1,
  Bmax = 1e+05,
  dB = 0.5,
  kI = 1e-04,
  kA = 1e-04,
  rI = 1,
  Imax = 1e+05,
  dI = 1,
  rA = 1,
  h = 1000,
  dA = 0.1,
  tstart = 0,
  tfinal = 100,
  dt = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_extendedbacteria_ode_+3A_b">B</code></td>
<td>
<p>: starting value for bacteria : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_i">I</code></td>
<td>
<p>: starting value for innate immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_a">A</code></td>
<td>
<p>: starting value for adaptive immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_g">g</code></td>
<td>
<p>: maximum rate of bacteria growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_bmax">Bmax</code></td>
<td>
<p>: bacteria carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_db">dB</code></td>
<td>
<p>: bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_ki">kI</code></td>
<td>
<p>: rate of bacteria killing by innate response : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_ka">kA</code></td>
<td>
<p>: rate of bacteria killing by adaptive response : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_ri">rI</code></td>
<td>
<p>: innate response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_imax">Imax</code></td>
<td>
<p>: innate response carrying capacity : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_di">dI</code></td>
<td>
<p>: innate response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_ra">rA</code></td>
<td>
<p>: adaptive response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_h">h</code></td>
<td>
<p>: adaptive response half-growth : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_da">dA</code></td>
<td>
<p>: adaptive response decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_tstart">tstart</code></td>
<td>
<p>: start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_extendedbacteria_ode_+3A_dt">dt</code></td>
<td>
<p>: times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model tracks bacteria, and one compartment each for innate and adaptive immune response.
The processes modeled are bacteria growth, death and killing by the immune response,
and growth and decay of each immune response component.
The model is implemented as a set of ordinary differential equations (ODE) using the deSolve package.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The time-series from the simulation is returned as a dataframe saved as list element <code>ts</code>.
The <code>ts</code> dataframe has one column per compartment/variable. The first column is time.
</p>


<h3>Notes</h3>

<p>The parameter dt only determines the times the solution is returned and plotted,
it is not the internal time step for the differential equation solver.
The latter is set automatically by the ODE solver.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking.
So if you try to do something nonsensical (e.g. have negative values for parameters),
the code will likely abort with an error message.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters:
result &lt;- simulate_extendedbacteria_ode()
# To run the simulation with different parameter or starting values,
# supply the ones you want to change.
# all other parameters will be kept at their default values shown in the function call above
result &lt;- simulate_extendedbacteria_ode(B = 100, g = 0.5, dI = 2)
</code></pre>

<hr>
<h2 id='simulate_fludrug_fit'>Fitting a simple viral infection model with 2 types of drug mechanisms to influenza data</h2><span id='topic+simulate_fludrug_fit'></span>

<h3>Description</h3>

<p>This function fits the simulate_virusandtx_ode model,
which is a compartment model
using a set of ordinary differential equations.
The model describes a simple viral infection system in the presence of drug treatment.
The user provides initial conditions and parameter values for the system.
The function simulates the ODE using an ODE solver from the deSolve package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_fludrug_fit(
  U = 1e+07,
  I = 0,
  V = 1,
  dI = 1,
  dV = 2,
  b = 0.002,
  blow = 0,
  bhigh = 100,
  p = 0.002,
  plow = 0,
  phigh = 100,
  g = 0,
  glow = 0,
  ghigh = 100,
  k = 0,
  fitmodel = 1,
  iter = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_fludrug_fit_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_blow">blow</code></td>
<td>
<p>: lower bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_bhigh">bhigh</code></td>
<td>
<p>: upper bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_plow">plow</code></td>
<td>
<p>: lower bound for virus production rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_phigh">phigh</code></td>
<td>
<p>: upper bound for virus production rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_g">g</code></td>
<td>
<p>: unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_glow">glow</code></td>
<td>
<p>: lower bound for unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_ghigh">ghigh</code></td>
<td>
<p>: upper bound for unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_k">k</code></td>
<td>
<p>: drug efficacy (between 0-1) : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_fitmodel">fitmodel</code></td>
<td>
<p>: fitting model 1 or 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_fludrug_fit_+3A_iter">iter</code></td>
<td>
<p>: max number of steps to be taken by optimizer : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple compartmental ODE models describing an acute viral infection with drug treatment
mechanism/model 1 assumes that drug treatment reduces rate of new cell infection.
mechanism/model 2 assumes  that drug treatment reduces rate of new virus production.
</p>


<h3>Value</h3>

<p>The function returns a list containing the best fit timeseries,
the best fit parameters, the data and the AICc for the model.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the code with default parameters just call the function:
result &lt;- simulate_fludrug_fit()
# To apply different settings, provide them to the simulator function, like such:
result &lt;- simulate_fludrug_fit(k = 0.5, iter = 5, fitmodel = 2)
</code></pre>

<hr>
<h2 id='simulate_modelcomparison_fit'>Fitting 2 simple viral infection models to influenza data</h2><span id='topic+simulate_modelcomparison_fit'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The model describes a simple viral infection system in the presence of drug treatment.
The user provides initial conditions and parameter values for the system.
The function simulates the ODE using an ODE solver from the deSolve package.
The function returns a matrix containing time-series of each variable and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_modelcomparison_fit(
  U = 1e+06,
  I = 0,
  V = 1,
  X = 1,
  dI = 2,
  dV = 4,
  p = 0.1,
  g = 0,
  k = 0.001,
  a = 0.001,
  alow = 1e-05,
  ahigh = 10,
  b = 0.001,
  blow = 1e-06,
  bhigh = 10,
  r = 0.1,
  rlow = 0.001,
  rhigh = 10,
  dX = 1,
  dXlow = 0.1,
  dXhigh = 10,
  fitmodel = 1,
  iter = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_modelcomparison_fit_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_x">X</code></td>
<td>
<p>: initial level of immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_g">g</code></td>
<td>
<p>: unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_k">k</code></td>
<td>
<p>: rate of killing of infected cells by T-cells (model 1) or virus by Ab (model 2) : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_a">a</code></td>
<td>
<p>: activation of T-cells (model 1) or growth of antibodies (model 2) : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_alow">alow</code></td>
<td>
<p>: lower bound for activation rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_ahigh">ahigh</code></td>
<td>
<p>: upper bound for activation rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_blow">blow</code></td>
<td>
<p>: lower bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_bhigh">bhigh</code></td>
<td>
<p>: upper bound for infection rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_r">r</code></td>
<td>
<p>: rate of T-cell expansion (model 1) : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_rlow">rlow</code></td>
<td>
<p>: lower bound for expansion rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_rhigh">rhigh</code></td>
<td>
<p>: upper bound for expansion rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_dx">dX</code></td>
<td>
<p>: rate at which antibodies decay (model 2) : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_dxlow">dXlow</code></td>
<td>
<p>: lower bound for decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_dxhigh">dXhigh</code></td>
<td>
<p>: upper bound for decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_fitmodel">fitmodel</code></td>
<td>
<p>: fitting model 1 or 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelcomparison_fit_+3A_iter">iter</code></td>
<td>
<p>: max number of steps to be taken by optimizer : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two simple compartmental ODE models mimicking acute viral infection
with T-cells (model 1) or antibodies (model 2) are fitted to data.
</p>


<h3>Value</h3>

<p>The function returns a list containing the best fit timeseries,
the best fit parameters, the data and the AICc for the model.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the code with default parameters just call the function:
## Not run: result &lt;- simulate_modelcomparison_fit()
# To apply different settings, provide them to the simulator function, like such:
result &lt;- simulate_modelcomparison_fit(iter = 5, fitmodel = 1)
</code></pre>

<hr>
<h2 id='simulate_modelvariants_ode'>Simulation of a viral infection model with immune response
The simulation illustrates different alternative models.</h2><span id='topic+simulate_modelvariants_ode'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The user provides initial conditions and parameter values for the system.
The function simulates the ODE using an ODE solver from the deSolve package.
The function returns a matrix containing time-series of each variable and time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_modelvariants_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  F = 0,
  A = 0,
  n = 0,
  dU = 0,
  dI = 1,
  dV = 4,
  b = 1e-05,
  p = 100,
  pF = 1,
  dF = 1,
  f1 = 1e-04,
  f2 = 0,
  f3 = 0,
  Fmax = 1000,
  sV = 1e-10,
  k1 = 0.001,
  k2 = 0,
  k3 = 0,
  a1 = 1000,
  a2 = 0,
  a3 = 0,
  hV = 1e-10,
  k4 = 0.001,
  k5 = 0,
  k6 = 0,
  sA = 1e-10,
  dA = 0.1,
  tstart = 0,
  tfinal = 20,
  dt = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_modelvariants_ode_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_f">F</code></td>
<td>
<p>: initial level of innate response : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_a">A</code></td>
<td>
<p>: initial level of adaptive response : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_n">n</code></td>
<td>
<p>: rate of uninfected cell production : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_du">dU</code></td>
<td>
<p>: rate of natural death of uninfected cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_pf">pF</code></td>
<td>
<p>: rate of innate response production in absence of infection : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_df">dF</code></td>
<td>
<p>: rate of innate response removal in absence of infection : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_f1">f1</code></td>
<td>
<p>: growth of innate response alternative 1 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_f2">f2</code></td>
<td>
<p>: growth of innate response alternative 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_f3">f3</code></td>
<td>
<p>: growth of innate response alternative 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_fmax">Fmax</code></td>
<td>
<p>: maximum level of innate response in alternative 1 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_sv">sV</code></td>
<td>
<p>: saturation of innate response growth in alternative 2 and 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k1">k1</code></td>
<td>
<p>: action of innate response alternative 1 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k2">k2</code></td>
<td>
<p>: action of innate response alternative 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k3">k3</code></td>
<td>
<p>: action of innate response alternative 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_a1">a1</code></td>
<td>
<p>: growth of adaptive response alternative 1 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_a2">a2</code></td>
<td>
<p>: growth of adaptive response alternative 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_a3">a3</code></td>
<td>
<p>: growth of adaptive response alternative 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_hv">hV</code></td>
<td>
<p>: saturation of adaptive response growth in alternative 2 and 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k4">k4</code></td>
<td>
<p>: action of adaptive response alternative 1 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k5">k5</code></td>
<td>
<p>: action of adaptive response alternative 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_k6">k6</code></td>
<td>
<p>: action of adaptive response alternative 3 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_sa">sA</code></td>
<td>
<p>: saturation of adaptive response killing for alternative action 2 : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_da">dA</code></td>
<td>
<p>: adaptive immune response decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_modelvariants_ode_+3A_dt">dt</code></td>
<td>
<p>: Times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compartmental infection model is simulated as a set of ordinary differential
equations, using an ode solver from the deSolve package.
</p>


<h3>Value</h3>

<p>The function returns the output from the odesolver as a matrix,
with one column per compartment/variable. The first column is time.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this simulator
function for more details on this model. See the manual for the deSolve
package for details on the underlying ODE simulator algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
result &lt;- simulate_modelvariants_ode()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_modelvariants_ode(V = 100, k1 = 0 , k2 = 0, k3 = 1e-4)
# You should then use the simulation result returned from the function, like this:
plot(result$ts[,"time"],result$ts[,"V"],xlab='Time',ylab='Virus',type='l',log='y')
</code></pre>

<hr>
<h2 id='simulate_pkpdmodel_ode'>PkPd Virus model</h2><span id='topic+simulate_pkpdmodel_ode'></span>

<h3>Description</h3>

<p>This function runs a simulation of the basic 3 compartment
virus infection model including the pharmacokinetics and pharmacodynamics
of a drug. The user provides initial conditions and parameter values for the system.
The function simulates the ODE using an ODE solver from the deSolve package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_pkpdmodel_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  n = 0,
  dU = 0,
  dI = 1,
  dV = 2,
  b = 1e-05,
  g = 1,
  p = 10,
  C0 = 1,
  dC = 1,
  C50 = 1,
  k = 1,
  Emax = 0,
  txstart = 10,
  txinterval = 1,
  tstart = 0,
  tfinal = 20,
  dt = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_pkpdmodel_ode_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_n">n</code></td>
<td>
<p>: rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_g">g</code></td>
<td>
<p>: unit conversion factor : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_c0">C0</code></td>
<td>
<p>: drug dose given at specified times : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_dc">dC</code></td>
<td>
<p>: drug concentration decay rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_c50">C50</code></td>
<td>
<p>: drug concentration at which effect is half maximum : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_k">k</code></td>
<td>
<p>: steepness of concentration-dependent drug effect : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_emax">Emax</code></td>
<td>
<p>: maximum drug efficacy (0-1) : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_txstart">txstart</code></td>
<td>
<p>: time of drug treatment start : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_txinterval">txinterval</code></td>
<td>
<p>: time between drug doses : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_pkpdmodel_ode_+3A_dt">dt</code></td>
<td>
<p>: Times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A basic virus infection model with drug PkPd
</p>
<p>A simple compartmental model is simulated as a set of ordinary differential
equations, using an ode solver from the deSolve package.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>A list. The list has only one element called ts.
ts contains the time-series of the simulation.
The 1st column of ts is Time, the other columns are the model variables.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this simulator
function for more details on this model. See the manual for the deSolve
package for details on the underlying ODE simulator algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
result &lt;- simulate_pkpdmodel_ode()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_pkpdmodel_ode(V = 100, txstart = 10, n = 1e5, dU = 1e-2)
# You should then use the simulation result returned from the function, like this:
plot(result$ts[,"time"],result$ts[,"V"],xlab='Time',ylab='Virus',type='l',log='y')
</code></pre>

<hr>
<h2 id='simulate_usanalysis'>Simulation to illustrate uncertainty and sensitivity analysis</h2><span id='topic+simulate_usanalysis'></span>

<h3>Description</h3>

<p>This function performs uncertainty and sensitivity analysis
using the simple, continuous-time basic bacteria model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_usanalysis(
  Bmin = 100,
  Bmax = 200,
  Imin = 1,
  Imax = 2,
  Bmaxmin = 1e+05,
  Bmaxmax = 2e+05,
  dBmin = 0.5,
  dBmax = 1,
  kmin = 1e-04,
  kmax = 2e-04,
  rmin = 1e-04,
  rmax = 2e-04,
  dImin = 1,
  dImax = 2,
  gmean = 2,
  gvar = 0.5,
  samples = 10,
  rngseed = 100,
  tstart = 0,
  tfinal = 300,
  dt = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_usanalysis_+3A_bmin">Bmin</code></td>
<td>
<p>: lower bound for initial bacteria numbers : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_bmax">Bmax</code></td>
<td>
<p>: upper bound for initial bacteria numbers : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_imin">Imin</code></td>
<td>
<p>: lower bound for initial immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_imax">Imax</code></td>
<td>
<p>: upper bound for initial immune response : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_bmaxmin">Bmaxmin</code></td>
<td>
<p>: lower bound for maximum bacteria load : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_bmaxmax">Bmaxmax</code></td>
<td>
<p>: upper bound for maximum bacteria load : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_dbmin">dBmin</code></td>
<td>
<p>: lower bound for bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_dbmax">dBmax</code></td>
<td>
<p>: upper bound for bacteria death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_kmin">kmin</code></td>
<td>
<p>: lower bound for immune response kill rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_kmax">kmax</code></td>
<td>
<p>: upper bound for immune response kill rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_rmin">rmin</code></td>
<td>
<p>: lower bound for immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_rmax">rmax</code></td>
<td>
<p>: upper bound for immune response growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_dimin">dImin</code></td>
<td>
<p>: lower bound for immune response death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_dimax">dImax</code></td>
<td>
<p>: upper bound for immune response death rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_gmean">gmean</code></td>
<td>
<p>: mean for bacteria growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_gvar">gvar</code></td>
<td>
<p>: variance for bacteria growth rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_samples">samples</code></td>
<td>
<p>: number of LHS samples to run : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_rngseed">rngseed</code></td>
<td>
<p>: seed for random number generator : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_usanalysis_+3A_dt">dt</code></td>
<td>
<p>: times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple 2 compartment ODE model (the simple bacteria model introduced in the app of that name)
is simulated for different parameter values.
The user provides ranges for the initial conditions and parameter values and the number of samples.
The function does Latin Hypercube Sampling (LHS) of the parameters
and runs the basic bacteria ODE model for each sample.
Distribution for all parameters is assumed to be uniform between the min and max values.
The only exception is the bacteria growth parameter,
which is assumed to be gamma distributed with the specified mean and variance.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>The function returns the output as a list.
The list element 'dat' contains a data frame.
The simulation returns for each parameter sample the peak and final value for B and I.
Also returned are all parameter values as individual columns
and an indicator stating if steady state was reached.
A final variable 'steady' is returned for each simulation.
It is TRUE if the simulation did reach steady state, otherwise FALSE.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter values
or fractions &gt; 1), the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this simulator
function for more details on this model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
## Not run: result &lt;- simulate_usanalysis()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_usanalysis(dImin = 0.1, dImax = 10, samples = 5, tfinal = 50)
# You should then use the simulation result returned from the function, like this:
plot(result$dat[,"dI"],result$dat[,"Bpeak"],xlab='values for d',ylab='Peak Bacteria',type='l')
</code></pre>

<hr>
<h2 id='simulate_virusandir_ode'>Simulation of a viral infection model with an immune response</h2><span id='topic+simulate_virusandir_ode'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
which tracks uninfected and infected cells, virus, innate immune response, T-cells, B-cells and antibodies.
The model is implemented as set of ordinary differential equations using the deSolve package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_virusandir_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  T = 0,
  B = 0,
  A = 0,
  n = 0,
  dU = 0,
  dI = 1,
  dV = 4,
  b = 1e-05,
  p = 1000,
  sF = 0.01,
  kA = 1e-05,
  kT = 1e-05,
  pF = 1,
  dF = 1,
  gF = 1,
  Fmax = 1000,
  hV = 1e-06,
  hF = 1e-05,
  gB = 1,
  gT = 1e-04,
  rT = 0.5,
  rA = 10,
  dA = 0.2,
  tstart = 0,
  tfinal = 30,
  dt = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_virusandir_ode_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_t">T</code></td>
<td>
<p>: initial number of T cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_b">B</code></td>
<td>
<p>: initial number of B cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_a">A</code></td>
<td>
<p>: initial number of antibodies : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_n">n</code></td>
<td>
<p>: rate of new uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_sf">sF</code></td>
<td>
<p>: strength of innate response at reducing virus production : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_ka">kA</code></td>
<td>
<p>: rate of virus removal by antibodies : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_kt">kT</code></td>
<td>
<p>: rate of infected cell killing by T cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_pf">pF</code></td>
<td>
<p>: rate of innate response production in absence of infection : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_df">dF</code></td>
<td>
<p>: rate of innate response removal in absence of infection : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_gf">gF</code></td>
<td>
<p>: rate of innate response growth during infection : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_fmax">Fmax</code></td>
<td>
<p>: maximum level of innate response : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_hv">hV</code></td>
<td>
<p>: innate growth saturation constant : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_hf">hF</code></td>
<td>
<p>: B-cell growth saturation constant : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_gb">gB</code></td>
<td>
<p>: maximum growth rate of B cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_gt">gT</code></td>
<td>
<p>: T-cell induction rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_rt">rT</code></td>
<td>
<p>: T-cell expansion rate : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_ra">rA</code></td>
<td>
<p>: rate of antibody production by B cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_da">dA</code></td>
<td>
<p>: rate of antibody decay : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_tstart">tstart</code></td>
<td>
<p>: start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandir_ode_+3A_dt">dt</code></td>
<td>
<p>: times for which result is returned : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compartmental infection model is simulated as a set of ordinary differential
equations, using an ode solver from the deSolve package.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>A list. The list has only one element, called ts.
ts contains the time-series of the simulation.
The 1st column of ts is time, the other columns are the model variables.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Author(s)</h3>

<p>Andreas Handel
</p>


<h3>See Also</h3>

<p>See the Shiny app documentation corresponding to this simulator
function for more details on this model. See the manual for the deSolve
package for details on the underlying ODE simulator algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
result &lt;- simulate_virusandir_ode()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_virusandir_ode(V = 100, tfinal = 50, n = 1e5, dU = 1e-2, kT=1e-7)
# You should then use the simulation result returned from the function, like this:
plot(result$ts[,"time"],result$ts[,"V"],xlab='Time',ylab='Virus',type='l',log='y')
</code></pre>

<hr>
<h2 id='simulate_virusandtx_ode'>Simulation of a basic viral infection model with drug treatment</h2><span id='topic+simulate_virusandtx_ode'></span>

<h3>Description</h3>

<p>This function runs a simulation of a compartment model
using a set of ordinary differential equations.
The model describes a simple viral infection system in the presence of drug treatment.
The user provides initial conditions and parameter values for the system.
The function simulates the ODE using an ODE solver from the deSolve package.
The function returns a list containing time-series of each variable and time.
inspired by a study on HCV and IFN treatment (Neumann et al. 1998, Science)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_virusandtx_ode(
  U = 1e+05,
  I = 0,
  V = 10,
  n = 10000,
  dU = 0.001,
  dI = 1,
  dV = 2,
  b = 1e-05,
  p = 10,
  g = 1,
  f = 0,
  e = 0,
  tstart = 0,
  tfinal = 30,
  dt = 0.1,
  steadystate = FALSE,
  txstart = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_virusandtx_ode_+3A_u">U</code></td>
<td>
<p>: initial number of uninfected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_i">I</code></td>
<td>
<p>: initial number of infected target cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_v">V</code></td>
<td>
<p>: initial number of infectious virions : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_n">n</code></td>
<td>
<p>: rate of uninfected cell replenishment : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_du">dU</code></td>
<td>
<p>: rate at which uninfected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_di">dI</code></td>
<td>
<p>: rate at which infected cells die : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_dv">dV</code></td>
<td>
<p>: rate at which infectious virus is cleared : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_b">b</code></td>
<td>
<p>: rate at which virus infects cells : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_p">p</code></td>
<td>
<p>: rate at which infected cells produce virus : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_g">g</code></td>
<td>
<p>: conversion between experimental and model virus units : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_f">f</code></td>
<td>
<p>: strength of cell infection reduction by drug : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_e">e</code></td>
<td>
<p>: strength of virus production reduction by drug : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_tstart">tstart</code></td>
<td>
<p>: Start time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_tfinal">tfinal</code></td>
<td>
<p>: Final time of simulation : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_dt">dt</code></td>
<td>
<p>: times for which result is returned : numeric</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_steadystate">steadystate</code></td>
<td>
<p>: start simulation at steady state : logical</p>
</td></tr>
<tr><td><code id="simulate_virusandtx_ode_+3A_txstart">txstart</code></td>
<td>
<p>: time at which treatment starts : numeric</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A simple compartmental model is simulated as a set of ordinary differential
equations, using an ode solver from the deSolve package.
if the steadystate input is set to TRUE,
the starting values for U, I and V are set to their steady state values.
Those steady state values are computed from the parameter values.
See the Basic Virus Model To-do section for an explanation.
In this case, user supplied values for U0, I0, V0 are ignored.
This code is part of the DSAIRM R package.
For additional model details, see the corresponding app in the DSAIRM package.
</p>


<h3>Value</h3>

<p>A list. The list has only one element called ts.
ts contains the time-series of the simulation.
The 1st column of ts is Time, the other columns are the model variables.
</p>


<h3>Warning</h3>

<p>This function does not perform any error checking. So if
you try to do something nonsensical (e.g. specify negative parameter or starting values),
the code will likely abort with an error message.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the simulation with default parameters just call the function:
result &lt;- simulate_virusandtx_ode()
# To choose parameter values other than the standard one, specify them, like such:
result &lt;- simulate_virusandtx_ode(V = 100, tfinal = 100, n = 1e5, dU = 1e-2)
# You should then use the simulation result returned from the function, like this:
plot(result$ts[,"time"],result$ts[,"V"],xlab='Time',ylab='Virus',type='l',log='y')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
