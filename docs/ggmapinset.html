<!DOCTYPE html><html lang="en-GB"><head><title>Help for package ggmapinset</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggmapinset}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ggmapinset-package'><p>Add Inset Panels to Maps</p></a></li>
<li><a href='#build_sf_inset_layers'><p>Build layers to implement an inset-compatible geometry</p></a></li>
<li><a href='#configure_inset'><p>Configure transformations underpinning a map inset</p></a></li>
<li><a href='#coord_sf_inset'><p>Specify an inset configuration for the whole plot</p></a></li>
<li><a href='#geom_inset_frame'><p>Add a frame and burst lines for an inset</p></a></li>
<li><a href='#geom_sf_inset'><p>Visualise sf objects with insets</p></a></li>
<li><a href='#geom_sf_text_inset'><p>Extract coordinates from 'sf' objects (inset-aware)</p></a></li>
<li><a href='#get_inset_config'><p>Get the inset configuration from the params or coord</p></a></li>
<li><a href='#mozzies_nsw2301'><p>Mosquito counts from NSW Arbovirus Surveillance program</p></a></li>
<li><a href='#shape_circle'><p>Circular insets</p></a></li>
<li><a href='#shape_rectangle'><p>Rectangular insets</p></a></li>
<li><a href='#shape_sf'><p>Arbitrary geometry as insets</p></a></li>
<li><a href='#transform_to_inset'><p>Transform coordinates according to inset configuration</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Add Inset Panels to Maps</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Helper to add insets based on geom_sf() from 'ggplot2'.
    This package gives you a drop-in replacement for geom_sf() that supports
    adding a zoomed inset map without having to create and embed a separate plot.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), sf (&ge; 1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli (&ge; 3.4.0), ggplot2 (&ge; 3.4.0), lifecycle, rlang (&ge;
1.0.0), vctrs (&ge; 0.6.5)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr, forcats, ggrepel, knitr, nswgeo, purrr, rmarkdown,
stringr, tibble, tidyr,</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cidm-ph/ggmapinset">https://github.com/cidm-ph/ggmapinset</a>,
<a href="https://cidm-ph.github.io/ggmapinset/">https://cidm-ph.github.io/ggmapinset/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cidm-ph/ggmapinset/issues">https://github.com/cidm-ph/ggmapinset/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-18 06:11:28 UTC; csus5157</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl Suster <a href="https://orcid.org/0000-0001-7021-9380"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Western Sydney Local Health District, NSW Health [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carl Suster &lt;Carl.Suster@health.nsw.gov.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-18 06:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ggmapinset-package'>Add Inset Panels to Maps</h2><span id='topic+ggmapinset'></span><span id='topic+ggmapinset-package'></span>

<h3>Description</h3>

<p>This package helps with making zoomed map insets. See <code><a href="#topic+geom_sf_inset">geom_sf_inset()</a></code>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Carl Suster <a href="mailto:Carl.Suster@health.nsw.gov.au">Carl.Suster@health.nsw.gov.au</a> (<a href="https://orcid.org/0000-0001-7021-9380">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Western Sydney Local Health District, NSW Health [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/cidm-ph/ggmapinset">https://github.com/cidm-ph/ggmapinset</a>
</p>
</li>
<li> <p><a href="https://cidm-ph.github.io/ggmapinset/">https://cidm-ph.github.io/ggmapinset/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/cidm-ph/ggmapinset/issues">https://github.com/cidm-ph/ggmapinset/issues</a>
</p>
</li></ul>


<hr>
<h2 id='build_sf_inset_layers'>Build layers to implement an inset-compatible geometry</h2><span id='topic+build_sf_inset_layers'></span>

<h3>Description</h3>

<p>For plotting, use <code><a href="#topic+geom_sf_inset">geom_sf_inset()</a></code> instead. This helper is intended to be used when
implementing custom geometries based on <code><a href="#topic+geom_sf_inset">geom_sf_inset()</a></code> so that they can provide
parameters to control the inset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_sf_inset_layers(
  data,
  mapping,
  stat,
  position,
  show.legend,
  inherit.aes,
  params,
  inset,
  map_base = "normal",
  map_inset = "auto"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_sf_inset_layers_+3A_data">data</code>, <code id="build_sf_inset_layers_+3A_mapping">mapping</code>, <code id="build_sf_inset_layers_+3A_stat">stat</code>, <code id="build_sf_inset_layers_+3A_position">position</code>, <code id="build_sf_inset_layers_+3A_show.legend">show.legend</code>, <code id="build_sf_inset_layers_+3A_inherit.aes">inherit.aes</code>, <code id="build_sf_inset_layers_+3A_params">params</code></td>
<td>
<p>See <code><a href="ggplot2.html#topic+layer">ggplot2::layer()</a></code>.</p>
</td></tr>
<tr><td><code id="build_sf_inset_layers_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.
If <code>NA</code> (the default), this is inherited from the coord (see <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code>).</p>
</td></tr>
<tr><td><code id="build_sf_inset_layers_+3A_map_base">map_base</code></td>
<td>
<p>Controls the layer with the base map. Possible values are
<code>"normal"</code> to create a layer as though the inset were not specified,
<code>"clip"</code> to create a layer with the inset viewport cut out, and
<code>"none"</code> to prevent the insertion of a layer for the base map.</p>
</td></tr>
<tr><td><code id="build_sf_inset_layers_+3A_map_inset">map_inset</code></td>
<td>
<p>Controls the layer with the inset map. Possible values are
<code>"auto"</code> to choose the behaviour based on whether <code>inset</code> is specified,
<code>"normal"</code> to create a layer with the viewport cut out and transformed, and
<code>"none"</code> to prevent the insertion of a layer for the viewport map.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> layer, or a pair of layers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>my_custom_geom &lt;- function(
  mapping = ggplot2::aes(),
  data = NULL,
  stat = "my_custom_stat",
  position = "identity",
  ...,
  inset = NA,
  map_base = "normal",
  map_inset = "auto",
  na.rm = TRUE,
  inherit.aes = TRUE
) {
  params &lt;- rlang::list2(na.rm = na.rm, ...)
  build_sf_inset_layers(
    data = data, mapping = mapping,
    stat = stat, position = position,
    show.legend = show.legend,
    inherit.aes = inherit.aes,
    params = params,
    inset = inset,
    map_base = map_base,
    map_inset = map_inset
  )
}
</code></pre>

<hr>
<h2 id='configure_inset'>Configure transformations underpinning a map inset</h2><span id='topic+configure_inset'></span>

<h3>Description</h3>

<p>The configuration returned by this function will often be passed to the
coordinate system via <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code> so that it is propagated to all
relevant layers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>configure_inset(
  shape,
  scale = NULL,
  translation = NULL,
  units = "km",
  crs_working = NULL,
  centre = deprecated(),
  radius = deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="configure_inset_+3A_shape">shape</code></td>
<td>
<p>Inset shape: see <code><a href="#topic+shape_circle">shape_circle()</a></code>, <code><a href="#topic+shape_rectangle">shape_rectangle()</a></code>,
or <code><a href="#topic+shape_sf">shape_sf()</a></code>.</p>
</td></tr>
<tr><td><code id="configure_inset_+3A_scale">scale</code></td>
<td>
<p>Zoom scale: values larger than one will make the inset bigger.</p>
</td></tr>
<tr><td><code id="configure_inset_+3A_translation">translation</code></td>
<td>
<p>Translation (shift) of the inset relative to the centre.
This can be an <code>sf::st_point()</code> or simply a vector of length 2 containing
the x and y offsets respectively. Units are specified by <code>crs_working</code>.</p>
</td></tr>
<tr><td><code id="configure_inset_+3A_units">units</code></td>
<td>
<p>Base length unit (e.g. <code>"km"</code> or <code>"mi"</code>). Ignored if
<code>crs_working</code> is provided. See Details for supported values.</p>
</td></tr>
<tr><td><code id="configure_inset_+3A_crs_working">crs_working</code></td>
<td>
<p>The coordinate reference system to use internally when
applying the transformations. See Details.</p>
</td></tr>
<tr><td><code id="configure_inset_+3A_centre">centre</code>, <code id="configure_inset_+3A_radius">radius</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
Use <code>shape = shape_circle(centre, radius)</code> instead.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default <code>crs_working</code> uses the equidistant cylindrical coordinate
reference system with the latitude of true scale set to match the latitude of
<code>centre</code>. This ensures that circular insets will appear circular in most
cases since the projection is not distorted near the centre. The geometries
are converted to this CRS for the inset transformation and constructing the
inset frame, and are converted back to the CRS of <code>centre</code> at the end.
</p>
<p>The default units are kilometres but can be changed with <code>units</code>
instead of specifying the whole projection. The possible values for
<code>units</code> are
<a href="https://proj.org/operations/conversions/unitconvert.html#distance-units">those understood by <code>proj</code></a>:
</p>

<ul>
<li> <p><code>"mm"</code>: millimetre
</p>
</li>
<li> <p><code>"cm"</code>: centimetre
</p>
</li>
<li> <p><code>"m"</code>: metre
</p>
</li>
<li> <p><code>"ft"</code>: foot
</p>
</li>
<li> <p><code>"us-ft"</code>: US survey foot
</p>
</li>
<li> <p><code>"fath"</code>: fathom
</p>
</li>
<li> <p><code>"kmi"</code>: nautical mile
</p>
</li>
<li> <p><code>"us-ch"</code>: US survey chain
</p>
</li>
<li> <p><code>"us-mi"</code>: US survey mile
</p>
</li>
<li> <p><code>"km"</code>: kilometre
</p>
</li>
<li> <p><code>"ind-ft"</code>: Indian foot (1937)
</p>
</li>
<li> <p><code>"ind-yd"</code>: Indian yard (1937)
</p>
</li>
<li> <p><code>"mi"</code>: Statute mile
</p>
</li>
<li> <p><code>"yd"</code>: yard
</p>
</li>
<li> <p><code>"ch"</code>: chain
</p>
</li>
<li> <p><code>"link"</code>: link
</p>
</li>
<li> <p><code>"dm"</code>: decimeter
</p>
</li>
<li> <p><code>"in"</code>: inch
</p>
</li>
<li> <p><code>"ind-ch"</code>: Indian chain
</p>
</li>
<li> <p><code>"us-in"</code>: US survey inch
</p>
</li>
<li> <p><code>"us-yd"</code>: US survey yard</p>
</li></ul>



<h3>Value</h3>

<p>An inset configuration object of class <code>inset_config</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sf)

# circular inset with a 2x enlargement
cfg &lt;- configure_inset(
  shape_circle(centre = c(-82, 35), radius = 50),
  scale = 2,
  translation = c(70, -180),
  units = "mi"
)
</code></pre>

<hr>
<h2 id='coord_sf_inset'>Specify an inset configuration for the whole plot</h2><span id='topic+coord_sf_inset'></span>

<h3>Description</h3>

<p>This allows a default inset configuration to be provided to avoid having to
repeat it for each layer. Any layer that is inset-aware can use this as the
default configuration if none is specifically provided to that layer. This
coord also expands the axis limits to include the inset area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coord_sf_inset(inset, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coord_sf_inset_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.</p>
</td></tr>
<tr><td><code id="coord_sf_inset_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="ggplot2.html#topic+ggsf">ggplot2::coord_sf()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot coordinate object to be added to a plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+geom_sf_inset">geom_sf_inset()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

ggplot(nc) +
  geom_sf_inset(aes(fill = AREA)) +
  geom_inset_frame() +
  coord_sf_inset(inset = configure_inset(
    centre = sf::st_sfc(sf::st_point(c(-80, 35.5)), crs = 4326),
    scale = 1.5, translation = c(-50, -140), radius = 50, units = "mi"))
</code></pre>

<hr>
<h2 id='geom_inset_frame'>Add a frame and burst lines for an inset</h2><span id='topic+geom_inset_frame'></span>

<h3>Description</h3>

<p>The frame is computed from the inset configuration, so any <code>data</code> passed
to this layer is ignored. The frame is an sf object consisting of three features:
the source area, the target area (a scaled and translated version of the source
area), and the connecting/burst lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_inset_frame(
  mapping = ggplot2::aes(),
  data = NULL,
  stat = "sf_inset",
  position = "identity",
  ...,
  inset = NA,
  na.rm = FALSE,
  source.aes = list(),
  target.aes = list(),
  lines.aes = list(),
  show.legend = NA,
  inherit.aes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_inset_frame_+3A_mapping">mapping</code>, <code id="geom_inset_frame_+3A_data">data</code>, <code id="geom_inset_frame_+3A_stat">stat</code>, <code id="geom_inset_frame_+3A_position">position</code>, <code id="geom_inset_frame_+3A_na.rm">na.rm</code>, <code id="geom_inset_frame_+3A_show.legend">show.legend</code>, <code id="geom_inset_frame_+3A_inherit.aes">inherit.aes</code>, <code id="geom_inset_frame_+3A_...">...</code></td>
<td>
<p>See <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_inset_frame_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.
If <code>NA</code> (the default), this is inherited from the coord (see <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code>).</p>
</td></tr>
<tr><td><code id="geom_inset_frame_+3A_source.aes">source.aes</code>, <code id="geom_inset_frame_+3A_target.aes">target.aes</code>, <code id="geom_inset_frame_+3A_lines.aes">lines.aes</code></td>
<td>
<p>Override the aesthetics of the
inset source, target, and lines respectively. The value should be a list
named by the aesthetics, and the values should be scalars of length one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Burst lines for circular insets are bitangenets (tangent to both the source and
target circles) or absent if the circles are nested.
Burst lines for rectangular insets are the shortest line from each corner of the
source rectangle to any corner of the target rectangle, after excluding any such
lines that intersect either rectangle or each other.
When the burst lines are absent due to geometrical constraints, there will still
be a corresponding (empty) feature in the frame layer's data.
</p>


<h3>Value</h3>

<p>A ggplot layer holding the inset frame.
</p>


<h3>Limitation</h3>

<p>The frame cannot be drawn without another sf layer that contains data due to
a limitation of the ggplot layout evaluation. Attempting to plot a frame by
itself will result in the error:
&quot;Scale limits cannot be mapped onto spatial coordinates in <code>coord_sf()</code>&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

ggplot(nc) +
  geom_sf_inset() +
  geom_inset_frame(
    source.aes = list(fill = "red", alpha = 0.2, linewidth = 0),
    target.aes = list(colour = "blue"),
    lines.aes = list(linetype = 2, linewidth = 2)
  ) +
  coord_sf_inset(inset = configure_inset(
    shape_circle(centre = c(-82, 35), radius = 50),
    scale = 5, translation = c(0, -260), units = "mi"
  ))
</code></pre>

<hr>
<h2 id='geom_sf_inset'>Visualise sf objects with insets</h2><span id='topic+geom_sf_inset'></span><span id='topic+GeomSfInset'></span><span id='topic+stat_sf_inset'></span><span id='topic+StatSfInset'></span>

<h3>Description</h3>

<p>These geoms are wrappers around <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf()</a></code> and its relatives that
assist with creating map insets.
In many cases all that is needed is to use <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code> with <code><a href="#topic+configure_inset">configure_inset()</a></code>
to configure the location and transformation of the inset, and then replace the
sf-related geoms with their <code style="white-space: pre;">&#8288;_inset&#8288;</code> counterparts.
Use <code><a href="#topic+geom_inset_frame">geom_inset_frame()</a></code> to add a frame around the inset that connects it to the main map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_sf_inset(
  mapping = ggplot2::aes(),
  data = NULL,
  stat = "sf_inset",
  position = "identity",
  ...,
  inset = NA,
  map_base = "normal",
  map_inset = "auto",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)

stat_sf_inset(
  mapping = ggplot2::aes(),
  data = NULL,
  geom = "sf_inset",
  position = "identity",
  ...,
  inset = NA,
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_sf_inset_+3A_mapping">mapping</code>, <code id="geom_sf_inset_+3A_data">data</code>, <code id="geom_sf_inset_+3A_stat">stat</code>, <code id="geom_sf_inset_+3A_geom">geom</code>, <code id="geom_sf_inset_+3A_position">position</code>, <code id="geom_sf_inset_+3A_na.rm">na.rm</code>, <code id="geom_sf_inset_+3A_show.legend">show.legend</code>, <code id="geom_sf_inset_+3A_inherit.aes">inherit.aes</code>, <code id="geom_sf_inset_+3A_...">...</code></td>
<td>
<p>See <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_sf_inset_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.
If <code>NA</code> (the default), this is inherited from the coord (see <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code>).</p>
</td></tr>
<tr><td><code id="geom_sf_inset_+3A_map_base">map_base</code></td>
<td>
<p>Controls the layer with the base map. Possible values are
<code>"normal"</code> to create a layer as though the inset were not specified,
<code>"clip"</code> to create a layer with the inset viewport cut out, and
<code>"none"</code> to prevent the insertion of a layer for the base map.</p>
</td></tr>
<tr><td><code id="geom_sf_inset_+3A_map_inset">map_inset</code></td>
<td>
<p>Controls the layer with the inset map. Possible values are
<code>"auto"</code> to choose the behaviour based on whether <code>inset</code> is specified,
<code>"normal"</code> to create a layer with the viewport cut out and transformed, and
<code>"none"</code> to prevent the insertion of a layer for the viewport map.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally this works by creating two layers: one for the base map, and one
for the inset. These can be separately controlled by the <code>map_base</code> and
<code>map_inset</code> parameters. If <code>inset</code> is not specified, this geom will instead
behave like <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf()</a></code>.
</p>
<p>When an inset is configured, the default creates both base and inset layers
using the same aesthetic mapping and params:
</p>
<div class="sourceCode"><pre>geom_sf_inset(...)
</pre></div>
<p>You can alternatively specify the two layers separately:
</p>
<div class="sourceCode"><pre># draw the base map only (both versions are equivalent):
geom_sf(...)
geom_sf_inset(..., map_inset = "none")

# separately, draw the inset map only:
geom_sf_inset(..., map_base = "none")
</pre></div>
<p><code>stat_sf_inset()</code> works the same <code><a href="ggplot2.html#topic+ggsf">ggplot2::stat_sf()</a></code> except that it also
expands the axis limits to account for the inset area.
</p>


<h3>Value</h3>

<p>A ggplot layer similar to <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf()</a></code> but transformed according to the
inset configuration.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

ggplot(nc) +
  geom_sf_inset(aes(fill = AREA)) +
  geom_inset_frame() +
  coord_sf_inset(configure_inset(
    shape_circle(
      centre = sf::st_sfc(sf::st_point(c(-80, 35.5)), crs = sf::st_crs(nc)),
      radius = 50
    ),
    scale = 1.5, translation = c(-50, -140), units = "mi"
  ))
</code></pre>

<hr>
<h2 id='geom_sf_text_inset'>Extract coordinates from 'sf' objects (inset-aware)</h2><span id='topic+geom_sf_text_inset'></span><span id='topic+geom_sf_label_inset'></span><span id='topic+stat_sf_coordinates_inset'></span><span id='topic+StatSfCoordinatesInset'></span>

<h3>Description</h3>

<p>Reduce spatial data to coordinates in the same way as <code><a href="ggplot2.html#topic+stat_sf_coordinates">stat_sf_coordinates()</a></code>.
The result can then be used by <code><a href="ggplot2.html#topic+ggsf">geom_sf()</a></code> or
<code><a href="#topic+geom_sf_inset">geom_sf_inset()</a></code> or any geom that needs <code>x</code> and
<code>y</code> aesthetics. As this is particularly useful for text, wrappers are
provided for <code><a href="ggplot2.html#topic+geom_text">geom_text()</a></code> and <code><a href="ggplot2.html#topic+geom_text">geom_label()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_sf_text_inset(
  mapping = aes(),
  data = NULL,
  stat = "sf_coordinates_inset",
  position = "identity",
  ...,
  where = "inset",
  parse = FALSE,
  check_overlap = FALSE,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  fun.geometry = NULL
)

geom_sf_label_inset(
  mapping = aes(),
  data = NULL,
  stat = "sf_coordinates_inset",
  position = "identity",
  ...,
  where = "inset",
  parse = FALSE,
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  fun.geometry = NULL
)

stat_sf_coordinates_inset(
  mapping = ggplot2::aes(),
  data = NULL,
  geom = "point",
  position = "identity",
  ...,
  inset = NA,
  fun.geometry = NULL,
  where = "inset",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_sf_text_inset_+3A_mapping">mapping</code>, <code id="geom_sf_text_inset_+3A_data">data</code>, <code id="geom_sf_text_inset_+3A_geom">geom</code>, <code id="geom_sf_text_inset_+3A_position">position</code>, <code id="geom_sf_text_inset_+3A_na.rm">na.rm</code>, <code id="geom_sf_text_inset_+3A_show.legend">show.legend</code>, <code id="geom_sf_text_inset_+3A_inherit.aes">inherit.aes</code>, <code id="geom_sf_text_inset_+3A_fun.geometry">fun.geometry</code>, <code id="geom_sf_text_inset_+3A_...">...</code></td>
<td>
<p>See <code><a href="ggplot2.html#topic+stat_sf_coordinates">ggplot2::stat_sf_coordinates()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_sf_text_inset_+3A_stat">stat</code>, <code id="geom_sf_text_inset_+3A_parse">parse</code>, <code id="geom_sf_text_inset_+3A_check_overlap">check_overlap</code></td>
<td>
<p>See <code><a href="ggplot2.html#topic+ggsf">ggplot2::geom_sf_text()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_sf_text_inset_+3A_where">where</code></td>
<td>
<p>Specifies how the text position interacts with the inset.
<code>"inset"</code> means that any points in the inset area are drawn on the inset map,
<code>"base"</code> puts them on the base map. This setting is merely a shorthand for
setting the position aesthetics to <code>after_stat(x_inset)</code> or <code>after_stat(x)</code>
respectively, so will have no effect if these are specified in the mapping.</p>
</td></tr>
<tr><td><code id="geom_sf_text_inset_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.
If <code>NA</code> (the default), this is inherited from the coord (see <code><a href="#topic+coord_sf_inset">coord_sf_inset()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot layer
</p>


<h3>Required aesthetics</h3>


<dl>
<dt>geometry</dt><dd><p>The sf geometry column containing spatial features</p>
</dd>
</dl>



<h3>Computed variables</h3>


<dl>
<dt>x</dt><dd><p>X dimension of the simple feature</p>
</dd>
<dt>y</dt><dd><p>Y dimension of the simple feature</p>
</dd>
<dt>x_inset</dt><dd><p>X dimension of the simple feature after inset transformation</p>
</dd>
<dt>y_inset</dt><dd><p>Y dimension of the simple feature after inset transformation</p>
</dd>
<dt>inside_inset</dt><dd><p>logical indicating points inside the inset viewport</p>
</dd>
<dt>inset_scale</dt><dd><p>1 for points outside the inset, otherwise the configured inset scale parameter</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)

ggplot(nc) +
  geom_sf_inset() +
  geom_inset_frame() +
  geom_sf_text(
    aes(x = after_stat(x_inset), y = after_stat(y_inset), label = NAME),
    stat = "sf_coordinates_inset") +
  coord_sf_inset(configure_inset(
    shape_circle(
      centre = sf::st_sfc(sf::st_point(c(-80, 35.5)), crs = 4326),
      radius = 50
    ),
    scale = 1.5, translation = c(-50, -140), units = "mi"
  ))
</code></pre>

<hr>
<h2 id='get_inset_config'>Get the inset configuration from the params or coord</h2><span id='topic+get_inset_config'></span>

<h3>Description</h3>

<p>This is a helper for implementing inset-aware ggplot layers. If the <code>inset</code> is
missing (<code>NA</code>) then the default inset configuration is retrieved from the coord.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_inset_config(inset, coord)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_inset_config_+3A_inset">inset</code></td>
<td>
<p>Inset passed in as a param to the layer</p>
</td></tr>
<tr><td><code id="get_inset_config_+3A_coord">coord</code></td>
<td>
<p>Coord object for the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Inset configuration or <code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># defining a new geom deriving from geom_sf()
GeomCustom &lt;- ggplot2::ggproto("GeomCustom", ggplot2::GeomSf,
  draw_panel = function(self, data, panel_params, coord, inset = NA) {
    inset &lt;- get_inset_config(inset, coord)

    # do something with the inset ...

    # note that this example doesn't pass on the remaining geom_sf params but
    # in real usage you would probably want to do that
    ggplot2::ggproto_parent(ggplot2::GeomSf, self)$draw_panel(data, panel_params, coord)
  },
)
</code></pre>

<hr>
<h2 id='mozzies_nsw2301'>Mosquito counts from NSW Arbovirus Surveillance program</h2><span id='topic+mozzies_nsw2301'></span>

<h3>Description</h3>

<p>This dataset is derived from the
<a href="https://www.health.nsw.gov.au/Infectious/mosquito-borne/Pages/surveillance.aspx">NSW Arbovirus Surveillance and Mosquito Monitoring program</a>.
The program monitors mosquito-borne diseases in the state of New South Wales,
Australia. A number of mosquito traps are managed by the program during the
spring to autumn months when mosquitoes are active.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mozzies_nsw2301
</code></pre>


<h3>Format</h3>

<p>Data frame with the following fields:
</p>

<dl>
<dt>location</dt><dd><p>Location of the mosquito trap</p>
</dd>
<dt>week_ending</dt><dd><p>Date of the end of the week of observation</p>
</dd>
<dt>species</dt><dd><p>Mosquito species counted, or &quot;total&quot; for the total count</p>
</dd>
<dt>count</dt><dd><p>Binned mosquito abundance</p>
</dd>
<dt>type</dt><dd><p>Category of the site</p>
</dd>
<dt>lat</dt><dd><p>Latitude of trap in WGS 84 coordinates</p>
</dd>
<dt>long</dt><dd><p>Longitude of trap in WGS 84 coordinates</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each week traps are collected and the mosquito species are identified and
counted. This is analysed alongside climate conditions, and arbovirus
detections in the traps to inform public health management of human disease
risk from arboviruses in NSW. This dataset includes the mosquito abundance
tables for January 2023. Additional context and analysis can be found in the
original report published by NSW Health.
</p>
<p>The trap locations are classified as inland or coastal (since the species
found will depend on the environmental conditions). A separate group of sites
are labelled as being in the Sydney region (i.e. with the highest human
population density).
</p>
<p>The counts are binned with the following definition:
</p>

<dl>
<dt><code>NA</code></dt><dd><p>No observation</p>
</dd>
<dt>low</dt><dd><p>&lt; 50</p>
</dd>
<dt>medium</dt><dd><p>50 - 100</p>
</dd>
<dt>high</dt><dd><p>101 - 1,000</p>
</dd>
<dt>very high</dt><dd><p>1,001 - 10,000</p>
</dd>
<dt>extreme</dt><dd><p>&gt; 10,000</p>
</dd>
</dl>



<h3>Source</h3>

<p>Surveillance and Risk Unit, Environmental Health Branch,
Health Protection NSW, NSW Health.
&quot;NSW Arbovirus Surveillance and Mosquito Monitoring 2022-2023; Weekly Update: Week ending 25 February 2023 (Report Number 19)&quot;
<a href="https://www.health.nsw.gov.au/environment/pests/vector/Publications/nswasp-weekly-report-2023-02-25.pdf">https://www.health.nsw.gov.au/environment/pests/vector/Publications/nswasp-weekly-report-2023-02-25.pdf</a>,
accessed 15 January 2024.
</p>
<p>The original dataset is published under the
<a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0</a>
licence Â© State of New South Wales NSW Ministry of Health 2023.
</p>

<hr>
<h2 id='shape_circle'>Circular insets</h2><span id='topic+shape_circle'></span>

<h3>Description</h3>

<p>Circular insets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape_circle(centre, radius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shape_circle_+3A_centre">centre</code></td>
<td>
<p>Coordinates of the inset centre. Ideally this should be an
<code>sfc</code> object (see <code><a href="sf.html#topic+sfc">sf::st_sfc()</a></code>) including a coordinate reference system.
An <code><a href="sf.html#topic+st">sf::st_point()</a></code> or a vector of longitude and latitude are also accepted.
If a CRS cannot be determined, WGS 84 is assumed.</p>
</td></tr>
<tr><td><code id="shape_circle_+3A_radius">radius</code></td>
<td>
<p>Radius of the inset circle in the units of the inset's <code>crs_working</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A shape definition suitable for use with <code><a href="#topic+configure_inset">configure_inset()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+configure_inset">configure_inset()</a></code>
</p>
<p>Other shapes: 
<code><a href="#topic+shape_rectangle">shape_rectangle</a>()</code>,
<code><a href="#topic+shape_sf">shape_sf</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
make_demo &lt;- function(...) {
  ggplot(nc) +
    geom_sf(fill = "grey95", colour = "grey85") +
    # For a filled frame, we want to interleave it between the base layer
    # (above this line) and the target layer (below the following line).
    geom_inset_frame(target.aes = list(fill = "white")) +
    geom_sf_inset(map_base = "none") +
    coord_sf_inset(inset = configure_inset(...)) +
    theme_void()
}
circle &lt;- shape_circle(sf::st_centroid(nc[21,]), radius = 50)

make_demo(circle, scale = 3, translation = c(-200, -200))
make_demo(circle, scale = 3, translation = c(-100, -100))
make_demo(circle, scale = 3, translation = c(0, 0))
make_demo(circle, scale = 0.5, translation = c(0, 0))
</code></pre>

<hr>
<h2 id='shape_rectangle'>Rectangular insets</h2><span id='topic+shape_rectangle'></span>

<h3>Description</h3>

<p>Rectangular insets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape_rectangle(centre, hwidth, hheight = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shape_rectangle_+3A_centre">centre</code></td>
<td>
<p>Coordinates of the inset centre. Ideally this should be an
<code>sfc</code> object (see <code><a href="sf.html#topic+sfc">sf::st_sfc()</a></code>) including a coordinate reference system.
An <code><a href="sf.html#topic+st">sf::st_point()</a></code> or a vector of longitude and latitude are also accepted.
If a CRS cannot be determined, WGS 84 is assumed.</p>
</td></tr>
<tr><td><code id="shape_rectangle_+3A_hwidth">hwidth</code></td>
<td>
<p>Half width of the inset in the units of the inset's <code>crs_working</code>.</p>
</td></tr>
<tr><td><code id="shape_rectangle_+3A_hheight">hheight</code></td>
<td>
<p>Half height of the inset in the units of the inset's <code>crs_working</code>.
Defaults to the same value as <code>hwidth</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A shape definition suitable for use with <code><a href="#topic+configure_inset">configure_inset()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+configure_inset">configure_inset()</a></code>
</p>
<p>Other shapes: 
<code><a href="#topic+shape_circle">shape_circle</a>()</code>,
<code><a href="#topic+shape_sf">shape_sf</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
make_demo &lt;- function(...) {
  ggplot(nc) +
    geom_sf(fill = "grey95", colour = "grey85") +
    # For a filled frame, we want to interleave it between the base layer
    # (above this line) and the target layer (below the following line).
    geom_inset_frame(target.aes = list(fill = "white")) +
    geom_sf_inset(map_base = "none") +
    coord_sf_inset(inset = configure_inset(...)) +
    theme_void()
}
rectangle &lt;- shape_rectangle(sf::st_centroid(nc[21,]), hwidth = 50, hheight = 40)

make_demo(rectangle, scale = 3, translation = c(-300, 0))
make_demo(rectangle, scale = 3, translation = c(-250, -200))
make_demo(rectangle, scale = 3, translation = c(-150, -100))
make_demo(rectangle, scale = 3, translation = c(0, 0))
make_demo(rectangle, scale = 0.5, translation = c(0, 0))
</code></pre>

<hr>
<h2 id='shape_sf'>Arbitrary geometry as insets</h2><span id='topic+shape_sf'></span>

<h3>Description</h3>

<p>You can use any polygon to define the shape of the inset, including a
feature from your base map layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape_sf(geometry)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shape_sf_+3A_geometry">geometry</code></td>
<td>
<p>A simple features geometry that is either a polygon or
multipolygon, and is valid and simple.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A shape definition suitable for use with <code><a href="#topic+configure_inset">configure_inset()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+configure_inset">configure_inset()</a></code>
</p>
<p>Other shapes: 
<code><a href="#topic+shape_circle">shape_circle</a>()</code>,
<code><a href="#topic+shape_rectangle">shape_rectangle</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
make_demo &lt;- function(...) {
  ggplot(nc) +
    geom_sf(fill = "grey95", colour = "grey85") +
    # For a filled frame, we want to interleave it between the base layer
    # (above this line) and the target layer (below the following line).
    geom_inset_frame(target.aes = list(fill = "white")) +
    geom_sf_inset(map_base = "none", colour = NA) +
    coord_sf_inset(inset = configure_inset(...)) +
    theme_void()
}
shape &lt;- shape_sf(nc[21,])

make_demo(shape, scale = 6, translation = c(-200, -200))
make_demo(shape, scale = 6, translation = c(-100, -100))
make_demo(shape, scale = 6, translation = c(100, 100))
make_demo(shape, scale = 0.5, translation = c(0, 0))
</code></pre>

<hr>
<h2 id='transform_to_inset'>Transform coordinates according to inset configuration</h2><span id='topic+transform_to_inset'></span>

<h3>Description</h3>

<p>This helper operates on an sf object to scale and translate its geometry according
to the inset specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_to_inset(x, inset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_to_inset_+3A_x">x</code></td>
<td>
<p>Spatial data frame or other sf object; see <code><a href="sf.html#topic+st_geometry">sf::st_geometry()</a></code>.</p>
</td></tr>
<tr><td><code id="transform_to_inset_+3A_inset">inset</code></td>
<td>
<p>Inset configuration; see <code><a href="#topic+configure_inset">configure_inset()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A copy of <code>x</code> with the geometry replaced by the transformed version.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sf)

nc &lt;- sf::st_read(system.file("shape/nc.shp", package = "sf"), quiet = TRUE)
cfg &lt;- configure_inset(
  centre = st_sfc(st_point(c(-82, 35)), crs = 4326),
  scale = 2,
  translation = c(10, -60),
  radius = 50,
  units = "mi")

transform_to_inset(nc, cfg)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
