<!DOCTYPE html><html><head><title>Help for package pgKDEsphere</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pgKDEsphere}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pgKDEsphere-internal'><p>Internal pgKDEsphere Functions</p></a></li>
<li><a href='#pi.kappa'><p>pi.kappa</p></a></li>
<li><a href='#sphkde.pg'><p>sphkde.pg</p></a></li>
<li><a href='#sphkde.plot'><p>sphkde.plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Parametrically Guided Kernel Density Estimator for Spherical
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-06</td>
</tr>
<tr>
<td>Author:</td>
<td>María Alonso-Pena [aut, cre],
  Gerda Claeskens [aut],
  Irène Gijbels [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>María Alonso-Pena &lt;maria.alonsopena@ugr.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric density estimation for (hyper)spherical data by means of a parametrically guided kernel estimator (adaptation of the method of Hjort and Glad (1995) &lt;<a href="https://doi.org/10.1214%2Faos%2F1176324627">doi:10.1214/aos/1176324627</a>&gt; to the spherical setting). The package also allows the data-driven selection of the smoothing parameter and the representation of the estimated density for circular and spherical data. Estimators of the density without guide can also be obtained.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.11), rgl, Directional, DirStats, circular,
matrixStats, rotasym, movMF</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-06 14:07:55 UTC; Despacho 7</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-07 17:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='pgKDEsphere-internal'>Internal pgKDEsphere Functions</h2><span id='topic+cart_sph'></span><span id='topic+hopt'></span><span id='topic+KDE'></span><span id='topic+KDE_sph_vMF'></span><span id='topic+pgKDE_sph_vMF'></span><span id='topic+plot_sphkde'></span><span id='topic+Rgr'></span>

<h3>Description</h3>

<p>Internal pgKDEsphere functions.
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.</p>

<hr>
<h2 id='pi.kappa'>pi.kappa</h2><span id='topic+pi.kappa'></span>

<h3>Description</h3>

<p>Function <code>pi.kappa</code> computes a plug-in type smoothing parameter for the parametrically guided (hyper)spherical kernel density estimator, equipped with a von Mises-Fisher guide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pi.kappa(datax, mu0, tau0, guide = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pi.kappa_+3A_datax">datax</code></td>
<td>
<p>Matrix containing the data in cartesian coordinates, where the number of rows is the number of observations and the number of columns is the dimension of the Euclidean space where the sphere is embebed.</p>
</td></tr>
<tr><td><code id="pi.kappa_+3A_mu0">mu0</code></td>
<td>
<p>Vector containing the mean direction of the von Mises-Fisher guide.</p>
</td></tr>
<tr><td><code id="pi.kappa_+3A_tau0">tau0</code></td>
<td>
<p>Numerical value containing the concentration of the von Mises-Fisher guide.</p>
</td></tr>
<tr><td><code id="pi.kappa_+3A_guide">guide</code></td>
<td>
<p>Logical; if TRUE, the estimator with a von Mises-Fisher as guide is computed. If FALSE, the classical kernel density estimator without guide is computed (equivalent to uniform guide).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2023) for details.
</p>


<h3>Value</h3>

<p>A numerical value with the selected data-driven smoothing parameter.
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Claeskens, G. and Gijbels, I. (2023) Nonparametric estimation of densities on the hypersphere using a parametric guide. Under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Directional)
library(movMF)
# Data generation
n&lt;-200
mu&lt;-matrix(c(0,0,1,0,0,-1),ncol=3,byrow=TRUE)
k&lt;-c(7,2)
probs&lt;-c(0.85,0.15)
datax&lt;-rmovMF(n,k*mu,alpha=probs)
# Estimation of parameters of a vMF
param&lt;-vmf.mle(datax)
mu0&lt;-param$mu
tau0&lt;-param$kappa
# Selection of the smoothing parameter
kappa &lt;- pi.kappa(datax,mu0,tau0)
</code></pre>

<hr>
<h2 id='sphkde.pg'>sphkde.pg</h2><span id='topic+sphkde.pg'></span>

<h3>Description</h3>

<p>Function <code>sphkde.pg</code> computes the kernel density estimator for (hyper)spherical data with a parametric guide, which corresponds to the von Mises-Fisher model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphkde.pg(datax, kappa = NULL, eval.points = NULL, guide = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sphkde.pg_+3A_datax">datax</code></td>
<td>
<p>Matrix containing the data in cartesian coordinates, where the number of rows is the number of observations and the number of columns is the dimension of the Euclidean space where the sphere is embebed.</p>
</td></tr>
<tr><td><code id="sphkde.pg_+3A_kappa">kappa</code></td>
<td>
<p>Smoothing parameter. It refers to the concentration when employing a von Mises-Fisher kernel.</p>
</td></tr>
<tr><td><code id="sphkde.pg_+3A_eval.points">eval.points</code></td>
<td>
<p>Matrix containing the evaluation points for the estimation of the density.</p>
</td></tr>
<tr><td><code id="sphkde.pg_+3A_guide">guide</code></td>
<td>
<p>Logical; if TRUE, the estimator with a von Mises-Fisher as guide is computed. If FALSE, the classical kernel density estimator without guide is computed (equivalent to uniform guide).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2023) for details.
</p>


<h3>Value</h3>

<p>An object with class &quot;sphkde&quot; whose underlying structure is a list containing the following components: </p>
<table>
<tr><td><code>estim</code></td>
<td>
<p> The estimated values of the density.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>The smoothing parameter used.</p>
</td></tr> <tr><td><code>data</code></td>
<td>
<p>The n coordinates of the points where the regression is estimated.</p>
</td></tr>
<tr><td><code>eval.points</code></td>
<td>
<p>The points where the estimated density was evaluated.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Original dataset.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Alonso-Pena, M., Claeskens, G. and Gijbels, I. (2023) Nonparametric estimation of densities on the hypersphere using a parametric guide. Under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(movMF)
n&lt;-200
mu&lt;-matrix(c(0,0,1,0,0,-1),ncol=3,byrow=TRUE)
k&lt;-c(7,2)
probs&lt;-c(0.85,0.15)
datax&lt;-rmovMF(n,k*mu,alpha=probs)
est&lt;-sphkde.pg(datax,guide=TRUE)
sphkde.plot(est,type="sph")
</code></pre>

<hr>
<h2 id='sphkde.plot'>sphkde.plot</h2><span id='topic+sphkde.plot'></span>

<h3>Description</h3>

<p>Function <code>sphkde.plot</code> provides a graphical representation of the parametrically guided kernel density estimator for spherical and circular data. For circular data, both linear and circular representations are available. For spherical data, an interactive 3D spherical representation is provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphkde.plot(object, type = "sph", axis = TRUE, shrink = 1.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sphkde.plot_+3A_object">object</code></td>
<td>
<p>Object of the class <code>sphkde</code>.</p>
</td></tr>
<tr><td><code id="sphkde.plot_+3A_type">type</code></td>
<td>
<p>Character string giving the desired type of plot. For circular data, it can be &quot;sph&quot; for a circular representation or &quot;line&quot; for a linear representation. For spherical data the value &quot;sph&quot; is required.</p>
</td></tr>
<tr><td><code id="sphkde.plot_+3A_axis">axis</code></td>
<td>
<p>Logical; if TRUE, the axis are represented in the spherical representation. If FALSE, axis are not represented. Only for spherical representations.</p>
</td></tr>
<tr><td><code id="sphkde.plot_+3A_shrink">shrink</code></td>
<td>
<p>Numeric parameter that controls the size of the plotted circle in the circular representations. Default is 1.3. Larger values shrink the circle, while smaller values enlarge the circle.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Alonso-Pena et al. (2023) for details.
</p>


<h3>Value</h3>

<p><code>sphkde.plot</code> is called for the side effect of drawing the plot.
</p>


<h3>References</h3>

<p>Alonso-Pena, M., Claeskens, G. and Gijbels, I. (2023) Nonparametric estimation of densities on the hypersphere using a parametric guide. Under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(movMF)
n&lt;-200
mu&lt;-matrix(c(0,0,1,0,0,-1),ncol=3,byrow=TRUE)
k&lt;-c(7,2)
probs&lt;-c(0.85,0.15)
datax&lt;-rmovMF(n,k*mu,alpha=probs)
est&lt;-sphkde.pg(datax,guide=TRUE)
sphkde.plot(est,type="sph")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
