<!DOCTYPE html><html><head><title>Help for package PELVIS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PELVIS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_metavars'><p>Add the five Bruzek's main characters to a dataframe containing</p>
the eleven basic traits.</a></li>
<li><a href='#bruzek02'>
<p>Internal function for sexing the human os coxae using Bruzek's</p>
method (2002)</a></li>
<li><a href='#CTscanDataBruzek'>
<p>Dataset including 198 virtually reconstructed ossa coxae</p></a></li>
<li><a href='#dataframe_sexing'><p>Internal function for sexing several human ossa coxae using both</p>
original and revised Bruzek's methods (2002, 2019)</a></li>
<li><a href='#indiv_sexing'>
<p>Internal function for sexing one single human os coxae using</p>
revised Bruzek's method (2019)</a></li>
<li><a href='#PELVIS-package'>
<p>Probabilistic Sex Estimate using Logistic Regression, Based on VISual</p>
Traits of the Human Os Coxae</a></li>
<li><a href='#refDataBruzek02'>
<p>Learning dataset for logistic regression models</p></a></li>
<li><a href='#rightBonesDataBruzek'>
<p>Dataset including 518 right ossa coxae</p></a></li>
<li><a href='#start_pelvis'>
<p>An R-Shiny application for the sex estimation of the human os coxae</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilistic Sex Estimate using Logistic Regression, Based on
VISual Traits of the Human Os Coxae</td>
</tr>
<tr>
<td>Description:</td>
<td>An R-Shiny application implementing a method of sexing the human os coxae based on logistic regressions and Bruzek's nonmetric traits &lt;<a href="https://doi.org/10.1002%2Fajpa.23855">doi:10.1002/ajpa.23855</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.4</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>DT, htmlwidgets, MASS, shiny</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.cecill.info/licences/Licence_CeCILL_V2-en.txt">CeCILL-2</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/f-santos/pelvis/">https://gitlab.com/f-santos/pelvis/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/f-santos/pelvis/-/issues">https://gitlab.com/f-santos/pelvis/-/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-27 15:24:28 UTC; fsantos</td>
</tr>
<tr>
<td>Author:</td>
<td>Frédéric Santos <a href="https://orcid.org/0000-0003-1445-3871"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Élodie Bernardeau [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frédéric Santos &lt;frederic.santos@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-08 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_metavars'>Add the five Bruzek's main characters to a dataframe containing
the eleven basic traits.</h2><span id='topic+add_metavars'></span><span id='topic+addMetavars'></span>

<h3>Description</h3>

<p>From a given dataset including the 11 visual traits exposed
by Bruzek (2002), this function adds three corresponding main characters
(PrSu, GrSN and InfP) based on the majority rule exposed in the original
article.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_metavars(dat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_metavars_+3A_dat">dat</code></td>
<td>
<p>A dataframe including the 11 visual traits described by Bruzek.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe including also the main characters derived from those visual traits.
</p>


<h3>Note</h3>

<p>This is mainly an internal function for the R-Shiny application
implemented in PELVIS.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Bruzek, J. (2002) A method for visual determination of sex, using the
human hip bone. <em>American Journal of Physical Anthropology</em>
<b>117</b>, 157&ndash;168. doi: 10.1002/ajpa.10012</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a dataset:
data(CTscanDataBruzek)
# Visualize the traits:
head(CTscanDataBruzek)
# Add all the main Bruzek's characters:
complete &lt;- add_metavars(CTscanDataBruzek)
head(complete)
</code></pre>

<hr>
<h2 id='bruzek02'>
Internal function for sexing the human os coxae using Bruzek's
method (2002)
</h2><span id='topic+bruzek02'></span>

<h3>Description</h3>

<p>Produces a single (and non-probabilistic) sex estimate from five
characters observed on the human os coxae, following Bruzek (2002)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bruzek02(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bruzek02_+3A_x">x</code></td>
<td>
<p>A character vector of length 5, having three possible values:
&lsquo;F&rsquo;, &lsquo;0&rsquo; or &lsquo;M&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>One unique character value, &lsquo;F&rsquo;, &lsquo;I&rsquo; or &lsquo;M&rsquo;,
according to the majority rule exposed by Bruzek (2002).
</p>


<h3>Note</h3>

<p>This is mainly an internal function for the R-Shiny application
implemented in PELVIS.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Bruzek, J. (2002) A method for visual determination of sex, using the
human hip bone. <em>American Journal of Physical Anthropology</em>
<b>117</b>, 157&ndash;168. doi: 10.1002/ajpa.10012</p>


<h3>Examples</h3>

<pre><code class='language-R'># Here we create manually an individual:
individual &lt;- c(PrSu = "M", GrSN = "F",
                CArc = "F", InfP = "0", IsPu = "F")
individual
# Determination produced by Bruzek (2002): female individual.
bruzek02(individual)
</code></pre>

<hr>
<h2 id='CTscanDataBruzek'>
Dataset including 198 virtually reconstructed ossa coxae
</h2><span id='topic+CTscanDataBruzek'></span>

<h3>Description</h3>

<p>This dataset includes 198 ossa coxae segmented from CT-scans. The
eleven trichotomic traits are given for each os coaxe (possibly with
missing values for incomplete bones), along with the geographical
origin and known sex of the individual. When possible, the age and
stature of the individual are also given. This dataset is used as a
training sample for the logistic regression models implemented in
PELVIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CTscanDataBruzek)</code></pre>


<h3>Format</h3>

<p>A data frame with 198 observations on the following 16 variables:
</p>

<dl>
<dt><code>Id</code></dt><dd><p>a factor with 198 levels (unique ID of each os coxae)</p>
</dd>
<dt><code>Indiv</code></dt><dd><p>a factor with 99 levels (ID of each individual to whom the bone belongs)</p>
</dd>
<dt><code>Sex</code></dt><dd><p>a factor with levels <code>F</code>, <code>M</code> (known sex)</p>
</dd>
<dt><code>Age</code></dt><dd><p>a numeric vector (age of the associated individual in years)</p>
</dd>
<dt><code>Side</code></dt><dd><p>a factor with levels <code>L</code>, <code>R</code> (left or right side)</p>
</dd>
<dt><code>PrSu1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>CArc</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>IsPu</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>InfP1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em> <b>169</b>(3), 435-447. doi: 10.1002/ajpa.23855
</p>
<p>Bruzek, J., Rmoutilova, R., Guyomarc'h, P., &amp; Santos, F. (2019)
Supporting data for: A method of sexing the human os coxae based on
logistic regressions and Bruzek's nonmetric traits [Data
set]. Zenodo. http://doi.org/10.5281/zenodo.2589917
</p>

<hr>
<h2 id='dataframe_sexing'>Internal function for sexing several human ossa coxae using both
original and revised Bruzek's methods (2002, 2019)</h2><span id='topic+dataframe_sexing'></span><span id='topic+sexingFromFile'></span>

<h3>Description</h3>

<p>Produces sex estimates from each of the ossa coxae
submitted by the user through the graphical user interface of the
R-Shiny application.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataframe_sexing(data, ref, updateProgressBar = NULL, conf_level = 0.95,
strategy = c("BIC", "AIC", "None"), trace = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataframe_sexing_+3A_data">data</code></td>
<td>
<p>A test dataset submitted by the user throught the
graphical user interface. The predictive factors (i.e. the eleven
trichotomic traits) should have the same headers and levels as in
the reference dataset &lsquo;refData&rsquo; included in PELVIS. An
example of valid data file can be found on Zenodo:
<a href="https://doi.org/10.5281/zenodo.2586897">doi:10.5281/zenodo.2586897</a> (its field separator is the semicolon
&quot;;&quot;).</p>
</td></tr>
<tr><td><code id="dataframe_sexing_+3A_ref">ref</code></td>
<td>
<p>A learning dataset for logistic
regression models, basically the dataset &lsquo;refDataBruzek02&rsquo;
included in PELVIS (or any other dataset with the same variables).</p>
</td></tr>
<tr><td><code id="dataframe_sexing_+3A_updateprogressbar">updateProgressBar</code></td>
<td>
<p>Internal option for the R-Shiny application.</p>
</td></tr>
<tr><td><code id="dataframe_sexing_+3A_conf_level">conf_level</code></td>
<td>
<p>0.95 by default, confidence level needed to produce
a sex estimate.</p>
</td></tr>
<tr><td><code id="dataframe_sexing_+3A_strategy">strategy</code></td>
<td>
<p>A choice of information criterion (<code>"BIC"</code> or
<code>"AIC"</code>) for variable selection in logistic regression models,
or <code>"None"</code> for no variable selection.</p>
</td></tr>
<tr><td><code id="dataframe_sexing_+3A_trace">trace</code></td>
<td>
<p>See <code>MASS::stepAIC</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A complete dataframe of results displayed through the R-Shiny application.
</p>


<h3>Note</h3>

<p>This is an internal function for the R-Shiny application implemented in PELVIS.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em>, <b>169</b>(3), 435&ndash;447. doi: 10.1002/ajpa.23855
</p>

<hr>
<h2 id='indiv_sexing'>
Internal function for sexing one single human os coxae using
revised Bruzek's method (2019)
</h2><span id='topic+indiv_sexing'></span><span id='topic+indivSexing'></span>

<h3>Description</h3>

<p>Produces a statistical sex estimate from up to eleven
characters observed on the human os coxae, following Bruzek (2019), and
using logistic regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indiv_sexing(ref, new_ind, strategy = c("BIC", "AIC", "None"), trace = 1,
conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indiv_sexing_+3A_ref">ref</code></td>
<td>
<p>A learning dataset for logistic regression models,
basically the dataset &lsquo;refData&rsquo; included in PELVIS (or any
other dataset with the same variables).</p>
</td></tr>
<tr><td><code id="indiv_sexing_+3A_new_ind">new_ind</code></td>
<td>
<p>A new os coxae to be determined, with eleven observed
traits (possibly with missing values).</p>
</td></tr>
<tr><td><code id="indiv_sexing_+3A_strategy">strategy</code></td>
<td>
<p>A choice of information criterion (<code>"BIC"</code> or
<code>"AIC"</code>) for variable selection in logistic regression models,
or <code>"None"</code> for no variable selection.</p>
</td></tr>
<tr><td><code id="indiv_sexing_+3A_trace">trace</code></td>
<td>
<p>Passed to <code>MASS::stepAIC</code>.</p>
</td></tr>
<tr><td><code id="indiv_sexing_+3A_conf_level">conf_level</code></td>
<td>
<p>Required posterior probability threshold to produce
a sex estimate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>PredictedSex</code></td>
<td>
<p>One unique character value, &lsquo;F&rsquo;, &lsquo;I&rsquo;
or &lsquo;M&rsquo;: final sex estimate for the studied os coxae.</p>
</td></tr>
<tr><td><code>PostProb</code></td>
<td>
<p>Posterior probability for the individual to be a
male.</p>
</td></tr>
<tr><td><code>BestModel</code></td>
<td>
<p>Best logistic regression model for the
studied os coxae according to the BIC criterion.</p>
</td></tr>
<tr><td><code>VariablesUsed</code></td>
<td>
<p>Names of the variables (including part or all of
the nonmissing traits for the studied os coaxe) used in this best
model.</p>
</td></tr>
<tr><td><code>cvRate</code></td>
<td>
<p>Success rate in cross-validation. Cf. Santos et
al. (2019) for more details about cross-validation here.</p>
</td></tr>
<tr><td><code>cvIndet</code></td>
<td>
<p>Rate of individuals remaining indeterminate using the
best logistic regression model.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is mostly an internal function for the R-Shiny application
implemented in PELVIS.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em> <b>169</b>(3), 435-447. doi: 10.1002/ajpa.23855
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(refDataBruzek02)
# Pick the first individual of the reference dataset with its 11 traits, as an example:
individual &lt;- refDataBruzek02[1, -c(1:6)]
individual
# Compute a sex estimate for this individual:
indiv_sexing(ref = refDataBruzek02, new_ind = individual)
</code></pre>

<hr>
<h2 id='PELVIS-package'>
Probabilistic Sex Estimate using Logistic Regression, Based on VISual
Traits of the Human Os Coxae
</h2><span id='topic+PELVIS-package'></span><span id='topic+PELVIS'></span>

<h3>Description</h3>

<p>An R-Shiny application implementing a method of sexing the human os
coxae based on logistic regressions and Bruzek's nonmetric traits.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> PELVIS</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> CeCILL-2.1</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Bruzek, J. (2002) A method for visual determination of sex, using the
human hip bone. <em>American Journal of Physical Anthropology</em>
<b>117</b>, 157&ndash;168. doi: 10.1002/ajpa.10012
</p>
<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em> <b>169</b>(3), 435-447. doi: 10.1002/ajpa.23855
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){ StartPELVIS() }
</code></pre>

<hr>
<h2 id='refDataBruzek02'>
Learning dataset for logistic regression models
</h2><span id='topic+refDataBruzek02'></span>

<h3>Description</h3>

<p>This dataset includes 592 ossa coxae from five population samples. The
eleven trichotomic traits are given for each os coaxe (possibly with
missing values for incomplete bones), along with the geographical origin
and known sex of the individual. When possible, the age and stature of
the individual are also given. This dataset is used as a training sample
for the logistic regression models implemented in PELVIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(refDataBruzek02)</code></pre>


<h3>Format</h3>

<p>A data frame with 592 observations on the following 17 variables:
</p>

<dl>
<dt><code>Id</code></dt><dd><p>a factor with 592 levels (unique ID of the individual to whom the bone belongs)</p>
</dd>
<dt><code>Orig</code></dt><dd><p>a factor with 5 levels (geographical origin)</p>
</dd>
<dt><code>Sex</code></dt><dd><p>a factor with levels <code>F</code>, <code>M</code> (known sex)</p>
</dd>
<dt><code>Age</code></dt><dd><p>a numeric vector (age of the associated individual in years)</p>
</dd>
<dt><code>Side</code></dt><dd><p>a factor with levels <code>L</code>, <code>R</code> (left or right side)</p>
</dd>
<dt><code>Stature</code></dt><dd><p>a numeric vector (in cm)</p>
</dd>
<dt><code>PrSu1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>CArc</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>IsPu</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>InfP1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em> <b>169</b>(3), 435-447. doi: 10.1002/ajpa.23855
</p>
<p>Bruzek, J., Rmoutilova, R., Guyomarc'h, P., &amp; Santos, F. (2019)
Supporting data for: A method of sexing the human os coxae based on
logistic regressions and Bruzek's nonmetric traits [Data
set]. Zenodo. http://doi.org/10.5281/zenodo.2589917
</p>

<hr>
<h2 id='rightBonesDataBruzek'>
Dataset including 518 right ossa coxae
</h2><span id='topic+rightBonesDataBruzek'></span>

<h3>Description</h3>

<p>This dataset includes 518 right ossa coxae from five population
samples. These bones are used as a validation sample in the original
study (Santos et al., 2019). The eleven trichotomic traits are given
for each os coaxe (possibly with missing values for incomplete bones),
along with the geographical origin and known sex of the
individual. When possible, the age and stature of the individual are
also given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rightBonesDataBruzek)</code></pre>


<h3>Format</h3>

<p>A data frame with 518 observations on the following 17 variables:
</p>

<dl>
<dt><code>Id</code></dt><dd><p>a factor with 518 levels (unique ID of each os coxae)</p>
</dd>
<dt><code>Orig</code></dt><dd><p>a factor with 5 levels (geographical origin or collection)</p>
</dd>
<dt><code>Sex</code></dt><dd><p>a factor with levels <code>F</code>, <code>M</code> (known sex)</p>
</dd>
<dt><code>Age</code></dt><dd><p>a numeric vector (age of the associated individual in years)</p>
</dd>
<dt><code>Side</code></dt><dd><p>a factor with one single level <code>R</code> (right side)</p>
</dd>
<dt><code>Stature</code></dt><dd><p>a numeric vector (in cm)</p>
</dd>
<dt><code>PrSu1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>PrSu3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>GrSN3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>CArc</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>IsPu</code></dt><dd><p>an ordered factor with levels <code>F</code>, <code>0</code>, <code>M</code></p>
</dd>
<dt><code>InfP1</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP2</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
<dt><code>InfP3</code></dt><dd><p>an ordered factor with levels <code>f</code>, <code>i</code>, <code>m</code></p>
</dd>
</dl>



<h3>References</h3>

<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em> <b>169</b>(3), 435-447. doi: 10.1002/ajpa.23855
</p>
<p>Bruzek, J., Rmoutilova, R., Guyomarc'h, P., &amp; Santos, F. (2019)
Supporting data for: A method of sexing the human os coxae based on
logistic regressions and Bruzek's nonmetric traits [Data
set]. Zenodo. http://doi.org/10.5281/zenodo.2589917
</p>

<hr>
<h2 id='start_pelvis'>
An R-Shiny application for the sex estimation of the human os coxae
</h2><span id='topic+start_pelvis'></span><span id='topic+StartPELVIS'></span>

<h3>Description</h3>

<p>Launches a graphical user interface (GUI) allowing to use Bruzek's
methods (2002, 2019) for sexing the human os coxae, based on eleven
visual traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>start_pelvis()
StartPELVIS()
</code></pre>


<h3>Details</h3>

<p>The R-Shiny application proposes two tabs:
</p>

<ul>
<li> <p>&lsquo;Data input: manual editing&rsquo; can be used for both data
entry and sex classification. The eleven trichotomic traits are
manually edited for each os coxae through the GUI, and the
corresponding sex estimates are then produced.
</p>
</li>
<li> <p>&lsquo;Data input: from text file&rsquo; is the classical way to
get the sex estimates for a whole sample of ossa coxae correctly
described in a file. PELVIS accepts .CSV or .TXT data files, but
does not support .ODS or .XLS(X) files. The predictive factors
(i.e. the eleven trichotomic traits) should have the same headers
and levels as in the reference dataset &lsquo;refData&rsquo; included in
PELVIS. An example of valid data file can be found on Zenodo:
<a href="https://doi.org/10.5281/zenodo.2586897">doi:10.5281/zenodo.2586897</a> (its field separator is
the semicolon &quot;;&quot;).
</p>
</li></ul>

<p>In both tabs, two sex estimates are given: the visual sex estimate
from Bruzek (2002), and the probabilistic sex estimate from Santos,
Guyomarc'h, Rmoutilova and Bruzek (2019). Depending on the traits
possibly missing on the ossa coxae submitted to the program, the
logistic regression models can use various subsets of best predictors
(selected by AIC or BIC), or all predictors. The final subset of
predictors used for each os coxae is given in the table of results.
The user may also want to define a posterior probability threshold for
sex estimation (0.90 or 0.95): any os coxae that does not reach this
threshold will remain indeterminate.
</p>


<h3>Value</h3>

<p>The function returns no value by itself, but the results can be
downloaded through the graphical interface. The table of results
includes the following columns:
</p>

<ul>
<li> <p>&lsquo;Sex estimate (Bruzek 2002)&rsquo;: the visual sex estimate
based on Bruzek's method (2002).
</p>
</li>
<li> <p>&lsquo;Statistical sex estimate (2019)&rsquo;: a sex estimation
based on a logistic regression model, following the method described
in Santos, Guyomarc'h, Rmoutilova and Bruzek (2019, submitted).
</p>
</li>
<li> <p>&lsquo;Prob(M)&rsquo; is the probability (obtained with the
logistic regression model) that the individual is a man. According
to tradition in biological anthropology, we have the following
decsion rule: if Prob(M)&gt;0.95 then the sex estimate is &lsquo;M&rsquo;;
if Prob(M)&lt;0.05 then the sex estimate is &lsquo;F&rsquo;; else the
individual remains indeterminate (&lsquo;I&rsquo;).
</p>
</li>
<li> <p>&lsquo;Prob(F)&rsquo;, defined as 1-Prob(M), is the probability
that the individual is a woman.
</p>
</li>
<li> <p>&lsquo;Selected predictors in LR model&rsquo;: for a given
individual, the sex estimation proceeds as follows. First, a
complete model is built using all available (i.e., nonmissing)
traits for this individual. Then, a classical stepwise model
selection by BIC is performed, and the subset of the most useful
traits is used to produce the final sex estimate. This column gives
the traits used for each individual.
</p>
</li>
<li> <p>&lsquo;10-fold CV accuracy (%)&rsquo;: the rate of correct
classification for the corresponding logistic regression model is
estimated using a ten-fold cross-validation on the learning sample.
</p>
</li>
<li> <p>&lsquo;Indet. rate in CV (%)&rsquo;: the rate of individuals
remaining indeterminate in cross-validation for the corresponding
logistic regression model.
</p>
</li></ul>



<h3>Note</h3>

<p>The R console is not available when the GUI is active. To exit the GUI,
type Echap (on MS Windows systems) or Ctrl+C (on Linux systems) in the R
console.
</p>
<p>Regardless of the size and resolution of your screen, for convenience,
it is advisable to decrease the zoom level of your web browser and/or to
turn on fullscreen mode.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, &lt;frederic.santos@u-bordeaux.fr&gt;
</p>


<h3>References</h3>

<p>Bruzek, J. (2002) A method for visual determination of sex, using the
human hip bone. <em>American Journal of Physical Anthropology</em>
<b>117</b>, 157&ndash;168. doi: 10.1002/ajpa.10012
</p>
<p>Santos, F., Guyomarc'h, P., Rmoutilova, R. and Bruzek, J. (2019) A
method of sexing the human os coxae based on logistic regressions and
Bruzek's nonmetric traits. <em>American Journal of Physical
Anthropology</em>, <b>169</b>(3), 435&ndash;447. doi: 10.1002/ajpa.23855
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){start_pelvis()}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
