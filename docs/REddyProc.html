<!DOCTYPE html><html lang="en"><head><title>Help for package REddyProc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REddyProc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#REddyProc-package'><p>Post Processing of (Half-)Hourly Eddy-Covariance Measurements</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#BerkeleyJulianDateToPOSIXct'><p>BerkeleyJulianDateToPOSIXct</p></a></li>
<li><a href='#DEGebExample'><p>Eddy covariance data from Gebesee crop site, Germany</p></a></li>
<li><a href='#estimate_vpd_from_dew'><p>Estimate VPD from assuming dewpoint at daily minimum temperature</p></a></li>
<li><a href='#Example_DETha98'><p>Eddy covariance data from Tharandt, Germany</p></a></li>
<li><a href='#extract_FN15'><p>extract processing results with columns corresponding to Fluxnet15 release</p></a></li>
<li><a href='#fCalcAVPfromVMFandPress'><p>fCalcAVPfromVMFandPress</p></a></li>
<li><a href='#fCalcETfromLE'><p>fCalcETfromLE</p></a></li>
<li><a href='#fCalcExtRadiation'><p>fCalcExtRadiation</p></a></li>
<li><a href='#fCalcPotRadiation'><p>fCalcPotRadiation</p></a></li>
<li><a href='#fCalcRHfromAVPandTair'><p>fCalcRHfromAVPandTair</p></a></li>
<li><a href='#fCalcSVPfromTair'><p>fCalcSVPfromTair</p></a></li>
<li><a href='#fCalcVPDfromRHandTair'><p>fCalcVPDfromRHandTair</p></a></li>
<li><a href='#fCheckHHTimeSeries'><p>fCheckHHTimeSeries</p></a></li>
<li><a href='#fConvertCtoK'><p>fConvertCtoK</p></a></li>
<li><a href='#fConvertGlobalToVisible'><p>fConvertGlobalToVisible</p></a></li>
<li><a href='#fConvertKtoC'><p>fConvertKtoC</p></a></li>
<li><a href='#fConvertTimeToPosix'><p>fConvertTimeToPosix</p></a></li>
<li><a href='#fConvertVisibleWm2toPhotons'><p>fConvertVisibleWm2toPhotons</p></a></li>
<li><a href='#filter_entire_days'><p>filter entire days</p></a></li>
<li><a href='#filter_years_eop'><p>filter years eop</p></a></li>
<li><a href='#filterLongRuns'><p>filterLongRuns</p></a></li>
<li><a href='#filterLongRunsInVector'><p>filterLongRunsInVector</p></a></li>
<li><a href='#fKeepColumnAttributes'><p>fKeepColumnAttributes</p></a></li>
<li><a href='#fLloydTaylor'><p>Temperature dependence of soil respiration</p></a></li>
<li><a href='#fLoadAmeriflux22'><p>Read basic variables from Ameriflux standard (as of 2022) files</p></a></li>
<li><a href='#fLoadEuroFlux16'><p>fLoadEuroFlux16</p></a></li>
<li><a href='#fLoadFluxnet15'><p>Read a file in the format of Fluxnet 2015 release</p></a></li>
<li><a href='#fLoadTXTIntoDataframe'><p>Load text file with one header and one unit row into data frame</p></a></li>
<li><a href='#fSplitDateTime'><p>fSplitDateTime</p></a></li>
<li><a href='#fWriteDataframeToFile'><p>fWriteDataframeToFile</p></a></li>
<li><a href='#fWriteFrench23'><p>fWriteFrench23</p></a></li>
<li><a href='#get_day_boundaries'><p>get day boundaries</p></a></li>
<li><a href='#get_timestep_hours'><p>Get the timestep in fractional hours</p></a></li>
<li><a href='#getAmerifluxToBGC05VariableNameMapping'><p>getAmerifluxToBGC05VariableNameMapping</p></a></li>
<li><a href='#getBGC05ToAmerifluxVariableNameMapping'><p>getBGC05ToAmerifluxVariableNameMapping</p></a></li>
<li><a href='#getExamplePath'><p>getExamplePath</p></a></li>
<li><a href='#getFilledExampleDETha98Data'><p>getFilledExampleDETha98Data</p></a></li>
<li><a href='#getREddyProcExampleDir'><p>getREddyProcExampleDir</p></a></li>
<li><a href='#getTZone'><p>getTZone</p></a></li>
<li><a href='#globalDummyVars'><p>globalDummyVars</p></a></li>
<li><a href='#help_DateTimes'><p>help DateTimes</p></a></li>
<li><a href='#help_export'><p>help export</p></a></li>
<li><a href='#LightResponseCurveFitter'><p>LightResponseCurveFitter</p></a></li>
<li><a href='#LightResponseCurveFitter_computeCost'><p>LightResponseCurveFitter computeCost</p></a></li>
<li><a href='#LightResponseCurveFitter_computeLRCGradient'><p>LightResponseCurveFitter computeLRCGradient</p></a></li>
<li><a href='#LightResponseCurveFitter_fitLRC'><p>LightResponseCurveFitter fitLRC</p></a></li>
<li><a href='#LightResponseCurveFitter_getOptimizedParameterPositions'><p>LightResponseCurveFitter getOptimizedParameterPositions</p></a></li>
<li><a href='#LightResponseCurveFitter_getParameterInitials'><p>LightResponseCurveFitter getParameterInitials</p></a></li>
<li><a href='#LightResponseCurveFitter_getParameterNames'><p>LightResponseCurveFitter getParameterNames</p></a></li>
<li><a href='#LightResponseCurveFitter_getPriorLocation'><p>LightResponseCurveFitter getPriorLocation</p></a></li>
<li><a href='#LightResponseCurveFitter_getPriorScale'><p>LightResponseCurveFitter getPriorScale</p></a></li>
<li><a href='#LightResponseCurveFitter_isParameterInBounds'><p>LightResponseCurveFitter isParameterInBounds</p></a></li>
<li><a href='#LightResponseCurveFitter_optimLRC'><p>LightResponseCurveFitter optimLRC</p></a></li>
<li><a href='#LightResponseCurveFitter_optimLRCBounds'><p>LightResponseCurveFitter optimLRCBounds</p></a></li>
<li><a href='#LightResponseCurveFitter_optimLRCOnAdjustedPrior'><p>LightResponseCurveFitter optimLRCOnAdjustedPrior</p></a></li>
<li><a href='#LightResponseCurveFitter_predictGPP'><p>LightResponseCurveFitter predictGPP</p></a></li>
<li><a href='#LightResponseCurveFitter_predictLRC'><p>LightResponseCurveFitter predictLRC</p></a></li>
<li><a href='#LightResponseCurveFitter-class'><p>Class <code>"LightResponseCurveFitter"</code></p></a></li>
<li><a href='#LogisticSigmoidLRCFitter'><p>LogisticSigmoidLRCFitter</p></a></li>
<li><a href='#LogisticSigmoidLRCFitter_predictGPP'><p>LogisticSigmoidLRCFitter predictGPP</p></a></li>
<li><a href='#LogisticSigmoidLRCFitter-class'><p>Class <code>"LogisticSigmoidLRCFitter"</code></p></a></li>
<li><a href='#NonrectangularLRCFitter'><p>NonrectangularLRCFitter</p></a></li>
<li><a href='#NonrectangularLRCFitter_getParameterNames'><p>NonrectangularLRCFitter getParameterNames</p></a></li>
<li><a href='#NonrectangularLRCFitter_predictGPP'><p>NonrectangularLRCFitter predictGPP</p></a></li>
<li><a href='#NonrectangularLRCFitter-class'><p>Class <code>"NonrectangularLRCFitter"</code></p></a></li>
<li><a href='#partGLControl'><p>partGLControl</p></a></li>
<li><a href='#partGLControlLasslopCompatible'><p>partGLControlLasslopCompatible</p></a></li>
<li><a href='#partGLExtractStandardData'><p>partGLExtractStandardData</p></a></li>
<li><a href='#partitionNEEGL'><p>partitionNEEGL</p></a></li>
<li><a href='#POSIXctToBerkeleyJulianDate'><p>POSIXctToBerkeleyJulianDate</p></a></li>
<li><a href='#read_from_ameriflux22'><p>Extract basic variables from Ameriflux standard (as of 2022) data.frames</p></a></li>
<li><a href='#read_from_fluxnet15'><p>extract REddyProc input columns from data.frame in Fluxnet15 format</p></a></li>
<li><a href='#RectangularLRCFitter'><p>RectangularLRCFitter</p></a></li>
<li><a href='#RectangularLRCFitter_predictGPP'><p>RectangularLRCFitter predictGPP</p></a></li>
<li><a href='#RectangularLRCFitter-class'><p>Class <code>"RectangularLRCFitter"</code></p></a></li>
<li><a href='#RectangularLRCFitterCVersion'><p>RectangularLRCFitterCVersion</p></a></li>
<li><a href='#RectangularLRCFitterCVersion-class'><p>Class <code>"RectangularLRCFitterCVersion"</code></p></a></li>
<li><a href='#REddyProc_defaultunits'><p>Get the default units for given variables</p></a></li>
<li><a href='#renameVariablesInDataframe'><p>renameVariablesInDataframe</p></a></li>
<li><a href='#RHLightResponseCostC'><p>RHLightResponseCostC</p></a></li>
<li><a href='#sEddyProc'><p>sEddyProc</p></a></li>
<li><a href='#sEddyProc_initialize'><p>sEddyProc initialize</p></a></li>
<li><a href='#sEddyProc_sApplyUStarScen'><p>sEddyProc sApplyUStarScen</p></a></li>
<li><a href='#sEddyProc_sCalcPotRadiation'><p>sEddyProc sCalcPotRadiation</p></a></li>
<li><a href='#sEddyProc_sEstimateUstarScenarios'><p>sEddyProc sEstimateUstarScenarios</p></a></li>
<li><a href='#sEddyProc_sEstUstarThold'><p>sEddyProc$sEstUstarThreshold - Estimating ustar threshold</p></a></li>
<li><a href='#sEddyProc_sEstUstarThreshold'><p>sEddyProc$sEstUstarThreshold - Estimating ustar threshold</p></a></li>
<li><a href='#sEddyProc_sEstUstarThresholdDistribution'><p>sEddyProc sEstUstarThresholdDistribution</p></a></li>
<li><a href='#sEddyProc_sExportData'><p>sEddyProc sExportData</p></a></li>
<li><a href='#sEddyProc_sExportResults'><p>sEddyProc sExportResults</p></a></li>
<li><a href='#sEddyProc_sFillInit'><p>sEddyProc$sFillInit - Initialize gap filling</p></a></li>
<li><a href='#sEddyProc_sFillLUT'><p>sEddyProc sFillLUT</p></a></li>
<li><a href='#sEddyProc_sFillMDC'><p>sEddyProc sFillMDC</p></a></li>
<li><a href='#sEddyProc_sFillVPDFromDew'><p>Estimate VPD from daily minimum temperature</p></a></li>
<li><a href='#sEddyProc_sGetData'><p>sEddyProc sGetData</p></a></li>
<li><a href='#sEddyProc_sGetEstimatedUstarThresholdDistribution'><p>sEddyProc sGetEstimatedUstarThresholdDistribution</p></a></li>
<li><a href='#sEddyProc_sGetUstarScenarios'><p>sEddyProc sGetUstarScenarios</p></a></li>
<li><a href='#sEddyProc_sGetUstarSuffixes'><p>sEddyProc sGetUstarSuffixes</p></a></li>
<li><a href='#sEddyProc_sGLFluxPartition'><p>sEddyProc sGLFluxPartition</p></a></li>
<li><a href='#sEddyProc_sGLFluxPartitionUStarScens'><p>sEddyProc sGLFluxPartitionUStarScens</p></a></li>
<li><a href='#sEddyProc_sMDSGapFill'><p>sEddyProc sMDSGapFill</p></a></li>
<li><a href='#sEddyProc_sMDSGapFillAfterUstar'><p>sEddyProc sMDSGapFillAfterUstar</p></a></li>
<li><a href='#sEddyProc_sMDSGapFillAfterUStarDistr'><p>sEddyProc sMDSGapFillAfterUStarDistr</p></a></li>
<li><a href='#sEddyProc_sMDSGapFillUStarScens'><p>sEddyProc sMDSGapFillUStarScens</p></a></li>
<li><a href='#sEddyProc_sMRFluxPartition'><p>sEddyProc sMRFluxPartition</p></a></li>
<li><a href='#sEddyProc_sMRFluxPartitionUStarScens'><p>sEddyProc sMRFluxPartitionUStarScens</p></a></li>
<li><a href='#sEddyProc_sPlotDailySums'><p>sEddyProc$sPlotDailySums - Image with daily sums of each year</p></a></li>
<li><a href='#sEddyProc_sPlotDailySumsY'><p>sEddyProc sPlotDailySumsY</p></a></li>
<li><a href='#sEddyProc_sPlotDiurnalCycle'><p>sEddyProc sPlotDiurnalCycle</p></a></li>
<li><a href='#sEddyProc_sPlotDiurnalCycleM'><p>sEddyProc sPlotDiurnalCycleM</p></a></li>
<li><a href='#sEddyProc_sPlotFingerprint'><p>sEddyProc sPlotFingerprint</p></a></li>
<li><a href='#sEddyProc_sPlotFingerprintY'><p>sEddyProc sPlotFingerprintY</p></a></li>
<li><a href='#sEddyProc_sPlotHHFluxes'><p>sEddyProc sPlotHHFluxes</p></a></li>
<li><a href='#sEddyProc_sPlotHHFluxesY'><p>sEddyProc sPlotHHFluxesY</p></a></li>
<li><a href='#sEddyProc_sPlotNEEVersusUStarForSeason'><p>sEddyProc sPlotNEEVersusUStarForSeason</p></a></li>
<li><a href='#sEddyProc_sSetLocationInfo'><p>sEddyProc sSetLocationInfo</p></a></li>
<li><a href='#sEddyProc_sSetUstarScenarios'><p>sEddyProc sSetUstarScenarios</p></a></li>
<li><a href='#sEddyProc_sSetUStarSeasons'><p>sEddyProc sSetUStarSeasons</p></a></li>
<li><a href='#sEddyProc_sTKFluxPartition'><p>sEddyProc sTKFluxPartition</p></a></li>
<li><a href='#sEddyProc_sTKFluxPartitionUStarScens'><p>sEddyProc sTKFluxPartitionUStarScens</p></a></li>
<li><a href='#sEddyProc_update_ustarthreshold_columns'><p>Add columns reporting the uStar threshold for each scenario to sDATA</p></a></li>
<li><a href='#sEddyProc_useAnnualUStarThresholds'><p>sEddyProc useAnnualUStarThresholds</p></a></li>
<li><a href='#sEddyProc_useSeaonsalUStarThresholds'><p>sEddyProc useSeaonsalUStarThresholds</p></a></li>
<li><a href='#sEddyProc-class'><p>Class <code>"sEddyProc"</code></p></a></li>
<li><a href='#usControlUstarEst'><p>usControlUstarEst</p></a></li>
<li><a href='#usControlUstarSubsetting'><p>usControlUstarSubsetting</p></a></li>
<li><a href='#usCreateSeasonFactorMonth'><p>usCreateSeasonFactorMonth</p></a></li>
<li><a href='#usCreateSeasonFactorMonthWithinYear'><p>usCreateSeasonFactorMonthWithinYear</p></a></li>
<li><a href='#usCreateSeasonFactorYday'><p>usCreateSeasonFactorYday</p></a></li>
<li><a href='#usCreateSeasonFactorYdayYear'><p>usCreateSeasonFactorYdayYear</p></a></li>
<li><a href='#usEstUstarThreshold'><p>usEstUstarThreshold - Estimating ustar threshold</p></a></li>
<li><a href='#usEstUstarThresholdSingleFw1Binned'><p>usEstUstarThresholdSingleFw1Binned</p></a></li>
<li><a href='#usEstUstarThresholdSingleFw2Binned'><p>usEstUstarThresholdSingleFw2Binned</p></a></li>
<li><a href='#usGetAnnualSeasonUStarMap'><p>usGetAnnualSeasonUStarMap</p></a></li>
<li><a href='#usGetSeasonalSeasonUStarMap'><p>usGetSeasonalSeasonUStarMap</p></a></li>
<li><a href='#usGetYearOfSeason'><p>usGetYearOfSeason</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Post Processing of (Half-)Hourly Eddy-Covariance Measurements</td>
</tr>
<tr>
<td>Description:</td>
<td>Standard and extensible Eddy-Covariance data post-processing 
  (Wutzler et al. (2018) &lt;<a href="https://doi.org/10.5194%2Fbg-15-5015-2018">doi:10.5194/bg-15-5015-2018</a>&gt;)
  includes  
  uStar-filtering, gap-filling, and flux-partitioning.
  The Eddy-Covariance (EC)  micrometeorological technique quantifies continuous 
  exchange fluxes of gases, energy, and momentum between an ecosystem and the atmosphere.
  It is important for understanding ecosystem dynamics and upscaling exchange fluxes.
  (Aubinet et al. (2012) &lt;<a href="https://doi.org/10.1007%2F978-94-007-2351-1">doi:10.1007/978-94-007-2351-1</a>&gt;).
  This package inputs pre-processed (half-)hourly data and supports further processing. 
  First, a quality-check and filtering is performed based on the relationship between 
  measured flux and friction
  velocity (uStar) to discard biased data 
  (Papale et al. (2006) &lt;<a href="https://doi.org/10.5194%2Fbg-3-571-2006">doi:10.5194/bg-3-571-2006</a>&gt;).
  Second, gaps in the data are filled based on information from environmental conditions
  (Reichstein et al. (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1365-2486.2005.001002.x">doi:10.1111/j.1365-2486.2005.001002.x</a>&gt;).
  Third, the net flux of carbon dioxide is partitioned
  into its gross fluxes in and out of the ecosystem by night-time 
  based and day-time based approaches
  (Lasslop et al. (2010) &lt;<a href="https://doi.org/10.1111%2Fj.1365-2486.2009.02041.x">doi:10.1111/j.1365-2486.2009.02041.x</a>&gt;).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.bgc-jena.mpg.de/bgi/index.php/Services/REddyProcWeb">https://www.bgc-jena.mpg.de/bgi/index.php/Services/REddyProcWeb</a>,
<a href="https://github.com/bgctw/REddyProc">https://github.com/bgctw/REddyProc</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, dplyr, purrr, rlang, readr, tibble, magrittr, solartime,
bigleaf (&ge; 0.7), mlegp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, minpack.lm, segmented, knitr, rmarkdown, lognorm,
ggplot2, tidyr, markdown</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CheckVal.R' 'DataFunctions.R' 'aEddy.R' 'EddyGapfilling.R'
'EddyPartitioning.R' 'EddyPlotting.R'
'EddyUStarFilterChangePointDetection.R' 'EddyUStarFilterDP.R'
'Example.R' 'FileHandling.R' 'FileHandlingFormats.R'
'GeoFunctions.R' 'LRC_base.R' 'LRC_logisticSigmoid.R'
'LRC_nonrectangular.R' 'LRC_rectangular.R'
'PartitioningLasslop10.R' 'PartitioningLasslop10Nighttime.R'
'RcppExports.R' 'estimate_vpd_from_dew.R' 'imports.R'
'logitnorm.R' 'variableNames.R' 'zzzDebugCode.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-25 14:41:24 UTC; twutz</td>
</tr>
<tr>
<td>Author:</td>
<td>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany
    [cph],
  Thomas Wutzler [aut, cre],
  Markus Reichstein [aut],
  Antje Maria Moffat [aut, trl],
  Olaf Menzer [ctb],
  Mirco Migliavacca [aut],
  Kerstin Sickel [ctb, trl],
  Ladislav &lt;U+0160&gt;igut [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-25 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='REddyProc-package'>Post Processing of (Half-)Hourly Eddy-Covariance Measurements</h2><span id='topic+REddyProc-package'></span><span id='topic+REddyProc'></span>

<h3>Description</h3>

<p>Standard and extensible Eddy-Covariance data post-processing including
uStar-filtering, gap-filling, and flux-partitioning
(Wutzler et al. (2018) &lt;doi:10.5194/bg-15-5015-2018&gt;).
</p>
<p>The Eddy-Covariance (EC)  micrometeorological technique quantifies continuous
exchange fluxes of gases, energy, and momentum between an ecosystem and the atmosphere.
It is important for understanding ecosystem dynamics and upscaling exchange fluxes.
(Aubinet et al. (2012) &lt;doi:10.1007/978-94-007-2351-1&gt;).
</p>
<p>This package inputs pre-processed (half-)hourly data and supports further processing.
First, a quality-check and filtering is performed based on the relationship between
measured flux and friction
velocity (uStar) to discard biased data
(Papale et al. (2006) &lt;doi:10.5194/bg-3-571-2006&gt;).
</p>
<p>Second, gaps in the data are filled based on information from environmental conditions
(Reichstein et al. (2005) &lt;doi:10.1111/j.1365-2486.2005.001002.x&gt;).
</p>
<p>Third, the net flux of carbon dioxide is partitioned
into its gross fluxes in and out of the ecosystem by night-time
based and day-time based approaches
(Lasslop et al. (2010) &lt;doi:10.1111/j.1365-2486.2009.02041.x&gt;).
</p>
<p>A general description and an online tool based on this package can be found
here: <a href="https://www.bgc-jena.mpg.de/bgi/index.php/Services/REddyProcWeb">https://www.bgc-jena.mpg.de/bgi/index.php/Services/REddyProcWeb</a>.
</p>


<h3>Details</h3>

<p>A <b>detailed example</b> of the processing can be found in the
<a href="../doc/useCase.html">useCase vignette</a>.
</p>
<p>A first overview of the REddyProc functions:
</p>
<p>These functions help with the preparation of your data for the analysis:
</p>

<ul>
<li><p> Loading text files into dataframes: <code><a href="#topic+fLoadTXTIntoDataframe">fLoadTXTIntoDataframe</a></code> 
</p>
</li>
<li><p> Preparing a proper time stamp: <code><a href="#topic+help_DateTimes">help_DateTimes</a></code> 
</p>
</li>
<li><p> Calculating latent variables, e.g. VPD: <code><a href="#topic+fCalcVPDfromRHandTair">fCalcVPDfromRHandTair</a></code> 
</p>
</li></ul>

<p>Then the data can be processed with the <code><a href="#topic+sEddyProc-class">sEddyProc-class</a></code> R5 reference class:
</p>

<ul>
<li><p> Initializing the R5 reference class: <code><a href="#topic+sEddyProc_initialize">sEddyProc_initialize</a></code> 
</p>
</li>
<li><p> Estimating the turbulence criterion, Ustar threshold, for omitting data
from periods of low turbulence:
Functions <code><a href="#topic+sEddyProc_sEstUstarThreshold">sEddyProc_sEstUstarThreshold</a></code> and
<code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code> .
</p>
</li>
<li><p> Gap filling: <code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code> and
<code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code>.

</p>
</li>
<li><p> Flux partitioning based on Night-Time: <code><a href="#topic+sEddyProc_sMRFluxPartition">sEddyProc_sMRFluxPartition</a></code> 
</p>
</li>
<li><p> Flux partitioning based on Day-Time: <code><a href="#topic+sEddyProc_sGLFluxPartition">sEddyProc_sGLFluxPartition</a></code> 
</p>
</li></ul>

<p>Processing across different scenarios of u* threshold estimate is supported by
</p>

<ul>
<li><p> Estimating the turbulence criterion, Ustar threshold, for omitting data
from periods of low turbulence:
<code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code> and associated
</p>

<ul>
<li><p> query the thresholds to be used <code><a href="#topic+sEddyProc_sGetUstarScenarios">sEddyProc_sGetUstarScenarios</a></code>
</p>
</li>
<li><p> set the thresholds to be used <code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code>
</p>
</li>
<li><p> query the estimated thresholds all different aggregation levels
<code><a href="#topic+sEddyProc_sGetEstimatedUstarThresholdDistribution">sEddyProc_sGetEstimatedUstarThresholdDistribution</a></code>
</p>
</li></ul>
 
</li>
<li><p> Gap-Filling:
<code><a href="#topic+sEddyProc_sMDSGapFillUStarScens">sEddyProc_sMDSGapFillUStarScens</a></code> 
</p>
</li>
<li><p> Flux partitioning based on Night-Time (Reichstein 2005):
<code><a href="#topic+sEddyProc_sMRFluxPartitionUStarScens">sEddyProc_sMRFluxPartitionUStarScens</a></code> 
</p>
</li>
<li><p> Flux partitioning based on Day-Time (Lasslop 2010):
<code><a href="#topic+sEddyProc_sGLFluxPartitionUStarScens">sEddyProc_sGLFluxPartitionUStarScens</a></code> 
</p>
</li>
<li><p> Flux partitioning based on modified Day-Time (Keenan 2019):
<code><a href="#topic+sEddyProc_sTKFluxPartitionUStarScens">sEddyProc_sTKFluxPartitionUStarScens</a></code> 
</p>
</li></ul>

<p>Before or after processing, the data can be plotted:
</p>

<ul>
<li><p> Fingerprint: <code><a href="#topic+sEddyProc_sPlotFingerprint">sEddyProc_sPlotFingerprint</a></code> 
</p>
</li>
<li><p> Half-hourly fluxes and their daily means: <code><a href="#topic+sEddyProc_sPlotHHFluxes">sEddyProc_sPlotHHFluxes</a></code> 
</p>
</li>
<li><p> Daily sums (and their uncertainties): <code><a href="#topic+sEddyProc_sPlotDailySums">sEddyProc_sPlotDailySums</a></code> 
</p>
</li>
<li><p> Diurnal cycle: <code><a href="#topic+sEddyProc_sPlotDiurnalCycle">sEddyProc_sPlotDiurnalCycle</a></code> 
</p>
</li></ul>

<p>For exporting data and results see <code><a href="#topic+help_export">help_export</a></code>.
</p>
<p>A <b>complete list</b> of REddyProc functions be viewed by clicking on the
<b>Index</b> link at the bottom of this help page.
</p>
<p>Also have a look at the <a href="../doc/index.html">package vignettes</a>.
</p>


<h3>Author(s)</h3>

<p> Department for Biogeochemical Integration at MPI-BGC, Jena, Germany </p>


<h3>References</h3>

<p> Reichstein M, Falge E, Baldocchi D et al. (2005)
On the separation of net ecosystem exchange
into assimilation and ecosystem respiration: review and improved algorithm.
Global Change Biology, 11, 1424-1439. </p>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Pipe operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='BerkeleyJulianDateToPOSIXct'>BerkeleyJulianDateToPOSIXct</h2><span id='topic+BerkeleyJulianDateToPOSIXct'></span>

<h3>Description</h3>

<p>convert JulianDate format used in Berkeley release to POSIXct</p>


<h3>Usage</h3>

<pre><code class='language-R'>BerkeleyJulianDateToPOSIXct(julianDate, tz = "UTC", 
    ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BerkeleyJulianDateToPOSIXct_+3A_juliandate">julianDate</code></td>
<td>
<p>numeric vector representing times (see details for format)</p>
</td></tr>
<tr><td><code id="BerkeleyJulianDateToPOSIXct_+3A_tz">tz</code></td>
<td>
<p>time zone used to represent the dates</p>
</td></tr>
<tr><td><code id="BerkeleyJulianDateToPOSIXct_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="base.html#topic+strptime">strptime</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Berkeley-Release of the Fluxnet data, the time is stored as an number
with base10-digits representing YYYYMMddhhmm</p>


<h3>Author(s)</h3>

<p>TW,
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+POSIXctToBerkeleyJulianDate">POSIXctToBerkeleyJulianDate</a></code>
<code><a href="#topic+help_DateTimes">help_DateTimes</a></code></p>

<hr>
<h2 id='DEGebExample'>Eddy covariance data from Gebesee crop site, Germany</h2><span id='topic+DEGebExample'></span>

<h3>Description</h3>

<p>The data frame 'DEGebExample' contains half-hourly eddy covariance measurements from Gebesee of the years 2004 to 2006.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DEGebExample)</code></pre>


<h3>Format</h3>

<p>For each column, the attributes 'varnames' for the variable names and 'units' for the variable units are provided. <br />
</p>

<dl>
<dt>Time stamp</dt><dd><p> DateTime: POSIXct-time of the end of the half-hour period, Use as.POSIXlt(DateTime)$year to get hour, day of year, ...</p>
</dd>
<dt>Flux measurements</dt><dd><p>NEE</p>
</dd>
<dt>Meteo measurements</dt><dd><p>Rg, Tair, rH, VPD, Ustar</p>
</dd>
</dl>

<p>For processing of the example data see <code>vignette("DEGebExample")</code>.
</p>


<h3>Details</h3>

<p>DISCLAIMER: This example dataset should only be used for test purposes of the REddyProc R package.
For other uses, the data is openly available through the European Fluxes Database
(http://www.europe-fluxdata.eu/home/site-details?id=3)
and upon registration the current version can be downloaded there.
</p>


<h3>Source</h3>

<p>The data was downloaded from <code>http://www.europe-fluxdata.eu</code> at date 2016-01-25.</p>

<hr>
<h2 id='estimate_vpd_from_dew'>Estimate VPD from assuming dewpoint at daily minimum temperature</h2><span id='topic+estimate_vpd_from_dew'></span>

<h3>Description</h3>

<p>VPD is required for daytime NEE flux partitioning. Hence, it is necessary to
estimate VPD also for long gaps in data.
With two assumptions, VPD can be estimated from temperature
1). The change of water mass in air is negligible during the day.
VPD is the difference of actual vapour pressure to  saturation vapour pressure.
2.) At morning minimum temperature, vapour pressure is at minimum
in many cases at saturation.
Hence  </p>
<p style="text-align: center;"><code class="reqn">VPD = Esat(Tair) - E \approx Esat(Tair) - Esat_{daymin} \approx
Esat(Tair) - Esat(Tair_{min})</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>estimate_vpd_from_dew(df, pNonMissing = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_vpd_from_dew_+3A_df">df</code></td>
<td>
<p>data.frame with columns DateTime, VPD, Tair, and Tair_f</p>
</td></tr>
<tr><td><code id="estimate_vpd_from_dew_+3A_pnonmissing">pNonMissing</code></td>
<td>
<p>numeric scalar of the necessary fraction of finite
VPD and Tair. If fraction is lower then a warning is thrown.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since sometimes Esat_daymin is lower than Esat(Tair_min)
the estimated VPDfromDew is underestimated. This function applies a
linear model of the existing VPD and estimated VPD to correct for this bias:
VPD ~ 0 + VPDfromDew * Tair_f * hourOfDay *  TminOftheDay * TRangeDay
</p>


<h3>Value</h3>

<p>numeric vector of length(nrow(data)) of estimated VPD
</p>

<hr>
<h2 id='Example_DETha98'>Eddy covariance data from Tharandt, Germany</h2><span id='topic+Example_DETha98'></span>

<h3>Description</h3>

<p>The data frame 'EddyData.F' contains half-hourly eddy covariance measurements from Tharandt of the year 1998.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Example_DETha98)</code></pre>


<h3>Format</h3>

<p>For each column, the attributes 'varnames' for the variable names and 'units' for the variable units are provided. <br />
</p>

<dl>
<dt>Time stamp</dt><dd><p>Year - Year provided with century 1998. <br /> DoY - Day of year provided as 1 to 365 (or 1 to 366 in leap years). <br /> Hour - Hour provided as decimal 0.0 to 23.5.</p>
</dd>
<dt>Flux measurements</dt><dd><p>NEE, LE, H</p>
</dd>
<dt>Meteo measurements</dt><dd><p>Rg, Tair, Tsoil, rH, VPD, Ustar</p>
</dd>
</dl>

<p>For processing of the example data see <a href="../doc/useCase.html">useCase vignette</a>.
</p>


<h3>Source</h3>

<p>The data originates from the CARBODATA CD.</p>

<hr>
<h2 id='extract_FN15'>extract processing results with columns corresponding to Fluxnet15 release</h2><span id='topic+extract_FN15'></span>

<h3>Description</h3>

<p>extract processing results with columns corresponding to Fluxnet15 release
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_FN15(
  EProc = .self,
  is_export_nonfilled = TRUE,
  keep_other_cols = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_FN15_+3A_eproc">EProc</code></td>
<td>
<p>sEddyProc class with uncertainty also in meteo variables and
both nighttime and daytime partitioning columns present</p>
</td></tr>
<tr><td><code id="extract_FN15_+3A_is_export_nonfilled">is_export_nonfilled</code></td>
<td>
<p>set to FALSE to not export columns before gapfilling</p>
</td></tr>
<tr><td><code id="extract_FN15_+3A_keep_other_cols">keep_other_cols</code></td>
<td>
<p>set to TRUE to report also other columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with columns names of Fluxnet15. Timestamps are
in ISO string format <code><a href="#topic+POSIXctToBerkeleyJulianDate">POSIXctToBerkeleyJulianDate</a></code>
</p>

<hr>
<h2 id='fCalcAVPfromVMFandPress'>fCalcAVPfromVMFandPress</h2><span id='topic+fCalcAVPfromVMFandPress'></span>

<h3>Description</h3>

<p>Calculate AVP from VMF and Press</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcAVPfromVMFandPress(VMF = VMF.V.n, Press = Press.V.n, 
    VMF.V.n, Press.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcAVPfromVMFandPress_+3A_vmf">VMF</code></td>
<td>
<p>Vapor mole fraction (VMF, mol / mol)</p>
</td></tr>
<tr><td><code id="fCalcAVPfromVMFandPress_+3A_press">Press</code></td>
<td>
<p>Atmospheric pressure (Press, hPa)</p>
</td></tr>
<tr><td><code id="fCalcAVPfromVMFandPress_+3A_vmf.v.n">VMF.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcAVPfromVMFandPress_+3A_press.v.n">Press.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of actual vapor pressure (AVP, hPa (mbar))</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCalcETfromLE'>fCalcETfromLE</h2><span id='topic+fCalcETfromLE'></span>

<h3>Description</h3>

<p>Calculate ET from LE and Tair</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcETfromLE(LE = LE.V.n, Tair = Tair.V.n, 
    LE.V.n, Tair.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcETfromLE_+3A_le">LE</code></td>
<td>
<p>Data vector of latent heat (LE, W m-2)</p>
</td></tr>
<tr><td><code id="fCalcETfromLE_+3A_tair">Tair</code></td>
<td>
<p>Data vector of air temperature (Tair, degC)</p>
</td></tr>
<tr><td><code id="fCalcETfromLE_+3A_le.v.n">LE.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcETfromLE_+3A_tair.v.n">Tair.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of evapotranspiration (ET, mmol H20 m-2 s-1)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCalcExtRadiation'>fCalcExtRadiation</h2><span id='topic+fCalcExtRadiation'></span>

<h3>Description</h3>

<p>Calculate the extraterrestrial solar radiation with the
eccentricity correction</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcExtRadiation(DoY = DoY.V.n, DoY.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcExtRadiation_+3A_doy">DoY</code></td>
<td>
<p>Data vector with day of year (DoY)</p>
</td></tr>
<tr><td><code id="fCalcExtRadiation_+3A_doy.v.n">DoY.V.n</code></td>
<td>
<p>deprecated, use DoY</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of extraterrestrial radiation (ExtRad, W_m-2)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCalcPotRadiation'>fCalcPotRadiation</h2><span id='topic+fCalcPotRadiation'></span>

<h3>Description</h3>

<p>Calculate the potential radiation</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcPotRadiation(DoY = DoY.V.n, Hour = Hour.V.n, 
    LatDeg = Lat_deg.n, LongDeg = Long_deg.n, 
    TimeZone = TimeZone_h.n, useSolartime = TRUE, 
    DoY.V.n, Hour.V.n, Lat_deg.n, Long_deg.n, 
    TimeZone_h.n, useSolartime.b = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcPotRadiation_+3A_doy">DoY</code></td>
<td>
<p>Data vector with day of year (DoY), same length as Hour or length 1</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_hour">Hour</code></td>
<td>
<p>Data vector with time as decimal hour of local time zone</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_latdeg">LatDeg</code></td>
<td>
<p>Latitude in (decimal) degrees</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_longdeg">LongDeg</code></td>
<td>
<p>Longitude in (decimal) degrees</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_timezone">TimeZone</code></td>
<td>
<p>Time zone (in hours)</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_usesolartime">useSolartime</code></td>
<td>
<p>by default corrects hour (given in local winter time)
for latitude to solar time
(where noon is exactly at 12:00). Set this to FALSE to directly use local winter time</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_doy.v.n">DoY.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_hour.v.n">Hour.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_lat_deg.n">Lat_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_long_deg.n">Long_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_timezone_h.n">TimeZone_h.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcPotRadiation_+3A_usesolartime.b">useSolartime.b</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of potential radiation (PotRad, W_m-2)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>Examples</h3>

<pre><code class='language-R'>hour &lt;- seq(8, 16, by = 0.1)
potRadSolar &lt;- fCalcPotRadiation(160, hour, 39.94, -5.77, TimeZone = +1)
potRadLocal &lt;- fCalcPotRadiation(160, hour, 39.94, -5.77, TimeZone = +1
	  , useSolartime = FALSE)
plot(potRadSolar ~ hour, type = 'l')
abline(v = 13, lty = "dotted")
lines(potRadLocal ~  hour, col = "blue")
abline(v = 12, col = "blue", lty = "dotted")
legend("bottomright", legend = c("solar time", "local winter time")
	, col = c("black", "blue"), inset = 0.05, lty = 1)
</code></pre>

<hr>
<h2 id='fCalcRHfromAVPandTair'>fCalcRHfromAVPandTair</h2><span id='topic+fCalcRHfromAVPandTair'></span>

<h3>Description</h3>

<p>Calculate relative humidity from actual vapour pressure and air temperature</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcRHfromAVPandTair(AVP = AVP.V.n, Tair = Tair.V.n, 
    AVP.V.n, Tair.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcRHfromAVPandTair_+3A_avp">AVP</code></td>
<td>
<p>Data vector of actual vapour pressure (AVP, hPa (mbar))</p>
</td></tr>
<tr><td><code id="fCalcRHfromAVPandTair_+3A_tair">Tair</code></td>
<td>
<p>Data vector of air temperature (Tair, degC)</p>
</td></tr>
<tr><td><code id="fCalcRHfromAVPandTair_+3A_avp.v.n">AVP.V.n</code></td>
<td>
<p>Data vector of actual vapour pressure (AVP, hPa (mbar))</p>
</td></tr>
<tr><td><code id="fCalcRHfromAVPandTair_+3A_tair.v.n">Tair.V.n</code></td>
<td>
<p>Data vector of air temperature (Tair, degC)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of relative humidity (rH, %)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCalcSVPfromTair'>fCalcSVPfromTair</h2><span id='topic+fCalcSVPfromTair'></span>

<h3>Description</h3>

<p>Calculate SVP (of water) from Tair</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcSVPfromTair(Tair = Tair.V.n, Tair.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcSVPfromTair_+3A_tair">Tair</code></td>
<td>
<p>Data vector of air temperature (Tair, degC)</p>
</td></tr>
<tr><td><code id="fCalcSVPfromTair_+3A_tair.v.n">Tair.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of saturation vapor pressure (SVP, hPa (mbar))</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCalcVPDfromRHandTair'>fCalcVPDfromRHandTair</h2><span id='topic+fCalcVPDfromRHandTair'></span>

<h3>Description</h3>

<p>Calculate VPD from rH and Tair</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCalcVPDfromRHandTair(rH = RH.V.n, Tair = Tair.V.n, 
    RH.V.n, Tair.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCalcVPDfromRHandTair_+3A_rh">rH</code></td>
<td>
<p>Data vector of relative humidity (rH, %)</p>
</td></tr>
<tr><td><code id="fCalcVPDfromRHandTair_+3A_tair">Tair</code></td>
<td>
<p>Data vector of air temperature (Tair, degC)</p>
</td></tr>
<tr><td><code id="fCalcVPDfromRHandTair_+3A_rh.v.n">RH.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCalcVPDfromRHandTair_+3A_tair.v.n">Tair.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of vapour pressure deficit (VPD, hPa (mbar))</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fCheckHHTimeSeries'>fCheckHHTimeSeries</h2><span id='topic+fCheckHHTimeSeries'></span>

<h3>Description</h3>

<p>Check half-hourly time series data</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCheckHHTimeSeries(Time = Time.V.p, DTS = DTS.n, 
    CallFunction = if (!missing(CallFunction.s)) CallFunction.s else "", 
    Time.V.p, DTS.n, CallFunction.s)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCheckHHTimeSeries_+3A_time">Time</code></td>
<td>
<p>Time vector in POSIX format</p>
</td></tr>
<tr><td><code id="fCheckHHTimeSeries_+3A_dts">DTS</code></td>
<td>
<p>Number of daily time steps (24 or 48)</p>
</td></tr>
<tr><td><code id="fCheckHHTimeSeries_+3A_callfunction">CallFunction</code></td>
<td>
<p>Name
of function called from</p>
</td></tr>
<tr><td><code id="fCheckHHTimeSeries_+3A_time.v.p">Time.V.p</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCheckHHTimeSeries_+3A_dts.n">DTS.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fCheckHHTimeSeries_+3A_callfunction.s">CallFunction.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of steps per day can be 24 (hourly) or 48 (half-hourly).
</p>
<p>The time stamp needs to be provided in POSIX time format,
</p>
<p>equidistant half-hours,
</p>
<p>and stamped on the half hour.
</p>
<p>The sEddyProc procedures require at least three months of data.
</p>
<p>Full days of data are preferred: the total amount of data rows should be
a multiple of the daily time step, and
</p>
<p>in accordance with FLUXNET standards, the dataset is spanning from the
end of the first (half-)hour (0:30 or 1:00, respectively) and
to midnight (0:00).</p>


<h3>Value</h3>

<p>Function stops on errors.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fConvertCtoK'>fConvertCtoK</h2><span id='topic+fConvertCtoK'></span>

<h3>Description</h3>

<p>Convert degree Celsius to degree Kelvin</p>


<h3>Usage</h3>

<pre><code class='language-R'>fConvertCtoK(Celsius = Celsius.V.n, Celsius.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fConvertCtoK_+3A_celsius">Celsius</code></td>
<td>
<p>Data vector in Celsius (degC)</p>
</td></tr>
<tr><td><code id="fConvertCtoK_+3A_celsius.v.n">Celsius.V.n</code></td>
<td>
<p>deprecated way of specifying Celsius</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector in temperature Kelvin (Temp_K, degK)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fConvertGlobalToVisible'>fConvertGlobalToVisible</h2><span id='topic+fConvertGlobalToVisible'></span>

<h3>Description</h3>

<p>Partition global (solar) radiation into only visible (the rest is UV and infrared)</p>


<h3>Usage</h3>

<pre><code class='language-R'>fConvertGlobalToVisible(Global = Global.V.n, 
    Global.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fConvertGlobalToVisible_+3A_global">Global</code></td>
<td>
<p>Data vector of global radiation (W m-2)</p>
</td></tr>
<tr><td><code id="fConvertGlobalToVisible_+3A_global.v.n">Global.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of visible part of solar radiation (VisRad, W m-2)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fConvertKtoC'>fConvertKtoC</h2><span id='topic+fConvertKtoC'></span>

<h3>Description</h3>

<p>Convert degree Kelvin to degree Celsius</p>


<h3>Usage</h3>

<pre><code class='language-R'>fConvertKtoC(Kelvin = Kelvin.V.n, Kelvin.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fConvertKtoC_+3A_kelvin">Kelvin</code></td>
<td>
<p>Data vector in Kelvin (degK)</p>
</td></tr>
<tr><td><code id="fConvertKtoC_+3A_kelvin.v.n">Kelvin.V.n</code></td>
<td>
<p>deprecated, use Kelvin instead</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector in temperature Celsius (Temp_C, degC)</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fConvertTimeToPosix'>fConvertTimeToPosix</h2><span id='topic+fConvertTimeToPosix'></span>

<h3>Description</h3>

<p>Convert different time formats to POSIX</p>


<h3>Usage</h3>

<pre><code class='language-R'>fConvertTimeToPosix(Data.F, TFormat = TFormat.s, 
    Year = if (!missing(Year.s)) Year.s else "none", 
    Month = if (!missing(Month.s)) Month.s else "none", 
    Day = if (!missing(Day.s)) Day.s else "none", 
    Hour = if (!missing(Hour.s)) Hour.s else "none", 
    Min = if (!missing(Min.s)) Min.s else "none", 
    TName = if (!missing(TName.s)) TName.s else "DateTime", 
    TFormat.s, Year.s, Month.s, Day.s, Hour.s, 
    Min.s, TName.s, tz = "GMT")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fConvertTimeToPosix_+3A_data.f">Data.F</code></td>
<td>
<p>Data frame with time columns to be converted</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_tformat">TFormat</code></td>
<td>
<p>Abbreviation for implemented time formats,
see details</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_year">Year</code></td>
<td>
<p>Column name of year</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_month">Month</code></td>
<td>
<p>Column name of month</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_day">Day</code></td>
<td>
<p>Column name of day</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_hour">Hour</code></td>
<td>
<p>Column name of hour</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_min">Min</code></td>
<td>
<p>Column name of min</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_tname">TName</code></td>
<td>
<p>Column name of new column</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_tformat.s">TFormat.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_year.s">Year.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_month.s">Month.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_day.s">Day.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_hour.s">Hour.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_min.s">Min.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_tname.s">TName.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fConvertTimeToPosix_+3A_tz">tz</code></td>
<td>
<p>timezone used to store the data. Advised to keep
GMT to avoid daytime shifting issues</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The different time formats are converted to POSIX (GMT) and a 'TimeDate'
column is prefixed to the data frame
</p>
<p>Implemented time formats:
</p>

<dl>
<dt>YDH</dt><dd><p> year, day of year, hour in decimal
(e.g. 1998, 1, 10.5).
The day (of year) format is (1-365 or 1-366 in leap years).
The hour format is decimal time (0.0-23.5).
</p>
</dd>
<dt>YMDH</dt><dd><p>year, month, day of month, hour in decimal
(e.g. 1998, 1, 1, 10.5)
The month format is (1-12)
The day (of month) format is (1-31).
</p>
</dd>
<dt>YMDHM</dt><dd><p>year, month, day of month, integer hour, minute
(e.g. 1998, 1, 1, 10, 30)
The hour format is (0-23)
The minute format is (0-59)
</p>
</dd>
</dl>



<h3>Value</h3>

<p>Data frame with prefixed POSIX time column.</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_DateTimes">help_DateTimes</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># See unit test in test_fConvertTimeToPosix for example
</code></pre>

<hr>
<h2 id='fConvertVisibleWm2toPhotons'>fConvertVisibleWm2toPhotons</h2><span id='topic+fConvertVisibleWm2toPhotons'></span>

<h3>Description</h3>

<p>Convert units of visible radiation from irradiance to photons flux</p>


<h3>Usage</h3>

<pre><code class='language-R'>fConvertVisibleWm2toPhotons(Wm2 = Wm2.V.n, 
    Wm2.V.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fConvertVisibleWm2toPhotons_+3A_wm2">Wm2</code></td>
<td>
<p>Data vector in units of irradiance (W m-2)</p>
</td></tr>
<tr><td><code id="fConvertVisibleWm2toPhotons_+3A_wm2.v.n">Wm2.V.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector in units of photons flux (PPFD, umol photons m-2 s-1)</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='filter_entire_days'>filter entire days</h2><span id='topic+filter_entire_days'></span>

<h3>Description</h3>

<p>Omit records before the start of the first full day and the end of the last full day</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_entire_days(df, col_time = "DateTime")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_entire_days_+3A_df">df</code></td>
<td>
<p>data.frame with column col_time of equidistant</p>
</td></tr>
<tr><td><code id="filter_entire_days_+3A_col_time">col_time</code></td>
<td>
<p>Name of the column with the equidistant timesteps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Column attributes such as 'units' are kept.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_DateTimes">help_DateTimes</a></code>, <code><a href="#topic+get_day_boundaries">get_day_boundaries</a></code>
<code><a href="#topic+fKeepColumnAttributes">fKeepColumnAttributes</a></code></p>

<hr>
<h2 id='filter_years_eop'>filter years eop</h2><span id='topic+filter_years_eop'></span>

<h3>Description</h3>

<p>Subset data.frame to given years respecting the end-of-period convention</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_years_eop(df, years, col_time = "DateTime")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_years_eop_+3A_df">df</code></td>
<td>
<p>data.frame with column col_time of equidistant</p>
</td></tr>
<tr><td><code id="filter_years_eop_+3A_years">years</code></td>
<td>
<p>integer vector of years of the form <code>c(1998, 1998)</code></p>
</td></tr>
<tr><td><code id="filter_years_eop_+3A_col_time">col_time</code></td>
<td>
<p>Name of the column with the equidistant timesteps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The end-of-period (usually end-of-half-hour) convention
in the Fluxnet community results in midnight
and new-year being the last record of the previous day or the year respectively,
although POSIXt function will report the next day or year respectively.
</p>
<p>Column attributes such as 'units' are kept.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_DateTimes">help_DateTimes</a></code>, <code><a href="#topic+filter_entire_days">filter_entire_days</a></code>
<code><a href="#topic+fKeepColumnAttributes">fKeepColumnAttributes</a></code></p>

<hr>
<h2 id='filterLongRuns'>filterLongRuns</h2><span id='topic+filterLongRuns'></span>

<h3>Description</h3>

<p>replace runs, i.e sequences of numerically equal values, by NA</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterLongRuns(data, colNames, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterLongRuns_+3A_data">data</code></td>
<td>
<p>data.frame with columns to filter</p>
</td></tr>
<tr><td><code id="filterLongRuns_+3A_colnames">colNames</code></td>
<td>
<p>string vector of names indicating which columns to filter</p>
</td></tr>
<tr><td><code id="filterLongRuns_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+filterLongRunsInVector">filterLongRunsInVector</a></code>
such as <code>minNRunLength</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Longer runs, i.e. sequences of numerically identical values,
in a series of measurements hint to
problems during a noisy measurement, e.g. by sensor malfunction due to
freezing.
This function, replaces such values in such runs to indicate missing values.</p>


<h3>Value</h3>

<p>data.frame <code>ans</code> with long runs in specified columns replaced by NA</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='filterLongRunsInVector'>filterLongRunsInVector</h2><span id='topic+filterLongRunsInVector'></span>

<h3>Description</h3>

<p>replace runs of numerically equal values by NA</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterLongRunsInVector(x, minNRunLength = 8, 
    replacement = NA, na.rm = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filterLongRunsInVector_+3A_x">x</code></td>
<td>
<p>vector in which to replace long runs</p>
</td></tr>
<tr><td><code id="filterLongRunsInVector_+3A_minnrunlength">minNRunLength</code></td>
<td>
<p>minimum length of a run to replace.
Defaults to 4 hours in half-hourly spaced data.</p>
</td></tr>
<tr><td><code id="filterLongRunsInVector_+3A_replacement">replacement</code></td>
<td>
<p>value replacing the original values in long run</p>
</td></tr>
<tr><td><code id="filterLongRunsInVector_+3A_na.rm">na.rm</code></td>
<td>
<p>set to FALSE if NA values interrupt runs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector <code>x</code> with long runs replaced by NA</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fKeepColumnAttributes'>fKeepColumnAttributes</h2><span id='topic+fKeepColumnAttributes'></span>

<h3>Description</h3>

<p>Copy column attributes after processing a data.frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>fKeepColumnAttributes(x, FUN, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fKeepColumnAttributes_+3A_x">x</code></td>
<td>
<p>data.frame to be processed</p>
</td></tr>
<tr><td><code id="fKeepColumnAttributes_+3A_fun">FUN</code></td>
<td>
<p><code>function(x::data.frame, ...) -&gt; data.frame</code> to be applied</p>
</td></tr>
<tr><td><code id="fKeepColumnAttributes_+3A_...">...</code></td>
<td>
<p>additional arguments to FUN</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns of the resulting data.frame that match a column name in x
will get the same attributes as in x.</p>


<h3>Value</h3>

<p>result of <code>function(x, ...)</code> with column attributes preserved</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='fLloydTaylor'>Temperature dependence of soil respiration</h2><span id='topic+fLloydTaylor'></span>

<h3>Description</h3>

<p>Temperature dependence of soil respiration after Equation 11 in Lloyd &amp; Taylor (1994)</p>


<h3>Usage</h3>

<pre><code class='language-R'>fLloydTaylor(RRef = R_ref.n, E0 = E_0.n, 
    TSoil = Tsoil.n, TRef = if (missing(T_ref.n)) 273.15 + 
        10 else T_ref.n, T0 = if (missing(T_0.n)) 227.13 else T_0.n, 
    R_ref.n, E_0.n, Tsoil.n, T_ref.n, T_0.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fLloydTaylor_+3A_rref">RRef</code></td>
<td>
<p>Respiration rate at reference temperature</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_e0">E0</code></td>
<td>
<p>Temperature sensitivity (&quot;activation energy&quot;)
in Kelvin (degK)</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_tsoil">TSoil</code></td>
<td>
<p>Soil temperature in Kelvin (degK)</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_tref">TRef</code></td>
<td>
<p>Reference
temperature of 10 degC in Kelvin (degK)</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_t0">T0</code></td>
<td>
<p>Regression
temperature as fitted by LloydTaylor (1994) in Kelvin (degK)</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_r_ref.n">R_ref.n</code></td>
<td>
<p>deprecated way to specify RRef</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_e_0.n">E_0.n</code></td>
<td>
<p>deprecated way to specify E0</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_tsoil.n">Tsoil.n</code></td>
<td>
<p>deprecated way to specify Tsoil</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_t_ref.n">T_ref.n</code></td>
<td>
<p>deprecated way to specify TRef</p>
</td></tr>
<tr><td><code id="fLloydTaylor_+3A_t_0.n">T_0.n</code></td>
<td>
<p>deprecated way to specify T0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data vector of soil respiration rate (R, umol CO2 m-2 s-1)</p>


<h3>Author(s)</h3>

<p>AMM
reference&lt;&lt;
Lloyd J, Taylor JA (1994) On the temperature dependence of soil respiration.
Functional Ecology, 8, 315-323.
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>Examples</h3>

<pre><code class='language-R'>  T &lt;- c(-10:30)
  resp &lt;- fLloydTaylor(10, 330, T + 273.15)
plot(resp ~ T)
</code></pre>

<hr>
<h2 id='fLoadAmeriflux22'>Read basic variables from Ameriflux standard (as of 2022) files</h2><span id='topic+fLoadAmeriflux22'></span>

<h3>Description</h3>

<p>Reads Variables from file into data.frame from file and passes
it to <code><a href="#topic+read_from_ameriflux22">read_from_ameriflux22</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fLoadAmeriflux22(file_path, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fLoadAmeriflux22_+3A_file_path">file_path</code></td>
<td>
<p>scalar string: the path to the csv file</p>
</td></tr>
<tr><td><code id="fLoadAmeriflux22_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="readr.html#topic+read_csv">read_csv</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+read_from_ameriflux22">read_from_ameriflux22</a></code> <code><a href="#topic+help_export">help_export</a></code>
</p>

<hr>
<h2 id='fLoadEuroFlux16'>fLoadEuroFlux16</h2><span id='topic+fLoadEuroFlux16'></span>

<h3>Description</h3>

<p>reads a sequence of annual files in the format of Europe-fluxdata 2016</p>


<h3>Usage</h3>

<pre><code class='language-R'>fLoadEuroFlux16(siteName, dirName = "", additionalColumnNames = character(0))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fLoadEuroFlux16_+3A_sitename">siteName</code></td>
<td>
<p>scalar string: the name of the site, i.e. start of the filename before _&lt;year&gt;_</p>
</td></tr>
<tr><td><code id="fLoadEuroFlux16_+3A_dirname">dirName</code></td>
<td>
<p>scalar string: the directory where the files reside</p>
</td></tr>
<tr><td><code id="fLoadEuroFlux16_+3A_additionalcolumnnames">additionalColumnNames</code></td>
<td>
<p>character vector: column names to read in addition to c(&quot;Month&quot;, &quot;Day&quot;, &quot;Hour&quot;, &quot;NEE_st&quot;, &quot;qf_NEE_st&quot;, &quot;ustar&quot;, &quot;Ta&quot;, 'Rg')</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The filenames should correspond to the pattern &lt;sitename&gt;_&lt;YYYY&gt;_. * .txt
And hold columns c(&quot;Month&quot;, &quot;Day&quot;, &quot;Hour&quot;, &quot;NEE_st&quot;, &quot;qf_NEE_st&quot;, &quot;ustar&quot;, &quot;Ta&quot;, 'Rg').
By default only those columns are read and reported only
c(&quot;DateTime&quot;, &quot;NEE&quot;, &quot;Ustar&quot;, &quot;Tair&quot;, &quot;Rg&quot;, &quot;qf_NEE_st&quot; (Note the renaming).
NEE is set to NA for all values with &quot;qf_NEE_st != 0.
Values  of -9999.0 are replaced by NA</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_export">help_export</a></code></p>

<hr>
<h2 id='fLoadFluxnet15'>Read a file in the format of Fluxnet 2015 release</h2><span id='topic+fLoadFluxnet15'></span>

<h3>Description</h3>

<p>Assigns default units to the columns and keeps variable name attributes
as in original file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fLoadFluxnet15(
  file_path,
  additional_columns = character(0),
  colname_NEE = "NEE",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fLoadFluxnet15_+3A_file_path">file_path</code></td>
<td>
<p>scalar string: the path to the csv file</p>
</td></tr>
<tr><td><code id="fLoadFluxnet15_+3A_additional_columns">additional_columns</code></td>
<td>
<p>character vector of columns to
read in addition of standard columns of <code><a href="#topic+read_from_fluxnet15">read_from_fluxnet15</a></code>.
Can be a character vector or a object return by <code><a href="readr.html#topic+cols">cols</a></code></p>
</td></tr>
<tr><td><code id="fLoadFluxnet15_+3A_colname_nee">colname_NEE</code></td>
<td>
<p>name (scalar string) of column that reports NEE observations</p>
</td></tr>
<tr><td><code id="fLoadFluxnet15_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="readr.html#topic+read_csv">read_csv</a></code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>  ds_fn15 &lt;- Example_DETha98 %&gt;%
     fConvertTimeToPosix('YDH',Year = 'Year',Day = 'DoY', Hour = 'Hour') %&gt;%
     dplyr::mutate(
        TIMESTAMP_END = POSIXctToBerkeleyJulianDate(DateTime),
        season = factor(199801)
     ) %&gt;%
     dplyr::rename(SW_IN = "Rg", TA = "Tair", USTAR = "Ustar") %&gt;%
     dplyr::select(dplyr::one_of(c(
       "TIMESTAMP_END","NEE","SW_IN","TA","VPD","USTAR","season")))
  head(ds_fn15)
  fname &lt;- tempfile()
  readr::write_csv(ds_fn15, fname)

  # standard columns are renamed to REddyProc defaults
  ds_eproc &lt;- fLoadFluxnet15(fname)
  head(ds_eproc)
  EProc &lt;- sEddyProc$new("DE-Tha", ds_eproc)
  head(EProc$sExportData())

  # Additional columns can be specified, e.g. factor column season
  ds_eproc &lt;- fLoadFluxnet15(fname,
    additional_columns = readr::cols(season = readr::col_factor()))
  head(ds_eproc)
  EProc &lt;- sEddyProc$new("DE-Tha", ds_eproc,
    c("NEE", "Rg", "Tair", "VPD", "Ustar","season"),
    ColNamesNonNumeric = "season"
    )
  head(EProc$sExportData())
</code></pre>

<hr>
<h2 id='fLoadTXTIntoDataframe'>Load text file with one header and one unit row into data frame</h2><span id='topic+fLoadTXTIntoDataframe'></span>

<h3>Description</h3>

<p>If gaps with the flag -9999.0 exist, these are set to NA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fLoadTXTIntoDataframe(FileName = FileName.s, 
    Dir = if (!missing(Dir.s)) Dir.s else "", 
    FileName.s, Dir.s = "")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fLoadTXTIntoDataframe_+3A_filename">FileName</code></td>
<td>
<p>File name as a character string</p>
</td></tr>
<tr><td><code id="fLoadTXTIntoDataframe_+3A_dir">Dir</code></td>
<td>
<p>Directory as a character string</p>
</td></tr>
<tr><td><code id="fLoadTXTIntoDataframe_+3A_filename.s">FileName.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fLoadTXTIntoDataframe_+3A_dir.s">Dir.s</code></td>
<td>
<p>deprecated way of specifying Dir</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function fLoadFluxNCIntoDataframe, which loads data from NetCDF-Files, has
been moved to add-on package REddyProcNCDF.
In addition, <code><a href="#topic+fLoadEuroFlux16">fLoadEuroFlux16</a></code> loads data from several annual
files in format corresponding to Europe-fluxdata 2016.
</p>
<p>For using only part of the records, use <code>fFilterAttr</code> to keep
units attributes.</p>


<h3>Value</h3>

<p>Data frame with data from text file.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_export">help_export</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
examplePath &lt;- getExamplePath('Example_DETha98.txt', TRUE)
EddyData.F &lt;- fLoadTXTIntoDataframe(examplePath)
</code></pre>

<hr>
<h2 id='fSplitDateTime'>fSplitDateTime</h2><span id='topic+fSplitDateTime'></span>

<h3>Description</h3>

<p>Replace Column DateTime by columns Year, DoY, and Hour in a data.frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>fSplitDateTime(df)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fSplitDateTime_+3A_df">df</code></td>
<td>
<p>data.frame with column DateTime</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function helps exporting to the format required by the
REddyProc web interface with columns Year, DoY, and Hour</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+fWriteDataframeToFile">fWriteDataframeToFile</a></code></p>

<hr>
<h2 id='fWriteDataframeToFile'>fWriteDataframeToFile</h2><span id='topic+fWriteDataframeToFile'></span>

<h3>Description</h3>

<p>Write data frame to ASCII tab-separated text file</p>


<h3>Usage</h3>

<pre><code class='language-R'>fWriteDataframeToFile(Data.F, FileName = FileName.s, 
    Dir = if (!missing(Dir.s)) Dir.s else "", 
    Digits = if (!missing(Digits.n)) Digits.n else 5, 
    isSplitDatetime = FALSE, FileName.s, 
    Dir.s, Digits.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fWriteDataframeToFile_+3A_data.f">Data.F</code></td>
<td>
<p>Data frame</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_filename">FileName</code></td>
<td>
<p>File base name as a string</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_dir">Dir</code></td>
<td>
<p>Directory as a string</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_digits">Digits</code></td>
<td>
<p>(integer) number
of digits, i.e. precision, for numeric values</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_issplitdatetime">isSplitDatetime</code></td>
<td>
<p>set to TRUE to create columns Year, DoY and Hour</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_filename.s">FileName.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_dir.s">Dir.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="fWriteDataframeToFile_+3A_digits.n">Digits.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values are flagged as -9999.0</p>


<h3>Value</h3>

<p>Output of data frame written to file of specified type.</p>


<h3>Author(s)</h3>

<p>AMM, KS, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_export">help_export</a></code> <code><a href="#topic+fSplitDateTime">fSplitDateTime</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>(Dir &lt;- tempdir())   # directory where output is written to
fWriteDataframeToFile(Example_DETha98, 'OutputTest.txt', Dir = Dir)
</code></pre>

<hr>
<h2 id='fWriteFrench23'>fWriteFrench23</h2><span id='topic+fWriteFrench23'></span>

<h3>Description</h3>

<p>Write data frame to ASCII comma-separated text file</p>


<h3>Usage</h3>

<pre><code class='language-R'>fWriteFrench23(data, filename, isSplitDatetime = FALSE, 
    digits = 5)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fWriteFrench23_+3A_data">data</code></td>
<td>
<p>Data frame to be exported, with unit attributes attached to columns</p>
</td></tr>
<tr><td><code id="fWriteFrench23_+3A_filename">filename</code></td>
<td>
<p>(string)  name (including path) of the output file</p>
</td></tr>
<tr><td><code id="fWriteFrench23_+3A_issplitdatetime">isSplitDatetime</code></td>
<td>
<p>set to TRUE to create columns Year, DoY and Hour</p>
</td></tr>
<tr><td><code id="fWriteFrench23_+3A_digits">digits</code></td>
<td>
<p>(integer) number of digits, i.e. precision, for numeric values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writes data.frame as comma-separated file after two header rows.
</p>
<p>The first header row contains the column names, and the second units.
</p>
<p>Spaces in column names are replaced by underscore and % is replaced by
the word percent.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+fWriteDataframeToFile">fWriteDataframeToFile</a></code></p>

<hr>
<h2 id='get_day_boundaries'>get day boundaries</h2><span id='topic+get_day_boundaries'></span>

<h3>Description</h3>

<p>Return the first timestamp at (end_of_first_record_in_day) and the last at midnight</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_day_boundaries(dt)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_day_boundaries_+3A_dt">dt</code></td>
<td>
<p>vector of equidistant POSIXt timestamps with several records a day, usually 48</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_DateTimes">help_DateTimes</a></code>, <code><a href="#topic+filter_entire_days">filter_entire_days</a></code></p>

<hr>
<h2 id='get_timestep_hours'>Get the timestep in fractional hours</h2><span id='topic+get_timestep_hours'></span>

<h3>Description</h3>

<p>Get the timestep in fractional hours
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_timestep_hours(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_timestep_hours_+3A_x">x</code></td>
<td>
<p>Vector of POSIX timestamps of at least length 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric scalar of the time difference of the first two entries
in fraction hours.
</p>

<hr>
<h2 id='getAmerifluxToBGC05VariableNameMapping'>getAmerifluxToBGC05VariableNameMapping</h2><span id='topic+getAmerifluxToBGC05VariableNameMapping'></span>

<h3>Description</h3>

<p>map Ameriflux variable names to REddyProc defaults to names</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAmerifluxToBGC05VariableNameMapping(map = character(), 
    mapDefault = c(YEAR = "Year", DOY = "DoY", 
        NEE = "NEE", LE = "LE", H = "H", 
        SW_IN = "Rg", TA = "Tair", TS = "Tsoil", 
        RH = "rH", VPD = "VPD", USTAR = "Ustar", 
        NEE_PI = "NEE_orig", H_PI = "H_orig", 
        LE_PI = "LE_orig", NEE_F = "NEE_f", 
        H_F = "H_f", LE_F = "LE_f", NEE_QC = "NEE_fqc", 
        H_QC = "H_fqc", LE_QC = "LE_fqc"))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getAmerifluxToBGC05VariableNameMapping_+3A_map">map</code></td>
<td>
<p>named character vector: additional mapping,
that extends or overwrites defaults in <code>mapDefault</code></p>
</td></tr>
<tr><td><code id="getAmerifluxToBGC05VariableNameMapping_+3A_mapdefault">mapDefault</code></td>
<td>
<p>named character vector: default mapping</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get a mapping of variable names of Ameriflux
(Berkley 2016 Fluxnet release)
to of REddyProc defaults to names</p>


<h3>Author(s)</h3>

<p>TW,
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+renameVariablesInDataframe">renameVariablesInDataframe</a></code></p>

<hr>
<h2 id='getBGC05ToAmerifluxVariableNameMapping'>getBGC05ToAmerifluxVariableNameMapping</h2><span id='topic+getBGC05ToAmerifluxVariableNameMapping'></span>

<h3>Description</h3>

<p>map REddyProc names the Berkeley 2016 release of the Fluxnet data</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBGC05ToAmerifluxVariableNameMapping(map = character(), 
    mapDefault = c(Year = "YEAR", DoY = "DOY", 
        Rg = "SW_IN", Tair = "TA", Tsoil = "TS", 
        rH = "RH", VPD = "VPD", Ustar = "USTAR", 
        NEE_orig = "NEE_PI", H_orig = "H_PI", 
        LE_orig = "LE_PI", NEE_f = "NEE_F", 
        H_f = "H_F", LE_f = "LE_F", NEE_fqc = "NEE_QC", 
        H_fqc = "H_QC", LE_fqc = "LE_QC"))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBGC05ToAmerifluxVariableNameMapping_+3A_map">map</code></td>
<td>
<p>named character vector: additional mapping,
that extends or overwrites defaults in <code>mapDefault</code></p>
</td></tr>
<tr><td><code id="getBGC05ToAmerifluxVariableNameMapping_+3A_mapdefault">mapDefault</code></td>
<td>
<p>named character vector: default mapping</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Get a mapping of variable names of REddyProc defaults to names
of the Berkeley 2016 release of the Fluxnet data</p>


<h3>Author(s)</h3>

<p>TW,
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+renameVariablesInDataframe">renameVariablesInDataframe</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># adding mapping of foo, and overwriting mapping of DoY
getBGC05ToAmerifluxVariableNameMapping(c(foo = "FOO", DoY = "doy"))
</code></pre>

<hr>
<h2 id='getExamplePath'>getExamplePath</h2><span id='topic+getExamplePath'></span>

<h3>Description</h3>

<p>checks if example filename is existing and if not tries to download it.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getExamplePath(filename = "Example_DETha98.txt", 
    isTryDownload = FALSE, exampleDir = getREddyProcExampleDir(), 
    remoteDir = "")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getExamplePath_+3A_filename">filename</code></td>
<td>
<p>the name of the example file</p>
</td></tr>
<tr><td><code id="getExamplePath_+3A_istrydownload">isTryDownload</code></td>
<td>
<p>scalar logical whether to try
downloading the file to package or tmp directory.
Because of CRAN checks, need to explicitly set to TRUE</p>
</td></tr>
<tr><td><code id="getExamplePath_+3A_exampledir">exampleDir</code></td>
<td>
<p>directory where examples are
looked up and downloaded to</p>
</td></tr>
<tr><td><code id="getExamplePath_+3A_remotedir">remoteDir</code></td>
<td>
<p>the URL do download from</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Example input text data files are not distributed with the package, because
it exceeds allowed package size.
Rather, the example files will be downloaded when required from github
by this function.
</p>
<p>The remoteDir (github) must be reachable, and the writing directory
must be writeable.</p>


<h3>Value</h3>

<p>the full path name to the example data or if not available
an zero-length character.
Allows to check for <code>if (length(getExamplePath()) ) ... </code></p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='getFilledExampleDETha98Data'>getFilledExampleDETha98Data</h2><span id='topic+getFilledExampleDETha98Data'></span>

<h3>Description</h3>

<p>Get or create the gapfilled version of the Example_DETha98 example data</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFilledExampleDETha98Data(exampleDir = getREddyProcExampleDir())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFilledExampleDETha98Data_+3A_exampledir">exampleDir</code></td>
<td>
<p>the directory where the
cached filled example data is stored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>example data.frame Example_DETha98 processed by gapfilling.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='getREddyProcExampleDir'>getREddyProcExampleDir</h2><span id='topic+getREddyProcExampleDir'></span>

<h3>Description</h3>

<p>get the example directory inside temporary directory</p>


<h3>Usage</h3>

<pre><code class='language-R'>getREddyProcExampleDir(isPreferParentDir = identical(Sys.getenv("NOT_CRAN"), 
    "true"), subDir = "REddyProcExamples")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getREddyProcExampleDir_+3A_ispreferparentdir">isPreferParentDir</code></td>
<td>
<p>logical scalar, whether to prefer
temp parent directory instead of the R-session temp-Directory.
See details.</p>
</td></tr>
<tr><td><code id="getREddyProcExampleDir_+3A_subdir">subDir</code></td>
<td>
<p>the name of the subdirectory inside the
tmp directory, where examples are stored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>isPreferParentDir = FALSE</code> (the default),
the examples will be downloaded again for
each new R-session in a session specific directory as given by
<code><a href="base.html#topic+tempdir">tempdir</a></code>. This corresponds to CRAN policy.
IF TRUE, the parent of <code><a href="base.html#topic+tempdir">tempdir</a></code> will be used, so that
downloads of examples are preserved across R-sessions.
This is the default if
environment variable &quot;NOT_CRAN&quot; is defined,
when running from testthat::<code><a href="utils.html#topic+check">check</a></code>.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+getExamplePath">getExamplePath</a></code></p>

<hr>
<h2 id='getTZone'>getTZone</h2><span id='topic+getTZone'></span>

<h3>Description</h3>

<p>extracts the timezone attribute from POSIXct with default on missing</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTZone(x, default = "GMT")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTZone_+3A_x">x</code></td>
<td>
<p>POSIXct vector</p>
</td></tr>
<tr><td><code id="getTZone_+3A_default">default</code></td>
<td>
<p>time zone returned,
if x has not timezone associated or attribute is the zero string</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>Examples</h3>

<pre><code class='language-R'>getTZone(as.POSIXct("2010-07-01 16:00:00", tz = "etc/GMT-1") )
getTZone(as.POSIXct("2010-07-01 16:00:00") )
# printed with local time zone, but actually has no tz attribute
getTZone(Sys.time())
</code></pre>

<hr>
<h2 id='globalDummyVars'>globalDummyVars</h2><span id='topic+sID'></span><span id='topic+sDATA'></span><span id='topic+sINFO'></span><span id='topic+sLOCATION'></span><span id='topic+sTEMP'></span><span id='topic+sUSTAR'></span>

<h3>Description</h3>

<p>Dummy global variables with the same name as fields in R5 classes have been defined.
</p>
<p>Reason: Class methods have been defined as plain functions, so that they can be better documented.
However, the assignment operator <code>&lt;&lt;-</code> has no meaning in it and therefore R CMD check complains.
As a workaround they have been defined as global variable. Do not use them.   
</p>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='help_DateTimes'>help DateTimes</h2><span id='topic+help_DateTimes'></span>

<h3>Description</h3>

<p>Overview of functions helping with Timestamps and Dates</p>


<h3>Usage</h3>

<pre><code class='language-R'>help_DateTimes()</code></pre>


<h3>Details</h3>

<p>Functions helping with preparing and subsetting timestamps:
</p>

<ul>
<li><p> Convert different time formats to POSIX:
<code><a href="#topic+fConvertTimeToPosix">fConvertTimeToPosix</a></code>
</p>
</li>
<li><p> Convert JulianDate format used in Berkeley release to POSIXct:
<code><a href="#topic+BerkeleyJulianDateToPOSIXct">BerkeleyJulianDateToPOSIXct</a></code>
</p>
</li>
<li><p> Return the first timestamp at (end_of_first_record_in_day) and the
last at midnight:
<code><a href="#topic+get_day_boundaries">get_day_boundaries</a></code>
</p>
</li>
<li><p> Omit records before the start of the first full day and the end of
the last full day:
<code><a href="#topic+filter_entire_days">filter_entire_days</a></code>
</p>
</li>
<li><p> Subset data.frame to given years respecting the end-of-period
convention: <code><a href="#topic+filter_years_eop">filter_years_eop</a></code>
</p>
</li></ul>

<p>Back to <a href="#topic+REddyProc-package">REddyProc-package</a>.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='help_export'>help export</h2><span id='topic+help_export'></span>

<h3>Description</h3>

<p>Overview of functions helping with exporting Data and Results</p>


<h3>Usage</h3>

<pre><code class='language-R'>help_export()</code></pre>


<h3>Details</h3>

<p>Functions helping with exporting data
</p>

<ul>
<li><p> Export Input data from REddyProc class:
<code><a href="#topic+sEddyProc_sExportData">sEddyProc_sExportData</a></code>
</p>
</li>
<li><p> Export Computed results from REddyProc class:
<code><a href="#topic+sEddyProc_sExportResults">sEddyProc_sExportResults</a></code>
</p>
</li>
<li><p> Write data frame to ASCII tab-separated text file:
<code><a href="#topic+fWriteDataframeToFile">fWriteDataframeToFile</a></code>
</p>
</li>
<li><p> Write data frame to ASCII comma-separated text file with units in header row:
<code><a href="#topic+fWriteFrench23">fWriteFrench23</a></code>
</p>
</li></ul>

<p>Writing a file that can be supplied to the REddyProc webservice at
MPI-BGC Jena can be done by exporting data from REddyProc class <code>EProc</code>.
</p>
<pre>
df &lt;- EProc$sExportData()
fWriteDataframeToFile(df, "myfilename.txt", isSplitDatetime = TRUE)
</pre>
<p>For preparing minimal working examples also consider
</p>

<ul>
<li><p> Omit records before the start of the first full day and the end of
the last full day:
<code>df &lt;- <a href="#topic+filter_entire_days">filter_entire_days</a>(df)</code>
</p>
</li>
<li><p> Subset data.frame to one or two years:
<code>df &lt;- <a href="#topic+filter_years_eop">filter_years_eop</a>(df, c(1998))</code>
</p>
</li></ul>

<p>There are several functions that import from file of different formats.
</p>

<ul>
<li><p> Load text file with one header and one unit row into data frame:
<code><a href="#topic+fLoadTXTIntoDataframe">fLoadTXTIntoDataframe</a></code>
</p>
</li>
<li><p> Reads sequence of annual files in the format of Europe-fluxdata 2016:
<code><a href="#topic+fLoadEuroFlux16">fLoadEuroFlux16</a></code>
</p>
</li>
<li><p> Read basic variables from Ameriflux standard (as of 2022) files:
<code><a href="#topic+fLoadAmeriflux22">fLoadAmeriflux22</a></code>
</p>
</li>
<li><p> Read NetCDF files -&gt; moved to separate package REddyProcNCDF
(https://github.com/bgctw/REddyProcNCDF)
</p>
</li></ul>

<p>Back to <a href="#topic+REddyProc-package">REddyProc-package</a>.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter'>LightResponseCurveFitter</h2><span id='topic+LightResponseCurveFitter'></span>

<h3>Description</h3>

<p>Constructs an instance of class <code><a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter-class</a></code>.
However, better construct specialized descendants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_+3A_...">...</code></td>
<td>
<p>not used
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='LightResponseCurveFitter_computeCost'>LightResponseCurveFitter computeCost</h2><span id='topic+LightResponseCurveFitter_computeCost'></span>

<h3>Description</h3>

<p>Computing residual sum of squares for predictions vs. data of NEE</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_computeCost(thetaOpt, 
    theta, iOpt, flux, sdFlux, parameterPrior, 
    sdParameterPrior, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_thetaopt">thetaOpt</code></td>
<td>
<p>parameter vector with components of theta0 that are optimized</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_theta">theta</code></td>
<td>
<p>parameter vector with positions as in argument of
<code><a href="#topic+LightResponseCurveFitter_getParameterNames">LightResponseCurveFitter_getParameterNames</a></code></p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_iopt">iOpt</code></td>
<td>
<p>position in theta that are optimized</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_flux">flux</code></td>
<td>
<p>numeric: NEP (-NEE) or GPP time series [umolCO2 / m2 / s],
should not contain NA</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_sdflux">sdFlux</code></td>
<td>
<p>numeric: standard deviation of Flux [umolCO2 / m2 / s],
should not contain NA</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_parameterprior">parameterPrior</code></td>
<td>
<p>numeric vector along theta: prior estimate of
parameter (range of values)</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_sdparameterprior">sdParameterPrior</code></td>
<td>
<p>standard deviation of parameterPrior</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeCost_+3A_...">...</code></td>
<td>
<p>other arguments to
<code><a href="#topic+LightResponseCurveFitter_predictLRC">LightResponseCurveFitter_predictLRC</a></code>, such as VPD0, fixVPD</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_computeLRCGradient'>LightResponseCurveFitter computeLRCGradient</h2><span id='topic+LightResponseCurveFitter_computeLRCGradient'></span>

<h3>Description</h3>

<p>Gradient of <code><a href="#topic+LightResponseCurveFitter_predictLRC">LightResponseCurveFitter_predictLRC</a></code></p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_computeLRCGradient(theta, 
    Rg, VPD, Temp, VPD0 = 10, fixVPD = (k == 
        0), TRef = 15)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_theta">theta</code></td>
<td>
<p>theta [numeric] -&gt; parameter vector
(theta[1] = k (k), theta[2] = beta (beta), theta[3] = alpha,
theta[4] = RRef (rb), theta[4] = E0)</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[umol / m2 / s] or Global Radiation</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_vpd">VPD</code></td>
<td>
<p>VPD [numeric] -&gt; Vapor Pressure Deficit [hPa]</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_temp">Temp</code></td>
<td>
<p>Temp [degC] -&gt; Temperature [degC]</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_vpd0">VPD0</code></td>
<td>
<p>VPD0 [hPa] -&gt; Parameters VPD0 fixed to 10
hPa according to Lasslop et al 2010</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_fixvpd">fixVPD</code></td>
<td>
<p>boolean scalar or vector of nrow(theta):
fixVPD if TRUE the VPD effect is not considered and VPD is not part
of the computation</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_computeLRCGradient_+3A_tref">TRef</code></td>
<td>
<p>numeric scalar of Temperature (degree Celsius) for
reference respiration RRef</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_fitLRC'>LightResponseCurveFitter fitLRC</h2><span id='topic+LightResponseCurveFitter_fitLRC'></span>

<h3>Description</h3>

<p>Optimize rectangular hyperbolic light response curve in one window</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_fitLRC(dsDay, E0, 
    sdE0, RRefNight, controlGLPart = partGLControl(), 
    lastGoodParameters = rep(NA_real_, 7L))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_dsday">dsDay</code></td>
<td>
<p>data.frame with columns NEE, Rg, Temp_C, VPD, and no NAs in NEE</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_e0">E0</code></td>
<td>
<p>temperature sensitivity of respiration</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_sde0">sdE0</code></td>
<td>
<p>standard deviation of E_0.n</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_rrefnight">RRefNight</code></td>
<td>
<p>basal respiration estimated from night time data</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_controlglpart">controlGLPart</code></td>
<td>
<p>further default parameters
(see <code><a href="#topic+partGLControl">partGLControl</a></code>)</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_fitLRC_+3A_lastgoodparameters">lastGoodParameters</code></td>
<td>
<p>numeric vector returned
by last reasonable fit</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optimization is performed for three initial parameter sets that differ
by <code>beta0 (* 1.3, * 0.8)</code>.
From those three, the optimization result is selected that yielded
the lowest misfit.
Starting values are: <code>k = 0</code>,
<code>beta = interpercentileRange(0.03, 0.97)</code> of
respiration, <code>alpha = 0.1</code>, <code>R_ref</code>
from nightTime estimate.
<code>E0</code> is fixed to the night-time estimate, but varies for estimating
parameter uncertainty.
</p>
<p>If <code>controlGLPart$nBootUncertainty == 0L</code> then the
covariance matrix of the
parameters is estimated by the Hessian of the LRC curve at optimum.
Then, the additional uncertainty and covariance with uncertainty E0
is neglected.
</p>
<p>If <code>controlGLPart.l$nBootUncertainty &gt; 0L</code> then the
covariance matrix of the
parameters is estimated by a bootstrap of the data.
In each draw, E0 is drawn from N ~ (E_0, sdE_0).
</p>
<p>If there are no estimates for more than 20% of the
bootstrapped samples
The an NA-result with convergence code 1001L is returned.</p>


<h3>Value</h3>

<p>a list, If none of the optimizations from different starting
conditions converged, the parameters are NA.
</p>
<table role = "presentation">
<tr><td><code>thetaOpt</code></td>
<td>
<p>numeric vector of optimized parameters
including the fixed ones and E0</p>
</td></tr>
<tr><td><code>iOpt</code></td>
<td>
<p>index of parameters that have been
optimized, here including E0, which has been optimized prior to
this function.</p>
</td></tr>
<tr><td><code>thetaInitialGuess</code></td>
<td>
<p>the initial guess from data</p>
</td></tr>
<tr><td><code>covParms</code></td>
<td>
<p>numeric matrix of the covariance matrix
of parameters, including E0</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>integer code specifying
convergence problems: \
0: good convergence \
, 1-1000: see <code><a href="stats.html#topic+optim">optim</a></code> \
, 1001: too few bootstraps converged \
, 1002: fitted parameters were outside reasonable bounds \
, 1003: too few valid records in window \
, 1004: near zero covariance in bootstrap indicating bad fit \
, 1005: covariance from curvature of fit yielded negative variances
indicating bad fit \
, 1006: prediction of highest PAR in window was far from saturation
indicating insufficient data to constrain LRC \
, 1010: no temperature-respiration relationship found \
, 1011: too few valid records in window
(from different location: partGLFitLRCOneWindow) \
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>TW, MM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code>partGLFitLRCWindows</code>
</p>
<p><code><a href="#topic+LightResponseCurveFitter_optimLRCBounds">LightResponseCurveFitter_optimLRCBounds</a></code></p>

<hr>
<h2 id='LightResponseCurveFitter_getOptimizedParameterPositions'>LightResponseCurveFitter getOptimizedParameterPositions</h2><span id='topic+LightResponseCurveFitter_getOptimizedParameterPositions'></span>

<h3>Description</h3>

<p>get the positions of the parameters to optimize for given Fixed</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_getOptimizedParameterPositions(isUsingFixedVPD, 
    isUsingFixedAlpha)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_getOptimizedParameterPositions_+3A_isusingfixedvpd">isUsingFixedVPD</code></td>
<td>
<p>boolean scalar: if TRUE,
VPD effect set to zero and is not optimized</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getOptimizedParameterPositions_+3A_isusingfixedalpha">isUsingFixedAlpha</code></td>
<td>
<p>boolean scalar: if TRUE,
initial slope is fixed and is not optimized</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If subclasses extend the parameter vector, they need
to override this method.</p>


<h3>Value</h3>

<p>integer vector of positions in parameter vector</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_getParameterInitials'>LightResponseCurveFitter getParameterInitials</h2><span id='topic+LightResponseCurveFitter_getParameterInitials'></span>

<h3>Description</h3>

<p>return the prior distribution of parameters</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_getParameterInitials(thetaPrior)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_getParameterInitials_+3A_thetaprior">thetaPrior</code></td>
<td>
<p>numeric vector prior estimate of parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric matrix (3, nPar) of initial values for fitting parameters</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_getParameterNames'>LightResponseCurveFitter getParameterNames</h2><span id='topic+LightResponseCurveFitter_getParameterNames'></span>

<h3>Description</h3>

<p>return the parameter names used by this Light Response Curve Function</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_getParameterNames()</code></pre>


<h3>Value</h3>

<p>string vector of parameter names. Positions are important.
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>VPD effect</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>saturation of GPP at high radiation</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>initial slope</p>
</td></tr>
<tr><td><code>RRef</code></td>
<td>
<p>basal respiration (units of provided NEE,
usually mumol CO2 m-^-2 s^-2)</p>
</td></tr>
<tr><td><code>E0</code></td>
<td>
<p>temperature sensitivity estimated
from night-time data (K)
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_getPriorLocation'>LightResponseCurveFitter getPriorLocation</h2><span id='topic+LightResponseCurveFitter_getPriorLocation'></span>

<h3>Description</h3>

<p>return the prior distribution of parameters</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_getPriorLocation(NEEDay, 
    RRefNight, E0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_getPriorLocation_+3A_needay">NEEDay</code></td>
<td>
<p>numeric vector of daytime NEE</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getPriorLocation_+3A_rrefnight">RRefNight</code></td>
<td>
<p>numeric scalar of basal respiration estimated
from night-time data</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getPriorLocation_+3A_e0">E0</code></td>
<td>
<p>numeric scalar of night-time estimate of temperature sensitivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector with prior estimates of the parameters</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_getPriorScale'>LightResponseCurveFitter getPriorScale</h2><span id='topic+LightResponseCurveFitter_getPriorScale'></span>

<h3>Description</h3>

<p>return the prior distribution of parameters</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_getPriorScale(thetaPrior, 
    medianRelFluxUncertainty, nRec, ctrl)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_getPriorScale_+3A_thetaprior">thetaPrior</code></td>
<td>
<p>numeric vector of location of priors</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getPriorScale_+3A_medianrelfluxuncertainty">medianRelFluxUncertainty</code></td>
<td>
<p>numeric scalar: median across the
relative uncertainty of the flux values, i.e. sdNEE / NEE</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getPriorScale_+3A_nrec">nRec</code></td>
<td>
<p>integer scalar: number of finite observations</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_getPriorScale_+3A_ctrl">ctrl</code></td>
<td>
<p>list of further controls, with entry
<code>isLasslopPriorsApplied</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta parameter is quite well defined. Hence use a prior with
a standard deviation. The specific results are sometimes a bit sensitive
to the uncertainty of the beta prior. This uncertainty is set
corresponding to 20 times the median relative flux uncertainty. The prior
is weighted n times the observations in the cost. Hence, overall it is
using a weight of 1 / 20 of the weight of all observations.
</p>
<p>However, its not well defined if PAR does not reach saturation. Need to
check before applying this prior</p>


<h3>Value</h3>

<p>a numeric vector with prior estimates of the parameters</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_isParameterInBounds'>LightResponseCurveFitter isParameterInBounds</h2><span id='topic+LightResponseCurveFitter_isParameterInBounds'></span>

<h3>Description</h3>

<p>Check if estimated parameter vector is within reasonable bounds</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_isParameterInBounds(theta, 
    sdTheta, RRefNight, ctrl)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_isParameterInBounds_+3A_theta">theta</code></td>
<td>
<p>estimate of parameter</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_isParameterInBounds_+3A_sdtheta">sdTheta</code></td>
<td>
<p>estimate of uncertainty of the parameter</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_isParameterInBounds_+3A_rrefnight">RRefNight</code></td>
<td>
<p>numeric scalar: night-time based estimate of
basal respiration</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_isParameterInBounds_+3A_ctrl">ctrl</code></td>
<td>
<p>list of further controls</p>
</td></tr>
</table>


<h3>Details</h3>

<p>check the Beta bounds that depend on uncertainty:
outside if (beta &gt; 100 and sdBeta &gt;= beta)</p>


<h3>Value</h3>

<p>FALSE if parameters are outside reasonable bounds, TRUE otherwise</p>


<h3>Author(s)</h3>

<p>TW, MM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_optimLRC'>LightResponseCurveFitter optimLRC</h2><span id='topic+LightResponseCurveFitter_optimLRC'></span>

<h3>Description</h3>

<p>call the optimization function</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_optimLRC(theta, 
    iOpt, sdParameterPrior, ..., ctrl, isUsingHessian)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_theta">theta</code></td>
<td>
<p>numeric vector: starting parameters</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_iopt">iOpt</code></td>
<td>
<p>integer vector: positions of parameters to optimize</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_sdparameterprior">sdParameterPrior</code></td>
<td>
<p>numeric vector: prior uncertainty</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_...">...</code></td>
<td>
<p>further arguments to the cost function</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_ctrl">ctrl</code></td>
<td>
<p>list of further controls</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRC_+3A_isusinghessian">isUsingHessian</code></td>
<td>
<p>scalar boolean: set to TRUE to compute
Hessian at optimum</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of result of <code><a href="stats.html#topic+optim">optim</a></code> amended with list
</p>
<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>numeric vector: optimized parameter
vector including the fixed components</p>
</td></tr>
<tr><td><code>iOpt</code></td>
<td>
<p>integer vector: position of
parameters that have been optimized
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_optimLRCBounds'>LightResponseCurveFitter optimLRCBounds</h2><span id='topic+LightResponseCurveFitter_optimLRCBounds'></span>

<h3>Description</h3>

<p>Optimize parameters with refitting with some fixed parameters if outside bounds</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_optimLRCBounds(theta0, 
    parameterPrior, ..., dsDay, lastGoodParameters, 
    ctrl)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_theta0">theta0</code></td>
<td>
<p>initial parameter estimate</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_parameterprior">parameterPrior</code></td>
<td>
<p>prior estimate of model parameters</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_...">...</code></td>
<td>
<p>further parameters to <code>.optimLRC</code>,</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_dsday">dsDay</code></td>
<td>
<p>argument to <code>.optimLRC</code>, here checked
for occurrence of high VPD</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_lastgoodparameters">lastGoodParameters</code></td>
<td>
<p>parameters vector of last successful fit</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCBounds_+3A_ctrl">ctrl</code></td>
<td>
<p>list of further controls, such as
<code>isNeglectVPDEffect = TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If parameters alpha or k are outside bounds (Table A1 in Lasslop 2010),
refit with some parameters fixed
to values from fit of previous window.
</p>
<p>No parameters are reported if alpha&lt;0 or RRef &lt; 0 or beta0 &lt; 0
or beta0 &gt; 250
</p>
<p>Not parameters are reported if the data did not contain records that
are near light saturation.
This is checked by comparing the prediction at highest PAR with the
beta parameter</p>


<h3>Value</h3>

<p>list result of optimization as of
<code><a href="#topic+LightResponseCurveFitter_optimLRCOnAdjustedPrior">LightResponseCurveFitter_optimLRCOnAdjustedPrior</a></code> with entries
</p>
<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p> numeric parameter vector that includes the fixed components</p>
</td></tr>
<tr><td><code>iOpt</code></td>
<td>
<p> integer vector of indices of the vector that have been optimized</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p> scalar integer indicating bad conditions on fitting
(see <code><a href="#topic+LightResponseCurveFitter_fitLRC">LightResponseCurveFitter_fitLRC</a></code>) </p>
</td></tr></table>


<h3>Author(s)</h3>

<p>TW, MM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+LightResponseCurveFitter_fitLRC">LightResponseCurveFitter_fitLRC</a></code></p>

<hr>
<h2 id='LightResponseCurveFitter_optimLRCOnAdjustedPrior'>LightResponseCurveFitter optimLRCOnAdjustedPrior</h2><span id='topic+LightResponseCurveFitter_optimLRCOnAdjustedPrior'></span>

<h3>Description</h3>

<p>Lower bound flux uncertainty and adjust prior uncertainty before calling optimLRC</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_optimLRCOnAdjustedPrior(theta, 
    iOpt, dsDay, parameterPrior, ctrl, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_theta">theta</code></td>
<td>
<p>numeric vector of starting values</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_iopt">iOpt</code></td>
<td>
<p>integer vector: positions of subset of parameters
that are optimized</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_dsday">dsDay</code></td>
<td>
<p>dataframe of NEE, sdNEE and predictors Rg, VPD and Temp</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_parameterprior">parameterPrior</code></td>
<td>
<p>numeric vector of prior parameter estimates
(corresponding to theta) # TODO rename to thetaPrior</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_ctrl">ctrl</code></td>
<td>
<p>list of further controls</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_optimLRCOnAdjustedPrior_+3A_...">...</code></td>
<td>
<p>further arguments to
<code><a href="#topic+LightResponseCurveFitter_optimLRC">LightResponseCurveFitter_optimLRC</a></code>
(passed to <code><a href="#topic+LightResponseCurveFitter_computeCost">LightResponseCurveFitter_computeCost</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only those records are used for optimization where both NEE
and sdNEE are finite.
In larger settings, already filtered at
</p>
<p>Optimization of LRC parameters takes into account the uncertainty
of the flux values. In order to avoid very strong leverage, values with a
very low uncertainty (&lt; a lower quantile) are assigned the lower quantile is
assigned. This procedure downweighs records with a high uncertainty, but does
not apply a large leverage for records with a very low uncertainty. Avoid
this correction by setting <code>ctrl$isBoundLowerNEEUncertainty =
FALSE</code>
</p>
<p>The uncertainty of the prior, that maybe derived from fluxes)  is allowed to
adapt to the uncertainty of the fluxes.
This is done in <code>link{LightResponseCurveFitter_getPriorScale}</code></p>


<h3>Value</h3>

<p>result of <code><a href="#topic+LightResponseCurveFitter_optimLRC">LightResponseCurveFitter_optimLRC</a></code> with
items theta, iOpt and convergence</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter_predictGPP'>LightResponseCurveFitter predictGPP</h2><span id='topic+LightResponseCurveFitter_predictGPP'></span>

<h3>Description</h3>

<p>Light Response function for GPP</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_predictGPP(Rg, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_predictGPP_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density [mumol / m2 / s]
or Global Radiation</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictGPP_+3A_...">...</code></td>
<td>
<p>further parameters to the LRC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method must be be implemented by a specific subclass.
Currently there are several alternatives: <br />
</p>

<ul>
<li><p> Rectangular: <code><a href="#topic+RectangularLRCFitter_predictGPP">RectangularLRCFitter_predictGPP</a></code>
</p>
</li>
<li><p> Nonrectangular: <code><a href="#topic+NonrectangularLRCFitter_predictGPP">NonrectangularLRCFitter_predictGPP</a></code>
</p>
</li>
<li><p> Rectangular: <code><a href="#topic+LogisticSigmoidLRCFitter_predictGPP">LogisticSigmoidLRCFitter_predictGPP</a></code>
</p>
</li></ul>


<h3>Value</h3>

<p>numeric vector of length(Rg) of GPP</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+partitionNEEGL">partitionNEEGL</a></code></p>

<hr>
<h2 id='LightResponseCurveFitter_predictLRC'>LightResponseCurveFitter predictLRC</h2><span id='topic+LightResponseCurveFitter_predictLRC'></span>

<h3>Description</h3>

<p>Light Response Function</p>


<h3>Usage</h3>

<pre><code class='language-R'>LightResponseCurveFitter_predictLRC(theta, 
    Rg, VPD, Temp, VPD0 = 10, fixVPD = (k == 
        0), TRef = 15)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_theta">theta</code></td>
<td>
<p>numeric vector of parameters</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[umol / m2 / s] or Global Radiation</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_vpd">VPD</code></td>
<td>
<p>VPD [numeric] -&gt; Vapor Pressure Deficit [hPa]</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_temp">Temp</code></td>
<td>
<p>Temp [degC] -&gt; Temperature [degC]</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_vpd0">VPD0</code></td>
<td>
<p>VPD0 [hPa] -&gt; Parameters VPD0 fixed to 10 hPa
according to Lasslop et al 2010</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_fixvpd">fixVPD</code></td>
<td>
<p>boolean scalar or vector of nrow theta:
fixVPD if TRUE the VPD effect is not considered and VPD is not part
of the computation</p>
</td></tr>
<tr><td><code id="LightResponseCurveFitter_predictLRC_+3A_tref">TRef</code></td>
<td>
<p>numeric scalar of Temperature (degree Celsius) for
reference respiration RRef</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predict ecosystem fluxes (Reco, GPP, NEP = GPP-Reco) for given parameters
and environmental conditions.
</p>
<p>The VPD effect is included according to Lasslop et al., 2010.
</p>
<p>If theta is a matrix, a different row of parameters is used for different
entries of other inputs</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='LightResponseCurveFitter-class'>Class <code>"LightResponseCurveFitter"</code></h2><span id='topic+LightResponseCurveFitter-class'></span>

<h3>Description</h3>

<p>Base class for fitting parameters to light response curves (LRC)
</p>
<p>Concrete classes for the following LRC functions are available:
</p>

<ul>
<li><p> common rectangular hyperbolic light-response: <code><a href="#topic+RectangularLRCFitter-class">RectangularLRCFitter-class</a></code>
</p>
</li>
<li><p> nonrectangular hyperbolic light-response: <code><a href="#topic+NonrectangularLRCFitter-class">NonrectangularLRCFitter-class</a></code>
</p>
</li>
<li><p> logistic sigmoid light-response: <code><a href="#topic+LogisticSigmoidLRCFitter-class">LogisticSigmoidLRCFitter-class</a></code>
</p>
</li></ul>

<p>They mostly differ in their prediction of GPP by method <code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a></code>.
</p>


<h3>Extends</h3>

<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code><a href="#topic+LightResponseCurveFitter_computeLRCGradient">LightResponseCurveFitter_computeLRCGradient</a>(theta, Rg, VPD, Temp, VPD0, fixVPD, TRef)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a>(Rg, ...)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_predictLRC">LightResponseCurveFitter_predictLRC</a>(theta, Rg, VPD, Temp, VPD0, fixVPD, TRef)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_computeCost">LightResponseCurveFitter_computeCost</a>(thetaOpt, theta, iOpt, flux, sdFlux, parameterPrior, sdParameterPrior, ...)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_optimLRC">LightResponseCurveFitter_optimLRC</a>(theta, iOpt, sdParameterPrior, ..., ctrl, isUsingHessian)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_isParameterInBounds">LightResponseCurveFitter_isParameterInBounds</a>(theta, sdTheta, RRefNight, ctrl)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_optimLRCOnAdjustedPrior">LightResponseCurveFitter_optimLRCOnAdjustedPrior</a>(theta, iOpt, dsDay, parameterPrior, ctrl, ...)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_getOptimizedParameterPositions">LightResponseCurveFitter_getOptimizedParameterPositions</a>(isUsingFixedVPD, isUsingFixedAlpha)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_optimLRCBounds">LightResponseCurveFitter_optimLRCBounds</a>(theta0, parameterPrior, ..., lastGoodParameters, ctrl)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_getParameterInitials">LightResponseCurveFitter_getParameterInitials</a>(thetaPrior)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_getPriorScale">LightResponseCurveFitter_getPriorScale</a>(thetaPrior, medianRelFluxUncertainty, nRec, ctrl)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_getPriorLocation">LightResponseCurveFitter_getPriorLocation</a>(NEEDay, RRefNight, E0)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_fitLRC">LightResponseCurveFitter_fitLRC</a>(dsDay, E0, sdE0, RRefNight, controlGLPart, lastGoodParameters)</code>:</dt><dd>  </dd>
<dt><code><a href="#topic+LightResponseCurveFitter_getParameterNames">LightResponseCurveFitter_getParameterNames</a>()</code>:</dt><dd>  </dd>
</dl>



<h3>Author(s)</h3>

<p>TW</p>

<hr>
<h2 id='LogisticSigmoidLRCFitter'>LogisticSigmoidLRCFitter</h2><span id='topic+LogisticSigmoidLRCFitter'></span>

<h3>Description</h3>

<p>Constructs an instance of class <code><a href="#topic+LogisticSigmoidLRCFitter-class">LogisticSigmoidLRCFitter-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogisticSigmoidLRCFitter(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LogisticSigmoidLRCFitter_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='LogisticSigmoidLRCFitter_predictGPP'>LogisticSigmoidLRCFitter predictGPP</h2><span id='topic+LogisticSigmoidLRCFitter_predictGPP'></span>

<h3>Description</h3>

<p>Logistic Sigmoid Light Response function for GPP</p>


<h3>Usage</h3>

<pre><code class='language-R'>LogisticSigmoidLRCFitter_predictGPP(Rg, Amax, 
    alpha)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LogisticSigmoidLRCFitter_predictGPP_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[mumol / m2 / s] or Global Radiation</p>
</td></tr>
<tr><td><code id="LogisticSigmoidLRCFitter_predictGPP_+3A_amax">Amax</code></td>
<td>
<p>vector of length(Rg): saturation (beta parameter) adjusted
for effect of VPD for each line of Rg</p>
</td></tr>
<tr><td><code id="LogisticSigmoidLRCFitter_predictGPP_+3A_alpha">alpha</code></td>
<td>
<p>numeric scalar or vector of length(Rg): alpha parameter:
slope at Rg = 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>GPP &lt;- Amax * tanh(alpha * Rg / Amax)</code></p>


<h3>Value</h3>

<p>numeric vector of length(Rg) of GPP</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a></code></p>

<hr>
<h2 id='LogisticSigmoidLRCFitter-class'>Class <code>"LogisticSigmoidLRCFitter"</code></h2><span id='topic+LogisticSigmoidLRCFitter-class'></span>

<h3>Description</h3>

<p>Logistic sigmoid light-response curve fitting.
</p>


<h3>Extends</h3>

<p>Class <code>"<a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter</a>"</code>, directly.
</p>
<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>computeGPPGradient(Rg, Amax, alpha)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>predictGPP(Rg, Amax, alpha)</code>:</dt><dd><p> ~~ </p>
</dd>
</dl>

<p>The following methods are inherited (from the corresponding class):
predictGPP (&quot;LightResponseCurveFitter&quot;), getParameterNames (&quot;LightResponseCurveFitter&quot;), fitLRC (&quot;LightResponseCurveFitter&quot;), getPriorLocation (&quot;LightResponseCurveFitter&quot;), getPriorScale (&quot;LightResponseCurveFitter&quot;), getParameterInitials (&quot;LightResponseCurveFitter&quot;), optimLRCBounds (&quot;LightResponseCurveFitter&quot;), getOptimizedParameterPositions (&quot;LightResponseCurveFitter&quot;), optimLRCOnAdjustedPrior (&quot;LightResponseCurveFitter&quot;), isParameterInBounds (&quot;LightResponseCurveFitter&quot;), optimLRC (&quot;LightResponseCurveFitter&quot;), computeCost (&quot;LightResponseCurveFitter&quot;), predictLRC (&quot;LightResponseCurveFitter&quot;), computeLRCGradient (&quot;LightResponseCurveFitter&quot;)
</p>

<hr>
<h2 id='NonrectangularLRCFitter'>NonrectangularLRCFitter</h2><span id='topic+NonrectangularLRCFitter'></span>

<h3>Description</h3>

<p>Constructs an instance of class <code><a href="#topic+NonrectangularLRCFitter-class">NonrectangularLRCFitter-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NonrectangularLRCFitter(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NonrectangularLRCFitter_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='NonrectangularLRCFitter_getParameterNames'>NonrectangularLRCFitter getParameterNames</h2><span id='topic+NonrectangularLRCFitter_getParameterNames'></span>

<h3>Description</h3>

<p>return the parameter names used by this Light Response Curve Function</p>


<h3>Usage</h3>

<pre><code class='language-R'>NonrectangularLRCFitter_getParameterNames()</code></pre>


<h3>Value</h3>

<p>string vector of parameter names. Positions are important.
Adds sixth parameter, <code>logitconv</code> to the parameters
of <code><a href="#topic+LightResponseCurveFitter_getParameterNames">LightResponseCurveFitter_getParameterNames</a></code>
</p>
<table role = "presentation">
<tr><td><code>logitconf</code></td>
<td>
<p>logit-transformed convexity parameter.
The value at original scale is obtained by
<code>conv = 1 / (1 + exp(-logitconv))</code>
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+NonrectangularLRCFitter_predictGPP">NonrectangularLRCFitter_predictGPP</a></code></p>

<hr>
<h2 id='NonrectangularLRCFitter_predictGPP'>NonrectangularLRCFitter predictGPP</h2><span id='topic+NonrectangularLRCFitter_predictGPP'></span>

<h3>Description</h3>

<p>Nonrectangular hyperbolic Light Response function for GPP</p>


<h3>Usage</h3>

<pre><code class='language-R'>NonrectangularLRCFitter_predictGPP(Rg, Amax, 
    alpha, conv)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NonrectangularLRCFitter_predictGPP_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[mumol / m2 / s] or Global Radiation</p>
</td></tr>
<tr><td><code id="NonrectangularLRCFitter_predictGPP_+3A_amax">Amax</code></td>
<td>
<p>numeric scalar or vector of length(Rg):
beta parameter adjusted for VPD effect</p>
</td></tr>
<tr><td><code id="NonrectangularLRCFitter_predictGPP_+3A_alpha">alpha</code></td>
<td>
<p>numeric scalar or vector of length(Rg):
alpha parameter: initial slope</p>
</td></tr>
<tr><td><code id="NonrectangularLRCFitter_predictGPP_+3A_conv">conv</code></td>
<td>
<p>numeric scalar or vector of length(Rg):
convexity parameter (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generalizes the <code><a href="#topic+RectangularLRCFitter_predictGPP">RectangularLRCFitter_predictGPP</a></code>
by adding the convexity parameter <code>conv</code>.
For <code>conv -&gt; 0 (logitconv -&gt; -Inf)</code>: approaches the rectangular hyperbolic.
For <code>conv -&gt; 1 (logitconv -&gt; + Inf)</code>: approaches a step function.
Expected values of <code>conv</code> are about 0.7-0.9 (Moffat 2012).</p>


<h3>Value</h3>

<p>numeric vector of length(Rg) of GPP</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a></code></p>

<hr>
<h2 id='NonrectangularLRCFitter-class'>Class <code>"NonrectangularLRCFitter"</code></h2><span id='topic+NonrectangularLRCFitter-class'></span>

<h3>Description</h3>

<p>Nonrectangular hyperbolic light-response curve fitting.
</p>


<h3>Extends</h3>

<p>Class <code>"<a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter</a>"</code>, directly.
</p>
<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>computeGPPGradient(Rg, Amax, alpha, logitconv)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>getParameterNames()</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>getPriorLocation(NEEDay, RRefNight, E0)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>getPriorScale(thetaPrior, medianRelFluxUncertainty, nRec, ctrl)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>getOptimizedParameterPositions(isUsingFixedVPD, isUsingFixedAlpha)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>predictLRC(theta, Rg, VPD, Temp, VPD0, fixVPD, TRef)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>predictGPP(Rg, Amax, alpha, conv)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>computeLRCGradient(theta, Rg, VPD, Temp, VPD0, fixVPD, TRef)</code>:</dt><dd><p> ~~ </p>
</dd>
</dl>

<p>The following methods are inherited (from the corresponding class):
computeLRCGradient (&quot;LightResponseCurveFitter&quot;), predictGPP (&quot;LightResponseCurveFitter&quot;), predictLRC (&quot;LightResponseCurveFitter&quot;), getOptimizedParameterPositions (&quot;LightResponseCurveFitter&quot;), getPriorScale (&quot;LightResponseCurveFitter&quot;), getPriorLocation (&quot;LightResponseCurveFitter&quot;), getParameterNames (&quot;LightResponseCurveFitter&quot;), fitLRC (&quot;LightResponseCurveFitter&quot;), getParameterInitials (&quot;LightResponseCurveFitter&quot;), optimLRCBounds (&quot;LightResponseCurveFitter&quot;), optimLRCOnAdjustedPrior (&quot;LightResponseCurveFitter&quot;), isParameterInBounds (&quot;LightResponseCurveFitter&quot;), optimLRC (&quot;LightResponseCurveFitter&quot;), computeCost (&quot;LightResponseCurveFitter&quot;)
</p>

<hr>
<h2 id='partGLControl'>partGLControl</h2><span id='topic+partGLControl'></span>

<h3>Description</h3>

<p>Default list of parameters for Lasslop 2010 daytime flux partitioning
For highest compatibility to the pvWave code of G.Lasslop
(used by first BGC-online tool)
see function <code><a href="#topic+partGLControlLasslopCompatible">partGLControlLasslopCompatible</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>partGLControl(LRCFitConvergenceTolerance = 0.001, 
    nLRCFitConvergenceTolerance = 0.001, 
    nBootUncertainty = 30L, minNRecInDayWindow = 10L, 
    isAssociateParmsToMeanOfValids = TRUE, 
    isLasslopPriorsApplied = TRUE, isUsingLasslopQualityConstraints = FALSE, 
    isSdPredComputed = TRUE, isFilterMeteoQualityFlag = FALSE, 
    isBoundLowerNEEUncertainty = TRUE, fixedTRefAtNightTime = NA, 
    isExtendTRefWindow = TRUE, smoothTempSensEstimateAcrossTime = TRUE, 
    isNeglectPotRadForNight = FALSE, NRHRfunction = FALSE, 
    isNeglectVPDEffect = FALSE, isRefitMissingVPDWithNeglectVPDEffect = TRUE, 
    fixedTempSens = data.frame(E0 = NA_real_, 
        sdE0 = NA_real_, RRef = NA_real_), 
    replaceMissingSdNEEParms = c(perc = 0.2, 
        minSd = 0.7), neglectNEEUncertaintyOnMissing = FALSE, 
    minPropSaturation = NA, useNightimeBasalRespiration = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partGLControl_+3A_lrcfitconvergencetolerance">LRCFitConvergenceTolerance</code></td>
<td>
<p>convergence criterion for rectangular
light response curve fit.
If relative improvement of reducing residual sum of squares between
predictions and
observations is less than this criterion, assume convergence.
Decrease to get more precise parameter estimates, Increase for speedup.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_nlrcfitconvergencetolerance">nLRCFitConvergenceTolerance</code></td>
<td>
<p>convergence criterion for
nonrectangular light response curve fit.
Here its a factor of machine tolerance.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_nbootuncertainty">nBootUncertainty</code></td>
<td>
<p>number of bootstrap samples for
estimating uncertainty.
Set to zero to derive uncertainty from curvature of a single fit</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_minnrecindaywindow">minNRecInDayWindow</code></td>
<td>
<p>Minimum number of data points
for regression</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isassociateparmstomeanofvalids">isAssociateParmsToMeanOfValids</code></td>
<td>
<p>set to FALSE to
associate parameters to
the first record of the window for interpolation
instead of mean across valid records inside a window</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_islassloppriorsapplied">isLasslopPriorsApplied</code></td>
<td>
<p>set to TRUE to apply strong fixed
priors on LRC fitting.
Returned parameter estimates claimed valid for some case where not
enough data was available</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isusinglasslopqualityconstraints">isUsingLasslopQualityConstraints</code></td>
<td>
<p>set to TRUE to avoid
quality constraints additional to Lasslop 2010</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_issdpredcomputed">isSdPredComputed</code></td>
<td>
<p>set to FALSE to avoid computing
standard errors
of Reco and GPP for small performance increase</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isfiltermeteoqualityflag">isFilterMeteoQualityFlag</code></td>
<td>
<p>set to TRUE to use only records
where quality flag
of meteo drivers (radiation, temperature, VPD) is zero, i.e.
non-gapfilled for parameter estimation.
For prediction, the gap-filled value is used always, to produce
predictions also for gaps.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isboundlowerneeuncertainty">isBoundLowerNEEUncertainty</code></td>
<td>
<p>set to FALSE to avoid adjustment
of very low uncertainties before
day-Time fitting that avoids the high leverage those records with
unreasonable low uncertainty.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_fixedtrefatnighttime">fixedTRefAtNightTime</code></td>
<td>
<p>if a finite value (degree Centigrade)
is given, it is used instead of median data temperature as reference
temperature in estimation of temperature sensitivity from night data</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isextendtrefwindow">isExtendTRefWindow</code></td>
<td>
<p>set to FALSE to avoid successively
extending the night-time window
in order to estimate a temperature sensitivity where previous estimates
failed</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_smoothtempsensestimateacrosstime">smoothTempSensEstimateAcrossTime</code></td>
<td>
<p>set to FALSE to use
independent estimates of temperature
sensitivity on each windows instead of a vector of E0 that is
smoothed over time</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isneglectpotradfornight">isNeglectPotRadForNight</code></td>
<td>
<p>set to TRUE to not use potential
radiation in determining night-time data.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_nrhrfunction">NRHRfunction</code></td>
<td>
<p>deprecated: Flag if TRUE use the NRHRF
for partitioning; Now use <code>lrcFitter = NonrectangularLRCFitter()</code></p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isneglectvpdeffect">isNeglectVPDEffect</code></td>
<td>
<p>set to TRUE to avoid using VPD in the
computations. This may help when VPD is rarely measured.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_isrefitmissingvpdwithneglectvpdeffect">isRefitMissingVPDWithNeglectVPDEffect</code></td>
<td>
<p>set to FALSE to avoid
repeating estimation
with <code>isNeglectVPDEffect = TRUE</code> trying to predict when VPD
is missing</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_fixedtempsens">fixedTempSens</code></td>
<td>
<p>data.frame
of one row or nRow = nWindow
corresponding to return value of <code>partGLFitNightTimeTRespSens</code>
While column <code>RRef</code> is used only as a  prior and initial value for
the daytime-fitting and can be NA,
<code>E0</code> is used as given temperature sensitivity and varied according
to <code>sdE0</code> in the bootstrap.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_replacemissingsdneeparms">replaceMissingSdNEEParms</code></td>
<td>
<p>parameters for
replacing missing standard deviation of NEE.
see <code>replaceMissingSdByPercentage</code>.
Default sets missing uncertainty to 20% of NEE but at least 0.7
flux-units (usually mumol CO2 / m2 / s).
Specify c(NA, NA) to avoid replacing missings in standard deviation of
NEE and to omit those records from LRC fit.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_neglectneeuncertaintyonmissing">neglectNEEUncertaintyOnMissing</code></td>
<td>
<p>If set to TRUE: if there are
records with missing uncertainty of NEE inside one window,
set all uncertainties to 1.
This overrules option replaceMissingSdNEEParms.</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_minpropsaturation">minPropSaturation</code></td>
<td>
<p>quality criterion for sufficient data
in window. If GPP prediction of highest PAR of window is less than
minPropSaturation * (GPP at light-saturation, i.e. beta)
this indicates that PAR is not sufficiently high to constrain the
shape of the LRC</p>
</td></tr>
<tr><td><code id="partGLControl_+3A_usenightimebasalrespiration">useNightimeBasalRespiration</code></td>
<td>
<p>set to TRUE to estimate
nighttime respiration based on basal respiration estimated on
nighttime data instead of basal respiration estimated from daytime
data. This implements the modified daytime method from
Keenan 2019 (doi:10.1038/s41559-019-0809-2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with entries of given arguments.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+partitionNEEGL">partitionNEEGL</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>partGLControl(nBootUncertainty = 40L)
</code></pre>

<hr>
<h2 id='partGLControlLasslopCompatible'>partGLControlLasslopCompatible</h2><span id='topic+partGLControlLasslopCompatible'></span>

<h3>Description</h3>

<p>Daytime flux partitioning parms compatible with with the pvWave</p>


<h3>Usage</h3>

<pre><code class='language-R'>partGLControlLasslopCompatible(nBootUncertainty = 0L, 
    minNRecInDayWindow = 10L, isAssociateParmsToMeanOfValids = FALSE, 
    isLasslopPriorsApplied = TRUE, isUsingLasslopQualityConstraints = TRUE, 
    isBoundLowerNEEUncertainty = FALSE, fixedTRefAtNightTime = 15, 
    isExtendTRefWindow = FALSE, smoothTempSensEstimateAcrossTime = FALSE, 
    isRefitMissingVPDWithNeglectVPDEffect = FALSE, 
    minPropSaturation = NA, isNeglectVPDEffect = FALSE, 
    replaceMissingSdNEEParms = c(NA, NA), 
    neglectNEEUncertaintyOnMissing = TRUE, 
    ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partGLControlLasslopCompatible_+3A_nbootuncertainty">nBootUncertainty</code></td>
<td>
<p>0: Derive uncertainty from
curvature of a single fit, neglecting the uncertainty of previously
estimated temperature sensitivity, E0</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_minnrecindaywindow">minNRecInDayWindow</code></td>
<td>
<p>Minimum number of 10 valid records
for regression in a single window</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isassociateparmstomeanofvalids">isAssociateParmsToMeanOfValids</code></td>
<td>
<p>associate parameters to
the first record of the window for interpolation instead of mean across
valid records inside a window</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_islassloppriorsapplied">isLasslopPriorsApplied</code></td>
<td>
<p>Apply fixed Lasslop priors
in LRC fitting.</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isusinglasslopqualityconstraints">isUsingLasslopQualityConstraints</code></td>
<td>
<p>avoid quality constraints
additional to the ones in Lasslop 2010</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isboundlowerneeuncertainty">isBoundLowerNEEUncertainty</code></td>
<td>
<p>FALSE: avoid adjustment of very
low uncertainties before
day-Time fitting that avoids the high leverage those records with
unreasonable low uncertainty.</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_fixedtrefatnighttime">fixedTRefAtNightTime</code></td>
<td>
<p>use fixed (degree Centigrade)
temperature sensitivity
instead of median data temperature as reference temperature in
estimation of temperature sensitivity from night data</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isextendtrefwindow">isExtendTRefWindow</code></td>
<td>
<p>avoid successively extending the
night-time window
in order to estimate a temperature sensitivity where previous
estimates failed</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_smoothtempsensestimateacrosstime">smoothTempSensEstimateAcrossTime</code></td>
<td>
<p>FALSE: use independent
estimates of temperature
sensitivity on each windows instead of a vector of E0 that is
smoothed over time</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isrefitmissingvpdwithneglectvpdeffect">isRefitMissingVPDWithNeglectVPDEffect</code></td>
<td>
<p>FALSE: avoid
repeating estimation with <code>isNeglectVPDEffect = TRUE</code></p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_minpropsaturation">minPropSaturation</code></td>
<td>
<p>NA: avoid quality constraint of
sufficient saturation in data
This option is overruled, i.e. not considered, if option
isUsingLasslopQualityConstraints = TRUE.</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_isneglectvpdeffect">isNeglectVPDEffect</code></td>
<td>
<p>FALSE: do not neglect VPD effect</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_replacemissingsdneeparms">replaceMissingSdNEEParms</code></td>
<td>
<p>do not replace missing NEE,
but see option</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_neglectneeuncertaintyonmissing">neglectNEEUncertaintyOnMissing</code></td>
<td>
<p>if there are records with
missing uncertainty of NEE inside one window, set all sdNEE to 1.
This overrules option replaceMissingSdNEEParms.</p>
</td></tr>
<tr><td><code id="partGLControlLasslopCompatible_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+partGLControl">partGLControl</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+partGLControl">partGLControl</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>partGLControlLasslopCompatible()
</code></pre>

<hr>
<h2 id='partGLExtractStandardData'>partGLExtractStandardData</h2><span id='topic+partGLExtractStandardData'></span>

<h3>Description</h3>

<p>Relevant columns from original input with defined names</p>


<h3>Usage</h3>

<pre><code class='language-R'>partGLExtractStandardData(ds, NEEVar = paste0("NEE", 
    suffixDash, "_f"), QFNEEVar = if (!missing(QFNEEVar.s)) QFNEEVar.s else paste0("NEE", 
    suffixDash, "_fqc"), QFNEEValue = if (!missing(QFNEEValue.n)) QFNEEValue.n else 0, 
    NEESdVar = if (!missing(NEESdVar.s)) NEESdVar.s else paste0("NEE", 
        suffixDash, "_fsd"), TempVar = paste0("Tair_f"), 
    QFTempVar = if (!missing(QFTempVar.s)) QFTempVar.s else paste0("Tair_fqc"), 
    QFTempValue = if (!missing(QFTempValue.n)) QFTempValue.n else 0, 
    VPDVar = if (!missing(VPDVar.s)) VPDVar.s else paste0("VPD_f"), 
    QFVPDVar = if (!missing(QFVPDVar.s)) QFVPDVar.s else paste0("VPD_fqc"), 
    QFVPDValue = if (!missing(QFVPDValue.n)) QFVPDValue.n else 0, 
    RadVar = if (!missing(RadVar.s)) RadVar.s else "Rg_f", 
    QFRadVar = if (!missing(QFRadVar.s)) QFRadVar.s else paste0("Rg_fqc"), 
    QFRadValue = if (!missing(QFRadValue.n)) QFRadValue.n else 0, 
    PotRadVar = if (!missing(PotRadVar.s)) PotRadVar.s else "PotRad_NEW", 
    suffix = if (!missing(Suffix.s)) Suffix.s else "", 
    NEEVar.s, QFNEEVar.s, QFNEEValue.n, NEESdVar.s, 
    TempVar.s, QFTempVar.s, QFTempValue.n, 
    VPDVar.s, QFVPDVar.s, QFVPDValue.n, RadVar.s, 
    QFRadVar.s, QFRadValue.n, PotRadVar.s, 
    Suffix.s, controlGLPart = partGLControl())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partGLExtractStandardData_+3A_ds">ds</code></td>
<td>
<p>dataset with all the specified input columns and
full days in equidistant times</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_neevar">NEEVar</code></td>
<td>
<p>Variable of NEE</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfneevar">QFNEEVar</code></td>
<td>
<p>Quality
flag of variable</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfneevalue">QFNEEValue</code></td>
<td>
<p>Value of quality flag for
_good_ (original) data</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_neesdvar">NEESdVar</code></td>
<td>
<p>Variable of
standard deviation of net ecosystem fluxes</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_tempvar">TempVar</code></td>
<td>
<p>Filled air or soil
temperature variable (degC)</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qftempvar">QFTempVar</code></td>
<td>
<p>Quality flag of
filled temperature variable</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qftempvalue">QFTempValue</code></td>
<td>
<p>Value of temperature quality flag
for _good_ (original) data</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_vpdvar">VPDVar</code></td>
<td>
<p>Filled Vapor Pressure Deficit, VPD (hPa)</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfvpdvar">QFVPDVar</code></td>
<td>
<p>Quality flag of filled VPD variable</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfvpdvalue">QFVPDValue</code></td>
<td>
<p>Value of VPD quality flag for
_good_ (original) data</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_radvar">RadVar</code></td>
<td>
<p>Filled radiation variable</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfradvar">QFRadVar</code></td>
<td>
<p>Quality flag of filled radiation variable</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfradvalue">QFRadValue</code></td>
<td>
<p>Value of radiation quality flag for
_good_ (original) data</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_potradvar">PotRadVar</code></td>
<td>
<p>Variable name of potential rad. (W / m2)</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_suffix">suffix</code></td>
<td>
<p>string inserted into column names before
identifier for NEE column defaults
(see <code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code>).</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_neevar.s">NEEVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfneevar.s">QFNEEVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfneevalue.n">QFNEEValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_neesdvar.s">NEESdVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_tempvar.s">TempVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qftempvar.s">QFTempVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qftempvalue.n">QFTempValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_vpdvar.s">VPDVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfvpdvar.s">QFVPDVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfvpdvalue.n">QFVPDValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_radvar.s">RadVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfradvar.s">QFRadVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_qfradvalue.n">QFRadValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_potradvar.s">PotRadVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_suffix.s">Suffix.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partGLExtractStandardData_+3A_controlglpart">controlGLPart</code></td>
<td>
<p>further default parameters,
see <code><a href="#topic+partGLControl">partGLControl</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LRC fit usually weights NEE records by its uncertainty. In order
to also use
records with missing <code>NEESdVar</code>, uncertainty of the missing values
is by default set
to a conservatively high value, parameterized by
<code>controlGLPart$replaceMissingSdNEEParms)</code>.
Controlled by argument <code>replaceMissingSdNEEParms</code> in
<code><a href="#topic+partGLControl">partGLControl</a></code>, but overruled
by argument <code>neglectNEEUncertaintyOnMissing</code>.</p>


<h3>Value</h3>

<p>a data.frame with columns
</p>
<table role = "presentation">
<tr><td><code>sDateTime</code></td>
<td>
<p>first column of <code>ds</code>,
usually the time stamp
not used, but usually first column is a DateTime is kept
for aiding debug</p>
</td></tr>
<tr><td><code>NEE</code></td>
<td>
<p>NEE filtered for quality flay</p>
</td></tr>
<tr><td><code>sdNEE</code></td>
<td>
<p>standard deviation of NEE
with missing values replaced</p>
</td></tr>
<tr><td><code>Temp</code></td>
<td>
<p>Temperature, quality filtered
if isTRUE(controlGLPart$isFilterMeteoQualityFlag)</p>
</td></tr>
<tr><td><code>VPD</code></td>
<td>
<p>Water pressure deficit, quality
filtered if isTRUE(controlGLPart$isFilterMeteoQualityFlag)</p>
</td></tr>
<tr><td><code>Rg</code></td>
<td>
<p>Incoming radiation</p>
</td></tr>
<tr><td><code>isDay</code></td>
<td>
<p>Flag that is true for daytime records</p>
</td></tr>
<tr><td><code>isNight</code></td>
<td>
<p>Flag that is true for nighttime records
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='partitionNEEGL'>partitionNEEGL</h2><span id='topic+partitionNEEGL'></span>

<h3>Description</h3>

<p>Partition NEE fluxes into GP and Reco using the daytime method.</p>


<h3>Usage</h3>

<pre><code class='language-R'>partitionNEEGL(ds, NEEVar = if (!missing(NEEVar.s)) NEEVar.s else paste0("NEE", 
    suffixDash, "_f"), TempVar = if (!missing(TempVar.s)) TempVar.s else "Tair_f", 
    VPDVar = if (!missing(VPDVar.s)) VPDVar.s else "VPD_f", 
    RadVar = if (!missing(RadVar.s)) RadVar.s else "Rg_f", 
    suffix = if (!missing(Suffix.s)) Suffix.s else "", 
    NEEVar.s, TempVar.s, VPDVar.s, RadVar.s, 
    Suffix.s, ..., controlGLPart = partGLControl(), 
    isVerbose = TRUE, nRecInDay = 48L, lrcFitter = RectangularLRCFitter())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partitionNEEGL_+3A_ds">ds</code></td>
<td>
<p>dataset with all the specified input columns
and full days in equidistant times</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_neevar">NEEVar</code></td>
<td>
<p>Variable of NEE</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_tempvar">TempVar</code></td>
<td>
<p>Filled air or soil temperature variable (degC)</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_vpdvar">VPDVar</code></td>
<td>
<p>Filled Vapor Pressure Deficit - VPD - (hPa)</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_radvar">RadVar</code></td>
<td>
<p>Filled radiation variable</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_suffix">suffix</code></td>
<td>
<p>string inserted into column names before
identifier for NEE column defaults
(see <code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code>).</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_neevar.s">NEEVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_tempvar.s">TempVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_vpdvar.s">VPDVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_radvar.s">RadVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_suffix.s">Suffix.s</code></td>
<td>
<p>deprecated
identifier for NEE column defaults
(see <code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code>).</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_...">...</code></td>
<td>
<p>further arguments to
<code><a href="#topic+partGLExtractStandardData">partGLExtractStandardData</a></code>, such as <code>PotRadVar</code></p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_controlglpart">controlGLPart</code></td>
<td>
<p>further default parameters,
see <code><a href="#topic+partGLControl">partGLControl</a></code></p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_isverbose">isVerbose</code></td>
<td>
<p>set to FALSE to suppress output messages</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_nrecinday">nRecInDay</code></td>
<td>
<p>number of records within one day
(for half-hourly data its 48)</p>
</td></tr>
<tr><td><code id="partitionNEEGL_+3A_lrcfitter">lrcFitter</code></td>
<td>
<p>R5 class instance
responsible for fitting the light response curve.
Current possibilities are <code>RectangularLRCFitter()</code>,
<code>NonrectangularLRCFitter()</code>,
and <code>LogisticSigmoidLRCFitter()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Daytime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)
</p>
<p>The fit to the light-response-curve is done by default using the Rectangular
hyperbolic function, as in Lasslop et al. (2010)
Alternative fittings can be used by providing the corresponding subclass of
<code><a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter-class</a></code> to <code>lrcFitter</code> argument.
(see <code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a></code>)
</p>
<p>While the extrapolation uses filled data, the parameter optimization
may use only measured data, i.e. with specified quality flag.
Even with using filled VPD, there may be large gaps that have not been
filled.
With the common case where VPD is missing for fitting the LRC, by default
(with <code>controlGLPart$isRefitMissingVPDWithNeglectVPDEffect = TRUE</code>)
is to redo the estimation of LRC parameters with neglecting the VPD-effect.
Next, in the predictions (rows) with missing VPD are then replaced
with predictions
based on LRC-fits that neglected the VPD effect.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Reco_DT_&lt;suffix&gt;</code></td>
<td>
<p>predicted ecosystem respiration: mumol CO2/m2/s</p>
</td></tr>
<tr><td><code>GPP_DT_&lt;suffix&gt;</code></td>
<td>
<p>predicted gross primary production mumol CO2/m2/s</p>
</td></tr>
<tr><td><code>&lt;LRC&gt;</code></td>
<td>
<p>Further light response curve (LRC) parameters and
their standard deviation depend on the used LRC
(e.g. for the non-rectangular LRC
see <code><a href="#topic+NonrectangularLRCFitter_getParameterNames">NonrectangularLRCFitter_getParameterNames</a></code>).
They are estimated for windows and are reported with the first record
of the window</p>
</td></tr>
<tr><td><code>FP_VARnight</code></td>
<td>
<p>NEE filtered
for nighttime records (others NA)</p>
</td></tr>
<tr><td><code>FP_VARday</code></td>
<td>
<p>NEE filtered for daytime
records (others NA)</p>
</td></tr>
<tr><td><code>NEW_FP_Temp</code></td>
<td>
<p>temperature after filtering for quality
flag degree Celsius</p>
</td></tr>
<tr><td><code>NEW_FP_VPD</code></td>
<td>
<p>vapour pressure deficit after filtering
for quality flag, hPa</p>
</td></tr>
<tr><td><code>FP_RRef_Night</code></td>
<td>
<p>basal respiration estimated
from nighttime (W / m2)</p>
</td></tr>
<tr><td><code>FP_qc</code></td>
<td>
<p>quality flag: 0: good parameter fit,
1: some parameters out of range, required refit,
2: next parameter estimate is more than two weeks away</p>
</td></tr>
<tr><td><code>FP_dRecPar</code></td>
<td>
<p>records until or after closest record
that has a parameter estimate associated</p>
</td></tr>
<tr><td><code>FP_errorcode</code></td>
<td>
<p>information why LRC-fit was not
successful or was rejected, see result of
<code><a href="#topic+LightResponseCurveFitter_fitLRC">LightResponseCurveFitter_fitLRC</a></code></p>
</td></tr>
<tr><td><code>FP_GPP2000</code></td>
<td>
<p>predicted GPP at VPD = 0 and PAR = 2000:
a surrogate for maximum photosynthetic capacity</p>
</td></tr>
<tr><td><code>FP_OPT_VPD</code></td>
<td>
<p>list object
of fitting results including iOpt and covParms</p>
</td></tr>
<tr><td><code>FP_OPT_NoVPD</code></td>
<td>
<p>same as
FP_OPT_VPD holding optimization results with fit
neglecting the VPD effect
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Lasslop G, Reichstein M, Papale D, et al. (2010) Separation of
net ecosystem exchange into assimilation and respiration using
a light response curve approach: critical issues and global evaluation.
Global Change Biology, Volume 16, Issue 1, Pages 187-208</p>


<h3>See Also</h3>

<p><code>partGLFitNightTimeTRespSens</code>
</p>
<p><code>partGLFitLRCWindows</code>
</p>
<p><code>partGLInterpolateFluxes</code></p>

<hr>
<h2 id='POSIXctToBerkeleyJulianDate'>POSIXctToBerkeleyJulianDate</h2><span id='topic+POSIXctToBerkeleyJulianDate'></span>

<h3>Description</h3>

<p>convert POSIXct to JulianDate format used in Berkeley release</p>


<h3>Usage</h3>

<pre><code class='language-R'>POSIXctToBerkeleyJulianDate(sDateTime, tz = getTZone(sDateTime))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="POSIXctToBerkeleyJulianDate_+3A_sdatetime">sDateTime</code></td>
<td>
<p>POSIXct vector</p>
</td></tr>
<tr><td><code id="POSIXctToBerkeleyJulianDate_+3A_tz">tz</code></td>
<td>
<p>time zone attribute, such as &quot;etc/GMT-1&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the Berkeley-Release of the Fluxnet data, the time is stored as an number
with base10-digits representing YYYYMMddhhmm</p>


<h3>Author(s)</h3>

<p>TW,
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerkeleyJulianDateToPOSIXct">BerkeleyJulianDateToPOSIXct</a></code>,</p>

<hr>
<h2 id='read_from_ameriflux22'>Extract basic variables from Ameriflux standard (as of 2022) data.frames</h2><span id='topic+read_from_ameriflux22'></span>

<h3>Description</h3>

<p>NEE is read from FC, Rg from SW_in, VPD is computed from RH and Tair.
Non-storage corrected LE and H are read.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_from_ameriflux22(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_from_ameriflux22_+3A_df">df</code></td>
<td>
<p>data.frame: with columns FC, SW_IN, RH, TA, USTAR, L and E</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.Frame with columns
DateTime, NEE,	Rg,	Tair,	rH,	VPD, Ustar, LE, H
</p>

<hr>
<h2 id='read_from_fluxnet15'>extract REddyProc input columns from data.frame in Fluxnet15 format</h2><span id='topic+read_from_fluxnet15'></span>

<h3>Description</h3>

<p>Column format as described at
https://fluxnet.org/data/fluxnet2015-dataset/fullset-data-product/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_from_fluxnet15(ds, colname_NEE = "NEE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_from_fluxnet15_+3A_ds">ds</code></td>
<td>
<p>data.frame with columns TIMESTAMP_END (Time YYYYMMDDHHMM),
NEE, LE, H, USTAR, TA, TS, VPD, SW_IN and optionally USTAR_QC</p>
</td></tr>
<tr><td><code id="read_from_fluxnet15_+3A_colname_nee">colname_NEE</code></td>
<td>
<p>name (scalar string) of column that reports NEE observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If input has numeric column USTAR_QC then USTAR of records
with USTAR_QC &gt; 2 are set to NA.
</p>


<h3>Value</h3>

<p>data.frame with additional columns 'DateTime', 'NEE','Ustar' and
'Rg','Tair','Tsoil' if columns 'SW_IN','TA', or 'TS' are present respectively
</p>

<hr>
<h2 id='RectangularLRCFitter'>RectangularLRCFitter</h2><span id='topic+RectangularLRCFitter'></span>

<h3>Description</h3>

<p>Constructs an instance of class <code><a href="#topic+RectangularLRCFitter-class">RectangularLRCFitter-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RectangularLRCFitter(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RectangularLRCFitter_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='RectangularLRCFitter_predictGPP'>RectangularLRCFitter predictGPP</h2><span id='topic+RectangularLRCFitter_predictGPP'></span>

<h3>Description</h3>

<p>Rectangular hyperbolic Light Response function for GPP</p>


<h3>Usage</h3>

<pre><code class='language-R'>RectangularLRCFitter_predictGPP(Rg, Amax, 
    alpha)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RectangularLRCFitter_predictGPP_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[mumol / m2 / s] or Global Radiation</p>
</td></tr>
<tr><td><code id="RectangularLRCFitter_predictGPP_+3A_amax">Amax</code></td>
<td>
<p>vector of length(Rg): saturation (beta parameter) adjusted
for effect of VPD for each line of Rg</p>
</td></tr>
<tr><td><code id="RectangularLRCFitter_predictGPP_+3A_alpha">alpha</code></td>
<td>
<p>numeric scalar or vector of length(Rg): alpha parameter:
slope at Rg = 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length(Rg) of GPP</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+LightResponseCurveFitter_predictGPP">LightResponseCurveFitter_predictGPP</a></code></p>

<hr>
<h2 id='RectangularLRCFitter-class'>Class <code>"RectangularLRCFitter"</code></h2><span id='topic+RectangularLRCFitter-class'></span>

<h3>Description</h3>

<p>Common rectangular hyperbolic light-response curve fitting.
</p>


<h3>Extends</h3>

<p>Class <code>"<a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter</a>"</code>, directly.
</p>
<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>computeGPPGradient(Rg, Amax, alpha)</code>:</dt><dd><p> ~~ </p>
</dd>
<dt><code>predictGPP(Rg, Amax, alpha)</code>:</dt><dd><p> ~~ </p>
</dd>
</dl>

<p>The following methods are inherited (from the corresponding class):
predictGPP (&quot;LightResponseCurveFitter&quot;), getParameterNames (&quot;LightResponseCurveFitter&quot;), fitLRC (&quot;LightResponseCurveFitter&quot;), getPriorLocation (&quot;LightResponseCurveFitter&quot;), getPriorScale (&quot;LightResponseCurveFitter&quot;), getParameterInitials (&quot;LightResponseCurveFitter&quot;), optimLRCBounds (&quot;LightResponseCurveFitter&quot;), getOptimizedParameterPositions (&quot;LightResponseCurveFitter&quot;), optimLRCOnAdjustedPrior (&quot;LightResponseCurveFitter&quot;), isParameterInBounds (&quot;LightResponseCurveFitter&quot;), optimLRC (&quot;LightResponseCurveFitter&quot;), computeCost (&quot;LightResponseCurveFitter&quot;), predictLRC (&quot;LightResponseCurveFitter&quot;), computeLRCGradient (&quot;LightResponseCurveFitter&quot;)
</p>


<h3>Author(s)</h3>

<p>TW</p>

<hr>
<h2 id='RectangularLRCFitterCVersion'>RectangularLRCFitterCVersion</h2><span id='topic+RectangularLRCFitterCVersion'></span>

<h3>Description</h3>

<p>Constructs an instance of class <code><a href="#topic+RectangularLRCFitterCVersion-class">RectangularLRCFitterCVersion-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RectangularLRCFitterCVersion(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RectangularLRCFitterCVersion_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='RectangularLRCFitterCVersion-class'>Class <code>"RectangularLRCFitterCVersion"</code></h2><span id='topic+RectangularLRCFitterCVersion-class'></span>

<h3>Description</h3>

<p>Common rectangular hyperbolic light-response curve fitting, implemented with faster C-based cost function.
</p>


<h3>Extends</h3>

<p>Class <code>"<a href="#topic+RectangularLRCFitter-class">RectangularLRCFitter</a>"</code>, directly.
Class <code>"<a href="#topic+LightResponseCurveFitter-class">LightResponseCurveFitter</a>"</code>, by class &quot;RectangularLRCFitter&quot;, distance 2.
</p>
<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Methods</h3>


<dl>
<dt><code>computeCost(thetaOpt, theta, iOpt, flux, sdFlux, parameterPrior, sdParameterPrior, ..., VPD0, fixVPD)</code>:</dt><dd><p> ~~ </p>
</dd>
</dl>

<p>The following methods are inherited (from the corresponding class):
computeCost (&quot;LightResponseCurveFitter&quot;), computeLRCGradient (&quot;LightResponseCurveFitter&quot;), predictGPP (&quot;RectangularLRCFitter&quot;), predictLRC (&quot;LightResponseCurveFitter&quot;), optimLRC (&quot;LightResponseCurveFitter&quot;), isParameterInBounds (&quot;LightResponseCurveFitter&quot;), optimLRCOnAdjustedPrior (&quot;LightResponseCurveFitter&quot;), getOptimizedParameterPositions (&quot;LightResponseCurveFitter&quot;), optimLRCBounds (&quot;LightResponseCurveFitter&quot;), getParameterInitials (&quot;LightResponseCurveFitter&quot;), getPriorScale (&quot;LightResponseCurveFitter&quot;), getPriorLocation (&quot;LightResponseCurveFitter&quot;), fitLRC (&quot;LightResponseCurveFitter&quot;), getParameterNames (&quot;LightResponseCurveFitter&quot;), predictGPP (&quot;LightResponseCurveFitter&quot;), computeGPPGradient (&quot;RectangularLRCFitter&quot;)
</p>

<hr>
<h2 id='REddyProc_defaultunits'>Get the default units for given variables</h2><span id='topic+REddyProc_defaultunits'></span>

<h3>Description</h3>

<p>Get the default units for given variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>REddyProc_defaultunits(variable_names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="REddyProc_defaultunits_+3A_variable_names">variable_names</code></td>
<td>
<p>string vector of variables to query units for</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string vector with units, NA for non-standard variables.
</p>

<hr>
<h2 id='renameVariablesInDataframe'>renameVariablesInDataframe</h2><span id='topic+renameVariablesInDataframe'></span>

<h3>Description</h3>

<p>Rename the column names of a data.frame according to a given mapping</p>


<h3>Usage</h3>

<pre><code class='language-R'>renameVariablesInDataframe(data.F, mapping = getBGC05ToAmerifluxVariableNameMapping())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="renameVariablesInDataframe_+3A_data.f">data.F</code></td>
<td>
<p>data.frame whose columns should be renamed</p>
</td></tr>
<tr><td><code id="renameVariablesInDataframe_+3A_mapping">mapping</code></td>
<td>
<p>named character vector:
specifying a renaming (name -&gt; value)
of the variables, see e.g.
<code><a href="#topic+getAmerifluxToBGC05VariableNameMapping">getAmerifluxToBGC05VariableNameMapping</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW,
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='RHLightResponseCostC'>RHLightResponseCostC</h2><span id='topic+RHLightResponseCostC'></span><span id='topic+_REddyProc_RHLightResponseCostC'></span>

<h3>Description</h3>

<p>Computing residual sum of squares for predictions vs. data of NEE implemented
in C. See <code><a href="#topic+LightResponseCurveFitter_computeCost">LightResponseCurveFitter_computeCost</a></code> for a description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RHLightResponseCostC(theta, flux, sdFlux,
    parameterPrior, sdParameterPrior, Rg,
    VPD, Temp, VPD0, fixVPD)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RHLightResponseCostC_+3A_theta">theta</code></td>
<td>
<p>parameter vector with positions as in argument of
<code><a href="#topic+LightResponseCurveFitter_getParameterNames">LightResponseCurveFitter_getParameterNames</a></code>
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_flux">flux</code></td>
<td>
<p>numeric: NEP (-NEE) or GPP time series [umolCO2 / m2 / s],
should not contain NA
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_sdflux">sdFlux</code></td>
<td>
<p>numeric: standard deviation of Flux [umolCO2 / m2 / s],
should not contain NA
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_parameterprior">parameterPrior</code></td>
<td>
<p>numeric vector along theta: prior estimate of
parameter (range of values)
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_sdparameterprior">sdParameterPrior</code></td>
<td>
<p>standard deviation of parameterPrior
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_rg">Rg</code></td>
<td>
<p>ppfd [numeric] -&gt; photosynthetic flux density
[umol / m2 / s] or Global Radiation
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_vpd">VPD</code></td>
<td>
<p>VPD [numeric] -&gt; Vapor Pressure Deficit [hPa]
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_temp">Temp</code></td>
<td>
<p>Temp [degC] -&gt; Temperature [degC]
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_vpd0">VPD0</code></td>
<td>
<p>VPD0 [hPa] -&gt; Parameters VPD0 fixed to 10 hPa
</p>
</td></tr>
<tr><td><code id="RHLightResponseCostC_+3A_fixvpd">fixVPD</code></td>
<td>
<p>boolean scalar or vector of nrow theta:
fixVPD if TRUE the VPD effect is not considered and VPD is not part
of the computation
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='sEddyProc'>sEddyProc</h2><span id='topic+sEddyProc'></span>

<h3>Description</h3>

<p> create an instance of class <code><a href="#topic+sEddyProc-class">sEddyProc-class</a></code> </p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_+3A_...">...</code></td>
<td>
<p>not used.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)</p>

<hr>
<h2 id='sEddyProc_initialize'>sEddyProc initialize</h2><span id='topic+sEddyProc_initialize'></span>

<h3>Description</h3>

<p>Initializing sEddyProc class during <code>sEddyProc$new</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_initialize(ID = ID.s, Data = Data.F, 
    ColNames = c("NEE", "Rg", "Tair", "VPD", 
        "Ustar"), ColPOSIXTime = "DateTime", 
    DTS = if (!missing(DTS.n)) DTS.n else 48, 
    ColNamesNonNumeric = character(0), LatDeg = NA_real_, 
    LongDeg = if (!missing(Long_deg.n)) Long_deg.n else NA_real_, 
    TimeZoneHour = if (!missing(TimeZone_h.n)) TimeZone_h.n else NA_integer_, 
    ID.s, Data.F, ColNames.V.s, ColPOSIXTime.s, 
    DTS.n, ColNamesNonNumeric.V.s, Lat_deg.n, 
    Long_deg.n, TimeZone_h.n, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_initialize_+3A_id">ID</code></td>
<td>
<p>String with site ID</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_data">Data</code></td>
<td>
<p>Data frame with at least three month
of (half-)hourly site-level eddy data</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colnames">ColNames</code></td>
<td>
<p>Vector with
selected column names, the fewer columns the faster the processing.
The default specifies column names assumed in further processing.</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colposixtime">ColPOSIXTime</code></td>
<td>
<p>Column name with POSIX time stamp</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_dts">DTS</code></td>
<td>
<p>Daily time steps</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colnamesnonnumeric">ColNamesNonNumeric</code></td>
<td>
<p>Names of columns that should not
be checked for numeric type, e.g. season column</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_latdeg">LatDeg</code></td>
<td>
<p>Latitude
in (decimal) degrees (-90 to + 90)</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_longdeg">LongDeg</code></td>
<td>
<p>Longitude
in (decimal) degrees (-180 to + 180)</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_timezonehour">TimeZoneHour</code></td>
<td>
<p>Time
zone: hours shift to UTC, e.g. 1 for Berlin</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_id.s">ID.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_data.f">Data.F</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colnames.v.s">ColNames.V.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colposixtime.s">ColPOSIXTime.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_dts.n">DTS.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_colnamesnonnumeric.v.s">ColNamesNonNumeric.V.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_lat_deg.n">Lat_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_long_deg.n">Long_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_timezone_h.n">TimeZone_h.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_initialize_+3A_...">...</code></td>
<td>
<p>('...' required for initialization of class fields)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time stamp must be provided in POSIX format, see also
<code><a href="#topic+fConvertTimeToPosix">fConvertTimeToPosix</a></code>.
For required properties of the time series, see <code><a href="#topic+fCheckHHTimeSeries">fCheckHHTimeSeries</a></code>.
</p>
<p>Internally the half-hour time stamp is shifted to the middle of the
measurement period (minus 15 minutes or 30 minutes).
</p>
<p>All other columns may only contain numeric data.
Please use NA as a gap flag for missing data or low quality data not to
be used in the processing.
The columns are also checked for plausibility with warnings if outside range.
</p>
<p>There are several fields initialized within the class.
</p>
<p>sID is a string for the site ID.
</p>
<p>sDATA is a data frame with site data.
</p>
<p>sTEMP is a temporal data frame with the processing results.
</p>
<p>sINFO is a list containing the time series information:</p>

<dl>
<dt>DIMS</dt><dd><p>Number of data rows</p>
</dd>
<dt>DTS</dt><dd><p>Number of daily time steps (24 or 48)</p>
</dd>
<dt>Y.START</dt><dd><p>Starting year</p>
</dd>
<dt>Y.END</dt><dd><p>Ending year</p>
</dd>
<dt>Y.NUMS</dt><dd><p>Number of years</p>
</dd>
<dt>Y.NAME</dt><dd><p>Name for years</p>
</dd>
</dl>

<p><code>sUSTAR_SCEN</code> a data.frame 	with first column the season, and other
columns different uStar threshold estimates, as returned by
<code><a href="#topic+usGetAnnualSeasonUStarMap">usGetAnnualSeasonUStarMap</a></code>
</p>
<p>sLOCATION is a list of information on site location and timezone
(see <code><a href="#topic+sEddyProc_sSetLocationInfo">sEddyProc_sSetLocationInfo</a></code>).
</p>
<p>sTEMP is a data frame used only temporally.</p>


<h3>Value</h3>

<p>Initialized fields of sEddyProc.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sApplyUStarScen'>sEddyProc sApplyUStarScen</h2><span id='topic+sEddyProc_sApplyUStarScen'></span>

<h3>Description</h3>

<p>apply a function with changing the suffix argument</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sApplyUStarScen(FUN, ..., uStarScenKeep = character(0), 
    warnOnOtherErrors = FALSE, uStarSuffixes = .self$sGetUstarSuffixes())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sApplyUStarScen_+3A_fun">FUN</code></td>
<td>
<p>function to be applied</p>
</td></tr>
<tr><td><code id="sEddyProc_sApplyUStarScen_+3A_...">...</code></td>
<td>
<p>further arguments to FUN</p>
</td></tr>
<tr><td><code id="sEddyProc_sApplyUStarScen_+3A_ustarscenkeep">uStarScenKeep</code></td>
<td>
<p>Scalar string specifying the scenario
for which to keep parameters. If not specified defaults to the first
entry in <code>uStarSuffixes</code>.</p>
</td></tr>
<tr><td><code id="sEddyProc_sApplyUStarScen_+3A_warnonothererrors">warnOnOtherErrors</code></td>
<td>
<p>Set to only display a warning on errors in
uStarScenarios other than uStarScenKeep instead of stopping.</p>
</td></tr>
<tr><td><code id="sEddyProc_sApplyUStarScen_+3A_ustarsuffixes">uStarSuffixes</code></td>
<td>
<p>Vector of suffixed
&lt;&lt; describing the uStar scenarios</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When repeating computations, some of the
output variables maybe replaced. Argument <code>uStarKeep</code>
allows to select the scenario which is computed last,
and hence to which output columns refer to.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sCalcPotRadiation'>sEddyProc sCalcPotRadiation</h2><span id='topic+sEddyProc_sCalcPotRadiation'></span>

<h3>Description</h3>

<p>compute potential radiation from position and time</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sCalcPotRadiation(useSolartime = TRUE, 
    useSolartime.b)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sCalcPotRadiation_+3A_usesolartime">useSolartime</code></td>
<td>
<p>by default
corrects hour (given in local winter time)
for latitude to solar time(where noon is exactly at 12:00).
Set this to FALSE to directly use local winter time</p>
</td></tr>
<tr><td><code id="sEddyProc_sCalcPotRadiation_+3A_usesolartime.b">useSolartime.b</code></td>
<td>
<p>by default corrects hour (given in local winter time)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>column PotRad_NEW in sTEMP</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sEstimateUstarScenarios'>sEddyProc sEstimateUstarScenarios</h2><span id='topic+sEddyProc_sEstimateUstarScenarios'></span>

<h3>Description</h3>

<p>Estimate the distribution of u* threshold by bootstrapping over data</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sEstimateUstarScenarios(ctrlUstarEst = usControlUstarEst(), 
    ctrlUstarSub = usControlUstarSubsetting(), 
    UstarColName = "Ustar", NEEColName = "NEE", 
    TempColName = "Tair", RgColName = "Rg", 
    ..., seasonFactor = usCreateSeasonFactorMonth(sDATA$sDateTime), 
    nSample = 200L, probs = c(0.05, 0.5, 
        0.95), isVerbose = TRUE, suppressWarningsAfterFirst = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_ctrlustarest">ctrlUstarEst</code></td>
<td>
<p>control parameters
for estimating uStar on a single binned series,
see <code><a href="#topic+usControlUstarEst">usControlUstarEst</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_ctrlustarsub">ctrlUstarSub</code></td>
<td>
<p>control parameters
for subsetting time series (number of temperature and Ustar classes
...), see <code><a href="#topic+usControlUstarSubsetting">usControlUstarSubsetting</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_ustarcolname">UstarColName</code></td>
<td>
<p>column name for UStar</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_neecolname">NEEColName</code></td>
<td>
<p>column name for NEE</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_tempcolname">TempColName</code></td>
<td>
<p>column name for air temperature</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_rgcolname">RgColName</code></td>
<td>
<p>column name for solar radiation for
omitting night time data</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+sEddyProc_sEstUstarThreshold">sEddyProc_sEstUstarThreshold</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_seasonfactor">seasonFactor</code></td>
<td>
<p>factor of
seasons to split (data is resampled only within the seasons)</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_nsample">nSample</code></td>
<td>
<p>the number of repetitions in the bootstrap</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_probs">probs</code></td>
<td>
<p>the quantiles of the bootstrap sample
to return. Default is the 5%, median and 95% of the bootstrap</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_isverbose">isVerbose</code></td>
<td>
<p>set to FALSE to omit printing progress</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstimateUstarScenarios_+3A_suppresswarningsafterfirst">suppressWarningsAfterFirst</code></td>
<td>
<p>set to FALSE to show also warnings
for all bootstrap estimates instead of only the first bootstrap sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice of the criterion for sufficiently turbulent conditions
(u * &gt; chosen threshold)
introduces large uncertainties in calculations based on gap-filled Eddy data.
Hence, it is good practice to compare derived quantities based on
gap-filled data using a range of u * threshold estimates.
</p>
<p>This method explores the probability density of the threshold by
repeating its estimation
on a bootstrapped sample.
By default it returns the 90% confidence interval (argument <code>probs</code>).
For larger intervals the sample number need to be
increased (argument <code>probs</code>).
</p>
<dl>
<dt>Quality Assurance</dt><dd>
<p>If more than <code>ctrlUstarEst$minValidBootProp</code>
(default 40%) did not report a threshold,
no quantiles (i.e. NA) are reported.
</p>
</dd></dl>


<h3>Value</h3>

<p>updated class. Request results by
<code><a href="#topic+sEddyProc_sGetEstimatedUstarThresholdDistribution">sEddyProc_sGetEstimatedUstarThresholdDistribution</a></code></p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sEstUstarThold">sEddyProc_sEstUstarThold</a></code>
, <code><a href="#topic+sEddyProc_sGetEstimatedUstarThresholdDistribution">sEddyProc_sGetEstimatedUstarThresholdDistribution</a></code>
, <code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code>
, <code><a href="#topic+sEddyProc_sMDSGapFillUStarScens">sEddyProc_sMDSGapFillUStarScens</a></code></p>

<hr>
<h2 id='sEddyProc_sEstUstarThold'>sEddyProc$sEstUstarThreshold - Estimating ustar threshold</h2><span id='topic+sEddyProc_sEstUstarThold'></span>

<h3>Description</h3>

<p>Calling <code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code> for class data and storing results</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sEstUstarThold(UstarColName = "Ustar", 
    NEEColName = "NEE", TempColName = "Tair", 
    RgColName = "Rg", ..., seasonFactor = usCreateSeasonFactorMonth(sDATA$sDateTime))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_ustarcolname">UstarColName</code></td>
<td>
<p>column name for UStar</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_neecolname">NEEColName</code></td>
<td>
<p>column name for NEE</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_tempcolname">TempColName</code></td>
<td>
<p>column name for air temperature</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_rgcolname">RgColName</code></td>
<td>
<p>column name for solar radiation for
omitting night time data</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_...">...</code></td>
<td>
<p>further arguments to
<code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThold_+3A_seasonfactor">seasonFactor</code></td>
<td>
<p>factor of
seasons to split</p>
</td></tr>
</table>


<h3>Value</h3>

<p>result component <code>uStarTh</code> of <code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code>.
In addition the result is stored in class variable <code>sUSTAR_DETAILS</code>.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sEstUstarThreshold'>sEddyProc$sEstUstarThreshold - Estimating ustar threshold</h2><span id='topic+sEddyProc_sEstUstarThreshold'></span>

<h3>Description</h3>

<p>Calling <code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code> for class data and storing results</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sEstUstarThreshold(UstarColName = "Ustar", 
    NEEColName = "NEE", TempColName = "Tair", 
    RgColName = "Rg", ..., isWarnDeprecated = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_ustarcolname">UstarColName</code></td>
<td>
<p>column name for UStar</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_neecolname">NEEColName</code></td>
<td>
<p>column name for NEE</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_tempcolname">TempColName</code></td>
<td>
<p>column name for air temperature</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_rgcolname">RgColName</code></td>
<td>
<p>column name for solar radiation for
omitting night time data</p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_...">...</code></td>
<td>
<p>further arguments to
<code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sEstUstarThreshold_+3A_iswarndeprecated">isWarnDeprecated</code></td>
<td>
<p>set to FALSE to avoid deprecated warning.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>result of <code><a href="#topic+usEstUstarThreshold">usEstUstarThreshold</a></code>. In addition the
result is stored in class variable sUSTAR_DETAILS and the bins as
additional columns to sTemp</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sEstUstarThresholdDistribution'>sEddyProc sEstUstarThresholdDistribution</h2><span id='topic+sEddyProc_sEstUstarThresholdDistribution'></span>

<h3>Description</h3>

<p>Estimate the distribution of u* threshold by bootstrapping over data</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sEstUstarThresholdDistribution(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sEstUstarThresholdDistribution_+3A_...">...</code></td>
<td>
<p>further parameters to
<code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method returns the results directly, without modifying
the class. It is there for portability reasons. Recommended is
using method <code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code> to
update the class and then getting the results from the class by
<code><a href="#topic+sEddyProc_sGetEstimatedUstarThresholdDistribution">sEddyProc_sGetEstimatedUstarThresholdDistribution</a></code>.</p>


<h3>Value</h3>

<p>result of
<code><a href="#topic+sEddyProc_sGetEstimatedUstarThresholdDistribution">sEddyProc_sGetEstimatedUstarThresholdDistribution</a></code></p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sExportData'>sEddyProc sExportData</h2><span id='topic+sEddyProc_sExportData'></span>

<h3>Description</h3>

<p>Export class internal sDATA data frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sExportData()</code></pre>


<h3>Value</h3>

<p>Return data frame sDATA with time stamp shifted back to original.</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_export">help_export</a></code></p>

<hr>
<h2 id='sEddyProc_sExportResults'>sEddyProc sExportResults</h2><span id='topic+sEddyProc_sExportResults'></span>

<h3>Description</h3>

<p>Export class internal sTEMP data frame with result columns</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sExportResults(isListColumnsExported = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sExportResults_+3A_islistcolumnsexported">isListColumnsExported</code></td>
<td>
<p>if TRUE export list columns in addition
to numeric columns,
such as the covariance matrices of the the day-time-partitioning LRC fits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return data frame sTEMP with results.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+help_export">help_export</a></code></p>

<hr>
<h2 id='sEddyProc_sFillInit'>sEddyProc$sFillInit - Initialize gap filling</h2><span id='topic+sEddyProc_sFillInit'></span>

<h3>Description</h3>

<p>Initializes data frame sTEMP for newly generated gap filled data and qualifiers.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sFillInit(Var.s, QFVar.s = "none", 
    QFValue.n = NA_real_, FillAll.b = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sFillInit_+3A_var.s">Var.s</code></td>
<td>
<p>Variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillInit_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>Quality flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillInit_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>Value of quality flag for _good_ (original) data,
other data is set to missing</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillInit_+3A_fillall.b">FillAll.b</code></td>
<td>
<p>Fill all values to estimate uncertainties</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Description of newly generated variables with gap filled data and qualifiers: <br />
</p>
<p>VAR<em>_orig</em> - Original values used for gap filling <br />
VAR<em>_f   </em> - Original values and gaps filled with mean of selected
datapoints (condition depending on gap filling method) <br />
VAR<em>_fqc</em> - Quality flag assigned depending on gap filling method and
window length (0 = original data, 1 = most reliable, 2 = medium, 3 = least reliable) <br />
VAR<em>_fall</em> - All values considered as gaps (for uncertainty estimates) <br />
VAR<em>_fall_qc</em> - Quality flag assigned depending on gap filling method
and window length (1 = most reliable, 2 = medium, 3 = least reliable) <br />
VAR<em>_fnum</em> - Number of datapoints used for gap-filling <br />
VAR<em>_fsd</em> - Standard deviation of datapoints used for gap
filling (uncertainty) <br />
VAR<em>_fmeth</em> - Method used for gap filling (1 = similar meteo
condition (sFillLUT with Rg, VPD, Tair), 2 = similar meteo
(sFillLUT with Rg only), 3 = mean diurnal course (sFillMDC)) <br />
VAR<em>_fwin</em> - Full window length used for gap filling <br />
</p>
<p>Long gaps (larger than 60 days) are not filled.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sFillLUT'>sEddyProc sFillLUT</h2><span id='topic+sEddyProc_sFillLUT'></span>

<h3>Description</h3>

<p>Look-Up Table (LUT) algorithm of up to five conditions within prescribed window size</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sFillLUT(WinDays.i, V1.s = "none", 
    T1.n = NA_real_, V2.s = "none", T2.n = NA_real_, 
    V3.s = "none", T3.n = NA_real_, V4.s = "none", 
    T4.n = NA_real_, V5.s = "none", T5.n = NA_real_, 
    Verbose.b = TRUE, calculate_gapstats = calculate_gapstats_Reichstein05)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sFillLUT_+3A_windays.i">WinDays.i</code></td>
<td>
<p>Window size for filling in days</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_v1.s">V1.s</code></td>
<td>
<p>Condition variable 1</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_t1.n">T1.n</code></td>
<td>
<p>Tolerance interval 1</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_v2.s">V2.s</code></td>
<td>
<p>Condition variable 2</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_t2.n">T2.n</code></td>
<td>
<p>Tolerance interval 2</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_v3.s">V3.s</code></td>
<td>
<p>Condition variable 3</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_t3.n">T3.n</code></td>
<td>
<p>Tolerance interval 3</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_v4.s">V4.s</code></td>
<td>
<p>Condition variable 4</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_t4.n">T4.n</code></td>
<td>
<p>Tolerance interval 4</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_v5.s">V5.s</code></td>
<td>
<p>Condition variable 5</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_t5.n">T5.n</code></td>
<td>
<p>Tolerance interval 5</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_verbose.b">Verbose.b</code></td>
<td>
<p>Print status information to screen</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillLUT_+3A_calculate_gapstats">calculate_gapstats</code></td>
<td>
<p>function computing gap-statistics</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>Quality flags</dt><dd>

<ul>
<li><p> 1: at least one variable and nDay &lt;= 14
</p>
</li>
<li><p> 2: three variables and nDay in [14,56)
or one variable and nDay in  [14,28)
</p>
</li>
<li><p> 3: three variables and nDay &gt; 56
or one variable and nDay &gt; 28
</p>
</li></ul>

</dd></dl>


<h3>Value</h3>

<p>LUT filling results in sTEMP data frame.</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sFillMDC'>sEddyProc sFillMDC</h2><span id='topic+sEddyProc_sFillMDC'></span>

<h3>Description</h3>

<p>Mean Diurnal Course (MDC) algorithm based on average values within +/- one hour of adjacent days</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sFillMDC(WinDays.i, Verbose.b = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sFillMDC_+3A_windays.i">WinDays.i</code></td>
<td>
<p>Window size for filling in days</p>
</td></tr>
<tr><td><code id="sEddyProc_sFillMDC_+3A_verbose.b">Verbose.b</code></td>
<td>
<p>Print status information to screen</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>Quality flag</dt><dd>

<ul>
<li><p> 1: nDay &lt;= 1
</p>
</li>
<li><p> 2: nDay [2,5)
</p>
</li>
<li><p> 3: nDay &gt; 5
</p>
</li></ul>

</dd></dl>


<h3>Value</h3>

<p>MDC filling results in sTEMP data frame.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sFillVPDFromDew'>Estimate VPD from daily minimum temperature</h2><span id='topic+sEddyProc_sFillVPDFromDew'></span>

<h3>Description</h3>

<p>of the data in the class function using <code><a href="#topic+estimate_vpd_from_dew">estimate_vpd_from_dew</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sFillVPDFromDew(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sFillVPDFromDew_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+estimate_vpd_from_dew">estimate_vpd_from_dew</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>side effect of updated column VPDfromDew in class
</p>

<hr>
<h2 id='sEddyProc_sGetData'>sEddyProc sGetData</h2><span id='topic+sEddyProc_sGetData'></span>

<h3>Description</h3>

<p>Get class internal sDATA data frame</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGetData()</code></pre>


<h3>Value</h3>

<p>Return data frame sDATA.</p>


<h3>Author(s)</h3>

<p>AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sGetEstimatedUstarThresholdDistribution'>sEddyProc sGetEstimatedUstarThresholdDistribution</h2><span id='topic+sEddyProc_sGetEstimatedUstarThresholdDistribution'></span>

<h3>Description</h3>

<p>return the results of <code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code></p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGetEstimatedUstarThresholdDistribution()</code></pre>


<h3>Value</h3>

<p>A data.frame with columns <code>aggregationMode</code>, <code>year</code>,
and <code>UStar</code> estimate based on the non-resampled data.
The other columns correspond to the quantiles of Ustar estimate
for given probabilities (argument <code>probs</code>) based on the distribution
of estimates using resampled the data.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code></p>

<hr>
<h2 id='sEddyProc_sGetUstarScenarios'>sEddyProc sGetUstarScenarios</h2><span id='topic+sEddyProc_sGetUstarScenarios'></span>

<h3>Description</h3>

<p>get the current uStar processing scenarios</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGetUstarScenarios()</code></pre>


<h3>Details</h3>

<p>the associated suffixes can be retrieved by
<code>colnames(myClass$sGetUstarScenarios())[-1]</code></p>


<h3>Value</h3>

<p>a data.frame with first column listing each season and
other column a scenario of uStar thresholds.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code></p>

<hr>
<h2 id='sEddyProc_sGetUstarSuffixes'>sEddyProc sGetUstarSuffixes</h2><span id='topic+sEddyProc_sGetUstarSuffixes'></span>

<h3>Description</h3>

<p>get the current uStar suffixes</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGetUstarSuffixes()</code></pre>


<h3>Value</h3>

<p>a character vector of suffixes.
If no uStar thresholds have been estimated, returns character(0)</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sGetUstarScenarios">sEddyProc_sGetUstarScenarios</a></code></p>

<hr>
<h2 id='sEddyProc_sGLFluxPartition'>sEddyProc sGLFluxPartition</h2><span id='topic+sEddyProc_sGLFluxPartition'></span>

<h3>Description</h3>

<p>Daytime-based Flux partitioning after Lasslop et al. (2010)</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGLFluxPartition(..., debug = list(useLocaltime = FALSE), 
    debug.l, isWarnReplaceColumns = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sGLFluxPartition_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="#topic+partitionNEEGL">partitionNEEGL</a></code> in addition to the dataset
such as <code>suffix</code></p>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartition_+3A_debug">debug</code></td>
<td>
<p>List with debugging control.</p>

<dl>
<dt>useLocaltime</dt><dd><p>if TRUE use local time zone instead of
geo-solar time to compute potential radiation</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartition_+3A_debug.l">debug.l</code></td>
<td>
<p>deprecated, renamed to debug</p>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartition_+3A_iswarnreplacecolumns">isWarnReplaceColumns</code></td>
<td>
<p>set to FALSE to avoid the warning on
replacing output columns</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Daytime-based partitioning of measured net ecosystem fluxes into gross
primary production (GPP)
and ecosystem respiration (Reco)</p>


<h3>Value</h3>

<p>Flux partitioning results are in sTEMP data frame of the class.</p>


<h3>Author(s)</h3>

<p>MM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Lasslop G, Reichstein M, Papale D, et al. (2010) Separation of net
ecosystem exchange into assimilation and respiration using
a light response curve approach: critical issues and global evaluation.
Global Change Biology, Volume 16, Issue 1, Pages 187-208</p>

<hr>
<h2 id='sEddyProc_sGLFluxPartitionUStarScens'>sEddyProc sGLFluxPartitionUStarScens</h2><span id='topic+sEddyProc_sGLFluxPartitionUStarScens'></span>

<h3>Description</h3>

<p>Flux partitioning after Lasslop et al. (2010)</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sGLFluxPartitionUStarScens(..., 
    isWarnReplaceColumns = FALSE, warnOnOtherErrors = FALSE, 
    controlGLPart = partGLControl())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sGLFluxPartitionUStarScens_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="#topic+sEddyProc_sGLFluxPartition">sEddyProc_sGLFluxPartition</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartitionUStarScens_+3A_iswarnreplacecolumns">isWarnReplaceColumns</code></td>
<td>
<p>overriding default to avoid
the warning on replacing output columns, because this is intended when
processing several uStar scenarios.</p>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartitionUStarScens_+3A_warnonothererrors">warnOnOtherErrors</code></td>
<td>
<p>Set to TRUE to only display a warning on
errors in uStarScenarios other than uStarScenKeep instead of stopping.</p>
</td></tr>
<tr><td><code id="sEddyProc_sGLFluxPartitionUStarScens_+3A_controlglpart">controlGLPart</code></td>
<td>
<p>further default parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Daytime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)
for all u* threshold scenarios.
</p>
<p>argument <code>uStarScenKeep</code> in ... is a scalar string specifying the scenario
for which to keep parameters (see <code><a href="#topic+sEddyProc_sApplyUStarScen">sEddyProc_sApplyUStarScen</a></code>.
Defaults to the first scenario,
which is usually the uStar without bootstrap: &quot;uStar&quot;.
For the uStarScenKeep, a full set of output columns is returned.
For the other scenarios, the bootstrap of GPP uncertainty is omitted
and columns &quot;FP_&lt;x&gt;&quot; are overridden.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sMDSGapFill'>sEddyProc sMDSGapFill</h2><span id='topic+sEddyProc_sMDSGapFill'></span>

<h3>Description</h3>

<p>MDS gap filling algorithm adapted after the PV-Wave code and paper by Markus Reichstein.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMDSGapFill(Var = Var.s, QFVar = if (!missing(QFVar.s)) QFVar.s else "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    V1 = if (!missing(V1.s)) V1.s else "Rg", 
    T1 = if (!missing(T1.n)) T1.n else 50, 
    V2 = if (!missing(V2.s)) V2.s else "VPD", 
    T2 = if (!missing(T2.n)) T2.n else 5, 
    V3 = if (!missing(V3.s)) V3.s else "Tair", 
    T3 = if (!missing(T3.n)) T3.n else 2.5, 
    FillAll = if (!missing(FillAll.b)) FillAll.b else TRUE, 
    isVerbose = if (!missing(Verbose.b)) Verbose.b else TRUE, 
    suffix = if (!missing(Suffix.s)) Suffix.s else "", 
    minNWarnRunLength = if (Var == "NEE") 4 * 
        .self$sINFO$DTS/24 else NA_integer_, 
    Var.s, QFVar.s, QFValue.n, V1.s, T1.n, 
    V2.s, T2.n, V3.s, T3.n, FillAll.b, Verbose.b, 
    Suffix.s, method = "Reichstein05")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_var">Var</code></td>
<td>
<p>Variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality flag
of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value of
quality flag for _good_ (original) data, other data is set to missing</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v1">V1</code></td>
<td>
<p>Condition variable 1
(default: Global radiation 'Rg' in  W m-2)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t1">T1</code></td>
<td>
<p>Tolerance interval 1
(default: 50 W m-2)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v2">V2</code></td>
<td>
<p>Condition variable 2
(default: Vapour pressure deficit 'VPD' in hPa)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t2">T2</code></td>
<td>
<p>Tolerance interval 2
(default: 5 hPa)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v3">V3</code></td>
<td>
<p>Condition variable 3
(default: Air temperature 'Tair' in degC)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t3">T3</code></td>
<td>
<p>Tolerance interval 3
(default: 2.5 degC)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_fillall">FillAll</code></td>
<td>
<p>Fill
all values to estimate uncertainties</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_isverbose">isVerbose</code></td>
<td>
<p>Print
status information to screen</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_suffix">suffix</code></td>
<td>
<p>String
suffix needed for different processing setups on the same dataset
(for explanations see below)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_minnwarnrunlength">minNWarnRunLength</code></td>
<td>
<p>scalar integer:
warn if number of subsequent
numerically equal values exceeds this number.
Set to Inf or NA for no warnings.
defaults for &quot;NEE&quot; to records across 4 hours and no warning for others.</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v1.s">V1.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t1.n">T1.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v2.s">V2.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t2.n">T2.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_v3.s">V3.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_t3.n">T3.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_fillall.b">FillAll.b</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_verbose.b">Verbose.b</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_suffix.s">Suffix.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFill_+3A_method">method</code></td>
<td>
<p>specify &quot;Vekuri23&quot; to use the skewness-bias
reducing variant</p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>Different processing setups on the same dataset</dt><dd>
<p>Attention: When processing the same site data set with different setups for
the gap filling or flux partitioning
(e.g. due to different ustar filters),
a string suffix is needed! This suffix is added to the result column names
to distinguish the results of the different setups.
</p>
</dd></dl>


<h3>Value</h3>

<p>Gap filling results in sTEMP data frame (with renamed columns).</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Reichstein, M. et al. (2005) On the separation of net ecosystem exchange
into assimilation and ecosystem respiration: review and improved algorithm.
Global Change Biology, 11, 1424-1439.</p>

<hr>
<h2 id='sEddyProc_sMDSGapFillAfterUstar'>sEddyProc sMDSGapFillAfterUstar</h2><span id='topic+sEddyProc_sMDSGapFillAfterUstar'></span>

<h3>Description</h3>

<p>sEddyProc$sMDSGapFillAfterUstar - MDS gap filling algorithm after u* filtering</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMDSGapFillAfterUstar(fluxVar, 
    uStarVar = "Ustar", uStarTh = .self$sGetUstarScenarios()[, 
        c("season", uStarSuffix), drop = FALSE], 
    uStarSuffix = "uStar", isFlagEntryAfterLowTurbulence = FALSE, 
    isFilterDayTime = FALSE, swThr = 10, 
    RgColName = "Rg", ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_fluxvar">fluxVar</code></td>
<td>
<p>Flux variable to gap fill after ustar filtering</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_ustarvar">uStarVar</code></td>
<td>
<p>Column name of friction velocity u * (ms-1),
default 'Ustar'</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_ustarth">uStarTh</code></td>
<td>
<p>data.frame with
first column, season names, and second column estimates of uStar Threshold.
Alternatively, a single value to be used as threshold for all records
If only one value is given, it is used for all records.</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_ustarsuffix">uStarSuffix</code></td>
<td>
<p>Different suffixes required are for
different u * scenarios</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_isflagentryafterlowturbulence">isFlagEntryAfterLowTurbulence</code></td>
<td>
<p>Set to TRUE for flagging the
first entry after low turbulence as bad condition (by value of 2).</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_isfilterdaytime">isFilterDayTime</code></td>
<td>
<p>Set to TRUE to also filter day-time values,
default only filters night-time data</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_swthr">swThr</code></td>
<td>
<p>threshold of solar radiation below which data is
marked as night time respiration.</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_rgcolname">RgColName</code></td>
<td>
<p>Column name of incoming short wave radiation</p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUstar_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling <code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code> after filtering for
(provided) friction velocity u*
</p>
<p>The u* threshold(s) are provided with argument <code>uStarTh</code> for
filtering the conditions of low turbulence.
After filtering, the data is gap filled using the MDS algorithm
<code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code>.
</p>
<p>With <code>isFlagEntryAfterLowTurbulence set to TRUE</code>, to be more
conservative, in addition
to the data acquired when uStar is below the threshold,
the first half hour measured with good turbulence conditions
after a period with low turbulence is also removed (Papale et al. 2006).</p>


<h3>Value</h3>

<p>Vector with quality flag from filtering (here 0: good data
, 1: low turbulence, 2: first half hour after low turbulence
, 3: no threshold available, 4: missing uStar value)
Gap filling results are in sTEMP data frame (with renamed columns)
that can be retrieved by <code><a href="#topic+sEddyProc_sExportResults">sEddyProc_sExportResults</a></code>.</p>


<h3>Author(s)</h3>

<p>AMM, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code> and
<code>link{sEddyProc_sEstUstarThold}</code> for estimating the
u* threshold from the data.
</p>
</li>
<li> <p><code><a href="#topic+sEddyProc_sMDSGapFillUStarScens">sEddyProc_sMDSGapFillUStarScens</a></code> for
automated gapfilling for several scenarios of u* threshold estimates.
</p>
</li></ul>

<hr>
<h2 id='sEddyProc_sMDSGapFillAfterUStarDistr'>sEddyProc sMDSGapFillAfterUStarDistr</h2><span id='topic+sEddyProc_sMDSGapFillAfterUStarDistr'></span>

<h3>Description</h3>

<p>gapfilling for several filters of estimated friction velocity Ustar thresholds.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMDSGapFillAfterUStarDistr(..., 
    uStarTh, uStarSuffixes = colnames(uStarTh)[-1])</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMDSGapFillAfterUStarDistr_+3A_...">...</code></td>
<td>
<p>other arguments to
<code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code> and <code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code>
such as <code>fluxVar</code></p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUStarDistr_+3A_ustarth">uStarTh</code></td>
<td>
<p>data.frame with first column, season names,
and remaining columns different estimates of uStar Threshold.
If the data.frame has only one row, then each uStar threshold estimate
is applied to the entire dataset.
Entries in first column must match levels in argument <code>seasonFactor</code></p>
</td></tr>
<tr><td><code id="sEddyProc_sMDSGapFillAfterUStarDistr_+3A_ustarsuffixes">uStarSuffixes</code></td>
<td>
<p>String vector
to distinguish result columns for different ustar values.
Its length must correspond to column numbers in <code>UstarThres.m.n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is superseded by
<code><a href="#topic+sEddyProc_sMDSGapFillUStarScens">sEddyProc_sMDSGapFillUStarScens</a></code> and only there
for backward portability.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sMDSGapFillUStarScens'>sEddyProc sMDSGapFillUStarScens</h2><span id='topic+sEddyProc_sMDSGapFillUStarScens'></span>

<h3>Description</h3>

<p>gapfilling for several filters of estimated friction velocity Ustar thresholds.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMDSGapFillUStarScens(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMDSGapFillUStarScens_+3A_...">...</code></td>
<td>
<p>other arguments to
<code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code> and
<code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a></code>
such as <code>fluxVar</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>sEddyProc$sMDSGapFillUStarDistr: calling
<code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a></code> for several filters of
friction velocity Ustar.
</p>
<p>The scenarios need to be set before by
<code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code> or accepting the defaults
annual estimates of <code>link{sEddyProc_sEstimateUstarScenarios}</code>.
</p>
<p>Then the difference between output columns NEE_U05_f and NEE_U95_f
corresponds to the uncertainty
introduced by the uncertain estimate of the u* threshold.</p>


<h3>Value</h3>

<p>Matrix (columns correspond to u* Scenarios) with quality flag from
filtering ustar (0 - good data, 1 - filtered data)
</p>
<p>Gap filling results in sTEMP data frame (with renamed columns), that
can be retrieved by <code><a href="#topic+sEddyProc_sExportResults">sEddyProc_sExportResults</a></code>.
Each of the outputs is calculated for several u* r-estimates and
distinguished by a suffix after the variable.
E.g. with an an entry &quot;U05&quot; in <code>uStarSuffixes</code> in
<code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code>
the corresponding filled NEE can be found in output column &quot;NEE_U05_f&quot;.</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><a href="../doc/useCase.html">useCase vignette</a></p>

<hr>
<h2 id='sEddyProc_sMRFluxPartition'>sEddyProc sMRFluxPartition</h2><span id='topic+sEddyProc_sMRFluxPartition'></span>

<h3>Description</h3>

<p>Nighttime-based partitioning of net ecosystem fluxes into gross fluxes GPP and REco</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMRFluxPartition(FluxVar = if (missing(FluxVar.s)) "NEE_f" else FluxVar.s, 
    QFFluxVar = if (missing(QFFluxVar.s)) "NEE_fqc" else QFFluxVar.s, 
    QFFluxValue = if (missing(QFFluxValue.n)) 0L else QFFluxValue.n, 
    TempVar = if (missing(TempVar.s)) "Tair_f" else TempVar.s, 
    QFTempVar = if (missing(QFTempVar.s)) "Tair_fqc" else QFTempVar.s, 
    QFTempValue = if (missing(QFTempValue.n)) 0 else QFTempValue.n, 
    RadVar = if (missing(RadVar.s)) "Rg" else RadVar.s, 
    TRef = if (missing(T_ref.n)) 273.15 + 
        15 else T_ref.n, suffix = if (missing(Suffix.s)) "" else Suffix.s, 
    FluxVar.s, QFFluxVar.s, QFFluxValue.n, 
    TempVar.s, QFTempVar.s, QFTempValue.n, 
    RadVar.s, T_ref.n, Suffix.s, debug.l, 
    debug = if (!missing(debug.l)) debug.l else list(useLocaltime = FALSE), 
    parsE0Regression = list())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_fluxvar">FluxVar</code></td>
<td>
<p>Variable
name of column with original and
filled net ecosystem fluxes (NEE)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qffluxvar">QFFluxVar</code></td>
<td>
<p>Quality
flag of NEE variable</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qffluxvalue">QFFluxValue</code></td>
<td>
<p>Value
of quality flag for _good_ (original) data</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_tempvar">TempVar</code></td>
<td>
<p>Filled
air- or soil temperature variable (degC)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qftempvar">QFTempVar</code></td>
<td>
<p>Quality
flag of filled temperature variable</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qftempvalue">QFTempValue</code></td>
<td>
<p>Value
of temperature quality flag for _good_
(original) data</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_radvar">RadVar</code></td>
<td>
<p>Unfilled
(original) radiation variable</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_tref">TRef</code></td>
<td>
<p>Reference
temperature in Kelvin (degK)
used in <code>fLloydTaylor</code> for regressing Flux and Temperature</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_suffix">suffix</code></td>
<td>
<p>String
suffix needed for different processing
setups on the same dataset (for explanations see below)</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_fluxvar.s">FluxVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qffluxvar.s">QFFluxVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qffluxvalue.n">QFFluxValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_tempvar.s">TempVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qftempvar.s">QFTempVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_qftempvalue.n">QFTempValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_radvar.s">RadVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_t_ref.n">T_ref.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_suffix.s">Suffix.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_debug.l">debug.l</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_debug">debug</code></td>
<td>
<p>List
with debugging control
(passed also to <code>sEddyProc_sRegrE0fromShortTerm</code>
for providing <code>fixedE0 = myE0</code>).</p>

<dl>
<dt>useLocaltime</dt><dd><p>see details on solar vs local time</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartition_+3A_parse0regression">parsE0Regression</code></td>
<td>
<p>list
with further parameters passed down to
<code>sEddyProc_sRegrE0fromShortTerm</code> and <code>fRegrE0fromShortTerm</code>,
such as <code>TempRange</code></p>
</td></tr>
</table>


<h3>Details</h3>

<dl>
<dt>
Description of newly generated variables with partitioning results:</dt><dd>

<ul>
<li><p> PotRad - Potential radiation <br />
</p>
</li>
<li><p> FP_NEEnight - Good (original) NEE nighttime fluxes used for flux partitioning <br />
</p>
</li>
<li><p> FP_Temp - Good (original) temperature measurements used for flux partitioning <br />
</p>
</li>
<li><p> E_0 - Estimated temperature sensitivity <br />
</p>
</li>
<li><p> R_ref - Estimated reference respiration <br />
</p>
</li>
<li><p> Reco - Estimated ecosystem respiration <br />
</p>
</li>
<li><p> GPP_f - Estimated gross primary production <br />
</p>
</li></ul>

</dd></dl>

<dl>
<dt>Background</dt><dd>
<p>This partitioning is based on the regression of nighttime respiration with
temperature using the Lloyd-Taylor-Function <code><a href="#topic+fLloydTaylor">fLloydTaylor</a></code>.
First the temperature sensitivity E_0 is estimated from short term data,
see <code>sEddyProc_sRegrE0fromShortTerm</code>.
Next the reference temperature R_ref is estimated for successive periods
throughout the whole dataset (see <code>sEddyProc_sRegrRref</code>).
These estimates are then used to calculate the respiration during daytime
and nighttime and with this GPP.
Attention: Gap filling of the net ecosystem fluxes (NEE) and temperature
measurements (Tair or Tsoil) is required
prior to the partitioning!
</p>
</dd></dl>

<dl>
<dt>Selection of daytime data based on solar time</dt><dd>
<p>The respiration-temperature regression is very
sensitive to the selection of night- and daytime data.
Nighttime is selected by a combined threshold of current solar radiation
and potential radiation.
The current implementation calculates potential radiation based on exact
solar time, based on latitude and longitude.
(see <code><a href="#topic+fCalcPotRadiation">fCalcPotRadiation</a></code>)
Therefore it might differ from implementations that use local winter
clock time instead.
</p>
</dd></dl>

<dl>
<dt>Different processing setups on the same dataset</dt><dd>
<p>Attention: When processing the same site data set with different setups for
the gap filling or flux partitioning
(e.g. due to different ustar filters),
a string suffix is needed! This suffix is added to the result column names
to distinguish the results of the different setups.
If a suffix is provided and if the defaults for FluxVar and QFFluxVar
are used, the suffix will be added to their variable names
(e.g. 'NEE_f' will be renamed to 'NEE_uStar_f' and 'NEE_fqc' to
'NEE_uStar_fqc' for the suffix = 'uStar').
Currently, this works only with defaults of FluxVar = 'NEE_f'
and QFFluxVar = 'NEE_fqc'.
</p>
</dd></dl>


<h3>Value</h3>

<p>Flux partitioning results (see variables in details) in sTEMP data frame
(with renamed columns).
On success, return value is NULL. On failure an integer scalar error code
is returned:
-111 if regression of E_0 failed due to insufficient relationship in the data.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Reichstein M, Falge E, Baldocchi D et al. (2005) On the separation of
net ecosystem exchange
into assimilation and ecosystem respiration: review and improved algorithm.
Global Change Biology, 11, 1424-1439.</p>

<hr>
<h2 id='sEddyProc_sMRFluxPartitionUStarScens'>sEddyProc sMRFluxPartitionUStarScens</h2><span id='topic+sEddyProc_sMRFluxPartitionUStarScens'></span>

<h3>Description</h3>

<p>Flux partitioning after Reichstein et al. (2005)</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sMRFluxPartitionUStarScens(..., 
    uStarScenKeep = character(0))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sMRFluxPartitionUStarScens_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="#topic+sEddyProc_sMRFluxPartition">sEddyProc_sMRFluxPartition</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sMRFluxPartitionUStarScens_+3A_ustarscenkeep">uStarScenKeep</code></td>
<td>
<p>Scalar string specifying the scenario
for which to keep parameters (see <code><a href="#topic+sEddyProc_sApplyUStarScen">sEddyProc_sApplyUStarScen</a></code>.
Defaults to the first scenario.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nighttime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)
for all u* threshold scenarios.</p>


<h3>Value</h3>

<p>NULL, it adds output columns in the class</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotDailySums'>sEddyProc$sPlotDailySums - Image with daily sums of each year</h2><span id='topic+sEddyProc_sPlotDailySums'></span>

<h3>Description</h3>

<p>Generates image in specified format ('pdf' or 'png') with daily sums,
see also <code><a href="#topic+sEddyProc_sPlotDailySumsY">sEddyProc_sPlotDailySumsY</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotDailySums(Var = Var.s, VarUnc = "none", 
    Format = if (!missing(Format.s)) Format.s else "pdf", 
    Dir = if (!missing(Dir.s)) Dir.s else "plots", 
    unit = if (!missing(unit.s)) unit.s else "gC/m2/day", 
    ..., Var.s, VarUnc.s, Format.s, Dir.s, 
    unit.s)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_var">Var</code></td>
<td>
<p>(Filled) variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_varunc">VarUnc</code></td>
<td>
<p>Uncertainty
estimates for variable</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_format">Format</code></td>
<td>
<p>Graphics
file format ('pdf' or 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_dir">Dir</code></td>
<td>
<p>Directory
for plotting</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_unit">unit</code></td>
<td>
<p>unit
of the daily sums</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+sEddyProc_sPlotDailySumsY">sEddyProc_sPlotDailySumsY</a></code>,
such as <code>timeFactor</code> and <code>massFactor</code>.</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_varunc.s">VarUnc.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_format.s">Format.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_dir.s">Dir.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySums_+3A_unit.s">unit.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>KS, AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotDailySumsY'>sEddyProc sPlotDailySumsY</h2><span id='topic+sEddyProc_sPlotDailySumsY'></span>

<h3>Description</h3>

<p>This function first computes the average flux for each day.
If the original unit is not &quot;per day&quot;, then it need to be converted to
&quot;per day&quot; by argument <code>timeFactor</code>.
Furthermore, a change of the mass unit is provided by argument
<code>massFactor</code>.
The default parameters assume original units of mumol CO2 / m2 / second
and convert to gC / m2 / day.
The conversion factors allow plotting variables with different units</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotDailySumsY(Var, VarUnc = "none", 
    Year, timeFactor = 3600 * 24, massFactor = (44.0096/1e+06) * 
        (12.011/44.0096), unit = "gC/m2/day", 
    dts = sINFO$DTS, data = cbind(sDATA, 
        sTEMP))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_var">Var</code></td>
<td>
<p>(Filled) variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_varunc">VarUnc</code></td>
<td>
<p>Uncertainty
estimates for variable</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_year">Year</code></td>
<td>
<p>Year to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_timefactor">timeFactor</code></td>
<td>
<p>time
conversion factor with default per second to per day</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_massfactor">massFactor</code></td>
<td>
<p>mass
conversion factor with default from mumol CO2 to g C</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_unit">unit</code></td>
<td>
<p>unit
of the daily sums</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_dts">dts</code></td>
<td>
<p>numeric integer</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDailySumsY_+3A_data">data</code></td>
<td>
<p>data.frame with variables to plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>AMM, KS
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotDiurnalCycle'>sEddyProc sPlotDiurnalCycle</h2><span id='topic+sEddyProc_sPlotDiurnalCycle'></span>

<h3>Description</h3>

<p>Generates image in specified format ('pdf' or 'png') with diurnal cycles.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotDiurnalCycle(Var = Var.s, 
    QFVar = if (!missing(QFVar.s)) QFVar.s else "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Format = if (!missing(Format.s)) Format.s else "pdf", 
    Dir = if (!missing(Dir.s)) Dir.s else "plots", 
    data = cbind(sDATA, sTEMP), dts = sINFO$DTS, 
    Var.s, QFVar.s, QFValue.n, Format.s, 
    Dir.s)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality
flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value
of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_format">Format</code></td>
<td>
<p>Graphics
file format (e.g. 'pdf', 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_dir">Dir</code></td>
<td>
<p>Directory for plotting</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_data">data</code></td>
<td>
<p>data.frame with variables to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_dts">dts</code></td>
<td>
<p>numeric integer</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_format.s">Format.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycle_+3A_dir.s">Dir.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>KS, AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotDiurnalCycleM'>sEddyProc sPlotDiurnalCycleM</h2><span id='topic+sEddyProc_sPlotDiurnalCycleM'></span>

<h3>Description</h3>

<p>The diurnal cycles of a single month are plotted to the current device,
scaled to all data. Each year is plotted as a different (coloured) line.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotDiurnalCycleM(Var = Var.s, 
    QFVar = if (!missing(QFVar.s)) QFVar.s else "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Month = Month.i, Legend = if (!missing(Legend.b)) Legend.b else T, 
    data = cbind(sDATA, sTEMP), dts = sINFO$DTS, 
    Var.s, QFVar.s = "none", QFValue.n = NA_real_, 
    Month.i, Legend.b = T)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality
flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value
of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_month">Month</code></td>
<td>
<p>Month to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_legend">Legend</code></td>
<td>
<p>Plot
with legend</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_data">data</code></td>
<td>
<p>data.frame with variables to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_dts">dts</code></td>
<td>
<p>numeric integer</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_var.s">Var.s</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>Quality flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>Value of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_month.i">Month.i</code></td>
<td>
<p>Month to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotDiurnalCycleM_+3A_legend.b">Legend.b</code></td>
<td>
<p>Plot with legend</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>AMM, KS
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotFingerprint'>sEddyProc sPlotFingerprint</h2><span id='topic+sEddyProc_sPlotFingerprint'></span><span id='topic+sPlotFingerprint'></span>

<h3>Description</h3>

<p>Generates fingerprint in file</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotFingerprint(Var = Var.s, QFVar = "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Format = if (!missing(Format.s)) Format.s else "pdf", 
    Dir = if (!missing(Dir.s)) Dir.s else "plots", 
    ..., Var.s, QFVar.s = "none", QFValue.n = NA_real_, 
    Format.s = "pdf", Dir.s = "plots")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value of
quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_format">Format</code></td>
<td>
<p>Graphics
file format (e.g. 'pdf', 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_dir">Dir</code></td>
<td>
<p>Directory
for plotting</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+sEddyProc_sPlotFingerprintY">sEddyProc_sPlotFingerprintY</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_var.s">Var.s</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>Quality flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>Value of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_format.s">Format.s</code></td>
<td>
<p>Graphics file format (e.g. 'pdf', 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprint_+3A_dir.s">Dir.s</code></td>
<td>
<p>Directory for plotting</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>KS, AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotFingerprintY'>sEddyProc sPlotFingerprintY</h2><span id='topic+sEddyProc_sPlotFingerprintY'></span>

<h3>Description</h3>

<p>Plot fingerprint for a single year scaled to all data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotFingerprintY(Var = Var.s, 
    QFVar = "none", QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Year = Year.i, onlyLegend = if (!missing(Legend.b)) Legend.b else F, 
    colors = if (!missing(Col.V)) Col.V else colorRampPalette(c("#00007F", 
        "blue", "#007FFF", "cyan", "#7FFF7F", 
        "yellow", "#FF7F00", "red", "#7F0000"))(50), 
    valueLimits = range(Plot.V.n, na.rm = TRUE), 
    data = cbind(sDATA, sTEMP), dts = sINFO$DTS, 
    Var.s, QFVar.s, QFValue.n, Year.i, Legend.b, 
    Col.V)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality
flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value
of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_year">Year</code></td>
<td>
<p>Year to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_onlylegend">onlyLegend</code></td>
<td>
<p>Plot
only legend</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_colors">colors</code></td>
<td>
<p>Color palette
for fingerprint plot
(can be also defined by user), i.e. color scale argument to
<code><a href="graphics.html#topic+image">image</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_valuelimits">valueLimits</code></td>
<td>
<p>values outside this range
will be set to the range borders to avoid distorting colour scale
e.g. <code>valueLimits = quantile(EddyProc.C$sDATA$NEE, prob = c(
0.05, 0.95), na.rm = TRUE)</code></p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_data">data</code></td>
<td>
<p>data.frame with variables to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_dts">dts</code></td>
<td>
<p>numeric integer of hours in day</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_year.i">Year.i</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_legend.b">Legend.b</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotFingerprintY_+3A_col.v">Col.V</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>AMM, KS, TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotHHFluxes'>sEddyProc sPlotHHFluxes</h2><span id='topic+sEddyProc_sPlotHHFluxes'></span>

<h3>Description</h3>

<p>Produce image-plot with half-hourly fluxes for each year</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotHHFluxes(Var = Var.s, QFVar = if (!missing(QFVar.s)) QFVar.s else "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Format = if (!missing(Format.s)) Format.s else "pdf", 
    Dir = if (!missing(Dir.s)) Dir.s else "plots", 
    Var.s, QFVar.s, QFValue.n, Format.s, 
    Dir.s)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality flag
of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value
of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_format">Format</code></td>
<td>
<p>Graphics
file format (e.g. 'pdf', 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_dir">Dir</code></td>
<td>
<p>Directory for plotting</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_format.s">Format.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxes_+3A_dir.s">Dir.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates image in specified format ('pdf' or 'png') with
half-hourly fluxes and their daily means,
see also <code><a href="#topic+sEddyProc_sPlotHHFluxesY">sEddyProc_sPlotHHFluxesY</a></code>.</p>


<h3>Author(s)</h3>

<p>KS, AMM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotHHFluxesY'>sEddyProc sPlotHHFluxesY</h2><span id='topic+sEddyProc_sPlotHHFluxesY'></span>

<h3>Description</h3>

<p>Plot half-hourly fluxes for a single year scaled to all data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotHHFluxesY(Var = Var.s, QFVar = if (!missing(QFVar.s)) QFVar.s else "none", 
    QFValue = if (!missing(QFValue.n)) QFValue.n else NA_real_, 
    Year = Year.i, data = cbind(sDATA, sTEMP), 
    dts = sINFO$DTS, Var.s, QFVar.s, QFValue.n, 
    Year.i)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_var">Var</code></td>
<td>
<p>Variable to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_qfvar">QFVar</code></td>
<td>
<p>Quality
flag of variable to be filled</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_qfvalue">QFValue</code></td>
<td>
<p>Value
of quality flag for data to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_year">Year</code></td>
<td>
<p>Year to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_data">data</code></td>
<td>
<p>data.frame with variables to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_dts">dts</code></td>
<td>
<p>numeric integer</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_var.s">Var.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_qfvar.s">QFVar.s</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_qfvalue.n">QFValue.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotHHFluxesY_+3A_year.i">Year.i</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>AMM, KS
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sPlotNEEVersusUStarForSeason'>sEddyProc sPlotNEEVersusUStarForSeason</h2><span id='topic+sEddyProc_sPlotNEEVersusUStarForSeason'></span>

<h3>Description</h3>

<p>Generates image in specified format ('pdf' or 'png')</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sPlotNEEVersusUStarForSeason(season = levels(data$season)[1], 
    format = "pdf", dir = "plots", UstarColName = "Ustar", 
    NEEColName = "NEE", TempColName = "Tair", 
    WInch = 16 * 0.394, HInchSingle = 6 * 
        0.394, ..., data = cbind(sDATA, sTEMP, 
        sUSTAR_DETAILS$bins[, c("uStarBin", 
            "tempBin")]))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_season">season</code></td>
<td>
<p>string of season, i.e. time period to plot</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_format">format</code></td>
<td>
<p>string of Graphics file format ('pdf' or 'png')</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_dir">dir</code></td>
<td>
<p>string of Directory for plotting</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_ustarcolname">UstarColName</code></td>
<td>
<p>column name for UStar</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_neecolname">NEEColName</code></td>
<td>
<p>column name for NEE</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_tempcolname">TempColName</code></td>
<td>
<p>column name for air temperature</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_winch">WInch</code></td>
<td>
<p>width of the plot in inches, defaults to 16cm</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_hinchsingle">HInchSingle</code></td>
<td>
<p>height of a subplot in inches, defaults to 6cm</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_...">...</code></td>
<td>
<p>other arguments to <code>.plotNEEVersusUStarTempClass</code>,
such as xlab and ylab axis label strings</p>
</td></tr>
<tr><td><code id="sEddyProc_sPlotNEEVersusUStarForSeason_+3A_data">data</code></td>
<td>
<p>a
data.frame with variables to plot</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sSetLocationInfo'>sEddyProc sSetLocationInfo</h2><span id='topic+sEddyProc_sSetLocationInfo'></span>

<h3>Description</h3>

<p>set Location and time Zone information to sLOCATION</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sSetLocationInfo(LatDeg = if (!missing(Lat_deg.n)) Lat_deg.n else NA_real_, 
    LongDeg = if (!missing(Long_deg.n)) Long_deg.n else NA_real_, 
    TimeZoneHour = if (!missing(TimeZone_h.n)) TimeZone_h.n else NA_integer_, 
    Lat_deg.n, Long_deg.n, TimeZone_h.n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_latdeg">LatDeg</code></td>
<td>
<p>Latitude
in (decimal) degrees (-90 to + 90)</p>
</td></tr>
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_longdeg">LongDeg</code></td>
<td>
<p>Longitude
in (decimal) degrees (-180 to + 180)</p>
</td></tr>
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_timezonehour">TimeZoneHour</code></td>
<td>
<p>Time
zone: hours shift to UTC, e.g. 1 for Berlin</p>
</td></tr>
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_lat_deg.n">Lat_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_long_deg.n">Long_deg.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="sEddyProc_sSetLocationInfo_+3A_timezone_h.n">TimeZone_h.n</code></td>
<td>
<p>deprecated</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sSetUstarScenarios'>sEddyProc sSetUstarScenarios</h2><span id='topic+sEddyProc_sSetUstarScenarios'></span>

<h3>Description</h3>

<p>set uStar processing scenarios</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sSetUstarScenarios(uStarTh, uStarSuffixes = colnames(uStarTh)[-1])</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sSetUstarScenarios_+3A_ustarth">uStarTh</code></td>
<td>
<p>data.frame as returned by
<code><a href="#topic+usGetAnnualSeasonUStarMap">usGetAnnualSeasonUStarMap</a></code> or
<code><a href="#topic+usGetSeasonalSeasonUStarMap">usGetSeasonalSeasonUStarMap</a></code>:
First column, season names, and remaining columns different estimates of
uStar Threshold.
If <code>uStarTh</code> has only one row, then each uStar threshold estimate is
applied to the entire dataset.
Entries in first column must match levels in argument <code>seasonFactor</code>
of <code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sSetUstarScenarios_+3A_ustarsuffixes">uStarSuffixes</code></td>
<td>
<p>the suffixes appended to result column names
by default the column names of uStarTh unless its first season column</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sGetUstarScenarios">sEddyProc_sGetUstarScenarios</a></code></p>

<hr>
<h2 id='sEddyProc_sSetUStarSeasons'>sEddyProc sSetUStarSeasons</h2><span id='topic+sEddyProc_sSetUStarSeasons'></span>

<h3>Description</h3>

<p>Defining seasons for the uStar threshold estimation</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sSetUStarSeasons(seasonFactor = usCreateSeasonFactorMonth(sDATA$sDateTime))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sSetUStarSeasons_+3A_seasonfactor">seasonFactor</code></td>
<td>
<p>factor for subsetting times with different uStar threshold (see details)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>class with updated <code>seasonFactor</code></p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sTKFluxPartition'>sEddyProc sTKFluxPartition</h2><span id='topic+sEddyProc_sTKFluxPartition'></span>

<h3>Description</h3>

<p>Modified daytime-based Flux partitioning after Keenan et al. (2019)</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sTKFluxPartition(..., controlGLPart = partGLControl())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sTKFluxPartition_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="#topic+sEddyProc_sGLFluxPartition">sEddyProc_sGLFluxPartition</a></code>
in addition to the dataset</p>
</td></tr>
<tr><td><code id="sEddyProc_sTKFluxPartition_+3A_controlglpart">controlGLPart</code></td>
<td>
<p>further default parameters,
such as <code>suffix</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Flux partitioning results are in sTEMP data frame of the class.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_sTKFluxPartitionUStarScens'>sEddyProc sTKFluxPartitionUStarScens</h2><span id='topic+sEddyProc_sTKFluxPartitionUStarScens'></span>

<h3>Description</h3>

<p>Flux partitioning after Keenan et al., 2019</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_sTKFluxPartitionUStarScens(..., 
    uStarScenKeep = character(0))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sEddyProc_sTKFluxPartitionUStarScens_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="#topic+sEddyProc_sTKFluxPartition">sEddyProc_sTKFluxPartition</a></code></p>
</td></tr>
<tr><td><code id="sEddyProc_sTKFluxPartitionUStarScens_+3A_ustarscenkeep">uStarScenKeep</code></td>
<td>
<p>Scalar string specifying the scenario
for which to keep parameters (see <code><a href="#topic+sEddyProc_sApplyUStarScen">sEddyProc_sApplyUStarScen</a></code>.
Defaults to the first scenario.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Daytime-based partitioning of measured net ecosystem fluxes into
gross primary production (GPP) and ecosystem respiration (Reco)
for all u* threshold scenarios.</p>


<h3>Note</h3>

<p>Currently only experimental.</p>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='sEddyProc_update_ustarthreshold_columns'>Add columns reporting the uStar threshold for each scenario to sDATA</h2><span id='topic+sEddyProc_update_ustarthreshold_columns'></span>

<h3>Description</h3>

<p>Add columns reporting the uStar threshold for each scenario to sDATA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_update_ustarthreshold_columns()
</code></pre>


<h3>Value</h3>

<p>side effect in .self$sDATA new columns Ustar_Thresh_&lt;ustarsuffix&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sGetUstarScenarios">sEddyProc_sGetUstarScenarios</a></code>
</p>

<hr>
<h2 id='sEddyProc_useAnnualUStarThresholds'>sEddyProc useAnnualUStarThresholds</h2><span id='topic+sEddyProc_useAnnualUStarThresholds'></span>

<h3>Description</h3>

<p>use seasonal estimates of uStar thresholds</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_useAnnualUStarThresholds()</code></pre>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code>,
<code><a href="#topic+sEddyProc_useSeaonsalUStarThresholds">sEddyProc_useSeaonsalUStarThresholds</a></code></p>

<hr>
<h2 id='sEddyProc_useSeaonsalUStarThresholds'>sEddyProc useSeaonsalUStarThresholds</h2><span id='topic+sEddyProc_useSeaonsalUStarThresholds'></span>

<h3>Description</h3>

<p>use seasonal estimates of uStar thresholds</p>


<h3>Usage</h3>

<pre><code class='language-R'>sEddyProc_useSeaonsalUStarThresholds()</code></pre>


<h3>Author(s)</h3>

<p>Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+sEddyProc_sSetUstarScenarios">sEddyProc_sSetUstarScenarios</a></code>,
<code><a href="#topic+sEddyProc_useAnnualUStarThresholds">sEddyProc_useAnnualUStarThresholds</a></code></p>

<hr>
<h2 id='sEddyProc-class'>Class <code>"sEddyProc"</code></h2><span id='topic+sEddyProc-class'></span>

<h3>Description</h3>

<p>R5 reference class for processing of site-level half-hourly eddy data
</p>


<h3>Extends</h3>

<p>All reference classes extend and inherit methods from <code>"<a href="methods.html#topic+envRefClass-class">envRefClass</a>"</code>.
</p>


<h3>Fields</h3>

<p>private, not to be accessed directly:
</p>

<dl>
<dt><code>sID</code>:</dt><dd><p>Object of class <code>character</code> with Site ID </p>
</dd>
<dt><code>sDATA</code>:</dt><dd><p>Object of class <code>data.frame</code>  with (fixed) site data </p>
</dd>
<dt><code>sINFO</code>:</dt><dd><p>Object of class <code>list</code>  with site information </p>
</dd>
<dt><code>sLOCATION</code>:</dt><dd><p>Object of class <code>list</code>  with site location information </p>
</dd>
<dt><code>sTEMP</code>:</dt><dd><p>Object of class <code>data.frame</code> of (temporary) result data </p>
</dd>
<dt><code>sUSTAR</code>:</dt><dd><p>Object of class <code>list</code> with results form uStar Threshold estimation </p>
</dd>
</dl>



<h3>Methods</h3>

<p>Setup, import and export
</p>

<dl>
<dt><code><a href="#topic+sEddyProc_initialize">sEddyProc_initialize</a>(ID.s, Data.F, ColNames.V.s, ColPOSIXTime.s, DTS.n, ColNamesNonNumeric.V.s, Lat_deg.n, Long_deg.n, TimeZone_h.n, ...)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sSetLocationInfo">sEddyProc_sSetLocationInfo</a>(Lat_deg.n, Long_deg.n, TimeZone_h.n)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sExportResults">sEddyProc_sExportResults</a>(isListColumnsExported)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sExportData">sEddyProc_sExportData</a>()</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sGetData">sEddyProc_sGetData</a>()</code></dt><dd></dd>
</dl>

<p>uStar threshold estimation
</p>

<dl>
<dt><code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a>(ctrlUstarEst.l, ctrlUstarSub.l, UstarColName, NEEColName, TempColName, RgColName, ..., seasonFactor, seasonFactorsYear, nSample, probs, verbose.b)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sEstUstarThold">sEddyProc_sEstUstarThold</a>(UstarColName, NEEColName, TempColName, RgColName, ...)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotNEEVersusUStarForSeason">sEddyProc_sPlotNEEVersusUStarForSeason</a>(season.s, Format.s, Dir.s, UstarColName, NEEColName, TempColName, WInch, HInchSingle, ...)</code></dt><dd></dd>
</dl>

<p>Gapfilling
</p>

<dl>
<dt><code><a href="#topic+sEddyProc_sCalcPotRadiation">sEddyProc_sCalcPotRadiation</a>(useSolartime.b)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sMDSGapFill">sEddyProc_sMDSGapFill</a>(Var.s, QFVar.s, QFValue.n, V1.s, T1.n, V2.s, T2.n, V3.s, T3.n, FillAll.b, Verbose.b, Suffix.s)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sMDSGapFillAfterUStarDistr">sEddyProc_sMDSGapFillAfterUStarDistr</a>(..., UstarThres.df, UstarSuffix.V.s)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sMDSGapFillAfterUstar">sEddyProc_sMDSGapFillAfterUstar</a>(FluxVar.s, UstarVar.s, UstarThres.df, UstarSuffix.s, FlagEntryAfterLowTurbulence.b, isFilterDayTime, swThr, RgColName, ...)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sFillMDC">sEddyProc_sFillMDC</a>(WinDays.i, Verbose.b)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sFillLUT">sEddyProc_sFillLUT</a>(WinDays.i, V1.s, T1.n, V2.s, T2.n, V3.s, T3.n, V4.s, T4.n, V5.s, T5.n, Verbose.b)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sFillInit">sEddyProc_sFillInit</a>(Var.s, QFVar.s, QFValue.n, FillAll.b)</code></dt><dd></dd>
</dl>

<p>Flux partitioning
</p>

<dl>
<dt><code><a href="#topic+sEddyProc_sMRFluxPartition">sEddyProc_sMRFluxPartition</a>(FluxVar.s, QFFluxVar.s, QFFluxValue.n, TempVar.s, QFTempVar.s, QFTempValue.n, RadVar.s, Lat_deg.n, Long_deg.n, TimeZone_h.n, T_ref.n, Suffix.s, debug.l, parsE0Regression)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sGLFluxPartition">sEddyProc_sGLFluxPartition</a>(..., debug.l, isWarnReplaceColumns)</code></dt><dd></dd>
</dl>

<p>Plotting
</p>

<dl>
<dt><code><a href="#topic+sEddyProc_sPlotDailySums">sEddyProc_sPlotDailySums</a>(Var.s, VarUnc.s, Format.s, Dir.s, unit.s, ...)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotDailySumsY">sEddyProc_sPlotDailySumsY</a>(Var.s, VarUnc.s, Year.i, timeFactor.n, massFactor.n, unit.s)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotHHFluxes">sEddyProc_sPlotHHFluxes</a>(Var.s, QFVar.s, QFValue.n, Format.s, Dir.s)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotHHFluxesY">sEddyProc_sPlotHHFluxesY</a>(Var.s, QFVar.s, QFValue.n, Year.i)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotDiurnalCycle">sEddyProc_sPlotDiurnalCycle</a>(Var.s, QFVar.s, QFValue.n, Format.s, Dir.s)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotFingerprint">sEddyProc_sPlotFingerprint</a>(Var.s, QFVar.s, QFValue.n, Format.s, Dir.s, ...)</code></dt><dd></dd>
<dt><code><a href="#topic+sEddyProc_sPlotFingerprintY">sEddyProc_sPlotFingerprintY</a>(Var.s, QFVar.s, QFValue.n, Year.i, Legend.b, Col.V, valueLimits)</code></dt><dd></dd>
</dl>



<h3>Note</h3>

<p>for examples see <a href="../doc/useCase.html">useCase vignette</a>
</p>


<h3>Author(s)</h3>

<p> AM, TW </p>

<hr>
<h2 id='usControlUstarEst'>usControlUstarEst</h2><span id='topic+usControlUstarEst'></span>

<h3>Description</h3>

<p>Default list of parameters for determining UStar of a single binned series</p>


<h3>Usage</h3>

<pre><code class='language-R'>usControlUstarEst(ustPlateauFwd = 10, ustPlateauBack = 6, 
    plateauCrit = 0.95, corrCheck = 0.5, 
    firstUStarMeanCheck = 0.2, isOmitNoThresholdBins = TRUE, 
    isUsingCPTSeveralT = FALSE, isUsingCPT = FALSE, 
    minValidUStarTempClassesProp = 0.2, minValidBootProp = 0.4, 
    minNuStarPlateau = 3L)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usControlUstarEst_+3A_ustplateaufwd">ustPlateauFwd</code></td>
<td>
<p>number of subsequent uStar bin values to compare
to in fwd mode</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_ustplateauback">ustPlateauBack</code></td>
<td>
<p>number of subsequent uStar bin values to compare
to in back mode</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_plateaucrit">plateauCrit</code></td>
<td>
<p>significant differences between a uStar value and
the mean of a &quot;plateau&quot;</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_corrcheck">corrCheck</code></td>
<td>
<p>threshold value for correlation between Tair
and u * data</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_firstustarmeancheck">firstUStarMeanCheck</code></td>
<td>
<p>if first uStar bin average of a class is already
larger than this value, the temperature class is skipped.</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_isomitnothresholdbins">isOmitNoThresholdBins</code></td>
<td>
<p>if TRUE, bins where no threshold was found
are ignored. Set to FALSE to report highest uStar bin for these cases</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_isusingcptseveralt">isUsingCPTSeveralT</code></td>
<td>
<p>set to TRUE to use change point detection
without binning uStar but with additionally changed aggregation scheme for
several temperature classifications</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_isusingcpt">isUsingCPT</code></td>
<td>
<p>set to TRUE to use change point detection without
binning uStar before in usual aggregation method (good for comparing methods,
but not recommended, overruled by isUsingCPTSeveralT = TRUE)</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_minvalidustartempclassesprop">minValidUStarTempClassesProp</code></td>
<td>
<p>seasons, in which only less than this
proportion of temperature classes a threshold was detected,
are excluded from aggregation</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_minvalidbootprop">minValidBootProp</code></td>
<td>
<p>minimum proportion of bootstrap samples
for which a threshold was detected. Below this proportion
NA quantiles are reported.</p>
</td></tr>
<tr><td><code id="usControlUstarEst_+3A_minnustarplateau">minNuStarPlateau</code></td>
<td>
<p>minimum number of records in plateau, threshold
must be larger than mean of this many bins</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usEstUstarThresholdSingleFw2Binned">usEstUstarThresholdSingleFw2Binned</a></code>,
<code><a href="#topic+usControlUstarSubsetting">usControlUstarSubsetting</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>usControlUstarEst()
</code></pre>

<hr>
<h2 id='usControlUstarSubsetting'>usControlUstarSubsetting</h2><span id='topic+usControlUstarSubsetting'></span>

<h3>Description</h3>

<p>Default list of parameters for subsetting the data for uStarThreshold estimation</p>


<h3>Usage</h3>

<pre><code class='language-R'>usControlUstarSubsetting(taClasses = 7, UstarClasses = 20, 
    swThr = 10, minRecordsWithinTemp = 100, 
    minRecordsWithinSeason = 160, minRecordsWithinYear = 3000, 
    isUsingOneBigSeasonOnFewRecords = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usControlUstarSubsetting_+3A_taclasses">taClasses</code></td>
<td>
<p>set number of air temperature classes</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_ustarclasses">UstarClasses</code></td>
<td>
<p>set number of Ustar classes</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_swthr">swThr</code></td>
<td>
<p>nighttime data threshold for solar radiation [Wm-2]</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_minrecordswithintemp">minRecordsWithinTemp</code></td>
<td>
<p>integer scalar: the minimum number of
Records within one Temperature-class</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_minrecordswithinseason">minRecordsWithinSeason</code></td>
<td>
<p>integer scalar: the minimum number of
Records within one season</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_minrecordswithinyear">minRecordsWithinYear</code></td>
<td>
<p>integer scalar: the minimum number of
Records within one year</p>
</td></tr>
<tr><td><code id="usControlUstarSubsetting_+3A_isusingonebigseasononfewrecords">isUsingOneBigSeasonOnFewRecords</code></td>
<td>
<p>boolean scalar: set to FALSE to
avoid aggregating all seasons on too few records</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usEstUstarThresholdSingleFw2Binned">usEstUstarThresholdSingleFw2Binned</a></code>
, <code><a href="#topic+usControlUstarSubsetting">usControlUstarSubsetting</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>usControlUstarSubsetting()
</code></pre>

<hr>
<h2 id='usCreateSeasonFactorMonth'>usCreateSeasonFactorMonth</h2><span id='topic+usCreateSeasonFactorMonth'></span>

<h3>Description</h3>

<p>Compute year-spanning Seasonfactor by starting month</p>


<h3>Usage</h3>

<pre><code class='language-R'>usCreateSeasonFactorMonth(dates, month = as.POSIXlt(dates)$mon + 
    1L, year = as.POSIXlt(dates)$year + 1900L, 
    startMonth = c(3, 6, 9, 12))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usCreateSeasonFactorMonth_+3A_dates">dates</code></td>
<td>
<p>POSIXct vector of length of the data set to
be filled, specifying the center-time of each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonth_+3A_month">month</code></td>
<td>
<p>integer (1-12) vector of
length of the data set to be filled, specifying the month for each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonth_+3A_year">year</code></td>
<td>
<p>integer vector of length of
the data set to be filled, specifying the year</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonth_+3A_startmonth">startMonth</code></td>
<td>
<p>integer vector specifying
the starting month for each season, counting from one. Default is
(Dez, Jan, Feb)(Mar, April, May)(June, July, August), (Sept, Oct, Nov)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute factors to denote the season for uStar-Filtering by specifying
starting months, with continuous seasons spanning year boundaries
If Jan is not a starting month, then the first months of each year will be
part of the last period in the year.
E.g. with the default the fourth period of the first year consists of
Jan, Feb, Dec.
</p>
<p>REddyProc internally works with a timestamp 15 minutes after the start
of each half hour.
When providing the <code>dates</code> argument, user may shift the start time
by <code>dates = myDataset$DateTime + 15 * 60</code></p>


<h3>Value</h3>

<p>Integer vector length(dates), with each unique value representing one season</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usCreateSeasonFactorMonthWithinYear">usCreateSeasonFactorMonthWithinYear</a></code>,
<code><a href="#topic+usCreateSeasonFactorYday">usCreateSeasonFactorYday</a></code>,
<code><a href="#topic+usCreateSeasonFactorYdayYear">usCreateSeasonFactorYdayYear</a></code></p>

<hr>
<h2 id='usCreateSeasonFactorMonthWithinYear'>usCreateSeasonFactorMonthWithinYear</h2><span id='topic+usCreateSeasonFactorMonthWithinYear'></span>

<h3>Description</h3>

<p>Compute year-bounded Seasonfactor by starting month</p>


<h3>Usage</h3>

<pre><code class='language-R'>usCreateSeasonFactorMonthWithinYear(dates, 
    month = as.POSIXlt(dates)$mon + 1, year = as.POSIXlt(dates)$year + 
        1900, startMonth = c(3, 6, 9, 12))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usCreateSeasonFactorMonthWithinYear_+3A_dates">dates</code></td>
<td>
<p>POSIXct vector of length of the data set to be filled,
specifying the center-time of each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonthWithinYear_+3A_month">month</code></td>
<td>
<p>integer (1-12) vector of length
of the data set to be filled, specifying the month for each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonthWithinYear_+3A_year">year</code></td>
<td>
<p>integer vector of length of
the data set to be filled, specifying the year</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorMonthWithinYear_+3A_startmonth">startMonth</code></td>
<td>
<p>integer vector specifying the starting
month for each season, counting from one. Default is
(Dez, Jan, Feb)(Mar, April, May)(June, July, August), (Sept, Oct, Nov)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate factors to denote the season for uStar-Filtering by specifying
starting months, with seasons not spanning year boundaries
If Jan is not a starting month, then the first months of each year will be
part of the last period in the year.
E.g. with the default the fourth period of the first year consists of
Jan, Feb, Dec.</p>


<h3>Value</h3>

<p>Integer vector length(dates), with each unique value representing one season</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usCreateSeasonFactorMonth">usCreateSeasonFactorMonth</a></code></p>

<hr>
<h2 id='usCreateSeasonFactorYday'>usCreateSeasonFactorYday</h2><span id='topic+usCreateSeasonFactorYday'></span>

<h3>Description</h3>

<p>Compute year-spanning Seasonfactor by starting year-day</p>


<h3>Usage</h3>

<pre><code class='language-R'>usCreateSeasonFactorYday(dates, yday = as.POSIXlt(dates)$yday + 
    1L, year = as.POSIXlt(dates)$year + 1900L, 
    startYday = c(335, 60, 152, 244))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usCreateSeasonFactorYday_+3A_dates">dates</code></td>
<td>
<p>POSIXct vector of length of the data set to be filled,
specifying the center-time of each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYday_+3A_yday">yday</code></td>
<td>
<p>integer (1-366) vector of length
of the data set to be filled, specifying the day of the year
(1..366) for each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYday_+3A_year">year</code></td>
<td>
<p>integer vector of length of
the data set to be filled, specifying the year</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYday_+3A_startyday">startYday</code></td>
<td>
<p>integer vector (1-366) specifying
the starting yearDay for each season in increasing order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With default parameterization, dates are assumed to denote begin
or center of the eddy time period.
If working with dates that denote the end of the period,
use <code>yday = as.POSIXlt(fGetBeginOfEddyPeriod(dates))$yday</code></p>


<h3>Value</h3>

<p>Integer vector of length <code>nrow(ds)</code>,
each unique class representing one season</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usCreateSeasonFactorMonth">usCreateSeasonFactorMonth</a></code></p>

<hr>
<h2 id='usCreateSeasonFactorYdayYear'>usCreateSeasonFactorYdayYear</h2><span id='topic+usCreateSeasonFactorYdayYear'></span>

<h3>Description</h3>

<p>Compute year-spanning Seasonfactor by starting year and yearday</p>


<h3>Usage</h3>

<pre><code class='language-R'>usCreateSeasonFactorYdayYear(dates, yday = as.POSIXlt(dates)$yday + 
    1L, year = as.POSIXlt(dates)$year + 1900L, 
    starts)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usCreateSeasonFactorYdayYear_+3A_dates">dates</code></td>
<td>
<p>POSIXct vector of length of the data set to be filled,
specifying the center-time of each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYdayYear_+3A_yday">yday</code></td>
<td>
<p>integer (1-366) vector of
length of the data set to be filled, specifying the day of the
year (1..366) for each record</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYdayYear_+3A_year">year</code></td>
<td>
<p>integer vector of length of
the data set to be filled, specifying the year</p>
</td></tr>
<tr><td><code id="usCreateSeasonFactorYdayYear_+3A_starts">starts</code></td>
<td>
<p>data.frame with first column specifying the
starting yday (integer 1-366) and second column the year
(integer e.g. 1998) for each season in increasing order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With default parameterization, dates are assumed to denote begin
or center of the eddy time period.
If working with dates that denote the end of the period,
use <code>yday = as.POSIXlt(fGetBeginOfEddyPeriod(dates))$yday</code>
</p>


<h3>Value</h3>

<p>Integer vector of length <code>nrow(ds)</code>,
each unique class representing one season</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>See Also</h3>

<p><code><a href="#topic+usCreateSeasonFactorMonth">usCreateSeasonFactorMonth</a></code></p>

<hr>
<h2 id='usEstUstarThreshold'>usEstUstarThreshold - Estimating ustar threshold</h2><span id='topic+usEstUstarThreshold'></span>

<h3>Description</h3>

<p>Estimate the Ustar threshold by aggregating the estimates for
seasonal and temperature subsets.</p>


<h3>Usage</h3>

<pre><code class='language-R'>usEstUstarThreshold(ds, seasonFactor = usCreateSeasonFactorMonth(ds$sDateTime), 
    yearOfSeasonFactor = usGetYearOfSeason(seasonFactor, 
        ds$sDateTime), ctrlUstarEst = usControlUstarEst(), 
    ctrlUstarSub = usControlUstarSubsetting(), 
    fEstimateUStarBinned = usEstUstarThresholdSingleFw2Binned, 
    isCleaned = FALSE, isInBootstrap = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usEstUstarThreshold_+3A_ds">ds</code></td>
<td>
<p>data.frame with columns &quot;sDateTime&quot;, &quot;Ustar&quot;, &quot;NEE&quot;, &quot;Tair&quot;, and &quot;Rg&quot;</p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_seasonfactor">seasonFactor</code></td>
<td>
<p>factor for subsetting times (see details)</p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_yearofseasonfactor">yearOfSeasonFactor</code></td>
<td>
<p>named integer vector: for each seasonFactor level, get the year
(aggregation period) that this season belongs to</p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_ctrlustarest">ctrlUstarEst</code></td>
<td>
<p>control parameters for estimating uStar on a single binned series,
see <code><a href="#topic+usControlUstarEst">usControlUstarEst</a></code></p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_ctrlustarsub">ctrlUstarSub</code></td>
<td>
<p>control parameters for
subsetting time series (number of temperature and Ustar classes ...),
see <code><a href="#topic+usControlUstarSubsetting">usControlUstarSubsetting</a></code></p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_festimateustarbinned">fEstimateUStarBinned</code></td>
<td>
<p>function to
estimate UStar on a single binned series,
see <code><a href="#topic+usEstUstarThresholdSingleFw2Binned">usEstUstarThresholdSingleFw2Binned</a></code></p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_iscleaned">isCleaned</code></td>
<td>
<p>set to TRUE, if the data was cleaned already,
to avoid expensive call to <code>usGetValidUstarIndices</code>.</p>
</td></tr>
<tr><td><code id="usEstUstarThreshold_+3A_isinbootstrap">isInBootstrap</code></td>
<td>
<p>set to TRUE if this is called from
<code><a href="#topic+sEddyProc_sEstimateUstarScenarios">sEddyProc_sEstimateUstarScenarios</a></code> to avoid further
bootstraps in change-point detection</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The threshold for sufficiently turbulent conditions u * (Ustar)
is estimated for different subsets of the time series.
From the estimates for each season (each value in <code>seasonFactor</code>)
the maximum of all seasons of one year is reported as estimate for this year.
Within each season the time series is split by temperature classes.
Among these Ustar estimates, the median is reported as season value.
</p>
<p>In order to split the seasons, the uses must provide a vector with argument
<code>seasonFactor</code>.
All positions with the same factor, belong to
the same season. It is conveniently generated by one of the following functions:
</p>

<ul>
<li> <p><code><a href="#topic+usCreateSeasonFactorMonth">usCreateSeasonFactorMonth</a></code>
(default DJF-MAM-JJA-SON with December from previous to January of the year) 
</p>
</li>
<li> <p><code><a href="#topic+usCreateSeasonFactorMonthWithinYear">usCreateSeasonFactorMonthWithinYear</a></code>
(default DJF-MAM-JJA-SON with December from the same year) 
</p>
</li>
<li> <p><code><a href="#topic+usCreateSeasonFactorYday">usCreateSeasonFactorYday</a></code>
for a refined specification of season starts. 
</p>
</li>
<li> <p><code><a href="#topic+usCreateSeasonFactorYdayYear">usCreateSeasonFactorYdayYear</a></code>
for specifying different seasons season between years. 
</p>
</li></ul>

<p>The estimation of Ustar on a single binned series can be selected argument
<code>fEstimateUStarBinned</code>.
</p>

<ul>
<li> <p><code><a href="#topic+usEstUstarThresholdSingleFw1Binned">usEstUstarThresholdSingleFw1Binned</a></code> 
</p>
</li>
<li> <p><code><a href="#topic+usEstUstarThresholdSingleFw2Binned">usEstUstarThresholdSingleFw2Binned</a></code> (default) 
</p>
</li></ul>

<p>This function is called by
</p>

<ul>
<li> <p><code><a href="#topic+sEddyProc_sEstUstarThold">sEddyProc_sEstUstarThold</a></code> which stores the result
in the class variables (sUSTAR and sDATA).
</p>
</li>
<li> <p><code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code> which
additionally estimates median and confidence intervals for each year
by bootstrapping the original data within seasons.
</p>
</li></ul>

<p>For inspecting the NEE~uStar relationship plotting is provided by
<code><a href="#topic+sEddyProc_sPlotNEEVersusUStarForSeason">sEddyProc_sPlotNEEVersusUStarForSeason</a></code>
</p>
<dl>
<dt>change point detection (CPT) method</dt><dd>
<p>With specifying
<code>ctrlUstarEst = usControlUstarEst(isUsingCPTSeveralT = TRUE)</code>
change point detection is applied instead of the moving point test
(e.g. with Fw2Binned).
</p>
<p>The sometimes sensitive binning of uStar values within a temperature
class is avoided.
Further, possible spurious thresholds are avoid by testing that the
model with a threshold
fits the data better than a model without a threshold using a
likelihood ratio test.
In addition, with CPT seasons are excluded where a threshold
was detected in only less
than ctrlUstarEst$minValidUStarTempClassesProp (default 20%) of the
temperature classes.
</p>
<p>Note, that this method often gives higher estimates of the u * threshold.
</p>
</dd></dl>

<dl>
<dt>One-big-season fallback</dt><dd>
<p>If there are too few records within one year, of when no season yielded a
finite u * Threshold estimate, then
the yearly u * Th is estimated by pooling the data from seasons within one
seasonYear.
The user can suppress using pooled data on few records by providing option
<code>ctrlUstarSub$isUsingOneBigSeasonOnFewRecords = FALSE</code>
(see <code><a href="#topic+usControlUstarSubsetting">usControlUstarSubsetting</a></code>)
</p>
</dd></dl>


<h3>Value</h3>

<p>A list with entries
data.frame with columns &quot;aggregationMode&quot;, &quot;seasonYear&quot;, &quot;season&quot;, &quot;uStar&quot;
with rows for &quot;single&quot;: the entire aggregate (median across years)
, &quot;seasonYear&quot;: each year (maximum across seasons or estimate on pooled data)
, &quot;season&quot;: each season (median across temperature classes)
</p>
<table role = "presentation">
<tr><td><code>seasonYear</code></td>
<td>
<p>data.frame
listing results for year with columns &quot;seasonYear&quot;
, &quot;uStarMaxSeason&quot; the maximum across seasonal estimates within the year
, &quot;uStarPooled&quot; the estimate based on data pooled across the year
(only calculated on few valid records or on uStarMaxSeason was nonfinite)
, &quot;nRec&quot; number of valid records  (only if the pooled estimate was calculated)
, &quot;uStarAggr&quot; chosen estimate, corresponding to uStarPooled
if this was calculated,
or uStarMaxSeason or uStarTh across years if the former was non-finite</p>
</td></tr>
<tr><td><code>season</code></td>
<td>
<p>data.frame listing results for each season
, &quot;nRec&quot; the number of valid records
, &quot;uStarSeasonEst&quot; the estimate for based on data within the season
(median across temperature classes)
, &quot;uStarAggr&quot; chose estimate, corresponding to uStarSeasonEst,
or the yearly seasonYear$uStarAggr, if the former was non-finite</p>
</td></tr>
<tr><td><code>tempInSeason</code></td>
<td>
<p>numeric matrix
(nTemp x nAggSeason):
estimates for each temperature subset for each season</p>
</td></tr>
<tr><td><code>bins</code></td>
<td>
<p>columns
<code>season</code>, <code>tempBin</code> and <code>uStarBin</code>
for each record of input <code>ds</code>
reporting classes of similar environmental conditions
that the record belongs to.
</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>TW, OM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>Ustar filtering following the idea in Papale, D. et al. (2006)
Towards a standardized processing of net ecosystem exchange measured with
eddy covariance technique: algorithms and uncertainty estimation.
Biogeosciences 3(4): 571-583.</p>

<hr>
<h2 id='usEstUstarThresholdSingleFw1Binned'>usEstUstarThresholdSingleFw1Binned</h2><span id='topic+usEstUstarThresholdSingleFw1Binned'></span>

<h3>Description</h3>

<p>estimate the Ustar threshold for single subset, using FW1 algorithm</p>


<h3>Usage</h3>

<pre><code class='language-R'>usEstUstarThresholdSingleFw1Binned(Ust_bins.f, 
    ctrlUstarEst = usControlUstarEst())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usEstUstarThresholdSingleFw1Binned_+3A_ust_bins.f">Ust_bins.f</code></td>
<td>
<p>data.frame with columns NEE_avg and Ust_avg, of Ustar bins</p>
</td></tr>
<tr><td><code id="usEstUstarThresholdSingleFw1Binned_+3A_ctrlustarest">ctrlUstarEst</code></td>
<td>
<p>parameter list,
see <code><a href="#topic+usControlUstarEst">usControlUstarEst</a></code> for defaults and description</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relying on binned NEE and Ustar</p>


<h3>Author(s)</h3>

<p>TW, OM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>


<h3>References</h3>

<p>inspired by Papale 2006</p>

<hr>
<h2 id='usEstUstarThresholdSingleFw2Binned'>usEstUstarThresholdSingleFw2Binned</h2><span id='topic+usEstUstarThresholdSingleFw2Binned'></span>

<h3>Description</h3>

<p>estimate the Ustar threshold for single subset, using FW2 algorithm</p>


<h3>Usage</h3>

<pre><code class='language-R'>usEstUstarThresholdSingleFw2Binned(Ust_bins.f, 
    ctrlUstarEst = usControlUstarEst())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usEstUstarThresholdSingleFw2Binned_+3A_ust_bins.f">Ust_bins.f</code></td>
<td>
<p>data.frame with column s NEE_avg and Ust_avg, of Ustar bins</p>
</td></tr>
<tr><td><code id="usEstUstarThresholdSingleFw2Binned_+3A_ctrlustarest">ctrlUstarEst</code></td>
<td>
<p>parameter list,
see <code><a href="#topic+usControlUstarEst">usControlUstarEst</a></code> for defaults and description</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Demand that threshold is higher than <code>ctrlUstarEst$minNuStarPlateau</code>
records. If fewer records</p>


<h3>Author(s)</h3>

<p>TW, OM
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='usGetAnnualSeasonUStarMap'>usGetAnnualSeasonUStarMap</h2><span id='topic+usGetAnnualSeasonUStarMap'></span>

<h3>Description</h3>

<p>extract mapping season -&gt; uStar columns from Distribution result</p>


<h3>Usage</h3>

<pre><code class='language-R'>usGetAnnualSeasonUStarMap(uStarTh)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usGetAnnualSeasonUStarMap_+3A_ustarth">uStarTh</code></td>
<td>
<p>result of <code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code>
or <code><a href="#topic+sEddyProc_sEstUstarThreshold">sEddyProc_sEstUstarThreshold</a></code>$uStarTh</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with first column the season, and other columns
different uStar threshold estimates</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='usGetSeasonalSeasonUStarMap'>usGetSeasonalSeasonUStarMap</h2><span id='topic+usGetSeasonalSeasonUStarMap'></span>

<h3>Description</h3>

<p>extract mapping season -&gt; uStar columns from Distribution result</p>


<h3>Usage</h3>

<pre><code class='language-R'>usGetSeasonalSeasonUStarMap(uStarTh)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usGetSeasonalSeasonUStarMap_+3A_ustarth">uStarTh</code></td>
<td>
<p>result of <code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code>
or <code><a href="#topic+sEddyProc_sEstUstarThreshold">sEddyProc_sEstUstarThreshold</a></code>$uStarTh</p>
</td></tr>
</table>


<h3>Details</h3>

<p>from result of <code><a href="#topic+sEddyProc_sEstUstarThresholdDistribution">sEddyProc_sEstUstarThresholdDistribution</a></code></p>


<h3>Value</h3>

<p>a data frame with first column the season, and other columns
different uStar threshold estimates</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

<hr>
<h2 id='usGetYearOfSeason'>usGetYearOfSeason</h2><span id='topic+usGetYearOfSeason'></span>

<h3>Description</h3>

<p>determine the year of the record of middle of seasons</p>


<h3>Usage</h3>

<pre><code class='language-R'>usGetYearOfSeason(seasonFactor, sDateTime.v)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="usGetYearOfSeason_+3A_seasonfactor">seasonFactor</code></td>
<td>
<p>factor vector of length data:
for each record which season it belongs to</p>
</td></tr>
<tr><td><code id="usGetYearOfSeason_+3A_sdatetime.v">sDateTime.v</code></td>
<td>
<p>POSIX.t vector of length data:
for each record: center of half-hour period
(corresponding to sDATA$sDateTime)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named integer vector, with names corresponding to seasons</p>


<h3>Author(s)</h3>

<p>TW
Department for Biogeochemical Integration at MPI-BGC, Jena, Germany &lt;REddyProc-help@bgc-jena.mpg.de&gt; [cph], Thomas Wutzler &lt;twutz@bgc-jena.mpg.de&gt; [aut, cre], Markus Reichstein &lt;mreichstein@bgc-jena.mpg.de&gt; [aut], Antje Maria Moffat &lt;antje.moffat@bgc.mpg.de&gt; [aut, trl], Olaf Menzer &lt;omenzer@bgc-jena.mpg.de&gt; [ctb], Mirco Migliavacca &lt;mmiglia@bgc-jena.mpg.de&gt; [aut], Kerstin Sickel &lt;ksickel@bgc-jena.mpg.de&gt; [ctb, trl], Ladislav &lt;U+0160&gt;igut &lt;sigut.l@czechglobe.cz&gt; [ctb]</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
