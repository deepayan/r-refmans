<!DOCTYPE html><html><head><title>Help for package drcte</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {drcte}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compCDF'>
<p>Compare time-to-event curves</p></a></li>
<li><a href='#drmte'><p>Fitting time-to-event models for seed science</p></a></li>
<li><a href='#drmteControl'><p>Sets control arguments</p></a></li>
<li><a href='#ED.drcte'><p>Estimating the quantiles for time-to-event models</p></a></li>
<li><a href='#KDE'>
<p>Kernel estimator for the cumulative distribution function</p></a></li>
<li><a href='#loglogistic'>
<p>Log-logistic distribution of germination times within a seed lot</p></a></li>
<li><a href='#lognormal'>
<p>Log-normal distribution of times to an event</p></a></li>
<li><a href='#lotus'>
<p>Germination assay with Lotus ornithopodioides</p></a></li>
<li><a href='#lotusCum'>
<p>Germination assay with Lotus ornithopodioides</p></a></li>
<li><a href='#lotusOr'>
<p>Germination assay with Lotus ornithopodioides</p></a></li>
<li><a href='#NPMLE'>
<p>NPMLE for time-to-event data</p></a></li>
<li><a href='#plot.drcte'><p>Plotting fitted time-to-event models</p></a></li>
<li><a href='#plotData'><p>Data for plotting fitted time-to-event models</p></a></li>
<li><a href='#predict.drcte'><p>Prediction</p></a></li>
<li><a href='#quantile.drcte'><p>Estimating quantiles for time-to-event models</p></a></li>
<li><a href='#reshape_te'>
<p>Reshaping time-to-event datasets</p></a></li>
<li><a href='#Service functions'>
<p>Service functions</p></a></li>
<li><a href='#summary.drcte'><p>Summarising time-to-event fits</p></a></li>
<li><a href='#verbascum'>
<p>Germination time-course for three species of the Verbascum genus</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Date:</td>
<td>2023-04-19</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Approaches for Time-to-Event Data in Agriculture</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.30</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), drc</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, plyr, nor1mix, graphics, stats, mclust, survival,
sandwich, lmtest, dplyr, multcomp, tidyr, MASS</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea Onofri &lt;andrea.onofri@unipg.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A specific and comprehensive framework for the analyses of time-to-event data in agriculture. Fit non-parametric and parametric time-to-event models. Compare time-to-event curves for different experimental groups. Plots and other displays. It is particularly tailored to the analyses of data from germination and emergence assays. The methods are described in Onofri et al. (2020) "A unified framework for the analysis of germination, emergence, and other time-to-event data in weed science"", Weed Science, 70, 259-271 &lt;<a href="https://doi.org/10.1017%2Fwsc.2022.8">doi:10.1017/wsc.2022.8</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.statforbiology.com">https://www.statforbiology.com</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-08 12:02:43 UTC; andrea</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrea Onofri [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-08 18:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='compCDF'>
Compare time-to-event curves
</h2><span id='topic+compCDF'></span>

<h3>Description</h3>

<p>This function is used to compare time-to-event curves for different experimental treatments. The apprach depends on the type of time-to-event curves, i.e., parametric, NPMLE and KDE (see details)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compCDF(obj, scores = c("wmw", "logrank1", "logrank2"),
B = 199, type = c("naive", "permutation"), units = NULL, upperl,
lowerl, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compCDF_+3A_obj">obj</code></td>
<td>

<p>A time-to-event model fitted with 'drmte' (drcte object)
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_scores">scores</code></td>
<td>

<p>This argument is only meaningful for NPMLEs of time-to-event curves and it specifies the type of log-rank statistic to compare the curves. Possible values are 'wmw' (Wilcoxon-Mann-Whitney) , 'logrank1' (Sun's scores), 'logrank2' (Finkelstein's scores) and it defaults to 'wmw'. See details in Fay and Shaw, 2010.
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_b">B</code></td>
<td>

<p>Number of permutations for permutation tests
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_type">type</code></td>
<td>

<p>For parametric models, comparisons are based on a Likelihood Ratio Test (LRT). The argument type specifies whether P-levels should be calculated by using a 'naive' chi-square approximation, or a 'permutation' approach. It defaults to 'naive' and it is neglected for NPMLE and KDE fits, which always use the permutation approach.
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_units">units</code></td>
<td>

<p>A vector for the clustering units (e.g. Petri dishes or other containers for seed germination/emergence assays). When type = 'permutation' and 'units' is given, the permutation approach is performed at the units level and not at the individuals level.
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_upperl">upperl</code></td>
<td>
<p>Only for parametric models: a numeric vector of upper limits for all parameters in the model (the default corresponds to infinity for all parameters).
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_lowerl">lowerl</code></td>
<td>
<p>Only for parametric models: a numeric vector of lower limits for all parameters in the model (the default corresponds to minus infinity for all parameters).
</p>
</td></tr>
<tr><td><code id="compCDF_+3A_display">display</code></td>
<td>

<p>logical. If TRUE, results are displayed, otherwise, they are not (useful in simulations).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to compare time-to-event curves fitted with the function 'drmte()' in the 'drcte' package, where treatment factors have been included by using the 'curveid' argument. The type of test statistic depends on the fitted model, whether it is a parametric time-to-event model or a NPMLE or a KDE. With parametric time-to-event models a Likelihood Ratio test is used, with NPMLE, weighted log-rank statistics are used, while for KDEs, a Cramér‐von Mises type distance among curves is used. In all cases, this function is used to determine the p-level for the null (i.e. the curves are not significantly different from each other). WARNING: a permutation based approach may not necessarily work with parametric and KDE models; indeed, the permuted sample can be such that a model cannot be fitted into it. We are working a solution for these cases, but, in the meantime, we recommend that the user resorts to the naive inference approach whenever a permutation based approach does not work.
</p>


<h3>Value</h3>

<table>
<tr><td><code>method</code></td>
<td>
<p>The test statistic used for the comparison</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>The individual scores for the statistic (when applicable)</p>
</td></tr>
<tr><td><code>val0</code></td>
<td>
<p>The observed value for the test statistic</p>
</td></tr>
<tr><td><code>vali</code></td>
<td>
<p>The observed values of the test statistic for the permutational samples</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The P-value for the LRT statistic, by using the chi square approximation</p>
</td></tr>
<tr><td><code>pvalb</code></td>
<td>
<p>The P-value for the test statistic, by using permutation methods</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>The score values for each group (only for Weighted Log-rank methods)</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Sample size for each group (only for Weighted Log-rank methods)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Some code is taken from the 'interval' package and from the 'binnednp' package (citations below).
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri
</p>


<h3>References</h3>

<p>Bolker, BM (2008) Ecological models and data in R. Princeton University Press
</p>
<p>Fay MP, Shaw PA (2010) Exact and Asymptotic Weighted Logrank Tests for Interval Censored Data: The interval R Package. J Stat Softw 36:1–34
</p>
<p>Barreiro-Ures D, Francisco-Fernández M, Cao R, Fraguela BB, Doallo R, González-Andújar JL, Reyes M (2019) Analysis of interval-grouped data in weed science: The binnednp Rcpp package. Ecol Evol 9:10903–10915
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(verbascum)

modVerb &lt;- drmte(nSeeds ~ timeBef + timeAf, curveid = Species,
              fct = NPMLE(), data = verbascum)
compCDF(modVerb, units = verbascum$Dish)
</code></pre>

<hr>
<h2 id='drmte'>Fitting time-to-event models for seed science</h2><span id='topic+drmte'></span>

<h3>Description</h3>

<p>A general platform for the analysis of seed germination/emergence and other time-to-event data in agriculture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  drmte(formula, curveid, pmodels, data = NULL, subset, fct,
  start, na.action = na.omit, logDose = NULL, type = "event",
  control = drmteControl(), lowerl = NULL, upperl = NULL, separate = FALSE,
  pshifts = NULL, varcov = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drmte_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit. I must be in the form 'count <code class="reqn">~</code> start + end', where count is the number of events observed in the interval between 'start' and 'end'. Other variables can be specified after the 'start' and 'end', as needed to fit, e.g. hydro-time or thermal-time models.</p>
</td></tr>
<tr><td><code id="drmte_+3A_curveid">curveid</code></td>
<td>
<p>a numeric vector or factor containing the grouping of the data.</p>
</td></tr>
<tr><td><code id="drmte_+3A_pmodels">pmodels</code></td>
<td>
<p>a data frame with a many columns as there are parameters in the non-linear function.
Or a list containing a formula for each parameter in the nonlinear function.</p>
</td></tr>
<tr><td><code id="drmte_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="drmte_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="drmte_+3A_fct">fct</code></td>
<td>
<p>a list with three or more elements specifying the non-linear
function, the accompanying self starter function, the names of the parameter in the non-linear function and,
optionally, the first and second derivatives as well as information used for calculation of ED values.
Currently available functions include, among others, the four- and five-parameter log-logistic models
<code>LL.4</code>, <code>LL.5</code> and the Weibull model <code>W1.4</code>. Use
<code>getMeanFunctions</code> for a full list.</p>
</td></tr>
<tr><td><code id="drmte_+3A_type">type</code></td>
<td>
<p>a character string specifying the distribution of the data (parameter estimation will depend on the assumed distribution as different log likelihood functions will be used). The default is &quot;event&quot;, implying a multinomial distribution.</p>
</td></tr>
<tr><td><code id="drmte_+3A_start">start</code></td>
<td>
<p>an optional numeric vector containing starting values for all mean parameters in the model.
Overrules any self starter function.</p>
</td></tr>
<tr><td><code id="drmte_+3A_na.action">na.action</code></td>
<td>
<p>a function for treating mising values ('NA's). Default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.</p>
</td></tr>
<tr><td><code id="drmte_+3A_logdose">logDose</code></td>
<td>
<p>a numeric value or NULL. If log doses value are provided the base of the logarithm should be specified (exp(1) for the natural logarithm
and 10 for 10-logarithm).</p>
</td></tr>
<tr><td><code id="drmte_+3A_control">control</code></td>
<td>
<p>a list of arguments controlling constrained optimisation (zero as boundary),
maximum number of iteration in the optimisation,
relative tolerance in the optimisation, warnings issued during the optimisation.</p>
</td></tr>
<tr><td><code id="drmte_+3A_lowerl">lowerl</code></td>
<td>
<p>a numeric vector of lower limits for all parameters in the model
(the default corresponds to minus infinity for all parameters).</p>
</td></tr>
<tr><td><code id="drmte_+3A_upperl">upperl</code></td>
<td>
<p>a numeric vector of upper limits for all parameters in the model
(the default corresponds to plus infinity for all parameters).</p>
</td></tr>
<tr><td><code id="drmte_+3A_separate">separate</code></td>
<td>
<p>logical value indicating whether curves should be fit separately (independent of each other).</p>
</td></tr>
<tr><td><code id="drmte_+3A_pshifts">pshifts</code></td>
<td>
<p>a matrix of constants to be added to the matrix of parameters. Default is no shift for all parameters.</p>
</td></tr>
<tr><td><code id="drmte_+3A_varcov">varcov</code></td>
<td>
<p>an optional user-defined known variance-covariance matrix for the responses. Default is the identity matrix (NULL), corresponding to independent response values with a common standard deviation, which will be estimated from the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function relies on the general optimiser function <code><a href="stats.html#topic+optim">optim</a></code> for the minimisation of negative log likelihood function.
The control arguments are specified using the function <code>drmc</code>.
</p>
<p>Setting <code>lowerl</code> and/or <code>upperl</code> automatically invokes constrained optimisation.
</p>
<p>The columns of a data frame argument to <code>pmodels</code> are automatically converted into factors.
This does not happen if a list is specified.
</p>


<h3>Value</h3>

<p>An object of class 'drcte' and 'drc'.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(verbascum)
modVerb &lt;- drmte(nSeeds ~ timeBef + timeAf, curveid = Species,
             fct = NPMLE(), data = verbascum)
</code></pre>

<hr>
<h2 id='drmteControl'>Sets control arguments</h2><span id='topic+drmteControl'></span>

<h3>Description</h3>

<p>Set control arguments in the control argument in the function 'drmte()'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  drmteControl(constr = FALSE, errorm = TRUE, maxIt = 500, method="BFGS",
  noMessage = FALSE, relTol = 1e-07, rmNA=FALSE, useD = FALSE,
  trace = FALSE, otrace = FALSE, warnVal = -1, dscaleThres = 1e-15, rscaleThres = 1e-15,
  conCheck = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drmteControl_+3A_constr">constr</code></td>
<td>
<p>logical. If TRUE optimisation is constrained, only yielding non-negative parameters.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_errorm">errorm</code></td>
<td>
<p>logical specifying whether failed convergence in <code>drm</code> should result
in an error or only a warning.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_maxit">maxIt</code></td>
<td>
<p>numeric. The maximum number of iterations in the optimisation procedure.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_method">method</code></td>
<td>
<p>character string. The method used in the optimisation procedure.
See <code><a href="stats.html#topic+optim">optim</a></code> for available methods.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_nomessage">noMessage</code></td>
<td>
<p>logical, specifying whether or not messages should be displayed.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_reltol">relTol</code></td>
<td>
<p>numeric. The relative tolerance in the optimisation procedure.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_rmna">rmNA</code></td>
<td>
<p>logical. Should NAs be removed from sum of squares used for estimation?
Default is FALSE (not removed).</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_used">useD</code></td>
<td>
<p>logical. If TRUE derivatives are used for estimation (if available).</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_trace">trace</code></td>
<td>
<p>logical. If TRUE the trace from <code><a href="stats.html#topic+optim">optim</a></code> is displayed.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_otrace">otrace</code></td>
<td>
<p>logical. If TRUE the output from <code><a href="stats.html#topic+optim">optim</a></code> is displayed.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_warnval">warnVal</code></td>
<td>
<p>numeric. If equal to 0 then the warnings are stored and displayed at the end.
See under 'warn' in <code><a href="base.html#topic+options">options</a></code>. The default results in suppression of warnings.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_dscalethres">dscaleThres</code></td>
<td>
<p>numeric value specifying the threshold for dose scaling.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_rscalethres">rscaleThres</code></td>
<td>
<p>numeric value specifying the threshold for response scaling.</p>
</td></tr>
<tr><td><code id="drmteControl_+3A_concheck">conCheck</code></td>
<td>
<p>logical, switching on/off handling of control measurements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 8 components, one for each of the above arguments.
</p>


<h3>Note</h3>

<p>none, yet.</p>


<h3>Author(s)</h3>

<p>Christian Ritz</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Displaying the default settings
drmteControl()
</code></pre>

<hr>
<h2 id='ED.drcte'>Estimating the quantiles for time-to-event models</h2><span id='topic+ED.drcte'></span>

<h3>Description</h3>

<p> The function <code>ED</code> estimates the expected time to obtain a certain fraction (percentage) of individuals with events, for one or more time-to-event curves. With 'type = &quot;relative&quot;' the above fraction is regarded as relative to the maximum observed fraction. This function is included for compatibility with the 'drc' package, but the use of the 'quantile()' function is recommended, instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drcte'
ED(object, respLev, interval = c("none", "delta", "boot"),
  clevel = NULL, level = ifelse(!(interval == "none"), 0.95, NULL),
  reference = c("control", "upper"), type = c("relative", "absolute"),
  lref, uref, bound = TRUE, od = FALSE, vcov. = vcov, display = TRUE,
  pool = TRUE, logBase = NULL, multcomp = FALSE,
  intType = "confidence", rate = FALSE, B = 200,
  seed = 1234, units = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ED.drcte_+3A_object">object</code></td>
<td>
<p>an object of class 'drcte'.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_resplev">respLev</code></td>
<td>
<p>a numeric vector containing the response levels. For 'type = &quot;absolute&quot;' 'respLev' must be included between 0 and 1, while for 'type = &quot;relative&quot;', 'respLev' expresses the percentage of maximum response and must be included between 0 and 100%. </p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_interval">interval</code></td>
<td>
<p>character string specifying the type of confidence intervals to be supplied. The default is &quot;none&quot;.
See Details below for more explanation.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_clevel">clevel</code></td>
<td>
<p>character string specifying the curve id in case on estimates for a specific curve or compound is requested. By default estimates
are shown for all curves.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_reference">reference</code></td>
<td>
<p>character string. Is the upper limit or the control level the reference?</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_type">type</code></td>
<td>
<p>character string. Whether the specified response levels are absolute or relative (default).</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_lref">lref</code></td>
<td>
<p>numeric value specifying the lower limit to serve as reference.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_uref">uref</code></td>
<td>
<p>numeric value specifying the upper limit to serve as reference (e.g., 100%).</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_bound">bound</code></td>
<td>
<p>logical. If TRUE only ED values between 0 and 100% are allowed. FALSE is useful for hormesis models.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_od">od</code></td>
<td>
<p>logical. If TRUE adjustment for over-dispersion is used.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_vcov.">vcov.</code></td>
<td>
<p>function providing the variance-covariance matrix. <code><a href="stats.html#topic+vcov">vcov</a></code> is the default,
but <code>sandwich</code> is also an option (for obtaining robust standard errors).</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_display">display</code></td>
<td>
<p>logical. If TRUE results are displayed. Otherwise they are not (useful in simulations).</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE curves are pooled. Otherwise they are not. This argument only works for models with independently fitted curves as specified in <code>drm</code>.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_logbase">logBase</code></td>
<td>
<p>numeric. The base of the logarithm in case logarithm transformed dose values are used.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_multcomp">multcomp</code></td>
<td>
<p>logical to switch on output for use with the package multcomp (which needs to be activated first). Default is FALSE (corresponding to the original output).</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_inttype">intType</code></td>
<td>
<p>string specifying the type of interval to use with the predict method in case the type of confidence
interval chosen with the argument &quot;type&quot; is &quot;inverse regression.&quot;</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_rate">rate</code></td>
<td>
<p>Logical: if FALSE quantiles for time-to-events are reported (default), if TRUE, rates (inverse of times) are reported.</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_b">B</code></td>
<td>
<p>Number of bootstrap resamples for bootstrap based inference</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_seed">seed</code></td>
<td>
<p>seed for sampling methods</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_units">units</code></td>
<td>
<p>The name of a variable, coding for the experimental units, within which the observational units are clustered (e.g., Pretri dishes in germination assays)</p>
</td></tr>
<tr><td><code id="ED.drcte_+3A_...">...</code></td>
<td>
<p>see the details section below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are several options for calculating confidence intervals through the argument <code>interval</code>. The option &quot;none&quot; (default) does not provide confidence intervals. The option &quot;delta&quot; results in asymptotical Wald-type confidence intervals (using the delta method and the normal distribution) and it is only available for parametric time-to-event models. The option &quot;boot&quot; provides bootraspped confidence intervals and it is only available for NPMLE or KDE curves; it may be rather slow. For (<code><a href="#topic+KDE">KDE</a></code> models, the additional arguments <code>lower</code> and <code>upper</code> may be supplied. These arguments specify the lower and upper limits of the bisection method used to find the ED values.  The lower and upper limits need to be smaller/larger than the EDx level to be calculated. The default limits are 0 and 1</p>


<h3>Value</h3>

<p> An invisible matrix containing the shown matrix with two or more columns, containing the estimates and the corresponding estimated standard errors and possibly lower and upper confidence limits. Or, alternatively, a list with elements that may be plugged directly into <code>parm</code> in the package <em>multcomp</em> (in case the argument <code>multcomp</code> is TRUE).
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri</p>


<h3>See Also</h3>

<p>The 'quantile()' function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>start &lt;- c(0, 6, 7, 10, 13, 16, 22, 23)
end &lt;- c(6, 7, 10, 13, 16, 22, 23, Inf)
count &lt;- c(3, 9, 3, 8, 1, 1, 5, 5)

# Fitting a non-parametric time-to-event model
mod &lt;- drmte(count ~ start + end, fct = NPMLE())

# Getting the times required to reach three different fractions
# of individuals with events (i.e.: 0.1, 0.3 and 0.5)
ED(mod, respLev = c(0.10, 0.30, 0.50), type = "absolute")

# Getting the times required to reach three 10, 30 and 50%
# of the maximum fraction of individuals with events
ED(mod, respLev = c(10, 30, 50), type = "relative")
</code></pre>

<hr>
<h2 id='KDE'>
Kernel estimator for the cumulative distribution function
</h2><span id='topic+KDE'></span><span id='topic+KDE.fun'></span>

<h3>Description</h3>

<p>This function provides the kernel estimator for the distribution function for interval‐grouped data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KDE(bw = c("AMISE", "boot"))
KDE.fun(x, start, end, count, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KDE_+3A_x">x</code></td>
<td>
<p>for time-to-event data, the predictor variable is time</p>
</td></tr>
<tr><td><code id="KDE_+3A_start">start</code></td>
<td>
<p>for each assessment interval, this is the start time</p>
</td></tr>
<tr><td><code id="KDE_+3A_end">end</code></td>
<td>
<p>for each assessment interval, this is the end time</p>
</td></tr>
<tr><td><code id="KDE_+3A_count">count</code></td>
<td>
<p>for each assessment interval, this is the number of events</p>
</td></tr>
<tr><td><code id="KDE_+3A_h">h</code></td>
<td>
<p>bandwidth value</p>
</td></tr>
<tr><td><code id="KDE_+3A_bw">bw</code></td>
<td>
<p>Method for bandwidth selection</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function 'KDE.fun()' provides the kernel estimator for the distribution function, as modified for interval-grouped data. The equation is:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \sum {w_i * pnorm( \frac{x - t_i}{h}) }</code>
</p>

<p>where 'w_i' is the observed proportion of individuals getting the event in the i-th interval, 't_i' is the mid-point of the i-th time interval, 'x' is the time and 'h' is the bandwidth. The function KDE() is meant to be used with the 'drmte()' function, to estimate the optimal bandwidth, according to a bootstrap selector (Barreiro-Ures et al., 2019).
</p>


<h3>Value</h3>

<p>The 'KDE.fun()' functions returns the CDF, for given values of time. The KDE() function returns a list containing the nonlinear function and other facilities, which are internally used by the 'drmte()' function.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri. Codes for the estimation of optimal bandwidth have been largely taken from the 'binnednp' package (Barreiro-Ures et al., 2019).
</p>


<h3>References</h3>

<p>Barreiro‐Ures, D., Francisco‐Fernández, M., Cao, R., Fraguela, B.B., Doallo, R., González‐Andújar, J.L., Reyes, M., 2019. Analysis of interval‐grouped data in weed science: The binnednp Rcpp package. Ecol Evol 9, 10903–10915.
</p>
<p>Cao, R., Francisco-Fernández, M., Anand, A., Bastida, F., González-Andújar, J.L., 2013. Modeling Bromus diandrus Seedling Emergence Using Nonparametric Estimation. Journal of Agricultural, Biological, and Environmental Statistics 18, 64–86.
</p>
<p>Cao, R., Francisco-Fernández, M., Anand, A., Bastida, F., González-Andújar, J.L., 2011. Computing statistical indices for hydrothermal times using weed emergence data. The Journal of Agricultural Science 149, 701–712.
</p>
<p>Gonzalez-Andujar, J.L., Francisco-Fernandez, M., Cao, R., Reyes, M., Urbano, J.M., Forcella, F., Bastida, F., 2016. A comparative study between nonlinear regression and nonparametric approaches for modelling Phalaris paradoxa seedling emergence. Weed Research 56, 367–376.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chickweed)
mod &lt;- drmte(count ~ start + end, data=chickweed,
              fct = KDE())
summary(mod)
plot(mod, ylim = c(0, 0.25), log = "")
</code></pre>

<hr>
<h2 id='loglogistic'>
Log-logistic distribution of germination times within a seed lot
</h2><span id='topic+loglogistic'></span><span id='topic+loglogisticSurv'></span>

<h3>Description</h3>

<p>This function provides the truncated log-logistic cumulative distribution of germination times, to be used to fit time-to-event methods to the time-course of seed germination for a seed lot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglogistic(fixed = c(NA, NA, NA), names = c("b", "d", "e"))
loglogisticSurv(fixed = c(NA, NA, NA), names = c("b", "d", "e"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglogistic_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed. It is often used to fix the 'd' parameter to 1, which provides the usual log-logistic distribution, with no ungerminated fraction.
</p>
</td></tr>
<tr><td><code id="loglogistic_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-logistic distribution of germination times is parameterised as:
</p>
<p style="text-align: center;"><code class="reqn"> P(t) = \frac{d}{(1+\exp( - b(\log(t)-\log(e))))}</code>
</p>

<p>where 't' is the time and 'P(t)' is the proportion of germinated seeds at time = t. LogLogisticSurv is parameterised as usual in survival analysis:
</p>
<p style="text-align: center;"><code class="reqn"> P(t) = \frac{d}{(1+\exp( - (\log(t)-e)/exp(b)))}</code>
</p>

<p>i.e. with 'e' on a log-scale and a log-link on 'b'. With no cured fraction (d = 1), loglogisticSurv gives same results as 'survereg' in the 'survival package', with 'dist = &quot;loglogistic&quot;'.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri
</p>


<h3>References</h3>

<p>Kleinbaum, D.G., Klein, M., 2005. Survival analysis. Springer Science, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(drcte)
data(chickweed)
modb &lt;- drmte(count ~ start + end,
               data=chickweed,
               fct = loglogistic())
</code></pre>

<hr>
<h2 id='lognormal'>
Log-normal distribution of times to an event
</h2><span id='topic+lognormal'></span><span id='topic+lognormalSurv'></span>

<h3>Description</h3>

<p>This function provides the truncated log-normal cumulative distribution of event times, to be used to fit time-to-event methods to the time-course of seed germination for a seed lot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lognormal(fixed = c(NA, NA, NA), names = c("b", "d", "e"))
lognormalSurv(fixed = c(NA, NA, NA), names = c("b", "d", "e"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lognormal_+3A_fixed">fixed</code></td>
<td>
<p>numeric vector. Specifies which parameters are fixed and at what value they are fixed. NAs for parameter that are not fixed. It is often used to fix the 'd' parameter to 1, which provides the usual log-logistic distribution, with no ungerminated fraction.
</p>
</td></tr>
<tr><td><code id="lognormal_+3A_names">names</code></td>
<td>
<p>a vector of character strings giving the names of the parameters. The default is reasonable.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-normal distribution of germination times is parameterised as:
</p>
<p style="text-align: center;"><code class="reqn"> P(t) = d * pnorm(b*(log(t + 0.000001) - log(d)))</code>
</p>

<p>where 't' is the time and 'P(t)' is the proportion of germinated seeds at time = t. LogNormalSurv is parameterised as usual in survival analysis:
</p>
<p style="text-align: center;"><code class="reqn"> P(t) = d * pnorm(b*(log(t + 0.000001) - d))</code>
</p>

<p>i.e. with 'e' on a log-scale and a log-link on 'b'. With no cured fraction (d = 1), logNormalSurv gives same results as 'survereg' in the 'survival package', with 'dist = &quot;lognormal&quot;'.
</p>


<h3>Value</h3>

<p>The value returned is a list containing the nonlinear function, the self starter function and the parameter names.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri
</p>


<h3>References</h3>

<p>Kleinbaum, D.G., Klein, M., 2005. Survival analysis. Springer Science, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(drcte)
data(chickweed)
modb &lt;- drmte(count ~ start + end,
               data=chickweed,
               fct = lognormal())
</code></pre>

<hr>
<h2 id='lotus'>
Germination assay with Lotus ornithopodioides
</h2><span id='topic+lotus'></span>

<h3>Description</h3>

<p>Seeds of L. ornithopodioides were harvested in three stages after anthesis and the time course of their germination was evaluated in Petri dishes. The dataset is organised as required by time-to-event analyses with the drc package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lotus")</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 7 variables.
</p>

<dl>
<dt><code>Stage</code></dt><dd><p>a character vector coding for the maturation stage</p>
</dd>
<dt><code>Dish</code></dt><dd><p>a numeric vector coding for the Petri Dish</p>
</dd>
<dt><code>timeBef</code></dt><dd><p>a numeric vector: beginning of scoring interval</p>
</dd>
<dt><code>timeAf</code></dt><dd><p>a numeric vector: end of scoring interval</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector: count of germinated seeds in each scoring interval</p>
</dd>
<dt><code>nCum</code></dt><dd><p>a numeric vector: cumulative count of germinated seeds</p>
</dd>
<dt><code>propCum</code></dt><dd><p>a numeric vector: cumulative proportions of germinated seeds</p>
</dd>
</dl>



<h3>Details</h3>

<p>There were 25 seeds per Petri dish. Seeds of Lotus ornithopodioides were harvested at the following stages (A) Green fleshy pods with brilliant gree sedds (27 Days After Anthesis; DAA), (B) green pergamenous pods with brown soft seeds (35 DAA) and (C) green pergamenous pods with brown seeds and moderately hard (41 DAA).
</p>


<h3>Source</h3>

<p>Data are kindly provided by Fabio Gresta (University of Reggio Calabria, Italy).</p>


<h3>References</h3>

<p>Gresta, F., Avola, G., Onofri, A., Anastasi, U., Cristaudo, A., 2011. When Does Hard Coat Impose Dormancy in Legume Seeds? Lotus and Scorpiurus Case Study. Crop Science 51, 1739–1747.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lotus)
library(drcte)
#A constraint was put on the second curve (Stage B), in order to avoid an estimate higher than 1.
mod &lt;- drmte(count ~ timeBef + timeAf, data=lotus, fct=LL.3(),
           curveid=Stage, upperl = c(NA, 1, NA))
summary(mod)
</code></pre>

<hr>
<h2 id='lotusCum'>
Germination assay with Lotus ornithopodioides
</h2><span id='topic+lotusCum'></span>

<h3>Description</h3>

<p>Seeds of L. ornithopodioides were harvested in three stages after anthesis and the time course of their germination was evaluated in Petri dishes. This is the dataset as required for nonlinear regression analysis and needs to be transformed into a form that is suitable for time-to-event analysis in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lotusCum")</code></pre>


<h3>Format</h3>

<p>A data frame with 180 observations on the following 6 variables.
</p>

<dl>
<dt><code>Stage</code></dt><dd><p>a factor with levels <code>A</code> <code>B</code> <code>C</code></p>
</dd>
<dt><code>Dish</code></dt><dd><p>a numeric vector: code for Petri dishes</p>
</dd>
<dt><code>Time</code></dt><dd><p>a numeric vector: inspection time in days</p>
</dd>
<dt><code>nSeeds</code></dt><dd><p>a numeric vector: number of germinated seeds at each time</p>
</dd>
<dt><code>nCum</code></dt><dd><p>a numeric vector: cumulative number of germinated seeds at each time</p>
</dd>
<dt><code>Prop</code></dt><dd><p>a numeric vector: cumulative proportion of germinated seeds at each time</p>
</dd>
</dl>



<h3>Details</h3>

<p>There were 25 seeds per Petri dish. The columns represent the characteristics of each Petri dish. The columns from 1 to 15 represent the number of germinated seeds counted in each assessment time. Seeds of Lotus ornithopodioides were harvested at the following stages (A) Green fleshy pods with brilliant gree sedds (27 Days After Anthesis; DAA), (B) green pergamenous pods with brown soft seeds (35 DAA) and (C) green pergamenous pods with brown seeds and moderately hard (41 DAA).
</p>


<h3>Source</h3>

<p>Data are kindly provided by Fabio Gresta (University of Reggio Calabria, Italy).
</p>


<h3>References</h3>

<p>Gresta, F., Avola, G., Onofri, A., Anastasi, U., Cristaudo, A., 2011. When Does Hard Coat Impose Dormancy in Legume Seeds? Lotus and Scorpiurus Case Study. Crop Science 51, 1739–1747.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lotusCum)
data(lotusCum)
dataset_sd &lt;- decumulate_te(lotusCum,
                            resp = nCum,
                            treat_cols = Stage,
                            monitimes = Time,
                            units = Dish,
                            n.subjects = rep(25, 12),
                            type = "count")

dataset_sd &lt;- decumulate_te(lotusCum,
                            resp = Prop,
                            treat_cols = "Stage",
                            monitimes = Time,
                            units = Dish,
                            n.subjects = rep(25, 12),
                            type = "proportion")
</code></pre>

<hr>
<h2 id='lotusOr'>
Germination assay with Lotus ornithopodioides
</h2><span id='topic+lotusOr'></span>

<h3>Description</h3>

<p>Seeds of L. ornithopodioides were harvested in three stages after anthesis and the time course of their germination was evaluated in Petri dishes. This is the original dataset, as collected by the technicians and needs to be transformed into a form that is suitable for time-to-event analysis in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lotusOr")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 17 variables.
</p>

<dl>
<dt><code>Stage</code></dt><dd><p>a factor with levels <code>A</code> <code>B</code> <code>C</code></p>
</dd>
<dt><code>Dish</code></dt><dd><p>a numeric vector: code of Petri dish</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 1</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;2&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 2</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;3&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 3</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;4&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 4</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;5&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 5</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;6&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 6</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;7&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 7</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;8&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 8</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;9&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 9</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;10&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 10</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;11&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 11</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;12&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 12</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;13&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 13</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;14&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 14</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;15&#8288;</span>&rsquo;</dt><dd><p>a numeric vector: counts at day 15</p>
</dd>
</dl>



<h3>Details</h3>

<p>Every line of data represents a Petri dish. There were 25 seeds per Petri dish. The columns represent the characteristics of each Petri dish. The columns from 1 to 15 represent the number of germinated seeds counted in each assessment time. Seeds of Lotus ornithopodioides were harvested at the following stages (A) Green fleshy pods with brilliant gree sedds (27 Days After Anthesis; DAA), (B) green pergamenous pods with brown soft seeds (35 DAA) and (C) green pergamenous pods with brown seeds and moderately hard (41 DAA).
</p>


<h3>Source</h3>

<p>Data are kindly provided by Fabio Gresta (University of Reggio Calabria, Italy).
</p>


<h3>References</h3>

<p>Gresta, F., Avola, G., Onofri, A., Anastasi, U., Cristaudo, A., 2011. When Does Hard Coat Impose Dormancy in Legume Seeds? Lotus and Scorpiurus Case Study. Crop Science 51, 1739–1747. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lotusOr)
datasetG &lt;- melt_te(lotusOr, count_cols = 3:17, treat_cols = Stage,
            monitimes = 1:15, n.subjects = rep(25,12))
head(datasetG, 16)
</code></pre>

<hr>
<h2 id='NPMLE'>
NPMLE for time-to-event data
</h2><span id='topic+NPMLE'></span><span id='topic+NPMLE.fun'></span>

<h3>Description</h3>

<p>This function provides the non-parametric maximum likelihood estimator for time-to-event data for the distribution function for interval‐grouped data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPMLE()
</code></pre>


<h3>Arguments</h3>

<p>This function has no arguments
</p>


<h3>Details</h3>

<p>The function 'KDE()' provides the NPMLE for the cumulative distribution function of time-to-event data. It uses the algorithms proposed in the 'interval' package (Fay and Shaw, 2010)
</p>


<h3>Value</h3>

<p>The 'KDE()' function returns a list containing the nonlinear function and other facilities, which are internally used by the 'drmte()' function.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri. Codes for the estimation have been largely taken from the 'interval' package (Fay and Shaw, 2010).
</p>


<h3>References</h3>

<p>Michael P. Fay, Pamela A. Shaw (2010). Exact and Asymptotic Weighted Logrank
Tests for Interval Censored Data: The interval R Package. Journal of Statistical
Software, 36(2), 1-34. URL https://www.jstatsoft.org/v36/i02/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(chickweed)
mod &lt;- drmte(count ~ start + end, data=chickweed,
              fct = NPMLE())
summary(mod)
plot(mod, ylim = c(0, 0.25), log = "")
</code></pre>

<hr>
<h2 id='plot.drcte'>Plotting fitted time-to-event models</h2><span id='topic+plot.drcte'></span>

<h3>Description</h3>

<p><code>plot</code> displays fitted curves and observations in the same plot window, distinguishing between curves by different plot symbols and line types.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  ## S3 method for class 'drcte'
plot(x, ..., add = FALSE, level = NULL, shading = TRUE,
  type = "all",
  npmle.type = c("interpolation", "midpoint", "right", "left", "none"),
  npmle.points = FALSE, kde.points = TRUE,
  broken = FALSE, bp, bcontrol = NULL, conName = NULL, axes = TRUE,
  gridsize = 100, log = "", xtsty, xttrim = TRUE,
  xt = NULL, xtlab = NULL, xlab, xlim,
  yt = NULL, ytlab = NULL, ylab, ylim,
  cex, cex.axis = 1, col = FALSE, lty, pch,
  legend, legendText, legendPos, cex.legend = 1,
  normal = FALSE, normRef = 1, confidence.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.drcte_+3A_x">x</code></td>
<td>
<p>an object of class 'drcte'.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_...">...</code></td>
<td>
<p>additional graphical arguments. For instance, use <code>lwd=2</code> or <code>lwd=3</code> to increase the width of plot symbols.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_add">add</code></td>
<td>
<p>logical. If TRUE then add to already existing plot.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_level">level</code></td>
<td>
<p>vector of character strings. To plot only the curves specified by their identification number.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_shading">shading</code></td>
<td>
<p>For NPMLE, it prints shading on the graphs for the points where the likelihood value is not unique. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_type">type</code></td>
<td>
<p>it has been left for analogy with the plot method for 'drc' objects, but it is neglected in the case of 'drcte' objects.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_npmle.type">npmle.type</code></td>
<td>
<p>the NPMLE of the cumulative density function is only specified at the end of each inspection interval, while it is not unique within each interval. This argument specifies how the CDF increases within each interval: possible values are &quot;interpolation&quot; (it is assumed that the CDF increases progressively), &quot;left&quot; (the CDF increases at the beginning of each interval), &quot;right&quot; (the CDF increases at the end of each interval; it is very common in survival analysis) and &quot;midpoint&quot; (the CDF increases in the middle of each interval; it is very common in survival analysis). This argument is neglected with parametric and KDE fits.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_npmle.points">npmle.points</code></td>
<td>
<p>If F, with NPMLE fits, plotting the NPMLEs at the end of each interval as symbols is suppressed. Not implemented, yet.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_kde.points">kde.points</code></td>
<td>
<p>If F, with KDE fits, plotting the NPMLE at the end of each interval is suppressed</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_broken">broken</code></td>
<td>
<p>logical. If TRUE the x axis is broken provided this axis is logarithmic
(using functionality in the CRAN package 'plotrix').</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_bp">bp</code></td>
<td>
<p>numeric value specifying the break point below which the dose is zero (the amount of stretching on
the dose axis above zero in order to create the visual illusion of a logarithmic scale <em>including</em> 0).
The default is the base-10 value corresponding to the rounded value of the minimum of the log10 values of
all positive dose values. This argument is only working for logarithmic dose axes.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_bcontrol">bcontrol</code></td>
<td>
<p>a list with components <code>factor</code>, <code>style</code> and <code>width</code>.
Controlling the appearance of the break (in case <code>broken</code> is <code>TRUE</code>).
The component <code>factor</code> is the distance from the control to the break as a
multiple of the value of <code>bp</code> (default is 2).
The component <code>style</code> can take the values: <code>gap</code>, <code>slash</code> or <code>zigzag</code>.
The component <code>width</code> is the width of the break symbol (default is 0.02).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_conname">conName</code></td>
<td>
<p>character string. Name on x axis for dose zero. Default is '&quot;0&quot;'.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_axes">axes</code></td>
<td>
<p>logical indicating whether both axes should be drawn on the plot.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_gridsize">gridsize</code></td>
<td>
<p>numeric. Number of points in the grid used for plotting the fitted curves.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_log">log</code></td>
<td>
<p>a character string which contains '&quot;x&quot;' if the x axis is to be logarithmic, '&quot;y&quot;' if the y axis is to be logarithmic and '&quot;xy&quot;' or
'&quot;yx&quot;' if both axes are to be logarithmic. The default is &quot;x&quot;. The empty string &quot;&quot; yields the original axes.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xtsty">xtsty</code></td>
<td>
<p>a character string specifying the dose axis style for arrangement of tick marks. By default (&quot;base10&quot;)
For a logarithmic axis by default only base 10 tick marks are shown (&quot;base10&quot;). Otherwise sensible
equidistantly located tick marks are shown (&quot;standard&quot;), relying on <code><a href="graphics.html#topic+axTicks">axTicks</a></code>.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xttrim">xttrim</code></td>
<td>
<p>logical specifying if the number of tick marks should be trimmed in case too many tick marks
are initially determined.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xt">xt</code></td>
<td>
<p>a numeric vector containing the positions of the tick marks on the x axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xtlab">xtlab</code></td>
<td>
<p>a vector containing the tick marks on the x axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xlab">xlab</code></td>
<td>
<p>an optional label for the x axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the x axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_yt">yt</code></td>
<td>
<p>a numeric vector, containing the positions of the tick marks on the y axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_ytlab">ytlab</code></td>
<td>
<p>a vector containing the tick marks on the y axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_ylab">ylab</code></td>
<td>
<p>an optional label for the y axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_ylim">ylim</code></td>
<td>
<p>a numeric vector of length two, containing the lower and upper limit for the y axis.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_cex">cex</code></td>
<td>
<p>numeric or numeric vector specifying the size of plotting symbols and text
(see <code><a href="graphics.html#topic+par">par</a></code> for details).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric value specifying the magnification to be used for axis annotation
relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_col">col</code></td>
<td>
<p>either logical or a vector of colours. If TRUE default colours are used.
If FALSE (default) no colours are used.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_legend">legend</code></td>
<td>
<p>logical. If TRUE a legend is displayed.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_legendtext">legendText</code></td>
<td>
<p>a character string or vector of character strings specifying the legend text
(the position of the upper right corner of the legend box).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_legendpos">legendPos</code></td>
<td>
<p>numeric vector of length 2 giving the position of the legend.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_cex.legend">cex.legend</code></td>
<td>
<p>numeric specifying the legend text size.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_lty">lty</code></td>
<td>
<p>a numeric vector specifying the line types.</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_pch">pch</code></td>
<td>
<p>a vector of plotting characters or symbols (see <code><a href="graphics.html#topic+points">points</a></code>).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_normal">normal</code></td>
<td>
<p>logical. If TRUE the plot of the normalized data and fitted curves are shown
(for details see Weimer et al. (2012) for details).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_normref">normRef</code></td>
<td>
<p>numeric specifying the reference for the normalization (default is 1).</p>
</td></tr>
<tr><td><code id="plot.drcte_+3A_confidence.level">confidence.level</code></td>
<td>
<p>confidence level for error bars. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot method for 'drcte' objects inherits from the plot method for 'drc' objects and adds functionalities for nonparametric time-to-event fits. For parametric time-to-event models, the fitted curve is presented, together with symbols, corresponding to the NPMLE estimator of the cumulative distribution function at the end of each observation interval. For NPMLE fits, the cumulative CDF at the end of each interval is presented and the way that the density increases during the interval is specified through the argument 'npmle.type'. For KDE fits, the cumulative density is presented as a line, while the observed NPMLE of the CDF at the end of each interval can be either presented as symbols or suppressed. For all other information, please consult ?plot.drc. This method does not work for models with environmental covariates.
</p>


<h3>Value</h3>

<p>An invisible data frame with the values used for plotting the fitted curves. The first column contains the dose values, and the following columns (one for each curve) contain the fitted response values.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri</p>


<h3>References</h3>

<p>Weimer, M., Jiang, X., Ponta, O., Stanzel, S., Freyberger, A., Kopp-Schneider, A. (2012)
The impact of data transformations on concentration-response modeling.
<em>Toxicology Letters</em>, <b>213</b>, 292&ndash;298.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(drcte)
data(verbascum)
mod &lt;- drmte(nSeeds ~ timeBef + timeAf, fct = NPMLE(),
                 data = verbascum, curveid = Species)
plot(mod)
</code></pre>

<hr>
<h2 id='plotData'>Data for plotting fitted time-to-event models</h2><span id='topic+plotData'></span>

<h3>Description</h3>

<p><code>plotData</code> returns the data for plotting a regression model with other plotting packages, such as ggplot2</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plotData(x, xlim, confidence.level = 0.95, gridsize = 100,
  type = c("average", "all", "bars", "none", "obs", "confidence"),
  npmle.type = c("interpolation", "midpoint", "right", "left","none"))
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotData_+3A_x">x</code></td>
<td>
<p>an object of class 'drcte' or 'drc'.</p>
</td></tr>
<tr><td><code id="plotData_+3A_xlim">xlim</code></td>
<td>
<p>as in the basic plot method: the x-range for plotting</p>
</td></tr>
<tr><td><code id="plotData_+3A_confidence.level">confidence.level</code></td>
<td>
<p>For confidence intervals</p>
</td></tr>
<tr><td><code id="plotData_+3A_gridsize">gridsize</code></td>
<td>
<p>the gridsize for predictions</p>
</td></tr>
<tr><td><code id="plotData_+3A_type">type</code></td>
<td>
<p>it has been left for analogy with the plot method for 'drc' objects, but it is neglected in the case of 'drcte' objects.</p>
</td></tr>
<tr><td><code id="plotData_+3A_npmle.type">npmle.type</code></td>
<td>
<p>the NPMLE of the cumulative density function is only specified at the end of each inspection interval, while it is not unique within each interval. This argument specifies how the CDF increases within each interval: possible values are &quot;interpolation&quot; (it is assumed that the CDF increases progressively), &quot;left&quot; (the CDF increases at the beginning of each interval), &quot;right&quot; (the CDF increases at the end of each interval; it is very common in survival analysis) and &quot;midpoint&quot; (the CDF increases in the middle of each interval; it is very common in survival analysis). This argument is neglected with parametric and KDE fits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plotData method for 'drcte' objects is used to get the data for plotting with ggplot2.</p>


<h3>Value</h3>

<p>A list with two elements. The first element (plotPoints) contains the data for plotting the observed values, the second element (plotFits) contains the data for plotting curves.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(drcte)
data(verbascum)
mod &lt;- drmte(nSeeds ~ timeBef + timeAf, fct = LL.3(),
                 data = verbascum, curveid = Species)
plotData(mod)
</code></pre>

<hr>
<h2 id='predict.drcte'>Prediction</h2><span id='topic+predict.drcte'></span><span id='topic+predict.list'></span>

<h3>Description</h3>

<p>Predicting probabilities for models of class 'drcte'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drcte'
predict(object, newdata, se.fit = FALSE,
  interval = FALSE,
  level = 0.95, na.action = na.pass,
  npmle.type = c("interpolation", "left", "right", "midpoint"),
  robust = FALSE, units = NULL, B = 200, ...)
  ## S3 method for class 'list'
predict(object, newdata, coefs, vcov. = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.drcte_+3A_object">object</code></td>
<td>
<p>an object of class 'drcte' or a list representing a time-to-event model (e.g.: LL.3(), LN.3()... )</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_newdata">newdata</code></td>
<td>
<p>A data frame in which to look for variables with which to predict. The first variable, must always be the time at which predictions are sought; if necessary, other covariates can be added in succeeding columns, in the same order as they are specified by the fitted model. For models where time is the only predictor, 'newdata' can also be provided as a vector.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_se.fit">se.fit</code></td>
<td>
<p>logical. If TRUE standard errors are provided.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_interval">interval</code></td>
<td>
<p>logical. If TRUE confidence intervals are provided.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_level">level</code></td>
<td>
<p>Confidence level.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_na.action">na.action</code></td>
<td>
<p>function determining what should be done with missing values in 'newdata'. The default is to predict 'NA'.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_npmle.type">npmle.type</code></td>
<td>
<p>character string relating to the type of prediction for NPMLE. For interval censored observations there is not a unique MLE for a specific time, and, therefore, predictions can be obtained by three methods: &quot;interpolation&quot; (default; predictions are sought on the line connecting the two points bounding the non-unique MLE interval), &quot;left&quot; (taking the left side of the non-unique MLE interval) or &quot;right&quot; (taking the right side of the non-unique MLE interval. The argument is neglected for parametric or kernel based time-to-event models.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_robust">robust</code></td>
<td>
<p>a logical value. If TRUE, robust confidence interval are provided (see below for detail)</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_units">units</code></td>
<td>
<p>a vector coding for randomisation units or other clustering structures. It causes a cluster robust standard error to be provided.</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_b">B</code></td>
<td>
<p>Number of bootstrap resamples for bootstrap based inference</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_coefs">coefs</code></td>
<td>
<p>The coefficients of a parametric fit</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_vcov.">vcov.</code></td>
<td>
<p>Variance-covariance matrix</p>
</td></tr>
<tr><td><code id="predict.drcte_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With parametric models, ‘naive’ (asymptotic) standard errors are obtained by using the 'delta method, in association to the second derivative of the likelihood function. For seed germination and emergence assays, the observational units are the individual seeds and, most often, they are clustered within randomisation units (e.g., Petri dishes or other types of containers), to which the experimental treatments are allocated. For these and other cases of clustered data, cluster-robust SEs can be obtained by using the so-called ‘sandwich estimator’ (Carroll et al. 1998), which has proven reliable for clustered survival data (Yu and Peng 2008). Robust SEs are obtained by exploiting the facilities provided in the ‘sandwich’ package (Zeileis et al. 2020).</p>


<h3>Value</h3>

<p>A vector (when 'newdata' is missing and 'se.fit' = 'interval' = FALSE) or a data.frame with as many rows as in 'newdata' (or as in the original dataset, when 'newdata' is missing) and a set of columns containing predictors, predictions, standard errors, lower and upper limits of confidence intervals.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, borrowing code from Christian Ritz</p>


<h3>References</h3>

<p>Carroll RJ, Wang S, Simpson DG, Stromberg AJ, Ruppert D (1998) The sandwich (robust covariance matrix) estimator. Technical report, Department of statistics. A&amp;M University. Texas (USA)
</p>
<p>Onofri, A., Mesgaran, M., &amp; Ritz, C. (2022). A unified framework for the analysis of germination, emergence, and other time-to-event data in weed science. Weed Science, 1-13. doi:10.1017/wsc.2022.8
</p>
<p>Yu B, Peng Y (2008) Mixture cure models for multivariate survival data. Comput Stat Data Anal 52:1524–1532
</p>
<p>Zeileis A, Koell S, Graham N (2020) Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R. J Stat Softw 95
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(drcte)
data(chickweed)
modb &lt;- drmte(count ~ start + end,
               data=chickweed,
               fct = LL.3())
predict(modb, se.fit = TRUE, interval = TRUE,
newdata = data.frame(time = c(1, 10, 100, 250)))
</code></pre>

<hr>
<h2 id='quantile.drcte'>Estimating quantiles for time-to-event models</h2><span id='topic+quantile.drcte'></span>

<h3>Description</h3>

<p>This function estimates the quantiles for time-to-events data, either for the whole sample (restricted = FALSE) or only for the fraction of individuals with events (restricted = TRUE). The quantiles for rates (the inverse of times) are also available, by using the 'rate = TRUE' option. The quantiles represent the time/rate to reach a given fraction of individuals with event</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drcte'
quantile(x, probs, restricted = FALSE, rate = FALSE,
                           interval = FALSE,
                           level = ifelse(!(interval == "none"), 0.95, NULL),
                           robust = FALSE, B = 999, units = NULL,
                           display = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile.drcte_+3A_x">x</code></td>
<td>
<p>an object of class 'drcte'.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_probs">probs</code></td>
<td>
<p>a vector with the sought probabilities; the values must be included between 0 and 1.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_restricted">restricted</code></td>
<td>
<p>a logical value: if FALSE, the quantiles are calculated for the whole sample (the default); if TRUE, only the fraction of individuals with events is considered.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_rate">rate</code></td>
<td>
<p>a logical value: if FALSE quantiles for time-to-events are reported (default), if TRUE, rates (inverse of times) are reported.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_interval">interval</code></td>
<td>
<p>a logical value: if TRUE, confidence intervals are supplied. The default is FALSE. See Details below for more explanation.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_level">level</code></td>
<td>
<p>numeric. The level for the confidence intervals. The default is 0.95.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_robust">robust</code></td>
<td>
<p>a logical value: if TRUE, robust standard error and confidence intervals are reported. The default is FALSE.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_b">B</code></td>
<td>
<p>Number of bootstrap resamples for bootstrap based inference</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_units">units</code></td>
<td>
<p>a vector coding for randomisation units or other clustering structures. It causes a cluster robust standard error to be provided.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_display">display</code></td>
<td>
<p>a logical value: if TRUE (default), the results are displayed at the end of calculations.</p>
</td></tr>
<tr><td><code id="quantile.drcte_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods. In particular, it is used to pass environmental covariates, wherever necessary</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantiles for parametric models are calculated by using the inverse of the cumulative probability function. For NPMLE fits, it is assumed that events are evenly spread within each Turnbull interval and the quantiles are the values corresponding to the abscissas of the points where the horizontal line starting from the selected percentile crosses the time-to-event line. For KDE fits, quantiles are calculated from the time-to-event curve by the bisection method, which can be rather slow. If requested, confidence intervals are calculated, according to the type of time-to-event model. For parametric models, standard errors are calculated by using the delta method with Wald-type confidence intervals (normal distribution). If robust = TRUE, a sandwich estimator of the variance-covariance matrix is used, which is in its cluster-robust form, if a 'units' variable is provided, containing the coding fro Petri dishes, other grouping structures. For NPMLE fits, bootrapped confidence intervals are provided, based on B resamples (default to 1000); if the 'units' argument is provided, the cluster-robust version of the bootstrap is used. For KDE fits, standard errors and confidence intervals are not yet provided.</p>


<h3>Value</h3>

<p>An invisible matrix containing the shown matrix with two or more columns, containing the estimates and the corresponding estimated standard errors and possibly lower and upper confidence limits.</p>


<h3>Author(s)</h3>

<p>Andrea Onofri</p>


<h3>See Also</h3>

<p>The 'ED()' function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>start &lt;- c(0, 6, 7, 10, 13, 16, 22, 23)
end &lt;- c(6, 7, 10, 13, 16, 22, 23, Inf)
count &lt;- c(3, 9, 3, 8, 1, 1, 5, 5)

# Fitting a non-parametric time-to-event model
mod &lt;- drmte(count ~ start + end, fct = NPMLE())

# Getting the times required to reach three different fractions
# of individuals with events (i.e.: 0.1, 0.3 and 0.5), either including
# the whole lot of individuals, or only the individuals with events
quantile(mod, probs = c(0.10, 0.30, 0.50))
quantile(mod, probs = c(0.10, 0.30, 0.50), restricted = TRUE)
</code></pre>

<hr>
<h2 id='reshape_te'>
Reshaping time-to-event datasets</h2><span id='topic+melt_te'></span><span id='topic+decumulate_te'></span><span id='topic+group_te'></span><span id='topic+ungroup_te'></span>

<h3>Description</h3>

<p>This is a set of functions that can be used to transform time-to-event datasets into a form that is amenable for data analyses with the 'drc' and 'drcte' packages</p>


<h3>Usage</h3>

<pre><code class='language-R'>melt_te(data = NULL, count_cols, treat_cols, monitimes,
n.subjects = NULL, grouped = TRUE)
decumulate_te(data = NULL, resp, treat_cols, monitimes,
units, n.subjects, type = c("count", "proportion"))
group_te(data)
ungroup_te(data, counts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reshape_te_+3A_data">data</code></td>
<td>
<p>a data frame to be reshaped. In this data frame, each row represents a container (e.g., a Petri dish) and each column represents a piece of information about that container, including the counts of germinated seeds at each inspection time.</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_count_cols">count_cols</code></td>
<td>
<p>a numeric vector, specifying the positions (not names) of the columns containing the counts in 'data'</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_treat_cols">treat_cols</code></td>
<td>
<p>a vector, specifying the positions/names of the columns containing the treatment levels in 'data'</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_monitimes">monitimes</code></td>
<td>
<p>a numeric vector of monitoring times. Must be of same length as 'count_cols'</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_n.subjects">n.subjects</code></td>
<td>
<p>a numeric vector listing the number of viable seeds for each container (e.g., Petri dish). It may be either of length one (if it is the same for all randomisation units) or it must have same length as the number of rows in 'data' and 'treat_cols'. With the function 'melt_te()', it is also possible to pass a reference to the name of a variable in 'data', containing the number of individuals. If missing, it is assumed that all individuals experienced the event and there is no 'cured' fraction.</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_grouped">grouped</code></td>
<td>
<p>logical: specifying whether the output should be in LONG GROUPED or LONG UNGROUPED format</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_counts">counts</code></td>
<td>
<p>the name of a numeric vector listing the counts of events in each interval. It should be available in data</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_resp">resp</code></td>
<td>
<p>For 'decumulate_te(): the response variable, i.e. a vector of cumulative counts/proportions</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_units">units</code></td>
<td>
<p>For 'decumulate_te(): a label for Petri dishes or other containers</p>
</td></tr>
<tr><td><code id="reshape_te_+3A_type">type</code></td>
<td>
<p>For 'decumulate_te(): character string, it is &quot;count&quot; or &quot;proportion&quot;, depending on what it is given in the argument 'resp'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details are given in <a href="https://www.statforbiology.com/2021/stat_drcte_3-reshapingdata/">https://www.statforbiology.com/2021/stat_drcte_3-reshapingdata/</a>
</p>


<h3>Value</h3>

<p>Returns a data frame
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri
</p>


<h3>References</h3>

<p>See <a href="https://www.statforbiology.com/2021/stat_drcte_3-reshapingdata/">https://www.statforbiology.com/2021/stat_drcte_3-reshapingdata/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Transform a dataset from WIDE to LONG GROUPED
library(drcte)
data(lotusOr)
datasetG &lt;- melt_te(lotusOr, count_cols = 3:17, treat_cols = Stage,
            monitimes = 1:15, n.subjects = rep(25,12))
head(datasetG, 16)

# Transform a dataset from WIDE to LONG UNGROUPED
datasetU &lt;- melt_te(lotusOr, count_cols = 3:17, treat_cols = 1,
                monitimes = 1:15, n.subjects = rep(25,12),
                grouped = FALSE)
head(datasetU, 16)

# From LONG GROUPED to LONG UNGROUPED
datasetU2 &lt;- ungroup_te(datasetG, count)[,-c(5, 6)]
head(datasetU2, 16)

# From LONG UNGROUPED to LONG GROUPED
datasetG2 &lt;- group_te(datasetU)
head(datasetG2, 16)

# Chunk 7
# Decumulate a dataset with cumulative counts
data(lotusCum)
dataset_sd &lt;- decumulate_te(lotusCum,
                            resp = nCum,
                            treat_cols = Stage,
                            monitimes = Time,
                            units = Dish,
                            n.subjects = rep(25, 12),
                            type = "count")

dataset_sd &lt;- decumulate_te(lotusCum,
                            resp = Prop,
                            treat_cols = "Stage",
                            monitimes = Time,
                            units = Dish,
                            n.subjects = rep(25, 12),
                            type = "proportion")

</code></pre>

<hr>
<h2 id='Service+20functions'>
Service functions
</h2><span id='topic+NLSLL.3'></span>

<h3>Description</h3>

<p>The functions documented here are internally used by the package and they are not to be used elsewhere
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NLSLL.3(predictor, b, d, ED50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Service+2B20functions_+3A_predictor">predictor</code></td>
<td>
<p>response variable</p>
</td></tr>
<tr><td><code id="Service+2B20functions_+3A_b">b</code></td>
<td>
<p>shepe parameter</p>
</td></tr>
<tr><td><code id="Service+2B20functions_+3A_d">d</code></td>
<td>
<p>truncation parameter</p>
</td></tr>
<tr><td><code id="Service+2B20functions_+3A_ed50">ED50</code></td>
<td>
<p>location parameter</p>
</td></tr>
</table>

<hr>
<h2 id='summary.drcte'>Summarising time-to-event fits</h2><span id='topic+summary.drcte'></span>

<h3>Description</h3>

<p>'summary' returns a comprehensive summary for model parameters from a parametric time-to-event fit object of class 'drcte'. For non-parametric models (NPLME), this function reports the set of Turnbull's interval and related masses, while for KDEs it reports the AMISE or bootstrap bandwidth value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'drcte'
summary(object, robust = FALSE, units = NULL,
  type = c("sandwich", "bootstrap", "jackknife"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.drcte_+3A_object">object</code></td>
<td>
<p>an object of class 'drcte'.</p>
</td></tr>
<tr><td><code id="summary.drcte_+3A_robust">robust</code></td>
<td>
<p>Logical: if TRUE, robust sandwich standard errors are printed instead of the asymptotic formula. Defaults to TRUE if 'units' or 'type' is given. It is neglected for non-parametric time-to-event models</p>
</td></tr>
<tr><td><code id="summary.drcte_+3A_units">units</code></td>
<td>
<p>Optional vector that identifies groups of subjects, used in computing a cluster robust standard error. Like model variables, this is searched for in the dataset pointed to by the data argument. It is neglected for non-parametric time-to-event models.</p>
</td></tr>
<tr><td><code id="summary.drcte_+3A_type">type</code></td>
<td>
<p>Type of robust standard error. It defaults to 'sandwich' that is the only available method at moment. Bootstrap and jackknife standard errors are under study. It is neglected for non-parametric time-to-event models</p>
</td></tr>
<tr><td><code id="summary.drcte_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With parametric models, ‘naive’ (asymptotic) standard errors are obtained from the second derivative of the likelihood function. For seed germination and emergence assays, the observational units are the individual seeds and, most often, they are not independent from one another, as they are clustered within randomisation units (e.g., Petri dishes or other types of containers), to which the experimental treatments are allocated. For these and other cases of clustered data, cluster-robust SEs can be obtained by using the so-called ‘sandwich estimator’ (Carroll et al. 1998), which has proven reliable for clustered survival data (Yu and Peng 2008). Robust SEs are obtained by exploiting the facilities provided in the ‘sandwich’ package (Zeileis et al. 2020).
</p>


<h3>Value</h3>

<p>A list of summary statistics that includes parameter estimates and estimated standard errors.
</p>


<h3>Author(s)</h3>

<p>Andrea Onofri, Christian Ritz</p>


<h3>References</h3>

<p>Carroll RJ, Wang S, Simpson DG, Stromberg AJ, Ruppert D (1998) The sandwich (robust covariance matrix) estimator. Technical report, Department of statistics. A&amp;M University. Texas (USA)
</p>
<p>Onofri, A., Mesgaran, M., &amp; Ritz, C. (2022). A unified framework for the analysis of germination, emergence, and other time-to-event data in weed science. Weed Science, 1-13. doi:10.1017/wsc.2022.8
</p>
<p>Yu B, Peng Y (2008) Mixture cure models for multivariate survival data. Comput Stat Data Anal 52:1524–1532
</p>
<p>Zeileis A, Koell S, Graham N (2020) Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R. J Stat Softw 95
</p>

<hr>
<h2 id='verbascum'>
Germination time-course for three species of the Verbascum genus
</h2><span id='topic+verbascum'></span>

<h3>Description</h3>

<p>This dataset relates to a germination assay with three species of Verbascum, four replicated Petri dishes and 25 seeds per Petri dish (12 dishes in all). Inspections were made daily for 15 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("verbascum")</code></pre>


<h3>Format</h3>

<p>A data frame with 192 observations on the following 6 variables.
</p>

<dl>
<dt><code>Dish</code></dt><dd><p>a numeric vector with the coding for Petri dishes</p>
</dd>
<dt><code>Species</code></dt><dd><p>a factor with the name of the species</p>
</dd>
<dt><code>timeBef</code></dt><dd><p>a numeric vector with the start date for the each assessment interval</p>
</dd>
<dt><code>timeAf</code></dt><dd><p>a numeric vector with the end date for the each assessment interval. It contains the value Inf (Infinity), that indicates the final interval of time, after the final assessment time</p>
</dd>
<dt><code>nSeeds</code></dt><dd><p>a numeric vector with the number of germinated seeds in each interval. Relating to final interval of time, from the last assessment date to Infinity, 'nSeeds' contains the final number of ungerminated seeds</p>
</dd>
<dt><code>nCum</code></dt><dd><p>a numeric vector with the cumulative number of germinated seeds in each interval of time</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data are kindly provided by Antonietta Cristaudo (University of Catania, Italy).
</p>


<h3>References</h3>

<p>Catara, S., Cristaudo, A., Gualtieri, A., Galesi, R., Impelluso, C., Onofri, A., 2016. Threshold temperatures for seed germination in nine species of Verbascum (Scrophulariaceae). Seed Science Research 26, 30–46.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(verbascum)
head(verbascum)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
