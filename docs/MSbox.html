<!DOCTYPE html><html><head><title>Help for package MSbox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSbox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adduct'><p>Common adducts</p></a></li>
<li><a href='#contam'><p>Contaminants in MS</p></a></li>
<li><a href='#describe'><p>Get the compound information</p></a></li>
<li><a href='#doStat'><p>Performing statistics</p></a></li>
<li><a href='#E_iso'><p>Element isotopes</p></a></li>
<li><a href='#getCV'><p>Calculate coefficient of variation (CV)</p></a></li>
<li><a href='#getFC'><p>calculate fold change</p></a></li>
<li><a href='#getMax'><p>Get the sample name which has the max ion intensity</p></a></li>
<li><a href='#getP'><p>get p-values</p></a></li>
<li><a href='#Iso_mass'><p>Isotope labelled molecular mass</p></a></li>
<li><a href='#Iso_mz'><p>Isotope labelled molecular mass</p></a></li>
<li><a href='#mass'><p>molecular mass</p></a></li>
<li><a href='#mz'><p>Calculate accurate mass-to-charge ratio</p></a></li>
<li><a href='#ppm'><p>mass accuracy</p></a></li>
<li><a href='#searchDB'><p>Search in customized database</p></a></li>
<li><a href='#what'><p>search for m/z in from the idiom metabolomics database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mass Spectrometry Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.8</td>
</tr>
<tr>
<td>Author:</td>
<td>Yonghui Dong</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yonghui Dong &lt;yonghui.dong@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Common mass spectrometry tools described in John Roboz (2013) &lt;<a href="https://doi.org/10.1201%2Fb15436">doi:10.1201/b15436</a>&gt;. It allows checking element
 isotopes, calculating (isotope labelled) exact monoisitopic mass, m/z values and mass accuracy, and inspecting possible contaminant mass peaks,
 examining possible adducts in electrospray ionization (ESI) and matrix-assisted laser desorption ionization (MALDI)
 ion sources. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringr, crayon, xml2, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/YonghuiDong/MSbox">https://github.com/YonghuiDong/MSbox</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/YonghuiDong/MSbox/issues/new">https://github.com/YonghuiDong/MSbox/issues/new</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-08 14:22:36 UTC; dong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-08 14:42:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='adduct'>Common adducts</h2><span id='topic+adduct'></span>

<h3>Description</h3>

<p>calculate common adduct ions in positive or negative ion mode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adduct(F, mode = c("+", "-"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adduct_+3A_f">F</code></td>
<td>
<p>chemical formula, case insensitive</p>
</td></tr>
<tr><td><code id="adduct_+3A_mode">mode</code></td>
<td>
<p>ionization mode, either positive '+' or negative '-'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adduct('C1H4', mode = '-')
adduct('C1h4', mode = '+')
</code></pre>

<hr>
<h2 id='contam'>Contaminants in MS</h2><span id='topic+contam'></span>

<h3>Description</h3>

<p>check the possible contaminants
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contam(mz, mode = NULL, ppm = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contam_+3A_mz">mz</code></td>
<td>
<p>suspected m/z value</p>
</td></tr>
<tr><td><code id="contam_+3A_mode">mode</code></td>
<td>
<p>ionization mode, either positive '+' or negative '-'</p>
</td></tr>
<tr><td><code id="contam_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance, default value = 10</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'> contam(33.0335, ppm = 10, mode = '+')
 contam(44.998, ppm = 10, mode = '-')
</code></pre>

<hr>
<h2 id='describe'>Get the compound information</h2><span id='topic+describe'></span>

<h3>Description</h3>

<p>get compound formula and structure from https://cactus.nci.nih.gov/chemical/structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>describe(chem, representation = "formula", info = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="describe_+3A_chem">chem</code></td>
<td>
<p>chemical name of the compound</p>
</td></tr>
<tr><td><code id="describe_+3A_representation">representation</code></td>
<td>
<p>representation methods, formula is default</p>
</td></tr>
<tr><td><code id="describe_+3A_info">info</code></td>
<td>
<p>extra molecular information that users can query</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
describe('malic acid', "formula")
describe(c('malic acid', 'citric acid', 'tartaric acid'), "smiles")

## End(Not run)
</code></pre>

<hr>
<h2 id='doStat'>Performing statistics</h2><span id='topic+doStat'></span>

<h3>Description</h3>

<p>performing statistics, including calculating fold change, p-values and VIP values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doStat(x, Group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="doStat_+3A_x">x</code></td>
<td>
<p>sample ion intensity matrix, row sample, column feature.</p>
</td></tr>
<tr><td><code id="doStat_+3A_group">Group</code></td>
<td>
<p>sample group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with statistical information
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- matrix(runif(2*300), ncol = 2, nrow = 300)
rownames(dat) &lt;- 1:dim(dat)[1]
myGroup &lt;- rep_len(LETTERS[1:3], 300)
ret &lt;- doStat(dat, Group = myGroup)
</code></pre>

<hr>
<h2 id='E_iso'>Element isotopes</h2><span id='topic+E_iso'></span>

<h3>Description</h3>

<p>check element isotope information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E_iso(S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="E_iso_+3A_s">S</code></td>
<td>
<p>element, can be element symbol (i.e. C) or full name (i.e. Carbon).
Both Element symbol and full name are case insensitive.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'> E_iso('Na') # element symbol
 E_iso('nA') # element symbol, case insensitive
 E_iso('Carbon') # element full name
 E_iso('carBon') # element full name, case insensitive
</code></pre>

<hr>
<h2 id='getCV'>Calculate coefficient of variation (CV)</h2><span id='topic+getCV'></span>

<h3>Description</h3>

<p>Calculate coefficient of variation (CV), also
known as relative standard deviation (RSD) among different sample groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCV(x, Group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getCV_+3A_x">x</code></td>
<td>
<p>sample ion intensity matrix, row sample, column feature.</p>
</td></tr>
<tr><td><code id="getCV_+3A_group">Group</code></td>
<td>
<p>sample group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with mean values and cv
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- matrix(runif(2*300), ncol = 2, nrow = 300)
myGroup &lt;- rep_len(LETTERS[1:2], 300)
ret &lt;- getCV(dat, Group = myGroup)
</code></pre>

<hr>
<h2 id='getFC'>calculate fold change</h2><span id='topic+getFC'></span>

<h3>Description</h3>

<p>calculate fold change among different samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFC(x, Group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFC_+3A_x">x</code></td>
<td>
<p>sample ion intensity matrix, row sample, column feature.</p>
</td></tr>
<tr><td><code id="getFC_+3A_group">Group</code></td>
<td>
<p>sample group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with mean values and fold changes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- matrix(runif(2*300), ncol = 2, nrow = 300)
myGroup &lt;- rep_len(LETTERS[1:2], 300)
ret &lt;- getFC(dat, Group = myGroup)
</code></pre>

<hr>
<h2 id='getMax'>Get the sample name which has the max ion intensity</h2><span id='topic+getMax'></span>

<h3>Description</h3>

<p>get the sample name which has the max ion intensity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getMax(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getMax_+3A_x">x</code></td>
<td>
<p>sample ion intensity matrix, row sample, column feature.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- cbind.data.frame(mz = c(100, 101, 300), mz2 = c(0, 0 , 1), mz3 = c(1, 9, 1))
rownames(dat) &lt;- c("A", "B", "C")
out &lt;- getMax(dat)
</code></pre>

<hr>
<h2 id='getP'>get p-values</h2><span id='topic+getP'></span>

<h3>Description</h3>

<p>get p-values from Post Hoc analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getP(x, Group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getP_+3A_x">x</code></td>
<td>
<p>sample ion intensity matrix, row sample, column feature.</p>
</td></tr>
<tr><td><code id="getP_+3A_group">Group</code></td>
<td>
<p>sample group information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- matrix(runif(2*300), ncol = 2, nrow = 300)
myGroup &lt;- rep_len(LETTERS[1:3], 300)
out &lt;- getP(dat, Group = myGroup)
</code></pre>

<hr>
<h2 id='Iso_mass'>Isotope labelled molecular mass</h2><span id='topic+Iso_mass'></span>

<h3>Description</h3>

<p>Calculate isotope labelled molecular mass
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Iso_mass(F, iso)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Iso_mass_+3A_f">F</code></td>
<td>
<p>chemical formula, case insensitive</p>
</td></tr>
<tr><td><code id="Iso_mass_+3A_iso">iso</code></td>
<td>
<p>labelled elements, case insensitive</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Iso_mass(F = 'C7H6O4', iso = '[13]C2[2]H3') # Two 13C and three 2H are labled
</code></pre>

<hr>
<h2 id='Iso_mz'>Isotope labelled molecular mass</h2><span id='topic+Iso_mz'></span>

<h3>Description</h3>

<p>Calculate isotope labelled m/z
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Iso_mz(F, iso, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Iso_mz_+3A_f">F</code></td>
<td>
<p>chemical formula, case insensitive</p>
</td></tr>
<tr><td><code id="Iso_mz_+3A_iso">iso</code></td>
<td>
<p>labelled elements, case insensitive</p>
</td></tr>
<tr><td><code id="Iso_mz_+3A_z">z</code></td>
<td>
<p>charge</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Iso_mz(F = 'C7H6O4', iso = '[13]C2[2]H3', z = -1) # Two 13C and three 2H are labled
</code></pre>

<hr>
<h2 id='mass'>molecular mass</h2><span id='topic+mass'></span>

<h3>Description</h3>

<p>calculate accurate molecular mass
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mass(F, caseSensitive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mass_+3A_f">F</code></td>
<td>
<p>chemical formula, case insensitive</p>
</td></tr>
<tr><td><code id="mass_+3A_casesensitive">caseSensitive</code></td>
<td>
<p>if case sensitive is 'FALSE' (default), the elements are seperated by numbers.
for instance, Carbon dioxyde can be written as 'c1o2' or any combination of the two elements in lower or
upper cases. However, the number of elements should be clearly stated in the chemical formula. if case
sensitive is 'TRUE', the elements are seperated by upper case letters. For instance, Carbon dioxyde must
be written as 'C1O2' or &lsquo;CO2'. You don&rsquo;t meed to write the number of the element if it is 1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'> mass('C7h7o1')
 mass('C7H7O', caseSensitive = TRUE)
 mass(c('C7H7O4', 'C'), caseSensitive = TRUE) # vector input
 mass(c('c7h7O4', 'c1'))
</code></pre>

<hr>
<h2 id='mz'>Calculate accurate mass-to-charge ratio</h2><span id='topic+mz'></span>

<h3>Description</h3>

<p>Calculate accurate mass-to-charge ratio (m/z)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mz(m, z, caseSensitive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mz_+3A_m">m</code></td>
<td>
<p>chemical formula of an ion, case insensitive</p>
</td></tr>
<tr><td><code id="mz_+3A_z">z</code></td>
<td>
<p>charge</p>
</td></tr>
<tr><td><code id="mz_+3A_casesensitive">caseSensitive</code></td>
<td>
<p>if case sensitive is 'FALSE' (default), the elements are seperated by numbers.
for instance, Carbon dioxyde can be written as 'c1o2' or any combination of the two elements in lower or
upper cases. However, the number of elements should be clearly stated in the chemical formula. if case
sensitive is 'TRUE', the elements are seperated by upper case letters. For instance, Carbon dioxyde must
be written as 'C1O2' or &lsquo;CO2'. You don&rsquo;t meed to write the number of the element if it is 1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'> mz('C7h7o1', z = 1)
 mz('C7H7O', z = 1, caseSensitive = TRUE)
 mz(c('C7H7O4', 'C'), z = -1, caseSensitive = TRUE) # vector input
 mz(c('c7h7O4', 'c1'), z = -1)
</code></pre>

<hr>
<h2 id='ppm'>mass accuracy</h2><span id='topic+ppm'></span>

<h3>Description</h3>

<p>calculate the mass accuracy of measured m/z. lazy input allowed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppm(m, t, lazy = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppm_+3A_m">m</code></td>
<td>
<p>measured m/z</p>
</td></tr>
<tr><td><code id="ppm_+3A_t">t</code></td>
<td>
<p>theoretical m/z</p>
</td></tr>
<tr><td><code id="ppm_+3A_lazy">lazy</code></td>
<td>
<p>if lazy input is allowed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ppm(155.03383, 155.03388) # with m/z value
 ppm(155.03383, .03388) # lazy input when the integer parts of m and t are the same
 ppm(155.03384, mz('C7H7O4', z = 1)) # with ion formula
</code></pre>

<hr>
<h2 id='searchDB'>Search in customized database</h2><span id='topic+searchDB'></span>

<h3>Description</h3>

<p>search in customized database based on accurate m/z and RT
</p>


<h3>Usage</h3>

<pre><code class='language-R'>searchDB(DF, DB, ppm = 5, RT = 0.2, useRT = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="searchDB_+3A_df">DF</code></td>
<td>
<p>input file, should contain at least a column named mz</p>
</td></tr>
<tr><td><code id="searchDB_+3A_db">DB</code></td>
<td>
<p>database, should contain at least a column named mz</p>
</td></tr>
<tr><td><code id="searchDB_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance, default 5ppm</p>
</td></tr>
<tr><td><code id="searchDB_+3A_rt">RT</code></td>
<td>
<p>retention time tolerance, default 0.2min</p>
</td></tr>
<tr><td><code id="searchDB_+3A_usert">useRT</code></td>
<td>
<p>should RT be considered during database search?</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DF &lt;- cbind.data.frame(mz = c(100.001, 100.1), RT = c(10, 11))
DB &lt;- cbind.data.frame(mz = c(100.001, 100.1), RT = c(10, 12.1))
searchDB(DF, DB, ppm = 5, RT = 0.2, useRT = TRUE)
</code></pre>

<hr>
<h2 id='what'>search for m/z in from the idiom metabolomics database</h2><span id='topic+what'></span>

<h3>Description</h3>

<p>tentative metabolite identification based on m/z value search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>what(myMZ, mode = NULL, ppm = 5, useDB = "HMDB")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="what_+3A_mymz">myMZ</code></td>
<td>
<p>m/z values</p>
</td></tr>
<tr><td><code id="what_+3A_mode">mode</code></td>
<td>
<p>ionization mode, either positive '+' or negative '-'</p>
</td></tr>
<tr><td><code id="what_+3A_ppm">ppm</code></td>
<td>
<p>mass tolerance, default value = 10</p>
</td></tr>
<tr><td><code id="what_+3A_usedb">useDB</code></td>
<td>
<p>which database to use, HMDB or KEGG? default is HMDB</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yonghui Dong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = what(133.014, mode = '-', ppm = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
