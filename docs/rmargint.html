<!DOCTYPE html><html><head><title>Help for package rmargint</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rmargint}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#deviance.margint'><p>Deviance for objects of class <code>margint</code></p></a></li>
<li><a href='#fitted.values.margint'><p>Fitted values for objects of class <code>margint</code></p></a></li>
<li><a href='#formula.margint'><p>Additive model formula</p></a></li>
<li><a href='#k.epan'><p>Epanechnikov kernel</p></a></li>
<li><a href='#kernel10'><p>Order 10 kernel</p></a></li>
<li><a href='#kernel4'><p>Order 4 kernel</p></a></li>
<li><a href='#kernel6'><p>Order 6 kernel</p></a></li>
<li><a href='#kernel8'><p>Order 8 kernel</p></a></li>
<li><a href='#margint.cl'><p>Classic marginal integration procedures for additive models</p></a></li>
<li><a href='#margint.rob'><p>Robust marginal integration procedures for additive models</p></a></li>
<li><a href='#my.norm.2'><p>Euclidean norm of a vector</p></a></li>
<li><a href='#plot.margint'><p>Diagnostic plots for objects of class <code>margint</code></p></a></li>
<li><a href='#predict.margint'><p>Fitted values for objects of class <code>margint</code></p></a></li>
<li><a href='#print.margint'><p>Print a Marginal Integration procedure</p></a></li>
<li><a href='#psi.huber'><p>Derivative of Huber's loss function.</p></a></li>
<li><a href='#psi.tukey'><p>Derivative of Tukey's bi-square loss function.</p></a></li>
<li><a href='#residuals.margint'><p>Residuals for objects of class <code>margint</code></p></a></li>
<li><a href='#rmargint-package'>
<p>Robust marginal integration estimators for additive models.</p></a></li>
<li><a href='#summary.margint'><p>Summary for additive models fits using a marginal integration procedure</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Marginal Integration Procedures</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Three robust marginal integration procedures for additive models based on local 
             polynomial kernel smoothers. As a preliminary estimator of the multivariate 
             function for the marginal integration procedure, a first approach uses local 
             constant M-estimators, a second one uses local polynomials of order 1 over all the
             components of covariates, and the third one uses M-estimators based on local 
             polynomials but only in the direction of interest. For this last approach, 
             estimators of the derivatives of the additive functions can be obtained. All three
             procedures can compute predictions for points outside the training set if desired. 
             See Boente and Martinez (2017) &lt;<a href="https://doi.org/10.1007%2Fs11749-016-0508-0">doi:10.1007/s11749-016-0508-0</a>&gt; for details. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-23 20:47:56 UTC; ale_m</td>
</tr>
<tr>
<td>Author:</td>
<td>Alejandra Martinez [aut, cre],
  Matias Salibian-Barrera [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alejandra Martinez &lt;ale_m_martinez@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-23 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='deviance.margint'>Deviance for objects of class <code>margint</code></h2><span id='topic+deviance.margint'></span>

<h3>Description</h3>

<p>This function returns the deviance of the fitted additive model using one of the three
classical or robust marginal integration estimators, as computed with <code><a href="#topic+margint.cl">margint.cl</a></code> or
<code><a href="#topic+margint.rob">margint.rob</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.margint_+3A_object">object</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="deviance.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='fitted.values.margint'>Fitted values for objects of class <code>margint</code></h2><span id='topic+fitted.values.margint'></span>

<h3>Description</h3>

<p>This function returns the fitted values given the covariates of the original sample under an additive model using a classical or robust marginal integration procedure estimator computed with <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
fitted.values(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.values.margint_+3A_object">object</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code>margint.cl</code> or <code>margint.rob</code>.</p>
</td></tr>
<tr><td><code id="fitted.values.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of fitted values.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='formula.margint'>Additive model formula</h2><span id='topic+formula.margint'></span>

<h3>Description</h3>

<p>Description of the additive model formula extracted from an object of class <code>margint</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.margint_+3A_x">x</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="formula.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A model formula.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='k.epan'>Epanechnikov kernel</h2><span id='topic+k.epan'></span>

<h3>Description</h3>

<p>This function evaluates an Epanechnikov kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k.epan(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k.epan_+3A_x">x</code></td>
<td>
<p>a vector of real numbers</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates an Epanechnikov kernel.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> where each entry is
<code>0.75 * (1 - x^2)</code> if <code>x &lt; 1</code> and 0 otherwise.
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>, Alejandra Martinez
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2, 2, length=10)
k.epan(x)

</code></pre>

<hr>
<h2 id='kernel10'>Order 10 kernel</h2><span id='topic+kernel10'></span>

<h3>Description</h3>

<p>This function evaluates a kernel of order 10. A kernel of order 10.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel10(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel10_+3A_x">x</code></td>
<td>
<p>A vector of real numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates a kernel of order 10. A kernel L is a kernel of order 10 if it integrates 1, the integrals of u^j L(u) are 0 for 1 &lt;= j &lt; 10 (j integer) and the integral of u^10 L(u) is different from 0.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> where each entry is <code>0.75 * ( 1 - x^2 ) * ( 315/128 - 105/32 * x^2 + 63/64 * x^4 - 3/32 * x^6 - 1/384 * x^8 )</code> and 0 otherwise.
</p>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2,2,length=10)
kernel10(x)

</code></pre>

<hr>
<h2 id='kernel4'>Order 4 kernel</h2><span id='topic+kernel4'></span>

<h3>Description</h3>

<p>This function evaluates a kernel of order 4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel4(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel4_+3A_x">x</code></td>
<td>
<p>A vector of real numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates a kernel of order 4. A kernel L is a kernel of order 4 if it integrates 1, the integrals of u^j L(u) are 0 for 1 &lt;= j &lt; 4 (j integer) and the integral of u^4 L(u) is different from 0.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> where each entry is <code>( 15/32 ) * ( 1 - x^2 ) * ( 3 - 7 * x^2 )</code> if <code>abs(x) &lt; 1</code> and 0 otherwise.
</p>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2,2,length=10)
kernel4(x)

</code></pre>

<hr>
<h2 id='kernel6'>Order 6 kernel</h2><span id='topic+kernel6'></span>

<h3>Description</h3>

<p>This function evaluates a kernel of order 6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel6(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel6_+3A_x">x</code></td>
<td>
<p>A vector of real numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates a kernel of order 6. A kernel L is a kernel of order 6 if it integrates 1, the integrals of u^j L(u) are 0 for 1 &lt;= j &lt; 6 (j integer) and the integral of u^6 L(u) is different from 0.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> where each entry is <code>( 105/256 ) * ( 1 - x^2 ) * ( 5 - 30 * x^2 + 33 * x^4 )</code> if <code>abs(x) &lt; 1</code> and 0 otherwise.
</p>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2,2,length=10)
kernel6(x)

</code></pre>

<hr>
<h2 id='kernel8'>Order 8 kernel</h2><span id='topic+kernel8'></span>

<h3>Description</h3>

<p>This function evaluates a kernel of order 8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel8(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel8_+3A_x">x</code></td>
<td>
<p>A vector of real numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates a kernel of order 8. A kernel L is a kernel of order 8 if it integrates 1, the integrals of u^j L(u) are 0 for 1 &lt;= j &lt; 8 (j integer) and the integral of u^8 L(u) is different from 0.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> where each entry is <code>( 315/4096 ) * ( 1 - x^2 ) * ( 35 - 385 * x^2 + 1001 * x^4 - 715 * x^6 )</code> and 0 otherwise.
</p>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2,2,length=10)
kernel8(x)
</code></pre>

<hr>
<h2 id='margint.cl'>Classic marginal integration procedures for additive models</h2><span id='topic+margint.cl'></span>

<h3>Description</h3>

<p>This function computes the standard marginal integration procedures for additive models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margint.cl(
  formula,
  data,
  subset,
  point = NULL,
  windows,
  epsilon = 1e-06,
  prob = NULL,
  type = "0",
  degree = NULL,
  qderivate = FALSE,
  orderkernel = 2,
  Qmeasure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margint.cl_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <a href="base.html#topic+as.data.frame">as.data.frame</a> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,  typically the environment from which the function was called.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_point">point</code></td>
<td>
<p>a matrix of points where predictions will be computed and returned.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_windows">windows</code></td>
<td>
<p>a vector or a squared matrix of bandwidths for the smoothing estimation procedure.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_epsilon">epsilon</code></td>
<td>
<p>convergence criterion.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_prob">prob</code></td>
<td>
<p>a vector of probabilities of observing each response (n). Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_type">type</code></td>
<td>
<p>three different type of estimators can be selected: type <code>'0'</code> (local constant on all the covariates), type <code>'1'</code> (local linear smoother on all the covariates), type <code>'alpha'</code> (local polynomial smoother only on the direction of interest).</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_degree">degree</code></td>
<td>
<p>degree of the local polynomial smoother in the direction of interest when using the estimator of type <code>'alpha'</code>. Defaults to <code>NULL</code> for the case when using estimators of type <code>'0'</code> or <code>'1'</code>.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_qderivate">qderivate</code></td>
<td>
<p>if TRUE, it calculates <code>g^(q+1)/(q+1)!</code> for each component only for the type <code>'alpha'</code> method. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_orderkernel">orderkernel</code></td>
<td>
<p>order of the kernel used in the nuisance directions when using the estimator of type <code>'alpha'</code>. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="margint.cl_+3A_qmeasure">Qmeasure</code></td>
<td>
<p>a matrix of points where the integration procedure ocurrs. Defaults to <code>NULL</code> for calcuting the integrals over the sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes three types of classical marginal integration procedures for additive models, that is, considering a squared loss function.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>Estimate for the intercept.</p>
</td></tr>
<tr><td><code>g.matrix</code></td>
<td>
<p>Matrix of estimated additive components (n by p).</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>Matrix of estimated additive components for the points listed in the argument point.</p>
</td></tr>
<tr><td><code>mul</code></td>
<td>
<p>A vector of size p showing in each component the estimated intercept that considers only that direction of interest when using the type <code>'alpha'</code> method.</p>
</td></tr>
<tr><td><code>g.derivative</code></td>
<td>
<p>Matrix of estimated derivatives of the additive components (only when qderivate is <code>TRUE</code>) (n by p).</p>
</td></tr>
<tr><td><code>prediction.derivate</code></td>
<td>
<p>Matrix of estimated derivatives of the additive components for the points listed in the argument point (only when qderivate is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>Matrix of explanatory variables.</p>
</td></tr>
<tr><td><code>yp</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Model formula</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>References</h3>

<p>Chen R., Hardle W., Linton O.B. and Severance-Lossin E. (1996). Nonparametric estimation of additive separable regression models. Physica-Verlag HD, Switzerland.
Linton O. and Nielsen J. (1995). A kernel method of estimating structured nonparametric regression based on marginal integration. Biometrika, 82(1), 93-101.
Severance-Lossin E. and Sperlich S. (1999). Estimation of derivatives for additive separable models. Statistics, 33(3), 241-265.
Tjostheim D. and Auestad B. (1994). Nonparametric identification of nonlinear time series: Selecting significant lags. Journal of the American Statistical Association, 89(428), 1410-1430.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>function.g1 &lt;- function(x1) 24*(x1-1/2)^2-2
function.g2 &lt;- function(x2) 2*pi*sin(pi*x2)-4
n &lt;- 150
x1 &lt;- runif(n)
x2 &lt;- runif(n)
X &lt;- cbind(x1, x2)
eps &lt;- rnorm(n,0,sd=0.15)
regresion &lt;- function.g1(x1) + function.g2(x2)
y &lt;- regresion + eps
bandw &lt;- matrix(0.25,2,2)
set.seed(8090)
nQ &lt;- 80 
Qmeasure &lt;- matrix(runif(nQ*2), nQ, 2)
fit.cl &lt;- margint.cl(y ~ X, windows=bandw, type='alpha', degree=1, Qmeasure=Qmeasure)

</code></pre>

<hr>
<h2 id='margint.rob'>Robust marginal integration procedures for additive models</h2><span id='topic+margint.rob'></span>

<h3>Description</h3>

<p>This function computes robust marginal integration procedures for additive models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margint.rob(
  formula,
  data,
  subset,
  point = NULL,
  windows,
  prob = NULL,
  sigma.hat = NULL,
  win.sigma = NULL,
  epsilon = 1e-06,
  type = "0",
  degree = NULL,
  typePhi = "Huber",
  k.h = 1.345,
  k.t = 4.685,
  max.it = 20,
  qderivate = FALSE,
  orderkernel = 2,
  Qmeasure = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margint.rob_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by <a href="base.html#topic+as.data.frame">as.data.frame</a> to a data frame) containing the variables in the model. If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>, typically the environment from which the function was called.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_point">point</code></td>
<td>
<p>a matrix of points where predictions will be computed and returned.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_windows">windows</code></td>
<td>
<p>a vector or a squared matrix of bandwidths for the smoothing estimation procedure.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_prob">prob</code></td>
<td>
<p>a vector of probabilities of observing each response (n). Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_sigma.hat">sigma.hat</code></td>
<td>
<p>estimate of the residual standard error. If <code>NULL</code> we use the mad of the residuals obtained with local medians.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_win.sigma">win.sigma</code></td>
<td>
<p>a vector of bandwidths for estimating sigma.hat. If <code>NULL</code> it uses the argument windows if it is a vector or its diagonal if it is a matrix.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_epsilon">epsilon</code></td>
<td>
<p>convergence criterion.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_type">type</code></td>
<td>
<p>three different type of estimators can be selected: type <code>'0'</code> (local constant on all the covariates), type <code>'1'</code> (local linear smoother on all the covariates), type <code>'alpha'</code> (local polynomial smoother only on the direction of interest).</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_degree">degree</code></td>
<td>
<p>degree of the local polynomial smoother in the direction of interest when using the estimator of type <code>'alpha'</code>. Defaults to <code>NULL</code> for the case when using estimators of type <code>'0'</code> or <code>'1'</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_typephi">typePhi</code></td>
<td>
<p>one of either <code>'Tukey'</code> or <code>'Huber'</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_k.h">k.h</code></td>
<td>
<p>tuning constant for a Huber-type loss function. Defaults to <code>1.345</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_k.t">k.t</code></td>
<td>
<p>tuning constant for a Tukey-type loss function. Defaults to <code>4.685</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_max.it">max.it</code></td>
<td>
<p>maximum number of iterations for the algorithm.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_qderivate">qderivate</code></td>
<td>
<p>if TRUE, it calculates <code>g^(q+1)/(q+1)!</code> for each component only for the type <code>'alpha'</code> method. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_orderkernel">orderkernel</code></td>
<td>
<p>order of the kernel used in the nuisance directions when using the estimator of type <code>'alpha'</code>. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="margint.rob_+3A_qmeasure">Qmeasure</code></td>
<td>
<p>a matrix of points where the integration procedure ocurrs. Defaults to <code>NULL</code> for calcuting the integrals over the sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes three types of robust marginal integration procedures for additive models.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>Estimate for the intercept.</p>
</td></tr>
<tr><td><code>g.matrix</code></td>
<td>
<p>Matrix of estimated additive components (n by p).</p>
</td></tr>
<tr><td><code>sigma.hat</code></td>
<td>
<p>Estimate of the residual standard error.</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p>Matrix of estimated additive components for the points listed in the argument point.</p>
</td></tr>
<tr><td><code>mul</code></td>
<td>
<p>A vector of size p showing in each component the estimated intercept that considers only that direction of interest when using the type <code>'alpha'</code> method.</p>
</td></tr>
<tr><td><code>g.derivative</code></td>
<td>
<p>Matrix of estimated derivatives of the additive components (only when qderivate is <code>TRUE</code>) (n by p).</p>
</td></tr>
<tr><td><code>prediction.derivate</code></td>
<td>
<p>Matrix of estimated derivatives of the additive components for the points listed in the argument point (only when qderivate is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>Matrix of explanatory variables.</p>
</td></tr>
<tr><td><code>yp</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Model formula</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandra Martinez, <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>, Matias Salibian-Barrera
</p>


<h3>References</h3>

<p>Boente G. and Martinez A. (2017). Marginal integration M-estimators for additive models. TEST, 26(2), 231-260. https://doi.org/10.1007/s11749-016-0508-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>function.g1 &lt;- function(x1) 24*(x1-1/2)^2-2
function.g2 &lt;- function(x2) 2*pi*sin(pi*x2)-4
set.seed(140)
n &lt;- 150
x1 &lt;- runif(n)
x2 &lt;- runif(n)
X &lt;- cbind(x1, x2)
eps &lt;- rnorm(n,0,sd=0.15)
regresion &lt;- function.g1(x1) + function.g2(x2)
y &lt;- regresion + eps
bandw &lt;- matrix(0.25,2,2)
set.seed(8090)
nQ &lt;- 80 
Qmeasure &lt;- matrix(runif(nQ*2), nQ, 2)
fit.rob &lt;- margint.rob(y ~ X, windows=bandw, type='alpha', degree=1, Qmeasure=Qmeasure) 

</code></pre>

<hr>
<h2 id='my.norm.2'>Euclidean norm of a vector</h2><span id='topic+my.norm.2'></span>

<h3>Description</h3>

<p>This function calculates the Euclidean norm of a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>my.norm.2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="my.norm.2_+3A_x">x</code></td>
<td>
<p>A real vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Euclidean norm of the input vector.
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>, Alejandra Martinez
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2, 2, length=10)
my.norm.2(x)

</code></pre>

<hr>
<h2 id='plot.margint'>Diagnostic plots for objects of class <code>margint</code></h2><span id='topic+plot.margint'></span>

<h3>Description</h3>

<p>Plot method for class <code>margint</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
plot(x, derivative = FALSE, which = 1:np, ask = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.margint_+3A_x">x</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="plot.margint_+3A_derivative">derivative</code></td>
<td>
<p>if TRUE, it plots the q-th derivatives. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plot.margint_+3A_which">which</code></td>
<td>
<p>vector of indices of explanatory variables for which partial residuals plots will be generated. Defaults to all available explanatory variables.</p>
</td></tr>
<tr><td><code id="plot.margint_+3A_ask">ask</code></td>
<td>
<p>logical value. If <code>TRUE</code>, the graphical device will prompt before going to the next page/screen of output.</p>
</td></tr>
<tr><td><code id="plot.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>function.g1 &lt;- function(x1) 24*(x1-1/2)^2-2
function.g2 &lt;- function(x2) 2*pi*sin(pi*x2)-4
set.seed(140)
n &lt;- 150
x1 &lt;- runif(n)
x2 &lt;- runif(n)
X &lt;- cbind(x1, x2)
eps &lt;- rnorm(n,0,sd=0.15)
regresion &lt;- function.g1(x1) + function.g2(x2)
y &lt;- regresion + eps
bandw &lt;- matrix(0.25,2,2)
set.seed(8090)
nQ &lt;- 80 
Qmeasure &lt;- matrix(runif(nQ*2), nQ, 2)
fit.rob &lt;- margint.rob(y ~ X, windows=bandw, type='alpha', degree=1, Qmeasure=Qmeasure)
plot(fit.rob, which=1)

</code></pre>

<hr>
<h2 id='predict.margint'>Fitted values for objects of class <code>margint</code></h2><span id='topic+predict.margint'></span>

<h3>Description</h3>

<p>This function returns the fitted values given the covariates of the original sample under an additive model using a classical or robust marginal integration procedure estimator computed with <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.margint_+3A_object">object</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="predict.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of fitted values.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='print.margint'>Print a Marginal Integration procedure</h2><span id='topic+print.margint'></span>

<h3>Description</h3>

<p>The default print method for a <code>margint</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.margint_+3A_x">x</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="print.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='psi.huber'>Derivative of Huber's loss function.</h2><span id='topic+psi.huber'></span>

<h3>Description</h3>

<p>This function evaluates the first derivative of Huber's loss function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psi.huber(r, k = 1.345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psi.huber_+3A_r">r</code></td>
<td>
<p>A vector of real numbers.</p>
</td></tr>
<tr><td><code id="psi.huber_+3A_k">k</code></td>
<td>
<p>A positive tuning constant.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates the first derivative of Huber's loss function.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>r</code>.
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>, Alejandra Martinez
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2, 2, length=10)
psi.huber(r=x, k = 1.5)

</code></pre>

<hr>
<h2 id='psi.tukey'>Derivative of Tukey's bi-square loss function.</h2><span id='topic+psi.tukey'></span>

<h3>Description</h3>

<p>This function evaluates the first derivative of Tukey's bi-square loss function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psi.tukey(r, k = 4.685)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psi.tukey_+3A_r">r</code></td>
<td>
<p>A vector of real numbers</p>
</td></tr>
<tr><td><code id="psi.tukey_+3A_k">k</code></td>
<td>
<p>A positive tuning constant.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates the first derivative of Tukey's bi-square loss function.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>r</code>.
</p>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera, <a href="mailto:matias@stat.ubc.ca">matias@stat.ubc.ca</a>, Alejandra Martinez
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(-2, 2, length=10)
psi.tukey(r=x, k = 1.5)

</code></pre>

<hr>
<h2 id='residuals.margint'>Residuals for objects of class <code>margint</code></h2><span id='topic+residuals.margint'></span>

<h3>Description</h3>

<p>This function returns the residuals of the fitted additive model using one of the three
classical or robust marginal integration estimators, as computed with <code><a href="#topic+margint.cl">margint.cl</a></code> or
<code><a href="#topic+margint.rob">margint.rob</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.margint_+3A_object">object</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of residuals.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

<hr>
<h2 id='rmargint-package'>
Robust marginal integration estimators for additive models.
</h2><span id='topic+rmargint-package'></span><span id='topic+rmargint'></span>

<h3>Description</h3>

<p>Robust marginal integration estimators for additive models.
</p>


<h3>Author(s)</h3>

<p>Alejandra Martinez, Matias Salibian-Barrera
</p>
<p>Maintainer: Alejandra Martinez &lt;ale_m_martinez@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Boente G. and Martinez A. (2017). Marginal integration M-estimators for additive models. TEST, 26, 231-260.</p>

<hr>
<h2 id='summary.margint'>Summary for additive models fits using a marginal integration procedure</h2><span id='topic+summary.margint'></span><span id='topic+summary.margint.cl'></span><span id='topic+summary.margint.rob'></span>

<h3>Description</h3>

<p>Summary method for class <code>margint</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margint'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.margint_+3A_object">object</code></td>
<td>
<p>an object of class <code>margint</code>, a result of a call to <code><a href="#topic+margint.cl">margint.cl</a></code> or <code><a href="#topic+margint.rob">margint.rob</a></code>.</p>
</td></tr>
<tr><td><code id="summary.margint_+3A_...">...</code></td>
<td>
<p>additional other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the estimation of the intercept and also the five-number summary and the mean of the residuals for both classical and robust estimators. For the robust estimator it also returns the estimate of the residual standard error.
</p>


<h3>Author(s)</h3>

<p>Alejandra Mercedes Martinez <a href="mailto:ale_m_martinez@hotmail.com">ale_m_martinez@hotmail.com</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
