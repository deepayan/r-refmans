<!DOCTYPE html><html><head><title>Help for package greta.gp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {greta.gp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gp'><p>Define a Gaussian process</p></a></li>
<li><a href='#greta.gp'><p>Gaussian process modelling in greta</p></a></li>
<li><a href='#kernels'><p>Gaussian process kernels</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Gaussian Process Modelling in 'greta'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a syntax to create and combine Gaussian process kernels 
  in 'greta'. You can then them to define either full rank or sparse Gaussian 
  processes. This is an extension to the 'greta' software, Golding (2019) 
  &lt;<a href="https://doi.org/10.21105%2Fjoss.01601">doi:10.21105/joss.01601</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/greta-dev/greta.gp">https://github.com/greta-dev/greta.gp</a>,
<a href="https://greta-dev.github.io/greta.gp/">https://greta-dev.github.io/greta.gp/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/greta-dev/greta.gp/issues">https://github.com/greta-dev/greta.gp/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>greta (&ge; 0.4.2), R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, glue, tensorflow (&ge; 2.7.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, spelling, testthat (&ge; 3.1.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Python (&gt;= 2.7.0) with header files and shared
library; TensorFlow (v1.14; https://www.tensorflow.org/);
TensorFlow Probability (v0.7.0;
https://www.tensorflow.org/probability/)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-29 06:11:30 UTC; nick</td>
</tr>
<tr>
<td>Author:</td>
<td>Nick Golding <a href="https://orcid.org/0000-0001-8916-5570"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Jian Yen [ctb],
  Nicholas Tierney <a href="https://orcid.org/0000-0003-1460-8722"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Tierney &lt;nicholas.tierney@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-29 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gp'>Define a Gaussian process</h2><span id='topic+gp'></span><span id='topic+project'></span>

<h3>Description</h3>

<p>Define Gaussian processes, and project them to new coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp(x, kernel, inducing = NULL, n = 1, tol = 1e-04)

project(f, x_new, kernel = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp_+3A_x">x</code>, <code id="gp_+3A_x_new">x_new</code></td>
<td>
<p>greta array giving the coordinates at which to evaluate the
Gaussian process</p>
</td></tr>
<tr><td><code id="gp_+3A_kernel">kernel</code></td>
<td>
<p>a kernel function created using one of the
<a href="#topic+kernels">kernel()</a> methods</p>
</td></tr>
<tr><td><code id="gp_+3A_inducing">inducing</code></td>
<td>
<p>an optional greta array giving the coordinates of inducing
points in a sparse (reduced rank) Gaussian process model</p>
</td></tr>
<tr><td><code id="gp_+3A_n">n</code></td>
<td>
<p>the number of independent Gaussian processes to define with
the same kernel</p>
</td></tr>
<tr><td><code id="gp_+3A_tol">tol</code></td>
<td>
<p>a numerical tolerance parameter, added to the diagonal of the
self-covariance matrix when computing the cholesky decomposition. If the
sampler is hitting a lot of numerical errors, increasing this parameter
could help</p>
</td></tr>
<tr><td><code id="gp_+3A_f">f</code></td>
<td>
<p>a greta array created with <code>gp$gp</code> representing the values of
one or more Gaussian processes</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gp()</code> returns a greta array representing the values of the
Gaussian process(es) evaluated at <code>x</code>. This Gaussian process can be
made sparse (via a reduced-rank representation of the covariance) by
providing an additional set of inducing point coordinates <code>inducing</code>.
<code>project()</code> evaluates the values of an existing Gaussian process
(created with <code>gp()</code>) to new data.
</p>


<h3>Value</h3>

<p>A greta array
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# build a kernel function on two dimensions
k1 &lt;- rbf(lengthscales = c(0.1, 0.2), variance = 0.6)
k2 &lt;- bias(variance = lognormal(0, 1))
K &lt;- k1 + k2

# use this kernel in a full-rank Gaussian process
f &lt;- gp(1:10, K)

# or in sparse Gaussian process
f_sparse &lt;- gp(1:10, K, inducing = c(2, 5, 8))

# project the values of the GP to new coordinates
f_new &lt;- project(f, 11:15)

# or project with a different kernel (e.g. a sub-kernel)
f_new_bias &lt;- project(f, 11:15, k2)

## End(Not run)
</code></pre>

<hr>
<h2 id='greta.gp'>Gaussian process modelling in greta</h2><span id='topic+greta.gp-package'></span><span id='topic+greta.gp'></span>

<h3>Description</h3>

<p>A greta module to create and combine covariance functions and
use them to build Gaussian process models in greta. See
<code><a href="#topic+kernels">kernels()</a></code> and <code><a href="#topic+gp">gp()</a></code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nicholas Tierney <a href="mailto:nicholas.tierney@gmail.com">nicholas.tierney@gmail.com</a> (<a href="https://orcid.org/0000-0003-1460-8722">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Nick Golding <a href="mailto:nick.golding.research@gmail.com">nick.golding.research@gmail.com</a> (<a href="https://orcid.org/0000-0001-8916-5570">ORCID</a>) [copyright holder]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Jian Yen [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/greta-dev/greta.gp">https://github.com/greta-dev/greta.gp</a>
</p>
</li>
<li> <p><a href="https://greta-dev.github.io/greta.gp/">https://greta-dev.github.io/greta.gp/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/greta-dev/greta.gp/issues">https://github.com/greta-dev/greta.gp/issues</a>
</p>
</li></ul>


<hr>
<h2 id='kernels'>Gaussian process kernels</h2><span id='topic+kernels'></span><span id='topic+bias'></span><span id='topic+constant'></span><span id='topic+white'></span><span id='topic+iid'></span><span id='topic+rbf'></span><span id='topic+rational_quadratic'></span><span id='topic+linear'></span><span id='topic+polynomial'></span><span id='topic+expo'></span><span id='topic+mat12'></span><span id='topic+mat32'></span><span id='topic+mat52'></span><span id='topic+cosine'></span><span id='topic+periodic'></span>

<h3>Description</h3>

<p>Create and combine Gaussian process kernels (covariance
functions) for use in Gaussian process models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bias(variance)

constant(variance)

white(variance)

iid(variance, columns = 1)

rbf(lengthscales, variance, columns = seq_along(lengthscales))

rational_quadratic(
  lengthscales,
  variance,
  alpha,
  columns = seq_along(lengthscales)
)

linear(variances, columns = seq_along(variances))

polynomial(variances, offset, degree, columns = seq_along(variances))

expo(lengthscales, variance, columns = seq_along(lengthscales))

mat12(lengthscales, variance, columns = seq_along(lengthscales))

mat32(lengthscales, variance, columns = seq_along(lengthscales))

mat52(lengthscales, variance, columns = seq_along(lengthscales))

cosine(lengthscales, variance, columns = seq_along(lengthscales))

periodic(period, lengthscale, variance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernels_+3A_variance">variance</code>, <code id="kernels_+3A_variances">variances</code></td>
<td>
<p>(scalar/vector) the variance of a Gaussian process
prior in all dimensions (<code>variance</code>) or in each dimension
(<code>variances</code>)</p>
</td></tr>
<tr><td><code id="kernels_+3A_columns">columns</code></td>
<td>
<p>(scalar/vector integer, not a greta array) the columns of the
data matrix on which this kernel acts. Must have the same dimensions as
lengthscale parameters.</p>
</td></tr>
<tr><td><code id="kernels_+3A_alpha">alpha</code></td>
<td>
<p>(scalar) additional parameter in rational quadratic kernel</p>
</td></tr>
<tr><td><code id="kernels_+3A_offset">offset</code></td>
<td>
<p>(scalar) offset in polynomial kernel</p>
</td></tr>
<tr><td><code id="kernels_+3A_degree">degree</code></td>
<td>
<p>(scalar) degree of polynomial kernel</p>
</td></tr>
<tr><td><code id="kernels_+3A_period">period</code></td>
<td>
<p>(scalar) the period of the Gaussian process</p>
</td></tr>
<tr><td><code id="kernels_+3A_lengthscale">lengthscale</code>, <code id="kernels_+3A_lengthscales">lengthscales</code></td>
<td>
<p>(scalar/vector) the correlation decay
distance along all dimensions (<code>lengthscale</code>) or each dimension
((<code>lengthscales</code>)) of the Gaussian process</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The kernel constructor functions each return a <em>function</em> (of
class <code>greta_kernel</code>) which can be executed on greta arrays to compute
the covariance matrix between points in the space of the Gaussian process.
The <code>+</code> and <code>*</code> operators can be used to combine kernel functions
to create new kernel functions.
</p>
<p>Note that <code>bias</code> and <code>constant</code> are identical names for the same
underlying kernel.
</p>
<p><code>iid</code> is equivalent to <code>bias</code> where all entries in <code>columns</code>
match (where the absolute euclidean distance is less than
1e-12), and <code>white</code> where they don't; i.e. an independent Gaussian
random effect.
</p>


<h3>Value</h3>

<p>greta kernel with class &quot;greta_kernel&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# create a radial basis function kernel on two dimensions
k1 &lt;- rbf(lengthscales = c(0.1, 0.2), variance = 0.6)

# evaluate it on a greta array to get the variance-covariance matrix
x &lt;- greta_array(rnorm(8), dim = c(4, 2))
k1(x)

# non-symmetric covariance between two sets of points
x2 &lt;- greta_array(rnorm(10), dim = c(5, 2))
k1(x, x2)

# create a bias kernel, with the variance as a variable
k2 &lt;- bias(variance = lognormal(0, 1))

# combine two kernels and evaluate
K &lt;- k1 + k2
K(x, x2)

# other kernels
constant(variance = lognormal(0, 1))
white(variance = lognormal(0, 1))
iid(variance = lognormal(0,1))
rational_quadratic(lengthscales = c(0.1, 0.2), alpha = 0.5, variance = 0.6)
linear(variances = 0.1)
polynomial(variances = 0.6, offset = 0.8, degree = 2)
expo(lengthscales = 0.6 ,variance = 0.9)
mat12(lengthscales = 0.5, variance = 0.7)
mat32(lengthscales = 0.4, variance = 0.8)
mat52(lengthscales = 0.3, variance = 0.9)
cosine(lengthscales = 0.68, variance = 0.8)
periodic(period = 0.71, lengthscale = 0.59, variance = 0.2)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
