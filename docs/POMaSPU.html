<!DOCTYPE html><html lang="en"><head><title>Help for package POMaSPU</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {POMaSPU}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#POMaSPU-package'>
<p>Adaptive Association Tests for Multiple Phenotypes using Proportional Odds Model (POM)</p></a></li>
<li><a href='#POMaSPU'>
<p>An adaptive sum of powered score (SPU) test for single SNP and mutiple phenotypes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Adaptive Association Tests for Multiple Phenotypes using
Proportional Odds Model (POM-aSPU)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Junghi Kim and Wei Pan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Junghi Kim &lt;junghikim0@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>POM-aSPU test evaluates an association between an ordinal response and multiple phenotypes, for details see Kim and Pan (2017) &lt;<a href="https://doi.org/10.1002%2Fgepi.22033">doi:10.1002/gepi.22033</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GNU General Public License (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), MASS, matrixStats, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.6)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-20 21:01:49 UTC; jkim30</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-20 23:03:47 UTC</td>
</tr>
</table>
<hr>
<h2 id='POMaSPU-package'>
Adaptive Association Tests for Multiple Phenotypes using Proportional Odds Model (POM)
</h2><span id='topic+POMaSPU-package'></span>

<h3>Description</h3>

<p>Provides adaptive association tests for multiple phenotypes.
</p>


<h3>Details</h3>

<p>POM-aSPU test evaluates an association between an ordinal response (categorical variable) and multiple variables (a set of phenotypes). 
We treat single SNP as an ordinal response and 
multiple traits as predictors in a proportional odds model (POM).
The proposed method can be applied to a high dimensional setting where the number of phenotypes (<em>p</em>) can be larger than the sample size (<em>n</em>), in addition to the usual small (<em>p</em>) setting.</p>


<h3>Author(s)</h3>

<p>Junghi Kim and Wei Pan
</p>


<h3>References</h3>

<p>Kim J, and Pan W (2017). &quot;Adaptive testing for multiple traits in a proportional odds model with applications to detect SNP-brain network associations.&quot; <em>Genetic Epidemiology</em>, 41(3), 259&ndash;277.
</p>

<hr>
<h2 id='POMaSPU'>
An adaptive sum of powered score (SPU) test for single SNP and mutiple phenotypes
</h2><span id='topic+POMaSPU'></span>

<h3>Description</h3>

<p>POM-aSPU test evaluates an associations between an ordinal response (e.g. SNP) 
and multiple phenotypes;
provides a series of p-values of POM-SPU(pow) and POM-aSPU tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POMaSPU(Y, Y.level, pheno, Z = NULL, pow = c(1:8, Inf), n.perm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="POMaSPU_+3A_y">Y</code></td>
<td>
<p>a vector of categorical indicators</p>
</td></tr>
<tr><td><code id="POMaSPU_+3A_y.level">Y.level</code></td>
<td>
<p>a vector indicating an order of categories either numeric or character e.g. Y.level = c(0, 1, 2) or 
Y.level = c(&quot;Well&quot;, &quot;Mild&quot;, &quot;Impaired&quot;).</p>
</td></tr>
<tr><td><code id="POMaSPU_+3A_pheno">pheno</code></td>
<td>
<p>a numeric phenotype matrix with each row as a different individual and each column as a separate phenotype.</p>
</td></tr>
<tr><td><code id="POMaSPU_+3A_z">Z</code></td>
<td>
<p>a numeric covariate matrix with each row as a different individual and each column as a covariate to be adjusted.</p>
</td></tr>
<tr><td><code id="POMaSPU_+3A_pow">pow</code></td>
<td>
<p>a vector of the power weight to be used at a trait level (default = c(1:8, Inf)).</p>
</td></tr>
<tr><td><code id="POMaSPU_+3A_n.perm">n.perm</code></td>
<td>
<p>a numeric value of number of null statistics (default = 1000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adaptive association tests for an ordinal variable (e.g. SNP) and multiple phenotypes using POM.
</p>


<h3>Value</h3>

<p>a vector of p-values from POM-SPU(pow) tests and POM-aSPU test.
</p>


<h3>Note</h3>

<p>We provide a permutation based POM-aSPU test where null statistics are generated from permutations.
</p>


<h3>Author(s)</h3>

<p>Junghi Kim and Wei Pan
</p>


<h3>References</h3>

<p>Kim J, and Pan W (2017). &quot;Adaptive testing for multiple traits in a proportional odds model with applications to detect SNP-brain network associations.&quot; <em>Genetic Epidemiology</em>, 41(3), 259&ndash;277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1) 
# -- simulating phenotypes
# -- n.subjects: number of subjects
# -- n.traits: number of phenotypes

set.seed(136)
n.subjects &lt;- 100
n.traits &lt;- 10
pheno &lt;- matrix(rnorm(n.subjects*n.traits), n.subjects, n.traits)


# -- simulating genotype (Y) and covariates (Z)
Y &lt;- sample(c(0,1,2), n.subjects, replace = TRUE)
Z &lt;- matrix(rnorm(n.subjects*2, 2, 1), n.subjects, 2)

# -- Computing the p-value of POMaSPU test with the permutation based method
Pvl &lt;- POMaSPU(Y = Y, Y.level = c(0,1,2), pheno = pheno, Z = Z,  pow = c(1,2,4,Inf), n.perm = 1000)


# -- Each element of Pvl is a p value of POM-SPU(pow) in order
# -- The last element of Pvl is a p value of POM-aSPU test
Pvl
Pvl[length(Pvl)]


# &gt; Pvl
#     SPU.1     SPU.2     SPU.4   SPU.Inf      aSPU 
# 0.1800000 0.5010000 0.3220000 0.1720000 0.3506494 


# &gt; Pvl[length(Pvl)]
#      aSPU
# 0.3506494



# Example 2) 
# n.subjects &lt;- 100
# n.traits &lt;- 10
# Y &lt;- sample(c("Well", "Mild", "Sick"), n.subjects, replace = TRUE)
# pheno &lt;- matrix(rnorm(n.subjects*n.traits), n.subjects, n.traits)
# Z &lt;- matrix(rnorm(n.subjects*2, 2, 1), n.subjects, 2)
# Pvl &lt;- POMaSPU(Y = Y, Y.level = c("Sick", "Mild",  "Well"), pheno = pheno, Z = Z,  
# 		 pow = c(1,2,4,Inf), n.perm = 1000)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
