<!DOCTYPE html><html><head><title>Help for package ucminf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ucminf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ucminf-package'><p>ucminf: General-Purpose Unconstrained Non-Linear Optimization</p></a></li>
<li><a href='#ucminf'><p>General-Purpose Unconstrained Non-Linear Optimization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>General-Purpose Unconstrained Non-Linear Optimization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An algorithm for general-purpose unconstrained non-linear optimization.
             The algorithm is of quasi-Newton type with BFGS updating of the inverse
             Hessian and soft line search with a trust region type monitoring of the
             input to the line search algorithm. The interface of 'ucminf' is
             designed for easy interchange with 'optim'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hdakpo/ucminf">https://github.com/hdakpo/ucminf</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hdakpo/ucminf/issues">https://github.com/hdakpo/ucminf/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>numDeriv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-24 17:05:54 UTC; Dakpo</td>
</tr>
<tr>
<td>Author:</td>
<td>K Hervé Dakpo [ctb, cre],
  Hans Bruun Nielsen [aut],
  Stig Bousgaard Mortensen [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>K Hervé Dakpo &lt;k-herve.dakpo@inrae.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-24 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ucminf-package'>ucminf: General-Purpose Unconstrained Non-Linear Optimization</h2><span id='topic+ucminf-package'></span><span id='topic+_UCMINF'></span>

<h3>Description</h3>

<p>The <span class="pkg">ucminf</span> package provides an algorithm for general-purpose
unconstrained non-linear optimization.
</p>


<h3>Bugreport</h3>

<p>Any bug or suggestion can be reported using the
<code>ucminf</code> tracker facilities at:
<a href="https://github.com/hdakpo/ucminf/issues">https://github.com/hdakpo/ucminf/issues</a>
</p>


<h3>Author(s)</h3>

<p>K Hervé Dakpo, Hans Bruun Nielsen, and Stig Bousgaard Mortensen
</p>

<hr>
<h2 id='ucminf'>General-Purpose Unconstrained Non-Linear Optimization</h2><span id='topic+ucminf'></span>

<h3>Description</h3>

<p>An algorithm for general-purpose unconstrained non-linear optimization. The
algorithm is of quasi-Newton type with BFGS updating of the inverse
Hessian and soft line search with a trust region type monitoring of the
input to the line search algorithm. The interface of &lsquo;ucminf&rsquo; is
designed for easy interchange with &lsquo;optim&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ucminf(par, fn, gr = NULL, ..., control = list(), hessian = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ucminf_+3A_par">par</code></td>
<td>
<p>Initial estimate of minimum for <code>fn</code>.</p>
</td></tr>
<tr><td><code id="ucminf_+3A_fn">fn</code></td>
<td>
<p>Objective function to be minimized.</p>
</td></tr>
<tr><td><code id="ucminf_+3A_gr">gr</code></td>
<td>
<p>Gradient of objective function. If <code>NULL</code> a finite difference
approximation is used.</p>
</td></tr>
<tr><td><code id="ucminf_+3A_...">...</code></td>
<td>
<p>Optional arguments passed to the objective and gradient functions.</p>
</td></tr>
<tr><td><code id="ucminf_+3A_control">control</code></td>
<td>
<p>A list of control parameters. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="ucminf_+3A_hessian">hessian</code></td>
<td>
<p>Integer value: </p>
<dl>
<dt>0</dt><dd><p>No hessian approximation is
returned.</p>
</dd> <dt>1</dt><dd><p>Returns a numerical approximation of the Hessian using
&lsquo;hessian&rsquo; in the package &lsquo;numDeriv&rsquo;.</p>
</dd> <dt>2</dt><dd><p>Returns final
approximation of the inverse Hessian based on the series of BFGS updates
during optimization.</p>
</dd> <dt>3</dt><dd><p>Same at 2, but will also return the Hessian
(the inverse of 2).</p>
</dd></dl>
<p> If a <code>TRUE</code> or <code>FALSE</code> value is given it will
switch between option 1 or 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is documented in (Nielsen, 2000) (see References below)
together with a comparison to the Fortran subroutine &lsquo;MINF&rsquo; and the
Matlab function &lsquo;fminunc&rsquo;. The implementation of &lsquo;ucminf&rsquo; in
<span class="rlang"><b>R</b></span> uses the original Fortran version of the algorithm.
</p>
<p>The interface in R is designed so that it is very easy to switch
between using &lsquo;ucminf&rsquo; and &lsquo;<a href="stats.html#topic+optim">optim</a>&rsquo;. The
arguments <code>par</code>, <code>fn</code>, <code>gr</code>, and <code>hessian</code>
are all the same (with a few extra options for <code>hessian</code> in
&lsquo;ucminf&rsquo;). The difference is that there is no <code>method</code>
argument in &lsquo;ucminf&rsquo; and that some of the components in the
<code>control</code> argument are different due to differences in the algorithms.
</p>
<p>The algorithm can be given an initial estimate of the Hessian for the
optimization and it is possible to get the final approximation of the
Hessian based on the series of BFGS updates. This extra functionality
may be useful for optimization in a series of related problems.
</p>
<p>The functions <code>fn</code> and <code>gr</code> can return <code>Inf</code> or <code>NaN</code>
if the functions cannot be evaluated at the supplied value, but the
functions must be computable at the initial value. The functions
are not allowed to return <code>NA</code>. Any names given to <code>par</code> will be
copied to the vectors passed to <code>fn</code> and <code>gr</code>. No
other attributes of <code>par</code> are copied over.
</p>
<p>The <code>control</code> argument is a list that can supply any of the
following components:
</p>
<dl>
<dt><code>trace</code></dt><dd><p>If trace is positive then detailed tracing
information is printed for each iteration.</p>
</dd>
<dt><code>grtol</code></dt><dd><p>The algorithm stops when
<code class="reqn">||F'(x)||_\infty \leq </code> grtol, that is when the
largest absolute value of the gradient is less than grtol. Default value is
<code>grtol = 1e-6</code>. </p>
</dd>
<dt><code>xtol</code></dt><dd><p>The algorithm stops when <code class="reqn">||x-x_p||_2 \leq
\textrm{xtol}\cdot(\textrm{xtol} + ||x||_2)</code>, where <code class="reqn">x_p</code> and <code class="reqn">x</code> are the previous and current estimate
of the minimizer. Thus the algorithm stops when the last relative step length
is sufficiently small. Default value is <code>xtol = 1e-12</code>.</p>
</dd>
<dt><code>stepmax</code></dt><dd><p>Initial maximal allowed step length (radius of
trust-region). The value is updated during the optimization. Default value
is <code>stepmax = 1</code>.</p>
</dd>
<dt><code>maxeval</code></dt><dd><p>The maximum number of function evaluations.
A function evaluation is counted as one evaluation of the objective function
and of the gradient function. Default value is <code>maxeval = 500</code>.</p>
</dd>
<dt><code>grad</code></dt><dd><p>Either &lsquo;forward&rsquo; or &lsquo;central&rsquo;. Controls
the type of finite difference approximation to be used for the gradient if no
gradient function is given in the input argument &lsquo;gr&rsquo;. Default value
is <code>grad = 'forward'</code>.</p>
</dd>
<dt><code>gradstep</code></dt><dd><p>Vector of length 2. The step length in finite
difference approximation for the gradient. Step length is
<code class="reqn">|x_i|\cdot\textrm{gradstep[1]+gradstep[2]}</code>. Default value is <code>gradstep = c(1e-6, 1e-8)</code>.</p>
</dd>
<dt><code>invhessian.lt</code></dt><dd><p>A vector with an initial approximation to the
lower triangle of the inverse Hessian. If not given, the inverse Hessian is
initialized as the identity matrix. If <code>H0</code> is the initial hessian
matrix then the lower triangle of the inverse of <code>H0</code> can be found as
<code>invhessian.lt = solve(H0)[lower.tri(H0,diag=TRUE)]</code>.</p>
</dd></dl>



<h3>Value</h3>

<p><code><a href="#topic+ucminf">ucminf</a></code> returns a list of class <code>'ucminf'</code>
containing the following elements:
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p>Computed minimizer.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>Objective function value at computed minimizer.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Flag for reason of termination:
</p>

<dl>
<dt>1</dt><dd><p>Stopped by small gradient (grtol).</p>
</dd>
<dt>2</dt><dd><p>Stopped by small step (xtol).</p>
</dd>
<dt>3</dt><dd><p>Stopped by function evaluation limit (maxeval).</p>
</dd>
<dt>4</dt><dd><p>Stopped by zero step from line search</p>
</dd>
<dt>-2</dt><dd><p>Computation did not start: length(par) = 0.</p>
</dd>
<dt>-4</dt><dd><p>Computation did not start: stepmax is too small.</p>
</dd>
<dt>-5</dt><dd><p>Computation did not start: grtol or xtol &lt;= 0.</p>
</dd>
<dt>-6</dt><dd><p>Computation did not start: maxeval &lt;= 0.</p>
</dd>
<dt>-7</dt><dd><p>Computation did not start: given Hessian not pos. definite.</p>
</dd></dl>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>String with reason of termination.</p>
</td></tr>
<tr><td><code>hessian</code>, <code>invhessian</code></td>
<td>
<p>Estimate of (inv.) Hessian at computed minimizer.
The type of estimate is given by the input argument &lsquo;hessian&rsquo;.</p>
</td></tr>
<tr><td><code>invhessian.lt</code></td>
<td>
<p>The lower triangle of the final approximation to the
inverse Hessian based on the series of BFGS updates during optimization.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>Information about the search:
</p>

<dl>
<dt>maxgradient</dt><dd><p><code class="reqn">||F'(x)||_\infty</code>, the largest element
in the absolute value of the gradient at the computed minimizer.</p>
</dd>
<dt>laststep</dt><dd><p>Length of last step.</p>
</dd>
<dt>stepmax</dt><dd><p>Final maximal allowed step length.</p>
</dd>
<dt>neval</dt><dd><p>Number of calls to both objective and gradient function.</p>
</dd></dl>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>&lsquo;UCMINF&rsquo; algorithm design and Fortran code by Hans Bruun
Nielsen.
</p>
<p>K Hervé Dakpo took over maintenance of the package in May. 2023.
</p>
<p>Implementation in <span class="rlang"><b>R</b></span> by Stig B. Mortensen, <a href="mailto:stigbm@gmail.com">stigbm@gmail.com</a>.
</p>
<p>Modifications by Douglas Bates <a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>, Nov. 2010, to
support nested optimization and correct issues with printing on Windows.
</p>


<h3>References</h3>

<p>Nielsen, H. B. (2000) &lsquo;UCMINF - An Algorithm For
Unconstrained, Nonlinear Optimization&rsquo;, Report IMM-REP-2000-19, Department of
Mathematical Modelling, Technical University of Denmark.
<a href="http://www.imm.dtu.dk/documents/ftp/tr00/tr19_00.pdf">http://www.imm.dtu.dk/documents/ftp/tr00/tr19_00.pdf</a>
</p>
<p>The original Fortran source code was found at
<code>http://www2.imm.dtu.dk/projects/hbn_software/ucminf.f</code>.
(That URL is no longer available but archived at
<a href="https://web.archive.org/web/20050418082240/http://www.imm.dtu.dk/~hbn/Software/ucminf.f">https://web.archive.org/web/20050418082240/http://www.imm.dtu.dk/~hbn/Software/ucminf.f</a>
&ndash; Dr Nielsen passed away in 2015). The code has been slightly modified in
this package to be suitable for use with <span class="rlang"><b>R</b></span>.
</p>
<p>The general structure of the implementation in <span class="rlang"><b>R</b></span> is based on the
package &lsquo;FortranCallsR&rsquo; by Diethelm Wuertz.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlminb">nlminb</a></code>,
<code><a href="stats.html#topic+nlm">nlm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Rosenbrock Banana function
fR &lt;- function(x) (1 - x[1])^2 + 100 * (x[2] - x[1]^2)^2
gR &lt;- function(x) c(-400 * x[1] * (x[2] - x[1] * x[1]) - 2 * (1 - x[1]),
                    200 * (x[2] - x[1] * x[1]))
#  Find minimum and show trace
ucminf(par = c(2,.5), fn = fR, gr = gR, control = list(trace = 1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
