<!DOCTYPE html><html><head><title>Help for package metaSEM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metaSEM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Aloe14'><p>Multivariate effect sizes between classroom management</p>
self-efficacy (CMSE) and other variables reported by Aloe et al. (2014)</a></li>
<li><a href='#anova'><p>Compare Nested Models with Likelihood Ratio Statistic</p></a></li>
<li><a href='#as.mxAlgebra'><p>Convert a Character Matrix into MxAlgebra-class</p></a></li>
<li><a href='#as.mxMatrix'><p>Convert a Matrix into MxMatrix-class</p></a></li>
<li><a href='#as.symMatrix'><p>Convert a Character Matrix with Starting Values to a Character Matrix</p>
without Starting Values</a></li>
<li><a href='#asyCov'><p>Compute Asymptotic Covariance Matrix of a Correlation/Covariance Matrix</p></a></li>
<li><a href='#BCG'><p>Dataset on the Effectiveness of the BCG Vaccine for Preventing Tuberculosis</p></a></li>
<li><a href='#bdiagMat'><p>Create a Block Diagonal Matrix</p></a></li>
<li><a href='#bdiagRep'><p>Create a Block Diagonal Matrix by Repeating the Input</p></a></li>
<li><a href='#Becker09'><p>Ten Studies of Correlation Matrices used by Becker (2009)</p></a></li>
<li><a href='#Becker83'><p>Studies on Sex Differences in Conformity Reported by Becker (1983)</p></a></li>
<li><a href='#Becker92'><p>Six Studies of Correlation Matrices reported by Becker (1992; 1995)</p></a></li>
<li><a href='#Becker94'><p>Five Studies of Ten Correlation Matrices reported by Becker and</p>
Schram (1994)</a></li>
<li><a href='#Berkey98'><p>Five Published Trails from Berkey et al. (1998)</p></a></li>
<li><a href='#Boer16'><p>Correlation Matrices from Boer et al. (2016)</p></a></li>
<li><a href='#bootuniR1'><p>Parametric bootstrap on the univariate R (uniR) object</p></a></li>
<li><a href='#bootuniR2'><p>Fit Models on the bootstrapped correlation matrices</p></a></li>
<li><a href='#Bornmann07'><p>A Dataset from Bornmann et al. (2007)</p></a></li>
<li><a href='#calEffSizes'><p>Calculate Effect Sizes using lavaan Models</p></a></li>
<li><a href='#checkRAM'><p>Check the correctness of the RAM formulation</p></a></li>
<li><a href='#Cheung00'><p>Fifty Studies of Correlation Matrices used in Cheung and Chan (2000)</p></a></li>
<li><a href='#Cheung09'><p>A Dataset from TSSEM User's Guide Version 1.11 by Cheung (2009)</p></a></li>
<li><a href='#coef'><p>Extract Parameter Estimates from various classes.</p></a></li>
<li><a href='#Cooke16'><p>Correlation Matrices from Cooke et al. (2016)</p></a></li>
<li><a href='#Cooper03'><p>Selected effect sizes from Cooper et al. (2003)</p></a></li>
<li><a href='#Cor2DataFrame'><p>Convert correlation or covariance matrices into a dataframe of correlations or</p>
covariances with their sampling covariance matrices</a></li>
<li><a href='#create.Fmatrix'><p>Create an F matrix to select observed variables</p></a></li>
<li><a href='#create.modMatrix'><p>Create a moderator matrix used in OSMASEM</p></a></li>
<li><a href='#create.mxMatrix'><p>Create a Vector into MxMatrix-class</p></a></li>
<li><a href='#create.mxModel'><p>Create an mxModel</p></a></li>
<li><a href='#create.Tau2'><p>Create a variance component of the heterogeneity of the random effects</p></a></li>
<li><a href='#create.V'><p>Create a V-known matrix</p></a></li>
<li><a href='#create.vechsR'><p>Create a model implied correlation matrix with implicit diagonal constraints</p></a></li>
<li><a href='#Diag'><p>Matrix Diagonals</p></a></li>
<li><a href='#Digman97'><p>Factor Correlation Matrices of Big Five Model from Digman (1997)</p></a></li>
<li><a href='#Gleser94'><p>Two Datasets from Gleser and Olkin (1994)</p></a></li>
<li><a href='#Gnambs18'><p>Correlation Matrices from Gnambs, Scharl, and Schroeders (2018)</p></a></li>
<li><a href='#HedgesOlkin85'><p>Effects of Open Education Reported by Hedges and Olkin (1985)</p></a></li>
<li><a href='#homoStat'><p>Test the Homogeneity of Effect Sizes</p></a></li>
<li><a href='#Hox02'><p>Simulated Effect Sizes Reported by Hox (2002)</p></a></li>
<li><a href='#Hunter83'><p>Fourteen Studies of Correlation Matrices reported by Hunter (1983)</p></a></li>
<li><a href='#impliedR'><p>Create or Generate the Model Implied Correlation or Covariance Matrices</p></a></li>
<li><a href='#indirectEffect'><p>Estimate the asymptotic covariance matrix of standardized or unstandardized indirect and direct effects</p></a></li>
<li><a href='#is.pd'><p>Test Positive Definiteness of a List of Square Matrices</p></a></li>
<li><a href='#issp05'><p>A Dataset from ISSP (2005)</p></a></li>
<li><a href='#issp89'><p>A Dataset from Cheung and Chan (2005; 2009)</p></a></li>
<li><a href='#Jaramillo05'><p>Dataset from Jaramillo, Mulki &amp; Marshall (2005)</p></a></li>
<li><a href='#Kalaian96'><p>Multivariate effect sizes reported by Kalaian and Raudenbush (1996)</p></a></li>
<li><a href='#lavaan2RAM'>
<p>Convert <code>lavaan</code> models to RAM models</p></a></li>
<li><a href='#list2matrix'><p>Convert a List of Symmetric Matrices into a Stacked Matrix</p></a></li>
<li><a href='#Mak09'><p>Eight studies from Mak et al. (2009)</p></a></li>
<li><a href='#Mathieu15'><p>Correlation Matrices from Mathieu et al. (2015)</p></a></li>
<li><a href='#matrix2bdiag'><p>Convert a Matrix into a Block Diagonal Matrix</p></a></li>
<li><a href='#meta'><p>Univariate and Multivariate Meta-Analysis with Maximum</p>
Likelihood Estimation</a></li>
<li><a href='#meta2semPlot'>
<p>Convert <code>metaSEM</code> objects into <code>semPlotModel</code> objects for plotting</p></a></li>
<li><a href='#meta3L'><p>Three-Level Univariate Meta-Analysis with Maximum Likelihood Estimation</p></a></li>
<li><a href='#metaSEM-package'><p>Meta-Analysis using Structural Equation Modeling</p></a></li>
<li><a href='#Nam03'><p>Dataset on the Environmental Tobacco Smoke (ETS) on children's health</p></a></li>
<li><a href='#Nohe15'><p>Correlation Matrices from Nohe et al. (2015)</p></a></li>
<li><a href='#Norton13'><p>Studies on the Hospital Anxiety and Depression Scale Reported by Norton et al. (2013)</p></a></li>
<li><a href='#osmasem'><p>One-stage meta-analytic structural equation modeling</p></a></li>
<li><a href='#osmasemR2'><p>Calculate the R2 in OSMASEM and OSMASEM3L</p></a></li>
<li><a href='#osmasemSRMR'><p>Calculate the SRMR in OSMASEM and OSMASEM3L</p></a></li>
<li><a href='#pattern.n'><p>Display the Accumulative Sample Sizes for the Covariance Matrix</p></a></li>
<li><a href='#pattern.na'><p>Display the Pattern of Missing Data of a List of Square Matrices</p></a></li>
<li><a href='#plot'><p>Plot methods for various objects</p></a></li>
<li><a href='#print'><p>Print Methods for various Objects</p></a></li>
<li><a href='#rCor'><p>Generate (Nested) Sample/Population Correlation/Covariance Matrices</p></a></li>
<li><a href='#readData'><p>Read External Correlation/Covariance Matrices</p></a></li>
<li><a href='#reml'><p>Estimate Variance Components with Restricted (Residual) Maximum</p>
Likelihood Estimation</a></li>
<li><a href='#reml3L'><p>Estimate Variance Components in Three-Level Univariate</p>
Meta-Analysis with Restricted (Residual) Maximum
Likelihood Estimation</a></li>
<li><a href='#rerun'><p>Rerun models via mxTryHard()</p></a></li>
<li><a href='#Roorda11'><p>Studies on Students' School Engagement and Achievement Reported</p>
by Roorda et al. (2011)</a></li>
<li><a href='#Scalco17'><p>Correlation Matrices from Scalco et al. (2017)</p></a></li>
<li><a href='#smdMES'><p>Compute Effect Sizes for Multiple End-point Studies</p></a></li>
<li><a href='#smdMTS'><p>Compute Effect Sizes for Multiple Treatment Studies</p></a></li>
<li><a href='#Stadler15'><p>Correlations from Stadler et al. (2015)</p></a></li>
<li><a href='#summary'><p>Summary Method for tssem1, wls, meta, and meta3LFIML Objects</p></a></li>
<li><a href='#Tenenbaum02'><p>Correlation coefficients reported by Tenenbaum and Leaper (2002)</p></a></li>
<li><a href='#tssem1'><p>First Stage of the Two-Stage Structural Equation Modeling (TSSEM)</p></a></li>
<li><a href='#tssemParaVar'><p>Estimate the heterogeneity (SD) of the parameter estimates of the</p>
TSSEM object</a></li>
<li><a href='#uniR1'><p>First Stage analysis of the univariate R (uniR) approach</p></a></li>
<li><a href='#uniR2'><p>Second Stage analysis of the univariate R (uniR) approach</p></a></li>
<li><a href='#vanderPol17'><p>Dataset on the effectiveness of multidimensional family therapy in treating</p>
adolescents with multiple behavior problems</a></li>
<li><a href='#VarCorr'><p>Extract Variance-Covariance Matrix of the Random Effects</p></a></li>
<li><a href='#vcov'><p>Extract Covariance Matrix Parameter Estimates from Objects of</p>
Various Classes</a></li>
<li><a href='#vec2symMat'><p>Convert a Vector into a Symmetric Matrix</p></a></li>
<li><a href='#wls'><p>Conduct a Correlation/Covariance Structure Analysis with WLS</p></a></li>
<li><a href='#wvs94a'><p>Forty-four Studies from Cheung (2013)</p></a></li>
<li><a href='#wvs94b'><p>Forty-four Covariance Matrices on Life Satisfaction, Job Satisfaction, and Job Autonomy</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Meta-Analysis using Structural Equation Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-08</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), OpenMx</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, MASS, ellipse, graphics, stats, utils, mvtnorm,
numDeriv, lavaan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>metafor, semPlot, R.rsp, testthat, matrixcalc</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mike Cheung &lt;mikewlcheung@nus.edu.sg&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions for conducting meta-analysis using a
             structural equation modeling (SEM) approach via the 'OpenMx' and
             'lavaan' packages. It also implements various procedures to
             perform meta-analytic structural equation modeling on the
             correlation and covariance matrices, see Cheung (2015)
             &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2014.01521">doi:10.3389/fpsyg.2014.01521</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mikewlcheung/metasem">https://github.com/mikewlcheung/metasem</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mikewlcheung/metasem/issues">https://github.com/mikewlcheung/metasem/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 12:05:42 UTC; mikewlcheung</td>
</tr>
<tr>
<td>Author:</td>
<td>Mike Cheung <a href="https://orcid.org/0000-0003-0113-0758"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Aloe14'>Multivariate effect sizes between classroom management
self-efficacy (CMSE) and other variables reported by Aloe et al. (2014)
</h2><span id='topic+Aloe14'></span>

<h3>Description</h3>

<p>This study reports sixteen studies on the effect sizes
(correlation coefficients) between CMSE and emotional exhaustion (EE),
depersonalization (DP), and (lowered) personal accomplishment (PA)
reported by Aloe et al. (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Aloe14")</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 14 variables.
</p>

<dl>
<dt><code>Study</code></dt><dd><p>a factor with levels <code>Betoret</code> <code>Brouwers &amp; Tomic</code> <code>Bumen</code> <code>Chang</code> <code>Durr</code> <code>Evers et al.</code> <code>Friedman</code> <code>Gold</code> <code>Huk</code> <code>Kress</code> <code>Kumarakulasingam</code> <code>Martin et al.</code> <code>Ozdemir</code> <code>Skaalvik and Skaalvik</code> <code>Williams</code></p>
</dd>
<dt><code>Year</code></dt><dd><p>Year of publication</p>
</dd>
<dt><code>EE</code></dt><dd><p>Emotional exhaustion</p>
</dd>
<dt><code>DP</code></dt><dd><p>Depersonalization</p>
</dd>
<dt><code>PA</code></dt><dd><p>(Lowered) personal accomplishment</p>
</dd>
<dt><code>V_EE</code></dt><dd><p>Sampling variance of emotional exhaustion</p>
</dd>
<dt><code>V_DP</code></dt><dd><p>Sampling variance of depersonalization</p>
</dd>
<dt><code>V_PA</code></dt><dd><p>Sampling variance of (lowered) personal accomplishment</p>
</dd>
<dt><code>C_EE_DP</code></dt><dd><p>Sampling covariance between EE and DP</p>
</dd>
<dt><code>C_EE_PA</code></dt><dd><p>Sampling covariance between EE and PA</p>
</dd>
<dt><code>C_DP_PA</code></dt><dd><p>Sampling covariance between DP and PA</p>
</dd>
<dt><code>Publication_type</code></dt><dd><p>Either <code>Dissertation</code> or <code>Journal</code></p>
</dd>
<dt><code>Percentage_females</code></dt><dd><p>Percentage of females in the study</p>
</dd>
<dt><code>Years_experience</code></dt><dd><p>Average years of experience</p>
</dd>
</dl>



<h3>Source</h3>

<p>Aloe, A. M., Amo, L. C., &amp; Shanahan, M. E. (2014). Classroom management self-efficacy and burnout: A multivariate meta-analysis. <em>Educational Psychology Review</em>, <b>26(1)</b>, 101-126. doi:10.1007/s10648-013-9244-0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Aloe14)

## Random-effects meta-analysis
meta1 &lt;- meta(cbind(EE,DP,PA),
              cbind(V_EE, C_EE_DP, C_EE_PA, V_DP, C_DP_PA, V_PA),
              data=Aloe14)
## Remove error code
meta1 &lt;- rerun(meta1)

summary(meta1)

## Extract the coefficients for the variance component of the random effects
coef1 &lt;- coef(meta1, select="random")

## Convert it into a symmetric matrix by row major
my.cov &lt;- vec2symMat(coef1, byrow=TRUE)

## Convert it into a correlation matrix
cov2cor(my.cov)

## Plot the multivariate effect sizes
plot(meta1)

## End(Not run)
</code></pre>

<hr>
<h2 id='anova'>Compare Nested Models with Likelihood Ratio Statistic
</h2><span id='topic+anova.wls'></span><span id='topic+anova.meta'></span><span id='topic+anova.meta3LFIML'></span><span id='topic+anova.reml'></span><span id='topic+anova.osmasem'></span>

<h3>Description</h3>

<p>It compares nested models with the likelihood ratio
statistic from various objects. It is a wrapper of <code><a href="OpenMx.html#topic+mxCompare">mxCompare</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wls'
anova(object, ..., all=FALSE)
## S3 method for class 'meta'
anova(object, ..., all=FALSE)
## S3 method for class 'meta3LFIML'
anova(object, ..., all=FALSE)
## S3 method for class 'reml'
anova(object, ..., all=FALSE)
## S3 method for class 'osmasem'
anova(object, ..., all=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova_+3A_object">object</code></td>
<td>
<p>An object or a list of objects of various classes. It will be passed to the
<code>base</code> argument in <code><a href="OpenMx.html#topic+mxCompare">mxCompare</a></code>.
</p>
</td></tr>
<tr><td><code id="anova_+3A_...">...</code></td>
<td>
<p>An object or a list of objects of various classes. It will be passed to the
<code>comparison</code> argument in <code><a href="OpenMx.html#topic+mxCompare">mxCompare</a></code>.
</p>
</td></tr>  
<tr><td><code id="anova_+3A_all">all</code></td>
<td>
<p>A Boolean value on whether to compare all bases with all
comparisons. It will be passed to the <code>all</code> argument in
<code><a href="OpenMx.html#topic+mxCompare">mxCompare</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table of comparisons between the models in base and comparison.
</p>


<h3>Note</h3>

<p>When the objects are class <code><a href="#topic+wls">wls</a></code>, the degrees
of freedom in the base and comparison models are incorrect, while the degrees of
freedom of the difference between them is correct. If users want to
obtain the correct degrees of freedom in the base and comparison
models, they may individually apply the <code><a href="#topic+summary">summary</a></code> function on
the base and comparison models.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Test the significance of a predictor with likelihood ratio test
## Model0: No predictor
model0 &lt;- meta(y=yi, v=vi, data=Hox02, model.name="No predictor")

## Model1: With a predictor
model1 &lt;- meta(y=yi, v=vi, x=weeks, data=Hox02, model.name="One predictor")

## Compare these two models
anova(model1, model0) 
</code></pre>

<hr>
<h2 id='as.mxAlgebra'>Convert a Character Matrix into MxAlgebra-class
</h2><span id='topic+as.mxAlgebra'></span>

<h3>Description</h3>

<p>It converts a character matrix into <code>MxAlgebra</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.mxAlgebra(x, startvalues=NULL, name="X")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.mxAlgebra_+3A_x">x</code></td>
<td>
<p>A character or numeric matrix, which consists of valid
operators in <code>mxAlgebra</code>. 
</p>
</td></tr>
<tr><td><code id="as.mxAlgebra_+3A_startvalues">startvalues</code></td>
<td>
<p>A list of starting values of the free parameters. If it is
not provided, all free parameters are assumed 0.</p>
</td></tr>  
<tr><td><code id="as.mxAlgebra_+3A_name">name</code></td>
<td>
<p>A character string of the names of the objects based
on.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose the name argument is &quot;X&quot;, the output is a list of the
following elements. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>mxalgebra</code></td>
<td>
<p>An <code>mxAlgebra</code> object.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>A column vector <code>mxMatrix</code> of the free parameters.</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>A list of mxMatrix to form the <code>mxAlgebra</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>, <code><a href="OpenMx.html#topic+mxAlgebra">mxAlgebra</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a, b, and c are free parameters
(A1 &lt;- matrix(c(1, "a*b", "a^b", "exp(c)"), ncol=2, nrow=2))
##      [,1]  [,2]    
## [1,] "1"   "a^b"   
## [2,] "a*b" "exp(c)"

A &lt;- as.mxAlgebra(A1, startvalues=list(a=1, b=2), name="A")

## An object of mxAlgebra
A$mxalgebra
## mxAlgebra 'A' 
## $formula:  rbind(cbind(A1_1, A1_2), cbind(A2_1, A2_2)) 
## $result: (not yet computed) &lt;0 x 0 matrix&gt;
## dimnames: NULL

## A matrix of parameters
A$parameters
## FullMatrix 'Avars' 

## $labels
##      [,1]
## [1,] "a" 
## [2,] "b" 
## [3,] "c" 

## $values
##      [,1]
## [1,] 1   
## [2,] 2   
## [3,] 0   

## $free
##      [,1]
## [1,] TRUE
## [2,] TRUE
## [3,] TRUE

## $lbound: No lower bounds assigned.

## $ubound: No upper bounds assigned.


## A list of matrices of elements for the mxAlgebra
A$list
## $A1_1
## mxAlgebra 'A1_1' 
## $formula:  1 
## $result: (not yet computed) &lt;0 x 0 matrix&gt;
## dimnames: NULL

## $A2_1
## mxAlgebra 'A2_1' 
## $formula:  a * b 
## $result: (not yet computed) &lt;0 x 0 matrix&gt;
## dimnames: NULL

## $A1_2
## mxAlgebra 'A1_2' 
## $formula:  a^b 
## $result: (not yet computed) &lt;0 x 0 matrix&gt;
## dimnames: NULL

## $A2_2
## mxAlgebra 'A2_2' 
## $formula:  exp(c) 
## $result: (not yet computed) &lt;0 x 0 matrix&gt;
## dimnames: NULL
</code></pre>

<hr>
<h2 id='as.mxMatrix'>Convert a Matrix into MxMatrix-class
</h2><span id='topic+as.mxMatrix'></span>

<h3>Description</h3>

<p>It converts a matrix into <code>MxMatrix-class</code> via <code>mxMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.mxMatrix(x, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.mxMatrix_+3A_x">x</code></td>
<td>
<p>A character or numeric matrix. If <code>x</code> is not a matrix,
<code>as.matrix(x)</code> is applied first. 
</p>
</td></tr>
<tr><td><code id="as.mxMatrix_+3A_name">name</code></td>
<td>
<p>An optional character string as the name of the
MxMatrix object created by mxModel function. If the <code>name</code> is missing,
the name of <code>x</code> will be used.</p>
</td></tr>
<tr><td><code id="as.mxMatrix_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to
<code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code>. It should be noted that <code>type</code>,
<code>nrow</code>, <code>ncol</code>, <code>values</code>, <code>free</code>, <code>name</code>
and <code>labels</code> will be created automatically. Thus, these
arguments except labels should be avoided in ... 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are non-numeric values in <code>x</code>, they are treated
as the labels of the parameters. If a &quot;*&quot; is
present, the numeric value on the left-hand side will be treated as
the starting value for a free parameter. If an &quot;@&quot; is present, the numeric value on the left-hand
side will be considered as the value for a fixed parameter. If it is a matrix of numeric values, there are
no free parameters in the output matrix. 
</p>


<h3>Value</h3>

<p>A <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> object with the same
dimensions as <code>x</code>
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code>,
<code><a href="#topic+create.mxMatrix">create.mxMatrix</a></code>,
<code><a href="#topic+create.Fmatrix">create.Fmatrix</a></code>,
<code><a href="#topic+checkRAM">checkRAM</a></code>,
<code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>,
<code><a href="#topic+as.symMatrix">as.symMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a and b are free parameters with starting values and labels
(a1 &lt;- matrix(c(1:4, "5*a", 6, "7*b", 8, 9), ncol=3, nrow=3))
#      [,1] [,2]  [,3] 
# [1,] "1"  "4"   "7*b"
# [2,] "2"  "5*a" "8"  
# [3,] "3"  "6"   "9"  

a1 &lt;- as.mxMatrix(a1)

## a and b are fixed parameters without any labels, name="new2"
(a2 &lt;- matrix(1:9, ncol=3, nrow=3))
#      [,1] [,2] [,3]
# [1,]    1    4    7
# [2,]    2    5    8
# [3,]    3    6    9

new2 &lt;- as.mxMatrix(a2, name="new2")

## Free parameters without starting values
(a3 &lt;- matrix(c(1:4, "*a", 6, "*b", 8, 9), ncol=3, nrow=3))
#      [,1] [,2] [,3]
# [1,] "1"  "4"  "*b"
# [2,] "2"  "*a" "8" 
# [3,] "3"  "6"  "9" 

a3 &lt;- as.mxMatrix(a3, lbound=0)

## A free parameter without label
(a4 &lt;- matrix(c(1:4, "5*", 6, "7*b", 8, 9), ncol=3, nrow=3))
#      [,1] [,2] [,3] 
# [1,] "1"  "4"  "7*b"
# [2,] "2"  "5*" "8"  
# [3,] "3"  "6"  "9"  

a4 &lt;- as.mxMatrix(a4)

## Convert a scalar into mxMatrix object
## "name" is required as "3*a" is not a valid name.
(a5 &lt;- as.mxMatrix("3*a", name="a5"))

## Free and fixed parameters
(a6 &lt;- matrix(c(1, "2*a", "3@b", 4), ncol=2, nrow=2))

as.mxMatrix(a6)
</code></pre>

<hr>
<h2 id='as.symMatrix'>Convert a Character Matrix with Starting Values to a Character Matrix
without Starting Values
</h2><span id='topic+as.symMatrix'></span>

<h3>Description</h3>

<p>It converts a character matrix with starting values to a
character matrix without the starting values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.symMatrix(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.symMatrix_+3A_x">x</code></td>
<td>
<p>A character or numeric matrix or a list of character or
numeric matrices.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are non-numeric values in <code>x</code>, they are treated
as the labels of the free parameters. If a &quot;*&quot; is
present, the numeric value on the left-hand side will be treated as
the starting value for a free parameter or a fixed value for a fixed parameter. If it is a matrix of numeric values, there are
no free parameters in the output matrix. This function removes the
starting values and &quot;*&quot; in the matrices. 
</p>


<h3>Value</h3>

<p>A character matrix.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a and b are free parameters with starting values and labels
(a1 &lt;- matrix(c(1:4, "5*a", 6, "7*b", 8, 9), ncol=3, nrow=3))
#      [,1] [,2]  [,3] 
# [1,] "1"  "4"   "7*b"
# [2,] "2"  "5*a" "8"  
# [3,] "3"  "6"   "9"  

(as.symMatrix(a1))
#      [,1] [,2] [,3]
# [1,] "1"  "4"  "b" 
# [2,] "2"  "a"  "8" 
# [3,] "3"  "6"  "9"
</code></pre>

<hr>
<h2 id='asyCov'>Compute Asymptotic Covariance Matrix of a Correlation/Covariance Matrix
</h2><span id='topic+asyCov'></span><span id='topic+asyCovOld'></span>

<h3>Description</h3>

<p>It computes the asymptotic sampling covariance matrix of a
correlation/covariance matrix under the assumption of multivariate normality. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asyCov(x, n, cor.analysis = TRUE, as.matrix = TRUE,
       acov=c("weighted", "individual", "unweighted"), ...)
asyCovOld(x, n, cor.analysis = TRUE, dropNA = FALSE, as.matrix = TRUE,
       acov=c("individual", "unweighted", "weighted"),
       suppressWarnings = TRUE,  silent = TRUE, run = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asyCov_+3A_x">x</code></td>
<td>
<p>A correlation/covariance matrix or a list of
correlation/covariance matrices. <code>NA</code> on the variables or other
values defined in <code>na.strings</code> will be removed before the
analysis. Note that it only checks the diagonal elements of
the matrices. If there are missing values, make sure that the
diagonals are coded with <code>NA</code> or values defined in <code>na.strings</code>.
</p>
</td></tr>
<tr><td><code id="asyCov_+3A_n">n</code></td>
<td>
<p>Sample size or a vector of sample sizes</p>
</td></tr>
<tr><td><code id="asyCov_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Logical. The output is either a correlation or
covariance matrix.</p>
</td></tr>
<tr><td><code id="asyCov_+3A_dropna">dropNA</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, the resultant dimensions
will be reduced by dropping the missing variables. If it is
<code>FALSE</code>, the resultant dimensions are the same as the input by
keeping the missing variables. </p>
</td></tr>
<tr><td><code id="asyCov_+3A_as.matrix">as.matrix</code></td>
<td>
<p>Logical. If it is <code>TRUE</code> and <code>x</code> is a list of correlation/covariance
matrices with the same dimensions, the asymptotic covariance
matrices will be column vectorized and stacked together. If it is
<code>FALSE</code>, the output will be a list of asymptotic covariance
matrices. Note that if it is <code>TRUE</code>, <code>dropNA</code> will be
<code>FALSE</code> automatically. This option is useful when passing the
asymptotic covariance matrices to <code><a href="#topic+meta">meta</a></code> </p>
</td></tr>
<tr><td><code id="asyCov_+3A_acov">acov</code></td>
<td>
<p>If it is <code>individual</code> (the default), the sampling variance-covariance
matrices are calculated based on the individual correlation/covariance
matrix. If it is either <code>unweighted</code> or <code>weighted</code>, the average
correlation/covariance matrix is calculated based on the unweighted
or weighted mean with the sample sizes. The average
correlation/covariance matrix is used to calculate the sampling
variance-covariance matrices.</p>
</td></tr>
<tr><td><code id="asyCov_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="asyCov_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="asyCov_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr>
<tr><td><code id="asyCov_+3A_...">...</code></td>
<td>
<p>It is ignored in <code>asyCov</code>. The additional arguments
will be passed to
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code> in <code>asyCovOld</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An asymptotic covariance matrix of the vectorized
correlation/covariance matrix or a list of these matrices. If
<code>as.matrix</code>=<code>TRUE</code> and <code>x</code> is a list of matrices, the output
is a stacked matrix. </p>


<h3>Note</h3>

<p>Before 1.2.6, <code>asyCov</code> used an SEM approach based on Cheung
and Chan (2004). After 1.2.6, <code>asyCov</code> was rewritten based on
Olkin and Siotani (1976) for correlation matrix and Yuan and Bentler
(2007, p. 371) for covariance matrix. Arguments such as <code>dropNA</code>,
<code>suppressWarnings</code>, <code>silent</code>, and <code>run</code> were
dropped. The original version was renamed to <code>asyCovOld</code> for
compatibility.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L., &amp; Chan, W. (2004). Testing dependent correlation
coefficients via structural equation modeling. <em>Organizational
Research Methods</em>, <b>7</b>, 206-223.
</p>
<p>Olkin, I., &amp; Siotani, M. (1976). Asymptotic distribution of functions of a correlation matrix. In S. Ideka (Ed.), <em>Essays in probability and statistics</em> (pp. 235-251). Shinko Tsusho.
</p>
<p>Yuan, K.-H., &amp; Bentler, P. M. (2007). Robust procedures in structural equation modeling. In S.-Y. Lee (Ed.), <em>Handbook of Latent Variable and Related Models</em> (pp. 367-397). Elsevier/North-Holland.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
C1 &lt;- matrix(c(1,0.5,0.4,0.5,1,0.2,0.4,0.2,1), ncol=3)  
asyCov(C1, n=100)

## Data with missing values
C2 &lt;- matrix(c(1,0.4,NA,0.4,1,NA,NA,NA,NA), ncol=3)  
C3 &lt;- matrix(c(1,0.2,0.2,1), ncol=2)

## Output is a stacked matrix of asymptotic covariance matrices
asyCov(list(C1,C2), n=c(100,50), as.matrix=TRUE)

## Output is a stacked matrix of asymptotic covariance matrices
asyCov(list(C3,C3), n=c(100,50), as.matrix=TRUE)

## Output is a list of asymptotic covariance matrices using the old version
asyCovOld(list(C1,C2,C3), n=c(100,50,50), dropNA=TRUE, as.matrix=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='BCG'>Dataset on the Effectiveness of the BCG Vaccine for Preventing Tuberculosis
</h2><span id='topic+BCG'></span>

<h3>Description</h3>

<p>This dataset includes 13 studies on the effectiveness of the
Bacillus Calmette-Guerin (BCG) vaccine for preventing tuberculosis
(see van Houwelingen, Arends, &amp; Stijnen (2002) for details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BCG)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>Trial</dt><dd><p>Number of the trials</p>
</dd>
<dt>Author</dt><dd><p>Authors of the original studies</p>
</dd>
<dt>Year</dt><dd><p>Year of publication</p>
</dd>
<dt>VD</dt><dd><p>Vaccinated group with disease</p>
</dd>
<dt>VWD</dt><dd><p>Vaccinated group without the disease</p>
</dd>
<dt>NVD</dt><dd><p>Not vaccinated group with disease</p>
</dd>
<dt>NVWD</dt><dd><p>Not vaccinated group without the disease</p>
</dd>
<dt>Latitude</dt><dd><p>Geographic latitude of the place where the study was done</p>
</dd>
<dt>Allocation</dt><dd><p>Method of treatment allocation</p>
</dd>
<dt>ln_OR</dt><dd><p>Natural logarithm of the odds ratio: log((VD/VWD)/(NVD/NVWD))</p>
</dd> 
<dt>v_ln_OR</dt><dd><p>Sampling variance of ln_OR: 1/VD+1/VWD+1/NVD+1/NVWD</p>
</dd>
<dt>ln_Odd_V</dt><dd><p>Natural logarithm of the odds of the vaccinated group:
log(VD/VWD)</p>
</dd>
<dt>ln_Odd_NV</dt><dd><p>Natural logarithm of the odds of the not vaccinated group: log(NVD/NVWD)</p>
</dd>  
<dt>v_ln_Odd_V</dt><dd><p>Sampling variance of ln_Odd_V: 1/VD+1/VWD</p>
</dd>
<dt>cov_V_NV</dt><dd><p>Sampling covariance between ln_Odd_V and ln_Odd_NV: It
is always 0</p>
</dd>
<dt>v_ln_Odd_NV</dt><dd><p>Sampling variance of ln_Odd_NV: 1/NVD+1/NVWD</p>
</dd>  
</dl>



<h3>Source</h3>

<p>Colditz, G. A., Brewer, T. F., Berkey, C. S., Wilson, M. E., Burdick, E., Fineberg, H. V., &amp; Mosteller, F. (1994). Efficacy of BCG vaccine in the prevention of tuberculosis: Meta-analysis of the published literature. <em>Journal of the American Medical Association</em>, <b>271</b>, 698&ndash;702.
</p>


<h3>References</h3>

<p>Berkey, C. S., Hoaglin, D. C., Mosteller, F., &amp; Colditz, G. A. (1995). A random-effects regression model for meta-analysis. <em>Statistics in Medicine</em>, <b>14</b>, 395&ndash;411.
</p>
<p>van Houwelingen, H. C., Arends, L. R., &amp; Stijnen, T. (2002). Advanced methods in meta-analysis: Multivariate approach and meta-regression. <em>Statistics in Medicine</em>, <b>21</b>, 589&ndash;624.
</p>
<p>Viechtbauer, W. (2010). Conducting meta-analyses in R with the metafor package. <em>Journal of Statistical Software</em>, <b>36</b>(3), 1&ndash;48. <a href="https://www.jstatsoft.org/v36/i03/">https://www.jstatsoft.org/v36/i03/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BCG)

## Univariate meta-analysis on the log of the odds ratio
summary( meta(y=ln_OR, v=v_ln_OR, data=BCG,
              x=cbind(scale(Latitude,scale=FALSE),
              scale(Year,scale=FALSE))) )

## Multivariate meta-analysis on the log of the odds
## The conditional sampling covariance is 0
bcg &lt;- meta(y=cbind(ln_Odd_V, ln_Odd_NV), data=BCG,
            v=cbind(v_ln_Odd_V, cov_V_NV, v_ln_Odd_NV))
summary(bcg)

plot(bcg)
</code></pre>

<hr>
<h2 id='bdiagMat'>Create a Block Diagonal Matrix
</h2><span id='topic+bdiagMat'></span>

<h3>Description</h3>

<p>It creates a block diagonal matrix from a list of numeric
or character matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdiagMat(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdiagMat_+3A_x">x</code></td>
<td>
<p>A list of numeric or character matrices (or values)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric or character block diagonal matrix





</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>It was based on a function posted by Scott Chasalow at http://www.math.yorku.ca/Who/Faculty/Monette/pub/stmp/0827.html.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+bdiagRep">bdiagRep</a></code>, <code><a href="#topic+matrix2bdiag">matrix2bdiag</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Block diagonal matrix of numbers
bdiagMat( list(matrix(1:4,nrow=2,ncol=2),
               matrix(5:6,nrow=1,ncol=2)) )
#      [,1] [,2] [,3] [,4]
# [1,]    1    3    0    0
# [2,]    2    4    0    0
# [3,]    0    0    5    6

## Block diagonal matrix of characters
bdiagMat( list(matrix(letters[1:4],nrow=2,ncol=2),
               matrix(letters[5:6],nrow=1,ncol=2)) )
#      [,1] [,2] [,3] [,4]
# [1,] "a"  "c"  "0"  "0" 
# [2,] "b"  "d"  "0"  "0" 
# [3,] "0"  "0"  "e"  "f" 
</code></pre>

<hr>
<h2 id='bdiagRep'>Create a Block Diagonal Matrix by Repeating the Input
</h2><span id='topic+bdiagRep'></span>

<h3>Description</h3>

<p>It creates a block diagonal matrix by repeating the input
matrix several times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdiagRep(x, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdiagRep_+3A_x">x</code></td>
<td>
<p>A numeric or character matrix (or values)
</p>
</td></tr>
<tr><td><code id="bdiagRep_+3A_times">times</code></td>
<td>
<p>Number of times of <code>x</code> to be repeated

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric or character block diagonal matrix





</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bdiagMat">bdiagMat</a></code>, <code><a href="#topic+matrix2bdiag">matrix2bdiag</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Block diagonal matrix of numerics
bdiagRep( matrix(1:4,nrow=2,ncol=2), 2 )
#      [,1] [,2] [,3] [,4]
# [1,]    1    3    0    0
# [2,]    2    4    0    0
# [3,]    0    0    1    3
# [4,]    0    0    2    4

## Block diagonal matrix of characters
bdiagRep( matrix(letters[1:4],nrow=2,ncol=2), 2 )
#      [,1] [,2] [,3] [,4]
# [1,] "a"  "c"  "0"  "0" 
# [2,] "b"  "d"  "0"  "0" 
# [3,] "0"  "0"  "a"  "c" 
# [4,] "0"  "0"  "b"  "d" 
</code></pre>

<hr>
<h2 id='Becker09'>Ten Studies of Correlation Matrices used by Becker (2009)
</h2><span id='topic+Becker09'></span>

<h3>Description</h3>

<p>This dataset includes ten studies on the relationships between CSAI
subscales and sports behavior. The original data were used in Craft et
al. (2003), whereas a subset of them was illustrated in Becker (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Becker09")</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 4x4 correlation matrices. The
variables are <em>Performance</em>, <em>Cognitive</em>, <em>Somatic</em>,
and <em>Self_confidence</em></p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>Type_of_sport</dt><dd><p>Samples based on <em>Individual</em> or <em>Team</em></p>
</dd>
</dl>



<h3>Source</h3>

<p>Craft, L. L., Magyar, T. M., Becker, B. J., &amp; Feltz, D. L. (2003). The relationship between the Competitive State Anxiety Inventory-2 and sport performance: a meta-analysis. <em>Journal of Sport and Exercise Psychology</em>, <b>25(1)</b>, 44-65.
</p>


<h3>References</h3>

<p>Becker, B. J. (2009). Model-based meta-analysis. In H. Cooper, L. V. Hedges, &amp; J. C. Valentine (Eds.), <em>The handbook of research synthesis and meta-analysis</em> (2nd ed., pp. 377-395). New York: Russell Sage Foundation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Becker09)

#### Fixed-effects model
## First stage analysis
fixed1 &lt;- tssem1(Becker09$data, Becker09$n, method="FEM")
summary(fixed1)

## Prepare a regression model using create.mxMatrix()
A1 &lt;- create.mxMatrix(c(0, "0.1*Cog2Per", "0.1*SO2Per", "0.1*SC2Per",
                        0, 0, 0, 0,
                        0, 0, 0, 0,
                        0, "0.1*Cog2SC", "0.1*SO2SC",0),
                      type="Full", byrow=TRUE, ncol=4, nrow=4,
                      as.mxMatrix=FALSE)

## This step is not necessary but it is useful for inspecting the model.
dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c("Performance", "Cognitive",
                                            "Somatic", "Self_confidence")

## Display A1
A1

S1 &lt;- create.mxMatrix(c("0.1*var_Per",
                        0, 1,
                        0, "0.1*cor", 1,
                        0, 0, 0, "0.1*var_SC"), byrow=TRUE, type="Symm",
                      as.mxMatrix=FALSE)

## This step is not necessary but it is useful for inspecting the model.
dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c("Performance", "Cognitive",
                                            "Somatic", "Self_confidence")

## Display S1
S1

################################################################################
## Alternative model specification in lavaan model syntax
model &lt;- "## Regression paths
          Performance ~ Cog2Per*Cognitive + SO2Per*Somatic + SC2Per*Self_confidence
          Self_confidence ~ Cog2SC*Cognitive + SO2SC*Somatic
          ## Fix the variances of Cog and SO at 1
          Cognitive ~~ 1*Cognitive
          Somatic ~~ 1*Somatic
          ## Label the correlation between Cog and SO
          Cognitive ~~ cor*Somatic
          ## Label the error variances of Per and SC
          Performance ~~ var_Per*Performance
          Self_confidence ~~ var_SC*Self_confidence"

## Display the model
plot(model, layout="spring")

RAM &lt;- lavaan2RAM(model, obs.variables=c("Performance", "Cognitive",
                                         "Somatic", "Self_confidence"))
RAM

A1 &lt;- RAM$A
S1 &lt;- RAM$S
################################################################################

## Second stage analysis
fixed2 &lt;- tssem2(fixed1, Amatrix=A1, Smatrix=S1, diag.constraints=TRUE,
                 intervals.type="LB", model.name="TSSEM2 Becker09",
                 mx.algebras=list( Cog=mxAlgebra(Cog2SC*SC2Per, name="Cog"),
                                   SO=mxAlgebra(SO2SC*SC2Per, name="SO"),
                                   Cog_SO=mxAlgebra(Cog2SC*SC2Per+SO2SC*SC2Per,
                                   name="Cog_SO")) )
summary(fixed2)

## Display the model with the parameter estimates
plot(fixed2, layout="spring")

#### Fixed-effects model: with type of sport as cluster
## First stage analysis
cluster1 &lt;- tssem1(Becker09$data, Becker09$n, method="FEM",
                   cluster=Becker09$Type_of_sport)
summary(cluster1)

## Second stage analysis
cluster2 &lt;- tssem2(cluster1, Amatrix=A1, Smatrix=S1, diag.constraints=TRUE,
                 intervals.type="LB", model.name="TSSEM2 Becker09",
                 mx.algebras=list( Cog=mxAlgebra(Cog2SC*SC2Per, name="Cog"),
                                   SO=mxAlgebra(SO2SC*SC2Per, name="SO"),
                                   Cog_SO=mxAlgebra(Cog2SC*SC2Per+SO2SC*SC2Per,
                                   name="Cog_SO")) )
summary(cluster2)

## Convert the model to semPlotModel object with 2 plots
## Use the short forms of the variable names
my.plots &lt;- lapply(X=cluster2, FUN=meta2semPlot, manNames=c("Per","Cog","SO","SC") )

## Load the library
library("semPlot")

## Setup two plots
layout(t(1:2))
## The labels are overlapped. We may modify it by using layout="spring"
semPaths(my.plots[[1]], whatLabels="est", nCharNodes=10, color="orange",
         layout="spring", edge.label.cex=0.8)
title("Individual sport")
semPaths(my.plots[[2]], whatLabels="est", nCharNodes=10, color="skyblue",
         layout="spring", edge.label.cex=0.8)
title("Team sport")


#### Random-effects model
## First stage analysis
random1 &lt;- tssem1(Becker09$data, Becker09$n, method="REM", RE.type="Diag")
summary(random1)

## Second stage analysis
random2 &lt;- tssem2(random1, Amatrix=A1, Smatrix=S1, diag.constraints=TRUE,
                  intervals.type="LB", model.name="TSSEM2 Becker09",
                  mx.algebras=list( Cog=mxAlgebra(Cog2SC*SC2Per, name="Cog"),
                                    SO=mxAlgebra(SO2SC*SC2Per, name="SO"),
                                    Cog_SO=mxAlgebra(Cog2SC*SC2Per+SO2SC*SC2Per,
                                    name="Cog_SO")) )
summary(random2)

## Display the model
plot(random2, what="path", layout="spring")

## Display the model with the parameter estimates
plot(random2, layout="spring", color="yellow")

#### Univariate r approach
#### First stage of the analysis
uni1 &lt;- uniR1(Becker09$data, Becker09$n)
uni1

#### Second stage of analysis using OpenMx
model2 &lt;- "## Regression paths
           Performance ~ Cog2Per*Cognitive + SO2Per*Somatic + SC2Per*Self_confidence
           Self_confidence ~ Cog2SC*Cognitive + SO2SC*Somatic
           ## Provide starting values for Cog and SO
           Cognitive ~~ start(1)*Cognitive
           Somatic ~~ start(1)*Somatic
           ## Label the correlation between Cog and SO
           Cognitive ~~ cor*Somatic
           ## Label the error variances of Per and SC
           Performance ~~ var_Per*Performance
           Self_confidence ~~ var_SC*Self_confidence"

RAM2 &lt;- lavaan2RAM(model2, obs.variables=c("Performance", "Cognitive",
                                           "Somatic", "Self_confidence"))
RAM2

uni2mx &lt;- uniR2mx(uni1, RAM=RAM2)
summary(uni2mx)

#### Second stage of analysis Using lavaan
model3 &lt;- "## Regression paths
           Performance ~ Cognitive + Somatic + Self_confidence
           Self_confidence ~ Cognitive + Somatic"

uni2lavaan &lt;- uniR2lavaan(uni1, model3)
lavaan::summary(uni2lavaan)

## End(Not run)
</code></pre>

<hr>
<h2 id='Becker83'>Studies on Sex Differences in Conformity Reported by Becker (1983)
</h2><span id='topic+Becker83'></span>

<h3>Description</h3>

<p>The data set includes studies on sex differences in conformity using the fictitious norm group
paradigm reported by Becker (1983).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Becker83)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>study</dt><dd><p>study number</p>
</dd>
<dt>di</dt><dd><p>Standardized mean difference</p>
</dd>
<dt>vi</dt><dd><p>Sampling variance of the effect size</p>
</dd>
<dt>percentage</dt><dd><p>Percentage of male authors</p>
</dd>
<dt>items</dt><dd><p>Number of items</p>
</dd>
</dl>



<h3>Source</h3>

<p>Becker, B. J. (1983, April). Influence again: A comparison of methods
for meta-analysis. <em>Paper presented at the annual meeting of the
American Educational Research Association, Montreal.</em>
</p>
<p>Hedges, L. V., &amp; Olkin, I. (1985). <em>Statistical methods for meta-analysis.</em> Orlando, FL: Academic Press. 
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2010). Fixed-effects meta-analyses as multiple-group structural equation models. <em>Structural Equation Modeling</em>, <b>17</b>, 481-509.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Becker83)

## Random-effects meta-analysis
summary( meta(y=di, v=vi, data=Becker83) )

## Mixed-effects meta-analysis with log(items) as the predictor
summary( meta(y=di, v=vi, x=log(items), data=Becker83) )
</code></pre>

<hr>
<h2 id='Becker92'>Six Studies of Correlation Matrices reported by Becker (1992; 1995)</h2><span id='topic+Becker92'></span>

<h3>Description</h3>

<p>This data set includes six studies of correlation matrices reported by Becker (1992; 1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Becker92)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 6 studies of correlation matrices. The
variables are <em>Math</em> (math aptitude), <em>Spatial</em> (spatial
ability), and <em>Verbal</em> (verbal ability)</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Becker, B. J. (1992). Using results from replicated studies to estimate linear models. <em>Journal of Educational Statistics</em>, <b>17(4)</b>, 341-362. doi:10.3102/10769986017004341
</p>
<p>Becker, B. J. (1995). Corrections to &quot;Using Results from Replicated Studies to Estimate Linear Models.&quot; <em>Journal of Educational and Behavioral Statistics</em>, <b>20(1)</b>, 100-102. doi:10.2307/1165390
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Becker92)

#### Fixed-effects model
## First stage analysis
## Replicate Becker's (1992) analysis using 4 studies only

fixed1 &lt;- tssem1(Becker92$data[1:4], Becker92$n[1:4], method="FEM")
summary(fixed1)

## ## Prepare a regression model using create.mxMatrix()
## A1 &lt;- create.mxMatrix(c(0,0,0,"0.2*Spatial2Math",
##                         0,0,"0.2*Verbal2Math",0,0), type="Full",
##                         ncol=3, nrow=3, as.mxMatrix=FALSE)

## var.names &lt;- c("Math_aptitude","Spatial","Verbal") 

## ## This step is not necessary but it is useful for inspecting the model.
## dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- var.names

## ## Display A1
## A1

## S1 &lt;- create.mxMatrix(c("0.2*ErrorVarMath",0,0,1,"0.2*CorSpatialVerbal",1),
##                         type="Symm", as.mxMatrix=FALSE)

## ## This step is not necessary but it is useful for inspecting the model.
## dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- var.names

## ## Display S1
## S1

################################################################################
## Alternative model specification in lavaan model syntax
model &lt;- "## Regression paths
          Math ~ Spatial2Math*Spatial + Verbal2Math*Verbal
          Spatial ~~ CorSpatialVerbal*Verbal
          ## Fix the variances of Spatial and Verbal at 1
          Spatial ~~ 1*Spatial
          Verbal ~~ 1*Verbal
          ## Label the error variance of Math
          Math ~~ ErrorVarMath*Math + start(0.2)*Math"

## Display the model
plot(model)

RAM &lt;- lavaan2RAM(model, obs.variables=c("Math", "Spatial", "Verbal"))
RAM

################################################################################

## Fixed-effects model: Second stage analysis
## Two equivalent versions to calculate the R2 and its 95% LBCI
fixed2 &lt;- tssem2(fixed1, RAM=RAM, intervals.type="LB",
                 mx.algebras=list(R1=mxAlgebra(Spatial2Math^2+Verbal2Math^2
                        +2*CorSpatialVerbal*Spatial2Math*Verbal2Math, name="R1"),
                        R2=mxAlgebra(One-Smatrix[1,1], name="R2"),
                        One=mxMatrix("Iden", ncol=1, nrow=1, name="One")))
summary(fixed2)

## Display the model with the parameter estimates
plot(fixed2)

#### Random-effects model
## First stage analysis
## No random effects for off-diagonal elements
random1 &lt;- tssem1(Becker92$data, Becker92$n, method="REM", RE.type="Diag")
summary(random1)

## Random-effects model: Second stage analysis
random2 &lt;- tssem2(random1, RAM=RAM)
summary(random2)

## Display the model with the parameter estimates
plot(random2, color="yellow")

#### Similar to conventional fixed-effects GLS approach
## First stage analysis
## No random effects
## Replicate Becker's (1992) analysis using 4 studies only
gls1 &lt;- tssem1(Becker92$data[1:4], Becker92$n[1:4], method="REM", RE.type="Zero",
               model.name="Fixed effects GLS Stage 1")
summary(gls1)

## Fixed-effects GLS model: Second stage analysis
gls2 &lt;- tssem2(gls1, RAM=RAM, model.name="Fixed effects GLS Stage 2")
summary(gls2)

## End(Not run)
</code></pre>

<hr>
<h2 id='Becker94'>Five Studies of Ten Correlation Matrices reported by Becker and
Schram (1994)
</h2><span id='topic+Becker94'></span>

<h3>Description</h3>

<p>This data set includes five studies of ten correlation matrices
reported by Becker and Schram (1994). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Becker94)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 10 correlation matrices. The
variables are <em>Math</em> (math aptitude), <em>Spatial</em> (spatial
ability), and <em>Verbal</em> (verbal ability)</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>gender</dt><dd><p><em>Females</em> or <em>Males</em> samples</p>
</dd>
</dl>



<h3>Source</h3>

<p>Becker, B. J., &amp; Schram, C. M. (1994). Examining explanatory models through research synthesis. In H. Cooper &amp; L. V. Hedges (Eds.), <em>The handbook of research synthesis</em> (pp. 357-381). New York: Russell Sage Foundation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Becker94)

#### Fixed-effects model
## First stage analysis
fixed1 &lt;- tssem1(Becker94$data, Becker94$n, method="FEM")
summary(fixed1)

## Prepare a regression model using create.mxMatrix()
## A1 &lt;- create.mxMatrix(c(0,0,0,"0.2*Spatial2Math",
##                         0,0,"0.2*Verbal2Math",0,0), type="Full",
##                       ncol=3, nrow=3, name="A1")
## S1 &lt;- create.mxMatrix(c("0.2*ErrorVarMath",0,0,1,
##                         "0.2*CorBetweenSpatialVerbal",1),
##                       type="Symm", name="S1")

## An alternative method to create a regression model with the lavaan syntax
model &lt;- "## Regression model
          Math ~ Spatial2Math*Spatial + Verbal2Math*Verbal
          ## Error variance of Math
          Math ~~ ErrorVarMath*Math
          ## Variances of Spatial and Verbal fixed at 1.0
          Spatial ~~ 1*Spatial
          Verbal ~~ 1*Verbal
          ## Correlation between Spatial and Verbal
          Spatial ~~ CorBetweenSpatialVerbal*Verbal"

## Display the model
plot(model)

RAM &lt;- lavaan2RAM(model, obs.variables=c("Math", "Spatial", "Verbal"))
RAM

## Second stage analysis
## A1 &lt;- RAM$A
## S1 &lt;- RAM$S
## fixed2 &lt;- tssem2(fixed1, Amatrix=A1, Smatrix=S1, intervals.type="LB")

fixed2 &lt;- tssem2(fixed1, RAM=RAM, intervals.type="LB")
summary(fixed2)

## Display the model with the parameter estimates
plot(fixed2)
    
#### Fixed-effects model: with gender as cluster
## First stage analysis
cluster1 &lt;- tssem1(Becker94$data, Becker94$n, method="FEM", cluster=Becker94$gender)
summary(cluster1)

## Second stage analysis  
cluster2 &lt;- tssem2(cluster1, RAM=RAM, intervals.type="LB")
summary(cluster2)

#### Conventional fixed-effects GLS approach
## First stage analysis
## No random effects
## Replicate Becker's (1992) analysis using 4 studies only
gls1 &lt;- tssem1(Becker92$data[1:4], Becker92$n[1:4], method="REM", RE.type="Zero",
               model.name="Fixed effects GLS Stage 1")
summary(gls1)

## Fixed-effects GLS model: Second stage analysis
gls2 &lt;- tssem2(gls1, RAM=RAM, intervals.type="LB",
               model.name="Fixed effects GLS Stage 2")
summary(gls2)

## End(Not run)
</code></pre>

<hr>
<h2 id='Berkey98'>Five Published Trails from Berkey et al. (1998)</h2><span id='topic+Berkey98'></span>

<h3>Description</h3>

<p>The data set includes five published trials, reported by Berkey et al. (1998), comparing surgical and non-surgical treatments
for medium-severity periodontal disease, one year after treatment. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Berkey98)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>trial</dt><dd><p>Trial number</p>
</dd>
<dt>pub_year</dt><dd><p>Publication year</p>
</dd>
<dt>no_of_patients</dt><dd><p>Number of patients</p>
</dd>
<dt>PD</dt><dd><p>Patient improvements (mm) in <em>probing depth</em></p>
</dd>
<dt>AL</dt><dd><p>Patient improvements (mm) in <em>attachment level</em></p>
</dd>
<dt>var_PD</dt><dd><p>Sampling variance of PD</p>
</dd>
<dt>cov_PD_AL</dt><dd><p>Sampling covariance between PD and AD</p>
</dd>
<dt>var_AL</dt><dd><p>Sampling variance of AL</p>
</dd>
</dl>



<h3>Source</h3>

<p>Berkey, C. S., Hoaglin, D. C., Antczak-Bouckoms, A., Mosteller, F, &amp; Colditz, G. A. (1998). Meta-analysis of multiple outcomes by regression with random effects. <em>Statistics in Medicine</em>, <b>17</b>, 2537-2550.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Berkey98)

#### ML estimation method
## Multivariate meta-analysis
x &lt;- meta(y=cbind(PD, AL), v=cbind(var_PD, cov_PD_AL, var_AL), data=Berkey98)
x &lt;- rerun(x)
summary(x)
plot(x)

## Plot individual studies proportional to the weights
plot(x, study.weight.plot=TRUE)

## Include forest plot from the metafor package
library(metafor)
plot(x, diag.panel=TRUE, main="Multivariate meta-analysis",
     axis.label=c("PD", "AL"))
     forest( rma(yi=PD, vi=var_PD, data=Berkey98) )
     title("Forest plot of PD")
     forest( rma(yi=AL, vi=var_AL, data=Berkey98) )
     title("Forest plot of AL")

## Multivariate meta-analysis with "publication year-1979" as the predictor
summary( meta(y=cbind(PD, AL), v=cbind(var_PD, cov_PD_AL, var_AL),
              x=scale(pub_year, center=1979), data=Berkey98,
              RE.lbound=NA) )

## Multivariate meta-analysis with equality constraint on the regression coefficients
summary( meta(y=cbind(PD, AL), v=cbind(var_PD, cov_PD_AL, var_AL),
              x=scale(pub_year, center=1979), data=Berkey98,
              coef.constraints=matrix(c("0.3*Eq_slope", "0.3*Eq_slope"),
              nrow=2)) )

#### REML estimation method
## Multivariate meta-analysis
summary( reml(y=cbind(PD, AL), v=cbind(var_PD, cov_PD_AL, var_AL),
              data=Berkey98,
              model.name="Multivariate meta analysis with REML") )

## Multivariate meta-analysis with "publication year-1979" as the predictor
## Diagonal structure for the variance component
summary( reml(y=cbind(PD, AL), v=cbind(var_PD, cov_PD_AL, var_AL),
              RE.constraints=Diag(c("1e-5*Tau2_1_1", "1e-5*Tau2_2_2")),
              x=scale(pub_year, center=1979), data=Berkey98) )

## End(Not run)
</code></pre>

<hr>
<h2 id='Boer16'>Correlation Matrices from Boer et al. (2016)</h2><span id='topic+Boer16'></span>

<h3>Description</h3>

<p>The data set includes correlation matrices of leader-member exchange in
transformational leadership reported by Boer et al. (2016). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Boer16)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of correlation matrices. The variables are
<em>LMX</em> (leader-member exchange), <em>TFL</em>
(transformational leadership), <em>JS</em> (job satisfaction),
<em>OC</em> (organizational commitment), and <em>LE</em> (leader
effectiveness)</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>RelLMX</dt><dd><p>The reliability of <em>LMX</em></p>
</dd>
<dt>RelTFL</dt><dd><p>The reliability of <em>TFL</em></p>
</dd>
</dl>



<h3>Source</h3>

<p>Boer, D., Deinert, A., Homan, A. C., &amp; Voelpel, S. C. (2016). Revisiting the mediating role of leader-member exchange in transformational leadership: the differential impact model. <em>European Journal of Work and Organizational Psychology</em>, <b>25</b>(6), 883-899.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Stage 1 analysis
rand1 &lt;- tssem1(Boer16$data, Boer16$n, method="REM", RE.type="Diag",
                acov="weighted")
summary(rand1)

## Stage 2 analysis
model2a &lt;- 'JS+OC+LE ~ LMX+TFL
            LMX ~ TFL
            ## Variance of TFL is fixed at 1
            TFL ~~ 1*TFL
            ## Correlated residuals
            JS ~~ OC
            JS ~~ LE
            OC ~~ LE'

## Display the model
plot(model2a)    
    
RAM2a &lt;- lavaan2RAM(model2a, obs.variables = c("LMX", "TFL", "JS", "OC", "LE"),
                    A.notation="on", S.notation="with")

rand2a &lt;- tssem2(rand1, Amatrix=RAM2a$A, Smatrix=RAM2a$S)
summary(rand2a)

## Display the model with the parameter estimates
plot(rand2a, layout="spring")    

## End(Not run)
</code></pre>

<hr>
<h2 id='bootuniR1'>Parametric bootstrap on the univariate R (uniR) object
</h2><span id='topic+bootuniR1'></span>

<h3>Description</h3>

<p>It generates correlation matrices with the parametric bootstrap on the univariate R
(uniR) object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootuniR1(x, Rep, nonPD.pop=c("replace", "nearPD", "accept"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootuniR1_+3A_x">x</code></td>
<td>
<p>An object of class 'uniR1'</p>
</td></tr>
<tr><td><code id="bootuniR1_+3A_rep">Rep</code></td>
<td>
<p>Number of replications of the parametric bootstrap</p>
</td></tr>
<tr><td><code id="bootuniR1_+3A_nonpd.pop">nonPD.pop</code></td>
<td>
<p>If it is <code>replace</code>, generated non-positive
definite matrices are replaced by generated new ones which are
positive definite. If it is <code>nearPD</code>, they are replaced by
nearly positive definite matrices by calling
<code>Matrix::nearPD()</code>. If it is <code>accept</code>, they are accepted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the parametric bootstrap approach suggested
by Yu et al. (2016). It is included in this package for research
interests. Please refer to Cheung (2018) for the issues associated
with this parametric bootstrap approach.
</p>


<h3>Value</h3>

<p>An object of the generated correlation matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2018). Issues in solving the problem of effect size
heterogeneity in meta-analytic structural equation modeling: A
commentary and simulation study on Yu, Downes, Carter, and O'Boyle
(2016). <em>Journal of Applied Psychology</em>, <b>103</b>, 787-803.
</p>
<p>Yu, J. (Joya), Downes, P. E., Carter, K. M., &amp; O'Boyle,
E. H. (2016). The problem of effect size heterogeneity 
in meta-analytic structural equation modeling.
<em>Journal of Applied Psychology</em>, <b>101</b>, 1457-1473. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rCor">rCor</a></code>, <code><a href="#topic+bootuniR2">bootuniR2</a></code>,
<code><a href="#topic+Nohe15">Nohe15</a></code>
</p>

<hr>
<h2 id='bootuniR2'>Fit Models on the bootstrapped correlation matrices
</h2><span id='topic+bootuniR2'></span>

<h3>Description</h3>

<p>It fits structural equation models on the bootstrapped
correlation matrices. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootuniR2(model, data, n, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootuniR2_+3A_model">model</code></td>
<td>
<p>A model in <code><a href="lavaan.html#topic+sem">sem</a></code> syntax.</p>
</td></tr>  
<tr><td><code id="bootuniR2_+3A_data">data</code></td>
<td>
<p>A list of correlation matrices.</p>
</td></tr>
<tr><td><code id="bootuniR2_+3A_n">n</code></td>
<td>
<p>Sample size in fitting the structural equation models</p>
</td></tr>  
<tr><td><code id="bootuniR2_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="lavaan.html#topic+sem">sem</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits the lavaan model with the bootstrapped correlation
matrices. It implements the parametric bootstrap approach suggested
by Yu et al. (2016). It is included in this package for research
interests. Please refer to Cheung (2018) for the issues associated
with this parametric bootstrap approach.
</p>


<h3>Value</h3>

<p>A list of the fitted object from <code><a href="lavaan.html#topic+sem">sem</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2018). Issues in solving the problem of effect size
heterogeneity in meta-analytic structural equation modeling: A
commentary and simulation study on Yu, Downes, Carter, and O'Boyle
(2016). <em>Journal of Applied Psychology</em>, <b>103</b>, 787-803.
</p>
<p>Yu, J. (Joya), Downes, P. E., Carter, K. M., &amp; O'Boyle,
E. H. (2016). The problem of effect size heterogeneity 
in meta-analytic structural equation modeling.
<em>Journal of Applied Psychology</em>, <b>101</b>, 1457-1473.   
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bootuniR2">bootuniR2</a></code>,
<code><a href="#topic+tssemParaVar">tssemParaVar</a></code>, <code><a href="#topic+Nohe15">Nohe15</a></code>
</p>

<hr>
<h2 id='Bornmann07'>A Dataset from Bornmann et al. (2007)</h2><span id='topic+Bornmann07'></span>

<h3>Description</h3>

<p>A dataset from Bornmann et al. (2007) for three-level meta-analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Bornmann07)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>ID</dt><dd><p>ID of the study</p>
</dd>
<dt>Study</dt><dd><p>Study name</p>
</dd>
<dt>Cluster</dt><dd><p>Cluster for effect sizes</p>
</dd>
<dt>logOR</dt><dd><p>Effect size: log odds ratio</p>
</dd>
<dt>v</dt><dd><p>Sampling variance of logOR</p>
</dd>
<dt>Year</dt><dd><p>Year of publication</p>
</dd>
<dt>Type</dt><dd><p>Type of proposal: either <b>Grant</b> or <b>Fellowship</b></p>
</dd>
<dt>Discipline</dt><dd><p>Discipline of the proposal: either <b>Physical sciences</b>, <b>Life sciences/biology</b>,
<b>Social sciences/humanities</b> or <b>Multidisciplinary</b>)</p>
</dd>
<dt>Country</dt><dd><p>Country of the proposal: either the <b>United States</b>,
<b>Canada</b>, <b>Australia</b>, <b>United Kingdom</b> or <b>Europe</b></p>
</dd>
</dl>



<h3>Source</h3>

<p>Bornmann, L., Mutz, R., &amp; Daniel, H.-D. (2007). Gender differences in grant peer review: A meta-analysis. <em>Journal of Informetrics</em>, <b>1(3)</b>, 226-238. doi:10.1016/j.joi.2007.03.001
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with three-level meta-analyses: A structural equation modeling approach. <em>Psychological Methods</em>, <b>19</b>, 211-229.
</p>
<p>Marsh, H. W., Bornmann, L., Mutz, R., Daniel, H.-D., &amp; O'Mara, A. (2009). Gender Effects in the Peer Reviews of Grant Proposals: A Comprehensive Meta-Analysis Comparing Traditional and Multilevel Approaches. <em>Review of Educational Research</em>, <b>79(3)</b>, 1290-1326. doi:10.3102/0034654309334143
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Bornmann07)

#### ML estimation method
## No predictor
summary( meta3L(y=logOR, v=v, cluster=Cluster, data=Bornmann07) )

## Type as a predictor
## Grant: 0
## Fellowship: 1
summary( meta3L(y=logOR, v=v, x=(as.numeric(Type)-1),
               cluster=Cluster, data=Bornmann07) )

## Centered Year as a predictor
summary( meta3L(y=logOR, v=v, x=scale(Year, scale=FALSE),
               cluster=Cluster, data=Bornmann07) )

#### REML estimation method
## No predictor
summary( reml3L(y=logOR, v=v, cluster=Cluster, data=Bornmann07) )

## Type as a predictor
## Grants: 0
## Fellowship: 1
summary( reml3L(y=logOR, v=v, x=(as.numeric(Type)-1),
                cluster=Cluster, data=Bornmann07) )

## Centered Year as a predictor
summary( reml3L(y=logOR, v=v, x=scale(Year, scale=FALSE),
                cluster=Cluster, data=Bornmann07) )

## Handling missing covariates with FIML
## MCAR
## Set seed for replication
set.seed(1000000)

## Copy Bornmann07 to my.df
my.df &lt;- Bornmann07
## "Fellowship": 1; "Grant": 0
my.df$Type_MCAR &lt;- ifelse(Bornmann07$Type=="Fellowship", yes=1, no=0)

## Create 17 out of 66 missingness with MCAR
my.df$Type_MCAR[sample(1:66, 17)] &lt;- NA
summary(meta3LFIML(y=logOR, v=v, cluster=Cluster, x2=Type_MCAR, data=my.df))

## MAR
Type_MAR &lt;- ifelse(Bornmann07$Type=="Fellowship", yes=1, no=0)

## Create 27 out of 66 missingness with MAR for cases Year&lt;1996
index_MAR &lt;- ifelse(Bornmann07$Year&lt;1996, yes=TRUE, no=FALSE)
Type_MAR[index_MAR] &lt;- NA

## Include auxiliary variable
summary(meta3LFIML(y=logOR, v=v, cluster=Cluster, x2=Type_MAR, av2=Year, data=my.df))

## End(Not run)
</code></pre>

<hr>
<h2 id='calEffSizes'>Calculate Effect Sizes using lavaan Models
</h2><span id='topic+calEffSizes'></span>

<h3>Description</h3>

<p>It calculates effect sizes with Delta Method by formulating the effect sizes
as functions of SEM in lavaan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calEffSizes(model, data=NULL, n, Cov, Mean=NULL, group=NULL, lavaan.output=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calEffSizes_+3A_model">model</code></td>
<td>
<p>A lavaan model. Effect sizes are defined as functions of
SEM parameters with <code>:=</code>.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_data">data</code></td>
<td>
<p>A data frame of the observed variables. If it is
<code>NULL</code>, summary statistics are required.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_n">n</code></td>
<td>
<p>Sample sizes</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_cov">Cov</code></td>
<td>
<p>A covariance matrix or a list of covariance matrices.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_mean">Mean</code></td>
<td>
<p>Optional sample means.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_group">group</code></td>
<td>
<p>A character of the variable name in the data frame defining the groups in a multiple group analysis.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_lavaan.output">lavaan.output</code></td>
<td>
<p>If <code>TRUE</code>, it returns the fitted object
instead of the effect sizes and their sampling covariance matrix.</p>
</td></tr>
<tr><td><code id="calEffSizes_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="lavaan.html#topic+sem">sem</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Effect sizes and their sampling covariance matrix or a lavaan
fitted object.
</p>


<h3>Note</h3>

<p>The input matrices are treated as covariance matrices unless there
are explicit constraints in the model.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation
modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L. (2018). Computing multivariate effect sizes and their sampling covariance matrices with structural equation modeling: Theory, examples, and computer simulations. <em>Frontiers in Psychology</em>, <b>9</b>(1387). https://doi.org/10.3389/fpsyg.2018.01387
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smdMES">smdMES</a></code>, <code><a href="#topic+smdMTS">smdMTS</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
## Select ATT, Bi, and BEH 
obs.vars &lt;- c("BEH", "BI", "ATT")

## Select one study from Cooke16 for illustration
my.cor &lt;- Cooke16$data[[4]][obs.vars, obs.vars]
my.n  &lt;- Cooke16$n[4]

## Effect sizes: indirect effect and direct effect
model &lt;- "BEH ~ c*ATT + b*BI
          BI ~ a*ATT
          ## Indirect effect
          Ind := a*b
          Dir := c"

calEffSizes(model=model, n=my.n, Cov=my.cor, lavaan.output=FALSE)

## Return the lavaan fitted model
fit &lt;- calEffSizes(model=model, n=my.n, Cov=my.cor, lavaan.output=TRUE)
lavaan::summary(fit)
    
lavaan::parameterestimates(fit)  

## End(Not run)
</code></pre>

<hr>
<h2 id='checkRAM'>Check the correctness of the RAM formulation
</h2><span id='topic+checkRAM'></span>

<h3>Description</h3>

<p>It provides simple checks on the correctness of the RAM formulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkRAM(Amatrix, Smatrix, cor.analysis=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkRAM_+3A_amatrix">Amatrix</code></td>
<td>
<p>An asymmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="checkRAM_+3A_smatrix">Smatrix</code></td>
<td>
<p>A symmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="checkRAM_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Logical. Analysis of correlation or covariance
structure. There are additional checks for cor.analysis=<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns silently if no error has been detected; otherwise, it
returns a warning message.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>,
<code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
## Digman97 example
model1 &lt;- "## Factor loadings
           Alpha=~A+C+ES
           Beta=~E+I
           ## Factor correlation
           Alpha~~Beta"

RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("A","C","ES","E","I"),
                   A.notation="on", S.notation="with")
RAM1

## The model is okay.    
checkRAM(Amatrix=RAM1$A, Smatrix=RAM1$S)

## Hunter83 example    
model2 &lt;- "## Regression paths
           Job_knowledge ~ A2J*Ability
           Work_sample ~ A2W*Ability + J2W*Job_knowledge
           Supervisor ~ J2S*Job_knowledge + W2S*Work_sample

           ## Fix the variance of Ability at 1
           Ability ~~ 1*Ability

           ## Label the error variances of the dependent variables
           Job_knowledge ~~ VarE_J*Job_knowledge
           Work_sample ~~ VarE_W*Work_sample
           Supervisor ~~ VarE_S*Supervisor"

RAM2 &lt;- lavaan2RAM(model2, obs.variables=c("Ability","Job_knowledge",
                   "Work_sample","Supervisor"))

## The model is okay.     
checkRAM(Amatrix=RAM2$A, Smatrix=RAM2$S)   

## End(Not run)
</code></pre>

<hr>
<h2 id='Cheung00'>Fifty Studies of Correlation Matrices used in Cheung and Chan (2000)</h2><span id='topic+Cheung00'></span>

<h3>Description</h3>

<p>This data set includes fifty studies of correlation matrices on the theory
of planned theory reported by Cheung and Chan (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cheung00)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 50 studies of correlation matrices. The
variables are the attitude toward behavior <em>att</em>, subjective norm <em>sn</em>,
behavioral intention <em>bi</em>, and behavior <em>beh</em></p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Note</h3>

<p>These studies were extracted from the original data set for
illustration purpose. Some samples contained two or more correlation
matrices, and only one of them was arbitrarily selected to avoid the
problem of dependence. Moreover, studies with less than 3 correlation
coefficients were also excluded.
</p>


<h3>Source</h3>

<p>Cheung, S.-F., &amp; Chan, D. K.-S. (2000). The role of perceived behavioral control in predicting human behavior: A meta-analytic review of studies on the theory of planned behavior. <em>Unpublished manuscript</em>, Chinese University of Hong Kong.
</p>


<h3>References</h3>

<p>Cheung, M.W.-L., &amp; Cheung, S.-F. (2016). Random-effects models for
meta-analytic structural equation modeling: Review, issues, and
illustrations. <em>Research Synthesis Methods</em>, <b>7</b>, 140-155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Cheung00)

## Variable labels
labels &lt;- colnames(Cheung00$data[[1]])

## Full mediation model
S &lt;- create.mxMatrix(c("1", 
                       ".2*cov_att_sn", "1", 
                       0, 0, ".2*e_bi", 
                       0, 0, 0, ".2*e_beh"), 
                     type="Symm", as.mxMatrix=FALSE, byrow=TRUE)
dimnames(S) &lt;- list(labels, labels)
S

A &lt;- matrix(c("0","0","0","0",
              "0","0","0","0",
              ".2*att2bi", ".2*sn2bi", "0", "0",
              "0", "0", ".2*bi2beh", "0"),
            byrow=TRUE, 4, 4)
dimnames(A) &lt;- list(labels, labels)
A

#### Random-effects model

## Stage 1 analysis
random_1 &lt;- tssem1(Cheung00$data, Cheung00$n, method="REM", RE.type="Diag",
                   acov="weighted")
summary(random_1)

## Stage 2 analysis
random_2 &lt;- tssem2(random_1, Amatrix=A, Smatrix=S, intervals.type="LB",
                   diag.constraints=TRUE)
summary(random_2)

## Display the model
plot(random_2, what="path")

## Display the model with the parameter estimates
plot(random_2, color="yellow")

## Load the library
library("semPlot")

## End(Not run)
</code></pre>

<hr>
<h2 id='Cheung09'>A Dataset from TSSEM User's Guide Version 1.11 by Cheung (2009) 
</h2><span id='topic+Cheung09'></span>

<h3>Description</h3>

<p>Four studies were selected from the data set used by Cheung
and Chan (2005; 2009). Some variables were randomly deleted to
illustrate the analysis with missing data.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cheung09)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 4 studies of correlation matrices </p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cheung, M. W.-L. (2009). TSSEM: A LISREL syntax generator for two-stage structural equation modeling (Version 1.11) [Computer software]. Retrieved from <a href="http://courses.nus.edu.sg/course/psycwlm/internet/tssem.zip">http://courses.nus.edu.sg/course/psycwlm/internet/tssem.zip</a>.
</p>


<h3>References</h3>

<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation modeling: A two-stage approach. <em>Psychological Methods</em>, <b>10</b>, 40-64.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2009). A two-stage approach to synthesizing covariance matrices in meta-analytic structural equation modeling. <em>Structural Equation Modeling</em>, <b>16</b>, 28-53.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Cheung09)

#### Fixed-effects model: Stage 1 analysis
fixed1 &lt;- tssem1(Cheung09$data, Cheung09$n, method="FEM")
summary(fixed1)
  
## Prepare a model implied matrix
## Factor correlation matrix
Phi &lt;- create.mxMatrix( c("0.3*corf2f1","0.3*corf3f1","0.3*corf3f2"),
                        type="Stand", as.mxMatrix=FALSE )
## Error variances
Psi &lt;- create.mxMatrix( paste("0.2*e", 1:9, sep=""), type="Diag",
                        as.mxMatrix=FALSE )

## Create Smatrix
S1 &lt;- bdiagMat(list(Psi, Phi))
## dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c(paste("x",1:9,sep=""),
##                                             paste("f",1:3,sep=""))
## S1
S1 &lt;- as.mxMatrix(S1)

## Factor loadings
Lambda &lt;- create.mxMatrix( c(".3*f1x1",".3*f1x2",".3*f1x3",rep(0,9),
                             ".3*f2x4",".3*f2x5",".3*f2x6",".3*f2x7",
                             rep(0,9),".3*f3x8",".3*f3x9"), type="Full",
                             ncol=3, nrow=9, as.mxMatrix=FALSE )
Zero1 &lt;- matrix(0, nrow=9, ncol=9)
Zero2 &lt;- matrix(0, nrow=3, ncol=12)

## Create Amatrix
A1 &lt;- rbind( cbind(Zero1, Lambda),
             Zero2 )
## dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c(paste("x",1:9,sep=""),
##                                             paste("f",1:3,sep=""))
## A1
A1 &lt;- as.mxMatrix(A1)

## Create Fmatrix
F1 &lt;- create.Fmatrix(c(rep(1,9), rep(0,3)))
  
#### Fixed-effects model: Stage 2 analysis
fixed2 &lt;- tssem2(fixed1, Amatrix=A1, Smatrix=S1, Fmatrix=F1,
                 intervals.type="LB")
summary(fixed2)

## Display the model
plot(fixed2, what="path")

## Display the model with the parameter estimates
plot(fixed2, latNames=c("f1", "f2", "f3"), edge.label.cex=0.8,
     color="yellow")

## End(Not run)
</code></pre>

<hr>
<h2 id='coef'>Extract Parameter Estimates from various classes.
</h2><span id='topic+coef.tssem1FEM'></span><span id='topic+coef.tssem1FEM.cluster'></span><span id='topic+coef.tssem1REM'></span><span id='topic+coef.wls'></span><span id='topic+coef.wls.cluster'></span><span id='topic+coef.meta'></span><span id='topic+coef.meta3LFIML'></span><span id='topic+coef.reml'></span><span id='topic+coef.MxRAMModel'></span><span id='topic+coef.osmasem'></span>

<h3>Description</h3>

<p>It extracts the parameter estimates from objects of various
classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tssem1FEM'
coef(object, ...)
## S3 method for class 'tssem1FEM.cluster'
coef(object, ...)
## S3 method for class 'tssem1REM'
coef(object, select = c("all", "fixed", "random"), ...)
## S3 method for class 'wls'
coef(object, ...)
## S3 method for class 'wls.cluster'
coef(object, ...)
## S3 method for class 'meta'
coef(object, select = c("all", "fixed", "random"), ...)
## S3 method for class 'meta3LFIML'
coef(object, select = c("all", "fixed", "random", "allX"), ...)
## S3 method for class 'reml'
coef(object, ...)
## S3 method for class 'MxRAMModel'
coef(object, ...)
## S3 method for class 'osmasem'
coef(object, select=c("fixed", "all", "random"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_+3A_object">object</code></td>
<td>
<p>An object returned from either class
<code>tssem1FEM</code>, class <code>tssem1FEM.cluster</code>, class <code>tssem1REM</code>, 
class <code>wls</code>, class <code>wls.cluster</code>, class <code>meta</code>, class
<code>reml</code> or class <code>MxRAMModel</code>
</p>
</td></tr>
<tr><td><code id="coef_+3A_select">select</code></td>
<td>
<p>Select <code>all</code> for both fixed- and random-effects parameters, <code>fixed</code> for the
fixed-effects parameters or <code>random</code> for the random-effects
parameters. For <code>meta3LFIML</code> objects, <code>allX</code> is used to extract
all parameters including the predictors and auxiliary variables.  
</p>
</td></tr>  
<tr><td><code id="coef_+3A_...">...</code></td>
<td>
<p>Further arguments; currently none is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Parameter estimates for both fixed-effects (if any) and random-effects (if any)
</p>


<h3>Note</h3>

<p><code>coef.MxRAMModel</code> is simply a wraper of
<code>omxGetParameters</code>. Extra arguments will be passed to it</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tssem1">tssem1</a></code>, <code><a href="#topic+wls">wls</a></code>,
<code><a href="#topic+meta">meta</a></code>, <code><a href="#topic+reml">reml</a></code>,
<code><a href="OpenMx.html#topic+omxGetParameters">omxGetParameters</a></code>, <code><a href="#topic+osmasem">osmasem</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Random-effects meta-analysis
model1 &lt;- meta(y=yi, v=vi, data=Hox02)
coef(model1)

## Fixed-effects only
coef(model1, select="fixed")
</code></pre>

<hr>
<h2 id='Cooke16'>Correlation Matrices from Cooke et al. (2016)</h2><span id='topic+Cooke16'></span>

<h3>Description</h3>

<p>The data set includes correlation matrices on using the theory of planned
behavior to predict alcohol consumption reported by Cooke et al. (2016). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cooke16)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of correlation matrices. The variables are
<em>SN</em> (subjective norm), <em>ATT</em> (attitude), <em>PBC</em>
(perceived behavior control), <em>BI</em> (behavioral intention), and
<em>BEH</em> (behavior).</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes.</p>
</dd>
<dt>MeanAge</dt><dd><p>Mean age of the participants except for <code>Ajzen and
	Sheikh (2013)</code>, which is the median age, and <code>Glassman, et
	al. (2010a)</code> to <code>Glassman, et al. (2010d)</code>, which are based on
the range of 18 to 24.</p>
</dd>
<dt>Female</dt><dd><p>Percentage of female participants.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cooke, R., Dahdah, M., Norman, P., &amp; French, D. P. (2016). How well does the theory of planned behaviour predict alcohol consumption? A systematic review and meta-analysis. <em>Health Psychology Review</em>, <b>10</b>(2), 148-167.
</p>


<h3>References</h3>

<p>Cheung, M. W.-L., &amp; Hong, R. Y. (2017). Applications of meta-analytic structural equation modeling in health psychology: Examples, issues, and recommendations. <em>Health Psychology Review</em>, <b>11</b>, 265-279. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Check whether the correlation matrices are valid (positive definite)
Cooke16$data[is.pd(Cooke16$data)==FALSE]

## Since the correlation matrix in Study 3 is not positive definite,
## we exclude it in the following analyses
my.data &lt;- Cooke16$data[-3]
my.n &lt;- Cooke16$n[-3]

## Show the no. of studies per correlation
pattern.na(my.data, show.na = FALSE)

## Show the total sample sizes per correlation
pattern.n(my.data, my.n)

## Stage 1 analysis
## Random-effects model
random1 &lt;- tssem1(my.data, my.n, method="REM", RE.type="Diag", acov="weighted")
summary(random1)

A1 &lt;- create.mxMatrix(c(0,0,0,0,0,
                        0,0,0,0,0,
                        0,0,0,0,0,
                        "0.2*SN2BI","0.2*ATT2BI","0.2*PBC2BI",0,0,
                        0,0,"0.2*PBC2BEH","0.2*BI2BEH",0),
                        type="Full", ncol=5, nrow=5,
                        byrow=TRUE, as.mxMatrix=FALSE)

## This step is not necessary but it is useful for inspecting the model.
dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- colnames(Cooke16$data[[1]])

## Display A1
A1

S1 &lt;- create.mxMatrix(c(1,
                        "0.1*ATT_SN", 1,
                        "0.1*PBC_SN", "0.1*PBC_ATT", 1,
                        0, 0, 0, "0.5*VarBI",
                        0, 0, 0, 0, "0.5*VarBEH"),
                      type = "Symm", ncol=5, nrow=5,
                      byrow=TRUE, as.mxMatrix=FALSE)

dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- colnames(Cooke16$data[[1]])
S1

## Stage 2 analysis
random2 &lt;- tssem2(random1, Amatrix=A1, Smatrix=S1, diag.constraints=FALSE,
                  intervals.type="LB")
summary(random2)

## Display the model
plot(random2, what="path")    
    
## Display the model with the parameter estimates
plot(random2, color="yellow")

## End(Not run)
</code></pre>

<hr>
<h2 id='Cooper03'>Selected effect sizes from Cooper et al. (2003)</h2><span id='topic+Cooper03'></span>

<h3>Description</h3>

<p>Fifty-six effect sizes from 11 districts from Cooper et al. (2003) were reported by Konstantopoulos (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Cooper03)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>District</dt><dd><p>District ID</p>
</dd>
<dt>Study</dt><dd><p>Study ID</p>
</dd>
<dt>y</dt><dd><p>Effect size</p>
</dd>
<dt>v</dt><dd><p>Sampling variance</p>
</dd>
<dt>Year</dt><dd><p>Year of publication</p>
</dd>
</dl>



<h3>Source</h3>

<p>Cooper, H., Valentine, J. C., Charlton, K., &amp; Melson, A. (2003). The Effects of Modified School Calendars on Student Achievement and on School and Community Attitudes. <em>Review of Educational Research</em>, <b>73(1)</b>, 1-52. doi:10.3102/00346543073001001
</p>


<h3>References</h3>

<p>Konstantopoulos, S. (2011). Fixed effects and variance components
estimation in three-level meta-analysis. <em>Research Synthesis
Methods</em>, <b>2</b>, 61-76. doi:10.1002/jrsm.35
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Cooper03)

#### ML estimation method
## No predictor
summary( model1 &lt;- meta3L(y=y, v=v, cluster=District, data=Cooper03) )

## Show all heterogeneity indices and their 95% confidence intervals
summary( meta3L(y=y, v=v, cluster=District, data=Cooper03,
               intervals.type="LB", I2=c("I2q", "I2hm", "I2am", "ICC")) )

## Year as a predictor
summary( meta3L(y=y, v=v, cluster=District, x=scale(Year, scale=FALSE),
               data=Cooper03, model.name="Year as a predictor") )

## Equality of level-2 and level-3 heterogeneity
summary( model2 &lt;- meta3L(y=y, v=v, cluster=District, data=Cooper03,
                         RE2.constraints="0.2*EqTau2",
                         RE3.constraints="0.2*EqTau2",
                         model.name="Equal Tau2") )

## Compare model2 vs. model1
anova(model1, model2)

#### REML estimation method
## No predictor
summary( reml3L(y=y, v=v, cluster=District, data=Cooper03) )

## Level-2 and level-3 variances are constrained equally 
summary( reml3L(y=y, v=v, cluster=District, data=Cooper03,
               RE.equal=TRUE, model.name="Equal Tau2") )

## Year as a predictor
summary( reml3L(y=y, v=v, cluster=District, x=scale(Year, scale=FALSE),
               data=Cooper03, intervals.type="LB") )

## Handling missing covariates with FIML
## Create 20/56 MCAR data in Year
set.seed(10000)
Year_MCAR &lt;- Cooper03$Year
Year_MCAR[sample(56, 20)] &lt;- NA
summary( meta3LFIML(y=y, v=v, cluster=District, x2=scale(Year_MCAR, scale=FALSE),
                    data=Cooper03, model.name="NA in Year_MCAR") )

## End(Not run)
</code></pre>

<hr>
<h2 id='Cor2DataFrame'>Convert correlation or covariance matrices into a dataframe of correlations or
covariances with their sampling covariance matrices
</h2><span id='topic+Cor2DataFrame'></span>

<h3>Description</h3>

<p>It converts the correlation or covariance matrices into a
dataframe of correlations or covariances with their asymptotic
sampling covariance matrices. It uses the <code>asyCov</code> at the backend. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cor2DataFrame(x, n, v.na.replace = TRUE, row.names.unique = FALSE,
              cor.analysis = TRUE, acov="weighted", append.vars=TRUE,
              asyCovOld=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cor2DataFrame_+3A_x">x</code></td>
<td>
<p>A list of data with correlation/covariance matrix in <code>x$data</code> and
sample sizes <code>x$n</code>. Additional variables in <code>x</code> can be attached.
</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_n">n</code></td>
<td>
<p>If <code>x</code> is a list of correlation matrices without
<code>x$data</code> and <code>x$n</code>, a vector of sample sizes <code>n</code> must
be provided.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_v.na.replace">v.na.replace</code></td>
<td>
<p>Logical. Missing value is not allowed in definition
variables. If it is <code>TRUE</code> (the default), missing value is
replaced by a large value (1e10). These values are not used in the analysis.</p>
</td></tr> 
<tr><td><code id="Cor2DataFrame_+3A_row.names.unique">row.names.unique</code></td>
<td>
<p>Logical, If it is <code>FALSE</code> (the default), unique
row names are not created.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Logical. The output is either a correlation or
covariance matrix.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_acov">acov</code></td>
<td>
<p>If it is <code>weighted</code>, the average correlation/covariance
matrix is calculated based on the weighted mean with the sample
sizes. The average correlation/covariance matrix is used to calculate the sampling
variance-covariance matrices.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_append.vars">append.vars</code></td>
<td>
<p>Whether to append the additional variables to
the output dataframe.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_asycovold">asyCovOld</code></td>
<td>
<p>Whether to use the old version of <code>asyCov</code>. See <code><a href="#topic+asyCov">asyCov</a></code>.</p>
</td></tr>
<tr><td><code id="Cor2DataFrame_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="#topic+asyCov">asyCov</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of components: (1) a data frame of correlations or covariances with their
sampling covariance matrices; (2) a vector of sample
sizes; (3) labels of the correlations; and (3) labels of their sampling covariance matrices. </p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+asyCov">asyCov</a></code>, <code><a href="#topic+osmasem">osmasem</a></code>, <code><a href="#topic+create.vechsR">create.vechsR</a></code>,
<code><a href="#topic+create.Tau2">create.Tau2</a></code>, <code><a href="#topic+create.V">create.V</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Provide a list of correlation matrices and a vector of sample sizes as the inputs
my.df1 &lt;- Cor2DataFrame(Nohe15A1$data, Nohe15A1$n)

## Add Lag time as a variable
my.df1$data &lt;- data.frame(my.df1$data, Lag=Nohe15A1$Lag, check.names=FALSE)

## Data
my.df1$data

## Sample sizes
my.df1$n

## ylabels
my.df1$ylabels

## vlabels
my.df1$vlabels

#### Simplified version to do it
my.df2 &lt;- Cor2DataFrame(Nohe15A1)

## End(Not run)
</code></pre>

<hr>
<h2 id='create.Fmatrix'>Create an F matrix to select observed variables
</h2><span id='topic+create.Fmatrix'></span>

<h3>Description</h3>

<p>It creates an F matrix to select observed variables for wls
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.Fmatrix(x, name, as.mxMatrix=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.Fmatrix_+3A_x">x</code></td>
<td>
<p>A vector of logical type 
</p>
</td></tr>
<tr><td><code id="create.Fmatrix_+3A_name">name</code></td>
<td>
<p>Name of the matrix. If it is missing, &quot;Fmatrix&quot; will be used.
</p>
</td></tr>
<tr><td><code id="create.Fmatrix_+3A_as.mxmatrix">as.mxMatrix</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, the output is a matrix of
<code>MxMatrix-class</code>. If it is <code>FALSE</code>, it is a numeric matrix.</p>
</td></tr>
<tr><td><code id="create.Fmatrix_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>, <code><a href="#topic+create.mxMatrix">create.mxMatrix</a></code>, <code><a href="#topic+wls">wls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Select the first 3 variables while the other 2 variables are latent.
create.Fmatrix(c(1,1,1,0,0))
# FullMatrix 'Fmatrix' 
#
# @labels: No labels assigned.
#
# @values
#      [,1] [,2] [,3] [,4] [,5]
# [1,]    1    0    0    0    0
# [2,]    0    1    0    0    0
# [3,]    0    0    1    0    0
#
# @free: No free parameters.
#
# @lbound: No lower bounds assigned.
#
# @ubound: No upper bounds assigned.

create.Fmatrix(c(1,1,1,0,0), as.mxMatrix=FALSE)
#      [,1] [,2] [,3] [,4] [,5]
# [1,]    1    0    0    0    0
# [2,]    0    1    0    0    0
# [3,]    0    0    1    0    0
</code></pre>

<hr>
<h2 id='create.modMatrix'>Create a moderator matrix used in OSMASEM
</h2><span id='topic+create.modMatrix'></span>

<h3>Description</h3>

<p>It creates a moderator matrix used in OSMASEM.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.modMatrix(RAM, output=c("A", "S"), mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.modMatrix_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>.</p>
</td></tr>
<tr><td><code id="create.modMatrix_+3A_output">output</code></td>
<td>
<p>Whether the output is an &quot;A&quot; or &quot;S&quot; matrix.</p>
</td></tr>
<tr><td><code id="create.modMatrix_+3A_mod">mod</code></td>
<td>
<p>A string of moderator in the dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character matrix.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A multiple regression model
model &lt;- "y ~ x1 + x2
          x1 ~~ 1*x1
          x2 ~~ 1*x2
          x1 ~~ x2"

## RAM specification
RAM &lt;- lavaan2RAM(model, obs.variables=c("y", "x1", "x2"))

## Create a moderator matrix on A with "meanAge as the moderator.
A1 &lt;-  create.modMatrix(RAM=RAM, output="A", mod="meanAge")
A1

## Create a moderator matrix on S with "meanAge as the moderator.
S1 &lt;-  create.modMatrix(RAM=RAM, output="S", mod="meanAge")
S1
</code></pre>

<hr>
<h2 id='create.mxMatrix'>Create a Vector into MxMatrix-class
</h2><span id='topic+create.mxMatrix'></span>

<h3>Description</h3>

<p>It converts a vector into <code>MxMatrix-class</code> via <code>mxMatrix</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.mxMatrix(x, type=c("Full","Symm","Diag","Stand"), ncol=NA,
nrow=NA, as.mxMatrix=TRUE, byrow=FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.mxMatrix_+3A_x">x</code></td>
<td>
<p>A character or numeric vector 
</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_type">type</code></td>
<td>
<p>Matrix type similar to those listed in
<code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code>
</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_ncol">ncol</code></td>
<td>
<p>The number of columns. It is necessary when
<code>type="Full"</code>. It is ignored and determined by the length of
<code>x</code> for the other types of matrices.
</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_nrow">nrow</code></td>
<td>
<p>The number of rows. It is necessary when
<code>type="Full"</code>. It is ignored and determined by the length of
<code>x</code> for the other types of matrices.
</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_as.mxmatrix">as.mxMatrix</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, the output is a matrix of
<code>MxMatrix-class</code>. If it is <code>FALSE</code>, it is a numeric matrix.</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_byrow">byrow</code></td>
<td>
<p>Logical. If <code>FALSE</code> (the default) the matrix is filled by columns, otherwise the matrix is filled by rows.
</p>
</td></tr>
<tr><td><code id="create.mxMatrix_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to
<code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code>. Please note that <code>type</code>,
<code>nrow</code>, <code>ncol</code>, <code>values</code>, <code>free</code> and <code>labels</code> will be created automatically. Thus, these arguments
except labels should be avoided in ... 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are non-numeric values in <code>x</code>, they are treated
as the labels of the free parameters. If an &quot;*&quot; is
present, the numeric value on the left-hand side will be treated as
the starting value for a free parameter or a fixed value for a fixed parameter. If it is a matrix of numeric values, there are
no free parameters in the output matrix. <code>nrow</code> and <code>ncol</code>
will be calculated from the length of <code>x</code> unless
<code>type="Full"</code> is specified.
</p>


<h3>Value</h3>

<p>A <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> object with the same
dimensions as <code>x</code>
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code>,
<code><a href="#topic+create.mxMatrix">create.mxMatrix</a></code>,  <code><a href="#topic+create.Fmatrix">create.Fmatrix</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a and b are free parameters with starting values and labels
(a1 &lt;- c(1:4, "5*a", 6, "7*b", 8, 9))

(mat1 &lt;- create.mxMatrix(a1, ncol=3, nrow=3, name="mat1"))

## Arrange the elements by row
(mat2 &lt;- create.mxMatrix(a1, ncol=3, nrow=3, as.mxMatrix=FALSE, byrow=TRUE))

(a3 &lt;- c(1:3, "4*f4", "5*f5", "6*f6"))

(mat3 &lt;- create.mxMatrix(a3, type="Symm", name="mat3"))

## Create character matrix
(mat4 &lt;- create.mxMatrix(a3, type="Symm", as.mxMatrix=FALSE))

## Arrange the elements by row
(mat5 &lt;- create.mxMatrix(a3, type="Symm", as.mxMatrix=FALSE, byrow=TRUE))

(mat6 &lt;- create.mxMatrix(a3, type="Diag", lbound=6:1, name="mat6"))
</code></pre>

<hr>
<h2 id='create.mxModel'>Create an mxModel
</h2><span id='topic+create.mxModel'></span>

<h3>Description</h3>

<p>It creates a mxModel from a RAM object.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.mxModel(model.name="mxModel", RAM=NULL, data=NULL,
               Cov=NULL, means=NULL, numObs,
               intervals.type = c("z", "LB"), startvalues=NULL, 
               mxModel.Args=NULL, run=TRUE, mxTryHard=FALSE,
               silent=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.mxModel_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_data">data</code></td>
<td>
<p>A data frame or matrix of data.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_cov">Cov</code></td>
<td>
<p>A covariance matrix may also be used if <code>data</code>==NULL.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_means">means</code></td>
<td>
<p>A named vector of means (options) if <code>Cov</code> is used.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_numobs">numObs</code></td>
<td>
<p>If <code>Cov</code> is used, a sample size must be provided.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% confidence
intervals (CIs) based on the estimated standard error. If it
is <code>LB</code>, it calculates the 95% likelihood-based CIs on the
parameter estimates.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_startvalues">startvalues</code></td>
<td>
<p>A list of starting values for the free parameters.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_mxmodel.args">mxModel.Args</code></td>
<td>
<p>A list of arguments passed to <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_mxtryhard">mxTryHard</code></td>
<td>
<p>If <code>TRUE</code>, call <code>mxTryHard</code> to run the
analysis. If <code>FALSE</code>, call <code>mxRun</code> to run the analysis.</p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument is passed to either
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code> or <code><a href="OpenMx.html#topic+mxTryHard">mxTryHard</a></code></p>
</td></tr>
<tr><td><code id="create.mxModel_+3A_...">...</code></td>
<td>
<p>Further arguments will be passed to either
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code> or <code><a href="OpenMx.html#topic+mxTryHard">mxTryHard</a></code></p>
</td></tr>  
</table>


<h3>Value</h3>

<p>An object of class <code>mxModel</code></p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Generate data
set.seed(100)
n &lt;- 100
x &lt;- rnorm(n)
y &lt;- 0.5*x + rnorm(n, mean=0, sd=sqrt(1-0.5^2))
my.df &lt;- data.frame(y=y, x=x)

## A regression model
model &lt;- "y ~ x   # Regress y on x
          y ~ 1   # Intercept of y
          x ~ 1   # Mean of x"
plot(model)

RAM &lt;- lavaan2RAM(model, obs.variables=c("y", "x"))

my.fit &lt;- create.mxModel(RAM=RAM, data=my.df)
summary(my.fit)

## A meta-analysis
model &lt;- "f =~ 1*yi
          f ~ mu*1          ## Average effect
          f ~~ tau2*f       ## Heterogeneity variance
          yi ~~ data.vi*yi  ## Known sampling variance"
plot(model)

## Do not standardize the latent variable (f): std.lv=FALSE 
RAM &lt;- lavaan2RAM(model, obs.variables="yi", std.lv=FALSE)

## Use likelihood-based CI 
my.fit &lt;- create.mxModel(RAM=RAM, data=Hox02, intervals="LB")
summary(my.fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='create.Tau2'>Create a variance component of the heterogeneity of the random effects
</h2><span id='topic+create.Tau2'></span>

<h3>Description</h3>

<p>It creates variance component of the heterogeneity of the
random effects by decomposing the variance component into matrices of
correlation and standard deviations.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.Tau2(RAM, no.var, Tau1.labels=seq(no.var),
            RE.type = c("Diag", "Symm", "Zero", "User"),
            level=c("single", "between", "within"),
            RE.User=NULL, Transform = c("expLog", "sqSD"),
            RE.startvalues=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.Tau2_+3A_ram">RAM</code></td>
<td>
<p>The RAM model for testing. <code>no.var</code> is calculated from it.</p>
</td></tr>  
<tr><td><code id="create.Tau2_+3A_no.var">no.var</code></td>
<td>
<p>If <code>RAM</code> is missing, the user has to specify
the <code>no.var</code> argument. It represents the <code>no.var</code> by <code>no.var</code> of the random effects).</p>
</td></tr>
<tr><td><code id="create.Tau2_+3A_tau1.labels">Tau1.labels</code></td>
<td>
<p>Parameter labels in <code>Tau1</code>. The default is
<code>Tau1_1</code>, <code>Tau1_2</code>, etc.
</p>
</td></tr>
<tr><td><code id="create.Tau2_+3A_re.type">RE.type</code></td>
<td>
<p>Either <code>"Diag"</code>, <code>"Symm"</code>, <code>"Zero"</code> or <code>"User"</code>. If
it is<code>"Diag"</code> (the default if missing), a diagonal matrix is used
for the random effects meaning that the random effects are
independent. If it is <code>"Symm"</code>, a symmetric matrix is used for the random effects on the covariances
among the correlation (or covariance) vectors. If it is
<code>"Zero"</code>, a zero matrix is assumed on the variance component of
the random effects. If it is <code>"User"</code>, users have to specify the
<code>RE.User</code> argument.</p>
</td></tr>
<tr><td><code id="create.Tau2_+3A_level">level</code></td>
<td>
<p>whether it is for single-level, between-, or within-level
analyses. The only difference are the names of the matrices.</p>
</td></tr>
<tr><td><code id="create.Tau2_+3A_re.user">RE.User</code></td>
<td>
<p>It represents the <code>no.var</code> by <code>no.var</code> symmetric matrix
of <code>TRUE</code> or <code>FALSE</code> for the variance component. If the
elements are <code>FALSE</code>, they are fixed at 0.</p>
</td></tr>
<tr><td><code id="create.Tau2_+3A_transform">Transform</code></td>
<td>
<p>Either <code>"expLog"</code> or <code>"sqSD"</code>. If it is
<code>"expLog"</code>, the variances are estimated by applying a log and exp
transformation. If it is <code>"sqSD"</code>, the variances are estimated by
applying a square on the SD. The transformation may improve the
estimation when the heterogeneity is small or close to zero.</p>
</td></tr>   
<tr><td><code id="create.Tau2_+3A_re.startvalues">RE.startvalues</code></td>
<td>
<p>Starting values for the variances.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>MxMatrix-class</code>. The variance component is
computed in <code>Tau2</code>.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+osmasem">osmasem</a></code>,
<code><a href="#topic+create.V">create.V</a></code>, <code><a href="#topic+create.vechsR">create.vechsR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
T0 &lt;- create.Tau2(no.var=4, RE.type="Diag", Transform="expLog", RE.startvalues=0.05)
T0

T1 &lt;- create.Tau2(no.var=4, Tau1.labels=c("a", "b", "c", "d"))
T1

## End(Not run)
</code></pre>

<hr>
<h2 id='create.V'>Create a V-known matrix</h2><span id='topic+create.V'></span>

<h3>Description</h3>

<p>It creates a V-known matrix of the sampling covariance
matrix using definition variables.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.V(x, type = c("Symm", "Diag", "Full"), as.mxMatrix = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.V_+3A_x">x</code></td>
<td>
<p>A character vector of variable names of the sampling covariance matrix.</p>
</td></tr>
<tr><td><code id="create.V_+3A_type">type</code></td>
<td>
<p>Either <code>"Symm"</code>, <code>"Diag"</code> or
<code>"Full"</code>. Suppose the number of variables is <code class="reqn">p</code>, the
numbers of variable names for <code>"Symm"</code>, <code>"Diag"</code>, and
<code>"Full"</code> are <code class="reqn">p(p-1)/2 </code>, <code class="reqn">p</code>, and
<code class="reqn">p*p</code>, respectively. The elements are arranged in a column major.</p>
</td></tr> 
<tr><td><code id="create.V_+3A_as.mxmatrix">as.mxMatrix</code></td>
<td>
<p>Logical. Whether to convert the output into <code>MxMatrix-class</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>MxMatrix-class</code>. The V-known sampling covariance
matrix is computed in <code>V</code>.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+osmasem">osmasem</a></code>,
<code><a href="#topic+create.Tau2">create.Tau2</a></code>, <code><a href="#topic+create.vechsR">create.vechsR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
my.df &lt;- Cor2DataFrame(Nohe15A1)

## Create known sampling variance covariance matrix
V0 &lt;- create.V(my.df$vlabels)
V0

## End(Not run)
</code></pre>

<hr>
<h2 id='create.vechsR'>Create a model implied correlation matrix with implicit diagonal constraints
</h2><span id='topic+create.vechsR'></span>

<h3>Description</h3>

<p>It creates implicit diagonal constraints on the model
implied correlation matrix by treating the error variances as
functions of other parameters. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.vechsR(A0, S0, F0 = NULL, Ax = NULL, Sx = NULL, A.lbound=NULL, A.ubound=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.vechsR_+3A_a0">A0</code></td>
<td>
<p>A Amatrix, which will be converted into <code>MxMatrix-class</code> via <code>as.mxMatrix</code>.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_s0">S0</code></td>
<td>
<p>A Smatrix, which will be converted into <code>MxMatrix-class</code> via <code>as.mxMatrix</code>.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_f0">F0</code></td>
<td>
<p>A Fmatrix, which will be converted into <code>MxMatrix-class</code> via <code>as.mxMatrix</code>.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_ax">Ax</code></td>
<td>
<p>A Amatrix of a list of Amatrix with definition variables as the moderators of the Amatrix.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_sx">Sx</code></td>
<td>
<p>A Smatrix of a list of Smatrix with definition variables as the moderators of the Smatrix.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_a.lbound">A.lbound</code></td>
<td>
<p>A matrix of lower bound of the Amatrix. If a scalar is
given, the lbound matrix will be filled with this scalar.</p>
</td></tr>
<tr><td><code id="create.vechsR_+3A_a.ubound">A.ubound</code></td>
<td>
<p>A matrix of upper bound of the Amatrix. If a scalar is
given, the ubound matrix will be filled with this scalar.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>MxMatrix-class</code>. The model implied correlation
matrix is computed in <code>impliedR</code> and <code>vechsR</code>.</p>


<h3>Note</h3>

<p>Since <code>A0</code> are the intercepts and <code>Ax</code> are the
regression coefficients. The parameters in <code>Ax</code> must be a subset of those in
<code>A0</code>.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+osmasem">osmasem</a></code>,
<code><a href="#topic+create.Tau2">create.Tau2</a></code>, <code><a href="#topic+create.V">create.V</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Proposed model
model1 &lt;- 'W2 ~ w2w*W1 + s2w*S1
           S2 ~ w2s*W1 + s2s*S1
           W1 ~~ w1WITHs1*S1
           W2 ~~ w2WITHs2*S2
           W1 ~~ 1*W1
           S1 ~~ 1*S1
           W2 ~~ Errw2*W2
           S2 ~~ Errs2*S2'

## Convert into RAM    
RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("W1", "S1", "W2", "S2"))

## No moderator    
M0 &lt;- create.vechsR(A0=RAM1$A, S0=RAM1$S, F0=NULL, Ax=NULL, Sx=NULL)

## Lag (definition variable) as a moderator on the paths in the Amatrix    
Ax &lt;- matrix(c(0,0,0,0,
               0,0,0,0,
               "0*data.Lag","0*data.Lag",0,0,
               "0*data.Lag","0*data.Lag",0,0),
             nrow=4, ncol=4, byrow=TRUE)
                
M1 &lt;- create.vechsR(A0=RAM1$A, S0=RAM1$S, F0=NULL, Ax=Ax, Sx=NULL)    

## Lag (definition variable) as a moderator on the correlation in the Smatrix
Sx &lt;- matrix(c(0,"0*data.Lag",0,0,
               "0*data.Lag",0,0,0,
               0,0,0,"0*data.Lag",
               0,0,"0*data.Lag",0),
             nrow=4, ncol=4, byrow=TRUE)

M2 &lt;- create.vechsR(A0=RAM1$A, S0=RAM1$S, F0=NULL, Ax=NULL, Sx=Sx)

## End(Not run)
</code></pre>

<hr>
<h2 id='Diag'>Matrix Diagonals
</h2><span id='topic+Diag'></span><span id='topic+Diag+3C-'></span>

<h3>Description</h3>

<p>Extract or replace the diagonal of a matrix, or construct a diagonal matrix with the same behaviors as <code>diag</code> prior to R-3.0.0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Diag(x, ...)
Diag(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Diag_+3A_x">x</code></td>
<td>
<p>A matrix, vector or 1D array, or missing.</p>
</td></tr>
<tr><td><code id="Diag_+3A_...">...</code></td>
<td>
<p>Optional dimensions (<code>nrow</code> and <code>ncol</code>) for the result when <code>x</code> is
not a matrix.</p>
</td></tr>
<tr><td><code id="Diag_+3A_value">value</code></td>
<td>
<p>Either a single value or a vector of length equal to that
of the current diagonal. Should be of a mode which can be coerced
to that of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Started from R-3.0.0, <code>diag(x)</code> returns a numeric matrix with NA in the
diagonals when x is a character vector. Although this follows what the manual says, this
breaks the metaSEM. The <code>Diag</code> has the same functions as
<code>diag</code> except that <code>Diag(x)</code> works for a character vector of
x by returning a square matrix of character &quot;0&quot; with <code>x</code> as the
diagonals.

</p>


<h3>Note</h3>

<p>See
http://r.789695.n4.nabble.com/Behaviors-of-diag-with-character-vector-in-R-3-0-0-td4663735.html
for the discussion.

</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+diag">diag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>v &lt;- c("a", "b")
Diag(v)
</code></pre>

<hr>
<h2 id='Digman97'>Factor Correlation Matrices of Big Five Model from Digman (1997)</h2><span id='topic+Digman97'></span>

<h3>Description</h3>

<p>The data set includes fourteen studies of the factor correlation matrices of the Five-Factor Model of personality reported by Digman (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Digman97)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 14 studies of correlation matrices. The
variables are <em>Agreeableness</em> (A), <em>Conscientiousness</em>
(C), <em>Emotional Stability</em> (ES), <em>Extraversion</em> (E) and <em>Intellect</em> (I)</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>cluster</dt><dd><p>Types of participants of the studies</p>
</dd>
</dl>



<h3>Source</h3>

<p>Digman, J.M. (1997). Higher-order factors of the Big Five. <em>Journal of Personality and Social Psychology</em>, <b>73</b>, 1246-1256.
</p>


<h3>References</h3>

<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Classifying correlation matrices into relatively homogeneous subgroups: A cluster analytic approach. <em>Educational and Psychological Measurement</em>, <b>65</b>, 954-979.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
Digman97

##### Fixed-effects TSSEM
fixed1 &lt;- tssem1(Digman97$data, Digman97$n, method="FEM")
summary(fixed1)

## Factor covariance among latent factors
Phi &lt;- matrix(c(1,"0.3*cor","0.3*cor",1), ncol=2, nrow=2)

## Error covariance matrix
Psi &lt;- Diag(c("0.2*e1","0.2*e2","0.2*e3","0.2*e4","0.2*e5"))

## S matrix
S1 &lt;- bdiagMat(list(Psi, Phi))

## This step is not necessary but it is useful for inspecting the model.
dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c("A","C","ES","E","I","Alpha","Beta")

## Display S1
S1

## A matrix
Lambda &lt;-
matrix(c(".3*Alpha_A",".3*Alpha_C",".3*Alpha_ES",rep(0,5),".3*Beta_E",".3*Beta_I"),
       ncol=2, nrow=5)
A1 &lt;- rbind( cbind(matrix(0,ncol=5,nrow=5), Lambda),
             matrix(0, ncol=7, nrow=2) )

## This step is not necessary but it is useful for inspecting the model.
dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c("A","C","ES","E","I","Alpha","Beta")

## Display A1
A1

## F matrix to select the observed variables
F1 &lt;- create.Fmatrix(c(1,1,1,1,1,0,0), as.mxMatrix=FALSE)

## Display F1
F1

################################################################################
## Alternative model specification in lavaan model syntax
model &lt;- "## Factor loadings
          Alpha=~A+C+ES
          Beta=~E+I
          ## Factor correlation
          Alpha~~Beta"

## Display the model
plot(model)

RAM &lt;- lavaan2RAM(model, obs.variables=c("A","C","ES","E","I"),
                  A.notation="on", S.notation="with")
RAM

A1 &lt;- RAM$A
S1 &lt;- RAM$S
F1 &lt;- RAM$F

################################################################################
fixed2 &lt;- tssem2(fixed1, Amatrix=A1, Smatrix=S1, Fmatrix=F1,
                 model.name="TSSEM2 Digman97")
summary(fixed2)

## Display the model with the parameter estimates
plot(fixed2)

#### Fixed-effects TSSEM with several clusters
#### Create a variable for different samples
#### Younger participants: Children and Adolescents
#### Older participants: others
cluster &lt;- ifelse(Digman97$cluster %in% c("Children","Adolescents"),
                  yes="Younger participants", no="Older participants")

#### Show the cluster
cluster

## Example of Fixed-effects TSSEM with several clusters
fixed1.cluster &lt;- tssem1(Digman97$data, Digman97$n, method="FEM",
                         cluster=cluster)
summary(fixed1.cluster)

fixed2.cluster &lt;- tssem2(fixed1.cluster, Amatrix=A1, Smatrix=S1, Fmatrix=F1)
#### Please note that the estimates for the younger participants are problematic.
summary(fixed2.cluster)

## Setup two plots
layout(t(1:2))

## Plot the first group
plot(fixed2.cluster[[1]])
title("Younger participants")

## Plot the second group
plot(fixed2.cluster[[2]])
title("Older participants")

#### Random-effects TSSEM with random effects on the diagonals
random1 &lt;- tssem1(Digman97$data, Digman97$n, method="REM",
                  RE.type="Diag")
summary(random1)

random2 &lt;- tssem2(random1, Amatrix=A1, Smatrix=S1, Fmatrix=F1)
summary(random2)

## Display the model with the parameter estimates
plot(random2, color="green")

## End(Not run)
</code></pre>

<hr>
<h2 id='Gleser94'>Two Datasets from Gleser and Olkin (1994)
</h2><span id='topic+Gleser94'></span>

<h3>Description</h3>

<p>It includes two datasets in multiple-treatment studies and
multiple-endpoint studies reported by Gleser and Olkin (1994).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Gleser94")</code></pre>


<h3>Format</h3>

<p>A list of two data frames.
</p>

<dl>
<dt><code>MTS</code></dt><dd><p>A data frame of multiple-treatment studies.</p>
</dd>
<dt><code>MES</code></dt><dd><p>A data frame of multiple-endpoint studies.</p>
</dd>	
</dl>



<h3>Source</h3>

<p>Gleser, L. J., &amp; Olkin, I. (1994). Stochastically dependent effect sizes. In H. Cooper &amp; L. V. Hedges (Eds.), The handbook of research synthesis. (pp. 339-355). New York: Russell Sage Foundation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+smdMTS">smdMTS</a></code>, <code><a href="#topic+smdMES">smdMES</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Gleser94)

#### Multiple-treatment studies
Gleser94$MTS

## Assuming homogeneity of variances
my.MTS &lt;- t(apply(Gleser94$MTS, MARGIN=1,
            function(x)
            smdMTS(m=x[c("Mean.C", "Mean.E1", "Mean.E2", "Mean.E3", "Mean.E4", "Mean.E5")],
                   v=x[c("SD.C", "SD.E1", "SD.E2", "SD.E3", "SD.E4", "SD.E5")]^2,
                   n=x[c("N.C", "N.E1", "N.E2", "N.E3", "N.E4", "N.E5")],
                   homogeneity="variance", list.output=FALSE)))

## Fixed-effects multivariate meta-analysis
fit.MTS &lt;- meta(y=my.MTS[, 1:5], 
                v=my.MTS[, 6:20], 
                RE.constraints = diag(0, ncol=5, nrow=5),
                model.name="MTS")
summary(fit.MTS)

#### Multiple-endpoint studies
Gleser94$MES

## Calculate the sampling variances and covariance and amend into the data set
Gleser94$MES$Uncoached.V11 &lt;- with(Gleser94$MES, SD.Uncoached.Math^2)
Gleser94$MES$Uncoached.V21 &lt;- with(Gleser94$MES,
                                   SD.Uncoached.Math*Cor.Math.Verbal*SD.Uncoached.Verbal)
Gleser94$MES$Uncoached.V22 &lt;- with(Gleser94$MES, SD.Uncoached.Verbal^2)

Gleser94$MES$Coached.V11 &lt;- with(Gleser94$MES, SD.Coached.Math^2)
Gleser94$MES$Coached.V21 &lt;- with(Gleser94$MES,
                                 SD.Coached.Math*Cor.Math.Verbal*SD.Coached.Verbal)
Gleser94$MES$Coached.V22 &lt;- with(Gleser94$MES, SD.Coached.Verbal^2)

## Assuming homogeneity of covariance matrices
my.MES &lt;- t(apply(Gleser94$MES, MARGIN=1,
            function(x)
            smdMES(m1=x[c("Mean.Uncoached.Math", "Mean.Uncoached.Verbal")],
                   m2=x[c("Mean.Coached.Math", "Mean.Coached.Verbal")],
                   V1=vec2symMat(x[c("Uncoached.V11", "Uncoached.V21", "Uncoached.V22")]),
                   V2=vec2symMat(x[c("Coached.V11", "Coached.V21", "Coached.V22")]),
                   n1=x["N.Uncoached"],
                   n2=x["N.Coached"],
                   homogeneity="covariance", list.output=FALSE)))

## Fixed-effects multivariate meta-analysis
fit.MES &lt;- meta(y=my.MES[, 1:2], 
                v=my.MES[, 3:5], 
                RE.constraints = diag(0, ncol=2, nrow=2),
                model.name="MES")
summary(fit.MES)

## End(Not run)
</code></pre>

<hr>
<h2 id='Gnambs18'>Correlation Matrices from Gnambs, Scharl, and Schroeders (2018)</h2><span id='topic+Gnambs18'></span>

<h3>Description</h3>

<p>The data set includes 113 correlation matrices on the Rosenberg
Self-Esteem Scale reported by Gnambs, Scharl, and Schroeders
(2018). Thirty-six studies were based on the reported correlation
matrices (<code>CorMat=1</code>) whereas the correlation matrices of the
other 77 studies were calculated from the reported factor loadings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Gnambs18)
</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 113 correlation matrices. The variable names are from <em>I1</em> to <em>I10</em>.</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes.</p>
</dd>
<dt>Year</dt><dd><p>The year of publications.</p>
</dd>
<dt>Country</dt><dd><p>The country of studies conducted.</p>
</dd>
<dt>Language</dt><dd><p>The language used in the studies.</p>
</dd>
<dt>Publication</dt><dd><p>Whether the studies were published (1) or
unpublished (0).</p>
</dd>
<dt>MeanAge</dt><dd><p>Mean age of the participants.</p>
</dd>
<dt>FemaleProp</dt><dd><p>Proportion of the female participants.</p>
</dd>
<dt>Individualism</dt><dd><p>Individualism score of the country.</p>
</dd>
<dt>CorMat</dt><dd><p>Whether the correlation matrices are obtained from the original
studies (1) or reproduced from the factor loadings (0).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gnambs, T., Scharl, A., &amp; Schroeders, U. (2018). The structure of the Rosenberg Self-Esteem Scale. <em>Zeitschrift Fur Psychologie</em>, <b>226</b>(1), 14-29. https://doi.org/10.1027/2151-2604/a000317
</p>

<hr>
<h2 id='HedgesOlkin85'>Effects of Open Education Reported by Hedges and Olkin (1985)
</h2><span id='topic+HedgesOlkin85'></span>

<h3>Description</h3>

<p>Effects of open education on attitude toward school and on reading achievement reported by Hedges and Olkin (1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HedgesOlkin85)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>study</dt><dd><p>Study number</p>
</dd>
<dt>d_att</dt><dd><p>Standardized mean difference on <em>attitude</em></p>
</dd>
<dt>d_ach</dt><dd><p>Standardized mean difference on <em>achievement</em></p>
</dd>
<dt>var_att</dt><dd><p>Sampling variance of the effect size of <em>attitude</em></p>
</dd>
<dt>cov_att_ach</dt><dd><p>Sampling covariance between the effect sizes</p>
</dd>
<dt>var_ach</dt><dd><p>Sampling variance of the effect size of <em>achievement</em></p>
</dd>
</dl>



<h3>Source</h3>

<p>Hedges, L. V., &amp; Olkin, I. (1985). <em>Statistical methods for meta-analysis.</em> Orlando, FL: Academic Press. 
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2010). Fixed-effects meta-analyses as multiple-group structural equation models. <em>Structural Equation Modeling</em>, <b>17</b>, 481-509.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HedgesOlkin85)

## Fixed-effects meta-analysis
summary( meta(y=cbind(d_att, d_ach),
              v=cbind(var_att, cov_att_ach, var_ach),
              data=HedgesOlkin85,
              RE.constraints=matrix(0, nrow=2, ncol=2)) )
</code></pre>

<hr>
<h2 id='homoStat'>Test the Homogeneity of Effect Sizes
</h2><span id='topic+homoStat'></span>

<h3>Description</h3>

<p>It tests the homogeneity of univariate and multivariate effect sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>homoStat(y, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="homoStat_+3A_y">y</code></td>
<td>
<p>A vector of effect size for univariate meta-analysis or a <code class="reqn">k</code> x
<code class="reqn">p</code> matrix of effect sizes for multivariate meta-analysis
where <code class="reqn">k</code> is the number of studies and <code class="reqn">p</code> is the
number of effect sizes. 
</p>
</td></tr>
<tr><td><code id="homoStat_+3A_v">v</code></td>
<td>
<p>A vector of the sampling variance of the effect size for univariate
meta-analysis or a <code class="reqn">k</code> x <code class="reqn">p*</code> matrix of the sampling
covariance matrix of the effect sizes for multivariate meta-analysis
where <code class="reqn">p* = p(p+1)/2 </code>. It is arranged by column
major as used by <code><a href="OpenMx.html#topic+vech">vech</a></code>. It is assumed that
there is no missing value in <code>v</code> if <code>y</code> is complete. If there are missing values in <code>v</code>
due to the missingness on <code>y</code>, the missing values in
<code>v</code> will be removed automatically.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of
</p>
<table>
<tr><td><code>Q</code></td>
<td>
<p>Q statistic on the null hypothesis of homogeneity of effect
sizes. It has an approximate chi-square distribution under the null
hypothesis.</p>
</td></tr>
<tr><td><code>Q.df</code></td>
<td>
<p>Degrees of freedom of the Q statistic</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-value on the test of homogeneity of effect sizes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Becker, B. J. (1992). Using results from replicated studies to
estimate linear models. <em>Journal of Educational Statistics</em>,
<b>17</b>, 341-362. 
</p>
<p>Cheung, M. W.-L. (2010). Fixed-effects meta-analyses as multiple-group
structural equation models. <em>Structural Equation Modeling</em>,
<b>17</b>, 481-509.
</p>
<p>Cochran, W. G. (1954). The combination of estimates from different experiments. <em>Biometrics</em>, <b>10</b>, 101-129.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+meta">meta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>with( Hox02, homoStat(yi, vi) )

with( HedgesOlkin85, homoStat(y=cbind(d_att, d_ach),
      v=cbind(var_att, cov_att_ach, var_ach)) )
</code></pre>

<hr>
<h2 id='Hox02'>Simulated Effect Sizes Reported by Hox (2002)</h2><span id='topic+Hox02'></span>

<h3>Description</h3>

<p>Twenty stimulated studies on standardized mean difference and one
continuous study characteristic reported by Hox (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Hox02)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>study</dt><dd><p>Study number</p>
</dd>
<dt>yi</dt><dd><p>Effect size (standardized mean difference)</p>
</dd>
<dt>vi</dt><dd><p>Sampling variance of the effect size</p>
</dd>
<dt>weeks</dt><dd><p>Duration of the experimental intervention in terms of weeks</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hox, J. J. (2002). <em>Multilevel analysis: Techniques and applications.</em> Mahwah, N.J.: Lawrence Erlbaum Associates.
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2008). A model for integrating fixed-, random-, and mixed-effects meta-analyses into structural equation modeling. <em>Psychological Methods</em>, <b>13</b>, 182-202. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Hox02)

#### ML estimation method
## Random-effects meta-analysis
summary( meta(y=yi, v=vi, data=Hox02, I2=c("I2q", "I2hm"), intervals.type="LB") ) 

## Fixed-effects meta-analysis
summary( meta(y=yi, v=vi, data=Hox02, RE.constraints=0,
              model.name="Fixed effects model") )

## Mixed-effects meta-analysis with "weeks" as a predictor
## Request likelihood-based CI
summary( meta(y=yi, v=vi, x=weeks, data=Hox02, intervals.type="LB",
              model.name="Mixed effects meta analysis with LB CI") )

#### REML estimation method
## Random-effects meta-analysis with REML
summary( VarComp &lt;- reml(y=yi, v=vi, data=Hox02) )

## Extract the variance component
VarComp_REML &lt;- matrix( coef(VarComp), ncol=1, nrow=1 )

## Meta-analysis by treating the variance component as fixed
summary( meta(y=yi, v=vi, data=Hox02, RE.constraints=VarComp_REML) )


## Mixed-effects meta-analysis with "weeks" as a predictor
## Request Wald CI
summary( reml(y=yi, v=vi, x=weeks, intervals.type="z",
              data=Hox02, model.name="REML with LB CI") )

## End(Not run)
</code></pre>

<hr>
<h2 id='Hunter83'>Fourteen Studies of Correlation Matrices reported by Hunter (1983)
</h2><span id='topic+Hunter83'></span>

<h3>Description</h3>

<p>This dataset includes fourteen studies of Correlation Matrices reported by Hunter (1983)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Hunter83)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 14 studies of correlation matrices. The
variables are <em>Ability</em>, <em>Job knowledge</em>,
<em>Work sample</em> and <em>Supervisor rating</em></p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hunter, J. E. (1983). A causal analysis of cognitive ability, job knowledge, job performance, and supervisor ratings. In F. Landy, S. Zedeck, &amp; J. Cleveland (Eds.), <em>Performance Measurement and Theory</em> (pp. 257-266). Hillsdale, NJ: Erlbaum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Hunter83)

#### Fixed-effects model
## First stage analysis
fixed1 &lt;- tssem1(Hunter83$data, Hunter83$n, method="FEM",
                 model.name="TSSEM1 fixed effects model")
summary(fixed1)

#### Second stage analysis
## Model without direct effect from Ability to Supervisor
## A1 &lt;- create.mxMatrix(c(0,"0.1*A2J","0.1*A2W",0,0,0,"0.1*J2W","0.1*J2S",
##                         0,0,0,"0.1*W2S",0,0,0,0),
##                         type="Full", ncol=4, nrow=4, as.mxMatrix=FALSE)

## ## This step is not necessary but it is useful for inspecting the model.
## dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c("Ability","Job","Work","Supervisor") 
## A1

## S1 &lt;- create.mxMatrix(c(1,"0.1*Var_e_J", "0.1*Var_e_W", "0.1*Var_e_S"),
##                       type="Diag", as.mxMatrix=FALSE)
## dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c("Ability","Job","Work","Supervisor") 
## S1

################################################################################
## Model specification in lavaan model syntax
## The "ind" effect can be defined within the syntax
model1 &lt;- "## Regression paths
           Job_knowledge ~ A2J*Ability
           Work_sample ~ A2W*Ability + J2W*Job_knowledge
           Supervisor ~ J2S*Job_knowledge + W2S*Work_sample

           ## Fix the variance of Ability at 1
           Ability ~~ 1*Ability

           ## Label the error variances of the dependent variables
           Job_knowledge ~~ VarE_J*Job_knowledge
           Work_sample ~~ VarE_W*Work_sample
           Supervisor ~~ VarE_S*Supervisor

           ## Define an indirect effect
           ind := A2J*J2S+A2J*J2W*W2S+A2W*W2S"

## Display the model
plot(model1, layout="spring", sizeMan=10)

RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("Ability","Job_knowledge",
                   "Work_sample","Supervisor"))
RAM1

################################################################################
fixed2 &lt;- tssem2(fixed1, RAM=RAM1, intervals.type="z",
                 diag.constraints=FALSE,
                 model.name="TSSEM2 fixed effects model")
summary(fixed2)

## Display the model with the parameter estimates
plot(fixed2, layout="spring")

## Coefficients
coef(fixed2)

## VCOV based on parametric bootstrap
vcov(fixed2)

#### Random-effects model with diagonal elements only
## First stage analysis
random1 &lt;- tssem1(Hunter83$data, Hunter83$n, method="REM", RE.type="Diag", 
                  acov="weighted", model.name="TSSEM1 random effects model")
summary(random1)

model2 &lt;- "## Regression paths
           Job_knowledge ~ A2J*Ability
           Work_sample ~ A2W*Ability + J2W*Job_knowledge
           Supervisor ~ J2S*Job_knowledge + W2S*Work_sample

           ## Fix the variance of Ability at 1
           Ability ~~ 1*Ability

           ## Label the error variances of the dependent variables
           Job_knowledge ~~ VarE_J*Job_knowledge
           Work_sample ~~ VarE_W*Work_sample
           Supervisor ~~ VarE_S*Supervisor"

RAM2 &lt;- lavaan2RAM(model2, obs.variables=c("Ability","Job_knowledge",
                   "Work_sample","Supervisor"))
RAM2

## Second stage analysis
## Model without direct effect from Ability to Supervisor

## The "ind" effect is defined in tssem2().
random2 &lt;- tssem2(random1, RAM=RAM2, intervals.type="LB",
                  diag.constraints=FALSE,
                  mx.algebras=
                      list(ind=mxAlgebra(A2J*J2S+A2J*J2W*W2S+A2W*W2S, name="ind")),
                  model.name="TSSEM2 random effects model")
                  
summary(random2)

## Display the model with the parameter estimates
plot(random2, layout="spring")

## End(Not run)
</code></pre>

<hr>
<h2 id='impliedR'>Create or Generate the Model Implied Correlation or Covariance Matrices
</h2><span id='topic+impliedR'></span><span id='topic+rimpliedR'></span>

<h3>Description</h3>

<p>It creates or generates the model implied correlation or covariance
matrices based on the RAM model specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impliedR(RAM, Amatrix, Smatrix, Fmatrix, corr=TRUE, labels, ...)
rimpliedR(RAM, Amatrix, Smatrix, Fmatrix, AmatrixSD, SmatrixSD,
          k=1, corr=TRUE, nonPD.pop=c("replace", "nearPD", "accept"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impliedR_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>.
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_amatrix">Amatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Amatrix</code> is
required. An asymmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be
converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the
<code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_smatrix">Smatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Smatrix</code> is
required.A symmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be
converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the
<code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_fmatrix">Fmatrix</code></td>
<td>
<p>A filter matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is missing, an
identity matrix with the same dimensions of <code>Smatrix</code> will be
created, which means that all variables are observed. If it is a matrix, it will be converted into
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code>
function. It is not required when there is no latent variable.
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_amatrixsd">AmatrixSD</code></td>
<td>
<p>Standard deviations (SD) of the elements in the
<code>Amatrix</code>. If it is missing, a matrix of zero is created.</p>
</td></tr>
<tr><td><code id="impliedR_+3A_smatrixsd">SmatrixSD</code></td>
<td>
<p>Standard deviations (SD) of the elements in the
<code>Smatrix</code>. If it is missing, a matrix of zero is created.</p>
</td></tr>
<tr><td><code id="impliedR_+3A_k">k</code></td>
<td>
<p>Number of studies.</p>
</td></tr>  
<tr><td><code id="impliedR_+3A_corr">corr</code></td>
<td>
<p>Logical. The output is either the model implied
correlation matrix or the covariance matrix.
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_labels">labels</code></td>
<td>
<p>A character vector of the observed and latent
variables with the same dimensions as that in the <code>Amatrix</code> and
<code>Smatrix</code>. 
</p>
</td></tr>
<tr><td><code id="impliedR_+3A_nonpd.pop">nonPD.pop</code></td>
<td>
<p>If it is <code>replace</code>, generated non-positive
definite matrices are replaced by generated new ones which are
positive definite. If it is <code>nearPD</code>, they are replaced by
nearly positive definite matrices by calling
<code>Matrix::nearPD()</code>. If it is <code>accept</code>, they are accepted.</p>
</td></tr>
<tr><td><code id="impliedR_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to generate the model implied
correlation matrix for the standardized parameters with the
<code>corr=TRUE</code> argument. Suppose we want to calculate the
population correlation matrix for a mediation model with x, m, and
y. We only need to specify the population path coefficients among x,
m, and y in the <code>Amatrix</code>. We do not need to specify the
population error variances of m and y. We treat the error variances as
unknown parameters by giving them starting values in the
<code>Smatrix</code> matrix. When the covariance matrix is requested by
specifying <code>corr=FALSE</code>, it simply calculates the
population model covariance matrix by treating the values in
<code>Smatrix</code> as the population values.
</p>


<h3>Value</h3>

<p>A list of RAM matrices, the model implied correlation or
covariance matrix of the observed variables (<code>SigmaObs</code>), of both
observed and latent variables (<code>SigmaAll</code>), the minimum fit
(<code>minFit</code>) which should be zero, and the status code of the
optimization (<code>status</code>) which should also be zero when the
optimization is fine. The last object is <code>mx.fit</code> which is the output after running the
model. It can be used in the diagnosis.
</p>


<h3>Note</h3>

<p>It is important to ensure that all the population values in
<code>Amatrix</code> must be set as fixed parameters; otherwise, these
values may be altered with the <code>corr=TRUE</code> argument. When
there is an error or warning message about the status code, there is a
high chance that some of the values in <code>Amatrix</code> are incorrectly
set as free parameters.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)

## A simple mediation model
## All are population parameters in the A matrix
A1 &lt;- matrix(c(0, 0, 0,
               0.3, 0, 0,
               0.2, 0.4, 0), nrow=3, ncol=3, byrow=TRUE,
             dimnames=list(c("x", "m", "y"), c("x", "m", "y")))
A1             

## Variance of x is fixed at 1 while the other variances are free.
S1 &lt;- matrix(c(1, 0, 0,
               0, "0.1*ErrVarM",0,
               0, 0, "0.1*ErrVarY"), nrow=3, ncol=3,
             dimnames=list(c("x", "m", "y"), c("x", "m", "y")))
S1

impliedR(Amatrix=A1, Smatrix=S1)

## SD of A1
A1SD &lt;- matrix(c(0, 0, 0,
                 0.1, 0, 0,
                 0.1, 0.1, 0), nrow=3, ncol=3, byrow=TRUE,
               dimnames=list(c("x", "m", "y"), c("x", "m", "y")))
A1SD

rimpliedR(Amatrix=A1, Smatrix=S1, AmatrixSD=A1SD, k=2)

## A CFA model
A2 &lt;- matrix(c(0, 0, 0, 0.3,
               0, 0, 0, 0.4,
               0, 0, 0, 0.5,
               0, 0, 0, 0), nrow=4, ncol=4, byrow=TRUE,
             dimnames=list(c("x1", "x2", "x3", "f"),
                           c("x1", "x2", "x3", "f")))
A2

## Variance of f is fixed at 1 while the other variances are free.
S2 &lt;- matrix(c("0.7*Err1", 0, 0, 0,
                0, "0.7*Err2", 0, 0,
                0, 0, "0.7*Err3", 0,
                0, 0, 0, 1), nrow=4, ncol=4,
            dimnames=list(c("x1", "x2", "x3", "f"), c("x1", "x2", "x3", "f")))
S2

F2 &lt;- create.Fmatrix(c(1,1,1,0), as.mxMatrix=FALSE)
F2

## Model implied correlation matrix
impliedR(Amatrix=A2, Smatrix=S2, Fmatrix=F2, corr=TRUE)

## Model implied covariance matrix
impliedR(Amatrix=A2, Smatrix=S2, Fmatrix=F2, corr=FALSE)

## SD of A2
A2SD &lt;- matrix(c(0, 0, 0, 0.1,
                 0, 0, 0, 0.1,
                 0, 0, 0, 0.1,
                 0, 0, 0, 0), nrow=4, ncol=4, byrow=TRUE,
               dimnames=list(c("x1", "x2", "x3", "f"),
                             c("x1", "x2", "x3", "f")))               
A2SD

## SD of S2: correlated between x1 and x2
S2SD &lt;- matrix(c(0, 0.1, 0, 0,
                 0.1, 0, 0, 0,
                 0, 0, 0, 0.1,
                 0, 0, 0, 0), nrow=4, ncol=4, byrow=TRUE,
               dimnames=list(c("x1", "x2", "x3", "f"),
                             c("x1", "x2", "x3", "f")))               
S2SD

rimpliedR(Amatrix=A2, Smatrix=S2, Fmatrix=F2, AmatrixSD=A2SD,
          SmatrixSD=S2SD, k=2)
</code></pre>

<hr>
<h2 id='indirectEffect'>Estimate the asymptotic covariance matrix of standardized or unstandardized indirect and direct effects
</h2><span id='topic+indirectEffect'></span>

<h3>Description</h3>

<p>It estimates the standardized or unstandardized indirect and direct effects
and their asymptotic sampling covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indirectEffect(x, n, standardized = TRUE, direct.effect = TRUE, run = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indirectEffect_+3A_x">x</code></td>
<td>
<p>A 3x3 correlation/covariance matrix or a list of
correlation/covariance matrices. Variables are
arranged as the dependent variable (y), mediator (m) and independent
variable (x)
</p>
</td></tr>
<tr><td><code id="indirectEffect_+3A_n">n</code></td>
<td>
<p>Sample size or a vector of sample sizes
</p>
</td></tr>
<tr><td><code id="indirectEffect_+3A_standardized">standardized</code></td>
<td>
<p>Logical. Whether the indirect effect is
standardized.
</p>
</td></tr>
<tr><td><code id="indirectEffect_+3A_direct.effect">direct.effect</code></td>
<td>
<p>Logical. Whether the direct effect is
estimated. If it is <code>FALSE</code>, the direct effect is fixed at zero.
</p>
</td></tr>
<tr><td><code id="indirectEffect_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cheung (2009) estimated the standardized indirect effect and
its standard error with non-linear constraints. Since <code>OpenMx</code> does not generate standard errors when there
are non-linear constraints, Kwan and Chan's (2011) approach is used in
this function. Delta method is used to calculate the asymptotic covariance matrix.
</p>


<h3>Value</h3>

<p>A vector (or a matrix if the input is a list of matrices) of
(standardized) indirect effect, standardized direct effect, and their
asymptotic sampling covariance matrices
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2009). Comparison of methods for constructing confidence intervals of standardized indirect effects. <em>Behavior
Research Methods</em>, <em>41</em>, 425-438.
</p>
<p>Kwan, J., &amp; Chan, W. (2011). Comparing standardized coefficients in
structural equation modeling: a model reparameterization
approach. <em>Behavior Research Methods</em>, <em>43</em>, 730-745.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A correlation matrix as input
x &lt;- matrix(c(1, 0.4, 0.2, 0.4, 1, 0.3, 0.2, 0.3, 1), ncol=3)
dimnames(x) &lt;- list( c("y", "m", "x"), c("y", "m", "x") )
indirectEffect(x, n=300)

## A list of correlation matrices
indirectEffect( list(x, x), n=c(300,500), standardized=FALSE )
</code></pre>

<hr>
<h2 id='is.pd'>Test Positive Definiteness of a List of Square Matrices
</h2><span id='topic+is.pd'></span>

<h3>Description</h3>

<p>It tests the positive definiteness of a square matrix or a
list of square matrices. It returns <code>TRUE</code> if the matrix is
positive definite. It returns <code>FALSE</code> if the matrix is either
non-positive definite or not symmetric. Variables with <code>NA</code> in the diagonals will be removed
before testing. It returns <code>NA</code> when there are missing correlations even after deleting
the missing variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.pd(x, check.aCov=FALSE, cor.analysis=TRUE, tol=1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.pd_+3A_x">x</code></td>
<td>
<p>A square matrix or a list of square matrices</p>
</td></tr>
<tr><td><code id="is.pd_+3A_check.acov">check.aCov</code></td>
<td>
<p>If it is <code>TRUE</code>, it mirrors the checking in
<code><a href="#topic+asyCov">asyCov</a></code>.</p>
</td></tr>
<tr><td><code id="is.pd_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Whether the input matrix is a correlation or a
covariance matrix. It is ignored when <code>check.aCov=FALSE</code>.</p>
</td></tr>
<tr><td><code id="is.pd_+3A_tol">tol</code></td>
<td>
<p>Tolerance (relative to largest variance) for numerical lack
of positive-definiteness in <code>x</code>. It is adopted from <code><a href="MASS.html#topic+mvrnorm">mvrnorm</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the input is a matrix, it returns <code>TRUE</code>, <code>FALSE</code>
or <code>NA</code>. If the input is a list of matrices, it returns
a list of <code>TRUE</code>, <code>FALSE</code> or <code>NA</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- diag(1,3)
is.pd(A)
# TRUE

B &lt;- matrix(c(1,2,2,1), ncol=2)
is.pd(B)
# FALSE

is.pd(list(A, B))
# TRUE FALSE

C &lt;- A
C[2,1] &lt;- C[1,2] &lt;- NA
is.pd(C)
# NA
</code></pre>

<hr>
<h2 id='issp05'>A Dataset from ISSP (2005) 
</h2><span id='topic+issp05'></span>

<h3>Description</h3>

<p>Thirty-two covariance matrices on work-related attitudes
were extracted from the International Social Survey Programme 2005:
Work Orientation III (ISSP, 2005). Seven variables were selected for
demonstration purposes. They were grouped into three constructs:
<em>Importance of Job Prospects</em> measured by job security (JP1),
high income (JP2), and opportunity for advancement (JP3); <em>Importance
of Job Autonomy</em> measured by work independently (JA1) and decide time
of work (JA2); and <em>Importance of Contributions to Society</em> measured by help other
people (CS1) and a job useful to society (CS2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(issp05)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 32 covariance matrices </p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Source</h3>

<p>ISSP Research Group (2007): <em>International Social Survey Programme 2005: Work Orientation III (ISSP 2005)</em>. GESIS Data Archive, Cologne. ZA4350 Data file Version 1.0.0, doi:10.4232/1.4350</p>


<h3>See Also</h3>

 <p><code><a href="#topic+issp89">issp89</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(issp05)

#### Fixed-effects TSSEM
fixed1 &lt;- tssem1(issp05$data, issp05$n, method="FEM")
summary(fixed1)

## Prepare a model implied matrix
## Factor correlation matrix
Phi &lt;- create.mxMatrix( c("0.3*corf2f1","0.3*corf3f1","0.3*corf3f2"),
                        type="Stand", as.mxMatrix=FALSE )

## Error variances
Psi &lt;- create.mxMatrix( paste("0.2*e", 1:7, sep=""), type="Diag",
                        as.mxMatrix=FALSE )

## Create Smatrix
S1 &lt;- bdiagMat(list(Psi, Phi))
## dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c(paste("x",1:7,sep=""),
##                                             paste("f",1:3,sep=""))
## S1
S1 &lt;- as.mxMatrix(S1)

## Factor loadings
Lambda &lt;- create.mxMatrix( c(".3*f1x1",".3*f1x2",".3*f1x3",rep(0,7),
                             ".3*f2x4",".3*f2x5",rep(0,7),".3*f3x6",".3*f3x7"),
                           type="Full", ncol=3, nrow=7, as.mxMatrix=FALSE )
Zero1 &lt;- matrix(0, nrow=7, ncol=7)
Zero2 &lt;- matrix(0, nrow=3, ncol=10)

## Create Amatrix
A1 &lt;- rbind( cbind(Zero1, Lambda),
             Zero2 )
## dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c(paste("x",1:7,sep=""),
##                                             paste("f",1:3,sep=""))
## A1
A1 &lt;- as.mxMatrix(A1)

## Create Fmatrix
F1 &lt;- create.Fmatrix(c(rep(1,7), rep(0,3)))

#### Fixed-effects model: Stage 2 analysis
fixed2 &lt;- tssem2(fixed1, Amatrix=A1, Smatrix=S1, Fmatrix=F1,
                 intervals.type="LB")
summary(fixed2)

plot(fixed2, nDigits=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='issp89'>A Dataset from Cheung and Chan (2005; 2009) 
</h2><span id='topic+issp89'></span>

<h3>Description</h3>

<p>Eleven covariance matrices on work-related attitudes were
extracted from the Inter-University Consortium for Political and
Social Research (1989). Nine variables were selected by Cheung and
Chan (2005; 2009) for demonstration purposes. They were grouped into
three constructs: <em>Job Prospects</em> measured by job security
(JP1), income (JP2), and advancement opportunity (JP3); <em>Job Nature</em>
measured by interesting job (JN1), independent work (JN2), help
other people (JN3), and useful to society (JN4); and <em>Time Demand</em> measured by flexible working hours (TD1) and lots of leisure time (TD2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(issp89)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of 11 studies of covariance matrices </p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Source</h3>

<p>Inter-University Consortium for Political and Social Research. (1989). <em>International Social Survey Program: Work orientation</em>. Ann Arbor, MI: Author.</p>


<h3>References</h3>

<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation modeling: A two-stage approach. <em>Psychological Methods</em>, <b>10</b>, 40-64.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2009). A two-stage approach to synthesizing covariance matrices in meta-analytic structural equation modeling. <em>Structural Equation Modeling</em>, <b>16</b>, 28-53.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+issp05">issp05</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(issp89)

#### Analysis of correlation structure in Cheung and Chan (2005)
#### Fixed-effects model: Stage 1 analysis
cor1 &lt;- tssem1(issp89$data, issp89$n, method="FEM", cor.analysis=TRUE)
summary(cor1)
  
## Prepare a model implied matrix
## Factor correlation matrix
Phi &lt;- create.mxMatrix( c("0.3*corf2f1","0.3*corf3f1","0.3*corf3f2"),
                        type="Stand", as.mxMatrix=FALSE )
## Error variances
Psi &lt;- create.mxMatrix( paste("0.2*e", 1:9, sep=""), type="Diag",
                        as.mxMatrix=FALSE )

## Create Smatrix
S1 &lt;- bdiagMat(list(Psi, Phi))
## dimnames(S1)[[1]] &lt;- dimnames(S1)[[2]] &lt;- c(paste("x",1:9,sep=""),
##                                             paste("f",1:3,sep=""))
## S1
S1 &lt;- as.mxMatrix(S1)

## Factor loadings
Lambda &lt;- create.mxMatrix( c(".3*f1x1",".3*f1x2",".3*f1x3",rep(0,9),
                             ".3*f2x4",".3*f2x5",".3*f2x6",".3*f2x7",
                             rep(0,9),".3*f3x8",".3*f3x9"), type="Full",
                             ncol=3, nrow=9, as.mxMatrix=FALSE )
Zero1 &lt;- matrix(0, nrow=9, ncol=9)
Zero2 &lt;- matrix(0, nrow=3, ncol=12)

## Create Amatrix
A1 &lt;- rbind( cbind(Zero1, Lambda),
             Zero2 )
## dimnames(A1)[[1]] &lt;- dimnames(A1)[[2]] &lt;- c(paste("x",1:9,sep=""),
##                                             paste("f",1:3,sep=""))
## A1
A1 &lt;- as.mxMatrix(A1)

## Create Fmatrix
F1 &lt;- create.Fmatrix(c(rep(1,9), rep(0,3)))
  
#### Fixed-effects model: Stage 2 analysis
cor2 &lt;- tssem2(cor1, Amatrix=A1, Smatrix=S1, Fmatrix=F1, intervals.type="LB")
summary(cor2)

## Display the model with the parameter estimates
plot(cor2, nDigits=1)

#### Analysis of covariance structure in Cheung and Chan (2009)
#### Fixed-effects model: Stage 1 analysis
cov1 &lt;- tssem1(issp89$data, issp89$n, method="FEM", cor.analysis=FALSE)
summary(cov1)
  
#### Fixed-effects model: Stage 2 analysis
cov2 &lt;- tssem2(cov1, Amatrix=A1, Smatrix=S1, Fmatrix=F1)              
summary(cov2)

## Display the model with the parameter estimates
plot(cov2, nDigits=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='Jaramillo05'>Dataset from Jaramillo, Mulki &amp; Marshall (2005)
</h2><span id='topic+Jaramillo05'></span>

<h3>Description</h3>

<p>A dataset of the relationship between organizational
commitment (OC) and salesperson job performance (JP) from Jaramillo, Mulki &amp; Marshall (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Jaramillo05)</code></pre>


<h3>Format</h3>

<p>A data frame with 61 observations on the following 10 variables.
</p>

<dl>
<dt><code>Author</code></dt><dd><p>a character vector of study</p>
</dd>
<dt><code>Sample_size</code></dt><dd><p>sample size of the study</p>
</dd>
<dt><code>Sales</code></dt><dd><p>sample type; either &quot;mixed&quot;, &quot;nonsales&quot; or &quot;sales&quot;</p>
</dd>
<dt><code>Country</code></dt><dd><p>a character vector of country of study</p>
</dd>
<dt><code>IDV</code></dt><dd><p>Hofstede's (1997) individualism index</p>
</dd>
<dt><code>OC_scale</code></dt><dd><p>scale of OC; either &quot;Porter or Mowday&quot;,
&quot;Meyer&quot; or &quot;other&quot;</p>
</dd>
<dt><code>OC_alpha</code></dt><dd><p>Coefficient alpha of organizational commitment</p>
</dd>
<dt><code>JP_alpha</code></dt><dd><p>Coefficient alpha of job performance</p>
</dd>
<dt><code>r</code></dt><dd><p>correlation between organizational commitment and
job performance</p>
</dd>
<dt><code>r_v</code></dt><dd><p>sampling variance of r</p>
</dd>
</dl>



<h3>Source</h3>

<p>Jaramillo, F., Mulki, J. P., &amp; Marshall, G. W. (2005). A meta-analysis of the relationship between organizational commitment and salesperson job performance: 25 years of research. <em>Journal of Business Research</em>, <b>58(6)</b>, 705-714. doi:10.1016/j.jbusres.2003.10.004
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Research question 4.4.1
summary(meta(r, r_v, data=Jaramillo05))

## Research question 4.4.2
## Select cases with either "sales" or "nonsales"
Sales.df &lt;- subset(Jaramillo05, Sales %in% c("sales", "nonsales"))

## Create a predictor with 1 and 0 when they are "sales" or "nonsales", respectively
predictor &lt;- ifelse(Jaramillo05$Sales=="sales", yes=1, no=0)

## Mixed-effects meta-analysis
summary( meta(y = r, v = r_v, x = predictor, data = Jaramillo05) )

## Research question 4.4.3
summary(meta(r, r_v, x=IDV, data=Jaramillo05))

## End(Not run)
</code></pre>

<hr>
<h2 id='Kalaian96'>Multivariate effect sizes reported by Kalaian and Raudenbush (1996)
</h2><span id='topic+Kalaian96'></span>

<h3>Description</h3>

<p>This data set includes 47 multivariate effect sizes reported by
Kalaian and Raudenbush (1996, Table 1). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Kalaian96)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>Study</dt><dd><p>Study name</p>
</dd>
<dt>Year</dt><dd><p>Year of publication</p>
</dd>
<dt>n_e</dt><dd><p>Sample size of the experimental group</p>
</dd>
<dt>n_c</dt><dd><p>Sample size of the control group</p>
</dd>
<dt>dSAT_V</dt><dd><p>Standardized mean difference of the Scholastic Aptitude
Test (SAT) on verbal</p>
</dd>
<dt>dSAT_M</dt><dd><p>Standardized mean difference of SAT on math</p>
</dd>
<dt>var_V</dt><dd><p>Sampling variance of <code>dSAT_V</code></p>
</dd>
<dt>cov_VM</dt><dd><p>Sampling covariance of <code>dSAT_V</code> and <code>dSAT_M</code>
with a common correlation of 0.66</p>
</dd>
<dt>var_M</dt><dd><p>Sampling variance of <code>dSAT_M</code></p>
</dd>
<dt>Hr</dt><dd><p>Hours of training</p>
</dd>
<dt>ETS</dt><dd><p>Educational Testing Service</p>
</dd>
<dt>Study_type</dt><dd><p>Either <code>Randomized</code>, <code>Matched</code> or
<code>Nonequivalent comparison</code></p>
</dd>
<dt>Home_work</dt><dd><p>Home work</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kalaian, H. A., &amp; Raudenbush, S. W. (1996). A multivariate mixed linear model for meta-analysis. <em>Psychological Methods</em>, <em>1</em>(3), 227-235. https://doi.org/10.1037/1082-989X.1.3.227
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Kalaian96)

## End(Not run)
</code></pre>

<hr>
<h2 id='lavaan2RAM'>
Convert <code>lavaan</code> models to RAM models
</h2><span id='topic+lavaan2RAM'></span>

<h3>Description</h3>

<p>It converts models specified in <code>lavaan</code> model syntax to RAM models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lavaan2RAM(model, obs.variables = NULL, A.notation = "ON",
           S.notation = "WITH", M.notation = "mean",
           A.start=0.1, S.start=0.5, M.start=0,
           auto.var = TRUE, std.lv = TRUE, ngroups = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lavaan2RAM_+3A_model">model</code></td>
<td>
<p>A character string of model using the lavaan model syntax.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_obs.variables">obs.variables</code></td>
<td>
<p>A character vector of the observed variables. The
observed variables in the RAM specification will follow the order
specified in <code>obs.variables</code>. It is important to check whether the
order of the observed variables matches the order in the dataset. 
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_a.notation">A.notation</code></td>
<td>
<p>A character string to be used in the A matrix if the labels
are not included in the lavaan model. For example, the label will be &quot;yONx&quot; for
regressing &quot;y&quot; on &quot;x&quot;.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_s.notation">S.notation</code></td>
<td>
<p>A character string to be used in the S matrix if the labels
are not included in the lavaan model. For example, the label will be &quot;yWITHx&quot; for
the covariance between &quot;y&quot; with &quot;x&quot; and &quot;yWITHy&quot; for the (error) variance
of &quot;y&quot;. 
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_m.notation">M.notation</code></td>
<td>
<p>A character string to be used in the M matrix if the labels
are not included in the lavaan model. For example, the label will be &quot;ymean&quot; for
the mean of &quot;y&quot; if <code>M.notation="mean"</code>. 
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_a.start">A.start</code></td>
<td>
<p>A numeric value of starting value for the <code>Amatrix</code>
when the starting values are not provided.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_s.start">S.start</code></td>
<td>
<p>A numeric value of starting value for the <code>Smatrix</code>
when the starting values are not provided.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_m.start">M.start</code></td>
<td>
<p>A numeric value of starting value for the <code>Mmatrix</code>
when the starting values are not provided.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_auto.var">auto.var</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the residual variances and the
variances of exogenous latent variables are included in the model and
set free. See <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code>.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_std.lv">std.lv</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the metric of each latent
variable is determined by fixing their variances to 1.0. If FALSE, the
metric of each latent variable is determined by fixing the factor
loading of the first indicator to 1.0. See <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code>.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_ngroups">ngroups</code></td>
<td>
<p>Number. The number of groups in the <code>model</code>. See <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code>.
</p>
</td></tr>
<tr><td><code id="lavaan2RAM_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code></p>
</td></tr></table>
<p>. Please note that <code>fixed.x</code> is set at <code>FALSE</code>. Thus it cannot be passed to ....
</p>


<h3>Details</h3>

<p>It uses the <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code> to do the
conversion. Experimental: functions of parameters (':=' in lavaan) and
constraints ('==', '&gt;', and '&lt;' in lavaan) will be converted to
mxAlgebra and mxConstraint in OpenMx. As there are differences between
lavaan and OpenMx, they may not work properly.
</p>


<h3>Value</h3>

<p>A list of RAM specification with <code>A</code>, <code>S</code>, <code>F</code>, and <code>M</code> matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

<p><code><a href="semPlot.html#topic+ramModel">ramModel</a></code>,
<code><a href="#topic+Becker92">Becker92</a></code>, <code><a href="#topic+Becker09">Becker09</a></code>,
<code><a href="#topic+Digman97">Digman97</a></code>, <code><a href="#topic+Hunter83">Hunter83</a></code>,
<code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>,
<code><a href="#topic+checkRAM">checkRAM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Regression model on correlation matrix
model1 &lt;- "## y is modelled by x1, x2, and x3
           y ~ b1*x1 + b2*x2 + b3*x3
           ## Fix the independent variables at 1
           x1 ~~ 1*x1
           x2 ~~ 1*x2
           x3 ~~ 1*x3
           ## Declare the correlations among the independent variables
           x1 ~~ x2
           x1 ~~ x3
           x2 ~~ x3
           ## Constraint
           b3 == b1 + b2
           ## Function of parameters
           fn1 := b1*b2^b3"

## Compare the arrangements of variables with and without
## specifying the obs.variables arguments. 
lavaan2RAM(model1, obs.variables=c("y", "x1", "x2", "x3"))

## Two-factor CFA model
model2 &lt;- "f1 =~ x1 + x2 + x3
           f2 =~ x4 + x5 + x6
           ## Declare the correlation between f1 and f2
           ## and label it with cor_f1f2
           f1 ~~ cor_f1f2*f2"

lavaan2RAM(model2)

## Regression model with the mean structure
model3 &lt;- "y ~ x
           ## Intercept of y
           y ~ 1
           ## Mean of x
           x ~ 1"

lavaan2RAM(model3)

## Multiple group regression model
## Different intercepts with a common slope
model4 &lt;- "y ~ c(a1, a2)*1 + c(b, b)*x"

lavaan2RAM(model4, ngroups=2)
</code></pre>

<hr>
<h2 id='list2matrix'>Convert a List of Symmetric Matrices into a Stacked Matrix
</h2><span id='topic+list2matrix'></span>

<h3>Description</h3>

<p>It converts a list of symmetric matrices into
a stacked matrix. Dimensions of the symmetric matrices have to be the
same. It tries to preserve the dimension names if possible. Dimension names will
be created if there are no dimension names in the first symmetric matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list2matrix(x, diag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list2matrix_+3A_x">x</code></td>
<td>
<p>A list of <code class="reqn">k</code> <code class="reqn">p</code> x <code class="reqn">p</code> symmetric matrices.
</p>
</td></tr>
<tr><td><code id="list2matrix_+3A_diag">diag</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, <code><a href="OpenMx.html#topic+vech">vech</a></code>
is used to vectorize the (covariance) matrices. If it is <code>FALSE</code>, <code><a href="OpenMx.html#topic+vechs">vechs</a></code>
is used to vectorize the (correlation) matrices.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">k</code> x <code class="reqn">p*</code> stacked matrix where <code class="reqn">p* = p(p-1)/2 </code> for <code>diag</code>=<code>FALSE</code> or <code class="reqn">p* = p(p+1)/2
  </code> for <code>diag</code>=<code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>C1 &lt;- matrix(c(1,0.5,0.4,0.5,1,0.2,0.4,0.2,1), ncol=3)  
C2 &lt;- matrix(c(1,0.4,NA,0.4,1,NA,NA,NA,NA), ncol=3)  

## A list without dimension names 
list2matrix(list(C1, C2))
#      x2_x1 x3_x1 x3_x2
# [1,]   0.5   0.4   0.2
# [2,]   0.4    NA    NA

dimnames(C1) &lt;- list( c("x","y","z"), c("x","y","z") )
dimnames(C2) &lt;- list( c("x","y","z"), c("x","y","z") )

## A list with dimension names
list2matrix(list(C1, C2))
#      y_x z_x z_y
# [1,] 0.5 0.4 0.2
# [2,] 0.4  NA  NA
</code></pre>

<hr>
<h2 id='Mak09'>Eight studies from Mak et al. (2009)</h2><span id='topic+Mak09'></span>

<h3>Description</h3>

<p>Eight studies from Mak et al. (2009) were reported by Cheung et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Mak09)</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 10 variables.
</p>

<dl>
<dt><code>Study</code></dt><dd><p>a character vector of study</p>
</dd>
<dt><code>type</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>AF.BP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Tot.BP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>AF.non.BP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Tot.non.BP</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>yi</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>vi</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>age.mean</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>study.duration</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mak, A., Cheung, M. W.-L., Ho, R. C. M., Cheak, A. A. C., &amp; Lau,
C. S. (2009). Bisphosphonate and atrial fibrillation: Bayesian
meta-analyses of randomized controlled trials and observational
studies. <em>BMC Musculoskeletal Disorders</em>,
<b>10(113)</b>. doi:10.1186/1471-2474-10-113 Available at <a href="https://bmcmusculoskeletdisord.biomedcentral.com/articles/10.1186/1471-2474-10-113">https://bmcmusculoskeletdisord.biomedcentral.com/articles/10.1186/1471-2474-10-113</a>.
</p>


<h3>References</h3>

<p>Cheung, M. W.-L., Ho, R. C. M., Lim, Y., &amp; Mak, A. (2012). Conducting a
meta-analysis: Basics and good practices. <em>International Journal
of Rheumatic Diseases</em>, <b>15(2)</b>, 129-135. doi: 10.1111/j.1756-185X.2012.01712.x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Random-effects meta-analysis
( meta1 &lt;- summary(meta(y=yi, v=vi, data=Mak09, I2=c("I2q", "I2hm"))) )

## Convert the estimates back into odds ratio 
OR &lt;- with(coef(meta1), exp(c(Estimate[1], lbound[1], ubound[1])))
names(OR) &lt;- c("Estimate in OR", "lbound in OR", "ubound in OR")
OR
  
## Mixed-effects meta-analysis with mean age as a predictor
summary( meta(y=yi, v=vi, x=age.mean, data=Mak09) )
</code></pre>

<hr>
<h2 id='Mathieu15'>Correlation Matrices from Mathieu et al. (2015)</h2><span id='topic+Mathieu15'></span>

<h3>Description</h3>

<p>The data set includes a list of correlation matrices of panel studies between
cohesion (C) and performance (P) in Mathieu et al. (2015,  Table 1). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Mathieu15)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of studies of correlation matrices. The
variables are <em>C1</em>, <em>P1</em>, <em>C2</em>, and <em>P2</em>.</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes.</p>
</dd>
<dt>Year</dt><dd><p>Year of publication.</p>
</dd>
<dt>Sample</dt><dd><p>Sample characteristics.</p>
</dd>
<dt>Student</dt><dd><p>Whether the samples are student or non-student based on
<code>Sample</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mathieu, J. E., Kukenberger, M. R., D'Innocenzo, L., &amp; Reilly, G. (2015). Modeling reciprocal team cohesion-performance relationships, as impacted by shared leadership and members' competence. <em>Journal of Applied Psychology</em>, <b>100</b>(3), 713-734. https://doi.org/10.1037/a0038898
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# TSSEM
## Model 1: no constraint
## Stage 1 analysis
tssem1.fit &lt;- tssem1(Mathieu15$data, Mathieu15$n)
summary(tssem1.fit)

## Proposed model in lavaan syntax
model1 &lt;- 'C2 ~ c2c*C1 + p2c*P1
           P2 ~ c2p*C1 + p2p*P1
           C1 ~~ c1withp1*P1
           C1 ~~ 1*C1
           P1 ~~ 1*P1
           C2 ~~ c2withp2*P2'

## Convert the lavaan model to RAM specification
RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("C1", "P1", "C2", "P2"))
RAM1

## Stage 2 analysis
tssem1b.fit &lt;- tssem2(tssem1.fit, RAM=RAM1)
summary(tssem1b.fit)

plot(tssem1b.fit, col="yellow", edge.label.position=0.58)

## Model 2: Equality constraints on the path coefficient
## Proposed model with equal effects time 1 to time 2
model2 &lt;- 'C2 ~ same*C1 + diff*P1
           P2 ~ diff*C1 + same*P1
           C1 ~~ c1withp1*P1
           C1 ~~ 1*C1
           P1 ~~ 1*P1
           C2 ~~ c2withp2*P2'

## Convert the lavaan model to RAM specification
RAM2 &lt;- lavaan2RAM(model2, obs.variables=c("C1", "P1", "C2", "P2"))
RAM2
    
## Stage 2 analysis
tssem2b.fit &lt;- tssem2(tssem1.fit, RAM=RAM2)
summary(tssem2b.fit)

## Compare the models with and without the constraints. 
anova(tssem1b.fit, tssem2b.fit)

## Plot the model
plot(tssem2b.fit, col="yellow", edge.label.position=0.60)


## OSMASEM
my.df &lt;- Cor2DataFrame(Mathieu15)
    
head(my.df$data)

## Model without any moderator
osmasem.fit1 &lt;- osmasem(model.name="No moderator", RAM=RAM1, data=my.df)
summary(osmasem.fit1)

## Extract the heterogeneity variance-covariance matrix
diag(VarCorr(osmasem.fit1))

plot(osmasem.fit1, col="yellow", edge.label.position=0.6)

## Model with student sample as a moderator on the regression coefficients
A1 &lt;- create.modMatrix(RAM1, output="A", "Student")
A1

## Model with a moderator    
osmasem.fit2 &lt;- osmasem(model.name="Student sample as a moderator", RAM=RAM1, 
                        Ax=A1, data=my.df)
summary(osmasem.fit2)

## Compare the models with and without the moderator
anova(osmasem.fit2, osmasem.fit1)

## Get the R2 of the moderator
osmasemR2(osmasem.fit2, osmasem.fit1)

## End(Not run)
</code></pre>

<hr>
<h2 id='matrix2bdiag'>Convert a Matrix into a Block Diagonal Matrix
</h2><span id='topic+matrix2bdiag'></span>

<h3>Description</h3>

<p>It converts a matrix into a block diagonal matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix2bdiag(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix2bdiag_+3A_x">x</code></td>
<td>
<p>A <code class="reqn">k</code> x <code class="reqn">p</code> matrix of numerics or characters. 
</p>
</td></tr>
<tr><td><code id="matrix2bdiag_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="#topic+vec2symMat">vec2symMat</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each row of <code>x</code> is converted into a symmetric matrix via
<code><a href="#topic+vec2symMat">vec2symMat</a></code>. Then the list of the symmetric matrices is
converted into a block diagonal matrix via a function written by Scott
Chasalow posted at http://www.math.yorku.ca/Who/Faculty/Monette/pub/stmp/0827.html.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+vec2symMat">vec2symMat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(m1 &lt;- matrix(1:12, ncol=6, byrow=TRUE))
#      [,1] [,2] [,3] [,4] [,5] [,6]
# [1,]    1    2    3    4    5    6
# [2,]    7    8    9   10   11   12

matrix2bdiag(m1)
#      [,1] [,2] [,3] [,4] [,5] [,6]
# [1,]    1    2    3    0    0    0
# [2,]    2    4    5    0    0    0
# [3,]    3    5    6    0    0    0
# [4,]    0    0    0    7    8    9
# [5,]    0    0    0    8   10   11
# [6,]    0    0    0    9   11   12
</code></pre>

<hr>
<h2 id='meta'>Univariate and Multivariate Meta-Analysis with Maximum
Likelihood Estimation
</h2><span id='topic+meta'></span><span id='topic+metaFIML'></span>

<h3>Description</h3>

<p>It conducts univariate and multivariate meta-analysis with maximum
likelihood estimation method. Mixed-effects meta-analysis can be
conducted by including study characteristics as predictors. Equality constraints on
intercepts, regression coefficients, and variance components can be
easily imposed by setting the same labels on the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta(y, v, x, data, intercept.constraints = NULL, coef.constraints = NULL,
     RE.constraints = NULL, RE.startvalues=0.1, RE.lbound = 1e-10,
     intervals.type = c("z", "LB"), I2="I2q", R2=TRUE,
     model.name="Meta analysis with ML", suppressWarnings = TRUE,
     silent = TRUE, run = TRUE, ...)
metaFIML(y, v, x, av, data, intercept.constraints=NULL,
         coef.constraints=NULL, RE.constraints=NULL,
         RE.startvalues=0.1, RE.lbound=1e-10,
         intervals.type=c("z", "LB"), R2=TRUE,
         model.name="Meta analysis with FIML",
         suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta_+3A_y">y</code></td>
<td>
<p>A vector of effect size for univariate meta-analysis or a <code class="reqn">k</code> x
<code class="reqn">p</code> matrix of effect sizes for multivariate meta-analysis
where <code class="reqn">k</code> is the number of studies and <code class="reqn">p</code> is the
number of effect sizes. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_v">v</code></td>
<td>
<p>A vector of the sampling variance of the effect size for univariate
meta-analysis or a <code class="reqn">k</code> x <code class="reqn">p*</code> matrix of the sampling
covariance matrix of the effect sizes for multivariate meta-analysis
where <code class="reqn">p* = p(p+1)/2 </code>. It is arranged by column
major as used by <code><a href="OpenMx.html#topic+vech">vech</a></code>.
</p>
</td></tr>
<tr><td><code id="meta_+3A_x">x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of predictors
where <code class="reqn">m</code> is the number of predictors. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_av">av</code></td>
<td>
<p>An auxiliary variable or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of auxiliary variables
where <code class="reqn">m</code> is the number of auxiliary variables. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td></tr>
<tr><td><code id="meta_+3A_intercept.constraints">intercept.constraints</code></td>
<td>
<p>A <code class="reqn">1</code> x <code class="reqn">p</code> matrix
specifying whether the intercepts of the effect sizes are fixed or
free. If the input is not a matrix, the input is converted into a
<code class="reqn">1</code> x <code class="reqn">p</code> matrix with
<code>t(as.matrix(intercept.constraints))</code>. The default is that the intercepts are free. When there is no predictor, these intercepts are the same as
the pooled effect sizes. The format of this matrix follows
<code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. The intercepts can be
constrained equally by using the same labels.
</p>
</td></tr>
<tr><td><code id="meta_+3A_coef.constraints">coef.constraints</code></td>
<td>
<p>A <code class="reqn">p</code> x <code class="reqn">m</code> matrix
specifying how the predictors predict the effect sizes. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default is that all <code class="reqn">m</code> predictors predict all <code class="reqn">p</code> effect sizes. The
format of this matrix follows
<code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. The regression coefficients can be
constrained equally by using the same labels.
</p>
</td></tr>
<tr><td><code id="meta_+3A_re.constraints">RE.constraints</code></td>
<td>
<p>A <code class="reqn">p</code> x <code class="reqn">p</code> matrix
specifying the variance components of the random effects. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default is that all
covariance/variance components are free. The format of this matrix
follows <code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. Elements of the variance
components can be constrained equally by using the same labels. If a zero matrix is
specified, it becomes a fixed-effects meta-analysis.
</p>
</td></tr>
<tr><td><code id="meta_+3A_re.startvalues">RE.startvalues</code></td>
<td>
<p>A vector of <code class="reqn">p</code> starting values on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be duplicated across the diagonals. Starting values for the
off-diagonals of the variance component are all 0. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of starting values is also accepted. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_re.lbound">RE.lbound</code></td>
<td>
<p>A vector of <code class="reqn">p</code> lower bounds on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be duplicated across the diagonals. Lower
bounds for the off-diagonals of the variance component are set at <code>NA</code>. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of the lower bounds is also accepted.
</p>
</td></tr>
<tr><td><code id="meta_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td></tr>
<tr><td><code id="meta_+3A_i2">I2</code></td>
<td>
<p>Possible options are <code>"I2q"</code>, <code>"I2hm"</code> and
<code>"I2am"</code>. They represent the <code>I2</code> calculated by using a
typical within-study sampling variance from the Q statistic, the
harmonic mean and the arithmetic mean of the within-study sampling
variances (Xiong, Miller, &amp; Morris, 2010). More than one options are possible. If <code>intervals.type="LB"</code>, 95% confidence intervals on the heterogeneity indices will be constructed. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_r2">R2</code></td>
<td>
<p>Logical. If <code>TRUE</code> and there are predictors, R2 is
calculated (Raudenbush, 2009). 
</p>
</td></tr>
<tr><td><code id="meta_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>
<tr><td><code id="meta_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. The argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="meta_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="meta_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr> 
<tr><td><code id="meta_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>    
</table>


<h3>Value</h3>

<p>An object of class <code>meta</code> with a list of
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Object returned by <code><a href="base.html#topic+match.call">match.call</a></code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A data matrix of y, v and x  </p>
</td></tr>
<tr><td><code>no.y</code></td>
<td>
<p>No. of effect sizes</p>
</td></tr>
<tr><td><code>no.x</code></td>
<td>
<p>No. of predictors</p>
</td></tr>
<tr><td><code>miss.x</code></td>
<td>
<p>A vector indicating whether the predictors are
missing. Studies will be removed before the analysis if they are
<code>TRUE</code></p>
</td></tr>
<tr><td><code>I2</code></td>
<td>
<p>Types of I2 calculated</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p>Logical</p>
</td></tr>
<tr><td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code>mx0.fit</code></td>
<td>
<p>A fitted object without any predictor returned from
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Missing values (NA) in y and their related elements in v
will be removed automatically. When there are missing values in v but
not in y, missing values will be replaced by 1e5. Effectively, these
effect sizes will have little impact on the
analysis. <code>metaFIML()</code> uses FIML to handle missing covariates in
X. It is experimental. It may not be stable.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2008). A model for integrating fixed-, random-, and
mixed-effects meta-analyses into structural equation
modeling. <em>Psychological Methods</em>, <b>13</b>, 182-202.
</p>
<p>Cheung, M. W.-L. (2009). Constructing approximate confidence intervals
for parameters with structural equation models. <em>Structural
Equation Modeling</em>, <b>16</b>, 267-294.
</p>
<p>Cheung, M. W.-L. (2013). Multivariate meta-analysis as structural equation models. <em>Structural Equation Modeling</em>, <b>20</b>, 429-454.
</p>
<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Hardy, R. J., &amp; Thompson, S. G. (1996). A likelihood approach to
meta-analysis with random effects. <em>Statistics in Medicine</em>,
<b>15</b>, 619-629.
</p>
<p>Neale, M. C., &amp; Miller, M. B. (1997). The use of likelihood-based
confidence intervals in genetic models. <em>Behavior Genetics</em>,
<b>27</b>, 113-120.
</p>
<p>Raudenbush, S. W. (2009). Analyzing effect sizes: random effects models. In H. M. Cooper, L. V. Hedges, &amp; J. C. Valentine (Eds.), <em>The handbook of research synthesis and meta-analysis</em> (2nd ed., pp. 295-315). New York: Russell Sage Foundation.
</p>
<p>Xiong, C., Miller, J. P., &amp; Morris, J. C. (2010). Measuring study-specific heterogeneity in meta-analysis: application to an antecedent biomarker study of Alzheimer's disease. <em>Statistics in Biopharmaceutical Research</em>, <b>2(3)</b>, 300-309. doi:10.1198/sbr.2009.0067
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reml">reml</a></code>, <code><a href="#topic+Hox02">Hox02</a></code>,
<code><a href="#topic+Berkey98">Berkey98</a></code>, <code><a href="#topic+wvs94a">wvs94a</a></code>
</p>

<hr>
<h2 id='meta2semPlot'>
Convert <code>metaSEM</code> objects into <code>semPlotModel</code> objects for plotting
</h2><span id='topic+meta2semPlot'></span>

<h3>Description</h3>

<p>It converts objects in class <code>wls</code> into objects of class <code>semPlotModel</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meta2semPlot(object, manNames = NULL, latNames = NULL, labels = c("labels", "RAM"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta2semPlot_+3A_object">object</code></td>
<td>
<p>An object of class <code>wls</code> returned from <code>wls()</code>
or <code>tssem2()</code>.
</p>
</td></tr>
<tr><td><code id="meta2semPlot_+3A_mannames">manNames</code></td>
<td>
<p>A character vector of the manifest names. The program
will try to get it from the <code>object</code> if it is not given. 
</p>
</td></tr>
<tr><td><code id="meta2semPlot_+3A_latnames">latNames</code></td>
<td>
<p>A character vector of the latent names. The program
will create it by using &quot;L1&quot;, &quot;L2&quot;, etc if it is not given. 
</p>
</td></tr>
<tr><td><code id="meta2semPlot_+3A_labels">labels</code></td>
<td>
<p>Either <code>labels</code> (default if missing) or
<code>RAM</code>. If <code>labels</code>, the labels of the parameters are used
in plotting. If <code>RAM</code>, the RAM notations are used in plotting.
</p>
</td></tr>
<tr><td><code id="meta2semPlot_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="semPlot.html#topic+ramModel">ramModel</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It uses the <code>ramModel()</code> to do the conversion.
</p>


<h3>Value</h3>

<p>A &quot;semPlotModel&quot; object.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

<p><code><a href="semPlot.html#topic+ramModel">ramModel</a></code>,
<code><a href="#topic+Becker92">Becker92</a></code>, <code><a href="#topic+Becker09">Becker09</a></code>,
<code><a href="#topic+Digman97">Digman97</a></code>, <code><a href="#topic+Hunter83">Hunter83</a></code>
</p>

<hr>
<h2 id='meta3L'>Three-Level Univariate Meta-Analysis with Maximum Likelihood Estimation
</h2><span id='topic+meta3'></span><span id='topic+meta3X'></span><span id='topic+meta3L'></span><span id='topic+meta3LFIML'></span>

<h3>Description</h3>

<p>It conducts three-level univariate meta-analysis with maximum
likelihood estimation method. Mixed-effects meta-analysis can be conducted by
including study characteristics as predictors. Equality constraints on
the intercepts, regression coefficients and variance components on the level-2
and on the level-3 can be easily imposed by setting the same labels on the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Depreciated in the future
meta3(y, v, cluster, x, data, intercept.constraints = NULL,
      coef.constraints = NULL , RE2.constraints = NULL,
      RE2.lbound = 1e-10, RE3.constraints = NULL, RE3.lbound = 1e-10,
      intervals.type = c("z", "LB"), I2="I2q",
      R2=TRUE, model.name = "Meta analysis with ML",
      suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
## Depreciated in the future
meta3X(y, v, cluster, x2, x3, av2, av3, data, intercept.constraints=NULL,
       coef.constraints=NULL, RE2.constraints=NULL, RE2.lbound=1e-10,
       RE3.constraints=NULL, RE3.lbound=1e-10, intervals.type=c("z", "LB"),
       R2=TRUE, model.name="Meta analysis with ML",
       suppressWarnings=TRUE, silent = TRUE, run = TRUE, ...)
meta3L(y, v, cluster, x, data, intercept.constraints = NULL,
      coef.constraints = NULL , RE2.constraints = NULL,
      RE2.lbound = 1e-10, RE3.constraints = NULL, RE3.lbound = 1e-10,
      intervals.type = c("z", "LB"), I2="I2q",
      R2=TRUE, model.name = "Meta analysis with ML",
      suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
meta3LFIML(y, v, cluster, x2, x3, av2, av3, data, intercept.constraints=NULL,
       coef.constraints=NULL, RE2.constraints=NULL, RE2.lbound=1e-10,
       RE3.constraints=NULL, RE3.lbound=1e-10, intervals.type=c("z", "LB"),
       R2=TRUE, model.name="Meta analysis with ML",
       suppressWarnings=TRUE, silent = TRUE, run = TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meta3L_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of effect size. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_v">v</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of sampling variance.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_cluster">cluster</code></td>
<td>
<p>A vector of <code class="reqn">k</code> string or number indicating the
clusters. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_x">x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
and level-3 predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_x2">x2</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_x3">x3</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-3
predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_av2">av2</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
auxiliary variables where <code class="reqn">m</code> is the number of variables. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_av3">av3</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-3
auxiliary variables where <code class="reqn">m</code> is the number of variables. 
</p>
</td></tr>    
<tr><td><code id="meta3L_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_intercept.constraints">intercept.constraints</code></td>
<td>
<p>A <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying whether the intercept of the effect size is fixed or
constrained. The format of this matrix follows
<code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. The intercept can be
constrained with other parameters by using the same label.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_coef.constraints">coef.constraints</code></td>
<td>
<p>A <code class="reqn">1</code> x <code class="reqn">m</code> matrix
specifying how the level-2 and level-3 predictors predict the effect sizes. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default
is that all <code class="reqn">m</code> predictors predict the effect size. The
format of this matrix follows
<code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. The regression coefficients can be
constrained equally by using the same labels.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_re2.constraints">RE2.constraints</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying the variance components of the random effects. The default
is that the variance components are free. The format of this matrix
follows <code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. Elements of the variance
components can be constrained equally by using the same label. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_re2.lbound">RE2.lbound</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix of lower bound on the level-2 variance component of the random effects. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_re3.constraints">RE3.constraints</code></td>
<td>
<p>A scalar of a <code class="reqn">1</code> x <code class="reqn">1</code> matrix
specifying the variance components of the random effects at
level-3. The default is that the variance components are free. The format of this matrix
follows <code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. Elements of the variance
components can be constrained equally by using the same label. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_re3.lbound">RE3.lbound</code></td>
<td>
<p>A scalar or a <code class="reqn">1</code> x <code class="reqn">1</code> matrix of lower bound on the level-3 variance component of the random effects. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_i2">I2</code></td>
<td>
<p>Possible options are <code>"I2q"</code>, <code>"I2hm"</code>,
<code>"I2am"</code> and <code>"ICC"</code>. They represent the <code>I2</code> calculated by using a
typical within-study sampling variance from the Q statistic, the
harmonic mean, the arithmetic mean of the within-study sampling
variances, and the intra-class correlation. More than one options are possible. If <code>intervals.type="LB"</code>, 95% confidence intervals on the heterogeneity indices will be constructed. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_r2">R2</code></td>
<td>
<p>Logical. If <code>TRUE</code> and there are predictors, R2 is
calculated. 
</p>
</td></tr>  
<tr><td><code id="meta3L_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.
</p>
</td></tr>
<tr><td><code id="meta3L_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="meta3L_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td></tr>
<tr><td><code id="meta3L_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>  
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">y_{ij} = \beta_0 + \mathbf{\beta'}*\mathbf{x}_{ij} + u_{(2)ij} + u_{(3)j} + e_{ij}
  </code>
</p>
<p> where <code class="reqn">y_{ij}</code> is the effect size for the ith study in the jth cluster,
<code class="reqn">\beta_0</code> is the intercept, <code class="reqn">\mathbf{\beta}</code> is the
regression coefficients, <code class="reqn">\mathbf{x}_{ij}</code> is a vector of predictors, <code class="reqn">u_{(2)ij} \sim N(0, \tau^2_2)</code> and <code class="reqn">u_{(3)j} \sim N(0, \tau^2_3)</code> are the level-2 and level-3 heterogeneity variances,
respectively, and <code class="reqn">e_{ij} \sim N(0, v_{ij})</code> is the conditional known sampling variance.
</p>
<p><code>meta3L()</code> does not differentiate between level-2 or level-3
variables in <code>x</code> since both variables are treated as a design
matrix. When there are missing values in <code>x</code>, the data will be
deleted. <code>meta3LFIML()</code> treats the predictors <code>x2</code> and <code>x3</code>
as level-2 and level-3 variables. Thus, their means and covariance
matrix will be estimated. Missing values in <code>x2</code> and <code>x3</code>
will be handled by (full information) maximum likelihood (FIML) in <code>meta3LFIML()</code>. Moreover,
auxiliary variables <code>av2</code> at level-2 and <code>av3</code> at level-3 may
be included to improve the estimation. Although <code>meta3LFIML()</code> is more
flexible in handling missing covariates, it is more likely to encounter
estimation problems. 	
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with three-level meta-analyses: A structural equation modeling approach. <em>Psychological Methods</em>, <b>19</b>, 211-229.
</p>
<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. New York: Guilford Press.
</p>
<p>Graham, J. (2003). Adding missing-data-relevant variables to
FIML-based structural equation models. <em>Structural Equation
Modeling: A Multidisciplinary Journal</em>, <b>10(1)</b>, 80-100.
</p>
<p>Konstantopoulos, S. (2011). Fixed effects and variance components
estimation in three-level meta-analysis. <em>Research Synthesis
Methods</em>, <b>2</b>, 61-76.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reml3L">reml3L</a></code>, <code><a href="#topic+Cooper03">Cooper03</a></code>, <code><a href="#topic+Bornmann07">Bornmann07</a></code>
</p>

<hr>
<h2 id='metaSEM-package'>Meta-Analysis using Structural Equation Modeling
</h2><span id='topic+metaSEM-package'></span><span id='topic+metaSEM'></span>

<h3>Description</h3>

<p>A collection of functions for conducting meta-analysis using a
structural equation modeling (SEM) approach via the 'OpenMx' and
'lavaan' packages. It also implements various procedures to
perform meta-analytic structural equation modeling on the
correlation and covariance matrices.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> metaSEM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>
<p>Maintainer: Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2008). A model for integrating fixed-, random-, and
mixed-effects meta-analyses into structural equation
modeling. <em>Psychological Methods</em>, <b>13</b> (3),
182-202. https://doi.org/10.1037/a0013163
</p>
<p>Cheung, M. W.-L. (2009). Constructing approximate confidence intervals
for parameters with structural equation models. <em>Structural
Equation Modeling</em>, <b>16</b> (2),
267-294. https://doi.org/10.1080/10705510902751291
</p>
<p>Cheung, M. W.-L. (2010). Fixed-effects meta-analyses as multiple-group
structural equation models. <em>Structural Equation Modeling</em>,
<b>17</b> (3), 481-509. https://doi.org/10.1080/10705511.2010.489367
</p>
<p>Cheung, M. W.-L. (2013). Implementing restricted maximum likelihood
estimation in structural equation models. <em>Structural Equation
Modeling</em>, <b>20</b> (1), 157-167. https://doi.org/10.1080/10705511.2013.742404
</p>
<p>Cheung, M. W.-L. (2013). Multivariate meta-analysis as structural
equation models. <em>Structural Equation Modeling</em>, <b>20</b> (3),
429-454. https://doi.org/10.1080/10705511.2013.797827
</p>
<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with
three-level meta-analyses: A structural equation modeling
approach. <em>Psychological Methods</em>, <b>19</b> (2),
211-229. https://doi.org/10.1037/a0032968
</p>
<p>Cheung, M. W.-L. (2014). Fixed- and random-effects meta-analytic
structural equation modeling: Examples and analyses in R. <em>Behavior
Research Methods</em>, <b>46</b> (1),
29-40. https://doi.org/10.3758/s13428-013-0361-y
</p>
<p>Cheung, M. W.-L. (2015). metaSEM: An R package for meta-analysis using
structural equation modeling. <em>Frontiers in Psychology</em>, <b>5</b>
(1521). https://doi.org/10.3389/fpsyg.2014.01521
</p>
<p>Cheung, M. W.-L. (2015). <em>Meta-Analysis: A Structural Equation
Modeling Approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L. (2018). Issues in solving the problem of effect size
heterogeneity in meta-analytic structural equation modeling: A
commentary and simulation study on Yu, Downes, Carter, and O'Boyle
(2016). <em>Journal of Applied Psychology</em>, <b>103</b> (7),
787-803. https://doi.org/10.1037/apl0000284
</p>
<p>Cheung, M. W.-L. (2018). Computing multivariate effect sizes and their
sampling covariance matrices with structural equation modeling: Theory,
examples, and computer simulations. <em>Frontiers in Psychology</em>,
<b>9</b> (1387). https://doi.org/10.3389/fpsyg.2018.01387
</p>
<p>Cheung, M. W.-L. (2019). Some reflections on combining meta-analysis and
structural equation modeling. <em>Research Synthesis Methods</em>,
<b>10</b> (1), 15-22. https://doi.org/10.1002/jrsm.1321
</p>
<p>Cheung, M. W.-L. (2021). Meta-analytic structural equation modeling. In
<em>Oxford Research Encyclopedia of Business and Management</em>. Oxford
University Press. https://doi.org/10.1093/acrefore/9780190224851.013.225
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2004). Testing dependent correlation
coefficients via structural equation modeling. <em>Organizational
Research Methods</em>, <b>7</b> (2),
206-223. https://doi.org/10.1177/1094428104264024
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation
modeling: A two-stage approach. <em>Psychological Methods</em>, <b>10</b>
(1), 40-64. https://doi.org/10.1037/1082-989X.10.1.40
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2009). A two-stage approach to
synthesizing covariance matrices in meta-analytic structural equation
modeling. <em>Structural Equation Modeling</em>, <b>16</b> (1),
28-53. https://doi.org/10.1080/10705510802561295 
</p>
<p>Cheung, M. W.-L., &amp; Cheung, S.-F. (2016). Random-effects models for
meta-analytic structural equation modeling: Review, issues, and
illustrations. <em>Research Synthesis Methods</em>, <b>7</b> (2),
140-155. https://doi.org/10.1002/jrsm.1166
</p>
<p>Jak, S., &amp; Cheung, M. W.-L. (2018). Testing moderator hypotheses in
meta-analytic structural equation modeling using subgroup
analysis. <em>Behavior Research Methods</em>, <b>50</b> (4),
1359-1373. https://doi.org/10.3758/s13428-018-1046-3
</p>
<p>Jak, S., &amp; Cheung, M. W.-L. (2020). Meta-analytic structural equation
modeling with moderating effects on SEM parameters. <em>Psychological
Methods</em>, <b>25</b> (4), 430-455. https://doi.org/10.1037/met0000245
</p>

<hr>
<h2 id='Nam03'>Dataset on the Environmental Tobacco Smoke (ETS) on children's health
</h2><span id='topic+Nam03'></span>

<h3>Description</h3>

<p>This dataset includes 59 studies reported by Nam, Mengersen, and
Garthwaite (2003) on the potential health effects among children exposed to
environmental tobacco smoke (ETS), or passive smoking. The effect sizes
are the log odds ratios of asthma and lower respiratory disease (LRD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Nam03)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>ID</dt><dd><p>Study identification number.</p>
</dd>
<dt>Size</dt><dd><p>Total number of valid subjects in the study.</p>
</dd>
<dt>Age</dt><dd><p>Mean age of participants.</p>
</dd>
<dt>Year</dt><dd><p>Year of publication.</p>
</dd>
<dt>Country</dt><dd><p>Country code.</p>
</dd>
<dt>Smoke</dt><dd><p>Source of ETS.</p>
</dd>
<dt>Adj</dt><dd><p>Whether the reported odds ratio is adjusted for covariates.</p>
</dd>
<dt>Asthma_logOR</dt><dd><p>Log odds ratio of asthma.</p>
</dd>
<dt>LRD_logOR</dt><dd><p>Log odds ratio of lower respiratory disease.</p>
</dd>
<dt>Asthma_v</dt><dd><p>Sampling variance of Asthma_logOR.</p>
</dd>
<dt>AsthmaLRD_cov_05</dt><dd><p>Sampling covariance between Asthma_logOR and
LRD_logOR by assuming a correlation of 0.5</p>
</dd>
<dt>LRD_v</dt><dd><p>Sampling variance of LRD_logOR.</p>
</dd>  
</dl>



<h3>Source</h3>

<p>Nam, I.-S., Mengersen, K., &amp; Garthwaite, P. (2003). Multivariate meta-analysis. <em>Statistics in Medicine</em>, <b>22</b>(14), 2309-2333. https://doi.org/10.1002/sim.1410
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nam03)
</code></pre>

<hr>
<h2 id='Nohe15'>Correlation Matrices from Nohe et al. (2015)</h2><span id='topic+Nohe15A1'></span><span id='topic+Nohe15A2'></span>

<h3>Description</h3>

<p>The data sets include two lists of correlation matrices of panel studies between
work-family conflict and strain reported in Table A1 (<code>Nohe15A1</code>)
and Table A2 (<code>Nohe15A2</code>) by Nohe et al. (2015). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Nohe15A1)
data(Nohe15A2)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of studies of correlation matrices. The
variables are <em>W1</em>, <em>S1</em>, <em>W2</em>, and <em>S2</em> in
<code>Nohe15A1</code> and <em>F1</em>, <em>S1</em>, <em>F2</em>, and <em>S2</em> in
<code>Nohe15A2</code></p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>RelXX</dt><dd><p>The reliabilities of <em>W1</em>, <em>S1</em>, <em>W2</em> and
<em>S2</em> in <code>Nohe15A1</code> and the reliabilities of <em>F1</em>
<em>S1</em>, <em>F2</em> , and <em>S2</em> in <code>Nohe15A2</code></p>
</dd>
<dt>FemalePer</dt><dd><p>Percentage of female participants</p>
</dd>
<dt>Publication</dt><dd><p>Whether the studies were published (<em>P</em>) or
unpublished (<em>U</em>)</p>
</dd>
<dt>Lag</dt><dd><p>Time lag between the coded measurement waves in months</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nohe, C., Meier, L. L., Sonntag, K., &amp; Michel, A. (2015). The chicken or the egg? A meta-analysis of panel studies of the relationship between work-family conflict and strain. <em>Journal of Applied Psychology</em>, <b>100</b>(2), 522-536.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#### TSSEM
    
## Set seed for replicability    
set.seed(23891)
    
## Table A1
randA1a &lt;- tssem1(Nohe15A1$data, Nohe15A1$n, method="REM", RE.type="Diag")
summary(randA1a)

model1 &lt;- 'W2 ~ w2w*W1 + s2w*S1
           S2 ~ w2s*W1 + s2s*S1
           W1 ~~ w1WITHs1*S1
           W2 ~~ w2WITHs2*S2
           W1 ~~ 1*W1
           S1 ~~ 1*S1
           W2 ~~ Errw2*W2
           S2 ~~ Errs2*S2'

## Display the model
plot(model1, layout="spring")    
    
RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("W1", "S1", "W2", "S2"))
RAM1

randA1b &lt;- tssem2(randA1a, Amatrix=RAM1$A, Smatrix=RAM1$S)
summary(randA1b)

## Display the model with the parameter estimates
plot(randA1b, layout="spring")    

## Table A2
randA2a &lt;- tssem1(Nohe15A2$data, Nohe15A2$n, method="REM", RE.type="Diag")
## Rerun to remove error code
randA2a &lt;- rerun(randA2a)
summary(randA2a)

model2 &lt;- 'F2 ~ f2f*F1 + s2F*S1
           S2 ~ f2s*F1 + s2s*S1
           F1 ~~ f1WITHs1*S1
           F2 ~~ f2WITHs2*S2
           F1 ~~ 1*F1
           S1 ~~ 1*S1
           F2 ~~ Errf2*F2
           S2 ~~ Errs2*S2'

## Display the model
plot(model2, layout="spring")
    
RAM2 &lt;- lavaan2RAM(model2, obs.variables=c("F1", "S1", "F2", "S2"))
RAM2

randA2b &lt;- tssem2(randA2a, Amatrix=RAM2$A, Smatrix=RAM2$S)
summary(randA2b)

## Display the model with the parameter estimates
plot(randA2b, layout="spring")  
    
## Estimate the heterogeneity of the parameter estimates
tssemParaVar(randA1a, randA2b)    

## Parametric bootstrap based on Yu et al. (2016)
## I assume that you know what you are doing!

## Set seed for reproducibility
set.seed(39128482)

## Average the correlation coefficients with the univariate-r approach
uni1 &lt;- uniR1(Nohe15A1$data, Nohe15A1$n)
uni1

## Generate random correlation matrices
boot.cor &lt;- bootuniR1(uni1, Rep=50)

## Display the quality of the generated correlation matrices
summary(boot.cor)

## Proposed saturated model
model1 &lt;- 'W2 + S2 ~ W1 + S1'

## Use the harmonic mean of the sample sizes as n in SEM
n &lt;- uni1$n.harmonic    
    
boot.fit1 &lt;- bootuniR2(model=model1, data=boot.cor, n=n)
summary(boot.fit1)

## Proposed model with equal regression coefficients
model2 &lt;- 'W2 ~ Same*W1 + Cross*S1
           S2 ~ Cross*W1 + Same*S1'

boot.fit2 &lt;- bootuniR2(model=model2, data=boot.cor, n=n)
summary(boot.fit2)

#### OSMASEM    

## Calculate the sampling variance-covariance matrix of the correlation matrices.    
my.df &lt;- Cor2DataFrame(Nohe15A1)

## Standardize the moderator "Lag"
my.df$data$Lag &lt;- scale(my.df$data$Lag)
    
head(my.df$data)

## Proposed model
model1 &lt;- 'W2 ~ w2w*W1 + s2w*S1
           S2 ~ w2s*W1 + s2s*S1
           W1 ~~ w1WITHs1*S1
           W2 ~~ w2WITHs2*S2
           W1 ~~ 1*W1
           S1 ~~ 1*S1
           W2 ~~ Errw2*W2
           S2 ~~ Errs2*S2'
plot(model1)     

## Convert it into RAM specification    
RAM1 &lt;- lavaan2RAM(model1, obs.variables=c("W1", "S1", "W2", "S2"))
RAM1

## Create vechs of the model implied correlation matrix
## with implicit diagonal constraints
## M0 &lt;- create.vechsR(A0=RAM1$A, S0=RAM1$S)

## Create heterogeneity variances
## RE.type= either "Diag" or "Symm"
##
## Transform= either "expLog" or "sqSD" for better estimation on variances
## T0 &lt;- create.Tau2(RAM=RAM1, RE.type="Diag")
##
## Fit the model    
## fit0 &lt;- osmasem(model.name="No moderator", Mmatrix=M0, Tmatrix=T0, data=my.df)

## Fit the model
fit0 &lt;- osmasem(model.name="No moderator", RAM=RAM1, data=my.df)
summary(fit0)

## Get the SRMR
osmasemSRMR(fit0)

## Get the transformed variance component of the random effects    
VarCorr(fit0)
    
## "lag" as a moderator on A matrix
A1 &lt;- matrix(c(0,0,0,0,
               0,0,0,0,
               "0*data.Lag","0*data.Lag",0,0,
               "0*data.Lag","0*data.Lag",0,0),
             nrow=4, ncol=4, byrow=TRUE)
              
## M1 &lt;- create.vechsR(A0=RAM1$A, S0=RAM1$S, Ax=A1)
##
## Fit the nodel
## fit1 &lt;- osmasem(model.name="Lag as a moderator for Amatrix", Mmatrix=M1,
##                 Tmatrix=T0, data= my.df)
    
fit1 &lt;- osmasem(model.name="Lag as a moderator for Amatrix",
                RAM=RAM1, Ax=A1, data= my.df)
summary(fit1)
VarCorr(fit1)

## Compare the models with and without the moderator "lag"
anova(fit1, fit0)

## Calculate the R2    
osmasemR2(fit0, fit1)

## End(Not run)
</code></pre>

<hr>
<h2 id='Norton13'>Studies on the Hospital Anxiety and Depression Scale Reported by Norton et al. (2013)
</h2><span id='topic+Norton13'></span>

<h3>Description</h3>

<p>The data set includes 28 studies on 14 items measuring the
Hospital Anxiety and Depression Scale (HADS) Reported by Norton et
al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Norton13)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>data</dt><dd><p>A list of 28 studies of correlation matrices. The
variables are 14 items (x1 to x14) measuring HADS.</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>population</dt><dd><p>A vector of the population of the data</p>
</dd>
<dt>group</dt><dd><p>A vector of classification into <em>patients</em>
vs. <em>non-patients</em> based on population</p>
</dd>
</dl>



<h3>Source</h3>

<p>Norton, S., Cosco, T., Doyle, F., Done, J., &amp; Sacker, A. (2013). The Hospital Anxiety and Depression Scale: A meta confirmatory factor analysis. <em>Journal of Psychosomatic Research</em>, <em>74</em>(1), 74-81.
</p>


<h3>References</h3>

<p>Jak, S., &amp; Cheung, M. W.-L. (2018). Addressing heterogeneity in meta-analytic structural equation modeling using subgroup analysis. <em>Behavior Research
Methods</em>, <b>50</b>, 1359-1373.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Norton13)
</code></pre>

<hr>
<h2 id='osmasem'>One-stage meta-analytic structural equation modeling
</h2><span id='topic+osmasem'></span>

<h3>Description</h3>

<p>It fits MASEM with the one-stage MASEM (OSMASEM) approach.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>osmasem(model.name="osmasem", RAM=NULL, Mmatrix=NULL,
        Tmatrix=NULL, Jmatrix=NULL, Ax=NULL, Sx=NULL,
        A.lbound=NULL, A.ubound=NULL,
        RE.type=c("Diag", "Symm"), data,
        subset.variables=NULL, subset.rows=NULL, 
        intervals.type = c("z", "LB"),
        mxModel.Args=NULL, mxRun.Args=NULL,
        suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="osmasem_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>
<tr><td><code id="osmasem_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>. If it is given,
<code>Mmatrix</code> and <code>Tmatrix</code> arguments will be ignored. 
</p>
</td></tr>  
<tr><td><code id="osmasem_+3A_mmatrix">Mmatrix</code></td>
<td>
<p>A list of matrices of the model implied correlation
matrix created by the <code>create.vechsR</code>. It is only required when
<code>RAM</code> is null.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_tmatrix">Tmatrix</code></td>
<td>
<p>A list of matrices of the heterogeneity
variance-covariance matrix created by the <code>create.Tau2</code>. It is only required when <code>RAM</code> is null.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_jmatrix">Jmatrix</code></td>
<td>
<p>The Jacobian matrix of the mean structure in
mxMatrix. The covariance structure is Jmatrix %&amp;% Tau2 + Vi. If it is
not givin, an identity matrix will be used. </p>
</td></tr>
<tr><td><code id="osmasem_+3A_ax">Ax</code></td>
<td>
<p>A Amatrix of a list of Amatrix with definition variables as
the moderators of the Amatrix. It is used to create the <code>Mmatrix</code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_sx">Sx</code></td>
<td>
<p>A Smatrix of a list of Smatrix with definition variables as
the moderators of the Smatrix. It is used to create the
<code>Mmatrix</code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_a.lbound">A.lbound</code></td>
<td>
<p>A matrix of lower bound of the Amatrix. If a scalar is
given, the lbound matrix will be filled with this scalar.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_a.ubound">A.ubound</code></td>
<td>
<p>A matrix of upper bound of the Amatrix. If a scalar is
given, the ubound matrix will be filled with this scalar.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_re.type">RE.type</code></td>
<td>
<p>Type of the random effects.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_data">data</code></td>
<td>
<p>A list of data created by the <code>Cor2DataFrame</code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_subset.variables">subset.variables</code></td>
<td>
<p>A character vector of the observed variables selected for
the analysis.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_subset.rows">subset.rows</code></td>
<td>
<p>A logical vector of the same length as the number of rows in the data to select which rows are used in the analysis.</p>
</td></tr>  
<tr><td><code id="osmasem_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% confidence
intervals (CIs) based on the estimated standard error. If it
is <code>LB</code>, it calculates the 95% likelihood-based CIs on the parameter estimates.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_mxmodel.args">mxModel.Args</code></td>
<td>
<p>A list of arguments passed to <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_mxrun.args">mxRun.Args</code></td>
<td>
<p>A list of arguments passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If it is <code>TRUE</code>, warnings are
suppressed. This argument is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="osmasem_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td></tr>
<tr><td><code id="osmasem_+3A_...">...</code></td>
<td>
<p>Not used yet.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>osmasem</code></p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Jak, S., &amp; Cheung, M. W.-L. (2020). Meta-analytic structural equation
modeling with moderating effects on SEM parameters. <em>Psychological
Methods</em>, <b>25</b> (4), 430-455. https://doi.org/10.1037/met0000245
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Cor2DataFrame">Cor2DataFrame</a></code>, <code><a href="#topic+create.vechsR">create.vechsR</a></code>,
<code><a href="#topic+create.Tau2">create.Tau2</a></code>, <code><a href="#topic+create.V">create.V</a></code>, <code><a href="#topic+osmasem">osmasem</a></code>, <code><a href="#topic+Nohe15">Nohe15</a></code>
</p>

<hr>
<h2 id='osmasemR2'>Calculate the R2 in OSMASEM and OSMASEM3L</h2><span id='topic+osmasemR2'></span>

<h3>Description</h3>

<p>It calculates the R2 of the moderators in explaining the
variances in the heterogeneity variances.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>osmasemR2(model1, model0, R2.truncate=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="osmasemR2_+3A_model1">model1</code></td>
<td>
<p>An object in class <code>osmasem</code>.</p>
</td></tr>
<tr><td><code id="osmasemR2_+3A_model0">model0</code></td>
<td>
<p>An object in class <code>osmasem</code>.</p>
</td></tr>
<tr><td><code id="osmasemR2_+3A_r2.truncate">R2.truncate</code></td>
<td>
<p>Whether to truncate the negative R2 to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model1</code> and <code>model0</code> are the models with and without
the moderators, respectively. The function does not check whether the
models are nested. It is the users' responsibility to make sure that
the models with and without the moderators are nested. It returns a
list of the diagonals of the heterogeneity variances of the
models without and with the moderators, and the R2.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+osmasem">osmasem</a></code>
</p>

<hr>
<h2 id='osmasemSRMR'>Calculate the SRMR in OSMASEM and OSMASEM3L</h2><span id='topic+osmasemSRMR'></span>

<h3>Description</h3>

<p>It calculates the standardized root mean squared residuals
(SRMR) in OSMASEM and OSMASEM3L.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>osmasemSRMR(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="osmasemSRMR_+3A_x">x</code></td>
<td>
<p>An OSMASEM object without any moderators.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It calculates the model implied correlation matrix and its
saturated counterpart to calculate the SRMR. It should be noted that
the heterogeneity variances are ignored in the calculations.</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+osmasem">osmasem</a></code>, 
<code><a href="#topic+Nohe15">Nohe15</a></code>
</p>

<hr>
<h2 id='pattern.n'>Display the Accumulative Sample Sizes for the Covariance Matrix
</h2><span id='topic+pattern.n'></span>

<h3>Description</h3>

<p>It displays the accumulative sample sizes for the
covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattern.n(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pattern.n_+3A_x">x</code></td>
<td>
<p>A list of square matrices</p>
</td></tr>
<tr><td><code id="pattern.n_+3A_n">n</code></td>
<td>
<p>A vector of sample sizes.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A square matrix of the accumulative sample sizes of the
input matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Show the pattern of missing data
pattern.n(Hunter83$data, Hunter83$n)

#             Ability Knowledge Work sample Supervisor
# Ability        3815      3372        3281       3605
# Knowledge      3372      3532        2998       3322
# Work sample    3281      2998        3441       3231
# Supervisor     3605      3322        3231       3765
</code></pre>

<hr>
<h2 id='pattern.na'>Display the Pattern of Missing Data of a List of Square Matrices
</h2><span id='topic+pattern.na'></span>

<h3>Description</h3>

<p>It displays the pattern of missing data (or pattern of data
that are present) of a list of square matrices with the same dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattern.na(x, show.na = TRUE, type=c("tssem", "osmasem"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pattern.na_+3A_x">x</code></td>
<td>
<p>A list of square matrices</p>
</td></tr>
<tr><td><code id="pattern.na_+3A_show.na">show.na</code></td>
<td>
<p>If it is <code>TRUE</code>, it shows the pattern of missing
data. If it is <code>FALSE</code>, it shows the pattern of data that are
present.</p>
</td></tr>
<tr><td><code id="pattern.na_+3A_type">type</code></td>
<td>
<p>If it is <code>tssem</code>, it reports the pattern of missing
correlations for the tssem approach. If it is <code>osmasem</code>, it
reports the pattern of missing correlations for the data created by <code><a href="#topic+Cor2DataFrame">Cor2DataFrame</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A square matrix of numerical values with the same dimensions of the
input matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Show the pattern of missing data
pattern.na(Hunter83$data, show.na=TRUE)

#             Ability Knowledge Work sample Supervisor
# Ability           1         3           3          2
# Knowledge         3         2           4          3
# Work sample       3         4           2          3
# Supervisor        2         3           3          1

## Show the pattern of data that are present
pattern.na(Hunter83$data, show.na=FALSE)

#             Ability Knowledge Work sample Supervisor
# Ability          13        11          11         12
# Knowledge        11        12          10         11
# Work sample      11        10          12         11
# Supervisor       12        11          11         13
</code></pre>

<hr>
<h2 id='plot'>Plot methods for various objects
</h2><span id='topic+plot.meta'></span><span id='topic+plot.character'></span><span id='topic+plot.wls'></span><span id='topic+plot.osmasem'></span>

<h3>Description</h3>

<p>It plots the models from either the lavaan model or
<code>meta</code>, <code>wls</code>, and <code>osmasem</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meta'
plot(x, effect.sizes, add.margin = 0.1, interval = 0.95,
     main= "Effect Sizes and their Confidence Ellipses",
     axis.labels= paste("Effect size ", effect.sizes, sep = ""),
     study.col = "black", study.pch = 19, study.min.cex = 0.8,
     study.weight.plot = FALSE, study.ellipse.plot = TRUE,
     study.ellipse.col = "black", study.ellipse.lty = 2,
     study.ellipse.lwd = 0.5, estimate.col = "blue",
     estimate.pch = 18, estimate.cex = 2,
     estimate.ellipse.plot = TRUE, estimate.ellipse.col = "red",
     estimate.ellipse.lty = 1, estimate.ellipse.lwd = 2,
     randeff.ellipse.plot = TRUE, randeff.ellipse.col = "green",
     randeff.ellipse.lty = 1, randeff.ellipse.lwd = 2,
     univariate.plot = TRUE, univariate.lines.col = "gray",
     univariate.lines.lty = 3, univariate.lines.lwd = 1,
     univariate.polygon.width = 0.02,
     univariate.polygon.col = "red",
     univariate.arrows.col = "green", univariate.arrows.lwd = 2,
     diag.panel = FALSE, xlim=NULL, ylim=NULL, ...)
## S3 method for class 'character'
plot(x, fixed.x=FALSE, nCharNodes=0, nCharEdges=0,
     layout=c("tree", "circle", "spring", "tree2", "circle2"),
     sizeMan=8, sizeLat=8, edge.label.cex=1.3, color="white", ...)
## S3 method for class 'wls'
plot(x, manNames=NULL, latNames=NULL, labels=c("labels", "RAM"),
     what="est", nCharNodes=0, nCharEdges=0,
     layout=c("tree", "circle", "spring", "tree2", "circle2"),
     sizeMan=8, sizeLat=8, edge.label.cex=1.3, color="white",
     weighted=FALSE, ...)
## S3 method for class 'osmasem'
plot(x, manNames=NULL, latNames=NULL, labels=c("labels", "RAM"),
     what="est", nCharNodes=0, nCharEdges=0,
     layout=c("tree", "circle", "spring", "tree2", "circle2"),
     sizeMan=8, sizeLat=8, edge.label.cex=1.3, color="white",
    weighted=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>An object returned from either a lavaan model class
<code>character</code>, <code>osmasem</code>, <code>osmasem3L</code>, <code>wls</code> or <code>meta</code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_effect.sizes">effect.sizes</code></td>
<td>
<p>Numeric values indicating which effect sizes to
be plotted. At least two effect sizes are required. To plot the effect sizes of <code class="reqn">y_1</code> and
<code class="reqn">y_2</code>, one may use <code>effect.sizes=c(1,2)</code>. If it is missing, all effect sizes will be plotted in a
pairwise way.
</p>
</td></tr>
<tr><td><code id="plot_+3A_add.margin">add.margin</code></td>
<td>
<p>Value for additional margins on the left and bottom margins.
</p>
</td></tr>
<tr><td><code id="plot_+3A_interval">interval</code></td>
<td>
<p>Interval for the confidence ellipses.
</p>
</td></tr>
<tr><td><code id="plot_+3A_main">main</code></td>
<td>
<p>Main title of each plot. If there are multiple plots, a
vector of character titles may be used.
</p>
</td></tr>
<tr><td><code id="plot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Labels for the effect sizes.
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.col">study.col</code></td>
<td>
<p>The color for individual studies. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>.  
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.pch">study.pch</code></td>
<td>
<p>Plotting character of individual studies. See <code>pch</code> in <code><a href="graphics.html#topic+points">points</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.min.cex">study.min.cex</code></td>
<td>
<p>The minimum value of cex for individual
studies. See <code>cex</code> in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.weight.plot">study.weight.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the plotting size of individual
studies (cex) will be proportional to one over the square root of the
determinant of the sampling covariance matrix of the study.
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.ellipse.plot">study.ellipse.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the confidence
ellipses of individual studies are plotted.
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.ellipse.col">study.ellipse.col</code></td>
<td>
<p>The color of the confidence ellipses of
individual studies. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.ellipse.lty">study.ellipse.lty</code></td>
<td>
<p>The line type of the confidence ellipse of
individual studies. See <code>lty</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_study.ellipse.lwd">study.ellipse.lwd</code></td>
<td>
<p>The line width of the confidence ellipse of
individual studies. See <code>lwd</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.col">estimate.col</code></td>
<td>
<p>The color of the estimated effect size. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.pch">estimate.pch</code></td>
<td>
<p>Plotting character of the estimated effect sizes. See <code>pch</code> in <code><a href="graphics.html#topic+points">points</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.cex">estimate.cex</code></td>
<td>
<p>The amount of plotting of the estimated effect sizes. See <code>cex</code> in <code><a href="graphics.html#topic+par">par</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.ellipse.plot">estimate.ellipse.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the confidence
ellipse of the estimated effect sizes will be plotted.
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.ellipse.col">estimate.ellipse.col</code></td>
<td>
<p>The color of the confidence
ellipse of the estimated effect sizes. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.ellipse.lty">estimate.ellipse.lty</code></td>
<td>
<p>The line type of the confidence
ellipse of the estimated effect sizes. See <code>lty</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_estimate.ellipse.lwd">estimate.ellipse.lwd</code></td>
<td>
<p>The line width of the confidence
ellipse of the estimated effect sizes. See <code>lwd</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_randeff.ellipse.plot">randeff.ellipse.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the confidence
ellipses of the random effects will be plotted.
</p>
</td></tr>
<tr><td><code id="plot_+3A_randeff.ellipse.col">randeff.ellipse.col</code></td>
<td>
<p>Color of the confidence
ellipses of the random effects. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_randeff.ellipse.lty">randeff.ellipse.lty</code></td>
<td>
<p>The line type of the confidence
ellipses of the random effects. See <code>lty</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_randeff.ellipse.lwd">randeff.ellipse.lwd</code></td>
<td>
<p>The line width of the confidence
ellipses of the random effects. See <code>lwd</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.plot">univariate.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the estimated univariate effect
sizes will be plotted.
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.lines.col">univariate.lines.col</code></td>
<td>
<p>The color of the estimated univariate effect
sizes. See <code>col</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.lines.lty">univariate.lines.lty</code></td>
<td>
<p>The line type of the estimated univariate effect
sizes. See <code>lty</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.lines.lwd">univariate.lines.lwd</code></td>
<td>
<p>The line width of the estimated univariate effect
sizes. See <code>lwd</code> in <code><a href="graphics.html#topic+par">par</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.polygon.width">univariate.polygon.width</code></td>
<td>
<p>The width of the polygon of the estimated univariate effect
sizes.
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.polygon.col">univariate.polygon.col</code></td>
<td>
<p>The color of the polygon of the estimated univariate effect
sizes.
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.arrows.col">univariate.arrows.col</code></td>
<td>
<p>The color of the arrows of the estimated univariate effect
sizes.
</p>
</td></tr>
<tr><td><code id="plot_+3A_univariate.arrows.lwd">univariate.arrows.lwd</code></td>
<td>
<p>The line width of the arrows of the estimated univariate effect
sizes.
</p>
</td></tr>
<tr><td><code id="plot_+3A_diag.panel">diag.panel</code></td>
<td>
<p>Logical. If <code>TRUE</code>, diagonal panels will be
created. They can then be used for forrest plots for univariate meta-analysis.
</p>
</td></tr>
<tr><td><code id="plot_+3A_xlim">xlim</code></td>
<td>
<p>NULL or a numeric vector of length 2; if it is NULL, it
provides defaults estimated from the data.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylim">ylim</code></td>
<td>
<p>NULL or a numeric vector of length 2; if it is NULL, it
provides defaults estimated from the data.</p>
</td></tr>  
<tr><td><code id="plot_+3A_fixed.x">fixed.x</code></td>
<td>
<p>Argument passed to
<code><a href="semPlot.html#topic+semPlotModel">semPlotModel</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_+3A_mannames">manNames</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_latnames">latNames</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_labels">labels</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_what">what</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>  
<tr><td><code id="plot_+3A_ncharnodes">nCharNodes</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_ncharedges">nCharEdges</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_layout">layout</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_color">color</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_sizeman">sizeMan</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_sizelat">sizeLat</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_edge.label.cex">edge.label.cex</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>
<tr><td><code id="plot_+3A_weighted">weighted</code></td>
<td>
<p>Argument passed to <code><a href="semPlot.html#topic+semPaths">semPaths</a></code>
</p>
</td></tr>  
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the methods.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The estimated effect sizes and random effects are based on the
labels Intercept1, Intercept2, ... and Tau2_1_1, Tau2_2_1, Tau2_2_2,
etc. At least two effect sizes are required for this function. 
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2013). Multivariate meta-analysis as structural equation models. <em>Structural Equation Modeling</em>, <b>20</b>, 429-454.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Berkey98">Berkey98</a></code>, <code><a href="#topic+wvs94a">wvs94a</a></code>  <code><a href="#topic+meta2semPlot">meta2semPlot</a></code> <code><a href="semPlot.html#topic+semPaths">semPaths</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## lavaan model
model &lt;- "y ~ m + x
          m ~ x"
plot(model)

## End(Not run)
</code></pre>

<hr>
<h2 id='print'>Print Methods for various Objects 
</h2><span id='topic+print.tssem1FEM'></span><span id='topic+print.tssem1FEM.cluster'></span><span id='topic+print.tssem1REM'></span><span id='topic+print.wls'></span><span id='topic+print.meta'></span><span id='topic+print.meta3LFIML'></span><span id='topic+print.reml'></span><span id='topic+print.uniR1'></span><span id='topic+print.impliedR'></span>

<h3>Description</h3>

<p>Print methods for the <code>tssem1FEM</code>,
<code>tssem1FEM.cluster</code>, <code>tssem1REM</code>, <code>wls</code>,
<code>meta</code>, <code>meta3LFIML</code>, <code>reml</code>, <code>uniR1</code> and
<code>impliedR</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tssem1FEM'
print(x, ...)
## S3 method for class 'tssem1FEM.cluster'
print(x, ...)
## S3 method for class 'tssem1REM'
print(x, ...)
## S3 method for class 'wls'
print(x, ...)
## S3 method for class 'meta'
print(x, ...)
## S3 method for class 'meta3LFIML'
print(x, ...)
## S3 method for class 'reml'
print(x, ...)
## S3 method for class 'uniR1'
print(x, ...)
## S3 method for class 'impliedR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>An object returned from either class
<code>tssem1FEM</code>, class <code>tssem1FEM.cluster</code>, class <code>tssem1REM</code>,
class <code>wls</code>, class <code>meta</code>, class <code>meta3LFIML</code>,
class <code>reml</code>, class <code>uniR1</code> or class <code>impliedR</code>
</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>summary.default</code>
or unused.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tssem1">tssem1</a></code>, <code><a href="#topic+wls">wls</a></code>,
<code><a href="#topic+meta">meta</a></code>,  <code><a href="#topic+reml">reml</a></code>

</p>

<hr>
<h2 id='rCor'>Generate (Nested) Sample/Population Correlation/Covariance Matrices
</h2><span id='topic+rCor'></span><span id='topic+rCorPop'></span><span id='topic+rCorSam'></span><span id='topic+rCor3L'></span>

<h3>Description</h3>

<p>It generates (nested) random sample or population correlation or
covariance matrices. <code>rCor()</code> is a wrapper to call
<code>rCorPop()</code> and then <code>rCorSam()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rCor(Sigma, V, n, corr=TRUE, raw.data=FALSE,
     nonPD.pop=c("replace", "nearPD", "accept"),
     nonPD.sam=c("stop", "nearPD"))
rCorPop(Sigma, V, k, corr=TRUE, 
        nonPD.pop=c("replace", "nearPD", "accept"))
rCorSam(Sigma, n, corr=TRUE, raw.data=FALSE, 
        nonPD.sam=c("stop", "nearPD"))
rCor3L(Sigma, V.B, V.W, n, cluster, corr=TRUE, raw.data=FALSE,
       nonPD.pop=c("replace", "nearPD", "accept"),
       nonPD.sam=c("stop", "nearPD"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rCor_+3A_sigma">Sigma</code></td>
<td>
<p>A list of population correlation/covariance matrices or a
single matrix</p>
</td></tr>
<tr><td><code id="rCor_+3A_v">V</code></td>
<td>
<p>A variance-covariance matrix of Sigma.</p>
</td></tr>
<tr><td><code id="rCor_+3A_v.b">V.B</code></td>
<td>
<p>A variance-covariance matrix of between-study Sigma.</p>
</td></tr>
<tr><td><code id="rCor_+3A_v.w">V.W</code></td>
<td>
<p>A variance-covariance matrix of within-study Sigma</p>
</td></tr>
<tr><td><code id="rCor_+3A_n">n</code></td>
<td>
<p>A vector or a single sample sizes.</p>
</td></tr>
<tr><td><code id="rCor_+3A_cluster">cluster</code></td>
<td>
<p>A vector of number of studies in clusters.</p>
</td></tr>
<tr><td><code id="rCor_+3A_corr">corr</code></td>
<td>
<p>Logical. Whether to generate correlation or covariance matrices.</p>
</td></tr>
<tr><td><code id="rCor_+3A_raw.data">raw.data</code></td>
<td>
<p>Logical. Whether correlation/covariance matrices are
generated via raw.data or directly from a Wishart distribution.</p>
</td></tr>
<tr><td><code id="rCor_+3A_nonpd.pop">nonPD.pop</code></td>
<td>
<p>If it is <code>replace</code>, generated non-positive
definite matrices are replaced by generated new ones which are
positive definite. If it is <code>nearPD</code>, they are replaced by
nearly positive definite matrices by calling
<code>Matrix::nearPD()</code>. If it is <code>accept</code>, they are accepted.</p>
</td></tr>
<tr><td><code id="rCor_+3A_nonpd.sam">nonPD.sam</code></td>
<td>
<p>If it is <code>stop</code>, the program stops when the
inputs in the <code>rCorSam</code> are non-positive definite. If it is
<code>nearPD</code>, they are replaced by nearly positive definite matrices by calling
<code>Matrix::nearPD()</code>.</p>
</td></tr>
<tr><td><code id="rCor_+3A_k">k</code></td>
<td>
<p>A vector or a single number of studies.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the generated population/sample
correlation/covariance matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sigma &lt;- matrix(c(1, .2, .3,
                  .2, 1, .4,
                  .3, .4, 1), ncol=3, nrow=3)
V &lt;- diag(c(.1, .1, .1))

## Generate two population correlation matrices
Pop.corr &lt;- rCorPop(Sigma, V, k=2)
Pop.corr
                  
summary(Pop.corr)
                  
## Generate two sample correlation matrices
rCorSam(Sigma=Pop.corr, n=c(10, 10))
                 
## The above code is the same as the following one
rCor(Sigma, V, n=c(10, 10))                  
</code></pre>

<hr>
<h2 id='readData'>Read External Correlation/Covariance Matrices
</h2><span id='topic+readFullMat'></span><span id='topic+readStackVec'></span><span id='topic+readLowTriMat'></span>

<h3>Description</h3>

<p>It reads full/lower triangle/stacked vectors of correlation/covariance data into a list of correlation/covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFullMat(file, ...)
readStackVec(file, ...)
readLowTriMat(file, no.var, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readData_+3A_file">file</code></td>
<td>
<p>File name of the data.
</p>
</td></tr>
<tr><td><code id="readData_+3A_no.var">no.var</code></td>
<td>
<p>The number of variables in the data.
</p>
</td></tr>
<tr><td><code id="readData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="base.html#topic+scan">scan</a></code> for <code>readLowTriMat</code> and to <code><a href="utils.html#topic+read.table">read.table</a></code> for <code>readFullMat</code> and <code>readStackVec</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of correlation/covariance matrices.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Write two full correlation matrices into a file named "fullmat.dat".
## x2 is missing in the second matrix.
## The content of "fullmat.dat" is
# 1.0 0.3 0.4
# 0.3 1.0 0.5
# 0.4 0.5 1.0
# 1.0 NA 0.4
# NA NA NA
# 0.4 NA 1.0

## cat("1.0 0.3 0.4\n0.3 1.0 0.5\n0.4 0.5 1.0
## 1.0 NA 0.4\nNA NA NA\n0.4 NA 1.0",
## file="fullmat.dat", sep="")

## Read the correlation matrices
## my.full &lt;- readFullMat("fullmat.dat")

## my.full
# $`1`
#     x1  x2  x3
# x1 1.0 0.3 0.4
# x2 0.3 1.0 0.5
# x3 0.4 0.5 1.0
#
# $`2`
#     x1 x2  x3
# x1 1.0 NA 0.4
# x2  NA NA  NA
# x3 0.4 NA 1.0

## Write two lower triangle correlation matrices into a file named "lowertriangle.dat".
## x2 is missing in the second matrix.
## The content of "lowertriangle.dat" is
# 1.0 
# 0.3 1.0 
# 0.4 0.5 1.0
# 1.0
# NA NA 
# 0.4 NA 1.0
## cat("1.0\n0.3 1.0\n0.4 0.5 1.0\n1.0\nNA NA\n0.4 NA 1.0",
##     file="lowertriangle.dat", sep="")

## Read the lower triangle correlation matrices
## my.lowertri &lt;- readLowTriMat(file = "lowertriangle.dat", no.var = 3)

## my.lowertri
# $`1`
#     x1  x2  x3
# x1 1.0 0.3 0.4
# x2 0.3 1.0 0.5
# x3 0.4 0.5 1.0
#
# $`2`
#     x1 x2  x3
# x1 1.0 NA 0.4
# x2  NA NA  NA
# x3 0.4 NA 1.0

## Write two vectors of correlation coefficients based on
##  column major into a file named "stackvec.dat".
## x2 is missing in the second matrix.
## The content of "stackvec.dat" is
# 1.0 0.3 0.4 1.0 0.5 1.0
# 1.0 NA 0.4 NA NA 1.0
## cat("1.0 0.3 0.4 1.0 0.5 1.0\n1.0 NA 0.4 NA NA 1.0\n",
##     file="stackvec.dat", sep="")

## my.vec &lt;- readStackVec("stackvec.dat")

## my.vec
# $`1`
#     x1  x2  x3
# x1 1.0 0.3 0.4
# x2 0.3 1.0 0.5
# x3 0.4 0.5 1.0
#
# $`2`
#    x1 x2  x3
# x1 1.0 NA 0.4
# x2  NA NA  NA
# x3 0.4 NA 1.0

## End(Not run)
</code></pre>

<hr>
<h2 id='reml'>Estimate Variance Components with Restricted (Residual) Maximum
Likelihood Estimation
</h2><span id='topic+reml'></span>

<h3>Description</h3>

<p>It estimates the variance components of random-effects in univariate and
multivariate meta-analysis with restricted (residual) maximum likelihood
(REML) estimation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reml(y, v, x, data, RE.constraints = NULL, RE.startvalues = 0.1,
     RE.lbound = 1e-10, intervals.type = c("z", "LB"),
     model.name="Variance component with REML",
     suppressWarnings = TRUE, silent = TRUE, run = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reml_+3A_y">y</code></td>
<td>
<p>A vector of effect size for univariate meta-analysis or a <code class="reqn">k</code> x
<code class="reqn">p</code> matrix of effect sizes for multivariate meta-analysis
where <code class="reqn">k</code> is the number of studies and <code class="reqn">p</code> is the
number of effect sizes. 
</p>
</td></tr>
<tr><td><code id="reml_+3A_v">v</code></td>
<td>
<p>A vector of the sampling variance of the effect size for univariate
meta-analysis or a <code class="reqn">k</code> x <code class="reqn">p*</code> matrix of the sampling
covariance matrix of the effect sizes for multivariate meta-analysis
where <code class="reqn">p* = p(p+1)/2 </code>. It is arranged by column
major as used by <code><a href="OpenMx.html#topic+vech">vech</a></code>.
</p>
</td></tr>
<tr><td><code id="reml_+3A_x">x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of predictors
where <code class="reqn">m</code> is the number of predictors.
</p>
</td></tr>
<tr><td><code id="reml_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td></tr>   
<tr><td><code id="reml_+3A_re.constraints">RE.constraints</code></td>
<td>
<p>A <code class="reqn">p</code> x <code class="reqn">p</code> matrix
specifying the variance components of the random effects. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default is that all
covariance/variance components are free. The format of this matrix
follows <code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. Elements of the variance
components can be constrained equally by using the same labels. If a zero matrix is
specified, it becomes a fixed-effects meta-analysis.
</p>
</td></tr>
<tr><td><code id="reml_+3A_re.startvalues">RE.startvalues</code></td>
<td>
<p>A vector of <code class="reqn">p</code> starting values on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be repeated across the diagonals. Starting values for the
off-diagonals of the variance component are all 0. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of starting values is also accepted. 
</p>
</td></tr>
<tr><td><code id="reml_+3A_re.lbound">RE.lbound</code></td>
<td>
<p>A vector of <code class="reqn">p</code> lower bounds on the
diagonals of the variance component of the random effects. If only one
scalar is given, it will be repeated across the diagonals. Lower
bounds for the off-diagonals of the variance component are set at <code>NA</code>. A <code class="reqn">p</code> x
<code class="reqn">p</code> symmetric matrix of the lower bounds is also accepted.
</p>
</td></tr>
<tr><td><code id="reml_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td></tr>
<tr><td><code id="reml_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>  
<tr><td><code id="reml_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.
</p>
</td></tr>
<tr><td><code id="reml_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="reml_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td></tr>  
<tr><td><code id="reml_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Restricted (residual) maximum likelihood obtains the parameter estimates on the transformed data that do not include the fixed-effects parameters. A transformation matrix <code class="reqn">M=I-X(X'X)^{-1}X</code> is created based on the design matrix <code class="reqn">X</code> which is just a column vector when there is no predictor in <code>x</code>. The last <code class="reqn">N</code> redundant rows of <code class="reqn">M</code> is removed where <code class="reqn">N</code> is the rank of <code class="reqn">X</code>. After pre-multiplying by <code class="reqn">M</code> on <code>y</code>, the parameters of fixed-effects are removed from the model. Thus, only the parameters of random-effects are estimated.
</p>
<p>An alternative but equivalent approach is to minimize the
-2*log-likelihood function: </p>
<p style="text-align: center;"><code class="reqn">
	\log(\det|V+T^2|)+\log(\det|X'(V+T^2)^{-1}X|)+(y-X\hat{\alpha})'(V+T^2)^{-1}(y-X\hat{\alpha})</code>
</p>

<p>where <code class="reqn">V</code> is the known conditional sampling covariance matrix
of <code class="reqn">y</code>, <code class="reqn">T^2</code> is the variance component of the random
effects, and <code class="reqn">\hat{\alpha}=(X'(V+T^2)^{-1}X)^{-1}
  X'(V+T^2)^{-1}y</code>. <code>reml()</code>
minimizes the above likelihood function to obtain the parameter estimates.
</p>


<h3>Value</h3>

<p>An object of class <code>reml</code> with a list of
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Object returned by <code><a href="base.html#topic+match.call">match.call</a></code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A data matrix of y, v and x  </p>
</td></tr>
<tr><td><code>no.y</code></td>
<td>
<p>No. of effect sizes</p>
</td></tr>
<tr><td><code>no.x</code></td>
<td>
<p>No. of predictors</p>
</td></tr>
<tr><td><code>miss.vec</code></td>
<td>
<p>A vector indicating missing data. Studies will be removed before the analysis if they are <code>TRUE</code></p>
</td></tr>
<tr><td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from	<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

 <p><code>reml</code> is more computationally intensive than <code>meta</code>. Moreover, <code>reml</code> is more
likely to encounter errors during optimization. Since
a likelihood function is directly employed to obtain the parameter
estimates, there is no number of studies and number of observed statistics
returned by <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>. Ad-hoc steps are used
to modify <code>mx.fit@runstate$objectives[[1]]@numObs</code> and <code>mx.fit@runstate$objectives[[1]]@numStats</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2013). Implementing restricted maximum likelihood
estimation in structural equation models. <em>Structural Equation
Modeling</em>, <b>20(1)</b>, 157-167.
</p>
<p>Mehta, P. D., &amp; Neale, M. C. (2005). People Are Variables Too: Multilevel Structural Equations Modeling. <em>Psychological
Methods</em>, <b>10(3)</b>, 259-284.
</p>
<p>Searle, S. R., Casella, G., &amp; McCulloch, C. E. (1992). <em>Variance components</em>. New York: Wiley.
</p>
<p>Viechtbauer, W. (2005). Bias and efficiency of meta-analytic variance estimators in the random-effects model. <em>Journal of Educational and Behavioral Statistics</em>, <b>30(3)</b>, 261-293.  
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+meta">meta</a></code>, <code><a href="#topic+reml3">reml3</a></code>, <code><a href="#topic+Hox02">Hox02</a></code>, <code><a href="#topic+Berkey98">Berkey98</a></code>

</p>

<hr>
<h2 id='reml3L'>Estimate Variance Components in Three-Level Univariate
Meta-Analysis with Restricted (Residual) Maximum
Likelihood Estimation
</h2><span id='topic+reml3'></span><span id='topic+reml3L'></span>

<h3>Description</h3>

<p>It estimates the variance components of random-effects in three-level
univariate meta-analysis with restricted (residual) maximum likelihood (REML) estimation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Depreciated in the future
reml3(y, v, cluster, x, data, RE2.startvalue=0.1, RE2.lbound=1e-10,
      RE3.startvalue=RE2.startvalue, RE3.lbound=RE2.lbound, RE.equal=FALSE,
      intervals.type=c("z", "LB"), model.name="Variance component with REML",
      suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
reml3L(y, v, cluster, x, data, RE2.startvalue=0.1, RE2.lbound=1e-10,
      RE3.startvalue=RE2.startvalue, RE3.lbound=RE2.lbound, RE.equal=FALSE,
      intervals.type=c("z", "LB"), model.name="Variance component with REML",
      suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reml3L_+3A_y">y</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of effect size. 
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_v">v</code></td>
<td>
<p>A vector of <code class="reqn">k</code> studies of sampling variance.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_cluster">cluster</code></td>
<td>
<p>A vector of <code class="reqn">k</code> characters or numbers indicating the
clusters. 
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_x">x</code></td>
<td>
<p>A predictor or a <code class="reqn">k</code> x <code class="reqn">m</code> matrix of level-2
and level-3 predictors where <code class="reqn">m</code> is the number of predictors. 
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_re2.startvalue">RE2.startvalue</code></td>
<td>
<p>Starting value for the level-2 variance.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_re2.lbound">RE2.lbound</code></td>
<td>
<p>Lower bound for the level-2 variance.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_re3.startvalue">RE3.startvalue</code></td>
<td>
<p>Starting value for the level-3 variance.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_re3.lbound">RE3.lbound</code></td>
<td>
<p>Lower bound for the level-3 variance.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_re.equal">RE.equal</code></td>
<td>
<p>Logical. Whether the variance components at level-2
and level-3 are constrained equally.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald confidence
intervals (CIs) based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.
</p>
</td></tr>
<tr><td><code id="reml3L_+3A_silent">silent</code></td>
<td>
<p>Logical. Argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="reml3L_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without running the analysis.</p>
</td></tr>  
<tr><td><code id="reml3L_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Restricted (residual) maximum likelihood obtains the parameter estimates on the transformed data that do not include the fixed-effects parameters. A transformation matrix <code class="reqn">M=I-X(X'X)^{-1}X</code> is created based on the design matrix <code class="reqn">X</code> which is just a column vector when there is no predictor in <code>x</code>. The last <code class="reqn">N</code> redundant rows of <code class="reqn">M</code> is removed where <code class="reqn">N</code> is the rank of <code class="reqn">X</code>. After pre-multiplying by <code class="reqn">M</code> on <code>y</code>, the parameters of fixed-effects are removed from the model. Thus, only the parameters of random-effects are estimated.
</p>
<p>An alternative but the equivalent approach is to minimize the
-2*log-likelihood function: </p>
<p style="text-align: center;"><code class="reqn">
	\log(\det|V+T^2|)+\log(\det|X'(V+T^2)^{-1}X|)+(y-X\hat{\alpha})'(V+T^2)^{-1}(y-X\hat{\alpha})</code>
</p>

<p>where <code class="reqn">V</code> is the known conditional sampling covariance matrix
of <code class="reqn">y</code>, <code class="reqn">T^2</code> is the variance component combining
level-2 and level-3 random effects, and <code class="reqn">\hat{\alpha}=(X'(V+T^2)^{-1}X)^{-1}
  X'(V+T^2)^{-1}y</code>. <code>reml()</code>
minimizes the above likelihood function to obtain the parameter estimates.
</p>


<h3>Value</h3>

<p>An object of class <code>reml</code> with a list of
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>Object returned by <code><a href="base.html#topic+match.call">match.call</a></code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A data matrix of y, v, and x  </p>
</td></tr>



<tr><td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from	<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

 <p><code>reml</code> is more computationally intensive than <code>meta</code>. Moreover, <code>reml</code> is more
likely to encounter errors during optimization. Since
a likelihood function is directly employed to obtain the parameter
estimates, there is no number of studies and number of observed statistics
returned by <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>. Ad-hoc steps are used
to modify <code>mx.fit@runstate$objectives[[1]]@numObs</code> and <code>mx.fit@runstate$objectives[[1]]@numStats</code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2013). Implementing restricted maximum likelihood estimation in structural equation models. <em>Structural Equation Modeling</em>, <b>20(1)</b>, 157-167.
</p>
<p>Cheung, M. W.-L. (2014). Modeling dependent effect sizes with three-level meta-analyses: A structural equation modeling approach. <em>Psychological Methods</em>, <b>19</b>, 211-229.
</p>
<p>Mehta, P. D., &amp; Neale, M. C. (2005). People Are Variables Too: Multilevel Structural Equations Modeling. <em>Psychological
Methods</em>, <b>10(3)</b>, 259-284.
</p>
<p>Searle, S. R., Casella, G., &amp; McCulloch, C. E. (1992). <em>Variance components</em>. New York: Wiley.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+meta3L">meta3L</a></code>, <code><a href="#topic+reml">reml</a></code>, <code><a href="#topic+Cooper03">Cooper03</a></code>, <code><a href="#topic+Bornmann07">Bornmann07</a></code>

</p>

<hr>
<h2 id='rerun'>Rerun models via mxTryHard()
</h2><span id='topic+rerun'></span>

<h3>Description</h3>

<p>It reruns models via mxTryHard().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rerun(object, autofixtau2=FALSE, extraTries=10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rerun_+3A_object">object</code></td>
<td>
<p>An object of either class <code>tssem1FEM</code>,
class <code>tssem1REM</code>, class <code>wls</code>, class <code>meta</code>, class
<code>reml</code>, class <code>osmasem</code>, class <code>osmasem3L</code>, and class <code>MxModel</code>.
</p>
</td></tr>
<tr><td><code id="rerun_+3A_autofixtau2">autofixtau2</code></td>
<td>
<p>Logical. Whether automatically fixes elements of tau2
with NA of standard errors. It only works for objects of
class <code>tssem1REM</code>, class <code>meta</code>, and class <code>osmasem</code>.</p>
</td></tr>
<tr><td><code id="rerun_+3A_extratries">extraTries</code></td>
<td>
<p>The number of attempts to run the model in addition to the first.</p>
</td></tr>  
<tr><td><code id="rerun_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxTryHard">mxTryHard</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
random1 &lt;- tssem1(Digman97$data, Digman97$n, method="REM", RE.type="Diag")
random1_rerun &lt;- rerun(random1)
summary(random1_rerun)

## End(Not run)
</code></pre>

<hr>
<h2 id='Roorda11'>Studies on Students' School Engagement and Achievement Reported
by Roorda et al. (2011)
</h2><span id='topic+Roorda11'></span>

<h3>Description</h3>

<p>The data set includes 45 studies on the influence of affective teacher-student relationships on students' school engagement and
achievement reported by Roorda et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Roorda11)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>data</dt><dd><p>A list of 45 studies of correlation matrices. The
variables are <em>pos</em> (positive teacher-student relations),
<em>neg</em> (negative teacher-student relations), <em>enga</em>
(student engagement), and <em>achiev</em> (student achievement).</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>SES</dt><dd><p>A vector of average socio-economic status (SES) of the samples</p>
</dd>
</dl>



<h3>Source</h3>

<p>Roorda, D. L., Koomen, H. M. Y., Spilt, J. L., &amp; Oort, F. J. (2011). The influence of affective teacher-student relationships on students' school engagement and achievement a meta-analytic approach. <em>Review of Educational Research</em>, <em>81</em>(4), 493-529.
</p>


<h3>References</h3>

<p>Jak, S., &amp; Cheung, M. W.-L. (2018). Addressing heterogeneity in meta-analytic structural equation modeling using subgroup analysis. <em>Behavior Research
Methods</em>, <b>50</b>, 1359-1373. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Random-effects model: First stage analysis
random1 &lt;- tssem1(Cov = Roorda11$data, n = Roorda11$n, method = "REM",
                  RE.type = "Diag")
summary(random1)

varnames &lt;- c("pos", "neg", "enga", "achiev")

## Prepare a regression model using create.mxMatrix()
A &lt;- create.mxMatrix(c(0,0,0,0,
                       0,0,0,0,
                       "0.1*b31","0.1*b32",0,0,
                       0,0,"0.1*b43",0),
                     type = "Full", nrow = 4, ncol = 4, byrow = TRUE,
                     name = "A", as.mxMatrix = FALSE)

## This step is not necessary but it is useful for inspecting the model.
dimnames(A) &lt;- list(varnames, varnames)
A

S &lt;- create.mxMatrix(c(1,
                       ".5*p21",1,
                       0,0,"0.6*p33",
                       0,0,0,"0.6*p44"), 
                     type="Symm", byrow = TRUE,
                     name="S", as.mxMatrix = FALSE)

## This step is not necessary but it is useful for inspecting the model.
dimnames(S) &lt;- list(varnames, varnames)
S

## Random-effects model: Second stage analysis
random2 &lt;- tssem2(random1, Amatrix=A, Smatrix=S, diag.constraints=TRUE, 
                  intervals="LB")
summary(random2)

## Display the model with the parameter estimates    
plot(random2)

## End(Not run)
</code></pre>

<hr>
<h2 id='Scalco17'>Correlation Matrices from Scalco et al. (2017)</h2><span id='topic+Scalco17'></span>

<h3>Description</h3>

<p>The data set includes correlation matrices using the theory of planned
behavior to predict organic food consumption reported by Scalco17 et al. (2017). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Scalco17)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>data</dt><dd><p>A list of correlation matrices. The variables are
<em>ATT</em> (attitude), <em>SN</em> (subjective norm), <em>PBC</em>
(perceived behavior control), <em>BI</em> (behavioral intention), and <em>BEH</em> (behavior)</p>
</dd>
<dt>n</dt><dd><p>A vector of sample sizes</p>
</dd>
<dt>Age</dt><dd><p>A vector of the mean age of the samples</p>
</dd>
<dt>Female</dt><dd><p>A vector of the percentage of the female samples</p>
</dd>
</dl>



<h3>Source</h3>

<p>Scalco, A., Noventa, S., Sartori, R., &amp; Ceschi, A. (2017). Predicting organic food consumption: A meta-analytic structural equation model based on the theory of planned behavior. <em>Appetite</em>, <b>112</b>, 235-248.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Scalco17)
</code></pre>

<hr>
<h2 id='smdMES'>Compute Effect Sizes for Multiple End-point Studies
</h2><span id='topic+smdMES'></span>

<h3>Description</h3>

<p>It computes the standardized mean differences and their asymptotic sampling
covariance matrix for two multiple end-point studies with <em>p</em>
effect sizes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smdMES(m1, m2, V1, V2, n1, n2,
       homogeneity=c("covariance", "correlation", "none"), 
       bias.adjust=TRUE, list.output=TRUE, lavaan.output=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smdMES_+3A_m1">m1</code></td>
<td>
<p>A vector of <em>p</em> sample means of the first group.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_m2">m2</code></td>
<td>
<p>A vector of <em>p</em> sample means of the second group.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_v1">V1</code></td>
<td>
<p>A <em>p</em> by <em>p</em> sample covariance matrix of the first
group.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_v2">V2</code></td>
<td>
<p>A <em>p</em> by <em>p</em> sample covariance matrix of the second
group.</p>
</td></tr>  
<tr><td><code id="smdMES_+3A_n1">n1</code></td>
<td>
<p>The sample size of the first group.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_n2">n2</code></td>
<td>
<p>The sample size of the second group.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_homogeneity">homogeneity</code></td>
<td>
<p>If it is <code>covariance</code> (the default),
homogeneity of covariance matrices is assumed. The common standard
deviations are used as the standardizers in calculating the effect
sizes. If it is <code>correlation</code>, homogeneity of correlation is
not assumed. The standard deviations of the first group are used as the
standardizer in calculating the effect sizes. If it is <code>none</code>,
no homogeneity assumption is made. The standard deviations of the first group are used as the
standardizer in calculating the effect sizes.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_bias.adjust">bias.adjust</code></td>
<td>
<p>If it is <code>TRUE</code> (the default), the effect sizes are
adjusted for small bias by multiplying <code class="reqn">1-3/(4*(n1+n2)-9)</code>.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_list.output">list.output</code></td>
<td>
<p>If it is <code>TRUE</code> (the default), the effect
sizes and their sampling covariance matrix are outputed as a
list. If it is <code>FALSE</code>, they will be stacked into a vector.</p>
</td></tr>
<tr><td><code id="smdMES_+3A_lavaan.output">lavaan.output</code></td>
<td>
<p>If it is <code>FALSE</code> (the default), the effect
sizes and its sampling covariance matrix are reported. If it is
<code>TRUE</code>, it outputs the fitted
<code><a href="lavaan.html#topic+lavaan-class">lavaan-class</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gleser and Olkin (2009) introduce formulas to calculate the
standardized mean differences and their sampling covariance matrix for
multiple end-point studies under the assumption of homogeneity of the
covariance matrix. This function uses a structural equation modeling (SEM)
approach introduced in Chapter 3 of Cheung (2015) to calculate the
same estimates. The SEM approach is more flexible in two ways: (1)
it allows homogeneity of covariance or correlation matrices or not; and
(2) it allows users to test this assumption by checking the fitted
<code><a href="lavaan.html#topic+lavaan-class">lavaan-class</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation
modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L. (2018). Computing multivariate effect sizes and their sampling covariance matrices with structural equation modeling: Theory, examples, and computer simulations. <em>Frontiers in Psychology</em>, <b>9</b>(1387). https://doi.org/10.3389/fpsyg.2018.01387
</p>
<p>Gleser, L. J., &amp; Olkin, I. (2009). Stochastically dependent effect
sizes. In H. Cooper, L. V. Hedges, &amp; J. C. Valentine (Eds.), <em>The handbook of research synthesis and meta-analysis</em>. (2nd ed., pp. 357-376). New York: Russell Sage Foundation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Gleser94">Gleser94</a></code>, <code><a href="#topic+smdMTS">smdMTS</a></code>, <code><a href="#topic+calEffSizes">calEffSizes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:     
## Sample means for the two constructs in Group 1  
m1 &lt;- c(2.5, 4.5)

## Sample means for the two constructs in Group 2     
m2 &lt;- c(3, 5)

## Sample covariance matrix in Group 1    
V1 &lt;- matrix(c(3,2,2,3), ncol=2)

## Sample covariance matrix in Group 2
V2 &lt;- matrix(c(3.5,2.1,2.1,3.5), ncol=2)

## Sample size in Group 1
n1 &lt;- 20

## Sample size in Group 2    
n2 &lt;- 25

## SMD with the assumption of homogeneity of covariance matrix    
smdMES(m1, m2, V1, V2, n1, n2, homogeneity="cov", bias.adjust=TRUE,
       lavaan.output=FALSE)

## SMD with the assumption of homogeneity of correlation matrix 
smdMES(m1, m2, V1, V2, n1, n2, homogeneity="cor", bias.adjust=TRUE,
       lavaan.output=FALSE)

## SMD without any assumption of homogeneity
smdMES(m1, m2, V1, V2, n1, n2, homogeneity="none", bias.adjust=TRUE,
       lavaan.output=FALSE)

## Output the fitted lavaan model
## It provides a likelihood ratio test to test the null hypothesis of
## homogeneity of variances.     
fit &lt;- smdMES(m1, m2, V1, V2, n1, n2, homogeneity="cov", bias.adjust=TRUE,
              lavaan.output=TRUE)

lavaan::summary(fit)

lavaan::parameterestimates(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='smdMTS'>Compute Effect Sizes for Multiple Treatment Studies
</h2><span id='topic+smdMTS'></span>

<h3>Description</h3>

<p>It computes the standardized mean differences and their asymptotic sampling
covariance matrix for <em>k</em> multiple treatment studies. The first group is
assumed as the control group. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smdMTS(m, v, n, homogeneity=c("variance", "none"), bias.adjust=TRUE, 
       all.comparisons=FALSE, list.output=TRUE, lavaan.output=FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smdMTS_+3A_m">m</code></td>
<td>
<p>A vector of <em>k</em> sample means.</p>
</td></tr>
<tr><td><code id="smdMTS_+3A_v">v</code></td>
<td>
<p>A vector of <em>k</em> sample variances.</p>
</td></tr>
<tr><td><code id="smdMTS_+3A_n">n</code></td>
<td>
<p>A vector of <em>k</em> sample sizes.</p>
</td></tr>
<tr><td><code id="smdMTS_+3A_homogeneity">homogeneity</code></td>
<td>
<p>If it is <code>variance</code> (the default), homogeneity of variances
is assumed. The common standard deviation is used as the
standardizer in calculating the effect sizes. If it is <code>none</code>, homogeneity of variances is not
assumed. The standard deviation of the first group is used as the
standardizer in calculating the effect sizes.</p>
</td></tr>
<tr><td><code id="smdMTS_+3A_bias.adjust">bias.adjust</code></td>
<td>
<p>If it is <code>TRUE</code> (the default), the effect sizes are
adjusted for small bias by multiplying <code class="reqn">1-3/(4*(n1+n2)-9)</code>.</p>
</td></tr>  
<tr><td><code id="smdMTS_+3A_all.comparisons">all.comparisons</code></td>
<td>
<p>If it is <code>FALSE</code> (the default), all groups
(except the first group) are compared against the first group. If it
is <code>TRUE</code>, all pairwise comparisons are calculated. This may be
useful in network meta-analysis.</p>
</td></tr>
<tr><td><code id="smdMTS_+3A_list.output">list.output</code></td>
<td>
<p>If it is <code>TRUE</code> (the default), the effect
sizes and their sampling covariance matrix are outputed as a
list. If it is <code>FALSE</code>, they will be stacked into a vector.</p>
</td></tr>  
<tr><td><code id="smdMTS_+3A_lavaan.output">lavaan.output</code></td>
<td>
<p>If it is <code>FALSE</code> (the default), the effect
sizes and its sampling covariance matrix are reported. If it is
<code>TRUE</code>, it outputs the fitted
<code><a href="lavaan.html#topic+lavaan-class">lavaan-class</a></code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gleser and Olkin (2009) introduce formulas to calculate the
standardized mean differences and their sampling covariance matrix for
multiple treatment studies under the assumption of homogeneity of the
covariance matrix. This function uses a structural equation modeling (SEM)
approach introduced in Chapter 3 of Cheung (2015) to calculate the
same estimates. The SEM approach is more flexible in three ways: (1)
it allows homogeneity of variances or not; (2) it allows users to test
the assumption of homogeneity of variances by checking the fitted
<code><a href="lavaan.html#topic+lavaan-class">lavaan-class</a></code> object; and (3) it may calculate all
pairwise comparisons.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L. (2018). Computing multivariate effect sizes and their sampling covariance matrices with structural equation modeling: Theory, examples, and computer simulations. <em>Frontiers in Psychology</em>, <b>9</b>(1387). https://doi.org/10.3389/fpsyg.2018.01387
</p>
<p>Gleser, L. J., &amp; Olkin, I. (2009). Stochastically dependent effect sizes. In H. Cooper, L. V. Hedges, &amp; J. C. Valentine (Eds.), <em>The handbook of research synthesis and meta-analysis</em>. (2nd ed., pp. 357-376). New York: Russell Sage Foundation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Gleser94">Gleser94</a></code>, <code><a href="#topic+smdMES">smdMES</a></code>, <code><a href="#topic+calEffSizes">calEffSizes</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:   
## Sample means for groups 1 to 3
m &lt;- c(5,7,9)

## Sample variances
v &lt;- c(10,11,12)

## Sample sizes
n &lt;- c(50,52,53)

## Assuming homogeneity of variances
smdMTS(m, v, n, homogeneity = "var", bias.adjust=TRUE, all.comparisons=FALSE,
       lavaan.output=FALSE)

## Not assuming homogeneity of variances and comparing all pairwise groups
## Please note that the SD of the first group is used as the standardizer    
smdMTS(m, v, n, homogeneity = "none", bias.adjust=TRUE, all.comparisons=TRUE,
       lavaan.output=FALSE)

## Output the fitted lavaan model
## It provides a likelihood ratio test to test the null hypothesis of
## homogeneity of variances.    
fit &lt;- smdMTS(m, v, n, homogeneity = "var", bias.adjust=FALSE, all.comparisons=FALSE,
              lavaan.output=TRUE)

lavaan::summary(fit)
    
lavaan::parameterestimates(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='Stadler15'>Correlations from Stadler et al. (2015)</h2><span id='topic+Stadler15'></span>

<h3>Description</h3>

<p>The data set includes correlations between complex problem solving and
intelligence reported by Stadler et al. (2015). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Stadler15)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>ID</dt><dd><p>ID of the effect sizes</p>
</dd>
<dt>Authors</dt><dd><p>Authors of the studies</p>
</dd>
<dt>Year</dt><dd><p>Year of the studies</p>
</dd>
<dt>N</dt><dd><p>Sample size</p>
</dd>
<dt>CPSMeasure</dt><dd><p>Complex problem solving (CPS) measure</p>
</dd>
<dt>IntelligenceMeasure</dt><dd><p>Intelligence measure</p>
</dd>
<dt>r</dt><dd><p>Correlation between CPS and intelligence</p>
</dd>
<dt>v</dt><dd><p>Sampling variance of r</p>
</dd>
</dl>



<h3>Source</h3>

<p>Stadler, M., Becker, N., Godker, M., Leutner, D., &amp; Greiff, S. (2015). Complex problem solving and intelligence: A meta-analysis. <em>Intelligence</em>, <b>53</b>, 92-101.
</p>

<hr>
<h2 id='summary'>Summary Method for tssem1, wls, meta, and meta3LFIML Objects
</h2><span id='topic+summary.tssem1FEM'></span><span id='topic+summary.tssem1FEM.cluster'></span><span id='topic+summary.tssem1REM'></span><span id='topic+summary.wls'></span><span id='topic+summary.wls.cluster'></span><span id='topic+summary.meta'></span><span id='topic+summary.meta3LFIML'></span><span id='topic+summary.reml'></span><span id='topic+summary.CorPop'></span><span id='topic+summary.Cor3L'></span><span id='topic+summary.bootuniR2'></span><span id='topic+summary.osmasem'></span><span id='topic+print.summary.tssem1FEM'></span><span id='topic+print.summary.tssem1FEM.cluster'></span><span id='topic+print.summary.wls'></span><span id='topic+print.summary.meta'></span><span id='topic+print.summary.meta3LFIML'></span><span id='topic+print.summary.reml'></span><span id='topic+print.summary.CorPop'></span><span id='topic+print.summary.Cor3L'></span><span id='topic+print.summary.bootuniR2'></span>

<h3>Description</h3>

<p>It summaries results for various class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tssem1FEM'
summary(object, ...)
## S3 method for class 'tssem1FEM.cluster'
summary(object, ...)
## S3 method for class 'tssem1REM'
summary(object, robust=FALSE, ...)
## S3 method for class 'wls'
summary(object, df.adjustment=0, ...)
## S3 method for class 'wls.cluster'
summary(object, df.adjustment=0, ...)
## S3 method for class 'meta'
summary(object, homoStat=TRUE, robust=FALSE, ...)
## S3 method for class 'meta3LFIML'
summary(object, allX=FALSE, robust=FALSE, ...)
## S3 method for class 'reml'
summary(object, ...)
## S3 method for class 'CorPop'
summary(object, ...)
## S3 method for class 'Cor3L'
summary(object, ...)
## S3 method for class 'bootuniR2'
summary(object, probs=c(0, 0.1, 0.5, 0.9, 1),
        cutoff.chisq.pvalue=0.05, cutoff.CFI=0.9, cutoff.SRMR=0.1,
        cutoff.RMSEA=0.05, ...)
## S3 method for class 'osmasem'
summary(object, fitIndices=FALSE, numObs, robust=FALSE, ...)
## S3 method for class 'tssem1FEM'
print.summary(x, ...)
## S3 method for class 'wls'
print.summary(x, ...)
## S3 method for class 'meta'
print.summary(x, ...)
## S3 method for class 'meta3LFIML'
print.summary(x, ...)
## S3 method for class 'reml'
print.summary(x, ...)
## S3 method for class 'CorPop'
print.summary(x, ...)
## S3 method for class 'Cor3L'
print.summary(x, ...)
## S3 method for class 'bootuniR2'
print.summary(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An object returned from either class
<code>tssem1FEM</code>, class <code>tssem1FEM.cluster</code>,
class <code>tssem1REM</code>, class <code>wls</code>, class <code>wls.cluster</code>,
class <code>meta</code>, class <code>meta3LFIML</code>, class <code>reml</code> or class <code>CorPop</code>.
</p>
</td></tr>
<tr><td><code id="summary_+3A_x">x</code></td>
<td>
<p>An object returned from either class <code>summary.tssem1FEM</code>,
class <code>tssem1FEM.cluster</code>, class <code>summary.wls</code>, class
<code>summary.meta</code>, class <code>summary.meta3LFIML</code>, class
<code>summary.reml</code> or class <code>summary.CorPop</code>.
</p>
</td></tr>
<tr><td><code id="summary_+3A_homostat">homoStat</code></td>
<td>
<p>Logical. Whether to conduct a homogeneity test on the
effect sizes.</p>
</td></tr>
<tr><td><code id="summary_+3A_allx">allX</code></td>
<td>
<p>Logical. Whether to report the predictors and the
auxiliary variables.</p>
</td></tr>
<tr><td><code id="summary_+3A_robust">robust</code></td>
<td>
<p>Logicial. Whether to use robust standard error from <code><a href="OpenMx.html#topic+imxRobustSE">imxRobustSE</a></code>.
</p>
</td></tr>
<tr><td><code id="summary_+3A_df.adjustment">df.adjustment</code></td>
<td>
<p>Numeric. Adjust the degrees of freedom
manually. It may be necessary if the df calculated is incorrect when
<code>diag.constraints=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="summary_+3A_probs">probs</code></td>
<td>
<p>Quantiles for the parameter estimates.</p>
</td></tr>
<tr><td><code id="summary_+3A_cutoff.chisq.pvalue">cutoff.chisq.pvalue</code></td>
<td>
<p>Cutoff of the p-value for the chi-square
statistic.</p>
</td></tr>
<tr><td><code id="summary_+3A_cutoff.cfi">cutoff.CFI</code></td>
<td>
<p>The cutoff of the CFI.</p>
</td></tr>
<tr><td><code id="summary_+3A_cutoff.srmr">cutoff.SRMR</code></td>
<td>
<p>The cutoff of the SRMR.</p>
</td></tr>
<tr><td><code id="summary_+3A_cutoff.rmsea">cutoff.RMSEA</code></td>
<td>
<p>The cutoff of the RMSEA.</p>
</td></tr>
<tr><td><code id="summary_+3A_fitindices">fitIndices</code></td>
<td>
<p>Whether to calculate the chi-square statistic and
various goodness-of-fit indices in osmasem. Note. It may take a
while since statistics of the saturated and independence models are required.</p>
</td></tr>
<tr><td><code id="summary_+3A_numobs">numObs</code></td>
<td>
<p>The number of observations in calculating the fit statistics
in osmasem. If it is missing, the total number of observations is used.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="stats.html#topic+printCoefmat">printCoefmat</a></code>
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the OpenMx status1 is either 0 or 1, the estimation is
considered fine. If the OpenMx status1 is other values, it indicates
estimation problems. Users should refer to <a href="https://openmx.ssri.psu.edu//wiki/errors">https://openmx.ssri.psu.edu//wiki/errors</a> for more details.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;

</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tssem1">tssem1</a></code>, <code><a href="#topic+wls">wls</a></code>,
<code><a href="#topic+meta">meta</a></code>, <code><a href="#topic+reml">reml</a></code>,
<code><a href="#topic+rCor">rCor</a></code>, <code><a href="#topic+bootuniR2">bootuniR2</a></code>,
<code><a href="#topic+osmasem">osmasem</a></code>
</p>

<hr>
<h2 id='Tenenbaum02'>Correlation coefficients reported by Tenenbaum and Leaper (2002)</h2><span id='topic+Tenenbaum02'></span>

<h3>Description</h3>

<p>Forty-eight studies reported by Tenenbaum and Leaper (2002, Table 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Tenenbaum02)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>Authors</dt><dd><p>Authors of the study</p>
</dd>
<dt>Year</dt><dd><p>Year of publication</p>
</dd>	
<dt>N</dt><dd><p>Sample size</p>
</dd>
<dt>r</dt><dd><p>Correlation between parents' gender schemas and their
offspring's gender-related cognitions.</p>
</dd>
<dt>v</dt><dd><p>Sampling variance of r</p>
</dd>
<dt>Publication_source</dt><dd><p>Publication source: 1=&quot;top-tier journal&quot;,
2=&quot;second-tier journal or book chapter&quot;, 3=&quot;dissertation&quot;, 4=&quot;other unpublished study&quot;</p>
</dd>
<dt>Author_gender</dt><dd><p>Gender of the first author: &quot;W&quot;=&quot;woman&quot;, &quot;M&quot;=&quot;man&quot;</p>
</dd>
<dt>Parent_type</dt><dd><p>Parent type: &quot;M&quot;=&quot;mother&quot;, &quot;F&quot;=&quot;father&quot;, &quot;MF&quot;=&quot;mother and father&quot;</p>
</dd>
<dt>Parent_predictor</dt><dd><p>Parent predictor: &quot;S&quot;=&quot;self gender schema&quot;, &quot;A&quot;=&quot;gender attitudes about others&quot;</p>
</dd>
<dt>Offspring_age</dt><dd><p>Offspring age (months)</p>
</dd>
<dt>Offspring_type</dt><dd><p>Offspring type: &quot;D&quot;=&quot;daughter&quot;,
&quot;S&quot;=&quot;son&quot;, &quot;DS&quot;=&quot;daughter and son&quot;</p>
</dd>
<dt>Offspring_outcome</dt><dd><p>Offspring outcome:
&quot;S&quot;=&quot;gender schema for self&quot;, &quot;A&quot;=&quot;gender attitudes toward others&quot;,
&quot;I&quot;=&quot;gender-related interests and preferences&quot;, &quot;W&quot;=&quot;work-related attitudes&quot;</p>
</dd>  
</dl>



<h3>Source</h3>

<p>Tenenbaum, H. R., &amp; Leaper, C. (2002). Are parents' gender schemas related to their children's gender-related cognitions? A meta-analysis. <em>Developmental Psychology</em>, <em>38</em>(4), 615-630. https://doi.org/10.1037/0012-1649.38.4.615
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Tenenbaum02)

## End(Not run)
</code></pre>

<hr>
<h2 id='tssem1'>First Stage of the Two-Stage Structural Equation Modeling (TSSEM)
</h2><span id='topic+tssem1'></span><span id='topic+tssem1FEM'></span><span id='topic+tssem1REM'></span>

<h3>Description</h3>

<p>It conducts the first stage analysis of TSSEM by pooling
correlation/covariance matrices. <code>tssem1FEM()</code> and
<code>tssem1REM()</code> use fixed- and random-effects models,
respectively. <code>tssem1()</code> is a wrapper of these functions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tssem1(Cov, n, method=c("REM","FEM"), cor.analysis = TRUE, cluster=NULL,
       RE.type=c("Diag", "Symm", "Zero", "User"), RE.startvalues=0.1,
       RE.lbound=1e-10, RE.constraints=NULL, I2="I2q",
       acov=c("weighted", "individual", "unweighted"), asyCovOld=FALSE,
       model.name=NULL, suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
tssem1FEM(Cov, n, cor.analysis=TRUE, model.name=NULL,
          cluster=NULL, suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
tssem1REM(Cov, n, cor.analysis=TRUE, RE.type=c("Diag", "Symm", "Zero","User"),
          RE.startvalues=0.1, RE.lbound=1e-10, RE.constraints=NULL,
          I2="I2q", acov=c("weighted", "individual", "unweighted"),
          asyCovOld=FALSE, model.name=NULL, suppressWarnings=TRUE,
          silent=TRUE, run=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tssem1_+3A_cov">Cov</code></td>
<td>
<p>A list of correlation/covariance matrices
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_n">n</code></td>
<td>
<p>A vector of sample sizes
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_method">method</code></td>
<td>
<p>Either <code>"REM"</code> (default if missing) or <code>"FEM"</code>.
If it is &quot;REM&quot;,a random-effects meta-analysis will be applied. If it
is &quot;FEM&quot;, a fixed-effects meta-analysis will be applied. 
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Logical. The output is either a pooled correlation or a covariance matrix.
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_cluster">cluster</code></td>
<td>
<p>A character vector in <code>tssem3L1</code> and
<code>tssemRobust1</code> or a vector of characters or numbers indicating the
clusters in <code>tssem1</code>. Analyses will be conducted for each cluster. It will be
ignored when <code>method="REM"</code>.
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_re.type">RE.type</code></td>
<td>
<p>Either <code>"Diag"</code>, <code>"Symm"</code>,  
<code>"Zero"</code> or <code>"User"</code>. If it is
<code>"Diag"</code>, a diagonal matrix is used for the random effects
meaning that the random effects are independent. If it is <code>"Symm"</code> (default if missing), a
symmetric matrix is used for the random effects on the covariances
among the correlation (or covariance) vectors. If it is
<code>"Zero"</code>, there is no random effects which is similar to the
conventional Generalized Least Squares (GLS) approach to
fixed-effects analysis.
<code>"User"</code>, the user has to specify the variance component via the
<code>RE.constraints</code> argument. This argument will be ignored when <code>method="FEM"</code>.</p>
</td></tr>
<tr><td><code id="tssem1_+3A_re.startvalues">RE.startvalues</code></td>
<td>
<p>Starting values on the
diagonals of the variance component of the random effects. It will be ignored when <code>method="FEM"</code>.</p>
</td></tr>
<tr><td><code id="tssem1_+3A_re.lbound">RE.lbound</code></td>
<td>
<p>Lower bounds on the diagonals of the variance
component of the random effects. It will be ignored when
<code>method="FEM"</code>.</p>
</td></tr>
<tr><td><code id="tssem1_+3A_re.constraints">RE.constraints</code></td>
<td>
<p>A <code class="reqn">p*</code> x <code class="reqn">p*</code> matrix
specifying the variance components of the random effects, where
<code class="reqn">p*</code> is the number of effect sizes. If the input
is not a matrix, it is converted into a matrix by
<code>as.matrix()</code>. The default is that all
covariance/variance components are free. The format of this matrix
follows <code><a href="#topic+as.mxMatrix">as.mxMatrix</a></code>. Elements of the variance
components can be constrained equally by using the same labels. If a zero matrix is
specified, it becomes a fixed-effects meta-analysis.
</p>
</td></tr>  
<tr><td><code id="tssem1_+3A_i2">I2</code></td>
<td>
<p>Possible options are <code>"I2q"</code>, <code>"I2hm"</code> and
<code>"I2am"</code>. They represent the <code>I2</code> calculated by using a
typical within-study sampling variance from the Q statistic, the
harmonic mean and the arithmetic mean of the within-study sampling
variances (Xiong, Miller, &amp; Morris, 2010). More than one options are possible. If <code>intervals.type="LB"</code>, 95% confidence intervals on the heterogeneity indices will be constructed. 
</p>
</td></tr>
<tr><td><code id="tssem1_+3A_acov">acov</code></td>
<td>
<p>If it is <code>individual</code>, the sampling variance-covariance
matrices are calculated based on individual correlation/covariance
matrix. If it is either <code>unweighted</code> or <code>weighted</code> (the default), the average
correlation/covariance matrix is calculated based on the unweighted
or weighted mean with the sample sizes. The average
correlation/covariance matrix is used to calculate the sampling
variance-covariance matrices. This argument is ignored with the
<code>method="FEM"</code> argument.</p>
</td></tr>
<tr><td><code id="tssem1_+3A_asycovold">asyCovOld</code></td>
<td>
<p>Whether the old <code>asyCov</code> is used. See <code><a href="#topic+asyCov">asyCov</a></code>.</p>
</td></tr>  
<tr><td><code id="tssem1_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in <code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. 
</p>
</td></tr>  
<tr><td><code id="tssem1_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="tssem1_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="tssem1_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr> 
<tr><td><code id="tssem1_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either an object of class <code>tssem1FEM</code> for fixed-effects TSSEM,
an object of class <code>tssem1FEM.cluster</code> for fixed-effects TSSEM
with <code>cluster</code> argument, or an object of class <code>tssem1REM</code>
for random-effects TSSEM. 
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2014). Fixed- and random-effects meta-analytic structural equation modeling: Examples and analyses in R. <em>Behavior Research Methods</em>, <b>46</b>, 29-40.
</p>
<p>Cheung, M. W.-L. (2013). Multivariate meta-analysis as structural equation models. <em>Structural Equation Modeling</em>, <b>20</b>,
429-454.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation modeling: A two-stage approach. <em>Psychological Methods</em>, <b>10</b>, 40-64.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2009). A two-stage approach to synthesizing covariance matrices in meta-analytic structural equation modeling. <em>Structural Equation Modeling</em>, <b>16</b>, 28-53.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+wls">wls</a></code>, <code><a href="#topic+Cheung09">Cheung09</a></code>,
<code><a href="#topic+Becker92">Becker92</a></code>, <code><a href="#topic+Digman97">Digman97</a></code>, <code><a href="#topic+issp89">issp89</a></code>, <code><a href="#topic+issp05">issp05</a></code>
</p>

<hr>
<h2 id='tssemParaVar'>Estimate the heterogeneity (SD) of the parameter estimates of the
TSSEM object
</h2><span id='topic+tssemParaVar'></span>

<h3>Description</h3>

<p>It estimates the heterogeneity of the parameter estimates
of the TSSEM objects using either the bootstrap or the delta methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tssemParaVar(tssem1.obj, tssem2.obj, method=c("bootstrap", "delta"),
             interval=0.8, Rep=50, output=c("data.frame", "matrices"),
             nonPD.pop=c("replace", "nearPD", "accept"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tssemParaVar_+3A_tssem1.obj">tssem1.obj</code></td>
<td>
<p>An object of class <code>tssem1REM</code> returned from <code>tssem1()</code>
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_tssem2.obj">tssem2.obj</code></td>
<td>
<p>An object of class <code>wls</code> returned from
<code>tssem2()</code> or <code>wls()</code>
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_method">method</code></td>
<td>
<p>If it is <code>bootstrap</code>, random correlation matrices
are sampled from the <code>tssem1.obj</code> by the parametric bootstrap. If
it is <code>delta</code>, the delta method is used to estimate the
heterogeneity of the parameter estimates.
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_interval">interval</code></td>
<td>
<p>The desired interval, e.g., .8 or .95.
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_rep">Rep</code></td>
<td>
<p>The number of parametric bootstrap. It is ignored when the
method is <code>delta</code>.
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_output">output</code></td>
<td>
<p>Either a <code>data.frame</code> or <code>matrices</code> of the output.
</p>
</td></tr>
<tr><td><code id="tssemParaVar_+3A_nonpd.pop">nonPD.pop</code></td>
<td>
<p>If it is <code>replace</code>, generated non-positive
definite matrices are replaced by generated new ones which are
positive definite. If it is <code>nearPD</code>, they are replaced by
nearly positive definite matrices by calling
<code>Matrix::nearPD()</code>. If it is <code>accept</code>, they are accepted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap method is based on the discussion in Cheung (2018)
and Yu et al. (2016). The delta method is an alternative method to
obtain the heterogeneity.
</p>


<h3>Value</h3>

<p>Either a <code>data.frame</code> or <code>matrices</code> of the output.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2018). Issues in solving the problem of effect size
heterogeneity in meta-analytic structural equation modeling: A
commentary and simulation study on Yu, Downes, Carter, and O'Boyle
(2016). <em>Journal of Applied Psychology</em>, <b>103</b>, 787-803.
</p>
<p>Yu, J. (Joya), Downes, P. E., Carter, K. M., &amp; O'Boyle,
E. H. (2016). The problem of effect size heterogeneity 
in meta-analytic structural equation modeling.
<em>Journal of Applied Psychology</em>, <em>101</em>, 1457-1473.   
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+bootuniR1">bootuniR1</a></code>, <code><a href="#topic+bootuniR2">bootuniR2</a></code>, <code><a href="#topic+Nohe15">Nohe15</a></code>
</p>

<hr>
<h2 id='uniR1'>First Stage analysis of the univariate R (uniR) approach
</h2><span id='topic+uniR1'></span>

<h3>Description</h3>

<p>It conducts the first stage analysis of the uniR analysis
by pooling elements of the correlation coefficients individually. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniR1(Cor, n, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniR1_+3A_cor">Cor</code></td>
<td>
<p>A list of correlation matrices
</p>
</td></tr>
<tr><td><code id="uniR1_+3A_n">n</code></td>
<td>
<p>A vector of sample sizes
</p>
</td></tr>
<tr><td><code id="uniR1_+3A_...">...</code></td>
<td>
<p>Further arguments which are currently ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the univariate r approach proposed by Viswesvaran
and Ones (1995) to conduct meta-analytic structural equation modeling
(MASEM). It uses Schmidt and Hunter's approach to combine correlation
coefficients. It is included in this package for research interests. The two-stage
structural equation modeling (TSSEM) approach is preferred (e.g.,
Cheung, 2015; Cheung &amp; Chan, 2005).
</p>


<h3>Value</h3>

<p>An object of class <code>uniR1</code> of the original data, the sample
sizes, the harmonic mean of sample sizes, the average correlation
matrix, the standard errors of the correlation matrix, and the
standard deviations (heterogeneity) of the correlation matrix. 
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation
modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation
modeling: A two-stage approach. <em>Psychological Methods</em>,
<b>10</b>, 40-64.
</p>
<p>Schmidt, F. L., &amp; Hunter, J. E. (2015). <em>Methods of
meta-analysis: Correcting error and bias in research findings (3rd
ed.)</em>. Thousand Oaks, CA: Sage.
</p>
<p>Viswesvaran, C., &amp; Ones, D. S. (1995). Theory testing: Combining
psychometric meta-analysis and structural equations modeling.
<em>Personnel Psychology</em>, <b>48</b>, 865-885. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+uniR2">uniR2</a></code>, <code><a href="#topic+Becker09">Becker09</a></code>
</p>

<hr>
<h2 id='uniR2'>Second Stage analysis of the univariate R (uniR) approach
</h2><span id='topic+uniR2mx'></span><span id='topic+uniR2lavaan'></span>

<h3>Description</h3>

<p>It conducts the second stage analysis of the uniR analysis
by fitting structural equation models on the average correlation matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uniR2mx(x, RAM = NULL, Amatrix = NULL, Smatrix = NULL, Fmatrix = NULL,
        model.name=NULL, suppressWarnings=TRUE, silent=TRUE,
        run=TRUE, ...)
uniR2lavaan(x, model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uniR2_+3A_x">x</code></td>
<td>
<p>An object of class <code>uniR1</code> from
<code><a href="#topic+uniR1">uniR1</a></code>.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>.  
</p>
</td></tr> 
<tr><td><code id="uniR2_+3A_amatrix">Amatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Amatrix</code> is
required. An asymmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be
converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_smatrix">Smatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Smatrix</code> is
required. A symmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be
converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_fmatrix">Fmatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Fmatrix</code> is
required. A filter matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is <code>NULL</code> (the default), an
identity matrix with the same dimensions of <code>Cov</code> will be
created. If it is a matrix, it will be converted into
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function. It is not required when there is no latent variable.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in
<code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. If it is missing, the default is
&quot;UniR2&quot;.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. It is passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.
</p>
</td></tr>
<tr><td><code id="uniR2_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="uniR2_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr> 
<tr><td><code id="uniR2_+3A_model">model</code></td>
<td>
<p>A model specified using lavaan syntax see <code><a href="lavaan.html#topic+model.syntax">model.syntax</a></code></p>
</td></tr>  
<tr><td><code id="uniR2_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to either
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code> or <code><a href="lavaan.html#topic+sem">sem</a></code>. For
<code><a href="lavaan.html#topic+sem">sem</a></code>, <code>fixed.x=FALSE</code> is passed automatically.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the univariate r approach proposed by Viswesvaran
and Ones (1995) to conduct meta-analytic structural equation modeling
(MASEM). It treats the average correlation matrix as if it was a
covariance matrix in fitting structural equation models. The harmonic
mean of the sample sizes in combining correlation coefficients is used
as the sample size in fitting structural equation models. It is
included in this package for research interests. The two-stage structural equation
modeling (TSSEM) approach is preferred (e.g., Cheung, 2015; Cheung &amp; Chan, 2005).
</p>


<h3>Value</h3>

<p>A fitted object returned from <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code> or <code><a href="lavaan.html#topic+sem">sem</a></code>.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Cheung, M. W.-L. (2015). <em>Meta-analysis: A structural equation
modeling approach</em>. Chichester, West Sussex: John Wiley &amp; Sons, Inc.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation
modeling: A two-stage approach. <em>Psychological Methods</em>,
<b>10</b>, 40-64.
</p>
<p>Viswesvaran, C., &amp; Ones, D. S. (1995). Theory testing: Combining
psychometric meta-analysis and structural equations
modeling. <em>Personnel Psychology</em>, <b>48</b>, 865-885. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+uniR1">uniR1</a></code>, <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>,
<code><a href="#topic+Becker09">Becker09</a></code>
</p>

<hr>
<h2 id='vanderPol17'>Dataset on the effectiveness of multidimensional family therapy in treating
adolescents with multiple behavior problems
</h2><span id='topic+vanderPol17'></span>

<h3>Description</h3>

<p>This dataset includes 61 effect sizes from 19 manuscripts nested from
8 studies reported by van der Pol et al. (2017). It studies the
effectiveness of multidimensional family therapy in treating
adolescents with multiple behavior problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vanderPol17)</code></pre>


<h3>Details</h3>

<p>A list of data with the following structure:
</p>

<dl>
<dt>Number</dt><dd><p>Number of the effect size.</p>
</dd>
<dt>Study</dt><dd><p>Authors of the studies.</p>
</dd>
<dt>N</dt><dd><p>Total sample size.</p>
</dd>
<dt>N_target</dt><dd><p>Sample size in the target group.</p>
</dd>
<dt>N_control</dt><dd><p>Sample size in the control group.</p>
</dd>
<dt>Comparison_condition</dt><dd><p>Either cognitive behavioral therapy
(<code>CBT</code>), combined treatment (<code>CT</code>) or group therapy (<code>Group</code>).</p>
</dd>
<dt>Study_ID</dt><dd><p>Level-3 cluster.</p>
</dd>
<dt>Age_mean</dt><dd><p>Mean age of the participants.</p>
</dd>
<dt>Fllow_up</dt><dd><p>Follow-up duration (in months).</p>
</dd>
<dt>Per_Males</dt><dd><p>Percentage of males.</p>
</dd>
<dt>Per_Minorities</dt><dd><p>Percentage of minorities.</p>
</dd>
<dt>Per_Conduct_disorder</dt><dd><p>Percentage of participants with conduct disorder</p>
</dd>
<dt>Per_Severe_cannabis_users</dt><dd><p>Percentage of participants of
severe cannabis use.</p>
</dd>
<dt>Outcome_measure</dt><dd><p>Either substance abuse, delinquency, externalizing and internalizing psychopathology, and
family functioning</p>
</dd>
<dt>d</dt><dd><p>Effect size in Cohen's d.</p>
</dd>
<dt>v</dt><dd><p>Sampling variance of d</p>
</dd>
</dl>



<h3>Source</h3>

<p>van der Pol, T. M., Hoeve, M., Noom, M. J., Stams, G. J. J. M., Doreleijers, T. A. H., van Domburgh, L., &amp; Vermeiren, R. R. J. M. (2017). Research Review: The effectiveness of multidimensional family therapy in treating adolescents with multiple behavior problems - a meta-analysis. <em>Journal of Child Psychology and Psychiatry</em>, <b>58</b>(5), 532-545. https://doi.org/10.1111/jcpp.12685
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vanderPol17)
</code></pre>

<hr>
<h2 id='VarCorr'>Extract Variance-Covariance Matrix of the Random Effects
</h2><span id='topic+VarCorr'></span>

<h3>Description</h3>

<p>It extracts the variance-covariance matrix of the
random effects (variance component) from either the <code>meta</code> or
<code>osmasem</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarCorr(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarCorr_+3A_x">x</code></td>
<td>
<p>An object returned from either class
<code>meta</code> or <code>osmasem</code>
</p>
</td></tr>
<tr><td><code id="VarCorr_+3A_...">...</code></td>
<td>
<p>Further arguments; currently none is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix of the random effects.
</p>


<h3>Note</h3>

<p>It is similar to <code>coef(object, select="random")</code> in tssem. The main
difference is that <code>coef()</code> returns a vector while
<code>VarCorr()</code> returns its correspondent matrix.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+coef">coef</a></code>, <code><a href="#topic+vcov">vcov</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Multivariate meta-analysis on the log of the odds
## The conditional sampling covariance is 0
bcg &lt;- meta(y=cbind(ln_Odd_V, ln_Odd_NV), data=BCG,
            v=cbind(v_ln_Odd_V, cov_V_NV, v_ln_Odd_NV))
VarCorr(bcg)
</code></pre>

<hr>
<h2 id='vcov'>Extract Covariance Matrix Parameter Estimates from Objects of
Various Classes
</h2><span id='topic+vcov.tssem1FEM'></span><span id='topic+vcov.tssem1FEM.cluster'></span><span id='topic+vcov.tssem1REM'></span><span id='topic+vcov.wls'></span><span id='topic+vcov.wls.cluster'></span><span id='topic+vcov.meta'></span><span id='topic+vcov.meta3LFIML'></span><span id='topic+vcov.reml'></span><span id='topic+vcov.MxRAMModel'></span><span id='topic+vcov.osmasem'></span>

<h3>Description</h3>

<p>It extracts the variance-covariance matrix of the
parameter estimates from objects of various classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tssem1FEM'
vcov(object, ...)
## S3 method for class 'tssem1FEM.cluster'
vcov(object, ...)
## S3 method for class 'tssem1REM'
vcov(object, select = c("all", "fixed", "random"), robust=FALSE, ...)
## S3 method for class 'wls'
vcov(object, ...)
## S3 method for class 'wls.cluster'
vcov(object, ...)
## S3 method for class 'meta'
vcov(object, select = c("all", "fixed", "random"), robust=FALSE, ...)
## S3 method for class 'meta3LFIML'
vcov(object, select = c("all", "fixed", "random","allX"), robust=FALSE, ...)
## S3 method for class 'reml'
vcov(object, ...)
## S3 method for class 'MxRAMModel'
vcov(object, ...)
## S3 method for class 'osmasem'
vcov(object, select=c("fixed", "all", "random"), robust=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov_+3A_object">object</code></td>
<td>
<p>An object returned from objects of various classes
</p>
</td></tr>
<tr><td><code id="vcov_+3A_select">select</code></td>
<td>
<p>Select <code>all</code> for both fixed- and random-effects parameters, <code>fixed</code> for the
fixed-effects parameters or <code>random</code> for the random-effects
parameters. For <code>meta3LFIML</code> objects, <code>allX</code> is used to extract
all parameters including the predictors and auxiliary variables.  
</p>
</td></tr>
<tr><td><code id="vcov_+3A_robust">robust</code></td>
<td>
<p>Logicial. Whether to use robust standard error from <code><a href="OpenMx.html#topic+imxRobustSE">imxRobustSE</a></code>.
</p>
</td></tr>
<tr><td><code id="vcov_+3A_...">...</code></td>
<td>
<p>Further arguments; currently not in use except for
<code>tssemRobust1</code>, which to be passed to <code><a href="metafor.html#topic+robust">robust</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix of the parameter estimates.
</p>


<h3>Note</h3>

<p><code>vcov</code> returns <code>NA</code> when the <code>diag.constraints=TRUE</code>
argument is used in <code>wls</code> objects.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tssem1">tssem1</a></code>, <code><a href="#topic+wls">wls</a></code>,
<code><a href="#topic+meta">meta</a></code>, <code><a href="#topic+reml">reml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Random-effects meta-analysis
model1 &lt;- meta(y=yi, v=vi, data=Hox02)
vcov(model1)

## Fixed-effects only
vcov(model1, select="fixed")

## Random-effects only
vcov(model1, select="random")
</code></pre>

<hr>
<h2 id='vec2symMat'>Convert a Vector into a Symmetric Matrix
</h2><span id='topic+vec2symMat'></span>

<h3>Description</h3>

<p>It converts a vector into a symmetric matrix by filling up
the elements into the lower triangle of the matrix.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vec2symMat(x, diag = TRUE, byrow = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vec2symMat_+3A_x">x</code></td>
<td>
<p>A vector of numerics or characters
</p>
</td></tr>
<tr><td><code id="vec2symMat_+3A_diag">diag</code></td>
<td>
<p>Logical. If it is <code>TRUE</code> (the default), the diagonals
of the created matrix are replaced by elements of <code>x</code>;
otherwise, the diagonals of the created matrix are replaced by &quot;1&quot;.</p>
</td></tr>
<tr><td><code id="vec2symMat_+3A_byrow">byrow</code></td>
<td>
<p>Logical. If it is <code>FALSE</code> (the default), the created matrix is filled by columns; otherwise, the matrix is filled by rows.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric square matrix based on column major





</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+matrix2bdiag">matrix2bdiag</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>vec2symMat(1:6)
#      [,1] [,2] [,3]
# [1,]    1    2    3
# [2,]    2    4    5
# [3,]    3    5    6

vec2symMat(1:6, diag=FALSE)
#      [,1] [,2] [,3] [,4]
# [1,]    1    1    2    3
# [2,]    1    1    4    5
# [3,]    2    4    1    6
# [4,]    3    5    6    1

vec2symMat(letters[1:6])
#      [,1] [,2] [,3]
# [1,] "a"  "b"  "c" 
# [2,] "b"  "d"  "e" 
# [3,] "c"  "e"  "f" 
</code></pre>

<hr>
<h2 id='wls'>Conduct a Correlation/Covariance Structure Analysis with WLS
</h2><span id='topic+wls'></span><span id='topic+tssem2'></span>

<h3>Description</h3>

<p>It fits a correlation or covariance structure with
weighted least squares (WLS) estimation method where the inverse of the asymptotic covariance matrix is
used as the weight matrix. <code>tssem2</code> conducts the second stage
analysis of the two-stage structural equation modeling (TSSEM). <code>tssem2</code> is a wrapper of <code>wls</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wls(Cov, aCov, n, RAM=NULL, Amatrix=NULL, Smatrix=NULL, Fmatrix=NULL,
    diag.constraints=FALSE, cor.analysis=TRUE, intervals.type=c("z","LB"),
    mx.algebras=NULL, mxModel.Args=NULL, subset.variables=NULL, model.name=NULL,
    suppressWarnings=TRUE, silent=TRUE, run=TRUE, ...)
tssem2(tssem1.obj, RAM=NULL, Amatrix=NULL, Smatrix=NULL, Fmatrix=NULL,
       diag.constraints=FALSE, intervals.type=c("z", "LB"), mx.algebras=NULL,
       mxModel.Args=NULL, subset.variables=NULL, model.name=NULL, suppressWarnings=TRUE,
       silent=TRUE, run=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wls_+3A_tssem1.obj">tssem1.obj</code></td>
<td>
<p>An object of either class
<code>tssem1FEM</code>, class <code>tssem1FEM.cluster</code> or class
<code>tssem1REM</code> returned from <code>tssem1()</code></p>
</td></tr>
<tr><td><code id="wls_+3A_cov">Cov</code></td>
<td>
<p>A <code class="reqn">p</code> x <code class="reqn">p</code> sample correlation/covariance matrix
where <code class="reqn">p</code> is the number of variables.
</p>
</td></tr>
<tr><td><code id="wls_+3A_acov">aCov</code></td>
<td>
<p>A <code class="reqn">p*</code> x <code class="reqn">p*</code> asymptotic sampling covariance
matrix of either <code><a href="OpenMx.html#topic+vechs">vechs</a></code> <code>(Cov)</code> or
<code><a href="OpenMx.html#topic+vech">vech</a></code> <code>(Cov)</code> where <code class="reqn">p* = p(p-1)/2 </code> for correlation matrix and <code class="reqn">p* = p(p+1)/2 </code> for covariance matrix.
</p>
</td></tr>
<tr><td><code id="wls_+3A_n">n</code></td>
<td>
<p>Sample size.
</p>
</td></tr>
<tr><td><code id="wls_+3A_ram">RAM</code></td>
<td>
<p>A RAM object including a list of matrices of the model
returned from <code><a href="#topic+lavaan2RAM">lavaan2RAM</a></code>.  
</p>
</td></tr>  
<tr><td><code id="wls_+3A_amatrix">Amatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Amatrix</code> is
required. An asymmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is <code>NULL</code>, a matrix
of zero will be created. If it is a matrix, it will be converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="wls_+3A_smatrix">Smatrix</code></td>
<td>
<p>If <code>RAM</code> is not specified, an <code>Smatrix</code> is
required. A symmetric matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is a matrix, it will be converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function.
</p>
</td></tr>
<tr><td><code id="wls_+3A_fmatrix">Fmatrix</code></td>
<td>
<p>A filter matrix in the RAM specification with
<code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code>. If it is <code>NULL</code> (the default), an
identity matrix with the same dimensions of <code>Cov</code> will be
created. If it is a matrix, it will be converted into <code><a href="OpenMx.html#topic+MxMatrix-class">MxMatrix-class</a></code> by the <code>as.mxMatrix</code> function. It is not required when there is no latent variable.
</p>
</td></tr>
<tr><td><code id="wls_+3A_diag.constraints">diag.constraints</code></td>
<td>
<p>Logical. This argument is ignored when
<code>cor.analysis=FALSE</code>. If
<code>diag.constraints=TRUE</code>, the diagonals of the model implied matrix would be constrained at 1 by nonlinear constraints. The drawback is that standard
error will not be generated. Parametric bootstrap is used to
estimate the standard error by drawing samples from <code class="reqn">\mathcal{N}(vech(Cov), asyCov)</code> for covariance analysis and <code class="reqn">\mathcal{N}(vechs(Cov), asyCov)</code> for
correlation analysis while asyCov is treated as fixed. This process
is computationally intensive. A better approach is to request likelihood-based
confidence intervals (CIs) by specifying <code>intervals.type="LB"</code>. 
If <code>diag.constraints=FALSE</code> and <code>cor.analysis=TRUE</code>, the diagonals are automatically constrained as ones by
treating the error variances as computed values rather than as
parameters. Since the error variances are not parameters, they are not reported. 
</p>
</td></tr>  
<tr><td><code id="wls_+3A_cor.analysis">cor.analysis</code></td>
<td>
<p>Logical. Analysis of correlation or covariance structure. If <code>cor.analysis=TRUE</code>, <code><a href="OpenMx.html#topic+vechs">vechs</a></code> is used to vectorize <code>S</code>; otherwise, <code><a href="OpenMx.html#topic+vech">vech</a></code> is used to vectorize <code>S</code>.
</p>
</td></tr>
<tr><td><code id="wls_+3A_intervals.type">intervals.type</code></td>
<td>
<p>Either <code>z</code> (default if missing) or
<code>LB</code>. If it is <code>z</code>, it calculates the 95% Wald CIs based on the z statistic. If it is <code>LB</code>, it
calculates the 95% likelihood-based CIs on the
parameter estimates. Please note that the z values and their
associated p values are based on the z statistic. They are not
related to the likelihood-based CIs.
</p>
</td></tr>
<tr><td><code id="wls_+3A_mx.algebras">mx.algebras</code></td>
<td>
<p>A list of <code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code> or  <code><a href="OpenMx.html#topic+mxAlgebra">mxAlgebra</a></code> objects on the <code>Amatrix</code>,
<code>Smatrix</code>, and <code>Fmatrx</code>. It can be used to define new functions
of parameters and their LBCIs. For example, if the regression
coefficients to calculate an indirect effect are stored in A[1,2] and
A[1,3], we may define
<code>list(ind=mxAlgebra(Amatrix[1,2]*Amatrix[1,3], name="ind"))</code>
See the examples in <code><a href="#topic+Becker92">Becker92</a></code> and
<code><a href="#topic+Hunter83">Hunter83</a></code>. It should be noted that Fmatrix,
Amatrix, Smatrix, Iden (a <code class="reqn">p</code> x <code class="reqn">p</code> identity matrix), sampleS (sample correlation
or covariance matrix), impliedS1, impliedS (model implied
correlation or covariance matrix), vecS, invAcov, obj, One, select
and constraint and Ematrix (computed error variances when
<code>diag.constraints=FALSE</code>) have been defined internally. You
should not create new matrices using these names.
</p>
</td></tr>
<tr><td><code id="wls_+3A_mxmodel.args">mxModel.Args</code></td>
<td>
<p>A list of arguments passed to
<code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. These include, for example, additional
<code><a href="OpenMx.html#topic+mxMatrix">mxMatrix</a></code> and <code><a href="OpenMx.html#topic+mxConstraint">mxConstraint</a></code>.</p>
</td></tr>  
<tr><td><code id="wls_+3A_model.name">model.name</code></td>
<td>
<p>A string for the model name in
<code><a href="OpenMx.html#topic+mxModel">mxModel</a></code>. If it is missing, the default is
&quot;TSSEM2 (or WLS) Analysis of Correlation Structure&quot; for <code>cor.analysis=TRUE</code> and
&quot;TSSEM2 (or WLS) Analysis of Covariance Structure&quot; for <code>cor.analysis=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="wls_+3A_subset.variables">subset.variables</code></td>
<td>
<p>An optional character vector of variable names to select variables in the analysis. For example, there are 10
variables in <code>Cov</code>, say, x1 to x10. We may use
<code>c("x1", "x2", "x3")</code> to select three variables in the analysis. Please note that this argument does not reorder the
data. That is, <code>c("x3", "x2", "x1")</code> is the same as
<code>c("x1", "x2", "x3")</code>.</p>
</td></tr>  
<tr><td><code id="wls_+3A_suppresswarnings">suppressWarnings</code></td>
<td>
<p>Logical. If <code>TRUE</code>, warnings are
suppressed. The argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.</p>
</td></tr>
<tr><td><code id="wls_+3A_silent">silent</code></td>
<td>
<p>Logical. An argument to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
<tr><td><code id="wls_+3A_run">run</code></td>
<td>
<p>Logical. If <code>FALSE</code>, only return the mx model without
running the analysis.</p>
</td></tr> 
<tr><td><code id="wls_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="OpenMx.html#topic+mxRun">mxRun</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>wls</code> with a list of
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The matched call</p>
</td></tr>
<tr><td><code>Cov</code></td>
<td>
<p>Input data of either a covariance or correlation matrix</p>
</td></tr>
<tr><td><code>asyCov</code></td>
<td>
<p>The asymptotic covariance matrix of the input data</p>
</td></tr>
<tr><td><code>noObservedStat</code></td>
<td>
<p>Number of observed statistics</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code>cor.analysis</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code>noConstraints</code></td>
<td>
<p>Number of constraints imposed on S</p>
</td></tr>
<tr><td><code>indepModelChisq</code></td>
<td>
<p>Chi-square statistic of the independent model
returned by <code>.indepwlsChisq</code> </p>
</td></tr>
<tr><td><code>indepModelDf</code></td>
<td>
<p>Degrees of freedom of the independent model returned
by <code>.indepwlsChisq</code></p>
</td></tr>
<tr><td><code>mx.fit</code></td>
<td>
<p>A fitted object returned from
<code><a href="OpenMx.html#topic+mxRun">mxRun</a></code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>If the input is a list of <code>tssem1.obj</code>, it returns a list of
results for each cluster.
</p>


<h3>Author(s)</h3>

<p>Mike W.-L. Cheung &lt;mikewlcheung@nus.edu.sg&gt;
</p>


<h3>References</h3>

<p>Bentler, P.M., &amp; Savalei, V. (2010). Analysis of correlation structures: current status and open problems. In Kolenikov, S., Thombs, L., &amp; Steinley, D. (Eds.). <em>Recent Methodological Developments in Social Science Statistics</em> (pp. 1-36). Hoboken, NJ: Wiley. 
</p>
<p>Cheung, M. W.-L. (2010). Fixed-effects meta-analyses as multiple-group structural equation models. <em>Structural Equation Modeling</em>, <b>17</b>, 481-509.
</p>
<p>Cheung, M. W.-L. (2014). Fixed- and random-effects meta-analytic structural equation modeling: Examples and analyses in R. <em>Behavior Research Methods</em>, <b>46</b>, 29-40.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2005). Meta-analytic structural equation modeling: A two-stage approach. <em>Psychological Methods</em>, <b>10</b>, 40-64.
</p>
<p>Cheung, M. W.-L., &amp; Chan, W. (2009). A two-stage approach to synthesizing covariance matrices in meta-analytic structural equation modeling. <em>Structural Equation Modeling</em>, <b>16</b>, 28-53.
</p>
<p>Joreskog, K. G., Sorbom, D., Du Toit, S., &amp; Du Toit,
M. (1999). <em>LISREL 8: New Statistical Features.</em> Chicago: Scientific Software International.
</p>
<p>McArdle, J. J., &amp; MacDonald, R. P. (1984). Some algebraic properties of the Reticular Action Model for moment structures. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>37</b>, 234-251. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+tssem1">tssem1</a></code>,
<code><a href="#topic+Becker92">Becker92</a></code>, <code><a href="#topic+Digman97">Digman97</a></code>,
<code><a href="#topic+Hunter83">Hunter83</a></code>, <code><a href="#topic+issp89">issp89</a></code>, <code><a href="#topic+issp05">issp05</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#### Analysis of correlation structure
R1.labels &lt;- c("a1", "a2", "a3", "a4")

R1 &lt;- matrix(c(1.00, 0.22, 0.24, 0.18,
               0.22, 1.00, 0.30, 0.22,
               0.24, 0.30, 1.00, 0.24,
               0.18, 0.22, 0.24, 1.00), ncol=4, nrow=4,
               dimnames=list(R1.labels, R1.labels))
n &lt;- 1000
acovR1 &lt;- asyCov(R1, n)

#### One-factor CFA model using lavaan specification
model1 &lt;- "f =~ a1 + a2 + a3 + a4"

RAM1 &lt;- lavaan2RAM(model1, obs.variables=R1.labels)

wls.fit1a &lt;- wls(Cov=R1, aCov=acovR1, n=n, RAM=RAM1,
                 cor.analysis=TRUE, intervals="LB")
summary(wls.fit1a)

## One-factor CFA model using RAM specification
(A1 &lt;- cbind(matrix(0, nrow=5, ncol=4),
             matrix(c("0.2*a1","0.2*a2","0.2*a3","0.2*a4",0),
             ncol=1)))

(S1 &lt;- Diag(c("0.2*e1","0.2*e2","0.2*e3","0.2*e4",1)))

## The first 4 variables are observed while the last one is latent.
(F1 &lt;- create.Fmatrix(c(1,1,1,1,0), name="F1"))

wls.fit1b &lt;- wls(Cov=R1, aCov=acovR1, n=n, Fmatrix=F1, Smatrix=S1, Amatrix=A1,
                 cor.analysis=TRUE, intervals="LB")
summary(wls.fit1b)

## Select 3 variables to analyze
model2 &lt;- "f =~ a1 + a2 + a3"

RAM2 &lt;- lavaan2RAM(model2, obs.variables=R1.labels[-4])

wls.fit1c &lt;- wls(Cov=R1, aCov=acovR1, n=n, RAM=RAM2,
                 cor.analysis=TRUE, subset.variables=c("a1", "a2", "a3"))
summary(wls.fit1c)

#### Multiple regression analysis using lavaan specification
R2.labels &lt;- c("y", "x1", "x2")

R2 &lt;- matrix(c(1.00, 0.22, 0.24, 
               0.22, 1.00, 0.30, 
               0.24, 0.30, 1.00), ncol=3, nrow=3,
               dimnames=list(R2.labels, R2.labels))
acovR2 &lt;- asyCov(R2, n)

model3 &lt;- "y ~ x1 + x2
           ## Variances of x1 and x2 are 1
           x1 ~~ 1*x1
           x2 ~~ 1*x2
           ## x1 and x2 are correlated
           x1 ~~ x2"

RAM3 &lt;- lavaan2RAM(model3, obs.variables=R2.labels)

wls.fit2a &lt;- wls(Cov=R2, aCov=acovR2, n=n, RAM=RAM3,
                 cor.analysis=TRUE, intervals="z")
summary(wls.fit2a)


#### Multiple regression analysis using RAM specification

## A2: Regression coefficents
#    y x1 x2
# y  F T  T 
# x1 F F  F 
# x2 F F  F 
(A2 &lt;- mxMatrix("Full", ncol=3, nrow=3, byrow=TRUE,
               free=c(FALSE, rep(TRUE, 2), rep(FALSE, 6)), name="A2"))

## S2: Covariance matrix of free parameters
#    y x1 x2
# y  T F  F 
# x1 F F  F 
# x2 F T  F
(S2 &lt;- mxMatrix("Symm", ncol=3, nrow=3, values=c(0.2,0,0,1,0.2,1),
                labels=c("Var_y", NA, NA, NA, "Cov_x1_x2", NA),
                free=c(TRUE,FALSE,FALSE,FALSE,TRUE,FALSE), name="S2"))

## F may be ignored as there is no latent variable.
wls.fit2b &lt;- wls(Cov=R2, aCov=acovR2, n=n, Amatrix=A2, Smatrix=S2,
                 cor.analysis=TRUE, intervals="LB")
summary(wls.fit2b)


#### Analysis of covariance structure using lavaan specification
R3.labels=c("a1", "a2", "a3", "a4")

R3 &lt;- matrix(c(1.50, 0.22, 0.24, 0.18,
               0.22, 1.60, 0.30, 0.22,
               0.24, 0.30, 1.80, 0.24,
               0.18, 0.22, 0.24, 1.30), ncol=4, nrow=4,
               dimnames=list(R3.labels, R3.labels))
n &lt;- 1000
acovS3 &lt;- asyCov(R3, n, cor.analysis=FALSE)

model3 &lt;- "f =~ a1 + a2 + a3 + a4"

RAM3 &lt;- lavaan2RAM(model3, obs.variables=R3.labels)

wls.fit3a &lt;- wls(Cov=R3, aCov=acovS3, n=n, RAM=RAM3,
                 cor.analysis=FALSE)
summary(wls.fit3a)

#### Analysis of covariance structure using RAM specification
(A3 &lt;- cbind(matrix(0, nrow=5, ncol=4),
             matrix(c("0.2*a1","0.2*a2","0.2*a3","0.2*a4",0),ncol=1)))

(S3 &lt;- Diag(c("0.2*e1","0.2*e2","0.2*e3","0.2*e4",1)))

F3 &lt;- c(TRUE,TRUE,TRUE,TRUE,FALSE)
(F3 &lt;- create.Fmatrix(F3, name="F3", as.mxMatrix=FALSE))

wls.fit3b &lt;- wls(Cov=R3, aCov=acovS3, n=n, Amatrix=A3, Smatrix=S3,
                Fmatrix=F3, cor.analysis=FALSE)
summary(wls.fit3b)

## End(Not run)
</code></pre>

<hr>
<h2 id='wvs94a'>Forty-four Studies from Cheung (2013)</h2><span id='topic+wvs94a'></span>

<h3>Description</h3>

<p>Between 1990 and 1993, 57,561 adults aged 18 and above from 42 nations
were interviewed by local academic institutes in Eastern European
nations and by professional survey organizations in other nations.
The standardized mean difference (SMD) between males and females on life
satisfaction and life control in each country were calculated as the effect sizes. Positive values indicate that males have higher scores than females do.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wvs94a)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>country</dt><dd><p>Country</p>
</dd>
<dt>lifesat</dt><dd><p>SMD on life satisfaction</p>
</dd>
<dt>lifecon</dt><dd><p>SMD on life control</p>
</dd>
<dt>lifesat_var</dt><dd><p>Sampling variance of lifesat</p>
</dd>
<dt>inter_cov</dt><dd><p>Sampling covariance between lifesat and lifecon</p>
</dd>
<dt>lifecon_var</dt><dd><p>Sampling variance of lifecon</p>
</dd>
<dt>gnp</dt><dd><p>Gross National Product</p>
</dd>
</dl>



<h3>Source</h3>

<p>World Values Study Group. (1994). World Values Survey, 1981-1984 and 1990-1993 [Computer file]. <em>Ann Arbor, MI: Inter-university Consortium for Political and Social Research.</em>
</p>


<h3>References</h3>

<p>Au, K., &amp; Cheung, M. W.-L. (2004). Intra-cultural variation and job autonomy in 42
countries. <em>Organization Studies</em>, <b>25</b>, 1339-1362.
</p>
<p>Cheung, M. W.-L. (2013). Multivariate meta-analysis as structural equation models. <em>Structural Equation Modeling</em>, <b>20</b>, 429-454. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(wvs94a)

## Random-effects model
random.ma1 &lt;- meta(y=cbind(lifesat, lifecon),
                   v=cbind(lifesat_var, inter_cov, lifecon_var), data=wvs94a,
                   model.name="Random effects model")
summary(random.ma1)

## Random-effects model with both population effect sizes fixed at 0
random.ma2 &lt;- meta(y=cbind(lifesat, lifecon),
                   v=cbind(lifesat_var, inter_cov, lifecon_var), data=wvs94a,
                   intercept.constraints=matrix(0, nrow=1, ncol=2),
                   model.name="Effect sizes are fixed at 0")
summary(random.ma2)

## Compare the nested models
anova(random.ma1, random.ma2)

## Fixed-effects model by fixing the variance component at 0 
fixed.ma &lt;- meta(y=cbind(lifesat, lifecon),
                 v=cbind(lifesat_var, inter_cov, lifecon_var), data=wvs94a,
                 RE.constraints=matrix(0, ncol=2, nrow=2),
                 model.name="Fixed effects model")
summary(fixed.ma)

## Mixed-effects model
## gnp is divided by 10000 and centered by using 
## scale(gnp/10000, scale=FALSE)
mixed.ma1 &lt;- meta(y=cbind(lifesat, lifecon),
                  v=cbind(lifesat_var, inter_cov, lifecon_var),
                  x=scale(gnp/10000, scale=FALSE), data=wvs94a,
                  model.name="GNP as a predictor")
summary(mixed.ma1)

## Mixed-effects model with equal regression coefficients
mixed.ma2 &lt;- meta(y=cbind(lifesat, lifecon),
                  v=cbind(lifesat_var, inter_cov, lifecon_var),
                  x=scale(gnp/10000, scale=FALSE), data=wvs94a,
                  coef.constraints=matrix(c("0.0*Eq_slope",
                                            "0.0*Eq_slope"), nrow=2),
                  model.name="GNP as a predictor with equal slope")
summary(mixed.ma2)

## Compare the nested models
anova(mixed.ma1, mixed.ma2)

## Plot the multivariate effect sizes
plot(random.ma1, main="Estimated effect sizes and their 95% confidence ellipses",
     axis.label=c("Gender difference on life satisfaction",
                  "Gender difference on life control"))

## End(Not run)
</code></pre>

<hr>
<h2 id='wvs94b'>Forty-four Covariance Matrices on Life Satisfaction, Job Satisfaction, and Job Autonomy</h2><span id='topic+wvs94b'></span>

<h3>Description</h3>

<p>Between 1990 and 1993, 57,561 adults aged 18 and above from 42 nations
were interviewed by local academic institutes in Eastern European
nations and by professional survey organizations in other nations. The
covariance matrices among Life Satisfaction, Job Satisfaction, and Job Autonomy were calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wvs94b)</code></pre>


<h3>Details</h3>

<p>The variables are:
</p>

<dl>
<dt>data</dt><dd><p>Covariance matrix among Life Satisfaction (LS), Job
Satisfaction (JS), and Job Autonomy (JA)</p>
</dd>
<dt>n</dt><dd><p>Sample size in the country</p>
</dd>
</dl>



<h3>Source</h3>

<p>World Values Study Group. (1994). World Values Survey, 1981-1984 and 1990-1993 [Computer file]. <em>Ann Arbor, MI: Inter-university Consortium for Political and Social Research.</em>
</p>


<h3>References</h3>

<p>Au, K., &amp; Cheung, M. W.-L. (2004). Intra-cultural variation and job autonomy in 42
countries. <em>Organization Studies</em>, <b>25</b>, 1339-1362.
</p>
<p>Cheung, M.W.-L., &amp; Cheung, S.-F. (2016). Random-effects models for
meta-analytic structural equation modeling: Review, issues, and
illustrations. <em>Research Synthesis Methods</em>, <b>7</b>, 140-155.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(wvs94b)

## Get the indirect and the direct effects and
## their sampling covariance matrices for each study
indirect1 &lt;- indirectEffect(wvs94b$data, wvs94b$n)
indirect1

## Multivariate meta-analysis on the indirect and direct effects
indirect2 &lt;- meta(indirect1[, c("ind_eff", "dir_eff")],
                  indirect1[, c("ind_var", "ind_dir_cov", "dir_var")])

summary(indirect2)  

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
