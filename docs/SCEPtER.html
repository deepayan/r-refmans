<!DOCTYPE html><html><head><title>Help for package SCEPtER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SCEPtER}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#errorObs'><p>Perturbe a set of observational data</p></a></li>
<li><a href='#estimate'><p>Mass, radius, and age estimates for the supplied objects</p></a></li>
<li><a href='#sampleStar'><p>Sample a set of objects out of a grid</p></a></li>
<li><a href='#SCEPtER-package'><p>A grid-based estimation tool for stellar ages, masses, and radii</p></a></li>
<li><a href='#stdGrid'><p>Standard grid for mass and radius estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Stellar CharactEristics Pisa Estimation gRid</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-25</td>
</tr>
<tr>
<td>Description:</td>
<td>A pipeline for estimating the stellar
        age, mass, and radius given observational 
        effective temperature, [Fe/H], and astroseismic
	parameters. The results are obtained adopting a maximum likelihood
	technique over a grid of pre-computed stellar models, as
	described in Valle et al. (2014) &lt;<a href="https://doi.org/10.1051%2F0004-6361%2F201322210">doi:10.1051/0004-6361/201322210</a>&gt;.</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), MASS, parallel</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matteo Dell'Omodarme &lt;mattdell@fastmail.fm&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-29 06:17:14 UTC; matt</td>
</tr>
<tr>
<td>Author:</td>
<td>Matteo Dell'Omodarme [aut, cre],
  Giada Valle [aut]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-29 09:22:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='errorObs'>Perturbe a set of observational data</h2><span id='topic+errorObs'></span>

<h3>Description</h3>

<p>The function returns a perturbed object, starting from observational data
and a vector of uncertainties. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    errorObs(sigma, STAR, parallel=FALSE, corr=0)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errorObs_+3A_sigma">sigma</code></td>
<td>
<p>a vector of 7 elements containing the uncertainties on
observational data. The error on 
seismic parameters must be expressed as percentage.</p>
</td></tr> 
<tr><td><code id="errorObs_+3A_star">STAR</code></td>
<td>
<p>a vector of 7 elements containing  the observational data.</p>
</td></tr>
<tr><td><code id="errorObs_+3A_parallel">parallel</code></td>
<td>
<p>logical flag specifying if the computation should be
performed in parallel on a multi-core architecture.</p>
</td></tr>
<tr><td><code id="errorObs_+3A_corr">corr</code></td>
<td>
<p>the value of assumed the correlation between asteroseismic
parameters. Default to zero (no correlation).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector of observations <code>STAR</code> must contain, in the order:
</p>

<ol>
<li><p>The effective temperature (in K) of the star.
</p>
</li>
<li><p>The logarithm of the surface gravity of the star (in cm s^-2).
</p>
</li>
<li><p>The metallicity [Fe/H] of the star.
</p>
</li>
<li><p>The value of large frequency separation of the star, divided by
the solar value of this quantity. 
</p>
</li>
<li><p>The value of the frequency of maximum oscillation power of the
star, divided by 
the solar value of this quantity. 
</p>
</li>
<li><p>The mass (in solar units) of the star (if known). 
</p>
</li>
<li><p>The radius (in solar unit) of the star (if known). 
</p>
</li></ol>

<p>The vector of the uncertainties on the observation <code>sigma</code> must
contain the uncertainty on the above quantity. The
uncertainty on the last 
two values must be expressed as relative error.
</p>


<h3>Value</h3>

<p><code>errorObs</code> returns an object obtained sampling from a
multivariate normal distribution with vector of mean <code>star</code> and
covariance matrix <code>diag(sigma^2)</code>, with elements (4,5) and (5,4)
modified according to the value of <code>corr</code>. 
</p>

<hr>
<h2 id='estimate'>Mass, radius, and age estimates for the supplied objects</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p>The function computes the grid-based estimates of the mass, radius, and age for
the supplied objects. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    estimate(data, STAR, sigma, thr, sel, parallel=FALSE)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_+3A_data">data</code></td>
<td>
<p>the matrix estimation grid. The matrix should be sorted according to
the values in the first column (the stellar effective
temperature). </p>
</td></tr>
<tr><td><code id="estimate_+3A_star">STAR</code></td>
<td>
<p>a matrix of 7 columns, containing in each row the
observational data of the stellar objects.</p>
</td></tr> 
<tr><td><code id="estimate_+3A_sigma">sigma</code></td>
<td>
<p>a vector of 7 elements, containing the error on observational
data. The error on 
seismic parameters are expressed as relative error.</p>
</td></tr>
<tr><td><code id="estimate_+3A_thr">thr</code></td>
<td>
<p>the threshold for the selection of cases over which the
computation of likelihood is performed.</p>
</td></tr>
<tr><td><code id="estimate_+3A_sel">sel</code></td>
<td>
<p>a vector of 7 elements, containing 1 or 0 for inclusion or
exclusion of a observational data from the likelihood computation.</p>
</td></tr>
<tr><td><code id="estimate_+3A_parallel">parallel</code></td>
<td>
<p>logical flag indicating if the estimations should be
performed in parallel on a multi-core architecture.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>STAR</code> should contains in order: the stellar effective temperature,
the logarithm of the surface gravity, the metallicity [Fe/H], the
average large frequency separation (in micro Hz), the maximum
oscillation power (in micro Hz), the mass (in solar units), the radius
(in solar units). <code>sigma</code> should contain, in the same order, the
uncertainties on the observational quantities.  
</p>
<p><code>estimate</code> returns a data frame obtained with the
estimates
of stellar parameters for each row of the input matrix <code>STAR</code>.
In the columns of the data frame there are: the identifier <code>id</code>
of the row of the input matrix adopted for the estimate; the mass
estimate <code>M</code> (in solar units); the radius estimate <code>R</code> (in
solar units); the age estimate <code>age</code> (in Gyr).
</p>
<p>Mass, radius, and age estimates are obtained by a maximum likelihood
technique widely adopted in literature. Details on the technique can
be found in the references reported below.
</p>


<h3>References</h3>

<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in grid-based estimates of stellar mass and
radius. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, 561, A125.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in asteroseismic grid-based estimates of stellar ages. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, accepted.
</p>
<p>S. Basu, G.A. Verner, W.J. Chaplin, and Y. Elsworth (2012). <em>Effect
of Uncertainties in Stellar Model Parameters on Estimated Masses and
Radii of Single Stars</em>.  The
Astrophysical Journal, 746, 76.
</p>
<p>N. Gai, S. Basu, W.J. Chaplin, and Y. Elsworth (2011). <em>An In-depth
Study of Grid-based Asteroseismic Analysis</em>.  The
Astrophysical Journal, 730, 63.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Solar seismic data from  Thiery et al. (2000) 
Dnisun &lt;- 134.8
nimaxsun &lt;- 3034

# Observational data for alpha Cent B from:
# Kjeldsen et al. (2005), Porto de Mello et al. (2008)
# Observed mass and radius: 0.935 +- 0.006, 0.863 +- 0.005
# from Miglio &amp; Montalban (2005) 
acenB &lt;- c(5316, 0, 0.25, 161.5/Dnisun, 4100/nimaxsun, 0.935, 0.863)
sigmaCen &lt;- c(30, 0, 0.04, 0.01, 0.05, 0.006/0.935, 0.005/0.863)

# Load the standard estimation grid
data(stdGrid)

# order standard grid by effective temperature (required by estimate)
ii &lt;- do.call(order, as.data.frame(stdGrid[,1]))
oGrid &lt;- stdGrid[ii, ]

# For accurate estimates adopt at least NUM=10000
NUM &lt;- 200
# obtain NUM copies of the object and add Gaussian perturbations
star &lt;- matrix(acenB, byrow=TRUE, nrow=NUM, ncol=7)
starp &lt;- errorObs(sigmaCen, star)

# select the observational constraints
# using Teff, [Fe/H], Delta nu, nu_max 
vsel &lt;- c(1,0,1,1,1,0,0)

# call the estimation routines
res &lt;- estimate(oGrid, starp, sigmaCen, 3, vsel)

quantile(res$M, c(0.16, 0.5, 0.84))
quantile(res$R, c(0.16, 0.5, 0.84))

</code></pre>

<hr>
<h2 id='sampleStar'>Sample a set of objects out of a grid</h2><span id='topic+sampleStar'></span>

<h3>Description</h3>

<p>The function extracts, without replacement, a sample of objects out of a grid.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    sampleStar(n, grid, restrict=TRUE)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleStar_+3A_n">n</code></td>
<td>
<p>the number of objects to be sampled.</p>
</td></tr>
<tr><td><code id="sampleStar_+3A_grid">grid</code></td>
<td>
<p>the grid from which the objects are sampled.</p>
</td></tr>
<tr><td><code id="sampleStar_+3A_restrict">restrict</code></td>
<td>
<p>logical flag indicating if only models younger than 14 Gyr
should be considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>sampleStar</code> returns a matrix of <code>n</code> rows, sampled without
replacement from <code>grid</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stdGrid)
STARS &lt;- sampleStar(10, stdGrid)
</code></pre>

<hr>
<h2 id='SCEPtER-package'>A grid-based estimation tool for stellar ages, masses, and radii</h2><span id='topic+SCEPtER-package'></span>

<h3>Description</h3>

<p>The package estimates stellar mass, radius, and age given
observational 
data of effective temperature, [Fe/H], and astroseismic parameters.
The results are obtained adopting a maximum likelihood
technique on a grid of computed stellar models.
</p>


<h3>References</h3>

<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in grid-based estimates of stellar mass and
radius. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, 561, A125.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in asteroseismic grid-based estimates of stellar ages. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, accepted.
</p>

<hr>
<h2 id='stdGrid'>Standard grid for mass and radius estimation</h2><span id='topic+stdGrid'></span>

<h3>Description</h3>

<p>The standard grid for mass and radius determination through a maximum likelihood
technique. The grid is computed assuming the solar scaled mixing-length
value.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdGrid
</code></pre>


<h3>Format</h3>

<p>A data frames containing 9 variables:
</p>

<dl>
<dt>Teff</dt><dd><p>The effective temperature of the star (in K).</p>
</dd>
<dt>logg</dt><dd><p>The logarithm of the surface gravity of the star (in cm s^-2).</p>
</dd>
<dt>FeH</dt><dd><p>The metallicity [Fe/H] of the star.</p>
</dd>
<dt>Dni</dt><dd><p>The large frequency separation for the star (in unit of solar
large frequency separation).</p>
</dd>
<dt>nimax</dt><dd><p>The frequency of maximum oscillation power for the star
(in unit of solar frequency of maximum oscillation power).</p>
</dd>
<dt>M</dt><dd><p>The mass of the star (in unit of solar mass).</p>
</dd>
<dt>R</dt><dd><p>The radius of the star (in unit of solar radius)</p>
</dd>
<dt>logAge</dt><dd><p>The logarithm of the age of the star (in yr).</p>
</dd>
<dt>pcAge</dt><dd><p>The ratio between the age of the star and the time needed for
central hydrogen depletion for that star. </p>
</dd>
</dl>



<h3>Source</h3>

<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in grid-based estimates of stellar mass and
radius. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, 561, A125.
</p>
<p>G. Valle, M. Dell'Omodarme, P.G. Prada Moroni, and S. Degl'Innocenti
(2014). <em>Uncertainties in asteroseismic grid-based estimates of stellar ages. SCEPtER: Stellar CharactEristics Pisa
Estimation gRid</em>. A&amp;A, accepted.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
