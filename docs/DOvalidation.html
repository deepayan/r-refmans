<!DOCTYPE html><html><head><title>Help for package DOvalidation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DOvalidation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#b.BO'>
<p>Best One-Sided Cross-Validation for Local Linear Hazards</p></a></li>
<li><a href='#b.BO.MBC'>
<p>Best One-Sided Cross-Validation for Multiplicative Bias Corrected Hazard Estimators</p></a></li>
<li><a href='#b.CV'>
<p>Least Squares Cross-Validation for Local Linear Hazards</p></a></li>
<li><a href='#b.CV.MBC'>
<p>Least Squares Cross-Validation for Multiplicative Bias Corrected Hazard Estimators</p></a></li>
<li><a href='#b.OSCV'>
<p>DO-Validation for Local Linear Hazards</p></a></li>
<li><a href='#b.OSCV.MBC'>
<p>DO-Validation for Multiplicative Bias Corrected Hazard Estimators</p></a></li>
<li><a href='#discretise.data'><p>Aggregate data in the form of occurrences and exposures</p></a></li>
<li><a href='#DK'>
<p>Denmark Female Mortality Data</p></a></li>
<li><a href='#DOvalidation-package'>
<p>Kernel Hazard Estimation with Best One-Sided and Double One-Sided Cross-Validation</p></a></li>
<li><a href='#hazard.LL'>
<p>Local Linear Hazard Estimator (Natural Weighting)</p></a></li>
<li><a href='#hazard.LL.RH'><p>Local Linear Hazard Estimator (Ramlau-Hansen Weighting)</p></a></li>
<li><a href='#hazard.MBC'>
<p>Multiplicative Bias Corrected Hazard Estimator</p></a></li>
<li><a href='#Iceland'><p>Iceland Female Mortality Data</p></a></li>
<li><a href='#K.epa'>
<p>Epanechnikov Kernel</p></a></li>
<li><a href='#K.sextic'><p>Sextic Kernel</p></a></li>
<li><a href='#UK'>
<p>UK Female Mortality Data</p></a></li>
<li><a href='#US'>
<p>US Female Mortality Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Kernel Hazard Estimation with Best One-Sided and Double
One-Sided Cross-Validation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-20</td>
</tr>
<tr>
<td>Author:</td>
<td>M.L. Gamiz, E. Mammen, M.D. Martinez-Miranda and J.P. Nielsen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maria Dolores Martinez-Miranda &lt;mmiranda@ugr.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Local linear hazard estimator and its multiplicatively bias correction, including three bandwidth selection methods: best one-sided cross-validation, double one-sided cross-validation, and standard cross-validation.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-20 09:54:09 UTC; Usuario</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-20 10:37:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='b.BO'>
Best One-Sided Cross-Validation for Local Linear Hazards</h2><span id='topic+b.BO'></span>

<h3>Description</h3>

<p>Bandwidth selection for local linear hazard estimation using best one-sided cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.BO(grid.b, nb , K = "sextic", type.bo = "Oi", xi, Oi, Ei, wei = "same")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.BO_+3A_grid.b">grid.b</code></td>
<td>
<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.BO_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If <code>grid.b</code> is provided then the argument <code>nb</code> will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.BO_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the local linear hazard estimator. Choose between values <code>"epa"</code> (for the epanechnikov kernel) or <code>"sextic"</code> (see details in<code><a href="#topic+hazard.LL">hazard.LL</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.BO_+3A_type.bo">type.bo</code></td>
<td>
<p>Choose between <code>"Oi"</code> or <code>"Ei"</code> to find the best side using the occurrences or the exposures, respectively.
</p>
</td></tr>
<tr><td><code id="b.BO_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.BO_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="b.BO_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="b.BO_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value <code>"exposure"</code> or <code>"same"</code>. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the data are given as count data i.e. number of occurrences and exposures.
</p>
<p>The BO-validated bandwidth is calculated as the minimizer of a cross-validation score with a indirect kernel. If the score is strictly increasing or decreasing then a warning will be shown together with the selected bandwidth (in this case one of the extremes in <code>grid.b</code>, adjusted by the rescaling constant, which is 0.5371  for the Epanechnikov kernel, and 0.5874 for the sextic kernel).
</p>
<p>The score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>


<table>
<tr><td><code>bbo</code></td>
<td>
<p>The onesided cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.bo</code></td>
<td>
<p>The position of the best one-sided cross-validated bandwidth into &quot;grid.b&quot;.</p>
</td></tr>
<tr><td><code>cvbo.values</code></td>
<td>
<p>The values of the cross-validation score for each bandwidth in <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>,<code><a href="#topic+b.OSCV">b.OSCV</a></code>,<code><a href="#topic+b.CV">b.CV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
my.bs&lt;-seq(20,40,length.out=30)
res.bo&lt;-b.BO(grid.b=my.bs,K="sextic",type.bo="Oi",xi=ti,Oi=Oi,Ei=Ei,wei="same")
bbo&lt;-res.bo$bbo
cvs&lt;-res.bo$cvbo.values
plot(my.bs,cvs,main="BO-validation score",xlab="Bandwidth")
print(paste("The best one-sided cross-validated bandwidth is:", bbo,sep=" "))
</code></pre>

<hr>
<h2 id='b.BO.MBC'>
Best One-Sided Cross-Validation for Multiplicative Bias Corrected Hazard Estimators</h2><span id='topic+b.BO.MBC'></span>

<h3>Description</h3>

<p>Bandwidth selection for multiplicatively biased corrected local linear hazard estimation using best one-sided cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.BO.MBC(grid.b, nb , K = "sextic", type.bo = "Oi", xi, Oi, Ei, wei = "same")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.BO.MBC_+3A_grid.b">grid.b</code></td>
<td>
<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If <code>grid.b</code> is provided then the argument <code>nb</code> will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the hazard. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details of <code><a href="#topic+hazard.MBC">hazard.MBC</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_type.bo">type.bo</code></td>
<td>
<p>Choose between <code>"Oi"</code> or <code>"Ei"</code> to find the best side using the occurrences or the exposures, respectively.
</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="b.BO.MBC_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value <code>"exposure"</code> or <code>"same"</code>. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BO-validated bandwidth is calculated as the minimizer of a cross-validation score with a indirect kernel. If the score is strictly increasing or decreasing then a warning will be shown together with the selected bandwidth (in this case one of the extremes in <code>grid.b</code>, adjusted by the rescaling constant, which is 0.5948 for the Epanechnikov kernel, and 0.6501 for the sextic kernel).
</p>
<p>The score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>


<table>
<tr><td><code>bbo</code></td>
<td>
<p>The onesided cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.bo</code></td>
<td>
<p>The position of the best one-sided cross-validated bandwidth into &quot;grid.b&quot;.</p>
</td></tr>
<tr><td><code>cvbo.values</code></td>
<td>
<p>The values of the cross-validation score for each bandwidth in <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.MBC">hazard.MBC</a></code>,<code><a href="#topic+b.OSCV.MBC">b.OSCV.MBC</a></code>,<code><a href="#topic+b.CV.MBC">b.CV.MBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
my.bs&lt;-seq(50,80,length.out=30)
res.bo&lt;-b.BO.MBC(grid.b=my.bs,K="sextic",type.bo = "Oi",xi=ti,Oi=Oi,Ei=Ei,wei="same")
bbo&lt;-res.bo$bbo
cvs&lt;-res.bo$cvbo.values
plot(my.bs,cvs,main="BO-validation score",xlab="Bandwidth")
print(paste("The best one-sided cross-validated bandwidth is:", bbo,sep=" "))
</code></pre>

<hr>
<h2 id='b.CV'>
Least Squares Cross-Validation for Local Linear Hazards</h2><span id='topic+b.CV'></span>

<h3>Description</h3>

<p>Bandwidth selection for local linear hazard estimation using least squares cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.CV(grid.b, nb , K = "epa", xi, Oi, Ei, wei = "exposure")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.CV_+3A_grid.b">grid.b</code></td>
<td>

<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.CV_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If <code>grid.b</code> is provided then the argument <code>nb</code> will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.CV_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the local linear hazard estimator. Choose between values <code>"epa"</code> (for the epanechnikov kernel) or <code>"sextic"</code>  (see details of <code><a href="#topic+hazard.LL">hazard.LL</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.CV_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.CV_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="b.CV_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="b.CV_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value <code>"exposure"</code> or <code>"same"</code>. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the data are given as count data i.e. number of occurrences and exposures.
</p>
<p>If the cross-validation score is strictly increasing or decreasing then a warning will be shown together with the cross-validated bandwidth (in this case one of the extremes in <code>grid.b</code>).
</p>
<p>The cross-validation score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>


<table>
<tr><td><code>bcv</code></td>
<td>
<p>The cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.cv</code></td>
<td>
<p>The position of the cross-validated bandwidth into <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>cv.values</code></td>
<td>
<p>The values of the cross-validation score for each bandwidth in <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the cross-validation score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575 
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics, 28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>,<code><a href="#topic+b.OSCV">b.OSCV</a></code>,<code><a href="#topic+b.BO">b.BO</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UK)
Oi&lt;-UK$D
Ei&lt;-UK$E 
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
M&lt;-length(ti)
my.bs&lt;-seq(1,5,length=50)
res.cv&lt;-b.CV(grid.b=my.bs,K="sextic",xi=ti,Oi=Oi,Ei=Ei)
bcv&lt;-res.cv$bcv
cv.values&lt;-res.cv$cv.values
plot(my.bs,cv.values,main="Cross-validation score",xlab="Bandwidth")
print(paste("The cross-validated bandwidth is:", bcv,sep=" "))
</code></pre>

<hr>
<h2 id='b.CV.MBC'>
Least Squares Cross-Validation for Multiplicative Bias Corrected Hazard Estimators</h2><span id='topic+b.CV.MBC'></span>

<h3>Description</h3>

<p>Bandwidth selection for multiplicatively bias corrected local linear hazard estimation using least squares cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.CV.MBC(grid.b, nb , K = "sextic", xi, Oi, Ei, wei = "same")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.CV.MBC_+3A_grid.b">grid.b</code></td>
<td>

<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If &quot;grid.b&quot; is provided then the argument &quot;nb&quot; will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the local linear hazard estimator. Choose between values &quot;epa&quot; (for the epanechnikov kernel) or &quot;sextic&quot; (see details of <code><a href="#topic+hazard.MBC">hazard.MBC</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (xi). 
</p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (xi).  
</p>
</td></tr>
<tr><td><code id="b.CV.MBC_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value &quot;exposure&quot; or &quot;same&quot;. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the data are given as count data i.e. number of occurrences and exposures.
</p>
<p>If the cross-validation score is strictly increasing or decreasing then a warning will be shown together with the cross-validated bandwidth (in this case one of the extremes in &quot;grid.b&quot;).
</p>
<p>The cross-validation score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>


<table>
<tr><td><code>bcv</code></td>
<td>
<p>The cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.cv</code></td>
<td>
<p>The position of the cross-validated bandwidth into &quot;grid.b&quot;.</p>
</td></tr>
<tr><td><code>cv.values</code></td>
<td>
<p>The values of the cross-validation score for each bandwidth in &quot;grid.b&quot;.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the cross-validation score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics, 28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.MBC">hazard.MBC</a></code>,<code><a href="#topic+b.BO.MBC">b.BO.MBC</a></code>,<code><a href="#topic+b.CV">b.CV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
my.bs&lt;-seq(50,80,length.out=30)
res.cv&lt;-b.CV.MBC(grid.b=my.bs,K="sextic",xi=ti,Oi=Oi,Ei=Ei,wei="same")
bcv&lt;-res.cv$bcv
cv.values&lt;-res.cv$cv.values
plot(my.bs,cv.values,main="Cross-validation score",xlab="Bandwidth")
print(paste("The cross-validated bandwidth is:", bcv,sep=" "))


</code></pre>

<hr>
<h2 id='b.OSCV'>
DO-Validation for Local Linear Hazards</h2><span id='topic+b.OSCV'></span>

<h3>Description</h3>

<p>Bandwidth selection for local linear hazard estimation using DO-validation and one-sided (left or right) cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.OSCV(grid.b, nb , K = "epa", Ktype = "left", xi, Oi, Ei, wei = "exposure")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.OSCV_+3A_grid.b">grid.b</code></td>
<td>
<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If <code>grid.b</code> is provided then the argument <code>nb</code> will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the local linear hazard estimator. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details of <code><a href="#topic+hazard.LL">hazard.LL</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_ktype">Ktype</code></td>
<td>
<p>Choose between <code>"left"</code> or <code>"right"</code> for left- or right- sided cross-validation respectively.
</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="b.OSCV_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value <code>"exposure"</code> or <code>"same"</code>. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the data are given as count data i.e. number of occurrences and exposures.
</p>
<p>The DO-validated bandwidth is calculated as the average of left- and right- sided cross-validation (see example below). 
</p>
<p>If the one-sided cross-validation score is strictly increasing or decreasing then a warning will be shown together with the onesided cross-validated bandwidth (in this case one of the extremes in <code>grid.b</code>, adjusted by the rescaling constant, which is 0.5371 for the Epanechnikov kernel, and 0.5874 for the sextic kernel).
</p>
<p>The score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>


<table>
<tr><td><code>boscv</code></td>
<td>
<p>The onesided cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.oscv</code></td>
<td>
<p>The position of the one-sided cross-validated bandwidth into <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>oscv.values</code></td>
<td>
<p>The values of the one-sided cross-validation score for each bandwidth in <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the one-sided cross-validation score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>,<code><a href="#topic+b.BO">b.BO</a></code>,<code><a href="#topic+b.CV">b.CV</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UK)
Oi&lt;-UK$D
Ei&lt;-UK$E 
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
M&lt;-length(ti)
my.bs&lt;-seq(3,10,length=50)
## The left one-sided cross-validated bandwidth
res.left&lt;-b.OSCV(grid.b=my.bs,K="sextic",Ktype="left",xi=ti,Oi=Oi,Ei=Ei) 
bleft&lt;-res.left$boscv
## The right one-sided cross-validated bandwidth
res.right&lt;-b.OSCV(grid.b=my.bs,K="sextic",Ktype="right",xi=ti,Oi=Oi,Ei=Ei) 
bright&lt;-res.right$boscv
## The DO-validated bandwidth
bdo&lt;-(bleft+bright)/2
print(paste("DO-validated bandwidth= ", bdo, sep=""))
</code></pre>

<hr>
<h2 id='b.OSCV.MBC'>
DO-Validation for Multiplicative Bias Corrected Hazard Estimators</h2><span id='topic+b.OSCV.MBC'></span>

<h3>Description</h3>

<p>Bandwidth selection for the multiplicatively bias corrected local linear hazard estimation using DO-validation and one-sided (left or right) cross-validation</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.OSCV.MBC(grid.b, nb , K = "sextic", Ktype = "left", xi, Oi, Ei, wei = "same")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.OSCV.MBC_+3A_grid.b">grid.b</code></td>
<td>
<p>Optional. A vector of bandwidths to minimise the cross-validation score. If not specified it will be considered an equally-spaced grid of <code>nb</code> bandwidths between &quot;amp/(M+1)&quot; and &quot;amp/2&quot; for &quot;amp&quot; being the range of <code>xi</code> and &quot;M&quot; its length.</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_nb">nb</code></td>
<td>

<p>Optional. The number of bandwidths used to minimise the cross-validation score. If <code>grid.b</code> is provided then the argument <code>nb</code> will be ignored (if specified). </p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the hazard estimator. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details of <code><a href="#topic+hazard.MBC">hazard.MBC</a></code> for the definition).
</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_ktype">Ktype</code></td>
<td>
<p>Choose between <code>"left"</code> or <code>"right"</code> for left- or right- sided cross-validation, respectively.
</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the count data are given.
</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="b.OSCV.MBC_+3A_wei">wei</code></td>
<td>
<p>Indicates the weights used in the cross-validation score. Choose between the value <code>"exposure"</code> or <code>"same"</code>. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the data are given as count data i.e. number of occurrences and exposures.
</p>
<p>The DO-validated bandwidth is calculated as the average of left- and right- sided cross-validation (see example below). 
</p>
<p>If the one-sided cross-validation score is strictly increasing or decreasing then a warning will be shown together with the onesided cross-validated bandwidth (in this case one of the extremes in <code>grid.b</code>, adjusted by the rescaling constant, which is 0.5948 for Epanechnikov kernel, and 0.6501 for the sextic kernel).
</p>
<p>The score is defined with two different weighting functions. This is controlled with the parameter <code>wei</code>. By default <code>wei="exposure"</code> that means that only areas where the exposure is significant contribute to the criterion. Specify <code>wei="same"</code> to allow  all time points contribute the same to the criterion (see Gamiz et al. 2017).</p>


<h3>Value</h3>

<table>
<tr><td><code>boscv</code></td>
<td>
<p>The one-sided cross-validated bandwidth.</p>
</td></tr>
<tr><td><code>ind.oscv</code></td>
<td>
<p>The position of the one-sided cross-validated bandwidth into <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>oscv.values</code></td>
<td>
<p>The values of the one-sided cross-validation score for each bandwidth in <code>grid.b</code>.</p>
</td></tr>
<tr><td><code>b.grid</code></td>
<td>
<p>The grid of bandwidths where the one-sided cross-validation score has been evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575 
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.MBC">hazard.MBC</a></code>,<code><a href="#topic+b.CV.MBC">b.CV.MBC</a></code>,<code><a href="#topic+b.BO.MBC">b.BO.MBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
my.bs&lt;-seq(50,80,length.out=30)
## The left one-sided cross-validated bandwidth
res.left&lt;-b.OSCV.MBC(grid.b=my.bs,K="sextic",Ktype="left",
    xi=ti,Oi=Oi,Ei=Ei,wei="same")
bleft&lt;-res.left$boscv
## The right one-sided cross-validated bandwidth
res.right&lt;-b.OSCV.MBC(grid.b=my.bs,K="sextic",Ktype="right",
    xi=ti,Oi=Oi,Ei=Ei,wei="same") 
bright&lt;-res.right$boscv
## The do-validated bandwidth
bdo&lt;-(bleft+bright)/2
print(paste("DO-validated bandwidth= ", bdo, sep=""))
</code></pre>

<hr>
<h2 id='discretise.data'>Aggregate data in the form of occurrences and exposures
</h2><span id='topic+discretise.data'></span>

<h3>Description</h3>

<p>Aggregate data in the form of occurrences and exposures from individual survival data (possibly right censored and/or left truncated).</p>


<h3>Usage</h3>

<pre><code class='language-R'>  discretise.data(Li, Zi, deltai, xi, M)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discretise.data_+3A_li">Li</code></td>
<td>
<p>Vector of truncation levels: the datum is registered only if the life time is greater than the truncation level. 
</p>
</td></tr>
<tr><td><code id="discretise.data_+3A_zi">Zi</code></td>
<td>
<p>Vector of observed life times (Zi=min(Ti,Ci) with Ci censoring value and Ti the true life time). 
</p>
</td></tr>
<tr><td><code id="discretise.data_+3A_deltai">deltai</code></td>
<td>
<p>Vector with non-censoring indicator values (0 if datum is censored, 1 otherwise).  
</p>
</td></tr>
<tr><td><code id="discretise.data_+3A_xi">xi</code></td>
<td>
<p>Optional. Vector with the grid of time points where the occurrences and exposures should  be calculated. If not provide the grid is calculated automatically.
</p>
</td></tr>  
<tr><td><code id="discretise.data_+3A_m">M</code></td>
<td>
<p>Optional. A positive scalar used as the grid size. If not provided it is chosen automatically.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>  The hazard estimators and bandwidth selectors available in the DOvalidation package work from data aggregated in the form of occurrences and exposures. This function can be used to work with individual survival data in the form (Li,Zi,deltai) &ndash; left-truncation level (Li), observed time (Zi) and non-censoring indicator (deltai). If data are not truncated then Li can be chosen as 0.      
</p>


<h3>Value</h3>


<table>
<tr><td><code>xi</code></td>
<td>
<p>Vector with the time grid points. </p>
</td></tr>
<tr><td><code>Oi</code></td>
<td>
<p>Vector with the calculated occurrences at the time grid points.</p>
</td></tr>
<tr><td><code>Ei</code></td>
<td>
<p>Vector with the calculated exposures at the time grid points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A simple example with right censored data
Zi&lt;-c(3,6,7,7,8,10,11,11,11,12,13,13,14,16,20,20,22,32,34,36)
n&lt;-length(Zi)
Li&lt;-deltai&lt;-rep(0,n) 
ind.cens&lt;-c(1,3,4,8,9,13,14,15,16)
deltai[-ind.cens]&lt;-1
## Obtain the occurrences and exposures for a grid of 6 time points
res&lt;-discretise.data(Li,Zi,deltai,M=6)
## Now calculate the local linear hazard estimator
hazard.LL(res$xi,res$Oi,res$Ei,res$xi,b=10)
</code></pre>

<hr>
<h2 id='DK'>
Denmark Female Mortality Data
</h2><span id='topic+DK'></span>

<h3>Description</h3>

<p>Mortality data of women in the calendar year 2006 from Denmark. 
The data were obtained from the Humam Mortality Database. Only ages from 40 to 110 have been included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DK)</code></pre>


<h3>Format</h3>

<p>This data frame contains 71 rows and the following 2 columns.
</p>

<dl>
<dt><code>D</code></dt><dd><p>Death counts for women of ages between 40 and 110 during the calendar year 2006. 
</p>
</dd>
<dt><code>E</code></dt><dd><p>&quot;Person-years&quot; lived in the female population during the year 2006 for each age-group (from 40 to 110)</p>
</dd>  </dl>



<h3>Source</h3>

<p>Human Mortality Database. University of California, Berkeley (USA), and Max Planck Institute for Demographic Research (Germany). Available at www.mortality.org or www.humanmortality.de
</p>



<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Spreeuw, J., Nielsen, J.P. and Jarner, S.F. (2013). A visual test of mixed hazard models, SORT, 37, 149-170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DK)
</code></pre>

<hr>
<h2 id='DOvalidation-package'>
Kernel Hazard Estimation with Best One-Sided and Double One-Sided Cross-Validation
</h2><span id='topic+DOvalidation-package'></span><span id='topic+DOvalidation'></span>

<h3>Description</h3>

<p>Local linear hazard estimator and its multiplicatively bias correction, including three bandwidth selection methods: best one-sided cross-validation, double one-sided cross-validation, and standard cross-validation.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DOvalidation</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-10-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>M.L. Gamiz, E. Mammen, M.D. Martinez-Miranda and J.P. Nielsen
</p>
<p>Maintainer: Maria Dolores Martinez-Miranda &lt;mmiranda@ugr.es&gt;
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
## Local linear hazard estimator 
## and its multiplicatively bias corrected version (MBC)
## with best one-sided cross-validated bandwidths
## Note: use functions b.BO and b.BO.MBC to get these bandwidths
##       (48.7 and 14.6, respectively)
res.LL&lt;-hazard.LL(xi=ti,Oi=Oi,Ei=Ei,x=ti,b=14.6)
res.MBC&lt;-hazard.MBC(xi=ti,Oi=Oi,Ei=Ei,x=ti,b=48.7)
plot(ti,res.LL$hLL,main='Hazard estimates',xlab='age',ylab='',
    type='l',col=4,lwd=2)
lines(ti,res.MBC$hMBC,col=2,lwd=2)
legend("topleft",bt="n",c("Local linear", "MBC"),col=c(4,2),lwd=2)
</code></pre>

<hr>
<h2 id='hazard.LL'>
Local Linear Hazard Estimator (Natural Weighting)</h2><span id='topic+hazard.LL'></span>

<h3>Description</h3>

<p>Local linear estimator of the unidimensional hazard (or hazard rate) with natural weighting introduced by Nielsen and Tanggaard (2001).</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hazard.LL(xi, Oi, Ei, x, b, K="epa", Ktype="symmetric" , CI=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard.LL_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the counts data are given.
</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_x">x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator will be evaluated.
</p>
</td></tr>  
<tr><td><code id="hazard.LL_+3A_b">b</code></td>
<td>
<p>A positive scalar used as the bandwidth. 
</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the estimator. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details for its expression).
</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_ktype">Ktype</code></td>
<td>
<p>Indicates the type of kernel to be used. Choose among <code>"symmetric"</code> for the usual kernel definition (chosen in the argument <code>K</code>), <code>"left"</code> for the left-sided version of the kernel, or <code>"right"</code> for the right-sided version. See details below.</p>
</td></tr>
<tr><td><code id="hazard.LL_+3A_ci">CI</code></td>
<td>
<p>Logical. If <code>TRUE</code> then 95% pointwise confidence intervals are provided for the hazard function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator is calculated assuming that the data are given as count data i.e. number of occurrences and exposures.
The function allows to consider two different kernels using the argument <code>K</code>. These are: Epanechnikov, K(u)=.75*(1-u^2)*(abs(u)&lt;1), and sextic K(u)=(3003/2048)*(1-(u)^2)^6)*(abs(u)&lt;1). The argument <code>Ktype</code> will define the usual estimator with whole support kernel as it is defined by <code>K</code> or the one-sided versions using left-sided kernel, 2*K(u)*(u&lt;0), or right-sided kernel 2*K(u)*(u&gt;0). See more details in Gamiz et al. (2016).  
</p>


<h3>Value</h3>


<table>
<tr><td><code>x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator has been evaluated. </p>
</td></tr>
<tr><td><code>OLL</code></td>
<td>
<p>Vector with the smoothed occurrences (using the local linear kernel).</p>
</td></tr>
<tr><td><code>ELL</code></td>
<td>
<p>Vector with the smoothed exposures (using the local linear kernel).</p>
</td></tr>
<tr><td><code>hLL</code></td>
<td>
<p>Vector (or scalar) with the resulting hazard estimates at grid points <code>x</code>.</p>
</td></tr>
<tr><td><code>OLL.norm</code></td>
<td>
<p>Vector with the normalized smoothed occurrences (the smoothing weights are defined as for <code>O.LL</code> but normalized to add up one.</p>
</td></tr>
<tr><td><code>ELL.norm</code></td>
<td>
<p>Vector with the normalized smoothed exposures (the smoothing weights are defined as for <code>E.LL</code> but normalized to add up one.</p>
</td></tr>
<tr><td><code>CI.inf</code></td>
<td>
<p>Vector with the lower limits for the 95% confidence intervals. If <code>CI=FALSE</code> then <code>NA</code> values are provided.</p>
</td></tr>
<tr><td><code>CI.sup</code></td>
<td>
<p>Vector with the upper limits for the 95% confidence intervals. If <code>CI=FALSE</code> then <code>NA</code> values are provided.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL.RH">hazard.LL.RH</a></code>,<code><a href="#topic+hazard.MBC">hazard.MBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculation of the local linear hazard estimator with do-validated bandwidth.
## The hazard estimator is shown and decomposed into smoothed occurrences and exposures.
## This example is described in Gamiz et al. (2016).
data(UK)
Oi&lt;-UK$D
Ei&lt;-UK$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
M&lt;-length(ti)
country&lt;-'UK'
bdo&lt;-5.11
resLL.do&lt;-hazard.LL(xi=ti,Oi=Oi,Ei=Ei,x=ti,b=bdo,K="sextic",Ktype="symmetric",CI=TRUE)

## The local linear hazard estimate is hLL.do below
hLL.do&lt;-resLL.do$hLL

## The smoothed occurrences and exposures are:
ELL.norm.do&lt;-resLL.do$ELL.norm
OLL.norm.do&lt;-resLL.do$OLL.norm

## The 95% pointwise confidence intervals based on the asymptotics are
hLL.do.inf&lt;-resLL.do$CI.inf
hLL.do.sup&lt;-resLL.do$CI.sup

# Now we plot the hazard estimator with confidence intervals
old.par&lt;-par(mar=c(3,1.5,1.5,1.5),oma=c(2,0.5,0.5,0.2),
mgp=c(1.5,0.5,0),cex.axis=1,cex.main=1.5,mfrow=c(3,2))

#hazard estimate
tit&lt;-paste(country,"Hazard estimate",sep= ' - ' )
yy&lt;-range(c(hLL.do.inf,hLL.do.sup),na.rm=TRUE)
plot(ti,hLL.do,main=tit,xlab='age',ylab='',type='l',lwd=2,ylim=yy)
# the confidence bands
x1&lt;-ti;x2&lt;-ti[M:1]   
y1&lt;-hLL.do.sup;y2&lt;-hLL.do.inf[M:1]       
polygon(c(x1,x2,x1[1]),c(y1,y2,y1[1]),col=gray(0.7),border=FALSE)
lines(ti,hLL.do,lty=1,lwd=2,col=1)
  
## Zooming at the old mortality
ind.ages&lt;- -c(1:60)  ## only women with ages 100 or higher
ti2&lt;-ti[ind.ages];M2&lt;-length(ti2)
yy2&lt;-range(c(hLL.do.inf[ind.ages],hLL.do.sup[ind.ages]),na.rm=TRUE)
plot(ti2,hLL.do[ind.ages],main=tit,xlab='age',ylab='',type='l',
lwd=2,ylim=yy2)
# the confidence intervals
x1&lt;-ti2;x2&lt;-ti2[M2:1]   
y1&lt;-hLL.do.sup[ind.ages];hLL.do.inf2&lt;-hLL.do.inf[ind.ages]
y2&lt;-hLL.do.inf2[M2:1]       
polygon(c(x1,x2,x1[1]),c(y1,y2,y1[1]),col=gray(0.7),border=FALSE)
lines(ti2,hLL.do[ind.ages],lty=1,lwd=2,col=1)
  
## We decompose the estimator in the smooth occurrences and exposures
#   The occurrences with a zoom at old-age mortality
yy&lt;-range(OLL.norm.do,na.rm=TRUE)
plot(ti,OLL.norm.do,main="Smoothed occurrences",xlab='age',ylab='',type='l',
lwd=2,ylim=yy)
yy2&lt;-range(OLL.norm.do[ind.ages],na.rm=TRUE)
plot(ti2,OLL.norm.do[ind.ages],main="Smoothed occurrences",xlab='age',
ylab='',type='l',lwd=2,ylim=yy2)
  
#   The exposures with a zoom at old-age mortality
yy&lt;-range(ELL.norm.do,na.rm=TRUE)
plot(ti,ELL.norm.do,main="Smoothed exposures",xlab='age',ylab='',type='l',
lwd=2,ylim=yy)
yy2&lt;-range(ELL.norm.do[ind.ages],na.rm=TRUE)
plot(ti2,ELL.norm.do[ind.ages],main="Smoothed exposures",xlab='age',ylab='',
type='l',lwd=2,ylim=yy2)

# Revert the changes made in the graphics options
par(old.par)

</code></pre>

<hr>
<h2 id='hazard.LL.RH'>Local Linear Hazard Estimator (Ramlau-Hansen Weighting)
</h2><span id='topic+hazard.LL.RH'></span>

<h3>Description</h3>

<p>Local linear estimator of the unidimensional hazard (or hazard rate) with Ramlau-Hansen weighting as was defined by Nielsen and Tanggaard (2001).</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hazard.LL.RH(xi , Oi , Ei , x , b , K="epa")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard.LL.RH_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the counts data are given.
</p>
</td></tr>
<tr><td><code id="hazard.LL.RH_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number (counts) of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="hazard.LL.RH_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="hazard.LL.RH_+3A_x">x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator will be evaluated.
</p>
</td></tr>  
<tr><td><code id="hazard.LL.RH_+3A_b">b</code></td>
<td>
<p>A positive scalar used as the bandwidth. 
</p>
</td></tr>
<tr><td><code id="hazard.LL.RH_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the estimator. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details for its expression).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator is calculated assuming that the data are given as count data i.e. number of occurrences and exposures.
The function allows to consider two different kernels using the argument <code>K</code>. These are: Epanechnikov, K(u)=.75*(1-u^2)*(abs(u)&lt;1), and sextic K(u)=(3003/2048)*(1-(u)^2)^6)*(abs(u)&lt;1).   
</p>


<h3>Value</h3>


<table>
<tr><td><code>x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator has been evaluated. </p>
</td></tr>
<tr><td><code>hLL</code></td>
<td>
<p>Vector (or scalar) with the resulting hazard estimates at grid points x.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## This example was described by Gamiz et al. (2016) to analyse the exposure robustness of
## local linear hazards with natural weigthing and Ramlau-Hansen weighting
data(Iceland)
Ei&lt;-Iceland$E
Oi&lt;-Iceland$D
xi&lt;-40:110
n&lt;-length(xi)
x&lt;-seq(xi[1],xi[n],length=100)

## Hazard estimates with the original data
b0&lt;-11.9899
alphaIC17&lt;-hazard.LL.RH(xi,Oi,Ei,x,b=b0,K="sextic")$hLL
alLL17&lt;-hazard.LL(xi,Oi,Ei,x,b=b0,K="sextic",Ktype="symmetric")$hLL
hi&lt;-Oi/Ei;hi[Ei==0]&lt;-0
print(round(hi[60:71],3))
## Hazard estimates with the modified data (one change in the exposure)
Ei2&lt;-Ei; Ei2[67]&lt;-2/365
alphaIC005&lt;-hazard.LL.RH(xi,Oi,Ei2,x,b=b0,K="sextic")$hLL
alLL005&lt;-hazard.LL(xi,Oi,Ei2,x,b=b0,K="sextic",Ktype="symmetric")$hLL

## Figure: Exposure robustness
old.par&lt;-par(mfrow=c(2,2))
plot(x[73:100],alphaIC17[73:100],lwd=2,type='l',main='Exposure: 0.17',
xlab='',ylab='Ramlau-Hansen weighting')
plot(x[73:100],alphaIC005[73:100],lwd=2,type='l',main='Exposure: 0.005',
xlab='',ylab='Ramlau-Hansen weighting')
plot(x[73:100],alLL17[73:100],lwd=2,type='l',main='Exposure: 0.17',
xlab='',ylab='Natural  weighting')
plot(x[73:100],alLL005[73:100],lwd=2,type='l',main='Exposure: 0.005',
xlab='',ylab='Natural weighting')

par(old.par)
</code></pre>

<hr>
<h2 id='hazard.MBC'>
Multiplicative Bias Corrected Hazard Estimator</h2><span id='topic+hazard.MBC'></span>

<h3>Description</h3>

<p>Multiplicatively bias corrected local linear estimator of the unidimensional hazard with natural weighting introduced by Nielsen and Tanggaard (2001).</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hazard.MBC(xi, Oi, Ei, x, b, K="sextic", Ktype="symmetric")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hazard.MBC_+3A_xi">xi</code></td>
<td>
<p>Vector of time points where the counts data are given.
</p>
</td></tr>
<tr><td><code id="hazard.MBC_+3A_oi">Oi</code></td>
<td>
<p>Vector with the number of occurrences observed at each time point (<code>xi</code>). 
</p>
</td></tr>
<tr><td><code id="hazard.MBC_+3A_ei">Ei</code></td>
<td>
<p>Vector with the observed exposure at each time point (<code>xi</code>).  
</p>
</td></tr>
<tr><td><code id="hazard.MBC_+3A_x">x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator will be evaluated.
</p>
</td></tr>  
<tr><td><code id="hazard.MBC_+3A_b">b</code></td>
<td>
<p>A positive scalar used as the bandwidth. 
</p>
</td></tr>
<tr><td><code id="hazard.MBC_+3A_k">K</code></td>
<td>
<p>Indicates the kernel function to be considered in the estimator. Choose between values <code>"epa"</code> (for the Epanechnikov kernel) or <code>"sextic"</code> (see details for its expression).
</p>
</td></tr>
<tr><td><code id="hazard.MBC_+3A_ktype">Ktype</code></td>
<td>
<p>Indicates the type of kernel to be used. Choose among <code>"symmetric"</code> for the usual kernel definition (chosen in the argument <code>K</code>), <code>"left"</code> for the left-sided version of the kernel, or <code>"right"</code> for the right-sided version. See details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimator is calculated assuming that the data are given as count data i.e. number of occurrences and exposures.
The function allows to consider two different kernels using the argument <code>K</code>. These are: Epanechnikov, K(u)=.75*(1-u^2)*(abs(u)&lt;1), and sextic K(u)=(3003/2048)*(1-(u)^2)^6)*(abs(u)&lt;1). The argument <code>Ktype</code> will define the usual estimator with whole support kernel as it is defined by <code>K</code> or the one-sided versions using left-sided kernel, 2*K(u)*(u&lt;0), or right-sided kernel 2*K(u)*(u&gt;0). See more details in Gamiz et al. (2017).  
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>Vector (or scalar) with the (time) grid points where the hazard estimator has been evaluated. </p>
</td></tr>
<tr><td><code>hMBC</code></td>
<td>
<p>Vector (or scalar) with the resulting hazard estimates at grid points <code>x</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Martinez-Miranda, M.D. and Nielsen, J.P. (2017). Multiplicative local linear hazard estimation and best one-sided cross-validation. Available 	 at http://arxiv.org/abs/1710.05575  
</p>
<p>Nielsen, J.P. and Tanggaard, C. (2001). Boundary and bias correction in kernel hazard estimation. Scandinavian Journal of Statistics,28, 675-698.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hazard.LL">hazard.LL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
Oi&lt;-Iceland$D
Ei&lt;-Iceland$E
ti&lt;-40:110  # time is age and it goes from 40 to 110 years
res&lt;-hazard.MBC(xi=ti,Oi=Oi,Ei=Ei,x=ti,b=48.7)
plot(ti,res$hMBC,main='Hazard estimate',xlab='age',ylab='',type='l',lwd=2)
</code></pre>

<hr>
<h2 id='Iceland'>Iceland Female Mortality Data</h2><span id='topic+Iceland'></span>

<h3>Description</h3>

<p>Mortality data of women in the calendar year 2006 from Iceland. The data were obtained from the Humam Mortality Database. Only ages from 40 to 110 have been included.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Iceland)</code></pre>


<h3>Format</h3>

<p>This data frame contains 71 rows and the following 2 columns.
</p>

<dl>
<dt><code>D</code></dt><dd><p>Death counts for women of ages between 40 and 110 during the calendar year 2006</p>
</dd>
<dt><code>E</code></dt><dd><p>&quot;Person-years&quot; lived in the female population during the year 2006 for each age-group (from 40 to 110).</p>
</dd>
</dl>


<h3>Source</h3>

<p>Human Mortality Database. University of California, Berkeley (USA), and Max Planck Institute for Demographic Research (Germany). Available at www.mortality.org or www.humanmortality.de
</p>



<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Spreeuw, J., Nielsen, J. P. and Jarner, S. F. (2013). A visual test of mixed hazard models,
SORT, 37, 149-??170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Iceland)
</code></pre>

<hr>
<h2 id='K.epa'>
Epanechnikov Kernel
</h2><span id='topic+K.epa'></span>

<h3>Description</h3>

<p>Evaluation of the Epanechnikov kernel function</p>


<h3>Usage</h3>

<pre><code class='language-R'>K.epa(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K.epa_+3A_u">u</code></td>
<td>

<p>A vector (or scalar) with the evaluation point(s). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the kernel function at <code>u</code>.</p>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+K.sextic">K.sextic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(K.epa,-1.5,1.5,main="Epanechnikov kernel",ylab="K(u)",xlab="u")
# The left onesided 
K.epa.left&lt;-function(u) return(2*K.epa(u)*(u&lt;0))
curve(K.epa.left,-1.5,1.5,main="Left onesided Epanechnikov kernel",ylab="K(u)",xlab="u")
</code></pre>

<hr>
<h2 id='K.sextic'>Sextic Kernel</h2><span id='topic+K.sextic'></span>

<h3>Description</h3>

<p>Evaluation of the Sextic kernel function</p>


<h3>Usage</h3>

<pre><code class='language-R'>K.sextic(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K.sextic_+3A_u">u</code></td>
<td>

<p>A vector (or scalar) with the evaluation point(s). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the kernel function at <code>u</code>.</p>


<h3>Author(s)</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+K.epa">K.epa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(K.sextic,-1.5,1.5,main="Sextic kernel",ylab="K(u)",xlab="u")
# The left onesided 
K.sextic.left&lt;-function(u) return(2*K.sextic(u)*(u&lt;0))
curve(K.sextic.left,-1.5,1.5,main="Left onesided sextic kernel",ylab="K(u)",xlab="u")
</code></pre>

<hr>
<h2 id='UK'>
UK Female Mortality Data
</h2><span id='topic+UK'></span>

<h3>Description</h3>

<p>Mortality data of women in the calendar year 2006 from United Kingdom. 
The data were obtained from the Humam Mortality Database. Only ages from 40 to 110 have been included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(UK)</code></pre>


<h3>Format</h3>

<p>This data frame contains 71 rows and the following 2 columns.
</p>

<dl>
<dt><code>D</code></dt><dd><p>Death counts for women of ages between 40 and 110 during the calendar year 2006. 
</p>
</dd>
<dt><code>E</code></dt><dd><p>&quot;Person-years&quot; lived in the female population during the year 2006 for each age-group (from 40 to 110)</p>
</dd>  </dl>



<h3>Source</h3>

<p>Human Mortality Database. University of California, Berkeley (USA), and Max Planck Institute for Demographic Research (Germany). Available at www.mortality.org or www.humanmortality.de
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Spreeuw, J., Nielsen, J.P. and Jarner, S.F. (2013). A visual test of mixed hazard models, SORT, 37, 149-170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UK)
</code></pre>

<hr>
<h2 id='US'>
US Female Mortality Data
</h2><span id='topic+US'></span>

<h3>Description</h3>

<p>Mortality data of women in the calendar year 2006 from United States. 
The data were obtained from the Humam Mortality Database. Only ages from 40 to 110 have been included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(US)</code></pre>


<h3>Format</h3>

<p>This data frame contains 71 rows and the following 2 columns.
</p>

<dl>
<dt><code>D</code></dt><dd><p>Death counts for women of ages between 40 and 110 during the calendar year 2006. Some of these numbers are estimates (of population size or numbers of deaths), not actual counts, and therefore may be expressed as non-integers.
</p>
</dd>
<dt><code>E</code></dt><dd><p>&quot;Person-years&quot; lived in the female population during the year 2006 for each age-group (from 40 to 110)</p>
</dd>  </dl>



<h3>Source</h3>

<p>Human Mortality Database. University of California, Berkeley (USA), and Max Planck Institute for Demographic Research (Germany). Available at www.mortality.org or www.humanmortality.de
</p>


<h3>References</h3>

<p>Gamiz, M.L., Mammen, E., Martinez-Miranda, M.D. and Nielsen, J.P.(2016). Double one-sided cross-validation of local linear hazards. Journal of the Royal Statistical Society B, 78, 755-779.
</p>
<p>Spreeuw, J., Nielsen, J.P. and Jarner, S.F. (2013). A visual test of mixed hazard models, SORT, 37, 149-170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(US)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
