<!DOCTYPE html><html><head><title>Help for package globals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {globals}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.length'><p>Gets the length of an object without dispatching</p></a></li>
<li><a href='#cleanup.Globals'><p>Drop certain types of globals</p></a></li>
<li><a href='#findGlobals'><p>Get all global objects of an expression</p></a></li>
<li><a href='#Globals'><p>A representation of a set of globals</p></a></li>
<li><a href='#globalsByName'><p>Locates and retrieves a set of global variables by their names</p></a></li>
<li><a href='#packagesOf.Globals'><p>Identify the packages of the globals</p></a></li>
<li><a href='#walkAST'><p>Walk the Abstract Syntax Tree (AST) of an R Expression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.16.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>codetools</td>
</tr>
<tr>
<td>Title:</td>
<td>Identify Global Objects in R Expressions</td>
</tr>
<tr>
<td>Description:</td>
<td>Identifies global ("unknown" or "free") objects in R expressions
    by code inspection using various strategies (ordered, liberal, or
    conservative).  The objective of this package is to make it as simple as
    possible to identify global objects for the purpose of exporting them in
    parallel, distributed compute environments.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>TRUE</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://globals.futureverse.org">https://globals.futureverse.org</a>,
<a href="https://github.com/HenrikBengtsson/globals">https://github.com/HenrikBengtsson/globals</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HenrikBengtsson/globals/issues">https://github.com/HenrikBengtsson/globals/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-07 23:38:30 UTC; henrik</td>
</tr>
<tr>
<td>Author:</td>
<td>Henrik Bengtsson [aut, cre, cph],
  Davis Vaughan [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Henrik Bengtsson &lt;henrikb@braju.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-08 00:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='.length'>Gets the length of an object without dispatching</h2><span id='topic+.length'></span>

<h3>Description</h3>

<p>Gets the length of an object without dispatching
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.length(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".length_+3A_x">x</code></td>
<td>
<p>Any <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns <code>length(unclass(x))</code>, but tries to avoid
calling <code>unclass(x)</code> unless necessary.
</p>


<h3>Value</h3>

<p>A non-negative integer.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+.subset">.subset</a>()</code> and <code><a href="base.html#topic+.subset2">.subset2</a>()</code>.
</p>

<hr>
<h2 id='cleanup.Globals'>Drop certain types of globals</h2><span id='topic+cleanup.Globals'></span><span id='topic+cleanup'></span>

<h3>Description</h3>

<p>Drop certain types of globals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Globals'
cleanup(globals, drop = c("missing", "base-packages", "nativesymbolinfo"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cleanup.Globals_+3A_globals">globals</code></td>
<td>
<p>A Globals object.</p>
</td></tr>
<tr><td><code id="cleanup.Globals_+3A_drop">drop</code></td>
<td>
<p>A character vector specifying what type of globals to drop.</p>
</td></tr>
<tr><td><code id="cleanup.Globals_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>

<hr>
<h2 id='findGlobals'>Get all global objects of an expression</h2><span id='topic+findGlobals'></span><span id='topic+globalsOf'></span>

<h3>Description</h3>

<p>Get all global objects of an expression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findGlobals(
  expr,
  envir = parent.frame(),
  ...,
  attributes = TRUE,
  tweak = NULL,
  dotdotdot = c("warning", "error", "return", "ignore"),
  method = c("ordered", "conservative", "liberal"),
  substitute = FALSE,
  unlist = TRUE,
  trace = FALSE
)

globalsOf(
  expr,
  envir = parent.frame(),
  ...,
  method = c("ordered", "conservative", "liberal"),
  tweak = NULL,
  locals = NA,
  substitute = FALSE,
  mustExist = TRUE,
  unlist = TRUE,
  recursive = TRUE,
  skip = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findGlobals_+3A_expr">expr</code></td>
<td>
<p>An R expression.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_envir">envir</code></td>
<td>
<p>The environment from where to search for globals.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_attributes">attributes</code></td>
<td>
<p>If TRUE (default), attributes of <code>expr</code> are also searched.
If FALSE, they are not.
If a character vector, then attributes with matching names are searched.
Note, the attributes of the attributes elements are not searched, that is,
attributes are not searched recursively.  Also, attributes are searched
with 'dotdotdot = &quot;ignore&quot;.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_tweak">tweak</code></td>
<td>
<p>An optional function that takes an expression
and returns a tweaked expression.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_dotdotdot">dotdotdot</code></td>
<td>
<p>TBD.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_method">method</code></td>
<td>
<p>A character string specifying what type of search algorithm
to use.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_substitute">substitute</code></td>
<td>
<p>If TRUE, the expression is <code>substitute()</code>:ed,
otherwise not.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_unlist">unlist</code></td>
<td>
<p>If TRUE, a list of unique objects is returned.
If FALSE, a list of <code>length(expr)</code> sublists.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_trace">trace</code></td>
<td>
<p>TBD.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_locals">locals</code></td>
<td>
<p>Should globals part of any &quot;local&quot; environment of
a function be included or not?</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_mustexist">mustExist</code></td>
<td>
<p>If TRUE, an error is thrown if the object of the
identified global cannot be located.  Otherwise, the global
is not returned.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_recursive">recursive</code></td>
<td>
<p>If TRUE, globals that are closures (functions) and that
exist outside of namespaces (&quot;packages&quot;), will be recursively
scanned for globals.</p>
</td></tr>
<tr><td><code id="findGlobals_+3A_skip">skip</code></td>
<td>
<p>(internal) A list of globals not to be searched for
additional globals.  Ignored unless <code>recursive</code> is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There currently three strategies for identifying global objects.
</p>
<p>The <code>method = "ordered"</code> search method identifies globals such that
a global variable preceding a local variable with the same name
is not dropped (which the <code>"conservative"</code> method would).
</p>
<p>The <code>method = "conservative"</code> search method tries to keep the number
of false positive to a minimum, i.e. the identified objects are
most likely true global objects.  At the same time, there is
a risk that some true globals are not identified (see example).
This search method returns the exact same result as the
<code><a href="codetools.html#topic+findGlobals">findGlobals</a>()</code> function of the
<span class="pkg">codetools</span> package.
</p>
<p>The <code>method = "liberal"</code> search method tries to keep the
true-positive ratio as high as possible, i.e. the true globals
are most likely among the identified ones.  At the same time,
there is a risk that some false positives are also identified.
</p>
<p>With <code>recursive = TRUE</code>, globals part of locally defined
functions will also be found, otherwise not.
</p>


<h3>Value</h3>

<p><code>findGlobals()</code> returns a character vector.
</p>
<p><code>globalsOf()</code> returns a <a href="#topic+Globals">Globals</a> object.
</p>


<h3>See Also</h3>

<p>Internally, the <span class="pkg"><a href="codetools.html#topic+codetools">codetools</a></span> package is utilized for
code inspections.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b &lt;- 2
expr &lt;- substitute({ a &lt;- b; b &lt;- 1 })

## Will _not_ identify 'b' (because it's also a local)
globalsC &lt;- globalsOf(expr, method = "conservative")
print(globalsC)

## Will identify 'b'
globalsL &lt;- globalsOf(expr, method = "liberal")
print(globalsL)
</code></pre>

<hr>
<h2 id='Globals'>A representation of a set of globals</h2><span id='topic+Globals'></span><span id='topic+as.Globals'></span><span id='topic+as.Globals.Globals'></span><span id='topic+as.Globals.list'></span><span id='topic++5B.Globals'></span><span id='topic+names'></span>

<h3>Description</h3>

<p>A representation of a set of globals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Globals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Globals_+3A_object">object</code></td>
<td>
<p>A named list.</p>
</td></tr>
<tr><td><code id="Globals_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Globals</code>, which is a <em>named</em> list
of the value of the globals, where the element names are the names of
the globals.  Attribute <code>where</code> is a named list of the same length
and with the same names.
</p>


<h3>See Also</h3>

<p>The <code><a href="#topic+globalsOf">globalsOf</a>()</code> function identifies globals
from an R expression and returns a Globals object.
</p>

<hr>
<h2 id='globalsByName'>Locates and retrieves a set of global variables by their names</h2><span id='topic+globalsByName'></span>

<h3>Description</h3>

<p>Locates and retrieves a set of global variables by their names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>globalsByName(names, envir = parent.frame(), mustExist = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="globalsByName_+3A_names">names</code></td>
<td>
<p>A character vector of global variable names.</p>
</td></tr>
<tr><td><code id="globalsByName_+3A_envir">envir</code></td>
<td>
<p>The environment from where to search for globals.</p>
</td></tr>
<tr><td><code id="globalsByName_+3A_mustexist">mustExist</code></td>
<td>
<p>If TRUE, an error is thrown if the object of the
identified global cannot be located.  Otherwise, the global
is not returned.</p>
</td></tr>
<tr><td><code id="globalsByName_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="#topic+Globals">Globals</a> object of named elements and an attribute
<code>where</code> with named elements. Both of sets have names according to
<code>names</code>.
</p>


<h3>Special &quot;argument&quot; globals</h3>

<p>If <code>names</code> specifies <code>"..."</code>, <code>"..1"</code>,  <code>"..2"</code>, ..., then they
are interpreted as arguments <code>...</code>, <code>..1</code>, <code>..2</code>, ..., respectively.
If specified, then the corresponding elements in the results are
lists of class <code>DotDotDotList</code> comprising the value of the latter.
If the special argument does not exist, then the value is <code>NA</code>, and
the corresponding <code>where</code> attributes is <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(x = 42, ...) {
  globalsByName("x")
}

globals &lt;- f()
str(globals)

globals &lt;- f(3.14)
str(globals)


g &lt;- function(x = 42, ...) {
  globalsByName("...")
}

globals &lt;- g()
str(globals)

globals &lt;- g(3.14)
str(globals)

globals &lt;- g(3.14, 1L, b = 2L, c = 3L)
str(globals)


h &lt;- function(x = 42, ...) {
  globalsByName("..2")
}

globals &lt;- h(x = 3.14, a = 1, b = 2)
str(globals)

globals &lt;- g(3.14)
str(globals)

globals &lt;- g(3.14, 1L, b = 2L, c = 3L)
str(globals)
</code></pre>

<hr>
<h2 id='packagesOf.Globals'>Identify the packages of the globals</h2><span id='topic+packagesOf.Globals'></span><span id='topic+packagesOf'></span>

<h3>Description</h3>

<p>Identify the packages of the globals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Globals'
packagesOf(globals, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="packagesOf.Globals_+3A_globals">globals</code></td>
<td>
<p>A Globals object.</p>
</td></tr>
<tr><td><code id="packagesOf.Globals_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a character vector of package names.
</p>

<hr>
<h2 id='walkAST'>Walk the Abstract Syntax Tree (AST) of an R Expression</h2><span id='topic+walkAST'></span>

<h3>Description</h3>

<p>Walk the Abstract Syntax Tree (AST) of an R Expression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>walkAST(
  expr,
  atomic = NULL,
  name = NULL,
  call = NULL,
  pairlist = NULL,
  substitute = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="walkAST_+3A_expr">expr</code></td>
<td>
<p>R <a href="base.html#topic+expression">expression</a>.</p>
</td></tr>
<tr><td><code id="walkAST_+3A_atomic">atomic</code>, <code id="walkAST_+3A_name">name</code>, <code id="walkAST_+3A_call">call</code>, <code id="walkAST_+3A_pairlist">pairlist</code></td>
<td>
<p>single-argument function that takes an
atomic, name, call and pairlist expression, respectively. Have to
return a valid R expression.</p>
</td></tr>
<tr><td><code id="walkAST_+3A_substitute">substitute</code></td>
<td>
<p>If TRUE, <code>expr</code> is
<code><a href="base.html#topic+substitute">substitute</a>()</code>:ed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>R <a href="base.html#topic+expression">expression</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
