<!DOCTYPE html><html lang="en-US"><head><title>Help for package mvnormalTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mvnormalTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#copulas'><p>Random Generation for the Copula Generated Distributions</p></a></li>
<li><a href='#faTest'><p>Rotational Robust Shapiro-Wilk Type (SWT) Test for Multivariate Normality (FA Test of Fattorini)</p></a></li>
<li><a href='#IMMV'><p>Random Generation for Distribution with Independent Marginals</p></a></li>
<li><a href='#mardia'><p>Mardia Test (Skewness and Kurtosis) for Multivariate Normality</p></a></li>
<li><a href='#mhz'><p>Henze-Zirkler Test for Multivariate Normality</p></a></li>
<li><a href='#msk'><p>Bowman and Shenton Test for Multivariate Normality</p></a></li>
<li><a href='#msw'><p>Shapiro-Wilk Type (SWT) Tests for Multivariate Normality</p></a></li>
<li><a href='#MVNMIX'><p>Random Generation for the Normal Mixture Distribution</p></a></li>
<li><a href='#mvnTest'><p>A Powerful Test for Multivariate Normality (Zhou-Shao's Test)</p></a></li>
<li><a href='#power.faTest'><p>Power Calculation using the Fattorini's FA Test Statistic</p></a></li>
<li><a href='#power.mhz'><p>Power Calculation using the Henze-Zirkler Test Statistic</p></a></li>
<li><a href='#power.msk'><p>Power Calculation using the Bowman and Shenton Test Statistic</p></a></li>
<li><a href='#power.mswR'><p>Power Calculation using the SWT-based Royston Test Statistic</p></a></li>
<li><a href='#power.mswV'><p>Power Calculation using the SWT-based Villasenor-Alva and Gonzalez-Estrada (VAGE) Test Statistic</p></a></li>
<li><a href='#power.mvnTest'><p>Power Calculation using the Zhou-Shao's Multivariate Normality Test Statistic (<code class="reqn">T_n</code>)</p></a></li>
<li><a href='#power.usw'><p>Power Calculation using the Univariate Shapiro-Wilk Test Statistic</p></a></li>
<li><a href='#PSII'><p>Random Generation for the Spherically Symmetric Pearson Type II Distribution</p></a></li>
<li><a href='#PSVII'><p>Random Generation for the Spherically Symmetric Pearson Type VII Distribution</p></a></li>
<li><a href='#SPH'><p>Random Generation for General Spherically Symmetric Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Powerful Tests for Multivariate Normality</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Yian Zhang [aut, cre],
  Ming Zhou [aut],
  Yongzhao Shao [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yian Zhang &lt;yz2777@nyu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A simple informative powerful test (mvnTest()) for multivariate normality proposed by 
    Zhou and Shao (2014) &lt;<a href="https://doi.org/10.1080%2F02664763.2013.839637">doi:10.1080/02664763.2013.839637</a>&gt;, which combines kurtosis 
    with Shapiro-Wilk test that is easy for biomedical researchers to understand and 
    easy to implement in all dimensions. This package also contains some other multivariate 
    normality tests including Fattorini's FA test (faTest()), Mardia's skewness and kurtosis 
    test (mardia()), Henze-Zirkler's test (mhz()), Bowman and Shenton's test (msk()), 
    Royston’s H test (msw()), and Villasenor-Alva and Gonzalez-Estrada's test (msw()). Empirical 
    power calculation functions for these tests are also provided. In addition, this package 
    includes some functions to generate several types of multivariate distributions mentioned in 
    Zhou and Shao (2014).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, nortest, moments, copula</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-22 17:15:40 UTC; leons</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-28 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='copulas'>Random Generation for the Copula Generated Distributions</h2><span id='topic+copulas'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for the Copula Generated Distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copulas(n, p, c = "clayton", param, invF, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copulas_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="copulas_+3A_p">p</code></td>
<td>
<p>total number of columns (variables).</p>
</td></tr>
<tr><td><code id="copulas_+3A_c">c</code></td>
<td>
<p>name of an Archimedean copula, choosing from &quot;<code>clayton</code>&quot; (default), &quot;<code>frank</code>&quot;, or &quot;<code>gumbel</code>&quot;.</p>
</td></tr>
<tr><td><code id="copulas_+3A_param">param</code></td>
<td>
<p>number (numeric) specifying the copula parameter.</p>
</td></tr>
<tr><td><code id="copulas_+3A_invf">invF</code></td>
<td>
<p>inverse function (quantile function, e.g. <code>qnorm</code>).</p>
</td></tr>
<tr><td><code id="copulas_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>invF</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample.
</p>


<h3>References</h3>

<p>Yan, J. (2007). Enjoy the joy of copulas: with a package copula. <em>Journal of Statistical Software</em>, 21(4), 1-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from Clayton(0.5, qnorm) ##
copulas(n=50, p=2, c="clayton", param=0.5, invF=qnorm)


## Power calculation against bivariate (p=2) Clayton(0.5, qnorm) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a=0.05, n=50, p=2, B=100, FUN=copulas, c="clayton", param=0.5, invF=qnorm)

</code></pre>

<hr>
<h2 id='faTest'>Rotational Robust Shapiro-Wilk Type (SWT) Test for Multivariate Normality (FA Test of Fattorini)</h2><span id='topic+faTest'></span>

<h3>Description</h3>

<p>It computes FA Test proposed by Fattorini (1986). This test would be more rotationally robust than other
SWT tests such as Royston (1982) H test and the test proposed by Villasenor-Alva and Gonzalez-Estrada (2009).
The <em>p</em>-value of the test statistic is computed based on a
simulated null distribution of the statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>faTest(X, B = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="faTest_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> data matrix or data frame, where <code class="reqn">n</code> is number of rows (observations) and <code class="reqn">p</code> is number of columns (variables) and <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="faTest_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations for null distribution, default is 1000 (increase B to increase the precision of <em>p</em>-value).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>results of the FA test for multivariate normality, i.e., test statistic,
<em>p</em>-value, and multivariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests. Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>



<h3>References</h3>

<p>Fattorini, L. (1986). Remarks on the use of Shapiro-Wilk statistic for testing multivariate normality. <em>Statistica</em>, 46(2), 209-217.
</p>
<p>Lee, R., Qian, M., &amp; Shao, Y. (2014). On rotational robustness of Shapiro-Wilk type tests for multivariate normality. <em>Open Journal of Statistics</em>, 4(11), 964.
</p>
<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>
<p>Royston, J. P. (1982). An extension of Shapiro and Wilk's W test for normality to large samples. <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, 31(2), 115-124.
</p>
<p>Villasenor Alva, J. A., &amp; Estrada, E. G. (2009). A generalization of Shapiro–Wilk's test for multivariate normality. <em>Communications in Statistics—Theory and Methods</em>, 38(11), 1870-1883.
</p>
<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.faTest">power.faTest</a></code>, <code><a href="#topic+mvnTest">mvnTest</a></code>, <code><a href="#topic+msk">msk</a></code>, <code><a href="#topic+mardia">mardia</a></code>, <code><a href="#topic+msw">msw</a></code>, <code><a href="#topic+mhz">mhz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution ##
X = matrix(rgamma(50*4,shape =  2),50)
faTest(X, B=100)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
faTest(iris.df, B=100)

</code></pre>

<hr>
<h2 id='IMMV'>Random Generation for Distribution with Independent Marginals</h2><span id='topic+IMMV'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for distribution with independent marginals such that <code class="reqn">D_1 \otimes D_2</code>.
<code class="reqn">D_1 \otimes D_2</code> denotes the distribution having independent marginal distributions <code class="reqn">D_1</code> and <code class="reqn">D_2</code>. This function can generate
multivariate random samples only from distribution <code class="reqn">D_1</code> or from both <code class="reqn">D_1</code> and <code class="reqn">D_2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IMMV(n, p, q = NULL, D1, D2 = NULL, D1.args = list(), D2.args = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IMMV_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="IMMV_+3A_p">p</code></td>
<td>
<p>total number of columns (variables).</p>
</td></tr>
<tr><td><code id="IMMV_+3A_q">q</code></td>
<td>
<p>number of columns from distribution <code>D1</code> if generate multivariate samples from independent marginal distribution <code class="reqn">D_1</code> and <code class="reqn">D_2</code>.
Default is <code>NULL</code>, i.e., generating samples only from one distribution.</p>
</td></tr>
<tr><td><code id="IMMV_+3A_d1">D1</code></td>
<td>
<p>random generation function for 1st distribution (e.g., <code>rnorm</code>, <code>rbeta</code>).</p>
</td></tr>
<tr><td><code id="IMMV_+3A_d2">D2</code></td>
<td>
<p>random generation function for 2nd distribution (e.g., <code>rnorm</code>, <code>rbeta</code>).</p>
</td></tr>
<tr><td><code id="IMMV_+3A_d1.args">D1.args</code></td>
<td>
<p>a list of optional arguments passed to <code>D1</code>.</p>
</td></tr>
<tr><td><code id="IMMV_+3A_d2.args">D2.args</code></td>
<td>
<p>a list of optional arguments passed to <code>D2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample matrix.
</p>


<h3>References</h3>

<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>
<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from IMMV(N(0,1),Beta(1,2)) ##
IMMV(n=5, p=2, q=1, D1=rbeta, D1.args=list(shape1=1,shape2=2), D2=rnorm)


## Power calculation against bivariate (p=2) IMMV(Gamma(5,1)) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a=0.05, n=50, p=2, B=100, FUN=IMMV, D1=rgamma, D1.args=list(shape=5, rate=1))

## Power calculation against bivariate (p=2) IMMV(N(0,1),Beta(1,2)) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a=0.05, n=50, p=2, B=100, FUN=IMMV, q=1, D1=rbeta, D1.args=list(shape1=1,shape2=2),
D2=rnorm)

</code></pre>

<hr>
<h2 id='mardia'>Mardia Test (Skewness and Kurtosis) for Multivariate Normality</h2><span id='topic+mardia'></span>

<h3>Description</h3>

<p>It computes Mardia (1970)'s multivariate skewness and kurtosis statistics and their corresponding
p-value. Both p-values of skewness and kurtosis statistics should be greater than 0.05 to conclude
multivariate normality. The skewness statistic will be adjusted for sample size <code class="reqn">n &lt; 20</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mardia(X, std = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mardia_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> numeric matrix or data frame.</p>
</td></tr>
<tr><td><code id="mardia_+3A_std">std</code></td>
<td>
<p>if <code>TRUE</code>, the data matrix or data frame will be standardized via normalizing
the covariance matrix by <code class="reqn">n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>results of the Mardia test, i.e., test statistic, <em>p</em>-value, and multivariate normality summary (YES, if both skewness and kurtosis <em>p</em>-value&gt;0.05).</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests. Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>



<h3>References</h3>

<p>Mardia, K. V. (1970). Measures of multivariate skewness and kurtosis with applications. <em>Biometrika</em>, 57(3), 519-530.
</p>
<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>
<p>Doornik, J. A., &amp; Hansen, H. (2008). An omnibus test for univariate and multivariate normality. <em>Oxford Bulletin of Economics and Statistics</em>, 70, 927-939.
</p>
<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvnTest">mvnTest</a></code>, <code><a href="#topic+faTest">faTest</a></code>, <code><a href="#topic+msw">msw</a></code>, <code><a href="#topic+msk">msk</a></code>, <code><a href="#topic+mhz">mhz</a></code>, <code>mvn</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution
X = matrix(rgamma(50*4,shape =  2),50)
mardia(X)

## Data from normal distribution
X = matrix(rnorm(50*4,mean = 2 , sd = 1),50)
mardia(X)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
mardia(iris.df)

</code></pre>

<hr>
<h2 id='mhz'>Henze-Zirkler Test for Multivariate Normality</h2><span id='topic+mhz'></span>

<h3>Description</h3>

<p>It computes a multiviariate normality test based on a non-negative functional distance which
was proposed by Henze and Zirkler (1990). Under the null hypothesis the test statistic is approximately
log-normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhz(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhz_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> numeric matrix or data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>results of the Henze-Zirkler test, i.e., test statistic, <em>p</em>-value, and multivariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests. Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>



<h3>References</h3>

<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>
<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>
<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.mhz">power.mhz</a></code>, <code><a href="#topic+mvnTest">mvnTest</a></code>, <code><a href="#topic+faTest">faTest</a></code>, <code><a href="#topic+msw">msw</a></code>, <code><a href="#topic+msk">msk</a></code>, <code><a href="#topic+mardia">mardia</a></code>, <code>mvn</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution
X = matrix(rgamma(50*4,shape =  2),50)
mhz(X)

## Data from normal distribution
X = matrix(rnorm(50*4,mean = 2 , sd = 1),50)
mhz(X)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
mhz(iris.df)
</code></pre>

<hr>
<h2 id='msk'>Bowman and Shenton Test for Multivariate Normality</h2><span id='topic+msk'></span>

<h3>Description</h3>

<p>It computes Bowman and Shenton (1975)'s test statistic (MSK) and its corresponding
p-value for multivariate normality. The statistic is calculated based on a combination of
multivariate skewness (MS) and kurtosis (MK) such that <code class="reqn">MSK=MS+|MK|^2</code>. For formulas of MS and MK,
please refer to Mardia (1970). The corresponding p-value of the statistic is computed based on a
simulated null distribution of MSK. The skewness statistic (MS) will be adjusted for sample size <code class="reqn">n &lt; 20</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msk(X, B = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msk_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> numeric matrix or data frame.</p>
</td></tr>
<tr><td><code id="msk_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations for null distribution, default is 1000 (increase B to increase the precision of p-value).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>results of the Bowman and Shenton test, i.e., test statistic, <em>p</em>-value, and multivariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests. Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>



<h3>References</h3>

<p>Bowman, K. O., &amp; Shenton, L. R. (1975). Omnibus test contours for departures from normality based on <code class="reqn">\sqrt b_1</code> and <code class="reqn">b_2</code>. <em>Biometrika</em>, 62(2), 243-250.
</p>
<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>
<p>Mardia, K. V. (1970). Measures of multivariate skewness and kurtosis with applications. <em>Biometrika</em>, 57(3), 519-530.
</p>
<p>Doornik, J. A., &amp; Hansen, H. (2008). An omnibus test for univariate and multivariate normality. <em>Oxford Bulletin of Economics and Statistics</em>, 70, 927-939.
</p>
<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.msk">power.msk</a></code>, <code><a href="#topic+mvnTest">mvnTest</a></code>, <code><a href="#topic+faTest">faTest</a></code>, <code><a href="#topic+msw">msw</a></code>, <code><a href="#topic+mardia">mardia</a></code>, <code><a href="#topic+mhz">mhz</a></code>, <code>mvn</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution
X = matrix(rgamma(50*4,shape =  2),50)
msk(X, B=100)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
msk(iris.df, B=100)

</code></pre>

<hr>
<h2 id='msw'>Shapiro-Wilk Type (SWT) Tests for Multivariate Normality</h2><span id='topic+msw'></span>

<h3>Description</h3>

<p>The SWT-based tests for multivariate normality including Royston's H test and the test proposed
by Villasenor-Alva and Gonzalez-Estrada (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>msw(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="msw_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> numeric matrix or data frame, the number of <code class="reqn">n</code> must be between 3 and 5000, n&gt;p.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>a result table of multivariate normality tests,
including the name of the test, test statistic,
<em>p</em>-value, and multivariate normality summary (Yes, if <em>p</em>-value&gt;0.05). Note that the test results
of <code>Royston</code> will not be reported if <code class="reqn">n &gt; 2000</code> or <code class="reqn">n &lt; 3</code> and the test results
of Villasenor-Alva and Gonzalez-Estrada (<code>VAGE</code>) will not be reported if  <code class="reqn">n &gt; 5000</code> or <code class="reqn">n &lt; 12</code>.</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests.
Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>
<p>If the number of variable is <code class="reqn">p=1</code>, only univariate Shapiro-wilk's test result will be produced.
</p>


<h3>References</h3>

<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>
<p>Royston, J. P. (1982). An extension of Shapiro and Wilk's W test for normality to large samples. <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, 31(2), 115-124.
</p>
<p>Villasenor Alva, J. A., &amp; Estrada, E. G. (2009). A generalization of Shapiro–Wilk's test for multivariate normality. <em>Communications in Statistics—Theory and Methods</em>, 38(11), 1870-1883.
</p>
<p>Lee, R., Qian, M., &amp; Shao, Y. (2014). On rotational robustness of Shapiro-Wilk type tests for multivariate normality. <em>Open Journal of Statistics</em>, 4(11), 964.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.mswR">power.mswR</a></code>, <code><a href="#topic+power.mswV">power.mswV</a></code>, <code><a href="#topic+mvnTest">mvnTest</a></code>, <code><a href="#topic+faTest">faTest</a></code>, <code><a href="#topic+msk">msk</a></code>, <code><a href="#topic+mardia">mardia</a></code>, <code><a href="#topic+mhz">mhz</a></code>, <code>mvn</code>, <code><a href="stats.html#topic+shapiro.test">shapiro.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution
X = matrix(rgamma(50*4,shape =  2),50)
msw(X)

## Data from normal distribution
X = matrix(rnorm(50*4,mean = 2 , sd = 1),50)
msw(X)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
msw(iris.df)

</code></pre>

<hr>
<h2 id='MVNMIX'>Random Generation for the Normal Mixture Distribution</h2><span id='topic+MVNMIX'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for the normal mixture distribution with density
<code class="reqn">\lambda N(0,\sum_1)+(1-\lambda)N(bl, \sum_2)</code>, where <code class="reqn">l</code> is the column vector with all elements being 1,
<code class="reqn">\sum_i=(1-\rho_i)I+\rho_ill^T</code> for <code class="reqn">i=1,2</code>. <code class="reqn">\rho</code> has to satisfy <code class="reqn">\rho &gt; -1/(p-1)</code> in order to make the
covariance matrix meaningful.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MVNMIX(n, p, lambda, mu2, rho1 = 0, rho2 = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MVNMIX_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="MVNMIX_+3A_p">p</code></td>
<td>
<p>total number of columns (variables).</p>
</td></tr>
<tr><td><code id="MVNMIX_+3A_lambda">lambda</code></td>
<td>
<p>weight parameter to allocate the proportions of the mixture, <code class="reqn">0&lt;\lambda&lt;1</code>.</p>
</td></tr>
<tr><td><code id="MVNMIX_+3A_mu2">mu2</code></td>
<td>
<p>is <code class="reqn">bl</code> of <code class="reqn">N(bl, \sum_2)</code>.</p>
</td></tr>
<tr><td><code id="MVNMIX_+3A_rho1">rho1</code></td>
<td>
<p>parameter in <code class="reqn">\sum_1</code>.</p>
</td></tr>
<tr><td><code id="MVNMIX_+3A_rho2">rho2</code></td>
<td>
<p>parameter in <code class="reqn">\sum_2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample matrix.
</p>


<h3>References</h3>

<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from MVNMIX(0.5,4,0,0) ##
MVNMIX(n=5, p=2, lambda=0.5, mu2=4, rho1=0, rho2=0)


## Power calculation against bivariate (p=2) MVNMIX(0.5,4,0,0) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a=0.05, n=50, p=2, B=100, FUN=MVNMIX, lambda=0.5, mu2=4, rho1=0, rho2=0)

</code></pre>

<hr>
<h2 id='mvnTest'>A Powerful Test for Multivariate Normality (Zhou-Shao's Test)</h2><span id='topic+mvnTest'></span>

<h3>Description</h3>

<p>A simple and powerful test for multivariate normality with a combination of multivariate
kurtosis (MK) and Shapiro-Wilk which was proposed by Zhou and Shao (2014). The <em>p</em>-value of the test
statistic (<code class="reqn">T_n</code>) is computed based on a simulated null distribution of <code class="reqn">T_n</code>. Details see Zhou and Shao (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvnTest(X, B = 1000, pct = c(0.01, 0.99))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvnTest_+3A_x">X</code></td>
<td>
<p>an <code class="reqn">n*p</code> data matrix or data frame, where <code class="reqn">n</code> is number of rows (observations) and <code class="reqn">p</code> is number of columns (variables) and <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="mvnTest_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations for null distribution, default is 1000 (increase B to increase the precision of <em>p</em>-value).</p>
</td></tr>
<tr><td><code id="mvnTest_+3A_pct">pct</code></td>
<td>
<p>percentiles of MK to get <code class="reqn">c_1</code> and <code class="reqn">c_2</code> described in the reference paper, default is (0.01, 0.99).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with two objects:
</p>

<dl>
<dt><code>mv.test</code></dt><dd><p>results of the Zhou-Shao's test for multivariate normality , i.e., test statistic <code class="reqn">T_n</code>,
<em>p</em>-value (under H0, i.e. multivariate normal, that <code class="reqn">T_n</code> is at least as extreme as the observed value), and multivariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
<dt><code>uv.shapiro</code></dt><dd><p>a dataframe with <code class="reqn">p</code> rows detailing univariate Shapiro-Wilk tests. Columns in the dataframe contain test statistics <em>W</em>, <em>p</em>-value,and univariate normality summary (YES, if <em>p</em>-value&gt;0.05).</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>
<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+power.mvnTest">power.mvnTest</a></code>, <code><a href="#topic+msk">msk</a></code>, <code><a href="#topic+mardia">mardia</a></code>, <code><a href="#topic+msw">msw</a></code>, <code><a href="#topic+faTest">faTest</a></code>, <code><a href="#topic+mhz">mhz</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Data from gamma distribution ##
X = matrix(rgamma(50*4,shape =  2),50)
mvnTest(X, B=100)

## load the ubiquitous multivariate iris data ##
## (first 50 observations of columns 1:4) ##
iris.df = iris[1:50, 1:4]
mvnTest(iris.df, B=100)

</code></pre>

<hr>
<h2 id='power.faTest'>Power Calculation using the Fattorini's FA Test Statistic</h2><span id='topic+power.faTest'></span>

<h3>Description</h3>

<p>Empirical power calculation using the Fattorini's FA Test Statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.faTest(a, n, p, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.faTest_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.faTest_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.faTest_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.faTest_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.faTest_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.faTest_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Fattorini, L. (1986). Remarks on the use of Shapiro-Wilk statistic for testing multivariate normality. <em>Statistica</em>, 46(2), 209-217.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.faTest(a = 0.05, n = 50, p = 2,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.mhz'>Power Calculation using the Henze-Zirkler Test Statistic</h2><span id='topic+power.mhz'></span>

<h3>Description</h3>

<p>Empirical power calculation using the Henze-Zirkler Test Statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.mhz(a, n, p, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.mhz_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.mhz_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.mhz_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.mhz_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.mhz_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.mhz_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.mhz(a = 0.05, n = 50, p = 2,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.msk'>Power Calculation using the Bowman and Shenton Test Statistic</h2><span id='topic+power.msk'></span>

<h3>Description</h3>

<p>Empirical power calculation using Bowman and Shenton Test Statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.msk(a, n, p, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.msk_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.msk_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.msk_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.msk_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.msk_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.msk_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Bowman, K. O., &amp; Shenton, L. R. (1975). Omnibus test contours for departures from normality based on <code class="reqn">\sqrt b_1</code> and <code class="reqn">b_2</code>. <em>Biometrika</em>, 62(2), 243-250.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.msk(a = 0.05, n = 50, p = 2,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.mswR'>Power Calculation using the SWT-based Royston Test Statistic</h2><span id='topic+power.mswR'></span>

<h3>Description</h3>

<p>Empirical power calculation using Royston test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.mswR(a, n, p, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.mswR_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.mswR_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.mswR_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.mswR_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.mswR_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.mswR_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Royston, J. P. (1982). An extension of Shapiro and Wilk's W test for normality to large samples. <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, 31(2), 115-124.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.mswR(a = 0.05, n = 50, p = 2,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.mswV'>Power Calculation using the SWT-based Villasenor-Alva and Gonzalez-Estrada (VAGE) Test Statistic</h2><span id='topic+power.mswV'></span>

<h3>Description</h3>

<p>Empirical power calculation using VAGE test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.mswV(a, n, p, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.mswV_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.mswV_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.mswV_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.mswV_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.mswV_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.mswV_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Villasenor Alva, J. A., &amp; Estrada, E. G. (2009). A generalization of Shapiro–Wilk's test for multivariate normality. <em>Communications in Statistics—Theory and Methods</em>, 38(11), 1870-1883.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.mswV(a = 0.05, n = 50, p = 2,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.mvnTest'>Power Calculation using the Zhou-Shao's Multivariate Normality Test Statistic (<code class="reqn">T_n</code>)</h2><span id='topic+power.mvnTest'></span>

<h3>Description</h3>

<p>Empirical power calculation using the Zhou-Shao's multivariate normality test Statistic <code class="reqn">T_n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.mvnTest(a, n, p, B = 1000, pct = c(0.01, 0.99), FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.mvnTest_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_p">p</code></td>
<td>
<p>number of columns (variables), <code class="reqn">n&gt;p</code>.</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_pct">pct</code></td>
<td>
<p>percentiles of MK to get c1 and c2 described in the reference paper,default is (0.01, 0.99).</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.mvnTest_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Zhou, M., &amp; Shao, Y. (2014). A powerful test for multivariate normality. <em>Journal of applied statistics</em>, 41(2), 351-363.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against bivariate (p=2) independent Beta(1, 1) distribution ##
## at sample size n=50 for Tn at one-sided alpha = 0.05 ##

power.mvnTest(a = 0.05, n = 50, p = 2,  B = 100, pct = c(0.01, 0.99), FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='power.usw'>Power Calculation using the Univariate Shapiro-Wilk Test Statistic</h2><span id='topic+power.usw'></span>

<h3>Description</h3>

<p>Empirical power calculation using univariate Shapiro-Wilk test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.usw(a, n, p = 1, B = 1000, FUN, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="power.usw_+3A_a">a</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>).</p>
</td></tr>
<tr><td><code id="power.usw_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="power.usw_+3A_p">p</code></td>
<td>
<p>p=1 for univariate.</p>
</td></tr>
<tr><td><code id="power.usw_+3A_b">B</code></td>
<td>
<p>number of Monte Carlo simulations, default is 1000 (can increase B to increase the precision).</p>
</td></tr>
<tr><td><code id="power.usw_+3A_fun">FUN</code></td>
<td>
<p>self-defined function for generate multivariate distribution. See example.</p>
</td></tr>
<tr><td><code id="power.usw_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>FUN</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric value of the estimated empirical power (value between 0 and 1).
</p>


<h3>References</h3>

<p>Shapiro, S. S., &amp; Wilk, M. B. (1965). An analysis of variance test for normality (complete samples). <em>Biometrika</em>, 52(3/4), 591-611.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Power calculation against univariate (p=1) independent Beta(1, 1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

power.usw(a = 0.05, n = 50, p = 1,  B = 100, FUN=IMMV, D1=runif)

</code></pre>

<hr>
<h2 id='PSII'>Random Generation for the Spherically Symmetric Pearson Type II Distribution</h2><span id='topic+PSII'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for the spherically symmetric Pearson type II distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSII(n, p, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PSII_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="PSII_+3A_p">p</code></td>
<td>
<p>number of columns (variables).</p>
</td></tr>
<tr><td><code id="PSII_+3A_s">s</code></td>
<td>
<p>shape parameter, <code class="reqn">s&gt;-1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample matrix.
</p>


<h3>References</h3>

<p>Kotz, S. (1975). Multivariate distributions at a cross road. In A Modern Course on Statistical Distributions in Scientific Work (pp. 247-270). Springer, Dordrecht.
</p>
<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from PSII(s=1) ##
PSII(n=5, p=2, s=1)


## Power calculation against bivariate (p=2) PSII(s=1) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a = 0.05, n = 50, p = 2,  B = 100, FUN = PSII, s = 1)

</code></pre>

<hr>
<h2 id='PSVII'>Random Generation for the Spherically Symmetric Pearson Type VII Distribution</h2><span id='topic+PSVII'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for the spherically symmetric Pearson type VII distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSVII(n, p, s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PSVII_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="PSVII_+3A_p">p</code></td>
<td>
<p>number of columns (variables).</p>
</td></tr>
<tr><td><code id="PSVII_+3A_s">s</code></td>
<td>
<p>shape parameter, <code class="reqn">s &gt; p/2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample matrix.
</p>


<h3>References</h3>

<p>Kotz, S. (1975). Multivariate distributions at a cross road. In A Modern Course on Statistical Distributions in Scientific Work (pp. 247-270). Springer, Dordrecht.
</p>
<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from PSVII(s=3) ##
PSVII(n=5, p=2, s=3)


## Power calculation against bivariate (p=2) PSVII(s=3) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a = 0.05, n = 50, p = 2,  B = 100, FUN = PSVII, s = 3)

</code></pre>

<hr>
<h2 id='SPH'>Random Generation for General Spherically Symmetric Distributions</h2><span id='topic+SPH'></span>

<h3>Description</h3>

<p>Generate univariate or multivariate random sample for general spherically symmetric distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPH(n, p, D, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SPH_+3A_n">n</code></td>
<td>
<p>number of rows (observations).</p>
</td></tr>
<tr><td><code id="SPH_+3A_p">p</code></td>
<td>
<p>number of columns (variables).</p>
</td></tr>
<tr><td><code id="SPH_+3A_d">D</code></td>
<td>
<p>random generation functions for some distributions (e.g., <code>rgamma</code>, <code>rbeta</code>).</p>
</td></tr>
<tr><td><code id="SPH_+3A_...">...</code></td>
<td>
<p>optional arguments passed to <code>D</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns univariate (<code class="reqn">p=1</code>) or multivariate (<code class="reqn">p&gt;1</code>) random sample matrix.
</p>


<h3>References</h3>

<p>Chmielewski, M. A. (1981). Elliptically symmetric distributions: A review and bibliography. <em>International Statistical Review/Revue Internationale de Statistique</em>, 67-74.
</p>
<p>Henze, N., &amp; Zirkler, B. (1990). A class of invariant consistent tests for multivariate normality. <em>Communications in statistics-Theory and Methods</em>, 19(10), 3595-3617.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)

## Generate 5X2 random sample matrix from SPH(Beta(1,1)) ##
SPH(n=5, p=2, D=rbeta, shape1=1, shape2=1)


## Power calculation against bivariate (p=2) SPH(Beta(1,1)) distribution ##
## at sample size n=50 at one-sided alpha = 0.05 ##

# Zhou-Shao's test #
power.mvnTest(a=0.05, n=50, p=2, B=100, FUN=SPH, D=rbeta, shape1=1, shape2=1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
