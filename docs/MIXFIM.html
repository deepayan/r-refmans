<!DOCTYPE html><html><head><title>Help for package MIXFIM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MIXFIM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fisher_evaluation'><p>Evaluation of the Fisher Information Matrix in Nonlinear Mixed Effect Models using Markov Chains Monte Carlo</p></a></li>
<li><a href='#fisher_optimization'><p>Optimization of the sampling times (or doses) in Nonlinear Mixed Effect Models using Markov Chains Monte Carlo</p></a></li>
<li><a href='#MIXFIM-package'>
<p>Evaluation of the FIM in NLMEMs using MCMC</p></a></li>
<li><a href='#template_model'><p>Creation of a Pre-Filled Template for STAN Model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluation of the FIM in NLMEMs using MCMC</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-11-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie-Karelle Riviere-Jourdan and France Mentre &lt;france.mentre@inserm.fr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marie-Karelle Riviere-Jourdan &lt;eldamjh@gmail.com&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>All files are copyright Institut National de la Sante Et de
la Recherche Medicale.</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluation and optimization of the Fisher Information Matrix in NonLinear Mixed Effect Models using Markov Chains Monte Carlo for continuous and discrete data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), rstan (&ge; 2.7.0-1), mvtnorm (&ge; 1.0-2), ggplot2
(&ge; 1.0.1)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-11-16 13:08:11 UTC; I0273717</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-11-16 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fisher_evaluation'>Evaluation of the Fisher Information Matrix in Nonlinear Mixed Effect Models using Markov Chains Monte Carlo</h2><span id='topic+fisher_evaluation'></span>

<h3>Description</h3>

<p><code>fisher_evaluation</code> is used to evaluate the Fisher information matrix for both continuous and discrete data in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher_evaluation(t, y_ini=1, model, model2, model3, params, dim_b, 
set_seed=TRUE, seed=42, n_samp, n_rep=1, n_iter, n_burn, CV=FALSE, 
plot_graph=0, L_boot=1000, nb_patients=1)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="fisher_evaluation_+3A_t">t</code></td>
<td>
<p>Vector of sampling times (or doses).</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_y_ini">y_ini</code></td>
<td>
<p>A possible value for the response y to initialize the MCMC process. The default value is set at 1 (which works for many types of outcomes: continuous, binary, ...).</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_model">model</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the conditionnal distribution of b given y.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_model2">model2</code></td>
<td>
<p>Compiled STAN model describing the response model for calculating the derivative of the log-likelihood with respoect to each parameter.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_model3">model3</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the marginal distribution of the response y.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_params">params</code></td>
<td>
<p>Vector of parameters given as follows: fixed effetcs, variances of the random effets, standard deviations of the residual errors (if continuous data). </p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_dim_b">dim_b</code></td>
<td>
<p>Number of random effects.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_set_seed">set_seed</code></td>
<td>
<p>Boolean indicating if the seed shoud be fixed. The default value is set at TRUE.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_seed">seed</code></td>
<td>
<p>Integer for the fixed seed. Used only if <code>set_seed</code> is TRUE. The default value is set at 42.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_n_samp">n_samp</code></td>
<td>
<p>Integer representing the number of Monte Carlo (MC) samples, (i.e. number of samples for the outcome y).</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_n_rep">n_rep</code></td>
<td>
<p>Integer representing the number of repeated measures at the same time (or dose) for each patient. The default value is set at 1 (for continuous data).</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_n_iter">n_iter</code></td>
<td>
<p>Integer representing the number of Markov Chains Monte Carlo (MCMC) samples.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_n_burn">n_burn</code></td>
<td>
<p>Integer representing the number of burn-in samples for MCMC. </p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_cv">CV</code></td>
<td>
<p>Boolean indicating if some convergence information (variance of the determinant, mean of b, mean log-likelihood, ...) should be returned. The default value is set at FALSE.</p>
</td></tr> 
<tr><td><code id="fisher_evaluation_+3A_plot_graph">plot_graph</code></td>
<td>
<p>An integer with value 0 (no graph should be plotted), 1 (graph of the determinant of the FIM), 2 (graph of the determinant of the FIM with confidence intervals assuming normal distribution), 3 (graph of the determinant of the FIM with bootstrap confidence intervals) or 4 (graph of the determinant of the FIM with both bootstrap confidence intervals and confidence intervals assuming normal distribution). The default value is set at 0.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_l_boot">L_boot</code></td>
<td>
<p>Number of samples for bootstrap estimation of the confidence intervals of the normalized determinant of the FIM. This argument is used/required only if plot_graph = 3 or 4. The default value is set at 1000.</p>
</td></tr>
<tr><td><code id="fisher_evaluation_+3A_nb_patients">nb_patients</code></td>
<td>
<p>Number of patients with the same elementary design for which the FIM is evaluated. The default value is set at 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An list is returned, composed of the following variables: 
</p>
<table>
<tr><td><code>FIM</code></td>
<td>
<p>Expected Fisher information matrix (FIM). Of note, the FIM is an individual FIM and is calculated for <code>nb_patients</code> patients.</p>
</td></tr>
<tr><td><code>FIM_covar</code></td>
<td>
<p>Variance-covariance matrix of the FIM. (Of note, its dimension is of size 4 as the FIM is in dimension 2.)</p>
</td></tr>
<tr><td><code>inv_FIM</code></td>
<td>
<p>Inverse of the FIM.</p>
</td></tr>
<tr><td><code>RSE</code></td>
<td>
<p>Relative standard errors (square root of the diagonal elements of the inverse of the FIM).</p>
</td></tr>
<tr><td><code>RSE_inf_boot</code></td>
<td>
<p>Vector containing the lower bound of the bootstrap confidence interval of the RSEs.</p>
</td></tr>
<tr><td><code>RSE_sup_boot</code></td>
<td>
<p>Vector containing the upper bound of the bootstrap confidence interval of the RSEs.</p>
</td></tr>
<tr><td><code>det_norm_FIM</code></td>
<td>
<p>Normalized determinant of the FIM.</p>
</td></tr>
<tr><td><code>det_IC_normal</code></td>
<td>
<p>Vector containing the lower and upper bound of the confidence interval of the normalized determinant of the FIM assuming normal distribution.</p>
</td></tr>
<tr><td><code>det_IC_boot</code></td>
<td>
<p>Vector containing the lower and upper bound of the bootstrap confidence interval of the normalized determinant of the FIM.</p>
</td></tr>
</table>
<p>If CV=TRUE: 
</p>
<table>
<tr><td><code>mean_dloglik1</code></td>
<td>
<p>Mean of the partial derivatives of the log-likelihood according to the first MCMC sample and MC sample. Should be equal approximately to 0.</p>
</td></tr> 
<tr><td><code>mean_dloglik2</code></td>
<td>
<p>Mean of the partial derivatives of the log-likelihood according to the second MCMC sample and MC sample. Should be equal approximately to 0.</p>
</td></tr>
<tr><td><code>var_dloglik1</code></td>
<td>
<p>Variance of the partial derivatives of the log-likelihood according to the first MCMC sample and MC sample.</p>
</td></tr> 
<tr><td><code>var_dloglik2</code></td>
<td>
<p>Variance of the partial derivatives of the log-likelihood according to the second MCMC sample and MC sample.</p>
</td></tr>
<tr><td><code>mean_b</code></td>
<td>
<p>Mean of the samples in the conditionnal distribution of b given y. Should be equal approximately to 0.</p>
</td></tr> 
<tr><td><code>mat_A_k1</code></td>
<td>
<p>Vector containing for each value sampled of the response y, the estimation of the integral of the partial derivatives of the log-likelihood over the random effects according to the first MCMC sample of the random effects b given y.</p>
</td></tr>
<tr><td><code>mat_A_k2</code></td>
<td>
<p>Vector containing for each value sampled of the response y, the estimation of the integral of the partial derivatives of the log-likelihood over the random effects according to the second MCMC sample of the random effects b given y.</p>
</td></tr>
</table>
<p>In addition, <code>plot_graph</code> enables to plot a graph of the normalized determinant of the FIM with normal and bootstrap confidence intervals in function of the number of MC samples.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Riviere, M-K., Ueckert, S. and Mentre, F,. Evaluation of the Fisher information matrix in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
############################
# PLEASE UNCOMMENT EXAMPLE #
############################
#times = c(0.5,1,2,6,24,36,72,120)
#params = c(1,8,0.15,0.6,0.02,0.07,0.1)

# Files cen be found in external data
#model = stan_model("model_b_given_y.stan")
#model2 = stan_model("model_derivatives.stan")
#model3 = stan_model("model_y.stan")

#model_Warfarin = fisher_evaluation(t=times, y_ini=0.5, model=model, 
#model2=model2, model3=model3, params=params, dim_b=3, set_seed=TRUE, seed=42, 
#n_samp=1000, n_rep=1, n_iter=200, n_burn=500, CV=TRUE, plot_graph=4, 
#nb_patients=32)
#model_Warfarin
</code></pre>

<hr>
<h2 id='fisher_optimization'>Optimization of the sampling times (or doses) in Nonlinear Mixed Effect Models using Markov Chains Monte Carlo</h2><span id='topic+fisher_optimization'></span>

<h3>Description</h3>

<p><code>fisher_optimization</code> is used to optimize the sampling times (or doses), through maximization of the determinant of the Fisher Information Matrix, for both continuous and discrete data in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher_optimization(nb_t, set_t, y_ini, model, model2, model3, params, dim_b, 
set_seed=TRUE, seed=42, step_mc, n_samp_min=30, n_samp_max, n_rep=1, n_iter, 
n_burn, L_boot=1000, plot_graph=TRUE, nb_patients=1, det_graph=FALSE)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="fisher_optimization_+3A_nb_t">nb_t</code></td>
<td>
<p>Number of sampling times (or doses) to select.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_set_t">set_t</code></td>
<td>
<p>A vector containing the set of possible sampling times in which to select the <code>nb_t</code> optimal ones.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_y_ini">y_ini</code></td>
<td>
<p>A possible value for the response y to initialize the MCMC process.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_model">model</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the conditionnal distribution of b given y.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_model2">model2</code></td>
<td>
<p>Compiled STAN model describing the response model for calculating the derivative of the log-likelihood with respoect to each parameter.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_model3">model3</code></td>
<td>
<p>Compiled STAN model describing the response model to sample in the marginal distribution of the response y.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_params">params</code></td>
<td>
<p>Vector of parameters given as follows: fixed effetcs, variances of the random effets, standard deviations of the residual errors (if continuous data). </p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_dim_b">dim_b</code></td>
<td>
<p>Number of random effects.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_set_seed">set_seed</code></td>
<td>
<p>Boolean indicating if the seed shoud be fixed. The default value is set at TRUE.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_seed">seed</code></td>
<td>
<p>Integer for the fixed seed. Used only if <code>set_seed</code> is TRUE. The default value is set at 42.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_step_mc">step_mc</code></td>
<td>
<p>Number of Monte Carlo (MC) samples after which the remaining combinations of sampling times are re-evaluated for optimum determination.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_n_samp_min">n_samp_min</code></td>
<td>
<p>Integer representing the minimum number of MC samples to perform at the first step to evaluate all combinations of sampling times (or doses).</p>
</td></tr> 
<tr><td><code id="fisher_optimization_+3A_n_samp_max">n_samp_max</code></td>
<td>
<p>Integer representing the maximum number of MC samples to perform (for one combination of sampling times). Either the algorithm will stop for finding a unique combination of optimal sampling times before reaching <code>n_samp_max</code> or for reaching it. In the second case, the sampling times corresponding to the highest determinant of the FIM will be selected as the optimum.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_n_rep">n_rep</code></td>
<td>
<p>Integer representing the number of repeated measures at the same time (or dose) for each patient. The default value is set at 1 (for continuous data).</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_n_iter">n_iter</code></td>
<td>
<p>Integer representing the number of Markov Chains Monte Carlo (MCMC) samples.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_n_burn">n_burn</code></td>
<td>
<p>Integer representing the number of burn-in samples for MCMC.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_l_boot">L_boot</code></td>
<td>
<p>Number of samples for bootstrap estimation of the confidence intervals of the determinant of the FIM. The default value is set at 1000.</p>
</td></tr> 
<tr><td><code id="fisher_optimization_+3A_plot_graph">plot_graph</code></td>
<td>
<p>A boolean indicating if at each step (every <code>step_mc</code>), a graph with the determinant of the FIM and its bootstrap confidence intervals for the remaining combinations of sampling times should be plotted and saved. The default value is set at TRUE.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_nb_patients">nb_patients</code></td>
<td>
<p>Number of patients with the same elementary design for which the FIM and its determinant are evaluated. The default value is set at 1.</p>
</td></tr>
<tr><td><code id="fisher_optimization_+3A_det_graph">det_graph</code></td>
<td>
<p>A boolean indicating if the normalized determinant of the FIM for the selected optimal design should be plotted in function of the number of MC samples. The default value is set at FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm will first test all combinations of <code>nb_t</code> sampling times (or doses) in <code>ens_t</code> on at least <code>n_samp_min</code> MC samples. Then and after each step (every <code>step_mc</code>), only combinations of sampling times for which the upper bound of the bootstrap confidence interval is above the maximum estimated determinant of the FIM will be selected for the next step. The algorithm will stop either for finding a unique combination of optimal sampling times before reaching <code>n_samp_max</code> or for reaching it. In the second case, the combination of sampling times corresponding to the highest determinant of the FIM will be selected as the optimum. However, in this case the graph (<code>plot_graph</code>=TRUE) could help to distinguish the remaining combinations of sampling times.
</p>


<h3>Value</h3>

<p>An list is returned, composed of the following variables: 
</p>
<table>
<tr><td><code>opt_t</code></td>
<td>
<p>Optimal protocol, i.e. sampling times (or doses).</p>
</td></tr>
<tr><td><code>FIM_opt_t</code></td>
<td>
<p>Expected Fisher information matrix (FIM) for the optimal protocol. Of note, the FIM is an individual FIM and is calculated for <code>nb_patients</code> patients.</p>
</td></tr> 
<tr><td><code>FIM_covar_opt_t</code></td>
<td>
<p>Variance-covariance matrix of the FIM for the optimal protocol. (Of note, its dimension is of size 4 as the FIM is in dimension 2.)</p>
</td></tr>
<tr><td><code>inv_FIM_opt_t</code></td>
<td>
<p>Inverse of the FIM for the optimal protocol.</p>
</td></tr>
<tr><td><code>RSE_opt_t</code></td>
<td>
<p>Relative standard errors for the optimal protocol (square root of the diagonal elements of the inverse of the FIM).</p>
</td></tr> 
<tr><td><code>RSE_inf_boot_opt_t</code></td>
<td>
<p>Vector containing the lower bound of the bootstrap confidence interval of the RSEs for the optimal protocol.</p>
</td></tr> 
<tr><td><code>RSE_sup_boot_opt_t</code></td>
<td>
<p>Vector containing the upper bound of the bootstrap confidence interval of the RSEs for the optimal protocol.</p>
</td></tr>
<tr><td><code>det_norm_FIM_opt_t</code></td>
<td>
<p>Normalized determinant of the FIM for the optimal protocol.</p>
</td></tr> 
<tr><td><code>IC_normal_opt_t</code></td>
<td>
<p>Vector containing the lower and upper bound of the confidence interval of the normalized determinant of the FIM assuming normal distribution for the optimal protocol.</p>
</td></tr>
<tr><td><code>IC_boot_opt_t</code></td>
<td>
<p>Vector containing the lower and upper bound of the bootstrap confidence interval of the normalized determinant of the FIM for the optimal protocol.</p>
</td></tr>
<tr><td><code>list_select</code></td>
<td>
<p>A list containing at each step the combinations of sampling times selected.</p>
</td></tr>
<tr><td><code>list_det</code></td>
<td>
<p>A list containing at each step the determinant of the FIM for each combination of sampling times selected.</p>
</td></tr>
<tr><td><code>list_boot_inf</code></td>
<td>
<p>A list containing at each step the lower bound of the bootstrap confidence interval of determinant of the FIM for each combination of sampling times selected.</p>
</td></tr>
<tr><td><code>list_boot_sup</code></td>
<td>
<p>A list containing at each step the upper bound of the bootstrap confidence interval of determinant of the FIM for each combination of sampling times selected.</p>
</td></tr> 
<tr><td><code>list_fim</code></td>
<td>
<p>A list containing at each step the FIM for each combination of sampling times selected.</p>
</td></tr>
</table>
<p>In addition, for the optimal protocol selected at the end, a graph of the normalized determinant of the FIM with normal and bootstrap confidence intervals in function of the number of MC samples is plotted.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
############################
# PLEASE UNCOMMENT EXAMPLE #
############################
#params = c(1,8,0.15,0.6,0.02,0.07,0.1)
#times_poss = c(0.1,0.5,1,2,3,6,12,24,36,48,72,120,240)

# Files can be found in external data
#model = stan_model("model_b_given_y.stan")
#model2 = stan_model("model_derivatives.stan")
#model3 = stan_model("model_y.stan")

#opt1 = fisher_optimization(nb_t=3, set_t=times_poss, y_ini=0.5, model=model, 
#model2=model2, model3=model3, params=params, dim_b=3, set_seed=TRUE, seed=42, 
#step_mc=100, n_samp_min=30, n_samp_max=2000, n_rep=1, n_iter=500, n_burn=500,
#nb_patients=32)
#opt1
</code></pre>

<hr>
<h2 id='MIXFIM-package'>
Evaluation of the FIM in NLMEMs using MCMC
</h2><span id='topic+MIXFIM-package'></span><span id='topic+MIXFIM'></span>

<h3>Description</h3>

<p>Evaluation and optimization of the Fisher Information Matrix in NonLinear Mixed Effect Models using Markov Chains Monte Carlo for continuous and discrete data. <br />
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MIXFIM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-11-16</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan &lt;eldamjh@gmail.com&gt; and France Mentre &lt;france.mentre@inserm.fr&gt;
</p>


<h3>References</h3>

<p>Riviere, M-K., Ueckert, S. and Mentre, F,. Evaluation of the Fisher information matrix in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>

<hr>
<h2 id='template_model'>Creation of a Pre-Filled Template for STAN Model.</h2><span id='topic+template_model'></span>

<h3>Description</h3>

<p><code>template_model</code> is used to create a pre-filled template for the STAN models used in <code>fisher_evaluation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>template_model(path=getwd(), dloglik, nb_t, outcome, nb_params, ind_RE, 
Cov_list=list(), Sigma_b=FALSE, n_rep=1, name)
</code></pre>


<h3>Arguments</h3>

                
<table>
<tr><td><code id="template_model_+3A_path">path</code></td>
<td>
<p>[Optional] String containing the path where the text file with the model should be created.</p>
</td></tr>
<tr><td><code id="template_model_+3A_dloglik">dloglik</code></td>
<td>
<p>Boolean indicating if the model is used to calculate the partial derivatives of the log-likelihood (TRUE), or if the model is used to sample in the condtional distribution of b given y (FALSE).</p>
</td></tr>
<tr><td><code id="template_model_+3A_nb_t">nb_t</code></td>
<td>
<p>Number of sampling times (or doses).</p>
</td></tr>
<tr><td><code id="template_model_+3A_outcome">outcome</code></td>
<td>
<p>String indicating the type of outcome. For now, &quot;continuous&quot;, &quot;binary&quot;, &quot;longitudinal_binary&quot;, &quot;count&quot; and &quot;time_to_event&quot; are available.</p>
</td></tr>
<tr><td><code id="template_model_+3A_nb_params">nb_params</code></td>
<td>
<p>Number of parameters.</p>
</td></tr>
<tr><td><code id="template_model_+3A_ind_re">ind_RE</code></td>
<td>
<p>Indices for the variance of the random effects in the vector of parameters. It is assumed that the vector of parameters is filled as follows: fixed effetcs, variances of the random effets, standard deviations of the residual errors (if <code>outcome</code> is &quot;continuous&quot;).</p>
</td></tr>
<tr><td><code id="template_model_+3A_cov_list">Cov_list</code></td>
<td>
<p>[Optional] A list of vectors to specify covariances between random effets. Each element of the list must contain a vector with: the row position, the column position and the value of the covariance in the variance-covariance matrix for the random effects.</p>
</td></tr>
<tr><td><code id="template_model_+3A_sigma_b">Sigma_b</code></td>
<td>
<p>Boolean indicating if the residual errors matrix depends on the random effetcs b. The default value is set at FALSE.</p>
</td></tr>
<tr><td><code id="template_model_+3A_n_rep">n_rep</code></td>
<td>
<p>Integer representing the number of repeated measures at the same time (or dose) for each patient. The default value is set at 1 (for &quot;continuous&quot; outcome).</p>
</td></tr>
<tr><td><code id="template_model_+3A_name">name</code></td>
<td>
<p>String to name the output text file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Create a text file containing a pre-filled template for the STAN models used in <code>fisher_evaluation</code> in the chosen directory.
</p>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Riviere, M-K., Ueckert, S. and Mentre, F,. Evaluation of the Fisher information matrix in nonlinear mixed effect models using Markov Chains Monte Carlo.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># UNCOMMENT EXAMPLES
#test2 = template_model(dloglik=TRUE, nb_t=13, outcome="binary", 
#nb_params=3, ind_RE=c(3), n_rep=1, name="test2")

#test3 = template_model(dloglik=TRUE, nb_t=8, outcome="continuous", 
#nb_params=13, ind_RE=c(5,6,7,8), Cov_list =
#list(c(1,2,0.06),c(2,1,0.06),c(1,3,0.04)), Sigma_fun_b=FALSE, name="test3")

#test4 = template_model( dloglik=FALSE, nb_t=4, outcome="count", 
#nb_params=4, ind_RE=c(3,4), n_rep=30, name="test4")

#test5 = template_model(dloglik=FALSE, nb_t=0, 
#outcome="time_to_event", nb_params=2, ind_RE=c(2), n_rep=10, name="test5")

#test6 = template_model(dloglik=FALSE, nb_t=4, outcome="continuous", 
#nb_params=4, ind_RE=c(3), Sigma_fun_b=FALSE, name="test6")

#test = template_model(dloglik=FALSE, nb_t=7, outcome="continuous", 
#nb_params=7, ind_RE=c(4,5,6), Sigma_fun_b=TRUE, n_rep=1, name="test_pk")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
