<!DOCTYPE html><html><head><title>Help for package PSinference</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PSinference}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#canodist'><p>Canonical Empirical Distribution</p></a></li>
<li><a href='#GVdist'><p>Generalized Variance Empirical Distribution</p></a></li>
<li><a href='#Inddist'><p>Independence Empirical Distribution</p></a></li>
<li><a href='#partition'><p>Split a matrix into blocks</p></a></li>
<li><a href='#simSynthData'><p>Plug-in Sampling Single Synthetic Dataset Generation</p></a></li>
<li><a href='#Sphdist'><p>Spherical Empirical Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inference for Released Plug-in Sampling Single Synthetic Dataset</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ricardo Moura &lt;rp.moura@fct.unl.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Considering the singly imputed synthetic data generated via plug-in sampling under the multivariate normal model, draws inference procedures including the generalized variance, the sphericity test, the test for independence between two subsets of variables, and the test for the regression of one set of variables on the other. For more details see Klein et al. (2021) &lt;<a href="https://doi.org/10.1007%2Fs13571-019-00215-9">doi:10.1007/s13571-019-00215-9</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ricardomourarpm/PSinference">https://github.com/ricardomourarpm/PSinference</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-18 09:34:47 UTC; ricar</td>
</tr>
<tr>
<td>Author:</td>
<td>Ricardo Moura <a href="https://orcid.org/0000-0002-3003-9235"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Mina Norouzirad <a href="https://orcid.org/0000-0003-0311-6888"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Danial Mazarei <a href="https://orcid.org/0000-0002-3633-9298"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  FCT, I.P. [fnd] (under the scope of the projects UIDB/00297/2020 and
    UIDP/00297/2020 (NovaMath))</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-19 11:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='canodist'>Canonical Empirical Distribution</h2><span id='topic+canodist'></span>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform inferential procedures for the regression of one subset of variables on the other based on the
released Single Synthetic data generated under Plug-in Sampling, assuming
that the original dataset is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>canodist(part, nsample, pvariates, iterations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="canodist_+3A_part">part</code></td>
<td>
<p>Number of partitions.</p>
</td></tr>
<tr><td><code id="canodist_+3A_nsample">nsample</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="canodist_+3A_pvariates">pvariates</code></td>
<td>
<p>Number of variables.</p>
</td></tr>
<tr><td><code id="canodist_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for simulating values from the distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_4^\star|\boldsymbol{\Delta} =
\frac{(|\boldsymbol{S}^{\star}_{12}
(\boldsymbol{S}^{\star}_{22})^{-1}-\boldsymbol{\Delta})
\boldsymbol{S}^{\star}_{22}(\boldsymbol{S}^{\star}_{12})
(\boldsymbol{S}^{\star}_{22})^{-1}-\boldsymbol{\Delta})^\top|}
{|\boldsymbol{S}^{\star}_{11.2}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>,
<code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset,
considering <code class="reqn">\boldsymbol{S}^\star</code> partitioned as
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{S}^{\star}=\left[\begin{array}{lll}
\boldsymbol{S}^{\star}_{11}&amp; \boldsymbol{S}^{\star}_{12}\\
\boldsymbol{S}^{\star}_{21} &amp; \boldsymbol{S}^{\star}_{22}
\end{array}\right].</code>
</p>

<p>For <code class="reqn">\Delta = \boldsymbol{\Sigma}_{12}\boldsymbol{\Sigma}_{22}^{-1}</code>,
where <code class="reqn">\boldsymbol{\Sigma}</code> is partitioned the same way as <code class="reqn">\boldsymbol{S}^{\star}</code>
its distribution is stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn">\frac{|\boldsymbol{\Omega}_{12}\boldsymbol{\Omega}_{22}^{-1}
\boldsymbol{\Omega}_{21}|}{|\boldsymbol{\Omega}_{11}-\boldsymbol{\Omega}_{12}
\boldsymbol{\Omega}_{22}^{-1}\boldsymbol{\Omega}_{21}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{\Omega} \sim \mathcal{W}_p(n-1, \frac{\boldsymbol{W}}{n-1})</code>,
<code class="reqn">\boldsymbol{W} \sim \mathcal{W}_p(n-1, \mathbf{I}_p)</code> and
<code class="reqn">\boldsymbol{\Omega}</code> partitioned in the same way as
<code class="reqn">\boldsymbol{S}^{\star}</code>.
To test <code class="reqn">\mathcal{H}_0: \boldsymbol{\Delta} =\boldsymbol{\Delta}_0</code>, compute the value
of <code class="reqn">T_{4}^\star</code>, <code class="reqn">\widetilde{T_{4}^\star}</code>,  with the observed
values and reject the null hypothesis if
<code class="reqn">\widetilde{T_{4}^\star}&gt;t^\star_{4,1-\alpha}</code> for
<code class="reqn">\alpha</code>-significance level, where <code class="reqn">t^\star_{4,\gamma}</code> is the
<code class="reqn">\gamma</code>th percentile of <code class="reqn">T_4^\star</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate original data
library(MASS)
n_sample = 100
p = 4
mu &lt;- c(1,2,3,4)
Sigma = matrix(c(1,   0.5, 0.1, 0.7,
                 0.5,   2, 0.4, 0.9,
                 0.1, 0.4,   3, 0.2,
                 0.7, 0.9, 0.2,   4), nr = 4, nc = 4, byrow = TRUE)

df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)
# generate synthetic data
df_s = simSynthData(df)
#Decompose Sigma and Sstar
part = 2
Sigma_12 = partition(Sigma,nrows = part, ncol = part)[[2]]
Sigma_22 = partition(Sigma,nrows = part, ncol = part)[[4]]
Delta0 = Sigma_12 %*% solve(Sigma_22)

Sstar = cov(df_s)
Sstar_11 = partition(Sstar,nrows = part, ncol = part)[[1]]
Sstar_12 = partition(Sstar,nrows = part, ncol = part)[[2]]
Sstar_21 = partition(Sstar,nrows = part, ncol = part)[[3]]
Sstar_22 = partition(Sstar,nrows = part, ncol = part)[[4]]


DeltaEst = Sstar_12 %*% solve(Sstar_22)
Sstar11_2 = Sstar_11 - Sstar_12 %*% solve(Sstar_22) %*% Sstar_21


T4_obs = det((DeltaEst-Delta0)%*%Sstar_22%*%t(DeltaEst-Delta0))/det(Sstar11_2)

T4 &lt;- canodist(part = part, nsample = n_sample, pvariates = p, iterations = 10000)
q95 &lt;- quantile(T4, 0.95)

T4_obs &gt; q95 #False means that we don't have statistical evidences to reject Delta0
print(T4_obs)
print(q95)
# When the observed value is smaller than the 95% quantile,
# we don't have statistical evidences to reject the Sphericity property.
#
# Note that the value is very close to zero
</code></pre>

<hr>
<h2 id='GVdist'>Generalized Variance Empirical Distribution</h2><span id='topic+GVdist'></span>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform inferential procedures
for the Generalized Variance of the released Single Synthetic dataset
generated under Plug-in Sampling, assuming that the original distribution
is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GVdist(nsample, pvariates, iterations = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GVdist_+3A_nsample">nsample</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="GVdist_+3A_pvariates">pvariates</code></td>
<td>
<p>Number of variables.</p>
</td></tr>
<tr><td><code id="GVdist_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for simulating values from the distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_1^\star = (n-1)\frac{|\boldsymbol{S}^*|}{|\boldsymbol{\Sigma}|},</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>, <code class="reqn">\boldsymbol{\Sigma}</code> is the population covariance matrix
and <code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset.
Its distribution is stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn"> \prod_{i=1}^n \chi_{n-i}^2 \prod_{i=1}^p \chi_{n-i}^2</code>
</p>

<p>where <code class="reqn">\chi_{n-i}^2</code> are all independent chi-square random variables.
The <code class="reqn">(1-\alpha)</code> level confidence interval for <code class="reqn">|\boldsymbol{\Sigma}|</code>
is given by
</p>
<p style="text-align: center;"><code class="reqn">\left(\frac{(n-1)^p|\tilde{\boldsymbol{S}}^\star|}{t^\star_{1,1-\alpha/2}},
\frac{(n-1)^p|\tilde{\boldsymbol{S}}^\star|}{t^\star_{1,\alpha/2}} \right)</code>
</p>

<p>where <code class="reqn">\tilde{\boldsymbol{S}}^\star</code> is the observed value of
<code class="reqn">\boldsymbol{S}^\star</code> and <code class="reqn">t^\star_{1,\gamma}</code>
is the <code class="reqn">\gamma</code>th percentile of <code class="reqn">T_1</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Original data creation
library(MASS)
mu &lt;- c(1,2,3,4)
Sigma &lt;- matrix(c(1, 0.5, 0.5, 0.5,
                  0.5, 1, 0.5, 0.5,
                  0.5, 0.5, 1, 0.5,
                  0.5, 0.5, 0.5, 1), nrow = 4, ncol = 4, byrow = TRUE)
seed = 1
n_sample = 100
# Create original simulated dataset
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)

# Synthetic data created

df_s = simSynthData(df)


# Gather the 0.025 and 0.975 quantiles and construct confident interval for sigma^2
# Check that sigma^2 is inside in both cases
p = dim(df_s)[2]

T &lt;- GVdist(100, p, 10000)
q975 &lt;- quantile(T, 0.975)
q025 &lt;- quantile(T, 0.025)

left &lt;- (n_sample-1)^p * det(cov(df_s)*(n_sample-1))/q975
right &lt;- (n_sample-1)^p * det(cov(df_s)*(n_sample-1))/q025

cat(left,right,'\n')
print(det(Sigma))
# The synthetic value is inside the confidence interval of GV

</code></pre>

<hr>
<h2 id='Inddist'>Independence Empirical Distribution</h2><span id='topic+Inddist'></span>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform inferential procedures and
test the independence of two subsets of variables based on the
released Single Synthetic data generated under Plug-in Sampling, assuming
that the original dataset is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Inddist(part, nsample, pvariates, iterations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Inddist_+3A_part">part</code></td>
<td>
<p>Number of partitions.</p>
</td></tr>
<tr><td><code id="Inddist_+3A_nsample">nsample</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="Inddist_+3A_pvariates">pvariates</code></td>
<td>
<p>Number of variables.</p>
</td></tr>
<tr><td><code id="Inddist_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for simulating values from the distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_3^\star =
\frac{|\boldsymbol{S}^{\star}|}
{|\boldsymbol{S}^{\star}_{11}||\boldsymbol{S}^{\star}_{22}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>,
<code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset,
considering <code class="reqn">\boldsymbol{S}^\star</code> partitioned as
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{S}^{\star}=\left[\begin{array}{lll}
\boldsymbol{S}^{\star}_{11}&amp; \boldsymbol{S}^{\star}_{12}\\
\boldsymbol{S}^{\star}_{21} &amp; \boldsymbol{S}^{\star}_{22}
\end{array}\right].</code>
</p>

<p>Under the assumption that <code class="reqn">\boldsymbol{\Sigma}_{12} = \boldsymbol{0}</code>,
its distribution is stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn">\frac{|\boldsymbol{\Omega}|}{|\boldsymbol{\Omega}_{11}||\boldsymbol{\Omega}_{22}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{\Omega} \sim \mathcal{W}_p(n-1, \frac{\boldsymbol{W}}{n-1})</code>,
<code class="reqn">\boldsymbol{W} \sim \mathcal{W}_p(n-1, \mathbf{I}_p)</code> and
<code class="reqn">\boldsymbol{\Omega}</code> partitioned in the same way as
<code class="reqn">\boldsymbol{S}^{\star}</code>.
To test <code class="reqn">\mathcal{H}_0: \boldsymbol{\Sigma}_{12} = \boldsymbol{0}</code>,
compute the value of <code class="reqn">T_{3}^\star</code>, <code class="reqn">\widetilde{T_{3}^\star}</code>,
with the observed values and reject the null hypothesis if
<code class="reqn">\widetilde{T_{3}^\star}&lt;t^\star_{3,\alpha}</code> for
<code class="reqn">\alpha</code>-significance level, where <code class="reqn">t^\star_{3,\gamma}</code> is the
<code class="reqn">\gamma</code>th percentile of <code class="reqn">T_3^\star</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate original data with two independent subsets of variables
library(MASS)
n_sample = 100
p = 4
mu &lt;- c(1,2,3,4)
Sigma = matrix(c(1,   0.5,   0,     0,
                 0.5,   2,   0,     0,
                 0,     0,   3,   0.2,
                 0,     0,   0.2,   4), nr = 4, nc = 4, byrow = TRUE)
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)
# generate synthetic data
df_s = simSynthData(df)

#Decompose Sstar in 4 parts
part = 2

Sstar = cov(df_s)
Sstar_11 = partition(Sstar,nrows = part, ncol = part)[[1]]
Sstar_12 = partition(Sstar,nrows = part, ncol = part)[[2]]
Sstar_21 = partition(Sstar,nrows = part, ncol = part)[[3]]
Sstar_22 = partition(Sstar,nrows = part, ncol = part)[[4]]

#Compute observed T3_star
T3_obs = det(Sstar)/(det(Sstar_11)*det(Sstar_22))

alpha = 0.05

# colect the quantile from the distribution assuming independence between the two subsets
T3 &lt;- Inddist(part = part, nsample = n_sample, pvariates = p, iterations = 10000)
q5 &lt;- quantile(T3, alpha)

T3_obs &lt; q5 #False means that we don't have statistical evidences to reject independence
print(T3_obs)
print(q5)
# Note that the value of the observed T3_obs is close to one as expected
</code></pre>

<hr>
<h2 id='partition'>Split a matrix into blocks</h2><span id='topic+partition'></span>

<h3>Description</h3>

<p>This function Split a matrix into a list of blocks (either by rows and  columns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partition(Matrix, nrows, ncols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partition_+3A_matrix">Matrix</code></td>
<td>
<p>a matrix to split .</p>
</td></tr>
<tr><td><code id="partition_+3A_nrows">nrows</code></td>
<td>
<p>positive integer indicating the number of rows blocks.</p>
</td></tr>
<tr><td><code id="partition_+3A_ncols">ncols</code></td>
<td>
<p>positive integer indicating the number of columns blocks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of partitioned submatrices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df = matrix(c(1,0.5,0,0,
                  0.5,2,0,0,
                  0,0,3,0.2,
                  0, 0, 0.2,4), nr = 4, nc = 4, byrow = TRUE)
partition(df,2,2)
</code></pre>

<hr>
<h2 id='simSynthData'>Plug-in Sampling Single Synthetic Dataset Generation</h2><span id='topic+simSynthData'></span>

<h3>Description</h3>

<p>This function is used to generate a single synthetic version of the original data via Plug-in Sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simSynthData(X, n_imp = dim(X)[1])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simSynthData_+3A_x">X</code></td>
<td>
<p>matrix or dataframe</p>
</td></tr>
<tr><td><code id="simSynthData_+3A_n_imp">n_imp</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume that <code class="reqn">\mathbf{X}=\left(\mathbf{x}_1, \dots, \mathbf{x}_n\right)</code> is the original data, assumed to be normally distributed,
we compute <code class="reqn">\bar{\mathbf{x}}</code> as the sample mean and <code class="reqn">\hat{\boldsymbol{\Sigma}}=\mathbf{S}/(n-1)</code> as the sample covariance matrix,
where <code class="reqn">\mathbf{S}</code> is the sample Wishart matrix.
We generate <code class="reqn">\mathbf{V}=\left(\mathbf{v}_1, \dots, \mathbf{v}_n\right)</code>, by drawing
</p>
<p style="text-align: center;"><code class="reqn">\mathbf{v}_i\stackrel{i.i.d.}{\sim}N_p(\bar{\mathbf{x}},\hat{\boldsymbol{\Sigma}}).</code>
</p>



<h3>Value</h3>

<p>a matrix of generated dataset
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
n_sample = 1000
mu=c(0,0,0,0)
Sigma=diag(1,4,4)
# Create original simulated dataset
df_o = mvrnorm(n_sample, mu, Sigma)
# Create singly imputed synthetic dataset
df_s = simSynthData(df_o)
#Estimators synthetic
mean_s &lt;- colMeans(df_s)
S_s &lt;- (t(df_s)- mean_s) %*% t(t(df_s)- mean_s)
# careful about this computation
# mean_o is a column vector and if you are thinking as n X p matrices and
# row vectors you should be aware of this.
print(mean_s)
print(S_s/(dim(df_s)[1]-1))
</code></pre>

<hr>
<h2 id='Sphdist'>Spherical Empirical Distribution</h2><span id='topic+Sphdist'></span>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform the Sphericity test of the population covariance matrix
<code class="reqn">\boldsymbol{\Sigma}</code> that is <code class="reqn">\boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>,
based on the released Single Synthetic data generated under Plug-in Sampling,
assuming that the original dataset is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sphdist(nsample, pvariates, iterations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sphdist_+3A_nsample">nsample</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="Sphdist_+3A_pvariates">pvariates</code></td>
<td>
<p>Number of variables.</p>
</td></tr>
<tr><td><code id="Sphdist_+3A_iterations">iterations</code></td>
<td>
<p>Number of iterations for simulating values from the
distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_2^\star = \frac{|\boldsymbol{S}^{\star}|^{\frac{1}{p}}}{tr(\boldsymbol{S}^{\star})/p}</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>,
<code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset.
For <code class="reqn">\boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>, its distribution is
stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn">\frac{|\boldsymbol{\Omega}_{1}\boldsymbol{\Omega}_{2}|^{\frac{1}{p}}}{tr(\boldsymbol{\Omega}_{1}\boldsymbol{\Omega}_{2})/p}</code>
</p>

<p>where <code class="reqn">\boldsymbol{\Omega}_1</code> and <code class="reqn">\boldsymbol{\Omega}_2</code> are
Wishart random variables,
<code class="reqn">\boldsymbol{\Omega}_1 \sim \mathcal{W}_p(n-1, \frac{\mathbf{I}_p}{n-1})</code>
is independent of <code class="reqn">\boldsymbol{\Omega}_2 \sim \mathcal{W}_p(n-1, \mathbf{I}_p)</code>.
To test <code class="reqn">\mathcal{H}_0: \boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>, compute the observed value of
<code class="reqn">T_{2}^\star</code>, <code class="reqn">\widetilde{T_{2}^\star}</code>,  with the observed values
and reject the null hypothesis if
<code class="reqn">\widetilde{T_{2}^\star}&gt;t^\star_{2,\alpha}</code>
for <code class="reqn">\alpha</code>-significance level, where <code class="reqn">t^\star_{2,\gamma}</code>
is the <code class="reqn">\gamma</code>th percentile of <code class="reqn">T_2^\star</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Original data created
library(MASS)
mu &lt;- c(1,2,3,4)
Sigma &lt;- matrix(c(1, 0, 0, 0,
                  0, 1, 0, 0,
                  0, 0, 1, 0,
                  0, 0, 0, 1), nrow = 4, ncol = 4, byrow = TRUE)
seed = 1
n_sample = 100
# Create original simulated dataset
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)

# Sinthetic data created

df_s = simSynthData(df)


# Gather the 0.95 quantile

p = dim(df_s)[2]

T_sph &lt;- Sphdist(nsample = n_sample, pvariates = p, iterations = 10000)
q95 &lt;- quantile(T_sph, 0.95)

# Compute the observed value of T from the synthetic dataset
S_star = cov(df_s*(n_sample-1))

T_obs = (det(S_star)^(1/p))/(sum(diag(S_star))/p)

print(q95)
print(T_obs)

#Since the observed value is bigger than the 95% quantile,
#we don't have statistical evidences to reject the Sphericity property.
#
#Note that the value is very close to one
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
