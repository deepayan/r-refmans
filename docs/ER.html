<!DOCTYPE html><html><head><title>Help for package ER</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ER}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confints'><p>Confidence Intervals of Effect Differences</p></a></li>
<li><a href='#Diabetes'><p>Diabetes data</p></a></li>
<li><a href='#elastic'><p>Elastic-net modeling of ER objects.</p></a></li>
<li><a href='#ER'><p>Effect + Residual Modelling</p></a></li>
<li><a href='#Lactobacillus'><p>Lactobacillus data</p></a></li>
<li><a href='#MS'><p>Multiple Sclerosis data</p></a></li>
<li><a href='#pls'><p>Partial Least Squares modelling of ER objects.</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Effect + Residual Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Multivariate modeling of data after deflation of interfering effects. EF Mosleth et al. (2021) &lt;<a href="https://doi.org/10.1038%2Fs41598-021-82388-w">doi:10.1038/s41598-021-82388-w</a>&gt; and EF Mosleth et al. (2020) &lt;<a href="https://doi.org/10.1016%2FB978-0-12-409547-2.14882-6">doi:10.1016/B978-0-12-409547-2.14882-6</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, scales, gridExtra, glmnet, pls, plsVarSel</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-10 16:57:46 UTC; kristian</td>
</tr>
<tr>
<td>Author:</td>
<td>Kristian Hovde Liland [aut, cre],
  Ellen Færgestad Mosleth [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kristian Hovde Liland &lt;kristian.liland@nmbu.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-10 17:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='confints'>Confidence Intervals of Effect Differences</h2><span id='topic+confints'></span><span id='topic+plot.confints'></span>

<h3>Description</h3>

<p>Confidence Intervals of Effect Differences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confints(X1, X2, confidence = 0.95, df.used = 0)

## S3 method for class 'confints'
plot(
  x,
  y,
  xlab = "",
  ylab = "normalised log2",
  sorted = TRUE,
  labels = FALSE,
  nonZero = FALSE,
  xlim = NULL,
  ylim = NULL,
  text.pt = 12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confints_+3A_x1">X1</code></td>
<td>
<p><code>data.frame</code> containing first effect.</p>
</td></tr>
<tr><td><code id="confints_+3A_x2">X2</code></td>
<td>
<p><code>data.frame</code> containing second effect.</p>
</td></tr>
<tr><td><code id="confints_+3A_confidence">confidence</code></td>
<td>
<p>Level of confidence, default = 0.95.</p>
</td></tr>
<tr><td><code id="confints_+3A_df.used">df.used</code></td>
<td>
<p>Optional argument indicating how many degrees of freedom have been consumed during deflation. Default = 0.</p>
</td></tr>
<tr><td><code id="confints_+3A_x">x</code></td>
<td>
<p>Object of class <code>confint</code>.</p>
</td></tr>
<tr><td><code id="confints_+3A_y">y</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="confints_+3A_xlab">xlab</code></td>
<td>
<p>X label (<code>character</code>)</p>
</td></tr>
<tr><td><code id="confints_+3A_ylab">ylab</code></td>
<td>
<p>Y label (<code>character</code>)</p>
</td></tr>
<tr><td><code id="confints_+3A_sorted">sorted</code></td>
<td>
<p>Logical indicating if intervals should be sorted according to their mean values, or a vector of indices/labels to sort by.</p>
</td></tr>
<tr><td><code id="confints_+3A_labels">labels</code></td>
<td>
<p>Logical indicating if sample labels should be used on x axis.</p>
</td></tr>
<tr><td><code id="confints_+3A_nonzero">nonZero</code></td>
<td>
<p>Logical indicating if intervals are required not to include zero.</p>
</td></tr>
<tr><td><code id="confints_+3A_xlim">xlim</code></td>
<td>
<p>Limits of the horizontal scale.</p>
</td></tr>
<tr><td><code id="confints_+3A_ylim">ylim</code></td>
<td>
<p>Limits of the vertical scale.</p>
</td></tr>
<tr><td><code id="confints_+3A_text.pt">text.pt</code></td>
<td>
<p>Size scaling of text in the plot (default = 16).</p>
</td></tr>
<tr><td><code id="confints_+3A_...">...</code></td>
<td>
<p>Further arguments to <code>qplot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>confints</code>, which holds
the information needed to perform statistics or plot the
confidence intervals is returned from <code>confints</code>.
The plotting routine returns a ggplot structure for plotting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ER">ER</a></code>, <code><a href="#topic+elastic">elastic</a></code> and <code><a href="#topic+pls">pls</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MS)
# Compare MS and non-MS patients within cluster 1
conf &lt;- with(MS, confints(proteins[MS == "yes" &amp; cluster == 1,],
                          proteins[MS == "no"  &amp; cluster == 1,]))
p1 &lt;- plot(conf)
p2 &lt;- plot(conf, nonZero = TRUE) # Only intervals without 0.
grid.arrange(p1,p2)

# Shorter plot with labels
confShort &lt;- conf[1:10,]
p1 &lt;- plot(confShort, labels = TRUE)
p2 &lt;- plot(confShort, labels = TRUE, nonZero = TRUE)
grid.arrange(p1,p2)
</code></pre>

<hr>
<h2 id='Diabetes'>Diabetes data</h2><span id='topic+Diabetes'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> with a design and transcriptomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Diabetes)
</code></pre>


<h3>Details</h3>

<p>Clinical study on humans was performed as a 2-way factorial design with two factors
both on two levels: bariatric surgery on two levels (before and after the bariatric
surgery) and type 2 diabetes (T2D) on two levels (with and without T2D). There were
8 patients without T2D and 7 with T2D. It was discovered that the patients with T2D
would be separated in two groups: 3 patients in the group called T2D1 and 4 patients
in the group called T2D2. The experiment can therefore also analysed as 2 way factorial
design where the disease factor is on three levels. All patients were obese before
bariatric surgery (BMI &gt;45). Transcriptome in the subcutaneous adipose tissue were
obtained before and one year after bariatric surgery.
</p>


<h3>Author(s)</h3>

<p>Ellen Færgestad Mosleth
</p>


<h3>References</h3>

<p>Dankel et al. 2010. Switch from Stress Response to Homeobox Transcription Factors in Adipose Tissue After Profound Fat Loss. Plos One 5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Diabetes)
str(Diabetes)

</code></pre>

<hr>
<h2 id='elastic'>Elastic-net modeling of ER objects.</h2><span id='topic+elastic'></span><span id='topic+elastic.ER'></span>

<h3>Description</h3>

<p>Elastic-net modeling of ER objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elastic(er, ...)

## S3 method for class 'ER'
elastic(
  er,
  effect,
  alpha = 0.5,
  newdata = NULL,
  validation,
  segments = NULL,
  measure = measure,
  family = family,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elastic_+3A_er">er</code></td>
<td>
<p>Object of class <code>ER</code>.</p>
</td></tr>
<tr><td><code id="elastic_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>pls::cvsegments</code>.</p>
</td></tr>
<tr><td><code id="elastic_+3A_effect">effect</code></td>
<td>
<p>The effect to be used as response.</p>
</td></tr>
<tr><td><code id="elastic_+3A_alpha">alpha</code></td>
<td>
<p>The elasticnet mixing parameter.</p>
</td></tr>
<tr><td><code id="elastic_+3A_newdata">newdata</code></td>
<td>
<p>Optional new data matrix for prediction.</p>
</td></tr>
<tr><td><code id="elastic_+3A_validation">validation</code></td>
<td>
<p>Optional validation parameters.</p>
</td></tr>
<tr><td><code id="elastic_+3A_segments">segments</code></td>
<td>
<p>number of segments or list of segments (optional)</p>
</td></tr>
<tr><td><code id="elastic_+3A_measure">measure</code></td>
<td>
<p>Type of performance summary, default = 'class' (see <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>)</p>
</td></tr>
<tr><td><code id="elastic_+3A_family">family</code></td>
<td>
<p>Type of model response, default = 'multinomial'.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ER">ER</a></code>, <code><a href="#topic+pls">pls</a></code> and <code><a href="#topic+confints">confints</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Multiple Sclerosis data
data(MS, package = "ER")
er &lt;- ER(proteins ~ MS * cluster, data = MS)
elasticMod &lt;- elastic(er, 'MS', validation = "CV")
sum(elasticMod$classes == MS$MS)
plot(elasticMod)            # Model fit
plot(elasticMod$glmnet.fit) # Coefficient trajectories

# Select all proteins with non-zeros coefficients
coefs     &lt;- coef(elasticMod,s='lambda.min',exact=TRUE)
(selected &lt;- rownames(coefs[[1]])[unique(unlist(lapply(coefs,
                      function(x)which(as.vector(x) != 0))))][-1])


## Diabetes data
data(Diabetes, package = "ER")
er.Dia &lt;- ER(transcriptome ~ surgery * T2D, data = Diabetes)
elasticMod &lt;- elastic(er.Dia, 'T2D', validation = "LOO")

</code></pre>

<hr>
<h2 id='ER'>Effect + Residual Modelling</h2><span id='topic+ER'></span><span id='topic+print.ER'></span><span id='topic+plot.ER'></span><span id='topic+tableER'></span>

<h3>Description</h3>

<p>Effect + Residual Modelling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ER(formula, data)

## S3 method for class 'ER'
print(x, ...)

## S3 method for class 'ER'
plot(
  x,
  y = 1,
  what = "raw",
  col = NULL,
  pch = NULL,
  model.line = (what %in% c("raw")),
  ylim = NULL,
  ylab = "",
  xlab = "",
  main = NULL,
  ...
)

tableER(object, variable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ER_+3A_formula">formula</code></td>
<td>
<p>a model formula specifying features and effects.</p>
</td></tr>
<tr><td><code id="ER_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> containing response variables (features) and design factors or other groupings/continuous variables.</p>
</td></tr>
<tr><td><code id="ER_+3A_x">x</code></td>
<td>
<p>Object of class <code>ER</code>.</p>
</td></tr>
<tr><td><code id="ER_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code>plot</code></p>
</td></tr>
<tr><td><code id="ER_+3A_y">y</code></td>
<td>
<p>Response name or number.</p>
</td></tr>
<tr><td><code id="ER_+3A_what">what</code></td>
<td>
<p>What part of ER to plot; <code>raw</code> data (default), <code>fits</code>, <code>residuals</code> or
a named model effect (can be combined with 'effect', see <code>Examples</code>).</p>
</td></tr>
<tr><td><code id="ER_+3A_col">col</code></td>
<td>
<p>Color of points, defaults to grouping. Usually set to a factor name.</p>
</td></tr>
<tr><td><code id="ER_+3A_pch">pch</code></td>
<td>
<p>Plot character of points, defaults to 1. Usually set to a factor name.</p>
</td></tr>
<tr><td><code id="ER_+3A_model.line">model.line</code></td>
<td>
<p>Include line indicating estimates, default = TRUE. Can be an effect name.</p>
</td></tr>
<tr><td><code id="ER_+3A_ylim">ylim</code></td>
<td>
<p>Y axis limits (<code>numeric</code>, but defaults to NULL)</p>
</td></tr>
<tr><td><code id="ER_+3A_ylab">ylab</code></td>
<td>
<p>Y label (<code>character</code>)</p>
</td></tr>
<tr><td><code id="ER_+3A_xlab">xlab</code></td>
<td>
<p>X label (<code>character</code>)</p>
</td></tr>
<tr><td><code id="ER_+3A_main">main</code></td>
<td>
<p>Main title, defaults to <code>y</code> with description from <code>what</code>.</p>
</td></tr>
<tr><td><code id="ER_+3A_object">object</code></td>
<td>
<p>ER object.</p>
</td></tr>
<tr><td><code id="ER_+3A_variable">variable</code></td>
<td>
<p>Numeric for selecting a variable for extraction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ER</code> returns an object of class <code>ER</code> containing effects, ER values,
fitted values, residuals, features, coefficients, dummy design, symbolic design, dimensions,
highest level interaction and feature names.
</p>


<h3>References</h3>

<p>* Mosleth et al. (2021) Cerebrospinal fluid proteome shows disrupted neuronal development in multiple sclerosis. Scientific Report, 11,4087. &lt;doi:10.1038/s41598-021-82388-w&gt;
</p>
<p>* E.F. Mosleth et al. (2020). Comprehensive Chemometrics, 2nd edition; Brown, S., Tauler, R., &amp; Walczak, B. (Eds.). Chapter 4.22. Analysis of Megavariate Data in Functional Omics. Elsevier. &lt;doi:10.1016/B978-0-12-409547-2.14882-6&gt;
</p>


<h3>See Also</h3>

<p>Analyses using <code>ER</code>: <code><a href="#topic+elastic">elastic</a></code> and <code><a href="#topic+pls">pls</a></code>. Confidence interval plots <code><a href="#topic+confints">confints</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Multiple Sclerosis
data(MS, package = "ER")
er &lt;- ER(proteins ~ MS * cluster, data = MS)
print(er)
plot(er)                                       # Raw data, first feature
plot(er,2)                                     # Raw data, numbered feature
plot(er,'Q76L83', col='MS', pch='cluster')     # Selected colour and plot character
plot(er,'Q76L83', what='effect MS',
     model.line='effect cluster')              # Comparison of factors (points and lines)

  # Example compound plot
  old.par &lt;- par(c("mfrow", "mar"))
  # on.exit(par(old.par))
  par(mfrow = c(3,3), mar = c(2,4,4,1))
  plot(er,'Q76L83')                                  # Raw data, named feature
  plot(er,'Q76L83', what='fits')                     # Fitted values
  plot(er,'Q76L83', what='residuals')                # Residuals
  plot(er,'Q76L83', what='effect MS')                # Effect levels
  plot(er,'Q76L83', what='effect cluster')           # ----||----
  plot(er,'Q76L83', what='effect MS:cluster')        # ----||----
  plot(er,'Q76L83', what='MS')                       # ER values
  plot(er,'Q76L83', what='cluster')                  # --------||---------
  plot(er,'Q76L83', what='MS:cluster')               # --------||---------
  par(old.par)


# Complete overview of ER
tab &lt;- tableER(er, 1)

# In general there can be more than two, effects, more than two levels, and continuous effects:
# MS$three &lt;- factor(c(rep(1:3,33),1:2))
# er3    &lt;- ER(proteins ~ MS * cluster + three, data = MS)


## Lactobacillus
data(Lactobacillus, package = "ER")
erLac &lt;- ER(proteome ~ strain * growthrate, data = Lactobacillus)
print(erLac)
plot(erLac)                            # Raw data, first feature
plot(erLac,2)                          # Raw data, numbered feature
plot(erLac,'P.LSA0316', col='strain',
    pch='growthrate')                  # Selected colour and plot character
plot(erLac,'P.LSA0316', what='strain',
    model.line='growthrate')           # Selected model.line


## Diabetes
data(Diabetes, package = "ER")
erDia &lt;- ER(transcriptome ~ surgery * T2D, data = Diabetes)
print(erDia)
plot(erDia)                            # Raw data, first feature
plot(erDia,2)                          # Raw data, numbered feature
plot(erDia,'ILMN_1720829', col='surgery',
    pch='T2D')                         # Selected colour and plot character

</code></pre>

<hr>
<h2 id='Lactobacillus'>Lactobacillus data</h2><span id='topic+Lactobacillus'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> with a design and proteomic data, transcriptomic data and phenotypic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Lactobacillus)
</code></pre>


<h3>Details</h3>

<p>Experiment on Lactobacillus sakei was performed as a 2-way factorial design with two
factors both on two levels: strain (L. sakei strains LS25 and 23K) (factor A) and growth
condition (high and low glucose availability) (factor B) both on two levels, and their
interaction term (factor AB). There were three biological replicates within each group.
Transcriptome, proteome and end product profile (lactate, formate, acetate and ethanol)
were observed.
</p>


<h3>Author(s)</h3>

<p>Ellen Færgestad Mosleth
</p>


<h3>References</h3>

<p>McLeod et al. 2017. Effects of glucose availability in Lactobacillus sakei; metabolic change and regulation of the proteome and transcriptome. Plos One 12, e0187542.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Lactobacillus)
str(Lactobacillus)

</code></pre>

<hr>
<h2 id='MS'>Multiple Sclerosis data</h2><span id='topic+MS'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> with a design and proteomic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MS)
</code></pre>


<h3>Details</h3>

<p>Data from biobank are analysed a study population of 101 patients, 37 were diagnosed with
multiple sclerosis, and 64 without multiple sclerosis. Of the patients without multiple
sclerosis, 50 were diagnosed with other neurological disorders and 14 were neurologically
healthy patients who had undergone spinal anaesthesia for orthopaedic surgery on the knee
or ankle, i.e. neurologically healthy controls. Unless otherwise stated, all the patients
without multiple sclerosis were considered as controls for this study. All patients with
multiple sclerosis had relapsing remitting multiple sclerosis. The proteome were obtained
on cerebrospinal fluid samples from all patients prior medical treatment for multiple
sclerosis. It was discovered the patients separated into two clusters, called cluster 1 and
cluster 2. This is utilised in the data analysis by considering the data as 2-way factorial
design with the two factors: MS and clusters both on two levels.
</p>


<h3>Author(s)</h3>

<p>Ellen Færgestad Mosleth
</p>


<h3>References</h3>

<p>* Opsahl, J.A. et al. Label-free analysis of human cerebrospinal fluid addressing various normalization strategies and revealing protein groups affected by multiple sclerosis. Proteomics 16, 1154-1165 (2016).
</p>
<p>* Ellen Færgestad Mosleth, Christian Alexander Vedeler, Kristian Hovde Liland, Anette McLeod, Gerd Haga Bringland, Liesbeth Kroondijk, Frode Berven, Artem Lysenko, Christopher J. Rawlings, Karim El-Hajj Eid, Jill Anette Opsahl, Bjørn Tore Gjertsen, Kjell-Morten Myhr and Sonia Gavasso, Cerebrospinal fluid proteome shows disrupted neuronal development in multiple sclerosis. Scientific Reports – Nature 11(4087), (2021).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MS)
str(MS)

</code></pre>

<hr>
<h2 id='pls'>Partial Least Squares modelling of ER objects.</h2><span id='topic+pls'></span><span id='topic+pls.ER'></span>

<h3>Description</h3>

<p>The output of <code>ER</code> is used as input to a PLS classification with the selected
effect as response. It is possible to compare two models using the <code>er2</code> argument. Variable
selection is available through Jackknifing (from package <code>pls</code>) and Shaving (from package <code>plsVarSel</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pls(er, ...)

## S3 method for class 'ER'
pls(
  er,
  effect,
  ncomp,
  newdata = NULL,
  er2,
  validation,
  jackknife = NULL,
  shave = NULL,
  df.used = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pls_+3A_er">er</code></td>
<td>
<p>Object of class <code>ER</code>.</p>
</td></tr>
<tr><td><code id="pls_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>plsr</code>.</p>
</td></tr>
<tr><td><code id="pls_+3A_effect">effect</code></td>
<td>
<p>The effect to be used as response.</p>
</td></tr>
<tr><td><code id="pls_+3A_ncomp">ncomp</code></td>
<td>
<p>Number of PLS components.</p>
</td></tr>
<tr><td><code id="pls_+3A_newdata">newdata</code></td>
<td>
<p>Optional new data matrix for prediction.</p>
</td></tr>
<tr><td><code id="pls_+3A_er2">er2</code></td>
<td>
<p>Second object of class <code>ER</code> for comparison.</p>
</td></tr>
<tr><td><code id="pls_+3A_validation">validation</code></td>
<td>
<p>Optional validation parameters for <code>plsr</code>.</p>
</td></tr>
<tr><td><code id="pls_+3A_jackknife">jackknife</code></td>
<td>
<p>Optional argument specifying if jackknifing should be applied.</p>
</td></tr>
<tr><td><code id="pls_+3A_shave">shave</code></td>
<td>
<p>Optional argument indicating if variable shaving should be used. <code>shave</code> should be a list with two elements: the PLS filter method and the proportion to remove. <code>shave = TRUE</code> uses defaults: <code>list("sMC", 0.2)</code>.</p>
</td></tr>
<tr><td><code id="pls_+3A_df.used">df.used</code></td>
<td>
<p>Optional argument indicating how many degrees of freedom have been consumed during deflation. Default value from input object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If using the <code>shave</code> options, the segment type is given as <code>type</code> instead of <code>segment.type</code> (see examples).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ER">ER</a></code>, <code><a href="#topic+elastic">elastic</a></code> and <code><a href="#topic+confints">confints</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MS, package = "ER")
er &lt;- ER(proteins ~ MS * cluster, data = MS[-1,])

# Simple PLS using interleaved cross-validation
plsMod &lt;- pls(er, 'MS', 6, validation = "CV",
              segment.type = "interleaved", length.seg = 25)
scoreplot(plsMod, labels = "names")

# PLS with shaving of variables (mind different variable for cross-validation type)
plsModS &lt;- pls(er, 'MS', 6, validation = "CV",
              type = "interleaved", length.seg=25, shave = TRUE)
# Error as a function of remaining variables
plot(plsModS$shave)
# Selected variables for minimum error
with(plsModS$shave, colnames(X)[variables[[min.red+1]]])

 # Time consuming due to leave-one-out cross-validation
plsModJ &lt;- pls(er, 'MS', 5, validation = "LOO",
              jackknife = TRUE)
colSums(plsModJ$classes == as.numeric(MS$MS[-1]))
# Jackknifed coefficient P-values (sorted)
plot(sort(plsModJ$jack[,1,1]), pch = '.', ylab = 'P-value')
abline(h=c(0.01,0.05),col=2:3)

scoreplot(plsModJ)
scoreplot(plsModJ, comps=c(1,3))   # Selected components
# Use MS categories for colouring and clusters for plot characters.
scoreplot(plsModJ, col = er$symbolicDesign[['MS']],
                  pch = 20+as.numeric(er$symbolicDesign[['cluster']]))
loadingplot(plsModJ, scatter=TRUE) # scatter=TRUE for scatter plot

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+grid.arrange'></span><span id='topic+scores'></span><span id='topic+scoreplot'></span><span id='topic+loadings'></span><span id='topic+loadingplot'></span><span id='topic+R2'></span><span id='topic+mvrValstats'></span><span id='topic+explvar'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>gridExtra</dt><dd><p><code><a href="gridExtra.html#topic+arrangeGrob">grid.arrange</a></code></p>
</dd>
<dt>pls</dt><dd><p><code><a href="pls.html#topic+mvrVal">R2</a></code>, <code><a href="pls.html#topic+coef.mvr">explvar</a></code>, <code><a href="pls.html#topic+scoreplot">loadingplot</a></code>, <code><a href="pls.html#topic+scores">loadings</a></code>, <code><a href="pls.html#topic+mvrVal">mvrValstats</a></code>, <code><a href="pls.html#topic+scoreplot">scoreplot</a></code>, <code><a href="pls.html#topic+scores">scores</a></code></p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
