<!DOCTYPE html><html lang="en"><head><title>Help for package tvem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tvem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.tvem'><p>plot.tvem:  Produce plots for a tvem model.</p></a></li>
<li><a href='#print.tvem'><p>print.tvem:  Print output from a model that was fit by the tvem function.</p></a></li>
<li><a href='#select_tvem'><p>select_tvem:  Select number of interior knots for an unpenalized TVEM.</p></a></li>
<li><a href='#simulate_cross_sectional_tvem_example'><p>simulate_cross_sectional_tvem_example: Simulate a cross-sectional dataset for</p>
demonstrating tvem.</a></li>
<li><a href='#simulate_tvem_example'><p>simulate_tvem_example: Simulate a dataset for demonstrating the tvem function.</p></a></li>
<li><a href='#tvem'><p>tvem:  Fit a time-varying effect model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Time-Varying Effect Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-12</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>mgcv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2021 by The Pennsylvania State University</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits time-varying effect models (TVEM). These are a kind of application of varying-coefficient models in the context of longitudinal data, allowing the strength of linear, logistic, or Poisson regression relationships to change over time.  These models are described further in Tan, Shiyko, Li, Li &amp; Dierker (2012) &lt;<a href="https://doi.org/10.1037%2Fa0025814">doi:10.1037/a0025814</a>&gt;.  We thank Kaylee Litson, Patricia Berglund, Yajnaseni Chakraborti, and Hanjoo Kim for their valuable help with testing the package and the documentation. The development of this package was part of a research project supported by National Institutes of Health grants P50 DA039838 from the National Institute of Drug Abuse and 1R01 CA229542-01 from the National Cancer Institute and the NIH Office of Behavioral and Social Science Research. Content is solely the responsibility of the authors and does not necessarily represent the official views of the funding institutions mentioned above. This software is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-12 23:30:05 UTC; dziak</td>
</tr>
<tr>
<td>Author:</td>
<td>John J. Dziak <a href="https://orcid.org/0000-0003-0762-5495"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Donna L. Coffman <a href="https://orcid.org/0000-0001-6305-6579"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Runze Li <a href="https://orcid.org/0000-0002-0154-2202"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Kaylee Litson <a href="https://orcid.org/0000-0003-1296-4811"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Yajnaseni Chakraborti [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John J. Dziak &lt;dziakj1@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-13 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot.tvem'>plot.tvem:  Produce plots for a tvem model.</h2><span id='topic+plot.tvem'></span>

<h3>Description</h3>

<p>Produces plots from a tvem object produced by 
the tvem function.  These plots will be shown on the default
output device (likely the screen);  they can of course be 
written to a file instead, by preceding the call to plot.tvem 
with a call to png(), pdf(), or other R graphic file output functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tvem'
plot(
  x,
  use_panes = TRUE,
  which_plot = NULL,
  diagnostics = FALSE,
  exponentiate = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.tvem_+3A_x">x</code></td>
<td>
<p>The TVEM object to be plotted.</p>
</td></tr>
<tr><td><code id="plot.tvem_+3A_use_panes">use_panes</code></td>
<td>
<p>Whether to plot multiple coefficient
functions in a single image.</p>
</td></tr>
<tr><td><code id="plot.tvem_+3A_which_plot">which_plot</code></td>
<td>
<p>The coefficient number to plot,
if only one plot is desired at a time.</p>
</td></tr>
<tr><td><code id="plot.tvem_+3A_diagnostics">diagnostics</code></td>
<td>
<p>If this is set to TRUE, then 
instead of plotting coefficient functions,
the function will show a histogram of residuals 
and a plot of fitted values versus
residuals.  These may be useful in checking for 
outliers or skew in TVEM with a numeric
outcome.  They are not likely to be as useful 
in TVEM with a binary or other discrete outcome.</p>
</td></tr>
<tr><td><code id="plot.tvem_+3A_exponentiate">exponentiate</code></td>
<td>
<p>If this is set to TRUE and if
the TVEM had a binary outcome, then the exponentiated 
coefficient functions (representing odds and odds
ratios) will be plotted rather than the usual
coefficient functions (representing log odds and log
odds ratios).</p>
</td></tr>
<tr><td><code id="plot.tvem_+3A_...">...</code></td>
<td>
<p>Further arguments currently not supported</p>
</td></tr>
</table>

<hr>
<h2 id='print.tvem'>print.tvem:  Print output from a model that was fit by the tvem function.</h2><span id='topic+print.tvem'></span>

<h3>Description</h3>

<p>print.tvem:  Print output from a model that was fit by the tvem function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tvem'
print(x, ornate = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tvem_+3A_x">x</code></td>
<td>
<p>The tvem object (output of the tvem or select_tvem function)</p>
</td></tr>
<tr><td><code id="print.tvem_+3A_ornate">ornate</code></td>
<td>
<p>Whether to print lines between different sections of the output for easier reading.</p>
</td></tr>
<tr><td><code id="print.tvem_+3A_...">...</code></td>
<td>
<p>Further arguments currently not supported</p>
</td></tr>
</table>

<hr>
<h2 id='select_tvem'>select_tvem:  Select number of interior knots for an unpenalized TVEM.</h2><span id='topic+select_tvem'></span>

<h3>Description</h3>

<p>select_tvem:  Select number of interior knots for an unpenalized TVEM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_tvem(
  max_knots = 5,
  keep_going_if_too_few = FALSE,
  use_bic = FALSE,
  penalize = FALSE,
  print_output = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_tvem_+3A_max_knots">max_knots</code></td>
<td>
<p>The maximum number of interior knots to try (0 through max_knots)</p>
</td></tr>
<tr><td><code id="select_tvem_+3A_keep_going_if_too_few">keep_going_if_too_few</code></td>
<td>
<p>Whether to continue in a stepwise fashion if the max_knots 
does not seem to be high enough</p>
</td></tr>
<tr><td><code id="select_tvem_+3A_use_bic">use_bic</code></td>
<td>
<p>Whether to use BIC (TRUE) instead of AIC (FALSE) when selecting the best 
model. Note that both of these IC's are calculated from the working-independence 
pseudolikelihood rather than the unknown true likelihood. However, for BIC, the
sample size is taken to be the number of subjects, not the number of observations.</p>
</td></tr>
<tr><td><code id="select_tvem_+3A_penalize">penalize</code></td>
<td>
<p>Whether to include a penalty function in estimation</p>
</td></tr>
<tr><td><code id="select_tvem_+3A_print_output">print_output</code></td>
<td>
<p>Whether to print the pseudolikelihoods obtained for each candidate number of interior knots.</p>
</td></tr>
<tr><td><code id="select_tvem_+3A_...">...</code></td>
<td>
<p>Other inputs to be sent along to each call to the tvem function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A TVEM object for the fitted model, with an additional component containing
a table of information criteria.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
the_data &lt;- simulate_tvem_example(n_subjects=200)
tvem_model &lt;- tvem(data=the_data,
              formula=y~1,
              id=subject_id,
              time=time)
print(tvem_model)
plot(tvem_model)

</code></pre>

<hr>
<h2 id='simulate_cross_sectional_tvem_example'>simulate_cross_sectional_tvem_example: Simulate a cross-sectional dataset for 
demonstrating tvem.</h2><span id='topic+simulate_cross_sectional_tvem_example'></span>

<h3>Description</h3>

<p>This differs from what simulate_tvem_example does, in that each
participant (subject) is only measured at a single measurement time,
but the measurement time of each subject is random.  This might
simulate a sample of people of many different ages, where age 
is treated as a continuous number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_cross_sectional_tvem_example(
  n_subjects = 300,
  min_time = 7,
  max_time = 7,
  simulate_binary = FALSE,
  sigma_x1 = 2,
  sigma_x2 = 2,
  truncate_for_realism = TRUE,
  round_digits = 3,
  sigma_y = 1.5,
  mu_x1_function = function(t) {
     6 - 2 * sqrt(pmax(0, ((t - min(t))/7) - 0.2))
 },
  mu_x2_function = function(t) {
     3 + sqrt(pmax(0, ((t - min(t))/7) - 0.5))
 },
  beta0_y_function = function(t) {
     1 - 0.3 * sqrt((t - min(t))/7)
 },
  beta1_y_function = function(t) {
     0.5 * ((t - min(t))/7)^2
 },
  beta2_y_function = function(t) {
     rep(0.2, length(t))
 }
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_n_subjects">n_subjects</code></td>
<td>
<p>Number of subjects in dataset</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_min_time">min_time</code></td>
<td>
<p>The time point at the end of the simulated time interval</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_max_time">max_time</code></td>
<td>
<p>The time point at the end of the simulated time interval</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_simulate_binary">simulate_binary</code></td>
<td>
<p>Whether the simulated data should be binary</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_sigma_x1">sigma_x1</code></td>
<td>
<p>Standard deviation of covariate 1, assumed homoskedastic over time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_sigma_x2">sigma_x2</code></td>
<td>
<p>Standard deviation of covariate 2, assumed homoskedastic over time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_truncate_for_realism">truncate_for_realism</code></td>
<td>
<p>Whether to prevent simulated values from going below 0 or above 10, 
in order to imitate survey data; used only for normally distributed outcomes.
Set this to FALSE if you are running a simulation, in order to avoid losing coverage
due to departing from the parametric model.</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_round_digits">round_digits</code></td>
<td>
<p>Number of digits at which to round the generated data; used only for normally distributed outcomes</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_sigma_y">sigma_y</code></td>
<td>
<p>Error standard deviation of y, only used if the outcomes are to be normal rather than binary</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_mu_x1_function">mu_x1_function</code></td>
<td>
<p>Mean of covariate 1 as function of time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_mu_x2_function">mu_x2_function</code></td>
<td>
<p>Mean of covariate 2 as function of time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_beta0_y_function">beta0_y_function</code></td>
<td>
<p>TVEM intercept as function of time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_beta1_y_function">beta1_y_function</code></td>
<td>
<p>TVEM coefficient of covariate 1 as function of time</p>
</td></tr>
<tr><td><code id="simulate_cross_sectional_tvem_example_+3A_beta2_y_function">beta2_y_function</code></td>
<td>
<p>TVEM coefficient of covariate 2 as function of time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the data-generating model has a time-varying intercept,
and two time-varying covariates named x1 and x2. 
x1 has a time-varying effect and x2 has a time-invariant effect.
</p>


<h3>Value</h3>

<p>A simulated dataset with the following variables:
</p>

<dl>
<dt>subject_id</dt><dd><p>Subject ID</p>
</dd>
<dt>time</dt><dd><p>Observation time</p>
</dd>
<dt>x1</dt><dd><p>First covariate</p>
</dd>
<dt>x2</dt><dd><p>Second covariate</p>
</dd>
<dt>y</dt><dd><p>Outcome variable</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(16802)
the_data &lt;- simulate_tvem_example(simulate_binary=TRUE)

</code></pre>

<hr>
<h2 id='simulate_tvem_example'>simulate_tvem_example: Simulate a dataset for demonstrating the tvem function.</h2><span id='topic+simulate_tvem_example'></span>

<h3>Description</h3>

<p>By default, the data-generating model has a time-varying intercept,
and two time-varying covariates named x1 and x2. 
x1 has a time-varying effect and x2 has a time-invariant effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_tvem_example(
  n_subjects = 300,
  max_time = 7,
  simulate_binary = FALSE,
  n_obs_possible = 141,
  prop_obs_observed = 0.3,
  sigma_x1 = 2,
  sigma_x2 = 2,
  truncate_for_realism = TRUE,
  round_digits = 3,
  x1_short_term_rho = 0.7,
  x2_short_term_rho = 0.7,
  sigma_y = 1.5,
  mu_x1_function = function(t) {
     6 - 2 * sqrt(pmax(0, (t/7) - 0.2))
 },
  mu_x2_function = function(t) {
     3 + sqrt(pmax(0, (t/7) - 0.5))
 },
  beta0_y_function = function(t) {
     1 - 0.3 * sqrt(t/7)
 },
  beta1_y_function = function(t) {
     0.5 * (t/7)^2
 },
  beta2_y_function = function(t) {
     rep(0.2, length(t))
 },
  y_short_term_rho = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_tvem_example_+3A_n_subjects">n_subjects</code></td>
<td>
<p>Number of subjects in dataset</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_max_time">max_time</code></td>
<td>
<p>The time point at the end of the simulated time interval</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_simulate_binary">simulate_binary</code></td>
<td>
<p>Whether the simulated data should be binary</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_n_obs_possible">n_obs_possible</code></td>
<td>
<p>Total number of possible measurement times per subject</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_prop_obs_observed">prop_obs_observed</code></td>
<td>
<p>Proportion of these that are actually observed</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_sigma_x1">sigma_x1</code></td>
<td>
<p>Standard deviation of covariate 1, assumed homoskedastic over time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_sigma_x2">sigma_x2</code></td>
<td>
<p>Standard deviation of covariate 2, assumed homoskedastic over time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_truncate_for_realism">truncate_for_realism</code></td>
<td>
<p>Whether to prevent simulated values from going below 0 or above 10, 
in order to imitate survey data; used only for normally distributed outcomes.
Set this to FALSE if you are running a simulation, in order to avoid losing coverage
due to departing from the parametric model.</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_round_digits">round_digits</code></td>
<td>
<p>Number of digits at which to round the generated data; used only for normally distributed outcomes</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_x1_short_term_rho">x1_short_term_rho</code></td>
<td>
<p>Correlation between adjacent measurements of covariate 1</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_x2_short_term_rho">x2_short_term_rho</code></td>
<td>
<p>Correlation between adjacent measurements of covariate 2</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_sigma_y">sigma_y</code></td>
<td>
<p>Error standard deviation of y, only used if the outcomes are to be normal rather than binary</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_mu_x1_function">mu_x1_function</code></td>
<td>
<p>Mean of covariate 1 as function of time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_mu_x2_function">mu_x2_function</code></td>
<td>
<p>Mean of covariate 2 as function of time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_beta0_y_function">beta0_y_function</code></td>
<td>
<p>TVEM intercept as function of time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_beta1_y_function">beta1_y_function</code></td>
<td>
<p>TVEM coefficient of covariate 1 as function of time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_beta2_y_function">beta2_y_function</code></td>
<td>
<p>TVEM coefficient of covariate 2 as function of time</p>
</td></tr>
<tr><td><code id="simulate_tvem_example_+3A_y_short_term_rho">y_short_term_rho</code></td>
<td>
<p>Correlation between adjacent measurements of y, only used if it is normal and not binary</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simulated dataset with the following variables:
</p>

<dl>
<dt>subject_id</dt><dd><p>Subject ID</p>
</dd>
<dt>time</dt><dd><p>Observation time</p>
</dd>
<dt>x1</dt><dd><p>First covariate</p>
</dd>
<dt>x2</dt><dd><p>Second covariate</p>
</dd>
<dt>y</dt><dd><p>Outcome variable</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
the_data &lt;- simulate_tvem_example(simulate_binary=TRUE)

</code></pre>

<hr>
<h2 id='tvem'>tvem:  Fit a time-varying effect model.</h2><span id='topic+tvem'></span>

<h3>Description</h3>

<p>Fits a time-varying effect model (Tan et al., 2012);  that is,
a varying-coefficients model (Hastie &amp; Tibshirani, 1993) for 
longitudinal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvem(
  data,
  formula,
  id,
  time,
  invar_effects = NULL,
  family = gaussian(),
  weights = NULL,
  num_knots = 20,
  spline_order = 3,
  penalty_function_order = 1,
  grid = 100,
  penalize = TRUE,
  alpha = 0.05,
  basis = "ps",
  method = "fREML",
  use_naive_se = FALSE,
  print_gam_formula = FALSE,
  normalize_weights = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvem_+3A_data">data</code></td>
<td>
<p>The dataset containing the observations, assumed
to be in long form (i.e., one row per observation, potentially
multiple rows per subject).</p>
</td></tr>
<tr><td><code id="tvem_+3A_formula">formula</code></td>
<td>
<p>A formula listing the outcome on the left side, 
and the time-varying effects on the right-side.  For a time-
varying intercept only, use y~1, where y is the name of the 
outcome.  For a single time-varying-effects covariate, use
y~x, where x is the name of the covariate.  For multiple 
covariates, use syntax like y~x1+x2.  Do not include the non-
time-varying-effects covariates here.  Note that the values 
of these covariates themselves may either be time-varying 
or time-invariant. For example, time-invariant biological sex may have
a time-varying effect on time-varying height during childhood.</p>
</td></tr>
<tr><td><code id="tvem_+3A_id">id</code></td>
<td>
<p>The name of the variable in the dataset which represents 
subject (participant) identity.  Observations are considered 
to be correlated within subject (although the correlation 
structure is not explicitly modeled) but are assumed independent
between subjects.</p>
</td></tr>
<tr><td><code id="tvem_+3A_time">time</code></td>
<td>
<p>The name of the variable in the dataset which 
represents time. The regression coefficient functions representing 
the time-varying effects are assumed to be smooth functions 
of this variable.</p>
</td></tr>
<tr><td><code id="tvem_+3A_invar_effects">invar_effects</code></td>
<td>
<p>Optionally, the names of one or more 
variables in the dataset assumed to have a non-time-varying (i.e., time-invariant)
regression effect on the outcome.  The values of these covariates 
themselves may either be time-varying or time-invariant.  The
covariates should be specified as the right side of a formula, e.g.,
~x1 or ~x1+x2.</p>
</td></tr>
<tr><td><code id="tvem_+3A_family">family</code></td>
<td>
<p>The outcome family, as specified in functions like 
glm.  For a numerical outcome you can use the default of gaussian(). 
For a binary outcome, use binomial().  For a count outcome, you can 
use poisson().  The parentheses after the family name are there because it is 
actually a built-in R object.</p>
</td></tr>
<tr><td><code id="tvem_+3A_weights">weights</code></td>
<td>
<p>An optional sampling weight variable.</p>
</td></tr>
<tr><td><code id="tvem_+3A_num_knots">num_knots</code></td>
<td>
<p>The number of interior knots assumed per spline function,
not counting exterior knots. This is assumed to be the same for each function.
If penalized=TRUE is used, it is probably okay to leave num_knots at its default.</p>
</td></tr>
<tr><td><code id="tvem_+3A_spline_order">spline_order</code></td>
<td>
<p>The shape of the function between knots, with a
default of 3 representing cubic spline.</p>
</td></tr>
<tr><td><code id="tvem_+3A_penalty_function_order">penalty_function_order</code></td>
<td>
<p>The order of the penalty function (see 
Eilers and Marx, 1996), with a default of 1 for first-order 
difference penalty.  Eilers and Marx (1996) used second-order difference
but we found first-order seemed to perform parsimoniously in this setting.
Please feel free to consider setting this to 2 to explore other possible 
results. The penalty function is something analogous to a prior distribution
describing how smooth or flat the estimated coefficient functions should be,  
with 1 being smoothest.</p>
</td></tr>
<tr><td><code id="tvem_+3A_grid">grid</code></td>
<td>
<p>The number of points at which the spline coefficients
will be estimated, for the purposes of the pointwise estimates and 
pointwise standard errors to be included in the output object. The
grid points will be generated as equally spaced over the observed 
interval. Alternatively, grid can be specified as a vector instead, in which 
each number in the vector is interpreted as a time point for the grid
itself.</p>
</td></tr>
<tr><td><code id="tvem_+3A_penalize">penalize</code></td>
<td>
<p>Whether to add a complexity penalty; TRUE or FALSE</p>
</td></tr>
<tr><td><code id="tvem_+3A_alpha">alpha</code></td>
<td>
<p>One minus the nominal coverage for 
the pointwise confidence intervals to be constructed.  Note that a 
multiple comparisons correction is not applied.  Also, in some cases
the nominal coverage may not be exactly achieved even pointwise, 
because of uncertainty in the tuning parameter and risk of overfitting.
These problems are not unique to TVEM but are found in many curve-
fitting situations.</p>
</td></tr>
<tr><td><code id="tvem_+3A_basis">basis</code></td>
<td>
<p>Form of function basis (an optional argument about computational 
details passed on to the mgcv::s function as bs=).  We strongly recommend
leaving it at the default value.</p>
</td></tr>
<tr><td><code id="tvem_+3A_method">method</code></td>
<td>
<p>Fitting method (an optional argument about computational 
details passed on to the mgcv::bam function as method).  We strongly recommend
leaving it at the default value.</p>
</td></tr>
<tr><td><code id="tvem_+3A_use_naive_se">use_naive_se</code></td>
<td>
<p>Whether to save time by using a simpler, less valid formula for 
standard errors. Only do this if you are doing TVEM inside a loop for
bootstrapping or model selection and plan to ignore these standard errors.</p>
</td></tr>
<tr><td><code id="tvem_+3A_print_gam_formula">print_gam_formula</code></td>
<td>
<p>whether to print the formula used to do the back-end calculations
in the bam (large data gam) function in the mgcv package.</p>
</td></tr>
<tr><td><code id="tvem_+3A_normalize_weights">normalize_weights</code></td>
<td>
<p>Whether to rescale (standardize) the weights variable to have a mean 
of 1 for the dataset used in the analysis. Setting this to FALSE might lead to invalid 
standard errors caused by misrepresentation of the true sample size. This 
option is irrelevant and ignored if a weight variable is not specified, because
in that case all the weights are effectively 1 anyway.  An error will result if the function is asked to rescale weights and any of the weights are negative; however, it is very rare for
sampling weights to be negative.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type tvem. The components of an object of 
type tvem are as follows:
</p>

<dl>
<dt>time_grid</dt><dd><p>A vector containing many evenly spaced time 
points along the interval between the lowest and highest observed 
time value. The exact number of points is determined by the 
input parameter 'grid'.</p>
</dd>
<dt>grid_fitted_coefficients</dt><dd><p>A list of data frames, one for 
each smooth function which was fit (including the intercept). Each 
data frame contains the fitted estimates of the function
at each point of time_grid, along with pointwise standard 
errors and pointwise confidence intervals.</p>
</dd>
<dt>invar_effects_estimates</dt><dd><p>If any variables are specified in
invar_effects, their estimated regression coefficients and 
standard errors are shown here.</p>
</dd>
<dt>model_information</dt><dd><p>A list summarizing the options
specified in the call to the function, as well as fit statistics
based on the log-pseudo-likelihood function. The term pseudo
here means that the likelihood function is evaluated as though
the correct knot locations were known, as though the 
observations were independent and, if applicable, as though sampling 
weights were multiples of a participant rather than 
inverse probabilities. This allows tvem to be used without
specifying a fully parametric probability model.</p>
</dd>
<dt>back_end_model</dt><dd><p>The full output from the bam() 
function from the mgcv package, which was used to fit the 
penalized spline regression model underlying the TVEM.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The interface is based somewhat on the TVEM 3.1.1 SAS macro by 
the Methodology Center (Li et al., 2017).  However, that macro uses 
either &quot;P-splines&quot; (penalized truncated power splines) or &quot;B-splines&quot; 
(unpenalized B[asic]-splines, like those of Eilers and Marx, 1996, 
but without the smoothing penalty).  The current function uses 
penalized B-splines, much more like those of Eilers and Marx (1996).
However, their use is more like the &quot;P-spline&quot; method than the &quot;B-spline&quot; method   
in the TVEM 3.1.1 SAS macro, in that the precise choice of knots 
is not critical, the tuning is done automatically, and the fitted model
is intended to be interpreted in a population-averaged (i.e., marginal) 
way.  Thus, random effects are not allowed, but sandwich standard 
errors are used in attempt to account for within-subject correlation,
similar to working-independence GEE (Liang and Zeger, 1986).
</p>
<p>Note that as in ordinary parametric regression, if the range
of the covariate does not include values near zero, then the 
interpretation of the intercept coefficient may be somewhat 
difficult and its standard errors may be large (i.e., due to extrapolation).
</p>
<p>The bam (&quot;Big Additive Models&quot;) function in the 
mgcv package (&quot;Mixed GAM Computation Vehicle with GCV/AIC/REML smoothness
estimation and GAMMs by REML/PQL&quot;) by Simon Wood is used for back-end
calculations (see Wood, Goude, &amp; Shaw, 2015).
</p>


<h3>References</h3>

<p>Eilers, P. H. C., &amp; Marx, B.  D. (1996). Flexible smoothing with B-splines
and penalties. Statistical Science, 11: 89-121. &lt;doi:10.1214/ss/1038425655&gt;
</p>
<p>Hastie, T, Tibshirani, R. (1993). Varying-coefficient models. Journal 
of the Royal Statistical Socety, B, 55:757-796. &lt;doi:10.1057/9780230280830_39&gt;
</p>
<p>Li, R., Dziak, J. J., Tan, X., Huang, L., Wagner, A. T., &amp; Yang, J. (2017).
TVEM (time-varying effect model) SAS macro users' guide (Version 3.1.1).
University Park: The Methodology Center, Penn State. Retrieved from
&lt;http://methodology.psu.edu&gt;. Available online at
&lt;https://aimlab.psu.edu/tvem/tvem-sas-macro/&gt; and archived at  
&lt;https://github.com/dziakj1/MethodologyCenterTVEMmacros&gt;
and
&lt;https://scholarsphere.psu.edu/collections/v41687m23q&gt;.
</p>
<p>Liang, K. Y., Zeger, S. L. Longitudinal data analysis using generalized linear
models. Biometrika. 1986; 73:13-22. &lt;doi:10.1093/biomet/73.1.13&gt;
</p>
<p>Tan, X., Shiyko, M. P., Li, R., Li, Y., &amp; Dierker, L. (2012). A time-varying
effect model for intensive longitudinal data. Psychological Methods, 17: 
61-77. &lt;doi:10.1037/a0025814&gt;
</p>
<p>Wood, S. N., Goude, Y., &amp; Shaw, S. (2015). Generalized additive models 
for large data sets. Applied Statistics, 64: 139-155. ISBN 10 1498728332, 
ISBN 13 978-1498728331.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
the_data &lt;- simulate_tvem_example()
tvem_model &lt;- tvem(data=the_data,
              formula=y~x1,
              invar_effects=~x2,
              id=subject_id,
              time=time)
print(tvem_model)
plot(tvem_model)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
