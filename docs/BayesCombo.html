<!DOCTYPE html><html lang="en"><head><title>Help for package BayesCombo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesCombo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.post.beta'><p>Utility functions</p></a></li>
<li><a href='#ev.combo'><p>Calculates the posterior probability of hypotheses for multiple</p>
studies</a></li>
<li><a href='#forestplot'><p>Forest plot</p></a></li>
<li><a href='#plot.EV'><p>Plot of posterior probabilities for each hypothesis</p></a></li>
<li><a href='#plot.PPH'><p>Plot of prior, likelihood, and posterior distributions</p></a></li>
<li><a href='#pph'><p>Calculates the posterior probability of hypotheses for one study</p></a></li>
<li><a href='#summary.PPH'><p>Print and summary methods for PPH and EV objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Bayesian Evidence Combination</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-02-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Bruno Contrino, Stanley E. Lazic</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stanley E. Lazic &lt;stan.lazic@cantab.net&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Combine diverse evidence across multiple studies to test a high level scientific theory. The methods can also be used as an alternative to a standard meta-analysis.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10),</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, labstats, testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stanlazic/BayesCombo">https://github.com/stanlazic/BayesCombo</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stanlazic/BayesCombo/issues">https://github.com/stanlazic/BayesCombo/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-02-07 08:42:45 UTC; sel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-02-08 12:20:17</td>
</tr>
</table>
<hr>
<h2 id='calc.post.beta'>Utility functions</h2><span id='topic+calc.post.beta'></span><span id='topic+calc.post.se'></span><span id='topic+prior.se'></span>

<h3>Description</h3>

<p>Not called directly by user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.post.beta(beta, se.beta, beta0, se0)

calc.post.se(se.beta, se0)

prior.se(beta, se.beta, ci)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.post.beta_+3A_beta">beta</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="calc.post.beta_+3A_se.beta">se.beta</code></td>
<td>
<p>Standard error of the effect.</p>
</td></tr>
<tr><td><code id="calc.post.beta_+3A_beta0">beta0</code></td>
<td>
<p>Prior for the effect size.</p>
</td></tr>
<tr><td><code id="calc.post.beta_+3A_se0">se0</code></td>
<td>
<p>Prior standard error.</p>
</td></tr>
<tr><td><code id="calc.post.beta_+3A_ci">ci</code></td>
<td>
<p>A numeric value that is used to calculate the prior standard error.</p>
</td></tr>
</table>

<hr>
<h2 id='ev.combo'>Calculates the posterior probability of hypotheses for multiple
studies</h2><span id='topic+ev.combo'></span>

<h3>Description</h3>

<p>The function takes multiple effect sizes and a their standard
errors and calculates the posterior probability for each hypothesis (H&lt;: the
effect size is less than 0, H0: the effect size is zero, or H&gt;: the effect
size is greater than zero).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ev.combo(beta, se.beta, beta0 = 0, ci = 99, H0 = c(0, 0), scale = FALSE,
  H.priors = rep(1/3, 3), se.mult = 1, adjust = FALSE, epsilon = 1e-06,
  adj.factor = 1e-04, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ev.combo_+3A_beta">beta</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_se.beta">se.beta</code></td>
<td>
<p>Standard error for the effect.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_beta0">beta0</code></td>
<td>
<p>A prior value for the effect size. Default is zero.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_ci">ci</code></td>
<td>
<p>Is used to calculate the prior standard error if <code>se0 =
NULL</code>. The default value of 99 calculates the prior standard error so that
the 99
largest (furthest from zero) confidence interval of the data distribution.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_h0">H0</code></td>
<td>
<p>A vector of length two that defines the null hypothesis. If the
values are identical (e.g. <code>H0 = c(0,0)</code>) a point null is used,
otherwise the null is defined as the range between the lower and upper value.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to scale the effect size by its standard
error. Standardising has no effect on the calculations but standardised
effect sizes may be easier to compare in a forest plot.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_h.priors">H.priors</code></td>
<td>
<p>Prior hypothesis probabilities; default is an equal
probability of 1/3, and they are specified in the following order:
<code>H&lt;0</code>, <code>H=0</code>, <code>H&gt;0</code>.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_se.mult">se.mult</code></td>
<td>
<p>Standard error multiplier used to increase or decrease the
prior SE and used in conjunction with <code>ci</code> when <code>se0 = NULL</code>.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_adjust">adjust</code></td>
<td>
<p>Logical. Whether to adjust very small posterior hypothesis
probabilities. Adjusting prevents a single study from having too much
influence on the results when combining multiple studies. For example, if the
probability for a hypothesis from one study is zero, then additional studies
cannot alter this probability (multiplying anything by zero is still zero).</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_epsilon">epsilon</code></td>
<td>
<p>A small value that a posterior hypothesis probability must
fall below before an adjustment is made. Ignored if <code>adjust = FALSE</code>.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_adj.factor">adj.factor</code></td>
<td>
<p>A small number added to each posterior hypothesis
probability if <code>adjust = TRUE</code> and one of the posterior hypothesis
probabilities is less than <code>epsilon</code>. The PPHs are then re-scaled to sum
to one.</p>
</td></tr>
<tr><td><code id="ev.combo_+3A_...">...</code></td>
<td>
<p>Options to be passed to <code>pph()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code>pph()</code> once for each study to be combined,
where the posterior probabilities for one study are used as the priors for
the next study. One exeption is that values for <code>se0</code> are ignored as
they are calculated automatically.
</p>


<h3>Value</h3>

<p>Object of class <code>EV</code> which contains a matrix of posterior
probabilities for each updated step and other calculated values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ev.combo(beta = c(0.0126, 5.0052, 1.2976, 0.0005),
       se.beta = c(0.050, 2.581, 2.054, 0.003) )
x
plot(x)
</code></pre>

<hr>
<h2 id='forestplot'>Forest plot</h2><span id='topic+forestplot'></span>

<h3>Description</h3>

<p>Plots the effect sizes and standard errors for a set of studies
as a standard forest plot. Also shown are the priors for each study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forestplot(x, range = NULL, xlab = "Effect size", ylab = "Study", ...,
  labels = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forestplot_+3A_x">x</code></td>
<td>
<p>An object of the class <code>EV</code>.</p>
</td></tr>
<tr><td><code id="forestplot_+3A_range">range</code></td>
<td>
<p>A numeric vector of length two that sets the range of the
x-axis. Values are passed to <code>xlim</code>. Sensible default values are used
when <code>range = NULL</code>.</p>
</td></tr>
<tr><td><code id="forestplot_+3A_xlab">xlab</code>, <code id="forestplot_+3A_ylab">ylab</code></td>
<td>
<p>Text for the x and y axes labels.</p>
</td></tr>
<tr><td><code id="forestplot_+3A_...">...</code></td>
<td>
<p>Other options passed to <code>plot()</code>.</p>
</td></tr>
<tr><td><code id="forestplot_+3A_labels">labels</code></td>
<td>
<p>Names for studies to be plotted on the y-axis. If <code>NULL</code>,
then numbers are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots results from the <code>ev.combo()</code> function. The
results may be hard to visualise if the effect sizes differ greatly, and it
may be preferable to standardise the effect sizes by setting <code>scale =
TRUE</code> in the <code>ev.combo()</code> function.
</p>


<h3>Value</h3>

<p>A forest plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ev.combo">ev.combo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ev.combo( beta = c(0.0126, 5.0052, 1.2976, 0.0005),
       se.beta = c(0.050, 2.581, 2.054, 0.003) )
forestplot(x)

</code></pre>

<hr>
<h2 id='plot.EV'>Plot of posterior probabilities for each hypothesis</h2><span id='topic+plot.EV'></span>

<h3>Description</h3>

<p>Shows how the posterior probabilities evolve as each study is
added to the analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EV'
plot(x, leg.loc = "topleft", lty = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.EV_+3A_x">x</code></td>
<td>
<p>An object of the class <code>EV</code> created by the <code>ev.combo()</code>
function.</p>
</td></tr>
<tr><td><code id="plot.EV_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Location of the legend; default is top left. See the
<code>legend()</code> help pages for all the options.</p>
</td></tr>
<tr><td><code id="plot.EV_+3A_lty">lty</code></td>
<td>
<p>An vector of integers that specifies the line types. See the
<code>matplot()</code> function for details.</p>
</td></tr>
<tr><td><code id="plot.EV_+3A_...">...</code></td>
<td>
<p>Other options passed to <code>matplot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each line in the graph is a hypothesis and the lines start at the
prior hypothesis probabilities (usually 1/3).
</p>


<h3>Value</h3>

<p>Plot of posterior probabilities for each hypothesis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ev.combo">ev.combo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- ev.combo(beta = c(0.0126, 5.0052, 1.2976, 0.0005),
       se.beta = c(0.050, 2.581, 2.054, 0.003) )
plot(x)
</code></pre>

<hr>
<h2 id='plot.PPH'>Plot of prior, likelihood, and posterior distributions</h2><span id='topic+plot.PPH'></span>

<h3>Description</h3>

<p>Plots the prior, likelihood, and posterior distribution from a
single study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PPH'
plot(x, range = NULL, n = 200, leg.loc = "topleft",
  xlab = "Effect size", ylab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.PPH_+3A_x">x</code></td>
<td>
<p>A <code>PPH</code> object created by the <code>pph()</code> function.</p>
</td></tr>
<tr><td><code id="plot.PPH_+3A_range">range</code></td>
<td>
<p>A numeric vector of length two that sets the range of the
x-axis. Values are passed to <code>xlim</code>. Sensible default values are used
when <code>range = NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.PPH_+3A_n">n</code></td>
<td>
<p>An integer that specifies the number of x-values to use when
plotting the distributions.</p>
</td></tr>
<tr><td><code id="plot.PPH_+3A_leg.loc">leg.loc</code></td>
<td>
<p>Location of the legend; default is top left. See the
<code>legend()</code> help pages for all the options. If <code>leg.loc = NULL</code> the
legend is not plotted.</p>
</td></tr>
<tr><td><code id="plot.PPH_+3A_xlab">xlab</code>, <code id="plot.PPH_+3A_ylab">ylab</code></td>
<td>
<p>Text for the x and y axes labels.</p>
</td></tr>
<tr><td><code id="plot.PPH_+3A_...">...</code></td>
<td>
<p>Other options passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the prior, likelihood (data), and posterior distribution
calculated from the <code>pph()</code> function for a single study.
</p>


<h3>Value</h3>

<p>Plot of distributions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pph">pph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- pph(beta = 5.005, se.beta = 2.05)
plot(x)
</code></pre>

<hr>
<h2 id='pph'>Calculates the posterior probability of hypotheses for one study</h2><span id='topic+pph'></span>

<h3>Description</h3>

<p>The function takes a single effect size and its standard error
and calculates the posterior probability of each hypothesis (H&lt;: the effect
size is less than 0, H0: the effect size is zero, or H&gt;: the effect size is
greater than zero).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pph(beta, se.beta, beta0 = 0, se0 = NULL, ci = 99, se.mult = 1,
  H0 = c(0, 0), H.priors = rep(1/3, 3), scale = FALSE, adjust = FALSE,
  epsilon = 1e-06, adj.factor = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pph_+3A_beta">beta</code></td>
<td>
<p>Effect size.</p>
</td></tr>
<tr><td><code id="pph_+3A_se.beta">se.beta</code></td>
<td>
<p>Standard error for the effect.</p>
</td></tr>
<tr><td><code id="pph_+3A_beta0">beta0</code></td>
<td>
<p>A prior value for the effect size. Default is zero.</p>
</td></tr>
<tr><td><code id="pph_+3A_se0">se0</code></td>
<td>
<p>A prior standard error for the effect size. Default is <code>NULL</code>
and is calculated automatically.</p>
</td></tr>
<tr><td><code id="pph_+3A_ci">ci</code></td>
<td>
<p>Is used to calculate the prior standard error if <code>se0 =
NULL</code>. The default value of 99 calculates the prior standard error so that
the 99
largest (furthest from zero) confidence interval of the data distribution.</p>
</td></tr>
<tr><td><code id="pph_+3A_se.mult">se.mult</code></td>
<td>
<p>Standard error multiplier used to increase or decrease the
prior SE and used in conjunction with <code>ci</code> when <code>se0 = NULL</code>.</p>
</td></tr>
<tr><td><code id="pph_+3A_h0">H0</code></td>
<td>
<p>A vector of length two that defines the null hypothesis. If the
values are identical (e.g. <code>H0 = c(0,0)</code>) a point null is used,
otherwise the null is defined as the range between the lower and upper value.</p>
</td></tr>
<tr><td><code id="pph_+3A_h.priors">H.priors</code></td>
<td>
<p>Prior hypothesis probabilities; default is an equal
probability of 1/3, and they are specified in the following order:
<code>H&lt;0</code>, <code>H=0</code>, <code>H&gt;0</code>.</p>
</td></tr>
<tr><td><code id="pph_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to scale the effect size by its standard
error. Standardising has no effect on the calculations but standardised
effect sizes may be easier to compare in a forest plot.</p>
</td></tr>
<tr><td><code id="pph_+3A_adjust">adjust</code></td>
<td>
<p>Logical. Whether to adjust very small posterior hypothesis
probabilities. Adjusting prevents a single study from having too much
influence on the results when combining multiple studies. For example, if the
probability for a hypothesis from one study is zero, then additional studies
cannot alter this probability (multiplying anything by zero is still zero).</p>
</td></tr>
<tr><td><code id="pph_+3A_epsilon">epsilon</code></td>
<td>
<p>A small value that a posterior hypothesis probability must
fall below before an adjustment is made. Ignored if <code>adjust = FALSE</code>.</p>
</td></tr>
<tr><td><code id="pph_+3A_adj.factor">adj.factor</code></td>
<td>
<p>A small number added to each posterior hypothesis
probability if <code>adjust = TRUE</code> and one of the posterior hypothesis
probabilities is less than <code>epsilon</code>. The PPHs are then re-scaled to sum
to one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Effect sizes could be a mean difference between groups, regression
slope, odds ratio, or other values provided by statistical models. The
standard errors represent the uncertainty in the effect size and are provided
by most statistical software.
</p>
<p>Two types of priors need to be specified. The first is the prior for the
effect size, which is given by a mean (usually zero) and standard error,
which can be specified by the user or calculated automatically. Second, prior
probabilities for each hypothesis need to be provided, and an equal
probability of 1/3 is used by default.
</p>
<p>The null hypothesis (usually effect size = 0) can be specified as either a
point null or as a range. A point null tests if the effect size is
<em>exactly</em> zero while the range null tests if the effect size close
enough to zero for practical purposes. 'Close enough' is defined by the user
as a range on either size of zero.
</p>
<p>To combine multiple effect sizes use the <code>ev.combo</code> function.
</p>


<h3>Value</h3>

<p>Object of class <code>pph</code> which contains the posterior hypothesis
probabilities and other calculated values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.PPH">plot.PPH</a></code>, <code><a href="#topic+ev.combo">ev.combo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># library(labstats) # need to install from CRAN
# plot(time.immob ~ dose, data=fluoxetine) 
# summary(lm(time.immob ~ dose, data=fluoxetine))
x &lt;- pph(beta=-0.25200, se.beta=0.09913) # dose effect from above output
x
</code></pre>

<hr>
<h2 id='summary.PPH'>Print and summary methods for PPH and EV objects</h2><span id='topic+print.EV'></span><span id='topic+print.PPH'></span><span id='topic+summary.EV'></span><span id='topic+summary.PPH'></span>

<h3>Description</h3>

<p>Print and summary methods for PPH and EV objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PPH'
summary(x, digits = 4)

## S3 method for class 'PPH'
print(x, digits = 4)

## S3 method for class 'EV'
summary(x, digits = 4)

## S3 method for class 'EV'
print(x, digits = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.PPH_+3A_x">x</code></td>
<td>
<p>A <code>PPH</code> or <code>EV</code> object.</p>
</td></tr>
<tr><td><code id="summary.PPH_+3A_digits">digits</code></td>
<td>
<p>Number of digits to show.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of posterior hypothesis probabilities and other calculated
values.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
