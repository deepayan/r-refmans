<!DOCTYPE html><html><head><title>Help for package BayesDLMfMRI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesDLMfMRI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesDLMfMRI'><p>Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R</p></a></li>
<li><a href='#.check_ffdgroup'><p>.check_ffdgroup</p></a></li>
<li><a href='#.distanceNeighbors'><p>.distanceNeighbors</p></a></li>
<li><a href='#.ffdGroupVoxelFETS'><p>.ffdGroupVoxelFETS</p></a></li>
<li><a href='#.ffdGroupVoxelFFBS'><p>.ffdGroupVoxelFFBS</p></a></li>
<li><a href='#.ffdGroupVoxelFSTS'><p>.ffdGroupVoxelFSTS</p></a></li>
<li><a href='#.ffdSingleVoxelFETS'><p>.ffdSingleVoxelFSTS</p></a></li>
<li><a href='#.ffdsingleVoxelFFBS'><p>.ffdsingleVoxelFFBS</p></a></li>
<li><a href='#.ffdSingleVoxelFSTS'><p>.ffdSingleVoxelFSTS</p></a></li>
<li><a href='#.get_n_cores'><p>.get_n_cores</p></a></li>
<li><a href='#.validate_input'><p>.validate_input</p></a></li>
<li><a href='#Covariates'><p>Covariates related to the observed BOLD response</p></a></li>
<li><a href='#ffd'><p>MNI image used to plot posterior probability maps in the vignette examples.</p></a></li>
<li><a href='#ffdEvidenceFETS'><p>ffdEvidenceFETS</p></a></li>
<li><a href='#ffdEvidenceFFBS'><p>ffdEvidenceFFBS</p></a></li>
<li><a href='#ffdEvidenceFSTS'><p>ffdEvidenceFSTS</p></a></li>
<li><a href='#ffdGroupEvidenceFETS'><p>ffdGroupEvidenceFETS</p></a></li>
<li><a href='#ffdGroupEvidenceFFBS'><p>ffdGroupEvidenceFFBS</p></a></li>
<li><a href='#ffdGroupEvidenceFSTS'><p>ffdGroupEvidenceFSTS</p></a></li>
<li><a href='#get_example_fMRI_data'><p>get_example_fMRI_data</p></a></li>
<li><a href='#get_example_fMRI_data_group'><p>get_example_fMRI_data_group</p></a></li>
<li><a href='#GroupSingleVoxelFETS'><p>GroupSingleVoxelFETS</p></a></li>
<li><a href='#GroupSingleVoxelFFBS'><p>GroupSingleVoxelFFBS</p></a></li>
<li><a href='#GroupSingleVoxelFSTS'><p>GroupSingleVoxelFSTS</p></a></li>
<li><a href='#mask'><p>A 3D array that works as a brain of reference (MNI atlas).</p></a></li>
<li><a href='#plot.fMRI_single_evidence'><p>plot.fMRI_single_evidence</p></a></li>
<li><a href='#print.fMRI_group_evidence'><p>print.fMRI_group_evidence</p></a></li>
<li><a href='#print.fMRI_group_single_voxel'><p>print.fMRI_group_single_voxel</p></a></li>
<li><a href='#print.fMRI_single_evidence'><p>print.fMRI_single_evidence</p></a></li>
<li><a href='#print.fMRI_single_voxel'><p>print.fMRI_single_voxel</p></a></li>
<li><a href='#SingleVoxelFETS'><p>SingleVoxelFETS</p></a></li>
<li><a href='#SingleVoxelFFBS'><p>SingleVoxelFFBS</p></a></li>
<li><a href='#SingleVoxelFSTS'><p>SingleVoxelFSTS</p></a></li>
<li><a href='#summary.fMRI_group_evidence'><p>summary.fMRI_group_evidence</p></a></li>
<li><a href='#summary.fMRI_single_evidence'><p>summary.fMRI_single_evidence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Analysis for Task-Based Fmri Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-06</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/JohnatanLAB/BayesDLMfMRI/">https://github.com/JohnatanLAB/BayesDLMfMRI/</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carlos Pérez &lt;caaperezag@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'BayesDLMfMRI' package performs statistical analysis for task-based functional magnetic resonance imaging (fMRI) data at both individual and group levels. The analysis to detect brain activation at the individual level is based on modeling the fMRI signal using Matrix-Variate Dynamic Linear Models (MDLM). The analysis for the group stage is based on posterior distributions of the state parameter obtained from the modeling at the individual level. In this way, this package offers several R functions with different algorithms to perform inference on the state parameter to assess brain activation for both individual and group stages. Those functions allow for parallel computation when the analysis is performed for the entire brain as well as analysis at specific voxels when it is required.
             References: Cardona-Jiménez (2021) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>&gt;;
             Cardona-Jiménez (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2111.01318">doi:10.48550/arXiv.2111.01318</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>abind, oro.nifti, neurobase, pbapply, Rcpp (&ge; 1.0.4), Rdpack,
mathjaxr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack, mathjaxr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-07 03:23:27 UTC; carlos</td>
</tr>
<tr>
<td>Author:</td>
<td>Johnatan Cardona-Jiménez [aut],
  Carlos Pérez [cre, aut],
  Isabel Ramírez [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-09 06:02:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesDLMfMRI'>Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R</h2><span id='topic+BayesDLMfMRI'></span><span id='topic+BayesDLMfMRI-package'></span>

<h3>Description</h3>

<p>The 'BayesDLMfMRI' package performs statistical analysis for task-based functional magnetic resonance imaging (fMRI) data at both individual and group levels. The analysis to detect brain activation at the individual level is based on modeling the fMRI signal using Matrix-Variate Dynamic Linear Models (MDLM). The analysis for the group stage is based on posterior distributions of the state parameter obtained from the modeling at the individual level. In this way, this package offers several R functions with different algorithms to perform inference on the state parameter to assess brain activation for both individual and group stages. Those functions allow for parallel computation when the analysis is performed for the entire brain as well as analysis at specific voxels when it is required.
</p>


<h3>Authors</h3>

<p>Maintainer: Carlos Peréz <a href="mailto:caaperezag@unal.edu.co">caaperezag@unal.edu.co</a> <br />
Creator: Johnatan Cardona-Jiménez <a href="mailto:jcardonj@unal.edu.co">jcardonj@unal.edu.co</a> <br />
Contributor: Isabel Ramírez <a href="mailto:iscramirezgu@unal.edu.co">iscramirezgu@unal.edu.co</a>
</p>

<hr>
<h2 id='.check_ffdgroup'>.check_ffdgroup</h2><span id='topic+.check_ffdgroup'></span>

<h3>Description</h3>

<p>validate ffdGroup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_ffdgroup(ffdGroup)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".check_ffdgroup_+3A_ffdgroup">ffdGroup</code></td>
<td>
<p>group</p>
</td></tr>
</table>

<hr>
<h2 id='.distanceNeighbors'>.distanceNeighbors</h2><span id='topic+.distanceNeighbors'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.distanceNeighbors(posi.refer, r1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".distanceNeighbors_+3A_posi.refer">posi.refer</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".distanceNeighbors_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdGroupVoxelFETS'>.ffdGroupVoxelFETS</h2><span id='topic+.ffdGroupVoxelFETS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdGroupVoxelFETS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Test,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_test">Test</code></td>
<td>
<p>test type either &quot;LTT&quot; (Average cluster effect) or &quot;JointTest&quot; (Joint effect).</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFETS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdGroupVoxelFFBS'>.ffdGroupVoxelFFBS</h2><span id='topic+.ffdGroupVoxelFFBS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdGroupVoxelFFBS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFFBS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdGroupVoxelFSTS'>.ffdGroupVoxelFSTS</h2><span id='topic+.ffdGroupVoxelFSTS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdGroupVoxelFSTS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
<tr><td><code id=".ffdGroupVoxelFSTS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdSingleVoxelFETS'>.ffdSingleVoxelFSTS</h2><span id='topic+.ffdSingleVoxelFETS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdSingleVoxelFETS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1,
  Test
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images that are meant to be analyzed. (i,j,k) define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, Min.vol = 0.10 means that all the voxels with values
below to max(ffdc)*Min.vol can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFETS_+3A_test">Test</code></td>
<td>
<p>test type either &quot;LTT&quot; (Average cluster effect) or &quot;JointTest&quot; (Joint effect).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdsingleVoxelFFBS'>.ffdsingleVoxelFFBS</h2><span id='topic+.ffdsingleVoxelFFBS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdsingleVoxelFFBS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images that are meant to be analyzed. (i,j,k) define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, Min.vol = 0.10 means that all the voxels with values
below to max(ffdc)*Min.vol can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id=".ffdsingleVoxelFFBS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.ffdSingleVoxelFSTS'>.ffdSingleVoxelFSTS</h2><span id='topic+.ffdSingleVoxelFSTS'></span>

<h3>Description</h3>

<p>this is an internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ffdSingleVoxelFSTS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images that are meant to be analyzed. (i,j,k) define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at t=0 (m=0 is the default value when no prior information is available). For the case of available prior information, m0 can be defined as a pXr matrix, where p is the number of columns in the covariates object and r is the cluster size.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at t=0 (Cova=100 is the default value when no prior information is available). For the case of available prior information, Cova0 can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at t=0. S0=1 is the default value when no prior information is available and defines an rXr identity matrix. For the case of available prior information, S0 can be defined as an rXr matrix, where r is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, Min.vol = 0.10 means that all the voxels with values
below to max(ffdc)*Min.vol can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id=".ffdSingleVoxelFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>this is an internal function
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>

<hr>
<h2 id='.get_n_cores'>.get_n_cores</h2><span id='topic+.get_n_cores'></span>

<h3>Description</h3>

<p>return the number of cores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_n_cores(Ncores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_n_cores_+3A_ncores">Ncores</code></td>
<td>
<p>numer of cores</p>
</td></tr>
</table>

<hr>
<h2 id='.validate_input'>.validate_input</h2><span id='topic+.validate_input'></span>

<h3>Description</h3>

<p>validate input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.validate_input(
  N1 = NULL,
  Test = NULL,
  Nsimu1 = NULL,
  ffdc = NULL,
  covariates = NULL,
  r1 = NULL,
  delta = NULL,
  perVol = NULL,
  Min.vol = NULL,
  n0 = NULL,
  Cutpos1 = NULL,
  ffdGroup = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".validate_input_+3A_n1">N1</code></td>
<td>
<p>is the number of images (2&lt;N1&lt;T) from the ffdc array employed in the model fitting.N1=NULL (or equivalently N1=T) is its default value, taking all the images in the ffdc array for the fitting process.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_test">Test</code></td>
<td>
<p>test type either &quot;LTT&quot; (Average cluster effect) or &quot;JointTest&quot; (Joint effect).</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (ffdc[i,j,k,t]) that contains the sequence of MRI images that are meant to be analyzed. (i,j,k) define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different r values: r = 0, 1, 2, 3, 4, which leads to q = 1, 7, 19, 27, 33, where q is the size of the cluster.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between 0.85&lt;delta&lt;1. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_pervol">perVol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in the analysis. For example, Min.vol = 0.10 means that all the voxels with values
below to max(ffdc)*perVol can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, Min.vol = 0.10 means that all the voxels with values
below to max(ffdc)*Min.vol can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix S0 at t=0 (n=1 is the default value when no prior information is available). For the case of available prior information, n0 can be set as n0=np, where np is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (30&lt;Cutpos1&lt;T).</p>
</td></tr>
<tr><td><code id=".validate_input_+3A_ffdgroup">ffdGroup</code></td>
<td>
<p>group</p>
</td></tr>
</table>

<hr>
<h2 id='Covariates'>Covariates related to the observed BOLD response</h2><span id='topic+Covariates'></span>

<h3>Description</h3>

<p>Covariates related to the observed BOLD response and its derivative used in the examples presented in the vignettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Covariates
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 310 rows and 2 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("covariates", package="BayesDLMfMRI")
</code></pre>

<hr>
<h2 id='ffd'>MNI image used to plot posterior probability maps in the vignette examples.</h2><span id='topic+ffd'></span>

<h3>Description</h3>

<p>MNI image used to plot posterior probability maps in the examples presented in the vignettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffd
</code></pre>


<h3>Format</h3>

<p>An object of class <code>nifti</code> of dimension 91 x 109 x 91.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ffd", package="BayesDLMfMRI")
</code></pre>

<hr>
<h2 id='ffdEvidenceFETS'>ffdEvidenceFETS</h2><span id='topic+ffdEvidenceFETS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdEvidenceFETS(
  ffdc,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos1 = 30,
  r1 = 1,
  perVol = 0.1,
  Test = "LTT",
  Ncores = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdEvidenceFETS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n0=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_pervol">perVol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*perVol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_test">Test</code></td>
<td>
<p>test type either <code>"LTT"</code> (Average cluster effect) or <code>"JointTest"</code> (Joint effect).</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_ncores">Ncores</code></td>
<td>
<p>a positive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFETS_+3A_seed">seed</code></td>
<td>
<p>random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Every voxel from the 4D array image is clustered with its nearest neighbors. There are as many clusters as voxels in the image. Then, activation maps are obtained by fitting a multivariate dynamic linear model on every cluster of voxels. 
The resulting activation evidence measure for every voxel is obtained using the Forward Estimated Trajectories Sampler (FETS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the type <code>res[[p]][x,y,z]</code>, where <code>p</code> represents the column position in
the covariates matrix and <code>[x,y,z]</code> represent the voxel position in the brain image.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFETS(ffdc = fMRI.data, covariates = Covariates,
                       m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                       n0 = 1, Nsimu1 = 100, Cutpos1 = 30, 
                       r1 = 2, Test = "JointTest",  Ncores = 1)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='ffdEvidenceFFBS'>ffdEvidenceFFBS</h2><span id='topic+ffdEvidenceFFBS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdEvidenceFFBS(
  ffdc,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos1 = 30,
  r1 = 1,
  perVol = 0.1,
  Ncores = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdEvidenceFFBS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the voxel observed at time <code>t</code>.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n0=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_pervol">perVol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*perVol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_ncores">Ncores</code></td>
<td>
<p>a postive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFFBS_+3A_seed">seed</code></td>
<td>
<p>random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Every voxel from the 4D array image is clustered with its nearest neighbors. There are as many clusters as voxels in the image. Then, activation maps are obtained by fitting a multivariate dynamic linear model on every cluster of voxels. The resulting activation evidence measure for every voxel is obtained by using the Forward filtering backward sampling (FFBS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the form <code>res[[k]][p,x,y,z]</code>, where <code>k</code> defines the type of test (<code>k = 1</code> for <code>"Marginal"</code>, <code>k = 2</code> for <code>"JointTest"</code>, and <code>k = 3</code> for <code>"LTT"</code>), <code>p</code> represents the column position in the covariates matrix and <code>x,y,z</code> represent the voxel position in the brain image.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFFBS(ffdc = fMRI.data, covariates = Covariates, m0=0, Cova=100,
                       delta=0.95, S0=1, n0=1, N1=FALSE, 
                       Nsimu1 = 100, Cutpos1=30, r1 = 1,
                       perVol = 0.10, Ncores=3)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='ffdEvidenceFSTS'>ffdEvidenceFSTS</h2><span id='topic+ffdEvidenceFSTS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdEvidenceFSTS(
  ffdc,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos1 = 30,
  r1 = 1,
  perVol = 0.1,
  Ncores = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdEvidenceFSTS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the voxel observed at time <code>t</code>.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where <code>p</code> is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n0=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_pervol">perVol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*perVol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_ncores">Ncores</code></td>
<td>
<p>a positive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
<tr><td><code id="ffdEvidenceFSTS_+3A_seed">seed</code></td>
<td>
<p>random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Every voxel from the 4D array image is clustered with its nearest neighbors. There are as many clusters as voxels in the image. Then, activation maps are obtained by fitting a multivariate dynamic linear model on every cluster of voxels. The resulting activation evidence measure for every voxel is obtained by using the Forward State Trajectories Sampler (FSTS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the form <code>[[k]][p,x,y,z]</code>, where k defines the type of test (<code>k = 1</code> for <code>"Marginal"</code>, <code>k = 2</code> for <code>"JointTest"</code>, and <code>k = 3</code> for <code>"LTT"</code>), <code>p</code> represents the column position in the covariates matrix and <code>x,y,z</code> represent the voxel position in the brain image.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFSTS(ffdc = fMRI.data, covariates = Covariates, m0=0, Cova=100,
                       delta=0.95, S0=1, n0=1, N1=FALSE, 
                       Nsimu1 = 100, Cutpos1=30, r1 = 1,
                       perVol = 0.10, Ncores=3)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='ffdGroupEvidenceFETS'>ffdGroupEvidenceFETS</h2><span id='topic+ffdGroupEvidenceFETS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for group task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdGroupEvidenceFETS(
  ffdGroup,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos = 30,
  r1,
  Test,
  mask,
  Ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_ffdgroup">ffdGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a pXp matrix, where p is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at \(t=0\) (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_r1">r1</code></td>
<td>
<p>positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_test">Test</code></td>
<td>
<p>test type either <code>"LTT"</code> (Average cluster effect) or <code>"JointTest"</code> (Joint effect).</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_mask">mask</code></td>
<td>
<p>a 3D array that works as a brain of reference (MNI atlas) for the group analysis.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFETS_+3A_ncores">Ncores</code></td>
<td>
<p>a positive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A multivariate dynamic linear model is fitted in the same fashion as at the individual level for every subject in the sample. 
However, at this stage, the posterior distributions from all the subjects are combined to build a single one, 
which is then employed to compute the activation evidence maps for the group using Forward estimated trajectories sampler (FETS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of \(2 \times p\) elements, where \(p\) is the number of covariates, and 2 is the number 
of options evaluated as sampler distributions: Average cluster effect and Marginal effect (when <code>Test=="LTT"</code>) or Joint effect and Marginal effect (when <code>Test=="JointTest"</code>). The first <code>p</code> elements from the list are 
the activation maps related to each column of the covariates matrix respectively when computing the activation evidence using either
<code>Test=="LTT"</code> or <code>Test=="JointTest"</code>. The remaining activation maps are those associated with the marginal distribution.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
data("mask", package="BayesDLMfMRI")
res &lt;- ffdGroupEvidenceFETS(ffdGroup = DatabaseGroup, covariates = Covariates, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, N1 = FALSE, Nsimu1 = 100, Cutpos=30, 
                            r1 = 1, Test = "JointTest", mask = mask, Ncores = 7)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='ffdGroupEvidenceFFBS'>ffdGroupEvidenceFFBS</h2><span id='topic+ffdGroupEvidenceFFBS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for group task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdGroupEvidenceFFBS(
  ffdGroup,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos = 30,
  r1,
  mask,
  Ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_ffdgroup">ffdGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at \(t=0\) (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_r1">r1</code></td>
<td>
<p>positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_mask">mask</code></td>
<td>
<p>a 3D array that works as a brain of reference (MNI atlas) for the group analysis.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFFBS_+3A_ncores">Ncores</code></td>
<td>
<p>a postive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A multivariate dynamic linear model is fitted in the same fashion as at the individual level for every subject in the sample. 
However, at this stage, the posterior distributions from all the subjects are combined to build a single one, 
which is then employed to compute the activation evidence maps for the group using the Forward Filtering Backward Sampling (FFBS) algorithm. To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the form <code>[[k]][p,x,y,z]</code>, where k defines the type of test
(<code>k = 1</code> for Marginal effect, <code>k = 2</code> for Joint effect, and <code>k = 3</code> for Average cluster effect), <code>p</code> represents the column 
position in the covariates matrix and <code>x,y,z</code> represent the voxel position in the brain image.
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdGroupEvidenceFFBS(ffdGroup = DatabaseGroup, covariates = Covariates, 
                            m0=0, Cova=100, delta = 0.95, 
                            S0 = 1, n0 = 1, N1 = FALSE, Nsimu1 = 100,
                            Cutpos = 30, r1 = 1, mask = MASK, Ncores = 7)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='ffdGroupEvidenceFSTS'>ffdGroupEvidenceFSTS</h2><span id='topic+ffdGroupEvidenceFSTS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function can be used to build activation maps for group task-based fMRI data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffdGroupEvidenceFSTS(
  ffdGroup,
  covariates,
  m0 = 0,
  Cova = 100,
  delta = 0.95,
  S0 = 1,
  n0 = 1,
  N1 = FALSE,
  Nsimu1 = 100,
  Cutpos = 30,
  r1,
  mask,
  Ncores = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_ffdgroup">ffdGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_mask">mask</code></td>
<td>
<p>3D array that works as a brain of reference (MNI atlas) for the group analysis.</p>
</td></tr>
<tr><td><code id="ffdGroupEvidenceFSTS_+3A_ncores">Ncores</code></td>
<td>
<p>a postive integer indicating the number of threads or cores to be used in the computation of the activation maps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A multivariate dynamic linear model is fitted in the same fashion as at the individual level for every subject in the sample. 
However, at this stage, the posterior distributions from all the subjects are combined to build a single one, 
which is then employed to compute the activation evidence maps for the group using the Forward State Trajectories Sampler (FSTS) algorithm To deeply understand the method implemented in this package, a reading of (Cardona-Jiménez and de B. Pereira 2021) and (Cardona-Jiménez 2021) is mandatory.
</p>


<h3>Value</h3>

<p>It returns a list of the form <code>[[k]][p,x,y,z]</code>, where <code>k</code> defines the type of test
(<code>k = 1</code> for Marginal effect, <code>k = 2</code> for Joint effect, and <code>k = 3</code> for Average cluster effect), <code>p</code> represents the column 
position in the covariates matrix and <code>x,y,z</code> represent the voxel position in the brain image.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdGroupEvidenceFSTS(ffdGroup = DatabaseGroup, covariates = Covariates, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, N1 = FALSE, Nsimu1 = 100, Cutpos=30, 
                            r1 = 1, mask = MASK, Ncores = 7)
str(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_example_fMRI_data'>get_example_fMRI_data</h2><span id='topic+get_example_fMRI_data'></span>

<h3>Description</h3>

<p>This function is used to download the example data used in the Vignettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_example_fMRI_data(save_path = NULL, force = FALSE, subject = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_example_fMRI_data_+3A_save_path">save_path</code></td>
<td>
<p>location where the data the example data is stored.</p>
</td></tr>
<tr><td><code id="get_example_fMRI_data_+3A_force">force</code></td>
<td>
<p>force the download, even if the data already exists.</p>
</td></tr>
<tr><td><code id="get_example_fMRI_data_+3A_subject">subject</code></td>
<td>
<p>The example subject, must be 1 or 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data for this example is related to an fMRI experiment where a sound stimulus is presented. 
That experiment is intended to offer a &quot;voice localizer&quot; scan, which allows rapid and reliable 
localization of the voice-sensitive &quot;temporal voice areas&quot; (TVA) of the human auditory cortex
(Pernet et al. 2015). The data of this &quot;voice localizer&quot; scan is freely  
available on the online platform OpenNEURO (Gorgolewski et al. 2017).
</p>


<h3>Value</h3>

<p>It returns an array of dimensions <code>[91, 109, 91, 310]</code>.
</p>


<h3>References</h3>

<p>Pernet CR, McAleer P, Latinus M, Gorgolewski KJ, Charest I, Bestelmeyer PE, Watson RH, Fleming D, Crabbe F, Valdes-Sosa M, others (2015).
&ldquo;The human voice areas: Spatial organization and inter-individual variability in temporal and extra-temporal cortices.&rdquo;
<em>Neuroimage</em>, <b>119</b>, 164&ndash;174.
</p>
<p>Gorgolewski K, Esteban O, Schaefer G, Wandell B, Poldrack R (2017).
&ldquo;OpenNeuro - a free online platform for sharing and analysis of neuroimaging data.&rdquo;
<em>Organization for Human Brain Mapping. Vancouver, Canada</em>, <b>1677</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
fMRI.data  &lt;- get_example_fMRI_data()

## End(Not run)
</code></pre>

<hr>
<h2 id='get_example_fMRI_data_group'>get_example_fMRI_data_group</h2><span id='topic+get_example_fMRI_data_group'></span>

<h3>Description</h3>

<p>This function is used to download the example data used in the Vignettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_example_fMRI_data_group(save_path = NULL, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_example_fMRI_data_group_+3A_save_path">save_path</code></td>
<td>
<p>location where the data the example data is stored.</p>
</td></tr>
<tr><td><code id="get_example_fMRI_data_group_+3A_force">force</code></td>
<td>
<p>force the download, even if the data already exists.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data for this example is related to an fMRI experiment where a sound stimulus is presented. 
That experiment is intended to offer a &quot;voice localizer&quot; scan, which allows rapid and reliable 
localization of the voice-sensitive &quot;temporal voice areas&quot; (TVA) of the human auditory cortex
(Pernet et al. 2015). The data of this &quot;voice localizer&quot; scan is freely  
available on the online platform OpenNEURO (Gorgolewski et al. 2017).
</p>


<h3>Value</h3>

<p>It returns a list in which each element is an array of dimensions <code>[91, 109, 91, 310]</code>.
</p>


<h3>References</h3>

<p>Pernet CR, McAleer P, Latinus M, Gorgolewski KJ, Charest I, Bestelmeyer PE, Watson RH, Fleming D, Crabbe F, Valdes-Sosa M, others (2015).
&ldquo;The human voice areas: Spatial organization and inter-individual variability in temporal and extra-temporal cortices.&rdquo;
<em>Neuroimage</em>, <b>119</b>, 164&ndash;174.
</p>
<p>Gorgolewski K, Esteban O, Schaefer G, Wandell B, Poldrack R (2017).
&ldquo;OpenNeuro - a free online platform for sharing and analysis of neuroimaging data.&rdquo;
<em>Organization for Human Brain Mapping. Vancouver, Canada</em>, <b>1677</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()

## End(Not run)
</code></pre>

<hr>
<h2 id='GroupSingleVoxelFETS'>GroupSingleVoxelFETS</h2><span id='topic+GroupSingleVoxelFETS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform a group activation analysis for single voxels based on the FETS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GroupSingleVoxelFETS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Test,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GroupSingleVoxelFETS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p \times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q \times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_test">Test</code></td>
<td>
<p>test type either <code>"LTT"</code> (Average cluster effect) or <code>"JointTest"</code> (Joint effect).</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFETS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the performance of a group activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location <code>(i,j,k)</code>, in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (Evidence) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses, \(\hat{Y}\)ascii.
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t | \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
resSingle &lt;- GroupSingleVoxelFETS(posi.ffd = c(14, 56, 40), DatabaseGroup,
                                  covariates = Covariates, m0 = 0, Cova = 100, 
                                  delta = 0.95, S0 = 1, n0 = 1, N1 = FALSE, 
                                  Nsimu1 = 100, r1 = 1, Test = "JointTest", Cutpos = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='GroupSingleVoxelFFBS'>GroupSingleVoxelFFBS</h2><span id='topic+GroupSingleVoxelFFBS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform a group activation analysis for single voxels based on the FFBS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GroupSingleVoxelFFBS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m0=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p \times p\) matrix, where <code>p</code> is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>, <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFFBS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the performance of a group activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location (i,j,k), in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (<code>Evidence</code>) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
resSingle &lt;- GroupSingleVoxelFFBS(posi.ffd = c(14, 56, 40), DatabaseGroup,
                                  covariates = Covariates, m0 = 0, Cova = 100, 
                                  delta = 0.95, S0 = 1, n0 = 1, N1 = FALSE, 
                                  Nsimu1 = 100, r1 = 1, Cutpos = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='GroupSingleVoxelFSTS'>GroupSingleVoxelFSTS</h2><span id='topic+GroupSingleVoxelFSTS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform a group activation analysis for single voxels based on the FSTS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GroupSingleVoxelFSTS(
  posi.ffd,
  DatabaseGroup,
  covariates,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  r1,
  Cutpos
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_databasegroup">DatabaseGroup</code></td>
<td>
<p>list of N elements, each being a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images related to each of the N subjects in the sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m0=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where <code>p</code> is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure between pair of voxels within every cluster at <code>t=0</code>, <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the ffdc array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="GroupSingleVoxelFSTS_+3A_cutpos">Cutpos</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the performance of a group activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location (i,j,k), in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (<code>Evidence</code>) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
resSingle &lt;- GroupSingleVoxelFSTS(posi.ffd = c(14, 56, 40), DatabaseGroup,
                                  covariates = Covariates, m0 = 0, Cova = 100, 
                                  delta = 0.95, S0 = 1, n0 = 1, N1 = FALSE, 
                                  Nsimu1 = 100, r1 = 1, Cutpos = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='mask'>A 3D array that works as a brain of reference (MNI atlas).</h2><span id='topic+mask'></span>

<h3>Description</h3>

<p>A 3D array that works as a brain of reference (MNI atlas) for the group analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mask
</code></pre>


<h3>Format</h3>

<p>An object of class <code>nifti</code> of dimension 91 x 109 x 91.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("mask", package="BayesDLMfMRI")
</code></pre>

<hr>
<h2 id='plot.fMRI_single_evidence'>plot.fMRI_single_evidence</h2><span id='topic+plot.fMRI_single_evidence'></span>

<h3>Description</h3>

<p>Plot function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_single_evidence'
plot(x, overlay, index, index2 = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fMRI_single_evidence_+3A_x">x</code></td>
<td>
<p>is the returned value of any of the ffdEvidence* functions.</p>
</td></tr>
<tr><td><code id="plot.fMRI_single_evidence_+3A_overlay">overlay</code></td>
<td>
<p>MNI image used to plot posterior probability maps.</p>
</td></tr>
<tr><td><code id="plot.fMRI_single_evidence_+3A_index">index</code></td>
<td>
<p>the element of <code>res</code> to be plotted.</p>
</td></tr>
<tr><td><code id="plot.fMRI_single_evidence_+3A_index2">index2</code></td>
<td>
<p>the element of <code>res</code> to be plotted, only used if needed.</p>
</td></tr>
<tr><td><code id="plot.fMRI_single_evidence_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the <code>ortho2</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
data("ffd", package="BayesDLMfMRI") # used for overlay.
res &lt;- ffdEvidenceFETS(ffdc = fMRI.data,
                   covariates = Covariates,
                   m0 = 0, Cova = 100, delta = 0.95,
                   S0 = 1, n0 = 1, Nsimu1 = 100, Cutpos1 = 30,
                   r1 = 1, Test = "LTT", Ncores = 15)
plot(res, overlay=ffd, index=1, col.y = heat.colors(50), 
     ycolorbar = TRUE, ybreaks = seq(0.95, 1, by = 0.001))

## End(Not run)
</code></pre>

<hr>
<h2 id='print.fMRI_group_evidence'>print.fMRI_group_evidence</h2><span id='topic+print.fMRI_group_evidence'></span>

<h3>Description</h3>

<p>Print the structure of the object related to the ffdGroupEvidence* functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_group_evidence'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fMRI_group_evidence_+3A_x">x</code></td>
<td>
<p>is the returned value of any of the ffdGroupEvidence* functions</p>
</td></tr>
<tr><td><code id="print.fMRI_group_evidence_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the structure of the object related to the ffdGroupEvidence* functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
data("mask", package="BayesDLMfMRI")
res &lt;- ffdGroupEvidenceFETS(ffdGroup = DatabaseGroup, covariates = Covariates, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, N1 = FALSE, Nsimu1 = 100, Cutpos=30, 
                            r1 = 1, Test = "JointTest", mask = mask, Ncores = 7)
print(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.fMRI_group_single_voxel'>print.fMRI_group_single_voxel</h2><span id='topic+print.fMRI_group_single_voxel'></span>

<h3>Description</h3>

<p>Print the structure of the object related to the SingleVoxel* functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_group_single_voxel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fMRI_group_single_voxel_+3A_x">x</code></td>
<td>
<p>is the returned value of any of the GroupSingleVoxel* functions</p>
</td></tr>
<tr><td><code id="print.fMRI_group_single_voxel_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the structure of the object related to the GroupSingleVoxel* functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
res &lt;- GroupSingleVoxelFFBS(posi.ffd = c(14, 56, 40), DatabaseGroup,
                            covariates = Covariates, m0 = 0, Cova = 100, 
                            delta = 0.95, S0 = 1, n0 = 1, N1 = FALSE, 
                            Nsimu1 = 100, r1 = 1, Cutpos = 30)
print(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.fMRI_single_evidence'>print.fMRI_single_evidence</h2><span id='topic+print.fMRI_single_evidence'></span>

<h3>Description</h3>

<p>Print the structure of the object related to the ffdEvidence* functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_single_evidence'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fMRI_single_evidence_+3A_x">x</code></td>
<td>
<p>is the returned value of any of the ffdEvidence* functions</p>
</td></tr>
<tr><td><code id="print.fMRI_single_evidence_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the structure of the object related to the ffdEvidence* functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFFBS(ffdc = fMRI.data, covariates = Covariates, m0=0, Cova=100,
                       delta=0.95, S0=1, n0=1, N1=FALSE, 
                       Nsimu1 = 100, Cutpos1=30, r1 = 1,
                       perVol = 0.10, Ncores=3)
print(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.fMRI_single_voxel'>print.fMRI_single_voxel</h2><span id='topic+print.fMRI_single_voxel'></span>

<h3>Description</h3>

<p>Print the structure of the object related to the SingleVoxel* functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_single_voxel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fMRI_single_voxel_+3A_x">x</code></td>
<td>
<p>is the returned value of any of the SingleVoxel* functions,</p>
</td></tr>
<tr><td><code id="print.fMRI_single_voxel_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print the structure of the object related to the SingleVoxel* functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res.indi &lt;- SingleVoxelFSTS(posi.ffd = c(14, 56, 40), 
                            covariates = Covariates,
                            ffdc =  fMRI.data, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, Nsimu1 = 100, N1 = N1, Cutpos1 = 30, 
                            Min.vol = 0.10, r1 = 1)
print(res.indi)

## End(Not run)
</code></pre>

<hr>
<h2 id='SingleVoxelFETS'>SingleVoxelFETS</h2><span id='topic+SingleVoxelFETS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform an activation analysis for single voxels based on the FETS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SingleVoxelFETS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1,
  Test
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SingleVoxelFETS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p \times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*Min.vol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
<tr><td><code id="SingleVoxelFETS_+3A_test">Test</code></td>
<td>
<p>test type either <code>"LTT"</code> (Average cluster effect) or <code>"JointTest"</code> (Joint effect).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the development of an activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location <code>(i,j,k)</code>, in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (Evidence) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res.indi &lt;- SingleVoxelFETS(posi.ffd = c(14, 56, 40), 
                            covariates = Covariates,
                            ffdc =  fMRI.data, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, Nsimu1 = 100, N1 = FALSE, Cutpos1 = 30, 
                            Min.vol = 0.10, r1 = 1, Test = "LTT")


## End(Not run)
</code></pre>

<hr>
<h2 id='SingleVoxelFFBS'>SingleVoxelFFBS</h2><span id='topic+SingleVoxelFFBS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform an activation analysis for single voxels based on the FFBS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SingleVoxelFFBS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SingleVoxelFFBS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the observed voxel at time t.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p\times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. delta=1 will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q\times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q\times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n1=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*Min.vol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="SingleVoxelFFBS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the development of an activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location (i,j,k), in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (Evidence) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res.indi &lt;- SingleVoxelFFBS(posi.ffd = c(14, 56, 40), 
                            covariates = Covariates,
                            ffdc =  fMRI.data, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, Nsimu1 = 100, N1 = FALSE, Cutpos1 = 30, 
                            Min.vol = 0.10, r1 = 1)


## End(Not run)
</code></pre>

<hr>
<h2 id='SingleVoxelFSTS'>SingleVoxelFSTS</h2><span id='topic+SingleVoxelFSTS'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>This function is used to perform an activation analysis for single voxels based on the FSTS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SingleVoxelFSTS(
  posi.ffd,
  covariates,
  ffdc,
  m0,
  Cova,
  delta,
  S0,
  n0,
  N1,
  Nsimu1,
  Cutpos1,
  Min.vol,
  r1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SingleVoxelFSTS_+3A_posi.ffd">posi.ffd</code></td>
<td>
<p>the position of the voxel in the brain image.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_covariates">covariates</code></td>
<td>
<p>a data frame or matrix whose columns contain the covariates related to the expected BOLD response obtained from the experimental setup.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_ffdc">ffdc</code></td>
<td>
<p>a 4D array (<code>ffdc[i,j,k,t]</code>) that contains the sequence of MRI images that are meant to be analyzed. <code>(i,j,k)</code> define the position of the voxel observed at time <code>t</code>.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_m0">m0</code></td>
<td>
<p>the constant prior mean value for the covariates parameters and common to all voxels within every neighborhood at <code>t=0</code> (<code>m0=0</code> is the default value when no prior information is available). For the case of available prior information, <code>m0</code> can be defined as a \(p\times q\) matrix, where \(p\) is the number of columns in the covariates object and \(q\) is the cluster size.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_cova">Cova</code></td>
<td>
<p>a positive constant that defines the prior variances for the covariates parameters at <code>t=0</code> (<code>Cova=100</code> is the default value when no prior information is available). For the case of available prior information, <code>Cova</code> can be defined as a \(p \times p\) matrix, where \(p\) is the number of columns in the covariates object.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_delta">delta</code></td>
<td>
<p>a discount factor related to the evolution variances. Recommended values between <code>0.85&lt;delta&lt;1</code>. <code>delta=1</code> will yield results similar to the classical general linear model.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_s0">S0</code></td>
<td>
<p>prior covariance structure among voxels within every cluster at <code>t=0</code>. <code>S0=1</code> is the default value when no prior information is available and defines an \(q \times q\) identity matrix. For the case of available prior information, <code>S0</code> can be defined as an \(q \times q\) matrix, where \(q\) is the common number of voxels in every cluster.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_n0">n0</code></td>
<td>
<p>a positive hyperparameter of the prior distribution for the covariance matrix <code>S0</code> at <code>t=0</code> (<code>n=1</code> is the default value when no prior information is available). For the case of available prior information, <code>n0</code> can be set as <code>n0=np</code>, where <code>np</code> is the number of MRI images in the pilot sample.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_n1">N1</code></td>
<td>
<p>is the number of images (<code>2&lt;N1&lt;T</code>) from the <code>ffdc</code> array employed in the model fitting. <code>N1=NULL</code> (or equivalently <code>N1=T</code>) is its default value, taking all the images in the <code>ffdc</code> array for the fitting process.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_nsimu1">Nsimu1</code></td>
<td>
<p>is the number of simulated on-line trajectories related to the state parameters. These simulated curves are later employed to compute the posterior probability of voxel activation.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_cutpos1">Cutpos1</code></td>
<td>
<p>a cutpoint time from where the on-line trajectories begin. This parameter value is related to an approximation from a t-student distribution to a normal distribution. Values equal to or greater than 30 are recommended (<code>30&lt;Cutpos1&lt;T</code>).</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_min.vol">Min.vol</code></td>
<td>
<p>helps to define a threshold for the voxels considered in
the analysis. For example, <code>Min.vol = 0.10</code> means that all the voxels with values
below to <code>max(ffdc)*Min.vol</code> can be considered irrelevant and discarded from the analysis.</p>
</td></tr>
<tr><td><code id="SingleVoxelFSTS_+3A_r1">r1</code></td>
<td>
<p>a positive integer number that defines the distance from every voxel with its most distant neighbor. This value determines the size of the cluster. The users can set a range of different <code>r1</code> values: \(r1 = 0, 1, 2, 3, 4\), which leads to \(q = 1, 7, 19, 27, 33\), where \(q\) is the size of the cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the development of an activation analysis for single voxels. A multivariate dynamic linear model is fitted to a cluster of voxels, with its center at location <code>(i,j,k)</code>, in the way it is presented in (Cardona-Jiménez and de B. Pereira 2021).
</p>


<h3>Value</h3>

<p>a list containing a vector (Evidence) with the evidence measure of 
activation for each of the <code>p</code> covariates considered in the model, the simulated 
online trajectories related to the state parameter, the simulated BOLD responses,
and a measure to examine the goodness of fit of the model \((100 \ast |Y[i,j,k]_t - \hat{Y}[i,j,k]_t |/ \hat{Y}[i,j,k]_t )\) for that particular voxel (<code>FitnessV</code>).
</p>


<h3>References</h3>

<p>Cardona-Jiménez J, de B. Pereira CA (2021).
&ldquo;Assessing dynamic effects on a Bayesian matrix-variate dynamic linear model: An application to task-based fMRI data analysis.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>163</b>, 107297.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107297">doi:10.1016/j.csda.2021.107297</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947321001316">https://www.sciencedirect.com/science/article/pii/S0167947321001316</a>.
</p>
<p>Cardona-Jiménez J (2021).
&ldquo;BayesDLMfMRI: Bayesian Matrix-Variate Dynamic Linear Models for Task-based fMRI Modeling in R.&rdquo;
<em>arXiv e-prints</em>, arXiv&ndash;2111.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This example can take a long time to run.
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res.indi &lt;- SingleVoxelFSTS(posi.ffd = c(14, 56, 40), 
                            covariates = Covariates,
                            ffdc =  fMRI.data, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, Nsimu1 = 100, N1 = FALSE, Cutpos1 = 30, 
                            Min.vol = 0.10, r1 = 1)


## End(Not run)
</code></pre>

<hr>
<h2 id='summary.fMRI_group_evidence'>summary.fMRI_group_evidence</h2><span id='topic+summary.fMRI_group_evidence'></span>

<h3>Description</h3>

<p>Summary function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_group_evidence'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fMRI_group_evidence_+3A_object">object</code></td>
<td>
<p>is the returned value of any of the fdGroupEvidence* functions</p>
</td></tr>
<tr><td><code id="summary.fMRI_group_evidence_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summary function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
DatabaseGroup &lt;- get_example_fMRI_data_group()
data("covariates", package="BayesDLMfMRI")
data("mask", package="BayesDLMfMRI")
res &lt;- ffdGroupEvidenceFETS(ffdGroup = DatabaseGroup, covariates = Covariates, 
                            m0 = 0, Cova = 100, delta = 0.95, S0 = 1, 
                            n0 = 1, N1 = FALSE, Nsimu1 = 100, Cutpos=30, 
                            r1 = 1, Test = "JointTest", mask = mask, Ncores = 7)
summary(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.fMRI_single_evidence'>summary.fMRI_single_evidence</h2><span id='topic+summary.fMRI_single_evidence'></span>

<h3>Description</h3>

<p>Summary function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fMRI_single_evidence'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fMRI_single_evidence_+3A_object">object</code></td>
<td>
<p>is the returned value of any of the ffdEvidence* functions</p>
</td></tr>
<tr><td><code id="summary.fMRI_single_evidence_+3A_...">...</code></td>
<td>
<p>Other potential arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summary function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
fMRI.data  &lt;- get_example_fMRI_data()
data("covariates", package="BayesDLMfMRI")
res &lt;- ffdEvidenceFFBS(ffdc = fMRI.data, covariates = Covariates, m0=0, Cova=100,
                       delta=0.95, S0=1, n0=1, N1=FALSE, 
                       Nsimu1 = 100, Cutpos1=30, r1 = 1,
                       perVol = 0.10, Ncores=3)
summary(res)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
