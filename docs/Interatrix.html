<!DOCTYPE html><html><head><title>Help for package Interatrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Interatrix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chi2Corr'><p>Searches for parasite interactions taking risk factors into account.</p></a></li>
<li><a href='#chi2CorrAge'><p>Searches for parasite interactions taking the cumulative effect of age and other risk factors into account.</p></a></li>
<li><a href='#dataInteratrix'><p>A generated data set for test</p></a></li>
<li><a href='#Interatrix-internal'><p>Internal functions for the Interatrix package.</p></a></li>
<li><a href='#InteratrixGUI'><p>Function to start the graphical interface</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute Chi-Square Measures with Corrections</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Aurélie Siberchicot, Eléonore Hellard, Dominique Pontier, David Fouchet and Franck Sauvage</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurélie Siberchicot &lt;aurelie.siberchicot@univ-lyon1.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Chi-square tests are computed with corrections.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, MASS, stats, tcltk, tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doParallel, foreach</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lbbe-software/Interatrix">https://github.com/lbbe-software/Interatrix</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lbbe-software/Interatrix/issues">https://github.com/lbbe-software/Interatrix/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-19 10:44:16 UTC; siberchicot</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-19 11:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='chi2Corr'>Searches for parasite interactions taking risk factors into account.</h2><span id='topic+chi2Corr'></span>

<h3>Description</h3>

<p>This function implements a method to correct for shared risk factors in the search for interactions.
It provides the observed chi-square value, a measure of association between two parasites, and simulates bootstrapped data taking risk factors into account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi2Corr(formula, data.obs, namepara1, namepara2, nsimu)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi2Corr_+3A_formula">formula</code></td>
<td>
<p>a string of characters indicating a symbolic description of the model of shared risk factors to be fitted without any response variable</p>
</td></tr>
<tr><td><code id="chi2Corr_+3A_data.obs">data.obs</code></td>
<td>
<p>the name of the data set to be used</p>
</td></tr>
<tr><td><code id="chi2Corr_+3A_namepara1">namepara1</code></td>
<td>
<p>the name of the column giving the status to the first parasite</p>
</td></tr>
<tr><td><code id="chi2Corr_+3A_namepara2">namepara2</code></td>
<td>
<p>the name of the column giving the status to the second parasite</p>
</td></tr>
<tr><td><code id="chi2Corr_+3A_nsimu">nsimu</code></td>
<td>
<p>an integer indicating the number of repetitions for the bootstrap simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list containing:
</p>
<table>
<tr><td><code>formula</code></td>
<td>
<p>the model fitted without any response variable</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>duration in seconds of the simulations</p>
</td></tr>
<tr><td><code>chi2.corr.obs</code></td>
<td>
<p>the Pearson's chi2 statistic calculated on <code>data.obs</code></p>
</td></tr>
<tr><td><code>dispcoeff</code></td>
<td>
<p>the estimated coefficient of over- (or under-) dispersion, defined as the mean of the bootstrapped values of the corrected chi-square.</p>
</td></tr>
<tr><td><code>pval1</code></td>
<td>
<p>p-value of the corrected chi-square test under the null hypothesis of independence of the two parasites. 
<code>pval1</code> was estimated assuming that the corrected chi-square is proportional to a chi-square with one degree of freedom.</p>
</td></tr>
<tr><td><code>pval2</code></td>
<td>
<p>p-value of the corrected chi-square test under the null hypothesis of independence of the two parasites.
<code>pval2</code> was given by the proportion of bootstrapped corrected chi-squares smaller than the observed value (<code>chi2.corr.obs</code>).</p>
</td></tr>
<tr><td><code>tab.th</code></td>
<td>
<p>expected frequencies, ie. the contingency table calculated on the theoretical (bootstrapped) data</p>
</td></tr>       
<tr><td><code>tab.obs</code></td>
<td>
<p>observed frequencies, ie. the contingency table calculated on <code>data.obs</code></p>
</td></tr>
<tr><td><code>chi2.corr.sim</code></td>
<td>
<p>a vector containing the <code>nsimu</code> Pearson's chi2 statistics calculated on simulated data.</p>
</td></tr>
</table>
<p>The distribution of the bootstrapped corrected chi-squares (an histogram) is also provided.
</p>


<h3>Note</h3>

<p><code>pval2</code> is better than <code>pval1</code> but requires running enough simulations, wich may be long in some cases. <code>pval1</code> allows working with smaller numbers of simualtions when simulation times are too long.
</p>


<h3>References</h3>

<p>True versus False Parasite Interactions: A Robust Method to Take Risk Factors into Account and Its Application to Feline Viruses. Hellard E., Pontier D., Sauvage F., Poulet H. and Fouchet D. (2012). PLoS ONE 7(1): e29618. doi:10.1371/journal.pone.0029618.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(Interatrix)
  data(dataInteratrix)
  res1 &lt;- chi2Corr("F1+F2*F3+F4", dataInteratrix, "Parasite1", "Parasite2", 500)

## End(Not run)
</code></pre>

<hr>
<h2 id='chi2CorrAge'>Searches for parasite interactions taking the cumulative effect of age and other risk factors into account.</h2><span id='topic+chi2CorrAge'></span>

<h3>Description</h3>

<p>This function implements a method to correct for the cumulative effect of age and for other potentially confounding risk factors in the search for interactions.
It provides the observed chi-square value, a measure of the association between two parasites, and simulates bootstrapped data taking risk factors into account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chi2CorrAge(formula, data.obs, namepara1, namepara2, nameage, w1, w2, mort, a, 
nsimu, nbcore = 3)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chi2CorrAge_+3A_formula">formula</code></td>
<td>
<p>a string of characters indicating a symbolic description of the model of shared risk factors (including age) to be fitted without any response variable</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_data.obs">data.obs</code></td>
<td>
<p>the name of the data set to be used</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_namepara1">namepara1</code></td>
<td>
<p>the name of the column giving the status to the first parasite</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_namepara2">namepara2</code></td>
<td>
<p>the name of the column giving the status to the second parasite</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_nameage">nameage</code></td>
<td>
<p>the column name of the age classes</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_w1">w1</code></td>
<td>
<p>a real number between 0 and 1 indicating the antibodies' disappearance rate of the first studied parasite</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_w2">w2</code></td>
<td>
<p>a real number between 0 and 1 indicating the antibodies' disappearance rate of the second studied parasite</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_mort">mort</code></td>
<td>
<p>a vector of real numbers between 0 and 1 giving the mortality rates of all age classes</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_a">a</code></td>
<td>
<p>a vector of integers giving the bounds of the age classes</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_nsimu">nsimu</code></td>
<td>
<p>an integer indicating the number of repetitions for the bootstrap simulation</p>
</td></tr>
<tr><td><code id="chi2CorrAge_+3A_nbcore">nbcore</code></td>
<td>
<p>an integer indicating the number of cores available on the computer to set up a parallel calculation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list containing:
</p>
<table>
<tr><td><code>formula</code></td>
<td>
<p>the model fitted without any response variable</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>duration in seconds of the simulations</p>
</td></tr>
<tr><td><code>nbcore</code></td>
<td>
<p>the number of cores used for parallel simulations</p>
</td></tr>
<tr><td><code>chi2.corr.obs</code></td>
<td>
<p>the Pearson's chi2 statistic calculated on <code>data.obs</code></p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-value of the corrected chi-square test under the null hypothesis of independence of the two parasites.
<code>pval</code> was given by the proportion of bootstrapped corrected chi-squares smaller than the observed value (<code>chi2.corr.obs</code>).</p>
</td></tr>
<tr><td><code>tab.th</code></td>
<td>
<p>expected frequencies, ie. the contingency table calculated on the theoretical (bootstrapped) data</p>
</td></tr>       
<tr><td><code>tab.obs</code></td>
<td>
<p>observed frequencies, ie. the contingency table calculated on <code>data.obs</code></p>
</td></tr>
<tr><td><code>chi2.corr.sim</code></td>
<td>
<p>a vector containing the <code>nsimu</code> Pearson's chi2 statistics calculated on simulated data.</p>
</td></tr>
</table>
<p>The distribution of the bootstrapped corrected chi-squares (an histogram) is also provided.
</p>


<h3>References</h3>

<p>Unknown age in health disorders: a method to account for its cumulative effect and an application to feline viruses interactions. Hellard E., Pontier D., Siberchicot A., Sauvage F. and Fouchet D. (2015). Epidemics 11: 48-55. doi:10.1016/j.epidem.2015.02.004.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  library(Interatrix)
  data(dataInteratrix)
  res2 &lt;- chi2CorrAge("F1+F2+AGE", dataInteratrix, "Parasite1", "Parasite2", "AGE", w1 = 0, 
    w2 = 0, mort = c(0.2, 0.2, 0.2), a = c(0, 1, 2, 10), nsimu = 500, nbcore = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='dataInteratrix'>A generated data set for test</h2><span id='topic+dataInteratrix'></span>

<h3>Description</h3>

<p>A generated data set provided to test the <code>Interatrix</code> package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataInteratrix)</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations for the following variables:
</p>

<dl>
<dt><code>F1</code></dt><dd><p>a numeric vector containing a factor with three modalities</p>
</dd>
<dt><code>F2</code></dt><dd><p>a numeric vector containing a continuous variable</p>
</dd>
<dt><code>F3</code></dt><dd><p>a numeric vector containing a factor with two modalities</p>
</dd>
<dt><code>F4</code></dt><dd><p>a numeric vector containing a continuous variable</p>
</dd>
<dt><code>Parasite1</code></dt><dd><p>a numeric vector containing the serological status to the first parasite</p>
</dd>
<dt><code>Parasite2</code></dt><dd><p>a numeric vector containing the serological status to the second parasite</p>
</dd>
<dt><code>AGE</code></dt><dd><p>a numeric vector containing a factor with three modalities indicating the age classes</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(dataInteratrix)</code></pre>

<hr>
<h2 id='Interatrix-internal'>Internal functions for the Interatrix package.</h2><span id='topic+list2ascii'></span><span id='topic+obsdata_chi2corr'></span><span id='topic+chi2corrboot'></span><span id='topic+simudata_chi2corr'></span><span id='topic+SensTransMatrix'></span><span id='topic+EstimParam'></span><span id='topic+ModelClass'></span><span id='topic+calcInfectProba'></span><span id='topic+obsdata_chi2corrage'></span><span id='topic+simudata_chi2corrage'></span>

<h3>Description</h3>

<p>Internal functions for the Interatrix package.</p>


<h3>Details</h3>

<p>list2ascii(x,file = paste(deparse(substitute(x)), &quot;.txt&quot;, sep = &quot;&quot;))<br />
<br />
## internal functions for chi2Corr() and chi2CorrGUI()<br />
obsdata_chi2corr(formula, data, name1, name2)<br />
chi2corrboot(data, formula, sero1, sero2)<br />
simudata_chi2corr(formula, data, name1, name2, nbsimu, pvir1, pvir2, chi2corrobs)<br />
<br />
## internal functions for chi2CorrAge() and chi2CorrAgeGUI()<br />
SensTransMatrix(para, listmodel, rate, agenum, a)<br />
EstimParam(paranum, rate, listmodel, agenum, v0, tol = 0.00000001, maxit = 50000, a, mort)<br />
ModelClass(para, formula, data, agemax, nameage)<br />
calcInfectProba(data, formula, namepara1, namepara2, nameage, w1, w2, mort, a, v0para1, v0para2)<br />
obsdata_chi2corrage(formula, data, name1, name2, nameage, w1, w2, mort, a, v0para1, v0para2)<br />
simudata_chi2corrage(formula, data, name1, name2, nameage, w1, w2, mort, a, v0para1, v0para2, matprobainfect)<br />
</p>

<hr>
<h2 id='InteratrixGUI'>Function to start the graphical interface</h2><span id='topic+InteratrixGUI'></span>

<h3>Description</h3>

<p>This function opens a graphical interface and helps step by step to compute corrected chi-square tests.</p>


<h3>Usage</h3>

<pre><code class='language-R'>InteratrixGUI()</code></pre>


<h3>Value</h3>

<p>A first interactive graphical interface is opened to choose between two methods.
When all parameters are defined by the user, simulation results are printed to the 
R console, saved in a file and plotted as an histogram.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
