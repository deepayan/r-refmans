<!DOCTYPE html><html><head><title>Help for package APtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {APtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#APBinary'><p>Estimating the AP and the AUC for Binary Outcome Data.</p></a></li>
<li><a href='#APSurv'><p>Estimating the Time-dependent AP and AUC for Censored Time to Event Outcome Data.</p></a></li>
<li><a href='#CompareAP'><p>Comparison of two risk scores based on the differences and ratio of their APs.</p></a></li>
<li><a href='#mayo'><p>Mayo Marker data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Average Positive Predictive Values (AP) for Binary Outcomes and
Censored Event Times</td>
</tr>
<tr>
<td>Version:</td>
<td>6.8.8</td>
</tr>
<tr>
<td>Depends:</td>
<td>graphics, stats, utils, survival, cmprsk</td>
</tr>
<tr>
<td>Author:</td>
<td>Hengrui Cai &lt;hengruicai@gmail.com&gt;, Yan Yuan &lt;yyuan@ualberta.ca&gt;, Qian
    Michelle Zhou &lt;qz70@msstate.edu&gt;, Bingying Li&lt;dorisli1120@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hengrui Cai &lt;hengruicai@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide tools to estimate two prediction accuracy metrics,
    the average positive predictive values (AP) as well as the well-known AUC
    (the area under the receiver operator characteristic curve) for risk scores. 
    The outcome of interest is either binary or censored event time.
    Note that for censored event time, our functions' estimates, the AP and the
    AUC, are time-dependent for pre-specified time interval(s). A function that
    compares the APs of two risk scores/markers is also included. Optional
    outputs include positive predictive values and true positive fractions at
    the specified marker cut-off values, and a plot of the time-dependent AP
    versus time (available for event time data).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-09-21 04:13:20 UTC; apple</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-09-21 04:40:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='APBinary'>Estimating the AP and the AUC for Binary Outcome Data.</h2><span id='topic+APBinary'></span>

<h3>Description</h3>

<p>This function calculates the estimates of the AP and AUC
for binary outcomes as well as their confidence intervals
using the perturbation or the nonparametric bootstrap
resampling method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  APBinary(status, marker, cut.values = NULL,
    method = "none", alpha = 0.95, B = 1000, weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="APBinary_+3A_status">status</code></td>
<td>
<p>Binary indicator, 1 indicates case / the
class of prediction interest and 0 otherwise.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_marker">marker</code></td>
<td>
<p>Numeric risk score. Data
can be continuous or ordinal.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_cut.values">cut.values</code></td>
<td>
<p>risk score values to use as a cut-off for
calculation of positive predictive values (PPV) and true
positive fractions (TPF). The default value is NULL.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_method">method</code></td>
<td>
<p>Method to obtain confidence intervals. The
default is method = &quot;none&quot;, in which case only point estimates will be given without confidence intervals.
If method= &quot;perturbation&quot;, then perturbation based CI will be calculated.
If method = &quot;bootstrap&quot;, then nonparametric bootstrap based CI will be calculated.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level.  The default level is
0.95.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_b">B</code></td>
<td>
<p>Number of resampling to obtain confidence
interval. The default value is 1000.</p>
</td></tr>
<tr><td><code id="APBinary_+3A_weight">weight</code></td>
<td>
<p>Optional. The default weight is 1, same
object length as the &quot;status&quot; and &quot;marker&quot; object.
Users can use their own weights, and the length of
weight is required to be the same as the length of
status.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;APBinary&quot; which is a list with
components:
</p>
<table>
<tr><td><code>ap_summary</code></td>
<td>
<p>Summary of the AP, including the proportion of
cases, a point estimate of AP, and their corresponding
confidence intervals.</p>
</td></tr>
<tr><td><code>auc_summary</code></td>
<td>
<p>Summary of the AUC, including a point
estimate of AUC with a confidence interval.</p>
</td></tr>
<tr><td><code>PPV</code></td>
<td>
<p>Available object, positive predictive values at the
unique risk score in the data.</p>
</td></tr>
<tr><td><code>TPF</code></td>
<td>
<p>Available object, true positive fractions at the
unique risk score in the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yuan, Y., Su, W., and Zhu, M. (2015). Threshold-free
measures for assessing the performance of medical
screening tests. Frontiers in Public Health, 3.57.
</p>
<p>Bingying Li (2015) Threshold-free Measure for Assessing
the Performance of Risk Prediction with Censored Data,
MSc. thesis, Simon Fraser University, Canada
</p>


<h3>Examples</h3>

<pre><code class='language-R'>status=c(rep(1,10),rep(0,1),rep(1,18),rep(0,11),rep(1,25),
	rep(0,44),rep(1,85),rep(0,176))
marker=c(rep(7,11),rep(6,29),rep(5,69),rep(4,261))
cut.values=sort(unique(marker)[-1])
out1 &lt;- APBinary(status,marker,cut.values)
out1
out2 &lt;- APBinary(status,marker,method="perturbation",
	alpha=0.90,B=1500)
out2
</code></pre>

<hr>
<h2 id='APSurv'>Estimating the Time-dependent AP and AUC for Censored Time to Event Outcome Data.</h2><span id='topic+APSurv'></span>

<h3>Description</h3>

<p>This function calculates the estimates of the AP and AUC
for censored time to event data as well as their
confidence intervals using the perturbation or the
nonparametric bootstrap resampling method. The estimation
method is based on Yuan, Y., Zhou, Q. M., Li, B., Cai, H., Chow, E. J., Armstrong, G. T. (2018). A threshold-free summary index of prediction accuracy for censored time to event data. Statistics in medicine, 37(10), 1671-1681.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  APSurv(stime, status, marker, t0.list, cut.values = NULL,
    method = "none", alpha = 0.95, B = 1000,
    weight = NULL, Plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="APSurv_+3A_stime">stime</code></td>
<td>
<p>Censored event time.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_status">status</code></td>
<td>
<p>Binary indicator of censoring. 1 indicates
observing event of interest, 0 otherwise. Other values will be treated as competing risk event.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_marker">marker</code></td>
<td>
<p>Numeric risk score. Data
can be continuous or ordinal.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_t0.list">t0.list</code></td>
<td>
<p>Prediction time intervals of interest. It
could be one numerical value or a vector of numerical
values, which must be in the range of stime.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_cut.values">cut.values</code></td>
<td>
<p>Risk score values to use as a cut-off for
calculation of time-dependent positive predictive values
(PPV) and true positive fractions (TPF). The default
value is NULL.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_method">method</code></td>
<td>
<p>Method to obtain confidence intervals. The
default is method = &quot;none&quot;, in which case only point estimates will be given without confidence intervals.
If method= &quot;perturbation&quot;, then perturbation based CI will be calculated.
If method = &quot;bootstrap&quot;, then nonparametric bootstrap based CI will be calculated.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level. The default level is
0.95.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_b">B</code></td>
<td>
<p>Number of resampling to obtain a confidence
interval. The default value is 1000.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_weight">weight</code></td>
<td>
<p>Optional. The default value is NULL, in
which case the observations are weighted by the inverse
of the probability that their respective time-dependent
event status (whether the event occurs within a specified
time period) is observed. In estimating the probability,
the survival function of the censoring time is estimated
by a Kaplan-Meier estimator under the assumption that the
censoring time is independent of both the event time and
risks score.  Users can use their own weights, in which
case the t0.list should be a scalar and the length of
weight is required to be the same as the length of
status.</p>
</td></tr>
<tr><td><code id="APSurv_+3A_plot">Plot</code></td>
<td>
<p>Whether to plot the time-dependent AP versus
the prediction time intervals.  The default value is
TRUE, in which case the AP is evaluated at the time
points which partition the range of the event times of
the data into 100 intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;APsurv&quot; which is a list with
components:
</p>
<table>
<tr><td><code>ap_summary</code></td>
<td>
<p>Summary of estimated AP(s) at the specified
prediction time intervals of interest. For each
prediction time interval, the output includes the
estimated event rate, a point estimate of the AP, the
estimated scaled AP (ratio of the AP versus event rate),
and their corresponding confidence intervals.</p>
</td></tr>
<tr><td><code>auc_summary</code></td>
<td>
<p>Summary of AUC at the specified prediction
time intervals of interest. For each prediction time
intervals, the output includes the estimated event rate
and a point estimate of AUC with a confidence interval.</p>
</td></tr>
<tr><td><code>PPV</code></td>
<td>
<p>Available object, time-dependent positive predictive
values at the unique risk score in the data.</p>
</td></tr>
<tr><td><code>TPF</code></td>
<td>
<p>Available object, time-dependent true positive
fractions at the unique risk score in the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yuan, Y., Zhou, Q. M., Li, B., Cai, H., Chow, E. J., Armstrong, G. T. (2018). A threshold-free summary index of prediction accuracy for censored time to event data. Statistics in medicine, 37(10), 1671-1681.
</p>
<p>Bingying Li (2015) Threshold-free Measure for Assessing
the Performance of Risk Prediction with Censored Data,
MSc. thesis, Simon Fraser University, Canada
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(APtools)
data(mayo)
t0.list=seq(from=min(mayo[,1]),to=max(mayo[,1]),length.out=5)[-c(1,5)]
cut.values=seq(min(mayo[,3]),max(mayo[,3]),length.out=10)[-10]
out &lt;- APSurv(stime=mayo[,1],status=mayo[,2],marker=mayo[,3],
	t0.list=t0.list,cut.values=cut.values,method='bootstrap',
	alpha=0.90,B=500,weight=rep(1,nrow(mayo)),Plot=FALSE)
out
</code></pre>

<hr>
<h2 id='CompareAP'>Comparison of two risk scores based on the differences and ratio of their APs.</h2><span id='topic+CompareAP'></span>

<h3>Description</h3>

<p>This function estimates the difference between and the
ratio of two APs in order to compare two markers for
censored time to event data or binary data. The
corresponding confidence intervals are provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  CompareAP(status, marker1, marker2, stime = NULL,
    t0.list = NULL, method = "none", alpha = 0.95,
    B = 1000, weight = NULL, Plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CompareAP_+3A_status">status</code></td>
<td>
<p>Binary indicator. For binary data, 1
indicates case and 0 otherwise. For survival data, 1
indicates event and 0 otherwise.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_marker1">marker1</code></td>
<td>
<p>Risk score 1 (to be compared to risk score
2). Its length is required to be the same as the length
of status.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_marker2">marker2</code></td>
<td>
<p>Risk score 2 (to be compared to risk score
1). Its length is required to be the same as the length
of status.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_stime">stime</code></td>
<td>
<p>Censored event time. If dealing with binary
outcome, skip this argument which is set to be NULL.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_t0.list">t0.list</code></td>
<td>
<p>Prediction time intervals of interest for
event time outcome. It could be one numerical value or a
vector of numerical values, which must be in the range of
stime. It is set to be NULL if stime is NULL.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_method">method</code></td>
<td>
<p>Method to obtain confidence intervals. The
default is method = &quot;none&quot;, in which case only point estimates will be given without confidence intervals.
If method= &quot;perturbation&quot;, then perturbation based CI will be calculated.
If method = &quot;bootstrap&quot;, then nonparametric bootstrap based CI will be calculated.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_alpha">alpha</code></td>
<td>
<p>Confidence level. The default level is
0.95.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_b">B</code></td>
<td>
<p>Number of resampling for obtaining a confidence
interval. The default value is 1000.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_weight">weight</code></td>
<td>
<p>Optional argument for event time data, i.e.
stime is not NULL. Its default value is NULL, in which
the observations are weighted by the inverse of the
probability that their respective time-dependent event
status (whether the event occurs within a specified time
period) is observed. In estimating the probability, the
survival function of the censoring time is estimated by a
Kaplan-Meier estimator under the assumption that the
censoring time is independent of both the event time and
risks score. Users can use their own weights, in which
case the t0.list should be a scalar and the length of
weight is required to be the same as the length of
status.</p>
</td></tr>
<tr><td><code id="CompareAP_+3A_plot">Plot</code></td>
<td>
<p>Optional argument for event time data, i.e.
stime is not NULL. For binary data, it is set to FALSE.
For event time data, its default value is TRUE and three
plots are generated: 1) the time-dependent AUC of two
markers; 2) the time-dependent AP of two markers; and 3)
the time-dependent ratio of APs, all versus the
prediction time intervals. The quantities in 1)-3) are
evaluated at the time points which partition the range of
the event times of the data to 100 intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>dap_summary</code></td>
<td>
<p>Summary of the APs of two markers and the
differences (AP1-AP2) and their ratio (AP1/AP2). For
event time data, these quantities are estimated at the
specified prediction time intervals. The output includes
the estimated event rate/proportion of cases, point
estimates of the APs of the two markers, point estimates
of the difference between and ratio of the two APs as
well as their respective confidence intervals.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yuan, Y., Zhou, Q. M., Li, B., Cai, H., Chow, E. J., Armstrong, G. T. (2018). A threshold-free summary index of prediction accuracy for censored time to event data. Statistics in medicine, 37(10), 1671-1681.
</p>
<p>Yuan, Y., Su, W., and Zhu, M. (2015). Threshold-free
measures for assessing the performance of medical
screening tests. Frontiers in Public Health, 3.57.
</p>
<p>Bingying Li (2015) Threshold-free Measure for Assessing
the Performance of Risk Prediction with Censored Data,
MSc. thesis, Simon Fraser University, Canada
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(APtools)
status=c(rep(1,10),rep(0,1),rep(1,18),rep(0,11),rep(1,25),
	rep(0,44),rep(1,85),rep(0,176))
marker1=c(rep(7,11),rep(6,29),rep(5,69),rep(4,261))
marker2=c(rep(7,17),rep(6,29),rep(5,70),rep(4,254))
out_binary &lt;- CompareAP(status,marker1,marker2)
out_binary
data(mayo)
t0.list=seq(from=min(mayo[,1]),to=max(mayo[,1]),length.out=5)[-c(1,5)]
out_survival &lt;- CompareAP(status=mayo[,2],marker1=mayo[,3],
	marker2=mayo[,4],stime=mayo[,1],t0.list=t0.list,
	method='bootstrap',alpha=0.90,B=500,
	weight=rep(1,nrow(mayo)),Plot=FALSE)
out_survival
</code></pre>

<hr>
<h2 id='mayo'>Mayo Marker data</h2><span id='topic+mayo'></span>

<h3>Description</h3>

<p>Two marker values with event time and censoring status for the subjects in Mayo PBC data</p>


<h3>Format</h3>

<p>A data frame with 312 observations and 4 variables: time (event time/censoring time), censor (censoring indicator),
mayoscore4, mayoscore5. The two scores are derived from 4 and 5
covariates respectively.</p>


<h3>Source</h3>

<p>T Therneau, P Grambsch  (2000)
Modeling Survival Data: Extending the Cox Model <em>Springer-Verlag</em>, New York, ISBN: 0-387-98784-3.
</p>


<h3>References</h3>

<p>Fleming T, Harrington D.  (1991)
Counting Processes and Survival Analysis <em>Wiley</em>, New York.
</p>
<p>Heagerty, P.J., Zheng, Y.  (2005)
Survival Model Predictive Accuracy and ROC Curves <em>Biometrics</em>, <b>61</b>, 92 &ndash; 105
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
