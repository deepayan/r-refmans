<!DOCTYPE html><html><head><title>Help for package MGMS2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MGMS2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#characterize_peak'><p>characterize_peak</p></a></li>
<li><a href='#create_insilico_mixture_template'><p>create_insilico_mixture_template</p></a></li>
<li><a href='#filtermass'><p>filtermass</p></a></li>
<li><a href='#gather_summary'><p>gather_summary</p></a></li>
<li><a href='#gather_summary_file'><p>gather_summary_file</p></a></li>
<li><a href='#preprocessMS'><p>preprocessMS</p></a></li>
<li><a href='#process_monospectra'><p>process_monospectra</p></a></li>
<li><a href='#simulate_ind_spec_single'><p>simulate_ind_spec_single</p></a></li>
<li><a href='#simulate_many_poly_spectra'><p>simulate_many_poly_spectra</p></a></li>
<li><a href='#simulate_poly_spectra'><p>simulate_poly_spectra</p></a></li>
<li><a href='#summarize_monospectra'><p>summarize_monospectra</p></a></li>
<li><a href='#summary_mono'><p>summary_mono</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>'MGMS2' for Polymicrobial Samples</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>So Young Ryu <a href="https://orcid.org/0000-0003-2347-7015"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  George Wendt <a href="https://orcid.org/0000-0003-3608-9601"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>George Wendt &lt;gwendt@unr.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A glycolipid mass spectrometry technology has the potential to accurately identify individual bacterial species from polymicrobial samples. To develop bacterial identification algorithms (e.g. machine learning) using this glycolipid technology, it is necessary to generate a large number of various in-silico polymicrobial mass spectra that are similar to real mass spectra. 'MGMS2' (Membrane Glycolipid Mass Spectrum Simulator) generates such in-silico mass spectra, considering errors in m/z (mass-to-charge ratio) and variances of intensity values, occasions of missing signature ions, and noise peaks. It estimates summary statistics of monomicrobial mass spectra for each strain or species and simulates polymicrobial glycolipid mass spectra using the summary statistics of monomicrobial mass spectra. References: Ryu, S.Y., Wendt, G.A., Chandler, C.E., Ernst, R.K. and Goodlett, D.R. (2019) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.9b03340">doi:10.1021/acs.analchem.9b03340</a>&gt; "Model-based Spectral Library Approach for Bacterial Identification via Membrane Glycolipids." Gibb, S. and Strimmer, K. (2012) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbts447">doi:10.1093/bioinformatics/bts447</a>&gt; "MALDIquant: a versatile R package for the analysis of mass spectrometry data."</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>MALDIquant, MALDIquantForeign</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-23 23:25:21 UTC; jakewendt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-24 04:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='characterize_peak'>characterize_peak</h2><span id='topic+characterize_peak'></span>

<h3>Description</h3>

<p>This function characterizes peaks by species/strain in a simulated spectrum after taking the highest peak or merging peaks in each bin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>characterize_peak(spec, option = 1, bin.size = 1, min.mz = 1000, max.mz = 2200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="characterize_peak_+3A_spec">spec</code></td>
<td>
<p>A data frame that contains m/z values of peaks, normalized intensities of peaks, species names, and strain names. Either an output of <code><a href="#topic+simulate_poly_spectra">simulate_poly_spectra</a></code> or one elements of a list output from <code><a href="#topic+simulate_many_poly_spectra">simulate_many_poly_spectra</a></code>.</p>
</td></tr>
<tr><td><code id="characterize_peak_+3A_option">option</code></td>
<td>
<p>An option on how to merge peaks. There are two options: 1) no merge, thus take the highest intensity peak in each bin after binning a spectrum by bin.size, or 2) take a sum of intensity within each bin after binning a spectrum by bin.size.</p>
</td></tr>
<tr><td><code id="characterize_peak_+3A_bin.size">bin.size</code></td>
<td>
<p>An integer. A bin size. (1 by default)</p>
</td></tr>
<tr><td><code id="characterize_peak_+3A_min.mz">min.mz</code></td>
<td>
<p>A real number. Minimum mass-to-charge ratio. (1000 by default)</p>
</td></tr>
<tr><td><code id="characterize_peak_+3A_max.mz">max.mz</code></td>
<td>
<p>A real number. Maximum mass-to-charge ratio. (2200 by default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains m/z values of peaks (mz), intensities of peaks (int), species names (species), and strain names (strain). Species and strain columns may contain more than one species/strain if an option 2 is chosen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
mixture.ratio &lt;- list()
mixture.ratio['A']=1
mixture.ratio['B']=0.5
mixture.ratio['C']=0
sim.template &lt;- create_insilico_mixture_template(mono.info)
insilico.spectrum &lt;- simulate_poly_spectra(sim.template, mixture.ratio)
merged.spectrum &lt;- characterize_peak(insilico.spectrum, option=2) 
</code></pre>

<hr>
<h2 id='create_insilico_mixture_template'>create_insilico_mixture_template</h2><span id='topic+create_insilico_mixture_template'></span>

<h3>Description</h3>

<p>This function generates an intial template for simulated mass spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_insilico_mixture_template(mono.info, mz.tol = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_insilico_mixture_template_+3A_mono.info">mono.info</code></td>
<td>
<p>An output of <code><a href="#topic+gather_summary">gather_summary</a></code>.</p>
</td></tr>
<tr><td><code id="create_insilico_mixture_template_+3A_mz.tol">mz.tol</code></td>
<td>
<p>A m/z tolerance in Da. (Default: 0.5)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame which contains simulated m/z, log intensity, and normalized intensity values of peaks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
template &lt;- create_insilico_mixture_template(mono.info)
</code></pre>

<hr>
<h2 id='filtermass'>filtermass</h2><span id='topic+filtermass'></span>

<h3>Description</h3>

<p>Internal function. This function removes peaks with their mass values (m/z values) outside a given mass range.
This function is used in <code><a href="#topic+process_monospectra">process_monospectra</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filtermass(spectra, mass.range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filtermass_+3A_spectra">spectra</code></td>
<td>
<p>Mass Spectra (A MALDIquant MassSpectrum (S4) object). An output of <code><a href="MALDIquantForeign.html#topic+importMzXml">importMzXml</a></code>.</p>
</td></tr>
<tr><td><code id="filtermass_+3A_mass.range">mass.range</code></td>
<td>
<p>Mass (m/z) range (a vector). For exmaple, c(1000,2200).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of filtered mass spectra (MALDIquant MassSpectrum (S4) objects) which contains mass, intensity, and metaData.
</p>

<hr>
<h2 id='gather_summary'>gather_summary</h2><span id='topic+gather_summary'></span>

<h3>Description</h3>

<p>This function combines outputs from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gather_summary(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gather_summary_+3A_x">x</code></td>
<td>
<p>A list of multiple monomicrobial mass spectra information from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of combined summaries (data frames) of mass spectra from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code> and the corresponding species (a vector).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
</code></pre>

<hr>
<h2 id='gather_summary_file'>gather_summary_file</h2><span id='topic+gather_summary_file'></span>

<h3>Description</h3>

<p>This function combines output files from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gather_summary_file(directory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gather_summary_file_+3A_directory">directory</code></td>
<td>
<p>A directory that contains summary files from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of combined summaries of mass spectra (data frames) from <code><a href="#topic+summarize_monospectra">summarize_monospectra</a></code> and the corresponding species (a vector).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
summary &lt;- gather_summary_file(directory=tempdir())
</code></pre>

<hr>
<h2 id='preprocessMS'>preprocessMS</h2><span id='topic+preprocessMS'></span>

<h3>Description</h3>

<p>Internal function. This function preprocesses spectra by transforming/smoothing intensity, removing baseline, and calibrating intensities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocessMS(spectra, halfWindowSize = 20, SNIP.iteration = 60)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocessMS_+3A_spectra">spectra</code></td>
<td>
<p>Spectra. A MALDIquant object. An output of either <code><a href="MALDIquantForeign.html#topic+importMzXml">importMzXml</a></code> or <code><a href="#topic+filtermass">filtermass</a></code>.</p>
</td></tr>
<tr><td><code id="preprocessMS_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p>halfWindowSize The highest peaks in the given window (+/-halfWindowSize) will be recognized as peaks. (Default: 20). See <code><a href="MALDIquant.html#topic+detectPeaks">detectPeaks</a></code> for details.</p>
</td></tr>
<tr><td><code id="preprocessMS_+3A_snip.iteration">SNIP.iteration</code></td>
<td>
<p>SNIP.iteration An iteration used to remove the baseline of an spectrum. (Default: 60). See <code><a href="MALDIquant.html#topic+removeBaseline">removeBaseline</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The processed mass spectra. A list of MALDIquant MassSpectrum objects (S4 objects).
</p>

<hr>
<h2 id='process_monospectra'>process_monospectra</h2><span id='topic+process_monospectra'></span>

<h3>Description</h3>

<p>This function processes multiple mzXML files which are listed in the file that an user specifies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_monospectra(
  file,
  mass.range = c(1000, 2200),
  halfWindowSize = 20,
  SNIP.iteration = 60
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_monospectra_+3A_file">file</code></td>
<td>
<p>A file name. This file is a tab-delimited file which contains the following columns: file names, strain.no, and strain. See below for details.</p>
</td></tr>
<tr><td><code id="process_monospectra_+3A_mass.range">mass.range</code></td>
<td>
<p>The m/z range that users want to consider for the analysis. (Default: c(1000,2200)).</p>
</td></tr>
<tr><td><code id="process_monospectra_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p>A half window size used for the smoothing the intensity values. (Default: 20). See <code><a href="MALDIquant.html#topic+smoothIntensity">smoothIntensity</a></code> for details.</p>
</td></tr>
<tr><td><code id="process_monospectra_+3A_snip.iteration">SNIP.iteration</code></td>
<td>
<p>An iteration used to remove the baseline of an spectrum. (Default: 60). See <code><a href="MALDIquant.html#topic+removeBaseline">removeBaseline</a></code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of processed monobacterial mass spectra (S4 objects, MALDIquant MassSpectrum objects), and their strain numbers (a vector), unique strains (a vector), and strain names (a vector).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
</code></pre>

<hr>
<h2 id='simulate_ind_spec_single'>simulate_ind_spec_single</h2><span id='topic+simulate_ind_spec_single'></span>

<h3>Description</h3>

<p>Internal function. The function simulates m/z and intensity values using given summary statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_ind_spec_single(interest, mz.tol, species, strain)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_ind_spec_single_+3A_interest">interest</code></td>
<td>
<p>Summary statistics of spectra.</p>
</td></tr>
<tr><td><code id="simulate_ind_spec_single_+3A_mz.tol">mz.tol</code></td>
<td>
<p>The tolerance of m/z. This is used to generate m/z values of peaks.</p>
</td></tr>
<tr><td><code id="simulate_ind_spec_single_+3A_species">species</code></td>
<td>
<p>Species.</p>
</td></tr>
<tr><td><code id="simulate_ind_spec_single_+3A_strain">strain</code></td>
<td>
<p>Strain name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains m/z, (normalized) intensity values, missing rates of peaks, species name, and strain name.
</p>

<hr>
<h2 id='simulate_many_poly_spectra'>simulate_many_poly_spectra</h2><span id='topic+simulate_many_poly_spectra'></span>

<h3>Description</h3>

<p>The function creates simulated mass spectra in pdf file and returns simulated mass spectra (m/z and intensity values of peaks).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_many_poly_spectra(
  mono.info,
  nsim = 10000,
  file = NULL,
  mixture.ratio,
  mixture.missing.prob.peak = 0.05,
  noise.peak.ratio = 0.05,
  snr.basepeak = 500,
  noise.cv = 0.25,
  mz.range = c(1000, 2200),
  mz.tol = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_many_poly_spectra_+3A_mono.info">mono.info</code></td>
<td>
<p>A list output of <code><a href="#topic+gather_summary">gather_summary</a></code> or <code><a href="#topic+gather_summary_file">gather_summary_file</a></code>.</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulated spectra. (Default: 10000)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_file">file</code></td>
<td>
<p>An output file name. (By default, file=NULL. No pdf file will be generated.)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_mixture.ratio">mixture.ratio</code></td>
<td>
<p>A list of bacterial mixture ratios for given bacterial species in sim.template.</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_mixture.missing.prob.peak">mixture.missing.prob.peak</code></td>
<td>
<p>A real value. The missing probability caused by mixing multiple bacteria species. (Default: 0.05)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_noise.peak.ratio">noise.peak.ratio</code></td>
<td>
<p>A ratio between the numbers of noise and signal peaks. (Default: 0.05)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_snr.basepeak">snr.basepeak</code></td>
<td>
<p>A (base peak) signal to noise ratio. (Default: 5000)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_noise.cv">noise.cv</code></td>
<td>
<p>A coefficient of variation of noise peaks. (Default: 0.25)</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_mz.range">mz.range</code></td>
<td>
<p>A range of m/z values. (Default: c(1000,2200))</p>
</td></tr>
<tr><td><code id="simulate_many_poly_spectra_+3A_mz.tol">mz.tol</code></td>
<td>
<p>m/z tolerance. (Default: 0.5)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames. A list of simulated mass spectra (data frames) that contains m/z values of peaks, normalized intensities of peaks, species names, and strain names. This function also creates pdf files which contain simulated spectra.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
mixture.ratio &lt;- list()
mixture.ratio['A']=1
mixture.ratio['B']=0.5
mixture.ratio['C']=0
insilico.spectra &lt;- simulate_many_poly_spectra(mono.info, mixture.ratio=mixture.ratio, nsim=10)
</code></pre>

<hr>
<h2 id='simulate_poly_spectra'>simulate_poly_spectra</h2><span id='topic+simulate_poly_spectra'></span>

<h3>Description</h3>

<p>This function takes simulated m/z and intensities of peaks from <code><a href="#topic+create_insilico_mixture_template">create_insilico_mixture_template</a></code> and modifies them based on given parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_poly_spectra(
  sim.template,
  mixture.ratio,
  spectrum.name = "Spectrum",
  mixture.missing.prob.peak = 0.05,
  noise.peak.ratio = 0.05,
  snr.basepeak = 500,
  noise.cv = 0.25,
  mz.range = c(1000, 2200)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_poly_spectra_+3A_sim.template">sim.template</code></td>
<td>
<p>A data frame which contains m/z, log intensitiy, normalized intensity values and missing rates of peaks. There are also species and strain information. An object of <code><a href="#topic+create_insilico_mixture_template">create_insilico_mixture_template</a></code>.</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_mixture.ratio">mixture.ratio</code></td>
<td>
<p>A list of bacterial mixture ratios for given bacterial species in sim.template.</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_spectrum.name">spectrum.name</code></td>
<td>
<p>A character. An user can define the spectrum name. (Default: 'Spectrum').</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_mixture.missing.prob.peak">mixture.missing.prob.peak</code></td>
<td>
<p>A real value. The missing probability caused by mixing multiple bacteria species. (Default: 0.05)</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_noise.peak.ratio">noise.peak.ratio</code></td>
<td>
<p>A ratio between the numbers of noise and signal peaks. (Default: 0.05)</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_snr.basepeak">snr.basepeak</code></td>
<td>
<p>A (base peak) signal to noise ratio. (Default: 500)</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_noise.cv">noise.cv</code></td>
<td>
<p>A coefficient of variation of noise peaks. (Default: 0.25)</p>
</td></tr>
<tr><td><code id="simulate_poly_spectra_+3A_mz.range">mz.range</code></td>
<td>
<p>A range of m/z values. (Default: c(1000,2200))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains m/z values of peaks, normalized intensities of peaks, species names, and strain names. A modified version of <code>sim.template</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.B &lt;- process_monospectra(
   file=system.file("extdata", "listB.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.processed.C &lt;- process_monospectra(
   file=system.file("extdata", "listC.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A,
   species='A', directory=tempdir())
spectra.mono.summary.B &lt;- summarize_monospectra(
   processed.obj=spectra.processed.B,
   species='B', directory=tempdir())
spectra.mono.summary.C &lt;- summarize_monospectra(
   processed.obj=spectra.processed.C,
   species='C', directory=tempdir())
mono.info=gather_summary(c(spectra.mono.summary.A, spectra.mono.summary.B, spectra.mono.summary.C))
mixture.ratio &lt;- list()
mixture.ratio['A']=1
mixture.ratio['B']=0.5
mixture.ratio['C']=0
sim.template &lt;- create_insilico_mixture_template(mono.info)
insilico.spectrum &lt;- simulate_poly_spectra(sim.template, mixture.ratio)
</code></pre>

<hr>
<h2 id='summarize_monospectra'>summarize_monospectra</h2><span id='topic+summarize_monospectra'></span>

<h3>Description</h3>

<p>This function summarizes monomicrobial spectra and writes summary in the specified directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_monospectra(
  processed.obj,
  species,
  directory = NULL,
  minFrequency = 0.5,
  align.tolerance = 5e-04,
  snr = 3,
  halfWindowSize = 20,
  top.N = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_monospectra_+3A_processed.obj">processed.obj</code></td>
<td>
<p>A list from <code><a href="#topic+process_monospectra">process_monospectra</a></code> which contains peaks information for each strain.</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_species">species</code></td>
<td>
<p>Species name.</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_directory">directory</code></td>
<td>
<p>Directory. (By default, no summary file will be generated.)</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_minfrequency">minFrequency</code></td>
<td>
<p>Percentage value. A minimum occurrence proportion required for building a reference peaks. All peaks with their occurence proportion less than minFrequency will be moved. (Default: 0.50). See <code><a href="MALDIquant.html#topic+filterPeaks">filterPeaks</a></code> and <code><a href="MALDIquant.html#topic+referencePeaks">referencePeaks</a></code> for details.</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_align.tolerance">align.tolerance</code></td>
<td>
<p>Mass tolerance. Must be multiplied by 10^-6 for ppm. (Default: 0.0005).</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_snr">snr</code></td>
<td>
<p>Signal-to-noise ratio. (Default: 3).</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p>The highest peaks in the given window (+/-halfWindowSize) will be recognized as peaks. (Default: 20). See <code><a href="MALDIquant.html#topic+detectPeaks">detectPeaks</a></code> for details.</p>
</td></tr>
<tr><td><code id="summarize_monospectra_+3A_top.n">top.N</code></td>
<td>
<p>The top N peaks will be chosen for the analysis. An integer value. (Default: 50).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame that contains the peaks informations: m/z, mean log intensity, standard deviation of log intensity, missing rate of peaks. In addition, it also contains species and strain information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra.processed.A &lt;- process_monospectra(
   file=system.file("extdata", "listA.txt", package="MGMS2"),
   mass.range=c(1000,2200))
spectra.mono.summary.A &lt;- summarize_monospectra(
   processed.obj=spectra.processed.A, species='A',
   directory=tempdir())
</code></pre>

<hr>
<h2 id='summary_mono'>summary_mono</h2><span id='topic+summary_mono'></span>

<h3>Description</h3>

<p>Internal function. This function calculates summary statistics for peaks afterling aligning spectra of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_mono(
  spectra.interest,
  minFrequency = 0.5,
  align.tolerance = 5e-04,
  snr = 3,
  halfWindowSize = 20,
  top.N = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_mono_+3A_spectra.interest">spectra.interest</code></td>
<td>
<p>A list which contains peaks information for a strain of interest.</p>
</td></tr>
<tr><td><code id="summary_mono_+3A_minfrequency">minFrequency</code></td>
<td>
<p>Percentage value. A minimum occurrence proportion required for building a reference peaks. All peaks with their occurence proportion less than minFrequency will be moved. (Default: 0.50). See <code><a href="MALDIquant.html#topic+filterPeaks">filterPeaks</a></code> and <code><a href="MALDIquant.html#topic+referencePeaks">referencePeaks</a></code> for details.</p>
</td></tr>
<tr><td><code id="summary_mono_+3A_align.tolerance">align.tolerance</code></td>
<td>
<p>Mass tolerance. Must be multiplied by 10^-6 for ppm. (Default: 0.0005).</p>
</td></tr>
<tr><td><code id="summary_mono_+3A_snr">snr</code></td>
<td>
<p>Signal-to-noise ratio. (Default: 3).</p>
</td></tr>
<tr><td><code id="summary_mono_+3A_halfwindowsize">halfWindowSize</code></td>
<td>
<p>The highest peaks in the given window (+/-halfWindowSize) will be recognized as peaks. (Default: 20). See <code><a href="MALDIquant.html#topic+detectPeaks">detectPeaks</a></code> for details.</p>
</td></tr>
<tr><td><code id="summary_mono_+3A_top.n">top.N</code></td>
<td>
<p>The top N peaks will be chosen for the analysis. An integer value. (Default: 50).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary information (Data frame) of spectra of interest.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
