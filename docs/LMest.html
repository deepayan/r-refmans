<!DOCTYPE html><html><head><title>Help for package LMest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LMest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LMest-package'><p>Overview of the Package LMest</p></a></li>
<li><a href='#bootstrap'><p>Parametric bootstrap</p></a></li>
<li><a href='#bootstrap_lm_basic'><p>Parametric bootstrap for the basic LM model</p></a></li>
<li><a href='#bootstrap_lm_basic_cont'><p>Parametric bootstrap for the basic LM model for continuous outcomes</p></a></li>
<li><a href='#bootstrap_lm_cov_latent'><p>Parametric bootstrap for LM models with individual covariates in the latent model</p></a></li>
<li><a href='#bootstrap_lm_cov_latent_cont'><p>Parametric bootstrap for LM models for continuous outcomes with individual covariates in the latent model</p></a></li>
<li><a href='#data_criminal_sim'><p>Criminal dataset</p></a></li>
<li><a href='#data_drug'><p>Dataset about marijuana consumption</p></a></li>
<li><a href='#data_long_cont'><p>Multivariate Longitudinal Continuous (Gaussian) Data</p></a></li>
<li><a href='#data_SRHS_long'><p>Self-reported health status dataset</p></a></li>
<li><a href='#decoding'><p>Perform local and global decoding</p></a></li>
<li><a href='#draw_lm_basic'><p>Draw samples from the basic LM model</p></a></li>
<li><a href='#draw_lm_basic_cont'><p>Draw samples from the basic LM model for continuous outcomes</p></a></li>
<li><a href='#draw_lm_cov_latent'><p>Draw samples from LM model with covariaates in the latent model</p></a></li>
<li><a href='#draw_lm_cov_latent_cont'><p>Draw samples from LM model for continuous outcomes with covariaates in the latent model</p></a></li>
<li><a href='#draw_lm_mixed'><p>Draws samples from the mixed LM model</p></a></li>
<li><a href='#drawLMbasic'><p>Draw samples from the basic LM model</p></a></li>
<li><a href='#drawLMbasiccont'><p>Draw samples from the basic LM model for continuous outcomes</p></a></li>
<li><a href='#drawLMlatent'><p>Draw samples from LM model with covariates in the latent model</p></a></li>
<li><a href='#drawLMlatentcont'><p>Draw samples from LM model for continuous outcomes with covariates in the latent model</p></a></li>
<li><a href='#drawLMmixed'><p>Draws samples from the mixed LM model</p></a></li>
<li><a href='#est_lm_basic'><p>Estimate basic LM model</p></a></li>
<li><a href='#est_lm_basic_cont'><p>Estimate basic LM model for continuous outcomes</p></a></li>
<li><a href='#est_lm_cov_latent'><p>Estimate LM model with covariates in the latent model</p></a></li>
<li><a href='#est_lm_cov_latent_cont'><p>Estimate LM model for continuous outcomes with covariates in the latent model</p></a></li>
<li><a href='#est_lm_cov_manifest'><p>Estimate LM model with covariates in the measurement model</p></a></li>
<li><a href='#est_lm_mixed'><p>Estimate mixed LM model</p></a></li>
<li><a href='#est_mc_basic'><p>Estimate basic Markov chain (MC) model</p></a></li>
<li><a href='#est_mc_cov'><p>Estimate Markov chain (MC) model with covariates</p></a></li>
<li><a href='#LMbasic-class'><p>Class <code>'LMbasic'</code></p></a></li>
<li><a href='#LMbasiccont-class'><p>Class <code>'LMbasiccont'</code></p></a></li>
<li><a href='#lmest'><p>Estimate Latent Markov models  for categorical responses</p></a></li>
<li><a href='#lmestCont'><p>Estimate Latent Markov models for continuous responses</p></a></li>
<li><a href='#lmestData'><p>Data for <code>LMest</code> functions</p></a></li>
<li><a href='#lmestDecoding'>
<p>Perform local and global decoding</p></a></li>
<li><a href='#lmestFormula'><p>Formulas for <code>LMest</code> functions</p></a></li>
<li><a href='#lmestMc'><p>Estimate Markov Chain models</p></a></li>
<li><a href='#lmestMixed'><p>Estimate mixed Latent Markov models</p></a></li>
<li><a href='#lmestSearch'><p>Search for the global maximum of the log-likelihood</p></a></li>
<li><a href='#LMlatent-class'><p>Class <code>'LMlatent'</code></p></a></li>
<li><a href='#LMlatentcont-class'><p>Class <code>'LMlatentcont'</code></p></a></li>
<li><a href='#LMmanifest-class'><p>Class <code>'LMmanifest'</code></p></a></li>
<li><a href='#LMmanifestcont-class'><p>Class <code>'LMmanifestcont'</code></p></a></li>
<li><a href='#LMmixed-class'><p>Class <code>'LMmixed'</code></p></a></li>
<li><a href='#long2matrices'><p>From data in the long format to data in array format</p></a></li>
<li><a href='#long2wide'><p>From data in the long format to data in the wide format</p></a></li>
<li><a href='#matrices2long'><p>From data in array  format to data in long format</p></a></li>
<li><a href='#MCbasic-class'><p>Class <code>'MCbasic'</code></p></a></li>
<li><a href='#MCcov-class'><p>Class <code>'MCcov'</code></p></a></li>
<li><a href='#NLSYlong'><p>National Longitudinal Survey of Youth data</p></a></li>
<li><a href='#plot'><p>Plots for Generalized Latent Markov Models</p></a></li>
<li><a href='#print'><p>Print the output</p></a></li>
<li><a href='#PSIDlong'><p>Dataset about income dynamics</p></a></li>
<li><a href='#RLMSdat'><p>Dataset about job satisfaction</p></a></li>
<li><a href='#RLMSlong'><p>Dataset about job satisfaction</p></a></li>
<li><a href='#se'><p>Standard errors</p></a></li>
<li><a href='#search.model.LM'><p>Search for the global maximum of the log-likelihood</p></a></li>
<li><a href='#summary'><p>Summary of LM fits</p></a></li>
<li><a href='#summary.lmestData'><p>Summary and plot of <code>lmestData</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Generalized Latent Markov Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Latent Markov models for longitudinal continuous and categorical data. See Bartolucci, Pandolfi, Pennoni (2017)&lt;<a href="https://doi.org/10.18637%2Fjss.v081.i04">doi:10.18637/jss.v081.i04</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesco Bartolucci [aut, cre],
  Silvia Pandolfi [aut],
  Fulvia Pennoni [aut],
  Alessio Farcomeni [ctb],
  Alessio Serafini [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesco Bartolucci &lt;francesco.bartolucci@unipg.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, MultiLCIRT, stats, mvtnorm, Formula(&ge; 1.2-3), mix,
utils, graphics, diagram(&ge; 1.6.4), mclust(&ge; 5.4.6),
scatterplot3d(&ge; 0.3-41), grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, bookdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-27 14:18:13 UTC; francescobartolucci</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-27 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='LMest-package'>Overview of the Package LMest</h2><span id='topic+LMest-package'></span><span id='topic+LMest'></span>

<h3>Description</h3>

<p>The package <code>LMest</code> is a framework for specifying and fitting Latent (or Hidden) Markov (LM) models for the analysis of longitudinal continuous and categorical data. Covariates are also included in the model specification through suitable parameterizations.</p>


<h3>Details</h3>

<p>Different LM models are estimated through specific functions requiring a data frame in long format. Responses are mainly categorical, the functions referred to continous responses are specified with <code>Cont</code>.
The functions are the following:
</p>

<dl>
<dt><code><a href="#topic+lmest">lmest</a></code></dt><dd><p>Function to estimate LM models for categorical responses generating the following classes:
</p>

<ul>
<li><p><code><a href="#topic+LMbasic-class">LMbasic-class</a></code> for the basic LM model without covariates.
</p>
</li>
<li><p><code><a href="#topic+LMmanifest-class">LMmanifest-class</a></code> for the LM  model with covariates in the measurement submodel.
</p>
</li>
<li><p><code><a href="#topic+LMlatent-class">LMlatent-class</a></code> for the LM model with covariates in the latent model.
</p>
</li></ul>
</dd>
<dt><code><a href="#topic+lmestCont">lmestCont</a></code></dt><dd><p>Function to estimate LM models for continuous outcomes generating the following classes:
</p>

<ul>
<li><p><code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code> for the  basic LM model for continuous responses without covariates.
</p>
</li>
<li><p><code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code> for the  LM model for continuous responses with covariates in the latent model.
</p>
</li></ul>
</dd>
<dt><code><a href="#topic+lmestMixed">lmestMixed</a></code></dt><dd><p>Function to estimate Mixed LM models for categorical responses with discrete random effects in the latent model generating the following class:
</p>

<ul>
<li><p><code><a href="#topic+LMmixed-class">LMmixed-class</a></code> for the mixed LM model.
</p>
</li></ul>
</dd>
<dt><code><a href="#topic+lmestMc">lmestMc</a></code></dt><dd><p>Function to estimate Markov Chain models for categorical responses generating the following classes:
</p>

<ul>
<li><p><code><a href="#topic+MCbasic-class">MCbasic-class</a></code> for the Markov Chain (MC) model without covariates.
</p>
</li>
<li><p><code><a href="#topic+MCcov-class">MCcov-class</a></code> for the MC model with covariates.
</p>
</li></ul>
</dd>
</dl>

<p>Maximum likelihood estimation of model parameters is performed through the Expectation-Maximization algorithm, which is implemented by relying on Fortran routines.
</p>
<p>Model selection is provided by <code><a href="#topic+lmest">lmest</a></code> and <code><a href="#topic+lmestCont">lmestCont</a></code> functions. In addition, function <code><a href="#topic+lmestSearch">lmestSearch</a></code> allows us to deal with both model selection and multimodality of the likelihood function. Two main criteria are provided to select the number of latent states: the Akaike Information Criterion and the Bayesian Information Criterion.
</p>
<p>Prediction of the latent states is performed by the function <code><a href="#topic+lmestDecoding">lmestDecoding</a></code>: for local and global decoding (Viterbi algorithm) from the output of functions lmest, lmestCont and lmestMixed.
</p>
<p>The package allows us to deal with missing responses, including drop-out and non-monotonic missingness, under the missing-at-random assumption.
</p>
<p>Standard errors for the parameter estimates are obtained by the function <code><a href="#topic+se">se</a></code> through exact computation of the information matrix or by reliable numerical approximations of this matrix.
</p>
<p>The <code><a href="base.html#topic+print">print</a></code> method shows some convergence information, and the <code><a href="base.html#topic+summary">summary</a></code> method shows the estimation results.
</p>
<p>The package also provides some real and simulated data sets that are listed using the function <code>data(package = "LMest")</code>.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci [aut,cre], Silvia Pandolfi [aut], Fulvia Pennoni [aut], Alessio Farcomeni [ctb], and Alessio Serafini [ctb]
</p>
<p>Maintainer: Francesco Bartolucci &lt;francesco.bartolucci@unipg.it&gt;
</p>


<h3>References</h3>

<p>Bartolucci, F., Pandolfi, S. and Pennoni, F. (2017). LMest: An R Package for Latent Markov Models for Longitudinal Categorical Data, <em>Journal of Statistical Software</em>, <b>81</b>, 1-38, doi:10.18637/jss.v081.i04.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013). <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.
</p>
<p>Bartolucci, F., Farcomeni, A., and Pennoni, F. (2014). Latent Markov models: A review of a general framework for the analysis of longitudinal data with covariates (with discussion). <em>TEST</em>, <b>23</b>, 433-465.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmest">lmest</a></code>, <code><a href="#topic+lmestCont">lmestCont</a></code>, <code><a href="#topic+lmestMc">lmestMc</a></code>, <code><a href="#topic+lmestMixed">lmestMixed</a></code>, <code><a href="#topic+LMmixed-class">LMmixed-class</a></code>, <code><a href="#topic+LMbasic-class">LMbasic-class</a></code>,<code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>, <code><a href="#topic+LMlatent-class">LMlatent-class</a></code>,<code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>, <code><a href="#topic+LMmanifest-class">LMmanifest-class</a></code></p>

<hr>
<h2 id='bootstrap'>Parametric bootstrap</h2><span id='topic+bootstrap'></span><span id='topic+bootstrap.LMbasic'></span><span id='topic+bootstrap.LMbasiccont'></span><span id='topic+bootstrap.LMlatent'></span><span id='topic+bootstrap.LMlatentcont'></span>

<h3>Description</h3>

<p>Function that performs bootstrap parametric resampling to compute standard errors for the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap(est, ...)
## S3 method for class 'LMbasic'
bootstrap(est, n = 1000, B = 100, seed = NULL, ...)
## S3 method for class 'LMbasiccont'
bootstrap(est, n = 1000, B=100, seed = NULL, ...)
## S3 method for class 'LMlatent'
bootstrap(est, B = 100, seed = NULL, ...)
## S3 method for class 'LMlatentcont'
bootstrap(est, B = 100, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_+3A_est">est</code></td>
<td>
<p>an object obtained from a call to <code><a href="#topic+lmest">lmest</a></code> and <code><a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code id="bootstrap_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
<tr><td><code id="bootstrap_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Average of bootstrap estimates and standard errors for the model parameters in <code>est</code> object.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# LM model for categorical responses with covariates on the latent model

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

# Categories rescaled to vary from 0 (“poor”) to 4 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

out1 &lt;- lmest(responsesFormula = srhs ~ NULL,
              index = c("id","t"),
              data = SRHS,
              k = 3,
              tol = 1e-8,
              start = 1,
              modBasic = 1,
              out_se = TRUE,
              seed = 123)

boot1 &lt;- bootstrap(out1)

out2 &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = SRHS,
              k = 2,
              paramLatent = "multilogit",
              start = 0)

boot2 &lt;- bootstrap(out2)

# LM model for continous responses without covariates 

data(data_long_cont)

out3 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k =3,
                  modBasic=1,
                  tol=10^-5)

boot3 &lt;- bootstrap(out3)

# LM model for continous responses with covariates 

out4 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  latentFormula = ~ X1 + X2,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 3,
                  output=TRUE)
                  
boot4 &lt;- bootstrap(out4)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootstrap_lm_basic'>Parametric bootstrap for the basic LM model</h2><span id='topic+bootstrap_lm_basic'></span>

<h3>Description</h3>

<p>Function that performs bootstrap parametric resampling to compute standard errors for the parameter estimates. <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+bootstrap">bootstrap</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_lm_basic(piv, Pi, Psi, n, B = 100, start = 0, mod = 0, tol = 10^-6)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_lm_basic_+3A_piv">piv</code></td>
<td>
<p>initial probability vector</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_pi">Pi</code></td>
<td>
<p>probability transition matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_psi">Psi</code></td>
<td>
<p>matrix of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_mod">mod</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mPsi</code></td>
<td>
<p>average of bootstrap estimates of the conditional response probabilities</p>
</td></tr>
<tr><td><code>mpiv</code></td>
<td>
<p>average of bootstrap estimates of the initial probability vector</p>
</td></tr>
<tr><td><code>mPi</code></td>
<td>
<p>average of bootstrap estimates of the transition probability matrices</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response probabilities</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probability vector</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probability matrices</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example of drug consumption data
# load data
data(data_drug)
data_drug &lt;- as.matrix(data_drug)
S &lt;- data_drug[,1:5]-1
yv &lt;- data_drug[,6]
n &lt;- sum(yv)
# fit of the Basic LM model
k &lt;- 3
out1 &lt;- est_lm_basic(S, yv, k, mod = 1, out_se = TRUE)
out2 &lt;- bootstrap_lm_basic(out1$piv, out1$Pi, out1$Psi, n, mod = 1, B = 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootstrap_lm_basic_cont'>Parametric bootstrap for the basic LM model for continuous outcomes</h2><span id='topic+bootstrap_lm_basic_cont'></span>

<h3>Description</h3>

<p>Function that performs bootstrap parametric resampling to compute standard errors for the parameter estimates. <br /> <br /> <b>The function is no longer maintained. Please look at <code><a href="#topic+bootstrap">bootstrap</a></code> function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_lm_basic_cont(piv, Pi, Mu, Si, n, B = 100, start = 0, mod = 0, tol = 10^-6)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_piv">piv</code></td>
<td>
<p>initial probability vector</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_pi">Pi</code></td>
<td>
<p>probability transition matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_mu">Mu</code></td>
<td>
<p>matrix of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_mod">mod</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_basic_cont_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mMu</code></td>
<td>
<p>average of bootstrap estimates of the conditional means of the response variables</p>
</td></tr>
<tr><td><code>mSi</code></td>
<td>
<p>average of bootstrap estimates of the var-cov matrix</p>
</td></tr>
<tr><td><code>mpiv</code></td>
<td>
<p>average of bootstrap estimates of the initial probability vector</p>
</td></tr>
<tr><td><code>mPi</code></td>
<td>
<p>average of bootstrap estimates of the transition probability matrices</p>
</td></tr>
<tr><td><code>seMu</code></td>
<td>
<p>standard errors for the conditional means of the response variables</p>
</td></tr>
<tr><td><code>seSi</code></td>
<td>
<p>standard errors for the var-cov matrix</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probability vector</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probability matrices</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based on multivariate longitudinal continuous data

data(data_long_cont)
res &lt;- long2matrices(data_long_cont$id, X = cbind(data_long_cont$X1, data_long_cont$X2),
      Y = cbind(data_long_cont$Y1, data_long_cont$Y2,data_long_cont$Y3))
Y &lt;- res$YY
n &lt;- dim(Y)[1]

# fit of the Basic LM model for continuous outcomes
k &lt;- 3
out1 &lt;- est_lm_basic_cont(Y, k, mod = 1)
out2 &lt;- bootstrap_lm_basic_cont(out1$piv, out1$Pi, out1$Mu, out1$Si, n, mod = 1, B = 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootstrap_lm_cov_latent'>Parametric bootstrap for LM models with individual covariates in the latent model</h2><span id='topic+bootstrap_lm_cov_latent'></span>

<h3>Description</h3>

<p>Function that performs bootstrap parametric resampling to compute standard errors for the parameter estimates. <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+bootstrap">bootstrap</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_lm_cov_latent(X1, X2, param = "multilogit", Psi, Be, Ga, B = 100,
                        fort = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates affecting the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_x2">X2</code></td>
<td>
<p>array of covariates affecting the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mPsi</code></td>
<td>
<p>average of bootstrap estimates of the conditional response probabilities</p>
</td></tr>
<tr><td><code>mBe</code></td>
<td>
<p>average of bootstrap estimates of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>mGa</code></td>
<td>
<p>average of bootstrap estimates of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response probabilities </p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for the parameters in Be</p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for the parameters in Ga </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi - University of Perugia (IT)</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based on self-rated health status (SRHS) data
# load SRHS data
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long

TT &lt;- 8
head(dataSRHS)
res &lt;- long2matrices(dataSRHS$id, X = cbind(dataSRHS$gender-1,
dataSRHS$race == 2 | dataSRHS$race == 3, dataSRHS$education == 4,
dataSRHS$education == 5, dataSRHS$age-50, (dataSRHS$age-50)^2/100),
Y = dataSRHS$srhs)

# matrix of responses (with ordered categories from 0 to 4)
S &lt;- 5-res$YY

# matrix of covariates (for the first and the following occasions)
# colums are: gender,race,educational level (2 columns),age,age^2)
X1 &lt;- res$XX[,1,]
X2 &lt;- res$XX[,2:TT,]

# estimate the model
out1 &lt;- est_lm_cov_latent(S, X1, X2, k = 2, output = TRUE, out_se = TRUE)

out2 &lt;- bootstrap_lm_cov_latent(X1, X2, Psi = out1$Psi, Be = out1$Be, Ga = out1$Ga, B = 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootstrap_lm_cov_latent_cont'>Parametric bootstrap for LM models for continuous outcomes with individual covariates in the latent model</h2><span id='topic+bootstrap_lm_cov_latent_cont'></span>

<h3>Description</h3>

<p>Function that performs bootstrap parametric resampling to compute standard errors for the parameter estimates.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+bootstrap">bootstrap</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_lm_cov_latent_cont(X1, X2, param = "multilogit", Mu, Si, Be, Ga, B = 100)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates affecting the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_x2">X2</code></td>
<td>
<p>array of covariates affecting the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_mu">Mu</code></td>
<td>
<p>matrix of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="bootstrap_lm_cov_latent_cont_+3A_b">B</code></td>
<td>
<p>number of bootstrap samples</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mMu</code></td>
<td>
<p>average of bootstrap estimates of the conditional means for the response variables</p>
</td></tr>
<tr><td><code>mSi</code></td>
<td>
<p>average of bootstrap estimates of the var-cov matrix</p>
</td></tr>
<tr><td><code>mBe</code></td>
<td>
<p>average of bootstrap estimates of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>mGa</code></td>
<td>
<p>average of bootstrap estimates of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>seMu</code></td>
<td>
<p>standard errors for the conditional means </p>
</td></tr>
<tr><td><code>seSi</code></td>
<td>
<p>standard errors for the var-cov matrix</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for the parameters in Be</p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for the parameters in Ga </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi - University of Perugia (IT)</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based on multivariate longitudinal continuous data

data(data_long_cont)
TT &lt;- 5
res &lt;- long2matrices(data_long_cont$id, X = cbind(data_long_cont$X1, data_long_cont$X2),
                    Y = cbind(data_long_cont$Y1, data_long_cont$Y2,data_long_cont$Y3))
Y &lt;- res$YY
X1 &lt;- res$XX[,1,]
X2 &lt;- res$XX[,2:TT,]

# estimate the model
est &lt;- est_lm_cov_latent_cont(Y, X1, X2, k = 3, output = TRUE)
out &lt;- bootstrap_lm_cov_latent_cont(X1, X2, Mu = est$Mu, Si = est$Si,
                                    Be = est$Be, Ga = est$Ga, B = 1000)


## End(Not run)
</code></pre>

<hr>
<h2 id='data_criminal_sim'>Criminal dataset</h2><span id='topic+data_criminal_sim'></span>

<h3>Description</h3>

<p>Simulated dataset about crimes committed by a cohort of subjects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_criminal_sim)</code></pre>


<h3>Format</h3>

<p>A data frame with 60000 observations on the following 13 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>sex</code></dt><dd><p>gender of the subject</p>
</dd>
<dt><code>time</code></dt><dd><p>occasion of observation</p>
</dd>
<dt><code>y1</code></dt><dd><p>crime of type 1 (violence against the person)</p>
</dd>
<dt><code>y2</code></dt><dd><p>crime of type 2 (sexual offences)</p>
</dd>
<dt><code>y3</code></dt><dd><p>crime of type 3 (burglary)</p>
</dd>
<dt><code>y4</code></dt><dd><p>crime of type 4 (robbery)</p>
</dd>
<dt><code>y5</code></dt><dd><p>crime of type 5 (theft and handling stolen goods)</p>
</dd>
<dt><code>y6</code></dt><dd><p>crime of type 6 (fraud and forgery)</p>
</dd>
<dt><code>y7</code></dt><dd><p>crime of type 7 (criminal demage)</p>
</dd>
<dt><code>y8</code></dt><dd><p>crime of type 8 (drug offences)</p>
</dd>
<dt><code>y9</code></dt><dd><p>crime of type 9 (motoring offences)</p>
</dd>
<dt><code>y10</code></dt><dd><p>crime of type 10 (other offences)</p>
</dd>
</dl>



<h3>References</h3>

<p>Bartolucci, F., Pennoni, F. and Francis, B. (2007), A latent Markov model for detecting patterns of criminal activity, <em>Journal of the Royal Statistical Society, series A</em>, <b>170</b>, pp. 115-132.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_criminal_sim)</code></pre>

<hr>
<h2 id='data_drug'>Dataset about marijuana consumption</h2><span id='topic+data_drug'></span>

<h3>Description</h3>

<p>Longitudinal dataset derived from the National Youth Survey about marijuana consumption measured  by ordinal variables with 3 categories with increasing levels of consumption (1  &quot;never in the past year&quot;, 2 &quot;no more than once in a month in the past year&quot;, 3 &quot;more than once a month in the past year&quot;).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_drug)</code></pre>


<h3>Format</h3>

<p>A data frame with 51 observations on the following 6 variables.
</p>

<dl>
<dt><code>V1</code></dt><dd><p>reported drug use at the 1st occasion</p>
</dd>
<dt><code>V2</code></dt><dd><p>reported drug use at the 2nd occasion</p>
</dd>
<dt><code>V3</code></dt><dd><p>reported drug use at the 3rd occasion</p>
</dd>
<dt><code>V4</code></dt><dd><p>reported drug use at the 4th occasion</p>
</dd>
<dt><code>V5</code></dt><dd><p>reported drug use at the 5th occasion</p>
</dd>
<dt><code>V6</code></dt><dd><p>frequency of the response configuration</p>
</dd>
</dl>



<h3>Source</h3>

<p>Elliot, D. S., Huizinga, D. and Menard, S. (1989) <em>Multiple Problem Youth: Delinquency, Substance Use, and Mental
Health Problems.</em> New York: Springer.</p>


<h3>References</h3>

<p>Bartolucci, F. (2006) Likelihood inference for a class of latent Markov models under
linear hypotheses on the transition probabilities. <em>Journal of the Royal Statistical Society,
series B</em>, <b>68</b>, 155-178.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_drug)
</code></pre>

<hr>
<h2 id='data_long_cont'>Multivariate Longitudinal Continuous (Gaussian) Data</h2><span id='topic+data_long_cont'></span>

<h3>Description</h3>

<p>Simulated multivariate longitudinal continuous dataset assuming that there are 500 subjects in the study whose data are collected at 5 equally-spaced time points.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_long_cont)</code></pre>


<h3>Format</h3>

<p>A data frame with 2500 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id.</p>
</dd>
<dt><code>time</code></dt><dd><p>occasion of observation.</p>
</dd>
<dt><code>Y1</code></dt><dd><p>a numeric vector for the first longitudinal response.</p>
</dd>
<dt><code>Y2</code></dt><dd><p>a numeric vector for the second longitudinal  response.</p>
</dd>
<dt><code>Y3</code></dt><dd><p>a numeric vector for the third longitudinal  response.</p>
</dd>
<dt><code>X1</code></dt><dd><p>a numeric vector for the first covariate.</p>
</dd>
<dt><code>X2</code></dt><dd><p>a numeric vector for the second covariate.</p>
</dd></dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(data_long_cont)
</code></pre>

<hr>
<h2 id='data_SRHS_long'>Self-reported health status dataset</h2><span id='topic+data_SRHS_long'></span>

<h3>Description</h3>

<p>Dataset about self-reported health status derived from the Health and Retirement Study conducted by the University of Michigan.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_SRHS_long)</code></pre>


<h3>Format</h3>

<p>A data frame with 56592 observations on the following 6 variables.
</p>

<dl>
<dt><code>t</code></dt><dd><p>occasion of observation</p>
</dd>
<dt><code>id</code></dt><dd><p>subject id</p>
</dd>
<dt><code>gender</code></dt><dd><p>sex of the subject coded as 1 for &quot;male&quot;, 2 for &quot;female&quot;</p>
</dd>
<dt><code>race</code></dt><dd><p>race coded as 1 for &quot;white&quot;, 2 for &quot;black&quot;, 3 for &quot;others&quot;</p>
</dd>
<dt><code>education</code></dt><dd><p>educational level coded as 1 for &quot;high school&quot;, 2 for &quot;general educational diploma&quot;, 3 for &quot;high school graduate&quot;, 4 for &quot;some college&quot;, 5 for &quot;college and above&quot;</p>
</dd>
<dt><code>age</code></dt><dd><p>age at the different time occasions</p>
</dd>
<dt><code>srhs</code></dt><dd><p>self-reported health status at the different time occasions coded as 1 for &quot;excellent&quot;, 2 for &quot;very good&quot;, 3 for &quot;good&quot;, 4 for &quot;fair&quot;, 5 for &quot;poor&quot;</p>
</dd>
</dl>



<h3>References</h3>

<p>Bartolucci, F., Bacci, S. and Pennoni, F. (2014) Longitudinal analysis of the self-reported health status by mixture latent autoregressive models, <em>Journal of the Royal Statistical Society - series C</em>, <b>63</b>, pp. 267-288</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_SRHS_long)</code></pre>

<hr>
<h2 id='decoding'>Perform local and global decoding</h2><span id='topic+decoding'></span>

<h3>Description</h3>

<p>Function that performs local and global decoding (Viterbi) from the output of <code>est_lm_basic</code>, <code>est_lm_cov_latent</code>, <code>est_lm_cov_manifest</code>, and <code>est_lm_mixed</code>.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestDecoding">lmestDecoding</a></code> <b>function</b></p>


<h3>Usage</h3>

<pre><code class='language-R'>decoding(est, Y, X1 = NULL, X2 = NULL, fort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decoding_+3A_est">est</code></td>
<td>
<p>output from <code>est_lm_basic</code>, <code>est_lm_cov_latent</code>, <code>est_lm_cov_manifest</code>, or <code>est_lm_mixed</code></p>
</td></tr>
<tr><td><code id="decoding_+3A_y">Y</code></td>
<td>
<p>single vector or matrix of responses</p>
</td></tr>
<tr><td><code id="decoding_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates on the initial probabilities (<code>est_lm_cov_latent</code>) or on the responses (<code>est_lm_cov_manifest</code>)</p>
</td></tr>
<tr><td><code id="decoding_+3A_x2">X2</code></td>
<td>
<p>array of covariates on the transition probabilites</p>
</td></tr>
<tr><td><code id="decoding_+3A_fort">fort</code></td>
<td>
<p>to use Fortran routines</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Ul</code></td>
<td>
<p>matrix of local decoded states corresponding to each row of Y</p>
</td></tr>
<tr><td><code>Ug</code></td>
<td>
<p>matrix of global decoded states corresponding to each row of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Viterbi A. (1967) Error Bounds for Convolutional Codes and an Asymptotically Optimum Decoding Algorithm. <em>IEEE Transactions on Information Theory</em>, <b>13</b>, 260-269.
</p>
<p>Juan B., Rabiner L. (1991) Hidden Markov Models for Speech Recognition. <em>Technometrics</em>, <b>33</b>, 251-272.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# example for the output from est_lm_basic

data(data_drug)
data_drug &lt;- as.matrix(data_drug)
S &lt;- data_drug[,1:5]-1
yv &lt;- data_drug[,6]
n &lt;- sum(yv)

# fit the Basic LM model

k &lt;- 3
est &lt;- est_lm_basic(S, yv, k, mod = 1)

# decoding for a single sequence

out1 &lt;- decoding(est, S[1,])

# decoding for all sequences

out2 &lt;- decoding(est, S)


# example for the output from est_lm_cov_latent with difflogit parametrization
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long[1:1600,]

TT &lt;- 8
head(dataSRHS)
res &lt;- long2matrices(dataSRHS$id, X = cbind(dataSRHS$gender-1,
dataSRHS$race == 2 | dataSRHS$race == 3, dataSRHS$education == 4,
dataSRHS$education == 5, dataSRHS$age-50,(dataSRHS$age-50)^2/100),
Y= dataSRHS$srhs)

# matrix of responses (with ordered categories from 0 to 4)
S &lt;- 5-res$YY

# matrix of covariates (for the first and the following occasions)
# colums are: gender,race,educational level (2 columns),age,age^2)
X1 &lt;- res$XX[,1,]
X2 &lt;- res$XX[,2:TT,]

# estimate the model
est &lt;- est_lm_cov_latent(S, X1, X2, k = 2, output = TRUE, param = "difflogit")
# decoding for a single sequence
out1 &lt;- decoding(est, S[1,,], X1[1,], X2[1,,])
# decoding for all sequences
out2 &lt;- decoding(est, S, X1, X2)

## End(Not run)
</code></pre>

<hr>
<h2 id='draw_lm_basic'>Draw samples from the basic LM model</h2><span id='topic+draw_lm_basic'></span>

<h3>Description</h3>

<p>Function that draws samples from the basic LM model with specific parameters.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+drawLMbasic">drawLMbasic</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_lm_basic(piv, Pi, Psi, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_lm_basic_+3A_piv">piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code id="draw_lm_basic_+3A_pi">Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="draw_lm_basic_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k x r)</p>
</td></tr>
<tr><td><code id="draw_lm_basic_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>matrix of distinct response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>corresponding vector of frequencies</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# draw a sample for 1000 units and only one response variable
n &lt;- 1000
TT &lt;- 6
k &lt;- 2
r &lt;- 1 #number of response variables
mb &lt;- 3 #maximum number of response categories

piv &lt;- c(0.7, 0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Psi &lt;- matrix(c(0.7,0.2,0.1,0.5,0.4,0.1), mb, k)
Psi &lt;- array(Psi, c(mb, k, r))
out &lt;- draw_lm_basic(piv, Pi, Psi, n = 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='draw_lm_basic_cont'>Draw samples from the basic LM model for continuous outcomes</h2><span id='topic+draw_lm_basic_cont'></span>

<h3>Description</h3>

<p>Function that draws samples from the basic LM model for continuous outcomes with specific parameters.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+drawLMbasiccont">drawLMbasiccont</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_lm_basic_cont(piv, Pi, Mu, Si, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_lm_basic_cont_+3A_piv">piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code id="draw_lm_basic_cont_+3A_pi">Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="draw_lm_basic_cont_+3A_mu">Mu</code></td>
<td>
<p>matrix of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="draw_lm_basic_cont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="draw_lm_basic_cont_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# draw a sample for 1000 units and 3 response variable
n &lt;- 1000
TT &lt;- 5
k &lt;- 2
r &lt;- 3 #number of response variables

piv &lt;- c(0.7,0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Mu &lt;- matrix(c(-2,-2,0,0,2,2), r, k)
Si &lt;- diag(r)
out &lt;- draw_lm_basic_cont(piv, Pi, Mu, Si, n)

## End(Not run)
</code></pre>

<hr>
<h2 id='draw_lm_cov_latent'>Draw samples from LM model with covariaates in the latent model</h2><span id='topic+draw_lm_cov_latent'></span>

<h3>Description</h3>

<p>Function that draws samples from the LM model with individual covariates with specific parameters.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+drawLMlatent">drawLMlatent</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_lm_cov_latent(X1, X2, param = "multilogit", Psi, Be, Ga, fort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_lm_cov_latent_+3A_x1">X1</code></td>
<td>
<p>desing matrix for the covariates on the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_x2">X2</code></td>
<td>
<p>desing matrix for the covariates on the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr></table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit (n x TT x r)</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix containing the sequence of latent states (n x TT)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# draw a sample for 1000 units, 10 response variable and 2 covariates
n &lt;- 1000
TT &lt;- 5
k &lt;- 2
nc &lt;- 2 #number of covariates
r &lt;- 10 #number of response variables
mb &lt;- 2 #maximum number of response categories
fort &lt;- TRUE


Psi &lt;- matrix(c(0.9,0.1,0.1,0.9), mb, k)
Psi &lt;- array(Psi, c(mb, k, r))
Ga &lt;- matrix(c(-log(0.9/0.1),0.5,1), (nc+1)*(k-1), k)
Be &lt;- array(c(0,0.5,1), (nc+1)*(k-1))
#Simulate covariates
X1 &lt;- matrix(0, n, nc)
for(j in 1:nc) X1[,j] &lt;- rnorm(n)
X2 &lt;- array(0,c(n, TT-1, nc))
for (t in 1:(TT-1)) for(j in 1:nc){
	if(t==1){
		X2[,t,j] &lt;- 0.5*X1[,j] + rnorm(n)
	}else{
		X2[,t,j] &lt;- 0.5 *X2[,t-1,j] + rnorm(n)
	}
}

out &lt;- draw_lm_cov_latent(X1, X2, Psi = Psi, Be = Be, Ga = Ga, fort = fort)

## End(Not run)
</code></pre>

<hr>
<h2 id='draw_lm_cov_latent_cont'>Draw samples from LM model for continuous outcomes with covariaates in the latent model</h2><span id='topic+draw_lm_cov_latent_cont'></span>

<h3>Description</h3>

<p>Function that draws samples from the LM model for continuous outcomes with individual covariates with specific parameters.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+drawLMlatentcont">drawLMlatentcont</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_lm_cov_latent_cont(X1, X2, param = "multilogit", Mu, Si, Be, Ga, fort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_x1">X1</code></td>
<td>
<p>desing matrix for the covariates on the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_x2">X2</code></td>
<td>
<p>desing matrix for the covariates on the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_mu">Mu</code></td>
<td>
<p>array of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="draw_lm_cov_latent_cont_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr></table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix containing the sequence of latent states (n x TT)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# draw a sample for 1000 units, 10 response variable and 2 covariates
n &lt;- 1000
TT &lt;- 5
k &lt;- 2
nc &lt;- 2 #number of covariates
r &lt;- 3 #number of response variables
fort &lt;- TRUE

Mu &lt;- matrix(c(-2,-2,0,0,2,2), r, k)
Si &lt;- diag(r)
Ga &lt;- matrix(c(-log(0.9/0.1),0.5,1), (nc+1)*(k-1), k)
Be &lt;- array(c(0,0.5,1), (nc+1)*(k-1))

#Simulate covariates
X1 &lt;- matrix(0, n, nc)
for(j in 1:nc) X1[,j] &lt;- rnorm(n)
X2 &lt;- array(0, c(n,TT-1,nc))
for (t in 1:(TT-1)) for(j in 1:nc){
	if(t==1){
		X2[,t,j] &lt;- 0.5*X1[,j] + rnorm(n)
	}else{
		X2[,t,j] &lt;- 0.5*X2[,t-1,j] + rnorm(n)
	}
}

out &lt;- draw_lm_cov_latent_cont(X1, X2, param = "multilogit", Mu, Si, Be, Ga, fort = fort)

## End(Not run)
</code></pre>

<hr>
<h2 id='draw_lm_mixed'>Draws samples from the mixed LM model</h2><span id='topic+draw_lm_mixed'></span>

<h3>Description</h3>

<p>Function that draws samples from the mixed LM model with specific parameters.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+drawLMmixed">drawLMmixed</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_lm_mixed(la, Piv, Pi, Psi, n, TT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_lm_mixed_+3A_la">la</code></td>
<td>
<p>vector of mass probabilities for the first latent variable</p>
</td></tr>
<tr><td><code id="draw_lm_mixed_+3A_piv">Piv</code></td>
<td>
<p>matrix of initial probabilities of the latent Markov chain (k2 x k1)</p>
</td></tr>
<tr><td><code id="draw_lm_mixed_+3A_pi">Pi</code></td>
<td>
<p>set of transition matrices (k2 x k2 x k1)</p>
</td></tr>
<tr><td><code id="draw_lm_mixed_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k2 x r)</p>
</td></tr>
<tr><td><code id="draw_lm_mixed_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="draw_lm_mixed_+3A_tt">TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>matrix of distinct response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>corresponding vector of frequencies</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# draw a sample for 1000 units and only one response variable and 5 time occasions
k1 &lt;- 2
k2 &lt;- 3
la &lt;- rep(1/k1,k1)
Piv &lt;- matrix(1/k2,k2,k1)
Pi &lt;- array(0,c(k2,k2,k1))
Pi[,,1] &lt;- diag(k2)
Pi[,,2] &lt;- 1/k2
Psi &lt;- cbind(c(0.6,0.3,0.1),c(0.1,0.3,0.6),c(0.3,0.6,0.1))
out &lt;- draw_lm_mixed(la,Piv,Pi,Psi,n=1000,TT=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='drawLMbasic'>Draw samples from the basic LM model</h2><span id='topic+drawLMbasic'></span>

<h3>Description</h3>

<p>Function that draws samples from the basic LM model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawLMbasic(piv, Pi, Psi, n, est = NULL, format = c("long","matrices"), seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawLMbasic_+3A_piv">piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_pi">Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k x r)</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_est">est</code></td>
<td>
<p>object of class <code>LMbasic</code> (<code><a href="#topic+LMbasic-class">LMbasic-class</a></code>)</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_format">format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td></tr>
<tr><td><code id="drawLMbasic_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>matrix of distinct response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>corresponding vector of frequencies</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k x r)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>object of class <code>LMbasic</code> (<code><a href="#topic+LMbasic-class">LMbasic-class</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# draw a sample for 1000 units and only one response variable
n &lt;- 1000
TT &lt;- 6
k &lt;- 2
r &lt;- 1 #number of response variables
mb &lt;- 3 #maximum number of response categories

piv &lt;- c(0.7,0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Psi &lt;- matrix(c(0.7,0.2,0.1,0.5,0.4,0.1), mb, k)
Psi &lt;- array(Psi, c(mb, k, r))

out &lt;- drawLMbasic(piv, Pi, Psi, n = 1000)


data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

SRHS$srhs &lt;- 5 - SRHS$srhs

est &lt;- lmest(responsesFormula = srhs ~ NULL,
             index = c("id","t"),
             data = SRHS,
             k = 3)

out1 &lt;- drawLMbasic(est = est, format = "matrices", seed = 4321, n = 100)

## End(Not run)
</code></pre>

<hr>
<h2 id='drawLMbasiccont'>Draw samples from the basic LM model for continuous outcomes</h2><span id='topic+drawLMbasiccont'></span>

<h3>Description</h3>

<p>Function that draws samples from the basic LM model for continuous outcomes with specific parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawLMbasiccont(piv, Pi, Mu, Si, n, est = NULL,
                format = c("long","matrices"), seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawLMbasiccont_+3A_piv">piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_pi">Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_mu">Mu</code></td>
<td>
<p>matrix of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_est">est</code></td>
<td>
<p>object of class <code>LMbasiccont</code> (<code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>)</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_format">format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td></tr>
<tr><td><code id="drawLMbasiccont_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>vector of initial probabilities of the latent Markov chain</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>set of transition probabilities matrices (k x k x TT)</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>matrix of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>object of class <code>LMbasiccont</code> (<code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# draw a sample for 1000 units and 3 response variable
n &lt;- 1000
TT &lt;- 5
k &lt;- 2
r &lt;- 3 #number of response variables

piv &lt;- c(0.7,0.3)
Pi &lt;- matrix(c(0.9,0.1,0.1,0.9), k, k)
Pi &lt;- array(Pi, c(k, k, TT))
Pi[,,1] &lt;- 0
Mu &lt;- matrix(c(-2,-2,0,0,2,2), r, k)
Si &lt;- diag(r)
out &lt;- drawLMbasiccont(piv, Pi, Mu, Si, n)

data(data_long_cont)

est &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                 index = c("id", "time"),
                 data = data_long_cont,
                 k = 3,
                 modBasic = 1,
                 tol = 10^-5)

out2 &lt;- drawLMbasiccont(est = est, n = 100, format = "long", seed = 4321)


## End(Not run)


</code></pre>

<hr>
<h2 id='drawLMlatent'>Draw samples from LM model with covariates in the latent model</h2><span id='topic+drawLMlatent'></span>

<h3>Description</h3>

<p>Function that draws samples from the LM model with individual covariates with specific parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawLMlatent(Psi, Be, Ga, latentFormula, data, index,
             paramLatent = c("multilogit","difflogit"), est = NULL,
             format = c("long","matrices"), fort = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawLMlatent_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_latentformula">latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. Detailed description is given in <code><a href="#topic+lmest">lmest</a></code></p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_data">data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to variables, a column corresponding to time occasions and a column containing the unit identifier</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_index">index</code></td>
<td>
<p>a character vector with two elements indicating the name of the &quot;id&quot; column as first element and the &quot;time&quot; column as second element</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_paramlatent">paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_est">est</code></td>
<td>
<p>object of class <code>LMlatent</code> (<code><a href="#topic+LMlatent-class">LMlatent-class</a></code>)</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_format">format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr>
<tr><td><code id="drawLMlatent_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix containing the sequence of latent states (n x TT)</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>array of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. Detailed description is given in <code><a href="#topic+lmest">lmest</a></code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to variables, a column corresponding to time occasions and a column containing the unit identifier</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>object of class <code>LMlatent</code> (<code><a href="#topic+LMlatent-class">LMlatent-class</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long
data_SRHS_long$srhs &lt;- 5 - data_SRHS_long$srhs
est  &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = data_SRHS_long,
              k = 2,
              paramLatent = "multilogit",
              start = 0)

out &lt;- drawLMlatent(est = est,format = "matrices",seed = 4321)

out1 &lt;- drawLMlatent(Psi = est$Psi,Be = est$Be,Ga = est$Ga,
                     data = data_SRHS_long, index = c("id","t"),
                     latentFormula =  ~
                     I(gender - 1) +
                     I( 0 + (race == 2) + (race == 3)) +
                     I(0 + (education == 4)) +
                     I(0 + (education == 5)) +
                     I(age - 50) + I((age-50)^2/100),
                     paramLatent = "multilogit", format = "matrice",
                     seed = 4321)


## End(Not run)
</code></pre>

<hr>
<h2 id='drawLMlatentcont'>Draw samples from LM model for continuous outcomes with covariates in the latent model</h2><span id='topic+drawLMlatentcont'></span>

<h3>Description</h3>

<p>Function that draws samples from the LM model for continuous outcomes with individual covariates with specific parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawLMlatentcont(Mu, Si, Be, Ga, latentFormula, data, index,
                 paramLatent = c("multilogit","difflogit"), est = NULL,
                 format = c("long","matrices"), fort = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawLMlatentcont_+3A_mu">Mu</code></td>
<td>
<p>array of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_si">Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_be">Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_ga">Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_latentformula">latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. A detailed description is given in <code><a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_data">data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to variables, a column corresponding to time occasions and a column containing the unit identifier</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_index">index</code></td>
<td>
<p>a character vector with two elements indicating the name of the &quot;id&quot; column as first element and the &quot;time&quot; column as second element</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_paramlatent">paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_est">est</code></td>
<td>
<p>object of class <code>LMlatentcont</code> (<code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>)</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_format">format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr>
<tr><td><code id="drawLMlatentcont_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>matrix containing the sequence of latent states (n x TT)</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>array of conditional means for the response variables (r x k)</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>parametes affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. A detailed description is given in <code><a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a data frame in long format, with rows corresponding to observations and columns corresponding to variables, a column corresponding to time occasions and a column containing the unit identifier</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>object of class <code>LMlatentcont</code> (<code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(data_long_cont)

est &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3~ NULL,
                 latentFormula = ~ X1 + X2,
                 index = c("id", "time"),
                 data = data_long_cont,
                 k = 3)

out &lt;- drawLMlatentcont(est = est,format = "matrices", seed = 4321)
out1 &lt;- drawLMlatentcont(latentFormula = ~ X1 + X2, data = data_long_cont,
                         index = c("id", "time"),
                         Mu = est$Mu,Si = est$Si,
                         Be = est$Be,Ga = est$Ga, fort=TRUE, seed = 4321, format = "matrices")


## End(Not run)
</code></pre>

<hr>
<h2 id='drawLMmixed'>Draws samples from the mixed LM model</h2><span id='topic+drawLMmixed'></span>

<h3>Description</h3>

<p>Function that draws samples from the mixed LM model with specific parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawLMmixed(la, Piv, Pi, Psi, n, TT, est = NULL,
            format = c("long","matrices"), seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawLMmixed_+3A_la">la</code></td>
<td>
<p>vector of mass probabilities for the first latent variable</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_piv">Piv</code></td>
<td>
<p>matrix of initial probabilities of the latent Markov chain (k2 x k1)</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_pi">Pi</code></td>
<td>
<p>set of transition matrices (k2 x k2 x k1)</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_psi">Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k2 x r)</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_tt">TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_est">est</code></td>
<td>
<p>object of class <code>LMmixed</code> (<code><a href="#topic+LMmixed-class">LMmixed-class</a></code>)</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_format">format</code></td>
<td>
<p>character string indicating the format of final responses matrix</p>
</td></tr>
<tr><td><code id="drawLMmixed_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of response configurations unit by unit</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>matrix of distinct response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>corresponding vector of frequencies</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>vector of mass probabilities for the first latent variable</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>matrix of initial probabilities of the latent Markov chain (k2 x k1)</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>set of transition matrices (k2 x k2 x k1)</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>array of conditional response probabitlies (mb x k2 x r)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>object of class <code>LMmixed</code> (<code><a href="#topic+LMmixed-class">LMmixed-class</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'># draw a sample for 1000 units and only one response variable and 5 time occasions
k1 &lt;- 2
k2 &lt;- 3
la &lt;- rep(1/k1, k1)
Piv &lt;- matrix(1/k2, k2, k1)
Pi &lt;- array(0, c(k2, k2, k1))
Pi[,,1] &lt;- diag(k2)
Pi[,,2] &lt;- 1/k2
Psi &lt;- cbind(c(0.6,0.3,0.1), c(0.1,0.3,0.6), c(0.3,0.6,0.1))
out &lt;- drawLMmixed(la, Piv, Pi, Psi, n = 1000, TT = 5)


## Not run: 
# Example based on criminal data

data(data_criminal_sim)
data_criminal_sim = data.frame(data_criminal_sim)
# Estimate mixed LM model for females

responsesFormula &lt;- lmestFormula(data = data_criminal_sim,
                                  response = "y")$responsesFormula
est &lt;- lmestMixed(responsesFormula = responsesFormula,
                  index = c("id","time"),
                  k1 = 2,
                  k2 = 2,
                  data = data_criminal_sim[data_criminal_sim$sex == 2,])

out &lt;- drawLMmixed(est = est, n = 100,  seed = 4321)


## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_basic'>Estimate basic LM model</h2><span id='topic+est_lm_basic'></span>

<h3>Description</h3>

<p>Main function for estimating the basic LM model.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmest">lmest</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_basic(S, yv, k, start = 0, mod = 0, tol = 10^-8, maxit = 1000,
	                  out_se = FALSE, piv = NULL, Pi = NULL, Psi = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_basic_+3A_s">S</code></td>
<td>
<p>array of available configurations (n x TT x r) with categories starting from 0 (use NA for missing responses)</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_k">k</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_mod">mod</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_piv">piv</code></td>
<td>
<p>initial value of the initial probability vector (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_pi">Pi</code></td>
<td>
<p>initial value of the transition probability matrices (k x k x TT) (if start=2) </p>
</td></tr>
<tr><td><code id="est_lm_basic_+3A_psi">Psi</code></td>
<td>
<p>initial value of the conditional response probabilities (mb x k x r) (if start=2)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each response configuration and time occasion</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response probabilities</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>,
Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example of drug consumption data

# load data
data(data_drug)
data_drug &lt;- as.matrix(data_drug)
S &lt;- data_drug[,1:5]-1
yv &lt;- data_drug[,6]

# fit of the Basic LM model
k &lt;- 3
out &lt;- est_lm_basic(S, yv, k, mod = 1)
summary(out)

# Example based on criminal data

# load criminal data
data(data_criminal_sim)
out &lt;- long2wide(data_criminal_sim, "id" , "time" , "sex",
c("y1","y2","y3","y4","y5","y6","y7","y8","y9","y10"),aggr = T, full = 999)
XX &lt;- out$XX
YY &lt;- out$YY
freq &lt;- out$freq

# fit basic LM model with increasing number of states to select the most suitable
Res0 &lt;- vector("list", 7)
for(k in 1:7){
    Res0[[k]] &lt;- est_lm_basic(YY, freq, k, mod = 1, tol = 10^-4)
    save(list &lt;- ls(), file = "example_criminal_temp.RData")
}
out1 &lt;- Res0[[6]]

## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_basic_cont'>Estimate basic LM model for continuous outcomes</h2><span id='topic+est_lm_basic_cont'></span>

<h3>Description</h3>

<p>Main function for estimating the basic LM model for continuous outcomes.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestCont">lmestCont</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_basic_cont(Y, k, start = 0, mod = 0, tol = 10^-8, maxit = 1000,
                  out_se = FALSE, piv = NULL, Pi = NULL, Mu = NULL, Si = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_basic_cont_+3A_y">Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_k">k</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_mod">mod</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_piv">piv</code></td>
<td>
<p>initial value of the initial probability vector (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_pi">Pi</code></td>
<td>
<p>initial value of the transition probability matrices (k x k x TT) (if start=2) </p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_mu">Mu</code></td>
<td>
<p>initial value of the conditional means (r x k) (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_basic_cont_+3A_si">Si</code></td>
<td>
<p>initial value of the var-cov matrix common to all states (r x r) (if start=2)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>estimate of conditional means of the response variables</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>estimate of var-cov matrix common to all states</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each units and time occasion</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>,
Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based on multivariate longitudinal continuous data


data(data_long_cont)
res &lt;- long2matrices(data_long_cont$id,X=cbind(data_long_cont$X1,data_long_cont$X2),
      Y=cbind(data_long_cont$Y1, data_long_cont$Y2, data_long_cont$Y3))
Y &lt;- res$YY

# fit of the Basic LM model for continuous outcomes
k &lt;- 3
out &lt;- est_lm_basic_cont(Y, k, mod = 1, tol = 10^-5)
summary(out)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_cov_latent'>Estimate LM model with covariates in the latent model</h2><span id='topic+est_lm_cov_latent'></span>

<h3>Description</h3>

<p>Main function for estimating the LM model with covariates in the latent model.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmest">lmest</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_cov_latent(S, X1=NULL, X2=NULL, yv = rep(1,nrow(S)), k, start = 0, tol = 10^-8,
                  maxit = 1000, param = "multilogit", Psi, Be, Ga, fort = TRUE,
                  output = FALSE, out_se = FALSE, fixPsi = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_cov_latent_+3A_s">S</code></td>
<td>
<p>array of available configurations (n x TT x r) with categories starting from 0 (use NA for missing responses)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates affecting the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_x2">X2</code></td>
<td>
<p>array of covariates affecting the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_k">k</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_psi">Psi</code></td>
<td>
<p>intial value of the array of the conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_be">Be</code></td>
<td>
<p>intial value of the parameters affecting the logit for the initial probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_ga">Ga</code></td>
<td>
<p>intial value of the parametes affecting the logit for the transition probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_output">output</code></td>
<td>
<p>to return additional output (V,PI,Piv,Ul)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_+3A_fixpsi">fixPsi</code></td>
<td>
<p>TRUE if Psi is given in input and is not updated anymore</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each response configuration and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response matrix</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for Be</p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for Ga</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia, http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>,
Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Example based on self-rated health status (SRHS) data
# load SRHS data
data(data_SRHS_long)
dataSRHS = data_SRHS_long

TT &lt;- 8
head(dataSRHS)
res &lt;- long2matrices(dataSRHS$id, X = cbind(dataSRHS$gender-1,
dataSRHS$race == 2 | dataSRHS$race == 3, dataSRHS$education == 4,
dataSRHS$education == 5, dataSRHS$age-50, (dataSRHS$age-50)^2/100),
Y = dataSRHS$srhs)

# matrix of responses (with ordered categories from 0 to 4)
S &lt;- 5-res$YY
n &lt;- dim(S)[1]

# matrix of covariates (for the first and the following occasions)
# colums are: gender,race,educational level (2 columns),age,age^2)
X1 &lt;- res$XX[,1,]
X2 &lt;- res$XX[,2:TT,]

# estimate the model
est2f &lt;- est_lm_cov_latent(S, X1, X2, k = 2, output = TRUE, out_se = TRUE)
summary(est2f)

# average transition probability matrix
PI &lt;- round(apply(est2f$PI[,,,2:TT], c(1,2), mean), 4)

# Transition probability matrix for white females with high educational level
ind1 &lt;- X1[,1] == 1 &amp; X1[,2] == 0 &amp; X1[,4] == 1)
PI1 &lt;- round(apply(est2f$PI[,,ind1,2:TT], c(1,2), mean), 4)

# Transition probability matrix for non-white male, low educational level
ind2 &lt;- (X1[,1] == 0 &amp; X1[,2] == 1 &amp; X1[,3] == 0 &amp; X1[,4] == 0)
PI2 &lt;- round(apply(est2f$PI[,,ind2,2:TT], c(1,2), mean), 4)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_cov_latent_cont'>Estimate LM model for continuous outcomes with covariates in the latent model</h2><span id='topic+est_lm_cov_latent_cont'></span>

<h3>Description</h3>

<p>Main function for estimating the LM model for continuous outcomes with covariates in the latent model.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestCont">lmestCont</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_cov_latent_cont(Y, X1 = NULL, X2 = NULL, yv = rep(1,nrow(Y)), k, start = 0,
                       tol = 10^-8, maxit = 1000, param = "multilogit",
                       Mu = NULL, Si = NULL, Be = NULL, Ga = NULL,
                       output = FALSE, out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_cov_latent_cont_+3A_y">Y</code></td>
<td>
<p>array of continuous outcomes (n x TT x r)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates affecting the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_x2">X2</code></td>
<td>
<p>array of covariates affecting the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_k">k</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_param">param</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_mu">Mu</code></td>
<td>
<p>initial value of the conditional means (r x k) (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_si">Si</code></td>
<td>
<p>initial value of the var-cov matrix common to all states (r x r) (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_be">Be</code></td>
<td>
<p>intial value of the parameters affecting the logit for the initial probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_ga">Ga</code></td>
<td>
<p>intial value of the parametes affecting the logit for the transition probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_output">output</code></td>
<td>
<p>to return additional output (V,PI,Piv,Ul)</p>
</td></tr>
<tr><td><code id="est_lm_cov_latent_cont_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>estimate of conditional means of the response variables</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>estimate of var-cov matrix common to all states</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia, http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based on multivariate longitudinal continuous data

data(data_long_cont)
TT &lt;- 5
res &lt;- long2matrices(data_long_cont$id, X = cbind(data_long_cont$X1, data_long_cont$X2),
      Y = cbind(data_long_cont$Y1, data_long_cont$Y2, data_long_cont$Y3))
Y &lt;- res$YY
X1 &lt;- res$XX[,1,]
X2 &lt;- res$XX[,2:TT,]

# estimate the model
est &lt;- est_lm_cov_latent_cont(Y, X1, X2, k = 3, output = TRUE)
summary(est)

# average transition probability matrix
PI &lt;- round(apply(est$PI[,,,2:TT], c(1,2), mean), 4)
PI

## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_cov_manifest'>Estimate LM model with covariates in the measurement model</h2><span id='topic+est_lm_cov_manifest'></span>

<h3>Description</h3>

<p>Main function for estimating LM model with covariates in the measurement model based on a global logit parameterization.  <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmest">lmest</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_cov_manifest(S, X, yv = rep(1,nrow(S)), k, q = NULL, mod = c("LM", "FM"),
                    tol = 10^-8, maxit = 1000, start = 0, mu = NULL, al = NULL,
                    be = NULL, si = NULL, rho = NULL, la = NULL, PI = NULL,
                    output = FALSE, out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_cov_manifest_+3A_s">S</code></td>
<td>
<p>array of available configurations (n x TT) with categories starting from 0</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_x">X</code></td>
<td>
<p>array (n x TT x nc) of covariates with eventually includes lagged response (nc = number of covariates)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_k">k</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_q">q</code></td>
<td>
<p>number of support points for the AR(1) process</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_mod">mod</code></td>
<td>
<p>model (&quot;LM&quot; = Latent Markov with stationary transition, &quot;FM&quot; = finite mixture)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_tol">tol</code></td>
<td>
<p>tolerance for the convergence (optional) and tolerance of conditional probability if tol&gt;1 then return</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_mu">mu</code></td>
<td>
<p>starting value for mu (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_al">al</code></td>
<td>
<p>starting value for al (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_be">be</code></td>
<td>
<p>starting value for be (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_si">si</code></td>
<td>
<p>starting value for si when mod=&quot;FM&quot; (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_rho">rho</code></td>
<td>
<p>starting value for rho when mod=&quot;FM&quot; (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_la">la</code></td>
<td>
<p>starting value for la (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_pi">PI</code></td>
<td>
<p>starting value for PI (optional)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_output">output</code></td>
<td>
<p>to return additional output (PRED0, PRED1)</p>
</td></tr>
<tr><td><code id="est_lm_cov_manifest_+3A_out_se">out_se</code></td>
<td>
<p>TRUE for computing information matrix and standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>vector of cutpoints</p>
</td></tr>
<tr><td><code>al</code></td>
<td>
<p>support points for the latent states</p>
</td></tr>
<tr><td><code>be</code></td>
<td>
<p>estimate of the vector of regression parameters</p>
</td></tr>
<tr><td><code>si</code></td>
<td>
<p>sigma of the AR(1) process (mod = &quot;FM&quot;)</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>parameter vector for AR(1) process (mod = &quot;FM&quot;)</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>vector of initial probabilities</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>transition matrix</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC index</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC index</p>
</td></tr>
<tr><td><code>PRED0</code></td>
<td>
<p>prediction of latent state</p>
</td></tr>
<tr><td><code>PRED1</code></td>
<td>
<p>prediction of the overall latent effect</p>
</td></tr>
<tr><td><code>sebe</code></td>
<td>
<p>standard errors for the regression parameters be</p>
</td></tr>
<tr><td><code>selrho</code></td>
<td>
<p>standard errors for logit type transformation of rho</p>
</td></tr>
<tr><td><code>J1</code></td>
<td>
<p>information matrix</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.
</p>
<p>Bartolucci, F., Bacci, S. and Pennoni, F. (2014) Longitudinal analysis of the 	self-reported health status by mixture latent autoregressive models, <em>Journal of the Royal Statistical Society - series C</em>, <b>63</b>, pp. 267-288</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Example based on self-rated health status (SRHS) data

# load SRHS data
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long
head(dataSRHS)

res &lt;- long2matrices(dataSRHS$id, X = cbind(dataSRHS$gender-1,
 dataSRHS$race == 2 | dataSRHS$race == 3, dataSRHS$education == 4,
dataSRHS$education == 5, dataSRHS$age-50, (dataSRHS$age-50)^2/100),
Y = dataSRHS$srhs)

X &lt;- res$XX
S &lt;- 5-res$YY

# *** fit stationary LM model
res0 &lt;- vector("list", 10)
tol &lt;- 10^-6;
for(k in 1:10){
  res0[[k]] &lt;- est_lm_cov_manifest(S, X, k, 1, mod = "LM", tol)
   save.image("example_SRHS.RData")
}

# *** fit the mixture latent auto-regressive model
tol &lt;- 0.005
res &lt;- vector("list",4)
k &lt;- 1
q &lt;- 51
res[[k]] &lt;- est_lm_cov_manifest(S, X, k, q, mod = "FM", tol, output = TRUE)
for(k in 2:4) res[[k]] &lt;- est_lm_cov_manifest(S, X, k, q = 61, mod = "FM", tol, output = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_lm_mixed'>Estimate mixed LM model</h2><span id='topic+est_lm_mixed'></span>

<h3>Description</h3>

<p>Main function for estimating the mixed LM model with discrete random effect in the latent model. <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestMixed">lmestMixed</a></code> <b>function</b></p>


<h3>Usage</h3>

<pre><code class='language-R'>est_lm_mixed(S, yv = rep(1,nrow(S)), k1, k2, start = 0, tol = 10^-8, maxit = 1000,
                    out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_lm_mixed_+3A_s">S</code></td>
<td>
<p>array of available response configurations (n x TT x r) with categories starting from 0</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_k1">k1</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_k2">k2</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random)</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_lm_mixed_+3A_out_se">out_se</code></td>
<td>
<p>to compute standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>la</code></td>
<td>
<p>estimate of the mass probability vector (distribution of the random effects)</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probabilities</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>posterior probabilities of the random effect</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>,
Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example based of criminal data

# load data
data(data_criminal_sim)
out &lt;- long2wide(data_criminal_sim, "id", "time", "sex",
	 c("y1","y2","y3","y4","y5","y6","y7","y8","y9","y10"), aggr = T, full = 999)

XX &lt;- out$XX
YY &lt;- out$YY
freq &lt;- out$freq
n1 &lt;- sum(freq[XX[,1] == 1])
n2 &lt;- sum(freq[XX[,1] == 2])
n &lt;- sum(freq)

# fit mixed LM model only for females
YY &lt;- YY[XX[,1] == 2,,]
freq &lt;- freq[XX[,1] == 2]
k1 &lt;- 2
k2 &lt;- 2
res &lt;- est_lm_mixed(YY, freq, k1, k2, tol = 10^-8)
summary(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_mc_basic'>Estimate basic Markov chain (MC) model</h2><span id='topic+est_mc_basic'></span>

<h3>Description</h3>

<p>Main function for estimating the basic MC model. <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestMc">lmestMc</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_mc_basic(S, yv, mod = 0, tol = 10^-8, maxit = 1000, out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_mc_basic_+3A_s">S</code></td>
<td>
<p>matrix  (n x TT) of available configurations of the response variable with categories starting from 0</p>
</td></tr>
<tr><td><code id="est_mc_basic_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_mc_basic_+3A_mod">mod</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="est_mc_basic_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="est_mc_basic_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_mc_basic_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>Fy</code></td>
<td>
<p>estimated marginal distribution of the response variable for each time occasion</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>,
Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of drug consumption data

# load data
data(data_drug)
data_drug &lt;- as.matrix(data_drug)
S &lt;- data_drug[,1:5]-1
yv &lt;- data_drug[,6]

# fit of the Basic MC model
out &lt;- est_mc_basic(S, yv, mod = 1, out_se = TRUE)
summary(out)
</code></pre>

<hr>
<h2 id='est_mc_cov'>Estimate Markov chain (MC) model with covariates</h2><span id='topic+est_mc_cov'></span>

<h3>Description</h3>

<p>Main function for estimating the MC model with covariates. <br /> <br /> <b>The function is no longer maintained. Please look at</b> <code><a href="#topic+lmestMc">lmestMc</a></code> <b>function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_mc_cov(S, X1 = NULL, X2 = NULL, yv = rep(1,nrow(S)), start = 0, tol = 10^-8,
	   maxit = 1000, out_se = FALSE, output = FALSE, fort = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_mc_cov_+3A_s">S</code></td>
<td>
<p>matrix of available configurations of the response variable (n x TT) with categories starting from 0</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_x1">X1</code></td>
<td>
<p>matrix of covariates affecting the initial probabilities (n x nc1)</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_x2">X2</code></td>
<td>
<p>array of covariates affecting the transition probabilities (n x TT-1 x nc2)</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random)</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_output">output</code></td>
<td>
<p>to return additional output (PI,Piv)</p>
</td></tr>
<tr><td><code id="est_mc_cov_+3A_fort">fort</code></td>
<td>
<p>to use fortran routine when possible (FALSE for not use fortran)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for Be</p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for Ga</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia, http://www.stat.unipg.it/bartolucci</p>


<h3>References</h3>

<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# Example based on criminal data

# load criminal data
data(data_criminal_sim)

#We consider the response variable referring of crime of type 5

out &lt;- long2wide(data_criminal_sim, "id", "time", "sex",
"y5", aggr = T, full = 999)
XX &lt;- out$XX-1
YY &lt;- out$YY
freq &lt;- out$freq
TT &lt;- 6

X1 &lt;- as.matrix(XX[,1])
X2 &lt;- as.matrix(XX[,2:TT])
# estimate the model
res &lt;- est_mc_cov(S = YY, yv = freq, X1 = X1, X2 = X2, output = TRUE)
summary(res)

# Initial probability for female
Piv0 &lt;- round(colMeans(res$Piv[X1 == 0,]), 4)

# Initial probability for male
Piv1 &lt;- round(colMeans(res$Piv[X1 == 1,]), 4)


## End(Not run)
</code></pre>

<hr>
<h2 id='LMbasic-class'>Class <code>'LMbasic'</code></h2><span id='topic+LMbasic-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmest">lmest</a></code> function for basic Latent Markov (LM) model.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices (k x k x TT)</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>modBasic</code></td>
<td>
<p>model on the transition probabilities: default 0 for time-heterogeneous transition matrices, 1 for time-homogeneous transition matrices, 2 for partial time homogeneity based on two transition matrices one from 2 to (TT-1) and the other for TT.</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response probabilities</p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC for each <code>k</code></p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC for each <code>k</code></p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the estimated posterior probabilities of the latent states for each response configuration and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>array containing the available response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data.frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmest">lmest</a></code></p>

<hr>
<h2 id='LMbasiccont-class'>Class <code>'LMbasiccont'</code></h2><span id='topic+LMbasiccont-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestCont">lmestCont</a></code> function for the latent Markov (LM) model for continuous responses in long format.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices (k x k x TT) </p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>estimate of conditional means of the response variables (r x k)</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>estimate of var-cov matrix common to all states (r x r)</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>modBasic</code></td>
<td>
<p>model on the transition probabilities: default 0 for time-heterogeneous transition matrices, 1 for time-homogeneous transition matrices, 2 for partial time homogeneity based on two transition matrices one from 2 to (TT-1) and the other for TT</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>seMu</code></td>
<td>
<p>standard errors for the conditional means</p>
</td></tr>
<tr><td><code>seSi</code></td>
<td>
<p>standard errors for the var-cov matrix</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>information matrix</p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each units and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini </p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestCont">lmestCont</a></code></p>

<hr>
<h2 id='lmest'>Estimate Latent Markov models  for categorical responses</h2><span id='topic+lmest'></span>

<h3>Description</h3>

<p>Main function for estimating Latent Markov (LM) models for categorical responses.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmest(responsesFormula = NULL, latentFormula = NULL,
      data, index, k = 1:4, start = 0,
      modSel = c("BIC", "AIC"), modBasic = 0,
      modManifest = c("LM", "FM"),
      paramLatent = c("multilogit", "difflogit"),
      weights = NULL, tol = 10^-8, maxit = 1000,
      out_se = FALSE, q = NULL, output = FALSE,
      parInit = list(piv = NULL, Pi = NULL, Psi = NULL,
                     Be = NULL, Ga = NULL, mu = NULL,
                     al = NULL, be = NULL, si = NULL,
                     rho = NULL, la = NULL, PI = NULL,
                     fixPsi = FALSE),
      fort = TRUE, seed = NULL, ntry = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmest_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section</p>
</td></tr>
<tr><td><code id="lmest_+3A_latentformula">latentFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section</p>
</td></tr>
<tr><td><code id="lmest_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> in long format</p>
</td></tr>
<tr><td><code id="lmest_+3A_index">index</code></td>
<td>
<p>a character vector with two elements, the first indicating the name of the unit identifier, and the second the time occasions</p>
</td></tr>
<tr><td><code id="lmest_+3A_k">k</code></td>
<td>
<p>an integer vector specifying the number of latent states (default: <code>1:4</code>)</p>
</td></tr>
<tr><td><code id="lmest_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="lmest_+3A_modsel">modSel</code></td>
<td>
<p>a string indicating the model selection criteria: &quot;BIC&quot; for Bayesian Information Criterion and &quot;AIC&quot; for Akaike Information Criterion Criterion</p>
</td></tr>
<tr><td><code id="lmest_+3A_modbasic">modBasic</code></td>
<td>
<p>model on the transition probabilities (0 for time-heterogeneity, 1 for time-homogeneity, from 2 to (TT-1) partial time-homogeneity of a certain order)</p>
</td></tr>
<tr><td><code id="lmest_+3A_modmanifest">modManifest</code></td>
<td>
<p>model for manifest distribution (<code>"LM"</code> = Latent Markov with stationary transition, <code>"FM"</code> = finite mixture model) where a mixture of AR(1) processes is  estimated with common variance and specific correlation coefficients. </p>
</td></tr>
<tr><td><code id="lmest_+3A_paramlatent">paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="lmest_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights for the available responses</p>
</td></tr>
<tr><td><code id="lmest_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="lmest_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="lmest_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors</p>
</td></tr>
<tr><td><code id="lmest_+3A_q">q</code></td>
<td>
<p>number of support points for the AR(1) process (if modManifest =&quot;FM&quot;)</p>
</td></tr>
<tr><td><code id="lmest_+3A_output">output</code></td>
<td>
<p>to return additional output: <code>V</code>, <code>Ul</code>, <code>S</code>, <code>yv</code>, <code>Pmarg</code> for the basic LM model and for the LM with covariates on the latent model (<code><a href="#topic+LMbasic-class">LMbasic-class</a></code> and <code><a href="#topic+LMlatent-class">LMlatent-class</a></code>) and <code>V</code>, <code>PRED1</code>, <code>S</code>, <code>yv</code>, <code>Pmarg</code> for the LM model with covariates in the measurement model (<code><a href="#topic+LMmanifest-class">LMmanifest-class</a></code>)</p>
</td></tr>
<tr><td><code id="lmest_+3A_parinit">parInit</code></td>
<td>
<p>list of initial model parameters when <code>"start = 2"</code>. For the list of parameters look at <code><a href="#topic+LMbasic-class">LMbasic-class</a></code>, <code><a href="#topic+LMlatent-class">LMlatent-class</a></code> and <code><a href="#topic+LMmanifest-class">LMmanifest-class</a></code></p>
</td></tr>
<tr><td><code id="lmest_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="lmest_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
<tr><td><code id="lmest_+3A_ntry">ntry</code></td>
<td>
<p>to set the number of random initializations</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lmest</code> is a general function for estimating LM models for categorical responses. The function requires data in long format and two additional columns indicating the unit identifier and the time occasions.
</p>
<p>Covariates are allowed to affect manifest distribution (measurement model) or  the initial and transition probabilities (latent model). Two different formulas are employed to specify the different LM models, <code>responsesFormula</code> and <code>latentFormula</code>:
</p>

<ul>
<li><p><code>responsesFormula</code> is used  to specify the measurament model:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br />  the LM model without covariates and two responses (<code>y1</code> and <code>y2</code>) is specified;
</p>
</li>
<li><p><code>responsesFormula = NULL</code><br />  all the columns in the data except the <code>"id"</code> and <code>"time"</code> columns are used as responses to estimate the LM model without covariates;
</p>
</li>
<li><p><code>responsesFormula = y1 ~ x1 + x2</code><br /> the univariate LM model with  response (<code>y1</code>) and two covariates (<code>x1</code> and <code>x2</code>) in the measurement model is specified;
</p>
</li></ul>

</li>
<li><p><code>latentFormula</code> is used to specify the LM model with covariates in the latent model:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code>  <br />
<code>latentFormula = ~ x1 + x2 | x3 + x4</code> <br /> the LM model with two responses (<code>y1</code> and <code>y2</code>) and  two covariates affecting the initial probabilities (<code>x1</code> and <code>x2</code>) and other two affecting the transition probabilities (<code>x3</code> and <code>x4</code>) is specified;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> <code>latentFormula = ~ 1 | x1 + x2</code> <br /> (or <code>latentFormula = ~ NULL | x1 + x2</code>)  <br /> the covariates affect only the transition probabilities and an intercept is specified for the intial probabilities;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> <code>latentFormula = ~ x1 + x2</code> <br /> the LM model with two covariates (<code>x1</code> and <code>x2</code>) affecting both the initial and transition probabilities is specified;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> <code>latentFormula = ~ NULL | NULL</code> <br /> (or <code>latentFormula = ~ 1 | 1</code>) <br /> the LM model with only an intercept on the initial and transition probabilities is specified.
</p>
</li></ul>
</li></ul>

<p>The function also allows us to deal with missing responses, including drop-out and non-monotonic missingness, under the missing-at-random assumption. Missing values for the covariates are not allowed. The LM model with individual covariates in the measurement model is estimated only for complete univariate responses.
</p>
<p>For continuous outcomes see the function <code><a href="#topic+lmestCont">lmestCont</a></code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'LMbasic'</code> for the model without covariates (see <code><a href="#topic+LMbasic-class">LMbasic-class</a></code>), or an object of class <code>'LMmanifest'</code> for the model with covariates on the manifest model (see <code><a href="#topic+LMmanifest-class">LMmanifest-class</a></code>), or an object of class <code>'LMlatent'</code> for the model with covariates on the latent model (see <code><a href="#topic+LMlatent-class">LMlatent-class</a></code>).</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>References</h3>

<p>Bartolucci F., Pandolfi S., Pennoni F. (2017) LMest: An R Package for Latent Markov Models for Longitudinal Categorical
Data, <em>Journal of Statistical Software</em>, <b>81</b>(4), 1-38.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Basic LM model

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

# Categories rescaled to vary from 0 (“poor”) to 4 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

out &lt;- lmest(responsesFormula = srhs ~ NULL,
             index = c("id","t"),
             data = SRHS,
             k = 3,
             start = 1,
             modBasic = 1,
             seed = 123)
out
summary(out)




## Not run: 

## Basic LM model with model selection using BIC

out1 &lt;- lmest(responsesFormula = srhs ~ NULL,
              index = c("id","t"),
              data = SRHS,
              k = 1:5,
              tol = 1e-8,
              modBasic = 1,
              seed = 123, ntry = 2)
out1
out1$Bic

# Basic LM model with model selection using AIC

out2 &lt;- lmest(responsesFormula = srhs ~ NULL,
              index = c("id","t"),
              data = SRHS,
              k = 1:5,
              tol = 1e-8,
              modBasic = 1,
              modSel = "AIC",
              seed = 123, ntry = 2)
out2
out2$Aic

# Criminal data

data(data_criminal_sim)
data_criminal_sim = data.frame(data_criminal_sim)

responsesFormula &lt;- lmestFormula(data = data_criminal_sim,response = "y")$responsesFormula


out3 &lt;- lmest(responsesFormula = responsesFormula,
              index = c("id","time"),
              data =data_criminal_sim,
              k = 1:7,
              modBasic = 1,
              tol = 10^-4)
out3

# Example of drug consumption data

data("data_drug")
long &lt;- data_drug[,-6]-1
long &lt;- data.frame(id = 1:nrow(long),long)
long &lt;- reshape(long,direction = "long",
                idvar = "id",
                varying = list(2:ncol(long)))

out4 &lt;- lmest(index = c("id","time"),
              k = 3, 
              data = long,
              weights = data_drug[,6],
              modBasic = 1)

out4
summary(out4)

### LM model with covariates in the latent model
# Covariates: gender, race, educational level (2 columns), age and age^2

out5 &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = SRHS,
              k = 2,
              paramLatent = "multilogit",
              start = 0)

out5
summary(out5)

### LM model with the above covariates in the measurement model

out6 &lt;- lmest(responsesFormula = srhs ~ -1 +
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) + I(age - 50) +
              I((age-50)^2/100),
              index = c("id","t"),
              data = SRHS,
              k = 2,
              modManifest = "LM",
              out_se = TRUE,
              tol = 1e-8,
              start = 1,
              seed = 123)
out6
summary(out6)

## End(Not run)
</code></pre>

<hr>
<h2 id='lmestCont'>Estimate Latent Markov models for continuous responses</h2><span id='topic+lmestCont'></span>

<h3>Description</h3>

<p>Main function for estimating Latent Markov (LM) models for continuous responses.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestCont(responsesFormula = NULL, latentFormula = NULL,
          data, index, k = 1:4, start = 0,
          modSel = c("BIC", "AIC"), modBasic = 0,
          paramLatent = c("multilogit", "difflogit"),
          weights = NULL, tol = 10^-10,
          maxit = 5000, out_se = FALSE, output = FALSE,
          parInit = list(piv = NULL, Pi = NULL,
                         Mu = NULL, Si = NULL,
                         Be = NULL, Ga = NULL),
           fort = TRUE, seed = NULL, ntry = 0, miss.imp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestCont_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. A detailed description is given in the ‘Details’ section
</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_latentformula">latentFormula</code></td>
<td>
<p>a symbolic description of the model to be fitted. A detailed description is given in the ‘Details’ section
</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> in long format</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_index">index</code></td>
<td>
<p>a character vector with two elements, the first indicating the name of the unit identifier, and the second the time occasions</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_k">k</code></td>
<td>
<p>an integer vector specifying the number of latent states (default: <code>1:4</code>)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_modsel">modSel</code></td>
<td>
<p>a string indicating the model selection criteria: &quot;BIC&quot; for Bayesian Information Criterion and &quot;AIC&quot; for Akaike Information Criterion Criterion</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_modbasic">modBasic</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_paramlatent">paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights for the available responses</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors (By default is set to FALSE)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_output">output</code></td>
<td>
<p>to return additional output (<code>V</code>, <code>Ul</code>, <code>Pmarg</code>) (<code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>,<code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>,<code><a href="#topic+LMmanifestcont-class">LMmanifestcont-class</a></code>)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_parinit">parInit</code></td>
<td>
<p>list of initial model parameters when <code>"start = 2"</code>. For the list of parameters look at <code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>, <code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>, and <code><a href="#topic+LMmanifestcont-class">LMmanifestcont-class</a></code></p>
</td></tr>
<tr><td><code id="lmestCont_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible (By default is set to TRUE)</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_ntry">ntry</code></td>
<td>
<p>to set the number of random initializations</p>
</td></tr>
<tr><td><code id="lmestCont_+3A_miss.imp">miss.imp</code></td>
<td>
<p>how to deal with missing values (TRUE for imputation through the imp.mix function, FALSE for missing at random assumption)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>lmestCont</code> is a general function for estimating LM models for continuous responses. The function requires data in long format and two additional columns indicating the unit identifier and the time occasions.
</p>
<p>Covariates are allowed on the initial and transition probabilities (latent model). Two different formulas are employed to specify the different LM models, <code>responsesFormula</code> and <code>latentFormula</code>:
</p>

<ul>
<li><p><code>responsesFormula</code> is used to specify the measurament model:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> the LM model without covariates and two responses (<code>y1</code> and <code>y2</code>) is specified.
</p>
</li>
<li><p><code>responsesFormula = NULL</code> <br />  all the columns in the data except the <code>"id"</code> and <code>"time"</code> columns are used as responses to estimate the LM model without covariates;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ x1 + x2</code> <br /> the LM model with two responses (<code>y1</code> and <code>y2</code>) and  two covariates in the measurement model is specified;
</p>
</li></ul>

</li>
<li><p><code>latentFormula</code> is used to specify the LM model with covariates in the latent model:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br />  <code>latentFormula = ~ x1 + x2 | x3 + x4</code> <br /> the LM model with two responses (<code>y1</code> and <code>y2</code>) and  two covariates affecting the initial probabilities (<code>x1</code> and <code>x2</code>) and other two affecting the transition probabilities (<code>x3</code> and <code>x4</code>)  is specified;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> <code>latentFormula = ~ 1 | x1 + x2</code> <br /> (or <code>latentFormula = ~ NULL | x1 + x2</code>) <br />  the covariates affect only the transition probabilities and an intercept is specified for the intial probabilities;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br />  <code>latentFormula = ~ x1 + x2</code><br /> the LM model with two covariates (<code>x1</code> and <code>x2</code>) affecting both the initial and transition probabilities is specified;
</p>
</li>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br />  <code>latentFormula = ~ NULL | NULL</code> <br /> (or <code>latentFormula = ~ 1 | 1</code>) <br /> the LM model with only an intercept on the initial and transition probabilities is specified.
</p>
</li></ul>

</li></ul>

<p>The function also allows us to deal with missing responses using the <code>mix</code> package for imputing the missing values. Missing values for the covariates are not allowed.
</p>
<p>For categorical outcomes see the function <code><a href="#topic+lmest">lmest</a>.</code>
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'LMbasiccont'</code> for the model without covariates (see <code><a href="#topic+LMbasiccont-class">LMbasiccont-class</a></code>), an object of class <code>'LMlatentcont'</code> for the model with covariates on the latent model (see <code><a href="#topic+LMlatentcont-class">LMlatentcont-class</a></code>), or an object of class <code>'LMmanifestcont'</code> for the model with covariates on the measurement model (see <code><a href="#topic+LMmanifestcont-class">LMmanifestcont-class</a></code>)).
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni
</p>


<h3>References</h3>

<p>Bartolucci F., Pandolfi S., Pennoni F. (2017) LMest: An R Package for Latent Markov Models for Longitudinal Categorical
Data, <em>Journal of Statistical Software</em>, <b>81</b>(4), 1-38.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestFormula">lmestFormula</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

data(data_long_cont)

# Basic LM model

out &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                 index = c("id", "time"),
                 data = data_long_cont,
                 k = 3,
                 modBasic = 1,
                 tol = 10^-5)

out
summary(out)

# Basic LM model with model selection using BIC

out1 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 1:5,
                  ntry = 2,
                  modBasic = 1,
                  tol = 10^-5)

out1
out1$Bic

# Basic LM model with model selection using AIC

out2 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 1:5,
                  modBasic = 1,
                  ntry = 2,
                  modSel = "AIC",
                  tol = 10^-5)
out2
out2$Aic


# LM model with covariates in the measurement model

out3 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ X1 + X2,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 3,
                  output = TRUE)

out3 
summary(out3)

# LM model with covariates in the latent model

out4 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  latentFormula = ~ X1 + X2,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 3,
                  output = TRUE)

out4
summary(out4)

# LM model with two covariates affecting the initial probabilities and one 
# affecting the transition probabilities 

out5 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  latentFormula = ~ X1 + X2 | X1,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 3,
                  output = TRUE)

out5
summary(out5)


## End(Not run)
</code></pre>

<hr>
<h2 id='lmestData'>Data for <code>LMest</code> functions</h2><span id='topic+lmestData'></span>

<h3>Description</h3>

<p>An object of class <code>lmestData</code> containing data in long format, some necessary information on the data structure and objects for the estimation functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestData(data, id = NULL, time = NULL,
          idAsFactor = TRUE, timeAsFactor = TRUE,
          responsesFormula = NULL, latentFormula = NULL,
          na.rm = FALSE, check.names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestData_+3A_data">data</code></td>
<td>
<p>a matrix or data frame in long format of observation</p>
</td></tr>
<tr><td><code id="lmestData_+3A_id">id</code></td>
<td>
<p>a numeric vector or a string indicating the column with the unit identifier. If NULL, the first column is considered</p>
</td></tr>
<tr><td><code id="lmestData_+3A_time">time</code></td>
<td>
<p>a numeric vector or a string indicating the column with the time occasions. If NULL, the second column is considered, and if the <code>id</code> is not NULL, the function will automatically add the column with the time occasions</p>
</td></tr>
<tr><td><code id="lmestData_+3A_idasfactor">idAsFactor</code></td>
<td>
<p>a logical value indicating whether or not the column with the ids is converted to a factor. (By default is set to TRUE)</p>
</td></tr>
<tr><td><code id="lmestData_+3A_timeasfactor">timeAsFactor</code></td>
<td>
<p>a logical value indicating whether or not the column with the time occasions is converted in a factor. (By default is set to TRUE)</p>
</td></tr>
<tr><td><code id="lmestData_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>A detailed description is given in <code><a href="#topic+lmest">lmest</a>,<a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code id="lmestData_+3A_latentformula">latentFormula</code></td>
<td>
<p>A detailed description is given in <code><a href="#topic+lmest">lmest</a>,<a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code id="lmestData_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether or not the observation with at least a missing value is removed (By default is set to FALSE)</p>
</td></tr>
<tr><td><code id="lmestData_+3A_check.names">check.names</code></td>
<td>
<p>a logical value indicating whether or not the names of the variables are syntactically valid, and adjusted if necessary. (By default is set to FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>'lmestData'</code> with the following objects:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a data.frame object to use in the estimation functions</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>a integer vector with the unit identifier </p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>a integer vector with the time occasions</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observation</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>an integer value indicating number of time occasions</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>an interger value indicating the number of variables (columns except id and time)</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>the response variables</p>
</td></tr>
<tr><td><code>Xmanifest</code></td>
<td>
<p>the variables affecting the measurement model if specified in <code>responsesFormula</code></p>
</td></tr>
<tr><td><code>Xinitial</code></td>
<td>
<p>the variables affecting the initial probabilities of the latent model if specified in <code>latentFormula</code></p>
</td></tr>
<tr><td><code>Xtrans</code></td>
<td>
<p>the variables affecting the transition probabilities of the latent model if specified in <code>latentFormula</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_long_cont)
str(data_long_cont)

## Data with continous resposes

dt &lt;- lmestData(data = data_long_cont, id = "id",time="time")
str(dt)

## Summary of each variable and for each time

summary(dt)

## Summary of each variable

summary(dt, type = "cross")

## Summary of each variable by time

summary(dt, type = "year")

plot(dt)
plot(dt, typePlot = "sh")

#######################

## Not run: 

data("data_criminal_sim")

dt1 &lt;- lmestData(data = data_criminal_sim, id = "id", time = "time")
str(dt1)

summary(dt1, varType = rep("d",ncol(dt1$Y)))

dt2 &lt;- lmestData(data = data_criminal_sim, id = "id", time = "time",
                 responsesFormula = y1 + y2 ~ y3, latentFormula = ~ y7 + y8 | y9 + y10)
str(dt2)

## Summary for responses, covariates on the manifest distribution,
## covariates on intial and transition probabilities

summary(dt2, dataSummary = "responses",varType = rep("d",ncol(dt2$Y)))
summary(dt2, dataSummary = "manifest",varType = rep("d",ncol(dt2$Xmanifest)))
summary(dt2, dataSummary = "initial",varType = rep("d",ncol(dt2$Xinitial)))
summary(dt2, dataSummary = "transition",varType = rep("d",ncol(dt2$Xtrans)))


## End(Not run)

</code></pre>

<hr>
<h2 id='lmestDecoding'>
Perform local and global decoding
</h2><span id='topic+lmestDecoding.LMbasic'></span><span id='topic+lmestDecoding.LMmixed'></span><span id='topic+lmestDecoding.LMmanifest'></span><span id='topic+lmestDecoding.LMlatent'></span><span id='topic+lmestDecoding.LMbasiccont'></span><span id='topic+lmestDecoding'></span>

<h3>Description</h3>

<p>Function that performs local and global decoding (Viterbi algorithm) from the output of <code>lmest</code>, <code>lmestCont</code>, and <code>lmestMixed</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestDecoding(est, sequence = NULL, fort = TRUE, ...)
## S3 method for class 'LMbasic'
lmestDecoding(est, sequence = NULL,fort = TRUE, ...)
## S3 method for class 'LMmanifest'
lmestDecoding(est, sequence = NULL, fort = TRUE, ...)
## S3 method for class 'LMlatent'
lmestDecoding(est, sequence = NULL, fort = TRUE,...)
## S3 method for class 'LMbasiccont'
lmestDecoding(est, sequence = NULL, fort = TRUE,...)
## S3 method for class 'LMmixed'
lmestDecoding(est, sequence = NULL, fort = TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestDecoding_+3A_est">est</code></td>
<td>
<p>an object obtained from a call to <code><a href="#topic+lmest">lmest</a></code>, <code><a href="#topic+lmestCont">lmestCont</a></code>, and <code><a href="#topic+lmestMixed">lmestMixed</a></code></p>
</td></tr>
<tr><td><code id="lmestDecoding_+3A_sequence">sequence</code></td>
<td>
<p>an integer vector indicating the units for the decoding. If <code>NULL</code> the whole observations are considered. (By default is set to NULL)</p>
</td></tr>
<tr><td><code id="lmestDecoding_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="lmestDecoding_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Ul</code></td>
<td>
<p>matrix of local decoded states corresponding to each row of Y</p>
</td></tr>
<tr><td><code>Ug</code></td>
<td>
<p>matrix of global decoded states corresponding to each row of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>References</h3>

<p>Viterbi A. (1967) Error Bounds for Convolutional Codes and an Asymptotically Optimum Decoding Algorithm. <em>IEEE Transactions on Information Theory</em>, <b>13</b>, 260-269.
</p>
<p>Juan B., Rabiner L. (1991) Hidden Markov Models for Speech Recognition. <em>Technometrics</em>, <b>33</b>, 251-272.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Decoding for basic LM model

data("data_drug")
long &lt;- data_drug[,-6]-1
long &lt;- data.frame(id = 1:nrow(long),long)
long &lt;- reshape(long,direction = "long",
                idvar = "id",
                varying = list(2:ncol(long)))

est &lt;- lmest(index = c("id","time"),
             k = 3, 
             data = long,
             weights = data_drug[,6], 
             modBasic = 1)

# Decoding for a single sequence

out1 &lt;- lmestDecoding(est, sequence = 1)

out2 &lt;- lmestDecoding(est, sequence = 1:4)

# Decoding for all sequences

out3 &lt;- lmestDecoding(est)

## Not run: 
# Decoding for LM model  with covariates on the initial and transition probabilities

data("data_SRHS_long")

SRHS &lt;- data_SRHS_long[1:2400,]

# Categories rescaled to vary from 0 (“poor”) to 4 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

est2 &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = SRHS,
              k = 2,
              paramLatent = "difflogit",
              output = TRUE)

# Decoding for a single sequence

out3 &lt;- lmestDecoding(est2, sequence = 1)

# Decoding for the first three sequences

out4 &lt;- lmestDecoding(est2, sequence = 1:3)

# Decoding for all sequences

out5 &lt;- lmestDecoding(est2)

## End(Not run)

</code></pre>

<hr>
<h2 id='lmestFormula'>Formulas for <code>LMest</code> functions</h2><span id='topic+lmestFormula'></span>

<h3>Description</h3>

<p>Bulding formulas for <code><a href="#topic+lmest">lmest</a></code>, <code><a href="#topic+lmestCont">lmestCont</a></code>, <code><a href="#topic+lmestMixed">lmestMixed</a></code>, and <code><a href="#topic+lmestMc">lmestMc</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestFormula(data,
              response, manifest = NULL,
              LatentInitial = NULL, LatentTransition = NULL,
              AddInterceptManifest = FALSE,
              AddInterceptInitial = TRUE,
              AddInterceptTransition = TRUE, responseStart = TRUE,
              manifestStart = TRUE, LatentInitialStart = TRUE,
              LatentTransitionStart = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestFormula_+3A_data">data</code></td>
<td>
<p>a data.frame or a matrix of data</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_response">response</code></td>
<td>
<p>a numeric or character vector indicating the column indices or the names for the response variables</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_manifest">manifest</code></td>
<td>
<p>a numeric or character vector indicating the column indices or the names for the covariates affecting the measurement model</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_latentinitial">LatentInitial</code></td>
<td>
<p>a numeric or character vector indicating the column indices or the names for the covariates affecting the initial probabilities</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_latenttransition">LatentTransition</code></td>
<td>
<p>a numeric or character vector indicating the column indices or the names for the covariates affecting the transition probabilities</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_addinterceptmanifest">AddInterceptManifest</code></td>
<td>
<p>a logical value indicating whether the intercept is added to the covariates affecting the measurement model</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_addinterceptinitial">AddInterceptInitial</code></td>
<td>
<p>a logical value indicating whether the intercept is added to covariates affecting the initial probabilities</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_addintercepttransition">AddInterceptTransition</code></td>
<td>
<p>a logical value indicating whether the intercept is added to covariates affecting the transition probabilities</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_responsestart">responseStart</code></td>
<td>
<p>a logical value indicating whether the response variables names start with <code>response</code> argument</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_manifeststart">manifestStart</code></td>
<td>
<p>a logical value indicating whether the covariates names start with <code>manifest</code> argument</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_latentinitialstart">LatentInitialStart</code></td>
<td>
<p>a logical value indicating whether the covariates names start with <code>LatentInitial</code> argument</p>
</td></tr>
<tr><td><code id="lmestFormula_+3A_latenttransitionstart">LatentTransitionStart</code></td>
<td>
<p>a logical value indicating whether the covariates names start with <code>LatentTransition</code> argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates formulas for <code>responsesFormula</code> and <code>latentFormula</code> to use in <code><a href="#topic+lmest">lmest</a></code>, <code><a href="#topic+lmestCont">lmestCont</a></code>, <code><a href="#topic+lmestMixed">lmestMixed</a></code>, and <code><a href="#topic+lmestMc">lmestMc</a></code>.
</p>


<h3>Value</h3>

<p>Returns a list with <code>responsesFormula</code> and <code>latentFormula</code> objects.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_SRHS_long)
names(data_SRHS_long)

# Formula with response srhs and covariates for both initail and transition: 
# gender,race,educational,age.

## LM model with covariates on the latent model
# and with intercepts on the initial and transition probabilities

fm &lt;- lmestFormula(data = data_SRHS_long,
                   response = "srhs",
                   LatentInitial = 3:6, LatentTransition = 3:6)
fm

## LM model with covariates on the latent model
# and without intercepts on the initial and transition probabilities

fm &lt;- lmestFormula(data = data_SRHS_long,
                   response = "srhs",
                   LatentInitial = 3:6, LatentTransition = 3:6,
                   AddInterceptInitial = FALSE,AddInterceptTransition = FALSE)
fm

######

data(data_criminal_sim)
str(data_criminal_sim)

# Formula with only the responses from y1 to y10

fm &lt;- lmestFormula(data = data_criminal_sim,response = "y")$responsesFormula
fm

# Formula with only the responses from y1 to y10 and intercept for manifest

fm &lt;- lmestFormula(data = data_criminal_sim,
                   response = "y",AddInterceptManifest = TRUE)$responsesFormula
fm


## LM model for continous responses

data(data_long_cont)
names(data_long_cont)

# Formula with response Y1, Y2, no covariate for manifest,
# X1 covariates for initail and X2 covariate for transition

fm &lt;- lmestFormula(data = data_long_cont,
                   response = c("Y"),
                   LatentInitial = "X",
                   LatentTransition = "X2")
fm

## Wrong model specification since two variable start with X.
# Check the starts arguments. 

# For the right model:

fm &lt;- lmestFormula(data = data_long_cont,
                   response = c("Y"),
                   LatentInitial = "X1",LatentTransition = "X2")
fm

## or

fm &lt;- lmestFormula(data = data_long_cont,
                   response = c("Y"),
                   LatentInitial = 6,LatentTransition = "X2",
                   LatentInitialStart = FALSE)
fm

## Not run: 

data(data_criminal_sim)
data_criminal_sim &lt;- data.frame(data_criminal_sim)

# Mixed LM model for females

responsesFormula &lt;- lmestFormula(data = data_criminal_sim,
                                 response = "y")$responsesFormula

out &lt;- lmest(responsesFormula = responsesFormula,
             index = c("id","time"),
             data = data_criminal_sim,
             k = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='lmestMc'>Estimate Markov Chain models</h2><span id='topic+lmestMc'></span>

<h3>Description</h3>

<p>Main function for estimating  Markov Chain (MC) models for categorical responses with or without covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestMc(responsesFormula = NULL,
        data, index, start = 0,
        modBasic = 0, weights = NULL,
        tol = 10^-8, maxit = 1000,
        out_se = FALSE, output = FALSE, fort = TRUE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestMc_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> in long format</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_index">index</code></td>
<td>
<p>a character vector with two elements, the first indicating the name of the unit identifier, and the second the time occasions</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_modbasic">modBasic</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights for the available responses</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors (FALSE is the default option)</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_output">output</code></td>
<td>
<p>to return additional output (<code>PI</code>,<code>Piv</code>) (<code><a href="#topic+MCcov-class">MCcov-class</a></code>)</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible (By default is set to TRUE)</p>
</td></tr>
<tr><td><code id="lmestMc_+3A_seed">seed</code></td>
<td>
<p>An integer value with the random number generator state.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>lmestMc</code> estimates the basic MC model and the MC model with covariates for categorical responses. The function requires data in long format and two additional column indicating the unit identifier and the time occasions.
</p>
<p><code>responsesFormula</code> is used to specify the basic MC models and the model with covariates:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> the MC model without covariates and two responses (<code>y1</code> and <code>y2</code>) is specified;
</p>
</li>
<li><p><code>responsesFormula = NULL</code> <br /> all the columns in the data except the <code>"id"</code> and <code>"time"</code> columns are used to estimate MC without covariates;
</p>
</li>
<li><p><code>responsesFormula = y1 ~ x1 + x2 | x3 + x4</code> <br /> the MC model with one response (<code>y1</code>),  two covariates affecting the initial probabilities (<code>x1</code> and <code>x2</code>) and other two different covariates affecting the transition probabilities (<code>x3</code> and <code>x4</code>) is specified;
</p>
</li>
<li><p><code>responsesFormula = y1 ~ x1 + x2</code> <br /> the MC model with one response (<code>y1</code>) and two covariates (<code>x1</code> and <code>x2</code>) affecting both the initial and transition probabilities is specified.
</p>
</li></ul>

<p>Missing responses are not allowed.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'MCbasic'</code> for the basic model without covariates (see <code><a href="#topic+MCbasic-class">MCbasic-class</a></code>), or an object of class <code>'MCcov'</code> for the model with covariates (see <code><a href="#topic+MCcov-class">MCcov-class</a></code>).
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>References</h3>

<p>Bartolucci F., Pandolfi S., Pennoni F. (2017) LMest: An R Package for Latent Markov Models for Longitudinal Categorical
Data, <em>Journal of Statistical Software</em>, <b>81</b>(4), 1-38.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Basic Markov Chain  model

data("RLMSlong")

# Categories  rescaled from 1 “absolutely unsatisfied” to  5 “absolutely satisfied”

RLMSlong$value &lt;- 5 - RLMSlong$value

out &lt;- lmestMc(responsesFormula = value ~ NULL,
               index = c("id","time"),
               modBasic = 1,
               data = RLMSlong)

out
summary(out)



# Example of drug consumption data

data("data_drug")
long &lt;- data_drug[,-6]
long &lt;- data.frame(id = 1:nrow(long),long)
long &lt;- reshape(long,direction = "long",
                idvar = "id",
                varying = list(2:ncol(long)))

out1 &lt;- lmestMc(index = c("id","time"), data = long,
                weights = data_drug[,6], modBasic = 1, out_se = TRUE)

out1

### MC model with covariates
### Covariates: gender, race, educational level (2 columns), age and age^2

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

# Categories of the responses rescaled from 1 “poor” to 5 “excellent”

SRHS$srhs &lt;- 5 - SRHS$srhs


out2 &lt;- lmestMc(responsesFormula = srhs ~
                I( 0 + (race==2) + (race == 3)) +
                I(0 + (education == 4)) +
                I(0 + (education == 5)) +
                I(age - 50) +
                I((age-50)^2/100),
                index = c("id","t"),
                data = SRHS)
out2
summary(out2)

# Criminal data

data(data_criminal_sim)
data_criminal_sim = data.frame(data_criminal_sim)

out3 &lt;- lmestMc(responsesFormula = y5~sex,
                index = c("id","time"),
                data = data_criminal_sim,
                output = TRUE)

out3


## End(Not run)
</code></pre>

<hr>
<h2 id='lmestMixed'>Estimate mixed Latent Markov models</h2><span id='topic+lmestMixed'></span>

<h3>Description</h3>

<p>Main function for estimating the mixed latent Markov (LM) models  for categorical responses with discrete random effects in the latent model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestMixed(responsesFormula = NULL,
           data, index, k1, k2, start = 0,
           weights = NULL, tol = 10^-8, maxit = 1000,
           out_se = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestMixed_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> in long format</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_index">index</code></td>
<td>
<p>a character vector with two elements, the first indicating the name of the unit identifier, and the second the time occasions</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_k1">k1</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_k2">k2</code></td>
<td>
<p>number of latent states</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_start">start</code></td>
<td>
<p>type of starting values (0 = deterministic, 1 = random, 2 = initial values in input)</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights for the available responses</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors (FALSE is the default option)</p>
</td></tr>
<tr><td><code id="lmestMixed_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator state</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>lmestMixed</code> estimates the mixed LM for categorical data. The function requires data in long format and two additional columns indicating the unit identifier and the time occasions.
</p>
<p><code>responsesFormula</code> is used to specify the responses of the mixed LM model:
</p>

<ul>
<li><p><code>responsesFormula = y1 + y2 ~ NULL</code> <br /> the mixed LM model with two categorical responses (<code>y1</code> and <code>y2</code>) is specified;
</p>
</li>
<li><p><code>responsesFormula = NULL</code> <br /> all the columns in the data except the <code>"id"</code> and <code>"time"</code> columns are used as responses to estimate the mixed LM.
</p>
</li></ul>

<p>Missing responses are not allowed.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'LMmixed'</code>  (see <code><a href="#topic+LMmixed-class">LMmixed-class</a></code>).
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>References</h3>

<p>Bartolucci F., Pandolfi S., Pennoni F. (2017) LMest: An R Package for Latent Markov Models for Longitudinal Categorical
Data, <em>Journal of Statistical Software</em>, <b>81</b>(4), 1-38.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Example based on criminal data

data(data_criminal_sim)
data_criminal_sim &lt;- data.frame(data_criminal_sim)

# Estimate mixed LM model for females

responsesFormula &lt;- lmestFormula(data = data_criminal_sim,
                                 response = "y")$responsesFormula

# fit mixed LM model only for females
out &lt;- lmestMixed(responsesFormula = responsesFormula,
                  index = c("id","time"),
                  k1 = 2,
                  k2 = 2,
                  data = data_criminal_sim[data_criminal_sim$sex == 2,])
out
summary(out)

## End(Not run)

</code></pre>

<hr>
<h2 id='lmestSearch'>Search for the global maximum of the log-likelihood</h2><span id='topic+lmestSearch'></span>

<h3>Description</h3>

<p>Function that searches for the global maximum of the log-likelihood of different models and selects the optimal number of states.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmestSearch(responsesFormula = NULL, latentFormula = NULL,
            data, index, k,
            version = c("categorical", "continuous"),
            weights = NULL, nrep = 2, tol1 = 10^-5,
            tol2 = 10^-10, out_se = FALSE, miss.imp = FALSE, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmestSearch_+3A_responsesformula">responsesFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section of <code><a href="#topic+lmest">lmest</a></code>
</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_latentformula">latentFormula</code></td>
<td>
<p>a symbolic description of the model to fit. A detailed description is given in the ‘Details’ section of <code><a href="#topic+lmest">lmest</a></code>
</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> in long format</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_index">index</code></td>
<td>
<p>a character vector with two elements, the first indicating the name of the unit identifier, and the second the time occasions
</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_k">k</code></td>
<td>
<p>a vector of integer values for the number of latent states</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights for the available responses</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_version">version</code></td>
<td>
<p>type of responses for the LM model: &quot;categorical&quot; and &quot;continuous&quot;</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_nrep">nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_tol1">tol1</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm in the random initializations</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_tol2">tol2</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm in the last deterministic initialization</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_out_se">out_se</code></td>
<td>
<p>to compute the information matrix and standard errors (FALSE is the default option)</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_miss.imp">miss.imp</code></td>
<td>
<p>Only for continuous responses: how to deal with missing values (TRUE for imputation through the imp.mix function, FALSE for missing at random assumption)</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_seed">seed</code></td>
<td>
<p>an integer value with the random number generator</p>
</td></tr>
<tr><td><code id="lmestSearch_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to functions <code><a href="#topic+lmest">lmest</a></code> or <code><a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function combines deterministic and random initializations strategy to reach the global maximum of the model log-likelihood.
It uses one deterministic initialization (<code>start=0</code>) and a number of random initializations (<code>start=1</code>) proportional to the number of latent states. The tolerance level is set equal to 10^-5. Starting from the best solution obtained in this way, a final run is performed (<code>start=2</code>) with a default tolerance level equal to 10^-10.
</p>
<p>Missing responses are allowed according to the model to be estimated.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>'LMsearch'</code> with the following components:
</p>
<table>
<tr><td><code>out.single</code></td>
<td>
<p>Output of every LM model estimated for each number of latent states given in input</p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>Values the Akaike Information Criterion for each number of latent states given in input</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>Values of the Bayesian Information Criterion for each number of latent states given in input</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>Values of log-likelihood for each number of latent states given in input.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>References</h3>

<p>Bartolucci F., Pandolfi S., Pennoni F. (2017) LMest: An R Package for Latent Markov Models for Longitudinal Categorical
Data, <em>Journal of Statistical Software</em>, <b>81</b>(4), 1-38.
</p>
<p>Bartolucci, F., Farcomeni, A. and Pennoni, F. (2013) <em>Latent Markov Models for Longitudinal Data</em>, Chapman and Hall/CRC press.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example with data on drug use in wide format

data("data_drug")
long &lt;- data_drug[,-6]

# add labels referred to the identifier

long &lt;- data.frame(id = 1:nrow(long),long)

# reshape data from the wide to the long format

long &lt;- reshape(long,direction = "long",
                idvar = "id",
                varying = list(2:ncol(long)))

out &lt;- lmestSearch(data = long,
                   index = c("id","time"),
                   version = "categorical",
                   k = 1:3,
                   weights = data_drug[,6],
                   modBasic = 1,
                   seed = 123)

out
summary(out$out.single[[3]])

## Not run: 

### Example with data on self rated health

# LM model with covariates in the measurement model

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:1000,]

# Categories rescaled to vary from 1 (“poor”) to 5 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

out1 &lt;- lmestSearch(data = SRHS,
                    index = c("id","t"),
              version = "categorical",
             responsesFormula = srhs ~ -1 +
             I(gender - 1) +
             I( 0 + (race == 2) + (race == 3)) +
             I(0 + (education == 4)) +
             I(0 + (education == 5)) + I(age - 50) +
             I((age-50)^2/100),
                   k = 1:2,
                   out_se = TRUE,
                   seed = 123)
summary(out1)
summary(out1$out.single[[2]])
                   
## End(Not run)
</code></pre>

<hr>
<h2 id='LMlatent-class'>Class <code>'LMlatent'</code></h2><span id='topic+LMlatent-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmest">lmest</a></code> for Latent Markov (LM) model with covariates in the latent model.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix. The first state is used as reference category when <code>param = "multilogit"</code></p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices. State u is used as reference category when <code>paramLatent = "multilogit"</code></p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities (mb x k x r)</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step of the EM algorithm</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response matrix</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for <code>Be</code></p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for <code>Ga</code></p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC for each <code>k</code></p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC for each <code>k</code></p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each response configuration and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>array containing the available response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmest">lmest</a></code></p>

<hr>
<h2 id='LMlatentcont-class'>Class <code>'LMlatentcont'</code></h2><span id='topic+LMlatentcont-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestCont">lmestCont</a></code> for the Latent Markov (LM) model for continuous responses in long format with covariates in the latent model.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>Mu</code></td>
<td>
<p>estimate of conditional means of the response variables</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>estimate of var-cov matrix common to all states</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion for model selection</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>paramLatent</code></td>
<td>
<p>type of parametrization for the transition probabilities (&quot;multilogit&quot; = standard multinomial logit for every row of the transition matrix, &quot;difflogit&quot; = multinomial logit based on the difference between two sets of parameters)</p>
</td></tr>
<tr><td><code>seMu</code></td>
<td>
<p>standard errors for the conditional means</p>
</td></tr>
<tr><td><code>seSi</code></td>
<td>
<p>standard errors for the var-cov matrix</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for <code>Be</code></p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for Ga</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>information matrix</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each units and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestCont">lmestCont</a></code></p>

<hr>
<h2 id='LMmanifest-class'>Class <code>'LMmanifest'</code></h2><span id='topic+LMmanifest-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmest">lmest</a></code> for Latent Markov (LM) model with covariates in the measurement model.</p>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>vector of cut-points</p>
</td></tr>
<tr><td><code>al</code></td>
<td>
<p>support points for the latent states</p>
</td></tr>
<tr><td><code>be</code></td>
<td>
<p>estimate of the vector of regression parameters</p>
</td></tr>
<tr><td><code>si</code></td>
<td>
<p>sigma of the AR(1) process (mod = &quot;FM&quot;)</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>parameter vector for AR(1) process (mod = &quot;FM&quot;)</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>vector of initial probabilities</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>transition matrix</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of Bayesian Information Criterion</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>modManifest</code></td>
<td>
<p>for LM model with covariates on the manifest model: &quot;LM&quot; = Latent Markov with stationary transition, &quot;FM&quot; = finite mixture model where a mixture of AR(1) processes is estimated with common variance and specific correlation coefficients</p>
</td></tr>
<tr><td><code>sebe</code></td>
<td>
<p>standard errors for the regression parameters be</p>
</td></tr>
<tr><td><code>selrho</code></td>
<td>
<p>standard errors for logit type transformation of rho</p>
</td></tr>
<tr><td><code>J1</code></td>
<td>
<p>information matrix</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each units and time occasion</p>
</td></tr>
<tr><td><code>PRED1</code></td>
<td>
<p>prediction of the overall latent effect</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>array containing the available response configurations</p>
</td></tr>
<tr><td><code>yv</code></td>
<td>
<p>vector of frequencies of the available configurations</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model with each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC for each <code>k</code></p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC for each <code>k</code></p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmest">lmest</a></code></p>

<hr>
<h2 id='LMmanifestcont-class'>Class <code>'LMmanifestcont'</code></h2><span id='topic+LMmanifestcont-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestCont">lmestCont</a></code> for Latent Markov (LM) model for continuous responses in long format with covariates in the measurement model.</p>


<h3>Value</h3>

<table>
<tr><td><code>Al</code></td>
<td>
<p>support points for the latent states</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimate of the vector of regression parameters</p>
</td></tr>
<tr><td><code>Si</code></td>
<td>
<p>estimate of var-cov matrix common to all states</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>vector of initial probabilities</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>transition matrix</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>optimal number of latent states</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of Bayesian Information Criterion</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>modBasic</code></td>
<td>
<p>model on the transition probabilities (0 for time-heter., 1 for time-homog., from 2 to (TT-1) partial homog. of that order)</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood trace at every step</p>
</td></tr>
<tr><td><code>seAl</code></td>
<td>
<p>standard errors for the support points Al</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors regression parameters Be</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
	
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>seSi</code></td>
<td>
<p>standard errors for the var-cov matrix</p>
</td></tr>
<tr><td><code>Lk</code></td>
<td>
<p>vector containing the values of the log-likelihood of the LM model for each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Np</code></td>
<td>
<p>vector containing the number of parameters for each <code>k</code> (latent states)</p>
</td></tr>
<tr><td><code>Bic</code></td>
<td>
<p>vector containing the values of the BIC for each <code>k</code></p>
</td></tr>
<tr><td><code>Aic</code></td>
<td>
<p>vector containing the values of the AIC for each <code>k</code></p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>information matrix</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>array containing the posterior distribution of the latent states for each units and time occasion</p>
</td></tr>
<tr><td><code>Ul</code></td>
<td>
<p>matrix containing the predicted sequence of latent states by the local decoding method</p>
</td></tr>
<tr><td><code>Pmarg</code></td>
<td>
<p>matrix containing the marginal distribution of the latent states</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestCont">lmestCont</a></code></p>

<hr>
<h2 id='LMmixed-class'>Class <code>'LMmixed'</code></h2><span id='topic+LMmixed-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestMixed">lmestMixed</a></code> for the mixed latent Markov (LM) models for categorical data in long format.</p>


<h3>Value</h3>

<table>
<tr><td><code>la</code></td>
<td>
<p>estimate of the mass probability vector (distribution of the random effects)</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probabilities</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>estimate of conditional response probabilities</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>posterior probabilities of the random effect</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>k1</code></td>
<td>
<p>number of support points (latent classes) of the latent variable defining the unobserved clusters</p>
</td></tr>
<tr><td><code>k2</code></td>
<td>
<p>number of support points (latent states) of the latent variable defining the first-order Markov process</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>sela</code></td>
<td>
<p>standard errors for <code>la</code></p>
</td></tr>
<tr><td><code>sePiv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>sePsi</code></td>
<td>
<p>standard errors for the conditional response matrix</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the input data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestMixed">lmestMixed</a></code></p>

<hr>
<h2 id='long2matrices'>From data in the long format to data in array format</h2><span id='topic+long2matrices'></span>

<h3>Description</h3>

<p>Function that transforms data in the long format to data in array format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>long2matrices(id, time = NULL, X = NULL, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="long2matrices_+3A_id">id</code></td>
<td>
<p>vector of subjects id</p>
</td></tr>
<tr><td><code id="long2matrices_+3A_time">time</code></td>
<td>
<p>vector of time occasions</p>
</td></tr>
<tr><td><code id="long2matrices_+3A_x">X</code></td>
<td>
<p>matrix of covariates in long format</p>
</td></tr>
<tr><td><code id="long2matrices_+3A_y">Y</code></td>
<td>
<p>matrix of responses in long format</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>XX</code></td>
<td>
<p>array of covariates (n x TT x nc)</p>
</td></tr>
<tr><td><code>YY</code></td>
<td>
<p>array of responses (n x TT x r)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example based on SRHS data

# load SRHS data
data(data_SRHS_long)
dataSRHS &lt;- data_SRHS_long[1:1600,]
head(dataSRHS)
X &lt;- cbind(dataSRHS$gender-1, dataSRHS$race == 2 | dataSRHS$race == 3,
dataSRHS$education == 4,dataSRHS$education == 5, dataSRHS$age-50,
(dataSRHS$age-50)^2/100)
Y &lt;- dataSRHS$srhs
res &lt;- long2matrices(dataSRHS$id, X = X, Y = Y)
</code></pre>

<hr>
<h2 id='long2wide'>From data in the long format to data in the wide format</h2><span id='topic+long2wide'></span>

<h3>Description</h3>

<p>Function that transforms data in the long format to data in the wide format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>long2wide(data, nameid, namet, colx, coly, aggr = T, full = 999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="long2wide_+3A_data">data</code></td>
<td>
<p>matrix of data</p>
</td></tr>
<tr><td><code id="long2wide_+3A_nameid">nameid</code></td>
<td>
<p>name of the id column</p>
</td></tr>
<tr><td><code id="long2wide_+3A_namet">namet</code></td>
<td>
<p>name of the t column</p>
</td></tr>
<tr><td><code id="long2wide_+3A_colx">colx</code></td>
<td>
<p>vector of the names of the columns of the covariates</p>
</td></tr>
<tr><td><code id="long2wide_+3A_coly">coly</code></td>
<td>
<p>vector of the names of the columns of the responses</p>
</td></tr>
<tr><td><code id="long2wide_+3A_aggr">aggr</code></td>
<td>
<p>if wide aggregated format is required</p>
</td></tr>
<tr><td><code id="long2wide_+3A_full">full</code></td>
<td>
<p>number to use for missing data</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>listid</code></td>
<td>
<p>list of id for every unit</p>
</td></tr>
<tr><td><code>listt</code></td>
<td>
<p>list of the time occasions</p>
</td></tr>
<tr><td><code>data_wide</code></td>
<td>
<p>data in wide format</p>
</td></tr>
<tr><td><code>XX</code></td>
<td>
<p>array of the covariates</p>
</td></tr>
<tr><td><code>YY</code></td>
<td>
<p>array of the responses</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>vector of the corresponding frequencies</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example based on criminal data
# load criminal data
data(data_criminal_sim)
# consider only the first 1000 records to shorten time
out &lt;- long2wide(data_criminal_sim[1:1000,], "id", "time", "sex",
	c("y1","y2","y3","y4","y5","y6","y7","y8","y9","y10"), aggr = TRUE, full = 999)
</code></pre>

<hr>
<h2 id='matrices2long'>From data in array  format to data in long format</h2><span id='topic+matrices2long'></span>

<h3>Description</h3>

<p>Function to convert data with array format in data with long format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrices2long(Y, X1 = NULL, X2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrices2long_+3A_y">Y</code></td>
<td>
<p>array of responses (<code>n x TT x r</code>)</p>
</td></tr>
<tr><td><code id="matrices2long_+3A_x1">X1</code></td>
<td>
<p>array of covariates (<code>n x TT x nc1</code>)</p>
</td></tr>
<tr><td><code id="matrices2long_+3A_x2">X2</code></td>
<td>
<p>array of covariates (<code>n x TT x nc2</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Y</code>, <code>X1</code> and <code>X2</code> must have the same number of observations.</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> with data in long format. The first column indicates the name of the unit identifier, and the second column indicates the time occasions.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Example with data on self rated health

data(data_SRHS_long)
SRHS &lt;- data_SRHS_long[1:1600,]

# Covariates

X &lt;- cbind(SRHS$gender-1,
           SRHS$race == 2 | SRHS$race == 3,
           SRHS$education == 4,
           SRHS$education == 5,
           SRHS$age-50,
           (SRHS$age-50)^2/100)

# Responses

Y &lt;- SRHS$srhs


res &lt;- long2matrices(SRHS$id, X = X, Y = Y)

long &lt;- matrices2long(Y = res$YY, X1 = res$XX)


</code></pre>

<hr>
<h2 id='MCbasic-class'>Class <code>'MCbasic'</code></h2><span id='topic+MCbasic-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestMc">lmestMc</a></code> function for the Markov chain (MC) model without covariates.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>piv</code></td>
<td>
<p>estimate of initial probability vector</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion for model selection</p>
</td></tr>
<tr><td><code>Fy</code></td>
<td>
<p>estimated marginal distribution of the response variable ats each time occasion</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>modBasic</code></td>
<td>
<p>model on the transition probabilities: default 0 for time-heterogeneous transition matrices, 1 for time-homogeneous transition matrices, 2 for partial time homogeneity based on two transition matrices one from 2 to (TT-1) and the other for TT</p>
</td></tr>
<tr><td><code>sepiv</code></td>
<td>
<p>standard errors for the initial probabilities</p>
</td></tr>
<tr><td><code>sePi</code></td>
<td>
<p>standard errors for the transition probabilities</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestMc">lmestMc</a></code></p>

<hr>
<h2 id='MCcov-class'>Class <code>'MCcov'</code></h2><span id='topic+MCcov-class'></span>

<h3>Description</h3>

<p>An S3 class object created by <code><a href="#topic+lmestMc">lmestMc</a></code> function for Markov chain (MC) model for categorical responses in long format with covariates.</p>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood</p>
</td></tr>
<tr><td><code>Be</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the initial probabilities</p>
</td></tr>
<tr><td><code>Ga</code></td>
<td>
<p>estimated array of the parameters affecting the logit for the transition probabilities</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>value of the Akaike Information Criterion (AIC) for model selection</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>value of the Bayesian Information Criterion (BIC) for model selection</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations in the data</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>number of time occasions</p>
</td></tr>
<tr><td><code>seBe</code></td>
<td>
<p>standard errors for <code>Be</code></p>
</td></tr>
<tr><td><code>seGa</code></td>
<td>
<p>standard errors for <code>Ga</code></p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>estimate of initial probability matrix</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>estimate of transition probability matrices</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data frame given in input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmestMc">lmestMc</a></code></p>

<hr>
<h2 id='NLSYlong'>National Longitudinal Survey of Youth data</h2><span id='topic+NLSYlong'></span>

<h3>Description</h3>

<p>Longitudinal dataset in long format deriving  from the National Longitudinal Survey of Youth with information about 581 individuals  followed from 1990 to 1994.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NLSYlong)</code></pre>


<h3>Format</h3>

<p>A data frame with 1743 observations on the following 12 variables.
</p>

<dl>
<dt><code>momage</code></dt><dd><p>mother's age at birth.</p>
</dd>
<dt><code>gender</code></dt><dd><p>0 if male, 1 if female.</p>
</dd>
<dt><code>childage</code></dt><dd><p>child's age at first interview.</p>
</dd>
<dt><code>hispanic</code></dt><dd><p>1 if child is Hispanic, 0 if not.</p>
</dd>
<dt><code>black</code></dt><dd><p>1 if child is black, 0 if not.</p>
</dd>
<dt><code>momwork</code></dt><dd><p>1 if mother works, 0 if not.</p>
</dd>
<dt><code>married</code></dt><dd><p>1 if parents are married, 0 if not.</p>
</dd>
<dt><code>time</code></dt><dd><p>occasion of observation.</p>
</dd>
<dt><code>anti</code></dt><dd><p>a measure of antisocial behavior measured on a scale from 0 to 6.</p>
</dd>
<dt><code>self</code></dt><dd><p>a measure of self-esteem measured on a scale from 6 to 24.</p>
</dd>
<dt><code>pov</code></dt><dd><p>a time varying variable assuming value 1 if family is in poverty, 0 if not.</p>
</dd>
<dt><code>id</code></dt><dd><p>subject id.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.nlsinfo.org/content/cohorts/nlsy79">https://www.nlsinfo.org/content/cohorts/nlsy79</a></p>


<h3>References</h3>

<p>The wide format of this dataset is downloadable from the package 'panelr'.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NLSYlong)
</code></pre>

<hr>
<h2 id='plot'>Plots for Generalized Latent Markov Models</h2><span id='topic+plot.LMbasic'></span><span id='topic+plot.LMbasiccont'></span><span id='topic+plot.LMlatent'></span><span id='topic+plot.LMlatentcont'></span><span id='topic+plot.LMsearch'></span>

<h3>Description</h3>

<p>Plots for outputs of LMest objects: <code>LMbasic</code>, <code>LMbasiccont</code>, <code>LMlatent</code>, <code>LMlatentcont</code>, and <code>LMsearch</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'LMbasic'
plot(x,
                            what = c("modSel", "CondProb", "transitions","marginal"),
                            verbose=interactive(),...)
## S3 method for class 'LMlatent'
plot(x,
                            what = c("modSel", "CondProb", "transitions","marginal"),
                            verbose=interactive(),...)
## S3 method for class 'LMbasiccont'
plot(x,
                                what = c("modSel", "density", "transitions","marginal"),
                                components,verbose=interactive(),...)
## S3 method for class 'LMlatentcont'
plot(x,
                                 what = c("modSel", "density", "transitions","marginal"),
                                 components, verbose=interactive(),...)
## S3 method for class 'LMsearch'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>an object of class <code>LMbasic</code>, <code>LMlatent</code>, <code>LMbasiccont</code>, <code>LMlatentcont</code> or <code>LMsearch</code></p>
</td></tr>
<tr><td><code id="plot_+3A_what">what</code></td>
<td>
<p>a string indicating the type of plot. A detailed description is provided in the ‘Details’ section.</p>
</td></tr>
<tr><td><code id="plot_+3A_components">components</code></td>
<td>
<p>An integer or a vector of integers specifying the components (latent states) to be selected for the &quot;density&quot; plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_verbose">verbose</code></td>
<td>
<p>A logical controlling if a text progress bar is displayed during the
fitting procedure. By default is <code>TRUE</code> if the session is 
interactive, and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Unused argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The type of plots are the following:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>"modSel"</code> </td><td style="text-align: left;"> plot of values of the Bayesian Information Criterion and of the Akaike Information </td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td><td style="text-align: left;"> Criterion for model selection</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"CondProb"</code> </td><td style="text-align: left;"> plot of the estimated  conditional response probabilities</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"density"</code> </td><td style="text-align: left;"> plot of the overall estimated density for continuous responses, with weights given by </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> the estimated marginal distribution of the latent variable. For multivariate continuous </td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td><td style="text-align: left;"> responses a contour plot is provided. If the argument <code>components</code> is specified, the </td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td><td style="text-align: left;"> density plot for the selected components results </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"transitions"</code> </td><td style="text-align: left;"> path diagram of the estimated transition probabilities </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"marginal"</code> </td><td style="text-align: left;"> plot of the estimated marginal distribution of the latent variable </td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>

<p>If argument <code>what</code> is not specified, a menu of choices is proposed in an interactive session.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, Fulvia Pennoni, Alessio Farcomeni, Alessio Serafini</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Plot of basic LM model

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

# Categories rescaled to vary from 0 (“poor”) to 4 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

out &lt;- lmest(responsesFormula = srhs ~ NULL,
            index = c("id","t"),
            data = SRHS,
            k = 1:3,
            start = 1,
            modBasic = 1,
            seed = 123)
out
summary(out)
plot(out)

### Plot of basic LM model for continuous responses

data(data_long_cont)

out1 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 1:5,
                  modBasic=1,
                  tol=10^-5)

plot(out1,what="modSel")

plot(out1,what="density")
plot(out1,what="density",components=c(1,3))


## End(Not run)
</code></pre>

<hr>
<h2 id='print'>Print the output</h2><span id='topic+print.LMbasic'></span><span id='topic+print.LMbasiccont'></span><span id='topic+print.LMlatent'></span><span id='topic+print.LMlatentcont'></span><span id='topic+print.LMmanifest'></span><span id='topic+print.LMmixed'></span><span id='topic+print.MCbasic'></span><span id='topic+print.MCcov'></span><span id='topic+print.LMsearch'></span>

<h3>Description</h3>

<p>Given the output, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LMbasic'
print(x, ...)
## S3 method for class 'LMbasiccont'
print(x, ...)
## S3 method for class 'LMlatent'
print(x, ...)
## S3 method for class 'LMlatentcont'
print(x, ...)
## S3 method for class 'LMmanifest'
print(x, ...)
## S3 method for class 'LMmixed'
print(x, ...)
## S3 method for class 'MCbasic'
print(x, ...)
## S3 method for class 'MCcov'
print(x, ...)
## S3 method for class 'LMsearch'
print(x, modSel = "BIC",...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+lmest">lmest</a></code>,<code><a href="#topic+lmestCont">lmestCont</a></code>,<code><a href="#topic+lmestMixed">lmestMixed</a></code>, and <code><a href="#topic+lmestMc">lmestMc</a></code></p>
</td></tr>
<tr><td><code id="print_+3A_modsel">modSel</code></td>
<td>
<p>a string indicating the model selection criteria: <code>"BIC"</code> (default) for Bayesian Information Criterion and <code>"AIC"</code> for Akaike Information Criterion Criterion</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>

<hr>
<h2 id='PSIDlong'>Dataset about income dynamics</h2><span id='topic+PSIDlong'></span>

<h3>Description</h3>

<p>Longitudinal dataset deriving from the Panel Study of Income Dynamics (PSID) from 1987 to 1993.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PSIDlong)</code></pre>


<h3>Format</h3>

<p>A data frame with 1446 observations on the following  variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>subject id.</p>
</dd>
<dt>time</dt><dd><p>occasion of observation.</p>
</dd>
<dt><code>Y1Fertility</code></dt><dd><p>indicating whether a woman had given birth to a child in a certain year 1 for &quot;yes&quot;, 0 for &quot;no&quot;.</p>
</dd>
<dt><code>Y2Employment</code></dt><dd><p>indicating whether she was employed 1 for &quot;yes&quot;, 0 for &quot;no&quot;.</p>
</dd>
<dt><code>X1Race</code></dt><dd><p>dummy variable equal to 1 for a &quot;black&quot; woman, 0 for &quot;other&quot;.</p>
</dd>
<dt><code>X2Age</code></dt><dd><p>age in 1986, rescaled by its maximum value.</p>
</dd>
<dt><code>X3Age2</code></dt><dd><p>squared age.</p>
</dd>
<dt><code>X4Education</code></dt><dd><p>number of years of schooling.</p>
</dd>
<dt><code>X5Child1_2</code></dt><dd><p>number of children in the family aged between 1 and 2 years, referred to the previous year.</p>
</dd>
<dt><code>X6Child3_5</code></dt><dd><p>number of children in the family aged between 3 and 5 years, referred to the previous year.</p>
</dd>
<dt><code>X7Child6_13</code></dt><dd><p>number of children in the family aged between 6 and 13 years, referred to the previous year.</p>
</dd>
<dt><code>X8Child14</code></dt><dd><p>number of children in the family aged over 14 years, referred to the previous year.</p>
</dd>
<dt><code>X9Income</code></dt><dd><p>income of the husband (in dollars, referred to the previous year, divided by 1,000.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://psidonline.isr.umich.edu">https://psidonline.isr.umich.edu</a></p>


<h3>References</h3>

<p>This dataset is downloadable through the package 'psidR'.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PSIDlong)
</code></pre>

<hr>
<h2 id='RLMSdat'>Dataset about job satisfaction</h2><span id='topic+RLMSdat'></span>

<h3>Description</h3>

<p>Longitudinal dataset deriving from the Russia Longitudinal Monitoring Survey (RLMS) about job satisfaction measured by an ordinal variable at seven different occasions with five categories, <code>1</code> for “absolutely satisfied”, <code>2</code> for  “mostly satisfied”, <code>3</code> for “neutral”, <code>4</code> for “not very satisfied”, and <code>5</code> for “absolutely unsatisfied”.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RLMSdat)</code></pre>


<h3>Format</h3>

<p>A data frame with 1718 observations on the following 7 variables.
</p>

<dl>
<dt><code>IKSJQ</code></dt><dd><p>reported job satisfaction at the 1st occasion</p>
</dd>
<dt><code>IKSJR</code></dt><dd><p>reported job satisfaction at the 2nd occasion</p>
</dd>
<dt><code>IKSJS</code></dt><dd><p>reported job satisfaction at the 3rd occasion</p>
</dd>
<dt><code>IKSJT</code></dt><dd><p>reported job satisfaction at the 4th occasion</p>
</dd>
<dt><code>IKSJU</code></dt><dd><p>reported job satisfaction at the 5th occasion</p>
</dd>
<dt><code>IKSJV</code></dt><dd><p>reported job satisfaction at the 6th occasion</p>
</dd>
<dt><code>IKSJW</code></dt><dd><p>reported job satisfaction at the 7th occasion</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.cpc.unc.edu/projects/rlms-hse">http://www.cpc.unc.edu/projects/rlms-hse</a>, <a href="https://www.hse.ru/org/hse/rlms">https://www.hse.ru/org/hse/rlms</a></p>


<h3>References</h3>

<p>Russia Longitudinal Monitoring survey, RLMS-HSE, conducted by Higher School of Economics and ZAO &quot;Demoscope&quot; together with Carolina Population Center, University of North Carolina at Chapel Hill and the Institute of Sociology RAS</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RLMSdat)
</code></pre>

<hr>
<h2 id='RLMSlong'>Dataset about job satisfaction</h2><span id='topic+RLMSlong'></span>

<h3>Description</h3>

<p>Longitudinal dataset in long format deriving from the Russia Longitudinal Monitoring Survey (RLMS, from Round XVII to Round XXIII, collected from 2008 to 2014)  about job satisfaction measured by an ordinal variable at seven different occasions with five categories, <code>1</code> for “absolutely satisfied”, <code>2</code> for  “mostly satisfied”, <code>3</code> for “neutral”, <code>4</code> for “not very satisfied”, and <code>5</code> for “absolutely unsatisfied”.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RLMSlong)</code></pre>


<h3>Format</h3>

<p>A data frame with 1718 observations on the following 7 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p>occasion of observation.</p>
</dd>
<dt><code>id</code></dt><dd><p>subject id.</p>
</dd>
<dt><code>rlms</code></dt><dd><p>see <code><a href="#topic+RLMSdat">RLMSdat</a></code>.</p>
</dd>
<dt><code>value</code></dt><dd><p>reported job satisfaction  at different time occasions coded as 1 for “absolutely satisfied”, 2 for  “mostly satisfied”, 3 for “neutral”, 4 for “not very satisfied”, 5 for “absolutely unsatisfied”.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.cpc.unc.edu/projects/rlms-hse">http://www.cpc.unc.edu/projects/rlms-hse</a>, <a href="https://www.hse.ru/org/hse/rlms">https://www.hse.ru/org/hse/rlms</a></p>


<h3>References</h3>

<p>Russia Longitudinal Monitoring survey, RLMS-HSE, conducted by Higher School of Economics and ZAO &quot;Demoscope&quot; together with Carolina Population Center, University of North Carolina at Chapel Hill and the Institute of Sociology RAS</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RLMSlong)
</code></pre>

<hr>
<h2 id='se'>Standard errors</h2><span id='topic+se'></span><span id='topic+se.LMbasic'></span><span id='topic+se.LMbasiccont'></span><span id='topic+se.LMlatent'></span><span id='topic+se.LMlatentcont'></span>

<h3>Description</h3>

<p>Function to compute standard errors for the parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se(est, ...)
## S3 method for class 'LMbasic'
se(est, ...)
## S3 method for class 'LMbasiccont'
se(est, ...)
## S3 method for class 'LMlatent'
se(est, ...)
## S3 method for class 'LMlatentcont'
se(est, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="se_+3A_est">est</code></td>
<td>
<p>an object obtained from a call to <code><a href="#topic+lmest">lmest</a></code> and <code><a href="#topic+lmestCont">lmestCont</a></code></p>
</td></tr>
<tr><td><code id="se_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Standard errors for estimates in <code>est</code> object.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# LM model for categorical responses without covariates 

data("data_SRHS_long")
SRHS &lt;- data_SRHS_long[1:2400,]

# Categories rescaled to vary from 0 (“poor”) to 4 (“excellent”)

SRHS$srhs &lt;- 5 - SRHS$srhs

out &lt;- lmest(responsesFormula = srhs ~ NULL,
             index = c("id","t"),
             data = SRHS,
             k = 3,
             modBasic = 1,
             out_se = FALSE)
            
out.se &lt;- se(out)

out1 &lt;- lmest(responsesFormula = srhs ~ NULL,
              index = c("id","t"),
              data = SRHS,
              k = 3,
              modBasic = 1,
              out_se = TRUE)
            
out1.se &lt;- se(out1)

# LM model for categorical responses with covariates on the latent model

out2 &lt;- lmest(responsesFormula = srhs ~ NULL,
              latentFormula =  ~
              I(gender - 1) +
              I( 0 + (race == 2) + (race == 3)) +
              I(0 + (education == 4)) +
              I(0 + (education == 5)) +
              I(age - 50) + I((age-50)^2/100),
              index = c("id","t"),
              data = SRHS,
              k = 2,
              paramLatent = "multilogit",
              start = 0)
              
out2.se &lt;- se(out2)

# LM model for continous responses without covariates 

data(data_long_cont)

out3 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3 ~ NULL,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k =3,
                  modBasic = 1,
                  tol = 10^-5)
                  
out3.se &lt;- se(out3)

# LM model for continous responses with covariates 

out4 &lt;- lmestCont(responsesFormula = Y1 + Y2 + Y3  ~ NULL,
                  latentFormula = ~ X1 + X2 | X1 + X2,
                  index = c("id", "time"),
                  data = data_long_cont,
                  k = 3,
                  output = TRUE)
                  
out4.se &lt;- se(out4)

## End(Not run)
</code></pre>

<hr>
<h2 id='search.model.LM'>Search for the global maximum of the log-likelihood</h2><span id='topic+search.model.LM'></span>

<h3>Description</h3>

<p>Function that searches for the global maximum of the log-likelihood of different models given a vector of possible number of states to try for.  <br /> <br /> <b>The function is no longer maintained. Please look at <code><a href="#topic+lmestSearch">lmestSearch</a></code> function</b>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>search.model.LM(version = c("basic","latent","manifest","basic.cont", "latent.cont"),
                kv, ..., nrep = 2, tol1 = 10^-5, tol2 = 10^-10,out_se = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search.model.LM_+3A_version">version</code></td>
<td>
<p>model to be estimated (&quot;basic&quot; = basic LM model (est_lm_basic function); &quot;latent&quot; = LM model with covariates in the distribution of the latent process (est_lm_cov_latent function); &quot;manifest&quot; = LM model with covariates in the measurement model (est_lm_cov_maifest function),&quot;basic.cont&quot; = basic LM model for continuous outcomes (est_lm_basic_cont function); &quot;latent.cont&quot; = LM model for continuous outcomes with covariates in the distribution of the latent process (est_lm_cov_latent_cont function))</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_kv">kv</code></td>
<td>
<p>vector of possible number of latent states</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed based on the model to be estimated (see details)</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_nrep">nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_tol1">tol1</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm in the random initializations</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_tol2">tol2</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm in the last deterministic initialization</p>
</td></tr>
<tr><td><code id="search.model.LM_+3A_out_se">out_se</code></td>
<td>
<p>TRUE for computing information matrix and standard errors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function combines deterministic and random initializations strategy to reach the global maximum of the model log-likelihood.
It uses one deterministic initialization (start=0) and a number of random initializations (start=1) proportional to the number of latent states. The tolerance level is set equal to 10^-5. Starting from the best solution obtained in this way, a final run is performed (start=2) with a default tolerance level equal to 10^-10.
</p>
<p>Arguments in ... depend on the model to be estimated. They match the arguments to be passed to functions  <code>est_lm_basic</code>, <code>est_lm_cov_latent</code>, <code>est_lm_cov_manifest</code>, <code>est_lm_basic_cont</code>, or <code>est_lm_cov_latent_cont</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>out.single</code></td>
<td>
<p>output of each single model (as from <code>est_lm_basic</code>, <code>est_lm_cov_latent</code> or <code>est_lm_cov_manifest</code>) for each k in kv</p>
</td></tr>
<tr><td><code>aicv</code></td>
<td>
<p>value of AIC index for each k in kv</p>
</td></tr>
<tr><td><code>bicv</code></td>
<td>
<p>value of BIC index for each k in kv</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>value of log-likelihood for each k in kv</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Pandolfi, University of Perugia (IT), http://www.stat.unipg.it/bartolucci</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# example for est_lm_basic
data(data_drug)
data_drug &lt;- as.matrix(data_drug)
S &lt;- data_drug[,1:5]-1
yv &lt;- data_drug[,6]
n &lt;- sum(yv)
# Search Basic LM model

res &lt;- search.model.LM("basic", kv = 1:4, S, yv, mod = 1)
summary(res)


## End(Not run)
</code></pre>

<hr>
<h2 id='summary'>Summary of LM fits</h2><span id='topic+summary.LMbasic'></span><span id='topic+summary.LMbasiccont'></span><span id='topic+summary.LMlatent'></span><span id='topic+summary.LMlatentcont'></span><span id='topic+summary.LMmanifest'></span><span id='topic+summary.LMmixed'></span><span id='topic+summary.MCbasic'></span><span id='topic+summary.MCcov'></span><span id='topic+summary.LMsearch'></span>

<h3>Description</h3>

<p>Summary methods</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LMbasic'
summary(object, ...)
## S3 method for class 'LMbasiccont'
summary(object, ...)
## S3 method for class 'LMlatent'
summary(object, ...)
## S3 method for class 'LMlatentcont'
summary(object, ...)
## S3 method for class 'LMmanifest'
summary(object, ...)
## S3 method for class 'LMmixed'
summary(object, ...)
## S3 method for class 'MCbasic'
summary(object, ...)
## S3 method for class 'MCcov'
summary(object, ...)
## S3 method for class 'LMsearch'
summary(object,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>output from <code><a href="#topic+lmest">lmest</a></code>,<code><a href="#topic+lmestCont">lmestCont</a></code>,<code><a href="#topic+lmestMixed">lmestMixed</a></code>, and <code><a href="#topic+lmestMc">lmestMc</a></code></p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>

<hr>
<h2 id='summary.lmestData'>Summary and plot of <code>lmestData</code></h2><span id='topic+summary.lmestData'></span><span id='topic+plot.lmestData'></span><span id='topic+print.lmestData'></span>

<h3>Description</h3>

<p>Methods for <code>lmestData</code> object providing basic descriptive statistics (summary) and plots.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmestData'
summary(object, type = c("all","cross", "year"),
        dataSummary = c("all", "responses", "manifest", "initial", "transition"),
        varType = rep("c", x$d), digits = getOption("digits"),
        maxsum = 10, maxobs = 20, ...)
## S3 method for class 'lmestData'
plot(x, typePlot = c("s", "sh"),
     dataPlots = c("all", "responses", "manifest", "initial", "transition"),
        ...)
## S3 method for class 'lmestData'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lmestData_+3A_object">object</code></td>
<td>
<p>an object of class <code>lmestData</code></p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_x">x</code></td>
<td>
<p>an object of class <code>lmestData</code></p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_type">type</code></td>
<td>
<p>type of summary to print. <code>all</code> prints a summary for each varaible, and a summary for each variables by time. <code>cross</code> prints a summary for each variable. <code>year</code> prints a summary for each variable by time. The summary is adapted according to <code>varType</code> (By default is set to <code>all</code>)</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_datasummary">dataSummary</code></td>
<td>
<p>a string indicating whether summary is returned: <code>all</code> for the entire data, <code>responses</code>  for the responses, <code>manifest</code> for covariates on the manifest distribution, <code>initial</code> for the covariate affecting the initial probabilities, and <code>transition</code> for the covariates affecting the transition probabilities. (By default is set to <code>all</code>)</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_vartype">varType</code></td>
<td>
<p>a string vector of lengh equal to the number of variables, &quot;c&quot; for continuous and &quot;d&quot; for discrete, indicating wich varaibles are continuos and which are discrete</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_maxsum">maxsum</code></td>
<td>
<p>an integer value indicating the maximum number of levels to print</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_maxobs">maxobs</code></td>
<td>
<p>an integer value indicating the maximun number of observation in which the summary statistics are reported for each observation</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_typeplot">typePlot</code></td>
<td>
<p>a string indicating the type of plot. &quot;s&quot; plots a scaterplot matrix. &quot;sh&quot; plots a scatterplot matrix with the histogram for each variable in the diagonal</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_dataplots">dataPlots</code></td>
<td>
<p>a string indicating whether the plot is returned: <code>all</code> for the entire data, <code>responses</code>  for the responses, <code>manifest</code> for covariates on the manifest distribution, <code>initial</code> for the covariate affecting the initial probabilities, <code>transition</code> for the covariates affecting the transition probabilities.  (By default is set to all)</p>
</td></tr>
<tr><td><code id="summary.lmestData_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci,
Silvia Pandolfi,
Fulvia Pennoni,
Alessio Farcomeni,
Alessio Serafini
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
