<!DOCTYPE html><html lang="en"><head><title>Help for package morse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {morse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#morse-package'><p>MOdelling tools for Reproduction and Survival data in Ecotoxicology</p></a></li>
<li><a href='#cadmium1'><p>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to</p>
cadmium during 21 days</a></li>
<li><a href='#cadmium2'><p>Reproduction and survival data sets for <em>Lymnaea stagnalis</em> exposed to cadmium during 28</p>
days</a></li>
<li><a href='#chlordan'><p>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to</p>
chlordan during 21 days</a></li>
<li><a href='#copper'><p>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to</p>
copper during 21 days</a></li>
<li><a href='#dichromate'><p>Survival data set for <em>Daphnia magna</em> exposed to dichromate</p>
during 21 days</a></li>
<li><a href='#FOCUSprofile'><p>A simulated exposure profile with 11641 time points.</p></a></li>
<li><a href='#is_exposure_constant'><p>Test in a well-formed argument to function 'survData' if the concentration</p>
is constant and different from <code>NA</code> for each replicate (each time-serie)</a></li>
<li><a href='#LCx'><p>Predict <code class="reqn">X</code>% Lethal Concentration at the maximum time point (default).</p></a></li>
<li><a href='#MFx'><p>Predict the Multiplication Factor leading to x% of reduction in survival</p>
at a specific time.</a></li>
<li><a href='#modelData'><p>Create a list giving data to use in Bayesian inference.</p></a></li>
<li><a href='#plot_prior_post'><p>Generic method to plot priors and posteriors.</p></a></li>
<li><a href='#plot_prior_post.survFit'><p>Plot posteriors vs priors</p></a></li>
<li><a href='#plot.LCx'><p>Plotting method for <code>LCx</code> objects</p></a></li>
<li><a href='#plot.MFx'><p>Plotting method for <code>MFx</code> objects</p></a></li>
<li><a href='#plot.reproData'><p>Plotting method for <code>reproData</code> objects</p></a></li>
<li><a href='#plot.reproFitTT'><p>Plotting method for <code>reproFitTT</code> objects</p></a></li>
<li><a href='#plot.survDataCstExp'><p>Plotting method for <code>survData</code> objects</p></a></li>
<li><a href='#plot.survDataVarExp'><p>Plotting method for <code>survDataVarExp</code> objects</p></a></li>
<li><a href='#plot.survFitCstExp'><p>Plotting method for <code>survFit</code> objects</p></a></li>
<li><a href='#plot.survFitPredict'><p>Plotting method for <code>survFitPredict</code> objects</p></a></li>
<li><a href='#plot.survFitPredict_Nsurv'><p>Plotting method for <code>survFitPredict_Nsurv</code> objects.</p></a></li>
<li><a href='#plot.survFitTKTD'><p>Plotting method for <code>survFitTKTD</code> objects</p></a></li>
<li><a href='#plot.survFitTT'><p>Plotting method for <code>survFitTT</code> objects</p></a></li>
<li><a href='#plot.survFitVarExp'><p>Plotting method for <code>survFit</code> objects</p></a></li>
<li><a href='#plotDoseResponse'><p>Plot dose-response from raw data</p></a></li>
<li><a href='#plotDoseResponse.reproData'><p>Plot dose-response from <code>reproData</code> objects</p></a></li>
<li><a href='#plotDoseResponse.survDataCstExp'><p>Plot dose-response from <code>survData</code> objects</p></a></li>
<li><a href='#ppc'><p>Posterior predictive check plot</p></a></li>
<li><a href='#predict_Nsurv_check'><p>Checking goodness-of-fit method for <code>survFitPredict</code> and</p>
<code>survFitPredict_Nsurv</code> objects</a></li>
<li><a href='#predict_ode'><p>Predict method for <code>survFit</code> objects</p></a></li>
<li><a href='#predict_ode.survFit'><p>Predict method for <code>survFit</code> objects</p></a></li>
<li><a href='#predict.survFit'><p>Predict method for <code>survFit</code> objects</p></a></li>
<li><a href='#print.msgTable'><p>Print <code>msgTables</code> objects</p></a></li>
<li><a href='#print.reproFitTT'><p>Print of <code>reproFitTT</code> object</p></a></li>
<li><a href='#print.survFitCstExp'><p>Print of <code>survFit</code> object</p></a></li>
<li><a href='#print.survFitTKTD'><p>Print of <code>survFitTKTD</code> object</p></a></li>
<li><a href='#print.survFitTT'><p>Print of <code>survFitTT</code> object</p></a></li>
<li><a href='#print.survFitVarExp'><p>Print of <code>survFitVarExp</code> object</p></a></li>
<li><a href='#priors_distribution'><p>Density distribution of priors.</p></a></li>
<li><a href='#priors_distribution.survFit'><p>Density distribution of priors from a <code>survFit</code> object.</p></a></li>
<li><a href='#priors_survData'><p>Create a list of scalars giving priors to use in Bayesian inference.</p></a></li>
<li><a href='#propiconazole'><p>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole</p>
during four days</a></li>
<li><a href='#propiconazole_pulse_exposure'><p>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole</p>
during 10 days with time-variable
exposure concentration (non-standard pulsed toxicity experiments)</a></li>
<li><a href='#propiconazole_split'><p>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole</p>
during four days</a></li>
<li><a href='#reproData'><p>Creates a dataset for reproduction toxicity analysis</p></a></li>
<li><a href='#reproDataCheck'><p>Checks if an object can be used to perform reproduction toxicity data analysis</p></a></li>
<li><a href='#reproFitTT'><p>Fits a Bayesian concentration-effect model for target-time reproduction analysis</p></a></li>
<li><a href='#summary.reproData'><p>Summary of <code>reproData</code> object</p></a></li>
<li><a href='#summary.reproFitTT'><p>Summary of <code>reproFitTT</code> object</p></a></li>
<li><a href='#summary.survDataCstExp'><p>Summary of <code>survDataCstExp</code> object</p></a></li>
<li><a href='#summary.survDataVarExp'><p>Summary of <code>survDataVarExp</code> object</p></a></li>
<li><a href='#summary.survFit'><p>Summary of <code>survFit</code> object</p></a></li>
<li><a href='#summary.survFitTKTD'><p>Summary of <code>survFitTKTD</code> object</p></a></li>
<li><a href='#summary.survFitTT'><p>Summary of <code>survFitTT</code> object</p></a></li>
<li><a href='#survData'><p>Creates a data set for survival analysis</p></a></li>
<li><a href='#survData_join'><p>Joins a concentration with a survival data set into an argument for 'survData'</p>
when the concentration varies over time</a></li>
<li><a href='#survFit'><p>Fits a TKTD model for survival analysis using Bayesian inference</p></a></li>
<li><a href='#survFitTKTD'><p>Fits a TKTD for survival analysis using Bayesian inference for <code>survDataTKTD</code> object</p></a></li>
<li><a href='#survFitTT'><p>Fits a Bayesian concentration-response model for target-time survival analysis</p></a></li>
<li><a href='#survFitTT.survDataCstExp'><p>Fits a Bayesian concentration-response model for target-time survival analysis</p></a></li>
<li><a href='#zinc'><p>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to zinc</p>
during 21 days</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modelling Reproduction and Survival Data in Ecotoxicology</td>
</tr>
<tr>
<td>Version:</td>
<td>3.3.4</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Virgile Baudrot &lt;virgile.baudrot@qonfluens.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/morse">https://gitlab.in2p3.fr/mosaic-software/morse</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.in2p3.fr/mosaic-software/morse/-/issues">https://gitlab.in2p3.fr/mosaic-software/morse/-/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Advanced methods for a valuable quantitative environmental risk 
   assessment using Bayesian inference of survival and reproduction Data. Among
   others, it facilitates Bayesian inference of the general unified
   threshold model of survival (GUTS). See our companion paper 
   Baudrot and Charles (2021) &lt;<a href="https://doi.org/10.21105%2Fjoss.03200">doi:10.21105/joss.03200</a>&gt;,
   as well as complementary details in Baudrot et al. (2018)
   &lt;<a href="https://doi.org/10.1021%2Facs.est.7b05464">doi:10.1021/acs.est.7b05464</a>&gt; and Delignette-Muller et al.
   (2017) &lt;<a href="https://doi.org/10.1021%2Facs.est.6b05326">doi:10.1021/acs.est.6b05326</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.0.0) (see
https://mcmc-jags.sourceforge.io)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, deSolve, dplyr, epitools, graphics, grDevices, ggplot2
(&ge; 2.1.0), grid, gridExtra, magrittr, methods, reshape2, rjags
(&ge; 4.0), stats, tibble, tidyr, zoo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-18 12:22:58 UTC; virgile</td>
</tr>
<tr>
<td>Author:</td>
<td>Virgile Baudrot [aut, cre],
  Sandrine Charles [aut],
  Marie Laure Delignette-Muller [aut],
  Wandrille Duchemin [ctb],
  Benoit Goussen [ctb],
  Nils Kehrein [ctb],
  Guillaume Kon-Kam-King [ctb],
  Christelle Lopes [ctb],
  Philippe Ruiz [ctb],
  Alexander Singer [ctb],
  Philippe Veber [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-18 13:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='morse-package'>MOdelling tools for Reproduction and Survival data in Ecotoxicology</h2><span id='topic+morse-package'></span><span id='topic+morse'></span>

<h3>Description</h3>

<p>Provides tools for the analysis of survival/reproduction
toxicity test data in quantitative environmental risk assessment. It can be
used to explore/visualize experimental data, and to get estimates
of <code class="reqn">LC_{x}</code> (<code class="reqn">X</code>% Lethal Concentration) or,
<code class="reqn">EC_{x}</code> (<code class="reqn">X</code>% Effective Concentration) by fitting exposure-response
curves. The <code class="reqn">LC_{x}</code>, <code class="reqn">EC_{x}</code> and parameters of the curve are
provided along with an indication of the uncertainty of the estimation.
<code>morse</code> can also be used to get an estimation of the <code class="reqn">NEC</code> (No Effect Concentration)
by fitting a Toxico-Kinetic Toxico-Dynamic (TKTD) model (GUTS: General Unified Threshold
model of Survival). Within the TKTD-GUTS approach, <code class="reqn">LC(x,t)</code>, <code class="reqn">EC(x,t)</code> and <code class="reqn">MF(x,t)</code>
(<code class="reqn">x</code>% Multiplication Factors aka Lethal Profiles) can be explored in proportion <code class="reqn">x</code> and 
time <code class="reqn">t</code>.
</p>


<h3>Details</h3>

<p>Estimation procedures in <code>morse</code> can be used without a deep knowledge of
their underlying probabilistic model or inference methods. Rather, they
were designed to behave as well as possible without requiring a user to
provide values for some obscure parameters. That said, <code>morse</code> models can also
be used as a first step to tailor new models for more specific situations.
</p>
<p>The package currently handles survival and reproduction data. Functions
dedicated to survival (resp. reproduction) analysis start with a
<code>surv</code> (resp. <code>repro</code>) prefix. <code>morse</code> provides a similar
workflow in both cases:
</p>

<ol>
<li><p> create and validate a data set
</p>
</li>
<li><p> explore a data set
</p>
</li>
<li><p> plot a data set
</p>
</li>
<li><p> fit a model on a data set and output the expected estimates
</p>
</li>
<li><p> check goodness of fit with posterior preditive check plot (ppc)
</p>
</li></ol>

<p>More specifically, for survival data handles with TKTD 'GUTS' model, <code>morse</code>
provides:
</p>

<ol>
<li><p> plot <code class="reqn">LC(x,t)</code> and <code class="reqn">MF(x,t)</code>.
</p>
</li>
<li><p> compute goodness-of-fit measures (PPC percent, NRMSE and SPPE)
</p>
</li></ol>

<p>Those steps are presented in more details in the &quot;Tutorial&quot; vignette, while
a more formal description of the estimation procedures are provided in the
vignette called &quot;Models in <code>morse</code> package&quot;. Please refer to these documents
for further introduction to the use of <code>morse</code>.
</p>
<p>This reference manual is a detailed description of the functions exposed in
the package.
</p>
<p><strong>Getting started</strong> The package uses the <code>rjags</code> package
(Plummer, 2013), an R interface to the JAGS library for Bayesian model
estimation. Note that the <code>rjags</code> package does not include a copy
of the JAGS library: you need to install it separately. For instructions
on downloading JAGS, see the home page at
<a href="https://mcmc-jags.sourceforge.io">https://mcmc-jags.sourceforge.io</a>. Once done, simply follow the steps
described in the tutorial vignette.
</p>

<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> morse</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
3.2.0</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2018-11-15</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Virgile Baudrot  &lt;virgile.baudrot@posteo.net&gt;,
Sandrine Charles &lt;sandrine.charles@univ-lyon1.fr&gt;,
Marie Laure Delignette-Muller &lt;marielaure.delignettemuller@vetagro-sup.fr&gt;,
Wandrille Duchemin &lt;wandrille.duchemin@insa-lyon.fr&gt;,
Benoit Goussen &lt;Benoit.Goussen@ibacon.com&gt;,
Guillaume Kon-Kam-king &lt;guillaume.kon-kam-king@univ-lyon1.fr&gt;,
Christelle Lopes &lt;christelle.lopes@univ-lyon1.fr&gt;,
Philippe Ruiz &lt;philippe.ruiz@univ-lyon1.fr&gt;,
Alexander Singer, &lt;Alexander.Singer@rifcon.de&gt; 
Philippe Veber &lt;philippe.veber@univ-lyon1.fr&gt;
</p>
<p>Maintainer: Philippe Veber &lt;philippe.veber@univ-lyon1.fr&gt;
</p>


<h3>References</h3>

<p>Delignette-Muller, M.L., Ruiz P. and Veber P. (2017)
<em>Robust fit of toxicokinetic-toxicodynamic models using prior knowledge contained in the design of survival toxicity tests</em>.
</p>
<p>Delignette-Muller, M.L., Lopes, C., Veber, P. and Charles, S. (2014)
<em>Statistical handling of reproduction data for exposure-response modelling</em>.
</p>
<p>Forfait-Dubuc, C., Charles, S., Billoir, E. and Delignette-Muller, M.L. (2012)
<em>Survival data analyses in ecotoxicology: critical effect concentrations, methods and models. What should we use?</em>
</p>
<p>Plummer, M. (2013) <em>JAGS Version 4.0.0 user manual</em>.
<a href="https://sourceforge.net/projects/mcmc-jags/files/Manuals/4.x/jags_user_manual.pdf/download">https://sourceforge.net/projects/mcmc-jags/files/Manuals/4.x/jags_user_manual.pdf/download</a>
</p>
<p>Baudrot, V., Preux, S., Ducrot, V., Pavé, A. and Charles, S. (2018)
<em>New insights to compare and choose TKTD models for survival based on an inter-laboratory study for Lymnaea stagnalis exposed to Cd</em>.
</p>
<p>EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>.
</p>


<h3>See Also</h3>

<p><code><a href="rjags.html#topic+rjags">rjags</a></code>,
<code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code>
</p>

<hr>
<h2 id='cadmium1'>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to
cadmium during 21 days</h2><span id='topic+cadmium1'></span>

<h3>Description</h3>

<p>Reproduction and survival data sets of chronic laboratory toxicity tests with
<em>Daphnia magna</em> freshwater invertebrate exposed to five concentrations
of cadmium during 21 days. Five concentrations were
tested, with four replicates per concentration. Each replicate contained 10
organisms. Reproduction and survival were monitored at 10 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cadmium1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations of the following five variables:
</p>

<dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with
the replicate code (<code>1</code> to <code>20</code>).</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of
class <code>numeric</code> with the cadmium concentrations in <code class="reqn">\mu g.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd> <dt><code>Nrepro</code></dt><dd><p>A vector of class <code>integer</code> with the
number of offspring at each time point for each concentration and each
replicate.</p>
</dd> </dl>



<h3>References</h3>

<p>Billoir, E., Delhaye, H., Forfait, C., Clement, B.,
Triffault-Bouchet, G., Charles, S. and Delignette-Muller, M.L. (2012)
Comparison of toxicity tests with different exposure time patterns: The added
value of dynamic modelling in predictive ecotoxicology, <em>Ecotoxicology
and Environmental Safety</em>, 75, 80-86.
</p>

<hr>
<h2 id='cadmium2'>Reproduction and survival data sets for <em>Lymnaea stagnalis</em> exposed to cadmium during 28
days</h2><span id='topic+cadmium2'></span>

<h3>Description</h3>

<p>Reproduction and survival data sets of chronic laboratory toxicity tests with
snails (<em>Lymnaea stagnalis</em>) exposed to six concentrations of cadmium
during 28 days. Six concentrations were tested, with six replicates per
concentration. Each replicate contained five organisms. Reproduction and
survival were monitored at 17 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cadmium2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 612 observations of the following five variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with the
replicate code (<code>1</code> to <code>36</code>).</p>
</dd> <dt><code>conc</code></dt><dd><p>A vector of
class <code>integer</code> with the cadmium concentrations in <code class="reqn">\mu g.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd> <dt><code>Nrepro</code></dt><dd><p>A vector of class <code>integer</code> with the
number of clutches at each time point for each concentration and each
replicate.</p>
</dd> </dl>



<h3>References</h3>

<p>Ducrot, V., Askem, C., Azam, D., Brettschneider, D., Brown,
R., Charles, S., Coke, M., Collinet, M., Delignette-Muller, M.L.,
Forfait-Dubuc, C., Holbech, H., Hutchinson, T., Jach, A., Kinnberg, K.L.,
Lacoste, C., Le Page, G., Matthiessen, P., Oehlmann, J., Rice, L.,
Roberts, E., Ruppert, K., Davis, J.E., Veauvy, C., Weltje, L., Wortham, R.
and Lagadic, L. (2014)
Development and validation of an OECD reproductive toxicity test guideline with
the pond snail Lymnaea stagnalis (Mollusca, Gastropoda),
<em>Regulatory Toxicology and Pharmacology</em>, 70(3), 605-14.
</p>
<p>Charles, S., Ducrot, V., Azam, D., Benstead, R., Brettschneider, D., De Schamphelaere, K.,
Filipe Goncalves, S., Green, J.W., Holbech, H., Hutchinson, T.H., Faber, D., Laranjeiro, F.,
Matthiessen, P., Norrgren, L., Oehlmann, J., Reategui-Zirena, E., Seeland-Fremer, A., Teigeler, M.,
Thome, J.P., Tobor Kaplon, M., Weltje, L., Lagadic, L. (2016) 
Optimizing the design of a reproduction toxicity test with the pond snail Lymnaea stagnalis,
<em>Regulatory Toxicology and Pharmacology</em>, vol. 81 pp.47-56.
</p>

<hr>
<h2 id='chlordan'>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to
chlordan during 21 days</h2><span id='topic+chlordan'></span>

<h3>Description</h3>

<p>Reproduction and survival data sets of chronic laboratory toxicity tests with
<em>Daphnia magna</em> freshwater invertebrate exposed to six concentrations
of one organochlorine insecticide (chlordan) during 21 days. Six concentrations were
tested, with 10 replicates per concentration. Each replicate contained one
organism. Reproduction and survival were monitored at 22 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(chlordan)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1320 observations of the following five variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with
the replicate code (<code>1</code> to <code>60</code>).</p>
</dd> <dt><code>conc</code></dt><dd><p>A vector of
class <code>numeric</code> with the chlordan concentrations in <code class="reqn">\mu
g.L^{-1}</code>.</p>
</dd> <dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the
time points (in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd> <dt><code>Nrepro</code></dt><dd><p>A vector of class <code>integer</code> with the
number of offspring at each time point for each concentration and each
replicate.</p>
</dd> </dl>



<h3>References</h3>

<p>Manar, R., Bessi, H. and Vasseur, P. (2009) Reproductive effects
and bioaccumulation of chlordan in Daphnia magna, <em>Environmental
Toxicology and Chemistry</em>, 28, 2150-2159.
</p>

<hr>
<h2 id='copper'>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to
copper during 21 days</h2><span id='topic+copper'></span>

<h3>Description</h3>

<p>Reproduction and survival data sets of chronic laboratory toxicity tests with
<em>Daphnia magna</em> freshwater invertebrate exposed to five concentrations
of copper during 21 days. Five concentrations were
tested, with three replicates per concentration. Each replicate contained 20
organisms. Reproduction and survival were monitored at 16 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(copper)
</code></pre>


<h3>Format</h3>

<p>A data frame with 240 observations of the following five variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with the
replicate code (<code>1</code> to <code>15</code>).</p>
</dd> <dt><code>conc</code></dt><dd><p>A vector of
class <code>numeric</code> with the copper concentrations in <code class="reqn">\mu g.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd> <dt><code>Nrepro</code></dt><dd><p>A vector of class <code>integer</code> with the
number of offspring at each time point for each concentration and each
replicate.</p>
</dd> </dl>



<h3>References</h3>

<p>Billoir, E., Delignette-Muller, M.L., Pery, A.R.R. and
Charles, S. (2008) A Bayesian Approach to Analyzing Ecotoxicological Data,
<em>Environmental Science &amp; Technology</em>, 42 (23), 8978-8984.
</p>

<hr>
<h2 id='dichromate'>Survival data set for <em>Daphnia magna</em> exposed to dichromate
during 21 days</h2><span id='topic+dichromate'></span>

<h3>Description</h3>

<p>Survival data set of chronic laboratory toxicity tests with
<em>Daphnia magna</em> freshwater invertebrate exposed to six concentrations
of one oxidizing agent (potassium dichromate) during 21 days. Six
concentrations were tested with one replicate of 50 organisms per concentration.
Survival is monitored at 10 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dichromate)
</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following four variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with the
replicate code (<code>1</code>).</p>
</dd> <dt><code>conc</code></dt><dd><p>A vector of
class <code>numeric</code> with dichromate concentrations in <code class="reqn">mg.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd></dl>



<h3>References</h3>

<p>Bedaux, J., Kooijman, SALM (1994) Statistical analysis of toxicity tests,
based on hazard modeling, <em>Environmental and Ecological Statistics</em>, 1,
303-314.
</p>

<hr>
<h2 id='FOCUSprofile'>A simulated exposure profile with 11641 time points.</h2><span id='topic+FOCUSprofile'></span>

<h3>Description</h3>

<p>Exposure profile of 11641 time points used for prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(FOCUSprofile)
</code></pre>


<h3>Format</h3>

<p>A data frame with 11641 observations on the following two variables:
</p>
 <dl>
<dt><code>time</code></dt><dd><p>A vector of class <code>numeric</code>.</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with exposure concentrations.</p>
</dd></dl>
<p> and 
</p>
<dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>factor</code>.</p>
</dd> </dl>


<hr>
<h2 id='is_exposure_constant'>Test in a well-formed argument to function 'survData' if the concentration
is constant and different from <code>NA</code> for each replicate (each time-serie)</h2><span id='topic+is_exposure_constant'></span>

<h3>Description</h3>

<p>Test in a well-formed argument to function 'survData' if the concentration
is constant and different from <code>NA</code> for each replicate (each time-serie)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_exposure_constant(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_exposure_constant_+3A_x">x</code></td>
<td>
<p>an object of class <code>data.frame</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean <code>TRUE</code> if concentration in <code>replicate</code> is constant,
or <code>FALSE</code> if the concentration in at least one of the replicates is time-variable,
and/or if <code>NA</code> occures.
</p>

<hr>
<h2 id='LCx'>Predict <code class="reqn">X</code>% Lethal Concentration at the maximum time point (default).</h2><span id='topic+LCx'></span><span id='topic+LCx.survFit'></span>

<h3>Description</h3>

<p>Predict median and 95% credible interval of the x% Lethal Concentration.
</p>
<p>The function <code>LCx</code>, <code class="reqn">x</code>% Lethal Concentration (<code class="reqn">LC_x</code>), is use to compute
the dose required to kill <code class="reqn">x</code>% of the members of a tested population
after a specified test duration (<code>time_LCx</code>) (default is the maximum
time point of the experiment).
</p>
<p>Mathematical definition of <code class="reqn">x</code>% Lethal Concentration at time <code class="reqn">t</code>,
denoted <code class="reqn">LC(x,t)</code>, is:
</p>
<p><code class="reqn">S(LC(x,t), t) = S(0, t)*(1- x/100)</code>,
</p>
<p>where <code class="reqn">S(LC(x,t), t)</code> is the survival probability at concentration
<code class="reqn">LC(x,t)</code> at time <code class="reqn">t</code>, and <code class="reqn">S(0,t)</code> is the survival probability at
no concentration (i.e. concentration is <code class="reqn">0</code>) at time <code class="reqn">t</code> which
reflect the background mortality <code class="reqn">h_b</code>:
</p>
<p><code class="reqn">S(0, t) = exp(-hb* t)</code>.
</p>
<p>In the function <code>LCx</code>, we use the median of <code class="reqn">S(0,t)</code> to rescale the
<code class="reqn">x</code>% Lethal Concentration at time <code class="reqn">t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LCx(object, ...)

## S3 method for class 'survFit'
LCx(object, X, time_LCx = NULL, conc_range = NULL, npoints = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LCx_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code></p>
</td></tr>
<tr><td><code id="LCx_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="LCx_+3A_x">X</code></td>
<td>
<p>Percentage of individuals dying (e.g., <code class="reqn">50</code> for <code class="reqn">LC_{50}</code>, <code class="reqn">10</code> for <code class="reqn">LC_{10}</code>, ...)</p>
</td></tr>
<tr><td><code id="LCx_+3A_time_lcx">time_LCx</code></td>
<td>
<p>A number giving the time at which  <code class="reqn">LC_{x}</code> has to be estimated. 
If NULL, the latest time point of the experiment is used.</p>
</td></tr>
<tr><td><code id="LCx_+3A_conc_range">conc_range</code></td>
<td>
<p>A vector of length 2 with minimal and maximal value of the 
range of concentration. If NULL, the range is
define between 0 and the highest tested concentration of the experiment.</p>
</td></tr>
<tr><td><code id="LCx_+3A_npoints">npoints</code></td>
<td>
<p>Number of time point in <code>conc_range</code> between 0 and the maximal concentration. 100 by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When class of <code>object</code> is <code>survFit</code>, see <a href="#topic+LCx.survFit">LCx.survFit</a>.
</p>


<h3>Value</h3>

<p>returns an object of class <code>LCx</code>.
</p>
<p>The function returns an object of class <code>LCx</code>, which is a list
with the following information:
</p>
<table role = "presentation">
<tr><td><code>X_prop</code></td>
<td>
<p>Survival probability of individuals surviving considering the median
of the background mortality (i.e. <code class="reqn">S(0, t)*(1- x/100)</code>)</p>
</td></tr>
<tr><td><code>X_prop_provided</code></td>
<td>
<p>Survival probability of individuals surviving as provided in arguments (i.e. <code class="reqn">(100-X)/100)</code></p>
</td></tr>
<tr><td><code>time_LCx</code></td>
<td>
<p>A number giving the time at which  <code class="reqn">LC_{x}</code> has to be
estimated as provided in arguments or if NULL, the latest time point of the
experiment is used.</p>
</td></tr>
<tr><td><code>df_LCx</code></td>
<td>
<p>A <code>data.frame</code> with quantiles (median, 2.5% and 97.5%)
of <code class="reqn">LC_{X}</code> at time <code>time_LCx</code> for <code class="reqn">X</code>% of individuals</p>
</td></tr>
<tr><td><code>df_dose</code></td>
<td>
<p>A <code>data.frame</code> with four columns: <code>concentration</code>, and median <code>q50</code> and 95% credible interval
(<code>qinf95</code> and <code>qsup95</code>) of the survival probability at time <code>time_LCx</code></p>
</td></tr>
</table>

<hr>
<h2 id='MFx'>Predict the Multiplication Factor leading to x% of reduction in survival
at a specific time.</h2><span id='topic+MFx'></span><span id='topic+MFx.survFit'></span><span id='topic+MFx_ode'></span><span id='topic+MFx_ode.survFit'></span>

<h3>Description</h3>

<p>Generic method for <code>MFx</code>, a function denoted <code class="reqn">MF(x,t)</code> for 
<code class="reqn">x</code>% Multiplication Factor at time <code class="reqn">t</code>.
</p>
<p>The function <code>MFx</code>, <code class="reqn">x</code>% Multiplication Factor at time <code class="reqn">t</code>, (<code class="reqn">MF(x,t)</code>),
is used to compute the multiplication factor
applied to the concentration exposure profile in order to
reduce by <code class="reqn">x</code>% (argument <code>X</code>) the survival probability at a
specified test duration <code class="reqn">t</code> (argument <code>time_MFx</code>) (default is the maximum
time point of the experiment).
</p>
<p>Mathematical definition of <code class="reqn">x</code>% Multiplication Factor at time <code class="reqn">t</code>
(at the end of a time series <code class="reqn">T = \{0, \dots, t\}</code>),
denoted <code class="reqn">MF(x,t)</code>, is given by:
</p>
<p><code class="reqn">S(MF(x,t) * C_w(\tau \in T), t) = S( C_w(\tau \in T), t)*(1- x/100)</code>,
</p>
<p>where <code class="reqn">C_w(\tau \in T)</code> is the initial exposure profile without
multiplication factor. And so the expression <code class="reqn">S(MF(x,t)* C_w(\tau \in T), t)</code>
is the survival probability after an exposure profile
<code class="reqn">MF(x,t)* C_w(\tau \in T)</code> at time <code class="reqn">t</code>.
</p>
<p>This is a <code>method</code> to replace function <code>MFx</code> used on <code>survFit</code>
object when computing issues happen. <code>MFx_ode</code> uses the <code>deSolve</code>
library to improve robustness. However, time to compute may be longer.
</p>
<p>The function <code>MFx_ode</code>, <code class="reqn">x</code>% Multiplication Factor at time <code class="reqn">t</code>, (<code class="reqn">MF(x,t)</code>),
is used to compute the multiplication factor
applied to the concentration exposure profile in order to
reduce by <code class="reqn">x</code>% (argument <code>X</code>) the survival probability at a
specified test duration <code class="reqn">t</code> (argument <code>time_MFx</code>) (default is the maximum
time point of the experiment).
</p>
<p>Mathematical definition of <code class="reqn">x</code>% Multiplication Factor at time <code class="reqn">t</code>
(at the end of a time series <code class="reqn">T = \{0, \dots, t\}</code>),
denoted <code class="reqn">MF(x,t)</code>, is given by:
</p>
<p><code class="reqn">S(MF(x,t) * C_w(\tau \in T), t) = S( C_w(\tau \in T), t)*(1- x/100)</code>,
</p>
<p>where <code class="reqn">C_w(\tau \in T)</code> is the initial exposure profile without
multiplication factor. And so the expression <code class="reqn">S(MF(x,t)* C_w(\tau \in T), t)</code>
is the survival probability after an exposure profile
<code class="reqn">MF(x,t)* C_w(\tau \in T)</code> at time <code class="reqn">t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFx(object, ...)

## S3 method for class 'survFit'
MFx(
  object,
  data_predict,
  X = 50,
  time_MFx = NULL,
  MFx_range = c(0, 1000),
  mcmc_size = 1000,
  hb_value = TRUE,
  spaghetti = FALSE,
  accuracy = 0.01,
  quiet = FALSE,
  threshold_iter = 100,
  hb_valueFORCED = 0,
  ode = TRUE,
  interpolate_length = NULL,
  interpolate_method = "linear",
  ...
)

MFx_ode(object, ...)

## S3 method for class 'survFit'
MFx_ode(
  object,
  data_predict,
  X = 50,
  time_MFx = NULL,
  MFx_range = c(0, 1000),
  mcmc_size = 1000,
  hb_value = TRUE,
  spaghetti = FALSE,
  accuracy = 0.01,
  quiet = FALSE,
  threshold_iter = 100,
  hb_valueFORCED = 0,
  interpolate_length = NULL,
  interpolate_method = "linear",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MFx_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="MFx_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="MFx_+3A_data_predict">data_predict</code></td>
<td>
<p>A dataframe with two columns <code>time</code> and <code>conc</code>.</p>
</td></tr>
<tr><td><code id="MFx_+3A_x">X</code></td>
<td>
<p>Percentage of survival change (e.g., <code class="reqn">50</code> for survival decrease of 50%
, or <code class="reqn">-50</code> for survival increase of 50%).The default is 50. 
Only time series computed during the adaptation using a binary search in
<code class="reqn">O(log(n))</code> are returned. However, if <code>NULL</code>, all time series
computed from the vector <code>MFx_range</code> are returned.</p>
</td></tr>
<tr><td><code id="MFx_+3A_time_mfx">time_MFx</code></td>
<td>
<p>A number giving the time at which  <code class="reqn">MF(x,t)</code> has to be estimated. 
If NULL, the latest time point of the profile is used.</p>
</td></tr>
<tr><td><code id="MFx_+3A_mfx_range">MFx_range</code></td>
<td>
<p>A vector from which lower and upper bound of the range of the
multiplication factor <code>MFx</code> are generated. The default is a vector <code>c(0, 1000)</code>.
If argument <code>X</code> is <code>NULL</code>, then all the time series generated with
<code>MFx_range</code> are returned.</p>
</td></tr>
<tr><td><code id="MFx_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>Can be used to reduce the number of MCMC samples in order to speed up
the computation. The default is 1000.</p>
</td></tr>
<tr><td><code id="MFx_+3A_hb_value">hb_value</code></td>
<td>
<p>If <code>TRUE</code>, the background mortality <code>hb</code> is taken into
account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to 0. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="MFx_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, return a set of survival curves using
parameters drawn from the posterior distribution.</p>
</td></tr>
<tr><td><code id="MFx_+3A_accuracy">accuracy</code></td>
<td>
<p>Accuracy of the multiplication factor. The default is 0.01.</p>
</td></tr>
<tr><td><code id="MFx_+3A_quiet">quiet</code></td>
<td>
<p>If <code>FALSE</code>, print the evolution of accuracy.</p>
</td></tr>
<tr><td><code id="MFx_+3A_threshold_iter">threshold_iter</code></td>
<td>
<p>Threshold number of iteration.</p>
</td></tr>
<tr><td><code id="MFx_+3A_hb_valueforced">hb_valueFORCED</code></td>
<td>
<p>If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>.</p>
</td></tr>
<tr><td><code id="MFx_+3A_ode">ode</code></td>
<td>
<p>IF <code>ode</code> is <code>TRUE</code>, algo use predict_ode rather than predict. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="MFx_+3A_interpolate_length">interpolate_length</code></td>
<td>
<p>Length of the time sequence for which output is wanted.</p>
</td></tr>
<tr><td><code id="MFx_+3A_interpolate_method">interpolate_method</code></td>
<td>
<p>The interpolation method for concentration. See package <code>deSolve</code> for details.
Default is <code>linear</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When class of <code>object</code> is <code>survFit</code>, see <a href="#topic+MFx.survFit">MFx.survFit</a>.
</p>


<h3>Value</h3>

<p>returns an object of class <code>MFx</code>
</p>
<p>The function returns an object of class <code>MFx</code>, which is a list
with the following information:
</p>
<table role = "presentation">
<tr><td><code>X_prop</code></td>
<td>
<p>Survival probability for <code>X</code> percent of reduction of the initial median 
survival probability at time <code>time_MFx</code>.</p>
</td></tr>
<tr><td><code>X_prop_provided</code></td>
<td>
<p>A number giving the proportion of reduction in survival.</p>
</td></tr>
<tr><td><code>time_MFx</code></td>
<td>
<p>A number giving the time at which  <code class="reqn">MF(x,t)</code> has to be
estimated as provided in arguments or if NULL, the latest time point of the
profile is used.</p>
</td></tr>
<tr><td><code>df_MFx</code></td>
<td>
<p>A <code>data.frame</code> with quantiles (median, 2.5% and 97.5%)
of <code class="reqn">MF(x,t)</code> at time <code class="reqn">t</code>, <code>time_MFx</code>, for <code class="reqn">x</code>% of survival reduction.</p>
</td></tr>
<tr><td><code>df_dose</code></td>
<td>
<p>A <code>data.frame</code> with quantiles (median, 2.5% and 97.5%)
of survival probability along the computed multiplication factor and at time <code>time_MFx</code>.</p>
</td></tr>
<tr><td><code>MFx_tested</code></td>
<td>
<p>A vector of all multiplication factors computed.</p>
</td></tr> 
<tr><td><code>ls_predict</code></td>
<td>
<p>A list of all object of class <code>survFitPredict</code> obtained
from computing survival probability for every profiles build from the vector of
multiplication factors <code>MFx_tested</code>.</p>
</td></tr>
</table>
<p>The function returns an object of class <code>MFx</code>, which is a list
with the following information:
</p>
<table role = "presentation">
<tr><td><code>X_prop</code></td>
<td>
<p>Survival probability for <code>X</code> percent of reduction of the initial median 
survival probability at time <code>time_MFx</code>.</p>
</td></tr>
<tr><td><code>X_prop_provided</code></td>
<td>
<p>A number giving the proportion of reduction in survival.</p>
</td></tr>
<tr><td><code>time_MFx</code></td>
<td>
<p>A number giving the time at which  <code class="reqn">MF(x,t)</code> has to be
estimated as provided in arguments or if NULL, the latest time point of the
profile is used.</p>
</td></tr>
<tr><td><code>df_MFx</code></td>
<td>
<p>A <code>data.frame</code> with quantiles (median, 2.5% and 97.5%)
of <code class="reqn">MF(x,t)</code> at time <code class="reqn">t</code>, <code>time_MFx</code>, for <code class="reqn">x</code>% of survival reduction.</p>
</td></tr>
<tr><td><code>df_dose</code></td>
<td>
<p>A <code>data.frame</code> with quantiles (median, 2.5% and 97.5%)
of survival probability along the computed multiplication factor and at time <code>time_MFx</code>.</p>
</td></tr>
<tr><td><code>MFx_tested</code></td>
<td>
<p>A vector of all multiplication factors computed.</p>
</td></tr> 
<tr><td><code>ls_predict</code></td>
<td>
<p>A list of all object of class <code>survFitPredict</code> obtained
from computing survival probability for every profiles build from the vector of
multiplication factors <code>MFx_tested</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='modelData'>Create a list giving data to use in Bayesian inference.</h2><span id='topic+modelData'></span><span id='topic+modelData.survDataCstExp'></span><span id='topic+modelData.survDataVarExp'></span>

<h3>Description</h3>

<p>Create a data set to analyse a <code>survDataCstExp</code> object.
</p>
<p>Create a data set to analyse a <code>survDataVarExp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelData(x, ...)

## S3 method for class 'survDataCstExp'
modelData(x, model_type = NULL, ...)

## S3 method for class 'survDataVarExp'
modelData(x, model_type = NULL, extend_time = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelData_+3A_x">x</code></td>
<td>
<p>An object of class <code>survData</code></p>
</td></tr>
<tr><td><code id="modelData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="modelData_+3A_model_type">model_type</code></td>
<td>
<p>TKTD GUTS model type ('SD' or 'IT')</p>
</td></tr>
<tr><td><code id="modelData_+3A_extend_time">extend_time</code></td>
<td>
<p>Number of for each replicate used for linear 
interpolation (comprise between time to compute and fitting accuracy)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list for parameterization of priors for Bayesian inference.
</p>
<p>A list for parameterization of priors for Bayesian inference.
</p>
<p>A list for parameterization of priors for Bayesian inference.
</p>

<hr>
<h2 id='plot_prior_post'>Generic method to plot priors and posteriors.</h2><span id='topic+plot_prior_post'></span>

<h3>Description</h3>

<p>Plot priors and posteriors of a <code>survFit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_prior_post(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_prior_post_+3A_x">x</code></td>
<td>
<p>an object used to select a method <code>plot_prior_post</code></p>
</td></tr>
<tr><td><code id="plot_prior_post_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>plot_prior_post</code>
</p>

<hr>
<h2 id='plot_prior_post.survFit'>Plot posteriors vs priors</h2><span id='topic+plot_prior_post.survFit'></span>

<h3>Description</h3>

<p>Plot posteriors vs priors of a <code>survFit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFit'
plot_prior_post(x, size_sample = 1000, EFSA_name = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_prior_post.survFit_+3A_x">x</code></td>
<td>
<p>an object of class <code>survFit</code> used to select a method <code>plot_prior_post</code></p>
</td></tr>
<tr><td><code id="plot_prior_post.survFit_+3A_size_sample">size_sample</code></td>
<td>
<p>Size of the random generation of the distribution.
Default is <code>1e3</code>.</p>
</td></tr>
<tr><td><code id="plot_prior_post.survFit_+3A_efsa_name">EFSA_name</code></td>
<td>
<p>If <code>TRUE</code>, replace the current terminology by
the one used in the recent EFSA PPR Scientific Opinion (2018).</p>
</td></tr>
<tr><td><code id="plot_prior_post.survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>References</h3>

<p>EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>
</p>

<hr>
<h2 id='plot.LCx'>Plotting method for <code>LCx</code> objects</h2><span id='topic+plot.LCx'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the LCx class. 
It plots the survival probability as a function of concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'LCx'
plot(
  x,
  xlab = "Concentration",
  ylab = "Survival probability \n median and 95 CI",
  main = NULL,
  subtitle = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.LCx_+3A_x">x</code></td>
<td>
<p>An object of class <code>LCx</code>.</p>
</td></tr>
<tr><td><code id="plot.LCx_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Concentration</code>.</p>
</td></tr>
<tr><td><code id="plot.LCx_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability median and 95 CI</code>.</p>
</td></tr>
<tr><td><code id="plot.LCx_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.LCx_+3A_subtitle">subtitle</code></td>
<td>
<p>A subtitle for the plot</p>
</td></tr>
<tr><td><code id="plot.LCx_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.MFx'>Plotting method for <code>MFx</code> objects</h2><span id='topic+plot.MFx'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>MFx</code> class. It plots the survival probability as a function of
the multiplication factor applied or as a function of time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MFx'
plot(
  x,
  x_variable = "MFx",
  xlab = NULL,
  ylab = "Survival probability \n median and 95 CI",
  main = NULL,
  log_scale = FALSE,
  ncol = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.MFx_+3A_x">x</code></td>
<td>
<p>An object of class <code>MFx</code>.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_x_variable">x_variable</code></td>
<td>
<p>A character to define the variable for the <code class="reqn">X</code>-axis,
either <code>"MFx"</code> or <code>"Time"</code>. The default is <code>"MFx"</code>.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>NULL</code> and depend on the
argument <code>x_variable</code>.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability median and 95 CI</code>.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_log_scale">log_scale</code></td>
<td>
<p>If <code>TRUE</code>, the x-axis is log-scaled. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_ncol">ncol</code></td>
<td>
<p>An interger for the number of columns when several panels are plotted.</p>
</td></tr>
<tr><td><code id="plot.MFx_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.reproData'>Plotting method for <code>reproData</code> objects</h2><span id='topic+plot.reproData'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>reproData</code> class.
It plots the cumulated number of offspring as a function of time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproData'
plot(
  x,
  xlab,
  ylab = "Cumulated Number of offspring",
  main = NULL,
  concentration = NULL,
  style = "ggplot",
  pool.replicate = FALSE,
  addlegend = FALSE,
  remove.someLabels = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.reproData_+3A_x">x</code></td>
<td>
<p>an object of class <code>reproData</code></p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_xlab">xlab</code></td>
<td>
<p>label of the <code class="reqn">X</code>-axis</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_ylab">ylab</code></td>
<td>
<p>label of the <code class="reqn">Y</code>-axis, by default <code>Cumulated Number of offspring</code></p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_concentration">concentration</code></td>
<td>
<p>a numeric value corresponding to some concentration in
<code>data</code>. If <code>concentration = NULL</code>, draws a plot for each concentration</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'ggplot'</code> or <code>'generic'</code></p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_pool.replicate">pool.replicate</code></td>
<td>
<p>if <code>TRUE</code>, the datapoints of each replicate are
summed for a same concentration</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_remove.somelabels">remove.someLabels</code></td>
<td>
<p>if <code>TRUE</code>, removes 3/4 of X-axis labels in
<code>'ggplot'</code> style to avoid the label overlap</p>
</td></tr>
<tr><td><code id="plot.reproData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "generic"</code>, the function calls the generic function
<code><a href="graphics.html#topic+plot">plot</a></code>
</p>
<p>When <code>style = "ggplot"</code>, the function return an object of class
<code>gg</code> and <code>ggplot</code>, see function <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>

<hr>
<h2 id='plot.reproFitTT'>Plotting method for <code>reproFitTT</code> objects</h2><span id='topic+plot.reproFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>reproFitTT</code> class.
It plots the concentration-effect fit under target time reproduction
analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproFitTT'
plot(
  x,
  xlab = "Concentration",
  ylab = "Nb of offspring per ind/day",
  main = NULL,
  fitcol = "orange",
  fitlty = 1,
  fitlwd = 1,
  spaghetti = FALSE,
  cicol = "orange",
  cilty = 2,
  cilwd = 1,
  ribcol = "grey70",
  addlegend = FALSE,
  log.scale = FALSE,
  style = "ggplot",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.reproFitTT_+3A_x">x</code></td>
<td>
<p>an object of class <code>reproFitTT</code></p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, by default <code>Concentration</code></p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, by default <code>Nb of offspring per ind/day</code></p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_fitcol">fitcol</code></td>
<td>
<p>color of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_fitlty">fitlty</code></td>
<td>
<p>line type of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_fitlwd">fitlwd</code></td>
<td>
<p>width of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_spaghetti">spaghetti</code></td>
<td>
<p>if <code>TRUE</code>, the credible interval is represented by 
multiple curves</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_cicol">cicol</code></td>
<td>
<p>color of the 95 % credible limits</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_cilty">cilty</code></td>
<td>
<p>line type of the 95 % credible limits</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_cilwd">cilwd</code></td>
<td>
<p>width of the 95 % credible limits</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_ribcol">ribcol</code></td>
<td>
<p>color of the ribbon between lower and upper credible limits.
Transparent if <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_log.scale">log.scale</code></td>
<td>
<p>if <code>TRUE</code>, displays <code class="reqn">X</code>-axis in log-scale</p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'ggplot'</code> or <code>'generic'</code></p>
</td></tr>
<tr><td><code id="plot.reproFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curve represents the <strong>estimated reproduction rate</strong> at the target time
as a function of the chemical compound concentration.
The function plots 95% credible intervals for the estimated reproduction
rate (by default the grey area around the fitted curve). Typically
a good fit is expected to display a large overlap between the two types of intervals.
If spaghetti = TRUE, the credible intervals are represented by two dotted
lines limiting the credible band, and a spaghetti plot is added to this band.
It consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (10% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "generic"</code>, the function calls the generic function
<code><a href="graphics.html#topic+plot">plot</a></code>
</p>
<p>When <code>style = "ggplot"</code>, the function return an object of class
<code>ggplot</code>, see function <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>

<hr>
<h2 id='plot.survDataCstExp'>Plotting method for <code>survData</code> objects</h2><span id='topic+plot.survDataCstExp'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>survData</code> class.
It plots the number of survivors as a function of time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataCstExp'
plot(
  x,
  xlab = "Time",
  ylab = "Number of survivors",
  main = NULL,
  concentration = NULL,
  style = "ggplot",
  pool.replicate = FALSE,
  addlegend = FALSE,
  remove.someLabels = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survDataCstExp_+3A_x">x</code></td>
<td>
<p>an object of class <code>survData</code></p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, by default <code>Time</code></p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, by default <code>Number of survivors</code></p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_concentration">concentration</code></td>
<td>
<p>a numeric value corresponding to some concentration(s) in
<code>data</code>. If <code>concentration = NULL</code>, draws a plot for each concentration</p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'generic'</code> or <code>'ggplot'</code></p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_pool.replicate">pool.replicate</code></td>
<td>
<p>if <code>TRUE</code>, the datapoints of each replicate are
summed for a same concentration</p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_remove.somelabels">remove.someLabels</code></td>
<td>
<p>if <code>TRUE</code>, removes 3/4 of <code class="reqn">X</code>-axis labels in
<code>'ggplot'</code> style to avoid label overlap</p>
</td></tr>
<tr><td><code id="plot.survDataCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "ggplot"</code> (default), the function calls function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> and returns an object of class <code>ggplot</code>.
</p>

<hr>
<h2 id='plot.survDataVarExp'>Plotting method for <code>survDataVarExp</code> objects</h2><span id='topic+plot.survDataVarExp'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>survDataVarC</code> class.
It plots the number of survivors as a function of time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataVarExp'
plot(
  x,
  xlab = "Time",
  ylab = "Number of survivors",
  main = NULL,
  one.plot = FALSE,
  facetting_level = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survDataVarExp_+3A_x">x</code></td>
<td>
<p>an object of class <code>survDataVarExp</code></p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, by default <code>Time</code></p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, by default <code>Number of survivors</code></p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the points in one plot instead of one per <code>replicate</code></p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_facetting_level">facetting_level</code></td>
<td>
<p>a vector of <code>characters</code> to rank <code>replicates</code> in the multi plot (i.e. <code>one.plot == FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.survDataVarExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>ggplot</code>, see function <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>

<hr>
<h2 id='plot.survFitCstExp'>Plotting method for <code>survFit</code> objects</h2><span id='topic+plot.survFitCstExp'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>survFit</code>.  It plots the fit obtained for each
concentration of chemical compound in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitCstExp'
plot(
  x,
  xlab = "Time",
  ylab = "Survival probability",
  main = NULL,
  concentration = NULL,
  spaghetti = FALSE,
  one.plot = FALSE,
  adddata = TRUE,
  addlegend = FALSE,
  style = "ggplot",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitCstExp_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Time</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_concentration">concentration</code></td>
<td>
<p>A numeric value corresponding to some specific concentrations in
<code>data</code>. If <code>concentration = NULL</code>, draws a plot for each concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_spaghetti">spaghetti</code></td>
<td>
<p>if <code>TRUE</code>, draws a set of survival curves using
parameters drawn from the posterior distribution</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the estimated curves in
one plot instead of one plot per concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_adddata">adddata</code></td>
<td>
<p>if <code>TRUE</code>, adds the observed data to the plot
with (frequentist binomial) confidence intervals</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'generic'</code> or <code>'ggplot'</code></p>
</td></tr>
<tr><td><code id="plot.survFitCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curves represent the <strong>estimated survival probability</strong> as a function
of time for each concentration.
The black dots depict the <strong>observed survival
probability</strong> at each time point. Note that since our model does not take
inter-replicate variability into consideration, replicates are systematically
pooled in this plot.
The function plots both 95% credible intervals for the estimated survival
probability (by default the grey area around the fitted curve) and 95%  binomial confidence
intervals for the observed survival probability (as black error bars if
<code>adddata = TRUE</code>).
Both types of intervals are taken at the same level. Typically
a good fit is expected to display a large overlap between the two types of intervals.
If <code>spaghetti = TRUE</code>, the credible intervals are represented by two
dotted lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (2% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.survFitPredict'>Plotting method for <code>survFitPredict</code> objects</h2><span id='topic+plot.survFitPredict'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>survFitPredict</code>.  It plots the predicted survival probability for each
concentration of the chemical compound in the provided dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitPredict'
plot(
  x,
  xlab = "Time",
  ylab = "Survival probability",
  main = NULL,
  spaghetti = FALSE,
  one.plot = FALSE,
  mcmc_size = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitPredict_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitPredict</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Time</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, draws a set of survival curves using
parameters drawn from the posterior distribution</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the estimated curves in
one plot instead of one plot per concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>A numerical value refering by default to the size of the mcmc in object <code>survFitPredict</code>.
This option is specific to <code>survFitPredict</code> objects for which computing time may be long.
<code>mcmc_size</code> can be used to reduce the number of mcmc samples in order to speed up
the computation.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curves represent the <strong>predicted survival probability</strong> as a function
of time for each concentration.
The function plots both the 95% credible band and the predicted survival
probability over time.
If <code>spaghetti = TRUE</code>, the credible intervals are represented by two
dotted lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (10% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.survFitPredict_Nsurv'>Plotting method for <code>survFitPredict_Nsurv</code> objects.</h2><span id='topic+plot.survFitPredict_Nsurv'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>survFitPredict_Nsurv</code>.  It plots the predicted survival probability for each
concentration of the chemical compound in the provided dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitPredict_Nsurv'
plot(
  x,
  xlab = "Time",
  ylab = "Number of survivors",
  main = NULL,
  spaghetti = FALSE,
  one.plot = FALSE,
  mcmc_size = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitPredict_Nsurv</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Time</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, draws a set of survival curves using
parameters drawn from the posterior distribution</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the estimated curves in
one plot instead of one plot per concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>A numerical value refering by default to the size of the mcmc in object <code>survFitPredict</code>.
This option is specific to <code>survFitPredict</code> objects for which computing time may be long.
<code>mcmc_size</code> can be used to reduce the number of mcmc samples in order to speed up
the computation.</p>
</td></tr>
<tr><td><code id="plot.survFitPredict_Nsurv_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curves represent the <strong>predicted survival probability</strong> as a function
of time for each concentration.
The function plots both the 95% credible band and the predicted survival
probability over time.
If <code>spaghetti = TRUE</code>, the credible intervals are represented by two
dotted lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (10% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.survFitTKTD'>Plotting method for <code>survFitTKTD</code> objects</h2><span id='topic+plot.survFitTKTD'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>survFitTKTD</code>.  It plots the fit obtained for each
concentration of chemical compound in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTKTD'
plot(
  x,
  xlab = "Time",
  ylab = "Survival probablity",
  main = NULL,
  concentration = NULL,
  spaghetti = FALSE,
  one.plot = FALSE,
  adddata = FALSE,
  addlegend = FALSE,
  style = "ggplot",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitTKTD_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitTKTD</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Time</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probablity</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_concentration">concentration</code></td>
<td>
<p>A numeric value corresponding to some specific concentration in
<code>data</code>. If <code>concentration = NULL</code>, draws a plot for each concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_spaghetti">spaghetti</code></td>
<td>
<p>if <code>TRUE</code>, draws a set of survival curves using
parameters drawn from the posterior distribution</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the estimated curves in
one plot instead of one plot per concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_adddata">adddata</code></td>
<td>
<p>if <code>TRUE</code>, adds the observed data to the plot
with (frequentist binomial) confidence intervals</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'generic'</code> or <code>'ggplot'</code></p>
</td></tr>
<tr><td><code id="plot.survFitTKTD_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curves represent the <strong>estimated survival probablity</strong> as a function
of time for each concentration
When <code>adddata = TRUE</code> the black dots depict the <strong>observed survival
probablity</strong> at each time point. Note that since our model does not take
inter-replicate variability into consideration, replicates are systematically
pooled in this plot.
The function plots both 95% credible intervals for the estimated survival
probablity (by default the grey area around the fitted curve) and 95% binomial confidence
intervals for the observed survival probablity (as black error bars if
<code>adddata = TRUE</code>).
Both types of intervals are taken at the same level. Typically
a good fit is expected to display a large overlap between the two types of intervals.
If <code>spaghetti = TRUE</code>, the credible intervals are represented by two
dotted lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (2% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plot.survFitTT'>Plotting method for <code>survFitTT</code> objects</h2><span id='topic+plot.survFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the <code>survFitTT</code> class. It
plots concentration-response fit under target time survival analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTT'
plot(
  x,
  xlab = "Concentration",
  ylab = "Survival probability",
  main = NULL,
  fitcol = "orange",
  fitlty = 1,
  fitlwd = 1,
  spaghetti = FALSE,
  cicol = "orange",
  cilty = 2,
  cilwd = 1,
  ribcol = "grey70",
  adddata = FALSE,
  addlegend = FALSE,
  log.scale = FALSE,
  style = "ggplot",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitTT_+3A_x">x</code></td>
<td>
<p>an object of class <code>survFitTT</code></p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, default is <code>Concentration</code></p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, default is <code>Survival probability</code></p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_fitcol">fitcol</code></td>
<td>
<p>color of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_fitlty">fitlty</code></td>
<td>
<p>line type of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_fitlwd">fitlwd</code></td>
<td>
<p>width of the fitted curve</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_spaghetti">spaghetti</code></td>
<td>
<p>if <code>TRUE</code>, the credible interval is represented by 
multiple curves</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_cicol">cicol</code></td>
<td>
<p>color of the 95 % credible interval limits</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_cilty">cilty</code></td>
<td>
<p>line type for the 95 % credible interval limits</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_cilwd">cilwd</code></td>
<td>
<p>width of the 95 % credible interval limits</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_ribcol">ribcol</code></td>
<td>
<p>color of the ribbon between lower and upper credible limits.
Transparent if <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_adddata">adddata</code></td>
<td>
<p>if <code>TRUE</code>, adds the observed data with confidence intervals
to the plot</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_log.scale">log.scale</code></td>
<td>
<p>if <code>TRUE</code>, displays <code class="reqn">X</code>-axis in log-scale</p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'generic'</code> or <code>'ggplot'</code></p>
</td></tr>
<tr><td><code id="plot.survFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curve represents the <strong>estimated survival probability</strong> at
the target time as a function of the concentration of chemical compound;
When <code>adddata = TRUE</code> the black dots depict the <strong>observed survival
probability</strong> at each tested concentration. Note that since our model does not take
inter-replicate variability into consideration, replicates are systematically
pooled in this plot.
The function plots both 95% credible intervals for the estimated survival
probability (by default the grey area around the fitted curve) and 95% binomial confidence
intervals for the observed survival probability (as black segments if
<code>adddata = TRUE</code>).
Both types of intervals are taken at the same level. Typically
a good fit is expected to display a large overlap between the two intervals.
If spaghetti = TRUE, the credible intervals are represented by two dotted
lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (10% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "ggplot"</code>, the function calls function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> and returns an object of class <code>ggplot</code>.
</p>

<hr>
<h2 id='plot.survFitVarExp'>Plotting method for <code>survFit</code> objects</h2><span id='topic+plot.survFitVarExp'></span>

<h3>Description</h3>

<p>This is the generic <code>plot</code> S3 method for the
<code>survFit</code>.  It plots the fit obtained for each
concentration profile in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitVarExp'
plot(
  x,
  xlab = "Time",
  ylab = "Survival probability",
  main = NULL,
  spaghetti = FALSE,
  one.plot = FALSE,
  adddata = TRUE,
  mcmc_size = NULL,
  scales = "fixed",
  addConfInt = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.survFitVarExp_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Time</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability</code>.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_spaghetti">spaghetti</code></td>
<td>
<p>if <code>TRUE</code>, draws a set of survival curves using
parameters drawn from the posterior distribution</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_one.plot">one.plot</code></td>
<td>
<p>if <code>TRUE</code>, draws all the estimated curves in
one plot instead of one plot per concentration.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_adddata">adddata</code></td>
<td>
<p>if <code>TRUE</code>, adds the observed data to the plot.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>A numerical value refering by default to the size of the mcmc in object <code>survFit</code>.
This option is specific to <code>survFitVarExp</code> objects for which computing time may be long.
<code>mcmc_size</code> can be used to reduce the number of mcmc samples in order to speed up
the computation.</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_scales">scales</code></td>
<td>
<p>Shape the scale of axis. Default is <code>"fixed"</code>, but can be <code>"free"</code>, or free
in only one dimension <code>"free_x"</code>, <code>"free_y"</code>. (See <code>ggplot2</code> documentation
for more details.)</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_addconfint">addConfInt</code></td>
<td>
<p>If <code>TRUE</code>, add a <code class="reqn">95\%</code> confidence interval on observed data from a binomial test</p>
</td></tr>
<tr><td><code id="plot.survFitVarExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fitted curves represent the <strong>estimated survival probability</strong> as a function
of time for each concentration profile.
The black dots depict the <strong>observed survival
probability</strong> at each time point. Note that since our model does not take
inter-replicate variability into consideration, replicates are systematically
pooled in this plot.
The function plots both 95% binomial credible intervals for the estimated survival
probability (by default the grey area around the fitted curve) and 95% binomial confidence
intervals for the observed survival probability (as black segments if
<code>adddata = TRUE</code>).
Both types of intervals are taken at the same level. Typically
a good fit is expected to display a large overlap between the two types of  intervals.
If <code>spaghetti = TRUE</code>, the credible intervals are represented by two
dotted lines limiting the credible band, and a spaghetti plot is added to this band.
This spaghetti plot consists of the representation of simulated curves using parameter values
sampled in the posterior distribution (10% of the MCMC chains are randomly
taken for this sample).
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plotDoseResponse'>Plot dose-response from raw data</h2><span id='topic+plotDoseResponse'></span>

<h3>Description</h3>

<p>Plots the response of the effect as a function of the concentration at a given
target time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDoseResponse(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDoseResponse_+3A_x">x</code></td>
<td>
<p>an object used to select a method <code>plotDoseRespons</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='plotDoseResponse.reproData'>Plot dose-response from <code>reproData</code> objects</h2><span id='topic+plotDoseResponse.reproData'></span>

<h3>Description</h3>

<p>This is the generic <code>plotDoseResponse</code> S3 method for the <code>reproData</code>
class. It plots the number of offspring per individual-days as a function of
concentration at a given target time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproData'
plotDoseResponse(
  x,
  xlab = "Concentration",
  ylab = "Nb of offspring per ind.day",
  main = NULL,
  ylim = NULL,
  target.time = NULL,
  style = "ggplot",
  log.scale = FALSE,
  remove.someLabels = FALSE,
  axis = TRUE,
  addlegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDoseResponse.reproData_+3A_x">x</code></td>
<td>
<p>an object of class <code>reproData</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, by default <code>Concentration</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, by default <code>Nb of offspring per ind.day</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_ylim">ylim</code></td>
<td>
<p><code class="reqn">Y</code>-axis limits</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_target.time">target.time</code></td>
<td>
<p>a numeric value corresponding to some observed time points in <code>data</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'ggplot'</code> or <code>'generic'</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_log.scale">log.scale</code></td>
<td>
<p>if <code>TRUE</code>, displays <code class="reqn">X</code>-axis in log-scale</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_remove.somelabels">remove.someLabels</code></td>
<td>
<p>if <code>TRUE</code>, removes 75% of <code class="reqn">X</code>-axis labels in
<code>'ggplot'</code> style to avoid the label overlap</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_axis">axis</code></td>
<td>
<p>if <code>TRUE</code> displays ticks and label axis</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plotDoseResponse.reproData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the observed values of the reproduction rate (number of
reproduction outputs per individual-day) at a given time point as a function of
concentration. The 95 % Poisson confidence interval is added to each reproduction
rate. It is calculated using function <code><a href="epitools.html#topic+pois.exact">pois.exact</a></code>
from package <code>epitools</code>.
As replicates are not pooled in this plot, overlapped points are shifted on
the x-axis to help the visualization of replicates.
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "generic"</code>, the function calls the generic function
<code><a href="graphics.html#topic+plot">plot</a></code>
</p>
<p>When <code>style = "ggplot"</code>, the function return an object of class
<code>ggplot</code>, see function <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="epitools.html#topic+pois.exact">pois.exact</a></code>
</p>

<hr>
<h2 id='plotDoseResponse.survDataCstExp'>Plot dose-response from <code>survData</code> objects</h2><span id='topic+plotDoseResponse.survDataCstExp'></span>

<h3>Description</h3>

<p>This is the generic <code>plotDoseResponse</code> S3 method for the <code>survData</code>
class. It plots the survival probability as a function of concentration at a given
target time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataCstExp'
plotDoseResponse(
  x,
  xlab = "Concentration",
  ylab = "Survival probability",
  main = NULL,
  target.time = NULL,
  style = "ggplot",
  log.scale = FALSE,
  remove.someLabels = FALSE,
  addlegend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_x">x</code></td>
<td>
<p>an object of class <code>survData</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code class="reqn">X</code>-axis, by default <code>Concentration</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_ylab">ylab</code></td>
<td>
<p>a label for the <code class="reqn">Y</code>-axis, by default <code>Survival probability</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_main">main</code></td>
<td>
<p>main title for the plot</p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_target.time">target.time</code></td>
<td>
<p>a numeric value corresponding to some observed time in <code>data</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'ggplot'</code> or <code>'generic'</code></p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_log.scale">log.scale</code></td>
<td>
<p>if <code>TRUE</code>, displays <code class="reqn">X</code>-axis in log-scale</p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_remove.somelabels">remove.someLabels</code></td>
<td>
<p>if <code>TRUE</code>, removes 75% of X-axis labels in
<code>'ggplot'</code> style to avoid the label overlap</p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_addlegend">addlegend</code></td>
<td>
<p>if <code>TRUE</code>, adds a default legend to the plot</p>
</td></tr>
<tr><td><code id="plotDoseResponse.survDataCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the observed values of the survival probability at a given time point
as a function of concentration. The 95 % binomial confidence interval is added
to each survival probability. It is calculated using function
<code><a href="stats.html#topic+binom.test">binom.test</a></code> from package <code>stats</code>.
Replicates are systematically pooled in this plot.
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>


<h3>Note</h3>

<p>When <code>style = "generic"</code>, the function calls the generic function
<code><a href="graphics.html#topic+plot">plot</a></code>
</p>
<p>When <code>style = "ggplot"</code>, the function return an object of class
<code>ggplot</code>, see function <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+binom.test">binom.test</a></code>
</p>

<hr>
<h2 id='ppc'>Posterior predictive check plot</h2><span id='topic+ppc'></span><span id='topic+ppc.reproFitTT'></span><span id='topic+ppc.survFitCstExp'></span><span id='topic+ppc.survFitPredict_Nsurv'></span><span id='topic+ppc.survFitTKTD'></span><span id='topic+ppc.survFitTT'></span><span id='topic+ppc.survFitVarExp'></span>

<h3>Description</h3>

<p>Plots posterior predictive check for <code>reproFitTT</code>, <code>survFitTT</code>,
<code>survFitTKTD</code>, <code>survFitCstExp</code> and <code>survFitVarExp</code> objects.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>reproFitTT</code> class.
It plots the predicted values with 95% credible intervals versus the observed
values.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>survFitCstExp</code> class. It
plots the predicted values along with 95% credible intervals
versus the observed values for <code>survFit</code> objects.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>survFitPredict_Nsurv</code> class. It
plots the predicted values along with 95% credible intervals
versus the observed values for <code>survFitPredict_Nsurv</code> objects.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>survFitTKTD</code> class. It
plots the predicted values along with 95% credible intervals
versus the observed values for <code>survFitTKTD</code> objects.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>survFitTT</code> class. It
plots the predicted values with 95 % credible intervals versus the observed
values for <code>survFitTT</code> objects.
</p>
<p>This is the generic <code>ppc</code> S3 method for the <code>survFitVarExp</code> class. It
plots the predicted values along with 95% credible intervals
versus the observed values for <code>survFit</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc(x, ...)

## S3 method for class 'reproFitTT'
ppc(
  x,
  style = "ggplot",
  xlab = "Observed Cumul. Nbr. of offspring",
  ylab = "Predicted Cumul. Nbr. of offspring",
  main = NULL,
  ...
)

## S3 method for class 'survFitCstExp'
ppc(x, style = "ggplot", main = NULL, ...)

## S3 method for class 'survFitPredict_Nsurv'
ppc(
  x,
  xlab = "Observed nb of survivors",
  ylab = "Predicted nb of survivors",
  main = NULL,
  ...
)

## S3 method for class 'survFitTKTD'
ppc(x, style = "ggplot", main = NULL, ...)

## S3 method for class 'survFitTT'
ppc(x, style = "ggplot", main = NULL, ...)

## S3 method for class 'survFitVarExp'
ppc(
  x,
  xlab = "Observed nb of survivors",
  ylab = "Predicted nb of survivors",
  main = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppc_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitVarExp</code></p>
</td></tr>
<tr><td><code id="ppc_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="ppc_+3A_style">style</code></td>
<td>
<p>graphical backend, can be <code>'generic'</code> or <code>'ggplot'</code></p>
</td></tr>
<tr><td><code id="ppc_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code class="reqn">X</code>-axis, by default <code>Observed nb of survivors</code>.</p>
</td></tr>
<tr><td><code id="ppc_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code class="reqn">Y</code>-axis, by default <code>Predicted nb of survivors</code>.</p>
</td></tr>
<tr><td><code id="ppc_+3A_main">main</code></td>
<td>
<p>A main title for the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the class of the object <code>x</code> see their links. 
for class <code>reproFitTT</code>: <a href="#topic+ppc.reproFitTT">ppc.reproFitTT</a> ;  
for class <code>survFitTT</code>: <a href="#topic+ppc.survFitTT">ppc.survFitTT</a> ; 
for class <code>survFitTKTD</code>: <a href="#topic+ppc.survFitTKTD">ppc.survFitTKTD</a> ;
for class <code>survFitCstExp</code>: <a href="#topic+ppc.survFitCstExp">ppc.survFitCstExp</a> and
for class <code>survFitVarExp</code>: <a href="#topic+ppc.survFitVarExp">ppc.survFitVarExp</a>.
</p>
<p>The coordinates of black points are the observed values of the cumulated number
of reproduction outputs for a given concentration (<code class="reqn">X</code>-scale) and the corresponding 
predicted values (<code class="reqn">Y</code>-scale). 95% prediction intervals are added to each predicted
value, colored in green if this interval contains the observed value and in red
in the other case. As replicates are not pooled in this plot, overlapped points
are shifted on the <code class="reqn">X-</code>axis to help the visualization of replicates. The bisecting
line (y = x) is added to the plot in order to see if each prediction interval
contains each observed value. As replicates are shifted on the <code class="reqn">X</code>-axis, this
line may be represented by steps.
</p>
<p>The black points show the observed number of survivors (pooled
replicates, on <code class="reqn">X</code>-axis) against the corresponding predicted
number (<code class="reqn">Y</code>-axis). Predictions come along with 95% prediction
intervals, which are depicted in green when they contain the
observed value and in red otherwise. Samples with equal observed
value are shifted on the <code class="reqn">X</code>-axis. For that reason, the
bisecting line (y = x), is represented by steps when observed
values are low. That way we ensure green intervals do intersect the
bisecting line.
</p>
<p>For <code>survFitPredict_Nsurv</code> object, PPC is based on times series simulated
for each replicate. In addition, the black points show the observed
number of survivors (on <code class="reqn">X</code>-axis)
against the corresponding predicted
number (<code class="reqn">Y</code>-axis). Predictions come along with 95% prediction
intervals, which are depicted in green when they contain the
observed value and in red otherwise.
</p>
<p>The black points show the observed number of survivors (pooled
replicates, on <code class="reqn">X</code>-axis) against the corresponding predicted
number (<code class="reqn">Y</code>-axis). Predictions come along with 95% prediction
intervals, which are depicted in green when they contain the
observed value and in red otherwise. Samples with equal observed
value are shifted on the <code class="reqn">X</code>-axis. For that reason, the
bisecting line (y = x), is represented by steps when observed
values are low. That way we ensure green intervals do intersect the
bisecting line.
</p>
<p>The coordinates of black points are the observed values of the number of survivors
(pooled replicates) for a given concentration (<code class="reqn">X</code>-axis) and the corresponding 
predicted values (<code class="reqn">Y</code>-axis). 95% prediction intervals are added to each predicted
value, colored in green if this interval contains the observed value and in red
otherwise.
The bisecting line (y = x) is added to the plot in order to see if each
prediction interval contains each observed value. As replicates are shifted
on the x-axis, this line is represented by steps.
</p>
<p>The black points show the observed number of survivors (on <code class="reqn">X</code>-axis)
against the corresponding predicted
number (<code class="reqn">Y</code>-axis). Predictions come along with 95% prediction
intervals, which are depicted in green when they contain the
observed value and in red otherwise.
</p>


<h3>Value</h3>

<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>
<p>a plot of class <code>ggplot</code>
</p>

<hr>
<h2 id='predict_Nsurv_check'>Checking goodness-of-fit method for <code>survFitPredict</code> and
<code>survFitPredict_Nsurv</code> objects</h2><span id='topic+predict_Nsurv_check'></span><span id='topic+predict_Nsurv_check.survFitPredict_Nsurv'></span>

<h3>Description</h3>

<p>It returns measures of goodness-of-fit for predictions.
</p>
<p>Provide various criteria for assessment of the model performance:
(i) percentage of observation within the 95% credible
interval of the Posterior Prediction Check (PPC), the Normalised Root Mean
Square Error (NRMSE) and the Survival Probability Prediction Error (SPPE) as
reccommended by the recent Scientific Opinion from EFSA (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_Nsurv_check(object, ...)

## S3 method for class 'survFitPredict_Nsurv'
predict_Nsurv_check(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_Nsurv_check_+3A_object">object</code></td>
<td>
<p>an object of class <code>survFitPredict_Nsurv</code></p>
</td></tr>
<tr><td><code id="predict_Nsurv_check_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a list of data.frame.
</p>
<p>The function return a list with three items:
</p>
<table role = "presentation">
<tr><td><code>PPC</code></td>
<td>
<p>The criterion, in percent, compares the predicted median numbers 
of survivors associated to their uncertainty limits with the observed numbers
of survivors. Based on experience, PPC resulting in less than <code class="reqn">50\%</code> of the
observations within the uncertainty limits indicate poor model performance. A fit of
<code class="reqn">100\%</code> may hide too large uncertainties of prediction (so covering all data).</p>
</td></tr>
<tr><td><code>PPC_global</code></td>
<td>
<p>percentage of PPC for the whole data set by gathering replicates.</p>
</td></tr>
<tr><td><code>NRMSE</code></td>
<td>
<p>The criterion, in percent, is based on the classical root-mean-square error (RMSE),
used to aggregate the magnitudes of the errors in predictions for various time-points
into a single measure of predictive power. In order to provide a criterion expressed
as a percentage, NRMSE is the normalised RMSE by the mean of the observations.</p>
</td></tr>
<tr><td><code>NRMSE_global</code></td>
<td>
<p>NRMSE for the whole data set by gathering replicates.</p>
</td></tr>
<tr><td><code>SPPE</code></td>
<td>
<p>The SPPE indicator, in percent, is negative (between <code class="reqn">0</code> and <code class="reqn">-100\%</code>) for an 
underestimation of effects, and positive (between <code class="reqn">0</code> and <code class="reqn">100</code>) for an 
overestimation of effects. An SPPE value of <code class="reqn">0</code> means an exact prediction
of the observed survival probability at the end of the exposure profile.</p>
</td></tr>
</table>
<p>@references 
EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>
</p>

<hr>
<h2 id='predict_ode'>Predict method for <code>survFit</code> objects</h2><span id='topic+predict_ode'></span>

<h3>Description</h3>

<p>This is a <code>method</code> to replace function <code>predict</code> used on <code>survFit</code>
object when computing issues happen. <code>predict_ode</code> uses the <code>deSolve</code>
library to improve robustness. However, time to compute may be longer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_ode(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_ode_+3A_object">object</code></td>
<td>
<p>an object used to select a method <code>ppc</code></p>
</td></tr>
<tr><td><code id="predict_ode_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>predict_ode</code>
</p>

<hr>
<h2 id='predict_ode.survFit'>Predict method for <code>survFit</code> objects</h2><span id='topic+predict_ode.survFit'></span>

<h3>Description</h3>

<p>This is the generic <code>predict</code> S3 method for the <code>survFit</code> class.
It provides predicted survival rate for &quot;SD&quot; or &quot;IT&quot; models under constant or time-variable exposure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFit'
predict_ode(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = 1000,
  hb_value = TRUE,
  interpolate_length = 100,
  interpolate_method = "linear",
  hb_valueFORCED = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_ode.survFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_data_predict">data_predict</code></td>
<td>
<p>A dataframe with three columns <code>time</code>, <code>conc</code> and <code>replicate</code>
used for prediction. If <code>NULL</code>, prediction is based on <code>x</code> object of 
class <code>survFit</code> used for fitting.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, return a set of survival curves using
parameters drawn from the posterior distribution.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>Can be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_hb_value">hb_value</code></td>
<td>
<p>If <code>TRUE</code>, the background mortality <code>hb</code> is taken into account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to a fixed value. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_interpolate_length">interpolate_length</code></td>
<td>
<p>Length of the time sequence for which output is wanted.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_interpolate_method">interpolate_method</code></td>
<td>
<p>The interpolation method for concentration. See package <code>deSolve</code> for details.
Default is <code>linear</code>.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_hb_valueforced">hb_valueFORCED</code></td>
<td>
<p>If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>.</p>
</td></tr>
<tr><td><code id="predict_ode.survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> of <code>data.frame</code> with the quantiles of outputs in
<code>df_quantiles</code> or all the MCMC chaines <code>df_spaghetti</code>
</p>

<hr>
<h2 id='predict.survFit'>Predict method for <code>survFit</code> objects</h2><span id='topic+predict.survFit'></span><span id='topic+predict_Nsurv'></span><span id='topic+predict_Nsurv.survFit'></span><span id='topic+predict'></span><span id='topic+predict_Nsurv_ode'></span><span id='topic+predict_Nsurv_ode.survFit'></span>

<h3>Description</h3>

<p>This is the generic <code>predict</code> S3 method for the <code>survFit</code> class.
It provides simulation for &quot;SD&quot; or &quot;IT&quot; models under constant or time-variable exposure.
</p>
<p>It provides the simulated number of survivors for &quot;SD&quot; or &quot;IT&quot; models under
constant or time-variable exposure.
</p>
<p>It provides the simulated number of survivors for &quot;SD&quot; or &quot;IT&quot; models under constant or
time-variable exposure.
</p>
<p>This is a <code>method</code> to replace function <code>predict_Nsurv</code> used on <code>survFit</code>
object when computing issues happen. <code>predict_nsurv_ode</code> uses the <code>deSolve</code>
library to improve robustness. However, time to compute may be longer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFit'
predict(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = NULL,
  hb_value = TRUE,
  ratio_no.NA = 0.95,
  hb_valueFORCED = NA,
  extend_time = 100,
  ...
)

predict_Nsurv(object, ...)

## S3 method for class 'survFit'
predict_Nsurv(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = NULL,
  hb_value = TRUE,
  hb_valueFORCED = NA,
  extend_time = 100,
  ...
)

predict_Nsurv_ode(
  object,
  data_predict,
  spaghetti,
  mcmc_size,
  hb_value,
  hb_valueFORCED,
  extend_time,
  interpolate_length,
  interpolate_method,
  ...
)

## S3 method for class 'survFit'
predict_Nsurv_ode(
  object,
  data_predict = NULL,
  spaghetti = FALSE,
  mcmc_size = 1000,
  hb_value = TRUE,
  hb_valueFORCED = NA,
  extend_time = 100,
  interpolate_length = NULL,
  interpolate_method = "linear",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.survFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_data_predict">data_predict</code></td>
<td>
<p>A dataframe with three columns <code>time</code>, <code>conc</code> and <code>replicate</code>
used for prediction. If <code>NULL</code>, prediction is based on <code>x</code> object of 
class <code>survFit</code> used for fitting.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_spaghetti">spaghetti</code></td>
<td>
<p>If <code>TRUE</code>, return a set of survival curves using
parameters drawn from the posterior distribution.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_mcmc_size">mcmc_size</code></td>
<td>
<p>Can be used to reduce the number of mcmc samples in order to speed up
the computation. <code>mcmc_size</code> is the number of selected iterations for one chain. Default
is 1000. If all MCMC is wanted, set argument to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_hb_value">hb_value</code></td>
<td>
<p>If <code>TRUE</code>, the background mortality <code>hb</code> is taken into account from the posterior.
If <code>FALSE</code>, parameter <code>hb</code> is set to 0. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_ratio_no.na">ratio_no.NA</code></td>
<td>
<p>A numeric between 0 and 1 standing for the proportion of non-NA values
required to compute quantile. The default is <code class="reqn">0.95</code>.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_hb_valueforced">hb_valueFORCED</code></td>
<td>
<p>If <code>hb_value</code> is <code>FALSE</code>, it fix <code>hb</code>.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_extend_time">extend_time</code></td>
<td>
<p>Length of time points interpolated with variable exposure profiles.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_interpolate_length">interpolate_length</code></td>
<td>
<p>Length of the time sequence for which output is wanted.</p>
</td></tr>
<tr><td><code id="predict.survFit_+3A_interpolate_method">interpolate_method</code></td>
<td>
<p>The interpolation method for concentration. See package <code>deSolve</code> for details.
Default is <code>linear</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> of <code>data.frame</code> with the quantiles of outputs in
<code>df_quantiles</code> or all the MCMC chaines <code>df_spaghetti</code>
</p>
<p>an object of class <code>predict_Nsurv</code>.
</p>
<p>The function returns an object of class <code>survFitPredict_Nsurv</code>, which is
a list with the two following <code>data.frame</code>:
</p>
<table role = "presentation">
<tr><td><code>df_quantile</code></td>
<td>
<p>A <code>data.frame</code> with 10 columns, <code>time</code>, <code>conc</code>,
<code>replicate</code>, <code>Nsurv</code> (observed number of survivors)
and other columns with median and 95% credible interval
of the number of survivors computed with 2 different way 
refers as <code>check</code> and <code>valid</code>:  
<code>Nsurv_q50_check</code>, <code>Nsurv_qinf95_check</code>,
<code>Nsurv_qsup95_check</code>, <code>Nsurv_q50_valid</code>, <code>Nsurv_qinf95_valid</code>,
<code>Nsurv_qsup95_valid</code>. The <code>_check</code> refers to the number of survivors
at time <code class="reqn">t</code> predicted using the observed number
of survivors at time <code class="reqn">t-1</code>,
while the <code>_valid</code> refers to the number of survivors predicted at time
<code class="reqn">t</code> based on the predicted number of survivors at time <code class="reqn">t-1</code>.</p>
</td></tr>
<tr><td><code>df_spaghetti</code></td>
<td>
<p>NULL if arguement <code>spaghetti = FALSE</code>. With <code>spaghetti = TRUE</code>, it returns a
dataframe with all simulations based on MCMC parameters from a <code>survFit</code> object.</p>
</td></tr>
</table>
<p>an object of class <code>predict_Nsurv_ode</code>.
</p>
<p>a <code>list</code> of <code>data.frame</code> with the quantiles of outputs in
<code>df_quantiles</code> or all the MCMC chaines <code>df_spaghetti</code>
</p>

<hr>
<h2 id='print.msgTable'>Print <code>msgTables</code> objects</h2><span id='topic+print.msgTable'></span>

<h3>Description</h3>

<p>Print in the REPL the <code>msgTables</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'msgTable'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.msgTable_+3A_x">x</code></td>
<td>
<p>an object of class <code>msgTables</code></p>
</td></tr>
<tr><td><code id="print.msgTable_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print in the REPL the <code>msgTables</code>
</p>

<hr>
<h2 id='print.reproFitTT'>Print of <code>reproFitTT</code> object</h2><span id='topic+print.reproFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>print</code> S3 method for the <code>reproFitTT</code> class.
It prints the underlying JAGS model and some information on the Bayesian 
inference procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproFitTT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.reproFitTT_+3A_x">x</code></td>
<td>
<p>An object of class <code>reproFitTT</code></p>
</td></tr>
<tr><td><code id="print.reproFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the model text and the Jags Computing information
</p>

<hr>
<h2 id='print.survFitCstExp'>Print of <code>survFit</code> object</h2><span id='topic+print.survFitCstExp'></span>

<h3>Description</h3>

<p>This is the generic <code>print</code> S3 method for the <code>survFitCstExp</code> class.
It prints the underlying JAGS model and some information on the Bayesian 
inference procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitCstExp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survFitCstExp_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitCstExp</code></p>
</td></tr>
<tr><td><code id="print.survFitCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the model text and the Jags Computing information
</p>

<hr>
<h2 id='print.survFitTKTD'>Print of <code>survFitTKTD</code> object</h2><span id='topic+print.survFitTKTD'></span>

<h3>Description</h3>

<p>This is the generic <code>print</code> S3 method for the <code>survFitTKTD</code> class.
It prints the underlying JAGS model and some information on the Bayesian 
inference procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTKTD'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survFitTKTD_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitTKTD</code></p>
</td></tr>
<tr><td><code id="print.survFitTKTD_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the model text and the Jags Computing information
</p>

<hr>
<h2 id='print.survFitTT'>Print of <code>survFitTT</code> object</h2><span id='topic+print.survFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>print</code> S3 method for the <code>survFitTT</code> class.
It prints the underlying JAGS model and some information on the Bayesian 
inference procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survFitTT_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitTT</code></p>
</td></tr>
<tr><td><code id="print.survFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the model text and the Jags Computing information
</p>

<hr>
<h2 id='print.survFitVarExp'>Print of <code>survFitVarExp</code> object</h2><span id='topic+print.survFitVarExp'></span>

<h3>Description</h3>

<p>This is the generic <code>print</code> S3 method for the <code>survFitVarExp</code> class.
It prints the underlying JAGS model and some information on the Bayesian
inference procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitVarExp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.survFitVarExp_+3A_x">x</code></td>
<td>
<p>An object of class <code>survFitVarExp</code></p>
</td></tr>
<tr><td><code id="print.survFitVarExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the model text and the Jags Computing information
</p>

<hr>
<h2 id='priors_distribution'>Density distribution of priors.</h2><span id='topic+priors_distribution'></span>

<h3>Description</h3>

<p>Return a <code>data.frame</code> with prior density distributions of parameters used in
<code>object</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priors_distribution(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priors_distribution_+3A_object">object</code></td>
<td>
<p>An object used to select a method</p>
</td></tr>
<tr><td><code id="priors_distribution_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the <code>object</code> is of class <code>survFit</code>, see <a href="#topic+priors_distribution.survFit">priors_distribution.survFit</a>
</p>


<h3>Value</h3>

<p>an object of class <code>priors_distribution</code>
</p>

<hr>
<h2 id='priors_distribution.survFit'>Density distribution of priors from a <code>survFit</code> object.</h2><span id='topic+priors_distribution.survFit'></span>

<h3>Description</h3>

<p>Return a <code>data.frame</code> with priors distribution of parameters used in
<code>object</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFit'
priors_distribution(object, size_sample = 1000, EFSA_name = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priors_distribution.survFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="priors_distribution.survFit_+3A_size_sample">size_sample</code></td>
<td>
<p>Size of the random generation of the distribution.
Default is <code>1e3</code>.</p>
</td></tr>
<tr><td><code id="priors_distribution.survFit_+3A_efsa_name">EFSA_name</code></td>
<td>
<p>If <code>TRUE</code>, replace the current terminology by
the one used in the recent EFSA PPR Scientific Opinion (2018).</p>
</td></tr>
<tr><td><code id="priors_distribution.survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> with prio distribution.
</p>


<h3>References</h3>

<p>EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>.
</p>

<hr>
<h2 id='priors_survData'>Create a list of scalars giving priors to use in Bayesian inference.</h2><span id='topic+priors_survData'></span>

<h3>Description</h3>

<p>Create a list of scalars giving priors to use in Bayesian inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>priors_survData(x, model_type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="priors_survData_+3A_x">x</code></td>
<td>
<p>An object of class <code>survData</code></p>
</td></tr>
<tr><td><code id="priors_survData_+3A_model_type">model_type</code></td>
<td>
<p>TKTD model type ('SD' or 'IT')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list for parameterization of priors for Bayesian inference with JAGS.
</p>

<hr>
<h2 id='propiconazole'>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole
during four days</h2><span id='topic+propiconazole'></span>

<h3>Description</h3>

<p>Survival data set of chronic laboratory toxicity tests with
<em>Gammarus pulex</em> freshwater invertebrate exposed to eight concentrations
of one fungicide (propiconazole) during four days. Eight
concentrations were tested with two replicates of 10 organisms per concentration.
Survival is monitored at five time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(propiconazole)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 75 observations on the following four variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>factor</code> with the
replicate code (<code>SC</code> for the control and <code>A1</code> to <code>G2</code> for other profiles).</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with propiconazole
concentrations in <code class="reqn">\mu mol.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd></dl>



<h3>References</h3>

<p>Nyman, A.-M., Schirmer, K., Ashauer, R., (2012) Toxicokinetic-toxicodynamic
modelling of survival of <em>Gammarus pulex</em> in multiple pulse exposures to
propiconazole: model assumptions, calibration data requirements and predictive
power, <em>Ecotoxicology</em>, (21), 1828-1840.
</p>

<hr>
<h2 id='propiconazole_pulse_exposure'>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole
during 10 days with time-variable
exposure concentration (non-standard pulsed toxicity experiments)</h2><span id='topic+propiconazole_pulse_exposure'></span>

<h3>Description</h3>

<p>Survival data set of laboratory toxicity tests with <em>Gammarus pulex</em>
freshwater invertebrates exposed to several profiles of concentrations
(time-variable concentration for each time series)
of one fungicide (propiconazole) during 10 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(propiconazole_pulse_exposure)
</code></pre>


<h3>Format</h3>

<p>A data frame with 74 observations on the following four variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>factor</code> with the
replicate code (<code>varControl</code>, <code>varA</code>, <code>varB</code> and <code>varC</code>).</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with propiconazole
concentrations in <code class="reqn">\mu mol.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd></dl>



<h3>References</h3>

<p>Nyman, A.-M., Schirmer, K., Ashauer, R., (2012) Toxicokinetic-toxicodynamic
modelling of survival of <em>Gammarus pulex</em> in multiple pulse exposures to
propiconazole: model assumptions, calibration data requirements and predictive
power, <em>Ecotoxicology</em>, (21), 1828-1840.
</p>

<hr>
<h2 id='propiconazole_split'>Survival data set for <em>Gammarus pulex</em> exposed to propiconazole
during four days</h2><span id='topic+propiconazole_split'></span>

<h3>Description</h3>

<p>Survival data set of chronic laboratory toxicity tests with
<em>Gammarus pulex</em> freshwater invertebrate exposed to eight concentrations
of one fungicide (propiconazole) during four days. Eight
concentrations were tested with two replicates of 10 organisms per concentration.
Survival is monitored at five time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(propiconazole_split)
</code></pre>


<h3>Format</h3>

<p>A dataframe with 75 observations on the following four variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>factor</code> with the
replicate code (<code>SC</code> for the control and <code>A1</code> to <code>G2</code> for other profiles).</p>
</dd>
<dt><code>conc</code></dt><dd><p>A vector of class <code>numeric</code> with propiconazole
concentrations in <code class="reqn">\mu mol.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd></dl>



<h3>References</h3>

<p>Nyman, A.-M., Schirmer, K., Ashauer, R., (2012) Toxicokinetic-toxicodynamic
modelling of survival of <em>Gammarus pulex</em> in multiple pulse exposures to
propiconazole: model assumptions, calibration data requirements and predictive
power, <em>Ecotoxicology</em>, (21), 1828-1840.
</p>

<hr>
<h2 id='reproData'>Creates a dataset for reproduction toxicity analysis</h2><span id='topic+reproData'></span>

<h3>Description</h3>

<p>This function creates a <code>reproData</code> object from experimental
data provided as a <code>data.frame</code>. The resulting object can then be used
for plotting and model fitting. The <code>reproData</code> class is a sub-class
of <code>survData</code>, meaning that all functions and method available for
survival analysis can be used with <code>reproData</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reproData(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reproData_+3A_x">x</code></td>
<td>
<p>a dataframe as expected by <code>survData</code> containing one
additional <code>Nrepro</code> column of class <code>integer</code> with positive
values only. This column should
provide the number of offspring produced since the last observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>x</code> argument contains the experimental data, and should have
the same structure than the argument of <code>survData</code>, plus a single
additional column providing the total number of offspring observed since the
last time point. The function fails if <code>x</code> does not meet the
expected requirements. Please run <code><a href="#topic+reproDataCheck">reproDataCheck</a></code> to ensure
<code>x</code> is well-formed.
</p>
<p>Note that experimental data with time-variable exposure are not supported.
</p>


<h3>Value</h3>

<p>An object of class <code>reproData</code>.
</p>

<hr>
<h2 id='reproDataCheck'>Checks if an object can be used to perform reproduction toxicity data analysis</h2><span id='topic+reproDataCheck'></span>

<h3>Description</h3>

<p>The <code>reproDataCheck</code> function can be used to check if an object
containing data from a reproduction toxicity assay meets the expectations
of the function <code><a href="#topic+reproData">reproData</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reproDataCheck(data, diagnosis.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reproDataCheck_+3A_data">data</code></td>
<td>
<p>any object</p>
</td></tr>
<tr><td><code id="reproDataCheck_+3A_diagnosis.plot">diagnosis.plot</code></td>
<td>
<p>if <code>TRUE</code>, produces a diagnosis plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since in morse' reproduction data sets are a special case of survival data sets,
<code>reproDataCheck</code> performs the same verifications than
<code><a href="#topic+survDataCheck">survDataCheck</a></code> plus additional ones that are specific to
reproduction data.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> similar to the one returned
by <code><a href="#topic+survDataCheck">survDataCheck</a></code>, except that it may contain the following
additional error <code>id</code>s:
</p>

<ul>
<li> <p><code>NreproInteger</code>: column <code>Nrepro</code> contains values of class other than <code>integer</code>
</p>
</li>
<li> <p><code>Nrepro0T0</code>: <code>Nrepro</code> is not 0 at time 0 for each concentration and each replicate
</p>
</li>
<li> <p><code>Nsurvt0Nreprotp1P</code>: at a given time <code class="reqn">T</code>, the number of
alive individuals is null and the number of collected offspring is not null
for the same replicate and the same concentration at time <code class="reqn">T+1</code>
</p>
</li></ul>



<h3>Note</h3>

<p>If an error of type <code>dataframeExpected</code> or <code>missingColumn</code>
is detected, the function
<code>reproDataCheck</code> is stopped. When no error is detected the
<code>reproDataCheck</code>
function returns an empty dataframe.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reproData">reproData</a></code>
</p>

<hr>
<h2 id='reproFitTT'>Fits a Bayesian concentration-effect model for target-time reproduction analysis</h2><span id='topic+reproFitTT'></span>

<h3>Description</h3>

<p>This function estimates the parameters of a concentration-effect model for
target-time reproduction analysis using Bayesian inference.
In this model the endpoint is the cumulated number of reproduction outputs over
time, with potential mortality all along the experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reproFitTT(
  data,
  stoc.part = "bestfit",
  target.time = NULL,
  ecx = c(5, 10, 20, 50),
  n.chains = 3,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reproFitTT_+3A_data">data</code></td>
<td>
<p>an object of class <code>reproData</code></p>
</td></tr>
<tr><td><code id="reproFitTT_+3A_stoc.part">stoc.part</code></td>
<td>
<p>stochastic part of the model. Possible values are <code>"bestfit"</code>,
<code>"poisson"</code> and <code>"gammapoisson"</code></p>
</td></tr>
<tr><td><code id="reproFitTT_+3A_target.time">target.time</code></td>
<td>
<p>defines the target time point at which to analyse the repro data. By default the last time point</p>
</td></tr>
<tr><td><code id="reproFitTT_+3A_ecx">ecx</code></td>
<td>
<p>desired values of <code class="reqn">x</code> (in percent) for which to compute
<code class="reqn">EC_{x}</code></p>
</td></tr>
<tr><td><code id="reproFitTT_+3A_n.chains">n.chains</code></td>
<td>
<p>number of MCMC chains. The minimum required number of chains is 2</p>
</td></tr>
<tr><td><code id="reproFitTT_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code>, does not print messages and progress bars from JAGS</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because some individuals may die during the observation period, the
reproduction rate alone is not sufficient to account for the observed number
of offspring at a given time point. In addition, we need the time individuals have stayed alive
during this observation period. The <code>reproFitTT</code> function estimates the number
of individual-days in an experiment between its start and the target time.
This covariable is then used to estimate a relation between the chemical compound
concentration and the reproduction rate <em>per individual-day</em>.
</p>
<p>The <code>reproFitTT</code> function fits two models, one where inter-individual
variability is neglected (&quot;Poisson&quot; model) and one where it is taken into
account (&quot;gamma-Poisson&quot; model). When setting <code>stoc.part</code> to
<code>"bestfit"</code>, a model comparison procedure is used to choose between
both. More details are presented in the vignette accompanying the package.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>reproFitTT</code> which is a list
of the following objects:
</p>
<table role = "presentation">
<tr><td><code>DIC</code></td>
<td>
<p>DIC value of the selected model</p>
</td></tr>
<tr><td><code>estim.ECx</code></td>
<td>
<p>a table of the estimated 5, 10, 20 and 50 % effective
concentrations (by default) and their 95 % credible intervals</p>
</td></tr>
<tr><td><code>estim.par</code></td>
<td>
<p>a table of the estimated parameters as medians and 95 %
credible intervals</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>an object of class <code>mcmc.list</code> with the posterior distribution</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a JAGS model object</p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>a data.frame with warning messages</p>
</td></tr>
<tr><td><code>model.label</code></td>
<td>
<p>a character string, <code>"P"</code> if the Poisson model is used,
<code>"GP"</code> if the gamma-Poisson is used</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list of the parameter names used in the model</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>an integer value corresponding to the number of chains used
for the MCMC computation</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>a list of two indices indicating the beginning and
the end of monitored iterations</p>
</td></tr>
<tr><td><code>n.thin</code></td>
<td>
<p>a numerical value corresponding to the thinning interval</p>
</td></tr>
<tr><td><code>jags.data</code></td>
<td>
<p>a list of the data passed to the jags model</p>
</td></tr>
<tr><td><code>transformed.data</code></td>
<td>
<p>the <code>survData</code> object passed to the function</p>
</td></tr>
<tr><td><code>dataTT</code></td>
<td>
<p>the dataset with which the parameters are estimated</p>
</td></tr>
</table>

<hr>
<h2 id='summary.reproData'>Summary of <code>reproData</code> object</h2><span id='topic+summary.reproData'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>reproData</code> class.
It provides information about the structure of the data set and the experimental
design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproData'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.reproData_+3A_object">object</code></td>
<td>
<p>an object of class <code>reproData</code></p>
</td></tr>
<tr><td><code id="summary.reproData_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.reproData_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the same information than 
<code><a href="#topic+summary.survDataCstExp">summary.survDataCstExp</a></code> plus an additional one:
</p>
<table role = "presentation">
<tr><td><code>NboffTimeConc</code></td>
<td>
<p>nb of offspring for all concentrations and time points</p>
</td></tr>
</table>

<hr>
<h2 id='summary.reproFitTT'>Summary of <code>reproFitTT</code> object</h2><span id='topic+summary.reproFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>reproFitTT</code> class.
It shows the quantiles of priors and posteriors on parameters
and the quantiles of the posterior on the ECx estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reproFitTT'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.reproFitTT_+3A_object">object</code></td>
<td>
<p>an object of class <code>reproFitTT</code></p>
</td></tr>
<tr><td><code id="summary.reproFitTT_+3A_quiet">quiet</code></td>
<td>
<p>when <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.reproFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>Qpriors</code></td>
<td>
<p>quantiles of the model priors</p>
</td></tr>
<tr><td><code>Qposteriors</code></td>
<td>
<p>quantiles of the model posteriors</p>
</td></tr>
<tr><td><code>QECx</code></td>
<td>
<p>quantiles of ECx estimates</p>
</td></tr>
</table>

<hr>
<h2 id='summary.survDataCstExp'>Summary of <code>survDataCstExp</code> object</h2><span id='topic+summary.survDataCstExp'></span>

<h3>Description</h3>

<p>The generic <code>summary</code> S3 method for the <code>survDataCstExp</code> class provides
information about the structure of the data set and the experimental design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataCstExp'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survDataCstExp_+3A_object">object</code></td>
<td>
<p>an object of class <code>survDataCstExp</code></p>
</td></tr>
<tr><td><code id="summary.survDataCstExp_+3A_quiet">quiet</code></td>
<td>
<p>when <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.survDataCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>NbrepTimeConc</code></td>
<td>
<p>nb of replicates for all concentrations and time points</p>
</td></tr>
<tr><td><code>NbsurvTimeConc</code></td>
<td>
<p>nb of survivors. for all concentrations and time points</p>
</td></tr>
</table>

<hr>
<h2 id='summary.survDataVarExp'>Summary of <code>survDataVarExp</code> object</h2><span id='topic+summary.survDataVarExp'></span>

<h3>Description</h3>

<p>The generic <code>summary</code> S3 method for the <code>survDataVarExp</code> class provides
information about the structure of the data set and the experimental design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataVarExp'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survDataVarExp_+3A_object">object</code></td>
<td>
<p>an object of class <code>survDataVarExp</code></p>
</td></tr>
<tr><td><code id="summary.survDataVarExp_+3A_quiet">quiet</code></td>
<td>
<p>when <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.survDataVarExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>OccRepTime</code></td>
<td>
<p>Occurence of replicates for all time points</p>
</td></tr>
<tr><td><code>NbsurvTimeRep</code></td>
<td>
<p>nb of survivors. for all replicates and time points</p>
</td></tr>
<tr><td><code>ConcTimeRep</code></td>
<td>
<p>Concentration for all replicates and time points</p>
</td></tr>
</table>

<hr>
<h2 id='summary.survFit'>Summary of <code>survFit</code> object</h2><span id='topic+summary.survFit'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>survFit</code> class.
It shows the quantiles of priors and posteriors on parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFit'
summary(object, quiet = FALSE, EFSA_name = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>survFit</code>.</p>
</td></tr>
<tr><td><code id="summary.survFit_+3A_quiet">quiet</code></td>
<td>
<p>When <code>TRUE</code>, does not print.</p>
</td></tr>
<tr><td><code id="summary.survFit_+3A_efsa_name">EFSA_name</code></td>
<td>
<p>If <code>TRUE</code>, the current terminology by
the one used in the recent EFSA PPR Scientific Opinion (2018).</p>
</td></tr>
<tr><td><code id="summary.survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>Qpriors</code></td>
<td>
<p>quantiles of the model priors</p>
</td></tr>
<tr><td><code>Qposteriors</code></td>
<td>
<p>quantiles of the model posteriors</p>
</td></tr>
</table>


<h3>References</h3>

<p>EFSA PPR Scientific Opinion (2018)
<em>Scientific Opinion on the state of the art of Toxicokinetic/Toxicodynamic (TKTD) effect models for regulatory risk assessment of pesticides for aquatic organisms</em>
<a href="https://www.efsa.europa.eu/en/efsajournal/pub/5377">https://www.efsa.europa.eu/en/efsajournal/pub/5377</a>.
</p>

<hr>
<h2 id='summary.survFitTKTD'>Summary of <code>survFitTKTD</code> object</h2><span id='topic+summary.survFitTKTD'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 methode for the <code>survFitTKTD</code> class.
It shows the quantiles of priors and posteriors on parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTKTD'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survFitTKTD_+3A_object">object</code></td>
<td>
<p>an object of class <code>survFitTKTD</code></p>
</td></tr>
<tr><td><code id="summary.survFitTKTD_+3A_quiet">quiet</code></td>
<td>
<p>when <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.survFitTKTD_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>Qpriors</code></td>
<td>
<p>quantiles of the model priors</p>
</td></tr>
<tr><td><code>Qposteriors</code></td>
<td>
<p>quantiles of the model posteriors</p>
</td></tr>
</table>

<hr>
<h2 id='summary.survFitTT'>Summary of <code>survFitTT</code> object</h2><span id='topic+summary.survFitTT'></span>

<h3>Description</h3>

<p>This is the generic <code>summary</code> S3 method for the <code>survFitTT</code> class.
It shows the quantiles of priors and posteriors on parameters and the quantiles
of the posteriors on the LCx estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survFitTT'
summary(object, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.survFitTT_+3A_object">object</code></td>
<td>
<p>an object of class <code>survFitTT</code></p>
</td></tr>
<tr><td><code id="summary.survFitTT_+3A_quiet">quiet</code></td>
<td>
<p>when <code>TRUE</code>, does not print</p>
</td></tr>
<tr><td><code id="summary.survFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>Qpriors</code></td>
<td>
<p>quantiles of the model priors</p>
</td></tr>
<tr><td><code>Qposteriors</code></td>
<td>
<p>quantiles of the model posteriors</p>
</td></tr>
<tr><td><code>QLCx</code></td>
<td>
<p>quantiles of LCx estimates</p>
</td></tr>
</table>

<hr>
<h2 id='survData'>Creates a data set for survival analysis</h2><span id='topic+survData'></span><span id='topic+survDataCheck'></span>

<h3>Description</h3>

<p>This function creates a <code>survData</code> object from experimental data
provided as a <code>data.frame</code>. The resulting object
can then be used for plotting and model fitting. It can also be used
to generate <em>individual-time</em> estimates.
</p>
<p>The <code>survDataCheck</code> function can be used to check if an object
containing survival data is formatted according to the expectations of the
<code>survData</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survData(x)

survDataCheck(data, diagnosis.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survData_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> containing the following four columns:
</p>

<ul>
<li> <p><code>replicate</code>: a vector of any class <code>numeric</code>, <code>character</code> or <code>factor</code> for replicate
identification. A given replicate value should identify the same group of
individuals followed in time
</p>
</li>
<li> <p><code>conc</code>: a vector of class <code>numeric</code> with tested concentrations
(positive values, may contain NAs)
</p>
</li>
<li> <p><code>time</code>: a vector of class <code>integer</code> with time points, minimal value must be 0
</p>
</li>
<li> <p><code>Nsurv</code>: a vector of class <code>integer</code> providing the number of
alive individuals at each time point for each concentration and each replicate
(may contain NAs)
</p>
</li></ul>
</td></tr>
<tr><td><code id="survData_+3A_data">data</code></td>
<td>
<p>any object</p>
</td></tr>
<tr><td><code id="survData_+3A_diagnosis.plot">diagnosis.plot</code></td>
<td>
<p>if <code>TRUE</code>, the function may produce diagnosis plots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Survival data sets can be under either constant or time-variable exposure profile. The
resulting object, in addition to its <code>survData</code> class, inherits the
class <code>survDataCstExp</code> or <code>survDataVarExp</code> respectively.
</p>
<p>The <code>x</code> argument describes experimental results from a survival
toxicity test. Each line of the <code>data.frame</code>
corresponds to one experimental measurement, that is a number of alive
individuals at a given concentration at a given time point and in a given replicate.
Note that either the concentration
or the number of alive individuals may be missing. The data set is inferred
to be under constant exposure if the concentration is constant for each
replicate and systematically available. The function <code>survData</code> fails if
<code>x</code> does not meet the
expected requirements. Please run <code><a href="#topic+survDataCheck">survDataCheck</a></code> to ensure
<code>x</code> is well-formed.
</p>


<h3>Value</h3>

<p>A dataframe of class <code>survData</code> and column <code>replicate</code> as <code>factor</code>.
</p>
<p>The function returns a dataframe of class <code>msgTable</code> and <code>data.frame</code> with two columns: <code>id</code> and <code>msg</code> of
character strings. When no error is detected the object is empty.
Here is the list of possible error <code>id</code>s with their meaning:
</p>

<table>
<tr>
 <td style="text-align: right;">
<code>dataframeExpected</code> </td><td style="text-align: left;"> an object of class <code>data.frame</code> is expected </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>missingColumn</code> </td><td style="text-align: left;"> at least one expected column heading is missing </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>firstTime0</code> </td><td style="text-align: left;"> the first time point for some (concentration, replicate) couples is not 0 </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>concNumeric</code> </td><td style="text-align: left;"> column <code>conc</code> contains a value of class other than <code>numeric</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>timeNumeric</code> </td><td style="text-align: left;"> column <code>time</code> contains a value of class other than <code>numeric</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>NsurvInteger</code> </td><td style="text-align: left;"> column <code>Nsurv</code> contains a value of class other than <code>integer</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>tablePositive</code> </td><td style="text-align: left;"> some data are negative </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>Nsurv0T0</code> </td><td style="text-align: left;"> <code>Nsurv</code> is 0 at time 0 for some (concentration, replicate) </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>duplicateID</code> </td><td style="text-align: left;"> there are two identical (<code>replicate</code>, <code>time</code>) couples </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>NsurvIncrease</code> </td><td style="text-align: left;"> <code>Nsurv</code> increases at some time point of some (concentration, replicate) </td>
</tr>
<tr>
 <td style="text-align: right;">
<code>maxTimeDiffer</code> </td><td style="text-align: left;"> maximum time for concentration is lower than maximum time for survival </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>If an error of type <code>dataframeExpected</code> or <code>missingColumn</code> is
detected, the function <code>survDataCheck</code> is stopped before looking for
other errors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+survDataCheck">survDataCheck</a></code>
</p>
<p><code><a href="#topic+survData">survData</a></code>
</p>

<hr>
<h2 id='survData_join'>Joins a concentration with a survival data set into an argument for 'survData'
when the concentration varies over time</h2><span id='topic+survData_join'></span>

<h3>Description</h3>

<p>This function joins two data sets, one for exposure measurements, the other
for survival measurements, into a single dataframe that can be used
with the <code>survData</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survData_join(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survData_join_+3A_x">x</code></td>
<td>
<p>a <code>data.frame</code> containing the following three columns:
</p>

<ul>
<li> <p><code>replicate</code>: a vector of class <code>integer</code> or <code>factor</code> for replicate
identification
</p>
</li>
<li> <p><code>time</code>: a vector of class <code>integer</code> with time points, min value must be 0
</p>
</li>
<li> <p><code>Nsurv</code>: a vector of class <code>integer</code> providing the number of
alive individuals at some or all time points for each replicate
</p>
</li></ul>
</td></tr>
<tr><td><code id="survData_join_+3A_y">y</code></td>
<td>
<p>a <code>data.frame</code> containing the following three columns:
</p>

<ul>
<li> <p><code>replicate</code>: a vector of class <code>integer</code> or factor for replicate
identification
</p>
</li>
<li> <p><code>time</code>: a vector of class <code>integer</code> with time points, min value must be 0
</p>
</li>
<li> <p><code>conc</code>: a vector of class <code>numeric</code> providing the concentration
at some or all time points for each replicate
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe suitable for 'survData'
</p>

<hr>
<h2 id='survFit'>Fits a TKTD model for survival analysis using Bayesian inference</h2><span id='topic+survFit'></span><span id='topic+survFit.survDataCstExp'></span><span id='topic+survFit.survDataVarExp'></span>

<h3>Description</h3>

<p>This function estimates the parameters of a TKTD model ('SD' or 'IT')
for survival analysis using Bayesian inference. In this model,
the survival rate of individuals is modeled as a function of the chemical compound
concentration with a mechanistic description of the effects on survival over
time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survFit(
  data,
  model_type,
  quiet,
  n.chains,
  n.adapt,
  n.iter,
  n.warmup,
  thin.interval,
  limit.sampling,
  dic.compute,
  dic.type,
  hb_value,
  hb_valueFIXED,
  ...
)

## S3 method for class 'survDataCstExp'
survFit(
  data,
  model_type = NULL,
  quiet = FALSE,
  n.chains = 3,
  n.adapt = 3000,
  n.iter = NULL,
  n.warmup = NULL,
  thin.interval = NULL,
  limit.sampling = TRUE,
  dic.compute = FALSE,
  dic.type = "pD",
  hb_value = TRUE,
  hb_valueFIXED = NA,
  ...
)

## S3 method for class 'survDataVarExp'
survFit(
  data,
  model_type = NULL,
  quiet = FALSE,
  n.chains = 3,
  n.adapt = 1000,
  n.iter = NULL,
  n.warmup = NULL,
  thin.interval = NULL,
  limit.sampling = TRUE,
  dic.compute = FALSE,
  dic.type = "pD",
  hb_value = TRUE,
  hb_valueFIXED = NA,
  extend_time = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survFit_+3A_data">data</code></td>
<td>
<p>An object of class <code>survDataCstExp</code> or <code>survDataVarExp</code>.</p>
</td></tr>
<tr><td><code id="survFit_+3A_model_type">model_type</code></td>
<td>
<p>Can be <code>"SD"</code> or <code>"IT"</code> to choose
between &quot;Stochastic Death&quot; or &quot;Individual Tolerance&quot; models
(resp.). See the modeling vignette for details.</p>
</td></tr>
<tr><td><code id="survFit_+3A_quiet">quiet</code></td>
<td>
<p>If <code>FALSE</code>, prints logs and progress bar from
JAGS.</p>
</td></tr>
<tr><td><code id="survFit_+3A_n.chains">n.chains</code></td>
<td>
<p>A positive integer specifying the number of MCMC chains. The minimum required number 
of chains is 2.</p>
</td></tr>
<tr><td><code id="survFit_+3A_n.adapt">n.adapt</code></td>
<td>
<p>A positive integer specifying the number of iterations for adaptation. If <code>n.adapt</code> = 0
then no adaptation takes place.</p>
</td></tr>
<tr><td><code id="survFit_+3A_n.iter">n.iter</code></td>
<td>
<p>A positive integer specifying the number of iterations to monitor for each chain.</p>
</td></tr>
<tr><td><code id="survFit_+3A_n.warmup">n.warmup</code></td>
<td>
<p>A positive integer specifying the number of warmup (aka burnin) iterations per chain.</p>
</td></tr>
<tr><td><code id="survFit_+3A_thin.interval">thin.interval</code></td>
<td>
<p>A positive integer specifying the period to monitor.</p>
</td></tr>
<tr><td><code id="survFit_+3A_limit.sampling">limit.sampling</code></td>
<td>
<p>if <code>FALSE</code> (default is <code>TRUE</code>), there is no limit to the number of iterations
in MCMC imposed by the <code>raftery.diag</code> test.</p>
</td></tr>
<tr><td><code id="survFit_+3A_dic.compute">dic.compute</code></td>
<td>
<p>if <code>TRUE</code> (default is <code>FALSE</code>), it generates penalized deviance samples to compute
the Deviance Information Criterion (DIC) with the <code>rjags</code> package</p>
</td></tr>
<tr><td><code id="survFit_+3A_dic.type">dic.type</code></td>
<td>
<p>type of penalty to use. A string identifying the type of penalty: <code>pD</code> or <code>popt</code>
(see function <code><a href="rjags.html#topic+dic.samples">dic.samples</a></code>)</p>
</td></tr>
<tr><td><code id="survFit_+3A_hb_value">hb_value</code></td>
<td>
<p>If <code>TRUE</code>, the background mortality <code>hb</code> is taken into account.
If <code>FALSE</code>, parameter <code>hb</code> is set to 0. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="survFit_+3A_hb_valuefixed">hb_valueFIXED</code></td>
<td>
<p>If <code>hb_value</code> is <code>FALSE</code>, then <code>hb_valueFiXED</code> is the value to fix <code>hb</code>.
If <code>hb_value</code> is <code>FALSE</code> and  <code>hb_valueFiXED</code> is <code>NA</code>, then <code>hb</code> is fixed to <code>0</code>.</p>
</td></tr>
<tr><td><code id="survFit_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
<tr><td><code id="survFit_+3A_extend_time">extend_time</code></td>
<td>
<p>Number of for each replicate used for linear 
interpolation (comprise between time to compute and fitting accuracy)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>survFit</code> returns the parameter estimates of Toxicokinetic-toxicodynamic (TKTD) models
<code>SD</code> for 'Stochastic Death' or <code>IT</code> fo 'Individual Tolerance'.
TKTD models, and particularly the General Unified Threshold model of
Survival (GUTS), provide a consistent process-based
framework to analyse both time and concentration dependent datasets.
In GUTS-SD, all organisms are assumed to have the same internal concentration 
threshold (denoted <code class="reqn">z</code>), and, once exceeded, the instantaneous probability
to die increases linearly with the internal concentration.
In GUTS-IT, the threshold concentration is distributed among all the organisms, and once 
exceeded in one individual, this individual dies immediately.
</p>
<p>When class of <code>object</code> is <code>survDataCstExp</code>, see <a href="#topic+survFit.survDataCstExp">survFit.survDataCstExp</a> ;
and for a <code>survDataVarExp</code>, see <a href="#topic+survFit.survDataVarExp">survFit.survDataVarExp</a>.
</p>


<h3>Value</h3>

<p>an object of class <code>survFit</code>
</p>
<p>The function returns an object of class <code>survFitCstExp</code>, which is
a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>estim.par</code></td>
<td>
<p>a table of the estimated parameters as medians and 95%
credible intervals</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>an object of class <code>mcmc.list</code> with the posterior
distribution</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a JAGS model object</p>
</td></tr>
<tr><td><code>dic</code></td>
<td>
<p>return the Deviance Information Criterion (DIC) if <code>dic.compute</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>a table with warning messages</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list of parameter names used in the model</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>an integer value corresponding to the number of chains used
for the MCMC computation</p>
</td></tr>
<tr><td><code>mcmcInfo</code></td>
<td>
<p>a table with the number of iterations, chains, adaptation, warmup and the thinning interval.</p>
</td></tr> 
<tr><td><code>jags.data</code></td>
<td>
<p>a list of the data passed to the JAGS model</p>
</td></tr>
<tr><td><code>model_type</code></td>
<td>
<p>the type of TKTD model used: <code>SD</code> or <code>IT</code></p>
</td></tr>
</table>
<p>The function returns an object of class <code>survFitVarExp</code>, which is
a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>estim.par</code></td>
<td>
<p>a table of the estimated parameters as medians and 95%
credible intervals</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>an object of class <code>mcmc.list</code> with the posterior
distribution</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a JAGS model object</p>
</td></tr>
<tr><td><code>dic</code></td>
<td>
<p>return the Deviance Information Criterion (DIC) if <code>dic.compute</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>a table with warning messages</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list of parameter names used in the model</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>an integer value corresponding to the number of chains used
for the MCMC computation</p>
</td></tr>
<tr><td><code>mcmcInfo</code></td>
<td>
<p>a table with the number of iterations, chains, adaptation, warmup and the thinning interval</p>
</td></tr> 
<tr><td><code>jags.data</code></td>
<td>
<p>a list of the data passed to the JAGS model</p>
</td></tr>
<tr><td><code>model_type</code></td>
<td>
<p>the type of TKTD model used: <code>SD</code> or <code>IT</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Jager, T., Albert, C., Preuss, T. G. and Ashauer, R. (2011) 
General unified threshold model of survival-a toxicokinetic-toxicodynamic
framework for ecotoxicology, <em>Environmental Science and Technology</em>, 45, 2529-2540.
303-314.
</p>

<hr>
<h2 id='survFitTKTD'>Fits a TKTD for survival analysis using Bayesian inference for <code>survDataTKTD</code> object</h2><span id='topic+survFitTKTD'></span>

<h3>Description</h3>

<p>This function estimates the parameters of a TKTD
model for survival analysis using Bayesian inference. In this model,
the survival rate of individuals is modeled as a function of the chemical compound
concentration with a mechanistic description of the effects on survival over
time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survFitTKTD(data, n.chains = 3, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survFitTKTD_+3A_data">data</code></td>
<td>
<p>An object of class <code>survData</code>.</p>
</td></tr>
<tr><td><code id="survFitTKTD_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of MCMC chains. The minimum required number of chains
is 2.</p>
</td></tr>
<tr><td><code id="survFitTKTD_+3A_quiet">quiet</code></td>
<td>
<p>If <code>FALSE</code>, prints logs and progress bar from JAGS.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object of class <code>survFitTKTD</code>, which is
a list with the following information:
</p>
<table role = "presentation">
<tr><td><code>estim.par</code></td>
<td>
<p>a table of the estimated parameters as medians and 95%
credible intervals</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>an object of class <code>mcmc.list</code> with the posterior
distribution</p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>a table with warning messages</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a JAGS model object</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list of parameter names used in the model</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>an integer value corresponding to the number of chains used
for the MCMC computation</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>a list of two indices indicating the beginning and the end of
monitored iterations</p>
</td></tr>
<tr><td><code>n.thin</code></td>
<td>
<p>a numerical value corresponding to the thinning interval</p>
</td></tr>
<tr><td><code>jags.data</code></td>
<td>
<p>a list of data passed to the JAGS model</p>
</td></tr>
</table>


<h3>References</h3>

<p>Delignette-Muller ML, Ruiz P and Veber P (2017).
<em>Robust fit of toxicokinetic-toxicodynamic models using prior knowledge contained in the design of survival toxicity tests.</em>
</p>
<p>Bedaux, J., Kooijman, SALM (1994) Statistical analysis of toxicity tests,
based on hazard modeling, <em>Environmental and Ecological Statistics</em>, 1,
303-314.
</p>

<hr>
<h2 id='survFitTT'>Fits a Bayesian concentration-response model for target-time survival analysis</h2><span id='topic+survFitTT'></span>

<h3>Description</h3>

<p>Fits a Bayesian concentration-response model for target-time survival analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survFitTT(data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survFitTT_+3A_data">data</code></td>
<td>
<p>an object used to select a method 'survFitTT'</p>
</td></tr>
<tr><td><code id="survFitTT_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>survFitTT</code>
</p>

<hr>
<h2 id='survFitTT.survDataCstExp'>Fits a Bayesian concentration-response model for target-time survival analysis</h2><span id='topic+survFitTT.survDataCstExp'></span>

<h3>Description</h3>

<p>This function estimates the parameters of an concentration-response
model for target-time survival analysis using Bayesian inference. In this model,
the survival rate of individuals at a given time point (called target time) is modeled
as a function of the chemical compound concentration. The actual number of
surviving individuals is then modeled as a stochastic function of the survival
rate. Details of the model are presented in the
vignette accompanying the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survDataCstExp'
survFitTT(
  data,
  target.time = NULL,
  lcx = c(5, 10, 20, 50),
  n.chains = 3,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="survFitTT.survDataCstExp_+3A_data">data</code></td>
<td>
<p>an object of class <code>survData</code></p>
</td></tr>
<tr><td><code id="survFitTT.survDataCstExp_+3A_target.time">target.time</code></td>
<td>
<p>the chosen endpoint to evaluate the effect of the chemical compound
concentration, by default the last time point available for
all concentrations</p>
</td></tr>
<tr><td><code id="survFitTT.survDataCstExp_+3A_lcx">lcx</code></td>
<td>
<p>desired values of <code class="reqn">x</code> (in percent) for which to compute
<code class="reqn">LC_x</code>.</p>
</td></tr>
<tr><td><code id="survFitTT.survDataCstExp_+3A_n.chains">n.chains</code></td>
<td>
<p>number of MCMC chains, the minimum required number of chains
is 2</p>
</td></tr>
<tr><td><code id="survFitTT.survDataCstExp_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code>, does not print messages and progress bars from
JAGS</p>
</td></tr>
<tr><td><code id="survFitTT.survDataCstExp_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to generic methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns
parameter estimates of the concentration-response model and estimates of the so-called
<code class="reqn">LC_x</code>, that is the concentration of chemical compound required to get an <code class="reqn">(1 - x/100)</code> survival rate.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>survFitTT</code>, which is a
list with the following information:
</p>
<table role = "presentation">
<tr><td><code>estim.LCx</code></td>
<td>
<p>a table of the estimated <code class="reqn">LC_x</code> along with their 95%
credible intervals</p>
</td></tr>
<tr><td><code>estim.par</code></td>
<td>
<p>a table of the estimated parameters (medians) and 95%
credible intervals</p>
</td></tr>
<tr><td><code>det.part</code></td>
<td>
<p>the name of the deterministic part of the used model</p>
</td></tr>
<tr><td><code>mcmc</code></td>
<td>
<p>an object of class <code>mcmc.list</code> with the posterior
distribution</p>
</td></tr>
<tr><td><code>warnings</code></td>
<td>
<p>a table with warning messages</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>a JAGS model object</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>a list of parameter names used in the model</p>
</td></tr>
<tr><td><code>n.chains</code></td>
<td>
<p>an integer value corresponding to the number of chains used
for the MCMC computation</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>a list of two indices indicating the beginning and the end of
monitored iterations</p>
</td></tr>
<tr><td><code>n.thin</code></td>
<td>
<p>a numerical value corresponding to the thinning interval</p>
</td></tr>
<tr><td><code>jags.data</code></td>
<td>
<p>a list of the data passed to the JAGS model</p>
</td></tr>
<tr><td><code>transformed.data</code></td>
<td>
<p>the <code>survData</code> object passed to the function</p>
</td></tr>
<tr><td><code>dataTT</code></td>
<td>
<p>the dataset with which the parameters are estimated</p>
</td></tr>
</table>

<hr>
<h2 id='zinc'>Reproduction and survival data sets for <em>Daphnia magna</em> exposed to zinc
during 21 days</h2><span id='topic+zinc'></span>

<h3>Description</h3>

<p>Reproduction and survival data sets of a chronic laboratory toxicity tests with
<em>Daphnia magna</em> freshwater invertebrate exposed to four concentrations
of zinc during 21 days. Four concentrations were
tested with three replicates per concentration. Each replicate contained 20
organisms. Reproduction and survival were monitored at 15 time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(zinc)
</code></pre>


<h3>Format</h3>

<p>A data frame with 180 observations on the following five variables:
</p>
 <dl>
<dt><code>replicate</code></dt><dd><p>A vector of class <code>numeric</code> with the
replicate code (<code>1</code> to <code>12</code>).</p>
</dd> <dt><code>conc</code></dt><dd><p>A vector of
class <code>numeric</code> with zinc concentrations in <code class="reqn">mg.L^{-1}</code>.</p>
</dd>
<dt><code>time</code></dt><dd><p>A vector of class <code>integer</code> with the time points
(in days from the beginning of the experiment <code class="reqn">t = 0</code>).</p>
</dd>
<dt><code>Nsurv</code></dt><dd><p>A vector of class <code>integer</code> with the number of
alive individuals at each time point for each concentration and each
replicate.</p>
</dd> <dt><code>Nrepro</code></dt><dd><p>A vector of class <code>integer</code> with the
number of offspring at each time point for each concentration and each
replicate.</p>
</dd> </dl>



<h3>References</h3>

<p>Billoir, E.,Delignette-Muller, M.L., Pery, A.R.R. and
Charles S. (2008) A Bayesian Approach to Analyzing Ecotoxicological Data,
<em>Environmental Science &amp; Technology</em>, 42 (23), 8978-8984.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
