<!DOCTYPE html><html><head><title>Help for package windex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {windex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#backLog'>
<p>Backtransforms coefficient estimates from logistic regression</p></a></li>
<li><a href='#error.bars'>
<p>Plots error bars on a barplot</p></a></li>
<li><a href='#lrTest'>
<p>Calculates likelihood ratio test</p></a></li>
<li><a href='#mark.dist'>
<p>Summarising distributions of (exam/coursework/etc.) marks for (UK) university teaching</p></a></li>
<li><a href='#modSel.fitMk'>
<p>Model selection table for categorical trait evolution models fit in the fitMk function in the package phytools, based on information theoretical measures.</p></a></li>
<li><a href='#modSel.geiger'>
<p>Model selection table for phenotypic evolution models fit in the package geiger, based on information theoretical measures.</p></a></li>
<li><a href='#modSel.phylolm'>
<p>Model selection table for phylogenetic (logistic) regressions fit in the phylolm and phyloglm functions in the package phylolm, based on information theoretical measures.</p></a></li>
<li><a href='#modSel.rayDISC'>
<p>Model selection table for evolutionary pathway models fit in the package corHMM, based on information theoretical measures.</p></a></li>
<li><a href='#modSelTab'>
<p>Model selection table based on information theoretical measures.</p></a></li>
<li><a href='#nodeDist'>
<p>Plotting and/or retrieving distribution of divergence times of a pair of species from a set of phylogenetic trees.</p></a></li>
<li><a href='#pir'>
<p>Calculates phylogenetic imbalance ratio (PIR)</p></a></li>
<li><a href='#plotTrait'>
<p>Provides a visualisation of up to three-dimensional trait space (not accounting for phylogeny) for data exploration</p></a></li>
<li><a href='#prune2data'>
<p>Prunes a phylogenetic tree to match a vector (e.g. of species names in a dataset)</p></a></li>
<li><a href='#richYuleInputs'>
<p>Generates the inputs necessary to run richness.yule.test() in ape</p></a></li>
<li><a href='#sample.data'>
<p>Sample data for windex</p></a></li>
<li><a href='#sample.tree'>
<p>Phylogenetic tree to accompany sample.data</p></a></li>
<li><a href='#se'>
<p>Calculates standard error</p></a></li>
<li><a href='#test.windex'>
<p>Tests for particularly strong convergent evolution given topological constraints</p></a></li>
<li><a href='#treecheck'>
<p>Checks a set of phylogenetic trees to confirm they are ultrametric and binary.</p></a></li>
<li><a href='#treedatacheck'>
<p>Checks a set of phylogenetic trees to confirm they are ultrametric and binary and that tip labels match a list of names.</p></a></li>
<li><a href='#windex'>
<p>Calculates Wheatsheaf index with 95% confidence intervals</p></a></li>
<li><a href='#windex.sim.test'>
<p>Tests for presence of convergent evolution (over and above that expected from Brownian motion)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysing Convergent Evolution using the Wheatsheaf Index</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Arbuckle and Amanda Minter</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Arbuckle &lt;kevin.arbuckle@swansea.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysing convergent evolution using the Wheatsheaf index, described in Arbuckle et al. (2014) &lt;<a href="https://doi.org/10.1111%2F2041-210X.12195">doi:10.1111/2041-210X.12195</a>&gt;, and some other unrelated but perhaps useful functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>phytools, geiger (&ge; 2.0), ape (&ge; 4.0), phangorn,
scatterplot3d, utils, methods, R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-14 15:25:52 UTC; karbuckle</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-14 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='backLog'>
Backtransforms coefficient estimates from logistic regression
</h2><span id='topic+backLog'></span>

<h3>Description</h3>

<p>Takes raw coefficient values (e.g. from a logistic regression) and returns back-transformed estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backLog(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backLog_+3A_x">x</code></td>
<td>

<p>A numerical value to be back-transformed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the back-transformed estimate.
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>

<hr>
<h2 id='error.bars'>
Plots error bars on a barplot
</h2><span id='topic+error.bars'></span>

<h3>Description</h3>

<p>Adds error bars to a barplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>error.bars(x,y,upper,lower=upper,length=0.1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="error.bars_+3A_x">x</code></td>
<td>

<p>Command to produce a barplot (saved as an object).
</p>
</td></tr>
<tr><td><code id="error.bars_+3A_y">y</code></td>
<td>

<p>Vector of heights of bars (same as vector given as height argument to barplot).
</p>
</td></tr>
<tr><td><code id="error.bars_+3A_upper">upper</code></td>
<td>

<p>Vector of upper confidence interval to plot as error bars.
</p>
</td></tr>
<tr><td><code id="error.bars_+3A_lower">lower</code></td>
<td>

<p>Vector of lower confidence interval to plot as error bars (defaults to symmetrical error bars but can be specified separately for lower and upper confidence intervals to enable asymmetrical error bars to be plotted).
</p>
</td></tr>
<tr><td><code id="error.bars_+3A_length">length</code></td>
<td>

<p>Width of floor and ceiling of error bars in inches (not the length of the confidence interval, just an aesthetic choice), passed to arrows().
</p>
</td></tr>
<tr><td><code id="error.bars_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to arrows() to customise appearance of error bars.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>means&lt;-c(4,5,7,11)
ci&lt;-c(0.5,1.2,0.7,1)
x&lt;-barplot(means,main="",ylim=c(0,15),ylab="Mean number of things",xlab="Colours",
names.arg=c("Blue","Red","Yellow","Black"),cex.lab=1.5,col=c("blue","red","yellow","black"))
error.bars(x,y=means,upper=ci,col="grey30")
</code></pre>

<hr>
<h2 id='lrTest'>
Calculates likelihood ratio test
</h2><span id='topic+lrTest'></span>

<h3>Description</h3>

<p>Takes raw log-likelihood values plus degrees of freedom and performs a likelihood ratio test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrTest(small,big,df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrTest_+3A_small">small</code></td>
<td>

<p>Numerical value giving the smaller of the two log-likelihoods being compared.
</p>
</td></tr>
<tr><td><code id="lrTest_+3A_big">big</code></td>
<td>

<p>Numerical value giving the larger of the two log-likelihoods being compared.
</p>
</td></tr>
<tr><td><code id="lrTest_+3A_df">df</code></td>
<td>

<p>A numerical value giving the degrees of freedom for the test.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>LR</code></td>
<td>
<p>Likelihood ratio statistic</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>P-value from likelihood ratio test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>

<hr>
<h2 id='mark.dist'>
Summarising distributions of (exam/coursework/etc.) marks for (UK) university teaching
</h2><span id='topic+mark.dist'></span>

<h3>Description</h3>

<p>Provides a breakdown of marks including summary statistics, plotted histogram with test of Normality, and distribution of grades (for UK system, i.e. 1st, 2.1, 2.2, 3rd, fail). Note that grading system is assumed to be out of 100 and grade boundaries are assumed to be 40 (from fail to 3rd), 50 (from 3rd to 2.2), 60 (from 2.2 to 2.1), and 70 (from 2.1 to 1st).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mark.dist(marks,plot=TRUE,col="light grey",main=NULL,xlab="Marks",xlim=c(0,100),
showBounds=FALSE,y=20,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mark.dist_+3A_marks">marks</code></td>
<td>

<p>Numerical vector containing the marks being summarised.
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_plot">plot</code></td>
<td>

<p>A logical indicating whether to plot a histogram of mark distribution.
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_col">col</code></td>
<td>

<p>Fill colour for histogram, passed to hist().
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_main">main</code></td>
<td>

<p>Title for histogram, passed to hist().
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_xlab">xlab</code></td>
<td>

<p>Text for x-axis label of histogram, passed to hist().
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_xlim">xlim</code></td>
<td>

<p>Numerical vector of length 2 giving start and end points of x-axis of histogram, passed to hist().
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_showbounds">showBounds</code></td>
<td>

<p>A logical which, if TRUE, adds dashed lines and text to the histogram illustrating grade boundaries.
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_y">y</code></td>
<td>

<p>If showBounds=TRUE, y gives the height to plot the text on the histogram (this will likely need tweaked for each case).
</p>
</td></tr>
<tr><td><code id="mark.dist_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to hist() to customise the histogram.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Summary</code></td>
<td>
<p>Summary statistics of the mark distribution</p>
</td></tr>
<tr><td><code>NormalityTest</code></td>
<td>
<p>Results of Shapiro-Wilk normality test</p>
</td></tr>
<tr><td><code>GradeBreakdown</code></td>
<td>
<p>Proportion of marks falling into each grade</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>testscores&lt;-rnorm(n=85,mean=60,sd=15)
mark.dist(testscores)
</code></pre>

<hr>
<h2 id='modSel.fitMk'>
Model selection table for categorical trait evolution models fit in the fitMk function in the package phytools, based on information theoretical measures.
</h2><span id='topic+modSel.fitMk'></span>

<h3>Description</h3>

<p>Creates a model selection table based on either AIC or AICc for categorical trait evolution models fit using the fitMk() function in the phytools package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSel.fitMk(...,tree=NULL,type="AICc")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSel.fitMk_+3A_...">...</code></td>
<td>

<p>A set of categorical trait evolution models fit with the fitMk function in the package phytools, which you want to compare.
</p>
</td></tr>
<tr><td><code id="modSel.fitMk_+3A_tree">tree</code></td>
<td>

<p>Either an object of class phylo used to fit the models being compared, or a numerical value giving the number of species in the tree used to fit the models being compared. Only necessary when type=&quot;AICc&quot;.
</p>
</td></tr>
<tr><td><code id="modSel.fitMk_+3A_type">type</code></td>
<td>

<p>Type of information theoretical measure you want to use (AICc or AIC are allowed), defaults to AICc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model selection table with rownames corresponding to input model names and columns for K (number of parameters), logLik (log-likelihood), AICc (or AIC), deltaAICc (or deltaAIC, the difference between each model and the best model), Weight (Akaike weights, aka model probabilities), and Evidence ratio (the amount of evidence for the best model relative to each model such that, for instance, 4 would mean that model has 4x less evidence supporting it than the best model).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Three models initially run in phytools using fitMk (see help file for that package to fit
# these models) and saved as objects named 'er', 'sym', and 'ard'.

# Model selection table using AICc
modSel.fitMk(er,sym,ard,tree=phy)

# Model selection table using AIC
modSel.fitMk(er,sym,ard,tree=phy,type="AIC")
## End(Not run)
</code></pre>

<hr>
<h2 id='modSel.geiger'>
Model selection table for phenotypic evolution models fit in the package geiger, based on information theoretical measures.
</h2><span id='topic+modSel.geiger'></span>

<h3>Description</h3>

<p>Creates a model selection table based on either AIC or AICc for phenotypic evolution models fit using the fitContinuous() and fitDiscrete() functions in the geiger package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSel.geiger(...,type="AICc")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSel.geiger_+3A_...">...</code></td>
<td>

<p>A set of phenotypic evolution models fitted with either fitContinuous() or fitDiscrete() in the package geiger, which you want to compare.
</p>
</td></tr>
<tr><td><code id="modSel.geiger_+3A_type">type</code></td>
<td>

<p>Type of information theoretical measure you want to use (AICc or AIC are allowed), defaults to AICc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model selection table with rownames corresponding to input model names and columns for K (number of parameters), logLik (log-likelihood), AICc (or AIC), deltaAICc (or deltaAIC, the difference between each model and the best model), Weight (Akaike weights, aka model probabilities), and Evidence ratio (the amount of evidence for the best model relative to each model such that, for instance, 4 would mean that model has 4x less evidence supporting it than the best model).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Two models initially run in geiger using fitContinuous (see help file for that package to fit
# these models) and saved as objects named 'bm' and 'ou'.

# Model selection table using AICc
modSel.geiger(bm,ou)

# Model selection table using AIC
modSel.geiger(bm,ou,type="AIC")
## End(Not run)
</code></pre>

<hr>
<h2 id='modSel.phylolm'>
Model selection table for phylogenetic (logistic) regressions fit in the phylolm and phyloglm functions in the package phylolm, based on information theoretical measures.
</h2><span id='topic+modSel.phylolm'></span>

<h3>Description</h3>

<p>Creates a model selection table based on either AIC or AICc for phylogenetic (logistic) regressions fit using the phylolm() or phyloglm() functions in the phylolm package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSel.phylolm(...,tree=NULL,type="AICc",method=c("phylolm","logistic"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSel.phylolm_+3A_...">...</code></td>
<td>

<p>A set of phylogenetic (logistic) regressions fit in the phylolm and phyloglm functions in the package phylolm, which you want to compare.
</p>
</td></tr>
<tr><td><code id="modSel.phylolm_+3A_tree">tree</code></td>
<td>

<p>Either an object of class phylo used to fit the models being compared, or a numerical value giving the number of species in the tree used to fit the models being compared. Only necessary when type=&quot;AICc&quot;.
</p>
</td></tr>
<tr><td><code id="modSel.phylolm_+3A_type">type</code></td>
<td>

<p>Type of information theoretical measure you want to use (AICc or AIC are allowed), defaults to AICc.
</p>
</td></tr>
<tr><td><code id="modSel.phylolm_+3A_method">method</code></td>
<td>

<p>Whether the models being compared are standard phylogenetic regression (fit with phylolm function) or phylogenetic logistic regression (fit with phyloglm function). Defaults to phylolm but issues a warning if you haven't specified the method.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model selection table with rownames corresponding to input model names and columns for K (number of parameters), logLik (log-likelihood), AICc (or AIC), deltaAICc (or deltaAIC, the difference between each model and the best model), Weight (Akaike weights, aka model probabilities), and Evidence ratio (the amount of evidence for the best model relative to each model such that, for instance, 4 would mean that model has 4x less evidence supporting it than the best model).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Three models initially run in phylolm using phylolm or phyloglm
# (see help file for that package to fit these models) and saved
# as objects named 'mod1', 'mod2', and 'mod3'.

# Model selection table for phylogenetic regressions using AICc
modSel.phylolm(mod1,mod2,mod3,tree=phy,method="phylolm")

# Model selection table for phylogenetic regressions using AIC
modSel.phylolm(mod1,mod2,mod3,type="AIC",tree=phy,method="phylolm")

# Model selection table for phylogenetic logistic regressions using AICc
modSel.phylolm(mod1,mod2,mod3,tree=phy,method="logistic")
## End(Not run)
</code></pre>

<hr>
<h2 id='modSel.rayDISC'>
Model selection table for evolutionary pathway models fit in the package corHMM, based on information theoretical measures.
</h2><span id='topic+modSel.rayDISC'></span>

<h3>Description</h3>

<p>Creates a model selection table based on either AIC or AICc for evolutionary pathway models fit using the rayDISC() function in the corHMM package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSel.rayDISC(...,type="AICc")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSel.rayDISC_+3A_...">...</code></td>
<td>

<p>A set of evolutionary pathway models fitted with rayDISC() in the package corHMM, which you want to compare.
</p>
</td></tr>
<tr><td><code id="modSel.rayDISC_+3A_type">type</code></td>
<td>

<p>Type of information theoretical measure you want to use (AICc or AIC are allowed), defaults to AICc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model selection table with rownames corresponding to input model names and columns for K (number of parameters), logLik (log-likelihood), AICc (or AIC), deltaAICc (or deltaAIC, the difference between each model and the best model), Weight (Akaike weights, aka model probabilities), and Evidence ratio (the amount of evidence for the best model relative to each model such that, for instance, 4 would mean that model has 4x less evidence supporting it than the best model).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Two models initially run in corHMM using rayDISC (see help file for that package to fit
# these models) and saved as objects named 'rev' (for reversible) and 'non' (for non-reversible).

# Model selection table using AICc
modSel.rayDISC(non,rev)

# Model selection table using AIC
modSel.rayDISC(non,rev,type="AIC")
## End(Not run)
</code></pre>

<hr>
<h2 id='modSelTab'>
Model selection table based on information theoretical measures.
</h2><span id='topic+modSelTab'></span>

<h3>Description</h3>

<p>Creates a model selection table based on either AICc, AIC or BIC for a range of model types. The function is written for GLM style models (e.g. using glm, lm, aov, lmer, or glmer functions) but should work for any model to which the base R functions logLik(), model.frame() and AIC() or BIC() can be applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSelTab(...,type="AICc")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSelTab_+3A_...">...</code></td>
<td>

<p>A set of fitted models you want to compare.
</p>
</td></tr>
<tr><td><code id="modSelTab_+3A_type">type</code></td>
<td>

<p>Type of information theoretical measure you want to use (AICc, AIC and BIC are allowed), defaults to AICc.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model selection table with rownames corresponding to input model names and columns for K (number of parameters), logLik (log-likelihood), AICc (or AIC or BIC), deltaAICc (or deltaAIC or deltaBIC, the difference between each model and the best model), Weight (Akaike weights, aka model probabilities), and Evidence ratio (the amount of evidence for the best model relative to each model such that, for instance, 4 would mean that model has 4x less evidence supporting it than the best model).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulating some variables
y&lt;-rnorm(mean=100,sd=30,500)
x1&lt;-0.5*y+10+rnorm(mean=20,sd=10,500)
x2&lt;-3*y-45+rnorm(mean=40,sd=150,500)

# Fitting GLMs to those variables to give three models for comparison
m1&lt;-glm(y~x1)
m2&lt;-glm(y~x2)
m3&lt;-glm(y~x1+x2)

# Model selection table using AICc
modSelTab(m1,m2,m3)

# Model selection table using AIC
modSelTab(m1,m2,m3,type="AIC")

# Model selection table using BIC
modSelTab(m1,m2,m3,type="BIC")
</code></pre>

<hr>
<h2 id='nodeDist'>
Plotting and/or retrieving distribution of divergence times of a pair of species from a set of phylogenetic trees.
</h2><span id='topic+nodeDist'></span>

<h3>Description</h3>

<p>Plots and/or retrieves the distribution of age estimates of the most recent common ancestor of a specified pair of species across trees (for instance a posterior distribution).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeDist(trees,sp1,sp2,relTime=F,fillcol="blue",xlabel="Age (mya)",main="",
return.ages=F,plot=T,add=F,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeDist_+3A_trees">trees</code></td>
<td>

<p>An object of class multiPhylo containing a set of time-calibrated trees.
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_sp1">sp1</code></td>
<td>

<p>Name of one of the two species for which the divergence time is of interest.
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_sp2">sp2</code></td>
<td>

<p>Name of the other of the two species for which the divergence time is of interest.
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_reltime">relTime</code></td>
<td>

<p>Logical whether to plot relative (to age of root) divergence times or absolute times (defaults to absolute times).
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_fillcol">fillcol</code></td>
<td>

<p>Colour to plot distribution.
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_xlabel">xlabel</code></td>
<td>

<p>Label for the x-axis.
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_main">main</code></td>
<td>

<p>Title for plot (if desired, defaults to no title).
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_return.ages">return.ages</code></td>
<td>

<p>Logical whether to return a vector of the relative (to age of root) divergence times or absolute times (defaults to FALSE, i.e. only plotting the distribution).
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_plot">plot</code></td>
<td>

<p>Logical whether to plot distribution of divergence times, either absolute or relative as controlled by relTime argument (defaults to TRUE).
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_add">add</code></td>
<td>

<p>Logical whether to overlay distribution on an existing plot (make sure xlim and ylim on original call are set to accomodate both distributions).
</p>
</td></tr>
<tr><td><code id="nodeDist_+3A_...">...</code></td>
<td>

<p>Additional arguments to customise output, passed to plot.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density plot of the distribution of relative or absolute divergence times across trees for the specified pair of species, and/or a vector of those divergence times.
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Density plot of absolute divergence times
nodeDist(trees,"Naja_haje","Naja_nivea")

# Density plot of relative divergence times (root age for each tree set to 1)
nodeDist(trees,"Naja_haje","Naja_nivea",relTime=T,xlabel="Relative time")
## End(Not run)
</code></pre>

<hr>
<h2 id='pir'>
Calculates phylogenetic imbalance ratio (PIR)
</h2><span id='topic+pir'></span>

<h3>Description</h3>

<p>Calculates the PIR to assess suitability of categorical traits for modelling approaches, following Gardner and Organ (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pir(tree,trait1,trait2=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pir_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo'.
</p>
</td></tr>
<tr><td><code id="pir_+3A_trait1">trait1</code></td>
<td>

<p>Named vector containing states of a categorical trait. Must be a character or a factor and names must match tip labels of the tree.
</p>
</td></tr>
<tr><td><code id="pir_+3A_trait2">trait2</code></td>
<td>

<p>An optional second trait when the intention is to test suitability of modelling a correlation between two categorical traits. Argument requirements are the same as trait1.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>CI</code></td>
<td>
<p>Consistency index</p>
</td></tr>
<tr><td><code>NIR</code></td>
<td>
<p>Normalised imbalance ratio (a measure of class imbalance across states or, if there are two traits, state combinations)</p>
</td></tr>
<tr><td><code>PIR</code></td>
<td>
<p>Phylogenetic imbalance ratio</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function implements the phylogenetic imbalance ratio recommended in concert with its component parts (consistency index and normalised imbalance ratio) by Gardner and Organ (2021) to assess the suitability of categorical trait data for modelling in phylogenetic comparative methods. Each of these three indices ranges from 0 to 1. Low values of CI indicate high levels of homoplasy, which is linked to higher evolutionary sample sizes, whereas low values of NIR indicate a balanced distribution of traits (similar proportion of species in each state) and this often enables better and more data-driven parameter estimation from models. PIR is the product of CI and NIR, with lower values again preferred for phylogenetic comparative models. Gardner and Organ (2021) recommended a rule of thumb of PIR&lt;0.1 as indicative that the categorical trait data are suitable for model-based analysis, but see that paper for more detailed discussion.
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>References</h3>

<p>Gardner, J.D. and Organ, C.L. 2021. Evolutionary sample size and consilience in phylogenetic comparative analysis. Systematic Biology 70:1061 - 1075.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.tree)

# Single trait (perhaps intended for estimating transition rates)
t1&lt;-sample(c("brown","blue","green"),length(sample.tree$tip.label),replace=TRUE)
names(t1)&lt;-sample.tree$tip.label
pir(sample.tree,trait1=t1)

# Two traits (perhaps intended for testing correlations)
t2&lt;-sample(c("0","1"),length(sample.tree$tip.label),replace=TRUE)
names(t2)&lt;-sample.tree$tip.label
pir(sample.tree,trait1=t1,trait2=t2)
</code></pre>

<hr>
<h2 id='plotTrait'>
Provides a visualisation of up to three-dimensional trait space (not accounting for phylogeny) for data exploration
</h2><span id='topic+plotTrait'></span>

<h3>Description</h3>

<p>Plots the trait space occupied by up to 3 traits with focals highlighted in red.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTrait(dat, traits, focal = dat[, 2], ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTrait_+3A_dat">dat</code></td>
<td>

<p>A dataframe containing a column of 0s and 1s to denote non-focal and focal taxa respectively, and columns of trait data which you which to plot.
</p>
</td></tr>
<tr><td><code id="plotTrait_+3A_traits">traits</code></td>
<td>

<p>Column numbers (or names) for 1-3 traits which you want to plot.
</p>
</td></tr>
<tr><td><code id="plotTrait_+3A_focal">focal</code></td>
<td>

<p>Column in the dataframe containing the focal designations.
</p>
</td></tr>
<tr><td><code id="plotTrait_+3A_...">...</code></td>
<td>

<p>Arguments to be passed to plot (or scatterplot3d for 3 traits) to customise output.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle and Amanda Minter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.data)
plotTrait(sample.data,c("ou1","ou2"),focal=sample.data[,2])
</code></pre>

<hr>
<h2 id='prune2data'>
Prunes a phylogenetic tree to match a vector (e.g. of species names in a dataset)
</h2><span id='topic+prune2data'></span>

<h3>Description</h3>

<p>Takes a phylo object and vector of names to be matched to tip labels and returns a pruned phylogeny containing only tip labels that match those in the vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prune2data(tree, species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prune2data_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo'.
</p>
</td></tr>
<tr><td><code id="prune2data_+3A_species">species</code></td>
<td>

<p>Vector of names to be matched against tip labels of the tree.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a phylogenetic tree of the class 'phylo' containing only tips whose labels match the input vector (species)
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.data)
data(sample.tree)
tree&lt;-prune2data(sample.tree,sample.data$species[1:10])
plot(tree)
</code></pre>

<hr>
<h2 id='richYuleInputs'>
Generates the inputs necessary to run richness.yule.test() in ape
</h2><span id='topic+richYuleInputs'></span>

<h3>Description</h3>

<p>The function richness.yule.test() in the package ape requires two inputs - a dataframe with species richness of pairs of sister lineages which differ in the presence of a binary trait of interest, and a vector of divergence times of each of those sister group pairs. The richYuleInputs function generates these in a format which can be entered as the two required arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>richYuleInputs(tree, x, rich=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="richYuleInputs_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo' with branch lengths in units of time.
</p>
</td></tr>
<tr><td><code id="richYuleInputs_+3A_x">x</code></td>
<td>

<p>Named vector representing the binary trait (labelled as 0 and 1 for absence and presence respectively).
</p>
</td></tr>
<tr><td><code id="richYuleInputs_+3A_rich">rich</code></td>
<td>

<p>Optional named vector of species richness for each tip (for instance to account for incomplete sampling or when tips represent more than one species).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>sisRich</code></td>
<td>
<p>Dataframe containing two columns (species richness in sister lineages with and without the trait of interest) and rows representing different sister pairs</p>
</td></tr>
<tr><td><code>divTimes</code></td>
<td>
<p>Vector of divergence times of sister pairs (corresponding to rows of sisRich) differing in possession of a trait.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>See Also</h3>

<p><code><a href="ape.html#topic+richness.yule.test">richness.yule.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.data)
data(sample.tree)
trait&lt;-sample.data$focals
names(trait)&lt;-sample.data$species

ryi&lt;-richYuleInputs(sample.tree,trait)
richness.yule.test(ryi$sisRich,ryi$divTimes)
</code></pre>

<hr>
<h2 id='sample.data'>
Sample data for windex
</h2><span id='topic+sample.data'></span>

<h3>Description</h3>

<p>Simulated data in a format suitable for use with the Wheatsheaf index functions in the windex package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sample.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following 9 variables.
</p>

<dl>
<dt><code>species</code></dt><dd><p>a factor</p>
</dd>
<dt><code>focals</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>bm1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>bm2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>bm3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ou1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ou2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ou3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>bin</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The three 'bm' columns are values for three trait that have not evolved convergently. The three 'ou' columns are values for three traits that have evolved convergently with respect to the focal designation. bin is a column that was only for utility when creating the dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat&lt;-data(sample.data)
summary(dat)
</code></pre>

<hr>
<h2 id='sample.tree'>
Phylogenetic tree to accompany sample.data
</h2><span id='topic+sample.tree'></span>

<h3>Description</h3>

<p>A simulated phylogeny from which the sample.data dataset was simulated, for use with the Wheatsheaf index functions in the windex package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sample.tree)</code></pre>


<h3>Format</h3>

<p>Phylogenetic tree of the class 'phylo' with 100 tips and (ultrametric) branch lengths.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.tree)
summary(sample.tree)
plot(sample.tree)
</code></pre>

<hr>
<h2 id='se'>
Calculates standard error
</h2><span id='topic+se'></span>

<h3>Description</h3>

<p>Calculates standard error of a numerical vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="se_+3A_x">x</code></td>
<td>

<p>Numerical vector.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the standard error of the values in the vector.
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>

<hr>
<h2 id='test.windex'>
Tests for particularly strong convergent evolution given topological constraints
</h2><span id='topic+test.windex'></span>

<h3>Description</h3>

<p>The P-value returned is for the null hypothesis that the calculated Wheatsheaf index is no higher than expected by chance given the topology of the phylogenetic tree. Note that this is not a test for convergence per se, but of whether the convergence is unexpectedly strong.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.windex(dat, tree, traits, focal = dat[, 2], SE = TRUE, reps,
plot = TRUE, fossil = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.windex_+3A_dat">dat</code></td>
<td>

<p>A dataframe containing a column of 0s and 1s to denote non-focal and focal taxa respectively, and columns of trait data which you which to plot. The first column must be named 'species' and contain species names that correspond to those in the phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo' containing branch lengths. The tree should also be ultrametric.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_traits">traits</code></td>
<td>

<p>Column numbers (or names) of the traits for which you want to calculate a Wheatsheaf index.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_focal">focal</code></td>
<td>

<p>Column in the dataframe containing the focal designations.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_se">SE</code></td>
<td>

<p>A logical specifying whether to standardise the traits by their standard error across species, default is <code>SE=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_reps">reps</code></td>
<td>

<p>Number of bootstrap replicates on which to base the P-value.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_plot">plot</code></td>
<td>

<p>A logical indicating whether to plot the bootstrap distribution. If TRUE, a histogram is plotted with the calculated Wheatsheaf index and its 95% confidence interval overlayed on the histogram as a solid and dashed lines (respectively).
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_fossil">fossil</code></td>
<td>

<p>A logical specifying whether the tree contains fossil tips (i.e. is not ultrametric), in which case a different phylogenetic distance penalty based on shared branch length rather than shared time before divergence will be used instead. Note that this alternative penalty for trees containing fossils hasn't yet been rigorously tested so use cautiously, but it seems to behave as expected.
</p>
</td></tr>
<tr><td><code id="test.windex_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to hist() to customise the histogram (when plot=TRUE).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>w</code></td>
<td>
<p>Calculated Wheatsheaf index</p>
</td></tr>
<tr><td><code>low95</code></td>
<td>
<p>Lower bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
<tr><td><code>up95</code></td>
<td>
<p>Upper bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>P-value from bootstrapping the tips of the phylogenetic tree</p>
</td></tr>
<tr><td><code>boot.dist</code></td>
<td>
<p>Bootstrap sample of Wheatsheaf index used to calculate P-value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle and Amanda Minter
</p>


<h3>References</h3>

<p>Arbuckle, K., Bennett, C.M. and Speed, M.P. 2014. A simple measure of the strength of convergent evolution. Methods in Ecology and Evolution 5:685 - 693.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+windex">windex</a></code>
<code><a href="#topic+windex.sim.test">windex.sim.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(sample.data)
data(sample.tree)
test.windex(sample.data,sample.tree,traits=c("bm1","bm2"),focal=sample.data[,2],
reps=1000,plot=TRUE,col="light grey")

## End(Not run)
</code></pre>

<hr>
<h2 id='treecheck'>
Checks a set of phylogenetic trees to confirm they are ultrametric and binary.
</h2><span id='topic+treecheck'></span>

<h3>Description</h3>

<p>Takes a set of phylogenetic trees as a multiPhylo object (or a single tree as a phylo object) and reports which (if any) are not binary or ultrametric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treecheck(trees)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treecheck_+3A_trees">trees</code></td>
<td>

<p>Set of phylogenetic trees of class 'multiPhylo' or 'phylo' containing branch lengths.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either confirms that all trees are binary and ultrametric or prints warnings stating which trees do not meet those criteria.
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>

<hr>
<h2 id='treedatacheck'>
Checks a set of phylogenetic trees to confirm they are ultrametric and binary and that tip labels match a list of names.
</h2><span id='topic+treedatacheck'></span>

<h3>Description</h3>

<p>Takes a set of phylogenetic trees as a multiPhylo object (or a single tree as a phylo object) and a vector (e.g. of species names) and reports which trees (if any) are not binary, not ultrametric, or have tip labels that don't match the vector of names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treedatacheck(trees,species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="treedatacheck_+3A_trees">trees</code></td>
<td>

<p>Set of phylogenetic trees of class 'multiPhylo' or 'phylo' containing branch lengths.
</p>
</td></tr>
<tr><td><code id="treedatacheck_+3A_species">species</code></td>
<td>

<p>Vector of names to be matched against tip labels of the tree(s).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either confirms that all trees are binary, ultrametric, and have tip labels matching the list of names, or prints warnings stating which trees do not meet those criteria (with troubleshooting options for mismatches between data and single trees).
</p>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>

<hr>
<h2 id='windex'>
Calculates Wheatsheaf index with 95% confidence intervals
</h2><span id='topic+windex'></span>

<h3>Description</h3>

<p>Takes a phylo object and trait data and returns the Wheatsheaf index for the traits on the tree along with 95% confidence intervals obtained from jackkniving.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>windex(dat, tree, traits, focal = dat[, 2], SE = TRUE, fossil=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="windex_+3A_dat">dat</code></td>
<td>

<p>A dataframe containing a column of 0s and 1s to denote non-focal and focal taxa respectively, and columns of trait data which you which to plot. The first column must be named 'species' and contain species names that correspond to those in the phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="windex_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo' containing branch lengths. The tree should also be ultrametric.
</p>
</td></tr>
<tr><td><code id="windex_+3A_traits">traits</code></td>
<td>

<p>Column numbers (or names) for the traits for which you want to calculate a Wheatsheaf index.
</p>
</td></tr>
<tr><td><code id="windex_+3A_focal">focal</code></td>
<td>

<p>Column in the dataframe containing the focal designations.
</p>
</td></tr>
<tr><td><code id="windex_+3A_se">SE</code></td>
<td>

<p>A logical specifying whether to standardise the traits by their standard error across species, default is <code>SE=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="windex_+3A_fossil">fossil</code></td>
<td>

<p>A logical specifying whether the tree contains fossil tips (i.e. is not ultrametric), in which case a different phylogenetic distance penalty based on shared branch length rather than shared time before divergence will be used instead. Note that this alternative penalty for trees containing fossils hasn't yet been rigorously tested so use cautiously, but it seems to behave as expected.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>w</code></td>
<td>
<p>Calculated Wheatsheaf index</p>
</td></tr>
<tr><td><code>low95</code></td>
<td>
<p>Lower bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
<tr><td><code>up95</code></td>
<td>
<p>Upper bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle and Amanda Minter
</p>


<h3>References</h3>

<p>Arbuckle, K., Bennett, C.M. and Speed, M.P. 2014. A simple measure of the strength of convergent evolution. Methods in Ecology and Evolution 5:685 - 693.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+test.windex">test.windex</a></code>
<code><a href="#topic+windex.sim.test">windex.sim.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample.data)
data(sample.tree)
windex(sample.data,sample.tree,traits=c("ou1","ou2"),focal=sample.data[,2],
SE=TRUE)

</code></pre>

<hr>
<h2 id='windex.sim.test'>
Tests for presence of convergent evolution (over and above that expected from Brownian motion)
</h2><span id='topic+windex.sim.test'></span>

<h3>Description</h3>

<p>The P-value returned is for the null hypothesis that the calculated Wheatsheaf index is no higher than expected for traits evolving under Brownian motion (parameterised with rates of evolution and trait covariances estimated from the original traits).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>windex.sim.test(dat, tree, traits, focal = dat[, 2], SE = TRUE, Nsims,
plot = TRUE, fossil = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="windex.sim.test_+3A_dat">dat</code></td>
<td>

<p>A dataframe containing a column of 0s and 1s to denote non-focal and focal taxa respectively, and columns of trait data which you which to plot. The first column must be named 'species' and contain species names that correspond to those in the phylogenetic tree.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_tree">tree</code></td>
<td>

<p>Phylogenetic tree of class 'phylo' containing branch lengths. The tree should also be ultrametric.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_traits">traits</code></td>
<td>

<p>Column numbers (or names) for the traits for which you want to calculate a Wheatsheaf index.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_focal">focal</code></td>
<td>

<p>Column in the dataframe containing the focal designations.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_se">SE</code></td>
<td>

<p>A logical specifying whether to standardise the traits by their standard error across species, default is <code>SE=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_nsims">Nsims</code></td>
<td>

<p>Number of simulations on which to base the P-value.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_plot">plot</code></td>
<td>

<p>A logical indicating whether to plot the simulated distribution. If TRUE, a histogram is plotted with the calculated Wheatsheaf index and its 95% confidence interval overlayed on the histogram as a solid and dashed lines (respectively).
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_fossil">fossil</code></td>
<td>

<p>A logical specifying whether the tree contains fossil tips (i.e. is not ultrametric), in which case a different phylogenetic distance penalty based on shared branch length rather than shared time before divergence will be used instead. Note that this alternative penalty for trees containing fossils hasn't yet been rigorously tested so use cautiously, but it seems to behave as expected.
</p>
</td></tr>
<tr><td><code id="windex.sim.test_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to hist() to customise the histogram (when plot=TRUE).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>w</code></td>
<td>
<p>Calculated Wheatsheaf index</p>
</td></tr>
<tr><td><code>low95</code></td>
<td>
<p>Lower bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
<tr><td><code>up95</code></td>
<td>
<p>Upper bound of 95% confidence interval for the Wheatsheaf index obtained by jackkniving</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>P-value obtained from comparing observed Wheatsheaf index to simulations under Brownian motion on the phylogenetic tree</p>
</td></tr>
<tr><td><code>sim.dist</code></td>
<td>
<p>Wheatsheaf indices of simulated datasets used to calculate P-value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kevin Arbuckle
</p>


<h3>References</h3>

<p>Arbuckle, K., Bennett, C.M. and Speed, M.P. 2014. A simple measure of the strength of convergent evolution. Methods in Ecology and Evolution 5:685 - 693.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+windex">windex</a></code>
<code><a href="#topic+test.windex">test.windex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(sample.data)
data(sample.tree)
windex.sim.test(sample.data,sample.tree,traits=c("bm1","bm2"),focal=sample.data[,2],Nsims=1000,
plot=TRUE,col="light grey")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
