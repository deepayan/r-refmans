<!DOCTYPE html><html lang="en"><head><title>Help for package hbim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hbim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hbim-package'><p>Hill/Bliss Independence Model for Multicomponent Vaccines</p></a></li>
<li><a href='#calc.foldrange'><p>Calculate stadard error and fold-range from confidence interval</p></a></li>
<li><a href='#deff.sigma'><p>HBIM data</p></a></li>
<li><a href='#eff.mu'><p>Create data sets for plots</p></a></li>
<li><a href='#equiv.ab'><p>Equivalent antibody calculations by Linear Interpolation</p></a></li>
<li><a href='#equiv.increase'><p>Calculate equivalent increase from two dose-response curves</p></a></li>
<li><a href='#hbim-internal'><p>Internal functions not be to called directly</p></a></li>
<li><a href='#hbrr'><p>Calculate expected relative risk or percent protected from Hill model with Bliss Independence</p></a></li>
<li><a href='#irdata'><p>Immune Response data</p></a></li>
<li><a href='#make.v'><p>Make Exchangeable Variance Matrix</p></a></li>
<li><a href='#plotlogm.resp'><p>Plot Hill/Bliss Independence Model Data.</p></a></li>
<li><a href='#refs'><p>Reference list</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Hill/Bliss Independence Model for Combination Vaccines</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael P. Fay</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael P. Fay &lt;mfay@niaid.nih.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.5.0), stats, mvtnorm</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate expected relative risk and proportion protected assuming normally distributed log10 transformed antibody dose for a several component vaccine. Uses Hill models for each component which are combined under Bliss independence. See Saul and Fay, 2007 &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0000850">doi:10.1371/journal.pone.0000850</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 14:15:10 UTC; faym</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 14:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='hbim-package'>Hill/Bliss Independence Model for Multicomponent Vaccines</h2><span id='topic+hbim-package'></span><span id='topic+hbim'></span>

<h3>Description</h3>

<p>Calculate expected relative risk and proportion protected assuming normally distributed log10 transformed antibody dose for several component vaccine. Uses Hill models for each component which are combined under Bliss independence.  (see Saul and Fay (2007) &lt;doi:10.1371/jounal.pone.0000850&gt;).
</p>


<h3>Details</h3>

<p>The hbim package allows users to reproduce plots and calculations for Saul and Fay (2007). See <code>vignette("hbimdetails")</code>.
</p>


<h3>Author(s)</h3>

<p>M.P. Fay, 
Maintainer: Michael Fay &lt;mfay@niaid.nih.gov&gt;
</p>


<h3>References</h3>

<p>Saul A, Fay MP (2007).  Human Immunity and the Design of Multi-Component, Single Target Vaccines. PLoS ONE 2(9): e850. doi:10.1371/jounal.pone.0000850
</p>

<hr>
<h2 id='calc.foldrange'>Calculate stadard error and fold-range from confidence interval</h2><span id='topic+calc.foldrange'></span>

<h3>Description</h3>

<p>Given a confidence interval and sample size, we find the standard error assuming confidence limits 
are calculated on the log10 responses by either normal confidence limits or t-distribution confidence limits. 
The fold-range is also output by either methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.foldrange(n, lower, upper, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.foldrange_+3A_n">n</code></td>
<td>
<p>vector of sample size(s) used to create confidence intervals</p>
</td></tr>
<tr><td><code id="calc.foldrange_+3A_lower">lower</code></td>
<td>
<p>vector of lower confidence limits</p>
</td></tr>
<tr><td><code id="calc.foldrange_+3A_upper">upper</code></td>
<td>
<p>vector of upper confidence limits</p>
</td></tr>
<tr><td><code id="calc.foldrange_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level, default=.95</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>vignette("hbimdetails")</code></p>


<h3>Value</h3>

<p>A vector (or matrix) with elements (or columns)
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>lower confidence limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>upper confidence limit</p>
</td></tr>
<tr><td><code>s.byt</code></td>
<td>
<p>standard deviation assuming confidence intervals calculated by t-distribution</p>
</td></tr>
<tr><td><code>s.byz</code></td>
<td>
<p>standard deviation assuming confidence intervals calculated by normal distribution</p>
</td></tr>
<tr><td><code>foldrange.byt</code></td>
<td>
<p>fold-range assuming confidence intervals calculated by t-distribution</p>
</td></tr>
<tr><td><code>foldrange.byz</code></td>
<td>
<p>fold-range assuming confidence intervals calculated by normal distribution</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## sample size=43, lower cl=65, upper cl=85
calc.foldrange(43,65,85) </code></pre>

<hr>
<h2 id='deff.sigma'>HBIM data</h2><span id='topic+deff.sigma'></span><span id='topic+deff.mu'></span><span id='topic+deff.rho'></span><span id='topic+dpp.mu'></span><span id='topic+dpp.sigma'></span><span id='topic+dpp.rho'></span>

<h3>Description</h3>

<p>These 6 data sets were calculated using the associated function. For example, <code>deff.sigma</code> was calculated with 
<code><a href="#topic+eff.sigma">eff.sigma</a></code>. The 3 data sets that begin with deff, give the expected efficacy for several values of mu. 
The 3 data sets that begin with dpp give the percent protected with several values of mu. The data sets that end in .sigma change 
for different values of sigma, and similarly for .mu and .rho (see <code><a href="#topic+deff.sigma">deff.sigma</a></code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(deff.sigma)
data(deff.mu)
data(deff.rho)
data(dpp.sigma)
data(dpp.mu)
data(dpp.rho)
</code></pre>


<h3>Format</h3>

<p>The format is:
List of 8
</p>

<ul>
<li><p>mu vector of different values of mean for log10 antibody
</p>
</li>
<li><p>out1matrix of either expected efficacy or percent protected for 1 component model, rows corespond to mu, cols correspond to cparms
</p>
</li>
<li><p>out2matrix of either expected efficacy or percent protected for 2 component model, rows corespond to mu, cols correspond to cparms
</p>
</li>
<li><p>out3matrix of either expected efficacy or percent protected for 3 component model, rows corespond to mu, cols correspond to cparms
</p>
</li>
<li><p>col1vector of colors for different cparms of 1 component model
</p>
</li>
<li><p>col2vector of colors for different cparms of 2 component model
</p>
</li>
<li><p>col3vector of colors for different cparms of 3 component model
</p>
</li>
<li><p>cparmsvector parameters that change
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## here is the code that produces the 6 data sets, it takes about 25 hours to run
## so it is commented out here
#NSIM&lt;-5*10^5
#SIGMAS.POWER&lt;-c(9,65,5000)
#SIGMAS&lt;-log10(SIGMAS.POWER)/(2*qnorm(.975))
#SCOLORS&lt;-c("green","blue","red")
#FACTORS&lt;-c(1/10, 1/3, 1/2, 1)
#FCOLORS&lt;-c("red", "green", "blue", "black")
#RHOS&lt;-c(-.5,-.25,0, 0.25, 0.5, 0.75, 1)
#RCOLORS&lt;- c("black","tan","yellow","blue", "green", "red", "black")
#set.seed(1234521)
#MU&lt;-((-40:40)/10)
#deff.sigma&lt;-eff.sigma(mu=MU, sigmas=SIGMAS, COLORS = SCOLORS, rho = 0)
#deff.mu&lt;-eff.mu(mu=MU, factor = FACTORS, COLORS = FCOLORS, sigma = SIGMAS[2], rho = 0)
#deff.rho&lt;-eff.rho(mu=MU, sigma = SIGMAS[2], rho = RHOS, COLORS =RCOLORS,simulate=TRUE,nsim=NSIM)
#set.seed(32401)
#dpp.sigma&lt;-pp.sigma(MU,sigmas=SIGMAS,COLORS = SCOLORS, rho = 0,nsim=NSIM)
#set.seed(21345123)
#dpp.mu&lt;-pp.mu(MU,factor = FACTORS, COLORS = FCOLORS, sigma = SIGMAS[2], rho = 0, nsim=NSIM)
#set.seed(435919)
#dpp.rho&lt;-pp.rho(MU,sigma = SIGMAS[2], rho = RHOS, COLORS =RCOLORS,nsim=NSIM)
</code></pre>

<hr>
<h2 id='eff.mu'>Create data sets for plots</h2><span id='topic+eff.mu'></span><span id='topic+eff.sigma'></span><span id='topic+eff.rho'></span><span id='topic+pp.sigma'></span><span id='topic+pp.mu'></span><span id='topic+pp.rho'></span>

<h3>Description</h3>

<p>These functions create the data sets used in the plots. The first part of the name denotes the 
output created. Thus, <code>eff.sigma</code>, <code>eff.mu</code>, <code>eff.rho</code> create efficacy values, while 
<code>pp.sigma</code>, <code>pp.mu</code>, <code>pp.rho</code>  create percent protected values. The second part of the 
name is the parameter which is changed. For example, <code>eff.sigma</code> creates efficacy values for different 
values of sigma. See details for a more complete  description. Default for eff. functions is integration, default
for pp. functions is simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eff.sigma(mu, sigmas, COLORS = c("red", "green", "blue"), 
    rho = 0, ...)
eff.mu(mu, factor = c(1/10, 1/3, 1/2, 1), 
    COLORS = c("red", "green", "blue", "black"), 
    sigma = 0.553, rho = 0, ...)
eff.rho(mu, sigma = 0.553, rho = c(0, 0.25, 0.5, 0.75, 1),
    COLORS = c("black", "blue", "green", "red", "black"), ...)
pp.sigma(mu, sigmas, COLORS = c("red", "green", "blue"), 
    rho = 0, nsim = 10^5)
pp.mu(mu, factor = c(1/10,1/3,1/2,1), 
    COLORS = c("red", "green", "blue", "black"), 
    sigma =0.553, rho = 0, nsim = 10^5)
pp.rho(mu, sigma = 0.553, rho = c(0, 0.25, 0.5, 0.75, 1), 
    COLORS = c("black", "blue", "green", "red", "black"), 
    nsim = 10^5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eff.mu_+3A_mu">mu</code></td>
<td>
<p>a vector of values of the mean of the log10 antibody</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_factor">factor</code></td>
<td>
<p>a vector of values for defining the means of the second and third component (see details and warnings)</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_colors">COLORS</code></td>
<td>
<p>colors for the plots, the ith color corresponds to the ith value of the parameter which is changing</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_sigmas">sigmas</code></td>
<td>
<p>a vector of values of the standard deviation of the log10 antibody</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_sigma">sigma</code></td>
<td>
<p>a single value for sigma</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_rho">rho</code></td>
<td>
<p>correlation vector (of length one for .sigma and .mu functions) of the log10 antibody, negative values not allowed</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations for hbpp function</p>
</td></tr>
<tr><td><code id="eff.mu_+3A_...">...</code></td>
<td>
<p>additional parameters may be added to the <code><a href="#topic+hbrr">hbrr</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>eff.sigma</code> and <code>pp.sigma</code> we change sigma over the one, two, and three component model. 
For <code>eff.mu</code> and <code>pp.mu</code> we change the mean over the two and three component model. For <code>eff.mu</code>
and <code>pp.mu</code>
the factor parameter is associated with each level of the second and third component.
See <code>vignette("hbimdetails")</code> for details. 
For <code>eff.rho</code> and <code>pp.rho</code>  we change the correlation over the two and three component model; for the jth column of the 
out2 and out3 matrices, all correlations are given by jth level of factor. Because these calculations may take 
hours, we save the original calculations used in the paper as output data, 
<code><a href="#topic+deff.sigma">deff.sigma</a></code>,  
<code><a href="#topic+deff.mu">deff.mu</a></code>,  
<code><a href="#topic+deff.rho">deff.rho</a></code>, 
<code><a href="#topic+dpp.sigma">dpp.sigma</a></code>,  
<code><a href="#topic+dpp.mu">dpp.mu</a></code>, and  
<code><a href="#topic+dpp.rho">dpp.rho</a></code>. These output data set may be accessed by the command data(). For example, to access 
<code><a href="#topic+deff.sigma">deff.sigma</a></code> type <code>data(deff.sigma)</code>. 
</p>


<h3>Value</h3>

<p>A list with items
</p>
<table role = "presentation">
<tr><td><code>out1</code></td>
<td>
<p>response matrix for one component model, ith row corresponds to mu[i] and jth column corresponds to the jth level of the parameter which is changing</p>
</td></tr>
<tr><td><code>col1</code></td>
<td>
<p>colors corresponding to columns of out1</p>
</td></tr>
<tr><td><code>out2</code></td>
<td>
<p>response matrix for two component model, ith row corresponds to mu[i] and jth column corresponds to the jth level of the parameter which is changing</p>
</td></tr>
<tr><td><code>col2</code></td>
<td>
<p>colors corresponding to columns of out2</p>
</td></tr>
<tr><td><code>out3</code></td>
<td>
<p>response matrix for three component model, ith row corresponds to mu[i] and jth column corresponds to the jth level of the parameter which is changing</p>
</td></tr>
<tr><td><code>col3</code></td>
<td>
<p>colors corresponding to columns of out3</p>
</td></tr>
<tr><td><code>cparms</code></td>
<td>
<p>input vector of parameter that changes, e.g., factor vector</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>input sigma</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>input rho</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Note to save computation time these functions do not check that all variance-covariance matrices used 
in the internal fucntions are positive definite. If you get an error message you do not understand check to see if the variance-covariance matrix is 
positive definite by checking the eigen values. For example, with sigma=1, rho=-.6, the 3 components model do not have a positive definite variance-covariance
matrix because there is a negative eigenvalue 
(to see this run <code>eigen(make.v(3,-.6,1)) </code>). 
</p>


<h3>Author(s)</h3>

<p>M.P. Fay</p>


<h3>See Also</h3>

 <p><code>vignette("hbimdetails")</code> </p>

<hr>
<h2 id='equiv.ab'>Equivalent antibody calculations by Linear Interpolation</h2><span id='topic+equiv.ab'></span>

<h3>Description</h3>

<p>This function inputs two antibody by response curves and outputs values needed for 
plots of equivalent antibody response.  
This is called by other functions (<code><a href="#topic+plotresp.equiv">plotresp.equiv</a></code>, <code><a href="#topic+plotresp.mix">plotresp.mix</a></code>). 
It is not to be called directly. For that purpose use <code><a href="#topic+equiv.increase">equiv.increase</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equiv.ab(effab1, ab1, effab2, ab2, npts = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="equiv.ab_+3A_effab1">effab1</code></td>
<td>
<p>vector of responses for antibody 1</p>
</td></tr>
<tr><td><code id="equiv.ab_+3A_ab1">ab1</code></td>
<td>
<p>vector of doses of antibody 1</p>
</td></tr>
<tr><td><code id="equiv.ab_+3A_effab2">effab2</code></td>
<td>
<p>vector of responses for antibody 2</p>
</td></tr>
<tr><td><code id="equiv.ab_+3A_ab2">ab2</code></td>
<td>
<p>vector of doses of antibody 2</p>
</td></tr>
<tr><td><code id="equiv.ab_+3A_npts">npts</code></td>
<td>
<p>number of points used in some output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the <code><a href="stats.html#topic+approx">approx</a></code> function to do linear interpolation and find the needed 
values. 
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>abpts</code></td>
<td>
<p>a vector of values of antibody dose</p>
</td></tr>
<tr><td><code>abpts10</code></td>
<td>
<p>antilog of abpts, i.e., abpts raised to tenth power</p>
</td></tr>
<tr><td><code>equiv.eff2</code></td>
<td>
<p>equivalent response of antibody 2</p>
</td></tr>
<tr><td><code>equiv.eff1</code></td>
<td>
<p>equivalent response of antibody 1</p>
</td></tr> 
<tr><td><code>equiv.ab1</code></td>
<td>
<p>vector of antibody doses that correspond with equiv.eff1</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>equiv.ab1-abpts</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>equiv.eff1</p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><code><a href="#topic+equiv.increase">equiv.increase</a></code> </p>

<hr>
<h2 id='equiv.increase'>Calculate equivalent increase from two dose-response curves</h2><span id='topic+equiv.increase'></span>

<h3>Description</h3>

<p>This function takes two curves defined by vectors of x and y values and 
calculates the equivalent increase in the x value at the response value for the 
first curve at e1. </p>


<h3>Usage</h3>

<pre><code class='language-R'>equiv.increase(x1, y1, x2, y2, e1, xlog = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="equiv.increase_+3A_x1">x1</code></td>
<td>
<p>x vector for first curve</p>
</td></tr>
<tr><td><code id="equiv.increase_+3A_y1">y1</code></td>
<td>
<p>y vector for first curve</p>
</td></tr>
<tr><td><code id="equiv.increase_+3A_x2">x2</code></td>
<td>
<p>x vector for second curve</p>
</td></tr>
<tr><td><code id="equiv.increase_+3A_y2">y2</code></td>
<td>
<p>y vector for second curve</p>
</td></tr>
<tr><td><code id="equiv.increase_+3A_e1">e1</code></td>
<td>
<p>vector of y responses of first curve for associating with output</p>
</td></tr>
<tr><td><code id="equiv.increase_+3A_xlog">xlog</code></td>
<td>
<p>TRUE if x values are log transformed, changes the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function repeatedly uses the <code><a href="stats.html#topic+approx">approx</a></code> function to do linear interpolation. 
</p>


<h3>Value</h3>

<p>A list with 5 components
</p>
<table role = "presentation">
<tr><td><code>a1</code></td>
<td>
<p>vector of x values associated with e1 from first curve</p>
</td></tr>
<tr><td><code>e2</code></td>
<td>
<p>vector of y values associated with a1 from the second curve</p>
</td></tr>
<tr><td><code>a2</code></td>
<td>
<p>vector of x values associated with e2 from the second curve</p>
</td></tr>
<tr><td><code>e1</code></td>
<td>
<p>input vector for e1</p>
</td></tr>
<tr><td><code>equiv.increase</code></td>
<td>
<p>vector of equivalent increases associated with e1</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(deff.sigma)
D&lt;-deff.sigma
equiv.increase(D$mu,D$out1[,2],D$mu,D$out2[,2],.5)
</code></pre>

<hr>
<h2 id='hbim-internal'>Internal functions not be to called directly</h2><span id='topic+hbrr.integrate1'></span><span id='topic+hbrr.integrate2'></span><span id='topic+hbrr.integrate2.rhoeq1'></span><span id='topic+hbrr.integrate3'></span><span id='topic+hbrr.integrate3.rhoeq1'></span><span id='topic+hbrr.simulate'></span><span id='topic+hbpp.integrate1'></span><span id='topic+hbpp.integrate2'></span><span id='topic+hbpp.integrate3'></span><span id='topic+hbpp.simulate'></span>

<h3>Description</h3>

<p> These are functions that are called by the <code><a href="#topic+hbrr">hbrr</a></code> and <code><a href="#topic+hbpp">hbpp</a></code> 
functions. They integrate 1, 2 or 3 component models or integrate by simulation. Special functions 
ending in .rhoeq1 are for when rho equals 1.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hbpp.integrate1(MU, V, A = 1, RP = 0.1, ...)
hbpp.integrate2(MU, V, A = c(1, 1), RP = 0.1, ...)
hbpp.integrate3(MU, V, A = c(1, 1, 1),RP=0.1, ...)
hbpp.simulate(MU, V, A, RP = 0.1, NSIM = 10^5)
hbrr.integrate1(MU, V, A = 1, ...)
hbrr.integrate2(MU, V, A = c(1, 1), ...)
hbrr.integrate2.rhoeq1(MU, V, A = c(1, 1), ...)
hbrr.integrate3(MU, V, A = c(1, 1, 1), ...)
hbrr.integrate3.rhoeq1(MU, V, A = c(1, 1, 1), ...)
hbrr.simulate(MU, V, A, NSIM = 10^4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hbim-internal_+3A_mu">MU</code></td>
<td>
<p>mean vector of the log10 dose</p>
</td></tr>
<tr><td><code id="hbim-internal_+3A_v">V</code></td>
<td>
<p>variance matrix of the log10 dose</p>
</td></tr>
<tr><td><code id="hbim-internal_+3A_a">A</code></td>
<td>
<p>vector of slope parameters in the Hill model, one for each component</p>
</td></tr>
<tr><td><code id="hbim-internal_+3A_nsim">NSIM</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="hbim-internal_+3A_rp">RP</code></td>
<td>
<p>protection bound, an individual is protected if relative risk is greater than RP</p>
</td></tr>
<tr><td><code id="hbim-internal_+3A_...">...</code></td>
<td>
<p>additional parameters to pass to the <code><a href="stats.html#topic+integrate">integrate</a></code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value of the expected relative risk or percent protected.</p>


<h3>Author(s)</h3>

<p>M.P. Fay</p>


<h3>References</h3>

<p> Saul A, Fay MP (2007).  Human Immunity and the Design of Multi-Component, Single Target Vaccines. PLoS ONE 2(9): e850. doi:10.1371/jounal.pone.0000850
</p>

<hr>
<h2 id='hbrr'>Calculate expected relative risk or percent protected from Hill model with Bliss Independence</h2><span id='topic+hbrr'></span><span id='topic+hbpp'></span>

<h3>Description</h3>

<p>Assuming that the log10 transformed doses are normally distributed, we calculate the 
expected relative risk (using <code>hbrr</code>) or percent protected (using <code>hbpp</code>) 
from the Hill model using Bliss Independence. Numeric integration 
is the default for up to three components for <code>hbrr</code>, while simulation is the default for 
two or three components for <code>hbpp</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>hbrr(mu, v, a = rep(1, length(mu)), simulate = FALSE, nsim = 10^4, ...)
hbpp(mu, v, a = rep(1, length(mu)), rp = 0.1, simulate = FALSE, nsim = 10^5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hbrr_+3A_mu">mu</code></td>
<td>
<p>mean vector of the log10 dose</p>
</td></tr>
<tr><td><code id="hbrr_+3A_v">v</code></td>
<td>
<p>variance matrix of the log10 dose</p>
</td></tr>
<tr><td><code id="hbrr_+3A_a">a</code></td>
<td>
<p>vector of slope parameters in the Hill model, one for each component</p>
</td></tr>
<tr><td><code id="hbrr_+3A_simulate">simulate</code></td>
<td>
<p>estimation by simulation (TRUE) or numeric integration (FALSE)</p>
</td></tr>
<tr><td><code id="hbrr_+3A_nsim">nsim</code></td>
<td>
<p>number of simulations, ignored if simulate=FALSE</p>
</td></tr>
<tr><td><code id="hbrr_+3A_rp">rp</code></td>
<td>
<p>protection bound, an individual is protected if relative risk is greater than rp</p>
</td></tr>
<tr><td><code id="hbrr_+3A_...">...</code></td>
<td>
<p>additional parameters to pass to the <code><a href="stats.html#topic+integrate">integrate</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although the package <code>adapt</code> can do multidimensional integration, we have written 
specific functions to do this for up to 3 dimensions. This allows faster and more accurate integration.
The integration is done by repeated calls to the <code>integrate</code> function. The functions which do the 
actual integration or simulation are internal functions which are not intended to be called by the user. 
These internal functions are: for <code>hbrr</code>, when 
simulate=FALSE, the function
calls one of either <code><a href="#topic+hbrr.integrate1">hbrr.integrate1</a></code>, <code><a href="#topic+hbrr.integrate2">hbrr.integrate2</a></code>, <code><a href="#topic+hbrr.integrate2.rhoeq1">hbrr.integrate2.rhoeq1</a></code>, <code><a href="#topic+hbrr.integrate3">hbrr.integrate3</a></code>,
or <code><a href="#topic+hbrr.integrate3.rhoeq1">hbrr.integrate3.rhoeq1</a></code>
(for 1,2, or 3 component, with or without rho=1, taken from the size of the mu vector and dimension of the v matrix) 
and when simulation=TRUE it calls <code><a href="#topic+hbrr.simulate">hbrr.simulate</a></code>. Similar functions exist for <code>hbpp</code>; however, 
the <code><a href="#topic+hbpp.integrate2">hbpp.integrate2</a></code> and  <code><a href="#topic+hbpp.integrate3">hbpp.integrate3</a></code> may have problems because of the discontinuity 
in the integration function. That is why for two or three component models <code><a href="#topic+hbpp.simulate">hbpp.simulate</a></code> is used by default. 
</p>


<h3>Value</h3>

<p>a numeric value of the expected relative risk or percent protected.
</p>


<h3>Author(s)</h3>

<p>M.P. Fay</p>


<h3>References</h3>

<p> Saul A, Fay MP (2007).  Human Immunity and the Design of Multi-Component, Single Target Vaccines. PLoS ONE 2(9): e850. doi:10.1371/jounal.pone.0000850
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## example of two dimensional integral
hbrr(c(.123,.432),matrix(c(1,.5,.5,1),2,2))
## faster but less accurate estimation by simulatin
hbrr(c(.123,.432),matrix(c(1,.5,.5,1),2,2),simulate=TRUE,nsim=10^4)

</code></pre>

<hr>
<h2 id='irdata'>Immune Response data</h2><span id='topic+irdata'></span>

<h3>Description</h3>

<p>Data from literature. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(irdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 574 observations on the following 16 variables.
</p>

<dl>
<dt><code>RecordNum</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Old.Reference</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Reference</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Vaccine.and.trial.group</code></dt><dd><p>a factor with levels <code>(Pentacel +Recombivax) then Prevnar</code> <code>11 valent Pneumonococcal-DT Finnland</code> <code>11 valent Pneumonococcal-DT Israel</code> <code>11 valent Pneumonococcal-DT+alum Finnland</code> <code>11 valent Pneumonococcal-DT+alum Israel</code> <code>11 valent Pneumonococcal-DT+alum Philippines</code> <code>ACTHIB</code> <code>AP-YF</code> <code>AVA IM</code> <code>AVA SQ</code> <code>BERNA-YF</code> <code>Boostrix</code> <code>Boostrix + Poliorix</code> <code>Boostrix Polio (dTpa-IPV)</code> <code>DPaT-HVB-IPV/HIB mix</code> <code>DPaT-HVB-IPV+HIB separate</code> <code>DPaT-IPV/HiB mix</code> <code>DPaT-IPV+HiB separately</code> <code>DPT  +Hib/HBV</code> <code>DPT +Hib + HBV</code> <code>DPTa</code> <code>DPTa/Pa</code> <code>DPTa5</code> <code>DT</code> <code>DTP-HB + Hib</code> <code>DTPa-HBV</code> <code>DTPa/IPV/PRP-TT +PncD/T11</code> <code>DTPa2</code> <code>DTPa3</code> <code>DTPa5</code> <code>DTPaHBV-IPV+Hib</code> <code>DTPaHBV-IPV+Hib, PRP</code> <code>DTPaHBV-IPV+Hib, PRP-TT</code> <code>DTPw-C</code> <code>DTPw-E</code> <code>DTPw/IPV/PRP-TT +PncD/T11 group 1</code> <code>DTPw/IPV/PRP-TT +PncD/T11 group 2</code> <code>DTPwHBV-Hib</code> <code>DTPwHBV + Hib(Separate)</code> <code>Engerix B</code> <code>GBS Ia-TT 15 ug</code> <code>GBS Ia-TT 3.75 ug</code> <code>GBS Ia 55 ug</code> <code>GBS IaTT 60 ug</code> <code>GBS Ib-TT 15.75 ug</code> <code>GBS Ib-TT 3.94 ug</code> <code>GBS Ib-TT 63 ug</code> <code>GBS Ib 53 ug</code> <code>GBS II-TT</code> <code>GBS II-TT 14.3 ug</code> <code>GBS II-TT 3.6 ug</code> <code>GBS II-TT 57 ug</code> <code>GBS II-TT/III-TT</code> <code>GBS III-TT</code> <code>GBS III-TT 14.5 ug</code> <code>GBS III-TT 3.6 ug</code> <code>GBS III-TT 58 ug</code> <code>GBS III 50 ug</code> <code>GBS V-CRM197</code> <code>GBS V-TT</code> <code>GBS V-TT 2.4/1.1 ug</code> <code>GBS V-TT 38.5/17 ug</code> <code>GBS V-TT 9.6/4.3 ug</code> <code>H5N1Influenza  45ug</code> <code>H5N1Influenza  7.5ug</code> <code>H5N1Influenza  90ug</code> <code>H5N1Influenza 15ug</code> <code>H5N1Influenza Placebo</code> <code>Havrix+Engerix B</code> <code>HBV/Pentavax</code> <code>Heptavalent Pneumonococcal-CMR197</code> <code>Heptavalent Pneumonococcal-OMPC</code> <code>Heptvalent Pneumonococcal-CMR197</code> <code>Hiberix</code> <code>HibTITER</code> <code>HibTITER (PRP-CRM197)</code> <code>Infantrix-IVP+Hib</code> <code>Infantrix-IVP+Hib+Previnar</code> <code>Infantrix + Engerix separate</code> <code>Infantrix/Engerix Mixed</code> <code>Infantrix/Engrerix Mixed</code> <code>IPV-mkc</code> <code>IPV-vero</code> <code>Lyme OspA 15ug</code> <code>Lyme OspA 30ug</code> <code>LYMErix (OpsA)</code> <code>MCV4-DT</code> <code>Menactra Meningococcal PS-DT (MCV-4)</code> <code>Mencevax ACWY</code> <code>Meningitec (Menc-CRM197)</code> <code>Menomune Meningococcal PS </code> <code>Menomune Meningococcal PS (PSV-4)</code> <code>Octavalent Pneumonococcal-DT</code> <code>Octavalent Pneumonococcal-TT</code> <code>Oka/Merck varicella 16K PFU +M-M-R</code> <code>Oka/Merck varicella 50K PFU +M-M-R</code> <code>OpsA Lyme Disease</code> <code>Orimmune</code> <code>OspA Lyme</code> <code>Pentacel + Prevnar +Recombivax</code> <code>Pentavax</code> <code>Revaxis (Td-IPV)</code> <code>RKI-YF</code> <code>RSV PFP3</code> <code>Tripedia</code> <code>Tripedia-Orimune-HibTITER</code> <code>Twinrix</code> <code>Twinrix adult</code> <code>Twinrix pediatric</code> <code>Typhoid/HAV</code> <code>Varilrix + M-M-R</code></p>
</dd>
<dt><code>Carrier.for.conjugate.vaccines</code></dt><dd><p>a factor with levels  <code>CRM197</code> <code>Diphtheria toxoid</code> <code>OMPC</code> <code>Tetanus protein</code> <code>Tetanus toxoid</code></p>
</dd>
<dt><code>Age.in.yrs.at.first.vaccination</code></dt><dd><p>a factor with levels <code>0.12</code> <code>0.17</code> <code>0.17-0.5</code> <code>0.25</code> <code>0.5</code> <code>1</code> <code>1-12</code> <code>1 -2</code> <code>1.5</code> <code>11-18</code> <code>12-15</code> <code>15-18</code> <code>15-70</code> <code>16-65</code> <code>17-72</code> <code>18-32</code> <code>18-39</code> <code>18-40</code> <code>18-45</code> <code>18-50</code> <code>18-60</code> <code>18-64</code> <code>19-52</code> <code>19-56</code> <code>19-57</code> <code>19-64</code> <code>19-70</code> <code>19-83</code> <code>2</code> <code>2-5</code> <code>20-45</code> <code>20-60</code> <code>20-61</code> <code>21-60</code> <code>3</code> <code>4</code> <code>4-14</code> <code>40-70</code> <code>5-16</code> <code>65-83</code></p>
</dd>
<dt><code>Dose.schedule.in.weeks</code></dt><dd><p>a factor with levels <code>0</code> <code>0, 2</code> <code>0, 2, 4</code> <code>0, 26</code> <code>0, 26/0, 4, 26</code> <code>0, 4</code> <code>0, 4, 10</code> <code>0, 4, 26</code> <code>0, 4, 52</code> <code>0, 4, 8</code> <code>0, 4, 8, 52</code> <code>0, 52</code> <code>0, 52, 104</code> <code>0, 6, 13</code> <code>0, 8</code> <code>0, 8, 16</code> <code>0, 8, 18</code> <code>0, 8, 18 </code> <code>0, 8, 18, 220</code> <code>0, 8, 18, 270</code> <code>0, 8, 18, 320</code> <code>0, 8, 18, 44</code> <code>0, 8, 18, 56</code> <code>0, 8, 18, 60</code> <code>0, 8, 18, 70</code> <code>0, 8, 18; 4,12,22</code> <code>0, 8, 18; 4,12,22 </code> <code>0, 8, 39</code> <code>0, 9, 37</code></p>
</dd>
<dt><code>Num.Immunizations</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Endpoint.in.weeks.after.first.vaccine</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Antigen</code></dt><dd><p>a factor with levels <code>1</code> <code>14</code> <code>18C</code> <code>19F</code> <code>23F</code> <code>3</code> <code>4</code> <code>5</code> <code>6B</code> <code>7F</code> <code>9V</code> <code>A</code> <code>AVA</code> <code>C</code> <code>DT</code> <code>F protein</code> <code>FHA</code> <code>FIM</code> <code>HAV</code> <code>HBs</code> <code>Hemagglutinin</code> <code>Ia-CPS</code> <code>Ib-CPS</code> <code>II-CPS</code> <code>III-CPS</code> <code>Measles</code> <code>MenC</code> <code>Mumps</code> <code>OspA</code> <code>Polio-1</code> <code>Polio-2</code> <code>Polio-3</code> <code>PRN</code> <code>PRP</code> <code>PRP*</code> <code>PT</code> <code>Rubella</code> <code>TT</code> <code>V-CPS</code> <code>Varicella</code> <code>Vi</code> <code>W135</code> <code>Y</code> <code>YF</code></p>
</dd>
<dt><code>Units</code></dt><dd><p>a factor with levels  <code>EL.U/mL</code> <code>EU</code> <code>HI</code> <code>IU</code> <code>mIU</code> <code>ng</code> <code>SBA</code> <code>ug</code></p>
</dd>
<dt><code>GMT</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>GMT.95.pct.interval.low.limit</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>GMT.95.pct.interval.high.limit</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>n</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Fold.Range</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p> See <code>data(refs)</code> for references</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(irdata)
irdata[1,]
</code></pre>

<hr>
<h2 id='make.v'>Make Exchangeable Variance Matrix</h2><span id='topic+make.v'></span>

<h3>Description</h3>

<p>Not to be called directly. Used by <code><a href="#topic+eff.sigma">eff.sigma</a></code>,
<code><a href="#topic+eff.mu">eff.mu</a></code>,
<code><a href="#topic+eff.rho">eff.rho</a></code>,
<code><a href="#topic+pp.sigma">pp.sigma</a></code>,
<code><a href="#topic+pp.mu">pp.mu</a></code>, and 
<code><a href="#topic+pp.rho">pp.rho</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.v(n, r, sig2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.v_+3A_n">n</code></td>
<td>
<p>dimension of variance matrix</p>
</td></tr>
<tr><td><code id="make.v_+3A_r">r</code></td>
<td>
<p>correlation</p>
</td></tr>
<tr><td><code id="make.v_+3A_sig2">sig2</code></td>
<td>
<p>variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An variance-covariance matrix, with all diagonal elements equal and all off diagonal elements equal.
</p>

<hr>
<h2 id='plotlogm.resp'>Plot Hill/Bliss Independence Model Data.</h2><span id='topic+plotlogm.resp'></span><span id='topic+plotresp.equiv'></span><span id='topic+plotresp.mix'></span>

<h3>Description</h3>

<p>These functions take data output calculated from the data generating functions (see details)
and plot either: the mean of the log transformed antibody doses by the response (<code>plotlogm.resp</code>),
equivalent increase in antibody plots (<code>plotresp.equiv</code>), or  response 
of one component versus a mixture (for details see <code>vignette("hbimdetails")</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotlogm.resp(D, YLAB = "Efficacy", YLIM = c(0, 1), 
    XLIM = c(-2, 2),TITLE="")
plotresp.equiv(D, XLIM = c(0, 1), YLIM = c(1, 100), 
    RLAB = "Efficacy of", bounds= XLIM,TITLE="")
plotresp.mix(D, RLAB = "Efficacy of", XYLIM = c(0, 1),TITLE="")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotlogm.resp_+3A_d">D</code></td>
<td>
<p>data, see details</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_ylab">YLAB</code></td>
<td>
<p>y label</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_ylim">YLIM</code></td>
<td>
<p>range of y axis</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_xlim">XLIM</code></td>
<td>
<p>range of x axis</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_rlab">RLAB</code></td>
<td>
<p>response label, currently use only either &quot;Efficacy of&quot; or &quot;% Protected by&quot;</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_bounds">bounds</code></td>
<td>
<p>bounds on response of second antibody curve, see <code>vignette("hbimdetails")</code> </p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_xylim">XYLIM</code></td>
<td>
<p>range of both x and y axes</p>
</td></tr>
<tr><td><code id="plotlogm.resp_+3A_title">TITLE</code></td>
<td>
<p>title of plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following functions create data sets for plotting: 
<code><a href="#topic+eff.sigma">eff.sigma</a></code>,
<code><a href="#topic+eff.mu">eff.mu</a></code>,
<code><a href="#topic+eff.rho">eff.rho</a></code>,
<code><a href="#topic+pp.sigma">pp.sigma</a></code>,
<code><a href="#topic+pp.mu">pp.mu</a></code>,
<code><a href="#topic+pp.rho">pp.rho</a></code>.
These functions plot that data. For details see <code>vignette("hbimdetails")</code>.
</p>


<h3>Value</h3>

<p>Plots
</p>

<hr>
<h2 id='refs'>Reference list</h2><span id='topic+refs'></span>

<h3>Description</h3>

<p>Each reference is one long character string. See <code>data(irdata)</code> for data from each reference. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(refs)</code></pre>


<h3>Format</h3>

<p>The format is:
Factor w/ 50 levels (the 50 references)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(refs)
refs[1]
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
