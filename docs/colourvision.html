<!DOCTYPE html><html><head><title>Help for package colourvision</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {colourvision}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#colourvision-package'>
<p>Colour Vision Models</p></a></li>
<li><a href='#bee'>
<p>Honeybee photoreceptors</p></a></li>
<li><a href='#colour_space'>
<p>N-dimensional colour spaces</p></a></li>
<li><a href='#CTTKhexagon'>
<p>Chittka (1992) colour hexagon</p></a></li>
<li><a href='#CTTKhexagon3D'>
<p>Chittka (1992) colour space for tetrachromatic animals.</p></a></li>
<li><a href='#CTTKmodel'>
<p>Chittka (1992) colour vision model</p></a></li>
<li><a href='#D65'>
<p>CIE Standard Illuminant D65 in quantum flux (umol/m2/s)</p></a></li>
<li><a href='#deltaS'>
<p>Chromaticity distances</p></a></li>
<li><a href='#EMline'>
<p>Endler and Mielke (2005) 1-D colour space</p></a></li>
<li><a href='#EMmodel'>
<p>Endler and Mielke (2005) colour vision model</p></a></li>
<li><a href='#EMtetrahedron'>
<p>Endler and Mielke (2005) tetrahedron colour space</p></a></li>
<li><a href='#EMtriangle'>
<p>Endler and Mielke (2005) triangle colour space</p></a></li>
<li><a href='#energytoflux'>
<p>Irradiance from energy to quantum units.</p></a></li>
<li><a href='#GENmodel'>
<p>N-dimensional generic colour vision model</p></a></li>
<li><a href='#GENplot'>
<p>Generic model colour space 2D and 1D plot</p></a></li>
<li><a href='#GENplot3d'>
<p>Generic model colour space 3D plot</p></a></li>
<li><a href='#logistic'>
<p>Logistic curve</p></a></li>
<li><a href='#noise_e'>
<p>Receptor noise</p></a></li>
<li><a href='#photor'>
<p>Photoreceptor sensitivity spectra.</p></a></li>
<li><a href='#plot.colourvision'>
<p>Plot colour vision models into chromaticity diagrams</p></a></li>
<li><a href='#plot3d.colourvision'>
<p>Plot colour vision models into 3D chromaticity diagrams.</p></a></li>
<li><a href='#Q'>
<p>Total photon capture</p></a></li>
<li><a href='#Qr'>
<p>Photoreceptor relative quantum catch</p></a></li>
<li><a href='#radarplot'>
<p>Radar plot</p></a></li>
<li><a href='#Rb'>
<p>Brazilian savannah background reflectance spectrum.</p></a></li>
<li><a href='#RNLmodel'>
<p>Receptor Noise Limited Models (Vorobyev &amp; Osorio 1998)</p></a></li>
<li><a href='#RNLplot'>
<p>Receptor noise limited model 2D and 1D plot</p></a></li>
<li><a href='#RNLplot3d'>
<p>Receptor noise limited model 3D plot</p></a></li>
<li><a href='#RNLthres'>
<p>Colour thresholds based on the Receptor Noise Limited Model (Vorobyev &amp; Osorio 1998).</p></a></li>
<li><a href='#spec.denoise'>
<p>Smooth function for reflectance spectra.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Colour Vision Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe M. Gawryszewski</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Malheiros Gawrysewski &lt;f.gawry@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Colour vision models, colour spaces and colour thresholds. Provides flexibility to build user-defined colour vision models for n number of photoreceptor types. Also includes Vorobyev &amp; Osorio (1998) Receptor Noise Limited models &lt;<a href="https://doi.org/10.1098%2Frspb.1998.0302">doi:10.1098/rspb.1998.0302</a>&gt;, Chittka (1992) colour hexagon &lt;<a href="https://doi.org/10.1007%2FBF00199331">doi:10.1007/BF00199331</a>&gt;, and Endler &amp; Mielke (2005) model &lt;<a href="https://doi.org/10.1111%2Fj.1095-8312.2005.00540.x">doi:10.1111/j.1095-8312.2005.00540.x</a>&gt;. Models have been extended to accept any number of photoreceptor types. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils, Matrix</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, corrplot, rgl</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-31 13:51:38 UTC; isabelwaga</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-01 23:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='colourvision-package'>
Colour Vision Models
</h2><span id='topic+colourvision-package'></span><span id='topic+colourvision'></span>

<h3>Description</h3>

<p>Colour vision models, colour spaces and colour thresholds. Provides flexibility to build user-defined colour vision models for n number of photoreceptor types. Also includes Vorobyev &amp; Osorio (1998) Receptor Noise Limited models &lt;doi:10.1098/rspb.1998.0302&gt;, Chittka (1992) colour hexagon &lt;doi:10.1007/BF00199331&gt;, and Endler &amp; Mielke (2005) model &lt;doi:10.1111/j.1095-8312.2005.00540.x&gt;. Models have been extended to accept any number of photoreceptor types. 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> colourvision</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Colour Vision Models</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-07-31</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Felipe M. Gawryszewski</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Felipe Malheiros Gawrysewski &lt;f.gawry@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Colour vision models, colour spaces and colour thresholds. Provides flexibility to build user-defined colour vision models for n number of photoreceptor types. Also includes Vorobyev &amp; Osorio (1998) Receptor Noise Limited models &lt;doi:10.1098/rspb.1998.0302&gt;, Chittka (1992) colour hexagon &lt;doi:10.1007/BF00199331&gt;, and Endler &amp; Mielke (2005) model &lt;doi:10.1111/j.1095-8312.2005.00540.x&gt;. Models have been extended to accept any number of photoreceptor types. </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> graphics,
stats,
utils,
Matrix</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> testthat,
knitr,
rmarkdown,
corrplot,
rgl</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
CTTKhexagon             Chittka (1992) colour hexagon
CTTKhexagon3D           Chittka (1992) colour space for tetrachromatic
                        animals.
CTTKmodel               Chittka (1992) colour vision model
D65                     CIE Standard Illuminant D65 in quantum flux
                        (umol/m2/s)
EMline                  Endler and Mielke (2005) 1-D colour space
EMmodel                 Endler and Mielke (2005) colour vision model
EMtetrahedron           Endler and Mielke (2005) tetrahedron colour
                        space
EMtriangle              Endler and Mielke (2005) triangle colour space
GENmodel                N-dimensional generic colour vision model
GENplot                 Generic model colour space 2D and 1D plot
GENplot3d               Generic model colour space 3D plot
Q                       Total photon capture
Qr                      Photoreceptor relative quantum catch
RNLmodel                Receptor Noise Limited Models (Vorobyev &amp;
                        Osorio 1998)
RNLplot                 Receptor noise limited model 2D and 1D plot
RNLplot3d               Receptor noise limited model 3D plot
RNLthres                Colour thresholds based on the Receptor Noise
                        Limited Model (Vorobyev &amp; Osorio 1998).
Rb                      Brazilian savannah background reflectance
                        spectrum.
bee                     Honeybee photoreceptors
colour_space            N-dimensional colour spaces
colourvision-package    Colour Vision Models
deltaS                  Chromaticity distances
energytoflux            Irradiance from energy to quantum units.
logistic                Logistic curve
noise_e                 Receptor noise
photor                  Photoreceptor sensitivity spectra.
plot.colourvision       Plot colour vision models into chromaticity
                        diagrams
plot3d.colourvision     Plot colour vision models into 3D chromaticity
                        diagrams.
radarplot               Radar plot
spec.denoise            Smooth function for reflectance spectra.
</pre>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski
</p>
<p>Maintainer: Felipe Malheiros Gawrysewski &lt;f.gawry@gmail.com&gt;
</p>


<h3>References</h3>

<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Honeybee photoreceptor sensitivity curves
data("bee")

##Grey background:
## with 10 percent. reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(10, length(300:700)))

## Read CIE D65 standard illuminant already converted to quantum flux:
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])

## Run colour vision model:
model&lt;-CTTKmodel(photo="tri", R=R, I=D65, Rb=Rb,
C=bee)

##plot data in the colour space
plot(model)
</code></pre>

<hr>
<h2 id='bee'>
Honeybee photoreceptors
</h2><span id='topic+bee'></span>

<h3>Description</h3>

<p>Honeybee (Apis mellifera) photoreceptor sensitivity curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bee")</code></pre>


<h3>Format</h3>

<p>A data frame with 401 observations on the following 4 variables.
</p>

<dl>
<dt><code>Wavelength</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>UV</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Blue</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Green</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Original data were interpolated to 1nm intervals from 300 to 700nm.
</p>


<h3>Source</h3>

<p>Chittka, L., and P. Kevan. 2005. Flower colour as advertisement. Pp. 157-196 in Practical pollination biology.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("bee")
plot(bee[,2]~bee[,1], col = "violet", type="l", xlab="Wavelength(nm)", ylab= "Absorbance")
lines(bee[,3]~bee[,1], col = "blue", type="l")
lines(bee[,4]~bee[,1], col = "green", type="l")
</code></pre>

<hr>
<h2 id='colour_space'>
N-dimensional colour spaces
</h2><span id='topic+colour_space'></span>

<h3>Description</h3>

<p>Generates a colour space based on any number of photoreceptor types and finds a colour locus for a given photoreceptor output.</p>


<h3>Usage</h3>

<pre><code class='language-R'>colour_space(n, type="length", length=NA, edge=NA,
          q=rep(1,n), recep.noise=FALSE, e=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colour_space_+3A_n">n</code></td>
<td>
<p>Number of photoreceptor types. Function accepts any number of photoreceptor types &gt;=2. For instance, trichromatic: <code>n=3</code>; tetrachromatic: <code>n=4</code>, etc.
</p>
</td></tr>
<tr><td><code id="colour_space_+3A_type">type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed distance between vertices (<code>type="edge"</code>; e.g. Pike 2012 and Renoult et al. 2015).
</p>
</td></tr>
<tr><td><code id="colour_space_+3A_length">length</code></td>
<td>
<p>Vector length used to construct the colour space. Used when <code>type="length"</code>. Typically <code>length=1</code>.</p>
</td></tr>
<tr><td><code id="colour_space_+3A_edge">edge</code></td>
<td>
<p>Edge length used to construct the colour space. Used when <code>type="edge"</code>.</p>
</td></tr>
<tr><td><code id="colour_space_+3A_q">q</code></td>
<td>
<p>Photoreceptor output values</p>
</td></tr>
<tr><td><code id="colour_space_+3A_recep.noise">recep.noise</code></td>
<td>
<p>Whether receptor noise should be used to calculate colour locus coordinates.</p>
</td></tr>
<tr><td><code id="colour_space_+3A_e">e</code></td>
<td>
<p>Vector representing photoreceptor noises. Used when <code>recep.noise=TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used internally in colour vision models.
</p>


<h3>Value</h3>

<p>A list with the following dimensions:
</p>
<table>
<tr><td><code>coordinates</code></td>
<td>
<p>Colour locus of photoreceptor output values <code>q</code> in the colour space</p>
</td></tr>
<tr><td><code>vector_matrix</code></td>
<td>
<p>Matrix of column vectors, each representing one photoreceptor type</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2015. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Q">Q</a></code>, <code><a href="#topic+Qr">Qr</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+GENmodel">GENmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A trichromatic colour space based on Endler and Mielke (2005) 
tri&lt;-colour_space(n=3, length=0.75, q=c(0.5,0.2,0.3))

#showing:
#(1) Limits of the colour space (triangle)
plot(0, ylim=c(-1,1), xlim=c(-1,1), asp=1, ylab="X2", xlab="X1", type="n")
polygon(x=tri$vector_matrix[1,], y=tri$vector_matrix[2,], lty=2)

#(2) Vectors (length=0.75) used to build the colour space (arrows)
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,1], y1=tri$vector_matrix[2,1], col="red")
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,2], y1=tri$vector_matrix[2,2], col="red")
arrows(x0=0,y0=0, x1=tri$vector_matrix[1,3], y1=tri$vector_matrix[2,3], col="red")

#(3) Colour loci of given photoreceptor outputs
points(x=tri$coordinates[[1]], y=tri$coordinates[[2]], pch=21, col="blue", bg="blue")
</code></pre>

<hr>
<h2 id='CTTKhexagon'>
Chittka (1992) colour hexagon</h2><span id='topic+CTTKhexagon'></span>

<h3>Description</h3>

<p>Plots Chittka (1992) colour hexagon for trichromatic animals and a line plot for dichromatic animals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CTTKhexagon(x, y, photo=3,
            vnames=c(expression(E[1]),expression(E[2]),expression(E[3])),
            pch=16, bty="n", yaxt="n",xaxt="n", col="black",
            xlim="auto", ylim="auto", asp=1, ann=FALSE,
            axes=FALSE, vectors=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CTTKhexagon_+3A_x">x</code></td>
<td>
<p>x-coordinate</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_y">y</code></td>
<td>
<p>y-coordinate. <code>y=0</code> when <code>photo=2</code></p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_photo">photo</code></td>
<td>
<p>Number of photoreceptor types. <code>photo=3</code> for a trichromatic animal, and <code>photo=2</code> for a dichromatic animal.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_vnames">vnames</code></td>
<td>
<p>Vector names.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_pch">pch</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_bty">bty</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_yaxt">yaxt</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_xaxt">xaxt</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_col">col</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_xlim">xlim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function. Default calculates xlim automatically.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_ylim">ylim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function. Default calculates ylim automatically.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_asp">asp</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_ann">ann</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_axes">axes</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot.default">plot.default</a></code> function.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="CTTKhexagon_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Honeybee photoreceptor sensitivity curves
data("bee")

##Grey background:
## with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant already converted to quantum flux:
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])

## Run colour vision model:
model&lt;-CTTKmodel(photo="tri", R=R, I=D65, Rb=Rb,
C=bee)

##plot data in the colour space
CTTKhexagon(x=model[,"X1"], y=model[,"X2"])
</code></pre>

<hr>
<h2 id='CTTKhexagon3D'>
Chittka (1992) colour space for tetrachromatic animals.
</h2><span id='topic+CTTKhexagon3D'></span>

<h3>Description</h3>

<p>Plots a hexagonal trapezohedron representing Chittka (1992) colour space for tetrachromatic animals (Thery and Casas, 2002).</p>


<h3>Usage</h3>

<pre><code class='language-R'>CTTKhexagon3D(x, y, z, s.col = "red", f.col = "black",
              vnames = c("E1","E2","E3","E4"), type = "p",
              radius = 0.01, add = F, xlab = "", ylab = "", zlab = "",
              box = F, axes = F, ylim = c(-1, 1), xlim = c(-1, 1),
              zlim = c(-1,1), aspect = T, vectors=F, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CTTKhexagon3D_+3A_x">x</code></td>
<td>
<p>x coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_y">y</code></td>
<td>
<p>y coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_z">z</code></td>
<td>
<p>z coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_s.col">s.col</code></td>
<td>
<p>Colour to be used for plotted items. See plot3d in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_f.col">f.col</code></td>
<td>
<p>Colour of tetrahedron lines. See plot3d in rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_vnames">vnames</code></td>
<td>
<p>Vector names.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_type">type</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_radius">radius</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_add">add</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_xlab">xlab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_ylab">ylab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_zlab">zlab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_box">box</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_axes">axes</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_ylim">ylim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_xlim">xlim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_zlim">zlim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_aspect">aspect</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="CTTKhexagon3D_+3A_...">...</code></td>
<td>
<p>Other arguments passed to function plot3d in the rgl package.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170, 533-543.
</p>
<p>Thery, M., and J. Casas. 2002. Predator and prey views of spider camouflage. Nature 415, 133-133.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>
</p>

<hr>
<h2 id='CTTKmodel'>
Chittka (1992) colour vision model
</h2><span id='topic+CTTKmodel'></span>

<h3>Description</h3>

<p>Chittka (1992) colour hexagon extended to animals with any number of photoreceptors types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CTTKmodel(photo=ncol(C)-1, R, I, Rb, C,
          interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CTTKmodel_+3A_photo">photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_r">R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code> (percentage or proportion).
</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R</code> (percentage or proportion).
</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code><a href="#topic+photor">photor</a></code>). 
</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="CTTKmodel_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original model is available for trichromatic animals only. Thery and Casas (2002) derived a version for tetrachromatic animals which is implemented here. In <code>colourvision</code>, this model was extended to any number of photoreceptors types (Gawryszewski 2018; see also Pike 2012). The colour hexagon in Chittka (1992) has a vector of length = 1.0 The chromaticity coordinates in <code>colourvision</code> preserve the same vector length.
</p>
<p>Photoreceptor outputs (<code class="reqn">E_i</code>) are calculated by:
</p>
<p style="text-align: center;"><code class="reqn">E_i = \frac{q_i}{q_i+1}</code>
</p>

<p>where <code class="reqn">q_i</code> is given by <code><a href="#topic+Qr">Qr</a></code>.
</p>
<p>Then, for trichromatic vision, coordinates in the colour space are found by (Chittka 1992):
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{\sqrt{3}}{2}(E_3-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = E_2-\frac{1}{2}(E_1+E_3)</code>
</p>

<p>For tetrachromatic vision (Thery and Casas 2002):
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{\sqrt{3}\sqrt{2}}{3}(E_3-E_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = E_1-\frac{1}{3}(E_2+E_3+E_4)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_3 = \frac{2\sqrt{2}}{3}(\frac{1}{2}(E_3+E_4)-E_2)</code>
</p>

<p>For a pentachromatic animal following the same vector length:
</p>
<p style="text-align: center;"><code class="reqn">X_1 = \frac{5}{2\sqrt{2}\sqrt{5}}(E_2-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X_2 = \frac{5\sqrt{2}}{2\sqrt{3}\sqrt{5}}(E_3-\frac{E_1+E_2}{2})</code>
</p>

<p style="text-align: center;"><code class="reqn">X_3 = \frac{5\sqrt{3}}{4\sqrt{5}}(E_4-\frac{E_1+E_2+E_3}{3})</code>
</p>

<p style="text-align: center;"><code class="reqn">X_4 = E_5-\frac{E1+E2+E3+E4}{4}</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values after the von Kries transformation (see function <code><a href="#topic+Qr">Qr</a></code>).</p>
</td></tr>
<tr><td><code>Ei</code></td>
<td>
<p>Photoreceptor output values. Values can vary from 0 to 1.</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p>Coordinates in the colour space.</p>
</td></tr>
<tr><td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Thery, M., and J. Casas. 2002. Predator and prey views of spider camouflage. Nature 415:133-133.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+photor">photor</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+deltaS">deltaS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

## Grey background
## with 10 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(10, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

## Reflectance data
## with a sigmoid spectrum and midpoint at 500nm
R&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)

## Run model 
model&lt;-CTTKmodel(photo=3, R=R, I=D65,
    Rb=Rb, C=C)
 
#plot   
plot(model)
</code></pre>

<hr>
<h2 id='D65'>
CIE Standard Illuminant D65 in quantum flux (umol/m2/s)
</h2><span id='topic+D65'></span>

<h3>Description</h3>

<p>CIE Standard Illuminant D65. Datum has already been converted to quantum flux (umol/m2/s) and therefore can be used in colour vision models directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("D65")</code></pre>


<h3>Format</h3>

<p>A data frame with 107 observations on the following 2 variables.
</p>

<dl>
<dt><code>l.nm</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Standard.Illuminant.D65</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.cie.co.at/">http://www.cie.co.at/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("D65")
plot(D65, type="l")
</code></pre>

<hr>
<h2 id='deltaS'>
Chromaticity distances
</h2><span id='topic+deltaS'></span>

<h3>Description</h3>

<p>Calculates a matrix with all possible pairwise comparison between stimulus reflectance spectra based on a given colour vision model output.</p>


<h3>Usage</h3>

<pre><code class='language-R'>deltaS(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deltaS_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model</p>
</td></tr></table>
<p>.
</p>


<h3>Value</h3>

<p>A matrix with pairwise chromaticity distances.</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>,<code><a href="#topic+GENmodel">GENmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

## Grey background
## with 10 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(10, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

## Reflectance data
## with a sigmoid spectrum and midpoint at 500nm
R1&lt;-logistic(x=seq(300,700,1), x0=450, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R3&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1,R2[,2],R3[,2])

## Run model 
model&lt;-CTTKmodel(photo=3, R=R, I=D65,
    Rb=Rb, C=C)

#Chromaticity distances between R1, R2 and R3
deltaS(model)
</code></pre>

<hr>
<h2 id='EMline'>
Endler and Mielke (2005) 1-D colour space
</h2><span id='topic+EMline'></span>

<h3>Description</h3>

<p>Plots a colour space for dichromatic Endler and Mielke (2005) colour vision model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMline(x,y=rep(0, length(x)), type="length",
         vnames=c("E1","E2"), 
         ylim="auto", xlim="auto",
         ann=FALSE, axes = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMline_+3A_x">x</code></td>
<td>
<p>x-coordinate</p>
</td></tr>
<tr><td><code id="EMline_+3A_y">y</code></td>
<td>
<p>y-coordinate</p>
</td></tr>
<tr><td><code id="EMline_+3A_type">type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length, or a fixed edge length (distance between vertices).</p>
</td></tr>
<tr><td><code id="EMline_+3A_vnames">vnames</code></td>
<td>
<p>Vector names</p>
</td></tr>
<tr><td><code id="EMline_+3A_ylim">ylim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="EMline_+3A_xlim">xlim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="EMline_+3A_ann">ann</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMline_+3A_axes">axes</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot.default">plot.default</a></code> function.</p>
</td></tr>
<tr><td><code id="EMline_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>The original model is available for tetrachromatic animals only. Colour space is built either with a vector length = 0.75 or a edge length = sqrt(3/2), to match the tetrahedron proposed by Endler and Mielke (2005).
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>,  <code><a href="#topic+EMmodel">EMmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EMline(x=0.1, pch=16, col="red")
</code></pre>

<hr>
<h2 id='EMmodel'>
Endler and Mielke (2005) colour vision model
</h2><span id='topic+EMmodel'></span>

<h3>Description</h3>

<p>Endler and Mielke (2005) colour vision model extended to animals with any number of photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMmodel(photo = ncol(C)-1, type="length", R, I, Rb, C,
        interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMmodel_+3A_photo">photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_type">type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed edge length (distance between vertices; <code>type="edge")</code>.
</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_r">R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code> (percentage or proportion).
</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R</code> (percentage or proportion).
</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code><a href="#topic+photor">photor</a></code>). 
</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="EMmodel_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The original model is available for tetrachromatic animals only. In <code>colourvision</code>, the model was extended to any number of photoreceptors types (see also Pike 2012 formula).
</p>
<p>First, relative quantum catches are log-transformed:
</p>
<p style="text-align: center;"><code class="reqn">f_{i} = \ln{q_i}</code>
</p>

<p>where <code class="reqn">q_i</code> is the relative quantum catch of photoreceptor type i, given by <code><a href="#topic+Qr">Qr</a></code>. The model uses only relative output values, so that photoreceptor outputs are given by:
</p>
<p style="text-align: center;"><code class="reqn">E_i = \frac{f_i}{\sum_{i=1}^n f_i}</code>
</p>

<p>For tetrachromatic vision (Endler and Mielke 2005):
</p>
<p style="text-align: center;"><code class="reqn">X1 = \sqrt{\frac{3}{2}}(\frac{1-2E_2-E_3-E_1}{2})</code>
</p>

<p style="text-align: center;"><code class="reqn">X2 = \frac{-1+3E_3+E_1}{2\sqrt{2}}</code>
</p>

<p style="text-align: center;"><code class="reqn">X3 = E_1-\frac{1}{4}</code>
</p>

<p>Tetrachromatic chromaticity diagram (tetrahedron) in Endler and Mielke (2005) has a vector of length = 0.75 and and edge length = sqrt(3/2). The chromaticity coordinates for other colour spaces may preserve either the same vector length or edge length. 
</p>
<p>For instance, for dichromatic vision coordinate (X1) in the colour space preserving the same vector length is found by:
</p>
<p style="text-align: center;"><code class="reqn">X1 = \frac{3}{4}(E_2-E_1)</code>
</p>

<p>Whereas for trichromatic vision coordinates (X1 and X2) are found by:
</p>
<p style="text-align: center;"><code class="reqn">X1 = \frac{3\sqrt{3}}{8}(E_2-E_1)</code>
</p>

<p style="text-align: center;"><code class="reqn">X2 = \frac{3}{4}(E_3-\frac{E_2+E_1}{2})</code>
</p>



<h3>Value</h3>

<table>
<tr><td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values after the von Kries transformation (see function <code><a href="#topic+Qr">Qr</a></code>).</p>
</td></tr>
<tr><td><code>Ei</code></td>
<td>
<p>Photoreceptor outputs after conversion to relative values.</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p>Coordinates in the colour space.</p>
</td></tr>
<tr><td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EMline">EMline</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+photor">photor</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+GENmodel">GENmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Gray background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])
R[,2]&lt;-R[,2]+10
R[,3]&lt;-R[,3]+10

## Run model 
model&lt;-EMmodel(photo=3, type="edge",
       R=R, I=D65, Rb=Rb, C=C)

plot(model)
</code></pre>

<hr>
<h2 id='EMtetrahedron'>
Endler and Mielke (2005) tetrahedron colour space</h2><span id='topic+EMtetrahedron'></span>

<h3>Description</h3>

<p>Plots Endler and Mielke (2005) tetrahedron colour space for tetrachromatic animals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMtetrahedron(x, y, z, s.col = "red", f.col = "black",
              vnames = c("u","s","m","l"), type = "p",
              radius = 0.01, add = F, xlab = "",
              ylab = "", zlab = "", box = F, axes = F,
              ylim = c(-0.75, 0.75), xlim = c(-0.75, 0.75),
              zlim = c(-0.75, 0.75), aspect = T, vectors=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMtetrahedron_+3A_x">x</code></td>
<td>
<p>x coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_y">y</code></td>
<td>
<p>y coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_z">z</code></td>
<td>
<p>z coordinate of points to be plotted</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_s.col">s.col</code></td>
<td>
<p>Colour to be used for plotted items. See plot3d in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_f.col">f.col</code></td>
<td>
<p>Colour of tetrahedron lines. See plot3d in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_vnames">vnames</code></td>
<td>
<p>Vector names.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_type">type</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_radius">radius</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_add">add</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_xlab">xlab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_ylab">ylab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_zlab">zlab</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_box">box</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_axes">axes</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_ylim">ylim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_xlim">xlim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_zlim">zlim</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_aspect">aspect</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="EMtetrahedron_+3A_...">...</code></td>
<td>
<p>Other arguments passed to function plot3d in the rgl package.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>
</p>

<hr>
<h2 id='EMtriangle'>
Endler and Mielke (2005) triangle colour space
</h2><span id='topic+EMtriangle'></span>

<h3>Description</h3>

<p>Plots a triangle colour space for trichromatic Endler and Mielke (2005) colour vision model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMtriangle(x, y, type=c("length", "edge"), vnames=c("u","s","m"),
           ylim=c(-0.9,0.9), xlim=c(-0.9,0.9),
           pch=16, bty="n",yaxt="n",xaxt="n",
           col="black", asp=1, ann=FALSE, vectors=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMtriangle_+3A_x">x</code></td>
<td>
<p>x-coordinate</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_y">y</code></td>
<td>
<p>y-coordinate</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_type">type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length, or a fixed edge length (distance between vertices).</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_vnames">vnames</code></td>
<td>
<p>Vector names</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_ylim">ylim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_xlim">xlim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_pch">pch</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_bty">bty</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_yaxt">yaxt</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_xaxt">xaxt</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_col">col</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_asp">asp</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_ann">ann</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="EMtriangle_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>The original model is available for tetrachromatic animals only. Trichromatic version is implemented in <code>colourvision</code> based on Pike (2012) formula. The triangle is built either with a vector length = 0.75 or a edge length = sqrt(3/2), to match the tetrahedron proposed by Endler and Mielke (2005). Doris Gomez derived a trichromatic version which is available in software AVICOL (Gomez, 2006) and was previously implemented here (<code>colouvision v0.1</code>).
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Gomez, D. 2006. AVICOL, a program to analyse spectrometric data. Last update october 2011. Free executable available at:<br />
<a href="http://sites.google.com/site/avicolprogram/">http://sites.google.com/site/avicolprogram/</a>  or from the author at <a href="mailto:dodogomez@yahoo.fr">dodogomez@yahoo.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>,  <code><a href="#topic+EMmodel">EMmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EMtriangle(x=0,y=0, type="length", pch=16, col="red")
</code></pre>

<hr>
<h2 id='energytoflux'>
Irradiance from energy to quantum units.
</h2><span id='topic+energytoflux'></span>

<h3>Description</h3>

<p>Convert Irradiance datum from energy units (uW/cm2/nm) to quantum flux units (umol/m2/s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>energytoflux(datum)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="energytoflux_+3A_datum">datum</code></td>
<td>
<p>A data frame with first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in energy units (uW/cm2/nm).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with first column corresponding to wavelength values and second column with irradiance values in umol/m2/s.
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>

<hr>
<h2 id='GENmodel'>
N-dimensional generic colour vision model
</h2><span id='topic+GENmodel'></span>

<h3>Description</h3>

<p>A flexible function to build colour vision models based on any number of photoreceptor types (Gawryszewski 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GENmodel(photo=ncol(C)-1, type="length", length=NA, edge=NA,
          R, I, Rb=NA, C, vonKries = TRUE, func, unity=FALSE,
          recep.noise=FALSE, noise.given=TRUE, e=NA, v=NA, n=NA,
          interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GENmodel_+3A_photo">photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_type">type</code></td>
<td>
<p>Whether the colour space should be built with a fixed vector length (<code>type="length"</code>), or a fixed distance between vertices (<code>type="edge"</code>; e.g. Pike 2012 and Renoult et al. 2015).
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_length">length</code></td>
<td>
<p>Vector length used to construct the colour space. Used when <code>type="length"</code>. Typically <code>length=1</code>.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_edge">edge</code></td>
<td>
<p>Edge length used to construct the colour space. Used when <code>type="edge"</code>.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_r">R</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R</code> must be in the same scale as <code>Rb</code>.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as in <code>R</code>.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code><a href="#topic+photor">photor</a></code>). 
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_vonkries">vonKries</code></td>
<td>
<p>Whether the von Kries transformation should be applied to photoreceptor photon catches. Calculates the ratio between stimulus and background photoreceptor photon catches</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_func">func</code></td>
<td>
<p>Transformation of photoreceptors inputs. For instance, <code>func=log</code> for a ln-transformation.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_unity">unity</code></td>
<td>
<p>Whether sum of photoreceptor output should be normalized to 1, as in <code><a href="#topic+EMmodel">EMmodel</a></code></p>
</td></tr>
<tr><td><code id="GENmodel_+3A_recep.noise">recep.noise</code></td>
<td>
<p>Logical. Whether chromaticity distances should be calculated based on receptor noises.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_noise.given">noise.given</code></td>
<td>
<p>Logical. Whether receptor noise is provided (<code>noise.given = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise.given = FALSE</code>). Used when <code>recep.noise=TRUE</code>.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_e">e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_n">n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Used to calculate <code>e</code> when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_v">v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>recep.noise = TRUE</code> and <code>noise.given = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="GENmodel_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ei</code></td>
<td>
<p>Noise of photoreceptor channels. Calculated only when <code>recep.noise=TRUE</code></p>
</td></tr>
<tr><td><code>Qri</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R</code>. Relative Photoreceptor photon catches when <code>vonKries=TRUE</code>. See functions <code><a href="#topic+Q">Q</a></code> and <code><a href="#topic+Qr">Qr</a></code>.</p>
</td></tr>
<tr><td><code>Ei</code></td>
<td>
<p>Photoreceptor outputs.</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p>Stimulus colour locus coordinates in the colour space</p>
</td></tr>
<tr><td><code>deltaS</code></td>
<td>
<p>Euclidean distance to the origin of the colour space. It represents the conspicuousness of the stimulus (<code>R</code>) in relation to the background (<code>Rb</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Pike, T.W. 2012. Generalised chromaticity diagrams for animals with n-chromatic colour vision. Journal of Insect Behavior 255: 277-286.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2015. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Q">Q</a></code>, <code><a href="#topic+Qr">Qr</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+colour_space">colour_space</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A trichromatic colour vision model based on Endler and Mielke (2005)

##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Gray background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

##Reflectance data
## with a sigmoid spectrum and midpoint at 500nm and 550 nm
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1, R2[,2])
R[,2]&lt;-R[,2]+10
R[,3]&lt;-R[,3]+10

## Run model 
model&lt;-GENmodel(length=0.75, R=R, I=D65, Rb=Rb, C=C, 
                func=log, unity=TRUE)

plot(model)
</code></pre>

<hr>
<h2 id='GENplot'>
Generic model colour space 2D and 1D plot</h2><span id='topic+GENplot'></span>

<h3>Description</h3>

<p>Plots models based on the GENmodel( ) function for trichromatic and dichromatic animals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GENplot(model, photo, col.names=c("X1","X2"),
        vectors=TRUE, vnames=TRUE, vsize="auto",
        ylab="y", xlab="x", xlim="auto", ylim="auto", asp=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GENplot_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_photo">photo</code></td>
<td>
<p>Number of photoreceptor types.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_col.names">col.names</code></td>
<td>
<p>Column names to be plotted.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_vnames">vnames</code></td>
<td>
<p>Whether vector names should be plotted.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_vsize">vsize</code></td>
<td>
<p>Length of vectors to be plotted. Default calculates length automatically.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_xlab">xlab</code></td>
<td>
<p>x-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_xlim">xlim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_ylim">ylim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_asp">asp</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="GENplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+RNLplot">RNLplot</a></code>, <code><a href="#topic+RNLplot3d">RNLplot3d</a></code>, <code><a href="#topic+GENplot3d">GENplot3d</a></code>, <code><a href="#topic+plot.colourvision">plot.colourvision</a></code>, <code><a href="#topic+plot3d.colourvision">plot3d.colourvision</a></code>
</p>

<hr>
<h2 id='GENplot3d'>
Generic model colour space 3D plot
</h2><span id='topic+GENplot3d'></span>

<h3>Description</h3>

<p>Plots models based on the GENmodel( ) function for tetrachromatic animals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GENplot3d(model, col.names=c("X1","X2","X3"),
          vectors=TRUE, vnames=TRUE, vsize="auto",
          xlab="x", ylab="y", zlab="z",
          xlim="auto", ylim="auto", zlim="auto", asp=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GENplot3d_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_col.names">col.names</code></td>
<td>
<p>Column names to be plotted.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_vnames">vnames</code></td>
<td>
<p>Whether vector names should be plotted.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_vsize">vsize</code></td>
<td>
<p>Length of vectors to be plotted. Default calculates length automatically.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_xlab">xlab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_ylab">ylab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_zlab">zlab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_xlim">xlim</code></td>
<td>
<p>x-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_ylim">ylim</code></td>
<td>
<p>y-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_zlim">zlim</code></td>
<td>
<p>z-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_asp">asp</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="GENplot3d_+3A_...">...</code></td>
<td>
<p>Other arguments passed to function plot3d in the rgl package.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+RNLplot">RNLplot</a></code>, <code><a href="#topic+RNLplot3d">RNLplot3d</a></code>, <code><a href="#topic+GENplot">GENplot</a></code>, <code><a href="#topic+plot.colourvision">plot.colourvision</a></code>, <code><a href="#topic+plot3d.colourvision">plot3d.colourvision</a></code>
</p>

<hr>
<h2 id='logistic'>
Logistic curve
</h2><span id='topic+logistic'></span>

<h3>Description</h3>

<p>Generates a logistic curve.</p>


<h3>Usage</h3>

<pre><code class='language-R'>logistic(x = seq(300, 700, 1), x0, L, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logistic_+3A_x">x</code></td>
<td>
<p>Range.
</p>
</td></tr>
<tr><td><code id="logistic_+3A_x0">x0</code></td>
<td>
<p>Midpoint value.
</p>
</td></tr>
<tr><td><code id="logistic_+3A_l">L</code></td>
<td>
<p>Maximum value.
</p>
</td></tr>
<tr><td><code id="logistic_+3A_k">k</code></td>
<td>
<p>Steepness of the curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Logistic_function">https://en.wikipedia.org/wiki/Logistic_function</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l&lt;-logistic(x=seq(300,700,1), x0=650, L=50, k=0.04)
plot(l, type="l")
</code></pre>

<hr>
<h2 id='noise_e'>
Receptor noise</h2><span id='topic+noise_e'></span>

<h3>Description</h3>

<p>Receptor noise either provided by the user or based on noise-to-signal ratio of a single photoreceptor and the relative abundance of photoreceptor types in the retina. This function is used internally in Receptor Noise Limited models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noise_e(noise, e, v, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noise_e_+3A_noise">noise</code></td>
<td>

<p>Logical. Whether receptor noise is provided (<code>noise = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise = FALSE</code>)
</p>
</td></tr>
<tr><td><code id="noise_e_+3A_e">e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. It is used when <code>noise = TRUE</code>
</p>
</td></tr>
<tr><td><code id="noise_e_+3A_v">v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor.
</p>
</td></tr>
<tr><td><code id="noise_e_+3A_n">n</code></td>
<td>

<p>Relative abundance of the photoreceptor in the retina.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>, <code><a href="#topic+GENmodel">GENmodel</a></code>, <code><a href="#topic+colour_space">colour_space</a></code>
</p>

<hr>
<h2 id='photor'>
Photoreceptor sensitivity spectra.
</h2><span id='topic+photor'></span>

<h3>Description</h3>

<p>Generates photoreceptor sensitivity spectra based on lambda-max values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>photor(lambda.max, lambda = seq(300, 700, 1), beta.band = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="photor_+3A_lambda.max">lambda.max</code></td>
<td>

<p>Vector with photoreceptor wavelength at maximum sensitivity values, in increasing order. 
</p>
</td></tr>
<tr><td><code id="photor_+3A_lambda">lambda</code></td>
<td>

<p>Range and interval to calculate the sensitivity curves.
</p>
</td></tr>
<tr><td><code id="photor_+3A_beta.band">beta.band</code></td>
<td>

<p>Logical. Whether or not to include a beta-band in the sensitivity curve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with first column corresponding to wavelength values and following columns with photoreceptor sensitivity values
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Govardovskii, V. I., N. Fyhrquist, T. Reuter, D. G. Kuzmin, and K. Donner. 2000. In search of the visual pigment template. Vis. Neurosci. 17:509-528.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generates photoreceptor sensitivity
## values with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

plot(C[,2]~C[,1], type="l", col="violet")
lines(C[,3]~C[,1], type="l", col="blue")
lines(C[,4]~C[,1], type="l", col="green")
</code></pre>

<hr>
<h2 id='plot.colourvision'>
Plot colour vision models into chromaticity diagrams
</h2><span id='topic+plot.colourvision'></span>

<h3>Description</h3>

<p>Plotting method for objects of class <code>colourvision</code>. Plotting method for animals with two or three photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'colourvision'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.colourvision_+3A_x">x</code></td>
<td>

<p>Object of class &quot;<code>colourvision</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.colourvision_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the plot function. See <code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code> for Chittka (1992) model (<code><a href="#topic+CTTKmodel">CTTKmodel</a></code>) plotting arguments; <code><a href="#topic+EMtriangle">EMtriangle</a></code> and <code><a href="#topic+EMline">EMline</a></code> for Endler and Mielke (2005) model (<code><a href="#topic+EMmodel">EMmodel</a></code>) plotting arguments; <code><a href="#topic+RNLplot">RNLplot</a></code> for RNL plotting arguments; and <code><a href="#topic+GENplot">GENplot</a></code> for generic model (<code><a href="#topic+GENmodel">GENmodel</a></code>) plotting arguments.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot3d.colourvision">plot3d.colourvision</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#trichromatic
##Photoreceptor sensitivity curves
C&lt;-photor(lambda.max=c(350,450,550))

##Gray background
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

##Reflectance data
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1[,2]&lt;-R1[,2]+10

##Run models
model&lt;-EMmodel(photo=3,
       R=R1, I=D65, Rb=Rb, C=C)
plot(model)

model&lt;-CTTKmodel(photo=3,
       R=R1, I=D65, Rb=Rb, C=C)
plot(model)

model&lt;-RNLmodel(model="log", photo=3,
       R1=R1, I=D65, Rb=Rb, C=C, noise=TRUE, e=c(0.13, 0.06, 0.12))
plot(model)

#colour threshold
model&lt;-RNLthres(photo=3, I=D65, Rb=Rb, C=C,
         noise=TRUE, e=c(0.13, 0.06, 0.12))
plot(model)

#dichromatic
##Photoreceptor sensitivity curves
C&lt;-photor(lambda.max=c(400,550))

##Run models
model&lt;-EMmodel(photo=2,
       R=R1, I=D65, Rb=Rb, C=C)
plot(model)

model&lt;-EMmodel(photo=2, type="edge",
       R=R1, I=D65, Rb=Rb, C=C)
plot(model)

model&lt;-CTTKmodel(photo=2,
       R=R1, I=D65, Rb=Rb, C=C)
plot(model)

model&lt;-RNLmodel(model="log", photo=2,
       R1=R1, I=D65, Rb=Rb, C=C, noise=TRUE, e=c(0.13, 0.06))
plot(model)

#colour threshold
model&lt;-RNLthres(photo=2, I=D65, Rb=Rb, C=C,
         noise=TRUE, e=c(0.13, 0.06))
plot(model)
</code></pre>

<hr>
<h2 id='plot3d.colourvision'>
Plot colour vision models into 3D chromaticity diagrams.
</h2><span id='topic+plot3d.colourvision'></span>

<h3>Description</h3>

<p>'plot3d' method for objects of class <code>colourvision</code>. Plotting method for animals with four photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'colourvision'
plot3d(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot3d.colourvision_+3A_x">x</code></td>
<td>

<p>Object of class &quot;<code>colourvision</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot3d.colourvision_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to the plot3d function. See <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code> for Chittka (1992) model (<code><a href="#topic+CTTKmodel">CTTKmodel</a></code>) plotting arguments; <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code> for Endler and Mielke (2005) model (<code><a href="#topic+EMmodel">EMmodel</a></code>) plotting arguments;  <code><a href="#topic+RNLplot3d">RNLplot3d</a></code> for RNL plotting arguments; and <code><a href="#topic+GENplot3d">GENplot3d</a></code> for generic model (<code><a href="#topic+GENmodel">GENmodel</a></code>) plotting arguments.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Thery, M., and J. Casas. 2002. Predator and prey views of spider camouflage. Nature 415:133-133.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.colourvision">plot.colourvision</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>
</p>

<hr>
<h2 id='Q'>
Total photon capture</h2><span id='topic+Q'></span>

<h3>Description</h3>

<p>Total photoreceptor photon capture for a given irradiance, reflectance and photoreceptor sensitivity curve.  This function is used internally in colour vision models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Q(R,I,C,interpolate,nm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Q_+3A_r">R</code></td>
<td>

<p>Reflectance of observed object. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values.
</p>
</td></tr>
<tr><td><code id="Q_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="Q_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curve. A data frame with two columns only: first column corresponding to wavelength values and second column with photoreceptor absorbance values.
</p>
</td></tr>
<tr><td><code id="Q_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="Q_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gives the total photoreceptor photon capture.
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Backhaus, W., and R. Menzel. 1987. Color distance derived from a receptor model of color vision in the honeybee. Biological Cybernetics 55:321-331.
</p>
<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Qr">Qr</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>,<code><a href="#topic+GENmodel">GENmodel</a></code>
</p>

<hr>
<h2 id='Qr'>
Photoreceptor relative quantum catch</h2><span id='topic+Qr'></span>

<h3>Description</h3>

<p>von Kries transformation. Photoreceptors are assumed to be adapted to the background. This function is used internally in colour vision models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qr(R, I, Rb, C, interpolate, nm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qr_+3A_r">R</code></td>
<td>

<p>Reflectance of observed object. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values.
</p>
</td></tr>
<tr><td><code id="Qr_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="Qr_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. Photoreceptors are assumed to be adapted to the background reflectance.
</p>
</td></tr>
<tr><td><code id="Qr_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curve. A data frame with two columns only: first column corresponding to wavelength values and second column with photoreceptor absorbance values.
</p>
</td></tr>
<tr><td><code id="Qr_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="Qr_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the von Kries transformation, first the quantum catches of the observed reflectance and the environmental background are calculated (see <code><a href="#topic+Q">Q</a></code>). Then:
</p>
<p style="text-align: center;"><code class="reqn">qi = \frac{Q_i}{Q_{bi}}</code>
</p>

<p>where <code class="reqn">Q_i</code> is the quantum catch arising from the observed object and <code class="reqn">Q_{bi}</code> is the quantum catch from the background, for each one of the photoreceptor types (i).
</p>


<h3>Value</h3>

<p>Photoreceptor relative quantum catch.
</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Backhaus, W. 1991. Color opponent coding in the visual system of the honeybee. Vision Res 31:1381-1397.
</p>
<p>Chittka, L. 1992. The colour hexagon: a chromaticity diagram based on photoreceptor excitations as a generalized representation of colour opponency. J Comp Physiol A 170:533-543.
</p>
<p>Endler, J. A., and P. Mielke. 2005. Comparing entire colour patterns as birds see them. Biol J Linn Soc 86:405-431.
</p>
<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>, <code><a href="#topic+GENmodel">GENmodel</a></code>
</p>

<hr>
<h2 id='radarplot'>
Radar plot
</h2><span id='topic+radarplot'></span>

<h3>Description</h3>

<p>Plots quantum catches or E-values (photoreceptor outputs) into a radar plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>radarplot(model, item=c("Qr", "E"), item.labels=FALSE, item.lwd=1,
           border=NULL, radar.lwd=1, radar.col="grey",
           length="auto", xlim="auto", ylim="auto",
           xlab="", ylab="", asp=1, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="radarplot_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_item">item</code></td>
<td>
<p>Whether photoreceptor inputs (<code>Qr</code>) or outputs (<code>E</code>) should be plotted.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_item.labels">item.labels</code></td>
<td>
<p>Logical. Whether vector names should be plotted.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_item.lwd">item.lwd</code></td>
<td>
<p>Width of lines connecting item values.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_border">border</code></td>
<td>
<p>Colour of lines connecting item values. See <code><a href="graphics.html#topic+polygon">polygon</a></code>.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_radar.lwd">radar.lwd</code></td>
<td>
<p>Width of lines representing item vectors.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_radar.col">radar.col</code></td>
<td>
<p>Colour of lines representing item vectors.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_length">length</code></td>
<td>
<p>Length of <code>item</code> vectors. Default calculates length automatically.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_xlim">xlim</code></td>
<td>
<p>x-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_ylim">ylim</code></td>
<td>
<p>y-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_xlab">xlab</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_ylab">ylab</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_asp">asp</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_add">add</code></td>
<td>
<p>Logical. Whether data should be added to an existing plot.</p>
</td></tr>
<tr><td><code id="radarplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>   
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Photoreceptor sensitivity curves
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

## Grey background
## with 10 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(10, length(300:700)))

## Read CIE D65 standard illuminant
data("D65")

## Reflectance data
## with a sigmoid spectrum and midpoint at 500nm
R1&lt;-logistic(x=seq(300,700,1), x0=450, L=50, k=0.04)
R2&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R3&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R&lt;-cbind(R1,R2[,2],R3[,2])

## Run model 
model&lt;-CTTKmodel(photo=3, R=R, I=D65,
    Rb=Rb, C=C)

#Radarplot
radarplot(model, border=c("violet", "red", "blue"), item="E", item.labels=TRUE)
</code></pre>

<hr>
<h2 id='Rb'>
Brazilian savannah background reflectance spectrum.</h2><span id='topic+Rb'></span>

<h3>Description</h3>

<p>Brazilian savannah background reflectance spectrum calculated by the average reflectance of leaf, leaf litter, tree bark and twigs.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Rb")</code></pre>


<h3>Format</h3>

<p>A data frame with 401 observations on the following 2 variables.
</p>

<dl>
<dt><code>X300.700</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>cerrado</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gawryszewski, F. M., and P. C. Motta. 2012. Colouration of the orb-web spider Gasteracantha cancriformis does not increase its foraging success. Ethol Ecol Evol 24:23-38.</p>

<hr>
<h2 id='RNLmodel'>
Receptor Noise Limited Models (Vorobyev &amp; Osorio 1998)
</h2><span id='topic+RNLmodel'></span>

<h3>Description</h3>

<p>Receptor noise limited colour vision models (Vorobyev &amp; Osorio 1998; Vorobyev et al. 1998) extended to any number of photoreceptor types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNLmodel(model = c("linear", "log"), photo=ncol(C)-1,
         R1, R2=Rb, Rb, I, C,
         noise = FALSE, v=NA, n=NA, e=NA,
         interpolate = TRUE, nm = seq(300, 700, 1),
         coord="colourvision")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RNLmodel_+3A_model">model</code></td>
<td>
<p>Linear (<code>"linear"</code>; Vorobyev &amp; Osorio, 1998), or log-linear  (<code>"log"</code>; Vorobyev et al. 1998) RNLmodel version. <code>model="log"</code> is preferred.
</p>
<p><code>model="linear"</code> can be used only if comparison is to be made between two very similar colours.
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_photo">photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_r1">R1</code></td>
<td>

<p>Reflectance of observed objects. A data frame with first column corresponding to wavelength values and following columns with reflectance values. <code>R1</code> must be in the same scale as <code>R2</code> and <code>Rb</code>(percentage or proportion).
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_r2">R2</code></td>
<td>

<p>Reflectance to be compared against R1. <code>R2=Rb</code> if comparison is to be made against the background. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>R2</code> must be in the same scale as <code>R1</code> and <code>Rb</code>(percentage or proportion).
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values. <code>Rb</code> must be in the same scale as <code>R1</code> and <code>R2</code> (percentage or proportion).
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code><a href="#topic+photor">photor</a></code>). 
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_noise">noise</code></td>
<td>

<p>Logical. Whether receptor noise is provided (<code>noise = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise = FALSE</code>).
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_e">e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>noise = TRUE</code>
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_n">n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Usually increases with lambda-max. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_v">v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="RNLmodel_+3A_coord">coord</code></td>
<td>
<p>Whether colour locous coordinates should be calculated by the method (<code>coord="colourvision"</code>) by Gawryszewski (2018), or by alternative (<code>coord="alternative"</code>; available for 2-4 photoreceptor types only) methods (Hempel de Ibarra et al. 2001; Renoult et al. 2017).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The receptor noise limited model was originally developed to calculate <code class="reqn">\Delta S</code> between two reflectance curves directly, without finding colour locus coordinates (e.g. <code>x,y</code>; Vorobyev and Osorio 1998). This function uses later formulae to find colour loci in a chromaticity diagram (similarly to Hempel de Ibarra et al. 2001; Renoult et al. 2015).
</p>
<p>In lack of a direct measurement, receptor noise (<code class="reqn">e_i</code>) can be estimated by the relative abundance of photoreceptor types in the retina, and a measurement of a single photoreceptor noise-to-signal ratio:
</p>
<p style="text-align: center;"><code class="reqn">e_i=\frac{\nu}{\sqrt{\eta _i}}</code>
</p>

<p>where <code class="reqn">\nu</code> is the noise-to-signal ratio of a single photoreceptor, and <code class="reqn">\eta</code> is the relative abundance of photoreceptor i in the retina. Alternatively, noise may be dependent of the intensity, but this possibility is not implement in <code>colourvision</code> yet. Noise dependent of intensity usually holds for low light conditions only (Vorobyev et al. 1998). 
</p>


<h3>Value</h3>

<table>
<tr><td><code>ei</code></td>
<td>
<p>Noise of photoreceptor channels.</p>
</td></tr>
<tr><td><code>Qri_R1</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R1</code>, after the von Kries transformation (see function <code><a href="#topic+Qr">Qr</a></code>).</p>
</td></tr>
<tr><td><code>Qri_R2</code></td>
<td>
<p>Photoreceptor photon catch values from <code>R2</code>, after the von Kries transformation (see function <code><a href="#topic+Qr">Qr</a></code>).</p>
</td></tr>
<tr><td><code>Ei_R1</code></td>
<td>
<p>Photoreceptor outputs from the stimulus (<code>R1</code>)</p>
</td></tr>
<tr><td><code>Ei_R2</code></td>
<td>
<p>Photoreceptor outputs from R2</p>
</td></tr>
<tr><td><code>Xi_R1</code></td>
<td>
<p>Coordinates in the colour space for R1</p>
</td></tr>
<tr><td><code>Xi_R2</code></td>
<td>
<p>Coordinates in the colour space for R2. Equals zero when <code>R1=Rb</code></p>
</td></tr>
<tr><td><code>deltaS</code></td>
<td>
<p>Euclidean distance from R1 to R2. It represents the conspicuousness of the stimulus (<code>R1</code>) in relation to the background when <code>R1=Rb</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Gawryszewski, F.M. 2018. Colour vision models: Some simulations, a general n-dimensional model, and the colourvision R package. Ecology and Evolution, 10.1002/ece3.4288.
</p>
<p>Hempel de Ibarra, N., M. Giurfa, and M. Vorobyev. 2001. Detection of coloured patterns by honeybees through chromatic and achromatic cues. J Comp Physiol A 187:215-224.
</p>
<p>Renoult, J. P., A. Kelber, and H. M. Schaefer. 2017. Colour spaces in ecology and evolutionary biology. Biol Rev Camb Philos Soc, doi: 10.1111/brv.12230
</p>
<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>
<p>Vorobyev, M., D. Osorio, A. T. D. Bennett, N. J. Marshall, and I. C. Cuthill. 1998. Tetrachromacy, oil droplets and bird plumage colours. J Comp Physiol A 183:621-633.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+photor">photor</a></code>, <code><a href="#topic+RNLthres">RNLthres</a></code>, <code><a href="#topic+CTTKmodel">CTTKmodel</a></code>, <code><a href="#topic+EMmodel">EMmodel</a></code>, <code><a href="#topic+GENmodel">GENmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#1
## Photoreceptor sensitivity spectra
##with lambda max at 350nm, 450nm and 550nm:
C&lt;-photor(lambda.max=c(350,450,550))

##Grey background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant:
data("D65")

##Reflectance data of R1 and R2
R1.1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1.2&lt;-logistic(x=seq(300,700,1), x0=400, L=50, k=0.04)
w&lt;-R1.1[,1]
R1.1&lt;-R1.1[,2]+10
R1.2&lt;-R1.2[,2]+10
R1&lt;-data.frame(w=w, R1.1=R1.1, R1.2=R1.2)

R2&lt;-logistic(x=seq(300,700,1), x0=550, L=50, k=0.04)
R2[,2]&lt;-R2[,2]+10

## Run model 
model&lt;-RNLmodel(photo=3, model="log",
       R1=R1, R2=R2, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12))
       
#plot       
plot(model)

#2
#Pentachromatic animal
## Photoreceptor sensitivity spectra
##with lambda max at 350,400,450,500,and 550nm:
C&lt;-photor(lambda.max=c(350,400,450,500,550))

##Grey background
##with 7 percent reflectance from 300 to 700nm:
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))

## Read CIE D65 standard illuminant:
data("D65")

##Reflectance data of R1
R1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1[,2]&lt;-R1[,2]+10

#RNL model
RNLmodel(photo=5, model="log",
       R1=R1, R2=Rb, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12, 0.07, 0.08))
</code></pre>

<hr>
<h2 id='RNLplot'>
Receptor noise limited model 2D and 1D plot</h2><span id='topic+RNLplot'></span>

<h3>Description</h3>

<p>Plots receptor noise limited model (RNL) for trichromatic and dichromatic animals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNLplot(model, photo, item="R1",
        vectors=TRUE, vnames=TRUE, vsize="auto",
        xlab="x", ylab="y", xlim="auto", ylim="auto", asp=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RNLplot_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_photo">photo</code></td>
<td>
<p>Number of photoreceptor types.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_item">item</code></td>
<td>
<p>Model output item to be plotted. Default plots stimulus data. See <code><a href="#topic+RNLmodel">RNLmodel</a></code>.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_vnames">vnames</code></td>
<td>
<p>Whether vector names should be plotted.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_vsize">vsize</code></td>
<td>
<p>Length of vectors to be plotted. Default calculates length automatically.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_xlab">xlab</code></td>
<td>
<p>x-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_ylab">ylab</code></td>
<td>
<p>y-axis range. Default calculates range automatically. See <code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_xlim">xlim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function. Default calculates xlim automatically.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_ylim">ylim</code></td>
<td>
<p>see <code><a href="graphics.html#topic+par">par</a></code> function. Default calculates ylim automatically.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_asp">asp</code></td>
<td>
<p>see <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="RNLplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+RNLplot3d">RNLplot3d</a></code>, <code><a href="#topic+plot.colourvision">plot.colourvision</a></code>, <code><a href="#topic+plot3d.colourvision">plot3d.colourvision</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#dichromat
C&lt;-photor(lambda.max=c(450,550))
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))
data("D65")
R1.1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1.2&lt;-logistic(x=seq(300,700,1), x0=400, L=50, k=0.04)
w&lt;-R1.1[,1]
R1.1&lt;-R1.1[,2]+10
R1.2&lt;-R1.2[,2]+10
R1&lt;-data.frame(w=w, R1.1=R1.1, R1.2=R1.2)
model&lt;-RNLmodel(model="log",
       R1=R1, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06))
plot(model)

#trichromat
C&lt;-photor(lambda.max=c(350,450,550))
Rb &lt;- data.frame(300:700, rep(7, length(300:700)))
data("D65")
R1.1&lt;-logistic(x=seq(300,700,1), x0=500, L=50, k=0.04)
R1.2&lt;-logistic(x=seq(300,700,1), x0=400, L=50, k=0.04)
w&lt;-R1.1[,1]
R1.1&lt;-R1.1[,2]+10
R1.2&lt;-R1.2[,2]+10
R1&lt;-data.frame(w=w, R1.1=R1.1, R1.2=R1.2)
model&lt;-RNLmodel(model="log",
       R1=R1, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12))
plot(model)
</code></pre>

<hr>
<h2 id='RNLplot3d'>
Receptor noise limited model 3D plot
</h2><span id='topic+RNLplot3d'></span>

<h3>Description</h3>

<p>Plots receptor noise limited model (RNL) for tetrachromatic animals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNLplot3d(model, item="R1",
          vectors=TRUE, vnames=TRUE, vsize="auto",
          xlab="x", ylab="y", zlab="z",
          xlim="auto", ylim="auto", zlim="auto", asp=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RNLplot3d_+3A_model">model</code></td>
<td>
<p>Output of a colour vision model.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_item">item</code></td>
<td>
<p>Model output item to be plotted. Default plots stimulus data. See <code><a href="#topic+RNLmodel">RNLmodel</a></code>.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_vectors">vectors</code></td>
<td>
<p>Whether vectors representing direction of photoreceptor outputs should be plotted.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_vnames">vnames</code></td>
<td>
<p>Whether vector names should be plotted.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_vsize">vsize</code></td>
<td>
<p>Length of vectors to be plotted. Default calculates length automatically.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_xlab">xlab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_ylab">ylab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_zlab">zlab</code></td>
<td>
<p>see par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_xlim">xlim</code></td>
<td>
<p>x-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_ylim">ylim</code></td>
<td>
<p>y-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_zlim">zlim</code></td>
<td>
<p>z-axis range. Default calculates range automatically. See par3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_asp">asp</code></td>
<td>
<p>see plot3d function in the rgl package.</p>
</td></tr>
<tr><td><code id="RNLplot3d_+3A_...">...</code></td>
<td>
<p>Other arguments passed to function plot3d in the rgl package.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CTTKhexagon">CTTKhexagon</a></code>, <code><a href="#topic+CTTKhexagon3D">CTTKhexagon3D</a></code>, <code><a href="#topic+EMtriangle">EMtriangle</a></code>, <code><a href="#topic+EMtetrahedron">EMtetrahedron</a></code>, <code><a href="#topic+RNLplot">RNLplot</a></code>, <code><a href="#topic+plot.colourvision">plot.colourvision</a></code>, <code><a href="#topic+plot3d.colourvision">plot3d.colourvision</a></code>
</p>

<hr>
<h2 id='RNLthres'>
Colour thresholds based on the Receptor Noise Limited Model (Vorobyev &amp; Osorio 1998).
</h2><span id='topic+RNLthres'></span>

<h3>Description</h3>

<p>Colour thresholds based on receptor noise for any number of photoreceptor types (Vorobyev &amp; Osorio 1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNLthres(photo=ncol(C)-1, Rb, I, C, noise=TRUE, v=NA, n=NA, e=NA,
         interpolate=TRUE, nm=seq(300,700,1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RNLthres_+3A_photo">photo</code></td>
<td>

<p>Number of photoreceptor types. Model accepts any number of photoreceptor types (<code>&gt;=2</code>). For instance, dichromatic: <code>photo=2</code>; trichromatic: <code>photo=3</code>; tetrachromatic: <code>photo=4</code>, etc. Default gets number of photoreceptor types from <code>C</code> argument.
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_rb">Rb</code></td>
<td>

<p>Background reflectance. A data frame with two columns only: first column corresponding to wavelength values and second column with reflectance values.
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_i">I</code></td>
<td>

<p>Irradiance spectrum. A data frame with two columns only: first column corresponding to wavelength values and second column with irradiance values. Irradiance values must be in quantum flux units.
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_c">C</code></td>
<td>

<p>Photoreceptor sensitivity curves, from lowest to longest lambda-max. A data frame: first column corresponding to wavelength values and following columns with photoreceptor sensitivity values (see function <code><a href="#topic+photor">photor</a></code>). 
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_noise">noise</code></td>
<td>

<p>Logical. Whether receptor noise is provided (<code>noise = TRUE</code>) or calculated from photoreceptor relative abundances (<code>noise = FALSE</code>).
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_e">e</code></td>
<td>

<p>Receptor noise of each photoreceptor type. Used when <code>noise = TRUE</code>
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_n">n</code></td>
<td>

<p>Relative number of each photoreceptor type in the retina. Usually increases with lambda-max. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_v">v</code></td>
<td>

<p>Noise-to-signal ratio of a single photoreceptor. Used to calculate <code>e</code> when <code>noise = FALSE</code>.
</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_interpolate">interpolate</code></td>
<td>

<p>Whether data files should be interpolated before further calculations. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
<tr><td><code id="RNLthres_+3A_nm">nm</code></td>
<td>

<p>A sequence of numeric values specifying where interpolation is to take place. See <code><a href="stats.html#topic+approx">approx</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Colour thresholds based on receptor noise limited model as in Vorobyev and Osorio (1998). In lack of a direct measurement, receptor noise (<code class="reqn">e_i</code>) can be estimated by the relative abundance of photoreceptor types in the retina, and a measurement of a single photoreceptor noise-to-signal ratio:
</p>
<p style="text-align: center;"><code class="reqn">e_i=\frac{\nu}{\sqrt{\eta _i}}</code>
</p>

<p>where <code class="reqn">\nu</code> is the noise-to-signal ratio of a single photoreceptor, and <code class="reqn">\eta</code> is the relative abundance of photoreceptor i in the retina. Alternatively, noise may be dependent of the intensity, but this possibility is not implement in <code>colourvision</code> yet. Noise dependent of intensity usually holds for low light conditions only (Vorobyev et al. 1998). 
</p>


<h3>Value</h3>

<p>A data.frame with the following columns:
</p>
<table>
<tr><td><code>nm</code></td>
<td>
<p>Wavelength in nm.</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Colour threshold value.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Log of sensitivity value (inverse of threshold).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>


<h3>References</h3>

<p>Vorobyev, M., and D. Osorio. 1998. Receptor noise as a determinant of colour thresholds. Proceedings of the Royal Society B 265:351-358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+photor">photor</a></code>, <code><a href="#topic+RNLmodel">RNLmodel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###Bee photoreceptors normalized to max=1.
data("bee")
C&lt;-bee
C[,2]&lt;-C[,2]/max(C[,2])
C[,3]&lt;-C[,3]/max(C[,3])
C[,4]&lt;-C[,4]/max(C[,4])

##Grey background:
Rb &lt;- data.frame(300:700, rep(0.1, length(300:700)))

## CIE D65 illuminant:
data("D65")

#Thresholds
thres&lt;-RNLthres(photo=3, Rb=Rb, I=D65, C=C,
       noise=TRUE, e = c(0.13, 0.06, 0.12))

plot(thres)     
</code></pre>

<hr>
<h2 id='spec.denoise'>
Smooth function for reflectance spectra.
</h2><span id='topic+spec.denoise'></span>

<h3>Description</h3>

<p>Applies a <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> for data frame containing spectrometric data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec.denoise(specfiles, spar = 0.7, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spec.denoise_+3A_specfiles">specfiles</code></td>
<td>

<p>A data frame with first column representing wavelength values and following columns with reflectance data.
</p>
</td></tr>
<tr><td><code id="spec.denoise_+3A_spar">spar</code></td>
<td>
<p>see <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>. Smoothing parameter, typically (but not necessarily) in (0,1].
</p>
</td></tr>
<tr><td><code id="spec.denoise_+3A_...">...</code></td>
<td>
<p>Other arguments passed to function <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with first column representing wavelength values and following columns with reflectance data.</p>


<h3>Author(s)</h3>

<p>Felipe M. Gawryszewski <a href="mailto:f.gawry@gmail.com">f.gawry@gmail.com</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
