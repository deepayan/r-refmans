<!DOCTYPE html><html lang="en"><head><title>Help for package BayesTwin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesTwin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesTwin'><p>Bayesian analysis of item-level twin data</p></a></li>
<li><a href='#geplot'><p>Plots 95% credibility interval of GxE interaction</p></a></li>
<li><a href='#HPD'><p>Calculate highest posterior density interval</p></a></li>
<li><a href='#IRTtwin'><p>Bayesian analysis of item-level twin data</p></a></li>
<li><a href='#plotbayestwin'><p>Summary plots of BayesTwin MCMC-objects</p></a></li>
<li><a href='#results'><p>Sample output of a BayesTwin analysis</p></a></li>
<li><a href='#simulatetwin'><p>Simulate item-level twin data</p></a></li>
<li><a href='#summary.bayestwin'><p>Summary statistics for BayesTwin analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Analysis of Item-Level Twin Data</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Inga Schwabe</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Inga Schwabe &lt;bayestwin@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), foreign, coda, matrixStats, rjags</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian analysis of item-level hierarchical twin data using an integrated item response theory model. Analyses are based on Schwabe &amp; van den Berg (2014) &lt;<a href="https://doi.org/10.1007%2Fs10519-014-9649-7">doi:10.1007/s10519-014-9649-7</a>&gt;, Molenaar &amp; Dolan (2014) &lt;<a href="https://doi.org/10.1007%2Fs10519-014-9647-9">doi:10.1007/s10519-014-9647-9</a>&gt;, Schwabe, Jonker &amp; van den Berg (2016) &lt;<a href="https://doi.org/10.1007%2Fs10519-015-9768-9">doi:10.1007/s10519-015-9768-9</a>&gt; and Schwabe, Boomsma &amp; van den Berg (2016) &lt;<a href="https://doi.org/10.1016%2Fj.lindif.2017.01.018">doi:10.1016/j.lindif.2017.01.018</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.ingaschwabe.com">http://www.ingaschwabe.com</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ingaschwabe/BayesTwin">https://github.com/ingaschwabe/BayesTwin</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-26 14:12:33 UTC; ischwabe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-26 16:37:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesTwin'>Bayesian analysis of item-level twin data</h2><span id='topic+BayesTwin'></span>

<h3>Description</h3>

<p>This package can be used to perform bayesian analysis of item-level twin data. Simulatenously with the biometric model (ACE/ADE or AE), an item response theory (IRT) model is estimated to take into account properties of the measurement scale. Functions are included in the package that help plot relevant information in figures and compute posterior statistics such as HPD intervals. 
</p>
<p>Caution! The subroutines of this package rely on the program JAGS, which can be freely obtained from http://mcmc-jags.sourceforge.net.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
        Package: </td><td style="text-align: left;"> BayesTwin</td>
</tr>
<tr>
 <td style="text-align: left;">
        Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
        Version: </td><td style="text-align: left;"> 0.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
        Date: </td><td style="text-align: left;"> 2017-01-06</td>
</tr>
<tr>
 <td style="text-align: left;">
        License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>

<p>The main function <code>IRT_twin</code> can be used to analyse item-level twin data under the ACE, ADE or AE model. Simultaneously with the biometric model, an item response theory (IRT) measurement model is estimated. For dichotomous item data, the 1 parameter model (1PL) or the 2 parameter model (2PL) can be used and for polytomous item data, the partial credit model (PCM) or the generalized partial credit model (GPCM). Optionally, genotype by environment interaction (GxE) can be estimated and/or covariates can be included in the analysis. GxE is assessed in the case that the unique environment features as latent (i.e., unmeasured) variable, using the parametrization as described in Schwabe &amp; van den Berg (2014, 2016) and Schwabe, Boomsma &amp; van den Berg (2017). The function returns MCMC samples as well as posterior means, standard deviations and 95% HPD intervals for all variance components. Objects returned from the function are assigned the class &quot;Bayestwin&quot; which has its own <code>summary</code> method that can be used to summarize the output. The function <code>plotbayestwin</code> can be used to create sampling plots or plot posterior distributions and the function <code>geplot</code> to plot the 95% credibility region of the GxE interaction effect.
</p>
<p>The function <code>simulate_twin_data</code> can be used to simulate item-level twin data under all common biometric models (ACE/ADE or AE). For the simulation of the item data, a 1PL, 2PL, PCM or GPCM can be used. Optionally, the data can be simulated with GxE, using the parametrization as described in Schwabe &amp; van den Berg (2014, 2016) and Schwabe, Boomsma &amp; van den Berg (2017).
</p>


<h3>Note</h3>

<p>To work, this packages requires the program JAGS to be in the PATH variable. JAGS can be freely obtained from http://mcmc-jags.sourceforge.net.
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe &lt;bayestwin@gmail.com&gt;
</p>


<h3>References</h3>

<p>Schwabe, I. &amp; van den Berg, S.M. (2014). Assessing Genotype by Environment Interaction in Case of Heterogeneous Measurement Error, Behavior Genetics, 44 (4), 394-406.
</p>
<p>Molenaar, D. &amp; Dolan, C.V. (2014). Testing Systematic Genotype by Environment Interactions Using
Item Level Data, Behavior Genetics, 44(3), 212-231.
</p>
<p>Schwabe, I., Jonker, W. &amp; van den Berg, S.M. (2016). Genes, Culture and Conservatism - A Psychometric-Genetic Approach, Behavior Genetics, 46 (4), 516-52.
</p>
<p>Schwabe, I., Boomsma, D.I. &amp; van den Berg, S.M. (2017). Increased Environmental Sensitivity in High Mathematics Performance. Learning and Individual Differences, 54, 196-201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(results)
summary(results)

#Using the output to obtain the 95% HPD for additive genetic variance 
HPD(results$samples_var_a)

#Using the output to obtain the 90% HPD for all item difficulty parameters
apply(results$samples_item_b, 1, function (x) HPD(x, 0.90))

## Not run: 
##Simulate Item-level twin data under the 1PL Rasch model 
data = simulatetwin(irt_model = "1PL", var_a = 0.5, var_c = 0.3, ge_beta0 = log(0.2), 
                    ge = TRUE)
                
data_mz = data$y_mz
data_dz = data$y_dz

##Analyse the simulated data under an 1PL model with GxE
results = IRTtwin(data_mz, data_dz, 1:20, 21:40, ge = TRUE)

##Summarize results: 
summary(results)

#Using the output to obtain the 95% HPD for additive genetic variance 
HPD(results$samples_var_a)

#Using the output to obtain the 90% HPD for all item difficulty parameters
apply(results$samples_item_b, 1, function (x) HPD(x, 0.90))

##Plot trace lines for var(A)
plotbayestwin(results$samples_var_a, type = "trace")

##Plot posterior distribution of var(A)
plotbayestwin(results$samples_var_a)

##Plot 95% credibility region of GxE interaction effect
geplot(results$var_a, results$samples_beta0, results$samples_beta1)

## End(Not run)
</code></pre>

<hr>
<h2 id='geplot'>Plots 95% credibility interval of GxE interaction</h2><span id='topic+geplot'></span><span id='topic+GEplot'></span><span id='topic+ge_plot'></span>

<h3>Description</h3>

<p>This function plots the 95% credibility region of a GxE interaction effect.</p>


<h3>Usage</h3>

<pre><code class='language-R'>geplot(var_a, samples_beta0, samples_beta1, main, xlab, ylab, col, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geplot_+3A_var_a">var_a</code></td>
<td>
<p>A single value representing the posterior point estimate for genetic variance</p>
</td></tr>
<tr><td><code id="geplot_+3A_samples_beta0">samples_beta0</code></td>
<td>
<p>A vector representing draws from the posterior distribution of beta0, as produced by the main function <code>IRT_twin</code> of this package</p>
</td></tr>
<tr><td><code id="geplot_+3A_samples_beta1">samples_beta1</code></td>
<td>
<p>A vector representing draws from the posterior distribution of beta1, as produced by the main function <code>IRT_twin</code> of this package</p>
</td></tr> 
<tr><td><code id="geplot_+3A_main">main</code></td>
<td>
<p>An overall title for the plot</p>
</td></tr>
<tr><td><code id="geplot_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis</p>
</td></tr>
<tr><td><code id="geplot_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis</p>
</td></tr>
<tr><td><code id="geplot_+3A_col">col</code></td>
<td>
<p>Color of the lines</p>
</td></tr>
<tr><td><code id="geplot_+3A_...">...</code></td>
<td>
<p>Further arguments for the default S3 plot method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 95 % credibility region for the GxE interaction effect is displayed for the entire
range of estimated genotypic values in the interval of -2 and 2 standard deviations of the posterior point estimate of genetic variance. 
</p>
<p>The function expects as input the posterior point estimate for genetic variance and two vectors representing draws from the posterior distributions of beta0 and beta1 respectively, as produced by the main function <code>IRT_twin</code> of this package.
</p>


<h3>Value</h3>

<p>Plot of the 95% credibility region of the GxE interaction.
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Using the output to plot the 95% credibility region 
data(results)
geplot(results$var_a, results$samples_beta0, results$samples_beta1)
</code></pre>

<hr>
<h2 id='HPD'>Calculate highest posterior density interval</h2><span id='topic+hpd'></span><span id='topic+HPD'></span>

<h3>Description</h3>

<p>This function calculates the Bayesian highest posterior density interval (HPD) based on a parameters' posterior sample.</p>


<h3>Usage</h3>

<pre><code class='language-R'>HPD(sample, cred_int = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HPD_+3A_sample">sample</code></td>
<td>
<p>A vector representing draws from the target distribution of the paramter of interest, as produced by the main function <code>IRT_twin</code> of this package.</p>
</td></tr>
<tr><td><code id="HPD_+3A_cred_int">cred_int</code></td>
<td>
<p>The desired accuracy of the HPD. Default value is 0.95 for 95%.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The highest posterior density interval (HPD, see e.g. Box &amp; Tia, 1992) contains the required mass such that all points within the interval have a higher probability density than points outside of the interval. 
</p>
<p>The function expects as input a vector representing draws from the target distribution of the paramter of interest, such as produced by the main function <code>IRT_twin</code> of this package.
</p>
<p>The result is a vector consisiting of two values, the first value representing the lower bound of the HPD and the second value representing the upper bound. 
</p>


<h3>Value</h3>

<p>A vector of length 2 with the lower (first value) and upper (second value) bound of the HPD.
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>References</h3>

<p>Box, G., &amp; Tiao, G. (1992). Bayesian inference in statistical analysis. New York: John Wiley &amp; Sons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(results)

#Obtain the 95% HPD for additive genetic variance 
HPD(results$samples_var_a)

#Obtain the 90% HPD for all item difficulty parameters
apply(results$samples_item_b, 1, function (x) HPD(x, 0.90))
</code></pre>

<hr>
<h2 id='IRTtwin'>Bayesian analysis of item-level twin data</h2><span id='topic+IRTtwin'></span>

<h3>Description</h3>

<p>Bayesian analysis of item-level twin data under the AE, ACE or ADE model. Covariates can be included an a GxE interaction effect can be estimated.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IRTtwin(data_mz, data_dz, 
         twin1_datacols_p, twin2_datacols_p, 
         twin1_datacols_cov = NA, twin2_datacols_cov = NA, 
         decomp_model = "ACE", irt_model = "1PL", ge = FALSE, 
         n_iter = 5000, n_burnin = 7000, n_chains = 1, 
         fit_stats = FALSE, var_prior = "INV_GAMMA", 
         N_cov = 0, inits = NA, Nk = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IRTtwin_+3A_data_mz">data_mz</code></td>
<td>
<p>Phenotypic as well as covariate data of MZ twins in matrix form.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_data_dz">data_dz</code></td>
<td>
<p>Phenotypic as well as covariate data of DZ twins in matrix form.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_twin1_datacols_p">twin1_datacols_p</code></td>
<td>
<p>Columns of data_mz or respectively data_dz in which phenotypic data is stored for the     first twin of all MZ and DZ twins, e.g. c(1,2,3) if they are stored in the first three columns or c(20:40) if stored in column 20 through 40.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_twin2_datacols_p">twin2_datacols_p</code></td>
<td>
<p>Columns of data_mz or respectively data_dz in which phenotypic data is stored for the second twin of all MZ and DZ twins.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_twin1_datacols_cov">twin1_datacols_cov</code></td>
<td>
<p>Columns of data_mz or respectively data_dz in which covariate data is stored for the first twin of all MZ and DZ twins.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_twin2_datacols_cov">twin2_datacols_cov</code></td>
<td>
<p>Columns of data_mz or respectively data_dz in which covariate data is stored for the second twin of all MZ and DZ twins.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_decomp_model">decomp_model</code></td>
<td>
<p>Choice of the biometric model under which the data is analyzed, either &quot;ACE&quot;, &quot;ADE&quot; or &quot;AE&quot;. Default model is &quot;ACE&quot; model.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_irt_model">irt_model</code></td>
<td>
<p>Choice of the measurement (IRT) model under which the item data is simulated. &quot;1PL&quot; = 1 PL model, &quot;2PL&quot; = 2PL model, &quot;PCM&quot; = Partial credit model, &quot;GPCM&quot; = Generalized partial credit model..</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_ge">ge</code></td>
<td>
<p>Indication whether data is analyzed with (ge = TRUE) or without (ge = FALSE) GxE. Default value is FALSE.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_n_iter">n_iter</code></td>
<td>
<p>Total number of MCMC iterations (without burn-in period). Default number is 5.000</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_n_burnin">n_burnin</code></td>
<td>
<p>Total number of burn-in iterations for the MCMC analysis. Default number is 7.000</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of MCMC chains. Default number is 1.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_fit_stats">fit_stats</code></td>
<td>
<p>Should be set to TRUE when fit statistics are needed (e.g., DIC, BIC). In this case, multiple chains need to be used (the parameter n_chains should be set to at least 2)</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_var_prior">var_prior</code></td>
<td>
<p>Choice of prior distributions used for the variance compoenents, either &quot;INV_GAMMA&quot; for an inverse gamma distribution or &quot;UNIF&quot; for uniform distribution. For a low total phenotypic variance, uniform prior distributions are recommended. Default value is &quot;INV_GAMMA&quot;.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_n_cov">N_cov</code></td>
<td>
<p>Number of covariates. Default value is 0.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_inits">inits</code></td>
<td>
<p>Initial values for the MCMC analysis. Default is NULL.</p>
</td></tr>
<tr><td><code id="IRTtwin_+3A_nk">Nk</code></td>
<td>
<p>Number of categories in case of polytomous item data. As the default IRT model is a 1PL, the default value is set 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bayesian analysis of item-level twin data under all common biometric models (i.e., A(C)E, ADE) with or without genotype by environment interaction (GxE). For the simulation of dichotomous item data, the one parameter logistic model (1PL) or the 2 parameter logistisc model (2PL) can be used. For polytomous item data, the partial credit model (PCM) or the generalized partial credit model (GPCM) can be used. Optionally, covariates can be included in the analysis.
</p>
<p>GxE is defined modelled as heterogeneous unique-environmental variance and is defined as <code class="reqn">\sigma^2Eij = exp (\beta0 + \beta1 Aij)</code> under the ACE model and as <code class="reqn">\sigma^2Eij = exp (\beta0 + \beta1 Gij)</code> under the ADE model where <code class="reqn">\beta0</code> refers to an intercept (unique-environmental variance when <code class="reqn">Aij</code> or respectively <code class="reqn">Gij = 0</code>) and <code class="reqn">\beta1</code> represents the GxE interaction effect. <code class="reqn">Aij</code> represents the genotypic value for twin <code class="reqn">j</code> from family <code class="reqn">i</code>, likewise <code class="reqn">G</code> represents the total genotypic value (both additive and non-additive genetic effects) for twin <code class="reqn">j</code> from family <code class="reqn">i</code>. For more detail see Schwabe &amp; van den Berg (2014), Behavior Genetics, 44(4), 394-406 and Schwabe, Boomsma &amp; van den Berg (2017), Learning and Individual Differences, 54, 196-201. 
</p>


<h3>Value</h3>

<p>Output of the class &quot;bayestwin&quot; including samples, posterior point estimates, standard deviations and the 95% HPD interval for variance components and, if applicable, regression parameters. Call str(results) if the output of <code>IRT_twin</code> is stored in an object called results to see a list of all stored variables. 
</p>
<p>Results are printed on the fly for variance components and, if applicable, regression parameters. 
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(results)

#Summarize results
summary(results)

##Plot posterior distribution of var(A)
plotbayestwin(results$samples_var_a)

##Plot 95% credibility region of GxE interaction effect
geplot(results$var_a, results$samples_beta0, results$samples_beta1)

## Not run: 
##Simulate data
data = simulate(irt_model = "1PL", var_a = 0.5, var_c = 0.3, ge_beta0 = log(0.2), 
                ge = TRUE)
data_mz = data$y_mz
data_dz = data$y_dz

##Run analysis
results = IRTtwin(data_mz, data_dz, 1:20, 21:40, ge = TRUE)

##Summarize results: 
summary(results)

##Plot trace lines for var(A)
plotbayestwin(results$samples_var_a, type = "trace")

##Plot posterior distribution of var(A)
plotbayestwin(results$samples_var_a)

##Plot 95% credibility region of GxE interaction effect
geplot(results$var_a, results$samples_beta0, results$samples_beta1)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotbayestwin'>Summary plots of BayesTwin MCMC-objects</h2><span id='topic+plotbayestwin'></span><span id='topic+plotBayestwin'></span>

<h3>Description</h3>

<p><code>plotbayestwin</code> returns either a density or trace plot for the target parameter.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotbayestwin(sample, t = "density", main, xlab, ylab, legend = TRUE, lines = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotbayestwin_+3A_sample">sample</code></td>
<td>
<p>A vector representing draws from the posterior distribution of the parameter of interest, as produced by the main function <code>IRT_twin</code> of this package</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_t">t</code></td>
<td>
<p>Type of plot that is produced, either &quot;density&quot; to get a histogram of the posterior distribution or &quot;trace&quot;to get a trace plot. Default value is &quot;density&quot;</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_main">main</code></td>
<td>
<p>An overall title for the plot</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_legend">legend</code></td>
<td>
<p>Indicating if a legend should be added. Default value is TRUE.</p>
</td></tr>
<tr><td><code id="plotbayestwin_+3A_lines">lines</code></td>
<td>
<p>Indicating if lines for mean, median and lower and upper limit of the 95% HPD should be added. Default value is TRUE</p>
</td></tr> 
<tr><td><code id="plotbayestwin_+3A_...">...</code></td>
<td>
<p>Further arguments for the generic S3 method histogram (for the density plot) or plot (for the trace plot) method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates either a density or trace plot for the target parameter. 
</p>
<p>The function expects as input a vector representing draws from the posterior distributions of the parameter of interest, as produced by the main function <code>IRT_twin</code> of this package.
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(results)

##Plot posterior distribution of var(A)
plotbayestwin(results$samples_var_a)

</code></pre>

<hr>
<h2 id='results'>Sample output of a BayesTwin analysis</h2><span id='topic+results'></span>

<h3>Description</h3>

<p> Sample MCMC output from <code>IRTtwin</code> of an analysis of simulated data.The data were simulated and analysed using an ACE and 1 PL model including genotype-environment interaction (GxE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(results)</code></pre>


<h3>Format</h3>

<p>An <code>bayestwin</code> object</p>


<h3>Source</h3>

<p>Schwabe, I. (submitted for publication). BayesTwin - An R Package for Bayesian Inference of Item-Level Hierarchical Twin Data. 
</p>

<hr>
<h2 id='simulatetwin'>Simulate item-level twin data</h2><span id='topic+simulatetwin'></span><span id='topic+simulatetwindata'></span><span id='topic+Simulatedata'></span>

<h3>Description</h3>

<p>Simulation of item-level twin data under the AE, ACE or ADE model with or without genotype by environment interaction (GxE).</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulatetwin(n_mz = 140, n_dz = 360, var_a = 0.5, var_c = 0.3, 
var_e = 0.2, var_d = 0, model = "ACE", n_items = 20, n_cat = 0,
ge = FALSE, ge_beta0 = 0, ge_beta1 = 0, irt_model = "1PL")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulatetwin_+3A_n_mz">n_mz</code></td>
<td>
<p>Number of monozygotic (MZ) twin pairs. Default value is 140.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_n_dz">n_dz</code></td>
<td>
<p>Number of dizygotic (DZ) twin pairs. Default value is 360.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_var_a">var_a</code></td>
<td>
<p>Variance explained by additive genetic influences. Default value is 0.5.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_var_c">var_c</code></td>
<td>
<p>Variance explained by shared environmental influences. Default value is 0.3.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_var_e">var_e</code></td>
<td>
<p>Variance explained by unique environmental influences. Default value is 0.2.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_var_d">var_d</code></td>
<td>
<p>Variance explained by dominance genetic influences. As the default model is an &quot;ACE&quot;
model, the default value is set to 0.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_model">model</code></td>
<td>
<p>Biometric model used for the simulation, either &quot;ACE&quot;, &quot;ADE&quot; or &quot;AE&quot;. Default model is &quot;ACE&quot; model.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_n_items">n_items</code></td>
<td>
<p>Number of test items. Default value is 20.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_n_cat">n_cat</code></td>
<td>
<p>Number of categories for the simulation of polytomous item data. As the default IRT model is a 1PL, the default is set 0.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_ge">ge</code></td>
<td>
<p>Indication whether data is simulated with (ge = TRUE) or without (ge = FALSE) GxE. Default value is FALSE</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_ge_beta0">ge_beta0</code></td>
<td>
<p>When data is simulated with ge = TRUE, average environmental variance (when A = 0) has to be defined. Default value is 0.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_ge_beta1">ge_beta1</code></td>
<td>
<p>When data is simulated with ge = TRUE, the GxE interaction parameter has to be defined. Default value is 0.</p>
</td></tr>
<tr><td><code id="simulatetwin_+3A_irt_model">irt_model</code></td>
<td>
<p>Choice of the measurement (IRT) model under which the item data is simulated. &quot;1PL&quot; = 1 PL model, &quot;2PL&quot; = 2PL model, &quot;PCM&quot; = Partial credit model, &quot;GPCM&quot; = Generalized partial credit model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Item twin data is simulated under all common biometric models (i.e., A(C)E, ADE) with or without genotype by environment interaction (GxE). Data is simulated with an average phenotypic value of 0. For the simulation of dichotomous item data, the 1 PL or 2 PL can be used. For polytomous item data with three or more categories, the partial credit model (PCM) or the generalized partial credit model (GPCM) can be used. 
</p>
<p>Genotype by environment interaction is defined modelled as heterogeneous unique-environmental variance and is defined as <code class="reqn">\sigma^2Eij = exp (\beta0 + \beta1 Aij)</code> under the ACE model and as <code class="reqn">\sigma^2Eij = exp (\beta0 + \beta1 Gij)</code> under the ADE model where <code class="reqn">\beta0</code> refers to an intercept (unique-environmental variance when <code class="reqn">Aij</code> or respectively <code class="reqn">Gij = 0</code>) and <code class="reqn">\beta1</code> represents the GxE interaction effect. <code class="reqn">Aij</code> represents the genotypic value for twin <code class="reqn">j</code> from family <code class="reqn">i</code>, likewise <code class="reqn">G</code> represents the total genotypic value (both additive and non-additive genetic effects) for twin <code class="reqn">j</code> from family <code class="reqn">i</code>. For more detail see Schwabe &amp; van den Berg (2014, 2016) or Schwabe, Boomsma &amp; van den Berg (2017).
</p>


<h3>Value</h3>

<p>Two matrices are returned, <code>y_mz</code> for MZ twin pairs and <code>y_dz</code> for DZ twin pairs. 
For a total of <code>n_items</code>, the result is a matrix of <code>n_mz</code> rows for the i-th MZ family and 2*<code>n_items</code> columns with the item answers of the first (columns 1:<code>n_items</code>) and second twin (columns <code>n_items</code> + 1:2*<code>n_items</code>) of a family. For example, <code>y_mz[1,22]</code> is the response of the first twin from family 1 to item 22 and <code>y_mz[1,23]</code> is the response of the seocnd twin2 from family 1 to item 1 if <code>n_items</code> = 22. The same logic applies to the data of DZ families.
</p>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>References</h3>

<p>Schwabe, I. &amp; van den Berg, S.M. (2014). Assessing Genotype by Environment Interaction in Case of Heterogeneous Measurement Error, Behavior Genetics, 44 (4), 394-406.
</p>
<p>Schwabe, I., Jonker, W. &amp; van den Berg, S.M. (2016). Genes, Culture and Conservatism - A Psychometric-Genetic Approach, Behavior Genetics, 46 (4), 516-52.
</p>
<p>Schwabe, I., Boomsma, D.I. &amp; van den Berg, S.M. (2017). Increased Environmental Sensitivity in High Mathematics Performance. Learning and Individual Differences, 54, 196-201.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#100 MZ twins, 200 DZ twins, ACE model, no GxE, 1 PL: 
simulatetwin(n_mz = 100, n_dz = 200) 

## Not run: 
#500 MZ twins, 800 DZ twins, ACE model, no GxE, 1 PL: 
simulatetwin(n_mz = 500, n_dz = 800) 

#140 MZ twins, 360 DZ twins, ADE model, GPCM: 
simulatetwin(var_a = 0.4, var_d = 0.2, var_e = 0.4, 
             model = "ADE", irt_model = "GPCM")

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.bayestwin'>Summary statistics for BayesTwin analysis</h2><span id='topic+summary.bayestwin'></span><span id='topic+summarybayestwin'></span><span id='topic+summaryBayestwin'></span>

<h3>Description</h3>

<p><code>summary.bayestwin</code> produces summary statistics for variance components and, if applicable, regression parameters: The posterior point estimate and its standard deviation and the 95% HPD.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayestwin'
summary(object, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bayestwin_+3A_object">object</code></td>
<td>
<p>An object storing output from the main function <code>IRT_twin</code></p>
</td></tr>
<tr><td><code id="summary.bayestwin_+3A_...">...</code></td>
<td>
<p>Further arguments for the default S3 summary method</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Inga Schwabe</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(results)
summary(results)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
