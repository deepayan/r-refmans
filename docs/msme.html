<!DOCTYPE html><html><head><title>Help for package msme</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {msme}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alrt'>
<p>Function to compute asymptotic likelihood ratio test of two models.</p></a></li>
<li><a href='#doll'><p> Physician smoking and mortality count data</p></a></li>
<li><a href='#hatvalues.msme'>
<p>Function to return the hat matrix of a msme-class model.</p></a></li>
<li><a href='#heart'><p> Heart surgery outcomes for Canadian patients</p></a></li>
<li><a href='#irls'>
<p>Function to fit generalized linear models using IRLS.</p></a></li>
<li><a href='#medpar'>
<p>US national Medicare inpatient hospital database for Arizona patients.</p></a></li>
<li><a href='#ml_g'>
<p>Function to fit linear regression using maximum likelihood.</p></a></li>
<li><a href='#ml_glm'>
<p>A function to fit generalized linear models using maximum likelihood.</p></a></li>
<li><a href='#ml_glm2'>
<p>A function to fit generalized linear models using maximum likelihood.</p></a></li>
<li><a href='#ml_glm3'>
<p>A reduced maximum likelihood fitting function that omits null models.</p></a></li>
<li><a href='#nbinomial'>
<p>A function to fit negative binomial generalized linear models using maximum likelihood.</p></a></li>
<li><a href='#P__disp'><p>A function to calculate Pearson Chi2 and its dispersion statistic following glm and glm.nb.</p></a></li>
<li><a href='#plot.ml_g_fit'><p>A plot method for objects of class ml_g_fit.</p></a></li>
<li><a href='#residuals.msme'>
<p>Function to produce residuals from a model of class msme.</p></a></li>
<li><a href='#rwm5yr'>
<p>German health registry for the years 1984-1988</p></a></li>
<li><a href='#summary.ml_g_fit'>
<p>A summary method for objects of class ml_g_fit.</p></a></li>
<li><a href='#summary.msme'>
<p>A summary method for objects of class msme.</p></a></li>
<li><a href='#titanic'>
<p>Titanic passenger survival data</p></a></li>
<li><a href='#ufc'><p> Upper Flat Creek forest cruise tree data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions and Datasets for "Methods of Statistical Model
Estimation"</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Hilbe and Andrew Robinson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Robinson &lt;apro@unimelb.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), MASS, lattice</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions and datasets from Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model Estimation. Chapman &amp; Hall / CRC.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-18 20:13:05 UTC; andrewpr</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-18 22:31:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='alrt'>
Function to compute asymptotic likelihood ratio test of two models.
</h2><span id='topic+alrt'></span>

<h3>Description</h3>

<p>This function computes the asymptotic likelihood ratio test of two
models by comparing twice the different in the log-likelihoods of the
models with the Chi-squared distribution with degrees of freedom equal
to the difference in the degrees of freedom of the models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alrt(x1, x2, boundary = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alrt_+3A_x1">x1</code></td>
<td>

<p>A fitted model as an object that logLik will work for.
</p>
</td></tr>
<tr><td><code id="alrt_+3A_x2">x2</code></td>
<td>

<p>A fitted model as an object that logLik will work for.
</p>
</td></tr>
<tr><td><code id="alrt_+3A_boundary">boundary</code></td>
<td>

<p>A flag that reports whether a boundary correction should be made.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out.tab</code></td>
<td>
<p>A data frame that summarizes the test.</p>
</td></tr>
<tr><td><code>jll.diff</code></td>
<td>
<p>The difference between the log-likelihoods.</p>
</td></tr>
<tr><td><code>df.diff</code></td>
<td>
<p>The difference between the degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value of the statistical test of the null
hypothesis that there is no difference between the fit of the models.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function does not provide any checks for nesting, data equivalence,
etc.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ml_glm">ml_glm</a></code>, <code><a href="#topic+ml_glm2">ml_glm2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

ml.poi.1 &lt;- ml_glm(los ~ hmo + white,
                   family = "poisson",
                   link = "log",
                   data = medpar)

ml.poi.2 &lt;- ml_glm(los ~ hmo,
                   family = "poisson",
                   link = "log",
                   data = medpar)

alrt(ml.poi.1, ml.poi.2)

</code></pre>

<hr>
<h2 id='doll'> Physician smoking and mortality count data </h2><span id='topic+doll'></span>

<h3>Description</h3>

<p>The data are a record of physician smoking habits and the frequency of
death by myocardial infarction, or heart attack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(doll)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following variables.
</p>

<dl>
<dt>age</dt><dd><p>Ordinal age group</p>
</dd>
<dt>smokes</dt><dd><p>smoking status</p>
</dd>
<dt>deaths</dt><dd><p>count of deaths in category</p>
</dd>
<dt>pyears</dt><dd><p>number of physisian years in scope of data</p>
</dd>
<dt>a1</dt><dd><p>Dummy variable for age level 1</p>
</dd>
<dt>a2</dt><dd><p>Dummy variable for age level 2</p>
</dd>
<dt>a3</dt><dd><p>Dummy variable for age level 3</p>
</dd>
<dt>a4</dt><dd><p>Dummy variable for age level 4</p>
</dd>
<dt>a5</dt><dd><p>Dummy variable for age level 5</p>
</dd>
</dl>



<h3>Details</h3>

<p>The physicians were divided into five age divisions, with deaths as the
response, person years (pyears) as the binomial denominator, and both
smoking behavior (smokes) and agegroup (a1&ndash;a5) as predictors. 
</p>


<h3>Source</h3>

<p>Doll, R and A.B.Hill (1966). Mortality of British doctors in relation to
smoking; observations on coronary thrombosis. In Epidemiological
Approaches to the Study of Cancer and Other Chronic Diseases,
W. Haenszel (ed), 19: 204&ndash;268. National Cancer Institute Monograph.
</p>


<h3>References</h3>

<p>Hilbe, J., and A.P. Robinson. 2012.  Methods of Statistical Model
Estimation.  Chapman &amp; Hall / CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(doll)

i.glog &lt;- irls(deaths ~ smokes + ordered(age),
               family = "binomial",
               link = "logit",
               data = doll,
               m = doll$pyears)
summary(i.glog)

glm.glog &lt;- glm(cbind(deaths, pyears - deaths) ~ 
                smokes + ordered(age),
                data = doll,
                family = binomial)
coef(summary(glm.glog))


</code></pre>

<hr>
<h2 id='hatvalues.msme'>
Function to return the hat matrix of a msme-class model.
</h2><span id='topic+hatvalues.msme'></span>

<h3>Description</h3>

<p>This function uses QR decomposition to determine the hat matrix of a
model given its design matrix X.  It is specific to objects of class msme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'msme'
hatvalues(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hatvalues.msme_+3A_model">model</code></td>
<td>

<p>A fitted model of class msme.
</p>
</td></tr>
<tr><td><code id="hatvalues.msme_+3A_...">...</code></td>
<td>

<p>other arguments, retained for compatibility with generic method.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n*n matrix of hat values, where n is the number of observations used
to fit the model.  Needed to standardize the residuals.
</p>


<h3>Note</h3>

<p>Leverages can be obtained as the diagonal of the output.  See the examples.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hatvalues">hatvalues</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

ml.poi &lt;- ml_glm(los ~ hmo + white,
                 family = "poisson",
                 link = "log",
                 data = medpar)

str(diag(hatvalues(ml.poi)))

</code></pre>

<hr>
<h2 id='heart'> Heart surgery outcomes for Canadian patients </h2><span id='topic+heart'></span>

<h3>Description</h3>

<p> The data consists of Canadian patients who have
either a Coronary Artery Bypass Graft surgery (CABG) or Percutaneous
Transluminal Coronary Angioplasty (PTCA) heart procedure.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heart)</code></pre>


<h3>Format</h3>

<p>A grouped binomial data frame with 15 observations.
</p>

<dl>
<dt>death</dt><dd><p>number of patients that died within 48 hours of
hospital admission</p>
</dd>
<dt>cases</dt><dd><p>number of patients monitored</p>
</dd>
<dt>anterior</dt><dd><p>1: anterior site damage heart attack; 0: other site damage</p>
</dd>
<dt>hcabg</dt><dd><p>1: previous CABG procedure; 0: previous PTCA procedure;</p>
</dd>
<dt>killip</dt><dd><p>1: normal heart; 2: angina; 3: minor heart blockage;
4: heart attack or myocardial infarction;</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are presented as a grouped binomial dataset, with each row
representing a different combination of the predictor variables.
</p>


<h3>Source</h3>

<p>National Canadian Registry of Cardiovascular Disease
</p>


<h3>References</h3>

<p>Hilbe, Joseph M (2009), Logistic Regression Models, Chapman &amp; Hall/CRC
first used in Hardin, JW and JM Hilbe (2001, 2007), Generalized Linear Models and Extensions, Stata Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heart)

heart.nb &lt;- irls(death ~ anterior + hcabg + factor(killip),
                 a = 0.0001,
                 offset = log(heart$cases),
                 family = "negBinomial", link = "log",
                 data = heart)

</code></pre>

<hr>
<h2 id='irls'>
Function to fit generalized linear models using IRLS.
</h2><span id='topic+irls'></span>

<h3>Description</h3>

<p>This function fits a wide range of generalized linear models using the
iteratively reweighted least squares algorithm.  The intended benefit
of this function is for teaching.  Its scope is similar to that of R's
glm function, which should be preferred for operational use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>irls(formula, data, family, link, tol = 1e-06, offset = 0, m = 1, a = 1, verbose = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="irls_+3A_formula">formula</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="irls_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
<tr><td><code id="irls_+3A_family">family</code></td>
<td>

<p>a description of the error distribution be used in the model.
This must be a character string naming a family.
</p>
</td></tr>
<tr><td><code id="irls_+3A_link">link</code></td>
<td>

<p>a description of the link function be used in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="irls_+3A_tol">tol</code></td>
<td>

<p>an optional quantity to use as the convergence criterion for the
change in deviance.
</p>
</td></tr>
<tr><td><code id="irls_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be 0 or a numeric vector of length equal to the
number of cases. 
</p>
</td></tr>
<tr><td><code id="irls_+3A_m">m</code></td>
<td>

<p>the number of cases per observation for binomial regression.
</p>
</td></tr>
<tr><td><code id="irls_+3A_a">a</code></td>
<td>

<p>the scale for negative binomial regression.
</p>
</td></tr>
<tr><td><code id="irls_+3A_verbose">verbose</code></td>
<td>

<p>a flag to control the amount of output printed by the function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The containing package, msme, provides the needed functions to
use the irls function to fit the Poisson, negative binomial (2),
Bernoulli, and binomial families, and supports the use of the
identity, log, logit, probit, complementary log-log, inverse,
inverse^2, and negative binomial link functions.  All statistics are
computed at the final iteration of the IRLS algorithm. The convergence
criterion is the magnitude of the change in deviance. The object
returned by the function is designed to be reported by the print.glm
function.  </p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>standard errors of parameter estimates.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the final, weighted linear model.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function call used to create the object.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>the linear predictor at the final iteration.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the estimated mean at the final iteration.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the residual deviance.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>a place-holder for the null deviance - returned as NA</p>
</td></tr>
<tr><td><code>p.dispersion</code></td>
<td>
<p>Pearsons's Chi-squared statistic.</p>
</td></tr>
<tr><td><code>pearson</code></td>
<td>
<p>Pearson's deviance.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the maximized log-likelihood.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the chosen family.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>i</code></td>
<td>
<p>the number of iterations required for convergence.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the deviance residuals.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criterion.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+ml_glm">ml_glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

irls.poi &lt;- irls(los ~ hmo + white,
                 family = "poisson",
                 link = "log",
                 data = medpar)
summary(irls.poi)

irls.probit &lt;- irls(died ~ hmo + white,
                    family = "binomial",
                    link = "probit",
                    data = medpar)
summary(irls.probit)

</code></pre>

<hr>
<h2 id='medpar'>
US national Medicare inpatient hospital database for Arizona patients.
</h2><span id='topic+medpar'></span>

<h3>Description</h3>


<p>hospital database is referred to as the Medpar data, which is prepared
yearly from hospital filing records. Medpar files for each state are
also prepared. The full Medpar data consists of 115 variables. The
national Medpar has some 14 million records, with one record for each
hospilitiztion. The data in the medpar file comes from 1991 Medicare
files for the state of Arizona. The data are limited to only one
diagnostic group (DRG 112). Patient data have been randomly selected
from the original data.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(medpar)</code></pre>


<h3>Format</h3>

<p>A data frame with 1495 observations on the following 10 variables.
</p>

<dl>
<dt><code>los</code></dt><dd><p>length of hospital stay</p>
</dd>
<dt><code>hmo</code></dt><dd><p>Patient belongs to a Health Maintenance Organization, binary</p>
</dd>
<dt><code>white</code></dt><dd><p>Patient identifies themselves as Caucasian, binary</p>
</dd>
<dt><code>died</code></dt><dd><p>Patient died, binary</p>
</dd>
<dt><code>age80</code></dt><dd><p>Patient age 80 and over, binary</p>
</dd>
<dt><code>type</code></dt><dd><p>Type of admission, categorical</p>
</dd>
<dt><code>type1</code></dt><dd><p>Elective admission, binary</p>
</dd>
<dt><code>type2</code></dt><dd><p>Urgent admission,binary</p>
</dd>
<dt><code>type3</code></dt><dd><p>Elective admission, binary</p>
</dd>
<dt><code>provnum</code></dt><dd><p>Provider ID</p>
</dd>
</dl>



<h3>Details</h3>


<p>Medpar is saved as a data frame.
Count models use los as response variable. 0 counts are structurally excluded  
</p>


<h3>Source</h3>


<p>1991 National Medpar data, National Health Economics &amp; Research Co.
</p>


<h3>References</h3>

<p>Hilbe, Joseph M (2007, 2011), Negative Binomial Regression, Cambridge University Press
Hilbe, Joseph M (2009), Logistic Regression Models, Chapman &amp; Hall/CRC
first used in Hardin, JW and JM Hilbe (2001, 2007), Generalized Linear Models and Extensions, Stata Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)
glmp &lt;- glm(los ~ hmo + white + factor(type),
            family = poisson, data = medpar)
summary(glmp)
exp(coef(glmp))

ml.p &lt;- ml_glm(los ~ hmo + white + factor(type),
               family = "poisson",
               link = "log",
               data = medpar)

summary(ml.p)

library(MASS)
glmnb &lt;- glm.nb(los ~ hmo + white + factor(type),
                data = medpar)
summary(glmnb)
exp(coef(glmnb))

</code></pre>

<hr>
<h2 id='ml_g'>
Function to fit linear regression using maximum likelihood.
</h2><span id='topic+ml_g'></span>

<h3>Description</h3>

<p>This function demonstrates the use of maximum likelihood to fit ordinary
least-squares regression models, by maximizing the likelihood as a
function of the parameters.  Only conditional normal errors are supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ml_g(formula, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ml_g_+3A_formula">formula</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the model to be
fitted. (See the help for 'lm' for more details). 
</p>
</td></tr>
<tr><td><code id="ml_g_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has limited functionality compared with
R's internal lm function, which should be preferred in general.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>the output of optim.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used for the function.</p>
</td></tr>
<tr><td><code>beta.hat</code></td>
<td>
<p>the parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>estimated standard errors of the parameter estimates.</p>
</td></tr>
<tr><td><code>sigma.hat</code></td>
<td>
<p>the estimated conditional standard deviation of the
response variable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>We use least squares to get initial estimates, which is a
pretty barbaric hack.  But the purpose of this function is as a
starting point, not to replace existing functions.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman \&amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ufc)
ufc &lt;- na.omit(ufc)

ufc.g.reg &lt;- ml_g(height.m ~ dbh.cm, data = ufc)

summary(ufc.g.reg)

</code></pre>

<hr>
<h2 id='ml_glm'>
A function to fit generalized linear models using maximum likelihood.
</h2><span id='topic+ml_glm'></span>

<h3>Description</h3>

<p>This function fits generalized linear models by maximizing the joint
log-likeliood, which is set in a separate function.  Only single-parameter
members of the exponential family are covered.
The post-estimation
output is designed to work with existing reporting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ml_glm(formula, data, family, link, offset = 0, start = NULL, verbose =
FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ml_glm_+3A_formula">formula</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_family">family</code></td>
<td>

<p>a description of the error distribution be used in the model.
This must be a character string naming a family.
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_link">link</code></td>
<td>

<p>a description of the link function be used in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be 0 or a numeric vector of length equal to the
number of cases. 
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_start">start</code></td>
<td>

<p>optional starting points for the parameter estimation. 
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_verbose">verbose</code></td>
<td>

<p>logical flag affecting the detail of printing.  Defaults to FALSE.
</p>
</td></tr>
<tr><td><code id="ml_glm_+3A_...">...</code></td>
<td>

<p>optional arguments to pass within the function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The containing package, msme, provides the needed functions to
use the ml_glm function to fit the Poisson and
Bernoulli families, and supports the use of the
identity, log, logit, probit, and complementary log-log link functions. 
The object returned by the function is designed to be reported by the
print.glm function. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>the output of optim.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used for the function.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the residual deviance.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the residual deviance for the null model.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the deviance residuals.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>standard errors of parameter estimates.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criterion.</p>
</td></tr>
<tr><td><code>i</code></td>
<td>
<p>the number of iterations required for convergence.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is neither as comprehensive nor as stable as the inbuilt
glm function.  It is a lot easier to read, however.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+irls">irls</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+ml_glm2">ml_glm2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

ml.poi &lt;- ml_glm(los ~ hmo + white,
                 family = "poisson",
                 link = "log",
                 data = medpar)
ml.poi
summary(ml.poi)

</code></pre>

<hr>
<h2 id='ml_glm2'>
A function to fit generalized linear models using maximum likelihood.
</h2><span id='topic+ml_glm2'></span>

<h3>Description</h3>

<p>This function fits generalized linear models by maximizing the joint
log-likeliood, which is set in a separate function.  Two-parameter
members of the exponential family are covered. The post-estimation
output is designed to work with existing reporting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ml_glm2(formula1, formula2 = ~1, data, family, mean.link, scale.link,
        offset = 0, start = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ml_glm2_+3A_formula1">formula1</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the mean function for the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_formula2">formula2</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the scale function for the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_family">family</code></td>
<td>

<p>a description of the error distribution be used in the model.
This must be a character string naming a family.
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_mean.link">mean.link</code></td>
<td>

<p>a description of the link function be used for the mean in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_scale.link">scale.link</code></td>
<td>

<p>a description of the link function be used for the scale in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be 0 or a numeric vector of length equal to the
number of cases. 
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_start">start</code></td>
<td>

<p>optional starting points for the parameter estimation. 
</p>
</td></tr>
<tr><td><code id="ml_glm2_+3A_verbose">verbose</code></td>
<td>

<p>logical flag affecting the detail of printing.  Defaults to FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The containing package, msme, provides the needed functions to
use the ml_glm2 function to fit the normal and negative binomial (2),
families, and supports the use of the
identity and log link functions. 
</p>
<p>The object returned by the function is designed to be reported by the
print.glm function. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>the output of optim.</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>the maximized log-likelihood.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the number of parameters estimated.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the rank of the design matrix for the mean function.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used for the function.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>estimated response variable.</p>
</td></tr>
<tr><td><code>linear.predictor</code></td>
<td>
<p>linear predictor.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>pearson</code></td>
<td>
<p>the Pearson Chi2.</p>
</td></tr>
<tr><td><code>null.pearson</code></td>
<td>
<p>the Pearson Chi2 for the null model.</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>the dispersion.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the residual deviance.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the residual deviance for the null model.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the deviance residuals.</p>
</td></tr>
<tr><td><code>presiduals</code></td>
<td>
<p>the Pearson residuals.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>standard errors of parameter estimates.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criterion.</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>the offset used.</p>
</td></tr>
<tr><td><code>i</code></td>
<td>
<p>the number of iterations required for convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+irls">irls</a></code>, <code><a href="#topic+ml_glm">ml_glm</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)
ml.nb2 &lt;- ml_glm2(los ~ hmo + white,
                    formula2 = ~1,
                    data = medpar,
                    family = "negBinomial",
                    mean.link = "log",
                    scale.link = "inverse_s")

data(ufc)

ufc &lt;- na.omit(ufc)
ml.g &lt;- ml_glm2(height.m ~ dbh.cm,
                formula2 = ~ dbh.cm,
                data = ufc,
                family = "normal",
                mean.link = "identity",
                scale.link = "log_s")

summary(ml.g)

</code></pre>

<hr>
<h2 id='ml_glm3'>
A reduced maximum likelihood fitting function that omits null models.
</h2><span id='topic+ml_glm3'></span>

<h3>Description</h3>

<p>This function fits generalized linear models by maximizing the joint
log-likeliood, which is set in a separate function. Null models 
are omitted from the fit.  The post-estimation
output is designed to work with existing reporting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ml_glm3(formula, data, family, link, offset = 0, start = NULL, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ml_glm3_+3A_formula">formula</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_family">family</code></td>
<td>

<p>a description of the error distribution be used in the model.
This must be a character string naming a family.
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_link">link</code></td>
<td>

<p>a description of the link function be used in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be 0 or a numeric vector of length equal to the
number of cases. 
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_start">start</code></td>
<td>

<p>optional starting points for the parameter estimation. 
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_verbose">verbose</code></td>
<td>

<p>logical flag affecting the detail of printing.  Defaults to FALSE.
</p>
</td></tr>
<tr><td><code id="ml_glm3_+3A_...">...</code></td>
<td>

<p>other arguments to pass to the likelihood function, e.g. group stucture.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is essentially the same as ml_glm, but includes the dots
argument to allow a richer set of model likelihoods to be fit, and
omits computation of the null deviance.  The function is presently set
up to only fit the conditional fixed-effects negative binomial model.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>the output of optim.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used for the function.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the residual deviance.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the residual deviance for the null model, set to
NA.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the deviance residuals.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>standard errors of parameter estimates.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criterion.</p>
</td></tr>
<tr><td><code>i</code></td>
<td>
<p>the number of iterations required for convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+irls">irls</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+ml_glm">ml_glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(medpar)
med.nb.g &lt;- ml_glm3(los ~ hmo + white,
                   family = "gNegBinomial", 
                   link = "log",
                   group = medpar$provnum, 
                   data = medpar)
summary(med.nb.g)

</code></pre>

<hr>
<h2 id='nbinomial'>
A function to fit negative binomial generalized linear models using maximum likelihood.
</h2><span id='topic+nbinomial'></span>

<h3>Description</h3>

<p>This function fits generalized linear models by maximizing the joint
log-likeliood, which is set in a separate function.  Two-parameter
members of the negative binomial family are covered. The post-estimation
output is designed to work with existing reporting functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbinomial(formula1, formula2 = ~1, data, family="nb2", mean.link="log",
          scale.link="inverse_s", offset=0, start=NULL, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbinomial_+3A_formula1">formula1</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the mean function for the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_formula2">formula2</code></td>
<td>

<p>an object of class '&quot;formula&quot;' (or one that can be coerced to
that class): a symbolic description of the scale function for the model to be
fitted. (See the help for 'glm' for more details). 
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables in the model. 
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_family">family</code></td>
<td>

<p>a description of the error distribution be used in the model.
This must be a character string naming a family.
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_mean.link">mean.link</code></td>
<td>

<p>a description of the link function be used for the mean in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_scale.link">scale.link</code></td>
<td>

<p>a description of the link function be used for the scale in the model.
This must be a character string naming a link function.
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_offset">offset</code></td>
<td>

<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be 0 or a numeric vector of length equal to the
number of cases. 
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_start">start</code></td>
<td>

<p>optional starting points for the parameter estimation. 
</p>
</td></tr>
<tr><td><code id="nbinomial_+3A_verbose">verbose</code></td>
<td>

<p>logical flag affecting the detail of printing.  Defaults to FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The containing package, msme, provides the needed functions to
use the nbinomial function to fit the negative binomial (2),
families, and supports the use of the
identity and log link functions. 
</p>
<p>The object returned by the function is designed to be reported by the
print.glm function. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>the output of optim.</p>
</td></tr>
<tr><td><code>loglike</code></td>
<td>
<p>the maximized log-likelihood.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the design matrix.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the number of parameters estimated.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the rank of the design matrix for the mean function.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used for the function.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>estimated response variable.</p>
</td></tr>
<tr><td><code>linear.predictor</code></td>
<td>
<p>linear predictor.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>pearson</code></td>
<td>
<p>the Pearson Chi2.</p>
</td></tr>
<tr><td><code>null.pearson</code></td>
<td>
<p>the Pearson Chi2 for the null model.</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>the dispersion.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the residual deviance.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the residual deviance for the null model.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the deviance residuals.</p>
</td></tr>
<tr><td><code>presiduals</code></td>
<td>
<p>the Pearson residuals.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates.</p>
</td></tr>
<tr><td><code>se.beta.hat</code></td>
<td>
<p>standard errors of parameter estimates.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike's Information Criterion.</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>the offset used.</p>
</td></tr>
<tr><td><code>i</code></td>
<td>
<p>the number of iterations required for convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+irls">irls</a></code>, <code><a href="#topic+ml_glm2">ml_glm2</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

# TRADITIONAL NB REGRESSION WITH ALPHA

mynb1 &lt;- nbinomial(los ~ hmo + white, data=medpar)
summary(mynb1)

# TRADITIONAL NB -- SHOWING ALL OPTIONS

mynb2 &lt;- nbinomial(los ~ hmo + white,
                    formula2 = ~ 1,
                    data = medpar,
                    family = "nb2",
                    mean.link = "log",
                    scale.link = "inverse_s")
summary(mynb2)

# R GLM.NB - LIKE INVERTED DISPERSION BASED M

mynb3 &lt;- nbinomial(los ~ hmo + white,
                    formula2 = ~ 1,
                    data = medpar,
                    family = "negBinomial",
                    mean.link = "log",
                    scale.link = "inverse_s")
summary(mynb3)

# R GLM.NB-TYPE INVERTED DISPERSON --THETA ; WITH DEFAULTS

mynb4 &lt;- nbinomial(los ~ hmo + white, family="negBinomial", data =medpar)
summary(mynb4)

# HETEROGENEOUS NB; DISPERSION PARAMETERIZED

mynb5 &lt;- nbinomial(los ~ hmo + white,
                    formula2 = ~ hmo + white,
                    data = medpar,
                    family = "negBinomial",
                    mean.link = "log",
                    scale.link = "log_s")
summary(mynb5)



</code></pre>

<hr>
<h2 id='P__disp'>A function to calculate Pearson Chi2 and its dispersion statistic following glm and glm.nb.</h2><span id='topic+P__disp'></span>

<h3>Description</h3>

 
<p>This function calculates Pearson Chi2 statistic and the
Pearson-based dipersion statistic. Values of the dispersion greater
than 1 indicate model overdispersion. Values under 1 indicate
under-dispersion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P__disp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P__disp_+3A_x">x</code></td>
<td>

<p>the fitted model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be used following glm and glm.nb functions. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>pearson.chi2</code></td>
<td>
<p>Pearson Chi2 value.</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>Pearson-basde dispersion.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joseph Hilbe and Andrew Robinson
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model Estimation. Chapman &amp; Hall / CRC. 
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)
mymod &lt;- glm(los ~ hmo + white + factor(type), 
             family = poisson, 
             data = medpar)
P__disp(mymod)
</code></pre>

<hr>
<h2 id='plot.ml_g_fit'>A plot method for objects of class ml_g_fit.</h2><span id='topic+plot.ml_g_fit'></span>

<h3>Description</h3>

<p>This function provides a four-way plot for fitted models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ml_g_fit'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ml_g_fit_+3A_x">x</code></td>
<td>

<p>the fitted model.
</p>
</td></tr>
<tr><td><code id="plot.ml_g_fit_+3A_...">...</code></td>
<td>

<p>other arguments, retained for compatibility with generic method.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots a summary.  The output is structured to broadly
match the default options of the plot.lm function.
</p>


<h3>Value</h3>

<p>Run for its side effect of producing a plot object.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ml_g">ml_g</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ufc)
ufc &lt;- na.omit(ufc)

ufc.g.reg &lt;- ml_g(height.m ~ dbh.cm, data = ufc)

plot(ufc.g.reg)

</code></pre>

<hr>
<h2 id='residuals.msme'>
Function to produce residuals from a model of class msme.
</h2><span id='topic+residuals.msme'></span>

<h3>Description</h3>

<p>Function to produce deviance and standardized deviance residuals
from a model of class msme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'msme'
residuals(object, type = c("deviance", "standard"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.msme_+3A_object">object</code></td>
<td>

<p>a model of class msme.
</p>
</td></tr>
<tr><td><code id="residuals.msme_+3A_type">type</code></td>
<td>

<p>the type of residual requested.  Defaults to deviance.
</p>
</td></tr>
<tr><td><code id="residuals.msme_+3A_...">...</code></td>
<td>

<p>arguments to pass on.  Retained for compatibility with generic method.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Presently only deviance or standardized deviance residuals are computed.
</p>


<h3>Value</h3>

<p>A vector of residuals.
</p>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medpar)

ml.poi &lt;- ml_glm(los ~ hmo + white,
                 family = "poisson",
                 link = "log",
                 data = medpar)

str(residuals(ml.poi))

</code></pre>

<hr>
<h2 id='rwm5yr'>
German health registry for the years 1984-1988
</h2><span id='topic+rwm5yr'></span>

<h3>Description</h3>


<p>German health registry for the years 1984-1988. Health 
information for years immediately prior to health reform. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rwm5yr)</code></pre>


<h3>Format</h3>

<p>A data frame with 19,609 observations on the following 17 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient ID  (1=7028)</p>
</dd>
<dt><code>docvis</code></dt><dd><p>number of visits to doctor during year (0-121)</p>
</dd>
<dt><code>hospvis</code></dt><dd><p>number of days in hospital during year (0-51)</p>
</dd>
<dt><code>year</code></dt><dd><p>year; (categorical: 1984, 1985, 1986, 1987, 1988)</p>
</dd>
<dt><code>edlevel</code></dt><dd><p>educational level (categorical: 1-4)</p>
</dd>
<dt><code>age</code></dt><dd><p>age: 25-64</p>
</dd>
<dt><code>outwork</code></dt><dd><p>out of work=1; 0=working</p>
</dd>
<dt><code>female</code></dt><dd><p>female=1; 0=male</p>
</dd>
<dt><code>married</code></dt><dd><p>married=1; 0=not married</p>
</dd>
<dt><code>kids</code></dt><dd><p>have children=1; no children=0</p>
</dd>
<dt><code>hhninc</code></dt><dd><p>household yearly income in marks (in Marks)</p>
</dd>
<dt><code>educ</code></dt><dd><p>years of formal education (7-18)</p>
</dd>
<dt><code>self</code></dt><dd><p>self-employed=1; not self employed=0</p>
</dd>
<dt><code>edlevel1</code></dt><dd><p>(1/0) not high school graduate</p>
</dd>
<dt><code>edlevel2</code></dt><dd><p>(1/0) high school graduate</p>
</dd>
<dt><code>edlevel3</code></dt><dd><p>(1/0) university/college</p>
</dd> 
<dt><code>edlevel4</code></dt><dd><p>(1/0) graduate school</p>
</dd>
</dl>



<h3>Details</h3>


<p>rwm5yr is saved as a data frame.
Count models typically use docvis as response variable. 0 counts are included
</p>


<h3>Source</h3>


<p>German Health Reform Registry, years pre-reform 1984-1988, 
</p>


<h3>References</h3>


<p>Hilbe, Joseph M (2007, 2011), Negative Binomial Regression, Cambridge University Press
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rwm5yr)

glmrp &lt;- glm(docvis ~ outwork + female + age + factor(edlevel),
             family = poisson, data = rwm5yr)
summary(glmrp)
exp(coef(glmrp))

ml_p &lt;- ml_glm(docvis ~ outwork + female + age + factor(edlevel),
               family = "poisson",
               link = "log",
               data = rwm5yr)
summary(ml_p)
exp(coef(ml_p))


library(MASS)
glmrnb &lt;- glm.nb(docvis ~ outwork + female + age + factor(edlevel),
                 data = rwm5yr)
summary(glmrnb)
exp(coef(glmrnb))
## Not run: 
library(gee)
mygee &lt;- gee(docvis ~ outwork + age + factor(edlevel), id=id, 
  corstr = "exchangeable", family=poisson, data=rwm5yr)
summary(mygee)
exp(coef(mygee))

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.ml_g_fit'>
A summary method for objects of class ml_g_fit.
</h2><span id='topic+summary.ml_g_fit'></span>

<h3>Description</h3>

<p>This function provides a compact summary for fitted models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ml_g_fit'
summary(object, dig = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ml_g_fit_+3A_object">object</code></td>
<td>

<p>the fitted model.
</p>
</td></tr>
<tr><td><code id="summary.ml_g_fit_+3A_dig">dig</code></td>
<td>

<p>an optional integer detailing the number of significant digits for
printing. 
</p>
</td></tr>
<tr><td><code id="summary.ml_g_fit_+3A_...">...</code></td>
<td>

<p>other arguments, retained for compatibility with generic method.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints out a summary and returns an invisible list with
useful objects.  The output is structured to match the print.summary.lm
function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>call</code></td>
<td>
<p>the call used to fit the model.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a dataframe of estimates, standard errors, etc.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>deviance residuals from the model.</p>
</td></tr>
<tr><td><code>aliased</code></td>
<td>
<p>included to match the print.summary.lm function.  Lazily
set to FALSE for all parameters.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the estimate of the conditional standard deviation of the
response variable.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ml_g">ml_g</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ufc)
ufc &lt;- na.omit(ufc)

ufc.g.reg &lt;- ml_g(height.m ~ dbh.cm, data = ufc)

summary(ufc.g.reg)

</code></pre>

<hr>
<h2 id='summary.msme'>
A summary method for objects of class msme.
</h2><span id='topic+summary.msme'></span>

<h3>Description</h3>

<p>This function provides a compact summary for fitted models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'msme'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.msme_+3A_object">object</code></td>
<td>

<p>the fitted model.
</p>
</td></tr>
<tr><td><code id="summary.msme_+3A_...">...</code></td>
<td>

<p>optional arguments to be passed through.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints out a summary and returns an invisible list with
useful objects.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>call</code></td>
<td>
<p>the call used to fit the model.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a dataframe of estimates, standard errors, etc.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>deviance from the model fit.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>deviance from the null model fit.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom from the model fit.</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>residual degrees of freedom from the null model fit.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Robinson and Joe Hilbe.
</p>


<h3>References</h3>

<p>Hilbe, J.M., and Robinson, A.P. 2013. Methods of Statistical Model
Estimation. Chapman &amp; Hall / CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(medpar)

ml.poi &lt;- ml_glm(los ~ hmo + white,
                 family = "poisson",
                 link = "log",
                 data = medpar)

summary(ml.poi)


</code></pre>

<hr>
<h2 id='titanic'>
Titanic passenger survival data
</h2><span id='topic+titanic'></span>

<h3>Description</h3>


<p>Passenger survival data from 1912 Titanic shipping accident. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(titanic)</code></pre>


<h3>Format</h3>

<p>A data frame with 1316 observations on the following 4 variables.
</p>

<dl>
<dt><code>survived</code></dt><dd><p>1=survived; 0=died</p>
</dd>
<dt><code>age</code></dt><dd><p>1=adult; 0=child</p>
</dd>
<dt><code>sex</code></dt><dd><p>1=Male; 0=female</p>
</dd>
<dt><code>class</code></dt><dd><p>ticket class 1= 1st class; 2= second class; 3= third class</p>
</dd>
</dl>



<h3>Details</h3>


<p>Titanic is saved as a data frame.
Used to assess risk ratio; not stardard count model; good binary response model.  
</p>


<h3>Source</h3>


<p>Found in many other texts
</p>


<h3>References</h3>


<p>Hilbe, Joseph M (2007, 2011), Negative Binomial Regression, Cambridge University Press
Hilbe, Joseph M (2009), Logistic Regression Models, Chapman &amp; Hall/CRC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(titanic)

glm.lr &lt;- glm(survived ~ age + sex + factor(class),
             family=binomial, data=titanic)
summary(glm.lr)
exp(coef(glm.lr))

glm.irls &lt;- irls(survived ~ age + sex + factor(class),
                 family = "binomial",
                 link = "cloglog",
                 data = titanic)
summary(glm.irls)
exp(coef(glm.irls))

glm.ml &lt;- ml_glm(survived ~ age + sex + factor(class),
                 family = "bernoulli",
                 link = "cloglog1",
                 data = titanic)
summary(glm.ml)
exp(coef(glm.ml))

</code></pre>

<hr>
<h2 id='ufc'> Upper Flat Creek forest cruise tree data </h2><span id='topic+ufc'></span>

<h3>Description</h3>

<p>These are a subset of the tree measurement data from the
Upper Flat Creek unit of the University of Idaho Experimental
Forest, which was measured in 1991. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ufc)</code></pre>


<h3>Format</h3>

<p>A data frame with 336 observations on the following 5 variables.
</p>

<dl>
<dt>plot</dt><dd><p>plot label</p>
</dd>
<dt>tree</dt><dd><p>tree label</p>
</dd>
<dt>species</dt><dd><p>species kbd with levels <kbd>DF</kbd>, <kbd>GF</kbd>, <kbd>WC</kbd>, <kbd>WL</kbd></p>
</dd>
<dt>dbh.cm</dt><dd><p>tree diameter at 1.37 m. from the ground, measured in
centimetres.</p>
</dd>
<dt>height.m</dt><dd><p>tree height measured in metres</p>
</dd>
</dl>



<h3>Details</h3>

<p>The inventory was based on variable radius plots with 6.43 sq. m.
per ha. BAF (Basal Area Factor).  The forest stand was 121.5 ha.
This version of the data omits errors, trees with missing heights,
and uncommon species.  The four species are Douglas-fir, grand fir,
western red cedar, and western larch.
</p>


<h3>Source</h3>

<p>The data are provided courtesy of Harold Osborne and Ross
Appelgren of the University of Idaho Experimental Forest. 
</p>


<h3>References</h3>

<p>Robinson, A.P., and J.D. Hamann. 2010.  Forest Analytics with R: an
Introduction. Springer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ufc)

ufc &lt;- na.omit(ufc)
ml.g &lt;- ml_glm2(height.m ~ dbh.cm,
                formula2 = ~1,
                data = ufc,
                family = "normal",
                mean.link = "identity",
                scale.link = "log_s")

lm.g &lt;- lm(height.m ~ dbh.cm,
                data = ufc)
                
ml.g
lm.g

summary(ml.g)
summary(lm.g)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
