<!DOCTYPE html><html lang="en"><head><title>Help for package cplots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cplots}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cbarplot'><p>Circular Bar Plot</p></a></li>
<li><a href='#cdensity'><p>Circular Density Curve</p></a></li>
<li><a href='#cdotplot'><p>Circular Stacked Dot Plot</p></a></li>
<li><a href='#chist'><p>Circular Histogram and Rose Diagram</p></a></li>
<li><a href='#circtrans'><p>Circular Transformation Formula</p></a></li>
<li><a href='#cmdensity'><p>Multi-class Circular Density Curve</p></a></li>
<li><a href='#cmhist'><p>Multi-class Stacked Circular Histogram and Rose Diagram</p></a></li>
<li><a href='#scalefactor'><p>Scaling Factor</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Plots for Circular Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-18</td>
</tr>
<tr>
<td>Imports:</td>
<td>circular, grDevices, graphics, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to produce some circular plots for circular data, in a height- or area-proportional manner. They include bar plots, smooth density plots, stacked dot plots, histograms, multi-class stacked smooth density plots, and multi-class stacked histograms. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-24 02:02:55 UTC; ywan076</td>
</tr>
<tr>
<td>Author:</td>
<td>Danli Xu [aut],
  Yong Wang [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yong Wang &lt;yongwang@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-24 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cbarplot'>Circular Bar Plot</h2><span id='topic+cbarplot'></span>

<h3>Description</h3>

<p>Function <code>cbarplot</code> can be used to plot 2-dimensional 
circular bar plots. The circular bar plots can only adopt the 
height-proportional transformation because of the white space between bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbarplot(
  x,
  nbins = 36,
  radius = 1/sqrt(base::pi),
  prob = TRUE,
  nlabels = 4,
  col = NULL,
  border = NULL,
  m = NA,
  xlim = NULL,
  ylim = NULL,
  main = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cbarplot_+3A_x">x</code></td>
<td>
<p>a numeric vector storing angular values between 0 and 2 pi, or
an object that can be coerced to.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins of the circular bar plot. Internally, it
is rounded to a multiple of 4.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_prob">prob</code></td>
<td>
<p>logical; if <code>TRUE</code>, the circular histogram graphic is a
representation of probability densities; if <code>FALSE</code>, a
representation of frequencies.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_nlabels">nlabels</code></td>
<td>
<p>integer, for the number of levels to be plotted; if
<code>0</code>, no label is plotted</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_col">col</code></td>
<td>
<p>the color to fill the bars.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_m">m</code></td>
<td>
<p>the number of points within each bin to plot the top of a
bar. The larger the number is, the smoother the plot looks.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cbarplot_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdensity">cdensity</a></code>, <code><a href="#topic+cdotplot">cdotplot</a></code>, <code><a href="#topic+chist">chist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 600 observations from two von Mises distributions
library(circular)
x = c(rvonmises(200, circular(pi/4), 5), rvonmises(400, circular(pi), 20))

cbarplot(x)                     
cbarplot(x, prob=FALSE)
cbarplot(x, radius=1, nlabels=0, col="lightblue")
cbarplot(x, radius=1, col="lightblue", border="skyblue4")

</code></pre>

<hr>
<h2 id='cdensity'>Circular Density Curve</h2><span id='topic+cdensity'></span>

<h3>Description</h3>

<p>Function <code>cdensity</code> can be used to plot 2-dimensional 
density curves for circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdensity(
  f,
  radius = 1/sqrt(base::pi),
  area.prop = TRUE,
  total.area = 1,
  nlabels = 4,
  add = FALSE,
  n = 500,
  col = "red",
  xlim = NULL,
  ylim = NULL,
  main = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdensity_+3A_f">f</code></td>
<td>
<p>an R function that is to be plotted as a circular density or
frequency.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle. If <code>radius = 0</code>,
no reference circle is produced, and the centre presents the point
with zero density.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformation is applied.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area under the
density curve. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_nlabels">nlabels</code></td>
<td>
<p>integer, for the number of levels to be plotted; if
<code>0</code>, no label is plotted.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_add">add</code></td>
<td>
<p>logical; if <code>TRUE</code>, the density curve is superimposed to
the current plot, for example, a circular histogram, a rose diagram or
a stacked dot plot that has been produced in a similar manner.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_n">n</code></td>
<td>
<p>the number of points to plot the density curve.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_col">col</code></td>
<td>
<p>the color of the density line.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cdensity_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cbarplot">cbarplot</a></code>, <code><a href="#topic+cdotplot">cdotplot</a></code>, <code><a href="#topic+chist">chist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 600 observations from two von Mises distributions
library(circular)
x = c(rvonmises(200, circular(pi/4), 5), rvonmises(400, circular(pi), 20))
dvm = function(x, mu=0, kappa=1)   # von Mises density
  exp(kappa * cos(x - mu)) * (2 * pi * besselI(kappa, 0))^(-1)
f = function(x) 1/3 * dvm(x, pi/4, 5) + 2/3 * dvm(x, pi, 20)

cdensity(f)                # plot the density in an area-proportional manner

chist(x)                   # circular histogram
cdensity(f, add=TRUE)      # superimpose the density curve
chist(x, area=FALSE)       # height-proportional circular histogram
cdensity(f, area=FALSE, add=TRUE)   # superimpose the density curve

chist(x, radius=0)                          # rose diagrams
cdensity(f, radius=0, add=TRUE)
chist(x, radius=0, area=FALSE)
cdensity(f, radius=0, area=FALSE, add=TRUE)

</code></pre>

<hr>
<h2 id='cdotplot'>Circular Stacked Dot Plot</h2><span id='topic+cdotplot'></span>

<h3>Description</h3>

<p>Function <code>cdotplot</code> can be used to plot 2-dimensional 
stacked dot plot for circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdotplot(
  x,
  nbins = 36,
  radius = 1,
  unit = NA,
  area.prop = TRUE,
  total.area = 1,
  m = NA,
  col = "lightblue",
  border = "skyblue4",
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  x.legend = "bottomright",
  y.legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdotplot_+3A_x">x</code></td>
<td>
<p>a circular data object that is fully defined by the user.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins of the circular histogram.  Internally,
it is rounded to a multiple of 4.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.  If <code>radius = 0</code>,
a rose diagram is produced; if <code>radius &gt; 0</code>, a circular histogram
is produced outside the reference circle.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_unit">unit</code></td>
<td>
<p>the number of observations represented by each dot.  If
<code>unit &gt; 1</code>, it means that each dot represents multiple
observations.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area under the
density curve. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_m">m</code></td>
<td>
<p>the number of points within each bin to plot the circular dot
plot. The larger the number is, the smoother the plot looks.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_col">col</code></td>
<td>
<p>the color to fill the bars.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_x.legend">x.legend</code></td>
<td>
<p>x coordinate to plot the legend.</p>
</td></tr>
<tr><td><code id="cdotplot_+3A_y.legend">y.legend</code></td>
<td>
<p>y coordinate to plot the legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of observations is relatively small, the
usual circular stacked dot plot can be used with <code>unit = 1</code>.
If the dataset is large, the dots may become too dense to
visualize or count.  Setting <code>unit</code> to be any positive
integer to allow each dot to represent more than one observation.
If the number of observations in one bin is not a multiple of the
specified unit, a partial dot can be used to represent the
remainder at the top of the bin.
</p>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cbarplot">cbarplot</a></code>, <code><a href="#topic+cdensity">cdensity</a></code>, <code><a href="#topic+chist">chist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 30 observations from two von Mises distributions
library(circular)
x = c(rvonmises(10, circular(pi/4), 5), rvonmises(20, circular(pi), 20))
cdotplot(x)                 # area-proportional dot plot
cdotplot(x, area = FALSE)   # height-proportional dot plot

# 900 observations from two von Mises distributions
y = c(rvonmises(300, circular(pi/4), 5), rvonmises(600, circular(pi), 20))
cdotplot(y, nbins=76, unit = 10)      # area-proportional (partial) dot plot 
cdotplot(y, nbins=76, unit = 10, area = FALSE) # height-proportional

</code></pre>

<hr>
<h2 id='chist'>Circular Histogram and Rose Diagram</h2><span id='topic+chist'></span>

<h3>Description</h3>

<p>Function <code>chist</code> can be used to plot 2-dimensional 
histograms and rose diagrams for circular data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chist(
  x,
  nbins = 36,
  radius = 1/sqrt(base::pi),
  area.prop = TRUE,
  prob = TRUE,
  total.area = 1,
  nlabels = 4,
  col = "lightblue",
  border = "skyblue4",
  m = NA,
  xlim = NULL,
  ylim = NULL,
  main = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chist_+3A_x">x</code></td>
<td>
<p>a numeric vector storing angular values between 0 and 2 pi, or
an object that can be coerced to.</p>
</td></tr>
<tr><td><code id="chist_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins of the circular histogram.  Internally,
it is rounded to a multiple of 4.</p>
</td></tr>
<tr><td><code id="chist_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle. If <code>radius = 0</code>,
a rose diagram is produced; if <code>radius &gt; 0</code>, a circular histogram
is produced outside the reference circle.</p>
</td></tr>
<tr><td><code id="chist_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
<tr><td><code id="chist_+3A_prob">prob</code></td>
<td>
<p>logical; if <code>TRUE</code>, the circular histogram graphic is a
representation of probability densities; if <code>FALSE</code>, a
representation of frequencies.</p>
</td></tr>
<tr><td><code id="chist_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area under the
density curve. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td></tr>
<tr><td><code id="chist_+3A_nlabels">nlabels</code></td>
<td>
<p>integer, for the number of levels for the
density/frequency values to be plotted; if <code>0</code>, no label is
plotted</p>
</td></tr>
<tr><td><code id="chist_+3A_col">col</code></td>
<td>
<p>the color to fill the bars.</p>
</td></tr>
<tr><td><code id="chist_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.</p>
</td></tr>
<tr><td><code id="chist_+3A_m">m</code></td>
<td>
<p>the number of points within each bin to plot the circular
histogram. The larger the number is, the smoother the plot looks.</p>
</td></tr>
<tr><td><code id="chist_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="chist_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="chist_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cbarplot">cbarplot</a></code>, <code><a href="#topic+cdensity">cdensity</a></code>, <code><a href="#topic+cdotplot">cdotplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 600 observations from two von Mises distributions
library(circular)
x = c(rvonmises(200, circular(pi/4), 5), rvonmises(400, circular(pi), 20))

chist(x)                           # area-proportional circular histgram
chist(x, area = FALSE)             # height-proportional circular histgram
chist(x, radius=0)                 # area-proportional rose diagram
chist(x, radius=0, area=FALSE)     # height-proportional rose diagram

chist(x, prob=FALSE)               # labels for frequency
chist(x, nlabels=0)                # no label
chist(x, xlim=c(-1.7,1))           # use xlim
chist(x, area=FALSE, total=2)      # with scaling
chist(x, area=FALSE, total=NULL)   # without scaling

</code></pre>

<hr>
<h2 id='circtrans'>Circular Transformation Formula</h2><span id='topic+circtrans'></span>

<h3>Description</h3>

<p>The function performs circular transformation of density 
or frequency, in an area-proportional or height-proportional manner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circtrans(x, radius = 0, area.prop = TRUE, factor = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circtrans_+3A_x">x</code></td>
<td>
<p>a numeric vector storing angular values between 0 and 2 pi, or
an object that can be coerced to.</p>
</td></tr>
<tr><td><code id="circtrans_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.</p>
</td></tr>
<tr><td><code id="circtrans_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
<tr><td><code id="circtrans_+3A_factor">factor</code></td>
<td>
<p>a positive number representing the scale factor to scale the
entire plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector of the transformed values
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020) Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scalefactor">scalefactor</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(circular)
x = as.vector(rvonmises(20, circular(pi), 10))
circtrans(x)                            # area-proportional transformation
circtrans(x, area.prop = FALSE)         # height-proportional transformation
circtrans(x, factor = 2)                # with a scaling factor

</code></pre>

<hr>
<h2 id='cmdensity'>Multi-class Circular Density Curve</h2><span id='topic+cmdensity'></span>

<h3>Description</h3>

<p>Function <code>cmdensity</code> can be used to plot 2-dimensional 
density curves for circular data with multiple classes. The density curves 
are stacked to avoid any overlap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmdensity(
  funlist,
  funprop = 1,
  radius = 1/sqrt(base::pi),
  area.prop = TRUE,
  total.area = 1,
  n = 500,
  nlabels = 4,
  cols = NULL,
  borders = NULL,
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  type = c("null", "compass", "clock"),
  add = FALSE,
  x.legend = "bottomright",
  y.legend = NULL,
  fill = TRUE,
  lty = 1,
  lwd = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmdensity_+3A_funlist">funlist</code></td>
<td>
<p>a list of functions which can be used to calculate the
density values for each class, evaluated at given points defined by
the first argument of the functions. The set of points is a sequence
from <code class="reqn">0</code> to <code class="reqn">2\pi</code>, with length <code>n</code>.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_funprop">funprop</code></td>
<td>
<p>proportions for functions. It is 1 by default. A user can
choose different proportions for the functions so as to represent
different numbers of observations. If they do not add up to the number
of functions (k), it will be normalised so that <code>sum(classprop) =
k</code>.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area under all the
density curves. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_n">n</code></td>
<td>
<p>the number of points used to plot each density curve.  The
larger the number is, the more accurate the curve is.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_nlabels">nlabels</code></td>
<td>
<p>integer, for the number of levels to be plotted; if
<code>0</code>, no label is plotted.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_cols">cols</code></td>
<td>
<p>the colors to fill the area under each density curve, with
the same order as the class.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_borders">borders</code></td>
<td>
<p>the colors of the borders.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_type">type</code></td>
<td>
<p>the type of circular data, one of the values <code>"null"</code>,
<code>"compass"</code> or <code>"clock"</code>.  If <code>"null"</code>, no special
lables plotted for directions. If <code>"compass"</code>, the four cardinal
directions are printed inside the reference circle. If <code>"clock"</code>,
labels for 24 hours are printed inside the reference circle.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_add">add</code></td>
<td>
<p>logical; if <code>TRUE</code>, density curves are superimposed to
the current plot, for example, the circular histograms, rose diagrams
and stacked dot plots.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_x.legend">x.legend</code></td>
<td>
<p>x coordinate to plot the legend.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_y.legend">y.legend</code></td>
<td>
<p>y coordinate to plot the legend.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_fill">fill</code></td>
<td>
<p>logical. If <code>TRUEt</code>, fills the regions with colors
under/between the density curves. If <code>FALSE</code>, only the density
curves are plotted.</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_lty">lty</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="cmdensity_+3A_lwd">lwd</code></td>
<td>
<p>line width</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdensity">cdensity</a></code>, <code><a href="#topic+cmhist">cmhist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load and pre-process the dataset
library(circular)
data("pigeons", package = "circular")
x = pigeons[,2] / 180 * pi                  # bearing
y = pigeons[,1]                             # treatment
vs = split(x, factor(y, unique(y)))    # list of classified value
prop = sapply(vs, length) / length(x)  # proportion of each class

# Define the kde function for each class using von Mises kernels
dvm = function(x, mu=0, kappa=1)  # von Mises density
  exp(kappa * cos(x - mu)) * (2 * pi * besselI(kappa, 0))^(-1)
kdevm = function(x, x0, bw=0.3) 
  rowMeans(outer(x, x0, dvm, 0.5 / (1 - exp(-bw^2 / 2))))
fs = list(function(x) kdevm(x, x0=vs[[1]]),
          function(x) kdevm(x, x0=vs[[2]]),
          function(x) kdevm(x, x0=vs[[3]]))

# stacked density curves for 3 classes
cmdensity(fs)                         # 1:1:1
cmdensity(fs, prop)                   # using proportions for functions

</code></pre>

<hr>
<h2 id='cmhist'>Multi-class Stacked Circular Histogram and Rose Diagram</h2><span id='topic+cmhist'></span>

<h3>Description</h3>

<p>Function <code>cmhist</code> can be used to plot 2-dimensional 
histograms and rose diagrams for circular data with multiple classes. 
The histograms are stacked to avoid any overlap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmhist(
  value,
  class,
  nbins = 36,
  radius = 1/sqrt(base::pi),
  area.prop = TRUE,
  prob = TRUE,
  proportion = FALSE,
  total.area = 1,
  nlabels = 4,
  cols = NULL,
  borders = NULL,
  m = NA,
  xlim = NULL,
  ylim = NULL,
  main = NULL,
  type = c("null", "compass", "clock"),
  x.legend = "bottomright",
  y.legend = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmhist_+3A_value">value</code></td>
<td>
<p>a numeric vector storing angular values between 0 and 2 pi,
or an object that can be coerced to.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_class">class</code></td>
<td>
<p>a character vector specifying the group the <code>value</code>
belongs to. It needs to have the same length as <code>value</code>,
otherwise it is repeated to the length of <code>value</code>. The order of
plotting from the innermost to the outermost depends on the order of
their appearance in <code>class</code>.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins of the circular histogram. Internally,
it is rounded to a multiple of 4.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.  If <code>radius = 0</code>,
a rose diagram is produced; if <code>radius &gt; 0</code>, a circular histogram
is produced outside the reference circle.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_prob">prob</code></td>
<td>
<p>logical; if <code>TRUE</code>, the circular histogram graphic is a
representation of probability densities; if <code>FALSE</code>, a
representation of frequencies.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_proportion">proportion</code></td>
<td>
<p>logical; if <code>TRUE</code>, the frequencies are scaled by
the proportion of each class, so that the total area under bars is
unity; if <code>FALSE</code>, each class is considered as a separate
distribution and has area of unity.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area under all the
histograms. If <code>total.area = NULL</code>, no scaling is applied, the
plot is in the original scale. If <code>area.prop = TRUE</code>, the total area 
is automatically unity without scaling.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_nlabels">nlabels</code></td>
<td>
<p>integer, for the number of levels to be plotted; if
<code>0</code>, no label is plotted.  The larger the number is, the more
accurate the plot will be.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_cols">cols</code></td>
<td>
<p>the colors to fill the bars, with the same order as the
class.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_borders">borders</code></td>
<td>
<p>the colors of the border around the bars.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_m">m</code></td>
<td>
<p>the number of points within each bin to plot the circular
histogram. The larger the number is, the smoother the plot looks.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_xlim">xlim</code></td>
<td>
<p>numeric vectors of length 2, giving the x coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_main">main</code></td>
<td>
<p>the main title (on top)</p>
</td></tr>
<tr><td><code id="cmhist_+3A_type">type</code></td>
<td>
<p>the type of circular data, one of the values <code>"null"</code>,
<code>"compass"</code> or <code>"clock"</code>.  If <code>"null"</code>, no special
lables plotted for directions. If <code>"compass"</code>, the four cardinal
directions are printed inside the reference circle. If <code>"clock"</code>,
labels for 24 hours are printed inside the reference circle.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_x.legend">x.legend</code></td>
<td>
<p>x coordinate to plot the legend.</p>
</td></tr>
<tr><td><code id="cmhist_+3A_y.legend">y.legend</code></td>
<td>
<p>y coordinate to plot the legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chist">chist</a></code>, <code><a href="#topic+cmdensity">cmdensity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the dataset
library(circular)
data("pigeons", package = "circular")
x = pigeons[,2] / 180 * pi
y = pigeons[,1]

# stacked circular histograms
cmhist(x, y)             # area-proportional 
cmhist(x, y, area=FALSE) # height-proportional

</code></pre>

<hr>
<h2 id='scalefactor'>Scaling Factor</h2><span id='topic+scalefactor'></span>

<h3>Description</h3>

<p>The function calculates the scaling factor so that after scaling 
the original density curve (before transformation), the total area after 
transformation (excluding the reference circle) has the specified value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scalefactor(x, radius = 0, total.area = 1, area.prop = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scalefactor_+3A_x">x</code></td>
<td>
<p>a numeric vector storing the heights of a density curve or
a histogram.</p>
</td></tr>
<tr><td><code id="scalefactor_+3A_radius">radius</code></td>
<td>
<p>the radius of the reference circle.</p>
</td></tr>
<tr><td><code id="scalefactor_+3A_total.area">total.area</code></td>
<td>
<p>a positive number specifying the total area.</p>
</td></tr>
<tr><td><code id="scalefactor_+3A_area.prop">area.prop</code></td>
<td>
<p>logical; if <code>TRUE</code>, an area-proportional
transformation is applied; if <code>FALSE</code>, a height-proportional
transformationis applied.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each value in x is a density value before transformation, for points
equally-spaced on <code class="reqn">[0,2\pi)</code>. For a smooth density curve, use a 
reasonably large number of points, equally-spaced on <code class="reqn">[0,2\pi)</code>. 
The area under the density curve after transformation is then approximated 
by that of the corresponding sectors. Note if <code>area.prop = TRUE</code>, 
the scale factor is simply the value of <code>total.area</code>.
</p>


<h3>Value</h3>

<p>A numerical value for the scaling factor
</p>


<h3>Author(s)</h3>

<p>Danli Xu &lt;dxu452@aucklanduni.ac.nz&gt;, Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Xu, D. and Wang, Y. (2020). Area-proportional Visualization for
Circular Data. <em>Journal of Computational and Graphical
Statistics</em>, <b>29</b>, 351-357.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+circtrans">circtrans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dvm = function(x, mu=0, kappa=1)   # von Mises density
exp(kappa * cos(x - mu)) * (2 * pi * besselI(kappa, 0))^(-1)
x = dvm(seq(0, 2 * pi, len = 100), pi, 10)

scalefactor(x)                            # area-proportional transformation
scalefactor(x, area.prop = FALSE)         # height-proportional transformation
scalefactor(x, total.area = 2)            # total area of 2
scalefactor(x, area.prop = FALSE, total.area = 2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
