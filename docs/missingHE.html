<!DOCTYPE html><html lang="en"><head><title>Help for package missingHE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {missingHE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anyBars'><p>An internal function to detect the random effects component from an object of class formula</p></a></li>
<li><a href='#coef.missingHE'><p>Extract regression coefficient estimates from objects in the class <code>missingHE</code></p></a></li>
<li><a href='#data_read_hurdle'><p>A function to read and re-arrange the data in different ways for the hurdle model</p></a></li>
<li><a href='#data_read_pattern'><p>A function to read and re-arrange the data in different ways</p></a></li>
<li><a href='#data_read_selection'><p>A function to read and re-arrange the data in different ways</p></a></li>
<li><a href='#data_read_selection_long'><p>A function to read and re-arrange the data in different ways</p></a></li>
<li><a href='#diagnostic'><p>Diagnostic checks for assessing MCMC convergence of Bayesian models fitted in <code>JAGS</code> using the function <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code></p></a></li>
<li><a href='#fb'><p>An internal function to extract the random effects component from an object of class formula</p></a></li>
<li><a href='#hurdle'><p>Full Bayesian Models to handle missingness in Economic Evaluations (Hurdle Models)</p></a></li>
<li><a href='#isAnyArgBar'><p>An internal function to detect the random effects component from an object of class formula</p></a></li>
<li><a href='#isBar'><p>An internal function to detect the random effects component from an object of class formula</p></a></li>
<li><a href='#jagsresults'><p>An internal function to summarise results from BUGS model</p></a></li>
<li><a href='#MenSS'><p>MenSS economic data on STIs</p></a></li>
<li><a href='#nobars_'><p>An internal function to separate the fixed and random effects components from an object of class formula</p></a></li>
<li><a href='#pattern'><p>Full Bayesian Models to handle missingness in Economic Evaluations (Pattern Mixture Models)</p></a></li>
<li><a href='#PBS'><p>PBS economic data on intellectual disability and challenging behaviour</p></a></li>
<li><a href='#pic'><p>Predictive information criteria for Bayesian models fitted in <code>JAGS</code> using the funciton <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code></p></a></li>
<li><a href='#plot.missingHE'><p>Plot method for the imputed data contained in the objects of class <code>missingHE</code></p></a></li>
<li><a href='#ppc'><p>Posterior predictive checks for assessing the fit to the observed data of Bayesian models implemented in <code>JAGS</code> using the function <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code></p></a></li>
<li><a href='#print.missingHE'><p>Print method for the posterior results contained in the objects of class <code>missingHE</code></p></a></li>
<li><a href='#prior_hurdle'><p>An internal function to change the hyperprior parameters in the hurdle model provided by the user depending on the type of</p>
structural value mechanism and outcome distributions assumed</a></li>
<li><a href='#prior_pattern'><p>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of</p>
missingness mechanism and outcome distributions assumed</a></li>
<li><a href='#prior_selection'><p>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of</p>
missingness mechanism and outcome distributions assumed</a></li>
<li><a href='#prior_selection_long'><p>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of</p>
missingness mechanism and outcome distributions assumed</a></li>
<li><a href='#run_hurdle'><p>An internal function to execute a JAGS hurdle model and get posterior results</p></a></li>
<li><a href='#run_pattern'><p>An internal function to execute a JAGS pattern mixture model and get posterior results</p></a></li>
<li><a href='#run_selection'><p>An internal function to execute a JAGS selection model and get posterior results</p></a></li>
<li><a href='#run_selection_long'><p>An internal function to execute a JAGS selection model and get posterior results</p></a></li>
<li><a href='#selection'><p>Full Bayesian Models to handle missingness in Economic Evaluations (Selection Models)</p></a></li>
<li><a href='#selection_long'><p>Full Bayesian Models to handle missingness in Economic Evaluations (Selection Models)</p></a></li>
<li><a href='#summary.missingHE'><p>Summary method for objects in the class <code>missingHE</code></p></a></li>
<li><a href='#write_hurdle'><p>An internal function to select which type of hurdle model to execute for both effectiveness and costs.</p>
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of structural value mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</a></li>
<li><a href='#write_pattern'><p>An internal function to select which type of pattern mixture model to execute.</p>
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</a></li>
<li><a href='#write_selection'><p>An internal function to select which type of selection model to execute.</p>
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</a></li>
<li><a href='#write_selection_long'><p>An internal function to select which type of selection model to execute.</p>
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Missing Outcome Data in Health Economic Evaluation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains a suite of functions for health economic evaluations with missing outcome data. 
  The package can fit different types of statistical models under a fully Bayesian approach using the software 'JAGS' (which should be installed locally and which is loaded in 'missingHE' via the 'R' package 'R2jags'). 
  Three classes of models can be fitted under a variety of missing data assumptions: selection models, pattern mixture models and hurdle models.
  In addition to model fitting, 'missingHE' provides a set of specialised functions to assess model convergence and fit, and to summarise the statistical and economic results using different types of measures and graphs. 
  The methods implemented are described in Mason (2018) &lt;<a href="https://doi.org/10.1002%2Fhec.3793">doi:10.1002/hec.3793</a>&gt;, Molenberghs (2000) &lt;<a href="https://doi.org/10.1007%2F978-1-4419-0300-6_18">doi:10.1007/978-1-4419-0300-6_18</a>&gt; and Gabrio (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.8045">doi:10.1002/sim.8045</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>mcmcplots, ggpubr, ggmcmc, ggthemes, BCEA, ggplot2, grid,
gridExtra, bayesplot, methods, R2jags, loo, coda, mcmcr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-20 15:18:45 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrea Gabrio [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea Gabrio &lt;a.gabrio@maastrichtuniversity.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-21 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anyBars'>An internal function to detect the random effects component from an object of class formula</h2><span id='topic+anyBars'></span>

<h3>Description</h3>

<p>An internal function to detect the random effects component from an object of class formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anyBars(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anyBars_+3A_term">term</code></td>
<td>
<p>formula to be processed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='coef.missingHE'>Extract regression coefficient estimates from objects in the class <code>missingHE</code></h2><span id='topic+coef.missingHE'></span>

<h3>Description</h3>

<p>Produces a table printout with summary statistics for the regression coefficients of the health economic evaluation probabilistic model
run using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'missingHE'
coef(object, prob = c(0.025, 0.975), random = FALSE, time = 1, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.missingHE_+3A_object">object</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of the Bayesian modelling and the economic evaluation</p>
</td></tr>
<tr><td><code id="coef.missingHE_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities within the range (0,1), representing the upper and lower
CI sample quantiles to be calculated and returned for the estimates.</p>
</td></tr>
<tr><td><code id="coef.missingHE_+3A_random">random</code></td>
<td>
<p>Logical. If <code>random</code> is <code>TRUE</code>, the estimates of the random effects parameters are printed, when available.</p>
</td></tr>
<tr><td><code id="coef.missingHE_+3A_time">time</code></td>
<td>
<p>A number indicating the time point at which posterior results for the model coefficients should be reported (only for longitudinal models).</p>
</td></tr>
<tr><td><code id="coef.missingHE_+3A_digits">digits</code></td>
<td>
<p>Number of digits to be displayed for each estimate.</p>
</td></tr>
<tr><td><code id="coef.missingHE_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a table with some summary statistics, including posterior mean, standard deviation and lower and upper quantiles based on the
values specified in <code>prob</code>, for the posterior distributions of the regression coefficients of the effects and costs models run using the 
function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code>pattern</code> or <code>hurdle</code>.
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code> <code><a href="#topic+selection_long">selection_long</a></code> <code><a href="#topic+pattern">pattern</a></code> <code><a href="#topic+hurdle">hurdle</a></code> <code><a href="#topic+diagnostic">diagnostic</a></code> <code><a href="#topic+plot.missingHE">plot.missingHE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
# 
# 
</code></pre>

<hr>
<h2 id='data_read_hurdle'>A function to read and re-arrange the data in different ways for the hurdle model</h2><span id='topic+data_read_hurdle'></span>

<h3>Description</h3>

<p>This internal function imports the data and outputs only those variables that are needed to run the hurdle model
according to the information provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_read_hurdle(
  data,
  model.eff,
  model.cost,
  model.se,
  model.sc,
  se,
  sc,
  type,
  center
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_read_hurdle_+3A_data">data</code></td>
<td>
<p>A data frame in which to find variables supplied in <code>model.eff</code>, <code>model.cost</code> (model formulas for effects and costs) 
and <code>model.se</code>, <code>model.sc</code> (model formulas for the structural effect and cost models) . Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't' respectively.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>, and 
any covariates are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side. 
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
cost outcome ('c') whose name must correspond to that used in <code>data</code>, and any covariates are given on the right-hand side. 
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;location&quot; 
parameter of the distribution through a linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_model.se">model.se</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>, and 
any covariates used to estimate the probability of structural effects are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side.
By default, covariates are placed on the &quot;probability&quot; parameter for the strcutural effects through a logistic-linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_model.sc">model.sc</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
cost outcome ('c') whose name must correspond to that used in <code>data</code>, and 
any covariates used to estimate the probability of structural costs are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side.
By default, covariates are placed on the &quot;probability&quot; parameter for the strcutural costs through a logistic-linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_se">se</code></td>
<td>
<p>Structural value to be found in the effect data defined in <code>data</code>. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the effects is run.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_sc">sc</code></td>
<td>
<p>Structural value to be found in the cost data defined in <code>data</code>. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the costs is run.</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_type">type</code></td>
<td>
<p>Type of structural value mechanism assumed, either 'SCAR' (Structural Completely At Random) or 'SAR' (Strcutural At Random).</p>
</td></tr>
<tr><td><code id="data_read_hurdle_+3A_center">center</code></td>
<td>
<p>Logical. If <code>center</code> is <code>TRUE</code> all the covariates in the model are centered.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='data_read_pattern'>A function to read and re-arrange the data in different ways</h2><span id='topic+data_read_pattern'></span>

<h3>Description</h3>

<p>This internal function imports the data and outputs only those variables that are needed to run the model
according to the information provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_read_pattern(data, model.eff, model.cost, type, center)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_read_pattern_+3A_data">data</code></td>
<td>
<p>A data frame in which to find variables supplied in <code>model.eff</code> and <code>model.cost</code>. Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't' respectively.</p>
</td></tr>
<tr><td><code id="data_read_pattern_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>, and 
any covariates are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side.
By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model. 
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_pattern_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
cost outcome ('c') whose name must correspond to that used in <code>data</code>, and any covariates are given on the right-hand side.
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;location&quot; 
parameter of the distribution through a linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_pattern_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="data_read_pattern_+3A_center">center</code></td>
<td>
<p>Logical. If <code>center</code> is <code>TRUE</code> all the covariates in the model are centered.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='data_read_selection'>A function to read and re-arrange the data in different ways</h2><span id='topic+data_read_selection'></span>

<h3>Description</h3>

<p>This internal function imports the data and outputs only those variables that are needed to run the model
according to the information provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_read_selection(
  data,
  model.eff,
  model.cost,
  model.me,
  model.mc,
  type,
  center
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_read_selection_+3A_data">data</code></td>
<td>
<p>A data frame in which to find variables supplied in <code>model.eff</code> and <code>model.cost</code>. Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't' respectively.</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>, and 
any covariates are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side.
By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
cost outcome ('c') whose name must correspond to that used in <code>data</code>, and any covariates are given on the right-hand side.
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;location&quot; 
parameter of the distribution through a linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_model.me">model.me</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax.  The response must be indicated with the 
term 'me'(missing effects) and any covariates used to estimate the probability of missing effects are given on the right-hand side. 
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;probability&quot; parameter for the missing effects through a logistic-linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_model.mc">model.mc</code></td>
<td>
<p>A formula expression in conventional R linear modelling syntax. The response must be indicated with the 
term 'mc'(missing costs) and any covariates used to estimate the probability of missing costs should be given on the right-hand side. 
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;probability&quot; parameter for the missing costs through a logistic-linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="data_read_selection_+3A_center">center</code></td>
<td>
<p>Logical. If <code>center</code> is <code>TRUE</code> all the covariates in the model are centered.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='data_read_selection_long'>A function to read and re-arrange the data in different ways</h2><span id='topic+data_read_selection_long'></span>

<h3>Description</h3>

<p>This internal function imports the data and outputs only those variables that are needed to run the model
according to the information provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_read_selection_long(
  data,
  model.eff,
  model.cost,
  model.mu,
  model.mc,
  type,
  center
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_read_selection_long_+3A_data">data</code></td>
<td>
<p>A data frame in which to find variables supplied in <code>model.eff</code> and <code>model.cost</code>. Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'u', 'c' and 't' respectively.</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
effectiveness outcome ('u') whose name must correspond to that used in <code>data</code>, and 
any covariates are given on the right-hand side. If there are no covariates, specify <code>1</code> on the right hand side.
By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economics
cost outcome ('c') whose name must correspond to that used in <code>data</code>, and any covariates are given on the right-hand side.
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;location&quot; 
parameter of the distribution through a linear model. Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_model.mu">model.mu</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax.  The response must be indicated with the 
term 'mu'(missing effects) and any covariates used to estimate the probability of missing effects are given on the right-hand side. 
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;probability&quot; parameter for the missing effects through a logistic-linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_model.mc">model.mc</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the 
term 'mc'(missing costs) and any covariates used to estimate the probability of missing costs should be given on the right-hand side. 
If there are no covariates, specify <code>1</code> on the right hand side. By default, covariates are placed on the &quot;probability&quot; parameter for the missing costs through a logistic-linear model.
Random effects can also be specified for each model parameter.</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="data_read_selection_long_+3A_center">center</code></td>
<td>
<p>Logical. If <code>center</code> is <code>TRUE</code> all the covariates in the model are centered.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='diagnostic'>Diagnostic checks for assessing MCMC convergence of Bayesian models fitted in <code>JAGS</code> using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code></h2><span id='topic+diagnostic'></span>

<h3>Description</h3>

<p>The focus is restricted to full Bayesian models in cost-effectiveness analyses based on the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> and <code><a href="#topic+hurdle">hurdle</a></code>, 
with convergence of the MCMC chains that is assessed through graphical checks of the posterior distribution of the parameters of interest,
Examples are density plots, trace plots, autocorrelation plots, etc. Other types of posterior checks are related to some summary MCMC statistics 
that are able to detect possible issues in the convergence of the algorithm, such as the potential scale reduction factor or the effective sample size.
Different types of diagnostic tools and statistics are used to assess model convergence using functions contained in the package <strong>ggmcmc</strong> and <strong>mcmcplots</strong>. 
Graphics and plots are managed using functions contained in the package <strong>ggplot2</strong> and <strong>ggthemes</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic(x, type = "denplot", param = "all", theme = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic_+3A_x">x</code></td>
<td>
<p>An object of class &quot;missingHE&quot; containing the posterior results of a full Bayesian model implemented using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>,
<code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_type">type</code></td>
<td>
<p>Type of diagnostic check to be plotted for the model parameter selected. Available choices include: 'histogram' for histogram plots,
'denplot' for density plots, 'traceplot' for trace plots, 'acf' for autocorrelation plots, 'running' for running mean plots,
'compare' for comparing the distribution of the whole chain with only its last part, 'cross' for crosscorrelation plots, 'Rhat' for the potential scale reduction factor, 'geweke' for the geweke diagnostic,
'pairs' for posterior correlation among the parameters,'caterpillar' for caterpillar plots. In addition the class 'summary' provides an overview of some of the most popular
diagnostic checks for each parameter selected.</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_param">param</code></td>
<td>
<p>Name of the family of parameters to process, as given by a regular expression. For example the mean parameters 
for the effect and cost variables can be specified using 'mu.e' ('mu.u' for longitudinal models) and 'mu.c', respectively. Different types of
models may have different parameters depending on the assumed distributions and missing data assumptions. 
To see a complete list of all possible parameters by types of models assumed see details.</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_theme">theme</code></td>
<td>
<p>Type of ggplot theme among some pre-defined themes. For a full list of available themes see details.</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_...">...</code></td>
<td>
<p>Additional parameters that can be provided to manage the graphical output of <code>diagnostic</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the types of plots specified in the argument <code>type</code>, the output of <code>diagnostic</code> can produce
different combinations of MCMC visual posterior checks for the family of parameters indicated in the argument <code>param</code>.
For a full list of the available plots see the description of the argument <code>type</code> or see the corresponding plots in the package <strong>ggmcmc</strong>.
</p>
<p>The parameters that can be assessed through <code>diagnostic</code> are only those included in the object <code>x</code> (see Arguments). Specific character names
must be specified in the argument <code>param</code> according to the specific model implemented. If <code>x</code> contains the results from a longitudinal model, 
all parameter names indexed by &quot;e&quot; should be instead indexed by &quot;u&quot;. The available names and the parameters associated with them are:
</p>

<ul>
<li><p> &quot;mu.e&quot; the mean parameters of the effect variables in the two treatment arms.
</p>
</li>
<li><p> &quot;mu.c&quot; the mean parameters of the cost variables in the two treatment arms.
</p>
</li>
<li><p> &quot;mu.e.p&quot; the pattern-specific mean parameters of the effect variables in the two treatment arms (only with the function <code>pattern</code>).
</p>
</li>
<li><p> &quot;mu.c.p&quot; the pattern-specific mean parameters of the cost variables in the two treatment arms (only with the function <code>pattern</code>).
</p>
</li>
<li><p> &quot;sd.e&quot; the standard deviation parameters of the effect variables in the two treatment arms.
</p>
</li>
<li><p> &quot;sd.c&quot; the standard deviation parameters of the cost variables in the two treatment arms.
</p>
</li>
<li><p> &quot;alpha&quot; the regression intercept and covariate coefficient parameters for the effect variables in the two treatment arms.
</p>
</li>
<li><p> &quot;beta&quot; the regression intercept and covariate coefficient parameters for the cost variables in the two treatment arms.
</p>
</li>
<li><p> &quot;random.alpha&quot; the regression random effects intercept and covariate coefficient parameters for the effect variables in the two treatment arms.
</p>
</li>
<li><p> &quot;random.beta&quot; the regression random effects intercept and covariate coefficient parameters for the cost variables in the two treatment arms.
</p>
</li>
<li><p> &quot;p.e&quot; the probability parameters of the missingness or structural values mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;p.c&quot; the probability parameters of the missingness or structural values mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;gamma.e&quot; the regression intercept and covariate coefficient parameters of the missingness or structural values mechanism
for the effect variables in the two treatment arms (only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;gamma.c&quot; the regression intercept and covariate coefficient parameters of the missingness or structural values mechanism 
for the cost variables in the two treatment arms (only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;random.gamma.e&quot; the random effects regression intercept and covariate coefficient parameters of the missingness or structural values mechanism
for the effect variables in the two treatment arms (only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;random.gamma.c&quot; the random effects regression intercept and covariate coefficient parameters of the missingness or structural values mechanism 
for the cost variables in the two treatment arms (only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code> or <code>hurdle</code>).
</p>
</li>
<li><p> &quot;pattern&quot; the probabilities associated with the missingness patterns in the data (only with the function <code>pattern</code>).
</p>
</li>
<li><p> &quot;delta.e&quot; the mnar parameters of the missingness mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code>, or <code>pattern</code>).
</p>
</li>
<li><p> &quot;delta.c&quot; the mnar parameters of the missingness mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code>, or <code>pattern</code>).
</p>
</li>
<li><p> &quot;random.delta.e&quot; the random effects mnar parameters of the missingness mechanism for the effect variables in the two treatment arms 
(only with the function <code>selection</code> or <code><a href="#topic+selection_long">selection_long</a></code>).
</p>
</li>
<li><p> &quot;random.delta.c&quot; the random effects mnar parameters of the missingness mechanism for the cost variables in the two treatment arms 
(only with the function <code>selection</code> or <code><a href="#topic+selection_long">selection_long</a></code>).
</p>
</li>
<li><p> &quot;all&quot; all available parameters stored in the object <code>x</code>.
</p>
</li></ul>

<p>When the object <code>x</code> is created using the function <code>pattern</code>, pattern-specific standard deviation (&quot;sd.e&quot;, &quot;sd.c&quot;) and regression coefficient 
parameters (&quot;alpha&quot;, &quot;beta&quot;) for both outcomes can be visualised. The parameters associated with a missingness mechanism can be accessed only when <code>x</code>
is created using the function <code>selection</code>, <code><a href="#topic+selection_long">selection_long</a></code>, or <code>pattern</code>, while the parameters associated with the model for the structural values mechanism
can be accessed only when <code>x</code> is created using the function <code>hurdle</code>.
</p>
<p>The argument <code>theme</code> allows to customise the graphical output of the plots generated by <code>diagnostic</code> and
allows to choose among a set of possible pre-defined themes taken form the package <strong>ggtheme</strong>. For a complete list of the available character names
for each theme, see <strong>ggthemes</strong>.
</p>


<h3>Value</h3>

<p>A <strong>ggplot</strong> object containing the plots specified in the argument <code>type</code>
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Brooks, S. Gelman, A. Jones, JL. Meng, XL. (2011). <em>Handbook of Markov Chain Monte Carlo</em>, CRC/Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="ggmcmc.html#topic+ggs">ggs</a></code> <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> <code><a href="#topic+hurdle">hurdle</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
#
#
</code></pre>

<hr>
<h2 id='fb'>An internal function to extract the random effects component from an object of class formula</h2><span id='topic+fb'></span>

<h3>Description</h3>

<p>An internal function to extract the random effects component from an object of class formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fb(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fb_+3A_term">term</code></td>
<td>
<p>formula to be processed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='hurdle'>Full Bayesian Models to handle missingness in Economic Evaluations (Hurdle Models)</h2><span id='topic+hurdle'></span>

<h3>Description</h3>

<p>Full Bayesian cost-effectiveness models to handle missing data in the outcomes using Hurdle models
under a variatey of alternative parametric distributions for the effect and cost variables. Alternative
assumptions about the mechanisms of the structural values are implemented using a hurdle approach. The analysis is performed using the <code>BUGS</code> language, 
which is implemented in the software <code>JAGS</code> using the function <code><a href="R2jags.html#topic+jags">jags</a></code>. The output is stored in an object of class 'missingHE'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hurdle(
  data,
  model.eff,
  model.cost,
  model.se = se ~ 1,
  model.sc = sc ~ 1,
  se = 1,
  sc = 0,
  dist_e,
  dist_c,
  type,
  prob = c(0.025, 0.975),
  n.chains = 2,
  n.iter = 20000,
  n.burnin = floor(n.iter/2),
  inits = NULL,
  n.thin = 1,
  ppc = FALSE,
  save_model = FALSE,
  prior = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hurdle_+3A_data">data</code></td>
<td>
<p>A data frame in which to find the variables supplied in <code>model.eff</code>, <code>model.cost</code> (model formulas for effects and costs) 
and <code>model.se</code>, <code>model.sc</code> (model formulas for the structural effect and cost models). Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't', respectively.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula. 
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
cost outcome ('c') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; 
parameter of the distribution through a linear model. A joint bivariate distribution for effects and costs can be specified by including 'e' on the right-hand side of the formula for the costs model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_model.se">model.se</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the 
term 'se'(structural effects). Any covariates in the model must be provided on the right-hand side of the formula. 
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;probability&quot; parameter for the structural effects through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_model.sc">model.sc</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the 
term 'sc'(structural costs). Any covariates in the model must be provided on the right-hand side of the formula. 
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;probability&quot; parameter for the structural costs through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_se">se</code></td>
<td>
<p>Structural value to be found in the effect variables defined in <code>data</code>. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the effects is run.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_sc">sc</code></td>
<td>
<p>Structural value to be found in the cost variables defined in <code>data</code>. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the costs is run.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="hurdle_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="hurdle_+3A_type">type</code></td>
<td>
<p>Type of structural value mechanism assumed. Choices are Structural Completely At Random (SCAR),
and Structural At Random (SAR).</p>
</td></tr>
<tr><td><code id="hurdle_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities within the range (0,1), representing the upper and lower
CI sample quantiles to be calculated and returned for the imputed values.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_n.burnin">n.burnin</code></td>
<td>
<p>Number of warmup iterations.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_inits">inits</code></td>
<td>
<p>A list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the
<code>JAGS</code> model, or a function creating (possibly random) initial values. If <code>inits</code> is <code>NULL</code>, <code>JAGS</code>
will generate initial values for all the model parameters.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_save_model">save_model</code></td>
<td>
<p>Logical. If <code>save_model</code> is <code>TRUE</code> a <code>txt</code> file containing the model code is printed
in the current working directory.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_prior">prior</code></td>
<td>
<p>A list containing the hyperprior values provided by the user. Each element of this list must be a vector of length two
containing the user-provided hyperprior values and must be named with the name of the corresponding parameter. For example, the hyperprior
values for the standard deviation parameter for the effects can be provided using the list <code>prior = list('sigma.prior.e' = c(0, 100))</code>. For more information about how 
to provide prior hypervalues for different types of parameters and models see details. 
If <code>prior</code> is set to 'default', the default values will be used.</p>
</td></tr>
<tr><td><code id="hurdle_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be provided by the user. Examples are <code>d_e</code> and <code>d_c</code>, which should correspond to two binary indicator vectors
with length equal to the number of rows of <code>data</code>. By default these variables are constructed within the function based on the observed data
but it is possible for the user to directly provide them as a means to explore some Structural Not At Random (SNAR) mechanism assumptions about one or both outcomes.
Individuals whose corresponding indicator value is set to <code>1</code> or <code>0</code> will be respectively 
associated with the structural or non-structural component in the model. Other optional arguments are <code>center = TRUE</code>, which centers all the covariates in the model or the additional arguments that can be provided 
to the function <code><a href="BCEA.html#topic+bcea">bcea</a></code> to summarise the health economic evaluation results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the distributions specified for the outcome variables in the arguments <code>dist_e</code> and
<code>dist_c</code> and the type of structural value mechanism specified in the argument <code>type</code>, different hurdle models
are built and run in the background by the function <code>hurdle</code>. These are mixture models defined by two components: the first one
is a mass distribution at the spike, while the second is a parametric model applied to the natural range of the relevant variable.
Usually, a logistic regression is used to estimate the probability of incurring a &quot;structural&quot; value (e.g. 0 for the costs, or 1 for the
effects); this is then used to weigh the mean of the &quot;non-structural&quot; values estimated in the second component. 
A simple example can be used to show how hurdle models are specified. 
Consider a data set comprising a response variable <code class="reqn">y</code> and a set of centered covariate <code class="reqn">X_j</code>.Specifically, for each subject in the trial <code class="reqn">i = 1, ..., n</code>
we define an indicator variable <code class="reqn">d_i</code> taking value <code>1</code> if the <code class="reqn">i</code>-th individual is associated with a structural value and <code>0</code> otherwise.
This is modelled as:
</p>
<p style="text-align: center;"><code class="reqn">d_i ~ Bernoulli(\pi_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(\pi_i) = \gamma_0 + \sum\gamma_j X_j</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">\pi_i</code> is the individual probability of a structural value in <code class="reqn">y</code>.
</p>
</li>
<li> <p><code class="reqn">\gamma_0</code> represents the marginal probability of a structural value in <code class="reqn">y</code> on the logit scale.
</p>
</li>
<li> <p><code class="reqn">\gamma_j</code> represents the impact on the probability of a structural value in <code class="reqn">y</code> of the centered covariates <code class="reqn">X_j</code>.
</p>
</li></ul>

<p>When <code class="reqn">\gamma_j = 0</code>, the model assumes a 'SCAR' mechanism, while when <code class="reqn">\gamma_j != 0</code> the mechanism is 'SAR'.
For the parameters indexing the structural value model, the default prior distributions assumed are the following:
</p>

<ul>
<li> <p><code class="reqn">\gamma_0 ~ Logisitic(0, 1)</code>
</p>
</li>
<li> <p><code class="reqn">\gamma_j ~ Normal(0, 0.01)</code>
</p>
</li></ul>

<p>When user-defined hyperprior values are supplied via the argument <code>prior</code> in the function <code>hurdle</code>, the elements of this list (see Arguments)
must be vectors of length <code>2</code> containing the user-provided hyperprior values and must take specific names according to the parameters they are associated with. 
Specifically, the names accepted by <strong>missingHE</strong> are the following:
</p>

<ul>
<li><p> location parameters <code class="reqn">\alpha_0, \beta_0</code>: &quot;mean.prior.e&quot;(effects) and/or &quot;mean.prior.c&quot;(costs)
</p>
</li>
<li><p> auxiliary parameters <code class="reqn">\sigma</code>: &quot;sigma.prior.e&quot;(effects) and/or &quot;sigma.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters <code class="reqn">\alpha_j, \beta_j</code>: &quot;alpha.prior&quot;(effects) and/or &quot;beta.prior&quot;(costs)
</p>
</li>
<li><p> marginal probability of structural values <code class="reqn">\gamma_0</code>: &quot;p.prior.e&quot;(effects) and/or &quot;p.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters in the model of the structural values <code class="reqn">\gamma_j</code> (if covariate data provided): &quot;gamma.prior.e&quot;(effects) and/or &quot;gamma.prior.c&quot;(costs)
</p>
</li></ul>
 
<p>For simplicity, here we have assumed that the set of covariates <code class="reqn">X_j</code> used in the models for the effects/costs and in the 
model of the structural effect/cost values is the same. However, it is possible to specify different sets of covariates for each model
using the arguments in the function <code>hurdle</code> (see Arguments).
</p>
<p>For each model, random effects can also be specified for each parameter by adding the term + (x | z) to each model formula, 
where x is the fixed regression coefficient for which also the random effects are desired and z is the clustering variable across which 
the random effects are specified (must be the name of a factor variable in the dataset). Multiple random effects can be specified using the 
notation + (x1 + x2 | site) for each covariate that was included in the fixed effects formula. Random intercepts are included by default in the models
if a random effects are specified but they can be removed by adding the term 0 within the random effects formula, e.g. + (0 + x | z).
</p>


<h3>Value</h3>

<p>An object of the class 'missingHE' containing the following elements
</p>

<dl>
<dt>data_set</dt><dd><p>A list containing the original data set provided in <code>data</code> (see Arguments), the number of observed and missing individuals 
, the total number of individuals by treatment arm and the indicator vectors for the structural values</p>
</dd>
<dt>model_output</dt><dd><p>A list containing the output of a <code>JAGS</code> model generated from the functions <code><a href="R2jags.html#topic+jags">jags</a></code>, and 
the posterior samples for the main parameters of the model and the imputed values</p>
</dd>
<dt>cea</dt><dd><p>A list containing the output of the economic evaluation performed using the function <code><a href="BCEA.html#topic+bcea">bcea</a></code></p>
</dd>
<dt>type</dt><dd><p>A character variable that indicate which type of structural value mechanism has been used to run the model, 
either <code>SCAR</code> or <code>SAR</code> (see details)</p>
</dd>
<dt>data_format</dt><dd><p>A character variable that indicate which type of analysis was conducted, either using a <code>wide</code> or <code>longitudinal</code> dataset</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Ntzoufras I. (2009). <em>Bayesian Modelling Using WinBUGS</em>, John Wiley and Sons.
</p>
<p>Daniels, MJ. Hogan, JW. (2008). <em>Missing Data in Longitudinal Studies: strategies for Bayesian modelling and sensitivity analysis</em>, CRC/Chapman Hall.
</p>
<p>Baio, G.(2012). <em>Bayesian Methods in Health Economics</em>. CRC/Chapman Hall, London.
</p>
<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">jags</a></code>, <code><a href="BCEA.html#topic+bcea">bcea</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Quick example to run using subset of MenSS dataset
MenSS.subset &lt;- MenSS[50:100, ]

# Run the model using the hurdle function assuming a SCAR mechanism
# Use only 100 iterations to run a quick check
model.hurdle &lt;- hurdle(data = MenSS.subset, model.eff = e ~ 1,model.cost = c ~ 1,
   model.se = se ~ 1, model.sc = sc ~ 1, se = 1, sc = 0, dist_e = "norm", dist_c = "norm",
   type = "SCAR", n.chains = 2, n.iter = 50,  ppc = FALSE)

# Print the results of the JAGS model
print(model.hurdle)
#

# Use dic information criterion to assess model fit
pic.dic &lt;- pic(model.hurdle, criterion = "dic", module = "total")
pic.dic
#

# Extract regression coefficient estimates
coef(model.hurdle)
#



# Assess model convergence using graphical tools
# Produce histograms of the posterior samples for the mean effects
diag.hist &lt;- diagnostic(model.hurdle, type = "histogram", param = "mu.e")
#

# Compare observed effect data with imputations from the model
# using plots (posteiror means and credible intervals)
p1 &lt;- plot(model.hurdle, class = "scatter", outcome = "effects")
#

# Summarise the CEA information from the model
summary(model.hurdle)


# Further examples which take longer to run
model.hurdle &lt;- hurdle(data = MenSS, model.eff = e ~ u.0,model.cost = c ~ e,
   model.se = se ~ u.0, model.sc = sc ~ 1, se = 1, sc = 0, dist_e = "norm", dist_c = "norm",
   type = "SAR", n.chains = 2, n.iter = 500,  ppc = FALSE)
#
# Print results for all imputed values
print(model.hurdle, value.mis = TRUE)

# Use looic to assess model fit
pic.looic&lt;-pic(model.hurdle, criterion = "looic", module = "total")
pic.looic

# Show density plots for all parameters
diag.hist &lt;- diagnostic(model.hurdle, type = "denplot", param = "all")

# Plots of imputations for all data
p1 &lt;- plot(model.hurdle, class = "scatter", outcome = "all")

# Summarise the CEA results
summary(model.hurdle)


#
#
</code></pre>

<hr>
<h2 id='isAnyArgBar'>An internal function to detect the random effects component from an object of class formula</h2><span id='topic+isAnyArgBar'></span>

<h3>Description</h3>

<p>An internal function to detect the random effects component from an object of class formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isAnyArgBar(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isAnyArgBar_+3A_term">term</code></td>
<td>
<p>formula to be processed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='isBar'>An internal function to detect the random effects component from an object of class formula</h2><span id='topic+isBar'></span>

<h3>Description</h3>

<p>An internal function to detect the random effects component from an object of class formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isBar(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isBar_+3A_term">term</code></td>
<td>
<p>formula to be processed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='jagsresults'>An internal function to summarise results from BUGS model</h2><span id='topic+jagsresults'></span>

<h3>Description</h3>

<p>This function hides missing data distribution from summary results of BUGS models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jagsresults(
  x,
  params,
  regex = FALSE,
  invert = FALSE,
  probs = c(0.025, 0.25, 0.5, 0.75, 0.975),
  signif,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jagsresults_+3A_x">x</code></td>
<td>
<p>The <code>rjags</code>, <code>rjags.parallel</code>, or <code>mcmc.list</code> object
for which results will be printed.</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_params">params</code></td>
<td>
<p>Character vector or a regular expression pattern. The 
parameters for which results will be printed (unless <code>invert</code> is
<code>FALSE</code>, in which case results for all parameters other than those
given in <code>params</code> will be returned). If <code>regex</code> is <code>FALSE</code>,
only those parameters that match <code>params</code> exactly will be returned. If 
<code>regex</code> is <code>TRUE</code>, <code>param</code> should be a character string 
giving the regular expression pattern to be matched.</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_regex">regex</code></td>
<td>
<p>If <code>regex</code> is <code>TRUE</code>, then <code>param</code> is 
expected to be a single string giving a text pattern to be matched. 
Parameters with names matching the pattern will be returned (unless 
<code>invert</code> is <code>TRUE</code>, which results in all parameters that do not 
match the pattern being returned). Text pattern matching uses regular 
expressions (<code><a href="base.html#topic+regex">regex</a></code>).</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_invert">invert</code></td>
<td>
<p>Logical. If <code>invert</code> is <code>TRUE</code>, only those parameters
that do not match elements of <code>params</code> will be returned.</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities within range [0, 1],
representing the sample quantiles to be calculated and returned.</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_signif">signif</code></td>
<td>
<p>If supplied, all columns other than <code>n.eff</code> will have 
their values rounded such that the most extreme value has the specified
number of significant digits.</p>
</td></tr>
<tr><td><code id="jagsresults_+3A_...">...</code></td>
<td>
<p>Additional arguments accepted by <code><a href="base.html#topic+grep">grep</a></code>, e.g. 
<code>perl=TRUE</code>, to allow look-around pattern matching.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Data
N &lt;- 100
temp &lt;- runif(N)
rain &lt;- runif(N)
wind &lt;- runif(N)
a &lt;- 0.13
beta.temp &lt;- 1.3
beta.rain &lt;- 0.86
beta.wind &lt;- -0.44
sd &lt;- 0.16
y &lt;- rnorm(N, a + beta.temp*temp + beta.rain*rain + beta.wind*wind, sd)
dat &lt;- list(N=N, temp=temp, rain=rain, wind=wind, y=y)

### bugs example
library(R2jags)

## Model
M &lt;- function() {
  for (i in 1:N) {
    y[i] ~ dnorm(y.hat[i], sd^-2)
    y.hat[i] &lt;- a + beta.temp*temp[i] + beta.rain*rain[i] + beta.wind*wind[i]
    resid[i] &lt;- y[i] - y.hat[i]
  }
  sd ~ dunif(0, 100)
  a ~ dnorm(0, 0.0001)
  beta.temp ~ dnorm(0, 0.0001)
  beta.rain ~ dnorm(0, 0.0001)
  beta.wind ~ dnorm(0, 0.0001)
}

## Fit model
jagsfit &lt;- jags(dat, inits=NULL, 
                parameters.to.save=c('a', 'beta.temp', 'beta.rain', 
                                     'beta.wind', 'sd', 'resid'), 
                model.file=M, n.iter=10000)

## Output
# model summary
jagsfit

# Results for beta.rain only
jagsresults(x=jagsfit, param='beta.rain')

# Results for 'a' and 'sd' only
jagsresults(x=jagsfit, param=c('a', 'sd'))
jagsresults(x=jagsfit, param=c('a', 'sd'), 
            probs=c(0.01, 0.025, 0.1, 0.25, 0.5, 0.75, 0.9, 0.975))

# Results for all parameters including the string 'beta'
jagsresults(x=jagsfit, param='beta', regex=TRUE)

# Results for all parameters not including the string 'beta'
jagsresults(x=jagsfit, param='beta', regex=TRUE, invert=TRUE)

# Note that the above is NOT equivalent to the following, which returns all
# parameters that are not EXACTLY equal to 'beta'.
jagsresults(x=jagsfit, param='beta', invert=TRUE)

# Results for all parameters beginning with 'b' or including 'sd'.
jagsresults(x=jagsfit, param='^b|sd', regex=TRUE)

# Results for all parameters not beginning with 'beta'.
# This is equivalent to using param='^beta' with invert=TRUE and regex=TRUE
jagsresults(x=jagsfit, param='^(?!beta)', regex=TRUE, perl=TRUE)

## End(Not run)
#
#

</code></pre>

<hr>
<h2 id='MenSS'>MenSS economic data on STIs</h2><span id='topic+MenSS'></span>

<h3>Description</h3>

<p>Data from a pilot RCT trial (The MenSS trial) on youn men at risk of Sexually Trasmitted Infections (STIs).
A total of 159 individuals were enrolled in trial: 75 in the control (t=1) and 84 in the active intervention (t=2).
Clinical and health economic outcome data were collected via self-reported questionnaires at four time points throughout the study: baseline,
3 months, 6 months and 12 months follow-up. Health economic data include utility scores related to quality of life and costs, from which QALYs and total costs were then computed using the area under the curve method
and by summing up the cost components at each time point. Clinical data include the total number of instances of unprotected sex and whether the individual was associated with an STI diagnosis or not. 
Baseline data are available for the utilities (no baseline costs collected), instances of unprotected sex, sti diagnosis, age, ethnicity and employment variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MenSS)
</code></pre>


<h3>Format</h3>

<p>A data frame with 159 rows and 12 variables
</p>


<h3>Details</h3>


<dl>
<dt>id</dt><dd><p>id number</p>
</dd>
<dt>e</dt><dd><p>Quality Adjusted Life Years (QALYs)</p>
</dd>
<dt>c</dt><dd><p>Total costs in pounds</p>
</dd>
<dt>u.0</dt><dd><p>baseline utilities</p>
</dd>
<dt>age</dt><dd><p>Age in years</p>
</dd>
<dt>ethnicity</dt><dd><p>binary: white (1) and other (0)</p>
</dd>
<dt>employment</dt><dd><p>binary: working (1) and other (0)</p>
</dd>
<dt>t</dt><dd><p>Treatment arm indicator for the control (t=1) and the active intervention (t=2)</p>
</dd>
<dt>sex_inst.0</dt><dd><p>baseline number of instances of unprotected sex</p>
</dd>
<dt>sex_inst</dt><dd><p>number of instances of unprotected sex at 12 months follow-up</p>
</dd>
<dt>sti.0</dt><dd><p>binary : baseline sti diagnosis (1) and no baseline sti diagnosis (0)</p>
</dd>
<dt>sti</dt><dd><p>binary : sti diagnosis (1) and no sti diagnosis (0) at 12 months follow-up</p>
</dd> 
<dt>site</dt><dd><p>site number</p>
</dd>
</dl>



<h3>References</h3>

<p>Bailey et al. (2016) Health Technology Assessment 20
(<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5204131/">PubMed</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MenSS &lt;- data(MenSS)
summary(MenSS)
str(MenSS)
</code></pre>

<hr>
<h2 id='nobars_'>An internal function to separate the fixed and random effects components from an object of class formula</h2><span id='topic+nobars_'></span>

<h3>Description</h3>

<p>An internal function to separate the fixed and random effects components from an object of class formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nobars_(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nobars__+3A_term">term</code></td>
<td>
<p>formula to be processed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='pattern'>Full Bayesian Models to handle missingness in Economic Evaluations (Pattern Mixture Models)</h2><span id='topic+pattern'></span>

<h3>Description</h3>

<p>Full Bayesian cost-effectiveness models to handle missing data in the outcomes under different missingness 
mechanism assumptions, using alternative parametric distributions for the effect and cost variables and a pattern mixture approach to identify the model. 
The analysis is performed using the <code>BUGS</code> language, which is implemented in the software <code>JAGS</code> using the function <code><a href="R2jags.html#topic+jags">jags</a></code>.
The output is stored in an object of class 'missingHE'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattern(
  data,
  model.eff,
  model.cost,
  dist_e,
  dist_c,
  Delta_e,
  Delta_c,
  type,
  restriction = "CC",
  prob = c(0.025, 0.975),
  n.chains = 2,
  n.iter = 20000,
  n.burnin = floor(n.iter/2),
  inits = NULL,
  n.thin = 1,
  ppc = FALSE,
  save_model = FALSE,
  prior = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pattern_+3A_data">data</code></td>
<td>
<p>A data frame in which to find the variables supplied in <code>model.eff</code>, <code>model.cost</code> (model formulas for effects and costs).
Among these, effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't', respectively.</p>
</td></tr>
<tr><td><code id="pattern_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="pattern_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
cost outcome ('c') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. 
By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model. A joint bivariate distribution for effects and costs can be specified by including 'e' on the right-hand side of the formula for the costs model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="pattern_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="pattern_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="pattern_+3A_delta_e">Delta_e</code></td>
<td>
<p>Range of values for the prior on the sensitivity parameters used to identify the mean of the effects under MNAR. The value must be set to 0 under MAR.</p>
</td></tr>
<tr><td><code id="pattern_+3A_delta_c">Delta_c</code></td>
<td>
<p>Range of values for the prior on the sensitivity parameters used to identify the mean of the costs under MNAR. The value must be set to 0 under MAR.</p>
</td></tr>
<tr><td><code id="pattern_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="pattern_+3A_restriction">restriction</code></td>
<td>
<p>type of identifying restriction to be imposed to identify the distributions of the missing data in each pattern. 
Available choices are: complete case restrcition ('CC') - default - or available case restriction ('AC').</p>
</td></tr>
<tr><td><code id="pattern_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities within the range (0,1), representing the upper and lower
CI sample quantiles to be calculated and returned for the imputed values.</p>
</td></tr>
<tr><td><code id="pattern_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains.</p>
</td></tr>
<tr><td><code id="pattern_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="pattern_+3A_n.burnin">n.burnin</code></td>
<td>
<p>Number of warmup iterations.</p>
</td></tr>
<tr><td><code id="pattern_+3A_inits">inits</code></td>
<td>
<p>A list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the
<code>JAGS</code> model, or a function creating (possibly random) initial values. If <code>inits</code> is <code>NULL</code>, <code>JAGS</code>
will generate initial values for all the model parameters.</p>
</td></tr>
<tr><td><code id="pattern_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="pattern_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
<tr><td><code id="pattern_+3A_save_model">save_model</code></td>
<td>
<p>Logical. If <code>save_model</code> is <code>TRUE</code> a <code>txt</code> file containing the model code is printed
in the current working directory.</p>
</td></tr>
<tr><td><code id="pattern_+3A_prior">prior</code></td>
<td>
<p>A list containing the hyperprior values provided by the user. Each element of this list must be a vector of length two
containing the user-provided hyperprior values and must be named with the name of the corresponding parameter. For example, the hyperprior
values for the standard deviation effect parameters can be provided using the list <code>prior = list('sigma.prior.e' = c(0, 100))</code>.
For more information about how to provide prior hypervalues for different types of parameters and models see details. 
If <code>prior</code> is set to 'default', the default values will be used.</p>
</td></tr>
<tr><td><code id="pattern_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be provided by the user. Examples are <code>center = TRUE</code> to center all the covariates in the model 
or the additional arguments that can be provided to the function <code><a href="BCEA.html#topic+bcea">bcea</a></code> to summarise the health economic evaluation results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the distributions specified for the outcome variables in the arguments <code>dist_e</code> and
<code>dist_c</code> and the type of missingness mechanism specified in the argument <code>type</code>, different pattern mixture models
are built and run in the background by the function <code>pattern</code>. The model for the outcomes is fitted in each missingness pattern 
and the parameters indexing the missing data distributions are identified using: the corresponding parameters identified from the observed data
in other patterns (under 'MAR'); or a combination of the parameters identified by the observed data and some sensitivity parameters (under 'MNAR'). 
A simple example can be used to show how pattern mixture models are specified. 
Consider a data set comprising a response variable <code class="reqn">y</code> and a set of centered covariate <code class="reqn">X_j</code>. We denote with <code class="reqn">d_i</code> the patterns' indicator variable for each 
subject in the trial <code class="reqn">i = 1, ..., n</code> such that: <code class="reqn">d_i = 1</code> indicates the completers (both e and c observed), <code class="reqn">d_i = 2</code> and <code class="reqn">d_i = 3</code> indicate that 
only the costs or effects are observed, respectively, while <code class="reqn">d_i = 4</code> indicates that neither of the two outcomes is observed. In general, a different number of patterns 
can be observed between the treatment groups and <code>missingHE</code> accounts for this possibility by modelling a different patterns' indicator variables for each arm. 
For simplicity, in this example, we assume that the same number of patterns is observed in both groups. <code class="reqn">d_i</code> is assigned a multinomial distribution, 
which probabilities are modelled using a Dirichlet prior (by default giving to each pattern the same weight). Next, the model specified in <code>dist_e</code> 
and <code>dist_c</code> is fitted in each pattern. The parameters that cannot be identified by the observed data in each pattern (d = 2, 3, 4), e.g. the means.
<code class="reqn">mu_e[d]</code> and <code>mu_c[d]</code>, can be identified using the parameters estimated from other patterns. Two choices are currently available: the complete cases ('CC') or available cases ('AC').
For example, using the 'CC' restriction, the parameters indexing the distributions of the missing data are identified as: 
</p>
<p style="text-align: center;"><code class="reqn">mu_e[2] = \mu_e[4] = \mu_e[1] + \Delta_e</code>
</p>

<p style="text-align: center;"><code class="reqn">mu_c[3] = \mu_c[4] = \mu_c[1] + \Delta_c</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">\mu_e[1]</code> is the effects mean for the completers.
</p>
</li>
<li> <p><code class="reqn">\mu_c[1]</code> is the costs mean for the completers.
</p>
</li>
<li> <p><code class="reqn">\Delta_e</code> is the sensitivity parameters associated with the marginal effects mean.
</p>
</li>
<li> <p><code class="reqn">\Delta_c</code> is the sensitivity parameters associated with the marginal costs mean.
</p>
</li></ul>

<p>If the 'AC' restriction is chosen, only the parameters estimated from the observed data in pattern 2 (costs) and pattern 3 (effects) are used to identify those in the other patterns.  
When <code class="reqn">\Delta_e = 0</code> and <code class="reqn">\Delta_c = 0</code> the model assumes a 'MAR' mechanism. When <code class="reqn">\Delta_e != 0</code> and/or <code class="reqn">\Delta_c != 0</code> 'MNAR' departues for the 
effects and/or costs are explored assuming a Uniform prior distributions for the sensitivity parameters. The range of values for these priors is defined based on the
boundaries specified in <code>Delta_e</code> and <code>Delta_c</code> (see Arguments), which must be provided by the user. 
When user-defined hyperprior values are supplied via the argument <code>prior</code> in the function <code>pattern</code>, the elements of this list (see Arguments)
must be vectors of length two containing the user-provided hyperprior values and must take specific names according to the parameters they are associated with. 
Specifically, the names for the parameters indexing the model which are accepted by <strong>missingHE</strong> are the following:
</p>

<ul>
<li><p> location parameters <code class="reqn">\alpha_0</code> and <code class="reqn">\beta_0</code>: &quot;mean.prior.e&quot;(effects) and/or &quot;mean.prior.c&quot;(costs)
</p>
</li>
<li><p> auxiliary parameters <code class="reqn">\sigma</code>: &quot;sigma.prior.e&quot;(effects) and/or &quot;sigma.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_j</code>: &quot;alpha.prior&quot;(effects) and/or &quot;beta.prior&quot;(costs)
</p>
</li></ul>
 
<p>The only exception is the missingness patterns' probability <code class="reqn">\pi</code>, denoted with &quot;patterns.prior&quot;, whose hyperprior values must be provided as a list
formed by two elements. These must be vectors of the same length equal to the number of patterns in the control (first element) and intervention (second element) group.
</p>
<p>For each model, random effects can also be specified for each parameter by adding the term + (x | z) to each model formula, 
where x is the fixed regression coefficient for which also the random effects are desired and z is the clustering variable across which 
the random effects are specified (must be the name of a factor variable in the dataset). Multiple random effects can be specified using the 
notation + (x1 + x2 | site) for each covariate that was included in the fixed effects formula. Random intercepts are included by default in the models
if a random effects are specified but they can be removed by adding the term 0 within the random effects formula, e.g. + (0 + x | z).
</p>


<h3>Value</h3>

<p>An object of the class 'missingHE' containing the following elements
</p>

<dl>
<dt>data_set</dt><dd><p>A list containing the original data set provided in <code>data</code> (see Arguments), the number of observed and missing individuals 
, the total number of individuals by treatment arm and the indicator vectors for the missing values</p>
</dd>
<dt>model_output</dt><dd><p>A list containing the output of a <code>JAGS</code> model generated from the functions <code><a href="R2jags.html#topic+jags">jags</a></code>, and 
the posterior samples for the main parameters of the model and the imputed values</p>
</dd>
<dt>cea</dt><dd><p>A list containing the output of the economic evaluation performed using the function <code><a href="BCEA.html#topic+bcea">bcea</a></code></p>
</dd>
<dt>type</dt><dd><p>A character variable that indicate which type of missingness assumption has been used to run the model, 
either <code>MAR</code> or <code>MNAR</code> (see details)</p>
</dd>
<dt>data_format</dt><dd><p>A character variable that indicate which type of analysis was conducted, either using a <code>wide</code> or <code>longitudinal</code> dataset</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Daniels, MJ. Hogan, JW. <em>Missing Data in Longitudinal Studies: strategies for Bayesian modelling and sensitivity analysis</em>, CRC/Chapman Hall.
</p>
<p>Baio, G.(2012). <em>Bayesian Methods in Health Economics</em>. CRC/Chapman Hall, London.
</p>
<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">jags</a></code>, <code><a href="BCEA.html#topic+bcea">bcea</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Quck example to run using subset of MenSS dataset
MenSS.subset &lt;- MenSS[50:100, ]

# Run the model using the pattern function assuming a SCAR mechanism
# Use only 100 iterations to run a quick check
model.pattern &lt;- pattern(data = MenSS.subset,model.eff = e~1,model.cost = c~1,
   dist_e = "norm", dist_c = "norm",type = "MAR", Delta_e = 0, Delta_c = 0, 
   n.chains = 2, n.iter = 100, ppc = FALSE)

# Print the results of the JAGS model
print(model.pattern)
#

# Use dic information criterion to assess model fit
pic.dic &lt;- pic(model.pattern, criterion = "dic", module = "total")
pic.dic
#

# Extract regression coefficient estimates
coef(model.pattern)
#



# Assess model convergence using graphical tools
# Produce histograms of the posterior samples for the mean effects
diag.hist &lt;- diagnostic(model.pattern, type = "histogram", param = "mu.e")
#

# Compare observed effect data with imputations from the model
# using plots (posteiror means and credible intervals)
p1 &lt;- plot(model.pattern, class = "scatter", outcome = "effects")
#

# Summarise the CEA information from the model
summary(model.pattern)


# Further examples which take longer to run
model.pattern &lt;- pattern(data = MenSS, model.eff = e ~ u.0,model.cost = c ~ e,
   Delta_e = 0, Delta_c = 0, dist_e = "norm", dist_c = "norm",
   type = "MAR", n.chains = 2, n.iter = 500, ppc = FALSE)
#
# Print results for all imputed values
print(model.pattern, value.mis = TRUE)

# Use looic to assess model fit
pic.looic&lt;-pic(model.pattern, criterion = "looic", module = "total")
pic.looic

# Show density plots for all parameters
diag.hist &lt;- diagnostic(model.pattern, type = "denplot", param = "all")

# Plots of imputations for all data
p1 &lt;- plot(model.pattern, class = "scatter", outcome = "all")

# Summarise the CEA results
summary(model.pattern)


#
#
</code></pre>

<hr>
<h2 id='PBS'>PBS economic data on intellectual disability and challenging behaviour</h2><span id='topic+PBS'></span>

<h3>Description</h3>

<p>Longitudinal data from a cluster RCT trial (The PBS trial) on people suffering from intellectual disability and challenging behaviour.
A total of 244 individuals across 23 sites were enrolled in the trial: 136 in the control (t=1) and 108 in the active intervention (t=2).
Health economic outcome data were collected via self-reported questionnaires at three time points throughout the study: baseline (time=1),
6 months (time=2) and 12 months (time=3) follow-up, and included utility scores related to quality of life and costs. 
Baseline data are available for age, gender, ethnicity, living status, type of carer, marital status, and disability level variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PBS)
</code></pre>


<h3>Format</h3>

<p>A data frame with 732 rows and 16 variables
</p>


<h3>Details</h3>


<dl>
<dt>id</dt><dd><p>id number</p>
</dd>
<dt>time</dt><dd><p>time indicator</p>
</dd>
<dt>u</dt><dd><p>utilities</p>
</dd>
<dt>c</dt><dd><p>costs (in pounds)</p>
</dd>
<dt>age</dt><dd><p>Age in years</p>
</dd>
<dt>gender</dt><dd><p>binary: male (1) and female (0)</p>
</dd>
<dt>ethnicity</dt><dd><p>binary: white (1) and other (0)</p>
</dd>
<dt>carer</dt><dd><p>binary: paid carer (1) and family carer (0)</p>
</dd>
<dt>marital</dt><dd><p>binary: single (1) and married (0)</p>
</dd>
<dt>living</dt><dd><p>categorical: alone (1), with partner (2) and with parents (3)</p>
</dd>
<dt>disability</dt><dd><p>categorical: mild (1), moderate (2) and severe (3)</p>
</dd>
<dt>site</dt><dd><p>site number</p>
</dd>
</dl>



<h3>References</h3>

<p>Hassiotis et al. (2014) BMC Psychiatry 14
(<a href="https://pubmed.ncbi.nlm.nih.gov/25927187/">PubMed</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PBS &lt;- data(PBS)
summary(PBS)
str(PBS)
</code></pre>

<hr>
<h2 id='pic'>Predictive information criteria for Bayesian models fitted in <code>JAGS</code> using the funciton <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code></h2><span id='topic+pic'></span>

<h3>Description</h3>

<p>Efficient approximate leave-one-out cross validation (LOO), deviance information criterion (DIC) and widely applicable information criterion (WAIC) for Bayesian models, 
calculated on the observed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pic(x, criterion = "dic", module = "total")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pic_+3A_x">x</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of a Bayesian model fitted in cost-effectiveness analysis using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, 
<code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.</p>
</td></tr>
<tr><td><code id="pic_+3A_criterion">criterion</code></td>
<td>
<p>type of information criteria to be produced. Available choices are <code>'dic'</code> for the Deviance Information Criterion, 
<code>'waic'</code> for the Widely Applicable Information Criterion, and <code>'looic'</code> for the Leave-One-Out Information Criterion.</p>
</td></tr>
<tr><td><code id="pic_+3A_module">module</code></td>
<td>
<p>The modules with respect to which the information criteria should be computed. Available choices are <code>'total'</code> for the whole model, 
<code>'e'</code> for the effectiveness variables only (<code>'u'</code> for longitudinal models), <code>'c'</code> for the cost variables only, and <code>'both'</code> for both outcome variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Deviance Information Criterion (DIC), Leave-One-Out Information Criterion (LOOIC) and the Widely Applicable Information Criterion (WAIC) are methods for estimating 
out-of-sample predictive accuracy from a Bayesian model using the log-likelihood evaluated at the posterior simulations of the parameters. If <code>x</code> contains the results from 
a longitudinal model, all parameter names indexed by &quot;e&quot; should be instead indexed by &quot;u&quot;. In addition, for longitudinal models information criteria results are displayed by time
and only a general approximation to the total value of the criteria and pD is given as the sum of the corresponding measures computed at each time point. 
DIC is computationally simple to calculate but it is known to have some problems, arising in part from it not being fully Bayesian in that it is based on a point estimate.
LOOIC can be computationally expensive but can be easily approximated using importance weights that are smoothed by fitting a generalised Pareto distribution to the upper tail 
of the distribution of the importance weights. For more details about the methods used to compute LOOIC see the PSIS-LOO section in <code><a href="loo.html#topic+loo-package">loo-package</a></code>.
WAIC is fully Bayesian and closely approximates Bayesian cross-validation. Unlike DIC, WAIC is invariant to parameterisation and also works for singular models. 
In finite cases, WAIC and LOO give similar estimates, but for influential observations WAIC underestimates the effect of leaving out one observation.
</p>


<h3>Value</h3>

<p>A named list containing different predictive information criteria results and quantities according to the value of <code>criterion</code>. In all cases, the measures are 
computed on the observed data for the specific modules of the model selected in <code>module</code>.
</p>

<dl>
<dt>d_bar</dt><dd><p>Posterior mean deviance (only if <code>criterion</code> is <code>'dic'</code>).</p>
</dd>
<dt>pD</dt><dd><p>Effective number of parameters calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd></dl>
<p>.
</p>
<dl>
<dt>dic</dt><dd><p>Deviance Information Criterion calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd></dl>
<p>. 
</p>
<dl>
<dt>d_hat</dt><dd><p>Deviance evaluated at the posterior mean of the parameters and calculated with the formula used by <code>JAGS</code> (only if <code>criterion</code> is <code>'dic'</code>)</p>
</dd>
<dt>elpd, elpd_se</dt><dd><p>Expected log pointwise predictive density and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>p, p_se</dt><dd><p>Effective number of parameters and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>looic, looic_se</dt><dd><p>The leave-one-out information criterion and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'loo'</code>).</p>
</dd>
<dt>waic, waic_se</dt><dd><p>The widely applicable information criterion and standard error calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code>).</p>
</dd>
<dt>pointwise</dt><dd><p>A matrix containing the pointwise contributions of each of the above measures calculated on the observed data for the model nodes indicated in <code>module</code>
(only if <code>criterion</code> is <code>'waic'</code> or <code>'loo'</code>).</p>
</dd>
<dt>pareto_k</dt><dd><p>A vector containing the estimates of the shape parameter <code class="reqn">k</code> for the generalised Pareto fit to the importance ratios for each leave-one-out distribution 
calculated on the observed data for the model nodes indicated in <code>module</code> (only if <code>criterion</code> is <code>'loo'</code>). 
See <code><a href="loo.html#topic+loo">loo</a></code> for details about interpreting <code class="reqn">k</code>.</p>
</dd>
<dt>sum_dic</dt><dd><p>DIC value calculated by summing up all model dic evaluated at each time point (only for longitudinal models). Similar estimates can
are obtained also for the other criteria, either <code>sum_waic</code> or <code>sum_looic</code>.</p>
</dd>
<dt>sum_pdic</dt><dd><p>DIC value calculated by summing up all model effective number of parameter estimates based on dic evaluated at each time point (only for longitudinal models). Similar estimates can
are obtained also for the other criteria, either <code>sum_pwaic</code> or <code>sum_plooic</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>
<p>Vehtari, A. Gelman, A. Gabry, J. (2016a) Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. 
<em>Statistics and Computing</em>. Advance online publication.
</p>
<p>Vehtari, A. Gelman, A. Gabry, J. (2016b) Pareto smoothed importance sampling. <em>ArXiv</em> preprint.
</p>
<p>Gelman, A. Hwang, J. Vehtari, A. (2014) Understanding predictive information criteria for Bayesian models. 
<em>Statistics and Computing</em> 24, 997-1016. 
</p>
<p>Watanable, S. (2010). Asymptotic equivalence of Bayes cross validation and widely application information 
criterion in singular learning theory. <em>Journal of Machine Learning Research</em> 11, 3571-3594.
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">jags</a></code>, <code><a href="loo.html#topic+loo">loo</a></code>, <code><a href="loo.html#topic+waic">waic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
# 
# 
</code></pre>

<hr>
<h2 id='plot.missingHE'>Plot method for the imputed data contained in the objects of class <code>missingHE</code></h2><span id='topic+plot.missingHE'></span>

<h3>Description</h3>

<p>Produces a plot of the observed and imputed values (with credible intervals) for the effect and cost outcomes from a
Bayesian cost-effectiveness analysis model with two treatment arms, implemented using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.
The graphical layout is obtained from the functions contained in the package <strong>ggplot2</strong> and <strong>ggthemes</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'missingHE'
plot(
  x,
  prob = c(0.025, 0.975),
  class = "scatter",
  outcome = "all",
  time_plot = NULL,
  theme = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.missingHE_+3A_x">x</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of the Bayesian model for cost-effectiveness analysis.</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities representing the upper and lower CI sample quantiles to be calculated and returned for the imputed values.</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_class">class</code></td>
<td>
<p>Type of the plot comparing the observed and imputed outcome data. Available choices are
'histogram' and 'scatter' for a histogram or a scatter plot of the observed and imputed outcome data, respectively.</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_outcome">outcome</code></td>
<td>
<p>The outcome variables that should be displayed. Options are: 'all' (default) which shows the plots
for both treatment arms, time points (only for longitudinal models) and types of outcome variables; 'effects' and 'costs' which show the plots for the corresponding
outcome variables in both arms; 'arm1' and 'arm2' which show the plots by the selected treatment arm. To select
the plots for a specific outcome in a specific treatment arm the options that can be used are 'effects_arm1',
'effects_arm2', 'costs_arm1' or 'costs_arm2'.</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_time_plot">time_plot</code></td>
<td>
<p>Time point for which plots should be displayed (only for longitudinal models).</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_theme">theme</code></td>
<td>
<p>Type of ggplot theme among some pre-defined themes, mostly taken from the package <strong>ggthemes</strong>. For a full list of available themes see details.</p>
</td></tr>
<tr><td><code id="plot.missingHE_+3A_...">...</code></td>
<td>
<p>Additional parameters that can be provided to manage the output of <code>plot.missingHE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a plot of the observed and imputed effect and cost data in a two-arm based 
cost-effectiveness model implemented using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>. The purpose of this graph
is to visually compare the outcome values for the fully-observed individuals with those imputed by the model for the missing individuals.
For the scatter plot, imputed values are also associated with the credible intervals specified in the argument <code>prob</code>.
The argument <code>theme</code> allows to customise the graphical aspect of the plots generated by <code>plot.missingHE</code> and
allows to choose among a set of possible pre-defined themes taken form the package <strong>ggtheme</strong>. For a complete list of the available character names
for each theme and scheme set, see <strong>ggthemes</strong> and <strong>bayesplot</strong>.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object containing the plots specified in the argument <code>class</code>.
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Daniels, MJ. Hogan, JW. (2008) <em>Missing Data in Longitudinal Studies: strategies for Bayesian modelling and sensitivity analysis</em>, CRC/Chapman Hall.
</p>
<p>Molenberghs, G. Fitzmaurice, G. Kenward, MG. Tsiatis, A. Verbeke, G. (2015) <em>Handbook of Missing Data Methodology</em>, CRC/Chapman Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code> <code><a href="#topic+selection_long">selection_long</a></code> <code><a href="#topic+pattern">pattern</a></code> <code><a href="#topic+hurdle">hurdle</a></code> <code><a href="#topic+diagnostic">diagnostic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
#
#
</code></pre>

<hr>
<h2 id='ppc'>Posterior predictive checks for assessing the fit to the observed data of Bayesian models implemented in <code>JAGS</code> using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code></h2><span id='topic+ppc'></span>

<h3>Description</h3>

<p>The focus is restricted to full Bayesian models in cost-effectiveness analyses based on the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>,
<code><a href="#topic+pattern">pattern</a></code> and <code><a href="#topic+hurdle">hurdle</a></code>, with the fit to the observed data being assessed through graphical checks based on the posterior replications 
generated from the model. Examples include the comparison of histograms, density plots, intervals, test statistics, evaluated using both the observed and replicated data.
Different types of posterior predictive checks are implemented to assess model fit using functions contained in the package <strong>bayesplot</strong>. 
Graphics and plots are managed using functions contained in the package <strong>ggplot2</strong> and <strong>ggthemes</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc(
  x,
  type = "histogram",
  outcome = "all",
  ndisplay = 15,
  time_plot = NULL,
  theme = NULL,
  scheme_set = NULL,
  legend = "top",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppc_+3A_x">x</code></td>
<td>
<p>An object of class &quot;missingHE&quot; containing the posterior results of a full Bayesian model implemented using the function <code><a href="#topic+selection">selection</a></code>, 
<code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.</p>
</td></tr>
<tr><td><code id="ppc_+3A_type">type</code></td>
<td>
<p>Type of posterior predictive check to be plotted for assessing model fit. Available choices include: 'histogram', 'boxplot', 
'freqpoly', 'dens', 'dens_overlay' and ecdf_overlay', which compare the empirical and repicated distributions of the data; 'stat' and 'stat_2d', which compare
the value of some statistics evaluated on the observed data with the replicated values for those statistics from the posterior predictions; 'error_hist', 
'error_scatter', 'error_scatter_avg' and 'error_binned', which display the predictive errors of the model; 'intervals' and 'ribbon', which compare medians and
central interval estimates of the replications with the observed data overlaid; 'scatter' and 'scatter_avg', which display scatterplots of the observed and replicated data.</p>
</td></tr>
<tr><td><code id="ppc_+3A_outcome">outcome</code></td>
<td>
<p>The outcome variables that should be displayed. Use the names 'effects_arm1' and effects_arm2' for the effectiveness in the control and intervention arm; 
use costs_arm1' or 'costs_arm2' for the costs; use &quot;effects&quot; or &quot;costs&quot; for the respective outcome in both arms; use &quot;all&quot; for all outcomes.</p>
</td></tr>
<tr><td><code id="ppc_+3A_ndisplay">ndisplay</code></td>
<td>
<p>Number of posterior replications to be displayed in the plots.</p>
</td></tr>
<tr><td><code id="ppc_+3A_time_plot">time_plot</code></td>
<td>
<p>Time point for which posterior predictive checks should be displayed (only for longitudinal models).</p>
</td></tr>
<tr><td><code id="ppc_+3A_theme">theme</code></td>
<td>
<p>Type of ggplot theme among some pre-defined themes, mostly taken from the package <strong>ggthemes</strong>. For a full list of available themes see details.</p>
</td></tr>
<tr><td><code id="ppc_+3A_scheme_set">scheme_set</code></td>
<td>
<p>Type of scheme sets among some pre-defined schemes, mostly taken from the package <strong>bayesplot</strong>. For a full list of available themes see details.</p>
</td></tr>
<tr><td><code id="ppc_+3A_legend">legend</code></td>
<td>
<p>Position of the legend: available choices are: &quot;top&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot; and &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="ppc_+3A_...">...</code></td>
<td>
<p>Additional parameters that can be provided to manage the output of <code>ppc</code>. For more details see <strong>bayesplot</strong>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The funciton produces different types of graphical posterior predictive checks using the estimates from a Bayesian cost-effectiveness model implemented
with the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>. The purpose of these checks is to visually compare the distribution (or some relevant quantity)
of the observed data with respect to that from the replicated data for both effectiveness and cost outcomes in each treatment arm. Since predictive checks are meaningful 
only with respect to the observed data, only the observed outcome values are used to assess the fit of the model.
The arguments <code>theme</code> and <code>scheme_set</code> allow to customise the graphical aspect of the plots generated by <code>ppc</code> and allow to choose among a set of possible 
pre-defined themes and scheme sets taken form the package <strong>ggtheme</strong> and <code>bayesplot</code>. For a complete list of the available character names for each theme and scheme set, see <strong>ggthemes</strong> and <strong>bayesplot</strong>.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object containing the plots specified in the argument <code>type</code>.
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> <code><a href="#topic+hurdle">hurdle</a></code> <code><a href="#topic+diagnostic">diagnostic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
#
#
</code></pre>

<hr>
<h2 id='print.missingHE'>Print method for the posterior results contained in the objects of class <code>missingHE</code></h2><span id='topic+print.missingHE'></span>

<h3>Description</h3>

<p>Prints the summary table for the model fitted, with the estimate of the parameters and/or missing values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'missingHE'
print(x, value.mis = FALSE, only.means = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.missingHE_+3A_x">x</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of the Bayesian model run using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.</p>
</td></tr>
<tr><td><code id="print.missingHE_+3A_value.mis">value.mis</code></td>
<td>
<p>Logical. If <code>value.mis</code> is <code>TRUE</code>, the model results displayed contain also the imputed values,
else if <code>value.mis</code> is <code>FALSE</code> the missing values are hidden.</p>
</td></tr>
<tr><td><code id="print.missingHE_+3A_only.means">only.means</code></td>
<td>
<p>Logical. If <code>only.means</code> is <code>TRUE</code>, then the <code>print</code> function only shows the summary
statistics for the mean effectiveness and costs. Defaults at <code>FALSE</code> (in which case, shows the summary statistics
for all parameters in the model).</p>
</td></tr>
<tr><td><code id="print.missingHE_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the printed output produced. For example: <code>digits=</code> number of 
significant digits to be shown in the printed table (default=3). Not available if <code>value.mis=</code>TRUE.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# For examples see the function \code{\link{selection}}, \code{\link{selection_long}}, 
# \code{\link{pattern}} or \code{\link{hurdle}}
# 
# 
</code></pre>

<hr>
<h2 id='prior_hurdle'>An internal function to change the hyperprior parameters in the hurdle model provided by the user depending on the type of
structural value mechanism and outcome distributions assumed</h2><span id='topic+prior_hurdle'></span>

<h3>Description</h3>

<p>This function modifies default hyper prior parameter values in the type of hurdle model selected according 
to the type of structural value mechanism and distributions for the outcomes assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_hurdle(
  type,
  dist_e,
  dist_c,
  pe_fixed,
  pc_fixed,
  ze_fixed,
  zc_fixed,
  model_e_random,
  model_c_random,
  model_se_random,
  model_sc_random,
  pe_random,
  pc_random,
  ze_random,
  zc_random,
  se,
  sc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_hurdle_+3A_type">type</code></td>
<td>
<p>Type of structural value mechanism assumed. Choices are Structural Completely At Random (SCAR),
and Structural At Random (SAR). For a complete list of all available hyper parameters 
and types of models see the manual.</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_dist_c">dist_c</code></td>
<td>
<p>distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_ze_fixed">ze_fixed</code></td>
<td>
<p>Number of fixed effects or the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_model_se_random">model_se_random</code></td>
<td>
<p>Random effects formula for the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_model_sc_random">model_sc_random</code></td>
<td>
<p>Random effects formula for the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_ze_random">ze_random</code></td>
<td>
<p>Number of random effects or the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_se">se</code></td>
<td>
<p>Structural value for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_hurdle_+3A_sc">sc</code></td>
<td>
<p>Structural value for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='prior_pattern'>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of
missingness mechanism and outcome distributions assumed</h2><span id='topic+prior_pattern'></span>

<h3>Description</h3>

<p>This function modifies default hyper prior parameter values in the type of selection model selected according 
to the type of missingness mechanism and distributions for the outcomes assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_pattern(
  type,
  dist_e,
  dist_c,
  pe_fixed,
  pc_fixed,
  model_e_random,
  model_c_random,
  pe_random,
  pc_random,
  d_list,
  restriction
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_pattern_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR). For a complete list of all available hyper parameters 
and types of models see the manual.</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_d_list">d_list</code></td>
<td>
<p>a list of the number and types of patterns in the data</p>
</td></tr>
<tr><td><code id="prior_pattern_+3A_restriction">restriction</code></td>
<td>
<p>type of identifying restriction to be imposed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='prior_selection'>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of
missingness mechanism and outcome distributions assumed</h2><span id='topic+prior_selection'></span>

<h3>Description</h3>

<p>This function modifies default hyper prior parameter values in the type of selection model selected according 
to the type of missingness mechanism and distributions for the outcomes assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_selection(
  type,
  dist_e,
  dist_c,
  pe_fixed,
  pc_fixed,
  ze_fixed,
  zc_fixed,
  model_e_random,
  model_c_random,
  model_me_random,
  model_mc_random,
  pe_random,
  pc_random,
  ze_random,
  zc_random
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_selection_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR). For a complete list of all available hyper parameters 
and types of models see the manual.</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_ze_fixed">ze_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_model_me_random">model_me_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_model_mc_random">model_mc_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_ze_random">ze_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='prior_selection_long'>An internal function to change the hyperprior parameters in the selection model provided by the user depending on the type of
missingness mechanism and outcome distributions assumed</h2><span id='topic+prior_selection_long'></span>

<h3>Description</h3>

<p>This function modifies default hyper prior parameter values in the type of selection model selected according 
to the type of missingness mechanism and distributions for the outcomes assumed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_selection_long(
  type,
  dist_u,
  dist_c,
  pu_fixed,
  pc_fixed,
  zu_fixed,
  zc_fixed,
  model_u_random,
  model_c_random,
  model_mu_random,
  model_mc_random,
  pu_random,
  pc_random,
  zu_random,
  zc_random
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_selection_long_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR). For a complete list of all available hyper parameters 
and types of models see the manual.</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_dist_u">dist_u</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_pu_fixed">pu_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_zu_fixed">zu_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_model_u_random">model_u_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_model_mu_random">model_mu_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_model_mc_random">model_mc_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_pu_random">pu_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_zu_random">zu_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="prior_selection_long_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#no examples
#
#
</code></pre>

<hr>
<h2 id='run_hurdle'>An internal function to execute a JAGS hurdle model and get posterior results</h2><span id='topic+run_hurdle'></span>

<h3>Description</h3>

<p>This function fits a JAGS using the <code><a href="R2jags.html#topic+jags">jags</a></code> funciton and obtain posterior inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_hurdle(type, dist_e, dist_c, inits, se, sc, sde, sdc, ppc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_hurdle_+3A_type">type</code></td>
<td>
<p>Type of structural value mechanism assumed. Choices are Structural Completely At Random (SCAR),
and Structural At Random (SAR).</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_dist_c">dist_c</code></td>
<td>
<p>distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_inits">inits</code></td>
<td>
<p>a list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the BUGS model, 
or a function creating (possibly random) initial values. If inits is NULL, JAGS will generate initial values for parameters</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_se">se</code></td>
<td>
<p>Structural value to be found in the effect data. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the effects is run.</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_sc">sc</code></td>
<td>
<p>Structural value to be found in the cost data. If set to <code>NULL</code>, 
no structural value is chosen and a standard model for the costs is run.</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_sde">sde</code></td>
<td>
<p>hyper-prior value for the standard deviation of the distribution of the structural effects. The default value is
<code>1.0E-6</code> to approximate a point mass at the structural value provided by the user.</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_sdc">sdc</code></td>
<td>
<p>hyper-prior value for the standard deviation of the distribution of the structural costs. The default value is
<code>1.0E-6</code> to approximate a point mass at the structural value provided by the user.</p>
</td></tr>
<tr><td><code id="run_hurdle_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='run_pattern'>An internal function to execute a JAGS pattern mixture model and get posterior results</h2><span id='topic+run_pattern'></span>

<h3>Description</h3>

<p>This function fits a JAGS using the <code><a href="R2jags.html#topic+jags">jags</a></code> funciton and obtain posterior inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_pattern(type, dist_e, dist_c, inits, d_list, d1, d2, restriction, ppc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_pattern_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR).</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_inits">inits</code></td>
<td>
<p>a list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the BUGS model, 
or a function creating (possibly random) initial values. If inits is NULL, JAGS will generate initial values for parameters.</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_d_list">d_list</code></td>
<td>
<p>a list of the number and types of patterns in the data.</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_d1">d1</code></td>
<td>
<p>Patterns in the control.</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_d2">d2</code></td>
<td>
<p>Patterns in the intervention.</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_restriction">restriction</code></td>
<td>
<p>type of identifying restriction to be imposed.</p>
</td></tr>
<tr><td><code id="run_pattern_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='run_selection'>An internal function to execute a JAGS selection model and get posterior results</h2><span id='topic+run_selection'></span>

<h3>Description</h3>

<p>This function fits a JAGS using the <code><a href="R2jags.html#topic+jags">jags</a></code> funciton and obtain posterior inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_selection(type, dist_e, dist_c, inits, ppc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_selection_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR).</p>
</td></tr>
<tr><td><code id="run_selection_+3A_dist_e">dist_e</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="run_selection_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="run_selection_+3A_inits">inits</code></td>
<td>
<p>a list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the BUGS model, 
or a function creating (possibly random) initial values. If inits is NULL, JAGS will generate initial values for parameters.</p>
</td></tr>
<tr><td><code id="run_selection_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='run_selection_long'>An internal function to execute a JAGS selection model and get posterior results</h2><span id='topic+run_selection_long'></span>

<h3>Description</h3>

<p>This function fits a JAGS using the <code><a href="R2jags.html#topic+jags">jags</a></code> funciton and obtain posterior inferences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_selection_long(type, dist_u, dist_c, inits, ppc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_selection_long_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR).</p>
</td></tr>
<tr><td><code id="run_selection_long_+3A_dist_u">dist_u</code></td>
<td>
<p>distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="run_selection_long_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="run_selection_long_+3A_inits">inits</code></td>
<td>
<p>a list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the BUGS model, 
or a function creating (possibly random) initial values. If inits is NULL, JAGS will generate initial values for parameters.</p>
</td></tr>
<tr><td><code id="run_selection_long_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='selection'>Full Bayesian Models to handle missingness in Economic Evaluations (Selection Models)</h2><span id='topic+selection'></span>

<h3>Description</h3>

<p>Full Bayesian cost-effectiveness models to handle missing data in the outcomes under different missing data 
mechanism assumptions, using alternative parametric distributions for the effect and cost variables and 
using a selection model approach to identify the model. The analysis is performed using the <code>BUGS</code> language, 
which is implemented in the software <code>JAGS</code> using the function <code><a href="R2jags.html#topic+jags">jags</a></code> The output is stored in an object of class 'missingHE'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection(
  data,
  model.eff,
  model.cost,
  model.me = me ~ 1,
  model.mc = mc ~ 1,
  dist_e,
  dist_c,
  type,
  prob = c(0.025, 0.975),
  n.chains = 2,
  n.iter = 20000,
  n.burnin = floor(n.iter/2),
  inits = NULL,
  n.thin = 1,
  ppc = FALSE,
  save_model = FALSE,
  prior = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selection_+3A_data">data</code></td>
<td>
<p>A data frame in which to find the variables supplied in <code>model.eff</code>, <code>model.cost</code> (model formulas for effects and costs) 
and <code>model.me</code>, <code>model.mc</code> (model formulas for the missing effect and cost models). Among these,
effectiveness, cost and treatment indicator (only two arms) variables must always be provided and named 'e', 'c' and 't', respectively.</p>
</td></tr>
<tr><td><code id="selection_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
effectiveness outcome ('e') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
cost outcome ('c') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model. 
A joint bivariate distribution for effects and costs can be specified by including 'e' on the right-hand side of the formula for the costs model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_+3A_model.me">model.me</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the 
term 'me'(missing effects) and any covariates must be provided on the right-hand side of the formula. If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. 
By default, covariates are placed on the &quot;probability&quot; parameter for the missing effects through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_+3A_model.mc">model.mc</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the term 'mc'(missing costs) and any covariates must be provided on the right-hand side of the formula. 
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;probability&quot; parameter for the missing costs through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="selection_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="selection_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="selection_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities within the range (0,1), representing the upper and lower
CI sample quantiles to be calculated and returned for the imputed values.</p>
</td></tr>
<tr><td><code id="selection_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains.</p>
</td></tr>
<tr><td><code id="selection_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="selection_+3A_n.burnin">n.burnin</code></td>
<td>
<p>Number of warmup iterations.</p>
</td></tr>
<tr><td><code id="selection_+3A_inits">inits</code></td>
<td>
<p>A list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the
<code>JAGS</code> model, or a function creating (possibly random) initial values. If <code>inits</code> is <code>NULL</code>, <code>JAGS</code>
will generate initial values for all the model parameters.</p>
</td></tr>
<tr><td><code id="selection_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="selection_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
<tr><td><code id="selection_+3A_save_model">save_model</code></td>
<td>
<p>Logical. If <code>save_model</code> is <code>TRUE</code>, a <code>txt</code> file containing the model code is printed
in the current working directory.</p>
</td></tr>
<tr><td><code id="selection_+3A_prior">prior</code></td>
<td>
<p>A list containing the hyperprior values provided by the user. Each element of this list must be a vector of length two
containing the user-provided hyperprior values and must be named with the name of the corresponding parameter. For example, the hyperprior
values for the standard deviation effect parameters can be provided using the list <code>prior = list('sigma.prior.e' = c(0, 100))</code>.
For more information about how to provide prior hypervalues for different types of parameters and models see details. 
If <code>prior</code> is set to 'default', the default values will be used.</p>
</td></tr>
<tr><td><code id="selection_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be provided by the user. Examples are <code>center = TRUE</code> to center all the covariates in the model 
or the additional arguments that can be provided to the function <code><a href="BCEA.html#topic+bcea">bcea</a></code> to summarise the health economic evaluation results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the distributions specified for the outcome variables in the arguments <code>dist_e</code> and
<code>dist_c</code> and the type of missingness mechanism specified in the argument <code>type</code>, different selection models
are built and run in the background by the function <code>selection</code>. These models consist in logistic regressions that are used to estimate
the probability of missingness in one or both the outcomes. A simple example can be used to show how selection models are specified. 
Consider a data set comprising a response variable <code class="reqn">y</code> and a set of centered covariate <code class="reqn">X_j</code>. For each subject in the trial <code class="reqn">i = 1, ..., n</code>
we define an indicator variable <code class="reqn">m_i</code> taking value <code>1</code> if the <code class="reqn">i</code>-th individual is associated with a missing value and <code>0</code> otherwise.
This is modelled as:
</p>
<p style="text-align: center;"><code class="reqn">m_i ~ Bernoulli(\pi_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(\pi_i) = \gamma_0 + \sum\gamma_j X_j + \delta(y)</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">\pi_i</code> is the individual probability of a missing value in <code class="reqn">y</code>
</p>
</li>
<li> <p><code class="reqn">\gamma_0</code> represents the marginal probability of a missing value in <code class="reqn">y</code> on the logit scale.
</p>
</li>
<li> <p><code class="reqn">\gamma_j</code> represents the impact on the probability of a missing value in <code class="reqn">y</code> of the centered covariates <code class="reqn">X_j</code>.
</p>
</li>
<li> <p><code class="reqn">\delta</code> represents the impact on the probability of a missing value in <code class="reqn">y</code> of the missing value itself.
</p>
</li></ul>

<p>When <code class="reqn">\delta = 0</code> the model assumes a 'MAR' mechanism, while when <code class="reqn">\delta != 0</code> the mechanism is 'MNAR'. For the parameters indexing the missingness model, 
the default prior distributions assumed are the following:
</p>

<ul>
<li> <p><code class="reqn">\gamma_0 ~ Logisitc(0, 1)</code>
</p>
</li>
<li> <p><code class="reqn">\gamma_j ~ Normal(0, 0.01)</code>
</p>
</li>
<li> <p><code class="reqn">\delta ~ Normal(0, 1)</code>
</p>
</li></ul>

<p>When user-defined hyperprior values are supplied via the argument <code>prior</code> in the function <code>selection</code>, the elements of this list (see Arguments)
must be vectors of length two containing the user-provided hyperprior values and must take specific names according to the parameters they are associated with. 
Specifically, the names for the parameters indexing the model which are accepted by <strong>missingHE</strong> are the following:
</p>

<ul>
<li><p> location parameters <code class="reqn">\alpha_0</code> and <code class="reqn">\beta_0</code>: &quot;mean.prior.e&quot;(effects) and/or &quot;mean.prior.c&quot;(costs)
</p>
</li>
<li><p> auxiliary parameters <code class="reqn">\sigma</code>: &quot;sigma.prior.e&quot;(effects) and/or &quot;sigma.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_j</code>: &quot;alpha.prior&quot;(effects) and/or &quot;beta.prior&quot;(costs)
</p>
</li>
<li><p> marginal probability of missing values <code class="reqn">\gamma_0</code>: &quot;p.prior.e&quot;(effects) and/or &quot;p.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters in the missingness model <code class="reqn">\gamma_j</code> (if covariate data provided): &quot;gamma.prior.e&quot;(effects) and/or &quot;gamma.prior.c&quot;(costs)
</p>
</li>
<li><p> mnar parameter <code class="reqn">\delta</code>: &quot;delta.prior.e&quot;(effects) and/or &quot;delta.prior.c&quot;(costs)
</p>
</li></ul>
 
<p>For simplicity, here we have assumed that the set of covariates <code class="reqn">X_j</code> used in the models for the effects/costs and in the 
model of the missing effect/cost values is the same. However, it is possible to specify different sets of covariates for each model
using the arguments in the function <code>selection</code> (see Arguments).
</p>
<p>For each model, random effects can also be specified for each parameter by adding the term + (x | z) to each model formula, 
where x is the fixed regression coefficient for which also the random effects are desired and z is the clustering variable across which 
the random effects are specified (must be the name of a factor variable in the dataset). Multiple random effects can be specified using the 
notation + (x1 + x2 | site) for each covariate that was included in the fixed effects formula. Random intercepts are included by default in the models
if a random effects are specified but they can be removed by adding the term 0 within the random effects formula, e.g. + (0 + x | z).
</p>


<h3>Value</h3>

<p>An object of the class 'missingHE' containing the following elements
</p>

<dl>
<dt>data_set</dt><dd><p>A list containing the original data set provided in <code>data</code> (see Arguments), the number of observed and missing individuals 
, the total number of individuals by treatment arm and the indicator vectors for the missing values</p>
</dd>
<dt>model_output</dt><dd><p>A list containing the output of a <code>JAGS</code> model generated from the functions <code><a href="R2jags.html#topic+jags">jags</a></code>, and 
the posterior samples for the main parameters of the model and the imputed values</p>
</dd>
<dt>cea</dt><dd><p>A list containing the output of the economic evaluation performed using the function <code><a href="BCEA.html#topic+bcea">bcea</a></code></p>
</dd>
<dt>type</dt><dd><p>A character variable that indicate which type of missingness mechanism has been used to run the model, 
either <code>MAR</code> or <code>MNAR</code> (see details)</p>
</dd>
<dt>data_format</dt><dd><p>A character variable that indicate which type of analysis was conducted, either using a <code>wide</code> or <code>longitudinal</code> dataset</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Daniels, MJ. Hogan, JW. <em>Missing Data in Longitudinal Studies: strategies for Bayesian modelling and sensitivity analysis</em>, CRC/Chapman Hall.
</p>
<p>Baio, G.(2012). <em>Bayesian Methods in Health Economics</em>. CRC/Chapman Hall, London.
</p>
<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">jags</a></code>, <code><a href="BCEA.html#topic+bcea">bcea</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Quck example to run using subset of MenSS dataset
MenSS.subset &lt;- MenSS[50:100, ]

# Run the model using the selection function assuming a MAR mechanism
# Use only 100 iterations to run a quick check
model.selection &lt;- selection(data = MenSS.subset, model.eff = e ~ 1,model.cost = c ~ 1,
   model.me = me ~ 1, model.mc = mc ~ 1, dist_e = "norm", dist_c = "norm",
   type = "MAR", n.chains = 2, n.iter = 100, ppc = TRUE)

# Print the results of the JAGS model
print(model.selection)
#

# Use dic information criterion to assess model fit
pic.dic &lt;- pic(model.selection, criterion = "dic", module = "total")
pic.dic
#

# Extract regression coefficient estimates
coef(model.selection)
#



# Assess model convergence using graphical tools
# Produce histograms of the posterior samples for the mean effects
diag.hist &lt;- diagnostic(model.selection, type = "histogram", param = "mu.e")
#

# Compare observed effect data with imputations from the model
# using plots (posteiror means and credible intervals)
p1 &lt;- plot(model.selection, class = "scatter", outcome = "effects")
#

# Summarise the CEA information from the model
summary(model.selection)


# Further examples which take longer to run
model.selection &lt;- selection(data = MenSS, model.eff = e ~ u.0,model.cost = c ~ e,
   model.se = me ~ u.0, model.mc = mc ~ 1, dist_e = "norm", dist_c = "norm",
   type = "MAR", n.chains = 2, n.iter = 500, ppc = FALSE)
#
# Print results for all imputed values
print(model.selection, value.mis = TRUE)

# Use looic to assess model fit
pic.looic&lt;-pic(model.selection, criterion = "looic", module = "total")
pic.looic

# Show density plots for all parameters
diag.hist &lt;- diagnostic(model.selection, type = "denplot", param = "all")

# Plots of imputations for all data
p1 &lt;- plot(model.selection, class = "scatter", outcome = "all")

# Summarise the CEA results
summary(model.selection)


#
#
</code></pre>

<hr>
<h2 id='selection_long'>Full Bayesian Models to handle missingness in Economic Evaluations (Selection Models)</h2><span id='topic+selection_long'></span>

<h3>Description</h3>

<p>Full Bayesian cost-effectiveness models to handle missing data in longitudinal outcomes under different missing data 
mechanism assumptions, using alternative parametric distributions for the effect and cost variables and 
using a selection model approach to identify the model. The analysis is performed using the <code>BUGS</code> language, 
which is implemented in the software <code>JAGS</code> using the function <code><a href="R2jags.html#topic+jags">jags</a></code> The output is stored in an object of class 'missingHE'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection_long(
  data,
  model.eff,
  model.cost,
  model.mu = mu ~ 1,
  model.mc = mc ~ 1,
  dist_u,
  dist_c,
  type,
  prob = c(0.025, 0.975),
  time_dep = "AR1",
  n.chains = 2,
  n.iter = 20000,
  n.burnin = floor(n.iter/2),
  inits = NULL,
  n.thin = 1,
  ppc = FALSE,
  save_model = FALSE,
  prior = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selection_long_+3A_data">data</code></td>
<td>
<p>A data frame in which to find the longitudinal variables supplied in <code>model.eff</code>, <code>model.cost</code> (model formulas for effects and costs) 
and <code>model.mu</code>, <code>model.mc</code> (model formulas for the missing effect and cost models). Among these,
effectiveness, cost, time and treatment indicator (only two arms) variables must always be provided and named 'u', 'c' , 'time' and 't', respectively.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_model.eff">model.eff</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
effectiveness outcome ('u') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_model.cost">model.cost</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be a health economic
cost outcome ('c') whose name must correspond to that used in <code>data</code>. Any covariates in the model must be provided on the right-hand side of the formula.
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;location&quot; parameter of the distribution through a linear model. 
A joint bivariate distribution for effects and costs can be specified by including 'e' on the right-hand side of the formula for the costs model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_model.mu">model.mu</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the 
term 'mu' (missing effects) and any covariates must be provided on the right-hand side of the formula. If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. 
By default, covariates are placed on the &quot;probability&quot; parameter for the missing effects through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_model.mc">model.mc</code></td>
<td>
<p>A formula expression in conventional <code>R</code> linear modelling syntax. The response must be indicated with the term 'mc' (missing costs) and any covariates must be provided on the right-hand side of the formula. 
If there are no covariates, <code>1</code> should be specified on the right hand side of the formula. By default, covariates are placed on the &quot;probability&quot; parameter for the missing costs through a logistic-linear model.
Random effects can also be specified for each model parameter. See details for how these can be specified.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_dist_u">dist_u</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern').</p>
</td></tr>
<tr><td><code id="selection_long_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm').</p>
</td></tr>
<tr><td><code id="selection_long_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR) and Missing Not At Random (MNAR).</p>
</td></tr>
<tr><td><code id="selection_long_+3A_prob">prob</code></td>
<td>
<p>A numeric vector of probabilities within the range (0,1), representing the upper and lower
CI sample quantiles to be calculated and returned for the imputed values.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_time_dep">time_dep</code></td>
<td>
<p>Type of dependence structure assumed between effectiveness and cost outcomes. Current choices include: autoregressive structure of order one ('AR1') - default - and independence ('none').</p>
</td></tr>
<tr><td><code id="selection_long_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_n.burnin">n.burnin</code></td>
<td>
<p>Number of warmup iterations.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_inits">inits</code></td>
<td>
<p>A list with elements equal to the number of chains selected; each element of the list is itself a list of starting values for the
<code>JAGS</code> model, or a function creating (possibly random) initial values. If <code>inits</code> is <code>NULL</code>, <code>JAGS</code>
will generate initial values for all the model parameters.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinning interval.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_ppc">ppc</code></td>
<td>
<p>Logical. If <code>ppc</code> is <code>TRUE</code>, the estimates of the parameters that can be used to generate replications from the model are saved.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_save_model">save_model</code></td>
<td>
<p>Logical. If <code>save_model</code> is <code>TRUE</code>, a <code>txt</code> file containing the model code is printed
in the current working directory.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_prior">prior</code></td>
<td>
<p>A list containing the hyperprior values provided by the user. Each element of this list must be a vector of length two
containing the user-provided hyperprior values and must be named with the name of the corresponding parameter. For example, the hyperprior
values for the standard deviation effect parameters can be provided using the list <code>prior = list('sigma.prior.u' = c(0, 100))</code>.
For more information about how to provide prior hypervalues for different types of parameters and models see details. 
If <code>prior</code> is set to 'default', the default values will be used.</p>
</td></tr>
<tr><td><code id="selection_long_+3A_...">...</code></td>
<td>
<p>Additional arguments that can be provided by the user. Examples are <code>center = TRUE</code> to center all the covariates in the model 
or the additional arguments that can be provided to the function <code><a href="BCEA.html#topic+bcea">bcea</a></code> to summarise the health economic evaluation results. 
Users may also provide, using the argument <code>qaly_calc</code> and <code>tcost_calc</code>, the weights to be used for computing the posterior mean QALYs (Area Under the Curve approach)
and Total cost (sum over follow-up costs) quantities which are then used to generate any cost-effectiveness decision output (e.g. Cost-Effectiveness Plane). If these are not provided, 
default values of '0.5' and '1' are used, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the distributions specified for the outcome variables in the arguments <code>dist_u</code> and
<code>dist_c</code> and the type of missingness mechanism specified in the argument <code>type</code>, different selection models
are built and run in the background by the function <code>selection</code>. These models consist in multinomial logistic regressions that are used to estimate
the probability of a missingness dropout pattern <code>k</code> (completers, intermittent, dropout) in one or both the longitudinal outcomes. A simple example can be used 
to show how these selection models are specified. Consider a longitudinal data set comprising a response variable <code class="reqn">y</code> measures at S occasions and a set of centered covariate <code class="reqn">X_j</code>. 
For each subject in the trial <code class="reqn">i = 1, ..., n</code> and time <code class="reqn">s = 1, ..., S</code> we define an indicator variable <code class="reqn">m_i</code> taking value <code>k = 1</code> if the <code class="reqn">i</code>-th individual is associated with 
no missing value (completer), a value <code>k = 2</code> for intermittent missingness over the study period, and a value <code>k = 3</code> for dropout missingness.
This is modelled as:
</p>
<p style="text-align: center;"><code class="reqn">m_i ~ Multinomial(\pi^k_i)</code>
</p>

<p style="text-align: center;"><code class="reqn">\pi^k_i = \phi^k_i/\sum\phi_i</code>
</p>

<p style="text-align: center;"><code class="reqn">log(\phi^k_i) = \gamma^k_0 + \sum\gamma^k_j X_j + \delta^k (y)</code>
</p>

<p>where
</p>

<ul>
<li> <p><code class="reqn">\pi_i</code> is the individual probability of a missing value in <code class="reqn">y</code> for pattern <code class="reqn">k</code> at a given time point.
</p>
</li>
<li> <p><code class="reqn">\gamma^k_0</code> represents the marginal probability of a missingness dropout pattern in <code class="reqn">y</code> for pattern <code class="reqn">k</code> on the log scale at a given time point.
</p>
</li>
<li> <p><code class="reqn">\gamma^k_j</code> represents the impact on the probability of a specific missingness dropout pattern in <code class="reqn">y</code> of the centered covariates <code class="reqn">X_j</code> for pattern <code class="reqn">k</code> at a given time point.
</p>
</li>
<li> <p><code class="reqn">\delta^k</code> represents the impact on the probability of a specific missingness dropout pattern <code class="reqn">k</code> in <code class="reqn">y</code> of the missing pattern itself at a given time point.
</p>
</li></ul>

<p>When <code class="reqn">\delta = 0</code> the model assumes a 'MAR' mechanism, while when <code class="reqn">\delta != 0</code> the mechanism is 'MNAR'. For the parameters indexing the missingness model, 
the default prior distributions assumed are the following:
</p>

<ul>
<li> <p><code class="reqn">\gamma^k_0 ~ Logisitc(0, 1)</code>
</p>
</li>
<li> <p><code class="reqn">\gamma^k_j ~ Normal(0, 0.01)</code>
</p>
</li>
<li> <p><code class="reqn">\delta^k ~ Normal(0, 1)</code>
</p>
</li></ul>

<p>When user-defined hyperprior values are supplied via the argument <code>prior</code> in the function <code>selection_long</code>, the elements of this list (see Arguments)
must be vectors of length two containing the user-provided hyperprior values and must take specific names according to the parameters they are associated with. 
Specifically, the names for the parameters indexing the model which are accepted by <strong>missingHE</strong> are the following:
</p>

<ul>
<li><p> location parameters <code class="reqn">\alpha_0</code> and <code class="reqn">\beta_0</code>: &quot;mean.prior.u&quot;(effects) and/or &quot;mean.prior.c&quot;(costs)
</p>
</li>
<li><p> auxiliary parameters <code class="reqn">\sigma</code>: &quot;sigma.prior.u&quot;(effects) and/or &quot;sigma.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters <code class="reqn">\alpha_j</code> and <code class="reqn">\beta_j</code>: &quot;alpha.prior&quot;(effects) and/or &quot;beta.prior&quot;(costs)
</p>
</li>
<li><p> marginal probability of missing values for pattern <code class="reqn">k</code> <code class="reqn">\gamma^k_0</code>: &quot;p.prior.u&quot;(effects) and/or &quot;p.prior.c&quot;(costs)
</p>
</li>
<li><p> covariate parameters in the missingness model for pattern <code class="reqn">k</code> <code class="reqn">\gamma^k_j</code> (if covariate data provided): &quot;gamma.prior.u&quot;(effects) and/or &quot;gamma.prior.c&quot;(costs)
</p>
</li>
<li><p> mnar parameter for pattern <code class="reqn">k</code> <code class="reqn">\delta^k</code>: &quot;delta.prior.u&quot;(effects) and/or &quot;delta.prior.c&quot;(costs)
</p>
</li></ul>
 
<p>For simplicity, here we have assumed that the set of covariates <code class="reqn">X_j</code> used in the models for the effects/costs and in the 
model of the missing effect/cost values is the same. However, it is possible to specify different sets of covariates for each model
using the arguments in the function <code>selection_long</code> (see Arguments).
</p>
<p>For each model, random effects can also be specified for each parameter by adding the term + (x | z) to each model formula, 
where x is the fixed regression coefficient for which also the random effects are desired and z is the clustering variable across which 
the random effects are specified (must be the name of a factor variable in the dataset). Multiple random effects can be specified using the 
notation + (x1 + x2 | site) for each covariate that was included in the fixed effects formula. Random intercepts are included by default in the models
if a random effects are specified but they can be removed by adding the term 0 within the random effects formula, e.g. + (0 + x | z).
</p>


<h3>Value</h3>

<p>An object of the class 'missingHE' containing the following elements
</p>

<dl>
<dt>data_set</dt><dd><p>A list containing the original longitudinal data set provided in <code>data</code> (see Arguments), the number of observed and missing individuals 
, the total number of individuals by treatment arm and the indicator vectors for the missing values for each time point</p>
</dd>
<dt>model_output</dt><dd><p>A list containing the output of a <code>JAGS</code> model generated from the functions <code><a href="R2jags.html#topic+jags">jags</a></code>, and 
the posterior samples for the main parameters of the model and the imputed values</p>
</dd>
<dt>cea</dt><dd><p>A list containing the output of the economic evaluation performed using the function <code><a href="BCEA.html#topic+bcea">bcea</a></code></p>
</dd>
<dt>type</dt><dd><p>A character variable that indicate which type of missingness mechanism has been used to run the model, 
either <code>MAR</code> or <code>MNAR</code> (see details)</p>
</dd>
<dt>data_format</dt><dd><p>A character variable that indicate which type of analysis was conducted, either using a <code>wide</code> or <code>longitudinal</code> dataset</p>
</dd>
<dt>time_dep</dt><dd><p>A character variable that indicate which type of time dependence assumption was made, either <code>none</code> or <code>AR1</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Mason, AJ. Gomes, M. Carpenter, J. Grieve, R. (2021). <em>Flexible Bayesian longitudinal models for costeffectiveness analyses with informative missing data</em>. Health economics, 30(12), 3138-3158.
</p>
<p>Daniels, MJ. Hogan, JW. <em>Missing Data in Longitudinal Studies: strategies for Bayesian modelling and sensitivity analysis</em>, CRC/Chapman Hall.
</p>
<p>Baio, G.(2012). <em>Bayesian Methods in Health Economics</em>. CRC/Chapman Hall, London.
</p>
<p>Gelman, A. Carlin, JB., Stern, HS. Rubin, DB.(2003). <em>Bayesian Data Analysis, 2nd edition</em>, CRC Press.
</p>
<p>Plummer, M. <em>JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.</em> (2003).
</p>


<h3>See Also</h3>

<p><code><a href="R2jags.html#topic+jags">jags</a></code>, <code><a href="BCEA.html#topic+bcea">bcea</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Quck example to run using subset of PBS dataset

# Load longitudinal dataset

PBS.long &lt;- PBS


# Run the model using the selection function assuming a MAR mechanism
# Use only 100 iterations to run a quick check
model.selection.long &lt;- selection_long(data = PBS.long, model.eff = u ~ 1,model.cost = c ~ 1,
   model.mu = mu ~ 1, model.mc = mc ~ 1, dist_u = "norm", dist_c = "norm",
   type = "MAR", n.chains = 2, n.iter = 100, ppc = TRUE, time_dep = "none")

# Print the results of the JAGS model
print(model.selection.long)
#

# Extract regression coefficient estimates
coef(model.selection.long)
#

# Summarise the CEA information from the model
summary(model.selection.long)

# Further examples which take longer to run
model.selection.long &lt;- selection_long(data = PBS.long, model.eff = u ~ 1,model.cost = c ~ u,
   model.se = mu ~ 1, model.mc = mc ~ 1, dist_u = "norm", dist_c = "norm",
   type = "MAR", n.chains = 2, n.iter = 500, ppc = FALSE, time_dep = "none")
#
# Print results for all imputed values
print(model.selection.long, value.mis = TRUE)

# Use looic to assess model fit
pic.looic &lt;- pic(model.selection.long, criterion = "looic", module = "total")
pic.looic

# Show density plots for all parameters
diag.hist &lt;- diagnostic(model.selection.long, type = "denplot", param = "all")

# Plots of imputations for all data
p1 &lt;- plot(model.selection.long, class = "scatter", outcome = "all")

# Summarise the CEA results
summary(model.selection.long)


#
#
</code></pre>

<hr>
<h2 id='summary.missingHE'>Summary method for objects in the class <code>missingHE</code></h2><span id='topic+summary.missingHE'></span>

<h3>Description</h3>

<p>Produces a table printout with some summary results of the health economic evaluation probabilistic model
run using the function <code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code>, <code><a href="#topic+pattern">pattern</a></code> or <code><a href="#topic+hurdle">hurdle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'missingHE'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.missingHE_+3A_object">object</code></td>
<td>
<p>A <code>missingHE</code> object containing the results of the Bayesian modelling and the economic evaluation</p>
</td></tr>
<tr><td><code id="summary.missingHE_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a table with some information on the health economic model based on the assumption
selected for the missingness using the function <code>selection</code>, <code>selection_long</code>, <code>pattern</code> or <code>hurdle</code>. 
Summary information on the main parameters of interests is provided.
</p>


<h3>Author(s)</h3>

<p>Andrea Gabrio
</p>


<h3>References</h3>

<p>Baio, G.(2012). <em>Bayesian Methods in Health Economcis</em>. CRC/Chapman Hall, London.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selection">selection</a></code>, <code><a href="#topic+selection_long">selection_long</a></code> <code><a href="#topic+pattern">pattern</a></code> <code><a href="#topic+hurdle">hurdle</a></code> <code><a href="#topic+diagnostic">diagnostic</a></code> <code><a href="#topic+plot.missingHE">plot.missingHE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For examples see the function \code{\link{selection}}, \code{\link{selection_long}},
# \code{\link{pattern}} or \code{\link{hurdle}}
#
#
</code></pre>

<hr>
<h2 id='write_hurdle'>An internal function to select which type of hurdle model to execute for both effectiveness and costs. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of structural value mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</h2><span id='topic+write_hurdle'></span>

<h3>Description</h3>

<p>An internal function to select which type of hurdle model to execute for both effectiveness and costs. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of structural value mechanism assumed and independence or joint modelling
This function selects which type of model to execute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_hurdle(
  dist_e,
  dist_c,
  type,
  pe_fixed,
  pc_fixed,
  ze_fixed,
  zc_fixed,
  ind_fixed,
  pe_random,
  pc_random,
  ze_random,
  zc_random,
  ind_random,
  model_e_random,
  model_c_random,
  model_se_random,
  model_sc_random,
  se,
  sc
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_hurdle_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_type">type</code></td>
<td>
<p>Type of structural value mechanism assumed. Choices are Structural Completely At Random (SCAR) and Structural At Random (SAR)</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_ze_fixed">ze_fixed</code></td>
<td>
<p>Number of fixed effects or the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_ind_fixed">ind_fixed</code></td>
<td>
<p>Logical; if TRUE independence at the level of the fixed effects between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_ze_random">ze_random</code></td>
<td>
<p>Number of random effects or the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_ind_random">ind_random</code></td>
<td>
<p>Logical; if TRUE independence at the level of the random effects between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_model_se_random">model_se_random</code></td>
<td>
<p>Random effects formula for the structural indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_model_sc_random">model_sc_random</code></td>
<td>
<p>Random effects formula for the structural indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_se">se</code></td>
<td>
<p>Structural value for the effectiveness</p>
</td></tr>
<tr><td><code id="write_hurdle_+3A_sc">sc</code></td>
<td>
<p>Structural value for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='write_pattern'>An internal function to select which type of pattern mixture model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</h2><span id='topic+write_pattern'></span>

<h3>Description</h3>

<p>An internal function to select which type of pattern mixture model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_pattern(
  type,
  dist_e,
  dist_c,
  pe_fixed,
  pc_fixed,
  ind_fixed,
  pe_random,
  pc_random,
  ind_random,
  model_e_random,
  model_c_random,
  d_list,
  d1,
  d2,
  restriction
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_pattern_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR)</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available choices are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available choices are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_ind_fixed">ind_fixed</code></td>
<td>
<p>Logical; if TRUE independence between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_ind_random">ind_random</code></td>
<td>
<p>Logical; if TRUE independence at the level of the random effects between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_d_list">d_list</code></td>
<td>
<p>Number and type of patterns</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_d1">d1</code></td>
<td>
<p>Pattern indicator in the control</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_d2">d2</code></td>
<td>
<p>Pattern indicator in the intervention</p>
</td></tr>
<tr><td><code id="write_pattern_+3A_restriction">restriction</code></td>
<td>
<p>type of identifying restriction to be imposed</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Internal function only
# No examples
#
#
</code></pre>

<hr>
<h2 id='write_selection'>An internal function to select which type of selection model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</h2><span id='topic+write_selection'></span>

<h3>Description</h3>

<p>An internal function to select which type of selection model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_selection(
  dist_e,
  dist_c,
  type,
  pe_fixed,
  pc_fixed,
  ze_fixed,
  zc_fixed,
  ind_fixed,
  pe_random,
  pc_random,
  ze_random,
  zc_random,
  ind_random,
  model_e_random,
  model_c_random,
  model_me_random,
  model_mc_random
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_selection_+3A_dist_e">dist_e</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="write_selection_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="write_selection_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR)</p>
</td></tr>
<tr><td><code id="write_selection_+3A_pe_fixed">pe_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_ze_fixed">ze_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_selection_+3A_ind_fixed">ind_fixed</code></td>
<td>
<p>Logical; if TRUE independence between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_selection_+3A_pe_random">pe_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_ze_random">ze_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_selection_+3A_ind_random">ind_random</code></td>
<td>
<p>Logical; if TRUE independence at the level of the random effects between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_selection_+3A_model_e_random">model_e_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="write_selection_+3A_model_me_random">model_me_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_+3A_model_mc_random">model_mc_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

<hr>
<h2 id='write_selection_long'>An internal function to select which type of selection model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.</h2><span id='topic+write_selection_long'></span>

<h3>Description</h3>

<p>An internal function to select which type of selection model to execute. 
Alternatives vary depending on the type of distribution assumed for the effect and cost variables,
type of missingness mechanism assumed and independence or joint modelling
This function selects which type of model to execute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_selection_long(
  dist_u,
  dist_c,
  type,
  pu_fixed,
  pc_fixed,
  zu_fixed,
  zc_fixed,
  ind_fixed,
  ind_time_fixed,
  pu_random,
  pc_random,
  zu_random,
  zc_random,
  ind_random,
  model_u_random,
  model_c_random,
  model_mu_random,
  model_mc_random
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_selection_long_+3A_dist_u">dist_u</code></td>
<td>
<p>Distribution assumed for the effects. Current available chocies are: Normal ('norm'), Beta ('beta'), Gamma ('gamma'), Exponential ('exp'),
Weibull ('weibull'), Logistic ('logis'), Poisson ('pois'), Negative Binomial ('nbinom') or Bernoulli ('bern')</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_dist_c">dist_c</code></td>
<td>
<p>Distribution assumed for the costs. Current available chocies are: Normal ('norm'), Gamma ('gamma') or LogNormal ('lnorm')</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_type">type</code></td>
<td>
<p>Type of missingness mechanism assumed. Choices are Missing At Random (MAR), Missing Not At Random for the effects (MNAR_eff),
Missing Not At Random for the costs (MNAR_cost), and Missing Not At Random for both (MNAR)</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_pu_fixed">pu_fixed</code></td>
<td>
<p>Number of fixed effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_pc_fixed">pc_fixed</code></td>
<td>
<p>Number of fixed effects for the cost model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_zu_fixed">zu_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_zc_fixed">zc_fixed</code></td>
<td>
<p>Number of fixed effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_ind_fixed">ind_fixed</code></td>
<td>
<p>Logical; if TRUE independence between effectiveness and costs at the same time is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_ind_time_fixed">ind_time_fixed</code></td>
<td>
<p>Logical; if TRUE independence between effectiveness and costs over time is assumed, else an AR1 correlation structure is accounted for</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_pu_random">pu_random</code></td>
<td>
<p>Number of random effects for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_pc_random">pc_random</code></td>
<td>
<p>Number of random effects for the cost model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_zu_random">zu_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_zc_random">zc_random</code></td>
<td>
<p>Number of random effects or the missingness indicators model for the costs</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_ind_random">ind_random</code></td>
<td>
<p>Logical; if TRUE independence at the level of the random effects between effectiveness and costs is assumed, else correlation is accounted for</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_model_u_random">model_u_random</code></td>
<td>
<p>Random effects formula for the effectiveness model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_model_c_random">model_c_random</code></td>
<td>
<p>Random effects formula for the costs model</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_model_mu_random">model_mu_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the effectiveness</p>
</td></tr>
<tr><td><code id="write_selection_long_+3A_model_mc_random">model_mc_random</code></td>
<td>
<p>Random effects formula for the missingness indicators model for the costs</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#Internal function only
#No examples
#
#
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
