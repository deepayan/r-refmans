<!DOCTYPE html><html><head><title>Help for package sleepwalk</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sleepwalk}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.slw'><p>Variable to store the information about the current <code>sleepwalk</code> session.</p></a></li>
<li><a href='#sleepwalk'><p>Interactively explore one or several 2D embeddings</p></a></li>
<li><a href='#slw_snapshot'><p>Make a snapshot of the currently running Sleepwalk app</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interactively Explore Dimension-Reduced Embeddings</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-16</td>
</tr>
<tr>
<td>Description:</td>
<td>A tool to interactively explore the
  embeddings created by dimension reduction methods such as 
  Principal Components Analysis (PCA), Multidimensional Scaling (MDS), 
  T-distributed Stochastic Neighbour Embedding (t-SNE),
  Uniform Manifold Approximation and Projection (UMAP) or any other.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>jrc (&ge; 0.5.0), cowplot, httpuv, jsonlite, scales, ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://anders-biostat.github.io/sleepwalk/">https://anders-biostat.github.io/sleepwalk/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/anders-biostat/sleepwalk/issues">https://github.com/anders-biostat/sleepwalk/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-16 14:20:12 UTC; tyranchick</td>
</tr>
<tr>
<td>Author:</td>
<td>Svetlana Ovchinnikova [aut, cre],
  Simon Anders [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Svetlana Ovchinnikova &lt;s.ovchinnikova@zmbh.uni-heidelberg.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-16 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.slw'>Variable to store the information about the current <code>sleepwalk</code> session.</h2><span id='topic+.slw'></span>

<h3>Description</h3>

<p>Variable to store the information about the current <code>sleepwalk</code> session.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.slw
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 0.
</p>

<hr>
<h2 id='sleepwalk'>Interactively explore one or several 2D embeddings</h2><span id='topic+sleepwalk'></span>

<h3>Description</h3>

<p>A function to interactively explore a 2D embedding of some higher-dimensional
point cloud, as produced by a dimension reduction method such as MDS, t-SNE, or the like.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleepwalk(
  embeddings,
  featureMatrices = NULL,
  maxdists = NULL,
  pointSize = 1.5,
  titles = NULL,
  distances = NULL,
  same = c("objects", "features"),
  compare = c("embeddings", "distances"),
  saveToFile = NULL,
  ncol = NULL,
  nrow = NULL,
  on_selection = NULL,
  mode = c("canvas", "svg"),
  metric = "euclid",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sleepwalk_+3A_embeddings">embeddings</code></td>
<td>
<p>either an <code class="reqn">n x 2</code> embedding matrix (where <code class="reqn">n</code> is a number of points) or
a list of <code class="reqn">n_i x 2</code> matrices - one for each embedding. If <code>same = "objects"</code> all embedding
matrices must have the same number of rows.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_featurematrices">featureMatrices</code></td>
<td>
<p>either an <code class="reqn">n x m</code> matrix of point coordinates in the feature-dimension
space or a list of such matrices - one for each embedding. The displayed distances will be calculated 
as Euclidean distances of the rows of these matrices. Alternatively, if <code>same = "objects"</code>
it is possible to provide the distances directly via the <code>distances</code> argument. 
If <code>same = "features"</code> then all the points must be from the same feature space and therefore
have the same number of columns. It is possible to use one feature matrix for all the embeddings.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_maxdists">maxdists</code></td>
<td>
<p>a vector of the maximum distances (in feature space) for each provided feature or
distance matrix that should still be covered by the colour 
scale; higher distances are shown in light gray. This values can be changed later interactively.
If not provided, maximum distances will be estimated automatically as median value of the 
distances.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_pointsize">pointSize</code></td>
<td>
<p>size of the points on the plots.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_titles">titles</code></td>
<td>
<p>a vector of titles for each embedding. Must be the same length as the list of 
<code>embeddings</code>.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_distances">distances</code></td>
<td>
<p>distances (in feature space) between points that should be displayed as colours.
This is an alternative to <code>featureMatrices</code> if <code>same = "objects"</code>.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_same">same</code></td>
<td>
<p>defines what kind of distances to show; must be either <code>"objects"</code> or <code>"features"</code>.
Use <code>same = "objects"</code> when all the embeddings show the same set of points. In this case,
each embedding is colored to show the distance of the selected point to all other points.
The same or different features can be supplied as <code>featureMatrices</code>, to use the same or different distances
in the different embeddings.
<code>same = "features"</code>
is used to compare different sets of points (e.g. samples from different patients, or different batches) 
in the same feature space. In this case the distance is calculated from the selected point to all other 
points (including those in other embeddings).</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_compare">compare</code></td>
<td>
<p>defines what kind of comparison to perform; must be either <code>"embeddings"</code> or
<code>"distances"</code>. If <code>compare == "embeddings"</code>, then in each of the displayed embeddings
all the points will be coloured the same way, even if different feature or distance matrices are provided. 
This allows one to immediately identify the corresponding points and neighbourhoods in each of the embeddings.
If <code>commpare == "distances"</code>, point colours for each embedding are calculated independently. This allows, 
for instance, to compare different metrics or show an additional layer of information, when exploring an
embedding. This parameter has no effect if <code>same == "features"</code>.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_savetofile">saveToFile</code></td>
<td>
<p>path to the .html file where to save the plots. The resulting page will be fully interactive
and contain all the data. If this is <code>NULL</code>, than the plots will be shown as the web page in your 
default browser. Note, that if you try to save that page, using your browser's functionality,
it'll become static.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_ncol">ncol</code></td>
<td>
<p>number of columns in the table, where all the embeddings are placed.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_nrow">nrow</code></td>
<td>
<p>number of rows in the table, where all the embeddings are placed.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_on_selection">on_selection</code></td>
<td>
<p>a callback function that is called every time the user selects a group of points in
the web browser. From the <code>sleepwalk</code> app it gets two arguments: The first one is a vector of indices of
all the selected points and the second one is an index of an embedding from where the points were selected.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_mode">mode</code></td>
<td>
<p>defines whether to use Canvas or SVG to display points. Using Canvas is faster and allows to plot 
more points simultaneously, yet we currently consider SVG mode to be more stable and vigorously tested. In future
versions SVG mode will be deprecated. Must be one of <code>canvas</code> or <code>svg</code>.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_metric">metric</code></td>
<td>
<p>specifies what metric to use to calculate distances from feature matrices. Currently only Euclidean 
(<code>"euclid"</code>, default) and cosine (<code>"cosine"</code>) are supported. This can be a single string (then the selected
metric is used for all the charts) or a vector of strings - one per each chart.</p>
</td></tr>
<tr><td><code id="sleepwalk_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="jrc.html#topic+openPage">openPage</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function opens a browser window and displays the embeddings as point clouds. When the user
moves the mouse over a point, the point gets selected and all data points change colour such
that their colour indicates
the feature-space distance to the point under the mouse cursor. This allows to quickly and
intuitively check how tight clusters are, how faithful the embedding is, and how similar
the clusters are to each other.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Simon Anders, Svetlana Ovchinnikova
</p>


<h3>References</h3>

<p>doi: <a href="https://doi.org/10.1101/603589">10.1101/603589</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate cockscrew-shaped 3D data with 3 additional noisy dimensions
ts &lt;- c(rnorm(100), rnorm(200, 5), rnorm(150, 13), runif(200, min = -5, max = 20))

a &lt;- 3
w &lt;- 1

points &lt;- cbind(30*cos(w * ts), 30*sin(w * ts), a * ts)

ndim &lt;- 6
noise &lt;- cbind(matrix(rnorm(length(ts) * 3, sd = 5), ncol = 3),
               matrix(rnorm(length(ts) * (ndim - 3), sd = 10), ncol = ndim - 3))

data &lt;- noise
data[, 1:3] &lt;- data[, 1:3] + points

pca &lt;- prcomp(data)

#compare Euclidean distance with the real position on the helix
sleepwalk(list(pca$x[, 1:2], pca$x[, 1:2]), list(data, as.matrix(ts)), 
          compare = "distances", pointSize = 3)
#the same, but with saving the web page to an HTML file
sleepwalk(list(pca$x[, 1:2], pca$x[, 1:2]), list(data, as.matrix(ts)), 
          compare = "distances", pointSize = 3,
          saveToFile = paste0(tempdir(), "/test.html"))

  
</code></pre>

<hr>
<h2 id='slw_snapshot'>Make a snapshot of the currently running Sleepwalk app</h2><span id='topic+slw_snapshot'></span>

<h3>Description</h3>

<p>This function produces a static plot that shows a given state of the 
currently active Sleepwalk app. Double click on a point in the web browser
will generate a command that can reproduce this exact state of the app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slw_snapshot(point, emb = 1, returnList = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slw_snapshot_+3A_point">point</code></td>
<td>
<p>an index of the focus point (i.e. the one, over which the mouse is hovering at the moment).
To learn the index of a point double click on it in the web browser.</p>
</td></tr>
<tr><td><code id="slw_snapshot_+3A_emb">emb</code></td>
<td>
<p>an index of the embedding of the focus point. To learn the index of an embedding double click 
on any of its points in the web browser.</p>
</td></tr>
<tr><td><code id="slw_snapshot_+3A_returnlist">returnList</code></td>
<td>
<p>if <code>TRUE</code> returns a list of <code>ggplot</code> objects (one per embedding), that can be easily 
modified later. Otherwise returns a single <code>ggplot</code> objects with all the embeddings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object or a list of <code>ggplot</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("iris")
sleepwalk(iris[, c(1,3)], iris[1:4], pointSize = 4)
slw_snapshot(10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
