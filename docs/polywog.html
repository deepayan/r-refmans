<!DOCTYPE html><html><head><title>Help for package polywog</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {polywog}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#polywog-package'><p>Bootstrapped basis regression with oracle model selection</p></a></li>
<li><a href='#bootPolywog'><p>Bootstrap a fitted polywog model</p></a></li>
<li><a href='#cv.polywog'><p>Cross-validation of polynomial degree and penalization factor</p></a></li>
<li><a href='#margEff.polywog'><p>Marginal effects for polywog models</p></a></li>
<li><a href='#model.frame.polywog'><p>Model frame of a polywog model</p></a></li>
<li><a href='#model.matrix.polywog'><p>Model matrix of a polywog model</p></a></li>
<li><a href='#plot.margEff.polywog'><p>Plot marginal effects</p></a></li>
<li><a href='#plot.polywog'><p>Univariate and bivariate fitted value plots</p></a></li>
<li><a href='#polywog'><p>Polynomial regression with oracle variable selection</p></a></li>
<li><a href='#predict.polywog'><p>Predict method for polywog objects</p></a></li>
<li><a href='#predVals'><p>Easy computation of fitted values</p></a></li>
<li><a href='#summary.margEff.polywog'><p>Summarize marginal effects</p></a></li>
<li><a href='#summary.polywog'><p>Summarize a fitted polywog model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bootstrapped Basis Regression with Oracle Model Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-04-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Brenton Kenkel and Curtis S. Signorino</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brenton Kenkel &lt;brenton.kenkel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for flexible functional form estimation via basis
    regression, with model selection via the adaptive LASSO or SCAD to prevent
    overfitting.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/brentonk/polywog-package">https://github.com/brentonk/polywog-package</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>miscTools (&ge; 0.6-12)</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, Formula, glmnet (&ge; 1.9-5), iterators, Matrix, ncvreg
(&ge; 2.4-0), Rcpp (&ge; 0.11.0), stringr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>carData, lattice, rgl</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-20 18:58:25 UTC; kenkelb</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-20 19:41:51 UTC</td>
</tr>
</table>
<hr>
<h2 id='polywog-package'>Bootstrapped basis regression with oracle model selection</h2><span id='topic+polywog-package'></span>

<h3>Description</h3>

<p>A package for flexible functional form estimation via bootstrapped basis
regression with oracle model selection.  This version of the software should
be considered <strong>in beta</strong>.  For bug reports and feature requests,
please email Brenton Kenkel (<a href="mailto:brenton.kenkel@gmail.com">brenton.kenkel@gmail.com</a>) or file an
issue at <a href="https://github.com/brentonk/polywog-package/issues">https://github.com/brentonk/polywog-package/issues</a>.
</p>


<h3>Acknowledgements</h3>

<p>We are grateful to Tyson Chatangier for many
helpful suggestions about an earlier version of the package.  We also thank
the Wallis Institute of Political Economy and the Theory and Statistics
Research Lab at the University of Rochester for financial support during the
writing of the package.
</p>


<h3>References</h3>

<p>Brenton Kenkel and Curtis S. Signorino.  2012.  &quot;A Method for Flexible
Functional Form Estimation: Bootstrapped Basis Regression with Variable
Selection.&quot;  Typescript, University of Rochester.
</p>

<hr>
<h2 id='bootPolywog'>Bootstrap a fitted polywog model</h2><span id='topic+bootPolywog'></span><span id='topic+control.bp'></span>

<h3>Description</h3>

<p>Nonparametric bootstrap of the <code><a href="#topic+polywog">polywog</a></code> regression procedure.
Can be run on a fitted model of class <code>"polywog"</code>, or within the
original procedure via the <code>boot</code> argument.  The function
<code>control.bp</code> can be used to pass options to <code>bootPolywog</code> when
bootstrapping within <code><a href="#topic+polywog">polywog</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootPolywog(model, nboot = 100, .parallel = FALSE, reuse.lambda = FALSE,
  reuse.penwt = FALSE, nlambda = 100, lambda.min.ratio = 1e-04,
  nfolds = 10, thresh = NULL, maxit = NULL, maxtries = 1000,
  min.prop = 0, report = FALSE, .matrixOnly = FALSE)

control.bp(.parallel = FALSE, reuse.lambda = FALSE, reuse.penwt = FALSE,
  nlambda = 100, lambda.min.ratio = 1e-04, nfolds = 10, thresh = NULL,
  maxit = NULL, maxtries = 1000, min.prop = 0, report = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootPolywog_+3A_model">model</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code> or the <code>"polywog.fit"</code> element of the output
of <code><a href="#topic+cv.polywog">cv.polywog</a></code>.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap iterations.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_.parallel">.parallel</code></td>
<td>
<p>logical: whether to perform computations in parallel
using a backend registered with <code><a href="foreach.html#topic+foreach">foreach</a></code>.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_reuse.lambda">reuse.lambda</code></td>
<td>
<p>logical: whether to use the penalization parameter from
the original fit (<code>TRUE</code>), or to cross-validate within each iteration
(<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_reuse.penwt">reuse.penwt</code></td>
<td>
<p>logical: whether to use the penalty weights from the
original fit (<code>TRUE</code>), or to re-calculate them within each iteration
(<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_nlambda">nlambda</code></td>
<td>
<p>number of values of the penalty factor to examine in
cross-validation, as in <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_lambda.min.ratio">lambda.min.ratio</code></td>
<td>
<p>ratio of the smallest value of the penalty factor
to the largest, as in <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_nfolds">nfolds</code></td>
<td>
<p>number of cross-validation folds to use.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_thresh">thresh</code></td>
<td>
<p>convergence threshold, as in <code><a href="#topic+polywog">polywog</a></code>.  If
<code>NULL</code>, use the same value as in the original model.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_maxit">maxit</code></td>
<td>
<p>iteration limit for fitting, as in <code><a href="#topic+polywog">polywog</a></code>.  If
<code>NULL</code>, use the same value as in the original model.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_maxtries">maxtries</code></td>
<td>
<p>maximum number of attempts to generate a bootstrap sample
with a non-collinear model matrix (often problematic with lopsided binary
regressors) before stopping and issuing an error message.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_min.prop">min.prop</code></td>
<td>
<p>for models with a binary response variable, minimum proportion of
non-modal outcome to ensure is included in each bootstrap iteration (for
example, set <code>min.prop = 0.1</code> to throw out any bootstrap iteration
where less than 10 percent or more than 90 percent of the observations are 1's).</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_report">report</code></td>
<td>
<p>logical: whether to print a status bar.  Not available if
<code>.parallel = TRUE</code>.</p>
</td></tr>
<tr><td><code id="bootPolywog_+3A_.matrixonly">.matrixOnly</code></td>
<td>
<p>logical: whether to return just the matrix of bootstrap
coefficients (<code>TRUE</code>), or the originally supplied model with the
bootstrap matrix as the <code>boot.matrix</code> element (<code>FALSE</code>, default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parallel computation via the <code>.parallel</code> argument requires
registation of a backend for <code><a href="foreach.html#topic+foreach">%dopar%</a></code>, as
in <code><a href="#topic+polywog">polywog</a></code>.  In the case of <code>bootPolywog</code>, bootstrap
fitting is carried out in parallel, while cross-validation to choose the
penalization factor (assuming <code>reuse.lambda = FALSE</code>) is carried
out sequentially within each iteration.
</p>


<h3>Value</h3>

<p>If <code>.matrixOnly = FALSE</code>, the returned object is <code>model</code>
with the bootstrap matrix included as its <code>boot.matrix</code> element.  If
<code>.matrixOnly = TRUE</code>, just the matrix is returned.  In either case, the
bootstrap matrix is a sparse matrix of class
<code>"<a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix</a>"</code>.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model without bootstrapping
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
fit1 &lt;- polywog(prestige ~ education + income + type,
                data = Prestige,
                degree = 2,
                thresh = 1e-4)
summary(fit1)

## Bootstrap the fitted model
fit2 &lt;- bootPolywog(fit1, nboot = 5)
summary(fit2)

## Example of parallel processing on Mac/Unix via 'doMC'
## Not run: 
library(doMC)
registerDoMC()

fit2 &lt;- bootPolywog(fit1, nboot = 100, .parallel = TRUE)

## End(Not run)

## Example of parallel processing on Windows via 'doSMP'
## Not run: 
library(doSMP)
w &lt;- startWorkers()
registerDoSMP(w)

fit2 &lt;- bootPolywog(fit1, nboot = 100, .parallel = TRUE)

stopWorkers(w)

## End(Not run)
</code></pre>

<hr>
<h2 id='cv.polywog'>Cross-validation of polynomial degree and penalization factor</h2><span id='topic+cv.polywog'></span>

<h3>Description</h3>

<p>k-fold cross-validation to select the polynomial degree and penalization
factor for a <code><a href="#topic+polywog">polywog</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.polywog(formula, ..., degrees.cv = 1:3, nfolds = 10, model = TRUE,
  X = FALSE, y = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.polywog_+3A_formula">formula</code></td>
<td>
<p>model formula specifying the response and input variables.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code><a href="#topic+polywog">polywog</a></code>.  Arguments
related to the bootstrap will be ignored, as bootstrapping must be
performed separately.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_degrees.cv">degrees.cv</code></td>
<td>
<p>vector of polynomial degrees to examine via
cross-validation.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds to use in cross-validation.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_model">model</code></td>
<td>
<p>logical: whether to include the model frame in the
<code>"polywog"</code> object included in the output.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_x">X</code></td>
<td>
<p>logical: whether to include the raw model matrix (i.e., the
matrix of input variables prior to taking their polynomial expansion) in
the <code>"polywog"</code> object included in the output.</p>
</td></tr>
<tr><td><code id="cv.polywog_+3A_y">y</code></td>
<td>
<p>logical: whether to include the response variable in the
<code>"polywog"</code> object included in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When fitting with <code>method = "scad"</code>, different fold assignments are
used for each polynomial degree specified, because <code><a href="ncvreg.html#topic+cv.ncvreg">cv.ncvreg</a></code>
does not allow for custom fold assignments.  This may affect the accuracy
of the estimated cross-validation error for each degree.  When
<code>method = "scad"</code>, the calls to <code><a href="#topic+polywog">polywog</a></code> made by
<code>cv.polywog</code> will issue warnings that the <code>foldid</code> argument is
being ignored.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv.polywog"</code>, a list containing:
</p>

<dl>
<dt><code>results</code></dt><dd><p>A table of each degree tested, the optimal
penalization factor <code class="reqn">\lambda</code> for that degree, and its
cross-validation error.</p>
</dd>
<dt><code>degree.min</code></dt><dd><p>The polynomial degree giving the lowest
cross-validation error.</p>
</dd>
<dt><code>polywog.fit</code></dt><dd><p>A <code><a href="#topic+polywog">polywog</a></code> model, fit at the
polynomial degree giving the lowest cross-validation error.</p>
</dd>
</dl>

<p>Because the returned object contains the fitted polywog model for the
optimal degree, no additional runs of <code><a href="#topic+polywog">polywog</a></code> are necessary
to estimate coefficients or the penalization factor <code class="reqn">\lambda</code>.
However, bootstrap results must be obtained by running
<code><a href="#topic+bootPolywog">bootPolywog</a></code> on the <code>"polywog.fit"</code> element of the
returned object, as in the examples below.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Examine degrees 1 through 4
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(39)
cv1 &lt;- cv.polywog(prestige ~ education + income + type,
                  data = Prestige,
                  degrees.cv = 1:4,
                  nfolds = 10,
                  thresh = 1e-4)
print(cv1)

## Extract best model and bootstrap
fit1 &lt;- cv1$polywog.fit
fit1 &lt;- bootPolywog(fit1, nboot = 5)
summary(fit1)
</code></pre>

<hr>
<h2 id='margEff.polywog'>Marginal effects for polywog models</h2><span id='topic+margEff.polywog'></span>

<h3>Description</h3>

<p>Computes average and observationwise marginal effects from a fitted
<code><a href="#topic+polywog">polywog</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
margEff(object, xvar = NULL, drop = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="margEff.polywog_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code>.  The object must have a <code>model</code> element,
meaning it was fit with <code>model = TRUE</code>.</p>
</td></tr>
<tr><td><code id="margEff.polywog_+3A_xvar">xvar</code></td>
<td>
<p>a character string containing the name of a raw input variable
(from <code>object$varNames</code>).  Partial matches are allowed.</p>
</td></tr>
<tr><td><code id="margEff.polywog_+3A_drop">drop</code></td>
<td>
<p>logical: whether to convert one-column matrices in the output to
vectors.</p>
</td></tr>
<tr><td><code id="margEff.polywog_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For input variables that are binary, logical, or factors,
<code>margEff.polywog</code> computes a first difference with comparison to a
reference category.  All other variables are treated as continuous:
the function computes the partial derivative of the fitted value with
respect to the selected variable.
</p>


<h3>Value</h3>

<p>If <code>xvar</code> is specified, a numeric object containing
the marginal effect of the chosen variable at each observation in
<code>object$model</code>.  For factor variables, if there are more than two
levels or <code>drop = FALSE</code>, the returned object is a matrix; otherwise it
is a vector.
</p>
<p>If <code>xvar</code> is <code>NULL</code>, a list of such results for each raw input
variable in the model is returned.
</p>
<p>In either case, the returned object is of class <code>"margEff.polywog"</code>.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>See Also</h3>

<p>To plot the density of the observationwise marginal effects, see
<code><a href="#topic+plot.margEff.polywog">plot.margEff.polywog</a></code>.  For a table of average marginal effects
and order statistics, <code><a href="#topic+summary.margEff.polywog">summary.margEff.polywog</a></code>.
</p>
<p>To compute fitted values, see <code><a href="#topic+predict.polywog">predict.polywog</a></code> and
<code><a href="#topic+predVals">predVals</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(22)
fit1 &lt;- polywog(prestige ~ education + income | type,
                data = Prestige,
                degree = 2,
                thresh = 1e-4)

## Compute marginal effects for all variables
me1 &lt;- margEff(fit1)
summary(me1)  # type was included linearly, hence constant effects

## Plotting density of the results
plot(me1)

## Can do the same when just examining a single variable
me2 &lt;- margEff(fit1, xvar = "income")
summary(me2)
plot(me2)
</code></pre>

<hr>
<h2 id='model.frame.polywog'>Model frame of a polywog model</h2><span id='topic+model.frame.polywog'></span>

<h3>Description</h3>

<p>Extracts the model frame from a fitted <code><a href="#topic+polywog">polywog</a></code> model, as
<code><a href="stats.html#topic+model.frame.lm">model.frame.lm</a></code> does for a fitted <code><a href="stats.html#topic+lm">lm</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
model.frame(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.frame.polywog_+3A_formula">formula</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code> (the argument is
named <code>formula</code> for consistency with the generic function
<code><a href="stats.html#topic+model.frame">model.frame</a></code>)</p>
</td></tr>
<tr><td><code id="model.frame.polywog_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored (but may later be adapted
for use as in <code><a href="stats.html#topic+model.frame.lm">model.frame.lm</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the variables used to fit the model, with
additional attributes (e.g., <code>"terms"</code>) used to construct a model
matrix.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>See Also</h3>

<p><code><a href="#topic+model.matrix.polywog">model.matrix.polywog</a></code> for constructing the design
matrix.
</p>

<hr>
<h2 id='model.matrix.polywog'>Model matrix of a polywog model</h2><span id='topic+model.matrix.polywog'></span>

<h3>Description</h3>

<p>Constructs the design matrix used to fit a <code><a href="#topic+polywog">polywog</a></code> model,
similar to <code><a href="stats.html#topic+model.matrix.lm">model.matrix.lm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
model.matrix(object, type = c("raw", "expanded"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.polywog_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code></p>
</td></tr>
<tr><td><code id="model.matrix.polywog_+3A_type">type</code></td>
<td>
<p><code>"raw"</code>, the default, returns the non-expanded model
matrix with no intercept (same number of columns as
<code>object$polyTerms</code>).  <code>"expanded"</code> returns the polynomial
expansion used in fitting (number of columns equals
<code>length(object$coefficients)</code>).</p>
</td></tr>
<tr><td><code id="model.matrix.polywog_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to further methods (typically only
used internally)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two types of model matrix a user might want to construct.
First, there is the matrix of the raw input terms that go into the
eventual polynomial expansion.  Such a matrix can be obtained by using
<code>type = "raw"</code> (the default). The other form of the model matrix is
the full polynomial expansion, where each column contains some power of
the raw inputs.  This can be obtained by using <code>type = "expanded"</code>.
</p>


<h3>Value</h3>

<p>The design matrix of the specified model, consisting either of raw
terms or the full polynomial expansion depending on the <code>type</code>
argument.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>

<hr>
<h2 id='plot.margEff.polywog'>Plot marginal effects</h2><span id='topic+plot.margEff.polywog'></span>

<h3>Description</h3>

<p>Generates density plots of the observationwise marginal effects computed by
<code><a href="#topic+margEff.polywog">margEff.polywog</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margEff.polywog'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.margEff.polywog_+3A_x">x</code></td>
<td>
<p>output of <code><a href="#topic+margEff.polywog">margEff.polywog</a></code>.</p>
</td></tr>
<tr><td><code id="plot.margEff.polywog_+3A_...">...</code></td>
<td>
<p>plotting parameters to be passed to <code><a href="stats.html#topic+plot.density">plot.density</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the variables whose densities were plotted,
invisibly.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>

<hr>
<h2 id='plot.polywog'>Univariate and bivariate fitted value plots</h2><span id='topic+plot.polywog'></span>

<h3>Description</h3>

<p>Generates plots of the relationship between input variables and the expected
value of the outcome, using <code><a href="#topic+predVals">predVals</a></code> as a backend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
plot(x, which = NULL, ask = FALSE, auto.set.par = TRUE,
  interval = TRUE, level = 0.95, FUN3D = c("contour", "filled.contour",
  "wireframe", "persp3d"), control.plot = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.polywog_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_which">which</code></td>
<td>
<p>selection of variables to plot: a character vector containing
one or two names of raw input variables (see <code>x$varNames</code>).  May also
be a numeric vector corresponding to indices of <code>x$varNames</code>.
If <code>which = NULL</code>, a plot of each individual term will be generated.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_ask">ask</code></td>
<td>
<p>logical: whether to display an interactive menu of terms to
select.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_auto.set.par">auto.set.par</code></td>
<td>
<p>logical: whether to temporarily change the graphics
parameters so that multiple plots are displayed in one window (e.g., each
univariate plot when <code>which = NULL</code>).</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_interval">interval</code></td>
<td>
<p>logical: whether to display bootstrap confidence intervals
around each fitted value.  Not available for bivariate plots unless
<code>FUN3d = "persp3d"</code>.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_level">level</code></td>
<td>
<p>confidence level for the intervals.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_fun3d">FUN3D</code></td>
<td>
<p>which plotting function to use to generate bivariate plots.
Valid options include <code>"<a href="graphics.html#topic+contour">contour</a>"</code> (the default) and
<code>"<a href="graphics.html#topic+filled.contour">filled.contour</a>"</code>; <code>"<a href="lattice.html#topic+wireframe">wireframe</a>"</code>, which
requires the <span class="pkg">lattice</span> package; and <code>"<a href="rgl.html#topic+persp3d">persp3d</a>"</code>, which
requires the <span class="pkg">rgl</span> package.</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_control.plot">control.plot</code></td>
<td>
<p>list of arguments to be passed to the underlying
plotting functions (e.g., axis labels and limits).</p>
</td></tr>
<tr><td><code id="plot.polywog_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="#topic+predVals">predVals</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, a univariate plot generated by <code>plot.polywog</code> shows the
relationship between the selected input variable and the expected outcome
while holding all other covariates at &quot;central&quot; values (as in
<code><a href="#topic+predVals">predVals</a></code>).  The values that the other variables are held out
can be changed by supplying additional arguments to <code>...</code>, as in the
examples below.
</p>
<p>Similarly, a bivariate plot shows the relationship between two input
variables and the expected outcome while holding all else fixed.  If either
variable is binary or categorical, the plot will show the relationship
between one variable and the expected outcome across each value/level of the
other.
</p>


<h3>Value</h3>

<p>An object of class <code>preplot.polywog</code>, invisibly.  This is a
data frame generated by <code><a href="#topic+predVals">predVals</a></code> that contains all information
used in plotting.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model with bootstrap iterations
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(22)
fit1 &lt;- polywog(prestige ~ education + income + type,
                data = Prestige,
                degree = 2,
                boot = 5,
                thresh = 1e-4)

## All univariate relationships
plot(fit1, n = 20)

## Predicted prestige across occupational categories
plot(fit1, which = "type",
     control.plot = list(xlab = "occupational category"))

## Predicted prestige by education across occupational categories
plot(fit1, which = c("education", "type"), n = 20)

## Joint effect of education and income
plot(fit1, which = c("education", "income"), n = 10)

## Bring up interactive menu
## Not run: 
plot(fit1, ask = TRUE)

  # displays menu:
  # Select one or two variable numbers (separated by spaces), or 0 to exit:

  # 1: education
  # 2: income
  # 3: type

## End(Not run)
</code></pre>

<hr>
<h2 id='polywog'>Polynomial regression with oracle variable selection</h2><span id='topic+polywog'></span>

<h3>Description</h3>

<p>Fits a regression model using a polynomial basis expansion of the input
variables, with penalization via the adaptive LASSO or SCAD to provide
oracle variable selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polywog(formula, data, subset, weights, na.action, degree = 3,
  family = c("gaussian", "binomial"), method = c("alasso", "scad"),
  penwt.method = c("lm", "glm"), unpenalized = character(0),
  .parallel = FALSE, boot = 0, control.boot = control.bp(.parallel =
  .parallel), lambda = NULL, nlambda = 100, lambda.min.ratio = 1e-04,
  nfolds = 10, foldid = NULL, thresh = ifelse(method == "alasso", 1e-07,
  0.001), maxit = ifelse(method == "alasso", 1e+05, 5000), model = TRUE,
  X = FALSE, y = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polywog_+3A_formula">formula</code></td>
<td>
<p>model formula specifying the response and input
variables.  See &quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="polywog_+3A_data">data</code></td>
<td>
<p>a data frame, list or environment containing the variables
specified in the model formula.</p>
</td></tr>
<tr><td><code id="polywog_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in fitting.</p>
</td></tr>
<tr><td><code id="polywog_+3A_weights">weights</code></td>
<td>
<p>an optional vector specifying weights for each observation to
be used in fitting.</p>
</td></tr>
<tr><td><code id="polywog_+3A_na.action">na.action</code></td>
<td>
<p>a function specifying what to do with observations
containing <code>NA</code>s (default <code><a href="stats.html#topic+na.omit">na.omit</a></code>).</p>
</td></tr>
<tr><td><code id="polywog_+3A_degree">degree</code></td>
<td>
<p>integer specifying the degree of the polynomial expansion of
the input variables.</p>
</td></tr>
<tr><td><code id="polywog_+3A_family">family</code></td>
<td>
<p><code>"gaussian"</code> (default) or <code>"binomial"</code> for logistic
regression (binary response only).</p>
</td></tr>
<tr><td><code id="polywog_+3A_method">method</code></td>
<td>
<p>variable selection method: <code>"alasso"</code> (default) for
adaptive LASSO or <code>"scad"</code> for SCAD.  You can also select <code>method
= "none"</code> to return the model matrix and other information without fitting.</p>
</td></tr>
<tr><td><code id="polywog_+3A_penwt.method">penwt.method</code></td>
<td>
<p>estimator for obtaining first-stage estimates in
logistic models when <code>method = "alasso"</code>: <code>"lm"</code> (default) for a
linear probability model, <code>"glm"</code> for logistic regression.</p>
</td></tr>
<tr><td><code id="polywog_+3A_unpenalized">unpenalized</code></td>
<td>
<p>names of model terms to be exempt from the adaptive
penalty (only available when <code>method = "alasso"</code>).</p>
</td></tr>
<tr><td><code id="polywog_+3A_.parallel">.parallel</code></td>
<td>
<p>logical: whether to perform k-fold cross-validation in
parallel (only available when <code>method = "alasso"</code>).  See &quot;Details&quot;
below for more information on parallel computation.</p>
</td></tr>
<tr><td><code id="polywog_+3A_boot">boot</code></td>
<td>
<p>number of bootstrap iterations (0 for no bootstrapping).</p>
</td></tr>
<tr><td><code id="polywog_+3A_control.boot">control.boot</code></td>
<td>
<p>list of arguments to be passed to
<code><a href="#topic+bootPolywog">bootPolywog</a></code> when bootstrapping; see <code><a href="#topic+control.bp">control.bp</a></code>.</p>
</td></tr>
<tr><td><code id="polywog_+3A_lambda">lambda</code></td>
<td>
<p>a vector of values from which the penalty factor is to be
selected via k-fold cross-validation.  <code>lambda</code> is left unspecified
by default, in which case a sequence of values is generated automatically,
controlled by the <code>nlambda</code> and <code>lambda.min.ratio</code> arguments.
Naturally, k-fold cross-validation is skipped if <code>lambda</code> contains
exactly one value.</p>
</td></tr>
<tr><td><code id="polywog_+3A_nlambda">nlambda</code></td>
<td>
<p>number of values of the penalty factor to examine via
cross-validation if <code>lambda</code> is not specified in advance; see
&quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="polywog_+3A_lambda.min.ratio">lambda.min.ratio</code></td>
<td>
<p>ratio of the lowest value to the highest in the
generated sequence of values of the penalty factor if <code>lambda</code> is
not specified; see &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="polywog_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds to use in cross-validation to select the
penalization factor.</p>
</td></tr>
<tr><td><code id="polywog_+3A_foldid">foldid</code></td>
<td>
<p>optional vector manually assigning fold numbers to each
observation used for fitting (only available when <code>method =
"alasso"</code>).</p>
</td></tr>
<tr><td><code id="polywog_+3A_thresh">thresh</code></td>
<td>
<p>convergence threshold, passed as the <code>thresh</code> argument
to <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> when <code>method = "alasso"</code> and as the
<code>eps</code> argument to <code><a href="ncvreg.html#topic+ncvreg">ncvreg</a></code> when <code>method = "scad"</code>.</p>
</td></tr>
<tr><td><code id="polywog_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations to allow in adaptive LASSO or
SCAD fitting.</p>
</td></tr>
<tr><td><code id="polywog_+3A_model">model</code></td>
<td>
<p>logical: whether to include the model frame in the returned
object.</p>
</td></tr>
<tr><td><code id="polywog_+3A_x">X</code></td>
<td>
<p>logical: whether to include the raw design matrix (i.e., the
matrix of input variables prior to taking their polynomial expansion) in
the returned object.</p>
</td></tr>
<tr><td><code id="polywog_+3A_y">y</code></td>
<td>
<p>logical: whether to include the response variable in the returned
object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design matrix for the regression is a polynomial basis expansion of the
matrix of raw input variables.  This includes all powers and interactions of
the input variables up to the specified <code>degree</code>.  For example, the
following terms will be included in <code>polywog(y ~ x1 + x2, degree = 3,
...)</code>:
</p>

<ul>
<li><p> terms of degree 0: intercept
</p>
</li>
<li><p> terms of degree 1: <code>x1</code>, <code>x2</code>
</p>
</li>
<li><p> terms of degree 2: <code>x1^2</code>, <code>x2^2</code>, <code>x1*x2</code>
</p>
</li>
<li><p> terms of degree 3: <code>x1^3</code>, <code>x2^3</code>, <code>x1*x2^2</code>,
<code>x1^2*x2</code>
</p>
</li></ul>

<p>To exclude certain terms from the basis expansion, use a model formula like
<code>y ~ x1 + x2 | z1 + z2</code>.  Only the degree 1 terms of <code>z1</code> and
<code>z2</code> will be included.
</p>
<p>It is possible that the &quot;raw&quot; basis expansion will be rank-deficient, such
as if there are binary input variables (in which case <code class="reqn">x_i = x_i^n</code> for
all <code class="reqn">n &gt; 0</code>).  The procedure detects collinearity via <code><a href="Matrix.html#topic+qr">qr</a></code> and
removes extraneous columns before fitting.
</p>
<p>For both the adaptive LASSO and SCAD, the penalization factor <code class="reqn">\lambda</code>
is chosen by k-fold cross-validation.  The selected value minimizes the
average mean squared error of out-of-sample fits.  (To select both
<code class="reqn">\lambda</code> and the polynomial degree simultaneously via cross-validation,
see <code><a href="#topic+cv.polywog">cv.polywog</a></code>.)
</p>
<p>The cross-validation process may be run in parallel via
<code><a href="foreach.html#topic+foreach">foreach</a></code> by registering an appropriate backend and specifying
<code>.parallel = TRUE</code>.  The appropriate backend is system-specific; see
<code><a href="foreach.html#topic+foreach">foreach</a></code> for information on selecting and registering a
backend.  The bootstrap iterations may also be run in parallel by
specifying <code>control.boot = control.bp(.parallel = TRUE)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"polywog"</code>, a list containing: </p>

<dl>
<dt><code>coefficients</code></dt><dd><p>the estimated coefficients.</p>
</dd>
<dt><code>lambda</code></dt><dd><p>value of the penalty factor <code class="reqn">\lambda</code> used to
fit the final model.</p>
</dd>
<dt><code>lambda.cv</code></dt><dd><p>a list containing the results of the
cross-validation procedure used to select the penalty factor: </p>

<dl>
<dt><code>lambda</code></dt><dd><p>values of the penalty factor tested in
cross-validation.</p>
</dd>
<dt><code>cvError</code></dt><dd><p>out-of-fold prediction error corresponding to
each value of <code>lambda</code>.</p>
</dd>
<dt><code>lambdaMin</code></dt><dd><p>value of <code>lambda</code> with the minimal
cross-validation error.</p>
</dd>
<dt><code>errorMin</code></dt><dd><p>minimized value of the cross-validation error.</p>
</dd>
</dl>
</dd>
<dt><code>fitted.values</code></dt><dd><p>the fitted mean values for each observation
used in fitting.</p>
</dd>
<dt><code>lmcoef</code></dt><dd><p>coefficients from an unpenalized least-squares
regression of the response variable on the polynomial expansion of the
input variables.</p>
</dd>
<dt><code>penwt</code></dt><dd><p>adaptive weight given to each term in the LASSO
penalty (<code>NULL</code> for models fit via SCAD).</p>
</dd>
<dt><code>formula</code></dt><dd><p>model formula, as a <code><a href="Formula.html#topic+Formula">Formula</a></code> object.</p>
</dd>
<dt><code>degree</code></dt><dd><p>degree of the polynomial basis expansion.</p>
</dd>
<dt><code>family</code></dt><dd><p>model family, <code>"gaussian"</code> or
<code>"binomial"</code>.</p>
</dd>
<dt><code>weights</code></dt><dd><p>observation weights if specified.</p>
</dd>
<dt><code>method</code></dt><dd><p>the specified regularization method.</p>
</dd>
<dt><code>penwt.method</code></dt><dd><p>the specified method for calculating
the adaptive LASSO weights (<code>NULL</code> for models fit via SCAD).</p>
</dd>
<dt><code>unpenalized</code></dt><dd><p>logical vector indicating which terms were not
included in the LASSO penalty.</p>
</dd>
<dt><code>thresh</code></dt><dd><p>convergence threshold used in fitting.</p>
</dd>
<dt><code>maxit</code></dt><dd><p>iteration limit used in fitting.</p>
</dd>
<dt><code>terms</code></dt><dd><p>the <code><a href="stats.html#topic+terms">terms</a></code> object used to construct the
model frame.</p>
</dd>
<dt><code>polyTerms</code></dt><dd><p>a matrix indicating the power of each raw input
term (columns) in each term of the polynomial expansion used in fitting
(rows).</p>
</dd>
<dt><code>nobs</code></dt><dd><p>the number of observations used to fit the model.</p>
</dd>
<dt><code>na.action</code></dt><dd><p>information on how <code>NA</code> values in the input
data were handled.</p>
</dd>
<dt><code>xlevels</code></dt><dd><p>levels of factor variables used in fitting.</p>
</dd>
<dt><code>varNames</code></dt><dd><p>names of the raw input variables included in the
model formula.</p>
</dd>
<dt><code>call</code></dt><dd><p>the original function call.</p>
</dd>
<dt><code>model</code></dt><dd><p>if <code>model = TRUE</code>, the model frame used in
fitting; otherwise <code>NULL</code>.</p>
</dd>
<dt><code>X</code></dt><dd><p>if <code>X = TRUE</code>, the raw model matrix (i.e., prior to
taking the polynomial expansion); otherwise <code>NULL</code>.  For calculating
the expanded model matrix, see <code><a href="#topic+model.matrix.polywog">model.matrix.polywog</a></code>.</p>
</dd>
<dt><code>y</code></dt><dd><p>if <code>y = TRUE</code>, the response variable used in
fitting; otherwise <code>NULL</code>.</p>
</dd>
<dt><code>boot.matrix</code></dt><dd><p>if <code>boot &gt; 0</code>, a sparse matrix of class
<code>"<a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix</a>"</code> where each column is the estimate from a
bootstrap replicate.  See <code><a href="#topic+bootPolywog">bootPolywog</a></code> for more information
on bootstrapping.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>References</h3>

<p>Brenton Kenkel and Curtis S. Signorino.  2012.  &quot;A Method for
Flexible Functional Form Estimation: Bootstrapped Basis Regression with
Variable Selection.&quot;  Typescript, University of Rochester.
</p>


<h3>See Also</h3>

<p>To estimate variation via the bootstrap, see
<code><a href="#topic+bootPolywog">bootPolywog</a></code>.  To generate fitted values, see
<code><a href="#topic+predVals">predVals</a></code> (and the underlying method
<code><a href="#topic+predict.polywog">predict.polywog</a></code>).  For plots, see <code><a href="#topic+plot.polywog">plot.polywog</a></code>.
The polynomial degree may be selected via cross-validation using
<code><a href="#topic+cv.polywog">cv.polywog</a></code>.
</p>
<p>Adaptive LASSO estimates are provided via <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> and
<code><a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></code> from the <span class="pkg">glmnet</span> package.  SCAD estimates are
via <code><a href="ncvreg.html#topic+ncvreg">ncvreg</a></code> and <code><a href="ncvreg.html#topic+cv.ncvreg">cv.ncvreg</a></code> in the <span class="pkg">ncvreg</span>
package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model with bootstrap iterations
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(22)
fit1 &lt;- polywog(prestige ~ education + income + type,
                data = Prestige,
                degree = 2,
                boot = 5,
                thresh = 1e-4)

## Basic information
print(fit1)
summary(fit1)

## See how fitted values change with education holding all else fixed
predVals(fit1, "education", n = 10)

## Plot univariate relationships
plot(fit1)

## Use SCAD instead of adaptive LASSO
fit2 &lt;- update(fit1, method = "scad", thresh = 1e-3)
cbind(coef(fit1), coef(fit2))
</code></pre>

<hr>
<h2 id='predict.polywog'>Predict method for polywog objects</h2><span id='topic+predict.polywog'></span>

<h3>Description</h3>

<p>Generates fitted values, including bootstrap confidence intervals, for in-
and out-of-sample data from a fitted polywog model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
predict(object, newdata, type = c("link", "response"),
  interval = FALSE, level = 0.95, bag = FALSE, na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.polywog_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame containing observations for which
fitted values should be computed.  If not specified, fitted values are
generated for the data used to fit the model.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_type">type</code></td>
<td>
<p>specifies whether the fitted values should be generated on the
link scale (<code class="reqn">X \beta</code>) or in terms of the expected value of the response
variable.  These only differ for binomial family models.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_interval">interval</code></td>
<td>
<p>logical: whether to calculate bootstrap confidence intervals
for each fitted value.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_level">level</code></td>
<td>
<p>confidence level for the intervals.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_bag">bag</code></td>
<td>
<p>logical: whether to use &quot;bootstrap aggregation&quot; to generate the
main fitted values (if <code>FALSE</code>, they are calculated from the main model
fit).</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_na.action">na.action</code></td>
<td>
<p>a function specifying what to do with observations in
<code>newdata</code> containing <code>NA</code>s (default <code><a href="stats.html#topic+na.pass">na.pass</a></code>).  See
&quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="predict.polywog_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>interval = TRUE</code>, a matrix containing each fitted value and
its confidence interval.  Otherwise, a vector containing the fitted values.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>See Also</h3>

<p>For more user-friendly generation of fitted values, see
<code><a href="#topic+predVals">predVals</a></code>.  To compute marginal effects, see
<code><a href="#topic+margEff.polywog">margEff.polywog</a></code>.
</p>

<hr>
<h2 id='predVals'>Easy computation of fitted values</h2><span id='topic+predVals'></span>

<h3>Description</h3>

<p>User-friendly generation of fitted values and their confidence intervals
from models of class <code>"polywog"</code>, using the &quot;observed-value approach&quot;
advocated by Hanmer and Kalkan (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predVals(model, xvars, data = model$model, xlims = list(), n = 100,
  interval = TRUE, level = 0.95, maxrows = 10000, report = FALSE,
  .parallel = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predVals_+3A_model">model</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="predVals_+3A_xvars">xvars</code></td>
<td>
<p>a character vector containing names of raw input variables
(from <code>model$varNames</code>).  Partial matches are allowed.</p>
</td></tr>
<tr><td><code id="predVals_+3A_data">data</code></td>
<td>
<p>data frame to treat as the observed sample (defaults to the
data used to fit the supplied model)</p>
</td></tr>
<tr><td><code id="predVals_+3A_xlims">xlims</code></td>
<td>
<p>named list of limits for the evaluation grid for each
continuous variable in <code>xvars</code>.  If not given, the variable's observed
range is used.</p>
</td></tr>
<tr><td><code id="predVals_+3A_n">n</code></td>
<td>
<p>number of grid points at which to evaluate each continuous variable
in <code>xvars</code>.</p>
</td></tr>
<tr><td><code id="predVals_+3A_interval">interval</code></td>
<td>
<p>logical: whether to compute bootstrap confidence intervals
for each fitted value.</p>
</td></tr>
<tr><td><code id="predVals_+3A_level">level</code></td>
<td>
<p>confidence level for the intervals.</p>
</td></tr>
<tr><td><code id="predVals_+3A_maxrows">maxrows</code></td>
<td>
<p>maximum number of rows of output.  Used to prevent accidental
memory overruns when <code>xvars</code> contains more than two continuous
variables.</p>
</td></tr>
<tr><td><code id="predVals_+3A_report">report</code></td>
<td>
<p>logical: whether to print a status bar.  Not available if
<code>.parallel = TRUE</code>.</p>
</td></tr>
<tr><td><code id="predVals_+3A_.parallel">.parallel</code></td>
<td>
<p>logical: whether to perform bootstrap iterations in
parallel using <code><a href="foreach.html#topic+foreach">foreach</a></code>.  See the &quot;Details&quot; section of
the <code><a href="#topic+bootPolywog">bootPolywog</a></code> documentation page for more on parallel
computation.</p>
</td></tr>
<tr><td><code id="predVals_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predVals</code> allows users to examine the estimated effects of input
variables on the expected outcome using the coefficients returned by
<code><a href="#topic+polywog">polywog</a></code>.  The procedure is designed so that, for a preliminary
analysis, the user can simply specify the fitted model and the independent
variable of interest, and quickly obtain predicted values.
</p>
<p>The predicted values are generated according to Hanmer and Kalkan's (2013)
observed-value approach, which takes the form of a nested loop.  When
<code>xvars</code> contains a single variable <code class="reqn">X_m</code>, the procedure is as
follows:
</p>

<ol>
<li><p> For each level <code class="reqn">x</code> of <code class="reqn">X_m</code> in <code>data</code> (if <code class="reqn">X_m</code>
is discrete) or each element <code class="reqn">x</code> of a grid over the range of <code class="reqn">X_m</code>
in <code>data</code> (if <code class="reqn">X_m</code> is continuous):
</p>

<ol>
<li><p> For each observation <code class="reqn">i</code> of <code>data</code>:
</p>

<ol>
<li><p> Set <code class="reqn">X_{mi} = x</code>, while holding all other variables
<code class="reqn">X_{-mi}</code> at their observed levels
</p>
</li>
<li><p> Compute the predicted value of <code class="reqn">Y_i</code> for the modified
observation <code class="reqn">i</code>, using the estimated model coefficients (as in
<code><a href="#topic+predict.polywog">predict.polywog</a></code>)
</p>
</li></ol>

</li>
<li><p> The predicted value of <code class="reqn">Y</code> given <code class="reqn">X_m = x</code> is the average of
the predictions computed in the previous step
</p>
</li></ol>

</li></ol>

<p>This observed-value approach provides a better estimate of population
average effects for nonlinear models than does the traditional approach,
which is to vary <code class="reqn">X_m</code> across its levels/range while holding each
other covariate to its mean or median in <code>data</code> (Hanmer and Kalkan
2013).
</p>
<p>When <code>xvars</code> consists of multiple variables <code class="reqn">X_1, \ldots,
X_M</code>, the <code>predVals</code> procedure is the same, except the
outer loop is over every <em>combination</em> of their levels in
<code>data</code>.
</p>
<p>All confidence intervals are generated via the bootstrap.  Specifically,
<code>predVals</code> repeats the above procedure for each set of bootstrap
coefficients and computes order statistics of the resulting set of
averages (for each combination of levels of <code>xvars</code>).  If
<code>model</code> does not have a <code>boot.matrix</code> element (see
<code><a href="#topic+bootPolywog">bootPolywog</a></code>), confidence intervals will not be computed.
</p>


<h3>Value</h3>

<p>A data frame containing the fitted values and confidence intervals
(if requested) for each combination of covariate values.
</p>
<p>The returned data frame also inherits from class <code>"preplot.polywog"</code>.
This is used by <code><a href="#topic+plot.polywog">plot.polywog</a></code>, which calls <code>predVals</code> to
compute the values to plot.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>References</h3>

<p>Michael J. Hanmer and Kerem Ozan Kalkan.  2013.  &quot;Behind the Curve:
Clarifying the Best Approach to Calculating Predicted Probabilities and
Marginal Effects from Limited Dependent Variable Models.&quot;  <em>American
Journal of Political Science</em> 57(1):263&ndash;277.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.polywog">predict.polywog</a></code> for more flexible (but less
user-friendly) computation of fitted values.  <code><a href="#topic+plot.polywog">plot.polywog</a></code> for
plotting fitted values and their confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model with bootstrap iterations
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(22)
fit1 &lt;- polywog(prestige ~ education + income + type,
                data = Prestige,
                degree = 2,
                boot = 5,
                thresh = 1e-4)

## Predicted prestige across occupational categories
predVals(fit1, "type")

## Predicted prestige by education
predVals(fit1, "education", n = 10)

## Plotting
pred_income &lt;- predVals(fit1, "income", n = 10)
plot(pred_income)
</code></pre>

<hr>
<h2 id='summary.margEff.polywog'>Summarize marginal effects</h2><span id='topic+summary.margEff.polywog'></span>

<h3>Description</h3>

<p>Generates a table of the average marginal effects and quartiles (or other
order statistics if requested) from a <code>"margEff.polywog"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'margEff.polywog'
summary(object, probs = seq(0, 1, by = 0.25), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.margEff.polywog_+3A_object">object</code></td>
<td>
<p>output of <code><a href="#topic+margEff.polywog">margEff.polywog</a></code>.</p>
</td></tr>
<tr><td><code id="summary.margEff.polywog_+3A_probs">probs</code></td>
<td>
<p>order statistics to display.</p>
</td></tr>
<tr><td><code id="summary.margEff.polywog_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table of results.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>

<hr>
<h2 id='summary.polywog'>Summarize a fitted polywog model</h2><span id='topic+summary.polywog'></span>

<h3>Description</h3>

<p>Generates a &quot;regression table&quot; to summarize the fitted model, including
coefficients along with their bootstrapped standard errors and confidence
intervals.  If the fitted model does not have a <code>boot.matrix</code> element,
the output will contain <code>NA</code>s for the standard errors, and confidence
intervals will not be displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'polywog'
summary(object, level = 0.95, prop0 = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.polywog_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code><a href="#topic+polywog">polywog</a></code>.</p>
</td></tr>
<tr><td><code id="summary.polywog_+3A_level">level</code></td>
<td>
<p>width of the bootstrap confidence interval to compute for the
model coefficients.</p>
</td></tr>
<tr><td><code id="summary.polywog_+3A_prop0">prop0</code></td>
<td>
<p>logical: whether to print the proportion of bootstrap
iterations in which each coefficient was estimated as exactly 0.  This may
be informative but should <em>not</em> be interpreted as a p-value.</p>
</td></tr>
<tr><td><code id="summary.polywog_+3A_...">...</code></td>
<td>
<p>other arguments, currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"summary.polywog"</code> whose elements are the
&quot;regression table&quot; (<code>coefficients</code>) and additional information from the
original fitted model.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
