<!DOCTYPE html><html lang="en"><head><title>Help for package moRphomenses</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {moRphomenses}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mm_ArrayData'><p>Array Data</p></a></li>
<li><a href='#mm_BuildModel'><p>Build, implement, visualize multivariate linear model.</p></a></li>
<li><a href='#mm_CalcShapespace'><p>Define Shapespace of aligned dataset.</p></a></li>
<li><a href='#mm_CheckImputation'><p>Check Imputation</p></a></li>
<li><a href='#mm_ColorLeaves'><p>Color leves of a dendrogram</p></a></li>
<li><a href='#mm_CompModel'><p>Compare Model Metrics</p></a></li>
<li><a href='#mm_CompModel_Full'><p>Compare Complex Model Metrics</p></a></li>
<li><a href='#mm_coords_to_shape'><p>Visualize shape of target coordinates</p></a></li>
<li><a href='#mm_data'><p>Sample hormone dataset</p></a></li>
<li><a href='#mm_Diagnostics'><p>Run a suite of diagnostic analyses.</p></a></li>
<li><a href='#mm_ellipse'><p>Add confidence ellipses to an active scatterplot.</p></a></li>
<li><a href='#mm_Explorer'><p>Launch mm_Explorer</p></a></li>
<li><a href='#mm_FillMissing'><p>Impute Missing Data</p></a></li>
<li><a href='#mm_FlattenArray'><p>Flatten Array</p></a></li>
<li><a href='#mm_get_interval'><p>Create equallly spaced intervals.</p></a></li>
<li><a href='#mm_grp_dists'><p>Distance from Centroid</p></a></li>
<li><a href='#mm_grps_PlotArray'><p>Plot Arrays of groups</p></a></li>
<li><a href='#mm_mute_cols'><p>Take a color and modify it</p></a></li>
<li><a href='#mm_Phenotype'><p>Generate Phenotypes</p></a></li>
<li><a href='#mm_PlotArray'><p>Plot Array</p>
Plot individuals and optionally mean form</a></li>
<li><a href='#mm_pretty_pca'><p>Plot Calendar Days</p></a></li>
<li><a href='#mm_ScreePlot'><p>Scree Plot</p></a></li>
<li><a href='#mm_SilPlot'><p>Silhouette Width Plot</p></a></li>
<li><a href='#mm_transf_geom'><p>Geometric Scaling</p></a></li>
<li><a href='#mm_transf_log'><p>natural log transform</p></a></li>
<li><a href='#mm_transf_log10'><p>Common log transform</p></a></li>
<li><a href='#mm_transf_minmax'><p>Min-Max Scaling</p></a></li>
<li><a href='#mm_transf_zscore'><p>Z scores</p></a></li>
<li><a href='#mm_VizModel'><p>Visualize Multivariate LM</p></a></li>
<li><a href='#mm_VizShapespace'><p>Visualize PC axes</p></a></li>
<li><a href='#moRphomenses'><p>Geometric Morphometric Analysis of Hormone Cycle Phenotypes</p></a></li>
<li><a href='#print_summary'><p>Print basic summary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Geometric Morphometric Tools to Align, Scale, and Compare
"Shape" of Menstrual Cycle Hormones</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Mitteroecker &amp; Gunz (2009) &lt;<a href="https://doi.org/10.1007%2Fs11692-009-9055-x">doi:10.1007/s11692-009-9055-x</a>&gt; describe
    how geometric morphometric methods allow researchers to quantify the size
    and shape of physical biological structures. We provide tools to extend geometric
    morphometric principles to the study of non-physical structures, hormone profiles, 
    as outlined in Ehrlich et al (2021) &lt;<a href="https://doi.org/10.1002%2Fajpa.24514">doi:10.1002/ajpa.24514</a>&gt;. Easily transform 
    daily measures into multivariate landmark-based data. Includes custom functions 
    to apply multivariate methods for data exploration as well as hypothesis testing. 
    Also includes 'shiny' web app to streamline data exploration. Developed to study 
    menstrual cycle hormones but functions have been generalized and should be 
    applicable to any biomarker over any time period.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/ClancyLabUIUC/moRphomenses&amp;gt;">https://github.com/ClancyLabUIUC/moRphomenses&gt;</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dendextend, geomorph, cluster, shiny</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-06 18:00:43 UTC; ehrli097</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Ehrlich [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Ehrlich &lt;dan.ehrlich.e@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-08 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mm_ArrayData'>Array Data</h2><span id='topic+mm_ArrayData'></span>

<h3>Description</h3>

<p>Construct a ragged array (containing missing data) of a specified length (up/down sampling individuals to fit).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_ArrayData(
  IDs,
  DAYS,
  VALUE,
  MID = NULL,
  targetLENGTH,
  targetMID = NULL,
  transformation = c("minmax", "geom", "zscore", "log", "log10"),
  impute_missing = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_ArrayData_+3A_ids">IDs</code></td>
<td>
<p>A vector that contains individual IDs repeated for multiple days of collection.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_days">DAYS</code></td>
<td>
<p>A vector that contains information on time, IE Day 1, Day 2, Day 3. Note: this vector should include integers, continuous data might produce unintended results.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_value">VALUE</code></td>
<td>
<p>A vector containing the variable sampled.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_mid">MID</code></td>
<td>
<p>Am optional vector of midpoints to center each individuals profile. These should be unique to each individual and repeated for each observation of DAYS, VALUE, and IDs. If NULL (defualt), data will not be centered on any day.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_targetlength">targetLENGTH</code></td>
<td>
<p>Integer. Number of days to up/down sample observations to using <code><a href="#topic+mm_get_interval">mm_get_interval</a></code>.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_targetmid">targetMID</code></td>
<td>
<p>If NULL (default) data will not be centered and will range from 0 to 1. If specified, data will be centered on 0 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_transformation">transformation</code></td>
<td>
<p>Which (if any) data transformation to apply. Our reccomendation is minmax, but Geometric mean, Zscore, natural log and log10 transformations are available, if desired.</p>
</td></tr>
<tr><td><code id="mm_ArrayData_+3A_impute_missing">impute_missing</code></td>
<td>
<p>Integer. If not null, number of nearest-neighbors to use to impute missing data (Default = 3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a 3D array of data to be analyzed with individuals in the 3rd dimension.
</p>

<hr>
<h2 id='mm_BuildModel'>Build, implement, visualize multivariate linear model.</h2><span id='topic+mm_BuildModel'></span>

<h3>Description</h3>

<p>Easily evaluate simple model sets (one covariate with up to 2 additional
classifiers/covariates). Helpful for exploratory analysis. For detailed
models or specific combinations of variables, see <a href="geomorph.html#topic+procD.lm">geomorph::procD.lm</a>
for full use of this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_BuildModel(shape_data, ..., subgrps = NULL, ff1 = NULL, univ_series = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_BuildModel_+3A_shape_data">shape_data</code></td>
<td>
<p>This will be the (multivariate) response variable</p>
</td></tr>
<tr><td><code id="mm_BuildModel_+3A_...">...</code></td>
<td>
<p>Covariate(s)/classifier(s) to build a model set. Individual models
are run with interaction effects.</p>
</td></tr>
<tr><td><code id="mm_BuildModel_+3A_subgrps">subgrps</code></td>
<td>
<p>Optional. Vector of group membership. Model sets will be run
across the whole sample and subgroups. If k is specified, only the full
model will be run.</p>
</td></tr>
<tr><td><code id="mm_BuildModel_+3A_ff1">ff1</code></td>
<td>
<p>An explicit model to test in the format: &quot; coords ~ ...&quot;. Names
must match those specifed in <code>...</code>. Standard lm notation applies.</p>
</td></tr>
<tr><td><code id="mm_BuildModel_+3A_univ_series">univ_series</code></td>
<td>
<p>Default (FALSE) will evaluate multiple covariates and their
interaction in a single model. However, it can be helpful to understand the
univariate effects in isolation of interaction/confounding factors. Set
<code>univ_series=TRUE</code> to produce a series of model sets, one for each covariate
specified (NOTE: ff1 must also be NULL for this to work).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing output of one or more multivariate linear models
that can be inspected on their own or interacted with using <a href="#topic+mm_VizModel">mm_VizModel</a>
or <a href="#topic+mm_CompModel">mm_CompModel</a>.
</p>

<hr>
<h2 id='mm_CalcShapespace'>Define Shapespace of aligned dataset.</h2><span id='topic+mm_CalcShapespace'></span>

<h3>Description</h3>

<p>Conduct PCA of shape data and visualize major shape trends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_CalcShapespace(dat, max_Shapes = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_CalcShapespace_+3A_dat">dat</code></td>
<td>
<p>A 3D array of shape data to be analyzed.</p>
</td></tr>
<tr><td><code id="mm_CalcShapespace_+3A_max_shapes">max_Shapes</code></td>
<td>
<p>The maximum amount of PCs to visualize. Default 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the results of shape-pca, including vizualizations of shape extrema for each Principal Component.
</p>

<hr>
<h2 id='mm_CheckImputation'>Check Imputation</h2><span id='topic+mm_CheckImputation'></span>

<h3>Description</h3>

<p>Plot Raw (aligned) data along side by side with imputed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_CheckImputation(A1, A2, ObO = interactive())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_CheckImputation_+3A_a1">A1</code></td>
<td>
<p>An aligned array, containing missing data (presumably made with
<code><a href="#topic+mm_ArrayData">mm_ArrayData</a></code><code style="white-space: pre;">&#8288;$shape_data_wNA&#8288;</code>).</p>
</td></tr>
<tr><td><code id="mm_CheckImputation_+3A_a2">A2</code></td>
<td>
<p>An aligned and imputed array (presumably made with
<code><a href="#topic+mm_ArrayData">mm_ArrayData</a></code><code style="white-space: pre;">&#8288;$Shape_data&#8288;</code>).</p>
</td></tr>
<tr><td><code id="mm_CheckImputation_+3A_obo">ObO</code></td>
<td>
<p>One-by-One. If TRUE (default, in interactive sessions), individuals
will be plotted one at a time, requiring the user to advance/exit the
operation. If FALSE, all plots #' will be generated at once to be browsed
or exported from the <code>Plots</code> panel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A series of plots for each individual in the array. If <code>ObO=TRUE</code> user
input is required to advance or exit the plotting.
</p>

<hr>
<h2 id='mm_ColorLeaves'>Color leves of a dendrogram</h2><span id='topic+mm_ColorLeaves'></span>

<h3>Description</h3>

<p>Specify color order approriately for a dendrogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_ColorLeaves(dendro, cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_ColorLeaves_+3A_dendro">dendro</code></td>
<td>
<p>A dendrogram or hclust class object</p>
</td></tr>
<tr><td><code id="mm_ColorLeaves_+3A_cols">cols</code></td>
<td>
<p>a vector of colors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Leaves of a dendrogram will be re-ordered compared to most input classifiers. This function takes the study-ordered colors and correctly applies them to the dendrogram using <code>dendextend</code>
</p>


<h3>Value</h3>

<p>A dendrogram class object with leaves colored as specified.
</p>

<hr>
<h2 id='mm_CompModel'>Compare Model Metrics</h2><span id='topic+mm_CompModel'></span>

<h3>Description</h3>

<p>Compare key figs (Rsq, p-value, etc) across multiple models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_CompModel(mv_results, row_labels = NULL, digits = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_CompModel_+3A_mv_results">mv_results</code></td>
<td>
<p>Input mvlm, created by mm_BuildModel (or by using geomorph::procD.lm)</p>
</td></tr>
<tr><td><code id="mm_CompModel_+3A_row_labels">row_labels</code></td>
<td>
<p>A character vector to use in output. If NULL (default) labels from the input data will be used.</p>
</td></tr>
<tr><td><code id="mm_CompModel_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places to round to. Default includes 4 decimal places.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the results of the mvlm, visualizations of shape
trends along the regression line, and the model itself.
</p>

<hr>
<h2 id='mm_CompModel_Full'>Compare Complex Model Metrics</h2><span id='topic+mm_CompModel_Full'></span>

<h3>Description</h3>

<p>Compare key figs (Rsq, p-value, etc) across multiple complex models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_CompModel_Full(mv_results, row_labels = NULL, var_labels = NULL, digits = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_CompModel_Full_+3A_mv_results">mv_results</code></td>
<td>
<p>Input mvlm, created by <a href="#topic+mm_BuildModel">mm_BuildModel</a> (or by using
<a href="geomorph.html#topic+procD.lm">geomorph::procD.lm</a>)</p>
</td></tr>
<tr><td><code id="mm_CompModel_Full_+3A_row_labels">row_labels</code></td>
<td>
<p>A character vector to use in output. If NULL (default)
labels from the input data will be used.</p>
</td></tr>
<tr><td><code id="mm_CompModel_Full_+3A_var_labels">var_labels</code></td>
<td>
<p>A character vector to use in output. If NULL (default)
labels from the input data will be used.</p>
</td></tr>
<tr><td><code id="mm_CompModel_Full_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places to round to. Default includes 4
decimal places.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>description
</p>

<hr>
<h2 id='mm_coords_to_shape'>Visualize shape of target coordinates</h2><span id='topic+mm_coords_to_shape'></span>

<h3>Description</h3>

<p>Visualize shape of target coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_coords_to_shape(A, PCA, target_coords, target_PCs = c(1, 2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_coords_to_shape_+3A_a">A</code></td>
<td>
<p>A landmark array used for the pca</p>
</td></tr>
<tr><td><code id="mm_coords_to_shape_+3A_pca">PCA</code></td>
<td>
<p>output of prcomp. Should contain $transormation</p>
</td></tr>
<tr><td><code id="mm_coords_to_shape_+3A_target_coords">target_coords</code></td>
<td>
<p>A single set of X,Y coordinates.</p>
</td></tr>
<tr><td><code id="mm_coords_to_shape_+3A_target_pcs">target_PCs</code></td>
<td>
<p>Integer identifying which pc to use on the X and Y axis.
Default is c(1,2) for PC1 on x and PC2 on y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A landmark array representing the hypothetical shape of a given set
of coordinates.
</p>

<hr>
<h2 id='mm_data'>Sample hormone dataset</h2><span id='topic+mm_data'></span>

<h3>Description</h3>

<p>Sample dataset classifiers to be paired with sample array. This table contains 60 rows to match the 60 individuals across the third dimension of the array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_data
</code></pre>


<h3>Format</h3>

<p>A matrix with 2015 obs (rows) and 4 variables (columns).
</p>

<dl>
<dt>ID</dt><dd><p>Individual id, each integer represents a different individual.</p>
</dd>
<dt>CYCLEDAY</dt><dd><p>Integer day of cycle. Generally runs from 1 ... (28 on average).</p>
</dd>
<dt>MIDPOINT</dt><dd><p>Single value for each individual, repeated along each CYCLEDAY. In this sample, day of ovulation.</p>
</dd>
<dt>E1G</dt><dd><p>Daily measure of hormone, in nanograms per mililiter</p>
</dd>
</dl>


<hr>
<h2 id='mm_Diagnostics'>Run a suite of diagnostic analyses.</h2><span id='topic+mm_Diagnostics'></span>

<h3>Description</h3>

<p>Conduct a set of analyses to make shape-PCA results easier to interpret.
Specifically, this will provide a table of eigen values (optional barplot), provide 5-number summary across each PC, conduct a naive Ward's clustering of PC scores (optional dendrogram, along with silhouette plot and scree plot of individual
distance to the sample mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_Diagnostics(dat, max_PC_viz = 10, max_PC_calc = NULL, hide_plots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_Diagnostics_+3A_dat">dat</code></td>
<td>
<p>A 3D array or a mmPCA object (output of mm_CalcShapespace).</p>
</td></tr>
<tr><td><code id="mm_Diagnostics_+3A_max_pc_viz">max_PC_viz</code></td>
<td>
<p>Maximum number of PCs to include in visualizations (EG Eigenplots, or shape trends.</p>
</td></tr>
<tr><td><code id="mm_Diagnostics_+3A_max_pc_calc">max_PC_calc</code></td>
<td>
<p>By default (NULL), all PCs will be included in calculations. However, if fewer PCs are required users may specify an integer, n, to get the first n PCS.</p>
</td></tr>
<tr><td><code id="mm_Diagnostics_+3A_hide_plots">hide_plots</code></td>
<td>
<p>By default (FALSE), helpful visuals are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list containing the results of:
</p>

<ul>
<li><p> eigs - A table containing individual and cumulutive loadings for each PC
</p>
</li>
<li><p> PC_5_num - A data.frame containing the fivenum summary for each PC
</p>
</li>
<li><p> TREE - A dendrogram representing the results of a naive-Ward's clustering
</p>
</li></ul>


<hr>
<h2 id='mm_ellipse'>Add confidence ellipses to an active scatterplot.</h2><span id='topic+mm_ellipse'></span>

<h3>Description</h3>

<p>Add confidence ellipses to an active scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_ellipse(
  dat,
  ci = c(67.5, 90, 95, 99),
  linesCol = "black",
  fillCol = "grey",
  smoothness = 20
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_ellipse_+3A_dat">dat</code></td>
<td>
<p>A matrix of data to draw an ellipses around.</p>
</td></tr>
<tr><td><code id="mm_ellipse_+3A_ci">ci</code></td>
<td>
<p>Percentage of data to capture. Must be one of c(67.5, 90, 95, 99).</p>
</td></tr>
<tr><td><code id="mm_ellipse_+3A_linescol">linesCol</code></td>
<td>
<p>Border color of the shape.</p>
</td></tr>
<tr><td><code id="mm_ellipse_+3A_fillcol">fillCol</code></td>
<td>
<p>Fill color of the shape.</p>
</td></tr>
<tr><td><code id="mm_ellipse_+3A_smoothness">smoothness</code></td>
<td>
<p>Lower values will look jagged, higher value will make
smoother lines, but may take a long time to plot. Default value is 20.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value. Will add an ellipses of a given size to the current plot.
</p>

<hr>
<h2 id='mm_Explorer'>Launch mm_Explorer</h2><span id='topic+mm_Explorer'></span>

<h3>Description</h3>

<p>Launch mm_Explorer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_Explorer()
</code></pre>


<h3>Value</h3>

<p>No value. Will launch <code>shiny</code> app in default web browser.
</p>

<hr>
<h2 id='mm_FillMissing'>Impute Missing Data</h2><span id='topic+mm_FillMissing'></span>

<h3>Description</h3>

<p>Fill in a ragged away by nearest neighbor imputation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_FillMissing(A, knn = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_FillMissing_+3A_a">A</code></td>
<td>
<p>A ragged array (IE, contains missing cells), presumably constructed with <code><a href="#topic+mm_ArrayData">mm_ArrayData</a></code>.</p>
</td></tr>
<tr><td><code id="mm_FillMissing_+3A_knn">knn</code></td>
<td>
<p>Number of nearest neighbors to draw on for imputation (default = 3).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an array of the same dimensions with all missing data filled.
</p>

<hr>
<h2 id='mm_FlattenArray'>Flatten Array</h2><span id='topic+mm_FlattenArray'></span>

<h3>Description</h3>

<p>Convert a 3D array to 2D matrix suitable for PCA, etc. Note, this function is identical to geomorph::two.d.array, reproduced here for convenience.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_FlattenArray(A, sep = ".")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_FlattenArray_+3A_a">A</code></td>
<td>
<p>an array to be flattened</p>
</td></tr>
<tr><td><code id="mm_FlattenArray_+3A_sep">sep</code></td>
<td>
<p>Separator to be used for column names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a flattened array
</p>

<hr>
<h2 id='mm_get_interval'>Create equallly spaced intervals.</h2><span id='topic+mm_get_interval'></span>

<h3>Description</h3>

<p>Create a sequence from -1:1 of specified length. MIDpoint (day0) can be
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_get_interval(days, day0 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_get_interval_+3A_days">days</code></td>
<td>
<p>The length of the sequence to return, inclusive of the endpoints (-1,1)</p>
</td></tr>
<tr><td><code id="mm_get_interval_+3A_day0">day0</code></td>
<td>
<p>If NULL (default), the median integer will be calculated, centering the range on 0. Specifying a value will set 0 to that value, creating asymmetric ranges.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric vector of specified length, ranging from -1 to 1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_get_interval(15) ## Symmetrical sequence from -1 to 1 with 0 in the middle.
mm_get_interval(15, day0 = 8) ## The same sequence, explicitly specifying the midpoint
mm_get_interval(15, day0 = 3) ## 15 divisions with an asymmetric distribution.

</code></pre>

<hr>
<h2 id='mm_grp_dists'>Distance from Centroid</h2><span id='topic+mm_grp_dists'></span>

<h3>Description</h3>

<p>Calculate and plot group distance from centroid (grand mean)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_grp_dists(dat, grps, plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_grp_dists_+3A_dat">dat</code></td>
<td>
<p>a 2d matrix of data. Presumably PC scores</p>
</td></tr>
<tr><td><code id="mm_grp_dists_+3A_grps">grps</code></td>
<td>
<p>a vector defining group IDs</p>
</td></tr>
<tr><td><code id="mm_grp_dists_+3A_plots">plots</code></td>
<td>
<p>Logical. Should distances be plotted as boxplots? If FALSE, distance calculations are still performed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing individual distances from the sample mean shape. If
<code>plots=TRUE</code>, will also visualize results
</p>

<hr>
<h2 id='mm_grps_PlotArray'>Plot Arrays of groups</h2><span id='topic+mm_grps_PlotArray'></span>

<h3>Description</h3>

<p>Attempts to optimally format a grid of arrays by group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_grps_PlotArray(A, grps, reset_par = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_grps_PlotArray_+3A_a">A</code></td>
<td>
<p>an array to be plotted</p>
</td></tr>
<tr><td><code id="mm_grps_PlotArray_+3A_grps">grps</code></td>
<td>
<p>a vector defining group IDs to subset along the 3rd dimension of
the array</p>
</td></tr>
<tr><td><code id="mm_grps_PlotArray_+3A_reset_par">reset_par</code></td>
<td>
<p>Optional, default = TRUE. If false, do not reset graphic
parameters in order to create complex plots.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>4 Groups will plot as a 2x2 grid, while 9 groups plot in a 3x3.
Function is experimental
</p>


<h3>Value</h3>

<p>Returns no values, produces a series of plots.
</p>

<hr>
<h2 id='mm_mute_cols'>Take a color and modify it</h2><span id='topic+mm_mute_cols'></span>

<h3>Description</h3>

<p>Modify color/transparency using hsv syntax
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_mute_cols(cols, s = NULL, v = NULL, alpha = 0.4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_mute_cols_+3A_cols">cols</code></td>
<td>
<p>a vector of colors, eg: &quot;#0066FF&quot;</p>
</td></tr>
<tr><td><code id="mm_mute_cols_+3A_s">s</code></td>
<td>
<p>Either a single value or a vector of same length as cols specifying
a new saturation (range 0-1). colors darken to black (0).</p>
</td></tr>
<tr><td><code id="mm_mute_cols_+3A_v">v</code></td>
<td>
<p>Either a single value or a vector of same length as cols specifying
a new value (range 0-1). colors lighten to white (0)</p>
</td></tr>
<tr><td><code id="mm_mute_cols_+3A_alpha">alpha</code></td>
<td>
<p>Either a single value or a vector of same length as cols
specifying a transparency value (range 0-1). colors translucent at 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of colors that have been modified in saturation, value, or
alpha
</p>

<hr>
<h2 id='mm_Phenotype'>Generate Phenotypes</h2><span id='topic+mm_Phenotype'></span>

<h3>Description</h3>

<p>Partition sample into clusters, based on information from
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_Phenotype(dat, kgrps, cuttree_h = NULL, cuttree_k = NULL, plot_figs = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_Phenotype_+3A_dat">dat</code></td>
<td>
<p>Either an Array of shape data, an mmPCA object, or an mmDiag object.</p>
</td></tr>
<tr><td><code id="mm_Phenotype_+3A_kgrps">kgrps</code></td>
<td>
<p>A non-negative integer of sub-groups to draw. kgrps=1 will provide results for the whole input dat.</p>
</td></tr>
<tr><td><code id="mm_Phenotype_+3A_cuttree_h">cuttree_h</code></td>
<td>
<p>Optional. Draw clusters by splitting the tree at a given
height, h.</p>
</td></tr>
<tr><td><code id="mm_Phenotype_+3A_cuttree_k">cuttree_k</code></td>
<td>
<p>Optional. Draw clsuters by splitting the tree into number of branches, k</p>
</td></tr>
<tr><td><code id="mm_Phenotype_+3A_plot_figs">plot_figs</code></td>
<td>
<p>Optional. Default = TRUE, plot phenotypes for each set(s) of subgroups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If plot_figs=TRUE (Default), plot associated graphs and return a list containing:
</p>

<ul>
<li><p>  ALN - an array containing aligned and scaled landmark data, the
output of <a href="#topic+mm_ArrayData">mm_ArrayData</a>
</p>
</li>
<li><p> PCA - PC scores, eigenvalues, and shape visualizations, the output of
<a href="#topic+mm_CalcShapespace">mm_CalcShapespace</a>
</p>
</li>
<li><p> TREE - Dendrogram of PC scores, the output of
<a href="#topic+mm_Diagnostics">mm_Diagnostics</a>
</p>
</li>
<li><p> k_grps - If <code>kgrps</code> is specified, a vector defining group membership
(as integer); the results of k-means clustering based on PC scores.
</p>
</li>
<li><p> cth_grps - If <code>cth_grps</code> is specified, a vector defining group
membership (as integer); the results of clustering using
<a href="stats.html#topic+cutree">stats::cutree</a> for a given height.
</p>
</li>
<li><p> ctk_grps - If <code>ctk_grps</code> is specified, a vector defining group
membership (as integer); the results of clustering using
<a href="stats.html#topic+cutree">stats::cutree</a> for a given number of clusters.
</p>
</li></ul>


<hr>
<h2 id='mm_PlotArray'>Plot Array
Plot individuals and optionally mean form</h2><span id='topic+mm_PlotArray'></span>

<h3>Description</h3>

<p>Plot Array
Plot individuals and optionally mean form
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_PlotArray(
  A,
  MeanShape = TRUE,
  AllCols = NULL,
  MeanCol = NULL,
  plot_type = c("lines", "points"),
  lbl = NULL,
  yr = NULL,
  axis_labels = FALSE,
  reset_par = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_PlotArray_+3A_a">A</code></td>
<td>
<p>An array to be plotted</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_meanshape">MeanShape</code></td>
<td>
<p>Logical. Should the Mean Shape be calculated and plotted</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_allcols">AllCols</code></td>
<td>
<p>Either a single color for all individuals, or a vector
specifying colors for each individual. If NULL (default) individuals will be plotted in grey</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_meancol">MeanCol</code></td>
<td>
<p>A single color for the mean shape. If Null (default) mean shape
will be plotted in black</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_plot_type">plot_type</code></td>
<td>
<p>Should the data be plotted as points or lines.</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_lbl">lbl</code></td>
<td>
<p>A title (main =) for the plot. If NULL (default) the name of the
array will be used.</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_yr">yr</code></td>
<td>
<p>Y-range, in the form c(0,100)</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_axis_labels">axis_labels</code></td>
<td>
<p>Should units be printed along the axis. Defaults to FALSE
to maximize the profile shape.</p>
</td></tr>
<tr><td><code id="mm_PlotArray_+3A_reset_par">reset_par</code></td>
<td>
<p>Optional, default = TRUE. If false, do not reset graphic
parameters in order to create complex plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot individual(s) profile(s) in the default graphics device.
</p>

<hr>
<h2 id='mm_pretty_pca'>Plot Calendar Days</h2><span id='topic+mm_pretty_pca'></span>

<h3>Description</h3>

<p>Pretty PCA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_pretty_pca(PCA, xPC = 1, yPC = 2, clas_col = NULL, legend_cex = 0.8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_pretty_pca_+3A_pca">PCA</code></td>
<td>
<p>Input data either prcomp or mmPCA.</p>
</td></tr>
<tr><td><code id="mm_pretty_pca_+3A_xpc">xPC</code></td>
<td>
<p>The PC to plot on the x axis</p>
</td></tr>
<tr><td><code id="mm_pretty_pca_+3A_ypc">yPC</code></td>
<td>
<p>The PC to plot on the y axis</p>
</td></tr>
<tr><td><code id="mm_pretty_pca_+3A_clas_col">clas_col</code></td>
<td>
<p>A character vector of groupings. Each level will be plotted as a different color.</p>
</td></tr>
<tr><td><code id="mm_pretty_pca_+3A_legend_cex">legend_cex</code></td>
<td>
<p>A scaling factor to be applied specifically to the legend. Set to NULL for scatterplot only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A better PCA plot
</p>


<h3>Value</h3>

<p>Returns no object, plots results of PCA
</p>

<hr>
<h2 id='mm_ScreePlot'>Scree Plot</h2><span id='topic+mm_ScreePlot'></span>

<h3>Description</h3>

<p>Plot total within group sum of squares to evalaute clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_ScreePlot(x, maxC = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_ScreePlot_+3A_x">x</code></td>
<td>
<p>Input data for cluster analysis (IE, PCA)</p>
</td></tr>
<tr><td><code id="mm_ScreePlot_+3A_maxc">maxC</code></td>
<td>
<p>Maximum clusters to evaluate</p>
</td></tr>
<tr><td><code id="mm_ScreePlot_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value, produces diagnostic plot.
</p>

<hr>
<h2 id='mm_SilPlot'>Silhouette Width Plot</h2><span id='topic+mm_SilPlot'></span>

<h3>Description</h3>

<p>Plot average silhouete widths to evaluate clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_SilPlot(x, maxC = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_SilPlot_+3A_x">x</code></td>
<td>
<p>Input data for cluster analysis (IE PCA)</p>
</td></tr>
<tr><td><code id="mm_SilPlot_+3A_maxc">maxC</code></td>
<td>
<p>Maximum clusters to evaluate</p>
</td></tr>
<tr><td><code id="mm_SilPlot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value, produces diagnostic plot.
</p>

<hr>
<h2 id='mm_transf_geom'>Geometric Scaling</h2><span id='topic+mm_transf_geom'></span>

<h3>Description</h3>

<p>Calculate the geometric mean of a vector and scale all values by it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_transf_geom(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_transf_geom_+3A_x">x</code></td>
<td>
<p>A numeric vector to be scaled. Missing values will produce NA, conduct knn imputation using mm_FillMissing first.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scaled vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_transf_geom(1:10)
</code></pre>

<hr>
<h2 id='mm_transf_log'>natural log transform</h2><span id='topic+mm_transf_log'></span>

<h3>Description</h3>

<p>Transform a vector by the natural log.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_transf_log(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_transf_log_+3A_x">x</code></td>
<td>
<p>A numeric vector to be scaled. Missing values will produce NA, conduct knn imputation using mm_FillMissing first.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scaled vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_transf_log(1:10)
</code></pre>

<hr>
<h2 id='mm_transf_log10'>Common log transform</h2><span id='topic+mm_transf_log10'></span>

<h3>Description</h3>

<p>Transform a vector by the common log (base 10).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_transf_log10(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_transf_log10_+3A_x">x</code></td>
<td>
<p>A numeric vector to be scaled. Missing values will produce NA, conduct knn imputation using mm_FillMissing first.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scaled vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_transf_log10(1:10)
</code></pre>

<hr>
<h2 id='mm_transf_minmax'>Min-Max Scaling</h2><span id='topic+mm_transf_minmax'></span>

<h3>Description</h3>

<p>Scale a vector from 0,1 based on its minimum and maximum values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_transf_minmax(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_transf_minmax_+3A_x">x</code></td>
<td>
<p>A Numeric vector to be scaled. Missing values are allowed and ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scaled vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_transf_minmax(1:10)
</code></pre>

<hr>
<h2 id='mm_transf_zscore'>Z scores</h2><span id='topic+mm_transf_zscore'></span>

<h3>Description</h3>

<p>Calculate and return z-scores given a numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_transf_zscore(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_transf_zscore_+3A_x">x</code></td>
<td>
<p>A numeric vector to be scaled. Missing values will produce NA, conduct knn imputation using mm_FillMissing first.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a scaled vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mm_transf_zscore(1:10)
</code></pre>

<hr>
<h2 id='mm_VizModel'>Visualize Multivariate LM</h2><span id='topic+mm_VizModel'></span>

<h3>Description</h3>

<p>Visualize 2D scatterplot of mvlm including predicted shapes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_VizModel(dat, clas_col = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_VizModel_+3A_dat">dat</code></td>
<td>
<p>Input mvlm, created by <a href="#topic+mm_BuildModel">mm_BuildModel</a> (or by using
<a href="geomorph.html#topic+procD.lm">geomorph::procD.lm</a>)</p>
</td></tr>
<tr><td><code id="mm_VizModel_+3A_clas_col">clas_col</code></td>
<td>
<p>A classifier to color the data by. If null (default) all
points will be grey. Otherwise, data will be plotted as rainbow(n) colors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the results of the mvlm, visualizations of shape
trends along the regression line, and the model itself.
</p>

<hr>
<h2 id='mm_VizShapespace'>Visualize PC axes</h2><span id='topic+mm_VizShapespace'></span>

<h3>Description</h3>

<p>Plot a scatterplot and vizualize shape change across the X axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mm_VizShapespace(
  mmPCA,
  xPC = 1,
  yPC = 2,
  yr = c(0, 1.1),
  cols = NULL,
  title = "",
  png_dir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mm_VizShapespace_+3A_mmpca">mmPCA</code></td>
<td>
<p>Output of <code>mm_CalcShapespace</code>, containing a PCA object with
PC shapes</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_xpc">xPC</code></td>
<td>
<p>The PC to be plotted on the x axis. If yPC is left null, a
univariate density distribution will be plotted with min/max shapes.</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_ypc">yPC</code></td>
<td>
<p>The PC to be plotted on the y axis.</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_yr">yr</code></td>
<td>
<p>The y-xis range, in the format c(0,1)</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_cols">cols</code></td>
<td>
<p>A vector of colors of length n, for use in scatterplot.</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_title">title</code></td>
<td>
<p>To be used for the plot</p>
</td></tr>
<tr><td><code id="mm_VizShapespace_+3A_png_dir">png_dir</code></td>
<td>
<p>A file path to a directory in which to save out PNG figures.
Names will be automatically assigned based on input PC(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Meant to be a quick diagnostic plot with minimal customization.
</p>


<h3>Value</h3>

<p>Produces a series of plots to visualize PCA analysis. If <code>png_dir</code> is
specified, function will save out <code>.png</code> files. Otherwise plots will be
displayed in the default plot window.
</p>

<hr>
<h2 id='moRphomenses'>Geometric Morphometric Analysis of Hormone Cycle Phenotypes</h2><span id='topic+moRphomenses'></span><span id='topic+moRphomenses_PACKAGE'></span>

<h3>Description</h3>

<p>Analyze shapes/phenotypes of hormone data using Geometric Morphometric inspired methods.
</p>


<h3>Author(s)</h3>

<p>Daniel E. Ehrlich
</p>

<hr>
<h2 id='print_summary'>Print basic summary</h2><span id='topic+print_summary'></span>

<h3>Description</h3>

<p>Print basic summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_summary(aln, grps = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_summary_+3A_aln">aln</code></td>
<td>
<p>An object created with mm_ArrayData</p>
</td></tr>
<tr><td><code id="print_summary_+3A_grps">grps</code></td>
<td>
<p>(Optional) A numeric vector that defines groupings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with basic descriptive information, to be used with
<code><a href="base.html#topic+print">print()</a></code>. If <code>grps=TRUE</code>, will return a list of character vectors.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
