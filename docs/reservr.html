<!DOCTYPE html><html lang="en"><head><title>Help for package reservr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {reservr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_params'><p>Convert TensorFlow tensors to distribution parameters recursively</p></a></li>
<li><a href='#blended_transition'><p>Transition functions for blended distributions</p></a></li>
<li><a href='#callback_adaptive_lr'><p>Keras Callback for adaptive learning rate with weight restoration</p></a></li>
<li><a href='#callback_debug_dist_gradients'><p>Callback to monitor likelihood gradient components</p></a></li>
<li><a href='#dist_bdegp'><p>Construct a BDEGP-Family</p></a></li>
<li><a href='#dist_beta'><p>Beta Distribution</p></a></li>
<li><a href='#dist_binomial'><p>Binomial Distribution</p></a></li>
<li><a href='#dist_blended'><p>Blended distribution</p></a></li>
<li><a href='#dist_dirac'><p>Dirac (degenerate point) Distribution</p></a></li>
<li><a href='#dist_discrete'><p>Discrete Distribution</p></a></li>
<li><a href='#dist_empirical'><p>Empirical distribution</p></a></li>
<li><a href='#dist_erlangmix'><p>Erlang Mixture distribution</p></a></li>
<li><a href='#dist_exponential'><p>Exponential distribution</p></a></li>
<li><a href='#dist_gamma'><p>Gamma distribution</p></a></li>
<li><a href='#dist_genpareto'><p>Generalized Pareto Distribution</p></a></li>
<li><a href='#dist_lognormal'><p>Log Normal distribution</p></a></li>
<li><a href='#dist_mixture'><p>Mixture distribution</p></a></li>
<li><a href='#dist_negbinomial'><p>Negative binomial Distribution</p></a></li>
<li><a href='#dist_normal'><p>Normal distribution</p></a></li>
<li><a href='#dist_pareto'><p>Pareto Distribution</p></a></li>
<li><a href='#dist_poisson'><p>Poisson Distribution</p></a></li>
<li><a href='#dist_translate'><p>Tranlsated distribution</p></a></li>
<li><a href='#dist_trunc'><p>Truncated distribution</p></a></li>
<li><a href='#dist_uniform'><p>Uniform distribution</p></a></li>
<li><a href='#dist_weibull'><p>Weibull Distribution</p></a></li>
<li><a href='#Distribution'><p>Base class for Distributions</p></a></li>
<li><a href='#fit_blended'><p>Fit a Blended mixture using an ECME-Algorithm</p></a></li>
<li><a href='#fit_dist'><p>Fit a general distribution to observations</p></a></li>
<li><a href='#fit_dist_start.MixtureDistribution'><p>Find starting values for distribution parameters</p></a></li>
<li><a href='#fit_erlang_mixture'><p>Fit an Erlang mixture using an ECME-Algorithm</p></a></li>
<li><a href='#fit_mixture'><p>Fit a generic mixture using an ECME-Algorithm</p></a></li>
<li><a href='#fit.reservr_keras_model'><p>Fit a neural network based distribution model to data</p></a></li>
<li><a href='#flatten_params'><p>Flatten / Inflate parameter lists / vectors</p></a></li>
<li><a href='#GenPareto'><p>The Generalized Pareto Distribution (GPD)</p></a></li>
<li><a href='#integrate_gk'><p>Adaptive Gauss-Kronrod Quadrature for multiple limits</p></a></li>
<li><a href='#interval'><p>Intervals</p></a></li>
<li><a href='#interval-operations'><p>Convex union and intersection of intervals</p></a></li>
<li><a href='#is.Distribution'><p>Test if object is a Distribution</p></a></li>
<li><a href='#k_matrix'><p>Cast to a TensorFlow matrix</p></a></li>
<li><a href='#Pareto'><p>The Pareto Distribution</p></a></li>
<li><a href='#plot_distributions'><p>Plot several distributions</p></a></li>
<li><a href='#predict.reservr_keras_model'><p>Predict individual distribution parameters</p></a></li>
<li><a href='#prob_report'><p>Determine probability of reporting under a Poisson arrival Process</p></a></li>
<li><a href='#quantile.Distribution'><p>Quantiles of Distributions</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#softmax'><p>Soft-Max function</p></a></li>
<li><a href='#tf_compile_model'><p>Compile a Keras model for truncated data under dist</p></a></li>
<li><a href='#tf_initialise_model'><p>Initialise model weights to a global parameter fit</p></a></li>
<li><a href='#trunc_obs'><p>Define a set of truncated observations</p></a></li>
<li><a href='#truncate_claims'><p>Truncate claims data subject to reporting delay</p></a></li>
<li><a href='#weighted_moments'><p>Compute weighted moments</p></a></li>
<li><a href='#weighted_quantile'><p>Compute weighted quantiles</p></a></li>
<li><a href='#weighted_tabulate'><p>Compute weighted tabulations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fit Distributions and Neural Networks to Censored and Truncated
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Define distribution families and fit them to
    interval-censored and interval-truncated data, where the truncation
    bounds may depend on the individual observation. The defined
    distributions feature density, probability, sampling and fitting
    methods as well as efficient implementations of the log-density log
    f(x) and log-probability log P(x0 &lt;= X &lt;= x1) for use in 'TensorFlow'
    neural networks via the 'tensorflow' package. Allows training
    parametric neural networks on interval-censored and interval-truncated
    data with flexible parameterization. Applications include Claims
    Development in Non-Life Insurance, e.g. modelling reporting delay
    distributions from incomplete data, see BÃ¼cher, Rosenstock (2022)
    &lt;<a href="https://doi.org/10.1007%2Fs13385-022-00314-4">doi:10.1007/s13385-022-00314-4</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AshesITR/reservr/issues">https://github.com/AshesITR/reservr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat (&ge; 0.2.1), generics, glue (&ge; 1.3.1), keras3,
matrixStats, nloptr, numDeriv, purrr (&ge; 0.3.3), R6 (&ge; 2.4.1),
Rcpp, RcppParallel, rlang (&ge; 0.4.5), stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, callr, colorspace, data.table, dplyr (&ge; 0.8.4), evmix,
fitdistrplus (&ge; 1.0.14), flextable (&ge; 0.5.8), formattable (&ge;
0.2.0.1), furrr (&ge; 0.1.0), ggplot2 (&ge; 3.2.1), ggridges (&ge;
0.5.2), knitr (&ge; 1.28), logKDE (&ge; 0.3.2), officer (&ge; 0.3.7),
patchwork (&ge; 1.0.0), reticulate, rmarkdown (&ge; 2.1),
rstudioapi, tensorflow (&ge; 2.0.0), testthat (&ge; 2.1.0), tidyr
(&ge; 1.0.2), tibble, bench, survival, rticles, bookdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp, RcppArmadillo, RcppParallel</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'fit_util.R' 'distribution_class.R' 'zzz.R'
'interval.R' 'aaa.R' 'blended_transition.R'
'callback_adaptive_lr.R' 'callback_debug_dist_gradients.R'
'check_lengths.R' 'compiler.R' 'dist_bdegp.R' 'dist_beta.R'
'dist_binomial.R' 'fit_blended.R' 'dist_blended.R'
'dist_dirac.R' 'dist_discrete.R' 'dist_empirical.R'
'fit_erlang_mixture.R' 'dist_erlangmix.R' 'dist_exponential.R'
'dist_gamma.R' 'gpd.R' 'dist_genpareto.R' 'dist_lognormal.R'
'fit_mixture.R' 'dist_mixture.R' 'dist_negbinomial.R'
'dist_normal.R' 'pareto.R' 'dist_pareto.R' 'dist_poisson.R'
'dist_translate.R' 'dist_trunc.R' 'dist_uniform.R'
'dist_weibull.R' 'distribution_generics.R'
'distribution_methods.R' 'flatten_params.R' 'integrate.R'
'plot_distributions.R' 'prob_report.R' 'reservr-package.R'
'softmax.R' 'tf_compile.R' 'tf_compile_loss.R' 'tf_constants.R'
'tf_fit.R' 'tf_initialise.R' 'tf_util.R'
'trunc_erlangmix_init.R' 'trunc_obs.R' 'truncate_claims.R'
'weighted_stats.R'</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ashesitr.github.io/reservr/">https://ashesitr.github.io/reservr/</a>,
<a href="https://github.com/AshesITR/reservr">https://github.com/AshesITR/reservr</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-24 10:33:37 UTC; alex</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Rosenstock [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Rosenstock &lt;alexander.rosenstock@web.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-24 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_params'>Convert TensorFlow tensors to distribution parameters recursively</h2><span id='topic+as_params'></span>

<h3>Description</h3>

<p>Convert TensorFlow tensors to distribution parameters recursively
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_params(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_params_+3A_x">x</code></td>
<td>
<p>possibly nested list structure of <code>tensorflow.tensor</code>s</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A nested list of vectors suitable as distribution parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  tf_params &lt;- list(
    probs = k_matrix(t(c(0.5, 0.3, 0.2))),
    shapes = k_matrix(t(c(1L, 2L, 3L)), dtype = "int32"),
    scale = keras3::as_tensor(1.0, keras3::config_floatx())
  )
  params &lt;- as_params(tf_params)
  dist &lt;- dist_erlangmix(vector("list", 3L))
  dist$sample(10L, with_params = params)
}

</code></pre>

<hr>
<h2 id='blended_transition'>Transition functions for blended distributions</h2><span id='topic+blended_transition'></span><span id='topic+blended_transition_inv'></span>

<h3>Description</h3>

<p>Transition functions for blended distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blended_transition(x, u, eps, .gradient = FALSE, .extend_na = FALSE)

blended_transition_inv(x, u, eps, .component)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blended_transition_+3A_x">x</code></td>
<td>
<p>Points to evaluate at</p>
</td></tr>
<tr><td><code id="blended_transition_+3A_u">u</code></td>
<td>
<p>Sorted vector of blending thresholds, or rowwise sorted matrix of blending thresholds</p>
</td></tr>
<tr><td><code id="blended_transition_+3A_eps">eps</code></td>
<td>
<p>Corresponding vector or matrix of blending bandwidths.
Must be positive and the same dimensions as <code>u</code>, or scalar.
No rowwise blending regions (u - eps, u + eps) may overlap.</p>
</td></tr>
<tr><td><code id="blended_transition_+3A_.gradient">.gradient</code></td>
<td>
<p>Also evaluate the gradient with respect to <code>x</code>?</p>
</td></tr>
<tr><td><code id="blended_transition_+3A_.extend_na">.extend_na</code></td>
<td>
<p>Extend out-of range transitions by the last in-range value (i.e. the corresponding u) or by NA?</p>
</td></tr>
<tr><td><code id="blended_transition_+3A_.component">.component</code></td>
<td>
<p>Component index (up to <code>length(u) + 1</code>) to invert.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>blended_transition</code> returns a matrix with <code>length(x)</code> rows and <code>length(u) + 1</code> columns containing the
transformed values for each of the blending components.
If <code>.gradient</code> is TRUE, an attribute <code>"gradient"</code> is attached with the same dimensions, containing the derivative
of the respective transition component with respect to <code>x</code>.
</p>
<p><code>blended_transition_inv</code> returns a vector with <code>length(x)</code> values containing the inverse of the transformed
values for the <code>.component</code>th blending component.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
xx &lt;- seq(from = 0, to = 20, length.out = 101)
blend_mat &lt;- blended_transition(xx, u = 10, eps = 3, .gradient = TRUE)
ggplot(
  data.frame(
    x = rep(xx, 2L),
    fun = rep(c("p", "q"), each = length(xx)),
    y = as.numeric(blend_mat),
    relevant = c(xx &lt;= 13, xx &gt;= 7)
  ),
  aes(x = x, y = y, color = fun, linetype = relevant)
) %+%
  geom_line() %+%
  theme_bw() %+%
  theme(
    legend.position = "bottom", legend.box = "horizontal"
  ) %+%
  guides(color = guide_legend(direction = "horizontal", title = ""), linetype = guide_none()) %+%
  scale_linetype_manual(values = c("TRUE" = 1, "FALSE" = 3))

ggplot(
  data.frame(
    x = rep(xx, 2L),
    fun = rep(c("p'", "q'"), each = length(xx)),
    y = as.numeric(attr(blend_mat, "gradient")),
    relevant = c(xx &lt;= 13, xx &gt;= 7)
  ),
  aes(x = x, y = y, color = fun, linetype = relevant)
) %+%
  geom_line() %+%
  theme_bw() %+%
  theme(
    legend.position = "bottom", legend.box = "horizontal"
  ) %+%
  guides(color = guide_legend(direction = "horizontal", title = ""), linetype = guide_none()) %+%
  scale_linetype_manual(values = c("TRUE" = 1, "FALSE" = 3))

</code></pre>

<hr>
<h2 id='callback_adaptive_lr'>Keras Callback for adaptive learning rate with weight restoration</h2><span id='topic+callback_adaptive_lr'></span>

<h3>Description</h3>

<p>Provides a keras callback similar to <code><a href="keras3.html#topic+callback_reduce_lr_on_plateau">keras3::callback_reduce_lr_on_plateau()</a></code> but which also restores the weights
to the best seen so far whenever a learning rate reduction occurs, and with slightly more restrictive improvement
detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>callback_adaptive_lr(
  monitor = "val_loss",
  factor = 0.1,
  patience = 10L,
  verbose = 0L,
  mode = c("auto", "min", "max"),
  delta_abs = 1e-04,
  delta_rel = 0,
  cooldown = 0L,
  min_lr = 0,
  restore_weights = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="callback_adaptive_lr_+3A_monitor">monitor</code></td>
<td>
<p>quantity to be monitored.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_factor">factor</code></td>
<td>
<p>factor by which the learning rate will be reduced. <code>new_lr = old_lr * factor</code>.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_patience">patience</code></td>
<td>
<p>number of epochs with no significant improvement after which the learning rate will be reduced.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_verbose">verbose</code></td>
<td>
<p>integer. Set to 1 to receive update messages.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_mode">mode</code></td>
<td>
<p>Optimisation mode. &quot;auto&quot; detects the mode from the name of <code>monitor</code>. &quot;min&quot; monitors for decreasing
metrics. &quot;max&quot; monitors for increasing metrics.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_delta_abs">delta_abs</code></td>
<td>
<p>Minimum absolute metric improvement per epoch. The learning rate will be reduced if the average
improvement is less than <code>delta_abs</code> per epoch for <code>patience</code> epochs.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_delta_rel">delta_rel</code></td>
<td>
<p>Minimum relative metric improvement per epoch. The learning rate will be reduced if the average
improvement is less than <code style="white-space: pre;">&#8288;|metric| * delta_rel&#8288;</code> per epoch for <code>patience</code> epochs.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_cooldown">cooldown</code></td>
<td>
<p>number of epochs to wait before resuming normal operation after learning rate has been reduced.
The minimum number of epochs between two learning rate reductions is <code>patience + cooldown</code>.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_min_lr">min_lr</code></td>
<td>
<p>lower bound for the learning rate. If a learning rate reduction would lower the learning rate below
<code>min_lr</code>, it will be clipped at <code>min_lr</code> instead and no further reductions will be performed.</p>
</td></tr>
<tr><td><code id="callback_adaptive_lr_+3A_restore_weights">restore_weights</code></td>
<td>
<p>Bool. If TRUE, the best weights will be restored at each learning rate reduction.
This is very useful if the metric oscillates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that while <code><a href="keras3.html#topic+callback_reduce_lr_on_plateau">keras3::callback_reduce_lr_on_plateau()</a></code> automatically logs the learning rate as a metric 'lr',
this is currently impossible from R.
Thus, if you want to also log the learning rate, you should add <code><a href="keras3.html#topic+callback_reduce_lr_on_plateau">keras3::callback_reduce_lr_on_plateau()</a></code> with a high
<code>min_lr</code> to effectively disable the callback but still monitor the learning rate.
</p>


<h3>Value</h3>

<p>A <code>KerasCallback</code> suitable for passing to <code><a href="keras3.html#topic+reexports">keras3::fit()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
group &lt;- sample(c(0, 1), size = 100, replace = TRUE)
x &lt;- dist$sample(100, with_params = list(rate = group + 1))
global_fit &lt;- fit(dist, x)

if (interactive()) {
  library(keras3)
  l_in &lt;- layer_input(shape = 1L)
  mod &lt;- tf_compile_model(
    inputs = list(l_in),
    intermediate_output = l_in,
    dist = dist,
    optimizer = optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )
  tf_initialise_model(mod, global_fit$params)
  fit_history &lt;- fit(
    mod,
    x = as_tensor(group, config_floatx()),
    y = as_trunc_obs(x),
    epochs = 20L,
    callbacks = list(
      callback_adaptive_lr("loss", factor = 0.5, patience = 2L, verbose = 1L, min_lr = 1.0e-4),
      callback_reduce_lr_on_plateau("loss", min_lr = 1.0) # to track lr
    )
  )

  plot(fit_history)

  predicted_means &lt;- predict(mod, data = as_tensor(c(0, 1), config_floatx()))
}

</code></pre>

<hr>
<h2 id='callback_debug_dist_gradients'>Callback to monitor likelihood gradient components</h2><span id='topic+callback_debug_dist_gradients'></span>

<h3>Description</h3>

<p>Provides a keras callback to monitor the individual components of the
censored and truncated likelihood.
Useful for debugging TensorFlow implementations of Distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>callback_debug_dist_gradients(
  object,
  data,
  obs,
  keep_grads = FALSE,
  stop_on_na = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="callback_debug_dist_gradients_+3A_object">object</code></td>
<td>
<p>A <code>reservr_keras_model</code> created by <code><a href="#topic+tf_compile_model">tf_compile_model()</a></code>.</p>
</td></tr>
<tr><td><code id="callback_debug_dist_gradients_+3A_data">data</code></td>
<td>
<p>Input data for the model.</p>
</td></tr>
<tr><td><code id="callback_debug_dist_gradients_+3A_obs">obs</code></td>
<td>
<p>Observations associated to <code>data</code>.</p>
</td></tr>
<tr><td><code id="callback_debug_dist_gradients_+3A_keep_grads">keep_grads</code></td>
<td>
<p>Log actual gradients? (memory hungry!)</p>
</td></tr>
<tr><td><code id="callback_debug_dist_gradients_+3A_stop_on_na">stop_on_na</code></td>
<td>
<p>Stop if any likelihood component as NaN in its gradients?</p>
</td></tr>
<tr><td><code id="callback_debug_dist_gradients_+3A_verbose">verbose</code></td>
<td>
<p>Print a message if training is halted?
The Message will contain information about which likelihood components have
NaN in their gradients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>KerasCallback</code> suitable for passing to <code><a href="keras3.html#topic+reexports">keras3::fit()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
group &lt;- sample(c(0, 1), size = 100, replace = TRUE)
x &lt;- dist$sample(100, with_params = list(rate = group + 1))
global_fit &lt;- fit(dist, x)

if (interactive()) {
  library(keras3)
  l_in &lt;- layer_input(shape = 1L)
  mod &lt;- tf_compile_model(
    inputs = list(l_in),
    intermediate_output = l_in,
    dist = dist,
    optimizer = optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )
  tf_initialise_model(mod, global_fit$params)
  gradient_tracker &lt;- callback_debug_dist_gradients(
    mod,
    as_tensor(group, config_floatx()),
    x,
    keep_grads = TRUE
  )
  fit_history &lt;- fit(
    mod,
    x = as_tensor(group, config_floatx()),
    y = x,
    epochs = 20L,
    callbacks = list(
      callback_adaptive_lr("loss", factor = 0.5, patience = 2L, verbose = 1L, min_lr = 1.0e-4),
      gradient_tracker,
      callback_reduce_lr_on_plateau("loss", min_lr = 1.0) # to track lr
    )
  )
  gradient_tracker$gradient_logs[[20]]$dens

  plot(fit_history)

  predicted_means &lt;- predict(mod, data = as_tensor(c(0, 1), config_floatx()))
}

</code></pre>

<hr>
<h2 id='dist_bdegp'>Construct a BDEGP-Family</h2><span id='topic+dist_bdegp'></span>

<h3>Description</h3>

<p>Constructs a BDEGP-Family distribution with fixed number of components and
blending interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_bdegp(n, m, u, epsilon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_bdegp_+3A_n">n</code></td>
<td>
<p>Number of dirac components, starting with a point mass at 0.</p>
</td></tr>
<tr><td><code id="dist_bdegp_+3A_m">m</code></td>
<td>
<p>Number of erlang components, translated by <code>n - 0.5</code>.</p>
</td></tr>
<tr><td><code id="dist_bdegp_+3A_u">u</code></td>
<td>
<p>Blending cut-off, must be a positive real.</p>
</td></tr>
<tr><td><code id="dist_bdegp_+3A_epsilon">epsilon</code></td>
<td>
<p>Blending radius, must be a positive real less than <code>u</code>.
The blending interval will be <code style="white-space: pre;">&#8288;u - epsilon &lt; x &lt; u + epsilon&#8288;</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> A <code>MixtureDistribution</code> of
</p>

<ul>
<li> <p><code>n</code> <code>DiracDistribution</code>s at 0 .. n - 1 and
</p>
</li>
<li><p> a <code>BlendedDistribution</code> object with child Distributions
</p>

<ul>
<li><p> a <code>TranslatedDistribution</code> with offset <code>n - 0.5</code> of an <code>ErlangMixtureDistribution</code> with <code>m</code> shapes
</p>
</li>
<li><p> and a <code>GeneralizedParetoDistribution</code> with shape parameter restricted to [0, 1] and location parameter fixed
at <code>u</code>
With break <code>u</code> and bandwidth <code>epsilon</code>.
</p>
</li></ul>

</li></ul>

</li></ul>



<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_bdegp(n = 1, m = 2, u = 10, epsilon = 3)
params &lt;- list(
  dists = list(
    list(),
    list(
      dists = list(
        list(
          dist = list(
            shapes = list(1L, 2L),
            scale = 1.0,
            probs = list(0.7, 0.3)
          )
        ),
        list(
          sigmau = 1.0,
          xi = 0.1
        )
      ),
      probs = list(0.1, 0.9)
    )
  ),
  probs = list(0.95, 0.05)
)
x &lt;- dist$sample(100, with_params = params)

plot_distributions(
  theoretical = dist,
  empirical = dist_empirical(x),
  .x = seq(0, 20, length.out = 101),
  with_params = list(theoretical = params)
)

</code></pre>

<hr>
<h2 id='dist_beta'>Beta Distribution</h2><span id='topic+dist_beta'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Beta">stats::Beta</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_beta(shape1 = NULL, shape2 = NULL, ncp = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_beta_+3A_shape1">shape1</code></td>
<td>
<p>First scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_beta_+3A_shape2">shape2</code></td>
<td>
<p>Second scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_beta_+3A_ncp">ncp</code></td>
<td>
<p>Scalar non-centrality parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All parameters can be overridden with
<code>with_params = list(shape = ..., scale = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>BetaDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_beta &lt;- dist_beta(shape1 = 2, shape2 = 2, ncp = 0)
x &lt;- d_beta$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_beta,
  estimated = d_beta,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "beta")$estimate
    )
  ),
  .x = seq(0, 2, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_binomial'>Binomial Distribution</h2><span id='topic+dist_binomial'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Binomial">stats::Binomial</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_binomial(size = NULL, prob = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_binomial_+3A_size">size</code></td>
<td>
<p>Number of trials parameter (integer), or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_binomial_+3A_prob">prob</code></td>
<td>
<p>Success probability parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(size = ..., prob = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>BinomialDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_binom &lt;- dist_binomial(size = 10, prob = 0.5)
x &lt;- d_binom$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_binom,
  estimated = d_binom,
  with_params = list(
    estimated = list(
      size = max(x),
      prob = mean(x) / max(x)
    )
  ),
  .x = 0:max(x)
)

</code></pre>

<hr>
<h2 id='dist_blended'>Blended distribution</h2><span id='topic+dist_blended'></span>

<h3>Description</h3>

<p>Blended distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_blended(dists, probs = NULL, breaks = NULL, bandwidths = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_blended_+3A_dists">dists</code></td>
<td>
<p>A list of k &gt;= 2 component Distributions.</p>
</td></tr>
<tr><td><code id="dist_blended_+3A_probs">probs</code></td>
<td>
<p>k Mixture weight parameters</p>
</td></tr>
<tr><td><code id="dist_blended_+3A_breaks">breaks</code></td>
<td>
<p>k - 1 Centers of the blending zones.
<code>dists[i]</code> will blend into <code>dists[i + 1]</code> around <code>breaks[i]</code>.</p>
</td></tr>
<tr><td><code id="dist_blended_+3A_bandwidths">bandwidths</code></td>
<td>
<p>k - 1 Radii of the blending zones.
The i-th blending zone will begin at <code>breaks[i] - bandwidths[i]</code> and end at
<code>breaks[i] + bandwidths[i]</code>. A bandwidth of 0 corresponds to a hard cut-off,
i.e. a jump discontinuity in the density of the blended Distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>BlendedDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bd &lt;- dist_blended(
  list(
    dist_normal(mean = 0.0, sd = 1.0),
    dist_genpareto(u = 3.0, sigmau = 1.0, xi = 3.0)
  ),
  breaks = list(3.0),
  bandwidths = list(0.5),
  probs = list(0.9, 0.1)
)

plot_distributions(
  bd,
  .x = seq(-3, 10, length.out = 100),
  plots = c("d", "p")
)

</code></pre>

<hr>
<h2 id='dist_dirac'>Dirac (degenerate point) Distribution</h2><span id='topic+dist_dirac'></span>

<h3>Description</h3>

<p>A degenerate distribution with all mass at a single point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_dirac(point = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_dirac_+3A_point">point</code></td>
<td>
<p>The point with probability mass 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter can be overridden with
<code>with_params = list(point = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>DiracDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_dirac &lt;- dist_dirac(1.5)
d_dirac$sample(2L)
d_dirac$sample(2L, list(point = 42.0))

</code></pre>

<hr>
<h2 id='dist_discrete'>Discrete Distribution</h2><span id='topic+dist_discrete'></span>

<h3>Description</h3>

<p>A full-flexibility discrete distribution with values from 1 to <code>size</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_discrete(size = NULL, probs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_discrete_+3A_size">size</code></td>
<td>
<p>Number of classes parameter (integer). Required if <code>probs</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="dist_discrete_+3A_probs">probs</code></td>
<td>
<p>Vector of probabilties parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters can be overridden with
<code>with_params = list(probs = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>DiscreteDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_discrete &lt;- dist_discrete(probs = list(0.5, 0.25, 0.15, 0.1))
x &lt;- d_discrete$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_discrete,
  estimated = d_discrete,
  with_params = list(
    estimated = list(
      size = max(x),
      probs = as.list(unname(table(x)) / 100)
    )
  ),
  .x = 0:max(x)
)

</code></pre>

<hr>
<h2 id='dist_empirical'>Empirical distribution</h2><span id='topic+dist_empirical'></span>

<h3>Description</h3>

<p>Creates an empirical distribution object from a sample.
Assumes iid. samples. <code>with_params</code> should <strong>not</strong> be used with this
distribution because estimation of the relevant indicators happens during
construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_empirical(sample, positive = FALSE, bw = "nrd0")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_empirical_+3A_sample">sample</code></td>
<td>
<p>Sample to build the empirical distribution from</p>
</td></tr>
<tr><td><code id="dist_empirical_+3A_positive">positive</code></td>
<td>
<p>Is the underlying distribution known to be positive?
This will effect the density estimation procedure.
<code>positive = FALSE</code> uses a kernel density estimate produced by <code><a href="stats.html#topic+density">density()</a></code>,
<code>positive = TRUE</code> uses a log-kernel density estimate produced by
<code><a href="logKDE.html#topic+logdensity_fft">logKDE::logdensity_fft()</a></code>. The latter can improve density estimation near
zero.</p>
</td></tr>
<tr><td><code id="dist_empirical_+3A_bw">bw</code></td>
<td>
<p>Bandwidth parameter for density estimation. Passed to the density
estimation function selected by <code>positive</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>sample()</code> samples iid. from <code>sample</code>. This approach is similar to
bootstrapping.
</p>
</li>
<li> <p><code>density()</code> evaluates a kernel density estimate, approximating with zero
outside of the known support. This estimate is either obtained using
<a href="stats.html#topic+density">stats::density</a> or <a href="logKDE.html#topic+logdensity_fft">logKDE::logdensity_fft</a>, depending on <code>positive</code>.
</p>
</li>
<li> <p><code>probability()</code> evaluates the empirical cumulative density function
obtained by <a href="stats.html#topic+ecdf">stats::ecdf</a>.
</p>
</li>
<li> <p><code>quantile()</code> evaluates the empirical quantiles using <a href="stats.html#topic+quantile">stats::quantile</a>
</p>
</li>
<li> <p><code>hazard()</code> estimates the hazard rate using the density estimate and the
empirical cumulative density function: <code>h(t) = df(t) / (1 - cdf(t))</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An <code>EmpiricalDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rexp(20, rate = 1)
dx &lt;- dist_empirical(sample = x, positive = TRUE)

y &lt;- rnorm(20)
dy &lt;- dist_empirical(sample = y)

plot_distributions(
  exponential = dx,
  normal = dy,
  .x = seq(-3, 3, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_erlangmix'>Erlang Mixture distribution</h2><span id='topic+dist_erlangmix'></span>

<h3>Description</h3>

<p>Erlang Mixture distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_erlangmix(shapes, scale = NULL, probs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_erlangmix_+3A_shapes">shapes</code></td>
<td>
<p>Shape parameters, a trunc_erlangmix fit, or <code>NULL</code> as a
placeholder.</p>
</td></tr>
<tr><td><code id="dist_erlangmix_+3A_scale">scale</code></td>
<td>
<p>Common scale parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_erlangmix_+3A_probs">probs</code></td>
<td>
<p>Mixing probabilities, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>ErlangMixtureDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>params &lt;- list(scale = 1.0, probs = list(0.5, 0.3, 0.2), shapes = list(1L, 2L, 3L))
dist &lt;- dist_erlangmix(vector("list", 3L))
x &lt;- dist$sample(20, with_params = params)
d_emp &lt;- dist_empirical(x, positive = TRUE)

plot_distributions(
  empirical = d_emp,
  theoretical = dist,
  with_params = list(
    theoretical = params
  ),
  .x = seq(1e-4, 5, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_exponential'>Exponential distribution</h2><span id='topic+dist_exponential'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Exponential">stats::Exponential</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_exponential(rate = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_exponential_+3A_rate">rate</code></td>
<td>
<p>Scalar rate parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter can be overridden with <code>with_params = list(rate = ...)</code>.
</p>


<h3>Value</h3>

<p>An <code>ExponentialDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rate &lt;- 1
d_exp &lt;- dist_exponential()
x &lt;- d_exp$sample(20, with_params = list(rate = rate))
d_emp &lt;- dist_empirical(x, positive = TRUE)

plot_distributions(
  empirical = d_emp,
  theoretical = d_exp,
  estimated = d_exp,
  with_params = list(
    theoretical = list(rate = rate),
    estimated = list(rate = 1 / mean(x))
  ),
  .x = seq(1e-4, 5, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_gamma'>Gamma distribution</h2><span id='topic+dist_gamma'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+GammaDist">stats::GammaDist</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_gamma(shape = NULL, rate = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_gamma_+3A_shape">shape</code></td>
<td>
<p>Scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_gamma_+3A_rate">rate</code></td>
<td>
<p>Scalar rate parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(shape = ..., rate = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>GammaDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 2
beta &lt;- 2

d_gamma &lt;- dist_gamma(shape = alpha, rate = beta)
x &lt;- d_gamma$sample(100)
d_emp &lt;- dist_empirical(x, positive = TRUE)

plot_distributions(
  empirical = d_emp,
  theoretical = d_gamma,
  estimated = d_gamma,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "gamma")$estimate
    )
  ),
  .x = seq(1e-3, max(x), length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_genpareto'>Generalized Pareto Distribution</h2><span id='topic+dist_genpareto'></span><span id='topic+dist_genpareto1'></span>

<h3>Description</h3>

<p>See <a href="evmix.html#topic+gpd">evmix::gpd</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_genpareto(u = NULL, sigmau = NULL, xi = NULL)

dist_genpareto1(u = NULL, sigmau = NULL, xi = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_genpareto_+3A_u">u</code></td>
<td>
<p>Scalar location parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_genpareto_+3A_sigmau">sigmau</code></td>
<td>
<p>Scalar scale parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_genpareto_+3A_xi">xi</code></td>
<td>
<p>Scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All parameters can be overridden with
<code>with_params = list(u = ..., sigmau = ..., xi = ...)</code>.
</p>
<p><code>dist_genpareto1</code> is equivalent to <code>dist_genpareto</code> but enforces
bound constraints on <code>xi</code> to <code style="white-space: pre;">&#8288;[0, 1]&#8288;</code>.
This ensures unboundedness and finite expected value unless <code>xi == 1.0</code>.
</p>


<h3>Value</h3>

<p>A <code>GeneralizedParetoDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_genpareto &lt;- dist_genpareto(u = 0, sigmau = 1, xi = 1)
x &lt;- d_genpareto$sample(100)
d_emp &lt;- dist_empirical(x)

d_genpareto$export_functions("gpd") # so fitdistrplus finds it

plot_distributions(
  empirical = d_emp,
  theoretical = d_genpareto,
  estimated = d_genpareto,
  with_params = list(
    estimated = fit(dist_genpareto(), x)$params
  ),
  .x = seq(0, 5, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_lognormal'>Log Normal distribution</h2><span id='topic+dist_lognormal'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Lognormal">stats::Lognormal</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_lognormal(meanlog = NULL, sdlog = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_lognormal_+3A_meanlog">meanlog</code></td>
<td>
<p>Scalar mean parameter on the log scale,
or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_lognormal_+3A_sdlog">sdlog</code></td>
<td>
<p>Scalar standard deviation parameter on the log scale,
or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(meanlog = ..., sdlog = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>LognormalDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 0
sigma &lt;- 1

d_lnorm &lt;- dist_lognormal(meanlog = mu, sdlog = sigma)
x &lt;- d_lnorm$sample(20)
d_emp &lt;- dist_empirical(x, positive = TRUE)

plot_distributions(
  empirical = d_emp,
  theoretical = d_lnorm,
  estimated = d_lnorm,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "lnorm")$estimate
    )
  ),
  .x = seq(1e-3, 5, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_mixture'>Mixture distribution</h2><span id='topic+dist_mixture'></span>

<h3>Description</h3>

<p>Parameters of mixing components can be overridden with
<code>with_params = list(dists = list(..., ..., ...))</code>.
#' Mixing probabilites can be overridden with
<code>with_params = list(probs = list(..., ..., ...))</code>.
The <strong>number of components</strong> cannot be overridden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_mixture(dists = list(), probs = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_mixture_+3A_dists">dists</code></td>
<td>
<p>A list of mixing distributions.
May contain placeholders and duplicates.</p>
</td></tr>
<tr><td><code id="dist_mixture_+3A_probs">probs</code></td>
<td>
<p>A list of mixing probabilities with the same length as <code>dists</code>.
They are normalized to sum to one and <code>NULL</code> can be used as a placeholder
within probs.
To reduce the number of required parameters, probs should at least be partly
specified (<code>probs = list(NULL, NULL, ..., 1)</code> with k - 1 <code>NULL</code>s where k is
the number of mixing components).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Does <strong>not</strong> support the <code>quantile()</code> capability!
</p>


<h3>Value</h3>

<p>A <code>MixtureDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A complicated way to define a uniform distribution on \[0, 2\]
dist_mixture(
  dists = list(
    dist_uniform(min = 0, max = 1),
    dist_uniform(min = 1, max = 2)
  ),
  probs = list(0.5, 0.5)
)

</code></pre>

<hr>
<h2 id='dist_negbinomial'>Negative binomial Distribution</h2><span id='topic+dist_negbinomial'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+NegBinomial">stats::NegBinomial</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_negbinomial(size = NULL, mu = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_negbinomial_+3A_size">size</code></td>
<td>
<p>Number of successful trials parameter, or <code>NULL</code> as a
placeholder. Non-integer values &gt; 0 are allowed.</p>
</td></tr>
<tr><td><code id="dist_negbinomial_+3A_mu">mu</code></td>
<td>
<p>Mean parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(size = ..., prob = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>NegativeBinomialDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_nbinom &lt;- dist_negbinomial(size = 3.5, mu = 8.75)
x &lt;- d_nbinom$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_nbinom,
  estimated = d_nbinom,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "nbinom")$estimate
    )
  ),
  .x = 0:max(x)
)

</code></pre>

<hr>
<h2 id='dist_normal'>Normal distribution</h2><span id='topic+dist_normal'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Normal">stats::Normal</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_normal(mean = NULL, sd = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_normal_+3A_mean">mean</code></td>
<td>
<p>Scalar mean parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_normal_+3A_sd">sd</code></td>
<td>
<p>Scalar standard deviation parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(mean = ..., sd = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>NormalDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 0
sigma &lt;- 1

d_norm &lt;- dist_normal(mean = mu, sd = sigma)
x &lt;- d_norm$sample(20)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_norm,
  estimated = d_norm,
  with_params = list(
    estimated = list(mean = mean(x), sd = sd(x))
  ),
  .x = seq(-3, 3, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_pareto'>Pareto Distribution</h2><span id='topic+dist_pareto'></span>

<h3>Description</h3>

<p>See <a href="#topic+Pareto">Pareto</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_pareto(shape = NULL, scale = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_pareto_+3A_shape">shape</code></td>
<td>
<p>Scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_pareto_+3A_scale">scale</code></td>
<td>
<p>Scalar scale parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(shape = ..., scale = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>ParetoDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_pareto &lt;- dist_pareto(shape = 3, scale = 1)
x &lt;- d_pareto$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_pareto,
  estimated = d_pareto,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "pareto")$estimate
    )
  ),
  .x = seq(0, 2, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_poisson'>Poisson Distribution</h2><span id='topic+dist_poisson'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Poisson">stats::Poisson</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_poisson(lambda = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_poisson_+3A_lambda">lambda</code></td>
<td>
<p>Scalar rate parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameter can be overridden with
<code>with_params = list(lambda = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>PoissonDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_pois &lt;- dist_poisson(lambda = 5.0)
x &lt;- d_pois$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_pois,
  estimated = d_pois,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "pois")$estimate
    )
  ),
  .x = 0:max(x)
)

</code></pre>

<hr>
<h2 id='dist_translate'>Tranlsated distribution</h2><span id='topic+dist_translate'></span>

<h3>Description</h3>

<p>Tranlsated distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_translate(dist = NULL, offset = NULL, multiplier = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_translate_+3A_dist">dist</code></td>
<td>
<p>An underlying distribution, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_translate_+3A_offset">offset</code></td>
<td>
<p>Offset to be added to each observation, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_translate_+3A_multiplier">multiplier</code></td>
<td>
<p>Factor to multiply each observation by, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>TranslatedDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_norm &lt;- dist_normal(mean = 0, sd = 1)
d_tnorm &lt;- dist_translate(dist = d_norm, offset = 1)
plot_distributions(d_norm, d_tnorm, .x = seq(-2, 3, length.out = 100))

</code></pre>

<hr>
<h2 id='dist_trunc'>Truncated distribution</h2><span id='topic+dist_trunc'></span>

<h3>Description</h3>

<p>Truncated distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_trunc(dist = NULL, min = NULL, max = NULL, offset = 0, max_retry = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_trunc_+3A_dist">dist</code></td>
<td>
<p>An underlying distribution, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_trunc_+3A_min">min</code></td>
<td>
<p>Minimum value to truncate at (exclusive),
or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_trunc_+3A_max">max</code></td>
<td>
<p>Maxmimum value to truncate at (inclusive),
or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_trunc_+3A_offset">offset</code></td>
<td>
<p>Offset to be added to each observation after truncation,
or <code>NULL</code> as a placeholder. Truncation of <code>dist</code> will occur to (min, max].
The offset is then added deterministically.</p>
</td></tr>
<tr><td><code id="dist_trunc_+3A_max_retry">max_retry</code></td>
<td>
<p>Maximum number of resample attempts when trying to sample
with rejection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>TruncatedDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_norm &lt;- dist_normal(mean = 0, sd = 1)
d_tnorm &lt;- dist_trunc(dist = d_norm, min = -2, max = 2, offset = 1)
plot_distributions(d_norm, d_tnorm, .x = seq(-2, 3, length.out = 100))

</code></pre>

<hr>
<h2 id='dist_uniform'>Uniform distribution</h2><span id='topic+dist_uniform'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Uniform">stats::Uniform</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_uniform(min = NULL, max = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_uniform_+3A_min">min</code></td>
<td>
<p>Lower limit, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_uniform_+3A_max">max</code></td>
<td>
<p>Upper limit, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(min = ..., max = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>UniformDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_unif &lt;- dist_uniform(min = 0, max = 1)
x &lt;- d_unif$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_unif,
  estimated = d_unif,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "unif")$estimate
    )
  ),
  .x = seq(0, 1, length.out = 100)
)

</code></pre>

<hr>
<h2 id='dist_weibull'>Weibull Distribution</h2><span id='topic+dist_weibull'></span>

<h3>Description</h3>

<p>See <a href="stats.html#topic+Weibull">stats::Weibull</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_weibull(shape = NULL, scale = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_weibull_+3A_shape">shape</code></td>
<td>
<p>Scalar shape parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
<tr><td><code id="dist_weibull_+3A_scale">scale</code></td>
<td>
<p>Scalar scale parameter, or <code>NULL</code> as a placeholder.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both parameters can be overridden with
<code>with_params = list(shape = ..., scale = ...)</code>.
</p>


<h3>Value</h3>

<p>A <code>WeibullDistribution</code> object.
</p>


<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+Distribution">Distribution</a></code>,
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d_weibull &lt;- dist_weibull(shape = 3, scale = 1)
x &lt;- d_weibull$sample(100)
d_emp &lt;- dist_empirical(x)

plot_distributions(
  empirical = d_emp,
  theoretical = d_weibull,
  estimated = d_weibull,
  with_params = list(
    estimated = inflate_params(
      fitdistrplus::fitdist(x, distr = "weibull")$estimate
    )
  ),
  .x = seq(0, 2, length.out = 100)
)

</code></pre>

<hr>
<h2 id='Distribution'>Base class for Distributions</h2><span id='topic+Distribution'></span>

<h3>Description</h3>

<p>Represents a modifiable Distribution family
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>default_params</code></dt><dd><p>Get or set (non-recursive) default parameters of a
Distribution</p>
</dd>
<dt><code>param_bounds</code></dt><dd><p>Get or set (non-recursive) parameter bounds
(box constraints) of a Distribution</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Distribution-new"><code>Distribution$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-sample"><code>Distribution$sample()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-density"><code>Distribution$density()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-tf_logdensity"><code>Distribution$tf_logdensity()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-probability"><code>Distribution$probability()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-tf_logprobability"><code>Distribution$tf_logprobability()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-quantile"><code>Distribution$quantile()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-hazard"><code>Distribution$hazard()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-diff_density"><code>Distribution$diff_density()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-diff_probability"><code>Distribution$diff_probability()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-is_in_support"><code>Distribution$is_in_support()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-is_discrete_at"><code>Distribution$is_discrete_at()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-tf_is_discrete_at"><code>Distribution$tf_is_discrete_at()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-has_capability"><code>Distribution$has_capability()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_type"><code>Distribution$get_type()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_components"><code>Distribution$get_components()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-is_discrete"><code>Distribution$is_discrete()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-is_continuous"><code>Distribution$is_continuous()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-require_capability"><code>Distribution$require_capability()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_dof"><code>Distribution$get_dof()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_placeholders"><code>Distribution$get_placeholders()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_params"><code>Distribution$get_params()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-tf_make_constants"><code>Distribution$tf_make_constants()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-tf_compile_params"><code>Distribution$tf_compile_params()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_param_bounds"><code>Distribution$get_param_bounds()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-get_param_constraints"><code>Distribution$get_param_constraints()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-export_functions"><code>Distribution$export_functions()</code></a>
</p>
</li>
<li> <p><a href="#method-Distribution-clone"><code>Distribution$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Distribution-new"></a>



<h4>Method <code>new()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$new(type, caps, params, name, default_params)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>type</code></dt><dd><p>Type of distribution. This is a string constant for the
default implementation. Distributions with non-constant type must
override the <code>get_type()</code> function.</p>
</dd>
<dt><code>caps</code></dt><dd><p>Character vector of capabilities to fuel the default
implementations of <code>has_capability()</code> and <code>require_capability()</code>.
Distributions with dynamic capabilities must override the
<code>has_capability()</code> function.</p>
</dd>
<dt><code>params</code></dt><dd><p>Initial parameter bounds structure, backing the
<code>param_bounds</code> active binding (usually a list of intervals).</p>
</dd>
<dt><code>name</code></dt><dd><p>Name of the Distribution class. Should be <code>CamelCase</code> and end
with <code>"Distribution"</code>.</p>
</dd>
<dt><code>default_params</code></dt><dd><p>Initial fixed parameters backing the
<code>default_params</code> active binding (usually a list of numeric / NULLs).</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Construct a Distribution instance
</p>
<p>Used internally by the <code style="white-space: pre;">&#8288;dist_*&#8288;</code> functions.
</p>


<hr>
<a id="method-Distribution-sample"></a>



<h4>Method <code>sample()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$sample(n, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>n</code></dt><dd><p>number of samples to draw.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>n</code>. In that
case the <code>i</code>-th sample will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Sample from a Distribution
</p>



<h5>Returns</h5>

<p>A length <code>n</code> vector of i.i.d. random samples from the
Distribution with the specified parameters.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential(rate = 2.0)$sample(10)
</pre>
</div>


<hr>
<a id="method-Distribution-density"></a>



<h4>Method <code>density()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$density(x, log = FALSE, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>Vector of points to evaluate the density at.</p>
</dd>
<dt><code>log</code></dt><dd><p>Flag. If <code>TRUE</code>, return the log-density instead.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(x)</code>.
In that case, the <code>i</code>-th density point will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Density of a Distribution
</p>



<h5>Returns</h5>

<p>A numeric vector of (log-)densities
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$density(c(1.0, 2.0), with_params = list(rate = 2.0))
</pre>
</div>


<hr>
<a id="method-Distribution-tf_logdensity"></a>



<h4>Method <code>tf_logdensity()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$tf_logdensity()</pre></div>



<h5>Details</h5>

<p>Compile a TensorFlow function for log-density evaluation
</p>



<h5>Returns</h5>

<p>A <code>tf_function</code> taking arguments <code>x</code> and <code>args</code> returning the
log-density of the Distribution evaluated at <code>x</code> with parameters <code>args</code>.
</p>


<hr>
<a id="method-Distribution-probability"></a>



<h4>Method <code>probability()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$probability(
  q,
  lower.tail = TRUE,
  log.p = FALSE,
  with_params = list()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>q</code></dt><dd><p>Vector of points to evaluate the probability function at.</p>
</dd>
<dt><code>lower.tail</code></dt><dd><p>If <code>TRUE</code>, return P(X &lt;= q). Otherwise return P(X &gt; q).</p>
</dd>
<dt><code>log.p</code></dt><dd><p>If <code>TRUE</code>, probabilities are returned as <code>log(p)</code>.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(q)</code>.
In that case, the <code>i</code>-th probability point will use the <code>i</code>-th
parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Cumulative probability of a Distribution
</p>



<h5>Returns</h5>

<p>A numeric vector of (log-)probabilities
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$probability(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)
</pre>
</div>


<hr>
<a id="method-Distribution-tf_logprobability"></a>



<h4>Method <code>tf_logprobability()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$tf_logprobability()</pre></div>



<h5>Details</h5>

<p>Compile a TensorFlow function for log-probability evaluation
</p>



<h5>Returns</h5>

<p>A <code>tf_function</code> taking arguments <code>qmin</code>, <code>qmax</code> and <code>args</code>
returning the log-probability of the Distribution evaluated over the
closed interval [<code>qmin</code>, <code>qmax</code>] with parameters <code>args</code>.
</p>


<hr>
<a id="method-Distribution-quantile"></a>



<h4>Method <code>quantile()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$quantile(
  p,
  lower.tail = TRUE,
  log.p = FALSE,
  with_params = list()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>p</code></dt><dd><p>Vector of probabilities.</p>
</dd>
<dt><code>lower.tail</code></dt><dd><p>If <code>TRUE</code>, return P(X &lt;= q). Otherwise return P(X &gt; q).</p>
</dd>
<dt><code>log.p</code></dt><dd><p>If <code>TRUE</code>, probabilities are returned as <code>log(p)</code>.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(p)</code>.
In that case, the <code>i</code>-th quantile will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Quantile function of a Distribution
</p>



<h5>Returns</h5>

<p>A numeric vector of quantiles
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$quantile(c(0.1, 0.5), with_params = list(rate = 2.0))
</pre>
</div>


<hr>
<a id="method-Distribution-hazard"></a>



<h4>Method <code>hazard()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$hazard(x, log = FALSE, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>Vector of points.</p>
</dd>
<dt><code>log</code></dt><dd><p>Flag. If <code>TRUE</code>, return the log-hazard instead.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(x)</code>.
In that case, the <code>i</code>-th hazard point will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Hazard function of a Distribution
</p>



<h5>Returns</h5>

<p>A numeric vector of (log-)hazards
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential(rate = 2.0)$hazard(c(1.0, 2.0))
</pre>
</div>


<hr>
<a id="method-Distribution-diff_density"></a>



<h4>Method <code>diff_density()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$diff_density(x, log = FALSE, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>Vector of points.</p>
</dd>
<dt><code>log</code></dt><dd><p>Flag. If <code>TRUE</code>, return the gradient of the log-density
instead.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(x)</code>.
In that case, the <code>i</code>-th density point will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Gradients of the density of a Distribution
</p>



<h5>Returns</h5>

<p>A list structure containing the (log-)density gradients of all
free parameters of the Distribution evaluated at <code>x</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$diff_density(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)
</pre>
</div>


<hr>
<a id="method-Distribution-diff_probability"></a>



<h4>Method <code>diff_probability()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$diff_probability(
  q,
  lower.tail = TRUE,
  log.p = FALSE,
  with_params = list()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>q</code></dt><dd><p>Vector of points to evaluate the probability function at.</p>
</dd>
<dt><code>lower.tail</code></dt><dd><p>If <code>TRUE</code>, return P(X &lt;= q). Otherwise return P(X &gt; q).</p>
</dd>
<dt><code>log.p</code></dt><dd><p>If <code>TRUE</code>, probabilities are returned as <code>log(p)</code>.</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(q)</code>.
In that case, the <code>i</code>-th probability point will use the <code>i</code>-th
parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Gradients of the cumulative probability of a Distribution
</p>



<h5>Returns</h5>

<p>A list structure containing the cumulative (log-)probability
gradients of all free parameters of the Distribution evaluated at <code>q</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$diff_probability(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)
</pre>
</div>


<hr>
<a id="method-Distribution-is_in_support"></a>



<h4>Method <code>is_in_support()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$is_in_support(x, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>Vector of points</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(x)</code>.
In that case, the <code>i</code>-th point will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Determine if a value is in the support of a Distribution
</p>



<h5>Returns</h5>

<p>A logical vector with the same length as <code>x</code> indicating whether
<code>x</code> is part of the support of the distribution given its parameters.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential(rate = 1.0)$is_in_support(c(-1.0, 0.0, 1.0))
</pre>
</div>


<hr>
<a id="method-Distribution-is_discrete_at"></a>



<h4>Method <code>is_discrete_at()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$is_discrete_at(x, with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>x</code></dt><dd><p>Vector of points</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Distribution parameters to use.
Each parameter value can also be a numeric vector of length <code>length(x)</code>.
In that case, the <code>i</code>-th point will use the <code>i</code>-th parameters.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Determine if a value has positive probability
</p>



<h5>Returns</h5>

<p>A logical vector with the same length as <code>x</code> indicating whether
there is a positive probability mass at <code>x</code> given the Distribution
parameters.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_dirac(point = 0.0)$is_discrete_at(c(0.0, 1.0))
</pre>
</div>


<hr>
<a id="method-Distribution-tf_is_discrete_at"></a>



<h4>Method <code>tf_is_discrete_at()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$tf_is_discrete_at()</pre></div>



<h5>Details</h5>

<p>Compile a TensorFlow function for discrete support checking
</p>



<h5>Returns</h5>

<p>A <code>tf_function</code> taking arguments <code>x</code> and <code>args</code> returning whether
the Distribution has a point mass at <code>x</code> given parameters <code>args</code>.
</p>


<hr>
<a id="method-Distribution-has_capability"></a>



<h4>Method <code>has_capability()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$has_capability(caps)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>caps</code></dt><dd><p>Character vector of capabilities</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Check if a capability is present
</p>



<h5>Returns</h5>

<p>A logical vector the same length as <code>caps</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$has_capability("density")
</pre>
</div>


<hr>
<a id="method-Distribution-get_type"></a>



<h4>Method <code>get_type()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_type()</pre></div>



<h5>Details</h5>

<p>Get the type of a Distribution. Type can be one of <code>discrete</code>,
<code>continuous</code> or <code>mixed</code>.
</p>



<h5>Returns</h5>

<p>A string representing the type of the Distribution.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$get_type()
dist_dirac()$get_type()

dist_mixture(list(dist_dirac(), dist_exponential()))$get_type()
dist_mixture(list(dist_dirac(), dist_binomial()))$get_type()
</pre>
</div>


<hr>
<a id="method-Distribution-get_components"></a>



<h4>Method <code>get_components()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_components()</pre></div>



<h5>Details</h5>

<p>Get the component Distributions of a transformed Distribution.
</p>



<h5>Returns</h5>

<p>A possibly empty list of Distributions
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_trunc(dist_exponential())$get_components()
dist_dirac()$get_components()
dist_mixture(list(dist_exponential(), dist_gamma()))$get_components()
</pre>
</div>


<hr>
<a id="method-Distribution-is_discrete"></a>



<h4>Method <code>is_discrete()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$is_discrete()</pre></div>



<h5>Details</h5>

<p>Check if a Distribution is discrete, i.e. it has a density with respect
to the counting measure.
</p>



<h5>Returns</h5>

<p><code>TRUE</code> if the Distribution is discrete, <code>FALSE</code> otherwise.
Note that mixed distributions are not discrete but can have point masses.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$is_discrete()
dist_dirac()$is_discrete()
</pre>
</div>


<hr>
<a id="method-Distribution-is_continuous"></a>



<h4>Method <code>is_continuous()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$is_continuous()</pre></div>



<h5>Details</h5>

<p>Check if a Distribution is continuous, i.e. it has a density with respect
to the Lebesgue measure.
</p>



<h5>Returns</h5>

<p><code>TRUE</code> if the Distribution is continuous, <code>FALSE</code> otherwise.
Note that mixed distributions are not continuous.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$is_continuous()
dist_dirac()$is_continuous()
</pre>
</div>


<hr>
<a id="method-Distribution-require_capability"></a>



<h4>Method <code>require_capability()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$require_capability(
  caps,
  fun_name = paste0(sys.call(-1)[[1]], "()")
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>caps</code></dt><dd><p>Character vector of Capabilities to require</p>
</dd>
<dt><code>fun_name</code></dt><dd><p>Frienly text to use for generating the error message in
case of failure.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Ensure that a Distribution has all required capabilities.
Will throw an error if any capability is missing.
</p>



<h5>Returns</h5>

<p>Invisibly <code>TRUE</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$require_capability("diff_density")
</pre>
</div>


<hr>
<a id="method-Distribution-get_dof"></a>



<h4>Method <code>get_dof()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_dof()</pre></div>



<h5>Details</h5>

<p>Get the number of degrees of freedom of a Distribution family.
Only parameters without a fixed default are considered free.
</p>



<h5>Returns</h5>

<p>An integer representing the degrees of freedom suitable e.g. for
AIC calculations.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$get_dof()
dist_exponential(rate = 1.0)$get_dof()
</pre>
</div>


<hr>
<a id="method-Distribution-get_placeholders"></a>



<h4>Method <code>get_placeholders()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_placeholders()</pre></div>



<h5>Details</h5>

<p>Get Placeholders of a Distribution family.
Returns a list of free parameters of the family.
Their values will be <code>NULL</code>.
</p>
<p>If the Distribution has Distributions as parameters, placeholders will be
computed recursively.
</p>



<h5>Returns</h5>

<p>A named list containing any combination of (named or unnamed)
lists and <code>NULL</code>s.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_exponential()$get_placeholders()
dist_mixture(list(dist_dirac(), dist_exponential()))$get_placeholders()
</pre>
</div>


<hr>
<a id="method-Distribution-get_params"></a>



<h4>Method <code>get_params()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_params(with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>with_params</code></dt><dd><p>Optional parameter overrides with the same structure
as <code>dist$get_params()</code>. Given Parameter values are expected to be length
1.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Get a full list of parameters, possibly including placeholders.
</p>



<h5>Returns</h5>

<p>A list representing the (recursive) parameter structure of the
Distribution with values for specified parameters and <code>NULL</code> for free
parameters that are missing both in the Distributions parameters and in
<code>with_params</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_mixture(list(dist_dirac(), dist_exponential()))$get_params(
  with_params = list(probs = list(0.5, 0.5))
)
</pre>
</div>


<hr>
<a id="method-Distribution-tf_make_constants"></a>



<h4>Method <code>tf_make_constants()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$tf_make_constants(with_params = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>with_params</code></dt><dd><p>Optional parameter overrides with the same structure
as <code>dist$tf_make_constants()</code>. Given Parameter values are expected to be
length 1.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Get a list of constant TensorFlow parameters
</p>



<h5>Returns</h5>

<p>A list representing the (recursive) constant parameters of the
Distribution with values sprecified by parameters. Each constant is a
TensorFlow Tensor of dtype <code>floatx</code>.
</p>


<hr>
<a id="method-Distribution-tf_compile_params"></a>



<h4>Method <code>tf_compile_params()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$tf_compile_params(input, name_prefix = "")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>input</code></dt><dd><p>A keras layer to bind all outputs to</p>
</dd>
<dt><code>name_prefix</code></dt><dd><p>Prefix to use for layer names</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Compile distribution parameters into tensorflow outputs
</p>



<h5>Returns</h5>

<p>A list with two elements
</p>

<ul>
<li> <p><code>outputs</code> a flat list of keras output layers, one for each parameter.
</p>
</li>
<li> <p><code>output_inflater</code> a function taking keras output layers and
transforming them into a list structure suitable for passing to the
loss function returned by <code><a href="#topic+tf_compile_model">tf_compile_model()</a></code>
</p>
</li></ul>



<hr>
<a id="method-Distribution-get_param_bounds"></a>



<h4>Method <code>get_param_bounds()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_param_bounds()</pre></div>



<h5>Details</h5>

<p>Get Interval bounds on all Distribution parameters
</p>



<h5>Returns</h5>

<p>A list representing the free (recursive) parameter structure of
the Distribution with <code>Interval</code> objects as values representing the
bounds of the respective free parameters.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>dist_mixture(
  list(dist_dirac(), dist_exponential()),
  probs = list(0.5, 0.5)
)$get_param_bounds()

dist_mixture(
  list(dist_dirac(), dist_exponential())
)$get_param_bounds()

dist_genpareto()$get_param_bounds()
dist_genpareto1()$get_param_bounds()
</pre>
</div>


<hr>
<a id="method-Distribution-get_param_constraints"></a>



<h4>Method <code>get_param_constraints()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$get_param_constraints()</pre></div>



<h5>Details</h5>

<p>Get additional (non-linear) equality constraints on Distribution
parameters
</p>



<h5>Returns</h5>

<p><code>NULL</code> if the box constraints specified by
<code>dist$get_param_bounds()</code> are sufficient, or a function taking full
Distribution parameters and returning either a numeric vector
(which must be 0 for valid parameter combinations) or a list with
elements
</p>

<ul>
<li> <p><code>constraints</code>: The numeric vector of constraints
</p>
</li>
<li> <p><code>jacobian</code>: The Jacobi matrix of the constraints with respect to the
parameters
</p>
</li></ul>




<h5>Examples</h5>

<div class="r example copy">
<pre>dist_mixture(
  list(dist_dirac(), dist_exponential())
)$get_param_constraints()
</pre>
</div>


<hr>
<a id="method-Distribution-export_functions"></a>



<h4>Method <code>export_functions()</code></h4>



<h5>Usage</h5>

<div class="r"><pre>Distribution$export_functions(
  name,
  envir = parent.frame(),
  with_params = list()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>name</code></dt><dd><p>common suffix of the exported functions</p>
</dd>
<dt><code>envir</code></dt><dd><p>Environment to export the functions to</p>
</dd>
<dt><code>with_params</code></dt><dd><p>Optional list of parameters to use as default values
for the exported functions</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>Export sampling, density, probability and quantile functions
to plain R functions
</p>
<p>Creates new functions in <code>envir</code> named <code style="white-space: pre;">&#8288;{r,d,p,q}&lt;name&gt;&#8288;</code> which implement
<code>dist$sample</code>, <code>dist$density</code>, <code>dist$probability</code> and <code>dist$quantile</code> as
plain functions with default arguments specified by <code>with_params</code> or the
fixed parameters.
</p>
<p>The resulting functions will have signatures taking all parameters as
separate arguments.
</p>



<h5>Returns</h5>

<p>Invisibly <code>NULL</code>.
</p>



<h5>Examples</h5>

<div class="r example copy">
<pre>tmp_env &lt;- new.env(parent = globalenv())
dist_exponential()$export_functions(
  name = "exp",
  envir = tmp_env,
  with_params = list(rate = 2.0)
)
evalq(
  fitdistrplus::fitdist(rexp(100), "exp"),
  envir = tmp_env
)
</pre>
</div>


<hr>
<a id="method-Distribution-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Distribution$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>See Also</h3>

<p>Other Distributions: 
<code><a href="#topic+dist_bdegp">dist_bdegp</a>()</code>,
<code><a href="#topic+dist_beta">dist_beta</a>()</code>,
<code><a href="#topic+dist_binomial">dist_binomial</a>()</code>,
<code><a href="#topic+dist_blended">dist_blended</a>()</code>,
<code><a href="#topic+dist_dirac">dist_dirac</a>()</code>,
<code><a href="#topic+dist_discrete">dist_discrete</a>()</code>,
<code><a href="#topic+dist_empirical">dist_empirical</a>()</code>,
<code><a href="#topic+dist_erlangmix">dist_erlangmix</a>()</code>,
<code><a href="#topic+dist_exponential">dist_exponential</a>()</code>,
<code><a href="#topic+dist_gamma">dist_gamma</a>()</code>,
<code><a href="#topic+dist_genpareto">dist_genpareto</a>()</code>,
<code><a href="#topic+dist_lognormal">dist_lognormal</a>()</code>,
<code><a href="#topic+dist_mixture">dist_mixture</a>()</code>,
<code><a href="#topic+dist_negbinomial">dist_negbinomial</a>()</code>,
<code><a href="#topic+dist_normal">dist_normal</a>()</code>,
<code><a href="#topic+dist_pareto">dist_pareto</a>()</code>,
<code><a href="#topic+dist_poisson">dist_poisson</a>()</code>,
<code><a href="#topic+dist_translate">dist_translate</a>()</code>,
<code><a href="#topic+dist_trunc">dist_trunc</a>()</code>,
<code><a href="#topic+dist_uniform">dist_uniform</a>()</code>,
<code><a href="#topic+dist_weibull">dist_weibull</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example for param_bounds:

# Create an Exponential Distribution with rate constrained to (0, 2)
# instead of (0, Inf)
my_exp &lt;- dist_exponential()
my_exp$param_bounds$rate &lt;- interval(c(0, 2))
my_exp$get_param_bounds()

fit_dist(my_exp, rexp(100, rate = 3), start = list(rate = 1))$params$rate


## ------------------------------------------------
## Method `Distribution$sample`
## ------------------------------------------------

dist_exponential(rate = 2.0)$sample(10)

## ------------------------------------------------
## Method `Distribution$density`
## ------------------------------------------------

dist_exponential()$density(c(1.0, 2.0), with_params = list(rate = 2.0))

## ------------------------------------------------
## Method `Distribution$probability`
## ------------------------------------------------

dist_exponential()$probability(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)

## ------------------------------------------------
## Method `Distribution$quantile`
## ------------------------------------------------

dist_exponential()$quantile(c(0.1, 0.5), with_params = list(rate = 2.0))

## ------------------------------------------------
## Method `Distribution$hazard`
## ------------------------------------------------

dist_exponential(rate = 2.0)$hazard(c(1.0, 2.0))

## ------------------------------------------------
## Method `Distribution$diff_density`
## ------------------------------------------------

dist_exponential()$diff_density(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)

## ------------------------------------------------
## Method `Distribution$diff_probability`
## ------------------------------------------------

dist_exponential()$diff_probability(
  c(1.0, 2.0),
  with_params = list(rate = 2.0)
)

## ------------------------------------------------
## Method `Distribution$is_in_support`
## ------------------------------------------------

dist_exponential(rate = 1.0)$is_in_support(c(-1.0, 0.0, 1.0))

## ------------------------------------------------
## Method `Distribution$is_discrete_at`
## ------------------------------------------------

dist_dirac(point = 0.0)$is_discrete_at(c(0.0, 1.0))

## ------------------------------------------------
## Method `Distribution$has_capability`
## ------------------------------------------------

dist_exponential()$has_capability("density")

## ------------------------------------------------
## Method `Distribution$get_type`
## ------------------------------------------------

dist_exponential()$get_type()
dist_dirac()$get_type()

dist_mixture(list(dist_dirac(), dist_exponential()))$get_type()
dist_mixture(list(dist_dirac(), dist_binomial()))$get_type()

## ------------------------------------------------
## Method `Distribution$get_components`
## ------------------------------------------------

dist_trunc(dist_exponential())$get_components()
dist_dirac()$get_components()
dist_mixture(list(dist_exponential(), dist_gamma()))$get_components()

## ------------------------------------------------
## Method `Distribution$is_discrete`
## ------------------------------------------------

dist_exponential()$is_discrete()
dist_dirac()$is_discrete()

## ------------------------------------------------
## Method `Distribution$is_continuous`
## ------------------------------------------------

dist_exponential()$is_continuous()
dist_dirac()$is_continuous()

## ------------------------------------------------
## Method `Distribution$require_capability`
## ------------------------------------------------

dist_exponential()$require_capability("diff_density")

## ------------------------------------------------
## Method `Distribution$get_dof`
## ------------------------------------------------

dist_exponential()$get_dof()
dist_exponential(rate = 1.0)$get_dof()

## ------------------------------------------------
## Method `Distribution$get_placeholders`
## ------------------------------------------------

dist_exponential()$get_placeholders()
dist_mixture(list(dist_dirac(), dist_exponential()))$get_placeholders()

## ------------------------------------------------
## Method `Distribution$get_params`
## ------------------------------------------------

dist_mixture(list(dist_dirac(), dist_exponential()))$get_params(
  with_params = list(probs = list(0.5, 0.5))
)

## ------------------------------------------------
## Method `Distribution$get_param_bounds`
## ------------------------------------------------

dist_mixture(
  list(dist_dirac(), dist_exponential()),
  probs = list(0.5, 0.5)
)$get_param_bounds()

dist_mixture(
  list(dist_dirac(), dist_exponential())
)$get_param_bounds()

dist_genpareto()$get_param_bounds()
dist_genpareto1()$get_param_bounds()

## ------------------------------------------------
## Method `Distribution$get_param_constraints`
## ------------------------------------------------

dist_mixture(
  list(dist_dirac(), dist_exponential())
)$get_param_constraints()

## ------------------------------------------------
## Method `Distribution$export_functions`
## ------------------------------------------------

tmp_env &lt;- new.env(parent = globalenv())
dist_exponential()$export_functions(
  name = "exp",
  envir = tmp_env,
  with_params = list(rate = 2.0)
)
evalq(
  fitdistrplus::fitdist(rexp(100), "exp"),
  envir = tmp_env
)
</code></pre>

<hr>
<h2 id='fit_blended'>Fit a Blended mixture using an ECME-Algorithm</h2><span id='topic+fit_blended'></span>

<h3>Description</h3>

<p>Fit a Blended mixture using an ECME-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_blended(
  dist,
  obs,
  start,
  min_iter = 0L,
  max_iter = 100L,
  skip_first_e = FALSE,
  tolerance = 1e-05,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_blended_+3A_dist">dist</code></td>
<td>
<p>A <code>BlendedDistribution</code>. It is assumed, that <code>breaks</code> and
<code>bandwidths</code> are not a placeholder and that <code>weights</code> are to be estimated.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_obs">obs</code></td>
<td>
<p>Set of observations as produced by <code><a href="#topic+trunc_obs">trunc_obs()</a></code> or convertible
via <code><a href="#topic+as_trunc_obs">as_trunc_obs()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_start">start</code></td>
<td>
<p>Initial values of all placeholder parameters.
If missing, starting values are obtained from <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_min_iter">min_iter</code></td>
<td>
<p>Minimum number of EM-Iterations</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of EM-Iterations (weight updates)</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_skip_first_e">skip_first_e</code></td>
<td>
<p>Skip the first E-Step (update Probability weights)?
This can help if the initial values cause a mixture component to vanish in
the first E-Step before the starting values can be improved.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_tolerance">tolerance</code></td>
<td>
<p>Numerical tolerance.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_trace">trace</code></td>
<td>
<p>Include tracing information in output?
If <code>TRUE</code>, additional tracing information will be added to the result list.</p>
</td></tr>
<tr><td><code id="fit_blended_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code> if <code>start</code> is missing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>

<ul>
<li> <p><code>params</code> the fitted parameters in the same structure as <code>init</code>.
</p>
</li>
<li> <p><code>params_hist</code> (if <code>trace</code> is TRUE) the history of parameters
(after each e- and m- step)
</p>
</li>
<li> <p><code>iter</code> the number of outer EM-iterations
</p>
</li>
<li> <p><code>logLik</code> the final log-likelihood
</p>
</li></ul>



<h3>See Also</h3>

<p>Other distribution fitting functions: 
<code><a href="#topic+fit_dist">fit_dist</a>()</code>,
<code><a href="#topic+fit_erlang_mixture">fit_erlang_mixture</a>()</code>,
<code><a href="#topic+fit_mixture">fit_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_blended(
   list(
     dist_exponential(),
     dist_genpareto()
   )
 )

params &lt;- list(
  probs = list(0.9, 0.1),
  dists = list(
    list(rate = 2.0),
    list(u = 1.5, xi = 0.2, sigmau = 1.0)
  ),
  breaks = list(1.5),
  bandwidths = list(0.3)
)

x &lt;- dist$sample(100L, with_params = params)

dist$default_params$breaks &lt;- params$breaks
dist$default_params$bandwidths &lt;- params$bandwidths
if (interactive()) {
  fit_blended(dist, x)
}

</code></pre>

<hr>
<h2 id='fit_dist'>Fit a general distribution to observations</h2><span id='topic+fit_dist'></span><span id='topic+fit_dist_direct'></span><span id='topic+fit.Distribution'></span>

<h3>Description</h3>

<p>The default implementation performs maximum likelihood estimation on all
placeholder parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_dist(dist, obs, start, ...)

fit_dist_direct(dist, obs, start, ..., .start_with_default = FALSE)

## S3 method for class 'Distribution'
fit(object, obs, start, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_dist_+3A_dist">dist</code></td>
<td>
<p>A <code>Distribution</code> object.</p>
</td></tr>
<tr><td><code id="fit_dist_+3A_obs">obs</code></td>
<td>
<p>Set of observations as produced by <code><a href="#topic+trunc_obs">trunc_obs()</a></code> or convertible
via <code><a href="#topic+as_trunc_obs">as_trunc_obs()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_dist_+3A_start">start</code></td>
<td>
<p>Initial values of all placeholder parameters.
If missing, starting values are obtained from <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_dist_+3A_...">...</code></td>
<td>
<p>Distribution-specific arguments for the fitting procedure</p>
</td></tr>
<tr><td><code id="fit_dist_+3A_.start_with_default">.start_with_default</code></td>
<td>
<p>Before directly optimising the likelihood, use an optimised algorithm for finding
better starting values?</p>
</td></tr>
<tr><td><code id="fit_dist_+3A_object">object</code></td>
<td>
<p>same as parameter <code>dist</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Erlang mixture distributions and for Mixture distributions, an
EM-Algorithm is instead used to improve stability.
</p>
<p><code>fit()</code> and <code>fit_dist()</code> will chose an optimisation method optimized for the specific distribution given.
<code>fit_dist_direct()</code> can be used to force direct maximisation of the likelihood.
</p>


<h3>Value</h3>

<p>A list with at least the elements
</p>

<ul>
<li> <p><code>params</code> the fitted parameters in the same structure as <code>init</code>.
</p>
</li>
<li> <p><code>logLik</code> the final log-likelihood
</p>
</li></ul>

<p>Additional information may be provided depending on <code>dist</code>.
</p>


<h3>See Also</h3>

<p>Other distribution fitting functions: 
<code><a href="#topic+fit_blended">fit_blended</a>()</code>,
<code><a href="#topic+fit_erlang_mixture">fit_erlang_mixture</a>()</code>,
<code><a href="#topic+fit_mixture">fit_mixture</a>()</code>
</p>
<p>Other distribution fitting functions: 
<code><a href="#topic+fit_blended">fit_blended</a>()</code>,
<code><a href="#topic+fit_erlang_mixture">fit_erlang_mixture</a>()</code>,
<code><a href="#topic+fit_mixture">fit_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rexp(100)
lambda_hat &lt;- 1 / mean(x)
lambda_hat2 &lt;- fit_dist(dist_exponential(), x)$params$rate
identical(lambda_hat, lambda_hat2)
dist &lt;- dist_mixture(list(dist_normal(), dist_translate(dist_exponential(), offset = 6)))
params &lt;- list(
  dists = list(list(mean = 5, sd = 1), list(dist = list(rate = 1))), probs = list(0.95, 0.05)
)
set.seed(2000)
u &lt;- runif(100, 10, 20)
x &lt;- dist$sample(100, with_params = params)
obs &lt;- trunc_obs(x = x[x &lt;= u], tmin = -Inf, tmax = u[x &lt;= u])

default_fit &lt;- fit_dist(dist, obs)
direct_fit &lt;- fit_dist_direct(dist, obs)
# NB: direct optimisation steps with pre-run take a few seconds

direct_fit_init &lt;- fit_dist_direct(dist, obs, start = default_fit$params)
direct_fit_auto_init &lt;- fit_dist_direct(dist, obs, .start_with_default = TRUE)

stopifnot(direct_fit_init$logLik == direct_fit_auto_init$logLik)

c(default_fit$logLik, direct_fit$logLik, direct_fit_init$logLik)


</code></pre>

<hr>
<h2 id='fit_dist_start.MixtureDistribution'>Find starting values for distribution parameters</h2><span id='topic+fit_dist_start.MixtureDistribution'></span><span id='topic+fit_dist_start'></span>

<h3>Description</h3>

<p>Find starting values for distribution parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MixtureDistribution'
fit_dist_start(dist, obs, dists_start = NULL, ...)

fit_dist_start(dist, obs, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_dist_start.MixtureDistribution_+3A_dist">dist</code></td>
<td>
<p>A <code>Distribution</code> object.</p>
</td></tr>
<tr><td><code id="fit_dist_start.MixtureDistribution_+3A_obs">obs</code></td>
<td>
<p>Observations to fit to.</p>
</td></tr>
<tr><td><code id="fit_dist_start.MixtureDistribution_+3A_dists_start">dists_start</code></td>
<td>
<p>List of initial parameters for all component
distributions. If left empty, initialisation will be automatically performed
using <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code> with all observations in the support of each
respective component.</p>
</td></tr>
<tr><td><code id="fit_dist_start.MixtureDistribution_+3A_...">...</code></td>
<td>
<p>Additional arguments for the initialisation procedure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of initial parameters suitable for passing to <code><a href="#topic+fit_dist">fit_dist()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit_dist_start(dist_exponential(), rexp(100))
</code></pre>

<hr>
<h2 id='fit_erlang_mixture'>Fit an Erlang mixture using an ECME-Algorithm</h2><span id='topic+fit_erlang_mixture'></span>

<h3>Description</h3>

<p>Fit an Erlang mixture using an ECME-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_erlang_mixture(
  dist,
  obs,
  start,
  min_iter = 0L,
  max_iter = 100L,
  skip_first_e = FALSE,
  tolerance = 1e-05,
  trace = FALSE,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_erlang_mixture_+3A_dist">dist</code></td>
<td>
<p>An <code>ErlangMixtureDistribution</code>. It is assumed, that both <code>probs</code>
and <code>scale</code> are to be estimated.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_obs">obs</code></td>
<td>
<p>Set of observations as produced by <code><a href="#topic+trunc_obs">trunc_obs()</a></code> or convertible
via <code><a href="#topic+as_trunc_obs">as_trunc_obs()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_start">start</code></td>
<td>
<p>Initial values of all placeholder parameters.
If missing, starting values are obtained from <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_min_iter">min_iter</code></td>
<td>
<p>Minimum number of EM-Iterations</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of EM-Iterations (weight updates)</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_skip_first_e">skip_first_e</code></td>
<td>
<p>Skip the first E-Step (update Probability weights)?
This can help if the initial values cause a mixture component to vanish in
the first E-Step before the starting values can be improved.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_tolerance">tolerance</code></td>
<td>
<p>Numerical tolerance.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_trace">trace</code></td>
<td>
<p>Include tracing information in output?
If <code>TRUE</code>, additional tracing information will be added to the result list.</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_parallel">parallel</code></td>
<td>
<p>Enable experimental parallel evaluation of expected log-likelihood?</p>
</td></tr>
<tr><td><code id="fit_erlang_mixture_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code> if <code>start</code> is missing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>

<ul>
<li> <p><code>params</code> the fitted parameters in the same structure as <code>init</code>.
</p>
</li>
<li> <p><code>params_hist</code> (if <code>trace</code> is TRUE) the history of parameters
(after each e- and m- step). Otherwise an empty list.
</p>
</li>
<li> <p><code>iter</code> the number of outer EM-iterations
</p>
</li>
<li> <p><code>logLik</code> the final log-likelihood
</p>
</li></ul>



<h3>See Also</h3>

<p>Other distribution fitting functions: 
<code><a href="#topic+fit_blended">fit_blended</a>()</code>,
<code><a href="#topic+fit_dist">fit_dist</a>()</code>,
<code><a href="#topic+fit_mixture">fit_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_erlangmix(list(NULL, NULL, NULL))
params &lt;- list(
  shapes = list(1L, 4L, 12L),
  scale = 2.0,
  probs = list(0.5, 0.3, 0.2)
)
x &lt;- dist$sample(100L, with_params = params)
fit_erlang_mixture(dist, x, init = "kmeans")

</code></pre>

<hr>
<h2 id='fit_mixture'>Fit a generic mixture using an ECME-Algorithm</h2><span id='topic+fit_mixture'></span>

<h3>Description</h3>

<p>Fit a generic mixture using an ECME-Algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_mixture(
  dist,
  obs,
  start,
  min_iter = 0L,
  max_iter = 100L,
  skip_first_e = FALSE,
  tolerance = 1e-05,
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_mixture_+3A_dist">dist</code></td>
<td>
<p>A <code>MixtureDistribution</code> specifying the structure of the mixture.
Free parameters are to be optimised. The dominating measure for likelihoods
must be constant, so for example <code><a href="#topic+dist_dirac">dist_dirac()</a></code> may not have its <code>point</code>
parameter free.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_obs">obs</code></td>
<td>
<p>Set of observations as produced by <code><a href="#topic+trunc_obs">trunc_obs()</a></code> or convertible
via <code><a href="#topic+as_trunc_obs">as_trunc_obs()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_start">start</code></td>
<td>
<p>Initial values of all placeholder parameters.
If missing, starting values are obtained from <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_min_iter">min_iter</code></td>
<td>
<p>Minimum number of EM-Iterations</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of EM-Iterations (weight updates)</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_skip_first_e">skip_first_e</code></td>
<td>
<p>Skip the first E-Step (update Probability weights)?
This can help if the initial values cause a mixture component to vanish in
the first E-Step before the starting values can be improved.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_tolerance">tolerance</code></td>
<td>
<p>Numerical tolerance.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_trace">trace</code></td>
<td>
<p>Include tracing information in output?
If <code>TRUE</code>, additional tracing information will be added to the result list.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="#topic+fit_dist_start">fit_dist_start()</a></code> if <code>start</code> is missing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>

<ul>
<li> <p><code>params</code> the fitted parameters in the same structure as <code>init</code>.
</p>
</li>
<li> <p><code>params_hist</code> (if <code>trace</code> is TRUE) the history of parameters
(after each e- and m- step)
</p>
</li>
<li> <p><code>iter</code> the number of outer EM-iterations
</p>
</li>
<li> <p><code>logLik</code> the final log-likelihood
</p>
</li></ul>



<h3>See Also</h3>

<p>Other distribution fitting functions: 
<code><a href="#topic+fit_blended">fit_blended</a>()</code>,
<code><a href="#topic+fit_dist">fit_dist</a>()</code>,
<code><a href="#topic+fit_erlang_mixture">fit_erlang_mixture</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_mixture(
  list(
    dist_dirac(0.0),
    dist_exponential()
  )
)

params &lt;- list(
  probs = list(0.1, 0.9),
  dists = list(
    list(),
    list(rate = 1.0)
  )
)

x &lt;- dist$sample(100L, with_params = params)

fit_mixture(dist, x)

</code></pre>

<hr>
<h2 id='fit.reservr_keras_model'>Fit a neural network based distribution model to data</h2><span id='topic+fit.reservr_keras_model'></span>

<h3>Description</h3>

<p>This function delegates most work to <code><a href="keras3.html#topic+fit.keras.src.models.model.Model">keras3::fit.keras.src.models.model.Model()</a></code> and performs additional consistency
checks to make sure <code><a href="#topic+tf_compile_model">tf_compile_model()</a></code> was called with the appropriate options to support fitting the observations
<code>y</code> as well as automatically converting <code>y</code> to a n x 6 matrix needed by the compiled loss function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reservr_keras_model'
fit(
  object,
  x,
  y,
  batch_size = NULL,
  epochs = 10,
  verbose = getOption("keras.fit_verbose", default = 1),
  callbacks = NULL,
  view_metrics = getOption("keras.view_metrics", default = "auto"),
  validation_split = 0,
  validation_data = NULL,
  shuffle = TRUE,
  class_weight = NULL,
  sample_weight = NULL,
  initial_epoch = 0,
  steps_per_epoch = NULL,
  validation_steps = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.reservr_keras_model_+3A_object">object</code></td>
<td>
<p>A compiled <code>reservr_keras_model</code> as obtained by <code><a href="#topic+tf_compile_model">tf_compile_model()</a></code>.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_x">x</code></td>
<td>
<p>A list of input tensors (predictors)</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_y">y</code></td>
<td>
<p>A <code>trunc_obs</code> tibble of observed outcomes, or something convertible via <code><a href="#topic+as_trunc_obs">as_trunc_obs()</a></code>.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_batch_size">batch_size</code></td>
<td>
<p>Integer or <code>NULL</code>.
Number of samples per gradient update.
If unspecified, <code>batch_size</code> will default to <code>32</code>.
Do not specify the <code>batch_size</code> if your data is in the
form of TF Datasets or generators,
(since they generate batches).</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_epochs">epochs</code></td>
<td>
<p>Integer. Number of epochs to train the model.
An epoch is an iteration over the entire <code>x</code> and <code>y</code>
data provided
(unless the <code>steps_per_epoch</code> flag is set to
something other than <code>NULL</code>).
Note that in conjunction with <code>initial_epoch</code>,
<code>epochs</code> is to be understood as &quot;final epoch&quot;.
The model is not trained for a number of iterations
given by <code>epochs</code>, but merely until the epoch
of index <code>epochs</code> is reached.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_verbose">verbose</code></td>
<td>
<p><code>"auto"</code>, <code>0</code>, <code>1</code>, or <code>2</code>. Verbosity mode.
<code>0</code> = silent, <code>1</code> = progress bar, <code>2</code> = one line per epoch.
<code>"auto"</code> becomes 1 for most cases,
<code>2</code> if in a knitr render or running on a distributed training server.
Note that the progress bar is not
particularly useful when logged to a file,
so <code>verbose=2</code> is recommended when not running interactively
(e.g., in a production environment). Defaults to <code>"auto"</code>.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_callbacks">callbacks</code></td>
<td>
<p>List of <code>Callback()</code> instances.
List of callbacks to apply during training.
See <code style="white-space: pre;">&#8288;callback_*&#8288;</code>.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_view_metrics">view_metrics</code></td>
<td>
<p>View realtime plot of training metrics (by epoch). The
default (<code>"auto"</code>) will display the plot when running within RStudio,
<code>metrics</code> were specified during model <code><a href="keras3.html#topic+compile">compile()</a></code>, <code>epochs &gt; 1</code> and
<code>verbose &gt; 0</code>. Set the global <code>options(keras.view_metrics = )</code> option to
establish a different default.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_validation_split">validation_split</code></td>
<td>
<p>Float between 0 and 1.
Fraction of the training data to be used as validation data.
The model will set apart this fraction of the training data,
will not train on it, and will evaluate
the loss and any model metrics
on this data at the end of each epoch.
The validation data is selected from the last samples
in the <code>x</code> and <code>y</code> data provided, before shuffling. This
argument is not supported when <code>x</code> is a TF Dataset or generator.
If both <code>validation_data</code> and <code>validation_split</code> are provided,
<code>validation_data</code> will override <code>validation_split</code>.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_validation_data">validation_data</code></td>
<td>
<p>Data on which to evaluate
the loss and any model metrics at the end of each epoch.
The model will not be trained on this data. Thus, note the fact
that the validation loss of data provided using
<code>validation_split</code> or <code>validation_data</code> is not affected by
regularization layers like noise and dropout.
<code>validation_data</code> will override <code>validation_split</code>.
It could be:
</p>

<ul>
<li><p> A tuple <code style="white-space: pre;">&#8288;(x_val, y_val)&#8288;</code> of arrays or tensors.
</p>
</li>
<li><p> A tuple <code style="white-space: pre;">&#8288;(x_val, y_val, val_sample_weights)&#8288;</code> of
arrays.
</p>
</li>
<li><p> A generator returning
<code style="white-space: pre;">&#8288;(inputs, targets)&#8288;</code> or <code style="white-space: pre;">&#8288;(inputs, targets, sample_weights)&#8288;</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_shuffle">shuffle</code></td>
<td>
<p>Boolean, whether to shuffle the training data
before each epoch. This argument is
ignored when <code>x</code> is a generator or a TF Dataset.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_class_weight">class_weight</code></td>
<td>
<p>Optional named list mapping class indices (integers, 0-based)
to a weight (float) value, used for weighting the loss function
(during training only).
This can be useful to tell the model to
&quot;pay more attention&quot; to samples from
an under-represented class. When <code>class_weight</code> is specified
and targets have a rank of 2 or greater, either <code>y</code> must be
one-hot encoded, or an explicit final dimension of <code>1</code> must
be included for sparse class labels.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_sample_weight">sample_weight</code></td>
<td>
<p>Optional array of weights for
the training samples, used for weighting the loss function
(during training only). You can either pass a flat (1D)
array/vector with the same length as the input samples
(1:1 mapping between weights and samples),
or in the case of temporal data,
you can pass a 2D array (matrix) with shape
<code style="white-space: pre;">&#8288;(samples, sequence_length)&#8288;</code>,
to apply a different weight to every timestep of every sample.
This argument is not supported when <code>x</code> is a TF Dataset or generator,
instead provide the
sample_weights as the third element of <code>x</code>.
Note that sample weighting does not apply to metrics specified
via the <code>metrics</code> argument in <code>compile()</code>. To apply sample
weighting to your metrics, you can specify them via the
<code>weighted_metrics</code> in <code>compile()</code> instead.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_initial_epoch">initial_epoch</code></td>
<td>
<p>Integer.
Epoch at which to start training
(useful for resuming a previous training run).</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_steps_per_epoch">steps_per_epoch</code></td>
<td>
<p>Integer or <code>NULL</code>.
Total number of steps (batches of samples)
before declaring one epoch finished and starting the
next epoch. When training with input tensors such as
backend-native tensors, the default <code>NULL</code> is equal to
the number of samples in your dataset divided by
the batch size, or <code>1</code> if that cannot be determined. If <code>x</code> is a
TF Dataset, and <code>steps_per_epoch</code>
is <code>NULL</code>, the epoch will run until the input dataset is
exhausted.  When passing an infinitely repeating dataset, you
must specify the <code>steps_per_epoch</code> argument. If
<code>steps_per_epoch = -1</code> the training will run indefinitely with an
infinitely repeating dataset.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_validation_steps">validation_steps</code></td>
<td>
<p>Only relevant if <code>validation_data</code> is provided.
Total number of steps (batches of
samples) to draw before stopping when performing validation
at the end of every epoch. If <code>validation_steps</code> is <code>NULL</code>,
validation will run until the <code>validation_data</code> dataset is
exhausted. In the case of an infinitely repeated dataset, it
will run into an infinite loop. If <code>validation_steps</code> is
specified and only part of the dataset will be consumed, the
evaluation will start from the beginning of the dataset at each
epoch. This ensures that the same validation samples are used
every time.</p>
</td></tr>
<tr><td><code id="fit.reservr_keras_model_+3A_...">...</code></td>
<td>
<p>Unused. If old arguments are supplied, an error message will be raised informing how to fix the issue.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additionally, the default <code>batch_size</code> is <code>min(nrow(y), 10000)</code> instead of keras default of <code>32</code> because the latter
is a very bad choice for fitting most distributions since the involved loss is much less stable than typical losses
used in machine learning, leading to divergence for small batch sizes.
</p>


<h3>Value</h3>

<p>A <code>history</code> object that contains all information collected during training.
The model object will be updated in-place as a side-effect.
</p>


<h3>See Also</h3>

<p>predict.reservr_keras_model tf_compile_model keras3::fit.keras.src.models.model.Model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
params &lt;- list(rate = 1.0)
N &lt;- 100L
rand_input &lt;- runif(N)
x &lt;- dist$sample(N, with_params = params)

if (interactive()) {
  tf_in &lt;- keras3::layer_input(1L)
  mod &lt;- tf_compile_model(
    inputs = list(tf_in),
    intermediate_output = tf_in,
    dist = dist,
    optimizer = keras3::optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )

  tf_fit &lt;- fit(
    object = mod,
    x = k_matrix(rand_input),
    y = x,
    epochs = 10L,
    callbacks = list(
      callback_debug_dist_gradients(mod, k_matrix(rand_input), x, keep_grads = TRUE)
    )
  )
}

</code></pre>

<hr>
<h2 id='flatten_params'>Flatten / Inflate parameter lists / vectors</h2><span id='topic+flatten_params'></span><span id='topic+flatten_params_matrix'></span><span id='topic+flatten_bounds'></span><span id='topic+inflate_params'></span>

<h3>Description</h3>

<p>Flatten / Inflate parameter lists / vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten_params(params)

flatten_params_matrix(params)

flatten_bounds(bounds)

inflate_params(flat_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flatten_params_+3A_params">params</code></td>
<td>
<p>A named list of parameters to be flattened.
Should be in a form to be passed as the <code>with_params</code> argument to most
distribution functions.</p>
</td></tr>
<tr><td><code id="flatten_params_+3A_bounds">bounds</code></td>
<td>
<p>List of parameter bounds as returned by
<code>dist$get_param_bounds()</code></p>
</td></tr>
<tr><td><code id="flatten_params_+3A_flat_params">flat_params</code></td>
<td>
<p>A named numeric vector of parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>flatten_params</code> returns a 'flattened' vector of parameters.
It is intended as an adapter for multi-dimensional optimisation functions
to distribution objects.
</p>
<p><code>flatten_params_matrix</code> returns a 'flattened' matrix of parameters.
It is intended as an adapter for multi-dimensional optimisation functions
to distribution objects. Each column corresponds to one input element.
</p>
<p><code>flatten_bounds</code> returns a named list of vectors with names <code>lower</code>
and <code>upper</code>. Containing the upper and lower bounds of each parameter.
</p>
<p><code>inflate_params</code> returns an 'inflated' list of parameters.
This can be passed as the <code>with_params</code> argument to most distribution
functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

mm &lt;- dist_mixture(list(
  dist_exponential(NULL),
  dist_lognormal(0.5, NULL)
), list(NULL, 1))

ph &lt;- mm$get_placeholders()
ph_flat &lt;- flatten_params(ph)
ph_reinflated &lt;- inflate_params(ph_flat)
ph_flat[] &lt;- c(1, 1, 6)
ph_sample &lt;- inflate_params(ph_flat)

x &lt;- mm$sample(
  100,
  with_params = ph_sample
)

emp_cdf &lt;- ecdf(x)

ggplot(data.frame(t = seq(from = min(x), to = max(x), length.out = 100))) %+%
  geom_point(aes(x = t, y = emp_cdf(t))) %+%
  geom_line(aes(x = t, y = mm$probability(t, with_params = ph_sample)),
            linetype = 2)
</code></pre>

<hr>
<h2 id='GenPareto'>The Generalized Pareto Distribution (GPD)</h2><span id='topic+GenPareto'></span><span id='topic+rgpd'></span><span id='topic+dgpd'></span><span id='topic+pgpd'></span><span id='topic+qgpd'></span>

<h3>Description</h3>

<p>These functions provide information about the generalized Pareto distribution
with threshold <code>u</code>. <code>dgpd</code> gives the density, <code>pgpd</code> gives the distribution
function, <code>qgpd</code> gives the quantile function and <code>rgpd</code> generates random
deviates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgpd(n = 1L, u = 0, sigmau = 1, xi = 0)

dgpd(x, u = 0, sigmau = 1, xi = 0, log = FALSE)

pgpd(q, u = 0, sigmau = 1, xi = 0, lower.tail = TRUE, log.p = FALSE)

qgpd(p, u = 0, sigmau = 1, xi = 0, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GenPareto_+3A_n">n</code></td>
<td>
<p>integer number of observations.</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_u">u</code></td>
<td>
<p>threshold parameter (minimum value).</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_sigmau">sigmau</code></td>
<td>
<p>scale parameter (must be positive).</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_xi">xi</code></td>
<td>
<p>shape parameter</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_x">x</code>, <code id="GenPareto_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_log">log</code>, <code id="GenPareto_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities/densities
<code>p</code> are given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<code class="reqn">P(X \le x)</code>, otherwise <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="GenPareto_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>u</code>, <code>sigmau</code> or <code>xi</code> are not specified, they assume the default values of
<code>0</code>, <code>1</code> and <code>0</code> respectively.
</p>
<p>The generalized Pareto distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = 1 / \sigma_u (1 + \xi z)^(- 1 / \xi - 1)</code>
</p>

<p>where <code class="reqn">z = (x - u) / \sigma_u</code> and <code class="reqn">f(x) = exp(-z)</code> if
<code class="reqn">\xi</code> is 0.
The support is <code class="reqn">x \ge u</code> for <code class="reqn">\xi \ge 0</code> and
<code class="reqn">u \le x \le u - \sigma_u / \xi</code> for <code class="reqn">\xi &lt; 0</code>.
</p>
<p>The Expected value exists if <code class="reqn">\xi &lt; 1</code> and is equal to
</p>
<p style="text-align: center;"><code class="reqn">E(X) = u + \sigma_u / (1 - \xi)</code>
</p>

<p>k-th moments exist in general for <code class="reqn">k\xi &lt; 1</code>.
</p>


<h3>Value</h3>

<p><code>rgpd</code> generates random deviates.
</p>
<p><code>dgpd</code> gives the density.
</p>
<p><code>pgpd</code> gives the distribution function.
</p>
<p><code>qgpd</code> gives the quantile function.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Generalized_Pareto_distribution">https://en.wikipedia.org/wiki/Generalized_Pareto_distribution</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rgpd(1000, u = 1, sigmau = 0.5, xi = 0.1)
xx &lt;- seq(-1, 10, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dgpd(xx, u = 1, sigmau = 0.5, xi = 0.1))

plot(xx, dgpd(xx, u = 1, sigmau = 1, xi = 0), type = "l")
lines(xx, dgpd(xx, u = 0.5, sigmau = 1, xi = -0.3), col = "blue", lwd = 2)
lines(xx, dgpd(xx, u = 1.5, sigmau = 1, xi = 0.3), col = "red", lwd = 2)

plot(xx, dgpd(xx, u = 1, sigmau = 1, xi = 0), type = "l")
lines(xx, dgpd(xx, u = 1, sigmau = 0.5, xi = 0), col = "blue", lwd = 2)
lines(xx, dgpd(xx, u = 1, sigmau = 2, xi = 0), col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='integrate_gk'>Adaptive Gauss-Kronrod Quadrature for multiple limits</h2><span id='topic+integrate_gk'></span>

<h3>Description</h3>

<p>Integrates fun over the bounds [ lower, upper ] vectorized over <code>lower</code> and
<code>upper</code>. Vectorized list structures of parameters can also be passed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_gk(
  fun,
  lower,
  upper,
  params = list(),
  .tolerance = .Machine$double.eps^0.25,
  .max_iter = 100L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="integrate_gk_+3A_fun">fun</code></td>
<td>
<p>A function to integrate.
Must be vectorized and take one or two arguments, the first being points to
evaluate at and the second (optionally) being parameters to apply.
It must return a numeric vector the same length as its first input.
</p>
<p>Currently, infinite bounds are not supported.</p>
</td></tr>
<tr><td><code id="integrate_gk_+3A_lower">lower</code>, <code id="integrate_gk_+3A_upper">upper</code></td>
<td>
<p>Integration bounds. Must have the same length.</p>
</td></tr>
<tr><td><code id="integrate_gk_+3A_params">params</code></td>
<td>
<p>Parameters to pass as a second argument to <code>fun</code>.
The actual parameters must have the same length as the number of integrals to
compute. Can be a possibly nested list structures containing numeric vectors.
Alternatively, can be a matrix with the same number of rows as the number of integrals to compute.</p>
</td></tr>
<tr><td><code id="integrate_gk_+3A_.tolerance">.tolerance</code></td>
<td>
<p>Absolute element-wise tolerance.</p>
</td></tr>
<tr><td><code id="integrate_gk_+3A_.max_iter">.max_iter</code></td>
<td>
<p>Maximum number of iterations. The number of
integration intervals will be at most <code>length(lower) * .max_iter</code>. Therefor the maximum
number of function evaluations per integration interval will be
<code>15 * .max_iter</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The integration error is estimated by the Gauss-Kronrod quadrature as the
absolute difference between the 7-point quadrature and the 15-point
quadrature. Integrals that did not converge will be bisected at the midpoint.
The <code>params</code> object will be recursively subsetted on all numeric vectors with
the same length as the number of observations.
</p>


<h3>Value</h3>

<p>A vector of integrals with the i-th entry containing an approximation
of the integral of fun(t, pick_params_at(params, i)) dt over the interval lower[i] to upper[i]
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Argument recycling and parallel integration of two intervals
integrate_gk(sin, 0, c(pi, 2 * pi))

dist &lt;- dist_exponential()
integrate_gk(
  function(x, p) dist$density(x, with_params = p),
  lower = 0, upper = 1:10,
  params = list(rate = 1 / 1:10)
)
dist$probability(1:10, with_params = list(rate = 1 / 1:10))

</code></pre>

<hr>
<h2 id='interval'>Intervals</h2><span id='topic+interval'></span><span id='topic+is.Interval'></span>

<h3>Description</h3>

<p>Intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval(
  range = c(-Inf, Inf),
  ...,
  include_lowest = closed,
  include_highest = closed,
  closed = FALSE,
  integer = FALSE,
  read_only = FALSE
)

is.Interval(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interval_+3A_range">range</code></td>
<td>
<p>The interval boundaries as a sorted two-element numeric vector.</p>
</td></tr>
<tr><td><code id="interval_+3A_...">...</code></td>
<td>
<p>First argument is used as the endpoint if <code>range</code> has length 1.
Additional arguments, or any if <code>range</code> has length 2, cause a warning and
will be ignored.</p>
</td></tr>
<tr><td><code id="interval_+3A_include_lowest">include_lowest</code></td>
<td>
<p>Is the lower boundary part of the interval?</p>
</td></tr>
<tr><td><code id="interval_+3A_include_highest">include_highest</code></td>
<td>
<p>Is the upper boundary part of the interval?</p>
</td></tr>
<tr><td><code id="interval_+3A_closed">closed</code></td>
<td>
<p>Is the interval closed?</p>
</td></tr>
<tr><td><code id="interval_+3A_integer">integer</code></td>
<td>
<p>Is the interval only over the integers?</p>
</td></tr>
<tr><td><code id="interval_+3A_read_only">read_only</code></td>
<td>
<p>Make the interval object read-only?</p>
</td></tr>
<tr><td><code id="interval_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>interval</code> returns an <code>Interval</code>.
<code>is.Interval</code> returns <code>TRUE</code> if <code>x</code> is an <code>Interval</code>, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p>interval-operations
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The real line
interval()

# Closed unit interval
interval(c(0, 1), closed = TRUE)
# Alternative form
interval(0, 1, closed = TRUE)

# Non-negative real line
interval(c(0, Inf), include_lowest = TRUE)
</code></pre>

<hr>
<h2 id='interval-operations'>Convex union and intersection of intervals</h2><span id='topic+interval-operations'></span><span id='topic+interval_union'></span><span id='topic+interval_intersection'></span>

<h3>Description</h3>

<p>Convex union and intersection of intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interval_union(..., intervals = list())

interval_intersection(..., intervals = list())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interval-operations_+3A_...">...</code></td>
<td>
<p>appened to <code>intervals</code> if present.</p>
</td></tr>
<tr><td><code id="interval-operations_+3A_intervals">intervals</code></td>
<td>
<p>A list of <code>Interval</code>s.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>interval_union</code> returns the convex union of all intervals in <code>intervals</code>.
This is the smallest interval completely containing all intervals.
</p>
<p><code>interval_intersection</code> returns the set intersection of all intervals in
<code>intervals</code>. The empty set is represented by the open interval (0, 0).
</p>


<h3>See Also</h3>

<p>interval
</p>


<h3>Examples</h3>

<pre><code class='language-R'>interval_union(
  interval(c(0, 1), closed = TRUE),
  interval(c(1, 2))
)

interval_union(
  interval(c(0, 5)),
  interval(c(1, 4), closed = TRUE)
)

# Convex union is not equal to set union:
interval_union(
  interval(c(0, 1)),
  interval(c(2, 3))
)

# The empty union is {}
interval_union()

interval_intersection(
  interval(c(0, 1)),
  interval(c(0.5, 2))
)

interval_intersection(
  interval(c(0, Inf)),
  interval(c(-Inf, 0))
)

interval_intersection(
  interval(c(0, Inf), include_lowest = TRUE),
  interval(c(-Inf, 0), include_highest = TRUE)
)

interval_intersection(
  interval(c(0, 5)),
  interval(c(1, 6), closed = TRUE)
)

# The empty intersection is (-Inf, Inf)
interval_intersection()
</code></pre>

<hr>
<h2 id='is.Distribution'>Test if object is a Distribution</h2><span id='topic+is.Distribution'></span>

<h3>Description</h3>

<p>Test if object is a Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.Distribution(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.Distribution_+3A_object">object</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if <code>object</code> is a Distribution, <code>FALSE</code> otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.Distribution(dist_dirac())

</code></pre>

<hr>
<h2 id='k_matrix'>Cast to a TensorFlow matrix</h2><span id='topic+k_matrix'></span>

<h3>Description</h3>

<p>Cast to a TensorFlow matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k_matrix(x, dtype = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="k_matrix_+3A_x">x</code></td>
<td>
<p>Numeric object to be converted to a matrix Tensor.</p>
</td></tr>
<tr><td><code id="k_matrix_+3A_dtype">dtype</code></td>
<td>
<p>Type of the elements of the resulting tensor. Defaults to <code><a href="keras3.html#topic+config_floatx">keras3::config_floatx()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A two-dimensional <code>tf.Tensor</code> with values from <code>x</code>.
The shape will be <code style="white-space: pre;">&#8288;(nrow(x), ncol(x))&#8288;</code> where <code>x</code> is first converted to an R matrix via <code><a href="base.html#topic+as.matrix">as.matrix()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  k_matrix(diag(1:3))
  k_matrix(diag(1:3), dtype = "int32")
  # Vectors are converted to columns:
  k_matrix(1:3)
}

</code></pre>

<hr>
<h2 id='Pareto'>The Pareto Distribution</h2><span id='topic+Pareto'></span><span id='topic+rpareto'></span><span id='topic+dpareto'></span><span id='topic+ppareto'></span><span id='topic+qpareto'></span>

<h3>Description</h3>

<p>These functions provide information about the Pareto distribution.
<code>dpareto</code> gives the density, <code>ppareto</code> gives the distribution
function, <code>qpareto</code> gives the quantile function and <code>rpareto</code> generates random
deviates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpareto(n = 1L, shape = 0, scale = 1)

dpareto(x, shape = 1, scale = 1, log = FALSE)

ppareto(q, shape = 1, scale = 1, lower.tail = TRUE, log.p = FALSE)

qpareto(p, shape = 1, scale = 1, lower.tail = TRUE, log.p = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pareto_+3A_n">n</code></td>
<td>
<p>integer number of observations.</p>
</td></tr>
<tr><td><code id="Pareto_+3A_shape">shape</code></td>
<td>
<p>shape parameter (must be positive).</p>
</td></tr>
<tr><td><code id="Pareto_+3A_scale">scale</code></td>
<td>
<p>scale parameter (must be positive).</p>
</td></tr>
<tr><td><code id="Pareto_+3A_x">x</code>, <code id="Pareto_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="Pareto_+3A_log">log</code>, <code id="Pareto_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities/densities
<code>p</code> are given as <code>log(p)</code>.</p>
</td></tr>
<tr><td><code id="Pareto_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are
<code class="reqn">P(X \le x)</code>, otherwise <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="Pareto_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>shape</code> or <code>scale</code> are not specified, they assume the default values of <code>1</code>.
</p>
<p>The Pareto distribution with scale <code class="reqn">\theta</code> and shape <code class="reqn">\xi</code> has density
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \xi \theta^\xi / (x + \theta)^(\xi + 1)</code>
</p>

<p>The support is <code class="reqn">x \ge 0</code>.
</p>
<p>The Expected value exists if <code class="reqn">\xi &gt; 1</code> and is equal to
</p>
<p style="text-align: center;"><code class="reqn">E(X) = \theta / (\xi - 1)</code>
</p>

<p>k-th moments exist in general for <code class="reqn">k &lt; \xi</code>.
</p>


<h3>Value</h3>

<p><code>rpareto</code> generates random deviates.
</p>
<p><code>dpareto</code> gives the density.
</p>
<p><code>ppareto</code> gives the distribution function.
</p>
<p><code>qpareto</code> gives the quantile function.
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Pareto_distribution">https://en.wikipedia.org/wiki/Pareto_distribution</a> - named Lomax therein.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rpareto(1000, shape = 10, scale = 5)
xx &lt;- seq(-1, 10, 0.01)
hist(x, breaks = 100, freq = FALSE, xlim = c(-1, 10))
lines(xx, dpareto(xx, shape = 10, scale = 5))

plot(xx, dpareto(xx, shape = 10, scale = 5), type = "l")
lines(xx, dpareto(xx, shape = 3, scale = 5), col = "red", lwd = 2)

plot(xx, dpareto(xx, shape = 10, scale = 10), type = "l")
lines(xx, dpareto(xx, shape = 10, scale = 5), col = "blue", lwd = 2)
lines(xx, dpareto(xx, shape = 10, scale = 20), col = "red", lwd = 2)

</code></pre>

<hr>
<h2 id='plot_distributions'>Plot several distributions</h2><span id='topic+plot_distributions'></span>

<h3>Description</h3>

<p>Plot several distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_distributions(
  ...,
  distributions = list(),
  .x,
  plots = c("density", "probability", "hazard"),
  with_params = list(),
  as_list = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_distributions_+3A_...">...</code></td>
<td>
<p>distribution objects (must be named)</p>
</td></tr>
<tr><td><code id="plot_distributions_+3A_distributions">distributions</code></td>
<td>
<p>Named list of distribution objects.
This is concatenated with <code>...</code>.</p>
</td></tr>
<tr><td><code id="plot_distributions_+3A_.x">.x</code></td>
<td>
<p>Numeric vector of points to evaluate at.</p>
</td></tr>
<tr><td><code id="plot_distributions_+3A_plots">plots</code></td>
<td>
<p>Plots to be created. May be abbreviated.
The plots will be stacked in the order given from top to bottom.</p>
</td></tr>
<tr><td><code id="plot_distributions_+3A_with_params">with_params</code></td>
<td>
<p>list of distribution parameters to be given to each
distribution using <code>with_params</code>. If named, the names are matched to the
distribution names. Otherwise, they are allocated positionally, index 1
corresponding to the first element of <code>distributions</code>, then all other
elements from <code>distributions</code> followed by the arguments in <code>...</code> in order.</p>
</td></tr>
<tr><td><code id="plot_distributions_+3A_as_list">as_list</code></td>
<td>
<p>return a list of ggplots instead of a patchwork?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A stacked patchwork of the requested ggplots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rate &lt;- 1
x &lt;- rexp(20, rate)
d_emp &lt;- dist_empirical(x, positive = TRUE)
d_exp &lt;- dist_exponential()
plot_distributions(
  empirical = d_emp,
  theoretical = d_exp,
  estimated = d_exp,
  with_params = list(
    theoretical = list(rate = rate),
    estimated = list(rate = 1 / mean(x))
  ),
  .x = seq(1e-4, 5, length.out = 100)
)
</code></pre>

<hr>
<h2 id='predict.reservr_keras_model'>Predict individual distribution parameters</h2><span id='topic+predict.reservr_keras_model'></span>

<h3>Description</h3>

<p>Predict individual distribution parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reservr_keras_model'
predict(object, data, as_matrix = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.reservr_keras_model_+3A_object">object</code></td>
<td>
<p>A compiled and trained <code>reservr_keras_model</code>.</p>
</td></tr>
<tr><td><code id="predict.reservr_keras_model_+3A_data">data</code></td>
<td>
<p>Input data compatible with the model.</p>
</td></tr>
<tr><td><code id="predict.reservr_keras_model_+3A_as_matrix">as_matrix</code></td>
<td>
<p>Return a parameter matrix instead of a list structure?</p>
</td></tr>
<tr><td><code id="predict.reservr_keras_model_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A parameter list suitable for the <code>with_params</code> argument of the distribution family used for the model.
Contains one set of parameters per row in <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
  dist &lt;- dist_exponential()
  params &lt;- list(rate = 1.0)
  N &lt;- 100L
  rand_input &lt;- runif(N)
  x &lt;- dist$sample(N, with_params = params)

  tf_in &lt;- keras3::layer_input(1L)
  mod &lt;- tf_compile_model(
    inputs = list(tf_in),
    intermediate_output = tf_in,
    dist = dist,
    optimizer = keras3::optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )

  tf_fit &lt;- fit(
    object = mod,
    x = k_matrix(rand_input),
    y = x,
    epochs = 10L,
    callbacks = list(
      callback_debug_dist_gradients(mod, k_matrix(rand_input), x)
    )
  )

  tf_preds &lt;- predict(mod, data = k_matrix(rand_input))
}

</code></pre>

<hr>
<h2 id='prob_report'>Determine probability of reporting under a Poisson arrival Process</h2><span id='topic+prob_report'></span>

<h3>Description</h3>

<p>Determines the probability that claims occuring under a Poisson process with
arrival intensity <code>expo</code> and reporting delay distribution <code>dist</code> during the
time between <code>t_min</code> and <code>t_max</code> are reported between <code>tau_min</code> and
<code>tau_max</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_report(
  dist,
  intervals,
  expo = NULL,
  with_params = list(),
  .tolerance = .Machine$double.eps^0.5,
  .max_iter = 100L,
  .try_compile = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_report_+3A_dist">dist</code></td>
<td>
<p>A reporting delay Distribution, or a compiled interval probability function.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_intervals">intervals</code></td>
<td>
<p>A data frame with columns <code>xmin</code>, <code>xmax</code>, <code>tmin</code>, <code>tmax</code>.
Claims occur within <code style="white-space: pre;">&#8288;[xmin, xmax]&#8288;</code> and be reported within <code style="white-space: pre;">&#8288;[tmin, tmax]&#8288;</code>.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_expo">expo</code></td>
<td>
<p>Poisson intensity. If given, must be a vectorised function that
yields the intensity of the claim arrival process at a specified time.
<code>expo = NULL</code> is equivalent to a constant intensity function. <code>expo</code> is only
relevant up to a multiplicative constant.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_with_params">with_params</code></td>
<td>
<p>Parameters of <code>dist</code> to use. Can be a parameter set with
different values for each interval. If <code>dist</code> is a compiled interval probability function, <code>with_params</code> can be a
matrix instead.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_.tolerance">.tolerance</code></td>
<td>
<p>Absolute element-wise tolerance.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_.max_iter">.max_iter</code></td>
<td>
<p>Maximum number of iterations. The number of
integration intervals will be at most <code>length(lower) * .max_iter</code>. Therefor the maximum
number of function evaluations per integration interval will be
<code>15 * .max_iter</code>.</p>
</td></tr>
<tr><td><code id="prob_report_+3A_.try_compile">.try_compile</code></td>
<td>
<p>Try compiling the distributions probability function to speed up integration?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The reporting probability is given by
</p>
<p>P(x + d in [tmin, tmax] | x in [xmin, xmax])
= E(P(x + d in [tmin, tmax] | x) | x in [xmin, xmax]) /
P(x in [xmin, xmax])
= int_[xmin, xmax] expo(x) P(x + d in [tmin, tmax]) dx
= int_[xmin, xmax] expo(x) P(d in [tmin - x, tmax - x]) dx /
int_[xmin, xmax] expo(x) dx
</p>
<p><code>prob_report</code> uses <code><a href="#topic+integrate_gk">integrate_gk()</a></code> to compute the two integrals.
</p>


<h3>Value</h3>

<p>A vector of reporting probabilities, with one entry per row of <code>intervals</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
ints &lt;- data.frame(
  xmin = 0,
  xmax = 1,
  tmin = seq_len(10) - 1.0,
  tmax = seq_len(10)
)
params &lt;- list(rate = rep(c(1, 0.5), each = 5))

prob_report(dist, ints, with_params = params)

</code></pre>

<hr>
<h2 id='quantile.Distribution'>Quantiles of Distributions</h2><span id='topic+quantile.Distribution'></span>

<h3>Description</h3>

<p>Produces quantiles corresponding to the given probabilities with configurable distribution parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Distribution'
quantile(x, probs = seq(0, 1, 0.25), with_params = list(), ..., .start = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile.Distribution_+3A_x">x</code></td>
<td>
<p>A <code>Distribution</code>.</p>
</td></tr>
<tr><td><code id="quantile.Distribution_+3A_probs">probs</code></td>
<td>
<p>Quantiles to compute.</p>
</td></tr>
<tr><td><code id="quantile.Distribution_+3A_with_params">with_params</code></td>
<td>
<p>Optional list of distribution parameters. Note that if <code>x$has_capability("quantile")</code> is false,
<code>with_params</code> is assumed to contain only one set of parameters.</p>
</td></tr>
<tr><td><code id="quantile.Distribution_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="quantile.Distribution_+3A_.start">.start</code></td>
<td>
<p>Starting value if quantiles are computed numerically. Must be within the support of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x$has_capability("quantile")</code> is true, this returns the same as <code>x$quantile(probs, with_params = with_params)</code>.
In this case, <code>with_params</code> may contain separate sets of parameters for each quantile to be determined.
</p>
<p>Otherwise, a numerical estimation of the quantiles is done using the density and probability function.
This method assumes <code>with_params</code> to cantain only one set of parameters.
The strategy uses two steps:
</p>

<ol>
<li><p> Find the smallest and largest quantiles in <code>probs</code> using a newton method starting from <code>.start</code>.
</p>
</li>
<li><p> Find the remaining quantiles with bisection using <code><a href="stats.html#topic+uniroot">stats::uniroot()</a></code>.
</p>
</li></ol>



<h3>Value</h3>

<p>The quantiles of <code>x</code> corresponding to <code>probs</code> with parameters <code>with_params</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># With quantiles available
dist &lt;- dist_normal(sd = 1)
qqs &lt;- quantile(dist, probs = rep(0.5, 3), with_params = list(mean = 1:3))
stopifnot(all.equal(qqs, 1:3))

# Without quantiles available
dist &lt;- dist_erlangmix(shapes = list(1, 2, 3), scale = 1.0)
my_probs &lt;- c(0, 0.01, 0.25, 0.5, 0.75, 1)
qqs &lt;- quantile(
  dist, probs = my_probs,
  with_params = list(probs = list(0.5, 0.3, 0.2)), .start = 2
)

all.equal(dist$probability(qqs, with_params = list(probs = list(0.5, 0.3, 0.2))), my_probs)
# Careful: Numerical estimation of extreme quantiles can result in out-of-bounds values.
# The correct 0-quantile would be 0 in this case, but it was estimated &lt; 0.
qqs[1L]

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+fit'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+fit">fit</a></code></p>
</dd>
</dl>

<hr>
<h2 id='softmax'>Soft-Max function</h2><span id='topic+softmax'></span><span id='topic+dsoftmax'></span>

<h3>Description</h3>

<p>Softmax for a vector x is defined as
</p>


<h3>Usage</h3>

<pre><code class='language-R'>softmax(x)

dsoftmax(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="softmax_+3A_x">x</code></td>
<td>
<p>A numeric vector or matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">s_i = \exp(x_i) / \sum_k \exp(x_k)</code>
</p>
<p>It satisfies <code>sum(s) == 1.0</code> and can be used to smoothly enforce a sum
constraint.
</p>


<h3>Value</h3>

<p><code>softmax</code> returns the softmax of <code>x</code>; rowwise if <code>x</code> is a matrix.
</p>
<p><code>dsoftmax</code> returns the Jacobi-matrix of <code>softmax(x)</code> at <code>x</code>. <code>x</code> must be a vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>softmax(c(5, 5))
softmax(diag(nrow = 5, ncol = 6))
</code></pre>

<hr>
<h2 id='tf_compile_model'>Compile a Keras model for truncated data under dist</h2><span id='topic+tf_compile_model'></span>

<h3>Description</h3>

<p>Compile a Keras model for truncated data under dist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tf_compile_model(
  inputs,
  intermediate_output,
  dist,
  optimizer,
  censoring = TRUE,
  truncation = TRUE,
  metrics = NULL,
  weighted_metrics = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tf_compile_model_+3A_inputs">inputs</code></td>
<td>
<p>List of keras input layers</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_intermediate_output">intermediate_output</code></td>
<td>
<p>Intermediate model layer to be used as input to
distribution parameters</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_dist">dist</code></td>
<td>
<p>A <code>Distribution</code> to use for compiling the loss and parameter
outputs</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_optimizer">optimizer</code></td>
<td>
<p>String (name of optimizer) or optimizer instance. See
<code style="white-space: pre;">&#8288;optimizer_*&#8288;</code> family.</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_censoring">censoring</code></td>
<td>
<p>A flag, whether the compiled model should support censored
observations. Set to <code>FALSE</code> for higher efficiency. <code>fit(...)</code> will error if
the resulting model is used to fit censored observations.</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_truncation">truncation</code></td>
<td>
<p>A flag, whether the compiled model should support truncated
observations. Set to <code>FALSE</code> for higher efficiency. <code>fit(...)</code> will warn if
the resuting model is used to fit truncated observations.</p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_metrics">metrics</code></td>
<td>
<p>List of metrics to be evaluated by the model during
training and testing. Each of these can be:
</p>

<ul>
<li><p> a string (name of a
built-in function),
</p>
</li>
<li><p> a function, optionally with a <code>"name"</code> attribute or
</p>
</li>
<li><p> a <code><a href="keras3.html#topic+Metric">Metric()</a></code>
instance. See the <code style="white-space: pre;">&#8288;metric_*&#8288;</code> family of functions.
</p>
</li></ul>

<p>Typically you will use
<code>metrics = c('accuracy')</code>. A function is any callable with the
signature <code>result = fn(y_true, y_pred)</code>. To specify different
metrics for different outputs of a multi-output model, you could
also pass a named list, such as
<code>metrics = list(a = 'accuracy', b = c('accuracy', 'mse'))</code>.
You can also pass a list to specify a metric or a list of
metrics for each output, such as
<code>metrics = list(c('accuracy'), c('accuracy', 'mse'))</code>
or <code>metrics = list('accuracy', c('accuracy', 'mse'))</code>. When you pass
the strings <code>'accuracy'</code> or <code>'acc'</code>, we convert this to one of
<code>metric_binary_accuracy()</code>,
<code>metric_categorical_accuracy()</code>,
<code>metric_sparse_categorical_accuracy()</code> based on the
shapes of the targets and of the model output. A similar
conversion is done for the strings <code>"crossentropy"</code>
and <code>"ce"</code> as well.
The metrics passed here are evaluated without sample weighting;
if you would like sample weighting to apply, you can specify
your metrics via the <code>weighted_metrics</code> argument instead.
</p>
<p>If providing an anonymous R function, you can customize the printed name
during training by assigning <code style="white-space: pre;">&#8288;attr(&lt;fn&gt;, "name") &lt;- "my_custom_metric_name"&#8288;</code>,
or by calling <code><a href="keras3.html#topic+custom_metric">custom_metric(&quot;my_custom_metric_name&quot;, &lt;fn&gt;)</a></code></p>
</td></tr>
<tr><td><code id="tf_compile_model_+3A_weighted_metrics">weighted_metrics</code></td>
<td>
<p>List of metrics to be evaluated and weighted by
<code>sample_weight</code> or <code>class_weight</code> during training and testing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>reservr_keras_model</code> that can be used to train truncated
and censored observations from <code>dist</code> based on input data from <code>inputs</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
params &lt;- list(rate = 1.0)
N &lt;- 100L
rand_input &lt;- runif(N)
x &lt;- dist$sample(N, with_params = params)

if (interactive()) {
  tf_in &lt;- keras3::layer_input(1L)
  mod &lt;- tf_compile_model(
    inputs = list(tf_in),
    intermediate_output = tf_in,
    dist = dist,
    optimizer = keras3::optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )
}

</code></pre>

<hr>
<h2 id='tf_initialise_model'>Initialise model weights to a global parameter fit</h2><span id='topic+tf_initialise_model'></span>

<h3>Description</h3>

<p>Initialises a compiled <code>reservr_keras_model</code> weights such that the predictions are equal to, or close to, the
distribution parameters given by <code>params</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tf_initialise_model(
  model,
  params,
  mode = c("scale", "perturb", "zero", "none")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tf_initialise_model_+3A_model">model</code></td>
<td>
<p>A <code>reservr_compiled_model</code> obtained by <code><a href="#topic+tf_compile_model">tf_compile_model()</a></code>.</p>
</td></tr>
<tr><td><code id="tf_initialise_model_+3A_params">params</code></td>
<td>
<p>A list of distribution parameters compatible with <code>model</code>.</p>
</td></tr>
<tr><td><code id="tf_initialise_model_+3A_mode">mode</code></td>
<td>
<p>An initialisation mode
</p>

<dl>
<dt>scale</dt><dd><p>Initialise the biases according to <code>params</code> and the kernels uniform on [-0.1, 0.1] *
bias scale.</p>
</dd>
<dt>perturb</dt><dd><p>Initialise the biases according to <code>params</code> and leave the kernels as is.</p>
</dd>
<dt>zero</dt><dd><p>Initialise the biases according to <code>params</code> and set the kernel to zero.</p>
</dd>
<dt>none</dt><dd><p>Don't modify the weights.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly <code>model</code> with changed weights
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- dist_exponential()
group &lt;- sample(c(0, 1), size = 100, replace = TRUE)
x &lt;- dist$sample(100, with_params = list(rate = group + 1))
global_fit &lt;- fit(dist, x)

if (interactive()) {
  library(keras3)
  l_in &lt;- layer_input(shape = 1L)
  mod &lt;- tf_compile_model(
    inputs = list(l_in),
    intermediate_output = l_in,
    dist = dist,
    optimizer = optimizer_adam(),
    censoring = FALSE,
    truncation = FALSE
  )
  tf_initialise_model(mod, global_fit$params)
  fit_history &lt;- fit(
    mod,
    x = group,
    y = x,
    epochs = 200L
  )

  predicted_means &lt;- predict(mod, data = as_tensor(c(0, 1), config_floatx()))
}

</code></pre>

<hr>
<h2 id='trunc_obs'>Define a set of truncated observations</h2><span id='topic+trunc_obs'></span><span id='topic+as_trunc_obs'></span><span id='topic+truncate_obs'></span><span id='topic+repdel_obs'></span>

<h3>Description</h3>

<p>If <code>x</code> is missing, both <code>xmin</code> and <code>xmax</code> must be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trunc_obs(x, xmin = x, xmax = x, tmin = -Inf, tmax = Inf, w = 1)

as_trunc_obs(.data)

truncate_obs(.data, tmin_new = -Inf, tmax_new = Inf, .partial = FALSE)

repdel_obs(.data, accident, delay, time, .truncate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trunc_obs_+3A_x">x</code></td>
<td>
<p>Observations</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_xmin">xmin</code>, <code id="trunc_obs_+3A_xmax">xmax</code></td>
<td>
<p>Censoring bounds. If <code>xmin != xmax</code>, <code>x</code> must be <code>NA</code>.</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_tmin">tmin</code>, <code id="trunc_obs_+3A_tmax">tmax</code></td>
<td>
<p>Truncation bounds. May vary per observation.</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_w">w</code></td>
<td>
<p>Case weights</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_.data">.data</code></td>
<td>
<p>A data frame or numeric vector.</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_tmin_new">tmin_new</code></td>
<td>
<p>New truncation minimum</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_tmax_new">tmax_new</code></td>
<td>
<p>New truncation maximum</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_.partial">.partial</code></td>
<td>
<p>Enable partial truncation of censored observations?
This could potentially create inconsistent data if the actual observation
lies outside of the truncation bounds but the censoring interval overlaps.</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_accident">accident</code></td>
<td>
<p>accident time (unquoted, evaluated in <code>.data</code>)</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_delay">delay</code></td>
<td>
<p>reporting delay (unquoted, evaluated in <code>.data</code>)</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_time">time</code></td>
<td>
<p>evaluation time (unquoted, evaluated in <code>.data</code>)</p>
</td></tr>
<tr><td><code id="trunc_obs_+3A_.truncate">.truncate</code></td>
<td>
<p>Should claims reported after <code>time</code> be silently discarded?
If there are claims reported after <code>time</code> and <code>.truncate</code> is <code>FALSE</code>,
an error will be raised.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uncensored observations must satisfy <code>tmin &lt;= xmin = x = xmax &lt;= tmax</code>.
Censored observations must satisfy <code style="white-space: pre;">&#8288;tmin &lt;= xmin &lt; xmax &lt;= tmax&#8288;</code> and <code>x = NA</code>.
</p>


<h3>Value</h3>

<p><strong>trunc_obs</strong>: A <code>trunc_obs</code> tibble with columns <code>x</code>, <code>xmin</code>, <code>xmax</code>,
<code>tmin</code> and <code>tmax</code> describing possibly interval-censored observations with
truncation
</p>
<p><code>as_trunc_obs</code> returns a <code>trunc_obs</code> tibble.
</p>
<p><code>truncate_obs</code> returns a <code>trunc_obs</code> tibble with possibly fewer
observations than <code>.data</code> and updated truncation bounds.
</p>
<p><code>repdel_obs</code> returns a <code>trunc_obs</code> tibble corresponding to the reporting
delay observations of each claim. If <code>.truncate</code> is <code>FALSE</code>, the result is
guaranteed to have the same number of rows as <code>.data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 100
x &lt;- rexp(N, 0.5)

# Random, observation dependent truncation intervals
tmin &lt;- runif(N, 0, 1)
tmax &lt;- tmin + runif(N, 1, 2)

oob &lt;- x &lt; tmin | x &gt; tmax
x &lt;- x[!oob]
tmin &lt;- tmin[!oob]
tmax &lt;- tmax[!oob]

# Number of observations after truncation
N &lt;- length(x)

# Randomly interval censor 30% of observations
cens &lt;- rbinom(N, 1, 0.3) == 1L
xmin &lt;- x
xmax &lt;- x
xmin[cens] &lt;- pmax(tmin[cens], floor(x[cens]))
xmax[cens] &lt;- pmin(tmax[cens], ceiling(x[cens]))
x[cens] &lt;- NA

trunc_obs(x, xmin, xmax, tmin, tmax)

as_trunc_obs(c(1, 2, 3))
as_trunc_obs(data.frame(x = 1:3, tmin = 0, tmax = 10))
as_trunc_obs(data.frame(x = c(1, NA), xmin = c(1, 2), xmax = c(1, 3)))
truncate_obs(1:10, tmin_new = 2.0, tmax_new = 8.0)
</code></pre>

<hr>
<h2 id='truncate_claims'>Truncate claims data subject to reporting delay</h2><span id='topic+truncate_claims'></span>

<h3>Description</h3>

<p>Truncate claims data subject to reporting delay
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncate_claims(data, accident, delay, time, .report_col = "report")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="truncate_claims_+3A_data">data</code></td>
<td>
<p>Full claims data including IBNR</p>
</td></tr>
<tr><td><code id="truncate_claims_+3A_accident">accident</code></td>
<td>
<p>Accident times. May be an unquoted column name from <code>data</code>.</p>
</td></tr>
<tr><td><code id="truncate_claims_+3A_delay">delay</code></td>
<td>
<p>Reporting delays. May be an unquoted column name from <code>data</code>.</p>
</td></tr>
<tr><td><code id="truncate_claims_+3A_time">time</code></td>
<td>
<p>Observation time (scalar number or one per claim).
Claims with <code>accident + delay &gt; time</code> will be truncated.
Set <code>time = Inf</code> to only compute reporting times and perform no truncation.</p>
</td></tr>
<tr><td><code id="truncate_claims_+3A_.report_col">.report_col</code></td>
<td>
<p><code>NULL</code> or a column name to store the reporting time
<code>report = accident + delay</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Truncated <code>data</code>.
The reporting time is stored in a colnumn named by <code>.report_col</code> unless
<code>.report_col</code> is <code>NULL</code>.
If both <code>.report_col</code> is <code>NULL</code> and <code>time</code> contains only <code>Inf</code>s,
a warning will be issued since <code>data</code> will be
returned unchanged and no work will be done.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>claims_full &lt;- data.frame(
  acc = runif(100),
  repdel = rexp(100)
)
tau &lt;- 2.0
truncate_claims(claims_full, acc, repdel, tau)

</code></pre>

<hr>
<h2 id='weighted_moments'>Compute weighted moments</h2><span id='topic+weighted_moments'></span>

<h3>Description</h3>

<p>Compute weighted moments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_moments(x, w, n = 2L, center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted_moments_+3A_x">x</code></td>
<td>
<p>Observations</p>
</td></tr>
<tr><td><code id="weighted_moments_+3A_w">w</code></td>
<td>
<p>Case weights (optional)</p>
</td></tr>
<tr><td><code id="weighted_moments_+3A_n">n</code></td>
<td>
<p>Number of moments to calculate</p>
</td></tr>
<tr><td><code id="weighted_moments_+3A_center">center</code></td>
<td>
<p>Calculate centralized moments (default) or noncentralized
moments, i.e. E((X - E(X))^k) or E(X^k).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>n</code> where the <code>k</code>th entry is the <code>k</code>th weighted
moment of <code>x</code> with weights <code>w</code>. If <code>center</code> is <code>TRUE</code> the moments are
centralized, i.e. E((X - E(X))^k). The first moment is never centralized.
The moments are scaled with 1 / sum(w), so they are not de-biased.
</p>
<p>e.g. the second central weighted moment
<code>weighted_moment(x, w)[2L]</code>
is equal to
<code>var(rep(x, w)) * (sum(w) - 1) / sum(w)</code>
for integer <code>w</code>
</p>


<h3>See Also</h3>

<p>Other weighted statistics: 
<code><a href="#topic+weighted_quantile">weighted_quantile</a>()</code>,
<code><a href="#topic+weighted_tabulate">weighted_tabulate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weighted_moments(rexp(100))
weighted_moments(c(1, 2, 3), c(1, 2, 3))
c(mean(rep(1:3, 1:3)), var(rep(1:3, 1:3)) * 5 / 6)
</code></pre>

<hr>
<h2 id='weighted_quantile'>Compute weighted quantiles</h2><span id='topic+weighted_quantile'></span><span id='topic+weighted_median'></span>

<h3>Description</h3>

<p>Compute weighted quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_quantile(x, w, probs)

weighted_median(x, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted_quantile_+3A_x">x</code></td>
<td>
<p>Observations</p>
</td></tr>
<tr><td><code id="weighted_quantile_+3A_w">w</code></td>
<td>
<p>Case weights (optional)</p>
</td></tr>
<tr><td><code id="weighted_quantile_+3A_probs">probs</code></td>
<td>
<p>Quantiles to calculate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector the same length as <code>probs</code> with the corresponding weighted
quantiles of <code>x</code> with weight <code>w</code>. For integer weights, this is equivalent to
<code>quantile(rep(x, w), probs)</code>
</p>
<p>The weighted median of <code>x</code> with weights <code>w</code>.
For integer weights, this is equivalent to <code>median(rep(x, w))</code>
</p>


<h3>See Also</h3>

<p>Other weighted statistics: 
<code><a href="#topic+weighted_moments">weighted_moments</a>()</code>,
<code><a href="#topic+weighted_tabulate">weighted_tabulate</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weighted_median(1:6)
weighted_median(1:3, c(1, 4, 9))
weighted_median(1:3, c(9, 4, 1))

weighted_quantile(1:3, c(1, 4, 9), seq(0.0, 1.0, by = 0.25))
quantile(rep(1:3, c(1, 4, 9)), seq(0.0, 1.0, by = 0.25))
</code></pre>

<hr>
<h2 id='weighted_tabulate'>Compute weighted tabulations</h2><span id='topic+weighted_tabulate'></span>

<h3>Description</h3>

<p>Computes the sum of <code>w</code> grouped by <code>bin</code>.
If <code>w</code> is missing the result is equivalent to
<code><a href="base.html#topic+tabulate">tabulate(bin, nbins)</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted_tabulate(bin, w, nbins = max(1L, bin, na.rm = TRUE))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted_tabulate_+3A_bin">bin</code></td>
<td>
<p>An integer vector with values from <code>1L</code> to <code>nbins</code></p>
</td></tr>
<tr><td><code id="weighted_tabulate_+3A_w">w</code></td>
<td>
<p>Weights per entry in <code>bin</code>.</p>
</td></tr>
<tr><td><code id="weighted_tabulate_+3A_nbins">nbins</code></td>
<td>
<p>Number of bins</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with length <code>nbins</code> where the <code>i</code>th result is equal to
<code>sum(w[bin == i])</code> or <code>sum(bin == i)</code> if <code>w</code> is missing.
For integer weights, this is equivalent to <code>tabulate(rep(bin, w), nbins)</code>.
</p>


<h3>See Also</h3>

<p>Other weighted statistics: 
<code><a href="#topic+weighted_moments">weighted_moments</a>()</code>,
<code><a href="#topic+weighted_quantile">weighted_quantile</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weighted_tabulate(c(1, 1, 2))
weighted_tabulate(c(1, 1, 2), nbins = 3L)
weighted_tabulate(c(1, 1, 2), w = c(0.5, 0.5, 1), nbins = 3L)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
