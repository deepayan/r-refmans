<!DOCTYPE html><html><head><title>Help for package demogR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {demogR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.ro'><p> Caclulate net reproduction number from a demographic</p>
projection matrix</a></li>
<li><a href='#cdmltw'><p> Coale-Demeny Model Life Tables</p></a></li>
<li><a href='#coale'><p> coale</p></a></li>
<li><a href='#cohort'><p> cohort</p></a></li>
<li><a href='#demogR-package'>
<p>Demographic analysis in R</p>
</p></a></li>
<li><a href='#eigen.analysis'><p> eigen.analysis</p></a></li>
<li><a href='#elassens'><p>elassens</p></a></li>
<li><a href='#fullsecder'><p> fullsecder</p></a></li>
<li><a href='#gen.time'><p> gen.time</p></a></li>
<li><a href='#goodman'><p> Demographic data from Venezuela, Madagascar and the United</p>
States in the late 1960s</a></li>
<li><a href='#keyfitz'><p> keyfitz</p></a></li>
<li><a href='#lams'><p> lams</p></a></li>
<li><a href='#leslie.matrix'><p> Leslie Matrix</p></a></li>
<li><a href='#leslie.row1'><p> leslie.row1</p></a></li>
<li><a href='#life.table'><p> life.table</p></a></li>
<li><a href='#loop.elas'><p> loop.elas</p></a></li>
<li><a href='#m2v'><p> m2v</p></a></li>
<li><a href='#odiag'><p> odiag</p></a></li>
<li><a href='#plot.leslie.matrix'><p> plot.leslie.matrix</p></a></li>
<li><a href='#project.leslie'><p> project.leslie</p></a></li>
<li><a href='#secder'><p>secder</p></a></li>
<li><a href='#stoch.sens'><p> stoch.sens</p></a></li>
<li><a href='#thar'><p> thar</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Age-Structured Demographic Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-09-13</td>
</tr>
<tr>
<td>Author:</td>
<td>James Holland Jones [aut] &lt;jhj1@stanford.edu&gt;, Jim Oeppen [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hana Sevcikova &lt;hanas@uw.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Construction and analysis of matrix population models in R.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-09-14 18:05:19 UTC; hana</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-09-14 20:30:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc.ro'> Caclulate net reproduction number from a demographic
projection matrix  </h2><span id='topic+calc.ro'></span>

<h3>Description</h3>

<p>Calculate the net reproduction number (<code class="reqn">R_0</code>) from an age or
stage-classified demographic projection matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.ro(A, N.out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.ro_+3A_a">A</code></td>
<td>
<p> A demographic projection matrix </p>
</td></tr>
<tr><td><code id="calc.ro_+3A_n.out">N.out</code></td>
<td>
<p> Return the fundamental matrix (N) of the Markov chain? </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the net reproduction number (<code class="reqn">R_0</code>) from an age or
stage-classified demographic projection matrix by first decomposing
the k x k projection matrix A into two component matrices, T and F.  T
collects the transitions between life-cycle stages while F collects
the fertility transitions.  For an age-classified Leslie matrix, T
will contain only the sub-diagonal of A and F will contain only the
first row of A.  The fundamental matrix is given by <code class="reqn">N = (I-T)^{-1}</code>,
where I is a k x k identity matrix.  <code class="reqn">R_0</code> is the leading eigenvalue
of the matrix FN.
</p>


<h3>Value</h3>

<p>If the (default) option N.out=FALSE is used, the net reproduction number is returned as a
single value.  If N.out=TRUE, the returned value is a list of two items:
</p>
<table>
<tr><td><code>ro</code></td>
<td>
<p>Net reproduction number</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Fundamental matrix</p>
</td></tr>
</table>
<p>...
</p>


<h3>Author(s)</h3>

<p> James Holland Jones </p>


<h3>References</h3>

 
<p>Caswell, H. 2001. Matrix population models: construction, analysis,
and interpretation, Second edition. Sinauer, Sunderland,
Massachusetts, USA.
</p>


<h3>See Also</h3>

<p> see <code><a href="#topic+leslie.matrix">leslie.matrix</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a Leslie matrix
Px &lt;- c(0.77, 0.95, 0.98, 0.97)
Fx &lt;- c(0,0,1,1.2,1)
L &lt;- odiag(Px,-1)
L[1,] &lt;- Fx
## Calculate R_0
calc.ro(L)
## look at the fundamental matrix
calc.ro(L, N.out=TRUE)
</code></pre>

<hr>
<h2 id='cdmltw'> Coale-Demeny Model Life Tables </h2><span id='topic+cdmltw'></span><span id='topic+cdmlte'></span><span id='topic+cdmlts'></span><span id='topic+cdmltn'></span>

<h3>Description</h3>

<p>Coale-Demeny regional model life tables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdmltw(sex = "F")
cdmlte(sex = "F")
cdmlts(sex = "F")
cdmltn(sex = "F")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdmltw_+3A_sex">sex</code></td>
<td>
<p> female or male life tables.  Defaults to 'F' (female). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides region-specific model life tables for 25 different levels of mortality,
indexed by life expectancy at age 10 (with 1 being the lowest and 25
being the highest life expectancy at age 10). 
</p>
<p>The regions are West (<code>cdmltw</code>), East (<code>cdmlte</code>), South (<code>cdmlts</code>), and North (<code>cdmltn</code>).
</p>


<h3>Value</h3>

<p>A list containing two 21 element vectors, one 25 element vector and eight 25 x 21 matrices:
25 mortality levels by 21 age classes.  The eight matrices contain
the standard columns of a life table for each mortality level:
</p>
<table>
<tr><td><code>age</code></td>
<td>
<p> the 21 age classes </p>
</td></tr>
<tr><td><code>width</code></td>
<td>
<p>widths of the 21 age classes</p>
</td></tr>
<tr><td><code>e10</code></td>
<td>
<p> the 25 mortality levels as life expectancy at age 10</p>
</td></tr>
<tr><td><code>lx</code></td>
<td>
<p>survival probabilities to exact age x </p>
</td></tr>
<tr><td><code>nqx</code></td>
<td>
<p> probabilities of death between ages x and x+n</p>
</td></tr>
<tr><td><code>nax</code></td>
<td>
<p> person-years lived by those dying between ages x and
x+n </p>
</td></tr>
<tr><td><code>ndx</code></td>
<td>
<p> proportion of all deaths occurring between ages x and
x+n </p>
</td></tr>
<tr><td><code>nLx</code></td>
<td>
<p> person-years lived in the interval x to x+n </p>
</td></tr>
<tr><td><code>nmx</code></td>
<td>
<p> central death rate in the interval x to x+n</p>
</td></tr>
<tr><td><code>Tx</code></td>
<td>
<p> person-years of life remaining to the cohort at age x </p>
</td></tr>
<tr><td><code>ex</code></td>
<td>
<p> life expectancy at age x </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Kenneth Wachter, Department of Demography, University of
California, Berkeley.
</p>
<p>Modified by James Holland Jones, Department of Anthropological
Sciences, Stanford University
</p>
<p>Corrected by Jim Oeppen, Southern Denmark University, Odense, Denmark
</p>


<h3>References</h3>

 
<p>Coale, A., P. Demeny, and B. Vaughn. 1983. Regional model life tables
and stable populations. 2nd ed. New York: Academic Press.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+life.table">life.table</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate West model life table family for females
Wf &lt;- cdmltw()

## Plot survivorship for the 25 levels
plot(Wf$age,Wf$lx[1,], type="l", xlab="Age", ylab="Survivorship")
for(i in 2:25) lines(Wf$age, Wf$lx[i,])
</code></pre>

<hr>
<h2 id='coale'> coale </h2><span id='topic+coale'></span>

<h3>Description</h3>

<p>Utility used by <code>life.table</code> to graduate the person-years lived
by those dying in the interval by the method of Coale and Demeny. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coale(b1, b4, nMx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coale_+3A_b1">b1</code></td>
<td>
<p> two element vector of regression coefficients for
graduating 1a0 provided in  Coale et al. (1983) </p>
</td></tr>
<tr><td><code id="coale_+3A_b4">b4</code></td>
<td>
<p> two element vector of regression coefficients for
graduating 4a1 provided in  Coale et al. (1983) </p>
</td></tr>
<tr><td><code id="coale_+3A_nmx">nMx</code></td>
<td>
<p> period central death rates: <code>=nDx/nKx</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Utility function called by <code>life.table</code>.
</p>


<h3>Value</h3>

<p>The first two values (age classes 0-1 and 1-5) of the nax column of
a period life table.
</p>


<h3>References</h3>

 
<p>Coale, A., P. Demeny, and B. Vaughn. 1983. Regional model life tables
and stable populations. 2nd ed. New York: Academic Press.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+life.table">life.table</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
vlt1 &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx, type="cd"))

</code></pre>

<hr>
<h2 id='cohort'> cohort </h2><span id='topic+cohort'></span>

<h3>Description</h3>

<p>Dummy function called in <code>life.table</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cohort(width12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cohort_+3A_width12">width12</code></td>
<td>
<p> width of the first two age classes </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is essentially a place-holder function used when passing the
option <code>type="cohort"</code> to <code>life.table</code>.
</p>


<h3>Value</h3>

<p>A two element vector representing the first two values of the nax
column of the life table.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+life.table">life.table</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(thar)
thar.lt &lt;- with(thar, life.table(x=age, nDx=deaths, nKx=count, 
    type="cohort", iwidth=1, width12=c(1,1)))
thar.lt
</code></pre>

<hr>
<h2 id='demogR-package'>
Demographic analysis in R
</h2><span id='topic+demogR-package'></span><span id='topic+demogR'></span>

<h3>Description</h3>

<p><code>demogR</code> is a collection of functions to construct and analyze
age-structured population models.  For a list of functions, type:
<code>help(package="demogR")</code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> demogR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.6.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-09-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2.0 or newer </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p> James Holland Jones<br />
Department of Anthropological Sciences<br />
Stanford University
</p>
<p>Contributor: Jim Oeppen, Southern Denmark University, Odense, Denmark
</p>
<p>Maintainer: Hana Sevcikova &lt;hanas@uw.edu&gt;
</p>


<h3>References</h3>

<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>
<p>Coale, A.J. 1972. The growth and structure of human populations: A
mathematical investigation. Princeton: Princeton University Press. 
</p>
<p>Jone, J.H. (2007). demogR: A Package for the Construction and Analysis of Age-structured Demographic Models in R. Journal of Statistical Software, 22(10), 1-28.
</p>
<p>Keyfitz, N. 1977. Introduction to the mathematics of populations. 2nd
ed. Menlo Park: Addison-Wesley.
</p>
<p>Keyfitz, N., and H. Caswell. 2005. Applied mathematical
demography. 3rd ed. New York: Springer. 
</p>
<p>Leslie, P.H. 1945. On the use of matrices in certain population
mathematics. Biometrics 33:213-245. 
</p>
<p>Preston, S.H., P. Heuveline, and F. Guillot. 2001. Demography:
Measuring and modeling population processes. Oxford: Blackwell. 
</p>
<p>Tuljapurkar, S. 1990. Population dynamics in variable environments.
Vol. 85, Lecture notes in biomathematics. Berlin: Springer-Veralg.
</p>

<hr>
<h2 id='eigen.analysis'> eigen.analysis </h2><span id='topic+eigen.analysis'></span>

<h3>Description</h3>

<p>Calculates the asymptotic growth rate and related quantities from a
demographic projection matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigen.analysis(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigen.analysis_+3A_a">A</code></td>
<td>
<p> demographic projection matrix </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the asymptotic growth rate (lambda) of a population
described by demographic projection matrix A.  The asymptotic growth
rate of the population is given by the dominant eigenvalue of the
projection matrix.  By the Perron-Frobenius Theorem, this eigenvalue
is guaranteed to be real, positive and strictly greater than all the
other eigenvalues if the matrix A is non-negative, irreducible, and
primitive (for details see Caswell (2001)).
</p>
<p>Also calculates the damping ratio (rho), eigenvalue sensitivities,
eigenvalue elasticities, the stable age distribution (for the
communicating parts of the life cycle), and  scaled reproductive
values. 
</p>
<p>The damping ratio is the ratio of the dominant eigenvalue and the
absolute value of the second eigenvalue.  rho is a measure of the
rate of convergence to the stable age-distribution.  A population
characterized by damping ratio rho will converge asymptotically to
the stable age distribution exponentially with rate at least as fast
as log(rho).  Clearly, a population already at or very near the
stable age distribution will converge faster, but rho provides an
upper bound.
</p>
<p>The eigenvalue sensitivities are the partial derivatives of lambda
with respect to a perturbation in matrix element <code class="reqn">a_{ij}</code>.  The
sensitivities measure the selection gradient on the life-cycle
(Lande 1982).   The eigenvalue elasticities are scaled to be
proportional sensitivities of lambda to a perturbation in <code class="reqn">a_{ij}</code>.
Elasticities have a number of desirable properties including, their
sum across all life-cycle transitions is unity and the sum of the
elasticities of all  incoming arcs to a life-cycle stage must equal
the sum of all outgoing arcs (van Groenendael et al 1994).
</p>
<p>The stable age distribution is normalized to represent the
proportion in each of the communicating age classes.  If the
population is characterized by post-reproductive survival (and
hence age classes that do not communicate with the rest of the life
cycle graph), then other methods should be used to calculate to
stable distribution.  For example, from classic stable population
theory, we know that the stable age distribution of the population
c(x) is given by the relationship: 
</p>
<p>c(x) = b l(x) exp(-r*x)
</p>
<p>where b is the gross birth rate, l(x) is survivorship to age x and
r is the rate of increase of the population (=log(lambda)).  See
Coale (1972) or Preston et al. (2001) for details.
</p>
<p>The age-specific reproductive values are normalized so that the
reproductive value of the first age class is unity.  Problems
associated with post-reproductive survival are irrelevant for
reproductive value since the reproductive value of
post-reproductive individuals is, by definition, zero. 
</p>


<h3>Value</h3>

<p>A list with six components:
</p>
<table>
<tr><td><code>lambda1</code></td>
<td>
<p> the asymptotic growth rate (dominant eigenvalue) of
A </p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p> damping ratio of A </p>
</td></tr>
<tr><td><code>sensitivities</code></td>
<td>
<p> eigenvalue sensitivities of A </p>
</td></tr>
<tr><td><code>elasticities</code></td>
<td>
<p> eigenvalue elasticities of A </p>
</td></tr>
<tr><td><code>stable.age</code></td>
<td>
<p>  stable age distribution of A </p>
</td></tr>
<tr><td><code>repro.value</code></td>
<td>
<p>  reproductive values of A </p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>
<p>Coale, A.J. 1972. The growth and structure of human populations: A
mathematical investigation. Princeton: Princeton University Press. 
</p>
<p>Lande, R. A. 1982. A quantitative genetic theory of life history
evolution. Ecology 63:607-615. 
</p>
<p>van Groenendael, J., H. De Kroon, S. Kalisz, and
S. Tuljapurkar. 1994. Loop analysis: Evaluating life history pathways
in population projection matrices. Ecology 75 (8):2410-2415. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+leslie.matrix">leslie.matrix</a></code>, <code><a href="#topic+secder">secder</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(goodman)
ven &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))
ven.mx &lt;- with(goodman, ven.bx/ven.nKx)
A &lt;- leslie.matrix(lx=ven$nLx,mx=ven.mx)

usa &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
usa.mx &lt;- with(goodman, usa.bx/usa.nKx)
B &lt;- leslie.matrix(lx=usa$nLx,mx=usa.mx)

eav &lt;- eigen.analysis(A)
eau &lt;- eigen.analysis(B)

## compare rates of increase

eav$lambda1
eau$lambda1

## compare stable age distributions for Venezuela and the USA
op &lt;- par(no.readonly = TRUE)
age &lt;- seq(0,50,by=5)
par(mfrow=c(1,2))
barplot(eav$stable.age, names.arg=age, 
	     horiz=TRUE, 
	     col="grey", 
	     ylab="Age")
barplot(eau$stable.age, names.arg=age[-11], 
	     horiz=TRUE, 
	     col="blue", 
	     ylab="Age", 
	     xlim=c(0,0.2))

par(op)

## Compare reproductive values for Venezuela and the USA

plot(age, eav$repro.value, type="l", xlab="Age", ylab="Reproductive Value")
lines(age[-11], eau$repro.value, lty=2)
legend("topright", c("Venezuela (1965)", "USA (1967)"), lty=c(1,2))
</code></pre>

<hr>
<h2 id='elassens'>elassens </h2><span id='topic+elassens'></span>

<h3>Description</h3>

<p>Calculates the partial derivatives of the eigenvalue elasticities of
a demographic projection matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elassens(A, k, l)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elassens_+3A_a">A</code></td>
<td>
<p> a demographic projection matrix </p>
</td></tr>
<tr><td><code id="elassens_+3A_k">k</code></td>
<td>
<p> row index of the transition that the partial is calculated
with respect to</p>
</td></tr>
<tr><td><code id="elassens_+3A_l">l</code></td>
<td>
<p> column index of the transition that the partial is calculated
with respect to</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Caswell (2001) section 9.7.1.
</p>


<h3>Value</h3>

<p>A matrix of class &quot;leslie.matrix&quot;.
</p>


<h3>References</h3>

 
<p>Caswell, H. 2001. Matrix population models: Construction, analysis, and interpretation. 2nd ed. Sunderland, MA: Sinauer.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+secder">secder</a></code>, <code><a href="#topic+leslie.matrix">leslie.matrix</a></code>,
<code><a href="#topic+eigen.analysis">eigen.analysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
mlt &lt;- with(goodman, life.table(x=age, nDx=mad.nDx, nKx=mad.nKx))
mx &lt;- goodman$mad.bx/goodman$mad.nKx

##  make the Leslie matrix
mad &lt;- leslie.matrix(lx=mlt$lx, mx=mx)

## now calculate the sensitivities of the elasticitities with respect
##to infant survival

es21 &lt;- elassens(mad,2,1)
</code></pre>

<hr>
<h2 id='fullsecder'> fullsecder </h2><span id='topic+fullsecder'></span>

<h3>Description</h3>

<p>Calculates the second derivatives of the dominant eigenvalue of a
square matrix, A, with respect to all non-zero elements of A.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fullsecder(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fullsecder_+3A_a">A</code></td>
<td>
<p> a demographic projection matrix </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a matrix the columns of which are re-shaped matrices of
second derivatives of the dominant eigenvalue of the projection
matrix A with respect to each non-zero element in A.
</p>
<p>See Caswell (1996, 2001) for details on second derivatives of the
dominant eigenvalue.
</p>


<h3>Value</h3>

<p>A square matrix.  If A is a Leslie matrix of rank k, then the maximum
rank of the resulting matrix is 2k-1 (since there are at most k
non-zero fertilities and k-1 survival probabilities in a k x k
Leslie matrix). 
</p>


<h3>References</h3>

 
<p>Caswell, H. 1996. Second derivatives of population growth rate:
Calculation and applications. Ecology 77 (3):870-879.
</p>
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+secder">secder</a></code>, <code><a href="#topic+elassens">elassens</a></code>,
<code><a href="#topic+eigen.analysis">eigen.analysis</a></code>, <code><a href="#topic+stoch.sens">stoch.sens</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## eigenvalue second derivatives of the US projection matrix from 1967
data(goodman)
ult &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
mx &lt;- goodman$usa.bx/goodman$usa.nKx
usa &lt;- leslie.matrix(lx=ult$nLx,mx=mx)

fs &lt;- fullsecder(usa)

## plot the survival cross-second derivatives of lambda with respect
## to infant survival

plot( seq(0,40,by=5), fs["21",10:18], type="l", 
	 xlab="Age (j)", 
	 ylab=expression(paste(partialdiff^2 , lambda, "/", 
	 partialdiff, P[1] , partialdiff, P[j])))
abline(h=0,lty=3)
</code></pre>

<hr>
<h2 id='gen.time'> gen.time </h2><span id='topic+gen.time'></span>

<h3>Description</h3>

<p>Calculates the generation time for an age or stage-classified
demographic projection matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.time(A, peryear = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.time_+3A_a">A</code></td>
<td>
<p> demographic projection matrix </p>
</td></tr>
<tr><td><code id="gen.time_+3A_peryear">peryear</code></td>
<td>
<p> width of the age classes </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the generation time (T) for an age or stage-classified
demographic projection matrix using the identity 
</p>
<p><code class="reqn">R_0 = \exp(r*T)</code>
</p>
<p>where <code class="reqn">R_0</code> is the net reproduction number and r is the intrinsic rate
of increase (=log(lambda)).  
</p>
<p>Generation time is the amount of time that it takes a typical female
to produce <code class="reqn">R_0</code> offspring or, equivalently, the amount of time it
takes a population growing with instantaneous rate r to increase by
a factor of <code class="reqn">R_0</code>.
</p>


<h3>Value</h3>

<p>The generation time implied by the demographic projection matrix.
</p>


<h3>Note</h3>

<p> Calls function <code>calc.ro</code>, which calculates <code class="reqn">R_0</code> from the
fundamental matrix of the Markov transition matrix (Caswell 2001).
</p>


<h3>References</h3>

 
<p>Keyfitz, N., and H. Caswell. 2005. Applied mathematical
demography. 3rd ed. New York: Springer. 
</p>
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>
<p>Preston, S.H., P. Heuveline, and F. Guillot. 2001. Demography:
Measuring and modeling population processes. Oxford: Blackwell. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+calc.ro">calc.ro</a></code>, <code><a href="#topic+eigen.analysis">eigen.analysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## compare generation times from two populations with very different
## R_0 values
data(goodman)
ven &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))
ven.mx &lt;- with(goodman, ven.bx/ven.nKx)
A &lt;- leslie.matrix(lx=ven$nLx,mx=ven.mx)

usa &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
usa.mx &lt;- with(goodman, usa.bx/usa.nKx)
B &lt;- leslie.matrix(lx=usa$nLx,mx=usa.mx)

gen.time(A)
gen.time(B)
</code></pre>

<hr>
<h2 id='goodman'> Demographic data from Venezuela, Madagascar and the United
States in the late 1960s</h2><span id='topic+goodman'></span>

<h3>Description</h3>

<p>Aggregate vital registration data for female from Venezuela (1965), Madagascar
(1966), and the United States (1967) used in Goodman, Keyfitz, and
Pullam (1974).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(goodman)</code></pre>


<h3>Format</h3>

<p>A data frame with 19 observations on the following 10 variables.
</p>

<dl>
<dt><code>age</code></dt><dd><p> age classes </p>
</dd>
<dt><code>ven.nKx</code></dt><dd><p> mid-year population structure for Venezuela</p>
</dd>
<dt><code>ven.nDx</code></dt><dd><p> enumerated deaths for Venezuela</p>
</dd>
<dt><code>ven.bx</code></dt><dd><p> enumerated births for Venezuela</p>
</dd>
<dt><code>mad.nKx</code></dt><dd><p>mid-year population structure for Madagascar</p>
</dd>
<dt><code>mad.nDx</code></dt><dd><p> enumerated deaths for Madagascar </p>
</dd>
<dt><code>mad.bx</code></dt><dd><p> enumerated births for Madagascar</p>
</dd>
<dt><code>usa.nKx</code></dt><dd><p> mid-year population structure for the
United States</p>
</dd>
<dt><code>usa.nDx</code></dt><dd><p> enumerated deaths for the United States</p>
</dd>
<dt><code>usa.bx</code></dt><dd><p> enumerated births for the United States</p>
</dd>
</dl>



<h3>Details</h3>

<p>Vital event data tabulated by Keyfitz and Flieger (1990) and used by
Goodman et al. (1974) to illustrate their kinship frequency
calculations.  The three female populations represent tremendous diversity
in age-specific demographic schedules.  Venezuela (1965) is characterized
by low mortality and high fertility;  Madagascar (1966) is
characterized by very high mortality and fertility, while the United
States (1967) is characterized by low mortality and low fertility.
</p>


<h3>Source</h3>

<p>Keyfitz and Flieger (1990), Goodman et al. (1974)
</p>


<h3>References</h3>

<p>Keyfitz, N., and W. Flieger. 1990. World population growth and
aging: Demographic trends in the late twentieth century. Chicago:
University of Chicago Press.
</p>
<p>Goodman, L. A., N. Keyfitz, and T. W. Pullum. 1974. Family formation
and the frequency of various kinship relationships. Theoretical
Population Biology 5:1-27.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
## Plot age-specific mortality rates for the three populations
with(goodman, plot(age, usa.nDx/usa.nKx, type="l", log="y", xlab="Age", ylab="nMx"))
with(goodman, lines(age, mad.nDx/mad.nKx, lty=2))
with(goodman, lines(age, ven.nDx/ven.nKx, lty=3))
legend("bottomright", c("USA","Madagascar","Venezuela"), lty=c(1,2,3))

</code></pre>

<hr>
<h2 id='keyfitz'> keyfitz </h2><span id='topic+keyfitz'></span>

<h3>Description</h3>

<p>Utility used by <code>life.table</code> to graduate the person-years lived
by those dying in the interval by the method of Keyfitz and Flieger
(1990). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keyfitz(b0, nMx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="keyfitz_+3A_b0">b0</code></td>
<td>
<p> two element vector of regression coefficients provided in
Keyfitz and Flieger (1990).  Default value: <code>b0=c(0.07,1.7)</code>. </p>
</td></tr>
<tr><td><code id="keyfitz_+3A_nmx">nMx</code></td>
<td>
<p> period central death rates: <code>=nDx/nKx</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Utility function called by <code>life.table</code>.
</p>


<h3>Value</h3>

<p>The first two values (age classes 0-1 and 1-5) of the nax column of
a period life table.
</p>


<h3>References</h3>

 
<p>Keyfitz, N., and W. Flieger. 1990. World population growth and
aging: Demographic trends in the late twentieth century. Chicago:
University of Chicago Press.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+life.table">life.table</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
## default type="kf"
vlt &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))


</code></pre>

<hr>
<h2 id='lams'> lams </h2><span id='topic+lams'></span>

<h3>Description</h3>

<p>Calculates the logarithm of the stochastic growth rate using
Tuljapurkar's second order approximation for independent and
identically distributed environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lams(aseq, n = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lams_+3A_aseq">aseq</code></td>
<td>
<p> sequence of matrices with each matrix given as a
re-shaped column of aseq </p>
</td></tr>
<tr><td><code id="lams_+3A_n">n</code></td>
<td>
<p> width of the projection interval/age-class </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses Tuljapurkar's second order approximation for independent and
identically distributed (i.i.d.) environments.
</p>


<h3>Value</h3>

<p>The long-run growth rate for the population with projection matrices
given by aseq.
</p>


<h3>References</h3>

 
<p>Tuljapurkar, S. 1990. Population dynamics in variable
environments. Edited by S. A. Levin. Vol. 85, Lecture notes in
biomathematics. Berlin: Springer-Veralg. 
</p>
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+stoch.sens">stoch.sens</a></code>, <code><a href="#topic+eigen.analysis">eigen.analysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## simulate two matrices: good year/bad year
## beta distributed survival, gamma fertility

px1 &lt;- rbeta(5,9,1)
px2 &lt;- rbeta(5,7,3)
mx1 &lt;- c(0,rgamma(5,10,10))
mx2 &lt;- c(0,rgamma(5,7,10))
## good year matrix
A1 &lt;- odiag(px1,-1)
A1[1,] &lt;- mx1

## bad year matrix
A2 &lt;- odiag(px2,-1)
A2[1,] &lt;- mx2
aseq &lt;- cbind(matrix(A1,nr=36,nc=1), matrix(A2,nr=36,nc=1))
lams(aseq)
</code></pre>

<hr>
<h2 id='leslie.matrix'> Leslie Matrix </h2><span id='topic+leslie.matrix'></span>

<h3>Description</h3>

<p>Generates a Leslie matrix for demographic projection from vectors of
age-specific cumulative survival and fertility.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leslie.matrix(lx, mx, 
		    L = TRUE, 
		    peryear = 5, 
		    one.sex = TRUE, 
		    SRB = 1.05, 
		    infant.class = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leslie.matrix_+3A_lx">lx</code></td>
<td>
<p> vector of either age-specific cumulative survival or
person-years lived in the interval </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_mx">mx</code></td>
<td>
<p> age-specific fertility rates </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_l">L</code></td>
<td>
<p> logical; if 'TRUE', <code>lx</code> is taken to be person-years
lived in the interval nLx, while if 'FALSE', <code>lx</code> is taken to
be cumulative survival to exact age x+n.  Defaults to 'TRUE'. </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_peryear">peryear</code></td>
<td>
<p> Multiplier for fertility.  Defaults to <code>peryear=5</code>. </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_one.sex">one.sex</code></td>
<td>
<p> logical; If 'TRUE', fertility rates will be divided
by (1+SRB). </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_srb">SRB</code></td>
<td>
<p> sex ratio at birth.  Defaults to <code>SRB=1.05</code>. </p>
</td></tr>
<tr><td><code id="leslie.matrix_+3A_infant.class">infant.class</code></td>
<td>
<p> logical;  'TRUE' if <code>lx</code> contains a value
for the infant age-class.   </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>Constructs a k x k age-classified demographic projection matrix with
age-specific survival probabilities along the sub-diagonal and
age-specific fertilities along the first row of the
matrix. 
</p>
<p><code>lx</code> and <code>mx</code> are assumed to be of the same
length.  The resulting matrix is truncated to insure that there are
no post-reproductive classes.  This is important for ensuring
irreducibility of the resulting matrix.
</p>
<p>If <code>mx</code> is longer than <code>lx</code>, <code>mx</code> is trucated to be
the same length as <code>lx</code>.  If <code>lx</code> is longer than
<code>mx</code>, a warning is issed and <code>lx</code> is truncated to be the
same length as <code>mx</code>.
</p>
<p>Fertility is assumed to be birth-flow (Caswell 2001).  That is,
breeding is assumed to be continuous and the individual elements of
the first row of the Leslie matrix are averaged over successive
age-classes.  Fertility rates are typically given in annualized
form.  If this is the case and the age-classes are wider than one
year, then <code>peryear</code> can be used to appropriately scale up the
annual values.
</p>
<p>The default behavior is to use person-years lived in the interval as
the survival measure.   If <code>infant.class=TRUE</code>, lx is taken to
have a value for the infant age class (i.e., a shorter class width
than the other elements of <code>lx</code>.  What is done when there is an
infant class depends on what the values in <code>lx</code> represent. If
<code>L=TRUE</code>, then the first two values of lx are combined to form
the total person-years for the first age-class in the Leslie
matrix.  Human demographic data from abridged life tables typically
come with age classes x = 0, 1, 5, 10, ... Thus, combining the
person-years for the first two age classes gives an initial age
class of the correct width. If <code>infant.class=TRUE</code> and
<code>L=FALSE</code>, the second element of <code>lx</code> is deleted.
Creating a Leslie matrix from other forms of non-standard early
age-classes can be accomplished by pre-processing <code>lx</code> and
using the option <code>infant.class=FALSE</code>.
</p>
<p>The human sex ratio at birth (male births/female births) is
remarkably close to SRB=1.05 across a wide range of populations and
this is the default value for <code>SRB</code>.
</p>
<p>The resulting matrix has class &quot;leslie.matrix&quot;. This class is
not used extensively but will be in future development. 
</p>


<h3>Value</h3>

<p>A k x k age-classified demographic projection matrix with class
&quot;leslie.matrix&quot;. </p>


<h3>References</h3>

 
<p>Keyfitz, N. 1977. Introduction to the mathematics of populations. 2nd
ed. Menlo Park: Addison-Wesley.
</p>
<p>Preston, S.H., P. Heuveline, and F. Guillot. 2001. Demography:
Measuring and modeling population processes. Oxford: Blackwell. 
</p>
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+odiag">odiag</a></code>, <code><a href="#topic+leslie.row1">leslie.row1</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Construct lx and mx values
data(goodman)
mlt &lt;- with(goodman, life.table(x=age, nDx=mad.nDx, nKx=mad.nKx))
mx &lt;- goodman$mad.bx/goodman$mad.nKx

## Now make the Leslie matrix
mad &lt;- leslie.matrix(lx=mlt$nLx, mx=mx)

## Might as well do something with it too!
eigen.analysis(mad)
</code></pre>

<hr>
<h2 id='leslie.row1'> leslie.row1 </h2><span id='topic+leslie.row1'></span>

<h3>Description</h3>

<p>A utility for calculating the first row of a Leslie matrix from
vectors of interval survival probabilities and age-specific fertility
rates. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leslie.row1(mx, px, L = NULL, SRB = 1.05, peryear = 5, one.sex = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="leslie.row1_+3A_mx">mx</code></td>
<td>
<p> vector of age-specific fertilities (length=k) </p>
</td></tr>
<tr><td><code id="leslie.row1_+3A_px">px</code></td>
<td>
<p> vector of interval survival probabilities (length=k-1) </p>
</td></tr>
<tr><td><code id="leslie.row1_+3A_l">L</code></td>
<td>
<p> person-years lived in the first interval; default
<code>L=NULL</code> in which case each element is multiplied by
peryear*sqrt(px[1]), otherwise each element is multiplied by L.  </p>
</td></tr>
<tr><td><code id="leslie.row1_+3A_srb">SRB</code></td>
<td>
<p> sex ratio at birth; default <code>SRB=1.05</code>. </p>
</td></tr>
<tr><td><code id="leslie.row1_+3A_peryear">peryear</code></td>
<td>
<p> width of the age-class/projection interval </p>
</td></tr>
<tr><td><code id="leslie.row1_+3A_one.sex">one.sex</code></td>
<td>
<p> should each element be reduced by a factor
1/(1+SRB)? default <code>one.sex=TRUE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the first-row entries for a Leslie matrix.  This utility
is particularly useful for constructing simulated Leslie matrices. 
</p>


<h3>Value</h3>

<p>A vector of length k, where k is the rank of the projection
matrix A.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+leslie.matrix">leslie.matrix</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## simulate survival values from a beta(9,1) distribution

px &lt;- rbeta(10,9,1)

## simulate fertility values from a gamma(2,10) distribution with age
##   at first reproduction = 10

mx &lt;- c(0,0,0,rgamma(8,2,10))
A &lt;- odiag(px,-1)
Fx &lt;- leslie.row1(mx,px)
A[1,] &lt;- Fx


</code></pre>

<hr>
<h2 id='life.table'> life.table </h2><span id='topic+life.table'></span>

<h3>Description</h3>

<p>Construct either a period or cohort life table from enumerated deaths
and mid-interval population estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>life.table(x, nDx, nKx, 
	      b0 = c(0.07, 1.7), 
	      b1 = c(0.053, 2.8), 
	      b4 = c(1.522, 1.518), 
	      type = "kf", 
	      nxx = 0, 
	      iwidth = 5, 
	      width12 = c(1, 4))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="life.table_+3A_x">x</code></td>
<td>
<p> age at the beginning of the age classes of the life table </p>
</td></tr>
<tr><td><code id="life.table_+3A_ndx">nDx</code></td>
<td>
<p> deaths </p>
</td></tr>
<tr><td><code id="life.table_+3A_nkx">nKx</code></td>
<td>
<p> population size </p>
</td></tr>
<tr><td><code id="life.table_+3A_b0">b0</code></td>
<td>
<p> coefficients used in Keyfitz-Flieger graduation </p>
</td></tr>
<tr><td><code id="life.table_+3A_b1">b1</code></td>
<td>
<p> first set of coefficients used in Coale-Demeny graduation </p>
</td></tr>
<tr><td><code id="life.table_+3A_b4">b4</code></td>
<td>
<p> second set of coefficients used in Coale-Demeny graduation </p>
</td></tr>
<tr><td><code id="life.table_+3A_type">type</code></td>
<td>
<p> type of life table calculation: &quot;kf&quot;, &quot;cd&quot;, or
&quot;cohort&quot;. Default is &quot;kf&quot;. </p>
</td></tr>
<tr><td><code id="life.table_+3A_nxx">nxx</code></td>
<td>
<p> person-years lived by those dying in the last (possibly
open) age-class. If <code>nxx=0</code>, the person-years lived by those
dying in the interval is the inverse of the central death rate
(corresponding to exponentially distributed failure times). </p>
</td></tr>
<tr><td><code id="life.table_+3A_iwidth">iwidth</code></td>
<td>
<p> width of the age intervals. Default <code>iwidth=5</code>. </p>
</td></tr>
<tr><td><code id="life.table_+3A_width12">width12</code></td>
<td>
<p> width of the first two age classes. Default
<code>width12=c(1,4)</code>.  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a period or cohort life tables from enumerated deaths and
mid-interval population sizes (period) or enumerated deaths and
person-years at risk (cohort).  <code>x</code>, <code>nDx</code>, and <code>nKx</code> must all
the be same length.
</p>
<p>There are currently three options for life table construction.  The
first two are for the construction of period life tables.  They differ
only in the way that person-years lived by those dying in the first
two intervals are handled.  For <code>type="kf"</code>, the default, the
first two values of nax estimated using Keyfitz and Fleiger's (1990)
regression method. For <code>type="cd"</code>, Coale and Demeny's method
(1983) is used.  The Coale-Demeny method uses different coefficients
depending on the level of early mortality.  As a result, this method
may work better for high-mortality populations. 
</p>
<p>The third type of life table is a cohort life table, for which the
conversion from mortality rates to probabilities of death is
unnecessary, so the nax column of the life table is of limited
interest. 
</p>


<h3>Value</h3>

<p>A dataframe with nine columns:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p> age at the beginning of the interval </p>
</td></tr>
<tr><td><code>nax</code></td>
<td>
<p> person-years lived by those dying in the interval x to
x+n </p>
</td></tr>
<tr><td><code>nMx</code></td>
<td>
<p> period central death rate </p>
</td></tr>
<tr><td><code>nqx</code></td>
<td>
<p> probability of death between ages x and x+n </p>
</td></tr>
<tr><td><code>lx</code></td>
<td>
<p> probability of survival to exact age x </p>
</td></tr>
<tr><td><code>ndx</code></td>
<td>
<p> proportion of deaths occurring between ages x and x+n
</p>
</td></tr> 
<tr><td><code>nLx</code></td>
<td>
<p> person-years lived in the interval x to x+n </p>
</td></tr>
<tr><td><code>Tx</code></td>
<td>
<p> person-years of life left in the cohort at age x </p>
</td></tr>
<tr><td><code>ex</code></td>
<td>
<p> life expectancy at age x</p>
</td></tr>
</table>


<h3>References</h3>

 
<p>Keyfitz, N. 1977. Introduction to the mathematics of populations. 2nd
ed. Menlo Park: Addison-Wesley.
</p>
<p>Coale, A., P. Demeny, and B. Vaughn. 1983. Regional model life tables
and stable populations. 2nd ed. New York: Academic Press.
</p>
<p>Keyfitz, N., and W. Flieger. 1990. World population growth and
aging: Demographic trends in the late twentieth century. Chicago:
University of Chicago Press.
</p>
<p>Preston, S.H., P. Heuveline, and F. Guillot. 2001. Demography:
Measuring and modeling population processes. Oxford: Blackwell. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+cdmltw">cdmltw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
## default type="kf"
vlt &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))

## compare nax values for cd vs kf life tables
vlt1 &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx, type="cd"))
vlt$nax[1:2]
vlt1$nax[1:2]

## now construct a cohort life table for Himalayan thar,
##  (Hemitargus jemlahicus) 
data(thar)
thar.lt &lt;- with(thar, life.table(x=age, nDx=deaths, nKx=count, 
    type="cohort", iwidth=1, width12=c(1,1)))
thar.lt
</code></pre>

<hr>
<h2 id='loop.elas'> loop.elas </h2><span id='topic+loop.elas'></span>

<h3>Description</h3>

<p>Calculate  and plot loop elasticities for a demographic projection matrix .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loop.elas(A, 
	       draw.plot = TRUE, 
	       peryear = 5, 
	       xlab = "Loop Elasticity", 
	       ylab = "Age", 
	       xlim = c(0, (maxe + 0.02)), 
	       ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loop.elas_+3A_a">A</code></td>
<td>
<p> demographic projection matrix </p>
</td></tr>
<tr><td><code id="loop.elas_+3A_draw.plot">draw.plot</code></td>
<td>
<p> should a plot be drawn? default:
<code>draw.plot=TRUE</code> </p>
</td></tr> 
<tr><td><code id="loop.elas_+3A_peryear">peryear</code></td>
<td>
<p> width of the age-class/projection interval </p>
</td></tr>
<tr><td><code id="loop.elas_+3A_xlab">xlab</code></td>
<td>
<p> x-axis label; default <code>ylab="Age"</code></p>
</td></tr>
<tr><td><code id="loop.elas_+3A_ylab">ylab</code></td>
<td>
<p> y-axis label; default <code>ylab="Loop Elasticity"</code></p>
</td></tr>
<tr><td><code id="loop.elas_+3A_xlim">xlim</code></td>
<td>
<p> plotting limits for x-axis </p>
</td></tr>
<tr><td><code id="loop.elas_+3A_...">...</code></td>
<td>
<p> arguments to be passed to/from other methods </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates and plots the life-cycle decomposition of van Groenendael
et al (1994). 
</p>


<h3>Value</h3>

<p>A vector of length k (the rank of the projection matrix A) giving
the loop elasticities for each of the loops in the life-cycle
graph. 
</p>


<h3>References</h3>

 
<p>Van Groenendael, J., H. De Kroon, S. Kalisz, and
S. Tuljapurkar. 1994. Loop analysis: Evaluating life history pathways
in population projection matrices. Ecology 75 (8):2410-2415. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+eigen.analysis">eigen.analysis</a></code>, <code><a href="#topic+leslie.matrix">leslie.matrix</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(goodman)
ven &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))
ven.mx &lt;- with(goodman, ven.bx/ven.nKx)
A &lt;- leslie.matrix(lx=ven$nLx,mx=ven.mx)

usa &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
usa.mx &lt;- with(goodman, usa.bx/usa.nKx)
B &lt;- leslie.matrix(lx=usa$nLx,mx=usa.mx)

eav &lt;- eigen.analysis(A)
eau &lt;- eigen.analysis(B)

## Compare the loop elasticities of Venezuela (1965) and the USA (1967)
le.usa &lt;- loop.elas(A)
le.usa &lt;- loop.elas(B)


</code></pre>

<hr>
<h2 id='m2v'> m2v </h2><span id='topic+m2v'></span>

<h3>Description</h3>

<p>Utility that takes a matrix n x m and stacks its columns to form a
column vector of length mn.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m2v(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="m2v_+3A_a">A</code></td>
<td>
<p> an m x n matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For an m x n input matrix, returns a m*n x 1 matrix (i.e., a column vector).
</p>


<h3>Note</h3>

 
<p>Meant to capture the MATLAB functionality of the colon
operator, A(:)
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+odiag">odiag</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- matrix(rnorm(9), nr=3, nc=3)
m2v(A)
</code></pre>

<hr>
<h2 id='odiag'> odiag </h2><span id='topic+odiag'></span>

<h3>Description</h3>

<p>Utility function that creates a square matrix with a vector on the off-diagonal or
extracts the specified off-diagonal vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odiag(A, at = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odiag_+3A_a">A</code></td>
<td>
<p> either a vector or a matrix </p>
</td></tr>
<tr><td><code id="odiag_+3A_at">at</code></td>
<td>
<p> which diagonal? </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the first argument is a vector of length k, the result will be a
square matrix of rank k+at with the provided vector along the 'at'
diagonal.  Positive values for 'at' place the vector above the
diagonal, negative values below the diagonal, and <code>at=0</code> (the
default) places the vector on the diagonal.
</p>


<h3>Value</h3>

<p>A vector if argument <code>A</code> is a matrix and a matrix if <code>A</code> is
a vector.
</p>


<h3>Note</h3>

 
<p><code>odiag</code> is meant to capture some of the functionality of the
MATLAB function diag().
</p>


<h3>See Also</h3>

  <p><code><a href="base.html#topic+diag">diag</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Construct a matrix from a vector
## random survival probabilities with mean 0.9 and variance 0.0082

y &lt;- rbeta(4,9,1)
A &lt;- odiag(y,-1)

## add fertilities
F &lt;- c(0,rep(1,4))
A[1,] &lt;- F

## Extract a vector from a matrix
A &lt;- matrix(rnorm(25), nr=5, nc=5)
odiag(A,2)
</code></pre>

<hr>
<h2 id='plot.leslie.matrix'> plot.leslie.matrix </h2><span id='topic+plot.leslie.matrix'></span>

<h3>Description</h3>

<p>Plots Leslie matrices and other objects of class &quot;leslie.matrix&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'leslie.matrix'
plot(x, y=NULL,
                  ...,
                  main="", sub="",
                  ann=TRUE,
                  xlim=NULL, ylim=NULL,
                  axes=TRUE,
                  col=c("black","grey"),
                  lwd=2,
                  xlab="Age", ylab="Sensitivity",
                  peryear=5 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.leslie.matrix_+3A_x">x</code></td>
<td>
<p> demographic projection matrix </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_y">y</code></td>
<td>
<p> y axis values; NULL</p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_...">...</code></td>
<td>
<p> arguments to be passed to/from other methods </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_main">main</code></td>
<td>
<p> an overall title for the plot </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_sub">sub</code></td>
<td>
<p> a subtitle for the plot </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_ann">ann</code></td>
<td>
<p> logical; if TRUE, annotate plot  </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_xlim">xlim</code></td>
<td>
<p>plotting limits for x-axis; if <code>xlim=NULL</code>, range of
x values used </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_ylim">ylim</code></td>
<td>
<p> plotting limits for y-axis; if <code>xlim=NULL</code>, range of
y values used </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_axes">axes</code></td>
<td>
<p>logical; if TRUE, draw axes and box</p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_col">col</code></td>
<td>
<p> vector (length 2) of line colors for the plot; default
<code>c("black","grey")</code></p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_lwd">lwd</code></td>
<td>
<p> thickness of the plotted lines; default <code>lwd=2</code></p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_peryear">peryear</code></td>
<td>
<p> width of the age-class/projection interval; default <code>peryear=5</code> </p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_xlab">xlab</code></td>
<td>
<p> x-axis label; default <code>xlab="Age"</code></p>
</td></tr>
<tr><td><code id="plot.leslie.matrix_+3A_ylab">ylab</code></td>
<td>
<p> y-axis label; default <code>xlab="Sensitivity"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the subdiagonal and the first row of an object of class
leslie.matrix on common axes.  Probably most useful for plotting
either eigenvalue sensitivities or elasticities of a projection matrix.
</p>


<h3>Value</h3>

<p>NULL
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+eigen.analysis">eigen.analysis</a></code>, <code><a href="#topic+loop.elas">loop.elas</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
ven &lt;- with(goodman, life.table(x=age, nKx=ven.nKx, nDx=ven.nDx))
ven.mx &lt;- with(goodman, ven.bx/ven.nKx)
A &lt;- leslie.matrix(lx=ven$nLx,mx=ven.mx)
ea.ven &lt;- eigen.analysis(A)

usa &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
usa.mx &lt;- with(goodman, usa.bx/usa.nKx)
B &lt;- leslie.matrix(lx=usa$nLx,mx=usa.mx)
ea.usa &lt;- eigen.analysis(B)

## Compare sensitivities for Venezuela and the USA

plot(ea.ven$sens, main="Venezuela")
plot(ea.usa$sens, main="USA")
</code></pre>

<hr>
<h2 id='project.leslie'> project.leslie </h2><span id='topic+project.leslie'></span>

<h3>Description</h3>

<p>Projects an population vector tmax intervals by
pre-multiplication with a Leslie matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>project.leslie(A, no, tmax, pop.sum = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="project.leslie_+3A_a">A</code></td>
<td>
<p> a k x k projection matrix </p>
</td></tr>
<tr><td><code id="project.leslie_+3A_no">no</code></td>
<td>
<p> a k x 1 population vector </p>
</td></tr>
<tr><td><code id="project.leslie_+3A_tmax">tmax</code></td>
<td>
<p> number of time steps to project the vector </p>
</td></tr>
<tr><td><code id="project.leslie_+3A_pop.sum">pop.sum</code></td>
<td>
<p> logical; If 'TRUE', the age-classes of the projected
population are summed, yielding a single total population vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes an initial population vector, no, and pre-multiplies by the
demographic projection matrix, A, tmax times.  This projection will
be tmax*n years into the future, where n is the width of the
age-classes in the Leslie matrix, A.
</p>


<h3>Value</h3>

<p>If <code>pop.sum=FALSE</code> (the default), the value will be a k x
tmax+1 matrix. The first column of the matrix is no and each
subsequent column represents the population structure at time
step 1, 2, ..., tmax.
</p>
<p>If  <code>pop.sum=TRUE</code>, the value will be a vector of length
tmax+1, where each element of the vector is the total
population at time t=0, 1, ..., tmax.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+leslie.matrix">leslie.matrix</a></code>, <code><a href="#topic+eigen.analysis">eigen.analysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goodman)
ult &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
mx &lt;- goodman$usa.bx/goodman$usa.nKx
usa &lt;- leslie.matrix(lx=ult$nLx,mx=mx)

## initial population is the age structure in 1967
## this includes the number of 0-1 year-olds and the number of 1-4
## year-olds, which need to be combined into a single 5-year wide
## element 

no &lt;- goodman$usa.nKx[3:11]
no &lt;- c(sum(goodman$usa.nKx[1:2]),no)/1e6

N &lt;- project.leslie(usa,no,tmax=20)
plot( seq(1967,2067,by=5), apply(N,2,sum), 
         type="l", 
	 xlab="Years", 
	 ylab="Projected Population (millions)")
title("Projected Total Population Size (Ages 0-45) of the United States")

##   Note that this is a lousy projection since it assumes constant
##   demographic rates and a closed population and only accounts for
##   ages 0-45
</code></pre>

<hr>
<h2 id='secder'>secder </h2><span id='topic+secder'></span>

<h3>Description</h3>

<p>Calculates the second derivatives of the dominant eigenvalue of the
demographic projection matrix for all non-zero transitions with
respect to one specified transition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secder(A, k, l)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secder_+3A_a">A</code></td>
<td>
<p> demographic projection matrix </p>
</td></tr>
<tr><td><code id="secder_+3A_k">k</code></td>
<td>
<p> row index for the specified transition </p>
</td></tr>
<tr><td><code id="secder_+3A_l">l</code></td>
<td>
<p> column index for the specified transition </p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Caswell (1996, 2001) for details on second derivatives of the
dominant eigenvalue.
</p>


<h3>Value</h3>

<p>A square matrix of the same rank as A where each element <code class="reqn">s_{ij}</code> is the
second derivative of the dominant eigenvalue of A, <code class="reqn">\partial^2
  \lambda/\partial a_{ij} \partial a_{kl}</code>.
</p>


<h3>Note</h3>

<p>The eigenvalue second derivatives are essential for calculating both
perturbation analyses of the eigenvalue elasticities and stochastic
sensitivities.  <code>secder</code> is used in functions to calculate both
these quantities.
</p>


<h3>References</h3>

  
<p>Caswell, H. 1996. Second derivatives of population growth rate:
Calculation and applications. Ecology 77 (3):870-879.
</p>
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+fullsecder">fullsecder</a></code>, <code><a href="#topic+elassens">elassens</a></code>,
<code><a href="#topic+eigen.analysis">eigen.analysis</a></code>, <code><a href="#topic+stoch.sens">stoch.sens</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## eigenvalue second derivatives of the US projection matrix from 1967
## with respect to infant survival
data(goodman)
ult &lt;- with(goodman, life.table(x=age, nKx=usa.nKx, nDx=usa.nDx))
mx &lt;- goodman$usa.bx/goodman$usa.nKx
usa &lt;- leslie.matrix(lx=ult$nLx,mx=mx)

sd21 &lt;- secder(usa,2,1)
</code></pre>

<hr>
<h2 id='stoch.sens'> stoch.sens </h2><span id='topic+stoch.sens'></span>

<h3>Description</h3>

<p>Calculates the sensitivity of the stochastic growth rate to
perturbations in the mean demographic projection matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stoch.sens(env, amat, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stoch.sens_+3A_env">env</code></td>
<td>
<p> environmental sequence </p>
</td></tr>
<tr><td><code id="stoch.sens_+3A_amat">amat</code></td>
<td>
<p> matrices describing the population dynamics in the
different environmental states, organized as columns of a matrix </p>
</td></tr>
<tr><td><code id="stoch.sens_+3A_k">k</code></td>
<td>
<p> rank of the projection matrices </p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Caswell (2001, section 14.4) for details.
</p>


<h3>Value</h3>

<p>A list with two elements:
</p>
<table>
<tr><td><code>sensitivities</code></td>
<td>
<p> sensitivities of the stochastic growth rate </p>
</td></tr>
<tr><td><code>elasticities</code></td>
<td>
<p> elasticities of the stochastic growth rate </p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>This is essentially a translation of Caswell's (2001, section
14.4.1.1) MATLAB code.
</p>


<h3>References</h3>

 
<p>Caswell, H. 2001. Matrix population models: Construction, analysis,
and interpretation. 2nd ed. Sunderland, MA: Sinauer. 
</p>
<p>Haridas, C. V., and S. Tuljapurkar. 2005. Elasticities in variable
environments: Properties and implications. American Naturalist 166
(4):481-495. 
</p>
<p>Tuljapurkar, S. 1990. Population dynamics in variable environments.
Vol. 85, Lecture notes in biomathematics. Berlin: Springer-Veralg.
</p>
<p>Tuljapurkar, S., and C. V. Haridas. 2006. Temporal autocorrelation and
stochastic population growth. Ecology Letters 9 (3):324-334. 
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+lams">lams</a></code>, <code><a href="#topic+eigen.analysis">eigen.analysis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simulate an i.i.d. sequence of 3 environmental states

env &lt;- floor(runif(100,0,3))+1
px1 &lt;- rbeta(4,9.5,0.5)
px2 &lt;- rbeta(4,7.5,2.5)
px3 &lt;- rbeta(4,5,5)
mx &lt;- c(0,rgamma(4,5,10))

A1 &lt;- odiag(px1,-1)
A2 &lt;- odiag(px2,-1)
A3 &lt;- odiag(px3,-1)
A1[1,] &lt;- leslie.row1(mx,px1)
A2[1,] &lt;- leslie.row1(mx,px2)
A3[1,] &lt;- leslie.row1(mx,px3)
amat &lt;- cbind(matrix(A1,nr=25), matrix(A2,nr=25), matrix(A3,nr=25))
stoch.sens(env,amat,k=5)

</code></pre>

<hr>
<h2 id='thar'> thar </h2><span id='topic+thar'></span>

<h3>Description</h3>

<p>Caughley's (1966) survival data on Himalayan thar (<em>Hemitargus jemlahicus</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(thar)</code></pre>


<h3>Format</h3>

<p>A data frame with 13 observations on the following 3 variables.
</p>

<dl>
<dt><code>age</code></dt><dd><p> age class </p>
</dd>
<dt><code>count</code></dt><dd><p> the number of individuals at the start of the
age class</p>
</dd>
<dt><code>deaths</code></dt><dd><p> observed deaths in the age class</p>
</dd>
</dl>



<h3>Details</h3>

<p>Caughley (1966) smoothed the counts within age classes and this data
set used those reported smoothed counts.
</p>


<h3>Source</h3>

<p>Caughley, G. 1966. Mortality patterns in mammals. Ecology 47:906-918.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(thar)
thar.lt &lt;- with(thar, 
    life.table(x=age, 
        nDx=deaths, 
        nKx=count, 
        type="cohort", 
        iwidth=1, 
        width12=c(1,1)))
thar.lt
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
