<!DOCTYPE html><html><head><title>Help for package growthcleanr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {growthcleanr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acf_answers'><p>Answers for adjustcarryforward</p></a></li>
<li><a href='#adjustcarryforward'><p>adjustcarryforward</p>
<code>adjustcarryforward</code> Uses absolute height velocity to identify values
excluded as carried forward values for reinclusion.</a></li>
<li><a href='#bmianthro'><p>BMI Anthro</p></a></li>
<li><a href='#CDCref_d'><p>CDC BMI reference data</p></a></li>
<li><a href='#cleangrowth'><p>Clean growth measurements</p></a></li>
<li><a href='#ewma'><p>Exponentially Weighted Moving Average (EWMA)</p></a></li>
<li><a href='#ext_bmiz'><p>Calculate extended BMI measures</p></a></li>
<li><a href='#fentlms_foraga'><p>Fenton Growth Curves</p></a></li>
<li><a href='#fentlms_forz'><p>Fenton Growth Curve Z-Scores</p></a></li>
<li><a href='#growth_cdc_ext'><p>CDC Growth Percentile Table</p></a></li>
<li><a href='#growth_cdc_ext_infants'><p>CDC Growth Percentile Table for Infants</p></a></li>
<li><a href='#growth_who_ext'><p>WHO Growth Percentile Table</p></a></li>
<li><a href='#lenanthro'><p>Length to Age Table</p></a></li>
<li><a href='#longwide'><p>Transform data in growthcleanr format into wide structure for BMI calculation</p></a></li>
<li><a href='#nhanes-reference-medians'><p>NHANES reference medians</p></a></li>
<li><a href='#rc-reference-medians'><p>Infants reference medians</p></a></li>
<li><a href='#read_anthro'><p>Function to calculate z-scores and csd-scores based on anthro tables.</p></a></li>
<li><a href='#recode_sex'><p>Recode binary sex variable for compatibility</p></a></li>
<li><a href='#sd_median'><p>Calculate median SD score by age for each parameter.</p></a></li>
<li><a href='#simple_bmi'><p>Compute BMI using standard formula</p></a></li>
<li><a href='#splitinput'><p>Split input data into multiple files</p></a></li>
<li><a href='#syngrowth'><p>syngrowth</p></a></li>
<li><a href='#tanner_ht_vel'><p>Tanner Growth Velocity Table</p></a></li>
<li><a href='#tanner_ht_vel_rev'><p>Tanner Growth Velocity Table for Infants</p></a></li>
<li><a href='#tanner_ht_vel_with_2sd'><p>Tanner Growth Velocity Table with (2<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#test_syngrowth_sas_output_compare'><p>CDC SAS BMI Output</p></a></li>
<li><a href='#test_syngrowth_wide'><p>CDC SAS BMI Input</p></a></li>
<li><a href='#testacf'><p>Function to test adjust carried forward</p></a></li>
<li><a href='#weianthro'><p>Weight Anthro Table</p></a></li>
<li><a href='#who_hc_maxvel'><p>WHO Maximum Head Circumference Velocity for (3<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#who_hc_vel_3sd'><p>WHO Head Circumference Velocity for (3<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#who_ht_maxvel'><p>WHO Maximum Height Velocity for (3<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#who_ht_maxvel_2sd'><p>WHO Maximum Height Velocity for (2<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#who_ht_vel_2sd'><p>WHO Height Velocity for (2<code class="reqn">\sigma</code>)</p></a></li>
<li><a href='#who_ht_vel_3sd'><p>WHO Height Velocity for (3<code class="reqn">\sigma</code>)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Cleaner for Anthropometric Measurements</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Identifies implausible anthropometric (e.g., height,
    weight) measurements in irregularly spaced longitudinal datasets, such as those from electronic health records.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://carriedaymont.github.io/growthcleanr/index.html">https://carriedaymont.github.io/growthcleanr/index.html</a>,
<a href="https://github.com/carriedaymont/growthcleanr">https://github.com/carriedaymont/growthcleanr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/carriedaymont/growthcleanr/issues">https://github.com/carriedaymont/growthcleanr/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>R.utils (&ge; 2.11.0), data.table (&ge; 1.13.0), tidyr (&ge; 1.1.0),
plyr (&ge; 1.8.6), dplyr (&ge; 1.0.1), foreach (&ge; 1.5.0),
doParallel (&ge; 1.0.15), labelled (&ge; 2.5.0), magrittr (&ge; 1.5)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>argparser (&ge; 0.6), bit64 (&ge; 4.0.2), knitr (&ge; 1.29),
rmarkdown (&ge; 2.3), testthat (&ge; 2.3.2)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-22 21:16:30 UTC; HDELOSSANTOS</td>
</tr>
<tr>
<td>Author:</td>
<td>Carrie Daymont [ctb, cre],
  Robert Grundmeier [aut],
  Jeffrey Miller [aut],
  Diego Campos [aut],
  Dan Chudnov [ctb],
  Hannah De los Santos [ctb],
  Lusha Cao [ctb],
  Steffani Silva [ctb],
  Hanzhe Zhang [ctb],
  Matt Boyas [ctb],
  David Freedman [ctb],
  Andreas Achilleos [ctb],
  Jessica Butts [ctb],
  Sheila Nguyen [ctb],
  Taraneh Soleymani [ctb],
  Max Olivier [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carrie Daymont &lt;cdaymont@pennstatehealth.psu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 19:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='acf_answers'>Answers for adjustcarryforward</h2><span id='topic+acf_answers'></span>

<h3>Description</h3>

<p>Determines what should absolutely be reincluded or definitely excluded
for a given dataset, already run through <code>cleangrowth</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf_answers(
  subjid,
  param,
  agedays,
  sex,
  measurement,
  orig.exclude,
  sd.recenter = NA,
  ewma.exp = -1.5,
  ref.data.path = "",
  quietly = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf_answers_+3A_subjid">subjid</code></td>
<td>
<p>Vector of unique identifiers for each subject in the database.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_param">param</code></td>
<td>
<p>Vector identifying each measurement, may be 'WEIGHTKG', 'HEIGHTCM', or 'LENGTHCM'
'HEIGHTCM' vs. 'LENGTHCM' only affects z-score calculations between ages 24 to 35 months (730 to 1095 days).
All linear measurements below 731 days of life (age 0-23 months) are interpreted as supine length, and
all linear measurements above 1095 days of life (age 36+ months) are interpreted as standing height.
Note: at the moment, all LENGTHCM will be converted to HEIGHTCM. In the future, the algorithm will be updated to consider this difference.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_agedays">agedays</code></td>
<td>
<p>Numeric vector containing the age in days at each measurement.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_sex">sex</code></td>
<td>
<p>Vector identifying the gender of the subject, may be 'M', 'm', or 0 for males, vs. 'F',
'f' or 1 for females.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_measurement">measurement</code></td>
<td>
<p>Numeric vector containing the actual measurement data.  Weight must be in
kilograms (kg), and linear measurements (height vs. length) in centimeters (cm).</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_orig.exclude">orig.exclude</code></td>
<td>
<p>Vector of exclusion assessment results from cleangrowth()</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_sd.recenter">sd.recenter</code></td>
<td>
<p>Data frame or table with median SD-scores per day of life</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_ewma.exp">ewma.exp</code></td>
<td>
<p>Exponent to use for weighting measurements in the exponentially weighted moving
average calculations. Defaults to -1.5. This exponent should be negative in order to weight growth
measurements closer to the measurement being evaluated more strongly. Exponents that are further from
zero (e.g. -3) will increase the relative influence of measurements close in time to the measurement
being evaluated compared to using the default exponent.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_ref.data.path">ref.data.path</code></td>
<td>
<p>Path to reference data. If not supplied, the year 2000
Centers for Disease Control (CDC) reference data will be used.</p>
</td></tr>
<tr><td><code id="acf_answers_+3A_quietly">quietly</code></td>
<td>
<p>Determines if function messages are to be displayed and if log files (parallel only)
are to be generated. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame, containing an index &quot;n&quot; of rows, corresponding to the
original order of the input vectors, and &quot;acf_answers&quot;, containing the answers
on whether a height value should be kept or excluded (returns &quot;Definitely
Exclude&quot;, &quot;Definitely Include&quot;, or &quot;Unknown&quot; for height values, NA for weight
values).
</p>

<hr>
<h2 id='adjustcarryforward'>adjustcarryforward
<code>adjustcarryforward</code> Uses absolute height velocity to identify values
excluded as carried forward values for reinclusion.</h2><span id='topic+adjustcarryforward'></span>

<h3>Description</h3>

<p>adjustcarryforward
<code>adjustcarryforward</code> Uses absolute height velocity to identify values
excluded as carried forward values for reinclusion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjustcarryforward(
  subjid,
  param,
  agedays,
  sex,
  measurement,
  orig.exclude,
  exclude_opt = 0,
  sd.recenter = NA,
  ewma.exp = -1.5,
  ref.data.path = "",
  quietly = TRUE,
  minfactor = 0.5,
  maxfactor = 2,
  banddiff = 3,
  banddiff_plus = 5.5,
  min_ht.exp_under = 2,
  min_ht.exp_over = 0,
  max_ht.exp_under = 0.33,
  max_ht.exp_over = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjustcarryforward_+3A_subjid">subjid</code></td>
<td>
<p>Vector of unique identifiers for each subject in the database.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_param">param</code></td>
<td>
<p>Vector identifying each measurement, may be 'WEIGHTKG', 'HEIGHTCM', or 'LENGTHCM'
'HEIGHTCM' vs. 'LENGTHCM' only affects z-score calculations between ages 24 to 35 months (730 to 1095 days).
All linear measurements below 731 days of life (age 0-23 months) are interpreted as supine length, and
all linear measurements above 1095 days of life (age 36+ months) are interpreted as standing height.
Note: at the moment, all LENGTHCM will be converted to HEIGHTCM. In the future, the algorithm will be updated to consider this difference.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_agedays">agedays</code></td>
<td>
<p>Numeric vector containing the age in days at each measurement.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_sex">sex</code></td>
<td>
<p>Vector identifying the gender of the subject, may be 'M', 'm', or 0 for males, vs. 'F',
'f' or 1 for females.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_measurement">measurement</code></td>
<td>
<p>Numeric vector containing the actual measurement data.  Weight must be in
kilograms (kg), and linear measurements (height vs. length) in centimeters (cm).</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_orig.exclude">orig.exclude</code></td>
<td>
<p>Vector of exclusion assessment results from cleangrowth()</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_exclude_opt">exclude_opt</code></td>
<td>
<p>Number from 0 to 3 indicating which option to use to handle strings of carried-forwards:
0. no change.
</p>

<ol>
<li><p> when deciding to exclude values, if we have a string of carried forwards,
drop the most deviant value, and all CFs in the same string, and move on as
normal.
</p>
</li>
<li><p> when deciding to exclude values, if the most deviant in a
string of carried forwards is flagged, check all the CFs in that
string from 1:N. Exclude all after the first that is flagged for
exclusion when comparing to the Include before and after. Do not
remove things designated as include.
</p>
</li>
<li><p> when deciding to exclude values, if the most deviant in a
string of carried forwards is flagged, check all the CFs in that
string from 1:N. Exclude all after the first that is flagged for
exclusion when comparing to the Include before and after. Make sure
remove things designated as include.
</p>
</li></ol>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_sd.recenter">sd.recenter</code></td>
<td>
<p>Data frame or table with median SD-scores per day of life</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_ewma.exp">ewma.exp</code></td>
<td>
<p>Exponent to use for weighting measurements in the exponentially weighted moving
average calculations. Defaults to -1.5. This exponent should be negative in order to weight growth
measurements closer to the measurement being evaluated more strongly. Exponents that are further from
zero (e.g. -3) will increase the relative influence of measurements close in time to the measurement
being evaluated compared to using the default exponent.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_ref.data.path">ref.data.path</code></td>
<td>
<p>Path to reference data. If not supplied, the year 2000
Centers for Disease Control (CDC) reference data will be used.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_quietly">quietly</code></td>
<td>
<p>Determines if function messages are to be displayed and if log files (parallel only)
are to be generated. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_minfactor">minfactor</code></td>
<td>
<p>Sweep variable for computing mindiff.next.ht in 15f, default 0.5</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_maxfactor">maxfactor</code></td>
<td>
<p>Sweep variable for computing maxdiff.next.ht in 15f, default 2</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_banddiff">banddiff</code></td>
<td>
<p>Sweep variable for computing mindiff.next.ht in 15f, default 3</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_banddiff_plus">banddiff_plus</code></td>
<td>
<p>Sweep variable for computing maxdiff.next.ht in 15, default 5.5</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_min_ht.exp_under">min_ht.exp_under</code></td>
<td>
<p>Sweep variable for computing ht.exp in 15f, default 2</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_min_ht.exp_over">min_ht.exp_over</code></td>
<td>
<p>Sweep variable for computing ht.exp in 15f, default 0</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_max_ht.exp_under">max_ht.exp_under</code></td>
<td>
<p>Sweep variable for computing ht.exp in 15f, default 0.33</p>
</td></tr>
<tr><td><code id="adjustcarryforward_+3A_max_ht.exp_over">max_ht.exp_over</code></td>
<td>
<p>Sweep variable for computing ht.exp in 15f, default 1.5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Re-evaluated exclusion assessments based on height velocity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Run on a small subset of given data
df &lt;- as.data.frame(syngrowth)
df &lt;- df[df$subjid %in% unique(df[, "subjid"])[1:2], ]
clean_df &lt;- cbind(df,
                  "gcr_result" = cleangrowth(df$subjid,
                                             df$param,
                                             df$agedays,
                                             df$sex,
                                             df$measurement))

# Adjust carry forward values in cleaned data
adj_clean &lt;- adjustcarryforward(subjid = clean_df$subjid,
                                param = clean_df$param,
                                agedays = clean_df$agedays,
                                sex = clean_df$sex,
                                measurement = clean_df$measurement,
                                orig.exclude = clean_df$gcr_result)

</code></pre>

<hr>
<h2 id='bmianthro'>BMI Anthro</h2><span id='topic+bmianthro'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains BMI data for calculating BMI
</p>


<h3>bmianthro.txt.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='CDCref_d'>CDC BMI reference data</h2><span id='topic+CDCref_d'></span>

<h3>Description</h3>

<p>Used for extended BMIz computation
</p>


<h3>CDCref_d.csv.gz</h3>

<p>Used for extended BMI computation
</p>

<hr>
<h2 id='cleangrowth'>Clean growth measurements</h2><span id='topic+cleangrowth'></span>

<h3>Description</h3>

<p>Clean growth measurements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleangrowth(
  subjid,
  param,
  agedays,
  sex,
  measurement,
  recover.unit.error = FALSE,
  sd.extreme = 25,
  z.extreme = 25,
  lt3.exclude.mode = "default",
  height.tolerance.cm = 2.5,
  error.load.mincount = 2,
  error.load.threshold = 0.5,
  sd.recenter = NA,
  sdmedian.filename = "",
  sdrecentered.filename = "",
  include.carryforward = FALSE,
  ewma.exp = -1.5,
  ref.data.path = "",
  log.path = NA,
  parallel = FALSE,
  num.batches = NA,
  quietly = TRUE,
  adult_cutpoint = 20,
  weight_cap = Inf,
  adult_columns_filename = "",
  prelim_infants = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cleangrowth_+3A_subjid">subjid</code></td>
<td>
<p>Vector of unique identifiers for each subject in the database.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_param">param</code></td>
<td>
<p>Vector identifying each measurement, may be 'WEIGHTKG', 'WEIGHTLBS', 'HEIGHTCM', 'HEIGHTIN', 'LENGTHCM', or 'HEADCM'.
'HEIGHTCM'/'HEIGHTIN' vs. 'LENGTHCM' only affects z-score calculations between ages 24 to 35 months (730 to 1095 days).
All linear measurements below 731 days of life (age 0-23 months) are interpreted as supine length, and
all linear measurements above 1095 days of life (age 36+ months) are interpreted as standing height.
Note: at the moment, all LENGTHCM will be converted to HEIGHTCM. In the future, the algorithm will be updated to consider this difference.
Additionally, imperial 'HEIGHTIN' and 'WEIGHTLBS' measurements are converted to
metric during algorithm calculations.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_agedays">agedays</code></td>
<td>
<p>Numeric vector containing the age in days at each measurement.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_sex">sex</code></td>
<td>
<p>Vector identifying the gender of the subject, may be 'M', 'm', or 0 for males, vs. 'F', 'f' or 1 for females.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_measurement">measurement</code></td>
<td>
<p>Numeric vector containing the actual measurement data.  Weight must be in
kilograms (kg), and linear measurements (height vs. length) in centimeters (cm).</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_recover.unit.error">recover.unit.error</code></td>
<td>
<p>Indicates whether the cleaning algorithm should
attempt to identify unit errors (I.e. inches vs. cm, lbs vs. kg). If unit
errors are identified, the value will be corrected and retained within the
cleaning algorithm as a valid measurement.  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_sd.extreme">sd.extreme</code></td>
<td>
<p>Measurements more than sd.extreme standard deviations from
the mean (either above or below) will be flagged as invalid. Defaults to 25.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_z.extreme">z.extreme</code></td>
<td>
<p>Measurements with an absolute z-score greater than
z.extreme will be flagged as invalid. Defaults to 25.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_lt3.exclude.mode">lt3.exclude.mode</code></td>
<td>
<p>Determines type of exclusion procedure to use for 1 or 2 measurements of one type without
matching same ageday measurements for the other parameter. Options include &quot;default&quot; (standard growthcleanr approach),
and &quot;flag.both&quot; (in case of two measurements of one type without matching values for the other parameter, flag both
for exclusion if beyond threshold)</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_height.tolerance.cm">height.tolerance.cm</code></td>
<td>
<p>maximum decrease in height tolerated for sequential measurements</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_error.load.mincount">error.load.mincount</code></td>
<td>
<p>minimum count of exclusions on parameter before
considering excluding all measurements. Defaults to 2.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_error.load.threshold">error.load.threshold</code></td>
<td>
<p>threshold of percentage of excluded measurement count to included measurement
count that must be exceeded before excluding all measurements of either parameter. Defaults to 0.5.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_sd.recenter">sd.recenter</code></td>
<td>
<p>specifies how to recenter medians. May be a data frame or
table w/median SD-scores per day of life by gender and parameter, or &quot;NHANES&quot;
or &quot;derive&quot; as a character vector.
</p>

<ul>
<li><p> If <code>sd.recenter</code> is specified as a data set, use the data set
</p>
</li>
<li><p> If <code>sd.recenter</code> is specified as &quot;<code>nhanes</code>&quot;, use NHANES reference medians
</p>
</li>
<li><p> If <code>sd.recenter</code> is specified as &quot;<code>derive</code>&quot;, derive from input
</p>
</li>
<li><p> If <code>sd.recenter</code> is not specified or <code>NA</code>:
</p>

<ul>
<li><p> If the input set has at least 5,000 observations, derive medians from input
</p>
</li>
<li><p> If the input set has fewer than 5,000 observations, use NHANES
</p>
</li></ul>

</li></ul>

<p>If specifying a data set, columns must include param, sex, agedays, and sd.median
(referred to elsewhere as &quot;modified Z-score&quot;), and those medians will be used
for recentering. A summary of how the NHANES reference medians were derived is
available in README.md. Defaults to NA.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_sdmedian.filename">sdmedian.filename</code></td>
<td>
<p>Name of file to save sd.median data calculated on the input dataset to as CSV.
Defaults to &quot;&quot;, for which this data will not be saved. Use for extracting medians for parallel processing
scenarios other than the built-in parallel option.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_sdrecentered.filename">sdrecentered.filename</code></td>
<td>
<p>Name of file to save re-centered data to as CSV. Defaults to &quot;&quot;, for which this
data will not be saved. Useful for post-processing and debugging.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_include.carryforward">include.carryforward</code></td>
<td>
<p>Determines whether Carry-Forward values are kept in the output. Defaults to False.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_ewma.exp">ewma.exp</code></td>
<td>
<p>Exponent to use for weighting measurements in the
exponentially weighted moving average calculations. Defaults to -1.5.
This exponent should be negative in order to weight growth measurements
closer to the measurement being evaluated more strongly. Exponents that are
further from zero (e.g. -3) will increase the relative influence of
measurements close in time to the measurement being evaluated compared to
using the default exponent.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_ref.data.path">ref.data.path</code></td>
<td>
<p>Path to reference data. If not supplied, the year 2000
Centers for Disease Control (CDC) reference data will be used.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_log.path">log.path</code></td>
<td>
<p>Path to log file output when running in parallel (non-quiet mode). Default is NA. A new
directory will be created if necessary. Set to NA to disable log files.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_parallel">parallel</code></td>
<td>
<p>Determines if function runs in parallel.  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_num.batches">num.batches</code></td>
<td>
<p>Specify the number of batches to run in parallel. Only
applies if parallel is set to TRUE. Defaults to the number of workers
returned by the getDoParWorkers function in the foreach package.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_quietly">quietly</code></td>
<td>
<p>Determines if function messages are to be displayed and if log files (parallel only) are to be generated.
Defaults to TRUE</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_adult_cutpoint">adult_cutpoint</code></td>
<td>
<p>Number between 18 and 20, describing ages when the
pediatric algorithm should not be applied (&lt; adult_cutpoint), and the adult
algorithm should apply (&gt;= adult_cutpoint). Numbers outside this range will be
changed to the closest number within the range. Defaults to 20.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_weight_cap">weight_cap</code></td>
<td>
<p>Positive number, describing a weight cap in kg (rounded to the
nearest .1, +/- .1) within the adult dataset. If there is no weight cap, set
to Inf. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_adult_columns_filename">adult_columns_filename</code></td>
<td>
<p>Name of file to save original adult data, with additional output columns to
as CSV. Defaults to &quot;&quot;, for which this data will not be saved. Useful
for post-analysis. For more information on this output, please see README.</p>
</td></tr>
<tr><td><code id="cleangrowth_+3A_prelim_infants">prelim_infants</code></td>
<td>
<p>TRUE/FALSE. Run the in-development release of the infants algorithm (expands pediatric algorithm to improve performance for children 0 – 2 years). Not recommended for use in research. For more information regarding the logic of the algorithm, see the vignette 'Preliminary Infants Algorithm.' Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of exclusion codes for each of the input measurements.
</p>
<p>Possible values for each code are:
</p>

<ul>
<li><p> 'Include', 'Unit-Error-High', 'Unit-Error-Low', 'Swapped-Measurements', 'Missing',
</p>
</li>
<li><p> 'Exclude-Carried-Forward', 'Exclude-SD-Cutoff', 'Exclude-EWMA-Extreme', 'Exclude-EWMA-Extreme-Pair',
</p>
</li>
<li><p> 'Exclude-Extraneous-Same-Day',
</p>
</li>
<li><p> 'Exclude-EWMA-8', 'Exclude-EWMA-9', 'Exclude-EWMA-10', 'Exclude-EWMA-11', 'Exclude-EWMA-12', 'Exclude-EWMA-13', 'Exclude-EWMA-14',
</p>
</li>
<li><p> 'Exclude-Min-Height-Change', 'Exclude-Max-Height-Change',
</p>
</li>
<li><p> 'Exclude-Pair-Delta-17', 'Exclude-Pair-Delta-18', 'Exclude-Pair-Delta-19',
</p>
</li>
<li><p> 'Exclude-Single-Outlier', 'Exclude-Too-Many-Errors', 'Exclude-Too-Many-Errors-Other-Parameter'
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Run calculation using a small subset of given data
df_stats &lt;- as.data.frame(syngrowth)
df_stats &lt;- df_stats[df_stats$subjid %in% unique(df_stats[, "subjid"])[1:5], ]

clean_stats &lt;-cleangrowth(subjid = df_stats$subjid,
                         param = df_stats$param,
                         agedays = df_stats$agedays,
                         sex = df_stats$sex,
                         measurement = df_stats$measurement)

# Once processed you can filter data based on result value
df_stats &lt;- cbind(df_stats, "clean_result" = clean_stats)
clean_df_stats &lt;- df_stats[df_stats$clean_result == "Include",]

# Parallel processing: run using 2 cores and batches
clean_stats &lt;- cleangrowth(subjid = df_stats$subjid,
                           param = df_stats$param,
                           agedays = df_stats$agedays,
                           sex = df_stats$sex,
                           measurement = df_stats$measurement,
                           parallel = TRUE,
                           num.batches = 2)

</code></pre>

<hr>
<h2 id='ewma'>Exponentially Weighted Moving Average (EWMA)</h2><span id='topic+ewma'></span>

<h3>Description</h3>

<p><code>ewma</code> calculates the exponentially weighted moving average (EWMA) for a set of numeric observations over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ewma(agedays, z, ewma.exp, ewma.adjacent = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ewma_+3A_agedays">agedays</code></td>
<td>
<p>Vector of age in days for each z score (potentially transformed to adjust weighting).</p>
</td></tr>
<tr><td><code id="ewma_+3A_z">z</code></td>
<td>
<p>Input vector of numeric z-score data.</p>
</td></tr>
<tr><td><code id="ewma_+3A_ewma.exp">ewma.exp</code></td>
<td>
<p>Exponent to use for weighting.</p>
</td></tr>
<tr><td><code id="ewma_+3A_ewma.adjacent">ewma.adjacent</code></td>
<td>
<p>Specify whether EWMA values excluding adjacent measurements should be calculated.  Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with 3 variables:
</p>

<ul>
<li><p> The first variable (ewma.all) contains the EWMA at observation time
excluding only the actual observation for that time point.
</p>
</li>
<li><p> The second variable (ewma.before) contains the EWMA for each observation excluding both the actual observation
and the immediate prior observation.
</p>
</li>
<li><p> The third variable (ewma.after) contains the EWMA for each observation excluding both the actual observation
and the subsequent observation.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Run on 1 subject, 1 type of parameter
df_stats &lt;- as.data.frame(syngrowth)
df_stats &lt;- df_stats[df_stats$subjid == df_stats$subjid[1] &amp;
                       df_stats$param == "HEIGHTCM", ]

# Get the uncentered z-scores
measurement_to_z &lt;- read_anthro(cdc.only = TRUE)
sd &lt;- measurement_to_z(df_stats$param,
                       df_stats$agedays,
                       df_stats$sex,
                       df_stats$measurement,
                       TRUE)

# Calculate exponentially weighted moving average
e_df &lt;- ewma(df_stats$agedays, sd, ewma.exp = -1.5)
</code></pre>

<hr>
<h2 id='ext_bmiz'>Calculate extended BMI measures</h2><span id='topic+ext_bmiz'></span>

<h3>Description</h3>

<p><code>ext_bmiz</code> Calculates the sigma (scale parameter for the half-normal
distribution), extended BMI percentile, extended BMIz, and the CDC LMS
Z-scores for weight, height, and BMI for children between 2 and 19.9 years
of age. Note that for BMIs &lt;= 95th percentile of the CDC growth charts, the
extended values for BMI are equal to the LMS values. The extended values
differ only for children who have a BMI &gt; 95th percentile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ext_bmiz(
  data,
  age = "agem",
  wt = "wt",
  ht = "ht",
  bmi = "bmi",
  adjust.integer.age = TRUE,
  ref.data.path = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ext_bmiz_+3A_data">data</code></td>
<td>
<p>Input data frame or data table</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_age">age</code></td>
<td>
<p>Name of input column containing subject age in months in quotes, default &quot;agem&quot;</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_wt">wt</code></td>
<td>
<p>Name of input column containing weight (kg) value in quotes, default &quot;wt&quot;</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_ht">ht</code></td>
<td>
<p>Name of input column containing height (cm) value in quotes, default &quot;ht&quot;</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_bmi">bmi</code></td>
<td>
<p>Name of input column containing calculated BMI in quotes, default &quot;bmi&quot;</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_adjust.integer.age">adjust.integer.age</code></td>
<td>
<p>If age inputs are all integer, add 0.5 if TRUE;
default TRUE</p>
</td></tr>
<tr><td><code id="ext_bmiz_+3A_ref.data.path">ref.data.path</code></td>
<td>
<p>Path to directory containing reference data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should produce output equivalent to the SAS macro provided at
https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm. The macro
was updated in December, 2022, according to the findings of the NCHS
report available at https://dx.doi.org/10.15620/cdc:121711. This function has
been updated to match it as of growthcleanr v2.1.0.
</p>
<p>The extended BMIz is the inverse cumulative distribution function (CDF) of
the extended BMI percentile. If the extended percentile is very close to
100, the <code>qnorm</code> function in R produces an infinite value. This occurs
only if the the extended BMI percentile is &gt; 99.99999999999999. This occurs
infrequently, such as a 48-month-old with a BMI &gt; 39, and it is likely that
these BMIs represent data entry errors. For these cases, extended BMIz is
set to 8.21, a value that is slightly greater than the largest value that
can be calculated.
</p>
<p>See the <code>README.md</code> file for descriptions of the output columns
generated by this function.
</p>
<p><code>data</code> must have columns for at least age, sex, weight, height, and bmi.
</p>
<p><code>age</code> should be coded in months, using the most precise values available.
To convert to months from age in years, multiply by 12. To convert to months
from age in days, divide by 30.4375 (365.25 / 12).
</p>
<p><code>sex</code> is coded as 1, boys, Boys, b, B, males, Males, m, or M for male
subjects or 2, girls, Girls, g, G, females, Females, f, or F for female
subjects. Note that this is different from <code>cleangrowth</code>, which uses
0 (Male) and 1 (Female).
</p>
<p><code>wt</code> should be in kilograms.
</p>
<p><code>ht</code> should be in centimeters.
</p>
<p>Specify the input data parameter names for <code>age</code>, <code>wt</code>,
<code>ht</code>, <code>bmi</code> using quotation marks. See example below.
</p>
<p>If the parameter <code>adjust.integer.age</code> is <code>TRUE</code> (the default),
0.5 will be added to all <code>age</code> if all input values are integers. Set to
<code>FALSE</code> to disable.
</p>
<p>By default, the reference data file <code>CDCref_d.csv</code>, made available at
https://www.cdc.gov/nccdphp/dnpao/growthcharts/resources/sas.htm, is included
in this package for convenience. If you are developing this package, use
<code>ref.data.path</code> to adjust the path to this file from your working
directory if necessary.
</p>


<h3>Value</h3>

<p>Expanded data frame containing computed BMI values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Run on a small subset of given data
df &lt;- as.data.frame(syngrowth)
df &lt;- df[df$subjid %in% unique(df[, "subjid"])[1:5], ]
df &lt;- cbind(df,
            "gcr_result" = cleangrowth(df$subjid,
                                       df$param,
                                       df$agedays,
                                       df$sex,
                                       df$measurement))
df_wide &lt;- longwide(df) # convert to wide format for ext_bmiz
df_wide_bmi &lt;- simple_bmi(df_wide) # compute simple BMI

# Calling the function with default column names
df_bmiz &lt;- ext_bmiz(df_wide_bmi)

# Specifying different column names; note that quotes are used
dfc &lt;- simple_bmi(df_wide)
colnames(dfc)[colnames(dfc) %in% c("agem", "wt", "ht")] &lt;-
  c("agemos", "weightkg", "heightcm")
df_bmiz &lt;- ext_bmiz(dfc, age="agemos", wt="weightkg", ht="heightcm")

# Disabling conversion of all-integer age in months to (age + 0.5)
dfc &lt;- simple_bmi(df_wide)
df_bmiz &lt;- ext_bmiz(dfc, adjust.integer.age=FALSE)

</code></pre>

<hr>
<h2 id='fentlms_foraga'>Fenton Growth Curves</h2><span id='topic+fentlms_foraga'></span>

<h3>Description</h3>

<p>Fenton growth curves with premature infant data with sex, age, and integer
weight
</p>


<h3>fentlms_foraga.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='fentlms_forz'>Fenton Growth Curve Z-Scores</h2><span id='topic+fentlms_forz'></span>

<h3>Description</h3>

<p>Fenton growth curves with premature infant z-scores for height and head
circumference
</p>


<h3>fentlms_forz.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='growth_cdc_ext'>CDC Growth Percentile Table</h2><span id='topic+growth_cdc_ext'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains percentiles for various ages, gender, and weights, pre-calculated by CDC
</p>


<h3>growthfile_cdc_ext.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='growth_cdc_ext_infants'>CDC Growth Percentile Table for Infants</h2><span id='topic+growth_cdc_ext_infants'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains percentiles for various ages, gender, and weights, pre-calculated by CDC for infants algorithm
</p>


<h3>growthfile_cdc_ext_infants.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='growth_who_ext'>WHO Growth Percentile Table</h2><span id='topic+growth_who_ext'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains percentiles for various ages, gender, and weights, pre-calculated by WHO
</p>


<h3>growthfile_who.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='lenanthro'>Length to Age Table</h2><span id='topic+lenanthro'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains percentiles for various ages, gender, and weights, pre-calculated by CDC
</p>


<h3>lenanthro.txt.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='longwide'>Transform data in growthcleanr format into wide structure for BMI calculation</h2><span id='topic+longwide'></span>

<h3>Description</h3>

<p><code>longwide</code> transforms data from long to wide format. Ideal for
transforming output from growthcleanr::cleangrowth() into a format suitable
for growthcleanr::ext_bmiz().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>longwide(
  long_df,
  id = "id",
  subjid = "subjid",
  sex = "sex",
  agedays = "agedays",
  param = "param",
  measurement = "measurement",
  gcr_result = "gcr_result",
  include_all = FALSE,
  inclusion_types = c("Include"),
  extra_cols = NULL,
  keep_unmatched_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="longwide_+3A_long_df">long_df</code></td>
<td>
<p>A data frame to be transformed. Expects columns: id, subjid,
sex, agedays, param, measurement, and gcr_result.</p>
</td></tr>
<tr><td><code id="longwide_+3A_id">id</code></td>
<td>
<p>name of observation ID column</p>
</td></tr>
<tr><td><code id="longwide_+3A_subjid">subjid</code></td>
<td>
<p>name of subject ID column</p>
</td></tr>
<tr><td><code id="longwide_+3A_sex">sex</code></td>
<td>
<p>name of sex descriptor column</p>
</td></tr>
<tr><td><code id="longwide_+3A_agedays">agedays</code></td>
<td>
<p>name of age (in days) descriptor column</p>
</td></tr>
<tr><td><code id="longwide_+3A_param">param</code></td>
<td>
<p>name of parameter column to identify each type of measurement</p>
</td></tr>
<tr><td><code id="longwide_+3A_measurement">measurement</code></td>
<td>
<p>name of measurement column containing the actual
measurement data</p>
</td></tr>
<tr><td><code id="longwide_+3A_gcr_result">gcr_result</code></td>
<td>
<p>name of column of results from growthcleanr::cleangrowth()</p>
</td></tr>
<tr><td><code id="longwide_+3A_include_all">include_all</code></td>
<td>
<p>Determines whether the function keeps all exclusion codes.
If TRUE, all exclusion types are kept and the inclusion_types argument is
ignored. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="longwide_+3A_inclusion_types">inclusion_types</code></td>
<td>
<p>Vector indicating which exclusion codes from the
cleaning algorithm should be included in the data, given that include_all is
FALSE. For all options, see growthcleanr::cleangrowth(). Defaults to
c(&quot;Include&quot;).</p>
</td></tr>
<tr><td><code id="longwide_+3A_extra_cols">extra_cols</code></td>
<td>
<p>Vector of additional columns to include in the output. If
a column C1 differs on agedays matched height and weight values, then include
separate ht_C1 and wt_C1 columns as well as a match_C1 column that gives
booleans indicating where ht_C1 and wt_C1 are the same. If the agedays
matched height and weight columns are identical, then only include a single
version of C1. Defaults to empty vector (not keeping any additional columns).</p>
</td></tr>
<tr><td><code id="longwide_+3A_keep_unmatched_data">keep_unmatched_data</code></td>
<td>
<p>boolean indicating whether to keep height/weight
observations that do not have a matching weight/height on that day</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame transformed from long to wide. Includes only
values flagged with indicated inclusion types. Potentially includes
additional columns if arguments are passed to extra_cols. For each subject,
heights without corresponding weights for a given age (and vice versa) will
be dropped unless keep_unmatched_data is set to TRUE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Run on a small subset of given data
df &lt;- as.data.frame(syngrowth)
df &lt;- df[df$subjid %in% unique(df[, "subjid"])[1:2], ]
df &lt;- cbind(df,
            "gcr_result" = cleangrowth(df$subjid,
                                       df$param,
                                       df$agedays,
                                       df$sex,
                                       df$measurement))
# Convert to wide format
wide_df &lt;- longwide(df)

# Include all inclusion types
wide_df &lt;- longwide(df, include_all = TRUE)

# Specify all inclusion codes
wide_df &lt;- longwide(df, inclusion_types = c("Include", "Exclude-Carried-Forward"))

</code></pre>

<hr>
<h2 id='nhanes-reference-medians'>NHANES reference medians</h2><span id='topic+nhanes-reference-medians'></span>

<h3>Description</h3>

<p>Contains reference median values for default recentering, derived from NHANES
years 2009-2018
</p>


<h3>nhanes-reference-medians.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='rc-reference-medians'>Infants reference medians</h2><span id='topic+rc-reference-medians'></span>

<h3>Description</h3>

<p>Contains reference median values for default recentering in the infants
algorithm
</p>


<h3>rcfile-2023-08-15_format.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='read_anthro'>Function to calculate z-scores and csd-scores based on anthro tables.</h2><span id='topic+read_anthro'></span>

<h3>Description</h3>

<p>Function to calculate z-scores and csd-scores based on anthro tables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_anthro(path = "", cdc.only = FALSE, prelim_infants = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_anthro_+3A_path">path</code></td>
<td>
<p>Path to supplied reference anthro data. Defaults to package anthro tables.</p>
</td></tr>
<tr><td><code id="read_anthro_+3A_cdc.only">cdc.only</code></td>
<td>
<p>Whether or not only CDC data should be used. Defaults to false.</p>
</td></tr>
<tr><td><code id="read_anthro_+3A_prelim_infants">prelim_infants</code></td>
<td>
<p>TRUE/FALSE. Run the in-development release of the infants algorithm (expands pediatric algorithm to improve performance for children 0 – 2 years). Not recommended for use in research. For more information regarding the logic of the algorithm, see the vignette 'Preliminary Infants Algorithm.' Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function for calculating BMI based on measurement, age in days, sex, and measurement value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Return calculating function with all defaults
afunc &lt;- read_anthro()

# Return calculating function while specifying a path and using only CDC data
afunc &lt;- read_anthro(path = system.file("extdata", package = "growthcleanr"),
                     cdc.only = TRUE)

</code></pre>

<hr>
<h2 id='recode_sex'>Recode binary sex variable for compatibility</h2><span id='topic+recode_sex'></span>

<h3>Description</h3>

<p><code>recode_sex</code> recodes a binary sex variable for a given source column in a data frame or data table.
Useful in transforming output from growthcleanr::cleangrowth() into a format suitable for growthcleanr::ext_bmiz().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recode_sex(
  input_data,
  sourcecol = "sex",
  sourcem = "0",
  sourcef = "1",
  targetcol = "sex_recoded",
  targetm = 1L,
  targetf = 2L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recode_sex_+3A_input_data">input_data</code></td>
<td>
<p>a data frame or data table to be transformed. Expects a source column containing a binary sex variable.</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_sourcecol">sourcecol</code></td>
<td>
<p>name of sex descriptor column. Defaults to &quot;sex&quot;</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_sourcem">sourcem</code></td>
<td>
<p>variable indicating &quot;male&quot; sex in input data. Defaults to &quot;0&quot;</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_sourcef">sourcef</code></td>
<td>
<p>variable indicating &quot;female&quot; sex in input data. Defaults to &quot;1&quot;</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_targetcol">targetcol</code></td>
<td>
<p>desired name of recoded sex descriptor column. Defaults to &quot;sex_recoded&quot;</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_targetm">targetm</code></td>
<td>
<p>desired name of recoded sex variable indicating &quot;male&quot; sex in output data. Defaults to 1</p>
</td></tr>
<tr><td><code id="recode_sex_+3A_targetf">targetf</code></td>
<td>
<p>desired name of recoded sex variable indicating &quot;female&quot; sex in output data. Defaults to 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data table with recoded sex variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run on given data
df &lt;- as.data.frame(syngrowth)

# Run with all defaults
df_r &lt;- recode_sex(df)

# Specify different targets
df_rt &lt;- recode_sex(df, targetcol = "sexr", targetm = "Male", targetf = "Female")

# Specify different inputs
df_ri &lt;- recode_sex(df_rt, sourcecol = "sexr", sourcem = "Male", sourcef = "Female")
</code></pre>

<hr>
<h2 id='sd_median'>Calculate median SD score by age for each parameter.</h2><span id='topic+sd_median'></span>

<h3>Description</h3>

<p>Calculate median SD score by age for each parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd_median(param, sex, agedays, sd.orig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sd_median_+3A_param">param</code></td>
<td>
<p>Vector identifying each measurement, may be 'WEIGHTKG', or 'HEIGHTCM'.</p>
</td></tr>
<tr><td><code id="sd_median_+3A_sex">sex</code></td>
<td>
<p>Vector identifying the gender of the subject, may be 'M', 'm', or 0 for males, vs. 'F', 'f' or 1 for females.</p>
</td></tr>
<tr><td><code id="sd_median_+3A_agedays">agedays</code></td>
<td>
<p>Numeric vector containing the age in days at each measurement.</p>
</td></tr>
<tr><td><code id="sd_median_+3A_sd.orig">sd.orig</code></td>
<td>
<p>Vector of previously calculated standard deviation (SD) scores for each measurement before re-centering.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table of data with median SD-scores per day of life by gender and parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run on 1 subject
df_stats &lt;- as.data.frame(syngrowth)
df_stats &lt;- df_stats[df_stats$subjid == df_stats$subjid[1], ]

# Get the original standard deviations
measurement_to_z &lt;- read_anthro(cdc.only = TRUE)
sd.orig &lt;- measurement_to_z(df_stats$param,
                       df_stats$agedays,
                       df_stats$sex,
                       df_stats$measurement,
                       TRUE)

# Calculate median standard deviations
sd.m &lt;- sd_median(df_stats$param,
                  df_stats$sex,
                  df_stats$agedays,
                  sd.orig)
</code></pre>

<hr>
<h2 id='simple_bmi'>Compute BMI using standard formula</h2><span id='topic+simple_bmi'></span>

<h3>Description</h3>

<p><code>simple_bmi</code> Computes BMI using standard formula. Assumes input compatible with
output from longwide().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simple_bmi(wide_df, wtcol = "wt", htcol = "ht")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simple_bmi_+3A_wide_df">wide_df</code></td>
<td>
<p>A data frame or data table containing heights and weights in
wide format, e.g., after transformation with longwide()</p>
</td></tr>
<tr><td><code id="simple_bmi_+3A_wtcol">wtcol</code></td>
<td>
<p>name of observation height value column, default 'wt'</p>
</td></tr>
<tr><td><code id="simple_bmi_+3A_htcol">htcol</code></td>
<td>
<p>name of subject weight value column, default 'ht'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data table with the added column &quot;bmi&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simple usage
# Run on a small subset of given data
df &lt;- as.data.frame(syngrowth)
df &lt;- df[df$subjid %in% unique(df[, "subjid"])[1:2], ]
df &lt;- cbind(df,
            "gcr_result" = cleangrowth(df$subjid,
                                       df$param,
                                       df$agedays,
                                       df$sex,
                                       df$measurement))
# Convert to wide format
wide_df &lt;- longwide(df)
wide_df_with_bmi &lt;- simple_bmi(wide_df)

# Specifying different column names; note that quotes are used
colnames(wide_df)[colnames(wide_df) %in% c("wt", "ht")] &lt;-
  c("weight", "height")
wide_df_with_bmi &lt;- simple_bmi(wide_df, wtcol = "weight", htcol = "height")

</code></pre>

<hr>
<h2 id='splitinput'>Split input data into multiple files</h2><span id='topic+splitinput'></span>

<h3>Description</h3>

<p><code>splitinput</code> Splits input based on keepcol specified, yielding csv files each with at least the mininum
number of rows that are written and saved separately (except for the last split file written, which may be
smaller). Allows splitting input data while ensuring all records for each individual subject will stay together
in one file. Pads split filenames with zeros out to five digits for consistency, assuming &lt; 100,000 file count
result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitinput(
  df,
  fname = deparse(substitute(df)),
  fdir = NA,
  min_nrow = 10000,
  keepcol = "subjid"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitinput_+3A_df">df</code></td>
<td>
<p>data frame to split</p>
</td></tr>
<tr><td><code id="splitinput_+3A_fname">fname</code></td>
<td>
<p>new name for each of the split files to start with</p>
</td></tr>
<tr><td><code id="splitinput_+3A_fdir">fdir</code></td>
<td>
<p>directory to put each of the split files (use &quot;.&quot; for  working directory). Must be changed from default (NA), which will trigger error.</p>
</td></tr>
<tr><td><code id="splitinput_+3A_min_nrow">min_nrow</code></td>
<td>
<p>minimum number of rows for each split file (default 10000)</p>
</td></tr>
<tr><td><code id="splitinput_+3A_keepcol">keepcol</code></td>
<td>
<p>the column name (default &quot;subjid&quot;) to use to keep records with the same values together in the same single split file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the count number referring to the last split file written
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Run on given data
df &lt;- as.data.frame(syngrowth)

# Run with all defaults (specifying directory)
splitinput(df, fdir = tempdir())

# Specifying the name, directory and minimum row size
splitinput(df, fname = "syngrowth", fdir = tempdir(), min_nrow = 5000)

# Specifying a different subject ID column
colnames(df)[colnames(df) == "subjid"] &lt;- "sub_id"
splitinput(df, fdir = tempdir(), keepcol = "sub_id")

</code></pre>

<hr>
<h2 id='syngrowth'>syngrowth</h2><span id='topic+syngrowth'></span>

<h3>Description</h3>

<p>A synthetic set of measurements from ~3,500
subjects generated using Synthea, with measurement errors
for testing with growthcleanr. Contains both pediatric and adult data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syngrowth
</code></pre>


<h3>Format</h3>

<p>A data frame with six variables: <code>id</code>, <code>subjid</code>,
<code>sex</code>, <code>agedays</code>, <code>param</code>, and <code>measurement</code>
</p>


<h3>Details</h3>

<p>Example electronic health record (heightcm, weightkg) data.
</p>

<hr>
<h2 id='tanner_ht_vel'>Tanner Growth Velocity Table</h2><span id='topic+tanner_ht_vel'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains velocities for growth pre-calculated by CDC
</p>


<h3>tanner_ht_vel.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='tanner_ht_vel_rev'>Tanner Growth Velocity Table for Infants</h2><span id='topic+tanner_ht_vel_rev'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains velocities for growth pre-calculated by CDC, used for the infants
algorithm
</p>


<h3>tanner_ht_vel_rev.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='tanner_ht_vel_with_2sd'>Tanner Growth Velocity Table with (2<code class="reqn">\sigma</code>)</h2><span id='topic+tanner_ht_vel_with_2sd'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains velocities for growth pre-calculated by CDC, including those 2
standard deviations away.
</p>


<h3>tanner_ht_vel_with_2sd.csv.gz</h3>

<p>Used in function <code>acf_answers()</code>
</p>

<hr>
<h2 id='test_syngrowth_sas_output_compare'>CDC SAS BMI Output</h2><span id='topic+test_syngrowth_sas_output_compare'></span>

<h3>Description</h3>

<p>Contains results of CDC SAS macro for calculating BMI values.
</p>


<h3>test_syngrowth_sas_output_compare.csv.gz</h3>

<p>Used to test function <code>ext_bmiz()</code>
</p>

<hr>
<h2 id='test_syngrowth_wide'>CDC SAS BMI Input</h2><span id='topic+test_syngrowth_wide'></span>

<h3>Description</h3>

<p>Contains input data for CDC SAS macro for calculating BMI values.
</p>


<h3>test_syngrowth_wide.csv.gz</h3>

<p>Used to test function <code>ext_bmiz()</code>
</p>

<hr>
<h2 id='testacf'>Function to test adjust carried forward</h2><span id='topic+testacf'></span>

<h3>Description</h3>

<p>The goal of this script is to consider the height values that growthcleanr
excludes as “carried forward” for potential re-inclusion by using a reverse
absolute height velocity check based on step 15 of the Daymont et al.
algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testacf(
  infile,
  seed = 7,
  searchtype = "random",
  grid.length = 9,
  writeout = FALSE,
  outfile = paste0("test_adjustcarryforward_", format(Sys.time(),
    "%m-%d-%Y_%H-%M-%S")),
  quietly = FALSE,
  param = "none",
  debug = FALSE,
  maxrecs = 0,
  exclude_opt = 0,
  add_answers = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testacf_+3A_infile">infile</code></td>
<td>
<p>Input data frame/data table, cleaned by cleangrowth(), with columns as described in main README.md</p>
</td></tr>
<tr><td><code id="testacf_+3A_seed">seed</code></td>
<td>
<p>Numeric random seed, used only when performing random search</p>
</td></tr>
<tr><td><code id="testacf_+3A_searchtype">searchtype</code></td>
<td>
<p>Type of search to perform: random (default), line-grid,
full-grid</p>
</td></tr>
<tr><td><code id="testacf_+3A_grid.length">grid.length</code></td>
<td>
<p>Number of steps in grid to search</p>
</td></tr>
<tr><td><code id="testacf_+3A_writeout">writeout</code></td>
<td>
<p>Write output to file? Default FALSE.</p>
</td></tr>
<tr><td><code id="testacf_+3A_outfile">outfile</code></td>
<td>
<p>&quot;Output file name, default 'test_adjustcarrforward_DATE_TIME', where DATE is the current system date and time&quot;</p>
</td></tr>
<tr><td><code id="testacf_+3A_quietly">quietly</code></td>
<td>
<p>Verbose progress info</p>
</td></tr>
<tr><td><code id="testacf_+3A_param">param</code></td>
<td>
<p>&quot;none&quot;, or data frame to specify which parameters to run full search on, and values to use if not, used only when performing full-grid search</p>
</td></tr>
<tr><td><code id="testacf_+3A_debug">debug</code></td>
<td>
<p>Produce extra data files for debugging</p>
</td></tr>
<tr><td><code id="testacf_+3A_maxrecs">maxrecs</code></td>
<td>
<p>Limit to specified # subjects, default 0 (no limit)</p>
</td></tr>
<tr><td><code id="testacf_+3A_exclude_opt">exclude_opt</code></td>
<td>
<p>Type of exclusion method for carried forward strings, 0 to 3. See adjustcarryforward documentation for more information</p>
</td></tr>
<tr><td><code id="testacf_+3A_add_answers">add_answers</code></td>
<td>
<p>TRUE or FALSE, indicating whether or not to add answers (definely include/exclude) for the given dataset. Defaults to TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
testacf_res: data frame with adjustcarryforward results for each run,
params: a data frame containing parameter values for each run.
debug_filtered_data: data frame with original data, returned if debug TRUE
</p>

<hr>
<h2 id='weianthro'>Weight Anthro Table</h2><span id='topic+weianthro'></span>

<h3>Description</h3>

<p>Part of default CDC-derived tables
</p>


<h3>Details</h3>

<p>Contains median and standard deviation for weight by age and gender
</p>


<h3>weianthro.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='who_hc_maxvel'>WHO Maximum Head Circumference Velocity for (3<code class="reqn">\sigma</code>)</h2><span id='topic+who_hc_maxvel'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains three standard deviations for the World Health Organization values of
maximum head circumference velocities.
</p>


<h3>who_hc_maxvel_3sd_infants.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='who_hc_vel_3sd'>WHO Head Circumference Velocity for (3<code class="reqn">\sigma</code>)</h2><span id='topic+who_hc_vel_3sd'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains three standard deviations for the World Health Organization values of
head circumference velocities.
</p>


<h3>who_hc_vel_3sd_infants.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='who_ht_maxvel'>WHO Maximum Height Velocity for (3<code class="reqn">\sigma</code>)</h2><span id='topic+who_ht_maxvel'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains three standard deviations for the World Health Organization values of
maximum height velocities.
</p>


<h3>who_ht_maxvel_3sd.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

<hr>
<h2 id='who_ht_maxvel_2sd'>WHO Maximum Height Velocity for (2<code class="reqn">\sigma</code>)</h2><span id='topic+who_ht_maxvel_2sd'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains two standard deviations for the World Health Organization values of
maximum height velocities.
</p>


<h3>who_ht_maxvel_2sd.csv.gz</h3>

<p>Used in function <code>acf_answers()</code>
</p>

<hr>
<h2 id='who_ht_vel_2sd'>WHO Height Velocity for (2<code class="reqn">\sigma</code>)</h2><span id='topic+who_ht_vel_2sd'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains two standard deviations for the World Health Organization values of
height velocities.
</p>


<h3>who_ht_vel_2sd.csv.gz</h3>

<p>Used in function <code>acf_answers()</code>
</p>

<hr>
<h2 id='who_ht_vel_3sd'>WHO Height Velocity for (3<code class="reqn">\sigma</code>)</h2><span id='topic+who_ht_vel_3sd'></span>

<h3>Description</h3>

<p>Part of default WHO-derived tables
</p>


<h3>Details</h3>

<p>Contains three standard deviations for the World Health Organization values of
height velocities.
</p>


<h3>who_ht_vel_3sd.csv.gz</h3>

<p>Used in function <code>cleangrowth()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
