<!DOCTYPE html><html><head><title>Help for package incidence2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {incidence2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#incidence2-package'><p>incidence2: Compute, Handle and Plot Incidence of Dated Events</p></a></li>
<li><a href='#accessors'><p>Access various elements of an incidence object</p></a></li>
<li><a href='#as_incidence'><p>Coerce to an incidence object</p></a></li>
<li><a href='#as.data.frame.incidence2'><p>Convert incident object to a data frame</p></a></li>
<li><a href='#complete_dates'><p>Complete dates for all group combinations</p></a></li>
<li><a href='#covidregionaldataUK'><p>Regional data for COVID-19 cases in the UK</p></a></li>
<li><a href='#cumulate'><p>Compute cumulative 'incidence'</p></a></li>
<li><a href='#incidence'><p>Compute the incidence of events</p></a></li>
<li><a href='#incidence2-defunct'><p>Functions now defunct in package incidence2</p></a></li>
<li><a href='#keep'><p>Keep first, last and peak occurences</p></a></li>
<li><a href='#plot.incidence2'><p>Plot an incidence object</p></a></li>
<li><a href='#print.incidence2'><p>Print an incidence object.</p></a></li>
<li><a href='#regroup'><p>Regroup 'incidence' objects</p></a></li>
<li><a href='#s3_register'><p>Register a method for a suggested dependency</p></a></li>
<li><a href='#summary.incidence2'><p>Summary of an incidence object</p></a></li>
<li><a href='#vibrant'><p>Color palettes used in incidence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute, Handle and Plot Incidence of Dated Events</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and classes to compute, handle and visualise 
  incidence from dated events for a defined time interval. Dates can be 
  provided in various standard formats. The class 'incidence2' is used to store
  computed incidence and can be easily manipulated, subsetted, and plotted.
  This package is part of the RECON (<a href="https://www.repidemicsconsortium.org/">https://www.repidemicsconsortium.org/</a>) 
  toolkit for outbreak analysis (<a href="https://www.reconverse.org">https://www.reconverse.org</a>).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.reconverse.org/incidence2/">https://www.reconverse.org/incidence2/</a>,
<a href="https://github.com/reconverse/incidence2">https://github.com/reconverse/incidence2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/reconverse/incidence2/issues">https://github.com/reconverse/incidence2/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>grates (&ge; 1.0.0), R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, data.table, pillar, utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>outbreaks, dplyr, ggplot2, scales, knitr, rmarkdown, rlang,
clock, testthat (&ge; 3.0.0), tibble</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-05 12:16:32 UTC; tim</td>
</tr>
<tr>
<td>Author:</td>
<td>Tim Taylor <a href="https://orcid.org/0000-0002-8587-7113"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Thibaut Jombart [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tim Taylor &lt;tim.taylor@hiddenelephants.co.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-05 13:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='incidence2-package'>incidence2: Compute, Handle and Plot Incidence of Dated Events</h2><span id='topic+incidence2'></span><span id='topic+incidence2-package'></span>

<h3>Description</h3>

<p>Provides functions and classes to compute, handle and visualise incidence from dated events for a defined time interval. Dates can be provided in various standard formats. The class 'incidence2' is used to store computed incidence and can be easily manipulated, subsetted, and plotted. This package is part of the RECON (<a href="https://www.repidemicsconsortium.org/">https://www.repidemicsconsortium.org/</a>) toolkit for outbreak analysis (<a href="https://www.reconverse.org">https://www.reconverse.org</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tim Taylor <a href="mailto:tim.taylor@hiddenelephants.co.uk">tim.taylor@hiddenelephants.co.uk</a> (<a href="https://orcid.org/0000-0002-8587-7113">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.reconverse.org/incidence2/">https://www.reconverse.org/incidence2/</a>
</p>
</li>
<li> <p><a href="https://github.com/reconverse/incidence2">https://github.com/reconverse/incidence2</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/reconverse/incidence2/issues">https://github.com/reconverse/incidence2/issues</a>
</p>
</li></ul>


<hr>
<h2 id='accessors'>Access various elements of an incidence object</h2><span id='topic+accessors'></span><span id='topic+get_date_index_name'></span><span id='topic+get_date_index_name.default'></span><span id='topic+get_date_index_name.incidence2'></span><span id='topic+get_dates_name'></span><span id='topic+get_count_variable_name'></span><span id='topic+get_count_variable_name.default'></span><span id='topic+get_count_variable_name.incidence2'></span><span id='topic+get_count_value_name'></span><span id='topic+get_count_value_name.default'></span><span id='topic+get_count_value_name.incidence2'></span><span id='topic+get_group_names'></span><span id='topic+get_group_names.default'></span><span id='topic+get_group_names.incidence2'></span><span id='topic+get_date_index'></span><span id='topic+get_date_index.default'></span><span id='topic+get_date_index.incidence2'></span><span id='topic+get_dates'></span><span id='topic+get_count_variable'></span><span id='topic+get_count_variable.default'></span><span id='topic+get_count_variable.incidence2'></span><span id='topic+get_count_value'></span><span id='topic+get_count_value.default'></span><span id='topic+get_count_value.incidence2'></span><span id='topic+get_groups'></span><span id='topic+get_groups.default'></span><span id='topic+get_groups.incidence2'></span>

<h3>Description</h3>

<p>Access various elements of an incidence object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_date_index_name(x, ...)

## Default S3 method:
get_date_index_name(x, ...)

## S3 method for class 'incidence2'
get_date_index_name(x, ...)

get_dates_name(x, ...)

get_count_variable_name(x, ...)

## Default S3 method:
get_count_variable_name(x, ...)

## S3 method for class 'incidence2'
get_count_variable_name(x, ...)

get_count_value_name(x, ...)

## Default S3 method:
get_count_value_name(x, ...)

## S3 method for class 'incidence2'
get_count_value_name(x, ...)

get_group_names(x, ...)

## Default S3 method:
get_group_names(x, ...)

## S3 method for class 'incidence2'
get_group_names(x, ...)

get_date_index(x, ...)

## Default S3 method:
get_date_index(x, ...)

## S3 method for class 'incidence2'
get_date_index(x, ...)

get_dates(x, ...)

get_count_variable(x, ...)

## Default S3 method:
get_count_variable(x, ...)

## S3 method for class 'incidence2'
get_count_variable(x, ...)

get_count_value(x, ...)

## Default S3 method:
get_count_value(x, ...)

## S3 method for class 'incidence2'
get_count_value(x, ...)

get_groups(x, ...)

## Default S3 method:
get_groups(x, ...)

## S3 method for class 'incidence2'
get_groups(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accessors_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="accessors_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>get_date_index_name()</code>: The name of the date_index variable of x.
</p>
</li>
<li> <p><code>get_dates_name()</code>: Alias for <code>get_date_index_name()</code>.
</p>
</li>
<li> <p><code>get_count_variable_name()</code>: The name of the count variable of x.
</p>
</li>
<li> <p><code>get_count_value_name()</code>: The name of the count value of x.
</p>
</li>
<li> <p><code>get_group_names()</code>: The name(s) of the group variable(s) of x.
</p>
</li>
<li> <p><code>get_date_index()</code>: The date_index variable of x.
</p>
</li>
<li> <p><code>get_dates()</code>: Alias for <code>get_date_index()</code>.
</p>
</li>
<li> <p><code>get_count_variable()</code>: The count variable of x.
</p>
</li>
<li> <p><code>get_count_value()</code>: The count value of x.
</p>
</li>
<li> <p><code>get_groups()</code>: List of the group variable(s) of x.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("outbreaks", quietly = TRUE)) {

    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist
    i &lt;- incidence(dat, date_index = "date_of_onset",
                   groups = c("gender", "hospital"))

    get_count_variable_name(i)
    get_group_names(i)
    get_dates_name(i)

}

</code></pre>

<hr>
<h2 id='as_incidence'>Coerce to an incidence object</h2><span id='topic+as_incidence'></span><span id='topic+as_incidence.default'></span><span id='topic+as_incidence.incidence2'></span>

<h3>Description</h3>

<p>Generic for coercion to an <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_incidence(x, ...)

## Default S3 method:
as_incidence(x, ...)

## S3 method for class 'incidence2'
as_incidence(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_incidence_+3A_x">x</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> object.</p>
</td></tr>
<tr><td><code id="as_incidence_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.
</p>

<hr>
<h2 id='as.data.frame.incidence2'>Convert incident object to a data frame</h2><span id='topic+as.data.frame.incidence2'></span>

<h3>Description</h3>

<p>Convert incident object to a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'incidence2'
as.data.frame(x, row.names, optional, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.incidence2_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="as.data.frame.incidence2_+3A_row.names">row.names</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="as.data.frame.incidence2_+3A_optional">optional</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="as.data.frame.incidence2_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
dat &lt;- data.frame(
    dates = Sys.Date() + 1:100,
    names = rep(c("Jo", "John"), 5)
)

dat &lt;- incidence(dat, date_index = "dates", groups = "names")
as.data.frame(dat)

</code></pre>

<hr>
<h2 id='complete_dates'>Complete dates for all group combinations</h2><span id='topic+complete_dates'></span>

<h3>Description</h3>

<p>This function ensures that an incidence object has the same range of dates
for each grouping. By default missing counts will be filled with <code>0L</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complete_dates(x, expand = TRUE, fill = 0L, by = 1L, allow_POSIXct = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="complete_dates_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="complete_dates_+3A_expand">expand</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[logical]&#8288;</code>
</p>
<p>Should a range of dates from the minimum to maximum value of the date index
also be created.
</p>
<p>If <code>expand</code> is TRUE (default) then complete_dates will attempt to use
<code>function(x) seq(min(x), max(x), by = 1)</code> to generate a complete sequence of
dates.</p>
</td></tr>
<tr><td><code id="complete_dates_+3A_fill">fill</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[numeric]&#8288;</code>
</p>
<p>The value to replace missing counts by.
</p>
<p>Defaults to <code>0L</code>.</p>
</td></tr>
<tr><td><code id="complete_dates_+3A_by">by</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[Defunct]&#8288;</code>
</p>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="complete_dates_+3A_allow_posixct">allow_POSIXct</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[logical]&#8288;</code>
</p>
<p>Should this function work with POSIXct dates?
</p>
<p>Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- data.frame(
    dates = Sys.Date() + c(1,3,4),
    groups = c("grp1","grp2", "grp1"),
    counts = 1:3
)

i &lt;- incidence(x, date_index = "dates", groups = "groups", counts = "counts")
complete_dates(i)

</code></pre>

<hr>
<h2 id='covidregionaldataUK'>Regional data for COVID-19 cases in the UK</h2><span id='topic+covidregionaldataUK'></span>

<h3>Description</h3>

<p>A dataset containing the daily time-series of cases, tests, hospitalisations,
and deaths for UK.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covidregionaldataUK
</code></pre>


<h3>Format</h3>

<p>A data frame with 6370 rows and 26 variables:
</p>

<dl>
<dt>date</dt><dd><p>the date that the counts were reported (YYYY-MM-DD)</p>
</dd>
<dt>region</dt><dd><p>the region name</p>
</dd>
<dt>region_code</dt><dd><p>the region code</p>
</dd>
<dt>cases_new</dt><dd><p>new reported cases for that day</p>
</dd>
<dt>cases_total</dt><dd><p>total reported cases up to and including that day</p>
</dd>
<dt>deaths_new</dt><dd><p>new reported deaths for that day</p>
</dd>
<dt>deaths_total</dt><dd><p>total reported deaths up to and including that day</p>
</dd>
<dt>recovered_new</dt><dd><p>new reported recoveries for that day</p>
</dd>
<dt>recovered_total</dt><dd><p>total reported coveries up to and including that day</p>
</dd>
<dt>hosp_new</dt><dd><p>new reported hospitalisations for that day</p>
</dd>
<dt>hosp_total</dt><dd><p>total reported hospitalisations up to and including that day (note this is cumulative total of new reported, not total currently in hospital).</p>
</dd>
<dt>tested_new</dt><dd><p>tests for that day</p>
</dd>
<dt>tested_total</dt><dd><p>total tests completed up to and including that day</p>
</dd>
</dl>



<h3>Details</h3>

<p>Extracted using the
<a href="https://CRAN.R-project.org/package=covidregionaldata">covidregionaldata</a>
package on 2021-06-03.
</p>


<h3>Source</h3>

<p><a href="https://CRAN.R-project.org/package=covidregionaldata">https://CRAN.R-project.org/package=covidregionaldata</a>
</p>

<hr>
<h2 id='cumulate'>Compute cumulative 'incidence'</h2><span id='topic+cumulate'></span>

<h3>Description</h3>

<p><code>cumulate()</code> computes the cumulative incidence over time for an
<code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumulate(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumulate_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[incidence2]&#8288;</code> object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
dat &lt;- data.frame(
  dates = as.integer(c(0,1,2,2,3,5,7)),
  groups = factor(c(1, 2, 3, 3, 3, 3, 1))
)

i &lt;- incidence(dat, date_index = "dates", groups = "groups")
cumulate(i)

</code></pre>

<hr>
<h2 id='incidence'>Compute the incidence of events</h2><span id='topic+incidence'></span>

<h3>Description</h3>

<p><code>incidence()</code> calculates event the <em>incidence</em> of different events across
specified time periods and groupings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incidence(
  x,
  date_index,
  groups = NULL,
  counts = NULL,
  count_names_to = "count_variable",
  count_values_to = "count",
  date_names_to = "date_index",
  rm_na_dates = TRUE,
  interval = NULL,
  offset = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="incidence_+3A_x">x</code></td>
<td>
<p>A data frame object representing a linelist or pre-aggregated dataset.</p>
</td></tr>
<tr><td><code id="incidence_+3A_date_index">date_index</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The time index(es) of the given data.
</p>
<p>This should be the name(s) corresponding to the desired date column(s) in x.
</p>
<p>A name vector can be used for convenient relabelling of the resultant output.
</p>
<p>Multiple indices only make sense when  <code>x</code> is a linelist.</p>
</td></tr>
<tr><td><code id="incidence_+3A_groups">groups</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>An optional vector giving the names of the groups of observations for which
incidence should be grouped.</p>
</td></tr>
<tr><td><code id="incidence_+3A_counts">counts</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The count variables of the given data.  If NULL (default) the data is taken
to be a linelist of individual observations.</p>
</td></tr>
<tr><td><code id="incidence_+3A_count_names_to">count_names_to</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The column to create which will store the <code>counts</code> column names provided that
<code>counts</code> is not NULL.</p>
</td></tr>
<tr><td><code id="incidence_+3A_count_values_to">count_values_to</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The name of the column to store the resultant count values in.</p>
</td></tr>
<tr><td><code id="incidence_+3A_date_names_to">date_names_to</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The name of the column to store the date variables in.</p>
</td></tr>
<tr><td><code id="incidence_+3A_rm_na_dates">rm_na_dates</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[logical]&#8288;</code>
</p>
<p>Should <code>NA</code> dates be removed prior to aggregation?</p>
</td></tr>
<tr><td><code id="incidence_+3A_interval">interval</code></td>
<td>
<p>An optional scalar integer or string indicating the (fixed) size of
the desired time interval you wish to use for for computing the incidence.
</p>
<p>Defaults to NULL in which case the date_index columns are left unchanged.
</p>
<p>Numeric values are coerced to integer and treated as a number of days to
group.
</p>
<p>Text strings can be one of:
</p>
<div class="sourceCode"><pre>* day or daily
* week(s) or weekly
* epiweek(s)
* isoweek(s)
* month(s) or monthly
* yearmonth(s)
* quarter(s) or quarterly
* yearquarter(s)
* year(s) or yearly
</pre></div>
<p>More details can be found in the &quot;Interval specification&quot; section.</p>
</td></tr>
<tr><td><code id="incidence_+3A_offset">offset</code></td>
<td>
<p>Only applicable when <code>interval</code> is not NULL.
</p>
<p>An optional scalar integer or date indicating the value you wish to start
counting periods from relative to the Unix Epoch:
</p>

<ul>
<li><p> Default value of NULL corresponds to 0L.
</p>
</li>
<li><p> For other integer values this is stored scaled by <code>n</code>
(<code>offset &lt;- as.integer(offset) %% n</code>).
</p>
</li>
<li><p> For date values this is first converted to an integer offset
(<code>offset &lt;- floor(as.numeric(offset))</code>) and then scaled via <code>n</code> as above.
</p>
</li></ul>
</td></tr>
<tr><td><code id="incidence_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> objects are a sub class of data frame with some
additional invariants. That is, an <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object must:
</p>

<ul>
<li><p> have one column representing the date index (this does not need to be a
<code>date</code> object but must have an inherent ordering over time);
</p>
</li>
<li><p> have one column representing the count variable (i.e. what is being
counted) and one variable representing the associated count;
</p>
</li>
<li><p> have zero or more columns representing groups;
</p>
</li>
<li><p> not have duplicated rows with regards to the date and group variables.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;&lt;incidence2, data.frame&gt;&#8288;</code>.
</p>


<h3>Interval specification</h3>

<p>Where <code>interval</code> is specified, <code>incidence()</code>, predominantly uses the
<a href="https://cran.r-project.org/package=grates"><code>grates</code></a> package to generate
appropriate date groupings. The grouping used depends on the value of
<code>interval</code>. This can be specified as either an integer value or a string
corresponding to one of the classes:
</p>

<ul>
<li><p> integer values:                     <code><a href="grates.html#topic+new_period">&lt;grates_period&gt;</a></code> object, grouped by the specified number of days.
</p>
</li>
<li><p> day, daily:                         <code><a href="base.html#topic+Dates">&lt;Date&gt;</a></code> objects.
</p>
</li>
<li><p> week(s), weekly, isoweek:           <code><a href="grates.html#topic+isoweek">&lt;grates_isoweek&gt;</a></code> objects.
</p>
</li>
<li><p> epiweek(s):                         <code><a href="grates.html#topic+epiweek">&lt;grates_epiweek&gt;</a></code> objects.
</p>
</li>
<li><p> month(s), monthly, yearmonth:       <code><a href="grates.html#topic+yearmonth">&lt;grates_yearmonth&gt;</a></code> objects.
</p>
</li>
<li><p> quarter(s), quarterly, yearquarter: <code><a href="grates.html#topic+yearquarter">&lt;grates_yearquarter&gt;</a></code> objects.
</p>
</li>
<li><p> year(s) and yearly:                 <code><a href="grates.html#topic+year">&lt;grates_year&gt;</a></code> objects.
</p>
</li></ul>

<p>For &quot;day&quot; or &quot;daily&quot; interval, we provide a thin wrapper around <code>as.Date()</code>
that ensures the underlying data are whole numbers and that time zones are
respected. Note that additional arguments are not forwarded to <code>as.Date()</code>
so for greater flexibility users are advised to modifying your input prior to
calling <code>incidence()</code>.
</p>


<h3>See Also</h3>

<p><code>browseVignettes("grates")</code> for more details on the grate object classes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("outbreaks", quietly = TRUE)) {

    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist
    incidence(dat, "date_of_onset")
    incidence(dat, "date_of_onset", groups = c("gender", "hospital"))

}

</code></pre>

<hr>
<h2 id='incidence2-defunct'>Functions now defunct in package incidence2</h2><span id='topic+incidence2-defunct'></span><span id='topic+new_incidence'></span><span id='topic+validate_incidence'></span><span id='topic+build_incidence'></span><span id='topic+get_n'></span><span id='topic+get_interval'></span><span id='topic+get_timespan'></span><span id='topic+facet_plot'></span>

<h3>Description</h3>

<p>These functions are now defunct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_incidence(
  x,
  date,
  groups = NULL,
  counts,
  measurements = NULL,
  validate = TRUE
)

validate_incidence(x)

build_incidence(
  x,
  date_index,
  groups = NULL,
  counts = NULL,
  na_as_group = TRUE,
  FUN = identity,
  args = list()
)

get_n(x)

get_interval(x, ...)

get_timespan(x, ...)

facet_plot(x, ...)
</code></pre>

<hr>
<h2 id='keep'>Keep first, last and peak occurences</h2><span id='topic+keep'></span><span id='topic+keep_first'></span><span id='topic+keep_last'></span><span id='topic+keep_peaks'></span>

<h3>Description</h3>

<p><code>keep_first()</code> and <code>keep_last()</code> keep the first and last <code>n</code> rows to occur
for each grouping when in ascending date order. <code>keep_peaks()</code> keeps the rows
with the maximum count value for each group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keep_first(x, n, complete_dates = TRUE, ...)

keep_last(x, n, complete_dates = TRUE, ...)

keep_peaks(x, complete_dates = TRUE, first_only = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="keep_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="keep_+3A_n">n</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[integer]&#8288;</code>
</p>
<p>Number of entries to keep.
</p>
<p><code>double</code> vectors will be converted via <code>as.integer(n)</code>.</p>
</td></tr>
<tr><td><code id="keep_+3A_complete_dates">complete_dates</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[bool]&#8288;</code>
</p>
<p>Should <code>complete_dates()</code> be called on the data prior to keeping the first
entries.
</p>
<p>Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="keep_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>complete_dates()</code>.</p>
</td></tr>
<tr><td><code id="keep_+3A_first_only">first_only</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[bool]&#8288;</code>
</p>
<p>Should only the first peak (by date) be kept.
</p>
<p>Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Incidence object with the chosen entries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("outbreaks", quietly = TRUE)) {

    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist
    inci &lt;- incidence(dat, "date_of_onset")
    keep_first(inci, 3)
    keep_last(inci, 3)

}

</code></pre>

<hr>
<h2 id='plot.incidence2'>Plot an incidence object</h2><span id='topic+plot.incidence2'></span>

<h3>Description</h3>

<p><code>plot()</code> can be used to provide a bar plot of an incidence object. Due
to the complexities with automating plotting it is some what experimental in
nature and it may be better to use ggplot2 directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'incidence2'
plot(
  x,
  y,
  width = 1,
  colour_palette = vibrant,
  border_colour = NA,
  na_colour = "grey",
  alpha = 0.7,
  fill = NULL,
  legend = c("right", "left", "bottom", "top", "none"),
  title = NULL,
  angle = 0,
  size = NULL,
  nrow = NULL,
  n_breaks = 6L,
  show_cases = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.incidence2_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_y">y</code></td>
<td>
<p>Not used.
</p>
<p>Required for compatibility with the <code>plot()</code> generic.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_width">width</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[numeric]&#8288;</code>
</p>
<p>Value between 0 and 1 indicating the relative size of the bars to the
interval.
</p>
<p>Default 1.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_colour_palette">colour_palette</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[function]&#8288;</code>
</p>
<p>The color palette to be used for the different count variables.
</p>
<p>Defaults to <code>vibrant</code> (see <code>?palettes</code>).</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_border_colour">border_colour</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The color to be used for the borders of the bars.
</p>
<p>Use <code>NA</code> (default) for invisible borders.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_na_colour">na_colour</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The colour to plot <code>NA</code> values in graphs.
</p>
<p>Defaults to <code>grey</code>.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_alpha">alpha</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[numeric]&#8288;</code>
</p>
<p>The alpha level for color transparency, with 1 being fully opaque and
0 fully transparent
</p>
<p>Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_fill">fill</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>Which variable to colour plots by.
</p>
<p>Must be a <code>group</code> or <code>count</code> variable and will mean that variable is not used
for facetting.
</p>
<p>If NULL no distinction if made for plot colours.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_legend">legend</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>Position of legend in plot.
</p>
<p>Only applied if <code>fill</code> is not NULL.
</p>
<p>One of &quot;right&quot; (default), &quot;left&quot;, &quot;bottom&quot;, &quot;top&quot; or &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_title">title</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>Optional title for the graph.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_angle">angle</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[numeric]&#8288;</code>
</p>
<p>Rotation angle for text.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_size">size</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[numeric]&#8288;</code>
</p>
<p>text size in pts.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_nrow">nrow</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[integer]&#8288;</code>
</p>
<p>Number of rows used for facetting if there are group variables present and
just one count in the incidence object.
</p>
<p>Numeric values are coerced to integer via <code>as.integer()</code>.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_n_breaks">n_breaks</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[integer]&#8288;</code>
</p>
<p>Approximate number of breaks calculated using <code>scales::breaks_pretty</code>.
</p>
<p>Numeric values are coerced to integer via <code>as.integer()</code>.
</p>
<p>Default 6L.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_show_cases">show_cases</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[logical]&#8288;</code>
</p>
<p>if <code>TRUE</code>, then each observation will be shown individually in a square
format.
</p>
<p>Normally only used for outbreaks with a small number of cases.
</p>
<p>Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.incidence2_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Faceting will occur automatically if either grouping variables or
multiple counts are present.
</p>
</li>
<li><p> If there are multiple count variables, each count will occupy a different
row of the resulting plot.
</p>
</li>
<li><p> Utilises ggplot2 so this must be installed to use.
</p>
</li></ul>



<h3>Value</h3>


<ul>
<li><p> A <code style="white-space: pre;">&#8288;[ggplot2::ggplot()]&#8288;</code> object.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("outbreaks", quietly = TRUE) &amp;&amp; requireNamespace("ggplot2", quietly = TRUE)) {
  withAutoprint({
    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist

    inci &lt;- incidence(dat, date_index = "date_of_onset", groups = "hospital")
    plot(inci, angle = 45)

    inci2 &lt;- regroup(inci)
    plot(inci2)
  })
}

</code></pre>

<hr>
<h2 id='print.incidence2'>Print an incidence object.</h2><span id='topic+print.incidence2'></span>

<h3>Description</h3>

<p>Printing of <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> objects is handled via the <span class="pkg">pillar</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'incidence2'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.incidence2_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="print.incidence2_+3A_...">...</code></td>
<td>
<p>Additional arguments passed through to <code>pillar::tbl_format_setup()</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("outbreaks", quietly = TRUE)) {

    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist

    (out &lt;- incidence(dat, "date_of_onset"))

    # use `n` to print more lines
    print(out, n = 20L)

}

</code></pre>

<hr>
<h2 id='regroup'>Regroup 'incidence' objects</h2><span id='topic+regroup'></span>

<h3>Description</h3>

<p>This function regroups an <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object across the specified groups.
The resulting <code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object will contains counts summed over the
groups present in the input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regroup(x, groups = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regroup_+3A_x">x</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;incidence2&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="regroup_+3A_groups">groups</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[character]&#8288;</code>
</p>
<p>The groups to sum over.
</p>
<p>If <code>NULL</code> (default) then the function returns the corresponding object with
no groupings.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
if (requireNamespace("outbreaks", quietly = TRUE)) {

    data(ebola_sim_clean, package = "outbreaks")
    dat &lt;- ebola_sim_clean$linelist
    i &lt;- incidence(
        dat,
        date_index = "date_of_onset",
        groups = c("gender", "hospital")
    )
    regroup(i)
    regroup(i, "hospital")

}

</code></pre>

<hr>
<h2 id='s3_register'>Register a method for a suggested dependency</h2><span id='topic+s3_register'></span>

<h3>Description</h3>

<p>Generally, the recommend way to register an S3 method is to use the
<code>S3Method()</code> namespace directive (often generated automatically by the
<code style="white-space: pre;">&#8288;@export&#8288;</code> roxygen2 tag). However, this technique requires that the generic
be in an imported package, and sometimes you want to suggest a package,
and only provide a method when that package is loaded. <code>s3_register()</code>
can be called from your package's <code>.onLoad()</code> to dynamically register
a method only if the generic's package is loaded.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="s3_register_+3A_generic">generic</code></td>
<td>
<p>Name of the generic in the form <code>pkg::generic</code>.</p>
</td></tr>
<tr><td><code id="s3_register_+3A_class">class</code></td>
<td>
<p>Name of the class</p>
</td></tr>
<tr><td><code id="s3_register_+3A_method">method</code></td>
<td>
<p>Optionally, the implementation of the method. By default,
this will be found by looking for a function called <code>generic.class</code>
in the package environment.
</p>
<p>Note that providing <code>method</code> can be dangerous if you use
devtools. When the namespace of the method is reloaded by
<code>devtools::load_all()</code>, the function will keep inheriting from
the old namespace. This might cause crashes because of dangling
<code>.Call()</code> pointers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For R 3.5.0 and later, <code>s3_register()</code> is also useful when demonstrating
class creation in a vignette, since method lookup no longer always involves
the lexical scope. For R 3.6.0 and later, you can achieve a similar effect
by using &quot;delayed method registration&quot;, i.e. placing the following in your
<code>NAMESPACE</code> file:
</p>
<div class="sourceCode"><pre>if (getRversion() &gt;= "3.6.0") {
  S3method(package::generic, class)
}
</pre></div>


<h3>Usage in other packages</h3>

<p>To avoid taking a dependency on vctrs, you copy the source of
<a href="https://github.com/r-lib/vctrs/blob/main/R/register-s3.R"><code>s3_register()</code></a>
into your own package. It is licensed under the permissive
<a href="https://choosealicense.com/licenses/unlicense/">unlicense</a> to make it
crystal clear that we're happy for you to do this. There's no need to include
the license or even credit us when using this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A typical use case is to dynamically register tibble/pillar methods
# for your class. That way you avoid creating a hard dependency on packages
# that are not essential, while still providing finer control over
# printing when they are used.

.onLoad &lt;- function(...) {
  s3_register("pillar::pillar_shaft", "vctrs_vctr")
  s3_register("tibble::type_sum", "vctrs_vctr")
}
</code></pre>

<hr>
<h2 id='summary.incidence2'>Summary of an incidence object</h2><span id='topic+summary.incidence2'></span>

<h3>Description</h3>

<p>Summary of an incidence object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'incidence2'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.incidence2_+3A_object">object</code></td>
<td>
<p>An 'incidence' object.</p>
</td></tr>
<tr><td><code id="summary.incidence2_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object (invisibly).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ebola_sim_clean, package = "outbreaks")
dat &lt;- ebola_sim_clean$linelist
inci &lt;- incidence(dat, "date_of_onset", groups = c("gender", "hospital"))
summary(inci)

</code></pre>

<hr>
<h2 id='vibrant'>Color palettes used in incidence</h2><span id='topic+vibrant'></span><span id='topic+palettes'></span><span id='topic+muted'></span>

<h3>Description</h3>

<p>These functions are color palettes used in incidence. The palettes come from
https://personal.sron.nl/~pault/#sec:qualitative and exclude <code>grey</code>, which
is reserved for missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vibrant(n)

muted(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vibrant_+3A_n">n</code></td>
<td>
<p><code style="white-space: pre;">&#8288;[integer]&#8288;</code>
</p>
<p>Number of colours.
</p>
<p><code>double</code> vectors will be converted via <code>as.integer(n)</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>vibrant(5)
muted(10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
