<!DOCTYPE html><html lang="en-GB"><head><title>Help for package R6P</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R6P}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#R6P-package'><p>R6P: Design Patterns in R</p></a></li>
<li><a href='#NullObject'><p>Null Object Pattern</p></a></li>
<li><a href='#Repository'><p>Repository Pattern</p></a></li>
<li><a href='#Singleton'><p>Singleton</p></a></li>
<li><a href='#ValueObject'><p>Value Object Pattern</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design Patterns in R</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://tidylab.github.io/R6P/">https://tidylab.github.io/R6P/</a>, <a href="https://github.com/tidylab/R6P">https://github.com/tidylab/R6P</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tidylab/R6P/issues">https://github.com/tidylab/R6P/issues</a></td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Harel Lustiger &lt;tidylab@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Build robust and maintainable software with object-oriented design 
    patterns in R. Design patterns abstract and present in neat, well-defined 
    components and interfaces the experience of many software designers and 
    architects over many years of solving similar problems. These are solutions 
    that have withstood the test of time with respect to re-usability,
    flexibility, and maintainability. 'R6P' provides abstract base classes with 
    examples for a few known design patterns. The patterns were selected by 
    their applicability to analytic projects in R. Using these patterns in R 
    projects have proven effective in dealing with the complexity that 
    data-driven applications possess.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, DBI, RSQLite, ggplot2</td>
</tr>
<tr>
<td>Imports:</td>
<td>collections, dplyr, stringr, R6, tibble, tidyr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-22 09:21:08 UTC; Alpha</td>
</tr>
<tr>
<td>Author:</td>
<td>Harel Lustiger <a href="https://orcid.org/0000-0003-2953-9598"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Tidylab [cph, fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-22 09:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='R6P-package'>R6P: Design Patterns in R</h2><span id='topic+R6P'></span><span id='topic+R6P-package'></span>

<h3>Description</h3>

<p>Build robust and maintainable software with object-oriented design patterns in R. Design patterns abstract and present in neat, well-defined components and interfaces the experience of many software designers and architects over many years of solving similar problems. These are solutions that have withstood the test of time with respect to re-usability, flexibility, and maintainability. 'R6P' provides abstract base classes with examples for a few known design patterns. The patterns were selected by their applicability to analytic projects in R. Using these patterns in R projects have proven effective in dealing with the complexity that data-driven applications possess.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Harel Lustiger <a href="mailto:tidylab@gmail.com">tidylab@gmail.com</a> (<a href="https://orcid.org/0000-0003-2953-9598">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Tidylab [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://tidylab.github.io/R6P/">https://tidylab.github.io/R6P/</a>
</p>
</li>
<li> <p><a href="https://github.com/tidylab/R6P">https://github.com/tidylab/R6P</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tidylab/R6P/issues">https://github.com/tidylab/R6P/issues</a>
</p>
</li></ul>


<hr>
<h2 id='NullObject'>Null Object Pattern</h2><span id='topic+NullObject'></span>

<h3>Description</h3>

<p>Model a domain concept using natural lingo of the domain
experts, such as “Passenger”, “Address”, and “Money”.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NullObject()
</code></pre>


<h3>See Also</h3>

<p>Other base design patterns: 
<code><a href="#topic+Singleton">Singleton</a></code>,
<code><a href="#topic+ValueObject">ValueObject</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See more examples at &lt;https://tidylab.github.io/R6P/articles&gt;

colnames(NullObject())
nrow(NullObject())
</code></pre>

<hr>
<h2 id='Repository'>Repository Pattern</h2><span id='topic+Repository'></span><span id='topic+AbstractRepository'></span>

<h3>Description</h3>

<p>Mediates between the domain and data mapping layers using a
collection-like interface for accessing domain objects.
</p>


<h3>Super class</h3>

<p><code><a href="#topic+Singleton">R6P::Singleton</a></code> -&gt; <code>Repository</code>
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Repository-new"><code>AbstractRepository$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Repository-add"><code>AbstractRepository$add()</code></a>
</p>
</li>
<li> <p><a href="#method-Repository-del"><code>AbstractRepository$del()</code></a>
</p>
</li>
<li> <p><a href="#method-Repository-get"><code>AbstractRepository$get()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Repository-new"></a>



<h4>Method <code>new()</code></h4>

<p>Instantiate an object
</p>


<h5>Usage</h5>

<div class="r"><pre>AbstractRepository$new()</pre></div>


<hr>
<a id="method-Repository-add"></a>



<h4>Method <code>add()</code></h4>

<p>Add an element to the Repository.
</p>


<h5>Usage</h5>

<div class="r"><pre>AbstractRepository$add(key, value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt><dd><p>(<code>character</code>) Name of the element.</p>
</dd>
<dt><code>value</code></dt><dd><p>(<code style="white-space: pre;">&#8288;?&#8288;</code>) Value of the element. Note: The values in the
<code>Repository</code> are not necessarily of the same type. That depends on the
implementation of <code>AbstractRepository</code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Repository-del"></a>



<h4>Method <code>del()</code></h4>

<p>Delete an element from the Repository.
</p>


<h5>Usage</h5>

<div class="r"><pre>AbstractRepository$del(key)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt><dd><p>(<code>character</code>) Name of the element.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-Repository-get"></a>



<h4>Method <code>get()</code></h4>

<p>Retrieve an element from the Repository.
</p>


<h5>Usage</h5>

<div class="r"><pre>AbstractRepository$get(key)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>key</code></dt><dd><p>(<code>character</code>) Name of the element.</p>
</dd>
</dl>

</div>




<h3>Examples</h3>

<pre><code class='language-R'># See more examples at &lt;https://tidylab.github.io/R6P/articles&gt;

# The following implementation is a Repository of car models with their
# specifications.

# First, we define the class constructor, initialize, to establish a
# transient data storage.

# In this case we use a dictionary from the collections package
# &lt;https://randy3k.github.io/collections/reference/dict.html&gt;

# Second, we define the add, del and get functions that operate on the dictionary.

# As an optional step, we define the NULL object. In this case, rather then
# the reserved word NULL, the NULL object is a data.frame with 0 rows and
# predefined column.

TransientRepository &lt;- R6::R6Class(
  classname = "Repository", inherit = R6P::AbstractRepository, public = list(
    initialize = function() {
      private$cars &lt;- collections::dict()
    },
    add = function(key, value) {
      private$cars$set(key, value)
      invisible(self)
    },
    del = function(key) {
      private$cars$remove(key)
      invisible(self)
    },
    get = function(key) {
      return(private$cars$get(key, default = private$NULL_car))
    }
  ), private = list(
    NULL_car = cbind(uid = NA_character_, datasets::mtcars)[0, ],
    cars = NULL
  )
)

# Adding customised operations is also possible via the R6 set function.
# The following example, adds a query that returns all the objects in the database

TransientRepository$set("public", "get_all_cars", overwrite = TRUE, function() {
  result &lt;- private$cars$values() |&gt; dplyr::bind_rows()
  if (nrow(result) == 0) {
    return(private$NULL_car)
  } else {
    return(result)
  }
})

# In this example, we use the mtcars dataset with a uid column that uniquely
# identifies the different cars in the Repository:
mtcars &lt;- datasets::mtcars |&gt; tibble::rownames_to_column("uid")
head(mtcars, 2)

# Here is how the caller uses the Repository:

## Instantiate a repository object
repository &lt;- TransientRepository$new()

## Add two different cars specification to the repository
repository$add(key = "Mazda RX4", value = dplyr::filter(mtcars, uid == "Mazda RX4"))
repository$add(key = "Mazda RX4 Wag", value = dplyr::filter(mtcars, uid == "Mazda RX4 Wag"))

## Get "Mazda RX4" specification
repository$get(key = "Mazda RX4")

## Get all the specifications in the repository
repository$get_all_cars()

## Delete "Mazda RX4" specification
repository$del(key = "Mazda RX4")

## Get "Mazda RX4" specification
repository$get(key = "Mazda RX4")
</code></pre>

<hr>
<h2 id='Singleton'>Singleton</h2><span id='topic+Singleton'></span>

<h3>Description</h3>

<p>Enforces a single instance of a class and provides a global access point.
</p>


<h3>Details</h3>

<p>This is an abstract base class. Instantiating <code>Singleton</code> directly triggers an error.
Classes inheriting from <code>Singleton</code> share a single instance.
</p>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Singleton-new"><code>Singleton$new()</code></a>
</p>
</li></ul>


<hr>
<a id="method-Singleton-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create or retrieve an object
</p>


<h5>Usage</h5>

<div class="r"><pre>Singleton$new()</pre></div>




<h3>See Also</h3>

<p>Other base design patterns: 
<code><a href="#topic+NullObject">NullObject</a>()</code>,
<code><a href="#topic+ValueObject">ValueObject</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See more examples at &lt;https://tidylab.github.io/R6P/articles&gt;
address &lt;- function(x) sub("&lt;environment: (.*)&gt;", "\\1", capture.output(x))

# In this example we implement a `Counter` that inherits the qualities of Singleton
Counter &lt;- R6::R6Class("Counter", inherit = R6P::Singleton, public = list(
  count = 0,
  add_1 = function() {
    self$count &lt;- self$count + 1
    invisible(self)
  }
))

# Whenever we call the constructor on `Counter`, we always get the exact same instance:
counter_A &lt;- Counter$new()
counter_B &lt;- Counter$new()

identical(counter_A, counter_B, ignore.environment = FALSE)

# The two objects are equal and located at the same address; thus, they are the same object.

# When we make a change in any of the class instances, the rest are changed as well.

# How many times has the counter been increased?
counter_A$count

# Increase the counter by 1
counter_A$add_1()

# How many times have the counters been increased?
counter_A$count
counter_B$count

</code></pre>

<hr>
<h2 id='ValueObject'>Value Object Pattern</h2><span id='topic+ValueObject'></span>

<h3>Description</h3>

<p>Model a domain concept using natural lingo of domain experts, such as “Passenger,” “Address,” or “Money.”
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ValueObject(given = NA_character_, family = NA_character_)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ValueObject_+3A_given">given</code></td>
<td>
<p>(<code>character</code>) A character vector with the given name.</p>
</td></tr>
<tr><td><code id="ValueObject_+3A_family">family</code></td>
<td>
<p>(<code>character</code>) A character vector with the family name.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other base design patterns: 
<code><a href="#topic+NullObject">NullObject</a>()</code>,
<code><a href="#topic+Singleton">Singleton</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See more examples at &lt;https://tidylab.github.io/R6P/articles&gt;

# In this example we are appointing elected officials to random ministries, just
# like in real-life.
Person &lt;- ValueObject
Person()

# Create a test for objects of type Person
# * Extract the column names of Person by using its Null Object (returned by Person())
# * Check that the input argument has all the columns that a Person has
is.Person &lt;- function(x) all(colnames(x) %in% colnames(Person()))

# A 'Minister' is a 'Person' with a ministry title. The Minister constructor
# requires two inputs:
# 1. (`Person`) Members of parliament
# 2. (`character`) Ministry titles
Minister &lt;- function(member = Person(), title = NA_character_) {
  stopifnot(is.Person(member), is.character(title))
  stopifnot(nrow(member) == length(title) | all(is.na(title)))

  member |&gt; dplyr::mutate(title = title)
}

# Given one or more parliament members
# When appoint_random_ministries is called
# Then the parliament members are appointed to an office.
appoint_random_ministries &lt;- function(member = Person()) {
  positions &lt;- c(
    "Arts, Culture and Heritage", "Finance", "Corrections", "Racing",
    "Sport and Recreation", "Housing", "Energy and Resources", "Education",
    "Public Service", "Disability Issues", "Environment", "Justice",
    "Immigration", "Defence", "Internal Affairs", "Transport"
  )

  Minister(member = member, title = sample(positions, size = nrow(member)))
}

# Listing New Zealand elected officials in 2020, we instantiate a Person object,
# appoint them to random offices, and return a Minister value object.
set.seed(2020)
parliament_members &lt;- Person(
  given = c("Jacinda", "Grant", "Kelvin", "Megan", "Chris", "Carmel"),
  family = c("Ardern", "Robertson", "Davis", "Woods", "Hipkins", "Sepuloni")
)

parliament_members
appoint_random_ministries(member = parliament_members)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
