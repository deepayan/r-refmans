<!DOCTYPE html><html lang="en"><head><title>Help for package ternvis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ternvis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ternvis-package'>
<p>Visualisation, verification and calibration of ternary forecast data</p></a></li>
<li><a href='#foot'>
<p>Football betting dataset</p></a></li>
<li><a href='#rain'>
<p>Ternary precipitation forecast data set</p></a></li>
<li><a href='#tcalibrate'>
<p>Calibration of ternary forecasts</p></a></li>
<li><a href='#tcolour'>
<p>Assign a colour to a ternary forecast</p></a></li>
<li><a href='#tgetcal'>
<p>Get a linear or quadratic calibration of ternary forecast / observation data</p></a></li>
<li><a href='#tgrid'>
<p>Create a grid of points in barycentric coordinates</p></a></li>
<li><a href='#tmap'>
<p>Demonstration of how to make coloured maps of ternary forecasts</p></a></li>
<li><a href='#tpalette'>
<p>Draw a palette of the colours assigned to ternary forecasts</p></a></li>
<li><a href='#tplot'>
<p>Plot ternary forecasts in barycentric coordinates.</p></a></li>
<li><a href='#tscale'>
<p>Rescale a 3-vector to yield a ternary forecast</p></a></li>
<li><a href='#tscore'>
<p>Calculate the (Brier) score associated with ternary forecasts and observations</p></a></li>
<li><a href='#tsetup'>
<p>Utility function to calculate geometry associated with a quadratic score matrix</p></a></li>
<li><a href='#tverify'><p>Verification of ternary forecasts / observations</p></a></li>
<li><a href='#xf'>
<p>x coordinate of a ternary forecast in barycentric coordinates</p></a></li>
<li><a href='#yf'>
<p>y coordinate of a ternary forecast in barycentric coordinates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualisation, Verification and Calibration of Ternary
Probabilistic Forecasts</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-07-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Tim Jupp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tim Jupp &lt;T.E.Jupp@exeter.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of functions for visualising ternary probabilistic forecasts, as discussed in the paper by Jupp (2012) &lt;<a href="https://doi.org/10.1098%2Frsta.2011.0350">doi:10.1098/rsta.2011.0350</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>quadprog, maps, dichromat, grid, stats, graphics, grDevices</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-05 12:03:10 UTC; tej202</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-05 12:30:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='ternvis-package'>
Visualisation, verification and calibration of ternary forecast data
</h2><span id='topic+ternvis-package'></span><span id='topic+ternvis'></span>

<h3>Description</h3>

<p>A suite of functions for visualising ternary probabilistic forecasts.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ternvis</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-03-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2
</td>
</tr>

</table>

<p>Colours can be assigned to ternary probabilistic forecasts using <code><a href="#topic+tcolour">tcolour</a></code>. 
These colours can be used to produce forecast maps as in the example function <code><a href="#topic+tmap">tmap</a></code>.
A set of ternary forecasts <code>p</code> can be compared with subsequent ternary observations <code>o</code> using the function <code><a href="#topic+tverify">tverify</a></code>. <code><a href="#topic+plot.tverify">plot.tverify</a></code> then displays this information in a Ternary Reliability Diagram. Calibration is performed using <code><a href="#topic+tgetcal">tgetcal</a></code> and <code><a href="#topic+tcalibrate">tcalibrate</a></code>.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>
<p>Maintainer: Tim Jupp &lt;t.e.jupp@exeter.ac.uk&gt;
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p>Some concepts adapted from those in package <em>vcd</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foot)
# see the distribution of forecasts
tplot(foot$p,main="Bookmaker forecasts of \n football matches",
      dimnames=c("Home Win","Draw","Away Win"))
# see how well forecasts compare with results
# create object of class tverify
foot.verify &lt;- tverify(p=foot$p,o=foot$o)
 
# plot ternary reliability diagram
dev.new()
plot(foot.verify, thresh=3)               

# get a (linear) calibration of these data
# create an object of class tverify
foot.calib &lt;- tgetcal(foot.verify) 

# plot ternary reliability diagram of calibrated        
dev.new()
plot(foot.calib, thresh=3)                

data(rain)

tmap(rain,iyr=17,palette=TRUE,circles=FALSE,fac=10) </code></pre>

<hr>
<h2 id='foot'>
Football betting dataset
</h2><span id='topic+foot'></span>

<h3>Description</h3>

<p>A collection of bookmakers' football odds (for home win/draw/away win, expressed as ternary probabilistic forecasts) and subsequent results. The data cover several years of English league games.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(foot)</code></pre>


<h3>Format</h3>

<p>The quoted odds, transformed to probabilities, are in foot$p (a 3-column matrix).
The corresponding results of the games are in foot$o (a 3-column matrix).
</p>


<h3>Source</h3>

<p>Data taken from www.football-data.co.uk.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foot)
# see the distribution of forecasts
tplot(foot$p,main="Bookmaker forecasts of \n football matches",
      dimnames=c("Home Win","Draw","Away Win"))
      
# see how well forecasts compare with results
# create object of class tverify
foot.verify &lt;- tverify(p=foot$p,o=foot$o) 

# plot ternary reliability diagram
dev.new()
plot(foot.verify, thresh=3)    
           
# get a (linear) calibration of these data
# create an object of class tverify
foot.calib &lt;- tgetcal(foot.verify) 

# plot ternary reliability diagram of calibrated forecasts       
dev.new()
plot(foot.calib, thresh=3)                 </code></pre>

<hr>
<h2 id='rain'>
Ternary precipitation forecast data set
</h2><span id='topic+rain'></span>

<h3>Description</h3>

<p>An array of monthly seasonal precipitation forecasts and observations over South America, covering 25 years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rain)</code></pre>


<h3>Format</h3>

<p>A list containing 7 objects
</p>
<p>rain$lats      a vector of 35 latitudes
</p>
<p>rain$lons      a vector of 27 longitudes
</p>
<p>rain$obs       array of ternary observations 
</p>
<p>rain$preds     array of ternary forecast probabilities
</p>
<p>rain$rel       array of reliabilities
</p>
<p>rain$res       array of resolutions
</p>
<p>rain$q         array of climatologies
</p>


<h3>Source</h3>

<p>Data from Caio Coelho at <a href="http://eurobrisa.cptec.inpe.br">http://eurobrisa.cptec.inpe.br</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rain)

ilon &lt;- 5 # pick a longitude
ilat &lt;- 6 # pick a latitude
iyr  &lt;- 17 # pick a year (in the range 1:25)

rain$lons[ilon]                # the longitude
rain$lats[ilat]                # the latitude
rain$pred[ilon,ilat,iyr,] # the ternary forecast
rain$obs[ilon,ilat,iyr,]  # the ternary observation

</code></pre>

<hr>
<h2 id='tcalibrate'>
Calibration of ternary forecasts
</h2><span id='topic+tcalibrate'></span>

<h3>Description</h3>

<p>Function to apply a calibration to a matrix of ternary forecasts.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcalibrate(tv, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tcalibrate_+3A_tv">tv</code></td>
<td>

<p>An object of class <em>tverify</em>, for example produced by <code><a href="#topic+tgetcal">tgetcal</a></code>.
</p>
</td></tr>
<tr><td><code id="tcalibrate_+3A_p">p</code></td>
<td>

<p>An n-by-3 matrix of ternary forecasts which will be calibrated according to the calibration function embedded in <em>dat</em>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n-by-3 array of calibrated ternary forecasts.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tgetcal">tgetcal</a></code>, <code><a href="#topic+tplot">tplot</a></code>, <code><a href="#topic+tverify">tverify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get football betting data
data(foot) 

# get verification info for these data                         
tv   &lt;- tverify(p=foot$p,o=foot$o)  

# get a linear calibration based on verification info         
lc   &lt;- tgetcal(tv)  

# consider an uncalibrated forecast p                 
p    &lt;- cbind(0,0,1)    

# see where p is mapped by this calibration            
pcal &lt;- tcalibrate(lc,cbind(0,0,1)) 

# plot the uncalibrated forecast
tplot(p) 
# plot the calibrated forecast                        
tplot(pcal,col="blue",newpage=FALSE,bg="transparent")
</code></pre>

<hr>
<h2 id='tcolour'>
Assign a colour to a ternary forecast
</h2><span id='topic+tcolour'></span>

<h3>Description</h3>

<p>Function to assign a colour to a ternary forecast p, given a ternary climatology q.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcolour(p = cbind(1, 1, 1)/3, q = cbind(1, 1, 1)/3, m = 0.7, 
        flip = FALSE, dich = "none", theta0 = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tcolour_+3A_p">p</code></td>
<td>

<p>An n-by-3 matrix of ternary forecasts.
</p>
</td></tr>
<tr><td><code id="tcolour_+3A_q">q</code></td>
<td>

<p>A 1-by-3 matrix containing the climatology.
</p>
</td></tr>
<tr><td><code id="tcolour_+3A_m">m</code></td>
<td>

<p>Exponent controlling rate of colour saturation.
</p>
</td></tr>
<tr><td><code id="tcolour_+3A_flip">flip</code></td>
<td>

<p>Logical to transpose categories &quot;B&quot; and &quot;A&quot; in barycentric coordinates.
</p>
</td></tr>
<tr><td><code id="tcolour_+3A_dich">dich</code></td>
<td>

<p>Option to render colours as they would appear to a dichromat. Default choice <code>dich</code> = &quot;none&quot; leaves colours unchanged. Choices <code>dich</code> = &quot;deutan&quot; and <code>dich</code> = &quot;protan&quot; show colours as they would appear to those with deutanopia or protanopia (see <code><a href="dichromat.html#topic+dichromat">dichromat</a></code>).
</p>
</td></tr>
<tr><td><code id="tcolour_+3A_theta0">theta0</code></td>
<td>

<p>Angle (degrees) through which to rotate colour palette around climatology <code>q</code> in barycentric coordinates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour, of the format produced by <code><a href="grDevices.html#topic+rgb">rgb</a></code>.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- cbind(0.7,0.2,0.1)   # define a forecast
q &lt;- cbind(1,1,1)/3       # define a climatology
pcol &lt;- tcolour(p=p,q=q)  # assign a colour
pcol                      # print the colour code to terminal
tplot(p,col=pcol)         # use this colour in a plot
</code></pre>

<hr>
<h2 id='tgetcal'>
Get a linear or quadratic calibration of ternary forecast / observation data
</h2><span id='topic+tgetcal'></span>

<h3>Description</h3>

<p>Function to obtain a best-fitting calibration to a set of ternary forecasts p and corresponding observations o.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgetcal(tv, quad = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tgetcal_+3A_tv">tv</code></td>
<td>

<p>An object of the tverify class (as produced by <code><a href="#topic+tverify">tverify</a></code>).
</p>
</td></tr>
<tr><td><code id="tgetcal_+3A_quad">quad</code></td>
<td>

<p>A logical describing which functional form to use for calibration. Linear calibration (<code>quad</code> = FALSE) is faster. Quadratic calibration (<code>quad</code> = TRUE) is more sophisticated but can be slow for large data sets.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tverify">tverify</a></code>, <code><a href="#topic+tcalibrate">tcalibrate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foot)
# see the distribution of forecasts
tplot(foot$p,main="Bookmaker forecasts of \n football matches",
      dimnames=c("Home Win","Draw","Away Win"))
      
# see how well forecasts compare with results
# create object of class tverify
foot.verify &lt;- tverify(p=foot$p,o=foot$o) 

# plot ternary reliability diagram
dev.new()
plot(foot.verify, thresh=3)    
           
# get a (linear) calibration of these data
# create an object of class tverify
foot.calib &lt;- tgetcal(foot.verify) 

# plot ternary reliability diagram of calibrated forecasts       
dev.new()
plot(foot.calib, thresh=3)                
</code></pre>

<hr>
<h2 id='tgrid'>
Create a grid of points in barycentric coordinates
</h2><span id='topic+tgrid'></span>

<h3>Description</h3>

<p>Utility function to generate a grid of ternary forecasts equally spaced in baycentric coordinates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgrid(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tgrid_+3A_n">n</code></td>
<td>

<p>An integer describing the number of &lsquo;bins&rsquo; along each side of the barycentric triangle.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n-by-3 matrix of ternary forecasts.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tplot">tplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tg &lt;- tgrid(6) # make a grid of forecasts in the triangle
tg             # print forecasts to the terminal
tplot(tg)      # plot forecasts
</code></pre>

<hr>
<h2 id='tmap'>
Demonstration of how to make coloured maps of ternary forecasts
</h2><span id='topic+tmap'></span>

<h3>Description</h3>

<p>An example of how one might make forecast maps using <code><a href="#topic+tpalette">tpalette</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmap(dat, iyr, circles = FALSE, fac = 10, theta0 = 0, 
     dich = "none", m = 0.7, palette = TRUE, 
     flip = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tmap_+3A_dat">dat</code></td>
<td>

<p>An array of forecasts in a suitable format. See <em>Example</em> code below
</p>
</td></tr>
<tr><td><code id="tmap_+3A_iyr">iyr</code></td>
<td>

<p>In this example, an integer in the range 1 to 25.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_circles">circles</code></td>
<td>

<p><code>circles</code> = FALSE (the default) fills map with coloured polygons. <code>circles</code> = TRUE fills map with circles whose radii are dependent on verification information. 
</p>
</td></tr>
<tr><td><code id="tmap_+3A_fac">fac</code></td>
<td>

<p>Scaling factor for size of circles when <code>circles</code> = TRUE.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_theta0">theta0</code></td>
<td>

<p>Angle to rotate colours on palette. See <code><a href="#topic+tcolour">tcolour</a></code>.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_dich">dich</code></td>
<td>

<p>Optionally render colours as they would appear to a dichromat. See <code><a href="#topic+tcolour">tcolour</a></code>.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_m">m</code></td>
<td>

<p>Parameter controlling rate at which colours saturate in palette. See <code><a href="#topic+tcolour">tcolour</a></code>.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_palette">palette</code></td>
<td>

<p>Logical. If <code>palette</code> = TRUE a colour palette is included.
</p>
</td></tr>
<tr><td><code id="tmap_+3A_flip">flip</code></td>
<td>

<p>Logical to choose whether to switch categories <em>B</em> and <em>A</em>. See <code><a href="#topic+tcolour">tcolour</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rain)

tmap(rain,iyr=17,palette=TRUE,circles=FALSE,fac=10)
</code></pre>

<hr>
<h2 id='tpalette'>
Draw a palette of the colours assigned to ternary forecasts
</h2><span id='topic+tpalette'></span>

<h3>Description</h3>

<p>Function to fill barycentric coordinates with a colour palette.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tpalette(q = cbind(1, 1, 1)/3, bars = TRUE, m = 0.7, 
         flip = FALSE, lmain = FALSE, theta0 = 0, 
	 dich = "none", cex = 1, nhist = 12)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tpalette_+3A_q">q</code></td>
<td>

<p>A 1-by-3 matrix containing a climatology.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_bars">bars</code></td>
<td>

<p>Logical. If &quot;FALSE&quot; a simple colour palette is produced. If &quot;TRUE&quot; barplots representing the forecasts are overlain.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_m">m</code></td>
<td>

<p>Parameter controlling the rate at which colours saturate towards the corners of the triangle.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_flip">flip</code></td>
<td>

<p>Logical to transpose categories &quot;B&quot; and &quot;A&quot; in barycentric coordinates.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_lmain">lmain</code></td>
<td>

<p>Logical. If &quot;TRUE&quot; text is overlaid.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_theta0">theta0</code></td>
<td>

<p>Angle (degrees) through which to rotate colour palette around climatology <code>q</code> in barycentric coordinates.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_dich">dich</code></td>
<td>

<p>Option to render colours as they would appear to a dichromat. Default choice <code>dich</code> = &quot;none&quot; leaves colours unchanged. Choices <code>dich</code> = &quot;deutan&quot; and <code>dich</code> = &quot;protan&quot; show colours as they would appear to those with deutanopia or protanopia (see <code><a href="dichromat.html#topic+dichromat">dichromat</a></code>).
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_cex">cex</code></td>
<td>

<p>Factor for expanding the size of the dots when bars is &quot;FALSE&quot;.
</p>
</td></tr>
<tr><td><code id="tpalette_+3A_nhist">nhist</code></td>
<td>

<p>Number of barplots along each side of the triangle when bars is &quot;TRUE&quot;.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tmap">tmap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev.new()
tpalette(bars=FALSE) # standard palette

dev.new()
tpalette(bars=TRUE) # palette with histograms overlaid
</code></pre>

<hr>
<h2 id='tplot'>
Plot ternary forecasts in barycentric coordinates. 
</h2><span id='topic+tplot'></span>

<h3>Description</h3>

<p>This function is almost exactly the same as the <code>ternaryplot</code> function in package <code>vcd</code> (on which it is based) except that the ordering of the vertices has been change to bottom left/top/bottom right, and the code has been extended work for an aribtrary scoring matrix <code>L</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tplot(x = cbind(1, 1, 1)/3, L = diag(c(1, 1, 1))/sqrt(2), 
      scale = 1, dimnames = NULL, 
      dimnames_position = c("corner", "none"), 
      dimnames_color = "black", id = NULL, id_color = "black", 
      coordinates = FALSE, grid = TRUE, grid_color = "gray", 
      labels = c("inside", "outside", "none"), 
      labels_color = "darkgray", border = "grey", 
      bg = "white", pch = 19, cex = 1, prop_size = FALSE, 
      col = "red", main = "ternary plot", sub = NULL, 
      newpage = TRUE, pop = TRUE, col.main = "black", 
      col.sub = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tplot_+3A_x">x</code></td>
<td>

<p>an n-by-3 matrix of ternary forecasts.
</p>
</td></tr>
<tr><td><code id="tplot_+3A_l">L</code></td>
<td>

<p>A matrix describing the quadratic score function. (Default corresponds to the Brier score).
</p>
</td></tr>
<tr><td><code id="tplot_+3A_scale">scale</code></td>
<td>

<p>row sums scale to be used.</p>
</td></tr>
<tr><td><code id="tplot_+3A_dimnames">dimnames</code></td>
<td>

<p>dimension labels (defaults to the column names of <code>x</code>.</p>
</td></tr>
<tr><td><code id="tplot_+3A_dimnames_position">dimnames_position</code>, <code id="tplot_+3A_dimnames_color">dimnames_color</code></td>
<td>
<p>position and color of dimension labels.</p>
</td></tr>
<tr><td><code id="tplot_+3A_id">id</code></td>
<td>
<p>optional labels to be plotted below the plot symbols. <code>coordinates</code> and <code>id</code> are mutually exclusive.</p>
</td></tr>
<tr><td><code id="tplot_+3A_id_color">id_color</code></td>
<td>
<p>color of these labels.</p>
</td></tr>
<tr><td><code id="tplot_+3A_coordinates">coordinates</code></td>
<td>

<p>if <code>TRUE</code>, the coordinates of the points are plotted below them. <code>coordinates</code> and <code>id</code> are mutually exclusive.</p>
</td></tr>
<tr><td><code id="tplot_+3A_grid">grid</code></td>
<td>

<p>if <code>TRUE</code>, a grid is plotted. May optionally be a string indicating the line type (default: <code>"dotted"</code>).</p>
</td></tr>
<tr><td><code id="tplot_+3A_grid_color">grid_color</code></td>
<td>

<p>grid colour.</p>
</td></tr>
<tr><td><code id="tplot_+3A_labels">labels</code>, <code id="tplot_+3A_labels_color">labels_color</code></td>
<td>

<p>position and colour of the grid labels.</p>
</td></tr>
<tr><td><code id="tplot_+3A_border">border</code></td>
<td>

<p>colour of the triangle border.</p>
</td></tr>
<tr><td><code id="tplot_+3A_bg">bg</code></td>
<td>

<p>triangle background.</p>
</td></tr>
<tr><td><code id="tplot_+3A_pch">pch</code></td>
<td>

<p>plotting character. Defaults to filled dots.</p>
</td></tr>
<tr><td><code id="tplot_+3A_cex">cex</code></td>
<td>

<p>a numerical value giving the amount by which plotting text and symbols should be scaled relative to the default. Ignored for the symbol size if <code>prop_size</code> is not <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tplot_+3A_prop_size">prop_size</code></td>
<td>

<p>if <code>TRUE</code>, the symbol size is plotted proportional to the row sum of the three variables, i.e., represents the weight of the observation.</p>
</td></tr>
<tr><td><code id="tplot_+3A_col">col</code></td>
<td>

<p>plotting colour.</p>
</td></tr>
<tr><td><code id="tplot_+3A_main">main</code></td>
<td>

<p>main title.</p>
</td></tr>
<tr><td><code id="tplot_+3A_sub">sub</code></td>
<td>

<p>a sub title.</p>
</td></tr>
<tr><td><code id="tplot_+3A_newpage">newpage</code></td>
<td>

<p>if &lsquo;TRUE&rsquo;, the plot will appear on a new graphics page.</p>
</td></tr>
<tr><td><code id="tplot_+3A_pop">pop</code></td>
<td>

<p>logical; if &lsquo;TRUE&rsquo;, all newly generated viewports are popped after plotting.</p>
</td></tr>
<tr><td><code id="tplot_+3A_col.main">col.main</code></td>
<td>

<p>colour for the title.</p>
</td></tr>
<tr><td><code id="tplot_+3A_col.sub">col.sub</code></td>
<td>

<p>colour for the sub title.</p>
</td></tr>
<tr><td><code id="tplot_+3A_...">...</code></td>
<td>

<p>additional graphics parameters (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp (using code for <code>vcd:ternaryplot</code> as source).</p>


<h3>Examples</h3>

<pre><code class='language-R'>tg &lt;- tgrid(6) # make a grid of forecasts in the triangle
tg             # print to terminal
tplot(tg)      # plot them
</code></pre>

<hr>
<h2 id='tscale'>
Rescale a 3-vector to yield a ternary forecast
</h2><span id='topic+tscale'></span>

<h3>Description</h3>

<p>Utility function to rescale 3-vectors to be probability distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tscale(p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tscale_+3A_p">p</code></td>
<td>

<p>a vector of length 3.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A utility function.</p>


<h3>Value</h3>

<p>A vector of length 3 rescaled so that elements are all &gt;= 0 and sum to unity.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tscale(cbind(1,2,3))  # rescale (1,2,3) to be a ternary forecast.
</code></pre>

<hr>
<h2 id='tscore'>
Calculate the (Brier) score associated with ternary forecasts and observations
</h2><span id='topic+tscore'></span>

<h3>Description</h3>

<p>A utility function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tscore(p, o, L = diag(c(1, 1, 1))/sqrt(2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tscore_+3A_p">p</code></td>
<td>

<p>An n-by-3 matrix of ternary forecasts.
</p>
</td></tr>
<tr><td><code id="tscore_+3A_o">o</code></td>
<td>

<p>An n-by-3 matrix of ternary observations.
</p>
</td></tr>
<tr><td><code id="tscore_+3A_l">L</code></td>
<td>

<p>A 3-by-3 matrix defining the quadratic score being used. (Default corresponds to Brier score.)
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foot)
tscore(p=foot$p,o=foot$o)
</code></pre>

<hr>
<h2 id='tsetup'>
Utility function to calculate geometry associated with a quadratic score matrix
</h2><span id='topic+tsetup'></span>

<h3>Description</h3>

<p>This is just a useful internal function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsetup(L = diag(c(1, 1, 1))/sqrt(2), q = cbind(1, 1, 1)/3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tsetup_+3A_l">L</code></td>
<td>

<p>A 3-by-3 matrix defining the quadratic score being used. (Default corresponds to Brier score.)
</p>
</td></tr>
<tr><td><code id="tsetup_+3A_q">q</code></td>
<td>

<p>A 1-by-3 matrix containing the climatology.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tsetup() # returns a set of useful objects
</code></pre>

<hr>
<h2 id='tverify'>Verification of ternary forecasts / observations</h2><span id='topic+tverify'></span><span id='topic+tverify.default'></span><span id='topic+plot.tverify'></span>

<h3>Description</h3>

<p>Function to create verification information associated with a set of forecasts <code>p</code> and associated observations <code>o</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tverify(p, o, q, forceq, ncirc, L)

## Default S3 method:
tverify(p = cbind(1, 1, 1)/3, o = cbind(0, 0, 1), 
        q = cbind(1, 1, 1)/3, forceq = FALSE, 
        ncirc = 11, L = diag(c(1, 1, 1))/sqrt(2))
## S3 method for class 'tverify'
plot(x, thresh = 0, lsharp = TRUE, 
     L = diag(c(1, 1, 1))/sqrt(2),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tverify_+3A_p">p</code></td>
<td>
<p>An n-by-3 matrix of ternary forecasts.</p>
</td></tr>
<tr><td><code id="tverify_+3A_o">o</code></td>
<td>
<p>An n-by-3 matrix of ternary observations.</p>
</td></tr>
<tr><td><code id="tverify_+3A_q">q</code></td>
<td>
<p>A 1-by-3 matrix containing the climatology.</p>
</td></tr>  
<tr><td><code id="tverify_+3A_forceq">forceq</code></td>
<td>
<p>A logical. If <code>forceq</code> = TRUE then the input climatology <code>q</code> is used. If <code>forceq</code> = FALSE a climatology is calculated from <code>o</code>. </p>
</td></tr>
<tr><td><code id="tverify_+3A_ncirc">ncirc</code></td>
<td>
<p>Controls discretisation of barycentric coordinates. (The number of hexagons along each side of the triangle.) </p>
</td></tr>
<tr><td><code id="tverify_+3A_x">x</code></td>
<td>
<p>An object of the tverify class (as produced by <code><a href="#topic+tverify">tverify</a></code> or <code><a href="#topic+tgetcal">tgetcal</a></code>.</p>
</td></tr>
<tr><td><code id="tverify_+3A_thresh">thresh</code></td>
<td>
<p>A &lsquo;threshold&rsquo; number of forecasts in a &lsquo;bin&rsquo;, below which the forecast will not be plotted. (Prevents diagram being cluttered by very rare forecasts).</p>
</td></tr>
<tr><td><code id="tverify_+3A_lsharp">lsharp</code></td>
<td>
<p>Logical controlling whether a ternary sharpness diagram is to be included.</p>
</td></tr>
<tr><td><code id="tverify_+3A_l">L</code></td>
<td>
<p>A quadratic scoring matrix. The matrix for the Brier score is the default. Full functionality for other scores not yet implemented.</p>
</td></tr>
<tr><td><code id="tverify_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tverify</code>, which is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>pbin</code></td>
<td>
<p>array of bins in barycentric coordinates.</p>
</td></tr>
<tr><td><code>Nobs</code></td>
<td>
<p>number of forecasts in each bin.</p>
</td></tr>
<tr><td><code>obar</code></td>
<td>
<p>mean onservation associated with each forecast bin.</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>score associated with each forecast bin.</p>
</td></tr> 
<tr><td><code>unc</code></td>
<td>
<p>uncertainty associated with each forecast bin.</p>
</td></tr>
<tr><td><code>rel</code></td>
<td>
<p>reliability associated with each forecast bin.</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>resolution associated with each forecast bin.</p>
</td></tr>
<tr><td><code>scorebar</code></td>
<td>
<p>overall score.</p>
</td></tr> 
<tr><td><code>uncbar</code></td>
<td>
<p>overall uncertainty.</p>
</td></tr>
<tr><td><code>relbar</code></td>
<td>
<p>overall reliability.</p>
</td></tr>
<tr><td><code>resbar</code></td>
<td>
<p>overall resolution.</p>
</td></tr>
<tr><td><code>ncirc</code></td>
<td>
<p>number of bins along each side of triangle.</p>
</td></tr> 
<tr><td><code>p</code></td>
<td>
<p>input forecast data.</p>
</td></tr>
<tr><td><code>o</code></td>
<td>
<p>input observation data.</p>
</td></tr>
<tr><td><code>assigned</code></td>
<td>
<p>index of bin assigned to each forecast.</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p>scoring matrix used.</p>
</td></tr>
<tr><td><code>hexc</code></td>
<td>
<p>array of hexagon centres.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>climatology.</p>
</td></tr>
<tr><td><code>pk</code></td>
<td>
<p>forecasts set to centre of each bin (<code><a href="#topic+tverify">tverify</a></code>) or recalibrated (<code><a href="#topic+tgetcal">tgetcal</a></code>)</p>
</td></tr>
<tr><td><code>ok</code></td>
<td>
<p>mean observations corresponding to forecasts <code>pk</code></p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>parameters in calibration (<code><a href="#topic+tgetcal">tgetcal</a></code> only).</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>details of calibration (<code><a href="#topic+tgetcal">tgetcal</a></code> only ).</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>calibration function (<code><a href="#topic+tgetcal">tgetcal</a></code> only, for use with <code><a href="#topic+tcalibrate">tcalibrate</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foot)                            # get football betting data
tv   &lt;- tverify(p=foot$p,o=foot$o)    # get verification info
plot(tv)                              # plot verification info
</code></pre>

<hr>
<h2 id='xf'>
x coordinate of a ternary forecast in barycentric coordinates
</h2><span id='topic+xf'></span>

<h3>Description</h3>

<p>This is a utility function to calculate the x-coordinate of a point in barycentric coordinates.
It is unlikely that the user will want to use this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xf(p = cbind(1, 1, 1)/3, M = tsetup()$M32)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xf_+3A_p">p</code></td>
<td>

<p>An n-by-3 matrix of ternary forecasts.
</p>
</td></tr>
<tr><td><code id="xf_+3A_m">M</code></td>
<td>

<p>A 2-by-3 matrix describing the transfromation for R^3 to R^2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n-by-1 array of x-values for use in plotting.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsetup">tsetup</a></code>, <code><a href="#topic+yf">yf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xf(p=cbind(.1,.2,.7))
</code></pre>

<hr>
<h2 id='yf'>
y coordinate of a ternary forecast in barycentric coordinates
</h2><span id='topic+yf'></span>

<h3>Description</h3>

<p>This is a utility function to calculate the y-coordinate of a point in barycentric coordinates.
It is unlikely that the user will want to use this function directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf(p = cbind(1, 1, 1)/3, M = tsetup()$M32)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_+3A_p">p</code></td>
<td>

<p>An n-by-3 matrix of ternary forecasts.
</p>
</td></tr>
<tr><td><code id="yf_+3A_m">M</code></td>
<td>

<p>A 2-by-3 matrix describing the transfromation for R^3 to R^2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n-by-1 array of y-values for use in plotting.
</p>


<h3>Author(s)</h3>

<p>Tim Jupp
</p>


<h3>References</h3>

<p>Jupp TE, Lowe R, Stephenson DB, Coelho CAS (2012) On the visualization, verification and recalibration of ternary probabilistic forecasts, Philosophical Transactions of the Royal Society, volume 370, pages 1100-1120. 
</p>
<p><a href="http://rsta.royalsocietypublishing.org/content/370/1962/1100.full">http://rsta.royalsocietypublishing.org/content/370/1962/1100.full</a>
</p>
<p><a href="http://arxiv.org/abs/1103.1303">http://arxiv.org/abs/1103.1303</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tsetup">tsetup</a></code>, <code><a href="#topic+xf">xf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yf(p=cbind(.1,.2,.7))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
