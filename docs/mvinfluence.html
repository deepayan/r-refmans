<!DOCTYPE html><html lang="en-US"><head><title>Help for package mvinfluence</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mvinfluence}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mvinfluence'><p>Influence Measures and Diagnostic Plots for Multivariate Linear Models</p></a></li>
<li><a href='#as.data.frame.inflmlm'><p>Convert an inflmlm object to a data frame</p></a></li>
<li><a href='#cooks.distance.mlm'><p>Cook's distance for a MLM</p></a></li>
<li><a href='#Fertilizer'><p>Fertilizer Data</p></a></li>
<li><a href='#hatvalues.mlm'><p>Hatvalues for a MLM</p></a></li>
<li><a href='#infIndexPlot.mlm'><p>Influence Index Plots for Multivariate Linear Models</p></a></li>
<li><a href='#influence.mlm'><p>Regression Deletion Diagnostics for Multivariate Linear Models</p></a></li>
<li><a href='#influencePlot.mlm'><p>Influence Plots for Multivariate Linear Models</p></a></li>
<li><a href='#Jtr'><p>General Classes of Influence Measures</p></a></li>
<li><a href='#lrPlot'><p>Regression LR Influence Plot</p></a></li>
<li><a href='#mlm.influence'><p>Calculate Regression Deletion Diagnostics for Multivariate Linear Models</p></a></li>
<li><a href='#mpower'><p>General Matrix Power</p></a></li>
<li><a href='#print.inflmlm'><p>Print an inflmlm object</p></a></li>
<li><a href='#tr'><p>Matrix trace</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Influence Measures and Diagnostic Plots for Multivariate Linear
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Friendly &lt;friendly@yorku.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes regression deletion diagnostics for multivariate linear models and provides some associated
	diagnostic plots.  The diagnostic measures include hat-values (leverages), generalized Cook's distance, and
	generalized squared 'studentized' residuals.  Several types of plots to detect influential observations are
	provided.</td>
</tr>
<tr>
<td>Depends:</td>
<td>car, heplots</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2, tibble, patchwork, rgl, dplyr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/friendly/mvinfluence">https://github.com/friendly/mvinfluence</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/friendly/mvinfluence/issues">https://github.com/friendly/mvinfluence/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-20 16:49:20 UTC; friendly</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Friendly <a href="https://orcid.org/0000-0002-3237-0941"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-20 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mvinfluence'>Influence Measures and Diagnostic Plots for Multivariate Linear Models</h2><span id='topic+mvinfluence'></span><span id='topic+mvinfluence-package'></span>

<h3>Description</h3>

<p>Functions in this package compute regression deletion diagnostics for multivariate linear 
models following methods proposed by Barrett &amp; Ling (1992) and provide some associated diagnostic plots.
</p>


<h3>Details</h3>

<p>The design goal for this package is that, as an extension of standard methods for univariate linear models, you should be able to fit a linear model with a multivariate response,
</p>
<pre>
  mymlm &lt;- lm( cbind(y1, y2, y3) ~ x1 + x2 + x3, data=mydata)
</pre>
<p>and then get useful diagnostics and plots with
</p>
<pre>
  influence(mymlm)
  hatvalues(mymlm)
  influencePlot(mymlm, ...)  
</pre>
<p>The diagnostic measures include hat-values (leverages), generalized Cook's distance and
generalized squared 'studentized' residuals.  Several types of plots to detect 
influential observations are provided.
</p>
<p>In addition, the functions provide diagnostics for deletion of subsets of observations 
of size <code>m&gt;1</code>. This case is theoretically interesting because sometimes pairs (<code>m=2</code>) 
of influential observations can mask each other, sometimes they can have joint influence 
far exceeding their individual effects, as well as other interesting phenomena described 
by Lawrence (1995). Associated methods for the case <code>m&gt;1</code> are still under development in this package.
</p>
<p>The main function in the package is the S3 method, <code><a href="#topic+influence.mlm">influence.mlm</a></code>, a simple wrapper for
<code><a href="#topic+mlm.influence">mlm.influence</a></code>, which does the actual computations.
This design was dictated by that used in the <span class="pkg">stats</span> package, which provides
the generic method <code><a href="stats.html#topic+influence">influence</a></code> and methods
<code><a href="stats.html#topic+influence.lm">influence.lm</a></code> and <code><a href="stats.html#topic+influence.glm">influence.glm</a></code>. The <span class="pkg">car</span> package extends this to include
<code><a href="car.html#topic+influence.lme">influence.lme</a></code> for models fit by <code><a href="nlme.html#topic+lme">lme</a></code>.
</p>
<p>The following sections describe the notation and measures used in the calculations.
</p>


<h3>Notation</h3>

<p>Let <code class="reqn">\mathbf{X}</code> be the model matrix in the multivariate linear model, 
<code class="reqn">\mathbf{Y}_{n \times p} = \mathbf{X}_{n \times r} \mathbf{\beta}_{r \times p} + \mathbf{E}_{n \times p}</code>.
The usual least squares estimate of <code class="reqn">\mathbf{\beta}</code> is given by
<code class="reqn">\mathbf{B} = (\mathbf{X}^{T} \mathbf{X})^{-1}  \mathbf{X}^{T} \mathbf{Y}</code>.
</p>
<p>Then let 
</p>

<ul>
<li> <p><code class="reqn">\mathbf{X}_I</code> be the submatrix of <code class="reqn">\mathbf{X}</code> whose <code class="reqn">m</code> rows are indexed by <code class="reqn">I</code>,
</p>
</li>
<li> <p><code class="reqn">\mathbf{X}_{(I)}</code> is the complement, the submatrix of <code class="reqn">\mathbf{X}</code> with the <code class="reqn">m</code> rows in <code class="reqn">I</code> deleted,
</p>
</li></ul>

<p>Matrices <code class="reqn">\mathbf{Y}_I</code>, <code class="reqn">\mathbf{Y}_{(I)}</code> are defined similarly. 
</p>
<p>In the calculation of regression coefficients,
<code class="reqn">\mathbf{B}_{(I)} = (\mathbf{X}_{(I)}^{T} \mathbf{X}_{(I)})^{-1} \mathbf{X}_{(I)}^{T} \mathbf{Y}_{I}</code> are the estimated 
coefficients
when the cases indexed by <code class="reqn">I</code> have been removed. The corresponding residuals are
<code class="reqn">\mathbf{E}_{(I)} = \mathbf{Y}_{(I)} - \mathbf{X}_{(I)} \mathbf{B}_{(I)}</code>.
</p>


<h3>Measures</h3>

<p>The influence measures defined by Barrett &amp; Ling (1992) are functions of two matrices <code class="reqn">\mathbf{H}_I</code> and <code class="reqn">\mathbf{Q}_I</code>
defined as follows:
</p>

<ul>
<li><p> For the full data set, the &ldquo;hat matrix&rdquo;, <code class="reqn">\mathbf{H}</code>, is given by
<code class="reqn">\mathbf{H} = \mathbf{X} (\mathbf{X}^{T} \mathbf{X})^{-1} \mathbf{X}^{T} </code>,
</p>
</li>
<li> <p><code class="reqn">\mathbf{H}_I</code> is <code class="reqn">m \times m</code> the submatrix of <code class="reqn">\mathbf{H}</code> corresponding to the index set <code class="reqn">I</code>,
<code class="reqn">\mathbf{H}_I = \mathbf{X} (\mathbf{X}_I^{T} \mathbf{X}_I)^{-1} \mathbf{X}^{T} </code>,
</p>
</li>
<li> <p><code class="reqn">\mathbf{Q}</code> is the analog of <code class="reqn">\mathbf{H}</code> defined for the residual matrix <code class="reqn">\mathbf{E}</code>, that is,
<code class="reqn">\mathbf{Q} = \mathbf{E} (\mathbf{E}^{T} \mathbf{E})^{-1} \mathbf{E}^{T} </code>, with corresponding submatrix
<code class="reqn">\mathbf{Q}_I = \mathbf{E} (\mathbf{E}_I^{T} \mathbf{E}_I)^{-1} \mathbf{E}^{T} </code>,
</p>
</li></ul>



<h3>Cook's distance</h3>

<p>In these terms, Cook's distance is defined for a univariate response by
</p>
<p style="text-align: center;"><code class="reqn">D_I = (\mathbf{b} - \mathbf{b}_{(I)})^T (\mathbf{X}^T \mathbf{X}) (\mathbf{b} - \mathbf{b}_{(I)}) / p s^2 \; ,</code>
</p>
 
<p>a measure of the squared distance between the coefficients <code class="reqn">\mathbf{b}</code> for the full data set and those
<code class="reqn">\mathbf{b}_{(I)}</code> 
obtained when the cases in <code class="reqn">I</code> are deleted.  
</p>
<p>In the multivariate case, Cook's distance is obtained
by replacing the vector of coefficients <code class="reqn">\mathbf{b}</code> by <code class="reqn">\mathrm{vec} (\mathbf{B})</code>, the result of stringing out
the coefficients for all responses in a single <code class="reqn">n \times p</code>-length vector.
</p>
<p style="text-align: center;"><code class="reqn">D_I = \frac{1}{p} [\mathrm{vec} (\mathbf{B} - \mathbf{B}_{(I)})]^T (S_{-1} \otimes \mathbf{X}^T \mathbf{X}) \mathrm{vec} (\mathbf{B} - \mathbf{B}_{(I)})  \; ,</code>
</p>
 
<p>where <code class="reqn">\otimes</code> is the Kronecker (direct) product and
<code class="reqn">\mathbf{S} = \mathbf{E}^T \mathbf{E} / (n-p)</code> is the covariance matrix of the residuals.
</p>


<h3>Leverage and residual components</h3>

<p>For a univariate response, and when <code>m = 1</code>, Cook's distance can be re-written as a product of leverage and residual components as
</p>
<p style="text-align: center;"><code class="reqn">D_i = \left(\frac{n-p}{p} \right) \frac{h_{ii}}{(1 - h_{ii})^2 q_{ii} } \;.</code>
</p>

<p>Then we can define a leverage component <code class="reqn">L_i</code> and residual component <code class="reqn">R_i</code> as
</p>
<p style="text-align: center;"><code class="reqn">L_i = \frac{h_{ii}}{1 - h_{ii}} \quad\quad R_i = \frac{q_{ii}}{1 - h_{ii}} \;.</code>
</p>
 
<p><code class="reqn">R_i</code> is the studentized residual, and <code class="reqn">D_i \propto L_i \times R_i</code>.
</p>
<p>In the general, multivariate case there are analogous matrix expressions for <code class="reqn">\mathbf{L}</code> and <code class="reqn">\mathbf{R}</code>.
When <code>m &gt; 1</code>, the quantities <code class="reqn">\mathbf{H}_I</code>, <code class="reqn">\mathbf{Q}_I</code>, <code class="reqn">\mathbf{L}_I</code>, and
<code class="reqn">\mathbf{R}_I</code> are <code class="reqn">m \times m</code> matrices.  Where scalar quantities are needed, the package functions apply
a function, <code>FUN</code>, either <code>det()</code> or <code>tr()</code> to calculate a measure of &ldquo;size&rdquo;, as in
</p>
<pre>
  H &lt;- sapply(x$H, FUN)
  Q &lt;- sapply(x$Q, FUN)
  L &lt;- sapply(x$L, FUN)
  R &lt;- sapply(x$R, FUN)
</pre>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992).
General Classes of Influence Measures for Multivariate Regression.
<em>Journal of the American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression.
<em>Communications in Statistics &ndash; Theory and Methods</em>, <b>32</b>, 3, 667-680.
</p>
<p>A. J. Lawrence (1995).
Deletion Influence and Masking in Regression.
<em>Journal of the Royal Statistical Society. Series B (Methodological)</em> , <b>57</b>, 1, 181-189.
</p>

<hr>
<h2 id='as.data.frame.inflmlm'>Convert an inflmlm object to a data frame</h2><span id='topic+as.data.frame.inflmlm'></span>

<h3>Description</h3>

<p>This function is used internally in the package to convert the result of <code>mlm.influence()</code> to a data frame.
It is not normally called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inflmlm'
as.data.frame(x, ..., FUN = det, funnames = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.data.frame.inflmlm_+3A_x">x</code></td>
<td>
<p>An <code>inflmlm</code> object, as returned by <code>mlm.influence</code></p>
</td></tr>
<tr><td><code id="as.data.frame.inflmlm_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="as.data.frame.inflmlm_+3A_fun">FUN</code></td>
<td>
<p>in the case where the subset size, <code>m&gt;1</code>, the function used on the <code>H, Q, L, R</code> to calculate
a single statistic. The default is <code>det</code>. An alternative is <code>tr</code>, for matrix trace.</p>
</td></tr>
<tr><td><code id="as.data.frame.inflmlm_+3A_funnames">funnames</code></td>
<td>
<p>logical. Should the <code>FUN</code> name be prepended to the statistics when creating a data frame?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the influence statistics
</p>


<h3>Examples</h3>

<pre><code class='language-R'># none

</code></pre>

<hr>
<h2 id='cooks.distance.mlm'>Cook's distance for a MLM</h2><span id='topic+cooks.distance.mlm'></span>

<h3>Description</h3>

<p>The functions <code>cooks.distance.mlm</code> and <code>hatvalues.mlm</code> are
designed as extractor functions for regression deletion diagnostics for
multivariate linear models following Barrett &amp; Ling (1992). These are close
analogs of methods for univariate and generalized linear models handled by
the <code><a href="stats.html#topic+influence.measures">influence.measures</a></code> in the <code>stats</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
cooks.distance(model, infl = mlm.influence(model, do.coef = FALSE), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cooks.distance.mlm_+3A_model">model</code></td>
<td>
<p>A <code>mlm</code> object, fit by <code>lm()</code></p>
</td></tr>
<tr><td><code id="cooks.distance.mlm_+3A_infl">infl</code></td>
<td>
<p>A <code>inflmlm</code> object. The default simply runs <code>mlm.influence()</code> on the model, suppressing coefficients.</p>
</td></tr>
<tr><td><code id="cooks.distance.mlm_+3A_...">...</code></td>
<td>
<p>Ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition, the functions provide diagnostics for deletion of subsets of
observations of size <code>m&gt;1</code>.
</p>


<h3>Value</h3>

<p>A vector of Cook's distances
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Rohwer, package="heplots")
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
rownames(Rohwer2)&lt;- 1:nrow(Rohwer2)
Rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)

hatvalues(Rohwer.mod)
cooks.distance(Rohwer.mod)

</code></pre>

<hr>
<h2 id='Fertilizer'>Fertilizer Data</h2><span id='topic+Fertilizer'></span>

<h3>Description</h3>

<p>A small data set on the use of fertilizer (x) in relation to the amount of
grain (y1) and straw (y2) produced.
</p>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 3 variables.
</p>
 
<dl>
<dt>grain</dt><dd><p>amount of grain produced</p>
</dd>
<dt>straw</dt><dd><p>amount of straw produced</p>
</dd>
<dt>fertilizer</dt><dd><p>amount of fertilizer applied</p>
</dd> </dl>



<h3>Details</h3>

<p>The first observation is an obvious outlier and influential observation.
</p>


<h3>Source</h3>

<p>Anderson, T. W. (1984). <em>An Introduction to Multivariate
Statistical Analysis</em>, New York: Wiley, p. 369.
</p>


<h3>References</h3>

<p>Hossain, A. and Naik, D. N. (1989). Detection of influential
observations in multivariate regression. 
<em>Journal of Applied  Statistics</em>, 16 (1), 25-37.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Fertilizer)

# simple plots
plot(Fertilizer, col=c('red', rep("blue",7)), 
     cex=c(2,rep(1.2,7)), 
     pch=as.character(1:8))

# A biplot shows the data in 2D. It gives another view of how case 1 stands out in data space
biplot(prcomp(Fertilizer))

# fit the mlm
mod &lt;- lm(cbind(grain, straw) ~ fertilizer, data=Fertilizer)
Anova(mod)

# influence plots (m=1)
influencePlot(mod)
influencePlot(mod, type='LR')
influencePlot(mod, type='stres')


</code></pre>

<hr>
<h2 id='hatvalues.mlm'>Hatvalues for a MLM</h2><span id='topic+hatvalues.mlm'></span>

<h3>Description</h3>

<p>The functions <code>cooks.distance.mlm</code> and <code>hatvalues.mlm</code> are
designed as extractor functions for regression deletion diagnostics for
multivariate linear models following Barrett &amp; Ling (1992). These are close
analogs of methods for univariate and generalized linear models handled by
the <code><a href="stats.html#topic+influence.measures">influence.measures</a></code> in the <code>stats</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
hatvalues(model, m = 1, infl, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hatvalues.mlm_+3A_model">model</code></td>
<td>
<p>An object of class <code>mlm</code>, as returned by <code><a href="stats.html#topic+lm">lm</a></code></p>
</td></tr>
<tr><td><code id="hatvalues.mlm_+3A_m">m</code></td>
<td>
<p>The size of subsets to be considered</p>
</td></tr>
<tr><td><code id="hatvalues.mlm_+3A_infl">infl</code></td>
<td>
<p>An <code>inflmlm</code> object, as returned by <code>mlm.influence</code></p>
</td></tr>
<tr><td><code id="hatvalues.mlm_+3A_...">...</code></td>
<td>
<p>Other arguments, for compatibility with the generic; ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hat values are a component of influence diagnostics, measuring the leverage or 
outlyingness of observations in the space of the predictor variables.  
</p>
<p>The usual
case considers observations one at a time (<code>m=1</code>), where the hatvalue is 
proportional to the squared Mahalanobis distance, <code class="reqn">D^2</code> of each observation
from the centroid of all observations. This function extends that definition
to calculate a comparable quantity for subsets of size <code>m&gt;1</code>.
</p>


<h3>Value</h3>

<p>A vector of hatvalues
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cooks.distance.mlm">cooks.distance.mlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Rohwer, package="heplots")
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
rownames(Rohwer2)&lt;- 1:nrow(Rohwer2)
Rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)

options(digits=3)
hatvalues(Rohwer.mod)
cooks.distance(Rohwer.mod)
</code></pre>

<hr>
<h2 id='infIndexPlot.mlm'>Influence Index Plots for Multivariate Linear Models</h2><span id='topic+infIndexPlot.mlm'></span><span id='topic+influenceIndexPlot'></span>

<h3>Description</h3>

<p>Provides index plots of some diagnostic measures for a multivariate linear
model: Cook's distance, a generalized (squared) studentized residual,
hat-values (leverages), and Mahalanobis squared distances of the residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
infIndexPlot(
  model,
  infl = mlm.influence(model, do.coef = FALSE),
  FUN = det,
  vars = c("Cook", "Studentized", "hat", "DSQ"),
  main = paste("Diagnostic Plots for", deparse(substitute(model))),
  pch = 19,
  labels,
  id.method = "y",
  id.n = if (id.method[1] == "identify") Inf else 0,
  id.cex = 1,
  id.col = palette()[1],
  id.location = "lr",
  grid = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="infIndexPlot.mlm_+3A_model">model</code></td>
<td>
<p>A multivariate linear model object of class <code>mlm</code> .</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_infl">infl</code></td>
<td>
<p>influence measure structure as returned by
<code><a href="#topic+mlm.influence">mlm.influence</a></code></p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_fun">FUN</code></td>
<td>
<p>For <code>m&gt;1</code>, the function to be applied to the <code class="reqn">H</code> and
<code class="reqn">Q</code> matrices returning a scalar value.  <code>FUN=det</code> and <code>FUN=tr</code>
are possible choices, returning the <code class="reqn">|H|</code> and <code class="reqn">tr(H)</code> respectively.</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_vars">vars</code></td>
<td>
<p>All the quantities listed in this argument are plotted.  Use
<code>"Cook"</code> for generalized Cook's distances, <code>"Studentized"</code> for
generalized Studentized residuals, <code>"hat"</code> for hat-values (or
leverages), and <code>DSQ</code> for the squared Mahalanobis distances of the
model residuals.  Capitalization is optional. All may be abbreviated by the
first one or more letters.</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_main">main</code></td>
<td>
<p>main title for graph</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_pch">pch</code></td>
<td>
<p>Plotting character for points</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_id.method">id.method</code>, <code id="infIndexPlot.mlm_+3A_labels">labels</code>, <code id="infIndexPlot.mlm_+3A_id.n">id.n</code>, <code id="infIndexPlot.mlm_+3A_id.cex">id.cex</code>, <code id="infIndexPlot.mlm_+3A_id.col">id.col</code>, <code id="infIndexPlot.mlm_+3A_id.location">id.location</code></td>
<td>
<p>Arguments for the
labeling of points.  The default is <code>id.n=0</code> for labeling no points.
See <code><a href="car.html#topic+showLabels">showLabels</a></code> for details of these arguments.</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_grid">grid</code></td>
<td>
<p>If TRUE, the default, a light-gray background grid is put on the
graph</p>
</td></tr>
<tr><td><code id="infIndexPlot.mlm_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces index plots of the various influence measures
calculated by <code><a href="#topic+influence.mlm">influence.mlm</a></code>, and in addition, the measure
based on the Mahalanobis squared distances of the residuals from the origin.
</p>


<h3>Value</h3>

<p>None. Used for its side effect of producing a graph.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly; borrows code from <code>car::infIndexPlot</code>
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression
<em>Communications in Statistics - Theory and Methods</em>, <b>32</b>,
667-680.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influencePlot.mlm">influencePlot.mlm</a></code>,
<code><a href="heplots.html#topic+Mahalanobis">Mahalanobis</a></code>, <code><a href="car.html#topic+infIndexPlot">infIndexPlot</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# iris data
data(iris)
iris.mod &lt;- lm(as.matrix(iris[,1:4]) ~ Species, data=iris)
infIndexPlot(iris.mod, col=iris$Species, id.n=3)

# Sake data
data(Sake, package="heplots")
Sake.mod &lt;- lm(cbind(taste,smell) ~ ., data=Sake)
infIndexPlot(Sake.mod, id.n=3)

# Rohwer data
data(Rohwer, package="heplots")
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
rownames(Rohwer2)&lt;- 1:nrow(Rohwer2)
rohwer.mlm &lt;- lm(cbind(SAT, PPVT, Raven) ~ n + s + ns + na + ss, data=Rohwer2)
infIndexPlot(rohwer.mlm, id.n=3)


</code></pre>

<hr>
<h2 id='influence.mlm'>Regression Deletion Diagnostics for Multivariate Linear Models</h2><span id='topic+influence.mlm'></span>

<h3>Description</h3>

<p>This collection of functions is designed to compute regression deletion
diagnostics for multivariate linear models following Barrett &amp; Ling (1992)
that are close analogs of methods for univariate and generalized linear
models handled by the <code><a href="stats.html#topic+influence.measures">influence.measures</a></code> in the
<span class="pkg">stats</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
influence(model, do.coef = TRUE, m = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence.mlm_+3A_model">model</code></td>
<td>
<p>An <code>mlm</code> object, as returned by <code><a href="stats.html#topic+lm">lm</a></code></p>
</td></tr>
<tr><td><code id="influence.mlm_+3A_do.coef">do.coef</code></td>
<td>
<p>logical. Should the coefficients be returned in the
<code>inflmlm</code> object?</p>
</td></tr>
<tr><td><code id="influence.mlm_+3A_m">m</code></td>
<td>
<p>Size of the subsets for deletion diagnostics</p>
</td></tr>
<tr><td><code id="influence.mlm_+3A_...">...</code></td>
<td>
<p>Other arguments passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition, the functions provide diagnostics for deletion of subsets of
observations of size <code>m&gt;1</code>.
</p>
<p><code>influence.mlm</code> is a simple wrapper for the computational function,
<code><a href="#topic+mlm.influence">mlm.influence</a></code> designed to provide an S3 method for class
<code>"mlm"</code> objects.
</p>
<p>There are still infelicities in the methods for the <code>m&gt;1</code> case in the
current implementation. In particular, for <code>m&gt;1</code>, you must call
<code>influence.mlm</code> directly, rather than using the S3 generic
<code>influence()</code>.
</p>


<h3>Value</h3>

<p><code>influence.mlm</code> returns an S3 object of class <code>inflmlm</code>, a
list with the following components 
</p>
<table role = "presentation">
<tr><td><code>m</code></td>
<td>
<p>Deletion subset size</p>
</td></tr> 
<tr><td><code>H</code></td>
<td>
<p>Hat values, <code class="reqn">H_I</code>. If <code>m=1</code>, a vector of
diagonal entries of the &lsquo;hat&rsquo; matrix.  Otherwise, a list of 
<code class="reqn">m \times m</code> matrices corresponding to the <code>subsets</code>.</p>
</td></tr> 
<tr><td><code>Q</code></td>
<td>
<p>Residuals, <code class="reqn">Q_I</code>.</p>
</td></tr> 
<tr><td><code>CookD</code></td>
<td>
<p>Cook's distance values</p>
</td></tr> 
<tr><td><code>L</code></td>
<td>
<p>Leverage components</p>
</td></tr> 
<tr><td><code>R</code></td>
<td>
<p>Residual components</p>
</td></tr> 
<tr><td><code>subsets</code></td>
<td>
<p>Indices of the observations in the subsets of size <code>m</code></p>
</td></tr> 
<tr><td><code>labels</code></td>
<td>
<p>Observation labels</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>Model call for the <code>mlm</code> object</p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>Deletion regression coefficients&ndash; included if<code>do.coef=TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influencePlot.mlm">influencePlot.mlm</a></code>, <code><a href="#topic+mlm.influence">mlm.influence</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Rohwer data
data(Rohwer, package="heplots")
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
rownames(Rohwer2)&lt;- 1:nrow(Rohwer2)
Rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)

# m=1 diagnostics
influence(Rohwer.mod) |&gt; head()

# try an m=2 case
## res2 &lt;- influence.mlm(Rohwer.mod, m=2, do.coef=FALSE)
## res2.df &lt;- as.data.frame(res2)
## head(res2.df)
## scatterplotMatrix(log(res2.df))


influencePlot(Rohwer.mod, id.n=4, type="cookd")


# Sake data
data(Sake, package="heplots")
Sake.mod &lt;- lm(cbind(taste,smell) ~ ., data=Sake)
influence(Sake.mod)
influencePlot(Sake.mod, id.n=3, type="cookd")


</code></pre>

<hr>
<h2 id='influencePlot.mlm'>Influence Plots for Multivariate Linear Models</h2><span id='topic+influencePlot.mlm'></span>

<h3>Description</h3>

<p>This function creates various types of &ldquo;bubble&rdquo; plots of influence
measures with the areas of the circles representing the observations
proportional to generalized Cook's distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
influencePlot(
  model,
  scale = 12,
  type = c("stres", "LR", "cookd"),
  infl = mlm.influence(model, do.coef = FALSE),
  FUN = det,
  fill = TRUE,
  fill.col = "red",
  fill.alpha.max = 0.5,
  labels,
  id.method = "noteworthy",
  id.n = if (id.method[1] == "identify") Inf else 0,
  id.cex = 1,
  id.col = palette()[1],
  ref.col = "gray",
  ref.lty = 2,
  ref.lab = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influencePlot.mlm_+3A_model">model</code></td>
<td>
<p>An <code>mlm</code> object, as returned by <code><a href="stats.html#topic+lm">lm</a></code>
with a multivariate response.</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_scale">scale</code></td>
<td>
<p>a factor to adjust the radii of the circles, in relation to
<code>sqrt(CookD)</code></p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_type">type</code></td>
<td>
<p>Type of plot: one of <code>c("stres", "cookd", "LR")</code>. See Details.</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_infl">infl</code></td>
<td>
<p>influence measure structure as returned by
<code><a href="#topic+mlm.influence">mlm.influence</a></code></p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_fun">FUN</code></td>
<td>
<p>For <code>m&gt;1</code>, the function to be applied to the <code class="reqn">H</code> and
<code class="reqn">Q</code> matrices returning a scalar value.  <code>FUN=det</code> and <code>FUN=tr</code>
are possible choices, returning the <code class="reqn">|H|</code> and <code class="reqn">tr(H)</code> respectively.</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_fill">fill</code>, <code id="influencePlot.mlm_+3A_fill.col">fill.col</code>, <code id="influencePlot.mlm_+3A_fill.alpha.max">fill.alpha.max</code></td>
<td>
<p><code>fill</code>: logical, specifying whether
the circles should be filled. When <code>fill=TRUE</code>, <code>fill.col</code> gives
the base fill color to which transparency specified by <code>fill.alpha.max</code>
is applied.</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_labels">labels</code>, <code id="influencePlot.mlm_+3A_id.method">id.method</code>, <code id="influencePlot.mlm_+3A_id.n">id.n</code>, <code id="influencePlot.mlm_+3A_id.cex">id.cex</code>, <code id="influencePlot.mlm_+3A_id.col">id.col</code></td>
<td>
<p>settings for labeling points;
see <code><a href="car.html#topic+showLabels">showLabels</a></code> for details. To omit point labeling, set
<code>id.n=0</code>, the default.  The default <code>id.method="noteworthy"</code> is
used in this function to indicate setting labels for points with large
Studentized residuals, hat-values or Cook's distances. See Details below.
Set <code>id.method="identify"</code> for interactive point identification.</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_ref.col">ref.col</code>, <code id="influencePlot.mlm_+3A_ref.lty">ref.lty</code>, <code id="influencePlot.mlm_+3A_ref.lab">ref.lab</code></td>
<td>
<p>arguments for reference lines.  Incompletely
implemented in this version</p>
</td></tr>
<tr><td><code id="influencePlot.mlm_+3A_...">...</code></td>
<td>
<p>other arguments passed down</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type="stres"</code> plots squared (internally) Studentized residuals against
hat values; 
<code>type="cookd"</code> plots Cook's distance against hat values;
<code>type="LR"</code> plots residual components against leverage components, with
the attractive property that contours of constant Cook's distance fall on diagonal
lines with slope = -1. Adjacent reference lines represent multiples of influence.
</p>
<p>The <code>id.method="noteworthy"</code> setting also requires setting
<code>id.n&gt;0</code> to have any effect. Using <code>id.method="noteworthy"</code>, and
<code>id.n&gt;0</code>, the number of points labeled is the union of the largest
<code>id.n</code> values on each of L, R, and CookD.
</p>


<h3>Value</h3>

<p>If points are identified, returns a data frame with the hat values,
Studentized residuals and Cook's distance of the identified points.  If no
points are identified, nothing is returned.  This function is primarily used
for its side-effect of drawing a plot.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression
<em>Communications in Statistics - Theory and Methods</em>, <b>32</b>,
667-680.
</p>
<p>McCulloch, C. E. &amp; Meeter, D. (1983). Discussion of &quot;Outliers...&quot; by R. J.
Beckman and R. D. Cook.  <em>Technometrics</em>, 25, 152-155
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlm.influence">mlm.influence</a></code>, <code><a href="#topic+lrPlot">lrPlot</a></code>
</p>
<p><code><a href="car.html#topic+influencePlot">influencePlot</a></code> in the car package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Rohwer, package="heplots")
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
Rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)

influencePlot(Rohwer.mod, id.n=4, type="stres")
influencePlot(Rohwer.mod, id.n=4, type="LR")
influencePlot(Rohwer.mod, id.n=4, type="cookd")

# Sake data
data(Sake, package="heplots")
	Sake.mod &lt;- lm(cbind(taste,smell) ~ ., data=Sake)
	influencePlot(Sake.mod, id.n=3, type="stres")
	influencePlot(Sake.mod, id.n=3, type="LR")
	influencePlot(Sake.mod, id.n=3, type="cookd")

# Adopted data	
data(Adopted, package="heplots")
Adopted.mod &lt;- lm(cbind(Age2IQ, Age4IQ, Age8IQ, Age13IQ) ~ AMED + BMIQ, data=Adopted)
influencePlot(Adopted.mod, id.n=3)
influencePlot(Adopted.mod, id.n=3, type="LR", ylim=c(-4,-1.5))


</code></pre>

<hr>
<h2 id='Jtr'>General Classes of Influence Measures</h2><span id='topic+Jtr'></span><span id='topic+Jdet'></span><span id='topic+COOKD'></span><span id='topic+COVRATIO'></span><span id='topic+DFFITS'></span>

<h3>Description</h3>

<p>These functions implement the general classes of influence measures for
multivariate regression models defined in Barrett and Ling (1992), Eqn 2.3,
2.4, as shown in their Table 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Jtr(H, Q, a, b, f)

Jdet(H, Q, a, b, f)

COOKD(H, Q, n, p, r, m)

DFFITS(H, Q, n, p, r, m)

COVRATIO(H, Q, n, p, r, m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Jtr_+3A_h">H</code></td>
<td>
<p>a scalar or <code class="reqn">m \times m</code> matrix giving the hat values for subset <code class="reqn">I</code></p>
</td></tr>
<tr><td><code id="Jtr_+3A_q">Q</code></td>
<td>
<p>a scalar or <code class="reqn">m \times m</code> matrix giving the residual values for subset <code class="reqn">I</code></p>
</td></tr>
<tr><td><code id="Jtr_+3A_a">a</code></td>
<td>
<p>the <code class="reqn">a</code> parameter for the <code class="reqn">J^{det}</code> and <code class="reqn">J^{tr}</code> classes</p>
</td></tr>
<tr><td><code id="Jtr_+3A_b">b</code></td>
<td>
<p>the <code class="reqn">b</code> parameter for the <code class="reqn">J^{det}</code> and <code class="reqn">J^{tr}</code> classes</p>
</td></tr>
<tr><td><code id="Jtr_+3A_f">f</code></td>
<td>
<p>scaling factor for the <code class="reqn">J^{det}</code> and <code class="reqn">J^{tr}</code> classes</p>
</td></tr>
<tr><td><code id="Jtr_+3A_n">n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="Jtr_+3A_p">p</code></td>
<td>
<p>number of predictor variables</p>
</td></tr>
<tr><td><code id="Jtr_+3A_r">r</code></td>
<td>
<p>number of response variables</p>
</td></tr>
<tr><td><code id="Jtr_+3A_m">m</code></td>
<td>
<p>deletion subset size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two classes of functions, denoted <code class="reqn">J_I^{det}</code> and <code class="reqn">J_I^{tr}</code>,
with parameters <code class="reqn">n, p, q</code> of the data, <code class="reqn">m</code> of the subset size
and <code class="reqn">a</code> and <code class="reqn">b</code> which define powers of terms in the formulas, typically
in the set <code>-2, -1, 0</code>.
</p>
<p>They are defined in terms of the submatrices for a deleted index subset
<code class="reqn">I</code>,
</p>
<p style="text-align: center;"><code class="reqn">H_I = X_I (X^T X)^{-1} X_I</code>
</p>
 
<p style="text-align: center;"><code class="reqn">Q_I = E_I (E^T E)^{-1} E_I</code>
</p>

<p>corresponding to the hat and residual matrices in univariate models.
</p>
<p>For subset size <code class="reqn">m = 1</code> these evaluate to scalar equivalents of hat
values and studentized residuals.
</p>
<p>For subset size <code class="reqn">m &gt; 1</code> these are <code class="reqn">m \times m</code> matrices and
functions in the <code class="reqn">J^{det}</code> class use <code class="reqn">|H_I|</code> and <code class="reqn">|Q_I|</code>, while
those in the <code class="reqn">J^{tr}</code> class use <code class="reqn">tr(H_I)</code> and <code class="reqn">tr(Q_I)</code>.
</p>
<p>The functions <code>COOKD</code>, <code>COVRATIO</code>, and <code>DFFITS</code> implement
some of the standard influence measures in these terms for the general cases
of multivariate linear models and deletion of subsets of size <code>m&gt;1</code>,
but they have not yet been incorporated into our main functions
<code><a href="#topic+mlm.influence">mlm.influence</a></code> and <code><a href="#topic+influence.mlm">influence.mlm</a></code>.
</p>


<h3>Value</h3>

<p>The scalar result of the computation.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>

<hr>
<h2 id='lrPlot'>Regression LR Influence Plot</h2><span id='topic+lrPlot'></span><span id='topic+lrPlot.lm'></span>

<h3>Description</h3>

<p>This function creates a &ldquo;bubble&rdquo; plot of functions, R =
log(Studentized residuals^2) by L = log(H/p*(1-H)) of the hat values, with
the areas of the circles representing the observations proportional to
Cook's distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrPlot(model, ...)

## S3 method for class 'lm'
lrPlot(
  model,
  scale = 12,
  xlab = "log Leverage factor [log H/p*(1-H)]",
  ylab = "log (Studentized Residual^2)",
  xlim = NULL,
  ylim,
  labels,
  id.method = "noteworthy",
  id.n = if (id.method[1] == "identify") Inf else 0,
  id.cex = 1,
  id.col = palette()[1],
  ref = c("h", "v", "d", "c"),
  ref.col = "gray",
  ref.lty = 2,
  ref.lab = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lrPlot_+3A_model">model</code></td>
<td>
<p>a model object fit by <code>lm</code></p>
</td></tr>
<tr><td><code id="lrPlot_+3A_...">...</code></td>
<td>
<p>arguments to pass to the <code>plot</code> and <code>points</code>
functions.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_scale">scale</code></td>
<td>
<p>a factor to adjust the radii of the circles, in relation to <code>sqrt(CookD)</code></p>
</td></tr>
<tr><td><code id="lrPlot_+3A_xlab">xlab</code>, <code id="lrPlot_+3A_ylab">ylab</code></td>
<td>
<p>axis labels.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_xlim">xlim</code>, <code id="lrPlot_+3A_ylim">ylim</code></td>
<td>
<p>Limits for x and y axes. In the space of (L, R) very small
residuals typically extend the y axis enough to swamp the large residuals,
so the default for <code>ylim</code> is set to a range of 6 log units starting at
the maximum value.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_labels">labels</code>, <code id="lrPlot_+3A_id.method">id.method</code>, <code id="lrPlot_+3A_id.n">id.n</code>, <code id="lrPlot_+3A_id.cex">id.cex</code>, <code id="lrPlot_+3A_id.col">id.col</code></td>
<td>
<p>settings for labeling points; see
<code>link{showLabels}</code> for details. To omit point labeling, set
<code>id.n=0</code>, the default.  The default <code>id.method="noteworthy"</code> is
used in this function to indicate setting labels for points with large
Studentized residuals, hat-values or Cook's distances. See Details below.
Set <code>id.method="identify"</code> for interactive point identification.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_ref">ref</code></td>
<td>
<p>Options to draw reference lines, any one or more of <code>c("h", "v", "d", "c")</code>.
<code>"h"</code> and <code>"v"</code> draw horizontal and vertical
reference lines at noteworthy values of R and L respectively. <code>"d"</code>
draws equally spaced diagonal reference lines for contours of equal CookD.
<code>"c"</code> draws diagonal reference lines corresponding to approximate 0.95 and 0.99 contours of CookD.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_ref.col">ref.col</code>, <code id="lrPlot_+3A_ref.lty">ref.lty</code></td>
<td>
<p>Color and line type for reference lines.  Reference
lines for <code>"c" %in% ref</code> are handled separately.</p>
</td></tr>
<tr><td><code id="lrPlot_+3A_ref.lab">ref.lab</code></td>
<td>
<p>A logical, indicating whether the reference lines should be labeled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot, suggested by McCulloch &amp; Meeter (1983) has the attractive
property that contours of equal Cook's distance are diagonal lines with
slope = -1.  Various reference lines are drawn on the plot corresponding to
twice and three times the average hat value, a &ldquo;large&rdquo; squared
studentized residual and contours of Cook's distance.
</p>
<p>The <code>id.method="noteworthy"</code> setting also requires setting
<code>id.n&gt;0</code> to have any effect. Using <code>id.method="noteworthy"</code>, and
<code>id.n&gt;0</code>, the number of points labeled is the union of the largest
<code>id.n</code> values on each of L, R, and CookD.
</p>


<h3>Value</h3>

<p>If points are identified, returns a data frame with the hat values,
Studentized residuals and Cook's distance of the identified points.  If no
points are identified, nothing is returned.  This function is primarily used
for its side-effect of drawing a plot.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>A. J. Lawrence (1995). Deletion Influence and Masking in
Regression <em>Journal of the Royal Statistical Society. Series B
(Methodological)</em> , Vol. <b>57</b>, No. 1, pp. 181-189.
</p>
<p>McCulloch, C. E. &amp; Meeter, D. (1983). Discussion of &quot;Outliers...&quot; by R. J.
Beckman and R. D. Cook.  <em>Technometrics</em>, 25, 152-155.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influencePlot.mlm">influencePlot.mlm</a></code>
<code><a href="car.html#topic+influencePlot">influencePlot</a></code> in the <code>car</code> package for other methods
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# artificial example from Lawrence (1995)
x &lt;- c( 0, 0, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 18, 18 )
y &lt;- c( 0, 6, 6, 7, 6, 7, 6, 7, 6,  7,  6,  7,  7,  18 )
DF &lt;- data.frame(x,y, row.names=LETTERS[1:length(x)])
DF

with(DF, {
	plot(x,y, pch=16, cex=1.3)
	abline(lm(y~x), col="red", lwd=2)
	NB &lt;- c(1,2,13,14)
	text(x[NB],y[NB], LETTERS[NB], pos=c(4,4,2,2))
	}
)

mod &lt;- lm(y~x, data=DF)
# standard influence plot from car
influencePlot(mod, id.n=4)

# lrPlot version
lrPlot(mod, id.n=4)


library(car)
dmod &lt;- lm(prestige ~ income + education, data = Duncan)
influencePlot(dmod, id.n=3)
lrPlot(dmod, id.n=3)

</code></pre>

<hr>
<h2 id='mlm.influence'>Calculate Regression Deletion Diagnostics for Multivariate Linear Models</h2><span id='topic+mlm.influence'></span>

<h3>Description</h3>

<p><code>mlm.influence</code> is the main computational function in this package. It
is usually not called directly, but rather via its alias,
<code><a href="#topic+influence.mlm">influence.mlm</a></code>, the S3 method for a <code>mlm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlm.influence(model, do.coef = TRUE, m = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlm.influence_+3A_model">model</code></td>
<td>
<p>An <code>mlm</code> object, as returned by <code><a href="stats.html#topic+lm">lm</a></code> with a multivariate response.</p>
</td></tr>
<tr><td><code id="mlm.influence_+3A_do.coef">do.coef</code></td>
<td>
<p>logical. Should the coefficients be returned in the
<code>inflmlm</code> object?</p>
</td></tr>
<tr><td><code id="mlm.influence_+3A_m">m</code></td>
<td>
<p>Size of the subsets for deletion diagnostics</p>
</td></tr>
<tr><td><code id="mlm.influence_+3A_...">...</code></td>
<td>
<p>Further arguments passed to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The computations and methods for the <code>m=1</code> case are straight-forward,
as are the computations for the <code>m&gt;1</code> case.  Associated methods for
<code>m&gt;1</code> are still under development.
</p>


<h3>Value</h3>

<p><code>mlm.influence</code> returns an S3 object of class <code>inflmlm</code>, a
list with the following components: 
</p>
<table role = "presentation">
<tr><td><code>m</code></td>
<td>
<p>Deletion subset size</p>
</td></tr> 
<tr><td><code>H</code></td>
<td>
<p>Hat values, <code class="reqn">H_I</code>. If <code>m=1</code>, a vector of
diagonal entries of the &lsquo;hat&rsquo; matrix.  Otherwise, a list of <code class="reqn">m\times m</code> 
matrices corresponding to the <code>subsets</code>.</p>
</td></tr> 
<tr><td><code>Q</code></td>
<td>
<p>Residuals, <code class="reqn">Q_I</code>.</p>
</td></tr> 
<tr><td><code>CookD</code></td>
<td>
<p>Cook's distance values</p>
</td></tr> 
<tr><td><code>L</code></td>
<td>
<p>Leverage components</p>
</td></tr> 
<tr><td><code>R</code></td>
<td>
<p>Residual components</p>
</td></tr> 
<tr><td><code>subsets</code></td>
<td>
<p>Indices of the subsets</p>
</td></tr>
<tr><td><code>CookD</code></td>
<td>
<p>Cook's distance values</p>
</td></tr> 
<tr><td><code>L</code></td>
<td>
<p>Leverage components</p>
</td></tr> 
<tr><td><code>R</code></td>
<td>
<p>Residual components</p>
</td></tr> 
<tr><td><code>subsets</code></td>
<td>
<p>Indices of the observations in the subsets of size <code>m</code></p>
</td></tr> 
<tr><td><code>labels</code></td>
<td>
<p>Observation labels</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>Model call for the <code>mlm</code> object</p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>Deletion regression coefficients&ndash; included if<code>do.coef=TRUE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Barrett, B. E. and Ling, R. F. (1992). General Classes of
Influence Measures for Multivariate Regression. <em>Journal of the
American Statistical Association</em>, <b>87</b>(417), 184-191.
</p>
<p>Barrett, B. E. (2003). Understanding Influence in Multivariate Regression.
<em>Communications in Statistics &ndash; Theory and Methods</em>, <b>32</b>, 3,
667-680.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influencePlot.mlm">influencePlot.mlm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Rohwer2 &lt;- subset(Rohwer, subset=group==2)
rownames(Rohwer2)&lt;- 1:nrow(Rohwer2)
Rohwer.mod &lt;- lm(cbind(SAT, PPVT, Raven) ~ n+s+ns+na+ss, data=Rohwer2)
Rohwer.mod
influence(Rohwer.mod)

# extract the most influential cases
influence(Rohwer.mod) |&gt; 
    as.data.frame() |&gt; 
    dplyr::arrange(dplyr::desc(CookD)) |&gt; 
    head()

# Sake data
Sake.mod &lt;- lm(cbind(taste,smell) ~ ., data=Sake)
influence(Sake.mod) |&gt;
    as.data.frame() |&gt; 
    dplyr::arrange(dplyr::desc(CookD)) |&gt; head()


</code></pre>

<hr>
<h2 id='mpower'>General Matrix Power</h2><span id='topic+mpower'></span><span id='topic++25+5E+25'></span>

<h3>Description</h3>

<p>Calculates the <code>n</code>-th power of a square matrix, where <code>n</code> can be a
positive or negative integer or a fractional power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpower(A, n)

A %^% n
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mpower_+3A_a">A</code></td>
<td>
<p>A square matrix. Must also be symmetric for non-integer powers.</p>
</td></tr>
<tr><td><code id="mpower_+3A_n">n</code></td>
<td>
<p>matrix power</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>n&lt;0</code>, the method is applied to <code class="reqn">A^{-1}</code>. 
When <code>n</code> is an
integer, the function uses the Russian peasant method, or repeated squaring
for efficiency.  
Otherwise, it uses the spectral decomposition of <code>A</code>,
<code class="reqn">\mathbf{A}^n = \mathbf{V} \mathbf{D}^n \mathbf{V}^{T}</code>
requiring a symmetric matrix.
</p>


<h3>Value</h3>

<p>Returns the matrix <code class="reqn">A^n</code>
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Exponentiation_by_squaring">https://en.wikipedia.org/wiki/Exponentiation_by_squaring</a>
</p>


<h3>See Also</h3>

<p>Packages <span class="pkg">corpcor</span> and <span class="pkg">expm</span> define similar functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
M &lt;- matrix(sample(1:9), 3,3)
mpower(M,2)
mpower(M,4)

# make a symmetric matrix
MM &lt;- crossprod(M)
mpower(MM, -1)
Mhalf &lt;- mpower(MM, 1/2)
all.equal(MM, Mhalf %*% Mhalf)


</code></pre>

<hr>
<h2 id='print.inflmlm'>Print an inflmlm object</h2><span id='topic+print.inflmlm'></span>

<h3>Description</h3>

<p>Print an inflmlm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'inflmlm'
print(x, digits = max(3, getOption("digits") - 4), FUN = det, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.inflmlm_+3A_x">x</code></td>
<td>
<p>An <code>inflmlm</code> object</p>
</td></tr>
<tr><td><code id="print.inflmlm_+3A_digits">digits</code></td>
<td>
<p>Number of digits to print</p>
</td></tr>
<tr><td><code id="print.inflmlm_+3A_fun">FUN</code></td>
<td>
<p>Function to combine diagnostics when <code>m&gt;1</code>, one of <code>det</code> or <code>tr</code></p>
</td></tr>
<tr><td><code id="print.inflmlm_+3A_...">...</code></td>
<td>
<p>passed to <code>print()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the object
</p>


<h3>Examples</h3>

<pre><code class='language-R'># none

</code></pre>

<hr>
<h2 id='tr'>Matrix trace</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p>Calculates the trace of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tr_+3A_m">M</code></td>
<td>
<p>a matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For square, symmetric matrices, such as covariance matrices, the trace is sometimes
used as a measure of size, e.g., in Pillai's trace criterion for a MLM.
</p>


<h3>Value</h3>

<p>returns the sum of the diagonal elements of the matrix
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
M &lt;- matrix(sample(1:9), 3,3)
tr(M)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
