<!DOCTYPE html><html lang="en"><head><title>Help for package jcext</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jcext}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_date'><p>add_date</p></a></li>
<li><a href='#calculate_constant'><p>calculate_constant</p></a></li>
<li><a href='#calculate_cwt'><p>calculate_cwt</p></a></li>
<li><a href='#calculate_frequency'><p>calculate_frequency</p></a></li>
<li><a href='#classification_jc'><p>classification_jc</p></a></li>
<li><a href='#create_ncdfcwt'><p>create_ncdfcwt</p></a></li>
<li><a href='#createindex_ncdf'><p>createindex_ncdf</p></a></li>
<li><a href='#extended_jc'><p>extended_jc</p></a></li>
<li><a href='#get_div'><p>get_div</p></a></li>
<li><a href='#get_jcpoints'><p>get_jcpoints</p></a></li>
<li><a href='#getmat_cwt'><p>getmat_cwt</p></a></li>
<li><a href='#getname_hyb'><p>getname_hyb</p></a></li>
<li><a href='#isnot_validcp'><p>isnot_validcp</p></a></li>
<li><a href='#plot_freqmap_wtypes'><p>plot_freqmap_wtypes</p></a></li>
<li><a href='#plot_jcscheme'><p>Plot the classification scheme</p></a></li>
<li><a href='#press'><p>Mean Sea Level pressure files</p></a></li>
<li><a href='#read_ncdata'><p>read_ncdata</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extended Classification of Weather Types</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.3)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Noelia Otero</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Noelia Otero &lt;noeli1680@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a gridded classification of weather types by applying the Jenkinson and Collison classification. For a given region (it can be either local region or the whole map),it computes at each grid the 11 weather 
             types during the period considered for the analysis. See Otero et al., (2017) &lt;<a href="https://doi.org/10.1007%2Fs00382-017-3705-y">doi:10.1007/s00382-017-3705-y</a>&gt; for more information.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, stringr, RColorBrewer, graphics, grDevices, maps,
rworldmap, ggplot2, sp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ncdf4</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-02-24 15:04:36 UTC; notero</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-02-24 18:10:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_date'>add_date</h2><span id='topic+add_date'></span>

<h3>Description</h3>

<p>Adds dates in wich the weather types are obtained
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_date(f, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_date_+3A_f">f</code></td>
<td>
<p>Array with frequencies</p>
</td></tr>
<tr><td><code id="add_date_+3A_d">d</code></td>
<td>
<p>Array of dates</p>
</td></tr>
</table>

<hr>
<h2 id='calculate_constant'>calculate_constant</h2><span id='topic+calculate_constant'></span>

<h3>Description</h3>

<p>Calculates constants required to apply the rules
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_constant(lon, lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_constant_+3A_lon">lon</code></td>
<td>
<p>Numeric longitude of the central point</p>
</td></tr>
<tr><td><code id="calculate_constant_+3A_lat">lat</code></td>
<td>
<p>Numeric latitude of the central point</p>
</td></tr>
</table>

<hr>
<h2 id='calculate_cwt'>calculate_cwt</h2><span id='topic+calculate_cwt'></span>

<h3>Description</h3>

<p>Applies the rules to obtain the weather types.
(more details, see Jones et al. 1997)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_cwt(Z, TF, directionflow, G, thr = 6, Gth = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_cwt_+3A_z">Z</code></td>
<td>
<p>Data frame with the total shear vorticity and dates.</p>
</td></tr>
<tr><td><code id="calculate_cwt_+3A_tf">TF</code></td>
<td>
<p>Data frame with resultant flow and dates.</p>
</td></tr>
<tr><td><code id="calculate_cwt_+3A_directionflow">directionflow</code></td>
<td>
<p>Data frame with the direction of the flow and dates.</p>
</td></tr>
<tr><td><code id="calculate_cwt_+3A_g">G</code></td>
<td>
<p>Data frame with Gale days and dates.</p>
</td></tr>
<tr><td><code id="calculate_cwt_+3A_thr">thr</code></td>
<td>
<p>Numeric threshold used for Unclassified days.</p>
</td></tr>
<tr><td><code id="calculate_cwt_+3A_gth">Gth</code></td>
<td>
<p>Numeric threshold used for Gale days.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As defined in the original scheme, the threshold to determine unclassified days is 6.
Gale days are estimated by using a threshold of 30. If Gale days with a greater
intensity (e.g. 40 or 50) is wanted, Gth must be changed.
The airflow indices are used within the following rules
to define the appropriate Lamb weather types.
</p>

<ul>
<li><p>  The appropriate direction is calculated on an eight-point compass allowing 45° per sector.
</p>
</li>
<li><p>  If abs(Z) is less than TF, flow is essentially pure directional type.
</p>
</li>
<li><p>  If |Z| is greater than 2TF, then the pattern is strongly cyclonic (Z &gt; 0) or anticyclonic (Z &lt; 0).
</p>
</li>
<li><p>  If |Z| lies between TF and 2TF then the flow is partly (anti-) cyclonic and this corresponds to one
of Lamb’s synoptic/direction hybrid types, e.g. AE.
</p>
</li>
<li><p>  If TF is less than 6 and |Z| is less than 6, there is light indeterminate flow corresponding to Lamb’s
unclassified type U.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with two objects:
</p>

<ul>
<li><p> Total_CWT with five groups of weather types: LWT_D, LWT_C, LWT_CH, LWT_U and LWT_G
The main four groups contain the total of 27 weather types and the five list LWT_G refers to the gale days.
</p>

<ul>
<li><p> LWT_D:  8 directional types.
</p>
</li>
<li><p> LWT_C:  1 anticyclonic and  1 cyclonic.
</p>
</li>
<li><p> LWT_CH: 16 hybrid types.
</p>
</li>
<li><p> LWT_U: 1 unclassified type.
</p>
</li></ul>

</li>
<li><p> Logical values of daily occurrence of each type.
The user might want to use these values to get composites with specific atmospheric fields (e.g. pressure, temperature).
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+classification_jc">classification_jc</a></code>
</p>

<hr>
<h2 id='calculate_frequency'>calculate_frequency</h2><span id='topic+calculate_frequency'></span>

<h3>Description</h3>

<p>Computes the frequency of weather types, after dividing the
frequency of the hybrid types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_frequency(datalist, purelist, let)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_frequency_+3A_datalist">datalist</code></td>
<td>
<p>List with the hybrid types</p>
</td></tr>
<tr><td><code id="calculate_frequency_+3A_purelist">purelist</code></td>
<td>
<p>List with the rest of types</p>
</td></tr>
<tr><td><code id="calculate_frequency_+3A_let">let</code></td>
<td>
<p>String with the name of the type</p>
</td></tr>
</table>

<hr>
<h2 id='classification_jc'>classification_jc</h2><span id='topic+classification_jc'></span>

<h3>Description</h3>

<p>Calculates the classification of the main weather types
for one central point that is surrounded by 16-points (grid16). Wind-flow characteristics
are computed for the daily pressure field according to the rules proposed by the original
Jenkinson and Collison classification (see Jones et al. 1993, Jones et al. 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classification_jc(mslp, grid16, centralp, loni, lati, times, gale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="classification_jc_+3A_mslp">mslp</code></td>
<td>
<p>3-Dimensional multi-array ([loni,lati,time]) with mean sea level pressure in Pa.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_grid16">grid16</code></td>
<td>
<p>Data frame obtained in the main function (extended_jc) that contains the 16 grid-points defining the scheme.
First row is for longitudes, while the second row is for latitudes.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_centralp">centralp</code></td>
<td>
<p>Numeric that refers to the central point for which the JC classification is calculated.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_loni">loni</code></td>
<td>
<p>Array with longitude values.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_lati">lati</code></td>
<td>
<p>Array with latitude values.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_times">times</code></td>
<td>
<p>Array with the dates used.</p>
</td></tr>
<tr><td><code id="classification_jc_+3A_gale">gale</code></td>
<td>
<p>A logical for deteriming Gale days.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Daily frequencies of Weather Types and airflow indices.
</p>


<h3>References</h3>


<p>Jones, P. D., Hulme M., Briffa K. R. (1993)
<em>A comparison of Lamb circulation types with an objective classification scheme</em>
Int. J. Climatol. 13: 655–663.
</p>
<p>Jones, P. D., Harpham C, Briffa K. R. (2013)
<em>Lamb weather types derived from Reanalysis products</em>
Int. J. Climatol. 33: 1129–1139.

</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_cwt">calculate_cwt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
data(press)
mslp  &lt;- press$msl
loni  &lt;- press$loni
lati  &lt;- press$lati
times &lt;- press$dates
# Define a central point
centralp &lt;- c(10,50)
# Get the scheme for the  central point
grid16 &lt;- get_jcpoints(10,50)[1:16]
classification_jc(mslp, grid16, centralp, loni, lati, times, gale=FALSE)

</code></pre>

<hr>
<h2 id='create_ncdfcwt'>create_ncdfcwt</h2><span id='topic+create_ncdfcwt'></span>

<h3>Description</h3>

<p>Converts 3D arrays with daily frequencies of weather types to NETCDF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_ncdfcwt(cwt_out, times, centralp, onefile = TRUE, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_ncdfcwt_+3A_cwt_out">cwt_out</code></td>
<td>
<p>List with a list for each grid point that contains two objects: CWT and indices.</p>
</td></tr>
<tr><td><code id="create_ncdfcwt_+3A_times">times</code></td>
<td>
<p>Numeric with the dates.</p>
</td></tr>
<tr><td><code id="create_ncdfcwt_+3A_centralp">centralp</code></td>
<td>
<p>Numeric with the centralp obtained from the main program.</p>
</td></tr>
<tr><td><code id="create_ncdfcwt_+3A_onefile">onefile</code></td>
<td>
<p>Logical. If TRUE one single output file with all WT is created, if FALSE
one file per type is created.</p>
</td></tr>
<tr><td><code id="create_ncdfcwt_+3A_path">path</code></td>
<td>
<p>Path name to create the output file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A netcdf file with all weather types or one file per type.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createindex_ncdf">createindex_ncdf</a><a href="#topic+extended_jc">extended_jc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This is a long running example
cwtGlobal &lt;- extended_jc(press$msl, press$loni, press$lati, press$dates, gale=FALSE, num_cores=2)
# Create ncdf file (one file with all types)
create_ncdfcwt(cwtGlobal, press$dates, cwtGlobal$centralp, onefile = TRUE, path = NULL)


</code></pre>

<hr>
<h2 id='createindex_ncdf'>createindex_ncdf</h2><span id='topic+createindex_ncdf'></span>

<h3>Description</h3>

<p>Converts 3D arrays with daily values of airflow indices to NETCDF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createindex_ncdf(cwt_out, times, centralp, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createindex_ncdf_+3A_cwt_out">cwt_out</code></td>
<td>
<p>List with a list for each grid point that contains two objects $CWT and $indices.</p>
</td></tr>
<tr><td><code id="createindex_ncdf_+3A_times">times</code></td>
<td>
<p>Numeric with the dates.</p>
</td></tr>
<tr><td><code id="createindex_ncdf_+3A_centralp">centralp</code></td>
<td>
<p>Numeric with the centralp obtained from the main program.</p>
</td></tr>
<tr><td><code id="createindex_ncdf_+3A_path">path</code></td>
<td>
<p>Path name to create the output file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ncdf file with the airflow indices.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_ncdfcwt">create_ncdfcwt</a><a href="#topic+extended_jc">extended_jc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This is a long running example
cwtGlobal &lt;- extended_jc(press$msl, press$loni, press$lati, press$dates, gale=FALSE, num_cores=2)
# Create ncdf file (one file with all types)
createindex_ncdf(cwtGlobal, press$dates, cwtGlobal$centralp, path = NULL)


</code></pre>

<hr>
<h2 id='extended_jc'>extended_jc</h2><span id='topic+extended_jc'></span>

<h3>Description</h3>

<p>Gets daily classification of weather types
at every grid-point over the map or selected area of interest according
to the Jenkison and Collison scheme.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extended_jc(mslp, loni, lati, times, gale = FALSE, num_cores = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extended_jc_+3A_mslp">mslp</code></td>
<td>
<p>3-Dimensional array ([loni,lati,time]) with mean sea level pressure in Pa.</p>
</td></tr>
<tr><td><code id="extended_jc_+3A_loni">loni</code></td>
<td>
<p>Array with longitude values.</p>
</td></tr>
<tr><td><code id="extended_jc_+3A_lati">lati</code></td>
<td>
<p>Array with latitude values.</p>
</td></tr>
<tr><td><code id="extended_jc_+3A_times">times</code></td>
<td>
<p>Array with the dates used.</p>
</td></tr>
<tr><td><code id="extended_jc_+3A_gale">gale</code></td>
<td>
<p>Logial. If TRUE, the function returns also Gale days.</p>
</td></tr>
<tr><td><code id="extended_jc_+3A_num_cores">num_cores</code></td>
<td>
<p>Number of cores (2 by default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two objects:
</p>

<ul>
<li><p> A list of eleven matrix of daily frequencies of weather types (&quot;wtypes&quot;).
Each matrix is a 3D array [loni,lati,times] and it refers to each weather type (N,NE,E,SE,S,SW,W,A,C and U).
</p>
</li>
<li><p> A list of six matrix of daily frequency of airflow indices (&quot;indices&quot;).
Each matrix is a 3D array [loni,lati,times] and it refers to each airflow index (W,S,TF,ZW,ZS,Z and D).
</p>
</li>
<li><p> A list with the central points for which the classification is applied.
</p>
</li></ul>



<h3>References</h3>

<p>Otero, N., Sillmann, J. &amp; Butler, T.
<em>Assessment of an extended version of the Jenkinson–Collison classification on CMIP5 models over Europe</em>
Climate Dynamics. https://doi.org/10.1007/s00382-017-3705-y
</p>


<h3>See Also</h3>

<p><code><a href="#topic+classification_jc">classification_jc</a></code>
<code><a href="#topic+calculate_cwt">calculate_cwt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load data
data(press)
# Get coordinates
longitudes &lt;- press$loni
latitudes  &lt;- press$lati
times      &lt;- press$dates

# Example when the classification is restricted to an area
# Select longitudes and latitudes within the European domain: -10W,40E, 40N,70N
ilon  &lt;- which(longitudes&gt;(-10)&amp;longitudes&lt;40)
loni  &lt;- longitudes[ilon]
ilat  &lt;- which(latitudes&gt;40&amp;latitudes&lt;70)
lati  &lt;- latitudes[ilat]
cwtEU &lt;- extended_jc(press$msl[ilon,ilat,], loni, lati, times, gale=FALSE, num_cores=2)
 ## Not run: 
# Not run
# This is a long running example
# Get the classification for the whole map, all longitudes and latitudes
cwtGlobal &lt;- extended_jc(press$msl, longitudes, latitudes, times, gale=FALSE, num_cores=2)

## End(Not run)

</code></pre>

<hr>
<h2 id='get_div'>get_div</h2><span id='topic+get_div'></span>

<h3>Description</h3>

<p>Divides the frequency of the hybrid type according to the rules # TODO: which rules?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_div(fr, nam)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_div_+3A_fr">fr</code></td>
<td>
<p>Numeric with the frequency values</p>
</td></tr>
<tr><td><code id="get_div_+3A_nam">nam</code></td>
<td>
<p>String with the name of the weather type</p>
</td></tr>
</table>

<hr>
<h2 id='get_jcpoints'>get_jcpoints</h2><span id='topic+get_jcpoints'></span>

<h3>Description</h3>

<p>Computes the 16-grid points that determine the JC-scheme, based on the
coordinates of the central point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_jcpoints(lon, lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_jcpoints_+3A_lon">lon</code></td>
<td>
<p>Longitude of the central point.</p>
</td></tr>
<tr><td><code id="get_jcpoints_+3A_lat">lat</code></td>
<td>
<p>Latitude of the central point.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function excludes the poles and the equatorial areas between 25S-25N.
</p>


<h3>Value</h3>

<p>A data frame with the coordinates of the 16-grid points and the central point.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_jcscheme">plot_jcscheme</a></code>
</p>

<hr>
<h2 id='getmat_cwt'>getmat_cwt</h2><span id='topic+getmat_cwt'></span>

<h3>Description</h3>

<p>Puts in a matrix the resulting list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmat_cwt(cwt_out, centralp, times, out = c("CWT", "indices"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getmat_cwt_+3A_cwt_out">cwt_out</code></td>
<td>
<p>List with the frequencies of weather types and indices</p>
</td></tr>
<tr><td><code id="getmat_cwt_+3A_centralp">centralp</code></td>
<td>
<p>List with multiples central points</p>
</td></tr>
<tr><td><code id="getmat_cwt_+3A_times">times</code></td>
<td>
<p>Array with the dates</p>
</td></tr>
<tr><td><code id="getmat_cwt_+3A_out">out</code></td>
<td>
<p>String to select the output</p>
</td></tr>
</table>

<hr>
<h2 id='getname_hyb'>getname_hyb</h2><span id='topic+getname_hyb'></span>

<h3>Description</h3>

<p>Gets the name of the hybrid types to account for the rest of the types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getname_hyb(hybrid_div)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getname_hyb_+3A_hybrid_div">hybrid_div</code></td>
<td>
<p>List with the hybrid types</p>
</td></tr>
</table>

<hr>
<h2 id='isnot_validcp'>isnot_validcp</h2><span id='topic+isnot_validcp'></span>

<h3>Description</h3>

<p>Checks if the central point used is valid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isnot_validcp(grid16, loni, lati)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isnot_validcp_+3A_grid16">grid16</code></td>
<td>
<p>Data.frame with the 16-grid scheme</p>
</td></tr>
<tr><td><code id="isnot_validcp_+3A_loni">loni</code></td>
<td>
<p>Array with longitudes</p>
</td></tr>
<tr><td><code id="isnot_validcp_+3A_lati">lati</code></td>
<td>
<p>Array with latitudes</p>
</td></tr>
</table>

<hr>
<h2 id='plot_freqmap_wtypes'>plot_freqmap_wtypes</h2><span id='topic+plot_freqmap_wtypes'></span>

<h3>Description</h3>

<p>Visualises absolute frequencies of the 11 main types from
the extended_jc over the period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_freqmap_wtypes(mat, loni, lati, all.types = TRUE, mytype = NULL,
  center = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_freqmap_wtypes_+3A_mat">mat</code></td>
<td>
<p>Matrix output from extended_jc [loni,lati,time]</p>
</td></tr>
<tr><td><code id="plot_freqmap_wtypes_+3A_loni">loni</code></td>
<td>
<p>Vector with longitude values must be -180, 180</p>
</td></tr>
<tr><td><code id="plot_freqmap_wtypes_+3A_lati">lati</code></td>
<td>
<p>Latitude values</p>
</td></tr>
<tr><td><code id="plot_freqmap_wtypes_+3A_all.types">all.types</code></td>
<td>
<p>Logical. If TRUE all weather types are plotted in the same plot</p>
</td></tr>
<tr><td><code id="plot_freqmap_wtypes_+3A_mytype">mytype</code></td>
<td>
<p>Character with the name of the weather type wanted (i.g. N,NE,E,SE,S,SW,W,A,C and U)</p>
</td></tr>
<tr><td><code id="plot_freqmap_wtypes_+3A_center">center</code></td>
<td>
<p>Logical. If TRUE a center map is plotted</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 map
</p>


<h3>See Also</h3>

<p><code><a href="#topic+extended_jc">extended_jc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jcext)
# This is a long running example for plotting results for all types globally
cwtGlobal &lt;- extended_jc(press$msl, press$loni,press$lati, press$dates, gale=FALSE, num_cores=2)
wtypesGlobal &lt;- cwtGlobal$wtypes
plot_freqmap_wtypes(wtypesGlobal,press$loni, press$lati, all.types = TRUE,mytype = NULL ,center = T)
# Plot the global results only for one type
plot_freqmap_wtypes(wtypesGlobal,press$loni, press$lati, all.types = FALSE,mytype = "C" ,center = T)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot_jcscheme'>Plot the classification scheme</h2><span id='topic+plot_jcscheme'></span>

<h3>Description</h3>

<p>Visualises the original Jenkinson &amp; Collison scheme
for one given central point surrounded by the 16-points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_jcscheme(centralp, loni, lati, fullmap = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_jcscheme_+3A_centralp">centralp</code></td>
<td>
<p>Array with the central point (lonigutde, latitude).</p>
</td></tr>
<tr><td><code id="plot_jcscheme_+3A_loni">loni</code></td>
<td>
<p>Array with longitude values.</p>
</td></tr>
<tr><td><code id="plot_jcscheme_+3A_lati">lati</code></td>
<td>
<p>Array with latitude values.</p>
</td></tr>
<tr><td><code id="plot_jcscheme_+3A_fullmap">fullmap</code></td>
<td>
<p>Logical. If TRUE a fullmap is plotted, if FALSE, only the region selected is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The map shows the scheme over the whole map,
or either it shows the scheme over the selected region. For that, the maximum and mininum
coordinates are defined as:
Maximum longitude, by default defined by the points: x6, x10 or 14.
Minimum longitude, by default defined by the points: x3, x7 or 11.
Maximum latitude, by default defined by the points: x1 or x2.
Minimum latitude, by default defined by the points: x15 or 16.
</p>


<h3>Value</h3>

<p>A plot device
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_jcpoints">get_jcpoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Visualise the scheme for one point
library(jcext)
# Define a central point
mycentral &lt;- c(10,50)
# load the data to get coordinates
data(press)
# Visualise the whole map
plot_jcscheme(mycentral,press$loni,press$lati,fullmap=TRUE)
# Visualise the region
plot_jcscheme(mycentral,press$loni,press$lati,fullmap=FALSE)
</code></pre>

<hr>
<h2 id='press'>Mean Sea Level pressure files</h2><span id='topic+press'></span>

<h3>Description</h3>

<p>Data from a ERA-Interim reanalysis data set downloaded from ECMWF
(<a href="http://apps.ecmwf.int/datasets/data/interim-full-daily/levtype=sfc/">http://apps.ecmwf.int/datasets/data/interim-full-daily/levtype=sfc/</a>).
This data corresponds to global daily values of mean sea level pressure with 2.5 x 2.5 resolution for January 2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(press)
</code></pre>


<h3>Format</h3>

<p>A list with values of pressure and coordinates (longitude, latitude, time)
</p>

<dl>
<dt>msl</dt><dd><p>mean sea level pressure values, &quot;Pa&quot;</p>
</dd>
<dt>longitude</dt><dd><p>144</p>
</dd>
<dt>latitude</dt><dd><p>73</p>
</dd>
<dt>times</dt><dd><p>366, one year (2000)</p>
</dd>
</dl>


<h3>References</h3>

<p>Dee et al. (2011)
<em>The ERA-Interim reanalysis: configuration and performance of the data assimilation system.
Q.J.R. Meteorol. Soc., 137: 553–597. doi:10.1002/qj.828</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(press)
mslp  &lt;- press$msl
loni  &lt;- press$loni
lati  &lt;- press$lati
times &lt;- press$dates

</code></pre>

<hr>
<h2 id='read_ncdata'>read_ncdata</h2><span id='topic+read_ncdata'></span>

<h3>Description</h3>

<p>Reads a ncdf input file to extract the input for the classification:
pressure field, longitudes, latitudes and dates.
Absolute time is required to read the dates properly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ncdata(ncinput, nam_coor, units)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_ncdata_+3A_ncinput">ncinput</code></td>
<td>
<p>A NETCDF file with pressure field.</p>
</td></tr>
<tr><td><code id="read_ncdata_+3A_nam_coor">nam_coor</code></td>
<td>
<p>Names of space and time coordinates</p>
</td></tr>
<tr><td><code id="read_ncdata_+3A_units">units</code></td>
<td>
<p>Units required (Pa or hPa).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>

<ul>
<li><p> A 3D-array of mean sea level (or pressure field) as [lon,lat,times]. The units returned as hPa.
</p>
</li>
<li><p> A numeric with longitudes values.
</p>
</li>
<li><p> A numeric with latitudes values.
</p>
</li>
<li><p> A numeric with dates values.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
