<!DOCTYPE html><html><head><title>Help for package cardidates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cardidates}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aweibull7'><p>Six-Parametric Weibull Function with Additive Shift</p></a></li>
<li><a href='#cardidates-package'>
<p>Identification of Cardinal Dates in Ecological Time Series</p></a></li>
<li><a href='#carditest'><p>Artificial Data Set: 3 Years of Phytoplankton</p></a></li>
<li><a href='#CDW'><p>Cardinal Dates Using Fitted Weibull Curves</p></a></li>
<li><a href='#fitweibull'><p>Fit Four or Six Parametric Weibull Functions</p></a></li>
<li><a href='#merge.cardiMetacdw'>
<p>Merge Two Objects of Class 'cardiMetacdw'</p></a></li>
<li><a href='#metaCDW'><p>Extract Cardinal Dates of Multiple Time Series at Once Using Fitted Weibull Curves</p></a></li>
<li><a href='#peakwindow'><p>Identify Peaks in Time Series</p></a></li>
<li><a href='#plot.cardiFit'><p>Plot Method for cardiFit Objects</p></a></li>
<li><a href='#plot.cardiMetacdw'><p>Plot Method for cardiPeakwindow Objects</p></a></li>
<li><a href='#plot.cardiPeakwindow'><p>Plot Method for cardiPeakwindow Objects</p></a></li>
<li><a href='#summary.cardiFit'><p>Summary Method for cardiFit Objects</p></a></li>
<li><a href='#weibull4'><p>Four-Parametric Weibull Function</p></a></li>
<li><a href='#weibull6'><p>Six-Parametric Weibull Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Identification of Cardinal Dates in Ecological Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.9</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2), boot, pastecs, lattice</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, methods, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Susanne Rolinski [aut],
  René Sachse [aut],
  Thomas Petzoldt [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Petzoldt &lt;thomas.petzoldt@tu-dresden.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Identification of cardinal dates
             (begin, time of maximum, end of mass developments)
             in ecological time series using fitted Weibull functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://cardidates.r-forge.r-project.org">http://cardidates.r-forge.r-project.org</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-07 16:59:41 UTC; thpe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-07 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aweibull7'>Six-Parametric Weibull Function with Additive Shift</h2><span id='topic+aweibull7'></span><span id='topic+fweibull7'></span>

<h3>Description</h3>

<p>A special version of the six-parametric Weibull function
which has a 7th parameter for additive vertical shifting.
It is intended mainly for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fweibull7(x, p)

aweibull7(p, lower = 0, upper = 365)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aweibull7_+3A_x">x</code></td>
<td>
<p>vector of function arguments</p>
</td></tr>
<tr><td><code id="aweibull7_+3A_p">p</code></td>
<td>
<p>vector of function parameters, see <code><a href="#topic+weibull6">weibull6</a></code> for
an explanation of parameters <code>p[1]</code> ... <code>p[6]</code>;
<code>p[7]</code> is an additive constant.</p>
</td></tr>
<tr><td><code id="aweibull7_+3A_lower">lower</code></td>
<td>
<p>lower limit of the cumulative (integrated) function,</p>
</td></tr>
<tr><td><code id="aweibull7_+3A_upper">upper</code></td>
<td>
<p>upper limit of the cumulative (integrated) function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is intended for
internal use, i.e. for separate area calculations of the left and right branches.
</p>


<h3>Value</h3>

<p><code>fweibull7</code> gives the function and <code>aweibull7</code> its definite
integral (cumulative function or area under curve). Note that
integration is done numerically and that the function returns a
scalar, not a vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+CDW">CDW</a></code>,
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>

<hr>
<h2 id='cardidates-package'>
Identification of Cardinal Dates in Ecological Time Series
</h2><span id='topic+cardidates-package'></span><span id='topic+cardidates'></span>

<h3>Description</h3>

<p>Identification of cardinal dates
             (begin, time of maximum, end of mass developments)
             in ecological time series using fitted Weibull functions.
</p>


<h3>Details</h3>

<p>Phenology and seasonal succession in aquatic ecosystems are strongly
dependent on physical factors. In order to promote investigations
into this coupling, objective and relible methods of characterising
annual time series are important.
</p>
<p>The proposed methods were developed within the AQUASHIFT research program
and used to determine the beginning, maximum
and end of the spring mass development of phytoplankton in different lakes
and water reservoirs. These time points, which we call &ldquo;cardinal dates&rdquo;,
can be analysed for temporal trends and relationships to climate variables.
</p>
<p>The complete methodology is described in Rolinski et. al (2007).
Until now we implemented only the most reliable approach using Weibull-Functions
(Method B in the article), other algorithms may follow when required.
</p>
<p>The methodology may also be useful for other ecological time series
(e.g. small mammals or insects). Please don't hesitate to contact the package maintainer
if you feel that this package should be generalized to other processes.
</p>


<h3>Author(s)</h3>

<p>Susanne Rolinski (original algorithm),
Thomas Petzoldt and René Sachse (package and documentation).
</p>
<p>Maintainer: Thomas Petzoldt &lt;thomas.petzoldt@tu-dresden.de&gt;
</p>


<h3>References</h3>

<p>Rolinski, S., Horn, H., Petzoldt, T. &amp; Paul, L. (2007): Identification of cardinal
dates in phytoplankton time series to enable the analysis of long-term trends.
Oecologia <b>153</b>, 997 - 1008. <a href="https://doi.org/10.1007/s00442-007-0783-2">doi:10.1007/s00442-007-0783-2</a>.
</p>
<p>Wagner, A., Hülsmann, S., Paul, L., Paul, R. J., Petzoldt, T.,
Sachse, R., Schiller, T., Zeis, B., Benndorf, J. &amp; Berendonk, T. U. (2012):
A phenomenological approach shows a high coherence of warming patterns in
dimictic aquatic systems across latitude. Marine Biology <b>159</b>(11),
2543-2559, <a href="https://doi.org/10.1007/s00227-012-1934-5">doi:10.1007/s00227-012-1934-5</a>.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+CDW">CDW</a></code>,
<code><a href="#topic+metaCDW">metaCDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>########## quick start for the impatient ###############
## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)
plot(res)
summary(res)

################## more details #########################

## show some properties
res$r2
p &lt;- res$p
o &lt;- res$fit
f &lt;- res$ymax

## identify cardinal dates from fitted curves
(smd  &lt;- CDW(p))
(smda &lt;- CDW(p, symmetric = FALSE))

## plot data, curve and cardinal dates
plot(x, y, ylim = c(0, 10), xlim = c(0, 365))
lines(o$x, o$f * f)
points(x, fweibull6(x, p) * f, col = "green")
points(smd$x, smd$y * f, col = "orange", pch = 16)

## or, alternatively:
points(smda$x, fweibull6(smda$x, p) * f, col = "red", pch = 1, cex = 1.2)

## for comparison: fit of a 4 parameter Weibull
res4  &lt;- fitweibull4(x, y)
res4$r2
p &lt;- res4$p
o &lt;- res4$fit
f &lt;- res4$ymax
smd  &lt;- CDW(p)
lines(o$x, o$f * f, col = "blue")
points(smd$x, fweibull4(smd$x, p) * f, col = "blue", pch = 16)

</code></pre>

<hr>
<h2 id='carditest'>Artificial Data Set: 3 Years of Phytoplankton</h2><span id='topic+carditest'></span>

<h3>Description</h3>

<p>The data contains 3 years of an artificial phytoplankton data set
which conforms to the <code><a href="#topic+metaCDW">metaCDW</a></code> data structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(carditest)
</code></pre>


<h3>Format</h3>

<p>A data frame with the following 4 columns:
</p>

<dl>
<dt><code>sample</code></dt><dd><p>time code</p>
</dd>
<dt><code>x</code></dt><dd><p>day of year (interval 0 ... 365)</p>
</dd>
<dt><code>y</code></dt><dd><p>observed biovolume, abundance etc.</p>
</dd>
<dt><code>flag</code></dt><dd><p>validity flag to switch single data records on 
(<code>TRUE</code>) or off (<code>FALSE</code>), defaults to <code>TRUE</code></p>
</dd>
</dl>
  


<h3>See Also</h3>

<p><code><a href="#topic+metaCDW">metaCDW</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(carditest)
head(carditest)
#View(carditest)
</code></pre>

<hr>
<h2 id='CDW'>Cardinal Dates Using Fitted Weibull Curves</h2><span id='topic+CDW'></span><span id='topic+CDWa'></span>

<h3>Description</h3>

<p>CDW (cardinal dates using Weibull curves) extracts &ldquo;cardinal dates&rdquo; from
fitted four- and six-parametric Weibull curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDW(p, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE)

CDWa(p, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDW_+3A_p">p</code></td>
<td>
<p>object of class <code>cardiFit</code> returned by <code><a href="#topic+fitweibull6">fitweibull6</a></code> or
<code><a href="#topic+fitweibull4">fitweibull4</a></code> or parameter vector of the fitted Weibull function,</p>
</td></tr>
<tr><td><code id="CDW_+3A_xmin">xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="CDW_+3A_xmax">xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="CDW_+3A_quantile">quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td></tr>
<tr><td><code id="CDW_+3A_symmetric">symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CDW</code> is a numerically improved version of the algorithm
described in Rolinski et al. (2007). Version <code>CDWa</code> is an alternative,
simplified version which sets the baseline before and after the peak to zero
using appropriate offset parameters <code>p[1]</code> and <code>p[4]</code>. 
The original method described by Rolinski et al. 2007 (here called <code>CDW</code>)
shifts the function for the left and right branch separately
in the asymmetric case.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>x values of cardinal dates <code>tMid</code>, <code>tBegin</code>, <code>tEnd</code>,</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the corresponding y values (divided by ymax),</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>parameters of the fitted Weibull function</p>
</td></tr>
</table>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,

<code><a href="#topic+metaCDW">metaCDW</a></code>,
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## show some properties
res$r2
p &lt;- res$p
o &lt;- res$fit
f &lt;- res$ymax

## identify cardinal dates from fitted curves
(smd  &lt;- CDW(p))
(smda &lt;- CDW(p, symmetric = FALSE))

## plot data, curve and cardinal dates
plot(x, y, ylim=c(0, 10), xlim = c(0, 365))
lines(o$x, o$f * f)
points(x, fweibull6(x, p) * f, col = "green")
points(smd$x, fweibull6(smd$x, p) * f, col = "orange", pch = 16)
points(smda$x, fweibull6(smda$x, p) * f, col = "red", pch = 1, cex = 1.2)

## for comparison: additional fit of a 4 parameter Weibull
res4  &lt;- fitweibull4(x, y)
res4$r2
p &lt;- res4$p
o &lt;- res4$fit
f &lt;- res4$ymax
smd  &lt;- CDW(p)
lines(o$x, o$f * f, col = "blue")
points(smd$x, fweibull4(smd$x, p) * f, col = "blue", pch = 16)
</code></pre>

<hr>
<h2 id='fitweibull'>Fit Four or Six Parametric Weibull Functions</h2><span id='topic+fitweibull'></span><span id='topic+fitweibull6'></span><span id='topic+fitweibull4'></span>

<h3>Description</h3>

<p>Fit a four- or six-parametric Weibull function to environmental data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitweibull6(x, y = NULL, p0 = NULL, linint = -1, maxit = 2000)

fitweibull4(x, y = NULL, p0 = c(0.1, 50, 5, 100), linint = -1, maxit = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitweibull_+3A_x">x</code>, <code id="fitweibull_+3A_y">y</code></td>
<td>
<p>the x (in day of year) and y coordinates of a set of points.
Alternatively, a single argument x can be provided.</p>
</td></tr>
<tr><td><code id="fitweibull_+3A_p0">p0</code></td>
<td>
<p>initial parameters for optimization. In case of <code>p0 = NA</code>
a heuristic algorithm to derive initial values is used for <code>fitweibull6</code>.</p>
</td></tr>
<tr><td><code id="fitweibull_+3A_linint">linint</code></td>
<td>
<p>control parameter to select interpolation behavior.
Negative values (default) specify automatic selection heuristic,
zero disables interpolation. A positive value is interpreted as mandatory
interpolation time step.</p>
</td></tr>
<tr><td><code id="fitweibull_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations passed to the optimisation functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>fitweibull6</code> uses extensive heuristics to derive initial parameters
for the optimization. It is intended to work with data which are defined over an
interval between 0 and 365, e.g. environmental data and
especially for plankton blooms.
Please note that the function does internal transformation:
</p>
<p style="text-align: center;"><code class="reqn">y_{rel} = y_i / y_{max}</code>
</p>

<p>Note that additional data points are inserted between original measurements
by linear interpolation with time step = 1 before curve fitting if the number
of original data points is too low (currently n &lt; 35).
You can set <code>linint = 0</code> to switch interpolation off.
</p>
<p><code>fitweibull4</code> has only built-in heuristics for data interpolation but not
for guessing initial parameters which must be supplied as
vector <code>p0</code> in the call.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>vector of fitted parameters,</p>
</td></tr>
<tr><td><code>ymax</code></td>
<td>
<p>maximum y value used for transformation,</p>
</td></tr>
<tr><td><code>r2</code></td>
<td>
<p>coefficient of determination between transformed and fitted y values,</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>data frame with the following columns:
</p>

<ul>
<li><p><code>x</code>~data (original or interpolated) used for curve fitting,
</p>
</li>
<li><p><code>y</code>~data (transformed-original or interpolated) used for curve fitting,
</p>
</li>
<li><p><code>f</code>~estimated function values.
</p>
</li></ul>

</td></tr>
</table>


<h3>Note</h3>

<p>Note that the heuristics works optimal if unnecessary leading and trailing
data are removed before the call.
</p>


<h3>Author(s)</h3>

<p>Susanne Rolinski (original algorithm) and Thomas Petzoldt (package).
</p>
<p>Maintainer: Thomas Petzoldt &lt;thomas.petzoldt@tu-dresden.de&gt;
</p>


<h3>References</h3>

<p>Rolinski, S., Horn, H., Petzoldt, T., &amp; Paul, L. (2007): Identification of cardinal
dates in phytoplankton time series to enable the analysis of long-term trends.
Oecologia <b>153</b>, 997 - 1008, <a href="https://doi.org/10.1007/s00442-007-0783-2">doi:10.1007/s00442-007-0783-2</a>.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,

<code><a href="#topic+CDW">CDW</a></code>
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## show some properties
res$r2
p &lt;- res$p
o &lt;- res$fit
f &lt;- res$ymax

## fit 6 parameter Weibull with user-provided start parameters

x &lt;- seq(0, 150)
y &lt;- fweibull6(x, c(0.8, 40, 5, 0.2, 80, 5)) + rnorm(x, sd = 0.1)
plot(x, y)
res &lt;- fitweibull6(x, y, p0 = c(0, 40, 1, 1, 60, 0))
plot(res)
</code></pre>

<hr>
<h2 id='merge.cardiMetacdw'>
Merge Two Objects of Class 'cardiMetacdw'
</h2><span id='topic+merge.cardiMetacdw'></span>

<h3>Description</h3>

<p>This is a helper function that can be used to replace or add manually fitted
cardidates objects to a set of cardidates objects fitted by metaCDW.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cardiMetacdw'
merge(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge.cardiMetacdw_+3A_x">x</code></td>
<td>

<p>the result of a call to metaCDW,
</p>
</td></tr>
<tr><td><code id="merge.cardiMetacdw_+3A_y">y</code></td>
<td>

<p>a second object resulting from a call to metaCDW, but which contains one 
sample only.
</p>
</td></tr>
<tr><td><code id="merge.cardiMetacdw_+3A_...">...</code></td>
<td>

<p>not implemented, reserved for future extensions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a helper function that can be used to add additional fits to an 
existing object or to replace single fits of a <code>metaCSW</code> object. 
Though the function is intended for fine-tuning of problematic samples
it should not be abused for invalidating the general principles of
objectivity and reproducibility.
</p>


<h3>Value</h3>

<p>An object of class 'cardiMetacdw', i.e. a Weibull fit. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+metaCDW">metaCDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## artificial test data
data(carditest)

## identify all first peaks
fit &lt;- metaCDW(carditest)

## plot it
plot(fit, carditest)

## detect second peak for 'Year2'
sample2 &lt;- subset(carditest, sample == "Year 2")
sample2$sample &lt;- factor(sample2$sample) # drop unused levels
fit2 &lt;- metaCDW(sample2, xstart=150)

## merge results
merged.fit &lt;- merge(fit, fit2)
plot(merged.fit, carditest)
</code></pre>

<hr>
<h2 id='metaCDW'>Extract Cardinal Dates of Multiple Time Series at Once Using Fitted Weibull Curves</h2><span id='topic+metaCDW'></span><span id='topic+summary.cardiMetacdw'></span>

<h3>Description</h3>

<p><code>metaCDW</code> determines the relevant peak of 
several time series and fits four- resp. six-parametric 
Weibull curves to these peaks of all series at once and extracts &ldquo;cardinal dates&rdquo; from
the fitted curves. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metaCDW(dat, method = "weibull6", xstart = 55, xmin = 0, xmax = 365, 
        minpeak = 0.1, mincut = 0.382,
        quantile = 0.05, symmetric = FALSE, p0 = NULL, linint = -1, 
        findpeak = TRUE, maxit = 2000)
## S3 method for class 'cardiMetacdw'
summary(object, file="", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metaCDW_+3A_dat">dat</code></td>
<td>
<p>a <code>data.frame</code> containig the columns: 
<code>sample</code> (description of the timeseries such as year, water body, or any 
other code (should be numeric or factor),
<code>x</code> (the independend variable, e.g. Julian day of the year),
<code>y</code> (the dependend variable, e.g. phytoplankton biovolume)
and an optional column <code>flag</code> (of type <code>boolean</code> indicating whether
a data point should be included in analysis),</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_method">method</code></td>
<td>
<p>either &quot;weibull6&quot; or &quot;weibull4&quot;,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_xstart">xstart</code></td>
<td>
<p>offset (day of year) for the &quot;spring&quot; peak; either a single 
numeric value for all years or a vector of the same length as number of samples,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_xmin">xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_xmax">xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_quantile">quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum value of the total maximum which is regarded as peak
(default value is derived from golden section),</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_mincut">mincut</code></td>
<td>
<p>minimum relative height of a pit compared to the lower of the
two neighbouring maxima at which these maxima are regarded as separate peaks.</p>
</td></tr>       
<tr><td><code id="metaCDW_+3A_symmetric">symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately.</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_p0">p0</code></td>
<td>
<p>initial parameters for optimization. In case of <code>p0 = NULL</code>
a heuristic algorithm to derive initial values is used for <code>fitweibull6</code>,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_linint">linint</code></td>
<td>
<p>control parameter to select interpolation behavior.
Negative values (default) specify automatic selection heuristic,
zero disables interpolation. A positive value is interpreted as mandatory
interpolation time step.</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations passed to the optimisation functions,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_findpeak">findpeak</code></td>
<td>
<p>a logical value indicating whether the relevant peaks of the time series
should be identified automatically with <code><a href="#topic+peakwindow">peakwindow</a></code> 
before the computation proceeds,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_object">object</code></td>
<td>
<p>a result from a call to <code><a href="#topic+metaCDW">metaCDW</a></code>,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_file">file</code></td>
<td>
<p>file name where the data are to be written to, defaults to screen,</p>
</td></tr>
<tr><td><code id="metaCDW_+3A_...">...</code></td>
<td>
<p>other parameters of <code>summary</code> passed to <code>write</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a top-level function which calls <code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code> and
<code><a href="#topic+CDW">CDW</a></code> for a series of data sets and returns
a table (<code>data frame</code>) of all results.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>metares</code></td>
<td>
<p>data frame with cardinal dates and fitted parameters, 
see  <code><a href="#topic+CDW">CDW</a></code> for details,</p>
</td></tr>
<tr><td><code>weibullfits</code></td>
<td>
<p>list of fit details for all fits, 
see <code><a href="#topic+fitweibull">fitweibull</a></code> for details.</p>
</td></tr>
</table>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+CDW">CDW</a></code>,

<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## open test data set (3 years) with 4 columns
## sample, x, y, flag
data(carditest)
dat &lt;- carditest

## alternatively: import data from spreadsheet via the clipboard
# dat &lt;- read.table("clipboard", sep = "\t", header = TRUE)

## or, for languages with comma as decimal separator:
# dat &lt;- read.table("clipboard", sep = "\t", header = TRUE, dec = ",")

## Note: as.numeric recodes factor year to numeric value
plot(as.numeric(dat$sample)*365 + dat$x, dat$y, type = "b")

## do the analysis
tt &lt;- metaCDW(dat, xstart = 55)

## plot results
par(mfrow=c(1, 3))
lapply(tt$weibullfits, plot)

## return table of results
summary(tt)

## Not run: 
## copy to clipboard in spreadsheet compatible format
summary(tt, file = "clipboard", sep = "\t", quote = FALSE, row.names = FALSE)

## or, for languages with comma as decimal separator:
#summary(tt, file = "clipboard", sep = "\t", dec = ",",
#  quote = FALSE, row.names = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='peakwindow'>Identify Peaks in Time Series</h2><span id='topic+peakwindow'></span>

<h3>Description</h3>

<p>This function identifies peaks in time series and helps to identify the time window of
the first maximum according to given rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peakwindow(x, y = NULL, xstart = 0, xmax = max(x), minpeak = 0.1, mincut = 0.382)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peakwindow_+3A_x">x</code>, <code id="peakwindow_+3A_y">y</code></td>
<td>
<p>the x (in day of year) and y coordinates of a set of points.
Alternatively, a single argument x can be provided.</p>
</td></tr>
<tr><td><code id="peakwindow_+3A_xstart">xstart</code></td>
<td>
<p>x value (e.g. time of ice-out) before the maximum value
of the searched peak (this is a &ldquo;weak&rdquo; limit),</p>
</td></tr>
<tr><td><code id="peakwindow_+3A_xmax">xmax</code></td>
<td>
<p>maximum of the end of the searched peak (this is a &ldquo;hard&rdquo; maximum,</p>
</td></tr>
<tr><td><code id="peakwindow_+3A_minpeak">minpeak</code></td>
<td>
<p>minimum value of the total maximum which is regarded as peak,</p>
</td></tr>
<tr><td><code id="peakwindow_+3A_mincut">mincut</code></td>
<td>
<p>minimum relative height of a pit compared to the lower of the
two neighbouring maxima at which these maxima are regarded as separate peaks
(default value is derived from golden section).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a heuristic peak detection algorithm. It can be used for two related
purposes, (i) to identify all relevant peaks within a time-series and (ii)
to identify the time window which belongs to one single peak (smd = specified mass 
development, e.g. spring maximum in phytoplankton time series).
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>peaks</code></td>
<td>
<p>a data frame with the characteristics (index, xleft, x, xright and y)
of all identified peaks,</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the original data set (<code>x</code>, <code>y</code>),</p>
</td></tr>
<tr><td><code>smd.max.index</code></td>
<td>
<p>index of the maximum value of the &ldquo;specified&rdquo; peak,</p>
</td></tr>
<tr><td><code>smd.max.x</code></td>
<td>
<p>x-value of the maximum of the &ldquo;specified&rdquo; peak,</p>
</td></tr>
<tr><td><code>smd.indices</code></td>
<td>
<p>indices (data window) of all data belonging to the &ldquo;specified&rdquo; peak,</p>
</td></tr>
<tr><td><code>smd.x</code></td>
<td>
<p>x-values (time window) of all data belonging to the &ldquo;specified&rdquo; peak,</p>
</td></tr>
<tr><td><code>smd.y</code></td>
<td>
<p>corresponding y-values of all data belonging to the &ldquo;specified&rdquo; peak,</p>
</td></tr>
<tr><td><code>peakid</code></td>
<td>
<p>vector with peak-id-numbers for all data.</p>
</td></tr>
</table>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+CDW">CDW</a></code>
<code><a href="#topic+plot.cardiPeakwindow">plot.cardiPeakwindow</a></code>
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate test data with 3 peaks
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)
y &lt;- c(y, 0.8 * y, 1.2 * y)
x &lt;- seq(0, 360, along = y)
y[6] &lt;- y[7]   # test case with 2 neighbouring equal points

## plot the test data
plot(x, y, type="b")

## identify the "spring mass development"
peaks &lt;- peakwindow(x, y)
ind &lt;- peaks$smd.indices
lines(x[ind], y[ind], col="red", lwd=2)

## now fit the cardinal dates
fit &lt;- fitweibull6(peaks$smd.x, peaks$smd.y)
CDW(fit)
plot(fit)

## some more options ...
peaks &lt;- peakwindow(x, y, xstart=150, mincut = 0.455)
ind &lt;- peaks$smd.indices
lines(x[ind], y[ind], col = "blue")
points(x, y, col = peaks$peakid +1, pch = 16) # all peaks

## work with indices only
peaks &lt;- peakwindow(y)

## test case with disturbed sinus
x&lt;- 1:100
y &lt;- sin(x/5) +1.5 + rnorm(x, sd = 0.2)
peaks &lt;- peakwindow(x, y)
plot(x, y, type = "l", ylim = c(0, 3))
points(x, y, col = peaks$peakid + 2, pch = 16)

## test case: only one peak
yy &lt;- c(1:10, 11:1)
peakwindow(yy)

## error handling test case: no turnpoints
# yy &lt;- rep(1, length(x))
# peakwindow(x, yy)

</code></pre>

<hr>
<h2 id='plot.cardiFit'>Plot Method for cardiFit Objects</h2><span id='topic+plot.cardiFit'></span>

<h3>Description</h3>

<p>This function is a top-level function to visualize cardinal date objects
fitted with <code>fitweibull4</code> and <code>fitweibull6</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cardiFit'
plot(x, y = NULL, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cardiFit_+3A_x">x</code></td>
<td>
<p>object of class <code>cardiFit</code> resulting from a call to
<code><a href="#topic+fitweibull6">fitweibull6</a></code> or <code><a href="#topic+fitweibull4">fitweibull4</a></code>,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_y">y</code></td>
<td>
<p>not used, for compatibility with plot only,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_xmin">xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_xmax">xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_quantile">quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_symmetric">symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately,</p>
</td></tr>
<tr><td><code id="plot.cardiFit_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+CDW">CDW</a></code> for a detailed description of parameters.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,

<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## see the results
plot(res)
summary(res)
</code></pre>

<hr>
<h2 id='plot.cardiMetacdw'>Plot Method for cardiPeakwindow Objects</h2><span id='topic+plot.cardiMetacdw'></span>

<h3>Description</h3>

<p>This function is intended to visualize peaks identified
by the metaCDW function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cardiMetacdw'
plot(x, y, type = "lattice", scale = TRUE, col.poly = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cardiMetacdw_+3A_x">x</code></td>
<td>
<p>an object of class <code>cardiMetacdw</code> resulting from a call
to <code><a href="#topic+CDW">CDW</a></code>,</p>
</td></tr>
<tr><td><code id="plot.cardiMetacdw_+3A_y">y</code></td>
<td>
<p>the original data which were supplied to
<code><a href="#topic+CDW">CDW</a></code>,</p>
</td></tr>
<tr><td><code id="plot.cardiMetacdw_+3A_type">type</code></td>
<td>
<p>either &quot;lattice&quot; or &quot;polygon&quot;,</p>
</td></tr>
<tr><td><code id="plot.cardiMetacdw_+3A_scale">scale</code></td>
<td>
<p>a logical value indicating whether the height of
polygons should be scaled relative to the highest peak,</p>
</td></tr>
<tr><td><code id="plot.cardiMetacdw_+3A_col.poly">col.poly</code></td>
<td>
<p>color of polygons, either a single numeric value
for all years or a vector of the same length as number of samples,</p>
</td></tr>
<tr><td><code id="plot.cardiMetacdw_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>xyplot</code> or <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a top-level function to plot a complete set of
fits resurned by <code><a href="#topic+metaCDW">metaCDW</a></code> together with the original data points.
The function requires the <span class="pkg">lattice</span> package.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+CDW">CDW</a></code>
<code><a href="#topic+metaCDW">metaCDW</a></code>
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## artificial test data
data(carditest)

## identify all peaks
tt &lt;- metaCDW(carditest)

## plot it;
plot(tt, carditest)

## or with alternate layout:
plot(tt, carditest, layout = c(1, 3))

## plot polygons
plot(tt, carditest, type = "polygon")
</code></pre>

<hr>
<h2 id='plot.cardiPeakwindow'>Plot Method for cardiPeakwindow Objects</h2><span id='topic+plot.cardiPeakwindow'></span>

<h3>Description</h3>

<p>This function is intended to visualize peaks identified
by the peakwindow function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cardiPeakwindow'
plot(x, y, add=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cardiPeakwindow_+3A_x">x</code></td>
<td>
<p>an object of class <code>cardiPeakwindow</code> resulting from a call
to <code><a href="#topic+peakwindow">peakwindow</a></code>,</p>
</td></tr>
<tr><td><code id="plot.cardiPeakwindow_+3A_y">y</code></td>
<td>
<p>not used, for compatibility with plot only,</p>
</td></tr>
<tr><td><code id="plot.cardiPeakwindow_+3A_add">add</code></td>
<td>
<p>if TRUE, highlight additional peaks in the plot,</p>
</td></tr>
<tr><td><code id="plot.cardiPeakwindow_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peaks identified by <code><a href="#topic+peakwindow">peakwindow</a></code> are labelled with their
coresponding peak numbers. The first peak which occurs after <code>xstart</code>
(e.g. spring peak in biological time series) is highlighted with red color.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+CDW">CDW</a></code>
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate artificial test data
set.seed(123)
x &lt;- seq(1, 365 * 3, 18)
y &lt;- rlnorm(x, sd = 0.6) +  5e-5 * exp(1e-4 * ((x - 100) %% 365)^2) +
                            1e-4 * exp(3e-4 * ((x - 220) %% 200)^2)

## identify peaks and mark first peak after a certain time x
peaks &lt;- peakwindow(x, y, xstart = 55)

## plot it
plot(peaks)

# highlight peaks of other years
peaks2 &lt;- peakwindow(x, y, xstart = 420)
peaks3 &lt;- peakwindow(x, y, xstart = 785)
plot(peaks2, add = TRUE)
plot(peaks3, add = TRUE)

## mark years
abline(v = seq(0, 365 * 3, 365), col = "grey")
</code></pre>

<hr>
<h2 id='summary.cardiFit'>Summary Method for cardiFit Objects</h2><span id='topic+summary.cardiFit'></span>

<h3>Description</h3>

<p>This function is a top-level function to extract main results from
cardinal date objects fitted with <code>fitweibull4</code> or <code>fitweibull6</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cardiFit'
summary(object, xmin = 0, xmax = 365, quantile = 0.05, symmetric = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cardiFit_+3A_object">object</code></td>
<td>
<p>an object resulting from a call to <code><a href="#topic+fitweibull6">fitweibull6</a></code> or
<code><a href="#topic+fitweibull4">fitweibull4</a></code>,</p>
</td></tr>
<tr><td><code id="summary.cardiFit_+3A_xmin">xmin</code></td>
<td>
<p>left boundary (in day of year) of the integral under the curve</p>
</td></tr>
<tr><td><code id="summary.cardiFit_+3A_xmax">xmax</code></td>
<td>
<p>right boundary (in day of year) of the integral under the curve</p>
</td></tr>
<tr><td><code id="summary.cardiFit_+3A_quantile">quantile</code></td>
<td>
<p>two-sided quantile (percentage of integral)
which defines beginning and end of the peak,</p>
</td></tr>
<tr><td><code id="summary.cardiFit_+3A_symmetric">symmetric</code></td>
<td>
<p>if (<code>TRUE</code>), quantiles are calculated for the whole area
under the curve, otherwise for each of the branches separately,</p>
</td></tr>
<tr><td><code id="summary.cardiFit_+3A_...">...</code></td>
<td>
<p>for compatibility only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+CDW">CDW</a></code> fro a detailed description of function parameters.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,
<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,

<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create some test data
set.seed(123)
x &lt;- seq(0, 360, length = 20)
y &lt;- abs(rnorm(20, mean = 1, sd = 0.1))
y[5:10] &lt;- c(2, 4, 7, 3, 4, 2)

## fit Weibull function with 6 free parameters
res &lt;- fitweibull6(x, y)

## see the results
plot(res)
summary(res)
</code></pre>

<hr>
<h2 id='weibull4'>Four-Parametric Weibull Function</h2><span id='topic+weibull4'></span><span id='topic+fweibull4'></span><span id='topic+aweibull4'></span>

<h3>Description</h3>

<p>Four-parametric Weibull function and its definite integral.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fweibull4(x, p)

aweibull4(p, lower, upper)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull4_+3A_x">x</code></td>
<td>
<p>vector of function arguments,</p>
</td></tr>
<tr><td><code id="weibull4_+3A_p">p</code></td>
<td>
<p>vector of function parameters with:
<code>p[1]</code> vertical shift (zero offset),
<code>p[2]</code> vertical scaling,
<code>p[3]</code> shape parameter <code class="reqn">a</code> of <code><a href="stats.html#topic+dweibull">dweibull</a></code>, and
<code>p[4]</code> scale parameter <code class="reqn">b</code> of <code><a href="stats.html#topic+dweibull">dweibull</a></code>,</p>
</td></tr>
<tr><td><code id="weibull4_+3A_lower">lower</code></td>
<td>
<p>lower limit of the cumulative (integrated) function,</p>
</td></tr>
<tr><td><code id="weibull4_+3A_upper">upper</code></td>
<td>
<p>upper limit of the cumulative (integrated) function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The four-parametric Weibull function is essentially based on the Weibull
density function <code><a href="stats.html#topic+dweibull">dweibull</a></code> and its integral by the Weibull distribution
function <code><a href="stats.html#topic+pweibull">pweibull</a></code>
with two additional parameters for y scaling and zero offset. It can be given
by:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = p_1 + p_2 (p_3/p_4) {(x/p_4)}^{p_3-1} \exp (-{(x/b)}^{p_3})</code>
</p>

<p>for <code class="reqn">x \ge 0</code>.
</p>


<h3>Value</h3>

<p><code>fweibull4</code> gives the Weibull function and <code>aweibull4</code> its definite
integral (cumulative sum or area under curve).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dweibull">dweibull</a></code>,

<code><a href="#topic+weibull6">weibull6</a></code>,
<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+CDW">CDW</a></code>,
<code><a href="#topic+cardidates-package">cardidates</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0, 5, 0.02)
plot(x, fweibull4(x, c(0, 1, 2, 1)), type = "l", ylim = c(0, 2))
points(x, dweibull(x, 2, 1), pch = "+") ## identical to former

## shape
lines(x, fweibull4(x, c(0, 2, 1.5, 1)), type = "l", col = "orange")
## horizontal scaling
lines(x, fweibull4(x, c(0, 2, 2, 2)), type = "l", col = "green")
## shifting
lines(x, fweibull4(x, c(1, 1, 2, 1)), type = "l", col = "blue")
## vertical scaling
lines(x, fweibull4(x, c(0, 2, 2, 1)), type = "l", col = "red")


## definite integral
p &lt;- c(0, 1, 2, 2)
plot(x, aweibull4(p, lower = 0, upper = x))

p &lt;- c(0.1, 1, 2, 2)
plot(x, aweibull4(p, lower = 0, upper = x))
</code></pre>

<hr>
<h2 id='weibull6'>Six-Parametric Weibull Function</h2><span id='topic+weibull6'></span><span id='topic+fweibull6'></span><span id='topic+aweibull6'></span>

<h3>Description</h3>

<p>Six-parametric Weibull function and its definite integral.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fweibull6(x, p)

aweibull6(p, lower = 0, upper = 365)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull6_+3A_x">x</code></td>
<td>
<p>vector of function arguments</p>
</td></tr>
<tr><td><code id="weibull6_+3A_p">p</code></td>
<td>
<p>vector of function parameters with:
<code>p[1]</code> determines the offset before increase <code class="reqn">ofs = (p[4]+1) * (1-p[1])</code>,
<code>p[2]</code> inflexion point of increasing branch,
<code>p[3]</code> steepness of increasing branch,
<code>p[4]</code> offset after the peak,
<code>p[5]</code> inflexion point of decreasing branch,
<code>p[6]</code> steepness of decreasing branch,</p>
</td></tr>
<tr><td><code id="weibull6_+3A_lower">lower</code></td>
<td>
<p>lower limit of the cumulative (integrated) function,</p>
</td></tr>
<tr><td><code id="weibull6_+3A_upper">upper</code></td>
<td>
<p>upper limit of the cumulative (integrated) function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The six-parametric Weibull function is more flexible than the four-parametric
version. It is possible to have different offsets before and after the peak.
The function can be given by:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = p_4 + \exp(-(x/p_5)^{p_6})) (1-p_1 * \exp(-(x/p_2)^{p_3}))</code>
</p>

<p>for <code class="reqn">x \ge 0</code>.
</p>


<h3>Value</h3>

<p><code>fweibull6</code> gives the function and <code>aweibull6</code> its definite
integral (cumulative function or area under curve). Note that
in contrast to <code><a href="#topic+aweibull4">aweibull4</a></code>, the integral is
solved numerically and that the function returns a scalar, not a vector.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+weibull4">weibull4</a></code>,

<code><a href="#topic+fitweibull">fitweibull</a></code>,
<code><a href="#topic+CDW">CDW</a></code>,
<code><a href="#topic+peakwindow">peakwindow</a></code>,
<code><a href="#topic+cardidates-package">cardidates</a></code>
<code><a href="base.html#topic+Vectorize">Vectorize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0, 150)
plot(x, fweibull6(x, c(0.833, 40, 5, 0.2, 80, 5)), type = "l", ylim = c(0,2))

## interpretation of offsets
ofs1 &lt;- 0.1
ofs2 &lt;- 0.3
p1 &lt;- 1-ofs1/(ofs2 + 1)

lines(x, fweibull6(x, c(p1, 20, 5, ofs2, 60, 5)), col = "red")

## definite integratel from zero to 150, returns scalar
aweibull6(c(p1, 20, 5, ofs2, 60, 5), lower = 0, upper = 150)

## use Vectorize to create vectorized functions
vec.aweibull6 &lt;- Vectorize(aweibull6, "upper")
plot(x, vec.aweibull6(c(p1, 20, 5, ofs2, 60, 5), lower = 0, upper = x))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
