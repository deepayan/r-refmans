<!DOCTYPE html><html lang="en"><head><title>Help for package highDmean</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {highDmean}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#buildData'><p>Two-sample datasets generator</p></a></li>
<li><a href='#GO_example'><p>An example of GO term data</p></a></li>
<li><a href='#highDmean'><p>highDmean: A package for testing of equal mean for two-sample high dimensional data</p></a></li>
<li><a href='#rgammashift'><p>Random sample from shifted gamma distribution</p></a></li>
<li><a href='#SKK_sim'><p>Apply the SKK test to multiple simulated two-sample datasets</p></a></li>
<li><a href='#SKK_test'><p>High-dimensional two-sample test (SKK) proposed by Srivastava, Katayama, and Kano(2013)</p></a></li>
<li><a href='#zwl_sim'><p>Apply the test by Zhang and Wang (2020) to multiple simulated two-sample datasets</p></a></li>
<li><a href='#zwl_test'><p>High-dimensional two-sample test proposed by Zhang and Wang (2020)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Testing Two-Sample Mean in High Dimension</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Huaiyu Zhang, Haiyan Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Huaiyu Zhang &lt;huaiyuzhang1988@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the high-dimensional two-sample test 
    proposed by Zhang (2019) <a href="http://hdl.handle.net/2097/40235">http://hdl.handle.net/2097/40235</a>. 
    It also implements the test proposed by Srivastava, Katayama, 
    and Kano (2013) &lt;<a href="https://doi.org/10.1016%2Fj.jmva.2012.08.014">doi:10.1016/j.jmva.2012.08.014</a>&gt;. These tests 
    are particularly suitable to high dimensional data from two populations 
    for which the classical multivariate Hotelling's T-square test fails due 
    to sample sizes smaller than dimensionality. In this case, the ZWL and ZWLm 
    tests proposed by Zhang (2019) <a href="http://hdl.handle.net/2097/40235">http://hdl.handle.net/2097/40235</a>, 
    referred to as zwl_test() in this package, provide a reliable and powerful test. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-08 15:35:11 UTC; huaiyu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-12 10:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='buildData'>Two-sample datasets generator</h2><span id='topic+buildData'></span>

<h3>Description</h3>

<p>This function generates simulated high dimensional two-sample data from user specified populations with given mean vectors, covariance structure, sample sizes, and dimension of each observation. It could generate the long-range dependent process proposed by Hall et al. (1998) in additional to some processes provided in arima.sim().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildData(
  n,
  m,
  p,
  muX,
  muY,
  dep,
  commoncov = TRUE,
  VarScaleY = 1,
  S = 1,
  innov = function(n, ...) stats::rnorm(n, 0, 1),
  heteroscedastic = FALSE,
  het.diag
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildData_+3A_n">n</code></td>
<td>
<p>number of observations in the 1st sample.</p>
</td></tr>
<tr><td><code id="buildData_+3A_m">m</code></td>
<td>
<p>number of observations in the 2nd sample.</p>
</td></tr>
<tr><td><code id="buildData_+3A_p">p</code></td>
<td>
<p>the dimensionality of the each observation. The samples from both populations should have the same dimension.</p>
</td></tr>
<tr><td><code id="buildData_+3A_mux">muX</code></td>
<td>
<p><code>p</code> by 1 vector of component means for the 1st population.</p>
</td></tr>
<tr><td><code id="buildData_+3A_muy">muY</code></td>
<td>
<p><code>p</code> by 1 vector of component means for the 2nd population.</p>
</td></tr>
<tr><td><code id="buildData_+3A_dep">dep</code></td>
<td>
<p>dependence structure among the <code>p</code> components for both populations.
Possible options are:
</p>
<p>'IND' for independence;
</p>
<p>'SD' for strong dependency, AR(1) with parameter 0.9;
</p>
<p>'WD' for weak dependency, ARMA(2, 2) with AR parameters 0.4 and -0.1, and MA parameters 0.2 and 0.3;
</p>
<p>'LR' for long-range dependency with parameter 0.7.
</p>
<p>For more details about the configurations,  please refer to Zhang and Wang (2020).</p>
</td></tr>
<tr><td><code id="buildData_+3A_commoncov">commoncov</code></td>
<td>
<p>a logical indicating whether the two populations have equal covariance matrices. If FALSE, the innovations used in generating data for the 2nd population will be scaled by the square root of the value specified in VarScaleY.</p>
</td></tr>
<tr><td><code id="buildData_+3A_varscaley">VarScaleY</code></td>
<td>
<p>constant by which innovations are scaled in generating observations for the 2nd sample when commoncov=FALSE.</p>
</td></tr>
<tr><td><code id="buildData_+3A_s">S</code></td>
<td>
<p>the number of data sets to simulate.</p>
</td></tr>
<tr><td><code id="buildData_+3A_innov">innov</code></td>
<td>
<p>a function used to generate the innovations, such as <code>innov=function(n,...) rnorm(n,0,1)</code>.</p>
</td></tr>
<tr><td><code id="buildData_+3A_heteroscedastic">heteroscedastic</code></td>
<td>
<p>a logical indicating whether the components will be scaled by the entries in the diagonal matrix specified by <code>het.diag</code>.</p>
</td></tr>
<tr><td><code id="buildData_+3A_het.diag">het.diag</code></td>
<td>
<p>a <code>p</code> by <code>p</code> diagonal matrix, where the entries on the diagonal will be used to scale the component standard deviations. Only valid when <code>heteroscedastic = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <code>S</code> lists, each consisting of an <code>n</code> by <code>p</code> matrix <code>X</code>, an <code>m</code> by <code>p</code> matrix <code>Y</code>, the sample sizes, <code>n</code> and <code>m</code>, for each population, and the dimensionality <code>p</code>.
</p>


<h3>References</h3>

<p>Hall, P., Jing, B.-Y., and Lahiri, S. N. (1998). On the sampling window method for long-range dependent data. Statistica Sinica, 8(4):1189-1204.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate 3 two-sample datasets of dimensionality 300
# with sample sizes 45 for one sample &amp; 60 for the other.
buildData(n = 45, m =60, p = 300,
          muX = rep(0,300), muY = rep(0,300),
          dep = 'IND', S = 3, innov = rnorm)
</code></pre>

<hr>
<h2 id='GO_example'>An example of GO term data</h2><span id='topic+GO_example'></span>

<h3>Description</h3>

<p>A dataset containing the gene expressions for a Gene Ontology (GO) term
on two phenotype groups: BCR/ABL and NEG.
The id of the GO term is <code>GO:0000003</code>.
The raw dataset is taken from <code>ALL</code> package.
The data were preprocessed, for which the details are  elaborated in Zhang and Wang (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GO_example
</code></pre>


<h3>Format</h3>

<p>A list with two subsets of gene expression data.
</p>

<dl>
<dt>X</dt><dd><p>A matrix containing gene expressions for the BCR/ABL group. The row id is for patient and the
column id is for gene.</p>
</dd>
<dt>Y</dt><dd><p>A matrix containing gene expressions for the NEG group. The row id is for patient and the
column id is for gene.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhang, H. and Wang, H. (2020). Result consistency of high dimensional
two-sample tests applied to gene ontology terms with gene sets. Manuscript in review.
</p>

<hr>
<h2 id='highDmean'>highDmean: A package for testing of equal mean for two-sample high dimensional data</h2><span id='topic+highDmean'></span>

<h3>Description</h3>

<p>This package is an implementation of the high-dimensional two-sample test
proposed by Zhang and Wang (2020) &quot;Result consistency of high dimensional two-sample tests
applied to gene ontology terms with gene sets&quot;. It also implements the SKK test proposed by
Srivastava, Katayama, and Kano (2013) &quot;A two sample test in high dimensional data.&quot;
These tests are particularly suitable for high dimensional data from two populations
for which the classical multivariate Hotelling's T-square test fails due to sample sizes smaller than
dimensionality. In this case, the ZWL and ZWLm tests proposed by Zhang and Wang (2020), referred to as
zwl_test() in this package, provide a reliable and powerful test.
</p>


<h3>highDmean functions</h3>

<p>The function <code>zwl_test()</code> conducts the ZWL and ZWLm test of equal mean for two-sample high dimensional data provided in
matrices of dimension <code>n</code> by <code>p</code> and <code>m</code>
by <code>p</code>, which are random samples from two populations. It
returns the value of test statistic and p-value under the null hypothesis of equal means.
The <code>SKK_test()</code> performs the SKK test and returns the value of test statistic and p-value.
The <code>buildData()</code> function generates simulated high-dimensional data in the two-population setting
with specified sample sizes, numbers of components, covariance structure, etc., and
the functions <code>zwl_sim()</code> and <code>SKK_sim()</code>
return test statistic values and p-values for lists of simulated data sets generated by <code>buildData()</code>.
</p>

<hr>
<h2 id='rgammashift'>Random sample from shifted gamma distribution</h2><span id='topic+rgammashift'></span>

<h3>Description</h3>

<p>This function generates random samples from shifted gamma distribution. That is, random samples are first generated from gamma distribution with shape parameter <code>shape</code> and scale parameter <code>scale</code> and then the mean of the gamma distribution, <code>shape</code>*<code>scale</code>, is subtracted from the sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgammashift(n, shape, scale)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgammashift_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="rgammashift_+3A_shape">shape</code></td>
<td>
<p>the shape parameter of gamma distribution</p>
</td></tr>
<tr><td><code id="rgammashift_+3A_scale">scale</code></td>
<td>
<p>the scale parameter of gamma distribution
#'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>n</code> values. It is equivalent to rgamma(n, shape, scale)- shape * scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a sample of shifted gamma observations with shape parameter 4 and scale parameter 2.
set.seed(10)
rgammashift(n = 5, shape =4, scale = 2)
# It is equivalent to
set.seed(10)
rgamma(n = 5, shape=4, scale=2)- 4 * 2
</code></pre>

<hr>
<h2 id='SKK_sim'>Apply the SKK test to multiple simulated two-sample datasets</h2><span id='topic+SKK_sim'></span>

<h3>Description</h3>

<p>This function performs the SKK test of Srivastava, Katayama, and Kano(2013) on multiple high-dimensional two-sample datasets.
It is useful for Monte Carlo experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SKK_sim(DATA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SKK_sim_+3A_data">DATA</code></td>
<td>
<p>The list of dataset lists generated by <code>buildData</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe, each row of which reports the values of the
SKK test statistics and the p-values.
</p>


<h3>References</h3>

<p>Srivastava, M. S., Katayama, S., and Kano, Y. (2013).
A two sample test in high dimensional data. Journal of Multivariate Analysis, 114:349-358.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate 3 simulated datasets and apply the SKK test
data &lt;- buildData(n = 45, m =60, p = 300,
                 muX = rep(0,300), muY = rep(0,300),
                 dep = 'IND', S = 3, innov = rnorm)
SKK_sim(data)


</code></pre>

<hr>
<h2 id='SKK_test'>High-dimensional two-sample test (SKK) proposed by Srivastava, Katayama, and Kano(2013)</h2><span id='topic+SKK_test'></span>

<h3>Description</h3>

<p>This function implements the two-sample high-dimensional test proposed by Srivastava, Katayama, and Kano(2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SKK_test(X, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SKK_test_+3A_x">X</code></td>
<td>
<p>The data matrix (n by p) from the first population.</p>
</td></tr>
<tr><td><code id="SKK_test_+3A_y">Y</code></td>
<td>
<p>The data matrix (m by p) from the second population.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list consisting of the values of the test statistic and p-value.
</p>


<h3>References</h3>

<p>Srivastava, M. S., Katayama, S., and Kano, Y. (2013).
A two sample test in high dimensional data. Journal of Multivariate Analysis, 114:349-358.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated dataset and apply the SKK test
data &lt;- buildData(n = 45, m =60, p = 300,
                 muX = rep(0,300), muY = rep(0,300),
                 dep = 'IND', S = 1, innov = rnorm)
SKK_test(data[[1]]$X, data[[1]]$Y)

# Apply the SKK test to the data for a GO term stored in GO_example
SKK_test(GO_example$X, GO_example$Y)
</code></pre>

<hr>
<h2 id='zwl_sim'>Apply the test by Zhang and Wang (2020) to multiple simulated two-sample datasets</h2><span id='topic+zwl_sim'></span>

<h3>Description</h3>

<p>Apply the two-sample high-dimensional test by Zhang and Wang (2020) to multiple simulated two-sample high dimensional datasets. This function is useful for Monte Carlo experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zwl_sim(DATA, order = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zwl_sim_+3A_data">DATA</code></td>
<td>
<p>The list of dataset lists generated by <code>buildData</code>.</p>
</td></tr>
<tr><td><code id="zwl_sim_+3A_order">order</code></td>
<td>
<p>The order of the center correction. Possible choices are 0, 2.
To use the ZWLm test, set <code>order = 0</code>; to use the ZWL test, set <code>order = 2</code>. THE ZWLm test is recommended for moderate sample sizes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with each row consisting the values of the
test statistics, p-values, Tn, and the estimate of Var(Tn).
</p>


<h3>References</h3>

<p>Zhang, H. and Wang, H. (2020). Result consistency of high dimensional
two-sample tests applied to gene ontology terms with gene sets. Manuscript in review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate 3 simulated two-sample datasets and apply the ZWL test
data &lt;- buildData(n = 45, m =60, p = 300,
          muX = rep(0,300), muY = rep(0,300),
          dep = 'IND', S = 3, innov = rnorm)
zwl_sim(data, order = 2)


</code></pre>

<hr>
<h2 id='zwl_test'>High-dimensional two-sample test proposed by Zhang and Wang (2020)</h2><span id='topic+zwl_test'></span>

<h3>Description</h3>

<p>This function implements the test of equal mean for two-sample high-dimension data using the ZWL and ZWLm tests proposed by Zhang and Wang (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zwl_test(X, Y, order = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zwl_test_+3A_x">X</code></td>
<td>
<p>The data matrix (n by p) from the first population.</p>
</td></tr>
<tr><td><code id="zwl_test_+3A_y">Y</code></td>
<td>
<p>The data matrix (m by p) from the second population.</p>
</td></tr>
<tr><td><code id="zwl_test_+3A_order">order</code></td>
<td>
<p>The order of center correction. Possible choices are 0,  2.
To use the ZWLm test, set <code>order = 0</code>; to use the ZWL test, set <code>order = 2</code>. For moderate sample sizes, ZWLm is recommended.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>statistic</dt><dd><p>The value of the test statistic.</p>
</dd>
<dt>pvalue</dt><dd><p>The p-value of the test statistic based on the asymptotic normality established by Zhang and Wang (2020)</p>
</dd>
<dt>Tn</dt><dd><p>The average of the squared univariate t-statistics.</p>
</dd>
<dt>var</dt><dd><p>The estimated variance of Tn</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhang, H. and Wang, H. (2020). Result consistency of high dimensional
two-sample tests applied to gene ontology terms with gene sets. Manuscript in review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated two-sample dataset and apply the ZWL test
data &lt;- buildData(n = 45, m =60, p = 300,
          muX = rep(0,300), muY = rep(0,300),
          dep = 'IND', S = 1, innov = rnorm)
zwl_test(data[[1]]$X, data[[1]]$Y, order = 2)

# Apply the ZWLm test to a GO term to see if the two groups are differentiately expressed.
# The data for the GO term were stored in GO_example.
zwl_test(GO_example$X, GO_example$Y, order = 0)
# Apply the ZWL test to the GO term
zwl_test(GO_example$X, GO_example$Y, order = 2)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
