<!DOCTYPE html><html><head><title>Help for package npmlreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npmlreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#npmlreg-package'>
<p>Nonparametric maximum likelihood estimation for random effect models</p></a></li>
<li><a href='#alldist'><p> NPML estimation or Gaussian quadrature for overdispersed GLM's and variance component models</p></a></li>
<li><a href='#dkern'><p>Aitchison-Aitken kernel</p></a></li>
<li><a href='#fabric'><p> The Fabric Data</p></a></li>
<li><a href='#family.glmmNPML'><p>Methods for objects of class glmmNPML or glmmGQ</p></a></li>
<li><a href='#gqz'><p>Gauss-Hermite integration points</p></a></li>
<li><a href='#hosp'><p>The Pennsylvanian Hospital Stay Data</p></a></li>
<li><a href='#irlsuicide'><p>Irish Suicide Data</p></a></li>
<li><a href='#missouri'><p>Missouri lung cancer data</p></a></li>
<li><a href='#plot.glmmNPML'><p> Plot Diagnostics for objects of class glmmNPML or glmmGQ</p></a></li>
<li><a href='#post'><p>Posterior probabilities/intercepts, and mass point classifications</p></a></li>
<li><a href='#predict.glmmNPML'><p>Prediction from objects of class glmmNPML or glmmGQ</p></a></li>
<li><a href='#rainfall'><p>Rainfall data</p></a></li>
<li><a href='#summary.glmmNPML'><p>Summarizing finite mixture regression fits</p></a></li>
<li><a href='#tolfind'><p> Grid search over tol for NPML estimation of (generalized) random effect models</p></a></li>
<li><a href='#weightslogl.calc.w'><p> Internal npmlreg functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Maximum Likelihood Estimation for Random Effect
Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.46-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Jochen Einbeck, Ross Darnell and John Hinde</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jochen Einbeck &lt;jochen.einbeck@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>statmod (&ge; 1.4.20)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, nlme, lattice</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric maximum likelihood estimation or Gaussian
        quadrature for overdispersed generalized linear models and
        variance component models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-31 12:47:54 UTC; dma0je</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-31 13:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='npmlreg-package'>
Nonparametric maximum likelihood estimation for random effect models
</h2><span id='topic+npmlreg-package'></span><span id='topic+npmlreg'></span>

<h3>Description</h3>

<p>Nonparametric maximum likelihood estimation or Gaussian quadrature 
for overdispersed generalized linear models and variance component models. 
The main functions  are <code><a href="#topic+alldist">alldist</a></code> and <code><a href="#topic+allvc">allvc</a></code>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> npmlreg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.
</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
</p>
<p>For details on  the GNU General Public License
see <a href="http://www.gnu.org/copyleft/gpl.html">http://www.gnu.org/copyleft/gpl.html</a> or   
write to the Free Software Foundation, Inc., 51 Franklin Street, 
Fifth Floor, Boston, MA  02110-1301, USA. 
</p>


<h3>Acknowledgments</h3>

<p>This <span class="rlang"><b>R</b></span> package is based on several GLIM4 macros originally written by 
Murray Aitkin and Brian Francis.  The authors are also grateful to 
Nick Sofroniou for retrieving the suicide data and providing the function <code>gqz</code>.
</p>
<p>The work on this <span class="rlang"><b>R</b></span> package was supported by Science
Foundation Ireland Basic Research Grant 04/BR/M0051.
</p>


<h3>Author(s)</h3>

<p>Jochen Einbeck, Ross Darnell and John Hinde.
</p>
<p>Maintainer: Jochen Einbeck &lt;jochen.einbeck@durham.ac.uk&gt;
</p>


<h3>References</h3>

<p>Aitkin, M., Francis, B. and Hinde, J. (2009). Statistical Modelling in R. 
Oxford Statistical Science Series, Oxford, UK. 
</p>
<p>Einbeck, J., and Hinde, J.: Nonparametric maximum likelihood estimation
for random effect models in <span class="rlang"><b>R</b></span>. Vignette to <span class="rlang"><b>R</b></span> package  <span class="pkg">npmlreg</span>. 
Type <code>vignette("npmlreg-v")</code> to open it. 
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>

<hr>
<h2 id='alldist'> NPML estimation or Gaussian quadrature for overdispersed GLM's and variance component models</h2><span id='topic+alldist'></span><span id='topic+allvc'></span>

<h3>Description</h3>

<p> Fits a random effect model using Gaussian quadrature (Hinde, 1982) or nonparametric maximum likelihood (Aitkin, 1996a).  
The function <code>alldist</code> is designed to account for overdispersion, while <code>allvc</code> fits variance component models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alldist(formula, 
        random = ~1, 
        family = gaussian(), 
        data,
        k = 4, 
        random.distribution = "np", 
        tol = 0.5, 
        offset, 
        weights, 
        pluginz, 
        na.action, 
        EMmaxit = 500, 
        EMdev.change = 0.001, 
        lambda = 0, 
        damp = TRUE, 
        damp.power = 1, 
        spike.protect = 0, 
        sdev,
        shape, 
        plot.opt = 3, 
        verbose = TRUE,
        ...)
        
allvc(formula, 
        random = ~1, 
        family = gaussian(), 
        data, 
        k = 4, 
        random.distribution = "np", 
        tol = 0.5, 
        offset, 
        weights, 
        pluginz, 
        na.action, 
        EMmaxit = 500, 
        EMdev.change = 0.001, 
        lambda=0,
        damp = TRUE, 
        damp.power = 1, 
        spike.protect=0,
        sdev,
        shape, 
        plot.opt = 3, 
        verbose = TRUE,
        ...)        
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alldist_+3A_formula">formula</code></td>
<td>
<p>a formula defining the response and the fixed effects (e.g. <code>y ~ x</code>).   </p>
</td></tr>
<tr><td><code id="alldist_+3A_random">random</code></td>
<td>
<p>a formula defining the random model. In the case of <code>alldist</code>,  set <code>random = ~1</code> to model overdispersion, and for instance <code>random = ~x</code> to introcude a random coefficient <code>x</code>.  
In the case of <code>allvc</code>,  set <code>random=~1|PSU</code> to model
overdispersion on the upper level, where PSU is a <b>factor</b> for
the primary sampling units, e.g. groups, clusters, classes, or
individuals in longitudinal data, and define random coefficients
accordingly.</p>
</td></tr>
<tr><td><code id="alldist_+3A_family">family</code></td>
<td>
<p>conditional distribution of responses: &quot;gaussian&quot;,
&quot;poisson&quot;, &quot;binomial&quot;, &quot;Gamma&quot;, or &quot;inverse.gaussian&quot; can be set. If
&quot;gaussian&quot;, &quot;Gamma&quot;, or &quot;inverse.gaussian&quot;, then equal component
dispersion parameters are assumed, except if the optional parameter
<code>lambda</code> is modified. The same link functions as for function
<code><a href="stats.html#topic+glm">glm</a></code> are supported. </p>
</td></tr>
<tr><td><code id="alldist_+3A_data">data</code></td>
<td>
<p>the data frame (mandatory, even if it is attached to the workspace!). </p>
</td></tr>
<tr><td><code id="alldist_+3A_k">k</code></td>
<td>
<p>the number of mass points/integration points 
(supported are up to 600 mass points).</p>
</td></tr>
<tr><td><code id="alldist_+3A_random.distribution">random.distribution</code></td>
<td>
<p>the mixing distribution, Gaussian Quadrature (<code>gq</code>) or NPML (<code>np</code>) can be set.   </p>
</td></tr>
<tr><td><code id="alldist_+3A_tol">tol</code></td>
<td>
<p>the tol scalar (usually, <code class="reqn">0&lt;</code><code>tol</code> <code class="reqn">\le 1</code>)   </p>
</td></tr>
<tr><td><code id="alldist_+3A_offset">offset</code></td>
<td>
<p>an optional offset to be included in the model.</p>
</td></tr>
<tr><td><code id="alldist_+3A_weights">weights</code></td>
<td>
<p>optional prior weights for the data.</p>
</td></tr>
<tr><td><code id="alldist_+3A_pluginz">pluginz</code></td>
<td>
<p>optional numerical vector of length <code>k</code> specifying the starting mass points of the EM algorithm.  </p>
</td></tr>
<tr><td><code id="alldist_+3A_na.action">na.action</code></td>
<td>
<p>a function indicating what should happen when <code>NA</code>'s occur,
with possible arguments <code>na.omit</code> and <code>na.fail</code>. The default is set
by the <code>na.action</code> setting in <code>options()</code>. </p>
</td></tr>
<tr><td><code id="alldist_+3A_emmaxit">EMmaxit</code></td>
<td>
<p>maximum number of EM iterations.   </p>
</td></tr>
<tr><td><code id="alldist_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>stops EM algorithm when deviance change falls below this value.  </p>
</td></tr>
<tr><td><code id="alldist_+3A_lambda">lambda</code></td>
<td>
<p>only applicable for Gaussian, Gamma, and Inverse Gaussian mixtures. If set, standard 
deviations/ shape parameters are calculated smoothly across components via 
an Aitchison-Aitken kernel (<code><a href="#topic+dkern">dkern</a></code>) with parameter <code>lambda</code>. 
The setting <code>lambda= 0</code> is automatically mapped to <code>lambda =1/k</code> and 
corresponds to the case 'maximal smoothing' (i.e. equal component dispersion parameters), 
while <code>lambda=1</code> means 'no smoothing' (unequal disp. param.)</p>
</td></tr>
<tr><td><code id="alldist_+3A_damp">damp</code></td>
<td>
<p>switches EM damping on or off.   </p>
</td></tr>
<tr><td><code id="alldist_+3A_damp.power">damp.power</code></td>
<td>
<p>steers degree of damping applied on dispersion parameter according 
to formula <code>1-(1-tol)^(damp.power*iter+1)</code>, see Einbeck &amp; Hinde (2006).  </p>
</td></tr>
<tr><td><code id="alldist_+3A_spike.protect">spike.protect</code></td>
<td>
<p>for Gaussian, Gamma, and Inverse Gaussian mixtures with unequal or
smooth component standard deviations: protects algorithm to converge into likelihood spikes  
by stopping the EM algorithm if one of the component standard deviations 
(shape parameters, resp.), divided by the fitted mass points, falls below
(exceeds, resp.) a certain threshold, which is <code>0.000001*spike.protect</code> 
(<code>10^6*spike.protect</code>, resp.) Setting <code>spike.protect=0</code> means 
disabling the spike protection. If set, then <code>spike.protect=1</code>
is recommended. Note that the displayed disparity may not be correct 
when convergence is not achieved. This can be checked with <code>EMconverged</code>. </p>
</td></tr>
<tr><td><code id="alldist_+3A_sdev">sdev</code></td>
<td>
<p>optional; specifies standard deviation for normally distributed response.
If unspecified, it will be estimated from the data. </p>
</td></tr>
<tr><td><code id="alldist_+3A_shape">shape</code></td>
<td>
<p>optional; specifies shape parameter for Gamma-and IG-distributed response.
For Gamma, setting <code>shape=1</code> gives an exponential distribution. If unspecified,
it will be estimated from the data. </p>
</td></tr>
<tr><td><code id="alldist_+3A_plot.opt">plot.opt</code></td>
<td>
<p>if equal to zero, then no graphical output is given. 
For <code>plot.opt=1</code> the development of the disparity <code class="reqn">-2\log L</code> over 
iteration number is plotted, for <code>plot.opt=2</code> the EM trajectories are plotted,
and for <code>plot.opt=3</code> both plots are shown.   </p>
</td></tr>
<tr><td><code id="alldist_+3A_verbose">verbose</code></td>
<td>
<p>if set to <code>FALSE</code>, no printed output is given during 
function execution. Useful for <code>tolfind</code>.   </p>
</td></tr>   
<tr><td><code id="alldist_+3A_...">...</code></td>
<td>
<p> generic options for the <code>glm</code> function. Not all options may
be supported under any circumstances.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The nonparametric maximum likelihood (NPML) approach was introduced in Aitkin (1996) 
as a tool to fit overdispersed generalized linear models. The idea is to approximate 
the unknown and unspecified distribution of the random effect by a discrete mixture 
of exponential family densities, leading to a simple expression of the marginal 
likelihood which can then be maximized using a standard EM algorithm.
</p>
<p>Aitkin (1999) extended this method to generalized linear models with shared 
random effects arising through variance component or repeated measures 
structure. Applications are two-stage sample designs, when firstly the 
primary sampling units (the upper-level units, e.g. classes) and then the 
secondary sampling units (lower-level units, e.g. students) are selected, or 
longitudinal data. Models of this type have also been referred to as multi-level 
models (Goldstein, 2003). <code>allvc</code> is restricted to 2-level models. 
</p>
<p>The number of components <code>k</code> of the finite mixture has to be specified beforehand.
When option <code>'gq'</code> is set, then Gauss-Hermite masses and mass points are used, 
assuming implicitly a normally distributed random effect. 
When option <code>'np'</code> is chosen, the EM algorithm uses the Gauss-Hermite masses 
and mass points as starting points. The position of the starting points can 
be concentrated or extended by setting <code>tol</code> smaller or larger than one,
respectively. 
</p>
<p>Fitting random coefficient models (Aitkin, Francis &amp; Hinde, 2009, pp. 496, p. 514) is 
possible by specifying the random term explicitly. Note that the setting 
<code>random= ~ x</code> gives a model with a random slope and a random
intercept, and 
that only one random coefficient can be specified. The option
<code>random.distribution</code> is restricted to <code>np</code> in this case,
i.e. Gaussian Quadrature is not supported for random coefficient
models (see also Aitkin, Francis &amp; Hinde (2005), page 475 bottom).
</p>
<p>As for <code>glm</code>, there are three different ways of specifying a
binomial model, namley through
</p>

<ul>
<li><p> a two-column matrix before the '~' symbol, specifying the counts of
successes and non-successes.
</p>
</li>
<li><p> a vector of proportions of successes before the '~' symbol, and the
associated number of trials provided in the <code>weights</code> argument.
</p>
</li>
<li><p> a two-level factor  before the '~' symbol (only for Bernoulli-response).
</p>
</li></ul>

<p>The weights have to be understood as frequency weights, i.e. setting all weights in 
<code>alldist</code> equal to 2 will duplicate each data point and hence double the 
disparity and deviance.  
</p>
<p>The Inverse Gaussian (IG) response distribution is parametrized as usual through the
mean and a scaling parameter. We refer to the latter, which is the
inverse of the dispersion parameter in exponential family formulation,
as <code>shape</code>.  The canonical &quot;1/mu^2&quot; link is supported, but it is
quite tenuous since the linear predictor is likely to become negative
after adding the random effect. The <code>log</code> link behaves more
reliably for this distribution.
</p>
<p>For <code>k</code> <code class="reqn">\ge 54</code>, mass points with negligible mass
(i.e. &lt; 1e-50) are omitted.  The maximum number of 'effective' mass points
is then 198.
</p>


<h3>Value</h3>

<p>The function alldist produces an object of class <code>glmmNPML</code> 
(if <code>random.distributon</code> is set to &lsquo;np&rsquo;)  or <code>glmmGQ</code> 
(&lsquo;gq&rsquo;).  Both objects contain the following 29 components: 
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients (including the mass points). 
In case of Gaussian quadrature, the coefficient given at <code>z</code>  
corresponds to the standard deviation of the mixing distribution. </p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the difference between the true response and the empirical Bayes predictions.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the empirical Bayes predictions (Aitkin, 1996b) on the scale of the responses.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the &lsquo;family&rsquo; object used.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the extended linear predictors <code class="reqn">\hat{\eta}_{ik}</code>. </p>
</td></tr>
<tr><td><code>disparity</code></td>
<td>
<p>the disparity (<code>-2logL</code>) of the fitted mixture regression model.</p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the deviance of the fitted mixture regression model.</p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the deviance for the null model (just containing an intercept), comparable with
<code>deviance</code>.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom of the fitted model (including the random part).</p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the (extended) response vector.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the formula supplied.</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>the random term of the model formula.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data argument.</p>
</td></tr> 
<tr><td><code>model</code></td>
<td>
<p>the (extended) design matrix.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>the case weights initially supplied.</p>
</td></tr> 
<tr><td><code>offset</code></td>
<td>
<p>the offset initially supplied.</p>
</td></tr>
<tr><td><code>mass.points</code></td>
<td>
<p>the fitted mass points.</p>
</td></tr>
<tr><td><code>masses</code></td>
<td>
<p>the mixture probabilities corresponding to the mass points.</p>
</td></tr>
<tr><td><code>sdev</code></td>
<td>
<p>a list of the two elements <code>sdev$sdev</code> and <code>sdev$sdevk</code>. 
The former is the estimated standard deviation of the
Gaussian mixture components (estimated over all mixture components), and the latter 
gives the unequal or smooth component-specific standard deviations. 
All values are equal if <code>lambda=0</code>.</p>
</td></tr>
<tr><td><code>shape</code></td>
<td>
<p>a list of the two elements <code>shape$shape</code> and <code>shape$shapek</code>, 
to be interpreted in analogy to sdev.</p>
</td></tr>
<tr><td><code>rsdev</code></td>
<td>
<p>estimated random effect standard deviation.</p>
</td></tr>
<tr><td><code>post.prob</code></td>
<td>
<p>a matrix of posteriori probabilities.</p>
</td></tr>
<tr><td><code>post.int</code></td>
<td>
<p>a vector of &lsquo;posteriori intercepts&rsquo; (as in Sofroniou et al. (2006)).</p>
</td></tr>
<tr><td><code>ebp</code></td>
<td>
<p>the empirical Bayes Predictions on the scale of the linear predictor. 
For compatibility with older versions.</p>
</td></tr>
<tr><td><code>EMiter</code></td>
<td>
<p>gives the number of iterations of the EM algorithm. </p>
</td></tr>
<tr><td><code>EMconverged</code></td>
<td>
<p>logical value indicating if the EM algorithm converged. </p>
</td></tr>
<tr><td><code>lastglm</code></td>
<td>
<p>the fitted <code>glm</code> object from the last EM iteration.</p>
</td></tr>
<tr><td><code>Misc</code></td>
<td>
<p>contains additional information relevant for the summary and plot functions,
in particular the disparity trend and the EM trajectories. </p>
</td></tr>  
</table>
<p>If a binomial model is specified by giving a two-column response, 
the weights returned by <code>weights</code> are the total numbers of cases 
(factored by the supplied case weights) and the component <code>y</code> 
of the result is the proportion of successes. 
</p>
<p>As a by-product, <code>alldist</code> produces a plot showing the disparity
in dependence of the iteration number. Further, a plot with the EM trajectories
is given. The x-axis corresponds  to the iteration number, and the y-axis
to the value of the mass points at a particular iteration. 
This plot is not produced for GQ. 
</p>


<h3>Note</h3>

 
<p>In contrast to the GLIM 4 version, this <span class="rlang"><b>R</b></span> implementation 
uses for Gaussian (as well Gamma  and IG) mixtures by default a damping procedure in the
first cycles of the EM algorithm (Einbeck &amp; Hinde, 2006), which stabilizes
the algorithm and makes it less sensitive to the optimal 
choice of <code>tol</code>. If <code>tol</code> is very small
(i.e. less than 0.1), it can be useful  to set <code>damp.power</code> to values 
larger than 1 in order to accelerate convergence. 
Do not use <code>damp.power=0</code>, as this would mean permanent damping during EM. 
Using the option <code>pluginz</code>, one  can to some extent circumvent the 
necessity to  specify <code>tol</code> by giving the starting points explicitly. 
However, when using <code>pluginz</code> for normal, Gamma- or IG- distributed response, 
damping will be strictly necessary to ensure that the imposed starting points
don't get blurred immediately due to initial fluctuations, implying that 
<code>tol</code> still plays a role in this case. 
</p>


<h3>Author(s)</h3>

<p>Originally translated from the GLIM 4 functions <code>alldist</code> and 
<code>allvc</code> (Aitkin &amp; Francis, 1995) to <span class="rlang"><b>R</b></span> by Ross Darnell (2002). Modified, 
extended, and prepared for publication by Jochen Einbeck &amp; John Hinde (2006). 
</p>


<h3>References</h3>

 
<p>Aitkin, M. and Francis, B. (1995). Fitting overdispersed generalized linear models by nonparametric maximum likelihood. GLIM Newsletter 25, 37-45. 
</p>
<p>Aitkin, M. (1996a). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing 6, 251-262. 
</p>
<p>Aitkin, M. (1996b). Empirical Bayes shrinkage using posterior random effect means from nonparametric maximum likelihood estimation in general random effect models. Statistical Modelling: Proceedings of the 11th IWSM 1996, 87-94. 
</p>
<p>Aitkin, M. (1999). A general maximum likelihood analysis of variance components in generalized linear models. Biometrics 55, 117-128. 
</p>
<p>Aitkin, M., Francis, B. and Hinde, J. (2009). Statistical Modelling in R. Oxford Statistical Science Series, Oxford, UK. 
</p>
<p>Einbeck, J. &amp; Hinde, J. (2006). A note on NPML estimation for exponential family regression models with unspecified dispersion parameter. Austrian Journal of Statistics 35, 233-243. 
</p>
<p>Goldstein, H. (2003). Multilevel Statistical Models (3rd edition). Arnold, London, UK.
</p>
<p>Hinde, J. (1982). Compound Poisson regression models. Lecture Notes in Statistics 14, 109-121. 
</p>
<p>Sofroniou, N., Einbeck, J., and Hinde, J. (2006). Analyzing Irish suicide rates with mixture models. Proceedings of the 21st International Workshop on Statistical Modelling in Galway, Ireland, 2006. 
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="#topic+summary.glmmNPML">summary.glmmNPML</a></code>, 
<code><a href="#topic+predict.glmmNPML">predict.glmmNPML</a></code> <code><a href="#topic+family.glmmNPML">family.glmmNPML</a></code>, 
<code><a href="#topic+plot.glmmNPML">plot.glmmNPML</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The first three examples (galaxy data, toxoplasmosis data , fabric faults) 
# are based on GLIM examples in Aitkin et al. (2005), and the forth example using
# the Hospital-Stay-Data (Rosner, 2000) is taken from Einbeck &amp; Hinde (2006).
# The fifth data example using the Oxford boys is again inspired by Aitkin et al. (2005).
# The sixth example on Irish suicide rates is taken from Sofroniou et al. (2006).
  

# The galaxy data   
  data(galaxies, package="MASS")
  gal&lt;-as.data.frame(galaxies)
  galaxy.np6 &lt;- alldist(galaxies/1000~1, random=~1, random.distribution="np", 
      data=gal, k=6)
  galaxy.np8u &lt;- alldist(galaxies/1000~1, random=~1, random.distribution="np", 
      data=gal, k=8, lambda=0.99)
  round(galaxy.np8u$sdev$sdevk, digits=3)
  # [1]  0.912 0.435 0.220 0.675 1.214 0.264 0.413 0.297

# The toxoplasmosis data 
  data(rainfall)
  rainfall$x&lt;-rainfall$Rain/1000  
  rainfall$x2&lt;- rainfall$x^2; rainfall$x3&lt;- rainfall$x^3
  toxo.np3&lt;- alldist(cbind(Cases,Total-Cases) ~ x+x2+x3, random=~1, 
      random.distribution="np", family=binomial(link=logit), data=rainfall, k=3)
  toxo.np3x&lt;- alldist(cbind(Cases,Total-Cases) ~ x, random=~x, 
      random.distribution="np", family=binomial(link=logit), data=rainfall, k=3)
  # is the same as 
  toxo.np3x&lt;- alldist(Cases/Total ~ x, random = ~x, weights=Total, 
      family=binomial(link=logit), data=rainfall, k=3)
  # or
  toxo.np3x&lt;-update(toxo.np3, .~.-x2-x3, random = ~x)

# The fabric faults data
  data(fabric)
  coefficients(alldist(y ~ x, random=~1, family=poisson(link=log), 
      random.distribution="gq", data= fabric, k=3, verbose=FALSE))
  # (Intercept)           x           z 
  #  -3.3088663   0.8488060   0.3574909
  
# The Pennsylvanian hospital stay data
  data(hosp)
  fitnp3&lt;-  alldist(duration~age+temp1, data=hosp, k=3, family=Gamma(link=log),
      tol=0.5) 
  fitnp3$shape$shape
  # [1] 50.76636
  fitnp3&lt;-  alldist(duration~age+temp1, data=hosp, k=3, family=Gamma(link=log),
      tol=0.5, lambda=0.9) 
  fitnp3$shape$shapek
  # [1]  49.03101  42.79522 126.64077
  
# The Oxford boys data
  data(Oxboys, package="nlme")
  Oxboys$boy &lt;- gl(26,9)
  allvc(height~age, random=~1|boy, data=Oxboys, random.distribution='gq', k=20)
  allvc(height~age, random=~1|boy, data=Oxboys,random.distribution='np',k=8) 
  # with random coefficients:
  allvc(height~age,random=~age|boy, data=Oxboys, random.distribution='np', k=8)
    
# Irish suicide data
  data(irlsuicide)
  # Crude rate model:
  crude&lt;- allvc(death~sex* age, random=~1|ID, offset=log(pop), 
      k=3, data=irlsuicide, family=poisson) 
  crude$disparity 
  # [1] 654.021
  # Relative risk model:
  relrisk&lt;- allvc(death~1, random=~1|ID, offset=log(expected), 
      k=3, data=irlsuicide, family=poisson) 
  relrisk$disparity    
  # [1] 656.4955
  
</code></pre>

<hr>
<h2 id='dkern'>Aitchison-Aitken kernel</h2><span id='topic+dkern'></span>

<h3>Description</h3>

<p>Discrete kernel for categorical data  with <code>k</code> unordered categories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dkern(x, y, k, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dkern_+3A_x">x</code></td>
<td>
<p>categorical data vector</p>
</td></tr>
<tr><td><code id="dkern_+3A_y">y</code></td>
<td>
<p>postive integer defining a fixed category</p>
</td></tr>
<tr><td><code id="dkern_+3A_k">k</code></td>
<td>
<p>positive integer giving the number of categories</p>
</td></tr>
<tr><td><code id="dkern_+3A_lambda">lambda</code></td>
<td>
<p>smoothing parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This kernel was introduced in Aitchison &amp; Aitken (1976); see also Titterington (1980). 
</p>
<p>The setting <code>lambda =1/k</code> corresponds to the extreme case 'maximal smoothing',
while <code>lambda = 1</code> means &lsquo;no smoothing&rsquo;. Statistically sensible settings are 
only <code>1/k</code><code class="reqn">\le</code> <code>lambda</code> <code class="reqn">\le</code><code>1</code>. 
</p>


<h3>Author(s)</h3>

<p> Jochen Einbeck (2006)</p>


<h3>References</h3>

 
<p>Aitchison, J. and Aitken, C.G.G. (1976). Multivariate binary discrimination by kernel 
method. Biometrika 63, 413-420. 
</p>
<p>Titterington, D. M. (1980). A comparative study of kernel-based density estimates for
categorical data.  Technometrics, 22, 259-268.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
k&lt;-6; 
dkern(1:k,4,k,0.99)   
# Kernel centered at the 4th component with a very small amount of smoothing.


## The function is currently defined as
function(x,y,k,lambda){
ifelse(y==x, lambda, (1-lambda)/(k-1))
  }
</code></pre>

<hr>
<h2 id='fabric'> The Fabric Data </h2><span id='topic+fabric'></span>

<h3>Description</h3>

<p>The data are 32 observations on faults in rolls of fabric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fabric)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 3 variables.
</p>

<dl>
<dt>leng</dt><dd><p>the length of the roll : a  numeric vector</p>
</dd>
<dt>y</dt><dd><p>the number of faults in the roll of fabric  : a  discrete vector</p>
</dd>
<dt>x</dt><dd><p>the log of the length of the roll : a  numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are 32 observations on faults in rolls of fabric taken from Hinde (1982) 
who used the EM algorithm to fit a Poisson-normal model. 
The response variable is the number of faults in the roll of fabric and the explanatory variable is the log of the length of the roll. 
</p>


<h3>Note</h3>

<p>This data set and help file is an identical copy
of the <code>fabric</code> data in package <span class="pkg">gamlss.data</span>.
</p>


<h3>Source</h3>

<p>John Hinde. 
</p>


<h3>References</h3>

<p>Hinde,  J. (1982) Compound Poisson regression models: in <em>GLIM</em> 82, <em>Proceedings of the
International Conference on Generalized Linear Models</em>, ed. Gilchrist, R., 109&ndash;121, Springer: New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fabric)
attach(fabric)
plot(x,y)
detach(fabric)
</code></pre>

<hr>
<h2 id='family.glmmNPML'>Methods for objects of class glmmNPML or glmmGQ</h2><span id='topic+family.glmmNPML'></span><span id='topic+family.glmmGQ'></span><span id='topic+model.matrix.glmmNPML'></span><span id='topic+model.matrix.glmmGQ'></span>

<h3>Description</h3>

<p>Methods for the generic <code>family</code> and <code>model.matrix</code> functions 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmmNPML'
family(object, ...)
## S3 method for class 'glmmGQ'
family(object, ...)
## S3 method for class 'glmmNPML'
model.matrix(object, ...)
## S3 method for class 'glmmGQ'
model.matrix(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="family.glmmNPML_+3A_object">object</code></td>
<td>
<p> object of class <code>glmmNPML</code> or <code>glmmGQ</code>. </p>
</td></tr>
<tr><td><code id="family.glmmNPML_+3A_...">...</code></td>
<td>
<p> further arguments, ensuring compability with generic functions. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The generic <span class="rlang"><b>R</b></span> functions <code>update()</code>, <code>coefficients()</code>,  <code>coef()</code>, 
<code>fitted()</code>, <code>fitted.values()</code>, and <code>df.residual()</code>
can also be applied straightforwardly on all objects of 
class <code>glmmNPML</code> or <code>glmmGQ</code>.  They are not listed above as they use
the generic default functions  and are not separately implemented.
</p>
<p>Explicit implementations exist for <code>predict</code>,  <code>summary</code>, 
<code>print</code>, and <code>plot</code>, and these functions are explained in the corresponding
help files.   
</p>


<h3>Author(s)</h3>

<p>Jochen Einbeck and John Hinde (2007)</p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.glmmNPML">summary.glmmNPML</a></code>, <code><a href="#topic+predict.glmmNPML">predict.glmmNPML</a></code>, 
<code><a href="stats.html#topic+family">family</a></code>, <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, <code><a href="stats.html#topic+update">update</a></code>, 
<code><a href="stats.html#topic+coefficients">coefficients</a></code>, <code><a href="#topic+alldist">alldist</a></code>.  
</p>

<hr>
<h2 id='gqz'>Gauss-Hermite integration points</h2><span id='topic+gqz'></span>

<h3>Description</h3>

<p>Calculate Gaussian Quadrature points for the Normal distribution 
using the abscissas and weights for Hermite integration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gqz(numnodes=20, minweight=0.000001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gqz_+3A_numnodes">numnodes</code></td>
<td>
<p>theoretical number of quadrature points.</p>
</td></tr>
<tr><td><code id="gqz_+3A_minweight">minweight</code></td>
<td>
<p>locations with weights that are less than this value will be omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The  conversion of the locations and weights is given in Lindsey (1992,
page 169:3) and Skrondal &amp; Rabe-Hesketh (2004, page 165:1).
The argument numnodes is the theoretical number of quadrature points,
locations with weights that are less than the argument <code>minweight</code> will
be omitted. The default value of <code>minweight=0.000001</code> returns 14 masspoints 
for the default <code>numnodes=20</code> as in Aitkin, Francis &amp; Hinde (2005).
</p>


<h3>Value</h3>

<p>A list with two vectors: 
</p>
<table>
<tr><td><code>location</code></td>
<td>
<p>locations of mass points</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>masses</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nick Sofroniou (2005) 
</p>


<h3>References</h3>

 
<p>Aitkin, M., Francis, B. and Hinde, J. (2005). Statistical Modelling in GLIM 4. 
Second Edition, Oxford Statistical Science Series, Oxford, UK. 
</p>
<p>Lindsey, J. K. (1992). The Analysis of Stochastic Processes using GLIM.
Berlin: Springer-Verlag.
</p>
<p>Skrondal, A. and Rabe-Hesketh, S. (2004). Generalized
latent variable modelling. Boca Raton: Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gqz(20, minweight=1e-14)
  # gives k=20 GH integration points. These are used in alldist  
  # and allvc as fixed mass point locations when working with 
  # option random.distribution='gq', and serve as EM starting points 
  # otherwise. 
</code></pre>

<hr>
<h2 id='hosp'>The Pennsylvanian Hospital Stay Data </h2><span id='topic+hosp'></span>

<h3>Description</h3>

<p>The data, 25 observations, are a subset from a larger data set collected 
on persons discharged from a selected Pennsylvania hospital as part of a 
retrospective chart review of antibiotic use in hospitals (Towensend et al., 
1979, Rosner, 2000). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hosp)</code></pre>


<h3>Format</h3>

<p>A data frame with 25 observations on the following 9 variables. All variables 
are given as numerical vectors.
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient ID.</p>
</dd>
<dt><code>duration</code></dt><dd><p>the total number of days patients 
spent in hospital.</p>
</dd>
<dt><code>age</code></dt><dd><p>age of patient in whole years.</p>
</dd>
<dt><code>sex</code></dt><dd><p>gender: 1=M, 2=F.</p>
</dd>
<dt><code>temp1</code></dt><dd><p>first temperature following admission.</p>
</dd>
<dt><code>wbc1</code></dt><dd><p>first WBC count (<code class="reqn">\times 10^3</code>) following admission. [WBC= white blood cells]. </p>
</dd>
<dt><code>antib</code></dt><dd><p>received antibiotic: 1=yes, 2=no. </p>
</dd>
<dt><code>bact</code></dt><dd><p>received bacterial culture: 1=yes, 2=no. </p>
</dd>
<dt><code>serv</code></dt><dd><p>service: 1 =med., 2=surg.</p>
</dd>
</dl>



<h3>Warnings</h3>

<p>Don't confuse with the Barcelona 'Hospital stay data' <code>aep</code>  in package <span class="pkg">gamlss</span>. 
</p>


<h3>Source</h3>

<p>B. Rosner, Harvard University. 
</p>


<h3>References</h3>

<p>Rosner, B. (2000). Fundamentals of Biostatistics. Thomson Learning, Duxbury, CA, USA. 
</p>
<p>Townsend, T.R., Shapiro, M., Rosner, B., &amp; Kass, E. H. (1979). Use of antimicrobial drugs in general hospitals. I. Description of population and definition of methods. Journal of Infectious Diseases 139 , 688-697. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hosp)
glm1&lt;- glm(duration~age+temp1+wbc1, data=hosp, family=Gamma(link=log))
</code></pre>

<hr>
<h2 id='irlsuicide'>Irish Suicide Data</h2><span id='topic+irlsuicide'></span>

<h3>Description</h3>

<p>Suicide Rates in the Republic of Ireland 1989-1998.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(irlsuicide)</code></pre>


<h3>Format</h3>

<p>A data frame with 104 observations on the following 8 variables.
</p>

<dl>
<dt><code>Region</code></dt><dd><p>a factor with levels <code>Cork </code>, <code>Dublin </code>, <code>EHB - Dub.</code>, <code>Galway</code>, <code>Lim.</code>, <code>Mid HB</code>, <code>MWHB-Lim.</code>, <code>NEHB</code>, <code>NWHB</code>, <code>SEHB-Wat.</code>, <code>SHB-Cork</code>, <code>Waterf.</code>, <code>WHB-Gal.</code>.</p>
</dd>
<dt><code>ID</code></dt><dd><p>a factor with levels <code>1</code> <code>2</code> <code>3</code> <code>4</code> <code>5</code> <code>6</code> <code>7</code> <code>8</code> <code>9</code> <code>10</code> <code>11</code> <code>12</code> <code>13</code> corresponding to Regions.</p>
</dd>
<dt><code>pop</code></dt><dd><p>a numeric vector giving the population sizes (estimated for 1994).</p>
</dd>
<dt><code>death</code></dt><dd><p>a numeric vector giving the total number of deaths.</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor for gender with levels <code>0</code> (female) and <code>1</code> (male).</p>
</dd>
<dt><code>age</code></dt><dd><p>a factor for age with levels <code>1</code> (0-29),  <code>2</code> (30-39), <code>3</code> (40-59), <code>4</code> (60+ years).</p>
</dd>
<dt><code>smr</code></dt><dd><p>a numeric vector with standardized mortality  ratios (SMRs) </p>
</dd>
<dt><code>expected</code></dt><dd><p>a numeric vector with &lsquo;expected&rsquo; number of cases obtained from a reference population (Ahlbom, 1993).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set is  examined in Sofroniou et al. (2006), using a variance component model 
with regions as upper level.   
</p>


<h3>Source</h3>

<p>Institute of Public Health in Ireland (2005). All
Ireland Mortality Database. Retrieved August 8, 2005.
</p>


<h3>References</h3>

<p>Ahlbom, A.,  (1993). Biostatistics for Epidemiologists. Boca Raton: Lewis Publishers.
</p>
<p>Sofroniou, N., Einbeck, J., and Hinde, J. (2006). Analyzing Irish Suicide Rates with Mixture Models.
Proceedings of the 21st Workshop on Statistical Modelling in Galway, Ireland, 2006. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(irlsuicide)
library(lattice)
trellis.device(color=FALSE)
plot2age&lt;-rep(gl(4,2),13)
xyplot(irlsuicide$death/irlsuicide$pop~plot2age|irlsuicide$Region, 
    pch=(1+(irlsuicide$sex==1)),xlab="age",ylab="Crude rates")


</code></pre>

<hr>
<h2 id='missouri'>Missouri lung cancer data</h2><span id='topic+missouri'></span>

<h3>Description</h3>

<p>Lung cancer mortality in the 84 largest Missouri cities, for males aged 45-54, 1972-1981. 
Data presented in Tsutakawa (1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(missouri)</code></pre>


<h3>Format</h3>

<p>A data frame with 84 observations on the following 2 variables.
</p>

<dl>
<dt><code>Size</code></dt><dd><p>population of the city.</p>
</dd>
<dt><code>Deaths</code></dt><dd><p>number of lung cancer deaths.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data set was analyzed using a Poisson model with normal random effect in 
Tsutakawa (1985), and using a binomial logit model with unspecified random effect 
distribution  in Aitkin (1996b). Aitkin fitted this model with GLIM4. 
</p>


<h3>Source</h3>

<p>Tsutakawa, R. (1985).
</p>


<h3>References</h3>

<p>Aitkin, M. (1996b). Empirical Bayes shrinkage using posterior random effect means from nonparametric maximum likelihood estimation in general random effect models. Statistical Modelling: Proceedings of the 11th IWSM 1996, 87-94. 
</p>
<p>Tsutakawa, R. (1985). Estimation of Cancer Mortalilty Rates: 
A Bayesian Analysis of Small Frequencies.  Biometrics 41, 69-79. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(missouri)
alldist(Deaths~1, offset=log(Size), random=~1, k=2,
   family=poisson(link='log'), data=missouri)
</code></pre>

<hr>
<h2 id='plot.glmmNPML'> Plot Diagnostics for objects of class glmmNPML or glmmGQ</h2><span id='topic+plot.glmmNPML'></span><span id='topic+plot.glmmGQ'></span>

<h3>Description</h3>

<p>The functions <code>alldist</code>  and <code>allvc</code>   produce  
objects of type <code>glmmGQ</code>, if Gaussian quadrature (Hinde, 1982, 
<code>random.distribution="gq"</code>) was applied for computation, and  objects
of class <code>glmmNPML</code>, if parameter estimation was carried out by nonparametric
maximum likelihood (Aitkin, 1996a, <code>random.distribution="np"</code>). 
The functions presented here give some useful diagnostic plotting functionalities 
to analyze these objects. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmmNPML'
plot(x, plot.opt = 15, noformat=FALSE, ...)
## S3 method for class 'glmmGQ'
plot(x, plot.opt = 3, noformat=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.glmmNPML_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>glmmNPML</code> or <code>glmmGQ</code>.   </p>
</td></tr>
<tr><td><code id="plot.glmmNPML_+3A_plot.opt">plot.opt</code></td>
<td>
<p>an integer with values <code class="reqn">0 \le</code> <code>plot.opt</code> <code class="reqn">\le 15</code>. </p>
</td></tr>
<tr><td><code id="plot.glmmNPML_+3A_noformat">noformat</code></td>
<td>
<p>if <code>TRUE</code>, then any formatting of the plots is omitted (useful if the user wants to include the plots into a panel of several other plots, possibly generated by other functions).</p>
</td></tr>
<tr><td><code id="plot.glmmNPML_+3A_...">...</code></td>
<td>
<p>further arguments which will mostly not have any effect 
(and are included only to ensure compatibility with the 
generic <code>plot()</code>- function.)  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the help pages to alldist and the vignette (Einbeck &amp; Hinde, 2007). 
It is sufficient to write <code>plot</code> instead of <code>plot.glmmNPML</code> or <code>plot.glmmGQ</code>,
since the generic <code>plot</code> function provided in <span class="rlang"><b>R</b></span> automatically selects the right model class. 
</p>


<h3>Value</h3>

<p>For class <code>glmmNPML</code>: Depending on the choice of <code>plot.opt</code>, a subset
of the following four plots:
</p>
<table>
<tr><td><code>1</code></td>
<td>
<p>Disparity trend.</p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p>EM Trajectories.</p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p>Empirical Bayes Predictions against observed response.</p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p>Individual posterior probabilities.</p>
</td></tr>
</table>
<p>The number given in <code>plot.opt</code> is transformed into a binary
number indicating which plots are to be selected. The first digit
(from the right!) refers to plot 1, the second one to plot 2, and so on.
For example, <code>plot.opt=4</code> gives the binary number 0100 and hence selects
just plot 3.
</p>
<p>For class <code>glmmGQ</code>: Depending on the choice of plot.opt,
a subset of  plots  1 and 3. Again, the number is transformed into binary coding, yielding only the
disparity trend for <code>plot.opt=1</code>, only the EBP's for <code>plot.opt=2</code>,
and both plots for <code>plot.opt=3</code>.
</p>


<h3>Author(s)</h3>

<p> Jochen Einbeck and John Hinde (2007) </p>


<h3>References</h3>

<p>Aitkin, M. (1996a). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing 6, 251-262. 
</p>
<p>Einbeck, J., and Hinde, J.: Nonparametric maximum likelihood estimation for random effect models in R. Vignette to R package  <span class="pkg">npmlreg</span>. 
Type <code>vignette("npmlreg-v")</code> to open it.
</p>
<p>Hinde, J. (1982). Compound Poisson regression models. Lecture Notes in Statistics 14, 109-121. 
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(galaxies, package="MASS")
gal&lt;-as.data.frame(galaxies)
galaxy.np4u &lt;- alldist(galaxies/1000~1,random=~1,k=4,tol=0.5,data=gal,lambda=1)
predict(galaxy.np4u, type="response") # EBP on scale of responses

plot(galaxy.np4u,  plot.opt=4) # plots only EBP vs.  response
plot(galaxy.np4u,  plot.opt=3) # gives same output as given by default when executing alldist
plot(galaxy.np4u)              # gives all four plots.
</code></pre>

<hr>
<h2 id='post'>Posterior probabilities/intercepts, and mass point classifications</h2><span id='topic+post'></span>

<h3>Description</h3>

<p>Takes an object of class <code>glmmNPML</code> or <code>glmmGQ</code> and displays the 
posterior probabilites <code class="reqn">w_{ik}</code> as well as  the posterior intercepts 
(Sofroniou et. al, 2006). Further it classfies the observations to mass points 
according to their  posterior probability. The level on which the information 
in all three cases is displayed can be chosen by the user via the <code>level</code> 
argument (<code>"upper"</code> or <code>"lower"</code>). The actual information in both cases is 
identical, the latter is just an  expanded version of the former. In case of 
simple overdispersion models, the  <code>level</code> argument is not relevant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post(object, level="upper")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_+3A_object">object</code></td>
<td>
<p>an object of class <code>glmmNPML</code> or <code>glmmGQ</code>. </p>
</td></tr>
<tr><td><code id="post_+3A_level">level</code></td>
<td>
 <p><code>"upper"</code> or <code>"lower"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following four items:
</p>
<table>
<tr><td><code>prob</code></td>
<td>
<p>posterior probabilities (identical to <code>object$post.prob</code> 
in case of <code>"lower"</code> and for one-level models).</p>
</td></tr>
<tr><td><code>int</code></td>
<td>
<p>posterior intercepts (identical to <code>object$post.int</code> 
in case of <code>"lower"</code> and for one-level models).</p>
</td></tr>
<tr><td><code>classif</code></td>
<td>
<p>a numerical vector containing the class numbers (the order of the classes corresponds to the 
order of the mass points given in the output of <code>alldist</code> or <code>allvc</code>).</p>
</td></tr> 
<tr><td><code>level</code></td>
<td>
<p>either <code>"lower"</code>, <code>"upper"</code>, or <code>"none"</code> (for one-level models).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jochen Einbeck and John Hinde (2006) </p>


<h3>References</h3>

<p>Sofroniou, N., Einbeck, J., and Hinde, J. (2006). Analyzing Irish suicide rates with mixture models. Proceedings of the 21st International Workshop on Statistical Modelling in Galway, Ireland, 2006. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'> data(galaxies, package="MASS")
 gal &lt;- as.data.frame(galaxies)
 post(alldist(galaxies/1000~1, random=~1, data=gal, k=5))$classif
    # classifies the 82 galaxies to one of the five mass points
 </code></pre>

<hr>
<h2 id='predict.glmmNPML'>Prediction from objects of class glmmNPML or glmmGQ </h2><span id='topic+predict.glmmNPML'></span><span id='topic+predict.glmmGQ'></span>

<h3>Description</h3>

<p>The functions <code>alldist</code> and <code>allvc</code> produce objects of type <code>glmmGQ</code>,
if Gaussian quadrature (Hinde, 1982, <code>random.distribution="gq"</code> ) 
was applied for computation, and objects of class <code>glmmNPML</code>, if 
parameter estimation was carried out by nonparametric maximum likelihood 
(Aitkin, 1996a, <code>random.distribution="np"</code> ). The functions presented here
give predictions from those objects.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmmNPML'
predict(object, newdata, type = "link", ...)
## S3 method for class 'glmmGQ'
predict(object, newdata, type = "link", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.glmmNPML_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code>glmmNPML</code> or <code>glmmGQ</code>. </p>
</td></tr>
<tr><td><code id="predict.glmmNPML_+3A_newdata">newdata</code></td>
<td>
<p>a data frame with covariates from which prediction is desired. 
If omitted, empirical Bayes predictions for the original data will be given.  </p>
</td></tr>
<tr><td><code id="predict.glmmNPML_+3A_type">type</code></td>
<td>
<p>if set to <code>link</code>, the prediction is given on the linear predictor scale.
If set to <code>response</code>, prediction is given on the scale of the responses. </p>
</td></tr>
<tr><td><code id="predict.glmmNPML_+3A_...">...</code></td>
<td>
<p>further arguments which will mostly not have any effect (and are 
included only to ensure compatibility 
with the generic <code>predict()</code>- function.)  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predicted values are obtained by 
</p>

<ul>
<li><p> Empirical Bayes (Aitkin, 1996b), if <code>newdata</code> has not been specified.
That is, the prediction on the linear predictor scale is given by 
<code class="reqn">\sum{\eta_{ik}w_{ik}} </code>, 
whereby <code class="reqn">\eta_{ik}</code> are the fitted linear predictors, 
<code class="reqn">w_{ik}</code> are the weights in the final iteration of the EM algorithm
(corresponding to the posterior probability for observation <code class="reqn">i</code> 
to come from component <code class="reqn">k</code> ), and the sum is taken over the number
of components <code class="reqn">k</code> for fixed <code class="reqn">i</code>. 
</p>
</li>
<li><p> the marginal model, if object is of class <code>glmmNPML</code> and 
<code>newdata</code> has been specified. That is, computation is identical as above, but
with <code class="reqn">w_{ik}</code> replaced by the masses <code class="reqn">\pi_k</code> of the fitted model. 
</p>
</li>
<li><p> the analytical expression for the marginal mean of the responses, 
if object is of class <code>glmmGQ</code> and <code>newdata</code> has been specified. 
See Aitkin et al. (2009), p. 481, for the formula. This method is only
supported for the logarithmic link function, as otherwise no analytical
expression for the marginal mean of the responses exists.  
</p>
</li></ul>

<p>It is sufficient to call <code>predict</code> instead of <code>predict.glmmNPML</code> or 
<code>predict.glmmGQ</code>, since the generic predict function provided in <span class="rlang"><b>R</b></span> automatically selects the right 
model class.
</p>


<h3>Value</h3>

<p>A vector of predicted values.
</p>


<h3>Note</h3>

<p>The results of the generic <code>fitted()</code> method 
correspond to <code>predict(object, type="response")</code>.  Note that, as we are 
working with random effects, fitted values are never really &lsquo;fitted&rsquo; but rather 
&lsquo;predicted&rsquo;.    
</p>


<h3>Author(s)</h3>

<p>Jochen Einbeck and John Hinde (2007).</p>


<h3>References</h3>

<p>Aitkin, M. (1996a). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing 6, 251-262. 
</p>
<p>Aitkin, M. (1996b). Empirical Bayes shrinkage using posterior random effect means from nonparametric maximum likelihood estimation in general random effect models. Statistical Modelling: Proceedings of the 11th IWSM 1996, 87-94. 
</p>
<p>Aitkin, M., Francis, B. and Hinde, J. (2009). Statistical Modelling in R. Oxford Statistical Science Series, Oxford, UK. 
</p>
<p>Hinde, J. (1982). Compound Poisson regression models. Lecture Notes in Statistics 14, 109-121. 
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Toxoplasmosis data:
    data(rainfall)
    rainfall$x&lt;-rainfall$Rain/1000
    toxo.0.3x&lt;- alldist(cbind(Cases,Total-Cases)~1, random=~x,
          data=rainfall, k=3, family=binomial(link=logit))
    toxo.1.3x&lt;- alldist(cbind(Cases,Total-Cases)~x, random=~x, 
          data=rainfall, k=3, family=binomial(link=logit))
    predict(toxo.0.3x, type="response", newdata=data.frame(x=2))
    # [1] 0.4608
    predict(toxo.1.3x, type="response", newdata=data.frame(x=2))
    # [1] 0.4608
    # gives the same result, as both models are equivalent and only differ
    # by a  parameter transformation.

# Fabric faults data:
    data(fabric)
    names(fabric) 
    # [1] "leng" "y"    "x"    
    faults.g2&lt;- alldist(y ~ x, family=poisson(link=log), random=~1, 
        data= fabric,k=2, random.distribution="gq") 
    predict(faults.g2, type="response",newdata=fabric[1:6,])
    # [1]  8.715805 10.354556 13.341242  5.856821 11.407828 13.938013
    # is not the same as
    predict(faults.g2, type="response")[1:6]
    # [1]  6.557786  7.046213 17.020242  7.288989 13.992591  9.533823
    # since in the first case prediction is done using the analytical 
    # mean of the marginal distribution, and in the second case  using the
    # individual posterior probabilities in an  empirical Bayes approach. 


</code></pre>

<hr>
<h2 id='rainfall'>Rainfall data</h2><span id='topic+rainfall'></span>

<h3>Description</h3>

<p>Toxoplasmosis data. <br />
The <code>rainfall</code> data frame has 34 rows and 3 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rainfall)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Rain</dt><dd><p>mm of rain</p>
</dd>
<dt>Cases</dt><dd><p>cases of toxoplasmosis</p>
</dd>
<dt>Total</dt><dd><p>total</p>
</dd>
</dl>



<h3>Source</h3>

<p>Luca Scrucca; originally in R package forward</p>


<h3>References</h3>

<p>Atkinson, A.C. and Riani, M. (2000),  <em>Robust Diagnostic Regression Analysis</em>, First Edition. New York: Springer, Table A.22</p>

<hr>
<h2 id='summary.glmmNPML'>Summarizing finite mixture regression fits</h2><span id='topic+print.glmmNPML'></span><span id='topic+print.glmmGQ'></span><span id='topic+summary.glmmNPML'></span><span id='topic+summary.glmmGQ'></span>

<h3>Description</h3>

<p>These functions are the <code>summary</code> and <code>print</code> methods for objects of  type
<code>glmmNPML</code> and <code>glmmGQ</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmmNPML'
summary(object, digits = max(3, getOption("digits") - 3), ...)
## S3 method for class 'glmmGQ'
summary(object, digits = max(3, getOption("digits") - 3), ...)
## S3 method for class 'glmmNPML'
print(x, digits=max(3,getOption('digits')-3), ...)
## S3 method for class 'glmmGQ'
print(x, digits=max(3,getOption('digits')-3),  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.glmmNPML_+3A_object">object</code></td>
<td>
<p>a fitted object of class <code>glmmNPML</code> or <code>glmmGQ</code>.   </p>
</td></tr>
<tr><td><code id="summary.glmmNPML_+3A_x">x</code></td>
<td>
<p>a fitted object of class <code>glmmNPML</code> or <code>glmmGQ</code>. </p>
</td></tr>
<tr><td><code id="summary.glmmNPML_+3A_digits">digits</code></td>
<td>
<p>number of digits; applied on various displayed quantities.</p>
</td></tr>
<tr><td><code id="summary.glmmNPML_+3A_...">...</code></td>
<td>
<p>further arguments, which will mostly be ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>summary...</code>- and <code>print...</code> -functions invoke the generic 
<code>UseMethod(...)</code> function and detect the right model class
automatically.  In other words, it is enough to write
<code>summary(...)</code> or <code>print(...)</code>.
</p>


<h3>Value</h3>

<p>Prints regression output or summary on screen.
</p>
<p>Objects returned by <code>summary.glmmNPML</code>  or  <code>summary.glmmGQ</code> are 
essentially identical to objects of class <code>glmmNPML</code> or <code>glmmGQ</code>.
However,  their <code>$coef</code> component contains the parameter standard errors 
and t values (taken from the GLM fitted in the last EM iteration),  and they 
have two additional components <code>$dispersion</code> and <code>$lastglmsumm</code> 
providing the estimated dispersion parameter and a summary of the <code>glm</code> 
fitted in the last EM iteration.
</p>


<h3>Note</h3>

<p>Please note that the provided parameter standard errors tend to be
underestimated as the uncertainty due to the EM algorithm is not
incorporated into them.  According to Aitkin et al (2009), Section 7.5, page
440, more accurate standard errors can be obtained by dividing the
(absolute value of the) parameter estimate through the square root of
the change in disparity when omitting/not omitting the variable from the model.
</p>


<h3>Author(s)</h3>

<p>originally from Ross Darnell (2002), modified and prepared for 
publication by Jochen Einbeck and John Hinde (2007).</p>


<h3>References</h3>

 
<p>Aitkin, M., Francis, B. and Hinde, J. (2009). Statistical Modelling in R. Oxford Statistical Science Series, Oxford, UK. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code>, <code><a href="base.html#topic+summary">summary</a></code>, 
<code><a href="base.html#topic+print">print</a></code>, <code><a href="#topic+family.glmmNPML">family.glmmNPML</a></code> </p>

<hr>
<h2 id='tolfind'> Grid search over tol for NPML estimation of (generalized) random effect models</h2><span id='topic+tolfind'></span>

<h3>Description</h3>

<p>Performs a grid search to select the parameter  <code>tol</code>, 
which is a tuning parameter for starting point selection of the EM algorithm 
for NPML estimation (see e.g. Aitkin, Hinde &amp; Francis, 2009, p. 437)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tolfind(formula, 
        random = ~1, 
        family = gaussian(), 
        data, 
        k = 4, 
        random.distribution="np",
        offset, 
        weights, 
        na.action, 
        EMmaxit = 500, 
        EMdev.change = 0.001, 
        lambda = 0, 
        damp = TRUE, 
        damp.power = 1, 
        spike.protect = 1, 
        sdev,
        shape, 
        plot.opt = 1, 
        steps = 15, 
        find.in.range = c(0.05, 0.8), 
        verbose = FALSE, 
        noformat = FALSE,
        ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tolfind_+3A_formula">formula</code></td>
<td>
<p>a formula defining the response and the fixed effects (e.g. <code>y ~ x</code>). </p>
</td></tr>
<tr><td><code id="tolfind_+3A_random">random</code></td>
<td>
<p>a formula defining the random model. Set <code>random=~1</code>
to model overdispersion. </p>
</td></tr>
<tr><td><code id="tolfind_+3A_family">family</code></td>
<td>
<p>conditional distribution of responses: &quot;gaussian&quot;,
&quot;poisson&quot;, &quot;binomial&quot;,  &quot;Gamma&quot;, or &quot;inverse.gaussian&quot; can be set.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_data">data</code></td>
<td>
<p>the data frame (mandatory, even if it is attached to the workspace!).  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_k">k</code></td>
<td>
<p>the number of mass points/integration points (supported are 
up to 600 mass points). </p>
</td></tr>
<tr><td><code id="tolfind_+3A_random.distribution">random.distribution</code></td>
<td>
<p>the mixing distribution, Gaussian Quadrature 
(<code>gq</code>) or NPML (<code>np</code>) can be set.   </p>
</td></tr>    
<tr><td><code id="tolfind_+3A_offset">offset</code></td>
<td>
<p>an optional offset to be included in the model.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_weights">weights</code></td>
<td>
<p>optional prior weights for the data.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_na.action">na.action</code></td>
<td>
<p>a function indicating what should happen when <code>NA</code>'s occur,
with possible arguments <code>na.omit</code> and <code>na.fail</code>. The default is 
set by the <code>na.action</code> setting in <code>options()</code> .   </p>
</td></tr>
<tr><td><code id="tolfind_+3A_emmaxit">EMmaxit</code></td>
<td>
<p>maximum number of EM iterations.  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_emdev.change">EMdev.change</code></td>
<td>
<p>stops EM algorithm when deviance change falls below this value.  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_lambda">lambda</code></td>
<td>
<p>see the help file for <code>alldist</code>. </p>
</td></tr>
<tr><td><code id="tolfind_+3A_damp">damp</code></td>
<td>
<p> switches EM damping on or off.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_damp.power">damp.power</code></td>
<td>
<p>steers degree of damping. </p>
</td></tr>
<tr><td><code id="tolfind_+3A_spike.protect">spike.protect</code></td>
<td>
<p>see the help file for <code>alldist</code>. For unequal or 
smooth component dispersion parameters, the setting <code>spike.protect=1</code>
is strongly recommended.  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_sdev">sdev</code></td>
<td>
<p>optional fixed standard deviation for normal mixture.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_shape">shape</code></td>
<td>
<p>optional fixed shape parameter for Gamma and IG  mixtures.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_plot.opt">plot.opt</code></td>
<td>
<p>For <code>plot.opt=1</code> the EM trajectories are plotted, 
for <code>plot.opt=2</code> the development of the disparity <code class="reqn">-2\log L</code> over 
iteration number is plotted, for <code>plot.opt=3</code> both plots are shown, 
and for <code>plot.opt=0</code> none of them. </p>
</td></tr>
<tr><td><code id="tolfind_+3A_steps">steps</code></td>
<td>
<p>number of grid points for the search of <code>tol</code>.</p>
</td></tr>
<tr><td><code id="tolfind_+3A_find.in.range">find.in.range</code></td>
<td>
<p>range for the search of <code>tol</code>.  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_verbose">verbose</code></td>
<td>
<p>If set to <code>FALSE</code>, no printed output is given during 
execution of <code>alldist</code> or <code>allvc</code>.  </p>
</td></tr>
<tr><td><code id="tolfind_+3A_noformat">noformat</code></td>
<td>
<p>If <code>TRUE</code>, then any formatting of the plots is omitted.</p>
</td></tr>  
<tr><td><code id="tolfind_+3A_...">...</code></td>
<td>
<p>further arguments which will be ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EM algorithm for NPML estimation (Aitkin, 1996) uses the Gauss-Hermite masses 
and mass points as starting  points. The position of the starting points can be 
concentrated or extended by setting <code>tol</code> smaller or larger than 1, 
respectively. The tuning parameter <code>tol</code> is, as in GLIM4, responsible for this scaling. 
A careful selection of <code>tol</code> may be necessary for some data sets. 
The reason  is that NPML has a tendency to get stuck in local maxima, 
as the log-likelihhod function is not concave for fixed <code>k</code>  (Boehning, 1999).
</p>
<p>For Gaussian, Gamma, and IG mixtures this R implementation uses by default a damping 
procedure  in the first cycles of the EM algorithm (Einbeck &amp; Hinde, 2006), 
which stabilizes the algorithm and  makes it less sensitive to the optimal choice 
of <code>tol</code>.  Application of  <code>tolfind</code> to check that the optimal  solution has 
not been overlooked may  nevertheless be advisable. 
</p>
<p><code>tolfind</code> works for <code>alldist</code> and <code>allvc</code>. The <code>tolfind</code> function 
is mainly designed for NPML (<code>random.distribution="np"</code>). It
can also be applied to Gaussian Quadrature (<code>random.distribution="gq"</code>), 
though <code>tol</code> is of little importance for this and primarily influences 
the speed of convergence.
</p>


<h3>Value</h3>

<p>A list of 5 items: 
</p>
<table>
<tr><td><code>MinDisparity</code></td>
<td>
<p>the minimal disparity achieved (for which EM converged).</p>
</td></tr>
<tr><td><code>Mintol</code></td>
<td>
<p>the <code>tol</code> value at which this disparity is achieved.</p>
</td></tr>
<tr><td><code>AllDisparities</code></td>
<td>
<p>a vector containing all disparities calculated on the grid.</p>
</td></tr>
<tr><td><code>Alltol</code></td>
<td>
<p>all corresponding <code>tol</code> values making up the grid.</p>
</td></tr>
<tr><td><code>AllEMconverged</code></td>
<td>
<p>a vector of Booleans indicating 
if EM converged for the particular <code>tol</code> values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jochen Einbeck &amp; John Hinde (2006). 
</p>


<h3>References</h3>

 
<p>Aitkin, M. (1996). A general maximum likelihood analysis of overdispersion in generalized linear models. Statistics and Computing 6 , 251-262. 
</p>
<p>Aitkin, M., Francis, B. and Hinde, J. (2009). Statistical Modelling in R.  Oxford Statistical Science Series, Oxford, UK. 
</p>
<p>Boehning, D. (1999). Computer-Assisted Analysis of Mixtures and Applications. Meta-Analysis, Disease Mapping and others. Chapman &amp; Hall / CRC, Boca Raton, FL, USA.
</p>
<p>Einbeck, J. &amp; Hinde, J. (2006). A note on NPML estimation for exponential family regression models with unspecified dispersion parameter. Austrian Journal of Statistics 35, 233-243. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+alldist">alldist</a></code>, <code><a href="#topic+allvc">allvc</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(galaxies, package="MASS")
  gal&lt;-as.data.frame(galaxies)
  tolfind(galaxies/1000~1, random=~1, k=5, data=gal, lambda=1, damp=TRUE, 
      find.in.range=c(0,1), steps=10) 
  # Minimal Disparity: 380.1444 at tol= 0.5 
 </code></pre>

<hr>
<h2 id='weightslogl.calc.w'> Internal npmlreg functions </h2><span id='topic+weightslogl.calc.w'></span><span id='topic+expand'></span><span id='topic+expand.vc'></span><span id='topic+binomial.expand'></span>

<h3>Description</h3>

<p>These are not to be called by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightslogl.calc.w(p, fjk, weights)
expand(x, k)
expand.vc(x, ni)
binomial.expand(Y, k, w) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightslogl.calc.w_+3A_p">p</code></td>
<td>
<p> ... </p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_fjk">fjk</code></td>
<td>
<p> ... </p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_weights">weights</code></td>
<td>
<p> ...</p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_x">x</code></td>
<td>
<p> ...</p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_k">k</code></td>
<td>
<p> ... </p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_ni">ni</code></td>
<td>
<p> ... </p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_y">Y</code></td>
<td>
<p> ... </p>
</td></tr>
<tr><td><code id="weightslogl.calc.w_+3A_w">w</code></td>
<td>
<p> ... </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ross Darnell and Jochen Einbeck.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
