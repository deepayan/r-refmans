<!DOCTYPE html><html><head><title>Help for package TropFishR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TropFishR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alba'><p>Length-frequency data of the clam Abra alba</p></a></li>
<li><a href='#Bhattacharya'><p>Bhattacharya's method</p></a></li>
<li><a href='#bream'><p>bream data</p></a></li>
<li><a href='#catchCurve'><p>Catch curve</p></a></li>
<li><a href='#date2yeardec'><p>Date - Year conversion</p></a></li>
<li><a href='#ELEFAN'><p>ELEFAN</p></a></li>
<li><a href='#ELEFAN_GA'><p>ELEFAN_GA</p></a></li>
<li><a href='#ELEFAN_SA'><p>ELEFAN_SA</p></a></li>
<li><a href='#emperor'><p>Emperor data</p></a></li>
<li><a href='#gillnet'><p>Gillnet data</p></a></li>
<li><a href='#gillnetfit'><p>Millar's original gillnet selectivity fitting function</p></a></li>
<li><a href='#goatfish'><p>Yellowstriped goatfish data</p></a></li>
<li><a href='#growth_length_age'><p>Estimation of growth parameter using length-at-age data</p></a></li>
<li><a href='#growth_tagging'><p>Growth from tagging data</p></a></li>
<li><a href='#haddock'><p>Haddock data</p></a></li>
<li><a href='#hake'><p>Hake data</p></a></li>
<li><a href='#lfqCreate'><p>Create lfq data from length measurements</p></a></li>
<li><a href='#lfqFitCurves'><p>Fitting VBGF growth curves through lfq data</p></a></li>
<li><a href='#lfqModify'><p>Modify lfq data for further analysis</p></a></li>
<li><a href='#lfqRestructure'><p>Restructuring of length frequency data</p></a></li>
<li><a href='#M_empirical'><p>Empirical formulas for the estimation of natural mortality</p></a></li>
<li><a href='#plot.Bhattacharya'><p>Bhattacharya plot</p></a></li>
<li><a href='#plot.catchCurve'><p>Plotting catch curve</p></a></li>
<li><a href='#plot.lfq'><p>Plotting of length frequency data (with VBGF curves)</p></a></li>
<li><a href='#plot.predict_mod'><p>Plotting prediction models yield per recruit and Thompson &amp; Bell</p></a></li>
<li><a href='#plot.prod_mod'><p>Plotting production models</p></a></li>
<li><a href='#plot.prod_mod_ts'><p>Plotting time series production models</p></a></li>
<li><a href='#plot.recruitment'><p>Plot of recruitment patterns</p></a></li>
<li><a href='#plot.select'><p>Selectivity plot</p></a></li>
<li><a href='#plot.select_Millar'><p>Millar's selectivity plot</p></a></li>
<li><a href='#plot.VPA'><p>VPA plot</p></a></li>
<li><a href='#powell_wetherall'><p>Powell-Wetherall method</p></a></li>
<li><a href='#predict_mod'><p>Prediction models</p></a></li>
<li><a href='#prod_mod'><p>Production models</p></a></li>
<li><a href='#prod_mod_ts'><p>Production models with time series fitting</p></a></li>
<li><a href='#rcurves_Millar'><p>Predict gillnet selectivity (old Millar method)</p></a></li>
<li><a href='#recruitment'><p>Recruitment patterns</p></a></li>
<li><a href='#rtypes_Millar'><p>Millar's selectivity types</p></a></li>
<li><a href='#select'><p>Selectivity model</p></a></li>
<li><a href='#select_Millar'><p>Millar's selectivity model</p></a></li>
<li><a href='#select_ogive'><p>Selectivity patterns</p></a></li>
<li><a href='#shrimps'><p>Shrimp data</p></a></li>
<li><a href='#startingPoint2tanchor'><p>Convert FiSAT's starting point to t_anchor value</p></a></li>
<li><a href='#stock_sim'><p>Stock simulation</p></a></li>
<li><a href='#synCAA1'><p>Synthetic Catch-at-age data I</p></a></li>
<li><a href='#synCAA2'><p>Synthetic Catch-at-age data II</p></a></li>
<li><a href='#synCPUE'><p>Synthetical catch per unit of effort (CPUE) dataset</p></a></li>
<li><a href='#synLFQ1'><p>Synthetic length-frequency data I</p></a></li>
<li><a href='#synLFQ2'><p>Synthetic length frequency data II</p></a></li>
<li><a href='#synLFQ3'><p>Synthetic length frequency data III</p></a></li>
<li><a href='#synLFQ4'><p>Synthetic length-frequency data IV (with seasonal oscillation)</p></a></li>
<li><a href='#synLFQ5'><p>Synthetic length-frequency data V (without seasonal oscillation)</p></a></li>
<li><a href='#synLFQ6'><p>Synthetic length-frequency data VI (without seasonal oscillation)</p></a></li>
<li><a href='#synLFQ7'><p>Synthetic length-frequency data VII with seasonal oscillation</p></a></li>
<li><a href='#synLFQ8'><p>Synthetic length-frequency data VIII with variable harvest rate</p></a></li>
<li><a href='#tilapia'><p>Tilapia data</p></a></li>
<li><a href='#trammelnet'><p>Trammel net data</p></a></li>
<li><a href='#trawl_fishery_Java'><p>Data from the trawl fishery off the North coast of Java</p></a></li>
<li><a href='#VBGF'><p>Von Bertalanffy Growth function (VBGF)</p></a></li>
<li><a href='#VPA'><p>Virtual Population Analysis (VPA)</p></a></li>
<li><a href='#whiting'><p>Whiting data</p></a></li>
<li><a href='#yeardec2date'><p>Year - Date conversion</p></a></li>
<li><a href='#ypr'><p>Yield per recruit</p></a></li>
<li><a href='#ypr_sel'><p>Yield per recruit with selection ogive</p></a></li>
<li><a href='#Z_BevertonHolt'><p>Beverton &amp; Holt's Z-Equations</p></a></li>
<li><a href='#Z_CPUE'><p>Estimate Z from CPUE data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tropical Fisheries Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Tobias K. Mildenberger, Marc H. Taylor, Matthias Wolff</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tobias K. Mildenberger &lt;t.k.mildenberger@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, msm, reshape2, MASS, GenSA, GA, stats, utils,
propagate, parallel, doParallel</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Description:</td>
<td>A compilation of fish stock assessment methods for the
    analysis of length-frequency data in the context of data-poor
    fisheries. Includes methods and examples included in the FAO
    Manual by P. Sparre and S.C. Venema (1998), "Introduction to tropical fish
    stock assessment" (<a href="https://www.fao.org/documents/card/en/c/9bb12a06-2f05-5dcb-a6ca-2d6dd3080f65/">https://www.fao.org/documents/card/en/c/9bb12a06-2f05-5dcb-a6ca-2d6dd3080f65/</a>),
    as well as other more recent methods.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tokami/TropFishR/issues">https://github.com/tokami/TropFishR/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tokami/TropFishR">https://github.com/tokami/TropFishR</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>graphics, grDevices, knitr, rmarkdown, plyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-29 10:59:19 UTC; tobm</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-01 15:22:40 UTC</td>
</tr>
</table>
<hr>
<h2 id='alba'>Length-frequency data of the clam Abra alba</h2><span id='topic+alba'></span>

<h3>Description</h3>

<p>Length-frequency data of the clam Abra alba as presented
by Brey et al. (1988). Includes 7 approximately bi-monthly samplings of
A. alba binned into 14 length classes. The data is of class &quot;lfq&quot;, which
can be used used e.g. in functions estimating growth parameters:
<code><a href="#topic+ELEFAN">ELEFAN</a></code>, <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code> or
<code><a href="#topic+ELEFAN_GA">ELEFAN_GA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(alba)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988.
Electronic length frequency analysis: a revised and
expanded user's guide to ELEFAN 0, 1 and 2.
ICLARM Contrib. 261.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alba)

# plot raw catch frequencies
plot(alba, Fname = "catch")

# plot restructured frequencies
alba &lt;- lfqRestructure(alba, MA=5)
plot(alba, Fname = "rcounts")


# ELEFAN_SA fitting
set.seed(1)
fitSA &lt;- ELEFAN_SA(
  alba, seasonalised = TRUE,
  init_par = list(Linf=14.5, K=1.1, t_anchor=0.4, ts=0, C=0.2),
  low_par = list(Linf=13, K=0.7, t_anchor=0, ts=0, C=0),
  up_par = list(Linf=15.5, K=1.5, t_anchor=1, ts=1, C=1),
  SA_time = 60
)
unlist(fitSA$par)
fitSA$Rn_max

# plot ELEFAN_SA results
plot(alba, Fname = "catch", draw = FALSE)
lfqFitCurves(fitSA, col=2, par=fitSA$par, draw=TRUE)$Rn_max


</code></pre>

<hr>
<h2 id='Bhattacharya'>Bhattacharya's method</h2><span id='topic+Bhattacharya'></span>

<h3>Description</h3>

<p>Find relative frequencies and frequency distribution of distinct cohorts
in the observed length frequency distribution by resolving it into
Gaussian components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bhattacharya(param, n_rnorm = 1000, savePlots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bhattacharya_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>midLengths</code> midpoints of the length class as vector,
</p>
</li>
<li> <p><code>catch</code> a vector with the catch per length class or a matrix with
catches per length class of subsequent years;
</p>
</li></ul>
</td></tr>
<tr><td><code id="Bhattacharya_+3A_n_rnorm">n_rnorm</code></td>
<td>
<p>number of observations for the function <code><a href="stats.html#topic+rnorm">rnorm</a></code>. The
default is 1000.</p>
</td></tr>
<tr><td><code id="Bhattacharya_+3A_saveplots">savePlots</code></td>
<td>
<p>logical; indicating whether the analyis graphs should be recorded</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method includes the <code><a href="graphics.html#topic+identify">identify</a></code> function, which allows to
choose points on a graphical device manually. To stop this process please press
right mouse click on the graph, and in case you are working on a windows
maschine click on &quot;Stop&quot;. An error will be caused if the graphical device
is closed manually. After you have selected the points for regression analysis
you will be asked if you want to redo the selection or if you want to continue.
Please enter in the Console &quot;y&quot; for continuation if you are satisfied
with your selection and the corresponding Gaussian distribution or enter
&quot;redo&quot; if you want to repeat the selection procedure. This function
allows a maximum of 12 cohorts or seperate distributions in one sample. Please
find more details in the Vignette of this package or in the FAO manual by
Sparre and Venema (1998) (<strong>Section 3.4.1, p. 80</strong>).
</p>


<h3>Value</h3>

<p>A list with the input parameters and
</p>

<ul>
<li> <p><strong>regressionLines</strong> dataframe with intercept, slope, start and end points
of the regression lines,
</p>
</li>
<li> <p><strong>Lmean_SD_list</strong> dataframe with the mean length (Lmean), standard deviation (SD),
and seperation index (SI) for each cohort,
</p>
</li>
<li> <p><strong>bhat_results</strong> dataframe with the results of the Bhattacharya method,
</p>
</li>
<li> <p><strong>distributions</strong> list with the x and y values of selected distributions,
</p>
</li>
<li> <p><strong>cohort_plots</strong> list with analysis plots (when savePlots = TRUE).
</p>
</li></ul>



<h3>References</h3>

<p>Bhattacharya, C.G., 1967. A simple method of resolution of a distribution into Gaussian
components, <em>Biometrics</em>, 23:115-135
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following example requires to choose certain values for the regression analyses:
# first cohort:   point  2 to  8
# second cohort:  point 12 to 17
# third cohort:   point 19 to 23
# fourth cohort:  point 26 to 30


 data(synLFQ1)
 Bhattacharya(param = synLFQ1)


</code></pre>

<hr>
<h2 id='bream'>bream data</h2><span id='topic+bream'></span>

<h3>Description</h3>

<p>Data of a covered codend experimental catch of the species Threadfin bream
(<em>Nemipterus japonicus</em>) in South China Sea. This data can be analysed with
the function <code><a href="#topic+select">select</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bream)
</code></pre>


<h3>Format</h3>

<p>A list consiting of:
</p>

<ul>
<li> <p><code>midLengths</code>  the midlengths of size classes,
</p>
</li>
<li> <p><code>numCodend</code>  the number of fish retained in codend,
</p>
</li>
<li> <p><code>numCover</code>  the number of fish retained in cover,
</p>
</li>
<li> <p><code>msCodend</code>  the meshsize of codend.
</p>
</li></ul>



<h3>Source</h3>

<p>Jones, R., 1976. Mesh regulation in the demersal fisheries of the South
China Sea area. Manila, South China Sea Fisheries Development and Coordinating
Programme, SCS/76/WP/34: 75 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bream)
str(bream)
summary(bream)

</code></pre>

<hr>
<h2 id='catchCurve'>Catch curve</h2><span id='topic+catchCurve'></span>

<h3>Description</h3>

<p>This function applies the (length-converted) linearised catch
curve to age composition and length-frequency data,
respectively. It allows to estimate the instantaneous total mortality rate (Z).
Optionally, the gear selectivity can be estimated and the cumulative catch
curve cna be applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catchCurve(
  param,
  catch_columns = NA,
  cumulative = FALSE,
  calc_ogive = FALSE,
  reg_int = NULL,
  reg_num = 1,
  auto = FALSE,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catchCurve_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>midLengths</code> or <code>age</code>: midpoints of the length classes (length-frequency
data) or ages (age composition data),
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch,
</p>
</li>
<li> <p><code>catch</code>: catches, vector or matrix with catches of subsequent years if
the catch curve with constat time intervals should be applied;
</p>
</li></ul>
</td></tr>
<tr><td><code id="catchCurve_+3A_catch_columns">catch_columns</code></td>
<td>
<p>numerical; indicating the column of the catch matrix which should be
used for the analysis.</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_cumulative">cumulative</code></td>
<td>
<p>logical; if TRUE the cumulative
catch curve is applied (Jones and van Zalinge method)</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_calc_ogive">calc_ogive</code></td>
<td>
<p>logical; if TRUE the selection ogive is additionally
calculated from the catch curve (only if <code>cumulative = FALSE</code>)</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_reg_int">reg_int</code></td>
<td>
<p>instead of using the identity method a range can be determined,
which is to be used for the regression analysis. If equal to NULL identity method
is applied (default). For multiple regression lines provide list with the two points
for the regression line in each element of the list.</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_reg_num">reg_num</code></td>
<td>
<p>integer indicating how many separate regression lines should be applied to the
data. Default 1.</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_auto">auto</code></td>
<td>
<p>logical; no interactive functions used instead regression line is chosen
automatically. Default = FALSE</p>
</td></tr>
<tr><td><code id="catchCurve_+3A_plot">plot</code></td>
<td>
<p>logical; should a plot be displayed? Default = TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function includes the <a href="graphics.html#topic+identify">identify</a> function, which asks you to
choose two points from a graph manually. The two points which you choose by clicking
on the plot in the graphical device represent the start and end of the data points,
which should be used for the analysis. Based on these points the regression line
is calculated.
When the selection ogive
is calculated by means of the catch curve the assumption is made, that Z is constant
for all year classes or length groups, respectively. Accoring to Sparre and Venema
(1998) this assumption might be true, because F is smaller for young fish
(Selectivity) while M is higher for young fish (high natural mortality). The selectivity
for not fully exploited old fish (e.g. due to gillnet fishery) can not be calculated yet
by use of the catch curve.
Based on the format of the list argument <code>catch</code> and whether the argument
<code>catch_columns</code> is defined, the function automatically
distinguishes between the catch curve with variable parameter system (if catch is a
vector) and the one with constant parameter system (if catch is a matrix or a
data.frame and <code>catch_columns = NA</code>). In the case of the variable parameter
system the catches of one year are
assumed to represent the catches during the entire life span of a so called
pseudo-cohort.
The cumulative catch curve does not allow for the estimation of the selectivity
ogive.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>classes.num</strong>, <strong>tplusdt_2</strong>, <strong>t_midL</strong>, or
<strong>ln_Linf_L</strong>: age, relative age or subsitute depending on input and method,
</p>
</li>
<li> <p><strong>lnC</strong> or <strong>lnC_dt</strong>: logarithm of (rearranged) catches,
</p>
</li>
<li> <p><strong>reg_int</strong>: the interval used for the regression analysis,
</p>
</li>
<li> <p><strong>linear_mod</strong>: linear model used for the regression analysis,
</p>
</li>
<li> <p><strong>Z</strong>: instantaneous total mortality rate, confidenceInt
</p>
</li>
<li> <p><strong>se</strong>: standard error of the total mortality;
</p>
</li>
<li> <p><strong>confidenceInt</strong>: confidence interval of the total mortality;</p>
</li></ul>

<p>in case calc_ogive == TRUE, additionally:
</p>

<ul>
<li> <p><strong>intercept</strong>: intercept of regression analysis,
</p>
</li>
<li> <p><strong>linear_mod_sel</strong>: linear model used for the selectivity analysis,
</p>
</li>
<li> <p><strong>Sobs</strong>: observed selection ogive,
</p>
</li>
<li> <p><strong>ln_1_S_1</strong>: dependent variable of regression analysis for
selectivity parameters,
</p>
</li>
<li> <p><strong>Sest</strong>: estimated selection ogive,
</p>
</li>
<li> <p><strong>t50</strong>: age at first capture (age at which fish have a 50
probability to be caught),
</p>
</li>
<li> <p><strong>t75</strong>: age at which fish have a 75
</p>
</li>
<li> <p><strong>L50</strong>: length at first capture (length at which fish have a 50
probability to be caught),
</p>
</li>
<li> <p><strong>L75</strong>: length at which fish have a 75
</p>
</li></ul>



<h3>References</h3>

<p>Baranov, F.I., 1926. On the question of the dynamics of the fishing industry.
<em>Nauchn. Byull. Rybn. Khoz</em>, 8 (1925), 7-11
</p>
<p>Beverton, R.J.H. and S.J. Holt, 1956. A review of methods for estimating mortality
rates in exploited fish populations, with special reference to sources of bias in
catch sampling. <em>Rapports et Proces verbaux des Reunions</em>, Conseil Table3
</p>
<p>Chapman, D., and D.S Robson, 1960. The analysis of a catch curve.
<em>Biometrics</em>, 354-368
</p>
<p>Edser, T., 1908. Note on the number of plaice at each length, in certain samples
from the southern part of the North Sea, 1906. <em>Journal of the Royal
Statistical Society</em>, 686-690
</p>
<p>Heincke, F., 1913. Investigations on the plaice. General report. 1. The plaice fishery
and protective regulations. Part I. <em>Rapp.P.-v.Reun.CIEM</em>, 17A:1-153 + Annexes
</p>
<p>ICES, 1981. Report of the <em>Ad hoc</em> working group on the use of effort data in
assessment, Copenhagen, 2-6 March 1981. <em>ICES C.M.</em> 1981/G:5 (mimeo)
</p>
<p>Jones, R., and N.P. Van Zalinge, 1981. Estimates of mortality rate and population size
for shrimp in Kuwait waters. <em>Kuwait Bull. Mar. Sci</em>, 2, 273-288
</p>
<p>Pauly, D., 1983. Length-converted catch curves: a powerful tool for fisheries research
in the tropics (part I). <em>ICLARM Fishbyte</em>, 1(2), 9-13
</p>
<p>Pauly, D., 1984. Length-converted catch curves: a powerful tool for fisheries
research in the tropics (part II). <em>ICLARM Fishbyte</em>, 2(1), 17-19
</p>
<p>Pauly, D., 1984. Length-converted catch curves: a powerful tool for fisheries
research in the tropics (III: Conclusion). <em>ICLARM Fishbyte</em>, 2(3), 9-10
</p>
<p>Ricker, W.E., 1987. Computation and interpretation of biological statistics of fish
populations. <em>Bull.Fish.Res.Board Can.</em>, (191):382 p.
</p>
<p>Robson, D.S., and D.G. Chapman, 1961. Catch curves and mortality rates.
<em>Trans.Am.Fish.Soc.</em>, 90(2):181-189
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>Van Sickle, J. 1977. Mortality rates from size distributions: the application of a
conservation law. <em>Oecologia, Berl.</em>, 27(4):311-318
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#_______________________________________________
# Variable paramter system (with catch vector)
# based on length frequency data
data(goatfish)
output &lt;- catchCurve(goatfish)
summary(output$linear_mod)

# based on age composition data
data(whiting)
catchCurve(whiting, catch_columns = 1)

#_______________________________________________
# Constant parameter system based on age composition data (with catch matrix)
catchCurve(whiting)

#_______________________________________________
# Cumulative Catch Curve
# based on length frequency data
data(goatfish)
catchCurve(goatfish, cumulative = TRUE)

# based on age composition data
data(synCAA2)
catchCurve(synCAA2, cumulative = TRUE)

#_______________________________________________
# Catch Curve with estimation of selection ogive
data(synLFQ3)
output &lt;- catchCurve(synLFQ3, calc_ogive = TRUE)
summary(output$linear_mod_sel)
 

# the same with predefined selection for regression line:
data(synLFQ3)
output &lt;- catchCurve(synLFQ3, calc_ogive = TRUE, reg_int = c(9,21))
plot(output, plot_selec = TRUE)

</code></pre>

<hr>
<h2 id='date2yeardec'>Date - Year conversion</h2><span id='topic+date2yeardec'></span>

<h3>Description</h3>

<p>Convert dates to numeric years with decimal as fraction of a year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date2yeardec(date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date2yeardec_+3A_date">date</code></td>
<td>
<p>a date (class 'Date')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar (class 'numeric')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date2yeardec(Sys.Date())

</code></pre>

<hr>
<h2 id='ELEFAN'>ELEFAN</h2><span id='topic+ELEFAN'></span>

<h3>Description</h3>

<p>Electronic LEngth Frequency ANalysis for estimating growth parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELEFAN(
  lfq,
  Linf_fix = NA,
  Linf_range = NA,
  K_range = exp(seq(log(0.1), log(10), length.out = 100)),
  C = 0,
  ts = 0,
  MA = 5,
  addl.sqrt = FALSE,
  agemax = NULL,
  flagging.out = TRUE,
  method = "optimise",
  cross.date = NULL,
  cross.midLength = NULL,
  cross.max = FALSE,
  hide.progressbar = FALSE,
  plot = FALSE,
  contour = FALSE,
  add.values = TRUE,
  rsa.colors = terrain.colors(20),
  plot_title = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELEFAN_+3A_lfq">lfq</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row)
and sampling date (column);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_+3A_linf_fix">Linf_fix</code></td>
<td>
<p>numeric; if used the K-Scan method is applied with a fixed
Linf value (i.e. varying K only).</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_linf_range">Linf_range</code></td>
<td>
<p>numeric vector with potential Linf values. Default is the
last length class plus/minus 5 cm</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_k_range">K_range</code></td>
<td>
<p>K values for which the score of growth functions should be
calculated
(by default: exp(seq(log(0.1),log(10),length.out = 100)))</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_c">C</code></td>
<td>
<p>growth oscillation amplitude (default: 0)</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_ts">ts</code></td>
<td>
<p>onset of the first oscillation relative to t0 (summer point, default: 0)</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_ma">MA</code></td>
<td>
<p>number indicating over how many length classes the moving average
should be performed (default: 5, for
more information see <a href="#topic+lfqRestructure">lfqRestructure</a>).</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_addl.sqrt">addl.sqrt</code></td>
<td>
<p>Passed to <a href="#topic+lfqRestructure">lfqRestructure</a>. Applied an additional square-root transformation of positive values according to Brey et al. (1988).
(default: FALSE, for more information see <a href="#topic+lfqRestructure">lfqRestructure</a>).</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_agemax">agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_flagging.out">flagging.out</code></td>
<td>
<p>logical; should positive peaks be flagged out? (Default : TRUE)</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_method">method</code></td>
<td>
<p>Choose between the old FiSAT option to force VBGF crossing of a pre-defined
bin (method = &quot;cross&quot;), or the more sophisticated (but computationally expensive) option
to solve for t_anchor via a maximisation of reconstructed score
(default: method = &quot;optimise&quot;).</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_cross.date">cross.date</code></td>
<td>
<p>Date. For use with <code>method = "cross"</code>. In combination
with <code>cross.midLength</code>, defines the date of the crossed bin.</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_cross.midlength">cross.midLength</code></td>
<td>
<p>Numeric. For use with <code>method = "cross"</code>. In combination
with <code>cross.date</code>, defines the mid-length of the crossed bin.</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_cross.max">cross.max</code></td>
<td>
<p>logical. For use with <code>method = "cross"</code>. Forces growth function
to cross the bin with maximum positive score.</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_hide.progressbar">hide.progressbar</code></td>
<td>
<p>logical; should the progress bar be hidden? (default: FALSE)</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_plot">plot</code></td>
<td>
<p>logical; indicating if plot with restructured frequencies and growth curves should
be displayed</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_contour">contour</code></td>
<td>
<p>if used in combination with response surface analysis, contour lines
are displayed rather than the score as text in each field of the score plot. Usage
can be logical (e.g. TRUE) or by providing a numeric which indicates the
number of levels (<code>nlevels</code> in <code><a href="graphics.html#topic+contour">contour</a></code>). By default FALSE.</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_add.values">add.values</code></td>
<td>
<p>logical. Add values to Response Surface Analysis plot (default: TRUE).
Overridden when <code>contour = TRUE</code>.</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_rsa.colors">rsa.colors</code></td>
<td>
<p>vector of colors to be used with the Response Surface Analysis plot.
(default: terrain.colors(20))</p>
</td></tr>
<tr><td><code id="ELEFAN_+3A_plot_title">plot_title</code></td>
<td>
<p>logical; indicating whether title to score plots should be displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions allows to perform the K-Scan and Response surface
analysis to estimate growth parameters.
It combines the step of restructuring length-frequency data
(<a href="#topic+lfqRestructure">lfqRestructure</a>) followed by the fitting of VBGF
curves through the restructured data (<a href="#topic+lfqFitCurves">lfqFitCurves</a>). K-Scan is a
method used to search for the K
parameter with the best fit while keeping the Linf fixed. In contrast,
with response surface analysis
both parameters are estimated and the fits are displayed in a heatmap.
Both methods use <code><a href="stats.html#topic+optimise">optimise</a></code> to find the best <code>t_anchor</code> value
for each combination of <code>K</code> and <code>Linf</code>. To find out more about
<code>t_anchor</code>, please refer to the Details description of
<code><a href="#topic+lfqFitCurves">lfqFitCurves</a></code>. The score value <code>Rn_max</code> is comparable with
the score values of the other ELEFAN functions (<code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code> or
<code><a href="#topic+ELEFAN_GA">ELEFAN_GA</a></code>) when other settings are consistent
(e.g. 'MA', 'addl.sqrt', 'agemax', 'flagging.out').
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>rcounts</strong>: restructured frequencies,
</p>
</li>
<li> <p><strong>peaks_mat</strong>: matrix with positive peaks with distinct values,
</p>
</li>
<li> <p><strong>ASP</strong>: available sum of peaks, sum of posititve peaks which
could be potential be hit by
growth curves,
</p>
</li>
<li> <p><strong>score_mat</strong>: matrix with scores for each Linf (only Linf_fix)
and K combination,
</p>
</li>
<li> <p><strong>t_anchor_mat</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>ncohort</strong>: number of cohorts used for estimation,
</p>
</li>
<li> <p><strong>agemax</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>par</strong>: a list with the parameters of the von Bertalanffy growth
function:
</p>

<ul>
<li> <p><strong>Linf</strong>: length infinity in cm,
</p>
</li>
<li> <p><strong>K</strong>: curving coefficient;
</p>
</li>
<li> <p><strong>t_anchor</strong>: time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month,
</p>
</li>
<li> <p><strong>C</strong>: amplitude of growth oscillation
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>ts</strong>: summer point of oscillation (ts = WP - 0.5)
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>phiL</strong>: growth performance index defined as
phiL = log10(K) + 2 * log10(Linf);
</p>
</li></ul>

</li>
<li> <p><strong>Rn_max</strong>: highest score value
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a revised and expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. 1981. The relationship between gill surface area and growth performance in fish:
a generalization of von Bertalanffy's theory of growth. <em>Meeresforsch</em>. 28:205-211
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Pauly, D., 1985. On improving operation and use of ELEFAN programs. Part I: Avoiding
&quot;drift&quot; of K towards low values. <em>ICLARM Conf. Proc.</em>, 13-14
</p>
<p>Pauly, D., 1987. A review of the ELEFAN system for analysis of length-frequency data in
fish and aquatic invertebrates. <em>ICLARM Conf. Proc.</em>, (13):7-34
</p>
<p>Pauly, D. and G. R. Morgan (Eds.), 1987. Length-based methods in fisheries research.
(No. 13). WorldFish
</p>
<p>Pauly, D. and G. Gaschuetz. 1979. A simple method for fitting oscillating length growth data, with a
program for pocket calculators. I.C.E.S. CM 1979/6:24. Demersal Fish Cttee, 26 p.
</p>
<p>Pauly, D. 1984. Fish population dynamics in tropical waters: a manual for use with programmable
calculators (Vol. 8). WorldFish.
</p>
<p>Quenouille, M. H., 1956. Notes on bias in estimation. <em>Biometrika</em>, 43:353-360
</p>
<p>Somers, I. F., 1988. On a seasonally oscillating growth function. ICLARM Fishbyte 6(1): 8-11.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2): 407 p.
</p>
<p>Tukey, J., 1958. Bias and confidence in not quite large samples.
<em>Annals of Mathematical Statistics</em>, 29: 614
</p>
<p>Tukey, J., 1986. The future of processes of data analysis. In L. V. Jones (Eds.),
The Collected Works of John W. Tukey-philosophy and principles of data analysis:
1965-1986 (Vol. 4, pp. 517-549). Monterey, CA, USA: Wadsworth &amp; Brooks/Cole
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(alba)

### Response Surface Analysis (varies Linf and K) ###

# 'cross' method (used in FiSAT)
fit1 &lt;- ELEFAN(
   lfq = alba, method = "cross",
   Linf_range = seq(from = 10, to = 20, length.out = 10),
   K_range = exp(seq(from = log(0.1), to = log(2), length.out = 20)),
   cross.date = alba$dates[3], cross.midLength = alba$midLengths[4],
   contour = TRUE
)
fit1$Rn_max; unlist(fit1$par)
plot(fit1); points(alba$dates[3], alba$midLengths[4], col=2, cex=2, lwd=2)

# 'cross' method (bin with maximum score crossed)
fit2 &lt;- ELEFAN(
   lfq = alba, method = "cross",
   Linf_range = seq(from = 10, to = 20, length.out = 20),
   K_range = exp(seq(from = log(0.1), to = log(2), length.out = 20)),
   cross.max = TRUE,
   contour = TRUE
)
fit2$Rn_max; unlist(fit2$par)
plot(fit2); points(alba$dates[7], alba$midLengths[9], col=2, cex=2, lwd=2)


# 'optimise' method (default)
fit3 &lt;- ELEFAN(
   lfq = alba, method = "optimise",
   Linf_range = seq(from = 10, to = 20, length.out = 10),
   K_range = exp(seq(from = log(0.1), to = log(2), length.out = 20)),
   contour = TRUE
)
fit3$Rn_max; unlist(fit3$par)
plot(fit3)


### K-Scan (varies K, Linf is fixed) ###

# 'cross' method
fit4 &lt;- ELEFAN(
   lfq = alba, method = "cross",
   Linf_fix = 10,
   K_range = round(exp(seq(from = log(0.1), to = log(2), length.out = 50)),2),
   cross.date = alba$dates[3], cross.midLength = alba$midLengths[4],
   plot = FALSE
)
fit4$Rn_max; unlist(fit4$par)
plot(fit4); points(alba$dates[3], alba$midLengths[4], col=2, cex=2, lwd=2)



</code></pre>

<hr>
<h2 id='ELEFAN_GA'>ELEFAN_GA</h2><span id='topic+ELEFAN_GA'></span>

<h3>Description</h3>

<p>Electronic LEngth Frequency ANalysis with genetic algorithm
used for estimating growth parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELEFAN_GA(
  lfq,
  seasonalised = FALSE,
  low_par = NULL,
  up_par = NULL,
  popSize = 50,
  maxiter = 100,
  run = maxiter,
  parallel = FALSE,
  pmutation = 0.1,
  pcrossover = 0.8,
  elitism = base::max(1, round(popSize * 0.05)),
  MA = 5,
  addl.sqrt = FALSE,
  agemax = NULL,
  flagging.out = TRUE,
  seed = NULL,
  monitor = FALSE,
  plot = FALSE,
  plot.score = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELEFAN_GA_+3A_lfq">lfq</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row)
and sampling date (column);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_seasonalised">seasonalised</code></td>
<td>
<p>logical; indicating if the seasonalised von Bertalanffy
growth function should be applied (default: FALSE).</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_low_par">low_par</code></td>
<td>
<p>a list providing the minimum of the search space in case
of real-valued or permutation encoded optimizations. When set to NULL the
following default values are used:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default is calculated from maximum
length class in the data),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 0.01),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 0);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_up_par">up_par</code></td>
<td>
<p>a list providing the maximum of the search space in case of
real-valued or permutation encoded optimizations. When set to NULL the
following default values are used:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default is calculated from maximum
length class in the data),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 1),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 1),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 1),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 1);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_popsize">popSize</code></td>
<td>
<p>the population size. Default: 50</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations to run before the
GA search is halted. default:100</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_run">run</code></td>
<td>
<p>the number of consecutive generations without any improvement
in the best fitness value before the GA is stopped. Default: equals maxiter</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_parallel">parallel</code></td>
<td>
<p>a logical argument specifying if parallel computing
should be used (TRUE) or not (FALSE, default) for evaluating the
fitness function. See <code><a href="GA.html#topic+ga">ga</a></code> for details. Default:FALSE, but
setting to TRUE may substantially improve required calculation time. Use of
this functionality requires the following packages: parallel, doParallel.</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_pmutation">pmutation</code></td>
<td>
<p>the probability of mutation in a parent chromosome.
Usually mutation occurs with a small probability, and by default is set to 0.1.</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_pcrossover">pcrossover</code></td>
<td>
<p>the probability of crossover between pairs of chromosomes.
Typically this is a large value and by default is set to 0.8.</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_elitism">elitism</code></td>
<td>
<p>the number of best fitness individuals to survive at each generation.
By default the top 5% individuals will survive at each iteration.</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_ma">MA</code></td>
<td>
<p>number indicating over how many length classes the moving average
should be performed (default: 5, for
more information see <a href="#topic+lfqRestructure">lfqRestructure</a>)</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_addl.sqrt">addl.sqrt</code></td>
<td>
<p>additional squareroot transformation of positive values
according to Brey et al. (1988) (default: FALSE, for
more information see <a href="#topic+lfqRestructure">lfqRestructure</a>)</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_agemax">agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_flagging.out">flagging.out</code></td>
<td>
<p>logical; should positive peaks be flagged out? Original setting of
ELEFAN in TRUE. Default:TRUE</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_seed">seed</code></td>
<td>
<p>an integer value containing the random number generator state. This
argument can be used to replicate the results of a GA search. Note that
if parallel computing is required, the doRNG package must be installed.
(Default: 'seed = NULL')</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_monitor">monitor</code></td>
<td>
<p>a logical or an R function which takes as input the current
state of the 'ga-class' object and show the evolution of the
search. By default, 'monitor = FALSE' so any
output is suppressed. Possible also, the functions
'gaMonitor' or 'gaMonitor2' (depending on whether or not is
an RStudio session) which print the average and best fitness
values at each iteration. If set to 'plot' these information
are plotted on a graphical device. Other functions can be
written by the user and supplied as argument.</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_plot">plot</code></td>
<td>
<p>logical; Plot restructured counts with fitted lines using
<code><a href="#topic+plot.lfq">plot.lfq</a></code> and <code><a href="#topic+lfqFitCurves">lfqFitCurves</a></code> (default : FALSE).</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_plot.score">plot.score</code></td>
<td>
<p>logical; Plot genetic algorithm fitness progression.
(Default: plot.score=TRUE).</p>
</td></tr>
<tr><td><code id="ELEFAN_GA_+3A_...">...</code></td>
<td>
<p>additional parameters to pass to <code><a href="GA.html#topic+ga">ga</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A more detailed description of the generic algorithm (GA) can be found in
Scrucca (2013). The score value <code>fitnessValue</code> is not comparable with
the score value of the other ELEFAN functions (<code><a href="#topic+ELEFAN">ELEFAN</a></code> or
<code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>samplingPeriod</strong>: length of sampling period in years,
</p>
</li>
<li> <p><strong>samplingDays</strong>: time of sampling times in relation to first sampling time,
</p>
</li>
<li> <p><strong>delta_t</strong>: array with time differences between relative sampling time set to zero and
other sampling times,
</p>
</li>
<li> <p><strong>rcounts</strong>: restructured frequencies,
</p>
</li>
<li> <p><strong>peaks_mat</strong>: matrix with positive peaks with distinct values,
</p>
</li>
<li> <p><strong>ASP</strong>: available sum of peaks, sum of posititve peaks which could be
potential be hit by
growth curves,
</p>
</li>
<li> <p><strong>ncohort</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>agemax</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>par</strong>: a list with the parameters of the von Bertalanffy growth
function:
</p>

<ul>
<li> <p><strong>Linf</strong>: length infinity in cm,
</p>
</li>
<li> <p><strong>K</strong>: curving coefficient;
</p>
</li>
<li> <p><strong>t_anchor</strong>: time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month,
</p>
</li>
<li> <p><strong>C</strong>: amplitude of growth oscillation
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>ts</strong>: summer point of oscillation (ts = WP - 0.5)
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>phiL</strong>: growth performance index defined as
phiL = log10(K) + 2 * log10(Linf);
</p>
</li></ul>

</li>
<li> <p><strong>Rn_max</strong>: highest value of fitness function, (comparable with ELEFAN and ELEFAN_SA).
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a
revised and expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Scrucca, L. (2013). GA: a package for genetic algorithms in R. Journal of
Statistical Software, 53(4), 1-37.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load data and view catch length frequencies
data(synLFQ4)
plot(synLFQ4, Fname="catch")

# Genetic algorithm
# (if using a multicore processor,
#   consider adding the argument 'parallel=TRUE'
#   to reduce computation time)
output &lt;- ELEFAN_GA(synLFQ4, seasonalised = TRUE,
   low_par = list(Linf = 70, K = 0.25, t_anchor = 0, C = 0, ts= 0),
   up_par = list(Linf = 90, K = 0.7, t_anchor = 1, C = 1, ts = 1),
   popSize = 40, maxiter = 50, run = 20,
   MA = 11, plot = TRUE, seed = 1111)
output$par
output$ASP
output$Rn_max

# compare fitness score (fESP) to
# that calculated with "true" growth parameter values
plot(output, draw = FALSE)
lfqFitCurves(output, par=list(Linf=80, K=0.5, t_anchor=0.25, C=0.75, ts=0.5),
       draw = TRUE, col=1, flagging.out = FALSE)$fESP
lfqFitCurves(output, par=output$par, draw = TRUE, col=2, flagging.out = FALSE)$fESP
legend("top", legend=c("orig.", "GA"), lty=2, col=1:2, ncol=2)


</code></pre>

<hr>
<h2 id='ELEFAN_SA'>ELEFAN_SA</h2><span id='topic+ELEFAN_SA'></span>

<h3>Description</h3>

<p>Electronic LEngth Frequency ANalysis with simulated annealing
for estimating growth parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELEFAN_SA(
  lfq,
  seasonalised = FALSE,
  init_par = list(Linf = 50, K = 0.5, t_anchor = 0.5, C = 0, ts = 0),
  low_par = NULL,
  up_par = NULL,
  SA_time = 60 * 1,
  maxit = NULL,
  nb.stop.improvement = NULL,
  SA_temp = 1e+05,
  verbose = TRUE,
  MA = 5,
  addl.sqrt = FALSE,
  agemax = NULL,
  flagging.out = TRUE,
  plot = FALSE,
  plot.score = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELEFAN_SA_+3A_lfq">lfq</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row)
and sampling date (column);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_seasonalised">seasonalised</code></td>
<td>
<p>logical; indicating if the seasonalised von Bertalanffy
growth function should be applied (default: FALSE).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_init_par">init_par</code></td>
<td>
<p>a list providing the Initial values for the components to be
optimized. When set to NULL the following default values are used:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default is the maximum
length class in the data),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 0.5),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 0.5),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 0);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_low_par">low_par</code></td>
<td>
<p>a list providing the lower bounds for components. When set to
NULL the following default values are used:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default is calculated from maximum
length class in the data),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 0.01),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 0);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_up_par">up_par</code></td>
<td>
<p>a list providing the upper bounds for components. When set to
NULL the following default values are used:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default is calculated from maximum
length class in the data),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 0.01),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 0);
</p>
</li></ul>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_sa_time">SA_time</code></td>
<td>
<p>numeric; Maximum running time in seconds (default : 60 * 1).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_maxit">maxit</code></td>
<td>
<p>Integer. Maximum number of iterations of the
algorithm. Default is NULL.</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_nb.stop.improvement">nb.stop.improvement</code></td>
<td>
<p>Integer. The program will stop when
there is no any improvement in 'nb.stop.improvement'
steps. Default is NULL</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_sa_temp">SA_temp</code></td>
<td>
<p>numeric; Initial value for temperature (default : 1e5).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_verbose">verbose</code></td>
<td>
<p>logical; TRUE means that messages from the algorithm
are shown (default : TRUE).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_ma">MA</code></td>
<td>
<p>number indicating over how many length classes the moving average
should be performed (defalut: 5, for
more information see <a href="#topic+lfqRestructure">lfqRestructure</a>).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_addl.sqrt">addl.sqrt</code></td>
<td>
<p>Passed to <a href="#topic+lfqRestructure">lfqRestructure</a>. Applied an additional
square-root transformation of positive values according to Brey et al. (1988).
(default: FALSE, for more information see <a href="#topic+lfqRestructure">lfqRestructure</a>).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_agemax">agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_flagging.out">flagging.out</code></td>
<td>
<p>logical; passed to <a href="#topic+lfqFitCurves">lfqFitCurves</a>. Default is TRUE</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_plot">plot</code></td>
<td>
<p>logical; Plot restructured counts with fitted lines using
<code><a href="#topic+plot.lfq">plot.lfq</a></code> and <code><a href="#topic+lfqFitCurves">lfqFitCurves</a></code> (default : FALSE).</p>
</td></tr>
<tr><td><code id="ELEFAN_SA_+3A_plot.score">plot.score</code></td>
<td>
<p>logical; Plot simulated annealing score progression.
(Default: plot.score=TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A more detailed description of the simulated annealing (SA) can be found in
Xiang et al. (2013). The score value <code>cost_value</code> is not comparable with
the score value of the other ELEFAN functions (<code><a href="#topic+ELEFAN">ELEFAN</a></code> or
<code><a href="#topic+ELEFAN_GA">ELEFAN_GA</a></code>).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>rcounts</strong>: restructured frequencies,
</p>
</li>
<li> <p><strong>peaks_mat</strong>: matrix with positive peaks with distinct values,
</p>
</li>
<li> <p><strong>ASP</strong>: available sum of peaks, sum of posititve peaks which
could be potential be hit by
growth curves,
</p>
</li>
<li> <p><strong>ncohort</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>agemax</strong>: maximum age of species,
</p>
</li>
<li> <p><strong>par</strong>: a list with the parameters of the von Bertalanffy growth
function:
</p>

<ul>
<li> <p><strong>Linf</strong>: length infinity in cm,
</p>
</li>
<li> <p><strong>K</strong>: curving coefficient;
</p>
</li>
<li> <p><strong>t_anchor</strong>: time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month,
</p>
</li>
<li> <p><strong>C</strong>: amplitude of growth oscillation
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>ts</strong>: summer point of oscillation (ts = WP - 0.5)
(if <code>seasonalised</code> = TRUE),
</p>
</li>
<li> <p><strong>phiL</strong>: growth performance index defined as
phiL = log10(K) + 2 * log10(Linf);
</p>
</li></ul>

</li>
<li> <p><strong>Rn_max</strong>:  highest score value (absolute value of cost function,
comparable with ELEFAN and ELEFAN_GA).
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a revised and
expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Xiang, Y., Gubian, S., Suomela, B., &amp; Hoeng, J. (2013). Generalized simulated
annealing for global optimization: the GenSA Package. R Journal, 5(1), 13-28.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## synthetic lfq data example
data(synLFQ4)
plot(synLFQ4, Fname="catch")

# ELEFAN_SA (takes approximately 2 minutes)
output &lt;- ELEFAN_SA(synLFQ4, SA_time = 60*2, seasonalised = TRUE, MA = 11,
  init_par = list(Linf = 75, K = 0.5, t_anchor = 0.5, C = 0.5, ts = 0.5),
  low_par = list(Linf = 70, K = 0.3, t_anchor = 0, C = 0, ts = 0),
  up_par = list(Linf = 90, K = 0.7, t_anchor = 1, C = 1, ts = 1))
output$par
output$Rn_max

# view fit
plot(output)

# or
plot(output, draw = FALSE)
lfqFitCurves(output, col=1, par=output$par, draw=TRUE)$ESP

# compare to original parameters
tmp &lt;- lfqFitCurves(output, col=4, lty=1,
   par=list(Linf=80, K=0.5, t_anchor=0.25, C=0.75, ts=0.5), draw=TRUE)
tmp$fESP
output$Rn_max


</code></pre>

<hr>
<h2 id='emperor'>Emperor data</h2><span id='topic+emperor'></span>

<h3>Description</h3>

<p>This dataset contains information about sky emperor (<em>Lethrinus mahsena</em>)
and its fisheries of offshore Mauritius banks (Nazareth banks). It can be used for
production models (<code><a href="#topic+prod_mod">prod_mod</a></code> and <code><a href="#topic+prod_mod_ts">prod_mod_ts</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(emperor)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing: 1. <strong>year</strong> years, 2. <strong>Y</strong> yield,
3. <strong>CPUE</strong> CPUE or abundance index
</p>


<h3>Source</h3>

<p>Dharmendra, D., Solmundsson, J., 2005. Stock assessment of the offshore Mauritian banks
using dynamic biomass models and analysis of length frequency of the Sky Emperor
(<em>Lethrinus mahsena</em>). Fisheries Training Program The United Nations University, 61
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(emperor)
str(emperor)
summary(emperor)


</code></pre>

<hr>
<h2 id='gillnet'>Gillnet data</h2><span id='topic+gillnet'></span>

<h3>Description</h3>

<p>Data of an experiment with several gillnets with different mesh sizes.
Data can be analysed with function <code><a href="#topic+select_Millar">select_Millar</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gillnet)
</code></pre>


<h3>Format</h3>

<p>A list consiting of:
</p>

<ul>
<li> <p><code>midLengths</code>  the midlengths of size classes,
</p>
</li>
<li> <p><code>meshSizes</code>  the meshsizes,
</p>
</li>
<li> <p><code>catchPerNet_mat</code>  a matrix with the numbers in catch of the
corresponding mesh sizes (same order),
</p>
</li></ul>



<h3>Source</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3), 471-477.
</p>
<p>Holt, S. J. 1963. A method for determining gear selectivity and its application.
<em>ICNAF Special Publication</em>, 5: 106-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gillnet)
str(gillnet)
summary(gillnet)

</code></pre>

<hr>
<h2 id='gillnetfit'>Millar's original gillnet selectivity fitting function</h2><span id='topic+gillnetfit'></span>

<h3>Description</h3>

<p>Function to estimate selectivity parameters from experimental data.
This function is applied within <code><a href="#topic+select_Millar">select_Millar</a></code> to derive starting
parameters. <code><a href="#topic+select_Millar">select_Millar</a></code> is the recommended function for
selectivity estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gillnetfit(
  data,
  meshsizes,
  rtype = "norm.loc",
  rel.power = NULL,
  plotlens = NULL,
  details = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gillnetfit_+3A_data">data</code></td>
<td>
<p>matrix with the number of individuals caught with each sized mesh
(<code>CatchPerNet_mat</code>).</p>
</td></tr>
<tr><td><code id="gillnetfit_+3A_meshsizes">meshsizes</code></td>
<td>
<p>vector with meshSizes in increasing order (<code>meshSizes</code>),</p>
</td></tr>
<tr><td><code id="gillnetfit_+3A_rtype">rtype</code></td>
<td>
<p>A character string indicating which method for estimating selection curves
should be used:
<code>"norm.loc"</code> for a normal curve with common spread,
<code>"norm.sca"</code> for a normal curve with variable spread,
<code>"lognorm"</code> for a lognormal curve,
<code>"gamma"</code> for a gamma curve.</p>
</td></tr>
<tr><td><code id="gillnetfit_+3A_rel.power">rel.power</code></td>
<td>
<p>A string indicating the relative power of different meshSizes,
must have same length as <code>meshSizes</code> (Default: <code>rel.power = NULL</code>).</p>
</td></tr>
<tr><td><code id="gillnetfit_+3A_plotlens">plotlens</code></td>
<td>
<p>lengths which should be used for graphical output,
for more detailed curves. Default : NULL</p>
</td></tr>
<tr><td><code id="gillnetfit_+3A_details">details</code></td>
<td>
<p>logical; should details be included in the output?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of fitted parameters
</p>


<h3>Source</h3>

<p>https://www.stat.auckland.ac.nz/~millar/selectware/
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gillnet)

dat &lt;- matrix(c(gillnet$midLengths, gillnet$CatchPerNet_mat),
         byrow = FALSE, ncol=(dim(gillnet$CatchPerNet_mat)[2]+1))

gillnetfit(data = dat, meshsizes = gillnet$meshSizes)


</code></pre>

<hr>
<h2 id='goatfish'>Yellowstriped goatfish data</h2><span id='topic+goatfish'></span>

<h3>Description</h3>

<p>Data of Yellowstriped goatfish (<em>Upeneus vittatus</em>) from Manila Bay,
Philippines. Can be used for the estimation of the instantaneous mortality
rate (Z) by means of <code><a href="#topic+catchCurve">catchCurve</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(goatfish)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>midLengths</code>: mid points of length classes,
</p>
</li>
<li> <p><code>catch</code>: a vector with catches in numbers,
</p>
</li>
<li> <p><code>Linf</code>: infinite length in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent per year [1/year].
</p>
</li></ul>



<h3>Source</h3>

<p>Ziegler, B., 1979. Growth and mortality rates of some fishes of
Manila Bay, Philippines, as estimated from analysis of length-frequencies.
Thesis. Kiel University, 115 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goatfish)
str(goatfish)
summary(goatfish)


</code></pre>

<hr>
<h2 id='growth_length_age'>Estimation of growth parameter using length-at-age data</h2><span id='topic+growth_length_age'></span>

<h3>Description</h3>

<p>This function estimates growth parameters from
length-at-age data. It
allows to perform different methods: Gulland and Holt, Ford Walford plot,
Chapman's method, Bertalanffy plot, or non linear least squares method (LSM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growth_length_age(
  param,
  method,
  Linf_est = NA,
  Linf_init = 10,
  K_init = 0.1,
  t0_init = 0,
  CI = FALSE,
  ci.level = 0.95,
  age_plot = NULL,
  do.sim = FALSE,
  nsim = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growth_length_age_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>age</strong>: age measurements,
</p>
</li>
<li> <p><strong>length</strong>: corresponding lengths in cm.
</p>
</li></ul>
</td></tr>
<tr><td><code id="growth_length_age_+3A_method">method</code></td>
<td>
<p>indicating which of following methods should be applied:
<code>"GullandHolt"</code>,
<code>"FordWalford"</code>, <code>"Chapman"</code>, <code>"BertalanffyPlot"</code>,
or <code>"LSM"</code></p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_linf_est">Linf_est</code></td>
<td>
<p>BertalanffyPlot requires an estimate for Linf to derive K and t0
(for more information see Details).</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_linf_init">Linf_init</code></td>
<td>
<p>initital parameter of Linf for non-linear sqaures fitting (default 10)</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_k_init">K_init</code></td>
<td>
<p>initital parameter of K for non-linear sqaures fitting (default 0.1)</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_t0_init">t0_init</code></td>
<td>
<p>initital parameter of t0 for non-linear sqaures fitting (default 0)</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_ci">CI</code></td>
<td>
<p>logical; Should confidence intervals be calculated? This option only
works for the LSM method. Default is FALSE.</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_ci.level">ci.level</code></td>
<td>
<p>required confidence level (for LSM method only)</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_age_plot">age_plot</code></td>
<td>
<p>sequence with ages used for plotting (LSM method only). By default
age_plot = seq(min(param$age),max(param$age),0.1)</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_do.sim">do.sim</code></td>
<td>
<p>logical. Should Monte Carlo simulation be applied? Default = FALSE</p>
</td></tr>
<tr><td><code id="growth_length_age_+3A_nsim">nsim</code></td>
<td>
<p>the number of Monte Carlo simulations to be performed,
minimum is 10000 (default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gulland and Holt plot assumes
infinitestimal delta t (only reasonable approximation of growth parameters if delta t
is small). Ford Walford plot and Chapman assume constant time intervals between ages
(delta t). The Bertalanffy plot is a robust method, however it requires an estimate of Linf. As
long as this estimate is reasonable the resulting estimate of K is reasonable. For
a first estimate of Linf the Powell Wetherall method <a href="#topic+powell_wetherall">powell_wetherall</a> can
be used. Otherwise, the largest fish or the average of the ten largest fish can be
used for a small or large sample, respectively. All lengths have to be smaller than
Linf as otherwise the logarithm is not defined. Oldest fish (if larger than Linf) have
to be omitted. Non-linear least squares fitting is the preferred method to estimate
growth parameters according to Sparre and Venema (1998). If <code>CI = TRUE</code> the
confidence interval of parameters is calculated and plotted. For plotting the
confidence interval the <code><a href="propagate.html#topic+predictNLS">predictNLS</a></code> from the <a href="propagate.html#topic+propagate">propagate</a> package
is applied.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following parameters:
</p>

<ul>
<li> <p><strong>x</strong>: independent variable used for regression analysis,
</p>
</li>
<li> <p><strong>y</strong>: dependent variable used for regression analysis,
</p>
</li>
<li> <p><strong>mod</strong>: (non) linear model,
</p>
</li>
<li> <p><strong>Linf</strong>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>t0</strong>: theoretical time zero, at which individuals of this species hatch
(only for Bertalanffy plot and LSM method).
</p>
</li>
<li> <p><strong>estimates</strong>: dataframe with growth parameters and confidence intervals
(only if LSM method was applied).
</p>
</li></ul>



<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># synthetical length at age data
dat &lt;- list(age = rep(1:7,each = 5),
   length = c(rnorm(5,25.7,0.9),rnorm(5,36,1.2),rnorm(5,42.9,1.5),rnorm(5,47.5,2),
   rnorm(5,50.7,0.4),rnorm(5,52.8,0.5),rnorm(5,54.2,0.7)))
growth_length_age(dat, method = "GullandHolt")

# Bertalaffy plot
growth_length_age(dat, method = "BertalanffyPlot", Linf_est = 50)

# non linear least squares method

output &lt;- growth_length_age(param = dat, method = "LSM",
     Linf_init = 30, CI = TRUE, age_plot=NULL)
summary(output$mod)


</code></pre>

<hr>
<h2 id='growth_tagging'>Growth from tagging data</h2><span id='topic+growth_tagging'></span>

<h3>Description</h3>

<p>This function estimates growth parameters from tagging data. Munro plot
is applied
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growth_tagging(param, method, Linf_range = c(5, 600), time_unit = "year")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growth_tagging_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>L1</strong>: length at tagging [cm],
</p>
</li>
<li> <p><strong>L2</strong>: length at recapture [cm],
</p>
</li>
<li> <p><strong>delta_t</strong>: time interval between tagging ang recapture
(instead two vectors with <strong>t1</strong> (age at tagging) and <strong>t2</strong>
(age at recapture) can be provided.
</p>
</li></ul>
</td></tr>
<tr><td><code id="growth_tagging_+3A_method">method</code></td>
<td>
<p>indicating which of following methods should be applied: &quot;GullandHolt&quot;
or &quot;Munro&quot;.</p>
</td></tr>
<tr><td><code id="growth_tagging_+3A_linf_range">Linf_range</code></td>
<td>
<p>two values indicating the lower and upper limits of the range,
in which the <a href="stats.html#topic+optimise">optimise</a> searches for the Linf value with the best fit
(lowest CV value ),</p>
</td></tr>
<tr><td><code id="growth_tagging_+3A_time_unit">time_unit</code></td>
<td>
<p>indicating the unit of the time interval, either &quot;year&quot;, &quot;month&quot;,
&quot;week&quot;, or &quot;day&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If Munro plot is applied the optimal Linf value is found by minimizing the coefficient
of variation (CV = sd(K)/mean(K)). For this iterative method the <a href="stats.html#topic+optimise">optimise</a>
function is applied. The histogram of the individual K values allows to distinguish
potential differences in growth performance between individuals. t0 can not be
estimated by Munro plot, neither by the Gulland Holt method.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following parameters:
</p>

<ul>
<li> <p><strong>x</strong>: independent variable used for regression analysis,
</p>
</li>
<li> <p><strong>y</strong>: dependent variable used for regression analysis,
</p>
</li>
<li> <p><strong>reg_coeffs</strong>: regression coefficients,
</p>
</li>
<li> <p><strong>r2</strong>: r squared of regression analysis,
</p>
</li>
<li> <p><strong>Linf</strong>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>conf_int_K</strong>: confidence intervals of K (only if Gulland Holt method
was applied).
</p>
</li></ul>



<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>Sparre, P., Venema, S.C., 1999. Introduction to tropical fish stock assessment.
Part 2. Excercises. FAO Fisheries Technical Paper, (306.2, Rev. 2). 94 p.
</p>
<p>Wolff, M., 1984. Early setback for scallop culture in Peru.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># from Wolff (1984)
dat &lt;- list(L1 = c(40,46,29,30,18,31,48,49,59,58,61,65,57,55),
   L2 = c(85,53,55,56,25,43,70,59,62,80,72,83,65,56),
   delta_t = c(289,26,84,77,14,38,89,38,28,149,89,74,38,21))
growth_tagging(param = dat, "Munro", time_unit = "day", Linf_range=c(80,120))
growth_tagging(param = dat, "GullandHolt", time_unit = "day")


# from Sparre and Venema (1999)
dat &lt;- list(L1 = c(9.7,10.5,10.9,11.1,12.4,12.8,14.0,16.1,16.3,17.0,17.7),
   L2 = c(10.2,10.9,11.8,12.0,15.5,13.6,14.3,16.4,16.5,17.2,18.0),
   delta_t = c(53,33,108,102,272,48,53,73,63,106,111))
growth_tagging(param = dat, "Munro", time_unit = "day", Linf_range = c(10,40))
growth_tagging(param = dat, "GullandHolt", time_unit = "day")

</code></pre>

<hr>
<h2 id='haddock'>Haddock data</h2><span id='topic+haddock'></span>

<h3>Description</h3>

<p>Data of a covered codend experimental catch of the haddock
(<em>Melanogrammus aeglefinus</em>).
Can be used for function <code><a href="#topic+select_Millar">select_Millar</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(haddock)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>midLengths</code>  the midlengths of size classes,
</p>
</li>
<li> <p><code>numCodend</code>  the number of fish retained in codend,
</p>
</li>
<li> <p><code>numCover</code>  the number of fish retained in cover,
</p>
</li></ul>



<h3>Source</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3), 471-477.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(haddock)
str(haddock)
summary(haddock)

</code></pre>

<hr>
<h2 id='hake'>Hake data</h2><span id='topic+hake'></span>

<h3>Description</h3>

<p>This dataset contains length-frequency data and biological
characteristics about hake (<em>Merluccius merluccius</em>)
and its fisheries off Senegal. It can be used for <code><a href="#topic+VPA">VPA</a></code> or
<code><a href="#topic+predict_mod">predict_mod</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hake)
</code></pre>


<h3>Format</h3>

<p>A list consisting of: 1. a vector with midlengths of size classes,
2. a vector with catch in numbers, 3. K value, 4. Linf value, 5. M value,
6. a value, 7. b value, 8. a vector with fishing mortalities, and
9. a vector with average value of fish per kg
</p>


<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(hake)
str(hake)
summary(hake)


</code></pre>

<hr>
<h2 id='lfqCreate'>Create lfq data from length measurements</h2><span id='topic+lfqCreate'></span>

<h3>Description</h3>

<p>Convert raw length measurements to length frequency data (lfq class).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfqCreate(
  data,
  Lname,
  Dname,
  Fname = NA,
  bin_size = 1,
  species = NA,
  stock = NA,
  comment = "",
  Lmin = 0,
  length_unit = "cm",
  plus_group = FALSE,
  aggregate_dates = FALSE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lfqCreate_+3A_data">data</code></td>
<td>
<p>data with at least two columns, one with the length measurements, one
with the sampling date</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_lname">Lname</code></td>
<td>
<p>name of the length column</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_dname">Dname</code></td>
<td>
<p>name of the date column</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_fname">Fname</code></td>
<td>
<p>optional; name of column with frequency, in case each length was measured more than
one time</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_bin_size">bin_size</code></td>
<td>
<p>size of the bins in cm (Default: 2)</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_species">species</code></td>
<td>
<p>character; to store species name in lfq list</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_stock">stock</code></td>
<td>
<p>character; to store stock ID or name in lfq list</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_comment">comment</code></td>
<td>
<p>optional character; to store comments conerning the lfq list</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_lmin">Lmin</code></td>
<td>
<p>minimum length for the midLengths vector (default: 0)</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_length_unit">length_unit</code></td>
<td>
<p>unit of length measurements, either &quot;cm&quot; (default), &quot;mm&quot; or &quot;m&quot;</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_plus_group">plus_group</code></td>
<td>
<p>logical; should a plus group be created? If yes you will be
asked to insert the length for the plus group in the console (default: FALSE).
Instead of inserting the length of the plus group via the console, the value
can be incorporated in a vector, e.g. plus_group = c(TRUE, 30).</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_aggregate_dates">aggregate_dates</code></td>
<td>
<p>logical; indicating whether dates should be lumped in monthly
sampling times (assuming sampling always aound the 15th of
each month; default is FALSE). More exact lumping can only done manually and
then sampling dates provided in data.</p>
</td></tr>
<tr><td><code id="lfqCreate_+3A_plot">plot</code></td>
<td>
<p>logical; should a graph of lfq data be displayed? (Default: FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of &quot;lfq&quot; class with
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and
sampling date (column).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># create random data
set.seed(1)
data &lt;- data.frame(length.mm. = sample(c(rpois(300, lambda = 60),
           rpois(200, lambda = 100), rpois(100, lambda = 150)),
           size = 1000, replace = TRUE),
           dates = seq.Date(as.Date("2015-10-02"),as.Date("2016-08-28"),
           length.out = 1000))
# create lfq data
lfq_dat &lt;- lfqCreate(data,Lname = "length.mm.", Dname = "dates", aggregate_dates = TRUE,
   length_unit = "mm", bin_size = 0.5, plot=TRUE, plus_group=c(TRUE,15.75))

</code></pre>

<hr>
<h2 id='lfqFitCurves'>Fitting VBGF growth curves through lfq data</h2><span id='topic+lfqFitCurves'></span>

<h3>Description</h3>

<p>Thsi function estimates von Bertalanffy growth function (VBGF)
curves for a set of growth parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfqFitCurves(
  lfq,
  par = list(Linf = 100, K = 0.1, t_anchor = 0.25, C = 0, ts = 0),
  agemax = NULL,
  flagging.out = TRUE,
  lty = 2,
  lwd = 1,
  col = 1,
  draw = FALSE,
  tincr = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lfqFitCurves_+3A_lfq">lfq</code></td>
<td>
<p>a list of the class &quot;lfq&quot; consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row)
and sampling date (column),
</p>
</li>
<li> <p><strong>rcounts</strong> restructured frequencies,
</p>
</li>
<li> <p><strong>peaks_mat</strong> matrix with positive peaks with distinct values,
</p>
</li>
<li> <p><strong>ASP</strong> available sum of peaks, sum of posititve peaks which
could be potential be hit by growth curves;
</p>
</li></ul>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_par">par</code></td>
<td>
<p>a list with following growth parameters:
</p>

<ul>
<li> <p><strong>Linf</strong> length infinity in cm (default: 100),
</p>
</li>
<li> <p><strong>K</strong> curving coefficient (default: 0.1),
</p>
</li>
<li> <p><strong>t_anchor</strong> time point anchoring growth curves in year-length
coordinate system, corrsponds to peak spawning month (range: 0 to 1, default: 0.25),
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (range: 0 to 1, default: 0),
</p>
</li>
<li> <p><strong>ts</strong> summer point (ts = WP - 0.5) (range: 0 to 1, default: 0);
</p>
</li></ul>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_agemax">agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_flagging.out">flagging.out</code></td>
<td>
<p>logical; should positive peaks be flagged out?
(Default : TRUE)</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_lty">lty</code></td>
<td>
<p>The line type. Line types can either be specified as an integer
(0=blank, 1=solid, 2=dashed (default), 3=dotted, 4=dotdash, 5=longdash,
6=twodash) or as one of the character strings &quot;blank&quot;, &quot;solid&quot;, &quot;dashed&quot;,
&quot;dotted&quot;, &quot;dotdash&quot;, &quot;longdash&quot;, or &quot;twodash&quot;, where &quot;blank&quot; uses 'invisible
lines' (i.e., does not draw them).</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_lwd">lwd</code></td>
<td>
<p>The line width, a positive number, defaulting to 2. The interpretation
is device-specific, and some devices do not implement line widths less
than one. (See the help on the device for details of the interpretation.)</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_col">col</code></td>
<td>
<p>A specification for the default plotting color. See section
'Color Specification'.</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_draw">draw</code></td>
<td>
<p>logical; indicating whether growth curves should be added to
existing lfq plot</p>
</td></tr>
<tr><td><code id="lfqFitCurves_+3A_tincr">tincr</code></td>
<td>
<p>step for plotting</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>t_anchor</code> subsitutes the starting point from known from Fisat 2.
This parameter is necessary for anchoring the growth curves on the time axis.
It does not subsitute <code>t0</code>. However, it corresponds to the peak spawning
of the species (x intercept of growth curve) and has values between 0 and 1,
where 0 corresponds to spawning at the 1st of January and 0.999 corresponds to the
31st of December. The default value of 0.25 or 3/12 corresponds the third month
of the year, March.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>Lt</strong>: dataframe with ages and lengths of the cohorts,
</p>
</li>
<li> <p><strong>agemax</strong>: maximum age of species.
</p>
</li>
<li> <p><strong>ncohort</strong>: number of cohorts,
</p>
</li>
<li> <p><strong>ASP</strong>: available sum of peaks, sum of posititve peaks which
could be potential be hit by growth curves. This is calculated as the sum of
maximum values from each run of posive restructured scores.
</p>
</li>
<li> <p><strong>ESP</strong>: available sum of peaks,
</p>
</li>
<li> <p><strong>fASP</strong>: available sum of peaks,
</p>
</li>
<li> <p><strong>fESP</strong>: available sum of peaks,
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a revised and expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. 1981. The relationship between gill surface area and growth performance in fish:
a generalization of von Bertalanffy's theory of growth. <em>Meeresforsch</em>. 28:205-211
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Pauly, D., 1985. On improving operation and use of ELEFAN programs. Part I: Avoiding
&quot;drift&quot; of K towards low values. <em>ICLARM Conf. Proc.</em>, 13-14
</p>
<p>Pauly, D., 1987. A review of the ELEFAN system for analysis of length-frequency data in
fish and aquatic invertebrates. <em>ICLARM Conf. Proc.</em>, (13):7-34
</p>
<p>Pauly, D. and G. R. Morgan (Eds.), 1987. Length-based methods in fisheries research.
(No. 13). WorldFish
</p>
<p>Pauly, D. and G. Gaschuetz. 1979. A simple method for fitting oscillating length growth data, with a
program for pocket calculators. I.C.E.S. CM 1979/6:24. Demersal Fish Cttee, 26 p.
</p>
<p>Pauly, D. 1984. Fish population dynamics in tropical waters: a manual for use with programmable
calculators (Vol. 8). WorldFish.
</p>
<p>Quenouille, M. H., 1956. Notes on bias in estimation. <em>Biometrika</em>, 43:353-360
</p>
<p>Somers, I. F., 1988. On a seasonally oscillating growth function. ICLARM Fishbyte 6(1): 8-11.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2): 407 p.
</p>
<p>Tukey, J., 1958. Bias and confidence in not quite large samples.
<em>Annals of Mathematical Statistics</em>, 29: 614
</p>
<p>Tukey, J., 1986. The future of processes of data analysis. In L. V. Jones (Eds.),
The Collected Works of John W. Tukey-philosophy and principles of data analysis:
1965-1986 (Vol. 4, pp. 517-549). Monterey, CA, USA: Wadsworth &amp; Brooks/Cole
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ5)
res &lt;- lfqRestructure(synLFQ5, MA=11)
plot(res)
tmp &lt;- lfqFitCurves(res, par=list(Linf=80,K=0.5,t_anchor=0.25), draw=TRUE)

</code></pre>

<hr>
<h2 id='lfqModify'>Modify lfq data for further analysis</h2><span id='topic+lfqModify'></span>

<h3>Description</h3>

<p>Modify length-freqeuncy (LFQ) data. Allows to summarise catch matrix
of LFQ data to one column per year. This is required for e.g. <code><a href="#topic+catchCurve">catchCurve</a></code>.
Allows to change bin size of LFQ data. Allows to ad plus group to catch matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfqModify(
  lfq,
  par = NULL,
  bin_size = NA,
  aggregate = NA,
  vectorise_catch = FALSE,
  plus_group = FALSE,
  minDate = NA,
  maxDate = NA,
  years = NA,
  Lmin = NA,
  Lmax = NA,
  lfq2 = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lfqModify_+3A_lfq">lfq</code></td>
<td>
<p>lfq object with dates, midLengths, and catch</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_par">par</code></td>
<td>
<p>growth parameters as resulting from e.g. <code><a href="#topic+ELEFAN">ELEFAN</a></code></p>
</td></tr>
<tr><td><code id="lfqModify_+3A_bin_size">bin_size</code></td>
<td>
<p>Bin size for length frequencies (in cm)</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_aggregate">aggregate</code></td>
<td>
<p>Factor to aggregate catch per year (<code>"year"</code>),
per quarter (<code>"quarter"</code>), or per month (<code>"month"</code>). By default data
is not aggregated (<code>NA</code>).</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_vectorise_catch">vectorise_catch</code></td>
<td>
<p>logical; indicating if the catch matrix should be summarised to
yearly vectors (default: FALSE).</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_plus_group">plus_group</code></td>
<td>
<p>logical or numeric; should a plus group be created? If yes you will be
asked to insert the length for the plus group in the console (default: FALSE).
Instead of inserting the length of the plus group via the console, the value
can be inserted, e.g. plus_group = 85.5.</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_mindate">minDate</code></td>
<td>
<p>minimum date to subset lfq data</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_maxdate">maxDate</code></td>
<td>
<p>maximum date to subset lfq data</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_years">years</code></td>
<td>
<p>numeric with year(s) to subset lfq data</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_lmin">Lmin</code></td>
<td>
<p>minimum length to subset lfq data</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_lmax">Lmax</code></td>
<td>
<p>maximum length to subset lfq data</p>
</td></tr>
<tr><td><code id="lfqModify_+3A_lfq2">lfq2</code></td>
<td>
<p>optional second lfq object which will be merged with lfq. This might be interesting for
fleet specific lfq objects. Default: NA. Be aware that catches are combined without weighting!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lfq object with rearranged catch matrix (yearly sums) and growth parameters
if provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ4)

## summarise catch matrix per year
lfq_sum &lt;- lfqModify(synLFQ4, vectorise_catch = TRUE)

## change bin size
lfq_bin &lt;- lfqModify(synLFQ4, bin_size = 4)

## add plus_group
lfq_plus &lt;- lfqModify(synLFQ4, plus_group = 85.5)

</code></pre>

<hr>
<h2 id='lfqRestructure'>Restructuring of length frequency data</h2><span id='topic+lfqRestructure'></span>

<h3>Description</h3>

<p>First step of the Electronic LEngth Frequency ANalysis (ELEFAN),
which is restructuring length-frequency data (lfq).
This is done according to a certain protocol, described by many authors (see
Details or References for more information).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lfqRestructure(param, MA = 5, addl.sqrt = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lfqRestructure_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date)
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and
sampling date (column)
</p>
</li></ul>
</td></tr>
<tr><td><code id="lfqRestructure_+3A_ma">MA</code></td>
<td>
<p>number indicating over how many length classes the moving average
should be performed (default: 5)</p>
</td></tr>
<tr><td><code id="lfqRestructure_+3A_addl.sqrt">addl.sqrt</code></td>
<td>
<p>additional squareroot transformation of positive values
according to Brey et al. (1988) (default: FALSE).
Particularly useful if many observations have a low frequency (&lt;10)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used prior to fitting of growth curves (e.g. in
<code><a href="#topic+ELEFAN">ELEFAN</a></code>, <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code> functions). It restructures a length
frequency data set according to a list of steps to emphasise cohorts in the data.
The steps can be found in various publications, see e.g. Brey et al. (1988) or
Pauly and David (1981). Here, the most recent steps documented in Gayanilo (1997)
are followed.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>rcounts</strong>: restructured frequencies,
</p>
</li>
<li> <p><strong>peaks_mat</strong>: matrix with uniquely numbered positive peaks,
</p>
</li>
<li> <p><strong>ASP</strong>: available sum of peaks, sum of posititve peaks which
could be potential be hit by growth curves. This is calculated as the sum of
maximum values from each run of posive restructured scores,
</p>
</li>
<li> <p><strong>MA</strong>: moving average used for restructuring.
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis:
a revised and expanded user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Gayanilo, Felimon C. FAO-ICLARM stock assessment tools: reference manual.
No. 8. Food &amp; Agriculture Org., 1997.
</p>
<p>Pauly, D. 1981. The relationship between gill surface area and growth performance in fish:
a generalization of von Bertalanffy's theory of growth. <em>Meeresforsch</em>. 28:205-211
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Pauly, D., 1985. On improving operation and use of ELEFAN programs. Part I: Avoiding
&quot;drift&quot; of K towards low values. <em>ICLARM Conf. Proc.</em>, 13-14
</p>
<p>Pauly, D., 1987. A review of the ELEFAN system for analysis of length-frequency data in
fish and aquatic invertebrates. <em>ICLARM Conf. Proc.</em>, (13):7-34
</p>
<p>Pauly, D. and G. R. Morgan (Eds.), 1987. Length-based methods in fisheries research.
(No. 13). WorldFish
</p>
<p>Pauly, D. and G. Gaschuetz. 1979. A simple method for fitting oscillating length
growth data, with a program for pocket calculators. I.C.E.S. CM 1979/6:24.
Demersal Fish Cttee, 26 p.
</p>
<p>Pauly, D. 1984. Fish population dynamics in tropical waters: a manual for use
with programmable calculators (Vol. 8). WorldFish.
</p>
<p>Quenouille, M. H., 1956. Notes on bias in estimation. <em>Biometrika</em>, 43:353-360
</p>
<p>Somers, I. F., 1988. On a seasonally oscillating growth function.
ICLARM Fishbyte 6(1): 8-11.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2): 407 p.
</p>
<p>Tukey, J., 1958. Bias and confidence in not quite large samples.
<em>Annals of Mathematical Statistics</em>, 29: 614
</p>
<p>Tukey, J., 1986. The future of processes of data analysis. In L. V. Jones (Eds.),
The Collected Works of John W. Tukey-philosophy and principles of data analysis:
1965-1986 (Vol. 4, pp. 517-549). Monterey, CA, USA: Wadsworth &amp; Brooks/Cole
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data and plot of catch frequencies
data(synLFQ4)
plot(synLFQ4, Fname="catch")

# restructuring and calculation of ASP
synLFQ4 &lt;- lfqRestructure(synLFQ4, MA=11)
synLFQ4$ASP

# plot of restructured scores and fit of soVBGF growth curves
plot(synLFQ4)
lfqFitCurves(synLFQ4,
 par=list(Linf=80, K=0.5, t_anchor=0.25, C=0.75, ts=0),
 draw=TRUE
)$fASP


</code></pre>

<hr>
<h2 id='M_empirical'>Empirical formulas for the estimation of natural mortality</h2><span id='topic+M_empirical'></span>

<h3>Description</h3>

<p>Functions to calculate the instantaneous natural mortality rate (M)
according to 12 different empirical formulas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M_empirical(
  Linf = NULL,
  Winf = NULL,
  K_l = NULL,
  K_w = NULL,
  temp = NULL,
  tmax = NULL,
  tm50 = NULL,
  GSI = NULL,
  Wdry = NULL,
  Wwet = NULL,
  Bl = NULL,
  schooling = FALSE,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M_empirical_+3A_linf">Linf</code></td>
<td>
<p>infinite total length (TL) from a von Bertalanffy
growth curve in cm.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_winf">Winf</code></td>
<td>
<p>infinite weight form a von Bertalanffy growth curve
in wet weight-grams.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_k_l">K_l</code></td>
<td>
<p>is the growth coefficient (per year) from a von Bertalanffy growth
curve for length.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_k_w">K_w</code></td>
<td>
<p>is the growth coefficient (per year) from a von Bertalanffy growth
curve for weight.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_temp">temp</code></td>
<td>
<p>average annual temperature at the surface in degrees centigrade.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_tmax">tmax</code></td>
<td>
<p>the oldest age observed for the species.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_tm50">tm50</code></td>
<td>
<p>age when 50% of the population is mature [year]
(&quot;age of massive maturation&quot;).</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_gsi">GSI</code></td>
<td>
<p>gonadosomatic index (wet ovary weight over wet body weight).</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_wdry">Wdry</code></td>
<td>
<p>total dry weight in grams.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_wwet">Wwet</code></td>
<td>
<p>total wet weight at mean length in grams.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_bl">Bl</code></td>
<td>
<p>vector with body lengths in cm for size dependent mortality estimates (method = &quot;Gislason&quot;)</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_schooling">schooling</code></td>
<td>
<p>logical; if TRUE it is accounted for the schooling behaviour of
the species, only for Pauly's methods. Default is FALSE.</p>
</td></tr>
<tr><td><code id="M_empirical_+3A_method">method</code></td>
<td>
<p>vector of method names. Any combination of following methods can
be employed: &quot;AlversonCarney&quot;, &quot;Gislason&quot; (size dependent mortality estimates), &quot;GundersonDygert&quot;, &quot;Hoenig&quot;,
&quot;Lorenzen&quot;, &quot;Pauly_Linf&quot;, &quot;Pauly_Winf&quot;, &quot;PetersonWroblewski&quot;,
&quot;RikhterEfanov&quot;, &quot;Roff&quot;, &quot;Then_growth&quot;, or &quot;Then_tmax&quot;.
Please refer to Details to see which input parameters
are required by each method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function adapted from the mortality function of the fishmethods package
by Gary A. Nelson
(https://cran.r-project.org/web/packages/fishmethods/index.html).
</p>
<p>Depending on the method different input parameters are required:
</p>

<ul>
<li> <p><code>"AlversonCarney"</code> requires <code>K_l</code> and <code>tmax</code>,
</p>
</li>
<li> <p><code>"Gislason"</code> requires <code>Linf</code>, <code>K_l</code> and <code>Bl</code>,
</p>
</li>
<li> <p><code>"GundersonDygert"</code> requires <code>GSI</code>,
</p>
</li>
<li> <p><code>"Hoenig"</code> requires <code>tmax</code>,
</p>
</li>
<li> <p><code>"Lorenzen"</code> requires <code>Wwet</code>,
</p>
</li>
<li> <p><code>"Pauly_Linf"</code> requires <code>Linf</code>, <code>K_l</code> and <code>temp</code>,
</p>
</li>
<li> <p><code>"Pauly_Winf"</code> requires <code>Winf</code>, <code>K_w</code> and <code>temp</code>,
</p>
</li>
<li> <p><code>"PetersonWroblewski"</code> requires <code>Wdry</code>,
</p>
</li>
<li> <p><code>"RikhterEfanov"</code> requires <code>tm50</code>,
</p>
</li>
<li> <p><code>"Roff"</code> requires <code>K_l</code> and <code>tm50</code>,
</p>
</li>
<li> <p><code>"Then_tmax"</code> requires <code>tmax</code>,
</p>
</li>
<li> <p><code>"Then_growth"</code> requires <code>Linf</code> and <code>K_l</code>.
</p>
</li></ul>

<p>If accounting for schooling behaviour M is multiplied by 0.8 according to
Pauly (1983).
</p>


<h3>Value</h3>

<p>A matrix of M estimates.
</p>


<h3>Source</h3>

<p>https://cran.r-project.org/web/packages/fishmethods/index.html
</p>


<h3>References</h3>

<p>Alverson, D. L. and M. J. Carney. 1975. A graphic review of the growth and decay
of population cohorts. J. Cons. Int. Explor. Mer 36: 133-143.
</p>
<p>Gislason, H., N. Daan, J. C. Rice, and J. G. Pope. 2010. Size, growth,
temperature and the natural mortality of marine fish. Fish and Fisheries 11: 149-158.
</p>
<p>Gunderson, D. R. and P. H. Dygert. 1988. Reproductive effort as a predictor
of natural mortality rate. J. Cons. Int. Explor. Mer 44: 200-209.
</p>
<p>Hoenig, J. M. 1983. Empirical use of longevity data to estimate mortality rates.
Fish. Bull. 82: 898-903.
</p>
<p>Lorenzen, K. 1996. The relationship between body weight and natural mortality in
juvenile and adult fish: a comparison of natural ecosystems and aquaculture.
J. Fish. Biol. 49: 627-647.
</p>
<p>Pauly, D. 1980. On the interrelationships between natural mortality,
growth parameters, and mean environmental temperature in 175 fish stocks.
J. Cons. Int. Explor. Mer: 175-192.
</p>
<p>Pauly, D., 1983. Some simple methods for the assessment of tropical fish stocks.
<em>FAO Fish.Tech.Pap.</em>, (234): 52p. Issued also in French and Spanish
</p>
<p>Peterson, I. and J. S. Wroblewski. 1984. Mortality rate of fishes in the
pelagic ecosystem. Can. J. Fish. Aquat. Sci. 41: 1117-1120.
</p>
<p>Rikhter, V.A., and V.N. Efanov, 1976. On one of the approaches to estimation of natural
mortality of fish populations. <em>ICNAF Res.Doc.</em>, 76/VI/8: 12p.
</p>
<p>Roff, D. A. 1984. The evolution of life history parameters in teleosts.
Can. J. Fish. Aquat. Sci. 41: 989-1000.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>Then, A. Y., J. M. Hoenig, N. G. Hall, D. A. Hewitt. 2015. Evaluating the predictive
performance of empirical estimators of natural mortality rate using information on over
200 fish species. ICES J. Mar. Sci. 72: 82-92.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>M_empirical(Linf = 80, K_l = 0.5, temp = 25, tmax = 30,
     method = c("Pauly_Linf","Hoenig"))

</code></pre>

<hr>
<h2 id='plot.Bhattacharya'>Bhattacharya plot</h2><span id='topic+plot.Bhattacharya'></span>

<h3>Description</h3>

<p>This function plots the seperated frequency distributions
and selected regression lines of <a href="#topic+Bhattacharya">Bhattacharya</a> method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Bhattacharya'
plot(x, analysisPlot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Bhattacharya_+3A_x">x</code></td>
<td>
<p>a list of the class <code>"Bhattacharya"</code> containing the results of
Bhattacharya's method.</p>
</td></tr>
<tr><td><code id="plot.Bhattacharya_+3A_analysisplot">analysisPlot</code></td>
<td>
<p>logical; indicating wheter the anaylsis graph with the regression
lines should be created</p>
</td></tr>
<tr><td><code id="plot.Bhattacharya_+3A_...">...</code></td>
<td>
<p>additional options of the <code><a href="graphics.html#topic+plot">plot</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the results of the Bhattacharya method.
</p>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 data(synLFQ1)
 output &lt;- Bhattacharya(param = synLFQ1)
 plot(output)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.catchCurve'>Plotting catch curve</h2><span id='topic+plot.catchCurve'></span>

<h3>Description</h3>

<p>This function plots the results from the <code><a href="#topic+catchCurve">catchCurve</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'catchCurve'
plot(
  x,
  xaxis = "age",
  plot_selec = FALSE,
  col = c("blue", "darkgreen", "orange", "darkred"),
  cex = 1.5,
  xlim = NULL,
  ylim = NULL,
  xlab = "default",
  ylab = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.catchCurve_+3A_x">x</code></td>
<td>
<p>A list of the class <code>"catchCurve"</code> containing the results of the
catchCurve model.</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_xaxis">xaxis</code></td>
<td>
<p>Character defining if x axis should represent length or age (default: 'age')</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_plot_selec">plot_selec</code></td>
<td>
<p>logical; if TRUE the regression line is plotted for not fully
exploited length groups and the probability of capture is plotted. This
only works if the <a href="#topic+catchCurve">catchCurve</a> was applied with
<code>calc_ogive</code> == TRUE.</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_col">col</code></td>
<td>
<p>a specification for colour of regression points, line and annotation</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_cex">cex</code></td>
<td>
<p>a numerical value giving the amount by which plotting text and
symbols should be magnified relative to the default.</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_xlim">xlim</code></td>
<td>
<p>limits of x axis</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_ylim">ylim</code></td>
<td>
<p>limits of y axis</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_xlab">xlab</code></td>
<td>
<p>label of x axis. Default display by setting to &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_ylab">ylab</code></td>
<td>
<p>label of y axis. Default display by setting to &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="plot.catchCurve_+3A_...">...</code></td>
<td>
<p>standard parameters of plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function to plot the results of the catchCurve model.
</p>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(synLFQ3)
output &lt;- catchCurve(synLFQ3, calc_ogive = TRUE, reg_int = c(9,21))
plot(output, plot_selec = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.lfq'>Plotting of length frequency data (with VBGF curves)</h2><span id='topic+plot.lfq'></span>

<h3>Description</h3>

<p>This function plots length frequency (lfq) samples sequentially
arranged in time. An object
of &quot;lfq&quot; class is obatined by applying the <code><a href="#topic+lfqRestructure">lfqRestructure</a></code>
function. In case growth
parameters are known, von Bertalanffy growth curves can be plotted through the lfq samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lfq'
plot(
  x,
  Fname = "rcounts",
  par = NULL,
  agemax = NULL,
  rel = FALSE,
  y = NA,
  curve.col = 1,
  hist.sc = 0.5,
  hist.col = c("white", "black", "orange", "darkgreen"),
  image.col = NULL,
  region.col = NULL,
  zlim = NULL,
  zlimtype = "balanced",
  date.axis = "traditional",
  date.at = seq(as.Date("1500-01-01"), as.Date("2500-01-01"), by = "months"),
  date.format = "'%y-%b",
  xlab = "",
  ylab = "Length classes",
  draw = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lfq_+3A_x">x</code></td>
<td>
<p>a list of the class &quot;lfq&quot; consisting of following parameters:
</p>

<ul>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column);
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.lfq_+3A_fname">Fname</code></td>
<td>
<p>indicating whether restructured (&quot;rcounts&quot;) or original frequencies (&quot;catch&quot;) should be
displayed (default: &quot;rcounts&quot;)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_par">par</code></td>
<td>
<p>a list with following growth parameters (default NULL):
</p>

<ul>
<li> <p><strong>Linf</strong> asymptotic length,
</p>
</li>
<li> <p><strong>K</strong> growth coefficient,
</p>
</li>
<li> <p><strong>t_anchor</strong> time at length zero,
</p>
</li>
<li> <p><strong>C</strong> amplitude of growth oscillation (optional),
</p>
</li>
<li> <p><strong>ts</strong> summer point (optional);
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.lfq_+3A_agemax">agemax</code></td>
<td>
<p>maximum age of species; default NULL, then estimated from Linf</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_rel">rel</code></td>
<td>
<p>logical; defines if relative numbers per length class should be plotted (relative to
the sample size per sampling time, e.g. month). Default: FALSE.</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_y">y</code></td>
<td>
<p>an optional second list of class &quot;lfq&quot; consisting of same parameters as x. This allows to plot
samples from different sources (e.g. different fleets) on top of eachother, classes and dates have to
correspond at least partially. Default is NA.</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_curve.col">curve.col</code></td>
<td>
<p>colour of growth curves (default: 1)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_hist.sc">hist.sc</code></td>
<td>
<p>defines the scaling factor to use for maximum histogram extent (x-axis
direction). The default setting of hist.sc=0.5 will result in a maximum distance equal
to half the distance between closest sample dates (i.e. ensures no overlap and full
plotting within the plot region).</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_hist.col">hist.col</code></td>
<td>
<p>vector of 2 values defining coloring to use on negative and positive
histogram bars (default: hist.col=c(&quot;white&quot;, &quot;black&quot;, &quot;orange&quot;, &quot;darkgreen&quot;))</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_image.col">image.col</code></td>
<td>
<p>colour of image, by default (NULL) red and blue colours
are used. To remove image coloring, set image.col=NA.</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_region.col">region.col</code></td>
<td>
<p>colour of plotting region. Will overwrite image.col
(default: region.col=NULL)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_zlim">zlim</code></td>
<td>
<p>the minimum and maximum z values for which colors should be
plotted (default : NULL).</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_zlimtype">zlimtype</code></td>
<td>
<p>indicating if zlim should be based on the range of
the catch (&quot;range&quot;) or based on the maximum absolute value in Fname
(&quot;balanced&quot;, default). This parameter is only considered if zlim is NULL.</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_date.axis">date.axis</code></td>
<td>
<p>the style of the x axis. By default the &quot;traditional&quot;
approach is used with years under the months. Alternatively, by using
&quot;modern&quot; the date is plotted in one line according to the chosen
format <code>date.format</code>.</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_date.at">date.at</code></td>
<td>
<p>the points at which tick-marks are to be drawn. Non-finite
(infinite, NaN or NA) values are omitted. By default it is
seq(as.Date(&quot;1500-01-01&quot;), as.Date(&quot;2500-01-01&quot;), by=&quot;months&quot;)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_date.format">date.format</code></td>
<td>
<p>format of date  (default : &quot;%y-%b&quot;)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_xlab">xlab</code></td>
<td>
<p>label of x axis (default : &quot;&quot;)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_ylab">ylab</code></td>
<td>
<p>label of y axis (default : &quot;Length classes&quot;)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_draw">draw</code></td>
<td>
<p>logical; indicating whether growth curves should be added to
lfq plot if parameters are provided (default : TRUE)</p>
</td></tr>
<tr><td><code id="plot.lfq_+3A_...">...</code></td>
<td>
<p>additional options of the plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses <code><a href="#topic+lfqFitCurves">lfqFitCurves</a></code> when growth
parameters are provided to plot growth curves, this can be turned off with
<code>draw</code> = FALSE.
</p>


<h3>References</h3>

<p>Brey, T., Soriano, M., and Pauly, D. 1988. Electronic length frequency analysis: a revised and expanded
user's guide to ELEFAN 0, 1 and 2.
</p>
<p>Pauly, D. 1981. The relationship between gill surface area and growth performance in fish:
a generalization of von Bertalanffy's theory of growth. <em>Meeresforschung</em>. 28:205-211
</p>
<p>Pauly, D. and N. David, 1981. ELEFAN I, a BASIC program for the objective extraction of
growth parameters from length-frequency data. <em>Meeresforschung</em>, 28(4):205-211
</p>
<p>Pauly, D., 1985. On improving operation and use of ELEFAN programs. Part I: Avoiding
&quot;drift&quot; of K towards low values. <em>ICLARM Conf. Proc.</em>, 13-14
</p>
<p>Pauly, D., 1987. A review of the ELEFAN system for analysis of length-frequency data in
fish and aquatic invertebrates. <em>ICLARM Conf. Proc.</em>, (13):7-34
</p>
<p>Pauly, D. and G. R. Morgan (Eds.), 1987. Length-based methods in fisheries research.
(No. 13). WorldFish
</p>
<p>Pauly, D. and G. Gaschuetz. 1979. A simple method for fitting oscillating length growth data, with a
program for pocket calculators. I.C.E.S. CM 1979/6:24. Demersal Fish Comittee, 26 p.
</p>
<p>Pauly, D. 1984. Fish population dynamics in tropical waters: a manual for use with programmable
calculators (Vol. 8). WorldFish.
</p>
<p>Quenouille, M. H., 1956. Notes on bias in estimation. <em>Biometrika</em>, 43:353-360
</p>
<p>Somers, I. F., 1988. On a seasonally oscillating growth function. ICLARM Fishbyte 6(1): 8-11.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2): 407 p.
</p>
<p>Tukey, J., 1958. Bias and confidence in not quite large samples.
<em>Annals of Mathematical Statistics</em>, 29: 614
</p>
<p>Tukey, J., 1986. The future of processes of data analysis. In L. V. Jones (Eds.),
The Collected Works of John W. Tukey philosophy and principles of data analysis:
1965-1986 (Vol. 4, pp. 517-549). Monterey, CA, USA: Wadsworth &amp; Brooks/Cole
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alba)
res &lt;- lfqRestructure(alba)

# simple plot or reconstructed frequencies
plot(x = res, Fname = "rcounts")

# add VBGF curves
plot(res, Fname = "rcounts", par = list(Linf = 14, K = 1.1, t_anchor = 0.3))

# add soVBGF curves, adjust hist.sc and xlim
plot(res, Fname = "catch", curve.col=4,
  par = list(Linf = 14, K = 1.1, t_anchor = 0.3, C = 0.2, ts = 0.75),
  hist.sc = 0.9,
  xlim=range(res$dates)+c(-30, 0)
)

# adjust image colors
plot(res, Fname = "rcounts", image.col = NA )
plot(res, Fname = "rcounts", image.col = rev(cm.colors(21)) )
plot(res, Fname = "rcounts", image.col = colorRampPalette(c("red","grey90","green"))(21))

# solid plot region color
plot(res, xlim=range(res$dates)+c(-60, 60),
  hist.sc=0.75, image.col="grey90") # leaves gaps
plot(res, xlim=range(res$dates)+c(-60, 60),
  hist.sc=0.75, region.col="grey90") # full coverage

# low-level plot additions
plot(res)
abline(h=4, lty=2)
mtext("Restructured frequencies (MA=5)", line=0.25, side=3)



</code></pre>

<hr>
<h2 id='plot.predict_mod'>Plotting prediction models yield per recruit and Thompson &amp; Bell</h2><span id='topic+plot.predict_mod'></span>

<h3>Description</h3>

<p>This function plots objects of the class &quot;predict_mod&quot;, which are results
of the function <code><a href="#topic+predict_mod">predict_mod</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict_mod'
plot(
  x,
  type = "ypr",
  xaxis1 = "FM",
  yaxis1 = "Y_R.rel",
  yaxis2 = "B_R.rel",
  yaxis_iso = "Lc",
  identify = FALSE,
  mark = FALSE,
  contour = TRUE,
  xlab = NA,
  ylab1 = NA,
  ylab2 = NA,
  ylab3 = NA,
  plot_refs = c("F01", "Fmax", "F05", "F04"),
  cols_refs = c("goldenrod2", "darkred", "darkgreen", "darkorange"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.predict_mod_+3A_x">x</code></td>
<td>
<p>a object of the class 'predict_mod'</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_type">type</code></td>
<td>
<p>a character indicating, which type of plot should be displayed in
case of Beverton and Holt's yield per recurit model. Options are either
&quot;ypr&quot; (default) for line plot or &quot;Isopleth&quot; for isopleth plot.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_xaxis1">xaxis1</code></td>
<td>
<p>which x-axis should be plotted? Either &quot;FM&quot; (fishing mortality;
default) or &quot;E&quot; (exploitation rate).</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_yaxis1">yaxis1</code></td>
<td>
<p>which (first) y-axis should be plotted? &quot;Y_R&quot; (yield per
recruit; default) or &quot;Y_R.rel&quot; (relative yield per recruit) for type =
&quot;ypr&quot;. For &quot;Isopleth&quot; in addition: &quot;B_R&quot; (biomass per recruit) and
&quot;B_R.rel&quot; (relative yield per recruit). For Thompson and Bell model in
addition also &quot;value&quot; or &quot;catch&quot; possible.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_yaxis2">yaxis2</code></td>
<td>
<p>which second y-axis should be plotted for type = &quot;ypr&quot;? Either
&quot;B_R&quot; (biomass per recruit; default), &quot;B_R.rel&quot; (relative biomass per
recruit), or &quot;B_R.percent&quot; (percentage biomass per recruit)</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_yaxis_iso">yaxis_iso</code></td>
<td>
<p>determines label and scale of y axis of Isopleth graph.
Either &quot;Lc&quot; (default) for length at first capture or &quot;Lc/Linf&quot; for the
relation of length at first capture to the infinite length</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_identify">identify</code></td>
<td>
<p>logical; indicating whether points in the graph are supposed
to be identified by clicking on them (uses <code><a href="graphics.html#topic+locator">locator</a></code>
function). To stop press right mouse click. (default: TRUE).</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_mark">mark</code></td>
<td>
<p>logical; if value of choosen points should be displayed in graph
(default: TRUE)</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_contour">contour</code></td>
<td>
<p>used in combination with the Isopleth graph. Usage can be
logical (e.g. TRUE) or providing a numeric which indicates the number of
levels (<code>nlevels</code> in <code><a href="graphics.html#topic+contour">contour</a></code>). By default TRUE.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_xlab">xlab</code></td>
<td>
<p>Label of x-axis. If set to NA, then default &quot;Fishing mortality&quot;,
or &quot;Exploitation rate&quot; is used.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_ylab1">ylab1</code></td>
<td>
<p>Label of y-axis. If set to NA, then default &quot;Yield&quot; is used for
the Thompson and Bell model, &quot;Lc&quot; is used for the Isopleth graph, and
&quot;Y/R&quot; is used for ypr.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_ylab2">ylab2</code></td>
<td>
<p>Label of second y-axis. If set to NA, then default &quot;Biomass&quot; is
used for the Thompson and Bell model and &quot;B/R&quot; for ypr.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_ylab3">ylab3</code></td>
<td>
<p>Label of third y-axis. If set to NA, then default &quot;Value&quot; is
used for the Thompson and Bell model.</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_plot_refs">plot_refs</code></td>
<td>
<p>Define reference points to be plotted. Default:
c(&quot;F01&quot;,&quot;Fmax&quot;,&quot;F05&quot;,&quot;F04&quot;)</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_cols_refs">cols_refs</code></td>
<td>
<p>Define colours for reference points. Default:
c(&quot;goldenrod2&quot;,&quot;darkred&quot;,&quot;darkgreen&quot;,&quot;darkorange&quot;)</p>
</td></tr>
<tr><td><code id="plot.predict_mod_+3A_...">...</code></td>
<td>
<p>optional parameters of plot function</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Nemipterus marginatus - age structured data
threadfin &lt;- list(Winf = 286,K = 0.37, t0 = -0.2, M = 1.1, tr = 0.4)

output &lt;- predict_mod(threadfin, FM_change = seq(0,6,0.1),
   tc_change = seq(0.2,1,0.2), type = 'ypr')
plot(output)

# hake - length structured data
data(hake)
hake$Lr &lt;- 35
select.list &lt;- list(selecType = 'trawl_ogive', L50 = 20, L75 = 24)
output &lt;- predict_mod(param = hake, FM_change = seq(0,0.4,0.05),
                      curr.E = 0.4, curr.Lc = 40,
                      Lc_change = seq(5,80,1), s_list = select.list,
                      type = 'ypr', plot = FALSE)
plot(output, type = "Isopleth", xaxis1 = "FM", yaxis1 = "Y_R.rel",
   identify = FALSE)


## End(Not run)
</code></pre>

<hr>
<h2 id='plot.prod_mod'>Plotting production models</h2><span id='topic+plot.prod_mod'></span>

<h3>Description</h3>

<p>This function plots CPUE and yield values against fishing effort
resulting from the production models (<a href="#topic+prod_mod">prod_mod</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prod_mod'
plot(x, display_MSY = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.prod_mod_+3A_x">x</code></td>
<td>
<p>a object of the class <code>"prod_mod"</code></p>
</td></tr>
<tr><td><code id="plot.prod_mod_+3A_display_msy">display_MSY</code></td>
<td>
<p>logical; should MSY be displayed in the graph?</p>
</td></tr>
<tr><td><code id="plot.prod_mod_+3A_...">...</code></td>
<td>
<p>optional parameters of plot function</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fox, W. W. Jr., 1970. An exponential surplus-yield model for optimizing exploited fish
populations. <em>Trans.Am.Fish.Soc.</em>, 99:80-88
</p>
<p>Graham, M., 1935. Modern theory of exploiting a fishery and application to North Sea
trawling. <em>J.Cons.CIEM</em>, 10(3):264-274
</p>
<p>Schaefer, M., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Bull.I-ATTC/Bol. CIAT</em>, 1(2):27-56
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trawl_fishery_Java)
output &lt;-  prod_mod(data = trawl_fishery_Java)
plot(output, display_years = TRUE)

</code></pre>

<hr>
<h2 id='plot.prod_mod_ts'>Plotting time series production models</h2><span id='topic+plot.prod_mod_ts'></span>

<h3>Description</h3>

<p>This function plots objects of the class &quot;prod_mod_ts&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'prod_mod_ts'
plot(x, correlation_plots = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.prod_mod_ts_+3A_x">x</code></td>
<td>
<p>a object of the class &quot;prod_mod_ts&quot;,</p>
</td></tr>
<tr><td><code id="plot.prod_mod_ts_+3A_correlation_plots">correlation_plots</code></td>
<td>
<p>logical; indicating if correlation plots should be displayed</p>
</td></tr>
<tr><td><code id="plot.prod_mod_ts_+3A_...">...</code></td>
<td>
<p>additional parameters of the <a href="graphics.html#topic+plot">plot</a> function</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dharmendra, D., Solmundsson, J., 2005. Stock assessment of the offshore Mauritian banks
using dynamic biomass models and analysis of length frequency of the Sky Emperor
(<em>Lethrinus mahsena</em>). Fisheries Training Program The United Nations University, 61
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(emperor)
output &lt;-  prod_mod_ts(emperor, method  = "Fox")
plot(output, correlation_plots = TRUE)

</code></pre>

<hr>
<h2 id='plot.recruitment'>Plot of recruitment patterns</h2><span id='topic+plot.recruitment'></span>

<h3>Description</h3>

<p>This function plots the recruitment patterns from the
<a href="#topic+recruitment">recruitment</a> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'recruitment'
plot(
  x,
  percent = TRUE,
  col = "darkgreen",
  xtitle = "default",
  ytitle = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.recruitment_+3A_x">x</code></td>
<td>
<p>list of the class <code>"recruitment"</code></p>
</td></tr>
<tr><td><code id="plot.recruitment_+3A_percent">percent</code></td>
<td>
<p>logical; should number of recruits be relative (percentage)?</p>
</td></tr>
<tr><td><code id="plot.recruitment_+3A_col">col</code></td>
<td>
<p>colour of bars (default is &quot;darkgreen&quot;)</p>
</td></tr>
<tr><td><code id="plot.recruitment_+3A_xtitle">xtitle</code></td>
<td>
<p>title of x axis (default &quot;rel. months&quot; or no title, respectively)</p>
</td></tr>
<tr><td><code id="plot.recruitment_+3A_ytitle">ytitle</code></td>
<td>
<p>title of y axis (default &quot;# Recruits&quot; or &quot;Recruits [%]&quot;, respectively)</p>
</td></tr>
<tr><td><code id="plot.recruitment_+3A_...">...</code></td>
<td>
<p>standard parameters of <code><a href="graphics.html#topic+barplot">barplot</a></code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- list(midLengths = seq(2,98,4),
               catch = c(0.6,17.6,93,83.2,12.6,0.3,0,0,0,1,17.1,51.4,
               26.1,2.2,0.2,4.5,21.6,17.6,3.7,8.7,10.6,6.3,5.6,2.9,0.8),
               Linf = 100,
               K = 0.5)
output &lt;- recruitment(param = dat, tsample = 0.25)
plot(output, percent = FALSE)

</code></pre>

<hr>
<h2 id='plot.select'>Selectivity plot</h2><span id='topic+plot.select'></span>

<h3>Description</h3>

<p>This function plots the selectivity estimates of the
function <code><a href="#topic+select">select</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'select'
plot(x, regression_fit = TRUE, cols = c("darkgreen", "orange"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.select_+3A_x">x</code></td>
<td>
<p>a list of the class <code>"select"</code> containing the results of the
gillnet selectivity function.</p>
</td></tr>
<tr><td><code id="plot.select_+3A_regression_fit">regression_fit</code></td>
<td>
<p>logical; indicating if a plot with the fit of the regression
line should be displayed</p>
</td></tr>
<tr><td><code id="plot.select_+3A_cols">cols</code></td>
<td>
<p>a specification for the two colours of the two selection curves.
Default is c(&quot;darkgreen&quot;,&quot;orange&quot;).</p>
</td></tr>
<tr><td><code id="plot.select_+3A_...">...</code></td>
<td>
<p>additional parameters of the <a href="graphics.html#topic+plot">plot</a> function</p>
</td></tr>
</table>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tilapia)
output &lt;- select(tilapia, plot = FALSE)
plot(output, regression_fit = TRUE)

data(bream)
output &lt;- select(bream, plot = FALSE)
plot(output, regression_fit = TRUE)

</code></pre>

<hr>
<h2 id='plot.select_Millar'>Millar's selectivity plot</h2><span id='topic+plot.select_Millar'></span>

<h3>Description</h3>

<p>This function plots the selectivity estimates of Millar's
selectivity model (<code><a href="#topic+select_Millar">select_Millar</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'select_Millar'
plot(
  x,
  plotlens = NULL,
  standardise = TRUE,
  deviance_plot = TRUE,
  selectivity_plot = TRUE,
  xlab_dev = "Length [cm]",
  xlab_sel = "Length [cm]",
  ylab_dev = "Mesh size [cm]",
  ylab_sel = "Relative retention",
  title_dev = "Deviance residuals",
  title_sel = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.select_Millar_+3A_x">x</code></td>
<td>
<p>a list of the class <code>"select_Millar"</code> containing the results of
Millar's selectivity model</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_plotlens">plotlens</code></td>
<td>
<p>A vector with lengths which should be used for drawing the
selection curves</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_standardise">standardise</code></td>
<td>
<p>A parameter indicating if the retention should be realtive
to the maximum value (Default: TRUE).</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_deviance_plot">deviance_plot</code></td>
<td>
<p>logical (Default: TRUE); indicating whether a plot of deviance residuals should
be displayed</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_selectivity_plot">selectivity_plot</code></td>
<td>
<p>logical (Default: TRUE); indicating whether a plot of relative retention selectivities
should be displayed</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_xlab_dev">xlab_dev</code></td>
<td>
<p>character string. Label for x axis of deviance plot. Default: &quot;Length [cm]&quot;</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_xlab_sel">xlab_sel</code></td>
<td>
<p>character string. Label for x axis of selectivity plot. Default: &quot;Length [cm]&quot;</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_ylab_dev">ylab_dev</code></td>
<td>
<p>character string. Label for y axis of deviance plot. Default: &quot;Mesh size [cm]&quot;</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_ylab_sel">ylab_sel</code></td>
<td>
<p>character string. Label for y axis of selectivity plot. Default: &quot;Relative retention&quot;.</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_title_dev">title_dev</code></td>
<td>
<p>character string. Label for main title of deviance plot. Default: &quot;Deviance residuals&quot;.</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_title_sel">title_sel</code></td>
<td>
<p>character string. Label for main title of selectivity plot. Default is
taken from the results of the select_Millar (e.g. res$rtype).</p>
</td></tr>
<tr><td><code id="plot.select_Millar_+3A_...">...</code></td>
<td>
<p>additional parameter options from plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function draws a selectivity plot for the object class
<code>"select_Millar"</code>, which is created by applying Millar's selectivity model
<code><a href="#topic+select_Millar">select_Millar</a></code>.
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3), 471-477.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gillnet)

output &lt;- select_Millar(gillnet, x0 = c(60,4), rel.power = rep(1,8),
   rtype = "norm.loc", plot = FALSE)

plot(output, plotlens = seq(40,90,0.1), deviance_plot = FALSE)

</code></pre>

<hr>
<h2 id='plot.VPA'>VPA plot</h2><span id='topic+plot.VPA'></span>

<h3>Description</h3>

<p>This function plots the survivors, catches, natural losses, and fishing
mortality resulting from the <a href="#topic+VPA">VPA</a> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VPA'
plot(
  x,
  yaxis = "numbers",
  display_last_class = TRUE,
  xlabel = NA,
  ylabel1 = "Population",
  ylabel2 = "Fishing mortality",
  ylim = NA,
  ylim_FM = NA,
  plot.bars = TRUE,
  plot.FM = TRUE,
  plot.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.VPA_+3A_x">x</code></td>
<td>
<p>list of the class <code>"VPA"</code> containing the results of the VPA model.</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_yaxis">yaxis</code></td>
<td>
<p>indicating which variable should be displayed on the y axis, either &quot;numbers&quot; or &quot;biomass&quot;.</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_display_last_class">display_last_class</code></td>
<td>
<p>logical; should last age/length class be displayed in graph?</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_xlabel">xlabel</code></td>
<td>
<p>Label of the x axis</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_ylabel1">ylabel1</code></td>
<td>
<p>Label of the first y axis</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_ylabel2">ylabel2</code></td>
<td>
<p>Label of the second y axis</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_ylim">ylim</code></td>
<td>
<p>limits of y axis</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_ylim_fm">ylim_FM</code></td>
<td>
<p>limits of y axis of fishing mortality plot</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_plot.bars">plot.bars</code></td>
<td>
<p>logical; should the barplot of survivors, nat.losses and catch
be displayed? (Default: TRUE)</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_plot.fm">plot.FM</code></td>
<td>
<p>logical; should the fishing mortality be displayed in the graph? (Default: TRUE)</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_plot.legend">plot.legend</code></td>
<td>
<p>logical; should a legend be displayed in the graph? (Default: TRUE)</p>
</td></tr>
<tr><td><code id="plot.VPA_+3A_...">...</code></td>
<td>
<p>standard parameters of <code><a href="graphics.html#topic+barplot">barplot</a></code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(whiting)
output &lt;- VPA(whiting, terminalF = 0.5)
plot(output, display_last_class = FALSE)

data(hake)
output &lt;- VPA(hake, terminalE = 0.5, catch_unit = "'000")
plot_mat &lt;- output$plot_mat[,-c(1,2)]  # remove first two length classes
class(plot_mat) &lt;- "VPA"
plot(plot_mat, xlabel = "Midlengths [cm]")

</code></pre>

<hr>
<h2 id='powell_wetherall'>Powell-Wetherall method</h2><span id='topic+powell_wetherall'></span>

<h3>Description</h3>

<p>A method to estimate the instantaneous total mortality rate (Z) and
the infinite length of the von Bertalanffy growth equation
(Powell, 1979; Wetherall et al., 1987).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powell_wetherall(
  param,
  catch_columns = NA,
  savePlots = FALSE,
  reg_int = NULL,
  main = "Powell-Wetherall plot"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powell_wetherall_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li>  <p><code>midLengths</code>: midpoints of the length groups,
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch,
</p>
</li>
<li> <p><code>catch</code>: catch as vector, or a matrix with catches of subsequent years;
</p>
</li></ul>
</td></tr>
<tr><td><code id="powell_wetherall_+3A_catch_columns">catch_columns</code></td>
<td>
<p>optional; in case catch is a matrix or data.frame, a number
indicating which column of the matrix should be analysed (Default: <code>NA</code>).</p>
</td></tr>
<tr><td><code id="powell_wetherall_+3A_saveplots">savePlots</code></td>
<td>
<p>logical; if TRUE the plot is recorded. Default is FALSE.</p>
</td></tr>
<tr><td><code id="powell_wetherall_+3A_reg_int">reg_int</code></td>
<td>
<p>instead of using the identity method a range can be determined,
which is to be used for the regression analysis. If equal to NULL identity method
is applied (default).</p>
</td></tr>
<tr><td><code id="powell_wetherall_+3A_main">main</code></td>
<td>
<p>title of plot (Default is &quot;Powell-Wetherall plot&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first length group or age class within the list object <code>midLengths</code> or
<code>age</code> will be used as the Lprim or tprime (length of recruitment to fishery).
This function includes the
<code>identify</code> function, which asks you to choose two points from a graph manually. The
two points which you choose by clicking on the plot in the graphical device represent
the start and end of the data points, which should be used for the analysis. Based
on these points the regression line is calculated. The Powell and Wetherall method
only works with length-frequency data.
</p>


<h3>Value</h3>

<p>A list with the input parameters and follwing objects:
</p>

<ul>
<li> <p><strong>tmean</strong> or <strong>Lmean</strong>: mean age or length of fish,
</p>
</li>
<li> <p><strong>Z</strong>: total mortality;</p>
</li></ul>

<p>and/or following objects when applying the Powell and Wetherall method:
</p>

<ul>
<li> <p><strong>Lmean_Lprime</strong>: dependent variable for regression analysis,
</p>
</li>
<li> <p><strong>Lprime</strong>: some length for which all fish of that length and
longer are under full exploitation,
</p>
</li>
<li> <p><strong>Linf_est</strong>: infinite length in [cm] (Linf),
</p>
</li>
<li> <p><strong>se_Linf</strong>: standard error of Linf,
</p>
</li>
<li> <p><strong>confidenceInt_Linf</strong>: confidence interval for Linf,
</p>
</li>
<li> <p><strong>ZK</strong>: total mortality divided by K (Z/K),
</p>
</li>
<li> <p><strong>se_ZK</strong>: standard error of Z/K,
</p>
</li>
<li> <p><strong>confidenceInt_ZK</strong>: confidence interval of Z/K;
</p>
</li></ul>



<h3>References</h3>

<p>Powell, D.G., 1979. Estimation of mortality and growth parameters from the length-
frequency of a catch. <em>Rapp.P.-v.Reun.CIEM</em>, 175:167-169
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>Wetherall, J.A., J.J. Polovina and S. Ralston, 1987. Estimating growth and mortality
in steady-state fish stocks from length-frequency data. <em>ICLARM Conf.Proc.</em>,
(13):53-74
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(synLFQ3)
powell_wetherall(synLFQ3)

data(synLFQ5)
powell_wetherall(synLFQ5, catch_columns = 1:12)


</code></pre>

<hr>
<h2 id='predict_mod'>Prediction models</h2><span id='topic+predict_mod'></span>

<h3>Description</h3>

<p>This function applies Beverton &amp; Holt's yield per recruit model
as well as the Thompson &amp; Bell model. These models predict catch, yield, biomass
and economic values for different
fishing mortality scenarions (in combination with gear changes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_mod(
  param,
  type,
  FM_change = NA,
  E_change = NA,
  FM_relative = FALSE,
  Lc_change = NULL,
  tc_change = NULL,
  s_list = NA,
  stock_size_1 = NA,
  age_unit = "year",
  curr.E = NA,
  curr.Lc = NA,
  plus_group = NA,
  Lmin = NA,
  Lincr = NA,
  plot = FALSE,
  mark = TRUE,
  hide.progressbar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_mod_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters (not all are required):
</p>

<ul>
<li> <p><strong>Linf</strong> or <strong>Winf</strong>: infinite length or weight, respectively,
for investigated species in cm [cm],
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>t0</strong>: theoretical time zero, at which individuals of this species
hatch,
</p>
</li>
<li> <p><strong>M</strong>: natural mortality or
</p>
</li>
<li> <p><strong>Z</strong>: total mortality,
</p>
</li>
<li> <p><strong>FM</strong>: fishing mortality,
</p>
</li>
<li> <p><strong>a</strong>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><strong>b</strong>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><strong>Lr</strong> or <strong>tr</strong>: length or age of recruitment;</p>
</li></ul>

<p>additional list objects for the Thompson and Bell model:
</p>

<ul>
<li> <p><strong>midLengths</strong> or <strong>age</strong>: midpoints of the length classes
(length-frequency data) or ages (age composition data),
</p>
</li>
<li> <p><strong>meanWeight</strong>: vector with mean weight per length group or age class,
</p>
</li>
<li> <p><strong>meanValue</strong>: vector with mean value per length group or age class,
</p>
</li></ul>
</td></tr>
<tr><td><code id="predict_mod_+3A_type">type</code></td>
<td>
<p>indicating which model should be applied: <code>"ypr"</code> for Beverton
and Holt's yield per recruit model and <code>"ThompBell"</code> for the Thompson and Bell model</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_fm_change">FM_change</code></td>
<td>
<p>vector with ascending fishing mortalities (if <code>FM_relative</code>
is set to TRUE, values can also be relative (only for Thompson and Bell model).
Default are absolute values from 0 to 10). Or</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_e_change">E_change</code></td>
<td>
<p>vector with ascending absolute exploitation rates;</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_fm_relative">FM_relative</code></td>
<td>
<p>logical; indicating whether <code>FM_change</code> is relative or
absolute. Default is FALSE (absolute fishing mortalities in <code>FM_change</code>).</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_lc_change">Lc_change</code></td>
<td>
<p>vector with ascending lengths at first capture (Lc), or</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_tc_change">tc_change</code></td>
<td>
<p>vector with ascending ages at first capture (tc)</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_s_list">s_list</code></td>
<td>
<p>list with selectivity parameters</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_stock_size_1">stock_size_1</code></td>
<td>
<p>stock size of smallest size class, if NA values are calculated
relative to a stock size of 1000 individuals</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_age_unit">age_unit</code></td>
<td>
<p>in which time unit the data is provided? &quot;month&quot; or &quot;year&quot;</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_curr.e">curr.E</code></td>
<td>
<p>current exploitation rate if available</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_curr.lc">curr.Lc</code></td>
<td>
<p>current Lc (length at first capture) if available</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_plus_group">plus_group</code></td>
<td>
<p>if a value is provided, a plus group is created comprising this
size class and all above</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_lmin">Lmin</code></td>
<td>
<p>smallest length group where to start with selection ogive. Not required
for &quot;knife_edge&quot; selection type</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_lincr">Lincr</code></td>
<td>
<p>arbitrary length increment between length groups for estimation of
selection ogive. The smaller the higher the resolution but the slower the model
run. Not required for &quot;knife_edge&quot; selection type</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE results are displayed graphically</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_mark">mark</code></td>
<td>
<p>logical; if value of choosen points should be displayed in graph (default: TRUE)</p>
</td></tr>
<tr><td><code id="predict_mod_+3A_hide.progressbar">hide.progressbar</code></td>
<td>
<p>logical; should progressbar be displayed or hidden? (Default: FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Thompson and Bell model incorporates an iteration step simulating the
stock by means
of the <code><a href="#topic+stock_sim">stock_sim</a></code> function. In case changes in gear
characteristics -
here measured in terms of Lc or tc, the length or age at first capture,
respectively -
should be explored, a list with selectivity information about the gear has
to be provided and
the prediction models make use of the selectivity <code><a href="#topic+select_ogive">select_ogive</a></code>
function.
Sparre and Venema (1998) recommend to treat the last length class always as plus group.
This model is very sensitive to zero observations in the ultimate length
classes. If unrealistic results are returned,
it is recommended to cut length classes with zero observations, group
them in a plus group or to change the interval between
length classes.
Equations which are used in this function assume isometric growth, an
assumption often not met. Further, the assumption that there is no relationship
between the parental stock size and progeny
over a wide range of fishing mortalities or exploitation values,
respectively, is also said to be untrue. By default, the functions assume
knife-edge recruitment and selection of gears (Sparre and Venema, 1998).
If E_change instead of FM_change is used the range is cut at E=0.9, because
higher values of E correspond to unrealistic high values of fishing mortality.
If no selectivity information is given (by use of s_list), knife edge selectivity
with L50 equal to the first argument of Lc_change is assumed.
</p>


<h3>Value</h3>

<p>A list with the input parameters and dependent on the model type following
list objects:
</p>

<ul>
<li> <p><code>type = 'ypr'</code>
</p>

<ul>
<li> <p><strong>FM</strong>: fishing mortalities,
</p>
</li>
<li> <p><strong>Lc</strong> or <strong>tc</strong>: lengths or ages at first capture,
</p>
</li>
<li> <p><strong>list_Lc_runs</strong>: a list with dataframes for each Lc value:
</p>

<ul>
<li> <p><strong>FM_change</strong>: fishing mortalities
</p>
</li>
<li> <p><strong>E</strong>: expoitation rates
</p>
</li>
<li> <p><strong>Ty</strong>: mean age in annual yield
</p>
</li>
<li> <p><strong>LY</strong>: mean length in annual yield
</p>
</li>
<li> <p><strong>Wy</strong>: mean weight in annual yield
</p>
</li>
<li> <p><strong>Y_R.rel</strong>: relative yield per recruit (change in catch in
weigth per recruit relative to initial Y/R value)
</p>
</li>
<li> <p><strong>B_R.rel</strong>: relative biomass per recruit
</p>
</li>
<li> <p><strong>Y_R</strong>: yield per recurit (catch in weight per recruit)
</p>
</li>
<li> <p><strong>B_R</strong>: biomass per recruit
</p>
</li>
<li> <p><strong>B_R.percent</strong>: percentage biomass per recurit in relation to virgin
biomass per recruit
</p>
</li></ul>

</li>
<li> <p><strong>df_Es</strong>: a dataframe with references points (columns) for
different Lc values (rows)
</p>
</li>
<li> <p><strong>df_current</strong>: a dataframe with the exploitation status, yield
and biomass values of current exploitation or selectivity (if E_curr or
Lc_tc_curr provided).
</p>
</li></ul>

</li>
<li> <p><code>type = 'ThompBell'</code>
</p>

<ul>
<li> <p><strong>dt</strong>: delta t,
</p>
</li>
<li> <p><strong>N</strong>: population number,
</p>
</li>
<li> <p><strong>dead</strong>: deaths due to natural reasons,
</p>
</li>
<li> <p><strong>C</strong>: catch,
</p>
</li>
<li> <p><strong>Y</strong>: yield,
</p>
</li>
<li> <p><strong>B</strong>: biomass,
</p>
</li>
<li> <p><strong>V</strong>: value,
</p>
</li>
<li> <p><strong>totals</strong>: summed up values (total catch, total yield, total value, average biomass),
</p>
</li>
<li> <p><strong>totC</strong>: total catches for different x factors,
</p>
</li>
<li> <p><strong>totY</strong>: total yield values for different x factors,
</p>
</li>
<li> <p><strong>totV</strong>: total values for different x factors,
</p>
</li>
<li> <p><strong>meanB</strong>: average biomasses for different x factors,
</p>
</li>
<li> <p><strong>F_change</strong>: fishing mortality changes;
</p>
</li></ul>

</li>
<li> <p><code>type = 'ThompBell'</code> and <code>Lc_change</code> provided
</p>

<ul>
<li> <p><strong>FM_change</strong>: fishing mortality changes,
</p>
</li>
<li> <p><strong>Lc_change</strong>: changes in length at first capture,
</p>
</li>
<li> <p><strong>Lt</strong>: lengths at age,
</p>
</li>
<li> <p><strong>sel</strong>: probability of capture,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.C</strong>: catch matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.Y</strong>: yield matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.V</strong>: value matrix for all fishing mortality and Lc/tc combinations,
</p>
</li>
<li> <p><strong>mat_FM_Lc_com.B</strong>: biomass matrix for all fishing mortality and Lc/tc combinations;
</p>
</li></ul>

</li></ul>



<h3>References</h3>

<p>Berkeley, S.A., and Houde, E.D., 1980. Swordfish, Xiphias gladius, dynamics in
the Straits of Florida. <em>ICES C.M.</em>, 11.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1964. Table of yield functions for fishery
management. <em>FAO Fish. Tech. Pap.</em> 38, 49 p.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1966. Manual of methods for fish stock
assessment. Pt. 2: Tables of yield functions. <em>FAO Fisheries Technical Paper</em>,
(38)Rev.1:67 p.
</p>
<p>Boerema, L.K., and J.A. Gulland, 1973. Stock assessment of the Peruvian anchovy
(Engraulis ringens) and management of the fishery. <em>Journal of the Fisheries
Board of Canada</em>, 30(12):2226-2235
</p>
<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>
<p>Gulland, J.A., 1983. Fish stock assessment: a manual of basic methods.
<em>FAO/Wiley</em>, New York.
</p>
<p>Gulland, J.A. and Boerema, L., 1973. Scientific advice on catch levels.
<em>Fish. Bull. (US)</em> 71:325-335.
</p>
<p>Jones, R.E. 1957. A much simplified version of the fish yield equation. Doc. No.
P. 21. Paper presented at the Lisbon joint meeting of International Commission
Northwest Atlantic-Fisheries, International Council for the Exploration of the
Sea, and Food and Agriculture Organization of the United Nations. 8 p. [Mimeo].
</p>
<p>Millar, R.B., and Holst, R., 1997. Estimation of gillnet and hook selectivity using
log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Pauly, D., 1980. A selection of simple methods for the assessment of tropical fish
stocks. <em>FAO Fisheries Circulars (FAO)</em>. no. 729.
</p>
<p>Pauly, D., 1984. Fish population dynamics in tropical waters: a manual for use
with programmable calculators. <em>ICLARM</em> Stud. Rev. 8, 325 p.
</p>
<p>Pauly, D. and M. Soriano. 1986. Some practical extensions to Beverton and
Holt's relative yield-per-recruit model, p. 491-495. In J.L. Maclean, L.B. Dizon
and L.V. Hosillos (eds.) The First Asian Fisheries Forum. Asian Fisheries Society,
Manila.
</p>
<p>Schaefer, M.B., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Inter-Am. Trop. Tuna Comm.,
Bull.</em> 1(2):27-56.
</p>
<p>Schaefer, M.B., 1957. A study of the dynamics of the fishery for yellowfin tuna
in the eastern tropical Pacific Ocean. <em>Inter-Am. Trop. Tuna Comm., Bull.</em>
2:247-268.
</p>
<p>Sparre, P., and Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#______________________________________
# Yiel Per Recruit (YPR) / Beverton and Holt's model
#______________________________________
# age structured data
# Nemipterus marginatus
threadfin &lt;- list(Winf = 286, K = 0.37, t0 = -0.2, M = 1.1, tr = 0.4)

predict_mod(threadfin, FM_change = seq(0,6,0.1),
   tc_change = seq(0.2,1,0.2), type = 'ypr')

# Leiognathus spendens (Pauly, 1980)
ponyfish &lt;- list(Winf = 64, K = 1, t0 = -0.2, M = 1.8, tr = 0.2)

predict_mod(ponyfish, tc_change = c(0.2,0.3,1.0), type = 'ypr', plot=TRUE)

#______________________________________
# length structured data
# Xiphias gladius (Berkeley and Houde, 1980)
swordfish &lt;- list(Linf = 309, K = 0.0949, M = 0.18,
                  a = 0.0003, b = 3, Lr = 90)

select.list &lt;- list(selecType = 'trawl_ogive', L50 = 120, L75 = 132)
#swordfish$midLengths &lt;- seq(60,300,5)

output &lt;- predict_mod(param = swordfish, Lc_change = c(100,118,150,180),
            s_list = select.list, type = 'ypr', Lmin = 90, Lincr = 8)
plot(output)

data(hake)
hake$Lr &lt;- 35
select.list &lt;- list(selecType = 'trawl_ogive', L50 = 50, L75 = 54)
output &lt;- predict_mod(param = hake, FM_change = seq(0,3,0.05),
                      Lc_change = seq(30,70,1), s_list = select.list,
                      type = 'ypr', plot = FALSE, curr.Lc = 50, curr.E = 0.73)
plot(output, type = "Isopleth", xaxis1 = "FM", yaxis1 = "Y_R.rel", mark = TRUE)

output &lt;- predict_mod(param = hake, E_change = seq(0,1,0.1),
                      Lc_change = seq(2,120,2), #s_list = select.list,
                      type = 'ypr', plot = FALSE)
plot(output, type = "Isopleth", xaxis1 = "E", yaxis1 = "B_R")

#______________________________________
#      Thompson and Bell model
#______________________________________
# with age structured data
data(shrimps)

output &lt;- predict_mod(param = shrimps, FM_change = seq(0.1,20,0.1),
     type = "ThompBell", age_unit = "month", plot = TRUE)

#______________________________________
# with length structured data
data(hake)
par(mar = c(5, 4, 4, 7))
predict_mod(param = hake,FM_change = seq(0.1,3,0.05),
     type = 'ThompBell', plot = TRUE)

# create list with selectivity information
select.list &lt;- list(selecType = 'trawl_ogive', L50 = 50, L75 = 55)

output &lt;- predict_mod(param = hake, FM_change = seq(0,2,0.1),
     Lc_change = seq(20,70,1),
     curr.E = 0.4, curr.Lc = 50,
     type = 'ThompBell', s_list = select.list)
plot(output, xaxis1 = "FM", yaxis_iso = "Lc", yaxis1 = "B_R", mark = TRUE)


</code></pre>

<hr>
<h2 id='prod_mod'>Production models</h2><span id='topic+prod_mod'></span>

<h3>Description</h3>

<p>Production models are holistic models, which
can be used to estimate maximum sustainable yield (MSY) and virgin biomass. This
function uses the equilibrium approach to estimate parameters (Schaefer model and
Fox model).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prod_mod(data, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prod_mod_+3A_data">data</code></td>
<td>
<p>a dataframe consisting of:
</p>

<ul>
<li> <p><code>year</code> year vector,
</p>
</li>
<li> <p><code>Y</code> catch in weight per year, and
</p>
</li>
<li> <p><code>f</code> fishing effort per year, or
</p>
</li>
<li> <p><code>CPUE</code> catch per unit of effort per year (optional).
</p>
</li></ul>
</td></tr>
<tr><td><code id="prod_mod_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE, a graph is displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Production models are also called surplus production models or
biomass dynamic models. They can be applied if sufficient data are available: effort
and yield parameters have to be expended over a certain number of years. Furthermore,
the fishing effort must have undergone substantial changes over the period covered
(Sparre and Venema, 1998). Either the catch per unit of effort (CPUE) is inserted
into the model directly (objectname: <code>CPUE</code>) or the CPUE is calculated from
the catch and effort, then these two vectors should have required units. There
are three ways of estimating paramaters of production models, (i) assuming
equlibrium conditions, (ii) transforming equation to linear form, or (iii)
time-series fitting (Hilborn and Walters, 1992). The first approach corresponds
to the Schaefer and Fox model and thus the methodology of this function.
The authors recommend to use dynamic fitting methods when possible rather than
the equilibrium approach. For dynamic production models please refer
to <a href="#topic+prod_mod_ts">prod_mod_ts</a>.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>Schaefer_lm</strong>: intercept and slope of linear model following
the Schaefer model,
</p>
</li>
<li> <p><strong>Fox_lm</strong>: intercept and slope of linear model following
the Fox model,
</p>
</li>
<li> <p><strong>Schaefer_MSY</strong>: MSY according to Schaefer model,
</p>
</li>
<li> <p><strong>Schaefer_fMSY</strong>: fishing effort yielding in MSY according to
Schaefer model,
</p>
</li>
<li> <p><strong>Schaefer_Bv</strong>: virgin biomass according to Schaefer model,
</p>
</li>
<li> <p><strong>ln_CPUE</strong>: natural logarithm of CPUE values,
</p>
</li>
<li> <p><strong>Fox_MSY</strong>: MSY according to Fox model,
</p>
</li>
<li> <p><strong>Fox_fMSY</strong>: fishing effort yielding in MSY according to Fox model,
</p>
</li>
<li> <p><strong>Fox_Bv</strong>: virgin biomass according to Fox model.
</p>
</li></ul>



<h3>References</h3>

<p>Fox, W. W. Jr., 1970. An exponential surplus-yield model for optimizing exploited fish
populations. <em>Trans.Am.Fish.Soc.</em>, 99:80-88
</p>
<p>Graham, M., 1935. Modern theory of exploiting a fishery and application to North Sea
trawling. <em>J.Cons.CIEM</em>, 10(3):264-274
</p>
<p>Hilborn, R., Walters, C. J. (1992). Quantitative fisheries stock assessment:
choice, dynamics and uncertainty. <em>Reviews in Fish Biology and Fisheries</em>, 2(2),
177-178.
</p>
<p>Schaefer, M., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Bull.I-ATTC/Bol. CIAT</em>, 1(2):27-56
</p>
<p>Schaefer, M., 1957. A study of the dynamics of the fishery for yellowfin tuna of the
eastern tropical Pacific Ocean [in English and Spanish]. <em>Ibid.</em>, 2(6): 245-285
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trawl_fishery_Java)
prod_mod(data = trawl_fishery_Java, plot = TRUE)

</code></pre>

<hr>
<h2 id='prod_mod_ts'>Production models with time series fitting</h2><span id='topic+prod_mod_ts'></span>

<h3>Description</h3>

<p>This function applies the production models under non-equilibrium
conditions by applying time series fitting using non-linear least squares
minimisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prod_mod_ts(
  data,
  method = "Schaefer",
  B0_init = NA,
  B0_est = NA,
  effort_unit = 1,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prod_mod_ts_+3A_data">data</code></td>
<td>
<p>a dataframe of parameters
</p>

<ul>
<li> <p><code>year</code> years,
</p>
</li>
<li> <p><code>yield</code> catch in weight of fishery per year,
</p>
</li>
<li> <p><code>effort</code> fishing effort per year,
</p>
</li>
<li> <p><code>CPUE</code> catch per unit of effort per year (optional).
</p>
</li></ul>
</td></tr>
<tr><td><code id="prod_mod_ts_+3A_method">method</code></td>
<td>
<p>indicating if Schaefer or Fox model should be applied. First assumes a
logistic relationship between growth rate and biomass, whereas second assumes it to
foolow the Gompertz distribution (Richards 1959). Default is the dynamic Schaefer model.</p>
</td></tr>
<tr><td><code id="prod_mod_ts_+3A_b0_init">B0_init</code></td>
<td>
<p>numeric; if realistic initial estimate for virgin biomass is available.
If NA initial estimate for virgin biomass is set to two times average yield of all
or part of yield values (see <code>B0_est</code>).</p>
</td></tr>
<tr><td><code id="prod_mod_ts_+3A_b0_est">B0_est</code></td>
<td>
<p>intital value of virgin biomass estimating using all yield values (NA) or
first years of time series, then provide numerical representing number of years</p>
</td></tr>
<tr><td><code id="prod_mod_ts_+3A_effort_unit">effort_unit</code></td>
<td>
<p>multiplication factor for the unit of effort. Default is 1.</p>
</td></tr>
<tr><td><code id="prod_mod_ts_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE (default) a graph is displayed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either catch per unit of effort (CPUE) is inserted
into the model directly (by a column <code>CPUE</code>) or CPUE is calculated from
the catch and effort, then these two vectors should have required units.
Whenever a good estimate for the virigin biomass is available, this estimate
should be inserted for <code>B_init</code>. The default approach for the initial
estimate of the virgin biomass is to multiply the average yield by 2 (Dharmendra
and Solmundsson, 2005). Alternatively, just a part of the time series of
yield values can be choosen to represent the virgin biomass.
The minimisation procedure is based on least error sum of squares (SSE). For
the logistic (Schaefer) method the standard calculation of SSE is applied
(<code>sum((CPUE - predicted CPUE)^2)</code>), for
the method with Gompertz distribution (Fox) SSE is calculated according to
the Thiel's U statistic <code>sqrt(sum(CPUE - predicted CPUE)/sum(CPUE(t) - CPUE(t-1)))</code>
(Wittink, 1988).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>Bvec</strong>: biomass vector,
</p>
</li>
<li> <p><strong>CPUE_hat</strong>: predicted CPUE,
</p>
</li>
<li> <p><strong>K</strong>: carrying capacity,
</p>
</li>
<li> <p><strong>r</strong>: population growth rate,
</p>
</li>
<li> <p><strong>q</strong>: catchability coefficient,
</p>
</li>
<li> <p><strong>MSY</strong>: maximum sustainabale yield (MSY),
</p>
</li>
<li> <p><strong>Bmsy</strong>: biomass at MSY,
</p>
</li>
<li> <p><strong>Emsy</strong>: fishing effort at MSY
</p>
</li>
<li> <p><strong>Fmsy</strong>: fishing mortality at MSY,
</p>
</li></ul>



<h3>References</h3>

<p>Dharmendra, D., Solmundsson, J., 2005. Stock assessment of the offshore Mauritian banks
using dynamic biomass models and analysis of length frequency of the Sky Emperor
(<em>Lethrinus mahsena</em>). Fisheries Training Program The United Nations University, 61
</p>
<p>Hilborn, R. and Walters, C., 1992. Quantitative Fisheries Stock Assessment: Choice,
Dynamics and Uncertainty. Chapman and Hall, New York
</p>
<p>Prager, M. H., 1994. A suite of extensions to a non-equilibrium surplus production
model. <em>Fishery Bulletin</em> 92: 374-389
</p>
<p>Richards, F. J., 1959. A flexible growth function for empirical use.
<em>Journal of experimental Botany</em>, 10(2), 290-301.
</p>
<p>Wittink, D. R., 1988. The application of regression analysis. Allyn and Bacon. Inc.
Boston. MA. 324p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(emperor)
prod_mod_ts(emperor, method = "Schaefer")
prod_mod_ts(emperor, method = "Fox")

</code></pre>

<hr>
<h2 id='rcurves_Millar'>Predict gillnet selectivity (old Millar method)</h2><span id='topic+rcurves_Millar'></span>

<h3>Description</h3>

<p>Predict gillnet selectivity (old Millar method)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcurves_Millar(type, meshsizes, rel, pars, plotlens)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcurves_Millar_+3A_type">type</code></td>
<td>
<p>(&quot;norm.loc&quot;, &quot;norm.sca&quot;, &quot;gamma&quot;, &quot;lognorm&quot;)</p>
</td></tr>
<tr><td><code id="rcurves_Millar_+3A_meshsizes">meshsizes</code></td>
<td>
<p>mesh sizes</p>
</td></tr>
<tr><td><code id="rcurves_Millar_+3A_rel">rel</code></td>
<td>
<p>relative powers (one for each mesh size)</p>
</td></tr>
<tr><td><code id="rcurves_Millar_+3A_pars">pars</code></td>
<td>
<p>selection curve parameters</p>
</td></tr>
<tr><td><code id="rcurves_Millar_+3A_plotlens">plotlens</code></td>
<td>
<p>vector of new mesh sizes for selectivity prediction</p>
</td></tr>
</table>


<h3>Value</h3>

<p>selectivities
</p>


<h3>Source</h3>

<p>https://www.stat.auckland.ac.nz/~millar/selectware/
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>

<hr>
<h2 id='recruitment'>Recruitment patterns</h2><span id='topic+recruitment'></span>

<h3>Description</h3>

<p>This function estimates recrutiment patterns from length-frequency data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recruitment(param, tsample, catch_column = NA, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recruitment_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>midLengths</code>: midpoints of the length classes (length-frequency
data),
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, when growth curve crosses length equalling zero,
</p>
</li>
<li> <p><code>D</code>: optional; for generalised vBGF
</p>
</li>
<li> <p><code>C</code>: optional; intensity of the (sinusoid) growth oscillations of
the model,
</p>
</li>
<li> <p><code>ts</code>: optional; onset of the positive phase of the growth oscillation (fraction of year; i.e. Jan 1 = 0, July 1 = 0.5, etc.),
</p>
</li>
<li> <p><code>catch</code>: catches, vector or matrix with catches of subsequent sampling
times
</p>
</li></ul>
</td></tr>
<tr><td><code id="recruitment_+3A_tsample">tsample</code></td>
<td>
<p>sampling time corresponding to time when catch was sampled as
fraction of year
(e.g. 0.25 for 1st of April). If catch was sampled several times (catch as matrix)
vector has to be provided with sampling times in equal order.</p>
</td></tr>
<tr><td><code id="recruitment_+3A_catch_column">catch_column</code></td>
<td>
<p>numeric; if catch in param is a matrix, this number indicates
the column of the catch matrix which should be used for the analysis.</p>
</td></tr>
<tr><td><code id="recruitment_+3A_plot">plot</code></td>
<td>
<p>logical; indicating whether a plot should be printed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates recruitment patterns of a
stock by backward projection onto the length axis of a set of length frequency data
using the (special, generalised or seasonalised)
von Bertallanfy growth curve (vBGF, Pauly 1982). The method assumes that (i) all fish in a
data set grow as described by a single set of growth parameters and (ii) one month out
of twelve always has zero recruitment. The second assumption is probably not met, since
temperate species may contain more than one month with zero recruitment, while tropical species
may have more constant recruitment without months of no recruitment.
If t0 is not provided, a relative recruitment pattern will be estimated without
specific month values returned in the results. However, an estimate of t0
can be obtained by the time
lag between peak spawning and recruitment. Several length-frequency data sets
can be used to estimate the recrutiment pattern by providing catch as a matrix and
setting catch_column to NA (default). Then the fraction per time is calculated for
each size class in each sample and then pooled together. For the generalised vBGF, D is
required, for the seasonalised vBGF C, ts and D.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>ti</strong>: actual age,
</p>
</li>
<li> <p><strong>tS_frac</strong>: age at which the length was zero expressed as fraction
of the year,
</p>
</li>
<li> <p><strong>cor_months</strong>: corresponding months,
</p>
</li>
<li> <p><strong>months</strong>: numeric months (relative if no t0 is not given),
</p>
</li>
<li> <p><strong>months_abb</strong>: months (only presented if t0 is given),
</p>
</li>
<li> <p><strong>all_recruits</strong>: number of recruits per month as matrix if several
length-frequency data sets are provided,
</p>
</li>
<li> <p><strong>mean_recruits</strong>: (mean) number of recruits per month,
</p>
</li>
<li> <p><strong>per_recruits</strong>: precentage number of recruits per month.
</p>
</li></ul>



<h3>References</h3>

<p>Brey, T., Soriano, M., Pauly, D., 1988. Electronic length frequency analysis. A
revised and expanded user's guide to ELEFAN 0, 1 and 2. (Second edition).
Berichte aus dem Institut f??r Meereskunde Kiel, No 177, 31p.
</p>
<p>Moreau, J., &amp; Cuende, F. X., 1991. On improving the resolution of the recruitment
patterns of fishes. <em>Fishbyte</em>, 9(1), 45-46.
</p>
<p>Pauly, D., 1982. Studying single-species dynamics in a tropical multispecies context.
In Theory and management of tropical fisheries. <em>ICLARM Conference Proceedings</em>
(Vol. 9, No. 360, pp. 33-70).
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># one sample
dat &lt;- list(midLengths = seq(2,98,4),
               catch = c(0.6,17.6,93,83.2,12.6,0.3,0,0,0,1,17.1,51.4,
               26.1,2.2,0.2,4.5,21.6,17.6,3.7,8.7,10.6,6.3,5.6,2.9,0.8),
               Linf = 100,
               K = 0.5,
               t0 = 0)
recruitment(param = dat, tsample = 0.25)


# several samples
data(synLFQ4)

# add growth parameters
synLFQ4$Linf &lt;- 80
synLFQ4$K &lt;- 0.5
synLFQ4$t0 &lt;- 0.25

# retrieve sampling times from catch matrix
s_dates &lt;- as.POSIXlt(synLFQ4$dates, format="%d.%m.%Y")

recruitment(param = synLFQ4, tsample = s_dates$yday/365, plot = TRUE)


plot(synLFQ4, Fname = "catch",
   par = list(Linf = 80, K = 0.5, t_anchor = 0.25, C = 0.75, ts = 0),
   ylim = c(0,80))

</code></pre>

<hr>
<h2 id='rtypes_Millar'>Millar's selectivity types</h2><span id='topic+rtypes_Millar'></span>

<h3>Description</h3>

<p>This function returns a function corresponding to the type of curve
which was selected to represent the selectivity of nets or hooks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtypes_Millar(rtype)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtypes_Millar_+3A_rtype">rtype</code></td>
<td>
<p>a character string indicating which method for the estimation of selection
curves should be used:
<code>"norm.loc"</code> for normal with common spread method,
<code>"norm.sca"</code> for normal with variable spread method,
<code>"lognorm"</code> for lognormal method,
<code>"binorm.sca"</code> for bi-normal method,
<code>"bilognorm"</code> for bi-lognormal method,
<code>"tt.logistic"</code> for control and logistic method,
<code>"gamma"</code> for gamma method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function adapted from the selectivity functions provided by
Prof. Dr. Russell Millar (https://www.stat.auckland.ac.nz/~millar/).
Until now following curves are incorporated:
<code>"norm.loc"</code> for a normal curve with common spread,
<code>"norm.sca"</code> for a normal curve with variable spread,
<code>"lognorm"</code> for a lognormal curve,
<code>"binorm.sca"</code> for a bi-normal curve,
<code>"bilognorm"</code> for a bi-lognormal curve,
<code>"tt.logistic"</code> for a control and logistic curve.
</p>


<h3>Source</h3>

<p>https://www.stat.auckland.ac.nz/~millar/selectware/
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3), 471-477.
</p>

<hr>
<h2 id='select'>Selectivity model</h2><span id='topic+select'></span>

<h3>Description</h3>

<p>This function estimates the selecitvity of gillnets and
trawl nets from experimental catches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select(param, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_+3A_param">param</code></td>
<td>
<p>a list with following parameters:
</p>

<ul>
<li> <p><code>type</code> a string indicating which type of gear was used (options:
&quot;gillnet&quot; or &quot;trawl_net&quot;),
</p>
</li>
<li> <p><code>midLengths</code> midlengths of size classes
</p>
</li>
<li> <p><code>meshSizes</code> a vector with mesh sizes in increasing order,
</p>
</li>
<li> <p><code>CatchPerNet_mat</code> a matrix with the catches per net in corresponding
order of mesh sizes
</p>
</li></ul>
</td></tr>
<tr><td><code id="select_+3A_plot">plot</code></td>
<td>
<p>logical; should the results be displayed graphically?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the fractions retained by each net, the
optimum lengths for each net, the selection factor (SF), and the standard deviation
of the factor (stand.dev). Calculations are based on a normal distribution with common spread.
Assumptions of this method are, that (i) the optimum length Lm is proportional to the mesh
size (Lm = SF * m), (ii) the selection curves are normally distributed with a common
standard deviation, (iii) the nets have the same fishing power (same dimensions and material).
Requirements for the experimental set-up are: selection curves corresponding to the two
mesh sizes have to overlap, and the nets have to be set in the same area, during the
same time.
To calculate selection factor (SF), L25, L50 and L75 for trawl nets /fisheries.
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects for type = &quot;gillnet&quot;:
#' </p>

<ul>
<li> <p><strong>classes.num</strong>: numeric vector with length classes without a plus group,
</p>
</li>
<li> <p><strong>SNet1</strong>: selection ogive net 1,
</p>
</li>
<li> <p><strong>SNet2</strong>: selection ogive net 2,
</p>
</li>
<li> <p><strong>lnNet2_Net1</strong>: logarithm ratio between nets,
</p>
</li>
<li> <p><strong>linear_mod</strong>: linear model,
</p>
</li>
<li> <p><strong>LmNet1</strong>: optimum length net 1,
</p>
</li>
<li> <p><strong>LmNet2</strong>: optimum length net 2,
</p>
</li>
<li> <p><strong>SF</strong>: selection factor,
</p>
</li>
<li> <p><strong>stand.dev</strong>: standard deviation of selection factor.
</p>
</li></ul>

<p>and following objects for type = &quot;trawl_net&quot;:
</p>

<ul>
<li> <p><strong>classes.num</strong>: numeric vector with length classes,
</p>
</li>
<li> <p><strong>SLobs</strong>: observed selection ogive,
</p>
</li>
<li> <p><strong>SLest</strong>: estimated selection ogive,
</p>
</li>
<li> <p><strong>lnSL</strong>: logarithm of observed selection,
</p>
</li>
<li> <p><strong>linear_mod</strong>: linear model,
</p>
</li>
<li> <p><strong>S1</strong>: constant of selection curve,
</p>
</li>
<li> <p><strong>S2</strong>: another constant of selection curve,
</p>
</li>
<li> <p><strong>L25</strong>: length at which 25
</p>
</li>
<li> <p><strong>L50</strong>: length at which 50
</p>
</li>
<li> <p><strong>L75</strong>: length at which 75
</p>
</li>
<li> <p><strong>SF</strong>: selection factor.
</p>
</li></ul>



<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Gillnet selectivity
data(tilapia)
out &lt;- select(param = tilapia)
plot(out)

# Trawl selectivity
data(bream)
select(bream)

</code></pre>

<hr>
<h2 id='select_Millar'>Millar's selectivity model</h2><span id='topic+select_Millar'></span>

<h3>Description</h3>

<p>This model estimates the selecitvity of different gears from experimental
catches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_Millar(
  param,
  x0 = NULL,
  rtype = "norm.loc",
  rel.power = NULL,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_Millar_+3A_param">param</code></td>
<td>
<p>A list with following parameters: vector with midlengths of size classes
(<code>midLengths</code>), vector with meshSizes in increasing order (<code>meshSizes</code>),
and a matrix with the number of individuals caught with each sized mesh
(<code>CatchPerNet_mat</code>).</p>
</td></tr>
<tr><td><code id="select_Millar_+3A_x0">x0</code></td>
<td>
<p>A string of initial values for the parameters to be optimized over when applying the
function <code><a href="stats.html#topic+optim">optim</a></code>. When rtype = &quot;norm.loc&quot;, &quot;norm.sca&quot;, or &quot;lognorm&quot;, initial values
may be ommitted (<code>x0 = NULL</code>), and starting vallues will be estimated using the earlier approach of
Millar and Holst (1997).</p>
</td></tr>
<tr><td><code id="select_Millar_+3A_rtype">rtype</code></td>
<td>
<p>A character string indicating which method for estimating selection curves
should be used:
<code>"norm.loc"</code> for a normal curve with common spread,
<code>"norm.sca"</code> for a normal curve with variable spread,
<code>"lognorm"</code> for a lognormal curve,
<code>"binorm.sca"</code> for a bi-normal curve,
<code>"bilognorm"</code> for a bi-lognormal curve,
<code>"tt.logistic"</code> for a control and logistic curve</p>
</td></tr>
<tr><td><code id="select_Millar_+3A_rel.power">rel.power</code></td>
<td>
<p>A string indicating the relative power of different meshSizes,
must have same length as <code>meshSizes</code> (Default: <code>rel.power = NULL</code>).</p>
</td></tr>
<tr><td><code id="select_Millar_+3A_plot">plot</code></td>
<td>
<p>logical; should a plot be printed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model adapted from the selectivity functions provided by Prof. Dr. Russell Millar
(https://www.stat.auckland.ac.nz/~millar/). In the deviance plot open circles correspond to negative,
closed to positive residuals. The size of the circles is proportional to the square of the residuals.
To assess the model fit by the deviance plot it requires some experience, in general the pattern should
be random and the sizes not too big. Please refer to Millar's publications and other publications for
comparison. The model can produce errors if the starting values (<code>x0</code>) for the <a href="stats.html#topic+optim">optim</a>
function are not realistic. Please be aware that if the method is changed the outcoming parameters
can greatly vary. Simliarly the starting values have to be adapted when changing the method (<code>rtype</code>).
</p>


<h3>Source</h3>

<p>https://www.stat.auckland.ac.nz/~millar/selectware/
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Holt, S. J. 1963. A method for determining gear selectivity and its application.
<em>ICNAF Special Publication</em>, 5: 106-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(haddock)

output &lt;- select_Millar(haddock, x0 = c(-10,0.3,0),
   rtype = "tt.logistic")

plot(output, plotlens=seq(25,35,0.1), deviance_plot = FALSE)
legend("topleft",c("Control","Experimental"), lty=1:2, col=1:2)


# Gillnet
data(gillnet)

# Using inital estimates from old method
select_Millar(gillnet, x0 = NULL, rtype = "norm.loc")$value
select_Millar(gillnet, x0 = NULL, rtype = "norm.sca")$value
select_Millar(gillnet, x0 = NULL, rtype = "lognorm")$value

# Two rtypes which require starting values
select_Millar(gillnet, x0 = c(55,4,65,4,3), rtype="binorm.sca")
select_Millar(gillnet, x0 = c(4,0.2,4.2,0.1,2), rtype="bilognorm")

# Calculation with finer length resolution
output &lt;- select_Millar(gillnet, x0 = NULL, rtype = "lognorm")
plot(output, plotlens=seq(40,90,0.1))

# Use alternate plot settings
output &lt;- select_Millar(gillnet, x0 = NULL, rtype = "lognorm")
ncolor &lt;- length(output$meshSizes)
plot(output, plotlens=seq(40,90,0.1), deviance_plot = FALSE,
 lty=1, col=rainbow(ncolor))
legend("topleft", col=rainbow(ncolor), legend=output$meshSizes,
 lty=1, title="Mesh size [cm]")

 # deviance plot only
 plot(output, plotlens=seq(40,90,0.1), selectivity_plot = FALSE)


# Stacked trammel net
# The data come from two experiments using different mesh sizes
# This analysis assumes common retention curve in both experiments.
# Note that summary function does not produce residual plot
# since lengths are not unique
data(trammelnet)

output &lt;- select_Millar(trammelnet, x0 = c(25,4),
   rtype="norm.loc", rel.power = rep(1,6))

plot(output,plotlens=seq(10,40,0.1))

</code></pre>

<hr>
<h2 id='select_ogive'>Selectivity patterns</h2><span id='topic+select_ogive'></span>

<h3>Description</h3>

<p>Based on a few parameters, this function estimates the fraction per
length group retained in the net. Different selection curves can be used for the
estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_ogive(s_list, Lt, Lc = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_ogive_+3A_s_list">s_list</code></td>
<td>
<p>a list with selectivity parameters dependent on the type of
selection curve:
</p>

<ul>
<li> <p><code>selecType</code> type of
selection curve used for estimation (options:
&quot;knife_edge&quot;,
&quot;trawl_ogive&quot;,
&quot;lognormal&quot;,
&quot;normal_fixed&quot;),
</p>
</li>
<li> <p><code>Lc</code> length-at-first-capture (also called L50),
</p>
</li>
<li> <p><code>meshSizes</code> a vector with mesh sizes in increasing order,
</p>
</li>
<li> <p><code>select_p1</code> selectivity parameter 1 (see Millar and Holst (1997)),
</p>
</li>
<li> <p><code>select_p2</code> selectivity parameter 2 (see Millar and Holst (1997)),
</p>
</li>
<li> <p><code>L75</code> length at which individuals are caught with a
probability of 75
</p>
</li></ul>
</td></tr>
<tr><td><code id="select_ogive_+3A_lt">Lt</code></td>
<td>
<p>a vector with lengths corresponding to age classes</p>
</td></tr>
<tr><td><code id="select_ogive_+3A_lc">Lc</code></td>
<td>
<p>length-at-first-capture (Default: NA)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is embedded within <code><a href="#topic+predict_mod">predict_mod</a></code>. <code>selecType</code>
&quot;knife_edge&quot; only requires a Lc value. &quot;trawl_ogive&quot; requires a Lc (L50) and
a L75 value. &quot;lognormal&quot; requires two mesh sizes, an estimate of mu and of sigma.
&quot;normal_fixed&quot; requires two mesh sizes with an estimate of the selection factor (SF) and an
estimate of sigma.
</p>


<h3>References</h3>

<p>Millar, R. B., Holst, R. (1997). Estimation of gillnet and hook selectivity using log-linear
models. ICES Journal of Marine Science: Journal du Conseil, 54(3), 471-477.
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create list with selectivity information
select.list &lt;- list(selecType = 'knife_edge',
   Lc = 34, L75 = 37, tc = 5, meshSizes = c(60,80),
   select_p1 = 2.7977, select_p2 = 0.1175)


# create vector with mid lengths
Lt &lt;- seq(5, 50, 0.01)

# knife edge selectivity
sel_ke &lt;- select_ogive(select.list, Lt)

# trawl ogive selectivity
select.list$selecType = "trawl_ogive"
sel_to &lt;- select_ogive(select.list, Lt)

plot(Lt, sel_ke, type = 'l')
lines(Lt, sel_to, col = 'blue')


# Gillnet selectivity ("lognormal" and "normal_fixed")
select.list$selecType &lt;- "lognormal"
sel_log &lt;- select_ogive(select.list, Lt)

select.list$selecType &lt;- "normal_fixed"
select.list$select_p1 &lt;- 0.2
select.list$select_p2 &lt;- 1.5
sel_nf &lt;- select_ogive(select.list, Lt)

plot(Lt, sel_log, type = 'l')
lines(Lt, sel_nf, col = 'blue')

</code></pre>

<hr>
<h2 id='shrimps'>Shrimp data</h2><span id='topic+shrimps'></span>

<h3>Description</h3>

<p>Data from the Kuwait shrimp (<em>Penaeus semisulcatus</em>) fishery.
They can be used to simulate different management scenarios by applying
prediction models (<code><a href="#topic+predict_mod">predict_mod</a></code>).
Fishing mortalities were estimated from catch data and biomass estimates were
obtained from the swept area method. Recuritment to fishery at the age of one month (Tr = 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shrimps)
</code></pre>


<h3>Format</h3>

<p>A list consisting of: 1. age groups [months], 2. meanWeight, 3. meanValue,
4.FM, and 5.M
</p>


<h3>Source</h3>

<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shrimps)
str(shrimps)
summary(shrimps)


</code></pre>

<hr>
<h2 id='startingPoint2tanchor'>Convert FiSAT's starting point to t_anchor value</h2><span id='topic+startingPoint2tanchor'></span>

<h3>Description</h3>

<p>Starting points returned or chosen within FiSAT are not supported
in TropFishR. Instead <code>t_anchor</code> takes on the job of anchoring VBGF growth curves on
a temporal axis. This function allows to convert FiSAT's starting points to <code>t_anchor</code> values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startingPoint2tanchor(param, par, startingLength, startingSample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startingPoint2tanchor_+3A_param">param</code></td>
<td>
<p>list with dates, midLengths, and catch</p>
</td></tr>
<tr><td><code id="startingPoint2tanchor_+3A_par">par</code></td>
<td>
<p>list with growth parameters 'Linf' and 'K' of VBGF</p>
</td></tr>
<tr><td><code id="startingPoint2tanchor_+3A_startinglength">startingLength</code></td>
<td>
<p>starting length as returned by FiSAT, indicating the length within
the starting sample cut by a growth curve</p>
</td></tr>
<tr><td><code id="startingPoint2tanchor_+3A_startingsample">startingSample</code></td>
<td>
<p>starting sample as returned by FiSAT, indicating the sample which is
cut by a growth curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with input elements and estimated t_anchor value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ5)
lfqNEW &lt;- startingPoint2tanchor(synLFQ5, par = list(Linf = 92, K = 0.37),
   startingLength = 31, startingSample = 4)
lfqRest &lt;- lfqRestructure(lfqNEW, MA = 11)
plot(lfqRest,par=list(Linf=lfqRest$Linf,K=lfqRest$K,t_anchor=lfqRest$t_anchor))

</code></pre>

<hr>
<h2 id='stock_sim'>Stock simulation</h2><span id='topic+stock_sim'></span>

<h3>Description</h3>

<p>This function estimates stock size, biomass and yield of a stock from
fishing mortality per age class or length group. This function is embedded in the
Thompson and Bell model (prediction model: <code><a href="#topic+predict_mod">predict_mod</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stock_sim(param, age_unit = "year", stock_size_1 = NA, plus_group = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stock_sim_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>age</code> or <code>midLengths</code>: midpoints of length classes (length-frequency
data) or ages (age composition data),
</p>
</li>
<li> <p><code>meanWeight</code>: mean weight in kg per age class or length group,
</p>
</li>
<li> <p><code>meanValue</code>: mean value per kg fish per age class or length group,
</p>
</li>
<li> <p><code>FM</code>: fishing mortality rates per age class or length group,
</p>
</li>
<li> <p><code>M</code> or <code>Z</code>: natural or total instantaneous mortality rate.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stock_sim_+3A_age_unit">age_unit</code></td>
<td>
<p>indicates if the age groups are per month (<code>"month"</code>) or
per year (<code>"year"</code>). Default: <code>"year"</code></p>
</td></tr>
<tr><td><code id="stock_sim_+3A_stock_size_1">stock_size_1</code></td>
<td>
<p>stock size of smallest age/length group</p>
</td></tr>
<tr><td><code id="stock_sim_+3A_plus_group">plus_group</code></td>
<td>
<p>indicates age/length group, which should be turned into a plus
group (i.e. all groups above are comprised in one group)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>better to treat last group always as a plus group...
if stock size 1 not provided assumes 1000 as intital population size
make sure that FM is also in same unit as the classes, e.g. when classes in
months than also FM has to be provided in 1/months
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>dt</strong>: delta t,
</p>
</li>
<li> <p><strong>N</strong>: population numbers,
</p>
</li>
<li> <p><strong>dead</strong>: number of deaths due to natural mortality,
</p>
</li>
<li> <p><strong>C</strong>: catch,
</p>
</li>
<li> <p><strong>Y</strong>: yield,
</p>
</li>
<li> <p><strong>B</strong>: biomass,
</p>
</li>
<li> <p><strong>V</strong>: value,
</p>
</li>
<li> <p><strong>totals</strong>: summarised output:
</p>

<ul>
<li> <p><strong>totC</strong> total catch,
</p>
</li>
<li> <p><strong>totY</strong> total yield,
</p>
</li>
<li> <p><strong>totV</strong> total value,
</p>
</li>
<li> <p><strong>meanB</strong> mean biomass.
</p>
</li></ul>
<p>,
</p>
</li></ul>



<h3>References</h3>

<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>
<p>Millar, R. B., &amp; Holst, R. (1997). Estimation of gillnet and hook selectivity using
log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># age-based stock simulation
data(shrimps)

# option 1: without plus group
stock_sim(shrimps, age_unit = "month")

# option 2: with plus group
stock_sim(param = shrimps, age_unit = "month", plus_group = 11)

# length-based stock simulation
data(hake)

stock_sim(param = hake, stock_size_1 = 98919.3)

</code></pre>

<hr>
<h2 id='synCAA1'>Synthetic Catch-at-age data I</h2><span id='topic+synCAA1'></span>

<h3>Description</h3>

<p>Synthetic Catch-at-age data from Sparre &amp; Venema (1998). Can be used
for the estimation of the instantaneous total mortality rate (Z) by means
of <code><a href="#topic+Z_BevertonHolt">Z_BevertonHolt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synCAA1)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>midAge</code>: a vector of the mid ages of the age groups,
</p>
</li>
<li> <p><code>catch</code>: a matrix with the catches for different years.
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synCAA1)
str(synCAA1)
summary(synCAA1)


</code></pre>

<hr>
<h2 id='synCAA2'>Synthetic Catch-at-age data II</h2><span id='topic+synCAA2'></span>

<h3>Description</h3>

<p>Synthetic Catch-at-age data from Sparre &amp; Venema (1998).
Can be used for the estimation of the instantaneous mortality rate (Z) by
means of the cumulative catch curve (<code><a href="#topic+catchCurve">catchCurve</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synCAA2)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>midAge</code> a vector of the mid ages of the age groups,
</p>
</li>
<li> <p><code>catch</code> a matrix with the catches for different years.
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synCAA2)
str(synCAA2)
summary(synCAA2)


</code></pre>

<hr>
<h2 id='synCPUE'>Synthetical catch per unit of effort (CPUE) dataset</h2><span id='topic+synCPUE'></span>

<h3>Description</h3>

<p>Synthetical CPUE dataset from Exercise 4.3 in Sparre &amp; Venema (1999).
Can be used to estimate the instantaneous total mortality rate (Z) by means of
the function <code><a href="#topic+Z_CPUE">Z_CPUE</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synCPUE)
</code></pre>


<h3>Format</h3>

<p>A dataframe consisting of following columns:
</p>

<ul>
<li> <p><code>cohort</code>: name of cohort, e.g. 1982 S, meaning summer cohort of 1982,
</p>
</li>
<li> <p><code>age</code>: age of cohorts,
</p>
</li>
<li> <p><code>CPUE</code>: catch per unit of effort of cohorts.
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1999. Introduction to tropical fish stock
assessment. Part 2. Excercises. <em>FAO Fisheries Technical Paper</em>, (306.2, Rev. 2).
94 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synCPUE)
head(synCPUE)
str(synCPUE)


</code></pre>

<hr>
<h2 id='synLFQ1'>Synthetic length-frequency data I</h2><span id='topic+synLFQ1'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as provided in Sparre &amp; Venema (1998).
Can be used to apply the function <code><a href="#topic+Bhattacharya">Bhattacharya</a></code> or
<code><a href="#topic+ELEFAN">ELEFAN</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ1)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ1)
str(synLFQ1)
summary(synLFQ1)


</code></pre>

<hr>
<h2 id='synLFQ2'>Synthetic length frequency data II</h2><span id='topic+synLFQ2'></span>

<h3>Description</h3>

<p>Synthetic length frequency data from Sparre &amp; Venema (1998). Can be used
for the estimation of the instantaneous total mortality rate (Z) by means
of <code><a href="#topic+Z_BevertonHolt">Z_BevertonHolt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ2)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><code>midLengths</code>: midpoints of the length classes,
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>catch</code>: matrix with catches/counts per length class (row) and sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. FAO Fisheries Technical Paper, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ2)
str(synLFQ2)
summary(synLFQ2)


</code></pre>

<hr>
<h2 id='synLFQ3'>Synthetic length frequency data III</h2><span id='topic+synLFQ3'></span>

<h3>Description</h3>

<p>Synthetic length frequency data from Sparre &amp; Venema (1998). Can be
used for the estimation of the instantaneous total mortality rate (Z) by means
of <code><a href="#topic+Z_BevertonHolt">Z_BevertonHolt</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ3)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>midLengths</code>: midpoints of the length classes,
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch,
</p>
</li>
<li> <p><code>catch</code>: a vector with catches.
</p>
</li></ul>



<h3>Source</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock
assessment. Part 1. Manual. <em>FAO Fisheries Technical Paper</em>,
(306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ3)
str(synLFQ3)
summary(synLFQ3)


</code></pre>

<hr>
<h2 id='synLFQ4'>Synthetic length-frequency data IV (with seasonal oscillation)</h2><span id='topic+synLFQ4'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as generated by the function
<code>lfqGen</code> from the <em>fishdynr</em> package (Taylor 2016). Can be used by
<code><a href="#topic+ELEFAN">ELEFAN</a></code> or <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>.
The data is generated with the following von Bertalanffy growth parameters:
</p>

<ul>
<li><p> K = 0.5
</p>
</li>
<li><p> Linf = 80
</p>
</li>
<li><p> C = 0.75
</p>
</li>
<li><p> ts = 0.5
</p>
</li>
<li><p> t_anchor = 0.25 (Time when yearly recruitment pulse occurs;
e.g. 0 = Jan 1, 0.25 = Apr 1, 0.5 = Jul 1st, 0.75 = Oct 1)
</p>
</li></ul>

<p>Further settings include:
</p>

<ul>
<li><p> Linf.cv = 0.05
</p>
</li>
<li><p> K.cv = 0.05
</p>
</li>
<li><p> L50 = 20 (length at 50% prob. of capture via trawl net)
</p>
</li>
<li><p> wqs = 0 (width between 25% and 75% prob. of capture quantiles;
i.e. wqs = 0 is knife-edge selection)
</p>
</li>
<li><p> M = 0.5 (Natural mortality rate)
</p>
</li>
<li><p> harvest_rate = 0.5 (Fishing mortality rate)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ4)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Taylor, M (2016). fishdynr: Fisheries science related population dynamics
models. R package version 0.2. https://github.com/marchtaylor/fishdynr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ4)

# plot of length frequencies
plot(synLFQ4, Fname = "catch")

# plot of restructured length frequencies
synLFQ4 &lt;- lfqRestructure(synLFQ4, MA = 15)
plot(synLFQ4, Fname = "rcounts")



</code></pre>

<hr>
<h2 id='synLFQ5'>Synthetic length-frequency data V (without seasonal oscillation)</h2><span id='topic+synLFQ5'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as generated by the function
<code>lfqGen</code> from the <em>fishdynr</em> package (Taylor 2016). Can be used by
<code><a href="#topic+ELEFAN">ELEFAN</a></code> or <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>.
The data is generated with the following von Bertalanffy growth parameters:
</p>

<ul>
<li><p> K = 0.5
</p>
</li>
<li><p> Linf = 80
</p>
</li>
<li><p> C = 0
</p>
</li>
<li><p> ts = 0
</p>
</li>
<li><p> t_anchor = 0.25 (Time when yearly recruitment pulse occurs;
e.g. 0 = Jan 1, 0.25 = Apr 1, 0.5 = Jul 1st, 0.75 = Oct 1)
</p>
</li></ul>

<p>Further settings include:
</p>

<ul>
<li><p> Linf.cv = 0.05
</p>
</li>
<li><p> K.cv = 0.05
</p>
</li>
<li><p> L50 = 20 (length at 50% prob. of capture via trawl net)
</p>
</li>
<li><p> wqs = 0 (width between 25% and 75% prob. of capture quantiles;
i.e. wqs = 0 is knife-edge selection)
</p>
</li>
<li><p> M = 0.5 (Natural mortality rate)
</p>
</li>
<li><p> harvest_rate = 0.5 (Fishing mortality rate)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ5)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Taylor, M (2016). fishdynr: Fisheries science related population dynamics
models. R package version 0.2. https://github.com/marchtaylor/fishdynr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ5)

# plot of length frequencies
plot(synLFQ5, Fname = "catch")

# plot of restructured length frequencies
synLFQ5 &lt;- lfqRestructure(synLFQ5, MA = 15)
plot(synLFQ5, Fname = "rcounts")



</code></pre>

<hr>
<h2 id='synLFQ6'>Synthetic length-frequency data VI (without seasonal oscillation)</h2><span id='topic+synLFQ6'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as generated by the function
<code>lfqGen</code> from the <em>fishdynr</em> package (Taylor 2016). Can be used by
<code><a href="#topic+ELEFAN">ELEFAN</a></code> or <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>.
The data is generated with the following von Bertalanffy growth parameters:
</p>

<ul>
<li><p> K = 0.47 +/- 0.2 (CV)
</p>
</li>
<li><p> Linf = 33.7 +/- 0.05 (CV)
</p>
</li>
<li><p> C = 0
</p>
</li>
<li><p> ts = 0
</p>
</li>
<li><p> t_anchor = 0.25 (Time when yearly recruitment pulse occurs;
e.g. 0 = Jan 1, 0.25 = Apr 1, 0.5 = Jul 1st, 0.75 = Oct 1)
</p>
</li></ul>

<p>Further settings include:
</p>

<ul>
<li><p> L50 = 10 (length at 50% prob. of capture via trawl net)
</p>
</li>
<li><p> wqs = 3 (width between 25% and 75% prob. of capture quantiles;
i.e. wqs = 0 is knife-edge selection)
</p>
</li>
<li><p> M = 0.8 (Natural mortality rate)
</p>
</li>
<li><p> harvest_rate = 1.3 (Fishing mortality rate)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ6)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and
sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Taylor, M (2016). fishdynr: Fisheries science related population dynamics
models. R package version 0.2. https://github.com/marchtaylor/fishdynr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ6)

# plot of length frequencies
plot(synLFQ6, Fname = "catch")

# plot of restructured length frequencies
synLFQ6 &lt;- lfqRestructure(synLFQ6, MA = 7)
plot(synLFQ6, Fname = "rcounts")



</code></pre>

<hr>
<h2 id='synLFQ7'>Synthetic length-frequency data VII with seasonal oscillation</h2><span id='topic+synLFQ7'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as generated by the function
<code>lfqGen</code> from the <em>fishdynr</em> package (Taylor 2016). Can be used by
<code><a href="#topic+ELEFAN">ELEFAN</a></code>, <code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>, or
<code><a href="#topic+ELEFAN_GA">ELEFAN_GA</a></code>.
The data is generated with the following von Bertalanffy growth parameters:
</p>

<ul>
<li><p> K = 0.2 +/- 0.1 (CV)
</p>
</li>
<li><p> Linf = 123 +/- 0.05 (CV)
</p>
</li>
<li><p> C = 0.3
</p>
</li>
<li><p> ts = 0
</p>
</li>
<li><p> t_anchor between 0.16 and 0.34 (Time when yearly recruitment pulse occurs;
e.g. 0 = Jan 1, 0.25 = Apr 1, 0.5 = Jul 1, 0.75 = Oct 1;
repro_wt = c(0, 0, 0.2, 1, 0.6, 0, 0, 0, 0, 0, 0, 0))
</p>
</li></ul>

<p>Further settings include:
</p>

<ul>
<li><p> Lmat = 30.8 (length at maturity)
</p>
</li>
<li><p> L50 = 35 (length at 50% prob. of capture via trawl net)
</p>
</li>
<li><p> wqs = 5 (width between 25% and 75% prob. of capture quantiles;
i.e. wqs = 0 is knife-edge selection)
</p>
</li>
<li><p> M = 0.2 (Natural mortality rate)
</p>
</li>
<li><p> harvest_rate = 0.3 (Fishing mortality rate)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ7)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and
sampling date (column).
</p>
</li></ul>



<h3>Source</h3>

<p>Taylor, M (2016). fishdynr: Fisheries science related population dynamics
models. R package version 0.2. https://github.com/marchtaylor/fishdynr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ7)

# plot of length frequencies
plot(synLFQ7, Fname = "catch")

# plot of restructured length frequencies
synLFQ7 &lt;- lfqRestructure(synLFQ7, MA = 11)
plot(synLFQ7, Fname = "rcounts")



</code></pre>

<hr>
<h2 id='synLFQ8'>Synthetic length-frequency data VIII with variable harvest rate</h2><span id='topic+synLFQ8'></span>

<h3>Description</h3>

<p>Synthetic length-frequency data as generated by the
function <code>virtualPop2</code> from the <em>fishdynr</em> package
(Taylor and Mildenberger, 2018). Can be used by
<code><a href="#topic+ELEFAN">ELEFAN</a></code>,
<code><a href="#topic+ELEFAN_SA">ELEFAN_SA</a></code>, or
<code><a href="#topic+ELEFAN_GA">ELEFAN_GA</a></code>.  The data is generated with
the following von Bertalanffy growth parameters: </p>

<ul>
<li><p> K = 0.5 +/- 0.05 (CV) </p>
</li>
<li><p> Linf = 80 +/- 0.05 (CV) </p>
</li>
<li>
<p>C = 0.0 </p>
</li>
<li><p> ts = 0.0 </p>
</li>
<li><p> t_anchor 0.25 (Time when
yearly recruitment pulse occurs; e.g. 0 = Jan 1, 0.25 = Apr 1,
0.5 = Jul 1, 0.75 = Oct 1; repro_wt = c(0, 0, 0, 1, 0, 0, 0, 0,
0, 0, 0, 0)) </p>
</li></ul>

<p>Further settings include:
</p>

<ul>
<li><p> Lmat.f = 40 (length at maturity)
</p>
</li>
<li><p> Lmat.m = 36 (length at maturity)
</p>
</li>
<li><p> L50 = 20 (length at 50% prob. of capture with trawl net (Lc))
</p>
</li>
<li><p> wqs = 4 (width between 25% and 75% prob. of capture quantiles;
i.e. wqs = 0 is knife-edge selection)
</p>
</li>
<li><p> M = 0.7 (Natural mortality rate)
</p>
</li>
<li><p> harvest_rate = 1, 0.8, 0.4, 0.1 for years 2014, 2015, 2016, 2017, repsectively (fishing mortality rate)
</p>
</li></ul>

<p>The average biomass relative to the unfished biomass and the yield per recurit
for the years, 2014, 2015, 2016, 2017 is
0.16, 0.21, 0.41, 0.75, and 0.4, 0.43, 0.24, 0.07, respectively. Biomass over
Bmsy as estimated with a surplus production model is 0.51, 0.67, 1.27, 2.18. Lopt is
53.33 cm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(synLFQ8)
</code></pre>


<h3>Format</h3>

<p>A list of class lfq consisting of:
</p>

<ul>
<li> <p><strong>stock</strong> Stock ID or name,
</p>
</li>
<li> <p><strong>dates</strong> dates of sampling times (class Date),
</p>
</li>
<li> <p><strong>midLengths</strong> midpoints of the length classes,
</p>
</li>
<li> <p><strong>catch</strong> matrix with catches/counts per length class (row) and
sampling date (column),
</p>
</li>
<li> <p><strong>comment</strong> additional comments to this data set.
</p>
</li></ul>



<h3>Source</h3>

<p>Taylor, M &amp; T. K. Mildenberger  (2018). fishdynr: Fisheries science related population dynamics
models. R package version 0.5. https://github.com/tokami/fishdynr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(synLFQ8)

# plot of length frequencies
plot(synLFQ8, Fname = "catch")

# plot of restructured length frequencies
synLFQ8 &lt;- lfqRestructure(synLFQ8, MA = 11)
plot(synLFQ8, Fname = "rcounts")



</code></pre>

<hr>
<h2 id='tilapia'>Tilapia data</h2><span id='topic+tilapia'></span>

<h3>Description</h3>

<p>A list with characteristics of experimental catches of tilapia
<em>Tilapia esculenta</em>
with gillnets of two mesh sizes. The Results of the experiment are the midlengths of
size classes, the number of fish caught with net 1 &amp; 2, and the meshsizes of both nets.
The data can be analysed with the function <code><a href="#topic+select">select</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tilapia)
</code></pre>


<h3>Format</h3>

<p>A list consiting of:
</p>

<ul>
<li> <p><code>midLengths</code>  the midlengths of size classes,
</p>
</li>
<li> <p><code>numNet1</code>  the number of fish caught with net 1,
</p>
</li>
<li> <p><code>numNet2</code>  the number of fish caught with net 2,
</p>
</li>
<li> <p><code>msNet1</code>  the meshsize of net 1,
</p>
</li>
<li> <p><code>msNet2</code>  and the meshsize of net 2.
</p>
</li></ul>



<h3>Source</h3>

<p>Garrod, D.J., 1961. The selection characteristics of nylon gill nets for
<em>Tilapia esculenta</em> Graham. J.Cons.CIEM, 26(2):191-203
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tilapia)
str(tilapia)
summary(tilapia)

</code></pre>

<hr>
<h2 id='trammelnet'>Trammel net data</h2><span id='topic+trammelnet'></span>

<h3>Description</h3>

<p>Data of an experiment with several trammel nets with different mesh sizes.
Can be used for function <code><a href="#topic+select_Millar">select_Millar</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trammelnet)
</code></pre>


<h3>Format</h3>

<p>A list consiting of:
</p>

<ul>
<li> <p><code>$midLengths</code>  the midlengths of size classes,
</p>
</li>
<li> <p><code>$meshSizes</code>  the meshsizes,
</p>
</li>
<li> <p><code>$catchPerNet_mat</code>  a matrix with the numbers in catch of the
corresponding mesh sizes (same order),
</p>
</li></ul>



<h3>Source</h3>

<p>Millar, R. B., Holst, R., 1997. Estimation of gillnet and hook selectivity
using log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3), 471-477.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trammelnet)
str(trammelnet)
summary(trammelnet)

</code></pre>

<hr>
<h2 id='trawl_fishery_Java'>Data from the trawl fishery off the North coast of Java</h2><span id='topic+trawl_fishery_Java'></span>

<h3>Description</h3>

<p>Times series of catch and effort data from the trawl fishery off the
North coast of Java. This dataset can
be used for the estimation of maximum sustainable yield by means of the
production models (<code><a href="#topic+prod_mod">prod_mod</a></code> and <code><a href="#topic+prod_mod_ts">prod_mod_ts</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(trawl_fishery_Java)
</code></pre>


<h3>Format</h3>

<p>A dataframe consisting of: 1. <strong>year</strong> a vector with years, 2. <strong>Y</strong>
yield [1000 tons], and 3. <strong>f</strong> fishing effort [number of standard vessels].
</p>


<h3>Source</h3>

<p>Dwiponggo, A., 1979. Review of the demersal resources and fisheries in the
Java Sea. IPFC:RRD/II/79/Inf.12. Paper presented at the SCORRAD Meeting, 1979,
Hong Kong.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(trawl_fishery_Java)
str(trawl_fishery_Java)
summary(trawl_fishery_Java)

</code></pre>

<hr>
<h2 id='VBGF'>Von Bertalanffy Growth function (VBGF)</h2><span id='topic+VBGF'></span>

<h3>Description</h3>

<p>This function applies the von Bertalanffy growth function (VBGF).
It allows to calculate ages from lengths or lengths from ages based on the special,
generalised or seasonalised VBGF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VBGF(param, t = NA, L = NA, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VBGF_+3A_param">param</code></td>
<td>
<p>a list with following potential objects:
</p>

<ul>
<li> <p><code>Linf</code>: infinite length for investigated species in cm, or
</p>
</li>
<li> <p><code>Winf</code>: infinite weight for investigated species in gramm
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch (default: 0)
</p>
</li>
<li> <p><code>b</code>: exponent of weight length relationship (default: 3)
</p>
</li>
<li> <p><code>D</code>: surface factor (default: 1)
</p>
</li>
<li> <p><code>L0</code>: length at hatching for VBGF with L0
</p>
</li>
<li> <p><code>ts</code>: onset of the first oscillation relative to t0
</p>
</li>
<li> <p><code>C</code>: intensity of (sinusoid) growth oscillations. Default is no oscillation (C = 0)
</p>
</li></ul>
</td></tr>
<tr><td><code id="VBGF_+3A_t">t</code></td>
<td>
<p>ages for which to calculate corresponding lengths, or</p>
</td></tr>
<tr><td><code id="VBGF_+3A_l">L</code></td>
<td>
<p>lengths for which to calculate corresponding ages</p>
</td></tr>
<tr><td><code id="VBGF_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; should NA in input length or age vector be omitted? (default: FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based upon which input parameters are given one of the following
VBGF types is applied: &quot;special&quot;, &quot;generalised&quot;, or &quot;seasonalised&quot; VBGF.
</p>


<h3>Value</h3>

<p>A vector with estimated lengths corresponding to provided ages.
</p>


<h3>References</h3>

<p>Somers, I. F. (1988). On a seasonally oscillating growth function.
Fishbyte, 6(1), 8-11
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># calculation of lengths
# with t0
t &lt;- seq(0,6,0.1)
Lt &lt;- VBGF(list(Linf=80, K=0.6, t0=-0.1),t=t)
plot(t, Lt, t="l")

# with L0
t &lt;- seq(0,6,0.1)
Lt &lt;- VBGF(list(Linf=80, K=0.6, L0=2),t=t)
plot(t, Lt, t="l")

# with Winf
t &lt;- seq(0,6,0.1)
Wt &lt;- VBGF(list(Winf=4000, K=0.8), t=t)
plot(t, Wt, t="l")

# seasonalised VBGF
t &lt;- seq(0,6,0.1)
Lt &lt;- VBGF(list(Linf=80, K=0.6, t0=-0.1, ts=0.5, C=0.75),t=t)
plot(t, Lt, t="l")


# calculation of ages
L &lt;- seq(2,200,0.1)
t &lt;- VBGF(L = L, list(Linf=210, K=0.8, C= 0.75))
plot(t, L, t="l")

</code></pre>

<hr>
<h2 id='VPA'>Virtual Population Analysis (VPA)</h2><span id='topic+VPA'></span>

<h3>Description</h3>

<p>This function applies the Virtual Population Analysis (VPA) or
Cohort analysis (CA). Methods used to estimate stock biomass and fishing
mortality per age/length group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VPA(
  param,
  catch_columns = NA,
  catch_unit = NA,
  catch_corFac = NA,
  terminalF = NA,
  terminalE = NA,
  analysis_type = "VPA",
  algorithm = "new",
  plus_group = TRUE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VPA_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>midLengths</code> or <code>age</code>: midpoints of the length class
(length-frequency data) or ages (age composition data),
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch,
</p>
</li>
<li> <p><code>M</code>: natural mortality [1/year] (numeric value or vector of identical
length than midLengths),
</p>
</li>
<li> <p><code>a</code>: length-weight relationship coefficent (W = a * L^b; for kg/cm3),
</p>
</li>
<li> <p><code>b</code>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><code>catch</code>: catch as vector for pseudo cohort analysis,
or a matrix with catches of subsequent years to follow a real cohort.
For age-based VPA/CA catch has to be provided in numbers, e.g. '000 individuals
for length-based VPA/CA catch can also be provided in weight, e.g. kg (use
argument <code>catch_unit</code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="VPA_+3A_catch_columns">catch_columns</code></td>
<td>
<p>numerical; indicating the column of the catch matrix which should be
used for the analysis.</p>
</td></tr>
<tr><td><code id="VPA_+3A_catch_unit">catch_unit</code></td>
<td>
<p>optional; a character indicating if the catch is provided in weight
(&quot;tons&quot; or &quot;kg&quot;) or in thousand individuals (&quot;'000&quot;)</p>
</td></tr>
<tr><td><code id="VPA_+3A_catch_corfac">catch_corFac</code></td>
<td>
<p>optional; correction factor for catch, in case provided
catch does spatially or temporarily not reflect catch for fishing ground of
a whole year.</p>
</td></tr>
<tr><td><code id="VPA_+3A_terminalf">terminalF</code></td>
<td>
<p>the fishing mortality rate of the last age/length group.</p>
</td></tr>
<tr><td><code id="VPA_+3A_terminale">terminalE</code></td>
<td>
<p>the exploitation rate of the last age/length group.</p>
</td></tr>
<tr><td><code id="VPA_+3A_analysis_type">analysis_type</code></td>
<td>
<p>determines which type of assessment should be done,
options: &quot;VPA&quot; for age or length-based Virtual Population Analysis, &quot;CA&quot; for age- or length-based
Cohort Analysis. Default is &quot;VPA&quot;.</p>
</td></tr>
<tr><td><code id="VPA_+3A_algorithm">algorithm</code></td>
<td>
<p>an Algorithm to use to solve for fishing mortality. The default
setting <code>"new"</code> uses <code><a href="stats.html#topic+optimise">optimise</a></code>,
while <code>"old"</code> uses the algorithm described by Sparre and Venema (1998).</p>
</td></tr>
<tr><td><code id="VPA_+3A_plus_group">plus_group</code></td>
<td>
<p>logical; indicating if the last length group is a plus group (default: TRUE).</p>
</td></tr>
<tr><td><code id="VPA_+3A_plot">plot</code></td>
<td>
<p>logical; indicating whether a plot should be printed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main difference between virtual population analysis (VPA) and cohort
analysis (CA) is the step of calculating the fishing mortality per age class or
length group. While CA works with an approximation by assuming that all fish are
caught during a single day, which makes the calcualtion easier, VPA assumes that
the fish are caught continuously, which has to be solved by the trial and error
method (Sparre and Venema, 1998).
For the age-based VPA/CA the catch has to be provided in numbers (or '000 numbers),
while for the length-based VPA/CA the catch can also be provided in weight (tons or kg) by
using the argument <code>catch_unit</code>.
The catch has to be representative for fished species, that means there should not be
other fisheries fishing the same stock. If this is the case <code>catch_corFac</code> can
be used as a raising factor to account for the proportion of fish caught by other
fisheries.
When the model should follow a real cohort instead of a pseudo cohort, <code>catch</code>
has to be provided as matrix. The model then starts to follow the first age class
in the first column.
If <code>catch</code> matrix is shorter than the number of age classes, the age or length
classes without catch information are omitted. It is recommended to only
follow a real cohort if there is enough information for all age classes
(test with: <code>dim(catch)[1] &lt;= dim(catch)[2]</code>).
If <code>plus_group</code> is TRUE a different calculation for the survivors of the last length group
is used (for more details please refer to Sparre &amp; Venema (1998)).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following list objects:
</p>

<ul>
<li> <p><strong>classes.num</strong>: numeric age classes or length groups (without plus sign),
</p>
</li>
<li> <p><strong>catch.cohort</strong>: a vector with the catch values which were used for
the analysis (exists only if catch was a matrix),
</p>
</li>
<li> <p><strong>FM_calc</strong>: a vector with the ifshing mortality (M),
</p>
</li>
<li> <p><strong>Z</strong>: a vector with the total mortality (Z),
</p>
</li>
<li> <p><strong>survivors</strong>: a vector with the number of fish surviving to the
next age class or length group (same unit than input catch vector),
</p>
</li>
<li> <p><strong>annualMeanNr</strong>: ta vector with the mean number of fish per year
(same unit than input catch vector),
</p>
</li>
<li> <p><strong>meanBodyWeight</strong>: a vector with the mean body weight in kg,
</p>
</li>
<li> <p><strong>meanBiomassTon</strong>: a vector with the mean biomass in tons,
</p>
</li>
<li> <p><strong>YieldTon</strong>: a vector with the yield in tons,
</p>
</li>
<li> <p><strong>natLoss</strong>: a vector with the number of fish died due
to natural mortality,
</p>
</li>
<li> <p><strong>plot_mat</strong>: matrix with rearranged survivors, nat losses
and catches for plotting;
</p>
</li></ul>



<h3>References</h3>

<p>Jones, R., 1984. Assessing the effects of changes in exploitation pattern using length
composition data (with notes on VPA and cohort analysis). <em>FAO Fish.Tech.Pap.</em>,
(256): 118p.
</p>
<p>Jones, R., 1990. Length-cohort analysis: the importance of choosing the correct growth
parameters. <em>Journal du Conseil: ICES Journal of Marine Science</em>, 46(2), 133-139
</p>
<p>Pope, J.G., 1972. An investigation of the accuracy of virtual population analysis using
cohort analysis. <em>Res.Bull.ICNAF</em>, (9):65-74
</p>
<p>Pope, J.G., 1979. A modified cohort analysis in which constant natural mortality is
replaced by estimates of predation levels. <em>ICES C.M.</em> 1979/H:16:7p. (mimeo)
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>References for weight-length relationship parameters (a &amp; b):
Dorel, D., 1986. Poissons del'Atlantique nord-est relations taille-poids.
Institut Francais de Recherche pour l'Exploitation de la Mer. Nantes, France. 165 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#_______________________________________________
# Virtual Popuation Analysis with age-composition data
data(whiting)
output &lt;- VPA(param = whiting, catch_columns = 1, terminalE = 0.5, analysis_type = "VPA")
plot(output)
#_______________________________________________
# Pope's Cohort Analysis with age-composition data
data(whiting)
VPA(whiting, terminalE = 0.5, catch_columns = 3, analysis_type = "CA",
   plot= TRUE, plus_group = TRUE)

#_______________________________________________
# Virtual population analysis with length-composition data
data(hake)
VPA(hake, terminalE = 0.5, analysis_type = "VPA", plot = TRUE,
    catch_unit = "'000", plus_group = TRUE)
#_______________________________________________
# Jones's Cohort Analysis with length-composition data
data(hake)
VPA(hake, terminalE = 0.5, analysis_type = "CA", plot = TRUE,
   catch_unit = "'000", plus_group = TRUE)

</code></pre>

<hr>
<h2 id='whiting'>Whiting data</h2><span id='topic+whiting'></span>

<h3>Description</h3>

<p>A dataset of North Sea whiting <em>Merlangius merlangus</em>
caught during the period 1974-1980. Can be used for <code><a href="#topic+catchCurve">catchCurve</a></code>
and <code><a href="#topic+VPA">VPA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(whiting)
</code></pre>


<h3>Format</h3>

<p>A list consisting of:
</p>

<ul>
<li> <p><code>age</code>: a vector with age groups,
</p>
</li>
<li> <p><code>M</code>: natural mortality rate,
</p>
</li>
<li> <p><code>a</code>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><code>b</code>: length-weight relationship coefficent (W = a * L^b),
</p>
</li>
<li> <p><code>catch</code>:a matrix with catches from 1974 to 1980.
</p>
</li></ul>



<h3>Source</h3>

<p>ICES, 1981. Report of the <em>Ad hoc</em> working group on the use of effort data
in assessment, Copenhagen, 2-6 March 1981. <em>ICES C.M.</em> 1981/G:5 (mimeo)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(whiting)
str(whiting)
summary(whiting)


</code></pre>

<hr>
<h2 id='yeardec2date'>Year - Date conversion</h2><span id='topic+yeardec2date'></span>

<h3>Description</h3>

<p>Convert numeric years to dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yeardec2date(yeardec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yeardec2date_+3A_yeardec">yeardec</code></td>
<td>
<p>numeric year</p>
</td></tr>
</table>


<h3>Value</h3>

<p>date in format &quot;%Y-%m-%d&quot; (class 'Date').
</p>


<h3>Examples</h3>

<pre><code class='language-R'> yeardec2date(2014.14)

</code></pre>

<hr>
<h2 id='ypr'>Yield per recruit</h2><span id='topic+ypr'></span>

<h3>Description</h3>

<p>Estimates the absolute and relative yield and biomass per recruit and
the first order derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ypr(param, FM_change, t = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ypr_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters (not all are required):
</p>

<ul>
<li> <p><strong>Linf</strong>: infinite length in cm,
</p>
</li>
<li> <p><strong>Winf</strong>: infinite weight,
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>t0</strong>: theoretical time zero, at which individuals of this species
hatch,
</p>
</li>
<li> <p><strong>M</strong>: natural mortality,
</p>
</li>
<li> <p><strong>tr</strong>: age of recruitment,
</p>
</li>
<li> <p><strong>tc</strong>: age of first capture;</p>
</li></ul>
</td></tr>
<tr><td><code id="ypr_+3A_fm_change">FM_change</code></td>
<td>
<p>vector with ascending fishing mortalities,</p>
</td></tr>
<tr><td><code id="ypr_+3A_t">t</code></td>
<td>
<p>default NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Thompson and Bell model incorporates an iteration step simulating the
stock by means
of the <code><a href="#topic+stock_sim">stock_sim</a></code> function. In case changes in gear
characteristics -
here measured in terms of Lc or tc, the length or age at first capture,
respectively -
should be explored, a list with selectivity information about the gear has
to be provided and
the prediction models make use of the selectivity <code><a href="#topic+select_ogive">select_ogive</a></code>
function.
Sparre and Venema (1998) recommend to treat the last length class always as plus group.
This model is very sensitive to zero observations in the ultimate length
classes. If unrealistic results are returned,
it is recommended to cut length classes with zero observations, group
them in a plus group or to change the interval between
length classes.
Equations which are used in this function assume isometric growth, an
assumption often not met. Further, the assumption that there is no relationship
between the parental stock size and progeny
over a wide range of fishing mortalities or exploitation values,
respectively, is also said to be untrue. By default, the functions assume
knife-edge recruitment and selection of gears (Sparre and Venema, 1998).
</p>


<h3>Value</h3>

<p>A list with the input parameters and dependent on the model type following
list objects:
</p>

<ul>
<li> <p><code>type = 'ypr'</code>
</p>
</li></ul>



<h3>References</h3>

<p>Berkeley, S.A., and Houde, E.D., 1980. Swordfish, Xiphias gladius, dynamics in
the Straits of Florida. <em>ICES C.M.</em>, 11.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1964. Table of yield functions for fishery
management. <em>FAO Fish. Tech. Pap.</em> 38, 49 p.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1966. Manual of methods for fish stock
assessment. Pt. 2: Tables of yield functions. <em>FAO Fisheries Technical Paper</em>,
(38)Rev.1:67 p.
</p>
<p>Boerema, L.K., and J.A. Gulland, 1973. Stock assessment of the Peruvian anchovy
(Engraulis ringens) and management of the fishery. <em>Journal of the Fisheries
Board of Canada</em>, 30(12):2226-2235
</p>
<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>
<p>Gulland, J.A., 1983. Fish stock assessment: a manual of basic methods.
<em>FAO/Wiley</em>, New York.
</p>
<p>Gulland, J.A. and Boerema, L., 1973. Scientific advice on catch levels.
<em>Fish. Bull. (US)</em> 71:325-335.
</p>
<p>Jones, R.E. 1957. A much simplified version of the fish yield equation. Doc. No.
P. 21. Paper presented at the Lisbon joint meeting of International Commission
Northwest Atlantic-Fisheries, International Council for the Exploration of the
Sea, and Food and Agriculture Organization of the United Nations. 8 p. [Mimeo].
</p>
<p>Millar, R.B., and Holst, R., 1997. Estimation of gillnet and hook selectivity using
log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Pauly, D., 1980. A selection of simple methods for the assessment of tropical fish
stocks. <em>FAO Fisheries Circulars (FAO)</em>. no. 729.
</p>
<p>Pauly, D., 1984. Fish population dynamics in tropical waters: a manual for use
with programmable calculators. <em>ICLARM</em> Stud. Rev. 8, 325 p.
</p>
<p>Pauly, D. and M. Soriano. 1986. Some practical extensions to Beverton and
Holt's relative yield-per-recruit model, p. 491-495. In J.L. Maclean, L.B. Dizon
and L.V. Hosillos (eds.) The First Asian Fisheries Forum. Asian Fisheries Society,
Manila.
</p>
<p>Schaefer, M.B., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Inter-Am. Trop. Tuna Comm.,
Bull.</em> 1(2):27-56.
</p>
<p>Schaefer, M.B., 1957. A study of the dynamics of the fishery for yellowfin tuna
in the eastern tropical Pacific Ocean. <em>Inter-Am. Trop. Tuna Comm., Bull.</em>
2:247-268.
</p>
<p>Sparre, P., and Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>

<hr>
<h2 id='ypr_sel'>Yield per recruit with selection ogive</h2><span id='topic+ypr_sel'></span>

<h3>Description</h3>

<p>Estimates relative yield and biomass, and the first order derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ypr_sel(param, FM_change, Lt, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ypr_sel_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters (not all are required):
</p>

<ul>
<li> <p><strong>Linf</strong>: infinite length in cm
</p>
</li>
<li> <p><strong>Winf</strong>: infinite weight
</p>
</li>
<li> <p><strong>K</strong>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><strong>t0</strong>: theoretical time zero, at which individuals of this species
hatch
</p>
</li>
<li> <p><strong>M</strong>: natural mortality
</p>
</li>
<li> <p><strong>tr</strong>: age of recruitment
</p>
</li>
<li> <p><strong>tc</strong>: age of first capture</p>
</li></ul>
</td></tr>
<tr><td><code id="ypr_sel_+3A_fm_change">FM_change</code></td>
<td>
<p>vector with ascending fishing mortalities</p>
</td></tr>
<tr><td><code id="ypr_sel_+3A_lt">Lt</code></td>
<td>
<p>length at time</p>
</td></tr>
<tr><td><code id="ypr_sel_+3A_p">P</code></td>
<td>
<p>population size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Thompson and Bell model incorporates an iteration step simulating the
stock by means
of the <code><a href="#topic+stock_sim">stock_sim</a></code> function. In case changes in gear
characteristics -
here measured in terms of Lc or tc, the length or age at first capture,
respectively -
should be explored, a list with selectivity information about the gear has
to be provided and
the prediction models make use of the selectivity <code><a href="#topic+select_ogive">select_ogive</a></code>
function.
Sparre and Venema (1998) recommend to treat the last length class always as plus group.
This model is very sensitive to zero observations in the ultimate length
classes. If unrealistic results are returned,
it is recommended to cut length classes with zero observations, group
them in a plus group or to change the interval between
length classes.
Equations which are used in this function assume isometric growth, an
assumption often not met. Further, the assumption that there is no relationship
between the parental stock size and progeny
over a wide range of fishing mortalities or exploitation values,
respectively, is also said to be untrue. By default, the functions assume
knife-edge recruitment and selection of gears (Sparre and Venema, 1998).
</p>


<h3>Value</h3>

<p>A list with the input parameters and dependent on the model type following
list objects:
</p>

<ul>
<li>
</li></ul>



<h3>References</h3>

<p>Berkeley, S.A., and Houde, E.D., 1980. Swordfish, Xiphias gladius, dynamics in
the Straits of Florida. <em>ICES C.M.</em>, 11.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1964. Table of yield functions for fishery
management. <em>FAO Fish. Tech. Pap.</em> 38, 49 p.
</p>
<p>Beverton, R.J.H., and Holt, S.J., 1966. Manual of methods for fish stock
assessment. Pt. 2: Tables of yield functions. <em>FAO Fisheries Technical Paper</em>,
(38)Rev.1:67 p.
</p>
<p>Boerema, L.K., and J.A. Gulland, 1973. Stock assessment of the Peruvian anchovy
(Engraulis ringens) and management of the fishery. <em>Journal of the Fisheries
Board of Canada</em>, 30(12):2226-2235
</p>
<p>Garcia, S. and N.P. van Zalinge, 1982. Shrimp fishing in Kuwait: methodology
for a joint analysis of the artisanal and industrial fisheries. pp. 119-142 In:
Report on the Workshop on assessment of the shrimp stocks of the west coast of
the Gulf between Iran and the Arabian Peninsula. Fisheries development in the
Gulf. Rome, FAO, FI:DP/RAB/80/015/1, 163 p.
</p>
<p>Gulland, J.A., 1983. Fish stock assessment: a manual of basic methods.
<em>FAO/Wiley</em>, New York.
</p>
<p>Gulland, J.A. and Boerema, L., 1973. Scientific advice on catch levels.
<em>Fish. Bull. (US)</em> 71:325-335.
</p>
<p>Jones, R.E. 1957. A much simplified version of the fish yield equation. Doc. No.
P. 21. Paper presented at the Lisbon joint meeting of International Commission
Northwest Atlantic-Fisheries, International Council for the Exploration of the
Sea, and Food and Agriculture Organization of the United Nations. 8 p. [Mimeo].
</p>
<p>Millar, R.B., and Holst, R., 1997. Estimation of gillnet and hook selectivity using
log-linear models. <em>ICES Journal of Marine Science: Journal du Conseil</em>,
54(3):471-477
</p>
<p>Pauly, D., 1980. A selection of simple methods for the assessment of tropical fish
stocks. <em>FAO Fisheries Circulars (FAO)</em>. no. 729.
</p>
<p>Pauly, D., 1984. Fish population dynamics in tropical waters: a manual for use
with programmable calculators. <em>ICLARM</em> Stud. Rev. 8, 325 p.
</p>
<p>Pauly, D. and M. Soriano. 1986. Some practical extensions to Beverton and
Holt's relative yield-per-recruit model, p. 491-495. In J.L. Maclean, L.B. Dizon
and L.V. Hosillos (eds.) The First Asian Fisheries Forum. Asian Fisheries Society,
Manila.
</p>
<p>Schaefer, M.B., 1954. Some aspects of the dynamics of populations important to the
management of the commercial marine fisheries. <em>Inter-Am. Trop. Tuna Comm.,
Bull.</em> 1(2):27-56.
</p>
<p>Schaefer, M.B., 1957. A study of the dynamics of the fishery for yellowfin tuna
in the eastern tropical Pacific Ocean. <em>Inter-Am. Trop. Tuna Comm., Bull.</em>
2:247-268.
</p>
<p>Sparre, P., and Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>

<hr>
<h2 id='Z_BevertonHolt'>Beverton &amp; Holt's Z-Equations</h2><span id='topic+Z_BevertonHolt'></span>

<h3>Description</h3>

<p>A method to estimate the instantaneous total mortality rate (Z) based
on a method derived by Beverton and Holt (1956).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Z_BevertonHolt(param, catch_columns = NA, Lprime_tprime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Z_BevertonHolt_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li>  <p><code>midLengths</code> or <code>age</code>: midpoints of length groups
(length-frequency data) or ages (age composition data),
</p>
</li>
<li> <p><code>Linf</code>: infinite length for investigated species in cm [cm],
</p>
</li>
<li> <p><code>K</code>: growth coefficent for investigated species per year [1/year],
</p>
</li>
<li> <p><code>t0</code>: theoretical time zero, at which individuals of this species hatch,
</p>
</li>
<li> <p><code>catch</code>: catch as vector, or a matrix with catches of subsequent years;
</p>
</li></ul>
</td></tr>
<tr><td><code id="Z_BevertonHolt_+3A_catch_columns">catch_columns</code></td>
<td>
<p>optional; in case catch is a matrix or data.frame, a number or vector
indicating which column(s) of the matrix should be analysed (Default: <code>NA</code>).</p>
</td></tr>
<tr><td><code id="Z_BevertonHolt_+3A_lprime_tprime">Lprime_tprime</code></td>
<td>
<p>length or age prime, above which all fish are under full exploitation as
mid length or age class.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first length group or age class within the list object <code>midLengths</code> or
<code>age</code> will be used as the Lprim or tprime (length of recruitment to fishery).
</p>


<h3>Value</h3>

<p>A list with the input parameters and following objects:
</p>

<ul>
<li> <p><strong>tmean</strong> or <strong>Lmean</strong>: mean age or length of fish,
</p>
</li>
<li> <p><strong>tprime</strong> or <strong>Lprime</strong>: some age or length for which all fish of
that length and longer are under full exploitation,
</p>
</li>
<li> <p><strong>Z</strong>: total mortality.
</p>
</li></ul>



<h3>References</h3>

<p>Beverton R.J.H and S.J. Holt, 1956. A review of methods of estimating mortality rates
in exploited fish populations, with special reference to sources of bias in catch
sampling. <em>Rapp.P.-v.Reun.CIEM</em>, 140:67-83
</p>
<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># based on length-frequency data
data(synLFQ2)
Z_BevertonHolt(synLFQ2, catch_columns = 2, Lprime_tprime = 47.5)

# based on age composition data
data(synCAA1)
Z_BevertonHolt(synCAA1, catch_columns = 3, Lprime_tprime = 2.5)

</code></pre>

<hr>
<h2 id='Z_CPUE'>Estimate Z from CPUE data</h2><span id='topic+Z_CPUE'></span>

<h3>Description</h3>

<p>Method to estimate the instantaneous total mortality rate (Z) from
catch per unit of effort (CPUE) data according to standard, Heincke's, or
Robson &amp; Chapman's method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Z_CPUE(param, method = "standard", omit_age1 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Z_CPUE_+3A_param">param</code></td>
<td>
<p>a list consisting of following parameters:
</p>

<ul>
<li> <p><code>cohort</code>: a vector with with a cohort label,
</p>
</li>
<li> <p><code>age</code>: a vector with ages,
</p>
</li>
<li> <p><code>CPUE</code>: a vector with CPUE values;
</p>
</li></ul>
</td></tr>
<tr><td><code id="Z_CPUE_+3A_method">method</code></td>
<td>
<p>a character string indicating which assessment method should be used:
<code>"standard"</code>, <code>"Heincke"</code>, or <code>"RobsonChapman"</code>.</p>
</td></tr>
<tr><td><code id="Z_CPUE_+3A_omit_age1">omit_age1</code></td>
<td>
<p>logical; if <code>TRUE</code> the first age group is
omitted (Default <code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In Heincke's and RobsonChapman's method age groups older than 4 are lumped,
because age groups older than 3 or 4 are said to be hard to seperate (Ricker, 1975).
Sparre and Venema (1998) recommend to omit the first age group in case it is
not fully exploited by the fishery.
</p>


<h3>Value</h3>

<p>A list with input parameters and a Z value or matrix depending on the method.
</p>


<h3>References</h3>

<p>Sparre, P., Venema, S.C., 1998. Introduction to tropical fish stock assessment.
Part 1. Manual. <em>FAO Fisheries Technical Paper</em>, (306.1, Rev. 2). 407 p.
</p>
<p>Sparre, P., Venema, S.C., 1999. Introduction to tropical fish stock assessment.
Part 2. Excercises. <em>FAO Fisheries Technical Paper</em>, (306.2, Rev. 2). 94 p.
</p>
<p>Ricker, W.E., 1975. Computation and interpretation of biological statistics of fish
populations. <em>Bull.Fish.Res.Board Can.</em>, (191):382 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data
data(synCPUE)

# run model with standard method
Z_CPUE(synCPUE, method = "standard")

# run model with Heincke's method
Z_CPUE(synCPUE, method = "Heincke")

# run model with Robson and Chapman's method
Z_CPUE(synCPUE, method = "RobsonChapman", omit_age1 = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
