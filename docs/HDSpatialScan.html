<!DOCTYPE html><html><head><title>Help for package HDSpatialScan</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HDSpatialScan}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#clusters'><p>Creation of the matrix of potential clusters</p></a></li>
<li><a href='#DFFSS'><p>DFFSS scan procedure</p></a></li>
<li><a href='#dfree'><p>Index for the UG scan procedure</p></a></li>
<li><a href='#dfree_index_multi'><p>Index for the MDFFSS scan procedure</p></a></li>
<li><a href='#FinScan'><p>Finalization of the scan procedures</p></a></li>
<li><a href='#fmulti_data'><p>Multivariate functional data</p></a></li>
<li><a href='#funi_data'><p>Univariate functional data</p></a></li>
<li><a href='#HDSpatialScan-package'><p>Multivariate and Functional Spatial Scan Statistics</p></a></li>
<li><a href='#InitScan'><p>Initalization of the scan procedures by creating the matrix of potential clusters</p></a></li>
<li><a href='#map_sites'><p>Spatial object corresponding to the sites of the data of the package HDSpatialScan</p></a></li>
<li><a href='#MDFFSS'><p>MDFFSS scan procedure</p></a></li>
<li><a href='#MG'><p>MG scan procedure</p></a></li>
<li><a href='#MNP'><p>MNP scan procedure</p></a></li>
<li><a href='#MPFSS'><p>MPFSS scan procedure</p></a></li>
<li><a href='#MRBFSS'><p>MRBFSS scan procedure</p></a></li>
<li><a href='#multi_data'><p>Multivariate non-functional data</p></a></li>
<li><a href='#multi_fWMW'><p>Index for the NPFSS scan procedure (multivariate functional case)</p></a></li>
<li><a href='#multi_gaussian'><p>Index for the MG scan procedure</p></a></li>
<li><a href='#multi_signs_matrix'><p>List of matrix of signs (multivariate functional data)</p></a></li>
<li><a href='#multi_WMW'><p>Index for the MNP scan procedure</p></a></li>
<li><a href='#non_overlap'><p>Return only the detected clusters with no overlapping in their order of detection</p></a></li>
<li><a href='#NPFSS'><p>NPFSS scan procedure (univariate functional or multivariate functional)</p></a></li>
<li><a href='#permutate'><p>Permutates the data</p></a></li>
<li><a href='#PFSS'><p>PFSS scan procedure</p></a></li>
<li><a href='#plot_map'><p>Map of circular clusters</p></a></li>
<li><a href='#plot_map2'><p>Map of the clusters</p></a></li>
<li><a href='#plot_schema'><p>Schema of the clusters</p></a></li>
<li><a href='#plot.ResScanOutput'><p>Schema or map of the clusters</p></a></li>
<li><a href='#plotCurves'><p>Generic function to plot curves</p></a></li>
<li><a href='#plotCurves.ResScanOutputMultiFunct'><p>Plots the curves in the clusters detected by the multivariate functional scan functions (MPFSS, NPFSS, MDFFSS or MRBFSS)</p></a></li>
<li><a href='#plotCurves.ResScanOutputUniFunct'><p>Plots the curves in the clusters detected by the univariate functional scan functions (PFSS, NPFSS, DFFSS or URBFSS)</p></a></li>
<li><a href='#plotSummary'><p>Generic function to plot a summary</p></a></li>
<li><a href='#plotSummary.ResScanOutputMulti'><p>Plots the mean or median spider chart of the clusters detected by a multivariate scan function (MG or MNP)</p></a></li>
<li><a href='#plotSummary.ResScanOutputMultiFunct'><p>Plots the mean or median curves in the clusters detected by a multivariate functional scan procedure (MPFSS, NPFSS, MDFFSS or MRBFSS)</p></a></li>
<li><a href='#plotSummary.ResScanOutputUniFunct'><p>Plots the mean or median curves in the clusters detected by a univariate functional scan procedure (PFSS, NPFSS, DFFSS or URBFSS)</p></a></li>
<li><a href='#pointwise_dfree'><p>Index for the DFFSS scan procedure</p></a></li>
<li><a href='#pointwise_wmw_multi'><p>Index for the MRBFSS scan procedure</p></a></li>
<li><a href='#pointwise_wmw_uni'><p>Index for the URBFSS scan procedure</p></a></li>
<li><a href='#post_filt_area'><p>A posteriori filtering on the area</p></a></li>
<li><a href='#post_filt_nb_sites'><p>A posteriori filtering on the number of sites/individuals</p></a></li>
<li><a href='#post_filt_radius'><p>A posteriori filtering on the radius</p></a></li>
<li><a href='#print.ResScanOutput'><p>Prints a result of a scan procedure</p></a></li>
<li><a href='#ResScanOutput'><p>Constructor function for objects of the ResScanOutput class</p></a></li>
<li><a href='#ResScanOutputMulti'><p>Constructor function for objects of the ResScanOutputMulti class</p></a></li>
<li><a href='#ResScanOutputMultiFunct'><p>Constructor function for objects of the ResScanOutputMultiFunct class</p></a></li>
<li><a href='#ResScanOutputUni'><p>Constructor function for objects of the ResScanOutputUni class</p></a></li>
<li><a href='#ResScanOutputUniFunct'><p>Constructor function for objects of the ResScanOutputUniFunct class</p></a></li>
<li><a href='#SpatialScan'><p>Spatial scan procedure</p></a></li>
<li><a href='#summary.ResScanOutputMulti'><p>Summary of the clusters obtained with a multivariate scan function (MG or MNP).</p></a></li>
<li><a href='#summary.ResScanOutputMultiFunct'><p>Summary of the clusters obtained with a multivariate functional scan function (MPFSS, NPFSS, MDFFSS or MRBFSS).</p></a></li>
<li><a href='#summary.ResScanOutputUni'><p>Summary of the clusters obtained with a univariate scan function (UG or UNP).</p></a></li>
<li><a href='#summary.ResScanOutputUniFunct'><p>Summary of the clusters obtained with a univariate functional scan function (PFSS, NPFSS, DFFSS or URBFSS).</p></a></li>
<li><a href='#transform_data'><p>Computation of the multivariate functional ranks</p></a></li>
<li><a href='#UG'><p>UG scan procedure</p></a></li>
<li><a href='#uni_fWMW'><p>Index for the NPFSS scan procedure (univariate functional case)</p></a></li>
<li><a href='#uni_signs_matrix'><p>Computation of the matrix of signs</p></a></li>
<li><a href='#UNP'><p>UNP scan procedure</p></a></li>
<li><a href='#URBFSS'><p>URBFSS scan procedure</p></a></li>
<li><a href='#wmw_uni'><p>Index for the UNP scan procedure</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate and Functional Spatial Scan Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows to detect spatial clusters of abnormal values on multivariate or functional data. Martin KULLDORFF and Lan HUANG and Kevin KONTY (2009) &lt;<a href="https://doi.org/10.1186%2F1476-072X-8-58">doi:10.1186/1476-072X-8-58</a>&gt;, Inkyung JUNG and Ho Jin CHO (2015) &lt;<a href="https://doi.org/10.1186%2Fs12942-015-0024-6">doi:10.1186/s12942-015-0024-6</a>&gt;, Lionel CUCALA and Michael GENIN and Caroline LANIER and Florent OCCELLI (2017) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2017.06.001">doi:10.1016/j.spasta.2017.06.001</a>&gt;, Lionel CUCALA and Michael GENIN and Florent OCCELLI and Julien SOULA (2019) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2018.10.002">doi:10.1016/j.spasta.2018.10.002</a>&gt;, Camille FREVENT and Mohamed-Salem AHMED and Matthieu MARBAC and Michael GENIN (2021) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2021.100550">doi:10.1016/j.spasta.2021.100550</a>&gt;, Zaineb SMIDA and Lionel CUCALA and Ali GANNOUN and Ghislain Durif (2022) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2021.107378">doi:10.1016/j.csda.2021.107378</a>&gt;, Camille FREVENT and Mohamed-Salem AHMED and Sophie DABO-NIANG and Michael GENIN (2023) &lt;<a href="https://doi.org/10.1093%2Fjrsssc%2Fqlad017">doi:10.1093/jrsssc/qlad017</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, pbapply, purrr, matrixStats, SpatialNP, sp,
sf, DT, TeachingDemos, plotrix, fmsb, swfscMisc, raster,
graphics, stats, grDevices, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp</td>
</tr>
<tr>
<td>Collate:</td>
<td>'documentation_page.R' 'clusters.R' 'permutations.R'
'gaussian_multi.R' 'wmw_multi.R' 'wmw_fonc.R' 'scan_fonc.R'
'scan_multi.R' 'plot_map.R' 'RcppExports.R'
'dfree_index_multi.R' 'pointwise_dfree.R'
'pointwise_wmw_multi.R' 'pointwise_wmw_uni.R'
'transform_data.R' 'data_fmulti_data.R' 'data_funi_data.R'
'data_multi_data.R' 'data_map_sites.R' 'posteriori_filtering.R'
'non_overlap.R' 'scan_uni.R' 'wmw_uni.R' 'dfree.R'
'finalizing_scan_procedure.R' 'HDSpatialScan_plot.R'
'HDSpatialScan_Classes.R' 'HDSpatialScan_plotCurves.R'
'HDSpatialScan_plotSummary.R' 'HDSpatialScan_print.R'
'HDSpatialScan_summary.R' 'InitScan.R' 'SpatialScan.R'</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-24 10:35:54 UTC; cfrevent</td>
</tr>
<tr>
<td>Author:</td>
<td>Camille FREVENT [aut, cre, cph],
  Mohamed-Salem AHMED [aut],
  Julien SOULA [aut],
  Zaineb SMIDA [aut],
  Lionel CUCALA [aut],
  Sophie DABO-NIANG [aut],
  Michaël GENIN [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Camille FREVENT &lt;camille.frevent@univ-lille.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-25 07:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='clusters'>Creation of the matrix of potential clusters</h2><span id='topic+clusters'></span>

<h3>Description</h3>

<p>This function creates the matrix in which each column corresponds to a potential clusters, taking the value 1 when a site (or an individual) is in the potential cluster and 0 otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusters(sites_coord, system, mini, maxi, type_minimaxi, sites_areas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusters_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Matrix of the coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates). It has the same number of rows as the number of sites or individuals and 2 columns.</p>
</td></tr>
<tr><td><code id="clusters_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="clusters_+3A_mini">mini</code></td>
<td>
<p>numeric. Minimum for the clusters (see type_minimaxi).</p>
</td></tr>
<tr><td><code id="clusters_+3A_maxi">maxi</code></td>
<td>
<p>numeric. Maximum for the clusters (see type_minimaxi).</p>
</td></tr>
<tr><td><code id="clusters_+3A_type_minimaxi">type_minimaxi</code></td>
<td>
<p>character. Type of minimum and maximum: &quot;area&quot;: the minimum and maximum area of the clusters, &quot;radius&quot;: the minimum and maximum radius, or &quot;sites/indiv&quot;: the minimum and maximum number of sites or individuals in the clusters.</p>
</td></tr>
<tr><td><code id="clusters_+3A_sites_areas">sites_areas</code></td>
<td>
<p>numeric vector. Areas of the sites. It must contain the same number of elements than the rows of sites_coord. If the data is on individuals and not on sites, there can be duplicated values. By default: NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list of the following elements:
</p>

<ul>
<li><p> matrix_clusters: numeric matrix of 0 and 1
</p>
</li>
<li><p> centres: the coordinates of the centres of each cluster (numeric matrix)
</p>
</li>
<li><p> radius: the radius of the clusters in km if system = &quot;WGS84&quot; or in the coordinates unit otherwise (numeric vector)
</p>
</li>
<li><p> areas: the areas of the clusters (in same units as in sites_areas). Provided only if sites_areas is not NULL. Numeric vector
</p>
</li>
<li><p> system: the system of coordinates (character)
</p>
</li></ul>


<hr>
<h2 id='DFFSS'>DFFSS scan procedure</h2><span id='topic+DFFSS'></span>

<h3>Description</h3>

<p>This function computes the DFFSS (Distribution-Free Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DFFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DFFSS_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or to the individuals if the observations are by individuals and not by sites) and each column represents an observation time. The times must be the same for each site/individual.</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="DFFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUniFunct.
</p>


<h3>References</h3>

<p>Camille Frévent and Mohamed-Salem Ahmed and Matthieu Marbac and Michaël Genin (2021). Detecting Spatial Clusters in Functional Data: New Scan Statistic Approaches. Spatial Statistics, 46.
</p>

<hr>
<h2 id='dfree'>Index for the UG scan procedure</h2><span id='topic+dfree'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster and each permutation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfree(data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfree_+3A_data">data</code></td>
<td>
<p>numeric matrix. Matrix of the data. The rows correspond to the sites (or the individuals) and each column represents a permutation.</p>
</td></tr>
<tr><td><code id="dfree_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix.
</p>

<hr>
<h2 id='dfree_index_multi'>Index for the MDFFSS scan procedure</h2><span id='topic+dfree_index_multi'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfree_index_multi(data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfree_index_multi_+3A_data">data</code></td>
<td>
<p>List. List of the data, each element of the list corresponds to a site (or an individual), for each element each row corresponds to a variable and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="dfree_index_multi_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='FinScan'>Finalization of the scan procedures</h2><span id='topic+FinScan'></span>

<h3>Description</h3>

<p>This function finalizes the scan procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FinScan(
  index_clusters_temp,
  index,
  filtering_post,
  type_minimaxi_post,
  mini_post,
  maxi_post,
  nb_sites,
  matrix_clusters,
  radius,
  areas,
  centres,
  pvals,
  maximize = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FinScan_+3A_index_clusters_temp">index_clusters_temp</code></td>
<td>
<p>numeric vector. Indices of the significant clusters.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_index">index</code></td>
<td>
<p>numeric vector. Index of concentration for each potential cluster.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_filtering_post">filtering_post</code></td>
<td>
<p>logical. Is there an a posteriori filtering?</p>
</td></tr>
<tr><td><code id="FinScan_+3A_type_minimaxi_post">type_minimaxi_post</code></td>
<td>
<p>character. Type of minimum and maximum a posteriori: by default &quot;sites/indiv&quot;: the mini_post and maxi_post are on the number of sites or individuals in the significant clusters. Other possible values are &quot;area&quot;: the minimum and maximum area of the clusters, or &quot;radius&quot;: the minimum and maximum radius.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_nb_sites">nb_sites</code></td>
<td>
<p>numeric. The number of considered sites or individuals.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>matrix. The matrix of potential clusters taking the value 1 at lign i and column j if the cluster j contains the site i, 0 otherwise.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_radius">radius</code></td>
<td>
<p>numeric vector. The radius of the potential clusters.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_areas">areas</code></td>
<td>
<p>numeric vector. The areas of the potential clusters.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_centres">centres</code></td>
<td>
<p>numeric matrix. The coordinates of the centres of each potential cluster.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_pvals">pvals</code></td>
<td>
<p>numeric vector. The pvalue of each potential cluster.</p>
</td></tr>
<tr><td><code id="FinScan_+3A_maximize">maximize</code></td>
<td>
<p>logical. Should the index be maximized? By default TRUE. If FALSE it will be minimized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list of the following elements:
</p>

<ul>
<li><p> pval_clusters: pvalues of the selected clusters.
</p>
</li>
<li><p> sites_clusters: the indices of the sites of the selected clusters.
</p>
</li>
<li><p> centres_clusters: the coordinates of the centres of each selected cluster.
</p>
</li>
<li><p> radius_clusters: the radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: the areas of the selected clusters.
</p>
</li></ul>


<hr>
<h2 id='fmulti_data'>Multivariate functional data</h2><span id='topic+fmulti_data'></span>

<h3>Description</h3>

<p>Concentrations over the time of NO2, O3, PM10 and PM2.5 from 2020/05/01 to 2020/06/25 in each canton (administrative subdivision) of Nord-Pas-de-Calais (a region from France).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fmulti_data")
</code></pre>


<h3>Format</h3>

<p>A list of 169 elements. Each element corresponds to a canton and is a matrix of 56 columns (for the 56 days of observation) and 4 rows (4 variables, in the order NO2, O3, PM10 and PM2.5).
</p>


<h3>References</h3>

<p>Data from the National Air Quality Forecasting Platform www.prevair.org
</p>

<hr>
<h2 id='funi_data'>Univariate functional data</h2><span id='topic+funi_data'></span>

<h3>Description</h3>

<p>Concentration over the time of the pollutant NO2 from 2020/05/01 to 2020/06/25 in each canton (administrative subdivision) of Nord-Pas-de-Calais (a region from France).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("funi_data")
</code></pre>


<h3>Format</h3>

<p>A matrix of 169 rows and 56 columns. Each row corresponds to a canton, and each column is an observation time (a day). The 56 observation times are thus equally spaced times.
</p>


<h3>References</h3>

<p>Data from the National Air Quality Forecasting Platform www.prevair.org
</p>

<hr>
<h2 id='HDSpatialScan-package'>Multivariate and Functional Spatial Scan Statistics</h2><span id='topic+HDSpatialScan-package'></span><span id='topic+HDSpatialScan'></span>

<h3>Description</h3>

<p>Allows to detect spatial clusters of abnormal values on multivariate or functional data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> HDSpatialScan</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-05-24</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>FREVENT Camille, AHMED Mohamed-Salem, SOULA Julien, SMIDA Zaineb, CUCALA Lionel, DABO-NIANG Sophie and GENIN Michaël. Maintainer: FREVENT Camille &lt;camille.frevent@univ-lille.fr&gt;
</p>


<h3>References</h3>

<p>Martin Kulldorff and Lan Huang and Kevin Konty (2009). A Scan Statistic for Continuous Data Based on the Normal Probability Model. International Journal of Health Geographics, 8 (58).
</p>
<p>Inkyung Jung and Ho Jin Cho (2015). A Nonparametric Spatial Scan Statistic for Continuous Data. International Journal of Health Geographics, 14.
</p>
<p>Lionel Cucala and Michaël Genin and Caroline Lanier and Florent Occelli (2017). A Multivariate Gaussian Scan Statistic for Spatial Data. Spatial Statistics, 21, 66-74.
</p>
<p>Lionel Cucala and Michaël Genin and Florent Occelli and Julien Soula (2019). A Multivariate Nonparametric Scan Statistic for Spatial Data. Spatial statistics, 29, 1-14.
</p>
<p>Camille Frévent and Mohamed-Salem Ahmed and Matthieu Marbac and Michaël Genin (2021). Detecting Spatial Clusters in Functional Data: New Scan Statistic Approaches. Spatial Statistics, 46.
</p>
<p>Zaineb Smida and Lionel Cucala and Ali Gannoun and Ghislain Durif (2022). A Wilcoxon-Mann-Whitney spatial scan statistic for functional data. Computational Statistics &amp; Data Analysis, 167.
</p>
<p>Camille Frévent and Mohamed-Salem Ahmed and Sophie Dabo-Niang and Michaël Genin (2023). Investigating Spatial Scan Statistics for Multivariate Functional Data. Journal of the Royal Statistical Society Series C: Applied Statistics, 72(2), 450-475.
</p>

<hr>
<h2 id='InitScan'>Initalization of the scan procedures by creating the matrix of potential clusters</h2><span id='topic+InitScan'></span>

<h3>Description</h3>

<p>This function initializes the scan procedures by creating the matrix of potential clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InitScan(
  mini_post,
  maxi_post,
  type_minimaxi_post,
  sites_areas,
  sites_coord,
  system,
  mini,
  maxi,
  type_minimaxi
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="InitScan_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_type_minimaxi_post">type_minimaxi_post</code></td>
<td>
<p>character. Type of minimum and maximum a posteriori: by default &quot;sites/indiv&quot;: the mini_post and maxi_post are on the number of sites or individuals in the significant clusters. Other possible values are &quot;area&quot;: the minimum and maximum area of the clusters, or &quot;radius&quot;: the minimum and maximum radius.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_sites_areas">sites_areas</code></td>
<td>
<p>numeric vector. Areas of the sites. It must contain the same number of elements than the rows of sites_coord. If the data is on individuals and not on sites, there can be duplicated values. By default: NULL</p>
</td></tr>
<tr><td><code id="InitScan_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="InitScan_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_mini">mini</code></td>
<td>
<p>integer. A minimum for the clusters (see type_minimaxi). Changing the default value may bias the inference.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_maxi">maxi</code></td>
<td>
<p>integer. A Maximum for the clusters (see type_minimaxi). Changing the default value may bias the inference.</p>
</td></tr>
<tr><td><code id="InitScan_+3A_type_minimaxi">type_minimaxi</code></td>
<td>
<p>character. Type of minimum and maximum: by default &quot;sites/indiv&quot;: the mini and maxi are on the number of sites or individuals in the potential clusters. Other possible values are &quot;area&quot;: the minimum and maximum area of the clusters, or &quot;radius&quot;: the minimum and maximum radius.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list of the following elements:
</p>

<ul>
<li><p> filtering_post: logical, is there an a posteriori filtering?
</p>
</li>
<li><p> matrix_clusters: the matrix of potential clusters
</p>
</li>
<li><p> centres: the coordinates of the centres of each potential cluster
</p>
</li>
<li><p> radius: the radius of the potential clusters in km if system = WGS84 or in the user units
</p>
</li>
<li><p> areas: the areas of the potential clusters (in the same units as sites_areas).
</p>
</li>
<li><p> sites_coord: coordinates of the sites
</p>
</li>
<li><p> system: system in which the coordinates are expressed
</p>
</li>
<li><p> mini_post: a minimum to filter the significant clusters a posteriori
</p>
</li>
<li><p> maxi_post: a maximum to filter the significant clusters a posteriori
</p>
</li>
<li><p> type_minimaxi_post: type of minimum and maximum a posteriori
</p>
</li></ul>


<hr>
<h2 id='map_sites'>Spatial object corresponding to the sites of the data of the package HDSpatialScan</h2><span id='topic+map_sites'></span>

<h3>Description</h3>

<p>Spatial object corresponding to the sites (169 cantons) of the data of the package HDSpatialScan.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("map_sites")
</code></pre>


<h3>Format</h3>

<p>A SpatialPolygonsDataFrame.
</p>

<hr>
<h2 id='MDFFSS'>MDFFSS scan procedure</h2><span id='topic+MDFFSS'></span>

<h3>Description</h3>

<p>This function computes the MDFFSS (Multivariate Distribution-Free Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MDFFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MDFFSS_+3A_data">data</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals if the observations are by individuals and not by sites) matrices of the data, the rows correspond to the variables and each column represents an observation time. The times must be the same for each site/individual.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="MDFFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMultiFunct.
</p>


<h3>References</h3>

<p>Camille Frévent and Mohamed-Salem Ahmed and Sophie Dabo-Niang and Michaël Genin (2023). Investigating Spatial Scan Statistics for Multivariate Functional Data. Journal of the Royal Statistical Society Series C: Applied Statistics, 72(2), 450-475.
</p>

<hr>
<h2 id='MG'>MG scan procedure</h2><span id='topic+MG'></span>

<h3>Description</h3>

<p>This function computes the MG (Multivariate Gaussian scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MG(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MG_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or the individuals if the observations are by individuals and not by sites) and each column represents a variable.</p>
</td></tr>
<tr><td><code id="MG_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="MG_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="MG_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="MG_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="MG_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="MG_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMulti.
</p>


<h3>References</h3>

<p>Lionel Cucala and Michaël Genin and Caroline Lanier and Florent Occelli (2017). A Multivariate Gaussian Scan Statistic for Spatial Data. Spatial Statistics, 21, 66-74.
</p>

<hr>
<h2 id='MNP'>MNP scan procedure</h2><span id='topic+MNP'></span>

<h3>Description</h3>

<p>This function computes the MNP (Multivariate Nonparametric scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MNP(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MNP_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or the individuals if the observations are by individuals and not by sites) and each column represents a variable.</p>
</td></tr>
<tr><td><code id="MNP_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="MNP_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="MNP_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="MNP_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL</p>
</td></tr>
<tr><td><code id="MNP_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="MNP_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMulti.
</p>


<h3>References</h3>

<p>Lionel Cucala and Michaël Genin and Florent Occelli and Julien Soula (2019). A Multivariate Nonparametric Scan Statistic for Spatial Data. Spatial statistics, 29, 1-14.
</p>

<hr>
<h2 id='MPFSS'>MPFSS scan procedure</h2><span id='topic+MPFSS'></span>

<h3>Description</h3>

<p>This function computes the MPFSS (Parametric Multivariate Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MPFSS(
  data,
  MC = 999,
  typeI = 0.05,
  method = c("LH", "W", "P", "R"),
  nbCPU = 1,
  variable_names = NULL,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MPFSS_+3A_data">data</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals if the observations are by individuals and not by sites) matrices of the data, the rows correspond to the variables and each column represents an observation time. The times must be equally spaced and the same for each site/individual.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_method">method</code></td>
<td>
<p>character vector. The methods to compute the significant clusters. Options: &quot;LH&quot;, &quot;W&quot;, &quot;P&quot;, &quot;R&quot; for respectively the Lawley-Hotelling trace test statistic, The Wilks lambda test statistic, the Pillai trace test statistic and the Roy's maximum root test statistic. By default all are computed.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="MPFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of objects of class ResScanOutputMultiFunct (one element by method)
</p>


<h3>References</h3>

<p>Camille Frévent and Mohamed-Salem Ahmed and Sophie Dabo-Niang and Michaël Genin (2023). Investigating Spatial Scan Statistics for Multivariate Functional Data. Journal of the Royal Statistical Society Series C: Applied Statistics, 72(2), 450-475.
</p>

<hr>
<h2 id='MRBFSS'>MRBFSS scan procedure</h2><span id='topic+MRBFSS'></span>

<h3>Description</h3>

<p>This function computes the MRBFSS (Multivariate Rank-Based Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRBFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MRBFSS_+3A_data">data</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals if the observations are by individuals and not by sites) matrices of the data, the rows correspond to the variables and each column represents an observation time. The times must be the same for each site/individual.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="MRBFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMultiFunct
</p>


<h3>References</h3>

<p>Camille Frévent and Mohamed-Salem Ahmed and Sophie Dabo-Niang and Michaël Genin (2023). Investigating Spatial Scan Statistics for Multivariate Functional Data. Journal of the Royal Statistical Society Series C: Applied Statistics, 72(2), 450-475.
</p>

<hr>
<h2 id='multi_data'>Multivariate non-functional data</h2><span id='topic+multi_data'></span>

<h3>Description</h3>

<p>Average concentrations over the time of NO2, O3, PM10 and PM2.5 from 2020/05/01 to 2020/06/25 in each canton (administrative subdivision) of Nord-Pas-de-Calais (a region from France).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("multi_data")
</code></pre>


<h3>Format</h3>

<p>A matrix of 169 rows and 4 columns. Each row corresponds to a canton, and each column is a concentration mean in the order NO2, O3, PM10 and PM2.5.
</p>


<h3>References</h3>

<p>Data from the National Air Quality Forecasting Platform www.prevair.org
</p>

<hr>
<h2 id='multi_fWMW'>Index for the NPFSS scan procedure (multivariate functional case)</h2><span id='topic+multi_fWMW'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_fWMW(signs, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_fWMW_+3A_signs">signs</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals) sign matrices, the rows correspond to the variables and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="multi_fWMW_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='multi_gaussian'>Index for the MG scan procedure</h2><span id='topic+multi_gaussian'></span>

<h3>Description</h3>

<p>This function returns the index we want to minimize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_gaussian(data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_gaussian_+3A_data">data</code></td>
<td>
<p>numeric matrix. Matrix of the data, the rows correspond to the sites (or individuals) and each column represents a variable.</p>
</td></tr>
<tr><td><code id="multi_gaussian_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='multi_signs_matrix'>List of matrix of signs (multivariate functional data)</h2><span id='topic+multi_signs_matrix'></span>

<h3>Description</h3>

<p>This function returns the list of matrix of signs for the multivariate functional data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_signs_matrix(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_signs_matrix_+3A_data">data</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals) matrices of the data, the rows correspond to the variables and each column represents an observation time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of numeric matrices.
</p>

<hr>
<h2 id='multi_WMW'>Index for the MNP scan procedure</h2><span id='topic+multi_WMW'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_WMW(rank_data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_WMW_+3A_rank_data">rank_data</code></td>
<td>
<p>numeric matrix. Matrix of the ranks of the initial data, the rows correspond to the sites (or the individuals) and each column represents a variable.</p>
</td></tr>
<tr><td><code id="multi_WMW_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='non_overlap'>Return only the detected clusters with no overlapping in their order of detection</h2><span id='topic+non_overlap'></span>

<h3>Description</h3>

<p>This function allows to return only the detected clusters with no overlapping in their order of detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>non_overlap(index_clusters, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="non_overlap_+3A_index_clusters">index_clusters</code></td>
<td>
<p>numeric vector. The indices of the detected clusters.</p>
</td></tr>
<tr><td><code id="non_overlap_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. A value of 1 indicate that the site (or the individual) is in the cluster, 0 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The detecting clusters with no overlapping, in their order of detection.
</p>

<hr>
<h2 id='NPFSS'>NPFSS scan procedure (univariate functional or multivariate functional)</h2><span id='topic+NPFSS'></span>

<h3>Description</h3>

<p>This function computes the NPFSS (Nonparametric Functional scan statistic for multivariate or univariate functional data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPFSS_+3A_data">data</code></td>
<td>
<p>list of numeric matrices or a matrix. List of nb_sites (or nb_individuals if the observations are by individuals and not by site) matrices of the data, the rows correspond to the variables and each column represents an observation time (multivariate case) ; or Matrix of the data, the rows correspond to the sites (or to the individuals) and each column represents an observation time (univariate case). The times must be equally spaced and the same for each site/individual.</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL. Ignored if the data is a matrix (univariate functional case).</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="NPFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUniFunct or ResScanOutputMultiFunct depending on the data
</p>


<h3>References</h3>

<p>Zaineb Smida and Lionel Cucala and Ali Gannoun and Ghislain Durif (2022). A Wilcoxon-Mann-Whitney spatial scan statistic for functional data. Computational Statistics &amp; Data Analysis, 167.
</p>

<hr>
<h2 id='permutate'>Permutates the data</h2><span id='topic+permutate'></span>

<h3>Description</h3>

<p>This function will permit to permute the data for the MC simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permutate(to_permute, nb_permu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permutate_+3A_to_permute">to_permute</code></td>
<td>
<p>vector. Vector of indices we want to permute.</p>
</td></tr>
<tr><td><code id="permutate_+3A_nb_permu">nb_permu</code></td>
<td>
<p>numeric. Number of permutations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix. Matrix of nb_permu rows and length(to_permute) columns.
</p>

<hr>
<h2 id='PFSS'>PFSS scan procedure</h2><span id='topic+PFSS'></span>

<h3>Description</h3>

<p>This function computes the PFSS (Parametric Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PFSS_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or to the individuals if the observations are by individuals and not by sites) and each column represents an observation time. The times must be equally spaced and the same for each site/individual.</p>
</td></tr>
<tr><td><code id="PFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="PFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="PFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="PFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="PFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="PFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUniFunct.
</p>


<h3>References</h3>

<p>Camille Frévent and Mohamed-Salem Ahmed and Matthieu Marbac and Michaël Genin (2021). Detecting Spatial Clusters in Functional Data: New Scan Statistic Approaches. Spatial Statistics, 46.
</p>

<hr>
<h2 id='plot_map'>Map of circular clusters</h2><span id='topic+plot_map'></span>

<h3>Description</h3>

<p>This function plots a map of the sites and the circular clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_map(spobject, centres, radius, system, colors = "red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_map_+3A_spobject">spobject</code></td>
<td>
<p>SpObject. SpatialObject with the same coordinates system that centres (the same that sites_coord in the scan functions)</p>
</td></tr>
<tr><td><code id="plot_map_+3A_centres">centres</code></td>
<td>
<p>numeric matrix or vector if only one cluster was detected. Coordinates of the centres of each cluster.</p>
</td></tr>
<tr><td><code id="plot_map_+3A_radius">radius</code></td>
<td>
<p>numeric vector. Radius of each cluster in the user units if system = &quot;Euclidean&quot;, or in km if system = &quot;WGS84&quot; (in the output of the scan functions)</p>
</td></tr>
<tr><td><code id="plot_map_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="plot_map_+3A_colors">colors</code></td>
<td>
<p>character. Colors of the clusters. If length(colors)=1 all the clusters will be in this color. Else it should be a vector of length the number of clusters to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots a map of the sites and the circular clusters.
</p>

<hr>
<h2 id='plot_map2'>Map of the clusters</h2><span id='topic+plot_map2'></span>

<h3>Description</h3>

<p>This function plots a map of the sites and the clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_map2(spobject, sites_coord, output_clusters, system, colors = "red")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_map2_+3A_spobject">spobject</code></td>
<td>
<p>SpObject. SpatialObject corresponding the sites.</p>
</td></tr>
<tr><td><code id="plot_map2_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites or the individuals, in the same order that the data for the cluster detection.</p>
</td></tr>
<tr><td><code id="plot_map2_+3A_output_clusters">output_clusters</code></td>
<td>
<p>list. List of the sites in the clusters: it is the sites_clusters of the output of NPFSS, PFSS, DFFSS, URBFSS, MDFFSS, MRBFSS, MG, MNP, UG or UNP, or the sites_clusters_LH/sites_clusters_W/sites_clusters_P/sites_clusters_R of the MPFSS.</p>
</td></tr>
<tr><td><code id="plot_map2_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="plot_map2_+3A_colors">colors</code></td>
<td>
<p>character. Colors of the clusters. If length(colors)=1 all the clusters will be in this color. Else it should be a vector of length the number of clusters to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots a map of the sites and the clusters.
</p>

<hr>
<h2 id='plot_schema'>Schema of the clusters</h2><span id='topic+plot_schema'></span>

<h3>Description</h3>

<p>This function plots a schema of the sites and the clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_schema(
  output_clusters,
  sites_coord,
  system,
  system_conv = NULL,
  colors = "red"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_schema_+3A_output_clusters">output_clusters</code></td>
<td>
<p>list. List of the sites in the clusters: it is the sites_clusters of the output of NPFSS, PFSS, DFFSS, URBFSS, MDFFSS, MRBFSS, MG, MNP, UG or UNP, or the sites_clusters_LH/sites_clusters_W/sites_clusters_P/sites_clusters_R of the MPFSS.</p>
</td></tr>
<tr><td><code id="plot_schema_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites, in the same order that the data for the cluster detection.</p>
</td></tr>
<tr><td><code id="plot_schema_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="plot_schema_+3A_system_conv">system_conv</code></td>
<td>
<p>character. System to convert the coordinates for the plot. Only considered if system is &quot;WGS84&quot;. Must be entered as in the PROJ.4 documentation</p>
</td></tr>
<tr><td><code id="plot_schema_+3A_colors">colors</code></td>
<td>
<p>character. Colors of the clusters. If length(colors)=1 all the clusters will be in this color. Else it should be a vector of length the number of clusters to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots a schema of the sites and the clusters.
</p>

<hr>
<h2 id='plot.ResScanOutput'>Schema or map of the clusters</h2><span id='topic+plot.ResScanOutput'></span>

<h3>Description</h3>

<p>This function plots a schema or a map of the sites and the clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutput'
plot(
  x,
  type,
  spobject = NULL,
  system_conv = NULL,
  colors = "red",
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ResScanOutput_+3A_x">x</code></td>
<td>
<p>ResScanOutput. Output of a scan function (UG, UNP, MG, MNP, PFSS, DFFSS, URBFSS, NPFSS, MPFSS, MDFFSS or MRBFSS)</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_type">type</code></td>
<td>
<p>character. Type of plot: &quot;schema&quot;, &quot;map&quot; (the clusters are represented by circles) or &quot;map2&quot; (the clusters are colored on the map)</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_spobject">spobject</code></td>
<td>
<p>SpObject. SpatialObject with the same coordinates system the one used for the scan. Only considered if type is &quot;map&quot; or &quot;map2&quot;</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_system_conv">system_conv</code></td>
<td>
<p>character. System to convert the coordinates for the plot. Only considered if the system used in the scan was &quot;WGS84&quot; and if type is &quot;schema&quot;. Else it will be ignored. Must be entered as in the PROJ.4 documentation</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_colors">colors</code></td>
<td>
<p>character. Colors of the clusters. If length(colors)=1 all the clusters will be in this color. Else it should be a vector of length the number of clusters to plot.</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plot.ResScanOutput_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots a schema or a map of the sites and the clusters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

plot(x = res_npfss, type = "schema", system_conv = "+init=epsg:2154")
plot(x = res_npfss, type = "map", spobject = map_sites)
plot(x = res_npfss, type = "map2", spobject = map_sites)


</code></pre>

<hr>
<h2 id='plotCurves'>Generic function to plot curves</h2><span id='topic+plotCurves'></span>

<h3>Description</h3>

<p>This function is a generic function to plot curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCurves(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCurves_+3A_x">x</code></td>
<td>
<p>An object for which the curves are to be plotted.</p>
</td></tr>
<tr><td><code id="plotCurves_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the curves.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotCurves.ResScanOutputUniFunct">plotCurves.ResScanOutputUniFunct</a></code> and <code><a href="#topic+plotCurves.ResScanOutputMultiFunct">plotCurves.ResScanOutputMultiFunct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords, system = "WGS84",
mini = 1, maxi = nrow(coords)/2)$NPFSS

plotCurves(x = res_npfss, add_mean = TRUE, add_median = TRUE)


</code></pre>

<hr>
<h2 id='plotCurves.ResScanOutputMultiFunct'>Plots the curves in the clusters detected by the multivariate functional scan functions (MPFSS, NPFSS, MDFFSS or MRBFSS)</h2><span id='topic+plotCurves.ResScanOutputMultiFunct'></span>

<h3>Description</h3>

<p>This function plot the curves in the clusters detected by the multivariate functional scan functions (MPFSS, NPFSS, MDFFSS or MRBFSS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputMultiFunct'
plotCurves(
  x,
  add_mean = FALSE,
  add_median = FALSE,
  colors = "red",
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_x">x</code></td>
<td>
<p>ResScanOutputMultiFunct. Output of a multivariate functional scan function (MPFSS, NPFSS, MDFFSS or MRBFSS).</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_add_mean">add_mean</code></td>
<td>
<p>boolean. If TRUE it adds the global mean curve in black.</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_add_median">add_median</code></td>
<td>
<p>boolean. If TRUE it adds the global median curve in blue.</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_colors">colors</code></td>
<td>
<p>character. The colors to plot the clusters' curves. If length(colors)==1 then all the clusters will be plotted in this color. Else there must be the same number of elements in colors than the number of clusters</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputMultiFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("fmulti_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = fmulti_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

plotCurves(x = res_npfss, add_mean = TRUE, add_median = TRUE)


</code></pre>

<hr>
<h2 id='plotCurves.ResScanOutputUniFunct'>Plots the curves in the clusters detected by the univariate functional scan functions (PFSS, NPFSS, DFFSS or URBFSS)</h2><span id='topic+plotCurves.ResScanOutputUniFunct'></span>

<h3>Description</h3>

<p>This function plot the curves in the clusters detected by the univariate functional scan functions (PFSS, NPFSS, DFFSS or URBFSS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputUniFunct'
plotCurves(
  x,
  add_mean = FALSE,
  add_median = FALSE,
  colors = "red",
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_x">x</code></td>
<td>
<p>ResScanOutputUniFunct. Output of a univariate functional scan function (PFSS, NPFSS, DFFSS or URBFSS).</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_add_mean">add_mean</code></td>
<td>
<p>boolean. If TRUE it adds the global mean curve in black.</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_add_median">add_median</code></td>
<td>
<p>boolean. If TRUE it adds the global median curve in blue.</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_colors">colors</code></td>
<td>
<p>character. The colors to plot the clusters' curves. If length(colors)==1 then all the clusters will be plotted in this color. Else there must be the same number of elements in colors than the number of clusters</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plotCurves.ResScanOutputUniFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

plotCurves(x = res_npfss, add_mean = TRUE, add_median = TRUE)


</code></pre>

<hr>
<h2 id='plotSummary'>Generic function to plot a summary</h2><span id='topic+plotSummary'></span>

<h3>Description</h3>

<p>This function is a generic function to plot a summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSummary(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSummary_+3A_x">x</code></td>
<td>
<p>An object for which the summary is to be plotted.</p>
</td></tr>
<tr><td><code id="plotSummary_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the summary.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSummary.ResScanOutputMulti">plotSummary.ResScanOutputMulti</a></code>, <code><a href="#topic+plotSummary.ResScanOutputUniFunct">plotSummary.ResScanOutputUniFunct</a></code> and <code><a href="#topic+plotSummary.ResScanOutputMultiFunct">plotSummary.ResScanOutputMultiFunct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("multi_data")
coords &lt;- coordinates(map_sites)

res_mnp &lt;- SpatialScan(method = "MNP", data = multi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2,
variable_names = c("NO2", "O3", "PM10", "PM2.5"))$MNP

plotSummary(x = res_mnp, type = "mean")


</code></pre>

<hr>
<h2 id='plotSummary.ResScanOutputMulti'>Plots the mean or median spider chart of the clusters detected by a multivariate scan function (MG or MNP)</h2><span id='topic+plotSummary.ResScanOutputMulti'></span>

<h3>Description</h3>

<p>This function plots the mean or median spider chart of the clusters detected by a multivariate scan function (MG or MNP).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputMulti'
plotSummary(x, type = "mean", colors = "red", only.MLC = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSummary.ResScanOutputMulti_+3A_x">x</code></td>
<td>
<p>ResScanOutputMulti. Output of a multivariate scan function (MG or MNP).</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMulti_+3A_type">type</code></td>
<td>
<p>character. &quot;mean&quot; or &quot;median&quot;. If &quot;mean&quot;: the means in the clusters are plotted in solid lines, outside the cluster in dots, the global mean is in black. If &quot;median&quot;: the medians in the clusters are plotted in solid lines, outside the cluster in dots, the global median is in black.</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMulti_+3A_colors">colors</code></td>
<td>
<p>character. The colors to plot the clusters' summaries. If length(colors)==1 then all the clusters will be plotted in this color. Else there must be the same number of elements in colors than the number of clusters</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMulti_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMulti_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the spider chart.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("multi_data")
coords &lt;- coordinates(map_sites)

res_mnp &lt;- SpatialScan(method = "MNP", data=multi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2,
variable_names = c("NO2", "O3", "PM10", "PM2.5"))$MNP

plotSummary(x = res_mnp, type = "mean")


</code></pre>

<hr>
<h2 id='plotSummary.ResScanOutputMultiFunct'>Plots the mean or median curves in the clusters detected by a multivariate functional scan procedure (MPFSS, NPFSS, MDFFSS or MRBFSS)</h2><span id='topic+plotSummary.ResScanOutputMultiFunct'></span>

<h3>Description</h3>

<p>This function plots the mean or median curves in the clusters detected by a multivariate functional scan procedure (MPFSS, NPFSS, MDFFSS or MRBFSS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputMultiFunct'
plotSummary(x, type = "mean", colors = "red", only.MLC = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSummary.ResScanOutputMultiFunct_+3A_x">x</code></td>
<td>
<p>ResScanOutputMultiFunct. Output of a multivariate functional scan function (MPFSS, NPFSS, MDFFSS or MRBFSS).</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMultiFunct_+3A_type">type</code></td>
<td>
<p>character. &quot;mean&quot; or &quot;median&quot;. If &quot;mean&quot;: the mean curves in the clusters are plotted in solid lines, outside the cluster in dots, the global mean curve is in black. If &quot;median&quot;: the median curves in the clusters are plotted in solid lines, outside the cluster in dots, the global median curve is in black.</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMultiFunct_+3A_colors">colors</code></td>
<td>
<p>character. The colors to plot the clusters' summary curves. If length(colors)==1 then all the clusters will be plotted in this color. Else there must be the same number of elements in colors than the number of clusters</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMultiFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputMultiFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("fmulti_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = fmulti_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

plotSummary(x = res_npfss, type = "median")


</code></pre>

<hr>
<h2 id='plotSummary.ResScanOutputUniFunct'>Plots the mean or median curves in the clusters detected by a univariate functional scan procedure (PFSS, NPFSS, DFFSS or URBFSS)</h2><span id='topic+plotSummary.ResScanOutputUniFunct'></span>

<h3>Description</h3>

<p>This function plots the mean or median curves in the clusters detected by a univariate functional scan procedure (PFSS, NPFSS, DFFSS or URBFSS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputUniFunct'
plotSummary(x, type = "mean", colors = "red", only.MLC = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSummary.ResScanOutputUniFunct_+3A_x">x</code></td>
<td>
<p>ResScanOutputUniFunct. Output of a univariate functional scan function (PFSS, NPFSS, DFFSS or URBFSS).</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputUniFunct_+3A_type">type</code></td>
<td>
<p>character. &quot;mean&quot; or &quot;median&quot;. If &quot;mean&quot;: the mean curves in the clusters are plotted in solid lines, outside the cluster in dots, the global mean curve is in black. If &quot;median&quot;: the median curves in the clusters are plotted in solid lines, outside the cluster in dots, the global median curve is in black.</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputUniFunct_+3A_colors">colors</code></td>
<td>
<p>character. The colors to plot the clusters' summary curves. If length(colors)==1 then all the clusters will be plotted in this color. Else there must be the same number of elements in colors than the number of clusters</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputUniFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we plot only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="plotSummary.ResScanOutputUniFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, plots the curves.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

plotSummary(x = res_npfss, type = "median")


</code></pre>

<hr>
<h2 id='pointwise_dfree'>Index for the DFFSS scan procedure</h2><span id='topic+pointwise_dfree'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointwise_dfree(data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pointwise_dfree_+3A_data">data</code></td>
<td>
<p>numeric matrix. Matrix of the data. The rows correspond to the sites (or the individuals) and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="pointwise_dfree_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='pointwise_wmw_multi'>Index for the MRBFSS scan procedure</h2><span id='topic+pointwise_wmw_multi'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointwise_wmw_multi(transform_data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pointwise_wmw_multi_+3A_transform_data">transform_data</code></td>
<td>
<p>List. List of the data transformed with the function transform_data, each element of the list corresponds to an observation time. Each row of each element is a site (or an individual), and each column represents a variable.</p>
</td></tr>
<tr><td><code id="pointwise_wmw_multi_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='pointwise_wmw_uni'>Index for the URBFSS scan procedure</h2><span id='topic+pointwise_wmw_uni'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointwise_wmw_uni(rank_data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pointwise_wmw_uni_+3A_rank_data">rank_data</code></td>
<td>
<p>matrix. Matrix of the ranks of the data for each time. Each column corresponds to an observation time and each row corresponds to a site or an individual.</p>
</td></tr>
<tr><td><code id="pointwise_wmw_uni_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='post_filt_area'>A posteriori filtering on the area</h2><span id='topic+post_filt_area'></span>

<h3>Description</h3>

<p>This function allows the a posteriori filtering on the area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_filt_area(mini_post, maxi_post, areas_clusters, index_clusters_temp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_filt_area_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="post_filt_area_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="post_filt_area_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. The areas of the clusters.</p>
</td></tr>
<tr><td><code id="post_filt_area_+3A_index_clusters_temp">index_clusters_temp</code></td>
<td>
<p>numeric vector. The indices of the detected clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The detecting clusters with the a posteriori filtering.
</p>

<hr>
<h2 id='post_filt_nb_sites'>A posteriori filtering on the number of sites/individuals</h2><span id='topic+post_filt_nb_sites'></span>

<h3>Description</h3>

<p>This function allows the a posteriori filtering on the number of sites/individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_filt_nb_sites(
  mini_post,
  maxi_post,
  nb_sites,
  index_clusters_temp,
  matrix_clusters
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_filt_nb_sites_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="post_filt_nb_sites_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="post_filt_nb_sites_+3A_nb_sites">nb_sites</code></td>
<td>
<p>numeric. The number of sites/individuals.</p>
</td></tr>
<tr><td><code id="post_filt_nb_sites_+3A_index_clusters_temp">index_clusters_temp</code></td>
<td>
<p>numeric vector. The indices of the detected clusters.</p>
</td></tr>
<tr><td><code id="post_filt_nb_sites_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. A value of 1 indicate that the site (or the individual) is in the cluster, 0 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The detecting clusters with the a posteriori filtering.
</p>

<hr>
<h2 id='post_filt_radius'>A posteriori filtering on the radius</h2><span id='topic+post_filt_radius'></span>

<h3>Description</h3>

<p>This function allows the a posteriori filtering on the radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_filt_radius(mini_post, maxi_post, radius, index_clusters_temp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_filt_radius_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="post_filt_radius_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori. The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="post_filt_radius_+3A_radius">radius</code></td>
<td>
<p>numeric vector. The radius of each cluster.</p>
</td></tr>
<tr><td><code id="post_filt_radius_+3A_index_clusters_temp">index_clusters_temp</code></td>
<td>
<p>numeric vector. The indices of the detected clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The detecting clusters with the a posteriori filtering.
</p>

<hr>
<h2 id='print.ResScanOutput'>Prints a result of a scan procedure</h2><span id='topic+print.ResScanOutput'></span>

<h3>Description</h3>

<p>This function prints a result of a scan procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutput'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ResScanOutput_+3A_x">x</code></td>
<td>
<p>ResScanOutput. Output of a scan function (UG, UNP, MG, MNP, PFSS, DFFSS, URBFSS, NPFSS, MPFSS, MDFFSS or MRBFSS)</p>
</td></tr>
<tr><td><code id="print.ResScanOutput_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, print the ResScanOutput object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

print(x = res_npfss)


</code></pre>

<hr>
<h2 id='ResScanOutput'>Constructor function for objects of the ResScanOutput class</h2><span id='topic+ResScanOutput'></span>

<h3>Description</h3>

<p>This is the constructor function for objects of the ResScanOutput class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResScanOutput(
  sites_clusters,
  pval_clusters,
  centres_clusters,
  radius_clusters,
  areas_clusters,
  system,
  sites_coord,
  data,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResScanOutput_+3A_sites_clusters">sites_clusters</code></td>
<td>
<p>list. List of the indices of the sites of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_pval_clusters">pval_clusters</code></td>
<td>
<p>numeric vector. The pvalues of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_centres_clusters">centres_clusters</code></td>
<td>
<p>numeric matrix. Coordinates of the centres of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_radius_clusters">radius_clusters</code></td>
<td>
<p>numeric vector. Radius of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. Areas of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_data">data</code></td>
<td>
<p>list of numeric matrices or a matrix or a vector. List of nb_sites (or nb_individuals if the observations are by individuals and not by site) matrices of the data, the rows correspond to the variables and each column represents an observation time (multivariate functional case) ; or Matrix of the data, the rows correspond to the sites (or to the individuals) and each column represents an observation time (univariate functional case) or a variable (multivariate case) ; or Vector of the data, the elements correspond to the sites (or to the individuals) (univariate case).</p>
</td></tr>
<tr><td><code id="ResScanOutput_+3A_method">method</code></td>
<td>
<p>character. The scan procedure used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutput which is a list of the following elements:
</p>

<ul>
<li><p> sites_clusters: List of the indices of the sites of the selected clusters.
</p>
</li>
<li><p> pval_clusters: The pvalues of the selected clusters.
</p>
</li>
<li><p> centres_clusters: Coordinates of the centres of the selected clusters.
</p>
</li>
<li><p> radius_clusters: Radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: Areas of the selected clusters.
</p>
</li>
<li><p> system: System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.
</p>
</li>
<li><p> sites_coord: Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).
</p>
</li>
<li><p> data: List of numeric matrices or a matrix or a vector.
</p>
</li>
<li><p> method: The scan procedure used.
</p>
</li></ul>


<hr>
<h2 id='ResScanOutputMulti'>Constructor function for objects of the ResScanOutputMulti class</h2><span id='topic+ResScanOutputMulti'></span>

<h3>Description</h3>

<p>This is the constructor function for objects of the ResScanOutputMulti class which inherits from class ResScanOutput.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResScanOutputMulti(
  sites_clusters,
  pval_clusters,
  centres_clusters,
  radius_clusters,
  areas_clusters,
  system,
  variable_names = NULL,
  sites_coord,
  data,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResScanOutputMulti_+3A_sites_clusters">sites_clusters</code></td>
<td>
<p>list. List of the indices of the sites of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_pval_clusters">pval_clusters</code></td>
<td>
<p>numeric vector. The pvalues of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_centres_clusters">centres_clusters</code></td>
<td>
<p>numeric matrix. Coordinates of the centres of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_radius_clusters">radius_clusters</code></td>
<td>
<p>numeric vector. Radius of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. Areas of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or to the individuals) and each column represents a variable.</p>
</td></tr>
<tr><td><code id="ResScanOutputMulti_+3A_method">method</code></td>
<td>
<p>character. The scan procedure used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMulti which is a list of the following elements:
</p>

<ul>
<li><p> sites_clusters: List of the indices of the sites of the selected clusters.
</p>
</li>
<li><p> pval_clusters: The pvalues of the selected clusters.
</p>
</li>
<li><p> centres_clusters: Coordinates of the centres of the selected clusters.
</p>
</li>
<li><p> radius_clusters: Radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: Areas of the selected clusters.
</p>
</li>
<li><p> system: System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.
</p>
</li>
<li><p> sites_coord: Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).
</p>
</li>
<li><p> data: Matrix.
</p>
</li>
<li><p> variable_names: names of the variables.
</p>
</li>
<li><p> method: The scan procedure used.
</p>
</li></ul>


<hr>
<h2 id='ResScanOutputMultiFunct'>Constructor function for objects of the ResScanOutputMultiFunct class</h2><span id='topic+ResScanOutputMultiFunct'></span>

<h3>Description</h3>

<p>This is the constructor function for objects of the ResScanOutputMultiFunct class which inherits from class ResScanOutput.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResScanOutputMultiFunct(
  sites_clusters,
  pval_clusters,
  centres_clusters,
  radius_clusters,
  areas_clusters,
  system,
  times = NULL,
  variable_names = NULL,
  sites_coord,
  data,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResScanOutputMultiFunct_+3A_sites_clusters">sites_clusters</code></td>
<td>
<p>list. List of the indices of the sites of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_pval_clusters">pval_clusters</code></td>
<td>
<p>numeric vector. The pvalues of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_centres_clusters">centres_clusters</code></td>
<td>
<p>numeric matrix. Coordinates of the centres of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_radius_clusters">radius_clusters</code></td>
<td>
<p>numeric vector. Radius of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. Areas of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_data">data</code></td>
<td>
<p>list of numeric matrices. List of nb_sites (or nb_individuals if the observations are by individuals and not by site) matrices of the data, the rows correspond to the variables and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="ResScanOutputMultiFunct_+3A_method">method</code></td>
<td>
<p>character. The scan procedure used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputMultiFunct which is a list of the following elements:
</p>

<ul>
<li><p> sites_clusters: List of the indices of the sites of the selected clusters.
</p>
</li>
<li><p> pval_clusters: The pvalues of the selected clusters.
</p>
</li>
<li><p> centres_clusters: Coordinates of the centres of the selected clusters.
</p>
</li>
<li><p> radius_clusters: Radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: Areas of the selected clusters.
</p>
</li>
<li><p> system: System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.
</p>
</li>
<li><p> sites_coord: Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).
</p>
</li>
<li><p> data: list of numeric matrices.
</p>
</li>
<li><p> times: times of observation of the data.
</p>
</li>
<li><p> variable_names: names of the variables.
</p>
</li>
<li><p> method: the scan procedure used.
</p>
</li></ul>


<hr>
<h2 id='ResScanOutputUni'>Constructor function for objects of the ResScanOutputUni class</h2><span id='topic+ResScanOutputUni'></span>

<h3>Description</h3>

<p>This is the constructor function for objects of the ResScanOutputUni class which inherits from class ResScanOutput.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResScanOutputUni(
  sites_clusters,
  pval_clusters,
  centres_clusters,
  radius_clusters,
  areas_clusters,
  system,
  sites_coord,
  data,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResScanOutputUni_+3A_sites_clusters">sites_clusters</code></td>
<td>
<p>list. List of the indices of the sites of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_pval_clusters">pval_clusters</code></td>
<td>
<p>numeric vector. The pvalues of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_centres_clusters">centres_clusters</code></td>
<td>
<p>numeric matrix. Coordinates of the centres of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_radius_clusters">radius_clusters</code></td>
<td>
<p>numeric vector. Radius of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. Areas of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_data">data</code></td>
<td>
<p>vector. Vector of the data, the elements correspond to the sites (or to the individuals).</p>
</td></tr>
<tr><td><code id="ResScanOutputUni_+3A_method">method</code></td>
<td>
<p>character. The scan procedure used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUni which is a list of the following elements:
</p>

<ul>
<li><p> sites_clusters: List of the indices of the sites of the selected clusters.
</p>
</li>
<li><p> pval_clusters: The pvalues of the selected clusters.
</p>
</li>
<li><p> centres_clusters: Coordinates of the centres of the selected clusters.
</p>
</li>
<li><p> radius_clusters: Radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: Areas of the selected clusters.
</p>
</li>
<li><p> system: System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.
</p>
</li>
<li><p> sites_coord: Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).
</p>
</li>
<li><p> data: Vector.
</p>
</li>
<li><p> method: The scan procedure used.
</p>
</li></ul>


<hr>
<h2 id='ResScanOutputUniFunct'>Constructor function for objects of the ResScanOutputUniFunct class</h2><span id='topic+ResScanOutputUniFunct'></span>

<h3>Description</h3>

<p>This is the constructor function for objects of the ResScanOutputUniFunct class which inherits from class ResScanOutput.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ResScanOutputUniFunct(
  sites_clusters,
  pval_clusters,
  centres_clusters,
  radius_clusters,
  areas_clusters,
  system,
  times = NULL,
  sites_coord,
  data,
  method
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ResScanOutputUniFunct_+3A_sites_clusters">sites_clusters</code></td>
<td>
<p>list. List of the indices of the sites of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_pval_clusters">pval_clusters</code></td>
<td>
<p>numeric vector. The pvalues of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_centres_clusters">centres_clusters</code></td>
<td>
<p>numeric matrix. Coordinates of the centres of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_radius_clusters">radius_clusters</code></td>
<td>
<p>numeric vector. Radius of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_areas_clusters">areas_clusters</code></td>
<td>
<p>numeric vector. Areas of the selected clusters.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or to the individuals) and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="ResScanOutputUniFunct_+3A_method">method</code></td>
<td>
<p>character. The scan procedure used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUniFunct which is a list of the following elements:
</p>

<ul>
<li><p> sites_clusters: List of the indices of the sites of the selected clusters.
</p>
</li>
<li><p> pval_clusters: The pvalues of the selected clusters.
</p>
</li>
<li><p> centres_clusters: Coordinates of the centres of the selected clusters.
</p>
</li>
<li><p> radius_clusters: Radius of the selected clusters.
</p>
</li>
<li><p> areas_clusters: Areas of the selected clusters.
</p>
</li>
<li><p> system: System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.
</p>
</li>
<li><p> sites_coord: Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).
</p>
</li>
<li><p> data: Matrix.
</p>
</li>
<li><p> times: times of observation of the data.
</p>
</li>
<li><p> method : the scan procedure used
</p>
</li></ul>


<hr>
<h2 id='SpatialScan'>Spatial scan procedure</h2><span id='topic+SpatialScan'></span>

<h3>Description</h3>

<p>This function computes the different scan procedures available in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpatialScan(
  method,
  data,
  sites_coord = NULL,
  system = NULL,
  mini = 1,
  maxi = nrow(sites_coord)/2,
  type_minimaxi = "sites/indiv",
  mini_post = NULL,
  maxi_post = NULL,
  type_minimaxi_post = "sites/indiv",
  sites_areas = NULL,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  variable_names = NULL,
  times = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpatialScan_+3A_method">method</code></td>
<td>
<p>character vector. The scan procedures to apply on the data. Possible values are:
</p>

<ul>
<li><p> Univariate scan procedures: &quot;UG&quot; (univariate gaussian, see <code><a href="#topic+UG">UG</a></code>), &quot;UNP&quot; (univariate nonparametric, see <code><a href="#topic+UNP">UNP</a></code>)
</p>
</li>
<li><p> Multivariate scan procedures: &quot;MG&quot; (multivariate gaussian, see <code><a href="#topic+MG">MG</a></code>), &quot;MNP&quot; (multivariate nonparametric, see <code><a href="#topic+MNP">MNP</a></code>)
</p>
</li>
<li><p> Univariate functional scan procedures: &quot;NPFSS&quot; (nonparametric functional scan statistic, see <code><a href="#topic+NPFSS">NPFSS</a></code>), &quot;PFSS&quot; (parametric functional scan statistic, see <code><a href="#topic+PFSS">PFSS</a></code>), &quot;DFFSS&quot; (distribution-free functional scan statistic, see <code><a href="#topic+DFFSS">DFFSS</a></code>), &quot;URBFSS&quot; (univariate rank-based functional scan statistic, see <code><a href="#topic+URBFSS">URBFSS</a></code>)
</p>
</li>
<li><p> Multivariate functional scan procedures: &quot;NPFSS&quot; (nonparametric functional scan statistic, see <code><a href="#topic+NPFSS">NPFSS</a></code>), &quot;MDFFSS&quot; (multivariate distribution-free functional scan statistic, see <code><a href="#topic+MDFFSS">MDFFSS</a></code>), &quot;MRBFSS&quot; (multivariate rank-based functional scan statistic, see <code><a href="#topic+MRBFSS">MRBFSS</a></code>), &quot;MPFSS&quot;, &quot;MPFSS-LH&quot;, &quot;MPFSS-W&quot;, &quot;MPFSS-P&quot; and &quot;MPFSS-R&quot; (parametric multivariate functional scan statistic ; &quot;LH&quot;, &quot;W&quot;, &quot;P&quot;, &quot;R&quot; correspond respectively to the Lawley-Hotelling trace test statistic, The Wilks lambda test statistic, the Pillai trace test statistic and the Roy's maximum root test statistic, see <code><a href="#topic+MPFSS">MPFSS</a></code>). Note that &quot;MPFSS&quot; computes &quot;MPFSS-LH&quot;, &quot;MPFSS-W&quot;, &quot;MPFSS-P&quot; and &quot;MPFSS-R&quot;.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SpatialScan_+3A_data">data</code></td>
<td>
<p>list of numeric matrices or a matrix or a vector:
</p>

<ul>
<li><p> Univariate case: Vector of the data, each element corresponds to a site (or an individual if the observations are by individuals and not by sites).
</p>
</li>
<li><p> Multivariate case: Matrix of the data, the rows correspond to the sites (or the individuals if the observations are by individuals and not by sites) and each column represents a variable.
</p>
</li>
<li><p> Univariate functional case: Matrix of the data, the rows correspond to the sites (or to the individuals if the observations are by individuals and not by sites) and each column represents an observation time. The times must be the same for each site/individual. Depending on the scan procedure they also need to be equally-spaced.
</p>
</li>
<li><p> Multivariate functional case: List of nb_sites (or nb_individuals if the observations are by individuals and not by sites) matrices of the data, the rows correspond to the variables and each column represents an observation time. The times must be the same for each site/individual. Depending on the scan procedure they also need to be equally-spaced.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SpatialScan_+3A_sites_coord">sites_coord</code></td>
<td>
<p>numeric matrix. Coordinates of the sites (or the individuals, in that case there can be many individuals with the same coordinates).</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_system">system</code></td>
<td>
<p>character. System in which the coordinates are expressed: &quot;Euclidean&quot; or &quot;WGS84&quot;.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_mini">mini</code></td>
<td>
<p>numeric. A minimum for the clusters (see type_minimaxi). Changing the default value may bias the inference.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_maxi">maxi</code></td>
<td>
<p>numeric. A Maximum for the clusters (see type_minimaxi). Changing the default value may bias the inference.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_type_minimaxi">type_minimaxi</code></td>
<td>
<p>character. Type of minimum and maximum: by default &quot;sites/indiv&quot;: the mini and maxi are on the number of sites or individuals in the potential clusters. Other possible values are &quot;area&quot;: the minimum and maximum area of the clusters, or &quot;radius&quot;: the minimum and maximum radius.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_mini_post">mini_post</code></td>
<td>
<p>numeric. A minimum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori minimum.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_maxi_post">maxi_post</code></td>
<td>
<p>numeric. A maximum to filter the significant clusters a posteriori (see type_minimaxi_post). The default NULL is for no filtering with a a posteriori maximum.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_type_minimaxi_post">type_minimaxi_post</code></td>
<td>
<p>character. Type of minimum and maximum a posteriori: by default &quot;sites/indiv&quot;: the mini_post and maxi_post are on the number of sites or individuals in the significant clusters. Other possible values are &quot;area&quot;: the minimum and maximum area of the clusters, or &quot;radius&quot;: the minimum and maximum radius.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_sites_areas">sites_areas</code></td>
<td>
<p>numeric vector. Areas of the sites. It must contain the same number of elements than the rows of sites_coord. If the data is on individuals and not on sites, there can be duplicated values. By default: NULL</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1. Ignored for &quot;UG&quot; and &quot;UNP&quot;</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_variable_names">variable_names</code></td>
<td>
<p>character. Names of the variables. By default NULL. Ignored for the univariate and univariate functional scan procedures.</p>
</td></tr>
<tr><td><code id="SpatialScan_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL. Ignored for the univariate and multivariate scan procedures.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects of class ResScanOutput:
</p>

<ul>
<li><p> Univariate case (UG, UNP): A list of objects of class ResScanOutputUni
</p>
</li>
<li><p> Multivariate case (MG, MNP): A list of objects of class ResScanOutputMulti
</p>
</li>
<li><p> Univariate functional case (NPFSS, PFSS, DFFSS, URBFSS): A list of objects of class ResScanOutputUniFunct
</p>
</li>
<li><p> Multivariate functional case (NPFSS, MPFSS, MDFFSS, MRBFSS): A list of objects of class ResScanOutputMultiFunct
</p>
</li></ul>



<h3>References</h3>

<p>For univariate scan statistics:
</p>

<ul>
<li><p> Inkyung Jung and Ho Jin Cho (2015). A Nonparametric Spatial Scan Statistic for Continuous Data. International Journal of Health Geographics, 14.
</p>
</li>
<li><p> Martin Kulldorff and Lan Huang and Kevin Konty (2009). A Scan Statistic for Continuous Data Based on the Normal Probability Model. International Journal of Health Geographics, 8 (58).
</p>
</li></ul>

<p>For multivariate scan statistics:
</p>

<ul>
<li><p> Lionel Cucala and Michaël Genin and Florent Occelli and Julien Soula (2019). A Multivariate Nonparametric Scan Statistic for Spatial Data. Spatial statistics, 29, 1-14.
</p>
</li>
<li><p> Lionel Cucala and Michaël Genin and Caroline Lanier and Florent Occelli (2017). A Multivariate Gaussian Scan Statistic for Spatial Data. Spatial Statistics, 21, 66-74.
</p>
</li></ul>

<p>For functional scan statistics:
</p>

<ul>
<li><p> Zaineb Smida and Lionel Cucala and Ali Gannoun. A Nonparametric Spatial Scan Statistic for Functional Data. Pre-print &lt;https://hal.archives-ouvertes.fr/hal-02908496&gt;.
</p>
</li>
<li><p> Camille Frévent and Mohamed-Salem Ahmed and Matthieu Marbac and Michaël Genin. Detecting Spatial Clusters in Functional Data: New Scan Statistic Approaches. Pre-print &lt;arXiv:2011.03482&gt;.
</p>
</li>
<li><p> Camille Frévent and Mohamed-Salem Ahmed and Sophie Dabo-Niang and Michaël Genin. Investigating Spatial Scan Statistics for Multivariate Functional Data. Pre-print &lt;arXiv:2103.14401&gt;.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+ResScanOutput">ResScanOutput</a></code>, <code><a href="#topic+ResScanOutputUni">ResScanOutputUni</a></code>, <code><a href="#topic+ResScanOutputMulti">ResScanOutputMulti</a></code>, <code><a href="#topic+ResScanOutputUniFunct">ResScanOutputUniFunct</a></code> and <code><a href="#topic+ResScanOutputMultiFunct">ResScanOutputMultiFunct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Univariate scan statistics

library(sp)
data("map_sites")
data("multi_data")
uni_data &lt;- multi_data[,1]
coords &lt;- coordinates(map_sites)
res &lt;- SpatialScan(method = c("UG", "UNP"), data = uni_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)

# Multivariate scan statistics

library(sp)
data("map_sites")
data("multi_data")
coords &lt;- coordinates(map_sites)
res &lt;- SpatialScan(method = c("MG", "MNP"), data = multi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)

# Univariate functional scan statistics

library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)
res &lt;- SpatialScan(method = c("NPFSS", "PFSS", "DFFSS", "URBFSS"), data = funi_data,
sites_coord = coords, system = "WGS84", mini = 1, maxi = nrow(coords)/2)

# Multivariate functional

library(sp)
data("map_sites")
data("fmulti_data")
coords &lt;- coordinates(map_sites)
res &lt;- SpatialScan(method = c("NPFSS", "MPFSS", "MDFFSS", "MRBFSS"), data = fmulti_data,
sites_coord = coords, system = "WGS84", mini = 1, maxi = nrow(coords)/2)



</code></pre>

<hr>
<h2 id='summary.ResScanOutputMulti'>Summary of the clusters obtained with a multivariate scan function (MG or MNP).</h2><span id='topic+summary.ResScanOutputMulti'></span>

<h3>Description</h3>

<p>This function gives a summary of the clusters in a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputMulti'
summary(
  object,
  type_summ = "param",
  digits = 3,
  quantile.type = 7,
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ResScanOutputMulti_+3A_object">object</code></td>
<td>
<p>ResScanOutputMulti. Output of a multivariate scan function (MG or MNP).</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMulti_+3A_type_summ">type_summ</code></td>
<td>
<p>character. &quot;param&quot; or &quot;nparam&quot;. &quot;param&quot; gives the mean and the sd for each variable in the clusters, outside, and globally and &quot;nparam&quot; gives the Q25, Q50 and Q75 quantiles for each variables in the clusters, outside, and globally.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMulti_+3A_digits">digits</code></td>
<td>
<p>integer. Number of decimals in output.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMulti_+3A_quantile.type">quantile.type</code></td>
<td>
<p>An integer between 1 and 9 (see function quantile). Ignored if type_summ is &quot;param&quot;</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMulti_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we summarize only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMulti_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, displays the results in the console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("multi_data")
coords &lt;- coordinates(map_sites)
res_mg &lt;- SpatialScan(method = "MG", data=multi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$MG
summary(object = res_mg)



</code></pre>

<hr>
<h2 id='summary.ResScanOutputMultiFunct'>Summary of the clusters obtained with a multivariate functional scan function (MPFSS, NPFSS, MDFFSS or MRBFSS).</h2><span id='topic+summary.ResScanOutputMultiFunct'></span>

<h3>Description</h3>

<p>This function gives a summary of the clusters in a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputMultiFunct'
summary(
  object,
  type_summ = "param",
  digits = 3,
  quantile.type = 7,
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_object">object</code></td>
<td>
<p>ResScanOutputMultiFunct. Output of an multivariate functional scan function (MPFSS, NPFSS, MDFFSS or MRBFSS).</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_type_summ">type_summ</code></td>
<td>
<p>character. &quot;param&quot; or &quot;nparam&quot;. &quot;param&quot; gives the mean and the sd for each variable in the clusters, outside, and globally and &quot;nparam&quot; gives the Q25, Q50 and Q75 quantiles for each variables in the clusters, outside, and globally.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_digits">digits</code></td>
<td>
<p>integer. Number of decimals in the output.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_quantile.type">quantile.type</code></td>
<td>
<p>An integer between 1 and 9 (see function quantile). Ignored if type_summ is &quot;param&quot;</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we summarize only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputMultiFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, displays the results in the console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("fmulti_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = fmulti_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

summary(object = res_npfss, type_summ = "nparam")


</code></pre>

<hr>
<h2 id='summary.ResScanOutputUni'>Summary of the clusters obtained with a univariate scan function (UG or UNP).</h2><span id='topic+summary.ResScanOutputUni'></span>

<h3>Description</h3>

<p>This function gives a summary of the clusters in a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputUni'
summary(
  object,
  type_summ = "param",
  digits = 3,
  quantile.type = 7,
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ResScanOutputUni_+3A_object">object</code></td>
<td>
<p>ResScanOutputUni. Output of a univariate scan function (UG or UNP).</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUni_+3A_type_summ">type_summ</code></td>
<td>
<p>character. &quot;param&quot; or &quot;nparam&quot;. &quot;param&quot; gives the mean and the sd for each variable in the clusters, outside, and globally and &quot;nparam&quot; gives the Q25, Q50 and Q75 quantiles for each variables in the clusters, outside, and globally.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUni_+3A_digits">digits</code></td>
<td>
<p>integer. Number of decimals in the output.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUni_+3A_quantile.type">quantile.type</code></td>
<td>
<p>An integer between 1 and 9 (see function quantile). Ignored if type_summ is &quot;param&quot;</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUni_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we summarize only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUni_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, displays the results in the console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("multi_data")
uni_data &lt;- multi_data[,1]
coords &lt;- coordinates(map_sites)
res_unp &lt;- SpatialScan(method = "UNP", data=uni_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$UNP

summary(object = res_unp, type_summ = "nparam")


</code></pre>

<hr>
<h2 id='summary.ResScanOutputUniFunct'>Summary of the clusters obtained with a univariate functional scan function (PFSS, NPFSS, DFFSS or URBFSS).</h2><span id='topic+summary.ResScanOutputUniFunct'></span>

<h3>Description</h3>

<p>This function gives a summary of the clusters in a table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ResScanOutputUniFunct'
summary(
  object,
  type_summ = "param",
  digits = 3,
  quantile.type = 7,
  only.MLC = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_object">object</code></td>
<td>
<p>ResScanOutputUniFunct. Output of a univariate functional scan function (PFSS, NPFSS, DFFSS or URBFSS).</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_type_summ">type_summ</code></td>
<td>
<p>character. &quot;param&quot; or &quot;nparam&quot;. &quot;param&quot; gives the mean and the sd for each variable in the clusters, outside, and globally and &quot;nparam&quot; gives the Q25, Q50 and Q75 quantiles for each variables in the clusters, outside, and globally.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_digits">digits</code></td>
<td>
<p>integer. Number of decimals in the output.</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_quantile.type">quantile.type</code></td>
<td>
<p>An integer between 1 and 9 (see function quantile). Ignored if type_summ is &quot;param&quot;</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_only.mlc">only.MLC</code></td>
<td>
<p>logical. Should we summarize only the MLC or all the significant clusters?</p>
</td></tr>
<tr><td><code id="summary.ResScanOutputUniFunct_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned, displays the results in the console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(sp)
data("map_sites")
data("funi_data")
coords &lt;- coordinates(map_sites)

res_npfss &lt;- SpatialScan(method = "NPFSS", data = funi_data, sites_coord = coords,
system = "WGS84", mini = 1, maxi = nrow(coords)/2)$NPFSS

summary(object = res_npfss, type_summ = "nparam")



</code></pre>

<hr>
<h2 id='transform_data'>Computation of the multivariate functional ranks</h2><span id='topic+transform_data'></span>

<h3>Description</h3>

<p>This function computes the multivariate ranks of the data for each observation time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_data(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_data_+3A_data">data</code></td>
<td>
<p>List. List of the data, each element of the list corresponds to a site (or an individual), each row corresponds to a variable and each column represents an observation time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List
</p>

<hr>
<h2 id='UG'>UG scan procedure</h2><span id='topic+UG'></span>

<h3>Description</h3>

<p>This function computes the UG (Univariate Gaussian scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UG(data, MC = 999, typeI = 0.05, initialization, permutations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UG_+3A_data">data</code></td>
<td>
<p>vector. Vector of the data, each element corresponds to a site (or an individual if the observations are by individuals and not by sites).</p>
</td></tr>
<tr><td><code id="UG_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="UG_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="UG_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="UG_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUni.
</p>


<h3>References</h3>

<p>Martin Kulldorff and Lan Huang and Kevin Konty (2009). A Scan Statistic for Continuous Data Based on the Normal Probability Model. International Journal of Health Geographics, 8 (58).
</p>

<hr>
<h2 id='uni_fWMW'>Index for the NPFSS scan procedure (univariate functional case)</h2><span id='topic+uni_fWMW'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uni_fWMW(signs, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uni_fWMW_+3A_signs">signs</code></td>
<td>
<p>numeric matrix. Matrix of signs of the data, the rows correspond to the sites (or the individuals) and each column represents an observation time.</p>
</td></tr>
<tr><td><code id="uni_fWMW_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>

<hr>
<h2 id='uni_signs_matrix'>Computation of the matrix of signs</h2><span id='topic+uni_signs_matrix'></span>

<h3>Description</h3>

<p>This function returns the matrix of signs of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uni_signs_matrix(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uni_signs_matrix_+3A_data">data</code></td>
<td>
<p>numeric matrix. Matrix of the data, the rows correspond to the sites (or the individuals) and each column represents an observation time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix.
</p>

<hr>
<h2 id='UNP'>UNP scan procedure</h2><span id='topic+UNP'></span>

<h3>Description</h3>

<p>This function computes the UNP (Univariate Nonparametric scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UNP(data, MC = 999, typeI = 0.05, initialization, permutations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UNP_+3A_data">data</code></td>
<td>
<p>vector. Vector of the data, each element corresponds to a site (or an individual if the observations are by individuals and not by sites).</p>
</td></tr>
<tr><td><code id="UNP_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="UNP_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="UNP_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="UNP_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUni.
</p>


<h3>References</h3>

<p>Inkyung Jung and Ho Jin Cho (2015). A Nonparametric Spatial Scan Statistic for Continuous Data. International Journal of Health Geographics, 14.
</p>

<hr>
<h2 id='URBFSS'>URBFSS scan procedure</h2><span id='topic+URBFSS'></span>

<h3>Description</h3>

<p>This function computes the URBFSS (Univariate Rank-Based Functional scan statistic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>URBFSS(
  data,
  MC = 999,
  typeI = 0.05,
  nbCPU = 1,
  times = NULL,
  initialization,
  permutations
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="URBFSS_+3A_data">data</code></td>
<td>
<p>matrix. Matrix of the data, the rows correspond to the sites (or to the individuals if the observations are by individuals and not by sites) and each column represents an observation time. The times must be the same for each site/individual.</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_mc">MC</code></td>
<td>
<p>numeric. Number of Monte-Carlo permutations to evaluate the statistical significance of the clusters. By default: 999.</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_typei">typeI</code></td>
<td>
<p>numeric. The desired type I error. A cluster will be evaluated as significant if its associated p-value is less than typeI. By default 0.05.</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_nbcpu">nbCPU</code></td>
<td>
<p>numeric. Number of CPU. If nbCPU &gt; 1 parallelization is done. By default: 1.</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_times">times</code></td>
<td>
<p>numeric. Times of observation of the data. By default NULL.</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_initialization">initialization</code></td>
<td>
<p>list. Initialization for the scan procedure (see <code><a href="#topic+InitScan">InitScan</a></code> for more details).</p>
</td></tr>
<tr><td><code id="URBFSS_+3A_permutations">permutations</code></td>
<td>
<p>matrix. Indices of permutations of the data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class ResScanOutputUniFunct.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MRBFSS">MRBFSS</a></code> which is the multivariate version of the URBFSS
</p>

<hr>
<h2 id='wmw_uni'>Index for the UNP scan procedure</h2><span id='topic+wmw_uni'></span>

<h3>Description</h3>

<p>This function returns the index we want to maximize on the set of potential clusters, for each potential cluster, and each permutation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wmw_uni(rank_data, matrix_clusters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wmw_uni_+3A_rank_data">rank_data</code></td>
<td>
<p>matrix. Matrix of the ranks of the data for all permutations. Each column corresponds to a permutation and each row corresponds to a site or an individual.</p>
</td></tr>
<tr><td><code id="wmw_uni_+3A_matrix_clusters">matrix_clusters</code></td>
<td>
<p>numeric matrix. Matrix in which each column represents a potential cluster. It is the result of the &quot;clusters&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
