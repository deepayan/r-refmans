<!DOCTYPE html><html><head><title>Help for package corTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {corTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#construct_network'>
<p>Construct Differential Correlation Network</p></a></li>
<li><a href='#es'>
<p>A BioConductor ExpressionSet Object Storing Gene Expression Data</p></a></li>
<li><a href='#fisher_transfer_test'>
<p>Test for equal correlation</p></a></li>
<li><a href='#generate_data'>
<p>Generate Data for Control Subjects and Case Subjects</p></a></li>
<li><a href='#genEset'>
<p>Generate an ExpressionSet Object</p></a></li>
<li><a href='#ghdist'>
<p>generating varibles from g-and-h distribution</p></a></li>
<li><a href='#plotDiffCor'>
<p>Scatter Plot of 2 Genes for Cases and Controls</p></a></li>
<li><a href='#st1'>
<p>Test Differential Correlation Using st1 Method</p></a></li>
<li><a href='#st2'>
<p>Test Differential Correlation Using st2 Method</p></a></li>
<li><a href='#st3'>
<p>Test Differential Correlation Using st3 Method</p></a></li>
<li><a href='#st4'>
<p>Test Differential Correlation Using st4 Method</p></a></li>
<li><a href='#st5'>
<p>Test Differential Correlation Using st5 Method</p></a></li>
<li><a href='#st6'>
<p>Test Differential Correlation Using st6 Method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Tests for Equal Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Author:</td>
<td>Danyang Yu, Weiliang Qiu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Danyang Yu &lt;dyu33@jhu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>There are 6 novel robust tests for equal correlation. They are all based on logistic regressions. The score statistic U is proportion to difference of two correlations based on different types of correlation in  6 methods. The ST1() is based on Pearson correlation. ST2() improved ST1() by using median absolute deviation. ST3() utilized type M correlation and ST4() used Spearman correlation.  ST5() and ST6() used two different ways to combine ST3() and ST4().  We highly recommend ST5() according to the article titled &rdquo;New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs&rdquo; published in Scientific Reports.  Please see the reference: Yu et al. (2019) &lt;<a href="https://doi.org/10.1038%2Fs41598-019-40167-8">doi:10.1038/s41598-019-40167-8</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, graphics, stats,igraph,clusterGeneration,Matrix,Biobase,
methods, ggplot2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-06 20:26:06 UTC; kunling</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-25 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='construct_network'>
Construct Differential Correlation Network
</h2><span id='topic+construct_network'></span>

<h3>Description</h3>

<p>Construct differential correlation network with expressionSet,st5 is recommand for testing equal correlation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>construct_network(es,
                  cor_method = "st5",
                  var.grp,
                  pseudo_adjust_cutoff = FALSE,
                  pAdjMethod = 'fdr',
                  cutoff = 0.05,
                  nPseudo = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="construct_network_+3A_es">es</code></td>
<td>

<p>an ExpressionSet object of microRNA dataset
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_cor_method">cor_method</code></td>
<td>

<p>a string represents the method for equal correlation, 'st5' is recommand.
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_var.grp">var.grp</code></td>
<td>

<p>character.  phenotype variable name indicating case-control status,0 as control, 1 as case.
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_pseudo_adjust_cutoff">pseudo_adjust_cutoff</code></td>
<td>

<p>if the value is TRUE, pseudo probes will be used for setting the cutoff of p-value for differential corrlation test. Otherwise, adjusted p-value will be compared with <code>cutoff</code>.
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_padjmethod">pAdjMethod</code></td>
<td>

<p>if <code>pAdjMethod='none'</code>, the function will not do mutiple testing adjustment. If pAdjMethod=&quot;fdr&quot;/&quot;BH&quot;/&quot;BY&quot;/&quot;holm&quot;/&quot;hochberg&quot;/&quot;hommel&quot;/&quot;bonferroni&quot;/&quot;BH&quot;/&quot;BY&quot;, the specific method will be used for adjusting p-value. <code>pAdjMethod</code> will only be used when <code>pseudo_adjust_cutoff=FALSE</code>
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_cutoff">cutoff</code></td>
<td>

<p>if p value is smaller than the cutoff, there will be an edge between the two nodes. <code>cutoff</code> will only be used when <code>pseudo_adjust_cutoff=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="construct_network_+3A_npseudo">nPseudo</code></td>
<td>

<p>if <code>pseudo_adjust_cutoff=TRUE</code>, then <code>nPseudo</code> genes will be randomly chosen to produce pseudo genes (i.e., non-differentially correlated with other genes between cases and controls). We will use the minimum of the p-values of these pseudo genes as the cutoff of p-values for differential correlation analysis.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 6 elements:
</p>
<table>
<tr><td><code>my_graph</code></td>
<td>

<p>obtained network as igraph object
</p>
</td></tr>
<tr><td><code>my_dat</code></td>
<td>

<p>obtained netork as data frame with 3 columns: edge id, node_id1,node_id2
</p>
</td></tr>
<tr><td><code>pvalMat</code></td>
<td>

<p>raw p-values for testing differential correlation for each pair of genes
</p>
</td></tr>
<tr><td><code>pAdjMat</code></td>
<td>

<p>adjusted p-values for testing differential correlation for each pair of genes
</p>
</td></tr>
<tr><td><code>pvalPseudo</code></td>
<td>

<p>p-values for testing differential correlation between pseudo genes and other genes
</p>
</td></tr>
<tr><td><code>alpha1</code></td>
<td>

<p>cutoff for p-values for testing differential correlation
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234567)
res = generate_data(n1 = 50, n2 = 60, p1 = 5, p2 = 50)
es = res$es
print(es)

covCtrl = res$covCtrl
covCase = res$covCase

# we expect cov for 1st 5 genes are different between cases and controls
print(round(covCtrl[1:5, 1:5], 2))
print(round(covCase[1:5, 1:5], 2))

# we expect cov for other genes are same between cases and controls
print(round(covCtrl[6:10, 6:10], 2))
print(round(covCase[6:10, 6:10], 2))

res2 = construct_network(es = es,
                  cor_method = "st5",
                  pseudo_adjust_cutoff = FALSE,
                  var.grp = "grp",
                  pAdjMethod = 'fdr',
                  cutoff = 0.05,
                  nPseudo = 25)

print(res2$graph)
print(res2$network_dat)

</code></pre>

<hr>
<h2 id='es'>
A BioConductor ExpressionSet Object Storing Gene Expression Data
</h2><span id='topic+es'></span>

<h3>Description</h3>

<p>A BioConductor ExpressionSet object storing gene expression data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("es")</code></pre>


<h3>Format</h3>

<p>The expression data are stored in a matrix, which contains
55 row genes and 110 column subjects.
</p>
<p>The phenotye data contains two variables: <code>sid</code> (subject ID)
and <code>grp</code> (case-control status). <code>grp=1</code> indicates the subject
is a case. <code>grp=0</code> indicates the subject is a control.
</p>
<p>The feature data contains two variables: <code>geneid</code> (gene ID) and <code>memGenes</code>. <code>memGenes=1</code> indicates the gene is differentially correlated between cases and controls with
at least one other gene. <code>memGenes=0</code> indicates the gene is not diffferentially correlated with other genes.
</p>


<h3>Details</h3>

<p>The data contains 50 cases and 60 controls. The first 5 genes are differentially correlated with at least one other genes, while the remaining 50 genes are non-differentially correlated with other genes.
</p>
<p>The covariance matrix of the first 5 genes in cases were generated by the function <code>rcorrmatrix</code> in R package <code>clusterGeneration</code>. The covariance matrix of the first 5 genes in controls are identical matrix.
</p>
<p>The covariance matrix of the remaining 50 genes in cases
were generated by the function <code>rcorrmatrix</code>. The covariance matrix of the 50 genes in controls were the same as that in cases.
</p>
<p>The first 50 subjects are cases. The remaining 60 subjects are controls.
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(es)

print(es)

</code></pre>

<hr>
<h2 id='fisher_transfer_test'>
Test for equal correlation
</h2><span id='topic+fisher_transfer_test'></span>

<h3>Description</h3>

<p>Compute p-value with Fisher’s Z-transformation test. If biasCorrection is true, the corrected correlation is used. The formula is rho.corrected = rho - rho/(2*(n-1)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher_transfer_test(x1, z1, x0, z0, biasCorrection = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fisher_transfer_test_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="fisher_transfer_test_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="fisher_transfer_test_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="fisher_transfer_test_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
<tr><td><code id="fisher_transfer_test_+3A_biascorrection">biasCorrection</code></td>
<td>

<p>a boolean value
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value of test for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = fisher_transfer_test(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='generate_data'>
Generate Data for Control Subjects and Case Subjects
</h2><span id='topic+generate_data'></span>

<h3>Description</h3>

<p>The function is to generate expression level matrixes of control subjects and case subjects. X matrix is for control subjects with the default sample size n1=50. Z matrix is for case subjects with the default sample size n2=60.
X is generated from multivariate normal distribution N (0, SigmaX), where SigmaX is a block matrix ((SigmaP1, 0), (0, SigmaP2)), sigmaP1 is the p1*p1 matrix and SigmaP2 is the p2*p2 matrix. Z is generated from multivariate normal distribution N (0, SigmaZ), where SigmaZ is a block matrix ((E_P1, 0), (0, SigmaP2)) and E_P1 is p1*p1 identity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_data(n1, n2, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_data_+3A_n1">n1</code></td>
<td>

<p>a numeric value representing the sample size of control subjects
</p>
</td></tr>
<tr><td><code id="generate_data_+3A_n2">n2</code></td>
<td>

<p>a numeric value representing the sample size of case subjects
</p>
</td></tr>
<tr><td><code id="generate_data_+3A_p1">p1</code></td>
<td>

<p>a numeric value representing the dimension of sigma_1
</p>
</td></tr>
<tr><td><code id="generate_data_+3A_p2">p2</code></td>
<td>

<p>a numeric value representing the dimension of sigma_0
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 3 elements:
</p>
<table>
<tr><td><code>es</code></td>
<td>
<p>An ExpressionSet object contains gene expression data.</p>
</td></tr>
<tr><td><code>covCase</code></td>
<td>

<p>Covariance matrix of all genes for case subjects.
</p>
</td></tr>
<tr><td><code>covCtrl</code></td>
<td>

<p>Covariance matrix of all genes for control subjects.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Biobase)
set.seed(1234567)
res = generate_data(n1 = 50, n2 = 60, p1 = 5, p2 = 50)
es = res$es
print(es)


# gene expression data
dat = exprs(es)
print(dim(dat))
print(dat[1:2,1:3])

# phenotype data
pDat = pData(es)
print(dim(pDat))
print(pDat[1:2,])
print(table(pDat$grp, useNA = "ifany"))

# feature data
fDat = fData(es)
print(dim(fDat))
print(fDat[1:2,])
print(table(fDat$memGenes, useNA = "ifany"))

covCtrl = res$covCtrl
covCase = res$covCase

# we expect cov for 1st 5 genes are different between cases and controls
print(round(covCtrl[1:5, 1:5], 2))
print(round(covCase[1:5, 1:5], 2))

# we expect cov for other genes are same between cases and controls
print(round(covCtrl[6:10, 6:10], 2))
print(round(covCase[6:10, 6:10], 2))

</code></pre>

<hr>
<h2 id='genEset'>
Generate an ExpressionSet Object
</h2><span id='topic+genEset'></span>

<h3>Description</h3>

<p>Generate an ExpressionSet object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genEset(ex, pDat, fDat = NULL, annotation = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genEset_+3A_ex">ex</code></td>
<td>

<p>a data matrix stores gene expression data. Rows are genes and columns are subjects.
</p>
</td></tr>
<tr><td><code id="genEset_+3A_pdat">pDat</code></td>
<td>

<p>a data frame stores phenotype data. Rows are subjects and columns are variables describing subjects. Row names of <code>pDat</code> must be idential to the column names of <code>ex</code>.
</p>
</td></tr>
<tr><td><code id="genEset_+3A_fdat">fDat</code></td>
<td>

<p>a data frame stores feature data. Rows are genes and columns are variables describing genes. Row names of <code>fDat</code> must be idential to the row names of <code>ex</code>.
</p>
</td></tr>
<tr><td><code id="genEset_+3A_annotation">annotation</code></td>
<td>

<p>character. indicates R Bioconductor annotation package that provides annotation for genes.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A BioConductor ExpressionSet object.
</p>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>

<hr>
<h2 id='ghdist'>
generating varibles from g-and-h distribution
</h2><span id='topic+ghdist'></span>

<h3>Description</h3>

<p>generating varibles from g-and-h distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ghdist(n, g = 0,h = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ghdist_+3A_n">n</code></td>
<td>

<p>the number of the varibles you want to generate
</p>
</td></tr>
<tr><td><code id="ghdist_+3A_g">g</code></td>
<td>

<p>the parameter g of g-and-h distribution
</p>
</td></tr>
<tr><td><code id="ghdist_+3A_h">h</code></td>
<td>

<p>the parameter h of g-and-h distribution
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n varibles generated from g-and-h distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = ghdist(50, 0.2, 0.2)
print(x)
</code></pre>

<hr>
<h2 id='plotDiffCor'>
Scatter Plot of 2 Genes for Cases and Controls
</h2><span id='topic+plotDiffCor'></span>

<h3>Description</h3>

<p>Scatter plot of 2 genes for cases and controls, superimposed with linear regression lines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDiffCor(x1, 
	    z1, 
	    x0, 
	    z0, 
	    pval = NULL, 
	    xlab = "gene1", 
	    ylab = "gene2", 
	    title = "scatter plots") 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDiffCor_+3A_x1">x1</code></td>
<td>

<p>numeric. vector of gene expression for gene 1 for cases.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_z1">z1</code></td>
<td>

<p>numeric. vector of gene expression for gene 2 for cases.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_x0">x0</code></td>
<td>

<p>numeric. vector of gene expression for gene 1 for controls.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_z0">z0</code></td>
<td>

<p>numeric. vector of gene expression for gene 2 for controls.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_pval">pval</code></td>
<td>

<p>numeric. p-value for testing differential correlation of the 2 genes between cases and controls.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_xlab">xlab</code></td>
<td>

<p>character. label for x-axis.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_ylab">ylab</code></td>
<td>

<p>character. label for y-axis.
</p>
</td></tr>
<tr><td><code id="plotDiffCor_+3A_title">title</code></td>
<td>

<p>character. plot title.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 4 elments:
</p>
<table>
<tr><td><code>g</code></td>
<td>

<p>A ggplot2 object.
</p>
</td></tr>
<tr><td><code>dat</code></td>
<td>

<p>a data frame with 3 variables: x, z, and grp.
</p>
</td></tr>
<tr><td><code>coef1</code></td>
<td>

<p>a vector of length two giving the intercept and slope of linear regression for cases.
</p>
</td></tr>
<tr><td><code>coef0</code></td>
<td>

<p>a vector of length two giving the intercept and slope of linear regression for controls.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Biobase)
set.seed(1234567)
res = generate_data(n1 = 50, n2 = 60, p1 = 5, p2 = 50)
es = res$es
print(es)


# gene expression data
dat = exprs(es)
print(dim(dat))
print(dat[1:2,1:3])

# 3rd gene
x = dat[3,]
# 5th gene
z = dat[5,]

# for cases
x1 = x[which(es$grp == 1)]
z1 = z[which(es$grp == 1)]

# for controls
x0 = x[which(es$grp == 0)]
z0 = z[which(es$grp == 0)]

# st5
res2 = st5(x1 = x1, z1 = z1, x0 = x0, z0 = z0)
pval = res2$pval

plotDiffCor(x1 = x1, 
	    z1 = z1, 
	    x0 = x0, 
	    z0 = z0, 
	    pval = pval, 
	    xlab = "gene3", 
	    ylab = "gene5", 
	    title = "scatter plots" 
	    )


</code></pre>

<hr>
<h2 id='st1'>
Test Differential Correlation Using st1 Method
</h2><span id='topic+st1'></span>

<h3>Description</h3>

<p>Compute p-value for the  equal correlation test with Pearson correlation based on a logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st1(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st1_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st1_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st1_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st1_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>

<p>Test statistic for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>

<p>p-value of test
</p>
</td></tr>
<tr><td><code>signedStat</code></td>
<td>

<p>Signed test statistic
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = st1(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='st2'>
Test Differential Correlation Using st2 Method
</h2><span id='topic+st2'></span>

<h3>Description</h3>

<p>Compute p-value for the equal correlation test with mad-replacing-Pearson correlation based on a logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st2(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st2_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st2_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st2_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st2_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>

<p>Test statistic for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>

<p>p-value of test
</p>
</td></tr>
<tr><td><code>signedStat</code></td>
<td>

<p>Signed test statistic
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = st2(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='st3'>
Test Differential Correlation Using st3 Method
</h2><span id='topic+st3'></span>

<h3>Description</h3>

<p>Compute p-value for the equal correlation test with percentage bend correlation based on a logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st3(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st3_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st3_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st3_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st3_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>

<p>Test statistic for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>

<p>p-value of test
</p>
</td></tr>
<tr><td><code>signedStat</code></td>
<td>

<p>Signed test statistic
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = st3(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='st4'>
Test Differential Correlation Using st4 Method
</h2><span id='topic+st4'></span>

<h3>Description</h3>

<p>Compute p-value for the  equal correlation test with Spearman corrleaion  based on a logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st4(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st4_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st4_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st4_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st4_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>

<p>Test statistic for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>

<p>p-value of test
</p>
</td></tr>
<tr><td><code>signedStat</code></td>
<td>

<p>Signed test statistic
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = st4(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='st5'>
Test Differential Correlation Using st5 Method
</h2><span id='topic+st5'></span>

<h3>Description</h3>

<p>#  Compute p-value for the  equal correlation test with combination of Spearman corrleaion and percentage bend correlation based on a logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st5(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st5_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st5_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st5_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st5_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>stat</code></td>
<td>

<p>Test statistic for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code>
</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>

<p>p-value of test
</p>
</td></tr>
<tr><td><code>signedStat</code></td>
<td>

<p>Signed test statistic
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
p = st5(x1, z1, x0, z0)
print(p)
</code></pre>

<hr>
<h2 id='st6'>
Test Differential Correlation Using st6 Method
</h2><span id='topic+st6'></span>

<h3>Description</h3>

<p>Compute p-value for the  equal correlation test with another way to combine Spearman corrleaion and percentage bend correlation based on a multiple logistic regression model corresponding to two independent groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st6(x1, z1, x0, z0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st6_+3A_x1">x1</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st6_+3A_z1">z1</code></td>
<td>

<p>a numeric vector with same length as <code>x1</code>
</p>
</td></tr>
<tr><td><code id="st6_+3A_x0">x0</code></td>
<td>

<p>a numeric vector
</p>
</td></tr>
<tr><td><code id="st6_+3A_z0">z0</code></td>
<td>

<p>a numeric vector with same length as <code>x0</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 3 elements:
</p>
<table>
<tr><td><code>u</code></td>
<td>
<p>the vector of Fisher score.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>

<p>p-value of test for testing if correlation between <code>x1</code> and <code>z1</code> is the same as that between <code>x0</code> and <code>z0</code></p>
</td></tr>
<tr><td><code>cov_u</code></td>
<td>
<p>covariance matrix for <code>u</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Danyang Yu &lt;dyu33@jhu.edu&gt;,
Weiliang Qiu &lt;weiliang.qiu@gmail.com&gt;
</p>


<h3>References</h3>

<p>Danyang Yu, Zeyu Zhang, Kimberly Glass, Jessica Su, Dawn L. DeMeo, Kelan Tantisira, Scott T. Weiss, Weiliang Qiu(corresponding author). New Statistical Methods for Constructing Robust Differential Correlation Networks to characterize the interactions among microRNAs. Scientific Reports 9, Article number: 3499 (2019)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 = ghdist(n = 100, g = 0.2, h = 0.2)
x0 = ghdist(n = 100, g = 0.2, h = 0.2)
z1 = x1 + ghdist(n = 100, g = 0.2, h = 0.2)
z0 = x0 + ghdist(n = 100, g = 0.2, h = 0.2)
res = st6(x1, z1, x0, z0)
print(res)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
