<!DOCTYPE html><html lang="en"><head><title>Help for package investr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {investr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arsenic'><p>Concentrations of arsenic in water samples</p></a></li>
<li><a href='#beetle'><p>Dobson's Beetle Data</p></a></li>
<li><a href='#bladder'><p>Bladder volume data</p></a></li>
<li><a href='#calibrate'><p>Calibration for the simple linear regression model</p></a></li>
<li><a href='#crystal'><p>Crystal weight data</p></a></li>
<li><a href='#invest'><p>Inverse estimation for linear, nonlinear, and generalized linear models</p></a></li>
<li><a href='#investr'><p>investr: a package for inverse estimation in R</p></a></li>
<li><a href='#nasturtium'><p>Bioassay on Nasturtium</p></a></li>
<li><a href='#plot.bootCal'><p>Plots method for bootstrap calibration</p></a></li>
<li><a href='#plotFit'><p>Plotting fitted models</p></a></li>
<li><a href='#predFit'><p>Predictions from a Fitted Model</p></a></li>
<li><a href='#whisky'><p>Whisky data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inverse Estimation/Calibration Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Brandon M. Greenwell</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Brandon M. Greenwell &lt;greenwell.brandon@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to facilitate inverse estimation (e.g., calibration) in
    linear, generalized linear, nonlinear, and (linear) mixed-effects models. A
    generic function is also provided for plotting fitted regression models with
    or without confidence/prediction bands that may be of use to the general
    user. For a general overview of these methods, see Greenwell and Schubert 
    Kabban (2014) &lt;<a href="https://doi.org/10.32614%2FRJ-2014-009">doi:10.32614/RJ-2014-009</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bgreenwell/investr">https://github.com/bgreenwell/investr</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>boot, datasets, knitr, MASS, testthat</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, nlme, stats, utils</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-30 19:25:02 UTC; bgreenwell</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-31 07:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='arsenic'>Concentrations of arsenic in water samples</h2><span id='topic+arsenic'></span>

<h3>Description</h3>

<p>The data give the actual and measured concentrations of arsenic present in
water samples.
</p>


<h3>Format</h3>

<p>A data frame with 32 rows and 2 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>actual</code> True amount of arsenic present.
</p>
</li>
<li> <p><code>measured</code> Measured amount of arsenic present.
</p>
</li></ul>



<h3>Source</h3>

<p>Graybill, F. A., and Iyer, H. K. (1994)
<em>Regression analysis: Concepts and Applications</em>. Duxbury Press.
</p>

<hr>
<h2 id='beetle'>Dobson's Beetle Data</h2><span id='topic+beetle'></span>

<h3>Description</h3>

<p>The data give the number of flour beetles killed after five hour exposure
to the insecticide carbon disulphide at eight different concentrations.
</p>


<h3>Format</h3>

<p>A data frame with 8 rows and 3 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>ldose</code> Log dose of carbon disulphide.
</p>
</li>
<li> <p><code>y</code> Number of beetles subjected to insecticide.
</p>
</li>
<li> <p><code>n</code> Number of beetles killed.
</p>
</li></ul>



<h3>Source</h3>

<p>Dobson, A. (2002) <em>An Introduction to Generalized Linear Models</em>. 
Chapman &amp; Hall/CRC.
</p>

<hr>
<h2 id='bladder'>Bladder volume data</h2><span id='topic+bladder'></span>

<h3>Description</h3>

<p>A series of 23 women patients attending a urodynamic clinic were recruited 
for a study. After successful voiding of the bladder, sterile water was 
introduced in additions of 10, 15, and then 25 ml increments up to a final 
cumulative total of 175 ml. At each volume a measure of height (H) in mm and 
depth (D) in mm of largest ultrasound bladder images were taken. The product 
H × D was taken as a measure of liquid volume.
</p>


<h3>Format</h3>

<p>A data frame with 184 rows and 3 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>subject</code> The subject ID.
</p>
</li>
<li> <p><code>HD</code> The product H × D (mm^2).
</p>
</li>
<li> <p><code>volume</code> The true volume of sterile water in the bladder (ml).
</p>
</li></ul>



<h3>Source</h3>

<p>Brown, P. (1993) <em>Measurement, Regression, and Calibration</em>. 
Oxford University Press.
</p>

<hr>
<h2 id='calibrate'>Calibration for the simple linear regression model</h2><span id='topic+calibrate'></span><span id='topic+print.calibrate'></span><span id='topic+calibrate.default'></span><span id='topic+calibrate.formula'></span><span id='topic+calibrate.lm'></span>

<h3>Description</h3>

<p>The function <code>calibrate</code> computes the maximum likelihood estimate and a
condfidence interval for the unknown predictor value that corresponds to an 
observed value of the response (or vector thereof) or specified value of the 
mean response. See the reference listed below for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate(object, ...)

## Default S3 method:
calibrate(
  object,
  y0,
  interval = c("inversion", "Wald", "none"),
  level = 0.95,
  mean.response = FALSE,
  adjust = c("none", "Bonferroni", "Scheffe"),
  k,
  ...
)

## S3 method for class 'formula'
calibrate(formula, data = NULL, ..., subset, na.action = stats::na.fail)

## S3 method for class 'lm'
calibrate(
  object,
  y0,
  interval = c("inversion", "Wald", "none"),
  level = 0.95,
  mean.response = FALSE,
  adjust = c("none", "Bonferroni", "Scheffe"),
  k,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate_+3A_object">object</code></td>
<td>
<p>A matrix, list, data frame, or object that inherits from class 
<code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_...">...</code></td>
<td>
<p>Additional optional arguments. At present, no optional arguments 
are used.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_y0">y0</code></td>
<td>
<p>The value of the observed response(s) or specified value of the
mean response.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_interval">interval</code></td>
<td>
<p>The method to use for forming a confidence interval.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_level">level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for 
the interval to be calculated.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_mean.response">mean.response</code></td>
<td>
<p>Logicial indicating whether confidence intervals should 
correspond to an observed response(s) (<code>FALSE</code>) or a specified value of 
the mean response (<code>TRUE</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_adjust">adjust</code></td>
<td>
<p>A logical value indicating if an adjustment should be made to
the critical value used in constructing the confidence interval. This useful 
when the calibration curve is to be used k &gt; 0 times.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_k">k</code></td>
<td>
<p>The number of times the calibration curve is to be used for 
computing a confidence interval. Only needed when <code>adjust = TRUE</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_formula">formula</code></td>
<td>
<p>A formula of the form <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible 
by <code>as.data.frame</code> to a data frame) containing the variables in the 
model. If not found in data, the variables are taken from 
<code>environment(formula)</code>, typically the environment from which 
<code><a href="stats.html#topic+lm">lm</a></code> was called.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_subset">subset</code></td>
<td>
<p>An optional vector specifying a subset of observations to be 
used in the fitting process.</p>
</td></tr>
<tr><td><code id="calibrate_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data 
contain <code>NA</code>s.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"invest"</code> containing the following 
components:
</p>

<ul>
<li> <p><code>estimate</code> The estimate of x0.
</p>
</li>
<li> <p><code>lwr</code> The lower confidence limit for x0.
</p>
</li>
<li> <p><code>upr</code> The upper confidence limit for x0.
</p>
</li>
<li> <p><code>se</code> An estimate of the standard error (Wald interval only).
</p>
</li>
<li> <p><code>interval</code> The method used for calculating <code>lower</code> and 
<code>upper</code> (only used by <code>print</code> method).
</p>
</li></ul>



<h3>Note</h3>

<p>The <code><a href="#topic+invest">invest</a></code> function is more general, but is based on 
numerical techniques to find the solution. When the underlying model is that 
of the simple linear regression model with normal errors, closed-form 
expressions exist which are utilized by the <code>calibrate</code> function.
</p>


<h3>References</h3>

<p>Graybill, F. A., and Iyer, H. K. (1994)
<em>Regression analysis: Concepts and Applications</em>. Duxbury Press.
</p>
<p>Miller, R. G. (1981)
<em>Simultaneous Statistical Inference</em>. Springer-Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Arsenic example (simple linear regression with replication)
#

# Inverting a prediction interval for an individual response
arsenic.lm &lt;- stats::lm(measured ~ actual, data = arsenic)
plotFit(arsenic.lm, interval = "prediction", shade = TRUE, 
        col.pred = "lightblue")
(cal &lt;- calibrate(arsenic.lm, y0 = 3, interval = "inversion"))
abline(h = 3)
segments(cal$estimate, 3, cal$estimate, par()$usr[3])
arrows(cal$lower, 3, cal$lower, par()$usr[3])
arrows(cal$upper, 3, cal$upper, par()$usr[3])

#
# Crystal weight example (simple linear regression)
#

# Inverting a confidence interval for the mean response
crystal.lm &lt;- stats::lm(weight ~ time, data = crystal)
plotFit(crystal.lm, interval = "confidence", shade = TRUE,
        col.conf = "lightblue")
(cal &lt;- calibrate(crystal.lm, y0 = 8, interval = "inversion", 
                  mean.response = TRUE))
abline(h = 8)
segments(cal$estimate, 8, cal$estimate, par()$usr[3])
arrows(cal$lower, 8, cal$lower, par()$usr[3])
arrows(cal$upper, 8, cal$upper, par()$usr[3])

# Wald interval and approximate standard error based on the delta method
calibrate(crystal.lm, y0 = 8, interval = "Wald", mean.response = TRUE)
</code></pre>

<hr>
<h2 id='crystal'>Crystal weight data</h2><span id='topic+crystal'></span>

<h3>Description</h3>

<p>The data give the growing time and final weight of crystals.
</p>


<h3>Format</h3>

<p>A data frame with 14 rows and 2 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>time</code> Time taken to grow (hours).
</p>
</li>
<li> <p><code>weight</code> Final weight of the crystal (grams).
</p>
</li></ul>



<h3>Source</h3>

<p>Graybill, F. A., and Iyer, H. K. (1994)
<em>Regression analysis: Concepts and Applications</em>. Duxbury Press.
</p>

<hr>
<h2 id='invest'>Inverse estimation for linear, nonlinear, and generalized linear models</h2><span id='topic+invest'></span><span id='topic+invest.lm'></span><span id='topic+invest.glm'></span><span id='topic+invest.nls'></span><span id='topic+invest.lme'></span>

<h3>Description</h3>

<p>Provides point and interval estimates for the unknown predictor value that 
corresponds to an observed value of the response (or vector thereof) or 
specified value of the mean response. See the references listed below for 
more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invest(object, y0, ...)

## S3 method for class 'lm'
invest(
  object,
  y0,
  interval = c("inversion", "Wald", "percentile", "none"),
  level = 0.95,
  mean.response = FALSE,
  x0.name,
  newdata,
  data,
  boot.type = c("parametric", "nonparametric"),
  nsim = 999,
  seed = NULL,
  progress = FALSE,
  lower,
  upper,
  extendInt = "no",
  tol = .Machine$double.eps^0.25,
  maxiter = 1000,
  adjust = c("none", "Bonferroni"),
  k,
  ...
)

## S3 method for class 'glm'
invest(
  object,
  y0,
  interval = c("inversion", "Wald", "percentile", "none"),
  level = 0.95,
  lower,
  upper,
  x0.name,
  newdata,
  data,
  extendInt = "no",
  tol = .Machine$double.eps^0.25,
  maxiter = 1000,
  ...
)

## S3 method for class 'nls'
invest(
  object,
  y0,
  interval = c("inversion", "Wald", "percentile", "none"),
  level = 0.95,
  mean.response = FALSE,
  data,
  boot.type = c("parametric", "nonparametric"),
  nsim = 1,
  seed = NULL,
  progress = FALSE,
  lower,
  upper,
  extendInt = "no",
  tol = .Machine$double.eps^0.25,
  maxiter = 1000,
  adjust = c("none", "Bonferroni"),
  k,
  ...
)

## S3 method for class 'lme'
invest(
  object,
  y0,
  interval = c("inversion", "Wald", "percentile", "none"),
  level = 0.95,
  mean.response = FALSE,
  data,
  lower,
  upper,
  q1,
  q2,
  extendInt = "no",
  tol = .Machine$double.eps^0.25,
  maxiter = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invest_+3A_object">object</code></td>
<td>
<p>An object that inherits from class <code><a href="stats.html#topic+lm">lm</a></code>, 
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+nls">nls</a></code>, or 
<code><a href="nlme.html#topic+lme">lme</a></code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_y0">y0</code></td>
<td>
<p>The value of the observed response(s) or specified value of the 
mean response. For <code><a href="stats.html#topic+glm">glm</a></code> objects, <code>y0</code> should be on 
the scale of the response variable (e.g., a number between 0 and 1 for 
binomial families).</p>
</td></tr>
<tr><td><code id="invest_+3A_...">...</code></td>
<td>
<p>Additional optional arguments. At present, no optional arguments 
are used.</p>
</td></tr>
<tr><td><code id="invest_+3A_interval">interval</code></td>
<td>
<p>The type of interval required.</p>
</td></tr>
<tr><td><code id="invest_+3A_level">level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level 
for the interval to be calculated.</p>
</td></tr>
<tr><td><code id="invest_+3A_mean.response">mean.response</code></td>
<td>
<p>Logical indicating whether confidence intervals should
correspond to an individual response (<code>FALSE</code>) or a mean response 
(<code>TRUE</code>). For <code><a href="stats.html#topic+glm">glm</a></code> objects, this is always 
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_x0.name">x0.name</code></td>
<td>
<p>For multiple linear regression, a character string giving the
name of the predictor variable of interest.</p>
</td></tr>
<tr><td><code id="invest_+3A_newdata">newdata</code></td>
<td>
<p>For multiple linear regression, a <code>data.frame</code> giving the
values of interest for all other predictor variables (i.e., those other than 
<code>x0.name</code>).</p>
</td></tr>
<tr><td><code id="invest_+3A_data">data</code></td>
<td>
<p>An optional data frame. This is required if <code>object$data</code> is 
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_boot.type">boot.type</code></td>
<td>
<p>Character string specifying the type of bootstrap to use 
when <code>interval = "percentile"</code>. Options are <code>"parametric"</code> and 
<code>"nonparametric"</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_nsim">nsim</code></td>
<td>
<p>Positive integer specifying the number of bootstrap simulations; 
the bootstrap B (or R).</p>
</td></tr>
<tr><td><code id="invest_+3A_seed">seed</code></td>
<td>
<p>Optional argument to <code><a href="base.html#topic+set.seed">set.seed</a></code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_progress">progress</code></td>
<td>
<p>Logical indicating whether to display a text-based progress
bar during the bootstrap simulation.</p>
</td></tr>
<tr><td><code id="invest_+3A_lower">lower</code></td>
<td>
<p>The lower endpoint of the interval to be searched.</p>
</td></tr>
<tr><td><code id="invest_+3A_upper">upper</code></td>
<td>
<p>The upper endpoint of the interval to be searched.</p>
</td></tr>
<tr><td><code id="invest_+3A_extendint">extendInt</code></td>
<td>
<p>Character string specifying if the interval 
<code>c(lower, upper)</code> should be extended or directly produce an error when
the inverse of the prediction function does not have differing signs at the
endpoints. The default, <code>"no"</code>, keeps the search interval and hence 
produces an error. Can be abbreviated. See the documentation for the 
<code>base</code> R function <code>uniroot</code> for details.</p>
</td></tr>
<tr><td><code id="invest_+3A_tol">tol</code></td>
<td>
<p>The desired accuracy passed on to <code><a href="stats.html#topic+uniroot">uniroot</a></code>. 
Recommend a minimum of <code>1e-10</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations passed on to <code>uniroot</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_adjust">adjust</code></td>
<td>
<p>A logical value indicating if an adjustment should be made to
the critical value used in calculating the confidence interval.This is useful 
for when the calibration curve is to be used multiple, say <code>k</code>, times.</p>
</td></tr>
<tr><td><code id="invest_+3A_k">k</code></td>
<td>
<p>The number times the calibration curve is to be used for computing 
a confidence interval. Only needed when <code>adjust = "Bonferroni"</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_q1">q1</code></td>
<td>
<p>Optional lower cutoff to be used in forming confidence intervals. 
Only used when <code>object</code> inherits from class <code><a href="nlme.html#topic+lme">lme</a></code>. 
Defaults to <code>stats::qnorm((1+level)/2)</code>.</p>
</td></tr>
<tr><td><code id="invest_+3A_q2">q2</code></td>
<td>
<p>Optional upper cutoff to be used in forming confidence intervals. 
Only used when <code>object</code> inherits from class <code><a href="nlme.html#topic+lme">lme</a></code>. 
Defaults to <code>stats::qnorm((1-level)/2)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"invest"</code> or, if
<code>interval = "percentile"</code>, of class <code>c("invest", "bootCal")</code>. The 
generic function <code>{plot}</code> can be used to plot the output 
of the bootstrap simulation when <code>interval = "percentile"</code>.
</p>
<p>An object of class <code>"invest"</code> containing the following components:
</p>

<ul>
<li> <p><code>estimate</code> The estimate of x0.
</p>
</li>
<li> <p><code>lwr</code> The lower confidence limit for x0.
</p>
</li>
<li> <p><code>upr</code> The upper confidence limit for x0.
</p>
</li>
<li> <p><code>se</code> An estimate of the standard error (Wald and percentile 
intervals only).
</p>
</li>
<li> <p><code>bias</code> The bootstrap estimate of bias (percentile interval 
only).
</p>
</li>
<li> <p><code>bootreps</code> Vector of bootstrap replicates (percentile 
interval only).
</p>
</li>
<li> <p><code>nsim</code> The number of bootstrap replicates (percentile 
interval only).
</p>
</li>
<li> <p><code>interval</code> The method used for calculating <code>lower</code> and 
<code>upper</code> (only used by <code>{print}</code> method).
</p>
</li></ul>



<h3>References</h3>

<p>Greenwell, B. M. (2014). <em>Topics in Statistical Calibration</em>. 
Ph.D. thesis, Air Force Institute of Technology. 
URL <a href="https://apps.dtic.mil/sti/pdfs/ADA598921.pdf">https://apps.dtic.mil/sti/pdfs/ADA598921.pdf</a>
</p>
<p>Greenwell, B. M., and Schubert Kabban, C. M. (2014). investr: An R Package 
for Inverse Estimation. <em>The R Journal</em>, <b>6</b>(1), 90&ndash;100. 
URL http://journal.r-project.org/archive/2014-1/greenwell-kabban.pdf.
</p>
<p>Graybill, F. A., and Iyer, H. K. (1994).
<em>Regression analysis: Concepts and Applications</em>. Duxbury Press. 
</p>
<p>Huet, S., Bouvier, A., Poursat, M-A., and Jolivet, E.  (2004)
<em>Statistical Tools for Nonlinear Regression: A Practical Guide with 
S-PLUS and R Examples</em>. Springer. 
</p>
<p>Norman, D. R., and Smith H. (2014).
<em>Applied Regression Analysis</em>. John Wiley &amp; Sons.
</p>
<p>Oman, Samuel D. (1998).
Calibration with Random Slopes.
<em>Biometrics</em> <b>85</b>(2): 439&ndash;449.
doi:10.1093/biomet/85.2.439.
</p>
<p>Seber, G. A. F., and Wild, C. J. (1989)
<em>Nonlinear regression</em>. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# Dobson's beetle data (generalized linear model)
#

# Complementary log-log model
mod &lt;- glm(cbind(y, n-y) ~ ldose, data = beetle, 
           family = binomial(link = "cloglog"))
plotFit(mod, pch = 19, cex = 1.2, lwd = 2, 
        xlab = "Log dose of carbon disulphide",
        interval = "confidence", shade = TRUE, 
        col.conf = "lightskyblue")

# Approximate 95% confidence intervals and standard error for LD50
invest(mod, y0 = 0.5)
invest(mod, y0 = 0.5, interval = "Wald")

#
# Nasturtium example (nonlinear least-squares with replication)
#

# Log-logistic model
mod &lt;- nls(weight ~ theta1/(1 + exp(theta2 + theta3 * log(conc))),
           start = list(theta1 = 1000, theta2 = -1, theta3 = 1),
           data = nasturtium)
plotFit(mod, lwd.fit = 2)
           
# Compute approximate 95% calibration intervals
invest(mod, y0 = c(309, 296, 419), interval = "inversion")
invest(mod, y0 = c(309, 296, 419), interval = "Wald")  

# Bootstrap calibration intervals. In general, nsim should be as large as 
# reasonably possible (say, nsim = 9999).
boo &lt;- invest(mod, y0 = c(309, 296, 419), interval = "percentile", 
              nsim = 300, seed = 101)
boo  # print bootstrap summary
plot(boo)  # plot results

#
# Bladder volume example (random coefficient model)
#

# Load required packages
library(nlme)

# Plot data
plot(HD^(3/2) ~ volume, data = bladder, pch = 19,
       col = adjustcolor("black", alpha.f = 0.5))
       
# Fit a random intercept and slope model
bladder &lt;- na.omit(bladder)
ris &lt;- lme(HD^(3/2) ~ volume, data = bladder, random = ~volume|subject)
invest(ris, y0 = 500)
invest(ris, y0 = 500, interval = "Wald")
</code></pre>

<hr>
<h2 id='investr'>investr: a package for inverse estimation in R</h2><span id='topic+investr'></span>

<h3>Description</h3>

<p>Inverse estimation, also referred to as the calibration problem, is a 
classical and well-known problem in regression. In simple terms, it involves 
the use of an observed value of the response (or specified value of the mean 
response) to make inference on the corresponding unknown value of the 
explanatory variable.
</p>


<h3>Details</h3>

<p>A detailed <a href="https://journal.r-project.org/archive/2014/RJ-2014-009/index.html">introduction to investr</a> has been published in The R Journal: 
&quot;investr: An R Package for Inverse Estimation.&quot; You 
can track development at <a href="https://github.com/bgreenwell/investr">https://github.com/bgreenwell/investr</a>. To report 
bugs or issues, contact the main author directly or submit them to 
<a href="https://github.com/bgreenwell/investr/issues">https://github.com/bgreenwell/investr/issues</a>. 
</p>
<p>As of right now, <code>investr</code> supports (univariate) inverse estimation 
with objects of class:
</p>

<ul>
<li><p><code>lm</code> &mdash; linear models (multiple predictor variables allowed)
</p>
</li>
<li><p><code>glm</code> &mdash; generalized linear models (multiple predictor variables allowed)
</p>
</li>
<li><p><code>nls</code> &mdash; nonlinear least-squares models
</p>
</li>
<li><p><code>lme</code> &mdash; linear mixed-effects models (fit using the 
<code>nlme</code> package)
</p>
</li></ul>


<hr>
<h2 id='nasturtium'>Bioassay on Nasturtium</h2><span id='topic+nasturtium'></span>

<h3>Description</h3>

<p>The data give the actual concentrations of an agrochemical present in soil
samples versus the weight of the plant after three weeks of growth.
</p>


<h3>Format</h3>

<p>A data frame with 42 rows and 2 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>conc</code> True concentration of agrochemical (g/ha).
</p>
</li>
<li> <p><code>weight</code> Weight of plant (mg) after 3 weeks' growth.
</p>
</li></ul>



<h3>Source</h3>

<p>Racine-Poon, A. (1988) A Bayesian Approach to Nonlinear Calibration
Problems, <em>Journal of the American Statistical Association</em>, <b>83</b>,
650&ndash;656.
</p>


<h3>References</h3>

<p>Huet, S., Bouvier, A., Poursat, M-A., and Jolivet, E. (2004)
<em>Statistical Tools for Nonlinear Regression: A Practical Guide with
S-PLUS and R Examples</em>. Springer.
</p>

<hr>
<h2 id='plot.bootCal'>Plots method for bootstrap calibration</h2><span id='topic+plot.bootCal'></span>

<h3>Description</h3>

<p>The <code><a href="base.html#topic+plot">plot</a></code> method for <code>"bootCal"</code> objects. In
particular, this method takes a <code>"bootCal"</code> object and produces plots 
for the bootstrap replicates of the inverse estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootCal'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bootCal_+3A_x">x</code></td>
<td>
<p>An object that inherits from class <code>"bootCal"</code>.</p>
</td></tr>
<tr><td><code id="plot.bootCal_+3A_...">...</code></td>
<td>
<p>Additional optional arguments. At present, no optional arguments 
are used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> is returned invisibly.
</p>

<hr>
<h2 id='plotFit'>Plotting fitted models</h2><span id='topic+plotFit'></span><span id='topic+plotFit.default'></span>

<h3>Description</h3>

<p>Generic function for plotting predictions from various types of fitted 
models. <code>plotFit</code> currently supports objects of class 
<code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, and 
<code><a href="stats.html#topic+nls">nls</a></code>. A default method also exists which may be used for 
plotting the fitted mean response from other model fits (e.g., 
<code><a href="MASS.html#topic+lqs">lqs</a></code> and <code><a href="MASS.html#topic+rlm">rlm</a></code> from the <strong>MASS</strong> 
package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFit(object, ...)

## Default S3 method:
plotFit(
  object,
  type = c("response", "link"),
  interval = c("none", "both", "confidence", "prediction"),
  level = 0.95,
  data,
  adjust = c("none", "Bonferroni", "Scheffe"),
  k,
  ...,
  shade = FALSE,
  extend.range = FALSE,
  hide = TRUE,
  col.conf = if (shade) grDevices::grey(0.7) else "black",
  col.pred = if (shade) grDevices::grey(0.9) else "black",
  border.conf = col.conf,
  border.pred = col.pred,
  col.fit = "black",
  lty.conf = if (shade) 1 else 2,
  lty.pred = if (shade) 1 else 3,
  lty.fit = 1,
  lwd.conf = 1,
  lwd.pred = 1,
  lwd.fit = 1,
  n = 500,
  xlab,
  ylab,
  xlim,
  ylim
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotFit_+3A_object">object</code></td>
<td>
<p>A fitted model object. Typically, an object that inherits from 
class <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, or 
<code><a href="stats.html#topic+nls">nls</a></code> (but others may work too).</p>
</td></tr>
<tr><td><code id="plotFit_+3A_...">...</code></td>
<td>
<p>Additional optional arguments passed on to 
<code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_type">type</code></td>
<td>
<p>The type of prediction required. The default is on the scale of 
the response variable; the alternative <code>"link"</code> is on the scale of the 
linear predictor. This option is only used when plotting 
<code><a href="stats.html#topic+glm">glm</a></code> objects.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_interval">interval</code></td>
<td>
<p>A character string indicating if a prediction band, 
confidence band, both, or none should be plotted.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_level">level</code></td>
<td>
<p>The desired confidence level.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_data">data</code></td>
<td>
<p>An optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_adjust">adjust</code></td>
<td>
<p>A character string indicating the type of adjustment (if any) 
to make to the confidence/prediction bands.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_k">k</code></td>
<td>
<p>An integer to be used in computing the critical value for the 
confidence/prediction bands. Only needed when <code>adjust = "Bonferroni"</code>,
or when <code>adjust = "Scheffe"</code> and <code>interval = "prediction"</code>.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_shade">shade</code></td>
<td>
<p>A logical value indicating if the band should be shaded.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_extend.range">extend.range</code></td>
<td>
<p>A logical value indicating if the fitted regression line
and bands (if any) should extend to the edges of the plot. Default is 
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_hide">hide</code></td>
<td>
<p>A logical value indicating if the fitted model should be plotted 
on top of the points (<code>FALSE</code>) or behind them (<code>TRUE</code>). Default is 
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_col.conf">col.conf</code></td>
<td>
<p>Shade color for confidence band.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_col.pred">col.pred</code></td>
<td>
<p>Shade color for prediction band.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_border.conf">border.conf</code></td>
<td>
<p>The color to use for the confidence band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_border.pred">border.pred</code></td>
<td>
<p>The color to use for the prediction band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_col.fit">col.fit</code></td>
<td>
<p>The color to use for the fitted line.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lty.conf">lty.conf</code></td>
<td>
<p>Line type to use for confidence band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lty.pred">lty.pred</code></td>
<td>
<p>Line type to use for prediction band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lty.fit">lty.fit</code></td>
<td>
<p>Line type to use for the fitted regression line.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lwd.conf">lwd.conf</code></td>
<td>
<p>Line width to use for confidence band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lwd.pred">lwd.pred</code></td>
<td>
<p>Line width to use for prediction band border.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_lwd.fit">lwd.fit</code></td>
<td>
<p>Line width to use for the fitted regression line.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_n">n</code></td>
<td>
<p>The number of predictor values at which to evaluate the fitted model
(larger gives a smoother plot).</p>
</td></tr>
<tr><td><code id="plotFit_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_xlim">xlim</code></td>
<td>
<p>The x limits (x1, x2) of the plot.</p>
</td></tr>
<tr><td><code id="plotFit_+3A_ylim">ylim</code></td>
<td>
<p>The y limits (y1, y2) of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value (called for side effects).
</p>


<h3>Note</h3>

<p>By default, the plotted intervals are unadjusted (i.e., pointwise) intervals.
For simultaneous intervals, use <code>adjust = "Bonferroni"</code> or 
<code>adjust = "Scheffe"</code>. For the Bonferroni adjustment, you must specify a 
value for <code>k</code>, the number of intervals for which the coverage is to hold 
simultaneously. For the Scheffe adjustment, specifying a value for <code>k</code> 
is only required when <code>interval = "prediction"</code>; if 
<code>interval = "confidence"</code>, <code>k</code> is set equal to <code class="reqn">p</code>, the number 
of regression parameters. For example, if <code>object</code> is a simple linear 
regression model, then calling <code>plotFit</code> with 
<code>interval = "confidence"</code> and <code>adjust = "Scheffe"</code> will plot the 
<a href="https://en.wikipedia.org/wiki/Working-Hotelling_procedure">Working-Hotelling band</a>.
</p>
<p>Confidence/prediction bands for nonlinear regression (i.e., objects of class
<code><a href="stats.html#topic+nls">nls</a></code>) are based on the linear approximation described in 
Bates &amp; Watts (2007).
</p>


<h3>References</h3>

<p>Bates, D. M., and Watts, D. G. (2007)
<em>Nonlinear Regression Analysis and its Applications</em>. Wiley.
</p>
<p>Florent Baty, Christian Ritz, Sandrine Charles, Martin Brutsche, 
Jean-Pierre Flandrois, Marie-Laure Delignette-Muller (2015). 
A Toolbox for Nonlinear Regression in R: The Package nlstools. 
<em>Journal of Statistical Software</em>, <b>66</b>(5), 1-21.
</p>


<h3>See Also</h3>

<p><code><a href="nlstools.html#topic+plotfit">plotfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A nonlinear least squares example (see ?datasets::Puromycin and 
# ?investr::predFit)
data(Puromycin, package = "datasets")
Puromycin2 &lt;- Puromycin[Puromycin$state == "treated", ][, 1:2]
Puro.nls &lt;- nls(rate ~ Vm * conc/(K + conc), data = Puromycin2,
                start = c(Vm = 200, K = 0.05))
plotFit(Puro.nls, interval = "both", pch = 19, shade = TRUE, 
        col.conf = "skyblue4", col.pred = "lightskyblue2")  
</code></pre>

<hr>
<h2 id='predFit'>Predictions from a Fitted Model</h2><span id='topic+predFit'></span><span id='topic+predFit.default'></span><span id='topic+predFit.lm'></span><span id='topic+predFit.glm'></span><span id='topic+predFit.nls'></span><span id='topic+predFit.lme'></span>

<h3>Description</h3>

<p>Generic prediction method for various types of fitted models. <code>predFit</code> 
can be used to obtain standard errors of fitted values and 
adjusted/unadjusted confidence/prediction intervals for objects of class 
<code>"lm"</code>, <code>"nls"</code>, and <code>"glm"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predFit(object, ...)

## Default S3 method:
predFit(object, ...)

## S3 method for class 'lm'
predFit(
  object,
  newdata,
  se.fit = FALSE,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  adjust = c("none", "Bonferroni", "Scheffe"),
  k,
  ...
)

## S3 method for class 'glm'
predFit(
  object,
  newdata,
  type = c("link", "response"),
  se.fit = FALSE,
  interval = c("none", "confidence"),
  level = 0.95,
  ...
)

## S3 method for class 'nls'
predFit(
  object,
  newdata,
  se.fit = FALSE,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  adjust = c("none", "Bonferroni", "Scheffe"),
  k,
  ...
)

## S3 method for class 'lme'
predFit(object, newdata, se.fit = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predFit_+3A_object">object</code></td>
<td>
<p>An object that inherits from class <code>"lm"</code>, <code>"glm"</code>,
<code>"nls"</code>, or <code>"lme"</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_...">...</code></td>
<td>
<p>Additional optional arguments. At present, no optional arguments 
are used.</p>
</td></tr>
<tr><td><code id="predFit_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with 
which to predict. If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predFit_+3A_se.fit">se.fit</code></td>
<td>
<p>A logical vaue indicating if standard errors are required. 
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_interval">interval</code></td>
<td>
<p>Type of interval to be calculated. Can be one of &quot;none&quot; 
(default), &quot;confidence&quot;, or &quot;prediction&quot;. Default is <code>"none"</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_level">level</code></td>
<td>
<p>A numeric scalar between 0 and 1 giving the confidence level for 
the intervals (if any) to be calculated. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_adjust">adjust</code></td>
<td>
<p>A logical value indicating if an adjustment should be made to
the critical value used in calculating the confidence interval. This is 
useful for when the calibration curve is to be used multiple, say k, times.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_k">k</code></td>
<td>
<p>The number times the calibration curve is to be used for computing 
a confidence/prediction interval. Only needed when 
<code>adjust = "Bonferroni"</code>.</p>
</td></tr>
<tr><td><code id="predFit_+3A_type">type</code></td>
<td>
<p>Character string specifying the type of prediction. Current 
options are <code>type = "link"</code> (the default) and 
<code>type = "response"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence and prediction intervals for linear models (i.e., <code>"lm"</code> 
objects) are obtained according to the usual formulas. Nonlinear and 
generalized linear models (i.e., <code>"nls"</code> and <code>"glm"</code> objects), on 
the other hand, rely on Taylor-series approximations for the standard errors 
used in forming the intervals. Approximate standard errors for the fitted 
values in linear mixed-effects models (i.e., <code>"lme"</code> objects) can also 
be computed; however, these rely on the approximate variance-covariance 
matrix of the fixed-effects estimates and often under estimate the true
standard error. More accurate standard errors can be obtained using the 
parametric bootstrap; see <code><a href="lme4.html#topic+bootMer">bootMer</a></code> for details.
</p>
<p>For linear and nonlinear models, it is possible to request <em>adjusted</em>
confidence or prediction intervals using the Bonferroni method 
(<code>adjust = "Bonferroni"</code>) or Scheffe's method 
(<code>adjust = "Scheffe"</code>). For the Bonferroni adjustment, you must specify 
a value for <code>k</code>, the number of intervals for which the coverage is to 
hold simultaneously. For the Scheffe adjustment, specifying a value for 
<code>k</code> is only required when <code>interval = "prediction"</code>; if 
<code>interval = "confidence"</code>, <code>k</code> is set equal to <code class="reqn">p</code>, the number 
of regression parameters. For example, calling <code>plotFit</code> on <code>"lm"</code>
objects with <code>interval = "confidence"</code> and <code>adjust = "Scheffe"</code> 
will plot the Working-Hotelling band.
</p>


<h3>Value</h3>

<p>If <code>se.fit = FALSE</code>, then <code>predFit()</code> returns a vector of 
predictions or a matrix of predictions and bounds with column names 
<code>fit</code>, <code>lwr</code>, and <code>upr</code> if <code>interval</code> is not 
<code>"none"</code>. (This function is more so meant for internal use.)
</p>
<p>If <code>se.fit = TRUE</code>, then a list with the following components is 
returned:
</p>

<ul>
<li> <p><code>fit</code> a vector or matrix as described above;
</p>
</li>
<li> <p><code>se.fit</code> a vector containing the standard errors of the 
predicted means;
</p>
</li>
<li> <p><code>residual.scale</code> the residual standard deviations;
</p>
</li>
<li> <p><code>df</code> the residual degrees of freedom.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># A linear regression example (see ?datasets::cars)
cars.lm &lt;- lm(dist ~ speed + I(speed^2), data = cars)
predFit(cars.lm, interval = "confidence")

# A nonlinear least squares example (see ?datasets::Puromycin)
data(Puromycin, package = "datasets")
Puromycin2 &lt;- Puromycin[Puromycin$state == "treated", ][, 1:2]
Puro.nls &lt;- nls(rate ~ Vm * conc/(K + conc), data = Puromycin2,
                start = c(Vm = 200, K = 0.05))
conc &lt;- seq(from = 0.02, to = 1.10, length = 101)
pred &lt;- predFit(Puro.nls, newdata = data.frame(conc), interval = "prediction")
plot(Puromycin2, ylim = c(min(pred[, "lwr"]), max(pred[, "upr"])))
lines(conc, pred[, "fit"], lwd = 2)
lines(conc, pred[, "lwr"], lty = 2)
lines(conc, pred[, "upr"], lty = 2)
</code></pre>

<hr>
<h2 id='whisky'>Whisky data</h2><span id='topic+whisky'></span>

<h3>Description</h3>

<p>The data give the proof (measured as twice the percentage of alcohol by 
volume, denoted 2ABV) of whiskey stored in a charred oak barrel against time 
in years.
</p>


<h3>Format</h3>

<p>A data frame with 10 rows and 2 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>age</code> The age of the whisky (years).
</p>
</li>
<li> <p><code>proof</code> The proof of the whisky (2ABV).
</p>
</li></ul>



<h3>Source</h3>

<p>R. Schoeneman, R. Dyer, and E. Earl. Analytical profile of straight bourbon 
whiskies. Journal of the Association of Official Analytical Chemists, 
54:1247&ndash;1261, 1971.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
