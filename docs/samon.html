<!DOCTYPE html><html><head><title>Help for package samon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpha0Tables'><p>Makes samon result tables at alpha = 0</p></a></li>
<li><a href='#alpha0TablesIM'><p>Makes samonIM result tables at sensitivity parameter alpha=0.</p></a></li>
<li><a href='#ManData'><p>Data used in the man page examples.</p></a></li>
<li><a href='#samon'><p>Sensitivity Analysis for monotone missing data</p></a></li>
<li><a href='#samonCombine'><p>Combines results from separate runs of the samon function</p></a></li>
<li><a href='#samonCombineIM'><p>Combines results from separate runs of the samonIM function</p></a></li>
<li><a href='#samonCrossSummary'><p>Summary function for the difference in effect of two treatments</p>
at different sensitivity parameters alpha.</a></li>
<li><a href='#samonCrossSummaryIM'><p>Summary function for the difference in effect of two treatments</p>
at different sensitivity parameters.</a></li>
<li><a href='#samonDataCheck'><p>Samon Data Check</p></a></li>
<li><a href='#samonDifferenceSummary'><p>Summary function for the difference in treatment effect</p></a></li>
<li><a href='#samonDifferenceSummaryIM'><p>Summary function for the difference in treatment</p></a></li>
<li><a href='#samonECompleterStatus'><p>Computes the difference in the expected value of non-completers and completers</p></a></li>
<li><a href='#samoneval'><p>Evaluates the loss function on a range of sigmas</p></a></li>
<li><a href='#samonevalIM'><p>Evaluates the loss function at a range of smoothing parameters</p></a></li>
<li><a href='#samonGen'><p>Sensitivity Analysis for monotone missing data</p></a></li>
<li><a href='#samonGenIM'><p>Sensitivity Analysis for monotone missing data</p></a></li>
<li><a href='#samonIM'><p>samonIM: Sensitivity analysis for monotone missing and</p>
intermittent missing data</a></li>
<li><a href='#samonSummary'><p>Summary function for an object returned by the samon function</p></a></li>
<li><a href='#samonSummaryIM'><p>Summary function for an object returned by the samonIM function</p></a></li>
<li><a href='#samonTable1'><p>Summarizes two treatment groups.</p></a></li>
<li><a href='#The+20+20PANSS+20trial.'><p>The PANSS randomized trial.</p></a></li>
<li><a href='#The+20DepWork+20trial'><p>The depression and working status trial.</p></a></li>
<li><a href='#The+20VAS+20trial.'><p>The VAS randomized trial.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>4.0.2</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Sensitivity Analysis for Missing Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel O. Scharfstein [aut],
  Aidan McDermott [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aidan McDermott &lt;amcderm1@jhu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In a clinical trial with repeated measures designs, outcomes are often taken from subjects at fixed time-points.  The focus of the trial may be to compare the mean outcome in two or more groups at some pre-specified time after enrollment. In the presence of missing data auxiliary assumptions are necessary to perform such comparisons.  One commonly employed assumption is the missing at random assumption (MAR).   The 'samon' package allows the user to perform a (parameterized) sensitivity analysis of this assumption.  In particular it can be used to examine the sensitivity of tests in the difference in outcomes to violations of the MAR assumption.  The sensitivity analysis can be performed under two scenarios, a) where the data exhibit a monotone missing data pattern (see the samon() function), and, b) where in addition to a monotone missing data pattern the data exhibit intermittent missing values (see the samonIM() function).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-25 22:09:56 UTC; aidanmcdermott</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-26 07:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpha0Tables'>Makes samon result tables at alpha = 0</h2><span id='topic+alpha0Tables'></span><span id='topic+alpha0TableResults'></span>

<h3>Description</h3>

<p>alpha0TableResults collects results for tables at sensitivity parameter
alpha = 0 and alpha0Tables prints the output from alpha0TableResults</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha0TableResults( Y1, samonR1, Y2, samonR2, samonRD)
alpha0Tables( alpha0TableResultsObj, trt1lab = "Treatment 1",
trt2lab = "Treatment 2")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha0Tables_+3A_y1">Y1</code></td>
<td>
<p> treatment 1's raw data.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_samonr1">samonR1</code></td>
<td>
<p> samon results for treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_y2">Y2</code></td>
<td>
<p> treatment 2's raw data.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_samonr2">samonR2</code></td>
<td>
<p> samon results for treatment 2.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_samonrd">samonRD</code></td>
<td>
<p> samon results for the difference of treatment 2 minus
treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_alpha0tableresultsobj">alpha0TableResultsObj</code></td>
<td>
<p> a list produced by the function alpha0TableResults.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_trt1lab">trt1lab</code></td>
<td>
<p> a label for treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0Tables_+3A_trt2lab">trt2lab</code></td>
<td>
<p> a label for treatment 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>alpha0TableResults computes material to build the table and
alpha0Tables prints tables as simple text.
</p>


<h3>Value</h3>

<p>alpha0TableResults returns table data. 
alpha0Tables returns nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("samonPANSS1")
data("samonPANSS2")

data("PSummary1")
data("PSummary2")
data("PSummaryD")

alpha0Results &lt;- alpha0TableResults( samonPANSS1, PSummary1,
                                     samonPANSS2, PSummary2,
                                                  PSummaryD )
alpha0Tables(alpha0Results)
</code></pre>

<hr>
<h2 id='alpha0TablesIM'>Makes samonIM result tables at sensitivity parameter alpha=0.</h2><span id='topic+alpha0TablesIM'></span><span id='topic+alpha0TableResultsIM'></span>

<h3>Description</h3>

<p>alpha0TableResultsIM collects results for
tables at sensitivity parameter alpha = 0 and alpha0TablesIM 
prints the output from alpha0TableResultsIM</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha0TableResultsIM( Y1, samonR1, Y2, samonR2, samonRD)
alpha0TablesIM( alpha0TableResultsObj, trt1lab = "Treatment 1",
trt2lab = "Treatment 2")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha0TablesIM_+3A_y1">Y1</code></td>
<td>
<p> treatment 1's raw data.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_samonr1">samonR1</code></td>
<td>
<p> samon results for treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_y2">Y2</code></td>
<td>
<p> treatment 2's raw data.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_samonr2">samonR2</code></td>
<td>
<p> samon results for treatment 2.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_samonrd">samonRD</code></td>
<td>
<p> samon results for the difference of treatment 2 minus
treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_alpha0tableresultsobj">alpha0TableResultsObj</code></td>
<td>
<p> a list produced by the function
alpha0TableResultsIM.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_trt1lab">trt1lab</code></td>
<td>
<p> a label for treatment 1.</p>
</td></tr>
<tr><td><code id="alpha0TablesIM_+3A_trt2lab">trt2lab</code></td>
<td>
<p> a label for treatment 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>alpha0TableResultsIM computes material to build the table and
alpha0TablesIM prints tables as simple text.
</p>


<h3>Value</h3>

<p>alpha0TableResultsIM returns table data. 
alpha0TablesIM returns nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("VAS1")
data("VAS2")

data("VSummary1")
data("VSummary2")
data("VSummaryD")

alpha0Results &lt;- alpha0TableResultsIM( VAS1, VSummary1,
                                       VAS2, VSummary2,
                                             VSummaryD )
alpha0TablesIM(alpha0Results)
</code></pre>

<hr>
<h2 id='ManData'>Data used in the man page examples.</h2><span id='topic+P1Res001'></span><span id='topic+P1Res002'></span><span id='topic+P1Results'></span><span id='topic+P2Results'></span><span id='topic+PSummary1'></span><span id='topic+PSummary2'></span><span id='topic+PSummaryD'></span><span id='topic+V1Res001'></span><span id='topic+V1Res002'></span><span id='topic+V1Results'></span><span id='topic+V2Results'></span><span id='topic+VSummary1'></span><span id='topic+VSummary2'></span><span id='topic+VSummaryD'></span>

<h3>Description</h3>

<p>Some functions within the 'samon' package take some time to
run, particularly when the number of bootstraps requested is large.
To illustrate some of the functions on the man pages pre-packaged
results are sometime used to make the examples run faster. Here we
list some of this data.
</p>


<h3>Details</h3>

<p>The samonPANSS1 and samonPANSS2 datasets are documented on
their own man pages.
</p>

<dl>
<dt>P1Res001 and P1Res002</dt><dd><p> are two small output objects from the
samon function and are used to illustrate the functioning of the
samonCombine function.</p>
</dd>
<dt>P1Results and P2Results</dt><dd><p> are combined results for samonPANSS1
and samonPANSS2 respectively and are used to illustrate the
functioning of the samonSummary function.</p>
</dd>
<dt>PSummary1 and PSummary2</dt><dd><p> are summary objects from the
samonSummary function and are used to illustrate the use of the
samonDifferenceSummary and samonCrossSummary functions.</p>
</dd>
<dt>PSummryD</dt><dd><p> this is the results from the samonDifferenceSummary
function and is used along with PSummary1 and Psummary2 to illustrate
the alpha0Table and samonEYCompleterStatus functions.</p>
</dd>
</dl>
<p>The VAS1 and VAS2 datasets are documented on their own man pages.
</p>
<dl>
<dt>V1Res001 and V1Res002</dt><dd><p> are two small output objects returned
from the samonIM function and are used to illustrate the functioning
of the samonCombineIM function.</p>
</dd>
<dt>V1Results and V2Results</dt><dd><p> are combined results for VAS1 and VAS2
respectively and are used to illustrate the functioning of the
samonSummaryIM function.</p>
</dd>
<dt>VSummary1 and VSummary2</dt><dd><p> are summary objects from the
samonSummaryIM function and are used to illustrate the use of the
samonDifferenceSummaryIM and samonCrossSummaryIM functions.</p>
</dd>
<dt>VSummryD</dt><dd><p> is the results from the samonDifferenceSummaryIM
function and is used along with VSummary1 and VSummary2 to illustrate
the alpha0Table and samonEYCompleterStatus functions.</p>
</dd>
</dl>


<h3>Source</h3>

<p>Pre-caluclated results from packaged data</p>

<hr>
<h2 id='samon'>Sensitivity Analysis for monotone missing data</h2><span id='topic+samon'></span>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial, produces estimates of the expected value of the outcome at the
final time-point for a range of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samon(mat, Npart = 10, InitialSigmaH = 1.0, HighSigmaH = 2.0,
InitialSigmaF = 1.0, HighSigmaF = 2.0, lb = 0, ub = 101, 
zeta1 = 1, zeta2 = 1,NSamples = 0, seed0 = 1, MaxIter = 25,
FAconvg = 1E-7, FRconvg = 1E-7, SAconvg = 1E-7, alphaList= c(0), 
MJackknife = FALSE, SJackknife = FALSE, retIFiM = FALSE, 
retIFiS = FALSE, Tfun= NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samon_+3A_mat">mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j.</p>
</td></tr> 
<tr><td><code id="samon_+3A_npart">Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td></tr>
<tr><td><code id="samon_+3A_initialsigmah">InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samon_+3A_highsigmah">HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samon_+3A_initialsigmaf">InitialSigmaF</code></td>
<td>
<p> Initial value when calculation optimal sigma F. </p>
</td></tr>
<tr><td><code id="samon_+3A_highsigmaf">HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma F. </p>
</td></tr>
<tr><td><code id="samon_+3A_lb">lb</code></td>
<td>
<p> Lower bound for Y. </p>
</td></tr>
<tr><td><code id="samon_+3A_ub">ub</code></td>
<td>
<p> Upper bound for Y. </p>
</td></tr>
<tr><td><code id="samon_+3A_zeta1">zeta1</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td></tr>
<tr><td><code id="samon_+3A_zeta2">zeta2</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td></tr>
<tr><td><code id="samon_+3A_nsamples">NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td></tr>
<tr><td><code id="samon_+3A_seed0">seed0</code></td>
<td>
<p> Seed to use. </p>
</td></tr>
<tr><td><code id="samon_+3A_maxiter">MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td></tr>
<tr><td><code id="samon_+3A_faconvg">FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samon_+3A_frconvg">FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samon_+3A_saconvg">SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td></tr>
<tr><td><code id="samon_+3A_alphalist">alphaList</code></td>
<td>
<p> a vector of sensitivity parameters </p>
</td></tr>
<tr><td><code id="samon_+3A_mjackknife">MJackknife</code></td>
<td>
<p> Jackknife main data (logical)</p>
</td></tr>
<tr><td><code id="samon_+3A_sjackknife">SJackknife</code></td>
<td>
<p> Jackknife bootstrap samples (logical) </p>
</td></tr>
<tr><td><code id="samon_+3A_retifim">retIFiM</code></td>
<td>
<p> return individual IF estimates from main data. </p>
</td></tr>
<tr><td><code id="samon_+3A_retifis">retIFiS</code></td>
<td>
<p> return individual IF estimates from samples. </p>
</td></tr>
<tr><td><code id="samon_+3A_tfun">Tfun</code></td>
<td>
<p> n by 2 matrix with tilting function values. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point.
</p>
<p>The values in the first column of mat are the baseline values and should
not have missing values.  Samon creates one-step bias corrected estimates of
the mean value of Y at the last time-point for a number of specified
sensitivity parameters, alpha.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the &quot;missingness&quot; model and, sigma F, which represents
smoothing in the &quot;outcome&quot; model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model.  In a
similar vein InitialSigmaF is used as the initial value in the
optimization of the outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i)) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>
<p>Using the optimal values for sigma H and sigma F, samon produces
estimates of the mean value of the outcome at the last visit, for the
set of sensitivity parameters given in the vector alphaList.
</p>
<p>If the sensitivity parameters are applied to the cumulative beta function,
IB.  Four parameters are used to map the values of the outcome, y to the
domain of the  cumulative beta. r(y) = IB( (y-lb)/(ub-lb), zeta1,
zeta2) where zeta1 and zeta2 are the shape parameters.
</p>
<p>Alternatively samon may be called with a user specified sensitivity
function. This is given as an n by 2 matrix with the first column
holding the unique values of the data in mat and the second column the
value of the sensitivity function at that value.
</p>


<h3>Value</h3>

<p>samon returns a list which includes the following:
</p>
<table>
<tr><td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The &quot;M&quot; in the
name &quot;HM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
<tr><td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The &quot;M&quot; in the
name &quot;FM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
</table>
<p>The return code takes the following values:   
</p>
<table>
<tr><td><code>1</code></td>
<td>
<p> absolute function convergence was met </p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p> relative function convergence was met </p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p> second derivative has become too small </p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p> maximum iterations reached </p>
</td></tr>
<tr><td><code>5</code></td>
<td>
<p> value reset to HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>6</code></td>
<td>
<p> loss function smaller at HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>IFM</code></td>
<td>
<p> matrix with 7 columns containing one-step bias-corrected
estimates (sometimes referred to here as IF estimates). Columns are
sample, type, alpha, est0, se0, IFEst, IFVar.  The columns sample
and type take the value 0.  IFEst and IFVar are the one-step bias
corrected estimates and an estimate of their variance for the
original data, mat, at each value of the sensitivity parameters, alpha. </p>
</td></tr>
</table>
<p>In a similar manner, &quot;HS&quot;, &quot;FS&quot;, and &quot;IFS&quot; contain results from
parametric bootstraps (should NSamples be greater than 0).  The first
columns in this case contain the sample number, 1, 2, ...,
NSamples. In other respects these matrices have the same structure as
the corresponding matrix &quot;HM&quot;, &quot;FM&quot; and &quot;IFM&quot;.
</p>
<p>If MJackknife is set to TRUE, then, &quot;HMjk&quot;, &quot;FMjk&quot;, &quot;IFMjk&quot; are
produced, holding the jackknife results for the main data mat.  Again
the first column &quot;sample&quot; is set to 0, and the second column is termed
&quot;Dropped&quot; and gives the observation number dropped to form the
jackknife sample.
</p>
<p>Finally, if SJackknife is set to TRUE, then, &quot;HSjk&quot;, &quot;FSjk&quot;, &quot;IFSjk&quot;
are produced.  These hold the jackknife results for the bootstrap
samples.
</p>


<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("samonPANSS1")

Results1 &lt;- samon(
  mat            = samonPANSS1,
  Npart          =          10, # number of partitions
    
  InitialSigmaH  =        15.0, # initial value
  HighSigmaH     =        50.0, # high value for H
    
  InitialSigmaF  =         8.0, # initial value
  HighSigmaF     =        50.0, # high value for F
    
  lb             =          30, # parameters to
  ub             =         210, # cumulative 
  zeta1          =         4.0, # beta distribution
  zeta2          =         7.0,

  alphaList      =        -1:1 )
</code></pre>

<hr>
<h2 id='samonCombine'>Combines results from separate runs of the samon function</h2><span id='topic+samonCombine'></span>

<h3>Description</h3>

<p>Combines lists returned from the samon function to form a
single object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonCombine( filenames, replaceSampleNo=TRUE, ForceAppend =
FALSE, objlist = NULL )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonCombine_+3A_filenames">filenames</code></td>
<td>
<p> a vector of rds filenames each containing the output
from samon</p>
</td></tr>
<tr><td><code id="samonCombine_+3A_replacesampleno">replaceSampleNo</code></td>
<td>
<p> A logical value determining if the sample
numbers should be replaced in the output object.  Usually the sample
numbers are 1,2,...,NSamples in each file. When the results in
filenames are from different runs of samon with different seeds, the
results in the output are given unique sample numbers, usually 1, 2,
... NTot, where NTot is the total number of samples.</p>
</td></tr>
<tr><td><code id="samonCombine_+3A_forceappend">ForceAppend</code></td>
<td>
<p> put results together even if the files don't match
on some criteria, such as the start values for sigma H or sigma
F. Otherwise report the problem and return.</p>
</td></tr>
<tr><td><code id="samonCombine_+3A_objlist">objlist</code></td>
<td>
<p> an alternative input of samon objects to be combined.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the samon function is used in parallel a number of results
are returned.  If these results are stored in rds files, the
samonCombine function can extract the results and combine them to
produce a single object.
</p>
<p>This is usually done for a single treatment arm at a time.
</p>


<h3>Value</h3>

<p>Returns a list similar to that returned by samon itself.  This list may
be passed to samonSummary and other samon functions. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># outputs from samon -- run on samonPANSS1 with different seeds
data("P1Res001")
data("P1Res002")

# combine them
trt1Results &lt;- samonCombine( objlist = list(P1Res001,P1Res002) )
</code></pre>

<hr>
<h2 id='samonCombineIM'>Combines results from separate runs of the samonIM function</h2><span id='topic+samonCombineIM'></span>

<h3>Description</h3>

<p>Combines lists returned from the samonIM function to form a
single object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonCombineIM( filenames, replaceSampleNo=TRUE, ForceAppend =
FALSE, objlist = NULL )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonCombineIM_+3A_filenames">filenames</code></td>
<td>
<p> a list of rds filenames each containing the output
from samonIM</p>
</td></tr>
<tr><td><code id="samonCombineIM_+3A_replacesampleno">replaceSampleNo</code></td>
<td>
<p> A logical value determining if the sample
numbers should be replaced in the output object.  Usually the sample
numbers are 1,2,...,NSamples in each file. When the results in
filenames are from different runs of samon with different seeds, the
results in the output are given unique sample numbers, usually 1, 2,
... NTot, where NTot is the total number of samples.</p>
</td></tr>
<tr><td><code id="samonCombineIM_+3A_forceappend">ForceAppend</code></td>
<td>
<p> put results together even if the files don't match
on some criteria, such as the start values for sigma H or sigma
F. Otherwise report the problem and return.</p>
</td></tr>
<tr><td><code id="samonCombineIM_+3A_objlist">objlist</code></td>
<td>
<p> an alternative input of samon objects to be combined.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the samonIM function is used in parallel a number of results
are returned.  If these results are stored in rds files, the
samonCombine function can extract the results and combine them to
produce a single object.
</p>
<p>This is usually done for a single treatment arm at a time.
</p>


<h3>Value</h3>

<p>Returns a list similar to that returned by samonIM itself.  This list may
be passed to samonSummaryIM and other samon functions. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># outputs from samonIM -- run on VAS1 with different seeds
data("V1Res001")
data("V1Res002")

# combine them
V1Results &lt;- samonCombineIM( objlist = list(V1Res001,V1Res002) )
</code></pre>

<hr>
<h2 id='samonCrossSummary'>Summary function for the difference in effect of two treatments
at different sensitivity parameters alpha.</h2><span id='topic+samonCrossSummary'></span>

<h3>Description</h3>

<p>Produces a summary of the difference in treatment effect
using two samonSummary objects. Differences and confidence intervals
are produced for each pair of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonCrossSummary( trt1, trt2, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonCrossSummary_+3A_trt1">trt1</code></td>
<td>
<p> the result from a call to samonSummary </p>
</td></tr>
<tr><td><code id="samonCrossSummary_+3A_trt2">trt2</code></td>
<td>
<p> the result from a call to samonSummary </p>
</td></tr>
<tr><td><code id="samonCrossSummary_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines estimates, bootstrap estimates and jackknife estimates to
produce summary estimates and confidence intervals for the difference
in  estimates between two treatment groups.  The difference is computed
for all combinations of the smoothing parameter alpha found in the Sum1
input object. 
</p>
<p>The difference in treatment estimates is taken to be those of treatment
2 minus those of treatment 1.
</p>


<h3>Value</h3>

<p>Returns a list. Items include TM which contains treatment estimates,
their difference, and, standard error estimates and CI which contains
confidence intervals. Other items are returned for convenience are n10,
the number of subjects in the first treatment group, and n20 the number
of subjects in the second treatment group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># samon results for treatment 1 and 2 respectively:
data("P1Results")
data("P2Results")

Summary1 &lt;- samonSummary( P1Results )
Summary2 &lt;- samonSummary( P2Results )
SummaryD &lt;- samonDifferenceSummary( Summary1, Summary2 )
SummaryX &lt;- samonCrossSummary( Summary1, Summary2 )
</code></pre>

<hr>
<h2 id='samonCrossSummaryIM'>Summary function for the difference in effect of two treatments
at different sensitivity parameters.</h2><span id='topic+samonCrossSummaryIM'></span>

<h3>Description</h3>

<p>Produces a summary of the difference in treatment effect
using two samonSummaryIM objects, Differences and confidence intervals
are produced for each pair of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonCrossSummaryIM( trt1, trt2, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonCrossSummaryIM_+3A_trt1">trt1</code></td>
<td>
<p> the result from a call to samonSummaryIM for treatment 1 </p>
</td></tr>
<tr><td><code id="samonCrossSummaryIM_+3A_trt2">trt2</code></td>
<td>
<p> the result from a call to samonSummaryIM for treatment 2 </p>
</td></tr>
<tr><td><code id="samonCrossSummaryIM_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines bootstrap estimates to produce summary estimates and
confidence intervals for the difference in  estimates from two
treatment groups.  The difference is computed for all combinations of
the smoothing parameter, alpha, found in the Sum1 input object. 
</p>
<p>The difference in treatment estimates is taken to be those of treatment
2 minus those of treatment 1.
</p>


<h3>Value</h3>

<p>Returns a list. This list includes TM which contains treatment estimates,
their difference, and, standard error estimates. The list also contains,
CI, which contains confidence intervals.
Other items are returned for convenience are n10, the number of
subjects in the first treatment group, and n20 the number of subjects
in the second treatment group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># V1Results and V2Results are the returned objects from the
# samonIM function associated with VAS treatment 1 and 2 respectively.
data("V1Results")
data("V2Results")

# summarize each arm, their difference and their cross difference.
VSummary1 &lt;- samonSummaryIM(V1Results)
VSummary2 &lt;- samonSummaryIM(V2Results)
VSummaryD &lt;- samonDifferenceSummaryIM(VSummary1,VSummary2)
VSummaryX &lt;- samonCrossSummaryIM(VSummary1,VSummary2)
</code></pre>

<hr>
<h2 id='samonDataCheck'>Samon Data Check</h2><span id='topic+samonDataCheck'></span>

<h3>Description</h3>

<p>Checks data for intermittent missing or monotone missing pattern</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonDataCheck( data )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonDataCheck_+3A_data">data</code></td>
<td>
<p> matrix with (i,j) entry representing value for subject i at
time-point j. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a basic summary of samon input data. This includes a check that
there is not missing data at baseline. 
</p>


<h3>Value</h3>

<p>Returns a list with items:  N the number or rows in data, NT the number
of columns in data, missingBaseline which is set to 1 if any baseline
data is missing, and, interMissing, indicating if there are any
intermittent data.
</p>
<p>desc a matrix of dimension N by 4 with each row representing the same
row in the original data.  Columns are:
col 1: 1 if non-missing baseline value
col 2: last available time
col 3: last available observation
col 4: number of non missing values
</p>
<p>Note that col2 - col4 gives the number of intermittent missing values.
</p>
<p>missingPatterns, a list of missing patterns found in the data
NmissingTables, frequencies of missing patterns, and PmissingTable
the proportion of each missing pattern in the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # monotone missing
 data("samonPANSS1")
 chkm &lt;- samonDataCheck( samonPANSS1 )

 # non monotone missing
 data("VAS1")
 chknm &lt;- samonDataCheck( VAS1 )
</code></pre>

<hr>
<h2 id='samonDifferenceSummary'>Summary function for the difference in treatment effect</h2><span id='topic+samonDifferenceSummary'></span>

<h3>Description</h3>

<p>Produces a summary of the difference in treatment effect
using two samon objects. It combines bootstrap and jackknife results
to produce confidence intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonDifferenceSummary( trt1, trt2, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonDifferenceSummary_+3A_trt1">trt1</code></td>
<td>
<p> the result from a call to samonSummary </p>
</td></tr>
<tr><td><code id="samonDifferenceSummary_+3A_trt2">trt2</code></td>
<td>
<p> the result from a call to samonSummary </p>
</td></tr>
<tr><td><code id="samonDifferenceSummary_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines estimates, bootstrap estimates and jackknife standard error
estimates to produce summary estimates and confidence intervals for an
estimate of the difference in treatment effect from two samon objects.
</p>
<p>The difference in treatment estimates is taken to be those of treatment
2 minus those of treatment 1 at the same value of sensitivity parameter
alpha.
</p>


<h3>Value</h3>

<p>Returns a list. Items include: TM which contains treatment estimates,
standard errors for these estimates, the estimate of their difference
and estimates of the standard error of the difference.  Also contains
CI which contains  confidence intervals.
Other items are returned for convenience are n10, the number of
subjects in the first treatment group, and n20 the number of subjects
in the second treatment group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># samon results for treatment 1 and 2 respectively:
data("P1Results")
data("P2Results")

Summary1 &lt;- samonSummary( P1Results )
Summary2 &lt;- samonSummary( P2Results )
SummaryD &lt;- samonDifferenceSummary( Summary1, Summary2 )
SummaryX &lt;- samonCrossSummary( Summary1, Summary2 )
</code></pre>

<hr>
<h2 id='samonDifferenceSummaryIM'>Summary function for the difference in treatment</h2><span id='topic+samonDifferenceSummaryIM'></span>

<h3>Description</h3>

<p>Produces a summary of the difference in treatment effect
using two samonIM objects. It combines bootstrap imputed results
to produce confidence intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonDifferenceSummaryIM( trt1, trt2, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonDifferenceSummaryIM_+3A_trt1">trt1</code></td>
<td>
<p> the result from a call to samonSummaryIM </p>
</td></tr>
<tr><td><code id="samonDifferenceSummaryIM_+3A_trt2">trt2</code></td>
<td>
<p> the result from a call to samonSummaryIM </p>
</td></tr>
<tr><td><code id="samonDifferenceSummaryIM_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines estimates (imputed) bootstrap estimates to  produce summary
estimates and confidence intervals for an estimate of the difference in
treatment effect from two samon objects.
</p>
<p>The difference in treatment estimates is taken to be those of treatment
2 minus those of treatment 1 at the same value of sensitivity parameter
alpha.
</p>


<h3>Value</h3>

<p>Returns a list. Items include: TM which contains treatment estimates
and the difference, together with standard error estimates based on
multiple imputation of bootstrap samples. It also contains CI which
contains confidence intervals. Other items are returned for convenience
are n10, the number of subjects in the first treatment group, and n20
the number of subjects in the second treatment group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># V1Results and V2Results are the returned objects from the
# samonIM function associated with VAS treatment 1 and 2 respectively.
data("V1Results")
data("V2Results")

# summarize each arm, their difference and their cross difference.
VSummary1 &lt;- samonSummaryIM(V1Results)
VSummary2 &lt;- samonSummaryIM(V2Results)
VSummaryD &lt;- samonDifferenceSummaryIM(VSummary1,VSummary2)
VSummaryX &lt;- samonCrossSummaryIM(VSummary1,VSummary2)
</code></pre>

<hr>
<h2 id='samonECompleterStatus'>Computes the difference in the expected value of non-completers and completers</h2><span id='topic+samonECompleterStatus'></span>

<h3>Description</h3>

<p>Computes the difference in the expected value of
non-completers and completers</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonECompleterStatus( Y, BC )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonECompleterStatus_+3A_y">Y</code></td>
<td>
<p> vector of outcomes</p>
</td></tr>
<tr><td><code id="samonECompleterStatus_+3A_bc">BC</code></td>
<td>
<p> a vector of estimates for the mean of Y</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the expected value for completers and non-completers and hence
the difference between the two.
</p>


<h3>Value</h3>

<p>Returns a vector of expected differences.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("samonPANSS1")
data( "PSummary1" )
PSummary1 &lt;- (PSummary1$TM)[,c("alpha","IFEst")]
Pdiff1 &lt;- samonECompleterStatus( samonPANSS1[,ncol(samonPANSS1)],
                                 PSummary1[,2] )

data("VAS1")
data("VSummary1" )
VSummary1 &lt;- (VSummary1$TM)[,c("alpha","IFEst")]
Vdiff1 &lt;- samonECompleterStatus( VAS1[,ncol(VAS1)], VSummary1[,2] )
</code></pre>

<hr>
<h2 id='samoneval'>Evaluates the loss function on a range of sigmas</h2><span id='topic+samoneval'></span>

<h3>Description</h3>

<p>Computes the loss function for a range of sigma</p>


<h3>Usage</h3>

<pre><code class='language-R'>samoneval( mat, Npart = 10, sigmaList = c(1), type="both")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samoneval_+3A_mat">mat</code></td>
<td>
<p> matrix with (i,j) entry representing value for subject i at
time-point j. </p>
</td></tr>
<tr><td><code id="samoneval_+3A_npart">Npart</code></td>
<td>
<p> Data is partitioned into Npart parts when estimating
lossH and lossF.</p>
</td></tr>
<tr><td><code id="samoneval_+3A_sigmalist">sigmaList</code></td>
<td>
<p> vector of sigmas at which to evaluate the loss function. </p>
</td></tr>
<tr><td><code id="samoneval_+3A_type">type</code></td>
<td>
<p> one of &quot;H&quot;, &quot;F&quot; or &quot;both&quot; to evaluate lossH, lossF or
both for sigmaH or sigmaF in indicated range. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Stepping through the values in sigmaList this functions computes the
associated loss function.  If type is set to &quot;H&quot; or &quot;h&quot;, the loss
function associated with dropout is computed.  If type is set to &quot;F&quot; or
&quot;f&quot; the loss function associated with outcome is computed.  If type
is set any other value then both types of loss function are evaluated.
</p>


<h3>Value</h3>

<p>Returns an N by 2 matrix of results if type is &quot;H&quot; or &quot;F&quot; or an N by 4
matrix if type is &quot;both&quot;. There is one row for each value of sigma. If
type is &quot;H&quot; then the columns are sigmaH and lossH, if type is &quot;F&quot; then
the columns are sigmaF and lossF, and, if type = &quot;both&quot; then the
columns are sigmaH, lossH, sigmaF, and lossF.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("samonPANSS1")
## dropout loss function
H1 &lt;- samoneval( mat = samonPANSS1, Npart = 5,
      sigmaList      = seq(1,10,by=1),          
      type           = "H" )
</code></pre>

<hr>
<h2 id='samonevalIM'>Evaluates the loss function at a range of smoothing parameters</h2><span id='topic+samonevalIM'></span>

<h3>Description</h3>

<p>Computes the loss function for a range of smoothing parameters</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonevalIM( mat, Npart = 10, sigmaList = c(1), inmodel =
inmodel, seed = 1, type="both")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonevalIM_+3A_mat">mat</code></td>
<td>
<p> matrix with (i,j) entry representing value for subject i at
time-point j. </p>
</td></tr>
<tr><td><code id="samonevalIM_+3A_npart">Npart</code></td>
<td>
<p> number of parts to partition the data when evaluating
the loss functions lossH and lossF. </p>
</td></tr>
<tr><td><code id="samonevalIM_+3A_sigmalist">sigmaList</code></td>
<td>
<p> vector of sigmas at which to evaluate the loss function. </p>
</td></tr>
<tr><td><code id="samonevalIM_+3A_inmodel">inmodel</code></td>
<td>
<p> NT by 6 matrix indicating which variables to include
in logistic model. </p>
</td></tr>
<tr><td><code id="samonevalIM_+3A_seed">seed</code></td>
<td>
<p> seed to use when imputing intermittent data. </p>
</td></tr>
<tr><td><code id="samonevalIM_+3A_type">type</code></td>
<td>
<p> one of &quot;H&quot;, &quot;F&quot; or &quot;both&quot; to evaluate lossH, lossF or
both for sigmaH or sigmaF in indicated range. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Stepping through the values in sigmaList this functions computes the
values of a loss function.  If type is set to &quot;H&quot; or &quot;h&quot; then the loss
function associated with dropout is computed.  If type is set to &quot;F&quot; or
&quot;f&quot; then the loss function associated with outcome is computed.  If type
is set any other value then both types of loss function are evaluated.
</p>
<p>Since the input matrix, mat, can possess intermittent missing data,
samonevalIM imputes these values using a logistic model.  This is the
model specified by inmodel.
</p>
<p>inmodel is an NT by 6 matrix and contains a row for each time-point
represented in the mat matrix.  Since there are no intermittent missing
data at time 1 and at time NT these rows should be set to zero.
</p>
<p>A separate logistic model is fit for each timepoint t0, with t0 ranging
from 2 to NT-1.  The dependent variable in these models is an indicator
indicating that an individual provided data at time t0.  Only
individuals who are on study at time t0+1 are considered in these models. 
Setting the ith column in inmodel to 1 indicates that the following
terms should be included in the model:
</p>

<dl>
<dt>1</dt><dd><p>the intercept.</p>
</dd>
<dt>2</dt><dd><p>the previous value of Y, that is the value of Y at t0-1.</p>
</dd>
<dt>3</dt><dd><p>the next available value of Y after time t0.</p>
</dd>
<dt>4</dt><dd><p>if the next available value of Y is at time t1, then this is
(t1 - t0 - 1).</p>
</dd>
<dt>5</dt><dd><p>an interaction between the variable in column 3 and column 4.</p>
</dd>
<dt>6</dt><dd><p>0 if an individual is last observed at time NT, 1 if they are
last observed at time NT - 1,  2 if they are last observed at
time NT - 2, etc.</p>
</dd>
</dl>

<p>For the model that runs at the penultimate time, NT-1, including all six
terms in the model will lead to over specification.
</p>
<p>To include as many terms as possible in each model set inmodel to be
</p>

<table>
<tr>
 <td style="text-align: right;"> 
 0 </td><td style="text-align: right;">   0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1</td>
</tr>
<tr>
 <td style="text-align: right;">
 . </td><td style="text-align: right;"> . </td><td style="text-align: right;"> . </td>
</tr>
<tr>
 <td style="text-align: right;">
 . </td><td style="text-align: right;"> . </td><td style="text-align: right;"> . </td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>At a given timepoint t0, there may not be enough intermittent missing
data to support all six terms.  In such cases variables are removed
from the model until the regression converges.  If less than 4
observations have intermittent missing data at a given timepoint a
model fitting the mean is used.
</p>
<p>samonevalIM sequentially imputes intermittent missing data using these
models. Once the intermittent data is imputed a loss function is
evaluated on the data.
</p>


<h3>Value</h3>

<p>Returns an N by 2 matrix of results if type is &quot;H&quot; or &quot;F&quot; or an N by 4
matrix if type is &quot;both&quot;. There is one row for each value of sigma. If
type is &quot;P&quot; then the columns are sigmaH and lossH, if type is &quot;F&quot; then
the columns are sigmaF and lossF, and, if type = &quot;both&quot; then the
columns are sigmaH, lossH, sigmaF, and lossF.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data("VAS1")

  ## inputation moddel.
  NT                &lt;- ncol(VAS1)
  inmodel           &lt;- matrix(1,NT,6)
  inmodel[1,]       &lt;- 0
  inmodel[NT,]      &lt;- 0
  inmodel[NT-1,4:6] &lt;- 0

  ## outcome loss function
  F1 &lt;- samonevalIM( mat = VAS1, Npart = 10,
           sigmaList = seq(1,10,by=1),
           inmodel = inmodel,
           seed = 26,
           type = "F" )
</code></pre>

<hr>
<h2 id='samonGen'>Sensitivity Analysis for monotone missing data</h2><span id='topic+samonGen'></span>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial, produces a sample based on the optimal smoothing parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonGen(mat, Npart = 10, InitialSigmaH = 1.0, HighSigmaH = 2.0,
InitialSigmaF = 1.0, HighSigmaF = 2.0, NSamples = 0, seed0 = 1,
MaxIter = 25, FAconvg = 1E-7, FRconvg = 1E-7, SAconvg = 1E-7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonGen_+3A_mat">mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j.</p>
</td></tr>
<tr><td><code id="samonGen_+3A_npart">Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td></tr>
<tr><td><code id="samonGen_+3A_initialsigmah">InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_highsigmah">HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_initialsigmaf">InitialSigmaF</code></td>
<td>
<p> Initial value when calculating optimal sigma F. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_highsigmaf">HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma F. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_nsamples">NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_seed0">seed0</code></td>
<td>
<p> Seed to use. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_maxiter">MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_faconvg">FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_frconvg">FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonGen_+3A_saconvg">SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point. 
</p>
<p>The values in the first column of mat are the baseline values and should
not be missing.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the &quot;missingness&quot; model and, sigma F, which represents
smoothing in the &quot;outcome&quot; model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model, and,
InitialSigmaF is used as the initial value in the optimization of the
outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i)) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>


<h3>Value</h3>

<p>samonGen returns a list which includes the following:
</p>
<table>
<tr><td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The &quot;M&quot; in the
name &quot;HM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
<tr><td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The &quot;M&quot; in the
name &quot;FM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
</table>
<p>The return code takes the following values:   
</p>
<table>
<tr><td><code>1</code></td>
<td>
<p> absolute function convergence was met </p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p> relative function convergence was met </p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p> second derivative has become too small </p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p> maximum iterations reached </p>
</td></tr>
<tr><td><code>5</code></td>
<td>
<p> value reset to HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>6</code></td>
<td>
<p> loss function smaller at HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>Sample</code></td>
<td>
<p> a matrix of size Nsamples by NT with the sample </p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(samonPANSS1)

Sample1 &lt;- samonGen(
  mat            = samonPANSS1,
  Npart          =           5, # number of partitions
    
  InitialSigmaH  =        15.6, # initial value
  HighSigmaH     =        25.0, # high value for H
    
  InitialSigmaF  =         8.6, # initial value
  HighSigmaF     =        15.0, # high value for F
    
  seed           =         211,
  NSamples       =          30 )
</code></pre>

<hr>
<h2 id='samonGenIM'>Sensitivity Analysis for monotone missing data</h2><span id='topic+samonGenIM'></span>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial with intermittent missing data, produces a sample based on the
optimal smoothing parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonGenIM(mat, Npart = 10, InitialSigmaH = 1.0, 
HighSigmaH = 2.0, InitialSigmaF = 1.0, HighSigmaF = 2.0, 
inmodel = inmodel, NSamples = 0, seed0 = 1, seed1 = 1, 
MaxIter = 25, FAconvg = 1E-7, FRconvg = 1E-7,SAconvg = 1E-7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonGenIM_+3A_mat">mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j.</p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_npart">Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_initialsigmah">InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_highsigmah">HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_initialsigmaf">InitialSigmaF</code></td>
<td>
<p> Initial value when calculating optimal sigma F. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_highsigmaf">HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculating
optimal sigmaF. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_inmodel">inmodel</code></td>
<td>
<p> NT by 6 matrix indicating which variables to include
in logistic model. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_nsamples">NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_seed0">seed0</code></td>
<td>
<p> Seed to use when generating bootstrap samples. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_seed1">seed1</code></td>
<td>
<p> Seed to use when imputing intermittent missing data. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_maxiter">MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_faconvg">FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_frconvg">FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonGenIM_+3A_saconvg">SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point. 
</p>
<p>The values in the first column of mat are the baseline values and should
not be missing.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the &quot;missingness&quot; model and, sigma F, which represents
smoothing in the &quot;outcome&quot; model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model, and,
InitialSigmaF is used as the initial value in the optimization of the
outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i) ) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>
<p>Since the input matrix, mat, can possess intermittent missing data,
samonevalIM imputes these values using a logistic model.  This is the
model specified by inmodel.
</p>
<p>inmodel is an NT by 6 matrix and contains a row for each time-point
represented in the mat matrix.  Since there are no intermittent missing
data at time 1 and at time NT these rows should be set to zero.
</p>
<p>A separate logistic model is fit for each timepoint t0, with t0 ranging
from 2 to NT-1.  The dependent variable in these models is an indicator
indicating that an individual provided data at time t0.  Only
individuals who are on study at time t0+1 are considered in these models. 
Setting the ith column in inmodel to 1 indicates that the following
terms should be included in the model:
</p>

<dl>
<dt>1</dt><dd><p>the intercept.</p>
</dd>
<dt>2</dt><dd><p>the previous value of Y, that is the value of Y at t0-1.</p>
</dd>
<dt>3</dt><dd><p>the next available value of Y after time t0.</p>
</dd>
<dt>4</dt><dd><p>if the next available value of Y is at time t1, then this is
(t1 - t0 - 1).</p>
</dd>
<dt>5</dt><dd><p>an interaction between the variable in column 3 and column 4.</p>
</dd>
<dt>6</dt><dd><p>0 if an individual is last observed at time NT, 1 if they are
last observed at time NT - 1,  2 if they are last observed at
time NT - 2, etc.</p>
</dd>
</dl>

<p>For the model that runs at the penultimate time, NT-1, including all six
terms in the model will lead to over specification.
</p>
<p>To include as many terms as possible in each model set inmodel to be
</p>

<table>
<tr>
 <td style="text-align: right;"> 
 0 </td><td style="text-align: right;">   0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1  </td><td style="text-align: right;">  1</td>
</tr>
<tr>
 <td style="text-align: right;">
 . </td><td style="text-align: right;"> . </td><td style="text-align: right;"> . </td>
</tr>
<tr>
 <td style="text-align: right;">
 . </td><td style="text-align: right;"> . </td><td style="text-align: right;"> . </td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>At a given timepoint t0, there may not be enough intermittent missing
data to support all six terms.  In such cases variables are removed
from the model until the regression converges.  If less than 4
observations have intermittent missing data at a given timepoint a
model fitting the mean is used.
</p>
<p>samonGenIM sequentially imputes intermittent missing data using these
models. Once the intermittent data is imputed a loss function is
evaluated on the data.
</p>


<h3>Value</h3>

<p>samonGen returns a list which includes the following:
</p>
<table>
<tr><td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The &quot;M&quot; in the
name &quot;HM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
<tr><td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The &quot;M&quot; in the
name &quot;FM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
</table>
<p>The return code takes the following values:   
</p>
<table>
<tr><td><code>1</code></td>
<td>
<p> absolute function convergence was met </p>
</td></tr>
<tr><td><code>2</code></td>
<td>
<p> relative function convergence was met </p>
</td></tr>
<tr><td><code>3</code></td>
<td>
<p> second derivative has become too small </p>
</td></tr>
<tr><td><code>4</code></td>
<td>
<p> maximum iterations reached </p>
</td></tr>
<tr><td><code>5</code></td>
<td>
<p> value reset to HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>6</code></td>
<td>
<p> loss function smaller at HighSigmaH or HighSigmaF </p>
</td></tr>
<tr><td><code>Sample</code></td>
<td>
<p> a matrix of size Nsamples by NT with the sample </p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("VAS1")

# define the imputation models
NT                &lt;- ncol(VAS1)
inmodel           &lt;- matrix(1,NT,6)
inmodel[1,]       &lt;- 0
inmodel[NT,]      &lt;- 0
inmodel[NT-1,4:6] &lt;- 0

Sample1 &lt;- samonGenIM(
  mat           =    VAS1, # imput matrix
  Npart         =       5, # number of partitions
    
  InitialSigmaH =    27.9, # initial value
  HighSigmaH    =   100.0, # high value for H
    
  InitialSigmaF =     7.3, # initial value
  HighSigmaF    =   100.0, # high value for F
    
  NSamples      =      12, # number of samples
    
  seed0         =     441, # sample seed
  seed1         =     511, # impute seed 
  inmodel       = inmodel) # input model
</code></pre>

<hr>
<h2 id='samonIM'>samonIM: Sensitivity analysis for monotone missing and
intermittent missing data</h2><span id='topic+samonIM'></span>

<h3>Description</h3>

<p>Given data from one arm of a repeated measures clinical
trial, produces estimates of the expected value of the outcome at the
final time-point for a range of sensitivity parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonIM(mat, Npart = 10, InitialSigmaH = 1.0, 
HighSigmaH = 2.0, InitialSigmaF = 1.0, HighSigmaF = 2.0, 
inmodel = inmodel, NSamples = 0, NIMimpute = 1, lb = 0, 
ub = 101, zeta1 = 1, zeta2 = 1, seed0 = 1, seed1 = 1, 
MaxIter = 25, FAconvg = 1E-7, FRconvg = 1E-7, 
SAconvg = 1E-7, alphaList = c(0), retIFiM  = FALSE, 
retIFiS  = FALSE, retSample = FALSE,
retFMatM = FALSE, retFMatS = FALSE, Tfun=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonIM_+3A_mat">mat</code></td>
<td>
<p> a matrix with the (i,j) entry representing the outcome
value for subject i at time-point j. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_npart">Npart</code></td>
<td>
<p> Number of partitions to use when estimating optimal
smoothing parameters, sigma H and sigma F.</p>
</td></tr>
<tr><td><code id="samonIM_+3A_initialsigmah">InitialSigmaH</code></td>
<td>
<p> Initial value when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_highsigmah">HighSigmaH</code></td>
<td>
<p> Upper bound of search region when calculating optimal sigma H. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_initialsigmaf">InitialSigmaF</code></td>
<td>
<p> Initial value when calculation optimal sigma F. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_highsigmaf">HighSigmaF</code></td>
<td>
<p> Upper bound of search region when calculation
optimal sigma F. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_nsamples">NSamples</code></td>
<td>
<p> Number of parametric bootstrap samples to generate. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_inmodel">inmodel</code></td>
<td>
<p> NT by 6 matrix indicating which variables to include
in logistic model. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_nimimpute">NIMimpute</code></td>
<td>
<p> How many times to fill in intermittent missing data. </p>
</td></tr> 
<tr><td><code id="samonIM_+3A_lb">lb</code></td>
<td>
<p> Lower bound for Y. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_ub">ub</code></td>
<td>
<p> Upper bound for Y. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_zeta1">zeta1</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_zeta2">zeta2</code></td>
<td>
<p> parameter to cumulative beta. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_seed0">seed0</code></td>
<td>
<p> Seed to use for parametric bootstrap sampling </p>
</td></tr>
<tr><td><code id="samonIM_+3A_seed1">seed1</code></td>
<td>
<p> Seed to use for filling intermittent missing data </p>
</td></tr>
<tr><td><code id="samonIM_+3A_maxiter">MaxIter</code></td>
<td>
<p> Maximum iterations to use in optimizer. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_faconvg">FAconvg</code></td>
<td>
<p> Absolute change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_frconvg">FRconvg</code></td>
<td>
<p> Relative change in function convergence criterion. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_saconvg">SAconvg</code></td>
<td>
<p> Step size convergence criterion. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_alphalist">alphaList</code></td>
<td>
<p> a vector of sensitivity parameters </p>
</td></tr>
<tr><td><code id="samonIM_+3A_retifim">retIFiM</code></td>
<td>
<p> return individual IF estimates from main data. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_retifis">retIFiS</code></td>
<td>
<p> return individual IF estimates from sample data. </p>
</td></tr>
<tr><td><code id="samonIM_+3A_retsample">retSample</code></td>
<td>
<p> return the Sample generated </p>
</td></tr>
<tr><td><code id="samonIM_+3A_retfmatm">retFMatM</code></td>
<td>
<p> return the main data with intermittent missing data
filled in NIMimpute + 1 times</p>
</td></tr>
<tr><td><code id="samonIM_+3A_retfmats">retFMatS</code></td>
<td>
<p> retrun the sample data with intermittent missing data
filled in NIMimpute + 1 times</p>
</td></tr>
<tr><td><code id="samonIM_+3A_tfun">Tfun</code></td>
<td>
<p> n by 2 matrix with tilting function values. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix mat represents repeated measure outcome data from a single
arm or treatment group of a trial.  Each row represents the data from a
single subject and each column data from a single time-point.  
</p>
<p>The values in the first column of mat are the baseline values and should
not be missing.  Samon creates bias-corrected estimates of the mean
value of Y at the last time-point for a number of specified sensitivity
parameters, alpha.
</p>
<p>Samon determines two smoothing parameters, sigma H, which represents
smoothing in the &quot;missingness&quot; model and, sigma F, which represents
smoothing in the &quot;outcome&quot; model.  These smoothing parameters are
determined by minimizing loss functions.  Minimization is performed
using Newton's method. The parameter InitialSigmaH is used as the
initial value in the optimization of the missingness model and
InitialSigmaF is used as the initial value in the optimization of the
outcome model.
</p>
<p>A number of stopping criteria are available:
MaxIter:  the maximum number of iterations to perform 
FAconvg:  stop when abs( fsub(i+1) - f_i ) &lt; FAconvg, where f_i is
the loss function value at iteration i.
FRconvg: stop when abs( (fsub(i+1) - f_i)/(fsub(i+1) + f_i)) &lt; FRconvg.
SAconvg: stop when the absolute step size falls below SAconvg,
i.e., abs( xsub(i+1) - x_i ) &lt; SAconvg.
HighSigmaH:  should the value of sigma H go above this value,
then the optimal value of sigma H is set to HighSigmaH.  This is useful
if larger values of sigma H do not change the missingness model
substantially.
HighSigmaF: should the value of sigma F go above this value, then
the optimal value of sigma F is set to HighSigmaF.  This is useful
if larger values of sigma F do not change the missingness model
substantially.
</p>
<p>The inmodel matrix specifies a set of logistic models used to impute
intermittent missing data.  This is an NT by 6 matrix of 0s and 1s.
Each row represents a time-point.  Since intermittent missing data
cannot occur at baseline or at the final timepoint, the first and NT'th
row of inmodel are 0.  The six values on a row indicate the following
terms should be included in the model:
</p>

<dl>
<dt>1</dt><dd><p> a value of 1 in this position indicates that the logistic
model should include an intercept</p>
</dd>
<dt>2</dt><dd><p> a value of 1 in this position indicates that the model should
contain a term for the previous available outcome</p>
</dd>
<dt>3</dt><dd><p> a value of 1 in this position indicates that the model should
contain a term for the next available outcome</p>
</dd>
<dt>4</dt><dd><p> a value of 1 in this position indicates that the model should
contain a term for the location of the next available outcome</p>
</dd>
<dt>5</dt><dd><p> a value of 1 in this position indicates that the model should
contain a term for the interaction between the next available outcome
and the position of the next available outcome</p>
</dd>
<dt>6</dt><dd><p> a value of 1 in this position indicates that the model should
contain a term for the last available outcome before dropout.</p>
</dd>
</dl>

<p>For example suppose the data consists of the 8 columns v1-v8 and
suppose we wish to model the intermittent missingness at the third
time-point, that is, we wish to model when v3 has an intermittent
missing value.   We might model this as is.na(v3) ~ 1 + v2 + n3 + i3 +
i3 * n3 + l3 where n3 refers to the next non-missing value of v after
the third time-point. i3 refers to the location of that non-missing
value, i3 * n3 and interaction between these and l3 the last available
value of v for an individual.  Specifically we might calculate n3, i3
and l3 as shown:
</p>

<table>
<tr>
 <td style="text-align: right;">
 v1 </td><td style="text-align: right;">  v2 </td><td style="text-align: right;">    v3 </td><td style="text-align: right;">    v4  </td><td style="text-align: right;">   v5  </td><td style="text-align: right;">   v6 </td><td style="text-align: right;">    v7  </td><td style="text-align: right;">   v8  </td><td style="text-align: right;">     v2 </td><td style="text-align: right;">    n3 </td><td style="text-align: right;">    i3 </td><td style="text-align: right;">    l3</td>
</tr>
<tr>
 <td style="text-align: right;">
 10 </td><td style="text-align: right;">     8 </td><td style="text-align: right;">    NA </td><td style="text-align: right;">     9 </td><td style="text-align: right;">    32 </td><td style="text-align: right;">    NA </td><td style="text-align: right;">    NA </td><td style="text-align: right;">    NA </td><td style="text-align: right;">       8 </td><td style="text-align: right;">     9 </td><td style="text-align: right;">     1 </td><td style="text-align: right;">    32</td>
</tr>
<tr>
 <td style="text-align: right;">
 11 </td><td style="text-align: right;">     4 </td><td style="text-align: right;">     3 </td><td style="text-align: right;">     5 </td><td style="text-align: right;">     4 </td><td style="text-align: right;">     7 </td><td style="text-align: right;">     7 </td><td style="text-align: right;">    NA </td><td style="text-align: right;">       4 </td><td style="text-align: right;">     5 </td><td style="text-align: right;">     1 </td><td style="text-align: right;">     7</td>
</tr>
<tr>
 <td style="text-align: right;">
 22 </td><td style="text-align: right;">    15 </td><td style="text-align: right;">    NA </td><td style="text-align: right;">    NA </td><td style="text-align: right;">    NA </td><td style="text-align: right;">     6 </td><td style="text-align: right;">     2 </td><td style="text-align: right;">     9 </td><td style="text-align: right;">      15 </td><td style="text-align: right;">     6 </td><td style="text-align: right;">     3 </td><td style="text-align: right;">     9</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>Note that when considering missing values at the NT - 1 time-point the
last three terms in the model are not identifiable.
</p>
<p>Fitting as many terms in the intermittent missing model might use an
inmodel parameter with a matrix like this:
</p>

<table>
<tr>
 <td style="text-align: right;"> 
 0 </td><td style="text-align: right;">   0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>A simpler model using only the intercept and the previous and next
available non-missing value would be specified by
</p>

<table>
<tr>
 <td style="text-align: right;"> 
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>This simpler model but restricted to an intercept only model at the
second and fourth timepoints can be specified by using:  
</p>

<table>
<tr>
 <td style="text-align: right;"> 
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0  </td><td style="text-align: right;">  0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   1 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
 0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0 </td><td style="text-align: right;">   0</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>In practice the amount of intermittent missing data at a timepoint may
not be large enough to support a logistic model with all six
parameters.  At each step samonIM  will attempt to fit the models
indicated by the inmodel matrix and reduce the number of model
parameters if collinearity is found among the independent variables.  
</p>


<h3>Value</h3>

<p>samon returns a list which includes the following:
</p>
<table>
<tr><td><code>HM</code></td>
<td>
<p> matrix of results from sigma H optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma H, and the loss function value at optimal sigma H. The &quot;M&quot; in the
name &quot;HM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
<tr><td><code>FM</code></td>
<td>
<p> matrix of results from sigma F optimization for the input
data mat. Columns are sample, type, return code, iterations, optimal
sigma F, and loss function value at optimal sigma F. The &quot;M&quot; in the
name &quot;FM&quot; refers to the main or input matrix mat.  In this case the
sample and type columns are set to 0.</p>
</td></tr>
</table>
<p>The return code takes the following values:   
</p>

<ol>
<li><p> absolute function convergence was met 
</p>
</li>
<li><p> relative function convergence was met 
</p>
</li>
<li><p> second derivative has become too small
</p>
</li>
<li><p> maximum iterations reached 
</p>
</li>
<li><p> value reset to HighSigmaH or HighSigmaF 
</p>
</li>
<li><p> loss function smaller at HighSigmaH or HighSigmaF 
</p>
</li></ol>

<table>
<tr><td><code>Sample</code></td>
<td>
<p> The generated sample of dimension NSamples by ncol(Mat)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The samon_userDoc.pdf file in the Examples subdirectory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("VAS1")

# inputation model
NT            &lt;- ncol(VAS1)
inmodel       &lt;- matrix(1,NT,6)
inmodel[1,]   &lt;- 0
inmodel[NT,]  &lt;- 0
inmodel[,4:6] &lt;- 0

Results &lt;- samonIM(
  mat           =    VAS1, # imput matrix
  Npart         =       2, # number of partitions
    
  InitialSigmaH =    25.0, # initial value
  HighSigmaH    =   100.0, # high value for H
    
  InitialSigmaF =     8.0, # initial value
  HighSigmaF    =   100.0, # high value for F
    
  lb            =       0, # parameters for
  ub            =     102, # cumulative 
  zeta1         =     1.2, # beta distribution
  zeta2         =     1.6,

  NSamples      =       0, # no of bootstraps
  NIMimpute     =       2, # no of imputations 
    
  seed0         =     441, # seed for bootstraps
  seed1         =     511, # seed for imputations
  inmodel       = inmodel, # input model
    
  alphaList     =   -1:1 )
</code></pre>

<hr>
<h2 id='samonSummary'>Summary function for an object returned by the samon function</h2><span id='topic+samonSummary'></span>

<h3>Description</h3>

<p>Produces summaries of samon objects, combining bootstrap and
jackknife results to produce confidence intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonSummary( trt, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonSummary_+3A_trt">trt</code></td>
<td>
<p> the result from a call to samon or samonCombine </p>
</td></tr>
<tr><td><code id="samonSummary_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines estimates, bootstrap estimates and jackknife estimates to
produce summary estimates and confidence intervals for a samon object.
</p>


<h3>Value</h3>

<p>Returns a list. Items include TM which contains treatment estimates and
standard errors for the main data; TS contains estimates for the
bootstrap samples and includes jackknifes standard error estimates;
CI contains confidence intervals. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("P1Results")
Summary1 &lt;- samonSummary( P1Results )
</code></pre>

<hr>
<h2 id='samonSummaryIM'>Summary function for an object returned by the samonIM function</h2><span id='topic+samonSummaryIM'></span>

<h3>Description</h3>

<p>Produces summaries of samonIM objects, combining multiple
imputed results to produce confidence intervals</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonSummaryIM( trt, CIlevel = 0.95 )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonSummaryIM_+3A_trt">trt</code></td>
<td>
<p> the result from a call to samonIM or samonCombineIM </p>
</td></tr>
<tr><td><code id="samonSummaryIM_+3A_cilevel">CIlevel</code></td>
<td>
<p> the confidence level for confidence intervals </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Combines multiple imputation estimates and multiple imputation
bootstrap estimates to produce summary estimates and confidence
intervals for a samonIM object.
</p>


<h3>Value</h3>

<p>Returns a list. Items include TM which contains treatment estimates and
multiple imputation standard errors for the main data; TS contains
bootstrap estimates and multiple imputation standard error bootstrap estimates.
CI contains confidence intervals. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># V1Results and V2Results are the returned objects from the
# samonIM function associated with VAS treatment 1 and 2 respectively.
data("V1Results")
data("V2Results")

# summarize each arm, their difference and their cross difference.
VSummary1 &lt;- samonSummaryIM(V1Results)
VSummary2 &lt;- samonSummaryIM(V2Results)
VSummaryD &lt;- samonDifferenceSummaryIM(VSummary1,VSummary2)
VSummaryX &lt;- samonCrossSummaryIM(VSummary1,VSummary2)
</code></pre>

<hr>
<h2 id='samonTable1'>Summarizes two treatment groups.</h2><span id='topic+samonTable1'></span><span id='topic+samonTabmat1'></span>

<h3>Description</h3>

<p>samonTabmat1 takes a dataset Y and produces simple summary
statistics which can be printed with the samontTable1 function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>samonTabmat1( Y )
samonTable1( Tabdata, trtlab = "Treatment 1")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samonTable1_+3A_y">Y</code></td>
<td>
<p> Data frame or matrix of data.  Rows are individual
measuremnets and columns represent time-points. </p>
</td></tr>
<tr><td><code id="samonTable1_+3A_tabdata">Tabdata</code></td>
<td>
<p> Matrix of summary stats produced by the samonTabmat1 function.</p>
</td></tr>
<tr><td><code id="samonTable1_+3A_trtlab">trtlab</code></td>
<td>
<p> Label to place above table. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>samonTabmat1 returns an NT by 10 matrix where NT is the number of
columns in the input matrix Y.  The output matrix contains the columns
1. t the time-point.
2. Number On Study
3. Number Observed
4. Number last seen at time t
5. Proportion last seen (of number on-study) 
6. Proportion last seen (of number observed)
7. Number intermittent missing data
8. proportion intermittent missing (of number on-study)
9. mean observed value at time t
10. std observed value at time t
</p>
<p>samonTable1 does not return any object.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # monotone missing
 data("samonPANSS1")
 samonTable1( samonTabmat1( samonPANSS1 ), trtlab = "PANSS Placebo" )

 # non monotone missing
 data("VAS1")
 samonTable1( samonTabmat1( VAS1 ), trtlab = "VAS Placebo" )
</code></pre>

<hr>
<h2 id='The+20+20PANSS+20trial.'>The PANSS randomized trial.</h2><span id='topic+samonPANSS1'></span><span id='topic+samonPANSS2'></span>

<h3>Description</h3>

<p>These dataframes store data from a repeated measures
clinical trial.  samonPANSS1 contains data from the placebo arm and
samonPANSS2 contains data from the active arm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(samonPANSS1)
data(samonPANSS2)
</code></pre>


<h3>Format</h3>

<p>samonPANSS1 is a 88 by 6 dataframe
samonPANSS2 is a 86 by 6 dataframe
</p>


<h3>Details</h3>

<p>In each of samonPANSS1 and samonPANSS2 a row represents the
outcome meansure (PANSS) for one subject at each of 6 timepoints.
</p>

<ul>
<li><p> V1 PANSS score at baseline 
</p>
</li>
<li><p> V2 PANSS score at follow-up time-point 1
</p>
</li>
<li><p> V3 PANSS score at follow-up time-point 2
</p>
</li>
<li><p> ...
</p>
</li>
<li><p> V6 PANSS score at follow-up time-point 5 the last time-point.
</p>
</li></ul>



<h3>Source</h3>

<p>Data are simulated for the samon package</p>

<hr>
<h2 id='The+20DepWork+20trial'>The depression and working status trial.</h2><span id='topic+DepWork1'></span><span id='topic+DepWork2'></span>

<h3>Description</h3>

<p>These dataframes store data from a placebo controlled
repeated measures clinical trial. DepWork1 contains data from the
control arm and DepWork2 contains data from the active arm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DepWork1)
data(DepWork2)
</code></pre>


<h3>Format</h3>

<p>DepWork1 is a   552 by 4 dataframe
DepWork2 is a  1249 by 4 dataframe
</p>


<h3>Details</h3>

<p>In each of DepWork1 and DepWork2 a row represents the outcome
measure (working status) for one subject at each of 4 timepoints.
At a given timepoint, working status is coded as 1 if an individual
is not employed at that timepoint, and, as 2 if the individual is
employed.  No individual was working at baseline.
Both treatment arms contain intermittent missing values.
</p>

<ul>
<li><p> V1 work status at baseline 
</p>
</li>
<li><p> V2 work status at follow-up time-point 1
</p>
</li>
<li><p> V3 work status at follow-up time-point 2
</p>
</li>
<li><p> V4 work status at follow-up time-point 3
</p>
</li></ul>


<hr>
<h2 id='The+20VAS+20trial.'>The VAS randomized trial.</h2><span id='topic+VAS1'></span><span id='topic+VAS2'></span>

<h3>Description</h3>

<p>These dataframes store data from a repeated measures
clinical trial.  VAS1 contains data from the control arm and VAS2
contains data from the active arm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(VAS1)
data(VAS2)
</code></pre>


<h3>Format</h3>

<p>VAS1 is a 255 by 9 dataframe
VAS2 is a 256 by 9 dataframe
</p>


<h3>Details</h3>

<p>In each of VAS1 and VAS2 a row represtents the outcome measure
(VAS) for one subject at each of 9 timepoints. 
Both treatment arms contain intermittent missing values.
</p>

<ul>
<li><p> V1 VAS score at baseline 
</p>
</li>
<li><p> V2 VAS score at follow-up time-point 1
</p>
</li>
<li><p> V3 VAS score at follow-up time-point 2
</p>
</li>
<li><p> ...
</p>
</li>
<li><p> V9 VAS score at follow-up time-point 8 the last time-point.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
