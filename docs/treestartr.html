<!DOCTYPE html><html lang="en"><head><title>Help for package treestartr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {treestartr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#treestartr'><p>treestartr: A package for generating reasonable starting trees for phylogenetic analysis.</p></a></li>
<li><a href='#absent_tippr'><p>Add tips to tree via user input</p></a></li>
<li><a href='#bears'><p>bears</p></a></li>
<li><a href='#dataf_parsr'><p>Detect file format of taxon file</p></a></li>
<li><a href='#echo_rb'><p>Print RevBayes-formatted clade constriants.</p></a></li>
<li><a href='#echo_subtree'><p>Print subtrees with tips added.</p></a></li>
<li><a href='#fileformat'><p>Utility function to check if file is a csv or tsv.</p></a></li>
<li><a href='#genera_strippr'><p>Check if tip is on tree</p></a></li>
<li><a href='#get_found'><p>Get dataframe of tips that do not have congeners on tree.</p></a></li>
<li><a href='#get_lost'><p>Determine if a tip is present on a tree</p></a></li>
<li><a href='#make_absentdf'><p>Determine which tips are not on the tree, and get their genera.</p></a></li>
<li><a href='#make_treedf'><p>Determine which tips are on the tree, and get their genera.</p></a></li>
<li><a href='#present_tippr'><p>Add tips to the tree based on taxonomy.</p></a></li>
<li><a href='#rand_absent_tippr'><p>Random addition of taxa</p></a></li>
<li><a href='#taxon_testr'><p>Utility function to check taxon_names in parsed data file</p></a></li>
<li><a href='#text_placr'><p>Add tips to tree via taxon list</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generate Starting Trees for Combined Molecular, Morphological
and Stratigraphic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Combine a list of taxa with a phylogeny to generate a starting tree for use in
    total evidence dating analyses.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ropensci.github.io/treeStartR/">https://ropensci.github.io/treeStartR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/treeStartR/issues">https://github.com/ropensci/treeStartR/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), phytools (&ge; 0.6-4), ape (&ge; 5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, rmarkdown, covr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-03 20:38:08 UTC; april</td>
</tr>
<tr>
<td>Author:</td>
<td>April Wright [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>April Wright &lt;april.wright@selu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-09 15:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='treestartr'>treestartr: A package for generating reasonable starting trees for phylogenetic analysis.</h2><span id='topic+treestartr'></span><span id='topic+treestartr-package'></span>

<h3>Description</h3>

<p>treestartr provides multiple ways to add tips to a starting tree
</p>


<h3>treestartr functions</h3>

<p>absent_tippr, echo_rb, echo_subtree, present_tippr, rand_absent_tippr, text_placr
</p>

<hr>
<h2 id='absent_tippr'>Add tips to tree via user input</h2><span id='topic+absent_tippr'></span>

<h3>Description</h3>

<p>Add tips not on existing tree to the tree via user input,
if they do not have congeners on the tree. This function will generate a
tree, with nodes numbered. For each tip to be added, the user will be asked #'  to enter the number of the node they would like the tip to subtend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>absent_tippr(tree, absent_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="absent_tippr_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
<tr><td><code id="absent_tippr_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree Phylo object containing the starting tree,
and all tips that were added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  new &lt;- absent_tippr(tree, absent_list) 
</code></pre>

<hr>
<h2 id='bears'>bears</h2><span id='topic+bears'></span><span id='topic+tax_frame'></span><span id='topic+absent_list'></span><span id='topic+mrca_df'></span><span id='topic+tree'></span>

<h3>Description</h3>

<p>A dataset containing 18 taxa and 62 characters for bears
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bears)
</code></pre>


<h3>Format</h3>

<p>A collection of objects representing function inputs:
</p>

<dl>
<dt>tax_frame</dt><dd><p>a two-column dataframe of taxon names and ages</p>
</dd>
<dt>absent_list</dt><dd><p>A list of taxa in the total data set, but are not on the tree</p>
</dd>
<dt>mrca_df</dt><dd><p>a two-column dataframe of taxa to be placed, and a set of taxa that indicate the MRCA which they will subtend</p>
</dd>
<dt>tree</dt><dd><p>A phylogenetic tree to which tips will be added</p>
</dd>
</dl>


<h3>Source</h3>

<p><a href="https://github.com/revbayes/revbayes_tutorial/tree/master/RB_TotalEvidenceDating_FBD_Tutorial/data">https://github.com/revbayes/revbayes_tutorial/tree/master/RB_TotalEvidenceDating_FBD_Tutorial/data</a>
</p>

<hr>
<h2 id='dataf_parsr'>Detect file format of taxon file</h2><span id='topic+dataf_parsr'></span>

<h3>Description</h3>

<p>Detect file format of the total taxon list (molecular, morphological, and stratigraphic) and maximum age of fossil, see RevBayes total
-evidence fossil file for an example of this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataf_parsr(dataf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataf_parsr_+3A_dataf">dataf</code></td>
<td>
<p>A data frame with one column containing the taxon name of tips in phylogenetic tree. Optionally, a second column can indicate the maximum age of the tip. If the tip is extant, use 0.0 as the age. Can be CSV or TSV.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tax_frame Dataframe containing the total set of tips on the tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: tax_frame &lt;- dataf_parsr(dataf)
</code></pre>

<hr>
<h2 id='echo_rb'>Print RevBayes-formatted clade constriants.</h2><span id='topic+echo_rb'></span>

<h3>Description</h3>

<p>Once a tip has been added to the tree, print the subtree to which the tip was added. The output of this function is printed for use as a RevBayes clade constraint object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>echo_rb(tree, mrca_list, tip)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="echo_rb_+3A_tree">tree</code></td>
<td>
<p>Tree to which the tip will be added; object of type phylo</p>
</td></tr>
<tr><td><code id="echo_rb_+3A_mrca_list">mrca_list</code></td>
<td>
<p>Vector of taxa. The added tip will subtend the MRCA of these taxa</p>
</td></tr>
<tr><td><code id="echo_rb_+3A_tip">tip</code></td>
<td>
<p>Taxon which will be added to the tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector A comma-separated list of all the taxa in the subtree to which the tip was added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> mrca_list &lt;- c("Ursus_arctos", "Ursus_spelaeus", "Ursus_americanus")
clade_constraint &lt;- echo_rb(tree, mrca_list, "Ursus_abstrusus")
</code></pre>

<hr>
<h2 id='echo_subtree'>Print subtrees with tips added.</h2><span id='topic+echo_subtree'></span>

<h3>Description</h3>

<p>Once a tip has been added to the tree, print the newick-formatted subtree to which the tip was added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>echo_subtree(tree, mrca_list, tip)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="echo_subtree_+3A_tree">tree</code></td>
<td>
<p>Tree to which the tip will be added; object of type phylo</p>
</td></tr>
<tr><td><code id="echo_subtree_+3A_mrca_list">mrca_list</code></td>
<td>
<p>Vector of taxa. The added tip will subtend the MRCA of these taxa</p>
</td></tr>
<tr><td><code id="echo_subtree_+3A_tip">tip</code></td>
<td>
<p>Taxon which will be added to the tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree subtree to which tip was added
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mrca_list &lt;- c("Ursus_arctos", "Ursus_spelaeus", "Ursus_americanus")
tree &lt;- text_placr(tree, mrca_df)
echo_sub &lt;- echo_subtree(tree, mrca_list, "Ursus_abstrusus")
</code></pre>

<hr>
<h2 id='fileformat'>Utility function to check if file is a csv or tsv.</h2><span id='topic+fileformat'></span>

<h3>Description</h3>

<p>Utility function to check if file is a csv or tsv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fileformat(dataf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fileformat_+3A_dataf">dataf</code></td>
<td>
<p>Path to input file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='genera_strippr'>Check if tip is on tree</h2><span id='topic+genera_strippr'></span>

<h3>Description</h3>

<p>Test which taxa in the total set of taxa are present on the
tree, and which need to be added. The tax_frame object is assumed to be a dataframe, minimally with a column labeled &quot;taxon&quot;. If this column does not exist, the first column in the dataframe will be assumed to contain the taxon information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genera_strippr(tree, tax_frame)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genera_strippr_+3A_tree">tree</code></td>
<td>
<p>Starting phylogeny, of type phylo</p>
</td></tr>
<tr><td><code id="genera_strippr_+3A_tax_frame">tax_frame</code></td>
<td>
<p>Total set of taxa on tree, as dataframe.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>absent_list of taxa that are present in the total set of trees, but not the starting tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>absent_taxa &lt;- genera_strippr(tree, tax_frame = tax_frame)
</code></pre>

<hr>
<h2 id='get_found'>Get dataframe of tips that do not have congeners on tree.</h2><span id='topic+get_found'></span>

<h3>Description</h3>

<p>Determine which tips that are not on the tree, and checks if they have congeners
on the tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_found(absent_list, tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_found_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the tree</p>
</td></tr>
<tr><td><code id="get_found_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>found_df Dataframe objects expressing the tips that are not
on the tree, if they have congeners on the tree
</p>


<h3>Examples</h3>

<pre><code class='language-R'>has_congeners &lt;- treestartr:::get_found(absent_list, tree)
</code></pre>

<hr>
<h2 id='get_lost'>Determine if a tip is present on a tree</h2><span id='topic+get_lost'></span>

<h3>Description</h3>

<p>Determine which tips that are not on the tree, puts them in a dataframe if they
do not have congeners on the tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lost(absent_list, tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_lost_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the tree</p>
</td></tr>
<tr><td><code id="get_lost_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>not_found_df Dataframe objects expressing the tips that are not
on the tree, and don&quot;t have congeners
</p>


<h3>Examples</h3>

<pre><code class='language-R'>no_congeners &lt;- treestartr:::get_lost(absent_list, tree)
</code></pre>

<hr>
<h2 id='make_absentdf'>Determine which tips are not on the tree, and get their genera.</h2><span id='topic+make_absentdf'></span>

<h3>Description</h3>

<p>Determine which tips are not on the tree, and get their genera.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_absentdf(absent_list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_absentdf_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>absent_df Dataframe objects expressing which tips are in the total set
but not the tree, and their genera
</p>


<h3>Examples</h3>

<pre><code class='language-R'>not_present &lt;- treestartr:::make_absentdf(absent_list)
</code></pre>

<hr>
<h2 id='make_treedf'>Determine which tips are on the tree, and get their genera.</h2><span id='topic+make_treedf'></span>

<h3>Description</h3>

<p>Determine which tips are on the tree, and get their genera.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_treedf(tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_treedf_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree_df Dataframe objects expressing the tips, and their genera
</p>

<hr>
<h2 id='present_tippr'>Add tips to the tree based on taxonomy.</h2><span id='topic+present_tippr'></span>

<h3>Description</h3>

<p>Add tips not on existing tree to the tree via an MRCA node,
if they have congeners. This function will look to see if any tips on the
tree have the same genus as the tip to be added. If there are multiple
members of the genus, the tip will be added subtending the MRCA of all
present congeners. If there is member of the genus, the tip will be added
subtending the parent node of the congener.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>present_tippr(tree, absent_list, echo_subtrees = NULL,
  echo_revbayes = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="present_tippr_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
<tr><td><code id="present_tippr_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the tree</p>
</td></tr>
<tr><td><code id="present_tippr_+3A_echo_subtrees">echo_subtrees</code></td>
<td>
<p>Boolean; Print newick subtree with missing taxa added to screen. Default FALSE.</p>
</td></tr>
<tr><td><code id="present_tippr_+3A_echo_revbayes">echo_revbayes</code></td>
<td>
<p>Boolean; Print clade constraints with missing taxa added to screen, formatted for RevBayes fossilized birth-death analysis. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree. Phylo object containing the starting tree,
and all tips that were added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>genera_tree &lt;- present_tippr(tree, absent_list)
</code></pre>

<hr>
<h2 id='rand_absent_tippr'>Random addition of taxa</h2><span id='topic+rand_absent_tippr'></span>

<h3>Description</h3>

<p>Add tips not on existing tree to the tree at random, if they do
not have congeners on the tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rand_absent_tippr(tree, absent_list, echo_subtrees = NULL,
  echo_revbayes = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rand_absent_tippr_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
<tr><td><code id="rand_absent_tippr_+3A_absent_list">absent_list</code></td>
<td>
<p>Vector of taxa in the total dataset that are not on the
tree</p>
</td></tr>
<tr><td><code id="rand_absent_tippr_+3A_echo_subtrees">echo_subtrees</code></td>
<td>
<p>Boolean; Print newick subtree with missing taxa added to screen. Default FALSE.</p>
</td></tr>
<tr><td><code id="rand_absent_tippr_+3A_echo_revbayes">echo_revbayes</code></td>
<td>
<p>Boolean; Print clade constraints with missing taxa added to screen, formatted for RevBayes fossilized birth-death analysis. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree Phylo object containing the starting tree,
and all tips that were added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>new_tree &lt;- rand_absent_tippr(tree, absent_list)
</code></pre>

<hr>
<h2 id='taxon_testr'>Utility function to check taxon_names in parsed data file</h2><span id='topic+taxon_testr'></span>

<h3>Description</h3>

<p>Utility function to check taxon_names in parsed data file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_testr(tax_frame)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taxon_testr_+3A_tax_frame">tax_frame</code></td>
<td>
<p>Dataframe of taxa parsed from datafile.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='text_placr'>Add tips to tree via taxon list</h2><span id='topic+text_placr'></span>

<h3>Description</h3>

<p>Add tips according to csv or tsv file of taxon names and taxa
that form the clade into which you&quot;d like to insert the tip. One column
should be called 'taxon', and should contain the taxon to be placed. The
other column should be called 'clade' and contain the taxon with which the
taxon to be placed will form a group. Each member of the clade will be
placed on its own line. An example of this file can be seen in 'inst/extdat
a/mrca_df.tsv'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>text_placr(tree, mrca_df, echo_subtrees = NULL, echo_revbayes = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="text_placr_+3A_tree">tree</code></td>
<td>
<p>Starting tree; object of type phylo</p>
</td></tr>
<tr><td><code id="text_placr_+3A_mrca_df">mrca_df</code></td>
<td>
<p>Dataframe containing a column of the taxa you'd like to place and one column with the clade into which you'd like to place it</p>
</td></tr>
<tr><td><code id="text_placr_+3A_echo_subtrees">echo_subtrees</code></td>
<td>
<p>Boolean; Print newick subtree with missing taxa added to screen. Default FALSE.</p>
</td></tr>
<tr><td><code id="text_placr_+3A_echo_revbayes">echo_revbayes</code></td>
<td>
<p>Boolean; Print clade constraints with missing taxa added to screen, formatted for RevBayes fossilized birth-death analysis. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tree Phylo object containing the starting tree,
and all tips that were added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>text_placr(tree, mrca_df)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
