<!DOCTYPE html><html><head><title>Help for package MLDS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLDS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MLDS-package'>
<p>~~ MLDS ~~ Maximum Likelihood Differerence Scaling</p></a></li>
<li><a href='#as.mlds.df'><p> Coerces a data.frame to mlds.df</p></a></li>
<li><a href='#AutumnLab'><p>Difference Scale Judgement Data Set</p></a></li>
<li><a href='#binom.diagnostics'><p> Diagnostics for Binary GLM</p></a></li>
<li><a href='#boot.mlds'><p> Resampling of an Estimated Difference Scale</p></a></li>
<li><a href='#DisplayOneQuad'><p> Helper Functions for Perception of Correlation Difference Scale Experiment</p></a></li>
<li><a href='#fitted.mlds'><p> Fitted Responses for a Difference Scale</p></a></li>
<li><a href='#Get6pts'><p>Find All 6-point Conditions in data.frame</p></a></li>
<li><a href='#ix.mat2df'><p>Transform data.frame back to Raw Difference Scale Format</p></a></li>
<li><a href='#kk'><p>Difference Scale Judgment Data Sets</p></a></li>
<li><a href='#lik6pt'><p> Compute Log Likelihood for 6-point Test</p></a></li>
<li><a href='#logLik.mlds'><p> Compute Log-Likelihood for an mlds object</p></a></li>
<li><a href='#make.ix.mat'><p>Create data.frame for Fitting Difference Scale by glm</p></a></li>
<li><a href='#mlds'><p>Fit Difference Scale by Maximum Likelihood</p></a></li>
<li><a href='#plot.mlds'><p> Plot a mlds Object</p></a></li>
<li><a href='#pmc'><p> Proportion of Misclassifications According to an Estimated MLDS Fit</p></a></li>
<li><a href='#predict.mlds'><p>Predict method for MLDS Fits</p></a></li>
<li><a href='#print.mlds'><p> Difference Scale default print statement</p></a></li>
<li><a href='#rbind.mlds.df'><p> Concatenate Objects of Class 'mlbs.df' or 'mlds.df' by Row</p></a></li>
<li><a href='#runQuadExperiment'><p>Start and run a Difference Scale Experiment</p></a></li>
<li><a href='#SimMLDS'>
<p>Simulate Output of MLDS Experiment</p></a></li>
<li><a href='#simu.6pt'><p>Perform Bootstrap Test on 6-point Likelihood for MLDS FIT</p></a></li>
<li><a href='#summary.mlds'><p>Summary for a mlds fit</p></a></li>
<li><a href='#summary.mlds.bt'>
<p>Method to Extract Bootstrap Values for MLDS Scale Values</p></a></li>
<li><a href='#SwapOrder'><p>Order Stimuli and Adjust  Responses from Difference Scaling</p>
data.frame</a></li>
<li><a href='#Transparency'>
<p>Difference Scaling of Transparency</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Difference Scaling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Kenneth Knoblauch and Laurence T. Maloney, 
  based in part on C code written by Laurence T. Maloney 
  and J. N. Yang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kenneth Knoblauch &lt;ken.knoblauch@inserm.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), graphics, stats, utils, base</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Difference scaling is a method for scaling perceived 
  supra-threshold differences.  The package contains functions that
  allow the user to design and run a difference scaling experiment, 
  to fit the resulting data by maximum likelihood and test the
  internal validity of the estimated scale.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-20 08:05:36 UTC; ken</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-20 08:22:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='MLDS-package'>
~~ MLDS ~~ Maximum Likelihood Differerence Scaling
</h2><span id='topic+MLDS-package'></span><span id='topic+MLDS'></span>

<h3>Description</h3>

<p>Difference scaling is a method for scaling perceived supra-threshold differences.
The package contains functions that allow the user to design and run a difference scaling experiment and to fit the resulting data by maximum likelihood. 
</p>


<h3>Details</h3>

<p>The package provides a function, <code>mlds</code> for estimating a perceptual scale using the data obtained from one or several difference scaling experiments.  A second function, <code>simu.6pt</code> permits the interval validity of the scale to be evaluated using a bootstrap method.  Several methods are supplied for accessing and examining the &lsquo;mlds&rsquo; object generated by estimating the scale.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney <br />
</p>
<p>Maintainer: Ken Knoblauch <a href="mailto:ken.knoblauch@inserm.fr">ken.knoblauch@inserm.fr</a>
</p>


<h3>References</h3>

<p>Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>.
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MLDS)
data(kk1)  # data for one subject for 330 trials of the same experiment
plot(mlds(kk1)) # fit and plot the fitted difference scale
</code></pre>

<hr>
<h2 id='as.mlds.df'> Coerces a data.frame to mlds.df </h2><span id='topic+df2mlds.df'></span><span id='topic+as.mlds.df'></span><span id='topic+as.mlds.df.data.frame'></span><span id='topic+as.mlbs.df.data.frame'></span><span id='topic+as.mlbs.df'></span>

<h3>Description</h3>

<p>Coerce a data frame from an MLDS experiment to an object of class <code>mlbs.df</code> or <code>mlds.df</code> by adding column names and attributes so that it will be properly treated by methods related to the MLDS functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.mlds.df(d, ...)
as.mlbs.df(d, ...)

## S3 method for class 'data.frame'
as.mlds.df(d, st, ...)
## S3 method for class 'data.frame'
as.mlbs.df(d, st, ...)


df2mlds.df(d, st)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.mlds.df_+3A_d">d</code></td>
<td>
<p> a 4 or 5 column data frame from an MLDS experiment, with one column of responses followed by three or four, respectively, indicating the indices of the stimuli from each trial or a data frame of &gt; 5 columns with the response in the first column and the covariates (signed indicator variables) for the stimuli of each trial in the rest of the columns </p>
</td></tr>
<tr><td><code id="as.mlds.df_+3A_st">st</code></td>
<td>
<p>numeric indicating the stimulus levels from the MLDS experiment </p>
</td></tr>
<tr><td><code id="as.mlds.df_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function coerces a data frome from an MLDS experiment to an object of class <code>mlbs.df</code> or <code>mlds.df</code> but inheriting from class <code>data.frame</code>.  It changes the column names to <code>resp</code> and
<code>S1</code>, <code>S2</code>, <code>S3</code> and if a quad experiment, <code>S4</code> and adds two attributes:  <code>stimulus</code>, a vector of scale values used in plotting the estimated scale and <code>invord</code>, a logical vector indicating the order of the presentation of pairs (were the larger scale values on the bottom or not) which is used with the <code>SwapOrder</code> function.
Note that when the argument is in signed indicator form, just a data frame is returned with no special <code>mlds</code> attributes.
</p>


<h3>Value</h3>

<p><code>data.frame</code> of class <code>mlbs.df</code> or <code>mlds.df</code> with <code>stimulus</code> and <code>invord</code> attributes, unless the input is in signed indicator form.  See details.
</p>


<h3>Note</h3>

<p> If the scale starts at 0, then 1 should be added to each scale value because the scale values will be used as indices and <code>R</code> indices start at 1, not 0.
</p>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch </p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code> </p>

<hr>
<h2 id='AutumnLab'>Difference Scale Judgement Data Set</h2><span id='topic+AutumnLab'></span>

<h3>Description</h3>

<p>Judgments and stimulus ranks for one observer during one session from a difference scaling experiment.  On each trial, the observer is presented with 4 stimuli <code class="reqn">(a, b, c, d)</code> from a physical scale with <code class="reqn">a &lt; b &lt; c &lt; d</code>.  The stimuli are presented as two pairs <code class="reqn">(a, b)</code> and <code class="reqn">(c, d)</code> and the observer judges between which pair the perceived difference is greater.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AutumnLab)</code></pre>


<h3>Format</h3>

<p>A data frame with 210 observations on the following 5 variables.
</p>

<dl>
<dt><code>resp</code></dt><dd><p>an integer vector of 0, 1, indicating the choice of the observer between the pairs (<code>S1</code>, <code>S2</code>) vs (<code>S3</code>, <code>S4</code>)</p>
</dd>
<dt><code>S1</code></dt><dd><p>an integer vector, rank order of physical stimulus level for the lowest/weakest stimulus</p>
</dd>
<dt><code>S2</code></dt><dd><p>an integer vector, rank order of physical stimulus 2</p>
</dd>
<dt><code>S3</code></dt><dd><p>an integer vector, rank order of physical stimulus 3</p>
</dd>
<dt><code>S4</code></dt><dd><p>an integer vector, rank order of higher/strongest stimulus</p>
</dd>
</dl>



<h3>Details</h3>

<p>The difference scaling paradigm was used to estimate changes of image quality with increasing rate of image compression.  Image compression was performed using Vector Quantisation and the standard Lab color space.  In the overall experiment, the compression was performed for several images and in several different color spaces.  Scales were obtained from several observers, as well.  These data are from one observer, for one image with compression performed in the Lab color space.  The 10 compression levels tested  were 1 (no compression), and 6-30% reduction in file size in steps of 3.  The physical stimulus levels are attached to the data.frame as an attribute, <code>stimulus</code>.  There is also an attribute, <code>invord</code>, which is a vector of type logical of length 210, which can be used with <code>SwapOrder</code> to restore the order of the pairs to correspond to physical position (lower/upper) in the experiment, rather than the way it is stored, stimulus level (lower/higher compression). 
</p>


<h3>References</h3>

<p>Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>.
</p>
<p>Charrier, C., Maloney, L. T., Cherifi, H. &amp; Knoblauch, K. (2007) 
Maximum likelihood difference scaling of image quality in 
compression-degraded images, 
<em>Journal of the Optical Society of America</em>, <b>24</b>, 3418&ndash;3426.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AutumnLab)
plot(mlds(AutumnLab))
</code></pre>

<hr>
<h2 id='binom.diagnostics'> Diagnostics for Binary GLM</h2><span id='topic+binom.diagnostics'></span><span id='topic+plot.mlds.diag'></span>

<h3>Description</h3>

<p>Two techniques for evaluating the adequacy of the binary glm model used in <code>mlds</code>, based on code in Wood (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.diagnostics(obj, nsim = 200, type = "deviance", no.warn = TRUE)

## S3 method for class 'mlds.diag'
plot(x, alpha = 0.025, breaks = "Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.diagnostics_+3A_obj">obj</code></td>
<td>
<p>list of class &lsquo;mlds&rsquo; typically generated by a call to the <code>mlds</code> </p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_nsim">nsim</code></td>
<td>
<p> integer giving the number of sets of data to simulate </p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_type">type</code></td>
<td>
<p>character indicating type of residuals.  Default is deviance residuals.  See <code><a href="stats.html#topic+residuals.glm">residuals.glm</a></code> for other choices </p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_no.warn">no.warn</code></td>
<td>
<p>logical indicating when TRUE (default) to suppress warnings from <code>glm</code></p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_x">x</code></td>
<td>
<p>list of class &lsquo;mlds.diag&rsquo; typically generated by a call to <code>binom.diagnostics</code></p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_alpha">alpha</code></td>
<td>
<p>numeric between 0 and 1, the envelope limits for the cdf of the deviance residuals</p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_breaks">breaks</code></td>
<td>
<p>character or numeric indicating either the method for calculating the number of breaks or the suggested number of breaks to employ.  See <code><a href="graphics.html#topic+hist">hist</a></code> for more details.</p>
</td></tr>
<tr><td><code id="binom.diagnostics_+3A_...">...</code></td>
<td>
<p>additional parameters specifications for the empirical cdf plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wood (2006) describes two diagnostics of the adequacy of a binary glm model based on analyses of residuals (see, p. 115, Exercise 2 and his solution on pp 346-347).  The first one compares the empirical cdf of the deviance residuals to a bootstrapped confidence envelope of the curve.  The second examines the number of runs in the sorted residuals with those expected on the basis of independence in the residuals, again using a resampling based on the models fitted values. The plot method generates two graphs, the first being the empirical cdf and the envelope.  The second is a histogram of the number of runs from the bootstrap procedure with the observed number indicated by a vertical line.  Currently, this only works if the &lsquo;glm&rsquo; method is used to perform the fit and <em>not</em> the &lsquo;optim&rsquo; method
</p>


<h3>Value</h3>

<p><code>binom.diagnostics</code> returns a list of class &lsquo;mlds.diag&rsquo; with components
</p>
<table>
<tr><td><code>NumRuns</code></td>
<td>
<p>integer vector giving the number of runs obtained for each simulation</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>numeric matrix giving the sorted deviance residuals in each column from each simulation</p>
</td></tr>
<tr><td><code>Obs.resid</code></td>
<td>
<p>numeric vector of the sorted observed deviance residuals</p>
</td></tr>
<tr><td><code>ObsRuns</code></td>
<td>
<p>integer giving the observed number of runs in the sorted deviance residuals</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>numeric giving the proportion of runs in the simulation less than the observed value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ken Knoblauch </p>


<h3>References</h3>

<p>Wood, SN <em>Generalized Additive Models: An Introduction with R</em>, Chapman &amp; Hall/CRC, 2006 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(kk1)
kk1.mlds &lt;- mlds(kk1)
kk1.diag &lt;- binom.diagnostics(kk1.mlds)
plot(kk1.diag)

## End(Not run)
</code></pre>

<hr>
<h2 id='boot.mlds'> Resampling of an Estimated Difference Scale </h2><span id='topic+boot.mlds'></span><span id='topic+boot.mlbs'></span>

<h3>Description</h3>

<p>Using the <code>fitted</code> responses (probabilities) to the difference scale, new responses are generated which permit new bootstrap replications of estimated scales to be generated. The mean scale is useful for evaluating bias and the standard deviation for estimating standard errors of the scale values. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.mlds(x, nsim, no.warn = TRUE, ...)
boot.mlbs(x, nsim, no.warn = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot.mlds_+3A_x">x</code></td>
<td>
<p> an object of class &lsquo;mlds&rsquo; or &lsquo;mlbs&rsquo; depending on which function is called.</p>
</td></tr>
<tr><td><code id="boot.mlds_+3A_nsim">nsim</code></td>
<td>
<p> an integer, the number of simulations. </p>
</td></tr>
<tr><td><code id="boot.mlds_+3A_no.warn">no.warn</code></td>
<td>
<p>logical indicating when TRUE (default) to suppress warnings from <code>glm</code></p>
</td></tr>
<tr><td><code id="boot.mlds_+3A_...">...</code></td>
<td>
<p> Additional options passed along to the function <code>mlds</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either the scale values (from &lsquo;glm&rsquo; method) or the scale values and <code class="reqn">\sigma</code> (from &lsquo;optim&rsquo; method) permit the fitted probabilities to be estimated.  These are used to generate new responses to the quadruples using <code>rbinom</code>.  The new responses are then used with <code>mlds</code> to estimate a bootstrapped scale.  This is repeated <code class="reqn">N</code> times and stored in the output with the mean and standard deviation of the bootstrapped scales.
</p>


<h3>Value</h3>

<p>A list of 4 elements of class &lsquo;mlds.bt&rsquo;:  
</p>
<table>
<tr><td><code>boot.samp</code></td>
<td>
<p>A <code class="reqn">p + 1</code> x <code class="reqn">N</code> matrix of the bootstrap samples of the scale, where p is the number of scale values and N is the number of simulations. The extra value is the bootstrapped <code class="reqn">sigma</code> value.  </p>
</td></tr>
<tr><td><code>bt.mean</code></td>
<td>
<p>A vector of length <code class="reqn">p + 1</code> giving the mean of the bootstrap scales.</p>
</td></tr>
<tr><td><code>bt.sd</code></td>
<td>
<p>A vector of length <code class="reqn">p + 1</code> giving the standard deviation of the boostrap scales. </p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The number of bootstrap simulations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585,  <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
	kk1.mlds &lt;- mlds(kk1)
	#nsim should be near 10,000 for stability,
	# but this will take a little time
	boot.mlds(kk1.mlds, 100)
</code></pre>

<hr>
<h2 id='DisplayOneQuad'> Helper Functions for Perception of Correlation Difference Scale Experiment </h2><span id='topic+DisplayOneQuad'></span><span id='topic+DisplayOneTriad'></span><span id='topic+DefineMyScale'></span>

<h3>Description</h3>

<p>These functions are required by <code>runTriadExperiment</code> and <code>runQuadExperiment</code> to define and display trials.  They are provided as examples, and users are expected to define their own functions to define and display stimuli for estimating difference scales along other physical continua.  <code>DefineMyScale</code> returns a numeric vector providing the physical levels to be tested (here values of <code class="reqn">r</code>).  <code>DisplayOneQuad</code> produces a 2 x 2 graphic of four scatterplots. <code>DisplayOneTriad</code> produces a 1 x 3 graphic of three scatterplots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DisplayOneQuad(rr, PntNum = 100, ptSize = 1, 
	xlim = c(-4, 4), ylim = c(-4, 4))
DisplayOneTriad(rr, PntNum = 100, ptSize = 1, 
	xlim = c(-4, 4), ylim = c(-4, 4))
DefineMyScale(rr = c(seq(0, 0.9, len = 10), 0.98))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DisplayOneQuad_+3A_rr">rr</code></td>
<td>
<p>vector of numeric or integer.  For <code>DisplayOneTrial</code>, a four element vector of integers, providing the indices of the physical scale values to be displayed.  For <code>DefineMyScale</code>, a numeric vector, providing the physical scale values to be tested.</p>
</td></tr>
<tr><td><code id="DisplayOneQuad_+3A_pntnum">PntNum</code></td>
<td>
<p>numeric giving the number of points to be displayed in each subgraphic.</p>
</td></tr>
<tr><td><code id="DisplayOneQuad_+3A_ptsize">ptSize</code></td>
<td>
<p>numeric indicating the size of the points in each graphic, passed to the <code>cex</code> argument of <code>plot</code>.</p>
</td></tr>
<tr><td><code id="DisplayOneQuad_+3A_xlim">xlim</code>, <code id="DisplayOneQuad_+3A_ylim">ylim</code></td>
<td>
<p>2-element numerics to determine range of values plotted on the display.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>DisplayOneTriad</code> and <code>DisplayOneQuad</code> are used for their side-effect of producing a stimulus on the display.  <code>DefineMyScale</code> outputs a numeric vector of the physical scale.  While its use here is quite trivial, in general, it permits the tailoring of the stimulus levels to the particular experiment.  In the present case, one could imagine, for example, modifying it so that successive levels were evenly spaced in <code class="reqn">r^2</code> rather than <code class="reqn">r</code>.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney</p>


<h3>See Also</h3>

 <p><code><a href="#topic+runTriadExperiment">runTriadExperiment</a></code>, <code><a href="#topic+runQuadExperiment">runQuadExperiment</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: runQuadExperiment(DisplayTrial = "DisplayOneQuad", 
		DefineStimuli = "DefineMyScale")
## End(Not run)

</code></pre>

<hr>
<h2 id='fitted.mlds'> Fitted Responses for a Difference Scale </h2><span id='topic+fitted.mlds'></span><span id='topic+fitted.mlbs'></span>

<h3>Description</h3>

<p><code>fitted.mlds</code> returns the fitted responses from an estimated difference scale obtained by <code>mlds</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
fitted(object, ...)

## S3 method for class 'mlbs'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.mlds_+3A_object">object</code></td>
<td>
<p>object of class &lsquo;mlds&rsquo; or &lsquo;mlbs&rsquo;, typically obtained from the output of <code>mlds</code>. </p>
</td></tr>
<tr><td><code id="fitted.mlds_+3A_...">...</code></td>
<td>
<p>currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector contained the fitted probabilities to the responses of the observer for each quadruple.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. </p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code>, <code><a href="#topic+predict.mlds">predict.mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
data(kk2)
data(kk3)
fitted(mlds(SwapOrder(rbind(kk1, kk2, kk3))))
</code></pre>

<hr>
<h2 id='Get6pts'>Find All 6-point Conditions in data.frame</h2><span id='topic+Get6pts'></span>

<h3>Description</h3>

<p><code>Get6pts</code> enumerates all 6-point conditions from a difference scaling experiment and is used as one of the input arguments for calculating an observer's likelihood for his performance on 6-point conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get6pts(x, nrep, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Get6pts_+3A_x">x</code></td>
<td>
<p> an object of class &lsquo;mlds&rsquo;.</p>
</td></tr>
<tr><td><code id="Get6pts_+3A_nrep">nrep</code></td>
<td>
<p> integer indicating how many sessions are in the data set.</p>
</td></tr>
<tr><td><code id="Get6pts_+3A_...">...</code></td>
<td>
<p>Possibility of sending additional arguments but currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 6-point condition is defined on 6-tuples of points, a, b, c, a', b', c', ordered on a physical scale.  The condition requires that if the pair <code class="reqn">(a, b) &gt; (a', b')</code> and the pair <code class="reqn">(b, c) &gt; (b', c')</code>, then <code class="reqn">(a, c) &gt; (a', c')</code>.
</p>


<h3>Value</h3>

<p>A list of three same size data.frames with an attribute, <code>indices</code> that is a three column data.frame with the same number of rows as each of the three data.frames.  Each data.frame is of the format from a difference scaling experiment. Same named rows indicate three trials that form a 6-point condition, i.e., given the 6-tuple of stimuli, a, b, c, a', b', c',
</p>
<table>
<tr><td><code>A</code></td>
<td>
<p>data.frame indicating the trials (a, b) vs (a', b')</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>data.frame indicating the trials (b, c) vs (b', c')</p>
</td></tr>
<tr><td><code>E</code></td>
<td>
<p>data.frame indicating the trials (a, c) vs (a', c')</p>
</td></tr>
</table>
<p>The attribute gives the row numbers from which the trials were obtained from the original data.frame.
</p>


<h3>Note</h3>

<p>It is important that the stimuli are in physical order and not the experimental order. If in experimental order, then <code>SwapOrder</code> should be applied first.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>References</h3>

<p>Maloney, L. T. and Yang, J. N. (2003) Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SwapOrder">SwapOrder</a></code>,  <code><a href="#topic+lik6pt">lik6pt</a></code>,  <code><a href="#topic+simu.6pt">simu.6pt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
kk.6pt &lt;- Get6pts(mlds(SwapOrder(kk1)), nrep = 1)

</code></pre>

<hr>
<h2 id='ix.mat2df'>Transform data.frame back to Raw Difference Scale Format</h2><span id='topic+ix.mat2df'></span>

<h3>Description</h3>

<p><code>ix.mat2df</code> converts a long data.frame that is used as the data argument for <code>mlds</code> with  method = &ldquo;glm&rdquo; to the 5 column format, typically from the results of a difference scaling experiment.  The first column is the response and the next four are the ranks of the stimulus levels used in each trial, the 2 pairs.  <code>ix.mat2df</code> is the inverse of <code>make.ix.mat</code>.  This form of data.frame is used with the &ldquo;optim&rdquo; method of <code>mlds</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ix.mat2df(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ix.mat2df_+3A_d">d</code></td>
<td>
<p> a data.frame with <code class="reqn">p</code> columns and <code class="reqn">n</code> rows, where <code class="reqn">p</code> is the number of stimulus levels and <code class="reqn">n</code> is the number of trials. The first column is the <code>resp</code>, 0 or 1, and the next <code class="reqn">p - 1</code> columns correspond to the incidences of the stimulus levels on each trial, 3 or 4 per row, with the signs <code class="reqn">+ - - +</code>.  The column corresponding to the lowest level stimulus is deleted, as its coefficient is contrained to equal 0 in the current parameterization of the problem.  Thus, 3 non-zero terms would be of the form <code class="reqn"> - - +</code>, indicating the presence of the lowest level stimulus in the trial. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 5 column data.frame which could be coerced to interger. 
</p>
<table>
<tr><td><code>resp</code></td>
<td>
<p>The response, 0 or 1, indicating which pair was chosen</p>
</td></tr>
<tr><td><code>S1-S4</code></td>
<td>
<p>The rank of the 4 stimulus levels presented on each trial.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>See Also</h3>

<p><code><a href="#topic+make.ix.mat">make.ix.mat</a></code>,  <code><a href="#topic+mlds">mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>	
data(AutumnLab)
ix.mat &lt;- make.ix.mat(AutumnLab)
#orig.df &lt;- ix.mat2df(ix.mat) # should be the same as original
# better to use as.mlds.df as ix.mat2df is deprecated
orig.df &lt;- as.mlds.df(ix.mat) 

</code></pre>

<hr>
<h2 id='kk'>Difference Scale Judgment Data Sets</h2><span id='topic+kk'></span><span id='topic+kk1'></span><span id='topic+kk2'></span><span id='topic+kk3'></span><span id='topic+kktriad'></span>

<h3>Description</h3>

<p>Three data sets for one subject in a sample difference scaling experiment. The stimuli were scatterplots of bivariate Gaussian samples with different correlations. Either the function <code>runQuadExperiment</code> or <code>runTriadExperiment</code> was used to collect the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(kk1)
	data(kk2)
	data(kk3)
	data(kktriad)</code></pre>


<h3>Format</h3>

<p>Four data frames, (kk1, kk2, kk3, kktriad) with 330, or in the case of kktriad 165, observations each with the following 5 (4 for kktriad) components.
</p>

<dl>
<dt><code>resp</code></dt><dd><p>a numeric vector taking on values 0 and 1 indicating responses of observer</p>
</dd>
<dt><code>S1</code></dt><dd><p>a numeric vector, rank order of weakest stimulus on the physical scale.</p>
</dd>
<dt><code>S2</code></dt><dd><p>a numeric vector, rank order of physical stimulus 2.</p>
</dd>
<dt><code>S3</code></dt><dd><p>a numeric vector, rank order of physical stimulus 3.</p>
</dd>
<dt><code>S4</code></dt><dd><p>a numeric vector, rank order of strongest stimulus on the physical scale. <code>kktriad</code> does not contain this component as it is from an experiment with triads rather than quadruples</p>
</dd>
</dl>



<h3>Details</h3>

<p> The kk1-3 datasets were generated on three separate days using the function
<code>runQuadExperiment</code> with <code>DisplayOneQuad</code> and <code>DefineMyScale</code> to define the stimuli and display them, anti-respectively.  The experiments were run on a Macintosh Pro with a 15 inch screen.  The observer was seated about 40 cm from the screen. The kktriad data set was generated from one run using the function <code>runTriadExperiment</code> with <code>DisplayOneTriad</code> to control the display.
</p>


<h3>References</h3>

<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
plot(mlds(SwapOrder(kk1))) 
# Fit and plot difference scale for first data set kk1, 
#  using quadruples of stimuli

data(kktriad)
plot(mlds(kktriad), type = "b") 
# Fit and plot experimental data 
#   using triples of stimuli
</code></pre>

<hr>
<h2 id='lik6pt'> Compute Log Likelihood for 6-point Test </h2><span id='topic+lik6pt'></span>

<h3>Description</h3>

<p>The 6-point test evaluates the validity of the estimated difference scale.  Given 6 values, a, b, c, a', b', c', on the stimulus scale, if the pair <code class="reqn">(a, b) &gt; (a', b')</code> and <code class="reqn">(b, c) &gt; (b', c')</code> then it must be that <code class="reqn">(a, c) &gt; (a', c')</code>, where the symbol <code class="reqn">&gt;</code> is taken here to mean &ldquo;is judged more different than&rdquo;. Given the observer's difference scale and <code class="reqn">\sigma</code> estimate, the likelihood of the choices made is calculated based on the link function indicated in the &lsquo;mlds&rsquo; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik6pt(x, Six.Pts, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lik6pt_+3A_x">x</code></td>
<td>
<p>an object of class 'mlds', typically created by <code>mlds</code> </p>
</td></tr>
<tr><td><code id="lik6pt_+3A_six.pts">Six.Pts</code></td>
<td>
<p> a list of 3 data.frames, with names <code>A</code>, <code>B</code>, <code>E</code>. Each data.frame corresponds to a sample from a difference scaling experiment.  The corresponding rows of the three data.frames yield the triples of trials that provide a 6-point test.  The list can be constructed with the function <code>GetSixPts</code>. </p>
</td></tr>
<tr><td><code id="lik6pt_+3A_...">...</code></td>
<td>
<p> currently unused. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the likelihood of the observer's responses for all of the 6-point conditions from a given data set. As currently implemented, it returns a 1x1 matrix.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch, based on C code by Laurence T. Maloney and J. N. Yang.</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Get6pts">Get6pts</a></code>, <code><a href="#topic+mlds">mlds</a></code>,
<code><a href="#topic+simu.6pt">simu.6pt</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(kk1)
x.df &lt;- mlds(SwapOrder(kk1))
lik6pt(x.df, Get6pts(x.df, nrep = 1))

</code></pre>

<hr>
<h2 id='logLik.mlds'> Compute Log-Likelihood for an mlds object</h2><span id='topic+logLik.mlds'></span><span id='topic+logLik.mlbs'></span>

<h3>Description</h3>

<p>This function provides a method for extracting the log likelihood from an object of class &lsquo;mlds&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
logLik(object, ...)
## S3 method for class 'mlbs'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.mlds_+3A_object">object</code></td>
<td>
<p>an object of class &lsquo;mlds&rsquo; or  &lsquo;mlbs&rsquo;typically from a call to <code>mlds</code></p>
</td></tr>
<tr><td><code id="logLik.mlds_+3A_...">...</code></td>
<td>
<p>for passing additional parameters, but is currently not used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &lsquo;logLik&rsquo; whose value is the logarithm of the likelihood with attribute <code>df</code> providing the degrees of freedom
</p>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
logLik(mlds(SwapOrder(kk1)))
</code></pre>

<hr>
<h2 id='make.ix.mat'>Create data.frame for Fitting Difference Scale by glm </h2><span id='topic+make.ix.mat'></span>

<h3>Description</h3>

<p><code>make.ix.mat</code> generates a <code class="reqn">n x p</code> matrix from the <code class="reqn">n x 5</code> column data.frame storing the results of a difference scaling experiment, where <code class="reqn">p</code> is the number of stimulus levels tested and <code class="reqn">n</code> is the number of trials.  The first column is the response (0 or 1), and the <code class="reqn">p - 1</code> succeeding columns code covariates for all but the first stimulus level, which is contrained to be 0. These columns take the value 0 unless the stimulus level was in the trial, in which case they take, in order, the values, 1, -1, -1, 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.ix.mat(data, xi = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.ix.mat_+3A_data">data</code></td>
<td>
<p>a 5 column data.frame.  The first column is the <code>resp</code> and the next 4 columns the index of the stimulus level, 1 to <code class="reqn">p</code>, labelled <code>S1-S4</code></p>
</td></tr>
<tr><td><code id="make.ix.mat_+3A_xi">xi</code></td>
<td>
<p>an integer indicating the number of stimulus levels tested.  If this is NULL, it is determined from the maximum value in <code>data</code>.</p>
</td></tr>
<tr><td><code id="make.ix.mat_+3A_...">...</code></td>
<td>
<p>Other arguments, not used for the moment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To fit a difference scale using <code>mlds</code> and <code>method</code> = &ldquo;glm&rdquo;, each stimulus level is treated as a covariate taking on the values 0, if it was not present in the trial, or -1 or 1, the latter two depending on the ordinal stimulus level within the trial.  This is a helper function to transform the typical 5 column data.frame from a difference scaling experiment, indicating the response and the 4 stimulus levels, to one in the format described above.  Matrices of this form can also be used as <code>newdata</code> for the predict method.  This is exploited in the function <code>like6pt</code>.  It is here that the argument <code>xi</code> is necessary since the data.frame for the first of the 6-point comparisons does not contain the highest level of the scale and so needs to be specified so that the data.frame conforms with that used to generate the &lsquo;mlds&rsquo; object.
</p>


<h3>Value</h3>

<p>A data.frame with<code class="reqn">n</code> rows and <code class="reqn">p</code> columns.
</p>
<table>
<tr><td><code>resp</code></td>
<td>
<p>The <code>resp</code> (0, 1) is coded in the first column.  This could be logical, instead.</p>
</td></tr>
<tr><td><code>stim.2--stim.p</code></td>
<td>
<p>Columns 2 through <code class="reqn">p</code> code the
presence and absence of the stimulus on a trial.  If the stimulus is present, then the value is -1 or 1 as a function of the contribution of the stimulus level to the decision variable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> In the current parameterization, the coefficient of the initial stimulus level is constrained to 0.  Thus, the column corresponding to this level is left-out of the data.frame.  For trials in which this stimulus is present, the non-zero elements are (-1, -1, 1), in that order.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>See Also</h3>

<p><code><a href="#topic+ix.mat2df">ix.mat2df</a></code>, <code><a href="#topic+mlds">mlds</a></code>, <code><a href="#topic+lik6pt">lik6pt</a></code>, <code><a href="stats.html#topic+glm">glm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AutumnLab)
make.ix.mat(AutumnLab)
mlds(AutumnLab, c(1, seq(6, 30, 3)))
</code></pre>

<hr>
<h2 id='mlds'>Fit Difference Scale by Maximum Likelihood </h2><span id='topic+mlds'></span><span id='topic+mlds.mlds.df'></span><span id='topic+mlds.mlbs.df'></span><span id='topic+mlds.data.frame'></span><span id='topic+mlds.formula'></span>

<h3>Description</h3>

<p> Generic function  <code>mlds</code> uses different methods to fit the results of a difference scaling experiment either using <code>glm</code> (Generalized Linear Model), by direct maximization of the likelihood using <code>optim</code> or by maximizing the likelihood with respect to a function of the stimulus dimension specified by a one sided formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlds(x, ...)

## S3 method for class 'mlds.df'
mlds(x, stimulus = NULL, method = "glm", 
	lnk = "probit", opt.meth = "BFGS", glm.meth = "glm.fit",
	opt.init = NULL, control = glm.control(maxit = 50000, epsilon = 1e-14), 
	... )
	
## S3 method for class 'mlbs.df'
mlds(x, stimulus = NULL, method = "glm", 
	lnk = "probit",
	control = glm.control(maxit = 50000, epsilon = 1e-14), 
	glm.meth = "glm.fit", 
	... )

## S3 method for class 'data.frame'
mlds(x, ... )

## S3 method for class 'formula'
mlds(x, p, data, stimulus = NULL, 
	lnk = "probit", opt.meth = "BFGS", 
	control = list(maxit = 50000, reltol = 1e-14), ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlds_+3A_x">x</code></td>
<td>
<p>For comparisons of two pairs of stimuli, when the <code>method</code> is specified as &lsquo;glm&rsquo; or &lsquo;optim&rsquo; a data frame with 5 columns giving the response and the ranks of the stimulus levels for each trial, or an object of class &lsquo;mlds.df&rsquo; which also contains additional information as attributes. For comparisons of triples of stimuli, only the method &lsquo;glm&rsquo; is currently defined.  The object can be a data frame of 4 columns with the first specifying the response and the other 3 the stimulus level ranks, or an object of class &lsquo;mlbs.df&rsquo;, which contains additional attributes.  It can also be a one-side formula with parameters <code>p</code> and stimulus variable <code>sx</code> that gives a parametric formula to fit to the data for the <code>formula</code> method.</p>
</td></tr>
<tr><td><code id="mlds_+3A_data">data</code></td>
<td>
<p> A data frame with 4 or 5 columns giving the response and the ranks of the stimulus levels for each trial, or an object of class &lsquo;mlbs.df&rsquo; or &lsquo;mlds.df&rsquo;, respectively, which also contains additional information as attributes, required when the &lsquo;formula&rsquo; method is used.</p>
</td></tr>
<tr><td><code id="mlds_+3A_p">p</code></td>
<td>
<p>numeric vector of parameters of length one greater than the number of parameters in the <code>formula</code> argument that specifies initial values for the parameters.  The extra parameter, specified last, is the initial estimate of <code>sigma</code>. </p>
</td></tr>
<tr><td><code id="mlds_+3A_stimulus">stimulus</code></td>
<td>
<p>A numeric vector that contains the physical stimulus levels used in the experiment.  If <code>data</code> is of class &lsquo;mlds.df&rsquo;, this information is included as an attribute.  If <code>NULL</code>, a sequence of <code class="reqn">1:n</code> is used, where n is the number of stimulus levels, deduced from the highest rank in <code>data</code>. </p>
</td></tr>
<tr><td><code id="mlds_+3A_method">method</code></td>
<td>
<p> character, taking the value of &ldquo;glm&rdquo; or &ldquo;optim&rdquo;.  Default is &ldquo;glm&rdquo;. </p>
</td></tr>
<tr><td><code id="mlds_+3A_lnk">lnk</code></td>
<td>
<p>character indicating either one of the built-in links for the binomial family or a user defined link of class &lsquo;link-glm&rsquo;.  See <code><a href="stats.html#topic+family">family</a></code> and <code><a href="stats.html#topic+make.link">make.link</a></code>. Default is &ldquo;probit&rdquo;.</p>
</td></tr>
<tr><td><code id="mlds_+3A_opt.meth">opt.meth</code></td>
<td>
<p>If <code>method</code> = &ldquo;optim&rdquo;, the method used by <code>optim</code> can be specified.  Defaults to &ldquo;BFGS&rdquo;.</p>
</td></tr>
<tr><td><code id="mlds_+3A_opt.init">opt.init</code></td>
<td>
<p>Vector of numeric giving initial values which must be provided if you specify the &ldquo;optim&rdquo; method.</p>
</td></tr>
<tr><td><code id="mlds_+3A_control">control</code></td>
<td>
<p> A list of control values for either <code>glm</code> or <code>optim</code>.  Since the <code>method</code> defaults to &ldquo;glm&rdquo;, the default is a glm list but should be changed if the &ldquo;optim&rdquo; method is chosen.</p>
</td></tr>
<tr><td><code id="mlds_+3A_glm.meth">glm.meth</code></td>
<td>
<p>the method to be used in fitting the model, only when <code>method = glm</code>. The default value is &ldquo;glm.fit&rdquo;.  See<code><a href="stats.html#topic+glm">glm</a></code> for further details.
</p>
</td></tr>
<tr><td><code id="mlds_+3A_...">...</code></td>
<td>
<p>Additional arguments passed along to <code>glm</code> or <code>optim.</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Observers are presented with either triples or pairs of pairs of stimuli, distributed along a physical stimulus axis.  For example, for stimuli <code class="reqn">a, b, c</code> with <code class="reqn">a &lt; b &lt; c</code>, they see the triple <code class="reqn">a, b, c</code>, or for stimuli <code class="reqn">a, b, c, d</code> with <code class="reqn">a &lt; b &lt; c &lt; d</code>, they see the pairs <code class="reqn">(a, b)</code> and <code class="reqn">(c, d)</code>. For each trial, they make a judgement respectivily as to whether the difference between stimuli 1 and 2 is greater or not that between stimuli 2 and 3 or the elements of pair 1 is greater or not than the difference between the elements of pair 2.  From a large number of trials on different quadruples, <code>mlds</code> estimates numbers, <code class="reqn">Psi_1,..., Psi_n</code>, by maximum likelihood such that <code class="reqn">(Psi_d - Psi_c) &gt; (Psi_b - Psi_a)</code> when the observer chooses pair 2, and pair 1, otherwise.
</p>
<p>If there are <code class="reqn">p</code> stimulus levels tested, then <code class="reqn">p - 1</code> coefficients are estimated.  The &ldquo;glm&rdquo; method constrains the lowest estimated value, <code class="reqn">Psi_1 = 0</code>, while the &ldquo;optim&rdquo; method constrains the lowest and highest values to be 0 and 1, respectively.  The &ldquo;optim&rdquo; method estimates an additional scale parameter, <code>sigma</code>, whereas this value is fixed at 1.0 for the &ldquo;glm&rdquo; method.  In principle, the scales from the two methods are related by
</p>
<p style="text-align: center;"><code class="reqn">1/\sigma_o = max(Psi_g)</code>
</p>

<p>where <code class="reqn">\sigma_o</code> is <code>sigma</code> estimated with the &ldquo;optim&rdquo; method and <code class="reqn">Psi_g</code> corresponds to the perceptual scale values estimated with the &ldquo;glm&rdquo; method.  The equality may not be exact as the &ldquo;optim&rdquo; method prevents the selection of values outside of the interval [0, 1] whereas the &ldquo;glm&rdquo; method does not.
</p>


<h3>Value</h3>

<p>A list of class &lsquo;mlds&rsquo; whose components depend on whether the method was specified as &lsquo;glm&rsquo;, &lsquo;optim&rsquo; with the default method, or the formula method was used,
</p>
<table>
<tr><td><code>pscale</code></td>
<td>
<p>A numeric vector of the estimated difference scale.</p>
</td></tr>
<tr><td><code>stimulus</code></td>
<td>
<p>The physical stimulus levels</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The scale estimate, always 1.0 for &lsquo;glm&rsquo;</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The fitting method</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>The binomial link specified, default &lsquo;probit&rsquo;</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>For method &lsquo;glm&rsquo;, an object of class &lsquo;glm&rsquo; resulting from the fit.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>for method &lsquo;optim&rsquo;, the logarithm of likelihood at convergence</p>
</td></tr>
<tr><td><code>hess</code></td>
<td>
<p>for method &lsquo;optim&rsquo;, the Hessian matrix at convergence</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>For method&lsquo;optim&rsquo;, the data.frame or &lsquo;mlds.df&rsquo; entered as an argument.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>For method &lsquo;optim&rsquo;, a code indicating whether <code>optim</code> converged or not.  See <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>For &lsquo;formula&rsquo; method, the parameters estimated.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The one-sided formula specified with the &lsquo;method&rsquo;.</p>
</td></tr>
<tr><td><code>func</code></td>
<td>
<p>For &lsquo;formula&rsquo; method, a function obtained from the one-sided <code>formula</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The glm method often generates warnings that fitted probabilities are 0 or 1. This does not usually affect the values of the estimated scale.  However, it may be wise to check the results with the optim method and obtain standard errors from a bootstrap method (see <code><a href="#topic+boot.mlds">boot.mlds</a></code>). The warnings will often disappear if the link is modified or more data are obtained. 
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+optim">optim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AutumnLab)
#Note the warnings generated by glm method
x.mlds &lt;- mlds(AutumnLab)
summary(x.mlds)
y.mlds &lt;- mlds(AutumnLab, method = "optim", opt.init = c(seq(0, 1, len = 10), 0.16))
summary(y.mlds)
plot(x.mlds)
#How sigma relates the scales obtained by the 2 different methods.
lines(y.mlds$stimulus,  y.mlds$pscale/y.mlds$sigma)

#Example with triads
data(kktriad)
kkt.mlds &lt;- mlds(kktriad)
plot(kkt.mlds, type = "b")

#An example using the formula method
data(kk1)
# with one parameter
kk.frm1 &lt;- mlds(~ sx^p, p = c(3, 0.02), data = kk1)
# with two parameters
kk.frm2 &lt;- mlds(~p[1] * (sx + abs(sx - p[2])) - p[1] * p[2], 
	p = c(0.9, 0.3, 0.2), data = kk1)
</code></pre>

<hr>
<h2 id='plot.mlds'> Plot a mlds Object </h2><span id='topic+plot.mlds'></span><span id='topic+lines.mlds'></span><span id='topic+points.mlds'></span><span id='topic+plot.mlbs'></span><span id='topic+lines.mlbs'></span><span id='topic+points.mlbs'></span>

<h3>Description</h3>

<p>Plots the difference scale as a function of stimulus level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
plot(x, standard.scale = FALSE, SD.scale = FALSE, ...)
## S3 method for class 'mlds'
lines(x, standard.scale = FALSE, SD.scale = FALSE, ...)
## S3 method for class 'mlds'
points(x, standard.scale = FALSE, SD.scale = FALSE, ...)

## S3 method for class 'mlbs'
plot(x, standard.scale = FALSE, SD.scale = FALSE, ...)
## S3 method for class 'mlbs'
lines(x, standard.scale = FALSE, SD.scale = FALSE, ...)
## S3 method for class 'mlbs'
points(x, standard.scale = FALSE, SD.scale = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mlds_+3A_x">x</code></td>
<td>
<p><code>mlds</code> or <code>mlbs</code>  object, typically result of <code>mlds</code></p>
</td></tr>
<tr><td><code id="plot.mlds_+3A_standard.scale">standard.scale</code></td>
<td>
<p> logical indicating whether the plotted difference scale should be normalized to maximum value = 1</p>
</td></tr>
<tr><td><code id="plot.mlds_+3A_sd.scale">SD.scale</code></td>
<td>
<p> logical indicating whether to plot difference scale in units of d'.  Ignored if <code>standard.scale = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mlds_+3A_...">...</code></td>
<td>
<p> other parameters to be passed through to the plotting function </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch</p>


<h3>See Also</h3>

 <p><code><a href="#topic+mlds">mlds</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
plot(mlds(SwapOrder(kk1)))
lines(mlds(SwapOrder(kk1)))


</code></pre>

<hr>
<h2 id='pmc'> Proportion of Misclassifications According to an Estimated MLDS Fit</h2><span id='topic+pmc'></span>

<h3>Description</h3>

<p><code>pmc</code> calculates the proportion of the observer's responses that are misclassifications on the basis of the estimated MLDS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_+3A_x">x</code></td>
<td>
<p>object of class 'mlds'.</p>
</td></tr>
<tr><td><code id="pmc_+3A_...">...</code></td>
<td>
<p> currently unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric indicating the proportion of misclassified trials on the basis of the estimated scale.
</p>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch </p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585, <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. </p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(kk1)
	kk1.mlds &lt;- mlds(SwapOrder(kk1))
	pmc(kk1.mlds)
</code></pre>

<hr>
<h2 id='predict.mlds'>Predict method for MLDS Fits </h2><span id='topic+predict.mlds'></span><span id='topic+predict.mlbs'></span>

<h3>Description</h3>

<p>Predict values based on difference scale fit. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
predict(object, newdata = NULL, type = "link", ...)

## S3 method for class 'mlbs'
predict(object, newdata = NULL, type = "link", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mlds_+3A_object">object</code></td>
<td>
<p>object of class &lsquo;mlds&rsquo; or  &lsquo;mlbs&rsquo;, typically from the output of <code>mlds</code></p>
</td></tr>
<tr><td><code id="predict.mlds_+3A_newdata">newdata</code></td>
<td>
<p>A data.frame or object of class &lsquo;mlbs.df&rsquo; with 4 columns or &lsquo;mlds.df&rsquo; with 5 columns, corresponding to the response at each trial and the ranks of, respectively, the triple or quadruple of stimuli presented.</p>
</td></tr>
<tr><td><code id="predict.mlds_+3A_type">type</code></td>
<td>
<p> character indicating scale on which predictions should be made, &ldquo;link&rdquo;, the default, on the scale of the linear predictor or &ldquo;response&rdquo;, on the response scale. </p>
</td></tr>
<tr><td><code id="predict.mlds_+3A_...">...</code></td>
<td>
<p> When <code>obj$method</code> = &ldquo;glm&rdquo;, these are additional arguments passed to <code>predict.glm</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>newdata</code> argument is needed principally for the 6-point test (see <code><a href="#topic+lik6pt">lik6pt</a></code>), to extract the estimated probabilities for the subsets of the original data that form valid 6-point tests.
</p>


<h3>Value</h3>

<p>A numeric vector of the predicted values either on the scale of the linear predictor or on the response scale.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585,  <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code>, <code><a href="#topic+lik6pt">lik6pt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
kk1.mlds &lt;- mlds(SwapOrder(kk1))
predict(kk1.mlds, type = "response")
</code></pre>

<hr>
<h2 id='print.mlds'> Difference Scale default print statement</h2><span id='topic+print.mlds'></span><span id='topic+print.mlbs'></span>

<h3>Description</h3>

<p>This is the default print statement for a &lsquo;mlbs&rsquo; or &lsquo;mlds&rsquo; object.
It displays the difference scale as a named vector, with the names corresponding to the stimulus levels and the value of <code>sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
print(x, digits = max(3, getOption("digits") - 4), ...)

## S3 method for class 'mlbs'
print(x, digits = max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlds_+3A_x">x</code></td>
<td>
<p>an object of class &lsquo;mlbs&rsquo; or &lsquo;mlds&rsquo;, typically from a call to <code>mlds</code>.</p>
</td></tr>
<tr><td><code id="print.mlds_+3A_digits">digits</code></td>
<td>
<p>number of digits to display in the output. </p>
</td></tr>
<tr><td><code id="print.mlds_+3A_...">...</code></td>
<td>
<p> additional arguments to be passed to the default method. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
print(mlds(SwapOrder(kk1)))

</code></pre>

<hr>
<h2 id='rbind.mlds.df'> Concatenate Objects of Class 'mlbs.df' or 'mlds.df' by Row </h2><span id='topic+rbind.mlds.df'></span><span id='topic+rbind.mlbs.df'></span><span id='topic+Rbind'></span>

<h3>Description</h3>

<p>Concatenate the data.frame of &lsquo;mlbs.df&rsquo; or &lsquo;mlds.df&rsquo; objects by row
and concatenate the &lsquo;invord&rsquo; attributes, also. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds.df'
rbind(...)
## S3 method for class 'mlbs.df'
rbind(...)
Rbind(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbind.mlds.df_+3A_...">...</code></td>
<td>
<p>Objects of class &lsquo;mlbs.df&rsquo; or &lsquo;mlds.df&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>rbind.data.frame</code> to concatenate the data.frame component of several &lsquo;mlbs.df&rsquo; or&lsquo;mlds.df&rsquo; objects and then concatenates there <code>invord</code> attributes, as well.  
<code>Rbind</code> will work, too, but is deprecated.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;mlbs.df&rsquo; or &lsquo;mlds.df&rsquo; that is composed of data from several experiments. </p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
data(kk2)
data(kk3)
kk &lt;- rbind(kk1, kk2, kk3)
nrow(kk1)
nrow(kk)
length(attr(kk1, "invord"))
length(attr(kk, "invord"))
</code></pre>

<hr>
<h2 id='runQuadExperiment'>Start and run a Difference Scale Experiment </h2><span id='topic+runQuadExperiment'></span><span id='topic+runTriadExperiment'></span><span id='topic+runSampleExperiment'></span>

<h3>Description</h3>

<p>Runs a difference scaling experiment displaying stimuli with the function <code>DiplayTrial</code> defined by the function <code>DefineStimuli</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runQuadExperiment(DisplayTrial, DefineStimuli, NumTrials = NULL,
 	DisplaySize = 7.5, aspect = 1, ...)
runTriadExperiment(DisplayTrial, DefineStimuli, NumTrials = NULL,
 	DisplaySize = 3.5, aspect = 1, ...)
runSampleExperiment(DisplayTrial, DefineStimuli)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runQuadExperiment_+3A_displaytrial">DisplayTrial</code></td>
<td>
<p>character giving the name of a function to display a trial with triple or quadruple of stimuli.</p>
</td></tr>
<tr><td><code id="runQuadExperiment_+3A_definestimuli">DefineStimuli</code></td>
<td>
<p>character giving the name of a function that defines the set of stimuli from which triples or quadruples are drawn.</p>
</td></tr>
<tr><td><code id="runQuadExperiment_+3A_displaysize">DisplaySize</code></td>
<td>
<p>numeric giving the overall size of the display on the screen. </p>
</td></tr>
<tr><td><code id="runQuadExperiment_+3A_numtrials">NumTrials</code></td>
<td>
<p>integer giving the number of trials to display.  If <code>NULL</code> (the default), the number is computed on the basis of the size of stimulus set designated by <code>DefineStimuli</code>.</p>
</td></tr>
<tr><td><code id="runQuadExperiment_+3A_...">...</code></td>
<td>
<p>currently unused</p>
</td></tr>
<tr><td><code id="runQuadExperiment_+3A_aspect">aspect</code></td>
<td>
<p>numeric giving the height/width ratio of the display on the screen.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are to demonstrate how to run a difference scaling experiment.  Helper functions <code>DisplayOneQuad</code> or <code>DisplayOneTriad</code> and <code>DefineMyScale</code> permit running the perception of correlation experiment, sample data from which are provided as datasets,
(see <code><a href="#topic+kk">kk</a></code>). 
<code>runSampleExperiment</code> is defunct and replaced by these functions.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;mlds.df&rsquo; or &lsquo;mlbs.df&rsquo;, depending on the experiment run, is returned.  Each inherits from &lsquo;data.frame&rsquo; and has attributes &lsquo;stimulus&rsquo; and &lsquo;invord&rsquo;.
See <code><a href="#topic+kk">kk</a></code> for an example.
</p>


<h3>Author(s)</h3>

<p> Kenneth Knoblauch and Laurence T. Maloney </p>


<h3>Examples</h3>

<pre><code class='language-R'>##This will start a 330 trial interactive experiment
##  of quadruples
## Not run: 
	runQuadExperiment("DisplayOneQuad", "DefineMyScale")
	
## End(Not run)
##This will run 10 trials of an interactive experiment
##  of triads
## Not run: 
	runTriadExperiment("DisplayOneTriad", 
		"DefineMyScale", NumTrials = 10)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='SimMLDS'>
Simulate Output of MLDS Experiment
</h2><span id='topic+SimMLDS'></span>

<h3>Description</h3>

<p>Given a block of trials of an MLDS experiment, an underlying response function and the judgment variability, simulate the response of an observer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimMLDS(Trials, Scale, Sigma, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimMLDS_+3A_trials">Trials</code></td>
<td>
<p>an N by 4 or 3 matrix or data frame of integers indicating the n trials of an MLDS experiment.  The columns indicate the indices of the stimuli presented on a trial, 4 for an experiment with quadruples and 3 for triads.  A data frame for this argument is most easily generated with the <code>combn</code> function.
</p>
</td></tr>
<tr><td><code id="SimMLDS_+3A_scale">Scale</code></td>
<td>
<p>a vector of values indicating the underlying responses of the simulated observer for each stimulus level.  The length of this vector should equal the largest integer in <code>Trials</code>.
</p>
</td></tr>
<tr><td><code id="SimMLDS_+3A_sigma">Sigma</code></td>
<td>
<p>a vector of length 1 indicating the judgment standard deviation of the simulated observer.
</p>
</td></tr>
<tr><td><code id="SimMLDS_+3A_n">n</code></td>
<td>
<p>integer giving number of simulated data sets to return</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a data frame of indices to the responses associated with stimulus levels and the judgment variability, the function returns the results of 1 or multiple MLDS experiments, either with triads or quads, depending on the number of columns in the data frame.
</p>


<h3>Value</h3>

<p>If the argument <code>n</code> is set to 1 (default), an object of class &lsquo;mlds.df&rsquo; or &lsquo;mlbs.df&rsquo; with simulated responses.  If <code>n</code> is greater than 1, a list of such objects is returned.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney
</p>


<h3>References</h3>

<p>Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585,  <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p>see also <code><a href="#topic+boot.mlds">boot.mlds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Tr &lt;- t(combn(10, 4))
Sc &lt;- seq(0, 1, len = 11)^2
Sig &lt;- 0.2
sim.lst &lt;- SimMLDS(Tr, Sc, Sig, n = 10)
sim.res &lt;- sapply(sim.lst, mlds)


</code></pre>

<hr>
<h2 id='simu.6pt'>Perform Bootstrap Test on 6-point Likelihood for MLDS FIT</h2><span id='topic+simu.6pt'></span>

<h3>Description</h3>

<p>Using the <code>fitted</code> responses (probabilities) to the difference scale, new responses are generated which permit new 6-point likelihoods to be calculated.  The distribution of a large number of such likelihoods can be compared with that obtained from the observed responses to evaluate the internal consistency of the estimated scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu.6pt(obj, nsim = 1, nrep, no.warn = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu.6pt_+3A_obj">obj</code></td>
<td>
<p>object of class &lsquo;mlds&rsquo;</p>
</td></tr>
<tr><td><code id="simu.6pt_+3A_nsim">nsim</code></td>
<td>
<p> integer indicating number of bootstrap trials.</p>
</td></tr>
<tr><td><code id="simu.6pt_+3A_nrep">nrep</code></td>
<td>
<p> integer indicating how many sessions with are in the data set.</p>
</td></tr>
<tr><td><code id="simu.6pt_+3A_no.warn">no.warn</code></td>
<td>
<p>logical indicating when TRUE (default) to suppress warnings from <code>glm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>LIST with 4 components
</p>
<table>
<tr><td><code>boot.samp</code></td>
<td>
<p>vector of numeric giving the log likelihood for the 6-point test for each simulation.</p>
</td></tr>
<tr><td><code>lik6pt</code></td>
<td>
<p>numeric indicating the log likelihood for the 6-point test on the original data</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>proportion of simulations on which the simulated log likelihood was higher than that obtained from the original sample.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>numeric indicating the number of simulations.  It should be the length of <code>boot.samp</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch and Laurence T. Maloney</p>


<h3>References</h3>

<p> Maloney, L. T. and Yang, J. N. (2003). Maximum likelihood difference scaling. <em>Journal of Vision</em>, <b>3(8):5</b>, 573&ndash;585,  <a href="https://doi.org/10.1167/3.8.5">doi:10.1167/3.8.5</a>. 
</p>
<p>Knoblauch, K. and Maloney, L. T. (2008) MLDS:  Maximum likelihood difference scaling in R. 
<em>Journal of Statistical Software</em>, <b>25:2</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v025.i02">doi:10.18637/jss.v025.i02</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlds">mlds</a></code>, <code><a href="#topic+lik6pt">lik6pt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(kk1)
	x.mlds &lt;- mlds(SwapOrder(kk1))
	#nsim should be near 10,000 for stability,
	# but this will take a little time
	simu.6pt(x.mlds, 100, nrep = 1)
</code></pre>

<hr>
<h2 id='summary.mlds'>Summary for a mlds fit </h2><span id='topic+summary.mlds'></span><span id='topic+print.summary.mlds'></span><span id='topic+summary.mlbs'></span><span id='topic+print.summary.mlbs'></span>

<h3>Description</h3>

<p>Takes a fitted &lsquo;mlbs&rsquo; or&lsquo;mlds&rsquo; object and produces a summary of it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds'
summary(object, digits = max(3, getOption("digits") - 4), ...)

## S3 method for class 'summary.mlds'
print(x, digits = max(3, getOption("digits") - 4), ...)

## S3 method for class 'mlbs'
summary(object, digits = max(3, getOption("digits") - 4), ...)

## S3 method for class 'summary.mlbs'
print(x, digits = max(3, getOption("digits") - 4), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlds_+3A_object">object</code></td>
<td>
<p> an object of class &lsquo;mlbs&rsquo; or &lsquo;mlds&rsquo;typically produced by a call to <code>mlds</code>. </p>
</td></tr>
<tr><td><code id="summary.mlds_+3A_digits">digits</code></td>
<td>
<p> The number of digits to display.</p>
</td></tr>
<tr><td><code id="summary.mlds_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;summary.mlds&rsquo;.</p>
</td></tr>
<tr><td><code id="summary.mlds_+3A_...">...</code></td>
<td>
<p>Addtional arguments passed to the default print method. Only effects the output of <code>pscale</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Displays summary information from a &lsquo;mlds&rsquo; object.
</p>


<h3>Value</h3>

<p>A list of 5 elements
</p>
<table>
<tr><td><code>pscale</code></td>
<td>
<p>A named vector indicating the difference scale.  The names are the stimulus levels.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>The estimate of the scale parameter.  For method = &ldquo;glm&rdquo;, this is always 1.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>The logarithm of likelihood. </p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The fitting method used, either &ldquo;glm&rdquo; or &ldquo;optim&rdquo;. </p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p>The link used for the binomial family. </p>
</td></tr>
</table>
<p>Normally, <code>print.summary.mlds</code> is not meant to be called directly by the user.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>See Also</h3>

 <p><code><a href="#topic+mlds">mlds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
kk1.mlds &lt;- mlds(SwapOrder(kk1))
summary(kk1.mlds)

</code></pre>

<hr>
<h2 id='summary.mlds.bt'>
Method to Extract Bootstrap Values for MLDS Scale Values
</h2><span id='topic+summary.mlds.bt'></span>

<h3>Description</h3>

<p>Extracts the means and standard deviations of the bootstrapped scale values from an MLDS experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlds.bt'
summary(object, standard.scale = TRUE, sigma = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlds.bt_+3A_object">object</code></td>
<td>
<p>object of class &lsquo;mlds.bt&rsquo;, typically obtained from running <code>boot.mlds</code> or <code>boot.mlbs</code> on an object created by <code>mlds</code>.
</p>
</td></tr>
<tr><td><code id="summary.mlds.bt_+3A_standard.scale">standard.scale</code></td>
<td>
<p>logical, if TRUE (default), the values are returned on the standard scale (0, 1).  Otherwise, the values are returned in unnormalized units.
</p>
</td></tr>
<tr><td><code id="summary.mlds.bt_+3A_sigma">sigma</code></td>
<td>

<p>If TRUE and <code>standard.scale = TRUE</code>, the bootstrapped <code>sigma</code> value is printed out and its standard deviation.
</p>
</td></tr>
<tr><td><code id="summary.mlds.bt_+3A_...">...</code></td>
<td>
<p>additional arguments to summary, currently unused.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns means and standard deviations bootstrapped values for an object of class &lsquo;mlds.bt&rsquo;.  
By default the values are on the standard scale but may be renormalized by the standard deviation of
each bootstrap run before taking the means and standard deviations.
</p>


<h3>Value</h3>

<p>A two column matrix is returned of the bootstrap means and standard deviations in columns 1 and 2, respectively.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boot.mlds">boot.mlds</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
kk.mlds &lt;- mlds(kk1)
kk.bt &lt;- boot.mlds(kk.mlds, nsim = 10)
summary(kk.bt)

</code></pre>

<hr>
<h2 id='SwapOrder'>Order Stimuli and Adjust  Responses from Difference Scaling
data.frame </h2><span id='topic+SwapOrder'></span>

<h3>Description</h3>

<p> Invert the order of the stimuli on each trial so that they are in physical order and not the presentation order and adjust responses, accordingly to reflect whether the lower or higher stimulus pair was selected or the inverse.  </p>


<h3>Usage</h3>

<pre><code class='language-R'> SwapOrder(data) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SwapOrder_+3A_data">data</code></td>
<td>
<p>data.frame or &lsquo;mlds.df&rsquo; object with five columns, <code>resp</code>, <code>S1</code>,
<code>S2</code>, <code>S3</code> and <code>S4</code>.  <code>resp</code> is the binary response
of the observer (it could be a logical).  The other four indicate the
four stimulus levels presented on a given trial. In principle, this
function can be applied when the order reflects the position of the
pairs and not their physical ordering. </p>
</td></tr> </table>


<h3>Details</h3>

<p> Pairs of stimuli in a difference scaling experiment are often presented on top and bottom and the responses, 0 and 1, refer to bottom and top pair, respectively.  <code>SwapOrder</code> modifies the data.frame so that the stimuli are ordered by physical level and the responses, 0 and 1, are modified to refer to the lower and upper pair on the physical scale, respectively. If the object inherits also from class &lsquo;mlds.df&rsquo;, it has an <code>invord</code> attribute that is a logical vector of length the number of rows in the data.frame.  It indicates the trials on which the higher stimulus levels were presented on the bottom. If this attribute is present, it is used to modify the data.frame.  In this case, the function acts as its own inverse.  </p>


<h3>Value</h3>

<p> A data.frame of the same format as the input data.frame but with the stimulus order modified and the response inverted on those trials on which the higher physical level stimulus were on the bottom. If the order reflects the position, it is modified to reflect the stimulus level and vice versa.
</p>


<h3>Note</h3>

<p>Storing the physical position of the stimuli allows the original configuration not to be lost when re-ordering the stimuli to reflect physical stimulus level.  The <code>invord</code> attribute could, in principle, be used, also, to test for an influence of or bias related to the physical position.
</p>


<h3>Author(s)</h3>

<p>Kenneth Knoblauch</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kk1)
kk1.swo &lt;- SwapOrder(kk1)
</code></pre>

<hr>
<h2 id='Transparency'>
Difference Scaling of Transparency
</h2><span id='topic+Transparency'></span>

<h3>Description</h3>

<p>The data set was obtained from an experiment in which observers judged the differences between pairs of image pairs containing transparent pebble-shaped objects. The refractive indice (RI) of the transparent material of each object was varied systematically across the four images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Transparency)</code></pre>


<h3>Format</h3>

<p>A data frame with 2520 observations on the following 6 variables.
</p>

<dl>
<dt><code>resp</code></dt><dd><p>a numeric vector taking on values of 0 and 1 indicating responses of observer.</p>
</dd>
<dt><code>S1</code></dt><dd><p>a numeric vector, rank order of weakest stimulus on the physical scale for a given trial.</p>
</dd>
<dt><code>S2</code></dt><dd><p>a numeric vector, rank order of physical stimulus 2 for the trial.</p>
</dd>
<dt><code>S3</code></dt><dd><p>a numeric vector , rank order of physical stimulus 3 for the trial.</p>
</dd>
<dt><code>S4</code></dt><dd><p>a numeric vector, rank order of strongest stimulus on the physical scale for a given trial.</p>
</dd>
<dt><code>Obs</code></dt><dd><p>a factor identifying observers with levels <code>O1</code> ... <code>O6</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The physical scale is RI and the psychophysical scale is estimated using MLDS. Observers were not told to base their judmgents on RI (RI was not mentioned in instructions) but to judge apparent differences. Fleming et al (2007) conjectured that observers used a measure of the distortion of the background as seen through each transparent object in judging differences.
</p>


<h3>References</h3>

<p>Fleming, R.,   J\&quot;akel, F., Maloney, L. T.
(2007) Visual perception of refractive materials  
<em>Journal of Vision</em>  <b>7</b>, 561.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
Trsp.mlds &lt;- mlds(as.mlds.df(Transparency[, -6], st = attr(Transparency, "stimulus")))
plot(Trsp.mlds, xlab = "Index of Refraction", type = "l",
	ylab = "Difference Scale", ylim = c(0, 20),
	lwd = 3)

Trsp.Obs &lt;- sapply(levels(Transparency$Obs), function(obs)
	mlds(as.mlds.df(subset(Transparency, Obs == obs, 
		select = 1:5), st = attr(Transparency, "stimulus"))),
		simplify = FALSE, USE.NAMES = TRUE)
invisible(sapply(Trsp.Obs, lines, type = "b"))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
