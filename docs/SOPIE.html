<!DOCTYPE html><html><head><title>Help for package SOPIE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SOPIE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SOPIE-package'><p>Package 'SOPIE' : Summary Information</p></a></li>
<li><a href='#a.estimate'><p>Estimate the Left Endpoint of the Off-Pulse Interval of a Pulsar</p></a></li>
<li><a href='#b.estimate'><p>Estimate the Right Endpoint of the Off-Pulse Interval of a Pulsar</p></a></li>
<li><a href='#circ.kernel'><p>Circular Kernel Density Estimation</p></a></li>
<li><a href='#crab'><p>PSR J0534+2200 (Crab-Pulsar) Time of Arrivals</p></a></li>
<li><a href='#findh'><p>Calculate the Estimated Smoothing Parameter</p></a></li>
<li><a href='#J1709'><p>PSR J1709-44290 Time of Arrivals</p></a></li>
<li><a href='#simdata'><p>Simulated Data from a Scaled Von Mises Distribution with Noise</p></a></li>
<li><a href='#SOPIE'><p>Sequential Off-Pulse Interval Estimation of a Pulsar Light Curve</p></a></li>
<li><a href='#von_mises_sim'><p>Generates Simulated Data from a Von Mises Distribution with Noise</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Parametric Estimation of the Off-Pulse Interval of a Pulsar</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Willem Daniel Schutte</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Willem Daniel Schutte &lt;wd.schutte@nwu.ac.za&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0), circular, ADGofTest, grDevices, graphics</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to non-parametrically estimate the off-pulse interval of a source
    function originating from a pulsar. The technique is based on a sequential application of P-values
    obtained from goodness-of-fit tests for the uniform distribution, such as the Kolmogorov-Smirnov,
    Cramer-von Mises, Anderson-Darling and Rayleigh goodness-of-fit tests.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-23 12:37:00 UTC; NWUUSER</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-23 16:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='SOPIE-package'>Package 'SOPIE' : Summary Information</h2><span id='topic+SOPIE-package'></span>

<h3>Description</h3>

<p>The package 'SOPIE' provides functions to non-parametrically estimate the off-pulse interval of a source function originating from a pulsar.
This technique is based on a sequential application of P-values 
obtained from goodness-of-fit tests for the uniform distribution. The well-known Kolmogorov-Smirnov, Cramer-von Mises, 
Anderson-Darling and Rayleigh test statistics are applied sequentially on subintervals of <code class="reqn">[0 ; 1]</code>. <br /> The most important functions in the package 
are combined in a wrapper function called <code><a href="#topic+SOPIE">SOPIE</a></code>. Users should start by looking at the documentation of the function <code><a href="#topic+findh">findh</a></code>, <code><a href="#topic+circ.kernel">circ.kernel</a></code> and <code><a href="#topic+SOPIE">SOPIE</a></code>.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SOPIE</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-02-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The SOPIE package consists of 4 main functions. Each of these functions are 
discussed in terms of its functioning, structure, arguments and output in the help documentation of each function.<br />
</p>

<ol>
<li> <p><code><a href="#topic+findh">findh</a></code> is the function used to obtain the estimated smoothing parameter <code class="reqn">\hat h</code> that will be
used in the circular kernel density estimator.
</p>
</li>
<li> <p><code><a href="#topic+circ.kernel">circ.kernel</a></code> is the function used to perform circular kernel density estimation on the
sample data set in order to obtain the minimum points of the kernel density estimator.
This is essentially the first step of the suggested procedure, as described in the second reference listed below. The output can also
be used to draw a graph of the circular kernel density estimator.
</p>
</li>
<li> <p><code><a href="#topic+a.estimate">a.estimate</a></code> and <code><a href="#topic+b.estimate">b.estimate</a></code> is almost identical function. <code>a.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">a</code>, i.e. <code class="reqn">\hat a</code>, for the off-pulse interval of a pulsar light curve. <code>b.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">b</code>, i.e. <code class="reqn">\hat b</code>, for the off-pulse interval of a pulsar light curve.
</p>
</li>
<li> <p><code><a href="#topic+SOPIE">SOPIE</a></code> is a wrapper-function in the sense that it utilises all of the above function to produce
the estimated off-pulse intervals in an easy readable matrix format, together with
a graph consisting of the histogram estimate of the sample data, the kernel density
estimator and an indication of the estimated median off-pulse interval.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Willem Daniel Schutte <br />
Maintainer: Willem Daniel Schutte 
</p>


<h3>References</h3>

<p>Jammalamadaka, S. Rao and SenGupta, A. (2001). Topics in Circular Statistics, World Scientific Publishing Co. Pte. Ltd. <br />
Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a> <br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(777)
simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
SOPIE(simdata,h=1,to=1,alpha=0.05,g=5,r=10,m=1,grid=100)

</code></pre>

<hr>
<h2 id='a.estimate'>Estimate the Left Endpoint of the Off-Pulse Interval of a Pulsar
</h2><span id='topic+a.estimate'></span>

<h3>Description</h3>

<p><code>a.estimate</code> and <code>b.estimate</code> is almost identical function. <code>a.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">a</code>, i.e. <code class="reqn">\hat a</code>, for the off-pulse interval of a pulsar light curve. <code>b.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">b</code>, i.e. <code class="reqn">\hat b</code>, for the off-pulse interval of a pulsar light curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>a.estimate(data, to = 1, min_points, alpha = 0.05, g = 1, r = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="a.estimate_+3A_data">data</code></td>
<td>
<p>the data vector used to estimate <code class="reqn">a</code>.</p>
</td></tr>
<tr><td><code id="a.estimate_+3A_to">to</code></td>
<td>
<p>the value of the maximum domain of the data. Values will usually
either be 1 or 2<code class="reqn">\pi</code>.</p>
</td></tr>
<tr><td><code id="a.estimate_+3A_min_points">min_points</code></td>
<td>
<p>the scalar or vector containing the value(s) of the minimum point(s)
calculated during the kernel density estimation. This argument does not represent
the index value(s) of the observations within data. The minimum point(s) can be obtained with the function <code><a href="#topic+circ.kernel">circ.kernel</a></code>.
</p>
</td></tr>
<tr><td><code id="a.estimate_+3A_alpha">alpha</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>) that will be used during the sequential application 
of the goodness-of-fit tests for uniformity when estimating the off-pulse interval.
</p>
</td></tr>
<tr><td><code id="a.estimate_+3A_g">g</code></td>
<td>
<p>the value of the incremental growth of each subsequent
interval over which uniformity is tested. In the suggested procedure, uniformity is
sequentially tested, with the interval used in the test growing by <code>g</code> observations after
every iteration. The selection of <code>g</code> not only influences the computation time of the
procedure, but also has an effect on the point where rejection of the hypothesis takes
place. For large values of <code>g</code>, the user takes the risk that uniformity is rejected for
a certain (larger) interval, while it should have been rejected earlier (for a smaller
interval). On the other hand, a very small choice of <code>g</code> results in long execution
times. Small values of <code>g</code> may also result in the early rejection of uniformity, e.g.
in the situation where a few observations may cause the rejection of uniformity,
while uniformity is again confirmed when several more observations are included
in the interval. If the user suspects that this situation may occur, the problem can
be overcome by selecting a larger value of the integer <code>r</code>.
</p>
</td></tr>
<tr><td><code id="a.estimate_+3A_r">r</code></td>
<td>
<p>the number of subsequent intervals that must
result in the rejection of uniformity before the function will stop. The choice of <code>r</code>
must therefore be linked to the choice of <code>g</code> as explained above. For smaller values
of <code>g</code>, it would be safer to select larger values of <code>r</code>, and vice versa. Since small values
of <code>g</code> may result in a temporary rejection of uniformity for an interval, a larger value
of <code>r</code> would prevent the method from immediately stopping at the first occurrence
of rejection. It is very important to note that, for a large value of <code>r</code>, there will be
no impact on the value of <code class="reqn">\hat b</code> or <code class="reqn">\hat a</code> if rejection takes place for each interval after a
certain point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p>a vector containing the estimated value of <code class="reqn">a</code>, i.e. <code class="reqn">\hat a</code>, for each of
the four goodness-of-fit tests, namely the Anderson-Darling, Kolmogorov-Smirnov,
Cramer-von Mises and the Rayleigh goodness-of-fit test.</p>
</td></tr>
<tr><td><code>general</code></td>
<td>
<p>a list containing the function call, the minimum value(s) used in the
estimation, the level of significance (<code class="reqn">\alpha</code>), the value of <code>g</code> and the value of <code>r</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Willem Daniel Schutte </p>


<h3>References</h3>

<p>D'Agostino, R. &amp; Stephens, M. (eds) (1986). Goodness-of-t techniques, Marcel Dekker, Inc. <br />
Jammalamadaka, S. Rao and SenGupta, A. (2001). Topics in Circular Statistics, World Scientific Publishing Co. Pte. Ltd. <br />
Marsaglia G, Marsaglia J (2004). Evaluating the Anderson-Darling Distribution. Journal of Statistical software, 9, 1-5. <br />
Marsaglia G, Tsang WW, Wang J (2003). Evaluating Kolmogorov's Distribution. Journal of Statistical Software, 8(18), 1-4.<br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
Stephens M (1970). Use of the Kolmogorov-Smirnov, Cramer-Von Mises and related statistics without extensive tables. Journal of the Royal Statistical Society. Series B (Methodological), 32, 115-122.
</p>


<h3>See Also</h3>

<p><code><a href="ADGofTest.html#topic+ad.test">ad.test</a></code> , <code><a href="stats.html#topic+ks.test">ks.test</a></code> , <code><a href="circular.html#topic+rayleigh.test">rayleigh.test</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## This function is to be used inside the wrapper function SOPIE

simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
SOPIE(simdata,h=1,to=1,alpha=0.05,g=5,r=10,m=1,grid=100)
</code></pre>

<hr>
<h2 id='b.estimate'>Estimate the Right Endpoint of the Off-Pulse Interval of a Pulsar
</h2><span id='topic+b.estimate'></span>

<h3>Description</h3>

<p><code>a.estimate</code> and <code>b.estimate</code> is almost identical function. <code>a.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">a</code>, i.e. <code class="reqn">\hat a</code> for the off-pulse interval of a pulsar light curve. <code>b.estimate</code> is the function
used to obtain the estimated values of <code class="reqn">b</code>, i.e. <code class="reqn">\hat b</code>, for the off-pulse interval of a pulsar light curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b.estimate(data, to = 1, min_points, alpha = 0.05, g = 1, r = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b.estimate_+3A_data">data</code></td>
<td>
<p>the data vector used to estimate <code class="reqn">b</code>.</p>
</td></tr>
<tr><td><code id="b.estimate_+3A_to">to</code></td>
<td>
<p>the value of the maximum domain of the data. Values will usually
either be 1 or 2<code class="reqn">\pi</code>.</p>
</td></tr>
<tr><td><code id="b.estimate_+3A_min_points">min_points</code></td>
<td>
<p>a scalar or vector containing the value(s) of the minimum point(s)
calculated during the kernel density estimation. This argument does not represent
the index value(s) of the observations within data. The minimum point(s) can be obtained with the function <code><a href="#topic+circ.kernel">circ.kernel</a></code>.
</p>
</td></tr>
<tr><td><code id="b.estimate_+3A_alpha">alpha</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>) that will be used during the sequential application 
of the goodness-of-fit tests for uniformity when estimating the off-pulse interval.
</p>
</td></tr>
<tr><td><code id="b.estimate_+3A_g">g</code></td>
<td>
<p>the value of the incremental growth of each subsequent
interval over which uniformity is tested. In the suggested procedure, uniformity is
sequentially tested, with the interval used in the test growing by <code>g</code> observations after
every iteration. The selection of <code>g</code> not only influences the computation time of the
procedure, but also has an effect on the point where rejection of the hypothesis takes
place. For large values of <code>g</code>, the user takes the risk that uniformity is rejected for
a certain (larger) interval, while it should have been rejected earlier (for a smaller
interval). On the other hand, a very small choice of <code>g</code> results in long execution
times. Small values of <code>g</code> may also result in the early rejection of uniformity, e.g.
in the situation where a few observations may cause the rejection of uniformity,
while uniformity is again confirmed when several more observations are included
in the interval. If the user suspects that this situation may occur, the problem can
be overcome by selecting a larger value of the integer <code>r</code>.
</p>
</td></tr>
<tr><td><code id="b.estimate_+3A_r">r</code></td>
<td>
<p>the number of subsequent intervals that must
result in the rejection of uniformity before the function will stop. The choice of <code>r</code>
must therefore be linked to the choice of <code>g</code> as explained above. For smaller values
of <code>g</code>, it would be safer to select larger values of <code>r</code>, and vice versa. Since small values
of <code>g</code> may result in a temporary rejection of uniformity for an interval, a larger value
of <code>r</code> would prevent the method from immediately stopping at the first occurrence
of rejection. It is very important to note that, for a large value of <code>r</code>, there will be
no impact on the value of <code class="reqn">\hat b</code> or <code class="reqn">\hat a</code> if rejection takes place for each interval after a
certain point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p>a vector containing the estimated value of b, i.e. <code class="reqn">\hat b</code>, for each of
the four goodness-of-fit tests, namely the Anderson-Darling, Kolmogorov-Smirnov,
Cramer-von Mises and the Rayleigh goodness-of-fit test.</p>
</td></tr>
<tr><td><code>$general</code></td>
<td>
<p>a list containing the function call, the minimum value(s) used in the
estimation, the level of significance (<code class="reqn">\alpha</code>), the value of <code>g</code> and the value of <code>r</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Willem Daniel Schutte </p>


<h3>References</h3>

<p>D'Agostino, R. &amp; Stephens, M. (eds) (1986). Goodness-of-t techniques, Marcel Dekker, Inc. <br />
Jammalamadaka, S. Rao and SenGupta, A. (2001). Topics in Circular Statistics, World Scientific Publishing Co. Pte. Ltd. <br />
Marsaglia G, Marsaglia J (2004). Evaluating the Anderson-Darling Distribution. Journal of Statistical software, 9, 1-5. <br />
Marsaglia G, Tsang WW, Wang J (2003). Evaluating Kolmogorov's Distribution. Journal of Statistical Software, 8(18), 1-4.<br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
Stephens M (1970). Use of the Kolmogorov-Smirnov, Cramer-Von Mises and related statistics without extensive tables. Journal of the Royal Statistical Society. Series B (Methodological), 32, 115-122.
</p>


<h3>See Also</h3>

<p><code><a href="ADGofTest.html#topic+ad.test">ad.test</a></code> , <code><a href="stats.html#topic+ks.test">ks.test</a></code> , <code><a href="circular.html#topic+rayleigh.test">rayleigh.test</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## This function is to be used inside the wrapper function SOPIE

simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
SOPIE(simdata,h=1,to=1,alpha=0.05,g=5,r=10,m=1,grid=100)
</code></pre>

<hr>
<h2 id='circ.kernel'>Circular Kernel Density Estimation</h2><span id='topic+circ.kernel'></span>

<h3>Description</h3>

<p>This function is used to perform circular kernel density estimation on the
sample data set in order to obtain the minimum points of the kernel density estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circ.kernel(data, sp, to = 1, grid = 512, m = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circ.kernel_+3A_data">data</code></td>
<td>
<p>the data vector from which the circular kernel density estimator is to be computed.</p>
</td></tr>
<tr><td><code id="circ.kernel_+3A_sp">sp</code></td>
<td>
<p>a real value <code class="reqn">(0 &lt; sp &lt; 1)</code> for the smoothing parameter to be used. This value can be
obtained by using <code><a href="#topic+findh">findh</a></code>.</p>
</td></tr>
<tr><td><code id="circ.kernel_+3A_to">to</code></td>
<td>
<p>the value of the maximum domain of the data. Values will usually
either be 1 or 2<code class="reqn">\pi</code>.</p>
</td></tr>
<tr><td><code id="circ.kernel_+3A_grid">grid</code></td>
<td>
<p>the number of equally spaced grid points at which the density is to be estimated.</p>
</td></tr>
<tr><td><code id="circ.kernel_+3A_m">m</code></td>
<td>
<p>the number of local minimum points included in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Epanechnikov kernel function is used in the circular kernel density estimation. 
Circular kernel density estimation is perform according to the method proposed in 'Topics in circular statistics' (see references).
</p>


<h3>Value</h3>

<p>a list containing the following components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a vector of sorted <code class="reqn">x</code> values that represents the equally-spaced grid points used during the kernel
density estimation.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a vector of density-values of the circular kernel density estimator corresponding to <code class="reqn">x</code>.</p>
</td></tr>
<tr><td><code>minimum</code></td>
<td>
<p>a vector of the kernel grid point(s) of lowest density
derived from the circular kernel density estimator. The length of the vector will depend on the choice of <code>m</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Willem Daniel Schutte </p>


<h3>References</h3>

<p>Hall P, Watson G, Cabrera J (1987). Kernel density estimation with spherical data.
Biometrika, 74 (4), 751-762.<br />
Jammalamadaka S, SenGupta A (2001). Topics in circular statistics. World Scientific Publishing 
Co. Pte. Ltd. <br />
Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a> <br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
Sheather, S. &amp; Jones, M. (1991). A reliable data-based bandwidth selection method for kernel
density estimation, Journal of the Royal Statistical Society, Series B, 53:683-690. <br />
Silverman, B. (1986). Density estimation for Statistics and Data analysis, Chapman and Hall.
Taylor, C. (2008). Automatic bandwith selection for circular density estimation, Computational
Statistics &amp; Data Analysis, 52:3493-3500.
Wand, M. &amp; Jones, M. (1995). Kernel Smoothing, Chapman and Hall.</p>


<h3>Examples</h3>

<pre><code class='language-R'>simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
circ.kernel(simdata, findh(simdata), to = 1, grid = 512, m = 1)
</code></pre>

<hr>
<h2 id='crab'>PSR J0534+2200 (Crab-Pulsar) Time of Arrivals</h2><span id='topic+crab'></span>

<h3>Description</h3>

<p>This data set contains n=21145 time of arrivals of photons with energies above 100MeV of PSR J0534+2200 (Crab-pulsar), obtained from the Fermi LAT.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crab)</code></pre>


<h3>Format</h3>

<p>A vector containing 21145 observation.   
</p>


<h3>Source</h3>

<p>Obtained from Fermi LAT, energies above 100 MeV.</p>


<h3>References</h3>

<p>Abdo A, et al. (2010b). Fermi large area telescope observations of the Crab pulsar and
nebula. The Astronomical Journal, 708, 1254-1267. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crab)
SOPIE(crab)
</code></pre>

<hr>
<h2 id='findh'>Calculate the Estimated Smoothing Parameter
</h2><span id='topic+findh'></span>

<h3>Description</h3>

<p>This function is used to obtain the estimated smoothing parameter <code class="reqn">\hat h</code> that will be
used in the circular kernel density estimator (see <code><a href="#topic+circ.kernel">circ.kernel</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findh(data, h = 1, to = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findh_+3A_data">data</code></td>
<td>
<p>the data vector from which to calculate the estimated 
smoothing parameter <code class="reqn">\hat h</code> that will be used in the circular kernel density estimator.</p>
</td></tr>
<tr><td><code id="findh_+3A_h">h</code></td>
<td>
<p>integer value from 1 to 9, specifying the smoothing parameter to calculate
according to the following table:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_1=1.06sn^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_2=1.06s_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_3=1.06\bar{D}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_4=1.06|{D}_\circ|n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_5=1.06{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_6=\frac{1.06}{1.349}{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_7=0.9s_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_8=\frac{0.9}{1.349}{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_9=\frac{1}{8}\sum _{i=1}^8{h_i}</code>
</td>
</tr>

</table>

</td></tr>
<tr><td><code id="findh_+3A_to">to</code></td>
<td>
<p>the value of the maximum domain of the data. Values will usually
either be 1 or 2<code class="reqn">\pi</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function produces a single real value between 0 and 1, representing the rounded value (to 2 decimal
places) of the estimating smoothing parameter.
</p>


<h3>Author(s)</h3>

<p> Willem Daniel Schutte </p>


<h3>References</h3>

<p>Hall P, Watson G, Cabrera J (1987). Kernel density estimation with spherical data.
Biometrika, 74 (4), 751-762.<br />
Jammalamadaka S, SenGupta A (2001). Topics in circular statistics. World Scientific Publishing
Co. Pte. Ltd.<br />
Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a> <br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
Sheather, S. &amp; Jones, M. (1991). A reliable data-based bandwidth selection method for kernel
density estimation, Journal of the Royal Statistical Society, Series B, 53:683-690. <br />
Silverman, B. (1986). Density estimation for Statistics and Data analysis, Chapman and Hall.
Taylor, C. (2008). Automatic bandwith selection for circular density estimation, Computational
Statistics &amp; Data Analysis, 52:3493-3500.
Wand, M. &amp; Jones, M. (1995). Kernel Smoothing, Chapman and Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
findh(simdata,h=9,to=1)
</code></pre>

<hr>
<h2 id='J1709'>PSR J1709-44290 Time of Arrivals</h2><span id='topic+J1709'></span>

<h3>Description</h3>

<p>This data set contains n=21153 time of arrivals of photons with energies above 100MeV of PSR J1709-44290, obtained from the Fermi LAT.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(J1709)</code></pre>


<h3>Format</h3>

<p>A vector containing 21153 observation.   
</p>


<h3>Source</h3>

<p>Obtained from Fermi LAT, energies above 100 MeV</p>


<h3>References</h3>

<p>Abdo A, et al. (2010). &quot;The first Fermi large area telescope catalog of gamma-ray pulsars.&quot;
The Astrophysical Journal Supplement Series, 187, 460-494. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(J1709)
SOPIE(J1709)
</code></pre>

<hr>
<h2 id='simdata'>Simulated Data from a Scaled Von Mises Distribution with Noise
</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>This simulated data set contains n=5000 observations from a scaled Von Mises distribution with noise (<code class="reqn">\kappa = 1</code>; c = 0.3; <code class="reqn">noise = 0.2</code>). 
Similar data sets can be generated with the function <code><a href="#topic+von_mises_sim">von_mises_sim</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdata)</code></pre>


<h3>Format</h3>

<p>A vector containing 5000 observations.</p>


<h3>Source</h3>

<p>Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a> <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
hist(simdata)
SOPIE(simdata)
</code></pre>

<hr>
<h2 id='SOPIE'>Sequential Off-Pulse Interval Estimation of a Pulsar Light Curve</h2><span id='topic+SOPIE'></span>

<h3>Description</h3>

<p><code>SOPIE</code> is a wrapper-function that utilises <code><a href="#topic+findh">findh</a></code>, <code><a href="#topic+circ.kernel">circ.kernel</a></code>, <code><a href="#topic+a.estimate">a.estimate</a></code>
and <code><a href="#topic+b.estimate">b.estimate</a></code> to produce the estimated off-pulse intervals in an easy readable matrix format, together with
a graph.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SOPIE(data, h = 1, to = 1, alpha = 0.05, g = 20, r = 10, m = 1, grid = 512)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SOPIE_+3A_data">data</code></td>
<td>
<p>the data vector within which to find the estimated 
smoothing parameter <code class="reqn">\hat h</code> that will be used in the circular kernel density estimator. After obtaining the minimum 
point(s) from the circular kernel density estimator, the estimate off-pulse interval <code class="reqn">[\hat a ; \hat b]</code> is given as result.</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_h">h</code></td>
<td>
<p>integer value from 1 to 9, specifying the smoothing parameter to calculate
according to the following table:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_1=1.06sn^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_2=1.06s_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_3=1.06\bar{D}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_4=1.06|{D}_\circ|n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_5=1.06{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_6=\frac{1.06}{1.349}{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_7=0.9s_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_8=\frac{0.9}{1.349}{IQR}_\circ n^{-1/5}</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code class="reqn">\hat h_9=\frac{1}{8}\sum _{i=1}^8{h_i}</code>
</td>
</tr>

</table>

</td></tr>
<tr><td><code id="SOPIE_+3A_to">to</code></td>
<td>
<p> the value of the maximum domain of the data. Values will usually
either be 1 or 2<code class="reqn">\pi</code>.</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_alpha">alpha</code></td>
<td>
<p>significance level (<code class="reqn">\alpha</code>) that will be used during the sequential application 
of the goodness-of-fit tests for uniformity when estimating the off-pulse interval.
</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_g">g</code></td>
<td>
<p> the value of the incremental growth of each subsequent
interval over which uniformity is tested. In the suggested procedure, uniformity is
sequentially tested, with the interval used in the test growing by <code>g</code> observations after
every iteration. The selection of <code>g</code> not only influences the computation time of the
procedure, but also has an effect on the point where rejection of the hypothesis takes
place. For large values of <code>g</code>, the user takes the risk that uniformity is rejected for
a certain (larger) interval, while it should have been rejected earlier (for a smaller
interval). On the other hand, a very small choice of <code>g</code> results in long execution
times. Small values of <code>g</code> may also result in the early rejection of uniformity, e.g.
in the situation where a few observations may cause the rejection of uniformity,
while uniformity is again confirmed when several more observations are included
in the interval. If the user suspects that this situation may occur, the problem can
be overcome by selecting a larger value of the integer <code>r</code>.
</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_r">r</code></td>
<td>
<p> the number of subsequent intervals that must
result in the rejection of uniformity before the function will stop. The choice of <code>r</code>
must therefore be linked to the choice of <code>g</code> as explained above. For smaller values
of <code>g</code>, it would be safer to select larger values of <code>r</code>, and vice versa. Since small values
of <code>g</code> may result in a temporary rejection of uniformity for an interval, a larger value
of <code>r</code> would prevent the method from immediately stopping at the first occurrence
of rejection. It is very important to note that, for a large value of <code>r</code>, there will be
no impact on the value of <code class="reqn">\hat b</code> or <code class="reqn">\hat a</code> if rejection takes place for each interval after a
certain point.</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_m">m</code></td>
<td>
<p> the number of local minimum points included in the output.</p>
</td></tr>
<tr><td><code id="SOPIE_+3A_grid">grid</code></td>
<td>
<p> the number of equally spaced grid points at which the density is to be estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SOPIE is a wrapper-function in the sense that it utilises the function <code><a href="#topic+findh">findh</a></code>, <code><a href="#topic+circ.kernel">circ.kernel</a></code>, <code><a href="#topic+a.estimate">a.estimate</a></code>
and <code><a href="#topic+b.estimate">b.estimate</a></code> to produce
the estimated off-pulse intervals of a pulsar light curve in an easy readable matrix format, together with
a graph consisting of the histogram estimate of the sample data, the kernel density
estimator, and a visual representation of the estimated off-pulse intervals.
</p>


<h3>Value</h3>

<p>The output produced by the function is a list containing the following:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p>is a matrix that contains the estimated value of <code class="reqn">a</code> and <code class="reqn">b</code> for each of
the four goodness-of-fit tests, namely the Anderson-Darling, Kolmogorov-Smirnov,
Cramer-von Mises and the Rayleigh goodness-of-fit test. Based on the four estimated values of <code class="reqn">a</code> and <code class="reqn">b</code>, the median values of <code class="reqn">a</code> and <code class="reqn">b</code> are also calculated.
This median off-pulse interval is the recommended interval and also the interval that is depicted on the graph.
</p>
</td></tr>
<tr><td><code>general</code></td>
<td>
<p>is a list containing the function call, the minimum value(s) used in the
estimation, the level of significance (<code class="reqn">\alpha</code>), the value of <code>g</code> and the value of <code>r</code>.</p>
</td></tr>
</table>
<p>A histogram estimate of the data is produced with the circular kernel density estimate overlaid. An indication of the estimated median off-pulse interval derived from the four goodness-of-fit tests is illustrated with two solid vertical lines. 
</p>


<h3>Author(s)</h3>

<p> Willem Daniel Schutte </p>


<h3>References</h3>

<p>Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a>. <br />
Schutte WD, Swanepoel JWH (2016). SOPIE: an R package for the non-parametric estimation of the off-pulse interval of a pulsar light curve. Monthly Notices of the Royal Astronomical Society, 461, 627-640.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(777)
simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
SOPIE(simdata,h=1,to=1,alpha=0.05,g=5,r=10,m=1,grid=100)
data(crab)
SOPIE(crab)
data(J1709)
SOPIE(J1709)
</code></pre>

<hr>
<h2 id='von_mises_sim'>Generates Simulated Data from a Von Mises Distribution with Noise
</h2><span id='topic+von_mises_sim'></span>

<h3>Description</h3>

<p>Generates simulated data over the interval <code class="reqn">[0; 1]</code> from a scaled Von Mises distribution with noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>von_mises_sim(n = 5000, k = 1, c = 0.3, noise = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="von_mises_sim_+3A_n">n</code></td>
<td>
<p>number of random variates in the simulated data set.</p>
</td></tr>
<tr><td><code id="von_mises_sim_+3A_k">k</code></td>
<td>
<p>concentration parameter <code class="reqn">\kappa</code> of the Von Mises distribution.</p>
</td></tr>
<tr><td><code id="von_mises_sim_+3A_c">c</code></td>
<td>
<p>the point of truncation of the Von Mises distribution. The value of c represent that value in the interval <code class="reqn">[0; c]</code> and <code class="reqn">[1-c; 1]</code> where the Von Mises density is remove, i.e. <code class="reqn">f(\theta) = 0</code> for <code class="reqn">\theta \in [0 ; c]</code> and <code class="reqn">\theta \in [1-c ; 1]</code>
where <code class="reqn">f(\theta)</code> is the Von Mises density function.</p>
</td></tr>
<tr><td><code id="von_mises_sim_+3A_noise">noise</code></td>
<td>
<p>proportion of random noise to include in the simulated data set. If <code>n</code> random variates are required,
then <code class="reqn">\lfloor (1-noise)n \rfloor</code> values are generated from the Von Mises density and the remainder from an uniform density.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output vector of this function is <code class="reqn">n</code> random variates in the interval <code class="reqn">[0; 1]</code> from a scaled Von Mises density with uniform noise proportional to <code>noise</code>.
</p>


<h3>Author(s)</h3>

<p>Willem Daniel Schutte </p>


<h3>References</h3>

<p>Jammalamadaka, S. Rao and SenGupta, A. (2001). Topics in Circular Statistics, World Scientific Publishing Co. Pte. Ltd. <br />
Robert CP, Casella G (2010). Introducing Monte Carlo methods with R. Springer. <br />
Schutte WD (2014). Nonparametric estimation of the off-pulse interval(s) of a pulsar light
curve. Ph.D. thesis, North-West University. URL <a href="http://hdl.handle.net/10394/12199">http://hdl.handle.net/10394/12199</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="circular.html#topic+pvonmises">pvonmises</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(777)
simdata&lt;-von_mises_sim(n=5000,k=1,c=0.3,noise=0.2)
hist(simdata)
SOPIE(simdata,h=1,to=1,alpha=0.05,g=5,r=10,m=1,grid=100)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
