<!DOCTYPE html><html><head><title>Help for package REDCapR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REDCapR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#REDCapR-package'><p>R utilities for interacting with a REDCap data system</p>
<a href="https://www.project-redcap.org/">https://www.project-redcap.org/</a></a></li>
<li><a href='#collapse_vector'><p>Collapse a vector of values into a single string when necessary</p></a></li>
<li><a href='#constant'><p>Collection of REDCap-specific constants</p></a></li>
<li><a href='#create_batch_glossary'><p>Creates a dataset that help batching long-running</p>
read and writes</a></li>
<li><a href='#kernel_api'><p>REDCapR internal function for calling the REDCap API</p></a></li>
<li><a href='#metadata_utilities'><p>Manipulate and interpret the metadata of a REDCap project</p></a></li>
<li><a href='#redcap_arm_export'><p>Export Arms</p></a></li>
<li><a href='#redcap_column_sanitize'><p>Sanitize to adhere to REDCap character encoding requirements</p></a></li>
<li><a href='#redcap_dag_read'><p>Read data access groups from a REDCap project</p></a></li>
<li><a href='#redcap_delete'><p>Delete records in a REDCap project</p></a></li>
<li><a href='#redcap_download_file_oneshot'><p>Download a file from a REDCap project record</p></a></li>
<li><a href='#redcap_download_instrument'><p>Download REDCap Instruments</p></a></li>
<li><a href='#redcap_event_instruments'><p>Enumerate the instruments to event mappings</p></a></li>
<li><a href='#redcap_instruments'><p>Enumerate the instruments (forms)</p></a></li>
<li><a href='#redcap_metadata_read'><p>Export the metadata of a REDCap project</p></a></li>
<li><a href='#redcap_metadata_write'><p>Import metadata of a REDCap project</p></a></li>
<li><a href='#redcap_next_free_record_name'><p>Determine free available record ID</p></a></li>
<li><a href='#redcap_project'><p>A Reference Class to make later calls to REDCap more convenient</p></a></li>
<li><a href='#redcap_read'><p>Read records from a REDCap project in subsets, and stacks them</p>
together before returning a dataset</a></li>
<li><a href='#redcap_read_oneshot'><p>Read/Export records from a REDCap project</p></a></li>
<li><a href='#redcap_read_oneshot_eav'><p>Read/Export records from a REDCap project &ndash;still in development</p></a></li>
<li><a href='#redcap_report'><p>Read/Export records that populate a REDCap report</p></a></li>
<li><a href='#redcap_survey_link_export_oneshot'><p>Download a file from a REDCap project record</p></a></li>
<li><a href='#redcap_upload_file_oneshot'><p>Upload a file into to a REDCap project record</p></a></li>
<li><a href='#redcap_users_export'><p>List authorized users</p></a></li>
<li><a href='#redcap_variables'><p>Enumerate the exported variables</p></a></li>
<li><a href='#redcap_version'><p>Determine version of REDCap instance</p></a></li>
<li><a href='#redcap_write'><p>Write/Import records to a REDCap project</p></a></li>
<li><a href='#redcap_write_oneshot'><p>Write/Import records to a REDCap project</p></a></li>
<li><a href='#replace_nas_with_explicit'><p>Create explicit factor level for missing values</p></a></li>
<li><a href='#retrieve_credential'><p>Read a token and other credentials from a (non-REDCap)</p>
database or file</a></li>
<li><a href='#sanitize_token'><p>Validate and sanitize the user's REDCap token</p></a></li>
<li><a href='#validate'><p>Inspect a dataset to anticipate problems before</p>
writing to a REDCap project</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interaction Between R and REDCap</td>
</tr>
<tr>
<td>Description:</td>
<td>Encapsulates functions to streamline calls from R to the REDCap
    API.  REDCap (Research Electronic Data CAPture) is a web application for
    building and managing online surveys and databases developed at Vanderbilt
    University.  The Application Programming Interface (API) offers an avenue
    to access and modify data programmatically, improving the capacity for
    literate and reproducible programming.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ouhscbbmc.github.io/REDCapR/">https://ouhscbbmc.github.io/REDCapR/</a>,
<a href="https://github.com/OuhscBbmc/REDCapR">https://github.com/OuhscBbmc/REDCapR</a>,
<a href="https://www.ouhsc.edu/bbmc/">https://www.ouhsc.edu/bbmc/</a>, <a href="https://project-redcap.org">https://project-redcap.org</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OuhscBbmc/REDCapR/issues">https://github.com/OuhscBbmc/REDCapR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 2.0), dplyr (&ge; 1.0), httr (&ge; 1.4.0), jsonlite,
magrittr (&ge; 1.5), methods, readr (&ge; 2.0), rlang (&ge; 0.4),
tibble (&ge; 2.0), tidyr (&ge; 1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, covr (&ge; 3.4), DBI (&ge; 1.1), kableExtra (&ge; 1.0),
knitr (&ge; 1.18), odbc (&ge; 1.1.1), rmarkdown (&ge; 2.0),
sessioninfo (&ge; 1.1.1), testthat (&ge; 3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-10 14:25:17 UTC; wibeasley</td>
</tr>
<tr>
<td>Author:</td>
<td>Will Beasley <a href="https://orcid.org/0000-0002-5613-5006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  David Bard [ctb],
  Thomas Wilson [ctb],
  John J Aponte [ctb],
  Rollie Parrish [ctb],
  Benjamin Nutter [ctb],
  Andrew Peters [ctb],
  Hao Zhu <a href="https://orcid.org/0000-0002-3386-6076"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Janosch Linkersd√∂rfer
    <a href="https://orcid.org/0000-0002-1577-1233"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Jonathan Mang <a href="https://orcid.org/0000-0003-0518-4710"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Felix Torres [ctb],
  Philip Chase [ctb],
  Victor Castro <a href="https://orcid.org/0000-0001-7390-6354"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Will Beasley &lt;wibeasley@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-10 16:10:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='REDCapR-package'>R utilities for interacting with a REDCap data system
<a href="https://www.project-redcap.org/">https://www.project-redcap.org/</a></h2><span id='topic+REDCapR-package'></span><span id='topic+REDCapR'></span>

<h3>Description</h3>

<p>Comprehensive documentation is also available at
https://ouhscbbmc.github.io/REDCapR/.
</p>
<p>Much of this package has been developed to support the needs of the
following projects.  We appreciate the support.
</p>

<ul>
<li> <p><em>OUHSC CCAN Independent Evaluation of the State of Oklahoma Competitive
Maternal, Infant, and Early Childhood Home Visiting
(<a href="https://mchb.hrsa.gov/maternal-child-health-initiatives/home-visiting-overview">MIECHV</a>) Project</em>.
HRSA/ACF D89MC23154.
David Bard, PI, OUHSC; 2011-2015.
</p>
</li>
<li> <p><em>Independent Evaluation of the State of OK MIECHV Evidence Based Home
Visitation Project</em>, <a href="https://www.nih.gov/">NIH</a>-sponsored collaboration
with <a href="https://oklahoma.gov/health.html">OSDH</a>.
David Bard, PI, OUHSC; 2015-2017.
</p>
</li>
<li> <p><em>OSDH ParentPRO Pilot Evaluation</em>, federally-sponsored collaboration
with <a href="https://oklahoma.gov/health.html">OSDH</a>.
David Bard, PI, OUHSC; 2015-2017.
</p>
</li>
<li> <p><em>Title IV-E Waiver Project</em>, <a href="https://mchb.hrsa.gov/">HRSA/MCHB</a>-sponsored
collaboration with <a href="https://oklahoma.gov/okdhs.html">OKDHS</a>;
David Bard, PI, OUHSC; 2014-2017.
</p>
</li>
<li> <p><em>Integrative Analysis of Longitudinal Studies of Aging (IALSA)</em>,
sponsored by <a href="https://grantome.com/grant/NIH/P01-AG043362-05">NIH 5P01AG043362</a>.
Scott Hofer, PI, University of Victoria;
Will Beasley, PI of site-award, OUHSC; 2013-2018.
</p>
</li>
<li> <p><em>Oklahoma Shared Clinical and Translational Resources</em>, sponsored by
<a href="https://grantome.com/grant/NIH/U54-GM104938">NIH NIGMS; U54 GM104938</a>.
Judith A. James, PI, OUHSC; 2013-2018.
</p>
</li>
<li><p> Additional Institutional Support from OUHSC
<a href="https://medicine.ouhsc.edu/Academic-Departments/Pediatrics">Dept of Pediatrics</a>;
2013-2017.
</p>
</li></ul>



<h3>Note</h3>

<p>The release version is available through
<a href="https://cran.r-project.org/package=REDCapR">CRAN</a> by running
<code>install.packages('REDCapR')</code>.  The most recent development version is
available through <a href="https://github.com/OuhscBbmc/REDCapR">GitHub</a> by
running <code>remotes::install_github('OuhscBbmc/REDCapR')</code>
(make sure <a href="https://cran.r-project.org/package=remotes">remotes</a> is
already installed). If you're having trouble with the package, please
install the development version.  If this doesn't solve your problem,
please create a <a href="https://github.com/OuhscBbmc/REDCapR/issues">new issue</a>,
or email Will.
</p>
<p>See REDCapR's advanced vignette for information and examples for overriding
the default SSL options.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Install/update REDCapR with the release version from CRAN.
install.packages('REDCapR')

# Install/update REDCapR with the development version from GitHub
# install.packages("remotes") # Uncomment if `remotes` isn't installed already.
remotes::install_github('OuhscBbmc/REDCapR')

## End(Not run)
</code></pre>

<hr>
<h2 id='collapse_vector'>Collapse a vector of values into a single string when necessary</h2><span id='topic+collapse_vector'></span>

<h3>Description</h3>

<p>REDCap's API frequently specifies a series of values
separated by commas.
In the R world, it's easier to keep these values as separate elements in a
vector. This functions squashes them together in a single character element
(presumably right before the return value is passed to the API)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collapse_vector(elements, collapsed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapse_vector_+3A_elements">elements</code></td>
<td>
<p>An array of values.  Can be <code>NULL</code>.  Required.</p>
</td></tr>
<tr><td><code id="collapse_vector_+3A_collapsed">collapsed</code></td>
<td>
<p>A single character element, where the values are separated
by commas.  Can be <code>NULL</code>.  Required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single character element, where the values are separated by
commas.  Can be blank. (<em>i.e.</em>, <code>""</code>).
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(REDCapR) #Load the package into the current R session.
REDCapR:::collapse_vector(elements=NULL, collapsed=NULL)
REDCapR:::collapse_vector(elements=letters, collapsed=NULL)
REDCapR:::collapse_vector(elements=NULL, collapsed="4,5,6")
</code></pre>

<hr>
<h2 id='constant'>Collection of REDCap-specific constants</h2><span id='topic+constant'></span><span id='topic+constant_to_form_completion'></span><span id='topic+constant_to_form_rights'></span><span id='topic+constant_to_export_rights'></span><span id='topic+constant_to_access'></span>

<h3>Description</h3>

<p>Collection of constants defined by the REDCap developers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constant(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="constant_+3A_name">name</code></td>
<td>
<p>Name of constant.  Required character.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Form Completeness</strong>
</p>
<p>The current constants relate to the 'complete' variable at the
end of each form.
</p>

<ul>
<li> <p><code>form_incomplete</code>: 0L (<em>i.e.</em>, an integer)
</p>
</li>
<li> <p><code>form_unverified</code>: 1L
</p>
</li>
<li> <p><code>form_complete</code>: 2L
</p>
</li></ul>

<p><strong>Export Rights</strong>
</p>
<p>See https://your-server/redcap/api/help/?content=exp_users.
</p>

<ul>
<li> <p><code>data_export_rights_no_access</code>    : 0L
</p>
</li>
<li> <p><code>data_export_rights_deidentified</code> : 1L
</p>
</li>
<li> <p><code>data_export_rights_full</code>         : 2L
</p>
</li></ul>

<p><strong>Form Rights</strong>
</p>
<p>See https://your-server/redcap/api/help/?content=exp_users.
The order of these digits may be unexpected.
</p>

<ul>
<li> <p><code>form_rights_no_access</code>    : 0L
</p>
</li>
<li> <p><code>form_rights_readonly</code>     : 2L
</p>
</li>
<li> <p><code>form_rights_edit_form</code>    : 1L
</p>
</li>
<li> <p><code>form_rights_edit_survey</code>  : 3L
</p>
</li></ul>

<p><strong>Access Rights</strong>
</p>
<p>See https://your-server/redcap/api/help/?content=exp_users.
</p>

<ul>
<li> <p><code>access_no</code>    : 0L
</p>
</li>
<li> <p><code>access_yes</code>   : 1L
</p>
</li></ul>

<p>To add more, please for and edit
<a href="https://github.com/OuhscBbmc/REDCapR/blob/master/R/constant.R">constant.R</a>
on GitHub and submit a pull request.  For instructions, please see
<a href="https://docs.github.com/articles/editing-files-in-another-user-s-repository/">Editing files in another user's repository</a> # nolint
in the GitHub documentation.
</p>


<h3>Value</h3>

<p>The constant's value.  Currently all are single integers,
but that could be expanded in the future.
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>REDCapR::constant("form_incomplete")  # Returns 0L
REDCapR::constant("form_unverified")  # Returns 1L
REDCapR::constant("form_complete"  )  # Returns 2L

REDCapR::constant("data_export_rights_no_access"   )  # Returns 0L
REDCapR::constant("data_export_rights_deidentified")  # Returns 1L
REDCapR::constant("data_export_rights_full"        )  # Returns 2L

REDCapR::constant("form_rights_no_access")   # Returns 0L
REDCapR::constant("form_rights_readonly" )   # Returns 2L --Notice the order
REDCapR::constant("form_rights_edit_form")   # Returns 1L
REDCapR::constant("form_rights_edit_survey") # Returns 3L

REDCapR::constant("access_no" )  # Returns 0L
REDCapR::constant("access_yes")  # Returns 1L

REDCapR::constant(c(
  "form_complete",
  "form_complete",
  "form_incomplete"
)) # Returns c(2L, 2L, 0L)
REDCapR::constant(c(
  "form_rights_no_access",
  "form_rights_readonly",
  "form_rights_edit_form",
  "form_rights_edit_survey"
)) # Returns c(0L, 2L, 1L, 3L)


constant_to_form_completion( c(0, 2, 1, 2, NA))
constant_to_form_rights(     c(0, 2, 1, 2, NA))
constant_to_export_rights(   c(0, 2, 1, 3, NA))
constant_to_access(          c(0, 1, 1, 0, NA))

## Not run: 
# The following line returns an error:
#     Assertion on 'name' failed: Must be a subset of
#     {'form_complete','form_incomplete','form_unverified'},
#     but is {'bad-name'}.

REDCapR::constant("bad-name")    # Returns an error

REDCapR::constant(c("form_complete", "bad-name")) # Returns an error

## End(Not run)
</code></pre>

<hr>
<h2 id='create_batch_glossary'>Creates a dataset that help batching long-running
read and writes</h2><span id='topic+create_batch_glossary'></span>

<h3>Description</h3>

<p>The function returns a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> that other
functions use to separate long-running read and write REDCap calls into
multiple, smaller REDCap calls.  The goal is to (1) reduce the chance of
time-outs, and (2) introduce little breaks between batches so that the
server isn't continually tied up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_batch_glossary(row_count, batch_size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_batch_glossary_+3A_row_count">row_count</code></td>
<td>
<p>The number records in the large dataset, before it's split.</p>
</td></tr>
<tr><td><code id="create_batch_glossary_+3A_batch_size">batch_size</code></td>
<td>
<p>The maximum number of subject records a single batch
should contain.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can also assist splitting and saving a large
<code><a href="base.html#topic+data.frame">base::data.frame()</a></code> to disk as smaller files (such as a .csv).  The
padded columns allow the OS to sort the batches/files in sequential order.
</p>


<h3>Value</h3>

<p>Currently, a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> is returned with the following
columns,
</p>

<ul>
<li> <p><code>id</code>: an <code>integer</code> that uniquely identifies the batch, starting at <code>1</code>.
</p>
</li>
<li> <p><code>start_index</code>: the index of the first row in the batch. <code>integer</code>.
</p>
</li>
<li> <p><code>stop_index</code>: the index of the last row in the batch. <code>integer</code>.
</p>
</li>
<li> <p><code>id_pretty</code>: a <code>character</code> representation of <code>id</code>, but padded with zeros.
</p>
</li>
<li> <p><code>start_index</code>: a <code>character</code> representation of <code>start_index</code>, but padded
with zeros.
</p>
</li>
<li> <p><code>stop_index</code>: a <code>character</code> representation of <code>stop_index</code>, but padded
with zeros.
</p>
</li>
<li> <p><code>label</code>: a <code>character</code> concatenation of <code>id_pretty</code>, <code>start_index</code>, and
<code>stop_index_pretty</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+redcap_read">redcap_read()</a></code> for a function that uses <code>create_batch_gloassary</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>REDCapR::create_batch_glossary(100, 50)
REDCapR::create_batch_glossary(100, 25)
REDCapR::create_batch_glossary(100, 3)
d &lt;- data.frame(
  record_id = 1:100,
  iv        = sample(x=4, size=100, replace=TRUE),
  dv        = rnorm(n=100)
)
REDCapR::create_batch_glossary(nrow(d), batch_size=40)
</code></pre>

<hr>
<h2 id='kernel_api'>REDCapR internal function for calling the REDCap API</h2><span id='topic+kernel_api'></span>

<h3>Description</h3>

<p>This function is used by other functions to read and write
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel_api(
  redcap_uri,
  post_body,
  config_options,
  encoding = "UTF-8",
  content_type = "text/csv"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel_api_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="kernel_api_+3A_post_body">post_body</code></td>
<td>
<p>List of contents expected by the REDCap API.  Required.</p>
</td></tr>
<tr><td><code id="kernel_api_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below.  Optional.</p>
</td></tr>
<tr><td><code id="kernel_api_+3A_encoding">encoding</code></td>
<td>
<p>The encoding value passed to <code><a href="httr.html#topic+content">httr::content()</a></code>.  Defaults
to 'UTF-8'.</p>
</td></tr>
<tr><td><code id="kernel_api_+3A_content_type">content_type</code></td>
<td>
<p>The MIME value passed to <code><a href="httr.html#topic+content">httr::content()</a></code>.  Defaults
to 'text/csv'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the API call is unsuccessful, a value of
<code>base::package_version("0.0.0")</code> will be returned.  This ensures that a
the function will always return an object of class <a href="base.html#topic+numeric_version">base::package_version</a>.
It guarantees the value can always be used in <code><a href="utils.html#topic+compareVersion">utils::compareVersion()</a></code>.
</p>


<h3>Value</h3>

<p>A <a href="utils.html#topic+packageDescription">utils::packageVersion</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>config_options &lt;- NULL
uri            &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token          &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
post_body      &lt;- list(
  token    = token,
  content  = 'project',
  format   = 'csv'
)
## Not run: 
kernel &lt;- REDCapR:::kernel_api(uri, post_body, config_options)

# Consume the results in a few different ways.
kernel$result
read.csv(text=kernel$raw_text)
as.list(read.csv(text=kernel$raw_text))

## End(Not run)
</code></pre>

<hr>
<h2 id='metadata_utilities'>Manipulate and interpret the metadata of a REDCap project</h2><span id='topic+metadata_utilities'></span><span id='topic+regex_named_captures'></span><span id='topic+checkbox_choices'></span>

<h3>Description</h3>

<p>A collection of functions that assists handling REDCap
project metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regex_named_captures(pattern, text, perl = TRUE)

checkbox_choices(select_choices)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metadata_utilities_+3A_pattern">pattern</code></td>
<td>
<p>The regular expression pattern.  Required.</p>
</td></tr>
<tr><td><code id="metadata_utilities_+3A_text">text</code></td>
<td>
<p>The text to apply the regex against.  Required.</p>
</td></tr>
<tr><td><code id="metadata_utilities_+3A_perl">perl</code></td>
<td>
<p>Indicates if perl-compatible regexps should be used.
Default is <code>TRUE</code>. Optional.</p>
</td></tr>
<tr><td><code id="metadata_utilities_+3A_select_choices">select_choices</code></td>
<td>
<p>The text containing the choices that should be parsed
to determine the <code>id</code> and <code>label</code> values.  Required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+regex_named_captures">regex_named_captures()</a></code> function is general, and not specific to
REDCap; it accepts any arbitrary regular expression.
It returns a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> with as many columns as named matches.
</p>
<p>The <code><a href="#topic+checkbox_choices">checkbox_choices()</a></code> function is specialized, and accommodates the
&quot;select choices&quot; for a <em>single</em> REDCap checkbox group (where multiple boxes
can be selected).  It returns a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> with two columns, one
for the numeric id and one for the text label.
</p>


<h3>Value</h3>

<p>Currently, a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> is returned a row for each match,
and a column for each <em>named</em> group within a match.  For the
<code>retrieve_checkbox_choices()</code> function, the columns will be.
</p>

<ul>
<li> <p><code>id</code>: The numeric value assigned to each choice (in the data dictionary).
</p>
</li>
<li> <p><code>label</code>: The label assigned to each choice (in the data dictionary).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>See the official documentation for permissible characters in a
checkbox label.
<em>I'm bluffing here, because I don't know where this is located.
If you know, please tell me.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The weird ranges are to avoid the pipe character;
#   PCRE doesn't support character negation.
pattern_boxes &lt;- "(?&lt;=\\A| \\| )(?&lt;id&gt;\\d{1,}), (?&lt;label&gt;[\x20-\x7B\x7D-\x7E]{1,})(?= \\| |\\Z)"

choices_1 &lt;- paste0(
  "1, American Indian/Alaska Native | ",
  "2, Asian | ",
  "3, Native Hawaiian or Other Pacific Islander | ",
  "4, Black or African American | ",
  "5, White | ",
  "6, Unknown / Not Reported")

# This calls the general function, and requires the correct regex pattern.
REDCapR::regex_named_captures(pattern=pattern_boxes, text=choices_1)

# This function is designed specifically for the checkbox values.
REDCapR::checkbox_choices(select_choices=choices_1)

## Not run: 
uri         &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token       &lt;- "9A81268476645C4E5F03428B8AC3AA7B"

ds_metadata &lt;- redcap_metadata_read(redcap_uri=uri, token=token)$data
choices_2   &lt;- ds_metadata[ds_metadata$field_name=="race", "select_choices_or_calculations"]

REDCapR::regex_named_captures(pattern=pattern_boxes, text=choices_2)

## End(Not run)

path_3         &lt;- system.file(package="REDCapR", "test-data/project-simple/simple-metadata.csv")
ds_metadata_3  &lt;- read.csv(path_3)
choices_3      &lt;- ds_metadata_3[ds_metadata_3$field_name=="race", "select_choices_or_calculations"]
REDCapR::regex_named_captures(pattern=pattern_boxes, text=choices_3)
</code></pre>

<hr>
<h2 id='redcap_arm_export'>Export Arms</h2><span id='topic+redcap_arm_export'></span>

<h3>Description</h3>

<p>Export Arms of a REDCap project
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_arm_export(redcap_uri, token, verbose = TRUE, config_options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_arm_export_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_arm_export_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_arm_export_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_arm_export_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>. Optional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>has_arms</code>: a <code>logical</code> value indicating if the REDCap project has
arms (<em>i.e.</em>, &quot;TRUE&quot;) or is a classic non-longitudinal project
(<em>i.e.</em>, &quot;FALSE&quot;).
</p>
</li>
<li> <p><code>data</code>: a <code><a href="dplyr.html#topic+tibble">tibble</a></code> with one row per arm.  The columns are
<code>arm_number</code> (an integer) and <code>arm_name</code> (a human-friendly string).
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri            &lt;- "https://bbmc.ouhsc.edu/redcap/api/"

# Query a classic project with 3 arms
token_1  &lt;- "CDF9F3767E413FDBAA31D92E9F36730A"
result_1 &lt;- REDCapR::redcap_arm_export(redcap_uri=uri, token=token_1)
result_1$has_arms
result_1$data

# Query a classic project without arms
token_2  &lt;- "D70F9ACD1EDD6F151C6EA78683944E98"
result_2 &lt;- REDCapR::redcap_arm_export(redcap_uri=uri, token=token_2)
result_2$has_arms
result_2$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_column_sanitize'>Sanitize to adhere to REDCap character encoding requirements</h2><span id='topic+redcap_column_sanitize'></span>

<h3>Description</h3>

<p>Replace non-ASCII characters with legal characters that won't
cause problems when writing to a REDCap project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_column_sanitize(
  d,
  column_names = colnames(d),
  encoding_initial = "latin1",
  substitution_character = "?"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_column_sanitize_+3A_d">d</code></td>
<td>
<p>The <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> containing the dataset used to update
the REDCap project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_column_sanitize_+3A_column_names">column_names</code></td>
<td>
<p>An array of <code>character</code> values indicating the names of
the variables to sanitize.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_column_sanitize_+3A_encoding_initial">encoding_initial</code></td>
<td>
<p>An array of <code>character</code> values indicating the names
of the variables to sanitize.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_column_sanitize_+3A_substitution_character">substitution_character</code></td>
<td>
<p>The <code>character</code> value that replaces characters
that were unable to be appropriately matched.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Letters like an accented 'A' are replaced with a plain 'A'.
</p>
<p>This is a thin wrapper around <code><a href="base.html#topic+iconv">base::iconv()</a></code>.
The <code style="white-space: pre;">&#8288;ASCII//TRANSLIT&#8288;</code> option does the actual transliteration work.  As of
<code style="white-space: pre;">&#8288;R 3.1.0&#8288;</code>, the OSes use similar, but different, versions to convert the
characters.  Be aware of this in case you notice OS-dependent differences.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> with same columns, but whose character values
have been sanitized.
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Typical examples are not shown because they require non-ASCII encoding,
#   which makes the package documentation less portable.

dirty &lt;- data.frame(
  id     = 1:3,
  names  = c("Ekstr\xf8m", "J\xf6reskog", "bi\xdfchen Z\xfcrcher")
)

REDCapR::redcap_column_sanitize(dirty)
</code></pre>

<hr>
<h2 id='redcap_dag_read'>Read data access groups from a REDCap project</h2><span id='topic+redcap_dag_read'></span>

<h3>Description</h3>

<p>This function reads all available data access groups from
REDCap an returns them as a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_dag_read(
  redcap_uri,
  token,
  http_response_encoding = "UTF-8",
  locale = readr::default_locale(),
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_dag_read_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_dag_read_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_dag_read_+3A_http_response_encoding">http_response_encoding</code></td>
<td>
<p>The encoding value passed to
<code><a href="httr.html#topic+content">httr::content()</a></code>.  Defaults to 'UTF-8'.</p>
</td></tr>
<tr><td><code id="redcap_dag_read_+3A_locale">locale</code></td>
<td>
<p>a <code><a href="readr.html#topic+locale">readr::locale()</a></code> object to specify preferences like
number, date, and time formats.  This object is passed to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Defaults to <code><a href="readr.html#topic+locale">readr::default_locale()</a></code>.</p>
</td></tr>
<tr><td><code id="redcap_dag_read_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_dag_read_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of all data access groups of the project.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_codes</code>: A collection of
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status codes</a>,
separated by semicolons.  There is one code for each batch attempted.
</p>
</li>
<li> <p><code>outcome_messages</code>: A collection of human readable strings indicating the
operations' semicolons.  There is one code for each batch attempted.  In an
unsuccessful operation, it should contain diagnostic information.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jonathan M. Mang
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html
and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
REDCapR::redcap_dag_read(redcap_uri=uri, token=token)$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_delete'>Delete records in a REDCap project</h2><span id='topic+redcap_delete'></span>

<h3>Description</h3>

<p>Delete existing records by their ID from REDCap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_delete(
  redcap_uri,
  token,
  records_to_delete,
  arm_of_records_to_delete = NULL,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_delete_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_delete_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_delete_+3A_records_to_delete">records_to_delete</code></td>
<td>
<p>A character vector of the project's <code>record_id</code>
values to delete.  Required.</p>
</td></tr>
<tr><td><code id="redcap_delete_+3A_arm_of_records_to_delete">arm_of_records_to_delete</code></td>
<td>
<p>A single integer reflecting the arm
containing the records to be deleted.  Leave it as NULL if the project
has no arms and is not longitudinal. Required if the REDCap project
has arms.  See Details below.</p>
</td></tr>
<tr><td><code id="redcap_delete_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_delete_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>REDCap requires that at least one <code>record_id</code> value be passed to
the delete call.
</p>
<p>When the project has arms, REDCapR has stricter requirements than REDCap.
If the REDCap project has arms, a value must be passed to
<code>arm_of_records_to_delete</code>.  This is a different behavior than calling
the server through cURL &ndash;which if no  arm number is specified,
then all arms are cleared of the specified <code>record_id</code>s.
</p>
<p>Note that all longitudinal projects technically have arms, even if
only one arm is defined.  Therefore a value of <code>arm_number</code> must be
specified for all longitudinal projects.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jonathan Mang, Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
records_to_delete &lt;- c(102, 103, 105, 120)

# Deleting from a non-longitudinal project with no defined arms:
REDCapR::redcap_delete(
  redcap_uri               = uri,
  token                    = token,
  records_to_delete        = records_to_delete,
)

# Deleting from a project that has arms or is longitudinal:
arm_number &lt;- 2L # Not the arm name
REDCapR::redcap_delete(
  redcap_uri               = uri,
  token                    = token,
  records_to_delete        = records_to_delete,
  arm_of_records_to_delete = arm_number
)

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_download_file_oneshot'>Download a file from a REDCap project record</h2><span id='topic+redcap_download_file_oneshot'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to download a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_download_file_oneshot(
  file_name = NULL,
  directory = NULL,
  overwrite = FALSE,
  redcap_uri,
  token,
  record,
  field,
  event = "",
  repeat_instrument = NULL,
  repeat_instance = NULL,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_download_file_oneshot_+3A_file_name">file_name</code></td>
<td>
<p>The name of the file where the downloaded file is saved.
If empty the original name of the file will be used and saved in the
default directory.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_directory">directory</code></td>
<td>
<p>The directory where the file is saved. By default current
directory. Optional</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_overwrite">overwrite</code></td>
<td>
<p>Boolean value indicating if existing files should be
overwritten. Optional</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_record">record</code></td>
<td>
<p>The record ID where the file is to be imported. Required</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_field">field</code></td>
<td>
<p>The name of the field where the file is saved in REDCap.
Required</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_event">event</code></td>
<td>
<p>The name of the event where the file is saved in REDCap.
Optional</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_repeat_instrument">repeat_instrument</code></td>
<td>
<p>The name of the instrument that is repeating
for a given event.
Optional</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_repeat_instance">repeat_instance</code></td>
<td>
<p>(only for projects with repeating instruments/events)
The repeat instance number of the repeating event (if longitudinal) or the
repeating instrument (if classic or longitudinal). Default value is '1'.
Optional</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_file_oneshot_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code><a href="httr.html#topic+POST">httr::POST()</a></code> method
in the 'httr' package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.  See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper
function that checks for some common important conflicts.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>affected_ids</code>: The subject IDs of the inserted or updated records.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li>
<li> <p><code>file_name</code>: The name of the file persisted to disk. This is useful if
the name stored in REDCap is used (which is the default).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley, John J. Aponte
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "D70F9ACD1EDD6F151C6EA78683944E98" #pid=213
record  &lt;- 1
field   &lt;- "mugshot"
# event &lt;- "" # only for longitudinal projects

result_1 &lt;- REDCapR::redcap_download_file_oneshot(
  record        = record,
  field         = field,
  redcap_uri    = uri,
  token         = token
)
base::unlink("mugshot-1.jpg")

(full_name &lt;- base::tempfile(pattern="mugshot", fileext=".jpg"))
result_2   &lt;- REDCapR::redcap_download_file_oneshot(
  file_name     = full_name,
  record        = record,
  field         = field,
  redcap_uri    = uri,
  token         = token
)
base::unlink(full_name)

(relative_name &lt;- "ssss.jpg")
result_3 &lt;- REDCapR::redcap_download_file_oneshot(
  file_name    = relative_name,
  record       = record,
  field        = field,
  redcap_uri   = uri,
  token        = token
)
base::unlink(relative_name)

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_download_instrument'>Download REDCap Instruments</h2><span id='topic+redcap_download_instrument'></span>

<h3>Description</h3>

<p>Download instruments as a pdf, with or without responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_download_instrument(
  file_name = NULL,
  directory = NULL,
  overwrite = FALSE,
  redcap_uri,
  token,
  record = character(0),
  instrument = "",
  event = "",
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_download_instrument_+3A_file_name">file_name</code></td>
<td>
<p>The name of the file where the downloaded pdf is saved.
Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_directory">directory</code></td>
<td>
<p>The directory where the file is saved. By default current
directory. Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_overwrite">overwrite</code></td>
<td>
<p>Boolean value indicating if existing files should be
overwritten. Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_record">record</code></td>
<td>
<p>The record ID of the instrument(s).  If empty, the responses
are blank.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_instrument">instrument</code></td>
<td>
<p>The instrument(s) to download.  If empty, all instruments
are returned.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_event">event</code></td>
<td>
<p>The unique event name. For a longitudinal project, if record is
not blank and event is blank, it will return data for all events from that
record. If record is not blank and event is not blank, it will return data
only for the specified event from that record. Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_download_instrument_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code><a href="httr.html#topic+POST">httr::POST()</a></code> method
in the 'httr' package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.  See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper
function that checks for some common important conflicts.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>record_id</code>: The record_id of the instrument.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li>
<li> <p><code>file_name</code>: The name of the file persisted to disk. This is useful if
the name stored in REDCap is used (which is the default).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "D70F9ACD1EDD6F151C6EA78683944E98" #pid=213
# event &lt;- "" # only for longitudinal projects

(full_name &lt;- base::temp(pattern="instruments-all-records-all", fileext=".pdf"))
result_1   &lt;- REDCapR::redcap_download_instrument(
  file_name     = full_name,
  redcap_uri    = uri,
  token         = token
)
base::unlink(full_name)

(full_name &lt;- base::tempfile(pattern="instruments-all-record-1-", fileext=".pdf"))
result_2   &lt;- REDCapR::redcap_download_instrument(
  record        = 5,
  file_name     = full_name,
  redcap_uri    = uri,
  token         = token
)
base::unlink(full_name)
(full_name &lt;- base::tempfile(pattern="instrument-1-record-1-", fileext=".pdf"))
result_3   &lt;- REDCapR::redcap_download_instrument(
  record        = 5,
  instrument    = "health",
  file_name     = full_name,
  redcap_uri    = uri,
  token         = token
)
base::unlink(full_name)

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_event_instruments'>Enumerate the instruments to event mappings</h2><span id='topic+redcap_event_instruments'></span>

<h3>Description</h3>

<p>Export the instrument-event mappings for a project
(i.e., how the data collection instruments are designated for certain
events in a longitudinal project).
(Copied from &quot;Export Instrument-Event Mappings&quot; method of
REDCap API documentation, v.10.5.1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_event_instruments(
  redcap_uri,
  token,
  arms = c("1"),
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_event_instruments_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_event_instruments_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_event_instruments_+3A_arms">arms</code></td>
<td>
<p>A character string of arms to retrieve.  (Default: '1')</p>
</td></tr>
<tr><td><code id="redcap_event_instruments_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_event_instruments_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code> package and
documentation is available at https://cran.r-project.org/package=httr.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> where each row represents one column
in the REDCap dataset.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Victor Castro, Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+redcap_instruments">redcap_instruments()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri                 &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token               &lt;- "0434F0E9CF53ED0587847AB6E51DE762"
ds_event_instrument &lt;- REDCapR::redcap_event_instruments(redcap_uri=uri, token=token)$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_instruments'>Enumerate the instruments (forms)</h2><span id='topic+redcap_instruments'></span>

<h3>Description</h3>

<p>Export a list of the data collection instruments for a
project. This includes their unique instrument name as seen in the
second column of the Data Dictionary, as well as each instrument's
corresponding instrument label, which is seen on a project's left-hand
menu when entering data. The instruments will be ordered according to
their order in the project.
(Copied from &quot;Export Instruments (Data Entry Forms)&quot; method of
REDCap API documentation, v.10.5.1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_instruments(redcap_uri, token, verbose = TRUE, config_options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_instruments_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_instruments_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_instruments_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_instruments_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code> package and
documentation is available at https://cran.r-project.org/package=httr.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> where each row represents one column
in the REDCap dataset.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Victor Castro, Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+redcap_event_instruments">redcap_event_instruments()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri           &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token         &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
ds_instrument &lt;- REDCapR::redcap_instruments(redcap_uri=uri, token=token)$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_metadata_read'>Export the metadata of a REDCap project</h2><span id='topic+redcap_metadata_read'></span>

<h3>Description</h3>

<p>Export the metadata (as a data dictionary) of a REDCap project
as a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code>. Each row in the data dictionary corresponds to
one field in the project's dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_metadata_read(
  redcap_uri,
  token,
  forms = NULL,
  forms_collapsed = "",
  fields = NULL,
  fields_collapsed = "",
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_metadata_read_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_forms">forms</code></td>
<td>
<p>An array, where each element corresponds to the REDCap form
of the desired fields.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_forms_collapsed">forms_collapsed</code></td>
<td>
<p>A single string, where the desired forms are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_fields">fields</code></td>
<td>
<p>An array, where each element corresponds to a desired project
field.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_fields_collapsed">fields_collapsed</code></td>
<td>
<p>A single string, where the desired field names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_read_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifically, it internally uses multiple calls to <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>
to select and return data.  Initially, only primary key is queried through
the REDCap API.  The long list is then subsetted into partitions, whose
sizes are determined by the <code>batch_size</code> parameter.  REDCap is then queried
for all variables of the subset's subjects.  This is repeated for each
subset, before returning a unified <code><a href="base.html#topic+data.frame">base::data.frame()</a></code>.
</p>
<p>The function allows a delay between calls, which allows the server to
attend to other users' requests.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of the desired records and columns.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_codes</code>: A collection of
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status codes</a>,
separated by semicolons.  There is one code for each batch attempted.
</p>
</li>
<li> <p><code>outcome_messages</code>: A collection of human readable strings indicating the
operations' semicolons.  There is one code for each batch attempted.  In an
unsuccessful operation, it should contain diagnostic information.
</p>
</li>
<li> <p><code>forms_collapsed</code>: The desired records IDs, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>fields_collapsed</code>: The desired field names, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri   &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
REDCapR::redcap_metadata_read(redcap_uri=uri, token=token)

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_metadata_write'>Import metadata of a REDCap project</h2><span id='topic+redcap_metadata_write'></span>

<h3>Description</h3>

<p>Import metadata (<em>i.e.</em>, data dictionary)
into a project. Because of this method's destructive nature,
it works for only projects in Development status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_metadata_write(
  ds,
  redcap_uri,
  token,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_metadata_write_+3A_ds">ds</code></td>
<td>
<p>The <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> to be imported into the REDCap project.
Required.</p>
</td></tr>
<tr><td><code id="redcap_metadata_write_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_metadata_write_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_metadata_write_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_metadata_write_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code><a href="httr.html#topic+POST">httr::POST()</a></code> method
in the 'httr' package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code> Optional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>field_count</code>: Number of fields imported.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki.
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Please don't run this example without changing the token to
# point to your server.  It could interfere with our testing suite.
uri            &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token          &lt;- "457C24AB91B7FCF5B1A7DA67E70E24C7"

# Read in the dictionary in R's memory from a csv file.
ds_to_write &lt;-
  readr::read_csv(
    file = system.file(
      "test-data/project-simple/simple-metadata.csv",
      package = "REDCapR"
    ),
    col_types = readr::cols(.default = readr::col_character())
  )
ds_to_write

# Import the dictionary into the REDCap project
REDCapR::redcap_metadata_write(
  ds          = ds_to_write,
  redcap_uri  = uri,
  token       = token
)

## End(Not run)

</code></pre>

<hr>
<h2 id='redcap_next_free_record_name'>Determine free available record ID</h2><span id='topic+redcap_next_free_record_name'></span>

<h3>Description</h3>

<p>Determines the next available record ID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_next_free_record_name(
  redcap_uri,
  token,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_next_free_record_name_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_next_free_record_name_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_next_free_record_name_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_next_free_record_name_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below.  Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the API call is unsuccessful, a value of <code>character(0)</code> will
be returned (<em>i.e.</em>, an empty vector).  This ensures that a the function
will always return an object of class
<a href="base.html#topic+character">base::character</a>.
</p>


<h3>Value</h3>

<p>a <a href="base.html#topic+character">base::character</a> vector of either
length 1 (if successful) or length 0 (if not successful).
</p>


<h3>Note</h3>

<p><strong>Documentation in REDCap 8.4.0</strong>
</p>
<p>To be used by projects with record auto-numbering enabled, this method
exports the next potential record ID for a project. It generates the next
record name by determining the current maximum numerical record ID and then
incrementing it by one.
</p>
<div class="sourceCode"><pre>Note: This method does not create a new record, but merely determines what
the next record name would be.

If using Data Access Groups (DAGs) in the project, this method accounts for
the special formatting of the record name for users in DAGs (e.g., DAG-ID);
in this case, it only assigns the next value for ID for all numbers inside
a DAG. For example, if a DAG has a corresponding DAG number of 223 wherein
records 223-1 and 223-2 already exist, then the next record will be 223-3
if the API user belongs to the DAG that has DAG number 223. (The DAG number
is auto-assigned by REDCap for each DAG when the DAG is first created.)

When generating a new record name in a DAG, the method considers all records
in the entire project when determining the maximum record ID, including
those that might have been originally created in that DAG but then later
reassigned to another DAG.

Note: This method functions the same even for projects that do not have
record auto-numbering enabled.
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>uri      &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token    &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
# Returns 6
REDCapR::redcap_next_free_record_name(redcap_uri = uri, token = token)
</code></pre>

<hr>
<h2 id='redcap_project'>A Reference Class to make later calls to REDCap more convenient</h2><span id='topic+redcap_project'></span>

<h3>Description</h3>

<p>This <code style="white-space: pre;">&#8288;Reference Class&#8288;</code> represents a REDCap project.
Once some values are set that are specific to a REDCap project
(such as the URI and token), later calls are less verbose
(such as reading and writing data).
</p>


<h3>Fields</h3>


<dl>
<dt><code>redcap_uri</code></dt><dd><p>The URI (uniform resource identifier) of the
REDCap project.  Required.</p>
</dd>
<dt><code>token</code></dt><dd><p>token The user-specific string that serves as the
password for a project.  Required.</p>
</dd>
</dl>


<h3>Methods</h3>


<dl>
<dt><code>read(
  batch_size = 100L,
  interbatch_delay = 0,
  records = NULL,
  records_collapsed = "",
  fields = NULL,
  fields_collapsed = "",
  forms = NULL,
  forms_collapsed = "",
  events = NULL,
  events_collapsed = "",
  raw_or_label = "raw",
  raw_or_label_headers = "raw",
  export_checkbox_label = FALSE,
  export_survey_fields = FALSE,
  export_data_access_groups = FALSE,
  filter_logic = "",
  guess_type = TRUE,
  guess_max = 1000L,
  verbose = TRUE,
  config_options = NULL
)</code></dt><dd><p>Exports records from a REDCap project.</p>
</dd>
<dt><code>write(
  ds_to_write,
  batch_size = 100L,
  interbatch_delay = 0,
  continue_on_error = FALSE,
  verbose = TRUE,
  config_options = NULL
)</code></dt><dd><p>Imports records to a REDCap project.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "D70F9ACD1EDD6F151C6EA78683944E98"
## Not run: 
project &lt;- REDCapR::redcap_project$new(redcap_uri=uri, token=token)
ds_all  &lt;- project$read()

# Demonstrate how repeated calls are more concise when the token and
#   url aren't always passed.
ds_skinny &lt;- project$read(fields=c("record_id", "sex", "height"))$data

ids_of_males    &lt;- ds_skinny$record_id[ds_skinny$sex==1]
ids_of_shorties &lt;- ds_skinny$record_id[ds_skinny$height &lt; 40]

ds_males        &lt;- project$read(records=ids_of_males, batch_size=2)$data
ds_shorties     &lt;- project$read(records=ids_of_shorties)$data

#Switch the Genders
sex_original   &lt;- ds_skinny$sex
ds_skinny$sex  &lt;- (1 - ds_skinny$sex)
project$write(ds_skinny)

#Switch the Genders back
ds_skinny$sex &lt;- sex_original
project$write(ds_skinny)

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_read'>Read records from a REDCap project in subsets, and stacks them
together before returning a dataset</h2><span id='topic+redcap_read'></span>

<h3>Description</h3>

<p>From an external perspective, this function is similar to
<code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>.  The internals differ in that <code>redcap_read</code>
retrieves subsets of the data, and then combines them before returning
(among other objects) a single <code><a href="base.html#topic+data.frame">base::data.frame()</a></code>.  This function can
be more appropriate than <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code> when returning large
datasets that could tie up the server.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_read(
  batch_size = 100L,
  interbatch_delay = 0.5,
  continue_on_error = FALSE,
  redcap_uri,
  token,
  records = NULL,
  records_collapsed = "",
  fields = NULL,
  fields_collapsed = "",
  forms = NULL,
  forms_collapsed = "",
  events = NULL,
  events_collapsed = "",
  raw_or_label = "raw",
  raw_or_label_headers = "raw",
  export_checkbox_label = FALSE,
  export_survey_fields = FALSE,
  export_data_access_groups = FALSE,
  filter_logic = "",
  datetime_range_begin = as.POSIXct(NA),
  datetime_range_end = as.POSIXct(NA),
  col_types = NULL,
  guess_type = TRUE,
  guess_max = NULL,
  http_response_encoding = "UTF-8",
  locale = readr::default_locale(),
  verbose = TRUE,
  config_options = NULL,
  id_position = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_read_+3A_batch_size">batch_size</code></td>
<td>
<p>The maximum number of subject records a single batch
should contain.  The default is 100.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_interbatch_delay">interbatch_delay</code></td>
<td>
<p>The number of seconds the function will wait
before requesting a new subset from REDCap. The default is 0.5 seconds.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_continue_on_error">continue_on_error</code></td>
<td>
<p>If an error occurs while reading, should records
in subsequent batches be attempted.  The default is <code>FALSE</code>, which prevents
subsequent batches from running.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_records">records</code></td>
<td>
<p>An array, where each element corresponds to the ID of a
desired record.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_records_collapsed">records_collapsed</code></td>
<td>
<p>A single string, where the desired ID values are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_fields">fields</code></td>
<td>
<p>An array, where each element corresponds to a desired project
field.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_fields_collapsed">fields_collapsed</code></td>
<td>
<p>A single string, where the desired field names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_forms">forms</code></td>
<td>
<p>An array, where each element corresponds to a desired project
form.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_forms_collapsed">forms_collapsed</code></td>
<td>
<p>A single string, where the desired form names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_events">events</code></td>
<td>
<p>An array, where each element corresponds to a desired project
event.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_events_collapsed">events_collapsed</code></td>
<td>
<p>A single string, where the desired event names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that specifies
whether to export the raw coded values or the labels for the options of
multiple choice fields.  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_raw_or_label_headers">raw_or_label_headers</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that
specifies for the CSV headers whether to export the variable/field names
(raw) or the field labels (label).  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_export_checkbox_label">export_checkbox_label</code></td>
<td>
<p>specifies the format of checkbox field values
specifically when exporting the data as labels.  If <code>raw_or_label</code> is
<code>'label'</code> and <code>export_checkbox_label</code> is TRUE, the values will be the text
displayed to the users.  Otherwise, the values will be 0/1.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_export_survey_fields">export_survey_fields</code></td>
<td>
<p>A boolean that specifies whether to export the
survey identifier field (e.g., 'redcap_survey_identifier') or survey
timestamp fields (e.g., instrument+'_timestamp').
The timestamp outputs reflect the survey's <em>completion</em> time
(according to the time and timezone of the REDCap server.)</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_export_data_access_groups">export_data_access_groups</code></td>
<td>
<p>A boolean value that specifies whether or
not to export the <code>redcap_data_access_group</code> field when data access groups
are utilized in the project. Default is <code>FALSE</code>. See the details below.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_filter_logic">filter_logic</code></td>
<td>
<p>String of logic text (e.g., <code style="white-space: pre;">&#8288;[gender] = 'male'&#8288;</code>) for
filtering the data to be returned by this API method, in which the API
will only return the records (or record-events, if a longitudinal project)
where the logic evaluates as TRUE.   An blank/empty string returns all records.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_datetime_range_begin">datetime_range_begin</code></td>
<td>
<p>To return only records that have been created or
modified <em>after</em> a given datetime, provide a
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html">POSIXct</a>
value.
If not specified, REDCap will assume no begin time.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_datetime_range_end">datetime_range_end</code></td>
<td>
<p>To return only records that have been created or
modified <em>before</em> a given datetime, provide a
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html">POSIXct</a>
value.
If not specified, REDCap will assume no end time.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_col_types">col_types</code></td>
<td>
<p>A <code><a href="readr.html#topic+cols">readr::cols()</a></code> object passed internally to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_guess_type">guess_type</code></td>
<td>
<p>A boolean value indicating if all columns should be
returned as character.  If true, <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> guesses the intended
data type for each column.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_guess_max">guess_max</code></td>
<td>
<p>Deprecated.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_http_response_encoding">http_response_encoding</code></td>
<td>
<p>The encoding value passed to
<code><a href="httr.html#topic+content">httr::content()</a></code>.  Defaults to 'UTF-8'.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_locale">locale</code></td>
<td>
<p>a <code><a href="readr.html#topic+locale">readr::locale()</a></code> object to specify preferences like
number, date, and time formats.  This object is passed to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Defaults to <code><a href="readr.html#topic+locale">readr::default_locale()</a></code>.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code>redcap_read_oneshot()</code> Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_+3A_id_position">id_position</code></td>
<td>
<p>The column position of the variable that unique
identifies the subject (typically <code>record_id</code>).
This defaults to the first variable in the dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+redcap_read">redcap_read()</a></code> internally uses multiple calls to <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>
to select and return data.  Initially, only the primary key is queried
through the REDCap API.  The long list is then subsetted into batches,
whose sizes are determined by the <code>batch_size</code> parameter.  REDCap is then
queried for all variables of the subset's subjects.  This is repeated for
each subset, before returning a unified <code><a href="base.html#topic+data.frame">base::data.frame()</a></code>.
</p>
<p>The function allows a delay between calls, which allows the server to
attend to other users' requests (such as the users entering data in a
browser).  In other words, a delay between batches does not bog down
the webserver when exporting/importing a large dataset.
</p>
<p>A second benefit is less RAM is required on the webserver.  Because
each batch is smaller than the entire dataset, the webserver
tackles more manageably sized objects in memory.  Consider batching
if you encounter the error:
</p>
<div class="sourceCode"><pre>ERROR: REDCap ran out of server memory. The request cannot be processed.
Please try importing/exporting a smaller amount of data.
</pre></div>
<p>For <code><a href="#topic+redcap_read">redcap_read()</a></code> to function properly, the user must have Export
permissions for the 'Full Data Set'.  Users with only 'De-Identified'
export privileges can still use <code>redcap_read_oneshot</code>.  To grant the
appropriate permissions:
</p>

<ul>
<li><p> go to 'User Rights' in the REDCap project site,
</p>
</li>
<li><p> select the desired user, and then select 'Edit User Privileges',
</p>
</li>
<li><p> in the 'Data Exports' radio buttons, select 'Full Data Set'.
</p>
</li></ul>



<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of the desired records and columns.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_codes</code>: A collection of
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status codes</a>,
separated by semicolons.  There is one code for each batch attempted.
</p>
</li>
<li> <p><code>outcome_messages</code>: A collection of human readable strings indicating the
operations' semicolons.  There is one code for each batch attempted.  In an
unsuccessful operation, it should contain diagnostic information.
</p>
</li>
<li> <p><code>records_collapsed</code>: The desired records IDs, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>fields_collapsed</code>: The desired field names, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>filter_logic</code>: The filter statement passed as an argument.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html
and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
REDCapR::redcap_read(batch_size=2, redcap_uri=uri, token=token)$data

# Specify the column types.
col_types &lt;- readr::cols(
  record_id  = readr::col_integer(),
  race___1   = readr::col_logical(),
  race___2   = readr::col_logical(),
  race___3   = readr::col_logical(),
  race___4   = readr::col_logical(),
  race___5   = readr::col_logical(),
  race___6   = readr::col_logical()
)
REDCapR::redcap_read(
  redcap_uri = uri,
  token      = token,
  col_types  = col_types,
  batch_size = 2
)$data


## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_read_oneshot'>Read/Export records from a REDCap project</h2><span id='topic+redcap_read_oneshot'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to select and return data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_read_oneshot(
  redcap_uri,
  token,
  records = NULL,
  records_collapsed = "",
  fields = NULL,
  fields_collapsed = "",
  forms = NULL,
  forms_collapsed = "",
  events = NULL,
  events_collapsed = "",
  raw_or_label = "raw",
  raw_or_label_headers = "raw",
  export_checkbox_label = FALSE,
  export_survey_fields = FALSE,
  export_data_access_groups = FALSE,
  filter_logic = "",
  datetime_range_begin = as.POSIXct(NA),
  datetime_range_end = as.POSIXct(NA),
  col_types = NULL,
  guess_type = TRUE,
  guess_max = 1000L,
  http_response_encoding = "UTF-8",
  locale = readr::default_locale(),
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_read_oneshot_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_records">records</code></td>
<td>
<p>An array, where each element corresponds to the ID of a
desired record.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_records_collapsed">records_collapsed</code></td>
<td>
<p>A single string, where the desired ID values
are separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_fields">fields</code></td>
<td>
<p>An array, where each element corresponds to a desired project
field.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_fields_collapsed">fields_collapsed</code></td>
<td>
<p>A single string, where the desired field names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_forms">forms</code></td>
<td>
<p>An array, where each element corresponds to a desired project
form.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_forms_collapsed">forms_collapsed</code></td>
<td>
<p>A single string, where the desired form names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_events">events</code></td>
<td>
<p>An array, where each element corresponds to a desired project
event.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_events_collapsed">events_collapsed</code></td>
<td>
<p>A single string, where the desired event names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code>) that specifies
whether to export the raw coded values or the labels for the options of
multiple choice fields.  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_raw_or_label_headers">raw_or_label_headers</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that
specifies for the CSV headers whether to export the variable/field names
(raw) or the field labels (label).  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_export_checkbox_label">export_checkbox_label</code></td>
<td>
<p>specifies the format of checkbox field values
specifically when exporting the data as labels.  If <code>raw_or_label</code> is
<code>'label'</code> and <code>export_checkbox_label</code> is TRUE, the values will be the text
displayed to the users.  Otherwise, the values will be 0/1.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_export_survey_fields">export_survey_fields</code></td>
<td>
<p>A boolean that specifies whether to export the
survey identifier field (e.g., 'redcap_survey_identifier') or survey
timestamp fields (e.g., instrument+'_timestamp').
The timestamp outputs reflect the survey's <em>completion</em> time
(according to the time and timezone of the REDCap server.)</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_export_data_access_groups">export_data_access_groups</code></td>
<td>
<p>A boolean value that specifies whether or
not to export the <code>redcap_data_access_group</code> field when data access groups
are utilized in the project. Default is <code>FALSE</code>. See the details below.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_filter_logic">filter_logic</code></td>
<td>
<p>String of logic text (e.g., <code style="white-space: pre;">&#8288;[gender] = 'male'&#8288;</code>) for
filtering the data to be returned by this API method, in which the API will
only return the records (or record-events, if a longitudinal project) where
the logic evaluates as TRUE.   An blank/empty string returns all records.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_datetime_range_begin">datetime_range_begin</code></td>
<td>
<p>To return only records that have been created or
modified <em>after</em> a given datetime, provide a
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html">POSIXct</a>
value.
If not specified, REDCap will assume no begin time.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_datetime_range_end">datetime_range_end</code></td>
<td>
<p>To return only records that have been created or
modified <em>before</em> a given datetime, provide a
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html">POSIXct</a>
value.
If not specified, REDCap will assume no end time.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_col_types">col_types</code></td>
<td>
<p>A <code><a href="readr.html#topic+cols">readr::cols()</a></code> object passed internally to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_guess_type">guess_type</code></td>
<td>
<p>A boolean value indicating if all columns should be
returned as character.  If false, <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> guesses the intended
data type for each column.  Ignored if <code>col_types</code> is not null.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_guess_max">guess_max</code></td>
<td>
<p>A positive integer passed to <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> that
specifies the maximum number of records to use for guessing column types.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_http_response_encoding">http_response_encoding</code></td>
<td>
<p>The encoding value passed to
<code><a href="httr.html#topic+content">httr::content()</a></code>.  Defaults to 'UTF-8'.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_locale">locale</code></td>
<td>
<p>a <code><a href="readr.html#topic+locale">readr::locale()</a></code> object to specify preferences like
number, date, and time formats.  This object is passed to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Defaults to <code><a href="readr.html#topic+locale">readr::default_locale()</a></code>.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code> package and
documentation is available at https://cran.r-project.org/package=httr.
</p>
<p>If you do not pass in this <code>export_data_access_groups</code> value, it will default
to <code>FALSE</code>. The following is from the API help page for version 10.5.1:
<em>This flag is only viable if the user whose token is being used to make the
API request is <strong>not</strong> in a data access group. If the user is in a group,
then this flag will revert to its default value</em>.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of the desired records and columns.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_collapsed</code>: The desired records IDs, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>fields_collapsed</code>: The desired field names, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>filter_logic</code>: The filter statement passed as an argument.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri      &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token    &lt;- "9A81268476645C4E5F03428B8AC3AA7B"

#Return all records and all variables.
ds &lt;- REDCapR::redcap_read_oneshot(redcap_uri=uri, token=token)$data

#Return only records with IDs of 1 and 3
desired_records_v1 &lt;- c(1, 3)
ds_some_rows_v1 &lt;- REDCapR::redcap_read_oneshot(
   redcap_uri = uri,
   token      = token,
   records    = desired_records_v1
)$data

#Return only the fields record_id, name_first, and age
desired_fields_v1 &lt;- c("record_id", "name_first", "age")
ds_some_fields_v1 &lt;- REDCapR::redcap_read_oneshot(
   redcap_uri = uri,
   token      = token,
   fields     = desired_fields_v1
)$data


# Specify the column types.
col_types &lt;- readr::cols(
  record_id  = readr::col_integer(),
  race___1   = readr::col_logical(),
  race___2   = readr::col_logical(),
  race___3   = readr::col_logical(),
  race___4   = readr::col_logical(),
  race___5   = readr::col_logical(),
  race___6   = readr::col_logical()
)
ds_col_types &lt;- REDCapR::redcap_read_oneshot(
   redcap_uri = uri,
   token      = token,
   col_types  = col_types
)$data


## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_read_oneshot_eav'>Read/Export records from a REDCap project &ndash;still in development</h2><span id='topic+redcap_read_oneshot_eav'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to select and return data.
This function is still in development.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_read_oneshot_eav(
  redcap_uri,
  token,
  records = NULL,
  records_collapsed = "",
  fields = NULL,
  fields_collapsed = "",
  forms = NULL,
  forms_collapsed = "",
  events = NULL,
  events_collapsed = "",
  raw_or_label = "raw",
  raw_or_label_headers = "raw",
  export_data_access_groups = FALSE,
  filter_logic = "",
  datetime_range_begin = as.POSIXct(NA),
  datetime_range_end = as.POSIXct(NA),
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_read_oneshot_eav_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_records">records</code></td>
<td>
<p>An array, where each element corresponds to the ID of a
desired record.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_records_collapsed">records_collapsed</code></td>
<td>
<p>A single string, where the desired ID values
are separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_fields">fields</code></td>
<td>
<p>An array, where each element corresponds to a desired
project field.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_fields_collapsed">fields_collapsed</code></td>
<td>
<p>A single string, where the desired field names
are separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_forms">forms</code></td>
<td>
<p>An array, where each element corresponds to a desired project
field.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_forms_collapsed">forms_collapsed</code></td>
<td>
<p>A single string, where the desired form names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_events">events</code></td>
<td>
<p>An array, where each element corresponds to a desired project
event.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_events_collapsed">events_collapsed</code></td>
<td>
<p>A single string, where the desired event names are
separated by commas.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that specifies
whether to export the raw coded values or the labels for the options of
multiple choice fields.  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_raw_or_label_headers">raw_or_label_headers</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that
specifies for the CSV headers whether to export the variable/field names
(raw) or the field labels (label).  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_export_data_access_groups">export_data_access_groups</code></td>
<td>
<p>A boolean value that specifies whether or
not to export the <code>redcap_data_access_group</code> field when data access groups
are utilized in the project. Default is <code>FALSE</code>. See the details below.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_filter_logic">filter_logic</code></td>
<td>
<p>String of logic text (e.g., <code style="white-space: pre;">&#8288;[gender] = 'male'&#8288;</code>) for
filtering the data to be returned by this API method, in which the API
will only return the records (or record-events, if a longitudinal project)
where the logic evaluates as TRUE.   An blank/empty string returns all
records.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_datetime_range_begin">datetime_range_begin</code></td>
<td>
<p>To return only records that have been created or
modified <em>after</em> a given datetime, provide a
<a href="base.html#topic+POSIXct">POSIXct</a>
(https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html)
value.
If not specified, REDCap will assume no begin time.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_datetime_range_end">datetime_range_end</code></td>
<td>
<p>To return only records that have been created or
modified <em>before</em> a given datetime, provide a
<a href="base.html#topic+POSIXct">POSIXct</a>
(https://stat.ethz.ch/R-manual/R-devel/library/base/html/as.POSIXlt.html)
value.
If not specified, REDCap will assume no end time.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_read_oneshot_eav_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code>
package and documentation is available at
https://cran.r-project.org/package=httr.
</p>
<p>If you do not pass in this export_data_access_groups value, it will
default to <code>FALSE</code>. The following is from the API help page for version
5.2.3:
This flag is only viable if the user whose token is being used to make
the API request is <em>not</em> in a data access group. If the user is in a
group, then this flag will revert to its default value.
</p>
<p>As of REDCap 6.14.3, this field is not exported in the EAV API call.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of the desired records and columns.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_collapsed</code>: The desired records IDs, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>fields_collapsed</code>: The desired field names, collapsed into a single
string, separated by commas.
</p>
</li>
<li> <p><code>filter_logic</code>: The filter statement passed as an argument.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus
REDCap administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri      &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token    &lt;- "9A81268476645C4E5F03428B8AC3AA7B"

#Return all records and all variables.
ds &lt;- REDCapR:::redcap_read_oneshot_eav(redcap_uri=uri, token=token)$data

#Return only records with IDs of 1 and 3
desired_records_v1 &lt;- c(1, 3)
ds_some_rows_v1    &lt;- REDCapR::redcap_read_oneshot_eav(
   redcap_uri = uri,
   token      = token,
   records    = desired_records_v1
)$data

#Return only the fields record_id, name_first, and age
desired_fields_v1 &lt;- c("record_id", "name_first", "age")
ds_some_fields_v1 &lt;- redcap_read_oneshot_eav(
   redcap_uri = uri,
   token      = token,
   fields     = desired_fields_v1
)$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_report'>Read/Export records that populate a REDCap report</h2><span id='topic+redcap_report'></span>

<h3>Description</h3>

<p>Exports the data set of a report created on a project's
'Data Exports, Reports, and Stats' page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_report(
  redcap_uri,
  token,
  report_id,
  raw_or_label = "raw",
  raw_or_label_headers = "raw",
  export_checkbox_label = FALSE,
  col_types = NULL,
  guess_type = TRUE,
  guess_max = 1000L,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_report_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_report_id">report_id</code></td>
<td>
<p>A single integer, provided next to the report name on the
report list page.  Required.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_raw_or_label">raw_or_label</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code>) that specifies
whether to export the raw coded values or the labels for the options of
multiple choice fields.  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_raw_or_label_headers">raw_or_label_headers</code></td>
<td>
<p>A string (either <code>'raw'</code> or <code>'label'</code> that
specifies for the CSV headers whether to export the variable/field names
(raw) or the field labels (label).  Default is <code>'raw'</code>.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_export_checkbox_label">export_checkbox_label</code></td>
<td>
<p>specifies the format of checkbox field values
specifically when exporting the data as labels.  If <code>raw_or_label</code> is
<code>'label'</code> and <code>export_checkbox_label</code> is TRUE, the values will be the text
displayed to the users.  Otherwise, the values will be 0/1.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_col_types">col_types</code></td>
<td>
<p>A <code><a href="readr.html#topic+cols">readr::cols()</a></code> object passed internally to
<code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code>.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_guess_type">guess_type</code></td>
<td>
<p>A boolean value indicating if all columns should be
returned as character.  If false, <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> guesses the intended
data type for each column.  Ignored if <code>col_types</code> is not null.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_guess_max">guess_max</code></td>
<td>
<p>A positive integer passed to <code><a href="readr.html#topic+read_delim">readr::read_csv()</a></code> that
specifies the maximum number of records to use for guessing column types.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_report_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code> package and
documentation is available at https://cran.r-project.org/package=httr.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> of the desired records and columns.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri          &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token        &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
report_1_id  &lt;- 5980L
report_2_id  &lt;- 6431L

# Return all records and all variables.
ds_1a &lt;-
  REDCapR::redcap_report(
    redcap_uri = uri,
    token      = token,
    report_id  = report_1_id
  )$data


# Specify the column types.
col_types_1 &lt;- readr::cols(
  record_id          = readr::col_integer(),
  height             = readr::col_double(),
  health_complete    = readr::col_integer(),
  address            = readr::col_character(),
  ethnicity          = readr::col_integer()
)
ds_1b &lt;-
  REDCapR::redcap_report(
    redcap_uri = uri,
    token      = token,
    report_id  = report_1_id,
    col_types  = col_types_1
  )$data


# Return condensed checkboxes Report option:
#   "Combine checkbox options into single column of only the checked-off
#   options (will be formatted as a text field when exported to
#   stats packages)"
col_types_2 &lt;- readr::cols(
  record_id          = readr::col_integer(),
  race               = readr::col_character()
)
ds_2 &lt;-
  REDCapR::redcap_report(
    redcap_uri = uri,
    token      = token,
    report_id  = report_2_id,
    col_types  = col_types_2
  )$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_survey_link_export_oneshot'>Download a file from a REDCap project record</h2><span id='topic+redcap_survey_link_export_oneshot'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to download a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_survey_link_export_oneshot(
  redcap_uri,
  token,
  record,
  instrument,
  event = "",
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_record">record</code></td>
<td>
<p>The record ID where the file is to be imported. Required</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_instrument">instrument</code></td>
<td>
<p>The name of the instrument associated with the
survey link.  Required</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_event">event</code></td>
<td>
<p>The name of the event where the file is saved in REDCap.
Optional</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_survey_link_export_oneshot_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code><a href="httr.html#topic+POST">httr::POST()</a></code> method
in the 'httr' package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.  See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper
function that checks for some common important conflicts.
</p>
<p><strong>Permissions Required</strong>
To use this method, you must have API Export privileges in the project.
(As stated in the 9.0.0 documentation.)
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>affected_ids</code>: The subject IDs of the inserted or updated records.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li>
<li> <p><code>file_name</code>: The name of the file persisted to disk. This is useful if
the name stored in REDCap is used (which is the default).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri     &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token   &lt;- "8FA9A6BDAE2C0B5DD3CB472DD8E8918C" #pid=817
record  &lt;- 1
instrument   &lt;- "participant_morale_questionnaire"
# event &lt;- "" # only for longitudinal projects

result &lt;- REDCapR::redcap_survey_link_export_oneshot(
  record         = record,
  instrument     = instrument,
  redcap_uri     = uri,
  token          = token
)
result$survey_link

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_upload_file_oneshot'>Upload a file into to a REDCap project record</h2><span id='topic+redcap_upload_file_oneshot'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to upload a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_upload_file_oneshot(
  file_name,
  record,
  redcap_uri,
  token,
  field,
  event = "",
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_upload_file_oneshot_+3A_file_name">file_name</code></td>
<td>
<p>The name of the relative or full file to be uploaded into
the REDCap project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_record">record</code></td>
<td>
<p>The record ID where the file is to be imported.  Required</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_field">field</code></td>
<td>
<p>The name of the field where the file is saved in REDCap.
Required</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_event">event</code></td>
<td>
<p>The name of the event where the file is saved in REDCap.
Optional</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_upload_file_oneshot_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below.  Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.  See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper
function that checks for some common important conflicts.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>affected_ids</code>: The subject IDs of the inserted or updated records.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as
an empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley, John J. Aponte
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (ie,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Define some constants
uri    &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token  &lt;- "D70F9ACD1EDD6F151C6EA78683944E98" # The simple project -pid 213
field  &lt;- "mugshot"
event  &lt;- "" # only for longitudinal events

#Upload a single image file.
record    &lt;- 1
file_path &lt;- system.file("test-data/mugshot-1.jpg", package="REDCapR")

REDCapR::redcap_upload_file_oneshot(
  file_name  = file_path,
  record     = record,
  field      = field,
  redcap_uri = redcap_uri,
  token      = token
)

#Upload a collection of five images.
records    &lt;- 1:5
file_paths &lt;- system.file(
  paste0("test-data/mugshot-", records, ".jpg"),
  package="REDCapR"
)

for (i in seq_along(records)) {
  record    &lt;- records[i]
  file_path &lt;- file_paths[i]
  REDCapR::redcap_upload_file_oneshot(
    file_name  = file_path,
    record     = record,
    field      = field,
    redcap_uri = redcap_uri,
    token      = token
  )
}

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_users_export'>List authorized users</h2><span id='topic+redcap_users_export'></span>

<h3>Description</h3>

<p>List users authorized for a project.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_users_export(redcap_uri, token, verbose = TRUE, config_options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_users_export_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_users_export_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_users_export_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_users_export_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below.  Optional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="utils.html#topic+packageDescription">utils::packageDescription</a>.
</p>


<h3>Note</h3>

<p><strong>Documentation in REDCap 8.4.0</strong>
</p>
<div class="sourceCode"><pre>This method allows you to export the list of users for a project,
including their user privileges and also email address, first name,
and last name.

Note: If the user has been assigned to a user role, it will return
the user with the role's defined privileges.
</pre></div>


<h3>Examples</h3>

<pre><code class='language-R'>uri      &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token    &lt;- "06DEFB601F9B46847DAA9DF0CFA951B4"
result   &lt;- REDCapR::redcap_users_export(redcap_uri=uri, token=token)
result$data_user
result$data_user_form
</code></pre>

<hr>
<h2 id='redcap_variables'>Enumerate the exported variables</h2><span id='topic+redcap_variables'></span>

<h3>Description</h3>

<p>This function calls the 'exportFieldNames' function of the
REDCap API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_variables(redcap_uri, token, verbose = TRUE, config_options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_variables_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_variables_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_variables_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_variables_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The full list of configuration options accepted by the <code>httr</code> package is
viewable by executing <code><a href="httr.html#topic+httr_options">httr::httr_options()</a></code>.  The <code>httr</code> package and
documentation is available at https://cran.r-project.org/package=httr.
</p>
<p>As of REDCap version 6.14.2, three variable types are <em>not</em> returned in
this call: calculated, file, and descriptive.  All variables returned are
writable/uploadable.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements,
</p>

<ul>
<li> <p><code>data</code>: An R <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> where each row represents one column
in the REDCap dataset.
</p>
</li>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
uri         &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token       &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
ds_variable &lt;- REDCapR::redcap_variables(redcap_uri=uri, token=token)$data

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_version'>Determine version of REDCap instance</h2><span id='topic+redcap_version'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to query its version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_version(redcap_uri, token, verbose = TRUE, config_options = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_version_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_version_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for
a project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_version_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_version_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details below.  Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the API call is unsuccessful, a value of
<code>base::package_version("0.0.0")</code> will be returned.
This ensures that a the function will always return an object of class
<a href="base.html#topic+numeric_version">base::numeric_version</a>.  It guarantees the value can always be used in
<code><a href="utils.html#topic+compareVersion">utils::compareVersion()</a></code>.
</p>


<h3>Value</h3>

<p>a <a href="utils.html#topic+packageDescription">utils::packageDescription</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>uri      &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token    &lt;- "9A81268476645C4E5F03428B8AC3AA7B"
REDCapR::redcap_version(redcap_uri = uri, token = token)
</code></pre>

<hr>
<h2 id='redcap_write'>Write/Import records to a REDCap project</h2><span id='topic+redcap_write'></span>

<h3>Description</h3>

<p>This function uses REDCap's APIs to select and return data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_write(
  ds_to_write,
  batch_size = 100L,
  interbatch_delay = 0.5,
  continue_on_error = FALSE,
  redcap_uri,
  token,
  overwrite_with_blanks = TRUE,
  convert_logical_to_integer = FALSE,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_write_+3A_ds_to_write">ds_to_write</code></td>
<td>
<p>The <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> to be imported into the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_batch_size">batch_size</code></td>
<td>
<p>The maximum number of subject records a single batch
should contain.  The default is 100.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_interbatch_delay">interbatch_delay</code></td>
<td>
<p>The number of seconds the function will wait before
requesting a new subset from REDCap. The default is 0.5 seconds.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_continue_on_error">continue_on_error</code></td>
<td>
<p>If an error occurs while writing, should records
in subsequent batches be attempted.  The default is <code>FALSE</code>, which prevents
subsequent batches from running.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_overwrite_with_blanks">overwrite_with_blanks</code></td>
<td>
<p>A boolean value indicating if
blank/<code>NA</code> values in the R <a href="base.html#topic+data.frame">base::data.frame</a>
will overwrite data on the server.
This is the default behavior for REDCapR,
which essentially deletes the cell's value
If <code>FALSE</code>, blank/<code>NA</code> values in the <a href="base.html#topic+data.frame">base::data.frame</a>
will be ignored.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_convert_logical_to_integer">convert_logical_to_integer</code></td>
<td>
<p>If <code>TRUE</code>, all <a href="base.html#topic+logical">base::logical</a> columns
in <code>ds</code> are cast to an integer before uploading to REDCap.
Boolean values are typically represented as 0/1 in REDCap radio buttons.
Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code>POST</code> method in the
<code>httr</code> package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code>. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.
See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper function that checks for some
common important conflicts.
</p>
<p>For <code>redcap_write</code> to function properly, the user must have Export
permissions for the 'Full Data Set'.  Users with only 'De-Identified'
export privileges can still use <code><a href="#topic+redcap_write_oneshot">redcap_write_oneshot()</a></code>.  To grant
the appropriate permissions:
</p>

<ul>
<li><p> go to 'User Rights' in the REDCap project site,
</p>
</li>
<li><p> select the desired user, and then select 'Edit User Privileges',
</p>
</li>
<li><p> in the 'Data Exports' radio buttons, select 'Full Data Set'.
</p>
</li></ul>



<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>affected_ids</code>: The subject IDs of the inserted or updated records.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help
Page' and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Define some constants
uri           &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token         &lt;- "D70F9ACD1EDD6F151C6EA78683944E98"

# Read the dataset for the first time.
result_read1  &lt;- REDCapR::redcap_read_oneshot(redcap_uri=uri, token=token)
ds1           &lt;- result_read1$data
ds1$telephone

# Manipulate a field in the dataset in a VALID way
ds1$telephone &lt;- paste0("(405) 321-000", seq_len(nrow(ds1)))

ds1 &lt;- ds1[1:3, ]
ds1$age       &lt;- NULL; ds1$bmi &lt;- NULL #Drop the calculated fields before writing.
result_write  &lt;- REDCapR::redcap_write(ds1, redcap_uri=uri, token=token)

# Read the dataset for the second time.
result_read2  &lt;- REDCapR::redcap_read_oneshot(redcap_uri=uri, token=token)
ds2           &lt;- result_read2$data
ds2$telephone

# Manipulate a field in the dataset in an INVALID way.  A US exchange can't be '111'.
ds1$telephone &lt;- paste0("(405) 321-000", seq_len(nrow(ds1)))

# This next line will throw an error.
result_write &lt;- REDCapR::redcap_write(ds1, redcap_uri=uri, token=token)
result_write$raw_text

## End(Not run)
</code></pre>

<hr>
<h2 id='redcap_write_oneshot'>Write/Import records to a REDCap project</h2><span id='topic+redcap_write_oneshot'></span>

<h3>Description</h3>

<p>This function uses REDCap's API to select and return data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redcap_write_oneshot(
  ds,
  redcap_uri,
  token,
  overwrite_with_blanks = TRUE,
  convert_logical_to_integer = FALSE,
  verbose = TRUE,
  config_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="redcap_write_oneshot_+3A_ds">ds</code></td>
<td>
<p>The <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> to be imported into the REDCap project.
Required.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_redcap_uri">redcap_uri</code></td>
<td>
<p>The URI (uniform resource identifier) of the REDCap
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_token">token</code></td>
<td>
<p>The user-specific string that serves as the password for a
project.  Required.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_overwrite_with_blanks">overwrite_with_blanks</code></td>
<td>
<p>A boolean value indicating if
blank/<code>NA</code> values in the R <a href="base.html#topic+data.frame">base::data.frame</a>
will overwrite data on the server.
This is the default behavior for REDCapR,
which essentially deletes the cell's value
If <code>FALSE</code>, blank/<code>NA</code> values in the <a href="base.html#topic+data.frame">base::data.frame</a>
will be ignored.  Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_convert_logical_to_integer">convert_logical_to_integer</code></td>
<td>
<p>If <code>TRUE</code>, all <a href="base.html#topic+logical">base::logical</a> columns
in <code>ds</code> are cast to an integer before uploading to REDCap.
Boolean values are typically represented as 0/1 in REDCap radio buttons.
Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_verbose">verbose</code></td>
<td>
<p>A boolean value indicating if <code>message</code>s should be printed
to the R console during the operation.  The verbose output might contain
sensitive information (<em>e.g.</em> PHI), so turn this off if the output might
be visible somewhere public. Optional.</p>
</td></tr>
<tr><td><code id="redcap_write_oneshot_+3A_config_options">config_options</code></td>
<td>
<p>A list of options to pass to <code><a href="httr.html#topic+POST">httr::POST()</a></code> method
in the 'httr' package.  See the details in <code><a href="#topic+redcap_read_oneshot">redcap_read_oneshot()</a></code> Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, the function doesn't modify any variable types to conform to
REDCap's supported variables.  See <code><a href="#topic+validate_for_write">validate_for_write()</a></code> for a helper
function that checks for some common important conflicts.
</p>


<h3>Value</h3>

<p>Currently, a list is returned with the following elements:
</p>

<ul>
<li> <p><code>success</code>: A boolean value indicating if the operation was apparently
successful.
</p>
</li>
<li> <p><code>status_code</code>: The
<a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">http status code</a>
of the operation.
</p>
</li>
<li> <p><code>outcome_message</code>: A human readable string indicating the operation's
outcome.
</p>
</li>
<li> <p><code>records_affected_count</code>: The number of records inserted or updated.
</p>
</li>
<li> <p><code>affected_ids</code>: The subject IDs of the inserted or updated records.
</p>
</li>
<li> <p><code>elapsed_seconds</code>: The duration of the function.
</p>
</li>
<li> <p><code>raw_text</code>: If an operation is NOT successful, the text returned by
REDCap.  If an operation is successful, the <code>raw_text</code> is returned as an
empty string to save RAM.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Define some constants
uri            &lt;- "https://bbmc.ouhsc.edu/redcap/api/"
token          &lt;- "D70F9ACD1EDD6F151C6EA78683944E98"

# Read the dataset for the first time.
result_read1   &lt;- REDCapR::redcap_read_oneshot(redcap_uri=uri, token=token)
ds1            &lt;- result_read1$data
ds1$telephone

# Manipulate a field in the dataset in a VALID way
ds1$telephone  &lt;- paste0("(405) 321-000", seq_len(nrow(ds1)))

ds1 &lt;- ds1[1:3, ]
ds1$age        &lt;- NULL; ds1$bmi &lt;- NULL #Drop the calculated fields before writing.
result_write   &lt;- REDCapR::redcap_write_oneshot(ds=ds1, redcap_uri=uri, token=token)

# Read the dataset for the second time.
result_read2   &lt;- REDCapR::redcap_read_oneshot(redcap_uri=uri, token=token)
ds2            &lt;- result_read2$data
ds2$telephone

# Manipulate a field in the dataset in an INVALID way.  A US exchange can't be '111'.
ds1$telephone  &lt;- paste0("(405) 321-000", seq_len(nrow(ds1)))

# This next line will throw an error.
result_write   &lt;- REDCapR::redcap_write_oneshot(ds=ds1, redcap_uri=uri, token=token)
result_write$raw_text

## End(Not run)
</code></pre>

<hr>
<h2 id='replace_nas_with_explicit'>Create explicit factor level for missing values</h2><span id='topic+replace_nas_with_explicit'></span>

<h3>Description</h3>

<p>Missing values are converted to a factor level.
This explicit assignment can reduce the chances that missing values
are inadvertently ignored. It also allows the presence of a missing
to become a predictor in models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_nas_with_explicit(
  scores,
  new_na_label = "Unknown",
  create_factor = FALSE,
  add_unknown_level = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_nas_with_explicit_+3A_scores">scores</code></td>
<td>
<p>An array of values, ideally either factor or character.
Required</p>
</td></tr>
<tr><td><code id="replace_nas_with_explicit_+3A_new_na_label">new_na_label</code></td>
<td>
<p>The factor label assigned to the missing value.
Defaults to <code>Unknown</code>.</p>
</td></tr>
<tr><td><code id="replace_nas_with_explicit_+3A_create_factor">create_factor</code></td>
<td>
<p>Converts <code>scores</code> into a factor, if it isn't one
already. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="replace_nas_with_explicit_+3A_add_unknown_level">add_unknown_level</code></td>
<td>
<p>Should a new factor level be created?
(Specify <code>TRUE</code> if it already exists.)   Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array of values, where the <code>NA</code> values are now a factor level,
with the label specified by the <code>new_na_label</code> value.
</p>


<h3>Note</h3>

<p>The <code>create_factor</code> parameter is respected only if <code>scores</code> isn't already
a factor. Otherwise, levels without any values would be lost.
</p>
<p>A <code>stop</code> error will be thrown if the operation fails to convert all the
<code>NA</code> values.
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(REDCapR) #Load the package into the current R session.
</code></pre>

<hr>
<h2 id='retrieve_credential'>Read a token and other credentials from a (non-REDCap)
database or file</h2><span id='topic+retrieve_credential'></span><span id='topic+retrieve_credential_local'></span><span id='topic+retrieve_credential_mssql'></span><span id='topic+create_credential_local'></span>

<h3>Description</h3>

<p>These functions are not essential to calling the REDCap API,
but instead are functions that help manage tokens securely.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>retrieve_credential_local(
  path_credential,
  project_id,
  check_url            = TRUE,
  check_username       = FALSE,
  check_token_pattern  = TRUE,
  username             = NA_character_
)

retrieve_credential_mssql(
  project_id,
  instance,
  dsn,
  channel    = NULL
)

create_credential_local(
  path_credential
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="retrieve_credential_+3A_path_credential">path_credential</code></td>
<td>
<p>The file path to the CSV containing the credentials.
Required.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_project_id">project_id</code></td>
<td>
<p>The ID assigned to the project withing REDCap.  This
allows the user to store tokens to multiple REDCap projects in one file.
Required</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_check_url">check_url</code></td>
<td>
<p>A <code>logical</code> value indicates if the url in the credential
file should be checked to have approximately the correct form.  Defaults
to TRUE.
<code><a href="#topic+retrieve_credential_local">retrieve_credential_local()</a></code>.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_check_username">check_username</code></td>
<td>
<p>A <code>logical</code> value indicates if the username in the
credential file should be checked against the username returned by R.
Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_check_token_pattern">check_token_pattern</code></td>
<td>
<p>A <code>logical</code> value indicates if the token in the
credential file is a 32-character hexadecimal string.  Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_username">username</code></td>
<td>
<p>A character value used to retrieve a credential.
See the Notes below. Optional.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_instance">instance</code></td>
<td>
<p>The casual name associated with the REDCap instance on
campus.  This allows one credential system to accommodate multiple
instances on campus.  Required</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_dsn">dsn</code></td>
<td>
<p>A <a href="https://en.wikipedia.org/wiki/Data_source_name">DSN</a> on the
local machine that points to the desired MSSQL database. Required.</p>
</td></tr>
<tr><td><code id="retrieve_credential_+3A_channel">channel</code></td>
<td>
<p>An <em>optional</em> connection handle as returned by
<code><a href="DBI.html#topic+dbConnect">DBI::dbConnect()</a></code>.  See Details below. Optional.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the database elements are created with the script provided in package's
'Security Database' vignette, the default values will work.
</p>
<p>The <code>create_credential_local()</code> function copies a
<a href="https://github.com/OuhscBbmc/REDCapR/blob/master/inst/misc/skeleton.credentials">static file</a>
to the location specified in the <code>path_credential</code> argument.
Each record represents one accessible project per user.
Follow these steps to adapt to your desired REDCap project(s):
</p>

<ol>
<li><p> Modify the credential file for the REDCap API with a text editor
like <a href="https://notepad-plus-plus.org/">Notepad++</a>,
<a href="https://code.visualstudio.com/">Visual Studio Code</a>, or
<a href="https://www.nano-editor.org/">nano</a>.
Replace existing records with the information from your projects.
Delete the remaining example records.
</p>
</li>
<li><p> Make sure that the file (with the sensitive password-like) tokens
is stored securely!
</p>
</li>
<li><p> Contact your REDCap admin to request the URI &amp; token and
discuss institutional policies.
</p>
</li>
<li><p> Ask your institution's IT security team for their recommendation
</p>
</li>
<li><p> For more info, see https://ouhscbbmc.github.io/REDCapR/articles/workflow-read.html
and https://ouhscbbmc.github.io/REDCapR/reference/retrieve_credential.html
</p>
</li>
<li><p> Double-check the file is secured and not accessible by other users.
</p>
</li></ol>



<h3>Value</h3>

<p>A list of the following elements are returned from
<code>retrieve_credential_local()</code> and <code>retrieve_credential_mssql()</code>:
</p>

<ul>
<li> <p><code>redcap_uri</code>: The URI of the REDCap Server.
</p>
</li>
<li> <p><code>username</code>: Username.
</p>
</li>
<li> <p><code>project_id</code>: The ID assigned to the project within REDCap.
</p>
</li>
<li> <p><code>token</code>: The token to pass to the REDCap server
</p>
</li>
<li> <p><code>comment</code>: An optional string that is ignored by REDCapR
but can be helpful for humans.
</p>
</li></ul>



<h3>Note</h3>

<p><em>Storing credentials on a server is preferred</em>
</p>
<p>Although we strongly encourage storing all the tokens on a central server
(<em>e.g.</em>, see the <code>retrieve_credential_mssql()</code> function and the
&quot;SecurityDatabase&quot; vignette), there are times when this approach is not
feasible and the token must be stored locally.  Please contact us
if your institution is using something other than SQL Server, and
would like help adapting this approach to your infrastructure.
</p>
<p><em>Stored credentials locally</em>
</p>
<p>When storing credentials locally, typically the credential file
should be dedicated to just one user. Occasionally it makes sense to store
tokens for multiple users &ndash;usually it's for the purpose of testing.
</p>
<p>The <code>username</code> field is connected only in the local credential file.
It does not need to be the same as the official username in REDCap.
</p>


<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ---- Local File Example ----------------------------
path &lt;- system.file("misc/example.credentials", package = "REDCapR")
(p1  &lt;- REDCapR::retrieve_credential_local(path, 153L))
(p2  &lt;- REDCapR::retrieve_credential_local(path, 212L))


## Not run: 
# Create a skeleton of the local credential file to modify
path_demo &lt;- base::tempfile(pattern = "temp", fileext = ".credentials")

create_credential_local(path_demo)

base::unlink(path_demo) # This is just a demo; don't delete the real file!

## End(Not run)

</code></pre>

<hr>
<h2 id='sanitize_token'>Validate and sanitize the user's REDCap token</h2><span id='topic+sanitize_token'></span>

<h3>Description</h3>

<p>Verifies the token is nonmissing and conforms to the legal
pattern of a 32-character hexadecimal value.
Each character must be an (a) digit 0-9, (b) uppercase letter A-F, or
(c) lowercase letter a-f.
#' Trailing line endings are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sanitize_token(token)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sanitize_token_+3A_token">token</code></td>
<td>
<p>The REDCap token. Required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The token, without a terminal newline character.
</p>


<h3>Note</h3>

<p>Contact your institution's REDCap administrator for more information
about your project-specific token.
</p>


<h3>Author(s)</h3>

<p>Hao Zhu, Benjamin Nutter, Will Beasley, Jordan Mark Barbone
</p>


<h3>Examples</h3>

<pre><code class='language-R'>secret_token_1 &lt;- "12345678901234567890123456ABCDEF"
secret_token_2 &lt;- "12345678901234567890123456ABCDEF\n"
secret_token_3 &lt;- "12345678901234567890123456abcdef"
REDCapR::sanitize_token(secret_token_1)
REDCapR::sanitize_token(secret_token_2)
REDCapR::sanitize_token(secret_token_3)
</code></pre>

<hr>
<h2 id='validate'>Inspect a dataset to anticipate problems before
writing to a REDCap project</h2><span id='topic+validate'></span><span id='topic+validate_no_logical'></span><span id='topic+validate_for_write'></span><span id='topic+validate_field_names'></span><span id='topic+validate_field_names_collapsed'></span>

<h3>Description</h3>

<p>This set of functions inspect a <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> to
anticipate problems before writing with REDCap's API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_for_write( d )

validate_no_logical( data_types, stop_on_error )

validate_field_names( field_names, stop_on_error = FALSE )

validate_field_names_collapsed( field_names_collapsed, stop_on_error = FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_+3A_data_types">data_types</code></td>
<td>
<p>The data types of the <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> corresponding
to the REDCap project.</p>
</td></tr>
<tr><td><code id="validate_+3A_stop_on_error">stop_on_error</code></td>
<td>
<p>If <code>TRUE</code>, an error is thrown for violations.
Otherwise, a dataset summarizing the problems is returned.</p>
</td></tr>
<tr><td><code id="validate_+3A_d">d</code></td>
<td>
<p>The <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> containing the dataset used to update
the REDCap project.</p>
</td></tr>
<tr><td><code id="validate_+3A_field_names">field_names</code></td>
<td>
<p>The names of the fields/variables in the REDCap project.
Each field is an individual element in the character vector.</p>
</td></tr>
<tr><td><code id="validate_+3A_field_names_collapsed">field_names_collapsed</code></td>
<td>
<p>The names of the fields/variables in the
REDCap project.  All fields are combined in a single vector element,
separated by commas.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All functions listed in the Usage section above inspect a specific aspect
of the dataset.  The <code><a href="#topic+validate_for_write">validate_for_write()</a></code> function executes all these
individual validation checks.  It allows the client to check everything
with one call.
</p>
<p>Currently it verifies that the dataset
</p>

<ul>
<li><p> does not contain
<a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/logical.html">logical</a>
values (because REDCap typically wants <code>0</code>/<code>1</code> values instead of
<code>FALSE</code>/<code>TRUE</code>).
</p>
</li>
<li><p> starts with a lowercase letter, and subsequent optional characters are a
sequence of (a) lowercase letters, (b) digits 0-9, and/or (c) underscores.
(The exact regex is <code style="white-space: pre;">&#8288;^[a-z][0-9a-z_]*$&#8288;</code>.)
</p>
</li></ul>

<p>If you encounter additional types of problems when attempting to write to
REDCap, please tell us by creating a
<a href="https://github.com/OuhscBbmc/REDCapR/issues">new issue</a>, and we'll
incorporate a new validation check into this function.
</p>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code>, where each potential violation is a row.
The two columns are:
</p>

<ul>
<li> <p><code>field_name</code>: The name of the <code><a href="base.html#topic+data.frame">base::data.frame()</a></code> that might cause
problems during the upload.
</p>
</li>
<li> <p><code>field_index</code>: The position of the field.  (For example, a value of
'1' indicates the first column, while a '3' indicates the third column.)
</p>
</li>
<li> <p><code>concern</code>: A description of the problem potentially caused by the <code>field</code>.
</p>
</li>
<li> <p><code>suggestion</code>: A <em>potential</em> solution to the concern.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Will Beasley
</p>


<h3>References</h3>

<p>The official documentation can be found on the 'API Help Page'
and 'API Examples' pages on the REDCap wiki (<em>i.e.</em>,
https://community.projectredcap.org/articles/456/api-documentation.html and
https://community.projectredcap.org/articles/462/api-examples.html).
If you do not have an account for the wiki, please ask your campus REDCap
administrator to send you the static material.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- data.frame(
  record_id      = 1:4,
  flag_logical   = c(TRUE, TRUE, FALSE, TRUE),
  flag_Uppercase = c(4, 6, 8, 2)
)
REDCapR::validate_for_write(d = d)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
