<!DOCTYPE html><html><head><title>Help for package mkde</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mkde}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mkde-package'>
<p>Movement-based kernel density estimates (MKDEs) in 2 or 3 spatial dimensions.</p></a></li>
<li><a href='#computeAreaRaster'>
<p>Calculate cell areas from elevation raster.</p></a></li>
<li><a href='#computeContourValues'>
<p>Find thresholds for contour intervals</p></a></li>
<li><a href='#computeSizeMKDE'>
<p>Compute the area or volume of an MKDE.</p></a></li>
<li><a href='#condor'>
<p>California condor locations</p></a></li>
<li><a href='#condordem'>
<p>A RasterLayer containing a digital elevation model (DEM) for the condor data</p></a></li>
<li><a href='#condordem120'>
<p>A RasterLayer containing a digital elevation model (DEM) for the condor data</p></a></li>
<li><a href='#deselectLocationsOutsideBounds'>
<p>Flag 3D locations with out-of-bounds z-coordinates</p></a></li>
<li><a href='#deselectNonMovementSteps'>
<p>Flag non-movements so they are excluded from MKDE estimation</p></a></li>
<li><a href='#dugong'>
<p>Dugong locations</p></a></li>
<li><a href='#dugongdem'>
<p>A RasterLayer containing bathymetry for the dugong data</p></a></li>
<li><a href='#estVarMKDE'>
<p>Estimate move variances for 3D MKDE.</p></a></li>
<li><a href='#initializeAreaRaster'>
<p>Initialize an area raster for a 2.5D MKDE.</p></a></li>
<li><a href='#initializeDensity'>
<p>Calculate raster of density values for MKDE.</p></a></li>
<li><a href='#initializeMKDE2D'>
<p>Set up a 2D MKDE object.</p></a></li>
<li><a href='#initializeMKDE3D'>
<p>Set up a 3D MKDE object.</p></a></li>
<li><a href='#initializeMovementData'>
<p>Initialize a movement data list</p></a></li>
<li><a href='#mkde2Dgrid'>
<p>Movement-based kernel density estimate (MKDE) in 2D using Rcpp</p></a></li>
<li><a href='#mkde2Dinteraction'>
<p>Probability of 2D spatial-temporal interaction.</p></a></li>
<li><a href='#mkde3Dgrid'>
<p>Movement-based kernel density estimate (MKDE) in 3D using Rcpp</p></a></li>
<li><a href='#mkde3Dinteraction'>
<p>Probability of 3D spatial-temporal interaction.</p></a></li>
<li><a href='#mkdeToRaster'>
<p>MKDE to RasterLayer or RasterStack</p></a></li>
<li><a href='#panda'>
<p>Giant panda locations</p></a></li>
<li><a href='#pandadem'>
<p>A RasterLayer containing a digital elevation model (DEM) for the panda data</p></a></li>
<li><a href='#plotMKDE'>
<p>Make an image plot of an MKDE.</p></a></li>
<li><a href='#setMaximumZfromConstant'>
<p>Initialize maximum allowable z-axis coordinates to a constant value.</p></a></li>
<li><a href='#setMaximumZfromRaster'>
<p>Initialize maximum z-axis value from a raster</p></a></li>
<li><a href='#setMinimumZfromConstant'>
<p>Set minimum z-axis value to a constant.</p></a></li>
<li><a href='#setMinimumZfromRaster'>
<p>Set minimum z-axis values from a raster</p></a></li>
<li><a href='#writeInterpolatedPathVTK'>
<p>Write path to VTK.</p></a></li>
<li><a href='#writeObservedLocationVTK'>
<p>Write observed locations to VTK.</p></a></li>
<li><a href='#writeRasterToVTK'>
<p>Write a 2D raster to XDMF XML wrapper and binary data file.</p></a></li>
<li><a href='#writeRasterToXDMF'>
<p>Write a 2D raster to XDMF XML wrapper and binary data file.</p></a></li>
<li><a href='#writeToGRASS'>
<p>Write MKDE to a GRASS GIS 3D ASCII raster file.</p></a></li>
<li><a href='#writeToVTK'>
<p>Write MKDE to an ASCII Visualization Tool Kit (VTK) structured grid file.</p></a></li>
<li><a href='#writeToXDMF'>
<p>Write 3D MKDE to XDMF XML wrapper and binary data file.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>2D and 3D Movement-Based Kernel Density Estimates (MKDEs)</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeff A. Tracey, James Sheppard, Jun Zhu, Robert Sinkovts, Amit Chourasia, Glenn Lockwood, and Robert N. Fisher</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert Sinkovits &lt;sinkovit@sdsc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to compute and visualize movement-based kernel density estimates (MKDEs) for animal utilization distributions in 2 or 3 spatial dimensions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.9.6), raster, sp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-29 19:42:50 UTC; robertsinkovits</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-01 18:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mkde-package'>
Movement-based kernel density estimates (MKDEs) in 2 or 3 spatial dimensions.
</h2><span id='topic+mkde-package'></span><span id='topic+mkde'></span>

<h3>Description</h3>

<p>The mkde package enables animal space use to be estimated in three
dimensions (3D) using data collected from biotelemetry tracking
devices. This package addresses a recognized need in modeling animal
space use (Belant et al. 2012) wherein researchers have been limited by
the lack of 3D home range estimators. Animal space use can be
characterized by the (x, y) spatial dimensions as well as a third
z-dimension representing altitude, elevation, or depth for flying,
terrestrial, or aquatic species, respectively. Although many
biotelemetry devices record 3D location data with x, y, and z
coordinates from tracked animals, the third z coordinate is typically
not integrated into studies of animal spatial use. The mkde package
enables users to visually explore the 3D MKDE volumes of animals to more
intuitively understand how they are spatially related to the
environmental covariates and bounding layers within their ranges, such
as bathymetry or topography.
</p>
<p>The mkde package builds on previous work on the Brownian bridge
approach for estimating animal utilization distributions (Horne et
al. 2007). This method, in contrast to location-based KDEs, integrates
kernels over time along a movement path interpolated between observed
locations. Benhamou distinguished location-based kernel density
estimators (LKDE) from movement-based kernel density estimators (MKDE),
which includes Brownian bridge and biased random walk models. MKDEs
account for time between consecutively observations in the estimator, do
not requiring independent samples from the UD, and thus more
realistically represent the space used by an animal.
</p>
<p>The user inputs animal location data typically obtained by a Global
Positioning System (GPS) or Very High Frequency (VHF) device in which
each observation includes an x-coordinate, a y-coordinate,a
z-coordinate, and time. The observed locations are assumed to be subject
to observation error and are normal random variables. The observation
error variances are either provided by the manufacturers of the
telemetry equipment or estimated from field trials, e.g., Hansen and
Riggs (2008). Often, an animal's movement is limited in the
z-dimension. For example, avian species are generally bounded below by
the earth's surface, whereas marine animals are bounded below by the sea
floor and above by the water's surface. Package functions allow the mkde
user to bound the density in the z-dimension by a(x,y) and b(x,y) with a
constant or a 2D raster.
</p>
<p>The mkde package provides a 2.5D approach for computing home range area
that essentially uses a 2D MKDE draped over a 2D elevation raster. The
bias is corrected by calculating and summing the surface area of each
cell of the elevation raster that falls within a desired probability
contour of the 2D MKDE. An algorithm developed by Jenness (2004, 2014)
is used to compute the surface area of each raster cell. This method
uses the cell center coordinates and elevations of the focal cell and
its eight neighboring cells to construct eight triangular facets within
the focal cell. The area of each facet is calculated using Heron's
formula and then summed to obtain the surface area for the focal cell.
</p>
<p>Numerous functions are provided to write output files in various formats
(VTK, XDMF, ASCII) for use in other GIS and 3D Visualization
applications.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mkde</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-08-23</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Jeff A. Tracey (US Geological Survey, San Diego Field Station, Western
Ecological Research Center) <br />
James Sheppard (San Diego Zoo Institute for Conservation Research) <br />
Jun Zhu (Department of Statistics and Department of Entomology,
University of Wisconsin &ndash; Madison) <br />
Robert Sinkovits (San Diego Supercomputer Center) <br />
Amit Chourasia (San Diego Supercomputer Center) <br />
Glenn Lockwood (San Diego Supercomputer Center) <br />
Maintainer: Jeff A. Tracey &lt;jatracey@usgs.gov, jeff.a.tracey@gmail.com&gt;
</p>


<h3>References</h3>

<p>Tracey, J. A., Sheppard, J., Zhu, J., Wei, F., Swaisgood, R. R. and
Fisher, R. N. (2014)
Movement-Based Estimation and Visualization of Space Use in 3D for
Wildlife Ecology and Conservation. PLoS ONE 9(7): e101205. doi:
10.1371/journal.pone.0101205 <br />
Tracy, J. A., Sheppard, J. Lockwood, G., Chourasia, A., Tatineni, M., 
Fisher, R. N., and Sinkovits, R. (2014) Efficient 3D Movement-Based
Kernel Density Estimator and Application to Wildlife Ecology. XSEDE 14
Conference Proceedings, Article No. 14. doi: 10.1145/2616498.2616522<br />
Belant, J. L., Millspaugh, J. J., Martin, J. A. &amp; Gitzen,
R. A. (2012). Multi-dimensional space use: the final
frontier. Frontiers in Ecology &amp; Environment 10, 11-12. <br />
Benhamou, S. (2011). Dynamic Approach to Space and Habitat Use Based
on biased random bridges. PLoS ONE 6. <br />
Hansen, M. C., &amp; Riggs, R. A. (2008). Accuracy, precision, and
observation rates of global positioning system telemetry collars. The
Journal of Wildlife Management, 72(2), 518-526. <br />
Horne, J. S., Garton, E. O., Krone, S. M., Lewis, J. S. (2007). Analyzing
animal movements using Brownian bridges. Ecology 88, 2354-2363. <br />
Jenness J. S. (2004) Calculating landscape surface area from digital
elevation models. Wildlife Society Bulletin 32: 829-839. <br />
Jenness, J. S. (2014) Calculating landscape surface area from
unprojected digital elevation models. In preparation.
</p>

<hr>
<h2 id='computeAreaRaster'>
Calculate cell areas from elevation raster.
</h2><span id='topic+computeAreaRaster'></span>

<h3>Description</h3>

<p>A lower-level function for calculating a cell area matrix (2D array) from an
elevation matrix.  The area is based on the surface area of the terrain
in the cell.  The area matrix is then used in calculating areas of
2.5D MKDES.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeAreaRaster(RelevMatrix, RcellSize)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeAreaRaster_+3A_relevmatrix">RelevMatrix</code></td>
<td>
<p>A 2D array with elevation values.</p>
</td></tr>
<tr><td><code id="computeAreaRaster_+3A_rcellsize">RcellSize</code></td>
<td>
<p>Size of the cells.  It is assumed to be the same in
the x and y dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper function for C++ function that calculates the surface area of each raster cell given the cell elevations.  It is not intended to be used directly; instead, the user should call <code>initializeAreaRaster</code> on an MKDE object.
</p>


<h3>Value</h3>

<p>A 2D matrix of cell surface areas.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>References</h3>

<p>Jenness J.S. (2004) Calculating landscape surface area from digital
elevation models. Wildlife Society Bulletin 32: 829-839. <br />
Jenness, J.S. (2014) Calculating landscape surface area from
unprojected digital elevation models. In preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem)
cell.sz &lt;- mean(res(condordem))
area.rast &lt;- computeAreaRaster(as.matrix(condordem), cell.sz)
</code></pre>

<hr>
<h2 id='computeContourValues'>
Find thresholds for contour intervals
</h2><span id='topic+computeContourValues'></span>

<h3>Description</h3>

<p>Find the cell or voxel probabilities that correspond to user-specified probability contours
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeContourValues(mkde.obj, prob)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeContourValues_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object with density initialized</p>
</td></tr>
<tr><td><code id="computeContourValues_+3A_prob">prob</code></td>
<td>
<p>Probabilities (i.e. proportions) for desired contours of
the MKDE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes threshold cell or voxel probability values
corresponding to contours for specified proportions of the utilization
distribution. Note that the arugment <code>prob</code> specifies the
cumulative probability of the cells or voxels within the contour
corresponding to the cell or voxel threshold probability. The cell or
voxel threshold probabilities may be orders of magnitude smaller than
the cumulative probabilities provided in the <code>prob</code> argument.
</p>


<h3>Value</h3>

<p>A data frame with the probabilities given in the prob argument and
corresponding thresholds in the MKDE
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a> <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)

# Find min/max coordinates and add buffer
xmax = max(condor$x) + 1000
xmin = min(condor$x) - 1000
ymax = max(condor$y) + 1000
ymin = min(condor$y) - 1000

# Calculate grid dimensions
xrange &lt;- xmax - xmin
yrange &lt;- ymax - ymin
cell.sz = 150
nx &lt;- as.integer(xrange/cell.sz)
ny &lt;- as.integer(yrange/cell.sz)

mv.dat &lt;- initializeMovementData(condor$t, condor$x, condor$y, sig2obs=25.0, t.max=185.0)
mkde.obj &lt;- initializeMKDE2D(xmin, cell.sz, nx, ymin, cell.sz, ny)
dens.res &lt;- initializeDensity(mkde.obj, mv.dat)

mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat
my.quantiles &lt;- c(0.95, 0.75, 0.50)
res &lt;- computeContourValues(mkde.obj, my.quantiles)
print(res)
</code></pre>

<hr>
<h2 id='computeSizeMKDE'>
Compute the area or volume of an MKDE.
</h2><span id='topic+computeSizeMKDE'></span>

<h3>Description</h3>

<p>For 2D MKDEs, this function computes the area.  For a 2.5D MKDE it
computes the area based on the cell areas computed from an elevation
raster.  For a 3D MKDE, it computes the volume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeSizeMKDE(mkde.obj, prob)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeSizeMKDE_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>MKDE list object with density estimate calculated.</p>
</td></tr>
<tr><td><code id="computeSizeMKDE_+3A_prob">prob</code></td>
<td>
<p>Probabilities for the desired contours.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a 2D or 2.5D MKDE list object, areas within the contours specified by quant are calculated.  For a 3D MKDE, the volumes within the contours are calculated.
</p>


<h3>Value</h3>

<p>A vector with the areas or volumes is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a> <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:20,] # simply to make example run more quickly
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem120)
cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem120), na.rm=TRUE), cell.sz, 25)

# note: we use a raster coarse integration time step so the
# example runs faster
dens.res &lt;- initializeDensity(mkde.obj, mv.dat, integration.step=10.0)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat

my.quantiles &lt;- c(0.95, 0.75, 0.50)
res &lt;- computeContourValues(mkde.obj, my.quantiles)
res$volume &lt;- computeSizeMKDE(mkde.obj, my.quantiles)
print(res)
</code></pre>

<hr>
<h2 id='condor'>
California condor locations
</h2><span id='topic+condor'></span>

<h3>Description</h3>

<p>A data frame containing California condor location data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(condor)</code></pre>


<h3>Format</h3>

<p>A data frame with 421 observations on the following 4 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p>Elapsed time in minutes</p>
</dd>
<dt><code>x</code></dt><dd><p>x-coordinate (UTM easting in meters)</p>
</dd>
<dt><code>y</code></dt><dd><p>y-coordinate (UTM northing in meters)</p>
</dd>
<dt><code>z</code></dt><dd><p>z-coordinate (height above sea level in meters)</p>
</dd>
</dl>



<h3>Details</h3>

<p>GPS location data acquired from a wild California condor (Gymnogyps californianus) tracked by San Diego Zoo Global around its reintroduction site in Baja California, Mexico during November 2012 (Sheppard et al. 2013).
</p>


<h3>Source</h3>

<p>James Sheppard, San Diego Zoo Institute for Conservation Research
</p>


<h3>References</h3>

<p>Sheppard, J.K., Walenski, M., Wallace, M.P., Velazco, J.J.V., Porras, C., &amp; Swaisgood, R.R. (2013). Hierarchical dominance structure in reintroduced California condors: correlates, consequences, and dynamics. Behavioral Ecology and Sociobiology. 67: 1-12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condor)
head(condor, 30)
</code></pre>

<hr>
<h2 id='condordem'>
A RasterLayer containing a digital elevation model (DEM) for the condor data
</h2><span id='topic+condordem'></span>

<h3>Description</h3>

<p>Digital elevation model of the terrain within the condor's range with a cell resolution of 30 meters (ASTER GDEM version 2, Tachikawa et. al. 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(condordem)</code></pre>


<h3>Format</h3>

<p>A raster package RasterLayer object with 749 rows, 623 columns, and
a cell size of 30 by 30 meters. Each cell contains an elevation in meters.
</p>


<h3>Source</h3>

<p>URL: http://asterweb.jpl.nasa.gov/gdem.asp
</p>


<h3>References</h3>

<p>Tachikawa, T., Hato, M., Kaku, M. &amp; Iwasaki, A. (2011). The characteristics of ASTER GDEM version 2, IGARSS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem)
plot(condordem)
</code></pre>

<hr>
<h2 id='condordem120'>
A RasterLayer containing a digital elevation model (DEM) for the condor data
</h2><span id='topic+condordem120'></span>

<h3>Description</h3>

<p>Digital elevation model of the terrain within the condor's range with a cell resolution of 120 meters (ASTER GDEM version 2, Tachikawa et. al. 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(condordem120)</code></pre>


<h3>Format</h3>

<p>A raster package RasterLayer object with 188 rows, 156 columns, and
a cell size of 120 by 120 meters. Each cell contains an elevation in meters.
</p>


<h3>Source</h3>

<p>URL: http://asterweb.jpl.nasa.gov/gdem.asp
</p>


<h3>References</h3>

<p>Tachikawa, T., Hato, M., Kaku, M. &amp; Iwasaki, A. (2011). The characteristics of ASTER GDEM version 2, IGARSS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem120)
plot(condordem120)
</code></pre>

<hr>
<h2 id='deselectLocationsOutsideBounds'>
Flag 3D locations with out-of-bounds z-coordinates
</h2><span id='topic+deselectLocationsOutsideBounds'></span>

<h3>Description</h3>

<p>For a 3D MKDE object and 3D location data, the z-coordinates in the
location data are checked to make sure they are within the lower and
upper bounds specified in the MKDE list object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deselectLocationsOutsideBounds(move.dat, mkde.obj) 	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deselectLocationsOutsideBounds_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="deselectLocationsOutsideBounds_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize2DMKDE</code> or
<code>initialize3DMKDE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a 2D or 2.5D MDKE object is passed as an argument, no change is made
to the movement data list object.  If a 3D MKDE list object is passed as
an argument, the z-coordinates in the movement data are checked to
determine if they are in range.  If they are not, the corresponding
value in move.dat$use.obs is set to FALSE.  Note that this function is
not called within <code>initialzeDensity</code>.  If you want to exclude locations
because they are outside of the allowed range in the z-dimension, this
function must be used before computing the density.
</p>


<h3>Value</h3>

<p>An updated move data list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem)
cell.sz &lt;- mean(res(condordem))
ext &lt;- extent(condordem)
nx &lt;- ncol(condordem)
ny &lt;- nrow(condordem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem), na.rm=TRUE), 30.0, 100)
mkde.obj &lt;- setMinimumZfromRaster(mkde.obj, condordem)
mv.dat &lt;- deselectLocationsOutsideBounds(mv.dat, mkde.obj)
</code></pre>

<hr>
<h2 id='deselectNonMovementSteps'>
Flag non-movements so they are excluded from MKDE estimation
</h2><span id='topic+deselectNonMovementSteps'></span>

<h3>Description</h3>

<p>This function deselects move steps where the probability that the
initial and final location are the same location is greater than or
equal to a user-defined threshold probability
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deselectNonMovementSteps(move.dat, p) 	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deselectNonMovementSteps_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="deselectNonMovementSteps_+3A_p">p</code></td>
<td>
<p>The threshold probability</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the probability that the initial and final location are the same
location is greater than or equal to a user-defined threshold
probability, the corresponding value in move.dat$use.obs is set to
FALSE. Note that this function is not called within <code>initialzeDensity</code>.
If you want to exclude locations because they the initial location in
a non-movement step, this function must be used before computing the density.
</p>


<h3>Value</h3>

<p>An updated move data list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

mv.dat &lt;- deselectNonMovementSteps(mv.dat, 0.05)
</code></pre>

<hr>
<h2 id='dugong'>
Dugong locations
</h2><span id='topic+dugong'></span>

<h3>Description</h3>

<p>A data frame containing dugong location data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dugong)</code></pre>


<h3>Format</h3>

<p>A data frame with 426 observations on the following 4 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p>Elapsed time in minutes</p>
</dd>
<dt><code>x</code></dt><dd><p>x-coordinate (UTM easting in meters)</p>
</dd>
<dt><code>y</code></dt><dd><p>y-coordinate (UTM northing in meters)</p>
</dd>
<dt><code>z</code></dt><dd><p>z-coordinate (Depth in meters)</p>
</dd>
</dl>



<h3>Details</h3>

<p>GPS location data acquired from a wild dugong (Dugong dugon) tracked by James Cook University in Hervey Bay, Australia during August 2004 (Sheppard et. al. 2010)
</p>


<h3>Source</h3>

<p>James Sheppard, San Diego Zoo Institute for Conservation Research
</p>


<h3>References</h3>

<p>Sheppard, J. Marsh, H., Jones, R.E., &amp; Lawler, I.R. (2010). Dugong habitat use in relation to seagrass nutrients, tides, and diel cycles. Marine Mammal Science 26, 855-879.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dugong)
head(dugong, 30)
</code></pre>

<hr>
<h2 id='dugongdem'>
A RasterLayer containing bathymetry for the dugong data
</h2><span id='topic+dugongdem'></span>

<h3>Description</h3>

<p>A 10-meter resolution bathymetric surface of the core seagrass habitat in depth below the mean sea level within the dugong's range (Sheppard et. al. 2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dugongdem)</code></pre>


<h3>Format</h3>

<p>A raster package RasterLayer object with 220 rows, 485 columns, and
a cell size of 10 by 10 meters. Each cell contains a depth at low tide
in meters.
</p>


<h3>Source</h3>

<p>James Sheppard, San Diego Zoo Institute for Conservation Research
</p>


<h3>References</h3>

<p>Sheppard, J. K., Lawler, I. R., &amp; Marsh, H. (2007). Seagrass as pasture for seacows: Landscape-level dugong habitat evaluation. Estuarine, Coastal and Shelf Science, 71(1), 117-132.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(dugongdem)
plot(dugongdem)
</code></pre>

<hr>
<h2 id='estVarMKDE'>
Estimate move variances for 3D MKDE.
</h2><span id='topic+estVarMKDE'></span>

<h3>Description</h3>

<p>Estimates the move variance for the (x, y) and z dimensions and altitude for a
Brownian bridge MKDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estVarMKDE(move.dat)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estVarMKDE_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes maximum-likelihood estimates for move variances. If the MKDE is 2D or 2.5D, only the variance for the xy-dimension is estimated.  If the MKDE is 3D, a separate move variance for the z-dimension is also estimated.
</p>


<h3>Value</h3>

<p>A move data object updated with move variances
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

mv.dat &lt;- estVarMKDE(mv.dat)
cat(paste("Move variance in xy-dimensions = ",
mv.dat$sig2xy[1], "\n", sep=""))
cat(paste("Move variance in z-dimension = ",
mv.dat$sig2z[1], "\n", sep=""))
</code></pre>

<hr>
<h2 id='initializeAreaRaster'>
Initialize an area raster for a 2.5D MKDE.
</h2><span id='topic+initializeAreaRaster'></span>

<h3>Description</h3>

<p>Initialize the surface area for a 2.5D MKDE. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeAreaRaster(mkde.obj)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializeAreaRaster_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created using <code>initialize2DMKDE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>After creating the MKDE object and setting the lower bounds in the
z-dimension using <code>setMinimumZfromRaster</code>, this function computes
the surface area of each raster cell and sets the dimension of the
MKDE object to 2.5.
</p>


<h3>Value</h3>

<p>Returns a 2.5 MKDE object with an initialized area raster.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(pandadem)
cell.sz &lt;- mean(res(pandadem))
ext &lt;- extent(pandadem)
nx &lt;- ncol(pandadem)
ny &lt;- nrow(pandadem)
mkde.obj &lt;- initializeMKDE2D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz, ny)

mkde.obj &lt;- setMinimumZfromRaster(mkde.obj, pandadem)
mkde.obj &lt;- initializeAreaRaster(mkde.obj)
</code></pre>

<hr>
<h2 id='initializeDensity'>
Calculate raster of density values for MKDE.
</h2><span id='topic+initializeDensity'></span>

<h3>Description</h3>

<p>Given a movement data object (list) and MKDE object (list), estimate the
movement variance parameters and update them in the movement data object
and then compute the density for a 2D, 2.5D, or 3D MKDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeDensity(mkde.obj, move.dat, integration.step, d.thresh=1e-25) 	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializeDensity_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize2DMKDE</code> or
<code>initialize3DMKDE</code></p>
</td></tr>
<tr><td><code id="initializeDensity_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="initializeDensity_+3A_integration.step">integration.step</code></td>
<td>
<p>A time step used for numerical integration
over the movement trajectory</p>
</td></tr>
<tr><td><code id="initializeDensity_+3A_d.thresh">d.thresh</code></td>
<td>
<p>The value of the kernel below which its contibrution
to the overal density is considered negligible</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the density for a 2D, 2.5D, or 3D MKDE.  If the
move variance parameters have not been estimated, they will be prior to
computing the density.  The integration time step should be much less
than the maximum time step allowed between observed animal
locations. For a 2.5D MKDE, if the area has been calculated with
<code>initializeAreaRaster</code>, then the cell probabilities are weighted by
the proportion of the total surface area represented by the cell.
</p>


<h3>Value</h3>

<p>A list is returned with two elements: <code>move.dat</code> and <code>mkde.obj</code>.  The first
is an updated move data object and the second is an updated MKDE object.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Robert Sinkovits, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:sinkovit@sdsc.edu">sinkovit@sdsc.edu</a> <br />
Glenn Lockwood, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:glock@sdsc.edu">glock@sdsc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:20,] # simply to make example run more quickly
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem120)
cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem120), na.rm=TRUE), cell.sz, 25)

# note: we use a raster coarse integration time step so the
# example runs faster
dens.res &lt;- initializeDensity(mkde.obj, mv.dat, integration.step=10.0)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat
</code></pre>

<hr>
<h2 id='initializeMKDE2D'>
Set up a 2D MKDE object.
</h2><span id='topic+initializeMKDE2D'></span>

<h3>Description</h3>

<p>Define the spatial extent and resolution of a 2D MKDE and create an 2D MKDE list object for use in other functions in the package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeMKDE2D(xLL, xCellSize, nX, yLL, yCellSize, nY)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializeMKDE2D_+3A_xll">xLL</code></td>
<td>
<p>Lower bounds of the grid in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE2D_+3A_xcellsize">xCellSize</code></td>
<td>
<p>Cell size in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE2D_+3A_nx">nX</code></td>
<td>
<p>Number of cells in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE2D_+3A_yll">yLL</code></td>
<td>
<p>Lower bounds of the grid in the y-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE2D_+3A_ycellsize">yCellSize</code></td>
<td>
<p>Cell size in the y-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE2D_+3A_ny">nY</code></td>
<td>
<p>Number of cells in the y-dimension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is strongly recommended that the same value is used for <code>xCellSize</code> and <code>yCellSize</code>.  The grid should be defined so that it covers the area that the animal used, plus a sufficient buffer so that the density is negligable beyond the grid.
</p>


<h3>Value</h3>

<p>A list representing an MKDE object is returned with the following elements:
</p>
<table>
<tr><td><code>dimension</code></td>
<td>
<p>The dimension of the MKDE; that is, 2.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A grid of points along the x-axis where the cell centers occur.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>A grid of points along the y-axis where the cell centers occur.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>A grid of points along the z-axis where the cell centers occur.  For a 2D MKDE z = NA.</p>
</td></tr>
<tr><td><code>z.min</code></td>
<td>
<p>A 2D array representing the lower bounds of space in the z-dimension at each x and y coordinate.  Defaults to -Inf.</p>
</td></tr>
<tr><td><code>z.max</code></td>
<td>
<p>A 2D array representing the upper bounds of space in the z-dimension at each x and y coordinate. Defaults to Inf.</p>
</td></tr>
<tr><td><code>nx</code></td>
<td>
<p>Number of cells in the x-dimension.</p>
</td></tr>
<tr><td><code>ny</code></td>
<td>
<p>Number of cells in the y-dimension.</p>
</td></tr>
<tr><td><code>nz</code></td>
<td>
<p>Number of cells in the z-dimension. For a 2D MKDE nz = 1.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>A 2D array with dimensions (nx, ny) that stores the density. The elements are initialized to NA.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(pandadem)
cell.sz &lt;- mean(res(pandadem))
ext &lt;- extent(pandadem)
nx &lt;- ncol(pandadem)
ny &lt;- nrow(pandadem)
mkde.obj &lt;- initializeMKDE2D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz, ny)
</code></pre>

<hr>
<h2 id='initializeMKDE3D'>
Set up a 3D MKDE object.
</h2><span id='topic+initializeMKDE3D'></span>

<h3>Description</h3>

<p>Define the spatial extent and resolution of a 3D MKDE and create an 3D
MKDE list object for use in other functions in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeMKDE3D(xLL, xCellSize, nX, yLL, yCellSize, nY,
zLL, zCellSize, nZ)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializeMKDE3D_+3A_xll">xLL</code></td>
<td>
<p>Lower bounds of the grid in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_xcellsize">xCellSize</code></td>
<td>
<p>Cell size in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_nx">nX</code></td>
<td>
<p>Number of cells in the x-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_yll">yLL</code></td>
<td>
<p>Lower bounds of the grid in the y-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_ycellsize">yCellSize</code></td>
<td>
<p>Cell size in the y-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_ny">nY</code></td>
<td>
<p>Number of cells in the y-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_zll">zLL</code></td>
<td>
<p>Lower bounds of the grid in the z-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_zcellsize">zCellSize</code></td>
<td>
<p>Cell size in the z-dimension</p>
</td></tr>
<tr><td><code id="initializeMKDE3D_+3A_nz">nZ</code></td>
<td>
<p>Number of cells in the z-dimension</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is strongly recommended that the same value is used for <code>xCellSize</code> and
<code>yCellSize</code>.  The grid should be defined so that it covers the volume that
the animal used, plus a sufficient buffer so that the density is
negligable beyond the grid.
</p>


<h3>Value</h3>

<p>A list representing an MKDE object is returned with the following elements:
</p>
<table>
<tr><td><code>dimension</code></td>
<td>
<p>The dimension of the MKDE; that is, 3.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>A grid of points along the x-axis where the voxel centers occur.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>A grid of points along the y-axis where the voxel centers occur.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>A grid of points along the z-axis where the voxel centers occur.</p>
</td></tr>
<tr><td><code>z.min</code></td>
<td>
<p>A 2D array representing the lower bounds of space in the
z-dimension at each x and y coordinate.  Defaults to a constant
value based on the arguments zLL, zCellSize,and nZ.</p>
</td></tr>
<tr><td><code>z.max</code></td>
<td>
<p>A 2D array representing the upper bounds of space in the
z-dimension at each x and y coordinate. Defaults to a constant value
based on the arguments zLL, zCellSize,and nZ.</p>
</td></tr>
<tr><td><code>nx</code></td>
<td>
<p>Number of cells in the x-dimension.</p>
</td></tr>
<tr><td><code>ny</code></td>
<td>
<p>Number of cells in the y-dimension.</p>
</td></tr>
<tr><td><code>nz</code></td>
<td>
<p>Number of cells in the z-dimension.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>A 3D array with dimensions (nx, ny, nz) that stores the
density. The elements are initialized toNA.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem)
cell.sz &lt;- mean(res(condordem))
ext &lt;- extent(condordem)
nx &lt;- ncol(condordem)
ny &lt;- nrow(condordem)
zmin &lt;- min(values(condordem), na.rm=TRUE)
nz &lt;- 30
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, zmin, cell.sz, nz)
</code></pre>

<hr>
<h2 id='initializeMovementData'>
Initialize a movement data list
</h2><span id='topic+initializeMovementData'></span>

<h3>Description</h3>

<p>This function sets up the movement data for use in other functions in
the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeMovementData(t.obs, x.obs, y.obs, z.obs=NULL, sig2obs=0.0,
sig2obs.z=NA, t.max=max(diff(t.obs), na.rm=TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initializeMovementData_+3A_t.obs">t.obs</code></td>
<td>
<p>A vector of times at which the animal locations were observed</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_x.obs">x.obs</code></td>
<td>
<p>A vector of x-coordinates at which the animal locations
were observed</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_y.obs">y.obs</code></td>
<td>
<p>A vector of y-coordinates at which the animal locations
were observed</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_z.obs">z.obs</code></td>
<td>
<p>A vector of z-coordinates at which the animal locations
were observed</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_sig2obs">sig2obs</code></td>
<td>
<p>Location error variance in the xy-dimensions</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_sig2obs.z">sig2obs.z</code></td>
<td>
<p>Location error variance in the z-dimension</p>
</td></tr>
<tr><td><code id="initializeMovementData_+3A_t.max">t.max</code></td>
<td>
<p>The maximum time allowed between locations if the
movement step is to be used in computing the density</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If only 2D or 2.5D MKDEs are to be calculated, then z.obs and sig2obs.z
do not have to be provided.
</p>


<h3>Value</h3>

<p>A move data object, in the form of a list, is returned.
</p>
<table>
<tr><td><code>dimension</code></td>
<td>
<p>The spatial dimension of the movement data.  If
z-coordinates are passed, the dimension will be 3; otherwise, the
dimension will be 2.</p>
</td></tr>
<tr><td><code>t.obs</code></td>
<td>
<p>Times of the animal locations.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>x-coordinates of the animal locations.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>y-coordinates of the animal locations.</p>
</td></tr>
<tr><td><code>z.obs</code></td>
<td>
<p>z-coordinates of the animal locations.</p>
</td></tr>
<tr><td><code>a.obs</code></td>
<td>
<p>Altitude of the animal; that is, its z-coordinate minus
the lower bound on the z-coordinate at the corresponding
xy-coordinates of the animal location.</p>
</td></tr>
<tr><td><code>use.obs</code></td>
<td>
<p>A logical array that indicates whether each location
should be used in the MKDE calculations.  By default these values
are set to TRUE.</p>
</td></tr>
<tr><td><code>t.max</code></td>
<td>
<p>The maximum time allowed between locations if the
movement step is to be used in computing the density</p>
</td></tr>
<tr><td><code>sig2xy</code></td>
<td>
<p>A vector of movemenet variance paramters for the
xy-dimensions, with NAs as placeholders.  The functions estVarMKDE
is provided to estimate these parameters, or they can be set
manually to allow for different movement variances for each move
step.</p>
</td></tr>
<tr><td><code>sig2z</code></td>
<td>
<p>A vector of movemenet variance paramters for the
z-dimension, with NAs as placeholders.  The functions estVarMKDE is
provided to estimate these parameters, or they can be set manually
to allow for different movement variances for each move step.</p>
</td></tr>
<tr><td><code>sig2obs</code></td>
<td>
<p>A vector of variances for the location observation
error in the xy-dimensions.  If only one value is provided for the
variance parameters, the value is repeated to form a vector with one
element for each location.  Otherwise, a vector of location error
variances can be passed to allow for different errors for each
observed location.</p>
</td></tr>
<tr><td><code>sig2obs.z</code></td>
<td>
<p>A vector of variances for the location observation
error in the z-dimension.  If only one value is provided for the
variance parameters, the value is repeated to form a vector with one
element for each location.  Otherwise, a vector of location error
variances can be passed to allow for different errors for each
observed location.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x,
condor$y, z.obs=condor$z, 65.0, 25.0, sig2obs.z=81.0)
</code></pre>

<hr>
<h2 id='mkde2Dgrid'>
Movement-based kernel density estimate (MKDE) in 2D using Rcpp
</h2><span id='topic+mkde2Dgrid'></span>

<h3>Description</h3>

<p>Provides a function for 2-dimensional MKDEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkde2Dgrid(mkde.obj, move.dat, t.step, d.thresh)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkde2Dgrid_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>A 2D or 2.5D MKDE object</p>
</td></tr>
<tr><td><code id="mkde2Dgrid_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object</p>
</td></tr>
<tr><td><code id="mkde2Dgrid_+3A_t.step">t.step</code></td>
<td>
<p>An integration time step</p>
</td></tr>
<tr><td><code id="mkde2Dgrid_+3A_d.thresh">d.thresh</code></td>
<td>
<p>A kernel density threshold</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is  lower-level function that call the C++ function. for
estimating the movement-based density in 2D.  In practice, users
should call <code>initializeDensity</code>. <br />
The argument d.thresh is a univariate probability density beyond which
the kernel contribution to the overall MKDE is assumed to be
negligible. Usually this is set at a very small value and is used to
prevent calculations from being performed in cells to which the kernel
makes a negligible contribution.
</p>


<h3>Value</h3>

<p>An array whose elements are the estimated utilization probabilities
for each cell.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Robert Sinkovits, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:sinkovit@sdsc.edu">sinkovit@sdsc.edu</a> <br />
Glenn Lockwood, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:glock@sdsc.edu">glock@sdsc.edu</a> <br />
Jun Zhu, PhD <br />
University of Wisconsin-Madison <br />
<a href="mailto:jzhu@stat.wisc.edu">jzhu@stat.wisc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(panda)

# Find min/max coordinates and add buffer
xmax = max(panda$x) + 100
xmin = min(panda$x) - 100
ymax = max(panda$y) + 100
ymin = min(panda$y) - 100

# Calculate grid dimensions
xrange &lt;- xmax - xmin
yrange &lt;- ymax - ymin
cell.sz = 30
nx &lt;- as.integer(xrange/cell.sz)
ny &lt;- as.integer(yrange/cell.sz)

mv.dat &lt;- initializeMovementData(panda$time, panda$x, panda$y, t.max=185.0, sig2obs=25.0)
if (all(is.na(mv.dat$sig2xy))) {
  mv.dat &lt;- estVarMKDE(mv.dat)
}

mkde.obj &lt;- initializeMKDE2D(xmin, cell.sz, nx, ymin, cell.sz, ny)
res &lt;- mkde2Dgrid(mkde.obj, mv.dat, 10.0, 1e-20)
</code></pre>

<hr>
<h2 id='mkde2Dinteraction'>
Probability of 2D spatial-temporal interaction.
</h2><span id='topic+mkde2Dinteraction'></span>

<h3>Description</h3>

<p>Probability of 2D spatial-temporal interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkde2Dinteraction(mkde.obj, move.dat0, move.dat1, t.step, d.thresh)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkde2Dinteraction_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize2DMKDE</code></p>
</td></tr>
<tr><td><code id="mkde2Dinteraction_+3A_move.dat0">move.dat0</code></td>
<td>
<p>A move data object for the first individual created
with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="mkde2Dinteraction_+3A_move.dat1">move.dat1</code></td>
<td>
<p>A move data object for the second individual created
with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="mkde2Dinteraction_+3A_t.step">t.step</code></td>
<td>
<p>A time step used for numerical integration
over the movement trajectory</p>
</td></tr>
<tr><td><code id="mkde2Dinteraction_+3A_d.thresh">d.thresh</code></td>
<td>
<p>The value of the kernel below which its contibrution
to the overal density is considered negligible</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that the two individual animals were observed at
the same times. The cell values returned in the mkde.obj can be summed 
to obtain a global measure of spatio-temporal interaction.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr><td><code>mkde.obj</code></td>
<td>
<p>An updated MKDE object containing the cell-level
Bhattacharyya coefficients</p>
</td></tr>
<tr><td><code>move.dat0</code></td>
<td>
<p>A move data object for the first individuals with
updated variance parameters</p>
</td></tr>
<tr><td><code>move.dat1</code></td>
<td>
<p>A move data object for the second individuals with
updated variance parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Jun Zhu, PhD <br />
University of Wisconsin-Madison <br />
<a href="mailto:jzhu@stat.wisc.edu">jzhu@stat.wisc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(panda)
mv.dat0 &lt;- initializeMovementData(panda$time, panda$x, panda$y, 
sig2obs=25.0, t.max=185.0)

n &lt;- nrow(panda)
v &lt;- 20.0 # increase from 0 to increase difference
mv.dat1 &lt;- initializeMovementData(panda$time, panda$x+rnorm(n, 0, v), 
panda$y+rnorm(n, 0, v), sig2obs=25.0, t.max=185.0)

data(pandadem)
cell.sz &lt;- mean(res(pandadem))
ext &lt;- extent(pandadem)
nx &lt;- ncol(pandadem)
ny &lt;- nrow(pandadem)
mkde.obj &lt;- initializeMKDE2D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny)

res &lt;- mkde2Dinteraction(mkde.obj, mv.dat0, mv.dat1, 10.0, 1e-20)
mkde.obj &lt;- res$mkde.obj
mv.dat0 &lt;- res$move.dat0
mv.dat1 &lt;- res$move.dat1
</code></pre>

<hr>
<h2 id='mkde3Dgrid'>
Movement-based kernel density estimate (MKDE) in 3D using Rcpp
</h2><span id='topic+mkde3Dgrid'></span>

<h3>Description</h3>

<p>Provides a function for 3-dimensional MKDEs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkde3Dgrid(mkde.obj, move.dat, t.step, d.thresh)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkde3Dgrid_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>A 3D MKDE object</p>
</td></tr>
<tr><td><code id="mkde3Dgrid_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object</p>
</td></tr>
<tr><td><code id="mkde3Dgrid_+3A_t.step">t.step</code></td>
<td>
<p>An integration time step</p>
</td></tr>
<tr><td><code id="mkde3Dgrid_+3A_d.thresh">d.thresh</code></td>
<td>
<p>A kernel density threshold</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is  lower-level function that call the C++ function. for
estimating the movement-based density in 3D.  In practice, users
should call <code>initializeDensity</code>. <br />
The argument <code>d.thresh</code> is a univariate probability density beyond which
the kernel contribution to the overall MKDE is assumed to be
negligible. Usually this is set at a very small value and is used to
prevent calculations from being performed in cells to which the kernel
makes a negligible contribution.
</p>


<h3>Value</h3>

<p>An array whose elements are the estimated utilization probabilities
for each voxel.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Robert Sinkovits, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:sinkovit@sdsc.edu">sinkovit@sdsc.edu</a> <br />
Glenn Lockwood, PhD <br />
San Diego Supercomputer Center <br />
<a href="mailto:glock@sdsc.edu">glock@sdsc.edu</a> <br />
Jun Zhu, PhD <br />
University of Wisconsin-Madison <br />
<a href="mailto:jzhu@stat.wisc.edu">jzhu@stat.wisc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)

# Find min/max coordinates and add buffer
xmax = max(condor$x) + 1000
xmin = min(condor$x) - 1000
ymax = max(condor$y) + 1000
ymin = min(condor$y) - 1000

# Calculate grid dimensions
xrange &lt;- xmax - xmin
yrange &lt;- ymax - ymin
cell.sz = 600
nx &lt;- as.integer(xrange/cell.sz)
ny &lt;- as.integer(yrange/cell.sz)
nz &lt;- ceiling(3000.0/cell.sz)

mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, z.obs=condor$z, t.max=185.0,
sig2obs=25.0, sig2obs.z=81.0)
if (all(is.na(mv.dat$sig2xy))) {
  mv.dat &lt;- estVarMKDE(mv.dat)
}

mkde.obj &lt;- initializeMKDE3D(xmin, cell.sz, nx, ymin, cell.sz, ny, 0.0, cell.sz, nz)
res &lt;- mkde3Dgrid(mkde.obj, mv.dat, 5.0, 1e-20)
</code></pre>

<hr>
<h2 id='mkde3Dinteraction'>
Probability of 3D spatial-temporal interaction.
</h2><span id='topic+mkde3Dinteraction'></span>

<h3>Description</h3>

<p>Metric of 3D spatial-temporal interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkde3Dinteraction(mkde.obj, move.dat0, move.dat1, t.step, d.thresh)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkde3Dinteraction_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize3DMKDE</code></p>
</td></tr>
<tr><td><code id="mkde3Dinteraction_+3A_move.dat0">move.dat0</code></td>
<td>
<p>A move data object for the first individual created
with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="mkde3Dinteraction_+3A_move.dat1">move.dat1</code></td>
<td>
<p>A move data object for the second individual created
with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="mkde3Dinteraction_+3A_t.step">t.step</code></td>
<td>
<p>A time step used for numerical integration
over the movement trajectory</p>
</td></tr>
<tr><td><code id="mkde3Dinteraction_+3A_d.thresh">d.thresh</code></td>
<td>
<p>The value of the kernel below which its contibrution
to the overal density is considered negligible</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that the two individual animals were observed at
the same times. The voxel values returned in the mkde.obj can be summed 
to obtain a global measure of spatio-temporal interaction.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:
</p>
<table>
<tr><td><code>mkde.obj</code></td>
<td>
<p>An updated MKDE object containing the voxel-level
Bhattacharyya coefficients</p>
</td></tr>
<tr><td><code>move.dat0</code></td>
<td>
<p>A move data object for the first individuals with
updated variance parameters</p>
</td></tr>
<tr><td><code>move.dat1</code></td>
<td>
<p>A move data object for the second individuals with
updated variance parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Jun Zhu, PhD <br />
University of Wisconsin-Madison <br />
<a href="mailto:jzhu@stat.wisc.edu">jzhu@stat.wisc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:4,] # simply to make example run more quickly
mv.dat0 &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)
n &lt;- nrow(condor)
v &lt;- 20.0 # increase from 0 to increase difference between move trajectories
vz &lt;- 5.0
mv.dat1 &lt;- initializeMovementData(condor$time, condor$x+rnorm(n, 0, v), 
condor$y+rnorm(n, 0, v), z.obs=condor$z+rnorm(n, 0, vz), sig2obs=25.0, 
sig2obs.z=81.0, t.max=65.0)

data(condordem120)
# next two lines reduce extent of 2D space to speed execution of example
tmp &lt;- extent(c(range(condor$x) + c(-100, 100), range(condor$y) + c(-100, 100)))
condordem120 &lt;- crop(condordem120, tmp)
cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
nz &lt;- ceiling(3000.0/cell.sz)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, 0.0, cell.sz, nz)

res &lt;- mkde3Dinteraction(mkde.obj, mv.dat0, mv.dat1, 10.0, 1e-20)
mkde.obj &lt;- res$mkde.obj
mv.dat0 &lt;- res$move.dat0
mv.dat1 &lt;- res$move.dat1
</code></pre>

<hr>
<h2 id='mkdeToRaster'>
MKDE to RasterLayer or RasterStack
</h2><span id='topic+mkdeToRaster'></span>

<h3>Description</h3>

<p>Converts an MKDE into a RasterLayer or RasterStack so that raster
package functions can be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkdeToRaster(mkde.obj)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mkdeToRaster_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>A 2D, 2.5D, or 3D MKDE object created with
<code>initialize2DMKDE</code> or <code>initialize3DMKDE</code> and density
initialized with <code>initializeDensity</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method converts the density array in the MKDE oject to an object
of a class from the raster package.  This allows the functions in the
raster package to be used with the MKDEs.
</p>


<h3>Value</h3>

<p>If the MKDE is 2D or 2.5D, a RasterLayer object is returned.  If the
MKDE is 3D, a RasterStack is returned with one layer in the stack per
level.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
# set up MKDE object
data(pandadem)
cell.sz &lt;- mean(res(pandadem))
ext &lt;- extent(pandadem)
nx &lt;- ncol(pandadem)
ny &lt;- nrow(pandadem)
mkde.obj &lt;- initializeMKDE2D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz, ny)

# set up movement data
data(panda)
mv.dat &lt;- initializeMovementData(panda$time, panda$x, panda$y, 
sig2obs=25.0, t.max=185.0)

# estimate density
dens.res &lt;- initializeDensity(mkde.obj, mv.dat)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat
mkde.rst &lt;- mkdeToRaster(mkde.obj)
plot(mkde.rst)
</code></pre>

<hr>
<h2 id='panda'>
Giant panda locations
</h2><span id='topic+panda'></span>

<h3>Description</h3>

<p>A data frame containing giant panda location data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(panda)</code></pre>


<h3>Format</h3>

<p>A data frame with 147 observations on the following 4 variables.
</p>

<dl>
<dt><code>time</code></dt><dd><p>Elapsed time in minutes</p>
</dd>
<dt><code>x</code></dt><dd><p>x-coordinate (UTM easting in meters)</p>
</dd>
<dt><code>y</code></dt><dd><p>y-coordinate (UTM northing in meters)</p>
</dd>
<dt><code>z</code></dt><dd><p>z-coordinate (height above sea level in meters)</p>
</dd>
</dl>



<h3>Details</h3>

<p>GPS location data acquired from a wild giant panda (Ailuropoda
melanoleuca) tracked by the Chinese Academy of Sciences and San Diego
Zoo Global in Foping National Nature Reserve, China during August 2008
(Zhang et. al. 2012).
</p>


<h3>Source</h3>

<p>Giant panda (Ailuropoda melanoleuca) biotelemetry data was collected by
Fuwen Wei and others of the Key Laboratory of Animal Ecology and
Conservation Biology, Institute of Zoology, Chinese Academy of Science,
People's Republic of China in collaboration with the San Diego Zoo
Institute for Conservation Research. Giant panda research was funded by
the National Natural Science Foundation of China (31230011), Wildlife
Experimental Platform of Chinese Academy of Sciences, and San Diego Zoo
Global.
</p>


<h3>References</h3>

<p>Zhang, Z., Sheppard, J.K., Swaisgood, R.R., Wang, G., Nie, Y., Wei, W., Zhao, N. &amp; Wei, F. (2014). Ecological Scale and Seasonal Heterogeneity in the Spatial Behaviors of Giant Pandas. Integrative Zoology, 9: 46-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(panda)
head(panda, 30)
</code></pre>

<hr>
<h2 id='pandadem'>
A RasterLayer containing a digital elevation model (DEM) for the panda data
</h2><span id='topic+pandadem'></span>

<h3>Description</h3>

<p>Digital elevation model of the terrain within the panda's range with a cell resolution of 30 meters (ASTER GDEM version 2, Tachikawa et. al. 2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pandadem)</code></pre>


<h3>Format</h3>

<p>A raster package RasterLayer object with 58 rows, 78 columns, and
a cell size of 30 by 30 meters. Each cell contains an elevation in meters.
</p>


<h3>Source</h3>

<p>URL: http://asterweb.jpl.nasa.gov/gdem.asp
</p>


<h3>References</h3>

<p>Tachikawa, T., Hato, M., Kaku, M. &amp; Iwasaki, A. (2011). The characteristics of ASTER GDEM version 2, IGARSS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(pandadem)
plot(pandadem)
</code></pre>

<hr>
<h2 id='plotMKDE'>
Make an image plot of an MKDE.
</h2><span id='topic+plotMKDE'></span>

<h3>Description</h3>

<p>Makes an image plot of an MKDE.  If the MKDE is 3D, the contours will be
based on the entire MKDE, but only one level indexed by z.index will be
plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMKDE(mkde.obj, z.index=1, probs=c(0.99, 0.95, 0.90, 0.75, 0.5, 0.0),
cmap=rev(rainbow(length(probs)-1)), add=FALSE, ...)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMKDE_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>A 2D, 2.5D, or 3D MKDE object created with
<code>initialize2DMKDE</code> or <code>initialize3DMKDE</code> and density
initialized with <code>initializeDensity</code></p>
</td></tr>
<tr><td><code id="plotMKDE_+3A_z.index">z.index</code></td>
<td>
<p>Index for the z-dimension of the density if a 3D MKDE</p>
</td></tr>
<tr><td><code id="plotMKDE_+3A_probs">probs</code></td>
<td>
<p>Probabilities for image contours.</p>
</td></tr>
<tr><td><code id="plotMKDE_+3A_cmap">cmap</code></td>
<td>
<p>Color map for image plot.</p>
</td></tr>
<tr><td><code id="plotMKDE_+3A_add">add</code></td>
<td>
<p>FALSE to make a new plot, TRUE to add to existing plot</p>
</td></tr>
<tr><td><code id="plotMKDE_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot of the density for the specified level in the z-dimension (which
should be 1, the defaul value, for a 2D or 2.5D MKDE) is generated.
</p>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(pandadem)
cell.sz &lt;- 0.25*mean(res(pandadem))
ext &lt;- extent(pandadem)
nx &lt;- 4*ncol(pandadem)
ny &lt;- 4*nrow(pandadem)
mkde.obj &lt;- initializeMKDE2D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny)

# set up movement data
data(panda)
mv.dat &lt;- initializeMovementData(panda$time, panda$x, panda$y, 
sig2obs=25.0, t.max=185.0)

# estimate density
dens.res &lt;- initializeDensity(mkde.obj, mv.dat)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat
plotMKDE(mkde.obj)
</code></pre>

<hr>
<h2 id='setMaximumZfromConstant'>
Initialize maximum allowable z-axis coordinates to a constant value.
</h2><span id='topic+setMaximumZfromConstant'></span>

<h3>Description</h3>

<p>Set the upper bounds in the z-dimension for each location in the x and y
dimensions to a constant value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setMaximumZfromConstant(mkde.obj, val)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setMaximumZfromConstant_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p> 2D or 3D MKDE object created with
<code>initialize3DMKDE</code> or <code>initialize3DMKDE</code>, respectively</p>
</td></tr>
<tr><td><code id="setMaximumZfromConstant_+3A_val">val</code></td>
<td>
<p>The value at which the upper bound should be set for all
locations in the x and y dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obviously, the upper bound must be greater than the lower bound.
</p>


<h3>Value</h3>

<p>An updated MKDE list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(dugongdem)
cell.sz &lt;- mean(res(dugongdem))
ext &lt;- extent(dugongdem)
nx &lt;- ncol(dugongdem)
ny &lt;- nrow(dugongdem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(dugongdem), na.rm=TRUE), 50.0, 15)
mkde.obj &lt;- setMaximumZfromConstant(mkde.obj, 100.0)
</code></pre>

<hr>
<h2 id='setMaximumZfromRaster'>
Initialize maximum z-axis value from a raster
</h2><span id='topic+setMaximumZfromRaster'></span>

<h3>Description</h3>

<p>Set the upper bounds in the z-dimension for each location in the x and y
dimensions from a raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setMaximumZfromRaster(mkde.obj, raster.layer)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setMaximumZfromRaster_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>2D or 3D MKDE object created with
<code>initialize3DMKDE</code> or <code>initialize3DMKDE</code>, respectively</p>
</td></tr>
<tr><td><code id="setMaximumZfromRaster_+3A_raster.layer">raster.layer</code></td>
<td>
<p>A RasterLayer object representing the lower bounds
of the space the animal may occupy in the z-dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets the upper bounds of the space the animal may occupy
in the z-dimension. For example, the <code>ascii.raster.filez</code> argument
may represent a raster for elevation for subterranean animals, or
other surface.
</p>


<h3>Value</h3>

<p>An updated MKDE list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(dugongdem)
cell.sz &lt;- mean(res(dugongdem))
ext &lt;- extent(dugongdem)
nx &lt;- ncol(dugongdem)
ny &lt;- nrow(dugongdem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(dugongdem), na.rm=TRUE), 50.0, 15)
mkde.obj &lt;- setMaximumZfromRaster(mkde.obj, dugongdem)
</code></pre>

<hr>
<h2 id='setMinimumZfromConstant'>
Set minimum z-axis value to a constant.
</h2><span id='topic+setMinimumZfromConstant'></span>

<h3>Description</h3>

<p>Set the lower bounds in the z-dimension for each location in the x and y
dimensions to a constant value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setMinimumZfromConstant(mkde.obj, val)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setMinimumZfromConstant_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p> 2D or 3D MKDE object created with
<code>initialize3DMKDE</code> or <code>initialize3DMKDE</code>, respectively</p>
</td></tr>
<tr><td><code id="setMinimumZfromConstant_+3A_val">val</code></td>
<td>
<p>The value at which the lower bound should be set for all
locations in the x and y dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obviously, the lower bound must be less than the upper bound.
</p>


<h3>Value</h3>

<p>An updated MKDE list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(dugongdem)
cell.sz &lt;- mean(res(dugongdem))
ext &lt;- extent(dugongdem)
nx &lt;- ncol(dugongdem)
ny &lt;- nrow(dugongdem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(dugongdem), na.rm=TRUE), 50.0, 15)
mkde.obj &lt;- setMinimumZfromConstant(mkde.obj, -20.0)
</code></pre>

<hr>
<h2 id='setMinimumZfromRaster'>
Set minimum z-axis values from a raster
</h2><span id='topic+setMinimumZfromRaster'></span>

<h3>Description</h3>

<p>Set the lower bounds in the z-dimension for each location in the x and y
dimensions from a raster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setMinimumZfromRaster(mkde.obj, raster.layer)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setMinimumZfromRaster_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>A 2D or 3D MKDE object created with
<code>initialize3DMKDE</code> or <code>initialize3DMKDE</code>, respectively</p>
</td></tr>
<tr><td><code id="setMinimumZfromRaster_+3A_raster.layer">raster.layer</code></td>
<td>
<p>A RasterLayer object representing the lower bounds
of the space the animal may occupy in the z-dimension.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets the lower bounds of the space the animal may occupy
in the z-dimension. For example, the <code>ascii.raster.file</code> argument
may represent a raster for elevation, depth of the sea floor, or other
surface.
</p>


<h3>Value</h3>

<p>An updated MKDE list object is returned.
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(dugongdem)
cell.sz &lt;- mean(res(dugongdem))
ext &lt;- extent(dugongdem)
nx &lt;- ncol(dugongdem)
ny &lt;- nrow(dugongdem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(dugongdem), na.rm=TRUE), 50.0, 15)
mkde.obj &lt;- setMinimumZfromRaster(mkde.obj, dugongdem-20.0)
</code></pre>

<hr>
<h2 id='writeInterpolatedPathVTK'>
Write path to VTK.
</h2><span id='topic+writeInterpolatedPathVTK'></span>

<h3>Description</h3>

<p>Write the interpolated move path to a VTK file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeInterpolatedPathVTK(move.dat, mkde.obj, description, filename, control)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeInterpolatedPathVTK_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="writeInterpolatedPathVTK_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize3DMKDE</code></p>
</td></tr>
<tr><td><code id="writeInterpolatedPathVTK_+3A_description">description</code></td>
<td>
<p>A text description for the file header</p>
</td></tr>
<tr><td><code id="writeInterpolatedPathVTK_+3A_filename">filename</code></td>
<td>
<p>A string for the path and file name</p>
</td></tr>
<tr><td><code id="writeInterpolatedPathVTK_+3A_control">control</code></td>
<td>
<p>A list for finer control</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writes 3D lines between observed locations for move steps. Move steps
where the initial location i has a value of FALSE for
<code>move.dat$use.obs[i]</code> are omitted. Currently, the list argument control
only has three elements: (1) &ldquo;method&rdquo; with a default value of
&ldquo;linear&rdquo;, (2) method.par which is a list of method parameters, and (3)
z.scale used to scale the z-coordinates. Only the <code>z.scale</code> should be set
by the user at this time.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem)
cell.sz &lt;- mean(res(condordem))
ext &lt;- extent(condordem)
nx &lt;- ncol(condordem)
ny &lt;- nrow(condordem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem), na.rm=TRUE), 30.0, 100)

writeInterpolatedPathVTK(mv.dat, mkde.obj,
"Example California condor move steps", "condor_path.vtk")

# Clean up files
unlink("condor_path.vtk")
</code></pre>

<hr>
<h2 id='writeObservedLocationVTK'>
Write observed locations to VTK.
</h2><span id='topic+writeObservedLocationVTK'></span>

<h3>Description</h3>

<p>Write the observed points to a VTK file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeObservedLocationVTK(move.dat, mkde.obj, description, filename, control)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeObservedLocationVTK_+3A_move.dat">move.dat</code></td>
<td>
<p>A move data object created with <code>initializeMovementData</code></p>
</td></tr>
<tr><td><code id="writeObservedLocationVTK_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>An MKDE object created with <code>initialize3DMKDE</code></p>
</td></tr>
<tr><td><code id="writeObservedLocationVTK_+3A_description">description</code></td>
<td>
<p>A text description for the file header</p>
</td></tr>
<tr><td><code id="writeObservedLocationVTK_+3A_filename">filename</code></td>
<td>
<p>A string for the path and file name</p>
</td></tr>
<tr><td><code id="writeObservedLocationVTK_+3A_control">control</code></td>
<td>
<p>A list for finer control</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Writes 3D points for observed locations for move steps. Currently, the
list argument control only has one element <code>z.scale</code> used to scale the
z-coordinates.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem)
cell.sz &lt;- mean(res(condordem))
ext &lt;- extent(condordem)
nx &lt;- ncol(condordem)
ny &lt;- nrow(condordem)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem), na.rm=TRUE), 30.0, 100)

writeObservedLocationVTK(mv.dat, mkde.obj,
"Example California condor locations", "condor_locations.vtk")

# Clean up files
unlink("condor_locations.vtk")
</code></pre>

<hr>
<h2 id='writeRasterToVTK'>
Write a 2D raster to XDMF XML wrapper and binary data file.
</h2><span id='topic+writeRasterToVTK'></span>

<h3>Description</h3>

<p>Write the raster to a XDMF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeRasterToVTK(elev, r.rst, g.rst, b.rst, descr, fname)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeRasterToVTK_+3A_elev">elev</code></td>
<td>
<p>A RasterLayer object</p>
</td></tr>
<tr><td><code id="writeRasterToVTK_+3A_r.rst">r.rst</code></td>
<td>
<p>A RasterLayer object for red</p>
</td></tr>
<tr><td><code id="writeRasterToVTK_+3A_g.rst">g.rst</code></td>
<td>
<p>A RasterLayer object for green</p>
</td></tr>
<tr><td><code id="writeRasterToVTK_+3A_b.rst">b.rst</code></td>
<td>
<p>A RasterLayer object for blue</p>
</td></tr>
<tr><td><code id="writeRasterToVTK_+3A_descr">descr</code></td>
<td>
<p>String description to be added to header of VTK file</p>
</td></tr>
<tr><td><code id="writeRasterToVTK_+3A_fname">fname</code></td>
<td>
<p>The path and base file name for output HDF5 files</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes a raster to VTK format. The raster is colored
according to the RGB values in <code>r.rst</code>, <code>g.rst</code>, and
<code>b.rst</code>, respectively. The RGB balues must be an interger from 0
to 255.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Amit Chourasia, MS <br />
San Diego Supercomputer Center <br />
<a href="mailto:amit@sdsc.edu">amit@sdsc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem120)
elev.val &lt;- values(condordem120)
elev.min &lt;- min(elev.val, na.rm=TRUE)
elev.max &lt;- max(elev.val, na.rm=TRUE)

# make a color lookup table
cmap &lt;- data.frame(value=c(0.0, 0.25, 0.5, 0.75, 1.0), 
  R=c(150, 179, 205, 192, 252), 
  G=c(224, 204, 205, 183, 243), 
  B=c(94, 147, 168, 147, 226))
                    
cmap$value &lt;- cmap$value*(elev.max - elev.min) + elev.min
# red
f.R &lt;- approxfun(cmap$value, cmap$R)
elev.r &lt;- raster(condordem120)
values(elev.r) &lt;- round(f.R(elev.val))
# green
f.G &lt;- approxfun(cmap$value, cmap$G)
elev.g &lt;- raster(condordem120)
values(elev.g) &lt;- round(f.G(elev.val))
# blue
f.B &lt;- approxfun(cmap$value, cmap$B)
elev.b &lt;- raster(condordem120)
values(elev.b) &lt;- round(f.B(elev.val))
writeRasterToVTK(condordem120, elev.r, elev.g, elev.b, "Elevation for
California condor Example", "condor_dem.vtk")

# Clean up files
unlink("condor_dem.vtk")
</code></pre>

<hr>
<h2 id='writeRasterToXDMF'>
Write a 2D raster to XDMF XML wrapper and binary data file.
</h2><span id='topic+writeRasterToXDMF'></span>

<h3>Description</h3>

<p>Write the raster to a XDMF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeRasterToXDMF(rast, fname, nodat="NA")	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeRasterToXDMF_+3A_rast">rast</code></td>
<td>
<p>A RasterLayer object</p>
</td></tr>
<tr><td><code id="writeRasterToXDMF_+3A_fname">fname</code></td>
<td>
<p>The path and base file name for output HDF5 files</p>
</td></tr>
<tr><td><code id="writeRasterToXDMF_+3A_nodat">nodat</code></td>
<td>
<p>A no data character string that will be written in place
of no data values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes XDMF XML wrapper and binary data file.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Amit Chourasia, MS <br />
San Diego Supercomputer Center <br />
<a href="mailto:amit@sdsc.edu">amit@sdsc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condordem)
# Save as XDMF (notice no file extension in file name)
writeRasterToXDMF(condordem, "condor_dem")

# Clean up files
unlink("condor_dem.dat")
unlink("condor_dem.xdmf")
</code></pre>

<hr>
<h2 id='writeToGRASS'>
Write MKDE to a GRASS GIS 3D ASCII raster file.
</h2><span id='topic+writeToGRASS'></span>

<h3>Description</h3>

<p>Write the MKDE to a VTK file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeToGRASS(mkde.obj, fname, nodat="NA", cumprob=FALSE)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeToGRASS_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>3D MKDE object created with <code>initialize3DMKDE</code>
and density initialized with <code>initializeDensity</code></p>
</td></tr>
<tr><td><code id="writeToGRASS_+3A_fname">fname</code></td>
<td>
<p>The patch and file name for output VTK file</p>
</td></tr>
<tr><td><code id="writeToGRASS_+3A_nodat">nodat</code></td>
<td>
<p>A no data character string that will be written in place
of no data values.</p>
</td></tr>
<tr><td><code id="writeToGRASS_+3A_cumprob">cumprob</code></td>
<td>
<p>Indicate whether to write the voxel probabilities of
cumulative probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes a GRASS GIS ASCII raster file that can be
imported using the <code>r3.in.ascii</code> function.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:20,] # simply to make example run more quickly
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem120)
cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem120), na.rm=TRUE), cell.sz, 25)

# note: we use a raster coarse integration time step so the
# example runs faster
dens.res &lt;- initializeDensity(mkde.obj, mv.dat, integration.step=10.0)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat

# Write file
writeToGRASS(mkde.obj, "ascii3d.txt")

# Clean up files
unlink("ascii3d.txt")
</code></pre>

<hr>
<h2 id='writeToVTK'>
Write MKDE to an ASCII Visualization Tool Kit (VTK) structured grid file.
</h2><span id='topic+writeToVTK'></span>

<h3>Description</h3>

<p>Write the MKDE to a VTK file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeToVTK(mkde.obj, fname, description="3D MKDE", cumprob=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeToVTK_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>3D MKDE object created with <code>initialize3DMKDE</code> and
density initialized with <code>initializeDensity</code></p>
</td></tr>
<tr><td><code id="writeToVTK_+3A_fname">fname</code></td>
<td>
<p>The patch and file name for output VTK file</p>
</td></tr>
<tr><td><code id="writeToVTK_+3A_description">description</code></td>
<td>
<p>A character string with a brief description that
will be placed in the header of the VTK file</p>
</td></tr>
<tr><td><code id="writeToVTK_+3A_cumprob">cumprob</code></td>
<td>
<p>Indicate whether to write the voxel probabilities of
cumulative probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes a VTK structured grid file for a 3D MKDE that can
be used in 3D visualization tools such as MayaVI or ParaView
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:20,] # simply to make example run more quickly
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem120)
# next two lines reduce extent of 2D space to speed execution of example
tmp &lt;- extent(c(range(condor$x) + c(-100, 100), range(condor$y) + c(-100, 100)))
condordem120 &lt;- crop(condordem120, tmp)

cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem120), na.rm=TRUE), cell.sz, 25)

# note: we use a raster coarse integration time step so the
# example runs faster
dens.res &lt;- initializeDensity(mkde.obj, mv.dat, integration.step=10.0)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat

# Save as VTK file
writeToVTK(mkde.obj, "condor_3dMKDE.vtk",
description="Example California condor 3D MKDE")

# Clean up files
unlink("condor_3dMKDE.vtk")
</code></pre>

<hr>
<h2 id='writeToXDMF'>
Write 3D MKDE to XDMF XML wrapper and binary data file.
</h2><span id='topic+writeToXDMF'></span>

<h3>Description</h3>

<p>Write the MKDE to a XDMF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeToXDMF(mkde.obj, fname, nodat="NA", cumprob=FALSE)	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeToXDMF_+3A_mkde.obj">mkde.obj</code></td>
<td>
<p>3D MKDE object created with <code>initialize3DMKDE</code>
and density initialized with <code>initializeDensity</code></p>
</td></tr>
<tr><td><code id="writeToXDMF_+3A_fname">fname</code></td>
<td>
<p>The path and base file name for output XDMF files</p>
</td></tr>
<tr><td><code id="writeToXDMF_+3A_nodat">nodat</code></td>
<td>
<p>A no data character string that will be written in place
of no data values.</p>
</td></tr>
<tr><td><code id="writeToXDMF_+3A_cumprob">cumprob</code></td>
<td>
<p>Indicate whether to write the voxel probabilities of
cumulative probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function writes XDMF XML wrapper and binary data file.
</p>


<h3>Value</h3>

<p>No value is returned
</p>


<h3>Author(s)</h3>

<p>Jeff A. Tracey, PhD <br />
USGS Western Ecological Research Center, San Diego Field Station <br />
<a href="mailto:jatracey@usgs.gov">jatracey@usgs.gov</a>  <br />
James Sheppard, PhD <br />
San Diego Zoo Institute for Conservation Research <br />
<a href="mailto:jsheppard@sandiegozoo.org">jsheppard@sandiegozoo.org</a> <br />
Amit Chourasia, MS <br />
San Diego Supercomputer Center <br />
<a href="mailto:amit@sdsc.edu">amit@sdsc.edu</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)
data(condor)
condor &lt;- condor[1:20,] # simply to make example run more quickly
mv.dat &lt;- initializeMovementData(condor$time, condor$x, condor$y, 
z.obs=condor$z, sig2obs=25.0, sig2obs.z=81.0, t.max=65.0)

data(condordem120)
cell.sz &lt;- mean(res(condordem120))
ext &lt;- extent(condordem120)
nx &lt;- ncol(condordem120)
ny &lt;- nrow(condordem120)
mkde.obj &lt;- initializeMKDE3D(ext@xmin, cell.sz, nx, ext@ymin, cell.sz,
ny, min(values(condordem120), na.rm=TRUE), cell.sz, 25)

# note: we use a raster coarse integration time step so the
# example runs faster
dens.res &lt;- initializeDensity(mkde.obj, mv.dat, integration.step=10.0)
mkde.obj &lt;- dens.res$mkde.obj
mv.dat &lt;- dens.res$move.dat

# Write file (note no file extension!)
writeToXDMF(mkde.obj, "condor_3dMKDE")

# Clean up files
unlink("condor_3dMKDE.dat")
unlink("condor_3dMKDE.xdmf")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
