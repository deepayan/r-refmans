<!DOCTYPE html><html lang="en"><head><title>Help for package jointPm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jointPm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#jointPm-package'>
<p>Risk estimation using the joint probability method ('jointPm')</p></a></li>
<li><a href='#binteg'><p>bivariate integration</p></a></li>
<li><a href='#flood'><p>Example data of flood levels and dependence strength between extreme rainfall and extreme storm tides from a coastal catchment</p></a></li>
<li><a href='#Glog'><p>Cumulative distribution function of bivariate logistic model</p></a></li>
<li><a href='#Gneglog'><p>Cumulative distribution function of bivariate negative logistic model</p></a></li>
<li><a href='#plot1'><p>shows the bivariate intergration</p></a></li>
<li><a href='#plot2'><p>a plot showing response variable levels versus return probabilities (ARI/AEP)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Risk Estimation Using the Joint Probability Method</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate risk caused by two extreme and dependent forcing variables using bivariate extreme value models as described in Zheng, Westra, and Sisson (2013) &lt;<a href="https://doi.org/10.1016%2Fj.jhydrol.2013.09.054">doi:10.1016/j.jhydrol.2013.09.054</a>&gt;; Zheng, Westra and Leonard (2014) &lt;<a href="https://doi.org/10.1002%2F2013WR014616">doi:10.1002/2013WR014616</a>&gt;; Zheng, Leonard and Westra (2015) &lt;<a href="https://doi.org/10.2166%2Fhydro.2015.052">doi:10.2166/hydro.2015.052</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lbelzile/jointPm/issues/">https://github.com/lbelzile/jointPm/issues/</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-22 17:38:19 UTC; lbelzile</td>
</tr>
<tr>
<td>Author:</td>
<td>Leo Belzile <a href="https://orcid.org/0000-0002-9135-014X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre],
  Feifei Zheng <a href="https://orcid.org/0000-0003-3048-7086"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Michael Leonard <a href="https://orcid.org/0000-0002-9519-3188"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Seth Westra <a href="https://orcid.org/0000-0003-4023-6061"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leo Belzile &lt;belzilel@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-22 22:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='jointPm-package'>
Risk estimation using the joint probability method ('jointPm')
</h2><span id='topic+jointPm-package'></span><span id='topic+jointPm'></span>

<h3>Description</h3>

<p>The overall impact of climate and weather related events such as flooding, wildfires and cyclones is determined by the interaction of many processes acting together.
For example, coastal floods may be caused by coincident extreme rainfall and extreme storm tides, floods in confluence regions may depend on simultaneously large flows
from two or more tributaries. It is challenging to perform the joint probability analysis of flood risk with multiple forcing variables, because the return period of forcing processes is not
directly equivalent to the return period of floods. This package uses a bivariate integration approach to efficiently estimate risk by accounting for two forcing variables at extreme levels.
</p>


<h3>Author(s)</h3>

<p>Feifei Zheng    <a href="mailto:feifeizheng@zju.edu.cn">feifeizheng@zju.edu.cn</a>,
Michael Leonard <a href="mailto:michael.leonard@adelaide.edu.au">michael.leonard@adelaide.edu.au</a>,
Seth Westra     <a href="mailto:seth.westra@adelaide.edu.au">seth.westra@adelaide.edu.au</a>
</p>


<h3>References</h3>

<p>Zheng, F., S. Westra, and S. A. Sisson (2013), Quantifying the dependence between extreme rainfall and storm surge in the coastal zone, <em>Journal of Hydrology</em>, 505(<b>15</b>), 172–187, <a href="https://doi.org/10.1016/j.jhydrol.2013.09.054">doi:10.1016/j.jhydrol.2013.09.054</a>.
</p>
<p>Zheng, F., Westra S. Sisson S. and Leonard M. (2014). Modelling dependence between extreme rainfall and storm surge to estimate coastal flood risk, <em>Water Resources Research</em>, 50, pp. 2050–2071,<a href="https://doi.org/10.1002/2013WR014616">doi:10.1002/2013WR014616</a>
</p>
<p>Zheng, F., Leonard M. and Westra S. (2015). Efficient joint probability analysis of flood risk, <em>Journal of Hydroinformatics</em>, 17(4), pp. 584–597, <a href="https://doi.org/10.2166/hydro.2015.052">doi:10.2166/hydro.2015.052</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(jointPm)
 data(flood)
 px = flood$px;
 py = flood$py;
 z = flood$flood_table;
 prm = flood$prm;
 pout = flood$pout
 binteg(px, py, z, prm, pout,
    model = "log", prob = "ARI",
    nz = 100, ninc = 1000)
</code></pre>

<hr>
<h2 id='binteg'>bivariate integration</h2><span id='topic+binteg'></span>

<h3>Description</h3>

<p>An efficient approach for bivariate integration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binteg(px,py,z,prm,pout,model="log",prob="AEP",nz=100,ninc=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binteg_+3A_px">px</code></td>
<td>
<p>are marginal probabilities (ARIs/AEPs) of X forcing variable associated with rows of z (e.g. rainfall).</p>
</td></tr>
<tr><td><code id="binteg_+3A_py">py</code></td>
<td>
<p>are marginal probabilities (ARIs/AEPs) of Y forcing variable associated with columns of z (e.g. storm tides).</p>
</td></tr>
<tr><td><code id="binteg_+3A_z">z</code></td>
<td>
<p>is a table of response variable values (e.g., flood levels) for each (x,y) combination.</p>
</td></tr>
<tr><td><code id="binteg_+3A_prm">prm</code></td>
<td>
<p>is the parameter for the model being used.</p>
</td></tr>
<tr><td><code id="binteg_+3A_pout">pout</code></td>
<td>
<p>are probabilities (ARIs/AEPs) for which output response variable levels are desired</p>
</td></tr>
<tr><td><code id="binteg_+3A_model">model</code></td>
<td>
<p>is the model used, either logistic model (&quot;log&quot;, default) or negative logsitic model (&quot;neglog&quot;).</p>
</td></tr>
<tr><td><code id="binteg_+3A_prob">prob</code></td>
<td>
<p>is the manner in which probabilities are specified, either ARI (annual recurrence interval) or annual exceed probability (AEP). See Details</p>
</td></tr>
<tr><td><code id="binteg_+3A_nz">nz</code></td>
<td>
<p>is the number of response variable contours to be considered across the range of z table.</p>
</td></tr>
<tr><td><code id="binteg_+3A_ninc">ninc</code></td>
<td>
<p>is the number of integration increments for each piecewise section of response variable contour lines.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package is illustrated for the example of coastal flood levels (the response variable) forced by extreme rainfall (x) and extreme storm tides (y). 
For this problem, the low bounds of the marginal distributions, i.e. no rainfall (x) and a suitable tide level (such as mean sea level or the lowest astronomical tide) are denoted as ARI=0/AEP=1. 
&quot;binteg&quot; estimates the flood risk allows for joint dependence between the extreme values of two forcing variables (rainfall and storm tides). 
Here the logistic and negative logistic model are used to model dependence due to their simplicity and great ability (see Zheng et al. 2014a). 
The results from &quot;binteg&quot; also include estimates for the cases of complete dependence (alpha=0) and independence (alpha=1) to enable a comparison with the observed dependence strength.
</p>
<p>An issue in the use of the proposed integral method is when the response variable table (e.g.flood level table) does not encapsulate the entirety of the boundary function.
This can be seen from the example of this package whenever a flood contour intersects the upper or right-hand bound (as with contours 1.8m and higher that intersect the upper bound of the figure). 
In order to address this issue, return probabilities of two alternate cases are computed. Taking the h=2 m in (use &quot;plot2&quot; to generate the figure) for illustration, 
the first case is to project the red contour line (h=2 m) horizontally back to the y axis at the storm tide intersection ARI=500. This caps the largest storm tide at ARI=500, 
which will result in an overestimate of the return probability. The second case is to extend the red contour line (h=2 m) vertically to infinity, i.e., assuming the largest flood level 
produced by the storm tides is h=2 m, even if the storm tide ARI tends to infinity . For this case, the return probability is underestimated. 
Using this approach, the two cases which give over and under estimates are respectively shown different flood levels (see the figure provided by &quot;plot2&quot;). 
For the given ARIs/AEPs, if the differences of the flood levels from the two cases are insignificant, the provided response variable table is sufficient for estimation. 
Otherwise a  more extended table with larger marginal ARIs/AEPs is required.
</p>


<h3>Value</h3>

<p>Returns a list of results
</p>
<table role = "presentation">
<tr><td><code>p.aep</code></td>
<td>
<p>are the AEPs that are onsidered</p>
</td></tr>
<tr><td><code>p.ari</code></td>
<td>
<p>are the ARIs that are considered</p>
</td></tr>
<tr><td><code>zout</code></td>
<td>
<p>are response variable estimates using the observed dependence, complete dependence and independence, see Details</p>
</td></tr>
<tr><td><code>px</code></td>
<td>
<p>are given ARIs/AEPs of X variable associated with rows (reproduced from inputs).</p>
</td></tr>
<tr><td><code>py</code></td>
<td>
<p>are given ARIs/AEPs of Y variable associated  with columns (reproduced from inputs).</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>is the given table of response variable values (reproduced from inputs).</p>
</td></tr>
<tr><td><code>prm</code></td>
<td>
<p>is the given parameter (reproduced from inputs).</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>is the specified model, either logistic model (default) or negative logsitic model (reproduced from inputs).</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>is the specified format of probablity, ARI or AEP (reproduced from inputs).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Feifei Zheng    <a href="mailto:feifei.zheng@adelaide.edu.au">feifei.zheng@adelaide.edu.au</a>,
Michael Leonard <a href="mailto:michael.leonard@adelaide.edu.au">michael.leonard@adelaide.edu.au</a>,
Seth Westra     <a href="mailto:seth.westra@adelaide.edu.au">seth.westra@adelaide.edu.au</a>
</p>


<h3>References</h3>

<p>Zheng, F., S. Westra, and S. A. Sisson (2013), Quantifying the dependence between extreme rainfall and storm surge in the coastal zone, Journal of Hydrology, 505(0), 172-187.<br />
</p>
<p>Zheng, F., Westra S. Sisson S. and Leonard M. (2014a). Modelling the dependence between extreme rainfall and storm surge to estimate coastal flood risk, Water Resources Research, under review.<br />
</p>
<p>Zheng, F., Leonard M. and Westra S. (2014b). An efficient bivariate integration method for joint probability analysis of flood risk, Water Resources Research, under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(jointPm)
 data(flood)
 px=flood$px;py=flood$py;z=flood$flood_table;prm=flood$prm;pout=flood$pout
 binteg(px,py,z,prm,pout,model="log",prob="ARI",nz=100,ninc=1000)
</code></pre>

<hr>
<h2 id='flood'>Example data of flood levels and dependence strength between extreme rainfall and extreme storm tides from a coastal catchment</h2><span id='topic+flood'></span>

<h3>Description</h3>

<p>&quot;flood_table&quot; is a matrix of flood levels with 100 different combinations of the rainfall and storm tides in terms of ARIs.<br />
&quot;px&quot; are ARIs of X variable associated with rows (rainfall).<br />
&quot;py&quot; are ARIs of Y variable associated with columns (storm tides).<br />
&quot;pout&quot; are ARIs for which flood levels are estimated with incorporation of joint dependence between extreme rainfall and storm tides.<br />
&quot;prm&quot; is the dependence parameter for the logistic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(flood)
</code></pre>


<h3>Details</h3>

<p>For the low bounds of the marginal dsitributions, the lowest astronomical tide and no rainfall are used and ARI=0/AEP=1.
</p>


<h3>References</h3>

<p>Zheng, F., Leonard M. and Westra S. (2014b). An efficient bivariate integration method for joint probability analysis of flood risk, Water Resources Research, under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(jointPm)
 data(flood)
</code></pre>

<hr>
<h2 id='Glog'>Cumulative distribution function of bivariate logistic model</h2><span id='topic+Glog'></span>

<h3>Description</h3>

<p>Glog is cumulative distribution function of bivariate logistic model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Glog(x,y,alpha) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Glog_+3A_x">x</code></td>
<td>
<p>X variable with Frechet scale</p>
</td></tr>
<tr><td><code id="Glog_+3A_y">y</code></td>
<td>
<p>Y variable with Frechet scale</p>
</td></tr>
<tr><td><code id="Glog_+3A_alpha">alpha</code></td>
<td>
<p>dependence parameter between X and Y variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bivariate logistic distribution function with parameter alpha is
</p>
<p>G(x,y)=exp(-[x^(-1/alpha)+y^(-1/alpha)]^(alpha))
</p>
<p>where 0 &lt; alpha &lt;= 1. Complete dependence is obtained in the limit as alpha approaches zero. Independence is obtained when alpha = 1. 
Note that x and y are assumed to follow the Frechet distribution for easy demonstration, so that G(z)=exp(-1/z), where z=x or y. 
However, this implies no loss of generality of the characterization of the bivariate extreme value distribution, 
since any other marginal distributions, whose extremal properties are determined by the univariate characterizations (GEV or GPD), 
can always be transformed into the standard Frechet form.
</p>


<h3>Value</h3>

<p>Glog gives the distribution function value of x and y specified on a Frechet scale.
</p>


<h3>References</h3>

<p>Coles, S.G. (2001), An introduction to statistical modelling of extreme values, Springer, London.
</p>

<hr>
<h2 id='Gneglog'>Cumulative distribution function of bivariate negative logistic model</h2><span id='topic+Gneglog'></span>

<h3>Description</h3>

<p>Gneglog is the cumulative distribution function of bivariate negative logistic model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gneglog(x,y,alpha) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Gneglog_+3A_x">x</code></td>
<td>
<p>X variable with Frechet scale</p>
</td></tr>
<tr><td><code id="Gneglog_+3A_y">y</code></td>
<td>
<p>Y variable with Frechet scale</p>
</td></tr>
<tr><td><code id="Gneglog_+3A_alpha">alpha</code></td>
<td>
<p>dependence parameter between X and Y variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bivariate negative logistic distribution function with parameter alpha is
</p>
<p>G(x,y)=exp(-1/x-1/y-[x^(1/alpha)+y^(1/alpha)]^(-1/alpha))
</p>
<p>where alpha &gt;0. Independence is obtained in the limit as alpha approaches zero. Complete dependence is obtained as alpha tends to infinity 
Note that x and y follow the Frechet distribution, so that G(z)=exp(-1/z), where z=x or y. However, this implies no loss of generality of the characterization of the bivariate extreme value distribution, 
since any other marginal distributions, whose extremal properties are determined by the univariate characterizations (GEV or GPD), can always be transformed into the standard Frechet form.
</p>


<h3>Value</h3>

<p>Gneglog gives the distribution function value of x and y specified on a Frechet scale.
</p>


<h3>References</h3>

<p>Coles, S.G. (2001), An introduction to statistical modelling of extreme values, Springer, London.
</p>

<hr>
<h2 id='plot1'>shows the bivariate intergration</h2><span id='topic+plot1'></span>

<h3>Description</h3>

<p>This figure shows the contours of the response variable (e.g. flood levels) interpolated from input z and the joint contours of the bivariate density of two forcing variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot1(obj,prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot1_+3A_obj">obj</code></td>
<td>
<p>is the output object from the binteg function.</p>
</td></tr>
<tr><td><code id="plot1_+3A_prob">prob</code></td>
<td>
<p>is how the axes show the return probability, either ARI (annual recurrence interval) or annual exceed probability (AEP).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot1 is the plot overlaying the response variable's contours and the joint probability contours. 
The exceedance probability for a particular response level is obtained by integrating the joint density 
for the region above this specified response level. This can be repeated for a range of different response variable levels, 
and the response variable corresponding to a specific exceedance probability can be found by subsequent interpolation. 
</p>


<h3>References</h3>

<p>Zheng, F., S. Westra, and S. A. Sisson (2013), Quantifying the dependence between extreme rainfall and storm surge in the coastal zone, Journal of Hydrology, 505(0), 172-187.<br />
</p>
<p>Zheng, F., Leonard M. and Westra S. (2014b). An efficient bivariate integration method for joint probability analysis of flood risk, Water Resources Research, under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(jointPm)
 data(flood)
 px=flood$px;py=flood$py;z=flood$flood_table;prm=flood$prm;pout=flood$pout
 result=binteg(px,py,z,prm,pout,model="log",prob="ARI",nz=100,ninc=1000)
 plot1(result,prob="ARI")
</code></pre>

<hr>
<h2 id='plot2'>a plot showing response variable levels versus return probabilities (ARI/AEP)</h2><span id='topic+plot2'></span>

<h3>Description</h3>

<p>plot2 shows the univariate response variable levels versus return probabilities (ARI/AEP).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot2(obj,prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot2_+3A_obj">obj</code></td>
<td>
<p>is the output object from the binteg function.</p>
</td></tr>
<tr><td><code id="plot2_+3A_prob">prob</code></td>
<td>
<p>is how the axes show the return probability, either ARI (annual recurrence interval) or annual exceed probability (AEP).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This figure include response variable levels estimated using the observed dependence, complete dependence (alpha=0) and complete independence (alpha=1) cases.
</p>


<h3>References</h3>

<p>Zheng, F., Leonard M. and Westra S. (2014b). An efficient bivariate integration method for joint probability analysis of flood risk, Water Resources Research, under review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> library(jointPm)
 data(flood)
 px=flood$px;py=flood$py;z=flood$flood_table;prm=flood$prm;pout=flood$pout
 result=binteg(px,py,z,prm,pout,model="log",prob="ARI",nz=100,ninc=1000)
 plot2(result,prob="ARI")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
