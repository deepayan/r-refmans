<!DOCTYPE html><html lang="en"><head><title>Help for package mstudentd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mstudentd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mstudentd-package'><p>Tools for Multivariate <code class="reqn">t</code> Distributions</p></a></li>
<li><a href='#contourmtd'><p>Contour Plot of the Bivariate <code class="reqn">t</code> Density</p></a></li>
<li><a href='#diststudent'><p>Distance/Divergence between Centered Multivariate <code class="reqn">t</code> Distributions</p></a></li>
<li><a href='#dmtd'><p>Density of a Multivariate <code class="reqn">t</code> Distribution</p></a></li>
<li><a href='#kldstudent'><p>Kullback-Leibler Divergence between Centered Multivariate <code class="reqn">t</code> Distributions</p></a></li>
<li><a href='#lauricella'><p>Lauricella <code class="reqn">D</code>-Hypergeometric Function</p></a></li>
<li><a href='#lnpochhammer'><p>Logarithm of the Pochhammer Symbol</p></a></li>
<li><a href='#plotmtd'><p>Plot of the Bivariate <code class="reqn">t</code> Density</p></a></li>
<li><a href='#pochhammer'><p>Pochhammer Symbol</p></a></li>
<li><a href='#rmtd'><p>Simulate from a Multivariate <code class="reqn">t</code> Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate t Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre Santagostini &lt;pierre.santagostini@agrocampus-ouest.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Distance between multivariate t distributions, as presented by N. Bouhlel and D. Rousseau (2023) &lt;<a href="https://doi.org/10.1109%2FLSP.2023.3324594">doi:10.1109/LSP.2023.3324594</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rgl, MASS, data.table</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://forgemia.inra.fr/imhorphen/mstudentd">https://forgemia.inra.fr/imhorphen/mstudentd</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://forgemia.inra.fr/imhorphen/mstudentd/-/issues">https://forgemia.inra.fr/imhorphen/mstudentd/-/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.2.1)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-22 23:27:05 UTC; psantagosti</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre Santagostini [aut, cre],
  Nizar Bouhlel [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-23 00:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mstudentd-package'>Tools for Multivariate <code class="reqn">t</code> Distributions</h2><span id='topic+mstudentd-package'></span><span id='topic+mstudentd'></span>

<h3>Description</h3>

<p>This package provides tools for multivariate <code class="reqn">t</code> distributions (MTD):
</p>

<ul>
<li><p> Calculation of distances/divergences between MTD:
</p>

<ul>
<li><p> Renyi divergence, Bhattacharyya distance, Hellinger distance: <code><a href="#topic+diststudent">diststudent</a></code>
</p>
</li>
<li><p> Kullback-Leibler divergence: <code><a href="#topic+kldstudent">kldstudent</a></code>
</p>
</li></ul>

</li>
<li><p> Tools for MTD:
</p>

<ul>
<li><p> Probability density: <code><a href="#topic+dmtd">dmtd</a></code>
</p>
</li>
<li><p> Simulation from a MTD: <code><a href="#topic+rmtd">rmtd</a></code>
</p>
</li>
<li><p> Plot of the density of a MTD with 2 variables: <code><a href="#topic+plotmtd">plotmtd</a></code>, <code><a href="#topic+contourmtd">contourmtd</a></code>
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Pierre Santagostini <a href="mailto:pierre.santagostini@agrocampus-ouest.fr">pierre.santagostini@agrocampus-ouest.fr</a>,
Nizar Bouhlel <a href="mailto:nizar.bouhlel@agrocampus-ouest.fr">nizar.bouhlel@agrocampus-ouest.fr</a>
</p>


<h3>References</h3>

<p>S. Kotz and Saralees Nadarajah (2004), Multivariate <code class="reqn">t</code> Distributions and Their Applications, Cambridge University Press.
</p>
<p>N. Bouhlel and D. Rousseau (2023), Exact Rényi and Kullback-Leibler Divergences Between Multivariate t-Distributions, IEEE Signal Processing Letters.
<a href="https://doi.org/10.1109/LSP.2023.3324594">doi:10.1109/LSP.2023.3324594</a>
#' @keywords internal
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://forgemia.inra.fr/imhorphen/mstudentd">https://forgemia.inra.fr/imhorphen/mstudentd</a>
</p>
</li>
<li><p> Report bugs at <a href="https://forgemia.inra.fr/imhorphen/mstudentd/-/issues">https://forgemia.inra.fr/imhorphen/mstudentd/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='contourmtd'>Contour Plot of the Bivariate <code class="reqn">t</code> Density</h2><span id='topic+contourmtd'></span>

<h3>Description</h3>

<p>Draws the contour plot of the probability density of the multivariate <code class="reqn">t</code> distribution with 2 variables
with location parameter <code>mu</code> and scatter matrix <code>Sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contourmtd(nu, mu, Sigma,
                   xlim = c(mu[1] + c(-10, 10)*Sigma[1, 1]),
                   ylim = c(mu[2] + c(-10, 10)*Sigma[2, 2]),
                   zlim = NULL, npt = 30, nx = npt, ny = npt,
                   main = "Multivariate t density",
                   sub = NULL, nlevels = 10,
                   levels = pretty(zlim, nlevels), tol = 1e-6, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contourmtd_+3A_nu">nu</code></td>
<td>
<p>numeric. The degrees of freedom.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_mu">mu</code></td>
<td>
<p>length 2 numeric vector.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_sigma">Sigma</code></td>
<td>
<p>symmetric, positive-definite square matrix of order 2. The scatter matrix.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_xlim">xlim</code>, <code id="contourmtd_+3A_ylim">ylim</code></td>
<td>
<p>x-and y- limits.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_zlim">zlim</code></td>
<td>
<p>z- limits. If NULL, it is the range of the values of the density on the x and y values within <code>xlim</code> and <code>ylim</code>.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_npt">npt</code></td>
<td>
<p>number of points for the discretisation.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_nx">nx</code>, <code id="contourmtd_+3A_ny">ny</code></td>
<td>
<p>number of points for the discretisation among the x- and y- axes.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_main">main</code>, <code id="contourmtd_+3A_sub">sub</code></td>
<td>
<p>main and sub title, as for <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_nlevels">nlevels</code>, <code id="contourmtd_+3A_levels">levels</code></td>
<td>
<p>arguments to be passed to the <code><a href="graphics.html#topic+contour">contour</a></code> function.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_tol">tol</code></td>
<td>
<p>tolerance (relative to largest variance) for numerical lack of positive-definiteness in Sigma, for the estimation of the density. see <code><a href="#topic+dmtd">dmtd</a></code>.</p>
</td></tr>
<tr><td><code id="contourmtd_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="graphics.html#topic+plot.window">plot.window</a></code>, <code><a href="graphics.html#topic+title">title</a></code>, <code><a href="graphics.html#topic+Axis">Axis</a></code> and <code><a href="graphics.html#topic+box">box</a></code>, typically <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> such as <code>cex.axis</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the probability density function.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>S. Kotz and Saralees Nadarajah (2004), Multivariate <code class="reqn">t</code> Distributions and Their Applications, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmtd">dmtd</a></code>: probability density of a multivariate <code class="reqn">t</code> density
</p>
<p><code><a href="#topic+plotmtd">plotmtd</a></code>: 3D plot of a bivariate <code class="reqn">t</code> density.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu &lt;- 1
mu &lt;- c(1, 4)
Sigma &lt;- matrix(c(0.8, 0.2, 0.2, 0.2), nrow = 2)
contourmtd(nu, mu, Sigma)

</code></pre>

<hr>
<h2 id='diststudent'>Distance/Divergence between Centered Multivariate <code class="reqn">t</code> Distributions</h2><span id='topic+diststudent'></span>

<h3>Description</h3>

<p>Computes the distance or divergence (Renyi divergence, Bhattacharyya
distance or Hellinger distance) between two random vectors distributed
according to multivariate $t$ distributions (MTD) with zero mean vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diststudent(nu1, Sigma1, nu2, Sigma2,
                   dist = c("renyi", "bhattacharyya", "hellinger"),
                   bet = NULL, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diststudent_+3A_nu1">nu1</code></td>
<td>
<p>numéric. The degrees of freedom of the first distribution.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_sigma1">Sigma1</code></td>
<td>
<p>symmetric, positive-definite matrix. The correlation matrix of the first distribution.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_nu2">nu2</code></td>
<td>
<p>numéric. The degrees of freedom of the second distribution.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_sigma2">Sigma2</code></td>
<td>
<p>symmetric, positive-definite matrix. The correlation matrix of the second distribution.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_dist">dist</code></td>
<td>
<p>character. The distance or divergence used.
One of <code>"renyi"</code> (default), <code>"battacharyya"</code> or <code>"hellinger"</code>.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_bet">bet</code></td>
<td>
<p>numeric, positive and not equal to 1. Order of the Renyi divergence.
Ignored if <code>distance="bhattacharyya"</code> or <code>distance="hellinger"</code>.</p>
</td></tr>
<tr><td><code id="diststudent_+3A_eps">eps</code></td>
<td>
<p>numeric. Precision for the computation of the partial derivative of the Lauricella <code class="reqn">D</code>-hypergeometric function (see Details). Default: 1e-06.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given <code class="reqn">X_1</code>, a random vector of <code class="reqn">R^p</code> distributed according to the MTD
with parameters <code class="reqn">(\nu_1, \mathbf{0}, \Sigma_1)</code>
and <code class="reqn">X_2</code>, a random vector of <code class="reqn">R^p</code> distributed according to the MTD
with parameters <code class="reqn">(\nu_2, \mathbf{0}, \Sigma_2)</code>.
</p>
<p>Let <code class="reqn">\delta_1 = \frac{\nu_1 + p}{2} \beta</code>, <code class="reqn">\delta_2 = \frac{\nu_2 + p}{2} (1 - \beta)</code>
and <code class="reqn">\lambda_1, \dots, \lambda_p</code> the eigenvalues of the square matrix <code class="reqn">\Sigma_1 \Sigma_2^{-1}</code>
sorted in increasing order: </p>
<p style="text-align: center;"><code class="reqn">\lambda_1 &lt; \dots &lt; \lambda_{p-1} &lt; \lambda_p</code>
</p>

<p>The Renyi divergence between <code class="reqn">X_1</code> and <code class="reqn">X_2</code> is:
</p>
<p style="text-align: center;"><code class="reqn">
\begin{aligned}
D_R^\beta(\mathbf{X}_1||\mathbf{X}_1) &amp;  = &amp; \displaystyle{\frac{1}{\beta - 1} \bigg[ \beta \ln\left(\frac{\Gamma\left(\frac{\nu_1+p}{2}\right) \Gamma\left(\frac{\nu_2}{2}\right) \nu_2^{\frac{p}{2}}}{\Gamma\left(\frac{\nu_2+p}{2}\right) \Gamma\left(\frac{\nu_1}{2}\right) \nu_1^{\frac{p}{2}}}\right) + \ln\left(\frac{\Gamma\left(\frac{\nu_2+p}{2}\right)}{\Gamma\left(\frac{\nu_2}{2}\right)}\right) + \ln\left(\frac{\Gamma\left(\delta_1 + \delta_2 - \frac{p}{2}\right)}{\Gamma(\delta_1 + \delta_2)}\right) } \\
&amp;&amp; \displaystyle{- \frac{\beta}{2} \sum_{i=1}^p{\ln\lambda_i} + \ln F_D \bigg]}
\end{aligned}
</code>
</p>

<p>with <code class="reqn">F_D</code> given by:
</p>

<ul>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_1 &gt; 1}</code>:
<code class="reqn">
\displaystyle{ F_D = F_D^{(p)}{\bigg( \delta_1, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}}_p; \delta_1+\delta_2; 1-\frac{\nu_2}{\nu_1 \lambda_1}, \dots, 1-\frac{\nu_2}{\nu_1 \lambda_p} \bigg)} }
</code>
</p>
</li>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_p &lt; 1}</code>:
<code class="reqn">
\displaystyle{ F_D = \prod_{i=1}^p{\left(\frac{\nu_1}{\nu_2} \lambda_i\right)^{\frac{1}{2}}} F_D^{(p)}\bigg(\delta_2, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}}_p; \delta_1+\delta_2; 1-\frac{\nu_1}{\nu_2}\lambda_1, \dots, 1-\frac{\nu_1}{\nu_2}\lambda_p\bigg) }
</code>
</p>
</li>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_1 &lt; 1}</code> and <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_p &gt; 1}</code>:
</p>
<p><code class="reqn">
\displaystyle{ F_D = \left(\frac{\nu_2}{\nu_1} \frac{1}{\lambda_p}\right)^{\delta_2} \prod_{i=1}^p\left(\frac{\nu_1}{\nu_2}\lambda_i\right)^\frac{1}{2} F_D^{(p)}\bigg(\delta_2, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}}_p, \delta_1+\delta_2-\frac{p}{2}; \delta_1+\delta2; 1-\frac{\lambda_1}{\lambda_p}, \dots, 1-\frac{\lambda_{p-1}}{\lambda_p}, 1-\frac{\nu_2}{\nu_1}\frac{1}{\lambda_p}\bigg) }
</code>
</p>
</li></ul>

<p>where <code class="reqn">F_D^{(p)}</code> is the Lauricella <code class="reqn">D</code>-hypergeometric function defined for <code class="reqn">p</code> variables:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ F_D^{(p)}\left(a; b_1, ..., b_p; g; x_1, ..., x_p\right) = \sum\limits_{m_1 \geq 0} ... \sum\limits_{m_p \geq 0}{ \frac{ (a)_{m_1+...+m_p}(b_1)_{m_1} ... (b_p)_{m_p} }{ (g)_{m_1+...+m_p} } \frac{x_1^{m_1}}{m_1!} ... \frac{x_p^{m_p}}{m_p!} } } </code>
</p>

<p>Its computation uses the <code><a href="#topic+lauricella">lauricella</a></code> function.
</p>
<p>The Bhattacharyya distance is given by:
</p>
<p style="text-align: center;"><code class="reqn">D_B(\mathbf{X}_1||\mathbf{X}_2) = \frac{1}{2} D_R^{1/2}(\mathbf{X}_1||\mathbf{X}_2)</code>
</p>

<p>And the Hellinger distance is given by:
</p>
<p style="text-align: center;"><code class="reqn">D_H(\mathbf{X}_1||\mathbf{X}_2) = 1 - \exp{\left(-\frac{1}{2} D_R^{1/2}(\mathbf{X}_1||\mathbf{X}_2)\right)}</code>
</p>



<h3>Value</h3>

<p>A numeric value: the Renyi divergence between the two distributions,
with two attributes <code>attr(, "epsilon")</code> (precision of the result of the Lauricella <code class="reqn">D</code>-hypergeometric function,see Details)
and <code>attr(, "k")</code> (number of iterations).
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>N. Bouhlel and D. Rousseau (2023), Exact Rényi and Kullback-Leibler Divergences Between Multivariate t-Distributions, IEEE Signal Processing Letters.
<a href="https://doi.org/10.1109/LSP.2023.3324594">doi:10.1109/LSP.2023.3324594</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu1 &lt;- 2
Sigma1 &lt;- matrix(c(2, 1.2, 0.4, 1.2, 2, 0.6, 0.4, 0.6, 2), nrow = 3)
nu2 &lt;- 4
Sigma2 &lt;- matrix(c(1, 0.3, 0.1, 0.3, 1, 0.4, 0.1, 0.4, 1), nrow = 3)

# Renyi divergence
diststudent(nu1, Sigma1, nu2, Sigma2, bet = 0.25)
diststudent(nu2, Sigma2, nu1, Sigma1, bet = 0.25)

# Bhattacharyya distance
diststudent(nu1, Sigma1, nu2, Sigma2, dist = "bhattacharyya")
diststudent(nu2, Sigma2, nu1, Sigma1, dist = "bhattacharyya")

# Hellinger distance
diststudent(nu1, Sigma1, nu2, Sigma2, dist = "hellinger")
diststudent(nu2, Sigma2, nu1, Sigma1, dist = "hellinger")

</code></pre>

<hr>
<h2 id='dmtd'>Density of a Multivariate <code class="reqn">t</code> Distribution</h2><span id='topic+dmtd'></span>

<h3>Description</h3>

<p>Density of the multivariate (<code class="reqn">p</code> variables) <code class="reqn">t</code> distribution (MTD)
with degrees of freedom <code>nu</code>, mean vector <code>mu</code> and
correlation matrix <code>Sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmtd(x, nu, mu, Sigma, tol = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dmtd_+3A_x">x</code></td>
<td>
<p>length <code class="reqn">p</code> numeric vector.</p>
</td></tr>
<tr><td><code id="dmtd_+3A_nu">nu</code></td>
<td>
<p>numeric. The degrees of freedom.</p>
</td></tr>
<tr><td><code id="dmtd_+3A_mu">mu</code></td>
<td>
<p>length <code class="reqn">p</code> numeric vector. The mean vector.</p>
</td></tr>
<tr><td><code id="dmtd_+3A_sigma">Sigma</code></td>
<td>
<p>symmetric, positive-definite square matrix of order <code class="reqn">p</code>. The correlation matrix.</p>
</td></tr>
<tr><td><code id="dmtd_+3A_tol">tol</code></td>
<td>
<p>tolerance (relative to largest variance) for numerical lack of positive-definiteness in Sigma.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The density function of a multivariate <code class="reqn">t</code> distribution
with <code class="reqn">p</code> variables is given by:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ f(\mathbf{x}|\nu, \boldsymbol{\mu}, \Sigma) = \frac{\Gamma\left( \frac{\nu+p}{2} \right) |\Sigma|^{-1/2}}{\Gamma\left( \frac{\nu}{2} \right) (\nu \pi)^{p/2}} \left( 1 + \frac{1}{\nu} (\mathbf{x}-\boldsymbol{\mu})^T \Sigma^{-1} (\mathbf{x}-\boldsymbol{\mu}) \right)^{-\frac{\nu+p}{2}} } </code>
</p>

<p>When <code class="reqn">p=1</code> (univariate case) it becomes:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ f(x|\nu, \mu, \sigma^2) = \frac{\Gamma\left( \frac{\nu+1}{2} \right)}{\Gamma\left( \frac{\nu}{2} \right) \sqrt{\nu \pi} \sigma} \left(1 + \frac{(x-\mu)^2}{\nu \sigma^2}\right)^{-\frac{\nu+1}{2}} } </code>
</p>



<h3>Value</h3>

<p>The value of the density.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>S. Kotz and Saralees Nadarajah (2004), Multivariate <code class="reqn">t</code> Distributions and Their Applications, Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu &lt;- 1
mu &lt;- c(0, 1, 4)
Sigma &lt;- matrix(c(0.8, 0.3, 0.2, 0.3, 0.2, 0.1, 0.2, 0.1, 0.2), nrow = 3)
dmtd(c(0, 1, 4), nu, mu, Sigma)
dmtd(c(1, 2, 3), nu, mu, Sigma)

# Univariate
dmtd(1, 3, 0, 1)
dt(1, 3)

</code></pre>

<hr>
<h2 id='kldstudent'>Kullback-Leibler Divergence between Centered Multivariate <code class="reqn">t</code> Distributions</h2><span id='topic+kldstudent'></span>

<h3>Description</h3>

<p>Computes the Kullback-Leibler divergence between two random vectors distributed
according to multivariate <code class="reqn">t</code> distributions (MTD) with zero location vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kldstudent(nu1, Sigma1, nu2, Sigma2, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kldstudent_+3A_nu1">nu1</code></td>
<td>
<p>numeric. The degrees of freedom of the first distribution.</p>
</td></tr>
<tr><td><code id="kldstudent_+3A_sigma1">Sigma1</code></td>
<td>
<p>symmetric, positive-definite matrix. The scatter matrix of the first distribution.</p>
</td></tr>
<tr><td><code id="kldstudent_+3A_nu2">nu2</code></td>
<td>
<p>numeric. The degrees of freedom of the second distribution.</p>
</td></tr>
<tr><td><code id="kldstudent_+3A_sigma2">Sigma2</code></td>
<td>
<p>symmetric, positive-definite matrix. The scatter matrix of the second distribution.</p>
</td></tr>
<tr><td><code id="kldstudent_+3A_eps">eps</code></td>
<td>
<p>numeric. Precision for the computation of the partial derivative of the Lauricella <code class="reqn">D</code>-hypergeometric function (see Details). Default: 1e-06.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given <code class="reqn">X_1</code>, a random vector of <code class="reqn">\mathbb{R}^p</code> distributed according to the centered MTD
with parameters <code class="reqn">(\nu_1, 0, \Sigma_1)</code>
and <code class="reqn">X_2</code>, a random vector of <code class="reqn">\mathbb{R}^p</code> distributed according to the MCD
with parameters <code class="reqn">(\nu_2, 0, \Sigma_2)</code>.
</p>
<p>Let <code class="reqn">\lambda_1, \dots, \lambda_p</code> the eigenvalues of the square matrix <code class="reqn">\Sigma_1 \Sigma_2^{-1}</code>
sorted in increasing order: </p>
<p style="text-align: center;"><code class="reqn">\lambda_1 &lt; \dots &lt; \lambda_{p-1} &lt; \lambda_p</code>
</p>

<p>The Kullback-Leibler divergence of <code class="reqn">X_1</code> from <code class="reqn">X_2</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">
\displaystyle{ D_{KL}(\mathbf{X}_1\|\mathbf{X}_2) = \ln\left(\frac{\Gamma\left(\frac{\nu_1+p}{2}\right) \Gamma\left(\frac{\nu_2}{2}\right) \nu_2^{\frac{p}{2}}}{\Gamma\left(\frac{\nu_2+p}{2}\right) \Gamma\left(\frac{\nu_1}{2}\right) \nu_1^{\frac{p}{2}}} \right) + \frac{\nu_2-\nu_1}{2} \left[\psi\left(\frac{\nu_1+p}{2} \right) - \psi\left(\frac{\nu_1}{2}\right)\right] - \frac{1}{2} \sum_{i=1}^p{\ln\lambda_i} - \frac{\nu_2+p}{2} \times D }
</code>
</p>

<p>where <code class="reqn">\psi</code> is the digamma function (see <a href="base.html#topic+Special">Special</a>)
and <code class="reqn">D</code> is given by:
</p>

<ul>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_1 &gt; 1}</code>:
</p>
<p><code class="reqn">
\displaystyle{ D = \prod_{i=1}^p{\left(\frac{\nu_2}{\nu_1} \frac{1}{\lambda_i}\right)^\frac{1}{2}} \frac{\partial}{\partial a}\left.\left\{ F_D^{(p)}\left(\frac{\nu_1+p}{2}, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}}_p; a + \frac{\nu_1+p}{2}; 1-\frac{\nu_2}{\nu_1}\frac{1}{\lambda_1}, \dots, 1-\frac{\nu_2}{\nu_1}\frac{1}{\lambda_p}\right) \right\}\right|_{a=0} }
</code>
</p>
</li>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_p &lt; 1}</code>:
</p>
<p><code class="reqn">
\displaystyle{ D = \frac{\partial}{\partial a}\left.\left\{ F_D^{(p)}\left(a, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}}_p; a + \frac{\nu_1+p}{2}; 1-\frac{\nu_1}{\nu_2}\lambda_1, \dots, 1-\frac{\nu_1}{\nu_2}\lambda_p\right) \right\}\right|_{a=0} }
</code>
</p>
</li>
<li><p> If <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_1 &lt; 1}</code> and <code class="reqn">\displaystyle{\frac{\nu_1}{\nu_2} \lambda_p &gt; 1}</code>:
</p>
<p><code class="reqn">
\displaystyle{ D = -\ln\left(\frac{\nu_1}{\nu_2}\lambda_p\right) + \frac{\partial}{\partial a}\left.\left\{F_D^{(p)}\left(a, \underbrace{\frac{1}{2}, \dots, \frac{1}{2}, a+\frac{\nu_1}{2}}_p; a+\frac{\nu_1+p}{2}; 1-\frac{\lambda_1}{\lambda_p}, \dots, 1-\frac{\lambda_{p-1}}{\lambda_p}, 1-\frac{\nu_2}{\nu_1}\frac{1}{\lambda_p}\right)\right\}\right|_{a=0} }
</code>
</p>
</li></ul>

<p><code class="reqn">F_D^{(p)}</code> is the Lauricella <code class="reqn">D</code>-hypergeometric function defined for <code class="reqn">p</code> variables:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ F_D^{(p)}\left(a; b_1, ..., b_p; g; x_1, ..., x_p\right) = \sum\limits_{m_1 \geq 0} ... \sum\limits_{m_p \geq 0}{ \frac{ (a)_{m_1+...+m_p}(b_1)_{m_1} ... (b_p)_{m_p} }{ (g)_{m_1+...+m_p} } \frac{x_1^{m_1}}{m_1!} ... \frac{x_p^{m_p}}{m_p!} } } </code>
</p>

<!-- The computation of the partial derivative uses the \code{\link{pochhammer}} function. -->



<h3>Value</h3>

<p>A numeric value: the Kullback-Leibler divergence between the two distributions,
with two attributes <code>attr(, "epsilon")</code> (precision of the partial derivative of the Lauricella <code class="reqn">D</code>-hypergeometric function,see Details)
and <code>attr(, "k")</code> (number of iterations).
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>N. Bouhlel and D. Rousseau (2023), Exact Rényi and Kullback-Leibler Divergences Between Multivariate t-Distributions, IEEE Signal Processing Letters.
<a href="https://doi.org/10.1109/LSP.2023.3324594">doi:10.1109/LSP.2023.3324594</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu1 &lt;- 2
Sigma1 &lt;- matrix(c(2, 1.2, 0.4, 1.2, 2, 0.6, 0.4, 0.6, 2), nrow = 3)
nu2 &lt;- 4
Sigma2 &lt;- matrix(c(1, 0.3, 0.1, 0.3, 1, 0.4, 0.1, 0.4, 1), nrow = 3)

kldstudent(nu1, Sigma1, nu2, Sigma2)
kldstudent(nu2, Sigma2, nu1, Sigma1)

</code></pre>

<hr>
<h2 id='lauricella'>Lauricella <code class="reqn">D</code>-Hypergeometric Function</h2><span id='topic+lauricella'></span>

<h3>Description</h3>

<p>Computes the Lauricella <code class="reqn">D</code>-hypergeometric Function function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lauricella(a, b, g, x, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lauricella_+3A_a">a</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="lauricella_+3A_b">b</code></td>
<td>
<p>numeric vector.</p>
</td></tr>
<tr><td><code id="lauricella_+3A_g">g</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="lauricella_+3A_x">x</code></td>
<td>
<p>numeric vector. <code>x</code> must have the same length as <code>b</code>.</p>
</td></tr>
<tr><td><code id="lauricella_+3A_eps">eps</code></td>
<td>
<p>numeric. Precision for the nested sums (default 1e-06).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">n</code> is the length of the <code class="reqn">b</code> and <code>x</code> vectors,
the Lauricella <code class="reqn">D</code>-hypergeometric Function function is given by:
</p>
<p style="text-align: center;"><code class="reqn">\displaystyle{F_D^{(n)}\left(a, b_1, ..., b_n, g; x_1, ..., x_n\right) = \sum_{m_1 \geq 0} ... \sum_{m_n \geq 0}{ \frac{ (a)_{m_1+...+m_n}(b_1)_{m_1} ... (b_n)_{m_n} }{ (g)_{m_1+...+m_n} } \frac{x_1^{m_1}}{m_1!} ... \frac{x_n^{m_n}}{m_n!} } }</code>
</p>

<p>where <code class="reqn">(x)_p</code> is the Pochhammer symbol (see <code><a href="#topic+pochhammer">pochhammer</a></code>).
</p>
<p>If <code class="reqn">|x_i| &lt; 1, i = 1, \dots, n</code>, this sum converges.
Otherwise there is an error.
</p>
<p>The <code>eps</code> argument gives the required precision for its computation.
It is the <code>attr(, "epsilon")</code> attribute of the returned value.
</p>
<p>Sometimes, the convergence is too slow and the required precision cannot be reached.
If this happens, the <code>attr(, "epsilon")</code> attribute is the precision that was really reached.
</p>


<h3>Value</h3>

<p>A numeric value: the value of the Lauricella function,
with two attributes <code>attr(, "epsilon")</code> (precision of the result) and <code>attr(, "k")</code> (number of iterations).
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>N. Bouhlel and D. Rousseau, Exact Rényi and  Kullback-Leibler Divergences Between Multivariate t-Distributions.
IEEE Signal Processing Letters Processing Letters, vol. 26 no. 7, July 2019.
<a href="https://doi.org/10.1109/LSP.2019.2915000">doi:10.1109/LSP.2019.2915000</a>
</p>

<hr>
<h2 id='lnpochhammer'>Logarithm of the Pochhammer Symbol</h2><span id='topic+lnpochhammer'></span>

<h3>Description</h3>

<p>Computes the logarithm of the Pochhammer symbol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnpochhammer(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lnpochhammer_+3A_x">x</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="lnpochhammer_+3A_n">n</code></td>
<td>
<p>positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pochhammer symbol is given by:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ (x)_n = \frac{\Gamma(x+n)}{\Gamma(x)} = x (x+1) ... (x+n-1) } </code>
</p>

<p>So, if <code class="reqn">n &gt; 0</code>:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ log\left((x)_n\right) = log(x) + log(x+1) + ... + log(x+n-1) } </code>
</p>

<p>If <code class="reqn">n = 0</code>, <code class="reqn">\displaystyle{ log\left((x)_n\right) = log(1) = 0}</code>
</p>


<h3>Value</h3>

<p>Numeric value. The logarithm of the Pochhammer symbol.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pochhammer">pochhammer()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lnpochhammer(2, 0)
lnpochhammer(2, 1)
lnpochhammer(2, 3)

</code></pre>

<hr>
<h2 id='plotmtd'>Plot of the Bivariate <code class="reqn">t</code> Density</h2><span id='topic+plotmtd'></span>

<h3>Description</h3>

<p>Plots the probability density of the multivariate <code class="reqn">t</code> distribution with 2 variables
with location parameter <code>mu</code> and scatter matrix <code>Sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmtd(nu, mu, Sigma, xlim = c(mu[1] + c(-10, 10)*Sigma[1, 1]),
                ylim = c(mu[2] + c(-10, 10)*Sigma[2, 2]), n = 101,
                xvals = NULL, yvals = NULL, xlab = "x", ylab = "y",
                zlab = "f(x,y)", col = "gray", tol = 1e-6, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotmtd_+3A_nu">nu</code></td>
<td>
<p>numeric. The degrees of freedom.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_mu">mu</code></td>
<td>
<p>length 2 numeric vector. The mean vector.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_sigma">Sigma</code></td>
<td>
<p>symmetric, positive-definite square matrix of order 2. The correlation matrix.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_xlim">xlim</code>, <code id="plotmtd_+3A_ylim">ylim</code></td>
<td>
<p>x-and y- limits.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_n">n</code></td>
<td>
<p>A one or two element vector giving the number of steps in the x and y grid, passed to <code><a href="rgl.html#topic+plot3d.function">plot3d.function</a></code>.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_xvals">xvals</code>, <code id="plotmtd_+3A_yvals">yvals</code></td>
<td>
<p>The values at which to evaluate <code>x</code> and <code>y</code>. If used, <code>xlim</code> and/or <code>ylim</code> are ignored.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_xlab">xlab</code>, <code id="plotmtd_+3A_ylab">ylab</code>, <code id="plotmtd_+3A_zlab">zlab</code></td>
<td>
<p>The axis labels.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_col">col</code></td>
<td>
<p>The color to use for the plot. See <code><a href="rgl.html#topic+plot3d.function">plot3d.function</a></code>.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_tol">tol</code></td>
<td>
<p>tolerance (relative to largest variance) for numerical lack of positive-definiteness in Sigma, for the estimation of the density. see <code><a href="#topic+dmtd">dmtd</a></code>.</p>
</td></tr>
<tr><td><code id="plotmtd_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="rgl.html#topic+plot3d.function">plot3d.function</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly the probability density function.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>S. Kotz and Saralees Nadarajah (2004), Multivariate <code class="reqn">t</code> Distributions and Their Applications, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmtd">dmtd</a></code>: probability density of a multivariate <code class="reqn">t</code> density
</p>
<p><code><a href="#topic+contourmtd">contourmtd</a></code>: contour plot of a bivariate <code class="reqn">t</code> density.
</p>
<p><code><a href="rgl.html#topic+plot3d.function">plot3d.function</a></code>: plot a function of two variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu &lt;- 1
mu &lt;- c(1, 4)
Sigma &lt;- matrix(c(0.8, 0.2, 0.2, 0.2), nrow = 2)
plotmtd(nu, mu, Sigma)

</code></pre>

<hr>
<h2 id='pochhammer'>Pochhammer Symbol</h2><span id='topic+pochhammer'></span>

<h3>Description</h3>

<p>Computes the Pochhammer symbol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pochhammer(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pochhammer_+3A_x">x</code></td>
<td>
<p>numeric.</p>
</td></tr>
<tr><td><code id="pochhammer_+3A_n">n</code></td>
<td>
<p>positive integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pochhammer symbol is given by:
</p>
<p style="text-align: center;"><code class="reqn"> \displaystyle{ (x)_n = \frac{\Gamma(x+n)}{\Gamma(x)} = x (x+1) ... (x+n-1) } </code>
</p>



<h3>Value</h3>

<p>Numeric value. The value of the Pochhammer symbol.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pochhammer(2, 0)
pochhammer(2, 1)
pochhammer(2, 3)

</code></pre>

<hr>
<h2 id='rmtd'>Simulate from a Multivariate <code class="reqn">t</code> Distribution</h2><span id='topic+rmtd'></span>

<h3>Description</h3>

<p>Produces one or more samples from the multivariate (<code class="reqn">p</code> variables) <code class="reqn">t</code> distribution (MTD)
with degrees of freedom <code>nu</code>, mean vector <code>mu</code> and
correlation matrix <code>Sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmtd(n, nu, mu, Sigma, tol = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmtd_+3A_n">n</code></td>
<td>
<p>integer. Number of observations.</p>
</td></tr>
<tr><td><code id="rmtd_+3A_nu">nu</code></td>
<td>
<p>numeric. The degrees of freedom.</p>
</td></tr>
<tr><td><code id="rmtd_+3A_mu">mu</code></td>
<td>
<p>length <code class="reqn">p</code> numeric vector. The mean vector</p>
</td></tr>
<tr><td><code id="rmtd_+3A_sigma">Sigma</code></td>
<td>
<p>symmetric, positive-definite square matrix of order <code class="reqn">p</code>. The correlation matrix.</p>
</td></tr>
<tr><td><code id="rmtd_+3A_tol">tol</code></td>
<td>
<p>tolerance for numerical lack of positive-definiteness in Sigma (for <code>mvrnorm</code>, see Details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sample from a MTD with parameters <code class="reqn">\nu</code>, <code class="reqn">\boldsymbol{\mu}</code> and <code class="reqn">\Sigma</code>
can be generated using:
</p>
<p style="text-align: center;"><code class="reqn">\displaystyle{X = \mu + \frac{Y}{\sqrt{\frac{u}{\nu}}}}</code>
</p>

<p>where <code class="reqn">Y</code> is a random vector distributed among a centered Gaussian density
with covariance matrix <code class="reqn">\Sigma</code> (generated using <code><a href="MASS.html#topic+mvrnorm">mvrnorm</a></code>)
and <code class="reqn">u</code> is distributed among a Chi-squared distribution with <code class="reqn">\nu</code> degrees of freedom.
</p>


<h3>Value</h3>

<p>A matrix with <code class="reqn">p</code> columns and <code class="reqn">n</code> rows.
</p>


<h3>Author(s)</h3>

<p>Pierre Santagostini, Nizar Bouhlel
</p>


<h3>References</h3>

<p>S. Kotz and Saralees Nadarajah (2004), Multivariate <code class="reqn">t</code> Distributions and Their Applications, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmtd">dmtd</a></code>: probability density of a MTD.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nu &lt;- 3
mu &lt;- c(0, 1, 4)
Sigma &lt;- matrix(c(1, 0.6, 0.2, 0.6, 1, 0.3, 0.2, 0.3, 1), nrow = 3)
x &lt;- rmtd(10000, nu, mu, Sigma)
head(x)
dim(x)
mu; colMeans(x)
nu/(nu-2)*Sigma; var(x)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
