<!DOCTYPE html><html><head><title>Help for package eiPack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eiPack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bounds'><p>Deterministic bounds for units satisfying row thresholds</p></a></li>
<li><a href='#cover.plot'><p>Unit-level coverage plots for beta parameters from MD EI model</p></a></li>
<li><a href='#densityplot'><p>Density plots for population level parameters</p></a></li>
<li><a href='#ei.MD.bayes'><p>Multinomial Dirichlet model for Ecological Inference in RxC tables</p></a></li>
<li><a href='#ei.reg'><p>Ecological regression</p></a></li>
<li><a href='#ei.reg.bayes'><p>Ecological regression using Bayesian Normal regression</p></a></li>
<li><a href='#lambda.MD'><p>Calculate shares using data from MD model</p></a></li>
<li><a href='#lambda.reg'><p>Calculate shares using data from regression model</p></a></li>
<li><a href='#lambda.reg.bayes'><p>Calculate shares using data from Bayesian regression model</p></a></li>
<li><a href='#mergeMD'><p>Combine output from multiple eiMD objects</p></a></li>
<li><a href='#plot.bounds'><p>Plot of deterministic bounds for units satisfying row thresholds</p></a></li>
<li><a href='#read.betas'><p>Function to read in eiMD parameter chains saved to disk</p></a></li>
<li><a href='#redistrict'><p>Redistricting Monte-Carlo data</p></a></li>
<li><a href='#senc'><p>Party registration in south-east North Carolina</p></a></li>
<li><a href='#tuneA'><p>Tuning parameters for alpha hyperpriors in RxC EI model</p></a></li>
<li><a href='#tuneB'><p>Tuning parameters for the precinct level parameters in the RxC EI</p>
model</a></li>
<li><a href='#tuneMD'><p>Generate tuning parameters for MD model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Ecological Inference and Higher-Dimension Data Management</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivia Lau &lt;olivia.lau@post.harvard.edu&gt;, Ryan T. Moore
        &lt;rtm@american.edu&gt;, Michael Kellermann &lt;mrkellermann@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kellermann &lt;mrkellermann@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, coda, msm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for analyzing R by C ecological contingency
        tables using the extreme case analysis, ecological regression,
        and Multinomial-Dirichlet ecological inference models.  Also
        provides tools for manipulating higher-dimension data objects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE [expanded from: GPL (&ge; 2) | file LICENSE]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.olivialau.org/software/">http://www.olivialau.org/software/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-18 22:43:58 UTC; Mike Kellermann</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-18 23:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bounds'>Deterministic bounds for units satisfying row thresholds</h2><span id='topic+bounds'></span>

<h3>Description</h3>

<p>Calculates the deterministic bounds on the proportion of
row members within a specified column.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bounds(formula, data, rows, column, excluded = NULL, 
    threshold = 0.9, total = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bounds_+3A_formula">formula</code></td>
<td>
<p>a formula of the form <code>cbind(col1, col2, ...) ~
      cbind(row1, row2, ...)</code>.  Column and row marginals must have the
same total for each ecological unit.</p>
</td></tr>
<tr><td><code id="bounds_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables specified in
<code>formula</code> and (optionally) <code>total</code></p>
</td></tr>
<tr><td><code id="bounds_+3A_rows">rows</code></td>
<td>
<p>a character vector specifying the rows of interest</p>
</td></tr>
<tr><td><code id="bounds_+3A_column">column</code></td>
<td>
<p>a character string specifying the column marginal of
interest</p>
</td></tr>
<tr><td><code id="bounds_+3A_excluded">excluded</code></td>
<td>
<p>an optional character string (or vector of character
strings) specifying the columns to be excluded from the bounds
calculation.  For example, if the quantity of interest is Democratic
share of the two-party vote, non-voters would be excluded.</p>
</td></tr>
<tr><td><code id="bounds_+3A_threshold">threshold</code></td>
<td>
<p>the minimum proportion of the unit that row members must
comprise for the bounds to be calculated for the unit.  If
<code>threshold = 0</code>, bounds will be calculated for all units.</p>
</td></tr>
<tr><td><code id="bounds_+3A_total">total</code></td>
<td>
<p>if row and/or column marginals are given as proportions,
<code>total</code> identifies the name of the variable in <code>data</code> containing the
total number of individuals in each unit</p>
</td></tr>
</table>


<h3>Value</h3>

<p> A list with elements 
</p>
<table>
<tr><td><code>bounds</code></td>
<td>
<p>a list of deterministic bounds for all units in which
row proportions meet the threshold</p>
</td></tr>
<tr><td><code>intersection</code></td>
<td>
<p>if the intersection of the deterministic bounding
intervals is non-empty, the intersection is returned.  Otherwise,
<code>NA</code> is returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>References</h3>

<p>Otis Dudley Duncan and Beverley Davis.  1953.  &ldquo;An Alternative to Ecological
Correlation.&rdquo; <em>American Sociological Review</em> 18: 665-666.
</p>


<h3>See Also</h3>

<p><code>plot.bounds</code></p>

<hr>
<h2 id='cover.plot'>Unit-level coverage plots for beta parameters from MD EI model</h2><span id='topic+cover.plot'></span><span id='topic+coverage'></span>

<h3>Description</h3>

<p>Generates a plot of central credible intervals for the
unit-level beta parameters from the Multinomial-Dirichlet ecological inference model
(see <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>cover.plot(object, row, column, x = NULL, CI = 0.95,
          medians = TRUE, col = NULL, ylim = c(0,1), 
          ylab, lty = par("lty"), lwd = par("lwd"), ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cover.plot_+3A_object">object</code></td>
<td>
<p>output from <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>
</td></tr>
<tr><td><code id="cover.plot_+3A_row">row</code></td>
<td>
<p>a character string specifying the row marginal of interest</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_column">column</code></td>
<td>
<p>a character string specifying the column marginal of
interest</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_x">x</code></td>
<td>
<p>an optional covariate to index the units along the x-axis</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_ci">CI</code></td>
<td>
<p>a fraction between 0 and 1 (defaults to 0.95), specifying
the coverage of the central credible interval to be plotted for each unit</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_medians">medians</code></td>
<td>
<p>a logical value specifying whether to plot the median
(defaults to <code>TRUE</code>).  If <code>medians = FALSE</code>, the medians
are not plotted.</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_col">col</code></td>
<td>
<p>an optional vector of colors to be passed to
<code>plot</code> and <code>segments</code>.  If <code>col</code> is of
length two, then the first color is used for <code>plot</code> and the
second for <code>segments</code>.</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_ylim">ylim</code></td>
<td>
<p>an optional range for the y-axis (defaults to <code>c(0,1)</code>).</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_ylab">ylab</code></td>
<td>
<p>an optional label for the y-axis (defaults to
<code>Proportion of row in column</code>).</p>
</td></tr> 
<tr><td><code id="cover.plot_+3A_lty">lty</code></td>
<td>
<p>an optional line type passed to <code>segments</code>.</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_lwd">lwd</code></td>
<td>
<p>an optional line width argument passed to
<code>segments</code>.</p>
</td></tr>
<tr><td><code id="cover.plot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with vertical intervals indicating the central credible
intervals for each ecological unit.  
</p>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code>plot</code>, <code>segments</code>, <code>par</code></p>

<hr>
<h2 id='densityplot'>Density plots for population level parameters</h2><span id='topic+densityplot'></span><span id='topic+densityplot.lambdaMD'></span><span id='topic+densityplot.lambdaReg'></span><span id='topic+densityplot.lambdaRegBayes'></span>

<h3>Description</h3>

<p>Generates a density plot for population level quantities of
interest output by <code><a href="#topic+lambda.MD">lambda.MD</a></code>, <code><a href="#topic+lambda.reg">lambda.reg</a></code>,
and <code><a href="#topic+lambda.reg.bayes">lambda.reg.bayes</a></code>.  For the Bayesian methods,
<code>densityplot</code> plots the kernel density for the draws.  For the
frequentist <code><a href="#topic+lambda.reg">lambda.reg</a></code> method, <code>densityplot</code> plots
the canonical Normal density conditional on the mean and standard error
output by <code><a href="#topic+lambda.reg">lambda.reg</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lambdaMD'
densityplot(x, by = "column", col, xlim, ylim,
             main = "", sub = NULL, xlab, ylab,
             lty = par("lty"), lwd = par("lwd"), ...)
## S3 method for class 'lambdaRegBayes'
densityplot(x, by = "column", col, xlim, ylim,
             main = "", sub = NULL, xlab, ylab,
             lty = par("lty"), lwd = par("lwd"), ...)
## S3 method for class 'lambdaReg'
densityplot(x, by = "column", col, xlim, ylim,
             main = "", sub = NULL, xlab, ylab,
             lty = par("lty"), lwd = par("lwd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="densityplot_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+lambda.MD">lambda.MD</a></code>, <code><a href="#topic+lambda.reg">lambda.reg</a></code>,
or <code><a href="#topic+lambda.reg.bayes">lambda.reg.bayes</a></code>.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_by">by</code></td>
<td>
<p>character string (defaulting to <code>"column"</code>) specifying
whether to panel the density plot by <code>"row"</code> or <code>"column"</code>
marginal.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_col">col</code></td>
<td>
<p>an optional vector of colors, with length corresponding to
the number of marginals selected in <code>by</code>.  Defaults to
<code>rainbow</code>.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_xlim">xlim</code>, <code id="densityplot_+3A_ylim">ylim</code></td>
<td>
<p>optional limits for the x-axis and y-axis, passed to
<code>plot</code>.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_main">main</code>, <code id="densityplot_+3A_sub">sub</code></td>
<td>
<p>optional title and subtitle, passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_xlab">xlab</code>, <code id="densityplot_+3A_ylab">ylab</code></td>
<td>
<p>optional labels for the x- and y-axes, passed to
<code>plot</code>.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_lty">lty</code>, <code id="densityplot_+3A_lwd">lwd</code></td>
<td>
<p>optional arguments for line type and line width, passed
to <code>lines</code> and <code>plot</code>.  If either <code>lty</code> or <code>lwd</code> are
vectors, it must correspond to the number of row or column marginals selected.</p>
</td></tr>
<tr><td><code id="densityplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>par</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with density lines for the selected margin (row or column).  
</p>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code>plot</code>, <code>segments</code>, <code>par</code></p>

<hr>
<h2 id='ei.MD.bayes'>Multinomial Dirichlet model for Ecological Inference in RxC tables</h2><span id='topic+ei.MD.bayes'></span>

<h3>Description</h3>

<p>Implements a version of the hierarchical model suggested in Rosen et al. (2001)</p>


<h3>Usage</h3>

<pre><code class='language-R'>ei.MD.bayes(formula, covariate = NULL, total = NULL, data, 
            lambda1 = 4, lambda2 = 2, covariate.prior.list = NULL,
            tune.list = NULL, start.list = NULL, sample = 1000, thin = 1, 
            burnin = 1000, verbose = 0, ret.beta = 'r', 
            ret.mcmc = TRUE, usrfun = NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ei.MD.bayes_+3A_formula">formula</code></td>
<td>
<p>A formula of the form <code>cbind(col1, col2, ...) ~
      cbind(row1, row2, ...)</code>.   Column and row marginals must have the
same totals.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_covariate">covariate</code></td>
<td>
<p>An optional formula of the form <code>~ covariate</code>.  The 
default is <code>covariate = NULL</code>, which fits the model without a covariate.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_total">total</code></td>
<td>
<p>if row and/or column marginals are given as proportions,
<code>total</code> identifies the name of the variable in <code>data</code> containing the
total number of individuals in each unit</p>
</td></tr>    
<tr><td><code id="ei.MD.bayes_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables specified in
<code>formula</code> and <code>total</code></p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_lambda1">lambda1</code></td>
<td>
<p>The shape parameter for the gamma prior (defaults to 4)</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_lambda2">lambda2</code></td>
<td>
<p>The rate parameter for the gamma prior (defaults to 2)</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_covariate.prior.list">covariate.prior.list</code></td>
<td>
<p>a list containing the parameters for
normal prior distributions on delta and gamma for model with
covariate.  See &lsquo;details&rsquo; for more information.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_tune.list">tune.list</code></td>
<td>
<p>A list containing tuning parameters for each block of
parameters.  See &lsquo;details&rsquo; for more information.  Typically, this
will be a list generated by <code><a href="#topic+tuneMD">tuneMD</a></code>.  The
default is <code>NULL</code>, in which case fixed tuning parameters are used.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_start.list">start.list</code></td>
<td>
<p>A list containing starting values for each block of
parameters.  See &lsquo;details&rsquo; for more information.  The default is
<code>start.list = NULL</code>, which generates appropriate random starting values.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_sample">sample</code></td>
<td>
<p>Number of draws to be saved from chain
and returned as output from the function (defaults to 1000).  The total
length of the chain is <code>sample</code>*<code>thin</code> + <code>burnin</code>.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_thin">thin</code></td>
<td>
<p>an integer specifying the thinning interval for posterior
draws (defaults to 1, but most problems will require a much larger thinning interval).</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_burnin">burnin</code></td>
<td>
<p>integer specifying the number of initial iterations to be discarded (defaults to 1000, but most problems will require a longer burnin).</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_verbose">verbose</code></td>
<td>
<p>an integer specifying whether the progress of the sampler 
is printed to the screen (defaults to 0).  If <code>verbose</code> is greater than 0, the
iteration number is printed to the screen every <code>verbose</code>th
iteration.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_ret.beta">ret.beta</code></td>
<td>
<p>A character indicating how the posterior draws of beta should be  
handled: '<code>r</code>'eturn as an R object, '<code>s</code>'ave as .txt.gz
files, '<code>d</code>'iscard (defaults to <code>r</code>).</p>
</td></tr>  
<tr><td><code id="ei.MD.bayes_+3A_ret.mcmc">ret.mcmc</code></td>
<td>
<p>A logical value indicating how the samples from the posterior 
should be returned.  If <code>TRUE</code> (default), samples are returned as
coda <code>mcmc</code> objects.  If <code>FALSE</code>, samples are returned as arrays.</p>
</td></tr>
<tr><td><code id="ei.MD.bayes_+3A_usrfun">usrfun</code></td>
<td>
<p>the name of an optional a user-defined function to obtain quantities of
interest while drawing from the MCMC chain (defaults to <code>NULL</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ei.MD.bayes</code> implements a version of the hierarchical
Multinomial-Dirichlet model for ecological inference in <code class="reqn">R
    \times C</code> tables suggested by Rosen et al. (2001).
</p>
<p>Let <code class="reqn">r = 1, \ldots, R</code> index rows, <code class="reqn">C = 1,
    \ldots, C</code> index columns, and <code class="reqn">i = 1, \ldots,
    n</code> index units.  Let <code class="reqn">N_{\cdot ci}</code> be the
marginal count for column <code class="reqn">c</code> in unit <code class="reqn">i</code> and <code class="reqn">X_{ri}</code> be the
marginal proportion for row <code class="reqn">r</code> in unit <code class="reqn">i</code>.  Finally, let
<code class="reqn">\beta_{rci}</code> be the proportion of row <code class="reqn">r</code> in column <code class="reqn">c</code>
for unit <code class="reqn">i</code>.
</p>
<p>The first stage of the model assumes that the vector of column
marginal counts in unit <code class="reqn">i</code> follows a Multinomial distribution of the
form:
</p>
<p style="text-align: center;"><code class="reqn">(N_{\cdot 1i}, \ldots, N_{\cdot Ci}) {\sim}
    {\rm Multinomial}(N_i,\sum_{r=1}^R \beta_{r1i}X_{ri}, \dots,
    \sum_{r=1}^R \beta_{rCi}X_{ri})</code>
</p>

<p>The second stage of the model assumes that the vector of
<code class="reqn">\beta</code> for row <code class="reqn">r</code> in unit <code class="reqn">i</code> follows a Dirichlet
distribution with <code class="reqn">C</code> parameters.  The model may be fit with or
without a covariate. 
</p>
<p>If the model is fit without a covariate, the distribution of the vector
<code class="reqn">\beta_{ri}</code> is :
</p>
<p style="text-align: center;"><code class="reqn">(\beta_{r1i}, \dots, \beta_{rCi}) {\sim} {\rm
      Dirichlet}(\alpha_{r1}, \dots, \alpha_{rC})</code>
</p>

<p>In this case, the prior on each <code class="reqn">\alpha_{rc}</code> is assumed
to be:
</p>
<p style="text-align: center;"><code class="reqn">\alpha_{rc} \sim {\rm Gamma}(\lambda_1, \lambda_2)</code>
</p>

<p>If the model is fit with a covariate, the  distribution of the vector
<code class="reqn">\beta_{ri}</code> is :
</p>
<p style="text-align: center;"><code class="reqn">(\beta_{r1i}, \dots, \beta_{rCi}) {\sim} {\rm
      Dirichlet}(d_r\exp(\gamma_{r1} + \delta_{r1}Z_i),
    d_r\exp(\gamma_{r(C-1)} + \delta_{r(C-1)}Z_i), d_r)</code>
</p>

<p>The parameters <code class="reqn">\gamma_{rC}</code> and
<code class="reqn">\delta_{rC}</code> are constrained to be zero for
identification.  (In this function, the last column entered in the
formula is so constrained.)
</p>
<p>Finally, the prior for <code class="reqn">d_r</code> is: 
</p>
<p style="text-align: center;"><code class="reqn">d_r \sim {\rm Gamma}(\lambda_1, \lambda_2)</code>
</p>

<p>while <code class="reqn">\gamma_{rC}</code> and <code class="reqn">\delta_{rC}</code> are
given improper uniform priors if <code>covariate.prior.list = NULL</code> or
have independent normal priors of the form:
</p>
<p style="text-align: center;"><code class="reqn">\delta_{rC} \sim {\rm N}(\mu_{\delta_{rC}},
     \sigma_{\delta_{rC}}^2)</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma_{rC} \sim {\rm N}(\mu_{\gamma_{rC}},
     \sigma_{\gamma_{rC}}^2)</code>
</p>

<p>If the user wishes to estimate the model with proper normal priors on
<code class="reqn">\gamma_{rC}</code> and <code class="reqn">\delta_{rC}</code>, a list
with four elements must be provided for <code>covariate.prior.list</code>:
</p>

<ul>
<li><p><code>mu.delta</code> an <code class="reqn">R \times (C-1)</code> matrix of
prior means for Delta
</p>
</li>
<li><p><code>sigma.delta</code> an <code class="reqn">R \times (C-1)</code> matrix of
prior standard deviations for Delta 
</p>
</li>
<li><p><code>mu.gamma</code> an <code class="reqn">R \times (C-1)</code> matrix of
prior means for Gamma 
</p>
</li>
<li><p><code>sigma.gamma</code> an <code class="reqn">R \times (C-1)</code> matrix of
prior standard deviations for Gamma</p>
</li></ul>
  
<p>Applying the model without a covariate is
most reasonable in situations where one can think of individuals being
randomly assigned to units, so that there are no aggregation or
contextual effects.  When this assumption is not reasonable,
including an appropriate covariate may improve inferences; note,
however, that there is typically little information in the data about
the relationship of any given covariate to the unit parameters, which can
lead to extremely slow mixing of the MCMC chains and difficulty in
assessing convergence.
</p>
<p>Because the conditional distributions are non-standard, draws from the
posterior are obtained by using a Metropolis-within-Gibbs algorithm.
The proposal density for each parameter is a univariate normal
distribution centered at the current parameter value with standard
deviation equal to the tuning constant; the only exception is for
draws of <code class="reqn">\gamma_{rc}</code> and <code class="reqn">\delta_{rc}</code>, which
use a bivariate normal proposal with covariance zero.  
</p>
<p>The function will accept user-specified starting values as an argument.
If the model includes a covariate, the starting values must be a list
with the following elements, in this order:
</p>

<ul>
<li><p><code>start.dr</code> a vector of length <code class="reqn">R</code> of starting values for Dr.
Starting values for Dr must be greater than zero.
</p>
</li>
<li><p><code>start.betas</code> an <code class="reqn">R \times C</code> by precincts array
of starting values for Beta.  Each row of every precinct must sum to 1.
</p>
</li>
<li><p><code>start.gamma</code> an <code class="reqn">R \times C</code> matrix of starting
values for Gamma.  Values in the right-most column must be zero.
</p>
</li>
<li><p><code>start.delta</code> an <code class="reqn">R \times C</code> matrix of starting
values for Delta.  Values in the right-most column must be zero.
</p>
</li></ul>

<p>If there is no covariate, the starting values must be a list with the following elements:
</p>

<ul>
<li><p><code>start.alphas</code> an <code class="reqn">R \times C</code> matrix of starting values for Alpha.  Starting values for Alpha must be greater than zero.
</p>
</li>
<li><p><code>start.betas</code> an <code class="reqn">R \times C \times</code> units array of
starting values for Beta.  Each row in every unit must sum to 1.</p>
</li></ul>

<p>The function will accept user-specified tuning parameters as an
argument.  The tuning parameters define the standard deviation of the
normal distribution used to generate candidate values for each
parameter.  For the model with a covariate, a bivariate normal
distribution is used to generate proposals; the covariance of these
normal distributions is fixed at zero.  If the model includes a covariate, the tuning parameters must be a list with the following elements, in this order:
</p>

<ul>
<li><p><code>tune.dr</code> a vector of length <code class="reqn">R</code> of tuning parameters for Dr
</p>
</li>
<li><p><code>tune.beta</code> an <code class="reqn">R \times (C-1)</code> by precincts array
of tuning parameters for Beta 
</p>
</li>
<li><p><code>tune.gamma</code> an <code class="reqn">R \times (C-1)</code> matrix of tuning
parameters for Gamma 
</p>
</li>
<li><p><code>tune.delta</code> an <code class="reqn">R \times (C-1)</code> matrix of tuning
parameters for Delta</p>
</li></ul>
 
<p>If there is no covariate, the tuning parameters are a list with the following elements:
</p>

<ul>
<li><p><code>tune.alpha</code> an <code class="reqn">R \times C</code> matrix of tuning parameters for Alpha
</p>
</li>
<li><p><code>tune.beta</code> an <code class="reqn">R \times (C-1)</code> by precincts array
of tuning parameters for Beta
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing 
</p>
<table>
<tr><td><code>draws</code></td>
<td>
<p>A list containing samples from the posterior distribution
of the parameters.  If a covariate is included in the model, the list contains: 
</p>

<ul>
<li><p><code>Dr</code> Posterior draws for Dr parameters as an R
<code class="reqn">\times</code>sample matrix.  If
<code>ret.mcmc = TRUE</code>, <code>Dr</code> is an <code>mcmc</code> object.
</p>
</li>
<li><p><code>Beta</code> Posterior draws for beta parameters.  Only returned if 
<code>ret.beta = TRUE</code>.  If <code>ret.mcmc = 
TRUE</code>, a  (R * C * units) <code class="reqn">\times</code> sample matrix saved as an <code>mcmc</code> 
object.  Otherwise, a R <code class="reqn">\times</code> C <code class="reqn">\times</code> units
<code class="reqn">\times</code> sample array
</p>
</li>
<li><p><code>Gamma</code> Posterior draws for gamma parameters.  If <code>ret.mcmc =
TRUE</code>, a  (R * (C - 1)) <code class="reqn">\times</code> sample matrix saved as an <code>mcmc</code>
object.  Otherwise, a R <code class="reqn">\times</code> (C - 1) <code class="reqn">\times</code> sample array
</p>
</li>
<li><p><code>Delta</code> Posterior draws for delta parameters.  If <code>ret.mcmc =                 
TRUE</code>, a  (R * (C - 1)) <code class="reqn">\times</code> sample matrix saved as an <code>mcmc</code>      
object.  Otherwise, a R <code class="reqn">\times</code>(C - 1) <code class="reqn">\times</code> sample array
</p>
</li>
<li><p><code>Cell.count</code> Posterior draws for the cell counts, summed
across units.  If <code>ret.mcmc =
    TRUE</code>, a (R * C) <code class="reqn">\times</code> sample matrix saved as an <code>mcmc</code> object.
Otherwise, a R <code class="reqn">\times</code> C <code class="reqn">\times</code> sample array
</p>
</li></ul>

<p>If the model is fit without a covariate, the list includes:
</p>

<ul>
<li><p><code>Alpha</code> Posterior draws for alpha parameters.  If <code>ret.mcmc =
    TRUE</code>, a (R * C) <code class="reqn">\times</code> sample matrix saved as an <code>mcmc</code> object.
Otherwise, a R <code class="reqn">\times</code> C <code class="reqn">\times</code> sample array
</p>
</li>
<li><p><code>Beta</code> Posterior draws for beta parameters.  If <code>ret.mcmc =
    TRUE</code>, a (R * C * units) <code class="reqn">\times</code> sample matrix saved as
an <code>mcmc</code> object. 
Otherwise, a R <code class="reqn">\times</code> C <code class="reqn">\times</code> units
<code class="reqn">\times</code> sample array 
</p>
</li>
<li><p><code>Cell.count</code> Posterior draws for the cell counts, summed
across units.  If <code>ret.mcmc =
    TRUE</code>, a (R * C) <code class="reqn">\times</code> sample matrix saved as an<code>mcmc</code> object.
Otherwise, a R <code class="reqn">\times</code> C <code class="reqn">\times</code> sample array
</p>
</li></ul>
</td></tr>
<tr><td><code>acc.ratios</code></td>
<td>
<p> A list containing acceptance ratios for the
parameters.  If the model includes a covariate, the list includes:
</p>
  
<ul>
<li><p><code>dr.acc</code> A vector of acceptance ratios for <code>Dr</code> draws
</p>
</li>
<li><p><code>beta.acc</code> A vector of acceptance ratios for <code>Beta</code> draws
</p>
</li>
<li><p><code>gamma.acc</code> A vector of acceptance ratios for <code>Gamma</code> and
<code>Delta</code> draws
</p>
</li></ul>

<p>If the model is fit without a covariate , the list includes:
</p>

<ul>
<li><p><code>alpha.acc</code> A vector of acceptance ratios for <code>Alpha</code> draws
</p>
</li>
<li><p><code>beta.acc</code> A vector of acceptance ratios for <code>Beta</code> draws  
</p>
</li></ul>
</td></tr>
<tr><td><code>usrfun</code></td>
<td>
<p>Output from the optional <code>usrfn</code></p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call to <code>ei.MD.bayes</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Kellermann &lt;<a href="mailto:mrkellermann@gmail.com">mrkellermann@gmail.com</a>&gt; and Olivia Lau 
&lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt;
</p>


<h3>References</h3>

<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2002.
<em>Output Analysis and Diagnostics for MCMC (CODA)</em>. <a href="https://CRAN.R-project.org/package=coda">https://CRAN.R-project.org/package=coda</a>.
</p>
<p>Ori Rosen, Wenxin Jiang, Gary King, and Martin A. Tanner.
2001.  &ldquo;Bayesian and Frequentist Inference for Ecological
Inference: The <code class="reqn">R \times (C-1)</code> Case.&rdquo; 
<em>Statistica Neerlandica</em> 55: 134-156.  </p>


<h3>See Also</h3>

<p><code><a href="#topic+lambda.MD">lambda.MD</a></code>, <code><a href="#topic+cover.plot">cover.plot</a></code>, 
<code><a href="#topic+density.plot">density.plot</a></code>, <code><a href="#topic+tuneMD">tuneMD</a></code>, 
<code><a href="#topic+mergeMD">mergeMD</a></code></p>

<hr>
<h2 id='ei.reg'>Ecological regression</h2><span id='topic+ei.reg'></span>

<h3>Description</h3>

<p> Estimate an ecological regression using least squares. </p>


<h3>Usage</h3>

<pre><code class='language-R'>ei.reg(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ei.reg_+3A_formula">formula</code></td>
<td>
<p>An R formula object of the form <code>cbind(c1, c2, ...)
    ~ cbind(r1, r2, ...)</code></p>
</td></tr> 
<tr><td><code id="ei.reg_+3A_data">data</code></td>
<td>
<p>data frame containing the variables specified in <code>formula</code></p>
</td></tr>
<tr><td><code id="ei.reg_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="stats.html#topic+lm">lm</a></code>. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>For <code class="reqn">i \in 1,\ldots,C</code>, C regressions of the form
<code>c_i ~ cbind(r1, r2, ...)</code> are performed.
</p>
<p>These regressions make use of the accounting identities
and the constancy assumption, that <code class="reqn">\beta_{rci} =
    \beta_{rc}</code> for all <code class="reqn">i</code>.
</p>
<p>The accounting identities include
</p>

<ul>
<li><p>&ndash;defining the population cell fractions
<code class="reqn">\beta_{rc}</code> such that <code class="reqn">\sum_{c=1}^{C} \beta_{rc}
      =  1</code> for every <code class="reqn">r</code>
</p>
</li>
<li><p>&ndash;<code class="reqn">\sum_{c=1}^{C} \beta_{rci}  =  1</code> for <code class="reqn">r = 1, \ldots, R</code> and <code class="reqn">i = 1, \ldots,
      n</code>
</p>
</li>
<li><p>&ndash;<code class="reqn">T_{ci} = \sum_{r=1}^R \beta_{rci}X_{ri}</code> for <code class="reqn">c = 1,\ldots,C</code> and <code class="reqn">i =
      1\ldots,n</code>
</p>
</li></ul>

<p>Then regressing </p>
<p style="text-align: center;"><code class="reqn">T_{ci} = \beta_{rc} X_{ri} + \epsilon_{ci}</code>
</p>
<p> for <code class="reqn">c = 1,\dots,C</code>
recovers the population parameters <code class="reqn">\beta_{rc}</code> when the
standard linear regression assumptions apply, including
<code class="reqn">E[\epsilon_{ci}] = 0</code> and
<code class="reqn">Var[\epsilon_{ci}] = \sigma_c^2</code> for
all <code class="reqn">i</code>.
</p>


<h3>Value</h3>

<p>A list containing 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to <code>ei.reg</code></p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>an <code class="reqn">R \times C</code> matrix of estimated
population cell fractions</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>an <code class="reqn">R \times C</code> matrix of standard errors
for <code>coefficients</code>.</p>
</td></tr>
<tr><td><code>cov.matrices</code></td>
<td>
<p>A list of the <code class="reqn">C</code> scaled variance-covariance
matrices for each of the ecological regressions</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt; and Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>References</h3>

<p>Leo Goodman. 1953. &ldquo;Ecological Regressions and the Behavior of Individuals.&rdquo;
<em>American Sociological Review</em> 18:663&ndash;664.
</p>

<hr>
<h2 id='ei.reg.bayes'>Ecological regression using Bayesian Normal regression</h2><span id='topic+ei.reg.bayes'></span>

<h3>Description</h3>

<p> Estimate an ecological regression using Bayesian normal 
regression. </p>


<h3>Usage</h3>

<pre><code class='language-R'>ei.reg.bayes(formula, data, sample = 1000, weights = NULL, truncate=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ei.reg.bayes_+3A_formula">formula</code></td>
<td>
<p>An R formula object of the form <code>cbind(c1, c2, ...)
    ~ cbind(r1, r2, ...)</code></p>
</td></tr>
<tr><td><code id="ei.reg.bayes_+3A_data">data</code></td>
<td>
<p>data frame containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="ei.reg.bayes_+3A_sample">sample</code></td>
<td>
<p>number of draws from the posterior</p>
</td></tr>
<tr><td><code id="ei.reg.bayes_+3A_weights">weights</code></td>
<td>
<p>a vector of weights</p>
</td></tr>
<tr><td><code id="ei.reg.bayes_+3A_truncate">truncate</code></td>
<td>
<p>if TRUE, imposes a proper uniform prior on the unit
hypercube for the coefficients; if FALSE, an improper uniform prior is assumed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code class="reqn">i \in 1,\ldots,C</code>, <code class="reqn">C</code> Bayesian regressions
of the form <code>c_i ~ cbind(r1, r2, ...)</code> are
performed.  See the documentation for <code>ei.reg</code> for the accounting
identities and constancy assumption underlying this Bayesian linear
model.
</p>
<p>The sampling density is given by </p>
<p style="text-align: center;"><code class="reqn">y|\beta, \sigma^2, X \sim
    N(X\beta, \sigma^2 I)</code>
</p>

<p>The improper prior is <code class="reqn">p(\beta,\sigma^2|X)\propto
    \sigma^{-2}</code>.
</p>
<p>The proper prior is <code class="reqn">p(\beta, \sigma^2|x) \propto I(\beta \in
    [0,1])\times \sigma^{-2}</code>.
</p>


<h3>Value</h3>

<p> A list containing 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to <code>ei.reg.bayes</code></p>
</td></tr>
<tr><td><code>draws</code></td>
<td>
<p>A, <code class="reqn">R \times C \times</code> sample array containing
posterior draws for each population cell fraction</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt; and Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>References</h3>

<p>Leo Goodman. 1953. &ldquo;Ecological Regressions and the Behavior of Individuals.&rdquo;
<em>American Sociological Review</em> 18:663&ndash;664.
</p>

<hr>
<h2 id='lambda.MD'>Calculate shares using data from MD model</h2><span id='topic+lambda.MD'></span>

<h3>Description</h3>

<p>Calculates the population share of row members in a
particular column as a proportion of the total number of row members in the selected subset of columns.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.MD(object, columns, ret.mcmc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.MD_+3A_object">object</code></td>
<td>
<p>an R object of class <code>eiMD</code>, output from <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>
</td></tr>
<tr><td><code id="lambda.MD_+3A_columns">columns</code></td>
<td>
<p>a character vector of column names to be included in
calculating the shares</p>
</td></tr> 
<tr><td><code id="lambda.MD_+3A_ret.mcmc">ret.mcmc</code></td>
<td>
<p>a logical value indicating how the samples from the posterior 
should be returned.  If <code>TRUE</code> (default), samples are returned as <code>mcmc</code> 
objects.  If <code>FALSE</code>, samples are returned as arrays. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows users to define subpopulations within the
data and calculate the proportion of individuals within each of the
columns that defines that subpopulation.  For example, if the model
includes the groups Democrat, Republican, and Unaffiliated, the
argument <code>columns = c(``Democrat", ``Republican")</code> will calculate
the two-party shares of Democrats and Republicans for each row.
</p>


<h3>Value</h3>

<p>Returns either a ((<code class="reqn">R</code> * included columns) <code class="reqn">\times</code>
samples) matrix as an <code>mcmc</code> object or a (<code class="reqn">R \times</code>
included columns <code class="reqn">\times</code> samples) array. 
</p>


<h3>Author(s)</h3>

<p>Michael Kellermann &lt;<a href="mailto:mrkellermann@gmail.com">mrkellermann@gmail.com</a>&gt; and Olivia Lau 
&lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>

<hr>
<h2 id='lambda.reg'>Calculate shares using data from regression model</h2><span id='topic+lambda.reg'></span>

<h3>Description</h3>

<p>Calculates the population share of row members in a particular column</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.reg(object, columns) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.reg_+3A_object">object</code></td>
<td>
<p>An R object of class <code>eiReg</code>, the output from <code><a href="#topic+ei.reg">ei.reg</a></code></p>
</td></tr>
<tr><td><code id="lambda.reg_+3A_columns">columns</code></td>
<td>
<p>a character vector of column names to be included in calculating
the shares</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard errors are calculated using the delta method as implemented in
the library <code>msm</code>.  The arguments passed to
<code>deltamethod</code> in <code>msm</code> include 
</p>

<ul>
<li><p><code>g</code>a list of transformations of the form <code>~ x1 / (x1 + x2 +
      + ... + xk)</code>, <code>~ x2 / (x1 + x2 + ... + xk)</code>, etc.. Each
<code class="reqn">x_c</code> is the estimated proportion of all row members in column
<code class="reqn">c</code>, <code class="reqn">\hat{\beta}_{rc}</code>
</p>
</li>
<li><p><code>mean</code>the estimated proportions of the row members in the
specified columns, as a proportion of the total number of row
members, <code class="reqn">(\hat{\beta}_{r1}, \hat{\beta}_{r2}, ...,
	\hat{\beta}_{rk})</code>. 
</p>
</li>
<li><p><code>cov</code>a diagonal matrix with the estimated variance of each
<code class="reqn">\hat{\beta}_{rc}</code> on the diagonal.  Each column
marginal is assumed to be independent, such that the off-diagonal
elements of this matrix are zero.  Estimates come from
<code>object$cov.matrices</code>, the estimated covariance matrix from
the regression of the relevant column.  Thus,

</p>
</li></ul>


<table>
<tr>
 <td style="text-align: center;">
      cov </td><td style="text-align: center;"> = </td><td style="text-align: center;"> <code class="reqn">Var(\hat{\beta}_{r1})</code> </td><td style="text-align: center;"> 0
      </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> <code class="reqn">\ldots</code> </td>
</tr>
<tr>
 <td style="text-align: center;"> 
</td><td style="text-align: center;"> </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> <code class="reqn">Var(\hat{\beta}_{r2})</code> </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> <code class="reqn">\ldots</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
</td><td style="text-align: center;"> </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> <code class="reqn">Var(\hat{\beta}_{r3})</code> </td><td style="text-align: center;"> <code class="reqn">\ldots</code> </td>
</tr>
<tr>
 <td style="text-align: center;">
</td><td style="text-align: center;"> </td><td style="text-align: center;"> <code class="reqn">\vdots</code> </td><td style="text-align: center;"> <code class="reqn">\vdots</code> </td><td style="text-align: center;"> <code class="reqn">\vdots</code> </td><td style="text-align: center;"> <code class="reqn">\ddots</code></td>
</tr>
<tr>
 <td style="text-align: center;">
  </td>
</tr>

</table>



<h3>Value</h3>

<p>Returns a list with the following elements 
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to <code>lambda.reg</code></p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>an <code class="reqn">R \times k</code> matrix 
where <code class="reqn">k</code> is the
number of columns included in the share calculation</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>standard errors calculated using the delta method as implemented 
in the library <code>msm</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.reg">ei.reg</a></code></p>

<hr>
<h2 id='lambda.reg.bayes'>Calculate shares using data from Bayesian regression model</h2><span id='topic+lambda.reg.bayes'></span>

<h3>Description</h3>

<p>Calculates the population share of row members in selected columns</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.reg.bayes(object, columns, ret.mcmc = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.reg.bayes_+3A_object">object</code></td>
<td>
<p>An R object of class <code>eiRegBayes</code>, the output from <code><a href="#topic+ei.reg.bayes">ei.reg.bayes</a></code></p>
</td></tr>
<tr><td><code id="lambda.reg.bayes_+3A_columns">columns</code></td>
<td>
<p>a character vector indicating which column marginals to be included in calculating the shares</p>
</td></tr>
<tr><td><code id="lambda.reg.bayes_+3A_ret.mcmc">ret.mcmc</code></td>
<td>
<p>If TRUE, posterior shares are returned as an <code>mcmc</code>
object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>ret.mcmc = TRUE</code>, draws are returned as an <code>mcmc</code> object
with dimensions sample <code class="reqn">\times C</code>.  If <code>ret.mcmc =
    FALSE</code>, draws are returned as an array with dimensions <code class="reqn">R
    \times C \times </code> samples array.  
</p>


<h3>Author(s)</h3>

<p>Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.reg.bayes">ei.reg.bayes</a></code></p>

<hr>
<h2 id='mergeMD'>Combine output from multiple eiMD objects</h2><span id='topic+mergeMD'></span>

<h3>Description</h3>

<p>Allows users to combine output from several chains
output by <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeMD(list, discard = 0) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mergeMD_+3A_list">list</code></td>
<td>
<p>A list containing the names of multiple eiMD objects
generated from the same model.</p>
</td></tr>
<tr><td><code id="mergeMD_+3A_discard">discard</code></td>
<td>
<p>The number of draws to discard from the beginning of each chain.  
Default is to retain all draws.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an <code>eiMD</code> object of the same format as the input.
</p>


<h3>Author(s)</h3>

<p>Michael Kellermann &lt;<a href="mailto:mrkellermann@gmail.com">mrkellermann@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Martyn Plummer, Nicky Best, Kate Cowles, and Karen Vines. 2002.
<em>Output Analysis and Diagnostics for MCMC (CODA)</em>. <a href="https://CRAN.R-project.org/package=coda">https://CRAN.R-project.org/package=coda</a>.
</p>
<p>Ori Rosen, Wenxin Jiang, Gary King, and Martin A. Tanner.
2001.  &ldquo;Bayesian and Frequentist Inference for Ecological
Inference: The <code class="reqn">R \times C</code> Case.&rdquo; <em>Statistica
Neerlandica</em> 55: 134-156.  </p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>

<hr>
<h2 id='plot.bounds'>Plot of deterministic bounds for units satisfying row thresholds</h2><span id='topic+plot'></span><span id='topic+plot.bounds'></span>

<h3>Description</h3>

<p>Plots the deterministic bounds on the proportion of
row members within a specified column.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bounds'
plot(x, row, column, labels = TRUE, order = NULL,
    intersection = TRUE, xlab, ylab, col = par("fg"), 
    lty = par("lty"), lwd = par("lwd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bounds_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+bounds">bounds</a></code></p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_row">row</code></td>
<td>
<p>a character string specifying the row of interest</p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_column">column</code></td>
<td>
<p>a character string specifying the column of interest</p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_labels">labels</code></td>
<td>
<p>a logical toggle specifying whether precinct labels should
be printed above interval bounds</p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_order">order</code></td>
<td>
<p>an optional vector of values between 0 and 1 specifying
the order (left-to-right) in which interval bounds are plotted</p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_intersection">intersection</code></td>
<td>
<p>a logical toggle specifying whether the
intersection of all plotted bounds (if it exists) should be plotted</p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_xlab">xlab</code>, <code id="plot.bounds_+3A_ylab">ylab</code>, <code id="plot.bounds_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code></p>
</td></tr>
<tr><td><code id="plot.bounds_+3A_col">col</code>, <code id="plot.bounds_+3A_lty">lty</code>, <code id="plot.bounds_+3A_lwd">lwd</code></td>
<td>
<p>additional arguments passed to <code>segments</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with vertical intervals indicating the deterministic bounds on
the quantity of interest, and (optionally) a single horizontal
interval indicating the intersection of these unit bounds.
</p>


<h3>Author(s)</h3>

<p>Ryan T. Moore &lt;<a href="mailto:rtm@american.edu">rtm@american.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code>bounds</code></p>

<hr>
<h2 id='read.betas'>Function to read in eiMD parameter chains saved to disk</h2><span id='topic+read.betas'></span>

<h3>Description</h3>

<p>In <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code>, users have the option to save parameter
chains for the unit-level betas to disk rather than returning them to
the workspace.  This function reconstructs the parameter chains by
reading them back into R and producing either an array or an
<code>mcmc</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.betas(rows, columns, units, dir = NULL, ret.mcmc = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.betas_+3A_rows">rows</code></td>
<td>
<p>a character vector of the row marginals to be read back
in</p>
</td></tr>
<tr><td><code id="read.betas_+3A_columns">columns</code></td>
<td>
<p>a character vector of the column marginals to be read
back in</p>
</td></tr>
<tr><td><code id="read.betas_+3A_units">units</code></td>
<td>
<p>a character of numeric vector with the units to be read
back in</p>
</td></tr>
<tr><td><code id="read.betas_+3A_dir">dir</code></td>
<td>
<p>an optional character string identifying the directory in
which parameter chains are stored (defaults to <code>getwd</code>)</p>
</td></tr>
<tr><td><code id="read.betas_+3A_ret.mcmc">ret.mcmc</code></td>
<td>
<p>a logical value specifying whether to return the
parameters as an <code>mcmc</code> object (defaults to <code>TRUE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>ret.mcmc = TRUE</code>, an <code>mcmc</code> object with row names
corresponding to the parameter chains.  If <code>ret.mcmc = FALSE</code>, an
array with dimensions named according to the selected <code>rows</code>,
<code>columns</code>, and <code>units</code>. 
</p>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;olivia.lau@post.harvard.edu&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code>,<code>mcmc</code></p>

<hr>
<h2 id='redistrict'>Redistricting Monte-Carlo data</h2><span id='topic+redistrict'></span>

<h3>Description</h3>

<p> Precinct-level observations for a hypothetical jurisdiction 
with four proposed districts.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(redistrict)</code></pre>


<h3>Format</h3>

<p>A table containing 150 observations and 9 variables:  
</p>

<dl>
<dt>precinct</dt><dd><p>precinct identifier</p>
</dd>
<dt>district</dt><dd><p>proposed district number</p>
</dd>
<dt>avg.age</dt><dd><p>average age</p>
</dd>
<dt>per.own</dt><dd><p>percent homeowners</p>
</dd>
<dt>black</dt><dd><p>number of black voting age persons</p>
</dd>
<dt>white</dt><dd><p>number of white voting age persons</p>
</dd>
<dt>hispanic</dt><dd><p>number of hispanic voting age persons</p>
</dd>
<dt>total</dt><dd><p>total number of voting age persons</p>
</dd>
<dt>dem</dt><dd><p>Number of votes for the Democratic candidate</p>
</dd>
<dt>rep</dt><dd><p>Number of votes for the Republican candidate</p>
</dd>
<dt>no.vote</dt><dd><p>Number of non voters</p>
</dd>
</dl>


<h3>Source</h3>

<p>Daniel James Greiner</p>

<hr>
<h2 id='senc'>Party registration in south-east North Carolina</h2><span id='topic+senc'></span>

<h3>Description</h3>

<p> Registration data for White, Black, and Native American voters in 
eight counties of 
south-eastern North Carolina in 2001.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(senc)</code></pre>


<h3>Format</h3>

<p>A table containing 212 observations and 18 variables:  
</p>

<dl>
<dt>county</dt><dd><p>county name</p>
</dd>
<dt>precinct</dt><dd><p>precinct name</p>
</dd>
<dt>total</dt><dd><p>number of registered voters in precinct</p>
</dd>
<dt>white</dt><dd><p>number of White registered voters</p>
</dd>
<dt>black</dt><dd><p>number of Black registered voters</p>
</dd>
<dt>natam</dt><dd><p>number of Native American registered voters</p>
</dd>
<dt>dem</dt><dd><p>number of registered Democrats</p>
</dd>
<dt>rep</dt><dd><p>number of registered Republicans</p>
</dd>
<dt>other</dt><dd><p>number of registered voters without major party affiliation</p>
</dd>
<dt>whdem</dt><dd><p>number of White registered Democrats</p>
</dd>
<dt>whrep</dt><dd><p>number of White registered Republicans</p>
</dd>
<dt>whoth</dt><dd><p>number of White registered voters without major party affiliation</p>
</dd>
<dt>bldem</dt><dd><p>number of Black registered Democrats</p>
</dd>
<dt>blrep</dt><dd><p>number of Black registered Republicans</p>
</dd>
<dt>bloth</dt><dd><p>number of Black registered voters without major party affiliation</p>
</dd>
<dt>natamdem</dt><dd><p>number of Native American registered Democrats</p>
</dd>
<dt>natamrep</dt><dd><p>number of Native American registered Republicans</p>
</dd>
<dt>natamoth</dt><dd><p>number of Native American registered voters without major party 
affiliation</p>
</dd>
</dl>


<h3>Source</h3>

<p>Excerpted from North Carolina General Assembly 2001 redistricting data, 
https://www.ncleg.gov/Redistricting/BaseData2001
</p>

<hr>
<h2 id='tuneA'>Tuning parameters for alpha hyperpriors in RxC EI model</h2><span id='topic+tuneA'></span>

<h3>Description</h3>

<p> Tuning parameters for hyperpriors in RxC EI model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tuneA)</code></pre>


<h3>Format</h3>

<p>A table containing 3 rows and 3 columns.</p>

<hr>
<h2 id='tuneB'>Tuning parameters for the precinct level parameters in the RxC EI 
model</h2><span id='topic+tuneB'></span>

<h3>Description</h3>

<p> A vector containing tuning parameters for the precinct level 
parameters in the RxC EI model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tuneB)</code></pre>


<h3>Format</h3>

<p> A vector of length 3 x 2 x 150 containing the precinct level tuning 
parameters for the redistricting sample data.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tuneB)
tuneB &lt;- array(tuneB[[1]], dim = c(3, 2, 150))
</code></pre>

<hr>
<h2 id='tuneMD'>Generate tuning parameters for MD model</h2><span id='topic+tuneMD'></span>

<h3>Description</h3>

<p>An adaptive algorithm to generate tuning parameters for the MCMC 
algorithm implemented in <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code>.  Since we are 
drawing each parameter one at a time, target acceptance rates are between 0.4 to 0.6.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuneMD(formula, covariate = NULL, data, ntunes = 10, 
    totaldraws = 10000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tuneMD_+3A_formula">formula</code></td>
<td>
<p>A formula of the form <code>cbind(col1, col2, ...) ~ cbind(row1, row2, ...)</code> with rows as the predictor and columns 
as the response</p>
</td></tr>
<tr><td><code id="tuneMD_+3A_covariate">covariate</code></td>
<td>
<p>An R formula for the optional covariate in the form
<code>~ x</code></p>
</td></tr>
<tr><td><code id="tuneMD_+3A_data">data</code></td>
<td>
<p>data frame containing the variables specified in <code>formula</code> and
<code>covariate</code></p>
</td></tr>
<tr><td><code id="tuneMD_+3A_ntunes">ntunes</code></td>
<td>
<p>number of times to iterate the tuning algorithm</p>
</td></tr>
<tr><td><code id="tuneMD_+3A_totaldraws">totaldraws</code></td>
<td>
<p>number of iterations for each tuning run</p>
</td></tr>
<tr><td><code id="tuneMD_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing matrices of tuning parameters.
</p>


<h3>Author(s)</h3>

<p>Olivia Lau &lt;<a href="mailto:olivia.lau@post.harvard.edu">olivia.lau@post.harvard.edu</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ei.MD.bayes">ei.MD.bayes</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
