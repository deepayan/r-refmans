<!DOCTYPE html><html><head><title>Help for package nricens</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nricens}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#categorize'>
<p>Categorization of a continuous variable.</p></a></li>
<li><a href='#get.risk.coxph'>
<p>Calculate individual risks based on the Cox regression model.</p></a></li>
<li><a href='#get.risk.survreg'>
<p>Calculate individual risks based on the parametric survival regression</p>
model.</a></li>
<li><a href='#get.surv.km'>
<p>Calculate a survival probability at a given time by the standard</p>
Kaplan-Meier estimator.</a></li>
<li><a href='#get.uppdwn'>
<p>Determine <code>UP</code> and <code>DOWN</code> for the NRI calculation</p></a></li>
<li><a href='#get.uppdwn.bin'>
<p>Determine <code>UP</code> and <code>DOWN</code> for the NRI calculation</p></a></li>
<li><a href='#nribin'>
<p>NRI for binary models</p></a></li>
<li><a href='#nribin.count.main'>
<p>Estimate NRI by the counting method.</p></a></li>
<li><a href='#nricens'>
<p>NRI for time to event models</p></a></li>
<li><a href='#nricens-package'>
<p>R Functions to calculate NRI for comparing time to event and binary</p>
response models.</a></li>
<li><a href='#nricens.ipw.main'>
<p>Estimate NRI by the inverse probability weighting (IPW) method.</p></a></li>
<li><a href='#nricens.km.main'>
<p>Estimate NRI by the standard Kaplan-Meier method.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>NRI for Risk Prediction Models with Time to Event and Binary
Response Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-5-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Eisuke Inoue</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eisuke Inoue &lt;eisuke.inoue@marianna-u.ac.jp&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculating the net reclassification improvement (NRI) for risk prediction models with time to event and binary data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-30 10:13:48 UTC; inoue</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-30 10:40:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='categorize'>
Categorization of a continuous variable.
</h2><span id='topic+categorize'></span>

<h3>Description</h3>

<p>Internaly used function to categorize a continuous variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>categorize(dat, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="categorize_+3A_dat">dat</code></td>
<td>

<p>Numerical vector for a categorization.
</p>
</td></tr>
<tr><td><code id="categorize_+3A_threshold">threshold</code></td>
<td>

<p>Vector or scalar value(s) to determine the cutoff values for a categorization.
</p>
</td></tr>
</table>

<hr>
<h2 id='get.risk.coxph'>
Calculate individual risks based on the Cox regression model.
</h2><span id='topic+get.risk.coxph'></span>

<h3>Description</h3>

<p>This function estimates <code class="reqn">Pr\{T &lt; t_0\}</code> given covariates under the
Cox model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.risk.coxph(mdl, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.risk.coxph_+3A_mdl">mdl</code></td>
<td>

<p><code>coxph</code> object.
</p>
</td></tr>
<tr><td><code id="get.risk.coxph_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event (<code class="reqn">t_0</code>).
</p>
</td></tr>
</table>

<hr>
<h2 id='get.risk.survreg'>
Calculate individual risks based on the parametric survival regression
model.
</h2><span id='topic+get.risk.survreg'></span>

<h3>Description</h3>

<p>This function estimates <code class="reqn">Pr\{T &lt; t_0\}</code> given covariates under the
parametric survival model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.risk.survreg(mdl, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.risk.survreg_+3A_mdl">mdl</code></td>
<td>

<p><code>survreg</code> object.
</p>
</td></tr>
<tr><td><code id="get.risk.survreg_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event (<code class="reqn">t_0</code>).
</p>
</td></tr>
</table>

<hr>
<h2 id='get.surv.km'>
Calculate a survival probability at a given time by the standard
Kaplan-Meier estimator.
</h2><span id='topic+get.surv.km'></span>

<h3>Description</h3>

<p>This function estimates <code class="reqn">Pr\{T &gt; t_0\}</code> by the Kaplan-Meier
estimator. <code class="reqn">t_0</code> should be given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.surv.km(time, event, t0, subs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.surv.km_+3A_time">time</code></td>
<td>

<p>Vector of follow up times.
</p>
</td></tr>
<tr><td><code id="get.surv.km_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for censoring.
</p>
</td></tr>
<tr><td><code id="get.surv.km_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event (<code class="reqn">t_0</code>).
</p>
</td></tr>
<tr><td><code id="get.surv.km_+3A_subs">subs</code></td>
<td>

<p>Vector of logical values to determine which subjects to be used for
a calculation. When this option is not specified
(<code>subs = NULL</code>), all subjects are used for a calculation.
</p>
</td></tr>
</table>

<hr>
<h2 id='get.uppdwn'>
Determine <code>UP</code> and <code>DOWN</code> for the NRI calculation
</h2><span id='topic+get.uppdwn'></span>

<h3>Description</h3>

<p>Internaly used function to detemine subjects who belong to <code>UP</code>
and <code>DOWN</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.uppdwn(time, event, objs, flag.mdl, flag.prd, flag.rsk, t0, updown,
           cut, get.risk, msg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.uppdwn_+3A_time">time</code></td>
<td>

<p>Vector of follow up times.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for censoring.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_objs">objs</code></td>
<td>

<p>List of data.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_flag.mdl">flag.mdl</code>, <code id="get.uppdwn_+3A_flag.prd">flag.prd</code>, <code id="get.uppdwn_+3A_flag.rsk">flag.rsk</code></td>
<td>

<p>Logical values to determine the type of calculation based on the
input data.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_updown">updown</code></td>
<td>

<p>Character to specify the method to determine <code>UP</code> and
<code>DOWN</code>.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_cut">cut</code></td>
<td>

<p>Scalar or vector to specify the cutoff value(s) of predicted risks
for determining <code>UP</code> and <code>DOWN</code>.
See also <code>cut</code> in <code>nricens</code> or <code>nribin</code>.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_get.risk">get.risk</code></td>
<td>

<p>R function to calculate individual risks.
</p>
</td></tr>
<tr><td><code id="get.uppdwn_+3A_msg">msg</code></td>
<td>

<p>Logical value to display computation process.
Setting <code>FALSE</code> leads silent execution.
</p>
</td></tr>
</table>

<hr>
<h2 id='get.uppdwn.bin'>
Determine <code>UP</code> and <code>DOWN</code> for the NRI calculation
</h2><span id='topic+get.uppdwn.bin'></span>

<h3>Description</h3>

<p>Internaly used function to detemine subjects who belong to <code>UP</code>
and <code>DOWN</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.uppdwn.bin(event, objs, flag.mdl, flag.prd, flag.rsk, updown, cut,
               link, msg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.uppdwn.bin_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for non-event.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_objs">objs</code></td>
<td>

<p>List of data.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_flag.mdl">flag.mdl</code>, <code id="get.uppdwn.bin_+3A_flag.prd">flag.prd</code>, <code id="get.uppdwn.bin_+3A_flag.rsk">flag.rsk</code></td>
<td>

<p>Logical values to determine the type of calculation based on the
input data.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_updown">updown</code></td>
<td>

<p>Character to specify the method to determine <code>UP</code> and
<code>DOWN</code>.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_cut">cut</code></td>
<td>

<p>Scalar or vector to specify the cutoff value(s) of predicted risks
for determining <code>UP</code> and <code>DOWN</code>.
See also <code>cut</code> in <code>nricens</code> or <code>nribin</code>.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_link">link</code></td>
<td>

<p>Character to specify the link function for a glm fitting.
</p>
</td></tr>
<tr><td><code id="get.uppdwn.bin_+3A_msg">msg</code></td>
<td>

<p>Logical value to display computation process.
Setting <code>FALSE</code> leads silent execution.
</p>
</td></tr>
</table>

<hr>
<h2 id='nribin'>
NRI for binary models
</h2><span id='topic+nribin'></span>

<h3>Description</h3>

<p>This function estimates the NRI for competing risk prediction models
with binary response variable. <code>glm</code> objects, predictors, and
predicted risks can be used as input data for the calculation.
The risk category based NRI and the risk difference based NRI can be
calculated.
The percentile bootstrap method is used for an interval estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nribin(event = NULL, mdl.std = NULL, mdl.new = NULL, z.std = NULL, z.new = NULL,
       p.std = NULL, p.new = NULL, updown = "category", cut = NULL,
       link = "logit", niter = 1000, alpha = 0.05, msg = TRUE)
       
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nribin_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for non-event.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_mdl.std">mdl.std</code>, <code id="nribin_+3A_mdl.new">mdl.new</code></td>
<td>

<p><code>glm</code> objects corresponding to a standard and a new risk
prediction models, respectively.
Since predictors are extracted from these objects, <code>x=TRUE</code> is
required for a glm fitting.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_z.std">z.std</code>, <code id="nribin_+3A_z.new">z.new</code></td>
<td>

<p>Matrix of predictors for a standard and a new risk prediction
model, respectively.
Neither factor nor character nor missing values are allowed.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_p.std">p.std</code>, <code id="nribin_+3A_p.new">p.new</code></td>
<td>

<p>Vector of predicted risks from a standard and a new prediction
model, respectively.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_updown">updown</code></td>
<td>

<p>Character to specify the method to determine <code>UP</code> and
<code>DOWN</code>.
When <code>"category"</code> is specified (by default), the risk category
based NRI is calculated.
When <code>"diff"</code> is specified, the risk difference based NRI is
calculated.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_cut">cut</code></td>
<td>

<p>Scalar or vector values to specify the cutoff value(s) of predicted
risks for determining <code>UP</code> and <code>DOWN</code>.
For the risk category based NRI (<code>updown = "category"</code>), this
option corresponds to cutoff value(s) of risk categories.
For the risk difference based NRI (<code>updown = "diff"</code>), this
option corresponds to a cutoff value of a risk difference
(only scalar is allowed).
</p>
</td></tr>
<tr><td><code id="nribin_+3A_niter">niter</code></td>
<td>

<p>Scalar value to determine the number of bootstratp sampling. When
<code>0</code> is specified, an interval estimation is skipped.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_link">link</code></td>
<td>

<p>Character to specify a link function for a glm fitting.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_alpha">alpha</code></td>
<td>

<p>1-alpha confidence intervals are calcualted.
</p>
</td></tr>
<tr><td><code id="nribin_+3A_msg">msg</code></td>
<td>

<p>Logical value to display computation process.
Setting <code>FALSE</code> leads silent execution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either one set of the following arguments should be specified for the
NRI calculation: (<code>mdl.std</code>, <code>mdl.new</code>);
(<code>event</code>, <code>z.std</code>, <code>z.new</code>);
and (<code>event</code>, <code>p.std</code>, <code>p.new</code>).
</p>
<p>In the first set of the argument, (<code>mdl.std</code>, <code>mdl.new</code>),
fitted results are used for the NRI calculation.
<code>event</code>, <code>z.std</code>, and <code>z.new</code> are extracted from fitted
result objects.
The variance of model parameters are accounted for an interval
estimation of the NRI.
When <code>event</code> is specified in arguments, those specified is used
without extracting from <code>glm</code> object.
</p>
<p>In the second set of the argument, (<code>event</code>, <code>z.std</code>,
<code>z.new</code>), a standard and a new prediction models are fitted
inside this function with specified <code>link</code>.
The variance of model parameters are also accounted for an interval
estimation of the NRI.
</p>
<p>In the third set of the argument, (<code>event</code>, <code>p.std</code>,
<code>p.new</code>), predicted risks are used.
Since fit of prediction models are not conducted while in a bootstrap,
this can be used for a validation study by an external data source or
by a cross-validation.
</p>
<p>For the risk category based NRI calculation, cutoff values of risk
category can be specified by <code>cut</code>, which is a scalar for the
case of two risk categories and is a vector for the case of more than
two risk categories.
<code>UP</code> and <code>DOWN</code> are determined by the movement in risk
categories.
</p>
<p>For the risk difference based NRI calculation, cutoff values of risk
difference can also be specified by <code>cut</code>, where <code>UP</code> and
<code>DOWN</code> are defiend as <code class="reqn">p_{new} - p_{standard} &gt; \delta</code> and
<code class="reqn">p_{standard} - p_{new} &gt; \delta</code>, respectively.
<code class="reqn">p_{standard}</code> and <code class="reqn">p_{new}</code> are predicted individual risks
from a standard and a new prediction model, respectively, and
<code class="reqn">\delta</code> corresponds to <code>cut</code>.
The continuous NRI, which is the special version of the risk
difference based NRI, can be calculated by specifying both
<code>updown = "diff"</code> and <code>cut = 0</code>.
</p>
<p>Interval estimation is based on the percentile bootstrap method.
</p>


<h3>Value</h3>

<p>Returns a list of the following items:
</p>
<table>
<tr><td><code>nri</code></td>
<td>

<p>Point and interval estimates of the NRI and its components.
</p>
</td></tr>
<tr><td><code>mdl.std</code>, <code>mdl.new</code></td>
<td>

<p>Fitted <code>glm</code> objects corresponding to a standard and a new
prediction model, respectively.
These items are provided when prediction models are fitted inside
this function. Otherwise <code>NULL</code>.
</p>
</td></tr>
<tr><td><code>z.std</code>, <code>z.new</code></td>
<td>

<p>Predictors of a standard and a new prediction model, respectively.
These items are provided when they are extracted from <code>mdl.std</code>
and <code>mdl.new</code>. Otherwise <code>NULL</code>.
</p>
</td></tr>
<tr><td><code>p.std</code>, <code>p.new</code></td>
<td>

<p>Predicted risks by a standard and a new prediction model,
respectively.
</p>
</td></tr>
<tr><td><code>up</code>, <code>down</code></td>
<td>

<p>Logical values to show subjects who belong to <code>UP</code> and
<code>DOWN</code>, respectively.
</p>
</td></tr>
<tr><td><code>rtab</code>, <code>rtab.case</code>, <code>rtab.ctrl</code></td>
<td>

<p><code>table</code> objects corresponding to reclassification tables for all,
case, and control subjects, respectively.
These items are provided only when the risk category based NRI is
calculated and <code>msg = TRUE</code>.
</p>
</td></tr>
<tr><td><code>bootstrapsample</code></td>
<td>

<p>Results of each bootstrap sample.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## here consider pbc dataset in survival package as an example
library(survival)
dat = pbc[1:312,]
dat$sex = ifelse(dat$sex=='f', 1, 0)

## subjects censored before 2000 days are excluded
dat = dat[ dat$time &gt; 2000 | (dat$time &lt; 2000 &amp; dat$status == 2), ]

## predciting the event of 'death' before 2000 days
event = ifelse(dat$time &lt; 2000 &amp; dat$status == 2, 1, 0)

## standard prediction model: age, bilirubin, and albumin
z.std = as.matrix(subset(dat, select = c(age, bili, albumin)))

## new prediction model: age, bilirubin, albumin, and protime
z.new = as.matrix(subset(dat, select = c(age, bili, albumin, protime)))

## glm fit (logistic model)
mstd = glm(event ~ ., binomial(logit), data.frame(event, z.std), x=TRUE)
mnew = glm(event ~ ., binomial(logit), data.frame(event, z.new), x=TRUE)

## predicted risk
p.std = mstd$fitted.values
p.new = mnew$fitted.values

## Calculation of risk difference NRI using ('mdl.std', 'mdl.std').
nribin(mdl.std = mstd, mdl.new = mnew, cut = 0.02, niter = 0,
       updown = 'diff')

## Calculation of risk difference NRI using ('event', 'z.std', 'z.std').
nribin(event = event, z.std = z.std, z.new = z.new, cut = 0.02,
       niter = 0, updown = 'diff')

## Calculation of risk difference NRI using ('event', 'p.std', 'p.std').
nribin(event = event, p.std = p.std, p.new = p.new, cut = 0.02,
       niter = 0, updown = 'diff')

## Calculation of risk category NRI using ('mdl.std', 'mdl.std').
nribin(mdl.std = mstd, mdl.new = mnew, cut = c(0.2, 0.4),
       niter = 0, updown = 'category')
</code></pre>

<hr>
<h2 id='nribin.count.main'>
Estimate NRI by the counting method.
</h2><span id='topic+nribin.count.main'></span>

<h3>Description</h3>

<p>Internaly used function by <code>nribin</code>.
In the comparison for binary models, it is possible to use directly
when <code>UP</code> and <code>DOWN</code> subjects are known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nribin.count.main(event, upp, dwn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nribin.count.main_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for non-event.
</p>
</td></tr>
<tr><td><code id="nribin.count.main_+3A_upp">upp</code>, <code id="nribin.count.main_+3A_dwn">dwn</code></td>
<td>

<p>Vector of logical values to determine subjects who belong to
<code>UP</code> and <code>DOWN</code>, respectively.
</p>
</td></tr>
</table>

<hr>
<h2 id='nricens'>
NRI for time to event models
</h2><span id='topic+nricens'></span>

<h3>Description</h3>

<p>This function estimates the NRI for competing risk prediction models
with time to event variable. <code>coxph</code> object, <code>survreg</code>
object, predictors, and predicted risks can be used as input data for
the calculation.
The risk category based NRI and the risk difference based NRI can be
calculated.
Users can use several types of estimators to obtain point estimates of
the NRI and its components.
The percentile bootstrap method is used for an interval estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nricens(time = NULL, event = NULL, mdl.std = NULL, mdl.new = NULL,
        z.std = NULL, z.new = NULL, p.std = NULL, p.new = NULL, t0 = NULL,
        updown = "category", cut = NULL, point.method = "km",
        niter = 1000, alpha = 0.05, msg = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nricens_+3A_time">time</code></td>
<td>

<p>Vector of observed follow up times, <code class="reqn">X = \min(T, C)</code>.
<code class="reqn">T</code> is event time, and <code class="reqn">C</code> is censoring time.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for censoring.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_mdl.std">mdl.std</code>, <code id="nricens_+3A_mdl.new">mdl.new</code></td>
<td>

<p><code>coxph</code> or <code>survreg</code> objects corresponding to a standard
and a new risk prediction model, respectively.
Since predictors are extracted from these objects, <code>x=TRUE</code> is
required when fitting a Cox or a parametric survival model.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_z.std">z.std</code>, <code id="nricens_+3A_z.new">z.new</code></td>
<td>

<p>Matrix of predictors for a standard and a new risk prediction
model, respectively.
Neither factor nor character nor missing values are allowed.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_p.std">p.std</code>, <code id="nricens_+3A_p.new">p.new</code></td>
<td>

<p>Vector of predicted risks from a standard and a new prediction
model, respectively.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_updown">updown</code></td>
<td>

<p>Character to specify the method to determine <code>UP</code> and
<code>DOWN</code>.
When <code>"category"</code> is specified (by default), the risk category
based NRI is calculated.
When <code>"diff"</code> is specified, the risk difference based NRI is
calculated.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_cut">cut</code></td>
<td>

<p>Scalar or vector values to specify the cutoff value(s) of predicted
risks for determining <code>UP</code> and <code>DOWN</code>.
For the risk category based NRI (<code>updown = "category"</code>), this
option corresponds to cutoff value(s) of risk categories.
For the risk difference based NRI (<code>updown = "diff"</code>), this
option corresponds to a cutoff value of a risk difference
(only scalar is allowed).
</p>
</td></tr>
<tr><td><code id="nricens_+3A_point.method">point.method</code></td>
<td>

<p>Character to determine an estimator for a point estimation.
When <code>"km"</code> is specified, the Kaplan-Meier (KM) based NRI
estimator is used (Pencina et al., 2011). 
When <code>"ipw"</code> is specified, the inverse probability weighting
(IPW) NRI estimator is used (Uno et al., 2012).
</p>
</td></tr>
<tr><td><code id="nricens_+3A_niter">niter</code></td>
<td>

<p>Scalar value to determine the number of bootstratp sampling. When
<code>0</code> is specified, an interval estimation is skipped.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_alpha">alpha</code></td>
<td>

<p>1-alpha confidence interval is calcualted.
</p>
</td></tr>
<tr><td><code id="nricens_+3A_msg">msg</code></td>
<td>

<p>Logical value to display computation process.
Setting <code>FALSE</code> leads silent execution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either one set of the following arguments should be specified for the
NRI calculation: (<code>mdl.std</code>, <code>mdl.new</code>);
(<code>time</code>, <code>event</code>, <code>z.std</code>, <code>z.new</code>);
and (<code>time</code>, <code>event</code>, <code>p.std</code>, <code>p.new</code>).
</p>
<p>In the first set of the argument, (<code>mdl.std</code>, <code>mdl.new</code>),
fitted results by <code>coxph</code> or <code>survreg</code> are used for the NRI
calculation.
<code>time</code>, <code>event</code>, <code>z.std</code>, and <code>z.new</code> are
extracted from fitted result objects.
The variance of model parameters are accounted for an interval
estimation of the NRI.
When <code>time</code> and <code>event</code> are specified in arguments,
those specified are used without extracting from <code>coxph</code> or
<code>survreg</code> objects.
</p>
<p>In the second set of the argument, (<code>time</code>, <code>event</code>,
<code>z.std</code>, <code>z.new</code>), a standard and a new prediction models
are fitted inside this function with <code>time</code>, <code>event</code>,
<code>z.std</code> and <code>z.new</code>.
The variance of model parameters are also accounted for an interval
estimation of the NRI.
</p>
<p>In the third set of the argument, (<code>time</code>, <code>event</code>,
<code>p.std</code>, <code>p.new</code>), predicted risks are used.
Since fit of prediction models are not conducted while in a bootstrap,
this can be used for a validation study by an external data source or
by a cross-validation.
</p>
<p>For the risk category based NRI calculation, cutoff values of risk
category can be specified by <code>cut</code>, which is a scalar for the
case of two risk categories and is a vector for the case of more than
two risk categories.
<code>UP</code> and <code>DOWN</code> are determined by the movement in risk
categories.
</p>
<p>For the risk difference based NRI calculation, cutoff values of risk
difference can also be specified by <code>cut</code>, where <code>UP</code> and
<code>DOWN</code> are defiend as <code class="reqn">p_{new} - p_{standard} &gt; \delta</code> and
<code class="reqn">p_{standard} - p_{new} &gt; \delta</code>, respectively.
<code class="reqn">p_{standard}</code> and <code class="reqn">p_{new}</code> are predicted individual risks
from a standard and a new prediction model, respectively, and
<code class="reqn">\delta</code> corresponds to <code>cut</code>.
The continuous NRI, which is the special version of the risk
difference based NRI, can be calculated by specifying both
<code>updown = "diff"</code> and <code>cut = 0</code>.
</p>
<p>Interval estimation is based on the percentile bootstrap method.
</p>


<h3>Value</h3>

<p>Returns a list of the following items:
</p>
<table>
<tr><td><code>nri</code></td>
<td>

<p>Point and interval estimates of the NRI and its components.
</p>
</td></tr>
<tr><td><code>mdl.std</code>, <code>mdl.new</code></td>
<td>

<p>Fitted <code>coxph</code> or <code>survreg</code> objects corresponding to a
standard and a new prediction model, respectively.
These items are provided when prediction models are fitted inside
this function. Otherwise <code>NULL</code>.
</p>
</td></tr>
<tr><td><code>z.std</code>, <code>z.new</code></td>
<td>

<p>Predictors of a standard and a new prediction model, respectively.
These items are provided when they are extracted from <code>mdl.std</code>
and <code>mdl.new</code>. Otherwise <code>NULL</code>.
</p>
</td></tr>
<tr><td><code>p.std</code>, <code>p.new</code></td>
<td>

<p>Predicted risks by a standard and a new prediction model,
respectively.
</p>
</td></tr>
<tr><td><code>up</code>, <code>down</code></td>
<td>

<p>Logical values to show subjects who belong to <code>UP</code> and
<code>DOWN</code>, respectively.
</p>
</td></tr>
<tr><td><code>rtab</code>, <code>rtab.case</code>, <code>rtab.ctrl</code></td>
<td>

<p><code>table</code> objects corresponding to reclassification tables for all,
case, and control subjects, respectively.
These items are provided only when the risk category based NRI is
specified and <code>msg = TRUE</code>.
</p>
</td></tr>
<tr><td><code>bootstrapsample</code></td>
<td>

<p>Results of each bootstrap sample.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pencina MJ, D'Agostino RB, Steyerberg EW. Extensions of net
reclassification improvement calculations to measure usefulness of new
biomarkers. Statistics in Medicine 2011.
</p>
<p>Uno H, Tian L, Cai T, Kohane IS, Wei LJ. A unified inference procedure
for a class of measures to assess improvement in risk prediction systems
with survival data, Statistics in Medicine 2012.
</p>
<p>Hsu CH, Taylor JMG. A robust weighted Kaplan-Meier approach for data
with dependent censoring using linear combinations of prognostic
covariates, Statistics in Medicine 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## here consider pbc dataset in survival package as an example
library(survival)
dat = pbc[1:312,]
dat$sex = ifelse(dat$sex=='f', 1, 0)

## predciting the event of 'death'
time  = dat$time
event = ifelse(dat$status==2, 1, 0)

## standard prediction model: age, bilirubin, and albumin
z.std = as.matrix(subset(dat, select = c(age, bili, albumin)))

## new prediction model: age, bilirubin, albumin, and protime
z.new = as.matrix(subset(dat, select = c(age, bili, albumin, protime)))

## coxph fit
mstd = coxph(Surv(time,event) ~ ., data.frame(time,event,z.std), x=TRUE)
mnew = coxph(Surv(time,event) ~ ., data.frame(time,event,z.new), x=TRUE)

## predicted risk at t0=2000
p.std = get.risk.coxph(mstd, t0=2000)
p.new = get.risk.coxph(mnew, t0=2000)

## Calculation of risk category NRI
##   by the KM estimator using ('mdl.std', 'mdl.std').
nricens(mdl.std = mstd, mdl.new = mnew, t0 = 2000, cut = c(0.2, 0.4),
        niter = 0)

##   by the KM estimator using ('time', 'event', 'z.std', 'z.std').
nricens(time = time, event = event, z.std = z.std, z.new = z.new,
        t0 = 2000, cut = c(0.2, 0.4), niter = 0)

##   by the KM estimator using ('time','event','p.std','p.std').
nricens(time = time, event = event, p.std = p.std, p.new = p.new,
        t0 = 2000, cut = c(0.2, 0.4), niter = 0)

## Calculation of risk difference NRI by the KM estimator
nricens(mdl.std = mstd, mdl.new = mnew, t0 = 2000, updown = 'diff',
        cut = 0.05, niter = 0)

## Calculation of risk difference NRI by the IPW estimator
nricens(mdl.std = mstd, mdl.new = mnew, t0 = 2000, updown = 'diff',
        cut = 0.05, point.method = 'ipw', niter = 0)
</code></pre>

<hr>
<h2 id='nricens-package'>
R Functions to calculate NRI for comparing time to event and binary
response models.
</h2><span id='topic+nricens-package'></span><span id='topic+nricens-package'></span>

<h3>Description</h3>

<p>This package provides the functions to estimate the net
reclassification improvement (NRI) for competing risk prediction
models with time to event and binary response data.
The NRI for binary response models can be calculated by <code>nribin</code>,
and that for time to event models can be calculated by
<code>nricens</code>.
The risk category based NRI and the risk difference based NRI are
provided by these functions.
Users can use several estimators for comparing time to event models.
Confidence intervals are calculated by the percentile bootstrap
method.
In this version, several types of input data are allowed to improve
user-friendliness and convenience.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> nricens</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-5-30</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Eisuke Inoue &lt;eisuke.inoue@marianna-u.ac.jp&gt;
</p>


<h3>References</h3>

<p>Pencina MJ, D'Agostino RB, Steyerberg EW. Extensions of net
reclassification improvement calculations to measure usefulness of new
biomarkers. Statistics in Medicine 2011.
</p>
<p>Uno H, Tian L, Cai T, Kohane IS, Wei LJ. A unified inference procedure
for a class of measures to assess improvement in risk prediction systems
with survival data, Statistics in Medicine 2012.
</p>
<p>Hsu CH, Taylor JMG. A robust weighted Kaplan-Meier approach for data
with dependent censoring using linear combinations of prognostic
covariates, Statistics in Medicine 2010.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## consider pbc dataset in survival package as an example
library(survival)
dat = pbc[1:312,]
dat$sex = ifelse(dat$sex=='f', 1, 0)

## predciting the event of 'death'
time  = dat$time
event = ifelse(dat$status==2, 1, 0)

## standard prediction model: age, bilirubin, and albumin
z.std = as.matrix(subset(dat, select = c(age, bili, albumin)))

## new prediction model: age, bilirubin, albumin, and protime
z.new = as.matrix(subset(dat, select = c(age, bili, albumin, protime)))

## fitting cox models
mstd = coxph(Surv(time, event) ~ ., data.frame(time, event, z.std), x=TRUE)
mnew = coxph(Surv(time, event) ~ ., data.frame(time, event, z.new), x=TRUE)

## Calculation of the risk category NRI at 2000 days
nricens(mdl.std = mstd, mdl.new = mnew, t0 = 2000, cut = c(0.2, 0.4),
        niter = 10)


## Next, consider binary prediction models
library(survival)
dat = pbc[1:312,]
dat$sex = ifelse(dat$sex=='f', 1, 0)

## subjects censored before 2000 days are excluded
dat = dat[ dat$time &gt; 2000 | (dat$time &lt; 2000 &amp; dat$status == 2), ]

## predciting the event of 'death' before 2000 days
event = ifelse(dat$time &lt; 2000 &amp; dat$status == 2, 1, 0)

## standard prediction model: age, bilirubin, and albumin
z.std = as.matrix(subset(dat, select = c(age, bili, albumin)))

## new prediction model: age, bilirubin, albumin, and protime
z.new = as.matrix(subset(dat, select = c(age, bili, albumin, protime)))

## glm fit (logistic model)
mstd = glm(event ~ ., binomial(logit), data.frame(event, z.std), x=TRUE)
mnew = glm(event ~ ., binomial(logit), data.frame(event, z.new), x=TRUE)

## Calculation of risk difference NRI
nribin(mdl.std = mstd, mdl.new = mnew, cut = 0.02, niter = 0,
       updown = 'diff')
</code></pre>

<hr>
<h2 id='nricens.ipw.main'>
Estimate NRI by the inverse probability weighting (IPW) method.
</h2><span id='topic+nricens.ipw.main'></span>

<h3>Description</h3>

<p>Internaly used function by <code>nricens</code> to provide the NRI estimator
by the IPW method.
In the comparison for time to event models, it is possible to use
directly when <code>UP</code> and <code>DOWN</code> subjects are known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nricens.ipw.main(time, event, upp, dwn, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nricens.ipw.main_+3A_time">time</code></td>
<td>

<p>Vector of follow up times.
</p>
</td></tr>
<tr><td><code id="nricens.ipw.main_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for censoring.
</p>
</td></tr>
<tr><td><code id="nricens.ipw.main_+3A_upp">upp</code>, <code id="nricens.ipw.main_+3A_dwn">dwn</code></td>
<td>

<p>Vector of logical values to determine subjects who belong to
<code>UP</code> and <code>DOWN</code>, respectively.
</p>
</td></tr>
<tr><td><code id="nricens.ipw.main_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event.
</p>
</td></tr>
</table>

<hr>
<h2 id='nricens.km.main'>
Estimate NRI by the standard Kaplan-Meier method.
</h2><span id='topic+nricens.km.main'></span>

<h3>Description</h3>

<p>Internaly used function by <code>nricens</code> to provide the NRI estimator
by the Kaplan-Meier(KM) method.
In the comparison for time to event models, it is possible to use
directly when <code>UP</code> and <code>DOWN</code> subjects are known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nricens.km.main(time, event, upp, dwn, t0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nricens.km.main_+3A_time">time</code></td>
<td>

<p>Vector of follow up times.
</p>
</td></tr>
<tr><td><code id="nricens.km.main_+3A_event">event</code></td>
<td>

<p>Vector of event indicators, 1 for event of interest, 0 for censoring.
</p>
</td></tr>
<tr><td><code id="nricens.km.main_+3A_upp">upp</code>, <code id="nricens.km.main_+3A_dwn">dwn</code></td>
<td>

<p>Vectors of logical values to determine subjects who belong to
<code>UP</code> and <code>DOWN</code>, respectively.
</p>
</td></tr>
<tr><td><code id="nricens.km.main_+3A_t0">t0</code></td>
<td>

<p>Scalar value indicating a time to determine evnet/non-event.
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
