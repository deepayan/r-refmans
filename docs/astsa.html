<!DOCTYPE html><html><head><title>Help for package astsa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {astsa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#astsa-package'><p>Applied Statistical Time Series Analysis (more than just data)</p></a></li>
<li><a href='#acf1'><p>Plot and print ACF or PACF of a time series</p></a></li>
<li><a href='#acf2'><p>Plot and print ACF and PACF of a time series</p></a></li>
<li><a href='#acfm'><p>ACF and CCF for Multiple Time Series</p></a></li>
<li><a href='#ar.boot'><p>Bootstrap Distribution of AR Model Parameters</p></a></li>
<li><a href='#ar.mcmc'><p>Fit Bayesian AR Model</p></a></li>
<li><a href='#ar1miss'><p>AR with Missing Values</p></a></li>
<li><a href='#arf'><p>Simulated ARFIMA</p></a></li>
<li><a href='#arma.spec'><p>Spectral Density of an ARMA Model</p></a></li>
<li><a href='#ARMAtoAR'><p>Convert ARMA Process to Infinite AR Process</p></a></li>
<li><a href='#astsa.col'>
<p>astsa color palette with transparency</p></a></li>
<li><a href='#autoParm'>
<p>autoParm - Structural Break Estimation Using AR Models</p></a></li>
<li><a href='#autoSpec'>
<p>autoSpec - Changepoint Detection of Narrowband Frequency Changes</p></a></li>
<li><a href='#bart'>
<p>Bartlett Kernel</p></a></li>
<li><a href='#BCJ'>
<p>Daily Returns of Three Banks</p></a></li>
<li><a href='#beamd'><p>Infrasonic Signal from a Nuclear Explosion</p></a></li>
<li><a href='#birth'><p>U.S. Monthly Live Births</p></a></li>
<li><a href='#blood'><p>Daily Blood Work with Missing Values</p></a></li>
<li><a href='#bnrf1ebv'><p>Nucleotide sequence - BNRF1 Epstein-Barr</p></a></li>
<li><a href='#bnrf1hvs'><p>Nucleotide sequence - BNRF1 of Herpesvirus saimiri</p></a></li>
<li><a href='#cardox'><p>Monthly Carbon Dioxide Levels at Mauna Loa</p></a></li>
<li><a href='#ccf2'><p>Cross Correlation</p></a></li>
<li><a href='#chicken'><p>Monthly price of a pound of chicken</p></a></li>
<li><a href='#climhyd'><p>Lake Shasta inflow data</p></a></li>
<li><a href='#cmort'><p>Cardiovascular Mortality from the LA Pollution study</p></a></li>
<li><a href='#cpg'><p>Hard Drive Cost per GB</p></a></li>
<li><a href='#detrend'>
<p>Detrend a Time Series</p></a></li>
<li><a href='#djia'><p>Dow Jones Industrial Average</p></a></li>
<li><a href='#dna2vector'>
<p>Convert DNA Sequence to Indicator Vectors</p></a></li>
<li><a href='#EBV'><p>Entire Epstein-Barr Virus (EBV) Nucleotide Sequence</p></a></li>
<li><a href='#econ5'><p>Five Quarterly Economic Series</p></a></li>
<li><a href='#EM'>
<p>EM Algorithm for State Space Models</p></a></li>
<li><a href='#ENSO'><p>El Nino - Southern Oscillation Index</p></a></li>
<li><a href='#EQ5'><p>Seismic Trace of Earthquake number 5</p></a></li>
<li><a href='#EQcount'><p>EQ Counts</p></a></li>
<li><a href='#eqexp'><p>Earthquake and Explosion Seismic Series</p></a></li>
<li><a href='#ESS'>
<p>Effective Sample Size (ESS)</p></a></li>
<li><a href='#EXP6'><p>Seismic Trace of Explosion number 6</p></a></li>
<li><a href='#FDR'><p>Basic False Discovery Rate</p></a></li>
<li><a href='#ffbs'>
<p>Forward Filtering Backward Sampling</p></a></li>
<li><a href='#flu'><p>Monthly pneumonia and influenza deaths in the U.S., 1968 to 1978.</p></a></li>
<li><a href='#fmri'><p>fMRI - complete data set</p></a></li>
<li><a href='#fmri1'><p>fMRI Data Used in Chapter 1</p></a></li>
<li><a href='#gas'><p>Gas Prices</p></a></li>
<li><a href='#gdp'><p>Quarterly U.S. GDP</p></a></li>
<li><a href='#GDP23'><p>Quarterly U.S. GDP - updated to 2023</p></a></li>
<li><a href='#gnp'><p>Quarterly U.S. GNP</p></a></li>
<li><a href='#GNP23'><p>Quarterly U.S. GNP - updated to 2023</p></a></li>
<li><a href='#Grid'><p>A Better Add Grid to a Plot</p></a></li>
<li><a href='#gtemp_both'><p>Global mean land and open ocean temperature deviations, 1850-2023</p></a></li>
<li><a href='#gtemp_land'><p>Global mean land temperature deviations, 1850-2023</p></a></li>
<li><a href='#gtemp_ocean'><p>Global mean ocean temperature deviations, 1850-2023</p></a></li>
<li><a href='#Hare'><p>Snowshoe Hare</p></a></li>
<li><a href='#HCT'><p>Hematocrit Levels</p></a></li>
<li><a href='#hor'><p>Hawaiian occupancy rates</p></a></li>
<li><a href='#jj'><p>Johnson and Johnson Quarterly Earnings Per Share</p></a></li>
<li><a href='#Kfilter'>
<p>Quick Kalman Filter</p></a></li>
<li><a href='#Ksmooth'>
<p>Quick Kalman Smoother</p></a></li>
<li><a href='#lag1.plot'><p>Lag Plot - one time series</p></a></li>
<li><a href='#lag2.plot'><p>Lag Plot - two time series</p></a></li>
<li><a href='#LagReg'><p>Lagged Regression</p></a></li>
<li><a href='#lap'><p>LA Pollution-Mortality Study</p></a></li>
<li><a href='#lead'><p>Leading Indicator</p></a></li>
<li><a href='#Lynx'><p>Canadian Lynx</p></a></li>
<li><a href='#matrixpwr'>
<p>Powers of a Square Matrix</p></a></li>
<li><a href='#MEI'>
<p>Multivariate El Nino/Southern Oscillation Index (version 1)</p></a></li>
<li><a href='#Months'>
<p>Month Labels</p></a></li>
<li><a href='#mvspec'><p>Univariate and Multivariate Spectral Estimation</p></a></li>
<li><a href='#nyse'><p>Returns of the New York Stock Exchange</p></a></li>
<li><a href='#oil'><p>Crude oil, WTI spot price FOB</p></a></li>
<li><a href='#part'><p>Particulate levels from the LA pollution study</p></a></li>
<li><a href='#PLT'><p>Platelet Levels</p></a></li>
<li><a href='#polio'>
<p>Poliomyelitis cases in US</p></a></li>
<li><a href='#polyMul'><p>Multiplication of Two Polynomials</p></a></li>
<li><a href='#prodn'><p>Monthly Federal Reserve Board Production Index</p></a></li>
<li><a href='#qinfl'><p>Quarterly Inflation</p></a></li>
<li><a href='#qintr'><p>Quarterly Interest Rate</p></a></li>
<li><a href='#rec'><p>Recruitment (number of new fish index)</p></a></li>
<li><a href='#sales'><p>Sales</p></a></li>
<li><a href='#salmon'>
<p>Monthly export price of salmon</p></a></li>
<li><a href='#salt'><p>Salt Profiles</p></a></li>
<li><a href='#saltemp'><p>Temperature Profiles</p></a></li>
<li><a href='#sarima'><p>Fit ARIMA Models</p></a></li>
<li><a href='#sarima.for'><p>ARIMA Forecasting</p></a></li>
<li><a href='#sarima.sim'><p>ARIMA Simulation</p></a></li>
<li><a href='#scatter.hist'>
<p>Scatterplot with Marginal Histograms</p></a></li>
<li><a href='#SigExtract'><p>Signal Extraction And Optimal Filtering</p></a></li>
<li><a href='#sleep1'>
<p>Sleep State and Movement Data - Group 1</p></a></li>
<li><a href='#sleep2'>
<p>Sleep State and Movement Data - Group 2</p></a></li>
<li><a href='#so2'><p>SO2 levels from the LA pollution study</p></a></li>
<li><a href='#soi'><p>Southern Oscillation Index</p></a></li>
<li><a href='#soiltemp'><p>Spatial Grid of Surface Soil Temperatures</p></a></li>
<li><a href='#sp500.gr'><p>Returns of the S&amp;P 500</p></a></li>
<li><a href='#sp500w'><p>Weekly Growth Rate of the Standard and Poor's 500</p></a></li>
<li><a href='#spec.ic'>
<p>Estimate Spectral Density of a Time Series from AR Fit</p></a></li>
<li><a href='#specenv'>
<p>Spectral Envelope</p></a></li>
<li><a href='#speech'><p>Speech Recording</p></a></li>
<li><a href='#ssm'><p>State Space Model</p></a></li>
<li><a href='#star'><p>Variable Star</p></a></li>
<li><a href='#stoch.reg'><p>Frequency Domain Stochastic Regression</p></a></li>
<li><a href='#sunspotz'><p>Biannual Sunspot Numbers</p></a></li>
<li><a href='#SV.mcmc'><p>Fit Bayesian Stochastic Volatility Model</p></a></li>
<li><a href='#SV.mle'>
<p>Stochastic Volatility Model with Feedback via MLE</p></a></li>
<li><a href='#tempr'><p>Temperatures from the LA pollution study</p></a></li>
<li><a href='#test.linear'><p>Test Linearity of a Time Series via Normalized Bispectrum</p></a></li>
<li><a href='#trend'><p>Estimate Trend</p></a></li>
<li><a href='#tsplot'><p>Time Series Plot</p></a></li>
<li><a href='#unemp'><p>U.S. Unemployment</p></a></li>
<li><a href='#UnempRate'><p>U.S. Unemployment Rate</p></a></li>
<li><a href='#USpop'>
<p>U.S. Population - 1900 to 2010</p></a></li>
<li><a href='#varve'><p>Annual Varve Series</p></a></li>
<li><a href='#WBC'><p>White Blood Cell Levels</p></a></li>
<li><a href='#xA_readme'>
<p>SCRIPTS MARKED WITH AN 'x' ARE SCHEDULED TO BE PHASED OUT</p></a></li>
<li><a href='#xEM0'><p>EM Algorithm for Time Invariant State Space Models - This script has been superseded by <code>EM</code>.</p></a></li>
<li><a href='#xEM1'><p>EM Algorithm for General State Space Models - This script has been superseded by <code>EM</code>.</p></a></li>
<li><a href='#xglobtemp'><p>Superseded by <code>gtemp_both</code> - Global mean land-ocean temperature deviations.</p></a></li>
<li><a href='#xglobtempl'><p>Superseded by <code>gtemp_land</code> - Global mean land temperature deviations.</p></a></li>
<li><a href='#xgtemp'><p>Superseded by <code>gtemp_both</code> - Global mean land-ocean temperature deviations.</p></a></li>
<li><a href='#xgtemp2'><p>Superseded by <code>gtemp_land</code> - Global Mean Surface Air Temperature Deviations</p></a></li>
<li><a href='#xKfilter0'><p>Kalman Filter - This script has been superseded by <code>Kfilter</code></p></a></li>
<li><a href='#xKfilter1'><p>Kalman Filter - This script has been superseded by <code>Kfilter</code>.</p></a></li>
<li><a href='#xKfilter2'><p>Kalman Filter - This script has been superseded by <code>Kfilter</code>.</p></a></li>
<li><a href='#xKsmooth0'><p>Kalman Filter and Smoother - This script has been superseded by <code>Ksmooth</code></p></a></li>
<li><a href='#xKsmooth1'><p>Kalman Filter and Smoother - This script has been superseded by <code>Ksmooth</code></p></a></li>
<li><a href='#xKsmooth2'><p>Kalman Filter and Smoother - This script has been superseded by <code>Ksmooth</code></p></a></li>
<li><a href='#xSVfilter'><p>Switching Filter (for Stochastic Volatility Models) - This script is now part of <code>SV.mle</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Applied Statistical Time Series Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-03</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Author:</td>
<td>David Stoffer [aut, cre],  Nicky Poison [ctb, mus, spy]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Stoffer &lt;stoffer@pitt.edu&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nickpoison/astsa/issues">https://github.com/nickpoison/astsa/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Contains data sets and scripts for analyzing time series in both the frequency and time domains including state space modeling as well as supporting the texts Time Series Analysis and Its Applications: With R Examples (5th ed coming), by R.H. Shumway and D.S. Stoffer. Springer Texts in Statistics, 2017, &lt;<a href="https://doi.org/10.1007%2F978-3-319-52452-8">doi:10.1007/978-3-319-52452-8</a>&gt;, and Time Series: A Data Analysis Approach Using R. Chapman-Hall, 2019, &lt;<a href="https://doi.org/10.1201%2F9780429273285">doi:10.1201/9780429273285</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dsstoffer.github.io/">https://dsstoffer.github.io/</a>, <a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-10 21:42:49 UTC; david</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 23:43:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='astsa-package'>Applied Statistical Time Series Analysis (more than just data)
</h2><span id='topic+astsa-package'></span><span id='topic+astsa'></span>

<h3>Description</h3>

<p>Contains data sets and scripts for analyzing time series in both the frequency and time domains including state space modeling as well as supporting the texts <a href="https://link.springer.com/book/10.1007/978-3-319-52452-8">Time Series Analysis and Its Applications: With R Examples (5th ed, 2024)</a>  and <a href="https://www.routledge.com/Time-Series-A-Data-Analysis-Approach-Using-R/Shumway-Stoffer/p/book/9780367221096">Time Series: A Data Analysis Approach Using R, (1st ed, 2019)</a>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> astsa</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>Some older scripts and data sets have been updated, and old versions have an x in front of them, for example <code>xgtemp</code> is an old data file that used to be called <code>gtemp</code>. These scripts and data sets have not changed (they will still work with the x name change), but they will be phased out eventually. 
</p>
<p>Also, due to the fact that, if loaded, the <code>dplyr</code> package corrupts <code>stats::filter</code> and <code>stats::lag</code>, 
those are put in the global (or user) environment as <code>filter</code> and <code>lag</code> when <code>astsa</code> is loaded so they have precedent. You can use <code>rm()</code> to remove those from the global environment if necessary.
</p>


<h3>Author(s)</h3>

<p>David Stoffer &lt;stoffer@pitt.edu&gt;
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='acf1'>Plot and print ACF or PACF of a time series
</h2><span id='topic+acf1'></span>

<h3>Description</h3>

<p>Produces a plot (and a printout) of the sample ACF or PACF. The zero lag value of the ACF is removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf1(series, max.lag = NULL, plot = TRUE, main = NULL, ylim = NULL, pacf = FALSE,
      ylab = NULL, xlab = NULL, na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf1_+3A_series">series</code></td>
<td>
<p>The data.  Does not have to be a time series object.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_max.lag">max.lag</code></td>
<td>

<p>Maximum lag.  Can be omitted. Defaults to <code class="reqn">\sqrt{n} + 10</code> unless <code class="reqn">n &lt; 60</code>.  If the series is seasonal, this will be at least 4 seasons by default.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_plot">plot</code></td>
<td>
<p>If TRUE (default), a graph is produced and the values are rounded and listed. If FALSE, no graph is produced and the values are listed but not rounded by the script.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_main">main</code></td>
<td>
<p>Title of graphic; defaults to name of series.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_ylim">ylim</code></td>
<td>
<p>Specify limits for the y-axis.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_pacf">pacf</code></td>
<td>
<p>If TRUE, the sample PACF is returned instead of ACF.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_ylab">ylab</code></td>
<td>
<p>Change y-axis label from default.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_xlab">xlab</code></td>
<td>
<p>Change x-axis label from default.
</p>
</td></tr>
<tr><td><code id="acf1_+3A_na.action">na.action</code></td>
<td>
<p>How to handle missing data; default is <code>na.pass</code>
</p>
</td></tr>
<tr><td><code id="acf1_+3A_...">...</code></td>
<td>
<p> Additional arguments passed to <code><a href="#topic+tsplot">tsplot</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Will print and/or plot the sample ACF or PACF (if <code>pacf=TRUE</code>). The zero lag of the ACF (which is always 1) has been removed. If <code>plot=TRUE</code>, a graph is produced and the values are rounded and listed. If FALSE, no graph is produced and the values are listed but not rounded by the script. The error bounds are approximate white noise bounds, <code class="reqn">-1/n  \pm 2/\sqrt{n}</code>; no other option is given.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ACF</code></td>
<td>
<p>The sample ACF or PACF</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acf2">acf2</a></code>, <code><a href="#topic+acfm">acfm</a></code>, <code><a href="#topic+ccf2">ccf2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>acf1(rnorm(100))

acf1(sarima.sim(ar=.9), pacf=TRUE)

# show it to your mom:
acf1(soi, col=2:7, lwd=4, gg=TRUE)
</code></pre>

<hr>
<h2 id='acf2'>Plot and print ACF and PACF of a time series
</h2><span id='topic+acf2'></span>

<h3>Description</h3>

<p>Produces a simultaneous plot (and a printout) of the sample ACF and PACF on the same scale. The zero lag value of the ACF is removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acf2(series, max.lag = NULL, plot = TRUE, main = NULL, ylim = NULL, 
      na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acf2_+3A_series">series</code></td>
<td>
<p>The data.  Does not have to be a time series object.
</p>
</td></tr>
<tr><td><code id="acf2_+3A_max.lag">max.lag</code></td>
<td>

<p>Maximum lag.  Can be omitted. Defaults to <code class="reqn">\sqrt{n} + 10</code> unless <code class="reqn">n &lt; 60</code>. If the series is seasonal, this will be at least 4 seasons by default.
</p>
</td></tr>
<tr><td><code id="acf2_+3A_plot">plot</code></td>
<td>
<p>If TRUE (default), a graph is produced and the values are rounded and listed. If FALSE, no graph is produced and the values are listed but not rounded by the script.
</p>
</td></tr>
<tr><td><code id="acf2_+3A_main">main</code></td>
<td>
<p>Title of graphic; defaults to name of series.
</p>
</td></tr>
<tr><td><code id="acf2_+3A_ylim">ylim</code></td>
<td>
<p>Specify limits for the y-axis.
</p>
</td></tr>
<tr><td><code id="acf2_+3A_na.action">na.action</code></td>
<td>
<p>How to handle missing data; default is <code>na.pass</code>
</p>
</td></tr>
<tr><td><code id="acf2_+3A_...">...</code></td>
<td>
<p> Additional arguments passed to <code><a href="#topic+tsplot">tsplot</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Will print and/or plot the sample ACF and PACF on the same scale. The zero lag of the ACF (which is always 1) has been removed. If <code>plot=TRUE</code>, a graph is produced and the values are rounded and listed. If FALSE, no graph is produced and the values are listed but not rounded by the script. The error bounds are approximate white noise bounds, <code class="reqn">-1/n  \pm 2/\sqrt{n}</code>; no other option is given.
</p>


<h3>Value</h3>

<table>
<tr><td><code>ACF</code></td>
<td>
<p>The sample ACF</p>
</td></tr>
<tr><td><code>PACF</code></td>
<td>
<p>The sample PACF</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acf1">acf1</a></code>, <code><a href="#topic+acfm">acfm</a></code>, <code><a href="#topic+ccf2">ccf2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>acf2(rnorm(100))

acf2(rnorm(100), 25, main='')  # no title

acf2(rnorm(100), plot=FALSE)[,'ACF']  # print only ACF

acf2(soi, col=2:7, lwd=4, gg=TRUE)  # mother's day present
</code></pre>

<hr>
<h2 id='acfm'>ACF and CCF for Multiple Time Series
</h2><span id='topic+acfm'></span>

<h3>Description</h3>

<p>Produces a grid of plots of the sample ACF (diagonal) and CCF (off-diagonal). 
The values are returned invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acfm(series, max.lag = NULL,  na.action = na.pass, ylim = NULL,
      acf.highlight = TRUE, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acfm_+3A_series">series</code></td>
<td>
<p>Multiple time series (at least 2 columns of time series)
</p>
</td></tr>
<tr><td><code id="acfm_+3A_max.lag">max.lag</code></td>
<td>

<p>Maximum lag.  Can be omitted. Defaults to <code class="reqn">\sqrt{n} + 10</code> unless <code class="reqn">n &lt; 60</code>.  If the series is seasonal, this will be at least 4 seasons by default.
</p>
</td></tr>
<tr><td><code id="acfm_+3A_na.action">na.action</code></td>
<td>
<p>How to handle missing data; default is <code>na.pass</code>
</p>
</td></tr>
<tr><td><code id="acfm_+3A_ylim">ylim</code></td>
<td>
<p>Specify limits for the all correlation axes. If NULL (default) the values
are a little wider than the min and max of all values.
</p>
</td></tr>
<tr><td><code id="acfm_+3A_acf.highlight">acf.highlight</code></td>
<td>
<p>If TRUE (default), the diagonals (ACFs) are highlighted.
</p>
</td></tr>
<tr><td><code id="acfm_+3A_plot">plot</code></td>
<td>
<p>If TRUE (default), you get a wonderful graphic.
</p>
</td></tr>
<tr><td><code id="acfm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+tsplot">tsplot</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a grid of plots of the sample ACF (diagonal) and CCF (off-diagonal).
The plots in the grid are estimates of  <kbd>corr{x(t+LAG), y(t)}</kbd>.  Thus
<kbd>x</kbd> leads <kbd>y</kbd> if <kbd>LAG</kbd> is positive and <kbd>x</kbd> lags <kbd>y</kbd> if <kbd>LAG</kbd> is negative.
If <code>plot</code> is FALSE, then there is no graphic.
</p>


<h3>Value</h3>

<p>The correlations are returned invisibly.</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acf1">acf1</a></code>, <code><a href="#topic+acf2">acf2</a></code>, <code><a href="#topic+ccf2">ccf2</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>acfm(diff(log(econ5)), gg=TRUE, acf.highlight=FALSE)

( acfm(diff(log(econ5)), 2, plot=FALSE) )
</code></pre>

<hr>
<h2 id='ar.boot'>Bootstrap Distribution of AR Model Parameters
</h2><span id='topic+ar.boot'></span>

<h3>Description</h3>

<p>Performs a nonparametric bootstrap to obtain the distribution of the AR model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ar.boot(series, order.ar, nboot = 500, seed = NULL, plot = TRUE, col = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ar.boot_+3A_series">series</code></td>
<td>

<p>time series data (univariate only)
</p>
</td></tr>
<tr><td><code id="ar.boot_+3A_order.ar">order.ar</code></td>
<td>

<p>autoregression order - must be specified
</p>
</td></tr>
<tr><td><code id="ar.boot_+3A_nboot">nboot</code></td>
<td>

<p>number of bootstrap iterations (default is 500)
</p>
</td></tr>
<tr><td><code id="ar.boot_+3A_seed">seed</code></td>
<td>

<p>seed for the bootstrap sampling (defalut is NULL)
</p>
</td></tr>
<tr><td><code id="ar.boot_+3A_plot">plot</code></td>
<td>

<p>if TRUE (default) and <code>order.ar &gt; 1</code>, returns a scatterplot matrix of the bootstrapped parameters, - the diagonals
of the matrix show a histogram (or just a histogram if the order is 1) with the 2.5%, 50%, and 97.5% quantiles marked
</p>
</td></tr>
<tr><td><code id="ar.boot_+3A_col">col</code></td>
<td>

<p>color used in the display
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a specified <code>series</code>, finds the bootstrap distribution of the
Yule-Walker estimates of <code class="reqn">\phi_1,\dots,\phi_p</code> in the AR model specified by <code>order.ar</code>,
</p>
<p style="text-align: center;"><code class="reqn">x_t = \mu + \phi_1 (x_{t-1}-\mu) + \dots + \phi_p (x_{t-p}-\mu) + w_t ,</code>
</p>

<p>where <code class="reqn">w_t</code> is white noise. The data are centered by the estimate of <code class="reqn">\mu</code> 
prior to the bootstrap simulations.
</p>
<p>The script displays a number of quantiles of the bootstrapped estimates, the means, the biases, and the root mean squared errors.
</p>


<h3>Value</h3>

<p>Returned invisibly:
</p>
<table>
<tr><td><code>phi.star</code></td>
<td>
<p>bootstrapped AR parameters</p>
</td></tr>
<tr><td><code>x.sim</code></td>
<td>
<p>bootstrapped data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at 
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

u = ar.boot(rec, 2)
head(u[[1]])       # some booted AR parameters
head(u[[2]][,1:5]) # some booted data

## End(Not run)
</code></pre>

<hr>
<h2 id='ar.mcmc'>Fit Bayesian AR Model 
</h2><span id='topic+ar.mcmc'></span>

<h3>Description</h3>

<p>Uses Gibbs sampling to fit an AR model to time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ar.mcmc(xdata, porder, n.iter = 1000, n.warmup = 100, plot = TRUE, col = 4, 
        prior_var_phi = 50, prior_sig_a = 1, prior_sig_b = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ar.mcmc_+3A_xdata">xdata</code></td>
<td>

<p>time series data (univariate only)
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_porder">porder</code></td>
<td>

<p>autoregression order
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_n.iter">n.iter</code></td>
<td>

<p>number of iterations for the sampler
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_n.warmup">n.warmup</code></td>
<td>

<p>number of startup iterations for the sampler (these are removed)
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_plot">plot</code></td>
<td>

<p>if TRUE (default) returns two graphics, (1) the draws after warmup and (2) a
scatterplot matrix of the draws with histograms on the diagonal
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_col">col</code></td>
<td>

<p>color of the plots
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_prior_var_phi">prior_var_phi</code></td>
<td>

<p>prior variance of the vector of AR coefficients; see details
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_prior_sig_a">prior_sig_a</code></td>
<td>

<p>first prior for the variance component; see details
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_prior_sig_b">prior_sig_b</code></td>
<td>

<p>second prior for the variance component; see details
</p>
</td></tr>
<tr><td><code id="ar.mcmc_+3A_...">...</code></td>
<td>

<p>additional graphic parameters for the scatterplots
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes a normal-inverse gamma model,
</p>
<p style="text-align: center;"><code class="reqn">x_t = \phi_0 + \phi_1 x_{t-1} + \dots + \phi_p x_{t-p} + \sigma z_t ,</code>
</p>

<p>where <code class="reqn">z_t</code> is standard Gaussian noise.
With <code class="reqn">\Phi</code> being the (p+1)-dimensional vector of the <code class="reqn">\phi</code>s,
the priors are 
<code class="reqn">\Phi \mid \sigma \sim N(0, \sigma^2 V_0)</code> and
<code class="reqn">\sigma^2 \sim IG(a,b)</code>, where <code class="reqn">V_0 = \gamma^2 I</code>.
Defaults are given for the hyperparameters, but the user
may choose <code class="reqn">(a,b)</code> as <code>(prior_sig_a, prior_sig_b)</code>
and <code class="reqn">\gamma^2</code> as <code>prior_var_phi</code>.
</p>
<p>The algorithm is efficient and converges quickly.
Further details can be found in Chapter 6 of the 5th edition of the 
Springer text.
</p>


<h3>Value</h3>

<p>In addition to the graphics (if plot is TRUE), 
the  draws of each parameter (<code>phi0, phi1, ..., sigma</code>)
are returned invisibly and
various quantiles are displayed.  
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>Based on the script <code>arp.mcmc</code> used in Douc,  Moulines, &amp; Stoffer, D. (2014).
<em> Nonlinear Time Series: Theory, Methods and Applications with R Examples</em>. CRC press. 
ISBN 9781466502253.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

u = ar.mcmc(rec, 2)

tsplot(u, ncolm=2, col=4)  # plot the traces

apply(u, 2, ESS)    # effective sample sizes

## End(Not run)
</code></pre>

<hr>
<h2 id='ar1miss'>AR with Missing Values
</h2><span id='topic+ar1miss'></span>

<h3>Description</h3>

<p>Data used in Chapter 6
</p>


<h3>Format</h3>

<p>The format is:  Time-Series [1:100]  with NA for missing values.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='arf'>Simulated ARFIMA
</h2><span id='topic+arf'></span>

<h3>Description</h3>

<p>1000 simulated observations from an ARFIMA(1, 1, 0) model with <code class="reqn">\phi = .75</code> and <code class="reqn">d = .4</code>.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:1000] from 1 to 1000: -0.0294 0.7487 -0.3386 -1.0332 -0.2627 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='arma.spec'>Spectral Density of an ARMA Model
</h2><span id='topic+arma.spec'></span>

<h3>Description</h3>

<p>Gives the ARMA spectrum, tests for causality, invertibility, and
common zeros.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arma.spec(ar = 0, ma = 0, var.noise = 1, n.freq = 500,
          main='from specified model', frequency=1, ylim=NULL, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arma.spec_+3A_ar">ar</code></td>
<td>
<p>vector of AR parameters
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_ma">ma</code></td>
<td>
<p>vector of MA parameters
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_var.noise">var.noise</code></td>
<td>
<p>variance of the noise
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_n.freq">n.freq</code></td>
<td>
<p>number of frequencies
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_main">main</code></td>
<td>
<p>title of graphic
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_frequency">frequency</code></td>
<td>
<p>for seasonal models, adjusts the frequency scale
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_ylim">ylim</code></td>
<td>
<p>optional; specify limits for the y-axis
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_plot">plot</code></td>
<td>
<p>if TRUE (default), produces a graphic
</p>
</td></tr>
<tr><td><code id="arma.spec_+3A_...">...</code></td>
<td>
<p>additional arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic call is <code>arma.spec(ar, ma)</code> where <code>ar</code> and <code>ma</code> are vectors
containing the model parameters. Use <code>log='y'</code> if you want the plot on
a log scale. If the model is not causal or invertible an error message is given. If
there are approximate common zeros, a spectrum will be displayed and a warning will be given;
e.g., <code>arma.spec(ar= .9, ma= -.9)</code> will yield a warning and the plot will be the
spectrum of white noise.
</p>


<h3>Value</h3>

 <table>
<tr><td><code>freq</code></td>
<td>
<p>frequencies - returned invisibly</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p> spectral ordinates - returned invisibly </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arma.spec(ar = c(1, -.9), ma = .8)

arma.spec(ar = c(1, -.9), log='y')

arma.spec(ar = c(1, -.9), main='AR(2)', gg=TRUE, col=5, lwd=2)

arma.spec(ar=c(rep(0,11),.4), ma=.5, col=5, lwd=3, frequency=12)
</code></pre>

<hr>
<h2 id='ARMAtoAR'>Convert ARMA Process to Infinite AR Process</h2><span id='topic+ARMAtoAR'></span>

<h3>Description</h3>

<p>Gives the <code class="reqn">\pi</code>-weights in the invertible representation of an ARMA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARMAtoAR(ar = 0, ma = 0, lag.max=20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ARMAtoAR_+3A_ar">ar</code></td>
<td>
<p>vector of AR coefficients</p>
</td></tr>
<tr><td><code id="ARMAtoAR_+3A_ma">ma</code></td>
<td>
<p>vector of MA coefficients</p>
</td></tr>
<tr><td><code id="ARMAtoAR_+3A_lag.max">lag.max</code></td>
<td>
<p>number of pi-weights desired</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of coefficients.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ARMAtoAR(ar=.9, ma=.5, 10)
</code></pre>

<hr>
<h2 id='astsa.col'>
astsa color palette with transparency
</h2><span id='topic+astsa.col'></span>

<h3>Description</h3>

<p>Modifies the opacity level of the astsa color palette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>astsa.col(col = 1, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="astsa.col_+3A_col">col</code></td>
<td>
<p>numerical vector representing colors (default is 1 or 'black') 
- see Examples
</p>
</td></tr>  
<tr><td><code id="astsa.col_+3A_alpha">alpha</code></td>
<td>

<p>factor in [0,1] setting the opacity (default is 1) 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a color vector using the astsa color palette at the chosen transparency level 
</p>


<h3>Note</h3>

<p>The astsa color palette is attached when the package is attached. 
The colors follow the R pattern of shades of: (1) black, (2) red, (3) green, (4) blue, 
(5) cyan, (6) magenta, (7) gold, (8) gray.  The opacity of these colors can be
changed easily using this script.  Values are recycled, e.g., <code>col=9</code> is
the same as <code>col=1</code>.
</p>
<p>The astsa palette was developed from two basic ideas.  The first is the general idea that
time series should be plotted using dark colors. The second is personal in that we
prefer to anchor plots with  the best blue,  <kbd>dodgerblue3</kbd>. 
From there, we used the website <kbd>https://www.color-hex.com/</kbd> to pick colors of type 2 to 7
that complement <kbd>dodgerblue3</kbd>.
</p>


<h3>Author(s)</h3>

<p>D.S.Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># plotting 2 series that touch (but in a nice way)
tsplot(cbind(gtemp_land, gtemp_ocean), col=astsa.col(c(4,2), .5), lwd=2, spaghetti=TRUE, 
         type='o', pch=20, ylab="Temperature Deviations")
legend('topleft', legend=c("Land Only", "Ocean Only"), col=c(4,2), lwd=2, pch=20, bty='n')  

# View the astsa palette
barplot(rep(1,8), col=1:8, main='astsa palette', names=1:8)
</code></pre>

<hr>
<h2 id='autoParm'>
autoParm - Structural Break Estimation Using AR Models
</h2><span id='topic+autoParm'></span>

<h3>Description</h3>

<p>Uses minimum description length (MDL) to fit piecewise AR processes with the goal of detecting changepoints in time series. Optimization is accomplished via a genetic algorithm (GA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoParm(xdata, Pi.B = NULL, Pi.C = NULL, PopSize = 70, generation = 70, P0 = 20, 
         Pi.P = 0.3, Pi.N = 0.3, NI = 7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoParm_+3A_xdata">xdata</code></td>
<td>

<p>time series (of length n at least 100) to be analyzed; the <code>ts</code> attributes are stripped 
prior to the analysis
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_pi.b">Pi.B</code></td>
<td>

<p>probability of being a breakpoint in initial stage; default is 10/n. 
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_pi.c">Pi.C</code></td>
<td>

<p>probability of conducting crossover; default is (n-10)/n.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_popsize">PopSize</code></td>
<td>

<p>population size (default is 70); the number of chromosomes in each generation.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_generation">generation</code></td>
<td>

<p>number of iterations; default is 70.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_p0">P0</code></td>
<td>

<p>maximum AR order; default is 20. If larger than 20, it is reset to 20.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_pi.p">Pi.P</code></td>
<td>

<p>probability of taking parent's gene in mutation; default is 0.3.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_pi.n">Pi.N</code></td>
<td>

<p>probability of taking -1 in mutation; default is 0.3
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoParm_+3A_ni">NI</code></td>
<td>

<p>number if islands; default is 7.
Does not need to be specified.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details my be found in Davis, Lee, &amp; Rodriguez-Yam (2006). Structural break estimation for nonstationary time series models. JASA, 101, 223-239. <a href="https://doi.org/10.1198/016214505000000745">doi:10.1198/016214505000000745</a>
</p>


<h3>Value</h3>

<p>Returns three values, (1) the breakpoints including the endpoints, (2) the number of
segments, and (3) the segment AR orders.  See the examples.
</p>


<h3>Note</h3>

<p>The GA is a stochastic optimization procedure and consequently will give different results at
each run.  It is a good idea to run the algorithm a few times before coming to a final decision.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>The code is adapted from R code provided to us by Rex Cheung (<kbd>https://www.linkedin.com/in/rexcheung</kbd>).
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoSpec">autoSpec</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##-- simulation
x1 = sarima.sim(ar=c(1.69, -.81), n=500)
x2 = sarima.sim(ar=c(1.32, -.81), n=500) 
x = c(x1, x2)

##-- look at the data
tsplot(x)

##-- run procedure
autoParm(x)

##-- output (yours will be slightly different - 
##--         the nature of GA) 
# returned breakpoints include the endpoints 
# $breakpoints
# [1]    1  514 1000
# 
# $number_of_segments
# [1] 2
# 
# $segment_AR_orders
# [1] 2 2

## End(Not run)
</code></pre>

<hr>
<h2 id='autoSpec'>
autoSpec - Changepoint Detection of Narrowband Frequency Changes
</h2><span id='topic+autoSpec'></span>

<h3>Description</h3>

<p>Uses changepoint detection to discover if there have been slight changes in frequency 
in a time series.  The autoSpec procedure uses minimum description length (MDL) 
to do nonparametric spectral estimation with the goal of detecting changepoints. 
Optimization is accomplished via a genetic algorithm (GA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoSpec(xdata, Pi.B = NULL, Pi.C = NULL, PopSize = 70, generation = 70, m0 = 10, 
         Pi.P = 0.3, Pi.N = 0.3, NI = 7, taper = .5, min.freq = 0, max.freq = .5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoSpec_+3A_xdata">xdata</code></td>
<td>

<p>time series (of length n at least 100) to be analyzed; the <code>ts</code> attributes are stripped 
prior to the analysis
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_pi.b">Pi.B</code></td>
<td>

<p>probability of being a breakpoint in initial stage; default is 10/n. 
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_pi.c">Pi.C</code></td>
<td>

<p>probability of conducting crossover; default is (n-10)/n.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_popsize">PopSize</code></td>
<td>

<p>population size (default is 70); the number of chromosomes in each generation.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_generation">generation</code></td>
<td>

<p>number of iterations; default is 70.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_m0">m0</code></td>
<td>

<p>maximum width of the Bartlett kernel is <code>2*m0 + 1</code>; default is 10.
If larger than 20, m0 is reset to 20. Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_pi.p">Pi.P</code></td>
<td>

<p>probability of taking parent's gene in mutation; default is 0.3.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_pi.n">Pi.N</code></td>
<td>

<p>probability of taking -1 in mutation; default is 0.3
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_ni">NI</code></td>
<td>

<p>number if islands; default is 7.
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_taper">taper</code></td>
<td>

<p>half width of taper used in spectral estimate; .5 (default) is full taper
Does not need to be specified.
</p>
</td></tr>
<tr><td><code id="autoSpec_+3A_min.freq">min.freq</code>, <code id="autoSpec_+3A_max.freq">max.freq</code></td>
<td>

<p>the frequency range (min.freq, max.freq) over which to calculate the Whittle likelihood;
the default is (0, .5). Does not need to be specified.  If min &gt; max, the roles are 
reversed, and reset to the default if either is out of range.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details my be found in Stoffer, D. S. (2023). AutoSpec: Detection of narrowband frequency changes in time series. Statistics and Its Interface, 16(1), 97-108. <a href="https://doi.org/10.4310/21-SII703">doi:10.4310/21-SII703</a>
</p>


<h3>Value</h3>

<p>Returns three values, (1) the breakpoints including the endpoints, (2) the number of
segments, and (3) the segment kernel orders.  See the examples.
</p>


<h3>Note</h3>

<p>The GA is a stochastic optimization procedure and consequently will give different results at
each run.  It is a good idea to run the algorithm a few times before coming to a final decision.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>The genetic algorithm code is adapted from R code provided to us by Rex Cheung (<kbd>https://www.linkedin.com/in/rexcheung</kbd>). The code originally supported Aue, Cheung, Lee, &amp; Zhong (2014). Segmented model selection in quantile regression using the minimum description length principle. JASA, 109, 1241-1256.  A similar version also supported Davis, Lee, &amp; Rodriguez-Yam (2006). Structural break estimation for nonstationary time series models. JASA, 101, 223-239.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoParm">autoParm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##-- simulation
set.seed(1)
num = 500
t   = 1:num
w   = 2*pi/25
d   = 2*pi/150
x1  = 2*cos(w*t)*cos(d*t) + rnorm(num)
x2  = cos(w*t) + rnorm(num)
x   = c(x1,x2)

##-- plot and periodogram (all action below 0.1)
tsplot(x, main='not easy to see the change')
mvspec(x) 

##-- run procedure
autoSpec(x, max.freq=.1)

##-- output (yours will be slightly different - 
##--         the nature of GA) 
# returned breakpoints include the endpoints 
# $breakpoints
# [1]    1  503 1000
# 
# $number_of_segments
# [1] 2
# 
# $segment_kernel_orders_m
# [1] 2 4


##-- plot everything
par(mfrow=c(3,1))
tsplot(x, col=4)
 abline(v=503, col=6, lty=2, lwd=2)
mvspec(x[1:502],    kernel=bart(2), taper=.5, main='segment 1', col=4, xlim=c(0,.25))
mvspec(x[503:1000], kernel=bart(4), taper=.5, main='segment 2', col=4, xlim=c(0,.25))   

## End(Not run)
</code></pre>

<hr>
<h2 id='bart'>
Bartlett Kernel
</h2><span id='topic+bart'></span>

<h3>Description</h3>

<p>Smoothing (triangular) kernel that decreases one unit from the center.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bart(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bart_+3A_m">m</code></td>
<td>
<p>non-negative integer specifying the kernel width, which is <code>2m + 1</code>.  If <code>m</code> has length larger than one, the convolution of the kernel is returned.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>kernel</code> from the <code>stats</code> package to construct a Bartlett (triangular) kernel of width <code>2m + 1</code>; see <code>help(kernel)</code> for further details.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>tskernel</code> with the coefficients, the kernel dimension, and attribute  &quot;Bartlett&quot;.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bart(4)                         # for a list
plot(bart(4), ylim=c(.01,.21))  # for a graph
</code></pre>

<hr>
<h2 id='BCJ'>
Daily Returns of Three Banks
</h2><span id='topic+BCJ'></span>

<h3>Description</h3>

<p>Daily returns of three banks, 1.  Bank of America [boa], 2. Citibank [citi], and
3.  JP Morgan Chase [jpm], from 2005 to 2017.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:3243, 1:3] from 2005 to 2017: -0.01378 -0.01157 -0.00155 -0.01084 0.01252 ...
with column names  &quot;boa&quot; &quot;citi&quot; &quot;jpm&quot; .
</p>


<h3>Source</h3>

<p>Gong &amp; Stoffer (2021). A Note on Efficient Fitting of Stochastic Volatility Models. 
<em>Journal of Time Series Analysis</em>, 42(2), 186-200.
</p>
<p><a href="https://github.com/nickpoison/Stochastic-Volatility-Models">https://github.com/nickpoison/Stochastic-Volatility-Models</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tsplot(BCJ, col=2:4)
</code></pre>

<hr>
<h2 id='beamd'>Infrasonic Signal from a Nuclear Explosion 
</h2><span id='topic+beamd'></span>

<h3>Description</h3>

<p>Infrasonic signal from a nuclear explosion.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(beamd)</code></pre>


<h3>Format</h3>

<p>A data frame with 2048 observations (rows) on 3 numeric variables (columns):  <code>sensor1</code>, <code>sensor2</code>,  <code>sensor3</code>. 
</p>


<h3>Details</h3>

<p>This is a data frame consisting of three columns (that are not time series objects). The data are an infrasonic signal from a nuclear explosion observed at sensors on a triangular array.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='birth'>U.S. Monthly Live Births 
</h2><span id='topic+birth'></span>

<h3>Description</h3>

<p>Monthly live births (adjusted) in thousands for the United States, 1948-1979.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:373] from 1948 to 1979: 295 286 300 278 272 268 308 321 313 308 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='blood'>Daily Blood Work with Missing Values
</h2><span id='topic+blood'></span>

<h3>Description</h3>

<p>Multiple time series of measurements made for 91 days on the three variables, log(white blood count) [WBC], log(platelet) [PLT] and hematocrit [HCT].  Missing data code is NA.
</p>


<h3>Format</h3>

<p>Time-Series [1:91, 1:3] from 1 to 91: 2.33 1.89 2.08 1.82 1.82 ...
</p>
<p>..$ : NULL
..$ : chr [1:3] &quot;WBC&quot; &quot;PLT&quot; &quot;HCT&quot;
</p>


<h3>Details</h3>

<p>This data set is used in Chapter 6 for a missing data example.
</p>


<h3>Source</h3>

<p>Jones, R.H. (1984). Fitting multivariate models to unequally spaced data. In <em>Time Series Analysis of Irregularly Observed Data</em>, pp. 158-188. E. Parzen, ed. Lecture Notes in Statistics, 25, New York: Springer-Verlag.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HCT">HCT</a></code>, <code><a href="#topic+PLT">PLT</a></code>, <code><a href="#topic+WBC">WBC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>tsplot(blood, type='o', pch=19, cex=1.1, col=2:4, gg=TRUE, xlab='day')
</code></pre>

<hr>
<h2 id='bnrf1ebv'>Nucleotide sequence - BNRF1 Epstein-Barr 
</h2><span id='topic+bnrf1ebv'></span>

<h3>Description</h3>

<p>Nucleotide sequence of the BNRF1 gene of the Epstein-Barr virus
(EBV): 1=A, 2=C, 3=G, 4=T. The data are used in Chapter 7.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:3954] from 1 to 3954: 1 4 3 3 1 1 3 1 3 1 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='bnrf1hvs'>Nucleotide sequence - BNRF1 of Herpesvirus saimiri
</h2><span id='topic+bnrf1hvs'></span>

<h3>Description</h3>

<p>Nucleotide sequence of the BNRF1 gene of the herpesvirus saimiri (HVS): 1=A, 2=C, 3=G, 4=T. The data are used in Chapter 7.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:3741] from 1 to 3741: 1 4 3 2 4 4 3 4 4 4 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='cardox'>Monthly Carbon Dioxide Levels at Mauna Loa
</h2><span id='topic+cardox'></span>

<h3>Description</h3>

<p>Monthly mean carbon dioxide (in ppm) measured at Mauna Loa Observatory, Hawaii. 
This is an update to <code>co2</code> in the datasets package.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series  [1:781] from 1958 to 2023: 316 317 318 317 316   ...
</p>


<h3>Details</h3>

<p>The carbon dioxide data measured as the mole fraction in dry air, on Mauna Loa constitute the longest record of direct measurements of CO2 in the atmosphere. They were started by C. David Keeling of the Scripps Institution of Oceanography in March of 1958 at a facility of the National Oceanic and Atmospheric Administration. NOAA started its own CO2 measurements in May of 1974, and they have run in parallel with those made by Scripps since then. Data are reported as a dry mole fraction defined as the number of molecules of carbon dioxide divided by the number of molecules of dry air multiplied by one million (ppm).
</p>
<p>Due to the eruption of the Mauna Loa Volcano, measurements from Mauna Loa Observatory were suspended as of Nov. 29, 2022. Observations starting in December 2022 are from a site at the Maunakea Observatories, approximately 21 miles north of the Mauna Loa Observatory. 
</p>


<h3>Source</h3>

<p><kbd>https://gml.noaa.gov/ccgg/trends/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='ccf2'>Cross Correlation
</h2><span id='topic+ccf2'></span>

<h3>Description</h3>

<p>Calculates and plots the sample CCF of two time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ccf2(x, y, max.lag = NULL, main = NULL, ylab = "CCF", plot = TRUE,
         na.action = na.pass, type = c("correlation", "covariance"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ccf2_+3A_x">x</code>, <code id="ccf2_+3A_y">y</code></td>
<td>
<p>univariate time series
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_max.lag">max.lag</code></td>
<td>

<p>maximum lag for which to calculate the CCF
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_main">main</code></td>
<td>

<p>plot title - if NULL, uses x and y names
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_ylab">ylab</code></td>
<td>

<p>vertical axis label; default is 'CCF'
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_plot">plot</code></td>
<td>

<p>if TRUE (default) a graphic is produced and the values are returned invisibly. Otherwise, the values are returned.
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_na.action">na.action</code></td>
<td>
<p> how to handle missing values; default is <code>na.pass</code>
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_type">type</code></td>
<td>
<p> default is cross-correlation; an option is cross-covariance
</p>
</td></tr>
<tr><td><code id="ccf2_+3A_...">...</code></td>
<td>
<p> additional arguments passed to <code><a href="#topic+tsplot">tsplot</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This will produce a graphic of the sample <code>corr[x(t+lag), y(t)]</code> from <code>-max.lag</code> to <code>max.lag</code>. Also, the (rounded) values of the CCF are returned invisibly unless <code>plot=FALSE</code>.  Similar details apply to the cross-covariance.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acf1">acf1</a></code>, <code><a href="#topic+acf2">acf2</a></code>, <code><a href="#topic+acfm">acfm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>ccf2(soi, rec, plot=FALSE)  # now you see it
ccf2(soi, rec)              # now you don't

# happy birthday mom
ccf2(soi, rec, col=rainbow(36, v=.8), lwd=4, gg=TRUE)
</code></pre>

<hr>
<h2 id='chicken'>Monthly price of a pound of chicken
</h2><span id='topic+chicken'></span>

<h3>Description</h3>

<p>Poultry (chicken), Whole bird spot price, Georgia docks, US cents per pound
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:180] from August 2001 to July 2016: 65.6 66.5 65.7 64.3 63.2 ...
</p>


<h3>Source</h3>

<p><a href="https://www.indexmundi.com/commodities/">https://www.indexmundi.com/commodities/</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='climhyd'>Lake Shasta inflow data
</h2><span id='topic+climhyd'></span>

<h3>Description</h3>

<p>Lake Shasta inflow data.  This is a data frame.
</p>


<h3>Format</h3>

<p>A data frame with 454 observations (rows) on the following 6 numeric variables (columns): <code>Temp</code>, <code>DewPt</code>, <code>CldCvr</code>, <code>WndSpd</code>, <code>Precip</code>, <code>Inflow</code>.
</p>


<h3>Details</h3>

<p>The data are 454 months of measured values for the climatic variables: air temperature, dew point, cloud cover, wind speed, precipitation, and inflow, at Lake Shasta, California.  The man-made lake is famous for the placard stating, &quot;We don't swim in your toilet, so don't pee in our lake.&quot;
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='cmort'>Cardiovascular Mortality from the LA Pollution study
</h2><span id='topic+cmort'></span>

<h3>Description</h3>

<p>Average weekly cardiovascular mortality in Los Angeles County; 508 six-day smoothed averages obtained by filtering daily values over the 10 year period 1970-1979.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:508] from 1970 to 1980: 97.8 104.6 94.4 98 95.8 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lap">lap</a></code></p>

<hr>
<h2 id='cpg'>Hard Drive Cost per GB 
</h2><span id='topic+cpg'></span>

<h3>Description</h3>

<p>Median annual cost per gigabyte (GB) of storage.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:29] from 1980 to 2008:  213000.00 295000.00 260000.00 175000.00 160000.00  ...
</p>


<h3>Details</h3>

<p>The median annual cost of hard drives used in computers. The data are retail prices per GB taken from a sample of manufacturers.   
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='detrend'>
Detrend a Time Series
</h2><span id='topic+detrend'></span>

<h3>Description</h3>

<p>Returns a time series with the trend removed.  The trend can be estimated using polynomial regression or using a lowess fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detrend(series, order = 1, lowess = FALSE, lowspan = 2/3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detrend_+3A_series">series</code></td>
<td>

<p>The time series to be detrended.
</p>
</td></tr>
<tr><td><code id="detrend_+3A_order">order</code></td>
<td>

<p>Order of the polynomial used to estimate the trend with a linear default (order=1) unless <code>lowess</code> is TRUE.
</p>
</td></tr>
<tr><td><code id="detrend_+3A_lowess">lowess</code></td>
<td>

<p>If TRUE, lowess is used to find the trend. The default is FALSE.
</p>
</td></tr>
<tr><td><code id="detrend_+3A_lowspan">lowspan</code></td>
<td>

<p>The smoother span used for lowess.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The detrended series is returned.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trend">trend</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>tsplot( cbind(salmon, detrend(salmon)), gg=TRUE, main='Norwegian Salmon USD/KG' ) 
</code></pre>

<hr>
<h2 id='djia'>Dow Jones Industrial Average
</h2><span id='topic+djia'></span>

<h3>Description</h3>

<p>Daily DJIA values from April 2006 - April 2016
</p>


<h3>Format</h3>

<p>The format is:
xts [1:2518, 1:5] 11279 11343 11347 11337 11283 ...<br />
- attr(*, &quot;class&quot;)= chr [1:2] &quot;xts&quot; &quot;zoo&quot;<br />
..$ : chr [1:5] &quot;Open&quot; &quot;High&quot; &quot;Low&quot; &quot;Close&quot; &quot;Volume&quot;
</p>


<h3>Source</h3>

<p>The data were obtained via the TTR package and Yahoo financial data.
Unfortunately, this does not work now. It seems like the R package
<code>quantmod</code> is a good bet and Yahoo still has financial data.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='dna2vector'>
Convert DNA Sequence to Indicator Vectors
</h2><span id='topic+dna2vector'></span>

<h3>Description</h3>

<p>Takes a string (e.g., a DNA sequence) of general form (e.g., FASTA) and converts it to a sequence of indicator vectors for use with the Spectral Envelope (<code>specenv</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dna2vector(data, alphabet = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dna2vector_+3A_data">data</code></td>
<td>

<p>A single string.
</p>
</td></tr>
<tr><td><code id="dna2vector_+3A_alphabet">alphabet</code></td>
<td>

<p>The particular alphabet  being used. The default is <code>alphabet=c("A", "C", "G", "T")</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Takes a string of categories and converts it to a matrix of indicators. The data can then be used by the script <code><a href="#topic+specenv">specenv</a></code>, which calculates the Spectral Envelope of the sequence (or subsequence). Many different type of sequences can be used, including FASTA and GenBank, as long as the data is a string of categories.
</p>
<p>The indicator vectors (as a matrix) are returned invisibly in case the user forgets to put the results in an object wherein the screen would scroll displaying the entire sequence.  In other words, the user should do something like <code>xdata = dna2vector(data)</code> where <code>data</code> is the original sequence.
</p>
<p>As an example, if the DNA sequence is in a FASTA file, say <code>sequence.fasta</code>, remove the first line, which will look like <code>&gt;V01555.2 ... </code>. Then the following code can be used to read the data into the session, create the indicator sequence and save it as a compressed R data file:
</p>
<pre>
  fileName &lt;- 'sequence.fasta'      # name of FASTA file
  data     &lt;- readChar(fileName, file.info(fileName)$size)  # input the sequence
  myseq    &lt;- dna2vector(data)      # convert it to indicators

  ##== to compress and save the data ==##
  save(myseq, file='myseq.rda')
  ##== and then load it when needed ==##
  load('myseq.rda')
</pre>


<h3>Value</h3>

<p>matrix of indicator vectors; returned invisibly
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+specenv">specenv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Epstein-Barr virus (entire sequence included in astsa)
xdata = dna2vector(EBV)
head(xdata)

# part of EBV with  1, 2, 3, 4 for "A", "C", "G", "T"
xdata = dna2vector(bnrf1ebv)
head(xdata)

# raw GenBank sequence
data &lt;-
c("1 agaattcgtc ttgctctatt cacccttact tttcttcttg cccgttctct ttcttagtat
  61 gaatccagta tgcctgcctg taattgttgc gccctacctc ttttggctgg cggctattgc")
xdata = dna2vector(data, alphabet=c('a', 'c', 'g', 't'))
head(xdata)

# raw FASTA sequence
data &lt;-
 c("AGAATTCGTCTTGCTCTATTCACCCTTACTTTTCTTCTTGCCCGTTCTCTTTCTTAGTATGAATCCAGTA
    TGCCTGCCTGTAATTGTTGCGCCCTACCTCTTTTGGCTGGCGGCTATTGCCGCCTCGTGTTTCACGGCCT")
xdata = dna2vector(data)
head(xdata)
</code></pre>

<hr>
<h2 id='EBV'>Entire Epstein-Barr Virus (EBV) Nucleotide Sequence
</h2><span id='topic+EBV'></span>

<h3>Description</h3>

<p>EBV nucleotide sequence - 172281 bp as a single string
</p>


<h3>Format</h3>

<p>The format is:
chr &quot;AGAATTCGTCTT  ...&quot;
</p>


<h3>Note</h3>

<p>EBV is not useful on its own, but using  'dna2vector', different regions can be explored. For example, <code>ebv = dna2vector(EBV)</code> 
</p>


<h3>Source</h3>

<p><a href="https://www.ncbi.nlm.nih.gov/nuccore/V01555.2">https://www.ncbi.nlm.nih.gov/nuccore/V01555.2</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dna2vector">dna2vector</a></code>
</p>

<hr>
<h2 id='econ5'>Five Quarterly Economic Series
</h2><span id='topic+econ5'></span>

<h3>Description</h3>

<p>Multiple time series of quarterly U.S. unemployment, GNP, consumption, and government and private investment, from 1948-III to 1988-II.
</p>


<h3>Format</h3>

<p>Multiple time series with 161 observations (rows) on the following 5 numeric variables (columns):  <code>unemp</code>, <code>gnp</code>, <code>consum</code>, <code>govinv</code>,     <code>prinv</code>.
</p>


<h3>Source</h3>

<p>Young, P.C. and Pedregal, D.J. (1999). Macro-economic relativity: government spending, private investment and unemployment in the USA 1948-1998. <em>Structural Change and Economic Dynamics</em>, 10, 359-380.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='EM'>
EM Algorithm for State Space Models
</h2><span id='topic+EM'></span>

<h3>Description</h3>

<p>Estimation of the parameters in general linear state space models via the EM algorithm.   
Missing data may be entered as <code>NA</code> or as zero (0), however, use <code>NA</code>s if zero (0) can be an
observation. Inputs in both the state and observation equations are allowed. This script replaces <code>EM0</code> and <code>EM1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM(y, A, mu0, Sigma0, Phi, Q, R, Ups = NULL, Gam = NULL, input = NULL, 
    max.iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_+3A_y">y</code></td>
<td>

<p>data matrix (n <code>x</code> q), vector or time series, n = number of observations, q = number of series.
Use <code>NA</code> or  zero (0) for missing data, however, use <code>NA</code>s if zero (0) can be an
observation.
</p>
</td></tr>
<tr><td><code id="EM_+3A_a">A</code></td>
<td>

<p>measurement matrices; can be constant or an array with dimension <code>dim=c(q,p,n)</code> if time varying.
Use <code>NA</code> or  zero (0) for missing data.
</p>
</td></tr>
<tr><td><code id="EM_+3A_mu0">mu0</code></td>
<td>

<p>initial state mean vector (p <code>x</code> 1)
</p>
</td></tr>
<tr><td><code id="EM_+3A_sigma0">Sigma0</code></td>
<td>

<p>initial state covariance matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="EM_+3A_phi">Phi</code></td>
<td>

<p>state transition matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="EM_+3A_q">Q</code></td>
<td>

<p>state error matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="EM_+3A_r">R</code></td>
<td>

<p>observation error matrix (q <code>x</code> q - diagonal only)
</p>
</td></tr>
<tr><td><code id="EM_+3A_ups">Ups</code></td>
<td>

<p>state input matrix (p <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="EM_+3A_gam">Gam</code></td>
<td>

<p>observation input matrix (q <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="EM_+3A_input">input</code></td>
<td>

<p>NULL (default) if not needed or a   
matrix (n <code>x</code> r) of inputs having the same row dimension (n) as y
</p>
</td></tr>
<tr><td><code id="EM_+3A_max.iter">max.iter</code></td>
<td>

<p>maximum number of iterations
</p>
</td></tr>
<tr><td><code id="EM_+3A_tol">tol</code></td>
<td>

<p>relative tolerance for determining convergence
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This script replaces <code>EM0</code>  and <code>EM1</code> by combining all cases and allowing inputs in the state
and observation equations. It uses version 1 of the new <code><a href="#topic+Ksmooth">Ksmooth</a></code> script (hence correlated errors
is not allowed).
</p>
<p>The states <code class="reqn">x_t</code> are p-dimensional, the data <code class="reqn">y_t</code> are q-dimensional, and 
the inputs <code class="reqn">u_t</code> are r-dimensional for <code class="reqn">t=1, \dots, n</code>. The initial state is <code class="reqn">x_0 \sim N(\mu_0, \Sigma_0)</code>.
</p>
<p>The general model  is 
</p>
<p style="text-align: center;"><code class="reqn">x_t = \Phi  x_{t-1} + \Upsilon u_{t} +    w_t \quad w_t \sim iid\ N(0, Q)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   v_t \quad v_t \sim iid\ N(0, R)</code>
</p>

<p>where <code class="reqn">w_t \perp v_t</code>. The observation noise covariance matrix is assumed to be diagonal and it is forced
to diagonal otherwise.
</p>
<p>The measurement matrices <code class="reqn">A_t</code> can be constant or time varying.  If time varying, they should be entered as an array of dimension <code>dim = c(q,p,n)</code>.  Otherwise, just enter the constant value making sure it has the appropriate <code class="reqn">q \times p</code> dimension.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Phi</code></td>
<td>
<p>Estimate of Phi</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Estimate of Q</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Estimate of R</p>
</td></tr>
<tr><td><code>Ups</code></td>
<td>
<p>Estimate of Upsilon (NULL if not used)</p>
</td></tr>
<tr><td><code>Gam</code></td>
<td>
<p>Estimate of Gamma (NULL if not used)</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>
<p>Estimate of initial state mean</p>
</td></tr>
<tr><td><code>Sigma0</code></td>
<td>
<p>Estimate of initial state covariance matrix</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>-log likelihood at each iteration</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>number of iterations to convergence</p>
</td></tr>
<tr><td><code>cvg</code></td>
<td>
<p>relative tolerance at convergence</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The script does not allow for constrained estimation directly, however, constrained estimation is possible with some extra manipulations. There is an example of constrained estimation using <code>EM</code> at <a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>, where the fun never stops.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kfilter">Kfilter</a>, <a href="#topic+Ksmooth">Ksmooth</a> </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example used for ssm() 
# x[t] = Ups + Phi x[t-1] + w[t]
# y[t] = x[t] + v[t]
y = gtemp_land  
A = 1; Phi = 1; Ups = 0.01
Q = 0.001; R = 0.01
mu0 = -0.6; Sigma0 = 0.02
input = rep(1, length(y))
( em = EM(y, A, mu0, Sigma0, Phi, Q, R, Ups, Gam=NULL, input) ) 
</code></pre>

<hr>
<h2 id='ENSO'>El Nino - Southern Oscillation Index
</h2><span id='topic+ENSO'></span>

<h3>Description</h3>

<p>Southern Oscillation Index (SOI), 1/1951 to 10/2022; anomalies are departures from the 1981-2010 base period.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:862] from 1951 to 2022:  2.0 1.1 -0.3 -0.8 -1.1 -0.7 -1.5 -0.3 -0.7 -0.7
...
</p>


<h3>Details</h3>

<p>The <code class="reqn">\textrm{El Ni\~no - Southern Oscillation (ENSO)}</code> is a recurring climate pattern involving changes in the temperature of waters in the central and eastern tropical Pacific Ocean.  This data set is an update to <code><a href="#topic+soi">soi</a></code>.
</p>


<h3>Source</h3>

<p><kbd>https://www.ncei.noaa.gov/access/monitoring/enso/soi</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soi">soi</a></code></p>

<hr>
<h2 id='EQ5'>Seismic Trace of Earthquake number 5 
</h2><span id='topic+EQ5'></span>

<h3>Description</h3>

<p>Seismic trace of an earthquake [two phases or arrivals along the surface, the primary wave (<code class="reqn">t = 1,\dots,1024</code>) and the shear wave (<code class="reqn">t = 1025,\dots,2048</code>)] recorded at a seismic station.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:2048] from 1 to 2048: 0.01749 0.01139 0.01512 0.01477 0.00651 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eqexp">eqexp</a></code></p>

<hr>
<h2 id='EQcount'>EQ Counts
</h2><span id='topic+EQcount'></span>

<h3>Description</h3>

<p>Series of annual counts of major earthquakes (magnitude 7 and above) in the
world between 1900 and 2006. </p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:107] from 1900 to 2006: 13 14  8 10 16 26  ...
</p>


<h3>Source</h3>

<p>Zucchini and MacDonald (2009). 
Hidden Markov Models for Time Series: An Introduction using R.  CRC Press.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='eqexp'>Earthquake and Explosion Seismic Series
</h2><span id='topic+eqexp'></span>

<h3>Description</h3>

<p>This is a data frame of the earthquake and explosion seismic series used throughout the text. 
</p>


<h3>Format</h3>

<p>A data frame with 2048 observations (rows) on  17 variables (columns).  Each column is a numeric vector.
</p>


<h3>Details</h3>

<p>The matrix has 17 columns, the first eight are earthquakes, the second eight are explosions, and the last column is the Novaya Zemlya event of unknown origin.  
</p>
<p>The column names are: <code>EQ1, EQ2,...,EQ8; EX1, EX2,...,EX8; NZ</code>.  The first 1024 observations correspond to the P wave, the second 1024 observations correspond to the S wave.
</p>
<p>All events in the data set were on or near  land and were distributed uniformly over Scandinavia so as to minimize  the possibility  that discriminators might be keying on location or land-sea differences. The events are earthquakes ranging in magnitude from 2.74 to 4.40 and explosions   in the range 2.13 to 2.19. Also added is an event of uncertain  origin that was located in the Novaya Zemlya region  of  Russia. All events  except the Russian  event occurred in  the Scandinavian peninsula and were recorded by seismic arrays located in Norway  by  Norwegian  and Arctic experimental seismic stations  (NORESS,  ARCESS)  and in Finland by Finnish experimental seismic stations (FINESS).
</p>

<table>
<tr>
 <td style="text-align: right;">
No.</td><td style="text-align: right;"> Type</td><td style="text-align: right;"> Date</td><td style="text-align: right;"> Array </td><td style="text-align: right;"> Magnitude </td><td style="text-align: right;">   Latitude </td><td style="text-align: right;">   Longitude </td>
</tr>
<tr>
 <td style="text-align: right;">
1  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 6/16/92 </td><td style="text-align: right;">  FINESS</td><td style="text-align: right;">  3.22</td><td style="text-align: right;"> 65.5</td><td style="text-align: right;">  22.9 </td>
</tr>
<tr>
 <td style="text-align: right;">
2  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 8/24/91 </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  3.18</td><td style="text-align: right;"> 65.7</td><td style="text-align: right;">  32.1 </td>
</tr>
<tr>
 <td style="text-align: right;">
3  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 9/23/91 </td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  3.15</td><td style="text-align: right;"> 64.5</td><td style="text-align: right;">  21.3 </td>
</tr>
<tr>
 <td style="text-align: right;">
4  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 7/4/92  </td><td style="text-align: right;">  FINESS</td><td style="text-align: right;">  3.60</td><td style="text-align: right;"> 67.8</td><td style="text-align: right;">  15.1 </td>
</tr>
<tr>
 <td style="text-align: right;">
5  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 2/19/92 </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  3.26</td><td style="text-align: right;"> 59.2</td><td style="text-align: right;">  10.9 </td>
</tr>
<tr>
 <td style="text-align: right;">
6  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 4/13/92 </td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  4.40</td><td style="text-align: right;"> 51.4</td><td style="text-align: right;">  6.1  </td>
</tr>
<tr>
 <td style="text-align: right;">
7  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 4/14/92 </td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  3.38</td><td style="text-align: right;"> 59.5</td><td style="text-align: right;">  5.9  </td>
</tr>
<tr>
 <td style="text-align: right;">
8  </td><td style="text-align: right;"> EQ </td><td style="text-align: right;"> 5/18/92 </td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  2.74</td><td style="text-align: right;"> 66.9</td><td style="text-align: right;">  13.7 </td>
</tr>
<tr>
 <td style="text-align: right;">
9  </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 3/23/91 </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  2.85</td><td style="text-align: right;"> 69.2</td><td style="text-align: right;">  34.3 </td>
</tr>
<tr>
 <td style="text-align: right;">
10 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 4/13/91 </td><td style="text-align: right;">  FINESS</td><td style="text-align: right;">  2.60</td><td style="text-align: right;"> 61.8</td><td style="text-align: right;">  30.7 </td>
</tr>
<tr>
 <td style="text-align: right;">
11 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 4/26/91 </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  2.95</td><td style="text-align: right;"> 67.6</td><td style="text-align: right;">  33.9 </td>
</tr>
<tr>
 <td style="text-align: right;">
12 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 8/3/91  </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  2.13</td><td style="text-align: right;"> 67.6</td><td style="text-align: right;">  30.6 </td>
</tr>
<tr>
 <td style="text-align: right;">
13 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 9/5/91  </td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  2.32</td><td style="text-align: right;"> 67.1</td><td style="text-align: right;">  21.0 </td>
</tr>
<tr>
 <td style="text-align: right;">
14 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 12/10/91</td><td style="text-align: right;">  FINESS</td><td style="text-align: right;">  2.59</td><td style="text-align: right;"> 59.5</td><td style="text-align: right;">  24.1 </td>
</tr>
<tr>
 <td style="text-align: right;">
15 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 12/29/91</td><td style="text-align: right;">  ARCESS</td><td style="text-align: right;">  2.96</td><td style="text-align: right;"> 69.4</td><td style="text-align: right;">  30.8 </td>
</tr>
<tr>
 <td style="text-align: right;">
16 </td><td style="text-align: right;"> EX </td><td style="text-align: right;"> 3/25/92 </td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  2.94</td><td style="text-align: right;"> 64.7</td><td style="text-align: right;">  30.8 </td>
</tr>
<tr>
 <td style="text-align: right;">
17 </td><td style="text-align: right;"> NZ </td><td style="text-align: right;"> 12/31/92</td><td style="text-align: right;">  NORESS</td><td style="text-align: right;">  2.50</td><td style="text-align: right;"> 73.6</td><td style="text-align: right;">  55.2 </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# view all series 
# first 2 rows EQs - second 2 rows EXs
# 5th row NZ event 

tsplot(eqexp, ncol=4, col=1:8)

## End(Not run)
</code></pre>

<hr>
<h2 id='ESS'>
Effective Sample Size (ESS)
</h2><span id='topic+ESS'></span>

<h3>Description</h3>

<p>Estimates the ESS of a given vector of samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ESS(trace, tol = 1e-08, BIC = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ESS_+3A_trace">trace</code></td>
<td>

<p>vector of sampled values from an MCMC run (univariate only)
</p>
</td></tr>
<tr><td><code id="ESS_+3A_tol">tol</code></td>
<td>

<p>ESS is returned as zero if the estimated spectrum at frequency zero is less than this value
</p>
</td></tr>
<tr><td><code id="ESS_+3A_bic">BIC</code></td>
<td>

<p>if TRUE (default), <code>spec0</code> is obtained using BIC;
otherwise, AIC is used.  See the details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="#topic+spec.ic">spec.ic</a></code> to estimate the spectrum of the input at frequency zero (<code>spec0</code>). Then, ESS is estimated as
<code>ESS = length(trace)*var(trace)/spec0</code>.  
</p>


<h3>Value</h3>

<p>Returns the estimated ESS of the input.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit an AR(2) to the Recruitment series
u = ar.mcmc(rec, porder=2, n.iter=1000, plot=FALSE) 
# then calculate the ESSs 
apply(u, 2, ESS)
</code></pre>

<hr>
<h2 id='EXP6'>Seismic Trace of Explosion number 6
</h2><span id='topic+EXP6'></span>

<h3>Description</h3>

<p>Seismic trace of an explosion [two phases or arrivals along the surface, the primary wave (<code class="reqn">t = 1,\dots,1024</code>) and the shear wave (<code class="reqn">t = 1025,\dots,2048</code>)] recorded at a seismic station.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:2048] from 1 to 2048: -0.001837 -0.000554 -0.002284 -0.000303 -0.000721 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eqexp">eqexp</a></code></p>

<hr>
<h2 id='FDR'>Basic False Discovery Rate
</h2><span id='topic+FDR'></span>

<h3>Description</h3>

<p>Computes the basic false discovery rate given a vector of p-values and returns the index of the maximal p-value satisfying the FDR condition. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FDR(pvals, qlevel = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FDR_+3A_pvals">pvals</code></td>
<td>
<p> a vector of pvals on which to conduct the multiple testing
</p>
</td></tr>
<tr><td><code id="FDR_+3A_qlevel">qlevel</code></td>
<td>
<p> the proportion of false positives desired
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fdr.id</code></td>
<td>
<p> NULL if no significant tests, or the index of the maximal p-value satisfying the FDR condition. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is used primarily in Chapter 7.
</p>


<h3>Source</h3>

<p>Built off of <a href="https://www.stat.berkeley.edu/~paciorek/code/fdr/fdr.R">https://www.stat.berkeley.edu/~paciorek/code/fdr/fdr.R</a>.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='ffbs'>
Forward Filtering Backward Sampling
</h2><span id='topic+ffbs'></span>

<h3>Description</h3>

<p>FFBS algorithm for state space models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ffbs(y, A, mu0, Sigma0, Phi, sQ, sR, Ups = NULL, Gam = NULL, input = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffbs_+3A_y">y</code></td>
<td>
<p>Data matrix, vector or time series.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_a">A</code></td>
<td>
<p>Observation matrix. Can be constant or an array with 
<code>dim=c(q,p,n)</code> if time varying.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_mu0">mu0</code></td>
<td>
<p>Initial state mean.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_sigma0">Sigma0</code></td>
<td>
<p>Initial state covariance matrix.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_phi">Phi</code></td>
<td>
<p>State transition matrix.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_sq">sQ</code></td>
<td>
<p>State error covariance matrix is <code>Q = sQ%*%t(sQ)</code> &ndash; see details below. In the univariate case, it is the standard deviation.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_sr">sR</code></td>
<td>
<p>Observation error covariance matrix is <code>R = sR%*%t(sR)</code> &ndash; see details below. In the univariate case, it is the standard deviation.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_ups">Ups</code></td>
<td>
<p>State input matrix.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_gam">Gam</code></td>
<td>
<p>Observation input matrix.
</p>
</td></tr>
<tr><td><code id="ffbs_+3A_input">input</code></td>
<td>
<p>matrix or vector of inputs having the same row dimension as y.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a linear state space model,
the FFBS algorithm provides a way to sample a state sequence <code class="reqn">x_{0:n}</code> 
from the posterior <code class="reqn">\pi(x_{0:n} \mid \Theta, y_{1:n})</code>
with parameters <code class="reqn">\Theta</code> and  data <code class="reqn">y_{1:n}</code>.
</p>
<p>The general model  is
</p>
<p style="text-align: center;"><code class="reqn">x_t = \Phi  x_{t-1} + \Upsilon u_{t} +   sQ\,  w_t \quad w_t \sim iid\ N(0,I)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   sR\, v_t \quad v_t \sim iid\ N(0,I)</code>
</p>

<p>where <code class="reqn">w_t \perp v_t</code>. Consequently the state noise covariance matrix is
<code class="reqn">Q = sQ\, sQ'</code> and the observation noise covariance matrix is
<code class="reqn">R = sR\, sR'</code> and <code class="reqn">sQ, sR</code>  do not have to be square as long as everything is
conformable.
</p>
<p><code class="reqn">x_t</code> is p-dimensional, <code class="reqn">y_t</code> is q-dimensional, and  <code class="reqn">u_t</code> is r-dimensional.
Note that <code class="reqn">sQ\, w_t</code>  has to be p-dimensional, but  <code class="reqn">w_t</code> does not, and
<code class="reqn">sR\, v_t</code>  has to be q-dimensional, but  <code class="reqn">v_t</code> does not.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Xs</code></td>
<td>
<p>An array of sampled states</p>
</td></tr>
<tr><td><code>X0n</code></td>
<td>
<p>The sampled initial state (because R is 1-based) </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The script uses <code><a href="#topic+Kfilter">Kfilter</a></code>.  If <code class="reqn">A_t</code> is constant wrt time, it is not necessary to
input an array; see the example.  The example below is just one pass of the algorithm; see the example
at <a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md#gibbs-sampling-for-linear-state-space-models">FUN WITH ASTSA</a> for the real fun.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>Chapter 6 of the Shumway and Stoffer Springer text. 
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at 
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## -- this is just one pass --##
# generate some data
 set.seed(1)
 sQ  = 1; sR = 3; n = 100  
 mu0 = 0; Sigma0 = 10; x0 = rnorm(1,mu0,Sigma0)
 w = rnorm(n); v = rnorm(n)
 x = c(x0 + sQ*w[1]);  y = c(x[1] + sR*v[1])   # initialize
for (t in 2:n){
  x[t] = x[t-1] + sQ*w[t]
  y[t] = x[t] + sR*v[t]   
  }

## run one pass of FFBS, plot data, states and sampled states  
run = ffbs(y, A=1, mu0=0, Sigma0=10, Phi=1, sQ=1, sR=3)
tsplot(cbind(y,run$Xs), spaghetti=TRUE, type='o', col=c(8,4), pch=c(1,NA))
legend('topleft', legend=c("y(t)","xs(t)"), lty=1, col=c(8,4), bty="n", pch=c(1,NA))

## End(Not run)
</code></pre>

<hr>
<h2 id='flu'>Monthly pneumonia and influenza deaths in the U.S., 1968 to 1978.
</h2><span id='topic+flu'></span>

<h3>Description</h3>

<p>Monthly pneumonia and influenza deaths per 10,000 people in the United States for 11 years, 1968 to 1978.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(flu)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:132] from 1968 to 1979: 0.811 0.446 0.342 0.277 0.248 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='fmri'>fMRI - complete data set
</h2><span id='topic+fmri'></span>

<h3>Description</h3>

<p>Data (as a vector list) from an fMRI experiment in pain, listed  by location and stimulus.  The data are BOLD signals when a stimulus was applied for 32 seconds and then stopped for 32 seconds. The signal period is 64 seconds and the sampling rate was one observation every 2 seconds for 256 seconds (<code class="reqn">n = 128</code>).  The number of subjects under each condition varies.
</p>


<h3>Details</h3>

<p>The LOCATIONS of the brain where the signal was measured were [1] Cortex 1: Primary Somatosensory, Contralateral, [2] Cortex 2: Primary Somatosensory, Ipsilateral, [3] Cortex 3: Secondary Somatosensory, Contralateral, [4] Cortex 4: Secondary Somatosensory, Ipsilateral, [5] Caudate, [6] Thalamus 1: Contralateral, [7] Thalamus 2: Ipsilateral, [8] Cerebellum 1: Contralateral and [9] Cerebellum 2: Ipsilateral.
</p>
<p>The TREATMENTS or stimuli (and number of subjects in each condition) are [1] Awake-Brush (5 subjects), [2] Awake-Heat (4 subjects), [3] Awake-Shock (5 subjects), [4] Low-Brush (3 subjects), [5] Low-Heat (5 subjects), and [6] Low-Shock (4 subjects). Issue the command <code>summary(fmri)</code> for further details.  In particular, awake (Awake) or mildly anesthetized (Low) subjects  were subjected  levels of periodic brushing (Brush), application of heat (Heat), and mild shock (Shock) effects.
</p>
<p>As an example, <code>fmri$L1T6</code> (Location 1, Treatment 6) will show the data for the four subjects receiving the Low-Shock treatment at the Cortex 1 location; note that <code>fmri[[6]]</code> will display the same data.
</p>


<h3>Source</h3>

<p>Joseph F. Antognini, Michael H. Buonocore, Elizabeth A. Disbrow, Earl Carstens,
Isoflurane anesthesia blunts cerebral responses to noxious and innocuous stimuli: a fMRI study,
Life Sciences, Volume 61, Issue 24, 1997, Pages PL349-PL354, ISSN 0024-3205, <br />
<kbd>https://doi.org/10.1016/S0024-3205(97)00960-0</kbd>.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='fmri1'>fMRI Data Used in Chapter 1
</h2><span id='topic+fmri1'></span>

<h3>Description</h3>

<p>A data frame that consists of average fMRI BOLD signals at eight locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fmri1)</code></pre>


<h3>Format</h3>

<p>The format is:
mts [1:128, 1:9] </p>


<h3>Details</h3>

<p>Multiple time series consisting of fMRI BOLD signals at eight locations (in columns 2-9, column 1 is time period), when a stimulus was applied for 32 seconds and then stopped for 32 seconds. The signal period is 64 seconds and the sampling rate was one observation every 2 seconds for 256 seconds (<code class="reqn">n = 128</code>).  The columns are labeled: &quot;time&quot; &quot;cort1&quot; &quot;cort2&quot; &quot;cort3&quot;  &quot;cort4&quot;   &quot;thal1&quot;   &quot;thal2&quot;  &quot;cere1&quot;  &quot;cere2&quot;.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fmri">fmri</a></code></p>

<hr>
<h2 id='gas'>Gas Prices
</h2><span id='topic+gas'></span>

<h3>Description</h3>

<p>New York Harbor conventional regular gasoline weekly spot price FOB (in cents per gallon) from 2000 to mid-2010.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:545] from 2000 to 2010: 70.6 71 68.5 65.1 67.9 ...
</p>


<h3>Details</h3>

<p>Pairs with series <code>oil</code>
</p>


<h3>Source</h3>

<p>Data were obtained from: <kbd>https://www.eia.gov/dnav/pet/pet_pri_spt_s1_w.htm</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oil">oil</a></code></p>

<hr>
<h2 id='gdp'>Quarterly U.S. GDP
</h2><span id='topic+gdp'></span>

<h3>Description</h3>

<p>Seasonally adjusted quarterly U.S. GDP from 1947(1) to 2018(3).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:287] from 1947 to 2018: 2033 2028 2023 2055 2086 ...
</p>


<h3>Source</h3>

<p><a href="https://tradingeconomics.com/united-states/gdp">https://tradingeconomics.com/united-states/gdp</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><a href="#topic+GDP">GDP</a>
</p>

<hr>
<h2 id='GDP23'>Quarterly U.S. GDP - updated to 2023
</h2><span id='topic+GDP'></span>

<h3>Description</h3>

<p>Seasonally adjusted quarterly U.S. GDP from 1947(1) to 2023(1).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:305] from 1947 to 2023: 243.164 245.968 249.585 259.745 ...
</p>


<h3>Source</h3>

<p><kbd>https://fred.stlouisfed.org/series/GDP</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><a href="#topic+gdp">gdp</a>
</p>

<hr>
<h2 id='gnp'>Quarterly U.S. GNP
</h2><span id='topic+gnp'></span>

<h3>Description</h3>

<p>Seasonally adjusted quarterly U.S. GNP from 1947(1) to 2002(3).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:223] from 1947 to 2002: 1489 1497 1500 1524 1547 ...
</p>


<h3>Source</h3>

<p><a href="https://research.stlouisfed.org/">https://research.stlouisfed.org/</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><a href="#topic+GNP">GNP</a>
</p>

<hr>
<h2 id='GNP23'>Quarterly U.S. GNP - updated to 2023
</h2><span id='topic+GNP'></span>

<h3>Description</h3>

<p>Seasonally adjusted quarterly U.S. GNP from 1947(1) to 2003(1).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:305] from 1947 to 2023: 244.142 247.063 250.716 260.981 ...
</p>


<h3>Source</h3>

<p><kbd>https://fred.stlouisfed.org/series/GNP</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><a href="#topic+gnp">gnp</a>
</p>

<hr>
<h2 id='Grid'>A Better Add Grid to a Plot
</h2><span id='topic+Grid'></span>

<h3>Description</h3>

<p>Adds a grid to an existing plot with major and minor ticks.  Works like R graphics grid() but the grid lines are solid and gray and minor ticks are produced by default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Grid(nx = NULL, ny = nx, col = gray(0.9), lty = 1, lwd = par("lwd"), equilogs = TRUE,
    minor = TRUE, nxm = 2, nym = 2, tick.ratio = 0.5, xm.grid = TRUE, ym.grid = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Grid_+3A_nx">nx</code>, <code id="Grid_+3A_ny">ny</code></td>
<td>

<p>number of cells of the grid in x and y direction. When NULL, as per default, the grid aligns with the tick marks on the corresponding default axis (i.e., tickmarks as computed by axTicks).  When NA, no grid lines are drawn in the corresponding direction.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_col">col</code></td>
<td>

<p>color of the grid lines.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_lty">lty</code></td>
<td>

<p>line type of the grid lines.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_lwd">lwd</code></td>
<td>

<p>line width of the grid lines.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_equilogs">equilogs</code></td>
<td>

<p>logical, only used when log coordinates and alignment with the axis tick marks are active.  Setting equilogs = FALSE in that case gives non equidistant tick aligned grid lines.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_minor">minor</code></td>
<td>

<p>logical with TRUE (default) adding minor ticks.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_nxm">nxm</code>, <code id="Grid_+3A_nym">nym</code></td>
<td>

<p>number of intervals in which to divide the area between major tick marks on the x-axis (y-axis). If minor=TRUE, should be &gt; 1 or no minor ticks will be drawn.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_tick.ratio">tick.ratio</code></td>
<td>

<p>ratio of lengths of minor tick marks to major tick marks. The length of major tick marks is retrieved from par(&quot;tck&quot;).
</p>
</td></tr>
<tr><td><code id="Grid_+3A_xm.grid">xm.grid</code>, <code id="Grid_+3A_ym.grid">ym.grid</code></td>
<td>

<p>if TRUE (default), adds grid lines at minor x-axis, y-axis ticks.
</p>
</td></tr>
<tr><td><code id="Grid_+3A_...">...</code></td>
<td>

<p>other graphical parameters;
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>The code for <code>grid()</code> in R graphics and <code>minor.tick()</code> from the Hmisc package were combined.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+grid">grid</a></code>
</p>

<hr>
<h2 id='gtemp_both'>Global mean land and open ocean temperature deviations, 1850-2023
</h2><span id='topic+gtemp_both'></span>

<h3>Description</h3>

<p>Annual temperature anomalies (in degress centigrade) averaged over the Earth's land and ocean area from 1850 to 2023.  Anomalies are with respect to the 1991-2020 average.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:174] from 1850 to 2023: -0.24 -0.25 -0.27 -0.15 -0.05 -0.16 -0.29 -0.32 -0.19 -0.04 ...
</p>


<h3>Source</h3>

<p><kbd>https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/global/time-series/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code></p>

<hr>
<h2 id='gtemp_land'>Global mean land temperature deviations, 1850-2023
</h2><span id='topic+gtemp_land'></span>

<h3>Description</h3>

<p>Annual temperature anomalies (in degress centigrade) averaged over the Earth's land area from 1850 to 2023.
Anomalies are with respect to the 1991-2020 average.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:174] from 1850 to 2023: -0.50 -0.60 -0.50 -0.50 -0.20 -0.50 -0.80 -0.40 -0.40 -0.10 ...
</p>


<h3>Source</h3>

<p><kbd>https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/global/time-series/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='gtemp_ocean'>Global mean ocean temperature deviations, 1850-2023
</h2><span id='topic+gtemp_ocean'></span>

<h3>Description</h3>

<p>Annual sea surface temperature anomalies averaged over the part of the ocean that is free of ice at all times (open ocean) from 1850 to 2023.  Anomalies are with respect to the 1991-2020 average.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:174] from 1850 to 2023: -0.12 -0.08 -0.14  0.04  0.04  0.00 -0.05 -0.27 -0.09  0.01 ...
</p>


<h3>Source</h3>

<p><kbd>https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/global/time-series/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='Hare'>Snowshoe Hare
</h2><span id='topic+Hare'></span>

<h3>Description</h3>

<p>This is one of the classic studies of predator-prey interactions, the 90-year data set is the number, in thousands, of snowshoe hare pelts  purchased by the Hudson's Bay Company of Canada. While this is an indirect measure of predation, the assumption is that there is a direct relationship between the number of pelts collected and the number of hare and lynx in the wild.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Hare")</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:91] from 1845 to 1935: 19.6 19.6 19.6 12 28 ...
</p>


<h3>Note</h3>

<p>This data set pairs with <code><a href="#topic+Lynx">Lynx</a></code>.
The data are in  units of one  thousand.
</p>


<h3>Source</h3>

<p>From Odum's &quot;Fundamentals of Ecology&quot;,  p. 191.
Data listed at:<br />
<kbd>people.whitman.edu/~hundledr/courses/M250F03/LynxHare.txt</kbd>.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Lynx">Lynx</a></code></p>

<hr>
<h2 id='HCT'>Hematocrit Levels
</h2><span id='topic+HCT'></span>

<h3>Description</h3>

<p>HCT: Measurements made for 91 days on the three variables, log(white blood count) [WBC], log(platelet) [PLT] and hematocrit [HCT].  Missing data code is 0 (zero).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:91] from 1 to 91: 30 30 28.5 34.5 34 32 30.5 31 33 34 ...
</p>


<h3>Details</h3>

<p>See Examples 6.1 and 6.9 for more details.
</p>


<h3>Source</h3>

<p>Jones, R.H. (1984). Fitting multivariate models to unequally spaced data. In <em>Time Series Analysis of Irregularly Observed Data</em>, pp. 158-188. E. Parzen, ed. Lecture Notes in Statistics, 25, New York: Springer-Verlag.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+blood">blood</a></code>, <code><a href="#topic+PLT">PLT</a></code>, <code><a href="#topic+WBC">WBC</a></code></p>

<hr>
<h2 id='hor'>Hawaiian occupancy rates</h2><span id='topic+hor'></span>

<h3>Description</h3>

<p>Quarterly Hawaiian hotel occupancy rate (percent of rooms occupied) from 
1982-I to 2015-IV
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:136] from 1982 to 2015: 79  65.9  70.9  66.7  ...
</p>


<h3>Source</h3>

<p><a href="https://dbedt.hawaii.gov/economic/qser/tourism/">https://dbedt.hawaii.gov/economic/qser/tourism/</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tsplot(hor, type='c')                           # plot data and
text(hor, labels=1:4, col=c(1,4,2,6), cex=.9)   # add quarter labels
</code></pre>

<hr>
<h2 id='jj'>Johnson and Johnson Quarterly Earnings Per Share
</h2><span id='topic+jj'></span>

<h3>Description</h3>

<p>Johnson and Johnson quarterly earnings per share, 84 quarters (21 years) measured from the first quarter of 1960 to the last quarter of 1980.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:84] from 1960 to 1981: 0.71 0.63 0.85 0.44 0.61 0.69 0.92 0.55 0.72 0.77 ...
</p>


<h3>Details</h3>

<p>The data were provided (personal communication) by Professor Paul Griffin, <kbd>https://gsm.ucdavis.edu/profile/paul-griffin</kbd>, of the Graduate School of Management, University of California, Davis. This data set is also included with the R distribution as <code>JohnsonJohnson</code>.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='Kfilter'>
Quick Kalman Filter 
</h2><span id='topic+Kfilter'></span>

<h3>Description</h3>

<p>Returns both the predicted and filtered values for various linear  state space models;
it also evaluates the likelihood at the given parameter values.
This script replaces <code>Kfilter0</code>, <code>Kfilter1</code>, and <code>Kfilter2</code> 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kfilter(y, A, mu0, Sigma0, Phi, sQ, sR, Ups = NULL, Gam = NULL, 
         input = NULL, S = NULL, version = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kfilter_+3A_y">y</code></td>
<td>

<p>data matrix (n <code>x</code> q), vector or time series, n = number of observations.
Use <code>NA</code> or  zero (0) for missing data.
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_a">A</code></td>
<td>

<p>can be constant or an array with dimension <code>dim=c(q,p,n)</code> if time varying (see details).
Use <code>NA</code> or  zero (0) for missing data.
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_mu0">mu0</code></td>
<td>

<p>initial state mean vector (p <code>x</code> 1)
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_sigma0">Sigma0</code></td>
<td>

<p>initial state covariance matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_phi">Phi</code></td>
<td>

<p>state transition matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_sq">sQ</code></td>
<td>

<p>state error pre-matrix (see details)
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_sr">sR</code></td>
<td>

<p>observation error pre-matrix (see details)
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_ups">Ups</code></td>
<td>

<p>state input matrix (p <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_gam">Gam</code></td>
<td>

<p>observation input matrix (q <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_input">input</code></td>
<td>

<p>NULL (default) if not needed or a   
matrix (n <code>x</code> r) of inputs having the same row dimension (n) as y
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_s">S</code></td>
<td>

<p>covariance matrix between the (not premultiplied) state and observation errors; not necessary to specify if not needed and only used if version=2. See details for more information.
</p>
</td></tr>
<tr><td><code id="Kfilter_+3A_version">version</code></td>
<td>

<p>either 1 (default) or 2; version 2 allows for correlated errors
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This script replaces <code>Kfilter0</code>, <code>Kfilter1</code>, and <code>Kfilter2</code> by combining all
cases. The major difference is how to specify the covariance matrices; in particular, 
<code>sQ = t(cQ)</code> and <code>sR = t(cR)</code> where <code>cQ</code> and <code>cR</code> were used in <code>Kfilter0-1-2</code> scripts.
</p>
<p>The states <code class="reqn">x_t</code> are p-dimensional, the data <code class="reqn">y_t</code> are q-dimensional, and 
the inputs <code class="reqn">u_t</code> are r-dimensional for <code class="reqn">t=1, \dots, n</code>. The initial state is <code class="reqn">x_0 \sim N(\mu_0, \Sigma_0)</code>.
</p>
<p>The measurement matrices <code class="reqn">A_t</code> can be constant or time varying.  If   time varying, they should be entered as an array of dimension <code>dim = c(q,p,n)</code>.  Otherwise, just enter the constant value making sure it has the appropriate <code class="reqn">q \times p</code> dimension.
</p>
<p>Version 1 (default): The general model  is 
</p>
<p style="text-align: center;"><code class="reqn">x_t = \Phi  x_{t-1} + \Upsilon u_{t} +   sQ\,  w_t \quad w_t \sim iid\ N(0,I)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   sR\, v_t \quad v_t \sim iid\ N(0,I)</code>
</p>

<p>where <code class="reqn">w_t \perp v_t</code>. Consequently the state noise covariance matrix is
<code class="reqn">Q = sQ\, sQ'</code> and the observation noise covariance matrix is
<code class="reqn">R = sR\, sR'</code> and <code class="reqn">sQ, sR</code>  do not have to be square as long as everything is
conformable.  Notice the specification of the state and observation covariances has changed from the original scripts.
</p>
<p><em>NOTE:</em> If it is easier to model in terms of <code class="reqn">Q</code> and <code class="reqn">R</code>, simply input the square root matrices
<code>sQ = Q %^% .5</code> and <code>sR = R %^% .5</code>.
</p>
<p>Version 2 (correlated errors): The general model  is
</p>
<p style="text-align: center;"><code class="reqn">x_{t+1} = \Phi  x_{t} + \Upsilon u_{t+1} +   sQ\,  w_t \quad w_t \sim iid\ N(0,I)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   sR\, v_t \quad v_t \sim iid\ N(0,I)</code>
</p>

<p>where <code class="reqn">S = {\rm Cov}(w_t, v_t)</code>, and NOT  <code class="reqn"> {\rm Cov}(sQ\, w_t, sR\, v_t)</code>.
</p>
<p><em>NOTE:</em>   If it is easier to model in terms of <code class="reqn">Q</code> and <code class="reqn">R</code>, simply input the square root matrices
<code>sQ = Q %^% .5</code> and <code>sR = R %^% .5</code>.
</p>
<p>Note that in either version, <code class="reqn">sQ\, w_t</code>  has to be p-dimensional, but  <code class="reqn">w_t</code> does not, and
<code class="reqn">sR\, v_t</code>  has to be q-dimensional, but  <code class="reqn">v_t</code> does not.
</p>


<h3>Value</h3>

<p>Time varying values are returned as arrays.
</p>
<table>
<tr><td><code>Xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>Xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>innov</code></td>
<td>
<p>innovation series</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>innovation covariances</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain, needed for smoothing</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that <code>Kfilter</code> is similar to <code>Kfilter-0-1-2</code> except that only the essential values need to be entered (and come first in the statement); the optional values such as 
<code>input</code> are set to <code>NULL</code> by default if they are not needed. This version is faster
than the older versions. The biggest change was to how the covarainces are specified. For example, if you have code that used <code>Kfilter1</code>, just use <code>sQ = t(cQ)</code> and <code>sR = t(cR)</code> here.
</p>
<p>NOTE: If it is easier to model in terms of <code class="reqn">Q</code> and <code class="reqn">R</code>, simply input the square root matrices
<code>sQ = Q%^%.5</code> and <code>sR = R%^%.5</code>.   
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ksmooth">Ksmooth</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate some data
 set.seed(1)
 sQ  = 1; sR = 3; n = 100  
 mu0 = 0; Sigma0 = 10; x0 = rnorm(1,mu0,Sigma0)
 w = rnorm(n); v = rnorm(n)
 x = c(x0 + sQ*w[1]);  y = c(x[1] + sR*v[1])   # initialize
for (t in 2:n){
  x[t] = x[t-1] + sQ*w[t]
  y[t] = x[t] + sR*v[t]   
  }
# run and plot the filter  
run = Kfilter(y, A=1, mu0, Sigma0, Phi=1, sQ, sR)
tsplot(cbind(y,run$Xf), spaghetti=TRUE, type='o', col=c(4,6), pch=c(1,NA), margins=1)
# CRAN tests need extra white space :( so margins=1 above is not necessary otherwise
legend('topleft', legend=c("y(t)","Xf(t)"), lty=1, col=c(4,6), bty="n", pch=c(1,NA))
</code></pre>

<hr>
<h2 id='Ksmooth'>
Quick Kalman Smoother
</h2><span id='topic+Ksmooth'></span>

<h3>Description</h3>

<p>Returns the smoother values for various linear  state space models. The predicted and filtered values and
the likelihood at the given parameter values are also returned (via <code>Kfilter</code>). 
This script replaces <code>Ksmooth0</code>, <code>Ksmooth1</code>, and <code>Ksmooth2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ksmooth(y, A, mu0, Sigma0, Phi, sQ, sR, Ups = NULL, Gam = NULL, 
         input = NULL, S = NULL, version = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ksmooth_+3A_y">y</code></td>
<td>

<p>data matrix (n <code>x</code> q), vector or time series, n = number of observations.
Use <code>NA</code> or  zero (0) for missing data.
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_a">A</code></td>
<td>

<p>can be constant or an array with dimension <code>dim=c(q,p,n)</code> if time varying (see details).
Use <code>NA</code> or  zero (0) for missing data.
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_mu0">mu0</code></td>
<td>

<p>initial state mean vector (p <code>x</code> 1)
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_sigma0">Sigma0</code></td>
<td>

<p>initial state covariance matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_phi">Phi</code></td>
<td>

<p>state transition matrix (p <code>x</code> p)
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_sq">sQ</code></td>
<td>

<p>state error pre-matrix (see details)
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_sr">sR</code></td>
<td>

<p>observation error pre-matrix (see details)
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_ups">Ups</code></td>
<td>

<p>state input matrix (p <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_gam">Gam</code></td>
<td>

<p>observation input matrix (q <code>x</code> r); leave as NULL (default) if not needed
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_input">input</code></td>
<td>

<p>NULL (default) if not needed or a   
matrix (n <code>x</code> r) of inputs having the same row dimension (n) as y
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_s">S</code></td>
<td>

<p>covariance matrix between state and observation errors; not necessary to specify if not needed and only used if version=2; see details
</p>
</td></tr>
<tr><td><code id="Ksmooth_+3A_version">version</code></td>
<td>

<p>either 1 (default) or 2; version 2 allows for correlated errors
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This script replaces <code>Ksmooth0</code>, <code>Ksmooth1</code>, and <code>Ksmooth2</code> by combining all
cases. The major difference is how to specify the covariance matrices; in particular, 
<code>sQ = t(cQ)</code> and <code>sR = t(cR)</code> where <code>cQ</code> and <code>cR</code> were used in <code>Kfilter0-1-2</code> scripts.
</p>
<p>The states <code class="reqn">x_t</code> are p-dimensional, the data <code class="reqn">y_t</code> are q-dimensional, and 
the inputs <code class="reqn">u_t</code> are r-dimensional for <code class="reqn">t=1, \dots, n</code>. The initial state is <code class="reqn">x_0 \sim N(\mu_0, \Sigma_0)</code>.
</p>
<p>The measurement matrices <code class="reqn">A_t</code> can be constant or time varying.  If   time varying, they should be entered as an array of dimension <code>dim = c(q,p,n)</code>.  Otherwise, just enter the constant value making sure it has the appropriate <code class="reqn">q \times p</code> dimension.
</p>
<p>Version 1 (default): The general model  is 
</p>
<p style="text-align: center;"><code class="reqn">x_t = \Phi  x_{t-1} + \Upsilon u_{t} +   sQ\,  w_t \quad w_t \sim iid\ N(0,I)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   sR\, v_t \quad v_t \sim iid\ N(0,I)</code>
</p>

<p>where <code class="reqn">w_t \perp v_t</code>. Consequently the state noise covariance matrix is
<code class="reqn">Q = sQ\, sQ'</code> and the observation noise covariance matrix is
<code class="reqn">R = sR\, sR'</code> and <code class="reqn">sQ, sR</code>  do not have to be square as long as everything is
conformable.  Notice the specification of the state and observation covariances has changed from the original scripts.
</p>
<p><em>NOTE:</em> If it is easier to model in terms of <code class="reqn">Q</code> and <code class="reqn">R</code>, simply input the square root matrices
<code>sQ = Q %^% .5</code> and <code>sR = R %^% .5</code>.
</p>
<p>Version 2 (correlated errors): The general model  is
</p>
<p style="text-align: center;"><code class="reqn">x_{t+1} = \Phi  x_{t} + \Upsilon u_{t+1} +   sQ\,  w_t \quad w_t \sim iid\ N(0,I)</code>
</p>

<p style="text-align: center;"><code class="reqn">y_t = A_t  x_{t-1} + \Gamma u_{t} +   sR\, v_t \quad v_t \sim iid\ N(0,I)</code>
</p>

<p>where <code class="reqn">S = {\rm Cov}(w_t, v_t)</code>, and NOT  <code class="reqn">{\rm Cov}(sQ\, w_t, sR\, v_t)</code>.
</p>
<p><em>NOTE:</em> If it is easier to model in terms of <code class="reqn">Q</code> and <code class="reqn">R</code>, simply input the square root matrices
<code>sQ = Q %^% .5</code> and <code>sR = R %^% .5</code>.
</p>
<p>Note that in either version, <code class="reqn">sQ\, w_t</code>  has to be p-dimensional, but  <code class="reqn">w_t</code> does not, and
<code class="reqn">sR\, v_t</code>  has to be q-dimensional, but  <code class="reqn">v_t</code> does not.
</p>


<h3>Value</h3>

 
<p>Time varying values are returned as arrays. 
</p>
<table>
<tr><td><code>Xs</code></td>
<td>
<p>state smoothers</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>smoother mean square error</p>
</td></tr>
<tr><td><code>X0n</code></td>
<td>
<p>initial mean smoother</p>
</td></tr>
<tr><td><code>P0n</code></td>
<td>
<p>initial smoother covariance</p>
</td></tr>
<tr><td><code>J0</code></td>
<td>
<p>initial value of the J matrix</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>the J matrices</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>state predictors</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>Xf</code></td>
<td>
<p>state filters</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>negative of the log likelihood</p>
</td></tr>
<tr><td><code>innov</code></td>
<td>
<p>innovation series</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>innovation covariances</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>the value of the last Gain</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that <code>Ksmooth</code> is similar to <code>Ksmooth-0-1-2</code> except that only the essential values need to be entered (and come first in the statement); the optional values such as 
<code>input</code> are set to <code>NULL</code> by default if they are not needed. This version is faster
than the older versions. The biggest change was to how the covarainces are specified. For example, if you have code that used <code>Ksmooth1</code>, just use <code>sQ = t(cQ)</code> and <code>sR = t(cR)</code> here.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kfilter">Kfilter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate some data
 set.seed(1)
 sQ  = 1; sR = 3; n = 100  
 mu0 = 0; Sigma0 = 10; x0 = rnorm(1,mu0,Sigma0)
 w = rnorm(n); v = rnorm(n)
 x = c(x0 + sQ*w[1]);  y = c(x[1] + sR*v[1])   # initialize
for (t in 2:n){
  x[t] = x[t-1] + sQ*w[t]
  y[t] = x[t] + sR*v[t]   
  }
# run and plot the smoother  
run = Ksmooth(y, A=1, mu0, Sigma0, Phi=1, sQ, sR)
tsplot(cbind(y,run$Xs), spaghetti=TRUE, type='o', col=c(4,6), pch=c(1,NA), margins=1)
# CRAN tests need extra white space :( so margins=1 above is not necessary otherwise
legend('topleft', legend=c("y(t)","Xs(t)"), lty=1, col=c(4,6), bty="n", pch=c(1,NA))
</code></pre>

<hr>
<h2 id='lag1.plot'>Lag Plot - one time series
</h2><span id='topic+lag1.plot'></span>

<h3>Description</h3>

<p>Produces a grid of scatterplots of a series versus lagged values of the series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lag1.plot(series, max.lag = 1, corr = TRUE, smooth = TRUE, col = gray(.1), lwl = 1,
            lwc = 2, bgl = gray(1,.65), ltcol = 1, box.col = 8, cex = .9, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lag1.plot_+3A_series">series</code></td>
<td>
<p>the data
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_max.lag">max.lag</code></td>
<td>
<p>maximum lag
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_corr">corr</code></td>
<td>
<p>if TRUE, shows the autocorrelation value in a legend
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_smooth">smooth</code></td>
<td>
<p>if TRUE, adds a lowess fit to each scatterplot
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_col">col</code></td>
<td>
<p>color of points; default is <code>gray(.1)</code>
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_lwl">lwl</code></td>
<td>
<p>width of lowess line; default is 1
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_lwc">lwc</code></td>
<td>
<p>color of lowess line; default is 2 (red)
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_bgl">bgl</code></td>
<td>
<p>background of the ACF legend; default is semitransparent white
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_ltcol">ltcol</code></td>
<td>
<p>legend text color; default is black
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_box.col">box.col</code></td>
<td>
<p>color of the border of the ACF legend; default is <code>'gray(62)'</code>
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_cex">cex</code></td>
<td>
<p>size of points; default is .9
</p>
</td></tr>
<tr><td><code id="lag1.plot_+3A_...">...</code></td>
<td>
<p>additional graphical arguments
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lag2.plot">lag2.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>lag1.plot(log(varve), max.lag=9)
lag1.plot(soi, 12, cex=1, pch=19, col=astsa.col(4, .3), gg=TRUE, corr=FALSE)
</code></pre>

<hr>
<h2 id='lag2.plot'>Lag Plot - two time series
</h2><span id='topic+lag2.plot'></span>

<h3>Description</h3>

<p>Produces a grid of scatterplots of one series versus another lagged. The first named series is the one that gets lagged.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lag2.plot(series1, series2, max.lag = 0, corr = TRUE, smooth = TRUE, col = gray(.1),
           lwl = 1, lwc = 2, bgl = gray(1,.65), ltcol = 1, box.col = 8, cex = .9, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lag2.plot_+3A_series1">series1</code></td>
<td>
<p>first series (the one that gets lagged)
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_series2">series2</code></td>
<td>
<p>second series
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_max.lag">max.lag</code></td>
<td>
<p>maximum number of lags
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_corr">corr</code></td>
<td>
<p>if TRUE, shows the cross-correlation value in a legend
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_smooth">smooth</code></td>
<td>
<p>if TRUE, adds a lowess fit to each scatterplot
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_col">col</code></td>
<td>
<p>color of points; default is <code>gray(.1)</code>
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_lwl">lwl</code></td>
<td>
<p>width of lowess line; default is 1
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_lwc">lwc</code></td>
<td>
<p>color of lowess line; default is 2 (red)
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_bgl">bgl</code></td>
<td>
<p>background of the ACF legend; default is semitransparent white
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_ltcol">ltcol</code></td>
<td>
<p>legend text color; default is black
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_box.col">box.col</code></td>
<td>
<p>color of the border of the ACF legend; default is <code>'gray(62)'</code>
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_cex">cex</code></td>
<td>
<p>size of points; default is .9
</p>
</td></tr>
<tr><td><code id="lag2.plot_+3A_...">...</code></td>
<td>
<p>additional graphical parameters
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lag1.plot">lag1.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>lag2.plot(soi, rec, max.lag=3)
lag2.plot(soi, rec, 8, cex=1.1, pch=19, col=5, lwl=2)
</code></pre>

<hr>
<h2 id='LagReg'>Lagged Regression
</h2><span id='topic+LagReg'></span>

<h3>Description</h3>

<p>Performs lagged regression as discussed in Chapter 4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LagReg(input, output, L = c(3, 3), M = 40, threshold = 0, 
        inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LagReg_+3A_input">input</code></td>
<td>
<p>input series
</p>
</td></tr>
<tr><td><code id="LagReg_+3A_output">output</code></td>
<td>
<p>output series
</p>
</td></tr>
<tr><td><code id="LagReg_+3A_l">L</code></td>
<td>
<p>degree of smoothing;  see <code>spans</code> in the help file for <code>spec.pgram</code>.
</p>
</td></tr>
<tr><td><code id="LagReg_+3A_m">M</code></td>
<td>
<p>must be even; number of terms used in the lagged regression
</p>
</td></tr>
<tr><td><code id="LagReg_+3A_threshold">threshold</code></td>
<td>
<p>the cut-off used to set small (in absolute value) regression coeffcients equal to zero
</p>
</td></tr>
<tr><td><code id="LagReg_+3A_inverse">inverse</code></td>
<td>
<p>if TRUE, will fit a forward-lagged regression
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a bivariate series, <code>input</code> is the input series and <code>output</code> is the output series. The degree of smoothing for the spectral estimate is given by L; see <code>spans</code> in the help file for <code>spec.pgram</code>. The number of terms used in the lagged regression approximation is given by M, which must be even. The threshold value is the cut-off used to set small (in absolute value) regression coeffcients equal to zero (it is easiest to run LagReg twice, once with the default threshold of zero, and then again after inspecting the resulting coeffcients and the corresponding values of the CCF). Setting inverse=TRUE will fit a forward-lagged regression; the default is to run a backward-lagged regression. The script is based on code that was contributed by Professor Doug Wiens, Department of Mathematical and Statistical Sciences, University of Alberta. 
</p>


<h3>Value</h3>

<p>Graphs of the estimated impulse response function, the CCF, and the output with the predicted values superimposed.
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>Estimated coefficients</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>The output series, the fitted values, and the residuals</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See Chapter 4 of the text for an example.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='lap'>LA Pollution-Mortality Study
</h2><span id='topic+lap'></span>

<h3>Description</h3>

<p>LA Pollution-Mortality Study (1970-1979, weekly data).
</p>


<h3>Format</h3>

<p>The format is:
mts [1:508, 1:11] </p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
columns are time series       </td><td style="text-align: left;">   with names </td>
</tr>
<tr>
 <td style="text-align: left;">
 (1) Total Mortality          </td><td style="text-align: left;">   <code>tmort</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (2) Respiratory Mortality    </td><td style="text-align: left;">   <code>rmort</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (3) Cardiovascular Mortality </td><td style="text-align: left;">   <code>cmort</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (4) Temperature              </td><td style="text-align: left;">   <code>tempr</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 (5) Relative Humidity        </td><td style="text-align: left;">   <code>rh</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (6) Carbon Monoxide          </td><td style="text-align: left;">   <code>co</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (7) Sulfur Dioxide           </td><td style="text-align: left;">   <code>so2</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (8) Nitrogen Dioxide         </td><td style="text-align: left;">   <code>no2</code></td>
</tr>
<tr>
 <td style="text-align: left;">
 (9) Hydrocarbons             </td><td style="text-align: left;">   <code>hycarb</code></td>
</tr>
<tr>
 <td style="text-align: left;">
(10) Ozone                    </td><td style="text-align: left;">   <code>o3</code></td>
</tr>
<tr>
 <td style="text-align: left;">
(11) Particulates             </td><td style="text-align: left;">   <code>part</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>Details may be found in <kbd>http://www.sungpark.net/ShumwayAzariPawitan88.pdf</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='lead'>Leading Indicator
</h2><span id='topic+lead'></span>

<h3>Description</h3>

<p>Leading indicator, 150 months; taken from Box and Jenkins (1970).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lead)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:150] from 1 to 150: 10.01 10.07 10.32 9.75 10.33 ...
</p>


<h3>Details</h3>

<p>This is also the R time series <code>BJsales.lead</code>:  The sales time series <code>BJsales</code> and leading indicator <code>BJsales.lead</code> each contain 150 observations. The objects are of class &quot;ts&quot;.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sales">sales</a></code></p>

<hr>
<h2 id='Lynx'>Canadian Lynx
</h2><span id='topic+Lynx'></span>

<h3>Description</h3>

<p>This is one of the classic studies of predator-prey interactions, the 90-year data set is the number, in thousands, of  lynx  pelts  purchased by the Hudson's Bay Company of Canada. While this is an indirect measure of predation, the assumption is that there is a direct relationship between the number of pelts collected and the number of hare and lynx in the wild.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Lynx")</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:91] from 1845 to 1935: 30.1 45.1 49.1 39.5 21.2 ...
</p>


<h3>Note</h3>

<p>The data are in  units of one  thousand.  This data set pairs with <code><a href="#topic+Hare">Hare</a></code> and is NOT the same as  <code><a href="datasets.html#topic+lynx">lynx</a></code>.
</p>


<h3>Source</h3>

<p>From Odum's &quot;Fundamentals of Ecology&quot;,  p. 191. Additional information at<br />
<kbd>http://people.whitman.edu/~hundledr/courses/M250F03/M250.html</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hare">Hare</a></code></p>

<hr>
<h2 id='matrixpwr'>
Powers of a Square Matrix
</h2><span id='topic+matrixpwr'></span><span id='topic++25+5E+25'></span>

<h3>Description</h3>

<p><code>matrixpwr</code> computes powers of a square matrix including negative powers for nonsingular matrices.
</p>
<p><code>%^%</code> is a more intuitive interface as an operator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixpwr(A, power)

A %^% power
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrixpwr_+3A_a">A</code></td>
<td>

<p>a square matrix
</p>
</td></tr>
<tr><td><code id="matrixpwr_+3A_power">power</code></td>
<td>

<p>single numeric
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Raises matrix to the specified power. The matrix must be square
and if <code>power &lt; 0</code>, the matrix must be nonsingular.
</p>
<p>Note that <code>%^%</code> is defined as
<code>"%^%" &lt;- function(A, power) matrixpwr(A, power) </code>
</p>
<p>If <code>power = 0</code>, the identity matrix is returned.
</p>


<h3>Value</h3>

<p>Returns matrix raised to the given power.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 2-state Markov transition matrix to steady state
( P = matrix(c(.7,.4,.3,.6), 2) )
P %^% 50

# surround with parentheses if used in an expression
c(.2, .8) %*% (P %^% 50)

# Inverse square root
var(econ5) %^% -.5
</code></pre>

<hr>
<h2 id='MEI'>
Multivariate El Nino/Southern Oscillation Index (version 1)
</h2><span id='topic+MEI'></span>

<h3>Description</h3>

<p>Bimonthly MEI values, starting with Dec1949/Jan1950 through Oct/Nov2019.  
All values are normalized for each bimonthly season so that the 44 values from 1950 to 1993 
have an average of zero and a standard deviation of 1.  Larger values correspond to warmer
temperatures (unlike <code>soi</code> and <code>ENSO</code>).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:827] from 1950 to 2019: -1.03 -1.13 -1.28 -1.07 -1.43 ...
</p>


<h3>Details</h3>

<p>For full details, see <kbd>https://psl.noaa.gov/enso/mei.old/mei.html</kbd>.
Multivariate ENSO Index (MEI) is a combined score on the six main observed variables over the tropical Pacific. These six variables are: sea-level pressure (P), zonal (U) and meridional (V) components of the surface wind, sea surface temperature (S), surface air temperature (A), and total cloudiness fraction of the sky (C). These observations have been collected and published in ICOADS for many years. The MEI is computed separately for each of twelve sliding bi-monthly seasons (Dec/Jan, Jan/Feb,..., Nov/Dec). After spatially filtering the individual fields into clusters, the MEI is calculated as the first unrotated Principal Component (PC) of all six observed fields combined. This is accomplished by normalizing the total variance of each field first, and then performing the extraction of the first PC on the co-variance matrix of the combined fields. In order to keep the MEI comparable, all seasonal values are standardized with respect to each season and to the 1950-93 reference period.
</p>


<h3>Source</h3>

<p><kbd>https://psl.noaa.gov/enso/mei.old/table.html</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soi">soi</a>, <a href="#topic+ENSO">ENSO</a></code>
</p>

<hr>
<h2 id='Months'>
Month Labels
</h2><span id='topic+Months'></span>

<h3>Description</h3>

<p>Provides labels for the (English) months of the year to be used in plotting monthly time series.
</p>


<h3>Format</h3>

<p>The format is:
chr [1:12] &quot;J&quot; &quot;F&quot; &quot;M&quot; &quot;A&quot; &quot;M&quot; &quot;J&quot; &quot;J&quot; &quot;A&quot; &quot;S&quot; &quot;O&quot; &quot;N&quot; &quot;D&quot;
</p>


<h3>Note</h3>

<p>Hi Kids. The months of the year in English are:
</p>
<p>January, February, March, April, May, June, July, August, September, October, November, December.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sAR = sarima.sim(sar=.9, S=12, n=36)
tsplot(sAR, type='c')
points(sAR, pch=Months, cex=1.1, font=4, col=1:4)
</code></pre>

<hr>
<h2 id='mvspec'>Univariate and Multivariate Spectral Estimation
</h2><span id='topic+mvspec'></span>

<h3>Description</h3>

<p>This is <code>spec.pgram</code> with a few changes in the defaults and written so you can easily extract the estimate of the multivariate spectral matrix as <code>fxx</code>.  The bandwidth calculation has been changed to the more practical definition given in the text and this can be used to replace <code>spec.pgram</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvspec(x, spans = NULL, kernel = NULL, taper = 0, pad = 0, fast = TRUE, 
        demean = FALSE, detrend = TRUE, lowess = FALSE, log = 'n', plot = TRUE, 
        gg = FALSE, type = NULL, na.action = na.fail, nxm = 2, nym = 1, 
        main = NULL, xlab=NULL, cex.main=NULL, ci.col=4, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvspec_+3A_x">x</code></td>
<td>
<p>univariate or multivariate time series (i.e., the p columns of x are time series)
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_spans">spans</code></td>
<td>
<p>vector of odd integers giving the widths of modified Daniell smoothers to be used to smooth the periodogram
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_kernel">kernel</code></td>
<td>
<p>alternatively, a kernel smoother of class <code>tskernel</code> 
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_taper">taper</code></td>
<td>
<p>specifies the proportion of data to taper using a split cosine bell taper (.5 specifies a full taper)
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_pad">pad</code></td>
<td>
<p>proportion of data to pad (zeros are added to the end of the series to increase its length by the proportion pad)
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_fast">fast</code></td>
<td>
<p>logical; if TRUE, pad the series to a highly composite length
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_demean">demean</code></td>
<td>
<p>if TRUE, series is demeaned first 
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_detrend">detrend</code></td>
<td>
<p>if TRUE, series is detrended first 
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_lowess">lowess</code></td>
<td>
<p>if TRUE and detrend TRUE, series is detrended using lowess first 
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_log">log</code></td>
<td>
<p>if <code>log='y'</code>, spectra plotted on a log scale; otherwise a log scale is not used
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_plot">plot</code></td>
<td>
<p>plot the estimated spectra 
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_gg">gg</code></td>
<td>
<p>if TRUE, will produce a gris-gris plot (gray graphic interior with white grid lines); the default is FALSE. The grammar of astsa is voodoo
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_type">type</code></td>
<td>
<p>type of plot to be drawn, defaults to lines (see <code>par</code>)
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_na.action">na.action</code></td>
<td>
<p>how to handle missing values
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_nxm">nxm</code>, <code id="mvspec_+3A_nym">nym</code></td>
<td>

<p>the number of minor tick mark divisions on x-axis, y-axis; the default is one minor tick on the x-axis and none on the y-axis
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_main">main</code></td>
<td>
<p>title of the graphics; if NULL (default), a totally awesome title is generated dude, but if NA there will be no gnarly title and the top margin will be used for the plot
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_xlab">xlab</code></td>
<td>
<p>label for frequency axis; if NULL (default), a totally awesome label is generated for your viewing pleasure
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_cex.main">cex.main</code></td>
<td>

<p>magnification for main title; default is 1.
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_ci.col">ci.col</code></td>
<td>

<p>color of the confidence interval if one is drawn.
</p>
</td></tr>
<tr><td><code id="mvspec_+3A_...">...</code></td>
<td>
<p>graphical arguments passed to <code>plot.spec</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is built off of <code>spec.pgram</code> from the stats package with a few changes in the defaults and written so you can easily extract the estimate of the multivariate spectral matrix as <code>fxx</code>. 
</p>
<p>The default for the plot is NOT to plot on a log scale and the graphic will have a grid. 
</p>
<p>The bandwidth calculation has been changed to the more practical definition given in the text, <code class="reqn">(L_h/n.used)*frequency(x)</code>.  Also, the bandwidth is not displayed in the graphic, but is returned. 
</p>
<p>Although initially meant to be used to easily obtain multivariate (mv) spectral (spec) estimates, this script can be used for univariate time series as a replacement for <code>spec.pgram</code>.
</p>
<p>Note that the script does not taper by default (<code>taper=0</code>); this forces the user to do &quot;conscious tapering&quot;.  
</p>


<h3>Value</h3>

<p>All results are returned invisibly.  
</p>
<p>If <code>plot</code> is TRUE, the bandwidth and degrees of freedom are printed. 
</p>
<p>An object of class &quot;spec&quot;, which is a list containing at least the following components:
</p>
<table>
<tr><td><code>fxx</code></td>
<td>
<p>spectral matrix estimates; an array of dimensions <code>dim = c(p,p,nfreq)</code></p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>vector of frequencies at which the spectral density is estimated.</p>
</td></tr>
<tr><td><code>spec</code></td>
<td>
<p>vector (for univariate series) or matrix (for multivariate series) of estimates of the spectral density at frequencies corresponding to freq.</p>
</td></tr>
<tr><td><code>details</code></td>
<td>
<p>matrix with columns: frequency, period, spectral ordinate(s)</p>
</td></tr>
<tr><td><code>coh</code></td>
<td>
<p>NULL for univariate series. For multivariate time series, a matrix containing the squared coherency between different series. Column i + (j - 1) * (j - 2)/2 of coh contains the squared coherency between columns i and j of x, where i &lt; j.</p>
</td></tr>
<tr><td><code>phase</code></td>
<td>
<p>NULL for univariate series. For multivariate time series a matrix containing the cross-spectrum phase between different series. The format is the same as coh.</p>
</td></tr>
<tr><td><code>Lh</code></td>
<td>
<p>Number of frequencies (approximate) used in the band.</p>
</td></tr>
<tr><td><code>n.used</code></td>
<td>
<p>Sample length used for the FFT</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>Degrees of freedom (may be approximate) associated with the spectral estimate.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>Bandwidth (may be approximate) associated with the spectral estimate.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used to calculate the spectrum.</p>
</td></tr>
</table>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'># real raw periodogram
mvspec(soi)
mvspec(soi, log='y')  # on a log scale

# smooth and some details printed
mvspec(soi, spans=c(7,7), taper=.5)$details[1:45,]

# multivariate example
deth = cbind(mdeaths, fdeaths)    # two R data sets, male/female monthly deaths ...
tsplot(deth, type='b', col=c(4,6), spaghetti=TRUE, pch=c('M','F'))
dog = mvspec(deth, spans=c(3,3), taper=.1)
dog$fxx        # look at spectral matrix estimates
dog$bandwidth  # bandwidth with time unit = year
dog$df         # degrees of freedom
plot(dog, plot.type="coherency")  # plot of squared coherency
</code></pre>

<hr>
<h2 id='nyse'>Returns of the New York Stock Exchange
</h2><span id='topic+nyse'></span>

<h3>Description</h3>

<p>Returns of the New York Stock Exchange (NYSE) from February 2, 1984 to December 31, 1991.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:2000] from 1 to 2000: 0.00335 -0.01418 -0.01673 0.00229 -0.01692 ...
</p>


<h3>Note</h3>

<p>Various packages have data sets called <code>nyse</code>. Consequently, it may be best to specify this data set as <code>nyse = astsa::nyse</code> to avoid conflicts.
</p>


<h3>Source</h3>

<p>S+GARCH module -  Version 1.1 Release 2: 1998
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='oil'>Crude oil, WTI spot price FOB
</h2><span id='topic+oil'></span>

<h3>Description</h3>

<p>Crude oil, WTI spot price FOB (in dollars per barrel), weekly data from 2000 to mid-2010.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:545] from 2000 to 2010: 26.2 26.1 26.3 24.9 26.3 ...
</p>


<h3>Details</h3>

<p>pairs with the series <code>gas</code>
</p>


<h3>Source</h3>

<p>Data were obtained from the URL: www.eia.doe.gov/dnav/pet/pet_pri_spt_s1_w.htm
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.    
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gas">gas</a></code></p>

<hr>
<h2 id='part'>Particulate levels from the LA pollution study
</h2><span id='topic+part'></span>

<h3>Description</h3>

<p>Particulate series corresponding to <code>cmort</code> from the LA pollution study.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:508] from 1970 to 1980: 72.7 49.6 55.7 55.2 66 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lap">lap</a></code></p>

<hr>
<h2 id='PLT'>Platelet Levels
</h2><span id='topic+PLT'></span>

<h3>Description</h3>

<p>PLT: Measurements made for 91 days on the three variables, log(white blood count) [WBC], log(platelet) [PLT] and hematocrit [HCT].  Missing data code is 0 (zero).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PLT)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:91] from 1 to 91: 4.47 4.33 4.09 4.6 4.41 ...
</p>


<h3>Details</h3>

<p>See Examples 6.1 and 6.9 for more details.
</p>


<h3>Source</h3>

<p>Jones, R.H. (1984). Fitting multivariate models to unequally spaced data. In <em>Time Series Analysis of Irregularly Observed Data</em>, pp. 158-188. E. Parzen, ed. Lecture Notes in Statistics, 25, New York: Springer-Verlag.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+blood">blood</a></code>, <code><a href="#topic+HCT">HCT</a></code>, <code><a href="#topic+WBC">WBC</a></code></p>

<hr>
<h2 id='polio'>
Poliomyelitis cases in US 
</h2><span id='topic+polio'></span>

<h3>Description</h3>

<p>Monthly time series of poliomyelitis cases reported to the U.S. Centers for Disease Control for the years 1970 to 1983, 168 observations. </p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:168] from 1970 to 1984: 0 1 0 0 1 3 9 2 3 5 ...
</p>


<h3>Details</h3>

<p>The data were originally modelled by Zeger (1988) &ldquo;A Regression Model for Time Series of
Counts,&rdquo; <em>Biometrika</em>, 75, 822-835.
</p>


<h3>Source</h3>

<p>Data taken from the gamlss.data package; see <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.  
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tsplot(polio, type='s')
</code></pre>

<hr>
<h2 id='polyMul'>Multiplication of Two Polynomials</h2><span id='topic+polyMul'></span>

<h3>Description</h3>

<p>Multiplication of two polynomials.</p>


<h3>Usage</h3>

<pre><code class='language-R'>polyMul(p, q)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polyMul_+3A_p">p</code></td>
<td>
<p>coefficients of first polynomial</p>
</td></tr>
<tr><td><code id="polyMul_+3A_q">q</code></td>
<td>
<p>coefficients of second polynomial</p>
</td></tr>
</table>


<h3>Details</h3>

<p>inputs are vectors of coefficients a, b, c, ..., in order of power
<code class="reqn">ax^0 + bx^1 + cx^2 + ...</code>  </p>


<h3>Value</h3>

<p>coefficients of the product in order of power</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer</p>


<h3>Source</h3>

<p>based on code from the polynom package 
<a href="https://CRAN.R-project.org/package=polynom">https://CRAN.R-project.org/package=polynom</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a = 1:3  # 1 + 2x + 3x^2
b = 1:2  # 1 + 2x
polyMul(a, b)
# [1] 1 4 7 6
# 1 + 4x + 7x^2 + 6x^3
</code></pre>

<hr>
<h2 id='prodn'>Monthly Federal Reserve Board Production Index
</h2><span id='topic+prodn'></span>

<h3>Description</h3>

<p>Monthly Federal Reserve Board Production Index (1948-1978, n = 372 months).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prodn)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:372] from 1948 to 1979: 40.6 41.1 40.5 40.1 40.4 41.2 39.3 41.6 42.3 43.2 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='qinfl'>Quarterly Inflation
</h2><span id='topic+qinfl'></span>

<h3>Description</h3>

<p>Quarterly inflation rate in the Consumer Price Index from 1953-Ito 1980-II, n = 110 observations.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:110] from 1953 to 1980: 1.673 3.173 0.492 -0.327 -0.333 ...
</p>


<h3>Details</h3>

<p>pairs with qintr (interest rate)
</p>


<h3>Source</h3>

<p>Newbold, P. and T. Bos (1985). <em>Stochastic Parameter Regression Models</em>. Beverly Hills: Sage.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qintr">qintr</a></code></p>

<hr>
<h2 id='qintr'>Quarterly Interest Rate
</h2><span id='topic+qintr'></span>

<h3>Description</h3>

<p>Quarterly interest rate recorded for Treasury bills from 1953-Ito 1980-II, n = 110 observations. 
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:110] from 1953 to 1980: 1.98 2.15 1.96 1.47 1.06 ...
</p>


<h3>Details</h3>

<p>pairs with qinfl (inflation)
</p>


<h3>Source</h3>

<p>Newbold, P. and T. Bos (1985). <em>Stochastic Parameter Regression Models</em>. Beverly Hills: Sage.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qinfl">qinfl</a></code></p>

<hr>
<h2 id='rec'>Recruitment (number of new fish index)
</h2><span id='topic+rec'></span>

<h3>Description</h3>

<p>Recruitment (index of the number of new fish) for a period of 453 months ranging over the years 1950-1987. Recruitment is loosely defined as an indicator of new members of a population to the first life stage at which natural mortality stabilizes near adult levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rec)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:453] from 1950 to 1988: 68.6 68.6 68.6 68.6 68.6 ...
</p>


<h3>Details</h3>

<p>can pair with <code>soi</code> (Southern Oscillation Index)
</p>


<h3>Source</h3>

<p>Data furnished by Dr. Roy Mendelssohn of the Pacific Fisheries Environmental Laboratory, NOAA (personal communication). Further discussion of the concept of Recruitment may be found here: <kbd>derekogle.com/fishR/examples/oldFishRVignettes/StockRecruit.pdf</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.    
</p>


<h3>See Also</h3>

<p><code><a href="#topic+soi">soi</a></code></p>

<hr>
<h2 id='sales'>Sales
</h2><span id='topic+sales'></span>

<h3>Description</h3>

<p>Sales, 150 months; taken from Box and Jenkins (1970).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:150] from 1 to 150: 200 200 199 199 199 ...
</p>


<h3>Details</h3>

<p>This is also the R data set <code>BJsales</code>: The sales time series <code>BJsales</code> and leading indicator <code>BJsales.lead</code> each contain 150 observations. The objects are of class &quot;ts&quot;.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lead">lead</a></code></p>

<hr>
<h2 id='salmon'>
Monthly export price of salmon
</h2><span id='topic+salmon'></span>

<h3>Description</h3>

<p>Farm Bred Norwegian Salmon, export price, US Dollars per Kilogram
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:166] from September 2003 to June 2017: 2.88 3.16 2.96 3.12 3.23 3.32 3.45 3.61 3.48 3.21 ...
</p>


<h3>Source</h3>

<p><a href="https://www.indexmundi.com/commodities/">https://www.indexmundi.com/commodities/</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='salt'>Salt Profiles
</h2><span id='topic+salt'></span>

<h3>Description</h3>

<p>Salt profiles taken over a spatial grid set out on an agricultural field, 64 rows at 17-ft spacing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(salt)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:64] from 1 to 64: 6 6 6 3 3 3 4 4 4 1.5 ...
</p>


<h3>Details</h3>

<p>pairs with <code>saltemp</code>, temperature profiles on the same grid
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saltemp">saltemp</a></code></p>

<hr>
<h2 id='saltemp'>Temperature Profiles 
</h2><span id='topic+saltemp'></span>

<h3>Description</h3>

<p>Temperature profiles over a spatial grid set out on an agricultural field, 64 rows at 17-ft spacing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(saltemp)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:64] from 1 to 64: 5.98 6.54 6.78 6.34 6.96 6.51 6.72 7.44 7.74 6.85 ...
</p>


<h3>Details</h3>

<p>pairs with <code>salt</code>, salt profiles on the same grid
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+salt">salt</a></code></p>

<hr>
<h2 id='sarima'>Fit ARIMA Models
</h2><span id='topic+sarima'></span>

<h3>Description</h3>

<p>Fits ARIMA models (with diagnostics) in a short command.  It can also be used to perform regression with autocorrelated errors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sarima(xdata, p, d, q, P = 0, D = 0, Q = 0, S = -1, 
       details = TRUE, xreg = NULL, Model = TRUE,
       fixed = NULL, tol = sqrt(.Machine$double.eps), 
       no.constant = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sarima_+3A_xdata">xdata</code></td>
<td>
<p>univariate time series
</p>
</td></tr>
<tr><td><code id="sarima_+3A_p">p</code></td>
<td>
<p>AR order (must be specified)
</p>
</td></tr>
<tr><td><code id="sarima_+3A_d">d</code></td>
<td>
<p>difference order (must be specified)
</p>
</td></tr>
<tr><td><code id="sarima_+3A_q">q</code></td>
<td>
<p>MA order (must be specified)
</p>
</td></tr>
<tr><td><code id="sarima_+3A_p">P</code></td>
<td>
<p>SAR order; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_d">D</code></td>
<td>
<p>seasonal difference; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_q">Q</code></td>
<td>
<p>SMA order; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_s">S</code></td>
<td>
<p>seasonal period; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_details">details</code></td>
<td>
<p>if FALSE, turns off the diagnostic plot and the output from the nonlinear optimization routine, which is <code>optim</code>. The default is TRUE. 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a vector or matrix of external regressors, which must have the same number of rows as xdata.
</p>
</td></tr>
<tr><td><code id="sarima_+3A_model">Model</code></td>
<td>
<p>if TRUE (default), the model orders are printed on the diagnostic plot.
</p>
</td></tr>
<tr><td><code id="sarima_+3A_fixed">fixed</code></td>
<td>
<p>optional numeric vector of the same length as the total number of parameters. If supplied, only parameters corresponding to NA entries will be estimated. 
</p>
</td></tr>  
<tr><td><code id="sarima_+3A_tol">tol</code></td>
<td>
<p>controls the relative tolerance (reltol in <code>optim</code>) used to assess convergence. The default is <code>sqrt(.Machine$double.eps)</code>, the R default. 
</p>
</td></tr>
<tr><td><code id="sarima_+3A_no.constant">no.constant</code></td>
<td>
<p>controls whether or not sarima includes a constant in the model. In particular, if there is no differencing (d = 0 and D = 0) you get the mean estimate. If there is differencing of order one (either d = 1 or D = 1, but not both), a constant term is included in the model. These two conditions may be overridden (i.e., no constant will be included in the model) by setting this to TRUE; e.g., <code>sarima(x,1,1,0,no.constant=TRUE)</code>. Otherwise, no constant or mean term is included in the model.  If regressors are included (via <code>xreg</code>), this is ignored.
</p>
</td></tr>
<tr><td><code id="sarima_+3A_...">...</code></td>
<td>
<p>additional graphical arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If your time series is in x and you want to fit an ARIMA(p,d,q) model to the data, the basic call is <code>sarima(x,p,d,q)</code>. The values p,d,q, must be specified as there is no default. The results are the parameter estimates, standard errors, AIC, AICc, BIC (as defined in Chapter 2) and diagnostics. To fit a seasonal ARIMA model, the basic call is <code>sarima(x,p,d,q,P,D,Q,S)</code>. For example, <code>sarima(x,2,1,0)</code> will fit an ARIMA(2,1,0) model to the series in x, and <code>sarima(x,2,1,0,0,1,1,12)</code> will fit a seasonal ARIMA<code class="reqn">(2,1,0)*(0,1,1)_{12}</code> model to the series in x. The difference between the information criteria given by <code>sarima()</code> and  <code>arima()</code> is that they  differ by a scaling factor of the effective sample size.  
</p>


<h3>Value</h3>

<p>A t-table, the estimated noise variance, and AIC, AICc, BIC are printed. The following are returned invisibly:
</p>
<table>
<tr><td><code>fit</code></td>
<td>
<p>the <code>arima</code> object</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>the estimate of the noise variance</p>
</td></tr>
<tr><td><code>degrees_of_freedom</code></td>
<td>
<p>error degrees of freedom</p>
</td></tr>
<tr><td><code>ttable</code></td>
<td>
<p>a little t-table with two-sided p-values</p>
</td></tr>
<tr><td><code>ICs</code></td>
<td>
<p>AIC  -  AICc  -  BIC</p>
</td></tr> 
</table>


<h3>Source</h3>

<p>This is an enhancement of <code>arima</code> from the <code>stats</code> package.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.    
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sarima.for">sarima.for</a></code>, <code><a href="#topic+sarima.sim">sarima.sim</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># easy to use 
sarima(rec, 2,0,0)  # data, p, d, and q
sarima(rec, 2,0,0, details=FALSE)  # minimal output

dog &lt;- sarima(log(AirPassengers), 0,1,1, 0,1,1,12)
str(dog, vec.len=1) # dog has all the returned values
tsplot(resid(dog$fit))  # plot the innovations (residuals) 
dog$ICs # view the 3 ICs

# fixed parameters
x = sarima.sim( ar=c(0,-.9), n=200 ) + 50 
sarima(x, 2,0,0, fixed=c(0,NA,NA))  # phi1 fixed, phi2 and mean free

# fun with diagnostics
sarima(log(AirPassengers), 0,1,1, 0,1,1,12, gg=TRUE, col=4)

# regression with autocorrelated errors 
pp = ts.intersect(L = Lynx, L1 = lag(Lynx,-1), H1 = lag(Hare,-1), dframe=TRUE)
sarima(pp$L, 2,0,0, xreg = cbind(L1=pp$L1, LH1=pp$L1*pp$H1))
</code></pre>

<hr>
<h2 id='sarima.for'>ARIMA Forecasting
</h2><span id='topic+sarima.for'></span>

<h3>Description</h3>

<p>ARIMA forecasting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sarima.for(xdata,n.ahead,p,d,q,P=0,D=0,Q=0,S=-1,tol = sqrt(.Machine$double.eps),
         no.constant = FALSE, plot = TRUE, plot.all = FALSE,
         xreg = NULL, newxreg = NULL, fixed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sarima.for_+3A_xdata">xdata</code></td>
<td>
<p>univariate time series
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_n.ahead">n.ahead</code></td>
<td>
<p>forecast horizon (number of periods)
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_p">p</code></td>
<td>
<p>AR order
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_d">d</code></td>
<td>
<p>difference order
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_q">q</code></td>
<td>
<p>MA order
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_p">P</code></td>
<td>
<p>SAR order; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_d">D</code></td>
<td>
<p>seasonal difference; use only for seasonal models
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_q">Q</code></td>
<td>
<p>SMA order; use only for seasonal models
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_s">S</code></td>
<td>
<p>seasonal period; use only for seasonal models 
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_tol">tol</code></td>
<td>
<p>controls the relative tolerance (reltol) used to assess convergence. The default is <code>sqrt(.Machine$double.eps)</code>, the R default.
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_no.constant">no.constant</code></td>
<td>
<p>controls whether or not a constant is included in the model. If <code>no.constant=TRUE</code>, no constant is included in the model.
See  <code><a href="#topic+sarima">sarima</a></code> for more details.
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_plot">plot</code></td>
<td>
<p>if TRUE (default) the data (or some of it) and the forecasts and bounds are plotted
</p>
</td></tr>  
<tr><td><code id="sarima.for_+3A_plot.all">plot.all</code></td>
<td>
<p>if TRUE, all the data are plotted in the graphic; otherwise, only the last 100 observations are plotted in the graphic.
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_xreg">xreg</code></td>
<td>
<p>Optionally, a vector or matrix of external regressors, which must have the same number of rows as the series. If this is used, <code>newxreg</code> MUST be specified.
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_newxreg">newxreg</code></td>
<td>
<p>New values of <code>xreg</code> to be used for prediction. Must have at least <code>n.ahead</code> rows.
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_fixed">fixed</code></td>
<td>
<p>optional numeric vector of the same length as the total number of parameters. If supplied, only parameters corresponding to NA entries will be estimated. 
</p>
</td></tr>
<tr><td><code id="sarima.for_+3A_...">...</code></td>
<td>
<p>additional graphical arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For example, <code>sarima.for(x,5,1,0,1)</code> will forecast five time points ahead for an ARMA(1,1) fit to x. The output prints the forecasts and the standard errors of the forecasts, and supplies a graphic of the forecast with +/- 1 and 2 prediction error bounds.
</p>


<h3>Value</h3>

<table>
<tr><td><code>pred</code></td>
<td>
<p>the forecasts</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>the prediction (standard) errors</p>
</td></tr>
</table>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sarima">sarima</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>sarima.for(log(AirPassengers),12,0,1,1,0,1,1,12) 

# fun with the graphic 
sarima.for(log(AirPassengers),12,0,1,1,0,1,1,12, gg=TRUE, col=4, main='arf') 

# with regressors 
nummy   = length(soi)
n.ahead = 24 
nureg   = time(soi)[nummy] + seq(1,n.ahead)/12
sarima.for(soi,n.ahead,2,0,0,2,0,0,12, xreg=time(soi), newxreg=nureg) 
</code></pre>

<hr>
<h2 id='sarima.sim'>ARIMA Simulation
</h2><span id='topic+sarima.sim'></span>

<h3>Description</h3>

<p>Simulate data from (seasonal) ARIMA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sarima.sim(ar = NULL, d = 0, ma = NULL, sar = NULL, D = 0, sma = NULL, S = NULL, 
            n = 500, rand.gen = rnorm, innov = NULL, burnin = NA, t0 = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sarima.sim_+3A_ar">ar</code></td>
<td>

<p>coefficients of AR component (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_d">d</code></td>
<td>

<p>order of regular difference (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_ma">ma</code></td>
<td>

<p>coefficients of MA component (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_sar">sar</code></td>
<td>

<p>coefficients of SAR component (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_d">D</code></td>
<td>

<p>order of seasonal difference (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_sma">sma</code></td>
<td>

<p>coefficients of SMA component (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_s">S</code></td>
<td>

<p>seasonal period (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_n">n</code></td>
<td>

<p>desired sample size (defaults to 500)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_rand.gen">rand.gen</code></td>
<td>

<p>optional; a function to generate the innovations (defaults to normal)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_innov">innov</code></td>
<td>
	
<p>an optional times series of innovations. If not provided, rand.gen is used.
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_burnin">burnin</code></td>
<td>
<p>length of burn-in (a non-negative integer). If <code>NA</code> (the default) a reasonable value is selected.
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_t0">t0</code></td>
<td>

<p>start time (defaults to 0)
</p>
</td></tr>
<tr><td><code id="sarima.sim_+3A_...">...</code></td>
<td>

<p>additional arguments applied to the innovations.  For <code>rand.gen</code>, the standard deviation of the innovations generated by <code>rnorm</code> can be specified by <code>sd</code> or the mean by <code>mean</code> (see details and examples).  In addition, <code>rand.gen</code> may be overridden using a preset sequence of innovations specifying <code>innov</code> (see details and examples).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Will generate a time series of length <code>n</code> from the specified SARIMA model using simplified input.
</p>
<p>The use of the term <code>mean</code> in ... refers to the generation of normal innovations.  For example, <code>sarima.sim(ar=.9, mean=5)</code> will generate data using N(5,1) or 5+N(0,1) innovations, so that the constant in the model is 5 and the mean of the AR model is 5/(1-.9) = 50. In <code>sarima.sim(ma=.9, mean=5)</code>, however, the model mean is 5 (the constant). Also, a random walk with drift = .1 can be generated by <code>sarima.sim(d=1, mean=.1, burnin=0)</code>, which is equivalent to <code>cumsum(rnorm(500, mean=.1))</code>.  The same story goes if <code>sd</code> is specified; i.e., it's applied to the innovations. Because anything specified in ... refers to the innovations, a simpler way to generate a non-zero mean is to add the value outside the call; see the examples.
</p>
<p>If <code>innov</code> is used to input the innovations and override <code>rand.gen</code>, be sure that <code>length(innov)</code> is at least <code>n + burnin</code>. If the criterion is not met, the script will return less than the desired number of values and a warning will be given. 
</p>


<h3>Value</h3>

<p>A time series of length n from the specified SARIMA model with the specified frequency if the model is seasonal and start time t0.
</p>


<h3>Note</h3>

<p>The model autoregressive polynomial ('AR side' = AR x SAR) is checked for causality and the model moving average polynomial ('MA side' = MA x SMA) is checked invertibility.  The script stops and reports an error at the first violation of causality or invertibility; i.e., it will not report multiple errors.  
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## AR(2) with mean 50 [n = 500 is default]
y = sarima.sim(ar=c(1.5,-.75)) + 50
tsplot(y)

## ARIMA(0,1,1) with drift ['mean' refers to the innovations] 
tsplot(sarima.sim(ma=-.8, d=1, mean=.1))

## SAR(1) example from text
set.seed(666)   # not that 666
sAR = sarima.sim(sar=.9, S=12, n=36)
tsplot(sAR, type='c')
points(sAR, pch=Months, cex=1.1, font=4, col=1:4)

## SARIMA(0,1,1)x(0,1,1)_12 - B&amp;J's favorite
set.seed(101010)
tsplot(sarima.sim(d=1, ma=-.4, D=1, sma=-.6, S=12, n=120))  

## infinite variance t-errors 
tsplot(sarima.sim(ar=.9, rand.gen=function(n, ...) rt(n, df=2) ))

## use your own innovations
dog = rexp(150, rate=.5)*sign(runif(150,-1,1))
tsplot(sarima.sim(n=100, ar=.99, innov=dog, burnin=50))

## generate seasonal data but no P, D or Q - you will receive 
## a message to make sure that you wanted to do this on purpose: 
tsplot(sarima.sim(ar=c(1.5,-.75), n=144, S=12), ylab='doggy', xaxt='n')
mtext(seq(0,144,12), side=1, line=.5, at=0:12)

</code></pre>

<hr>
<h2 id='scatter.hist'>
Scatterplot with Marginal Histograms
</h2><span id='topic+scatter.hist'></span>

<h3>Description</h3>

<p>Draws a scatterplot with histograms in the margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatter.hist(x, y, xlab = NULL, ylab = NULL, title = NULL, pt.size = 1, 
              hist.col = gray(0.82), pt.col = gray(0.1, 0.25), pch = 19, 
              reset.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scatter.hist_+3A_x">x</code></td>
<td>

<p>vector of x-values
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_y">y</code></td>
<td>

<p>corresponding vector of y-values
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label (defaults to name of x)
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label (defaults to name of y)
</p>
</td></tr> 
<tr><td><code id="scatter.hist_+3A_title">title</code></td>
<td>

<p>plot title (optional)
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_pt.size">pt.size</code></td>
<td>

<p>size of points in scatterplot
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_hist.col">hist.col</code></td>
<td>

<p>color for histograms
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_pt.col">pt.col</code></td>
<td>

<p>color of points in scatterplot
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_pch">pch</code></td>
<td>

<p>scatterplot point character
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_reset.par">reset.par</code></td>
<td>

<p>reset graphics - default is TRUE; set to FALSE to add on to scatterplot
</p>
</td></tr>
<tr><td><code id="scatter.hist_+3A_...">...</code></td>
<td>

<p>other graphical parameters
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scatter.hist(tempr, cmort, hist.col=astsa.col(5,.4), pt.col=5, pt.size=1.5, reset=FALSE)
lines(lowess(tempr, cmort), col=6)
</code></pre>

<hr>
<h2 id='SigExtract'>Signal Extraction And Optimal Filtering
</h2><span id='topic+SigExtract'></span>

<h3>Description</h3>

<p>Performs signal extraction and optimal filtering as discussed in Chapter 4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SigExtract(series, L = c(3, 3), M = 50, max.freq = 0.05, col = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SigExtract_+3A_series">series</code></td>
<td>
<p>univariate time series to be filtered
</p>
</td></tr>
<tr><td><code id="SigExtract_+3A_l">L</code></td>
<td>
<p>degree of smoothing (may be a vector); see <code>spans</code> in <code>spec.pgram</code>
for more details 
</p>
</td></tr>
<tr><td><code id="SigExtract_+3A_m">M</code></td>
<td>
<p>number of terms used in the lagged regression approximation
</p>
</td></tr>
<tr><td><code id="SigExtract_+3A_max.freq">max.freq</code></td>
<td>
<p>truncation frequency, which must be larger than 1/M 
</p>
</td></tr>
<tr><td><code id="SigExtract_+3A_col">col</code></td>
<td>
<p>color of the main graphs
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic function of the script, and the default setting, is to remove frequencies above 1/20 (and, in particular, the seasonal frequency of 1 cycle every 12 time points). The  sampling frequency of the time series is set to unity prior to the analysis. 
</p>


<h3>Value</h3>

<p>Returns plots of (1) the original and filtered series, (2) the estiamted spectra of each series, (3)  the filter coefficients and the desired and attained frequency response function.  The filtered series is returned invisibly.
</p>


<h3>Note</h3>

<p>The script is based on code that was contributed by Professor Doug Wiens,
Department of Mathematical and Statistical Sciences, University of Alberta.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='sleep1'>
Sleep State and Movement Data - Group 1
</h2><span id='topic+sleep1'></span>

<h3>Description</h3>

<p>Sleep-state and number of movements of infants taken from a study on the effects of
prenatal exposure to alcohol. This is Group 1 where the mothers did not drink alcohol
during pregnancy.
</p>


<h3>Format</h3>

<p>List of 12 (by subjects)
:'data.frame':	120 obs. of  3 variables:
.. min  : int [1:120] minute (1 to 120)
.. state: int [1:120] sleep state 1 to 6 with NA missing (see details)
.. mvmnt: int [1:120] number of movements
</p>


<h3>Details</h3>

<p>Per minute sleep state, for approximately 120 minutes, is categorized into one of
six possible states, non-REM: NR1 [1] to NR4 [4], and REM [5], or AWAKE [6].
NA means no state is recorded for that minute (if there, it occurs at end of the session).
Group 1 (this group) is from mothers who abstained from drinking during
pregnancy. In addition, the number of movements per minute are listed.
</p>


<h3>Source</h3>

<p>Stoffer, D. S., Scher, M. S., Richardson, G. A., Day, N. L., Coble, P. A. (1988). A Walsh-Fourier Analysis of the Effects of Moderate Maternal Alcohol Consumption on Neonatal Sleep-State Cycling. Journal of the American Statistical Association, 83(404), 954-963. <kbd>https://doi.org/10.2307/2290119</kbd>
</p>
<p>Stoffer, D. S. (1990). Multivariate Walsh-Fourier Analysis. Journal of Time Series Analysis, 11(1), 57-73.
<kbd> https://doi.org/10.1111/j.1467-9892.1990.tb00042.x</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sleep2">sleep2</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# plot data 
par(xpd = NA, oma=c(0,0,0,8) )
tsplot(sleep1[[1]][2:3], type='s', col=2:3, spag=TRUE, gg=TRUE)
legend('topright', inset=c(-0.3,0), bty='n', lty=1, col=2:3, legend=c('sleep state',
        'number of \nmovements'))
## you may have to change the first value of 'inset' in the legend to get it to fit        

# spectral analysis
x = dna2vector(sleep1[[1]]$state[1:115], alphabet=c('1','2','3','4','5'))  # never awake
specenv(x, spans=c(3,3))
abline(v=1/60, lty=2, col=8)

## End(Not run)
</code></pre>

<hr>
<h2 id='sleep2'>
Sleep State and Movement Data - Group 2
</h2><span id='topic+sleep2'></span>

<h3>Description</h3>

<p>Sleep-state and number of movements of infants taken from a study on the effects of
prenatal exposure to alcohol. This is Group 2 where the mothers drank alcohol in
moderation during pregnancy.
</p>


<h3>Format</h3>

<p>List of 12 (by subjects)
:'data.frame':	120 obs. of  3 variables:
.. min  : int [1:120] minute (1 to 120)
.. state: int [1:120] sleep state 1 to 6 with NA missing (see details)
.. mvmnt: int [1:120] number of movements
</p>


<h3>Details</h3>

<p>Per minute sleep state, for approximately 120 minutes, is categorized into one of
six possible states, non-REM: NR1 [1] to NR4 [4], and REM [5], or AWAKE [6].
NA means no state is recorded for that minute (if there, it occurs at end of the session).
Group 2 (this group) is from mothers who drank alcohol in moderation during
pregnancy. In addition, the number of movements per minute are listed.
</p>


<h3>Source</h3>

<p>Stoffer, D. S., Scher, M. S., Richardson, G. A., Day, N. L., Coble, P. A. (1988). A Walsh-Fourier Analysis of the Effects of Moderate Maternal Alcohol Consumption on Neonatal Sleep-State Cycling. Journal of the American Statistical Association, 83(404), 954-963. <kbd>https://doi.org/10.2307/2290119</kbd>
</p>
<p>Stoffer, D. S. (1990). Multivariate Walsh-Fourier Analysis. Journal of Time Series Analysis, 11(1), 57-73.
<kbd> https://doi.org/10.1111/j.1467-9892.1990.tb00042.x</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sleep1">sleep1</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# plot data 
par(xpd = NA, oma=c(0,0,0,8) )
tsplot(sleep2[[3]][2:3], type='s', col=2:3, spag=TRUE, gg=TRUE)
legend('topright', inset=c(-0.3,0), bty='n', lty=1, col=2:3, legend=c('sleep state',
        'number of \nmovements'))
## you may have to change the first value of 'inset' in the legend to get it to fit        

# spectral analysis
x = dna2vector(sleep1[[1]]$state[1:115], alphabet=c('1','2','3','4','5'))  # never awake
specenv(x, spans=c(3,3))
abline(v=1/60, lty=2, col=8)

## End(Not run)
</code></pre>

<hr>
<h2 id='so2'>SO2 levels from the LA pollution study
</h2><span id='topic+so2'></span>

<h3>Description</h3>

<p>Sulfur dioxide levels from the LA pollution study
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:508] from 1970 to 1980: 3.37 2.59 3.29 3.04 3.39 2.57 2.35 3.38 1.5 2.56 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lap">lap</a></code></p>

<hr>
<h2 id='soi'>Southern Oscillation Index
</h2><span id='topic+soi'></span>

<h3>Description</h3>

<p>Southern Oscillation Index (SOI) for a period of 453 months ranging over the years 1950-1987.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:453] from 1950 to 1988: 0.377 0.246 0.311 0.104 -0.016 0.235 0.137 0.191 -0.016 0.29 ...
</p>


<h3>Details</h3>

<p>pairs with <code>rec</code> (Recruitment)
</p>


<h3>Source</h3>

<p>Data furnished by Dr. Roy Mendelssohn of the Pacific Fisheries Environmental Laboratory, NOAA (personal communication).
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rec">rec</a>, <a href="#topic+ENSO">ENSO</a></code>
</p>

<hr>
<h2 id='soiltemp'>Spatial Grid of Surface Soil Temperatures
</h2><span id='topic+soiltemp'></span>

<h3>Description</h3>

<p>A 64 by 36 matrix of surface soil temperatures.
</p>


<h3>Format</h3>

<p>The format is:
num [1:64, 1:36] 6.7 8.9 5 6.6 6.1 7 6.5 8.2 6.7 6.6 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='sp500.gr'>Returns of the S&amp;P 500
</h2><span id='topic+sp500.gr'></span>

<h3>Description</h3>

<p>Daily growth rate of the   S&amp;P 500 from 2001 though 2011.
</p>


<h3>Format</h3>

<p>The format is: Time Series; Start = c(2001, 2); End = c(2011, 209); Frequency = 252 
</p>


<h3>Source</h3>

<p>Douc, Moulines, &amp; Stoffer (2014). <em>Nonlinear Time Series: Theory, Methods and Applications with R Examples</em>. CRC Press.  ISBN: &lt;9781466502253&gt;
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='sp500w'>Weekly Growth Rate of the Standard and Poor's 500
</h2><span id='topic+sp500w'></span>

<h3>Description</h3>

<p>Weekly closing returns of the SP 500 from 2003 to September,  2012.
</p>


<h3>Format</h3>

<p>An 'xts' object on 2003-01-03 to 2012-09-28; 
Indexed by objects of class: [Date] TZ: UTC
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='spec.ic'>
Estimate Spectral Density of a Time Series from AR Fit
</h2><span id='topic+spec.ic'></span>

<h3>Description</h3>

<p>Fits an AR model to data and computes (and by default plots) the spectral 
density of the fitted model based on AIC (default) or BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec.ic(xdata, BIC=FALSE, order.max=NULL, main=NULL, plot=TRUE, detrend=TRUE, 
         lowess=FALSE, method=NULL, cex.main=NULL, xlab=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spec.ic_+3A_xdata">xdata</code></td>
<td>

<p>a univariate time series.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_bic">BIC</code></td>
<td>

<p>if TRUE, fit is based on BIC. If FALSE (default), fit is based on AIC.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_order.max">order.max</code></td>
<td>

<p>maximum order of model to fit. Defaults (if NULL) to the minimum of 100 
and 10% of the number of observations. 
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_main">main</code></td>
<td>

<p>plot title. Defaults to name of series, method and chosen order.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_plot">plot</code></td>
<td>

<p>if TRUE (default) produces a graphic of the estimated AR spectrum.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_detrend">detrend</code></td>
<td>

<p>if TRUE (default), detrends the data first. If FALSE, the series is demeaned.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_lowess">lowess</code></td>
<td>

<p>if TRUE, detrends using lowess. Default is FALSE.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_method">method</code></td>
<td>
<p>method of estimation - a character string specifying the 
method to fit the model chosen from the following:
&quot;yule-walker&quot;, &quot;burg&quot;, &quot;ols&quot;, &quot;mle&quot;, &quot;yw&quot;. Defaults to &quot;yule-walker&quot;.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_cex.main">cex.main</code></td>
<td>

<p>magnification for main title; default is 1.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_xlab">xlab</code></td>
<td>
<p>label for frequency axis; if NULL (default), a totally awesome label is generated for your viewing pleasure.
</p>
</td></tr>
<tr><td><code id="spec.ic_+3A_...">...</code></td>
<td>

<p>additional graphical arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>ar</code> to fit the best AR model based on pseudo AIC or BIC. 
Using <code>method='mle'</code> will be slow. The minimum centered AIC and BIC values and the 
spectral and frequency ordinates are returned silently.
</p>


<h3>Value</h3>

<table>
<tr><td><code>[[1]]</code></td>
<td>
<p>Matrix with columns: ORDER, AIC, BIC</p>
</td></tr>
<tr><td><code>[[2]]</code></td>
<td>
<p>Matrix with columns: freq, spec</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer 
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+ar">ar</a></code>, <code><a href="stats.html#topic+spec.ar">spec.ar</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# AIC
spec.ic(soi)  
spec.ic(sunspotz, method='burg', col=4)   

# BIC after detrending on log scale
spec.ic(soi, BIC=TRUE, detrend=TRUE, log='y')  

# plot AIC and BIC without spectral estimate
tsplot(0:30, spec.ic(soi, plot=FALSE)[[1]][,2:3], type='o', xlab='order', nxm=5)  

## End(Not run)
</code></pre>

<hr>
<h2 id='specenv'>
Spectral Envelope
</h2><span id='topic+specenv'></span>

<h3>Description</h3>

<p>Computes the spectral envelope of categorical-valued or real-valued time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specenv(xdata, section = NULL, spans = NULL, kernel = NULL, taper = 0,
         significance = 1e-04, plot = TRUE, ylim = NULL, real = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="specenv_+3A_xdata">xdata</code></td>
<td>
<p>For categorical-valued sequences, a matrix with rows that are indicators
of the categories represented by the columns, possibly a sequence converted using
<code><a href="#topic+dna2vector">dna2vector</a></code>.  For real-valued sequences, a matrix with at least two
columns that are various transformations of the data.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_section">section</code></td>
<td>

<p>of the form <code>start:end</code> where <code>start &lt; end</code> are positive integers;
specifies the section used in the analysis - default is the entire sequence.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_spans">spans</code></td>
<td>

<p>specify smoothing used in <code>mvspec</code>.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_kernel">kernel</code></td>
<td>

<p>specify kernel to be used in <code>mvspec</code>.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_taper">taper</code></td>
<td>

<p>specify amount of tapering to be used in <code>mvspec</code>.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_significance">significance</code></td>
<td>

<p>significance threshold exhibited in plot - default is .0001; set to NA to cancel
</p>
</td></tr>
<tr><td><code id="specenv_+3A_plot">plot</code></td>
<td>

<p>if TRUE (default) a graphic of the spectral envelope is produced
</p>
</td></tr>
<tr><td><code id="specenv_+3A_ylim">ylim</code></td>
<td>

<p>limits of the spectral envelope axis; if NULL (default), a suitable range is calculated.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_real">real</code></td>
<td>
<p> FALSE (default) for categorical-valued sequences and TRUE for
real-valued sequences.
</p>
</td></tr>
<tr><td><code id="specenv_+3A_...">...</code></td>
<td>

<p>other graphical parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the spectral envelope for categorical-valued series as discussed in <br />
<kbd>https://www.stat.pitt.edu/stoffer/dss_files/spenv.pdf</kbd> <br />
and summarized in <br />
<kbd>https://doi.org/10.1214/ss/1009212816</kbd>. <br />
Alternately, calculates the spectral envelope for real-valued series as discussed in <br />
<kbd>https://doi.org/10.1016/S0378-3758(96)00044-4</kbd>.
</p>
<p>These concepts are also presented (with examples) in Section 7.9 (Chapter 7) of  Time Series Analysis and Its Applications: With R Examples: <kbd>https://www.stat.pitt.edu/stoffer/tsa4/</kbd>.
</p>
<p>For categorical-valued series, the input  <code>xdata</code> must be a matrix of indicators which is perhaps a sequence preprocessed using <code><a href="#topic+dna2vector">dna2vector</a></code>.
</p>
<p>For real-valued series, the input <code>xdata</code> should be a matrix whose columns are various transformations of the univariate series.
</p>
<p>The script does not detrend the data prior to estimating spectra. If this is an issue, then detrend the data prior to using this script.
</p>


<h3>Value</h3>

<p>By default, will produce a graph of the spectral envelope and an approximate significance threshold.
A matrix containing: frequency, spectral envelope ordinates, and (1) the scalings of the categories in the order of the categories in the alphabet or (2) the coefficients of the transformations, is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dna2vector">dna2vector</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# a DNA sequence
data  = bnrf1ebv
xdata = dna2vector(data)
u = specenv(xdata, section=1:1000, spans=c(7,7))
head(u)  # scalings are for A, C, G, and last one T=0 always

# a real-valued series (nyse returns)
x = astsa::nyse
xdata = cbind(x, abs(x), x^2)
u = specenv(xdata, real=TRUE,  spans=c(3,3))
# plot optimal transform at freq = .001
beta = u[2, 3:5]
b = beta/beta[2]  # makes abs(x) coef=1
gopt = function(x) { b[1]*x+b[2]*abs(x)+b[3]*x^2 }
curve(gopt, -.2, .2, col=4, lwd=2, panel.first=Grid())
g2 = function(x) { b[2]*abs(x) } # corresponding to |x|
curve(g2, -.2,.2, add=TRUE, col=6)

## End(Not run)
</code></pre>

<hr>
<h2 id='speech'>Speech Recording
</h2><span id='topic+speech'></span>

<h3>Description</h3>

<p>A small .1 second (1000 points) sample of recorded speech for the phrase &quot;aaa...hhh&quot;.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:1020] from 1 to 1020: 1814 1556 1442 1416 1352 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='ssm'>State Space Model
</h2><span id='topic+ssm'></span>

<h3>Description</h3>

<p>Fits a simple univariate state space model to data. The parameters
are estimated (the state regression parameter may be fixed).  State 
predictions, filters, and smoothers
and corresponding error variances are evaluated at the estimates.  The sample
size must be at least 20.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssm(y, A, phi, alpha, sigw, sigv, fixphi = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssm_+3A_y">y</code></td>
<td>

<p>data
</p>
</td></tr>
<tr><td><code id="ssm_+3A_a">A</code></td>
<td>

<p>measurement value (fixed constant)
</p>
</td></tr>
<tr><td><code id="ssm_+3A_phi">phi</code></td>
<td>

<p>initial value of phi, may be fixed
</p>
</td></tr>
<tr><td><code id="ssm_+3A_alpha">alpha</code></td>
<td>

<p>initial value for alpha
</p>
</td></tr>
<tr><td><code id="ssm_+3A_sigw">sigw</code></td>
<td>

<p>initial value for sigma[w]
</p>
</td></tr>
<tr><td><code id="ssm_+3A_sigv">sigv</code></td>
<td>

<p>initial value for sigma[v]
</p>
</td></tr>
<tr><td><code id="ssm_+3A_fixphi">fixphi</code></td>
<td>

<p>if TRUE, the phi parameter is fixed
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The script works for a specific univariate state space model,
</p>
<p style="text-align: center;"><code class="reqn">x_t = \alpha + \phi x_{t-1} + w_t \quad {\rm and} \quad y_t = A x_t + v_t.</code>
</p>

<p>The initial state conditions use a default calculation and cannot be specified.
The parameter estimates are printed and the script returns the state predictors and
smoothers.  The regression parameter <code class="reqn">\phi</code> may be fixed.
</p>


<h3>Value</h3>

<p>At the MLEs, these are returned invisibly:
</p>
<table>
<tr><td><code>Xp</code></td>
<td>
<p>time series - state prediction, <code class="reqn">x_t^{t-1}</code></p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>corresponding MSPEs, <code class="reqn">P_t^{t-1}</code></p>
</td></tr>
<tr><td><code>Xf</code></td>
<td>
<p>time series - state filter, <code class="reqn">x_t^t</code></p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>corresponding MSEs, <code class="reqn">P_t^t</code></p>
</td></tr>
<tr><td><code>Xs</code></td>
<td>
<p>time series - state smoother, <code class="reqn">x_t^n</code></p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>corresponding MSEs, <code class="reqn">P_t^n</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

u = ssm(gtemp_land, A=1, alpha=.01, phi=1, sigw=.05, sigv=.15)
tsplot(gtemp_land, type='o', col=4)
lines(u$Xs, col=6, lwd=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='star'>Variable Star 
</h2><span id='topic+star'></span>

<h3>Description</h3>

<p>The  magnitude of a star taken at midnight for
600 consecutive days. The data are taken from the classic text,
The Calculus of Observations, a Treatise on Numerical Mathematics, by E.T. Whittaker and G. Robinson, 
(1923, Blackie and Son, Ltd.). 
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:600] from 1 to 600: 25 28 31 32 33 33 32 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='stoch.reg'>Frequency Domain Stochastic Regression
</h2><span id='topic+stoch.reg'></span>

<h3>Description</h3>

<p>Performs frequency domain stochastic regression discussed in Chapter 7.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stoch.reg(xdata, cols.full, cols.red=NULL, alpha, L, M, plot.which, col.resp=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stoch.reg_+3A_xdata">xdata</code></td>
<td>
<p>data matrix with the last column being the response variable
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_cols.full">cols.full</code></td>
<td>
<p>specify columns of data matrix that are in the full model
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_cols.red">cols.red</code></td>
<td>
<p>specify columns of data matrix that are in the reduced model (use NULL if there are no inputs in the reduced model) 
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_alpha">alpha</code></td>
<td>
<p>test size; number between 0 and 1
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_l">L</code></td>
<td>
<p>odd integer specifying degree of smoothing  
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_m">M</code></td>
<td>
<p>number (integer) of points in the discretization of the integral
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_plot.which">plot.which</code></td>
<td>
<p><code>coh</code> or <code>F.stat</code>, to plot either the squared-coherencies or the F-statistics, respectively
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_col.resp">col.resp</code></td>
<td>
<p>specify column of the response variable if it is not the last column of
the data matrix
</p>
</td></tr>
<tr><td><code id="stoch.reg_+3A_...">...</code></td>
<td>
<p>additional graphic arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the spectral matrix, F statistics and coherences, and plots them.
Returned as well are the coefficients in the impulse response function.
</p>
<p>Enter, as the argument to this function, the full data matrix, and then the labels of the 
columns of input series in the &quot;full&quot; and &quot;reduced&quot; regression models - enter NULL if there 
are no inputs under the reduced model. 
</p>
<p>If the response variable is the LAST column of the data matrix, it need not be specified. Otherwise specify which column holds the responses as <code>col.resp</code>.
</p>
<p>Other inputs are alpha (test size), L (smoothing), M (number 
of points in the discretization of the integral)  and plot.which = &quot;coh&quot; 
or &quot;F&quot;, to plot either the coherences or the F statistics.
</p>


<h3>Value</h3>

<table>
<tr><td><code>power.full</code></td>
<td>
<p>spectrum under the full model</p>
</td></tr>
<tr><td><code>power.red</code></td>
<td>
<p>spectrum under the reduced model</p>
</td></tr>
<tr><td><code>Betahat</code></td>
<td>
<p>regression parameter estimates</p>
</td></tr>
<tr><td><code>eF</code></td>
<td>
<p>pointwise (by frequency) F-tests</p>
</td></tr>
<tr><td><code>coh</code></td>
<td>
<p>coherency</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See Example 7.1 of the text. The script is based on code that was contributed by Professor Doug Wiens, Department of Mathematical and Statistical Sciences, University of Alberta. 
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='sunspotz'>Biannual Sunspot Numbers
</h2><span id='topic+sunspotz'></span>

<h3>Description</h3>

<p>Biannual smoothed (12-month moving average) number of sunspots from June 1749 to December 1978; n = 459. The &quot;z&quot; on the end is to distinguish this series from the one included with R (called <code>sunspots</code>).
</p>


<h3>Format</h3>

<p>The format is: 
Time Series:
Start = c(1749, 1) 
End = c(1978, 1) 
Frequency = 2 
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='SV.mcmc'>Fit Bayesian Stochastic Volatility Model
</h2><span id='topic+SV.mcmc'></span>

<h3>Description</h3>

<p>Fits a stochastic volatility model to a univariate time series of returns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SV.mcmc(y, nmcmc = 1000, burnin = 100, init = NULL, hyper = NULL, tuning = NULL, 
         sigma_MH = NULL, npart = NULL, mcmseed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SV.mcmc_+3A_y">y</code></td>
<td>

<p>single time series of returns
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_nmcmc">nmcmc</code></td>
<td>

<p>number of iterations for the MCMC procedure
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_burnin">burnin</code></td>
<td>

<p>number of iterations to discard for the MCMC procedure
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_init">init</code></td>
<td>

<p>initial values of (phi, sigma, beta) -  default is <code>c(0.9, 0.5, .1)</code>
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_hyper">hyper</code></td>
<td>

<p>hyperparameters for bivariate normal distribution of (phi, sigma); user inputs (mu_phi, mu_q, sigma_phi, sigma_q, rho) - 
default is <code>c(0.9, 0.5, 0.075, 0.3, -0.25)</code>
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_tuning">tuning</code></td>
<td>

<p>tuning parameter -  default is <code>.03</code>
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_sigma_mh">sigma_MH</code></td>
<td>

<p>covariance matrix used for random walk Metropolis; it will be scaled by <code>tuning</code> in the script - default is 
<code>matrix(c(1,-.25,-.25,1), nrow=2, ncol=2)</code>
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_npart">npart</code></td>
<td>

<p>number of particles used in particle filter - default is <code>10</code>
</p>
</td></tr>
<tr><td><code id="SV.mcmc_+3A_mcmseed">mcmseed</code></td>
<td>

<p>seed for mcmc - default is <code>90210</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The log-volatility process is <code class="reqn">x_t</code> and the returns are <code class="reqn">y_t</code>. The SV model is
</p>
<p style="text-align: center;"><code class="reqn">x_t = \phi x_{t-1} + \sigma w_t \qquad y_t = \beta \exp\{\frac{1}{2} x_t\}\epsilon_t</code>
</p>

<p>where <code class="reqn">w_t</code> and <code class="reqn">\epsilon_t</code> are independent standard normal white noise.
</p>
<p>The model is fit using a technique described in the paper listed below (in the Source section) where the state
parameters <code class="reqn">(\phi, \sigma)</code> are sampled simultaneously with a bivariate normal prior specified
in the arguments <code>init</code> and <code>hyper</code>.
</p>
<p>Two graphics are returned: (1) the three parameter traces with the posterior mean highlighted,
their ACFs [with effective sample sizes (ESS)], and their histograms with the .025, .5, and .975 quantiles displayed, 
and (2) the log-volatility posterior mean along with corresponding .95 credible intervals.
</p>


<h3>Value</h3>

<p>Returned invisibly:
</p>
<table>
<tr><td><code>phi</code></td>
<td>
<p>vector of sampled state AR parameter</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>vector of sampled state error stnd deviation</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>vector of sampled observation error scale</p>
</td></tr>
<tr><td><code>log.vol</code></td>
<td>
<p>matrix of sampled log-volatility</p>
</td></tr> 
<tr><td><code>options</code></td>
<td>
<p>values of the input arguments</p>
</td></tr>   
</table>


<h3>Note</h3>

<p>Except for the data, all the other inputs have defaults.  The time to run and the acceptance rate are returned at the end of the analysis.  The acceptance rate should be around 30% and this is easily adjusted using the tuning parameter.  
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>Gong &amp; Stoffer (2021). A note on efficient fitting of stochastic volatility models. <em>Journal of Time Series Analysis</em>, 42(2), 186-200.  <a href="https://github.com/nickpoison/Stochastic-Volatility-Models">https://github.com/nickpoison/Stochastic-Volatility-Models</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at 
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SV.mle">SV.mle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#--   A minimal example  --##
myrun &lt;- SV.mcmc(sp500w)   # results in object myrun - don't forget it 

str(myrun)                 # an easy way to see the default input options

## End(Not run)
</code></pre>

<hr>
<h2 id='SV.mle'>
Stochastic Volatility Model with Feedback via MLE
</h2><span id='topic+SV.mle'></span>

<h3>Description</h3>

<p>Fits a stochastic volatility model with feedback (optional) to a univariate time series of returns via quasi-MLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SV.mle(returns, gamma = 0, phi = 0.95, sQ = 0.1, alpha = NULL, sR0 = 1, mu1 = -3, sR1 = 2, 
        rho = NULL, feedback = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SV.mle_+3A_returns">returns</code></td>
<td>

<p>single time series of returns
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_gamma">gamma</code></td>
<td>

<p>feedback coefficient - included if <code>feedback=TRUE</code> (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_phi">phi</code></td>
<td>

<p>initial value of the log-volatility AR parameter (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_sq">sQ</code></td>
<td>

<p>initial value of the standard deviation of log-volatility noise (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_alpha">alpha</code></td>
<td>

<p>initial value of the log-returns^2 constant parameter (does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_sr0">sR0</code></td>
<td>

<p>initial value of the log-returns^2 normal mixture standard deviation parameter (component 0 - does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_mu1">mu1</code></td>
<td>

<p>initial value of the log-returns^2 normal mixture mean parameter (component 1 - does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_sr1">sR1</code></td>
<td>

<p>initial value of the log-returns^2 normal mixture standard deviation parameter (component 1 - does not have to be specified)
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_rho">rho</code></td>
<td>

<p>correlation between the state noise and observation noise (so called &quot;leverage&quot;). If <code>feedback=TRUE</code>
this will be included if given a proper numerical value; if NULL (default) it is not included because 
it is often not significant when the feedback coefficient is included.   
</p>
</td></tr>
<tr><td><code id="SV.mle_+3A_feedback">feedback</code></td>
<td>

<p>if TRUE feedback is included in the model; default is FALSE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returns are <code class="reqn">r_t</code> (input this).
The log-volatility process is <code class="reqn">x_t</code>   and 
<code class="reqn">y_t = \log r_t^2</code>. 
</p>
<p>If <code>feedback=TRUE</code>, the model is
</p>
<p style="text-align: center;"><code class="reqn">x_{t+1} = \gamma r_t + \phi x_t + \sigma w_t \qquad y_t = \alpha + x_t + \eta_t</code>
</p>

<p>where <code class="reqn">w_t</code> is standard normal noise.  The observation error <code class="reqn">\eta_t</code> is a mixture of
two normals, <code class="reqn">N(0, \sigma_0^2)</code> and <code class="reqn">N(\mu_1, \sigma_1^2)</code>.  The state
and observation noise can be correlated if <code class="reqn">\rho</code> is given a value between -1 and 1.
</p>
<p>If <code>feedback=FALSE</code>, <code class="reqn">\gamma</code> and <code class="reqn">\rho</code> are not included in the model.
</p>


<h3>Value</h3>

<p>Returned invisibly:
</p>
<table>
<tr><td><code>PredLogVol</code></td>
<td>
<p>one-step-ahead predicted log-volatility </p>
</td></tr>
<tr><td><code>RMSPE</code></td>
<td>
<p>corresponding root MSPE</p>
</td></tr>
<tr><td><code>Coefficients</code></td>
<td>
<p>table of estimates and estimated standard errors</p>
</td></tr>
</table>
<p>In addition to the one step ahead predicted log-volatility, corresponding root MSPE, and table of estimates returned invisibly, the estimates and SEs are printed and a graph of (1) the data with the predicted log-volatility, and (2) the normal mixture are displayed in one graphic.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at 
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SV.mcmc">SV.mcmc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

SV.mle(sp500.gr, feedback=TRUE)

SV.mle(nyse)

## End(Not run)
</code></pre>

<hr>
<h2 id='tempr'>Temperatures from the LA pollution study 
</h2><span id='topic+tempr'></span>

<h3>Description</h3>

<p>Temperature series corresponding to <code>cmort</code> from the LA pollution study.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:508] from 1970 to 1980: 72.4 67.2 62.9 72.5 74.2 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lap">lap</a></code></p>

<hr>
<h2 id='test.linear'>Test Linearity of a Time Series via Normalized Bispectrum 
</h2><span id='topic+test.linear'></span>

<h3>Description</h3>

<p>Produces a plot of the tail probabilities of a normalized bispectrum of a series under the assumption the model is a linear process with iid innovations. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.linear(series, color = TRUE, detrend = FALSE, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.linear_+3A_series">series</code></td>
<td>
<p> the time series (univariate only)
</p>
</td></tr>
<tr><td><code id="test.linear_+3A_color">color</code></td>
<td>
<p> if FALSE, the graphic is produced in gray scale
</p>
</td></tr>
<tr><td><code id="test.linear_+3A_detrend">detrend</code></td>
<td>
<p> if TRUE, the series is detrended first
</p>
</td></tr>
<tr><td><code id="test.linear_+3A_main">main</code></td>
<td>
<p> if NULL (default), a very nice title is chosen for the plot
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prob</code></td>
<td>
<p> matrix of tail probabilities - returned invisibly</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The null hypothesis is that the data are from a linear process with i.i.d. innovations. Under the null hypothesis, the bispectrum is constant over all frequencies.  Chi-squared test statistics are formed in blocks to measure departures from the null hypothesis and the corresponding p-values are displayed in a graphic and returned invisibly. Details are in 
Hinich, M. and Wolinsky, M. (2005). Normalizing bispectra. <em>Journal of Statistical Planning and Inference</em>, 130, 405&ndash;411.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
test.linear(nyse)  # :(
test.linear(soi)   # :)

## End(Not run)
</code></pre>

<hr>
<h2 id='trend'>Estimate Trend
</h2><span id='topic+trend'></span>

<h3>Description</h3>

<p>Estimates the trend (polynomial or lowess) of a time series and returns a graphic of the series with the trend and error bounds superimposed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trend(series, order = 1, lowess = FALSE, lowspan = .75, robust = TRUE,
         col = c(4, 6), ylab = NULL, ci=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trend_+3A_series">series</code></td>
<td>

<p>The time series to be analyzed (univariate only).
</p>
</td></tr>
<tr><td><code id="trend_+3A_order">order</code></td>
<td>

<p>Order of the polynomial used to estimate the trend with a linear default (order=1) unless <code>lowess</code> is TRUE.
</p>
</td></tr>
<tr><td><code id="trend_+3A_lowess">lowess</code></td>
<td>

<p>If TRUE,  <code>loess</code> from the stats package is used to fit the trend. The default is FALSE.
</p>
</td></tr>
<tr><td><code id="trend_+3A_lowspan">lowspan</code></td>
<td>

<p>The smoother span used for lowess.
</p>
</td></tr>
<tr><td><code id="trend_+3A_robust">robust</code></td>
<td>

<p>If TRUE (default), the lowess fit is robust.
</p>
</td></tr>
<tr><td><code id="trend_+3A_col">col</code></td>
<td>

<p>Vector of two colors for the graphic, first the color of the data (default is blue [4]) and second the color of the trend (default is magenta [6]). Both the data and trend line will be the same color if only one value is given.
</p>
</td></tr>
<tr><td><code id="trend_+3A_ylab">ylab</code></td>
<td>

<p>Label for the vertical axis (default is the name of the series).
</p>
</td></tr>
<tr><td><code id="trend_+3A_ci">ci</code></td>
<td>

<p>If TRUE (default), pointwise 95
</p>
</td></tr>
<tr><td><code id="trend_+3A_...">...</code></td>
<td>

<p>Other graphical parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces a graphic of the time series with the trend and a .95 pointwise confidence interval superimposed. The trend estimate and the error bounds are returned invisibly.
</p>


<h3>Value</h3>

<p>Produces a graphic and returns the trend estimate <code>fit</code> and error bounds  <code>lwr</code> and <code>upr</code> invisibly
(see details) and with the same time series attributes as the input <code>series</code>.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detrend">detrend</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

par(mfrow=2:1)
trend(soi)
trend(soi, lowess=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='tsplot'>Time Series Plot
</h2><span id='topic+tsplot'></span>

<h3>Description</h3>

<p>Produces a nice plot of univariate or multiple time series in one easy line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsplot(x, y=NULL, main=NULL, ylab=NULL, xlab='Time', type=NULL,
          margins=.25, ncolm=1, byrow=TRUE, nx=NULL, ny=nx, 
          minor=TRUE, nxm=2, nym=1, xm.grid=TRUE, ym.grid=TRUE, col=1, 
          gg=FALSE, spaghetti=FALSE, pch=NULL, lty=1, lwd=1, mgpp=0, 
          topper=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsplot_+3A_x">x</code>, <code id="tsplot_+3A_y">y</code></td>
<td>

<p>time series to be plotted; if both present, x will be the time index.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_main">main</code></td>
<td>

<p>add a plot title - the default is no title.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_ylab">ylab</code></td>
<td>

<p>y-axis label - the default is the name of the ts object.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_xlab">xlab</code></td>
<td>

<p>x-axis label - the default is 'Time'.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_type">type</code></td>
<td>

<p>type of plot - the default is line.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_margins">margins</code></td>
<td>

<p>inches to add (or subtract) to the margins. Input one value to apply to all margins or a vector of length 4 to add (or subtract) to the (bottom, left, top, right) margins.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_ncolm">ncolm</code></td>
<td>

<p>for multiple time series, the number of columns to plot.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_byrow">byrow</code></td>
<td>

<p>for multiple time series - if TRUE (default), plot series row wise; if FALSE, plot series column wise.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_nx">nx</code>, <code id="tsplot_+3A_ny">ny</code></td>
<td>
 
<p>number of major cells of the grid in x and y direction. When NULL, as per default, the grid aligns with the tick marks on the corresponding default axis (i.e., tickmarks as computed by axTicks). When NA, no grid lines are drawn in the corresponding direction.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_minor">minor</code>, <code id="tsplot_+3A_nxm">nxm</code>, <code id="tsplot_+3A_nym">nym</code></td>
<td>

<p>if minor=TRUE, the number of minor tick marks on x-axis, y-axis.  minor=FALSE removes both or set either to 0 or 1 to remove.
The default is one minor tick on the x-axis and none on the y-axis.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_xm.grid">xm.grid</code>, <code id="tsplot_+3A_ym.grid">ym.grid</code></td>
<td>

<p>if TRUE (default), adds grid lines at minor x-axis, y-axis ticks.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_col">col</code></td>
<td>

<p>line color(s), can be a vector for multiple time series.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_gg">gg</code></td>
<td>

<p>if TRUE, will produce a gris-gris plot (gray graphic interior with white grid lines); the default is FALSE.
The grammar of astsa is voodoo;  see <kbd>https://www.youtube.com/watch?v=b4J8VrprrGE</kbd>
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_spaghetti">spaghetti</code></td>
<td>

<p>if TRUE, will produce a spaghetti plot (all series on same plot).
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_pch">pch</code></td>
<td>

<p>plot symbols (default is 1, circle); can be a vector for multiple plots.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_lty">lty</code></td>
<td>

<p>line type (default is 1, solid line); can be a vector for multiple plots.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_lwd">lwd</code></td>
<td>

<p>line width (default is 1); can be a vector for multiple plots.
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_mgpp">mgpp</code></td>
<td>

<p>this is used to adjust (add to) the <code>mgp</code> graphics parameters settings (<code>?par</code>), which are <code>c(1.6,.6,0)</code> here; the R default is <code>c(3,1,0)</code>.  This will be helpful in moving an axis label farther from the axis if necessary.  
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_topper">topper</code></td>
<td>

<p>non-negative value to add to the top outer margin; if NULL (default) a suitable value is chosen
</p>
</td></tr>
<tr><td><code id="tsplot_+3A_...">...</code></td>
<td>

<p>other graphical parameteres; see <a href="graphics.html#topic+par">par</a>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a graphic and returns it invisibly so it can be saved in an R variable with the ability to replay it;
see <code><a href="grDevices.html#topic+recordPlot">recordPlot</a></code>.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# minimal
tsplot(soi)
# prettified
tsplot(soi, col=4, main="Southern Oscillation Index")

# compare these
par(mfrow=2:1)
tsplot(1:453, soi, ylab='SOI', xlab='Month')
# now recklessly add to the margins and add to mgp to get to the default
tsplot(1:453, soi, ylab='SOI', xlab='Month', margins=c(2,3,4,5), las=1, mgpp=c(1.4,.4,0))

# gris-gris multiple plot 
tsplot(climhyd, ncolm=2, gg=TRUE, col=2:7, lwd=2)  

# spaghetti (and store it in an object - ?recordPlot for details)
x &lt;- replicate(100, cumsum(rcauchy(1000))/1:1000)
u &lt;- tsplot(x, col=1:8, main='No LLN For You', spaghetti=TRUE)
u   #  plot on demand

## End(Not run)
</code></pre>

<hr>
<h2 id='unemp'>U.S. Unemployment
</h2><span id='topic+unemp'></span>

<h3>Description</h3>

<p>Monthly U.S. Unemployment series (1948-1978, n = 372)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(unemp)</code></pre>


<h3>Format</h3>

<p>The format is:
Time-Series [1:372] from 1948 to 1979: 235 281 265 241 201 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnempRate">UnempRate</a></code></p>

<hr>
<h2 id='UnempRate'>U.S. Unemployment Rate
</h2><span id='topic+UnempRate'></span>

<h3>Description</h3>

<p>Monthly U.S. unemployment rate in percent unemployed (Jan, 1948 - Nov, 2016, n = 827)
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:827] from 1948 to 2017: 4 4.7 4.5 4 3.4 3.9 3.9 3.6 3.4 2.9 ...
</p>


<h3>Source</h3>

<p><a href="https://data.bls.gov/timeseries/LNU04000000/">https://data.bls.gov/timeseries/LNU04000000/</a>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.    
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unemp">unemp</a></code></p>

<hr>
<h2 id='USpop'>
U.S. Population - 1900 to 2010
</h2><span id='topic+USpop'></span>

<h3>Description</h3>

<p>U.S. Population by official census, every ten years from 1900 to 2010.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:12] from 1900 to 2010: 76 92 106 123 132 ...
</p>


<h3>Details</h3>

<p>The census from 2020 is not included in this data set because, by many accounts, it was a nightmare (<kbd>https://www.npr.org/2022/01/15/1073338121/2020-census-interference-trump</kbd>) due to the COVID-19 pandemic coupled with the fact that the Census Bureau is in the Department of Commerce, and its head is appointed by and reports directly to the POTUS, who at the time was DJ tRump: &quot;Historians rank Trump among worst presidents in US history ... &quot; (<kbd>https://www.businessinsider.com/historians-rank-trump-among-worst-presidents-us-history-c-span-2021-6</kbd>).
</p>


<h3>Source</h3>

<p><kbd>https://www.census.gov/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='varve'>Annual Varve Series
</h2><span id='topic+varve'></span>

<h3>Description</h3>

<p>Sedimentary deposits from one location in Massachusetts for 634 years, beginning nearly 12,000 years ago.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:634] from 1 to 634: 26.3 27.4 42.3 58.3 20.6 ...
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='WBC'>White Blood Cell Levels
</h2><span id='topic+WBC'></span>

<h3>Description</h3>

<p>WBC: Measurements made for 91 days on the three variables, log(white blood count) [WBC], log(platelet) [PLT] and hematocrit [HCT].   Missing data code is 0 (zero).
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:91] from 1 to 91: 2.33 1.89 2.08 1.82 1.82 ...
</p>


<h3>Details</h3>

<p>See Examples 6.1 amd 6.9 for more details.
</p>


<h3>Source</h3>

<p>Jones, R.H. (1984). Fitting multivariate models to unequally spaced data. In <em>Time Series Analysis of Irregularly Observed Data</em>, pp. 158-188. E. Parzen, ed. Lecture Notes in Statistics, 25, New York: Springer-Verlag.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>


<h3>See Also</h3>

<p><code><a href="#topic+blood">blood</a></code>, <code><a href="#topic+HCT">HCT</a></code>, <code><a href="#topic+PLT">PLT</a></code></p>

<hr>
<h2 id='xA_readme'>
SCRIPTS MARKED WITH AN 'x' ARE SCHEDULED TO BE PHASED OUT
</h2><span id='topic+xA_readme'></span>

<h3>Description</h3>

<p>Scripts marked with an 'x' are scheduled to be phased out.
</p>


<h3>Format</h3>

<p>The format is:
chr &quot;Scripts marked with an 'x' are scheduled to be phased out&quot;
</p>


<h3>Details</h3>

<p>Scripts marked with an 'x' are scheduled to be phased out.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>Source</h3>

<p>Scripts marked with an 'x' are scheduled to be phased out.
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>

<hr>
<h2 id='xEM0'>EM Algorithm for Time Invariant State Space Models - This script has been superseded by <code><a href="#topic+EM">EM</a></code>. 
</h2><span id='topic+xEM0'></span>

<h3>Description</h3>

<p>Estimation of the parameters in a simple state space via the EM algorithm.  NOTE: This script has been superseded by <code><a href="#topic+EM">EM</a></code>. Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xEM0(num, y, A, mu0, Sigma0, Phi, cQ, cR, max.iter = 50, tol = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xEM0_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_y">y</code></td>
<td>
<p>observation vector or time series
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_a">A</code></td>
<td>
<p>time-invariant observation matrix
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean vector
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-like decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_cr">cR</code></td>
<td>
<p>Cholesky-like decomposition of state error covariance matrix R &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum number of iterations
</p>
</td></tr>
<tr><td><code id="xEM0_+3A_tol">tol</code></td>
<td>
<p>relative tolerance for determining convergence
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cQ</code> and <code>cR</code> are the Cholesky-type decompositions of <code>Q</code> and <code>R</code>. In particular, <code>Q = t(cQ)%*%cQ</code> and <code>R = t(cR)%*%cR</code> is all that is required (assuming <code>Q</code> and <code>R</code> are valid covariance matrices). 
</p>


<h3>Value</h3>

<table>
<tr><td><code>Phi</code></td>
<td>
<p>Estimate of Phi</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Estimate of Q</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Estimate of R</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>
<p>Estimate of initial state mean</p>
</td></tr>
<tr><td><code>Sigma0</code></td>
<td>
<p>Estimate of initial state covariance matrix</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>-log likelihood at each iteration</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>number of iterations to convergence</p>
</td></tr>
<tr><td><code>cvg</code></td>
<td>
<p>relative tolerance at convergence</p>
</td></tr>
</table>


<h3>Note</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+EM">EM</a></code>
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xEM1'>EM Algorithm for General State Space Models - This script has been superseded by <code><a href="#topic+EM">EM</a></code>.
</h2><span id='topic+xEM1'></span>

<h3>Description</h3>

<p>Estimation of the parameters in the general state space  model via the EM algorithm.   Inputs are not allowed; see the note.  NOTE: This script has been superseded by <code><a href="#topic+EM">EM</a></code> and 
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xEM1(num, y, A, mu0, Sigma0, Phi, cQ, cR, max.iter = 100, tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xEM1_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_y">y</code></td>
<td>
<p>observation vector or time series; use 0 for missing values
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_a">A</code></td>
<td>
<p>observation matrices, an array with <code>dim=c(q,p,n)</code>; use 0 for missing values
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-like decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_cr">cR</code></td>
<td>
<p>R is diagonal here, so <code>cR = sqrt(R)</code> &ndash; also, see details below
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum number of iterations
</p>
</td></tr>
<tr><td><code id="xEM1_+3A_tol">tol</code></td>
<td>
<p>relative tolerance for determining convergence
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cQ</code> and <code>cR</code> are the Cholesky-type decompositions of <code>Q</code> and <code>R</code>. In particular, <code>Q = t(cQ)%*%cQ</code> and <code>R = t(cR)%*%cR</code> is all that is required (assuming <code>Q</code> and <code>R</code> are valid covariance matrices). 
</p>


<h3>Value</h3>

<table>
<tr><td><code>Phi</code></td>
<td>
<p>Estimate of Phi</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>Estimate of Q</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Estimate of R</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>
<p>Estimate of initial state mean</p>
</td></tr>
<tr><td><code>Sigma0</code></td>
<td>
<p>Estimate of initial state covariance matrix</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>-log likelihood at each iteration</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>number of iterations to convergence</p>
</td></tr>
<tr><td><code>cvg</code></td>
<td>
<p>relative tolerance at convergence</p>
</td></tr>
</table>


<h3>Note</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+EM">EM</a></code>
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.  
</p>

<hr>
<h2 id='xglobtemp'>Superseded by <code>gtemp_both</code> - Global mean land-ocean temperature deviations. 
</h2><span id='topic+xglobtemp'></span>

<h3>Description</h3>

<p>This data file is old and is scheduled to be deleted.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:136] from 1880 to 2015: -0.2 -0.11 -0.1 -0.2 -0.28 -0.31 -0.3 -0.33 -0.2 -0.11 ...
</p>


<h3>Source</h3>

<p><kbd>https://data.giss.nasa.gov/gistemp/graphs/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='xglobtempl'>Superseded by <code>gtemp_land</code> - Global mean land temperature deviations. 
</h2><span id='topic+xglobtempl'></span>

<h3>Description</h3>

<p>This data file is old and is scheduled to be deleted.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:136] from 1880 to 2015: -0.53 -0.51 -0.41 -0.43 -0.72 -0.56 -0.7 -0.74 -0.53 -0.25 ...
</p>


<h3>Source</h3>

<p><kbd>https://data.giss.nasa.gov/gistemp/graphs/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='xgtemp'>Superseded by <code>gtemp_both</code> - Global mean land-ocean temperature deviations. 
</h2><span id='topic+xgtemp'></span>

<h3>Description</h3>

<p>This data file is old and is scheduled to be deleted.
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:130] from 1880 to 2009: -0.28 -0.21 -0.26 -0.27 -0.32 -0.32 -0.29 -0.36 -0.27 -0.17 ...
</p>


<h3>Source</h3>

<p><kbd>https://data.giss.nasa.gov/gistemp/graphs/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='xgtemp2'>Superseded by <code>gtemp_land</code> - Global Mean Surface Air Temperature Deviations
</h2><span id='topic+xgtemp2'></span>

<h3>Description</h3>

<p>This data file is old and is scheduled to be deleted. 
</p>


<h3>Format</h3>

<p>The format is:
Time-Series [1:130] from 1880 to 2009: -0.24 -0.19 -0.14 -0.19 -0.45 -0.32 -0.42 -0.54 -0.24 -0.05 ...
</p>


<h3>Source</h3>

<p><kbd>https://data.giss.nasa.gov/gistemp/graphs/</kbd>
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gtemp_land">gtemp_land</a></code>, <code><a href="#topic+gtemp_ocean">gtemp_ocean</a></code>, <code><a href="#topic+gtemp_both">gtemp_both</a></code></p>

<hr>
<h2 id='xKfilter0'>Kalman Filter - This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>
</h2><span id='topic+xKfilter0'></span>

<h3>Description</h3>

<p>Returns the filtered values for the basic time invariant state-space model; inputs are not allowed.
NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>.  Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKfilter0(num, y, A, mu0, Sigma0, Phi, cQ, cR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKfilter0_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_a">A</code></td>
<td>
<p>time-invariant observation matrix
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean vector
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-type decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKfilter0_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead state prediction</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>innov</code></td>
<td>
<p>innovation series</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>innovation covariances</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain, needed for smoothing</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xKfilter1'>Kalman Filter - This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>.  
</h2><span id='topic+xKfilter1'></span>

<h3>Description</h3>

<p>Returns both the predicted and filtered values for a linear  state space model. Also evaluates
the likelihood at the given parameter values.  NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>.
Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKfilter1(num, y, A, mu0, Sigma0, Phi, Ups, Gam, cQ, cR, input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKfilter1_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_a">A</code></td>
<td>
<p>time-varying observation matrix, an array with <code>dim=c(q,p,n)</code>
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_ups">Ups</code></td>
<td>
<p>state input matrix; use <code>Ups = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_gam">Gam</code></td>
<td>
<p>observation input matrix; use <code>Gam = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-type decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKfilter1_+3A_input">input</code></td>
<td>
<p>matrix or vector of inputs having the same row dimension as y; use <code>input = 0</code> if not needed
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>innov</code></td>
<td>
<p>innovation series</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>innovation covariances</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain, needed for smoothing</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xKfilter2'>Kalman Filter - This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>.  
</h2><span id='topic+xKfilter2'></span>

<h3>Description</h3>

<p>Returns the filtered values  for the state space model.  In addition, the script returns the evaluation of the likelihood at the given parameter values and the innovation sequence.  NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>. Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKfilter2(num, y, A, mu0, Sigma0, Phi, Ups, Gam, Theta, cQ, cR, 
          S, input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKfilter2_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_a">A</code></td>
<td>
<p>time-varying observation matrix, an array with <code>dim = c(q,p,n)</code>
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_ups">Ups</code></td>
<td>
<p>state input matrix; use <code>Ups = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_gam">Gam</code></td>
<td>
<p>observation input matrix; use <code>Gam = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_theta">Theta</code></td>
<td>
<p>state error pre-matrix
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_cq">cQ</code></td>
<td>
<p>Cholesky decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_s">S</code></td>
<td>
<p>covariance-type matrix of state and observation errors
</p>
</td></tr>
<tr><td><code id="xKfilter2_+3A_input">input</code></td>
<td>
<p>matrix or vector of inputs having the same row dimension as y; use <code>input = 0</code> if not needed
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Kfilter">Kfilter</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>innov</code></td>
<td>
<p>innovation series</p>
</td></tr>
<tr><td><code>sig</code></td>
<td>
<p>innovation covariances</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>last value of the gain, needed for smoothing</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xKsmooth0'>Kalman Filter and Smoother - This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</h2><span id='topic+xKsmooth0'></span>

<h3>Description</h3>

<p>Returns both the filtered values  and  smoothed values   for the state-space model.
NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>.  Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKsmooth0(num, y, A, mu0, Sigma0, Phi, cQ, cR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKsmooth0_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_a">A</code></td>
<td>
<p>time-invariant observation matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean vector
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-type decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKsmooth0_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xs</code></td>
<td>
<p>state smoothers</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>smoother mean square error</p>
</td></tr>
<tr><td><code>x0n</code></td>
<td>
<p>initial mean smoother</p>
</td></tr>
<tr><td><code>P0n</code></td>
<td>
<p>initial smoother covariance</p>
</td></tr>
<tr><td><code>J0</code></td>
<td>
<p>initial value of the J matrix</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>the J matrices</p>
</td></tr>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xKsmooth1'>Kalman Filter and Smoother - This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</h2><span id='topic+xKsmooth1'></span>

<h3>Description</h3>

<p>Returns both the filtered  and the smoothed values for the state-space model. NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>.  Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKsmooth1(num, y, A, mu0, Sigma0, Phi, Ups, Gam, cQ, cR, input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKsmooth1_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_a">A</code></td>
<td>
<p>time-varying observation matrix, an array with <code>dim=c(q,p,n)</code>
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_ups">Ups</code></td>
<td>
<p>state input matrix; use <code>Ups = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_gam">Gam</code></td>
<td>
<p>observation input matrix; use <code>Gam = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-type decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKsmooth1_+3A_input">input</code></td>
<td>
<p>matrix or vector of inputs having the same row dimension as y; use <code>input = 0</code> if not needed 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xs</code></td>
<td>
<p>state smoothers</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>smoother mean square error</p>
</td></tr>
<tr><td><code>x0n</code></td>
<td>
<p>initial mean smoother</p>
</td></tr>
<tr><td><code>P0n</code></td>
<td>
<p>initial smoother covariance</p>
</td></tr>
<tr><td><code>J0</code></td>
<td>
<p>initial value of the J matrix</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>the J matrices</p>
</td></tr>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xKsmooth2'>Kalman Filter and Smoother - This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</h2><span id='topic+xKsmooth2'></span>

<h3>Description</h3>

<p>Returns the filtered and smoothed values  for the state-space model. This is the smoother companion to Kfilter2. NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>.  Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xKsmooth2(num, y, A, mu0, Sigma0, Phi, Ups, Gam, Theta, cQ, cR, 
          S, input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xKsmooth2_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_y">y</code></td>
<td>
<p>data matrix, vector or time series
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_a">A</code></td>
<td>
<p>time-varying observation matrix, an array with <code>dim=c(q,p,n)</code>
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_mu0">mu0</code></td>
<td>
<p>initial state mean
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_sigma0">Sigma0</code></td>
<td>
<p>initial state covariance matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_phi">Phi</code></td>
<td>
<p>state transition matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_ups">Ups</code></td>
<td>
<p>state input matrix; use <code>Ups = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_gam">Gam</code></td>
<td>
<p>observation input matrix; use <code>Gam = 0</code> if not needed
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_theta">Theta</code></td>
<td>
<p>state error pre-matrix
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_cq">cQ</code></td>
<td>
<p>Cholesky-type decomposition of state error covariance matrix Q &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_cr">cR</code></td>
<td>
<p>Cholesky-type decomposition of observation error covariance matrix R &ndash; see details below
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_s">S</code></td>
<td>
<p>covariance matrix of state and observation errors
</p>
</td></tr>
<tr><td><code id="xKsmooth2_+3A_input">input</code></td>
<td>
<p>matrix or vector of inputs having the same row dimension as y; use <code>input = 0</code> if not needed
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+Ksmooth">Ksmooth</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xs</code></td>
<td>
<p>state smoothers</p>
</td></tr>
<tr><td><code>Ps</code></td>
<td>
<p>smoother mean square error</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>the J matrices</p>
</td></tr>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the state</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error</p>
</td></tr>
<tr><td><code>xf</code></td>
<td>
<p>filter value of the state</p>
</td></tr>
<tr><td><code>Pf</code></td>
<td>
<p>mean square filter error</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>last value of the gain</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

<hr>
<h2 id='xSVfilter'>Switching Filter (for Stochastic Volatility Models) - This script is now part of <code><a href="#topic+SV.mle">SV.mle</a></code>
</h2><span id='topic+xSVfilter'></span>

<h3>Description</h3>

<p>Performs a special case switching filter when the observational noise is a certain mixture of normals. Used to fit a stochastic volatility model.   NOTE: This script has been superseded by <code><a href="#topic+SV.mle">SV.mle</a></code>. Note that
scripts starting with an x are scheduled to be phased out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xSVfilter(num, y, phi0, phi1, sQ, alpha, sR0, mu1, sR1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xSVfilter_+3A_num">num</code></td>
<td>
<p>number of observations
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_y">y</code></td>
<td>
<p>time series of returns
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_phi0">phi0</code></td>
<td>
<p>state constant
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_phi1">phi1</code></td>
<td>
<p>state transition parameter
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_sq">sQ</code></td>
<td>
<p>state standard deviation
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_alpha">alpha</code></td>
<td>
<p>observation constant
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_sr0">sR0</code></td>
<td>
<p>observation error standard deviation for mixture component zero
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_mu1">mu1</code></td>
<td>
<p>observation error mean for mixture component one
</p>
</td></tr>
<tr><td><code id="xSVfilter_+3A_sr1">sR1</code></td>
<td>
<p>observation error standard deviation for mixture component one
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NOTE: This script has been superseded by <code><a href="#topic+SV.mle">SV.mle</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>xp</code></td>
<td>
<p>one-step-ahead prediction of the volatility</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>mean square prediction error of the volatility</p>
</td></tr>
<tr><td><code>like</code></td>
<td>
<p>the negative of the log likelihood at the given parameter values</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See <a href="https://github.com/nickpoison/tsa4/blob/master/textRcode.md#6.23">Example 6.23 in Chapter 6</a> of the text.
</p>


<h3>Author(s)</h3>

<p>D.S. Stoffer
</p>


<h3>References</h3>

<p>You can find demonstrations of  astsa capabilities at  
<a href="https://github.com/nickpoison/astsa/blob/master/fun_with_astsa/fun_with_astsa.md">FUN WITH ASTSA</a>.
</p>
<p>The most recent version of the package can be found  at <a href="https://github.com/nickpoison/astsa/">https://github.com/nickpoison/astsa/</a>.
</p>
<p>In addition, the News and ChangeLog files are at  <a href="https://github.com/nickpoison/astsa/blob/master/NEWS.md">https://github.com/nickpoison/astsa/blob/master/NEWS.md</a>.
</p>
<p>The webpages for the texts and some help on using R for time series analysis can be found at
<a href="https://nickpoison.github.io/">https://nickpoison.github.io/</a>.   
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
