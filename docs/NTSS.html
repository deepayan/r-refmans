<!DOCTYPE html><html lang="en"><head><title>Help for package NTSS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NTSS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CC.test'><p>Random shift test of independence in a bivariate random field</p></a></li>
<li><a href='#CWR.test'><p>Random shift test of independence between a point process and a covariate</p></a></li>
<li><a href='#PC.test'><p>Random shift test of independence between a point process and a covariate</p></a></li>
<li><a href='#PM.test'><p>Test of independence between marks and points of a stationary marked point process</p></a></li>
<li><a href='#PMC.test'><p>Random shift test of independence between marks of a point process and a covariate</p></a></li>
<li><a href='#PP.test'><p>Random shift test of independence in a bivariate point process</p></a></li>
<li><a href='#tau.est'><p>(Partial) correlation coefficient between a point process and a covariate</p></a></li>
<li><a href='#tau.test'><p>Random shift test of independence between a point process and a covariate</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Tests in Spatial Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Nonparametric test of independence between a pair of spatial objects
    (random fields, point processes) based on random shifts with torus or variance correction. See
    Mrkvička et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.spasta.2020.100430">doi:10.1016/j.spasta.2020.100430</a>&gt;,
    Dvořák et al. (2022) &lt;<a href="https://doi.org/10.1111%2Finsr.12503">doi:10.1111/insr.12503</a>&gt;,
    Dvořák and Mrkvička (2024) &lt;<a href="https://doi.org/10.1080%2F10618600.2024.2357626">doi:10.1080/10618600.2024.2357626</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, spatstat, spatstat.random, spatstat.geom,
spatstat.explore, spatstat.univar, spatstat.model, ks, GET,
geoR</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-10 10:05:16 UTC; dvorak</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiří Dvořák <a href="https://orcid.org/0000-0003-3290-8518"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Tomáš Mrkvička [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiří Dvořák &lt;dvorak@karlin.mff.cuni.cz&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-10 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CC.test'>Random shift test of independence in a bivariate random field</h2><span id='topic+CC.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between a pair of random fields based on random shifts.
Either the torus correction or the variance correction can be used, see Mrkvička et al. (2021).
The variance correction is recommended for random fields with nontrivial autocorrelations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CC.test(
  covariateA,
  covariateB,
  test.points,
  N.shifts = 999,
  radius,
  correction,
  type = "Kendall",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CC.test_+3A_covariatea">covariateA</code></td>
<td>
<p>first random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="CC.test_+3A_covariateb">covariateB</code></td>
<td>
<p>second random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="CC.test_+3A_test.points">test.points</code></td>
<td>
<p>point pattern providing the set of sampling points (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="CC.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="CC.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="CC.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="CC.test_+3A_type">type</code></td>
<td>
<p>which test statistic should be used (possible choices are &quot;Kendall&quot;, &quot;Pearson&quot; and &quot;covariance&quot;)</p>
</td></tr>
<tr><td><code id="CC.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic can be either the sample covariance or the sample Kendall's or
Pearson's correlation coefficient. The choice of the test statistic is given
by the argument <code>type</code>.
</p>
<p>The torus correction can be applied for rectangular windows. On the other hand,
the variance correction is applicable both for rectangular and for irregular windows.
The choice of the correction is given
by the argument <code>correction</code>. Based on the simulation studies in Mrkvička et al. (2021),
the variance correction is recommended for random fields with nontrivial autocorrelations.
</p>
<p>The two realizations of the random fields (defined on the same domain) to be tested
should be supplied in the <code>covariateA, covariateB</code> arguments
as objects of the class <code>im</code> as used in the <code>spatstat</code> package.
The pattern of sampling points in which the test statistic is evaluated
is given in the argument <code>test.points</code> as an object of the class <code>ppp</code>.
</p>
<p>The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin. The argument <code>verbose</code> determines if
auxiliary information and plots should be provided.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between a pair of random fields.
</p>


<h3>References</h3>

<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)

set.seed(123)

elevation &lt;- bei.extra$elev
slope &lt;- bei.extra$grad
plot(elevation)
plot(slope)

test.points &lt;- runifpoint(100, win=bei$window)

# tests run with only 99 shifts to speed up the computation
out1 &lt;- CC.test(covariateA=elevation, covariateB=slope, test.points=test.points, N.shifts=99,
                radius=250, type="Kendall", correction="torus", verbose=TRUE)
out1

out2 &lt;- CC.test(covariateA=elevation, covariateB=slope, test.points=test.points, N.shifts=99,
                radius=250, type="Kendall", correction="variance", verbose=TRUE)
out2

</code></pre>

<hr>
<h2 id='CWR.test'>Random shift test of independence between a point process and a covariate</h2><span id='topic+CWR.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between a point process and a random field
(covariate of interest), taking into account the possible effect of nuisance covariates,
see Dvořák and Mrkvička (2022).
The test is based on random shifts. Either the torus correction or the variance
correction can be used, see Mrkvička et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CWR.test(
  X,
  covariate.interest,
  covariates.nuisance,
  N.shifts = 999,
  radius,
  correction,
  type = "raw",
  nonparametric = TRUE,
  verbose = FALSE,
  bw.factor.rhonhat = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CWR.test_+3A_x">X</code></td>
<td>
<p>point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_covariate.interest">covariate.interest</code></td>
<td>
<p>random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_covariates.nuisance">covariates.nuisance</code></td>
<td>
<p>list of covariates (objects of class <code>im</code>) determining the nuisance covariates</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_type">type</code></td>
<td>
<p>which type of residuals should be used when computing the test statistic (possible choices are &quot;raw&quot;, &quot;Pearson&quot; and &quot;inverse&quot;)</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_nonparametric">nonparametric</code></td>
<td>
<p>logical value indicating whether nonparametric residuals should be used when computing the test statistic</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
<tr><td><code id="CWR.test_+3A_bw.factor.rhonhat">bw.factor.rhonhat</code></td>
<td>
<p>multiplicative factor used when determining the bandwidth in the nonparametric estimation of the intensity function depending on the nuisance covariates (defaults to 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is the covariate-weighted residual measure of the observation window, see the paper
Dvořák and Mrkvička (2022). If no nuisance covariates are given, the null model
assumes a constant intensity function of the point process. If one or more nuisance covariates are
provided, the null model assumes an intensity function depending on the nuisance
covariates (but not on the covariate of interest) and the residuals are constructed
using this intensity function.
</p>
<p>The residuals can be constructed in a nonparametric way (see Baddeley et al. (2012))
or in a parametric way (assuming a log-linear form of the intensity function
and using the <code>ppm</code> function from the <code>spatstat</code> package,
see Baddeley et al. (2015)). This choice is given by the argument <code>nonparametric</code>.
The nonparametric residuals are recommended if the log-linear form of the intensity function
is not clearly justified.
Also, different types of residuals can be considered (raw, Pearson or inverse,
see Baddeley et al. (2015)). This choice is given by the argument <code>type</code>.
</p>
<p>The torus correction can be applied for rectangular windows. On the other hand,
the variance correction is applicable both for rectangular and for irregular windows.
The choice of the correction is given by the argument <code>correction</code>.
Based on the simulation studies in Dvořák and Mrkvička (2022),
the torus and variance corrections perform almost equally well for the CWR test.
Hence, the torus correction is recommended for its smaller computational cost.
</p>
<p>The observed point pattern should be supplied using the argument <code>X</code>.
The realization of the covariate of interest should be supplied using
the argument <code>covariate.interest</code>. The set of nuisance covariates should
be supplied as a list using the argument <code>covariates.nuisance</code>. This list
can be empty if no nuisance covariates are considered.
</p>
<p>The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin. The argument <code>verbose</code> determines if
auxiliary information and plots should be provided.
</p>
<p>In case the observation window accompanying the point pattern is irregular,
it must be specified in the form of a binary mask due to the specific implementation of the test.
For details on binary masks see the help for the <code>spatstat</code> function <code>owin</code>.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between a point process and a covariate, taking into account possible effects of nuisance covariates.
</p>


<h3>References</h3>

<p>J. Dvořák, T. Mrkvička (2022): Nonparametric testing of the covariate significance for spatial point patterns under the presence of nuisance covariates. https://arxiv.org/abs/2210.05424
</p>
<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>
<p>A. Baddeley, E. Rubak, R. Turner (2015) Spatial Point Patterns: Methodology and Applications with R. Chapman &amp; Hall Interdisciplinary Statistics Series. CRC Press, Boca Raton, Florida.
</p>
<p>A. Baddeley, Y.-M. Chang, Y. Song, R. Turner (2012) Nonparametric estimation of the dependence of a point process on spatial covariates. Statistics and Its Interface 5(2), 221?236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)
library(ks)

# the point pattern
X &lt;- bei
plot(X)

# two covariates are available
elevation &lt;- bei.extra$elev
slope &lt;- bei.extra$grad
plot(elevation)
plot(slope)

# test with no nuisance covariates, with only 99 shifts to speed up the computation
out1 &lt;- CWR.test(X, covariate.interest=elevation, covariates.nuisance=NULL, N.shifts = 99,
                 verbose=TRUE, correction="torus", radius=250)
out1

# test with one nuisance covariate, with only 99 shifts to speed up the computation
out2 &lt;- CWR.test(X, covariate.interest=elevation, covariates.nuisance=list(slope=slope),
                 N.shifts = 99, verbose=TRUE, correction="torus", radius=250)
out2

</code></pre>

<hr>
<h2 id='PC.test'>Random shift test of independence between a point process and a covariate</h2><span id='topic+PC.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between a point process and a random field (covariate) based on random shifts, see Dvořák et al. (2022).
Either the torus correction or the variance correction can be used, see Mrkvička et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC.test(X, covariate, N.shifts = 999, radius, correction, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC.test_+3A_x">X</code></td>
<td>
<p>point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="PC.test_+3A_covariate">covariate</code></td>
<td>
<p>random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="PC.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="PC.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="PC.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="PC.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is the mean covariate value observed at the points of the process, see the paper
Dvořák et al. (2022).
</p>
<p>The torus correction can be applied for rectangular windows. On the other hand,
the variance correction is applicable both for rectangular and for irregular windows.
The choice of the correction is given by the argument <code>correction</code>.
Based on the simulation studies in Dvořák et al. (2022),
the variance correction is recommended since it does not exhibit the liberality of the torus correction.
</p>
<p>The observed point pattern should be supplied using the
argument <code>X</code>, the realization of the covariate should be supplied using
the argument <code>covariate</code>.
</p>
<p>The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin. The argument <code>verbose</code> determines if
auxiliary information and plots should be provided.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between a point process and a covariate.
</p>


<h3>References</h3>

<p>J. Dvořák, T. Mrkvička, J. Mateu, J.A. González (2022): Nonparametric testing of the dependence structure among points-marks-covariates in spatial point patterns. International Statistical Review 90(3), 592-621.
</p>
<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)

set.seed(123)

elevation &lt;- bei.extra$elev
plot(elevation)

# tests run with only 99 shifts to speed up the computation
out1 &lt;- PC.test(X=bei, covariate=elevation, N.shifts = 99, radius=250,
                correction="torus", verbose=TRUE)
out1

out2 &lt;- PC.test(X=bei, covariate=elevation, N.shifts = 99, radius=250,
                correction="variance", verbose=TRUE)
out2

</code></pre>

<hr>
<h2 id='PM.test'>Test of independence between marks and points of a stationary marked point process</h2><span id='topic+PM.test'></span>

<h3>Description</h3>

<p>Test of independence between marks and points of a stationary marked point process
based on the comparison of the mark K-function and the K-function of the underlying point process,
see Guan (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PM.test(X, R, R.variogram)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PM.test_+3A_x">X</code></td>
<td>
<p>marked point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="PM.test_+3A_r">R</code></td>
<td>
<p>positive real number determining the domain for the (marked) K-function used for computing the test statistic</p>
</td></tr>
<tr><td><code id="PM.test_+3A_r.variogram">R.variogram</code></td>
<td>
<p>positive real number determining the domain for variogram estimation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test was proposed in Guan (2006) and used in Dvořák et al. (2022) as one of the tools
to determine the dependence structure between points, marks and a covariate in a marked point process setting.
The marked point process is assumed to be stationary here.
</p>
<p>The observed marked point pattern should be supplied using the argument <code>X</code>.
The upper limit of the domain for the (marked) K-function used for constructing the test statistic
is given by the argument <code>R</code>. Furthermore, the variance used for constructing
the test statistic is determined using a fitted covariance model for the mark field.
In the given implementation, the exponential model for the covariance is assumed.
The model parameters are estimated by fitting the corresponding parametric model
to the empirical variogram by the least-squares approach, with the upper bound on
the variogram argument given by <code>R.variogram</code>.
</p>


<h3>Value</h3>

<p>The p-value of the test of independence between marks and points of a stationary marked point process.
</p>


<h3>References</h3>

<p>Y. Guan (2006): Tests for independence between marks and points of a marked point Process. Biometrics 62, 126-134.
</p>
<p>J. Dvořák, T. Mrkvička, J. Mateu, J.A. González (2022): Nonparametric testing of the dependence structure among points-marks-covariates in spatial point patterns. International Statistical Review 90(3), 592-621.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)
library(geoR)

set.seed(123)

X &lt;- rpoispp(100)
X &lt;- X %mark% runif(n=X$n)

out &lt;- PM.test(X, R=0.1, R.variog=1)
out

</code></pre>

<hr>
<h2 id='PMC.test'>Random shift test of independence between marks of a point process and a covariate</h2><span id='topic+PMC.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between marks of a point process and a random field
(covariate) based on random shifts, see Dvořák et al. (2022).
Either the torus correction or the variance correction can be used, see Mrkvička et al. (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PMC.test(
  X,
  covariate,
  N.shifts = 999,
  radius,
  correction,
  type = "Kendall",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PMC.test_+3A_x">X</code></td>
<td>
<p>marked point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_covariate">covariate</code></td>
<td>
<p>random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_type">type</code></td>
<td>
<p>... which test statistic should be used (possible choices are &quot;Kendall&quot;, &quot;Pearson&quot; and &quot;covariance&quot;)</p>
</td></tr>
<tr><td><code id="PMC.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic can be either the sample covariance or the sample Kendall's or
Pearson's correlation coefficient, computed from the vector of marks and
the vector of covariate values observed at the points of the process, see the paper
Dvořák et al. (2022). These test statistics make the test sensitive to violation
of independence between the marks and the covariate. On the other hand, the
test can also be viewed as a test of independence between a marked point process
and a covariate.
</p>
<p>The torus correction can be applied for rectangular windows. On the other hand,
the variance correction is applicable both for rectangular and for irregular windows.
The choice of the correction is given by the argument <code>correction</code>.
Based on the simulation studies in Dvořák et al. (2022),
the variance correction is recommended since it does not exhibit the liberality of the torus correction.
</p>
<p>The choice of the test statistic is given
by the argument <code>type</code>. The observed marked point pattern should be supplied using the
argument <code>X</code>, the realization of the covariate should be supplied using
the argument <code>covariate</code>.
</p>
<p>The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin. The argument <code>verbose</code> determines if
auxiliary information and plots should be provided.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between marks of a point process and a covariate.
</p>


<h3>References</h3>

<p>J. Dvořák, T. Mrkvička, J. Mateu, J.A. González (2022): Nonparametric testing of the dependence structure among points-marks-covariates in spatial point patterns. International Statistical Review 90(3), 592-621.
</p>
<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)

set.seed(123)

elevation &lt;- bei.extra$elev
slope &lt;- bei.extra$grad
plot(elevation)
plot(slope)

# use only part of the point pattern for this example
Xun &lt;- rthin(bei,0.05)

# use elevation values as marks
X &lt;- Xun %mark% elevation[Xun]

# use terrain gradient as covariate
covariate &lt;- slope

# tests run with only 99 shifts to speed up the computation
out1 &lt;- PMC.test(X=X, covariate=covariate, N.shifts = 99, radius=250, correction="torus",
                 type="Kendall", verbose=TRUE)
out1

out2 &lt;- PMC.test(X=X, covariate=covariate, N.shifts = 99, radius=250, correction="variance",
                 type="Kendall", verbose=TRUE)
out2

</code></pre>

<hr>
<h2 id='PP.test'>Random shift test of independence in a bivariate point process</h2><span id='topic+PP.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between a pair of point processes based on random shifts.
Either the torus correction or the variance correction can be used (note that the
variance correction is not yet implemented in this package but the corresponding source
codes can be obtained from the authors upon request).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PP.test(
  X,
  Y,
  N.shifts = 999,
  radius,
  correction,
  statistic,
  rmax.K = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PP.test_+3A_x">X</code></td>
<td>
<p>first point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="PP.test_+3A_y">Y</code></td>
<td>
<p>second point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="PP.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="PP.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="PP.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="PP.test_+3A_statistic">statistic</code></td>
<td>
<p>which test statistic should be used (possible choices are &quot;K12&quot; and &quot;ED12&quot;)</p>
</td></tr>
<tr><td><code id="PP.test_+3A_rmax.k">rmax.K</code></td>
<td>
<p>positive real number, for the cross K-function determines the maximum argument to be considered</p>
</td></tr>
<tr><td><code id="PP.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is either the cross K-function K12 or the expectation of the
cross nearest-neighbor distance ED12, see the paper Mrkvička et al. (2021). It is recommended to use the K12 statistic
for regular and Poisson processes, while it is recommended to use ED12 for cluster processes due to the potential
liberality of K12 in this case.
</p>
<p>The two observed point patterns to be tested should be supplied using the
arguments <code>X</code> and <code>Y</code>. The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin.
</p>
<p>The test statistic is determined by the argument <code>statistic</code>. For &quot;K12&quot;, the test statistic
is functional, the stationary cross K-function. The range of arguments is from 0 to <code>rmax.K</code> (there
is a sensible default). The outcome of the test is determined by the global envelope test in this case.
Alternatively, the <code>statistic</code> can be set to &quot;ED12&quot;, meaning that the test statistic is scalar,
the expectation of the cross nearest-neighbor distance. The outcome of the test is determined by the
classical univariate Monte Carlo test in this case.
</p>
<p>The argument <code>verbose</code> determines if auxiliary information and plots should be provided.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between a pair of point processes.
</p>


<h3>References</h3>

<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)
library(GET)

set.seed(123)

X &lt;- rpoispp(150)
Y &lt;- rpoispp(150)

# tests run with only 99 shifts to speed up the computation
out1 &lt;- PP.test(X=X, Y=Y, N.shifts = 99, radius=0.5, statistic="K12",
                correction="torus", verbose=TRUE)
out1
plot(out1$GET.outcome)

out2 &lt;- PP.test(X=X, Y=Y, N.shifts = 99, radius=0.5, statistic="ED12",
                correction="torus", verbose=TRUE)
out2

</code></pre>

<hr>
<h2 id='tau.est'>(Partial) correlation coefficient between a point process and a covariate</h2><span id='topic+tau.est'></span>

<h3>Description</h3>

<p>Correlation coefficient between a point process and a random field
(covariate of interest), taking into account the possible effect of nuisance covariates,
see Dvořák and Mrkvička (2022). The random shift test based on this test statistics
is given in the function <code>tau.test</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau.est(
  X,
  covariate.interest,
  covariates.nuisance,
  bws,
  n.test.points = 1000,
  nonparametric = TRUE,
  verbose = FALSE,
  bw.factor.rhonhat = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tau.est_+3A_x">X</code></td>
<td>
<p>point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="tau.est_+3A_covariate.interest">covariate.interest</code></td>
<td>
<p>random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="tau.est_+3A_covariates.nuisance">covariates.nuisance</code></td>
<td>
<p>list of covariates (objects of class <code>im</code>) determining the nuisance covariates</p>
</td></tr>
<tr><td><code id="tau.est_+3A_bws">bws</code></td>
<td>
<p>vector of positive real values from which the bandwidth is adaptively chosen if at least one nuisance covariate is present; if no nuisance covariates are present, the first value is used</p>
</td></tr>
<tr><td><code id="tau.est_+3A_n.test.points">n.test.points</code></td>
<td>
<p>the number of independent test points used in computing the test statistic value</p>
</td></tr>
<tr><td><code id="tau.est_+3A_nonparametric">nonparametric</code></td>
<td>
<p>logical value indicating whether nonparametric residuals should be used when computing the test statistic</p>
</td></tr>
<tr><td><code id="tau.est_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
<tr><td><code id="tau.est_+3A_bw.factor.rhonhat">bw.factor.rhonhat</code></td>
<td>
<p>multiplicative factor used when determining the bandwidth in the nonparametric estimation of the intensity function depending on the nuisance covariates (defaults to 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the Kendall's correlation coefficient between the covariate of interest
and the smoothed residual field, sampled at a given number of test points
scattered independently in the observation window, see the paper Dvořák and Mrkvička (2022).
If no nuisance covariates are given, a constant intensity function of the point process is assumed
when constructing the residuals. If one or more nuisance covariates are
provided, an intensity function depending on the nuisance
covariates (but not on the covariate of interest) is assumed and the residuals are constructed
using this intensity function.
</p>
<p>For constructing the smoothed residual field an adaptive bandwidth selection
method can be used, see Dvořák and Mrkvička (2022). A vector of candidate
bandwidth values can be provided using the argument <code>bws</code>.
</p>
<p>The residuals can be constructed in a nonparametric way (see Baddeley et al. (2012))
or in a parametric way (using the <code>ppm</code> function from the <code>spatstat</code> package,
see Baddeley et al. (2015)). This choice is given by the argument <code>nonparametric</code>.
The raw residuals are considered here.
</p>
<p>The observed point pattern should be supplied using the argument <code>X</code>.
The realization of the covariate of interest should be supplied using
the argument <code>covariate.interest</code>. The set of nuisance covariates should
be supplied as a list using the argument <code>covariates.nuisance</code>. This list
can be empty if no nuisance covariates are considered.
</p>


<h3>Value</h3>

<p>Value of the (partial) Kendall's correlation coefficient.
</p>


<h3>References</h3>

<p>J. Dvořák, T. Mrkvička (2022): Nonparametric testing of the covariate significance for spatial point patterns under the presence of nuisance covariates. https://arxiv.org/abs/2210.05424
</p>
<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>
<p>A. Baddeley, E. Rubak, R. Turner (2015) Spatial Point Patterns: Methodology and Applications with R. Chapman &amp; Hall Interdisciplinary Statistics Series. CRC Press, Boca Raton, Florida.
</p>
<p>A. Baddeley, Y.-M. Chang, Y. Song, R. Turner (2012) Nonparametric estimation of the dependence of a point process on spatial covariates. Statistics and Its Interface 5(2), 221?236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)
library(ks)

# the point pattern
X &lt;- bei
plot(X)

# two covariates are available
elevation &lt;- bei.extra$elev
slope &lt;- bei.extra$grad
plot(elevation)
plot(slope)

# candidate values for adaptive bandwidth selection
bws &lt;- seq(from=12.5, to=100, by=12.5)

# no nuisance covariates
out1 &lt;- tau.est(X, covariate.interest=elevation, covariates.nuisance=NULL,
                bws=bws, verbose=TRUE)
out1

# one nuisance covariate
out2 &lt;- tau.est(X, covariate.interest=elevation, covariates.nuisance=list(slope=slope),
                bws=bws, verbose=TRUE)
out2

</code></pre>

<hr>
<h2 id='tau.test'>Random shift test of independence between a point process and a covariate</h2><span id='topic+tau.test'></span>

<h3>Description</h3>

<p>Nonparametric test of independence between a point process and a random field
(covariate of interest), taking into account the possible effect of nuisance covariates,
see Dvořák and Mrkvička (2022).
The test is based on random shifts. Either the torus correction or the variance
correction can be used, see Mrkvička et al. (2021).
This test has lower power than the test based on the covariate-weighted residuals
(see the function <code>CWR.test</code>), but it is still included for the sake of completeness.
Also, the test statistic of <code>tau.test</code> can be used to quantify
the partial correlation between the point process and the covariate of interest, taking into
account the possible effect of nuisance covariates, see also the function <code>tau.est</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau.test(
  X,
  covariate.interest,
  covariates.nuisance,
  N.shifts = 999,
  radius,
  correction,
  bws,
  n.test.points = 1000,
  nonparametric = TRUE,
  verbose = FALSE,
  bw.factor.rhonhat = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tau.test_+3A_x">X</code></td>
<td>
<p>point pattern dataset (object of class <code>ppp</code>)</p>
</td></tr>
<tr><td><code id="tau.test_+3A_covariate.interest">covariate.interest</code></td>
<td>
<p>random field (object of class <code>im</code>)</p>
</td></tr>
<tr><td><code id="tau.test_+3A_covariates.nuisance">covariates.nuisance</code></td>
<td>
<p>list of covariates (objects of class <code>im</code>) determining the nuisance covariates</p>
</td></tr>
<tr><td><code id="tau.test_+3A_n.shifts">N.shifts</code></td>
<td>
<p>integer, how many random shifts should be performed in the random shift test</p>
</td></tr>
<tr><td><code id="tau.test_+3A_radius">radius</code></td>
<td>
<p>positive real number determining the radius of the disk on which the shift vectors are uniformly distributed</p>
</td></tr>
<tr><td><code id="tau.test_+3A_correction">correction</code></td>
<td>
<p>which correction should be applied in the random shift test (possible choices are &quot;torus&quot; and &quot;variance&quot;)</p>
</td></tr>
<tr><td><code id="tau.test_+3A_bws">bws</code></td>
<td>
<p>vector of positive real values from which the bandwidth is adaptively chosen if at least one nuisance covariate is present; if no nuisance covariates are present, the first value is used</p>
</td></tr>
<tr><td><code id="tau.test_+3A_n.test.points">n.test.points</code></td>
<td>
<p>the number of independent test points used in computing the test statistic value</p>
</td></tr>
<tr><td><code id="tau.test_+3A_nonparametric">nonparametric</code></td>
<td>
<p>logical value indicating whether nonparametric residuals should be used when computing the test statistic</p>
</td></tr>
<tr><td><code id="tau.test_+3A_verbose">verbose</code></td>
<td>
<p>logical value indicating whether auxiliary information should be printed and auxiliary figures plotted during the computation</p>
</td></tr>
<tr><td><code id="tau.test_+3A_bw.factor.rhonhat">bw.factor.rhonhat</code></td>
<td>
<p>multiplicative factor used when determining the bandwidth in the nonparametric estimation of the intensity function depending on the nuisance covariates (defaults to 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test statistic is the Kendall's correlation coefficient between the covariate of interest
and the smoothed residual field, sampled at a given number of test points
scattered independently in the observation window, see the paper Dvořák and Mrkvička (2022).
If no nuisance covariates are given, the null model
assumes a constant intensity function of the point process. If one or more nuisance covariates are
provided, the null model assumes an intensity function depending on the nuisance
covariates (but not on the covariate of interest) and the residuals are constructed
using this intensity function.
</p>
<p>For constructing the smoothed residual field an adaptive bandwidth selection
method can be used, see Dvořák and Mrkvička (2022). A vector of candidate
bandwidth values can be provided using the argument <code>bws</code>.
</p>
<p>The residuals can be constructed in a nonparametric way (see Baddeley et al. (2012))
or in a parametric way (using the <code>ppm</code> function from the <code>spatstat</code> package,
see Baddeley et al. (2015)). This choice is given by the argument <code>nonparametric</code>.
The raw residuals are considered here.
</p>
<p>The torus correction can be applied for rectangular windows. On the other hand,
the variance correction is applicable both for rectangular and for irregular windows.
The choice of the correction is given by the argument <code>correction</code>.
Based on the simulation studies in Dvořák and Mrkvička (2022),
the variance correction is recommended since it does not exhibit the liberality of the torus correction.
</p>
<p>The observed point pattern should be supplied using the argument <code>X</code>.
The realization of the covariate of interest should be supplied using
the argument <code>covariate.interest</code>. The set of nuisance covariates should
be supplied as a list using the argument <code>covariates.nuisance</code>. This list
can be empty if no nuisance covariates are considered.
</p>
<p>The shift vectors are generated from the
uniform distribution on the disk with radius given by the argument <code>radius</code>
and centered in the origin. The argument <code>verbose</code> determines if
auxiliary information and plots should be provided.
</p>
<p>In case the observation window accompanying the point pattern is irregular,
it must be specified in the form of a binary mask due to the specific implementation of the test.
For details on binary masks see the help for the <code>spatstat</code> function <code>owin</code>.
</p>


<h3>Value</h3>

<p>The p-value of the random shift test of independence between a point process and a covariate, taking into account possible effects of nuisance covariates.
</p>


<h3>References</h3>

<p>J. Dvořák, T. Mrkvička (2022): Nonparametric testing of the covariate significance for spatial point patterns under the presence of nuisance covariates. https://arxiv.org/abs/2210.05424
</p>
<p>T. Mrkvička, J. Dvořák, J.A. González, J. Mateu (2021): Revisiting the random shift approach for testing in spatial statistics. Spatial Statistics 42, 100430.
</p>
<p>A. Baddeley, E. Rubak, R. Turner (2015) Spatial Point Patterns: Methodology and Applications with R. Chapman &amp; Hall Interdisciplinary Statistics Series. CRC Press, Boca Raton, Florida.
</p>
<p>A. Baddeley, Y.-M. Chang, Y. Song, R. Turner (2012) Nonparametric estimation of the dependence of a point process on spatial covariates. Statistics and Its Interface 5(2), 221?236.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(spatstat)
library(ks)

# the point pattern
X &lt;- bei
plot(X)

# two covariates are available
elevation &lt;- bei.extra$elev
slope &lt;- bei.extra$grad
plot(elevation)
plot(slope)

# candidate values for adaptive bandwidth selection
bws &lt;- seq(from=12.5, to=100, by=12.5)

# test with no nuisance covariates, with only 99 shifts to speed up the computation
out1 &lt;- tau.test(X, covariate.interest=elevation, covariates.nuisance=NULL,
                 bws=bws, N.shifts = 99, verbose=TRUE, correction="torus", radius=250)
out1

# test with one nuisance covariate, with only 99 shifts to speed up the computation
out2 &lt;- tau.test(X, covariate.interest=elevation, covariates.nuisance=list(slope=slope),
                 bws=bws, N.shifts = 99, verbose=TRUE, correction="torus", radius=250)
out2

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
