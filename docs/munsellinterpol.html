<!DOCTYPE html><html><head><title>Help for package munsellinterpol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {munsellinterpol}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CentroidsISCCNBS'><p>Centroid Notations for the Revised ISCC-NBS Color-Name Blocks</p></a></li>
<li><a href='#ColorBlockFromMunsell'><p>Get ISCC-NBS Number and ISCC-NBS Name from Munsell HVC or Munsell Notation</p></a></li>
<li><a href='#ColorlabFormatToMunsellSpec'><p>Convert Colorlab Munsell Format to Munsell HVC</p></a></li>
<li><a href='#HVCfromMunsellName'><p>Convert Munsell Notation to numerical Munsell HVC</p></a></li>
<li><a href='#IsWithinMacAdamLimits'>
<p>Test xyY Coordinates for being Inside the MacAdam Limits</p></a></li>
<li><a href='#LabToMunsell'><p>Convert CIE Lab coordinates to Munsell HVC</p></a></li>
<li><a href='#LuvToMunsell'><p>Convert CIE Luv coordinates to Munsell HVC</p></a></li>
<li><a href='#Munsell2xy'><p>The Munsell HVC to xy 3D Lookup Table</p></a></li>
<li><a href='#MunsellNameFromHVC'>
<p>Convert Munsell Numeric to Munsell String Notation</p></a></li>
<li><a href='#MunsellSpecToColorlabFormat'>
<p>Convert Munsell Specification to Colorlab Format</p></a></li>
<li><a href='#MunsellToLab'><p>Convert a Munsell specification to CIE Lab coordinates</p></a></li>
<li><a href='#MunsellToLuv'><p>Convert a Munsell specification to CIE Luv coordinates</p></a></li>
<li><a href='#MunsellToRGB'><p>Convert a Munsell specification to RGB coordinates</p></a></li>
<li><a href='#MunsellTosRGB'><p>Convert a Munsell specification to sRGB coordinates</p></a></li>
<li><a href='#MunsellToxyY'><p>Convert Munsell HVC to xyY coordinates</p></a></li>
<li><a href='#MunsellToXYZ'><p>Convert a Munsell specification to CIE XYZ coordinates</p></a></li>
<li><a href='#NickersonColorDifference'><p>Calculate the Nickerson Color Difference between two Colors</p></a></li>
<li><a href='#plotLociHC'><p>Plot Curves of Constant Munsell Hue and Chroma</p></a></li>
<li><a href='#plotPatchesH'><p>Plot Colored Patches for a fixed Munsell Hue</p></a></li>
<li><a href='#RGBtoMunsell'><p>Convert RGB coordinates to Munsell HVC</p></a></li>
<li><a href='#sRGBtoMunsell'><p>Convert sRGB coordinates to Munsell HVC</p></a></li>
<li><a href='#VandY'><p>Convert Munsell Value V to Luminance Factor Y, and back again</p></a></li>
<li><a href='#xyYtoMunsell'><p>Convert xyY coordinates to Munsell HVC</p></a></li>
<li><a href='#XYZtoMunsell'><p>Convert XYZ coordinates to Munsell HVC</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interpolate Munsell Renotation Data from Hue/Chroma to CIE/RGB</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0-0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-08</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods for interpolating data in the Munsell color system following the ASTM D-1535 standard. Hues and chromas with decimal values can be interpolated and converted to/from the Munsell color system and CIE xyY, CIE XYZ, CIE Lab, CIE Luv, or RGB.  Includes ISCC-NBS color block lookup.  Based on the work by Paul Centore, "The Munsell and Kubelka-Munk Toolbox".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rootSolve, spacesRGB, spacesXYZ</td>
</tr>
<tr>
<td>Suggests:</td>
<td>microbenchmark, mgcv, knitr, rmarkdown, flextable</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose Gama [aut, trl],
  Paul Centore [aut, cph],
  Glenn Davis [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Glenn Davis &lt;gdavis@gluonics.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-07 14:54:55 UTC; Glenn</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-08 02:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CentroidsISCCNBS'>Centroid Notations for the Revised ISCC-NBS Color-Name Blocks</h2><span id='topic+CentroidsISCCNBS'></span>

<h3>Description</h3>

<p><code>CentroidsISCCNBS</code> is a table with the centroids
of the revised ISCC-NBS Color-Name Blocks, taken from <em>Kelly (1958)</em></p>


<h3>Format</h3>

<p>This <code>data.frame</code> has 267 rows and these columns:
</p>

<dl>
<dt>Number</dt><dd><p>ISCC-NBS number (an integer from 1 to 267)</p>
</dd>
<dt>Name</dt><dd><p>ISCC-NBS name</p>
</dd>
<dt>MunsellSpec</dt><dd><p>Munsell specification of the centroid of the block a (character string)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The earliest paper I am aware of is by <em>Nickerson, et. al.</em> in 1941.
After the big Munsell renotation in 1943, the name blocks were revised in 1955.
<br />
When the central colors were recomputed in
<em>Kelly (1958)</em>, they were called the &quot;Central Colors&quot;,
though the text makes it clear that most are truly centroids,
which were computed from the centroid of an &quot;elementary shape&quot;,
which is a &quot;sector of a right cylindrical annulus&quot;.
For the &quot;peripheral blocks&quot; of high chroma, the centroids were
&quot;estimated graphically by plotting the MacAdam limits&quot;.
<br />
In <em>Kelly (1965)</em> these were called &quot;centroid colors&quot;,
and that is the name we will use here.
</p>


<h3>Contributor</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>Nickerson, Dorothy and Sidney M. Newhall.
<b>Central Notations for ISCC-NBS Color names</b>.
J Opt. Soc. Am.
Vol 31  Iss. 9.
pp. 597-591.
1941.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Kelly, Kenneth L. and 
Deane B. Judd
<b>The ISCC-NBS Method of Designating Colors and a Dictionary of Color Names</b>.
National Bureau of Standards Circular 553.
Washington DC: US Government Printing Office.
November 1, 1955.
</p>
<p>Kelly, Kenneth Low.
<b>Central Notations for the Revised ISCC-NBS Color-Name Blocks</b>.
Journal of Research of the National Bureau of Standards.
Research Paper 2911.
Vol. 61  No. 5.
pp. 427-431.
November 1958.
</p>
<p>Kelly, Kenneth Low.
<b>A Universal Color Language</b>.
Color Engineering.
Vol. 3  No. 2.
pp. 2-7.
March-April, 1965.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print( CentroidsISCCNBS[ 1:5, ] )

##    Number          Name   MunsellSpec
##  1      1    vivid pink     1.5R 7/13
##  2      2   strong pink  1.5R 7.5/9.1
##  3      3     deep pink 1.9R 6.0/11.1
##  4      4    light pink  2.5R 8.6/5.2
##  5      5 moderate pink  2.5R 7.2/5.2
</code></pre>

<hr>
<h2 id='ColorBlockFromMunsell'>Get ISCC-NBS Number and ISCC-NBS Name from Munsell HVC or Munsell Notation</h2><span id='topic+ColorBlockFromMunsell'></span>

<h3>Description</h3>

<p>Get ISCC-NBS Number and ISCC-NBS Name from Munsell HVC or Munsell Notation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ColorBlockFromMunsell( MunsellSpec ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ColorBlockFromMunsell_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix or a vector that can be converted to
such a matrix.
Each row has Munsell HVC, where H is Hue Number,
and V and C are the standard Munsell Value and Chroma.
The Hue is automatically wrapped to the interval (0,100].
<code>MunsellSpec</code> can also be a character N-vector with standard Munsell notation; it is converted to an Nx3 matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ISCC-NBS System is a partition of Munsell Color Solid into 267 color blocks.
Each block is a disjoint union of <em>elementary blocks</em>,
where an elementary block is defined
by its minimum and maximum limits in Hue, Value, and Chroma.
Some blocks are non-convex.
The <em>peripheral blocks</em>, of which there are 120,
have arbitrary large chroma and are considered semi-infinite for this function;
there is no consideration of the MacAdam limits.
For each query vector HVC,
the function searches a private <code>data.frame</code> with 932 elementary blocks,
for the one elementary block that contains it.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with N rows and these columns:
</p>
<table>
<tr><td><code>HVC</code></td>
<td>
<p>the input Nx3 matrix, or such a matrix converted from Munsell notation</p>
</td></tr>
<tr><td><code>Number</code></td>
<td>
<p>the corresponding ISCC-NBS color number - an integer from 1 to 267</p>
</td></tr>
<tr><td><code>Name</code></td>
<td>
<p>the corresponding ISCC-NBS color name - a character string</p>
</td></tr>
<tr><td><code>Centroid</code></td>
<td>
<p>the centroid of the block in Munsell Notation - a character string; see <code><a href="#topic+CentroidsISCCNBS">CentroidsISCCNBS</a></code></p>
</td></tr>
</table>
<p>The <code>rownames</code> are set to the input <code>MunsellSpec</code>.
</p>


<h3>History</h3>

<p>The <b>Munsell Book of Color</b> was published in 1929.
The first ISCC-NBS partition, in 1939, had 319 blocks and names (including 5 neutrals).
There were no block numbers.
The aimpoints of the Munsell samples were thoroughly revised in 1943.
The ISCC-NBS partition was revised in 1955,
and this is the version used here.
</p>


<h3>Future Work</h3>

<p>It might be useful to compute the distance from the query point
to the boundary of the containing color block.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>Munsell Color Company, A.H. Munsell, and A.E.O. Munsell.
<b>Munsell book of color: defining, explaining, and illustrating the fundamental characteristics of color</b>.
1929.
</p>
<p>Judd, Deane B. and 
Kenneth L. Kelly.
<b>Method of Designating Colors</b>.
Journal of Research of the National Bureau of Standards.
Research Paper 1239.
Volume 23  Issue 3.
pp. 355-385.
September 1939.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Kelly, Kenneth L. and 
Deane B. Judd
<b>The ISCC-NBS Method of Designating Colors and a Dictionary of Color Names</b>.
National Bureau of Standards Circular 553.
Washington DC: US Government Printing Office.
November 1, 1955.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CentroidsISCCNBS">CentroidsISCCNBS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ColorBlockFromMunsell( c( "3R 8/3", "7.4YR 3/4" ) )

##            HVC.H HVC.V HVC.C Number           Name      Centroid
##  3R 8/3      3.0   8.0   3.0      4     light pink  2.5R 8.6/5.2
##  7.4YR 3/4  17.4   3.0   4.0     58 moderate brown 5.5YR 3.5/3.9
</code></pre>

<hr>
<h2 id='ColorlabFormatToMunsellSpec'>Convert Colorlab Munsell Format to Munsell HVC</h2><span id='topic+ColorlabFormatToMunsellSpec'></span>

<h3>Description</h3>

<p>Convert Colorlab Munsell Format to Munsell HVC</p>


<h3>Usage</h3>

<pre><code class='language-R'>ColorlabFormatToMunsellSpec( HVCH )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ColorlabFormatToMunsellSpec_+3A_hvch">HVCH</code></td>
<td>

<p>a numeric Nx4 matrix, or a vector that can be converted to such a matrix, by row.
Each row of the matrix contains an HVCH vector.<br />
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Colorlab Munsell format uses 4 numbers.
</p>

<ol>
<li><p> Hue Step, in the interval (0,10], or 0 for neutrals
</p>
</li>
<li><p> Munsell Value, in the interval (0,10]
</p>
</li>
<li><p> Munsell Chroma, non-negative
</p>
</li>
<li><p> Hue Index, an integer from 1 to 10, or 0 for neutrals
</p>
</li></ol>



<h3>Value</h3>

<p>an Nx3 matrix, with each row an HVC vector.
Value and Chroma are simply copied unchanged.
The complex part is conversion of Colorlab Hue Step and Hue Index
to Hue Number.
For neutrals, both Hue Step and Hue Index are ignored.
Invalid input values, such as a Hue Index that is not
an integer from 0 to 10 (except for neutrals), are converted to <code>NA</code>s.
The rownames of the input are copied to the output,
but if these are <code>NULL</code>, the rownames are set to the Munsell notations.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis
</p>


<h3>References</h3>

<p>Color Processing Toolbox.      
Colorlab 1.0.
<a href="https://www.uv.es/vista/vistavalencia/software/colorlab.html">https://www.uv.es/vista/vistavalencia/software/colorlab.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellSpecToColorlabFormat">MunsellSpecToColorlabFormat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ColorlabFormatToMunsellSpec( c( 3.2,3,2,1,  2,5.1,0,0, 2,5.1,0.1,0 ) )
##                     H   V  C
##  3.20B 3.00/2.00 63.2 3.0  2
##  N 5.10/          0.0 5.1  0
##  &lt;NA&gt;              NA  NA NA
</code></pre>

<hr>
<h2 id='HVCfromMunsellName'>Convert Munsell Notation to numerical Munsell HVC</h2><span id='topic+HVCfromMunsellName'></span><span id='topic+MunsellHVC'></span><span id='topic+HueNumberFromString'></span>

<h3>Description</h3>

<p>Convert Munsell Notation to numerical Munsell HVC</p>


<h3>Usage</h3>

<pre><code class='language-R'>HVCfromMunsellName( MunsellName )
MunsellHVC( MunsellName )
HueNumberFromString( HueString )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HVCfromMunsellName_+3A_munsellname">MunsellName</code></td>
<td>

<p>a character vector of length N &gt; 0,
where each string should be a valid Munsell notation, e.g.
<code>'2.3P 5/2.3',  '9.2YR 3/6',  'N 2.3/'</code>, and <code>'N 4/0'</code>. 
Whitespace is optional and ignored.
It is OK for a neutral to end in either <code>'/'</code> or <code>'/0'</code>.</p>
</td></tr>
<tr><td><code id="HVCfromMunsellName_+3A_huestring">HueString</code></td>
<td>

<p>a character vector of length N &gt; 0,
where each string should be the initial hue part of a Munsell notation,
e.g. '4.5GY', '2.5R', '10.3B', etc.
Whitespace is optional and ignored.
Neutrals, denoted by <code>'N'</code>, are invalid because the hue is undefined.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>HVCfromMunsellName()</code>
returns a numeric Nx3 matrix with HVC in the rows.
For neutral colors, both H and C are set to 0.
If a string cannot be parsed, the entire row is set to <code>NA</code>s.
The rownames are set to <code>MunsellName</code>.
<br />
<code>MunsellHVC()</code>
returns a character Nx3 matrix with HVC in the rows,
and is there for backward compatibility with older versions of the package.
For neutral colors, H is set to <code>'N'</code> and C is set to <code>'0'</code>.
<br />
<code>HueNumberFromString()</code> returns the hue number H (in (0,100]).
If the string cannot be parsed, or the color is neutral, the output is set to <code>NA</code>.
<br />
For all functions the Hue Number is wrapped to (0,100].
</p>


<h3>Note</h3>

<p>Ever since the <em>Munsell Book of Color (1929)</em>,
the Munsell hue circle has been divided into 10 <em>principal hues</em> or arcs.
And each principal hue has been assigned a 10-point scale,
with 5 at the midpoint of the arc.
Moreover, the hue &quot;origin&quot; has been at '10RP'.
So a 100-point scale (with no letters) for the entire hue circle is obvious and trivial
to construct,
but I have been unable to determine the first explicit mention of such a scale.
The earliest I have have found is from <em>Nimeroff (1968)</em>,
Figures 20 and 21 on page 27.
</p>
<div style="text-align: center">
<p><img src="../help/figures/hue-circle.jpg" alt="Hue Circle" />
</p>
</div>

<p>There is a reference to <em>ASTM D 1535</em> in the <b>References</b> of <em>Nimeroff</em>,
but it is not dated, and the 2 figures are not attributed to it.
There was an <em>ASTM D 1535</em> in 1968 but I have not been able to locate it;
it is possible that the 100-point scale first appeared in <em>ASTM D-1535 (1968)</em>,
or even earlier in <em>ASTM D 1525-58T (1958)</em>.
<br />
Interestingly, in the <em>Atlas of the Munsell Color System (1915)</em> there were only
5 principal hues, and each arc was assigned a 10-point scale.
If the entire hue circle of 1915 were assigned a scale, it would have been a 50-point scale.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis
</p>


<h3>References</h3>

<p>Nimeroff, I.
<b>Colorimetry</b>.
National Bureau of Standards Monograph 104.
January 1968. 35 cents.
</p>
<p>ASTM D 1535-80.
Standard Practice for Specifying Color by the Munsell System.
1980.
</p>
<p>Munsell Book of Color: defining, explaining, and illustrating the fundamental characteristics of color.
Munsell Color Co.
1929.
</p>
<p>Atlas of the Munsell Color System.
Malden, Mass., Wadsworth, Howland &amp; Co., inc., Printers.
1915.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellNameFromHVC">MunsellNameFromHVC</a>()</code>,
<code><a href="#topic+HueStringFromNumber">HueStringFromNumber</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>HVCfromMunsellName( c( "4.2P 2.9/3.8", "N 2.3/", "N 8.9/0" ) )
##                  H   V   C
##  4.2P 2.9/3.8 84.2 2.9 3.8
##  N 2.3/        0.0 2.3 0.0
##  N 8.9/0       0.0 8.9 0.0

HueNumberFromString( c('4B','4.6GY','10RP','N') )
##  [1]  64.0  34.6 100.0    NA
</code></pre>

<hr>
<h2 id='IsWithinMacAdamLimits'>
Test xyY Coordinates for being Inside the MacAdam Limits
</h2><span id='topic+IsWithinMacAdamLimits'></span>

<h3>Description</h3>

<p>Test xyY Coordinates for being Inside the MacAdam Limits for Illuminants C and D65
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IsWithinMacAdamLimits( xyY, Illuminant='C' )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IsWithinMacAdamLimits_+3A_xyy">xyY</code></td>
<td>
<p>a numeric Nx3 matrix with CIE xyY coordinates in the rows,
or a vector that can be converted to such a matrix, by row. 
The reference white is asssumed to have Y=100.</p>
</td></tr>
<tr><td><code id="IsWithinMacAdamLimits_+3A_illuminant">Illuminant</code></td>
<td>
<p>either <code>'C'</code> or <code>'D65'</code>. Partial matching is enabled, and is case-insensitive.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <em>MacAdam Limit</em> is the boundary of the
<em>optimal color solid</em> (also called the <em>Rösch Farbkörper</em>),
in XYZ coordinates.
The optimal color solid is convex and depends on the illuminant.
Points on the boundary of the solid are called <em>optimal colors</em>.
It is symmetric about the midpoint of the segment joining black and white
(the 50% gray point).
It can be expressed as a <em>zonohedron</em> - a convex polyhedron with a special form;
for details on zonohedra, see <cite>Centore</cite>.
</p>
<p>For each of the 2 illuminants, a zonohedron <code class="reqn">Z</code> is pre-computed
(and stored in <code>sysdata.rda</code>).
The wavelengths used are 380 to 780 nm with 5nm step (81 wavelengths).
Each zonohedron has 81*80=6480 parallelogram faces, though some of them are coplanar.
<code class="reqn">Z</code> is expressed as the intersection of 6480 halfspaces.
The plane equation of each parallelogram is pre-computed,
but redundant ones are not removed (in this version).
</p>
<p>For testing a query point xyY, a pseudo-distance metric <code class="reqn">\delta</code> is used.
Let the zonohedron <code class="reqn">Z</code> be the intersection of the halfspaces
  &langle;  <code class="reqn">h_i,x</code>   &rangle;  <code class="reqn">\le b_i ~~ i=1,...,n</code>, 
where each <code class="reqn">h_i</code> is a unit vector.
The point xyY is converted to XYZ, and <code class="reqn">\delta</code>(XYZ) is computed as:
<code class="reqn">\delta</code>(XYZ) := max(   &langle;  <code class="reqn">h_i</code>,XYZ   &rangle;  - <code class="reqn">b_i</code> )
where the maximum is taken over all <code class="reqn">i=1,...,n</code>.
This calculation can be optimized;
because the zonohedron is centrally symmetric, only half of the planes actually have to be stored,
and this cuts the memory and processing time in half.
It is clear that XYZ is within the zonohedron iff <code class="reqn">\delta</code>(XYZ) <code class="reqn">\le</code> 0,
and that XYZ is on the boundary iff <code class="reqn">\delta</code>(XYZ)=0.
This pseudo-distance is part of the returned <code>data.frame</code>.
</p>
<p>An interesting fact is that if <code class="reqn">\delta</code>(XYZ)&gt;0,
then <code class="reqn">\delta</code>(XYZ) <code class="reqn">\le</code> dist(XYZ,<code class="reqn">Z</code>),
with equality iff the segment from <code class="reqn">XYZ</code> to the
point <code class="reqn">z</code> on the boundary of <code class="reqn">Z</code> closest to XYZ is
normal to one of the faces of <code class="reqn">Z</code> that contains <code class="reqn">z</code>.
This is why we call <code class="reqn">\delta</code> a <em>pseudo-distance</em>.
Another interesting fact is that if <code class="reqn">\delta</code>(XYZ) <code class="reqn">\le</code> 0,
then <code class="reqn">\delta</code>(XYZ) = -min( <code class="reqn">\Psi_Z(u)</code> -   &langle;  <code class="reqn">u</code>,XYZ   &rangle;  ),
where the minimum is taken over all unit vectors <code class="reqn">u</code> and
where <code class="reqn">\Psi_Z</code> is the <em>support function</em> of <code class="reqn">Z</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with N rows and these columns:
</p>
<table>
<tr><td><code>within</code></td>
<td>
<p>a logical which is <code>TRUE</code> iff the corresponding row in <code>xyY</code>
is inside the optimal color solid for the illuminant.
If a point is exactly on the boundary (unlikely), <code>within=TRUE</code>.
Explicitly, <code>within = (delta&lt;=0)</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>the pseudo-distance <code class="reqn">\delta</code> discussed in <b>Details</b></p>
</td></tr>
</table>
<p>The row names of the output value are set equal to the row names of <code>xyY</code>.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis and Jose Gama
</p>


<h3>References</h3>

<p>Centore, Paul.
<em>A zonohedral approach to optimal colours</em>.
<b>Color Research &amp; Application</b>.
Vol. 38.
No. 2.
pp. 110-119.
April 2013.
</p>
<p>Rösch, S.
<b>Darstellung der Farbenlehre für die Zwecke des Mineralogen</b>.
Fortschr. Mineral. Krist. Petrogr.
Vol. 13 No. 143.
1929.
</p>
<p>MacAdam, David L.
<b>Maximum Visual Efficiency of Colored Materials</b>.
Journal of the Optical Society of America.
Vol 25, No. 11.
pp. 361-367.
November 1935.
</p>
<p>Wikipedia.
<b>Support Function</b>.
<a href="https://en.wikipedia.org/wiki/Support_function">https://en.wikipedia.org/wiki/Support_function</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>IsWithinMacAdamLimits( c(0.6,0.3,10, 0.6,0.3,20, 0.6,0.3,30, 0.6,0.3,40  ), 'C' )

##    within  delta
##  1   TRUE -1.941841
##  2   TRUE -1.332442
##  3  FALSE  3.513491
##  4  FALSE 12.826172
</code></pre>

<hr>
<h2 id='LabToMunsell'>Convert CIE Lab coordinates to Munsell HVC</h2><span id='topic+LabToMunsell'></span><span id='topic+LabtoMunsell'></span>

<h3>Description</h3>

<p><code>LabToMunsell</code> Converts CIE Lab coordinates to Munsell HVC,
by interpolating over the extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LabToMunsell( Lab, white='D65', adapt='Bradford', ... )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LabToMunsell_+3A_lab">Lab</code></td>
<td>
<p>CIE Lab coordinates.  An Nx3 matrix, or a vector that can be converted to such a matrix. Each row of the matrix has Lab.</p>
</td></tr>
<tr><td><code id="LabToMunsell_+3A_white">white</code></td>
<td>
<p>XYZ for the source white - a numeric 3-vector with scaling irrelevant.
<code>white</code> can also be a numeric 2-vector; which is interpreted as xy chromaticity and converted to XYZ with Y=100.
<code>white</code> can also be the name of any standard illuminant recognized by
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code> which is scaled so that Y=100.
The default <code>'D65'</code> is converted to <code>c(95.047,100,108.883)</code>. </p>
</td></tr>
<tr><td><code id="LabToMunsell_+3A_adapt">adapt</code></td>
<td>
<p>method for chromatic adaptation, see <code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code> for valid values.
Also see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="LabToMunsell_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps.
</p>

<ul>
<li><p> Lab    &rarr;   XYZ using <code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromLab</a>()</code> with the given <code>white</code>.
</p>
</li>
<li><p> XYZ is then adapted from the given <code>white</code> to Illuminant C using the given <code>adapt</code> method.
</p>
</li>
<li><p> XYZ   &rarr;   HVC using <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>An Nx3 matrix with the Munsell HVC coordinates in each row.
The rownames are set to those of Lab.
</p>


<h3>Note</h3>

<p>The case of the letter 't' in the function name was recently changed from lower to upper.
The function <code>LabtoMunsell()</code> is equivalent but deprecated and provided for a limited time.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToLab">MunsellToLab</a>()</code>,
<code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>,
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>,
<code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromLab</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LabToMunsell( c(74.613450, -20.4, 10.1,    80, 0, 0) )
##                      H        V       C
##  3.1G 7.4/3.6 43.13641 7.379685 3.62976
##  N 7.9/        0.00000 7.945314 0.00000
</code></pre>

<hr>
<h2 id='LuvToMunsell'>Convert CIE Luv coordinates to Munsell HVC</h2><span id='topic+LuvToMunsell'></span><span id='topic+LuvtoMunsell'></span>

<h3>Description</h3>

<p><code>LuvToMunsell</code> Converts CIE Luv coordinates to Munsell HVC,
by interpolating over the extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LuvToMunsell( Luv, white='D65', adapt='Bradford', ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LuvToMunsell_+3A_luv">Luv</code></td>
<td>
<p>CIE Luv coordinates An Nx3 matrix, or a vector that can be converted to such a matrix. Each row of the matrix has Luv.</p>
</td></tr>
<tr><td><code id="LuvToMunsell_+3A_white">white</code></td>
<td>
<p>XYZ for the source white - a numeric 3-vector with scaling irrelevant.
<code>white</code> can also be a numeric 2-vector; which is interpreted as xy chromaticity and converted to XYZ with Y=100.
<code>white</code> can also be the name of any standard illuminant recognized by
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code> which is scaled so that Y=100.
The default <code>'D65'</code> is converted to <code>c(95.047,100,108.883)</code>. </p>
</td></tr>
<tr><td><code id="LuvToMunsell_+3A_adapt">adapt</code></td>
<td>
<p>method for chromatic adaptation, see <b>Details</b></p>
</td></tr>
<tr><td><code id="LuvToMunsell_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code> </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> Luv   &rarr;  XYZ using <code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromLuv</a>()</code> with the given <code>white</code>.
</p>
</li>
<li><p> XYZ is then adapted from the given <code>white</code> to Illuminant C using
the given chromatic adaptation method, see <code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>.
</p>
</li>
<li><p> XYZ   &rarr;  HVC using <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An Nx3 matrix with the Munsell HVC coordinates in each row.
The rownames are set to those of Luv.
</p>


<h3>Note</h3>

<p>The case of the letter 't' in the function name was recently changed from lower to upper.
The function <code>LuvtoMunsell()</code> is equivalent but deprecated and provided for a limited time.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>,
<code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromLuv</a>()</code>,
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LuvToMunsell( c( 74.613450, -5.3108, 10.6,  55, 0, 0 ) )
##                      H        V        C
##  8.7GY 7.4/1.2 38.6599 7.383948 1.229376
##  N 5.4/         0.0000 5.395003 0.000000
</code></pre>

<hr>
<h2 id='Munsell2xy'>The Munsell HVC to xy 3D Lookup Table</h2><span id='topic+Munsell2xy'></span>

<h3>Description</h3>

<p>This is the discrete data for the Munsell Renotation System,
which is often considered to be the most perceptually uniform
color atlas.
It was created by the NBS and OSA from &quot;3,000,000 color judgments&quot;
by 40 observers.
</p>


<h3>Format</h3>

<p>A data frame with 4995 observations of the following 6 variables.
</p>

<ul>
<li><p><code>H</code> the Munsell Hue. Each <code>H</code> is a multiple of 2.5 and in the interval (0,100].
</p>
</li>
<li><p><code>V</code> the Munsell Value.  Each <code>V</code> is an integer from 1 to 10, or one of 0.2, 0.4, 0.6, 0.8
</p>
</li>
<li><p><code>C</code> the Munsell Chroma.  Each <code>C</code> is a positive even integer.
</p>
</li>
<li><p><code>x</code> the x chromaticity coordinate, for Illuminant C.
</p>
</li>
<li><p><code>y</code> the y chromaticity coordinate, for Illuminant C.
</p>
</li>
<li><p><code>real</code> a logical value. If <code>TRUE</code> then x,y were published, otherwise they have been extrapolated.
</p>
</li></ul>

<p>Note that the luminance factor Y is *not* here,
since Y is a simple function of V,
see <code><a href="#topic+YfromV">YfromV</a>()</code>.
</p>


<h3>Details</h3>

<p>All the (x,y) data here comes from the file <code>all.dat</code> downloaded from
Rochester Institute of Technology, see <b>Source</b>.
The file <code>real.dat</code> is a subset, and contains the (x,y) published
in <cite>Newhall, et. al. (1943)</cite>.
These rows have <code>real=TRUE</code> and are only for Value <code class="reqn">\ge</code> 1.
There are 2734 of these.
<br />
Similarly, for Value&lt;1 (very dark colors), (x,y) data from
the paper <cite>Judd et. al. (1956)</cite> also have <code>real=TRUE</code>.
There are 355 of these.
<br />
So <code>all.dat</code> has 4995 colors,
of which 2734+355=3089 are &quot;real&quot; colors,
and the remaining 1906 are extrapolated.
I am confident that the extrapolation was done by
<em>Schleter et. al. (1958)</em> at the NBS,
and put online by the Rochester Institute of Technology.
For more details, and the abstract of the 1958 article,
see the <b>munsellinterpol User Guide</b>.
</p>


<h3>Note</h3>

<p>For the purpose of this package, I have found that the extrapolated (x,y)
for V<code class="reqn">\ge</code>1 work well.
But for V&lt;1 they did not work so well, and I was able to get better results with
my own extrapolation.
Moreover, to get reliable results in this package for high Chroma,
it was necessary to extrapolate past the data in <code>all.dat</code>.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis
</p>


<h3>Source</h3>

<p>Rochester Institute of Technology.
Program of Color Science.
Munsell Renotation Data.
<a href="https://www.rit.edu/science/munsell-color-lab">https://www.rit.edu/science/munsell-color-lab</a>
</p>


<h3>References</h3>

<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Judd, Deane B. and Gunter Wyszecki.
<b>Extension of the Munsell Renotation System to Very Dark Colors</b>.
Journal of the Optical Society of America.
Vol. 46.  No. 4.  pp. 281-284.
April 1956.
</p>
<p>Schleter, J. C, D. B. Judd, D. B., H. J. Keegan.
<b>Extension of the Munsell Renotation System (Abstract)</b>.
J. Opt. Soc. Am.
Vol 48. Num. 11.
pp. 863-864.
presented at the Forty-Third Annual Meeting of the Optical Society of America.
Statler Hilton Hotel, Detroit, Michigan.  October 9, 10, and 11, 1958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+YfromV">YfromV</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(Munsell2xy)

##  'data.frame':	4995 obs. of  6 variables:
##   $ H   : num  32.5 35 37.5 37.5 40 40 42.5 42.5 45 45 ...
##   $ V   : num  0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...
##   $ C   : num  2 2 2 4 2 4 2 4 2 4 ...
##   $ x   : num  0.713 0.449 0.262 -0.078 0.185 -0.257 0.144 -0.235 0.117 -0.209 ...
##   $ y   : num  1.414 1.145 0.837 2.16 0.676 ...
##   $ real: logi  FALSE FALSE FALSE FALSE TRUE FALSE ...
</code></pre>

<hr>
<h2 id='MunsellNameFromHVC'>
Convert Munsell Numeric to Munsell String Notation
</h2><span id='topic+MunsellNameFromHVC'></span><span id='topic+HueStringFromNumber'></span>

<h3>Description</h3>

<p>Convert Munsell Numeric to Munsell String Notation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellNameFromHVC( HVC, format='g', digits=2 )

HueStringFromNumber( Hue, format='g', digits=2 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellNameFromHVC_+3A_hvc">HVC</code></td>
<td>
<p>a numeric Nx3 matrix or a vector that can be converted to
such a matrix.
Each row has an HVC vector, where H is Hue Number,
and V and C are the standard Munsell Value and Chroma.
The Hue is automatically wrapped to the interval (0,100].</p>
</td></tr>
<tr><td><code id="MunsellNameFromHVC_+3A_hue">Hue</code></td>
<td>
<p>a numeric vector of Hue Numbers,
which are automatically wrapped to the interval (0,100].</p>
</td></tr>
<tr><td><code id="MunsellNameFromHVC_+3A_format">format</code></td>
<td>
<p>determines the meaning of the argument <code>digits</code>,
and usually equal to <code>'g'</code> or <code>'f'</code> though other options are available,
see <code><a href="base.html#topic+formatC">formatC</a>()</code> for details.
When <code>format='f'</code> trailing 0s might be displayed.</p>
</td></tr>
<tr><td><code id="MunsellNameFromHVC_+3A_digits">digits</code></td>
<td>

<p>when <code>format='g'</code> the number of significant digits,
and when <code>format='f'</code> the number of digits displayed after the decimal point.
Both <code>format</code> and <code>digits</code> are passed as arguments to
<code><a href="base.html#topic+formatC">formatC</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Both functions return  a character vector of length N.
<code>MunsellNameFromHVC()</code> returns the full notation.
<code>HueStringFromNumber()</code> returns just initial the hue part;
which is useful for labeling plots.
</p>


<h3>Note</h3>

<p>If <code>format='f'</code>, then Chroma is first <em>rounded</em> to to the given <code>digits</code>.
Chromas close to 0 may then become 0 and be displayed as a neutral, see <b>Examples</b>.
<br />
The <code>width</code> argument of <code><a href="base.html#topic+formatC">formatC</a>()</code> is always set to 1,
to suppress leading spaces.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>ASTM D 1535-97.
Standard Practice for Specifying Color by the Munsell System.
1997
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+formatC">formatC</a>()</code>,
<code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>,
<code><a href="#topic+HueNumberFromString">HueNumberFromString</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellNameFromHVC( c(39,5.1,7.3,  0,5.1234,0.003 )  )
##  [1] "9GY 5.1/7.3"    "10RP 5.1/0.003"

MunsellNameFromHVC( c(39,5.1,7.34,  0,5.1234,0.003 ), format='f' )
##  [1] "9.00GY 5.10/7.34" "N 5.10/"

HueStringFromNumber( seq( 2.5, 100, by=2.5 ) )   # make nice labels for a plot
##   [1] "2.5R"  "5R"    "7.5R"  "10R"   "2.5YR" "5YR"   "7.5YR" "10YR"  "2.5Y" 
##  [10] "5Y"    "7.5Y"  "10Y"   "2.5GY" "5GY"   "7.5GY" "10GY"  "2.5G"  "5G"   
##  [19] "7.5G"  "10G"   "2.5BG" "5BG"   "7.5BG" "10BG"  "2.5B"  "5B"    "7.5B" 
##  [28] "10B"   "2.5PB" "5PB"   "7.5PB" "10PB"  "2.5P"  "5P"    "7.5P"  "10P"  
##  [37] "2.5RP" "5RP"   "7.5RP" "10RP" 
</code></pre>

<hr>
<h2 id='MunsellSpecToColorlabFormat'>
Convert Munsell Specification to Colorlab Format
</h2><span id='topic+MunsellSpecToColorlabFormat'></span>

<h3>Description</h3>

<p>Convert Munsell Specification to Colorlab Format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellSpecToColorlabFormat( MunsellSpec )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellSpecToColorlabFormat_+3A_munsellspec">MunsellSpec</code></td>
<td>

<p>a numeric Nx3 matrix, or a vector that can be converted to such a matrix, by row.
Each row of the matrix contains an HVC vector.
H is automatically wrapped to the interval (0,100].<br />
<code>MunsellSpec</code> can also be a character vector with Munsell Notation;
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Colorlab Munsell format uses 4 numbers.
</p>

<ol>
<li><p> Hue Step, in the interval (0,10], or 0 for neutrals.
In Colorlab documentation it is called the <em>hue shade</em>.
It is also the Hue Number H mod 10 (unless H is an exact multiple of 10).
</p>
</li>
<li><p> Munsell Value, in the interval [0,10]
</p>
</li>
<li><p> Munsell Chroma, non-negative
</p>
</li>
<li><p> Hue Index, an integer from 1 to 10, or 0 for neutrals.
This index defines the <em>principal hue</em>, see <b>Details</b>.
</p>
</li></ol>



<h3>Value</h3>

<p>an Nx4 matrix, with rows as described in <b>Details</b>.
Value and Chroma are simply copied unchanged.
The complex part is conversion of Hue Number to Colorlab Hue Step and Hue Index.
If Chroma is 0, both the Hue Step and Hue Index are set to 0.
Invalid input values are converted to <code>NA</code>s.<br />
If the input is a character vector,
the rownames of the returned matrix are set to that vector.
</p>


<h3>Note</h3>

<p>The Colorlab format is closer to the
<em>Munsell Book of Color (1929)</em> than HVC.
In the book the hue circle is divided into 10
<em>principal hues</em> - 5 simple and 5 compound.
The 10 hue labels are: <b>R, YR, Y, GY G, BG, B, PB, P</b>
(simple are 1 letter and compound are 2 letters).
In Colorlab these labels are replaced by the Hue Index.
WARNING: In the Munsell System, see <em>Cleland</em>, there is a different Hue Index -
<b>R</b> is 1, <b>YR</b> is 2, ..., <b>P</b> is 10.
The Colorlab index has a different origin, and goes around the circle in a different
direction !
<br />
Each one of these major hues corresponds to an arc on the circle,
with a 10-point hue scale.
The midpoint of the arc has hue step = 5.
Fortunately this 10-point hue scale is exactly the same as the Colorlab Hue Step.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis
</p>


<h3>References</h3>

<p>Color Processing Toolbox.      
Colorlab 1.0.
<a href="https://www.uv.es/vista/vistavalencia/software/colorlab.html">https://www.uv.es/vista/vistavalencia/software/colorlab.html</a>
</p>
<p>Cleland, T. M.
<b>A Practical description of the Munsell Color System with Suggestions for its Use</b>.
(1921)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>,
<code><a href="#topic+ColorlabFormatToMunsellSpec">ColorlabFormatToMunsellSpec</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellSpecToColorlabFormat( c(100,5,5, 10,3,4, 90,4,3, 77,1,2, 66,2,0, 0,1,2 ) )
##                    HN V C HI
##  10.00RP 5.00/5.00 10 5 5  8
##  10.00R 3.00/4.00  10 3 4  7
##  10.00P 4.00/3.00  10 4 3  9
##  7.00PB 1.00/2.00   7 1 2 10
##  N 2.00/            0 2 0  0
##  10.00RP 1.00/2.00 10 1 2  8
</code></pre>

<hr>
<h2 id='MunsellToLab'>Convert a Munsell specification to CIE Lab coordinates</h2><span id='topic+MunsellToLab'></span>

<h3>Description</h3>

<p><code>MunsellToLab</code> Converts a 
Munsell specification to CIE Lab coordinates, by interpolating over the 
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellToLab( MunsellSpec, white='D65', adapt='Bradford', ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellToLab_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.<br />
<code>MunsellSpec</code> can also be a character vector with Munsell Notations,
which is converted to an Nx3 matrix HVC using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code> </p>
</td></tr>
<tr><td><code id="MunsellToLab_+3A_white">white</code></td>
<td>
<p>XYZ for the source white - a numeric 3-vector with scaling irrelevant.
<code>white</code> can also be a numeric 2-vector; which is interpreted as xy chromaticity and converted to XYZ with Y=100.
<code>white</code> can also be the name of any standard illuminant recognized by
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code> which is scaled so that Y=100.
The default <code>'D65'</code> is converted to <code>c(95.047,100,108.883)</code>. </p>
</td></tr>
<tr><td><code id="MunsellToLab_+3A_adapt">adapt</code></td>
<td>
<p> method for chromatic adaptation, see <code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code> for valid values.
Also see <b>Details</b>. </p>
</td></tr>
<tr><td><code id="MunsellToLab_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> HVC   &rarr;  XYZ using <code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>
</p>
</li>
<li><p> XYZ is adapted from Illuminant C to the given <code>white</code> using <code><a href="spacesXYZ.html#topic+adapt">spacesXYZ::adaptXYZ</a>()</code>
and the given chromatic adaptation method
</p>
</li>
<li><p> XYZ   &rarr;  Lab using <code><a href="spacesXYZ.html#topic+fromXYZ">spacesXYZ::LabfromXYZ</a>()</code> with the given <code>white</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An Nx3 matrix with the Lab coordinates in each row.
The rownames of Lab are copied from the input HVC matrix,
unless the rownames are <code>NULL</code> and
then the output rownames are the Munsell notations for HVC.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LabToMunsell">LabToMunsell</a>()</code>,
<code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+fromXYZ">spacesXYZ::LabfromXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+adapt">spacesXYZ::adaptXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellToLab( c('7.6P 8.9/2.2', 'N 5/' ) )
##                      L       a         b
##  7.6P 8.9/2.2 89.19097 5.09879 -3.250468
##  N 5/         51.00375 0.00000  0.000000
</code></pre>

<hr>
<h2 id='MunsellToLuv'>Convert a Munsell specification to CIE Luv coordinates</h2><span id='topic+MunsellToLuv'></span>

<h3>Description</h3>

<p><code>MunsellToLuv</code> Converts a 
Munsell specification to CIE Luv coordinates, by interpolating over the 
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellToLuv( MunsellSpec, white='D65', adapt='Bradford', ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellToLuv_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.<br />
<code>MunsellSpec</code> can also be a character vector with Munsell Notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code></p>
</td></tr>
<tr><td><code id="MunsellToLuv_+3A_white">white</code></td>
<td>
<p>XYZ for the source white - a numeric 3-vector with scaling irrelevant.
<code>white</code> can also be a numeric 2-vector; which is interpreted as xy chromaticity and converted to XYZ with Y=100.
<code>white</code> can also be the name of any standard illuminant recognized by
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code> which is scaled so that Y=100.
The default <code>'D65'</code> is converted to <code>c(95.047,100,108.883)</code>. </p>
</td></tr>
<tr><td><code id="MunsellToLuv_+3A_adapt">adapt</code></td>
<td>
<p> method for chromatic adaptation, see <code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code> for valid values.
Also see <b>Details</b>. </p>
</td></tr>
<tr><td><code id="MunsellToLuv_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> HVC    &rarr;   XYZ using <code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>
</p>
</li>
<li><p> XYZ is adapted from Illuminant C to the given <code>white</code> 
using <code><a href="spacesXYZ.html#topic+adapt">spacesXYZ::adaptXYZ</a>()</code> with the given chromatic adaptation method
</p>
</li>
<li><p> XYZ    &rarr;   Luv using <code><a href="spacesXYZ.html#topic+fromXYZ">spacesXYZ::LuvfromXYZ</a>()</code> with the given <code>white</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An Nx3 matrix with the Luv coordinates in each row.
The rownames of Luv are copied from the input HVC matrix,
unless the rownames are <code>NULL</code> and
then the output rownames are the Munsell notations for HVC.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LuvToMunsell">LuvToMunsell</a>()</code>,
<code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+standardXYZ">spacesXYZ::standardXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>,
<code><a href="spacesXYZ.html#topic+adapt">spacesXYZ::adaptXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+fromXYZ">spacesXYZ::LuvfromXYZ</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellToLuv( c('7.6P 8.9/2.2', 'N 5/' ) )
##                      L        u         v
##  7.6P 8.9/2.2 89.19097 5.247155 -5.903808
##  N 5/         51.00375 0.000000  0.000000
</code></pre>

<hr>
<h2 id='MunsellToRGB'>Convert a Munsell specification to RGB coordinates</h2><span id='topic+MunsellToRGB'></span>

<h3>Description</h3>

<p><code>MunsellToRGB</code> Converts a 
Munsell specification to RGB coordinates, by interpolating over the 
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellToRGB( MunsellSpec, space='sRGB', which='scene', maxSignal=255, 
    adapt='Bradford', ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellToRGB_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.<br />
<code>MunsellSpec</code> can also be a character vector with Munsell Notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>. </p>
</td></tr>
<tr><td><code id="MunsellToRGB_+3A_space">space</code></td>
<td>
<p>the name of an installed RGB space.
Spaces <code>'sRGB'</code> and <code>'AdobeRGB'</code> are pre-installed,
and others can be installed with <code><a href="spacesRGB.html#topic+installRGB">spacesRGB::installRGB</a>()</code>.
</p>
</td></tr>
<tr><td><code id="MunsellToRGB_+3A_which">which</code></td>
<td>
<p>either <code>'scene'</code> or <code>'display'</code>; passed to <code><a href="spacesRGB.html#topic+RGBfromXYZ">spacesRGB::RGBfromXYZ</a>()</code> </p>
</td></tr>
<tr><td><code id="MunsellToRGB_+3A_maxsignal">maxSignal</code></td>
<td>
<p>maximum of the non-linear signal RGB; Other popular values are 1, 100, 1023, and 65535</p>
</td></tr>
<tr><td><code id="MunsellToRGB_+3A_adapt">adapt</code></td>
<td>
<p>method for chromatic adaptation, see <code><a href="spacesXYZ.html#topic+CAT">spacesXYZ::CAT</a>()</code> for valid values.
Also see <b>Details</b>. </p>
</td></tr>
<tr><td><code id="MunsellToRGB_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> </p>
</td></tr>       
</table>


<h3>Details</h3>

<p>The conversion is done with these steps:
</p>

<ul>
<li><p> HVC    &rarr;   xyY using <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> with <code>...</code>. This xyY is for Illuminant C.
</p>
</li>
<li><p> xyY    &rarr;   XYZ using <code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromxyY</a>()</code> 
</p>
</li>
<li><p> XYZ is adapted from Illuminant C to the white-point (with <code>which</code>) of the RGB <code>space</code>,
using <code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code>, with the given chromatic adaptation method <code>adapt</code>
</p>
</li>
<li><p> XYZ    &rarr;   RGB using <code><a href="spacesRGB.html#topic+RGBfromXYZ">spacesRGB::RGBfromXYZ</a>()</code> with the given <code>space</code>,
<code>which</code>, and <code>maxSignal</code>
</p>
</li></ul>



<h3>Value</h3>

<p>a <code>data.frame</code> with these columns:
</p>
<table>
<tr><td><code>SAMPLE_NAME</code></td>
<td>
<p>a character N-vector equal to the original <code>MunsellSpec</code> if that was a character vector.
Or the Munsell notation string converted from the input matrix HVC.</p>
</td></tr>
<tr><td><code>xyY</code></td>
<td>
<p> an Nx3 matrix with xyY values in the rows, that are adapted to Illuminant C.
This is an intermediate result that is sometimes useful, e.g. it can be passed
to <code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>.
The rownames of xyY are copied from those of HVC, unless the rownames of HVC are <code>NULL</code>
when they are set to <code>SAMPLE_NAME</code>. </p>
</td></tr>
<tr><td><code>RGB</code></td>
<td>
<p>an Nx3 matrix with non-linear RGB signal values in the rows. 
All values are clamped to the appropriate cube, e.g. <code class="reqn">[0,255]^3</code>.
The rownames of RGB are copied from those of xyY. </p>
</td></tr>
<tr><td><code>OutOfGamut</code></td>
<td>
<p>logical vector, TRUE means the result was out of gamut (the cube) before clamping it</p>
</td></tr>
</table>
<p>In case of error, it returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>,
<code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>,
<code><a href="spacesRGB.html#topic+installRGB">spacesRGB::installRGB</a>()</code>,
<code><a href="spacesRGB.html#topic+RGBfromXYZ">spacesRGB::RGBfromXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromxyY</a>()</code>,
<code><a href="spacesXYZ.html#topic+CAT">spacesXYZ::CAT</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellToRGB( c('7.6P 8.9/2.2', 'N 3/'), space='AdobeRGB' )
##     SAMPLE_NAME      xyY.x      xyY.y      xyY.Y     RGB.R     RGB.G     RGB.B OutOfGamut
##  1 7.6P 8.9/2.2  0.3109520  0.3068719 74.6134498 227.72419 220.18659 229.23297      FALSE
##  2         N 3/  0.3101000  0.3163000  6.3911778  73.01793  73.01793  73.01793      FALSE

</code></pre>

<hr>
<h2 id='MunsellTosRGB'>Convert a Munsell specification to sRGB coordinates</h2><span id='topic+MunsellTosRGB'></span>

<h3>Description</h3>

<p><code>MunsellTosRGB</code> Converts a
Munsell specification to non-linear sRGB coordinates, by interpolating over the
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellTosRGB( MunsellSpec, maxSignal=255, ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellTosRGB_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.<br />
<code>MunsellSpec</code> can also be a character N-vector with Munsell notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>. </p>
</td></tr>
<tr><td><code id="MunsellTosRGB_+3A_maxsignal">maxSignal</code></td>
<td>
<p>maximum of signal sRGB; Other popular values are 1, 100, 1023, and 65535</p>
</td></tr>
<tr><td><code id="MunsellTosRGB_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps.
</p>

<ul>
<li><p> HVC    &rarr;   xyY using <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> and the given <code>...</code>. This xyY is for Illuminant C.
</p>
</li>
<li><p> xyY    &rarr;   XYZ  using <code><a href="spacesXYZ.html#topic+XYZfromxyY">spacesXYZ::XYZfromxyY</a>()</code>
</p>
</li>
<li><p> XYZ is adapted from Illuminant C to Illuminant D65 (from the sRGB standard) using
<code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code> and the <em>Bradford</em> chromatic adaptation method
</p>
</li>
<li><p> XYZ    &rarr;   sRGB using <code><a href="spacesRGB.html#topic+RGBfromXYZ">spacesRGB::RGBfromXYZ</a>()</code> with the given <code>maxSignal</code>
</p>
</li></ul>



<h3>Value</h3>

<p>a <code>data.frame</code> with these columns:
</p>
<table>
<tr><td><code>SAMPLE_NAME</code></td>
<td>
<p>the original <code>MunsellSpec</code> if that was a character vector.
Or the Munsell notation string converted from the input matrix HVC.</p>
</td></tr>
<tr><td><code>xyY</code></td>
<td>
<p> an Nx3 matrix with xyY values in the rows, that are adapted to Illuminant C.
This is an intermediate result that is sometimes useful, e.g. it can be passed
to <code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>.
The rownames of xyY are copied from those of HVC, unless the rownames of HVC are <code>NULL</code>
when they are set to <code>SAMPLE_NAME</code>. </p>
</td></tr>
<tr><td><code>RGB</code></td>
<td>
<p>an Nx3 matrix with non-linear signal sRGB values in the rows.
All values are clamped to the appropriate cube, e.g. <code class="reqn">[0,255]^3</code>.
The rownames of RGB are copied from those of xyY.</p>
</td></tr>
<tr><td><code>OutOfGamut</code></td>
<td>
<p>logical vector, TRUE means the RGB result was out of gamut (the cube) before clamping it</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The more general function <code><a href="#topic+MunsellToRGB">MunsellToRGB</a>()</code> also performs this conversion.
The main reason to use <code>MunsellTosRGB()</code> is that it takes a little less time,
since the CAT (using the <em>Bradford</em> method) is precomputed during
<code><a href="base.html#topic+.onLoad">base::.onLoad</a>()</code>.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>,
<code><a href="#topic+MunsellToRGB">MunsellToRGB</a>()</code>,
<code><a href="spacesXYZ.html#topic+XYZfromxyY">spacesXYZ::XYZfromxyY</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptation">spacesXYZ::CAT</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code>,
<code><a href="spacesRGB.html#topic+RGBfromXYZ">spacesRGB::RGBfromXYZ</a>()</code>,
<code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellTosRGB( c('7.6P 8.9/2.2', 'N 3/') )
##     SAMPLE_NAME      xyY.x      xyY.y      xyY.Y     RGB.R     RGB.G     RGB.B OutOfGamut
##  1 7.6P 8.9/2.2  0.3109520  0.3068719 74.6134498 231.35746 221.14207 230.35011      FALSE
##  2         N 3/  0.3101000  0.3163000  6.3911778  71.50491  71.50491  71.50491      FALSE
</code></pre>

<hr>
<h2 id='MunsellToxyY'>Convert Munsell HVC to xyY coordinates</h2><span id='topic+MunsellToxyY'></span>

<h3>Description</h3>

<p><code>MunsellToxyY</code> Converts Munsell HVC to xyY coordinates, by interpolating over the
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellToxyY( MunsellSpec, xyC='NBS', hcinterp='bicubic', vinterp='cubic',
                     YfromV='ASTM', warn=TRUE ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellToxyY_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix or a vector that can be converted to
such a matrix.
Each row has Munsell HVC, where H is Hue Number,
and V and C are the standard Munsell Value and Chroma.
The Hue is automatically wrapped to the interval (0,100].
<code>MunsellSpec</code> can also be a character N-vector with standard Munsell notation; it is converted to an Nx3 matrix.</p>
</td></tr>
<tr><td><code id="MunsellToxyY_+3A_xyc">xyC</code></td>
<td>
<p> a numeric 2-vector with xy chromaticity of Illuminant C.
It can also be one of the strings in the first column of this table;
it is then replaced by the corresponding xy in the second column.
</p>

<table>
<tr>
 <td style="text-align: left;">
             </td><td style="text-align: left;">   xy white point </td><td style="text-align: left;">   reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'NBS'</code> </td><td style="text-align: left;">  <code>c(0.3101,0.3163)</code> </td><td style="text-align: left;"> Kelly, et. al. [RP1549] (1943). Rheinboldt et al. (1960) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'JOSA'</code> </td><td style="text-align: left;">  <code>c(0.31012,0.31631)</code> </td><td style="text-align: left;"> Judd, Deane B. (1933) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'NTSC'</code> </td><td style="text-align: left;">  <code>c(0.310,0.316)</code>  </td><td style="text-align: left;">  NTSC (1953) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'CIE'</code>  </td><td style="text-align: left;">  <code>c(0.31006,0.31616)</code>  </td><td style="text-align: left;">  CIE:15 2004</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The default <code>'NBS'</code> is probably what is intended by <cite>Newhall et. al.</cite>
although no xy for C appears in that paper.
This is the C used in the first computer program for conversion:
<em>Rheinboldt et al. (1960)</em>.
The other options are provided so that a neutral Munsell chip has the xy that
the user expects.  Alternative values of <code>xyC</code> should not be <em>too far</em>
from the above.
If <code>hcinterp</code> is <code>'bicubic'</code>,
this parameter only affects chips with Chroma <code class="reqn">&lt;</code> 4 (except Chroma=2).
If <code>hcinterp</code> is <code>'bilinear'</code>,
this parameter only affects chips with Chroma <code class="reqn">&lt;</code> 2.
</p>
</td></tr>
<tr><td><code id="MunsellToxyY_+3A_hcinterp">hcinterp</code></td>
<td>
<p>either <code>'bicubic'</code> or <code>'bilinear'</code> (partial matching enabled).
In the bicubic case, for a general input point, the output value is interpolated
using a 4x4 subgrid of the lookup table, and the interpolation function is class <code class="reqn">C^1</code>
(except at the neutrals).
In the bilinear case, the interpolation uses a 2x2 subgrid,
and the function is class <code class="reqn">C^0</code>.
</p>
</td></tr>
<tr><td><code id="MunsellToxyY_+3A_vinterp">vinterp</code></td>
<td>
<p>either <code>'cubic'</code> or <code>'linear'</code> (partial matching enabled).
In the cubic case, for a general input point, the output value is interpolated
using 4 planes of constant Value, and the interpolation function is class <code class="reqn">C^1</code>.
In the linear case, the interpolation uses 2 planes and the function is class <code class="reqn">C^0</code>.
</p>
</td></tr>
<tr><td><code id="MunsellToxyY_+3A_yfromv">YfromV</code></td>
<td>
<p>passed as the parameter <code>which</code> to the function <code>YfromV()</code>.
See <code><a href="#topic+YfromV">YfromV</a>()</code> for details.
Option <code>'MGO'</code> is not allowed because then Y&gt;100 when V=10.
</p>
</td></tr>
<tr><td><code id="MunsellToxyY_+3A_warn">warn</code></td>
<td>
<p>if a chip cannot be mapped (usually because the Chroma is too large),
its x and y are set to <code>NA</code> in the returned
<code>data.frame</code>.
Just before returning, if any rows have <code>NA</code>, and this argument is <code>TRUE</code>,
then a warning is logged.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In case <code>hcinterp='bicubic'</code> or <code>vinterp='cubic'</code> a Catmull-Rom spline is used;
see the article <em>Cubic Hermite spline</em>.
This spline has the nice property that it is <em>local</em> and requires at most 4 points.
And if the knot spacing is uniform:
1) the resulting spline is <code class="reqn">C^1</code>,
2) if the knots are on a line, the interpolated points are on the line too.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with these columns:
</p>
<table>
<tr><td><code>SAMPLE_NAME</code></td>
<td>
<p>the original <code>MunsellSpec</code> if that was a character vector.
Or the Munsell notation string converted from the input matrix HVC.</p>
</td></tr>
<tr><td><code>HVC</code></td>
<td>
<p>the input Nx3 matrix, or the HVC matrix converted from the input Munsell notation</p>
</td></tr>
<tr><td><code>xyY</code></td>
<td>
<p>the computed output matrix, with CIE xyY coordinates of MunsellSpec illuminated by Illuminant C.
In case of error, x and y are set to <code>NA</code>.
The rownames of xyY are set to those of HVC, unless they are NULL when they are set to <code>SAMPLE_NAME</code>.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Even when <code>vinterp='cubic'</code> the function HVC   &rarr;  xyY is not <code class="reqn">C^1</code>
on the plane V=1.
This is because of a change in Value spacing:
when V<code class="reqn">\ge</code>1 the Value spacing is 1, but when V<code class="reqn">\le</code>1 the Value spacing is 0.2.
</p>


<h3>Note</h3>

<p>When making plots in planes of constant Value,
option <code>hcinterp='bicubic'</code> makes fairly smooth ovals,
and <code>hcinterp='bilinear'</code> makes polygons.
The ovals are smooth even when <code>vinterp='linear'</code>,
but the function is not class <code class="reqn">C^1</code> at the planes of integer Value.
To get a fully <code class="reqn">C^1</code> function (except at the neutrals and on the plane V=1),
<code>hcinterp</code> and <code>vinterp</code> must be set to the defaults.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>Source</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a><br />
<a href="https://www.rit.edu/science/munsell-color-lab">https://www.rit.edu/science/munsell-color-lab</a><br />
<a href="https://www.rit-mcsl.org/MunsellRenotation/all.dat">https://www.rit-mcsl.org/MunsellRenotation/all.dat</a><br />
<a href="https://www.rit-mcsl.org/MunsellRenotation/real.dat">https://www.rit-mcsl.org/MunsellRenotation/real.dat</a>
</p>


<h3>References</h3>

<p>Judd, Deane B.
<b>The 1931 I.C.I. Standard Observer and Coordinate System for Colorimetry</b>.
Journal of the Optical Society of America.
Vol. 23. pp. 359-374.
October 1933.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Kelly, Kenneth L.
Kasson S. Gibson.
Dorothy Nickerson.
<b>Tristimulus Specification of the Munsell Book of Color from Spectrophometric
Measurements</b>
National Bureau of Standards RP1549
Volume 31. August 1943.
</p>
<p>Judd, Deane B. and Günther Wyszecki.
<b>Extension of the Munsell Renotation System to Very Dark Colors</b>.
Journal of the Optical Society of America.
Vol. 46.  No. 4.  pp. 281-284.
April 1956.
</p>
<p>National Television System Committee.
[Report and Reports of Panel No. 11, 11-A, 12-19,
with Some supplementary references cited in the Reports,
and the Petition for adoption of transmission standards
for color television before the Federal Communications Commission]
(1953)
</p>
<p>Rheinboldt, Werner C. and
John P. Menard.
<b>Mechanized Conversion of Colorimetric Data to Munsell Renotations</b>.
Journal of the Optical Society of America.
Vol. 50, Issue 8, pp. 802-807.
August 1960.
</p>
<p>Wikipedia.
Cubic Hermite spline.
<a href="https://en.wikipedia.org/wiki/Cubic_Hermite_spline">https://en.wikipedia.org/wiki/Cubic_Hermite_spline</a>
</p>
<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xyYtoMunsell">xyYtoMunsell</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellToxyY( '7.6P 8.9/2.2' )
##    SAMPLE_NAME  HVC.H HVC.V HVC.C      xyY.x      xyY.y      xyY.Y
##  1 7.6P 8.9/2.2  87.6   8.9   2.2  0.3109520  0.3068719 74.6134498
</code></pre>

<hr>
<h2 id='MunsellToXYZ'>Convert a Munsell specification to CIE XYZ coordinates</h2><span id='topic+MunsellToXYZ'></span>

<h3>Description</h3>

<p><code>MunsellToXYZ</code> Converts a 
Munsell specification to XYZ coordinates, by interpolating over the 
extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MunsellToXYZ( MunsellSpec, ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MunsellToXYZ_+3A_munsellspec">MunsellSpec</code></td>
<td>
<p> a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.<br />
<code>MunsellSpec</code> can also be a character vector with Munsell Notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>. </p>
</td></tr>
<tr><td><code id="MunsellToXYZ_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>        
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> HVC    &rarr;   xyY using <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> and <code>...</code>. This xyY is for Illuminant C.
</p>
</li>
<li><p> xyY    &rarr;   XYZ using <code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromxyY</a>()</code> 
</p>
</li></ul>



<h3>Value</h3>

<p>an Nx3 matrix with XYZ values in the rows.
The rownames of XYZ are copied from the input HVC matrix,
unless the rownames are <code>NULL</code> and
then the output rownames are the Munsell notations for HVC.
Note that these XYZ values are for viewing under Illuminant C, with Y=100.
There is no chromatic adaptation.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>,
<code><a href="spacesXYZ.html#topic+toXYZ">spacesXYZ::XYZfromxyY</a>()</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MunsellToXYZ('7.6P 8.9/2.2')
##                     X        Y        Z
##  7.6P 8.9/2.2 75.6055 74.61345 92.92308
</code></pre>

<hr>
<h2 id='NickersonColorDifference'>Calculate the Nickerson Color Difference between two Colors</h2><span id='topic+NickersonColorDifference'></span>

<h3>Description</h3>

<p>Calculate the Nickerson Color Difference between two colors, given in Munsell HVC;
see <cite>Nickerson</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NickersonColorDifference( HVC0, HVC1, symmetric=TRUE ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NickersonColorDifference_+3A_hvc0">HVC0</code></td>
<td>
<p>a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.
<code>HVC0</code> can also be a numeric 3-vector with a single HVC, and it is then replicated
to match the size of <code>HVC1</code>.
<br />
<code>HVC0</code> can also be a character N-vector with Munsell Notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>. 
</p>
</td></tr>
<tr><td><code id="NickersonColorDifference_+3A_hvc1">HVC1</code></td>
<td>
<p>a numeric Nx3 matrix with HVC values in the rows, or a vector that can be converted to such a matrix, by row.
<code>HVC1</code> can also be a numeric 3-vector with a single HVC, and it is then replicated
to match the size of <code>HVC0</code>.
<br />
<code>HVC1</code> can also be a character N-vector with Munsell Notations,
which is converted to an Nx3 matrix using <code><a href="#topic+HVCfromMunsellName">HVCfromMunsellName</a>()</code>.
</p>
</td></tr>
<tr><td><code id="NickersonColorDifference_+3A_symmetric">symmetric</code></td>
<td>
<p>if <code>FALSE</code> then use the original Nickerson difference formula,
and if <code>TRUE</code> then use a symmetrized version;
see <b>Details</b>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>HVC0</code>=<code class="reqn">H_0,V_0,C_0</code> and If <code>HVC1</code>=<code class="reqn">H_1,V_1,C_1</code> then the original Nickerson formula is:
</p>
<p style="text-align: center;"><code class="reqn">NCD(HVC0,HVC1) = 0.4 C_0 \Delta H ~+~ 6 \Delta V  ~+~  3 \Delta C</code>
</p>

<p>where <code class="reqn"> \Delta H = |H_0 - H_1| </code> (on the circle),
<code class="reqn"> \Delta V = |V_0 - V_1| </code> and
<code class="reqn"> \Delta C = |C_0 - C_1| </code>.
Unfortunately, if <code>HVC0</code> and <code>HVC1</code> are swapped, the color difference is different.
The first color is considered to be the <em>reference color</em> and the second one is the <em>test color</em>.
The difference is not symmetric.
<br />
Another problem is that the difference is not continuous when the second color is a neutral gray,
for rectangular coordinates on a plane of constant V.
</p>
<p>Both of these problems are fixed with a slightly modified formula:
</p>
<p style="text-align: center;"><code class="reqn">NCD(HVC0,HVC1) = 0.4 \min(C_0,C_1) \Delta H ~+~ 6 \Delta V  ~+~  3 \Delta C</code>
</p>

<p>For the first formula set <code>symmetric=FALSE</code> and for the second formula set <code>symmetric=TRUE</code>.
</p>


<h3>Value</h3>

<p>A numeric N-vector with the pairwise differences, 
i.e. between row i of <code>HVC0</code> and  row i of <code>HVC1</code>.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Nickerson, Dorothy.
The Specification of Color Tolerances.
<b>Textile Research</b>.
Vol 6. pp. 505-514.
1936.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NickersonColorDifference( '7.6P 8.9/2.2', '8P 8.2/3'  )
##  [1] 6.952
</code></pre>

<hr>
<h2 id='plotLociHC'>Plot Curves of Constant Munsell Hue and Chroma</h2><span id='topic+plotLociHC'></span>

<h3>Description</h3>

<p>Plot Curves of Constant Munsell Hue and Chroma</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLociHC( value=5, hue=seq(2.5,100,by=2.5), chroma='auto', coords='xy',
                        main="Value %g/", est=FALSE, ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLociHC_+3A_value">value</code></td>
<td>
<p>a Munsell value for which the plot is created.
It must be in the interval (0,10].
<code>value</code> can also be a numeric vector of such numbers,
and then a separate plot is made for each element of the vector.</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_hue">hue</code></td>
<td>
<p>a numeric vector for which curves of contant Hue are plotted.
Each of these radial curves starts at Munsell Chroma = <code>min(chroma,1)</code>
and extends to <code>max(chroma)</code>.
<code>hue</code> can also be a character vector,
which is then converted to a numeric vector using
<code><a href="#topic+HueNumberFromString">HueNumberFromString</a>()</code>.
</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_chroma">chroma</code></td>
<td>
<p>a numeric vector for which ovoids of constant Chroma are plotted.
Each of these ovoids is closed; i.e. goes full circle from Hue=0 to Hue=100.
If <code>chroma='auto'</code> then a vector is chosen appropriate for the current <code>value</code>.
</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_coords">coords</code></td>
<td>
<p>either <code>'xy'</code> or <code>'ab'</code>.
If  <code>coords='xy'</code> then the plots are in the standard xy chromaticity plane.
If  <code>coords='ab'</code> then the plots are in the ab chrominance plane, from Lab.
Even when it is <code>'ab'</code>, the interpolation of loci takes place in <code>'xy'</code>
<em>before</em> transformation to Lab.
</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_main">main</code></td>
<td>
<p>a string used to set the main title of the plot.
The optional placeholder <code>'%g'</code> is replaced by the current <code>value</code>.
</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_est">est</code></td>
<td>
<p>if <code>TRUE</code>, initial estimates for the iteration used in
<code><a href="#topic+xyYtoMunsell">xyYtoMunsell</a>()</code> are plotted
</p>
</td></tr>
<tr><td><code id="plotLociHC_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <code>MunsellToxyY()</code>.
This includes <code>hcinterp</code>, <code>vinterp</code>, and <code>xyC</code>.
However <code>warn=FALSE</code> is forced.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot limits (<code>xlim</code> and <code>ylim</code>) are set to include
all points where the Hue radials intersect the Chroma ovoids,
plus the white point.
<br />
If <code>value</code> is one of 0.2,0.4,0.6,0.8,1,2,3,4,5,6,7,8,9,10
then published points from <code>real.dat</code>
are plotted with filled black points (real points),
and extrapolated points from <code>all.dat</code> are drawn with open circles (unreal points).
</p>


<h3>Value</h3>

<p><code>TRUE</code> for success and <code>FALSE</code> for failure.
</p>


<h3>Note</h3>

<p>The option <code>hcinterp='bicubic'</code> makes fairly smooth ovoids,
and <code>hcinterp='bilinear'</code> makes 40-sided polygons (when <code>coords='xy'</code>).
Compare with the plots in  
<em>Newhall et. al. (1943)</em>,
<em>Judd, et. al. (1956)</em>,
and <em>Judd, et. al. (1975)</em> p. 263.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Judd, Deane B. and Günther Wyszecki.
<b>Extension of the Munsell Renotation System to Very Dark Colors</b>.
Journal of the Optical Society of America.
Vol. 46.  No. 4.  pp. 281-284.
April 1956.
</p>
<p>Judd, Deane B. and Günther Wyszecki.
<b>Color in Business, Science, and Industry</b>.
3rd edition.
John Wiley &amp; Sons.
1975.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>,
<code><a href="#topic+HueNumberFromString">HueNumberFromString</a>()</code>
</p>

<hr>
<h2 id='plotPatchesH'>Plot Colored Patches for a fixed Munsell Hue</h2><span id='topic+plotPatchesH'></span>

<h3>Description</h3>

<p>This plot simulates a page from the Munsell Book of Color.
The colors are best viewed on a display calibrated for
the RGB space given as the second argument.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPatchesH( hue, space='sRGB', adapt='Bradford', background='gray50',
                        main="Hue %s  (H=%g)      [%s   adapt=%s]", ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPatchesH_+3A_hue">hue</code></td>
<td>
<p>a Munsell hue for which the plot is created.
It is automatically wrapped to the interval (0,100].
It does not have to be a multiple of 2.5.
<code>hue</code> can also be a numeric vector of such numbers,
and then a separate plot is made for each element of the vector.
<code>hue</code> can also be a character vector of Hue Names,
which is then converted to a numeric vector using
<code><a href="#topic+HueNumberFromString">HueNumberFromString</a>()</code>.
</p>
</td></tr>
<tr><td><code id="plotPatchesH_+3A_space">space</code></td>
<td>
<p>the name of an installed RGB space.
Spaces <code>'sRGB'</code> and <code>'AdobeRGB'</code> are pre-installed,
and others can be installed using <code><a href="spacesRGB.html#topic+installRGB">spacesRGB::installRGB</a>()</code> 
</p>
</td></tr>
<tr><td><code id="plotPatchesH_+3A_adapt">adapt</code></td>
<td>
<p>method used to adapt xyY for Illuminant C to xyY for Illuminant D65.
It is passed to <code><a href="#topic+MunsellToRGB">MunsellToRGB</a>()</code>.
</p>
</td></tr>
<tr><td><code id="plotPatchesH_+3A_background">background</code></td>
<td>
<p>background color for the plot.
It is passed to <code>par()</code> as argument <code>bg</code>.
</p>
</td></tr>
<tr><td><code id="plotPatchesH_+3A_main">main</code></td>
<td>
<p>a string used to set the main title of the plot.
The optional placeholder <code>'%s'</code> is replaced by the Hue Name,
<code>'%g'</code> is replaced by the Hue Number,
the next <code>'%s'</code> is replaced by <code>space</code>, and
the last <code>'%s'</code> is replaced by <code>adapt</code>.
</p>
</td></tr>
<tr><td><code id="plotPatchesH_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <code>MunsellToRGB()</code>.
This includes <code>hcinterp</code>, <code>vinterp</code>, and <code>xyC</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The discrete Values are always the same: integers from 0 to 10.
And so the plotting parameter <code>ylim=c(0,11)</code>.
<br />
The discrete Chromas are contiguous even integers depending on the Hue,
and determined as follows.
For the closest discrete Hue in <code>real.dat</code>,
the patches in <code>real.dat</code> are transformed to xyY using simple lookup.
These are then tested against the MacAdam Limits for Illuminant C
using <code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>.
The patches outside the limits are discarded,
and the maximum Chroma of the remaining patches,
which is always an even integer, determines <code>xlim</code>.
<br />
Patches inside the MacAdam Limits can still be outside the RGB cube.
Patches inside the cube are drawn in the usual way,
and those outside are drawn in outline only,
and with the clamped RGB coordinates printed inside.
</p>


<h3>Value</h3>

<p><code>TRUE</code> for success and <code>FALSE</code> for failure.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToRGB">MunsellToRGB</a>()</code>,
<code><a href="#topic+HueNumberFromString">HueNumberFromString</a>()</code>,
<code><a href="#topic+IsWithinMacAdamLimits">IsWithinMacAdamLimits</a>()</code>,
<code><a href="spacesRGB.html#topic+installRGB">spacesRGB::installRGB</a>()</code>
</p>

<hr>
<h2 id='RGBtoMunsell'>Convert RGB coordinates to Munsell HVC</h2><span id='topic+RGBtoMunsell'></span>

<h3>Description</h3>

<p><code>RGBtoMunsell</code> Converts RGB coordinates to Munsell HVC,
by interpolating over the extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RGBtoMunsell( RGB, space='sRGB', which='scene', maxSignal=255, adapt='Bradford', ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RGBtoMunsell_+3A_rgb">RGB</code></td>
<td>
<p> a numeric Nx3 matrix with RGB coordinates in the rows,
or a vector that can be converted to such a matrix, by row.
These are non-linear display values, but they are not required to be integers.</p>
</td></tr>
<tr><td><code id="RGBtoMunsell_+3A_space">space</code></td>
<td>
<p>the name of an installed RGB space.
Spaces <code>'sRGB'</code> and <code>'AdobeRGB'</code> are pre-installed,
and others can be installed using
<code><a href="spacesRGB.html#topic+installRGB">spacesRGB::installRGB</a>()</code>.</p>
</td></tr>
<tr><td><code id="RGBtoMunsell_+3A_which">which</code></td>
<td>
<p>either <code>'scene'</code> or <code>'display'</code>; passed to <code><a href="spacesRGB.html#topic+XYZfromRGB">spacesRGB::XYZfromRGB</a>()</code> </p>
</td></tr>
<tr><td><code id="RGBtoMunsell_+3A_maxsignal">maxSignal</code></td>
<td>
<p>maximum value of signal RGB.
Other popular values are 1, 100, 1023, and 65535.
Even when 1, they are still taken to be non-linear signal values.</p>
</td></tr>
<tr><td><code id="RGBtoMunsell_+3A_adapt">adapt</code></td>
<td>
<p>method for chromatic adaptation,
see <code><a href="spacesXYZ.html#topic+CAT">spacesXYZ::CAT</a>()</code> for valid values.
Also see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="RGBtoMunsell_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> RGB    &rarr;   XYZ using <code><a href="spacesRGB.html#topic+XYZfromRGB">spacesRGB::XYZfromRGB</a>()</code> with the given
<code>space</code>, <code>which</code>, and <code>maxSignal</code>
</p>
</li>
<li><p> XYZ is adapted from the white-point (with <code>which</code>) of <code>space</code> to Illuminant C,
using <code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code>,
with the given chromatic adaptation method <code>adapt</code>
</p>
</li>
<li><p> XYZ    &rarr;   HVC using <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code> with <code>...</code>
</p>
</li></ul>



<h3>Value</h3>

<p>a numeric Nx3 matrix with HVC coordinates in the rows.
The rownames are copied from input RGB to output HVC, unless the rownames are <code>NULL</code>
when they are set to the Munsell notations for HVC.<br />
In case of error, it returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Wikipedia. <b>sRGB</b>.
<a href="https://en.wikipedia.org/wiki/SRGB">https://en.wikipedia.org/wiki/SRGB</a>.
</p>
<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>,
<code><a href="spacesXYZ.html#topic+CAT">spacesXYZ::CAT</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code>,
<code><a href="spacesRGB.html#topic+XYZfromRGB">spacesRGB::XYZfromRGB</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RGBtoMunsell( c(255,45,67) )
##                     H        V        C
##  5.4R 5.5/18 5.401135 5.477315 18.01984

RGBtoMunsell( c(255,45,67), space='Adobe' )
##                     H        V        C
##  5.9R 6.2/22 5.924749 6.214155 21.83907
</code></pre>

<hr>
<h2 id='sRGBtoMunsell'>Convert sRGB coordinates to Munsell HVC</h2><span id='topic+sRGBtoMunsell'></span>

<h3>Description</h3>

<p>Converts non-linear sRGB coordinates to Munsell HVC, 
by interpolating over the extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sRGBtoMunsell( sRGB, maxSignal=255, ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sRGBtoMunsell_+3A_srgb">sRGB</code></td>
<td>
<p> a numeric Nx3 matrix with signal sRGB coordinates in the rows,
or a vector that can be converted to such a matrix, by row.
These are non-linear signal values, but they are not required to be integers.</p>
</td></tr>
<tr><td><code id="sRGBtoMunsell_+3A_maxsignal">maxSignal</code></td>
<td>
<p>maximum value of signal sRGB.
Other popular values are 1, 100, 1023, and 65535.
Even when 1, they are still taken to be non-linear signal values.</p>
</td></tr>
<tr><td><code id="sRGBtoMunsell_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>    </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conversion is done in these steps:
</p>

<ul>
<li><p> sRGB    &rarr;   XYZ using <code><a href="spacesRGB.html#topic+XYZfromRGB">spacesXYZ::XYZfromRGB</a>()</code> with the given <code>maxSignal</code>
</p>
</li>
<li><p> XYZ is adapted from Illuminant D65 (from the sRGB standard) to Illuminant C,
using <code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code> with the <em>Bradford</em> chromatic adaptation method
</p>
</li>
<li><p> XYZ    &rarr;   HVC using <code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code> and the given <code>...</code>
</p>
</li></ul>



<h3>Value</h3>

<p>a numeric Nx3 matrix with HVC coordinates in the rows.
The rownames are copied from input to output, unless the rownames are <code>NULL</code>
when they are set to the Munsell notations for HVC.<br />
In case of error, it returns <code>NULL</code>.
</p>


<h3>Note</h3>

<p>The more general function <code><a href="#topic+RGBtoMunsell">RGBtoMunsell</a>()</code> also performs this conversion.
This function has the advantage that it takes a little less time,
since the CAT (using the <em>Bradford</em> method) is precomputed during
<code><a href="base.html#topic+.onLoad">base::.onLoad</a>()</code>.
But it has the disadvantage that the chromatic adaptation method cannot be changed.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Wikipedia. <b>sRGB</b>.
<a href="https://en.wikipedia.org/wiki/SRGB">https://en.wikipedia.org/wiki/SRGB</a>.
</p>
<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RGBtoMunsell">RGBtoMunsell</a>()</code>,
<code><a href="#topic+XYZtoMunsell">XYZtoMunsell</a>()</code>,
<code><a href="spacesXYZ.html#topic+CAT">spacesXYZ::CAT</a>()</code>,
<code><a href="spacesXYZ.html#topic+adaptXYZ">spacesXYZ::adaptXYZ</a>()</code>,
<code><a href="spacesRGB.html#topic+XYZfromRGB">spacesXYZ::XYZfromRGB</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sRGBtoMunsell( c(255,45,67) )
##                     H        V        C
##  5.4R 5.5/18 5.401135 5.477315 18.01984

sRGBtoMunsell( c(1,0,1), maxSignal=1 )
##                 H        V        C
##  8P 6/26 87.98251 5.981297 25.64534
</code></pre>

<hr>
<h2 id='VandY'>Convert Munsell Value V to Luminance Factor Y, and back again</h2><span id='topic+VfromY'></span><span id='topic+YfromV'></span>

<h3>Description</h3>

<p>Convert non-linear Munsell Value V to linear Luminance Factor Y, and back again
</p>


<h3>Usage</h3>

<pre><code class='language-R'>YfromV( V, which='ASTM' )
VfromY( Y, which='ASTM' )</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VandY_+3A_v">V</code></td>
<td>
<p>a numeric vector with elements in the interval [0,10]</p>
</td></tr>
<tr><td><code id="VandY_+3A_y">Y</code></td>
<td>
<p>a numeric vector with elements in the interval [0,100]</p>
</td></tr>
<tr><td><code id="VandY_+3A_which">which</code></td>
<td>
<p> one of the strings in the first column of this table
</p>

<table>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">    reference </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'ASTM'</code> </td><td style="text-align: left;">    ASTM D-1535 (2008) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'OSA'</code> </td><td style="text-align: left;">     Newhall, et. al. (1943) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'MgO'</code> </td><td style="text-align: left;">     Newhall, et. al. (1943) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Munsell'</code> </td><td style="text-align: left;"> Munsell, et. al. (1933)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Priest'</code> </td><td style="text-align: left;"> Priest, et. al. (1920)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Partial matching is enabled, and it is case insensitive.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>'Priest'</code> is the earliest (1920) transfer function in this package.
It is implemented as:
</p>
<p style="text-align: center;"><code class="reqn">V = sqrt(Y)  ~~~~~~and~~~~~~   Y = V^2 </code>
</p>

<p>One readily checks that when V=10, Y=100, and vice-versa.
This transfer function has been implemented in colorimeters,
using analog electric circuits.
It is used in Hunter Lab - the precursor of CIE Lab.
</p>
<p><code>'Munsell'</code> is the next (1933) transfer function,
and was proposed by Munsell's son (Alexander Ector Orr Munsell) and co-workers.   
It is implemented as:
</p>
<p style="text-align: center;"><code class="reqn">V = sqrt( 1.474*Y - 0.00474*Y^2 )</code>
</p>

<p style="text-align: center;"><code class="reqn">Y = 50 * ( (1474 - sqrt(1474^2 - 4*4740*V^2)) / 474 )</code>
</p>

<p>One readily checks that when V=10, Y=100, and vice-versa.
The luminance factor Y is <em>absolute</em>,
AKA <em>relative to the perfect reflecting diffuser</em>.
</p>
<p><code>'Priest'</code> and <code>'Munsell'</code> are included in this package
for historical interest only.
</p>
<p>The remaining three define Y as a quintic polynomial in V.
</p>
<p>The next one historically - <code>'MgO'</code> -  is implemented as:
</p>
<p style="text-align: center;"><code class="reqn"> Y = (((((8404*V - 210090)*V  + 2395100)*V  - 2311100)*V + 10000000)*V ) / 10000000</code>
</p>

<p>One readily checks that when V=10, Y=102.568.
This Y is larger than 100, because the authors decided to make Y relative
to a clean surface of MgO, instead of the perfect reflecting diffuser.
In their words:
</p>

<ul>
<li><p> It should be noted that the
reflectances indicated are not absolute but relative to magnesium oxide;
whereas the maximum at value 10/ was formerly 100 percent, it is now 102.57.
Use of this relation facilitates results and
also avoids the somewhat dubious conversion to
absolute scale, by permitting Y determinations
with a MgO standard to be converted directly to Munsell value.
</p>
</li></ul>

<p>Nowadays, the perfect reflecting diffuser is preferred over MgO.
For users who would like to modify this quintic as little as possible,
with the perfect reflecting diffuser in mind
(going back to <code>'MUNSELL'</code>),
I offer <code>'OSA'</code>, which is given by this quintic of my own design
</p>
<p style="text-align: center;"><code class="reqn">Y = (((((8404*V - 210090)*V  + 2395100)*V  - 2311100)*V + 10000000)*V ) / 10256800</code>
</p>

<p>ASTM had a similar modification in mind,
but did it a little differently by scaling each coefficient.
<code>'ASTM'</code> is given by this quintic:
</p>
<p style="text-align: center;"><code class="reqn">Y = ( ((((81939*V - 2048400)*V  + 23352000)*V - 22533000)*V + 119140000)*V  ) / 1.e8 </code>
</p>

<p>One readily checks that when V=10, Y=100 exactly (for both <code>'OSA'</code> and <code>'ASTM'</code>).
</p>
<p>The inverses - from Y to V - of all 3 quintics are implemented as 
3 <code>splinefun()</code>s at a large number (about 300) of points.
These inverses are both fast and accurate.
The round-trip Y    &rarr;   V    &rarr;   Y is accurate to 7 digits after the decimal.
The round-trip V    &rarr;   Y    &rarr;   V is accurate to 8 digits after the decimal.
</p>


<h3>Value</h3>

<p>a numeric vector the same length as the input
</p>


<h3>Note</h3>

<p>The quintic functions <code>'ASTM'</code> and <code>'OSA'</code> are very close.
They agree at the endpoints 0 and 10 exactly, and the largest difference is near
V=6.767 where they differ by about 0.0007.
</p>


<h3>Author(s)</h3>

<p>Glenn Davis</p>


<h3>References</h3>

<p>Priest, I. G. Gibson, K. S. and McNicholas, H. J.
<b>An Examination of the Munsell Color System.
I. Spectral and and Total Reflection and the Munsell Scale of Value</b>.
Technologic Papers of the Bureau of Standards, No. 167.
pp. 1-33.
Washington D.C.
1920.
</p>
<p>Munsell, A. E. O.,
L. L. Sloan,
and I. H. Godlove.
<b>Neutral Value Scales. I. Munsell Neutral Value Scale</b>.
Journal of the Optical Society of America.
Vol. 23. Issue 11. pp. 394-411.
November 1933.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>ASTM D 1535-08.
Standard Practice for Specifying Color by the Munsell System.
2008
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>,
<code><a href="#topic+xyYtoMunsell">xyYtoMunsell</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>VfromY( c(0,50,100) )
##  [1]  0.00000  7.53772 10.00000
</code></pre>

<hr>
<h2 id='xyYtoMunsell'>Convert xyY coordinates to Munsell HVC</h2><span id='topic+xyYtoMunsell'></span>

<h3>Description</h3>

<p><code>xyYtoMunsell</code> Convert xyY coordinates to Munsell HVC,
by interpolating over the extrapolated Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xyYtoMunsell( xyY, xyC='NBS', hcinterp='bicubic', vinterp='cubic',
                     VfromY='ASTM', warn=TRUE, perf=FALSE ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xyYtoMunsell_+3A_xyy">xyY</code></td>
<td>
<p>a numeric Nx3 matrix with CIE xyY coordinates in the rows,
or a vector that can be converted to such a matrix, by row.  
These are for viewing in an environment with Illuminant C, with Y=100.</p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_xyc">xyC</code></td>
<td>
<p> a numeric 2-vector with xy chromaticity of Illuminant C.
It can also be one of the strings given in <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>. </p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_hcinterp">hcinterp</code></td>
<td>
<p>either <code>'bicubic'</code> or <code>'bilinear'</code> (partial matching enabled).
See <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> for details. </p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_vinterp">vinterp</code></td>
<td>
<p>either <code>'cubic'</code> or <code>'linear'</code> (partial matching enabled).
See <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> for details. </p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_vfromy">VfromY</code></td>
<td>
<p>passed as the parameter <code>which</code> to the function <code>VfromY()</code>.
See <code><a href="#topic+VfromY">VfromY</a>()</code> for details.
Option <code>'MGO'</code> is not allowed because then Y&gt;100 when V=10.
</p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_warn">warn</code></td>
<td>
<p>if an xyY cannot be mapped
(usually because the root finder has wandered afar),
its H and V are set to <code>NA</code> in the returned <code>data.frame</code>.
Just before returning, if any rows in HVC have an <code>NA</code>, and <code>warn == TRUE</code>,
then a warning is logged.
</p>
</td></tr>
<tr><td><code id="xyYtoMunsell_+3A_perf">perf</code></td>
<td>
<p>if <code>perf</code> is <code>TRUE</code>, then extra performance related metrics
are appended to the returned <code>data.frame</code>, see <b>Value</b>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code> and the <b>User Guide - Appendix C</b>.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with N rows and these columns:
</p>
<table>
<tr><td><code>xyY</code></td>
<td>
<p>The input xyY</p>
</td></tr>
<tr><td><code>HVC</code></td>
<td>
<p>the computed HVC. H is automatically wrapped to (0,100].  In case of failure, H and C are set to <code>NA</code>.
The rownames of HVC are set to those of xyY, unless they are <code>NULL</code> when they are set to <code>SAMPLE_NAME</code>.</p>
</td></tr>
<tr><td><code>SAMPLE_NAME</code></td>
<td>
<p>the Munsell notation for HVC, a character vector</p>
</td></tr>
</table>
<p>If <code>perf</code> is <code>TRUE</code> then there are these additional columns:
</p>
<table>
<tr><td><code>time.elapsed</code></td>
<td>
<p>elapsed time in seconds. If available, the function <code>microbenchmark::get_nanotime()</code> is used.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of iterations of <code>rootSolve::multiroot()</code></p>
</td></tr>
<tr><td><code>evalations</code></td>
<td>
<p>the number of forward (HVC    &rarr;   xyY) function evaluations</p>
</td></tr>
<tr><td><code>estim.precis</code></td>
<td>
<p>the estimated precision from <code>rootSolve::multiroot()</code>.
This is in the HC plane for the Munsell Value computed from Y.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Even when <code>vinterp='cubic'</code> the function xyY    &rarr;  HVC is not <code class="reqn">C^1</code>
on the plane V=1.
This is because of a change in Value spacing:
when V<code class="reqn">\ge</code>1 the Value spacing is 1, but when V<code class="reqn">\le</code>1 the Value spacing is 0.2.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>Source</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a><br />
<a href="https://www.rit.edu/science/munsell-color-lab">https://www.rit.edu/science/munsell-color-lab</a><br />
<a href="https://www.rit-mcsl.org/MunsellRenotation/all.dat">https://www.rit-mcsl.org/MunsellRenotation/all.dat</a><br />
<a href="https://www.rit-mcsl.org/MunsellRenotation/real.dat">https://www.rit-mcsl.org/MunsellRenotation/real.dat</a>
</p>


<h3>References</h3>

<p>Judd, Deane B.
<b>The 1931 I.C.I. Standard Observer and Coordinate System for Colorimetry</b>.
Journal of the Optical Society of America.
Vol. 23. pp. 359-374.
October 1933.
</p>
<p>Newhall, Sidney M.,
Dorothy Nickerson,
Deane B. Judd.
<b>Final Report of the O.S.A. Subcommitte on the Spacing of the Munsell Colors</b>.
Journal of the Optical Society of America.
Vol. 33.  No. 7.  pp. 385-418.
July 1943.
</p>
<p>Kelly, Kenneth L.
Kasson S. Gibson.
Dorothy Nickerson.
<b>Tristimulus Specification of the Munsell Book of Color from Spectrophometric
Measurements</b>
National Bureau of Standards RP1549
Volume 31. August 1943.
</p>
<p>Judd, Deane B. and Günther Wyszecki.
<b>Extension of the Munsell Renotation System to Very Dark Colors</b>.
Journal of the Optical Society of America.
Vol. 46.  No. 4.  pp. 281-284.
April 1956.
</p>
<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToxyY">MunsellToxyY</a>()</code>,
<code><a href="rootSolve.html#topic+rootSolve">rootSolve::multiroot</a>()</code>,
<code><a href="microbenchmark.html#topic+microbenchmark">microbenchmark::get_nanotime</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xyYtoMunsell(c(0.310897, 0.306510, 74.613450))
##       xyY.1     xyY.2     xyY.3     HVC.H     HVC.V     HVC.C    SAMPLE_NAME
## 1  0.310897  0.306510 74.613450 87.541720  8.900000  2.247428   7.5P 8.9/2.2
</code></pre>

<hr>
<h2 id='XYZtoMunsell'>Convert XYZ coordinates to Munsell HVC</h2><span id='topic+XYZtoMunsell'></span>

<h3>Description</h3>

<p><code>XYZtoMunsell</code> Convert XYZ coordinates to Munsell HVC, by interpolating over the  Munsell renotation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XYZtoMunsell( XYZ, ... ) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="XYZtoMunsell_+3A_xyz">XYZ</code></td>
<td>
<p>a numeric Nx3 matrix with CIE XYZ coordinates in the rows,
or a vector that can be converted to such a matrix, by row.
The XYZ are for viewing in an environment with Illuminant C.</p>
</td></tr>
<tr><td><code id="XYZtoMunsell_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="#topic+xyYtoMunsell">xyYtoMunsell</a>()</code> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>the function calls <code>XYZ2xyY()</code> and <code>xyYtoMunsell()</code>.
</p>
<p>The conversion is done in these steps:
</p>

<ul>
<li><p> XYZ    &rarr;   xyY using <code><a href="spacesXYZ.html#topic+xyYfromXYZ">spacesXYZ::xyYfromXYZ</a>()</code> 
</p>
</li>
<li><p> xyY    &rarr;   HVC using <code><a href="#topic+xyYtoMunsell">xyYtoMunsell</a>()</code> and <code>...</code>
</p>
</li></ul>



<h3>Value</h3>

<p>an Nx3 matrix with Munsell HVC in the rows.
The rownames are copied from input to output, unless the rownames are <code>NULL</code>
when they are set to the Munsell notations for HVC.<br />
In case of error, it returns <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Jose Gama and Glenn Davis</p>


<h3>References</h3>

<p>Paul Centore 2014
The Munsell and Kubelka-Munk Toolbox
<a href="https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html">https://www.munsellcolourscienceforpainters.com/MunsellAndKubelkaMunkToolbox/MunsellAndKubelkaMunkToolbox.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MunsellToXYZ">MunsellToXYZ</a>()</code>,
<code><a href="spacesXYZ.html#topic+xyYfromXYZ">spacesXYZ::xyYfromXYZ</a>()</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>XYZtoMunsell( c(0.310897, 0.306510, 74.613450) )
##                         H         V        C
##  0.51PB 0.27/9.9 70.50874 0.2671142 9.916039
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
