<!DOCTYPE html><html lang="en-US"><head><title>Help for package EMpeaksR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EMpeaksR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#show_dsgmm_curve'><p>Visualization of the result of spect_em_dsgmm</p></a></li>
<li><a href='#show_gmm_curve'><p>Visualization of the result of spect_em_gmm</p></a></li>
<li><a href='#show_lmm_curve'><p>Visualization of the result of spect_em_lmm</p></a></li>
<li><a href='#show_pvmm_curve'><p>Visualization of the result of spect_em_pvmm</p></a></li>
<li><a href='#show_pvmm_lback_curve'><p>Visualization of the result of spect_em_pvmm_lback</p></a></li>
<li><a href='#spect_em_dsgmm'><p>Spectrum adapted ECM algorithm by DSGMM</p></a></li>
<li><a href='#spect_em_gmm'><p>Spectrum adapted EM algorithm by GMM</p></a></li>
<li><a href='#spect_em_lmm'><p>Spectrum adapted ECM algorithm by LMM</p></a></li>
<li><a href='#spect_em_pvmm'><p>Spectrum adapted ECM algorithm by PVMM</p></a></li>
<li><a href='#spect_em_pvmm_lback'><p>Spectrum adapted ECM algorithm by PVMM with a linear background</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Conducting the Peak Fitting Based on the EM Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The peak fitting of spectral data is performed by using the frame work of EM algorithm. We adapted the EM algorithm for the peak fitting of spectral data set by considering the weight of the intensity corresponding to the measurement energy steps    (Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019, 2021 and 2023) &lt;<a href="https://doi.org/10.1080%2F14686996.2019.1620123">doi:10.1080/14686996.2019.1620123</a>&gt;, &lt;<a href="https://doi.org/10.1080%2F27660400.2021.1899449">doi:10.1080/27660400.2021.1899449</a>&gt; &lt;<a href="https://doi.org/10.1080%2F27660400.2022.2159753">doi:10.1080/27660400.2022.2159753</a>&gt;. The package efficiently estimates the parameters of Gaussian mixture model during iterative calculation between E-step and M-step, and the parameters are converged to a local optimal solution. This package can support the investigation of peak shift with two advantages: (1) a large amount of data can be processed at high speed; and (2) stable and automatic calculation can be easily performed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 12:38:38 UTC; matsumura_tarojiro</td>
</tr>
<tr>
<td>Author:</td>
<td>Tarojiro Matsumura [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tarojiro Matsumura &lt;matsumura-tarojiro@aist.go.jp&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-29 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='show_dsgmm_curve'>Visualization of the result of spect_em_dsgmm</h2><span id='topic+show_dsgmm_curve'></span>

<h3>Description</h3>

<p>Visualization of the result of spect_em_dsgmm().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_dsgmm_curve(spect_em_dsgmm_res,
                 x,
                 y,
                 mix_ratio_init,
                 mu_init,
                 sigma_init,
                 alpha_init,
                 eta_init)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_dsgmm_curve_+3A_spect_em_dsgmm_res">spect_em_dsgmm_res</code></td>
<td>
<p>data set obtained by spect_em_dsgmm()</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_mix_ratio_init">mix_ratio_init</code></td>
<td>
<p>initial values of the mixture ratio of the components</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_mu_init">mu_init</code></td>
<td>
<p>initial values of the mean of the components</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_sigma_init">sigma_init</code></td>
<td>
<p>initial values of the standard deviation of the components</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_alpha_init">alpha_init</code></td>
<td>
<p>initial values of the asymmetric parameter of the components</p>
</td></tr>
<tr><td><code id="show_dsgmm_curve_+3A_eta_init">eta_init</code></td>
<td>
<p>initial values of the mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a visualization of fitting curve estimated by Doniach-Sunjic-Gauss mixture model.
</p>


<h3>Value</h3>

<p>Show the fitting curve and variation of the parameters.
</p>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Doniach-Sunjic-Gauss mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(20, 50, 80)
true_sigma      &lt;- c(3, 3, 3)
true_alpha      &lt;- c(0.1, 0.3, 0.1)
true_eta        &lt;- c(0.4, 0.6, 0.1)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#trancated Doniach-Sunjic-Gauss
truncated_dsg &lt;- function(x, mu, sigma, alpha, eta) {
                 ((eta*(((gamma(1-alpha)) /
                 ((x-mu)^2+(sqrt(2*log(2))*sigma)^2)^((1-alpha)/2)) *
                 cos((pi*alpha/2)+(1-alpha)*atan((x-mu) /
                 (sqrt(2*log(2))*sigma))))) + (1-eta)*dnorm(x, mu, sigma)) /
                 sum( ((eta*(((gamma(1-alpha)) /
                 ((x-mu)^2+(sqrt(2*log(2))*sigma)^2)^((1-alpha)/2)) *
                 cos((pi*alpha/2)+(1-alpha)*atan((x-mu) /
                 (sqrt(2*log(2))*sigma))))) + (1-eta)*dnorm(x, mu, sigma)))
}

y &lt;- c(true_mix_ratio[1]*truncated_dsg(x = x,
                                       mu = true_mu[1],
                                       sigma = true_sigma[1],
                                       alpha = true_alpha[1],
                                       eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_dsg(x = x,
                                       mu = true_mu[2],
                                       sigma = true_sigma[2],
                                       alpha = true_alpha[2],
                                       eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_dsg(x = x,
                                       mu = true_mu[3],
                                       sigma = true_sigma[3],
                                       alpha = true_alpha[3],
                                       eta = true_eta[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3
mix_ratio_init &lt;- c(0.2, 0.4, 0.4)
mu_init        &lt;- c(20, 40, 70)
sigma_init     &lt;- c(4, 3, 2)
alpha_init     &lt;- c(0.3, 0.2, 0.4)
eta_init       &lt;- c(0.5, 0.4, 0.3)

#Coducting calculation
SP_ECM_DSG_res &lt;- spect_em_dsgmm(x = x,
                                 y = y,
                                 mu = mu_init,
                                 sigma = sigma_init,
                                 alpha = alpha_init,
                                 eta = eta_init,
                                 mix_ratio = mix_ratio_init,
                                 conv.cri = 1e-2,
                                 maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_dsgmm_curve(SP_ECM_DSG_res,
                 x,
                 y,
                 mix_ratio_init,
                 mu_init,
                 sigma_init,
                 alpha_init,
                 eta_init)

#Showing the result of spect_em_dsgmm()
print(cbind(c(mu_init),
            c(sigma_init),
            c(alpha_init),
            c(eta_init),
            c(mix_ratio_init)))

print(cbind(SP_ECM_DSG_res$mu,
            SP_ECM_DSG_res$sigma,
            SP_ECM_DSG_res$alpha,
            SP_ECM_DSG_res$eta,
            SP_ECM_DSG_res$mix_ratio))

print(cbind(true_mu,
            true_sigma,
            true_alpha,
            true_eta,
            true_mix_ratio))
</code></pre>

<hr>
<h2 id='show_gmm_curve'>Visualization of the result of spect_em_gmm</h2><span id='topic+show_gmm_curve'></span>

<h3>Description</h3>

<p>Visualization of the result of spect_em_gmm().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_gmm_curve(spect_em_gmm_res, x, y, mix_ratio_init, mu_init, sigma_init)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_gmm_curve_+3A_spect_em_gmm_res">spect_em_gmm_res</code></td>
<td>
<p>data set obtained by spect_em_gmm()</p>
</td></tr>
<tr><td><code id="show_gmm_curve_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="show_gmm_curve_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="show_gmm_curve_+3A_mix_ratio_init">mix_ratio_init</code></td>
<td>
<p>initial values of the mixture ratio of the components</p>
</td></tr>
<tr><td><code id="show_gmm_curve_+3A_mu_init">mu_init</code></td>
<td>
<p>initial values of the mean of the components</p>
</td></tr>
<tr><td><code id="show_gmm_curve_+3A_sigma_init">sigma_init</code></td>
<td>
<p>initial values of the standard deviation of the components</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a visualization of fitting curve estimated by Gaussian mixture model.
</p>


<h3>Value</h3>

<p>Show the fitting curve and variation of the parameters.
</p>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Gausian mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_sigma      &lt;- c(3, 3, 3)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

y &lt;- c(true_mix_ratio[1] * dnorm(x = x, mean = true_mu[1], sd = true_sigma[1])*10^degree +
       true_mix_ratio[2] * dnorm(x = x, mean = true_mu[2], sd = true_sigma[2])*10^degree +
       true_mix_ratio[3] * dnorm(x = x, mean = true_mu[3], sd = true_sigma[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
sigma_init      &lt;- c(2, 5, 4)

#Coducting calculation
SP_EM_G_res &lt;- spect_em_gmm(x, y, mu = mu_init, sigma = sigma_init, mix_ratio = mix_ratio_init,
                            conv.cri = 1e-2, maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_gmm_curve(SP_EM_G_res, x, y, mix_ratio_init, mu_init, sigma_init)

#Showing the result of spect_em_gmm()
print(cbind(c(mu_init), c(sigma_init), c(mix_ratio_init)))
print(cbind(SP_EM_G_res$mu, SP_EM_G_res$sigma, SP_EM_G_res$mix_ratio))
print(cbind(true_mu, true_sigma, true_mix_ratio))

</code></pre>

<hr>
<h2 id='show_lmm_curve'>Visualization of the result of spect_em_lmm</h2><span id='topic+show_lmm_curve'></span>

<h3>Description</h3>

<p>Visualization of the result of spect_em_lmm().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_lmm_curve(spect_em_lmm_res, x, y, mix_ratio_init, mu_init, gam_init)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_lmm_curve_+3A_spect_em_lmm_res">spect_em_lmm_res</code></td>
<td>
<p>data set obtained by spect_em_lmm()</p>
</td></tr>
<tr><td><code id="show_lmm_curve_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="show_lmm_curve_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="show_lmm_curve_+3A_mix_ratio_init">mix_ratio_init</code></td>
<td>
<p>initial values of the mixture ratio of the components</p>
</td></tr>
<tr><td><code id="show_lmm_curve_+3A_mu_init">mu_init</code></td>
<td>
<p>initial values of the mean of the components</p>
</td></tr>
<tr><td><code id="show_lmm_curve_+3A_gam_init">gam_init</code></td>
<td>
<p>initial values of the scale parameter of the components</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a visualization of fitting curve estimated by Lorentz mixture model.
</p>


<h3>Value</h3>

<p>Show the fitting curve and variation of the parameters.
</p>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Lorentz mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_gam        &lt;- c(3, 3, 3)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#Normalized Lorentz distribution
dCauchy &lt;- function(x, mu, gam) {
    (dcauchy(x, mu, gam)) / sum(dcauchy(x, mu, gam))
  }

y &lt;- c(true_mix_ratio[1] * dCauchy(x = x, mu = true_mu[1], gam = true_gam[1])*10^degree +
       true_mix_ratio[2] * dCauchy(x = x, mu = true_mu[2], gam = true_gam[2])*10^degree +
       true_mix_ratio[3] * dCauchy(x = x, mu = true_mu[3], gam = true_gam[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
gam_init        &lt;- c(2, 5, 4)

#Coducting calculation
SP_ECM_L_res &lt;- spect_em_lmm(x, y, mu = mu_init, gam = gam_init, mix_ratio = mix_ratio_init,
                             conv.cri = 1e-2, maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_lmm_curve(SP_ECM_L_res, x, y, mix_ratio_init, mu_init, gam_init)

#Showing the result of spect_em_lmm()
print(cbind(c(mu_init), c(gam_init), c(mix_ratio_init)))
print(cbind(SP_ECM_L_res$mu, SP_ECM_L_res$gam, SP_ECM_L_res$mix_ratio))
print(cbind(true_mu, true_gam, true_mix_ratio))

</code></pre>

<hr>
<h2 id='show_pvmm_curve'>Visualization of the result of spect_em_pvmm</h2><span id='topic+show_pvmm_curve'></span>

<h3>Description</h3>

<p>Visualization of the result of spect_em_pvmm().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_pvmm_curve(spect_em_pvmm_res, x, y, mix_ratio_init, mu_init, sigma_init, eta_init)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_pvmm_curve_+3A_spect_em_pvmm_res">spect_em_pvmm_res</code></td>
<td>
<p>data set obtained by spect_em_pvmm()</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_mix_ratio_init">mix_ratio_init</code></td>
<td>
<p>initial values of the mixture ratio of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_mu_init">mu_init</code></td>
<td>
<p>initial values of the mean of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_sigma_init">sigma_init</code></td>
<td>
<p>initial values of the standard deviation of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_curve_+3A_eta_init">eta_init</code></td>
<td>
<p>initial values of the mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a visualization of fitting curve estimated by Pseudo-Voigt mixture model.
</p>


<h3>Value</h3>

<p>Show the fitting curve and variation of the parameters.
</p>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Pseudo-Voigt mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_sigma      &lt;- c(3, 3, 3)
true_eta        &lt;- c(0.3, 0.8, 0.5)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#Normalized Pseudo-Voigt distribution
  truncated_pv &lt;- function(x, mu, sigma, eta) {
    (eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma)) /
      sum(eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma))
  }

y &lt;- c(true_mix_ratio[1]*truncated_pv(x = x,
                                      mu = true_mu[1],
                                      sigma = true_sigma[1],
                                      eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_pv(x = x,
                                      mu = true_mu[2],
                                      sigma = true_sigma[2],
                                      eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_pv(x = x,
                                      mu = true_mu[3],
                                      sigma = true_sigma[3],
                                      eta = true_eta[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
sigma_init      &lt;- c(2, 5, 4)
eta_init        &lt;- c(0.5, 0.4, 0.3)

#Coducting calculation
SP_ECM_PV_res &lt;- spect_em_pvmm(x = x,
                               y = y,
                               mu = mu_init,
                               sigma = sigma_init,
                               eta = eta_init,
                               mix_ratio = mix_ratio_init,
                               conv.cri = 1e-2,
                               maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_pvmm_curve(SP_ECM_PV_res, x, y, mix_ratio_init, mu_init, sigma_init, eta_init)

#Showing the result of spect_em_pvmm()
print(cbind(c(mu_init), c(sigma_init), c(eta_init), c(mix_ratio_init)))
print(cbind(SP_ECM_PV_res$mu, SP_ECM_PV_res$sigma, SP_ECM_PV_res$eta, SP_ECM_PV_res$mix_ratio))
print(cbind(true_mu, true_sigma, true_eta, true_mix_ratio))

</code></pre>

<hr>
<h2 id='show_pvmm_lback_curve'>Visualization of the result of spect_em_pvmm_lback</h2><span id='topic+show_pvmm_lback_curve'></span>

<h3>Description</h3>

<p>Visualization of the result of spect_em_pvmm_lback().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_pvmm_lback_curve(spect_em_pvmm_lback_res,
                      x, y,
                      mix_ratio_init,
                      mu_init,
                      sigma_init,
                      eta_init,
                      x_lower,
                      x_upper)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_pvmm_lback_curve_+3A_spect_em_pvmm_lback_res">spect_em_pvmm_lback_res</code></td>
<td>
<p>data set obtained by spect_em_pvmm_lback()</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_mu_init">mu_init</code></td>
<td>
<p>initial values of the mean of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_sigma_init">sigma_init</code></td>
<td>
<p>initial values of the standard deviation of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_eta_init">eta_init</code></td>
<td>
<p>initial values of the mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_mix_ratio_init">mix_ratio_init</code></td>
<td>
<p>initial values of the mixture ratio of the components</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_x_lower">x_lower</code></td>
<td>
<p>lower limit of the measurement steps. Default is a minimum of x</p>
</td></tr>
<tr><td><code id="show_pvmm_lback_curve_+3A_x_upper">x_upper</code></td>
<td>
<p>upper limit of the measurement steps. Default is a maximum of x</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a visualization of fitting curve estimated by pseudo-Voigt mixture model with a linear background.
</p>


<h3>Value</h3>

<p>Show the fitting curve and variation of the parameters.
</p>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2023). High-throughput XPS spectrum modeling with autonomous background subtraction for 3 d 5/2 peak mapping of SnS. Science and Technology of Advanced Materials: Methods, 3(1), 2159753.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Pseudo-Voigt mixture model.
x              &lt;- seq(0, 100, by = 0.5)
K              &lt;- 3
true_mu        &lt;- c(35, 50, 65)
true_sigma     &lt;- c(3, 3, 3)
true_mix_ratio &lt;- c(0.5/3, 0.5/3, 0.5/3, 0.5)
true_eta       &lt;- c(0.4, 0.6, 0.1)
degree         &lt;- 4

#Normalized Pseudo-Voigt distribution
  truncated_pv &lt;- function(x, mu, sigma, eta) {
    (eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma)) /
      sum(eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma))
  }

y &lt;- c(true_mix_ratio[1]*truncated_pv(x = x,
                                      mu = true_mu[1],
                                      sigma = true_sigma[1],
                                      eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_pv(x = x,
                                      mu = true_mu[2],
                                      sigma = true_sigma[2],
                                      eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_pv(x = x,
                                      mu = true_mu[3],
                                      sigma = true_sigma[3],
                                      eta = true_eta[3])*10^degree +
       true_mix_ratio[4]*(c(500*x + 15000) / sum(500*x + 15000))*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
mu_init        &lt;- c(30, 40, 60)
sigma_init     &lt;- c(4, 4, 4)
mix_ratio_init &lt;- rep(1/(length(mu_init)+3), length(mu_init)+3)
eta_init       &lt;- c(1, 1, 1)

#Coducting calculation
SP_ECM_PV_LBACK_res &lt;- spect_em_pvmm_lback(x = x,
                                           y = y,
                                           mu = mu_init,
                                           sigma = sigma_init,
                                           eta = eta_init,
                                           mix_ratio = mix_ratio_init,
                                           x_lower = min(x),
                                           x_upper = max(x),
                                           conv.cri = 1e-2,
                                           maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_pvmm_lback_curve(spect_em_pvmm_lback_res = SP_ECM_PV_LBACK_res,
                      x = x,
                      y = y,
                      mix_ratio_init = mix_ratio_init,
                      mu_init = mu_init,
                      sigma_init = sigma_init,
                      eta_init = eta_init,
                      x_lower = min(x),
                      x_upper = max(x))


#Showing the result of spect_em_pvmm_lback()
print(cbind(SP_ECM_PV_LBACK_res$mu, SP_ECM_PV_LBACK_res$sigma, SP_ECM_PV_LBACK_res$eta,
            SP_ECM_PV_LBACK_res$mix_ratio[1:K]))

print(cbind(true_mu, true_sigma, true_eta, true_mix_ratio[1:K]))

</code></pre>

<hr>
<h2 id='spect_em_dsgmm'>Spectrum adapted ECM algorithm by DSGMM</h2><span id='topic+spect_em_dsgmm'></span>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted ECM algorithm by Doniach-Sunjic-Gauss mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spect_em_dsgmm(x, y, mu, sigma, alpha, eta, mix_ratio, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spect_em_dsgmm_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_mu">mu</code></td>
<td>
<p>mean of the components</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the components</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_alpha">alpha</code></td>
<td>
<p>asymmetric parameter of the component</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_eta">eta</code></td>
<td>
<p>mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_mix_ratio">mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_conv.cri">conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td></tr>
<tr><td><code id="spect_em_dsgmm_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted ECM algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated standard deviation of the components</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>estimated asymmetric parameter of the components</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>estimated mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td></tr>
<tr><td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td></tr>
<tr><td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td></tr>
<tr><td><code>SIGMA</code></td>
<td>
<p>variation of sigma</p>
</td></tr>
<tr><td><code>ALPHA</code></td>
<td>
<p>variation of alpha</p>
</td></tr>
<tr><td><code>ETA</code></td>
<td>
<p>variation of beta</p>
</td></tr>
<tr><td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td></tr>
<tr><td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td></tr>
<tr><td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td></tr>
</table>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Doniach-Sunjic-Gauss mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(20, 50, 80)
true_sigma      &lt;- c(3, 3, 3)
true_alpha      &lt;- c(0.1, 0.3, 0.1)
true_eta        &lt;- c(0.4, 0.6, 0.1)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#trancated Doniach-Sunjic-Gauss
truncated_dsg &lt;- function(x, mu, sigma, alpha, eta) {
                 ((eta*(((gamma(1-alpha)) /
                 ((x-mu)^2+(sqrt(2*log(2))*sigma)^2)^((1-alpha)/2)) *
                 cos((pi*alpha/2)+(1-alpha)*atan((x-mu) /
                 (sqrt(2*log(2))*sigma))))) + (1-eta)*dnorm(x, mu, sigma)) /
                 sum( ((eta*(((gamma(1-alpha)) /
                 ((x-mu)^2+(sqrt(2*log(2))*sigma)^2)^((1-alpha)/2)) *
                 cos((pi*alpha/2)+(1-alpha)*atan((x-mu) /
                 (sqrt(2*log(2))*sigma))))) + (1-eta)*dnorm(x, mu, sigma)))
}

y &lt;- c(true_mix_ratio[1]*truncated_dsg(x = x,
                                       mu = true_mu[1],
                                       sigma = true_sigma[1],
                                       alpha = true_alpha[1],
                                       eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_dsg(x = x,
                                       mu = true_mu[2],
                                       sigma = true_sigma[2],
                                       alpha = true_alpha[2],
                                       eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_dsg(x = x,
                                       mu = true_mu[3],
                                       sigma = true_sigma[3],
                                       alpha = true_alpha[3],
                                       eta = true_eta[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3
mix_ratio_init &lt;- c(0.2, 0.4, 0.4)
mu_init        &lt;- c(20, 40, 70)
sigma_init     &lt;- c(4, 3, 2)
alpha_init     &lt;- c(0.3, 0.2, 0.4)
eta_init       &lt;- c(0.5, 0.4, 0.3)

#Coducting calculation
SP_ECM_DSG_res &lt;- spect_em_dsgmm(x = x,
                                 y = y,
                                 mu = mu_init,
                                 sigma = sigma_init,
                                 alpha = alpha_init,
                                 eta = eta_init,
                                 mix_ratio = mix_ratio_init,
                                 conv.cri = 1e-2,
                                 maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_dsgmm_curve(SP_ECM_DSG_res,
                 x,
                 y,
                 mix_ratio_init,
                 mu_init,
                 sigma_init,
                 alpha_init,
                 eta_init)

#Showing the result of spect_em_dsgmm()
print(cbind(c(mu_init),
            c(sigma_init),
            c(alpha_init),
            c(eta_init),
            c(mix_ratio_init)))

print(cbind(SP_ECM_DSG_res$mu,
            SP_ECM_DSG_res$sigma,
            SP_ECM_DSG_res$alpha,
            SP_ECM_DSG_res$eta,
            SP_ECM_DSG_res$mix_ratio))

print(cbind(true_mu,
            true_sigma,
            true_alpha,
            true_eta,
            true_mix_ratio))
</code></pre>

<hr>
<h2 id='spect_em_gmm'>Spectrum adapted EM algorithm by GMM</h2><span id='topic+spect_em_gmm'></span>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted EM algorithm by Gaussian mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spect_em_gmm(x, y, mu, sigma, mix_ratio, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spect_em_gmm_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_mu">mu</code></td>
<td>
<p>mean of the components</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the components</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_mix_ratio">mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_conv.cri">conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td></tr>
<tr><td><code id="spect_em_gmm_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted EM algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated standard deviation of the components</p>
</td></tr>
<tr><td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td></tr>
<tr><td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td></tr>
<tr><td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td></tr>
<tr><td><code>SIGMA</code></td>
<td>
<p>variation of sigma</p>
</td></tr>
<tr><td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td></tr>
<tr><td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td></tr>
<tr><td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td></tr>
</table>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Gausian mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_sigma      &lt;- c(3, 3, 3)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

y &lt;- c(true_mix_ratio[1] * dnorm(x = x, mean = true_mu[1], sd = true_sigma[1])*10^degree +
       true_mix_ratio[2] * dnorm(x = x, mean = true_mu[2], sd = true_sigma[2])*10^degree +
       true_mix_ratio[3] * dnorm(x = x, mean = true_mu[3], sd = true_sigma[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
sigma_init      &lt;- c(2, 5, 4)

#Coducting calculation
SP_EM_G_res &lt;- spect_em_gmm(x, y, mu = mu_init, sigma = sigma_init, mix_ratio = mix_ratio_init,
                            conv.cri = 1e-2, maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_gmm_curve(SP_EM_G_res, x, y, mix_ratio_init, mu_init, sigma_init)

#Showing the result of spect_em_gmm()
print(cbind(c(mu_init), c(sigma_init), c(mix_ratio_init)))
print(cbind(SP_EM_G_res$mu, SP_EM_G_res$sigma, SP_EM_G_res$mix_ratio))
print(cbind(true_mu, true_sigma, true_mix_ratio))

</code></pre>

<hr>
<h2 id='spect_em_lmm'>Spectrum adapted ECM algorithm by LMM</h2><span id='topic+spect_em_lmm'></span>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted ECM algorithm by Lorentz mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spect_em_lmm(x, y, mu, gam, mix_ratio, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spect_em_lmm_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_mu">mu</code></td>
<td>
<p>mean of the components</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_gam">gam</code></td>
<td>
<p>scale parameter of the components</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_mix_ratio">mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_conv.cri">conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td></tr>
<tr><td><code id="spect_em_lmm_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted ECM algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td></tr>
<tr><td><code>gam</code></td>
<td>
<p>estimated scale parameter of the components</p>
</td></tr>
<tr><td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td></tr>
<tr><td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td></tr>
<tr><td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td></tr>
<tr><td><code>GAM</code></td>
<td>
<p>variation of gam</p>
</td></tr>
<tr><td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td></tr>
<tr><td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td></tr>
<tr><td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td></tr>
</table>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Lorentz mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_gam        &lt;- c(3, 3, 3)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#Normalized Lorentz distribution
dCauchy &lt;- function(x, mu, gam) {
    (dcauchy(x, mu, gam)) / sum(dcauchy(x, mu, gam))
  }

y &lt;- c(true_mix_ratio[1] * dCauchy(x = x, mu = true_mu[1], gam = true_gam[1])*10^degree +
       true_mix_ratio[2] * dCauchy(x = x, mu = true_mu[2], gam = true_gam[2])*10^degree +
       true_mix_ratio[3] * dCauchy(x = x, mu = true_mu[3], gam = true_gam[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
gam_init        &lt;- c(2, 5, 4)

#Coducting calculation
SP_ECM_L_res &lt;- spect_em_lmm(x, y, mu = mu_init, gam = gam_init, mix_ratio = mix_ratio_init,
                             conv.cri = 1e-2, maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_lmm_curve(SP_ECM_L_res, x, y, mix_ratio_init, mu_init, gam_init)

#Showing the result of spect_em_lmm()
print(cbind(c(mu_init), c(gam_init), c(mix_ratio_init)))
print(cbind(SP_ECM_L_res$mu, SP_ECM_L_res$gam, SP_ECM_L_res$mix_ratio))
print(cbind(true_mu, true_gam, true_mix_ratio))

</code></pre>

<hr>
<h2 id='spect_em_pvmm'>Spectrum adapted ECM algorithm by PVMM</h2><span id='topic+spect_em_pvmm'></span>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted ECM algorithm by Pseudo-Voigt mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spect_em_pvmm(x, y, mu, sigma, eta, mix_ratio, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spect_em_pvmm_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_mu">mu</code></td>
<td>
<p>mean of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_eta">eta</code></td>
<td>
<p>mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_mix_ratio">mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_conv.cri">conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted ECM algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated standard deviation of the components</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>estimated mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td></tr>
<tr><td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td></tr>
<tr><td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td></tr>
<tr><td><code>SIGMA</code></td>
<td>
<p>variation of sigma</p>
</td></tr>
<tr><td><code>ETA</code></td>
<td>
<p>variation of beta</p>
</td></tr>
<tr><td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td></tr>
<tr><td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td></tr>
<tr><td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td></tr>
</table>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Pseudo-Voigt mixture model.
x               &lt;- seq(0, 100, by = 0.5)
true_mu         &lt;- c(35, 50, 65)
true_sigma      &lt;- c(3, 3, 3)
true_eta        &lt;- c(0.3, 0.8, 0.5)
true_mix_ratio  &lt;- rep(1/3, 3)
degree          &lt;- 4

#Normalized Pseudo-Voigt distribution
  truncated_pv &lt;- function(x, mu, sigma, eta) {
    (eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma)) /
      sum(eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma))
  }

y &lt;- c(true_mix_ratio[1]*truncated_pv(x = x,
                                      mu = true_mu[1],
                                      sigma = true_sigma[1],
                                      eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_pv(x = x,
                                      mu = true_mu[2],
                                      sigma = true_sigma[2],
                                      eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_pv(x = x,
                                      mu = true_mu[3],
                                      sigma = true_sigma[3],
                                      eta = true_eta[3])*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
K &lt;- 3

mix_ratio_init  &lt;- c(0.2, 0.4, 0.4)
mu_init         &lt;- c(20, 40, 70)
sigma_init      &lt;- c(2, 5, 4)
eta_init        &lt;- c(0.5, 0.4, 0.3)

#Coducting calculation
SP_ECM_PV_res &lt;- spect_em_pvmm(x = x,
                               y = y,
                               mu = mu_init,
                               sigma = sigma_init,
                               eta = eta_init,
                               mix_ratio = mix_ratio_init,
                               conv.cri = 1e-2,
                               maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_pvmm_curve(SP_ECM_PV_res, x, y, mix_ratio_init, mu_init, sigma_init, eta_init)

#Showing the result of spect_em_pvmm()
print(cbind(c(mu_init), c(sigma_init), c(eta_init), c(mix_ratio_init)))
print(cbind(SP_ECM_PV_res$mu, SP_ECM_PV_res$sigma, SP_ECM_PV_res$eta, SP_ECM_PV_res$mix_ratio))
print(cbind(true_mu, true_sigma, true_eta, true_mix_ratio))

</code></pre>

<hr>
<h2 id='spect_em_pvmm_lback'>Spectrum adapted ECM algorithm by PVMM with a linear background</h2><span id='topic+spect_em_pvmm_lback'></span>

<h3>Description</h3>

<p>Perform a peak fitting based on the spectrum adapted ECM algorithm by pseudo-Voigt mixture model with a linear background.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spect_em_pvmm_lback(x, y, mu, sigma, eta, mix_ratio, x_lower, x_upper, conv.cri, maxit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spect_em_pvmm_lback_+3A_x">x</code></td>
<td>
<p>measurement steps</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_y">y</code></td>
<td>
<p>intensity</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_mu">mu</code></td>
<td>
<p>mean of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_sigma">sigma</code></td>
<td>
<p>standard deviation of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_eta">eta</code></td>
<td>
<p>mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_mix_ratio">mix_ratio</code></td>
<td>
<p>mixture ratio of the components</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_x_lower">x_lower</code></td>
<td>
<p>lower limit of the measurement steps. Default is a minimum of x</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_x_upper">x_upper</code></td>
<td>
<p>upper limit of the measurement steps. Default is a maximum of x</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_conv.cri">conv.cri</code></td>
<td>
<p>criterion of the convergence</p>
</td></tr>
<tr><td><code id="spect_em_pvmm_lback_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of the iteration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Peak fitting is conducted by spectrum adapted ECM algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>estimated mean of the components</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated standard deviation of the components</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>estimated mixing ratio of Gauss and Lorentz distribution</p>
</td></tr>
<tr><td><code>mix_ratio</code></td>
<td>
<p>estimated mixture ratio of the components</p>
</td></tr>
<tr><td><code>it</code></td>
<td>
<p>number of the iteration to reach the convergence</p>
</td></tr>
<tr><td><code>LL</code></td>
<td>
<p>variation of the weighted log likelihood values</p>
</td></tr>
<tr><td><code>MU</code></td>
<td>
<p>variation of mu</p>
</td></tr>
<tr><td><code>SIGMA</code></td>
<td>
<p>variation of sigma</p>
</td></tr>
<tr><td><code>ETA</code></td>
<td>
<p>variation of beta</p>
</td></tr>
<tr><td><code>MIX_RATIO</code></td>
<td>
<p>variation of mix_ratio</p>
</td></tr>
<tr><td><code>W_K</code></td>
<td>
<p>decomposed component of the spectral data </p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>message for the convergence in the calculation</p>
</td></tr>
<tr><td><code>cal_time</code></td>
<td>
<p>calculation time to complete the peak fitting. Unit is seconds</p>
</td></tr>
</table>


<h3>References</h3>

<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2019). Spectrum adapted expectation-maximization algorithm for high-throughput peak shift analysis. Science and technology of advanced materials, 20(1), 733-745.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2021). Spectrum adapted expectation-conditional maximization algorithm for extending high–throughput peak separation method in XPS analysis. Science and Technology of Advanced Materials: Methods, 1(1), 45-55.
</p>
<p>Matsumura, T., Nagamura, N., Akaho, S., Nagata, K., &amp; Ando, Y. (2023). High-throughput XPS spectrum modeling with autonomous background subtraction for 3 d 5/2 peak mapping of SnS. Science and Technology of Advanced Materials: Methods, 3(1), 2159753.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generating the synthetic spectral data based on three component Pseudo-Voigt mixture model.
x              &lt;- seq(0, 100, by = 0.5)
K              &lt;- 3
true_mu        &lt;- c(35, 50, 65)
true_sigma     &lt;- c(3, 3, 3)
true_mix_ratio &lt;- c(0.5/3, 0.5/3, 0.5/3, 0.5)
true_eta       &lt;- c(0.4, 0.6, 0.1)
degree         &lt;- 4

#Normalized Pseudo-Voigt distribution
  truncated_pv &lt;- function(x, mu, sigma, eta) {
    (eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma)) /
      sum(eta*dcauchy(x, mu, sqrt(2*log(2))*sigma) + (1-eta)*dnorm(x, mu, sigma))
  }

y &lt;- c(true_mix_ratio[1]*truncated_pv(x = x,
                                      mu = true_mu[1],
                                      sigma = true_sigma[1],
                                      eta = true_eta[1])*10^degree +
       true_mix_ratio[2]*truncated_pv(x = x,
                                      mu = true_mu[2],
                                      sigma = true_sigma[2],
                                      eta = true_eta[2])*10^degree +
       true_mix_ratio[3]*truncated_pv(x = x,
                                      mu = true_mu[3],
                                      sigma = true_sigma[3],
                                      eta = true_eta[3])*10^degree +
       true_mix_ratio[4]*(c(500*x + 15000) / sum(500*x + 15000))*10^degree)

plot(y~x, main = "genrated synthetic spectral data")

#Peak fitting by EMpeaksR
#Initial values
mu_init        &lt;- c(30, 40, 60)
sigma_init     &lt;- c(4, 4, 4)
mix_ratio_init &lt;- rep(1/(length(mu_init)+3), length(mu_init)+3)
eta_init       &lt;- c(1, 1, 1)

#Coducting calculation
SP_ECM_PV_LBACK_res &lt;- spect_em_pvmm_lback(x = x,
                                           y = y,
                                           mu = mu_init,
                                           sigma = sigma_init,
                                           eta = eta_init,
                                           mix_ratio = mix_ratio_init,
                                           x_lower = min(x),
                                           x_upper = max(x),
                                           conv.cri = 1e-2,
                                           maxit = 2000)

#Plot fitting curve and trace plot of parameters
show_pvmm_lback_curve(spect_em_pvmm_lback_res = SP_ECM_PV_LBACK_res,
                      x = x,
                      y = y,
                      mix_ratio_init = mix_ratio_init,
                      mu_init = mu_init,
                      sigma_init = sigma_init,
                      eta_init = eta_init,
                      x_lower = min(x),
                      x_upper = max(x))

#Showing the result of spect_em_pvmm_lback()
print(cbind(SP_ECM_PV_LBACK_res$mu, SP_ECM_PV_LBACK_res$sigma, SP_ECM_PV_LBACK_res$eta,
            SP_ECM_PV_LBACK_res$mix_ratio[1:K]))

print(cbind(true_mu, true_sigma, true_eta, true_mix_ratio[1:K]))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
