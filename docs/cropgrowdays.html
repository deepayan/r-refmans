<!DOCTYPE html><html><head><title>Help for package cropgrowdays</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cropgrowdays}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cropgrowdays-package'><p>Cropgrowdays: Agrometeorological calculations for crops</p></a></li>
<li><a href='#boonah'><p>SILO weather data extracted for Boonah SE Queensland</p></a></li>
<li><a href='#crop'><p>Crop data containing hypothetical sowing flowering and harvest dates</p></a></li>
<li><a href='#cumulative'><p>Sum of a weather variable between between two dates</p></a></li>
<li><a href='#daily_mean'><p>Mean of daily weather variable values between two dates</p></a></li>
<li><a href='#date_from_day_year'><p>Calculate a date from the day of the year and the year</p></a></li>
<li><a href='#day_of_harvest'><p>The day of harvest in the year of sowing</p></a></li>
<li><a href='#day_of_year'><p>Calculate day of year from a date</p></a></li>
<li><a href='#get_multi_silodata'><p>Retrieve SILO data for multiple sites from Qld DES longpaddock website</p></a></li>
<li><a href='#get_silodata'><p>Retrieve weather data from Queensland Government DES longpaddock website</p></a></li>
<li><a href='#growing_degree_days'><p>Degree days as the sum of capped average daily temperature above a baseline value</p></a></li>
<li><a href='#number_of_days'><p>The number of days between two dates</p></a></li>
<li><a href='#stress_days_over'><p>The number of days that maximum temp is over a baseline value</p></a></li>
<li><a href='#two_sites'><p>SILO weather data extracted for two arbitrary sites</p></a></li>
<li><a href='#weather_extract'><p>Extract one or more columns of weather data between two dates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Crop Growing Degree Days and Agrometeorological Calculations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate agrometeorological variables for crops
             including growing degree days (McMaster, GS &amp; Wilhelm, WW
             (1997) &lt;<a href="https://doi.org/10.1016%2FS0168-1923%2897%2900027-0">doi:10.1016/S0168-1923(97)00027-0</a>&gt;), cumulative
             rainfall, number of stress days and cumulative or mean
             radiation and evaporation. Convert dates to day of year
             and vice versa. Also, download curated and interpolated
             Australian weather data from the Queensland Government
             DES longpaddock website
             <a href="https://www.longpaddock.qld.gov.au/">https://www.longpaddock.qld.gov.au/</a>. This data is
             freely available under the Creative Commons 4.0 licence.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/petebaker/cropgrowdays/">https://gitlab.com/petebaker/cropgrowdays/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/petebaker/cropgrowdays/-/issues">https://gitlab.com/petebaker/cropgrowdays/-/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lubridate, dplyr, tibble, purrr, purrrlyr, httr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, furrr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-12 14:09:11 UTC; pete</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Baker <a href="https://orcid.org/0000-0002-1241-7263"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Miranda Mortlock <a href="https://orcid.org/0000-0001-7029-9827"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Baker &lt;drpetebaker@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-12 14:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='cropgrowdays-package'>Cropgrowdays: Agrometeorological calculations for crops</h2><span id='topic+cropgrowdays'></span><span id='topic+cropgrowdays-package'></span>

<h3>Description</h3>

<p>Weather related calculations for crops are provided for a
specified period including growing degree days, cumulative weather
variables, the number of stress days over a baseline temperature
and mean daily weather. Additionally, a function is provided to
download historical Australian weather data from the Queensland
Government DES longpaddock website.
</p>


<h3>Agrometeorological calculation functions</h3>

<p>This package provides the calculation functions
<code><a href="#topic+cumulative">cumulative</a></code>, <code><a href="#topic+growing_degree_days">growing_degree_days</a></code>,
<code><a href="#topic+stress_days_over">stress_days_over</a></code> and <code><a href="#topic+daily_mean">daily_mean</a></code>. These
functions employ <code><a href="#topic+weather_extract">weather_extract</a></code> which can be used
to extract column(s) or variable(s) between two specified dates
which can also be employed directly.
</p>


<h3>Day of year calculations</h3>

<p>Day of year can be calculated from a <code>date</code> using
<code><a href="#topic+day_of_year">day_of_year</a></code> and the calculation reversed using
<code><a href="#topic+date_from_day_year">date_from_day_year</a></code>. Since a crop may be harvested in
a different year than it is sown, then the harvest day of year in
which it is sown may be more appropriate and can be obtained with
<code><a href="#topic+day_of_harvest">day_of_harvest</a></code>.
</p>


<h3>Downloading SILO data</h3>

<p>The function <code><a href="#topic+get_silodata">get_silodata</a></code> and is available to
retrieve SILO weather data for one location from Queensland
Government DES longpaddock website
<a href="https://www.longpaddock.qld.gov.au/">https://www.longpaddock.qld.gov.au/</a>. Use
<code><a href="#topic+get_multi_silodata">get_multi_silodata</a></code> to retrieve multiple locations.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Peter Baker <a href="mailto:drpetebaker@gmail.com">drpetebaker@gmail.com</a> (<a href="https://orcid.org/0000-0002-1241-7263">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Miranda Mortlock <a href="mailto:miranda.mortlock@qut.edu.au">miranda.mortlock@qut.edu.au</a> (<a href="https://orcid.org/0000-0001-7029-9827">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://gitlab.com/petebaker/cropgrowdays/">https://gitlab.com/petebaker/cropgrowdays/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://gitlab.com/petebaker/cropgrowdays/-/issues">https://gitlab.com/petebaker/cropgrowdays/-/issues</a>
</p>
</li></ul>


<hr>
<h2 id='boonah'>SILO weather data extracted for Boonah SE Queensland</h2><span id='topic+boonah'></span>

<h3>Description</h3>

<p>A dataset containing daily weather data in APSIM format for Boonah
at -27.9927 S, 152.6906 E for the period 1 Jan 2019 to 31 May
2020.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boonah
</code></pre>


<h3>Format</h3>

<p>A data frame with 517 rows and 10 variables:
</p>

<dl>
<dt>year</dt><dd><p>Year</p>
</dd>
<dt>day</dt><dd><p>Day</p>
</dd>
<dt>radn</dt><dd><p>Radiation (MJ/m^2)</p>
</dd>
<dt>maxt</dt><dd><p>Max Temperature (degrees C)</p>
</dd>
<dt>mint</dt><dd><p>Min Temperature (degrees C)</p>
</dd>
<dt>rain</dt><dd><p>Rainfall (mm)</p>
</dd>
<dt>evap</dt><dd><p>Evaporation (mm)</p>
</dd>
<dt>vp</dt><dd><p>Vapour Pressure (hPa)</p>
</dd>
<dt>code</dt><dd><p>Source Code is a six digit string describing the
source of the meteorological data where each digit is either 0,
an actual observation; 1, an actual observation from a
composite station; 2, a value interpolated from daily
observations; 3, a value interpolated from daily observations
using the anomaly interpolation method for CLIMARC data; 6, a
synthetic pan value; or 7, an interpolated long term average</p>
</dd>
<dt>date_met</dt><dd><p>The date on which daily weather was collected</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data were obtained using
</p>
<p><code>boonah &lt;-
     get_silodata(latitude = "-27.9927", longitude = "152.6906",
               email = "MY_EMAIL_ADDRESS", START = "20190101", FINISH = "20200531")</code>
</p>
<p>where &ldquo;MY_EMAIL_ADDRESS&rdquo; was replaced with an appropriate
address.
</p>


<h3>Source</h3>

<p>Meteorological SILO data obtained from the Longpaddock Qld Government
web site <a href="https://www.longpaddock.qld.gov.au">https://www.longpaddock.qld.gov.au</a> for Boonah
-27.9927 S, 152.6906 E for the period 1 Jan 2019 to 31 May 2020.
</p>

<hr>
<h2 id='crop'>Crop data containing hypothetical sowing flowering and harvest dates</h2><span id='topic+crop'></span>

<h3>Description</h3>

<p>A dataset containing typical dates for agronomic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crop
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 3 variables:
</p>

<dl>
<dt>sowing_date</dt><dd><p>Sowing date of crop</p>
</dd>
<dt>flower_date</dt><dd><p>Flowering date of crop</p>
</dd>
<dt>harvest_date</dt><dd><p>Harvest date of crop</p>
</dd>
</dl>



<h3>Details</h3>

<p>Typical dates for crop data sets that would typically contain
agronomic traits such as yield, dry matter yield and so
on. However, here the dataset only contains dates which are used
to demonstrate how to add computed weather variables either
starting or ending at a specified date or between two dates.
</p>


<h3>Source</h3>

<p>Hypothetical sowing, flowering and harvest dates based on typical horticultural crops in Queensland
</p>

<hr>
<h2 id='cumulative'>Sum of a weather variable between between two dates</h2><span id='topic+cumulative'></span>

<h3>Description</h3>

<p>Calculates the sum or total of daily values between two dates from
a tibble or data frame of daily weather data. Alternatively, a
number of days before or after a specific date may be
specified. Typically this is used for solar radiation, evaporation
or rainfall since the total rainfall, radiation or evaporation
during a specified period may prove useful for modelling yield or
plant growth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumulative(
  data,
  var = NULL,
  datevar = NULL,
  ndays = 5,
  na.rm = FALSE,
  startdate = NULL,
  enddate = NULL,
  monitor = FALSE,
  warn.consecutive = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumulative_+3A_data">data</code></td>
<td>
<p>Tibble or dataframe of daily weather data</p>
</td></tr>
<tr><td><code id="cumulative_+3A_var">var</code></td>
<td>
<p>Variable(s) to be extracted (Default: radn). Several columns
may be specified using column names <code>c(variable1, variable2, ...)</code></p>
</td></tr>
<tr><td><code id="cumulative_+3A_datevar">datevar</code></td>
<td>
<p>Date variable specifying day (Default: date_met)</p>
</td></tr>
<tr><td><code id="cumulative_+3A_ndays">ndays</code></td>
<td>
<p>Number of days after/before the start or end date,
respectively. Ignored of both the start and end dates are
specified (Default: 5)</p>
</td></tr>
<tr><td><code id="cumulative_+3A_na.rm">na.rm</code></td>
<td>
<p>Used for calculations (Default: FALSE)</p>
</td></tr>
<tr><td><code id="cumulative_+3A_startdate">startdate</code></td>
<td>
<p>Start date of data to be extracted</p>
</td></tr>
<tr><td><code id="cumulative_+3A_enddate">enddate</code></td>
<td>
<p>Final date of data to be extracted</p>
</td></tr>
<tr><td><code id="cumulative_+3A_monitor">monitor</code></td>
<td>
<p>For debugging. Prints data and dates. (Default:
FALSE)</p>
</td></tr>
<tr><td><code id="cumulative_+3A_warn.consecutive">warn.consecutive</code></td>
<td>
<p>A logical indicating whether to check that
dates are consecutive, that none are missing and provide a warning if
not (Default:TRUE)</p>
</td></tr>
<tr><td><code id="cumulative_+3A_...">...</code></td>
<td>
<p>options to be passed to <code>sum</code> calculation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sum is returned but if there are any missing values, then the
sum is set to <code>NA</code> since the default <code>na.rm</code> is
<code>TRUE</code>. Note that if there are any missing dates, then a
warning is issued but the sum of non-missing values is returned.
</p>
<p>If any values are missing, while the calculated sum or total may
prove useful, it will not include all the data and so may lead to
biased underestimates. Hence, in these cases it may be unlikely
that the sum is a good estimate but the appropriateness of the
estimate will depend on the exact circumstances of the missing
data and so this decision is left to the user.
</p>


<h3>Value</h3>

<p>Numeric variable containing the sum of all values of the
weather variable <code>var</code> during the specified period.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sum">sum</a></code>, <code><a href="#topic+daily_mean">daily_mean</a></code>,
<code><a href="#topic+growing_degree_days">growing_degree_days</a></code>,
<code><a href="#topic+stress_days_over">stress_days_over</a></code>, and
<code><a href="#topic+weather_extract">weather_extract</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Selected calculations
## library(tidyverse)   # purrr used here for crop2 example
library(dplyr)
library(purrr)
cumulative(boonah, enddate = crop$flower_date[4], ndays = 3,
                    monitor = TRUE)
cumulative(boonah, enddate = crop$harvest_date[4], ndays = 3,
                    monitor = TRUE)
cumulative(boonah, startdate = crop$flower_date[4],
                    enddate = crop$harvest_date[4], monitor = TRUE)
cumulative(boonah, startdate = crop$flower_date[4],
                    enddate = crop$harvest_date[4])
cumulative(boonah, var = rain, startdate = crop$flower_date[4],
                    enddate = crop$harvest_date[4])

## Add selected totals of weather variables in 'boonah' to 'crop'' tibble
## using 'map2_dbl' from the 'purrr' package
## Note: using equivalent 'furrr' functions can speed up calculations 
crop2 &lt;- crop |&gt;
  dplyr::mutate(totalrain_post_sow_7d =
          purrr::map_dbl(sowing_date, function(x)
            cumulative(boonah, var = rain, startdate = x, ndays = 7)),
          totalrad_flower_harvest =
            purrr::map2_dbl(flower_date, harvest_date, function(x, y)
              cumulative(boonah, var = radn, startdate = x, enddate = y)))
crop2
</code></pre>

<hr>
<h2 id='daily_mean'>Mean of daily weather variable values between two dates</h2><span id='topic+daily_mean'></span>

<h3>Description</h3>

<p>Calculates the average of daily values of the variable between two
dates from a tibble or data frame of daily weather
data. Alternatively, a number of days before or after a specific
date may be specified. Typically this would be used for
temperature, rainfall or solar radiation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daily_mean(
  data,
  var = NULL,
  datevar = NULL,
  ndays = 5,
  na.rm = FALSE,
  startdate = NULL,
  enddate = NULL,
  monitor = FALSE,
  warn.consecutive = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daily_mean_+3A_data">data</code></td>
<td>
<p>Tibble or dataframe of daily weather data</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_var">var</code></td>
<td>
<p>Variable(s) to be extracted (Default: radn). Several columns
may be specified using column names <code>c(variable1, variable2, ...)</code></p>
</td></tr>
<tr><td><code id="daily_mean_+3A_datevar">datevar</code></td>
<td>
<p>Date variable specifying day (Default: date_met)</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_ndays">ndays</code></td>
<td>
<p>Number of days after/before the start or end date,
respectively. Ignored of both the start and end dates are
specified (Default: 5)</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>Used for calculations (Default: FALSE)</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_startdate">startdate</code></td>
<td>
<p>Start date of data to be extracted</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_enddate">enddate</code></td>
<td>
<p>Final date of data to be extracted</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_monitor">monitor</code></td>
<td>
<p>For debugging. Prints data and dates. (Default:
FALSE)</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_warn.consecutive">warn.consecutive</code></td>
<td>
<p>A logical indicating whether to check that
dates are consecutive, that none are missing and provide a warning if
not (Default:TRUE)</p>
</td></tr>
<tr><td><code id="daily_mean_+3A_...">...</code></td>
<td>
<p>options to be passed to <code>mean</code> calculation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mean is returned but if there are any missing values, then the
mean is set to <code>NA</code> since the default <code>na.rm</code> is
<code>TRUE</code>. Note that if there are any missing dates, then a
warning is issued but the mean of non-missing values is returned.
</p>
<p>If any values are missing, while the calculated mean may prove
useful, it will not include all the data and so may lead to biased
estimates. Hence, in these cases, the appropriateness of the
estimate will depend on the exact circumstances of the missing
data and so this decision is left to the user.
</p>


<h3>Value</h3>

<p>Numeric variable containing the daily mean of the weather
variable <code>var</code> during the specified period.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+mean">mean</a></code>, <code><a href="#topic+cumulative">cumulative</a></code>,
<code><a href="#topic+growing_degree_days">growing_degree_days</a></code>,
<code><a href="#topic+stress_days_over">stress_days_over</a></code>, and
<code><a href="#topic+weather_extract">weather_extract</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##  Selected calculations
## library(tidyverse)   # only purrr used here for crop2 example
library(dplyr)
library(purrr)
daily_mean(boonah, enddate = crop$flower_date[4], ndays = 3,
                    monitor = TRUE)
daily_mean(boonah, enddate = crop$harvest_date[4], ndays = 3,
                    monitor = TRUE)
daily_mean(boonah, startdate = crop$flower_date[4],
                    enddate = crop$harvest_date[4], monitor = TRUE)

## Add selected daily means of weather variables in 'boonah' to 'crop'
## tibble using 'map2_dbl' from the 'purrr' package
## Note: using equivalent 'furrr' functions can speed up calculations 
crop2 &lt;- crop |&gt;
  mutate(mean_maxtemp_post_sow_7d =
          purrr::map_dbl(sowing_date, function(x)
            daily_mean(boonah, var = maxt, startdate = x, ndays = 7)),
          mean_rad_flower_harvest =
            purrr::map2_dbl(flower_date, harvest_date, function(x, y)
              daily_mean(boonah, var = radn, startdate = x, enddate = y)))
crop2

</code></pre>

<hr>
<h2 id='date_from_day_year'>Calculate a date from the day of the year and the year</h2><span id='topic+date_from_day_year'></span>

<h3>Description</h3>

<p><code>date_from_day_of_year</code> returns the date using the day of the
year and a year for a calendar or financial year. The first day of
the year is 1 January for the calendar year, 1 July for the
Australian financial year or can be specified. Alternatively, the
first day of the year can be any day of the year if desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date_from_day_year(
  day,
  year,
  type = c("calendar", "financial", "other"),
  base = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date_from_day_year_+3A_day">day</code></td>
<td>
<p>Day as an <code>numeric</code> (integer) used for calculation
the date</p>
</td></tr>
<tr><td><code id="date_from_day_year_+3A_year">year</code></td>
<td>
<p>Year as an <code>integer</code> (integer) used for
calculation the date</p>
</td></tr>
<tr><td><code id="date_from_day_year_+3A_type">type</code></td>
<td>
<p>A character string specifying the type of
year. &ldquo;calendar&rdquo; is a calendar year starting on 1
January, &ldquo;financial&rdquo; an Australian financial year
beginning on 1 July and &ldquo;other&rdquo; is for a year starting on
another date which is specified in <code>base</code>. Default:
&ldquo;calendar&rdquo;</p>
</td></tr>
<tr><td><code id="date_from_day_year_+3A_base">base</code></td>
<td>
<p>A <code>list</code> specifying the day and month of the
first day to be used in calculations. The name of the day
component must be named either &ldquo;day&rdquo; or &ldquo;d&rdquo;, and
the month must be named either &ldquo;month&rdquo; or &ldquo;m&rdquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A date of class <code><a href="base.html#topic+Date">Date</a></code> calculated from
the day of the year and the year
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
date_from_day_year(day = 366, year = 2020)
date_from_day_year(21,2021)
date_from_day_year(day = c(21, 24, 30), year = rep(2021, 3))
date_from_day_year(21,2021, type = "financial")
date_from_day_year(21,2021, type = "other", base = list(d=1, m=9))
</code></pre>

<hr>
<h2 id='day_of_harvest'>The day of harvest in the year of sowing</h2><span id='topic+day_of_harvest'></span>

<h3>Description</h3>

<p><code>day_of_harvest</code> calculates the day of year of harvest (or
another quantity such as petal fall) if harvest occurs in the next
year after sowing. For instance, if the sowing date is near the
end of the year, then the harvest date will fall in the next year.
Hence, the harvest day (as a day of year) will be be smaller than
the sowing date (as a day of the year). The <code>day_of_harvest</code>
function rectifies this situation by calculating the harvest date
as the day of year in the previous year. Hence, the resulting day
of year will be greater than 366. Of course, this is not necessary
if the sowing and harvest dates are in the same year, in which
case <code><a href="#topic+day_of_year">day_of_year</a></code> will provide exactly the same
result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>day_of_harvest(
  x,
  sowing,
  type = c("calendar", "financial", "other"),
  base = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="day_of_harvest_+3A_x">x</code></td>
<td>
<p>A harvest <code><a href="base.html#topic+Date">Date</a></code> used for calculation of the day of the year.</p>
</td></tr>
<tr><td><code id="day_of_harvest_+3A_sowing">sowing</code></td>
<td>
<p>A sowing <code><a href="base.html#topic+Date">Date</a></code> used for calculation.</p>
</td></tr>
<tr><td><code id="day_of_harvest_+3A_type">type</code></td>
<td>
<p>A character string specifying the type of
year. &ldquo;calendar&rdquo; is a calendar year starting on 1
January, &ldquo;financial&rdquo; an Australian financial year
beginning on 1 July and &ldquo;other&rdquo; is for a year starting on
another date which is specified in <code>base</code>. Default:
&ldquo;calendar&rdquo;</p>
</td></tr>
<tr><td><code id="day_of_harvest_+3A_base">base</code></td>
<td>
<p>A <code>list</code> specifying the day and month of the
first day to be used in calculations. The name of the day
component must be named either &ldquo;day&rdquo; or &ldquo;d&rdquo;, and
the month must be named either &ldquo;month&rdquo; or &ldquo;m&rdquo;.</p>
</td></tr>
<tr><td><code id="day_of_harvest_+3A_verbose">verbose</code></td>
<td>
<p>Logical to indicate whether to indicate data errors.
(Default:FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>numeric</code> vector containing the day of harvest in
the year of sowing which will differ from the day of harvest if
the sowing date is in the previous year
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
day_of_harvest(x = ymd("2020-06-15"), sowing = ymd("2020-06-01")) # leap year
day_of_harvest(x = ymd("2021-06-15"), sowing = ymd("2021-06-01")) # not
day_of_harvest(x = ymd("2021-06-15"), sowing = ymd("2020-06-01")) # 366+166
day_of_harvest(x = ymd("2021-02-05"), sowing = ymd("2021-01-28"))
day_of_harvest(x = ymd("2021-02-05"), sowing = ymd("2021-01-28"),
               type = "financial")
day_of_harvest(x = ymd("2021-09-05"), sowing = ymd("2021-01-28"),
               type = "financial") # 67 + 365
## number_of_days(ymd("2021-02-05"), ymd("2020-09-01")) + 1
day_of_harvest(x = ymd("2021-02-05"), sowing = ymd("2021-01-28"),
               type = "other", base = list(m = 9, day = 1))
</code></pre>

<hr>
<h2 id='day_of_year'>Calculate day of year from a date</h2><span id='topic+day_of_year'></span>

<h3>Description</h3>

<p><code>day_of_year</code> returns the day of the year as an integer. The
first day of the year is 1 January for the calendar year, 1 July
for the Australian financial year or can be specified as any day
of the year if desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>day_of_year(
  x,
  type = c("calendar", "financial", "other"),
  return_year = FALSE,
  base = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="day_of_year_+3A_x">x</code></td>
<td>
<p>A <code>date</code> used for calculation the day of the year.</p>
</td></tr>
<tr><td><code id="day_of_year_+3A_type">type</code></td>
<td>
<p>A character string specifying the type of
year. &ldquo;calendar&rdquo; is a calendar year starting on 1
January, &ldquo;financial&rdquo; an Australian financial year
beginning on 1 July and &ldquo;other&rdquo; is for a year starting on
another date which is specified in <code>base</code>. Default:
&ldquo;calendar&rdquo;</p>
</td></tr>
<tr><td><code id="day_of_year_+3A_return_year">return_year</code></td>
<td>
<p>A logical indicating whether to return the year
or not. Default: FALSE</p>
</td></tr>
<tr><td><code id="day_of_year_+3A_base">base</code></td>
<td>
<p>A <code>list</code> specifying the day and month of the
first day to be used in calculations. The name of the day
component must be named either &ldquo;day&rdquo; or &ldquo;d&rdquo;, and
the month must be named either &ldquo;month&rdquo; or &ldquo;m&rdquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing day of the year. If
<code>return_year</code> is TRUE then a <code><a href="base.html#topic+data.frame">data.frame</a></code> is
returned containing two columns <code>day</code> and <code>year</code>. The
first column <code>day</code> is always numeric but the class of the
<code>year</code> column depends on <code>type</code>. For <code>type</code>
&ldquo;calendar&rdquo;, &ldquo;financial&rdquo;, &ldquo;other&rdquo; then
<code>year</code> is numeric, character and the base date as a
<code><a href="base.html#topic+Date">Date</a></code>, respectively.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+date_from_day_year">date_from_day_year</a></code> for converting day of
year and year to a <code><a href="base.html#topic+Date">Date</a></code> and
<code><a href="#topic+day_of_harvest">day_of_harvest</a></code> for calculating the day of harvest
given a sowing date where the start of the year is the first day
of the year which contains the sowing date
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
## Day of Calendar Year
day_of_year(ymd("2020-01-05"))
day_of_year(ymd("2021-01-05"))
day_of_year(ymd(c("2020-06-05"), "2021-06-05")) # 29 Feb in 2020 only
day_of_year(ymd("2020-12-31"))
day_of_year(ymd("2021-12-31"))
day_of_year(ymd("2020-12-31"), return_year = TRUE)
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")))
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")),
            return_year = TRUE)

## Day of Financial Year
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")),
            type = "financial")
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")),
            type = "financial", return_year = TRUE)
day_of_year(x = ymd("2021-09-05"), type = "financial") # 67

## Specify the year starts on 1 September
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")),
            type = "other", base = list(d = 1, m = 9))
day_of_year(ymd(c("2020-12-31", "2020-07-01", "2020-01-01")),
            type = "other", base = list(d = 1, m = 9), return_year = TRUE)

</code></pre>

<hr>
<h2 id='get_multi_silodata'>Retrieve SILO data for multiple sites from Qld DES longpaddock website</h2><span id='topic+get_multi_silodata'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+get_silodata">get_silodata</a></code> to retrieve SILO (Scientific
Information for Land Owners) data for multiple sites. SILO
products are provided free of charge to the public for use under
the Creative Commons Attribution 4.0 license and appear to be
subject to fair use limits. Note that SILO may be unavailable
between 11am and 1pm (Brisbane time) each Wednesday and Thursday
to allow for essential system maintenance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_multi_silodata(
  latitude,
  longitude,
  Sitename,
  email,
  START = "20201101",
  FINISH = "20201231",
  FORMAT = "apsim",
  PASSWORD = "apitest",
  URL = "https://www.longpaddock.qld.gov.au/cgi-bin/silo/DataDrillDataset.php"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_multi_silodata_+3A_latitude">latitude</code></td>
<td>
<p>A numerical vector containing site latitudes for
data retrieval</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_longitude">longitude</code></td>
<td>
<p>A numerical vector containing site longitudes for
data retrieval</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_sitename">Sitename</code></td>
<td>
<p>A vector of strings containing site names or
labels which provide an extra column in the dataset named
<code>Sitename</code></p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_email">email</code></td>
<td>
<p>A string containing your email which is required by
DES in order to access the data</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_start">START</code></td>
<td>
<p>Start date as a character string &ldquo;YYYYMMDD&rdquo;
with no spaces. Default: &ldquo;20201101&rdquo;</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_finish">FINISH</code></td>
<td>
<p>Last date as a character string &ldquo;YYYYMMDD&rdquo;
with no spaces. Default: &ldquo;20201231&rdquo;</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_format">FORMAT</code></td>
<td>
<p>of data file required. While this function was
originally constructed to obtain <code>apsim</code> format, other
formats are now available but not as tested.  <code>rainman</code> is
not included since it returns six separate files. See
<a href="https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/">https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/</a>
Default: &ldquo;apsim&rdquo;</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_password">PASSWORD</code></td>
<td>
<p>Default: &ldquo;apitest&rdquo;</p>
</td></tr>
<tr><td><code id="get_multi_silodata_+3A_url">URL</code></td>
<td>
<p>is the URL for querying the website and probably will
not need to be changed. Default:
&ldquo;https://www.longpaddock.qld.gov.au/cgi-bin/silo/DataDrillDataset.php&rdquo;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="dplyr.html#topic+tibble">tibble</a></code> (dataframe) containing specified or
default climate variables. If &ldquo;APSIM&rdquo; format is specified
then an extra column <code>date_met</code>, containing the date, is
returned along with the usual <code>year</code> and day of year
<code>day</code>. The <code>Sitename</code> variable contains the name of
each site.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_silodata">get_silodata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example: Replace MY_EMAIL_ADDRESS with your email address below
two_sites  &lt;-
  get_multi_silodata(latitude = c(-27.00, -28.00),
                     longitude = c(151.00, 152.00),
                     Sitename = c("Site_1", "Site_2"),
                     START = "20201101", FINISH = "20201105",
                     FORMAT = "allmort",
                     email = "MY_EMAIL_ADDRESS")
two_sites

## End(Not run)

</code></pre>

<hr>
<h2 id='get_silodata'>Retrieve weather data from Queensland Government DES longpaddock website</h2><span id='topic+get_silodata'></span>

<h3>Description</h3>

<p>SILO (Scientific Information for Land Owners) is a database of
Australian climate data from 1889 (current to yesterday). It
provides data sets for a range of climate variables. SILO is
hosted by the Science and Technology Division of the Queensland
Government's Department of Environment and Science (DES). For more
information please see
<a href="https://www.longpaddock.qld.gov.au/silo/about">https://www.longpaddock.qld.gov.au/silo/about</a>. A number of
data formats are available via the <code>FORMAT</code> option, but we
have mainly used the &ldquo;apsim&rdquo; format. Other formats may be
retrieved but these are largely untested. Please lodge an issue if
there are problems. For details, please see
<a href="https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/">https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/</a>.
SILO products are provided free of charge to the public for use
under the Creative Commons Attribution 4.0 license and appear to
be subject to fair use limits. Note that SILO may be unavailable
between 11am and 1pm (Brisbane time) each Wednesday and Thursday
to allow for essential system maintenance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_silodata(
  latitude,
  longitude,
  email,
  START = "20201101",
  FINISH = "20201231",
  FORMAT = c("apsim", "fao56", "standard", "allmort", "ascepm", "evap_span", "span",
    "all2016", "alldata", "p51", "rainonly", "monthly", "cenw"),
  PASSWORD = "apitest",
  extras = NULL,
  URL = "https://www.longpaddock.qld.gov.au/cgi-bin/silo/DataDrillDataset.php"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_silodata_+3A_latitude">latitude</code></td>
<td>
<p>A number or character string of the site latitude
for data retrieval</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_longitude">longitude</code></td>
<td>
<p>A number or character string of the site
longitude for data retrieval</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_email">email</code></td>
<td>
<p>A string containing your email which is required by
DES in order to access the data</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_start">START</code></td>
<td>
<p>Start date as a character string &ldquo;YYYYMMDD&rdquo;
with no spaces. Default: &ldquo;20201101&rdquo;</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_finish">FINISH</code></td>
<td>
<p>Last date as a character string &ldquo;YYYYMMDD&rdquo;
with no spaces. Default: &ldquo;20201231&rdquo;</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_format">FORMAT</code></td>
<td>
<p>of data file required. While this function was
originally constructed to obtain <code>apsim</code> format, other
formats are now available but not as tested.  <code>rainman</code> is
not included since it returns six separate files. See
<a href="https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/">https://www.longpaddock.qld.gov.au/silo/about/file-formats-and-samples/</a>
Default: &ldquo;apsim&rdquo;</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_password">PASSWORD</code></td>
<td>
<p>Default: &ldquo;apitest&rdquo;</p>
</td></tr>
<tr><td><code id="get_silodata_+3A_extras">extras</code></td>
<td>
<p>A list containing variable names and values for
extra columns. Note that the new variable(s) will have the same
value. Default: <code>NULL</code></p>
</td></tr>
<tr><td><code id="get_silodata_+3A_url">URL</code></td>
<td>
<p>is the URL for querying the website and probably will
not need to be changed. Default:
&ldquo;https://www.longpaddock.qld.gov.au/cgi-bin/silo/DataDrillDataset.php&rdquo;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>extra</code>is specified, then extra columns which could
for instance include the site name are added to
each row for later calculations. This can also be employed in a
loop using <code><a href="base.html#topic+for">for()</a></code> loops or a <code>tidyverse</code> approach, such
as <code><a href="purrrlyr.html#topic+by_row">purrrlyr::by_row()</a></code> in order to manipulate data by site.
</p>


<h3>Value</h3>

<p>Data frame/tibble containing specified or default climate
variables. If &ldquo;APSIM&rdquo; format is specified then an extra
column <code>date_met</code>, containing the date, is returned along
with the usual <code>year</code> and day of year <code>day</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_multi_silodata">get_multi_silodata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Example 1: Replace MY_EMAIL_ADDRESS with your email address below
##            Latitude and Longitude character strings
boonah_data &lt;-
  get_silodata(latitude = "-27.9927", longitude = "152.6906",
               email = "MY_EMAIL_ADDRESS",
               START = "20190101", FINISH = "20200531")
## Example 2: Replace MY_EMAIL_ADDRESS below with yours - adds extra column
##            Latitude and Longitude are numeric
boonah_data2 &lt;-
  get_silodata(latitude = -27.9927, longitude = 152.6906,
               email = "MY_EMAIL_ADDRESS",
               START = "20190101", FINISH = "20200531",
               extras = list(Sitename = "Boonah"))
## Example 3: Replace MY_EMAIL_ADDRESS below with yours - adds extra column
##            Latitude and Longitude are numeric.
##            Retreives all Morton hydrological evapotranspirations
boonah_data3 &lt;-
  get_silodata(latitude = -27.9927, longitude = 152.6906,
               email = "MY_EMAIL_ADDRESS", FORMAT  =  "allmort",
               START = "20190101", FINISH = "20190115",
               extras = list(Sitename = "Boonah"))
## Example 4: Replace MY_EMAIL_ADDRESS below with yours - adds extra column
##            Latitude and Longitude are numeric. Retreives two months of
##            total rainfall and evaporation and means for max/min
##            temperatures, solar radiation and vapour pressure
boonah_data4 &lt;-
  get_silodata(latitude = -27.9927, longitude = 152.6906,
               email = "drpetebaker@gmail.com", FORMAT = "monthly",
               START = "20190101", FINISH = "20190228",
               extras = list(Sitename = "Boonah"))

## End(Not run)

</code></pre>

<hr>
<h2 id='growing_degree_days'>Degree days as the sum of capped average daily temperature above a baseline value</h2><span id='topic+growing_degree_days'></span>

<h3>Description</h3>

<p>Calculate the sum of of degree days (average temperature - base
temperature <code>base_temp</code> for each day) during specified dates
for a tibble or data frame of daily weather data. Alternatively, a
number of days before or after a specific date may be
specified. Note that the maximum temperature is capped at
<code>maxt_cap</code> when calculating the average temperature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growing_degree_days(
  data,
  varmax = NULL,
  varmin = NULL,
  datevar = NULL,
  maxt_cap = 30,
  base_temp = 5,
  na.rm = FALSE,
  ndays = 5,
  startdate = NULL,
  enddate = NULL,
  monitor = FALSE,
  warn.consecutive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growing_degree_days_+3A_data">data</code></td>
<td>
<p>Tibble or dataframe of daily weather data</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_varmax">varmax</code></td>
<td>
<p>Name of variable containing max temp (default
'maxt')</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_varmin">varmin</code></td>
<td>
<p>Name of variable containing min temp (default
'mint')</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_datevar">datevar</code></td>
<td>
<p>Date variable specifying day (Default: date_met)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_maxt_cap">maxt_cap</code></td>
<td>
<p>A numeric value set to the temperature considered
to be the maximum necessary for plant growth. Maximum temperature is
capped at this value for calculating average daily temp (Default: 30)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_base_temp">base_temp</code></td>
<td>
<p>A numeric value set to the temperature considered
to be the minimum necessary for plant growth (Default: 5)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_na.rm">na.rm</code></td>
<td>
<p>Used for calculations (Default: FALSE)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_ndays">ndays</code></td>
<td>
<p>Number of days after/before the start or end date,
respectively. Ignored of both the start and end dates are
specified (Default: 5)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_startdate">startdate</code></td>
<td>
<p>Start date of data to be extracted</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_enddate">enddate</code></td>
<td>
<p>Final date of data to be extracted</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_monitor">monitor</code></td>
<td>
<p>For debugging. Prints data and dates. (Default:
FALSE)</p>
</td></tr>
<tr><td><code id="growing_degree_days_+3A_warn.consecutive">warn.consecutive</code></td>
<td>
<p>A logical indicating whether to check that
dates are consecutive, that none are missing and provide a warning if
not (Default:TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value returned is the sum of of degree days <code class="reqn">GDD = \sum_i
(Tmax_i + Tmin_i) / 2 - Tbase</code> during specified dates for a tibble
or data frame of daily weather data. The maximum temperature Tmax
is capped at <code>maxt_cap</code> degrees when calculating average temp
(see <a href="https://farmwest.com/climate/calculator-information/gdd/">https://farmwest.com/climate/calculator-information/gdd/</a> or
McMaster, GS, &amp; Wilhelm, WW (1997)). Baskerville, G &amp;
Emin, P (1969) provide variations on this method.
</p>
<p>The sum of degree days is returned but if there are any missing
values, then the value returned will be <code>NA</code> since the
default <code>na.rm</code> is <code>TRUE</code>. Note that if there are any
missing dates, then a warning is issued but the sum of non-missing
values is returned.
</p>
<p>If any values are missing, while the sum of degree days may prove
useful, it will not include all the data and so will lead to
biased underestimates. Hence, in these cases it is unlikely that
the value returned is a good estimate but the appropriateness of
the estimate will depend on the exact circumstances of the missing
data and so this decision is left to the user.
</p>


<h3>Value</h3>

<p>Numeric variable containing the sum of degree days during
the period
</p>


<h3>References</h3>


<ul>
<li><p> Baskerville, G., &amp; Emin, P. (1969). Rapid Estimation
of Heat Accumulation from Maximum and Minimum
Temperatures. Ecology, 50(3), 514-517. <a href="https://doi.org/10.2307/1933912">doi:10.2307/1933912</a>
</p>
</li>
<li><p> McMaster, G. S., &amp; Wilhelm, W. W. (1997). Growing degree-days:
One equation, two interpretations. Agricultural and Forest
Meteorology, 87(4), 291–300. <a href="https://doi.org/10.1016/S0168-1923%2897%2900027-0">doi:10.1016/S0168-1923(97)00027-0</a>
</p>
</li>
<li><p> Anon. (2021). GDD. Farmwest. Retrieved June 15, 2021, from
<a href="https://farmwest.com/climate/calculator-information/gdd/">https://farmwest.com/climate/calculator-information/gdd/</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+cumulative">cumulative</a></code>, <code><a href="#topic+daily_mean">daily_mean</a></code>,
<code><a href="#topic+stress_days_over">stress_days_over</a></code>, and
<code><a href="#topic+weather_extract">weather_extract</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Selected calculations
## library(tidyverse)  # only purrr used here for crop2 example
library(dplyr)
library(purrr)
growing_degree_days(boonah, enddate = crop$flower_date[4], ndays = 3,
                    varmax = maxt, varmin = mint,
                    monitor = TRUE)
growing_degree_days(boonah, enddate = crop$harvest_date[4], ndays = 3,
                    varmax = maxt, varmin = mint,
                    monitor = TRUE)
growing_degree_days(boonah, startdate = crop$flower_date[4],
                    varmax = maxt, varmin = mint,
                    enddate = crop$harvest_date[4], monitor = TRUE)

## Add selected growing degree days at 'boonah' to 'crop' tibble
## using 'map2_dbl' from the 'purrr' package
## Note: using equivalent 'furrr' functions can speed up calculations 
crop2 &lt;- crop |&gt;
  mutate(gddays8_post_sow_7d =
          purrr::map_dbl(sowing_date, function(x)
            growing_degree_days(boonah, startdate = x, ndays = 7,
                                base_temp = 8)),
          gddays_flower_harvest =
            purrr::map2_dbl(flower_date, harvest_date, function(x, y)
              growing_degree_days(boonah, startdate = x, enddate = y)))
crop2

</code></pre>

<hr>
<h2 id='number_of_days'>The number of days between two dates</h2><span id='topic+number_of_days'></span>

<h3>Description</h3>

<p>A convenience function which is simply <code>as.numeric(end_date -
start_date)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>number_of_days(x, start)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="number_of_days_+3A_x">x</code></td>
<td>
<p>The end date with class <code><a href="base.html#topic+Date">Date</a></code></p>
</td></tr>
<tr><td><code id="number_of_days_+3A_start">start</code></td>
<td>
<p>The start date with class <code><a href="base.html#topic+Date">Date</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+numeric">numeric</a></code> variable containing the number
of days between the two dates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
number_of_days(x = ymd("2021-01-05"), start = ymd("2020-12-28"))
</code></pre>

<hr>
<h2 id='stress_days_over'>The number of days that maximum temp is over a baseline value</h2><span id='topic+stress_days_over'></span>

<h3>Description</h3>

<p>Calculate the number of days when the maximum temperature exceeds
a base line <code>stress_temp</code> during specified dates for a tibble
or data frame of daily weather data.  Alternatively, a number of
days before or after a specific date may be specified. The default
value of <code>stress_temp</code> is 30 degrees C.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stress_days_over(
  data,
  var = NULL,
  datevar = NULL,
  ndays = 5,
  na.rm = FALSE,
  stress_temp = 30,
  startdate = NULL,
  enddate = NULL,
  monitor = FALSE,
  warn.consecutive = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stress_days_over_+3A_data">data</code></td>
<td>
<p>Tibble or dataframe of daily weather data</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_var">var</code></td>
<td>
<p>Variable to be extracted (Default: maxt)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_datevar">datevar</code></td>
<td>
<p>Date variable specifying day (Default: date_met)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_ndays">ndays</code></td>
<td>
<p>Number of days after/before the start or end date,
respectively. Ignored of both the start and end dates are
specified (Default: 5)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_na.rm">na.rm</code></td>
<td>
<p>Used for calculations (Default: FALSE)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_stress_temp">stress_temp</code></td>
<td>
<p>A numeric value set to the temperature
considered to be stressful if the maximum temperature exceeds
(Default: 30)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_startdate">startdate</code></td>
<td>
<p>Start date of data to be extracted</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_enddate">enddate</code></td>
<td>
<p>Final date of data to be extracted</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_monitor">monitor</code></td>
<td>
<p>For debugging. Prints data and dates. (Default:
FALSE)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_warn.consecutive">warn.consecutive</code></td>
<td>
<p>A logical indicating whether to check that
dates are consecutive, that none are missing and provide a warning if
not (Default:TRUE)</p>
</td></tr>
<tr><td><code id="stress_days_over_+3A_...">...</code></td>
<td>
<p>options to be passed to <code>sum</code> calculation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of days is returned but if there are any missing
values, then the sum is set to <code>NA</code> since the default
<code>na.rm</code> is <code>TRUE</code>. Note that if there are any missing
dates, then a warning is issued but the sum of non-missing values
is returned.
</p>
<p>If any values are missing, while the number of days over
<code>stress_temp</code> total may prove useful, it will not include all
the data and so may lead to biased underestimates. Hence,
depending on the time of year, it may be unlikely that this is a
good estimate but the appropriateness of the estimate will depend
on the exact circumstances of the missing data and so this
decision is left to the user.
</p>


<h3>Value</h3>

<p>Numeric variable containing the number of days where the
maximum temperature was above the specified stress temperature
cutoff
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumulative">cumulative</a></code>, <code><a href="#topic+daily_mean">daily_mean</a></code>,
<code><a href="#topic+growing_degree_days">growing_degree_days</a></code>, and
<code><a href="#topic+weather_extract">weather_extract</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##  Selected calculations
## library(tidyverse) # only purrr used here for crop2 example
library(dplyr)
library(purrr)
stress_days_over(boonah, enddate = crop$flower_date[4], ndays = 3,
                 monitor = TRUE)
stress_days_over(boonah, enddate = crop$harvest_date[4], ndays = 3,
                 monitor = TRUE)
stress_days_over(boonah, startdate = crop$flower_date[4],
                 enddate = crop$harvest_date[4], monitor = TRUE)

## Add selected stress days at 'boonah' to 'crop' tibble
## using 'map2_dbl' from the 'purrr' package
## Note: using equivalent 'furrr' functions can speed up calculations 
crop2 &lt;- crop |&gt;
  mutate(stressdays25_post_sow_7d =
          purrr::map_dbl(sowing_date, function(x)
            stress_days_over(boonah, startdate = x, ndays = 7,
                             stress_temp = 25)),
          stressdays_flower_harvest =
            purrr::map2_dbl(flower_date, harvest_date, function(x, y)
              stress_days_over(boonah, startdate = x, enddate = y)))
crop2

</code></pre>

<hr>
<h2 id='two_sites'>SILO weather data extracted for two arbitrary sites</h2><span id='topic+two_sites'></span>

<h3>Description</h3>

<p>A dataset containing daily weather data in APSIM format for
Site_1: at -27 S, 151 E and Site_2: -28 S, 152 E for the period 1
to 5 Nov 2020
</p>


<h3>Usage</h3>

<pre><code class='language-R'>two_sites
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 11 variables:
</p>

<dl>
<dt>year</dt><dd><p>Year</p>
</dd>
<dt>day</dt><dd><p>Day</p>
</dd>
<dt>radn</dt><dd><p>Radiation (MJ/m^2)</p>
</dd>
<dt>maxt</dt><dd><p>Max Temperature (degrees C)</p>
</dd>
<dt>mint</dt><dd><p>Min Temperature (degrees C)</p>
</dd>
<dt>rain</dt><dd><p>Rainfall (mm)</p>
</dd>
<dt>evap</dt><dd><p>Evaporation (mm)</p>
</dd>
<dt>vp</dt><dd><p>Vapour Pressure (hPa)</p>
</dd>
<dt>code</dt><dd><p>Source Code is a six digit string describing the
source of the meteorological data where each digit is either 0, an
actual observation; 1, an actual observation from a composite
station; 2, a value interpolated from daily observations; 3, a
value interpolated from daily observations using the anomaly
interpolation method for CLIMARC data; 6, a synthetic pan
value; or 7, an interpolated long term average</p>
</dd>
<dt>date_met</dt><dd><p>The date on which daily weather was collected</p>
</dd>
<dt>Sitename</dt><dd><p>Sites labelled &ldquo;Site_1&rdquo; and &ldquo;Site_2&rdquo;</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were obtained with
</p>
<p><code>two_sites  &lt;- get_multi_silodata(latitude = c(-27.00, -28.00),
   longitude = c(151.00, 152.00), Sitename = c("Site_1", "Site_2"),
   START = "20201101", FINISH = "20201105", email = "MY_EMAIL_ADDRESS")</code>
</p>
<p>where &ldquo;MY_EMAIL_ADDRESS&rdquo; was relaced with an appropriate
address.
</p>


<h3>Source</h3>

<p>Meteorological SILO data obtained from the Longpaddock Qld
Government web site <a href="https://www.longpaddock.qld.gov.au">https://www.longpaddock.qld.gov.au</a> for
two sites for the period 1 to 5 Nov 2020
</p>

<hr>
<h2 id='weather_extract'>Extract one or more columns of weather data between two dates</h2><span id='topic+weather_extract'></span>

<h3>Description</h3>

<p>Extract column(s) from a tibble/data frame of daily weather data
between two specified dates. Either specify the start and end
dates or specify one of these dates and also the number of days
after or before, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weather_extract(
  data,
  var,
  datevar = NULL,
  ndays = 5,
  startdate = NULL,
  enddate = NULL,
  monitor = FALSE,
  return.dates = TRUE,
  warn.consecutive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weather_extract_+3A_data">data</code></td>
<td>
<p>Tibble or dataframe of daily weather data</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_var">var</code></td>
<td>
<p>Variable(s) to be extracted (Default: radn). Several columns
may be specified using column names <code>c(variable1, variable2, ...)</code></p>
</td></tr>
<tr><td><code id="weather_extract_+3A_datevar">datevar</code></td>
<td>
<p>Date variable specifying day (Default: date_met)</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_ndays">ndays</code></td>
<td>
<p>Number of days after/before the start or end date,
respectively. Ignored of both the start and end dates are
specified (Default: 5)</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_startdate">startdate</code></td>
<td>
<p>Start date of data to be extracted</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_enddate">enddate</code></td>
<td>
<p>Final date of data to be extracted</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_monitor">monitor</code></td>
<td>
<p>For debugging. Prints data and dates. (Default:
FALSE)</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_return.dates">return.dates</code></td>
<td>
<p>A logical indicating whether to return the date
column (Default: TRUE)</p>
</td></tr>
<tr><td><code id="weather_extract_+3A_warn.consecutive">warn.consecutive</code></td>
<td>
<p>A logical indicating whether to check that
dates are consecutive, that none are missing and provide a warning if
not (Default:TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble (data frame) of extracted weather data
</p>


<h3>See Also</h3>

<p><code><a href="dplyr.html#topic+between">between</a></code> <code><a href="dplyr.html#topic+filter">filter</a></code>,
<code><a href="#topic+cumulative">cumulative</a></code>, <code><a href="#topic+daily_mean">daily_mean</a></code>,
<code><a href="#topic+growing_degree_days">growing_degree_days</a></code>, and <code><a href="#topic+stress_days_over">stress_days_over</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
boonah |&gt;
weather_extract(rain, date = date_met, startdate = ymd("2019-08-16"),
                  enddate = ymd("2019-08-21"))
boonah |&gt;
  weather_extract(rain, startdate = ymd("2019-08-16"),
                  enddate = ymd("2019-08-21"))
boonah |&gt;
  weather_extract(maxt, date = date_met, startdate = ymd("2019-08-16"),
                  ndays = 3, return.dates = FALSE)
boonah |&gt;
  weather_extract(mint, enddate = ymd("2019-08-16"), ndays = 1)
## extract multiple columns
boonah |&gt;
  weather_extract(c(year, day, mint, maxt), enddate = ymd("2019-08-16"),
                  ndays = 3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
